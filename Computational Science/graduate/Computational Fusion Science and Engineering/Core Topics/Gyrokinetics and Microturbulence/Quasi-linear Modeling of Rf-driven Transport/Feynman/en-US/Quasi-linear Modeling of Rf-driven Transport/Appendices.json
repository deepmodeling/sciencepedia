{
    "hands_on_practices": [
        {
            "introduction": "The effectiveness of RF heating relies on precisely localizing wave-particle resonant interaction within the plasma. This foundational practice connects the basic principle of cyclotron motion to the spatial properties of a tokamak's magnetic field. By deriving the resonance condition from first principles, you will determine the exact location of the power deposition layer, a critical first step in designing and analyzing any RF heating system .",
            "id": "4034062",
            "problem": "In quasi-linear modeling of Radio Frequency (RF)-driven transport in magnetized plasmas, the resonant interaction between waves and particles is localized where the particle’s cyclotron frequency matches the applied RF angular frequency. Consider a large-aspect-ratio tokamak with toroidal magnetic field on the outboard midplane given by the standard equilibrium scaling $B_{\\phi}(R) = B_{0}\\,R_{0}/R$, where $R$ is the major radius, $R_{0}$ is the magnetic axis major radius, and $B_{0}$ is the on-axis toroidal magnetic field. Assume the poloidal magnetic field is negligible for the purpose of locating the cyclotron resonance layer and that finite Larmor radius, relativistic, and Doppler-shift effects are negligible.\n\nStarting from the Lorentz force law for a charged particle in a static magnetic field, derive the cyclotron frequency for a minority ion species of charge $Z_{m} e$ and mass $m_{m}$. Then, imposing the fundamental ion cyclotron resonance condition that the RF angular frequency equals the local cyclotron frequency, determine the major-radius location $R_{\\text{res}}$ of the resonance layer as a function of $Z_{m}$, $e$, $m_{m}$, $B_{0}$, $R_{0}$, and the RF angular frequency $\\omega_{\\text{RF}}$.\n\nFinally, evaluate $R_{\\text{res}}$ numerically for an Ion Cyclotron Range of Frequencies (ICRF) minority heating scenario with the following parameters:\n- Magnetic axis major radius $R_{0} = 3.0\\,\\text{m}$,\n- On-axis toroidal field $B_{0} = 5.3\\,\\text{T}$,\n- Minority species is helium-$3$ with charge state $Z_{m} = 2$ and mass $m_{m} = 3\\,m_{p}$,\n- Proton mass $m_{p} = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$,\n- Elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$,\n- RF frequency $f = 80.0\\,\\text{MHz}$, with $\\omega_{\\text{RF}} = 2\\pi f$.\n\nExpress your final numerical answer for $R_{\\text{res}}$ in meters and round to four significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard calculation in the field of plasma physics concerning Ion Cyclotron Range of Frequencies (ICRF) heating in a tokamak. The provided parameters are physically realistic for a large fusion experiment.\n\nThe first step is to derive the cyclotron frequency, $\\omega_{c}$, for a charged particle in a static magnetic field. The motion of a particle with charge $q$ and mass $m$ in a magnetic field $\\vec{B}$ is governed by the Lorentz force law, $\\vec{F} = q(\\vec{v} \\times \\vec{B})$. Equating this to the Newtonian force, $\\vec{F} = m\\vec{a}$, we get the equation of motion:\n$$m \\frac{d\\vec{v}}{dt} = q(\\vec{v} \\times \\vec{B})$$\nThis equation describes a helical trajectory, where the particle undergoes uniform circular motion in the plane perpendicular to the magnetic field, superimposed with a constant velocity parallel to the field. The magnetic force provides the necessary centripetal force for the circular motion. For the component of velocity perpendicular to the field, $v_{\\perp}$, the magnitude of the force is $|F| = |q|v_{\\perp}B$. The centripetal acceleration for circular motion of radius $r_{L}$ (the Larmor radius) is $a_c = v_{\\perp}^{2}/r_{L}$. Applying Newton's second law in the perpendicular plane:\n$$|q|v_{\\perp}B = m \\frac{v_{\\perp}^{2}}{r_{L}}$$\nThe angular frequency of this gyromotion, known as the cyclotron frequency $\\omega_{c}$, is defined as $\\omega_{c} = v_{\\perp}/r_{L}$. From the force balance equation, we can solve for $\\omega_{c}$:\n$$\\omega_{c} = \\frac{|q|B}{m}$$\nFor the specified minority ion species, the charge is $q = Z_{m}e$ and the mass is $m = m_{m}$. Since $Z_{m}$ is the charge state number and $e$ is the elementary charge, both are defined as positive, so we have $|q| = Z_{m}e$. The magnetic field in the tokamak is primarily toroidal and varies with the major radius $R$ as $B(R) = B_{\\phi}(R) = B_{0}R_{0}/R$. Substituting these into the cyclotron frequency formula gives the local cyclotron frequency as a function of major radius:\n$$\\omega_{c,m}(R) = \\frac{Z_{m}e B(R)}{m_{m}} = \\frac{Z_{m}e}{m_{m}} \\frac{B_{0}R_{0}}{R}$$\nThe second step is to find the location of the fundamental cyclotron resonance, $R_{\\text{res}}$. This resonance occurs where the applied RF wave's angular frequency, $\\omega_{\\text{RF}}$, matches the local cyclotron frequency of the ion species, $\\omega_{c,m}(R)$. The resonance condition is:\n$$\\omega_{\\text{RF}} = \\omega_{c,m}(R_{\\text{res}})$$\nSubstituting the expression for $\\omega_{c,m}(R)$:\n$$\\omega_{\\text{RF}} = \\frac{Z_{m}e B_{0}R_{0}}{m_{m}R_{\\text{res}}}$$\nSolving for the resonance major radius, $R_{\\text{res}}$, we obtain the symbolic expression:\n$$R_{\\text{res}} = \\frac{Z_{m}e B_{0}R_{0}}{m_{m}\\omega_{\\text{RF}}}$$\nThe final step is to evaluate $R_{\\text{res}}$ numerically using the provided parameters:\nMagnetic axis major radius: $R_{0} = 3.0\\,\\text{m}$\nOn-axis toroidal field: $B_{0} = 5.3\\,\\text{T}$\nMinority species charge state: $Z_{m} = 2$\nMinority species mass: $m_{m} = 3\\,m_{p}$\nProton mass: $m_{p} = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$\nElementary charge: $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\nRF frequency: $f = 80.0\\,\\text{MHz} = 80.0 \\times 10^{6}\\,\\text{Hz}$\n\nThe RF angular frequency is $\\omega_{\\text{RF}} = 2\\pi f$. Substituting this into the expression for $R_{\\text{res}}$:\n$$R_{\\text{res}} = \\frac{Z_{m}e B_{0}R_{0}}{m_{m}(2\\pi f)}$$\nNow we substitute the numerical values:\n$$m_{m} = 3 \\times (1.67262192369 \\times 10^{-27}\\,\\text{kg}) = 5.01786577107 \\times 10^{-27}\\,\\text{kg}$$\nPlugging all values into the equation for $R_{\\text{res}}$:\n$$R_{\\text{res}} = \\frac{(2)(1.602176634 \\times 10^{-19}\\,\\text{C})(5.3\\,\\text{T})(3.0\\,\\text{m})}{(3 \\times 1.67262192369 \\times 10^{-27}\\,\\text{kg})(2\\pi \\times 80.0 \\times 10^{6}\\,\\text{s}^{-1})}$$\n$$R_{\\text{res}} = \\frac{5.09483301764 \\times 10^{-18}\\,\\text{C}\\cdot\\text{T}\\cdot\\text{m}}{2.5222045500 \\times 10^{-18}\\,\\text{kg}\\cdot\\text{s}^{-1}}$$\nThe units simplify correctly to meters, as shown by dimensional analysis:\n$$ \\frac{\\text{C}\\cdot\\text{T}\\cdot\\text{m}}{\\text{kg}\\cdot\\text{s}^{-1}} = \\frac{(\\text{A}\\cdot\\text{s})\\cdot(\\text{kg}\\cdot\\text{s}^{-2}\\cdot\\text{A}^{-1})\\cdot\\text{m}}{\\text{kg}\\cdot\\text{s}^{-1}} = \\frac{\\text{kg}\\cdot\\text{m}\\cdot\\text{s}^{-1}}{\\text{kg}\\cdot\\text{s}^{-1}} = \\text{m} $$\nPerforming the calculation:\n$$R_{\\text{res}} \\approx 2.02000522... \\,\\text{m}$$\nRounding the result to four significant figures as requested:\n$$R_{\\text{res}} \\approx 2.020\\,\\text{m}$$\nThis result indicates that the resonance layer is located on the high-field side of the tokamak, as $R_{\\text{res}} < R_{0}$.",
            "answer": "$$\\boxed{2.020}$$"
        },
        {
            "introduction": "In realistic scenarios, plasmas are not static; they flow and rotate, which alters the conditions for wave-particle interaction. This exercise introduces the crucial concept of the Doppler shift, demonstrating how the resonance condition must be modified in the plasma's moving frame. Understanding this effect is essential for accurately modeling RF power absorption and for predicting how RF waves can drive plasma rotation and current .",
            "id": "4034039",
            "problem": "A large-aspect-ratio tokamak with major radius $R_{0}$ is subject to Ion Cyclotron Range of Frequencies (ICRF) fast-wave heating. The equilibrium has uniform toroidal rotation with flow velocity $\\mathbf{V}_{0}=V_{\\phi}\\,\\hat{\\boldsymbol{\\phi}}$, where $V_{\\phi}\\ll c$. An externally launched radio-frequency (RF) wave has electric field represented in the WKB/eikonal form $\\mathbf{E}(\\mathbf{x},t)=\\Re\\{\\mathbf{E}_{0}(\\mathbf{x})\\exp(i\\Phi)\\}$ with phase $\\Phi(\\mathbf{x},t)=\\mathbf{k}\\cdot\\mathbf{x}-\\omega t$. The wave has toroidal mode number $n_{\\phi}$ and toroidal wavevector component $k_{\\phi}$ given by the geometric optics relation $k_{\\phi}=n_{\\phi}/R_{0}$. Consider deuterium ions with charge $q_{i}$ and mass $m_{i}$ in a strong toroidal magnetic field $\\mathbf{B}$, and assume nonrelativistic conditions throughout.\n\nUsing only the invariance of wave phase, the definition of the wave–particle resonance as phase stationarity in the particle frame, and the single-particle cyclotron frequency definition $\\Omega_{i}=|q_{i}|B/m_{i}$, carry out the following:\n\n1. Starting from the phase $\\Phi=\\mathbf{k}\\cdot\\mathbf{x}-\\omega t$, perform a transformation to the uniformly rotating plasma frame moving with $\\mathbf{V}_{0}$ and derive the plasma-frame wave frequency in terms of laboratory-frame $(\\omega,\\mathbf{k})$ and $\\mathbf{V}_{0}$. Clearly state any approximations used.\n\n2. Using the plasma-frame frequency from part 1 and the resonance condition for cyclotron interaction formulated in the plasma frame, derive how uniform toroidal rotation modifies the cyclotron resonance condition for ions interacting with the RF wave. State the physical sign conventions and briefly justify how the modification determines the direction of toroidal momentum deposition when net RF power is absorbed.\n\n3. For the specific parameters $R_{0}=3.0\\,\\text{m}$, $n_{\\phi}=20$, $V_{\\phi}=5.0\\times 10^{4}\\,\\text{m s}^{-1}$, and RF frequency $f=50\\,\\text{MHz}$ (so that $\\omega=2\\pi f$), compute the nonrelativistic Doppler frequency shift between the laboratory frame and the uniformly rotating plasma frame due solely to the toroidal flow. Express your final answer as the positive magnitude $\\Delta\\omega$ in $\\text{rad s}^{-1}$, and round your answer to three significant figures. Do not include any other quantities in your final answer.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of plasma physics and wave propagation, well-posed with a clear and solvable set of questions, and objective in its formulation. All necessary parameters and definitions for a unique solution are provided, and the physical scenario described is standard in the field of magnetic confinement fusion.\n\nThe solution proceeds in three parts as requested.\n\n### Part 1: Derivation of Plasma-Frame Wave Frequency\n\nThe phase of a wave, $\\Phi$, is a Lorentz invariant. In the nonrelativistic limit ($V_{\\phi} \\ll c$), the Lorentz transformations reduce to Galilean transformations. We are given the laboratory frame coordinates $(\\mathbf{x}, t)$ and the wave phase in this frame as $\\Phi(\\mathbf{x},t) = \\mathbf{k}\\cdot\\mathbf{x}-\\omega t$.\n\nWe introduce a new reference frame, the \"plasma frame,\" denoted by coordinates $(\\mathbf{x}', t')$, which moves with the uniform velocity of the plasma, $\\mathbf{V}_{0}$, relative to the laboratory frame. The Galilean transformation relating the two frames is:\n$$ \\mathbf{x}' = \\mathbf{x} - \\mathbf{V}_{0}t $$\n$$ t' = t $$\n\nThe principle of phase invariance states that the value of the phase for a given physical event is the same in all inertial frames. Therefore, we can write the phase in the plasma frame, $\\Phi'(\\mathbf{x}',t')$, as:\n$$ \\Phi'(\\mathbf{x}', t') = \\mathbf{k}'\\cdot\\mathbf{x}' - \\omega' t' $$\nwhere $\\omega'$ and $\\mathbf{k}'$ are the wave frequency and wavevector as measured in the plasma frame.\n\nBy phase invariance, $\\Phi(\\mathbf{x}, t) = \\Phi'(\\mathbf{x}', t')$. We can express the plasma-frame phase in terms of lab-frame coordinates by substituting the transformation equations:\n$$ \\Phi' = \\mathbf{k}' \\cdot (\\mathbf{x} - \\mathbf{V}_{0}t) - \\omega' t $$\n$$ \\Phi' = \\mathbf{k}' \\cdot \\mathbf{x} - (\\mathbf{k}' \\cdot \\mathbf{V}_{0}) t - \\omega' t $$\n$$ \\Phi' = \\mathbf{k}' \\cdot \\mathbf{x} - (\\omega' + \\mathbf{k}' \\cdot \\mathbf{V}_{0}) t $$\n\nEquating this with the lab-frame phase, $\\Phi = \\mathbf{k}\\cdot\\mathbf{x}-\\omega t$:\n$$ \\mathbf{k}\\cdot\\mathbf{x}-\\omega t = \\mathbf{k}' \\cdot \\mathbf{x} - (\\omega' + \\mathbf{k}' \\cdot \\mathbf{V}_{0}) t $$\n\nFor this equality to hold for all positions $\\mathbf{x}$ and times $t$, the coefficients of $\\mathbf{x}$ and $t$ must be equal.\nEquating the coefficients of $\\mathbf{x}$:\n$$ \\mathbf{k} = \\mathbf{k}' $$\nThis is a standard result of Galilean relativity: the wavevector is the same in both frames.\n\nEquating the coefficients of $t$:\n$$ \\omega = \\omega' + \\mathbf{k}' \\cdot \\mathbf{V}_{0} $$\n\nUsing $\\mathbf{k}'=\\mathbf{k}$, we find the relationship between the lab-frame frequency $\\omega$ and the plasma-frame frequency $\\omega'$:\n$$ \\omega = \\omega' + \\mathbf{k} \\cdot \\mathbf{V}_{0} $$\n\nThis allows us to solve for the plasma-frame frequency $\\omega'$:\n$$ \\omega' = \\omega - \\mathbf{k} \\cdot \\mathbf{V}_{0} $$\nThis expression shows the Doppler shift of the wave frequency due to the motion of the medium.\n\nThe problem states that the plasma has a uniform toroidal rotation $\\mathbf{V}_{0}=V_{\\phi}\\,\\hat{\\boldsymbol{\\phi}}$ and the wave has a toroidal wavevector component $k_{\\phi}$. The dot product $\\mathbf{k} \\cdot \\mathbf{V}_{0}$ thus simplifies to:\n$$ \\mathbf{k} \\cdot \\mathbf{V}_{0} = k_{\\phi} V_{\\phi} $$\nwhere we align the $\\hat{\\boldsymbol{\\phi}}$ direction with the relevant component of $\\mathbf{k}$.\nSubstituting this into the expression for $\\omega'$, we obtain the plasma-frame wave frequency:\n$$ \\omega' = \\omega - k_{\\phi} V_{\\phi} $$\nThe primary approximation used is the nonrelativistic treatment ($V_{\\phi} \\ll c$), which justifies the use of the Galilean transformation.\n\n### Part 2: Modified Cyclotron Resonance Condition\n\nCyclotron resonance occurs when a charged particle, gyrating in a magnetic field $\\mathbf{B}$, experiences a wave electric field that is stationary in its own accelerating frame of reference. This condition of phase stationarity for a particle gyrating at the cyclotron frequency $\\Omega_{i}$ is met when the wave frequency in the plasma rest frame, $\\omega'$, is an integer multiple of $\\Omega_{i}$. The resonance condition in the plasma frame is therefore:\n$$ \\omega' = l \\Omega_{i} $$\nwhere $l$ is an integer known as the cyclotron harmonic number and $\\Omega_{i} = |q_{i}|B/m_{i}$ is the ion cyclotron frequency.\n\nTo find the modified resonance condition in the laboratory frame, we substitute the expression for $\\omega'$ derived in Part 1:\n$$ \\omega - k_{\\phi} V_{\\phi} = l \\Omega_{i} $$\nThis is the cyclotron resonance condition as seen in the laboratory frame, modified by the Doppler shift term $k_{\\phi} V_{\\phi}$ arising from the toroidal plasma rotation.\n\nThe term $k_{\\phi} V_{\\phi}$ determines the modification to the resonance. The sign conventions are as follows: $V_{\\phi}$ is positive for rotation in the direction of the plasma current (co-current) and negative for rotation in the opposite direction (counter-current). The toroidal wavevector $k_{\\phi} = n_{\\phi}/R_{0}$ is positive for a wave propagating co-current ($n_{\\phi} > 0$) and negative for a counter-current propagating wave ($n_{\\phi} < 0$).\n\nThe direction of toroidal momentum deposition is determined by the toroidal momentum carried by the wave, which is proportional to $n_{\\phi}$ (or $k_{\\phi}$). When a wave is absorbed by the plasma, it transfers its momentum to the resonant particles. The rate of toroidal momentum transfer (toroidal torque, $\\mathcal{T}_{\\phi}$) is related to the absorbed power, $P_{abs}$, by the relation $\\mathcal{T}_{\\phi} = (n_{\\phi}/\\omega)P_{abs}$. Consequently, a wave with $n_{\\phi} > 0$ will exert a co-current torque, driving plasma rotation in the positive toroidal direction, while a wave with $n_{\\phi} < 0$ will exert a counter-current torque. The modification of the resonance condition via the $k_{\\phi}V_{\\phi}$ term does not change the direction of momentum deposition per absorbed quantum of wave action, but it does change *which* particles become resonant and where in the plasma the power and momentum are absorbed. For a given magnetic field profile $B(R)$, the rotation shifts the spatial location of the resonance layer, providing a control mechanism for the profile of momentum deposition.\n\n### Part 3: Numerical Calculation of Doppler Frequency Shift\n\nThe problem asks for the magnitude of the Doppler frequency shift, which is the term that modifies the frequency between the laboratory and plasma frames. We denote this shift by $\\Delta\\omega$.\n$$ \\Delta\\omega = |\\mathbf{k} \\cdot \\mathbf{V}_{0}| = |k_{\\phi} V_{\\phi}| $$\nWe are given the following parameters:\n- Major radius: $R_{0} = 3.0\\,\\text{m}$\n- Toroidal mode number: $n_{\\phi} = 20$\n- Toroidal flow velocity: $V_{\\phi} = 5.0 \\times 10^{4}\\,\\text{m s}^{-1}$\n\nFirst, we calculate the toroidal wavevector component $k_{\\phi}$ using the provided geometric optics relation:\n$$ k_{\\phi} = \\frac{n_{\\phi}}{R_{0}} = \\frac{20}{3.0\\,\\text{m}} = \\frac{20}{3}\\,\\text{m}^{-1} $$\n\nNext, we compute the Doppler frequency shift $\\Delta\\omega$. Since $n_{\\phi}$ and $V_{\\phi}$ are given as positive, their product is positive, and the absolute value is redundant.\n$$ \\Delta\\omega = k_{\\phi} V_{\\phi} = \\left(\\frac{20}{3}\\,\\text{m}^{-1}\\right) \\times (5.0 \\times 10^{4}\\,\\text{m s}^{-1}) $$\n$$ \\Delta\\omega = \\frac{100 \\times 10^{4}}{3}\\,\\text{s}^{-1} = \\frac{1}{3} \\times 10^{6}\\,\\text{rad s}^{-1} $$\n\nThe units are $\\text{s}^{-1}$, which is equivalent to $\\text{rad s}^{-1}$ for an angular frequency. Evaluating this numerically:\n$$ \\Delta\\omega \\approx 0.33333... \\times 10^{6}\\,\\text{rad s}^{-1} $$\nRounding to three significant figures, as requested:\n$$ \\Delta\\omega = 3.33 \\times 10^{5}\\,\\text{rad s}^{-1} $$\nThe laboratory frame RF frequency $f = 50\\,\\text{MHz}$ corresponds to $\\omega = 2\\pi f \\approx 3.14 \\times 10^{8}\\,\\text{rad s}^{-1}$. The Doppler shift is a small but significant fraction of the wave frequency.",
            "answer": "$$\\boxed{3.33 \\times 10^{5}}$$"
        },
        {
            "introduction": "The collective effect of resonant wave-particle interactions is described by a diffusion process in velocity space, governed by the Fokker-Planck equation. This practice bridges theory and computation by guiding you through a stability analysis of a numerical solver for this equation. Determining the maximum stable timestep, dictated by the Courant–Friedrichs–Lewy (CFL) condition, is a vital and practical skill for developing efficient and accurate simulations of RF-driven transport .",
            "id": "4034053",
            "problem": "Consider a one-dimensional velocity-space Fokker–Planck equation for electrons in a magnetized plasma subject to Radio Frequency (RF) waves, where quasi-linear (QL) diffusion in velocity space is modeled as\n$$\n\\frac{\\partial f(v,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial v}\\!\\left( D_{vv}(v)\\,\\frac{\\partial f(v,t)}{\\partial v} \\right).\n$$\nYou discretize the velocity space on a uniform grid with spacing $\\Delta v$ and approximate the divergence form using a conservative centered scheme with nodal values $f_{j}^{n} \\approx f(v_{j},t^{n})$ and face-centered diffusion $D_{j+\\frac{1}{2}} \\approx D_{vv}\\!\\left(v_{j+\\frac{1}{2}}\\right)$. The explicit forward Euler update is\n$$\nf_{j}^{n+1} \\;=\\; f_{j}^{n} \\;+\\; \\frac{\\Delta t}{\\Delta v}\\left[\\,J^{n}_{j+\\frac{1}{2}} \\;-\\; J^{n}_{j-\\frac{1}{2}}\\,\\right], \n\\quad\\text{where}\\quad \nJ^{n}_{j+\\frac{1}{2}} \\;=\\; -\\,D_{j+\\frac{1}{2}}^{n}\\,\\frac{f_{j+1}^{n} - f_{j}^{n}}{\\Delta v}.\n$$\nAssume periodic boundary conditions so that a Fourier-mode stability analysis is admissible when $D_{vv}$ is approximated by its maximum value. Let the diffusion be localized around a resonant velocity with a Gaussian profile\n$$\nD_{vv}(v) \\;=\\; D_{0}\\,\\exp\\!\\left(-\\frac{(v - v_{\\mathrm{res}})^{2}}{2\\,\\sigma^{2}}\\right),\n$$\nwith amplitude $D_{0}$, resonance $v_{\\mathrm{res}}$, and width $\\sigma$. The Courant–Friedrichs–Lewy (CFL) condition for stability of a diffusion operator is commonly written in the form\n$$\n\\Delta t \\;\\le\\; C\\,\\frac{\\Delta v^{2}}{\\max_{v} D_{vv}(v)},\n$$\nwhere $C$ is a scheme-dependent constant. Starting from the discrete operator defined above, use a von Neumann analysis for the constant-coefficient case to determine the constant $C$ for the explicit forward Euler scheme and justify the replacement $\\max_{v} D_{vv}(v)$ for variable coefficients. Briefly contrast the stability properties of a semi-implicit Crank–Nicolson scheme and a fully implicit backward Euler scheme for the same operator.\n\nTake the following physically consistent parameters:\n- Grid spacing $\\Delta v = 1.0 \\times 10^{5}$ m/s.\n- Amplitude $D_{0} = 4.0 \\times 10^{11}$ m$^{2}$/s$^{3}$.\n- Resonance $v_{\\mathrm{res}} = 2.5 \\times 10^{6}$ m/s.\n- Width $\\sigma = 3.0 \\times 10^{5}$ m/s.\n\nAssume that $D_{vv}(v)$ attains its maximum at $v = v_{\\mathrm{res}}$. Compute the maximum stable timestep for the explicit scheme based on your derived $C$ and the given parameters. Express the final timestep in seconds and round your answer to four significant figures. The final reported answer must be only this timestep.",
            "solution": "The fundamental base is the one-dimensional Fokker–Planck equation with quasi-linear diffusion,\n$$\n\\frac{\\partial f(v,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial v}\\!\\left( D_{vv}(v)\\,\\frac{\\partial f(v,t)}{\\partial v} \\right),\n$$\nwhich represents conservative diffusion in velocity space driven by Radio Frequency waves. On a uniform grid with spacing $\\Delta v$, a consistent second-order conservative discretization for the diffusive flux is\n$$\nJ_{j+\\frac{1}{2}} \\;=\\; -\\,D_{j+\\frac{1}{2}}\\;\\frac{f_{j+1}-f_{j}}{\\Delta v},\n$$\nand the divergence is approximated by\n$$\n\\left.\\frac{\\partial J}{\\partial v}\\right|_{v_j} \\;\\approx\\; \\frac{J_{j+\\frac{1}{2}} - J_{j-\\frac{1}{2}}}{\\Delta v}.\n$$\nUsing explicit forward Euler in time, the fully discrete update is\n$$\nf^{n+1}_{j} \\;=\\; f^{n}_{j} \\;+\\; \\frac{\\Delta t}{\\Delta v}\\left[\\,J^{n}_{j+\\frac{1}{2}} - J^{n}_{j-\\frac{1}{2}}\\,\\right].\n$$\n\nTo analyze stability, we first consider the constant-coefficient case $D_{vv}(v) \\equiv D$ with periodic boundary conditions. In this case, the discrete operator reduces to $D$ times the standard second-difference (discrete Laplacian). Indeed,\n$$\n\\frac{J_{j+\\frac{1}{2}} - J_{j-\\frac{1}{2}}}{\\Delta v}\n\\;=\\;\n-\\,\\frac{D}{\\Delta v}\\left[\\frac{f_{j+1}-f_{j}}{\\Delta v} - \\frac{f_{j}-f_{j-1}}{\\Delta v}\\right]\n\\;=\\;\nD\\,\\frac{f_{j+1} - 2 f_{j} + f_{j-1}}{\\Delta v^{2}}.\n$$\nTherefore, the semi-discrete system is\n$$\n\\frac{d f_{j}}{dt} \\;=\\; D\\,\\frac{f_{j+1} - 2 f_{j} + f_{j-1}}{\\Delta v^{2}},\n$$\nand the forward Euler update becomes\n$$\nf^{n+1}_{j} \\;=\\; f^{n}_{j} \\;+\\; \\Delta t\\,D\\,\\frac{f^{n}_{j+1} - 2 f^{n}_{j} + f^{n}_{j-1}}{\\Delta v^{2}}.\n$$\nFor von Neumann analysis, consider a Fourier mode $f^{n}_{j} = \\hat{f}^{n}\\,\\exp(i k v_{j})$ with $v_{j} = j\\,\\Delta v$ and wavenumber $k$. Substituting into the update yields the amplification factor $g(k)$:\n$$\ng(k) \\;=\\; 1 + \\Delta t\\,D\\,\\frac{\\exp(i k \\Delta v) - 2 + \\exp(-i k \\Delta v)}{\\Delta v^{2}}\n\\;=\\; 1 - \\Delta t\\,D\\,\\frac{4 \\sin^{2}\\!\\left(\\frac{k \\Delta v}{2}\\right)}{\\Delta v^{2}}.\n$$\nStability of forward Euler for real negative coefficients requires $|g(k)| \\le 1$ for all $k$. Since $g(k)$ is real and decreases with $\\sin^{2}(k \\Delta v/2)$, the most restrictive condition occurs at the highest resolvable wavenumber where $\\sin^{2}(k \\Delta v/2) = 1$. Thus,\n$$\ng_{\\min} \\;=\\; 1 \\;-\\; \\Delta t\\,D\\,\\frac{4}{\\Delta v^{2}}.\n$$\nThe forward Euler stability interval on the negative real axis is $-2 \\le \\Delta t\\,D\\,\\lambda \\le 0$ when $\\lambda \\le 0$. Translating to this discrete operator gives\n$$\n-2 \\;\\le\\; -\\,\\Delta t\\,D\\,\\frac{4}{\\Delta v^{2}} \\;\\le\\; 0\n\\quad\\Rightarrow\\quad\n\\Delta t \\;\\le\\; \\frac{\\Delta v^{2}}{2 D}.\n$$\nTherefore, the scheme-dependent constant for the explicit forward Euler with second-order central differences is\n$$\nC \\;=\\; \\frac{1}{2}.\n$$\n\nFor variable coefficients $D_{vv}(v)$, the discrete operator in conservative form remains symmetric negative semidefinite. A sufficient stability condition for the explicit scheme can be obtained by bounding the spectral radius using the largest local diffusivity. This yields\n$$\n\\Delta t \\;\\le\\; \\frac{\\Delta v^{2}}{2\\,\\max_{v} D_{vv}(v)},\n$$\nwhich is the diffusion Courant–Friedrichs–Lewy (CFL) condition with $C = 1/2$ and $\\max_{v} D_{vv}(v)$ replacing $D$.\n\nWe now contrast with semi-implicit and fully implicit schemes:\n\n1. Crank–Nicolson (semi-implicit) scheme for diffusion is defined by trapezoidal time integration of the linear operator, leading to an amplification factor\n$$\ng_{\\mathrm{CN}}(k) \\;=\\; \\frac{1 - \\frac{\\Delta t}{2}\\,D\\,\\frac{4 \\sin^{2}(k \\Delta v/2)}{\\Delta v^{2}}}{1 + \\frac{\\Delta t}{2}\\,D\\,\\frac{4 \\sin^{2}(k \\Delta v/2)}{\\Delta v^{2}}}.\n$$\nFor $D \\ge 0$, $|g_{\\mathrm{CN}}(k)| \\le 1$ for any $\\Delta t > 0$, so Crank–Nicolson is unconditionally stable (A-stable) for this linear diffusion operator.\n\n2. Backward Euler (fully implicit) scheme has amplification factor\n$$\ng_{\\mathrm{BE}}(k) \\;=\\; \\frac{1}{1 + \\Delta t\\,D\\,\\frac{4 \\sin^{2}(k \\Delta v/2)}{\\Delta v^{2}}},\n$$\nwhich satisfies $0 < |g_{\\mathrm{BE}}(k)| \\le 1$ for all $\\Delta t > 0$. Thus, backward Euler is also unconditionally stable.\n\nFinally, we compute the explicit maximum stable timestep for the given parameters. The Gaussian profile attains its maximum at the resonance, so\n$$\n\\max_{v} D_{vv}(v) \\;=\\; D_{vv}(v_{\\mathrm{res}}) \\;=\\; D_{0}.\n$$\nWith $\\Delta v = 1.0 \\times 10^{5}$ and $D_{0} = 4.0 \\times 10^{11}$, we have\n$$\n\\Delta v^{2} \\;=\\; (1.0 \\times 10^{5})^{2} \\;=\\; 1.0 \\times 10^{10},\n$$\nand the CFL limit for the explicit scheme is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{\\Delta v^{2}}{2\\,D_{0}}\n\\;=\\; \\frac{1.0 \\times 10^{10}}{2 \\times 4.0 \\times 10^{11}}\n\\;=\\; \\frac{1.0 \\times 10^{10}}{8.0 \\times 10^{11}}\n\\;=\\; 1.25 \\times 10^{-2}.\n$$\nExpressed in seconds and rounded to four significant figures, the maximum stable timestep is $1.250 \\times 10^{-2}$.",
            "answer": "$$\\boxed{1.250 \\times 10^{-2}}$$"
        }
    ]
}