{
    "hands_on_practices": [
        {
            "introduction": "微撕裂模（MTMs）是由电子温度梯度中储存的自由能驱动的。本练习将等离子体分布参数与主要的MTM不稳定性参数 $\\eta_e$ 建立了具体的联系。通过根据给定的密度和温度分布计算 $\\eta_e$ 并评估其对稳定性的影响，您将亲身体会到该模式的基本驱动机制 。",
            "id": "4200707",
            "problem": "考虑一个大环径比的托卡马克，其小半径为 $a$，且平衡仅随径向 $r \\in [0,a]$ 变化。设电子密度分布为 $n_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p$，电子温度分布为 $T_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q$，其中 $n_0$、$T_0$、$p$ 和 $q$ 是正常数，而 $B$ 是均匀的环向磁场强度。假设微撕裂模不稳定的波数排序为 $k_y \\rho_e \\ll 1$ 且电子处于半碰撞区，定义为 $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$，其中 $\\lambda_{\\mathrm{mfp}} = v_{te}/\\nu_e$ 是平均自由程，$v_{te} = \\sqrt{2 T_e/m_e}$ 是电子热速度，$\\nu_e$ 是电子碰撞频率。设磁剪切弱但有限，并关注平行矢量势 $A_{\\parallel}$ 的重联宇称分量。\n\n从梯度标长 $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ 和 $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$ 的基本定义出发，在给定 $p = 1.7$ 和 $q = 3.1$ 的条件下，构建在半径 $r_0 = \\frac{a}{2}$ 处的局域电子温度梯度参数 $\\eta_e = \\frac{L_n}{L_{T_e}}$。然后，利用半碰撞区中电子平行力平衡和能量方程的第一性原理线性化，并结合安培定律，确定在 $r_0$ 附近固定 $k_y$ 时 $\\frac{d \\gamma}{d \\eta_e}$ 的符号，其中 $\\gamma$ 是微撕裂模的线性增长率。如果增加 $\\eta_e$（在其他参数固定的情况下）会增加 $\\gamma$（使模式失稳），则将您的定性稳定性预测数值编码为 $+1$；如果增加 $\\eta_e$ 会减小 $\\gamma$（使模式稳定），则编码为 $-1$。\n\n您必须给出一个包含两个条目的最终答案：第一个条目是 $\\eta_e(r_0)$ 的值（无量纲），四舍五入到四位有效数字；第二个条目是 $\\frac{d \\gamma}{d \\eta_e}$ 的符号，编码为 $+1$ 或 $-1$（无量纲）。提供最终答案时无需单位。",
            "solution": "该问题要求计算与托卡马克等离子体中的微撕裂模（MTM）相关的两个量。首先，我们必须计算在特定半径处的局域电子温度梯度参数 $\\eta_e$。其次，我们必须确定 MTM 线性增长率 $\\gamma$ 相对于 $\\eta_e$ 的导数符号，该符号表明增加 $\\eta_e$ 是起稳定作用还是失稳作用。\n\n第一部分：$\\eta_e(r_0)$ 的计算\n\n参数 $\\eta_e$ 定义为电子密度梯度标长 $L_n$ 与电子温度梯度标长 $L_{T_e}$ 之比。\n$$\n\\eta_e = \\frac{L_n}{L_{T_e}}\n$$\n梯度标长定义为 $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ 和 $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$。给定的电子密度和温度分布如下：\n$$\nn_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p\n$$\n$$\nT_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q\n$$\n首先，我们计算电子密度 $n_e$ 的对数导数。$n_e(r)$ 的自然对数为：\n$$\n\\ln n_e(r) = \\ln n_0 + p \\ln\\left(1 - \\frac{r^2}{a^2}\\right)\n$$\n对小半径 $r$ 求导：\n$$\n\\frac{d \\ln n_e}{dr} = 0 + p \\cdot \\frac{1}{1 - \\frac{r^2}{a^2}} \\cdot \\left(-\\frac{2r}{a^2}\\right) = -\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n因此，密度的逆梯度标长为 $\\frac{1}{L_n} = -\\frac{d \\ln n_e}{dr}$：\n$$\n\\frac{1}{L_n(r)} = \\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n通过直接类比，对于电子温度分布 $T_e(r)$，我们可以用参数 $q$ 替换参数 $p$：\n$$\n\\frac{d \\ln T_e}{dr} = -\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n温度的逆梯度标长为 $\\frac{1}{L_{T_e}} = -\\frac{d \\ln T_e}{dr}$：\n$$\n\\frac{1}{L_{T_e}(r)} = \\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n现在我们可以通过计算逆标长之比来计算 $\\eta_e(r)$：\n$$\n\\eta_e(r) = \\frac{L_n(r)}{L_{T_e}(r)} = \\frac{1/L_{T_e}(r)}{1/L_n(r)} = \\frac{\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}}{\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}} = \\frac{q}{p}\n$$\n对于这种特定的分布函数形式，参数 $\\eta_e$ 是一个常数，与径向位置 $r$ 无关。给定常数 $p = 1.7$ 和 $q = 3.1$。因此，在任何半径处（包括 $r_0 = a/2$）的 $\\eta_e$ 值为：\n$$\n\\eta_e = \\frac{3.1}{1.7} \\approx 1.823529...\n$$\n按要求四舍五入到四位有效数字，我们得到：\n$$\n\\eta_e(r_0) \\approx 1.824\n$$\n\n第二部分：稳定性对 $\\eta_e$ 的依赖性\n\n接下来，我们必须确定 $\\frac{d\\gamma}{d\\eta_e}$ 的符号，其中 $\\gamma$ 是微撕裂模的线性增长率。这需要对基本的不稳定性机制有所理解。\n\n微撕裂模是由储存在电子温度梯度中的自由能驱动的电磁不稳定性。这种模式涉及磁扰动，主要体现在平行矢量势 $\\tilde{A}_{\\parallel}$ 中，这会导致小磁岛的形成和磁力线的随机化。\n\n该分析从三个基本方程开始：\n1.  **安培定律**：它将磁扰动与电子电流扰动 $\\tilde{j}_{\\parallel e}$ 联系起来。在平板几何中，表达式为 $-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\tilde{j}_{\\parallel e}$。扰动的形式为 $\\exp(ik_y y - i\\omega t)$，其中 $\\omega = \\omega_r + i\\gamma$。增长模的 $\\gamma > 0$。\n2.  **电子平行力平衡（广义欧姆定律）**：此方程确定平行电流。响应于平行电场 $\\tilde{E}_{\\parallel} = -\\frac{\\partial \\tilde{A}_{\\parallel}}{\\partial t} - \\nabla_{\\parallel} \\tilde{\\phi} = i\\omega \\tilde{A}_{\\parallel} - ik_{\\parallel} \\tilde{\\phi}$，电子会产生电流。该响应取决于碰撞性。此平衡中的一个关键项是热力，它与电子温度扰动的平行梯度 $\\nabla_{\\parallel} \\tilde{T}_e$ 成正比。\n3.  **电子能量平衡**：此方程确定温度扰动 $\\tilde{T}_e$。它平衡了来自场平行输运、磁力线颤振及其他源和汇的加热/冷却效应。\n\n在半碰撞区 $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$ 中的不稳定性机制依赖于特定的相位关系。自由能来源是背景温度梯度 $\\nabla_r T_e = -T_e/L_{T_e}$。这种能量通过电子沿扰动磁力线运动产生的径向热输运而释放。能量释放率与 $\\langle \\tilde{q}_r \\left(-\\nabla_r T_e\\right) \\rangle$ 成正比，其中 $\\tilde{q}_r = \\tilde{q}_{\\parallel e}(\\tilde{B}_r/B)$ 是由于沿径向扰动磁力线 $\\tilde{B}_r = ik_y \\tilde{A}_{\\parallel}$ 的平行热输运引起的径向热通量。\n\n为产生不稳定性（$\\gamma > 0$），必须有能量从背景热梯度净转移到电磁场扰动。当电子电流扰动 $\\tilde{j}_{\\parallel e}$ 与感应电场扰动 $\\tilde{E}_{\\parallel,ind} = i\\omega \\tilde{A}_{\\parallel}$ 部分同相时，就会发生这种情况。所需的相移由电子碰撞与热力共同提供。\n\n不稳定性驱动的强度与自由能来源的大小成正比，即电子温度梯度。\n$$\n\\text{驱动} \\propto \\left| \\frac{dT_e}{dr} \\right| \\propto \\frac{1}{L_{T_e}}\n$$\n增长率 $\\gamma$ 是该驱动的函数，因此在一级近似下，我们可以写出：\n$$\n\\gamma \\propto \\frac{1}{L_{T_e}}\n$$\n问题要求 $\\gamma$ 对 $\\eta_e = L_n/L_{T_e}$ 的依赖关系。我们可以用 $\\eta_e$ 和密度梯度标长 $L_n$ 来表示驱动：\n$$\n\\frac{1}{L_{T_e}} = \\frac{\\eta_e}{L_n}\n$$\n因此，增长率的依赖关系可以写成：\n$$\n\\gamma \\propto \\frac{\\eta_e}{L_n}\n$$\n问题要求在其他参数固定时 $\\frac{d\\gamma}{d\\eta_e}$ 的符号。在理论和实验背景下，“其他参数”通常指诸如 $L_n$、磁剪切、等离子体比压和碰撞性等量。在此标准假设下（即保持 $L_n$ 不变），增长率 $\\gamma$ 与 $\\eta_e$ 成正比。\n$$\n\\frac{d\\gamma}{d\\eta_e} \\propto \\frac{1}{L_n}\n$$\n由于 $L_n = \\frac{a^2(1 - r_0^2/a^2)}{2pr_0}$ 是一个正量（给定 $p>0$ 和 $r_0 \\in (0,a)$），该导数必须为正。\n$$\n\\frac{d\\gamma}{d\\eta_e} > 0\n$$\n这表明，相对于密度梯度，增加电子温度梯度对微撕裂模起失稳作用。对于给定的密度分布，更大的 $\\eta_e$ 意味着更陡峭的温度分布，从而提供更多自由能来驱动不稳定性。此正号的数值编码为 $+1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.824 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "微撕裂模核心的磁重联发生在非常窄的“内层”中，该层内的物理过程决定了模式的结构和增长率。本练习将指导您从第一性原理出发，推导在无碰撞惯性区中该层的特征宽度。您将发现该宽度即为基本的物理尺度——电子趋肤深度 $d_e$ 。",
            "id": "4012370",
            "problem": "考虑一个均匀平板等离子体中的无碰撞微撕裂模 (MTM)，其平衡磁场 $B_0$ 沿 $z$ 方向。设扰动主要由一个重联平行矢量势 $A_{\\parallel}(x,t)$ 决定，该矢量势在 $x$ 方向上一个宽度为 $\\delta$ 的窄内层中变化。假设等离子体贝塔值较低，以至于位移电流可以忽略不计。电子密度取为常数 $n_0$，并忽略碰撞。在内层中，假设电子平行动量平衡主要由惯性项和感应电场决定，因此欧姆定律的平行分量由电子惯性项和电场的感应部分控制。将时间依赖性视为谐波形式，$A_{\\parallel}(x,t) = \\Re\\{ \\tilde{A}_{\\parallel}(x) \\exp(-\\mathrm{i}\\,\\omega t) \\}$。\n\n从电子平行动量方程、麦克斯韦-安培定律和法拉第定律出发，并使用内层标度关系 $\\nabla_{\\perp}^2 A_{\\parallel} \\sim A_{\\parallel}/\\delta^2$（其中 $\\nabla_{\\perp} \\equiv \\partial/\\partial x$），推导惯性内层宽度 $\\delta$ 的解析表达式，用电子质量 $m_e$、电子电荷 $e$、电子数密度 $n_0$ 和自由空间磁导率 $\\mu_0$ 来表示。您也可以等效地使用光速 $c$ 和电子等离子体频率 $\\omega_{pe}$ 来表示您的最终结果，其中 $\\omega_{pe}^2 = n_0 e^2 / (\\epsilon_0 m_e)$，$\\epsilon_0$ 是真空介电常数。请以米为单位表示您的最终答案。无需进行数值计算。",
            "solution": "本问题要求推导无碰撞微撕裂模的惯性内层宽度 $\\delta$。我们从指定的三个基本定律开始：电子平行动量方程、麦克斯韦-安培定律和法拉第定律，并基于给定的假设。\n\n首先，我们考虑电子平行动量方程。问题指出，在内层中，平衡主要由电子惯性和感应电场主导。电子的线性化平行动量方程为：\n$$m_e \\frac{\\partial v_{e\\parallel}}{\\partial t} = -e E_{\\parallel}$$\n这里，$m_e$ 是电子质量，$v_{e\\parallel}$ 是平行于平衡磁场的扰动电子流体速度，$e$ 是元电荷，$E_{\\parallel}$ 是扰动电场的平行分量。我们已经利用了平衡密度为常数 $n_0$ 这一事实，并将其从方程两边约去。\n\n其次，根据法拉第定律，我们通过 $\\mathbf{E} = -\\nabla\\phi - \\frac{\\partial \\mathbf{A}}{\\partial t}$ 将电场 $\\mathbf{E}$ 与标量势 $\\phi$ 和矢量势 $\\mathbf{A}$ 联系起来。问题指导我们对于平行分量只考虑“电场的感应部分”，这意味着我们忽略来自标量势的项 $-\\nabla_{\\parallel}\\phi$。因此，我们有：\n$$E_{\\parallel} = -\\frac{\\partial A_{\\parallel}}{\\partial t}$$\n其中 $A_{\\parallel}$ 是矢量势的平行分量。\n\n将 $E_{\\parallel}$ 的这个表达式代入动量方程，得到：\n$$m_e \\frac{\\partial v_{e\\parallel}}{\\partial t} = -e \\left(-\\frac{\\partial A_{\\parallel}}{\\partial t}\\right) = e \\frac{\\partial A_{\\parallel}}{\\partial t}$$\n问题指定扰动具有 $\\exp(-\\mathrm{i}\\omega t)$ 形式的谐波时间依赖性。对于扰动量的复振幅（用波浪号表示，例如 $\\tilde{A}_{\\parallel}$），时间导数算符 $\\frac{\\partial}{\\partial t}$ 等效于乘以 $-\\mathrm{i}\\omega$。将此应用于动量方程，得到：\n$$m_e (-\\mathrm{i}\\omega) \\tilde{v}_{e\\parallel} = e (-\\mathrm{i}\\omega) \\tilde{A}_{\\parallel}$$\n对于频率 $\\omega \\neq 0$ 的非平凡模式，我们可以除以 $-\\mathrm{i}\\omega$，从而找到电子速度和矢量势之间的直接关系：\n$$\\tilde{v}_{e\\parallel} = \\frac{e}{m_e} \\tilde{A}_{\\parallel}$$\n平行电流密度 $j_{\\parallel}$ 主要由电子承载（离子要重得多，在相关频率下其响应可以忽略不计）。因此，扰动平行电流密度为 $\\tilde{j}_{\\parallel} = -n_0 e \\tilde{v}_{e\\parallel}$。代入 $\\tilde{v}_{e\\parallel}$ 的表达式：\n$$\\tilde{j}_{\\parallel} = -n_0 e \\left(\\frac{e}{m_e} \\tilde{A}_{\\parallel}\\right) = -\\frac{n_0 e^2}{m_e} \\tilde{A}_{\\parallel}$$\n这就构成了由电子惯性决定的有效平行欧姆定律。\n\n第三，我们使用麦克斯韦-安培定律，$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$。问题指出要忽略位移电流项 $\\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$，这对于低贝塔值、低频现象是合适的。该定律简化为：\n$$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$$\n用矢量势表示磁场，$\\mathbf{B} = \\nabla \\times \\mathbf{A}$，并使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}$ 以及库仑规范选择 $\\nabla \\cdot \\mathbf{A} = 0$，我们得到：\n$$-\\nabla^2\\mathbf{A} = \\mu_0\\mathbf{J}$$\n对扰动量取平行分量，我们有：\n$$-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\tilde{j}_{\\parallel}$$\n现在，我们将此结果与我们推导出的欧姆定律结合，通过代入 $\\tilde{j}_{\\parallel}$ 的表达式：\n$$-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\left( -\\frac{n_0 e^2}{m_e} \\tilde{A}_{\\parallel} \\right)$$\n$$\\nabla^2 \\tilde{A}_{\\parallel} = \\left( \\frac{\\mu_0 n_0 e^2}{m_e} \\right) \\tilde{A}_{\\parallel}$$\n这是惯性层内平行矢量势的控制方程。问题指定了内层标度关系，其中垂直梯度占主导地位，$\\nabla^2 \\approx \\nabla_{\\perp}^2 \\equiv \\frac{\\partial^2}{\\partial x^2}$。方程变为：\n$$\\frac{\\partial^2 \\tilde{A}_{\\parallel}}{\\partial x^2} = \\left( \\frac{\\mu_0 n_0 e^2}{m_e} \\right) \\tilde{A}_{\\parallel}$$\n这是一个形式为 $\\frac{d^2y}{dx^2} = k^2 y$ 的标准二阶线性常微分方程，其解的特征尺度长度为 $1/k$。惯性内层宽度 $\\delta$ 对应于此特征尺度。通过比较形式，我们确定：\n$$\\frac{1}{\\delta^2} = \\frac{\\mu_0 n_0 e^2}{m_e}$$\n解出 $\\delta$ 得到：\n$$\\delta = \\sqrt{\\frac{m_e}{\\mu_0 n_0 e^2}}$$\n问题允许使用真空中的光速 $c$ 和电子等离子体频率 $\\omega_{pe}$ 来表示此结果。定义为 $c^2 = 1/(\\mu_0 \\epsilon_0)$ 和 $\\omega_{pe}^2 = n_0 e^2 / (m_e \\epsilon_0)$。我们可以写出 $\\mu_0 = 1/(\\epsilon_0 c^2)$ 并将其代入 $\\delta^2$ 的表达式中：\n$$\\delta^2 = \\frac{m_e}{(\\frac{1}{\\epsilon_0 c^2}) n_0 e^2} = \\frac{m_e \\epsilon_0 c^2}{n_0 e^2}$$\n重新整理各项以使用 $\\omega_{pe}^2$ 的定义：\n$$\\delta^2 = c^2 \\left( \\frac{m_e \\epsilon_0}{n_0 e^2} \\right) = \\frac{c^2}{\\omega_{pe}^2}$$\n取平方根得到惯性层宽度的最终表达式，这被认为是电子趋肤深度：\n$$\\delta = \\frac{c}{\\omega_{pe}}$$",
            "answer": "$$\\boxed{\\frac{c}{\\omega_{pe}}}$$"
        },
        {
            "introduction": "任何微观不稳定性的重要性最终都体现在其驱动的输运上，因为输运会降低等离子体的约束性能。本计算练习使您能够量化由MTM引起的磁随机化所导致的电子热通量，并将其与另一种关键的微观不稳定性——静电性的电子温度梯度（ETG）湍流——进行比较。通过探索不同的参数区间，您将建立起对MTM何时可能成为托卡马克中电子热量损失主导通道的直观理解 。",
            "id": "4012345",
            "problem": "构建一个程序，用于在相同的梯度参数下评估和比较由微撕裂模 (MTM) 和电子温度梯度 (ETG) 驱动的湍流所引起的电子热通量，并识别出磁力线随机性（由 $(\\delta B/B)^2$ 量化）超过静电混合的区间。您的推导和实现必须严格从以下基础出发，这些基础要么是基本定义，要么是经过充分检验的公式：\n\n1. 电子热速度：$v_{\\mathrm{te}} = \\sqrt{2 \\theta_e / m_e}$，其中 $\\theta_e = k_B T_e$ 是每个粒子的电子热能。在计算中，将 $T_e$ 作为以千电子伏 (keV) 为单位给出的能量，并使用 $1\\,\\mathrm{keV} = 10^3\\,\\mathrm{eV}$ 和 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$ 将其转换为焦耳，其中 $e$ 是基本电荷。\n2. 电子回旋频率：$\\Omega_{ce} = e B / m_e$，对于磁场 $B$。\n3. 电子回旋半径：$\\rho_e = v_{\\mathrm{te}} / \\Omega_{ce}$。\n4. 静电湍流扩散系数的混合长度估计：$\\chi_{\\mathrm{ES}} \\approx \\gamma/k_\\perp^2$，以及 ETG 峰值假设 $k_\\perp \\rho_e \\approx 1$ 和 $\\gamma \\approx C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}$，其中 $C_{\\mathrm{ETG}}$ 是一个量级为一的常数。根据这些，推导出用 $v_{\\mathrm{te}}$、$\\rho_e$、$L_{T_e}$ 和 $C_{\\mathrm{ETG}}$ 表示的 $\\chi_{\\mathrm{ETG}}$ 的显式公式。\n5. Rechester–Rosenbluth 对由随机磁力线引起的电子热扩散系数的估计：$\\chi_{\\mathrm{RR}} \\approx C_{\\mathrm{RR}} v_{\\mathrm{te}} L_c (\\delta B/B)^2$，其中平行相关长度 $L_c \\approx \\pi q R$，$q$ 是安全因子，$R$ 是大半径。$C_{\\mathrm{RR}}$ 是一个量级为一的常数。\n6. 电子传导热通量定义：$Q_e = - n_e \\chi_e \\nabla \\theta_e$，其中 $\\theta_e = k_B T_e$。假设温度梯度大小恒定为 $\\lvert \\nabla \\theta_e \\rvert = \\theta_e / L_{T_e}$。通过取其大小 $Q_e = n_e \\chi_e \\theta_e / L_{T_e}$，使用 $Q_e \\ge 0$ 来表示向外的热流。\n\n在计算中使用以下固定的数值常数：\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n- 电子质量 $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n- 数值系数 $C_{\\mathrm{ETG}} = 0.3$ 和 $C_{\\mathrm{RR}} = 1.0$。\n\n您的程序必须为每个测试案例计算：\n- 使用 $\\chi_e = \\chi_{\\mathrm{RR}}$ 计算的 $Q_{e,\\mathrm{MTM}}$，\n- 使用 $\\chi_e = \\chi_{\\mathrm{ETG}}$ 计算的 $Q_{e,\\mathrm{ETG}}$，\n- 一个布尔值，如果 $Q_{e,\\mathrm{MTM}} > Q_{e,\\mathrm{ETG}}$ 则为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n所有热通量必须以 $\\mathrm{W/m^2}$ 为单位表示。\n\n测试套件。对于下面的每个测试案例，除非另有说明，所有输入均以国际单位制 (SI) 单位指定：\n- 案例 A (基线核心区)：$B = 2.5\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 5.0\\,\\mathrm{keV}$，$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.30\\,\\mathrm{m}$，$(\\delta B/B) = 1.0 \\times 10^{-4}$。\n- 案例 B (弱磁随机性)：$B = 2.5\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 5.0\\,\\mathrm{keV}$，$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.30\\,\\mathrm{m}$，$(\\delta B/B) = 1.0 \\times 10^{-5}$。\n- 案例 C (通过构造接近平衡)：$B = 2.5\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 5.0\\,\\mathrm{keV}$，$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.30\\,\\mathrm{m}$，$(\\delta B/B) = 2.2 \\times 10^{-5}$。\n- 案例 D (强场，陡峭梯度)：$B = 5.0\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 2.0\\,\\mathrm{keV}$，$n_e = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.10\\,\\mathrm{m}$，$(\\delta B/B) = 3.0 \\times 10^{-5}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个项目对应一个测试案例，并且本身是一个形式为 $[Q_{e,\\mathrm{MTM}},Q_{e,\\mathrm{ETG}},\\mathrm{bool}]$ 的三元素列表。列表中不得包含任何空白字符。例如：$[[x_1,y_1,\\mathrm{True}],[x_2,y_2,\\mathrm{False}],\\dots]$，其中 $x_i$ 和 $y_i$ 是以 $\\mathrm{W/m^2}$ 为单位的浮点数。",
            "solution": "该问题被认为是有效的，因为它在科学上基于已确立的等离子体物理原理，是适定的，有足够的信息来获得唯一解，并以客观、正式的语言表述。所有参数和常数都在磁约束聚变装置的现实物理范围内。\n\n任务是比较由两种不同湍流机制驱动的电子热通量：导致磁力线随机化的微撕裂模 (MTM)，以及主要是静电性质的电子温度梯度 (ETG) 驱动的湍流。此比较在相同的等离子体梯度参数下进行。\n\n首先，我们必须推导由 ETG 湍流引起的电子热扩散系数 $\\chi_{\\mathrm{ETG}}$ 的表达式。问题提供了静电扩散系数的通用混合长度估计：\n$$\n\\chi_{\\mathrm{ES}} \\approx \\frac{\\gamma}{k_\\perp^2}\n$$\n其中 $\\gamma$ 是不稳定性增长率，$k_\\perp$ 是特征垂直波数。对于处于峰值增长状态的 ETG 湍流，我们有给定的标度关系：\n1.  $k_\\perp \\rho_e \\approx 1$，其中 $\\rho_e$ 是电子回旋半径。这意味着 $k_\\perp \\approx 1/\\rho_e$。\n2.  $\\gamma \\approx C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}$，其中 $C_{\\mathrm{ETG}}$ 是一个量级为一的系数，$v_{\\mathrm{te}}$ 是电子热速度，$L_{T_e}$ 是电子温度梯度标长。\n\n将这些关系代入混合长度公式，得到 ETG 湍流的扩散系数：\n$$\n\\chi_{\\mathrm{ETG}} \\approx \\frac{C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}}{(1/\\rho_e)^2} = C_{\\mathrm{ETG}} \\frac{v_{\\mathrm{te}}}{L_{T_e}} \\rho_e^2\n$$\n\n电子热通量 $Q_e$ 由菲克定律定义，$Q_e = -n_e \\chi_e \\nabla \\theta_e$。使用给定的大小近似 $|\\nabla \\theta_e| = \\theta_e / L_{T_e}$，其中 $\\theta_e$ 是电子热能，$n_e$ 是电子密度，我们得到：\n$$\nQ_e = n_e \\chi_e \\frac{\\theta_e}{L_{T_e}}\n$$\n因此，由 ETG 湍流引起的热通量为：\n$$\nQ_{e,\\mathrm{ETG}} = n_e \\chi_{\\mathrm{ETG}} \\frac{\\theta_e}{L_{T_e}} = n_e \\left(C_{\\mathrm{ETG}} \\frac{v_{\\mathrm{te}}}{L_{T_e}} \\rho_e^2\\right) \\frac{\\theta_e}{L_{T_e}} = n_e C_{\\mathrm{ETG}} v_{\\mathrm{te}} \\theta_e \\frac{\\rho_e^2}{L_{T_e}^2}\n$$\n为了计算这个值，我们需要中间量 $v_{\\mathrm{te}}$ 和 $\\rho_e$。电子热能 $\\theta_e$ 是通过将温度 $T_e$ 从千电子伏 ($\\mathrm{keV}$) 转换为焦耳得到的：\n$$\n\\theta_e[\\mathrm{J}] = T_e[\\mathrm{keV}] \\times 10^3 \\times e[\\mathrm{C}]\n$$\n电子热速度 $v_{\\mathrm{te}}$ 和回旋半径 $\\rho_e$ 则由以下公式给出：\n$$\nv_{\\mathrm{te}} = \\sqrt{\\frac{2 \\theta_e}{m_e}} \\quad \\text{和} \\quad \\rho_e = \\frac{v_{\\mathrm{te}}}{\\Omega_{ce}} = \\frac{v_{\\mathrm{te}}}{e B / m_e} = \\frac{m_e v_{\\mathrm{te}}}{e B}\n$$\n其中 $m_e$ 是电子质量，$e$ 是基本电荷，$B$ 是磁场强度。\n\n接下来，我们构建由 MTM 引起的磁随机性所导致的热通量 $Q_{e,\\mathrm{MTM}}$。此过程的扩散系数由 Rechester-Rosenbluth 公式给出：\n$$\n\\chi_{\\mathrm{RR}} = C_{\\mathrm{RR}} v_{\\mathrm{te}} L_c \\left(\\frac{\\delta B}{B}\\right)^2\n$$\n这里，$C_{\\mathrm{RR}}$ 是一个数值系数，$(\\delta B/B)$ 是归一化的磁涨落幅度，$L_c$ 是磁湍流的平行相关长度，估计为 $L_c = \\pi q R$，其中 $q$ 是安全因子，$R$ 是大半径。相应的热通量为：\n$$\nQ_{e,\\mathrm{MTM}} = n_e \\chi_{\\mathrm{RR}} \\frac{\\theta_e}{L_{T_e}} = n_e \\left( C_{\\mathrm{RR}} v_{\\mathrm{te}} (\\pi q R) \\left(\\frac{\\delta B}{B}\\right)^2 \\right) \\frac{\\theta_e}{L_{T_e}}\n$$\n\n每个测试案例的计算步骤如下：\n1.  根据给定的 $T_e$ (单位 keV) 计算 $\\theta_e$。\n2.  计算 $v_{\\mathrm{te}}$。\n3.  计算 $\\rho_e$。\n4.  计算 $\\chi_{\\mathrm{ETG}}$，然后计算 $Q_{e,\\mathrm{ETG}}$。\n5.  计算 $\\chi_{\\mathrm{RR}}$，然后计算 $Q_{e,\\mathrm{MTM}}$，确保提供的 $(\\delta B/B)$ 值被平方。\n6.  比较这两个通量，以确定是否 $Q_{e,\\mathrm{MTM}} > Q_{e,\\mathrm{ETG}}$。\n\n这些步骤将针对每组指定的等离子体参数以编程方式实现，以生成最终结果。所有计算都必须使用提供的物理常数，并以国际单位制 (SI) 单位进行。最终的热通量单位将是瓦特每平方米 ($\\mathrm{W/m^2}$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares electron heat flux for MTM and ETG turbulence.\n    \"\"\"\n    # Define physical constants and numerical coefficients\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kg\n    C_ETG = 0.3  # Coefficient for ETG turbulence\n    C_RR = 1.0   # Coefficient for Rechester-Rosenbluth transport\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (baseline core)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 1.0e-4},\n        # Case B (weak magnetic stochasticity)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 1.0e-5},\n        # Case C (near balance by construction)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 2.2e-5},\n        # Case D (high field, sharp gradient)\n        {'B': 5.0, 'R': 3.0, 'q': 2.0, 'Te_keV': 2.0, 'ne': 1.0e20, 'LTe': 0.10, 'dB_B': 3.0e-5},\n    ]\n\n    results_data = []\n    for params in test_cases:\n        B = params['B']\n        R = params['R']\n        q = params['q']\n        Te_keV = params['Te_keV']\n        ne = params['ne']\n        LTe = params['LTe']\n        dB_B = params['dB_B']\n\n        # 1. Convert electron temperature to Joules\n        theta_e = Te_keV * 1000.0 * E_CHARGE\n\n        # 2. Calculate electron thermal speed\n        v_te = np.sqrt(2.0 * theta_e / M_ELECTRON)\n\n        # 3. Calculate ETG-related quantities\n        # Electron cyclotron frequency\n        Omega_ce = E_CHARGE * B / M_ELECTRON\n        # Electron gyroradius\n        rho_e = v_te / Omega_ce\n        # ETG diffusivity\n        chi_ETG = C_ETG * (v_te / LTe) * rho_e**2\n        # ETG heat flux\n        Q_e_ETG = ne * chi_ETG * theta_e / LTe\n\n        # 4. Calculate MTM-related quantities\n        # Parallel correlation length\n        L_c = np.pi * q * R\n        # Stochastic (Rechester-Rosenbluth) diffusivity\n        chi_RR = C_RR * v_te * L_c * (dB_B)**2\n        # MTM heat flux\n        Q_e_MTM = ne * chi_RR * theta_e / LTe\n\n        # 5. Compare fluxes\n        is_mtm_dominant = Q_e_MTM > Q_e_ETG\n\n        results_data.append([Q_e_MTM, Q_e_ETG, is_mtm_dominant])\n    \n    # Format the final output string exactly as required\n    output_strings = []\n    for res in results_data:\n        q_mtm, q_etg, is_dominant = res\n        # Format each sub-list string without whitespace\n        output_strings.append(f\"[{q_mtm},{q_etg},{'True' if is_dominant else 'False'}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(output_strings)}]\")\n\nsolve()\n```"
        }
    ]
}