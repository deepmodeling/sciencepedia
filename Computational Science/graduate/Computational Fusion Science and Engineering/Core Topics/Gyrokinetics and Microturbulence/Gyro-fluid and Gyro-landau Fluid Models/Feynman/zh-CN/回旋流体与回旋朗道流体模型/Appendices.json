{
    "hands_on_practices": [
        {
            "introduction": "回旋平均是简化等离子体动理学描述的核心步骤，它将带电粒子在磁场中快速回旋运动的影响平均化。函数 $\\Gamma_0(b_s)$ 是描述此效应的关键数学工具，它关联了粒子感受到的有效电势与实际电势。本练习将引导您通过渐近分析，推导在短波极限下（即 $k_{\\perp}\\rho_s \\gg 1$）$\\Gamma_0(b_s)$ 的行为，从而从物理上理解回旋平均如何导致离子极化屏蔽效应的饱和。",
            "id": "3988079",
            "problem": "考虑一个磁化等离子体组分 $s$，其热拉莫尔半径为 $\\rho_s$，垂直波数为 $k_{\\perp}$，并定义有限拉莫尔半径参数 $b_s \\equiv k_{\\perp}^{2}\\rho_s^{2}$。在用于静电涨落的回旋动理学 (GK) 和回旋朗道流体 (GLF) 闭合中，组分极化通过回旋平均形状因子 $\\Gamma_0(b_s)$ 进入准中性条件，该因子可以写成回旋相位平均积分的形式：\n$$\n\\Gamma_0(b_s) \\equiv \\frac{1}{2\\pi}\\exp(-b_s)\\int_{0}^{2\\pi}\\exp\\!\\big(b_s\\cos\\theta\\big)\\,\\mathrm{d}\\theta.\n$$\n从这个积分表示出发，并使用适用于大 $b_s$ 的渐近分析，推导当 $b_s \\to \\infty$ 时 $\\Gamma_0(b_s)$ 的渐近展开的领头阶和次领头阶项。您的推导应从上述基本定义出发，通过系统地近似大 $b_s$ 情况下的积分来进行，并且不得引用任何直接给出答案的快捷公式。\n\n然后，利用 GK/GLF 准中性条件的结构，简要解释您的结果在 $k_{\\perp}\\rho_s \\gg 1$ 极限下对静电势的短波屏蔽的物理含义。\n\n将您最终的 $\\Gamma_0(b_s)$ 渐近表达式表示为包含直到 $b_s^{-3/2}$ 阶项的单一闭合形式解析表达式。无需进行数值四舍五入。量 $\\Gamma_0(b_s)$ 是无量纲的，因此在您的最终表达式中不需要物理单位。",
            "solution": "该问题要求从回旋平均形状因子 $\\Gamma_0(b_s)$ 的积分定义出发，推导其在参数 $b_s$ 值很大时的渐近展开。随后，需要讨论这一结果的物理含义。\n\n$\\Gamma_0(b_s)$ 的积分表示由下式给出：\n$$\n\\Gamma_0(b_s) = \\frac{1}{2\\pi}\\exp(-b_s)\\int_{0}^{2\\pi}\\exp(b_s\\cos\\theta)\\,\\mathrm{d}\\theta\n$$\n我们寻求 $b_s \\to \\infty$ 时的渐近展开。该积分是 $\\int \\exp(\\lambda f(x)) g(x) dx$ 的形式，其中有一个大参数 $\\lambda = b_s$。我们可以使用拉普拉斯方法来计算它。其核心思想是，对于大的 $b_s$，积分的值主要由指数中的函数 $\\cos\\theta$ 达到其最大值的点附近的贡献所主导。\n\n在积分区间 $[0, 2\\pi]$ 内，函数 $f(\\theta) = \\cos\\theta$ 在 $\\theta=0$ 处有最大值 $f(0) = 1$。被积函数以 $2\\pi$ 为周期，因此在 $[0, 2\\pi]$ 上积分等价于在 $[-\\pi, \\pi]$ 上积分，这对于在 $\\theta=0$ 处的最大值附近进行展开更为方便。该积分关于 $\\theta=0$ 是对称的。\n\n令 $I(b_s) = \\int_{0}^{2\\pi}\\exp(b_s\\cos\\theta)\\,\\mathrm{d}\\theta = \\int_{-\\pi}^{\\pi}\\exp(b_s\\cos\\theta)\\,\\mathrm{d}\\theta$。被积函数在 $\\theta=0$ 附近呈尖峰状。我们可以用 $\\cos\\theta$ 在 $\\theta=0$ 附近的泰勒级数展开来近似它：\n$$\n\\cos\\theta = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - O(\\theta^6) = 1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\n$$\n将此代入积分，得到：\n$$\nI(b_s) = \\int_{-\\pi}^{\\pi} \\exp\\left(b_s\\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)\\right)\\,\\mathrm{d}\\theta\n$$\n$$\nI(b_s) = \\exp(b_s) \\int_{-\\pi}^{\\pi} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right) \\exp\\left(\\frac{b_s\\theta^4}{24} - \\dots\\right)\\,\\mathrm{d}\\theta\n$$\n对于大的 $b_s$，高斯项 $\\exp(-b_s\\theta^2/2)$ 确保了只有非常小的 $\\theta$ 值（量级为 $b_s^{-1/2}$）有显著贡献。在这个区域，第二个指数函数的宗量 $b_s\\theta^4/24$ 很小。因此，我们可以将第二个指数函数展开为级数：\n$$\n\\exp\\left(\\frac{b_s\\theta^4}{24} - \\dots\\right) \\approx 1 + \\left(\\frac{b_s\\theta^4}{24}\\right) + \\dots\n$$\n我们包含那些将产生所需精度阶数的项。\n$$\nI(b_s) \\approx \\exp(b_s) \\int_{-\\pi}^{\\pi} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right) \\left(1 + \\frac{b_s\\theta^4}{24}\\right)\\,\\mathrm{d}\\theta\n$$\n由于对于大的 $|\\theta|$，被积函数可以忽略不计，我们可以将积分限从 $[-\\pi, \\pi]$ 扩展到 $(-\\infty, \\infty)$，其误差呈指数级小。\n$$\nI(b_s) \\approx \\exp(b_s) \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta + \\frac{b_s}{24} \\int_{-\\infty}^{\\infty} \\theta^4 \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta \\right]\n$$\n这些是标准高斯积分。第一个是形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x = \\sqrt{\\pi/a}$ 的高斯积分。当 $a = b_s/2$ 时，我们得到：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta = \\sqrt{\\frac{\\pi}{b_s/2}} = \\sqrt{\\frac{2\\pi}{b_s}}\n$$\n第二个积分是高斯分布的一个矩，$\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^2)\\,\\mathrm{d}x = \\frac{(2n)!}{n!(4a)^n}\\sqrt{\\frac{\\pi}{a}}$。对于 $n=2$ 和 $a=b_s/2$：\n$$\n\\int_{-\\infty}^{\\infty} \\theta^4 \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta = \\frac{4!}{2!(4b_s/2)^2}\\sqrt{\\frac{\\pi}{b_s/2}} = \\frac{24}{2(2b_s)^2} \\sqrt{\\frac{2\\pi}{b_s}} = \\frac{12}{4b_s^2} \\sqrt{\\frac{2\\pi}{b_s}} = \\frac{3}{b_s^2}\\sqrt{\\frac{2\\pi}{b_s}}\n$$\n将这些结果代回 $I(b_s)$ 的表达式中：\n$$\nI(b_s) \\approx \\exp(b_s) \\left[ \\sqrt{\\frac{2\\pi}{b_s}} + \\frac{b_s}{24} \\left(\\frac{3}{b_s^2}\\sqrt{\\frac{2\\pi}{b_s}}\\right) \\right]\n$$\n$$\nI(b_s) \\approx \\exp(b_s) \\sqrt{\\frac{2\\pi}{b_s}} \\left[ 1 + \\frac{3b_s}{24b_s^2} \\right] = \\exp(b_s) \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right)\n$$\n现在，我们将积分 $I(b_s)$ 的这个渐近展开代回 $\\Gamma_0(b_s)$ 的定义中：\n$$\n\\Gamma_0(b_s) = \\frac{1}{2\\pi}\\exp(-b_s) I(b_s) \\approx \\frac{1}{2\\pi}\\exp(-b_s) \\left[ \\exp(b_s) \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right) \\right]\n$$\n$$\n\\Gamma_0(b_s) \\approx \\frac{1}{2\\pi} \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right) = \\frac{1}{\\sqrt{4\\pi^2}} \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right) = \\frac{1}{\\sqrt{2\\pi b_s}} \\left( 1 + \\frac{1}{8b_s} \\right)\n$$\n这个表达式包含了量级为 $b_s^{-1/2}$ 和 $b_s^{-3/2}$ 的项，正如所要求的那样。\n\n接下来，我们讨论这个结果的物理含义。参数 $b_s \\equiv k_{\\perp}^{2}\\rho_s^{2}$ 在短波极限下变得很大，即当垂直波数 $k_{\\perp}$ 远大于拉莫尔半径 $\\rho_s$ 的倒数时（$k_{\\perp}\\rho_s \\gg 1$）。我们的渐近结果 $\\Gamma_0(b_s) \\approx (2\\pi b_s)^{-1/2}$ 表明，当 $b_s \\to \\infty$ 时，$\\Gamma_0(b_s) \\to 0$。\n\n函数 $\\Gamma_0(b_s)$ 代表了回旋平均对粒子所感受到的静电势的影响。粒子的导心响应的不是局域势 $\\phi$，而是 $\\phi$ 在其拉莫尔轨道上的平均值。在短波极限下（$k_{\\perp}\\rho_s \\gg 1$），电势在拉莫尔轨道的空间尺度上快速振荡。回旋平均过程导致强烈的抵消，使得导心所看到的有效势非常小。数学结果 $\\Gamma_0(b_s) \\to 0$ 是对这种物理效应的定量陈述。\n\n在回旋动理学和回旋朗道流体理论中，准中性条件将不同组分的扰动密度与静电势联系起来。对于离子，强制执行准中性的电势响应通常涉及一个与 $(1-\\Gamma_0(b_i))\\phi$ 成正比的“极化”项。\n- 在长波极限下（$k_{\\perp}\\rho_i \\ll 1$），$b_i \\ll 1$ 且 $\\Gamma_0(b_i) \\approx 1-b_i = 1-k_{\\perp}^2\\rho_i^2$。屏蔽项则近似为 $(1-(1-k_{\\perp}^2\\rho_i^2))\\phi = k_{\\perp}^2\\rho_i^2 \\phi$。这是众所周知的极化漂移响应，其中屏蔽效应与 $k_{\\perp}^2$ 成比例变化。\n- 在短波极限下（$k_{\\perp}\\rho_i \\gg 1$），我们的结果表明 $\\Gamma_0(b_i) \\to 0$。因此屏蔽项趋近于 $(1-0)\\phi = \\phi$。\n\n这意味着对于短波涨落，离子屏蔽响应会饱和。离子的响应不再随 $k_{\\perp}^2$ 增加，而是变得等同于非磁化等离子体的响应，提供一个恒定水平的类德拜屏蔽。离子在屏蔽短波扰动方面变得无效，因为它们大的拉莫尔轨道会平均掉电势的精细空间结构。这种离子屏蔽的饱和是等离子体湍流中的一个关键效应，因为它允许短波不稳定性（如电子温度梯度（ETG）模）的存在。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2\\pi b_s}} \\left(1 + \\frac{1}{8b_s}\\right)}\n$$"
        },
        {
            "introduction": "在回旋流体模型中，处理无碰撞阻尼（如朗道阻尼）是关键挑战，这通常通过构建动理学闭合来实现。一个常见且有效的方法是使用有理函数（Padé近似）来模拟精确的动理学响应函数。本练习将让您亲手实现一个用于描述平行温度微扰衰减的Padé近似闭合，并将其结果与精确的动理学理论预测进行比较，从而深入理解GLF模型在捕捉关键动理学效应方面的保真度与局限性。",
            "id": "3988096",
            "problem": "考虑一个无碰撞、均匀的单组分等离子体，其中施加了一个小的、沿磁力线以单一傅里叶模式变化的驻波平行温度微扰，即 $T_{\\parallel}(z,t) = \\Re\\{\\hat{T}(t)\\exp(i k_{\\parallel} z)\\}$。在线性回旋朗道流体闭合中，平行热通量矩 $q_{\\parallel}$ 使用朗道流体近似进行闭合，该近似通过一个频率相关的非局域算符来恢复无碰撞相混合。设归一化复参数为 $\\zeta \\equiv \\omega / (|k_{\\parallel}| v_{\\mathrm{th}})$，其中 $\\omega$ 是复频率，$k_{\\parallel}$ 是平行波数，$v_{\\mathrm{th}}$ 是热速度，定义为 $v_{\\mathrm{th}} = \\sqrt{2 T_0/m}$，其中 $T_0$ 是背景温度，$m$ 是粒子质量。\n\n傅里叶空间中的线性化平行温度矩方程（对于小微扰且忽略源项）可以写为 $-i \\omega \\hat{T} = -\\frac{2}{3} \\frac{i k_{\\parallel}}{n_0} \\hat{q}_{\\parallel}$，其中 $n_0$ 是背景密度。动理学闭合通过等离子体色散函数 $Z(\\zeta)$ 确定了比值 $\\hat{q}_{\\parallel}/\\hat{T}$，该函数定义为 $Z(\\zeta) \\equiv \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} \\frac{e^{-s^2}}{s - \\zeta} \\, ds$（朗道围道）。对于纯粹非周期的驻波微扰，取 $\\zeta = i s$，其中 $s > 0$ 为实数，因此 $\\omega = i \\gamma$，$\\gamma > 0$ 为衰减率。在这种情况下，精确的动理学映射为耗散耦合产生一个正实系数。热通量与温度比值的动理学耦合的一个方便的归一化是通过\n$$\n\\mathcal{D}_{\\mathrm{exact}}(s) \\equiv \\operatorname{Re}\\{-\\zeta Z(\\zeta)\\}\\big|_{\\zeta = i s} = \\sqrt{\\pi}\\, s\\, e^{s^2} \\operatorname{erfc}(s),\n$$\n其中 $\\operatorname{erfc}(s)$ 是互补误差函数，并使用了恒等式 $Z(i s) = i \\sqrt{\\pi} e^{s^2} \\operatorname{erfc}(s)$。通过这种归一化，精确动理学理论预测的衰减率为\n$$\n\\gamma_{\\mathrm{exact}}(s) = \\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}}\\, \\mathcal{D}_{\\mathrm{exact}}(s)。\n$$\n\n回旋朗道流体闭合用有理（帕德）形式近似动理学非局域算符，该形式能同时再现小 $s$ 展开和大 $s$ 渐近极限。匹配 $\\mathcal{D}_{\\mathrm{exact}}(s)$ 在 $s=0$ 附近的泰勒展开系数，\n$$\n\\mathcal{D}_{\\mathrm{exact}}(s) = \\sqrt{\\pi} s - 2 s^2 - \\frac{4}{3} s^3 + \\mathcal{O}(s^4),\n$$\n并强制执行大 $s$ 极限 $\\lim_{s\\to\\infty} \\mathcal{D}_{\\mathrm{exact}}(s) = 1$。满足这些约束的最小双极点帕德近似是\n$$\n\\mathcal{D}_{\\mathrm{LF}}(s) \\equiv \\frac{\\sqrt{\\pi}\\, s + a s^2}{1 + b s + a s^2},\n$$\n其中系数 $a$ 和 $b$ 由匹配条件确定：\n$$\na - b \\sqrt{\\pi} = -2, \\qquad \\lim_{s\\to\\infty} \\frac{\\sqrt{\\pi} s + a s^2}{1 + b s + a s^2} = 1, \\qquad \\text{及} \\qquad s^3 \\text{ 的系数等于 } -\\frac{4}{3}。\n$$\n解得 $a = \\frac{-\\frac{4}{3}\\sqrt{\\pi} - 4}{2 - \\pi}$ 和 $b = \\frac{a + 2}{\\sqrt{\\pi}}$。使用 $\\mathcal{D}_{\\mathrm{LF}}(s)$，回旋朗道流体衰减率为\n$$\n\\gamma_{\\mathrm{LF}}(s) = \\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}}\\, \\mathcal{D}_{\\mathrm{LF}}(s)。\n$$\n\n您的任务是实现一个程序，该程序：\n- 不接受任何输入，并使用以下固定的物理参数：$|k_{\\parallel}| = 12.5$（单位为 $\\mathrm{m}^{-1}$）和 $v_{\\mathrm{th}} = 1.0 \\times 10^6$（单位为 $\\mathrm{m/s}$）。\n- 对于一组选定的归一化非周期参数 $s \\in \\{0.0, 0.1, 1.0, 10.0\\}$，计算 $\\gamma_{\\mathrm{LF}}(s)$ 和 $\\gamma_{\\mathrm{exact}}(s)$。\n- 对 $\\mathcal{D}_{\\mathrm{exact}}(s)$ 使用带有互补误差函数 $\\operatorname{erfc}(s)$ 的精确动理学公式，对 $\\mathcal{D}_{\\mathrm{LF}}(s)$ 使用按上述规定计算的帕德系数 $a$ 和 $b$。\n- 以浮点数形式生成结果，单位为 $\\mathrm{s}^{-1}$。\n\n测试套件规范：\n- 情况 $s = 0.0$：边界情况；两种模型均预测衰减为零。\n- 情况 $s = 0.1$：小 $s$ 区域；测试小 $s$ 展开行为。\n- 情况 $s = 1.0$：中间区域；测试帕德闭合相对于精确动理学映射的准确性。\n- 情况 $s = 10.0$：大 $s$ 区域；测试两种模型趋向渐近极限的情况。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表。该列表必须按给定顺序，为每个 $s$ 包含一对 $\\gamma_{\\mathrm{LF}}(s)$ 和 $\\gamma_{\\mathrm{exact}}(s)$。对于四个测试值 $s$，输出必须包含八个数字，顺序为 $[\\gamma_{\\mathrm{LF}}(0.0),\\gamma_{\\mathrm{exact}}(0.0),\\gamma_{\\mathrm{LF}}(0.1),\\gamma_{\\mathrm{exact}}(0.1),\\gamma_{\\mathrm{LF}}(1.0),\\gamma_{\\mathrm{exact}}(1.0),\\gamma_{\\mathrm{LF}}(10.0),\\gamma_{\\mathrm{exact}}(10.0)]$。",
            "solution": "问题陈述已经过严格验证，并被确定为**有效**的。它在科学上基于等离子体动理学理论和计算流体建模的原理，问题设定良好、客观、自洽且数学上一致。任务是根据明确提供的物理模型和参数实现一个数值计算。\n\n该问题要求计算无碰撞、均匀等离子体中平行温度微扰的非周期衰减率 $\\gamma$。此速率使用两种不同的理论模型，针对一组指定的物理参数和一系列归一化的频率参数进行计算。\n\n给定的物理参数为：\n-   平行波数：$|k_{\\parallel}| = 12.5 \\, \\mathrm{m}^{-1}$\n-   热速度：$v_{\\mathrm{th}} = 1.0 \\times 10^6 \\, \\mathrm{m/s}$\n\n衰减率将针对一组归一化非周期参数 $s \\in \\{0.0, 0.1, 1.0, 10.0\\}$进行评估。\n\n两种模型中衰减率的一般形式为：\n$$ \\gamma(s) = \\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}} \\mathcal{D}(s) $$\n其中 $\\mathcal{D}(s)$ 是一个归一化的耗散耦合函数，在两种模型中有所不同。公共前置因子在整个计算过程中是一个常数：$\\frac{2}{3} \\times 12.5 \\times 1.0 \\times 10^6 \\, \\mathrm{s}^{-1} \\approx 8.333 \\times 10^6 \\, \\mathrm{s}^{-1}$。\n\n算法流程如下：\n\n1.  **计算帕德近似系数**：首先，我们计算回旋朗道流体（LF）模型的耗散耦合函数 $\\mathcal{D}_{\\mathrm{LF}}(s)$ 的常数系数 $a$ 和 $b$。这些系数是通过匹配精确动理学响应的级数展开得到的。提供的公式是：\n    $$ a = \\frac{-\\frac{4}{3}\\sqrt{\\pi} - 4}{2 - \\pi} $$\n    $$ b = \\frac{a + 2}{\\sqrt{\\pi}} $$\n    这些系数使用高精度的 $\\pi$ 值计算一次。\n\n2.  **定义模型函数**：实现两个函数来计算每种模型的耗散耦合 $\\mathcal{D}(s)$。\n\n    a.  **精确动理学模型**：精确动理学耗散耦合 $\\mathcal{D}_{\\mathrm{exact}}(s)$ 使用以下公式计算：\n        $$ \\mathcal{D}_{\\mathrm{exact}}(s) = \\sqrt{\\pi}\\, s\\, e^{s^2} \\operatorname{erfc}(s) $$\n        其中 $\\operatorname{erfc}(s)$ 是互补误差函数。实现将利用 `scipy.special` 库中的 `erfc` 函数，该函数对于大范围的参数都具有数值稳定性。\n\n    b.  **回旋朗道流体（GLF）模型**：GLF 模型使用一个双极点帕德近似 $\\mathcal{D}_{\\mathrm{LF}}(s)$ 来模拟动理学响应：\n        $$ \\mathcal{D}_{\\mathrm{LF}}(s) = \\frac{\\sqrt{\\pi}\\, s + a s^2}{1 + b s + a s^2} $$\n        这个有理函数使用预先计算的系数 $a$ 和 $b$ 进行评估。该形式对于所有非负 $s$ 都表现良好，包括特殊情况 $s=0$，此时 $\\mathcal{D}_{\\mathrm{LF}}(0) = 0$。\n\n3.  **迭代并计算衰减率**：程序遍历指定的 $s$ 值列表：$\\{0.0, 0.1, 1.0, 10.0\\}$。在每次迭代中：\n\n    a.  使用各自的公式计算 $\\mathcal{D}_{\\mathrm{exact}}(s)$ 和 $\\mathcal{D}_{\\mathrm{LF}}(s)$。\n    b.  然后通过将 $\\mathcal{D}(s)$ 值乘以常数前置因子 $\\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}}$ 来计算相应的衰减率 $\\gamma_{\\mathrm{exact}}(s)$ 和 $\\gamma_{\\mathrm{LF}}(s)$。\n\n4.  **格式化输出**：将为每个 $s$ 值计算出的衰减率按 $[\\gamma_{\\mathrm{LF}}(s), \\gamma_{\\mathrm{exact}}(s)]$ 的顺序附加到一个结果列表中。最终的列表包含8个浮点数，被格式化为指定的方括号括起的单个逗号分隔字符串。对于 $s=0.0$，两种模型都得到 $\\mathcal{D}(0)=0$，因此 $\\gamma(0)=0$，这可作为一个基准检查。其他 $s$ 值将测试帕德近似在小 $s$（流体）、中等和 大 $s$（自由流）区域的准确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Calculates and prints the Landau damping rates for a parallel temperature\n    perturbation using both the exact kinetic model and a gyro-Landau fluid\n    (GLF) Padé approximant model.\n    \"\"\"\n    \n    # Define the physical parameters from the problem statement.\n    k_parallel = 12.5  # m^-1\n    v_th = 1.0e6       # m/s\n\n    # Define the test cases for the normalized aperiodic parameter s.\n    s_values = [0.0, 0.1, 1.0, 10.0]\n\n    # Pre-compute constants.\n    pi = np.pi\n    sqrt_pi = np.sqrt(pi)\n    \n    # Calculate the coefficients 'a' and 'b' for the Padé approximant.\n    # These are derived from matching the Taylor series of the exact response\n    # and ensuring the correct asymptotic limit.\n    a = (-4.0/3.0 * sqrt_pi - 4.0) / (2.0 - pi)\n    b = (a + 2.0) / sqrt_pi\n\n    # Common prefactor for the decay rate calculation.\n    rate_prefactor = (2.0 / 3.0) * k_parallel * v_th\n\n    results = []\n    \n    # Loop through each value of s to compute the decay rates.\n    for s in s_values:\n        # For s=0, both D(s) are 0, so gamma is 0. The general formulas\n        # are well-behaved and handle this case correctly without special logic.\n\n        # --- Gyro-Landau Fluid (LF) Model Calculation ---\n        # Numerator of the Padé approximant D_LF(s).\n        numerator_lf = sqrt_pi * s + a * s**2\n        # Denominator of the Padé approximant D_LF(s).\n        denominator_lf = 1.0 + b * s + a * s**2\n        \n        # Avoid division by zero, although not expected for s >= 0 with these coefficients.\n        if denominator_lf == 0:\n            d_lf_s = np.nan # Or appropriate error handling\n        else:\n            d_lf_s = numerator_lf / denominator_lf\n        \n        gamma_lf = rate_prefactor * d_lf_s\n\n        # --- Exact Kinetic Model Calculation ---\n        # The expression for D_exact(s) uses the complementary error function.\n        # np.exp(s**2) * erfc(s) can be numerically unstable for large s.\n        # However, for s up to 10, standard double precision is sufficient.\n        d_exact_s = sqrt_pi * s * np.exp(s**2) * erfc(s)\n        gamma_exact = rate_prefactor * d_exact_s\n        \n        results.append(gamma_lf)\n        results.append(gamma_exact)\n\n    # Final print statement in the exact required format.\n    # e.g., [gamma_LF(0.0),gamma_exact(0.0),gamma_LF(0.1),gamma_exact(0.1),...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将回旋朗道流体（GLF）模型付诸于计算机模拟时，一个核心的实际挑战是如何处理由朗道阻尼闭合项引入的数值刚性（stiffness）。这些项的时间尺度远快于其他流体项，对数值积分格式的稳定性提出了苛刻要求。本练习将通过一个典型模型方程，帮助您分析简单显式积分方法的稳定性条件，并引导您构建一种更稳健的积分因子方法，以确保模拟的准确性和效率。",
            "id": "3988080",
            "problem": "在磁化等离子体中线性朗道阻尼平行矩的陀螺朗道流体 (GLF) 闭合中，动力学相混合在傅里叶空间中由一个非局域算子表示，该算子在 Padé 近似下简化为与平行波数成正比的刚性线性弛豫。考虑一个 GLF 矩 $y(t)$ 在固定平行波数 $k_{\\parallel}$ 下的单个傅里叶模，其演化被理想化为\n$$\n\\frac{d y}{d t} = - a\\, y + R(t),\n$$\n其中 $a \\equiv c_{L}\\, v_{\\mathrm{th}}\\, |k_{\\parallel}|$，$c_{L} > 0$ 是一个无量纲朗道闭合系数，$v_{\\mathrm{th}}$ 是该粒子种类的热速度，$R(t)$ 包含了来自其余流体项的较慢的非刚性贡献。假设 $R(t)$ 在远大于 $a^{-1}$ 的时间尺度上变化。\n\n(a) 仅使用应用于齐次刚性部分的显式前向欧拉格式，分析其线性稳定性，并推导出最大稳定时间步长 $\\Delta t_{\\max}$ 作为 $a$ 的函数。\n\n(b) 提出一种分步积分因子法，该方法精确处理刚性朗道闭合部分，并显式处理其余项 $R(t)$。推导刚性子步的放大因子，并说明其稳定性特性。\n\n(c) 对于电子，其温度 $T_{e} = 2\\,\\mathrm{keV}$，质量 $m_{e} = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$，平行波数 $|k_{\\parallel}| = 5\\,\\mathrm{m}^{-1}$，取 Hammett–Perkins 型朗道闭合系数 $c_{L} = \\sqrt{\\pi}/2$，热速度定义为 $v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e}/m_{e}}$。使用精确的能量转换关系 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。计算在这些参数下，显式前向欧拉稳定性极限 $\\Delta t_{\\max}$ 的数值。\n\n将 $\\Delta t_{\\max}$ 的最终数值答案以秒为单位表示，并四舍五入到三位有效数字。",
            "solution": "该问题提出了一个用于陀螺朗道流体 (GLF) 矩的简化常微分方程 (ODE)，并要求分析用于求解该方程的数值格式。该问题是有效的，因为它在计算等离子体物理学中有科学依据，是适定的，并且提供了求解所需的所有信息。\n\n(a) 显式前向欧拉格式分析\n\nGLF 矩 $y(t)$ 的演化方程为：\n$$\n\\frac{d y}{d t} = - a\\, y + R(t)\n$$\n问题要求分析应用于该方程齐次刚性部分的显式前向欧拉格式。齐次刚性部分为：\n$$\n\\frac{d y}{d t} = - a\\, y\n$$\n其中 $a > 0$ 是一个实常数。设 $y^n$ 为 $y(t_n)$ 在时间 $t_n$ 的数值近似。显式前向欧拉格式将解从 $t_n$ 向前推进一个时间步 $\\Delta t$ 到 $t_{n+1} = t_n + \\Delta t$，如下所示：\n$$\ny^{n+1} = y^n + \\Delta t \\left( \\frac{d y}{d t} \\right)_{t=t_n}\n$$\n将此应用于我们的齐次方程得到：\n$$\ny^{n+1} = y^n + \\Delta t (- a y^n) = (1 - a \\Delta t) y^n\n$$\n项 $G \\equiv 1 - a \\Delta t$ 是放大因子，它决定了误差如何从一个时间步传播到下一个时间步。为使数值格式稳定，放大因子的模必须小于或等于1：\n$$\n|G| \\le 1\n$$\n代入 $G$ 的表达式，我们得到：\n$$\n|1 - a \\Delta t| \\le 1\n$$\n由于 $a$ 定义为 $a \\equiv c_{L}\\, v_{\\mathrm{th}}\\, |k_{\\parallel}|$，其中 $c_L > 0$，$v_{\\mathrm{th}} > 0$ 且 $|k_{\\parallel}| \\ge 0$，所以系数 $a$ 是非负实数。我们考虑非平凡情况 $a > 0$。时间步 $\\Delta t$ 也是正的。因此，$a \\Delta t$ 是一个正实数。不等式 $|1 - a \\Delta t| \\le 1$ 等价于：\n$$\n-1 \\le 1 - a \\Delta t \\le 1\n$$\n这个复合不等式可以分为两个独立的不等式：\n1. $1 - a \\Delta t \\le 1 \\implies -a \\Delta t \\le 0$。由于 $a > 0$ 且 $\\Delta t > 0$，此条件总是满足的。\n2. $-1 \\le 1 - a \\Delta t \\implies a \\Delta t \\le 2$。\n\n从第二个不等式，我们推导出关于时间步 $\\Delta t$ 的条件：\n$$\n\\Delta t \\le \\frac{2}{a}\n$$\n因此，应用于此刚性项的显式前向欧拉格式的最大稳定时间步长 $\\Delta t_{\\max}$ 为：\n$$\n\\Delta t_{\\max} = \\frac{2}{a}\n$$\n\n(b) 分步积分因子法\n\n任务是提出一种方法，该方法能精确处理刚性部分 $-ay$，并显式处理非刚性部分 $R(t)$。我们可以通过使用积分因子来实现这一点。完整的常微分方程是：\n$$\n\\frac{d y}{d t} + a y = R(t)\n$$\n我们乘以积分因子 $e^{at}$：\n$$\ne^{at} \\frac{d y}{d t} + a e^{at} y = \\frac{d}{d t} (y e^{at}) = e^{at} R(t)\n$$\n从 $t_n$ 到 $t_{n+1}$ 积分：\n$$\n\\int_{t_n}^{t_{n+1}} \\frac{d}{d \\tau} (y(\\tau) e^{a\\tau}) d\\tau = \\int_{t_n}^{t_{n+1}} e^{a\\tau} R(\\tau) d\\tau\n$$\n$$\ny(t_{n+1}) e^{a t_{n+1}} - y(t_n) e^{a t_n} = \\int_{t_n}^{t_{n+1}} e^{a\\tau} R(\\tau) d\\tau\n$$\n求解 $y(t_{n+1})$ 得到区间上的精确解：\n$$\ny(t_{n+1}) = e^{-a (t_{n+1} - t_n)} y(t_n) + \\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} R(\\tau) d\\tau\n$$\n令 $y^n = y(t_n)$ 和 $\\Delta t = t_{n+1}-t_n$，这变为：\n$$\ny^{n+1} = e^{-a \\Delta t} y^n + \\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} R(\\tau) d\\tau\n$$\n刚性部分通过项 $e^{-a \\Delta t}$ 被精确处理。为了显式处理 $R(t)$，我们用时间步开始时的值 $R(\\tau) \\approx R(t_n) = R^n$ 来近似积分中的 $R(\\tau)$。\n$$\ny^{n+1} \\approx e^{-a \\Delta t} y^n + R^n \\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} d\\tau\n$$\n计算积分：\n$$\n\\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} d\\tau = \\left[ \\frac{1}{a} e^{-a (t_{n+1} - \\tau)} \\right]_{\\tau=t_n}^{\\tau=t_{n+1}} = \\frac{1}{a} (e^0 - e^{-a \\Delta t}) = \\frac{1 - e^{-a \\Delta t}}{a}\n$$\n因此，提出的分步积分因子格式为：\n$$\ny^{n+1} = e^{-a \\Delta t} y^n + \\frac{1 - e^{-a \\Delta t}}{a} R^n\n$$\n通过考虑齐次情况（$R(t)=0$），可以找到刚性子步的放大因子，这给出了 $y^{n+1} = e^{-a \\Delta t} y^n$。因此，放大因子是：\n$$\nG_{\\text{stiff}} = e^{-a \\Delta t}\n$$\n为了进行稳定性分析，我们考察其模。由于 $a > 0$ 和 $\\Delta t > 0$，指数 $-a \\Delta t$ 为负。\n$$\n|G_{\\text{stiff}}| = |e^{-a \\Delta t}| = e^{-a \\Delta t}\n$$\n由于对于任何 $x > 0$ 都有 $e^x > 1$，我们有 $e^{a \\Delta t} > 1$，这意味着 $0  e^{-a \\Delta t}  1$。因此，对于任何 $\\Delta t > 0$ 的选择，都有 $|G_{\\text{stiff}}|  1$。这意味着积分因子法的刚性子步是无条件稳定的（也称为A-稳定）。时间步不受朗道闭合项刚性的限制。\n\n(c) $\\Delta t_{\\max}$ 的数值计算\n\n从(a)部分可知，显式前向欧拉格式的稳定性极限是 $\\Delta t_{\\max} = 2/a$。我们需要使用给定的参数计算 $a = c_{L}\\, v_{\\mathrm{th},e}\\, |k_{\\parallel}|$ 的值。\n\n参数如下：\n- 朗道闭合系数: $c_{L} = \\frac{\\sqrt{\\pi}}{2}$。\n- 电子温度 (以能量形式): $T_{e} = 2\\,\\mathrm{keV} = 2 \\times 10^3\\,\\mathrm{eV}$。\n- 电子质量: $m_{e} = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$。\n- 平行波数: $|k_{\\parallel}| = 5\\,\\mathrm{m}^{-1}$。\n- 能量转换: $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n- 电子热速度定义: $v_{\\mathrm{th},e} = \\sqrt{\\frac{2 k_{B} T_{e}}{m_{e}}}$。\n\n首先，我们将电子温度 $T_e$ 从 keV 转换为焦耳。公式中的量 $k_B T_e$ 代表热能，其单位为电子伏特。\n$$\nE_e = k_B T_e = (2 \\times 10^{3}\\,\\mathrm{eV}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}\n$$\n现在，我们计算电子热速度 $v_{\\mathrm{th},e}$：\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{2 E_e}{m_{e}}} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{9.1093837 \\times 10^{-31}\\,\\mathrm{kg}}}\n$$\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{6.408706536 \\times 10^{-16}}{9.1093837 \\times 10^{-31}}} \\,\\mathrm{m/s} \\approx \\sqrt{7.0352535 \\times 10^{14}} \\,\\mathrm{m/s} \\approx 2.6524056 \\times 10^{7}\\,\\mathrm{m/s}\n$$\n接下来，我们计算刚性弛豫率 $a$：\n$$\na = c_{L}\\, v_{\\mathrm{th},e}\\, |k_{\\parallel}| = \\left(\\frac{\\sqrt{\\pi}}{2}\\right) \\times (2.6524056 \\times 10^{7}\\,\\mathrm{m/s}) \\times (5\\,\\mathrm{m}^{-1})\n$$\n$$\na \\approx (0.8862269) \\times (2.6524056 \\times 10^{7}) \\times 5 \\,\\mathrm{s}^{-1} \\approx 1.175402 \\times 10^{8}\\,\\mathrm{s}^{-1}\n$$\n最后，我们计算最大稳定时间步长 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{2}{a} = \\frac{2}{1.175402 \\times 10^{8}\\,\\mathrm{s}^{-1}} \\approx 1.70152 \\times 10^{-8}\\,\\mathrm{s}\n$$\n按要求四舍五入到三位有效数字：\n$$\n\\Delta t_{\\max} \\approx 1.70 \\times 10^{-8}\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.70 \\times 10^{-8}}\n$$"
        }
    ]
}