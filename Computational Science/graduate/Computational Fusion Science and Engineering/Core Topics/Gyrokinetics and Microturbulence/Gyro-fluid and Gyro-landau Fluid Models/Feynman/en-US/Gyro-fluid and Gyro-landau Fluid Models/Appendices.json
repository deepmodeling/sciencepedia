{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of gyrokinetics and related fluid models is the concept of gyro-averaging, which accounts for how particles respond to an average of the fields over their Larmor orbits. This effect is captured by the form factor $\\Gamma_0(b_s)$, where $b_s = k_{\\perp}^2 \\rho_s^2$. This practice  challenges you to derive the behavior of this operator in the short-wavelength limit ($b_s \\to \\infty$) using asymptotic analysis, revealing a fundamental shift in how plasmas screen electrostatic potentials.",
            "id": "3988079",
            "problem": "Consider a magnetized plasma species $s$ with thermal Larmor radius $\\rho_s$ and perpendicular wavenumber $k_{\\perp}$, and define the finite Larmor radius parameter $b_s \\equiv k_{\\perp}^{2}\\rho_s^{2}$. In gyrokinetic (GK) and gyro-Landau fluid (GLF) closures for electrostatic fluctuations, the species polarization enters quasi-neutrality through the gyroaverage form factor $\\Gamma_0(b_s)$, which can be written in terms of a gyrophase-average integral as\n$$\n\\Gamma_0(b_s) \\equiv \\frac{1}{2\\pi}\\exp(-b_s)\\int_{0}^{2\\pi}\\exp\\!\\big(b_s\\cos\\theta\\big)\\,\\mathrm{d}\\theta.\n$$\nStarting from this integral representation and using asymptotic analysis appropriate for large $b_s$, derive the leading-order and next-to-leading-order terms of the asymptotic expansion of $\\Gamma_0(b_s)$ as $b_s \\to \\infty$. Your derivation should proceed from the fundamental definition above by systematically approximating the integral for large $b_s$ and must not invoke any shortcut formulas that directly state the answer.\n\nThen, using the structure of GK/GLF quasi-neutrality, briefly explain the physical implication of your result for short-wavelength screening of the electrostatic potential in the limit $k_{\\perp}\\rho_s \\gg 1$.\n\nExpress your final asymptotic expression for $\\Gamma_0(b_s)$ as a single closed-form analytic expression that includes terms up to order $b_s^{-3/2}$. No numerical rounding is required. The quantity $\\Gamma_0(b_s)$ is dimensionless, so no physical units are needed in your final expression.",
            "solution": "The problem requires the derivation of the asymptotic expansion of the gyroaverage form factor $\\Gamma_0(b_s)$ for large values of the parameter $b_s$, starting from its integral definition. Subsequently, the physical implication of this result is to be discussed.\n\nThe integral representation of $\\Gamma_0(b_s)$ is given by:\n$$\n\\Gamma_0(b_s) = \\frac{1}{2\\pi}\\exp(-b_s)\\int_{0}^{2\\pi}\\exp(b_s\\cos\\theta)\\,\\mathrm{d}\\theta\n$$\nWe seek an asymptotic expansion for $b_s \\to \\infty$. This integral is of the form $\\int \\exp(\\lambda f(x)) g(x) dx$ with a large parameter $\\lambda = b_s$. We can evaluate it using Laplace's method. The core idea is that for large $b_s$, the value of the integral is dominated by the contribution from the neighborhood of the point where the function in the exponent, $\\cos\\theta$, attains its maximum value.\n\nThe function $f(\\theta) = \\cos\\theta$ in the integration interval $[0, 2\\pi]$ has a maximum value of $f(0) = 1$ at $\\theta=0$. The integrand is periodic with period $2\\pi$, so integrating over $[0, 2\\pi]$ is equivalent to integrating over $[-\\pi, \\pi]$, which is more convenient for an expansion around the maximum at $\\theta=0$. The integral is symmetric about $\\theta=0$.\n\nLet $I(b_s) = \\int_{0}^{2\\pi}\\exp(b_s\\cos\\theta)\\,\\mathrm{d}\\theta = \\int_{-\\pi}^{\\pi}\\exp(b_s\\cos\\theta)\\,\\mathrm{d}\\theta$. The integrand is sharply peaked around $\\theta=0$. We can approximate $\\cos\\theta$ by its Taylor series expansion around $\\theta=0$:\n$$\n\\cos\\theta = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - O(\\theta^6) = 1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\n$$\nSubstituting this into the integral gives:\n$$\nI(b_s) = \\int_{-\\pi}^{\\pi} \\exp\\left(b_s\\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)\\right)\\,\\mathrm{d}\\theta\n$$\n$$\nI(b_s) = \\exp(b_s) \\int_{-\\pi}^{\\pi} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right) \\exp\\left(\\frac{b_s\\theta^4}{24} - \\dots\\right)\\,\\mathrm{d}\\theta\n$$\nFor large $b_s$, the Gaussian term $\\exp(-b_s\\theta^2/2)$ ensures that only very small values of $\\theta$ (of order $b_s^{-1/2}$) contribute significantly. In this region, the argument of the second exponential, $b_s\\theta^4/24$, is small. We can therefore expand the second exponential as a series:\n$$\n\\exp\\left(\\frac{b_s\\theta^4}{24} - \\dots\\right) \\approx 1 + \\left(\\frac{b_s\\theta^4}{24}\\right) + \\dots\n$$\nWe include terms that will result in the required order of accuracy.\n$$\nI(b_s) \\approx \\exp(b_s) \\int_{-\\pi}^{\\pi} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right) \\left(1 + \\frac{b_s\\theta^4}{24}\\right)\\,\\mathrm{d}\\theta\n$$\nSince the integrand is negligible for large $|\\theta|$, we can extend the integration limits from $[-\\pi, \\pi]$ to $(-\\infty, \\infty)$ with exponentially small error.\n$$\nI(b_s) \\approx \\exp(b_s) \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta + \\frac{b_s}{24} \\int_{-\\infty}^{\\infty} \\theta^4 \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta \\right]\n$$\nThese are standard Gaussian integrals. The first is a Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x = \\sqrt{\\pi/a}$. With $a = b_s/2$, we get:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta = \\sqrt{\\frac{\\pi}{b_s/2}} = \\sqrt{\\frac{2\\pi}{b_s}}\n$$\nThe second integral is a moment of the Gaussian distribution, $\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^2)\\,\\mathrm{d}x = \\frac{(2n)!}{n!(4a)^n}\\sqrt{\\frac{\\pi}{a}}$. For $n=2$ and $a=b_s/2$:\n$$\n\\int_{-\\infty}^{\\infty} \\theta^4 \\exp\\left(-\\frac{b_s\\theta^2}{2}\\right)\\,\\mathrm{d}\\theta = \\frac{4!}{2!(4b_s/2)^2}\\sqrt{\\frac{\\pi}{b_s/2}} = \\frac{24}{2(2b_s)^2} \\sqrt{\\frac{2\\pi}{b_s}} = \\frac{12}{4b_s^2} \\sqrt{\\frac{2\\pi}{b_s}} = \\frac{3}{b_s^2}\\sqrt{\\frac{2\\pi}{b_s}}\n$$\nSubstituting these results back into the expression for $I(b_s)$:\n$$\nI(b_s) \\approx \\exp(b_s) \\left[ \\sqrt{\\frac{2\\pi}{b_s}} + \\frac{b_s}{24} \\left(\\frac{3}{b_s^2}\\sqrt{\\frac{2\\pi}{b_s}}\\right) \\right]\n$$\n$$\nI(b_s) \\approx \\exp(b_s) \\sqrt{\\frac{2\\pi}{b_s}} \\left[ 1 + \\frac{3b_s}{24b_s^2} \\right] = \\exp(b_s) \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right)\n$$\nNow, we substitute this asymptotic expansion for the integral $I(b_s)$ back into the definition of $\\Gamma_0(b_s)$:\n$$\n\\Gamma_0(b_s) = \\frac{1}{2\\pi}\\exp(-b_s) I(b_s) \\approx \\frac{1}{2\\pi}\\exp(-b_s) \\left[ \\exp(b_s) \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right) \\right]\n$$\n$$\n\\Gamma_0(b_s) \\approx \\frac{1}{2\\pi} \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right) = \\frac{1}{\\sqrt{4\\pi^2}} \\sqrt{\\frac{2\\pi}{b_s}} \\left( 1 + \\frac{1}{8b_s} \\right) = \\frac{1}{\\sqrt{2\\pi b_s}} \\left( 1 + \\frac{1}{8b_s} \\right)\n$$\nThis expression contains terms of order $b_s^{-1/2}$ and $b_s^{-3/2}$, as required.\n\nNext, we discuss the physical implication of this result. The parameter $b_s \\equiv k_{\\perp}^{2}\\rho_s^{2}$ becomes large in the short-wavelength limit, i.e., when the perpendicular wavenumber $k_{\\perp}$ is much larger than the inverse of the Larmor radius $\\rho_s$ ($k_{\\perp}\\rho_s \\gg 1$). Our asymptotic result, $\\Gamma_0(b_s) \\approx (2\\pi b_s)^{-1/2}$, shows that $\\Gamma_0(b_s) \\to 0$ as $b_s \\to \\infty$.\n\nThe function $\\Gamma_0(b_s)$ represents the effect of gyro-averaging on the electrostatic potential experienced by a particle. A particle's guiding center does not respond to the local potential $\\phi$, but to an average of $\\phi$ over its Larmor orbit. In the short-wavelength limit ($k_{\\perp}\\rho_s \\gg 1$), the potential oscillates rapidly over the spatial scale of a Larmor orbit. The gyro-averaging process results in strong cancellations, making the effective potential seen by the guiding center very small. The mathematical result $\\Gamma_0(b_s) \\to 0$ is the quantitative statement of this physical effect.\n\nIn gyrokinetic and gyro-Landau fluid theories, the quasi-neutrality condition relates the perturbed densities of different species to the electrostatic potential. For ions, the response to the potential that enforces quasi-neutrality often involves a \"polarization\" term proportional to $(1-\\Gamma_0(b_i))\\phi$.\n- In the long-wavelength limit ($k_{\\perp}\\rho_i \\ll 1$), $b_i \\ll 1$ and $\\Gamma_0(b_i) \\approx 1-b_i = 1-k_{\\perp}^2\\rho_i^2$. The screening term is then approximately $(1-(1-k_{\\perp}^2\\rho_i^2))\\phi = k_{\\perp}^2\\rho_i^2 \\phi$. This is the well-known polarization drift response, where the screening effect scales with $k_{\\perp}^2$.\n- In the short-wavelength limit ($k_{\\perp}\\rho_i \\gg 1$), our result shows $\\Gamma_0(b_i) \\to 0$. The screening term thus approaches $(1-0)\\phi = \\phi$.\n\nThis implies that for short-wavelength fluctuations, the ion shielding response saturates. Instead of increasing with $k_{\\perp}^2$, the ion response becomes equivalent to that of an unmagnetized plasma, providing a constant level of Debye-like screening. The ions become ineffective at screening short-wavelength perturbations because their large Larmor orbits average out the fine spatial structure of the potential. This saturation of ion screening is a critical effect in plasma turbulence, as it allows short-wavelength instabilities, such as electron temperature gradient (ETG) modes, to exist.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2\\pi b_s}} \\left(1 + \\frac{1}{8b_s}\\right)}\n$$"
        },
        {
            "introduction": "Beyond gyro-averaging, capturing collisionless thermal effects like Landau damping is the defining feature of gyro-Landau fluid (GLF) models. These models replace the complex kinetic plasma response with simpler, computationally tractable rational approximants. This exercise  puts you in the role of a model developer, tasking you with comparing a standard Padé approximant for the parallel heat flux against the exact kinetic result to evaluate its accuracy across different physical regimes.",
            "id": "3988096",
            "problem": "Consider a collisionless, homogeneous, single-species plasma with an imposed, small-amplitude, standing parallel temperature perturbation that varies as a single Fourier mode along the magnetic field line, namely $T_{\\parallel}(z,t) = \\Re\\{\\hat{T}(t)\\exp(i k_{\\parallel} z)\\}$. In a linear gyro-Landau fluid closure, the parallel heat flux moment $q_{\\parallel}$ is closed using the Landau-fluid approximation that recovers collisionless phase mixing via a frequency-dependent nonlocal operator. Let the normalized complex parameter be $\\zeta \\equiv \\omega / (|k_{\\parallel}| v_{\\mathrm{th}})$, where $\\omega$ is the complex frequency, $k_{\\parallel}$ is the parallel wavenumber, and $v_{\\mathrm{th}}$ is the thermal speed defined by $v_{\\mathrm{th}} = \\sqrt{2 T_0/m}$ for a background temperature $T_0$ and particle mass $m$.\n\nThe linearized parallel temperature moment equation in Fourier space can be written (for small perturbations and neglecting sources) as $-i \\omega \\hat{T} = -\\frac{2}{3} \\frac{i k_{\\parallel}}{n_0} \\hat{q}_{\\parallel}$, where $n_0$ is the background density. The kinetic closure determines the ratio $\\hat{q}_{\\parallel}/\\hat{T}$ via the plasma dispersion function $Z(\\zeta)$, defined as $Z(\\zeta) \\equiv \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} \\frac{e^{-s^2}}{s - \\zeta} \\, ds$ (Landau contour). For a purely aperiodic, standing perturbation, take $\\zeta = i s$ with $s > 0$ real, so that $\\omega = i \\gamma$ with $\\gamma > 0$ the decay rate. In this case, the exact kinetic mapping yields a real, positive coefficient for the dissipative coupling. A convenient normalization of the kinetic coupling for the heat flux to temperature ratio is through\n$$\n\\mathcal{D}_{\\mathrm{exact}}(s) \\equiv \\operatorname{Re}\\{-\\zeta Z(\\zeta)\\}\\big|_{\\zeta = i s} = \\sqrt{\\pi}\\, s\\, e^{s^2} \\operatorname{erfc}(s),\n$$\nwhere $\\operatorname{erfc}(s)$ is the complementary error function and the identity $Z(i s) = i \\sqrt{\\pi} e^{s^2} \\operatorname{erfc}(s)$ has been used. With this normalization, the decay rate predicted by the exact kinetic theory is\n$$\n\\gamma_{\\mathrm{exact}}(s) = \\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}}\\, \\mathcal{D}_{\\mathrm{exact}}(s).\n$$\n\nA gyro-Landau fluid closure approximates the kinetic nonlocal operator with a rational (Padé) form that reproduces both the small-$s$ expansion and the large-$s$ asymptotic limit. Match the Taylor expansion coefficients of $\\mathcal{D}_{\\mathrm{exact}}(s)$ near $s=0$,\n$$\n\\mathcal{D}_{\\mathrm{exact}}(s) = \\sqrt{\\pi} s - 2 s^2 - \\frac{4}{3} s^3 + \\mathcal{O}(s^4),\n$$\nand enforce the large-$s$ limit $\\lim_{s\\to\\infty} \\mathcal{D}_{\\mathrm{exact}}(s) = 1$. A minimal two-pole Padé approximant that satisfies these constraints is\n$$\n\\mathcal{D}_{\\mathrm{LF}}(s) \\equiv \\frac{\\sqrt{\\pi}\\, s + a s^2}{1 + b s + a s^2},\n$$\nwith coefficients $a$ and $b$ determined from matching conditions:\n$$\na - b \\sqrt{\\pi} = -2, \\qquad \\lim_{s\\to\\infty} \\frac{\\sqrt{\\pi} s + a s^2}{1 + b s + a s^2} = 1, \\qquad \\text{and} \\qquad \\text{the } s^3 \\text{ coefficient equals } -\\frac{4}{3}.\n$$\nSolving these yields $a = \\frac{-\\frac{4}{3}\\sqrt{\\pi} - 4}{2 - \\pi}$ and $b = \\frac{a + 2}{\\sqrt{\\pi}}$. Using $\\mathcal{D}_{\\mathrm{LF}}(s)$, the gyro-Landau fluid decay rate is\n$$\n\\gamma_{\\mathrm{LF}}(s) = \\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}}\\, \\mathcal{D}_{\\mathrm{LF}}(s).\n$$\n\nYour task is to implement a program that:\n- Accepts no input and uses the following fixed physical parameters: $|k_{\\parallel}| = 12.5$ in $\\mathrm{m}^{-1}$ and $v_{\\mathrm{th}} = 1.0 \\times 10^6$ in $\\mathrm{m/s}$.\n- Evaluates, for a set of chosen normalized aperiodic parameters $s \\in \\{0.0, 0.1, 1.0, 10.0\\}$, both $\\gamma_{\\mathrm{LF}}(s)$ and $\\gamma_{\\mathrm{exact}}(s)$.\n- Uses the exact kinetic formula with the complementary error function $\\operatorname{erfc}(s)$ for $\\mathcal{D}_{\\mathrm{exact}}(s)$ and the Padé coefficients $a$ and $b$ computed as specified above for $\\mathcal{D}_{\\mathrm{LF}}(s)$.\n- Produces results in units of $\\mathrm{s}^{-1}$, as floating-point numbers.\n\nTest suite specification:\n- Case $s = 0.0$: boundary case; both models predict zero decay.\n- Case $s = 0.1$: small-$s$ regime; tests the small-$s$ expansion behavior.\n- Case $s = 1.0$: intermediate regime; tests accuracy of the Padé closure against the exact kinetic mapping.\n- Case $s = 10.0$: large-$s$ regime; tests the approach of both models to the asymptotic limit.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, for each $s$ in the order given, the pair $\\gamma_{\\mathrm{LF}}(s)$ followed by $\\gamma_{\\mathrm{exact}}(s)$. For the four test values of $s$, the output must contain eight numbers in the order $[\\gamma_{\\mathrm{LF}}(0.0),\\gamma_{\\mathrm{exact}}(0.0),\\gamma_{\\mathrm{LF}}(0.1),\\gamma_{\\mathrm{exact}}(0.1),\\gamma_{\\mathrm{LF}}(1.0),\\gamma_{\\mathrm{exact}}(1.0),\\gamma_{\\mathrm{LF}}(10.0),\\gamma_{\\mathrm{exact}}(10.0)]$.",
            "solution": "The problem requires the calculation of the aperiodic decay rate $\\gamma$ of a parallel temperature perturbation in a collisionless, homogeneous plasma. This rate is computed using two different theoretical models for a specified set of physical parameters and a range of normalized frequency parameters.\n\nThe given physical parameters are:\n-   Parallel wavenumber: $|k_{\\parallel}| = 12.5 \\, \\mathrm{m}^{-1}$\n-   Thermal speed: $v_{\\mathrm{th}} = 1.0 \\times 10^6 \\, \\mathrm{m/s}$\n\nThe decay rates will be evaluated for a set of normalized aperiodic parameters $s \\in \\{0.0, 0.1, 1.0, 10.0\\}$.\n\nThe general form for the decay rate in both models is:\n$$ \\gamma(s) = \\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}} \\mathcal{D}(s) $$\nwhere $\\mathcal{D}(s)$ is a normalized dissipative coupling function that differs between the two models. The common prefactor is a constant throughout the calculation: $\\frac{2}{3} \\times 12.5 \\times 1.0 \\times 10^6 \\, \\mathrm{s}^{-1} \\approx 8.333 \\times 10^6 \\, \\mathrm{s}^{-1}$.\n\nThe algorithmic procedure is as follows:\n\n1.  **Calculate Padé Approximant Coefficients**: First, we compute the constant coefficients $a$ and $b$ for the gyro-Landau fluid (LF) model's dissipative coupling function, $\\mathcal{D}_{\\mathrm{LF}}(s)$. These coefficients are derived from matching the series expansion of the exact kinetic response. The provided formulas are:\n    $$ a = \\frac{-\\frac{4}{3}\\sqrt{\\pi} - 4}{2 - \\pi} $$\n    $$ b = \\frac{a + 2}{\\sqrt{\\pi}} $$\n    These coefficients are computed once using high-precision values for $\\pi$.\n\n2.  **Define Model Functions**: Two functions are implemented to calculate the dissipative coupling $\\mathcal{D}(s)$ for each model.\n\n    a.  **Exact Kinetic Model**: The exact kinetic dissipative coupling, $\\mathcal{D}_{\\mathrm{exact}}(s)$, is calculated using the formula:\n        $$ \\mathcal{D}_{\\mathrm{exact}}(s) = \\sqrt{\\pi}\\, s\\, e^{s^2} \\operatorname{erfc}(s) $$\n        where $\\operatorname{erfc}(s)$ is the complementary error function. The implementation will utilize the `erfc` function from the `scipy.special` library, which is numerically stable for a wide range of arguments.\n\n    b.  **Gyro-Landau Fluid (GLF) Model**: The GLF model uses a two-pole Padé approximant, $\\mathcal{D}_{\\mathrm{LF}}(s)$, to model the kinetic response:\n        $$ \\mathcal{D}_{\\mathrm{LF}}(s) = \\frac{\\sqrt{\\pi}\\, s + a s^2}{1 + b s + a s^2} $$\n        This rational function is evaluated using the pre-computed coefficients $a$ and $b$. This form is well-behaved for all non-negative $s$, including the special case $s=0$ where $\\mathcal{D}_{\\mathrm{LF}}(0) = 0$.\n\n3.  **Iterate and Compute Decay Rates**: The program iterates through the specified list of $s$ values: $\\{0.0, 0.1, 1.0, 10.0\\}$. In each iteration:\n\n    a.  Both $\\mathcal{D}_{\\mathrm{exact}}(s)$ and $\\mathcal{D}_{\\mathrm{LF}}(s)$ are computed using their respective formulas.\n    b.  The corresponding decay rates, $\\gamma_{\\mathrm{exact}}(s)$ and $\\gamma_{\\mathrm{LF}}(s)$, are then calculated by multiplying the $\\mathcal{D}(s)$ values by the constant prefactor $\\frac{2}{3} |k_{\\parallel}| v_{\\mathrm{th}}$.\n\n4.  **Format Output**: The calculated decay rates for each $s$ value, in the order $[\\gamma_{\\mathrm{LF}}(s), \\gamma_{\\mathrm{exact}}(s)]$, are appended to a results list. The final list, containing $8$ floating-point numbers, is formatted into a single comma-separated string enclosed in square brackets as specified. For $s=0.0$, both models yield $\\mathcal{D}(0)=0$, and thus $\\gamma(0)=0$, which serves as a baseline check. The other values of $s$ will test the accuracy of the Padé approximant in the small-$s$ (fluid), intermediate, and large-$s$ (free-streaming) regimes.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Calculates and prints the Landau damping rates for a parallel temperature\n    perturbation using both the exact kinetic model and a gyro-Landau fluid\n    (GLF) Padé approximant model.\n    \"\"\"\n    \n    # Define the physical parameters from the problem statement.\n    k_parallel = 12.5  # m^-1\n    v_th = 1.0e6       # m/s\n\n    # Define the test cases for the normalized aperiodic parameter s.\n    s_values = [0.0, 0.1, 1.0, 10.0]\n\n    # Pre-compute constants.\n    pi = np.pi\n    sqrt_pi = np.sqrt(pi)\n    \n    # Calculate the coefficients 'a' and 'b' for the Padé approximant.\n    # These are derived from matching the Taylor series of the exact response\n    # and ensuring the correct asymptotic limit.\n    a = (-4.0/3.0 * sqrt_pi - 4.0) / (2.0 - pi)\n    b = (a + 2.0) / sqrt_pi\n\n    # Common prefactor for the decay rate calculation.\n    rate_prefactor = (2.0 / 3.0) * k_parallel * v_th\n\n    results = []\n    \n    # Loop through each value of s to compute the decay rates.\n    for s in s_values:\n        # For s=0, both D(s) are 0, so gamma is 0. The general formulas\n        # are well-behaved and handle this case correctly without special logic.\n\n        # --- Gyro-Landau Fluid (LF) Model Calculation ---\n        # Numerator of the Padé approximant D_LF(s).\n        numerator_lf = sqrt_pi * s + a * s**2\n        # Denominator of the Padé approximant D_LF(s).\n        denominator_lf = 1.0 + b * s + a * s**2\n        \n        # Avoid division by zero, although not expected for s >= 0 with these coefficients.\n        if denominator_lf == 0:\n            d_lf_s = np.nan # Or appropriate error handling\n        else:\n            d_lf_s = numerator_lf / denominator_lf\n        \n        gamma_lf = rate_prefactor * d_lf_s\n\n        # --- Exact Kinetic Model Calculation ---\n        # The expression for D_exact(s) uses the complementary error function.\n        # np.exp(s**2) * erfc(s) can be numerically unstable for large s.\n        # However, for s up to 10, standard double precision is sufficient.\n        d_exact_s = sqrt_pi * s * np.exp(s**2) * erfc(s)\n        gamma_exact = rate_prefactor * d_exact_s\n        \n        results.append(gamma_lf)\n        results.append(gamma_exact)\n\n    # Final print statement in the exact required format.\n    # e.g., [gamma_LF(0.0),gamma_exact(0.0),gamma_LF(0.1),gamma_exact(0.1),...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Translating a GLF model from theory to a functioning simulation requires overcoming key numerical hurdles. The very term that models Landau damping, while physically motivated, introduces severe numerical stiffness that can render simple time-integration schemes unstable. In this final practice , you will analyze this stability constraint and explore why advanced methods, like the integrating-factor technique, are essential for the practical implementation of GLF codes.",
            "id": "3988080",
            "problem": "In the Gyro-Landau Fluid (GLF) closure of a linear Landau-damped parallel moment in a magnetized plasma, the kinetic phase-mixing is represented in Fourier space by a nonlocal operator that, under a Padé approximation, reduces to a stiff linear relaxation proportional to the parallel wavenumber. Consider a single Fourier mode of a GLF moment $y(t)$ at fixed parallel wavenumber $k_{\\parallel}$, whose evolution is idealized by\n$$\n\\frac{d y}{d t} = - a\\, y + R(t),\n$$\nwhere $a \\equiv c_{L}\\, v_{\\mathrm{th}}\\, |k_{\\parallel}|$, $c_{L} > 0$ is a dimensionless Landau-closure coefficient, $v_{\\mathrm{th}}$ is the thermal speed of the species, and $R(t)$ collects slower non-stiff contributions from the remaining fluid terms. Assume $R(t)$ varies on a timescale much longer than $a^{-1}$.\n\n(a) Using only the explicit forward-Euler scheme applied to the homogeneous stiff part, analyze the linear stability and derive the maximum stable time step $\\Delta t_{\\max}$ as a function of $a$.\n\n(b) Propose a split-step integrating-factor method that treats the stiff Landau-closure part exactly and the remaining term $R(t)$ explicitly. Derive the amplification factor of the stiff substep and state its stability property.\n\n(c) For electrons with temperature $T_{e} = 2\\,\\mathrm{keV}$, mass $m_{e} = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$, and parallel wavenumber $|k_{\\parallel}| = 5\\,\\mathrm{m}^{-1}$, take the Hammett–Perkins-type Landau-closure coefficient $c_{L} = \\sqrt{\\pi}/2$, and the thermal speed defined by $v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e}/m_{e}}$. Use the exact energy conversion $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$. Compute the numerical value of the explicit forward-Euler stability limit $\\Delta t_{\\max}$ for these parameters.\n\nExpress your final numerical answer for $\\Delta t_{\\max}$ in seconds, and round to three significant figures.",
            "solution": "The problem presents a simplified ordinary differential equation (ODE) for a Gyro-Landau Fluid (GLF) moment and asks for an analysis of numerical schemes used to solve it.\n\n(a) Analysis of the Explicit Forward-Euler Scheme\n\nThe evolution equation for the GLF moment $y(t)$ is given as:\n$$\n\\frac{d y}{d t} = - a\\, y + R(t)\n$$\nThe problem requires an analysis of the explicit forward-Euler scheme applied to the homogeneous stiff part of this equation. The homogeneous stiff part is:\n$$\n\\frac{d y}{d t} = - a\\, y\n$$\nwhere $a > 0$ is a real constant. Let $y^n$ be the numerical approximation of $y(t_n)$ at time $t_n$. The explicit forward-Euler scheme advances the solution in time by one step $\\Delta t$ from $t_n$ to $t_{n+1} = t_n + \\Delta t$ as follows:\n$$\ny^{n+1} = y^n + \\Delta t \\left( \\frac{d y}{d t} \\right)_{t=t_n}\n$$\nApplying this to our homogeneous equation yields:\n$$\ny^{n+1} = y^n + \\Delta t (- a y^n) = (1 - a \\Delta t) y^n\n$$\nThe term $G \\equiv 1 - a \\Delta t$ is the amplification factor, which determines how errors propagate from one time step to the next. For a numerical scheme to be stable, the magnitude of the amplification factor must be less than or equal to one:\n$$\n|G| \\le 1\n$$\nSubstituting the expression for $G$, we get:\n$$\n|1 - a \\Delta t| \\le 1\n$$\nSince $a$ is defined as $a \\equiv c_{L}\\, v_{\\mathrm{th}}\\, |k_{\\parallel}|$ with $c_L > 0$, $v_{\\mathrm{th}} > 0$, and $|k_{\\parallel}| \\ge 0$, the coefficient $a$ is real and non-negative. We consider the non-trivial case $a > 0$. The time step $\\Delta t$ is also positive. Therefore, $a \\Delta t$ is a positive real number. The inequality $|1 - a \\Delta t| \\le 1$ is equivalent to:\n$$\n-1 \\le 1 - a \\Delta t \\le 1\n$$\nThis compound inequality can be split into two separate inequalities:\n1. $1 - a \\Delta t \\le 1 \\implies -a \\Delta t \\le 0$. Since $a > 0$ and $\\Delta t > 0$, this is always satisfied.\n2. $-1 \\le 1 - a \\Delta t \\implies a \\Delta t \\le 2$.\n\nFrom the second inequality, we derive the condition on the time step $\\Delta t$:\n$$\n\\Delta t \\le \\frac{2}{a}\n$$\nThe maximum stable time step, $\\Delta t_{\\max}$, for the explicit forward-Euler scheme applied to this stiff term is therefore:\n$$\n\\Delta t_{\\max} = \\frac{2}{a}\n$$\n\n(b) Split-Step Integrating-Factor Method\n\nThe task is to propose a method that treats the stiff part, $-ay$, exactly and the non-stiff part, $R(t)$, explicitly. We can achieve this by using an integrating factor. The full ODE is:\n$$\n\\frac{d y}{d t} + a y = R(t)\n$$\nWe multiply by the integrating factor $e^{at}$:\n$$\ne^{at} \\frac{d y}{d t} + a e^{at} y = \\frac{d}{d t} (y e^{at}) = e^{at} R(t)\n$$\nIntegrating from $t_n$ to $t_{n+1}$:\n$$\n\\int_{t_n}^{t_{n+1}} \\frac{d}{d \\tau} (y(\\tau) e^{a\\tau}) d\\tau = \\int_{t_n}^{t_{n+1}} e^{a\\tau} R(\\tau) d\\tau\n$$\n$$\ny(t_{n+1}) e^{a t_{n+1}} - y(t_n) e^{a t_n} = \\int_{t_n}^{t_{n+1}} e^{a\\tau} R(\\tau) d\\tau\n$$\nSolving for $y(t_{n+1})$ gives the exact solution over the interval:\n$$\ny(t_{n+1}) = e^{-a (t_{n+1} - t_n)} y(t_n) + \\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} R(\\tau) d\\tau\n$$\nLetting $y^n = y(t_n)$ and $\\Delta t = t_{n+1}-t_n$, this becomes:\n$$\ny^{n+1} = e^{-a \\Delta t} y^n + \\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} R(\\tau) d\\tau\n$$\nThe stiff part is treated exactly via the term $e^{-a \\Delta t}$. To treat $R(t)$ explicitly, we approximate $R(\\tau)$ in the integral by its value at the beginning of the time step, $R(\\tau) \\approx R(t_n) = R^n$.\n$$\ny^{n+1} \\approx e^{-a \\Delta t} y^n + R^n \\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} d\\tau\n$$\nEvaluating the integral:\n$$\n\\int_{t_n}^{t_{n+1}} e^{-a (t_{n+1} - \\tau)} d\\tau = \\left[ \\frac{1}{a} e^{-a (t_{n+1} - \\tau)} \\right]_{\\tau=t_n}^{\\tau=t_{n+1}} = \\frac{1}{a} (e^0 - e^{-a \\Delta t}) = \\frac{1 - e^{-a \\Delta t}}{a}\n$$\nThus, the proposed split-step integrating-factor scheme is:\n$$\ny^{n+1} = e^{-a \\Delta t} y^n + \\frac{1 - e^{-a \\Delta t}}{a} R^n\n$$\nThe amplification factor of the stiff substep is found by considering the homogeneous case ($R(t)=0$), which gives $y^{n+1} = e^{-a \\Delta t} y^n$. The amplification factor is therefore:\n$$\nG_{\\text{stiff}} = e^{-a \\Delta t}\n$$\nFor stability analysis, we examine its magnitude. Since $a > 0$ and $\\Delta t > 0$, the exponent $-a \\Delta t$ is negative.\n$$\n|G_{\\text{stiff}}| = |e^{-a \\Delta t}| = e^{-a \\Delta t}\n$$\nSince $e^x > 1$ for any $x>0$, we have $e^{a \\Delta t} > 1$, which implies $0 < e^{-a \\Delta t} < 1$. Thus, $|G_{\\text{stiff}}| < 1$ for any choice of $\\Delta t > 0$. This means the stiff substep of the integrating-factor method is unconditionally stable (also known as A-stable). The time step is not constrained by the stiffness of the Landau-closure term.\n\n(c) Numerical Calculation of $\\Delta t_{\\max}$\n\nFrom part (a), the stability limit for the explicit forward-Euler scheme is $\\Delta t_{\\max} = 2/a$. We need to compute the value of $a = c_{L}\\, v_{\\mathrm{th},e}\\, |k_{\\parallel}|$ using the provided parameters.\n\nThe parameters are:\n- Landau-closure coefficient: $c_{L} = \\frac{\\sqrt{\\pi}}{2}$.\n- Electron temperature (as energy): $T_{e} = 2\\,\\mathrm{keV} = 2 \\times 10^3\\,\\mathrm{eV}$.\n- Electron mass: $m_{e} = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$.\n- Parallel wavenumber: $|k_{\\parallel}| = 5\\,\\mathrm{m}^{-1}$.\n- Energy conversion: $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$.\n- Electron thermal speed definition: $v_{\\mathrm{th},e} = \\sqrt{\\frac{2 k_{B} T_{e}}{m_{e}}}$.\n\nFirst, we convert the electron temperature $T_e$ from keV to Joules. The quantity $k_B T_e$ in the formula represents the thermal energy, which is given in electron-volts.\n$$\nE_e = k_B T_e = (2 \\times 10^{3}\\,\\mathrm{eV}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}\n$$\nNow, we calculate the electron thermal speed $v_{\\mathrm{th},e}$:\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{2 E_e}{m_{e}}} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{9.1093837 \\times 10^{-31}\\,\\mathrm{kg}}}\n$$\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{6.408706536 \\times 10^{-16}}{9.1093837 \\times 10^{-31}}} \\,\\mathrm{m/s} \\approx \\sqrt{7.0352535 \\times 10^{14}} \\,\\mathrm{m/s} \\approx 2.6524056 \\times 10^{7}\\,\\mathrm{m/s}\n$$\nNext, we calculate the stiff relaxation rate $a$:\n$$\na = c_{L}\\, v_{\\mathrm{th},e}\\, |k_{\\parallel}| = \\left(\\frac{\\sqrt{\\pi}}{2}\\right) \\times (2.6524056 \\times 10^{7}\\,\\mathrm{m/s}) \\times (5\\,\\mathrm{m}^{-1})\n$$\n$$\na \\approx (0.8862269) \\times (2.6524056 \\times 10^{7}) \\times 5 \\,\\mathrm{s}^{-1} \\approx 1.175402 \\times 10^{8}\\,\\mathrm{s}^{-1}\n$$\nFinally, we compute the maximum stable time step $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{2}{a} = \\frac{2}{1.175402 \\times 10^{8}\\,\\mathrm{s}^{-1}} \\approx 1.70152 \\times 10^{-8}\\,\\mathrm{s}\n$$\nRounding to three significant figures as required:\n$$\n\\Delta t_{\\max} \\approx 1.70 \\times 10^{-8}\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.70 \\times 10^{-8}}\n$$"
        }
    ]
}