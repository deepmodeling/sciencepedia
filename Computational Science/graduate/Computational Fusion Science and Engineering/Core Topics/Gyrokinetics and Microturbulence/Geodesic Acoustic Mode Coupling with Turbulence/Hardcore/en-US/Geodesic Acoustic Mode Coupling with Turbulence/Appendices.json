{
    "hands_on_practices": [
        {
            "introduction": "This exercise delves into one of the foundational results in zonal flow physics, often associated with the work of Rosenbluth and Hinton. It demonstrates that in a toroidal plasma, an initial zonal potential perturbation is largely \"shielded\" by neoclassical kinetic effects, with most of the energy being converted into oscillatory Geodesic Acoustic Modes (GAMs) that eventually phase-mix away. By calculating the energy partition between the final residual flow and the GAMs, you will gain a quantitative understanding of this critical plasma response mechanism .",
            "id": "3984894",
            "problem": "Consider a large-aspect-ratio tokamak plasma with circular concentric magnetic flux surfaces. The inverse aspect ratio is $\\epsilon$, the safety factor is $q$, and the equilibrium magnetic field magnitude is $B$. An axisymmetric zonal potential perturbation with a single radial wavenumber $k_r$ is imposed at $t=0^{+}$, generating a flux-surface-averaged electrostatic potential $\\phi(r,t)$ with initial condition $\\phi(r,0^{+})=\\phi_0 \\cos(k_r r)$ and no initial parallel motion. Assume collisionless ions described by drift-kinetic theory, adiabatic electrons, and the long-wavelength limit $k_r \\rho_i \\ll 1$, where $\\rho_i$ is the ion Larmor radius. The zonal flow couples to the Geodesic Acoustic Mode (GAM) through geodesic curvature and ion compressibility.\n\nUsing kinetic theory, derive how the initial zonal potential perturbation partitions into a non-oscillatory residual zonal flow component and an oscillatory Geodesic Acoustic Mode (GAM) component in the collisionless limit. Adopt the following modeling choices:\n\n- The energy norm to be partitioned is the zonal-flow $\\mathbf{E}\\times\\mathbf{B}$ kinetic energy density, defined as $W_E = \\frac{n_i m_i}{2} |\\mathbf{u}_E|^2$, where $\\mathbf{u}_E = \\frac{c}{B}\\,\\hat{\\mathbf{b}}\\times\\nabla \\phi$, with $\\hat{\\mathbf{b}}$ the unit vector along the magnetic field, $n_i$ the ion density, and $m_i$ the ion mass. For a single-$k_r$ zonal perturbation, $W_E \\propto k_r^2 \\phi^2$.\n- In the large-aspect-ratio, circular-surface limit, the neoclassical polarization inertia associated with trapped-ion dynamics enhances the static zonal-flow response by an amount characterized by the dimensionless parameter $\\Lambda(q,\\epsilon)$, which is proportional to $q^2/\\sqrt{\\epsilon}$ for adiabatic electrons and $k_r \\rho_i \\ll 1$. Specifically, take $\\Lambda(q,\\epsilon) = \\alpha\\,\\frac{q^2}{\\sqrt{\\epsilon}}$ with $\\alpha=1.6$ for circular concentric flux surfaces.\n\nFrom first principles, determine the residual zonal-flow potential amplitude $\\phi_{\\infty}$ in terms of $\\phi_0$ and $\\Lambda$, and then use the specified energy norm to compute the fraction of the initial $\\mathbf{E}\\times\\mathbf{B}$ kinetic energy that remains in the residual zonal flow, denoted $f_{\\mathrm{res}}$, and the complementary fraction that goes into the oscillatory GAM component, denoted $f_{\\mathrm{GAM}}$. Evaluate these fractions numerically for $q=1.5$ and $\\epsilon=0.16$.\n\nRound your numerical answers to four significant figures. Express the final energy fractions as decimal numbers without a percent sign. The final answer should report $(f_{\\mathrm{res}}, f_{\\mathrm{GAM}})$ as two numbers in that order.",
            "solution": "The user-provided problem has been validated and is determined to be a scientifically grounded, well-posed, and objective question from the field of computational fusion science and engineering.\n\nThe problem asks for the partitioning of energy from an initial zonal potential perturbation into a long-time residual zonal flow and an oscillatory Geodesic Acoustic Mode (GAM). The core of the problem lies in the concept of neoclassical polarization shielding in a tokamak plasma.\n\nFirst, we address the evolution of the flux-surface-averaged electrostatic potential, $\\phi(t)$. An initial potential perturbation $\\phi(r, 0^+) = \\phi_0 \\cos(k_r r)$ is imposed on the plasma. In a toroidal geometry, the response to this perturbation is governed by both classical and neoclassical polarization effects. In the long-time limit ($t \\rightarrow \\infty$), after the oscillatory GAM components have damped away via collisionless phase-mixing, a steady-state residual zonal flow potential, $\\phi_{\\infty}$, remains.\n\nThe relationship between the initial potential $\\phi_0$ and the residual potential $\\phi_{\\infty}$ is a classic result from kinetic theory (popularized by Rosenbluth and Hinton). It arises from the conservation of the initial charge that establishes the potential. Initially, at $t=0^+$, the plasma has not had time for the toroidicity-induced (neoclassical) effects to manifest. The system's response is governed by the high-frequency or classical dielectric capacitance, which is related to the classical ion polarization drift. Let's denote the effective dielectric constant for this fast timescale as $\\epsilon_{cl}$. The initial \"unshielded\" charge density perturbation $\\rho_0$ is proportional to $\\epsilon_{cl}\\nabla^2\\phi_0$.\n\nAs time progresses, the system evolves towards a new steady state. In this final state, the same initial charge density $\\rho_0$ is now shielded by the full static dielectric response of the plasma, $\\epsilon_{st}$. This static response includes both the classical polarization and the additional neoclassical polarization arising from the dynamics of trapped ions in the toroidal magnetic field. The problem parameterizes this neoclassical enhancement with the factor $\\Lambda$. The static dielectric constant is thus enhanced by a factor of $(1+\\Lambda)$, so $\\epsilon_{st} = (1+\\Lambda)\\epsilon_{cl}$. The final potential $\\phi_{\\infty}$ is related to the charge $\\rho_0$ by $\\rho_0 \\propto \\epsilon_{st}\\nabla^2\\phi_{\\infty}$.\n\nBy conservation of the polarizing charge, we have:\n$$ \\epsilon_{cl}\\nabla^2\\phi_0 = \\epsilon_{st}\\nabla^2\\phi_{\\infty} = (1+\\Lambda)\\epsilon_{cl}\\nabla^2\\phi_{\\infty} $$\nFor a single radial mode, this simplifies to:\n$$ \\phi_0 = (1+\\Lambda)\\phi_{\\infty} $$\nFrom this, we derive the amplitude of the residual zonal-flow potential:\n$$ \\phi_{\\infty} = \\frac{1}{1+\\Lambda}\\phi_0 $$\n\nNext, we calculate the partitioning of energy. The problem specifies the energy norm to be the $\\mathbf{E}\\times\\mathbf{B}$ kinetic energy density, $W_E$. For a single-$k_r$ perturbation, this energy is proportional to the square of the potential amplitude: $W_E \\propto \\phi^2$. Let the constant of proportionality be $C$.\n\nThe initial energy at $t=0^+$ is associated with the potential $\\phi_0$:\n$$ W_{E,0} = C \\phi_0^2 $$\nThe problem states that there is no initial parallel motion, so this represents the total energy of the system at $t=0^+$.\n\nThe energy remaining in the residual zonal flow in the $t \\rightarrow \\infty$ limit is associated with the potential $\\phi_{\\infty}$:\n$$ W_{E,\\mathrm{res}} = C \\phi_{\\infty}^2 = C \\left(\\frac{1}{1+\\Lambda}\\phi_0\\right)^2 = \\frac{1}{(1+\\Lambda)^2} C \\phi_0^2 $$\n\nThe fraction of the initial energy that remains in the residual zonal flow, $f_{\\mathrm{res}}$, is the ratio of the residual energy to the initial energy:\n$$ f_{\\mathrm{res}} = \\frac{W_{E,\\mathrm{res}}}{W_{E,0}} = \\frac{\\frac{1}{(1+\\Lambda)^2} C \\phi_0^2}{C \\phi_0^2} = \\frac{1}{(1+\\Lambda)^2} $$\n\nThe total energy of the system is conserved. The initial energy $W_{E,0}$ is partitioned between the final, steady residual flow energy $W_{E,\\mathrm{res}}$ and the energy transferred to the oscillatory GAM components, $W_{E,\\mathrm{GAM}}$. Therefore, the energy in the GAM is the difference between the initial energy and the residual energy.\n$$ W_{E,\\mathrm{GAM}} = W_{E,0} - W_{E,\\mathrm{res}} $$\nThe fraction of the initial energy that goes into the GAM, $f_{\\mathrm{GAM}}$, is:\n$$ f_{\\mathrm{GAM}} = \\frac{W_{E,\\mathrm{GAM}}}{W_{E,0}} = \\frac{W_{E,0} - W_{E,\\mathrm{res}}}{W_{E,0}} = 1 - \\frac{W_{E,\\mathrm{res}}}{W_{E,0}} = 1 - f_{\\mathrm{res}} $$\nSubstituting the expression for $f_{\\mathrm{res}}$:\n$$ f_{\\mathrm{GAM}} = 1 - \\frac{1}{(1+\\Lambda)^2} $$\n\nNow, we evaluate these fractions for the given parameters: $q=1.5$, $\\epsilon=0.16$, and $\\alpha=1.6$.\nFirst, we calculate the dimensionless neoclassical polarization parameter $\\Lambda$:\n$$ \\Lambda = \\alpha \\frac{q^2}{\\sqrt{\\epsilon}} = 1.6 \\times \\frac{(1.5)^2}{\\sqrt{0.16}} = 1.6 \\times \\frac{2.25}{0.4} $$\n$$ \\Lambda = 4 \\times 2.25 = 9 $$\nThe value of $\\Lambda$ is exactly $9$.\n\nNow we can calculate the energy fractions:\n$$ f_{\\mathrm{res}} = \\frac{1}{(1+\\Lambda)^2} = \\frac{1}{(1+9)^2} = \\frac{1}{10^2} = \\frac{1}{100} = 0.01 $$\n$$ f_{\\mathrm{GAM}} = 1 - f_{\\mathrm{res}} = 1 - 0.01 = 0.99 $$\n\nThe problem requires the numerical answers to be rounded to four significant figures.\n$$ f_{\\mathrm{res}} = 0.01000 $$\n$$ f_{\\mathrm{GAM}} = 0.9900 $$\n\nThe final answer is the pair $(f_{\\mathrm{res}}, f_{\\mathrm{GAM}})$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.01000  0.9900 \\end{pmatrix}}$$"
        },
        {
            "introduction": "In a realistic fusion plasma, GAMs are not just a transient response to an initial perturbation but are continuously driven by ambient turbulence. This practice provides a direct link between the statistical description of turbulence and the macroscopic drive for GAMs, which is the divergence of the Reynolds stress. You will derive and compute this source term starting from a model two-point correlation function for the turbulent potential, illustrating how microscopic fluctuations organize to create a large-scale, coherent flow .",
            "id": "3984874",
            "problem": "Consider a local flux-tube slab model of a magnetically confined plasma, with radial coordinate $x$ and poloidal-like coordinate $y$. The Geodesic Acoustic Mode (GAM) is the oscillatory zonal component of the flow, which in a fluid limit is driven by the divergence of the turbulent Reynolds stress. In normalized gyro-Bohm units, set $(c/B)=1$, where $c$ is the speed of light and $B$ is the magnetic field strength, and normalize the electrostatic potential by a constant reference such that all computed quantities are dimensionless. Angles must be specified in radians.\n\nThe electric field cross magnetic field (E$\\times$B) velocity is given by $v_x = -\\partial_y \\tilde{\\phi}$ and $v_y = \\partial_x \\tilde{\\phi}$, where $\\tilde{\\phi}(x,y,t)$ is the fluctuating electrostatic potential. The Reynolds stress is defined as $\\Pi_{xy}(x) = \\langle v_x v_y \\rangle$, and the effective GAM source term is the radial derivative of the Reynolds stress, $S_{\\mathrm{GAM}}(x) = -\\partial_x \\Pi_{xy}(x)$, where the angle brackets denote an ensemble average over turbulence realizations.\n\nAssume homogeneous turbulence statistics in $(\\Delta x,\\Delta y)$ and a slowly varying radial envelope of intensity. The two-point correlation function of the electrostatic potential fluctuations is prescribed as\n$$\nC_{\\phi\\phi}(\\Delta x, \\Delta y; x) = \\langle \\tilde{\\phi}(x,y) \\tilde{\\phi}(x+\\Delta x, y+\\Delta y) \\rangle = I(x)^2 \\exp\\!\\left(-\\frac{\\Delta x^2}{\\lambda_x^2} - \\frac{\\Delta y^2}{\\lambda_y^2}\\right) \\cos\\!\\left(k_x \\Delta x + k_y \\Delta y + \\varphi\\right),\n$$\nwhere $I(x)$ is the turbulence intensity envelope, $\\lambda_x$ and $\\lambda_y$ are correlation lengths, $k_x$ and $k_y$ are characteristic wave numbers, and $\\varphi$ is a constant phase. The radial envelope is\n$$\nI(x) = I_0 \\exp\\!\\left(\\frac{\\gamma}{L_I}(x - x_c)\\right),\n$$\nwith $I_0$ the reference intensity at $x=x_c$, $L_I$ the radial scale of the envelope, and $\\gamma$ a dimensionless slope parameter.\n\nStarting only from the above definitions, the fluid momentum balance that connects the GAM source term to the divergence of Reynolds stress, and the properties of homogeneous correlations, derive a computable expression for $S_{\\mathrm{GAM}}(x)$ in terms of derivatives of $C_{\\phi\\phi}$ evaluated at zero separation. Then implement a program to numerically evaluate $S_{\\mathrm{GAM}}(x)$ at a specified evaluation radius $x_{\\mathrm{eval}}$ for each of the following test cases, and to evaluate the scaling exponent $\\alpha$ such that $S_{\\mathrm{GAM}} \\propto I_0^\\alpha$ by performing a least-squares linear fit of $\\log S_{\\mathrm{GAM}}$ versus $\\log I_0$ for a group of three cases with identical parameters except differing $I_0$.\n\nUse the following test suite (angles in radians, all quantities non-dimensionalized as stated):\n\n- Test case $1$ (general case): $I_0 = 0.5$, $\\gamma = 0.8$, $L_I = 0.3$, $x_c = 0.0$, $x_{\\mathrm{eval}} = 0.1$, $\\lambda_x = 0.2$, $\\lambda_y = 0.2$, $k_x = 1.2$, $k_y = 0.9$, $\\varphi = 0.3$.\n- Test case $2$ (phase-cancellation edge): same as test case $1$ but with $\\varphi = \\pi/2$.\n- Test case $3$ (anisotropy edge in wave number): same as test case $1$ but with $k_x = 0.0$.\n- Test case $4$ (uniform intensity edge): same as test case $1$ but with $\\gamma = 0.0$.\n- Test case group $5$ (scaling with $I_0$): three cases identical to test case $1$ except $I_0 \\in \\{0.3, 0.6, 1.2\\}$. Compute $S_{\\mathrm{GAM}}$ for each member and then report the fitted scaling exponent $\\alpha$ obtained from the least-squares slope of $\\log S_{\\mathrm{GAM}}$ versus $\\log I_0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets: $[S_1,S_2,S_3,S_4,\\alpha]$, where $S_j$ are the evaluated effective GAM source terms at $x_{\\mathrm{eval}}$ for test cases $j=1,2,3,4$, and $\\alpha$ is the fitted scaling exponent for test case group $5$. All outputs must be represented as floating-point numbers.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed. The givens are extracted and analyzed.\n\n**Givens:**\n- Model: Local flux-tube slab model with coordinates $x$ (radial) and $y$ (poloidal-like).\n- Normalization: $(c/B)=1$.\n- E$\\times$B velocity: $v_x = -\\partial_y \\tilde{\\phi}$ and $v_y = \\partial_x \\tilde{\\phi}$.\n- Reynolds stress: $\\Pi_{xy}(x) = \\langle v_x v_y \\rangle$.\n- GAM source term: $S_{\\mathrm{GAM}}(x) = -\\partial_x \\Pi_{xy}(x)$.\n- Correlation function: $C_{\\phi\\phi}(\\Delta x, \\Delta y; x) = \\langle \\tilde{\\phi}(x,y) \\tilde{\\phi}(x+\\Delta x, y+\\Delta y) \\rangle = I(x)^2 \\exp\\!\\left(-\\frac{\\Delta x^2}{\\lambda_x^2} - \\frac{\\Delta y^2}{\\lambda_y^2}\\right) \\cos\\!\\left(k_x \\Delta x + k_y \\Delta y + \\varphi\\right)$.\n- Turbulence intensity envelope: $I(x) = I_0 \\exp\\!\\left(\\frac{\\gamma}{L_I}(x - x_c)\\right)$.\n- All parameters for five test cases are provided, and all quantities are dimensionless.\n\n**Validation Verdict:**\nThe problem is **valid**. It is scientifically grounded in the established theory of plasma turbulence and fluid dynamics (specifically, the generation of zonal flows like GAMs via Reynolds stress). The definitions are standard, the provided functions are mathematically well-behaved, and the problem is self-contained with all necessary parameters specified for computation. The task is well-posed, leading to a unique solution for each test case.\n\n**Derivation of the Computable Expression for $S_{\\mathrm{GAM}}(x)$**\n\nThe derivation proceeds in three main steps: first, relating the Reynolds stress to the two-point correlation function; second, evaluating the necessary derivatives of the given correlation function; and third, computing the final GAM source term.\n\n1.  **Reynolds Stress and the Correlation Function**\n    The Reynolds stress $\\Pi_{xy}(x)$ at a radial position $x$ is defined as $\\Pi_{xy}(x) = \\langle v_x v_y \\rangle$. Substituting the E$\\times$B velocity components, $v_x = -\\partial_y \\tilde{\\phi}$ and $v_y = \\partial_x \\tilde{\\phi}$, we obtain:\n    $$\n    \\Pi_{xy}(x) = \\langle (-\\partial_y \\tilde{\\phi}) (\\partial_x \\tilde{\\phi}) \\rangle\n    $$\n    To evaluate this average of a product of derivatives at a single point, we express it as the zero-separation limit of a two-point quantity. Let $\\mathbf{r}_1 = (x_1, y_1)$ and $\\mathbf{r}_2 = (x_2, y_2)$. The Reynolds stress at $x_1$ can be written as:\n    $$\n    \\Pi_{xy}(x_1) = -\\lim_{\\mathbf{r}_2 \\to \\mathbf{r}_1} \\langle (\\partial_{y_1} \\tilde{\\phi}(\\mathbf{r}_1)) (\\partial_{x_2} \\tilde{\\phi}(\\mathbf{r}_2)) \\rangle\n    $$\n    Assuming the derivatives commute with the ensemble averaging operator $\\langle \\cdot \\rangle$, we get:\n    $$\n    \\Pi_{xy}(x_1) = -\\lim_{\\mathbf{r}_2 \\to \\mathbf{r}_1} \\frac{\\partial^2}{\\partial y_1 \\partial x_2} \\langle \\tilde{\\phi}(\\mathbf{r}_1) \\tilde{\\phi}(\\mathbf{r}_2) \\rangle\n    $$\n    The term $\\langle \\tilde{\\phi}(\\mathbf{r}_1) \\tilde{\\phi}(\\mathbf{r}_2) \\rangle$ is the two-point correlation function, given as $C_{\\phi\\phi}(\\Delta x, \\Delta y; x_1)$, where $\\Delta x = x_2 - x_1$ and $\\Delta y = y_2 - y_1$. We re-express the partial derivatives in terms of the separation coordinates $(\\Delta x, \\Delta y)$ using the chain rule: $\\partial_{x_2} = \\partial_{\\Delta x}$ and $\\partial_{y_1} = -\\partial_{\\Delta y}$. The mixed derivative operator becomes $\\frac{\\partial^2}{\\partial y_1 \\partial x_2} = -\\frac{\\partial^2}{\\partial \\Delta y \\partial \\Delta x}$. Substituting this result and taking the limit $\\mathbf{r}_2 \\to \\mathbf{r}_1$ (i.e., $\\Delta x \\to 0$, $\\Delta y \\to 0$), we find:\n    $$\n    \\Pi_{xy}(x) = -\\left[ -\\frac{\\partial^2 C_{\\phi\\phi}(\\Delta x, \\Delta y; x)}{\\partial \\Delta y \\partial \\Delta x} \\right]_{\\Delta x=0, \\Delta y=0} = \\left[ \\frac{\\partial^2 C_{\\phi\\phi}(\\Delta x, \\Delta y; x)}{\\partial \\Delta x \\partial \\Delta y} \\right]_{\\Delta x=0, \\Delta y=0}\n    $$\n\n2.  **Evaluation of the Correlation Function Derivative**\n    The correlation function is of the form $C_{\\phi\\phi}(\\Delta x, \\Delta y; x) = I(x)^2 G(\\Delta x, \\Delta y)$, where $G(\\Delta x, \\Delta y)$ contains the exponential and cosine terms. The mixed partial derivative of $G$ with respect to $\\Delta x$ and $\\Delta y$ must be evaluated at zero separation. Let $F = \\exp\\!\\left(-\\frac{\\Delta x^2}{\\lambda_x^2} - \\frac{\\Delta y^2}{\\lambda_y^2}\\right)$ and $H = \\cos\\!\\left(k_x \\Delta x + k_y \\Delta y + \\varphi\\right)$. We need to evaluate $\\left[ \\partial_{\\Delta x} \\partial_{\\Delta y} (FH) \\right]_{(0,0)}$. Using the product rule for differentiation and evaluating at $(\\Delta x, \\Delta y)=(0,0)$, we find that any term containing a first-order derivative of $F$ is zero, because $\\left.\\partial_{\\Delta x} F\\right|_{(0,0)} = 0$ and $\\left.\\partial_{\\Delta y} F\\right|_{(0,0)} = 0$. Similarly, $\\left.\\partial_{\\Delta x}\\partial_{\\Delta y} F\\right|_{(0,0)} = 0$. The expression simplifies to:\n    $$\n    \\left[ \\frac{\\partial^2 G}{\\partial \\Delta x \\partial \\Delta y} \\right]_{(0,0)} = \\left[ F \\frac{\\partial^2 H}{\\partial \\Delta x \\partial \\Delta y} \\right]_{(0,0)} = F(0,0) \\left[ \\frac{\\partial^2 H}{\\partial \\Delta x \\partial \\Delta y} \\right]_{(0,0)}\n    $$\n    Since $F(0,0) = 1$, we only need the second derivative of $H$:\n    $$\n    \\frac{\\partial^2 H}{\\partial \\Delta x \\partial \\Delta y} = \\frac{\\partial^2}{\\partial \\Delta x \\partial \\Delta y} \\cos(k_x \\Delta x + k_y \\Delta y + \\varphi) = -k_x k_y \\cos(k_x \\Delta x + k_y \\Delta y + \\varphi)\n    $$\n    Evaluating at $(\\Delta x, \\Delta y)=(0,0)$ gives $-k_x k_y \\cos(\\varphi)$.\n    The Reynolds stress is therefore:\n    $$\n    \\Pi_{xy}(x) = I(x)^2 (-k_x k_y \\cos(\\varphi)) = -k_x k_y \\cos(\\varphi) I(x)^2\n    $$\n\n3.  **Derivation of the GAM Source Term**\n    The GAM source term is $S_{\\mathrm{GAM}}(x) = -\\partial_x \\Pi_{xy}(x)$. Since $k_x$, $k_y$, and $\\varphi$ are constants, the radial derivative acts only on $I(x)^2$.\n    $$\n    S_{\\mathrm{GAM}}(x) = -\\frac{\\partial}{\\partial x} \\left[-k_x k_y \\cos(\\varphi) I(x)^2\\right] = k_x k_y \\cos(\\varphi) \\frac{d(I(x)^2)}{dx}\n    $$\n    Given $I(x) = I_0 \\exp\\left(\\frac{\\gamma}{L_I}(x - x_c)\\right)$, we have $I(x)^2 = I_0^2 \\exp\\left(\\frac{2\\gamma}{L_I}(x - x_c)\\right)$. The derivative is:\n    $$\n    \\frac{d(I(x)^2)}{dx} = I_0^2 \\cdot \\frac{2\\gamma}{L_I} \\exp\\left(\\frac{2\\gamma}{L_I}(x - x_c)\\right) = \\frac{2\\gamma}{L_I} I(x)^2\n    $$\n    Substituting this back gives the final expression for the GAM source term:\n    $$\n    S_{\\mathrm{GAM}}(x) = k_x k_y \\cos(\\varphi) \\left(\\frac{2\\gamma}{L_I} I(x)^2\\right) = \\frac{2 \\gamma k_x k_y I_0^2}{L_I} \\cos(\\varphi) \\exp\\left(\\frac{2\\gamma}{L_I}(x - x_c)\\right)\n    $$\n    This is the formula to be implemented. Notably, the result is independent of the correlation lengths $\\lambda_x$ and $\\lambda_y$. From this formula, the scaling $S_{\\mathrm{GAM}} \\propto I_0^2$ is apparent, which implies the scaling exponent $\\alpha$ is exactly $2$. Taking the logarithm, $\\log(S_{\\mathrm{GAM}}) = \\log(\\text{const}) + 2 \\log(I_0)$, confirming that a least-squares fit of $\\log(S_{\\mathrm{GAM}})$ versus $\\log(I_0)$ must yield a slope of $2$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Geodesic Acoustic Mode (GAM) source term for several test cases\n    and determines the scaling exponent with respect to turbulence intensity.\n    \"\"\"\n\n    def calculate_s_gam(params):\n        \"\"\"\n        Computes the GAM source term S_GAM(x) based on the derived analytical formula.\n        \n        S_GAM(x) = (2 * gamma * k_x * k_y * I_0^2 / L_I) * cos(phi) * exp(2 * gamma * (x_eval - x_c) / L_I)\n        \n        Args:\n            params (dict): A dictionary of parameters for the calculation.\n        \n        Returns:\n            float: The calculated value of S_GAM at x_eval.\n        \"\"\"\n        I0 = params['I0']\n        gamma = params['gamma']\n        L_I = params['L_I']\n        x_c = params['x_c']\n        x_eval = params['x_eval']\n        k_x = params['k_x']\n        k_y = params['k_y']\n        phi = params['phi']\n\n        # Handle edge cases where the formula evaluates to zero to avoid unnecessary computation.\n        if gamma == 0.0 or k_x == 0.0 or k_y == 0.0 or np.cos(phi) == 0.0:\n            return 0.0\n\n        term1 = (2 * gamma * k_x * k_y * I0**2) / L_I\n        term2 = np.cos(phi)\n        exponent = (2 * gamma / L_I) * (x_eval - x_c)\n        term3 = np.exp(exponent)\n\n        return term1 * term2 * term3\n\n    # Define the common parameters for test cases 1-4 and group 5.\n    base_params = {\n        'I0': 0.5, 'gamma': 0.8, 'L_I': 0.3, 'x_c': 0.0, 'x_eval': 0.1,\n        'lambda_x': 0.2, 'lambda_y': 0.2, 'k_x': 1.2, 'k_y': 0.9, 'phi': 0.3\n    }\n    \n    # Test cases setup\n    params1 = base_params.copy()\n    \n    params2 = base_params.copy()\n    params2['phi'] = np.pi / 2\n    \n    params3 = base_params.copy()\n    params3['k_x'] = 0.0\n    \n    params4 = base_params.copy()\n    params4['gamma'] = 0.0\n\n    # Calculate results for test cases 1-4\n    s1 = calculate_s_gam(params1)\n    s2 = calculate_s_gam(params2)\n    s3 = calculate_s_gam(params3)\n    s4 = calculate_s_gam(params4)\n    \n    # Test case group 5: Scaling with I_0\n    I0_values = [0.3, 0.6, 1.2]\n    s_gam_values = []\n    \n    for i0_val in I0_values:\n        params5 = base_params.copy()\n        params5['I0'] = i0_val\n        s_gam_values.append(calculate_s_gam(params5))\n\n    # Perform a least-squares linear fit on the logs to find the scaling exponent alpha.\n    # The relationship is log(S_GAM) = alpha * log(I_0) + const.\n    # The slope of the fit is alpha.\n    log_I0 = np.log(np.array(I0_values))\n    log_S_gam = np.log(np.array(s_gam_values))\n    \n    # Use numpy.polyfit to find the slope of the line of best fit (degree 1 polynomial).\n    # The result is [slope, intercept]. We need the slope.\n    alpha = np.polyfit(log_I0, log_S_gam, 1)[0]\n    \n    # Assemble the final results list\n    results = [s1, s2, s3, s4, alpha]\n    \n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The interaction between turbulence and GAMs forms a self-regulating feedback loop, often conceptualized as a predator-prey system where GAMs (the predator) feed on and suppress turbulence (the prey). This practice employs a reduced nonlinear model to explore the rich dynamics arising from this coupling. By performing a stability analysis, you will identify the conditions for a Hopf bifurcation, which marks the onset of limit-cycle oscillations corresponding to the intermittent, bursting behavior of GAMs commonly seen in experiments and simulations .",
            "id": "3984893",
            "problem": "Consider a reduced, dimensionless turbulence–Geodesic Acoustic Mode (GAM) system capturing the mutual coupling between drift-wave turbulence intensity and GAM oscillations through Reynolds-stress drive and geodesic-curvature dynamics. Let $I(t)$ denote the turbulence intensity, and let $A(t)$ be the GAM potential perturbation with $B(t) \\equiv dA/dt$. Assume the following minimal model based on free-energy production, shear suppression, and linear GAM oscillator dynamics:\n$$\n\\frac{dI}{dt} = \\left(\\gamma_{L} - c\\,A - b\\,I\\right) I,\n$$\n$$\n\\frac{dA}{dt} = B,\n$$\n$$\n\\frac{dB}{dt} = -\\omega_{g}^{2}\\,A - \\gamma_{g}\\,B + s\\,I,\n$$\nwhere $b0$ represents nonlinear turbulent self-damping, $c0$ represents GAM shear suppression of turbulence, $\\gamma_{L}0$ is the net linear drive of turbulence, $\\omega_{g}0$ is the linear GAM frequency, $\\gamma_{g}0$ is the effective linear damping of the GAM, and $s0$ is the effective Reynolds-stress drive of the GAM by turbulence.\n\nTasks:\n- Identify the nontrivial steady state with $I^{\\ast}0$ and $B^{\\ast}=0$, expressing $A^{\\ast}$ and $I^{\\ast}$ in terms of the parameters.\n- Linearize the system about this steady state and construct the Jacobian matrix. From this, derive the characteristic polynomial and write it in the canonical cubic form $ \\lambda^{3} + a_{1}\\lambda^{2} + a_{2}\\lambda + a_{3} = 0 $ with coefficients expressed in terms of parameters and the steady state.\n- Use the Routh–Hurwitz criterion to obtain the Hopf bifurcation threshold condition for the onset of a limit cycle corresponding to intermittent GAM bursts. Under the assumption $ \\gamma_{L}  \\gamma_{g}  0$ and all other parameters positive, solve this condition explicitly for the critical Reynolds-stress coupling $s_{H}$ as a single closed-form expression in the model parameters. Report the final $s_{H}$ expression in dimensionless form, simplified as far as possible.\n- Your final answer must be a single closed-form analytic expression for $s_{H}$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It describes a Lotka-Volterra-type predator-prey model, which is a standard reduced representation for turbulence-flow interactions in plasma physics, such as the coupling of drift-wave turbulence and Geodesic Acoustic Modes (GAMs). The tasks involve standard techniques of nonlinear dynamics (steady-state analysis, linearization, stability analysis, and bifurcation theory). All parameters and variables are clearly defined, and the premises are self-contained and consistent. The problem is therefore valid.\n\nThe system of equations is given by:\n$$ \\frac{dI}{dt} = \\left(\\gamma_{L} - cA - bI\\right) I $$\n$$ \\frac{dA}{dt} = B $$\n$$ \\frac{dB}{dt} = -\\omega_{g}^{2}A - \\gamma_{g}B + sI $$\nAll parameters $b, c, \\gamma_L, \\omega_g, \\gamma_g, s$ are positive.\n\nFirst, we find the nontrivial steady state $(I^{\\ast}, A^{\\ast}, B^{\\ast})$ where $I^{\\ast}  0$. We set all time derivatives to zero:\n$1.$ $\\frac{dI}{dt} = (\\gamma_{L} - cA^{\\ast} - bI^{\\ast}) I^{\\ast} = 0$\n$2.$ $\\frac{dA}{dt} = B^{\\ast} = 0$\n$3.$ $\\frac{dB}{dt} = -\\omega_{g}^{2}A^{\\ast} - \\gamma_{g}B^{\\ast} + sI^{\\ast} = 0$\n\nFrom equation $(2)$, we immediately have $B^{\\ast} = 0$.\nSubstituting $B^{\\ast} = 0$ into equation $(3)$ gives:\n$$ -\\omega_{g}^{2}A^{\\ast} + sI^{\\ast} = 0 \\implies \\omega_{g}^{2}A^{\\ast} = sI^{\\ast} $$\nFor a nontrivial solution with $I^{\\ast}  0$, equation $(1)$ requires the term in the parenthesis to be zero:\n$$ \\gamma_{L} - cA^{\\ast} - bI^{\\ast} = 0 \\implies cA^{\\ast} + bI^{\\ast} = \\gamma_{L} $$\nWe now have a system of two linear equations for $A^{\\ast}$ and $I^{\\ast}$:\n$$ A^{\\ast} = \\frac{s}{\\omega_{g}^{2}}I^{\\ast} $$\n$$ cA^{\\ast} + bI^{\\ast} = \\gamma_{L} $$\nSubstituting the first equation into the second yields:\n$$ c\\left(\\frac{s}{\\omega_{g}^{2}}I^{\\ast}\\right) + bI^{\\ast} = \\gamma_{L} $$\n$$ I^{\\ast}\\left(\\frac{cs}{\\omega_{g}^{2}} + b\\right) = \\gamma_{L} \\implies I^{\\ast}\\left(\\frac{cs + b\\omega_{g}^{2}}{\\omega_{g}^{2}}\\right) = \\gamma_{L} $$\nSolving for $I^{\\ast}$:\n$$ I^{\\ast} = \\frac{\\gamma_{L}\\omega_{g}^{2}}{cs + b\\omega_{g}^{2}} $$\nSince all parameters are positive, $I^{\\ast}  0$ is guaranteed. Now we find $A^{\\ast}$:\n$$ A^{\\ast} = \\frac{s}{\\omega_{g}^{2}}I^{\\ast} = \\frac{s}{\\omega_{g}^{2}}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{cs + b\\omega_{g}^{2}}\\right) = \\frac{s\\gamma_{L}}{cs + b\\omega_{g}^{2}} $$\nThe nontrivial steady state is $(I^{\\ast}, A^{\\ast}, B^{\\ast}) = \\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{cs + b\\omega_{g}^{2}}, \\frac{s\\gamma_{L}}{cs + b\\omega_{g}^{2}}, 0\\right)$.\n\nNext, we linearize the system around this steady state. We construct the Jacobian matrix $J$:\n$J = \\begin{pmatrix} \\frac{\\partial}{\\partial I}(\\frac{dI}{dt})  \\frac{\\partial}{\\partial A}(\\frac{dI}{dt})  \\frac{\\partial}{\\partial B}(\\frac{dI}{dt}) \\\\ \\frac{\\partial}{\\partial I}(\\frac{dA}{dt})  \\frac{\\partial}{\\partial A}(\\frac{dA}{dt})  \\frac{\\partial}{\\partial B}(\\frac{dA}{dt}) \\\\ \\frac{\\partial}{\\partial I}(\\frac{dB}{dt})  \\frac{\\partial}{\\partial A}(\\frac{dB}{dt})  \\frac{\\partial}{\\partial B}(\\frac{dB}{dt}) \\end{pmatrix} = \\begin{pmatrix} \\gamma_{L} - cA - 2bI  -cI  0 \\\\ 0  0  1 \\\\ s  -\\omega_{g}^{2}  -\\gamma_{g} \\end{pmatrix}$\nWe evaluate the Jacobian at the steady state $(I^{\\ast}, A^{\\ast}, B^{\\ast})$. The element $J_{11}$ simplifies using the steady-state condition $\\gamma_{L} - cA^{\\ast} - bI^{\\ast} = 0$:\n$J_{11} = (\\gamma_{L} - cA^{\\ast} - bI^{\\ast}) - bI^{\\ast} = 0 - bI^{\\ast} = -bI^{\\ast}$.\nThe Jacobian at the steady state, $J^{\\ast}$, is:\n$$ J^{\\ast} = \\begin{pmatrix} -bI^{\\ast}  -cI^{\\ast}  0 \\\\ 0  0  1 \\\\ s  -\\omega_{g}^{2}  -\\gamma_{g} \\end{pmatrix} $$\nThe characteristic equation is $\\det(J^{\\ast} - \\lambda I_{3}) = 0$, where $I_{3}$ is the $3 \\times 3$ identity matrix.\n$$ \\det \\begin{pmatrix} -bI^{\\ast}-\\lambda  -cI^{\\ast}  0 \\\\ 0  -\\lambda  1 \\\\ s  -\\omega_{g}^{2}  -\\gamma_{g}-\\lambda \\end{pmatrix} = 0 $$\nExpanding the determinant along the first column:\n$$ (-bI^{\\ast}-\\lambda)\\left((-\\lambda)(-\\gamma_{g}-\\lambda) - (1)(-\\omega_{g}^{2})\\right) - 0 + s\\left((-cI^{\\ast})(1) - (0)(-\\lambda)\\right) = 0 $$\n$$ (-bI^{\\ast}-\\lambda)(\\lambda^{2} + \\gamma_{g}\\lambda + \\omega_{g}^{2}) - scI^{\\ast} = 0 $$\n$$ -\\lambda^{3} - \\gamma_{g}\\lambda^{2} - \\omega_{g}^{2}\\lambda - bI^{\\ast}\\lambda^{2} - bI^{\\ast}\\gamma_{g}\\lambda - bI^{\\ast}\\omega_{g}^{2} - scI^{\\ast} = 0 $$\nMultiplying by $-1$ and grouping terms by powers of $\\lambda$:\n$$ \\lambda^{3} + (bI^{\\ast} + \\gamma_{g})\\lambda^{2} + (bI^{\\ast}\\gamma_{g} + \\omega_{g}^{2})\\lambda + (bI^{\\ast}\\omega_{g}^{2} + scI^{\\ast}) = 0 $$\nThis is the characteristic polynomial in the canonical form $\\lambda^{3} + a_{1}\\lambda^{2} + a_{2}\\lambda + a_{3} = 0$, with coefficients:\n$a_{1} = bI^{\\ast} + \\gamma_{g}$\n$a_{2} = bI^{\\ast}\\gamma_{g} + \\omega_{g}^{2}$\n$a_{3} = I^{\\ast}(b\\omega_{g}^{2} + sc)$\n\nFor stability of the steady state, the Routh-Hurwitz criteria for a cubic polynomial require $a_{1}  0$, $a_{3}  0$, and $a_{1}a_{2}  a_{3}$. A Hopf bifurcation occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. This corresponds to the threshold where the third criterion becomes an equality: $a_{1}a_{2} = a_{3}$.\nSince all parameters and $I^{\\ast}$ are positive, $a_{1}  0$ and $a_{3}  0$ are always satisfied. The Hopf bifurcation condition is thus:\n$$ (bI^{\\ast} + \\gamma_{g})(bI^{\\ast}\\gamma_{g} + \\omega_{g}^{2}) = I^{\\ast}(b\\omega_{g}^{2} + sc) $$\nWe are looking for the critical value $s_H$ where this condition holds. Let $I_H^{\\ast}$ be the value of $I^{\\ast}$ at $s=s_H$.\n$$ (bI_H^{\\ast} + \\gamma_{g})(bI_H^{\\ast}\\gamma_{g} + \\omega_{g}^{2}) = I_H^{\\ast}(b\\omega_{g}^{2} + s_H c) $$\nExpanding the left side:\n$ b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\omega_{g}^{2} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = bI_H^{\\ast}\\omega_{g}^{2} + I_H^{\\ast}cs_H $\nThe term $bI_H^{\\ast}\\omega_{g}^{2}$ cancels. Rearranging gives:\n$ b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = I_H^{\\ast}cs_H $\nWe use the expression for $I_H^{\\ast} = \\frac{\\gamma_{L}\\omega_{g}^{2}}{cs_H + b\\omega_{g}^{2}}$. Let $K = cs_H + b\\omega_{g}^{2}$, so $I_H^{\\ast} = \\frac{\\gamma_{L}\\omega_{g}^{2}}{K}$. Substituting this into the previous equation results in a quadratic equation for $K$:\n$ b^2\\gamma_{g}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{K}\\right)^2 + b\\gamma_{g}^{2}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{K}\\right) + \\gamma_{g}\\omega_{g}^{2} = \\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{K}\\right) \\frac{K-b\\omega_g^2}{I_H^\\ast} = \\frac{cs_H}{I_H^\\ast} ...$ this is getting complicated.\nLet's return to: $b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = I_H^{\\ast}cs_H$.\nAnd $cs_H = \\frac{\\gamma_{L}\\omega_{g}^{2}}{I_H^{\\ast}} - b\\omega_{g}^{2}$.\nSubstitute $cs_H$ into the equation:\n$ b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = I_H^{\\ast}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{I_H^{\\ast}} - b\\omega_{g}^{2}\\right) = \\gamma_{L}\\omega_{g}^{2} - bI_H^{\\ast}\\omega_{g}^{2} $\nThis gives a quadratic equation for $I_H^{\\ast}$:\n$ b^2\\gamma_{g}(I_H^{\\ast})^2 + (b\\gamma_{g}^{2} + b\\omega_{g}^{2})I_H^{\\ast} + (\\gamma_{g}\\omega_{g}^{2} - \\gamma_{L}\\omega_{g}^{2}) = 0 $\n$ b^2\\gamma_{g}(I_H^{\\ast})^2 + b(\\gamma_{g}^{2} + \\omega_{g}^{2})I_H^{\\ast} + \\omega_{g}^{2}(\\gamma_{g} - \\gamma_{L}) = 0 $\nLet's define $K=cs_H+b\\omega_g^2$. Substituting $I_H^{\\ast} = \\gamma_L\\omega_g^2/K$ into this equation:\n$ b^2\\gamma_g(\\frac{\\gamma_L\\omega_g^2}{K})^2 + b(\\gamma_g^2+\\omega_g^2)(\\frac{\\gamma_L\\omega_g^2}{K}) + \\omega_g^2(\\gamma_g-\\gamma_L) = 0$\nMultiplying by $K^2/(\\omega_g^2)$:\n$ b^2\\gamma_g\\gamma_L^2\\omega_g^2 + b\\gamma_L(\\gamma_g^2+\\omega_g^2)K + (\\gamma_g-\\gamma_L)K^2=0 $\nRearranging into standard quadratic form for $K$:\n$ (\\gamma_L-\\gamma_g)K^2 - b\\gamma_L(\\gamma_g^2+\\omega_g^2)K - b^2\\gamma_g\\gamma_L^2\\omega_g^2=0 $\nSolving for a positive $K$:\n$ K = \\frac{b\\gamma_L(\\gamma_g^2+\\omega_g^2) + \\sqrt{b^2\\gamma_L^2(\\gamma_g^2+\\omega_g^2)^2 + 4(\\gamma_L-\\gamma_g)b^2\\gamma_g\\gamma_L^2\\omega_g^2}}{2(\\gamma_L-\\gamma_g)} $\nThe negative root is discarded as $K$ must be positive. We simplify the term under the square root:\n$\\sqrt{\\cdots} = b\\gamma_L \\sqrt{(\\gamma_g^2+\\omega_g^2)^2 + 4\\gamma_g\\omega_g^2(\\gamma_L-\\gamma_g)} = b\\gamma_L \\sqrt{(\\gamma_g^2-\\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2}$\nSo,\n$ K = \\frac{b\\gamma_L \\left( \\gamma_g^2+\\omega_g^2 + \\sqrt{(\\gamma_g^2-\\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2} \\right)}{2(\\gamma_L-\\gamma_g)} $\nFinally, we solve for $s_H$ using $K = cs_H + b\\omega_g^2$:\n$ s_H = \\frac{K - b\\omega_g^2}{c} $\n$ s_H = \\frac{b\\gamma_L \\left( \\gamma_g^2+\\omega_g^2 + \\sqrt{(\\gamma_g^2-\\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2} \\right)}{2c(\\gamma_L-\\gamma_g)} - \\frac{b\\omega_g^2}{c} $\nPutting everything over a common denominator $2c(\\gamma_L-\\gamma_g)$:\n$ s_H = \\frac{b\\gamma_L ( \\gamma_g^2+\\omega_g^2 + \\sqrt{\\dots}) - 2cb\\omega_g^2(\\gamma_L-\\gamma_g)/c}{2c(\\gamma_L-\\gamma_g)} $\n$ s_H = \\frac{b}{2c(\\gamma_L-\\gamma_g)} \\left[ \\gamma_L(\\gamma_g^2+\\omega_g^2) + \\gamma_L\\sqrt{\\dots} - 2\\omega_g^2(\\gamma_L-\\gamma_g) \\right] $\n$ s_H = \\frac{b}{2c(\\gamma_L-\\gamma_g)} \\left[ \\gamma_L\\gamma_g^2+\\gamma_L\\omega_g^2 - 2\\gamma_L\\omega_g^2 + 2\\gamma_g\\omega_g^2 + \\gamma_L\\sqrt{\\dots} \\right] $\n$ s_H = \\frac{b}{2c(\\gamma_L-\\gamma_g)} \\left[ \\gamma_L(\\gamma_g^2 - \\omega_g^2) + 2\\gamma_g\\omega_g^2 + \\gamma_L\\sqrt{(\\gamma_g^2 - \\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2} \\right] $\nThis is the final closed-form expression for the Hopf bifurcation threshold $s_H$.",
            "answer": "$$\n\\boxed{\\frac{b}{2c(\\gamma_{L} - \\gamma_{g})} \\left[ \\gamma_{L}(\\gamma_{g}^{2} - \\omega_{g}^{2}) + 2\\gamma_{g}\\omega_{g}^{2} + \\gamma_{L}\\sqrt{(\\gamma_{g}^{2} - \\omega_{g}^{2})^{2} + 4\\gamma_{g}\\gamma_{L}\\omega_{g}^{2}} \\right]}\n$$"
        }
    ]
}