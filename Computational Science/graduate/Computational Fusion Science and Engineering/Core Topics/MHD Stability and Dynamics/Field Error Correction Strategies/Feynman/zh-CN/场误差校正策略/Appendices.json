{
    "hands_on_practices": [
        {
            "introduction": "场误差修正的第一步是识别哪些特定的磁场分量对等离子体最有害。这些“共振”谐波的螺距与磁力线的螺距相匹配，导致强烈的等离子体响应和旋转制动。通过本练习，您将使用共振条件 $q = m/n$ 来识别在特定安全因子 $q$ 值下哪些误差场谐波是危险的，并探讨为何低阶谐波通常构成最大的威胁。",
            "id": "3979168",
            "problem": "考虑一个圆形、大环径比的托卡马克，在其边缘区域，静态的固有误差场由外部误差场校正线圈进行校正。磁安全因子 $q$ 定义为磁力线每沿极向绕行一圈所沿环向绕行的圈数。有理面出现在磁力线图经过有限次数的极向和环向穿行后闭合的位置，这意味着存在整数 $m$ 和 $n$，使得在该磁面上磁力线满足 $q = m/n$。在线性磁流体动力学（MHD）中，一个由整数极向模数 $m$ 和环向模数 $n$ 标记的螺旋磁扰动谐波，在扰动螺旋度与磁力线螺距相匹配的磁面上与等离子体发生共振耦合，并且这个共振条件是等离子体旋转上增强的电磁制动力矩的来源。\n\n假设在主要的误差场-等离子体耦合发生的狭窄环形区域内，边缘安全因子为 $q = 2.5$，并考虑施加的静态误差场谐波，其极向模数 $m \\in \\{1,2,3,4,5\\}$，环向模数 $n \\in \\mathbb{Z}^{+}$ 为正整数。仅使用安全因子的定义和有理面闭合条件，确定对于给定的 $m$ 值，哪些 $n$ 谐波是精确共振的。此外，基于线性粘滞-电阻等离子体响应的第一性原理以及麦克斯韦应力的结构，论证哪个共振谐波最可能对维持环向旋转有害，并解释原因，同时参考有理层响应结构所隐含的关于 $n$ 的一般标度趋势。\n\n将最终答案表示为在给定 $m$ 值中产生共振的单个整数 $n$。无需四舍五入。将最终答案表示为一个无量纲的整数。",
            "solution": "该问题要求我们识别在给定条件下与等离子体发生共振的磁扰动谐波。共振条件是安全因子 $q$ 等于极向模数 $m$ 与环向模数 $n$ 之比：\n$$\nq = \\frac{m}{n}\n$$\n给定数据为：\n- 安全因子 $q = 2.5 = \\frac{5}{2}$\n- 极向模数集合 $m \\in \\{1, 2, 3, 4, 5\\}$\n- 环向模数 $n$ 为正整数 ($n \\in \\mathbb{Z}^{+}$)\n\n我们将 $q$ 的值代入共振条件，并整理以求解 $n$：\n$$\n\\frac{5}{2} = \\frac{m}{n} \\implies n = \\frac{2m}{5}\n$$\n现在，我们遍历给定的 $m$ 值，寻找能使 $n$ 成为正整数的解：\n- $m=1$: $n = 2(1)/5 = 0.4$ (非整数)\n- $m=2$: $n = 2(2)/5 = 0.8$ (非整数)\n- $m=3$: $n = 2(3)/5 = 1.2$ (非整数)\n- $m=4$: $n = 2(4)/5 = 1.6$ (非整数)\n- $m=5$: $n = 2(5)/5 = 2$ (正整数)\n\n因此，在给定的 $m$ 值范围内，唯一精确共振的谐波是 $(m, n) = (5, 2)$，对应的环向模数为 $n=2$。\n\n问题的第二部分要求论证哪个谐波最有害。共振谐波通过在有理面上形成磁岛来施加电磁力矩，从而制动等离子体旋转。力矩的大小是衡量其有害程度的指标。理论分析表明，对于给定的重联磁通振幅，电磁力矩 $T_{m,n}$ 与 $n^2$ 成正比。这似乎意味着高 $n$ 模式更有害。\n\n然而，我们必须考虑产生这些模式的外部误差场的振幅。这些误差场通常源于线圈位置偏差等局部制造缺陷。高模数（高 $m$ 和 $n$）对应于空间上快速变化的短波长场。根据电磁学原理，这类场会随着离源的距离增加而迅速衰减（即更易逝）。因此，外部误差场的振幅谱通常随着 $m$ 和 $n$ 的增加而快速下降。\n\n一个模式的总体有害性是这两个相反趋势竞争的结果：力矩与 $n^2$ 的内禀标度关系，以及源场强随 $(m, n)$ 的快速衰减。在绝大多数托卡马克实验中，后者是主导因素。因此，尽管力矩表达式中有 $n^2$ 因子，但通常是具有最大振幅的最低阶（低 $m$、低 $n$）共振谐波对等离子体构成最大威胁。\n\n在本问题中，我们只找到了一个共振谐波 $(m, n)=(5, 2)$，因此它就是最有害的那个。其对应的环向模数 $n$ 已经唯一确定为2。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "一旦识别出共振误差场，下一步就是建立模型来描述等离子体如何响应以及我们如何通过外部线圈来抵消这种响应。磁岛的形成和演化是共振场的一个关键后果，其行为可以通过卢瑟福方程来模拟。本练习将让您应用一个简化的卢瑟福模型，计算外部施加的共振磁扰动（RMP）如何改变磁岛的增长率，从而实现主动稳定控制。",
            "id": "3979118",
            "problem": "在电阻磁流体动力学（MHD）中，有理面附近的磁岛演化由感应电场和电阻扩散之间的平衡所控制，并与定义了撕裂不稳定性参数的外部理想区域相匹配。场误差修正策略采用外部施加的共振磁扰动（RMP）来改变撕裂模的有效驱动，旨在通过使净驱动足够为负来寻求稳定。考虑位于小半径为 $r_s$ 的有理面上的一个板状撕裂层，其中有一个小磁岛，使得惯性项和新经典项可以忽略不计，且磁岛旋转与外部场锁相。在此机制下，有效撕裂驱动是内禀撕裂参数与外加误差场贡献之和。使用此框架和作为卢瑟福型演化基础的电阻扩散时间标度，计算瞬时磁岛宽度增长率 $dw/dt$。\n\n给定参数 $\\Delta'=-2\\,\\mathrm{m}^{-1}$，$\\eta=1\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$，$r_s=0.5\\,\\mathrm{m}$，$C=10^3\\,\\mathrm{m}^{-1}\\mathrm{T}^{-1}$，$b_{mn}=2\\times 10^{-5}\\,\\mathrm{T}$，以及 $\\cos\\Delta\\phi=1$，其中 $\\Delta'$ 是撕裂模不稳定性指数，$\\eta$ 是等离子体电阻率，$r_s$ 是有理面小半径，$C$ 是外加共振场的几何耦合系数，$b_{mn}$ 是共振磁扰动振幅，$\\Delta\\phi$ 是磁岛与外加场之间的环向相位差，假设小磁岛近似成立，并且外部场以相加方式计入有效撕裂驱动。\n\n取自由空间磁导率 $\\mu_0$ 为 $\\mu_0=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$。在这些假设下，计算当 $w=3\\,\\mathrm{cm}$ 时的 $dw/dt$。以 $\\mathrm{m/s}$ 为单位表示最终答案，并将结果四舍五入至三位有效数字。",
            "solution": "该问题要求在存在外部施加的共振磁扰动（RMP）的情况下，计算磁岛的瞬时增长率 $\\frac{dw}{dt}$。根据问题描述，磁岛演化处于卢瑟福区域，其增长由简化的卢瑟福方程描述：\n$$\n\\frac{dw}{dt} = \\frac{\\eta}{\\mu_0} \\Delta'_{eff}\n$$\n其中，$\\eta$ 是等离子体电阻率，$\\mu_0$ 是自由空间磁导率，而 $\\Delta'_{eff}$ 是有效撕裂不稳定性参数。\n\n有效撕裂驱动 $\\Delta'_{eff}$ 是内禀撕裂参数 $\\Delta'$ 与来自RMP的贡献 $\\Delta'_{RMP}$ 之和：\n$$\n\\Delta'_{eff} = \\Delta' + \\Delta'_{RMP}\n$$\n根据给定的参数和量纲分析，RMP的贡献可以表示为：\n$$\n\\Delta'_{RMP} = C \\cdot b_{mn} \\cdot \\cos\\Delta\\phi\n$$\n其中 $C$ 是几何耦合系数，$b_{mn}$ 是共振磁扰动振幅，$\\cos\\Delta\\phi$ 是相位因子。在此模型中，增长率 $\\frac{dw}{dt}$ 与磁岛宽度 $w$ 无关。\n\n我们代入给定值进行计算：\n- 已知参数:\n  - $\\Delta' = -2\\,\\mathrm{m}^{-1}$\n  - $\\eta = 1 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$\n  - $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n  - $C = 10^3\\,\\mathrm{m}^{-1}\\mathrm{T}^{-1}$\n  - $b_{mn} = 2 \\times 10^{-5}\\,\\mathrm{T}$\n  - $\\cos\\Delta\\phi = 1$\n\n首先，计算RMP对撕裂驱动的贡献：\n$$\n\\Delta'_{RMP} = (10^3\\,\\mathrm{m}^{-1}\\mathrm{T}^{-1}) \\cdot (2 \\times 10^{-5}\\,\\mathrm{T}) \\cdot (1) = 0.02\\,\\mathrm{m}^{-1}\n$$\n\n接下来，计算有效撕裂驱动 $\\Delta'_{eff}$：\n$$\n\\Delta'_{eff} = \\Delta' + \\Delta'_{RMP} = -2\\,\\mathrm{m}^{-1} + 0.02\\,\\mathrm{m}^{-1} = -1.98\\,\\mathrm{m}^{-1}\n$$\n由于净驱动为负，磁岛预期会衰减。\n\n最后，计算磁岛的增长率 $\\frac{dw}{dt}$：\n$$\n\\frac{dw}{dt} = \\frac{\\eta}{\\mu_0} \\Delta'_{eff} = \\frac{1 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}}{4\\pi \\times 10^{-7}\\,\\mathrm{H/m}} \\cdot (-1.98\\,\\mathrm{m}^{-1})\n$$\n$$\n\\frac{dw}{dt} = \\frac{10}{4\\pi} \\cdot (-1.98)\\,\\mathrm{m/s} \\approx -1.57568\\,\\mathrm{m/s}\n$$\n根据要求，将结果四舍五入至三位有效数字：\n$$\n\\frac{dw}{dt} \\approx -1.58\\,\\mathrm{m/s}\n$$\n负值表示磁岛宽度正在减小，即衰减，这与稳定化的目标一致。",
            "answer": "$$\n\\boxed{-1.58}\n$$"
        },
        {
            "introduction": "在理解了物理原理和响应模型之后，实际的挑战就变成了计算出施加到修正线圈上的精确电流值。这个问题本质上是一个线性反问题：根据测量的误差场，我们应该设置什么样的线圈电流来抵消它？这类问题通常是“不适定的”，意味着微小的测量噪声可能导致求得的电流非常巨大而不切实际，因此需要采用正则化方法来获得一个稳定且物理上合理的解。 本练习将通过奇异值分解（SVD）来深入探讨两种核心的正则化技术——截断奇异值分解（TSVD）和吉洪诺夫（Tikhonov）正则化，并比较它们在求解场误差修正问题中的效果。",
            "id": "3979121",
            "problem": "在计算聚变科学与工程中，环形装置上的磁场误差校正可以被看作一个线性反问题。令 $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$ 是将线圈电流 $\\mathbf{x} \\in \\mathbb{R}^{n}$ 映射到测得的法向场误差 $\\mathbf{b} \\in \\mathbb{R}^{m}$ 的线性响应算子，并假设我们有一个我们希望通过选择 $\\mathbf{x}$ 来抵消的误差场的测量值 $\\mathbf{b}^{\\ast} \\in \\mathbb{R}^{m}$。考虑 $\\mathbf{A}$ 的奇异值分解 (SVD)，$\\mathbf{A} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$，其中 $\\mathbf{U} = [\\mathbf{u}_{1}, \\mathbf{u}_{2}, \\mathbf{u}_{3}] \\in \\mathbb{R}^{m \\times 3}$ 和 $\\mathbf{V} = [\\mathbf{v}_{1}, \\mathbf{v}_{2}, \\mathbf{v}_{3}] \\in \\mathbb{R}^{n \\times 3}$ 具有标准正交列，$\\boldsymbol{\\Sigma} = \\operatorname{diag}(s_{1}, s_{2}, s_{3})$ 的奇异值为 $s_{1} \\ge s_{2} \\ge s_{3} > 0$。假设主导可控子空间是三维的，其奇异值 $s = \\{5, 1, 0.1\\}$，测量投影 $c_{i} \\equiv \\mathbf{u}_{i}^{\\top} \\mathbf{b}^{\\ast} = \\{2, 1, 1\\}$。\n\n考虑两种场误差校正策略：\n1. 截断奇异值分解 (TSVD)，其中只保留奇异值 $s_{i} \\ge 1$ 的分量。\n2. Tikhonov 正则化，通过最小化 $\\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}^{\\ast}\\|_{2}^{2} + \\lambda \\|\\mathbf{x}\\|_{2}^{2}$ 获得，其中正则化参数 $\\lambda = 0.2$。\n\n从基本原理出发，使用最小二乘和正则化公式以及 SVD，在 $\\{\\mathbf{v}_{i}\\}$ 基中推导校正线圈电流矢量 $\\mathbf{x}_{\\text{TSVD}}$ 和 $\\mathbf{x}_{\\lambda}$，然后计算它们差值的欧几里得范数 $\\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}$。最终答案以安培为单位，并四舍五入到四位有效数字。不要提供中间的四舍五入值；只对最终答案进行四舍五入。",
            "solution": "问题在于为线圈电流 $\\mathbf{x}$ 找到两种不同的解，以抵消测得的磁场误差 $\\mathbf{b}^{\\ast}$，然后计算它们差值的欧几里得范数。线圈电流 $\\mathbf{x} \\in \\mathbb{R}^{n}$ 与场误差 $\\mathbf{b} \\in \\mathbb{R}^{m}$ 之间的关系由线性系统 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 给出。我们已知响应矩阵 $\\mathbf{A}$ 的奇异值分解 (SVD) 为 $\\mathbf{A} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$。问题被置于一个三维主导子空间中，因此我们有 $\\mathbf{U} = [\\mathbf{u}_{1}, \\mathbf{u}_{2}, \\mathbf{u}_{3}]$，$\\mathbf{V} = [\\mathbf{v}_{1}, \\mathbf{v}_{2}, \\mathbf{v}_{3}]$ 和 $\\boldsymbol{\\Sigma} = \\operatorname{diag}(s_{1}, s_{2}, s_{3})$。向量 $\\{\\mathbf{u}_i\\}$ 和 $\\{\\mathbf{v}_i\\}$ 构成标准正交集。给定的奇异值为 $s_1 = 5$，$s_2 = 1$ 和 $s_3 = 0.1$。测得的误差场 $\\mathbf{b}^{\\ast}$ 在左奇异向量上的投影为 $c_i \\equiv \\mathbf{u}_{i}^{\\top} \\mathbf{b}^{\\ast}$，其给定值为 $c_1=2$，$c_2=1$ 和 $c_3=1$。\n\n我们在右奇异向量 $\\{\\mathbf{v}_i\\}$ 的基中寻找解 $\\mathbf{x}$，因此我们写出 $\\mathbf{x} = \\sum_{j=1}^{3} \\alpha_j \\mathbf{v}_j$。系数 $\\alpha_j$ 有待确定。一般的伪逆解的系数为 $\\alpha_i = c_i / s_i$。\n\n**策略1：截断奇异值分解 (TSVD)**\nTSVD 解只保留奇异值 $s_i$ 大于或等于阈值（此处为1）的分量，其他分量设为零。\n奇异值为 $s_1=5 \\ge 1$，$s_2=1 \\ge 1$ 和 $s_3=0.1 < 1$。因此，我们保留 $i=1$ 和 $i=2$ 的分量，并截断 $i=3$ 的分量。\n$\\mathbf{x}_{\\text{TSVD}} = \\sum_{j=1}^{3} \\alpha_{j, \\text{TSVD}} \\mathbf{v}_j$ 的系数为：\n$$ \\alpha_{1, \\text{TSVD}} = \\frac{c_1}{s_1} = \\frac{2}{5} = 0.4 $$\n$$ \\alpha_{2, \\text{TSVD}} = \\frac{c_2}{s_2} = \\frac{1}{1} = 1 $$\n$$ \\alpha_{3, \\text{TSVD}} = 0 \\quad (\\text{截断}) $$\n所以，TSVD 解为 $\\mathbf{x}_{\\text{TSVD}} = 0.4 \\mathbf{v}_1 + 1 \\mathbf{v}_2$。\n\n**策略2：Tikhonov 正则化**\nTikhonov 正则化旨在最小化泛函 $J(\\mathbf{x}) = \\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}^{\\ast}\\|_{2}^{2} + \\lambda \\|\\mathbf{x}\\|_{2}^{2}$，其中正则化参数 $\\lambda=0.2$。\n使用 SVD 展开，该问题的解的系数为 $\\alpha_i = \\frac{s_i c_i}{s_i^2 + \\lambda}$。\n$\\mathbf{x}_{\\lambda} = \\sum_{j=1}^{3} \\alpha_{j, \\lambda} \\mathbf{v}_j$ 的系数为：\n$$ \\alpha_{1, \\lambda} = \\frac{s_1 c_1}{s_1^2 + \\lambda} = \\frac{5 \\times 2}{5^2 + 0.2} = \\frac{10}{25.2} = \\frac{25}{63} $$\n$$ \\alpha_{2, \\lambda} = \\frac{s_2 c_2}{s_2^2 + \\lambda} = \\frac{1 \\times 1}{1^2 + 0.2} = \\frac{1}{1.2} = \\frac{5}{6} $$\n$$ \\alpha_{3, \\lambda} = \\frac{s_3 c_3}{s_3^2 + \\lambda} = \\frac{0.1 \\times 1}{(0.1)^2 + 0.2} = \\frac{0.1}{0.01 + 0.2} = \\frac{0.1}{0.21} = \\frac{10}{21} $$\n所以，Tikhonov 解为 $\\mathbf{x}_{\\lambda} = \\frac{25}{63} \\mathbf{v}_1 + \\frac{5}{6} \\mathbf{v}_2 + \\frac{10}{21} \\mathbf{v}_3$。\n\n**差值的范数**\n我们需要计算 $\\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}$。差值向量是：\n$$ \\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda} = (\\alpha_{1, \\text{TSVD}} - \\alpha_{1, \\lambda})\\mathbf{v}_1 + (\\alpha_{2, \\text{TSVD}} - \\alpha_{2, \\lambda})\\mathbf{v}_2 + (\\alpha_{3, \\text{TSVD}} - \\alpha_{3, \\lambda})\\mathbf{v}_3 $$\n系数的差值为：\n$$ \\Delta\\alpha_1 = 0.4 - \\frac{25}{63} = \\frac{2}{5} - \\frac{25}{63} = \\frac{126 - 125}{315} = \\frac{1}{315} $$\n$$ \\Delta\\alpha_2 = 1 - \\frac{5}{6} = \\frac{1}{6} $$\n$$ \\Delta\\alpha_3 = 0 - \\frac{10}{21} = -\\frac{10}{21} $$\n由于基 $\\{\\mathbf{v}_i\\}$ 是标准正交的，差值向量的欧几里得范数是其系数平方和的平方根：\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2} = \\sqrt{(\\Delta\\alpha_1)^2 + (\\Delta\\alpha_2)^2 + (\\Delta\\alpha_3)^2} $$\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}^2 = \\left(\\frac{1}{315}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 + \\left(-\\frac{10}{21}\\right)^2 $$\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}^2 = \\frac{1}{99225} + \\frac{1}{36} + \\frac{100}{441} \\approx 0.000010078 + 0.027777... + 0.226757... $$\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}^2 \\approx 0.2545452255... $$\n现在我们取平方根：\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2} \\approx \\sqrt{0.2545452255...} \\approx 0.5045247519... $$\n四舍五入到四位有效数字，我们得到 $0.5045$。",
            "answer": "$$\\boxed{0.5045}$$"
        }
    ]
}