{
    "hands_on_practices": [
        {
            "introduction": "本次练习提供了一项基础的分析训练，旨在计算一个具有线性磁剪切的简化平板几何中的撕裂模稳定性指数 $\\Delta'$。通过求解这个理想化模型的外区理想方程并应用 $\\Delta'$ 的定义，我们可以掌握核心的数学步骤。这个练习不仅有助于理解计算 $\\Delta'$ 的基本方法，还揭示了均匀电流分布为何本质上是稳定的，为更复杂的分析奠定了坚实的基础 ()。",
            "id": "4039447",
            "problem": "考虑一个处于笛卡尔坐标系 $(x,y,z)$ 中的板状等离子体，其平衡磁场为 $\\mathbf{B}_0(x) = B_y(x)\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}$，其中 $B_y(x) = B'_y x$，$B_z$ 为均匀引导场。假设质量密度均匀，平衡压力梯度可忽略，且扰动是不可压缩的。关注一种具有空间依赖性 $\\exp(i k y)$ 的撕裂模扰动，其中 $k \\equiv |k_y| > 0$ 且 $k_z = 0$。假设电阻层与宏观尺度相比是渐近薄的，因此外部区域由理想磁流体力学（MHD）主导。\n\n使用磁通函数 $\\psi(x)$ 定义平面内扰动磁场，使得 $\\delta \\mathbf{B}_\\perp = \\hat{\\mathbf{z}} \\times \\nabla \\psi$；等价地，$\\delta B_x = i k \\psi$ 且 $\\delta B_y = -\\frac{d\\psi}{dx}$。在外部区域，理想MHD适用，磁力线被冻结在等离子体中。\n\n从线性化理想MHD方程以及位移与扰动磁场之间的适当关系出发，推导外部区域磁通函数 $\\psi(x)$ 的主导常微分方程，针对给定的平衡 $B_y(x) = B'_y x$ 求解该方程，并施加边界条件，即当 $|x| \\to \\infty$ 时 $\\psi(x)$ 衰减。使用撕裂模不稳定性指数的标准定义\n$$\\Delta' \\equiv \\frac{\\psi'(+0) - \\psi'(-0)}{\\psi(0)},$$\n其中 $\\psi(0)$ 是 $\\psi$ 在共振面 $x=0$ 处的连续值，$\\psi'(\\pm 0)$ 表示单侧导数，计算此板状位形的 $\\Delta'$。\n\n你的最终答案必须是关于 $k$ 的单个闭式解析表达式。$k$ 的单位为 $\\mathrm{m}^{-1}$。不需要进行数值舍入。",
            "solution": "问题要求计算给定板状等离子体平衡的撕裂模不稳定性指数 $\\Delta'$。这个过程包括推导理想外部区域中扰动磁通函数 $\\psi(x)$ 的主导方程，用适当的边界条件求解该方程，然后利用解来计算 $\\Delta'$。\n\n出发点是静态平衡（$\\partial_t = 0$，$\\mathbf{v}_0 = 0$）下的线性化理想磁流体力学（MHD）方程，它代表了临界稳定性。动量方程简化为力平衡方程：\n$$\n\\mathbf{J}_1 \\times \\mathbf{B}_0 + \\mathbf{J}_0 \\times \\mathbf{B}_1 - \\nabla p_1 = 0\n$$\n其中 $\\mathbf{B}_0$ 和 $\\mathbf{J}_0$ 是平衡磁场和电流密度，而 $\\mathbf{B}_1$、$\\mathbf{J}_1$ 和 $p_1$ 是扰动量。\n\n首先，我们根据问题陈述来定义所有矢量。平衡磁场由 $\\mathbf{B}_0(x) = B_y(x)\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}$ 给出，其中 $B_y(x) = B'_y x$ 且 $B_z$ 为常数。\n平衡电流密度 $\\mathbf{J}_0$ 可通过安培定律 $\\mathbf{J}_0 = \\frac{1}{\\mu_0}\\nabla \\times \\mathbf{B}_0$ 求得：\n$$\n\\mathbf{J}_0 = \\frac{1}{\\mu_0} \\nabla \\times (B'_y x\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}) = \\frac{1}{\\mu_0} \\frac{\\partial(B'_y x)}{\\partial x} \\hat{\\mathbf{z}} = \\frac{B'_y}{\\mu_0} \\hat{\\mathbf{z}}\n$$\n注意 $\\mathbf{J}_0$ 在空间上是均匀的。\n\n假设扰动的形式为 $f(x) \\exp(i k y)$。扰动磁场用磁通函数 $\\psi(x)$ 表示为 $\\mathbf{B}_1 = \\delta \\mathbf{B}_\\perp = \\hat{\\mathbf{z}} \\times \\nabla (\\psi(x) \\exp(i k y))$。这给出的分量为 $\\delta B_x = i k \\psi(x) \\exp(i k y)$ 和 $\\delta B_y = - \\frac{d\\psi}{dx} \\exp(i k y)$。为简单起见，我们将处理扰动的振幅，因此 $\\mathbf{B}_1 = ik\\psi(x)\\,\\hat{\\mathbf{x}} - \\psi'(x)\\,\\hat{\\mathbf{y}}$，其中撇号表示对 $x$ 求导。\n\n扰动电流密度为 $\\mathbf{J}_1 = \\frac{1}{\\mu_0}\\nabla \\times \\mathbf{B}_1$：\n$$\n\\mathbf{J}_1 = \\frac{1}{\\mu_0} \\nabla \\times (ik\\psi\\,\\hat{\\mathbf{x}} - \\psi'\\,\\hat{\\mathbf{y}}) = \\frac{1}{\\mu_0} \\left( \\frac{\\partial(-\\psi')}{\\partial x} - \\frac{\\partial(ik\\psi)}{\\partial y} \\right) \\hat{\\mathbf{z}} = \\frac{1}{\\mu_0} \\left( -\\psi'' - (ik)(ik\\psi) \\right) \\hat{\\mathbf{z}} = \\frac{1}{\\mu_0} (k^2\\psi - \\psi'') \\hat{\\mathbf{z}}\n$$\n\n现在，我们计算动量方程中的洛伦兹力项。\n$$\n\\mathbf{J}_0 \\times \\mathbf{B}_1 = \\left(\\frac{B'_y}{\\mu_0} \\hat{\\mathbf{z}}\\right) \\times \\left(ik\\psi\\,\\hat{\\mathbf{x}} - \\psi'\\,\\hat{\\mathbf{y}}\\right) = \\frac{B'_y}{\\mu_0} \\left( ik\\psi(\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{x}}) - \\psi'(\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{y}}) \\right) = \\frac{B'_y}{\\mu_0} \\left( ik\\psi\\,\\hat{\\mathbf{y}} + \\psi'\\,\\hat{\\mathbf{x}} \\right)\n$$\n$$\n\\mathbf{J}_1 \\times \\mathbf{B}_0 = \\left(\\frac{1}{\\mu_0} (k^2\\psi - \\psi'') \\hat{\\mathbf{z}}\\right) \\times \\left(B'_y x\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}\\right) = \\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') (\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{y}}) = -\\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') \\hat{\\mathbf{x}}\n$$\n\n力平衡方程 $\\mathbf{J}_1 \\times \\mathbf{B}_0 + \\mathbf{J}_0 \\times \\mathbf{B}_1 - \\nabla p_1 = 0$ 可以写成分量形式。扰动 $p_1$ 具有空间依赖性 $p_1(x)\\exp(iky)$，因此 $\\nabla p_1 = p_1'(x)\\,\\hat{\\mathbf{x}} + ikp_1(x)\\,\\hat{\\mathbf{y}}$。\n力平衡方程的y分量为：\n$$\n(\\mathbf{J}_0 \\times \\mathbf{B}_1)_y - ikp_1 = 0 \\implies \\frac{ikB'_y}{\\mu_0}\\psi - ikp_1 = 0\n$$\n这使我们可以用磁通函数表示扰动压力：$p_1(x) = \\frac{B'_y}{\\mu_0}\\psi(x)$。对 $x$ 求导，我们得到 $p_1'(x) = \\frac{B'_y}{\\mu_0}\\psi'(x)$。\n\n力平衡方程的x分量为：\n$$\n(\\mathbf{J}_1 \\times \\mathbf{B}_0)_x + (\\mathbf{J}_0 \\times \\mathbf{B}_1)_x - p_1' = 0\n$$\n代入推导出的表达式：\n$$\n-\\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') + \\frac{B'_y}{\\mu_0}\\psi' - \\frac{B'_y}{\\mu_0}\\psi' = 0\n$$\n包含 $\\psi'$ 的项相互抵消，剩下：\n$$\n-\\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') = 0\n$$\n在外部区域，我们远离 $x=0$ 处的共振面。因此，对于 $x \\neq 0$，$\\psi(x)$ 的主导常微分方程（ODE）必须是：\n$$\n\\psi''(x) - k^2\\psi(x) = 0\n$$\n这是理想外部区域中扰动磁通函数的著名方程。\n\n接下来，我们在扰动于无穷远处消失的边界条件下求解此ODE，即当 $|x| \\to \\infty$ 时 $\\psi(x) \\to 0$。\n该ODE的通解为 $\\psi(x) = A e^{kx} + B e^{-kx}$。我们必须在 $x>0$ 和 $x0$ 这两个独立的区域中求解。\n\n对于 $x > 0$：为满足当 $x \\to \\infty$ 时 $\\psi(x) \\to 0$，我们必须将增长的指数项 $e^{kx}$ 的系数设为零（因为 $k>0$）。解的形式为：\n$$\n\\psi_+(x) = C_+ e^{-kx} \\quad (x>0)\n$$\n\n对于 $x  0$：为满足当 $x \\to -\\infty$ 时 $\\psi(x) \\to 0$，我们必须将 $e^{-kx}$ 项的系数设为零，因为当x为负时该项会指数级增长。解的形式为：\n$$\n\\psi_-(x) = C_- e^{kx} \\quad (x0)\n$$\n\n撕裂模理论要求磁通函数 $\\psi(x)$ 在 $x=0$ 的电阻层上是连续的。因此，我们强制要求 $\\psi_+(0) = \\psi_-(0)$。\n$$\nC_+ e^0 = C_- e^0 \\implies C_+ = C_-\n$$\n我们将这个公共常数记为 $C$。这也确定了值 $\\psi(0) = C$。在整个外部区域，$\\psi(x)$ 的解可以紧凑地写成：\n$$\n\\psi(x) = C e^{-k|x|}\n$$\n\n最后，我们计算撕裂模不稳定性指数 $\\Delta'$，其定义为：\n$$\n\\Delta' \\equiv \\frac{\\psi'(+0) - \\psi'(-0)}{\\psi(0)}\n$$\n我们需要求出 $\\psi(x)$ 在 $x=0$ 处的单侧导数。\n对于 $x>0$，$\\psi(x) = C e^{-kx}$，所以其导数为 $\\psi'(x) = -k C e^{-kx}$。当 $x$ 从正方向趋近于 $0$ 时的极限是：\n$$\n\\psi'(+0) = \\lim_{x\\to 0^+} (-k C e^{-kx}) = -kC\n$$\n对于 $x0$，$\\psi(x) = C e^{kx}$，所以其导数为 $\\psi'(x) = k C e^{kx}$。当 $x$ 从负方向趋近于 $0$ 时的极限是：\n$$\n\\psi'(-0) = \\lim_{x\\to 0^-} (k C e^{kx}) = kC\n$$\n将这些值和 $\\psi(0)=C$ 代入 $\\Delta'$ 的定义中：\n$$\n\\Delta' = \\frac{(-kC) - (kC)}{C} = \\frac{-2kC}{C}\n$$\n假设存在非平凡扰动（$C \\neq 0$），我们得到最终结果：\n$$\n\\Delta' = -2k\n$$\n这个结果表明，对于给定的线性剪切分布，等离子体对所有波长的撕裂模都是稳定的（因为 $k>0$ 导致 $\\Delta'  0$）。这是预料之中的，因为均匀的电流分布缺乏驱动不稳定性所必需的自由能梯度。",
            "answer": "$$\\boxed{-2k}$$"
        },
        {
            "introduction": "在掌握了基础方法后，我们转向一个更符合物理实际的模型——哈里斯电流片，这是研究磁重联的经典平衡位形。通过计算这种位形下的 $\\Delta'$，我们将揭示撕裂模不稳定的条件，并探索不稳定性如何依赖于扰动波长。理解这种依赖性对于预测和控制聚变等离子体中的磁岛形成至关重要 ()。",
            "id": "4039489",
            "problem": "考虑一个二维板状等离子体平衡，其电流片半厚度为 $a$，磁场反转由 $B_y(x) = B_0 \\tanh(x/a)$ 建模，并存在一个均匀的引导场 $B_z$ 和可忽略的等离子体压强。在电阻磁流体动力学（MHD）的框架下，可以通过将等离子体分为外部理想MHD区域和内部电阻层来分析撕裂模不稳定性。在外部区域，于临界稳定状态（零频率）下，对于形如 $\\propto \\exp(i k y)$ 的扰动，其扰动磁通函数 $\\psi(x)$ 满足线性化的理想MHD方程\n$$\n\\frac{d^2 \\psi}{dx^2} - k^2 \\psi - \\frac{B_y''(x)}{B_y(x)} \\psi = 0,\n$$\n且撕裂模不稳定性指数定义为\n$$\n\\Delta' \\equiv \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} - \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-}.\n$$\n从这些基本原理出发，求解给定平衡下的外部区域本征函数 $\\psi(x)$，并计算精确的无量纲指数 $\\Delta' a$ 作为无量纲波数 $k a$ 的函数。然后，取薄片极限 $k a \\ll 1$，确定 $\\Delta' a$ 对 $k a$ 的主阶渐近依赖关系。解释您的结果对于当 $k a$ 变化时电阻撕裂模不稳定性的可及性的物理含义。您的最终答案必须是 $\\Delta' a$ 在 $k a \\ll 1$ 极限下对 $k a$ 的主阶依赖关系的单一闭式解析表达式。",
            "solution": "首先，我们必须确定给定平衡磁场 $B_y(x) = B_0 \\tanh(x/a)$ 的势能项 $\\frac{B_y''(x)}{B_y(x)}$。我们计算 $B_y(x)$ 对 $x$ 的一阶和二阶导数：\n$$\nB_y'(x) = \\frac{d}{dx} \\left( B_0 \\tanh\\left(\\frac{x}{a}\\right) \\right) = \\frac{B_0}{a} \\text{sech}^2\\left(\\frac{x}{a}\\right)\n$$\n$$\nB_y''(x) = \\frac{d}{dx} \\left( \\frac{B_0}{a} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\right) = \\frac{B_0}{a} \\cdot 2 \\text{sech}\\left(\\frac{x}{a}\\right) \\cdot \\left(-\\text{sech}\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)\\right) \\cdot \\frac{1}{a} = -\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)\n$$\n现在我们可以构造这个比率：\n$$\n\\frac{B_y''(x)}{B_y(x)} = \\frac{-\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)}{B_0 \\tanh\\left(\\frac{x}{a}\\right)} = -\\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\n$$\n将此代入给定的外部区域方程，得到：\n$$\n\\frac{d^2 \\psi}{dx^2} - k^2 \\psi - \\left(-\\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\\right) \\psi = 0\n$$\n$$\n\\frac{d^2 \\psi}{dx^2} - \\left(k^2 - \\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\\right) \\psi = 0\n$$\n这是一个类薛定谔方程。解必须是物理上现实的，意味着当 $|x| \\to \\infty$ 时它必须趋于零。该方程关于 $x \\to -x$ 是对称的，因此我们寻找具有确定宇称的本征函数。最低能量（最不稳定）的撕裂模对应于一个偶本征函数，$\\psi(x) = \\psi(-x)$。满足边界条件 $\\psi(x) \\to 0$ 当 $|x| \\to \\infty$ 的这个方程的解是已知的：\n$$\n\\psi(x) = C \\exp(-k|x|) \\left( 1 + \\frac{\\tanh(|x|/a)}{ka} \\right)\n$$\n其中 $C$ 是一个任意常数。该解可以通过直接代入进行验证。\n\n接下来，我们计算撕裂模不稳定性指数 $\\Delta'$。我们需要 $\\psi$ 在原点 $x=0$ 两侧的对数导数。由于存在绝对值函数，我们必须分别考虑 $x > 0$ 和 $x  0$ 的情况。\n\n对于 $x > 0$，有 $|x| = x$，所以本征函数为：\n$$\n\\psi(x) = C \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right)\n$$\n对 $x$ 的导数为：\n$$\n\\psi'(x) = C \\left[ -k \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) + \\exp(-kx) \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\n现在我们在 $x \\to 0^+$ 的极限下计算 $\\psi(x)$ 和 $\\psi'(x)$。\n$$\n\\psi(0^+) = \\lim_{x \\to 0^+} C \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) = C (1) \\left( 1 + \\frac{0}{ka} \\right) = C\n$$\n$$\n\\psi'(0^+) = \\lim_{x \\to 0^+} C \\left[ -k \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) + \\exp(-kx) \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\n$$\n\\psi'(0^+) = C \\left[ -k(1)\\left(1 + 0\\right) + (1)\\left(\\frac{1}{ka^2}\\right) \\right] = C \\left(\\frac{1}{ka^2} - k\\right)\n$$\n因此，在 $x=0^+$ 处的对数导数为：\n$$\n\\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} = \\frac{\\psi'(0^+)}{\\psi(0^+)} = \\frac{C \\left(\\frac{1}{ka^2} - k\\right)}{C} = \\frac{1}{ka^2} - k\n$$\n对于 $x  0$，有 $|x| = -x$，所以本征函数为：\n$$\n\\psi(x) = C \\exp(kx) \\left( 1 + \\frac{\\tanh(-x/a)}{ka} \\right) = C \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right)\n$$\n对 $x$ 的导数为：\n$$\n\\psi'(x) = C \\left[ k \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right) + \\exp(kx) \\left( -\\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\n现在我们在 $x \\to 0^-$ 的极限下计算 $\\psi(x)$ 和 $\\psi'(x)$。\n$$\n\\psi(0^-) = \\lim_{x \\to 0^-} C \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right) = C (1) \\left( 1 - 0 \\right) = C\n$$\n（正如预期的那样，$\\psi(x)$ 在 $x=0$ 处是连续的。）\n$$\n\\psi'(0^-) = \\lim_{x \\to 0^-} C \\left[ k \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right) - \\exp(kx) \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\n$$\n\\psi'(0^-) = C \\left[ k(1)\\left(1-0\\right) - (1)\\left(\\frac{1}{ka^2}\\right) \\right] = C \\left(k - \\frac{1}{ka^2}\\right)\n$$\n因此，在 $x=0^-$ 处的对数导数为：\n$$\n\\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-} = \\frac{\\psi'(0^-)}{\\psi(0^-)} = \\frac{C \\left(k - \\frac{1}{ka^2}\\right)}{C} = k - \\frac{1}{ka^2}\n$$\n现在我们可以用其定义计算 $\\Delta'$：\n$$\n\\Delta' = \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} - \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-} = \\left(\\frac{1}{ka^2} - k\\right) - \\left(k - \\frac{1}{ka^2}\\right) = \\frac{2}{ka^2} - 2k\n$$\n问题要求的是无量纲指数 $\\Delta' a$。乘以 $a$ 得到：\n$$\n\\Delta' a = 2 \\left( \\frac{1}{ka} - ka \\right)\n$$\n这是无量纲稳定性指数作为无量纲波数 $k a$ 函数的精确表达式。\n\n接下来，我们取薄片极限 $k a \\ll 1$。在此极限下，项 $ka$ 远小于项 $1/(ka)$。因此，我们可以忽略第二项来找到主阶渐近依赖关系：\n$$\n\\Delta' a \\approx 2 \\left( \\frac{1}{ka} \\right) \\quad \\text{对于 } ka \\ll 1\n$$\n\n最后，我们讨论物理含义。电阻撕裂模不稳定性是由磁场中的自由能驱动的，当 $\\Delta' > 0$ 时不稳定。我们的完整结果 $\\Delta' a = 2((ka)^{-1} - ka)$ 表明，当 $(ka)^{-1} > ka$ 时 $\\Delta' > 0$，这可以简化为 $(ka)^2  1$，或 $0  ka  1$（因为 $k a$ 必须为正）。这意味着对于波长 $\\lambda = 2\\pi/k$ 大于 $2\\pi a$ 的撕裂模是不稳定的。\n在薄片极限（$ka \\ll 1$）下，这对应于与电流片半厚度 $a$ 相比非常长的波长，稳定性指数 $\\Delta' a$ 变得很大且为正，其标度关系为 $(ka)^{-1}$。由于撕裂模的增长率是 $\\Delta'$ 的单调递增函数（例如，在标准理论中 $\\gamma \\propto (\\Delta')^{4/5}$），一个大的正 $\\Delta'$ 意味着强不稳定性。\n因此，对于长波扰动，撕裂模不稳定性最容易发生且增长最快。随着波长减小（即随着 $ka$ 趋向于 $1$），$\\Delta' a$ 减小，从而削弱了不稳定的驱动。在 $ka=1$ 时，我们发现 $\\Delta' = 0$，表示临界稳定。对于 $ka > 1$（短波长），$\\Delta'$ 变为负值，这会使模式稳定下来。这种在短波长下的稳定是由于弯曲磁力线需要大量能量，这超过了磁重联释放的能量。",
            "answer": "$$\n\\boxed{\\frac{2}{ka}}\n$$"
        },
        {
            "introduction": "在许多实际且复杂的等离子体位形中，稳定性指数 $\\Delta'$ 必须通过数值方法获得。本次动手实践要求你编写一个程序，使用“打靶法”求解外区理想方程，从而计算 $\\Delta'$。这项练习是连接解析理论与现代聚变研究中计算工具的关键桥梁，它还包含了通过与已知的解析解进行比较来验证代码准确性的重要步骤 ()。",
            "id": "4039453",
            "problem": "您的任务是构建一种数值方法，通过对外部（理想）线性化方程进行积分，并评估在有理面上扰动磁通量对数导数的跳跃，来计算撕裂模不稳定性参数 $\\Delta'$。所有量均为无量纲。\n\n此任务的基础如下：\n- 在电阻磁流体动力学（MHD）的外部理想区域，扰动螺旋磁通函数 $\\,\\psi\\,$ 满足一个二阶线性齐次常微分方程，其形式取决于几何形状和对称性，但不包含电阻率。\n- 撕裂模不稳定性参数由 $\\,\\psi\\,$ 的对数导数在有理面 $\\,r_s\\,$ （或在平板中为 $\\,x=0\\,$）两侧的跳跃定义，即\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^+} - \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^-}.\n$$\n此定义消除了对 $\\,\\psi\\,$ 任意归一化的依赖。\n\n您必须构建一个程序，该程序：\n1. 从 $\\,r_s\\,$ 的两侧对外部理想方程进行数值积分，以使用上述定义计算 $\\,\\Delta'\\,$。\n2. 通过为每个案例计算解析 $\\,\\Delta'\\,$ 并测量差异，将数值结果与解析案例进行验证。\n\n对于此问题，请考虑两种几何形状及其理想外部方程：\n- 具有波数 $\\,k\\,$ 的平板几何：\n  - 对于 $\\,x\\neq 0\\,$ 的外部理想方程：\n    $$\\frac{d^2\\psi}{dx^2} - k^2 \\psi = 0.$$\n  - 边界条件在 $\\,x=\\pm L\\,$ 处指定，为狄利克雷（Dirichlet）条件（$\\,\\psi(\\pm L) = 0\\,$）或诺伊曼（Neumann）条件（$\\,d\\psi/dx|_{x=\\pm L}=0$）。有理面位于 $\\,x=0\\,$。\n\n- 具有角向模数 $\\,m\\ge 1\\,$ 的圆柱几何：\n  - 对于 $\\,r\\neq r_s\\,$ 的外部理想方程：\n    $$\n    \\frac{d}{dr}\\left(r \\frac{d\\psi}{dr}\\right) - \\frac{m^2}{r}\\,\\psi = 0,\n    $$\n    或等效地 \n    $$\n    \\psi''(r) = \\frac{m^2}{r^2}\\psi(r) - \\frac{1}{r}\\psi'(r).\n    $$\n  - 边界条件是轴心处的正则性（当 $\\,r\\to 0\\,$ 时，$\\,\\psi \\sim r^m\\,$）和在大半径处的类真空衰减（当 $\\,r\\to \\infty\\,$ 时，$\\,\\psi \\sim r^{-m}\\,$）。有理面位于 $\\,r=r_s\\,$。在实践中，您必须使用与所述行为一致的渐近初始条件，从一个大但有限的外半径 $\\,R\\,$向内积分，并从满足 $\\,0  \\epsilon \\ll r_s\\,$ 的一个小但有限的内半径 $\\,\\epsilon\\,$ 向外积分。\n\n请编写一个程序，对以下五个测试案例计算数值 $\\,\\Delta'\\,$，并将其与解析解进行比较，报告每个案例的相对误差：\n1.  平板几何，狄利克雷边界条件，参数 $\\,k=0.7,\\,L=1.0\\,$。\n2.  平板几何，诺伊曼边界条件，参数 $\\,k=0.7,\\,L=1.0\\,$。\n3.  平板几何，狄利克雷边界条件，参数 $\\,k=0.7,\\,L=10.0\\,$。\n4.  圆柱几何，参数 $\\,m=2,\\,r_s=0.3,\\,R=4.0\\,$。\n5.  圆柱几何，参数 $\\,m=1,\\,r_s=0.5,\\,R=3.0\\,$。\n\n您的最终答案必须是一个包含五个浮点数的列表，代表每个测试案例的相对误差，格式为 `[error1,error2,error3,error4,error5]`。",
            "solution": "为了验证数值方法，我们首先为指定的测试案例推导 $\\Delta'$ 的精确解析表达式。$\\Delta'$ 的定义（采用“外部减内部”或“右侧减左侧”的约定）是：\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^+} - \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^-}\n$$\n其中有理面位于 $r=r_s$（在平板几何中为 $x=0$）。解 $\\psi_-$ 和 $\\psi_+$ 分别对应于区域 $r  r_s$ 和 $r > r_s$。\n\n**平板几何**\n控制方程为 $\\frac{d^2\\psi}{dx^2} - k^2 \\psi = 0$。通解是双曲函数的线性组合，$\\psi(x) = A \\cosh(kx) + B \\sinh(kx)$。有理面位于 $x=0$。\n1.  **狄利克雷边界条件 ($\\psi(\\pm L) = 0$):**\n    -   对于右侧解（$x \\in [0, L]$），边界条件 $\\psi(L) = 0$ 要求解的形式为 $\\psi_+(x) = C_2 \\sinh(k(L-x))$。其对数导数为 $\\frac{\\psi'_+(x)}{\\psi_+(x)} = -k \\coth(k(L-x))$。在 $x=0^+$ 处，其值为 $-k \\coth(kL)$。\n    -   对于左侧解（$x \\in [-L, 0]$），边界条件 $\\psi(-L) = 0$ 要求解的形式为 $\\psi_-(x) = C_1 \\sinh(k(L+x))$。其对数导数为 $\\frac{\\psi'_-(x)}{\\psi_-(x)} = k \\coth(k(L+x))$。在 $x=0^-$ 处，这变为 $k \\coth(kL)$。\n    -   将这些结合起来得到 $\\Delta' = (-k \\coth(kL)) - (k \\coth(kL)) = -2k \\coth(kL) = -\\frac{2k}{\\tanh(kL)}$。\n\n2.  **诺伊曼边界条件 ($\\psi'(\\pm L) = 0$):**\n    -   对于右侧解（$x \\in [0, L]$），条件 $\\psi'(L)=0$ 选择了 $\\psi_+(x) = C_2 \\cosh(k(L-x))$ 这个解。在 $x=0^+$ 处的对数导数为 $-k \\tanh(kL)$。\n    -   对于左侧解（$x \\in [-L, 0]$），条件 $\\psi'(-L)=0$ 选择了 $\\psi_-(x) = C_1 \\cosh(k(L+x))$ 这个解。在 $x=0^-$ 处的对数导数为 $k \\tanh(kL)$。\n    -   因此，对于诺伊曼情况，$\\Delta' = (-k \\tanh(kL)) - (k \\tanh(kL)) = -2k \\tanh(kL)$。\n\n**圆柱几何**\n控制方程是一个柯西-欧拉方程（Cauchy-Euler equation）：$r^2 \\psi'' + r \\psi' - m^2 \\psi = 0$。通解为 $\\psi(r) = A r^m + B r^{-m}$，其中 $m \\ge 1$。\n-   对于外部解（$r > r_s$），我们施加一个类真空衰减条件，即当 $r \\to \\infty$ 时 $\\psi(r) \\to 0$。$r^m$ 项增长，所以必须有 $A=0$。解为 $\\psi_+(r) = B r^{-m}$。对数导数为 $\\frac{\\psi'_+(r)}{\\psi_+(r)} = \\frac{-m r^{-m-1}}{r^{-m}} = -\\frac{m}{r}$。在 $r=r_s^+$ 处，此值为 $-\\frac{m}{r_s}$。\n-   对于内部解（$r  r_s$），轴心（$r=0$）处的正则性要求解是良态的。$r^{-m}$ 项发散，所以必须有 $B=0$。解为 $\\psi_-(r) = A r^m$。对数导数为 $\\frac{\\psi'_-(r)}{\\psi_-(r)} = \\frac{m r^{m-1}}{r^m} = \\frac{m}{r}$。在 $r=r_s^-$ 处，此值为 $\\frac{m}{r_s}$。\n-   结合这些结果得出 $\\Delta' = -\\frac{m}{r_s} - \\frac{m}{r_s} = -\\frac{2m}{r_s}$。这个解析结果假设边界在 $r=0$ 和 $r=\\infty$ 处。数值计算使用在 $r=\\epsilon$ 和 $r=R$ 处的有限边界，这会引入一个小的、预期的差异。\n\n**数值积分方法**\n\n为了数值求解二阶常微分方程（ODEs），我们首先将其转换为一阶常微分方程组。我们定义一个状态向量 $\\mathbf{y}(t) = [\\psi(t), \\psi'(t)]^T$。该系统形式为 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$。我们使用 SciPy 库中的 `solve_ivp` 函数进行高精度数值积分。\n\n**平板系统：**\n对于方程 $\\psi'' = k^2 \\psi$，令 $y_0 = \\psi$ 和 $y_1 = \\psi'$。一阶系统为：\n$$\n\\frac{d}{dx} \\begin{pmatrix} y_0 \\\\ y_1 \\end{pmatrix} = \\begin{pmatrix} y_1 \\\\ k^2 y_0 \\end{pmatrix}\n$$\n我们从 $x = \\pm L$ 处的边界到 $x=0$ 处的有理面对该系统进行积分。\n-   左侧积分：从 $x=-L$ 到 $x=0$。\n    -   狄利克雷：初始条件 $\\mathbf{y}(-L) = [0, 1]^T$。\n    -   诺伊曼：初始条件 $\\mathbf{y}(-L) = [1, 0]^T$。\n-   右侧积分：从 $x=L$ 到 $x=0$。\n    -   狄利克雷：初始条件 $\\mathbf{y}(L) = [0, 1]^T$。\n    -   诺伊曼：初始条件 $\\mathbf{y}(L) = [1, 0]^T$。\n\n**圆柱系统：**\n对于方程 $\\psi''(r) = \\frac{m^2}{r^2}\\psi(r) - \\frac{1}{r}\\psi'(r)$，令 $y_0 = \\psi$ 和 $y_1 = \\psi'$。一阶系统为：\n$$\n\\frac{d}{dr} \\begin{pmatrix} y_0 \\\\ y_1 \\end{pmatrix} = \\begin{pmatrix} y_1 \\\\ \\frac{m^2}{r^2}y_0 - \\frac{1}{r}y_1 \\end{pmatrix}\n$$\n-   内部积分：从小半径 $r=\\epsilon$ 到 $r=r_s$。初始条件由渐近行为 $\\psi \\sim r^m$ 推导得出：$\\mathbf{y}(\\epsilon) = [\\epsilon^m, m\\epsilon^{m-1}]^T$。我们选择 $\\epsilon = 10^{-8}$。\n-   外部积分：从大半径 $r=R$ 到 $r=r_s$。初始条件由渐近行为 $\\psi \\sim r^{-m}$ 推导得出：$\\mathbf{y}(R) = [R^{-m}, -mR^{-m-1}]^T$。\n\n**$\\Delta'$的计算与验证**\n对于每种情况，执行两次积分，一次从区域的每一侧开始，终止于有理面。设来自“负”侧（左侧或内部）的最终状态为 $[\\psi_-, \\psi'_-]^T$，来自“正”侧（右侧或外部）的最终状态为 $[\\psi_+, \\psi'_+]^T$。然后数值稳定性参数计算如下：\n$$\n\\Delta'_{\\text{num}} = \\frac{\\psi'_+}{\\psi_+} - \\frac{\\psi'_-}{\\psi_-}\n$$\n然后将此数值结果与上面推导的相应解析公式进行比较，通过计算相对误差：\n$$\n\\text{error} = \\frac{\\left|\\Delta'_{\\text{num}} - \\Delta'_{\\text{analytic}}\\right|}{\\left|\\Delta'_{\\text{analytic}}\\right|}\n$$\n程序报告这五个指定测试用例的这些误差。使用严格的积分容差（$rtol=10^{-12}$, $atol=10^{-12}$）来最小化数值误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to compute and validate the tearing-mode stability parameter Delta'\n    for a series of test cases in slab and cylindrical geometries.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Structure: (geometry_type, params_dict)\n    test_cases = [\n        ('slab_dirichlet', {'k': 0.7, 'L': 1.0}),\n        ('slab_neumann', {'k': 0.7, 'L': 1.0}),\n        ('slab_dirichlet', {'k': 0.7, 'L': 10.0}),\n        ('cylinder', {'m': 2, 'rs': 0.3, 'R': 4.0}),\n        ('cylinder', {'m': 1, 'rs': 0.5, 'R': 3.0})\n    ]\n\n    def get_analytic_delta_prime(case_type, params):\n        \"\"\"Calculates the analytical Delta' for a given case.\"\"\"\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            if 'dirichlet' in case_type:\n                # Delta' = -2*k*coth(k*L)\n                return -2 * k / np.tanh(k * L)\n            else:  # Neumann\n                # Delta' = -2*k*tanh(k*L)\n                return -2 * k * np.tanh(k * L)\n        elif 'cylinder' in case_type:\n            m, rs = params['m'], params['rs']\n            # Delta' = -2*m/rs\n            # Note: Finite boundaries R and epsilon introduce a small correction,\n            # but for validation against the numerical shooting from the same\n            # boundaries, this asymptotic formula is the target.\n            return -2 * m / rs\n        return None\n\n    def slab_ode(x, y, k):\n        \"\"\"First-order system for the slab geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        d_psi = psi_prime\n        d_psi_prime = k**2 * psi\n        return [d_psi, d_psi_prime]\n\n    def cylinder_ode(r, y, m):\n        \"\"\"First-order system for the cylindrical geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        d_psi = psi_prime\n        d_psi_prime = (m**2 / r**2) * psi - (1 / r) * psi_prime\n        return [d_psi, d_psi_prime]\n\n    def get_numerical_delta_prime(case_type, params):\n        \"\"\"\n        Numerically integrates the outer equations to compute Delta'.\n        High-precision tolerances are used for the ODE solver.\n        \"\"\"\n        rtol, atol = 1e-12, 1e-12\n\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            \n            # Left-side integration: from x=-L to x=0\n            if 'dirichlet' in case_type:\n                y0_left = [0.0, 1.0]\n            else: # Neumann\n                y0_left = [1.0, 0.0]\n            sol_left = solve_ivp(slab_ode, [-L, 0.0], y0_left, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_left.y[:, 0]\n            \n            # Right-side integration: from x=L to x=0\n            if 'dirichlet' in case_type:\n                # We can use y0=[0,1] or y0=[0,-1]. The final log-derivative is independent\n                # of this normalization choice.\n                y0_right = [0.0, 1.0] \n            else: # Neumann\n                y0_right = [1.0, 0.0]\n            sol_right = solve_ivp(slab_ode, [L, 0.0], y0_right, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            psi_plus, psi_prime_plus = sol_right.y[:, 0]\n\n        elif 'cylinder' in case_type:\n            m, rs, R = params['m'], params['rs'], params['R']\n            epsilon = 1e-8\n            \n            # Inner integration: from r=epsilon to r=rs\n            y0_inner = [epsilon**m, m * epsilon**(m-1)]\n            sol_inner = solve_ivp(cylinder_ode, [epsilon, rs], y0_inner, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_inner.y[:, 0]\n            \n            # Outer integration: from r=R to r=rs\n            y0_outer = [R**(-m), -m * R**(-m-1)]\n            sol_outer = solve_ivp(cylinder_ode, [R, rs], y0_outer, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_plus, psi_prime_plus = sol_outer.y[:, 0]\n        \n        else:\n            return None\n\n        # Calculate numerical Delta' using the right-minus-left convention\n        log_deriv_plus = psi_prime_plus / psi_plus\n        log_deriv_minus = psi_prime_minus / psi_minus\n        return log_deriv_plus - log_deriv_minus\n\n    results = []\n    for case_type, params in test_cases:\n        delta_prime_num = get_numerical_delta_prime(case_type, params)\n        delta_prime_analytic = get_analytic_delta_prime(case_type, params)\n        \n        # Calculate relative error\n        error = np.abs(delta_prime_num - delta_prime_analytic) / np.abs(delta_prime_analytic)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}