{
    "hands_on_practices": [
        {
            "introduction": "撕裂模的稳定性由一个关键参数——撕裂模不稳定性指数 $\\Delta'$ 决定。这个动手实践将指导您完成一个基础的解析计算，针对物理上重要的哈里斯片状位形推导 $\\Delta'$ 的表达式 。通过这个练习，您将掌握理解撕裂模不稳定性来源所需的核心理论技能，并了解其如何依赖于等离子体参数。",
            "id": "4039489",
            "problem": "考虑一个二维板状等离子体平衡，其电流片的半厚度为 $a$，磁场反转由 $B_y(x) = B_0 \\tanh(x/a)$ 模型描述，并存在一个均匀的引导场 $B_z$，且等离子体压强可忽略不计。在电阻磁流体力学（MHD）的框架内，可以通过将等离子体分为一个外部理想磁流体力学区域和一个内部电阻层来分析撕裂不稳定性。在外部区域，于临界稳定性（零频率）下，对于形式为 $\\propto \\exp(i k y)$ 的扰动，其扰动磁通函数 $\\psi(x)$ 满足线性化的理想磁流体力学方程\n$$\n\\frac{d^2 \\psi}{dx^2} - k^2 \\psi - \\frac{B_y''(x)}{B_y(x)} \\psi = 0,\n$$\n撕裂不稳定性指数定义为\n$$\n\\Delta' \\equiv \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} - \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-}.\n$$\n从这些基本原理出发，求解给定平衡下的外部区域本征函数 $\\psi(x)$，并计算精确的无量纲指数 $\\Delta' a$ 作为无量纲波数 $k a$ 的函数。然后，取薄片极限 $k a \\ll 1$，并确定 $\\Delta' a$ 对 $k a$ 的主阶渐近依赖关系。解释您的结果对于不同 $k a$ 值下电阻撕裂不稳定性的可及性的物理含义。您的最终答案必须是 $\\Delta' a$ 在 $k a \\ll 1$ 极限下对 $k a$ 的主阶依赖关系的单个闭式解析表达式。",
            "solution": "本题旨在通过解析方法求解哈里斯（Harris）片状位形下的撕裂模不稳定性指数 $\\Delta'$。\n\n### 步骤1：构建外部区域方程\n\n首先，我们需要计算给定磁场平衡 $B_y(x) = B_0 \\tanh(x/a)$ 下的势能项 $B_y''(x)/B_y(x)$。\n$B_y(x)$ 的一阶和二阶导数分别为：\n$$ B_y'(x) = \\frac{B_0}{a} \\text{sech}^2\\left(\\frac{x}{a}\\right) $$\n$$ B_y''(x) = -\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right) $$\n因此，势能项为：\n$$ \\frac{B_y''(x)}{B_y(x)} = \\frac{-\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)}{B_0 \\tanh\\left(\\frac{x}{a}\\right)} = -\\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) $$\n将此结果代入外部区域方程，得到：\n$$ \\frac{d^2 \\psi}{dx^2} - \\left(k^2 - \\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\\right) \\psi = 0 $$\n\n### 步骤2：求解外部区域本征函数\n\n这是一个类薛定谔方程。对于撕裂模，我们寻找在无穷远处消失（$\\psi \\to 0$ 当 $|x| \\to \\infty$）且在原点对称（偶宇称）的解。该方程的已知物理相关解为：\n$$ \\psi(x) = C \\exp(-k|x|) \\left( 1 + \\frac{\\tanh(|x|/a)}{ka} \\right) $$\n其中 $C$ 为任意常数。\n\n### 步骤3：计算不稳定性指数 $\\Delta'$\n\n根据 $\\Delta'$ 的定义，我们需要计算 $\\psi(x)$ 的对数导数在原点 $x=0$ 两侧的跳变。\n\n**对于 $x > 0$（即 $x \\to 0^+$）：**\n$$ \\psi(x) = C e^{-kx} \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) $$\n$$ \\psi'(x) = C \\left[ -k e^{-kx} \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) + e^{-kx} \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right] $$\n在 $x \\to 0^+$ 的极限下，我们有 $\\psi(0^+) = C$ 和 $\\psi'(0^+) = C(-k + 1/(ka^2))$。\n因此，右侧的对数导数为：\n$$ \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} = \\frac{\\psi'(0^+)}{\\psi(0^+)} = \\frac{1}{ka^2} - k $$\n\n**对于 $x  0$（即 $x \\to 0^-$）：**\n由于 $\\psi(x)$ 是偶函数，$\\psi(x)=\\psi(-x)$，其导数 $\\psi'(x)$ 必为奇函数，$\\psi'(x)=-\\psi'(-x)$。因此，$\\psi(0^-) = \\psi(0^+) = C$，而 $\\psi'(0^-) = -\\psi'(0^+) = -C(-k + 1/(ka^2))$。\n左侧的对数导数为：\n$$ \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-} = \\frac{\\psi'(0^-)}{\\psi(0^-)} = k - \\frac{1}{ka^2} $$\n\n将左右两侧的结果代入 $\\Delta'$ 的定义：\n$$ \\Delta' = \\left(\\frac{1}{ka^2} - k\\right) - \\left(k - \\frac{1}{ka^2}\\right) = \\frac{2}{ka^2} - 2k $$\n两边乘以 $a$，得到无量纲指数的精确表达式：\n$$ \\Delta' a = 2 \\left( \\frac{1}{ka} - ka \\right) $$\n\n### 步骤4：分析薄片极限和物理含义\n\n在薄片极限下，即 $ka \\ll 1$（扰动波长远大于电流片厚度），$ka$ 项远小于 $1/(ka)$ 项。因此，$\\Delta' a$ 的主阶渐近依赖关系为：\n$$ \\Delta' a \\approx \\frac{2}{ka} $$\n\n**物理含义：**\n撕裂模在 $\\Delta' > 0$ 时不稳定。我们的精确结果表明，当 $ka  1$ 时 $\\Delta' > 0$。这意味着与电流片厚度相当或更长的波长扰动是不稳定的。在长波极限（$ka \\ll 1$）下，$\\Delta' a$ 变得非常大且为正，表示强烈的驱动力，导致不稳定性快速增长。当 $ka \\to 1$ 时，$\\Delta'$ 趋近于零，不稳定性减弱。当 $ka > 1$（短波扰动）时，$\\Delta'  0$，模式是稳定的，因为弯曲磁力线所需的能量超过了重联释放的能量。",
            "answer": "$$\n\\boxed{\\frac{2}{ka}}\n$$"
        },
        {
            "introduction": "解析解虽然深刻，但仅适用于少数理想化的平衡位形。在实际研究中，我们必须依赖数值方法。这个实践将引导您从纸笔推导过渡到计算机编程，学习如何构建一个数值求解器来计算更普适位形下的 $\\Delta'$ 。这项练习将理论与聚变研究中使用的实用计算工具连接起来，是计算科学家的基本功。",
            "id": "4039453",
            "problem": "你的任务是构建一个数值方法，通过对外部（理想）线性化方程进行积分，并计算在有理面上扰动磁通量的对数导数的跳变，来计算撕裂模不稳定性参数 $\\Delta'$。所有量均为无量纲。\n\n此任务的基础如下：\n- 在电阻磁流体力学（MHD）的外部理想区域中，扰动螺旋磁通函数 $\\,\\psi\\,$ 满足一个二阶线性齐次常微分方程，其形式取决于几何形状和对称性，但不包含电阻率。\n- 撕裂模不稳定性参数由 $\\,\\psi\\,$ 穿过有理面 $\\,r_s\\,$（在平板模型中为 $\\,x=0\\,$）的对数导数的跳变定义，即\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^-} - \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^+}.\n$$\n该定义消除了对 $\\,\\psi\\,$ 的任意归一化的依赖。\n\n你必须构建一个程序，该程序能够：\n1. 从 $\\,r_s\\,$ 的两侧对外部理想方程进行数值积分，以使用上述定义计算 $\\,\\Delta'\\,$。\n2. 通过为每种情况计算解析 $\\,\\Delta'\\,$ 并测量其差异，来对照解析情况验证数值结果。\n\n对于此问题，考虑两种几何构型及其理想外部方程：\n- 具有波数 $\\,k\\,$ 的平板几何：\n  - 对于 $\\,x\\neq 0\\,$ 的外部理想方程：\n    $$\\frac{d^2\\psi}{dx^2} - k^2 \\psi = 0.$$\n  - 边界条件在 $\\,x=\\pm L\\,$ 处指定，可以是狄利克雷（Dirichlet）边界条件（$\\,\\psi(\\pm L) = 0\\,$）或诺伊曼（Neumann）边界条件（$\\,d\\psi/dx|_{x=\\pm L}=0$）。有理面位于 $\\,x=0\\,$。\n\n- 具有角向模数 $\\,m\\ge 1\\,$ 的圆柱几何：\n  - 对于 $\\,r\\neq r_s\\,$ 的外部理想方程：\n    $$\n    \\frac{d}{dr}\\left(r \\frac{d\\psi}{dr}\\right) - \\frac{m^2}{r}\\,\\psi = 0,\n    $$\n    或等价地\n    $$\n    \\psi''(r) = \\frac{m^2}{r^2}\\psi(r) - \\frac{1}{r}\\psi'(r).\n    $$\n  - 边界条件为轴上的正则性（当 $\\,r\\to 0\\,$ 时，$\\,\\psi \\sim r^m\\,$）和在大半径处的类真空衰减（当 $\\,r\\to \\infty\\,$ 时，$\\,\\psi \\sim r^{-m}\\,$）。有理面位于 $\\,r=r_s\\,$。在实践中，你必须从一个大但有限的外半径 $\\,R\\,$ 向内积分，并从满足 $\\,0\\epsilon\\ll r_s\\,$ 的一个小但非零的内半径 $\\,\\epsilon\\,$ 向外积分。\n\n测试套件：\n- 你必须为以下五种情况计算数值 $\\,\\Delta'\\,$ 并将其与解析解进行比较：\n  1. 平板，狄利克雷边界条件，$\\,k=0.7,\\, L=1.0\\,$\n  2. 平板，诺伊曼边界条件，$\\,k=0.7,\\, L=1.0\\,$\n  3. 平板，狄利克雷边界条件，$\\,k=0.7,\\, L=10.0\\,$\n  4. 圆柱，$\\,m=2,\\, r_s=0.3,\\, R=4.0\\,$\n  5. 圆柱，$\\,m=1,\\, r_s=0.5,\\, R=3.0\\,$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的五个相对误差值的列表，定义为 $|\\Delta'_{\\text{num}} - \\Delta'_{\\text{analytic}}| / |\\Delta'_{\\text{analytic}}|$，每个值对应于上述测试用例。",
            "solution": "本任务要求构建一个数值求解器来计算撕裂模不稳定性参数 $\\Delta'$，并通过与已知解析解的比较来验证其准确性。该方法包括从区域边界向有理面进行数值积分（即“打靶法”）。\n\n### 1. 解析解推导（用于验证）\n\n我们首先为问题中给出的测试用例推导 $\\Delta'$ 的精确解析表达式。根据问题定义：\n$$ \\Delta' \\equiv \\frac{\\psi'(r_s^-)}{\\psi(r_s^-)} - \\frac{\\psi'(r_s^+)}{\\psi(r_s^+)} $$\n其中，解 $\\psi^-$ 和 $\\psi^+$ 分别对应于区域 $r  r_s$（左侧/内部）和 $r  r_s$（右侧/外部）。\n\n#### 平板几何\n外部方程为 $\\psi'' - k^2\\psi = 0$，其通解为 $\\psi(x) = A\\cosh(kx) + B\\sinh(kx)$。有理面位于 $x=0$。\n\n1.  **狄利克雷边界条件 ($\\psi(\\pm L) = 0$):**\n    *   左侧解 ($x \\in [-L, 0]$)：满足 $\\psi(-L)=0$ 的解为 $\\psi^-(x) = C_1 \\sinh(k(x+L))$。其对数导数在 $x \\to 0^-$ 时为 $k \\coth(kL)$。\n    *   右侧解 ($x \\in [0, L]$)：满足 $\\psi(L)=0$ 的解为 $\\psi^+(x) = C_2 \\sinh(k(x-L))$。其对数导数在 $x \\to 0^+$ 时为 $k \\coth(-kL) = -k \\coth(kL)$。\n    *   因此, $\\Delta' = (k \\coth(kL)) - (-k \\coth(kL)) = 2k \\coth(kL)$。\n\n2.  **诺伊曼边界条件 ($\\psi'(\\pm L) = 0$):**\n    *   左侧解：满足 $\\psi'(-L)=0$ 的解为 $\\psi^-(x) = C_1 \\cosh(k(x+L))$。其对数导数在 $x \\to 0^-$ 时为 $k \\tanh(kL)$。\n    *   右侧解：满足 $\\psi'(L)=0$ 的解为 $\\psi^+(x) = C_2 \\cosh(k(x-L))$。其对数导数在 $x \\to 0^+$ 时为 $k \\tanh(-kL) = -k \\tanh(kL)$。\n    *   因此, $\\Delta' = (k \\tanh(kL)) - (-k \\tanh(kL)) = 2k \\tanh(kL)$。\n\n#### 圆柱几何\n外部方程为 $r^2\\psi'' + r\\psi' - m^2\\psi = 0$（柯西-欧拉方程），其通解为 $\\psi(r) = Ar^m + Br^{-m}$。\n\n*   内部解 ($r  r_s$)：为保证在 $r=0$ 处解是正则的，必须有 $B=0$，因此 $\\psi^-(r) = Ar^m$。其对数导数为 $m/r$，在 $r \\to r_s^-$ 时为 $m/r_s$。\n*   外部解 ($r  r_s$)：为保证在 $r \\to \\infty$ 处解衰减为零，必须有 $A=0$，因此 $\\psi^+(r) = Br^{-m}$。其对数导数为 $-m/r$，在 $r \\to r_s^+$ 时为 $-m/r_s$。\n*   因此, $\\Delta' = (m/r_s) - (-m/r_s) = 2m/r_s$。此解析解假设边界在 $r=0$ 和 $r=\\infty$。\n\n### 2. 数值方法\n\n为求解二阶常微分方程，我们将其转化为一阶常微分方程组。定义状态向量 $\\mathbf{y}(t) = [\\psi(t), \\psi'(t)]^T$，则方程组可写为 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$。\n\n*   **平板系统 ($\\psi'' = k^2\\psi$):**\n    $$ \\frac{d}{dx} \\begin{pmatrix} \\psi \\\\ \\psi' \\end{pmatrix} = \\begin{pmatrix} \\psi' \\\\ k^2 \\psi \\end{pmatrix} $$\n    我们从 $x = \\pm L$ 向 $x=0$ 积分。\n    *   左侧积分 (从 $-L$ 到 $0$)：狄利克雷边界条件的初始值为 $\\mathbf{y}(-L) = [0, 1]^T$；诺伊曼为 $\\mathbf{y}(-L) = [1, 0]^T$。\n    *   右侧积分 (从 $L$ 到 $0$)：狄利克雷边界条件的初始值为 $\\mathbf{y}(L) = [0, -1]^T$；诺伊曼为 $\\mathbf{y}(L) = [1, 0]^T$。（导数的符号选择是为了确保解函数本身为正）。\n\n*   **圆柱系统 ($\\psi'' = \\frac{m^2}{r^2}\\psi - \\frac{1}{r}\\psi'$):**\n    $$ \\frac{d}{dr} \\begin{pmatrix} \\psi \\\\ \\psi' \\end{pmatrix} = \\begin{pmatrix} \\psi' \\\\ \\frac{m^2}{r^2}\\psi - \\frac{1}{r}\\psi' \\end{pmatrix} $$\n    *   内部积分 (从 $\\epsilon$ 到 $r_s$)：基于 $\\psi \\sim r^m$ 的渐近行为，初始条件为 $\\mathbf{y}(\\epsilon) = [\\epsilon^m, m\\epsilon^{m-1}]^T$。\n    *   外部积分 (从 $R$ 到 $r_s$)：基于 $\\psi \\sim r^{-m}$ 的渐近行为，初始条件为 $\\mathbf{y}(R) = [R^{-m}, -mR^{-m-1}]^T$。\n\n### 3. $\\Delta'$ 的计算与验证\n\n对于每种情况，我们执行两次积分（一次从左/内边界，一次从右/外边界），终止于有理面。得到积分终点的状态向量 $[\\psi^-, \\psi'^-]^T$ 和 $[\\psi^+, \\psi'^+]^T$ 后，数值 $\\Delta'$ 计算如下：\n$$ \\Delta'_{\\text{num}} = \\frac{\\psi'^-}{\\psi^-} - \\frac{\\psi'^+}{\\psi^+} $$\n最终，将此数值结果与相应的解析公式进行比较，计算相对误差。程序使用高精度的常微分方程求解器以保证数值积分的准确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to compute and validate the tearing-mode stability parameter Delta'\n    for a series of test cases in slab and cylindrical geometries.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Structure: (geometry_type, params_dict)\n    test_cases = [\n        ('slab_dirichlet', {'k': 0.7, 'L': 1.0}),\n        ('slab_neumann', {'k': 0.7, 'L': 1.0}),\n        ('slab_dirichlet', {'k': 0.7, 'L': 10.0}),\n        ('cylinder', {'m': 2, 'rs': 0.3, 'R': 4.0}),\n        ('cylinder', {'m': 1, 'rs': 0.5, 'R': 3.0})\n    ]\n\n    def get_analytic_delta_prime(case_type, params):\n        \"\"\"Calculates the analytical Delta' for a given case.\"\"\"\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            if 'dirichlet' in case_type:\n                # Delta' = 2*k*coth(k*L)\n                return 2 * k / np.tanh(k * L)\n            else:  # Neumann\n                # Delta' = 2*k*tanh(k*L)\n                return 2 * k * np.tanh(k * L)\n        elif 'cylinder' in case_type:\n            m, rs = params['m'], params['rs']\n            # Delta' = 2*m/rs, this is for R->inf, epsilon->0. \n            # The numerical calculation with finite R, epsilon will have a small discrepancy.\n            return 2 * m / rs\n        return None\n\n    def slab_ode(x, y, k):\n        \"\"\"First-order system for the slab geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        d_psi = psi_prime\n        d_psi_prime = k**2 * psi\n        return [d_psi, d_psi_prime]\n\n    def cylinder_ode(r, y, m):\n        \"\"\"First-order system for the cylindrical geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        if r == 0:\n            return [psi_prime, 0.0]\n        d_psi = psi_prime\n        d_psi_prime = (m**2 / r**2) * psi - (1 / r) * psi_prime\n        return [d_psi, d_psi_prime]\n\n    def get_numerical_delta_prime(case_type, params):\n        \"\"\"\n        Numerically integrates the outer equations to compute Delta'.\n        High-precision tolerances are used for the ODE solver.\n        \"\"\"\n        rtol, atol = 1e-12, 1e-12\n\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            \n            # Left-side integration: from x=-L to x=0\n            if 'dirichlet' in case_type:\n                y0_left = [0.0, 1.0]\n            else: # Neumann\n                y0_left = [1.0, 0.0]\n            sol_left = solve_ivp(slab_ode, [-L, 0.0], y0_left, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_left.y[:, 0]\n            \n            # Right-side integration: from x=L to x=0\n            if 'dirichlet' in case_type:\n                y0_right = [0.0, -1.0]\n            else: # Neumann\n                y0_right = [1.0, 0.0]\n            sol_right = solve_ivp(slab_ode, [L, 0.0], y0_right, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            psi_plus, psi_prime_plus = sol_right.y[:, 0]\n\n        elif 'cylinder' in case_type:\n            m, rs, R = params['m'], params['rs'], params['R']\n            epsilon = 1e-8\n            \n            # Inner integration: from r=epsilon to r=rs\n            y0_inner = [epsilon**m, m * epsilon**(m-1)]\n            sol_inner = solve_ivp(cylinder_ode, [epsilon, rs], y0_inner, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_inner.y[:, 0]\n            \n            # Outer integration: from r=R to r=rs\n            y0_outer = [R**(-m), -m * R**(-m-1)]\n            sol_outer = solve_ivp(cylinder_ode, [R, rs], y0_outer, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_plus, psi_prime_plus = sol_outer.y[:, 0]\n        \n        else:\n            return None\n\n        # Calculate numerical Delta' according to the problem's definition\n        log_deriv_minus = psi_prime_minus / psi_minus\n        log_deriv_plus = psi_prime_plus / psi_plus\n        return log_deriv_minus - log_deriv_plus\n\n    results = []\n    for case_type, params in test_cases:\n        delta_prime_num = get_numerical_delta_prime(case_type, params)\n        delta_prime_analytic = get_analytic_delta_prime(case_type, params)\n        \n        # Calculate relative error\n        error = np.abs(delta_prime_num - delta_prime_analytic) / np.abs(delta_prime_analytic)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "科学计算的最后一步通常是验证与确认（Verification and Validation, VV）。本练习将结合您对 $\\Delta'$ 的知识，应用经典的 FKR 色散关系来预测撕裂模的增长率 $\\gamma$ 。您将构建一个基准测试程序，用于检验“计算”出的增长率是否符合理论预测，这是开发可靠模拟代码的一项关键技能。",
            "id": "4039510",
            "problem": "您的任务是为电阻磁流体动力学（MHD）中的线性电阻撕裂模增长率建立一个验证基准，将计算值与跨越多个伦奎斯特数和扰动波数的解析性Furth–Killeen–Rosenbluth (FKR) 标度律进行比较。该基准必须自洽，从第一性原理出发，并以纯数学术语和明确的单位表示。\n\n基本依据与设置：\n- 考虑一个对称的平板电流层，其平衡磁场由 $B_y(x) = B_0 \\tanh(x/a)$ 给出，且没有平衡流。设 $a$ 表示电流层的半厚度（在此基准中也用作撕裂模归一化的宏观长度 $L$）。\n- 假设不可压缩电阻磁流体动力学（MHD），使用围绕平衡态线性化的感应方程和动量方程，以及适用于经典FKR机制的常数-$\\psi$近似。小振幅扰动随 $\\exp(i k y + \\gamma t)$ 变化，其中 $k$ 为实波数，$\\gamma$ 为实增长率。\n- 定义阿尔芬速度 $V_A = B_0/\\sqrt{\\mu_0 \\rho}$，阿尔芬时间 $\\tau_A = L/V_A$，电阻磁扩散率 $\\eta$，电阻扩散时间 $\\tau_R = \\mu_0 L^2/\\eta$，以及伦奎斯特数 $S = \\tau_R/\\tau_A = \\mu_0 L V_A/\\eta$。\n- 在外部理想区域，撕裂不稳定性参数 $\\Delta'$ 必须通过求解与 $B_y(x) = B_0 \\tanh(x/a)$ 一致的线性化理想MHD外部方程，并在 $x=0$ 处的共振面上进行匹配来获得。在 $\\Delta'  0$ 的机制下工作，以便撕裂模是不稳定的。\n\n目标：\n- 推导增长率 $\\gamma$ 关于 $V_A$、$L$、$S$、$k$ 和 $\\Delta'$ 的解析FKR标度律，并用物理上一致的单位表示。在此基准中，您必须以 $\\mathrm{s}^{-1}$ 为单位计算 $\\gamma$。\n- 实现一个函数，在给定 $B_0$、$\\rho$、$a$、$S$ 和 $k$ 的情况下，计算 $\\gamma$ 的解析FKR预测值。使用 $L=a$ 进行归一化。使用与哈里斯片平衡相对应的外部区域 $\\Delta'$。\n- 将解析预测与一组报告（计算）的增长率进行比较。比较必须使用相对误差度量 $\\varepsilon_{\\text{rel}} = |\\gamma_{\\text{reported}} - \\gamma_{\\text{analytic}}|/\\gamma_{\\text{analytic}}$ 和案例特定的接受容差 $\\varepsilon_{\\text{tol}}$。如果 $\\varepsilon_{\\text{rel}} \\le \\varepsilon_{\\text{tol}}$，则该案例被接受。\n\n物理常数和单位：\n- 使用 $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$，$B_0 = 3.0\\ \\mathrm{T}$，$\\rho = 1.67\\times 10^{-7}\\ \\mathrm{kg/m^3}$，以及 $a=L=0.02\\ \\mathrm{m}$。\n- 所有波数 $k$ 均以 $\\mathrm{m}^{-1}$ 为单位指定。\n- 所有增长率 $\\gamma$ 必须以 $\\mathrm{s}^{-1}$ 为单位进行计算和比较。\n\n测试套件：\n对于每个案例，参数为 $(S, k, \\varepsilon_{\\text{tol}}, f)$，其中 $f$ 是一个乘性偏差因子，使得报告的增长率为 $\\gamma_{\\text{reported}} = f \\cdot \\gamma_{\\text{analytic}}$。这些案例涵盖了理想路径、一个近阈值的 $\\Delta'0$ 案例和一个高$S$值的边缘案例。\n- 案例1（理想路径）：$(S = 10^6,\\, k = 10\\ \\mathrm{m}^{-1},\\, \\varepsilon_{\\text{tol}} = 0.10,\\, f = 1.08)$。\n- 案例2（中等$S$，中等$k$）：$(S = 10^7,\\, k = 15\\ \\mathrm{m}^{-1},\\, \\varepsilon_{\\text{tol}} = 0.15,\\, f = 1.12)$。\n- 案例3（近阈值 $\\Delta'0$ 且 $k a = 0.9$）：$(S = 5\\times 10^6,\\, k = 45\\ \\mathrm{m}^{-1},\\, \\varepsilon_{\\text{tol}} = 0.20,\\, f = 1.17)$。\n- 案例4（高$S$，小$k$边缘案例）：$(S = 5\\times 10^7,\\, k = 8\\ \\mathrm{m}^{-1},\\, \\varepsilon_{\\text{tol}} = 0.20,\\, f = 1.25)$。\n\n接受逻辑：\n- 对每个案例，以 $\\mathrm{s}^{-1}$ 为单位计算 $\\gamma_{\\text{analytic}}$，构成 $\\gamma_{\\text{reported}} = f \\cdot \\gamma_{\\text{analytic}}$，计算 $\\varepsilon_{\\text{rel}} = |\\gamma_{\\text{reported}} - \\gamma_{\\text{analytic}}|/\\gamma_{\\text{analytic}}$，并返回一个布尔值，指示是否 $\\varepsilon_{\\text{rel}} \\le \\varepsilon_{\\text{tol}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的布尔值列表，例如 $[\\text{True},\\text{False},\\text{True},\\dots]$。",
            "solution": "本任务要求为电阻撕裂模的线性增长率建立一个验证基准。核心在于将经典的Furth–Killeen–Rosenbluth (FKR) 理论的解析预测与一组给定的“报告”值进行比较。\n\n### 步骤1：推导解析增长率 `γ_analytic`\n\n该推导基于经典的FKR撕裂模理论，该理论将外部理想区域的解与内部电阻层的解相匹配。\n\n1.  **不稳定性参数 `Δ'`**：\n    对于哈里斯片平衡 $B_y(x) = B_0 \\tanh(x/a)$，无量纲不稳定性参数由前一个练习可知为：\n    $$ \\Delta' a = 2\\left(\\frac{1}{ka} - ka\\right) $$\n    其中 $k$ 是波数，$a$ 是电流片半厚度。撕裂模不稳定性要求 $\\Delta' > 0$，即 $ka  1$。\n\n2.  **FKR 色散关系**：\n    经典的FKR理论给出了连接外部驱动（通过 $\\Delta'$）和内部层物理（通过增长率 $\\gamma$、伦奎斯特数 $S$ 和波数 $k$）的色散关系。一种标准形式是：\n    $$ \\Delta' a = C_0 (\\gamma \\tau_A)^{5/4} S^{3/4} (ka)^{-1/2} $$\n    其中，$\\tau_A = a/V_A$ 是阿尔芬时间，$V_A = B_0/\\sqrt{\\mu_0 \\rho}$ 是阿尔芬速度，$S$ 是伦奎斯特数。常数 $C_0 = \\frac{1}{2} \\frac{\\Gamma(1/4)}{\\Gamma(3/4)}$，其中 $\\Gamma$ 是欧拉伽马函数。\n\n3.  **求解增长率 `γ`**：\n    我们可以从色散关系中代数求解出增长率 $\\gamma$。首先，整理出归一化增长率项：\n    $$ (\\gamma \\tau_A)^{5/4} = \\frac{\\Delta' a}{C_0} S^{-3/4} (ka)^{1/2} $$\n    然后，两边取 $4/5$ 次幂：\n    $$ \\gamma \\tau_A = \\left( \\frac{\\Delta' a}{C_0} \\right)^{4/5} S^{-3/5} (ka)^{2/5} $$\n    最后，得到以 $\\mathrm{s}^{-1}$ 为单位的解析增长率表达式：\n    $$ \\gamma_{\\text{analytic}} = \\frac{1}{\\tau_A} \\left( \\frac{\\Delta' a}{C_0} \\right)^{4/5} S^{-3/5} (ka)^{2/5} $$\n    将 $\\Delta' a$ 的表达式代入，即可得到完全由基本参数表示的 $\\gamma_{\\text{analytic}}$。\n\n### 步骤2：验证算法\n\n对于每个给定的测试案例 $(S, k, \\varepsilon_{\\text{tol}}, f)$，验证过程如下：\n\n1.  **计算基本参数**：使用给定的物理常数（$\\mu_0, B_0, \\rho, a$）计算阿尔芬速度 $V_A$ 和FKR常数 $C_0$。\n2.  **计算 `γ_analytic`**：\n    a. 计算无量纲波数 $ka$。\n    b. 若 $ka \\ge 1$，则模式稳定，$\\gamma_{\\text{analytic}} = 0$。\n    c. 若 $ka  1$，计算 $\\Delta' a = 2(1/ka - ka)$。\n    d. 使用上述公式计算 $\\gamma_{\\text{analytic}}$。\n3.  **计算相对误差**：\n    “报告”的增长率为 $\\gamma_{\\text{reported}} = f \\cdot \\gamma_{\\text{analytic}}$。\n    相对误差为 $\\varepsilon_{\\text{rel}} = \\frac{|\\gamma_{\\text{reported}} - \\gamma_{\\text{analytic}}|}{|\\gamma_{\\text{analytic}}|} = \\frac{|f \\cdot \\gamma_{\\text{analytic}} - \\gamma_{\\text{analytic}}|}{|\\gamma_{\\text{analytic}}|} = |f - 1|$。\n4.  **比较与判断**：\n    将计算出的相对误差 $\\varepsilon_{\\text{rel}}$ 与该案例的容差 $\\varepsilon_{\\text{tol}}$ 进行比较。如果 $\\varepsilon_{\\text{rel}} \\le \\varepsilon_{\\text{tol}}$，则该案例通过验证（结果为 True），否则不通过（结果为 False）。\n\n此算法为所有测试用例提供了一个确定性的、可重复的验证结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gamma\n\ndef solve():\n    \"\"\"\n    Computes the analytic FKR tearing mode growth rate and verifies it against\n    synthetic 'reported' values for a series of test cases.\n    \"\"\"\n    # Physical constants and base parameters\n    MU0 = 4 * np.pi * 1e-7  # Permeability of free space (H/m)\n    B0 = 3.0                 # Magnetic field strength (T)\n    RHO = 1.67e-7            # Mass density (kg/m^3)\n    A = 0.02                 # Current sheet half-thickness (m), also system size L\n    \n    # Test suite from the problem statement\n    # Each case is a tuple: (S, k, eps_tol, f)\n    # S: Lundquist number\n    # k: Wavenumber (m^-1)\n    # eps_tol: Relative error tolerance\n    # f: Multiplicative deviation factor for reported gamma\n    test_cases = [\n        (1e6, 10.0, 0.10, 1.08),  # Case 1\n        (1e7, 15.0, 0.15, 1.12),  # Case 2\n        (5e6, 45.0, 0.20, 1.17),  # Case 3\n        (5e7, 8.0, 0.20, 1.25),   # Case 4\n    ]\n\n    # Derived fundamental parameters\n    # Alfvén speed\n    v_A = B0 / np.sqrt(MU0 * RHO)\n    # Alfvén time\n    tau_A = A / v_A\n    # FKR constant from the inner layer analysis\n    C0 = 0.5 * gamma(0.25) / gamma(0.75)\n\n    def calculate_analytic_gamma(S, k):\n        \"\"\"\n        Calculates the analytic FKR growth rate gamma in s^-1.\n        \n        Args:\n            S (float): Lundquist number\n            k (float): Perturbation wavenumber in m^-1\n\n        Returns:\n            float: Analytic growth rate gamma_analytic in s^-1\n        \"\"\"\n        # Dimensionless wavenumber\n        ka = k * A\n        \n        # The mode is unstable only if ka  1\n        if ka >= 1.0:\n            return 0.0\n\n        # Dimensionless tearing stability parameter for the Harris sheet\n        delta_prime_a = 2.0 * (1.0/ka - ka)\n\n        # Dimensionless growth rate (gamma * tau_A) from the FKR dispersion relation\n        # gamma_norm = ( (delta_prime_a / C0)^(4/5) * S^(-3/5) * ka^(2/5) )\n        term1 = (delta_prime_a / C0)**(4.0 / 5.0)\n        term2 = S**(-3.0 / 5.0)\n        term3 = ka**(2.0 / 5.0)\n        gamma_norm = term1 * term2 * term3\n        \n        # Dimensional growth rate in s^-1\n        gamma_analytic = gamma_norm / tau_A\n\n        return gamma_analytic\n\n    results = []\n    for case in test_cases:\n        S, k, eps_tol, f = case\n\n        # The problem defines gamma_reported = f * gamma_analytic, which simplifies\n        # the relative error calculation significantly.\n        # rel_error = |gamma_reported - gamma_analytic| / |gamma_analytic|\n        #           = |f * gamma_analytic - gamma_analytic| / |gamma_analytic|\n        #           = |f - 1|\n        rel_error = np.abs(f - 1.0)\n\n        # Check if the relative error is within the tolerance\n        is_accepted = rel_error = eps_tol\n        results.append(is_accepted)\n\n    # Format the final output as specified\n    result_str = \",\".join(map(str, results))\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        }
    ]
}