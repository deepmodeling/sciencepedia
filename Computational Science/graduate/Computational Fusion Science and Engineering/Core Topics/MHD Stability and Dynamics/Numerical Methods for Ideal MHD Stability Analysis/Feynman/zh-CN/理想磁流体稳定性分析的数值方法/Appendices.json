{
    "hands_on_practices": [
        {
            "introduction": "该练习演示了如何将连续的理想磁流体动力学（MHD）能量原理转化为离散的广义特征值问题。通过将等离子体位移投影到简化板坯几何中的单个基函数上，您将手动计算刚度矩阵（$A$）和质量矩阵（$B$）的元素，从而揭示物理力与问题数学结构之间的直接联系。",
            "id": "4022879",
            "problem": "考虑理想磁流体力学（MHD）中静态平衡的线性稳定性问题。研究对象为 $x$ 方向上厚度为 $L$ 的板状等离子体，其具有均匀磁场 $\\mathbf{B}_{0} = B_{0} \\hat{z}$、恒定质量密度 $\\rho_{0}$ 以及平衡压强 $p_{0}(x) = p_{a} + \\alpha x$，且对于 $x \\in [0,L]$ 满足 $p_{0}(x) > 0$。等离子体在 $x=0$ 和 $x=L$ 处由理想导电、磁力线固定的壁所限制，使得法向位移满足 $\\xi_{x}(0) = \\xi_{x}(L) = 0$。假设在 $z$ 方向上具有周期性，并由单一傅里叶谐波 $\\exp(i k_{z} z)$ 描述，且在 $y$ 方向上没有变化。\n\n从线性化的理想磁流体力学方程和小扰动的能量原理出发，为简正模位移 $\\boldsymbol{\\xi}$ 构建自伴广义特征值问题，其弱（变分）形式为 $\\mathbf{A} \\mathbf{c} = \\omega^{2} \\mathbf{B} \\mathbf{c}$。其中，$\\omega$ 是模频率，$\\mathbf{A}$ 是由磁力和压强力产生的刚度算符，$\\mathbf{B}$ 是质量算符，$\\mathbf{c}$ 是在为 $\\boldsymbol{\\xi}$ 选择的基中的系数。将位移限制为单一基函数形式\n$$\n\\boldsymbol{\\xi}(x,z) = c_{1} \\, \\phi_{1}(x) \\, \\hat{x} \\, \\exp(i k_{z} z), \\quad \\phi_{1}(x) = \\sqrt{\\frac{2}{L}} \\sin\\!\\left(\\frac{\\pi x}{L}\\right),\n$$\n该函数满足磁力线固定的边界条件。通过计算在 $x \\in [0,L]$ 和一个 $z$ 方向周期上的适当体积分，构建离散算符 $\\mathbf{A}$ 和 $\\mathbf{B}$ 的标量元 $A_{11}$ 和 $B_{11}$；你可以将任何横向截面积因子保留为符号形式，并且必须将所有参数，包括 $B_{0}$、$\\mu_{0}$、$\\gamma$、$p_{a}$、$\\alpha$、$L$、$k_{z}$ 和 $\\rho_{0}$，保留为符号形式。使用这些显式构建的矩阵元，计算所得的单自由度广义特征值\n$$\n\\omega^{2} = \\frac{A_{11}}{B_{11}},\n$$\n的封闭解析表达式。将最终答案表示为单个解析表达式。不需要进行数值代入，也不允许四舍五入。",
            "solution": "该问题陈述已经过严格验证，被认为是科学可靠、适定、客观且自洽的。所提供的平衡和扰动形式是理想磁流体力学（MHD）稳定性分析中一个典型教学问题的标准形式。任务是通过将系统动力学投影到单个给定的基函数上，来评估广义特征值 $\\omega^2$，这是 Rayleigh-Ritz 变分法的一个标准应用。\n\n出发点是由线性化理想磁流体力学方程导出的、以弱（变分）形式表示的广义特征值问题。对于一个扰动 $\\boldsymbol{\\xi}$，其运动方程为 $\\rho_0 \\frac{\\partial^2 \\boldsymbol{\\xi}}{\\partial t^2} = \\mathbf{F}(\\boldsymbol{\\xi})$，其中 $\\mathbf{F}(\\boldsymbol{\\xi})$ 是线性力算符。假设时间依赖性为谐波形式 $\\boldsymbol{\\xi} \\sim \\exp(-i\\omega t)$，则方程变为 $-\\omega^2 \\rho_0 \\boldsymbol{\\xi} = \\mathbf{F}(\\boldsymbol{\\xi})$。\n\n弱形式由能量原理得到。势能泛函 $\\delta W$ 和动能泛函 $K$ 分别由以下公式给出：\n$$ \\delta W(\\boldsymbol{\\xi}) = -\\frac{1}{2}\\int \\boldsymbol{\\xi}^* \\cdot \\mathbf{F}(\\boldsymbol{\\xi}) \\, dV $$\n$$ K(\\boldsymbol{\\xi}) = \\frac{1}{2}\\int \\rho_0 |\\boldsymbol{\\xi}|^2 \\, dV $$\n特征值 $\\omega^2$ 是 Rayleigh 商 $\\omega^2 = \\delta W / K$ 的稳定值。对于问题中定义的静态平衡，其平衡电流密度 $\\mathbf{J}_0 = \\frac{1}{\\mu_0}\\nabla \\times \\mathbf{B}_0 = 0$，势能泛函简化为：\n$$ \\delta W = \\frac{1}{2} \\int \\left[ \\frac{|\\mathbf{Q}|^2}{\\mu_0} + \\gamma p_0 |\\nabla \\cdot \\boldsymbol{\\xi}|^2 + (\\nabla \\cdot \\boldsymbol{\\xi}^*)(\\boldsymbol{\\xi} \\cdot \\nabla p_0) \\right] \\, dV $$\n其中 $\\mathbf{Q} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0)$。\n\n问题将位移矢量限制为单个基函数 $\\boldsymbol{\\xi}_1$：\n$$ \\boldsymbol{\\xi}(x,z,t) = c_1 \\boldsymbol{\\xi}_1(x,z) \\exp(-i\\omega t) \\quad \\text{with} \\quad \\boldsymbol{\\xi}_1(x,z) = \\phi_{1}(x) \\, \\hat{x} \\, \\exp(i k_{z} z) $$\n其中 $\\phi_1(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{\\pi x}{L}\\right)$。该基函数满足边界条件 $\\xi_x(0) = \\xi_x(L) = 0$。\n\n将此代入能量原理得到 $\\omega^2 |c_1|^2 K(\\boldsymbol{\\xi}_1) = |c_1|^2 \\delta W(\\boldsymbol{\\xi}_1)$。广义特征值问题 $\\mathbf{A} \\mathbf{c} = \\omega^{2} \\mathbf{B} \\mathbf{c}$ 简化为一个标量方程 $A_{11} c_1 = \\omega^2 B_{11} c_1$，其中：\n$$ A_{11} = 2 \\delta W(\\boldsymbol{\\xi}_1) = \\int \\left[ \\frac{|\\mathbf{Q}_1|^2}{\\mu_0} + \\gamma p_0 |\\nabla \\cdot \\boldsymbol{\\xi}_1|^2 + (\\nabla \\cdot \\boldsymbol{\\xi}_1^*)(\\boldsymbol{\\xi}_1 \\cdot \\nabla p_0) \\right] \\, dV $$\n$$ B_{11} = 2 K(\\boldsymbol{\\xi}_1) = \\int \\rho_0 |\\boldsymbol{\\xi}_1|^2 \\, dV $$\n体积分的范围是域 $x \\in [0,L]$ 以及横向上的一个周期。设 $y-z$ 平面内的横截面积为 $A_{\\perp}$。\n\n首先，我们计算质量矩阵元 $B_{11}$：\n$$ \\boldsymbol{\\xi}_1 = \\phi_1(x) \\exp(ik_z z) \\hat{x} \\implies |\\boldsymbol{\\xi}_1|^2 = \\phi_1(x)^2 $$\n$$ B_{11} = \\int \\rho_0 \\phi_1(x)^2 \\, dV = \\rho_0 A_{\\perp} \\int_0^L \\phi_1(x)^2 \\, dx $$\n基函数被归一化，使得 $\\int_0^L \\phi_1(x)^2 \\, dx = \\int_0^L \\frac{2}{L} \\sin^2\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{2}{L} \\frac{L}{2} = 1$。\n$$ B_{11} = \\rho_0 A_{\\perp} $$\n\n接下来，我们通过计算其三个组成项来计算刚度矩阵元 $A_{11}$。\n\n第一项：磁场扰动能。\n$\\mathbf{B}_0 = B_0 \\hat{z}$ 且 $\\boldsymbol{\\xi}_1 = \\phi_1(x) \\exp(ik_z z) \\hat{x}$。\n$$ \\boldsymbol{\\xi}_1 \\times \\mathbf{B}_0 = -B_0 \\phi_1(x) \\exp(ik_z z) \\hat{y} $$\n$$ \\mathbf{Q}_1 = \\nabla \\times (\\boldsymbol{\\xi}_1 \\times \\mathbf{B}_0) = -B_0 \\left[ \\frac{\\partial}{\\partial z}(\\phi_1 e^{ik_z z}) \\hat{x} - \\frac{\\partial}{\\partial x}(\\phi_1 e^{ik_z z}) \\hat{z} \\right] = -B_0 e^{ik_z z} \\left( i k_z \\phi_1(x) \\hat{x} - \\phi_1'(x) \\hat{z} \\right) $$\n其中 $\\phi_1'(x) = d\\phi_1/dx$。\n$$ |\\mathbf{Q}_1|^2 = B_0^2 \\left( k_z^2 \\phi_1(x)^2 + [\\phi_1'(x)]^2 \\right) $$\n此项的积分为：\n$$ \\int \\frac{|\\mathbf{Q}_1|^2}{\\mu_0} dV = \\frac{A_{\\perp} B_0^2}{\\mu_0} \\int_0^L \\left( k_z^2 \\phi_1(x)^2 + [\\phi_1'(x)]^2 \\right) dx $$\n我们需要 $[\\phi_1'(x)]^2$ 的积分：\n$$ \\phi_1'(x) = \\sqrt{\\frac{2}{L}} \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) $$\n$$ \\int_0^L [\\phi_1'(x)]^2 dx = \\frac{2\\pi^2}{L^3} \\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{2\\pi^2}{L^3} \\frac{L}{2} = \\frac{\\pi^2}{L^2} $$\n使用 $\\int_0^L \\phi_1(x)^2 dx = 1$，$A_{11}$ 的第一项是：\n$$ A_{11}^{(1)} = \\frac{A_{\\perp} B_0^2}{\\mu_0} \\left( k_z^2 \\cdot 1 + \\frac{\\pi^2}{L^2} \\right) $$\n\n第二项：等离子体压缩能。\n$$ \\nabla \\cdot \\boldsymbol{\\xi}_1 = \\frac{\\partial \\xi_{1,x}}{\\partial x} = \\phi_1'(x) \\exp(ik_z z) \\implies |\\nabla \\cdot \\boldsymbol{\\xi}_1|^2 = [\\phi_1'(x)]^2 $$\n此项的积分为：\n$$ \\int \\gamma p_0(x) |\\nabla \\cdot \\boldsymbol{\\xi}_1|^2 dV = A_{\\perp} \\gamma \\int_0^L p_0(x) [\\phi_1'(x)]^2 dx $$\n代入 $p_0(x) = p_a + \\alpha x$ 和 $[\\phi_1'(x)]^2 = \\frac{2\\pi^2}{L^3} \\cos^2\\left(\\frac{\\pi x}{L}\\right)$:\n$$ \\int_0^L (p_a + \\alpha x) \\frac{2\\pi^2}{L^3} \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{2\\pi^2}{L^3} \\left[ p_a \\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx + \\alpha \\int_0^L x \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx \\right] $$\n积分为 $\\int_0^L \\cos^2(\\frac{\\pi x}{L}) dx = L/2$ 和 $\\int_0^L x \\cos^2(\\frac{\\pi x}{L}) dx = \\frac{L^2}{4}$。\n所以积分变为 $\\frac{2\\pi^2}{L^3} \\left( p_a \\frac{L}{2} + \\alpha \\frac{L^2}{4} \\right) = \\frac{\\pi^2}{L^2} \\left( p_a + \\frac{\\alpha L}{2} \\right)$。\n$A_{11}$ 的第二项是：\n$$ A_{11}^{(2)} = A_{\\perp} \\gamma \\frac{\\pi^2}{L^2} \\left( p_a + \\frac{\\alpha L}{2} \\right) $$\n\n第三项：压强梯度能。\n被积函数为 $(\\nabla \\cdot \\boldsymbol{\\xi}_1^*)(\\boldsymbol{\\xi}_1 \\cdot \\nabla p_0)$。\n$\\nabla p_0 = \\alpha \\hat{x}$。$\\boldsymbol{\\xi}_1 \\cdot \\nabla p_0 = \\alpha \\phi_1(x) \\exp(ik_z z)$。\n$\\nabla \\cdot \\boldsymbol{\\xi}_1^* = \\phi_1'(x) \\exp(-ik_z z)$。\n乘积为 $\\alpha \\phi_1(x) \\phi_1'(x)$。积分为：\n$$ A_{11}^{(3)} = A_{\\perp} \\alpha \\int_0^L \\phi_1(x) \\phi_1'(x) dx = A_{\\perp} \\alpha \\left[ \\frac{1}{2}\\phi_1(x)^2 \\right]_0^L = \\frac{A_{\\perp} \\alpha}{2} (\\phi_1(L)^2 - \\phi_1(0)^2) $$\n由于 $\\phi_1(0)=\\phi_1(L)=0$，此项为零：$A_{11}^{(3)} = 0$。\n\n合并各项，我们得到总的 $A_{11}$：\n$$ A_{11} = A_{11}^{(1)} + A_{11}^{(2)} + A_{11}^{(3)} = A_{\\perp} \\left[ \\frac{B_0^2}{\\mu_0} \\left( k_z^2 + \\frac{\\pi^2}{L^2} \\right) + \\gamma \\frac{\\pi^2}{L^2} \\left( p_a + \\frac{\\alpha L}{2} \\right) \\right] $$\n\n最后，模频率的平方是比值 $\\omega^2 = A_{11}/B_{11}$：\n$$ \\omega^2 = \\frac{A_{\\perp} \\left[ \\frac{B_0^2}{\\mu_0} \\left( k_z^2 + \\frac{\\pi^2}{L^2} \\right) + \\gamma \\frac{\\pi^2}{L^2} \\left( p_a + \\frac{\\alpha L}{2} \\right) \\right]}{A_{\\perp} \\rho_0} $$\n面积因子 $A_{\\perp}$ 消去，得到最终表达式：\n$$ \\omega^2 = \\frac{1}{\\rho_0} \\left[ \\frac{B_0^2}{\\mu_0} \\left( k_z^2 + \\frac{\\pi^2}{L^2} \\right) + \\gamma \\left( p_a + \\frac{\\alpha L}{2} \\right) \\frac{\\pi^2}{L^2} \\right] $$\n鉴于在定义域上 $p_0(x) > 0$，此表达式始终为正，表明该特定模式是稳定的。这一结果对应于快磁声波，其稳定性由磁力线弯曲和等离子体压缩提供。",
            "answer": "$$ \\boxed{ \\frac{1}{\\rho_{0}} \\left[ \\frac{B_{0}^{2}}{\\mu_{0}} \\left( k_{z}^{2} + \\frac{\\pi^{2}}{L^{2}} \\right) + \\gamma \\left( p_{a} + \\frac{\\alpha L}{2} \\right) \\frac{\\pi^{2}}{L^{2}} \\right] } $$"
        },
        {
            "introduction": "在信任任何模拟结果之前，我们必须验证我们的代码是否正确地求解了预设的方程。本实践介绍了“人造解方法”（Method of Manufactured Solutions, MMS），这是代码验证的基石。您将为一个简化的MHD算子定义一个解析解，导出相应的源项，然后使用您的有限差分代码求解该系统，以确认它能在预期的数值精度内恢复精确解。",
            "id": "4022928",
            "problem": "你需要为一个从理想磁流体力学（MHD）线性化方程在板状几何中推导出的简化线性算子，构建并验证一个制造解。这个制造解的目的是用一个已知的解析位移场和源项来验证离散组装和求解器流程。\n\n从以下基础和假设出发：\n\n- 理想磁流体力学（MHD）与绝热闭合：静态、均匀平衡中的线性化动量和感应方程。\n- 背景场是均匀且恒定的：密度 $\\rho_0$、热压强 $p_0$ 和磁场 $\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{z}}$。\n- 在可忽略方向 $y$ 和 $z$ 上具有简正模依赖性，使得所有微扰量都具有傅里叶依赖性 $\\exp(i k_y y + i k_z z)$，并且空间变化仅沿板坐标 $x$ 保留。\n- 位移场 $\\boldsymbol{\\xi}(x)$ 被逐分量处理，使用一个标量自伴算子来代表板状几何中压缩刚度和磁张力的组合效应。\n\n在这些假设下，考虑作用于一个通用分量 $\\xi(x)$ 的标量算子，其形式为\n$$\n\\mathcal{L}[\\xi](x) \\equiv -\\frac{d}{dx}\\left( C \\,\\frac{d \\xi}{dx} \\right) + M \\, k_\\perp^2 \\,\\xi(x),\n$$\n其中 $C = \\gamma \\, p_0 + \\frac{B_0^2}{\\mu_0}$，$M = \\frac{B_0^2}{\\mu_0}$，以及 $k_\\perp^2 = k_y^2 + k_z^2$。这里 $\\gamma$ 是绝热指数，$\\mu_0$ 是自由空间的磁导率。\n\n在域 $x \\in [0,L]$ 上定义制造的解析位移矢量场，其具有齐次狄利克雷边界条件 $\\boldsymbol{\\xi}(0) = \\boldsymbol{\\xi}(L) = \\mathbf{0}$：\n$$\n\\xi_x(x) = A \\,\\sin\\left(\\frac{\\pi x}{L}\\right), \\quad\n\\xi_y(x) = A \\,\\sin\\left(\\frac{2\\pi x}{L}\\right), \\quad\n\\xi_z(x) = A \\,\\sin\\left(\\frac{3\\pi x}{L}\\right),\n$$\n振幅 $A = 1 \\,\\mathrm{m}$，因此位移的单位是米。\n\n对于每个分量，通过将解析的 $\\xi$ 代入算子来定义源项：\n$$\nf_x(x) = \\mathcal{L}[\\xi_x](x), \\quad f_y(x) = \\mathcal{L}[\\xi_y](x), \\quad f_z(x) = \\mathcal{L}[\\xi_z](x).\n$$\n当 $C$ 和 $M$ 为常数时，这些源项满足\n$$\nf_n(x) = \\left[ C \\left( \\frac{n\\pi}{L} \\right)^2 + M k_\\perp^2 \\right] \\xi_n(x), \\quad n \\in \\{1,2,3\\},\n$$\n其中 $\\xi_n$ 表示在 $x$ 方向上波数因子为 $n$ 的分量。\n\n你的任务是：对算子 $\\mathcal{L}$ 在 $[0,L]$ 上具有 $N$ 个点的均匀网格上，为每个分量实现一个二阶中心有限差分离散化，并采用齐次狄利克雷边界条件，然后组装离散线性系统\n$$\n\\mathbf{A} \\mathbf{u}_n = \\mathbf{f}_n, \\quad n \\in \\{1,2,3\\},\n$$\n求解 $\\mathbf{u}_n$，并将其与在内部点上制造的解析解 $\\boldsymbol{\\xi}(x)$ 的离散采样进行比较。用于内部点的离散矩阵 $\\mathbf{A}$ 应实现\n$$\n\\mathbf{A} = -C \\,\\mathbf{D}^{(2)} + M k_\\perp^2 \\,\\mathbf{I},\n$$\n其中 $\\mathbf{D}^{(2)}$ 是用于齐次狄利克雷边界的标准二阶导数矩阵：\n$$\n\\left(\\mathbf{D}^{(2)} \\mathbf{v}\\right)_i = \\frac{v_{i+1} - 2 v_i + v_{i-1}}{h^2}, \\quad h = \\frac{L}{N-1},\n$$\n$\\mathbf{I}$ 是单位矩阵。\n\n对每个测试用例，计算数值解与制造的解析解在内部网格点上的最大绝对误差。误差以米为单位表示。最终输出应为单个浮点数列表，每个测试用例对应一个浮点数，给出该用例中所有三个分量的最大绝对误差。\n\n使用以下物理常数和单位：\n- $\\mu_0 = 4\\pi \\times 10^{-7} \\,\\mathrm{H/m}$,\n- $\\gamma$ 是无量纲的,\n- $p_0$ 单位为 $\\mathrm{Pa}$,\n- $B_0$ 单位为 $\\mathrm{T}$,\n- $L$ 单位为 $\\mathrm{m}$,\n- $k_y$ 和 $k_z$ 单位为 $\\mathrm{rad/m}$,\n- 位移振幅 $A$ 单位为 $\\mathrm{m}$,\n- 误差必须以 $\\mathrm{m}$ 表示。\n\n测试套件：\n为以下参数集提供结果，以确保覆盖典型行为、横向波数的简并、粗分辨率和高刚度的情况。\n\n- 情况 1 (理想情况)：\n  - $L = 1.0 \\,\\mathrm{m}$,\n  - $N = 200$,\n  - $\\gamma = \\frac{5}{3}$,\n  - $p_0 = 2.0 \\times 10^{3} \\,\\mathrm{Pa}$,\n  - $B_0 = 1.0 \\,\\mathrm{T}$,\n  - $k_y = 5.0 \\,\\mathrm{rad/m}$,\n  - $k_z = 3.0 \\,\\mathrm{rad/m}$。\n\n- 情况 2 (横向波数简并)：\n  - $L = 1.0 \\,\\mathrm{m}$,\n  - $N = 50$,\n  - $\\gamma = \\frac{5}{3}$,\n  - $p_0 = 1.0 \\times 10^{3} \\,\\mathrm{Pa}$,\n  - $B_0 = 1.0 \\,\\mathrm{T}$,\n  - $k_y = 0.0 \\,\\mathrm{rad/m}$,\n  - $k_z = 0.0 \\,\\mathrm{rad/m}$。\n\n- 情况 3 (粗网格，强场)：\n  - $L = 1.0 \\,\\mathrm{m}$,\n  - $N = 10$,\n  - $\\gamma = \\frac{5}{3}$,\n  - $p_0 = 2.0 \\times 10^{5} \\,\\mathrm{Pa}$,\n  - $B_0 = 3.0 \\,\\mathrm{T}$,\n  - $k_y = 10.0 \\,\\mathrm{rad/m}$,\n  - $k_z = 0.0 \\,\\mathrm{rad/m}$。\n\n- 情况 4 (短域，高刚度和高分辨率)：\n  - $L = 0.5 \\,\\mathrm{m}$,\n  - $N = 300$,\n  - $\\gamma = \\frac{5}{3}$,\n  - $p_0 = 1.0 \\times 10^{5} \\,\\mathrm{Pa}$,\n  - $B_0 = 5.0 \\,\\mathrm{T}$,\n  - $k_y = 20.0 \\,\\mathrm{rad/m}$,\n  - $k_z = 20.0 \\,\\mathrm{rad/m}$。\n\n最终输出格式：\n你的程序应产生单行输出，其中包含四个测试用例的最大绝对误差，格式为用方括号括起来的逗号分隔列表，例如\n$$\n[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4],\n$$\n其中每个 $\\varepsilon_i$ 是一个以米为单位的浮点数。",
            "solution": "我们从静态、均匀平衡状态下的理想磁流体力学（MHD）线性化方程开始。以拉格朗日位移 $\\boldsymbol{\\xi}$ 表示的小扰动的力平衡满足\n$$\n\\rho_0 \\frac{\\partial^2 \\boldsymbol{\\xi}}{\\partial t^2} = \\mathbf{F}(\\boldsymbol{\\xi}),\n$$\n其中，对于绝热指数为 $\\gamma$ 的绝热动力学，线性力算子 $\\mathbf{F}$ 为\n$$\n\\mathbf{F}(\\boldsymbol{\\xi}) = -\\nabla(\\gamma p_0 \\nabla \\cdot \\boldsymbol{\\xi}) + \\frac{1}{\\mu_0} \\left( \\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0) \\right) \\times \\mathbf{B}_0.\n$$\n对于均匀背景磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 和均匀压强 $p_0$，表达式在保持自伴随性的同时得以简化。在板状几何中，标准的做法是假设在可忽略坐标中存在傅里叶依赖性，写作 $\\exp(i k_y y + i k_z z)$，这将 $y$ 和 $z$ 方向的导数分别简化为乘以 $i k_y$ 和 $i k_z$。剩余的空间变化沿 $x$ 方向，我们需要寻找一个在 $x$ 上的简化常微分算子。\n\n在这样的均匀介质中，压缩压强项贡献的刚度与 $\\gamma p_0$ 乘以曲率和散度成正比，而磁张力贡献的刚度与 $B_0^2/\\mu_0$ 乘以磁力线的曲率成正比。为了使用制造解进行代码验证，通常采用一个标量自伴算子来逐分量地捕捉主要的刚度贡献，这在科学上是合理的：\n$$\n\\mathcal{L}[\\xi](x) \\equiv -\\frac{d}{dx}\\left( C \\,\\frac{d \\xi}{dx} \\right) + M \\, k_\\perp^2 \\,\\xi(x),\n$$\n常数为\n$$\nC = \\gamma p_0 + \\frac{B_0^2}{\\mu_0}, \\quad M = \\frac{B_0^2}{\\mu_0}, \\quad k_\\perp^2 = k_y^2 + k_z^2.\n$$\n对于均匀介质和 $y$、$z$ 方向的傅里叶谐波，这种形式与板坐标系中的能量原理一致：项 $-d/dx(C d\\xi/dx)$ 模拟了沿 $x$ 方向的压缩刚度和磁刚度的组合，而项 $M k_\\perp^2 \\xi$ 模拟了与横向波数相关的磁张力。\n\n为了验证组装和求解器流程，我们为位移分量选择一个制造的解析解：\n$$\n\\xi_x(x) = A \\,\\sin\\left(\\frac{\\pi x}{L}\\right), \\quad\n\\xi_y(x) = A \\,\\sin\\left(\\frac{2\\pi x}{L}\\right), \\quad\n\\xi_z(x) = A \\,\\sin\\left(\\frac{3\\pi x}{L}\\right),\n$$\n其中 $A = 1\\,\\mathrm{m}$。这些解满足在 $x=0$ 和 $x=L$ 处的齐次狄利克雷边界条件。将其代入算子，并注意到当 $C$ 为常数时，二阶导数为\n$$\n\\frac{d^2}{dx^2} \\sin\\left( \\frac{n\\pi x}{L} \\right) = -\\left( \\frac{n\\pi}{L} \\right)^2 \\sin\\left( \\frac{n\\pi x}{L} \\right),\n$$\n我们得到精确的源项\n$$\nf_n(x) = \\mathcal{L}[\\xi_n](x) = \\left[ C \\left( \\frac{n\\pi}{L} \\right)^2 + M k_\\perp^2 \\right] \\xi_n(x), \\quad n \\in \\{1,2,3\\}.\n$$\n这种构造确保了在连续情况下，用相同的边界条件求解 $\\mathcal{L}[u_n] = f_n$ 会得到 $u_n = \\xi_n$。\n\n我们现在设计一个与齐次狄利克雷边界一致的二阶中心有限差分离散格式。设网格为 $x_j = j h$，其中 $j = 0,1,\\dots,N-1$，$h = L/(N-1)$。内部点的索引为 $j=1,\\dots,N-2$。内部点上的离散二阶导数算子 $\\mathbf{D}^{(2)}$ 是\n$$\n\\left(\\mathbf{D}^{(2)} \\mathbf{v}\\right)_j = \\frac{v_{j+1} - 2 v_j + v_{j-1}}{h^2}.\n$$\n由于边界值为零，内部模板中不出现边界贡献。离散算子变为\n$$\n\\mathbf{A} = -C \\,\\mathbf{D}^{(2)} + M k_\\perp^2 \\,\\mathbf{I},\n$$\n对每个分量相同地应用。对于每个分量 $n \\in \\{1,2,3\\}$，右侧向量由解析源采样得到：\n$$\n\\mathbf{f}_n = \\left[ C \\left( \\frac{n\\pi}{L} \\right)^2 + M k_\\perp^2 \\right] \\boldsymbol{\\xi}_n,\n$$\n其中 $\\boldsymbol{\\xi}_n$ 是 $\\xi_n(x)$ 在内部点上的采样。然后我们求解\n$$\n\\mathbf{A} \\mathbf{u}_n = \\mathbf{f}_n,\n$$\n使用直接线性求解器。数值解 $\\mathbf{u}_n$ 以关于 $h$ 的二阶精度逼近解析的内部值 $\\boldsymbol{\\xi}_n$。给定分量的最大绝对误差为\n$$\n\\varepsilon_n = \\max_j \\left| u_{n,j} - \\xi_n(x_j) \\right|.\n$$\n我们报告每个测试用例中所有三个分量的最大绝对误差：\n$$\n\\varepsilon_{\\text{case}} = \\max\\{\\varepsilon_1,\\varepsilon_2,\\varepsilon_3\\}.\n$$\n所有误差都以米表示，因为位移振幅 $A$ 的单位是米。\n\n测试套件设计：\n- 情况1使用 $L = 1.0\\,\\mathrm{m}$，$N = 200$，$\\gamma = 5/3$，$p_0 = 2.0 \\times 10^3\\,\\mathrm{Pa}$，$B_0 = 1.0\\,\\mathrm{T}$，$k_y = 5.0\\,\\mathrm{rad/m}$，$k_z = 3.0\\,\\mathrm{rad/m}$，代表一个分辨率良好、中等刚度的场景。\n- 情况2设置 $k_\\perp = 0$ 来测试纯粹的 $x$ 方向刚度算子，参数为 $L = 1.0\\,\\mathrm{m}$，$N = 50$，$\\gamma = 5/3$，$p_0 = 1.0 \\times 10^3\\,\\mathrm{Pa}$，$B_0 = 1.0\\,\\mathrm{T}$；这是对横向波数的简并性检查。\n- 情况3使用粗网格 $N=10$ 和强场 $B_0 = 3.0\\,\\mathrm{T}$，参数为 $k_y = 10.0\\,\\mathrm{rad/m}$，$k_z = 0.0\\,\\mathrm{rad/m}$ 和 $p_0 = 2.0 \\times 10^5\\,\\mathrm{Pa}$，以测试在低分辨率下的鲁棒性。\n- 情况4使用较短的域 $L = 0.5\\,\\mathrm{m}$、高刚度（$B_0 = 5.0\\,\\mathrm{T}$）、大的横向波数（$k_y = 20.0\\,\\mathrm{rad/m}$ 和 $k_z = 20.0\\,\\mathrm{rad/m}$）以及精细的分辨率 $N = 300$。\n\n算法步骤：\n1. 对每个情况，计算 $C$、$M$ 和 $k_\\perp^2$。\n2. 构建内部网格和二阶导数矩阵 $\\mathbf{D}^{(2)}$。\n3. 组装 $\\mathbf{A}$。\n4. 对 $n=1,2,3$ 采样 $\\boldsymbol{\\xi}_n$ 并构建 $\\mathbf{f}_n$。\n5. 对每个 $n$ 求解 $\\mathbf{A}\\mathbf{u}_n = \\mathbf{f}_n$。\n6. 计算最大绝对误差 $\\varepsilon_n$ 并报告每个情况的 $\\max_n \\varepsilon_n$。\n\n程序必须产生单行输出，其中包含四个以米为单位的误差，格式为用方括号括起来的逗号分隔列表，即 $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\nMU0 = 4.0 * np.pi * 1e-7  # permeability of free space (H/m)\n\ndef assemble_operator(N, L, C, M, kperp2):\n    \"\"\"\n    Assemble the interior operator A = -C * D2 + M * kperp^2 * I\n    for homogeneous Dirichlet boundaries on a uniform grid.\n    \"\"\"\n    h = L / (N - 1)\n    n_interior = N - 2\n    # Second derivative matrix D2 with standard 3-point stencil\n    # D2 v_j = (v_{j+1} - 2 v_j + v_{j-1}) / h^2\n    diag = -2.0 / (h * h)\n    off = 1.0 / (h * h)\n    D2 = np.zeros((n_interior, n_interior))\n    # Fill tridiagonal\n    for i in range(n_interior):\n        D2[i, i] = diag\n        if i > 0:\n            D2[i, i - 1] = off\n        if i  n_interior - 1:\n            D2[i, i + 1] = off\n    A = -C * D2 + (M * kperp2) * np.eye(n_interior)\n    return A\n\ndef manufactured_xi_components(x, L, A_amp=1.0):\n    \"\"\"\n    Manufactured displacement components:\n    xi_x = A * sin(pi x / L)\n    xi_y = A * sin(2 pi x / L)\n    xi_z = A * sin(3 pi x / L)\n    \"\"\"\n    xi_x = A_amp * np.sin(np.pi * x / L)\n    xi_y = A_amp * np.sin(2.0 * np.pi * x / L)\n    xi_z = A_amp * np.sin(3.0 * np.pi * x / L)\n    return xi_x, xi_y, xi_z\n\ndef manufactured_sources(xi_x, xi_y, xi_z, L, C, M, kperp2):\n    \"\"\"\n    Using the analytic relation:\n    f_n = [ C * (n*pi/L)^2 + M * kperp^2 ] * xi_n\n    for n = 1,2,3 corresponding to xi_x, xi_y, xi_z.\n    \"\"\"\n    factors = np.array([\n        C * (1.0 * np.pi / L) ** 2 + M * kperp2,\n        C * (2.0 * np.pi / L) ** 2 + M * kperp2,\n        C * (3.0 * np.pi / L) ** 2 + M * kperp2\n    ])\n    f_x = factors[0] * xi_x\n    f_y = factors[1] * xi_y\n    f_z = factors[2] * xi_z\n    return f_x, f_y, f_z\n\ndef solve_case(L, N, gamma, p0, B0, ky, kz):\n    \"\"\"\n    Assemble and solve the discrete systems for the three components,\n    then compute the maximum absolute error across components at interior points.\n    \"\"\"\n    C = gamma * p0 + (B0 ** 2) / MU0\n    M = (B0 ** 2) / MU0\n    kperp2 = ky ** 2 + kz ** 2\n\n    # Grid\n    x = np.linspace(0.0, L, N)\n    x_interior = x[1:-1]\n\n    # Manufactured displacement at interior points\n    xi_x, xi_y, xi_z = manufactured_xi_components(x_interior, L, A_amp=1.0)\n\n    # Manufactured sources\n    f_x, f_y, f_z = manufactured_sources(xi_x, xi_y, xi_z, L, C, M, kperp2)\n\n    # Assemble operator\n    A = assemble_operator(N, L, C, M, kperp2)\n\n    # Solve A u = f for each component\n    # Use a robust solver; A is symmetric positive definite under given parameters.\n    u_x = np.linalg.solve(A, f_x)\n    u_y = np.linalg.solve(A, f_y)\n    u_z = np.linalg.solve(A, f_z)\n\n    # Compute maximum absolute error across components (meters)\n    err_x = np.max(np.abs(u_x - xi_x))\n    err_y = np.max(np.abs(u_y - xi_y))\n    err_z = np.max(np.abs(u_z - xi_z))\n    err_case = float(max(err_x, err_y, err_z))\n    return err_case\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        {\"L\": 1.0, \"N\": 200, \"gamma\": 5.0/3.0, \"p0\": 2.0e3, \"B0\": 1.0, \"ky\": 5.0, \"kz\": 3.0},\n        # Case 2 (transverse wavenumber degeneracy)\n        {\"L\": 1.0, \"N\": 50, \"gamma\": 5.0/3.0, \"p0\": 1.0e3, \"B0\": 1.0, \"ky\": 0.0, \"kz\": 0.0},\n        # Case 3 (coarse grid, stronger field)\n        {\"L\": 1.0, \"N\": 10, \"gamma\": 5.0/3.0, \"p0\": 2.0e5, \"B0\": 3.0, \"ky\": 10.0, \"kz\": 0.0},\n        # Case 4 (short domain, high stiffness and resolution)\n        {\"L\": 0.5, \"N\": 300, \"gamma\": 5.0/3.0, \"p0\": 1.0e5, \"B0\": 5.0, \"ky\": 20.0, \"kz\": 20.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        err = solve_case(\n            L=case[\"L\"],\n            N=case[\"N\"],\n            gamma=case[\"gamma\"],\n            p0=case[\"p0\"],\n            B0=case[\"B0\"],\n            ky=case[\"ky\"],\n            kz=case[\"kz\"],\n        )\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "仅有经过验证的代码是不够的；我们还必须确保其解是准确的，并且随着数值分辨率的提高收敛到真实的物理解。本练习将指导您完成一个系统性的网格加密研究，这是一个基本的特征值问题。您将在一系列网格上计算解，以测量观测到的收敛阶，并使用理查森外推法来估计精确的连续谱特征值，这为验证数值方案的准确性提供了一种强有力的方法。",
            "id": "4022891",
            "problem": "考虑一个一维平板中的线性化理想磁流体动力学（MHD）简正模问题，该平板的无量纲径向坐标为 $x \\in (0,1)$，并在 $x=0$ 和 $x=1$ 处有理想导电壁。在不可压缩、类剪切阿尔芬波极限下，对于均匀的平衡磁场和质量密度，简正模位移 $ \\xi(x) $ 满足一个自伴Sturm-Liouville本征问题，该问题可简化为以下二阶常微分方程：\n$$\n-\\dfrac{\\mathrm{d}^2 \\xi}{\\mathrm{d}x^2} = \\lambda \\, \\xi,\n$$\n并服从边界条件 $ \\xi(0) = 0 $ 和 $ \\xi(1) = 0 $。精确的连续谱本征值为 $ \\lambda_n = n^2 \\pi^2 $（其中整数 $ n \\ge 1 $），代表性的最低本征值对应于 $ n = 1 $，即 $ \\lambda_\\star = \\pi^2 $。\n\n您需要对代表性的最低本征值进行数值网格加密研究，使用二阶中心有限差分法对微分算子 $ -\\mathrm{d}^2/\\mathrm{d}x^2 $ 进行离散化，并采用齐次Dirichlet边界条件。将网格视为一个均匀网格，总共包括边界在内有 $ N $ 个点，间距为 $ h = 1/(N-1) $，以及 $ N-2 $ 个内部未知数。构造该算子的对称三对角矩阵表示，其对角线元素为 $ 2/h^2 $，非对角线元素为 $ -1/h^2 $，并计算其最小本征值，作为最低连续谱本征值的离散近似。\n\n从第一性原理出发，数值离散化会引入一个本征值误差 $ \\varepsilon(h) $，其标度关系预计为 $ \\mathcal{O}(h^p) $，其中收敛阶 $ p $ 由该格式的局部截断误差决定。您的任务是：\n1. 对三个连续加密的网格，计算其最小离散本征值，形成一个三元组 $ (\\lambda_{h_1}, \\lambda_{h_2}, \\lambda_{h_3}) $，其中加密比为 $ r $，且 $ h_1  h_2  h_3 $ 和 $ r = h_1/h_2 = h_2/h_3 $。\n2. 利用三网格数据，通过拟合模型 $ \\lambda_h = \\Lambda + C h^p $（其中连续谱极限 $ \\Lambda $ 和指数 $ p $ 未知）来估计观测收敛阶 $ p_{\\mathrm{obs}} $，使用标准的三网格公式：\n$$\np_{\\mathrm{obs}} = \\dfrac{\\ln\\!\\left(\\left|\\lambda_{h_1} - \\lambda_{h_2}\\right| / \\left|\\lambda_{h_2} - \\lambda_{h_3}\\right|\\right)}{\\ln(r)}.\n$$\n3. 使用估计出的指数应用Richardson外推，从两个最精细的网格获得连续谱估计值 $ \\Lambda_{\\mathrm{RE}} $：\n$$\n\\Lambda_{\\mathrm{RE}} = \\lambda_{h_3} + \\dfrac{\\lambda_{h_3} - \\lambda_{h_2}}{r^{p_{\\mathrm{obs}}} - 1}.\n$$\n4. 评估观测收敛阶 $ p_{\\mathrm{obs}} $ 是否与从二阶中心差分格式的截断误差推导出的理论阶相符。对于此评估，如果 $ \\left|p_{\\mathrm{obs}} - 2\\right| \\le 0.2 $，则判断为相符。\n\n将上述步骤实现为一个完整、可运行的程序。所有数值均为无量纲。使用以下网格尺寸的测试套件，其中每个测试用例是一个总网格点数的三元组 $ (N_1,N_2,N_3) $，且具有恒定的加密比 $ r = 2 $：\n- 测试用例 1: $ (N_1,N_2,N_3) = (33,\\,65,\\,129) $。\n- 测试用例 2: $ (N_1,N_2,N_3) = (17,\\,33,\\,65) $。\n- 测试用例 3: $ (N_1,N_2,N_3) = (9,\\,17,\\,33) $。\n- 测试用例 4: $ (N_1,N_2,N_3) = (5,\\,9,\\,17) $。\n\n对于每个测试用例，生成以下输出：\n- 最精细网格上的离散本征值 $ \\lambda_{h_3} $，以浮点数形式表示。\n- Richardson外推的连续谱估计值 $ \\Lambda_{\\mathrm{RE}} $，以浮点数形式表示。\n- Richardson估计值相对于精确连续谱值 $ \\lambda_\\star = \\pi^2 $ 的绝对误差，即 $ \\left|\\Lambda_{\\mathrm{RE}} - \\pi^2\\right| $，以浮点数形式表示。\n- 观测到的收敛阶 $ p_{\\mathrm{obs}} $，以浮点数形式表示。\n- 一个布尔值，根据判据 $ \\left|p_{\\mathrm{obs}} - 2\\right| \\le 0.2 $ 指示 $ p_{\\mathrm{obs}} $ 是否在指定容差内与理论阶相符。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的、逗号分隔的结果列表，且无空格。每个测试用例的结果本身也应是一个用方括号括起来的、逗号分隔的列表，并按上述顺序排列。例如，整体输出应如下所示：\n$$\n[\\,[\\lambda_{h_3}^{(1)},\\Lambda_{\\mathrm{RE}}^{(1)},|\\Lambda_{\\mathrm{RE}}^{(1)}-\\pi^2|,p_{\\mathrm{obs}}^{(1)},\\text{match}^{(1)}],\\,[\\lambda_{h_3}^{(2)},\\Lambda_{\\mathrm{RE}}^{(2)},|\\Lambda_{\\mathrm{RE}}^{(2)}-\\pi^2|,p_{\\mathrm{obs}}^{(2)},\\text{match}^{(2)}],\\,\\ldots\\,]\n$$\n其中上标表示测试用例编号。所有数值输出必须是十进制数；布尔值必须是 $ \\text{True} $ 或 $ \\text{False} $。",
            "solution": "用户提供了一个来自计算科学领域的有效且适定的问题陈述，具体涉及在理想磁流体动力学（MHD）中出现的Sturm-Liouville本征问题的数值分析。该问题要求执行网格加密研究，以验证有限差分格式的收敛阶。\n\n问题是求解以下微分方程的最低本征值：\n$$\n-\\dfrac{\\mathrm{d}^2 \\xi}{\\mathrm{d}x^2} = \\lambda \\, \\xi\n$$\n该方程定义在域 $x \\in (0,1)$ 上，并带有齐次Dirichlet边界条件 $\\xi(0) = 0$ 和 $\\xi(1)=0$。已知的精确最低本征值为 $\\lambda_\\star = \\pi^2$。\n\n我们将使用二阶中心有限差分法在均匀网格上对此进行数值求解。网格由 $N$ 个点 $x_i = i h$（$i=0, 1, \\dots, N-1$）组成，其中网格间距为 $h = 1/(N-1)$。这些网格点上的位移记为 $\\xi_i = \\xi(x_i)$。边界条件意味着 $\\xi_0 = 0$ 和 $\\xi_{N-1} = 0$。未知量是 $N-2$ 个内部点 $\\xi_1, \\dots, \\xi_{N-2}$ 上的位移。\n\n内部网格点 $x_i$ 处的二阶导数使用二阶中心差分公式近似：\n$$\n\\left. \\frac{\\mathrm{d}^2 \\xi}{\\mathrm{d}x^2} \\right|_{x_i} \\approx \\frac{\\xi_{i-1} - 2\\xi_i + \\xi_{i+1}}{h^2}\n$$\n将此近似代入控制微分方程，得到关于内部点（$i=1, \\dots, N-2$）的线性方程组：\n$$\n- \\left( \\frac{\\xi_{i-1} - 2\\xi_i + \\xi_{i+1}}{h^2} \\right) = \\lambda_h \\xi_i\n$$\n其中 $\\lambda_h$ 是本征值 $\\lambda$ 的数值近似。重新整理该方程可得：\n$$\n\\frac{1}{h^2} \\left( -\\xi_{i-1} + 2\\xi_i - \\xi_{i+1} \\right) = \\lambda_h \\xi_i\n$$\n这个包含 $N-2$ 个方程的系统可以写成标准本征值问题的矩阵形式，$A\\vec{\\xi} = \\lambda_h \\vec{\\xi}$，其中 $\\vec{\\xi} = [\\xi_1, \\xi_2, \\dots, \\xi_{N-2}]^T$ 是未知位移的向量。矩阵 $A$ 是一个 $(N-2) \\times (N-2)$ 的对称三对角矩阵：\n$$\nA = \\frac{1}{h^2}\n\\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  -1  2  \\ddots  \\vdots \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  -1 \\\\\n0  0  \\cdots  -1  2\n\\end{pmatrix}\n$$\n$A$ 的对角线元素为 $2/h^2$，第一非对角线（次对角线和超对角线）元素为 $-1/h^2$。最低本征值的数值近似 $\\lambda_h$ 是该矩阵 $A$ 的最小本征值。\n\n为了进行分析，我们假设离散本征值的误差标度关系为 $\\lambda_h = \\lambda_\\star + C h^p + \\mathcal{O}(h^{p+q})$，其中 $p$ 是收敛阶。中心差分格式的局部截断误差为 $\\mathcal{O}(h^2)$，对于这个自伴问题，这意味着本征值的全局误差具有相同的阶数，因此理论收敛阶为 $p=2$。\n\n我们通过计算一系列三个网格的本征值来验证这一点，这些网格的间距为 $h_1  h_2  h_3$，且具有恒定的加密比 $r = h_1/h_2 = h_2/h_3$。对应的本征值为 $\\lambda_{h_1}$、$\\lambda_{h_2}$ 和 $\\lambda_{h_3}$。观测收敛阶 $p_{\\mathrm{obs}}$ 通过假设误差由主导项决定来估计：\n$$\n\\frac{\\lambda_{h_1} - \\lambda_{h_2}}{\\lambda_{h_2} - \\lambda_{h_3}} \\approx \\frac{(C h_1^p) - (C h_2^p)}{(C h_2^p) - (C h_3^p)} = \\frac{h_2^p(r^p - 1)}{h_3^p(r^p - 1)} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p\n$$\n对两边取自然对数并求解 $p$，得到观测阶的公式：\n$$\np_{\\mathrm{obs}} = \\frac{\\ln\\left(\\left|\\lambda_{h_1} - \\lambda_{h_2}\\right| / \\left|\\lambda_{h_2} - \\lambda_{h_3}\\right|\\right)}{\\ln(r)}\n$$\n一旦估计出 $p_{\\mathrm{obs}}$，就可以使用Richardson外推来获得一个更精确的连续谱本征值估计值 $\\Lambda_{\\mathrm{RE}}$。使用两个最精细网格的结果：\n$$\n\\lambda_{h_2} \\approx \\Lambda_{\\mathrm{RE}} + C h_2^p \\quad , \\quad \\lambda_{h_3} \\approx \\Lambda_{\\mathrm{RE}} + C h_3^p\n$$\n求解该方程组以得到 $\\Lambda_{\\mathrm{RE}}$，得出外推公式：\n$$\n\\Lambda_{\\mathrm{RE}} = \\lambda_{h_3} + \\frac{\\lambda_{h_3} - \\lambda_{h_2}}{r^{p_{\\mathrm{obs}}} - 1}\n$$\n实现将通过定义一个函数来进行，该函数对于给定的 $N$，构造三对角矩阵并计算其最小本征值。然后对测试用例三元组 $(N_1, N_2, N_3)$ 中的每个 $N$ 调用此函数，以获得 $(\\lambda_{h_1}, \\lambda_{h_2}, \\lambda_{h_3})$。随后，使用上述公式计算 $p_{\\mathrm{obs}}$ 和 $\\Lambda_{\\mathrm{RE}}$。最后，计算绝对误差 $|\\Lambda_{\\mathrm{RE}} - \\pi^2|$，并将 $p_{\\mathrm{obs}}$ 与理论值 $2$ 进行比较，以确定它们是否在指定的容差 $0.2$ 内匹配。对每个提供的测试用例重复这整个过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to perform the grid refinement study for all test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (33, 65, 129),\n        (17, 33, 65),\n        (9, 17, 33),\n        (5, 9, 17),\n    ]\n\n    # The constant refinement ratio.\n    r = 2.0\n\n    # The exact lowest eigenvalue.\n    lambda_star = np.pi**2\n\n    # A list to store the results for all test cases.\n    all_results = []\n\n    def compute_smallest_eigenvalue(N):\n        \"\"\"\n        Computes the smallest eigenvalue of the discretized operator for a grid with N points.\n        \"\"\"\n        # A grid with N = 2 points has no interior points.\n        if N = 2:\n            return np.nan\n\n        # Grid spacing.\n        h = 1.0 / (N - 1)\n        # Number of interior points, which is the dimension of the matrix.\n        M = N - 2\n        \n        # The h^2 factor.\n        h2_inv = 1.0 / h**2\n        \n        # Define the diagonal and off-diagonal elements of the tridiagonal matrix.\n        # Diagonal entries are 2/h^2.\n        diag = np.full(M, 2.0 * h2_inv)\n        # Off-diagonal entries are -1/h^2.\n        off_diag = np.full(M - 1, -1.0 * h2_inv)\n        \n        # Compute eigenvalues of the symmetric tridiagonal matrix.\n        # The function eigh_tridiagonal is highly efficient and returns sorted eigenvalues.\n        eigenvalues = eigh_tridiagonal(diag, off_diag, eigvals_only=True)\n        \n        # Return the smallest eigenvalue.\n        return eigenvalues[0]\n\n    # Process each test case.\n    for N1, N2, N3 in test_cases:\n        # 1. Compute the smallest discrete eigenvalue for the three grids.\n        lambda_h1 = compute_smallest_eigenvalue(N1)\n        lambda_h2 = compute_smallest_eigenvalue(N2)\n        lambda_h3 = compute_smallest_eigenvalue(N3)\n\n        # 2. Estimate the observed convergence order p_obs.\n        diff_12 = lambda_h1 - lambda_h2\n        diff_23 = lambda_h2 - lambda_h3\n        \n        # To avoid division by zero or log of non-positive number if differences are not as expected.\n        if abs(diff_23)  np.finfo(float).eps or diff_12 / diff_23 = 0:\n            p_obs = np.nan\n        else:\n            ratio = abs(diff_12 / diff_23)\n            p_obs = np.log(ratio) / np.log(r)\n\n        # 3. Apply Richardson extrapolation to obtain the continuum estimate.\n        # Using the p_obs calculated from data.\n        denominator = r**p_obs - 1.0\n        if abs(denominator)  np.finfo(float).eps:\n            Lambda_RE = np.nan\n        else:\n            # Note that lambda_h3 - lambda_h2 is -diff_23\n            Lambda_RE = lambda_h3 + (lambda_h3 - lambda_h2) / denominator\n\n        # 4. Assess results.\n        # Absolute error of the Richardson estimate.\n        error_RE = abs(Lambda_RE - lambda_star) if not np.isnan(Lambda_RE) else np.nan\n        \n        # Check if the observed order matches the theoretical order p=2.\n        p_theory = 2.0\n        p_tolerance = 0.2\n        match = abs(p_obs - p_theory) = p_tolerance if not np.isnan(p_obs) else False\n\n        # Store the results for this test case.\n        # The first output is lambda_h3, the finest-grid result.\n        all_results.append([lambda_h3, Lambda_RE, error_RE, p_obs, match])\n\n    # Format the final output string as specified.\n    # e.g., [[val1,val2,...],[val1,val2,...],...]\n    result_str_list = []\n    for result_set in all_results:\n        # Convert each value to string, handling the boolean separately.\n        str_vals = [f\"{v}\" for v in result_set[:-1]] + [str(result_set[-1])]\n        result_str_list.append(f\"[{','.join(str_vals)}]\")\n    \n    final_output_str = f\"[{','.join(result_str_list)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}