{
    "hands_on_practices": [
        {
            "introduction": "理解等离子体稳定性的第一步是解构势能变化 $\\delta W$ 的各个组成部分。本练习专注于计算“磁力线弯曲”能，这是磁流体动力学（MHD）中一个基本的稳定效应。通过对一个普遍的螺旋扰动进行推导，您将直接洞察扰动的几何形状和磁场结构如何决定等离子体的稳定性。",
            "id": "3973927",
            "problem": "考虑一个半径为 $a$、轴向周期为 $L$ 的直的圆形柱状等离子体，在柱坐标系 $(r,\\theta,z)$ 中，其轴对称平衡磁场为 $\\boldsymbol{B}_0(r)=B_{\\theta}(r)\\,\\hat{\\boldsymbol{e}}_{\\theta}+B_{z}(r)\\,\\hat{\\boldsymbol{e}}_{z}$，其中 $B_{\\theta}(r)$ 和 $B_{z}(r)$ 是 $r$ 的光滑函数，且 $B_{r}(r)=0$。设位移是一个理想磁流体动力学（MHD）扰动，该扰动处处垂直于 $\\boldsymbol{B}_0$，形式为 $\\boldsymbol{\\xi}_{\\perp}(r,\\theta,z)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{\\perp}(r)\\,\\exp\\!\\big(i\\,[m\\,\\theta+k\\,z]\\big)$，其中 $m\\in\\mathbb{Z}$ 是角向模数，$k\\in\\mathbb{R}$ 是轴向波数，$\\xi(r)$ 是实数径向振幅，$\\hat{\\boldsymbol{e}}_{\\perp}(r)$ 是一个单位矢量，满足 $\\hat{\\boldsymbol{e}}_{\\perp}(r)\\cdot\\boldsymbol{B}_0(r)=0$ 且仅依赖于 $r$。假设理想磁流体动力学，并使用能量原理来分离出磁力线弯曲的贡献\n$$\n\\delta W_{\\text{bend}}=\\frac{1}{2\\,\\mu_{0}}\\int|\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}|^{2}\\,d^{3}x,\n$$\n其中 $\\mu_{0}$ 是真空磁导率，且 $d^{3}x=r\\,dr\\,d\\theta\\,dz$。从第一性原理出发，用 $m$、$k$、$L$、$\\mu_{0}$、$B_{\\theta}(r)$、$B_{z}(r)$ 和 $\\xi(r)$ 显式计算 $\\delta W_{\\text{bend}}$，执行对 $\\theta$ 和 $z$ 的积分，但保留径向积分不计算。陈述您使用的任何几何恒等式。以焦耳为单位表示最终能量。不要进行任何数值计算；您的最终表达式必须是闭合形式，并且只依赖于指定的符号。在加框的最终答案中不要包含单位。",
            "solution": "该问题是有效的，因为它在科学上基于理想磁流体动力学（MHD）理论，特别是关于等离子体稳定性分析的能量原理。其设置定义明确、自成体系，并且没有矛盾或含糊之处。它提出了一个计算聚变科学领域的标准的、可解的问题。\n\n目标是计算磁力线弯曲的能量贡献，由下列表达式给出：\n$$\n\\delta W_{\\text{bend}}=\\frac{1}{2\\,\\mu_{0}}\\int|\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}|^{2}\\,d^{3}x\n$$\n积分是在柱状等离子体的体积上进行的，该等离子体半径为 $a$，轴向周期为 $L$。在柱坐标 $(r, \\theta, z)$ 中，体积元为 $d^3x = r\\,dr\\,d\\theta\\,dz$。积分限为 $r \\in [0, a]$、$\\theta \\in [0, 2\\pi]$ 和 $z \\in [0, L]$。\n\n计算的核心是评估项 $|\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}|^2$。表达式 $\\boldsymbol{B}_0\\cdot\\nabla$ 表示沿磁场 $\\boldsymbol{B}_0$ 的方向导数算子。在柱坐标系中，梯度算子为 $\\nabla = \\hat{\\boldsymbol{e}}_r \\frac{\\partial}{\\partial r} + \\hat{\\boldsymbol{e}}_{\\theta} \\frac{1}{r} \\frac{\\partial}{\\partial \\theta} + \\hat{\\boldsymbol{e}}_z \\frac{\\partial}{\\partial z}$。\n平衡磁场由 $\\boldsymbol{B}_0(r) = B_{\\theta}(r)\\,\\hat{\\boldsymbol{e}}_{\\theta}+B_{z}(r)\\,\\hat{\\boldsymbol{e}}_{z}$ 给出。\n因此，方向导数算子为：\n$$\n\\boldsymbol{B}_0\\cdot\\nabla = \\left(B_{\\theta}(r)\\,\\hat{\\boldsymbol{e}}_{\\theta}+B_{z}(r)\\,\\hat{\\boldsymbol{e}}_{z}\\right) \\cdot \\left(\\hat{\\boldsymbol{e}}_r \\frac{\\partial}{\\partial r} + \\hat{\\boldsymbol{e}}_{\\theta} \\frac{1}{r} \\frac{\\partial}{\\partial \\theta} + \\hat{\\boldsymbol{e}}_z \\frac{\\partial}{\\partial z}\\right)\n$$\n利用柱坐标基矢量的正交归一性（$\\hat{\\boldsymbol{e}}_i \\cdot \\hat{\\boldsymbol{e}}_j = \\delta_{ij}$），该算子简化为：\n$$\n\\boldsymbol{B}_0\\cdot\\nabla = \\frac{B_{\\theta}(r)}{r} \\frac{\\partial}{\\partial \\theta} + B_{z}(r) \\frac{\\partial}{\\partial z}\n$$\n这是此推导中使用的主要几何恒等式。\n\n我们将此算子应用于等离子体位移矢量 $\\boldsymbol{\\xi}_{\\perp}$，其形式为：\n$$\n\\boldsymbol{\\xi}_{\\perp}(r,\\theta,z)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{\\perp}(r)\\,\\exp\\!\\big(i\\,[m\\,\\theta+k\\,z]\\big)\n$$\n其中 $\\xi(r)$ 是径向振幅，$\\hat{\\boldsymbol{e}}_{\\perp}(r)$ 是一个仅依赖于径向坐标 $r$ 的单位矢量。因此，矢量部分 $\\xi(r)\\,\\hat{\\boldsymbol{e}}_{\\perp}(r)$ 相对于导数 $\\frac{\\partial}{\\partial \\theta}$ 和 $\\frac{\\partial}{\\partial z}$ 是常数。导数仅作用于指数项。\n$$\n\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp} = \\left(\\frac{B_{\\theta}(r)}{r} \\frac{\\partial}{\\partial \\theta} + B_{z}(r) \\frac{\\partial}{\\partial z}\\right) \\left(\\xi(r)\\,\\hat{\\boldsymbol{e}}_{\\perp}(r)\\,\\exp\\!\\big(i\\,[m\\,\\theta+k\\,z]\\big)\\right)\n$$\n应用链式法则：\n$$\n\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp} = \\xi(r)\\,\\hat{\\boldsymbol{e}}_{\\perp}(r) \\left[ \\left(\\frac{B_{\\theta}(r)}{r}\\right) (i\\,m) + B_{z}(r) (i\\,k) \\right] \\exp\\!\\big(i\\,[m\\,\\theta+k\\,z]\\big)\n$$\n提出虚数单位 $i$：\n$$\n\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp} = i \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right) \\xi(r)\\,\\hat{\\boldsymbol{e}}_{\\perp}(r)\\,\\exp\\!\\big(i\\,[m\\,\\theta+k\\,z]\\big)\n$$\n所得结果是一个复矢量。我们现在计算其模的平方 $|\\cdot|^2$，即该矢量与其复共轭的点积。\n$$\n|\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}|^2 = \\left( \\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp} \\right) \\cdot \\left( \\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp} \\right)^*\n$$\n复共轭是：\n$$\n\\left( \\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp} \\right)^* = -i \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right) \\xi(r)\\,\\hat{\\boldsymbol{e}}_{\\perp}(r)\\,\\exp\\!\\big(-i\\,[m\\,\\theta+k\\,z]\\big)\n$$\n注意 $k$、$m$、$B_z(r)$、$B_{\\theta}(r)$、$\\xi(r)$ 是实数，而 $\\hat{\\boldsymbol{e}}_{\\perp}(r)$ 是实矢量。\n$$\n|\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}|^2 = (-i^2) \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right)^2 [\\xi(r)]^2 \\left( \\hat{\\boldsymbol{e}}_{\\perp}(r) \\cdot \\hat{\\boldsymbol{e}}_{\\perp}(r) \\right) \\left( \\exp(i\\phi) \\exp(-i\\phi) \\right)\n$$\n其中 $\\phi = m\\theta+kz$。\n因为 $\\hat{\\boldsymbol{e}}_{\\perp}(r)$ 是一个单位矢量，所以 $\\hat{\\boldsymbol{e}}_{\\perp}(r) \\cdot \\hat{\\boldsymbol{e}}_{\\perp}(r) = 1$。并且，$\\exp(i\\phi)\\exp(-i\\phi) = 1$ 且 $-i^2 = 1$。\n因此，模的平方的表达式为：\n$$\n|\\boldsymbol{B}_0\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}|^2 = \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right)^2 [\\xi(r)]^2\n$$\n此表达式仅依赖于径向坐标 $r$。\n\n现在，我们将其代入 $\\delta W_{\\text{bend}}$ 的积分中：\n$$\n\\delta W_{\\text{bend}} = \\frac{1}{2\\,\\mu_{0}}\\int_{0}^{a} \\int_{0}^{2\\pi} \\int_{0}^{L} \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right)^2 [\\xi(r)]^2 \\, r \\, dz \\, d\\theta \\, dr\n$$\n被积函数与 $z$ 和 $\\theta$ 无关，因此可以直接对这些变量进行积分：\n$$\n\\int_{0}^{L} dz = L\n$$\n$$\n\\int_{0}^{2\\pi} d\\theta = 2\\pi\n$$\n乘以这些因子，我们得到线弯曲能量的表达式：\n$$\n\\delta W_{\\text{bend}} = \\frac{1}{2\\,\\mu_{0}} (2\\pi L) \\int_{0}^{a} \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right)^2 [\\xi(r)]^2 \\, r \\, dr\n$$\n简化前置因子，得到最终的闭合形式表达式：\n$$\n\\delta W_{\\text{bend}} = \\frac{\\pi L}{\\mu_{0}} \\int_{0}^{a} \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right)^2 [\\xi(r)]^2 \\, r \\, dr\n$$\n此表达式的单位是能量（焦耳），并且只依赖于指定的符号量，径向积分按要求未进行计算。",
            "answer": "$$\n\\boxed{\\frac{\\pi L}{\\mu_{0}} \\int_{0}^{a} \\left( k B_{z}(r) + \\frac{m}{r} B_{\\theta}(r) \\right)^{2} [\\xi(r)]^{2} r \\, dr}\n$$"
        },
        {
            "introduction": "像磁力线弯曲能这样的理论概念，在应用于实际位形时才显示出其重要意义。本练习将一个具有周期性边界条件的等离子体与一个两端“磁力线冻结”的等离子体进行比较，后者模拟了许多实验室实验中的情况。您将明确计算出磁力线冻结条件所施加的额外能量代价，从而证明为何这是一种抑制破坏性扭曲不稳定性的有效机制。",
            "id": "3973929",
            "problem": "考虑一根半径为 $a$、长度为 $L$ 的笔直、理想导电的圆柱形等离子体柱，其端板位于 $z=\\pm L/2$。该等离子体由理想磁流体力学（MHD）描述，MHD 是磁流体力学的缩写。其质量密度恒定，可压缩性可忽略（不可压缩位移）。平衡磁场为\n$$\n\\boldsymbol{B}(r)=B_{z}\\,\\boldsymbol{e}_{z}+B_{\\theta}(r)\\,\\boldsymbol{e}_{\\theta},\n$$\n其中 $B_{z}$ 是均匀的轴向磁场，$B_{\\theta}(r)$ 由均匀的轴向电流密度产生，因此 $B_{\\theta}(r)=B_{\\theta}(a)\\,r/a$。假设位于 $r=a$ 的圆柱形侧壁是理想导电的。位于 $z=\\pm L/2$ 的端板施加了线约束边界条件 $\\boldsymbol{\\xi}=\\boldsymbol{0}$，其中 $\\boldsymbol{\\xi}$ 是等离子体位移。\n\n考虑等离子体柱的一个 $m=1$ 扭曲状刚性平移位移，由下式给出\n$$\n\\boldsymbol{\\xi}(r,\\theta,z)=\\xi_{0}\\Big[\\cos\\theta\\,\\boldsymbol{e}_{r}-\\sin\\theta\\,\\boldsymbol{e}_{\\theta}\\Big]\\,f(z),\n$$\n其振幅 $\\xi_{0}$ 为常数。对于空间周期性的轴向边界条件，取 $f(z)=1$；对于线约束，取\n$$\nf(z)=\\sin\\!\\left(\\frac{\\pi z}{L}\\right).\n$$\n假设不可压缩性 $\\nabla\\cdot\\boldsymbol{\\xi}=0$，并忽略压强和引力效应。在小位移、理想、静态极限下，使用理想磁流体力学能量原理，一阶磁场微扰为 $\\boldsymbol{B}_{1}=\\nabla\\times(\\boldsymbol{\\xi}\\times\\boldsymbol{B})$，势能变化的磁场贡献为\n$$\n\\delta W_{\\mathrm{mag}}=\\frac{1}{2\\mu_{0}}\\int_{V}|\\boldsymbol{B}_{1}|^{2}\\,dV,\n$$\n其中 $\\mu_{0}$ 是真空磁导率，$V$ 是等离子体体积。\n\n仅关注与均匀轴向分量 $B_{z}\\,\\boldsymbol{e}_{z}$ 弯曲相关的能量变化。对于上面给出的试探位移，推导并计算轴向场弯曲能量增量的显式表达式\n$$\n\\Delta \\delta W_{z}\\equiv \\delta W_{z}^{(\\mathrm{line\\text{-}tied})}-\\delta W_{z}^{(\\mathrm{periodic})}.\n$$\n将最终答案表示为包含 $B_{z}$、$\\mu_{0}$、$a$、$L$ 和 $\\xi_{0}$ 的闭合形式解析表达式。结果以焦耳为单位。不需要数值。",
            "solution": "目标是对于给定的等离子体位移，计算线约束情况和周期性情况之间，与均匀轴向磁场分量弯曲相关的磁势能差 $\\Delta \\delta W_{z}$。\n\n根据问题描述，磁势能的变化由下式给出\n$$\n\\delta W_{\\mathrm{mag}}=\\frac{1}{2\\mu_{0}}\\int_{V}|\\boldsymbol{B}_{1}|^{2}\\,dV\n$$\n其中 $\\boldsymbol{B}_{1} = \\nabla\\times(\\boldsymbol{\\xi}\\times\\boldsymbol{B})$ 是磁场的一阶微扰。积分遍及等离子体体积 $V$。\n\n问题要求我们只关注均匀轴向场分量 $\\boldsymbol{B}_z = B_z \\boldsymbol{e}_z$ 弯曲所引起的能量变化。因此，我们只需要计算位移 $\\boldsymbol{\\xi}$ 与 $\\boldsymbol{B}_z$ 相互作用产生的微扰磁场。我们将其记为 $\\boldsymbol{B}_{1,z}$。\n$$\n\\boldsymbol{B}_{1,z} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\boldsymbol{B}_z)\n$$\n使用矢量恒等式 $\\nabla \\times (\\boldsymbol{A} \\times \\boldsymbol{C}) = (\\boldsymbol{C} \\cdot \\nabla)\\boldsymbol{A} - (\\boldsymbol{A} \\cdot \\nabla)\\boldsymbol{C} - \\boldsymbol{C}(\\nabla \\cdot \\boldsymbol{A}) + \\boldsymbol{A}(\\nabla \\cdot \\boldsymbol{C})$，我们可以展开此表达式。问题陈述等离子体位移是不可压缩的，所以 $\\nabla \\cdot \\boldsymbol{\\xi} = 0$。轴向磁场 $\\boldsymbol{B}_z = B_z \\boldsymbol{e}_z$ 是均匀的，所以 $\\nabla \\cdot \\boldsymbol{B}_z = 0$ 且 $(\\boldsymbol{\\xi} \\cdot \\nabla)\\boldsymbol{B}_z = 0$。这极大地简化了 $\\boldsymbol{B}_{1,z}$ 的表达式：\n$$\n\\boldsymbol{B}_{1,z} = (\\boldsymbol{B}_z \\cdot \\nabla)\\boldsymbol{\\xi}\n$$\n在柱坐标系中，$\\boldsymbol{B}_z = B_z \\boldsymbol{e}_z$，所以算子 $(\\boldsymbol{B}_z \\cdot \\nabla)$ 变为 $B_z \\frac{\\partial}{\\partial z}$。\n因此，微扰场为\n$$\n\\boldsymbol{B}_{1,z} = B_z \\frac{\\partial \\boldsymbol{\\xi}}{\\partial z}\n$$\n给定的位移是 $\\boldsymbol{\\xi}(r,\\theta,z)=\\xi_{0}\\Big[\\cos\\theta\\,\\boldsymbol{e}_{r}-\\sin\\theta\\,\\boldsymbol{e}_{\\theta}\\Big]\\,f(z)$。对 $z$ 的偏导数只影响函数 $f(z)$，因为柱坐标基矢量 $\\boldsymbol{e}_r$ 和 $\\boldsymbol{e}_\\theta$ 不依赖于 $z$。\n$$\n\\frac{\\partial \\boldsymbol{\\xi}}{\\partial z} = \\xi_{0}\\Big[\\cos\\theta\\,\\boldsymbol{e}_{r}-\\sin\\theta\\,\\boldsymbol{e}_{\\theta}\\Big]\\,\\frac{df(z)}{dz} = \\xi_{0}\\Big[\\cos\\theta\\,\\boldsymbol{e}_{r}-\\sin\\theta\\,\\boldsymbol{e}_{\\theta}\\Big]\\,f'(z)\n$$\n那么，微扰磁场为\n$$\n\\boldsymbol{B}_{1,z} = B_z \\xi_0 f'(z) \\Big[\\cos\\theta\\,\\boldsymbol{e}_{r}-\\sin\\theta\\,\\boldsymbol{e}_{\\theta}\\Big]\n$$\n接下来，我们计算这个矢量场的模的平方：\n$$\n|\\boldsymbol{B}_{1,z}|^2 = \\boldsymbol{B}_{1,z} \\cdot \\boldsymbol{B}_{1,z} = \\left(B_z \\xi_0 f'(z)\\right)^2 \\Big[\\cos\\theta\\,\\boldsymbol{e}_{r}-\\sin\\theta\\,\\boldsymbol{e}_{\\theta}\\Big] \\cdot \\Big[\\cos\\theta\\,\\boldsymbol{e}_{r}-\\sin\\theta\\,\\boldsymbol{e}_{\\theta}\\Big]\n$$\n矢量部分的点积是 $(\\cos\\theta)(\\cos\\theta) + (-\\sin\\theta)(-\\sin\\theta) = \\cos^2\\theta + \\sin^2\\theta = 1$。\n因此，模的平方是：\n$$\n|\\boldsymbol{B}_{1,z}|^2 = B_z^2 \\xi_0^2 [f'(z)]^2\n$$\n现在，我们可以写出由轴向场弯曲引起的能量变化表达式，我们将其记为 $\\delta W_z$：\n$$\n\\delta W_z = \\frac{1}{2\\mu_0} \\int_V |\\boldsymbol{B}_{1,z}|^2 dV = \\frac{1}{2\\mu_0} \\int_{-L/2}^{L/2} \\int_0^{2\\pi} \\int_0^a B_z^2 \\xi_0^2 [f'(z)]^2 r\\,dr\\,d\\theta\\,dz\n$$\n被积函数与 $r$ 和 $\\theta$ 无关，所以我们可以先进行这两部分的积分。体积元为 $dV = r\\,dr\\,d\\theta\\,dz$。\n$$\n\\int_0^a r\\,dr = \\frac{r^2}{2}\\bigg|_0^a = \\frac{a^2}{2}\n$$\n$$\n\\int_0^{2\\pi} d\\theta = 2\\pi\n$$\n将这些结果代入 $\\delta W_z$ 的表达式中：\n$$\n\\delta W_z = \\frac{B_z^2 \\xi_0^2}{2\\mu_0} \\left( \\frac{a^2}{2} \\right) (2\\pi) \\int_{-L/2}^{L/2} [f'(z)]^2 dz = \\frac{\\pi a^2 B_z^2 \\xi_0^2}{2\\mu_0} \\int_{-L/2}^{L/2} [f'(z)]^2 dz\n$$\n我们现在对两种指定情况计算这个表达式。\n\n情况 1：空间周期性轴向边界条件 ($\\delta W_{z}^{(\\mathrm{periodic})}$)\n对于这种情况，给定 $f(z) = 1$。其导数为 $f'(z) = 0$。\n因此积分为零：\n$$\n\\int_{-L/2}^{L/2} [0]^2 dz = 0\n$$\n这导致 $\\delta W_{z}^{(\\mathrm{periodic})} = 0$。这个结果是符合预期的，因为刚性的、轴向均匀的位移不会弯曲均匀的轴向磁感线。\n\n情况 2：线约束边界条件 ($\\delta W_{z}^{(\\mathrm{line\\text{-}tied})}$)\n对于这种情况，给定 $f(z) = \\sin(\\frac{\\pi z}{L})$。其导数为：\n$$\nf'(z) = \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi z}{L}\\right)\n$$\n我们需要计算 $[f'(z)]^2$ 的积分：\n$$\n\\int_{-L/2}^{L/2} [f'(z)]^2 dz = \\int_{-L/2}^{L/2} \\left[ \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi z}{L}\\right) \\right]^2 dz = \\frac{\\pi^2}{L^2} \\int_{-L/2}^{L/2} \\cos^2\\left(\\frac{\\pi z}{L}\\right) dz\n$$\n使用三角恒等式 $\\cos^2(x) = \\frac{1 + \\cos(2x)}{2}$：\n$$\n\\int_{-L/2}^{L/2} \\cos^2\\left(\\frac{\\pi z}{L}\\right) dz = \\int_{-L/2}^{L/2} \\frac{1}{2} \\left[ 1 + \\cos\\left(\\frac{2\\pi z}{L}\\right) \\right] dz\n$$\n$$\n= \\frac{1}{2} \\left[ z + \\frac{L}{2\\pi} \\sin\\left(\\frac{2\\pi z}{L}\\right) \\right]_{-L/2}^{L/2}\n$$\n$$\n= \\frac{1}{2} \\left[ \\left(\\frac{L}{2} + \\frac{L}{2\\pi}\\sin(\\pi)\\right) - \\left(-\\frac{L}{2} + \\frac{L}{2\\pi}\\sin(-\\pi)\\right) \\right]\n$$\n因为 $\\sin(\\pi) = \\sin(-\\pi) = 0$，这可以简化为：\n$$\n= \\frac{1}{2} \\left[ \\frac{L}{2} - \\left(-\\frac{L}{2}\\right) \\right] = \\frac{1}{2} (L) = \\frac{L}{2}\n$$\n所以，$[f'(z)]^2$ 的积分为：\n$$\n\\int_{-L/2}^{L/2} [f'(z)]^2 dz = \\frac{\\pi^2}{L^2} \\left(\\frac{L}{2}\\right) = \\frac{\\pi^2}{2L}\n$$\n现在，我们将这个结果代回 $\\delta W_z$ 的表达式中：\n$$\n\\delta W_{z}^{(\\mathrm{line\\text{-}tied})} = \\frac{\\pi a^2 B_z^2 \\xi_0^2}{2\\mu_0} \\left( \\frac{\\pi^2}{2L} \\right) = \\frac{\\pi^3 a^2 B_z^2 \\xi_0^2}{4\\mu_0 L}\n$$\n最后，我们计算所需的差值 $\\Delta \\delta W_z$：\n$$\n\\Delta \\delta W_{z} = \\delta W_{z}^{(\\mathrm{line\\text{-}tied})} - \\delta W_{z}^{(\\mathrm{periodic})}\n$$\n$$\n\\Delta \\delta W_{z} = \\frac{\\pi^3 a^2 B_z^2 \\xi_0^2}{4\\mu_0 L} - 0\n$$\n这就得到了轴向场弯曲能量增量的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{\\pi^{3} a^{2} B_{z}^{2} \\xi_{0}^{2}}{4 \\mu_{0} L}}\n$$"
        },
        {
            "introduction": "MHD谱理论的最终目标是计算完整的振荡频率谱，其本征值 $\\lambda$ (与频率的平方 $\\omega^2$ 成正比) 直接决定了等离子体位形是否稳定。本练习通过指导您建立一个数值方案（伽辽金法）来求解该本征值问题，从而架起了理论与计算之间的桥梁。通过将能量原理的积分形式转化为矩阵方程，您将为不同的等离子体剖面计算稳定性本征值，这项技术是现代稳定性分析程序的核心。",
            "id": "3973933",
            "problem": "考虑一个半径为单位长度的直圆形圆柱体中的理想磁流体动力学（MHD）能量原理，其中平衡仅依赖于径向坐标。设等离子体位移的径向分量表示为 $\\xi_r(r)$，其中 $r \\in [0,1]$，并在轴上施加正则性条件，在壁上施加线扎箍条件，即 $\\xi_r(0)$ 为有限值且 $\\xi_r(1)=0$。在从能量原理推导出的标准弱形式中，频率平方本征值 $\\lambda$ 来自以下条件：对于所有满足相同边界条件的容许测试函数 $\\eta(r)$，\n$$\n\\int_0^1 r \\left[ P(r) \\,\\frac{d\\xi_r}{dr}(r)\\,\\frac{d\\eta}{dr}(r) + S(r)\\,\\xi_r(r)\\,\\eta(r) \\right] \\, dr \\;=\\; \\lambda \\int_0^1 r \\,\\rho(r)\\,\\xi_r(r)\\,\\eta(r)\\,dr,\n$$\n其中 $P(r)  0$ 是一个有效的线弯曲刚度系数，$S(r)$ 是一个与压力和曲率效应相关的有效类势能项，而 $\\rho(r)  0$ 是质量密度。该弱形式是 Newcomb 方程在圆柱几何中针对轴对称、径向变化的平衡的广义 Sturm–Liouville 表示。所有量都已无量纲化，因此本征值 $\\lambda$ 是无量纲的。\n\n你的任务是构建一个满足边界条件的伽辽金离散化，并为指定的系数分布数值计算最低的三个本征值。使用以下基函数，这些基函数在 $r=0$ 处强制正则性，并在 $r=1$ 处强制线扎箍：\n$$\n\\phi_k(r) \\;=\\; r\\,(1-r)\\,P_k(2r-1), \\quad k=0,1,\\ldots,N-1,\n$$\n其中 $P_k(\\cdot)$ 表示 $k$ 次勒让德多项式。伽辽金矩阵应为\n$$\nK_{ij} \\;=\\; \\int_0^1 r \\left[ P(r)\\,\\frac{d\\phi_i}{dr}(r)\\,\\frac{d\\phi_j}{dr}(r) + S(r)\\,\\phi_i(r)\\,\\phi_j(r) \\right]\\,dr,\n\\quad\nM_{ij} \\;=\\; \\int_0^1 r\\,\\rho(r)\\,\\phi_i(r)\\,\\phi_j(r)\\,dr,\n$$\n这导致了广义厄米本征问题\n$$\nK \\, \\mathbf{a} \\;=\\; \\lambda \\, M \\, \\mathbf{a},\n$$\n其中 $\\lambda$ 按升序排列。\n\n实现具有足够精度的数值积分来计算这些积分，并使用适用于 $M$ 为正定的厄米对 $(K,M)$ 的对称广义本征求解器。返回每个测试用例的三个最小本征值。\n\n测试套件：\n- 案例1（基线，单调稳定分布）：$N=8$, $P(r)=1.0 + 0.5\\,r^2$, $S(r)=0.2 + 0.1\\,r^2$, $\\rho(r)=1.0$。\n- 案例2（可变密度，近临界势）：$N=8$, $P(r)=1.0 + 0.2\\,r^2$, $S(r)=0.0 - 0.02\\,r^2$, $\\rho(r)=1.0 + 0.3\\,r^2$。\n- 案例3（少数模式，强负势）：$N=4$, $P(r)=1.0 + 2.0\\,r^4$, $S(r)=-0.5 + 0.0\\,r^2$, $\\rho(r)=1.0$。\n\n评估和输出要求：\n- 计算每个案例的三个最小本征值 $\\lambda$。\n- 将所有本征值表示为无量纲浮点数，并四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身就是一个包含三个浮点数的列表。例如，输出必须如下所示：\n$$\n\\texttt{[[\\lambda_{1,1},\\lambda_{1,2},\\lambda_{1,3}],[\\lambda_{2,1},\\lambda_{2,2},\\lambda_{2,3}],[\\lambda_{3,1},\\lambda_{3,2},\\lambda_{3,3}]]}\n$$\n无需附加物理单位；所有量均为无量纲。",
            "solution": "该问题要求计算源于圆柱形等离子体理想磁流体动力学（MHD）能量原理的一个广义 Sturm–Liouville 问题的三个最小本征值 $\\lambda$。该问题以其弱形式表述，这对于有限元或谱分析是标准的。我们的任务是实现一个伽辽金谱方法来解决这个问题。\n\n弱形式由下式给出：\n$$\n\\int_0^1 r \\left[ P(r) \\,\\frac{d\\xi_r}{dr}(r)\\,\\frac{d\\eta}{dr}(r) + S(r)\\,\\xi_r(r)\\,\\eta(r) \\right] \\, dr \\;=\\; \\lambda \\int_0^1 r \\,\\rho(r)\\,\\xi_r(r)\\,\\eta(r)\\,dr\n$$\n这个方程必须对所有与试探函数 $\\xi_r(r)$ 满足相同边界条件的容许测试函数 $\\eta(r)$ 成立。边界条件是在磁轴（$r=0$）处的正则性和在壁（$r=1$）处的线扎箍，这转化为 $\\xi_r(0)$ 为有限值且 $\\xi_r(1)=0$。\n\n伽辽金方法将解 $\\xi_r(r)$ 近似为基函数 $\\phi_j(r)$ 的有限线性组合：\n$$\n\\xi_r(r) \\approx \\sum_{j=0}^{N-1} a_j \\phi_j(r)\n$$\n其中 $a_j$ 是未知系数。测试函数 $\\eta(r)$ 从同一组基函数中选取，即 $\\eta(r) = \\phi_i(r)$，对于 $i=0, 1, \\ldots, N-1$。将这些代入弱形式，得到一个包含 $N$ 个线性方程的系统，可以写成一个广义矩阵本征值问题：\n$$\nK \\, \\mathbf{a} \\;=\\; \\lambda \\, M \\, \\mathbf{a}\n$$\n这里，$\\mathbf{a}$ 是系数向量 $[a_0, a_1, \\ldots, a_{N-1}]^T$，$K$ 和 $M$ 分别是伽辽金刚度矩阵和质量矩阵。它们的元素由以下公式给出：\n$$\nK_{ij} \\;=\\; \\int_0^1 r \\left[ P(r)\\,\\frac{d\\phi_i}{dr}(r)\\,\\frac{d\\phi_j}{dr}(r) + S(r)\\,\\phi_i(r)\\,\\phi_j(r) \\right]\\,dr\n$$\n$$\nM_{ij} \\;=\\; \\int_0^1 r\\,\\rho(r)\\,\\phi_i(r)\\,\\phi_j(r)\\,dr\n$$\n问题指定了要使用的基函数：\n$$\n\\phi_k(r) \\;=\\; r\\,(1-r)\\,P_k(2r-1), \\quad k=0,1,\\ldots,N-1\n$$\n其中 $P_k(\\cdot)$ 是 $k$ 次勒让德多项式。这些基函数的选择很好，因为它们固有地满足边界条件：$\\phi_k(0) = 0 \\cdot (1-0) \\cdot P_k(-1) = 0$ 和 $\\phi_k(1) = 1 \\cdot (1-1) \\cdot P_k(1) = 0$。这正确地施加了在 $r=0$ 处的正则性（通过确保 $\\xi_r(0)=0$）和在 $r=1$ 处的线扎箍条件。\n\n为了构建矩阵 $K$ 和 $M$，我们首先需要基函数的导数。使用乘法法则和链式法则，我们得到：\n$$\n\\frac{d\\phi_k}{dr}(r) = (1-2r)P_k(2r-1) + 2r(1-r)P'_k(2r-1)\n$$\n其中 $P'_k(\\cdot)$ 是勒让德多项式 $P_k(\\cdot)$ 的导数。\n\n对于任意的系数函数 $P(r)$、$S(r)$ 和 $\\rho(r)$，$K_{ij}$ 和 $M_{ij}$ 的积分通常无法解析求解。因此，我们必须采用数值积分。高斯-勒让德积分是积分那些可以被多项式很好地近似的函数的最佳选择。积分规则将 $[-1,1]$ 上的积分近似为 $\\int_{-1}^1 f(x)dx \\approx \\sum_{q=1}^{n_q} w_q f(x_q)$。我们必须将积分域 $[0,1]$ 映射到积分域 $[-1,1]$。变量替换 $r = (x+1)/2$ 得到 $dr = dx/2$。因此，$[0,1]$ 上的积分计算如下：\n$$\n\\int_0^1 g(r)dr = \\int_{-1}^1 g\\left(\\frac{x+1}{2}\\right) \\frac{1}{2} dx \\approx \\sum_{q=1}^{n_q} \\frac{w_q}{2} g\\left(\\frac{x_q+1}{2}\\right)\n$$\n积分点数 $n_q$ 的选择必须确保足够的精度。$K_{ij}$ 和 $M_{ij}$ 的被积函数是系数函数 $P(r)$、$S(r)$、$\\rho(r)$ 与基函数或其导数的乘积。基函数 $\\phi_k(r)$ 是一个关于 $r$ 的 $k+2$ 次多项式。其导数是 $k+1$ 次。对于一个大小为 $N$ 的基，被积函数的最高多项式次数大约是 $\\deg(r) + \\deg(\\text{coeff}) + 2 \\times \\deg(\\phi'_{N-1})$，对于给定的测试用例，这大约是 $1+4+2(N-1+1) = 5+2N$。具有 $n_q$ 个点的高斯-勒让德积分可以精确地积分最高达 $2n_q-1$ 次的多项式。为保守起见并确保高精度，我们选择 $n_q  (5+2N)/2$。一个实际的选择是 $n_q = 2N$，这对于所使用的 $N$ 值（4和8）来说是足够的。\n\n算法如下：\n1.  对于每个测试用例，定义参数 $N$ 和函数 $P(r)$、$S(r)$ 和 $\\rho(r)$。\n2.  为区间 $[0,1]$ 生成 $n_q$ 个高斯-勒让德积分点 $r_q$ 和权重 $w_q$。\n3.  对于从 $0$ 到 $N-1$ 的每个基指数 $k$，在所有积分点 $r_q$ 处计算基函数 $\\phi_k(r)$ 及其导数 $\\frac{d\\phi_k}{dr}(r)$ 的值。\n4.  在所有积分点 $r_q$ 处计算系数函数 $P(r)$、$S(r)$ 和 $\\rho(r)$ 的值。\n5.  将 $N \\times N$ 矩阵 $K$ 和 $M$ 初始化为零。\n6.  遍历 $i$ 从 $0$ 到 $N-1$ 和 $j$ 从 $0$ 到 $N-1$ 来计算每个矩阵元素：\n    -   在每个积分点计算 $K_{ij}$ 和 $M_{ij}$ 的被积函数。\n    -   通过对所有积分点进行加权求和来近似积分。\n7.  由于 $P(r)0$ 和 $\\rho(r)0$，矩阵 $K$ 和 $M$ 将是实对称的，并且 $M$ 将是正定的。使用专门的对称本征求解器（如 `scipy.linalg.eigh`）求解广义本征值问题 $K\\mathbf{a} = \\lambda M\\mathbf{a}$。该函数能高效计算本征值并按升序返回它们。\n8.  提取前三个（最小的）本征值。\n9.  对所有测试用例重复此过程，并按指定格式化结果。\n这个过程为所提出的本征值问题提供了一个稳健且精确的数值解。",
            "answer": "$$\n\\texttt{[[9.020585,55.080516,145.451365],[1.902263,33.003975,99.982260],[-0.347895,30.347318,127.135438]]}\n$$"
        }
    ]
}