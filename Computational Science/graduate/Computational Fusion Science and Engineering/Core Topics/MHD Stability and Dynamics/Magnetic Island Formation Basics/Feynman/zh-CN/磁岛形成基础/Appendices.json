{
    "hands_on_practices": [
        {
            "introduction": "磁撕裂模分析的第一步是确定其发生位置。本练习通过一个给定的安全因子 $q$ 分布，提供了一种计算共振面位置 $r_s$ 的具体方法。通过这个实践，您可以将有理面的抽象概念与等离子体中一个可触摸的空间位置联系起来，这是理解磁岛形成的第一步。",
            "id": "4006721",
            "problem": "考虑一个在电阻磁流体力学（MHD）状态下运行的轴对称环形约束装置，其小半径为 $a=0.50$ 米。磁力线安全因子 $q(r)$ 定义为磁力线环向缠绕与极向缠绕之比，当磁力线经过整数次极向和环向运行后闭合时，便会出现有理面。当 $q(r)$ 等于一个有理数值 $m/n$ 时，就会出现这样一个有理（共振）面，其中 $m$ 和 $n$ 为互质整数。\n\n假设安全因子分布是小半径 $r$ 的二次函数，由 $q(r)=q_0+\\alpha r^2$ 给出，其中 $q_0$ 和 $\\alpha$ 是正常数。对于一个极向模数 $m=2$ 和环向模数 $n=1$ 的撕裂模，请从有理面的基本定义和给定的 $q(r)$ 分布出发，确定 $m/n$ 共振面的径向位置 $r_s$。明确建立在等离子体柱 $0 \\leq r \\leq a$ 内 $r_s$ 存在且唯一的数学条件，然后对 $q_0=1.10$ 和 $\\alpha=10.0$ 米$^{-2}$ 的情况计算 $r_s$ 的值。\n\n将您的最终数值结果四舍五入到 $3$ 位有效数字。以米为单位表示您的最终数值结果。",
            "solution": "该问题陈述具有科学依据，提法恰当，客观，并包含了推导唯一解所需的所有必要信息。安全因子、有理面和撕裂模的概念是环形聚变等离子体中磁流体力学（MHD）的基础。二次安全因子分布是一种常见且有效的近似。所有给定的参数在物理上都是合理的。因此，该问题是有效的，我们可以继续进行求解。\n\n共振（或有理）磁面的基本定义是，在该面的径向位置 $r_s$ 处的安全因子 $q$ 等于一个有理数 $m/n$，其中 $m$ 和 $n$ 分别是极向和环向模数。该条件表示为：\n$$q(r_s) = \\frac{m}{n}$$\n\n问题给出了安全因子作为小半径 $r$ 的函数的特定二次分布：\n$$q(r) = q_0 + \\alpha r^2$$\n其中 $q_0$ 和 $\\alpha$ 是正常数。\n\n为了找到共振面的径向位置 $r_s$，我们将给定的 $q(r)$ 分布代入定义条件中：\n$$q_0 + \\alpha r_s^2 = \\frac{m}{n}$$\n\n现在我们可以求解这个方程得到 $r_s$。整理各项以分离出 $r_s^2$：\n$$\\alpha r_s^2 = \\frac{m}{n} - q_0$$\n$$r_s^2 = \\frac{\\frac{m}{n} - q_0}{\\alpha}$$\n\n由于 $r_s$ 代表一个物理半径，它必须是一个非负实数。我们对 $r_s^2$ 的表达式取正平方根：\n$$r_s = \\sqrt{\\frac{\\frac{m}{n} - q_0}{\\alpha}}$$\n\n接下来，我们建立在等离子体柱（由定义域 $0 \\leq r \\leq a$ 定义）内 $r_s$ 存在且唯一的数学条件。\n\n1.  **实数解的存在性：** 为了使 $r_s$ 为实数，平方根内的参数必须为非负数。\n    $$\\frac{\\frac{m}{n} - q_0}{\\alpha} \\geq 0$$\n    问题陈述 $\\alpha$ 是一个正常数（$\\alpha  0$）。因此，分子也必须为非负数：\n    $$\\frac{m}{n} - q_0 \\geq 0 \\implies \\frac{m}{n} \\geq q_0$$\n    这个条件意味着共振值 $m/n$ 必须大于或等于磁轴处的安全因子（$q_0 = q(0)$）。\n\n2.  **解的唯一性：** 关于 $r_s^2$ 的方程是线性的。如果存在实数解（即满足上述条件），则 $r_s$ 只有一个非负值。因此，如果共振面存在，其位置是唯一的。\n\n3.  **在等离子体柱内的位置：** 共振面必须位于等离子体的物理边界内，$0 \\leq r_s \\leq a$。\n    条件 $r_s \\geq 0$ 已经由第一个条件和取正根得到满足。我们还必须确保 $r_s \\leq a$：\n    $$\\sqrt{\\frac{\\frac{m}{n} - q_0}{\\alpha}} \\leq a$$\n    由于不等式两边都是非负的，我们可以对它们进行平方而不改变不等号的方向：\n    $$\\frac{\\frac{m}{n} - q_0}{\\alpha} \\leq a^2$$\n    乘以 $\\alpha$（为正数）：\n    $$\\frac{m}{n} - q_0 \\leq \\alpha a^2$$\n    $$\\frac{m}{n} \\leq q_0 + \\alpha a^2$$\n    认识到右侧是等离子体边界处的安全因子，$q(a) = q_0 + \\alpha a^2$，该条件变为：\n    $$\\frac{m}{n} \\leq q(a)$$\n\n综合这些条件，当且仅当 $(m, n)$ 撕裂模的有理值 $m/n$ 位于轴上安全因子和边界安全因子之间时，在等离子体柱内存在唯一的共振面：\n$$q_0 \\leq \\frac{m}{n} \\leq q(a)$$\n\n现在，我们使用给定的数值来计算 $r_s$：\n极向模数 $m=2$。\n环向模数 $n=1$。\n轴上安全因子 $q_0 = 1.10$。\n分布参数 $\\alpha = 10.0$ 米$^{-2}$。\n小半径 $a = 0.50$ 米。\n\n首先，我们计算有理值 $m/n$：\n$$\\frac{m}{n} = \\frac{2}{1} = 2$$\n\n接下来，我们验证存在性条件是否满足。\n1.  检查是否 $\\frac{m}{n} \\geq q_0$：\n    $$2 \\geq 1.10$$\n    此条件满足。\n2.  检查是否 $\\frac{m}{n} \\leq q(a)$。我们首先计算 $q(a)$：\n    $$q(a) = q_0 + \\alpha a^2 = 1.10 + (10.0)(0.50)^2 = 1.10 + (10.0)(0.25) = 1.10 + 2.50 = 3.60$$\n    现在，检查条件：\n    $$2 \\leq 3.60$$\n    此条件也满足。\n由于 $1.10 \\leq 2 \\leq 3.60$，在等离子体内存在一个唯一的共振面。\n\n最后，我们计算 $r_s$ 的值：\n$$r_s = \\sqrt{\\frac{\\frac{m}{n} - q_0}{\\alpha}} = \\sqrt{\\frac{2 - 1.10}{10.0}}$$\n$$r_s = \\sqrt{\\frac{0.90}{10.0}} = \\sqrt{0.09}$$\n$$r_s = 0.3 \\text{ 米}$$\n\n问题要求将最终答案四舍五入到 $3$ 位有效数字。数值 $0.3$ 是精确值，因此为了用 $3$ 位有效数字表示，我们写作 $0.300$。",
            "answer": "$$\\boxed{0.300}$$"
        },
        {
            "introduction": "在定位了共振面之后，下一步是理解模式在其紧邻区域的结构。本练习聚焦于“内区电阻层”，这是撕裂模理论中的一个关键概念。通过推导和计算该层的宽度 $\\delta$，您将深入了解电阻起主导作用的物理尺度，并能评估关键的“常数-$\\psi$”近似的有效性。",
            "id": "4006698",
            "problem": "在电阻磁流体力学（RMHD）的框架内，对剪切平板中的单螺旋性电阻撕裂模微扰进行建模。在共振面附近，假设微扰磁通函数在宽度为 $\\delta$ 的狭窄内层中沿板法向坐标 $x$ 变化，并沿着可忽略方向具有平行波数 $k$。从法拉第定律和电阻形式的欧姆定律出发，并利用内层中的 RMHD 标度关系 $\\partial^{2}/\\partial x^{2} \\gg k^{2}$，通过在感应方程中平衡线性时间增长和电阻扩散，推导内电阻层宽度 $\\delta$ 的标度关系。使用此标度关系计算给定参数下的 $\\delta$，然后通过构建比率 $r \\equiv \\delta/w$ 来量化常数-$\\psi$ 近似的有效性，其中 $w$ 是磁岛半宽。\n\n使用以下数据，均为国际单位制：\n- 磁扩散率 $\\eta = 2.0 \\times 10^{-3}\\ \\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$，\n- 线性增长率 $\\gamma = 3.00 \\times 10^{2}\\ \\mathrm{s}^{-1}$，\n- 波数 $k = 1.00 \\times 10^{1}\\ \\mathrm{m}^{-1}$，\n- 磁岛半宽 $w = 1.00 \\times 10^{-2}\\ \\mathrm{m}$。\n\n报告无量纲数 $r = \\delta/w$，四舍五入到三位有效数字。陈述推导过程中所做的任何物理假设。最终报告值中不包含任何单位。如果在你的推理中出现任何角度度量，应以弧度为单位，但最终数字中不需要角度。",
            "solution": "用户希望基于计算聚变科学与工程的原理解决一个问题。\n\n### 第1步：提取已知条件\n- **模型**：电阻磁流体力学（RMHD）框架下，剪切平板中的单螺旋性电阻撕裂模微扰。\n- **物理背景**：一个宽度为 $\\delta$ 的狭窄内层，横跨板法向坐标 $x$，并沿可忽略方向具有平行波数 $k$。\n- **控制方程**：Faraday定律和电阻形式的Ohm定律。\n- **近似**：RMHD 标度关系 $\\partial^2/\\partial x^2 \\gg k^2$ 在内层中有效。\n- **任务1**：通过平衡感应方程中的线性时间增长和电阻扩散，推导内电阻层宽度 $\\delta$ 的标度关系。\n- **任务2**：使用推导的标度关系和给定参数计算 $\\delta$。\n- **任务3**：通过计算比率 $r \\equiv \\delta/w$ 来量化常数-$\\psi$ 近似的有效性。\n- **数据**：\n  - 磁扩散率：$\\eta = 2.0 \\times 10^{-3}\\ \\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n  - 线性增长率：$\\gamma = 3.00 \\times 10^{2}\\ \\mathrm{s}^{-1}$\n  - 波数：$k = 1.00 \\times 10^{1}\\ \\mathrm{m}^{-1}$\n  - 磁岛半宽：$w = 1.00 \\times 10^{-2}\\ \\mathrm{m}$\n- **报告要求**：报告无量纲数 $r = \\delta/w$，四舍五入到三位有效数字。陈述物理假设。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学上基于等离子体物理学中电阻撕裂模的标准理论，这是磁流体力学和聚变研究的基石。问题陈述清晰，目标明确，并提供了实现目标所需的所有数据。这些物理量及其数值对于实验室等离子体是符合物理现实的。该问题要求推导一个标准的标度律并进行后续计算，这是一项有效且客观的科学实践。没有发现任何缺陷。\n\n- **科学依据**：该问题使用了来自RMHD的标准概念（撕裂模、磁扩散率、增长率、常数-$\\psi$ 近似）。\n- **陈述清晰**：问题陈述明确，可以根据提供的信息确定唯一解。\n- **客观性**：语言技术性强，不含主观性。\n- **完整性**：提供了所需计算的所有必要参数（$\\eta$、$\\gamma$、$w$）。\n- **真实性**：提供的数值对于等离子体实验是物理上合理的。\n\n### 第3步：结论与行动\n问题是**有效的**。将提供完整解答。\n\n### 解答推导\n\n问题要求通过平衡感应方程中的特定项来推导内电阻层宽度 $\\delta$ 的标度关系。感应方程由Faraday定律和电阻Ohm定律推导而来，它控制着磁场 $\\mathbf{B}$ 的演化。在撕裂模的背景下，我们关心的是小微扰的演化，特别是微扰磁通函数，我们记为 $\\tilde{\\psi}$。\n\n问题指导我们平衡线性时间增长和电阻扩散。对于微扰磁通函数 $\\tilde{\\psi}$ 的线性化感应方程，在其最简形式下，仅保留电阻层内的这些主导项，是一个扩散方程：\n$$\n\\frac{\\partial \\tilde{\\psi}}{\\partial t} = \\eta \\nabla^2 \\tilde{\\psi}\n$$\n此处，$\\eta$ 是磁扩散率，假设其为均匀的。\n\n我们对此方程进行标度分析。假设微扰随时间呈指数增长，其特征是线性增长率 $\\gamma$。因此，时间导数算子的标度为：\n$$\n\\frac{\\partial}{\\partial t} \\sim \\gamma\n$$\n微扰的空间变化由拉普拉斯算子 $\\nabla^2$ 描述。在所述的平板几何中，$x$ 是垂直于电流片的坐标，$y$ 是沿可忽略方向的坐标，拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。微扰在 $y$ 方向的波数为 $k$，因此 $\\frac{\\partial^2}{\\partial y^2} \\sim -k^2$。问题指出，在内层内部，$x$ 方向的变化非常剧烈，这被形式化为 RMHD 标度关系 $\\frac{\\partial^2}{\\partial x^2} \\gg k^2$。$x$ 方向变化的特征长度尺度是内层宽度 $\\delta$。因此，空间导数的标度为：\n$$\n\\frac{\\partial}{\\partial x} \\sim \\frac{1}{\\delta} \\implies \\frac{\\partial^2}{\\partial x^2} \\sim \\frac{1}{\\delta^2}\n$$\n根据该标度关系，我们可以将拉普拉斯算子的标度近似为：\n$$\n\\nabla^2 \\approx \\frac{\\partial^2}{\\partial x^2} \\sim \\frac{1}{\\delta^2}\n$$\n现在，我们根据它们的标度来平衡简化后的感应方程中的各项：\n$$\n\\underbrace{\\frac{\\partial \\tilde{\\psi}}{\\partial t}}_{\\sim \\gamma \\tilde{\\psi}} \\sim \\underbrace{\\eta \\nabla^2 \\tilde{\\psi}}_{\\sim \\eta \\frac{1}{\\delta^2} \\tilde{\\psi}}\n$$\n这导出了标度关系：\n$$\n\\gamma \\sim \\frac{\\eta}{\\delta^2}\n$$\n对内电阻层宽度 $\\delta$ 求解，我们得到所期望的标度律：\n$$\n\\delta^2 \\sim \\frac{\\eta}{\\gamma} \\implies \\delta \\sim \\sqrt{\\frac{\\eta}{\\gamma}}\n$$\n为了估算，我们将此标度关系视为等式。\n\n此推导中做出的主要物理假设是：\n1. 内电阻层内的动力学主要由时间增长率和电阻扩散之间的平衡所主导。这种简化忽略了流体运动项 $\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})$，在完整的撕裂模分析中，该项与动量方程耦合，是驱动不稳定性所必需的。然而，问题明确指示采用这种简化的平衡。\n2. 磁扩散率 $\\eta$ 是一个均匀的标量常数。\n3. 微扰具有一个特征线性增长率 $\\gamma$。\n4. 该层是“薄”的，意味着其宽度 $\\delta$ 远小于微扰沿该层的波长，这证明了近似 $\\nabla^2 \\approx \\partial^2/\\partial x^2$ 的合理性。\n\n现在，我们可以使用提供的数据计算 $\\delta$ 的值：\n- $\\eta = 2.0 \\times 10^{-3}\\ \\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- $\\gamma = 3.00 \\times 10^{2}\\ \\mathrm{s}^{-1}$\n\n$$\n\\delta = \\sqrt{\\frac{2.0 \\times 10^{-3}}{3.00 \\times 10^{2}}} = \\sqrt{\\frac{2.0}{3.00} \\times 10^{-5}} = \\sqrt{0.666... \\times 10^{-5}} = \\sqrt{6.666... \\times 10^{-6}}\\ \\mathrm{m}\n$$\n$$\n\\delta \\approx 2.581988... \\times 10^{-3}\\ \\mathrm{m}\n$$\n问题要求通过计算比率 $r = \\delta/w$ 来量化常数-$\\psi$ 近似的有效性。当电阻层宽度 $\\delta$ 远小于外部理想区域的特征尺度时，常数-$\\psi$ 近似是有效的，而这个特征尺度与磁岛半宽 $w$ 相关。一个小的比率 $r \\ll 1$ 表明该近似是充分合理的。\n\n使用给定的磁岛半宽 $w = 1.00 \\times 10^{-2}\\ \\mathrm{m}$：\n$$\nr = \\frac{\\delta}{w} = \\frac{2.581988... \\times 10^{-3}\\ \\mathrm{m}}{1.00 \\times 10^{-2}\\ \\mathrm{m}} = 0.2581988...\n$$\n按照要求将结果四舍五入到三位有效数字，我们得到：\n$$\nr \\approx 0.258\n$$\n这个值小于1，表明常数-$\\psi$ 近似具有一定的有效性，尽管它不是非常小，这说明该近似是临界的。这在物理上是现实的。波数 $k=10.0\\ \\mathrm{m}^{-1}$ 与薄层近似一致，因为它意味着 $1/\\delta^2 \\approx 1/(6.67 \\times 10^{-6}) \\approx 1.5 \\times 10^5\\ \\mathrm{m}^{-2}$ 而 $k^2 = 100\\ \\mathrm{m}^{-2}$，满足 $1/\\delta^2 \\gg k^2$。",
            "answer": "$$\n\\boxed{0.258}\n$$"
        },
        {
            "introduction": "在线性稳定性概念的基础上，这最后一个实践将进入非线性阶段，该阶段描述了磁岛如何随时间实际增长和饱和。您将为一个广泛使用的岛演化模型——修正的卢瑟福方程（Modified Rutherford Equation, MRE）——实现一个数值求解器。本练习弥合了简化理论与在实验和大规模模拟中观察到的复杂动力学之间的差距。",
            "id": "4006709",
            "problem": "你的任务是开发一个完整、可运行的程序，通过对简化无量纲形式的修正卢瑟福方程（MRE）进行时间步进求解，来计算无量纲磁岛半宽 $w(\\tau)$ 的演化，并将计算结果与为三种情况提供的代表非线性磁流体力学（MHD）模拟数据的基准输出进行比较。目标是展示一种源于计算聚变科学与工程领域可靠物理基础的算法，并量化其预测精度。\n\n科学背景与基本原理：磁岛源于电阻磁流体力学（MHD）中的撕裂模。在长时间尺度上，有理面上的磁岛动力学由电阻重联驱动和新经典效应之间的平衡所控制。修正卢瑟福方程（MRE）在经典卢瑟福模型的基础上进行了重新表述，加入了诸如自举电流驱动和极化电流稳定效应以及曲率/剪切效应等附加项，从而得到了一个易于处理的磁岛半宽演化方程。在无量纲形式下，使用以电阻扩散时间 $\\tau_{R} = \\mu_{0} a^{2} / \\eta$（其中 $\\mu_{0}$ 为真空磁导率，$a$ 为小半径，$\\eta$ 为等离子体电阻率）归一化的时间，以及以小半径 $a$ 归一化的宽度，MRE可模型化为\n$$\n\\frac{d w}{d \\tau} = \\Delta' + \\frac{C_{\\mathrm{bs}}}{w} \\tanh\\!\\left(\\frac{w}{w_{c}}\\right) - \\frac{C_{\\mathrm{pol}}}{w^{3}} - C_{\\mathrm{curv}} \\, w,\n$$\n其中 $w$ 是无量纲磁岛半宽，$\\tau$ 是无量纲时间，$\\Delta'$ 是无量纲撕裂驱动，$C_{\\mathrm{bs}}$ 是捕捉新经典驱动的自举电流系数，$C_{\\mathrm{pol}}$ 是在小 $w$ 时很重要的极化电流稳定系数，$C_{\\mathrm{curv}}$ 是随 $w$ 增长的曲率/剪切稳定系数，$w_{c}$ 是一个有限香蕉宽度尺度，用于在磁岛增长时对自举驱动进行正则化。这种表示方法通常用于捕捉电阻MHD和新经典机制中驱动与稳定项之间的定性平衡，而无需引入不切实际或未经检验的物理。本问题中所有量均为无量纲。\n\n数值设计要求：你必须从常微分方程 $d w / d \\tau = F(w)$ 的基本定义和初值问题的数值积分定义出发，推导并实现一个显式、稳定的时间步进格式。使用固定步长的显式四阶Runge–Kutta方法对 $w(\\tau)$进行时间前进积分，并通过施加 $w \\ge \\varepsilon$（其中 $\\varepsilon$ 是一个小的正数）来确保数值正则化，从而使除以 $w$ 和 $w^{3}$ 的运算结果保持有限。磁岛半宽 $w$ 在任何时候都必须为非负数。\n\n比较要求：对于每种基准情况，你都会获得一个离散的时间序列及对应的无量纲磁岛半宽，它们代表了非线性MHD模拟的输出。你必须在这些相同的时间点计算模型预测的 $w(\\tau)$，并量化平均绝对相对误差（MARE）。对于一组时间 $\\{\\tau_{i}\\}$及其对应的宽度 $\\{w_{i}^{\\mathrm{model}}\\}$ 和 $\\{w_{i}^{\\mathrm{bench}}\\}$，MARE定义为\n$$\n\\mathrm{MARE} = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\left| w_{i}^{\\mathrm{model}} - w_{i}^{\\mathrm{bench}} \\right|}{\\max\\!\\left(w_{i}^{\\mathrm{bench}}, \\varepsilon\\right)},\n$$\n其中 $N$ 是比较点的数量，$\\varepsilon$ 是用于防止除以零的同一个小的正则化常数。所有量均为无量纲。每种情况的平均绝对相对误差必须以浮点数形式报告。\n\n时间网格和输出规范：对于所有情况，在整数时间 $\\tau \\in \\{\\, 0, 1, 2, \\ldots, 10 \\,\\}$ 进行评估。积分使用固定时间步长 $\\Delta \\tau = 10^{-3}$。最终输出必须是单行文本，内容为一个包含三个浮点数的逗号分隔列表，每个数值四舍五入到六位小数，并用方括号括起来，顺序如下面的情况所示。\n\n测试套件和基准情况：\n- 情况A（不稳定驱动，因曲率效应饱和）：\n  - 参数：$\\Delta' = 0.3$, $C_{\\mathrm{bs}} = 0.015$, $C_{\\mathrm{pol}} = 10^{-6}$, $C_{\\mathrm{curv}} = 0.05$, $w_{c} = 0.02$, 初始宽度 $w(0) = 0.005$。\n  - 基准时间：$\\tau \\in \\{\\, 0, 1, 2, \\ldots, 10 \\,\\}$。\n  - 基准宽度（无量纲）：$[\\, 0.005, 0.012, 0.022, 0.034, 0.048, 0.063, 0.078, 0.092, 0.104, 0.113, 0.119 \\,]$。\n- 情况B（小饱和状态下的近阈值行为）：\n  - 参数：$\\Delta' = 0.05$, $C_{\\mathrm{bs}} = 0.01$, $C_{\\mathrm{pol}} = 3 \\times 10^{-5}$, $C_{\\mathrm{curv}} = 0.08$, $w_{c} = 0.015$, 初始宽度 $w(0) = 0.006$。\n  - 基准时间：$\\tau \\in \\{\\, 0, 1, 2, \\ldots, 10 \\,\\}$。\n  - 基准宽度（无量纲）：$[\\, 0.006, 0.007, 0.009, 0.011, 0.013, 0.0145, 0.0155, 0.016, 0.0164, 0.0166, 0.0167 \\,]$。\n- 情况C（由于负撕裂驱动和强稳定效应导致的稳定、衰减的磁岛）：\n  - 参数：$\\Delta' = -0.15$, $C_{\\mathrm{bs}} = 0.01$, $C_{\\mathrm{pol}} = 10^{-4}$, $C_{\\mathrm{curv}} = 0.10$, $w_{c} = 0.02$, 初始宽度 $w(0) = 0.01$。\n  - 基准时间：$\\tau \\in \\{\\, 0, 1, 2, \\ldots, 10 \\,\\}$。\n  - 基准宽度（无量纲）：$[\\, 0.01, 0.009, 0.0078, 0.0066, 0.0055, 0.0046, 0.0038, 0.0031, 0.0026, 0.0022, 0.0019 \\,]$。\n\n程序要求：\n- 实现一个函数来计算MRE的右侧项 $F(w)$。\n- 实现一个固定步长 $\\Delta \\tau = 10^{-3}$ 的显式四阶Runge–Kutta方法，积分范围从 $\\tau = 0$ 到 $\\tau = 10$。在所有步骤中强制 $w \\ge \\varepsilon$，其中 $\\varepsilon = 10^{-9}$，以防止除零错误。\n- 对每种情况，计算在指定时间点的 $w(\\tau)$，并根据提供的基准宽度评估平均绝对相对误差（MARE）。\n- 你的程序应该产生单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[\\, \\text{resultA}, \\text{resultB}, \\text{resultC} \\,]$），其中每个值都四舍五入到六位小数。\n所有量都是无量纲的；不需要物理单位。没有使用角度。为此次计算基准测试之目的，基准数组代表了非线性磁流体力学（MHD）模拟的无量纲输出。",
            "solution": "该问题要求对无量纲形式的修正卢瑟福方程（MRE）进行数值积分，以模拟磁岛半宽 $w(\\tau)$ 的时间演化。解将使用四阶Runge-Kutta（RK4）方法获得。然后将结果与提供的基准数据进行比较，通过平均绝对相对误差（MARE）来评估模型的准确性。\n\n关于磁岛半宽 $w$ 作为无量纲时间 $\\tau$ 函数的控制常微分方程（ODE）如下：\n$$\n\\frac{d w}{d \\tau} = \\Delta' + \\frac{C_{\\mathrm{bs}}}{w} \\tanh\\!\\left(\\frac{w}{w_{c}}\\right) - \\frac{C_{\\mathrm{pol}}}{w^{3}} - C_{\\mathrm{curv}} \\, w\n$$\n该方程模拟了几个物理效应的平衡：\n- $\\Delta'$：经典撕裂模稳定性指数，代表了从平衡磁场梯度中可获得的自由能。正的 $\\Delta'$ 驱动磁岛增长。\n- $\\frac{C_{\\mathrm{bs}}}{w} \\tanh\\!\\left(\\frac{w}{w_{c}}\\right)$：自举电流的贡献。该项通常是不稳定的（$C_{\\mathrm{bs}}  0$），是新经典撕裂模（NTM）的一个关键特征。$\\tanh$ 函数及尺度 $w_c$ 模拟了当磁岛宽度大于离子香蕉宽度时此效应的饱和。\n- $\\frac{C_{\\mathrm{pol}}}{w^{3}}$：源于极化電流的稳定项，在非常小的磁岛宽度下变得显著，并可能为NTM的触发创建一个阈值。\n- $C_{\\mathrm{curv}} \\, w$：一个与磁力线曲率和磁剪切效应相关的稳定项，随着磁岛宽度 $w$ 的增加而变得更加主导。\n\n该问题是一个形如 $\\frac{dw}{d\\tau} = F(w)$ 的初值问题，初始条件为 $w(\\tau=0) = w_0$。由于右端项 $F(w)$ 不显式地依赖于时间 $\\tau$，该ODE是自治的。我们的任务是使用固定时间步长 $\\Delta\\tau = 10^{-3}$ 的显式四阶Runge-Kutta（RK4）方法求解此ODE。\n\nRK4方法将解从时间 $\\tau_n$ 推进到 $\\tau_{n+1} = \\tau_n + \\Delta\\tau$，如下所示：\n$$\n\\begin{aligned}\nk_1 = \\Delta\\tau \\, F(w_n) \\\\\nk_2 = \\Delta\\tau \\, F(w_n + \\frac{1}{2} k_1) \\\\\nk_3 = \\Delta\\tau \\, F(w_n + \\frac{1}{2} k_2) \\\\\nk_4 = \\Delta\\tau \\, F(w_n + k_3) \\\\\nw_{n+1} = w_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\n其中 $w_n$ 是 $w(\\tau_n)$ 的数值近似。\n\n数值实现的一个关键方面是处理当 $w \\to 0$ 时 $C_{\\mathrm{bs}}/w$ 和 $C_{\\mathrm{pol}}/w^3$ 项中的奇点。问题规定了一种正则化方案，其中磁岛宽度 $w$ 由一个小的正常数 $\\varepsilon = 10^{-9}$ 作为下界。为保证鲁棒性，这分两个阶段实现：\n1.  在计算ODE右端项的函数 $F(w)$ 内部，输入宽度 $w$ 在用于任何涉及除法的计算之前，首先被正则化为 $w_{\\mathrm{reg}} = \\max(w, \\varepsilon)$。这确保了RK4步骤中的中间评估（例如 $F(w_n + k_1/2)$）即使参数变为零或负数也不会导致浮点异常。\n2.  在每个完整的RK4步骤之后，新计算出的宽度 $w_{n+1}$ 也被限制：$w_{n+1} \\leftarrow \\max(w_{n+1}, \\varepsilon)$。这保证了磁岛宽度保持物理性（非负），并为后续时间步提供正则化的输入。\n\n积分从 $\\tau=0$ 到 $\\tau=10$ 对三种不同的情况执行，每种情况都有一组特定的参数 $\\{\\Delta', C_{\\mathrm{bs}}, C_{\\mathrm{pol}}, C_{\\mathrm{curv}}, w_c\\}$ 和一个初始宽度 $w(0)$。模型预测的宽度 $w^{\\mathrm{model}}$ 在整数时间 $\\tau_i \\in \\{0, 1, 2, \\ldots, 10\\}$ 被记录下来。\n\n模型的准确性由平均绝对相对误差（MARE）量化，它在 $N=11$ 个时间点上比较模型结果 $w_{i}^{\\mathrm{model}}$ 与提供的基准数据 $w_{i}^{\\mathrm{bench}}$。MARE定义为：\n$$\n\\mathrm{MARE} = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\left| w_{i}^{\\mathrm{model}} - w_{i}^{\\mathrm{bench}} \\right|}{\\max\\!\\left(w_{i}^{\\mathrm{bench}}, \\varepsilon\\right)}\n$$\n在分母中使用 $\\max(w_{i}^{\\mathrm{bench}}, \\varepsilon)$ 提供了对除零错误的鲁棒性，以防基准数据点接近于零。\n\n算法流程如下：\n1.  对于三个测试用例中的每一个，用给定的初始条件 $w(0)$ 初始化磁岛宽度 $w$。将此作为第一个数据点 $w^{\\mathrm{model}}_0$ 存储。\n2.  以 $\\Delta\\tau = 10^{-3}$ 的步长迭代 $10 / 10^{-3} = 10000$ 步，以达到 $\\tau=10$。\n3.  在每一步中，使用RK4格式计算新的宽度 $w_{n+1}$。\n4.  如果当前时间步对应于一个整数时间 $\\tau \\in \\{1, 2, \\ldots, 10\\}$，则存储计算出的宽度 $w$。\n5.  积分完成后，使用收集到的模型宽度集和相应的基准宽度，为该情况计算单个MARE值。\n6.  对所有三种情况重复此过程，并以指定格式报告所得的MARE值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the evolution of the magnetic island half-width by solving the\n    Modified Rutherford Equation and calculates the Mean Absolute Relative Error\n    against benchmark data for three test cases.\n    \"\"\"\n\n    # --- Constants and Numerical Parameters ---\n    epsilon = 1e-9\n    dt = 1e-3\n    t_start = 0.0\n    t_end = 10.0\n    n_steps = int((t_end - t_start) / dt)\n    output_interval = int(1.0 / dt)\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"params\": {\n                'delta_prime': 0.3,\n                'c_bs': 0.015,\n                'c_pol': 1e-6,\n                'c_curv': 0.05,\n                'w_c': 0.02\n            },\n            \"w0\": 0.005,\n            \"bench_widths\": np.array([0.005, 0.012, 0.022, 0.034, 0.048, 0.063, 0.078, 0.092, 0.104, 0.113, 0.119])\n        },\n        {\n            \"name\": \"Case B\",\n            \"params\": {\n                'delta_prime': 0.05,\n                'c_bs': 0.01,\n                'c_pol': 3e-5,\n                'c_curv': 0.08,\n                'w_c': 0.015\n            },\n            \"w0\": 0.006,\n            \"bench_widths\": np.array([0.006, 0.007, 0.009, 0.011, 0.013, 0.0145, 0.0155, 0.016, 0.0164, 0.0166, 0.0167])\n        },\n        {\n            \"name\": \"Case C\",\n            \"params\": {\n                'delta_prime': -0.15,\n                'c_bs': 0.01,\n                'c_pol': 1e-4,\n                'c_curv': 0.10,\n                'w_c': 0.02\n            },\n            \"w0\": 0.01,\n            \"bench_widths\": np.array([0.01, 0.009, 0.0078, 0.0066, 0.0055, 0.0046, 0.0038, 0.0031, 0.0026, 0.0022, 0.0019])\n        }\n    ]\n\n    def mre_rhs(w, params, eps):\n        \"\"\"\n        Computes the right-hand side of the Modified Rutherford Equation F(w).\n        \"\"\"\n        w_reg = max(w, eps)\n        \n        delta_prime_term = params['delta_prime']\n        bootstrap_term = params['c_bs'] / w_reg * np.tanh(w_reg / params['w_c'])\n        polarization_term = params['c_pol'] / (w_reg**3)\n        curvature_term = params['c_curv'] * w_reg\n        \n        return delta_prime_term + bootstrap_term - polarization_term - curvature_term\n\n    def rk4_step(w, params, step_size, eps):\n        \"\"\"\n        Performs a single explicit fourth-order Runge-Kutta step.\n        \"\"\"\n        k1 = step_size * mre_rhs(w, params, eps)\n        k2 = step_size * mre_rhs(w + 0.5 * k1, params, eps)\n        k3 = step_size * mre_rhs(w + 0.5 * k2, params, eps)\n        k4 = step_size * mre_rhs(w + k3, params, eps)\n        \n        w_new = w + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n        \n        return max(w_new, eps)\n\n    def calculate_mare(model_widths, bench_widths, eps):\n        \"\"\"\n        Calculates the Mean Absolute Relative Error (MARE).\n        \"\"\"\n        errors = np.abs(model_widths - bench_widths) / np.maximum(bench_widths, eps)\n        return np.mean(errors)\n\n    mare_results = []\n    \n    for case in test_cases:\n        params = case['params']\n        w = case['w0']\n        bench_widths = case['bench_widths']\n        \n        model_widths = [w]\n        \n        # Time integration loop\n        for step in range(1, n_steps + 1):\n            w = rk4_step(w, params, dt, epsilon)\n            \n            # Store result at integer time points\n            if step % output_interval == 0:\n                model_widths.append(w)\n        \n        # Convert to numpy array for calculation\n        model_widths_np = np.array(model_widths)\n        \n        # Calculate and store MARE\n        mare = calculate_mare(model_widths_np, bench_widths, epsilon)\n        mare_results.append(mare)\n\n    # Format and print the final results\n    formatted_results = [f\"{r:.6f}\" for r in mare_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}