{
    "hands_on_practices": [
        {
            "introduction": "Understanding the fundamental dynamics of how a magnetic field penetrates a conducting structure is the cornerstone of resistive wall physics. This first practice guides you through the derivation of the governing equation for magnetic flux penetration in a simplified, yet powerful, thin-shell model. By analyzing the system's response to a sudden change in the external magnetic field, you will derive and apply the crucial concept of the resistive wall time constant, $\\tau_w$, which characterizes the timescale for eddy currents in the wall to decay and for the external field to leak through. ",
            "id": "3979872",
            "problem": "Consider a thin, uniform, resistive cylindrical wall of mean radius $a$ and thickness $d$ that surrounds a vacuum region in a fusion device. The wall has electrical conductivity $\\sigma$ and supports a single non-axisymmetric magnetic perturbation harmonic. Let $\\psi(t)$ denote the poloidal magnetic flux linking a closed contour just inside the wall, and let $\\psi_{\\text{ext}}(t)$ denote the poloidal magnetic flux that would be present at that contour in the absence of the wall (i.e., the externally applied perturbation). Assume the perturbation varies slowly enough along the toroidal and poloidal directions that a thin-shell, single-mode, lumped description is valid.\n\nStarting from fundamental electromagnetic laws—Faraday’s law ($\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$) and Ohm’s law ($\\mathbf{J} = \\sigma \\mathbf{E}$)—and using the thin-shell approximation for the wall so that the tangential electric field $E_{t}$ produces a surface current density $K$ satisfying $K = \\sigma d\\,E_{t}$, derive the evolution of $\\psi(t)$ in response to a step change in the external flux. Introduce a geometric inductance parameter $L_{s}$ that linearly relates the difference between the external and internal flux to the net circulating wall current $I_{w}$ via $\\psi_{\\text{ext}}(t) - \\psi(t) = L_{s}\\,I_{w}(t)$, where $I_{w}(t)$ is the total current encircling the wall in the direction aligned with the tangential electric field.\n\nThe external flux is stepped at $t = 0$ from zero to a constant value $\\psi_{0}$, i.e., $\\psi_{\\text{ext}}(t) = \\psi_{0}\\,H(t)$ where $H(t)$ is the Heaviside step function. The system is initially unperturbed, with $\\psi(0^{-}) = 0$ and $I_{w}(0^{-}) = 0$. Define the resistive-wall characteristic time $\\tau_{w}$ in terms of the wall material and geometry, and compute the complete time response $\\psi(t)$ for $t \\ge 0$. Show from first principles that the internal flux approaches the external flux with the characteristic time $\\tau_{w}$.\n\nExpress the final $\\psi(t)$ in Webers as a closed-form analytic expression in terms of $\\psi_{0}$, $t$, and $\\tau_{w}$. No numerical rounding is required.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- **System:** A thin, uniform, resistive cylindrical wall.\n- **Geometric Parameters:** Mean radius $a$, thickness $d$.\n- **Material Property:** Electrical conductivity $\\sigma$.\n- **Physical Quantities/Variables:**\n    - Poloidal magnetic flux inside the wall: $\\psi(t)$.\n    - External poloidal magnetic flux: $\\psi_{\\text{ext}}(t)$.\n    - Tangential electric field in the wall: $E_{t}$.\n    - Surface current density: $K$.\n    - Total circulating wall current: $I_{w}(t)$.\n- **Fundamental Laws:**\n    - Faraday’s law: $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$.\n    - Ohm’s law: $\\mathbf{J} = \\sigma \\mathbf{E}$.\n- **Model-Specific Relations:**\n    - Thin-shell current: $K = \\sigma d E_{t}$.\n    - Inductance relation: $\\psi_{\\text{ext}}(t) - \\psi(t) = L_{s} I_{w}(t)$, where $L_{s}$ is a geometric inductance parameter.\n- **Forcing Function:** $\\psi_{\\text{ext}}(t) = \\psi_{0} H(t)$, where $\\psi_0$ is a constant and $H(t)$ is the Heaviside step function.\n- **Initial Conditions:** $\\psi(0^{-}) = 0$ and $I_{w}(0^{-}) = 0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly rooted in classical electromagnetism and employs a standard, widely accepted thin-shell model used in plasma physics and fusion engineering to study magnetic field penetration and stability (e.g., Resistive Wall Modes). The concepts and relations are fundamental to the field. The problem is scientifically sound.\n- **Well-Posedness:** The problem specifies a system governed by physical laws that can be formulated as a first-order linear ordinary differential equation. It provides a well-defined forcing function and consistent initial conditions, ensuring that a unique, stable, and meaningful solution exists. The problem is well-posed.\n- **Objectivity:** The problem is formulated with precise, unambiguous, and standard terminology from physics and engineering. It is free from subjective assertions.\n\n**Verdict**\nThe problem is valid as it is scientifically grounded, well-posed, and objective. It contains all necessary information to derive a unique solution based on first principles as requested.\n\n**Derivation of the Governing Equation**\nWe begin with the integral form of Faraday's Law of Induction, applied to a closed contour $C$ lying just inside the resistive wall, in the vacuum region. The magnetic flux linking this contour is $\\psi(t)$.\n$$\n\\oint_C \\mathbf{E} \\cdot d\\mathbf{l} = -\\frac{d}{dt} \\int_S \\mathbf{B} \\cdot d\\mathbf{A} = -\\frac{d\\psi(t)}{dt}\n$$\nThe left side of the equation is the electromotive force (EMF) induced around the loop. This EMF is what drives the current $I_w(t)$ within the resistive wall. The wall presents a total resistance $R_w$ to the flow of this current. By Ohm's law, the EMF must be equal to the product of the current and the resistance. In this lumped-parameter model, we have:\n$$\n\\oint_C \\mathbf{E} \\cdot d\\mathbf{l} = I_w(t) R_w\n$$\nIt is worth noting that the tangential electric field $E_t$ inside the wall is responsible for the surface current $K = \\sigma d E_t$. Integrating this field along the current path gives the EMF, which is then related to the total current $I_w$ through the geometry-dependent resistance $R_w$.\n\nEquating the two expressions for the EMF, we obtain a relationship between the wall current and the rate of change of the internal flux:\n$$\nI_w(t) R_w = -\\frac{d\\psi(t)}{dt}\n$$\nThe problem provides a crucial second relationship, which connects the wall current to the difference between the external and internal magnetic fluxes via a geometric screening inductance $L_s$:\n$$\n\\psi_{\\text{ext}}(t) - \\psi(t) = L_s I_w(t)\n$$\nFrom this, we can express the wall current $I_w(t)$ as:\n$$\nI_w(t) = \\frac{1}{L_s} \\left[ \\psi_{\\text{ext}}(t) - \\psi(t) \\right]\n$$\nSubstituting this expression for $I_w(t)$ into our previous equation gives:\n$$\n\\frac{R_w}{L_s} \\left[ \\psi_{\\text{ext}}(t) - \\psi(t) \\right] = -\\frac{d\\psi(t)}{dt}\n$$\nThis is the first-order ordinary differential equation (ODE) governing the evolution of the internal flux $\\psi(t)$.\n\n**Definition of the Resistive-Wall Time, $\\tau_w$**\nThe equation can be rearranged into a standard form:\n$$\n\\frac{d\\psi(t)}{dt} + \\frac{R_w}{L_s}\\psi(t) = \\frac{R_w}{L_s}\\psi_{\\text{ext}}(t)\n$$\nThe term $L_s/R_w$ has units of time and represents the characteristic time scale of the system. We define the resistive-wall characteristic time $\\tau_w$ as this ratio:\n$$\n\\tau_w \\equiv \\frac{L_s}{R_w}\n$$\nThis time constant represents the $L/R$ time for the decay of eddy currents in the wall. It depends on the material properties of the wall (conductivity $\\sigma$ and thickness $d$, which determine $R_w$) and the geometry of the system and the perturbation (which determine both the inductance $L_s$ and resistance $R_w$).\nSubstituting $\\tau_w$ into the ODE, we get:\n$$\n\\frac{d\\psi(t)}{dt} + \\frac{1}{\\tau_w}\\psi(t) = \\frac{1}{\\tau_w}\\psi_{\\text{ext}}(t)\n$$\n\n**Solving for the Time Response**\nWe are given that the external flux is a step function: $\\psi_{\\text{ext}}(t) = \\psi_0 H(t)$. We need to solve the ODE for $t \\ge 0$. For this time domain, $H(t)=1$ and $\\psi_{\\text{ext}}(t) = \\psi_0$. The ODE becomes:\n$$\n\\frac{d\\psi}{dt} + \\frac{1}{\\tau_w}\\psi = \\frac{1}{\\tau_w}\\psi_0\n$$\nThis is a first-order linear non-homogeneous ODE with constant coefficients. The general solution is the sum of the homogeneous solution ($\\psi_h$) and a particular solution ($\\psi_p$).\n\nThe homogeneous equation is $\\frac{d\\psi_h}{dt} + \\frac{1}{\\tau_w}\\psi_h = 0$, which has the solution:\n$$\n\\psi_h(t) = C \\exp(-t/\\tau_w)\n$$\nwhere $C$ is a constant of integration.\n\nFor the particular solution, since the forcing term is a constant, we assume a constant solution $\\psi_p(t) = A$. Substituting this into the ODE gives:\n$$\n0 + \\frac{1}{\\tau_w}A = \\frac{1}{\\tau_w}\\psi_0 \\implies A = \\psi_0\n$$\nSo, the particular solution is $\\psi_p(t) = \\psi_0$.\n\nThe general solution for $t \\ge 0$ is the sum of the homogeneous and particular solutions:\n$$\n\\psi(t) = \\psi_h(t) + \\psi_p(t) = C \\exp(-t/\\tau_w) + \\psi_0\n$$\n\n**Application of Initial Conditions**\nThe system is initially unperturbed, so $\\psi(0^{-}) = 0$. The magnetic flux $\\psi(t)$ linking the contour is a state variable of an inductive-resistive system and cannot change instantaneously, as this would require an infinite induced EMF. Therefore, the flux must be continuous across $t=0$, which means $\\psi(0^{+}) = \\psi(0^{-}) = 0$. We apply this initial condition to the general solution at $t=0$:\n$$\n\\psi(0) = C \\exp(0) + \\psi_0 = C + \\psi_0 = 0\n$$\nThis yields the value of the integration constant: $C = -\\psi_0$.\n\n**Final Expression for $\\psi(t)$**\nSubstituting $C = -\\psi_0$ back into the general solution, we obtain the complete time response for the internal magnetic flux for $t \\ge 0$:\n$$\n\\psi(t) = \\psi_0 - \\psi_0 \\exp(-t/\\tau_w)\n$$\nThis can be written as:\n$$\n\\psi(t) = \\psi_0 \\left( 1 - \\exp(-t/\\tau_w) \\right)\n$$\nThis result demonstrates from first principles that, following a step change in the external flux, the internal flux $\\psi(t)$ exponentially approaches the steady-state value $\\psi_0$ with the characteristic time constant $\\tau_w$. At $t=0$, $\\psi(0) = 0$, representing perfect screening by the initially induced wall currents. As $t \\to \\infty$, the exponential term decays to zero, and $\\psi(t) \\to \\psi_0$, indicating that the magnetic field has fully penetrated the resistive wall and the screening currents have decayed away.",
            "answer": "$$\n\\boxed{\\psi_{0} \\left( 1 - \\exp\\left(-\\frac{t}{\\tau_{w}}\\right) \\right)}\n$$"
        },
        {
            "introduction": "While the first practice explored the transient, time-domain response of a wall, many applications, particularly those involving plasma instabilities or radio-frequency waves, require a frequency-domain perspective. This exercise delves into the classic phenomenon of the skin effect, where an oscillating magnetic field is confined to a thin layer near the surface of a conductor. Starting from Maxwell's equations, you will derive the spatial distribution of the induced eddy currents and introduce the characteristic skin depth, $\\delta$, which quantifies the effectiveness of screening as a function of frequency. ",
            "id": "3979844",
            "problem": "Consider a non-magnetic, homogeneous, isotropic resistive wall (planar conducting half-space) occupying $x \\geq 0$, with vacuum in $x < 0$. The wall has electrical conductivity $\\sigma$ and magnetic permeability $\\mu_{0}$. A uniform, tangential magnetic field in the vacuum region is externally applied at the interface $x=0$ and varies harmonically in time with angular frequency $\\omega$, so that the tangential component at the interface is prescribed as $B_{y}(x=0,t) = \\mathrm{Re}\\{ \\tilde{B}_{0} \\exp(i \\omega t)\\}$, where $\\tilde{B}_{0}$ is a complex amplitude. Assume all quantities are independent of $y$ and $z$ and vary only in $x$, and neglect displacement current. You may use the differential form of Maxwell–Faraday and Maxwell–Ampère laws, and Ohm’s law for a conductor.\n\nTasks:\n- Starting from first principles, derive the governing one-dimensional equation for $B_{y}(x,t)$ inside the wall. Solve for the complex spatial dependence of the harmonic response $\\tilde{B}_{y}(x)$ that decays as $x \\to \\infty$.\n- Using the solution and $\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$, compute the induced eddy current density distribution $\\tilde{J}_{z}(x)$ inside the wall.\n- Integrate the eddy current distribution across the wall thickness to obtain the net surface current density (sheet current) complex amplitude $\\tilde{K}_{z}(\\omega) = \\int_{0}^{\\infty} \\tilde{J}_{z}(x)\\,dx$ as a function of $\\omega$, expressed in terms of $\\tilde{B}_{0}$ and $\\mu_{0}$ only.\n\nExpress the final answer for $\\tilde{K}_{z}(\\omega)$ in ampere per meter (A/m). No numerical evaluation is required; provide a closed-form analytic expression. If you introduce intermediate characteristic scales (such as a skin depth), define them explicitly from fundamental constants and parameters $\\mu_{0}$, $\\sigma$, and $\\omega$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Geometry**: A planar conducting half-space (wall) occupies the region $x \\geq 0$. Vacuum occupies the region $x < 0$.\n- **Wall Properties**: The wall is non-magnetic (magnetic permeability $\\mu_0$), homogeneous, and isotropic, with electrical conductivity $\\sigma$.\n- **Boundary Condition**: A uniform, tangential magnetic field is applied at the interface $x=0$. Its value is prescribed as $B_{y}(x=0,t) = \\mathrm{Re}\\{ \\tilde{B}_{0} \\exp(i \\omega t)\\}$, where $\\tilde{B}_{0}$ is a complex amplitude and $\\omega$ is the angular frequency.\n- **Symmetry**: All physical quantities are functions of the spatial coordinate $x$ and time $t$ only, i.e., they are independent of $y$ and $z$. The magnetic field is $\\mathbf{B}(x,t) = B_y(x,t) \\hat{\\mathbf{j}}$.\n- **Governing Equations**: Maxwell–Faraday law ($\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$), Maxwell–Ampère law ($\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$), and Ohm's law ($\\mathbf{J} = \\sigma \\mathbf{E}$).\n- **Approximation**: The displacement current is neglected, which is already incorporated in the provided form of Maxwell-Ampère's law.\n- **Goal**:\n    1. Derive the governing equation for $B_{y}(x,t)$ inside the wall ($x \\geq 0$) and find the complex spatial dependence $\\tilde{B}_{y}(x)$ for a solution that decays as $x \\to \\infty$.\n    2. Compute the induced eddy current density complex amplitude, $\\tilde{J}_{z}(x)$.\n    3. Calculate the net surface current density complex amplitude, $\\tilde{K}_{z}(\\omega) = \\int_{0}^{\\infty} \\tilde{J}_{z}(x)\\,dx$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic electromagnetism problem concerning the skin effect and eddy currents in a conductor.\n- **Scientifically Grounded**: The problem is based on fundamental principles of electromagnetism (Maxwell's equations, Ohm's law) and uses a standard physical model (resistive half-space). The quasi-static approximation (neglecting displacement current) is appropriate for low-frequency phenomena in good conductors. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a partial differential equation to be derived, along with well-defined boundary conditions at $x=0$ and $x \\to \\infty$. This structure ensures a unique, stable, and meaningful solution.\n- **Objective**: The problem is stated using precise, unambiguous scientific language.\n- **Completeness and Consistency**: The problem is self-contained and provides all necessary information and governing laws. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Solution Derivation\n\n**Task 1: Governing Equation and Solution for $\\tilde{B}_y(x)$**\n\nWe start by combining the given laws to find a single equation for the magnetic field $\\mathbf{B}$ inside the conductor.\nWe take the curl of the Maxwell-Ampère law:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla \\times (\\mu_0 \\mathbf{J}) $$\nUsing the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{V}) = \\nabla(\\nabla \\cdot \\mathbf{V}) - \\nabla^2 \\mathbf{V}$ and Gauss's law for magnetism, $\\nabla \\cdot \\mathbf{B} = 0$, the left-hand side simplifies to:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{B}) = - \\nabla^2 \\mathbf{B} $$\nFor the right-hand side, since $\\mu_0$ is a constant, we have $\\nabla \\times (\\mu_0 \\mathbf{J}) = \\mu_0 (\\nabla \\times \\mathbf{J})$. Using Ohm's law, $\\mathbf{J} = \\sigma \\mathbf{E}$, and assuming uniform conductivity $\\sigma$:\n$$ \\mu_0 (\\nabla \\times \\mathbf{J}) = \\mu_0 \\sigma (\\nabla \\times \\mathbf{E}) $$\nNow, substituting the Maxwell-Faraday law, $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$:\n$$ \\mu_0 \\sigma (\\nabla \\times \\mathbf{E}) = - \\mu_0 \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t} $$\nEquating the simplified left-hand and right-hand sides gives the magnetic diffusion equation:\n$$ - \\nabla^2 \\mathbf{B} = - \\mu_0 \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t} \\implies \\nabla^2 \\mathbf{B} = \\mu_0 \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t} $$\nGiven the problem's symmetry, $\\mathbf{B} = B_y(x,t) \\hat{\\mathbf{j}}$, the Laplacian operator simplifies to $\\nabla^2 \\mathbf{B} = \\frac{\\partial^2 B_y}{\\partial x^2} \\hat{\\mathbf{j}}$. The one-dimensional diffusion equation is:\n$$ \\frac{\\partial^2 B_y}{\\partial x^2} = \\mu_0 \\sigma \\frac{\\partial B_y}{\\partial t} $$\nWe seek a harmonic solution of the form $B_y(x,t) = \\mathrm{Re}\\{ \\tilde{B}_y(x) \\exp(i \\omega t) \\}$. Substituting this into the diffusion equation, the time derivative becomes $\\frac{\\partial B_y}{\\partial t} = \\mathrm{Re}\\{ i \\omega \\tilde{B}_y(x) \\exp(i \\omega t) \\}$. This yields an ordinary differential equation for the complex amplitude $\\tilde{B}_y(x)$:\n$$ \\frac{d^2 \\tilde{B}_y}{dx^2} = i \\omega \\mu_0 \\sigma \\tilde{B}_y $$\nWe can write this as $\\frac{d^2 \\tilde{B}_y}{dx^2} - k^2 \\tilde{B}_y = 0$, where $k^2 = i \\omega \\mu_0 \\sigma$.\nThe complex wavenumber $k$ is $k = \\sqrt{i \\omega \\mu_0 \\sigma}$. We use the fact that $\\sqrt{i} = \\exp(i\\pi/4) = \\frac{1+i}{\\sqrt{2}}$.\n$$ k = \\sqrt{\\omega \\mu_0 \\sigma} \\frac{1+i}{\\sqrt{2}} = \\frac{1+i}{\\delta} $$\nHere, we have defined the characteristic skin depth $\\delta$ as:\n$$ \\delta = \\sqrt{\\frac{2}{\\omega \\mu_0 \\sigma}} $$\nThe general solution for $\\tilde{B}_y(x)$ is:\n$$ \\tilde{B}_y(x) = C_1 \\exp(kx) + C_2 \\exp(-kx) = C_1 \\exp\\left(\\frac{1+i}{\\delta}x\\right) + C_2 \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\nWe apply the boundary conditions. First, the field must decay as $x \\to \\infty$. The term $\\exp\\left(\\frac{1+i}{\\delta}x\\right) = \\exp(x/\\delta)\\exp(ix/\\delta)$ grows exponentially with $x$, so we must set its coefficient $C_1=0$.\nThis leaves $\\tilde{B}_y(x) = C_2 \\exp\\left(-\\frac{1+i}{\\delta}x\\right)$.\nThe second boundary condition is at the interface $x=0$, where the tangential magnetic field is prescribed as $\\tilde{B}_y(0) = \\tilde{B}_0$.\n$$ \\tilde{B}_y(0) = C_2 \\exp(0) = C_2 = \\tilde{B}_0 $$\nThus, the complex spatial dependence of the magnetic field inside the wall is:\n$$ \\tilde{B}_y(x) = \\tilde{B}_0 \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\n\n**Task 2: Induced Eddy Current Density $\\tilde{J}_z(x)$**\n\nThe induced eddy current density $\\mathbf{J}$ is found from the Maxwell-Ampère law, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$. For harmonic fields, this is $\\nabla \\times \\tilde{\\mathbf{B}} = \\mu_0 \\tilde{\\mathbf{J}}$.\n$$ \\tilde{\\mathbf{J}}(x) = \\frac{1}{\\mu_0} \\nabla \\times \\tilde{\\mathbf{B}}(x) $$\nWith $\\tilde{\\mathbf{B}}(x) = \\tilde{B}_y(x) \\hat{\\mathbf{j}}$, the curl is:\n$$ \\nabla \\times \\tilde{\\mathbf{B}} = \\left| \\begin{matrix} \\hat{\\mathbf{i}} & \\hat{\\mathbf{j}} & \\hat{\\mathbf{k}} \\\\ \\frac{\\partial}{\\partial x} & \\frac{\\partial}{\\partial y} & \\frac{\\partial}{\\partial z} \\\\ 0 & \\tilde{B}_y(x) & 0 \\end{matrix} \\right| = \\frac{d\\tilde{B}_y}{dx} \\hat{\\mathbf{k}} $$\nThe current density is thus $\\tilde{\\mathbf{J}}(x) = \\tilde{J}_z(x) \\hat{\\mathbf{k}}$, where:\n$$ \\tilde{J}_z(x) = \\frac{1}{\\mu_0} \\frac{d\\tilde{B}_y}{dx} $$\nDifferentiating our solution for $\\tilde{B}_y(x)$:\n$$ \\frac{d\\tilde{B}_y}{dx} = \\frac{d}{dx} \\left[ \\tilde{B}_0 \\exp\\left(-\\frac{1+i}{\\delta}x\\right) \\right] = \\tilde{B}_0 \\left(-\\frac{1+i}{\\delta}\\right) \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\nSubstituting this into the expression for $\\tilde{J}_z(x)$:\n$$ \\tilde{J}_z(x) = -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\n\n**Task 3: Net Surface Current Density $\\tilde{K}_z(\\omega)$**\n\nThe net surface current density (or sheet current), $\\tilde{K}_z(\\omega)$, is the integral of the volume current density $\\tilde{J}_z(x)$ over the entire thickness of the conductor, from $x=0$ to $x=\\infty$.\n$$ \\tilde{K}_z(\\omega) = \\int_{0}^{\\infty} \\tilde{J}_{z}(x) \\,dx $$\nSubstituting the expression for $\\tilde{J}_z(x)$:\n$$ \\tilde{K}_z(\\omega) = \\int_{0}^{\\infty} \\left[ -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\exp\\left(-\\frac{1+i}{\\delta}x\\right) \\right] dx $$\nThe terms independent of $x$ can be moved outside the integral:\n$$ \\tilde{K}_z(\\omega) = -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\int_{0}^{\\infty} \\exp\\left(-\\frac{1+i}{\\delta}x\\right) dx $$\nThe integral is evaluated as:\n$$ \\int_{0}^{\\infty} \\exp\\left(-\\frac{1+i}{\\delta}x\\right) dx = \\left[ \\frac{-1}{(1+i)/\\delta} \\exp\\left(-\\frac{1+i}{\\delta}x\\right) \\right]_{0}^{\\infty} $$\n$$ = \\left( -\\frac{\\delta}{1+i} \\right) \\left[ \\exp\\left(-\\frac{x}{\\delta}\\right)\\exp\\left(-\\frac{ix}{\\delta}\\right) \\right]_{0}^{\\infty} $$\nAs $x \\to \\infty$, the term $\\exp(-x/\\delta) \\to 0$. At $x=0$, the exponential is $1$.\n$$ = \\left( -\\frac{\\delta}{1+i} \\right) (0 - 1) = \\frac{\\delta}{1+i} $$\nSubstituting this result back into the expression for $\\tilde{K}_z(\\omega)$:\n$$ \\tilde{K}_z(\\omega) = -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\left(\\frac{\\delta}{1+i}\\right) $$\nThe terms involving the skin depth $\\delta$ and the complex number $(1+i)$ cancel out, yielding a remarkably simple result:\n$$ \\tilde{K}_z(\\omega) = -\\frac{\\tilde{B}_0}{\\mu_0} $$\nThis result shows that the total induced sheet current is independent of the wall's conductivity $\\sigma$ and the frequency $\\omega$. It depends only on the applied magnetic field at the surface and the permeability of free space. The induced current flows in such a way as to create a magnetic field that opposes the applied field, providing shielding.",
            "answer": "$$\\boxed{-\\frac{\\tilde{B}_{0}}{\\mu_{0}}}$$"
        },
        {
            "introduction": "Real-world fusion devices are complex systems where the plasma, resistive wall, and external control coils are all electromagnetically coupled. This final practice elevates our analysis from an isolated wall to a system-level model, a crucial step toward practical engineering and physics analysis. You will construct a mutual inductance matrix that describes the interactions between different components and then use eigenvalue analysis—a powerful computational technique—to identify the collective \"screening modes\" of the system. This exercise provides hands-on experience with the type of modeling used in sophisticated codes for plasma stability and control, revealing how abstract mathematical concepts like eigenvectors correspond to tangible physical behaviors. ",
            "id": "3979858",
            "problem": "Consider a magneto-quasi-static model of a toroidal device with a thin plasma boundary, a thin resistive wall, and external filamentary coils. Assume axisymmetry in the toroidal direction and represent poloidal structure using a Fourier basis indexed by poloidal mode number $m \\in \\mathbb{N}$. Let the major radius be $R_0$ (in meters), and denote by $r_p$ (in meters) the minor radius of the plasma boundary, by $r_w$ (in meters) the minor radius of the wall, and by $r_c$ (in meters) the minor radius of the coils. Assume $r_c > r_w > r_p > 0$. Under magneto-quasi-static conditions, with displacement current neglected, Ampere's law $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$ and Faraday's law $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B} / \\partial t$ reduce to a coupling of circuit currents via mutual inductances. In a cylindrical approximation and a Fourier decomposition in the poloidal angle, the Green's function for the vacuum magnetic field implies that, for a single poloidal harmonic $m$, the coupling between two concentric thin current sheets located at radii $r_a$ and $r_b$ is proportional to $(\\frac{r_}{r_>})^m$, where $r_ = \\min(r_a, r_b)$ and $r_> = \\max(r_a, r_b)$. Using a normalized harmonic basis in a long-torus approximation, the mutual inductance between two harmonic circuits for a fixed $m$ can be modeled as\n$$\nL_{ab}^{(m)} = \\mu_0 R_0 \\frac{1}{2 m} \\left(\\frac{r_}{r_>}\\right)^m,\n$$\nand the self-inductance of each harmonic circuit is\n$$\nL_{aa}^{(m)} = \\mu_0 R_0 \\frac{1}{2 m}.\n$$\nAssume that each poloidal harmonic $m$ contributes three circuit variables: the coil current $I_c^{(m)}$, the plasma boundary current $I_p^{(m)}$, and the wall current $I_w^{(m)}$. Under the assumptions above, different $m$ harmonics are decoupled, and the mutual inductance matrix is block diagonal with a $3 \\times 3$ block for each $m$, ordered as $(I_c^{(m)}, I_p^{(m)}, I_w^{(m)})$. For a given $m$, the block is\n$$\n\\mathbf{L}^{(m)} =\n\\begin{bmatrix}\nL_{cc}^{(m)}  L_{cp}^{(m)}  L_{cw}^{(m)} \\\\\nL_{pc}^{(m)}  L_{pp}^{(m)}  L_{pw}^{(m)} \\\\\nL_{wc}^{(m)}  L_{wp}^{(m)}  L_{ww}^{(m)}\n\\end{bmatrix},\n$$\nwith $L_{cc}^{(m)} = L_{pp}^{(m)} = L_{ww}^{(m)} = \\mu_0 R_0 / (2 m)$ and $L_{cp}^{(m)} = L_{pc}^{(m)} = \\mu_0 R_0 \\frac{1}{2 m} (\\frac{\\min(r_c, r_p)}{\\max(r_c, r_p)})^m$, $L_{cw}^{(m)} = L_{wc}^{(m)} = \\mu_0 R_0 \\frac{1}{2 m} (\\frac{\\min(r_c, r_w)}{\\max(r_c, r_w)})^m$, $L_{pw}^{(m)} = L_{wp}^{(m)} = \\mu_0 R_0 \\frac{1}{2 m} (\\frac{\\min(r_p, r_w)}{\\max(r_p, r_w)})^m$. The full mutual inductance matrix $\\mathbf{L}$ is the block diagonal concatenation of $\\mathbf{L}^{(m)}$ over the provided set of $m$ values.\n\nDefine a screening mode as an eigenvector of $\\mathbf{L}$ whose wall current component dominates in the sense that the normalized participation of wall entries in the eigenvector is at least a specified threshold. Specifically, for an eigenvector $\\mathbf{v}$ of $\\mathbf{L}$, define the wall participation ratio\n$$\n\\chi_w(\\mathbf{v}) = \\frac{\\sum_{j \\in \\mathcal{W}} |v_j|^2}{\\sum_{j=1}^{3M} |v_j|^2},\n$$\nwhere $\\mathcal{W}$ indexes the wall-current entries (one per poloidal harmonic block) and $M$ is the number of poloidal harmonics included. A dominant screening mode satisfies $\\chi_w(\\mathbf{v}) \\ge \\alpha$, where $\\alpha$ is a fixed threshold. For this problem, use $\\alpha = 0.5$. Identify the dominant screening strength by the largest eigenvalue of $\\mathbf{L}$ among eigenvectors that satisfy the screening criterion. If no eigenvector satisfies the criterion, return $0.0$.\n\nTasks:\n- Assemble the block-diagonal mutual inductance matrix $\\mathbf{L}$ from the provided parameters and poloidal harmonics.\n- Compute all eigenvalues and eigenvectors of $\\mathbf{L}$.\n- For each test case, compute the largest eigenvalue among those eigenvectors whose wall participation ratio $\\chi_w(\\mathbf{v}) \\ge \\alpha$ with $\\alpha = 0.5$.\n- Express each result in microhenry as a float rounded to six decimal places. The conversion from henry to microhenry is $1\\,\\mathrm{H} = 10^6\\,\\mathrm{\\mu H}$.\n\nConstants:\n- Use $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n\nTest suite:\n- Case A (happy path): $R_0 = 6.0$ m, $r_p = 1.5$ m, $r_w = 1.7$ m, $r_c = 2.2$ m, $m$ values $[1,2]$.\n- Case B (near-wall boundary condition): $R_0 = 6.0$ m, $r_p = 1.5$ m, $r_w = 1.51$ m, $r_c = 2.2$ m, $m$ values $[1,2,3]$.\n- Case C (far-wall edge case): $R_0 = 6.0$ m, $r_p = 1.5$ m, $r_w = 2.8$ m, $r_c = 3.0$ m, $m$ values $[1,2]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for Cases A, B, and C as a comma-separated list enclosed in square brackets, in microhenry, rounded to six decimal places, for example, $[x_A,x_B,x_C]$.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **Model**: Magneto-quasi-static, axisymmetric, thin plasma boundary, thin resistive wall, external filamentary coils.\n- **Geometry**: Major radius $R_0$, plasma minor radius $r_p$, wall minor radius $r_w$, coil minor radius $r_c$.\n- **Constraint**: $r_c > r_w > r_p > 0$.\n- **Basis**: Poloidal Fourier basis with index $m \\in \\mathbb{N}$.\n- **Approximation**: Long-torus, cylindrical.\n- **Inductance Formulas**:\n  - Self-inductance: $L_{aa}^{(m)} = \\mu_0 R_0 \\frac{1}{2 m}$.\n  - Mutual inductance: $L_{ab}^{(m)} = \\mu_0 R_0 \\frac{1}{2 m} \\left(\\frac{r_}{r_>}\\right)^m$, with $r_ = \\min(r_a, r_b)$ and $r_> = \\max(r_a, r_b)$.\n- **Circuit Variables**: Coil current $I_c^{(m)}$, plasma current $I_p^{(m)}$, wall current $I_w^{(m)}$, ordered as $(I_c^{(m)}, I_p^{(m)}, I_w^{(m)})$.\n- **Inductance Matrix**:\n  - Full matrix $\\mathbf{L}$ is block diagonal with $3 \\times 3$ blocks $\\mathbf{L}^{(m)}$ for each poloidal harmonic $m$.\n  - Block structure for a given $m$: $\\mathbf{L}^{(m)} = \\begin{bmatrix} L_{cc}^{(m)}  L_{cp}^{(m)}  L_{cw}^{(m)} \\\\ L_{pc}^{(m)}  L_{pp}^{(m)}  L_{pw}^{(m)} \\\\ L_{wc}^{(m)}  L_{wp}^{(m)}  L_{ww}^{(m)} \\end{bmatrix}$.\n- **Screening Mode Definition**: An eigenvector $\\mathbf{v}$ of $\\mathbf{L}$ is a dominant screening mode if its wall participation ratio $\\chi_w(\\mathbf{v})$ meets a threshold.\n- **Wall Participation Ratio**: $\\chi_w(\\mathbf{v}) = \\frac{\\sum_{j \\in \\mathcal{W}} |v_j|^2}{\\sum_{j=1}^{3M} |v_j|^2} \\ge \\alpha$, where $\\mathcal{W}$ are indices for wall-currents, $M$ is the number of harmonics, and $\\alpha = 0.5$.\n- **Dominant Screening Strength**: The largest eigenvalue of $\\mathbf{L}$ corresponding to a dominant screening mode eigenvector. If no such mode exists, the strength is $0.0$.\n- **Tasks**:\n  1. Assemble the matrix $\\mathbf{L}$.\n  2. Compute eigenvalues and eigenvectors of $\\mathbf{L}$.\n  3. Find the maximum screening strength eigenvalue for each test case.\n  4. Convert result to microhenry ($\\mu$H) and round to six decimal places. $1\\,\\mathrm{H} = 10^6\\,\\mathrm{\\mu H}$.\n- **Constants**: $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n- **Test Suite**:\n  - Case A: $R_0 = 6.0$ m, $r_p = 1.5$ m, $r_w = 1.7$ m, $r_c = 2.2$ m, $m \\in [1,2]$.\n  - Case B: $R_0 = 6.0$ m, $r_p = 1.5$ m, $r_w = 1.51$ m, $r_c = 2.2$ m, $m \\in [1,2,3]$.\n  - Case C: $R_0 = 6.0$ m, $r_p = 1.5$ m, $r_w = 2.8$ m, $r_c = 3.0$ m, $m \\in [1,2]$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is grounded in the magneto-quasi-static (MQS) approximation of Maxwell's equations, a standard framework in plasma physics for studying low-frequency phenomena like resistive wall modes. The use of a mutual inductance matrix to model coupled circuits is a valid and common technique. The provided inductance formulas are consistent with those derived for concentric current filaments in a cylindrical geometry. The concept of screening modes and participation ratios is a relevant physical concept in the analysis of plasma-wall interactions.\n- **Well-Posedness**: The problem is well-posed. The construction of the matrix $\\mathbf{L}$ is deterministic. Since $L_{ab}^{(m)} = L_{ba}^{(m)}$, the matrix $\\mathbf{L}$ is real and symmetric, which guarantees a complete set of real eigenvalues and orthogonal eigenvectors. The procedure to identify the dominant screening strength is unambiguous.\n- **Objectivity**: All terms are defined quantitatively and mathematically. There is no subjective or ambiguous language.\n- **Conclusion**: The problem does not violate any of the invalidity criteria. It is scientifically sound, fully specified, objective, and computationally solvable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution will be provided.\n\n### Principle-Based Solution\n\nThe problem requires us to analyze the electromagnetic coupling between coils, a plasma, and a resistive wall in a toroidal fusion device. This is accomplished by constructing a mutual inductance matrix $\\mathbf{L}$ and analyzing its eigenmodes.\n\nFirst, we establish the structure of the mutual inductance matrix $\\mathbf{L}$. The problem states that different poloidal harmonics $m$ are decoupled. This means the full inductance matrix $\\mathbf{L}$ is block-diagonal. If we consider $M$ harmonics, $m_1, m_2, \\dots, m_M$, the matrix $\\mathbf{L}$ has dimensions $3M \\times 3M$ and is given by:\n$$\n\\mathbf{L} = \\begin{bmatrix}\n\\mathbf{L}^{(m_1)}  \\mathbf{0}  \\dots  \\mathbf{0} \\\\\n\\mathbf{0}  \\mathbf{L}^{(m_2)}  \\dots  \\mathbf{0} \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n\\mathbf{0}  \\mathbf{0}  \\dots  \\mathbf{L}^{(m_M)}\n\\end{bmatrix}\n$$\nwhere each $\\mathbf{L}^{(m)}$ is a $3 \\times 3$ matrix for a specific harmonic $m$, and $\\mathbf{0}$ is the $3 \\times 3$ zero matrix.\n\nFor a single harmonic $m$, the block $\\mathbf{L}^{(m)}$ couples the coil, plasma, and wall currents, which are ordered as $(I_c^{(m)}, I_p^{(m)}, I_w^{(m)})$. The elements of this matrix are derived from the given formulas. Let $C_m = \\mu_0 R_0 / (2m)$.\nThe diagonal elements (self-inductances) are all identical:\n$$\nL_{cc}^{(m)} = L_{pp}^{(m)} = L_{ww}^{(m)} = C_m\n$$\nThe off-diagonal elements (mutual inductances) are given by the formula $L_{ab}^{(m)} = C_m \\left(\\frac{r_}{r_>}\\right)^m$. Given the radial ordering $r_c > r_w > r_p > 0$, these elements are:\n- Coil-Plasma coupling: $L_{cp}^{(m)} = L_{pc}^{(m)} = C_m \\left(\\frac{r_p}{r_c}\\right)^m$\n- Coil-Wall coupling: $L_{cw}^{(m)} = L_{wc}^{(m)} = C_m \\left(\\frac{r_w}{r_c}\\right)^m$\n- Plasma-Wall coupling: $L_{pw}^{(m)} = L_{wp}^{(m)} = C_m \\left(\\frac{r_p}{r_w}\\right)^m$\nThe resulting $3 \\times 3$ block is symmetric:\n$$\n\\mathbf{L}^{(m)} = C_m\n\\begin{bmatrix}\n1  (r_p/r_c)^m  (r_w/r_c)^m \\\\\n(r_p/r_c)^m  1  (r_p/r_w)^m \\\\\n(r_w/r_c)^m  (r_p/r_w)^m  1\n\\end{bmatrix}\n$$\nBecause $\\mathbf{L}$ is block-diagonal, its eigenvalues are the union of the eigenvalues of all its diagonal blocks $\\mathbf{L}^{(m)}$. Its eigenvectors are formed by embedding the eigenvectors of the blocks into the larger $3M$-dimensional space. Specifically, if $\\mathbf{v}^{(m)}$ is an eigenvector of $\\mathbf{L}^{(m)}$ with eigenvalue $\\lambda$, then a vector $\\mathbf{v}$ with the components of $\\mathbf{v}^{(m)}$ in the corresponding block and zeros elsewhere is an eigenvector of $\\mathbf{L}$ with the same eigenvalue $\\lambda$.\n\nThis structural property allows us to simplify the problem significantly: instead of constructing the full $3M \\times 3M$ matrix, we can analyze each $3 \\times 3$ block $\\mathbf{L}^{(m)}$ independently. For each harmonic $m$ in the test case, we construct its corresponding $\\mathbf{L}^{(m)}$ and compute its eigenvalues and eigenvectors. Let $(\\lambda_j^{(m)}, \\mathbf{v}_j^{(m)})$ be the $j$-th eigenpair of $\\mathbf{L}^{(m)}$, where $j \\in \\{1, 2, 3\\}$. The eigenvector $\\mathbf{v}_j^{(m)}$ has three components, corresponding to the coil, plasma, and wall, respectively: $\\mathbf{v}_j^{(m)} = [v_c, v_p, v_w]^T$.\n\nThe next step is to identify the \"dominant screening modes\". A mode is defined by an eigenvector of $\\mathbf{L}$. The criterion for a dominant screening mode is that its wall participation ratio, $\\chi_w$, is at least $\\alpha = 0.5$. For an eigenvector $\\mathbf{v}$ of the full matrix $\\mathbf{L}$ that originates from an eigenvector $\\mathbf{v}_j^{(m)}$ of a block, its only non-zero components are those of $\\mathbf{v}_j^{(m)}$. The wall current components of $\\mathbf{v}$ are indexed by $2, 5, \\dots, 3k+2, \\dots$. For our specific eigenvector, the only non-zero wall component is $v_w$. Therefore, the wall participation ratio simplifies to:\n$$\n\\chi_w = \\frac{|v_w|^2}{|v_c|^2 + |v_p|^2 + |v_w|^2}\n$$\nIf we use a numerical library that returns eigenvectors normalized to unit length, i.e., $|v_c|^2 + |v_p|^2 + |v_w|^2 = 1$, the criterion simplifies to checking if $|v_w|^2 \\ge \\alpha$. Here, $v_w$ is the third component of the normalized eigenvector $\\mathbf{v}_j^{(m)}$.\n\nThe overall algorithm is as follows:\n1. Initialize a variable `max_eigenvalue` to $0.0$ for the current test case.\n2. For each harmonic $m$ specified in the test case:\n    a. Using the given parameters ($R_0, r_p, r_w, r_c$) and the current $m$, construct the $3 \\times 3$ matrix $\\mathbf{L}^{(m)}$.\n    b. Compute the eigenvalues and normalized eigenvectors of $\\mathbf{L}^{(m)}$. This yields three eigenpairs $(\\lambda_j^{(m)}, \\mathbf{v}_j^{(m)})$.\n    c. For each eigenvector $\\mathbf{v}_j^{(m)} = [v_c, v_p, v_w]^T$:\n        i. Calculate the squared magnitude of its wall component, $|v_w|^2$.\n        ii. If $|v_w|^2 \\ge 0.5$, then the corresponding eigenvalue $\\lambda_j^{(m)}$ is a candidate. Update `max_eigenvalue = max(max_eigenvalue, \\lambda_j^{(m)})`.\n3. After iterating through all harmonics for the test case, the final `max_eigenvalue` holds the dominant screening strength in Henry.\n4. Convert this value to microhenry by multiplying by $10^6$ and round to six decimal places.\n5. Repeat for all test cases.\n\nThis procedure correctly identifies the largest inductance (eigenvalue) associated with a collective current pattern (eigenvector) that is predominantly localized at the resistive wall, which is the physical meaning of a dominant screening mode in this model.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the field penetration and screening problem for a set of test cases.\n    \"\"\"\n    \n    # Constants\n    MU0 = 4 * np.pi * 1e-7  # H/m\n    ALPHA = 0.5  # Wall participation ratio threshold\n\n    # Test suite: (R0, rp, rw, rc, m_values)\n    test_cases = [\n        (6.0, 1.5, 1.7, 2.2, [1, 2]),  # Case A\n        (6.0, 1.5, 1.51, 2.2, [1, 2, 3]),  # Case B\n        (6.0, 1.5, 2.8, 3.0, [1, 2]),  # Case C\n    ]\n\n    results = []\n\n    for case in test_cases:\n        R0, rp, rw, rc, m_values = case\n        max_screening_eigenvalue = 0.0\n\n        for m in m_values:\n            # Check for m>0 as per formula, although problem gives positive m\n            if m = 0:\n                continue\n\n            # Calculate the constant part of the inductance formula for this m\n            C_m = MU0 * R0 / (2 * m)\n\n            # Calculate the geometric factors based on r_c  r_w  r_p\n            ratio_pc = (rp / rc)**m\n            ratio_wc = (rw / rc)**m\n            ratio_pw = (rp / rw)**m\n\n            # Assemble the 3x3 inductance matrix L^(m)\n            # The matrix is symmetric. Order is (coil, plasma, wall).\n            L_m = C_m * np.array([\n                [1.0,      ratio_pc, ratio_wc],\n                [ratio_pc, 1.0,      ratio_pw],\n                [ratio_wc, ratio_pw, 1.0]\n            ])\n\n            # Compute eigenvalues and eigenvectors for the symmetric matrix L_m.\n            # `eigh` is used for Hermitian (or real symmetric) matrices.\n            # It returns eigenvalues in ascending order and corresponding\n            # normalized eigenvectors.\n            eigenvalues, eigenvectors = np.linalg.eigh(L_m)\n\n            # Check each eigenvector for the screening criterion\n            for i in range(len(eigenvalues)):\n                eigenvector = eigenvectors[:, i]\n                # The wall component is the last (3rd) element of the eigenvector\n                wall_component = eigenvector[2]\n                \n                # The wall participation ratio is the squared magnitude of the wall component,\n                # since the eigenvectors are normalized to 1.\n                wall_participation = wall_component**2\n                \n                if wall_participation = ALPHA:\n                    # This is a dominant screening mode. Check if its eigenvalue is the largest so far.\n                    screening_eigenvalue = eigenvalues[i]\n                    if screening_eigenvalue  max_screening_eigenvalue:\n                        max_screening_eigenvalue = screening_eigenvalue\n\n        # Convert the result from Henry to microHenry and round\n        result_uH = max_screening_eigenvalue * 1e6\n        \n        # Round to 6 decimal places for final output\n        results.append(f\"{result_uH:.6f}\")\n\n    # Print the results in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}