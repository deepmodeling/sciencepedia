{
    "hands_on_practices": [
        {
            "introduction": "为了掌握磁场穿透电阻壁的本质，我们可以从一个简化的集总参数模型入手。该方法将壁视为一个等效的 $L/R$ 电路。本练习将引导你推导基本的壁时间常数 $\\tau_w$，它决定了外部磁场浸入壁内的时间尺度，从而展示了壁在初始时刻的完美屏蔽效应以及随后的电阻性穿透过程。",
            "id": "3979872",
            "problem": "考虑一个聚变装置中包围着真空区域的薄、均匀、有电阻的圆柱形壁，其平均半径为$a$，厚度为$d$。该壁的电导率为$\\sigma$，并承载一个单一的非轴对称磁扰动谐波。设$\\psi(t)$表示穿过紧贴壁内侧闭合回路的角向磁通量，$\\psi_{\\text{ext}}(t)$表示在没有壁的情况下（即外部施加的扰动）该回路上存在的角向磁通量。假设扰动沿着环向和角向的变化足够缓慢，以至于薄壳、单模、集总参数的描述是有效的。\n\n从基本电磁定律——法拉第定律$\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$和欧姆定律$\\mathbf{J} = \\sigma \\mathbf{E}$——出发，并对壁使用薄壳近似，使得切向电场$E_{t}$产生满足$K = \\sigma d\\,E_{t}$的表面电流密度$K$，推导出$\\psi(t)$响应外部磁通量阶跃变化的演化过程。引入一个几何电感参数$L_{s}$，它通过$\\psi_{\\text{ext}}(t) - \\psi(t) = L_{s}\\,I_{w}(t)$将外部和内部磁通量之差与净环向壁电流$I_{w}(t)$线性关联起来，其中$I_{w}(t)$是沿着切向电场方向环绕壁的总电流。\n\n外部磁通量在$t=0$时从零阶跃到一个常数值$\\psi_{0}$，即$\\psi_{\\text{ext}}(t) = \\psi_{0}\\,H(t)$，其中$H(t)$是亥维赛阶跃函数。系统初始未受扰动，即$\\psi(0^{-}) = 0$且$I_{w}(0^{-}) = 0$。根据壁的材料和几何形状定义电阻壁特征时间$\\tau_{w}$，并计算$t \\ge 0$时的完整时间响应$\\psi(t)$。从第一性原理证明，内部磁通量以特征时间$\\tau_{w}$趋近于外部磁通量。\n\n将最终的$\\psi(t)$以韦伯为单位，用$\\psi_{0}$、$t$和$\\tau_{w}$表示为一个闭式解析表达式。不需要进行数值取整。",
            "solution": "首先对问题进行验证，以确保其在科学上是合理的、内容自洽且适定的。\n\n**第一步：提取已知条件**\n- **系统：** 一个薄的、均匀的、有电阻的圆柱形壁。\n- **几何参数：** 平均半径$a$，厚度$d$。\n- **材料属性：** 电导率$\\sigma$。\n- **物理量/变量：**\n    - 壁内侧的角向磁通量：$\\psi(t)$。\n    - 外部角向磁通量：$\\psi_{\\text{ext}}(t')$。\n    - 壁内的切向电场：$E_{t}$。\n    - 表面电流密度：$K$。\n    - 总环向壁电流：$I_{w}(t)$。\n- **基本定律：**\n    - 法拉第定律：$\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$。\n    - 欧姆定律：$\\mathbf{J} = \\sigma \\mathbf{E}$。\n- **模型特定关系：**\n    - 薄壳电流：$K = \\sigma d E_{t}$。\n    - 电感关系：$\\psi_{\\text{ext}}(t) - \\psi(t) = L_{s} I_{w}(t)$，其中$L_{s}$是一个几何电感参数。\n- **驱动函数：** $\\psi_{\\text{ext}}(t) = \\psi_{0} H(t)$，其中$\\psi_0$是一个常数，H(t)是亥维赛阶跃函数。\n- **初始条件：** $\\psi(0^{-}) = 0$ 且 $I_{w}(0^{-}) = 0$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于经典电磁学，并采用了一个在等离子体物理和聚变工程中广泛使用的标准薄壳模型来研究磁场穿透和稳定性（例如，电阻壁模）。其中的概念和关系是该领域的基础。该问题在科学上是合理的。\n- **适定性：** 该问题指定了一个由物理定律支配的系统，该系统可以被构建成一个一阶线性常微分方程。它提供了明确的驱动函数和一致的初始条件，确保了唯一、稳定且有意义的解的存在。该问题是适定的。\n- **客观性：** 该问题使用物理学和工程学中精确、无歧义的标准术语进行表述，不含主观论断。\n\n**结论**\n该问题是有效的，因为它具有科学依据、是适定的且客观的。它包含了根据要求从第一性原理推导出唯一解所需的所有必要信息。\n\n**控制方程的推导**\n我们从法拉第感应定律的积分形式开始，将其应用于位于电阻壁内侧、真空区域中的一个闭合回路$C$。穿过此回路的磁通量为$\\psi(t)$。\n$$\n\\oint_C \\mathbf{E} \\cdot d\\mathbf{l} = -\\frac{d}{dt} \\int_S \\mathbf{B} \\cdot d\\mathbf{A} = -\\frac{d\\psi(t)}{dt}\n$$\n方程的左边是沿回路感应出的电动势（EMF）。这个电动势驱动着电阻壁内的电流$I_w(t)$。壁对该电流的流动呈现出总电阻$R_w$。根据欧姆定律，电动势必须等于电流与电阻的乘积。在这个集总参数模型中，我们有：\n$$\n\\oint_C \\mathbf{E} \\cdot d\\mathbf{l} = I_w(t) R_w\n$$\n值得注意的是，壁内的切向电场$E_t$产生了表面电流$K = \\sigma d E_t$。沿电流路径对该场进行积分得到电动势，然后通过与几何相关的电阻$R_w$将电动势与总电流$I_w$联系起来。\n\n将电动势的两个表达式相等，我们得到壁电流与内部磁通量变化率之间的关系：\n$$\nI_w(t) R_w = -\\frac{d\\psi(t)}{dt}\n$$\n问题提供了第二个关键关系，它通过一个几何屏蔽电感$L_s$将壁电流与外部和内部磁通量之差联系起来：\n$$\n\\psi_{\\text{ext}}(t) - \\psi(t) = L_s I_w(t)\n$$\n由此，我们可以将壁电流$I_w(t)$表示为：\n$$\nI_w(t) = \\frac{1}{L_s} \\left[ \\psi_{\\text{ext}}(t) - \\psi(t) \\right]\n$$\n将$I_w(t)$的这个表达式代入我们之前的方程，得到：\n$$\n\\frac{R_w}{L_s} \\left[ \\psi_{\\text{ext}}(t) - \\psi(t) \\right] = -\\frac{d\\psi(t)}{dt}\n$$\n这就是控制内部磁通量$\\psi(t)$演化的一阶常微分方程（ODE）。\n\n**电阻壁时间$\\tau_w$的定义**\n该方程可以重排为标准形式：\n$$\n\\frac{d\\psi(t)}{dt} + \\frac{R_w}{L_s}\\psi(t) = \\frac{R_w}{L_s}\\psi_{\\text{ext}}(t)\n$$\n项$L_s/R_w$具有时间的单位，代表系统的特征时间尺度。我们将电阻壁特征时间$\\tau_w$定义为该比值：\n$$\n\\tau_w \\equiv \\frac{L_s}{R_w}\n$$\n这个时间常数代表了壁中涡流衰减的$L/R$时间。它取决于壁的材料特性（决定$R_w$的电导率$\\sigma$和厚度$d$）以及系统和扰动的几何形状（决定电感$L_s$和电阻$R_w$）。\n将$\\tau_w$代入ODE，我们得到：\n$$\n\\frac{d\\psi(t)}{dt} + \\frac{1}{\\tau_w}\\psi(t) = \\frac{1}{\\tau_w}\\psi_{\\text{ext}}(t)\n$$\n\n**求解时间响应**\n已知外部磁通量是一个阶跃函数：$\\psi_{\\text{ext}}(t) = \\psi_0 H(t)$。我们需要求解$t \\ge 0$时的ODE。在这个时域内，$H(t)=1$且$\\psi_{\\text{ext}}(t) = \\psi_0$。ODE变为：\n$$\n\\frac{d\\psi}{dt} + \\frac{1}{\\tau_w}\\psi = \\frac{1}{\\tau_w}\\psi_0\n$$\n这是一个一阶线性非齐次常系数常微分方程。其通解是齐次解（$\\psi_h$）和特解（$\\psi_p$）之和。\n\n齐次方程为$\\frac{d\\psi_h}{dt} + \\frac{1}{\\tau_w}\\psi_h = 0$，其解为：\n$$\n\\psi_h(t) = C \\exp(-t/\\tau_w)\n$$\n其中$C$是积分常数。\n\n对于特解，由于驱动项是常数，我们假设一个常数解$\\psi_p(t) = A$。将其代入ODE得到：\n$$\n0 + \\frac{1}{\\tau_w}A = \\frac{1}{\\tau_w}\\psi_0 \\implies A = \\psi_0\n$$\n因此，特解为$\\psi_p(t) = \\psi_0$。\n\n$t \\ge 0$的通解是齐次解和特解之和：\n$$\n\\psi(t) = \\psi_h(t) + \\psi_p(t) = C \\exp(-t/\\tau_w) + \\psi_0\n$$\n\n**应用初始条件**\n系统初始未受扰动，因此$\\psi(0^{-}) = 0$。穿过回路的磁通量$\\psi(t)$是感性-阻性系统的状态变量，不能瞬时改变，因为这需要无穷大的感应电动势。因此，磁通量在$t=0$处必须是连续的，即$\\psi(0^{+}) = \\psi(0^{-}) = 0$。我们将此初始条件应用于$t=0$时的通解：\n$$\n\\psi(0) = C \\exp(0) + \\psi_0 = C + \\psi_0 = 0\n$$\n这给出了积分常数的值：$C = -\\psi_0$。\n\n**$\\psi(t)$的最终表达式**\n将$C = -\\psi_0$代回通解，我们得到$t \\ge 0$时内部磁通量的完整时间响应：\n$$\n\\psi(t) = \\psi_0 - \\psi_0 \\exp(-t/\\tau_w)\n$$\n这可以写作：\n$$\n\\psi(t) = \\psi_0 \\left( 1 - \\exp(-t/\\tau_w) \\right)\n$$\n这个结果从第一性原理证明了，在外部磁通量发生阶跃变化后，内部磁通量$\\psi(t)$以特征时间常数$\\tau_w$指数般地趋近稳态值$\\psi_0$。在$t=0$时，$\\psi(0)=0$，表示由初始感应的壁电流产生的完美屏蔽。当$t \\to \\infty$时，指数项衰减至零，$\\psi(t) \\to \\psi_0$，表明磁场已完全穿透电阻壁，屏蔽电流已衰减消失。",
            "answer": "$$\n\\boxed{\\psi_{0} \\left( 1 - \\exp\\left(-\\frac{t}{\\tau_{w}}\\right) \\right)}\n$$"
        },
        {
            "introduction": "尽管集总参数模型能够描述系统的时间动态，但我们需要一个连续介质模型来理解场和电流的空间分布。本练习深入探讨经典的趋肤效应，即振荡磁场在导体内部感应出涡流。你将从第一性原理出发，推导磁扩散方程，并求解以趋肤深度 $\\delta$ 为特征的场指数衰减规律，这对于理解频率相关的屏蔽效应至关重要。",
            "id": "3979844",
            "problem": "考虑一堵非磁性、均匀、各向同性的电阻壁（平面导电半空间），占据 $x \\geq 0$ 的区域，而 $x  0$ 的区域为真空。该壁的电导率为 $\\sigma$，磁导率为 $\\mu_{0}$。在真空区域中，一个均匀的切向磁场从外部施加在 $x=0$ 的界面上，并以角频率 $\\omega$ 随时间成谐波变化，因此界面处的切向分量被规定为 $B_{y}(x=0,t) = \\text{Re}\\{ \\tilde{B}_{0} \\exp(i \\omega t)\\}$，其中 $\\tilde{B}_{0}$ 是一个复振幅。假设所有物理量都与 $y$ 和 $z$ 无关，仅随 $x$ 变化，并忽略位移电流。你可以使用微分形式的 Maxwell–Faraday 定律和 Maxwell–Ampère 定律，以及导体的 Ohm 定律。\n\n任务：\n- 从第一性原理出发，推导壁内 $B_{y}(x,t)$ 的一维控制方程。求解当 $x \\to \\infty$ 时衰减的谐波响应 $\\tilde{B}_{y}(x)$ 的复空间依赖关系。\n- 使用该解和 $\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$，计算壁内的感应涡流密度分布 $\\tilde{J}_{z}(x)$。\n- 对涡流分布沿壁厚度积分，以获得净表面电流密度（面电流）的复振幅 $\\tilde{K}_{z}(\\omega) = \\int_{0}^{\\infty} \\tilde{J}_{z}(x)\\,dx$，作为 $\\omega$ 的函数，并仅用 $\\tilde{B}_{0}$ 和 $\\mu_{0}$ 表示。\n\n将 $\\tilde{K}_{z}(\\omega)$ 的最终答案以安培/米 (A/m) 为单位表示。不需要进行数值计算；请提供一个闭式解析表达式。如果引入了中间特征尺度（如趋肤深度），请用基本常数和参数 $\\mu_{0}$、$\\sigma$ 和 $\\omega$ 明确定义它们。",
            "solution": "首先对问题进行验证，以确保其在科学上是合理的、良定的和客观的。\n\n### 步骤 1: 提取已知条件\n- **几何结构**：一个平面导电半空间（壁）占据区域 $x \\geq 0$。真空占据区域 $x  0$。\n- **壁的属性**：该壁为非磁性（磁导率 $\\mu_0$）、均匀且各向同性，电导率为 $\\sigma$。\n- **边界条件**：在 $x=0$ 界面处施加一个均匀切向磁场。其值被规定为 $B_{y}(x=0,t) = \\text{Re}\\{ \\tilde{B}_{0} \\exp(i \\omega t)\\}$，其中 $\\tilde{B}_{0}$ 是复振幅，$\\omega$ 是角频率。\n- **对称性**：所有物理量仅是空间坐标 $x$ 和时间 $t$ 的函数，即它们与 $y$ 和 $z$ 无关。磁场为 $\\mathbf{B}(x,t) = B_y(x,t) \\hat{\\mathbf{j}}$。\n- **控制方程**：Maxwell–Faraday 定律 ($\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$)、Maxwell–Ampère 定律 ($\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$) 和 Ohm 定律 ($\\mathbf{J} = \\sigma \\mathbf{E}$)。\n- **近似**：忽略位移电流，这已经包含在所提供的 Maxwell-Ampère 定律的形式中。\n- **目标**：\n    1. 推导壁内（$x \\geq 0$）$B_{y}(x,t)$ 的控制方程，并找到当 $x \\to \\infty$ 时衰减的解的复空间依赖关系 $\\tilde{B}_{y}(x)$。\n    2. 计算感应涡流密度复振幅 $\\tilde{J}_{z}(x)$。\n    3. 计算净表面电流密度复振幅 $\\tilde{K}_{z}(\\omega) = \\int_{0}^{\\infty} \\tilde{J}_{z}(x)\\,dx$。\n\n### 步骤 2: 使用提取的已知条件进行验证\n这是一个关于导体中趋肤效应和涡流的经典电磁学问题。\n- **科学合理性**：该问题基于电磁学的基本原理（Maxwell 方程组, Ohm 定律），并使用了一个标准的物理模型（电阻半空间）。准静态近似（忽略位移电流）适用于良导体中的低频现象。该问题在科学上是合理的。\n- **良定性**：该问题提供了一个待推导的偏微分方程，以及在 $x=0$ 和 $x \\to \\infty$ 处的良定义边界条件。这种结构确保了解的唯一性、稳定性和有意义性。\n- **客观性**：该问题使用精确、无歧义的科学语言进行陈述。\n- **完备性与一致性**：该问题是自洽的，并提供了所有必要的信息和控制定律。其中没有矛盾。\n\n### 步骤 3: 结论与行动\n问题有效。将提供解答。\n\n### 解答推导\n\n**任务 1：$\\tilde{B}_y(x)$ 的控制方程及其解**\n\n我们首先结合给定的定律，以找到导体内部磁场 $\\mathbf{B}$ 的单个方程。\n我们对 Maxwell-Ampère 定律取旋度：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla \\times (\\mu_0 \\mathbf{J}) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{V}) = \\nabla(\\nabla \\cdot \\mathbf{V}) - \\nabla^2 \\mathbf{V}$ 和磁场的 Gauss 定律 $\\nabla \\cdot \\mathbf{B} = 0$，等式左边简化为：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{B}) = - \\nabla^2 \\mathbf{B} $$\n对于等式右边，由于 $\\mu_0$ 是常数，我们有 $\\nabla \\times (\\mu_0 \\mathbf{J}) = \\mu_0 (\\nabla \\times \\mathbf{J})$。使用 Ohm 定律 $\\mathbf{J} = \\sigma \\mathbf{E}$，并假设电导率 $\\sigma$ 均匀：\n$$ \\mu_0 (\\nabla \\times \\mathbf{J}) = \\mu_0 \\sigma (\\nabla \\times \\mathbf{E}) $$\n现在，代入 Maxwell-Faraday 定律 $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$：\n$$ \\mu_0 \\sigma (\\nabla \\times \\mathbf{E}) = - \\mu_0 \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t} $$\n令简化后的左边和右边相等，得到磁扩散方程：\n$$ - \\nabla^2 \\mathbf{B} = - \\mu_0 \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t} \\implies \\nabla^2 \\mathbf{B} = \\mu_0 \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t} $$\n根据问题的对称性，$\\mathbf{B} = B_y(x,t) \\hat{\\mathbf{j}}$，拉普拉斯算子简化为 $\\nabla^2 \\mathbf{B} = \\frac{\\partial^2 B_y}{\\partial x^2} \\hat{\\mathbf{j}}$。一维扩散方程为：\n$$ \\frac{\\partial^2 B_y}{\\partial x^2} = \\mu_0 \\sigma \\frac{\\partial B_y}{\\partial t} $$\n我们寻求形式为 $B_y(x,t) = \\text{Re}\\{ \\tilde{B}_y(x) \\exp(i \\omega t) \\}$ 的谐波解。将其代入扩散方程，时间导数变为 $\\frac{\\partial B_y}{\\partial t} = \\text{Re}\\{ i \\omega \\tilde{B}_y(x) \\exp(i \\omega t) \\}$。由此得到关于复振幅 $\\tilde{B}_y(x)$ 的常微分方程：\n$$ \\frac{d^2 \\tilde{B}_y}{dx^2} = i \\omega \\mu_0 \\sigma \\tilde{B}_y $$\n我们可以将其写作 $\\frac{d^2 \\tilde{B}_y}{dx^2} - k^2 \\tilde{B}_y = 0$，其中 $k^2 = i \\omega \\mu_0 \\sigma$。\n复波数 $k$ 为 $k = \\sqrt{i \\omega \\mu_0 \\sigma}$。我们使用 $\\sqrt{i} = \\exp(i\\pi/4) = \\frac{1+i}{\\sqrt{2}}$ 这一关系。\n$$ k = \\sqrt{\\omega \\mu_0 \\sigma} \\frac{1+i}{\\sqrt{2}} = \\frac{1+i}{\\delta} $$\n这里，我们定义特征趋肤深度 $\\delta$ 为：\n$$ \\delta = \\sqrt{\\frac{2}{\\omega \\mu_0 \\sigma}} $$\n$\\tilde{B}_y(x)$ 的通解为：\n$$ \\tilde{B}_y(x) = C_1 \\exp(kx) + C_2 \\exp(-kx) = C_1 \\exp\\left(\\frac{1+i}{\\delta}x\\right) + C_2 \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\n我们应用边界条件。首先，当 $x \\to \\infty$ 时，场必须衰减。项 $\\exp\\left(\\frac{1+i}{\\delta}x\\right) = \\exp(x/\\delta)\\exp(ix/\\delta)$ 随 $x$ 指数增长，因此我们必须将其系数 $C_1=0$。\n这剩下 $\\tilde{B}_y(x) = C_2 \\exp\\left(-\\frac{1+i}{\\delta}x\\right)$。\n第二个边界条件是在界面 $x=0$ 处，该处的切向磁场被规定为 $\\tilde{B}_y(0) = \\tilde{B}_0$。\n$$ \\tilde{B}_y(0) = C_2 \\exp(0) = C_2 = \\tilde{B}_0 $$\n因此，壁内磁场的复空间依赖关系为：\n$$ \\tilde{B}_y(x) = \\tilde{B}_0 \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\n\n**任务 2：感应涡流密度 $\\tilde{J}_z(x)$**\n\n感应涡流密度 $\\mathbf{J}$ 可由 Maxwell-Ampère 定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$ 求得。对于谐波场，此定律为 $\\nabla \\times \\tilde{\\mathbf{B}} = \\mu_0 \\tilde{\\mathbf{J}}$。\n$$ \\tilde{\\mathbf{J}}(x) = \\frac{1}{\\mu_0} \\nabla \\times \\tilde{\\mathbf{B}}(x) $$\n对于 $\\tilde{\\mathbf{B}}(x) = \\tilde{B}_y(x) \\hat{\\mathbf{j}}$，其旋度为：\n$$ \\nabla \\times \\tilde{\\mathbf{B}} = \\left| \\begin{matrix} \\hat{\\mathbf{i}}  \\hat{\\mathbf{j}}  \\hat{\\mathbf{k}} \\\\ \\frac{\\partial}{\\partial x}  \\frac{\\partial}{\\partial y}  \\frac{\\partial}{\\partial z} \\\\ 0  \\tilde{B}_y(x)  0 \\end{matrix} \\right| = \\frac{d\\tilde{B}_y}{dx} \\hat{\\mathbf{k}} $$\n因此电流密度为 $\\tilde{\\mathbf{J}}(x) = \\tilde{J}_z(x) \\hat{\\mathbf{k}}$，其中：\n$$ \\tilde{J}_z(x) = \\frac{1}{\\mu_0} \\frac{d\\tilde{B}_y}{dx} $$\n对我们求得的 $\\tilde{B}_y(x)$ 解进行微分：\n$$ \\frac{d\\tilde{B}_y}{dx} = \\frac{d}{dx} \\left[ \\tilde{B}_0 \\exp\\left(-\\frac{1+i}{\\delta}x\\right) \\right] = \\tilde{B}_0 \\left(-\\frac{1+i}{\\delta}\\right) \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\n将此代入 $\\tilde{J}_z(x)$ 的表达式：\n$$ \\tilde{J}_z(x) = -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\exp\\left(-\\frac{1+i}{\\delta}x\\right) $$\n\n**任务 3：净表面电流密度 $\\tilde{K}_z(\\omega)$**\n\n净表面电流密度（或面电流）$\\tilde{K}_z(\\omega)$ 是体电流密度 $\\tilde{J}_z(x)$ 在导体整个厚度上（从 $x=0$ 到 $x=\\infty$）的积分。\n$$ \\tilde{K}_z(\\omega) = \\int_{0}^{\\infty} \\tilde{J}_{z}(x) \\,dx $$\n代入 $\\tilde{J}_z(x)$ 的表达式：\n$$ \\tilde{K}_z(\\omega) = \\int_{0}^{\\infty} \\left[ -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\exp\\left(-\\frac{1+i}{\\delta}x\\right) \\right] dx $$\n与 $x$ 无关的项可以移到积分号外面：\n$$ \\tilde{K}_z(\\omega) = -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\int_{0}^{\\infty} \\exp\\left(-\\frac{1+i}{\\delta}x\\right) dx $$\n该积分的计算结果为：\n$$ \\int_{0}^{\\infty} \\exp\\left(-\\frac{1+i}{\\delta}x\\right) dx = \\left[ \\frac{-1}{(1+i)/\\delta} \\exp\\left(-\\frac{1+i}{\\delta}x\\right) \\right]_{0}^{\\infty} $$\n$$ = \\left( -\\frac{\\delta}{1+i} \\right) \\left[ \\exp\\left(-\\frac{x}{\\delta}\\right)\\exp\\left(-\\frac{ix}{\\delta}\\right) \\right]_{0}^{\\infty} $$\n当 $x \\to \\infty$ 时，项 $\\exp(-x/\\delta) \\to 0$。在 $x=0$ 处，指数项为 $1$。\n$$ = \\left( -\\frac{\\delta}{1+i} \\right) (0 - 1) = \\frac{\\delta}{1+i} $$\n将此结果代回 $\\tilde{K}_z(\\omega)$ 的表达式：\n$$ \\tilde{K}_z(\\omega) = -\\frac{\\tilde{B}_0}{\\mu_0} \\left(\\frac{1+i}{\\delta}\\right) \\left(\\frac{\\delta}{1+i}\\right) $$\n包含趋肤深度 $\\delta$ 和复数 $(1+i)$ 的项相互消去，得到一个非常简洁的结果：\n$$ \\tilde{K}_z(\\omega) = -\\frac{\\tilde{B}_0}{\\mu_0} $$\n这个结果表明，总感应面电流与壁的电导率 $\\sigma$ 和频率 $\\omega$ 无关。它仅取决于表面上施加的磁场和自由空间的磁导率。感应电流的流动方式会产生一个与外加场相反的磁场，从而提供屏蔽效果。",
            "answer": "$$\\boxed{-\\frac{\\tilde{B}_{0}}{\\mu_{0}}}$$"
        },
        {
            "introduction": "理论模型通常假设导体是理想均匀的，但现实中的聚变装置壁具有复杂的几何形状，包括窗口和结构加强筋。本练习通过将非均匀壁建模为离散的电阻网络，弥合了理论与应用之间的差距。你将在一个计算框架内应用基尔霍夫定律来确定涡流的分布，从而展示数值方法在分析真实工程结构的电磁行为方面的关键作用。",
            "id": "3979855",
            "problem": "考虑一个围绕着环形等离子体的薄导电电阻壳层。该壳层具有离散的极向肋和切口，这些结构会改变电流路径。极向模数 $m$ 和环向模数 $n$ 的等离子体扰动会在极向路径上驱动电动势。从法拉第定律和欧姆定律出发，构建一个等效电阻网络，以捕捉场穿透以及带肋和带端口的电阻壁的屏蔽效应。然后，在指定的 $(m,n)$ 谐波扰动下，计算感应电流分布。\n\n假设与基本原理：\n- 法拉第定律：$\\oint_{\\Gamma} \\mathbf{E} \\cdot d\\mathbf{l} = -\\dfrac{d}{dt} \\int_{S} \\mathbf{B} \\cdot d\\mathbf{S}$。\n- 薄电阻导体的欧姆定律：$\\mathbf{J} = \\sigma \\mathbf{E}$，其中 $\\sigma$ 是电导率，$\\mathbf{J}$ 是电流密度；对于集总元件，$V = R I$，其中电压为 $V$，电阻为 $R$，电流为 $I$。\n- 对于角频率为 $\\omega$ 的时谐扰动，在极向角 $\\theta$ 和环向角 $\\phi$ 处的短极向段周围的电动势可以由一个源项 $V_{\\mathrm{src}}(\\theta,\\phi)$ 表示，该源项与扰动的单个傅里叶分量的实部成正比。我们将此源建模为 $V_{\\mathrm{src}}(\\theta,\\phi) = V_0 \\cos(m \\theta + n \\phi + \\varphi)$，其中 $V_0$ 是给定的振幅（单位：伏特），$m$ 和 $n$ 是整数（模数），$\\varphi$ 是相位（单位：弧度）。角度 $\\theta$ 和 $\\phi$ 以弧度为单位。\n\n网络构建：\n- 将壳层离散化为 $N_{\\theta}$ 个极向节点和 $N_{\\phi}$ 个环向扇区，形成 $N_{\\theta} \\times N_{\\phi}$ 个节点，由 $(k,j)$ 索引。极向节点均匀分布在角度 $\\theta_k = 2\\pi k / N_{\\theta}$（$k = 0,1,\\dots,N_{\\theta}-1$），环向扇区位于角度 $\\phi_j = 2\\pi j / N_{\\phi}$（$j = 0,1,\\dots,N_{\\phi}-1$）。\n- 在 $(k,j)$ 和 $(k+1 \\bmod N_{\\theta},j)$ 之间添加极向边，其电阻为 $R_{\\mathrm{p}}$（单位：欧姆），以表示导电壁段。在对应于端口（由集合 $\\mathcal{P}$ 中的索引 $k$ 指定）的极向边上，省略极向壁边，而是添加一个连接相同节点且电阻为 $R_{\\mathrm{rib}}$（单位：欧姆）的肋边。肋没有直接的电动势源项，并且仅存在于端口破坏壁的地方。\n- 在 $(k,j)$ 和 $(k,j+1 \\bmod N_{\\phi})$ 之间添加环向边，其电阻为 $R_{\\mathrm{t}}$（单位：欧姆），以表示环向导电。\n- 根据 $V_{\\mathrm{src}} = V_0 \\cos(m \\,\\theta_{\\mathrm{mid}} + n \\,\\phi_j + \\varphi)$ 为每个极向壁边（非肋）分配一个源电动势 $V_{\\mathrm{src}}$，其中 $\\theta_{\\mathrm{mid}} = 2\\pi (k+0.5)/N_{\\theta}$ 是极向边的中点。肋和环向边的 $V_{\\mathrm{src}} = 0$。\n\n数学公式：\n- 定义有向关联矩阵 $B \\in \\mathbb{R}^{N \\times E}$，其中 $N = N_{\\theta} N_{\\phi}$ 是节点数，$E$ 是边数。对于每个从节点 $u$ 指向节点 $v$ 的边 $e$，设置 $B_{u,e} = +1$ 和 $B_{v,e} = -1$，其他位置为零。\n- 令 $G = \\mathrm{diag}(g_e)$ 为对角电导矩阵，其中 $g_e = 1/R_e$ 对应每条边 $e$。令 $V \\in \\mathbb{R}^{E}$ 为收集了边源项 $V_{\\mathrm{src},e}$ 的向量。\n- 边电流遵循 $I_e = g_e \\left( (v_u - v_v) - V_{\\mathrm{src},e} \\right)$，其中 $v_u$ 和 $v_v$ 是节点电势。用节点电势向量 $v \\in \\mathbb{R}^{N}$ 和边电流向量 $I \\in \\mathbb{R}^{E}$ 表示，其向量形式为 $I = G (B^{\\top} v - V)$。\n- 根据基尔霍夫电流定律 (KCL)，流入每个节点的净电流为零：$B I = 0$。代入边的本构关系，得到加权图拉普拉斯系统 $L v = B G V$，其中 $L = B G B^{\\top}$。\n- 将单个参考（接地）节点的电势固定为零以消除零空间，然后求解 $v$ 并计算边电流 $I$。\n\n输出：\n- 对于每个提供的测试用例，计算：\n  1. 极向壁边（不包括肋）上的最大绝对电流大小，记为 $I_{\\max}^{\\mathrm{p}}$。\n  2. 肋边上的最大绝对电流大小，记为 $I_{\\max}^{\\mathrm{rib}}$。\n  3. 环向边上的最大绝对电流大小，记为 $I_{\\max}^{\\mathrm{t}}$。\n- 所有电流必须以安培为单位表示，并四舍五入到六位小数。\n\n角度单位说明：\n- 所有角度 $\\theta$ 和 $\\phi$ 以及相位 $\\varphi$ 均以弧度为单位。\n\n测试套件：\n- 案例 1（一般情况）：$N_{\\theta} = 12$，$N_{\\phi} = 8$，$R_{\\mathrm{p}} = 0.2~\\mathrm{\\Omega}$，$R_{\\mathrm{t}} = 0.3~\\mathrm{\\Omega}$，$R_{\\mathrm{rib}} = 1.0~\\mathrm{\\Omega}$，$\\mathcal{P} = \\{3, 9\\}$，$V_0 = 0.5~\\mathrm{V}$，$m = 2$，$n = 1$，$\\varphi = 0$。\n- 案例 2（环向隔离边界）：$N_{\\theta} = 16$，$N_{\\phi} = 5$，$R_{\\mathrm{p}} = 0.25~\\mathrm{\\Omega}$，$R_{\\mathrm{t}} = 1000.0~\\mathrm{\\Omega}$，$R_{\\mathrm{rib}} = 2.0~\\mathrm{\\Omega}$，$\\mathcal{P} = \\{0, 5, 11\\}$，$V_0 = 0.4~\\mathrm{V}$，$m = 3$，$n = 2$，$\\varphi = \\pi/4$。\n- 案例 3（近乎开路的肋边情况）：$N_{\\theta} = 10$，$N_{\\phi} = 7$，$R_{\\mathrm{p}} = 0.15~\\mathrm{\\Omega}$，$R_{\\mathrm{t}} = 0.5~\\mathrm{\\Omega}$，$R_{\\mathrm{rib}} = 10^5~\\mathrm{\\Omega}$，$\\mathcal{P} = \\{2, 7\\}$，$V_0 = 0.6~\\mathrm{V}$，$m = 1$，$n = 3$，$\\varphi = -\\pi/6$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为逗号分隔的列表，并用方括号括起来，顺序为 $\\left[I_{\\max}^{\\mathrm{p}}(1), I_{\\max}^{\\mathrm{rib}}(1), I_{\\max}^{\\mathrm{t}}(1), I_{\\max}^{\\mathrm{p}}(2), I_{\\max}^{\\mathrm{rib}}(2), I_{\\max}^{\\mathrm{t}}(2), I_{\\max}^{\\mathrm{p}}(3), I_{\\max}^{\\mathrm{rib}}(3), I_{\\max}^{\\mathrm{t}}(3)\\right]$，其中每个条目都四舍五入到六位小数，并以安培为单位表示。例如：$[x_1,x_2,\\dots,x_9]$。",
            "solution": "该问题要求计算电阻壳层离散化模型中的感应电流分布，这是磁约束聚变装置分析中的一项常见任务。壳层具有离散的肋和端口，这会在电导率中引入各向异性。解决方法是将壳层建模为电路网络，并求解由特定等离子体扰动感应出的电流。该解法源于第一性原理：欧姆定律、法拉第感应定律和基尔霍夫电路定律。\n\n首先，我们建立网络模型。环形壳层被离散化为一个 `$N_{\\theta} \\times N_{\\phi}$` 的节点网格，其中 `$N_{\\theta}$` 是极向划分数，`$N_{\\phi}$` 是环向扇区数。位于极向角 `$\\theta_k = 2\\pi k / N_{\\theta}$` 和环向角 `$\\phi_j = 2\\pi j / N_{\\phi}$` 的节点由 `$(k,j)$` 索引，这可以映射为单个整数索引以进行矩阵运算。这些节点通过电阻边连接。\n\n此网络中有三种类型的边：\n1.  **极向壁边**：这些边连接极向上的相邻节点，即 `$(k,j)$` 和 `$(k+1 \\pmod{N_{\\theta}}, j)$`，电阻为 `$R_{\\mathrm{p}}$`。它们代表壳壁的主要导电路径。\n2.  **极向肋边**：在由集合 `$\\mathcal{P}$` 指定的位置，极向壁段被一个切口端口取代。一个电阻肋跨接此端口，连接相同的节点 `$(k,j)$` 和 `$(k+1 \\pmod{N_{\\theta}}, j)$`，但具有不同的电阻 `$R_{\\mathrm{rib}}$`。\n3.  **环向边**：这些边连接环向上的相邻节点，即 `$(k,j)$` 和 `$(k, j+1 \\pmod{N_{\\phi}})$`，电阻为 `$R_{\\mathrm{t}}$`。\n\n等离子体扰动感生出电动势（EMF），驱动壳层中的电流。根据法拉第定律，此电动势与时变磁通量有关。对于时谐扰动，此电动势可以建模为每个导电段上的电压源。问题规定这些源 `$V_{\\mathrm{src}}$` 仅存在于极向壁边上（不在肋或环向边上）。连接 `$(k,j)$` 和 `$(k+1, j)$` 的边上的源强度由 `$V_{\\mathrm{src},e} = V_0 \\cos(m \\theta_{\\mathrm{mid}} + n \\phi_j + \\varphi)$` 给出，其中 `$\\theta_{\\mathrm{mid}} = 2\\pi(k+0.5)/N_{\\theta}$` 是该边的极向中点。\n\n网络定义好后，我们应用电路理论来求解未知的节点电势和边电流。设 `$v \\in \\mathbb{R}^{N}$` 为 `$N = N_{\\theta}N_{\\phi}$` 个节点处的标量电势向量，`$I \\in \\mathbb{R}^{E}$` 为流过 `$E$` 条边的电流向量。节点电势与每条边上的电势差之间的关系可以用有向关联矩阵 `$B \\in \\mathbb{R}^{N \\times E}$` 来描述。对于一条从节点 `$u$` 指向 `$v$` 的边 `$e$`，`$B_{u,e} = +1$` 且 `$B_{v,e} = -1$`。所有边上的电势差向量则为 `$\\Delta v = B^{\\top}v$`。\n\n对于具有电导 `$g_e = 1/R_e$` 和源电压 `$V_{\\mathrm{src},e}$` 的单条边 `$e$`，欧姆定律指出电流为 `$I_e = g_e(\\Delta v_e - V_{\\mathrm{src},e})$`，其中 `$\\Delta v_e = v_u - v_v$` 是电势降。其向量形式为 `$I = G(B^{\\top}v - V)$`，其中 `$G$` 是边电导的对角矩阵，`$V$` 是源电动势向量。\n\n基尔霍夫电流定律 (KCL) 指出，流入任何节点的电流总和必须为零。其矩阵形式为 `$B I = 0$`。代入欧姆定律中 `$I$` 的表达式得到：\n$$B (G(B^{\\top}v - V)) = 0$$\n重新整理此方程，得到待求解的线性方程组：\n$$(B G B^{\\top})v = B G V$$\n矩阵 `$L = B G B^{\\top}$` 被称为加权图拉普拉斯算子。这个 `$N \\times N$` 矩阵是对称半正定的。它有一个一维的零空间，对应于所有节点上恒定的电势偏移（即，对于 `$v = c \\mathbf{1}$`，有 `$Lv = 0$`，其中 `$\\mathbf{1}$` 是全一向量）。这个物理上的不确定性通过设置一个参考电势来解决。我们选择将一个节点接地，例如索引为 `$0$` 的节点（对应 `$k=0, j=0$`），通过设置其电势 `$v_0 = 0$`。这会从系统中移除一行和一列，从而得到一个更小的、可逆的 `$(N-1) \\times (N-1)$` 系统，可以唯一地解出其余的 `$N-1$` 个节点电势。\n\n解决每个测试用例的算法如下：\n1.  **网络构建**：根据参数 `$N_{\\theta}$`、`$N_{\\phi}$` 和 `$\\mathcal{P}$` 系统地生成所有节点和边。为每条边存储其起始和终止节点、类型（极向壁、肋或环向）、电阻（`$R_{\\mathrm{p}}$`、`$R_{\\mathrm{rib}}$` 或 `$R_{\\mathrm{t}}$`）以及其源电动势 `$V_{\\mathrm{src}}$`。\n2.  **矩阵组装**：基于网络结构构建关联矩阵 `$B$`、电导向量 `$g$` 和源向量 `$V$`。\n3.  **线性系统构建**：计算拉普拉斯矩阵 `$L = B \\mathrm{diag}(g) B^{\\top}$` 和右侧源向量 `$f = B (\\mathrm{diag}(g)V)$`。为了提高计算效率，`L` 可以通过 `(B * g) @ B.T` 构建，`f` 可以通过 `B @ (g * V)` 构建。\n4.  **求解电势**：通过移除与接地节点（节点 `$0$`) 对应的行和列来修改系统 `$Lv = f$`。使用标准的线性求解器求解得到的简化的、非奇异的线性系统，以获得未知电势。通过包含 `$v_0=0$` 来重构完整的电势向量 `$v$`。\n5.  **计算电流**：确定完整的节点电势向量 `$v$` 后，使用欧姆定律的向量形式计算每条边中的电流：`$I = g \\odot (B^{\\top}v - V)$`，其中 `$\\odot$` 表示逐元素相乘。\n6.  **提取结果**：根据边的类型对计算出的电流进行分类。找出每个类别中的最大绝对值：`$\\smash{I_{\\max}^{\\mathrm{p}}}$`（极向壁）、`$\\smash{I_{\\max}^{\\mathrm{rib}}}$`（肋）和 `$\\smash{I_{\\max}^{\\mathrm{t}}}$`（环向）。如果某个类别不包含任何边（例如，没有肋），则其最大电流为 `$0$`。然后将结果四舍五入到六位小数。\n\n这个过程是确定性的，并提供了完整的电流分布，从中可以提取所需的最大值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not required for this solution.\n\ndef solve_case(N_theta, N_phi, R_p, R_t, R_rib, P_set, V0, m, n, phi_phase):\n    \"\"\"\n    Constructs and solves the resistive network for one set of parameters.\n    \"\"\"\n    N = N_theta * N_phi\n    \n    edges = []\n    edge_types = []\n    edge_resistances = []\n    edge_sources = []\n\n    # Helper to map (k, j) to a single node index\n    def node_idx(k, j):\n        return k * N_phi + j\n\n    # 1. Poloidal edges (wall segments and ribs)\n    for j in range(N_phi):\n        for k in range(N_theta):\n            u = node_idx(k, j)\n            v = node_idx((k + 1) % N_theta, j)\n            edges.append((u, v))\n            \n            if k in P_set:\n                edge_types.append('rib')\n                edge_resistances.append(R_rib)\n                edge_sources.append(0.0)\n            else:\n                edge_types.append('poloidal_wall')\n                edge_resistances.append(R_p)\n                \n                theta_mid = 2.0 * np.pi * (k + 0.5) / N_theta\n                phi_j = 2.0 * np.pi * j / N_phi\n                v_src = V0 * np.cos(m * theta_mid + n * phi_j + phi_phase)\n                edge_sources.append(v_src)\n\n    # 2. Toroidal edges\n    for k in range(N_theta):\n        for j in range(N_phi):\n            u = node_idx(k, j)\n            v = node_idx(k, (j + 1) % N_phi)\n            edges.append((u, v))\n            edge_types.append('toroidal')\n            edge_resistances.append(R_t)\n            edge_sources.append(0.0)\n            \n    E = len(edges)\n\n    # 3. Construct matrices B, G, and V\n    B = np.zeros((N, E))\n    for e, (u, v) in enumerate(edges):\n        B[u, e] = 1\n        B[v, e] = -1\n    \n    g = 1.0 / np.array(edge_resistances)\n    V_src_vec = np.array(edge_sources)\n    \n    # 4. Formulate the linear system L*v = f\n    # L = B @ np.diag(g) @ B.T\n    # More efficient calculation:\n    L = (B * g) @ B.T\n    \n    # f = B @ np.diag(g) @ V_src_vec\n    # More efficient calculation:\n    f = B @ (g * V_src_vec)\n\n    # 5. Solve for potentials by grounding node 0\n    # The system L*v = f is singular. We fix v[0] = 0.\n    L_mod = L[1:, 1:]\n    f_mod = f[1:]\n\n    # The equation for node 0 might contribute to others if v_0 is not 0\n    # L_mod @ v_mod = f_mod - L[1:, 0] * v_0. Since v_0 = 0, this term vanishes.\n    v_mod = np.linalg.solve(L_mod, f_mod)\n    v = np.concatenate(([0.0], v_mod))\n    \n    # 6. Calculate edge currents\n    delta_v = B.T @ v\n    I = g * (delta_v - V_src_vec)\n    \n    # 7. Find maximum absolute currents by type\n    currents_p = []\n    currents_rib = []\n    currents_t = []\n    \n    for i in range(E):\n        if edge_types[i] == 'poloidal_wall':\n            currents_p.append(I[i])\n        elif edge_types[i] == 'rib':\n            currents_rib.append(I[i])\n        elif edge_types[i] == 'toroidal':\n            currents_t.append(I[i])\n    \n    I_max_p = np.max(np.abs(currents_p)) if currents_p else 0.0\n    I_max_rib = np.max(np.abs(currents_rib)) if currents_rib else 0.0\n    I_max_t = np.max(np.abs(currents_t)) if currents_t else 0.0\n\n    return round(I_max_p, 6), round(I_max_rib, 6), round(I_max_t, 6)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {'N_theta': 12, 'N_phi': 8, 'R_p': 0.2, 'R_t': 0.3, 'R_rib': 1.0, \n         'P_set': {3, 9}, 'V0': 0.5, 'm': 2, 'n': 1, 'phi_phase': 0.0},\n        # Case 2\n        {'N_theta': 16, 'N_phi': 5, 'R_p': 0.25, 'R_t': 1000.0, 'R_rib': 2.0, \n         'P_set': {0, 5, 11}, 'V0': 0.4, 'm': 3, 'n': 2, 'phi_phase': np.pi/4},\n        # Case 3\n        {'N_theta': 10, 'N_phi': 7, 'R_p': 0.15, 'R_t': 0.5, 'R_rib': 1e5, \n         'P_set': {2, 7}, 'V0': 0.6, 'm': 1, 'n': 3, 'phi_phase': -np.pi/6}\n    ]\n\n    results = []\n    for params in test_cases:\n        I_max_p, I_max_rib, I_max_t = solve_case(**params)\n        results.extend([I_max_p, I_max_rib, I_max_t])\n\n    # Format the final output string exactly as required\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}