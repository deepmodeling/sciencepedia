{
    "hands_on_practices": [
        {
            "introduction": "我们从一个经典的解析计算开始，以建立对 $\\Delta'$ 参数的基本理解。这项练习的目标是为一个标准的平面电流片平衡（即哈里斯片模型）推导出 $\\Delta'$。通过求解外部区域的理想磁流体力学方程，你将亲身体验稳定性参数如何直接从平衡磁场的曲率中产生，这是撕裂模理论中的一个基石性问题 。",
            "id": "4054616",
            "problem": "考虑一个二维板状等离子体，其笛卡尔坐标为 $(x,y)$，具有均匀的质量密度 $\\rho$ 和平衡磁场 $\\mathbf{B}_0(x)=B_y(x)\\,\\hat{\\mathbf{y}}$，其中 $B_y(x)=B_0 \\tanh(x/L)$，$B_0$ 和 $L$ 为正常数。假设在外部区域采用不可压缩线性理想磁流体力学（MHD）模型，平衡流可忽略不计，扰动正比于 $\\exp(i k y - i \\omega t)$，其中波数 $k0$ 为实数，频率 $\\omega$ 小到足以使外部区域的动力学行为能被理想磁流体力学很好地近似。设有理面位于 $x=0$ 处，此处 $B_y(0)=0$。引入扰动磁通函数 $\\psi(x)$，使得扰动磁场为 $\\delta \\mathbf{B}=\\nabla \\times (\\psi \\,\\hat{\\mathbf{z}})$。\n\n从适用于该几何构型的线性化外部区域理想磁流体力学方程出发，推导外部磁通函数 $\\psi(x)$ 所满足的常微分方程，并在物理边界条件 $\\psi(x)\\to 0$ 当 $x\\to \\pm \\infty$ 下求解该方程。定义撕裂模不稳定性参数 $\\Delta'$ 为\n$$\n\\Delta' \\equiv \\left[\\frac{d}{dx}\\ln \\psi(x)\\right]_{x=0^{+}} - \\left[\\frac{d}{dx}\\ln \\psi(x)\\right]_{x=0^{-}} = \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)}\\,,\n$$\n为便于计算，将解归一化，使得 $\\psi(0)=1$。\n\n计算 $\\Delta'$，将其表示为关于 $k$ 和 $L$ 的闭式解析表达式。无需进行数值取整。最终答案需以符号形式表示，不包含单位。",
            "solution": "用户请求解答一个计算聚变科学问题。我将首先根据指定程序验证问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **系统**：一个二维板状等离子体，其笛卡尔坐标为 $(x,y)$。\n- **等离子体性质**：均匀质量密度 $\\rho$。\n- **平衡磁场**：$\\mathbf{B}_0(x)=B_y(x)\\,\\hat{\\mathbf{y}}$。\n- **磁场分布**：$B_y(x)=B_0 \\tanh(x/L)$，其中 $B_0  0$ 和 $L  0$ 为常数。\n- **模型**：外部区域的不可压缩线性理想磁流体力学（MHD）。\n- **平衡流**：可忽略不计。\n- **扰动**：正比于 $\\exp(i k y - i \\omega t)$，其中波数 $k0$ 为实数。\n- **近似**：频率 $\\omega$ 很小，使得外部区域的动力学可以用理想磁流体力学很好地近似。\n- **有理面**：位于 $x=0$ 处，此处 $B_y(0)=0$。\n- **扰动磁通函数**：$\\psi(x)$ 的定义使得扰动磁场为 $\\delta \\mathbf{B}=\\nabla \\times (\\psi \\,\\hat{\\mathbf{z}})$，其时空依赖关系为 $\\psi(x,y,t) = \\psi(x) \\exp(i k y - i \\omega t)$。\n- **边界条件**：当 $x\\to \\pm \\infty$ 时，$\\psi(x)\\to 0$。\n- **$\\Delta'$ 的定义**：$\\Delta' \\equiv \\left[\\frac{d}{dx}\\ln \\psi(x)\\right]_{x=0^{+}} - \\left[\\frac{d}{dx}\\ln \\psi(x)\\right]_{x=0^{-}} = \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)}$。\n- **归一化**：为便于计算，$\\psi(0)=1$。\n- **目标**：计算 $\\Delta'$，将其表示为关于 $k$ 和 $L$ 的闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是等离子体撕裂模理论中的一个经典练习，基于完善的理想磁流体力学框架。Harris 片状平衡 $\\mathbf{B}_0 \\propto \\tanh(x/L)$ 是一个标准的教科书模型。\n- **适定性**：该问题提供了明确的目标、所有必要的物理参数、一个控制模型（理想磁流体力学）、边界条件，以及对所求量（$\\Delta'$）的精确定义。预期有唯一解。\n- **客观性**：问题陈述使用了等离子体物理学中精确、标准的术语，没有歧义或主观论断。\n- **清单评估**：该问题没有违反任何指定的无效性标准。它在科学上是合理的、可形式化的、完整的、现实的、适定的且非平凡的。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n\n该问题考虑了等离子体板在“外部区域”的稳定性，该区域定义为远离 $x=0$ 处有理面的区域。在此区域中，等离子体被视为理想导体，并由理想磁流体力学方程控制。对于撕裂模，我们考虑临界稳定性的极限，此时动量方程中的惯性项可以忽略不计（$\\omega \\to 0$）。线性化的理想磁流体力学动量方程简化为力平衡方程：\n$$\n(\\nabla \\times \\delta\\mathbf{B}) \\times \\mathbf{B}_0 + (\\nabla \\times \\mathbf{B}_0) \\times \\delta\\mathbf{B} - \\mu_0\\nabla \\delta p = \\mathbf{0}\n$$\n其中 $\\delta\\mathbf{B}$ 是扰动磁场，$\\delta p$ 是扰动压力。\n\n平衡场和扰动场由下式给出：\n$$\n\\mathbf{B}_0(x) = B_y(x)\\,\\hat{\\mathbf{y}}\n$$\n$$\n\\delta\\mathbf{B} = \\nabla \\times (\\psi(x) e^{iky} \\hat{\\mathbf{z}}) = \\left( \\frac{\\partial(\\psi e^{iky})}{\\partial y} \\hat{\\mathbf{x}} - \\frac{\\partial(\\psi e^{iky})}{\\partial x} \\hat{\\mathbf{y}} \\right) = (ik\\psi(x)\\hat{\\mathbf{x}} - \\psi'(x)\\hat{\\mathbf{y}}) e^{iky}\n$$\n其中撇号表示对 $x$ 的导数。\n\n平衡电流密度为 $\\mathbf{J}_0 = \\frac{1}{\\mu_0}\\nabla\\times\\mathbf{B}_0 = -\\frac{1}{\\mu_0}B_y'(x)\\hat{\\mathbf{z}}$。扰动电流密度为 $\\delta\\mathbf{J} = \\frac{1}{\\mu_0}\\nabla\\times\\delta\\mathbf{B} = \\frac{1}{\\mu_0}(-\\psi'' + k^2\\psi)\\hat{\\mathbf{z}}e^{iky}$。\n\n将这些代入力平衡方程：\n$$\n\\mu_0\\delta\\mathbf{J} \\times \\mathbf{B}_0 + \\mu_0\\mathbf{J}_0 \\times \\delta\\mathbf{B} - \\mu_0\\nabla \\delta p = \\mathbf{0}\n$$\n$$\n(-\\psi'' + k^2\\psi)B_y(x)(\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{y}}) - B_y'(x)(\\hat{\\mathbf{z}}\\times(ik\\psi\\hat{\\mathbf{x}} - \\psi'\\hat{\\mathbf{y}})) - \\mu_0 \\nabla\\delta p e^{-iky} = \\mathbf{0}\n$$\n$$\n-(-\\psi'' + k^2\\psi)B_y(x)\\hat{\\mathbf{x}} - B_y'(x)(ik\\psi\\hat{\\mathbf{y}} + \\psi'\\hat{\\mathbf{x}}) - \\mu_0 (\\frac{\\partial\\delta p}{\\partial x} \\hat{\\mathbf{x}} + ik\\delta p \\hat{\\mathbf{y}})e^{-iky} = \\mathbf{0}\n$$\n扰动 $\\delta p$ 具有相同的 $e^{iky}$ 依赖性，所以我们写作 $\\delta p(x,y) = \\delta p(x) e^{iky}$。\n\n令矢量分量相等：\n从 $\\hat{\\mathbf{y}}$ 分量：$-B_y'(x)ik\\psi - \\mu_0 ik\\delta p = 0 \\implies \\delta p = -\\frac{1}{\\mu_0}B_y'(x)\\psi(x)$。\n从 $\\hat{\\mathbf{x}}$ 分量：$-(- \\psi'' + k^2\\psi)B_y(x) - B_y'(x)\\psi' - \\mu_0 \\frac{d\\delta p}{dx} = 0$。\n\n将 $\\delta p$ 的表达式代入 $\\hat{\\mathbf{x}}$ 分量方程：\n$$\n(\\psi'' - k^2\\psi)B_y - B_y'\\psi' - \\mu_0 \\frac{d}{dx}\\left(-\\frac{1}{\\mu_0}B_y'\\psi\\right) = 0\n$$\n$$\n(\\psi'' - k^2\\psi)B_y - B_y'\\psi' + (B_y''\\psi + B_y'\\psi') = 0\n$$\n$$\n(\\psi'' - k^2\\psi)B_y + B_y''\\psi = 0\n$$\n这给出了磁通函数 $\\psi(x)$ 的外部区域方程：\n$$\n\\psi''(x) - \\left(k^2 + \\frac{B_y''(x)}{B_y(x)}\\right)\\psi(x) = 0\n$$\n此方程在 $x \\neq 0$ 时有效。\n\n接下来，我们对给定的磁场分布 $B_y(x) = B_0 \\tanh(x/L)$ 计算 $\\frac{B_y''}{B_y}$ 项：\n$$\nB_y'(x) = \\frac{B_0}{L}\\text{sech}^2(x/L)\n$$\n$$\nB_y''(x) = \\frac{B_0}{L} \\left( 2\\,\\text{sech}(x/L) \\cdot [-\\text{sech}(x/L)\\tanh(x/L)] \\cdot \\frac{1}{L} \\right) = -\\frac{2B_0}{L^2}\\text{sech}^2(x/L)\\tanh(x/L)\n$$\n$$\n\\frac{B_y''(x)}{B_y(x)} = \\frac{-\\frac{2B_0}{L^2}\\text{sech}^2(x/L)\\tanh(x/L)}{B_0\\tanh(x/L)} = -\\frac{2}{L^2}\\text{sech}^2(x/L)\n$$\n因此，$\\psi(x)$ 的控制常微分方程为：\n$$\n\\psi''(x) - \\left(k^2 - \\frac{2}{L^2}\\text{sech}^2(x/L)\\right)\\psi(x) = 0\n$$\n这是一个具有 Pöschl-Teller 势的类薛定谔方程。当 $x\\to\\pm\\infty$ 时，$\\text{sech}^2(x/L)\\to 0$，方程趋近于 $\\psi'' - k^2\\psi = 0$，其解为 $e^{\\pm kx}$。边界条件 $\\psi(x) \\to 0$ 在 $|x|\\to\\infty$ 时要求对于 $x0$，$\\psi(x) \\propto e^{-kx}$；对于 $x0$，$\\psi(x) \\propto e^{kx}$。\n\n对于 $x0$，满足边界条件的已知解析解是：\n$$\n\\psi_+(x) = C_+ \\left(1 + \\frac{1}{kL}\\tanh(x/L)\\right)e^{-kx}\n$$\n根据对称性，由于常微分方程是关于 $x$ 的偶函数，对于 $x0$ 满足边界条件的解是：\n$$\n\\psi_-(x) = C_- \\left(1 - \\frac{1}{kL}\\tanh(x/L)\\right)e^{kx}\n$$\n磁通函数 $\\psi(x)$ 在 $x=0$ 处必须是连续的。\n$\\psi_+(0) = C_+ (1+0)e^0 = C_+$。\n$\\psi_-(0) = C_- (1-0)e^0 = C_-$。\n连续性要求 $C_+ = C_-$。问题指定归一化条件 $\\psi(0)=1$，因此我们必须有 $C_+=C_-=1$。\n\n归一化后的外部解为：\n对于 $x0$：$\\psi_+(x) = \\left(1 + \\frac{1}{kL}\\tanh(x/L)\\right)e^{-kx}$。\n对于 $x0$：$\\psi_-(x) = \\left(1 - \\frac{1}{kL}\\tanh(x/L)\\right)e^{kx}$。\n\n现在，我们计算 $\\Delta'$ 所需的导数。对于 $x0$：\n$$\n\\psi_+'(x) = \\frac{d}{dx}\\left[ \\left(1 + \\frac{1}{kL}\\tanh(x/L)\\right)e^{-kx} \\right] = \\left(\\frac{1}{kL^2}\\text{sech}^2(x/L)\\right)e^{-kx} - k\\left(1 + \\frac{1}{kL}\\tanh(x/L)\\right)e^{-kx}\n$$\n在 $x \\to 0^+$ 处求值：\n$$\n\\psi_+'(0^+) = \\left(\\frac{1}{kL^2}\\text{sech}^2(0)\\right) - k\\left(1 + \\frac{1}{kL}\\tanh(0)\\right) = \\frac{1}{kL^2} - k\n$$\n对于 $x0$：\n$$\n\\psi_-'(x) = \\frac{d}{dx}\\left[ \\left(1 - \\frac{1}{kL}\\tanh(x/L)\\right)e^{kx} \\right] = \\left(-\\frac{1}{kL^2}\\text{sech}^2(x/L)\\right)e^{kx} + k\\left(1 - \\frac{1}{kL}\\tanh(x/L)\\right)e^{kx}\n$$\n在 $x \\to 0^-$ 处求值：\n$$\n\\psi_-'(0^-) = \\left(-\\frac{1}{kL^2}\\text{sech}^2(0)\\right) + k\\left(1 - \\frac{1}{kL}\\tanh(0)\\right) = -\\frac{1}{kL^2} + k\n$$\n撕裂模不稳定性参数 $\\Delta'$ 定义为：\n$$\n\\Delta' = \\frac{\\psi_+'(0^+) - \\psi_-'(0^-)}{\\psi(0)}\n$$\n由于 $\\psi(0)=1$，这变为：\n$$\n\\Delta' = \\left(\\frac{1}{kL^2} - k\\right) - \\left(-\\frac{1}{kL^2} + k\\right) = \\frac{1}{kL^2} - k + \\frac{1}{kL^2} - k\n$$\n$$\n\\Delta' = \\frac{2}{kL^2} - 2k\n$$\n此表达式可重写为 $\\Delta' = 2k\\left(\\frac{1}{(kL)^2} - 1\\right)$。",
            "answer": "$$\n\\boxed{\\frac{2}{kL^2} - 2k}\n$$"
        },
        {
            "introduction": "在掌握了基本的计算方法之后，一个关键的理论步骤是审视我们所用近似的有效性。这项练习探讨了撕裂模理论中的一个核心假设——“常数-$\\psi$”近似的自洽性。通过将外部区域的解泰勒展开到内部的电阻层，你将推导出该近似成立的条件，即它如何与 $\\Delta'$ 和电阻层宽度 $\\delta$ 相关联，这对于理解理论模型的适用边界至关重要 。",
            "id": "4054629",
            "problem": "考虑在电阻磁流体力学（MHD）框架下，平板位形中的线性撕裂模，其有理面位于 $x=0$。设在固定的螺旋角和时间下，扰动磁通函数为 $\\,\\psi_1(x)\\,$，并通过标准的外部区域理想磁流体力学匹配定义来定义撕裂模稳定性参数（也称为 $\\Delta'$ 参数）\n$$\n\\Delta' \\;\\equiv\\; \\lim_{\\epsilon\\to 0^+}\\,\\frac{\\psi_1'(+\\epsilon)-\\psi_1'(-\\epsilon)}{\\psi_1(0)}\\,,\n$$\n其中撇号表示对 $x$ 的微分，且 $\\psi_1(0)\\neq 0$。假设内部（电阻）层的半宽度 $\\,\\delta\\,$ 与宏观平衡尺度相比是渐近小的，并假设外部区域解在 $\\delta \\ll |x| \\ll$ 宏观尺度的范围内有效。\n\n常数-$\\psi$ 近似断言 $\\,\\psi_1(x)\\,$ 在内部层中的变化很弱，即对于 $|x|\\le \\delta$ 有 $|\\psi_1(x)-\\psi_1(0)| \\ll |\\psi_1(0)|$。仅使用 (i) 上述 $\\,\\Delta'\\,$ 的定义，(ii) $\\,\\psi_1(x)\\,$ 在 $x=0$ 处的连续性，以及 (iii) 外部区域解在 $x=0$ 两侧向内部层的一阶泰勒展开，估算 $\\,\\psi_1\\,$ 在内部层中相对变化的前导阶无量纲度量，\n$$\n\\varepsilon_{\\mathrm{c}\\psi} \\;\\equiv\\; \\max_{|x|\\le \\delta}\\,\\frac{|\\psi_1(x)-\\psi_1(0)|}{|\\psi_1(0)|}\\,,\n$$\n该表达式纯粹用 $\\,\\Delta'\\,$ 和 $\\,\\delta\\,$ 表示，不计入量级为1的乘法常数。将最终结果以 $\\,\\Delta'\\,$ 和 $\\,\\delta\\,$ 的单个闭式解析表达式的形式报告。不要陈述不等式。不要包含单位。",
            "solution": "首先根据指定标准验证问题陈述。\n\n### 问题验证\n\n**第一步：提取已知条件**\n-   **系统**：平板位形中的线性撕裂模，电阻磁流体力学（MHD）。\n-   **有理面位置**：$x=0$。\n-   **扰动变量**：扰动磁通函数 $\\psi_1(x)$。\n-   **$\\Delta'$ 的定义**：$\\Delta' \\equiv \\lim_{\\epsilon\\to 0^+}\\,\\frac{\\psi_1'(+\\epsilon)-\\psi_1'(-\\epsilon)}{\\psi_1(0)}$。\n-   **条件**：$\\psi_1(0)\\neq 0$。\n-   **内层半宽度**：$\\delta$。\n-   **渐近量级**：$\\delta$ 与宏观尺度相比是渐近小的。\n-   **外部区域有效性**：外部区域的理想磁流体力学解在 $\\delta \\ll |x| \\ll$ 宏观尺度的范围内有效。\n-   **常数-$\\psi$ 近似**：对于 $|x|\\le \\delta$，有 $|\\psi_1(x)-\\psi_1(0)| \\ll |\\psi_1(0)|$。\n-   **待估算的量**：$\\psi_1$ 在内层中相对变化的前导阶无量纲度量，$\\varepsilon_{\\mathrm{c}\\psi} \\equiv \\max_{|x|\\le \\delta}\\,\\frac{|\\psi_1(x)-\\psi_1(0)|}{|\\psi_1(0)|}$。\n-   **所需工具**：\n    1.  $\\Delta'$ 的定义。\n    2.  $\\psi_1(x)$ 在 $x=0$ 处的连续性。\n    3.  外部区域解向内层的一阶泰勒展开。\n-   **要求的输出格式**：一个关于 $\\varepsilon_{\\mathrm{c}\\psi}$ 的，用 $\\Delta'$ 和 $\\delta$ 表示的闭式解析表达式，不计入量级为1的乘法常数。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于电阻磁流体力学中撕裂模的经典理论，这是由 Furth、Killeen 和 Rosenbluth 开创的等离子体物理和聚变科学的基石。所有定义和概念，包括 $\\Delta'$、内外层结构以及常数-$\\psi$ 近似，都是标准的、科学上合理的。\n-   **适定性**：该问题是适定的。它要求使用一组特定的假设和方法来估算一个明确定义的量（$\\varepsilon_{\\mathrm{c}\\psi}$）。要求答案“不计入量级为1的乘法常数”是物理学中推导标度关系的常用做法，并提供了一个明确的目标。\n-   **客观性**：该问题的陈述语言精确、客观、定量，没有任何主观性或模糊性。\n\n**第三步：结论与行动**\n该问题在科学上是合理的，是自洽且适定的。它代表了磁流体力学稳定性领域中一个标准的、基础的计算。因此，该问题被视为**有效**。我们可以继续进行求解。\n\n### 求解\n\n目标是估算量 $\\varepsilon_{\\mathrm{c}\\psi}$，它被定义为扰动磁通函数 $\\psi_1(x)$ 在半宽度为 $\\delta$ 的内部电阻层中的最大相对变化。\n$$\n\\varepsilon_{\\mathrm{c}\\psi} \\equiv \\max_{|x|\\le \\delta}\\,\\frac{|\\psi_1(x)-\\psi_1(0)|}{|\\psi_1(0)|}\n$$\n问题指明，此估算应基于外部区域解在有理面 $x=0$ 附近的一阶泰勒展开。外部区域解由理想磁流体力学控制，在 $|x| \\gg \\delta$ 时有效。我们被要求使用其在 $x=0$ 附近的行为来近似层内 $|x| \\le \\delta$ 的 $\\psi_1(x)$。\n\n我们将 $x0$ 时的外部解表示为 $\\psi_{1,+}(x)$，将 $x0$ 时的外部解表示为 $\\psi_{1,-}(x)$。磁通函数必须是连续的，因此如问题所假设，$\\psi_{1,+}(0) = \\psi_{1,-}(0) = \\psi_1(0)$。\n\n对于小的正值 $x$，外部解 $\\psi_{1,+}(x)$ 在 $x=0$ 附近的一阶泰勒级数展开给出：\n$$\n\\psi_1(x) \\approx \\psi_1(0) + x \\psi_{1,+}'(0) \\quad \\text{for } 0  x \\le \\delta\n$$\n这里，$\\psi_{1,+}'(0)$ 表示外部解的导数在 $x$ 从正方向趋近于 $0$ 时的极限，我们可以将其写作 $\\psi_1'(0^+) \\equiv \\lim_{\\epsilon\\to 0^+} \\psi_1'(\\epsilon)$。\n\n类似地，对于小的负值 $x$，外部解 $\\psi_{1,-}(x)$ 的展开给出：\n$$\n\\psi_1(x) \\approx \\psi_1(0) + x \\psi_{1,-}'(0) \\quad \\text{for } -\\delta \\le x  0\n$$\n这里，$\\psi_{1,-}'(0)$ 是从负方向的极限，即 $\\psi_1'(0^-) \\equiv \\lim_{\\epsilon\\to 0^+} \\psi_1'(-\\epsilon)$。\n\n使用这些近似，层内的变化量 $\\psi_1(x) - \\psi_1(0)$ 由下式给出：\n$$\n\\psi_1(x) - \\psi_1(0) \\approx\n\\begin{cases}\nx \\psi_1'(0^+)  \\text{for } 0  x \\le \\delta \\\\\nx \\psi_1'(0^-)  \\text{for } -\\delta \\le x  0\n\\end{cases}\n$$\n我们需要找到在 $|x| \\le \\delta$ 范围内 $|\\psi_1(x) - \\psi_1(0)|$ 的最大值。在区间 $x \\in (0, \\delta]$ 上，函数 $|x \\psi_1'(0^+)|$ 对 $x$ 是线性的，其最大值出现在 $x=\\delta$ 处，值为 $\\delta |\\psi_1'(0^+)|$。在区间 $x \\in [-\\delta, 0)$ 上，函数 $|x \\psi_1'(0^-)|$ 的最大值出现在 $x=-\\delta$ 处，值为 $|-\\delta \\psi_1'(0^-)| = \\delta |\\psi_1'(0^-)|$。\n\n因此，在整个层 $|x| \\le \\delta$ 上的最大变化为：\n$$\n\\max_{|x|\\le \\delta} |\\psi_1(x)-\\psi_1(0)| \\approx \\delta \\max\\{|\\psi_1'(0^+)|, |\\psi_1'(0^-)|\\}\n$$\n将此代入 $\\varepsilon_{\\mathrm{c}\\psi}$ 的定义中：\n$$\n\\varepsilon_{\\mathrm{c}\\psi} \\approx \\frac{\\delta \\max\\{|\\psi_1'(0^+)|, |\\psi_1'(0^-)|\\}}{|\\psi_1(0)|}\n$$\n现在，我们必须将导数 $\\psi_1'(0^+)$ 和 $\\psi_1'(0^-)$ 与撕裂模稳定性参数 $\\Delta'$ 联系起来，其定义为：\n$$\n\\Delta' = \\frac{\\psi_1'(0^+) - \\psi_1'(0^-)}{\\psi_1(0)}\n$$\n这为两个未知数 $\\psi_1'(0^+)$ 和 $\\psi_1'(0^-)$ 提供了一个方程 $\\psi_1'(0^+) - \\psi_1'(0^-) = \\Delta' \\psi_1(0)$。为了继续，我们引用对称平衡（例如，对称的电流剖面）中基本撕裂模本征函数的一个标准性质。在这种情况下，外部理想磁流体力学方程在变换 $x \\to -x$ 下是不变的，其解可以按宇称分类。撕裂不稳定性对应于一个具有偶宇称的本征函数 $\\psi_1(x)$，即 $\\psi_1(x) = \\psi_1(-x)$。因此，其导数 $\\psi_1'(x)$ 必须具有奇宇称：$\\psi_1'(x) = -\\psi_1'(-x)$。取 $x \\to 0^+$ 的极限，这意味着导数有一个对称的跳跃：\n$$\n\\psi_1'(0^+) = -\\psi_1'(0^-)\n$$\n将此对称性条件代入 $\\Delta'$ 的定义中：\n$$\n\\Delta' \\psi_1(0) = \\psi_1'(0^+) - (-\\psi_1'(0^+)) = 2\\psi_1'(0^+)\n$$\n这使我们能够解出导数：\n$$\n\\psi_1'(0^+) = \\frac{1}{2} \\Delta' \\psi_1(0)\n$$\n$$\n\\psi_1'(0^-) = -\\frac{1}{2} \\Delta' \\psi_1(0)\n$$\n现在我们可以计算它们大小的最大值：\n$$\n\\max\\{|\\psi_1'(0^+)|, |\\psi_1'(0^-)|\\} = \\max\\left\\{\\left|\\frac{1}{2} \\Delta' \\psi_1(0)\\right|, \\left|-\\frac{1}{2} \\Delta' \\psi_1(0)\\right|\\right\\} = \\frac{1}{2} |\\Delta'| |\\psi_1(0)|\n$$\n最后，我们将此结果代回到我们关于 $\\varepsilon_{\\mathrm{c}\\psi}$ 的表达式中：\n$$\n\\varepsilon_{\\mathrm{c}\\psi} \\approx \\frac{\\delta}{|\\psi_1(0)|} \\left( \\frac{1}{2} |\\Delta'| |\\psi_1(0)| \\right) = \\frac{1}{2} |\\Delta'| \\delta\n$$\n问题要求估算结果不计入量级为1的乘法常数。因子 $1/2$ 就是这样一个常数。根据定义，量 $\\varepsilon_{\\mathrm{c}\\psi}$ 是非负的。由于 $\\delta  0$ 且 $\\Delta'$ 可以是任意符号，因此在量纲上和物理上正确的标度关系必须包含 $|\\Delta'|$。因此，$\\varepsilon_{\\mathrm{c}\\psi}$ 的前导阶估算与 $|\\Delta'| \\delta$ 成正比。\n\n这个结果很重要，因为它为常数-$\\psi$ 近似本身的有效性提供了条件，即 $\\varepsilon_{\\mathrm{c}\\psi} \\ll 1$，这意味着 $|\\Delta'|\\delta \\ll 1$。\n\n按照要求，去掉量级为1的乘法常数，我们得到最终的表达式。",
            "answer": "$$\n\\boxed{|\\Delta'| \\delta}\n$$"
        },
        {
            "introduction": "理论分析为我们提供了深刻的物理直觉，但在处理更真实的、复杂的平衡时，数值方法是不可或缺的。这项练习将引导你进入计算实践，学习如何使用“打靶法”这一强大的数值技术来求解外部区域的理想方程。通过为给定的边界条件计算 $\\Delta'$，你将掌握解决磁约束聚变中稳定性问题的关键计算技能 。",
            "id": "4054603",
            "problem": "考虑一个圆柱形磁化等离子体在径向位置 $r = r_s$ 处有理面附近的局域平板近似，其中角向模数 $m$ 和环向模数 $n$ 满足 $m/n = q(r_s)$，其中 $q(r)$ 为安全因子。在理想磁流体力学 (MHD) 的零压外区，螺旋磁通扰动本征函数 $\\psi_1(r)$ 满足一个通用的 Newcomb 型二阶常微分方程。在具有恒定垂直波数近似的局域平板模型中，该方程简化为常系数理想外区方程\n$$\n\\frac{d^2 \\psi_1}{dr^2} - k^2 \\psi_1 = 0,\n$$\n其中 $k$ 是恒定的有效径向波数，在局域柱形近似中，可以取 $k = m / r_s$（其中 $m$ 为整数， $r_s$ 单位为米）。撕裂模匹配参数 $\\Delta'$ 定义为 $\\psi_1(r)$ 的对数导数跨越有理面的跳变，\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi_1/dr}{\\psi_1}\\right|_{r_s^+} - \\left.\\frac{d\\psi_1/dr}{\\psi_1}\\right|_{r_s^-},\n$$\n其量纲为长度的倒数。\n\n您的任务是实现一个鲁棒的打靶匹配法来计算 $\\Delta'$，通过从 $r_s$ 的两侧对理想 MHD 外区方程进行数值积分。具体来说，对于每个测试用例：\n- 从内边界 $r = r_{\\mathrm{in}}$ 积分到 $r = r_s - \\varepsilon$，边界条件为 $\\psi_1(r_{\\mathrm{in}}) = 0$ 和 $d\\psi_1/dr|_{r_{\\mathrm{in}}} = 1$。\n- 从外边界 $r = r_{\\mathrm{out}}$ 积分到 $r = r_s + \\varepsilon$，边界条件为 $\\psi_1(r_{\\mathrm{out}}) = 0$ 和 $d\\psi_1/dr|_{r_{\\mathrm{out}}} = -1$。\n- 计算两侧的对数导数并计算\n$$\n\\Delta' \\approx \\frac{\\left(d\\psi_1/dr\\right)\\big|_{r_s + \\varepsilon}}{\\psi_1(r_s + \\varepsilon)} - \\frac{\\left(d\\psi_1/dr\\right)\\big|_{r_s - \\varepsilon}}{\\psi_1(r_s - \\varepsilon)}.\n$$\n使用严格大于 $0$ 的 $\\varepsilon$ 以避免在 $r = r_s$ 处的奇异点。以米的倒数 ($\\mathrm{m}^{-1}$) 为单位表示 $\\Delta'$，并将每个结果四舍五入到六位小数。\n\n打靶积分必须通过将二阶方程重写为状态向量 $\\mathbf{y} = [\\psi_1, d\\psi_1/dr]$ 的一阶系统来执行：\n$$\n\\frac{d}{dr}\\begin{bmatrix}\\psi_1\\\\ d\\psi_1/dr\\end{bmatrix} = \\begin{bmatrix} d\\psi_1/dr \\\\ k^2 \\psi_1 \\end{bmatrix}.\n$$\n要使用标准的前向积分器从 $r_{\\mathrm{out}}$ 向下积分到 $r_s + \\varepsilon$，需变换到变量 $u = -r$，于是\n$$\n\\frac{d}{du}\\begin{bmatrix}\\psi_1\\\\ d\\psi_1/dr\\end{bmatrix} = \\begin{bmatrix} -\\,d\\psi_1/dr \\\\ -\\,k^2 \\psi_1 \\end{bmatrix},\n$$\n该系统在 $u_{\\mathrm{out}} = -r_{\\mathrm{out}}$ 处初始化，并积分到 $u_{\\mathrm{target}} = -(r_s + \\varepsilon)$。\n\n为以下测试套件实现该算法，所有距离单位为米，所有输出为浮点数，单位为 $\\mathrm{m}^{-1}$：\n- 测试用例 1 (一般情况): $m = 2$, $r_{\\mathrm{in}} = 0.0$, $r_{\\mathrm{out}} = 1.0$, $r_s = 0.5$, $\\varepsilon = 10^{-4}$。\n- 测试用例 2 (有理面靠近外壁): $m = 2$, $r_{\\mathrm{in}} = 0.0$, $r_{\\mathrm{out}} = 1.0$, $r_s = 0.9$, $\\varepsilon = 10^{-4}$。\n- 测试用例 3 (更大的区域和更高的 $m$ 值): $m = 3$, $r_{\\mathrm{in}} = 0.1$, $r_{\\mathrm{out}} = 1.2$, $r_s = 0.6$, $\\varepsilon = 10^{-5}$。\n- 测试用例 4 (更大的外壁): $m = 4$, $r_{\\mathrm{in}} = 0.0$, $r_{\\mathrm{out}} = 1.5$, $r_s = 1.0$, $\\varepsilon = 10^{-4}$。\n- 测试用例 5 (有理面靠近内壁): $m = 1$, $r_{\\mathrm{in}} = 0.0$, $r_{\\mathrm{out}} = 1.0$, $r_s = 0.1$, $\\varepsilon = 10^{-4}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\Delta'_1,\\Delta'_2,\\Delta'_3,\\Delta'_4,\\Delta'_5]$），每个 $\\Delta'$ 四舍五入到六位小数，并以 $\\mathrm{m}^{-1}$ 为单位表示。",
            "solution": "该问题陈述已经过验证并被认为是有效的。它在科学上基于应用于磁约束聚变的理想磁流体力学（MHD）原理，特别是有关于撕裂模的稳定性。该问题是适定的，提供了明确的目标、一个有效的数学模型、所有必需的参数以及一个明确的数值步骤。任务是实现一个打靶匹配算法，为一个简化的等离子体模型计算撕裂模稳定性参数 $\\Delta'$。\n\n分析过程为，在有理面 $r=r_s$ 外部的区域内，数值求解螺旋磁通扰动 $\\psi_1(r)$ 的理想 MHD 外区方程。控制方程是一个具有常系数的二阶线性常微分方程（ODE）：\n$$\n\\frac{d^2 \\psi_1}{dr^2} - k^2 \\psi_1 = 0\n$$\n其中 $k = m/r_s$ 是有效径向波数。参数 $\\Delta'$ 定义为 $\\psi_1$ 的对数导数跨越有理面的跳变：\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi_1/dr}{\\psi_1}\\right|_{r_s^+} - \\left.\\frac{d\\psi_1/dr}{\\psi_1}\\right|_{r_s^-}\n$$\n问题为该量指定了一个数值近似，在离有理面一个微小距离 $\\varepsilon$ 处计算，以避免奇异点：\n$$\n\\Delta' \\approx \\frac{\\left(d\\psi_1/dr\\right)\\big|_{r_s + \\varepsilon}}{\\psi_1(r_s + \\varepsilon)} - \\frac{\\left(d\\psi_1/dr\\right)\\big|_{r_s - \\varepsilon}}{\\psi_1(r_s - \\varepsilon)}\n$$\n该方法的核心是一个打靶算法。二阶 ODE 被转换为一个由两个一阶 ODE 组成的系统，其状态向量为 $\\mathbf{y}(r) = [\\psi_1(r), d\\psi_1/dr]^T$。\n\n对于内区 $r \\in [r_{\\mathrm{in}}, r_s - \\varepsilon]$，系统沿 $r$ 正向积分：\n$$\n\\frac{d\\mathbf{y}}{dr} = \\frac{d}{dr}\\begin{bmatrix} \\psi_1 \\\\ d\\psi_1/dr \\end{bmatrix} = \\begin{bmatrix} d\\psi_1/dr \\\\ k^2 \\psi_1 \\end{bmatrix}\n$$\n积分从 $r = r_{\\mathrm{in}}$ 开始，边界条件为 $\\psi_1(r_{\\mathrm{in}}) = 0$ 和导数的任意归一化 $d\\psi_1/dr|_{r_{\\mathrm{in}}} = 1$。这对应于初始状态向量 $\\mathbf{y}(r_{\\mathrm{in}}) = [0, 1]^T$。解被积分到 $r = r_s - \\varepsilon$，得到状态向量 $\\mathbf{y}(r_s - \\varepsilon)$。\n\n对于外区 $r \\in [r_s + \\varepsilon, r_{\\mathrm{out}}]$，积分必须从外边界 $r=r_{\\mathrm{out}}$ 反向进行。为了使用标准的前向 ODE 积分器，采用了变量替换 $u = -r$。新变量的积分区间为 $u \\in [-r_{\\mathrm{out}}, -(r_s+\\varepsilon)]$。ODE 系统变换为：\n$$\n\\frac{d\\mathbf{y}}{du} = \\frac{d\\mathbf{y}}{dr} \\frac{dr}{du} = -\\frac{d\\mathbf{y}}{dr} = \\begin{bmatrix} -d\\psi_1/dr \\\\ -k^2 \\psi_1 \\end{bmatrix}\n$$\n积分从 $u = -r_{\\mathrm{out}}$ 开始，边界条件为 $\\psi_1(r_{\\mathrm{out}}) = 0$ 和 $d\\psi_1/dr|_{r_{\\mathrm{out}}} = -1$，得到初始状态向量 $\\mathbf{y}(u=-r_{\\mathrm{out}}) = [0, -1]^T$。解被积分到 $u = -(r_s + \\varepsilon)$，这对应于 $r = r_s + \\varepsilon$，从而得到状态向量 $\\mathbf{y}(r_s + \\varepsilon)$。\n\n在获得解向量 $\\mathbf{y}(r_s - \\varepsilon) = [\\psi_{1,-}, \\psi'_{1,-}]^T$ 和 $\\mathbf{y}(r_s + \\varepsilon) = [\\psi_{1,+}, \\psi'_{1,+}]^T$ 之后，计算对数导数 $\\psi'_{1,-}/\\psi_{1,-}$ 和 $\\psi'_{1,+}/\\psi_{1,+}$。然后将稳定性参数 $\\Delta'$ 计算为它们的差值。\n\n实现将利用 `scipy.integrate` 库中的 `solve_ivp` 函数，它为求解初值问题提供了一个鲁棒且精确的方法。对于每个测试用例，都使用指定的参数执行此过程以找到 $\\Delta'$ 的数值，然后将其四舍五入到六位小数。初始导数值（$+1$ 和 $-1$）的选择作为一种归一化；由于控制方程的线性特性，对数导数与此选择无关。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef calculate_delta_prime(params):\n    \"\"\"\n    Calculates the tearing mode stability parameter Delta' for a given set of parameters.\n\n    Args:\n        params (tuple): A tuple containing (m, r_in, r_out, r_s, epsilon).\n\n    Returns:\n        float: The calculated Delta' value.\n    \"\"\"\n    m, r_in, r_out, r_s, epsilon = params\n\n    # The effective radial wavenumber k = m / r_s\n    if r_s == 0:\n        raise ValueError(\"Rational surface radius r_s cannot be zero.\")\n    k = m / r_s\n\n    # --- Inner Integration (from r_in to r_s - epsilon) ---\n    # The system is d/dr [psi_1, d(psi_1)/dr] = [d(psi_1)/dr, k^2 * psi_1]\n    def inner_ode(r, y, k_val):\n        return [y[1], k_val**2 * y[0]]\n\n    # Initial conditions at the inner boundary r = r_in\n    y0_in = [0.0, 1.0]\n    r_span_in = [r_in, r_s - epsilon]\n\n    # Numerically integrate using a high-precision solver\n    sol_in = solve_ivp(\n        lambda r, y: inner_ode(r, y, k),\n        r_span_in,\n        y0_in,\n        method='RK45',\n        rtol=1e-12,\n        atol=1e-12\n    )\n    \n    # Extract the solution at r = r_s - epsilon\n    psi_minus, dpsi_dr_minus = sol_in.y[:, -1]\n    \n    # Calculate the logarithmic derivative from the inner side\n    # A check to prevent division by zero, though unlikely with these BCs\n    if psi_minus == 0:\n        log_deriv_in = np.inf\n    else:\n        log_deriv_in = dpsi_dr_minus / psi_minus\n\n    # --- Outer Integration (from r_out down to r_s + epsilon) ---\n    # To integrate backward, transform variable r to u = -r.\n    # The system becomes d/du [psi_1, d(psi_1)/dr] = [-d(psi_1)/dr, -k^2 * psi_1]\n    def outer_ode(u, y, k_val):\n        return [-y[1], -k_val**2 * y[0]]\n\n    # Initial conditions at the outer boundary r = r_out (u = -r_out)\n    y0_out = [0.0, -1.0]\n    u_span_out = [-r_out, -(r_s + epsilon)]\n\n    # Numerically integrate using the same high-precision solver\n    sol_out = solve_ivp(\n        lambda u, y: outer_ode(u, y, k),\n        u_span_out,\n        y0_out,\n        method='RK45',\n        rtol=1e-12,\n        atol=1e-12\n    )\n\n    # Extract the solution at r = r_s + epsilon (u = -(r_s + epsilon))\n    psi_plus, dpsi_dr_plus = sol_out.y[:, -1]\n\n    # Calculate the logarithmic derivative from the outer side\n    if psi_plus == 0:\n        log_deriv_out = -np.inf\n    else:\n        log_deriv_out = dpsi_dr_plus / psi_plus\n\n    # --- Calculate Delta' ---\n    delta_prime = log_deriv_out - log_deriv_in\n    return delta_prime\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (m, r_in, r_out, r_s, epsilon)\n    test_cases = [\n        (2, 0.0, 1.0, 0.5, 1e-4),\n        (2, 0.0, 1.0, 0.9, 1e-4),\n        (3, 0.1, 1.2, 0.6, 1e-5),\n        (4, 0.0, 1.5, 1.0, 1e-4),\n        (1, 0.0, 1.0, 0.1, 1e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_delta_prime(case)\n        # Format the result to six decimal places as a string\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}