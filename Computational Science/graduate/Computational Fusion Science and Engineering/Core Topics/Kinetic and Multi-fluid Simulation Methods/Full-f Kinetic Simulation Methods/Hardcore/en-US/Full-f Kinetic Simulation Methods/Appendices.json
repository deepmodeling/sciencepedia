{
    "hands_on_practices": [
        {
            "introduction": "Before any kinetic simulation is coded, the governing physical equations must be translated into a dimensionless form. This foundational exercise in nondimensionalization is far more than mathematical bookkeeping; it is the process that reveals the fundamental dimensionless parameters, such as the ratios of the Debye length $\\lambda_D$ and ion-sound gyroradius $\\rho_s$ to the system size $L_0$, which dictate the behavior of the plasma. Mastering this derivation  is the first essential step in bridging the gap between continuous physical theory and discrete computational modeling, allowing you to set up simulations and correctly interpret their results in terms of real-world physics.",
            "id": "3983063",
            "problem": "Consider a magnetized, electrostatic, multispecies plasma described by the full-distribution-function (\"full-f\") kinetic system in a slab domain with a uniform magnetic field $\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{b}}$, electrons with charge $-e$ and mass $m_e$, and singly charged ions with charge $+e$ and mass $m_i$. The evolution is governed by the collisionless Vlasov equation coupled to Poisson's equation for the electrostatic potential. Let $f_s(\\mathbf{x},\\mathbf{v},t)$ denote the phase-space density of species $s \\in \\{e,i\\}$, $n_s(\\mathbf{x},t) = \\int f_s(\\mathbf{x},\\mathbf{v},t)\\,\\mathrm{d}^3 v$ the number density, and $\\phi(\\mathbf{x},t)$ the electrostatic potential, with electric field $\\mathbf{E}(\\mathbf{x},t) = -\\nabla \\phi(\\mathbf{x},t)$. The governing dimensional equations are\n$$\n\\frac{\\partial f_s}{\\partial t} + \\mathbf{v}\\cdot\\nabla f_s + \\frac{q_s}{m_s}\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0\\right)\\cdot \\nabla_{\\mathbf{v}} f_s = 0,\n$$\nand\n$$\n-\\varepsilon_0 \\nabla^2 \\phi = \\sum_s q_s n_s,\n$$\nwhere $q_e = -e$ and $q_i = +e$.\n\nStarting from these laws and using only first-principles definitions, construct a consistent nondimensionalization based on the reference scales $(n_0,T_0,B_0,L_0)$, where $n_0$ is a characteristic density, $T_0$ is a characteristic electron temperature, $B_0$ is the magnitude of the uniform magnetic field, and $L_0$ is a characteristic macroscopic length. Define dimensionless variables $\\mathbf{x}'$, $t'$, $\\mathbf{v}'$, $f_s'$, and $\\phi'$ by specifying physical scales for length, time, velocity, distribution function, and potential. Use the ion-sound speed $c_s$ built from $T_0$ and $m_i$ to set the velocity scale, and choose the electrostatic potential scale so that the electric field scale is consistent with the pressure gradient built from $T_0$ over $L_0$. Derive the dimensionless form of the Vlasov equation for ions and of Poisson's equation, and show explicitly how the dimensionless ratios built from the Debye length $\\lambda_D$ and the ion-sound gyroradius $\\rho_s$ enter as coefficients in front of the Laplacian in Poisson's equation and the magnetic term in the Vlasov equation, respectively.\n\nExpress your final answer as the exact analytic expressions for the two dimensionless coefficients that multiply, respectively, the Laplacian term in the dimensionless Poisson equation and the $(\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\cdot \\nabla_{\\mathbf{v}'} f_i'$ term in the dimensionless ion Vlasov equation, written solely in terms of $(n_0,T_0,B_0,L_0)$ and the fundamental constants $e$, $m_i$, $k_B$, and $\\varepsilon_0$. Provide your final answer as a row matrix with the first entry being the coefficient in Poisson's equation and the second entry being the coefficient in the magnetic term of the ion Vlasov equation. The final answer must be a single closed-form analytic expression with no units.",
            "solution": "The problem statement is a standard derivation exercise in plasma physics. It is scientifically grounded, well-posed, and objective, based on the fundamental Vlasov-Poisson system. All necessary information and constraints for a unique derivation are provided. The problem is therefore deemed valid.\n\nThe task is to nondimensionalize the Vlasov-Poisson system and find the dimensionless coefficients that multiply the Laplacian in Poisson's equation and the magnetic force term in the ion Vlasov equation. The nondimensionalization will be based on the reference scales $(n_0, T_0, B_0, L_0)$.\n\nFirst, we establish the characteristic physical scales for all relevant quantities.\n1.  Length scale: The characteristic macroscopic length $L_0$ is given as the reference scale for length, so $[x] = L_0$.\n2.  Velocity scale: The problem specifies using the ion-sound speed $c_s$, defined with the electron temperature $T_0$ and ion mass $m_i$. Thus, the velocity scale is $v_{ref} = c_s = \\sqrt{k_B T_0 / m_i}$.\n3.  Time scale: A natural time scale is the transit time of a particle moving at the reference velocity across the reference length scale, so $t_{ref} = L_0 / v_{ref} = L_0 / c_s$.\n4.  Potential and Electric Field scales: The problem requires the electrostatic potential scale $\\phi_{ref}$ to be chosen such that the electric field scale $E_{ref}$ is consistent with the pressure gradient scale built from $T_0$ over $L_0$. The thermal energy density (proportional to pressure) is of order $n_0 k_B T_0$. The force per unit volume from the pressure gradient is $\\nabla p \\sim n_0 k_B T_0 / L_0$. The electric force per unit volume is $\\rho E \\sim (n_0 e) E$. Equating these force densities gives a scale for the electric field: $E_{ref} = \\frac{k_B T_0}{e L_0}$. Since $\\mathbf{E} = -\\nabla \\phi$, we have $E_{ref} = \\phi_{ref} / L_0$, which gives the potential scale $\\phi_{ref} = E_{ref} L_0 = \\frac{k_B T_0}{e}$.\n5.  Distribution Function scale: The number density $n_s$ is the integral of the distribution function $f_s$ over velocity space, $n_s = \\int f_s d^3v$. Thus, the scales are related by $n_{ref} \\sim f_{ref} v_{ref}^3$. Using the reference density $n_0$, we get $f_{ref} = n_0 / v_{ref}^3 = n_0 / c_s^3$.\n\nWe now define the dimensionless (primed) variables:\n$$ \\mathbf{x} = L_0 \\mathbf{x}', \\quad t = \\frac{L_0}{c_s} t', \\quad \\mathbf{v} = c_s \\mathbf{v}', \\quad \\phi = \\frac{k_B T_0}{e} \\phi' $$\n$$ n_s = n_0 n_s', \\quad f_s = \\frac{n_0}{c_s^3} f_s', \\quad \\mathbf{E} = \\frac{k_B T_0}{e L_0} \\mathbf{E}' $$\nThe differential operators transform as:\n$$ \\nabla = \\frac{1}{L_0} \\nabla', \\quad \\frac{\\partial}{\\partial t} = \\frac{c_s}{L_0} \\frac{\\partial}{\\partial t'}, \\quad \\nabla_{\\mathbf{v}} = \\frac{1}{c_s} \\nabla'_{\\mathbf{v}'} $$\nNote that the relationship $\\mathbf{E} = -\\nabla \\phi$ becomes $\\frac{k_B T_0}{e L_0} \\mathbf{E}' = -\\frac{1}{L_0} \\nabla' \\left(\\frac{k_B T_0}{e} \\phi'\\right) = -\\frac{k_B T_0}{e L_0} \\nabla' \\phi'$, which confirms that $\\mathbf{E}' = -\\nabla'\\phi'$.\n\nNext, we nondimensionalize Poisson's equation:\n$$ -\\varepsilon_0 \\nabla^2 \\phi = \\sum_s q_s n_s = e(n_i - n_e) $$\nSubstituting the dimensionless variables and scales:\n$$ -\\varepsilon_0 \\left(\\frac{1}{L_0^2} \\nabla'^2\\right) \\left(\\frac{k_B T_0}{e} \\phi'\\right) = e (n_0 n_i' - n_0 n_e') $$\n$$ -\\frac{\\varepsilon_0 k_B T_0}{e L_0^2} \\nabla'^2 \\phi' = e n_0 (n_i' - n_e') $$\nTo find the coefficient multiplying the Laplacian term, we rearrange the equation. A common convention is to have the normalized charge density on the right-hand side.\n$$ \\left(\\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2}\\right) \\nabla'^2 \\phi' = -(n_i' - n_e') $$\nThe problem asks for the coefficient that multiplies the Laplacian term, $\\nabla'^2 \\phi'$. Therefore, this coefficient is:\n$$ C_{Poisson} = \\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2} $$\nThis can be recognized as $(\\lambda_D/L_0)^2$, where $\\lambda_D = \\sqrt{\\varepsilon_0 k_B T_0 / (n_0 e^2)}$ is the electron Debye length based on the reference parameters.\n\nNow, we nondimensionalize the Vlasov equation for ions ($s=i$, $q_i=+e$):\n$$ \\frac{\\partial f_i}{\\partial t} + \\mathbf{v}\\cdot\\nabla f_i + \\frac{e}{m_i}\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0\\right)\\cdot \\nabla_{\\mathbf{v}} f_i = 0 $$\nSubstitute the dimensionless variables and differential operators:\n$$ \\left(\\frac{c_s}{L_0}\\frac{\\partial}{\\partial t'}\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) + (c_s\\mathbf{v}')\\cdot\\left(\\frac{1}{L_0}\\nabla'\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) + \\frac{e}{m_i}\\left(\\frac{k_B T_0}{eL_0}\\mathbf{E}' + (c_s\\mathbf{v}')\\times (B_0\\hat{\\mathbf{b}})\\right)\\cdot \\left(\\frac{1}{c_s}\\nabla'_{\\mathbf{v}'}\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) = 0 $$\nFactor out the common term $\\frac{n_0}{c_s^3} \\frac{c_s}{L_0} = \\frac{n_0}{c_s^2 L_0}$:\n$$ \\frac{\\partial f_i'}{\\partial t'} + \\mathbf{v}'\\cdot\\nabla' f_i' + \\frac{L_0}{c_s} \\frac{e}{m_i} \\left(\\frac{k_B T_0}{eL_0}\\mathbf{E}' + c_s B_0 (\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\right)\\cdot \\frac{1}{c_s}\\nabla'_{\\mathbf{v}'}f_i' = 0 $$\nLet's analyze the terms within the force operator.\nThe electric field term has a coefficient:\n$$ \\frac{L_0}{c_s} \\frac{e}{m_i} \\frac{k_B T_0}{eL_0} \\frac{1}{c_s} = \\frac{L_0 e k_B T_0}{m_i c_s^2 e L_0} = \\frac{k_B T_0}{m_i c_s^2} $$\nUsing the definition $c_s^2 = k_B T_0 / m_i$, this coefficient is $\\frac{k_B T_0}{m_i (k_B T_0 / m_i)} = 1$. This confirms the consistency of our scaling.\nThe magnetic field term has a coefficient:\n$$ \\frac{L_0}{c_s} \\frac{e}{m_i} (c_s B_0) \\frac{1}{c_s} = \\frac{L_0 e B_0}{m_i c_s} $$\nThe full dimensionless Vlasov equation for ions is:\n$$ \\frac{\\partial f_i'}{\\partial t'} + \\mathbf{v}'\\cdot\\nabla' f_i' + \\left( \\mathbf{E}' + \\frac{L_0 e B_0}{m_i c_s} (\\mathbf{v}'\\times \\hat{\\mathbf{b}}) \\right) \\cdot \\nabla'_{\\mathbf{v}'}f_i' = 0 $$\nThe coefficient requested is the one multiplying the term $(\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\cdot \\nabla_{\\mathbf{v}'} f_i'$, which is:\n$$ C_{Vlasov} = \\frac{L_0 e B_0}{m_i c_s} $$\nSubstituting $c_s = \\sqrt{k_B T_0 / m_i}$:\n$$ C_{Vlasov} = \\frac{L_0 e B_0}{m_i \\sqrt{k_B T_0 / m_i}} = \\frac{L_0 e B_0}{\\sqrt{m_i^2 (k_B T_0 / m_i)}} = \\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}} $$\nThis coefficient can be written as $L_0/\\rho_s$, where $\\rho_s = c_s/\\Omega_{ci} = (c_s m_i)/(e B_0)$ is the ion-sound gyroradius.\n\nThe two requested coefficients are:\n1.  Poisson coefficient: $\\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2}$\n2.  Ion Vlasov magnetic term coefficient: $\\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}}$",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{\\varepsilon_0 k_B T_0}{n_0 e^{2} L_0^{2}}  \\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}} \\end{pmatrix}} $$"
        },
        {
            "introduction": "The Particle-In-Cell (PIC) method is a cornerstone of full-$f$ kinetic simulation, prized for its efficiency in high-dimensional phase space. The accuracy and stability of a PIC code depend critically on how information is passed between the Lagrangian particles and the Eulerian grid, a process governed by the particle \"shape function.\" This practice  takes you under the hood of the PIC algorithm, using Fourier analysis to quantify how the common Cloud-in-Cell interpolation scheme introduces numerical artifacts. Understanding the resulting aliasing error is not merely an academic exercise; it is crucial for recognizing the inherent limitations of the method and for designing simulations that can be trusted.",
            "id": "3983108",
            "problem": "Consider a two-dimensional, periodic, electrostatic Particle-In-Cell (PIC) code operating on a uniform Cartesian mesh with $N_{x} \\times N_{y}$ nodes, domain lengths $L_{x}$ and $L_{y}$, and mesh spacings $\\Delta x = L_{x}/N_{x}$ and $\\Delta y = L_{y}/N_{y}$. In a full-distribution-function (full-f) kinetic representation, each macro-particle deposits charge onto the grid using the Cloud-in-Cell assignment, in which the one-dimensional assignment function is the degree-$1$ B-spline (triangular) function. Define the one-dimensional shape functions\n$$\ns_{x}(x) = \\frac{1}{\\Delta x}\\,\\Lambda\\!\\left(\\frac{x}{\\Delta x}\\right), \\quad\ns_{y}(y) = \\frac{1}{\\Delta y}\\,\\Lambda\\!\\left(\\frac{y}{\\Delta y}\\right),\n$$\nwhere $\\Lambda(u) = 1 - |u|$ for $|u|\\leq 1$ and $\\Lambda(u)=0$ otherwise, so that $\\int_{-\\infty}^{\\infty} s_{x}(x)\\,dx = 1$ and $\\int_{-\\infty}^{\\infty} s_{y}(y)\\,dy = 1$. The two-dimensional continuous assignment function is $s(x,y) = s_{x}(x)\\,s_{y}(y)$.\n\nLet a single macro-particle be located at position $(x_{p},y_{p})$. The dimensionless weight assigned to grid node $(i,j)$ at position $(i\\Delta x, j\\Delta y)$ is\n$$\nw_{ij} = \\Delta x\\,\\Delta y\\, s_{x}(i\\Delta x - x_{p})\\, s_{y}(j\\Delta y - y_{p}),\n$$\nso that $\\sum_{i,j} w_{ij} = 1$.\n\nDefine the two-dimensional continuous Fourier transform of the assignment function by\n$$\nS(k_{x},k_{y}) = \\int_{-\\infty}^{\\infty}\\!\\int_{-\\infty}^{\\infty} s(x,y)\\,\\exp\\!\\left(-i k_{x} x - i k_{y} y\\right)\\,dx\\,dy,\n$$\nand the discrete Fourier transform of the grid-weight array by\n$$\nW_{d}(k_{x},k_{y};x_{p},y_{p}) = \\sum_{i=-\\infty}^{\\infty}\\sum_{j=-\\infty}^{\\infty} w_{ij}\\,\\exp\\!\\left(-i k_{x}\\, i\\Delta x - i k_{y}\\, j\\Delta y\\right),\n$$\nwhere $k_{x}$ and $k_{y}$ are continuous Fourier variables associated with the physical spatial coordinates $x$ and $y$.\n\nStarting from the fundamental definitions above, and using only well-tested properties of the Fourier transform and sampling of continuous functions on a lattice, derive the following quantities in closed analytic form:\n1. The discrete particle-shape Fourier transform $W_{d}(k_{x},k_{y};0,0)$ evaluated at zero particle offset $(x_{p},y_{p})=(0,0)$.\n2. The corresponding grid aliasing error, defined as the maximal aliasing bias at zero offset,\n$$\n\\mathcal{E}(k_{x},k_{y}) \\equiv \\frac{W_{d}(k_{x},k_{y};0,0)}{S(k_{x},k_{y})} - 1.\n$$\n\nExpress your final answer as closed-form analytic expressions in terms of $\\Delta x$, $\\Delta y$, $k_{x}$, and $k_{y}$. Define the normalized sinc function by $\\operatorname{sinc}(u) = \\sin(u)/u$ within your derivation. No numerical evaluation or rounding is required. The final answer must be a calculation and presented as analytic expressions only, with no units in the final boxed output.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It represents a standard derivation in the field of computational plasma physics concerning the spectral properties of particle-grid interpolation schemes. All necessary definitions are provided. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe derivation proceeds in three main stages: first, we find the continuous Fourier transform of the assignment function, $S(k_x, k_y)$; second, we derive the discrete Fourier transform of the grid-weight array for zero particle offset, $W_d(k_x, k_y; 0, 0)$; and third, we compute the aliasing error $\\mathcal{E}(k_x, k_y)$ from these two quantities.\n\n**1. Continuous Fourier Transform of the Assignment Function, $S(k_x, k_y)$**\n\nThe two-dimensional assignment function is defined as separable: $s(x,y) = s_x(x)s_y(y)$. Due to this separability, its continuous Fourier transform $S(k_x, k_y)$ is the product of the one-dimensional Fourier transforms of its components:\n$$\nS(k_x, k_y) = S_x(k_x) S_y(k_y)\n$$\nwhere\n$$\nS_x(k_x) = \\int_{-\\infty}^{\\infty} s_x(x)\\,\\exp(-i k_x x)\\,dx \\quad \\text{and} \\quad S_y(k_y) = \\int_{-\\infty}^{\\infty} s_y(y)\\,\\exp(-i k_y y)\\,dy\n$$\nWe will compute $S_x(k_x)$; the result for $S_y(k_y)$ follows by analogy. The one-dimensional shape function is $s_x(x) = \\frac{1}{\\Delta x} \\Lambda(\\frac{x}{\\Delta x})$, where $\\Lambda(u)$ is the triangle function. We first find the Fourier transform of $\\Lambda(u)$:\n$$\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = \\int_{-\\infty}^{\\infty} \\Lambda(u) \\exp(-i k u)\\,du = \\int_{-1}^{1} (1-|u|) \\exp(-i k u)\\,du\n$$\nThe integral can be calculated as twice the real part of the integral from $0$ to $1$:\n$$\n\\int_{-1}^{1} (1-|u|) \\exp(-i k u)\\,du = \\int_{-1}^{1} (1-|u|) \\cos(k u)\\,du - i\\int_{-1}^{1} (1-|u|) \\sin(k u)\\,du\n$$\nThe second integral vanishes because the integrand is odd. The first integrand is even, so:\n$$\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = 2 \\int_{0}^{1} (1-u) \\cos(k u)\\,du\n$$\nIntegrating by parts with $p = 1-u$ and $dq = \\cos(ku)du$:\n\\begin{align*}\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = 2 \\left[ (1-u) \\frac{\\sin(ku)}{k} \\right]_{0}^{1} - 2 \\int_{0}^{1} (-1) \\frac{\\sin(ku)}{k}\\,du \\\\\n= 2 \\left[ 0 - 0 \\right] + \\frac{2}{k} \\int_{0}^{1} \\sin(ku)\\,du \\\\\n= \\frac{2}{k} \\left[ -\\frac{\\cos(ku)}{k} \\right]_{0}^{1} \\\\\n= \\frac{2}{k^2} (1-\\cos(k))\n\\end{align*}\nUsing the half-angle identity $1-\\cos(k) = 2\\sin^2(k/2)$, we get:\n$$\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = \\frac{4\\sin^2(k/2)}{k^2} = \\left(\\frac{\\sin(k/2)}{k/2}\\right)^2 = \\operatorname{sinc}^2(k/2)\n$$\nwhere the problem defines $\\operatorname{sinc}(u) = \\sin(u)/u$.\n\nNow we apply the scaling property of the Fourier transform: If $\\mathcal{F}\\{f(t)\\}(k) = F(k)$, then $\\mathcal{F}\\{f(at)\\}(k) = \\frac{1}{|a|}F(k/a)$. For $s_x(x) = \\frac{1}{\\Delta x} \\Lambda(\\frac{x}{\\Delta x})$, we have a scaling factor $a = 1/\\Delta x$.\n$$\nS_x(k_x) = \\mathcal{F}\\left\\{\\frac{1}{\\Delta x}\\Lambda\\left(\\frac{x}{\\Delta x}\\right)\\right\\}(k_x) = \\frac{1}{\\Delta x} \\left(\\Delta x \\cdot \\operatorname{sinc}^2\\left(\\frac{k_x}{1/\\Delta x} \\cdot \\frac{1}{2}\\right)\\right) = \\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right)\n$$\nBy analogy for the $y$-direction:\n$$\nS_y(k_y) = \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)\n$$\nThus, the continuous 2D shape factor is:\n$$\nS(k_x, k_y) = \\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)\n$$\n\n**2. Discrete Particle-Shape Fourier Transform, $W_d(k_x, k_y; 0, 0)$**\n\nWe are asked to find $W_d(k_x, k_y; 0, 0)$. We start from the general definition and apply the Poisson summation formula, which relates the Fourier transform of a sampled function to the continuous Fourier transform of the original function. The general definition for $W_d$ is:\n$$\nW_d(k_x, k_y; x_p, y_p) = \\sum_{i,j} w_{ij} e^{-i(k_x i \\Delta x + k_y j \\Delta y)} = \\sum_{i,j} \\Delta x \\Delta y s(i\\Delta x - x_p, j\\Delta y - y_p) e^{-i(k_x i \\Delta x + k_y j \\Delta y)}\n$$\nThis expression is the discrete Fourier transform of the sampled shape function centered at $(x_p, y_p)$. A fundamental identity in PIC theory, derived from Poisson's summation formula, states that this discrete transform is an infinite sum of aliased copies of the continuous transform:\n$$\nW_d(k_x, k_y; x_p, y_p) = \\sum_{m,n=-\\infty}^{\\infty} S\\left(k_x - \\frac{2\\pi m}{\\Delta x}, k_y - \\frac{2\\pi n}{\\Delta y}\\right) \\exp\\left[-i\\left(k_x - \\frac{2\\pi m}{\\Delta x}\\right)x_p -i\\left(k_y - \\frac{2\\pi n}{\\Delta y}\\right)y_p\\right]\n$$\nFor the specific case requested, the particle offset is zero, $(x_p, y_p) = (0,0)$. The exponential term becomes $\\exp(0) = 1$.\n$$\nW_d(k_x,k_y;0,0) = \\sum_{m,n=-\\infty}^{\\infty} S\\left(k_x - \\frac{2\\pi m}{\\Delta x}, k_y - \\frac{2\\pi n}{\\Delta y}\\right)\n$$\nSubstituting our result for $S(k_x, k_y)$ and using its separable form:\n$$\nW_d(k_x,k_y;0,0) = \\sum_{m,n=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{(k_x - \\frac{2\\pi m}{\\Delta x})\\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{(k_y - \\frac{2\\pi n}{\\Delta y})\\Delta y}{2}\\right)\n$$\nSimplifying the arguments of the sinc functions:\n$$\nW_d(k_x,k_y;0,0) = \\sum_{m,n=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{k_x\\Delta x}{2} - m\\pi\\right) \\operatorname{sinc}^2\\left(\\frac{k_y\\Delta y}{2} - n\\pi\\right)\n$$\nThe sum is separable:\n$$\nW_d(k_x,k_y;0,0) = \\left[\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{k_x\\Delta x}{2} - m\\pi\\right)\\right] \\left[\\sum_{n=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{k_y\\Delta y}{2} - n\\pi\\right)\\right]\n$$\nLet's analyze the one-dimensional sum. Let $u = k_x\\Delta x/2$. We need to evaluate $\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2(u - m\\pi)$.\n$$\n\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2(u - m\\pi) = \\sum_{m=-\\infty}^{\\infty} \\left(\\frac{\\sin(u - m\\pi)}{u - m\\pi}\\right)^2 = \\sum_{m=-\\infty}^{\\infty} \\left(\\frac{(-1)^m \\sin(u)}{u - m\\pi}\\right)^2 = \\sin^2(u) \\sum_{m=-\\infty}^{\\infty} \\frac{1}{(u - m\\pi)^2}\n$$\nA standard result from complex analysis, related to the Mittag-Leffler expansion of the cosecant function, provides the identity:\n$$\n\\sum_{m=-\\infty}^{\\infty} \\frac{1}{(z+m\\pi)^2} = \\csc^2(z) = \\frac{1}{\\sin^2(z)}\n$$\nReplacing $z$ with $-u$ in the sum (which does not change the result as $m$ spans all integers) yields $\\sum_{m=-\\infty}^\\infty \\frac{1}{(-u+m\\pi)^2} = \\sum_{m=-\\infty}^\\infty \\frac{1}{(u-m\\pi)^2} = \\csc^2(-u) = \\csc^2(u)$.\nApplying this identity, the sum becomes:\n$$\n\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2(u - m\\pi) = \\sin^2(u) \\cdot \\frac{1}{\\sin^2(u)} = 1\n$$\nThis holds for both the sum over $m$ and the sum over $n$. Therefore:\n$$\nW_d(k_x, k_y; 0, 0) = 1 \\cdot 1 = 1\n$$\nThis result reflects the \"partition of unity\" property of B-spline basis functions, which ensures that aliasing effects for particles located exactly on grid nodes are well-behaved, summing to a constant independent of the wavevector.\n\n**3. Grid Aliasing Error, $\\mathcal{E}(k_x, k_y)$**\n\nThe grid aliasing error is defined as:\n$$\n\\mathcal{E}(k_{x},k_{y}) \\equiv \\frac{W_{d}(k_{x},k_{y};0,0)}{S(k_{x},k_{y})} - 1\n$$\nSubstituting the expressions we derived for $W_d(k_x, k_y; 0, 0)$ and $S(k_x, k_y)$:\n$$\n\\mathcal{E}(k_{x},k_{y}) = \\frac{1}{\\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)} - 1\n$$\nThis is the final closed-form expression for the aliasing error. It quantifies the deviation of the spectral representation on the discrete grid from the ideal continuous representation, caused by the summation of aliases.\n\nFinal answers for the two required quantities are:\n1. $W_d(k_x, k_y; 0, 0) = 1$\n2. $\\mathcal{E}(k_x, k_y) = \\frac{1}{\\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)} - 1$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\frac{1}{\\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)} - 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While collisionless models provide crucial insights, simulating the long-term evolution of fusion plasmas requires accounting for the effects of collisions. This hands-on coding practice  moves from the collisionless Vlasov equation to the more complete picture including the Landau collision operator. You will implement a finite-volume discretization and, most importantly, construct a correction term that enforces the discrete conservation of particle number and energy. This task exemplifies a core principle of modern computational physics: building numerical schemes that respect the fundamental conservation laws of the underlying physical system is essential for achieving stable and physically meaningful simulation results.",
            "id": "3983092",
            "problem": "Consider the isotropic, three-dimensional, linearized Landau collision operator acting on a perturbation distribution function $g(v)$ expressed in speed $v \\ge 0$, linearized about a stationary, isotropic Maxwellian background. In isotropic speed coordinates, the test-particle contribution can be written in divergence form as\n$$\nC_{\\mathrm{TP}}[g](v) = \\frac{1}{v^2}\\frac{\\partial}{\\partial v}\\left(v^2\\left( D(v)\\frac{\\partial g}{\\partial v} + F(v) g \\right)\\right),\n$$\nwhere $D(v)$ is a positive diffusion coefficient and $F(v)$ is a friction (drag) coefficient. The fully linearized Landau operator includes a field-particle term that enforces the collision invariants (number, momentum, energy). For the isotropic subspace considered here (no momentum transport in a single-species, isotropic setting), discrete conservation of number and energy must be assured.\n\nYour task is to implement a velocity-space finite-volume discretization for $C[g] = C_{\\mathrm{TP}}[g] + C_{\\mathrm{FP}}[g]$ and to demonstrate discrete conservation of number and energy on a set of test perturbations $g(v)$ with zero-flux boundary conditions. Work in dimensionless units: normalize velocity $v$ by the thermal speed, so $v$ is dimensionless, and the coefficients $D(v)$ and $F(v)$ are dimensionless functions. No physical units are required in the final answers.\n\nFundamental base:\n- The linearized Landau collision operator for an isotropic background admits a divergence-form test-particle part with positive diffusion and drag, as given above, derived from the Rosenbluth potentials of the Maxwellian background.\n- The collision invariants for number and energy imply $\\int C[g] \\, \\mathrm{d}^3v = 0$ and $\\int v^2 C[g] \\, \\mathrm{d}^3v = 0$ for any sufficiently smooth and decaying $g(v)$, when the field-particle part is included.\n\nFinite-volume discretization requirements:\n- Discretize $v \\in [0, v_{\\max}]$ into $N$ uniform cells with cell-centered speeds $v_j$ and cell width $\\Delta v$. The cell volume measure is $\\Delta V_j = v_j^2 \\Delta v$.\n- The discrete operator in cell $j$ must be of the form\n$$\nC_j = \\frac{J_{j+1/2} - J_{j-1/2}}{\\Delta V_j} + S_j,\n$$\nwith edge flux\n$$\nJ_{j+1/2} = -D_{j+1/2} \\, v_{j+1/2}^2 \\, \\frac{g_{j+1} - g_j}{\\Delta v} - F_{j+1/2} \\, v_{j+1/2}^2 \\, \\frac{g_{j+1} + g_j}{2},\n$$\nand zero-flux boundary conditions $J_{1-1/2}=0$ and $J_{N+1/2}=0$. Here $D_{j+1/2} = D(v_{j+1/2})$, $F_{j+1/2} = F(v_{j+1/2})$, and $v_{j+1/2}$ is the edge speed.\n- Choose a field-particle source $S_j = A_0 + A_2 v_j^2$ with constants $A_0$ and $A_2$ depending on $g$, determined by enforcing the discrete number and energy conservation conditions\n$$\n\\sum_{j=1}^{N} \\Delta V_j \\, C_j = 0, \\qquad \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, C_j = 0.\n$$\nDerive the formulas for $A_0$ and $A_2$ by solving a $2\\times 2$ linear system involving discrete moments of the test-particle part. Explicitly, define the discrete moments\n$$\nM_0 = \\sum_{j=1}^{N} \\Delta V_j \\, L_j, \\quad M_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, L_j,\n$$\nwhere $L_j = (J_{j+1/2} - J_{j-1/2})/\\Delta V_j$ is the test-particle contribution, and basis moments\n$$\nB_0 = \\sum_{j=1}^{N} \\Delta V_j, \\quad B_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2, \\quad B_4 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^4.\n$$\nImpose $\\sum \\Delta V_j (L_j + S_j) = 0$ and $\\sum \\Delta V_j v_j^2 (L_j + S_j) = 0$ to obtain a linear system for $(A_0, A_2)$ and solve it.\n\nProgram specification:\n- Implement the above discretization with general $D(v)$ and $F(v)$ functions. For testing, use the common linearized diffusion-drag model $D(v) = D_0$ and $F(v) = \\alpha v$ with positive constants $D_0$ and $\\alpha$, which reproduces the divergence structure and Maxwellian relaxation behavior in isotropic form. This choice is acceptable as a surrogate for the test-particle part of the linearized Landau operator.\n- Use zero-flux boundary conditions.\n- Compute the discrete operator $C_j$ and verify the invariants by evaluating\n$$\nR_0 = \\sum_{j=1}^{N} \\Delta V_j \\, C_j, \\qquad R_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, C_j.\n$$\n- For each test case, return a boolean indicating whether both $|R_0|$ and $|R_2|$ are below a prescribed tolerance. Use an absolute tolerance of $10^{-10}$ and also scale by a reference magnitude to avoid trivial true results; specifically, require $|R_0| \\le \\varepsilon (1 + \\sum_j \\Delta V_j |L_j|)$ and $|R_2| \\le \\varepsilon (1 + \\sum_j \\Delta V_j v_j^2 |L_j|)$ with $\\varepsilon = 10^{-10}$.\n\nTest suite:\n- Provide the following test cases, each specified as $(N, v_{\\max}, D_0, \\alpha, g(v))$:\n    1. $(64, 6.0, 0.2, 1.0, g(v) = e^{-v^2} - 0.5 e^{-2 v^2})$ as a general smooth perturbation (happy path).\n    2. $(16, 6.0, 0.1, 1.0, g(v) = (1 - 3 v^2) e^{-v^2/2})$ to test coarse resolution effects.\n    3. $(8, 4.0, 0.3, 1.0, g(v) = 1)$ to test constant perturbation and boundary telescoping (edge case).\n    4. $(64, 6.0, 0.2, 1.0, g(v) = v^2)$ to test polynomial behavior tied to the energy invariant (edge case).\n    5. $(64, 6.0, 0.05, 0.5, g(v) = e^{-(v-5)^2})$ to test a function sharply peaked near the high-velocity boundary (edge case).\n\nFinal output format:\n- Your program should produce a single line of output containing the boolean results for the five test cases as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,True,False]\").",
            "solution": "The problem statement is assessed to be valid. It presents a clear, scientifically grounded, and well-posed task in computational plasma physics: the implementation of a conservative finite-volume discretization for the linearized isotropic Landau collision operator. The formulation is standard, resting upon fundamental principles of kinetic theory and numerical methods for conservation laws. All necessary parameters, equations, and conditions are provided, and no contradictions or ambiguities are present.\n\nWe proceed with the solution. The objective is to construct a numerical operator $C_j$ corresponding to the continuous operator $C[g](v)$ and verify that it discretely conserves particle number and energy. The operator is a sum of a test-particle part, $C_{\\mathrm{TP}}$, and a field-particle part, $C_{\\mathrm{FP}}$, which we will discretize as $L_j$ and $S_j$, respectively.\n\n**1. Discretization Framework**\n\nThe velocity domain $v \\in [0, v_{\\max}]$ is discretized into $N$ uniform cells. The cell width is $\\Delta v = v_{\\max} / N$.\n-   The cell edges are located at $v_{j+1/2} = j \\Delta v$ for $j=0, 1, \\dots, N$.\n-   The cell centers are at $v_j = (j - 1/2) \\Delta v$ for $j=1, 2, \\dots, N$.\n-   The discrete perturbation distribution function is cell-centered: $g_j = g(v_j)$.\n-   The volume element for the spherical shell corresponding to cell $j$ is approximated as $\\Delta V_j = 4\\pi v_j^2 \\Delta v$. Since the factor of $4\\pi$ is a global constant that appears in all conservation sums, it can be omitted for simplicity. The problem defines the discrete volume measure as $\\Delta V_j = v_j^2 \\Delta v$, which is consistent with this simplification.\n\n**2. Test-Particle Operator Discretization ($L_j$)**\n\nThe test-particle operator is given in divergence form:\n$$ C_{\\mathrm{TP}}[g](v) = \\frac{1}{v^2}\\frac{\\partial}{\\partial v} \\Phi(v), \\quad \\text{where} \\quad \\Phi(v) = v^2 \\left( D(v)\\frac{\\partial g}{\\partial v} + F(v) g \\right) $$\nIntegrating this over a cell volume $V_j$ (from $v_{j-1/2}$ to $v_{j+1/2}$) and applying the fundamental theorem of calculus yields:\n$$ \\int_{v_{j-1/2}}^{v_{j+1/2}} C_{\\mathrm{TP}}[g] \\, v^2 dv = \\Phi(v_{j+1/2}) - \\Phi(v_{j-1/2}) $$\nApproximating the left-hand side using the midpoint rule, $L_j \\Delta V_j \\approx \\Phi(v_{j+1/2}) - \\Phi(v_{j-1/2})$, gives the finite-volume formula:\n$$ L_j = \\frac{J_{j+1/2} - J_{j-1/2}}{\\Delta V_j} $$\nwhere $J_{j+1/2}$ is the numerical flux at the cell edge $v_{j+1/2}$, approximating $-\\Phi(v_{j+1/2})$. The sign convention is chosen such that $J$ represents a flux in the positive $v$ direction. The problem specifies a particular centered-difference scheme for the flux:\n$$ J_{j+1/2} = -D(v_{j+1/2}) v_{j+1/2}^2 \\left(\\frac{g_{j+1} - g_j}{\\Delta v}\\right) - F(v_{j+1/2}) v_{j+1/2}^2 \\left(\\frac{g_{j+1} + g_j}{2}\\right) $$\nThis scheme is a common choice, related to the Chang-Cooper method, which has favorable properties for diffusion-advection problems. The boundary conditions are zero-flux, meaning $J_{1/2} = 0$ and $J_{N+1/2} = 0$. The flux at the origin, $J_{1/2}$, is naturally zero due to the $v_{1/2}^2 = 0^2=0$ factor in the flux formula.\n\nAn important consequence of this formulation is that the test-particle operator discretely conserves the particle number. The total change in particle number is:\n$$ \\sum_{j=1}^{N} L_j \\Delta V_j = \\sum_{j=1}^{N} (J_{j+1/2} - J_{j-1/2}) $$\nThis is a telescoping sum which equals $J_{N+1/2} - J_{1/2}$. With zero-flux boundary conditions, this sum is exactly zero. Thus, the test-particle operator does not create or destroy particles.\n\n**3. Field-Particle Operator and Conservation ($S_j$)**\n\nThe test-particle operator does not, in general, conserve energy. The field-particle operator's role is to correct this. We model the field-particle source term $S_j$ as a projection onto the discrete isotropic null space of the collision operator, which is spanned by $\\{1, v_j^2\\}$.\n$$ S_j = A_0 + A_2 v_j^2 $$\nThe coefficients $A_0$ and $A_2$ are scalar values that depend on the entire distribution $g$ and are determined by enforcing the discrete conservation laws for the full operator $C_j = L_j + S_j$. The two conservation laws are for number and energy:\n$$ \\sum_{j=1}^{N} C_j \\Delta V_j = 0 \\quad \\text{and} \\quad \\sum_{j=1}^{N} C_j v_j^2 \\Delta V_j = 0 $$\n\n**4. Derivation of Correction Coefficients ($A_0, A_2$)**\n\nSubstituting $C_j = L_j + S_j$ into the conservation laws gives:\n1.  Number conservation: $\\sum_{j=1}^{N} (L_j + A_0 + A_2 v_j^2) \\Delta V_j = 0$\n2.  Energy conservation: $\\sum_{j=1}^{N} (L_j + A_0 + A_2 v_j^2) v_j^2 \\Delta V_j = 0$\n\nRearranging these equations yields a linear system for $(A_0, A_2)$:\n$$ \\sum_{j=1}^{N} L_j \\Delta V_j + A_0 \\sum_{j=1}^{N} \\Delta V_j + A_2 \\sum_{j=1}^{N} v_j^2 \\Delta V_j = 0 $$\n$$ \\sum_{j=1}^{N} L_j v_j^2 \\Delta V_j + A_0 \\sum_{j=1}^{N} v_j^2 \\Delta V_j + A_2 \\sum_{j=1}^{N} v_j^4 \\Delta V_j = 0 $$\nUsing the moment definitions provided in the problem statement:\n-   $M_k = \\sum_{j=1}^{N} L_j v_j^k \\Delta V_j$\n-   $B_k = \\sum_{j=1}^{N} v_j^k \\Delta V_j$\nThe system becomes:\n$$ M_0 + A_0 B_0 + A_2 B_2 = 0 $$\n$$ M_2 + A_0 B_2 + A_2 B_4 = 0 $$\nAs established, $M_0 = 0$ from the finite-volume construction. The system simplifies, but for numerical robustness, we solve the full system in matrix form:\n$$ \\begin{pmatrix} B_0  B_2 \\\\ B_2  B_4 \\end{pmatrix} \\begin{pmatrix} A_0 \\\\ A_2 \\end{pmatrix} = \\begin{pmatrix} -M_0 \\\\ -M_2 \\end{pmatrix} $$\nThis $2 \\times 2$ system can be solved for $A_0$ and $A_2$. The matrix is a Gram matrix and is invertible for $N  1$.\n\n**5. Verification of Conservation**\n\nAfter computing $L_j$, the moments $M_0, M_2, B_0, B_2, B_4$, solving for $A_0, A_2$, and constructing the full operator $C_j = L_j + A_0 + A_2 v_j^2$, we must verify that the conservation properties hold. We compute the discrete residuals:\n$$ R_0 = \\sum_{j=1}^{N} C_j \\Delta V_j \\quad \\text{and} \\quad R_2 = \\sum_{j=1}^{N} C_j v_j^2 \\Delta V_j $$\nBy algebraic construction, these residuals should be zero up to floating-point numerical precision. To form a robust check, we use the specified relative tolerance criterion:\n$$ |R_0| \\le \\varepsilon \\left(1 + \\sum_j \\Delta V_j |L_j|\\right) \\quad \\text{and} \\quad |R_2| \\le \\varepsilon \\left(1 + \\sum_j \\Delta V_j v_j^2 |L_j|\\right) $$\nwith $\\varepsilon = 10^{-10}$. This normalization prevents false results when the collision operator's action is weak (i.e., when $L_j$ is small everywhere).\n\nThe following Python code implements this entire procedure.",
            "answer": "```python\nimport numpy as np\n\ndef run_conservation_test(N, vmax, D0, alpha, g_func):\n    \"\"\"\n    Implements and tests a conservative finite-volume discretization of the\n    linearized isotropic Landau collision operator.\n    \n    Args:\n        N (int): Number of velocity cells.\n        vmax (float): Maximum speed in the domain [0, vmax].\n        D0 (float): Constant for the diffusion coefficient model D(v) = D0.\n        alpha (float): Constant for the friction coefficient model F(v) = alpha * v.\n        g_func (callable): The perturbation distribution function g(v).\n\n    Returns:\n        bool: True if both number and energy are conserved to the specified tolerance, False otherwise.\n    \"\"\"\n    # 1. Grid setup\n    dv = vmax / N\n    v_cell = (np.arange(N) + 0.5) * dv\n    v_edge = np.arange(N + 1) * dv\n\n    # 2. Evaluate g on cell centers\n    g_vals = g_func(v_cell)\n\n    # 3. Calculate numerical fluxes J at cell edges\n    J = np.zeros(N + 1)  # J[0] and J[N] are 0 by zero-flux BC\n\n    # Calculate internal fluxes J[1]...J[N-1] using vectorization\n    # These correspond to edges v_edge[1] through v_edge[N-1]\n    g_left = g_vals[:-1]   # g_0 to g_{N-2}\n    g_right = g_vals[1:]   # g_1 to g_{N-1}\n    v_internal_edges = v_edge[1:-1]\n\n    # D(v) = D0, F(v) = alpha * v\n    D_edge = D0 * np.ones_like(v_internal_edges)\n    F_edge = alpha * v_internal_edges\n\n    diff_term = -D_edge * v_internal_edges**2 * (g_right - g_left) / dv\n    drag_term = -F_edge * v_internal_edges**2 * (g_right + g_left) / 2.0\n    J[1:-1] = diff_term + drag_term\n\n    # 4. Calculate the discrete test-particle operator L_j\n    delta_V = v_cell**2 * dv\n    J_right_of_cell = J[1:]  # J_1 to J_N\n    J_left_of_cell = J[:-1]   # J_0 to J_{N-1}\n    \n    # The denominator delta_V is non-zero since v_cell is never zero.\n    L = (J_right_of_cell - J_left_of_cell) / delta_V\n\n    # 5. Calculate moments for the linear system\n    # Basis moments\n    v_cell_sq = v_cell**2\n    v_cell_4 = v_cell**4\n    B0 = np.sum(delta_V)\n    B2 = np.sum(delta_V * v_cell_sq)\n    B4 = np.sum(delta_V * v_cell_4)\n\n    # Test-particle moments\n    M0 = np.sum(delta_V * L)\n    M2 = np.sum(delta_V * v_cell_sq * L)\n    # M0 should be zero to machine precision due to the telescoping sum of fluxes and zero-flux BCs.\n    \n    # 6. Solve for the field-particle coefficients A0, A2\n    mat = np.array([[B0, B2], [B2, B4]])\n    rhs = np.array([-M0, -M2])\n    try:\n        A0, A2 = np.linalg.solve(mat, rhs)\n    except np.linalg.LinAlgError:\n        # This case should not be reached for N  1\n        return False\n\n    # 7. Calculate the full discrete operator C_j and conservation residuals R0, R2\n    S = A0 + A2 * v_cell_sq\n    C = L + S\n\n    R0 = np.sum(delta_V * C)\n    R2 = np.sum(delta_V * v_cell_sq * C)\n\n    # 8. Perform the verification check against the specified tolerance\n    epsilon = 1e-10\n    norm0 = 1.0 + np.sum(delta_V * np.abs(L))\n    norm2 = 1.0 + np.sum(delta_V * v_cell_sq * np.abs(L))\n    \n    check0 = np.abs(R0) = epsilon * norm0\n    check2 = np.abs(R2) = epsilon * norm2\n    \n    return check0 and check2\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (64, 6.0, 0.2, 1.0, lambda v: np.exp(-v**2) - 0.5 * np.exp(-2 * v**2)),\n        (16, 6.0, 0.1, 1.0, lambda v: (1 - 3 * v**2) * np.exp(-v**2 / 2.0)),\n        (8, 4.0, 0.3, 1.0, lambda v: np.ones_like(v)),\n        (64, 6.0, 0.2, 1.0, lambda v: v**2),\n        (64, 6.0, 0.05, 0.5, lambda v: np.exp(-(v - 5.0)**2)),\n    ]\n\n    results = []\n    for case in test_cases:\n        is_conserved = run_conservation_test(*case)\n        results.append(str(is_conserved))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}