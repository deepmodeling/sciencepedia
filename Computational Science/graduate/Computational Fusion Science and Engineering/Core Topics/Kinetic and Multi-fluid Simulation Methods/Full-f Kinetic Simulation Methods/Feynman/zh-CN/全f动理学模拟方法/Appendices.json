{
    "hands_on_practices": [
        {
            "introduction": "在进行任何等离子体模拟之前，一个至关重要的步骤是将控制方程无量纲化。通过使用特征物理尺度重写弗拉索夫-泊松方程组，我们可以识别出真正支配系统动力学的无量纲参数。这项练习  将引导您完成这一基本过程，帮助您理解德拜长度与系统尺寸之比（$\\lambda_D/L_0$）等关键参数是如何自然出现并影响等离子体行为的。",
            "id": "3983063",
            "problem": "考虑一个磁化、静电、多组分等离子体，该等离子体由一个板状区域中的全分布函数（“full-$f$”）动理学系统描述，具有均匀磁场 $\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{b}}$、电荷为 $-e$ 质量为 $m_e$ 的电子，以及电荷为 $+e$ 质量为 $m_i$ 的单电荷离子。其演化由无碰撞弗拉索夫方程与用于静电势的泊松方程耦合决定。令 $f_s(\\mathbf{x},\\mathbf{v},t)$ 表示组分 $s \\in \\{e,i\\}$ 的相空间密度，$n_s(\\mathbf{x},t) = \\int f_s(\\mathbf{x},\\mathbf{v},t)\\,\\mathrm{d}^3 v$ 表示数密度，$\\phi(\\mathbf{x},t)$ 表示静电势，电场为 $\\mathbf{E}(\\mathbf{x},t) = -\\nabla \\phi(\\mathbf{x},t)$。控制量纲方程为\n$$\n\\frac{\\partial f_s}{\\partial t} + \\mathbf{v}\\cdot\\nabla f_s + \\frac{q_s}{m_s}\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0\\right)\\cdot \\nabla_{\\mathbf{v}} f_s = 0,\n$$\n和\n$$\n-\\varepsilon_0 \\nabla^2 \\phi = \\sum_s q_s n_s,\n$$\n其中 $q_e = -e$ 且 $q_i = +e$。\n\n从这些定律出发，仅使用第一性原理定义，基于参考标度 $(n_0,T_0,B_0,L_0)$ 构建一个自洽的无量纲化方案，其中 $n_0$ 是特征密度，$T_0$ 是特征电子温度，$B_0$ 是均匀磁场的大小，$L_0$ 是特征宏观长度。通过为长度、时间、速度、分布函数和势指定物理标度，来定义无量纲变量 $\\mathbf{x}'$、$t'$、$\\mathbf{v}'$、$f_s'$ 和 $\\phi'$。使用由 $T_0$ 和 $m_i$ 构成的离子声速 $c_s$ 来设定速度标度，并选择静电势标度，使得电场标度与由 $T_0$ 在 $L_0$ 上构成的压力梯度一致。推导离子的弗拉索夫方程和泊松方程的无量纲形式，并明确展示由德拜长度 $\\lambda_D$ 和离子声速回旋半径 $\\rho_s$ 构成的无量纲比率，是如何分别作为系数出现在泊松方程的拉普拉斯项前和弗拉索夫方程的磁场项前的。\n\n将你的最终答案表示为两个无量纲系数的精确解析表达式，这两个系数分别乘以无量纲泊松方程中的拉普拉斯项和无量纲离子弗拉索夫方程中的 $(\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\cdot \\nabla_{\\mathbf{v}'} f_i'$ 项，且表达式仅用 $(n_0,T_0,B_0,L_0)$ 和基本常数 $e$、$m_i$、$k_B$ 及 $\\varepsilon_0$ 书写。以一个行矩阵的形式提供你的最终答案，其中第一个元素是泊松方程中的系数，第二个元素是离子弗拉索夫方程磁场项中的系数。最终答案必须是单一的、无单位的闭式解析表达式。",
            "solution": "该问题陈述是等离子体物理学中一个标准的推导练习。它以基本的弗拉索夫-泊松系统为基础，科学基础扎实、提法恰当且客观。所有进行唯一推导所需的信息和约束都已提供。因此，该问题被认为是有效的。\n\n任务是对弗拉索夫-泊松系统进行无量纲化，并找到分别乘以泊松方程中拉普拉斯算子和离子弗拉索夫方程中磁力项的无量纲系数。无量纲化将基于参考标度 $(n_0, T_0, B_0, L_0)$。\n\n首先，我们为所有相关量建立特征物理标度。\n1.  长度标度：特征宏观长度 $L_0$ 被作为长度的参考标度，因此 $[x] = L_0$。\n2.  速度标度：问题指定使用离子声速 $c_s$，其由电子温度 $T_0$ 和离子质量 $m_i$ 定义。因此，速度标度为 $v_{ref} = c_s = \\sqrt{k_B T_0 / m_i}$。\n3.  时间标度：一个自然的时间标度是粒子以参考速度穿越参考长度标度所需的渡越时间，因此 $t_{ref} = L_0 / v_{ref} = L_0 / c_s$。\n4.  势和电场标度：问题要求选择静电势标度 $\\phi_{ref}$，使得电场标度 $E_{ref}$ 与由 $T_0$ 在 $L_0$ 上构成的压力梯度标度一致。热能密度（与压力成正比）的量级为 $n_0 k_B T_0$。由压力梯度产生的单位体积力为 $\\nabla p \\sim n_0 k_B T_0 / L_0$。单位体积的电场力为 $\\rho E \\sim (n_0 e) E$。令这些力密度相等，可得电场的标度：$E_{ref} = \\frac{k_B T_0}{e L_0}$。由于 $\\mathbf{E} = -\\nabla \\phi$，我们有 $E_{ref} = \\phi_{ref} / L_0$，这给出了势的标度 $\\phi_{ref} = E_{ref} L_0 = \\frac{k_B T_0}{e}$。\n5.  分布函数标度：数密度 $n_s$ 是分布函数 $f_s$ 在速度空间上的积分，即 $n_s = \\int f_s d^3v$。因此，各标度通过 $n_{ref} \\sim f_{ref} v_{ref}^3$ 相关联。使用参考密度 $n_0$，我们得到 $f_{ref} = n_0 / v_{ref}^3 = n_0 / c_s^3$。\n\n我们现在定义无量纲（带撇）变量：\n$$ \\mathbf{x} = L_0 \\mathbf{x}', \\quad t = \\frac{L_0}{c_s} t', \\quad \\mathbf{v} = c_s \\mathbf{v}', \\quad \\phi = \\frac{k_B T_0}{e} \\phi' $$\n$$ n_s = n_0 n_s', \\quad f_s = \\frac{n_0}{c_s^3} f_s', \\quad \\mathbf{E} = \\frac{k_B T_0}{e L_0} \\mathbf{E}' $$\n微分算子变换如下：\n$$ \\nabla = \\frac{1}{L_0} \\nabla', \\quad \\frac{\\partial}{\\partial t} = \\frac{c_s}{L_0} \\frac{\\partial}{\\partial t'}, \\quad \\nabla_{\\mathbf{v}} = \\frac{1}{c_s} \\nabla'_{\\mathbf{v}'} $$\n注意关系式 $\\mathbf{E} = -\\nabla \\phi$ 变为 $\\frac{k_B T_0}{e L_0} \\mathbf{E}' = -\\frac{1}{L_0} \\nabla' \\left(\\frac{k_B T_0}{e} \\phi'\\right) = -\\frac{k_B T_0}{e L_0} \\nabla' \\phi'$，这证实了 $\\mathbf{E}' = -\\nabla'\\phi'$。\n\n接下来，我们将泊松方程无量纲化：\n$$ -\\varepsilon_0 \\nabla^2 \\phi = \\sum_s q_s n_s = e(n_i - n_e) $$\n代入无量纲变量和标度：\n$$ -\\varepsilon_0 \\left(\\frac{1}{L_0^2} \\nabla'^2\\right) \\left(\\frac{k_B T_0}{e} \\phi'\\right) = e (n_0 n_i' - n_0 n_e') $$\n$$ -\\frac{\\varepsilon_0 k_B T_0}{e L_0^2} \\nabla'^2 \\phi' = e n_0 (n_i' - n_e') $$\n为了找到乘以拉普拉斯项的系数，我们重新整理方程。一个常见的约定是将归一化的电荷密度放在右侧。\n$$ \\left(\\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2}\\right) \\nabla'^2 \\phi' = -(n_i' - n_e') $$\n问题要求的是乘以拉普拉斯项 $\\nabla'^2 \\phi'$ 的系数。因此，该系数为：\n$$ C_{Poisson} = \\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2} $$\n这可以被识别为 $(\\lambda_D/L_0)^2$，其中 $\\lambda_D = \\sqrt{\\varepsilon_0 k_B T_0 / (n_0 e^2)}$ 是基于参考参数的电子德拜长度。\n\n现在，我们对离子的弗拉索夫方程进行无量纲化（$s=i$, $q_i=+e$）：\n$$ \\frac{\\partial f_i}{\\partial t} + \\mathbf{v}\\cdot\\nabla f_i + \\frac{e}{m_i}\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0\\right)\\cdot \\nabla_{\\mathbf{v}} f_i = 0 $$\n代入无量纲变量和微分算子：\n$$ \\left(\\frac{c_s}{L_0}\\frac{\\partial}{\\partial t'}\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) + (c_s\\mathbf{v}')\\cdot\\left(\\frac{1}{L_0}\\nabla'\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) + \\frac{e}{m_i}\\left(\\frac{k_B T_0}{eL_0}\\mathbf{E}' + (c_s\\mathbf{v}')\\times (B_0\\hat{\\mathbf{b}})\\right)\\cdot \\left(\\frac{1}{c_s}\\nabla'_{\\mathbf{v}'}\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) = 0 $$\n提出公因子 $\\frac{n_0}{c_s^3} \\frac{c_s}{L_0} = \\frac{n_0}{c_s^2 L_0}$：\n$$ \\frac{\\partial f_i'}{\\partial t'} + \\mathbf{v}'\\cdot\\nabla' f_i' + \\frac{L_0}{c_s} \\frac{e}{m_i} \\left(\\frac{k_B T_0}{eL_0}\\mathbf{E}' + c_s B_0 (\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\right)\\cdot \\frac{1}{c_s}\\nabla'_{\\mathbf{v}'}f_i' = 0 $$\n我们来分析力算子中的各项。\n电场项的系数为：\n$$ \\frac{L_0}{c_s} \\frac{e}{m_i} \\frac{k_B T_0}{eL_0} \\frac{1}{c_s} = \\frac{L_0 e k_B T_0}{m_i c_s^2 e L_0} = \\frac{k_B T_0}{m_i c_s^2} $$\n使用定义 $c_s^2 = k_B T_0 / m_i$，该系数为 $\\frac{k_B T_0}{m_i (k_B T_0 / m_i)} = 1$。这证实了我们标度选择的自洽性。\n磁场项的系数为：\n$$ \\frac{L_0}{c_s} \\frac{e}{m_i} (c_s B_0) \\frac{1}{c_s} = \\frac{L_0 e B_0}{m_i c_s} $$\n完整的离子无量纲弗拉索夫方程为：\n$$ \\frac{\\partial f_i'}{\\partial t'} + \\mathbf{v}'\\cdot\\nabla' f_i' + \\left( \\mathbf{E}' + \\frac{L_0 e B_0}{m_i c_s} (\\mathbf{v}'\\times \\hat{\\mathbf{b}}) \\right) \\cdot \\nabla'_{\\mathbf{v}'}f_i' = 0 $$\n所求的系数是乘以 $(\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\cdot \\nabla_{\\mathbf{v}'} f_i'$ 项的系数，即：\n$$ C_{Vlasov} = \\frac{L_0 e B_0}{m_i c_s} $$\n代入 $c_s = \\sqrt{k_B T_0 / m_i}$：\n$$ C_{Vlasov} = \\frac{L_0 e B_0}{m_i \\sqrt{k_B T_0 / m_i}} = \\frac{L_0 e B_0}{\\sqrt{m_i^2 (k_B T_0 / m_i)}} = \\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}} $$\n该系数可以写为 $L_0/\\rho_s$，其中 $\\rho_s = c_s/\\Omega_{ci} = (c_s m_i)/(e B_0)$ 是离子声速回旋半径。\n\n所求的两个系数是：\n1.  泊松方程系数：$\\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2}$\n2.  离子弗拉索夫方程磁场项系数：$\\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}}$",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{\\varepsilon_0 k_B T_0}{n_0 e^{2} L_0^{2}}  \\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在无量纲化的基础上，本练习将探讨其在聚变研究关键问题——湍流输运——中的应用。通过选择一种特定的“回旋玻姆（gyro-Bohm）”归一化方法，我们可以运用漂移级数和混合长度理论来揭示湍流的标度律。这项练习  将引导您推导著名的回旋玻姆扩散系数，并深入理解全分布函数（full-$f$）模拟如何用于预测聚变装置中的输运现象。",
            "id": "3983110",
            "problem": "考虑一个静电、磁化等离子体，其中包含质量为 $m_i$ 的单电荷离子，以及温度为 $T_{e0}$、平均密度为 $n_0$ 的电子，该等离子体处于大小为 $B_0$ 的均匀磁场中。粒子种类 $s$ 的全分布函数 $f_s(\\mathbf{x},\\mathbf{v},t)$ 根据 Vlasov–Fokker–Planck 方程演化，该方程在无碰撞极限下简化为 Vlasov 方程 $ \\partial_t f_s + \\mathbf{v}\\cdot\\nabla f_s + (q_s/m_s)(\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})\\cdot\\nabla_{\\mathbf{v}} f_s = 0$，并由准中性条件和静电场关系 $ \\mathbf{E} = -\\nabla \\phi$ 封闭。假设电子是绝热的，因此 $ \\delta n_e / n_0 \\approx e \\phi / T_{e0}$，并满足准中性条件 $ \\delta n_i \\approx \\delta n_e$。在磁化漂移波湍流的全分布函数 (full-$f$) 模拟中，一种常见的无量纲化方法采用声速 $c_s \\equiv \\sqrt{T_{e0}/m_i}$、离子声速回旋半径 $\\rho_s \\equiv c_s/\\Omega_{ci}$（其中离子回旋频率为 $\\Omega_{ci} \\equiv e B_0/m_i$）、宏观梯度尺度 $L$（例如，背景密度或温度标长）、参考密度 $n_0$ 以及电势标度 $T_{e0}/e$。使用这些参考标度，对离子 full-$f$ Vlasov 方程和场关系式进行一致的漂移级数无量纲化，以凸显$\\mathbf{E}\\times\\mathbf{B}$ 漂移，并说明 $\\mathbf{E}\\times\\mathbf{B}$ 平流项如何引入小参数 $ \\epsilon \\equiv \\rho_s/L \\ll 1$。 \n\n从有量纲方程出发，并使用与无量纲化系统一致的混合长度论证，估算由 $\\mathbf{E}\\times\\mathbf{B}$ 平流引起的跨场湍流粒子输运系数（扩散系数）$D$。推导 $D$ 的 gyro-Bohm 归一化，并解释在 full-$f$ 模拟中 $D$ 与参数 $ \\rho_s/L$ 的标度关系，明确说明无量纲归一化输运 $ \\widehat{D} \\equiv D L/(c_s \\rho_s^2)$ 如何相对于 $ \\rho_s/L$ 变化。将最终的输运系数以国际单位制 (SI) 单位 $\\mathrm{m^2\\,s^{-1}}$ 表示为关于 $T_{e0}$、$m_i$、$e$、$B_0$ 和 $L$ 的解析表达式。只提供 gyro-Bohm 输运系数的解析表达式作为你的最终答案。",
            "solution": "该问题陈述已经过严格验证，并被认为是有效的。它在科学上基于成熟的等离子体动理学理论和输运模型，是适定的，具有足够的信息以进行唯一推导，并以客观、正式的语言表述。该问题与计算聚变科学直接相关。\n\n解答过程分为三个主要部分：(1) 控制方程的漂移级数无量纲化，(2) 湍流输运系数的混合长度估算，以及 (3) gyro-Bohm 扩散系数最终表达式的推导。\n\n### 第 1 部分：无量纲化与漂移级数\n\n我们从离子全分布函数 $f_i(\\mathbf{x}, \\mathbf{v}, t)$ 的 Vlasov 方程开始，其中离子是单电荷的 ($q_i=e$)：\n$$\n\\frac{\\partial f_i}{\\partial t} + \\mathbf{v} \\cdot \\nabla f_i + \\frac{e}{m_i} (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\nabla_{\\mathbf{v}} f_i = 0\n$$\n问题指定了一种无量纲化方法，以凸显漂移级数参数 $\\epsilon \\equiv \\rho_s/L \\ll 1$。该级数关系是宏观动力学的特征，其中频率远低于离子回旋频率，空间尺度远大于离子回旋半径。我们基于宏观量选择归一化标度：\n- 长度: $L$ (背景梯度标长)\n- 速度: $c_s \\equiv \\sqrt{T_{e0}/m_i}$ (离子声速，其中 $T_{e0}$ 以能量为单位)\n- 时间: $L/c_s$ (声波在宏观尺度上的渡越时间)\n- 电势: $T_{e0}/e$\n\n令带帽变量表示无量纲量：\n$$\n\\hat{\\mathbf{x}} = \\frac{\\mathbf{x}}{L}, \\quad \\hat{\\mathbf{v}} = \\frac{\\mathbf{v}}{c_s}, \\quad \\hat{t} = \\frac{t}{L/c_s}, \\quad \\hat{\\phi} = \\frac{e\\phi}{T_{e0}}, \\quad \\hat{f}_i = \\frac{f_i c_s^3}{n_0}\n$$\n微分算符变换如下：\n$$\n\\frac{\\partial}{\\partial t} = \\frac{c_s}{L} \\frac{\\partial}{\\partial \\hat{t}}, \\quad \\nabla = \\frac{1}{L} \\nabla_{\\hat{x}}, \\quad \\nabla_{\\mathbf{v}} = \\frac{1}{c_s} \\nabla_{\\hat{v}}\n$$\n电场为 $\\mathbf{E} = -\\nabla\\phi$。在无量纲形式下：\n$$\n\\mathbf{E} = -\\frac{1}{L} \\nabla_{\\hat{x}} \\left(\\frac{T_{e0}}{e} \\hat{\\phi}\\right) = -\\frac{T_{e0}}{eL} \\nabla_{\\hat{x}} \\hat{\\phi}\n$$\n磁场是均匀的，$\\mathbf{B} = B_0 \\mathbf{b}$，其中 $\\mathbf{b}$ 是单位矢量。\n\n将这些代入 Vlasov 方程（并消去可以约掉的常数因子 $n_0/c_s^3$）：\n$$\n\\frac{c_s}{L} \\frac{\\partial \\hat{f}_i}{\\partial \\hat{t}} + (c_s \\hat{\\mathbf{v}}) \\cdot \\left(\\frac{1}{L} \\nabla_{\\hat{x}} \\hat{f}_i\\right) + \\frac{e}{m_i} \\left(-\\frac{T_{e0}}{eL} \\nabla_{\\hat{x}} \\hat{\\phi} + c_s \\hat{\\mathbf{v}} \\times B_0 \\mathbf{b}\\right) \\cdot \\left(\\frac{1}{c_s} \\nabla_{\\hat{v}} \\hat{f}_i\\right) = 0\n$$\n将整个方程乘以 $L/c_s$：\n$$\n\\frac{\\partial \\hat{f}_i}{\\partial \\hat{t}} + \\hat{\\mathbf{v}} \\cdot \\nabla_{\\hat{x}} \\hat{f}_i + \\frac{L}{c_s} \\frac{e}{m_i c_s} \\left(-\\frac{T_{e0}}{eL} \\nabla_{\\hat{x}} \\hat{\\phi} + c_s B_0 \\hat{\\mathbf{v}} \\times \\mathbf{b}\\right) \\cdot \\nabla_{\\hat{v}} \\hat{f}_i = 0\n$$\n我们分析第三项中的系数。使用 $c_s^2 = T_{e0}/m_i$：\n$$\n\\frac{L}{c_s} \\frac{e}{m_i c_s} \\left(-\\frac{T_{e0}}{eL}\\right) = -\\frac{T_{e0}}{m_i c_s^2} = -1\n$$\n$$\n\\frac{L}{c_s} \\frac{e}{m_i c_s} (c_s B_0) = \\frac{L}{c_s} \\frac{e B_0}{m_i} = \\frac{L}{c_s} \\Omega_{ci}\n$$\n使用定义 $\\Omega_{ci} \\equiv eB_0/m_i$ 和 $\\rho_s \\equiv c_s/\\Omega_{ci}$，该系数变为：\n$$\n\\frac{L \\Omega_{ci}}{c_s} = \\frac{L}{\\rho_s} = \\frac{1}{\\epsilon}\n$$\n完全无量纲化的 Vlasov 方程为：\n$$\n\\frac{\\partial \\hat{f}_i}{\\partial \\hat{t}} + \\hat{\\mathbf{v}} \\cdot \\nabla_{\\hat{x}} \\hat{f}_i - (\\nabla_{\\hat{x}} \\hat{\\phi}) \\cdot \\nabla_{\\hat{v}} \\hat{f}_i + \\frac{1}{\\epsilon} (\\hat{\\mathbf{v}} \\times \\mathbf{b}) \\cdot \\nabla_{\\hat{v}} \\hat{f}_i = 0\n$$\n洛伦兹力项 $(\\hat{\\mathbf{v}} \\times \\mathbf{b}) \\cdot \\nabla_{\\hat{v}} \\hat{f}_i$ 是 $1/\\epsilon$ 量级，使其成为方程中的主导项。这使得分布函数在快时间尺度上近似回旋各向同性。\n\n问题特别问到 $\\mathbf{E}\\times\\mathbf{B}$ 平流项如何引入 $\\epsilon$。虽然该项在 Vlasov 方程中没有显式出现，但 $\\mathbf{E}\\times\\mathbf{B}$ 漂移速度 $\\mathbf{v}_E = (\\mathbf{E} \\times \\mathbf{B}) / B^2$ 是粒子运动的一个基本组成部分。我们对其进行归一化：\n$$\n\\hat{\\mathbf{v}}_E = \\frac{\\mathbf{v}_E}{c_s} = \\frac{1}{c_s B_0^2} \\left( -\\frac{T_{e0}}{eL} \\nabla_{\\hat{x}} \\hat{\\phi} \\times B_0 \\mathbf{b} \\right) = -\\frac{T_{e0}}{e B_0 L c_s} (\\nabla_{\\hat{x}} \\hat{\\phi} \\times \\mathbf{b})\n$$\n代入 $T_{e0} = m_i c_s^2$ 和 $\\Omega_{ci} = e B_0/m_i$：\n$$\n\\hat{\\mathbf{v}}_E = -\\frac{m_i c_s^2}{e B_0 L c_s} (\\nabla_{\\hat{x}} \\hat{\\phi} \\times \\mathbf{b}) = -\\frac{m_i c_s}{e B_0 L} (\\nabla_{\\hat{x}} \\hat{\\phi} \\times \\mathbf{b}) = -\\frac{c_s}{L \\Omega_{ci}} (\\nabla_{\\hat{x}} \\hat{\\phi} \\times \\mathbf{b})\n$$\n使用 $\\rho_s = c_s/\\Omega_{ci}$ 和 $\\epsilon = \\rho_s/L$：\n$$\n\\hat{\\mathbf{v}}_E = -\\frac{\\rho_s}{L} (\\nabla_{\\hat{x}} \\hat{\\phi} \\times \\mathbf{b}) = -\\epsilon (\\nabla_{\\hat{x}} \\hat{\\phi} \\times \\mathbf{b})\n$$\n归一化的 $\\mathbf{E}\\times\\mathbf{B}$ 漂移速度是 $\\epsilon$ 量级。因此，在一个简化模型（例如，漂移动理学或流体模型）中，$\\mathbf{E}\\times\\mathbf{B}$ 平流项 $(\\hat{\\mathbf{v}}_E \\cdot \\nabla_{\\hat{x}})\\hat{f}_i$ 也是 $\\epsilon$ 量级，因为在该归一化下，项中的所有其他量都是 1 的量级。\n\n### 第 2 部分：输运系数 D 的混合长度估算\n\n湍流输运可以通过混合长度论证来估算，其中扩散系数 $D$ 由特征湍流速度涨落 $v_{turb}$ 和特征空间混合长度 $L_{mix}$ 的乘积给出。\n$$\nD \\sim v_{turb} L_{mix}\n$$\n对于静电漂移波湍流，主导的湍流速度是 $\\mathbf{E}\\times\\mathbf{B}$ 速度涨落，$v_{turb} \\sim |\\mathbf{v}_E|$，而混合长度（相关长度）是湍流的特征垂直波长，通常在离子声速回旋半径的量级上，$L_{mix} \\sim \\rho_s$。\n\n我们估算饱和时的 $\\mathbf{E}\\times\\mathbf{B}$ 速度涨落的量级。这需要估算饱和电势涨落振幅 $\\phi$。绝热电子响应与准中性条件相结合，提供了关系式 $\\delta n_i / n_0 \\approx e\\phi/T_{e0}$。密度涨落 $\\delta n_i$ 本身可以通过背景密度梯度在混合长度上的混合来估算：\n$$\n\\delta n_i \\sim L_{mix} |\\nabla n_0| \\sim \\rho_s \\frac{n_0}{L}\n$$\n其中 $L$ 是背景密度梯度标长。\n将此代入准中性条件：\n$$\n\\frac{\\rho_s (n_0/L)}{n_0} \\approx \\frac{e\\phi}{T_{e0}} \\implies \\frac{\\rho_s}{L} \\approx \\frac{e\\phi}{T_{e0}}\n$$\n这给出了饱和电势涨落水平：\n$$\n\\phi \\sim \\frac{T_{e0}}{e} \\frac{\\rho_s}{L}\n$$\n现在我们估算 $\\mathbf{E}\\times\\mathbf{B}$ 速度涨落 $v_E \\sim |\\mathbf{E}|/B_0$。电场涨落为 $E \\sim k_\\perp \\phi$，其中 $k_\\perp \\sim 1/L_{mix} \\sim 1/\\rho_s$。\n$$\nv_{E} \\sim \\frac{k_\\perp \\phi}{B_0} \\sim \\frac{1}{\\rho_s B_0} \\left(\\frac{T_{e0}}{e} \\frac{\\rho_s}{L}\\right) = \\frac{T_{e0}}{e B_0 L}\n$$\n我们用 $c_s$ 和 $\\rho_s$ 来表示：\n$$\nv_{E} \\sim \\frac{m_i c_s^2}{(m_i \\Omega_{ci}) L} = \\frac{c_s^2}{\\Omega_{ci} L} = \\frac{c_s^2}{(c_s/\\rho_s)L} = c_s \\frac{\\rho_s}{L}\n$$\n最后，我们计算扩散系数 $D$：\n$$\nD \\sim v_{E} L_{mix} \\sim \\left(c_s \\frac{\\rho_s}{L}\\right) \\rho_s = \\frac{c_s \\rho_s^2}{L}\n$$\n这个结果被称为湍流扩散系数的 gyro-Bohm 标度关系。\n\n### 第 3 部分：Gyro-Bohm 归一化和最终表达式\n\n问题将归一化输运系数定义为 $\\widehat{D} \\equiv D L/(c_s \\rho_s^2)$。使用我们推导出的 $D$ 的标度关系，我们发现：\n$$\n\\widehat{D} = \\frac{(C \\cdot c_s \\rho_s^2/L) L}{c_s \\rho_s^2} = C\n$$\n其中 $C$ 是一个 1 的量级的无量纲数值因子，它取决于湍流的细节。这表明归一化标度 $D_{gB} \\equiv c_s \\rho_s^2/L$ 正确地捕捉了扩散系数的参数标度关系。根据这个结果，$\\widehat{D}$ 与级数参数 $\\rho_s/L$ 无关。这个性质是利用计算成本高昂的 full-$f$ 模拟在人为增大的 $\\rho_s/L$ 值下预测聚变装置（其中 $\\rho_s/L$ 非常小）中输运的策略的基础。\n\n为了获得 gyro-Bohm 输运系数的最终表达式，我们将 $D_{gB}$ 用给定的物理量 $T_{e0}$（单位为焦耳）、$m_i$、$e$、$B_0$ 和 $L$ 来表示。\n$$\nD_{gB} = \\frac{c_s \\rho_s^2}{L}\n$$\n我们代入 $c_s$ 和 $\\rho_s$ 的定义：\n$$\nc_s = \\sqrt{\\frac{T_{e0}}{m_i}}\n$$\n$$\n\\rho_s = \\frac{c_s}{\\Omega_{ci}} = \\frac{\\sqrt{T_{e0}/m_i}}{e B_0 / m_i} = \\frac{\\sqrt{m_i T_{e0}}}{e B_0}\n$$\n将这些代入 $D_{gB}$ 的表达式中：\n$$\nD_{gB} = \\frac{1}{L} \\left(\\sqrt{\\frac{T_{e0}}{m_i}}\\right) \\left(\\frac{\\sqrt{m_i T_{e0}}}{e B_0}\\right)^2 = \\frac{1}{L} \\frac{\\sqrt{T_{e0}}}{\\sqrt{m_i}} \\frac{m_i T_{e0}}{e^2 B_0^2}\n$$\n简化此表达式得到最终结果：\n$$\nD_{gB} = \\frac{\\sqrt{m_i} T_{e0}^{3/2}}{L e^2 B_0^2}\n$$\n单位是 $\\mathrm{m^2\\,s^{-1}}$，符合扩散系数的要求。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{m_i} T_{e0}^{3/2}}{L e^{2} B_0^{2}}}\n$$"
        },
        {
            "introduction": "从理论模型到可执行代码，这项练习聚焦于动力学方程的数值实现。全分布函数（full-$f$）模拟的一个主要挑战是在精确表示碰撞算符的同时，严格执行物理守恒律。在本练习  中，您将为一个线性化朗道 (Landau) 碰撞算子实现有限体积离散化，并学习如何构造一个修正项来确保粒子数和能量的离散守恒——这是任何可靠模拟的基石。",
            "id": "3983092",
            "problem": "考虑作用于以速率 $v \\ge 0$ 表示的微扰分布函数 $g(v)$ 上的各向同性、三维、线性化朗道 (Landau) 碰撞算子，该算子是围绕一个静态、各向同性的麦克斯韦背景进行线性化的。在各向同性速率坐标下，测试粒子贡献部分可以写成散度形式：\n$$\nC_{\\mathrm{TP}}[g](v) = \\frac{1}{v^2}\\frac{\\partial}{\\partial v}\\left(v^2\\left( D(v)\\frac{\\partial g}{\\partial v} + F(v) g \\right)\\right),\n$$\n其中 $D(v)$ 是一个正的扩散系数，$F(v)$ 是一个摩擦（阻力）系数。完全线性化的 Landau 算子包含一个场粒子项，该项确保了碰撞不变量（粒子数、动量、能量）的守恒。对于此处考虑的各向同性子空间（在单物种、各向同性的情况下无动量输运），必须保证粒子数和能量的离散守恒。\n\n你的任务是为 $C[g] = C_{\\mathrm{TP}}[g] + C_{\\mathrm{FP}}[g]$ 实现一个速度空间有限体积离散化，并在零通量边界条件下，对一组测试微扰 $g(v)$ 验证粒子数和能量的离散守恒。使用无量纲单位：用热速率对速度 $v$ 进行归一化，因此 $v$ 是无量纲的，系数 $D(v)$ 和 $F(v)$ 也是无量纲函数。最终答案中不需要物理单位。\n\n基本依据：\n- 对于各向同性的背景，线性化朗道 (Landau) 碰撞算子具有一个散度形式的测试粒子部分，该部分带有正的扩散和阻力，如上文所述，它是从罗森布鲁斯 (Rosenbluth) 势推导出来的。\n- 对于任何足够光滑且衰减的 $g(v)$，当包含场粒子部分时，粒子数和能量的碰撞不变量意味着 $\\int C[g] \\, \\mathrm{d}^3v = 0$ 和 $\\int v^2 C[g] \\, \\mathrm{d}^3v = 0$。\n\n有限体积离散化要求：\n- 将 $v \\in [0, v_{\\max}]$ 离散化为 $N$ 个均匀单元，单元中心速率为 $v_j$，单元宽度为 $\\Delta v$。单元体积度量为 $\\Delta V_j = v_j^2 \\Delta v$。\n- 单元 $j$ 中的离散算子必须具有以下形式\n$$\nC_j = \\frac{J_{j+1/2} - J_{j-1/2}}{\\Delta V_j} + S_j,\n$$\n其中边界通量为\n$$\nJ_{j+1/2} = -D_{j+1/2} \\, v_{j+1/2}^2 \\, \\frac{g_{j+1} - g_j}{\\Delta v} - F_{j+1/2} \\, v_{j+1/2}^2 \\, \\frac{g_{j+1} + g_j}{2},\n$$\n且边界条件为零通量 $J_{1-1/2}=0$ 和 $J_{N+1/2}=0$。这里 $D_{j+1/2} = D(v_{j+1/2})$，$F_{j+1/2} = F(v_{j+1/2})$，且 $v_{j+1/2}$ 是边界速率。\n- 选择一个场粒子源项 $S_j = A_0 + A_2 v_j^2$，其中常数 $A_0$ 和 $A_2$ 依赖于 $g$，并通过强制执行离散的粒子数和能量守恒条件来确定\n$$\n\\sum_{j=1}^{N} \\Delta V_j \\, C_j = 0, \\qquad \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, C_j = 0.\n$$\n- 通过求解一个包含测试粒子部分离散矩的 $2\\times 2$ 线性系统，推导出 $A_0$ 和 $A_2$ 的公式。具体来说，定义离散矩\n$$\nM_0 = \\sum_{j=1}^{N} \\Delta V_j \\, L_j, \\quad M_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, L_j,\n$$\n其中 $L_j = (J_{j+1/2} - J_{j-1/2})/\\Delta V_j$ 是测试粒子贡献，以及基矩\n$$\nB_0 = \\sum_{j=1}^{N} \\Delta V_j, \\quad B_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2, \\quad B_4 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^4.\n$$\n施加条件 $\\sum \\Delta V_j (L_j + S_j) = 0$ 和 $\\sum \\Delta V_j v_j^2 (L_j + S_j) = 0$ 以获得关于 $(A_0, A_2)$ 的线性系统并求解。\n\n程序规范：\n- 使用通用的 $D(v)$ 和 $F(v)$ 函数实现上述离散化。为进行测试，使用常见的线性化扩散-阻力模型 $D(v) = D_0$ 和 $F(v) = \\alpha v$，其中 $D_0$ 和 $\\alpha$ 为正常数。该模型能以各向同性的形式再现散度结构和麦克斯韦弛豫行为。这个选择可以作为线性化 Landau 算子测试粒子部分的可接受替代。\n- 使用零通量边界条件。\n- 计算离散算子 $C_j$ 并通过计算以下表达式来验证不变量\n$$\nR_0 = \\sum_{j=1}^{N} \\Delta V_j \\, C_j, \\qquad R_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, C_j.\n$$\n- 对于每个测试用例，返回一个布尔值，指示 $|R_0|$ 和 $|R_2|$ 是否都低于指定的容差。使用 $10^{-10}$ 的绝对容差，并按参考量级进行缩放以避免得到平凡的真值结果；具体而言，要求 $|R_0| \\le \\varepsilon (1 + \\sum_j \\Delta V_j |L_j|)$ 和 $|R_2| \\le \\varepsilon (1 + \\sum_j \\Delta V_j v_j^2 |L_j|)$，其中 $\\varepsilon = 10^{-10}$。\n\n测试套件：\n- 提供以下测试用例，每个用例指定为 $(N, v_{\\max}, D_0, \\alpha, g(v))$：\n    1. $(64, 6.0, 0.2, 1.0, g(v) = e^{-v^2} - 0.5 e^{-2 v^2})$ 作为一般的光滑微扰（理想情况）。\n    2. $(16, 6.0, 0.1, 1.0, g(v) = (1 - 3 v^2) e^{-v^2/2})$ 用于测试粗分辨率效应。\n    3. $(8, 4.0, 0.3, 1.0, g(v) = 1)$ 用于测试常数微扰和边界伸缩求和（边界情况）。\n    4. $(64, 6.0, 0.2, 1.0, g(v) = v^2)$ 用于测试与能量不变量相关的多项式行为（边界情况）。\n    5. $(64, 6.0, 0.05, 0.5, g(v) = e^{-(v-5)^2})$ 用于测试在高速边界附近有尖峰的函数（边界情况）。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含五个测试用例的布尔结果，形式为用方括号括起来的逗号分隔列表（例如，“[True,False,True,True,False]”）。",
            "solution": "问题陈述经评估是有效的。它在计算等离子体物理领域提出了一个清晰、有科学依据且适定的任务：为线性化各向同性 Landau 碰撞算子实现一个守恒的有限体积离散化。其公式化是标准的，基于动理学理论和守恒律数值方法的基本原理。所有必要的参数、方程和条件都已提供，不存在矛盾或歧义。\n\n我们开始进行求解。目标是构建一个与连续算子 $C[g](v)$ 对应的数值算子 $C_j$，并验证它离散地守恒粒子数和能量。该算子是测试粒子部分 $C_{\\mathrm{TP}}$ 和场粒子部分 $C_{\\mathrm{FP}}$ 的和，我们将它们分别离散化为 $L_j$ 和 $S_j$。\n\n**1. 离散化框架**\n\n速度域 $v \\in [0, v_{\\max}]$ 被离散化为 $N$ 个均匀单元。单元宽度为 $\\Delta v = v_{\\max} / N$。\n-   单元边界位于 $v_{j+1/2} = j \\Delta v$，其中 $j=0, 1, \\dots, N$。\n-   单元中心位于 $v_j = (j - 1/2) \\Delta v$，其中 $j=1, 2, \\dots, N$。\n-   离散的微扰分布函数是以单元为中心的：$g_j = g(v_j)$。\n-   对应于单元 $j$ 的球壳的体积元近似为 $\\Delta V_j = 4\\pi v_j^2 \\Delta v$。由于因子 $4\\pi$ 是一个出现在所有守恒求和中的全局常数，为简单起见可以将其省略。问题中将离散体积度量定义为 $\\Delta V_j = v_j^2 \\Delta v$，这与此简化是一致的。\n\n**2. 测试粒子算子的离散化 ($L_j$)**\n\n测试粒子算子以散度形式给出：\n$$ C_{\\mathrm{TP}}[g](v) = \\frac{1}{v^2}\\frac{\\partial}{\\partial v} \\Phi(v), \\quad \\text{其中} \\quad \\Phi(v) = v^2 \\left( D(v)\\frac{\\partial g}{\\partial v} + F(v) g \\right) $$\n将其在一个单元体积 $V_j$（从 $v_{j-1/2}$ 到 $v_{j+1/2}$）上积分并应用微积分基本定理，得到：\n$$ \\int_{v_{j-1/2}}^{v_{j+1/2}} C_{\\mathrm{TP}}[g] \\, v^2 dv = \\Phi(v_{j+1/2}) - \\Phi(v_{j-1/2}) $$\n使用中点法则近似左侧，即 $L_j \\Delta V_j \\approx \\Phi(v_{j+1/2}) - \\Phi(v_{j-1/2})$，得出有限体积公式：\n$$ L_j = \\frac{J_{j+1/2} - J_{j-1/2}}{\\Delta V_j} $$\n其中 $J_{j+1/2}$ 是在单元边界 $v_{j+1/2}$ 处的数值通量，近似于 $-\\Phi(v_{j+1/2})$。选择的符号约定使得 $J$ 表示沿 $v$ 正方向的通量。问题为通量指定了一个特定的中心差分格式：\n$$ J_{j+1/2} = -D(v_{j+1/2}) v_{j+1/2}^2 \\left(\\frac{g_{j+1} - g_j}{\\Delta v}\\right) - F(v_{j+1/2}) v_{j+1/2}^2 \\left(\\frac{g_{j+1} + g_j}{2}\\right) $$\n这种格式是一个常见的选择，与 Chang-Cooper 方法有关，该方法对于扩散-平流问题具有良好的性质。边界条件是零通量，意味着 $J_{1/2} = 0$ 和 $J_{N+1/2} = 0$。由于通量公式中存在因子 $v_{1/2}^2 = 0^2=0$，原点处的通量 $J_{1/2}$ 自然为零。\n\n这种公式化方式的一个重要推论是，测试粒子算子离散地守恒粒子数。粒子总数的变化是：\n$$ \\sum_{j=1}^{N} L_j \\Delta V_j = \\sum_{j=1}^{N} (J_{j+1/2} - J_{j-1/2}) $$\n这是一个等于 $J_{N+1/2} - J_{1/2}$ 的伸缩求和。在零通量边界条件下，此和精确为零。因此，测试粒子算子不产生或消灭粒子。\n\n**3. 场粒子算子与守恒 ($S_j$)**\n\n测试粒子算子通常不守恒能量。场粒子算子的作用就是修正这一点。我们将场粒子源项 $S_j$ 建模为到碰撞算子离散各向同性零空间的投影，该零空间由 $\\{1, v_j^2\\}$ 张成。\n$$ S_j = A_0 + A_2 v_j^2 $$\n系数 $A_0$ 和 $A_2$ 是依赖于整个分布 $g$ 的标量值，通过对完整算子 $C_j = L_j + S_j$ 强制执行离散守恒律来确定。这两个守恒律分别是粒子数守恒和能量守恒：\n$$ \\sum_{j=1}^{N} C_j \\Delta V_j = 0 \\quad \\text{和} \\quad \\sum_{j=1}^{N} C_j v_j^2 \\Delta V_j = 0 $$\n\n**4. 修正系数 ($A_0, A_2$) 的推导**\n\n将 $C_j = L_j + S_j$ 代入守恒律，得到：\n1.  粒子数守恒： $\\sum_{j=1}^{N} (L_j + A_0 + A_2 v_j^2) \\Delta V_j = 0$\n2.  能量守恒： $\\sum_{j=1}^{N} (L_j + A_0 + A_2 v_j^2) v_j^2 \\Delta V_j = 0$\n\n重新整理这些方程，得到关于 $(A_0, A_2)$ 的一个线性系统：\n$$ \\sum_{j=1}^{N} L_j \\Delta V_j + A_0 \\sum_{j=1}^{N} \\Delta V_j + A_2 \\sum_{j=1}^{N} v_j^2 \\Delta V_j = 0 $$\n$$ \\sum_{j=1}^{N} L_j v_j^2 \\Delta V_j + A_0 \\sum_{j=1}^{N} v_j^2 \\Delta V_j + A_2 \\sum_{j=1}^{N} v_j^4 \\Delta V_j = 0 $$\n使用问题陈述中提供的矩的定义：\n-   $M_k = \\sum_{j=1}^{N} L_j v_j^k \\Delta V_j$\n-   $B_k = \\sum_{j=1}^{N} v_j^k \\Delta V_j$\n该系统变为：\n$$ M_0 + A_0 B_0 + A_2 B_2 = 0 $$\n$$ M_2 + A_0 B_2 + A_2 B_4 = 0 $$\n如前所述，根据有限体积的构造，$M_0 = 0$。系统因此简化，但为了数值稳健性，我们以矩阵形式求解完整的系统：\n$$ \\begin{pmatrix} B_0  B_2 \\\\ B_2  B_4 \\end{pmatrix} \\begin{pmatrix} A_0 \\\\ A_2 \\end{pmatrix} = \\begin{pmatrix} -M_0 \\\\ -M_2 \\end{pmatrix} $$\n这个 $2 \\times 2$ 系统可以解出 $A_0$ 和 $A_2$。该矩阵是一个格拉姆矩阵，当 $N  1$ 时是可逆的。\n\n**5. 守恒验证**\n\n在计算了 $L_j$、矩 $M_0, M_2, B_0, B_2, B_4$、求解了 $A_0, A_2$ 并构建了完整算子 $C_j = L_j + A_0 + A_2 v_j^2$ 之后，我们必须验证其守恒性质是否成立。我们计算离散残差：\n$$ R_0 = \\sum_{j=1}^{N} C_j \\Delta V_j \\quad \\text{和} \\quad R_2 = \\sum_{j=1}^{N} C_j v_j^2 \\Delta V_j $$\n根据代数构造，这些残差应该在浮点数值精度范围内为零。为了进行稳健的检查，我们使用指定的相对容差标准：\n$$ |R_0| \\le \\varepsilon \\left(1 + \\sum_j \\Delta V_j |L_j|\\right) \\quad \\text{和} \\quad |R_2| \\le \\varepsilon \\left(1 + \\sum_j \\Delta V_j v_j^2 |L_j|\\right) $$\n其中 $\\varepsilon = 10^{-10}$。当碰撞算子的作用很弱时（即当 $L_j$ 处处很小时），这种归一化可以防止出现错误的真值结果。\n\n下面的 Python 代码实现了这整个过程。",
            "answer": "```python\nimport numpy as np\n\ndef run_conservation_test(N, vmax, D0, alpha, g_func):\n    \"\"\"\n    Implements and tests a conservative finite-volume discretization of the\n    linearized isotropic Landau collision operator.\n    \n    Args:\n        N (int): Number of velocity cells.\n        vmax (float): Maximum speed in the domain [0, vmax].\n        D0 (float): Constant for the diffusion coefficient model D(v) = D0.\n        alpha (float): Constant for the friction coefficient model F(v) = alpha * v.\n        g_func (callable): The perturbation distribution function g(v).\n\n    Returns:\n        bool: True if both number and energy are conserved to the specified tolerance, False otherwise.\n    \"\"\"\n    # 1. Grid setup\n    dv = vmax / N\n    v_cell = (np.arange(N) + 0.5) * dv\n    v_edge = np.arange(N + 1) * dv\n\n    # 2. Evaluate g on cell centers\n    g_vals = g_func(v_cell)\n\n    # 3. Calculate numerical fluxes J at cell edges\n    J = np.zeros(N + 1)  # J[0] and J[N] are 0 by zero-flux BC\n\n    # Calculate internal fluxes J[1]...J[N-1] using vectorization\n    # These correspond to edges v_edge[1] through v_edge[N-1]\n    g_left = g_vals[:-1]   # g_0 to g_{N-2}\n    g_right = g_vals[1:]   # g_1 to g_{N-1}\n    v_internal_edges = v_edge[1:-1]\n\n    # D(v) = D0, F(v) = alpha * v\n    D_edge = D0 * np.ones_like(v_internal_edges)\n    F_edge = alpha * v_internal_edges\n\n    diff_term = -D_edge * v_internal_edges**2 * (g_right - g_left) / dv\n    drag_term = -F_edge * v_internal_edges**2 * (g_right + g_left) / 2.0\n    J[1:-1] = diff_term + drag_term\n\n    # 4. Calculate the discrete test-particle operator L_j\n    delta_V = v_cell**2 * dv\n    J_right_of_cell = J[1:]  # J_1 to J_N\n    J_left_of_cell = J[:-1]   # J_0 to J_{N-1}\n    \n    # The denominator delta_V is non-zero since v_cell is never zero.\n    L = (J_right_of_cell - J_left_of_cell) / delta_V\n\n    # 5. Calculate moments for the linear system\n    # Basis moments\n    v_cell_sq = v_cell**2\n    v_cell_4 = v_cell**4\n    B0 = np.sum(delta_V)\n    B2 = np.sum(delta_V * v_cell_sq)\n    B4 = np.sum(delta_V * v_cell_4)\n\n    # Test-particle moments\n    M0 = np.sum(delta_V * L)\n    M2 = np.sum(delta_V * v_cell_sq * L)\n    # M0 should be zero to machine precision due to the telescoping sum of fluxes and zero-flux BCs.\n    \n    # 6. Solve for the field-particle coefficients A0, A2\n    mat = np.array([[B0, B2], [B2, B4]])\n    rhs = np.array([-M0, -M2])\n    try:\n        A0, A2 = np.linalg.solve(mat, rhs)\n    except np.linalg.LinAlgError:\n        # This case should not be reached for N > 1\n        return False\n\n    # 7. Calculate the full discrete operator C_j and conservation residuals R0, R2\n    S = A0 + A2 * v_cell_sq\n    C = L + S\n\n    R0 = np.sum(delta_V * C)\n    R2 = np.sum(delta_V * v_cell_sq * C)\n\n    # 8. Perform the verification check against the specified tolerance\n    epsilon = 1e-10\n    norm0 = 1.0 + np.sum(delta_V * np.abs(L))\n    norm2 = 1.0 + np.sum(delta_V * v_cell_sq * np.abs(L))\n    \n    check0 = np.abs(R0) = epsilon * norm0\n    check2 = np.abs(R2) = epsilon * norm2\n    \n    return check0 and check2\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (64, 6.0, 0.2, 1.0, lambda v: np.exp(-v**2) - 0.5 * np.exp(-2 * v**2)),\n        (16, 6.0, 0.1, 1.0, lambda v: (1 - 3 * v**2) * np.exp(-v**2 / 2.0)),\n        (8, 4.0, 0.3, 1.0, lambda v: np.ones_like(v)),\n        (64, 6.0, 0.2, 1.0, lambda v: v**2),\n        (64, 6.0, 0.05, 0.5, lambda v: np.exp(-(v - 5.0)**2)),\n    ]\n\n    results = []\n    for case in test_cases:\n        is_conserved = run_conservation_test(*case)\n        results.append(str(is_conserved))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}