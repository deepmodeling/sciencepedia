{
    "hands_on_practices": [
        {
            "introduction": "准中性近似是许多等离子体流体模型的基石，它通过用一个代数约束取代泊松方程，极大地简化了系统。然而，这个近似并非普遍有效。本练习提供了一个动手实践的机会，通过在聚变研究的关键区域——托卡马克H模台基的背景下，计算无量纲参数 $k\\lambda_D$ 来量化准中性近似的有效性。通过这个计算，您将对电荷分离变得显著、必须保留完整泊松方程的长度尺度，建立起具体的物理直觉。",
            "id": "4034667",
            "problem": "在高约束模式（H-模式）托卡马克边界基座中，描述静电涨落的简化流体模型通常通过引入准电中性假设来闭合，而不是求解泊松方程。考虑一个温度为 $T_{e}$ 的等温电子群体和一种电荷数为 $Z=1$ 的单一离子。背景电子数密度为 $n_{0}$，平衡密度梯度标长为 $L_{n} \\equiv \\left|\\left(\\mathrm{d}\\ln n/\\mathrm{d}r\\right)^{-1}\\right|$。假设特征径向涨落波数的标度关系为 $k \\sim 1/L_{n}$。\n\n从静电学中的高斯定律（泊松方程）和等温电子状态方程出发，推导电子德拜长度 $\\lambda_{D}$ 关于 $n_{0}$ 和 $T_{e}$ 的表达式。利用此表达式，为以下边界基座参数计算无量纲参数 $k \\lambda_{D}$：\n- $n_{0} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，\n- $T_{e} = 800\\,\\mathrm{eV}$，\n- $L_{n} = 5.0\\,\\mathrm{mm}$。\n\n使用第一性原理标度论证，讨论关于 $k \\lambda_{D}$ 的判据，该判据划分了准电中性闭合有效与在流体闭合中必须保留泊松方程的界限，并在此背景下解释您的计算值。\n\n仅报告无量纲量 $k \\lambda_{D}$ 的数值，并四舍五入至三位有效数字。",
            "solution": "该问题被评估为具有科学依据、提法明确且客观，满足有效问题陈述的所有标准。我们开始求解。\n\n该问题要求推导电子德拜长度，为给定的托卡马克边界参数计算无量纲参数 $k \\lambda_{D}$，并讨论准电中性闭合近似的有效性。\n\n首先，我们推导电子德拜长度 $\\lambda_{D}$ 的表达式。我们从高斯定律开始，它在静电学中是关于电势 $\\phi$ 的泊松方程：\n$$ \\nabla^2 \\phi = -\\frac{\\rho_q}{\\epsilon_0} $$\n其中 $\\rho_q$ 是净电荷密度，$\\epsilon_0$ 是真空介电常数。对于由电子和一种电荷数为 $Z=1$ 的单一离子组成的等离子体，电荷密度为 $\\rho_q = e(n_i - n_e)$，其中 $e$ 是基本电荷，$n_i$ 是离子数密度，$n_e$ 是电子数密度。因此，泊松方程为：\n$$ \\nabla^2 \\phi = -\\frac{e(n_i - n_e)}{\\epsilon_0} $$\n为了找到特征屏蔽长度，我们考虑在一个均匀、中性的背景等离子体上施加一个小的微扰，其未受扰动的密度为 $n_0$。设电势是一个小的微扰 $\\phi$。电子是等温的，温度为 $T_e$，它们将根据玻尔兹曼关系重新分布：\n$$ n_e(\\phi) = n_0 \\exp\\left(\\frac{e\\phi}{T_e}\\right) $$\n在这里，$T_e$ 是以能量单位（焦耳）表示的电子温度。对于一个小的电势微扰，使得 $|e\\phi/T_e| \\ll 1$ 成立，我们可以将指数项线性化：\n$$ n_e \\approx n_0 \\left(1 + \\frac{e\\phi}{T_e}\\right) $$\n因此，电子密度微扰为 $\\tilde{n}_e = n_e - n_0 = n_0 \\frac{e\\phi}{T_e}$。在德拜屏蔽的标准推导中，我们认为离子是一个固定的、不可移动的中性化背景，因此 $n_i = n_0$。将这些代入泊松方程得到：\n$$ \\nabla^2 \\phi = -\\frac{e}{\\epsilon_0}\\left[n_0 - n_0 \\left(1 + \\frac{e\\phi}{T_e}\\right)\\right] = \\frac{e}{\\epsilon_0}\\left(n_0 \\frac{e\\phi}{T_e}\\right) = \\left(\\frac{n_0 e^2}{\\epsilon_0 T_e}\\right)\\phi $$\n这就是屏蔽泊松方程。通常写作 $\\nabla^2 \\phi = \\phi / \\lambda_D^2$，它将电子德拜长度的平方定义为：\n$$ \\lambda_D^2 = \\frac{\\epsilon_0 T_e}{n_0 e^2} $$\n因此，电子德拜长度为：\n$$ \\lambda_D = \\sqrt{\\frac{\\epsilon_0 T_e}{n_0 e^2}} $$\n这就是所要求的关于 $n_0$ 和 $T_e$ 的表达式。\n\n接下来，我们使用所提供的数据计算无量纲参数 $k \\lambda_{D}$ 的数值：\n- 背景电子密度：$n_{0} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n- 电子温度：$T_{e} = 800\\,\\mathrm{eV}$\n- 密度梯度标长：$L_{n} = 5.0\\,\\mathrm{mm} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$\n- 特征波数：$k \\sim 1/L_{n}$\n\n我们还使用基本常数的值：\n- 真空介电常数：$\\epsilon_0 \\approx 8.854 \\times 10^{-12}\\,\\mathrm{F/m}$\n- 基本电荷：$e \\approx 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n\n温度 $T_e$ 以电子伏特（$\\mathrm{eV}$）为单位，这是一个能量单位。为了在国际单位制（SI）中保持一致，我们将其转换为焦耳：\n$T_e (\\mathrm{J}) = 800\\,\\mathrm{eV} \\times \\frac{1.602 \\times 10^{-19}\\,\\mathrm{J}}{1\\,\\mathrm{eV}} = 1.2816 \\times 10^{-16}\\,\\mathrm{J}$。\n将此代入 $\\lambda_D^2$ 的表达式中：\n$$ \\lambda_D^2 = \\frac{(8.854 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (1.2816 \\times 10^{-16}\\,\\mathrm{J})}{(6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.602 \\times 10^{-19}\\,\\mathrm{C})^2} $$\n$$ \\lambda_D^2 \\approx \\frac{1.1347 \\times 10^{-27}}{1.5398 \\times 10^{-18}}\\,\\mathrm{m}^2 \\approx 7.369 \\times 10^{-10}\\,\\mathrm{m}^2 $$\n取平方根得到德拜长度：\n$$ \\lambda_D \\approx \\sqrt{7.369 \\times 10^{-10}\\,\\mathrm{m}^2} \\approx 2.715 \\times 10^{-5}\\,\\mathrm{m} $$\n特征径向波数 $k$ 由标度关系 $k \\sim 1/L_n$ 给出：\n$$ k = \\frac{1}{L_n} = \\frac{1}{5.0 \\times 10^{-3}\\,\\mathrm{m}} = 200\\,\\mathrm{m}^{-1} $$\n现在我们可以计算无量纲参数 $k \\lambda_{D}$：\n$$ k \\lambda_{D} = (200\\,\\mathrm{m}^{-1}) \\times (2.715 \\times 10^{-5}\\,\\mathrm{m}) = 5.43 \\times 10^{-3} $$\n四舍五入至三位有效数字，该值为 $5.43 \\times 10^{-3}$。\n\n最后，我们讨论决定准电中性闭合有效性的判据。\n准电中性闭合假设电荷密度涨落可以忽略不计，即 $\\rho_q = e(\\tilde{n}_i - \\tilde{n}_e) \\approx 0$，这意味着 $\\tilde{n}_e \\approx \\tilde{n}_i$。这个近似允许用一个更简单的代数约束来替代微分形式的泊松方程。为了确定这种近似何时有效，我们分析电子和离子密度微扰之间的完整关系。\n考虑一个特征波数为 $k$ 的涨落。在傅里叶空间中，拉普拉斯算符变为 $\\nabla^2 \\rightarrow -k^2$。泊松方程变为：\n$$ -k^2 \\phi = -\\frac{e(\\tilde{n}_i - \\tilde{n}_e)}{\\epsilon_0} $$\n使用线性化的电子玻尔兹曼关系 $\\tilde{n}_e = n_0 (e\\phi/T_e)$，我们可以解出电势 $\\phi$：\n$$ \\phi = \\frac{T_e}{n_0 e}\\tilde{n}_e $$\n将此代入傅里叶变换后的泊松方程：\n$$ -k^2 \\left(\\frac{T_e}{n_0 e}\\right)\\tilde{n}_e = -\\frac{e}{\\epsilon_0}(\\tilde{n}_i - \\tilde{n}_e) $$\n重新整理各项以求解 $\\tilde{n}_e$：\n$$ \\tilde{n}_e \\left( \\frac{e}{\\epsilon_0} - k^2\\frac{T_e}{n_0 e} \\right) = \\frac{e}{\\epsilon_0}\\tilde{n}_i $$\n$$ \\tilde{n}_e \\left( 1 - \\frac{\\epsilon_0 k^2 T_e}{n_0 e^2} \\right) = \\tilde{n}_i $$\n使用定义 $\\lambda_D^2 = \\epsilon_0 T_e / (n_0 e^2)$，上式简化为：\n$$ \\tilde{n}_e (1 + k^2 \\lambda_D^2) = \\tilde{n}_i $$\n或\n$$ \\tilde{n}_e = \\frac{\\tilde{n}_i}{1 + k^2 \\lambda_D^2} $$\n因此，准电中性假设 $\\tilde{n}_e \\approx \\tilde{n}_i$ 成立的充要条件是分母约等于1。这在以下情况下成立：\n$$ k^2 \\lambda_D^2 \\ll 1 \\quad \\text{或等价地} \\quad k\\lambda_D \\ll 1 $$\n在物理上，这个条件意味着涨落的特征长度标度 $\\lambda_{fluc} \\sim 1/k$ 远大于德拜长度 $\\lambda_D$。德拜长度是能够维持电荷分离的基本标度。对于远大于此标度的涨落，移动的电子可以有效地移动以屏蔽任何局域电荷不平衡，从而强制实现准电中性。相反，如果 $k\\lambda_D \\gtrsim 1$，涨落标度太短，电子无法有效屏蔽，导致显著的电荷分离（$\\rho_q \\neq 0$），此时必须保留泊松方程。\n\n在我们的计算情境中，我们得到 $k \\lambda_{D} \\approx 5.43 \\times 10^{-3}$。这个值远小于1，满足条件 $k\\lambda_D \\ll 1$。将其平方得到 $(k \\lambda_{D})^2 \\approx 2.95 \\times 10^{-5}$，非常接近于零。这表明，对于指定的H模式基座中的特征涨落，准电中性近似是极其准确的。这为使用计算成本较低的流体模型提供了依据，在这些模型中，泊松方程被代数条件 $\\tilde{n}_e = \\tilde{n}_i$ 所取代。",
            "answer": "$$ \\boxed{5.43 \\times 10^{-3}} $$"
        },
        {
            "introduction": "在无碰撞等离子体中，像朗道阻尼这样的动理学效应在波动力学和稳定性中起着至关重要的作用，但在标准流体描述中却不存在。本练习深入探讨了一种解决此闭合问题的高级技术：使用朗道流体闭合在流体模型中模拟动理学相混合。通过推导色散关系并分析所得系统的稳定性，您将亲身体验现代闭合模型的设计与验证过程，学会识别哪些参数区域能让模型提供有物理意义的阻尼，而哪些区域则可能引入伪数值不稳定性。",
            "id": "4034677",
            "problem": "考虑一个空间均匀、一维、无碰撞、静电、准中性的等离子体，该等离子体由单物质、三矩流体模型描述，该模型包含数密度 $n(x,t)$、流速 $u(x,t)$ 和温度 $T(x,t)$，压强为 $p(x,t) = n(x,t)\\,T(x,t)$。设平衡态为 $(n_{0}, u_{0}, T_{0}) = (n_{0}, 0, T_{0})$，并用 $(n_{1}, u_{1}, T_{1})$ 表示围绕该平衡态的小扰动。假设该物质的质量为 $m$，其热速度为 $v_{t} = \\sqrt{2 T_{0}/m}$。在傅里叶空间中，假设平面波形式为 $\\exp(i k x - i \\omega t)$，则线性化的矩方程为：\n- 连续性方程：$- i \\omega\\,n_{1} + i k\\,n_{0}\\,u_{1} = 0$。\n- 动量方程：$- i \\omega\\,m\\,n_{0}\\,u_{1} + i k\\,p_{1} = 0$，其中 $p_{1} = n_{0}\\,T_{1} + T_{0}\\,n_{1}$。\n- 能量方程：$- i \\omega\\,\\frac{3}{2}\\,n_{0}\\,T_{1} + i k\\,p_{0}\\,u_{1} + i k\\,q_{1} = 0$，其中 $p_{0} = n_{0}\\,T_{0}$。\n\n为了表示无碰撞相混合，对平行热通量采用 Hammett–Perkins 类型的朗道闭合：在傅里叶空间中，\n$$\nq_{1} = i\\,\\alpha\\,\\mathrm{sgn}(k)\\,n_{0}\\,v_{t}\\,T_{1},\n$$\n其中 $\\alpha$ 是一个实数、无量纲的闭合系数，$\\mathrm{sgn}(k)$ 是波数的符号函数。\n\n从上述基本守恒定律和给定的闭合关系出发，进行第一性原理线性分析以：\n1. 推导 $\\omega(k)$ 的色散关系。\n2. 确定参数 $\\alpha$ 的范围，以避免在绝热声学分支上出现伪不稳定性。\n3. 在 $|\\alpha|$ 很小的极限下，计算由 $\\omega(k) = \\omega_{0}(k) + i\\,\\gamma(k;\\alpha)$ 定义的主阶复数增长/阻尼率 $\\gamma(k;\\alpha)$，其中 $\\omega_{0}(k)$ 是在没有朗道闭合时的实数绝热声学频率。\n\n将最终要求的量 $\\gamma(k;\\alpha)$ 以 $\\mathrm{s}^{-1}$ 为单位表示，并写成包含 $\\alpha$、$k$ 和 $v_{t}$ 的封闭解析表达式。最终答案中不得报告任何中间结果。无需四舍五入；请提供精确表达式。",
            "solution": "我们从给定的一维、无碰撞、三矩流体方程以及热通量的朗道闭合出发。平衡态是均匀的，为 $(n_{0}, u_{0}, T_{0}) = (n_{0}, 0, T_{0})$，我们考虑具有平面波形式 $\\exp(i k x - i \\omega t)$ 的小扰动 $(n_{1}, u_{1}, T_{1})$。\n\n线性化方程为：\n1. 连续性方程：\n$$\n- i \\omega\\,n_{1} + i k\\,n_{0}\\,u_{1} = 0.\n$$\n2. 动量方程：\n$$\n- i \\omega\\,m\\,n_{0}\\,u_{1} + i k\\,p_{1} = 0, \\quad p_{1} = n_{0}\\,T_{1} + T_{0}\\,n_{1}.\n$$\n3. 能量方程：\n$$\n- i \\omega\\,\\frac{3}{2}\\,n_{0}\\,T_{1} + i k\\,p_{0}\\,u_{1} + i k\\,q_{1} = 0, \\quad p_{0} = n_{0}\\,T_{0},\n$$\n以及朗道闭合\n$$\nq_{1} = i\\,\\alpha\\,\\mathrm{sgn}(k)\\,n_{0}\\,v_{t}\\,T_{1}.\n$$\n\n我们首先用 $u_{1}$ 表示 $n_{1}$ 和 $T_{1}$。由连续性方程，\n$$\n- i \\omega\\,n_{1} + i k\\,n_{0}\\,u_{1} = 0 \\quad \\Rightarrow \\quad n_{1} = \\frac{k\\,n_{0}}{\\omega}\\,u_{1}.\n$$\n由动量方程，\n$$\n- i \\omega\\,m\\,n_{0}\\,u_{1} + i k\\,(n_{0}\\,T_{1} + T_{0}\\,n_{1}) = 0 \\quad \\Rightarrow \\quad - \\omega\\,m\\,n_{0}\\,u_{1} + k\\,(n_{0}\\,T_{1} + T_{0}\\,n_{1}) = 0.\n$$\n两边除以 $n_{0}$ 并代入 $n_{1}$：\n$$\n- \\omega\\,m\\,u_{1} + k\\left(T_{1} + T_{0}\\,\\frac{k}{\\omega}\\,u_{1}\\right) = 0.\n$$\n解出 $T_{1}$：\n$$\nT_{1} = \\frac{u_{1}}{k}\\left(\\omega\\,m - \\frac{k^{2}\\,T_{0}}{\\omega}\\right).\n$$\n\n现在将 $T_{1}$ 代入能量方程。使用 $q_{1} = i\\,\\alpha\\,\\mathrm{sgn}(k)\\,n_{0}\\,v_{t}\\,T_{1}$，我们得到\n$$\n- i \\omega\\,\\frac{3}{2}\\,n_{0}\\,T_{1} + i k\\,n_{0}\\,T_{0}\\,u_{1} + i k\\left(i\\,\\alpha\\,\\mathrm{sgn}(k)\\,n_{0}\\,v_{t}\\,T_{1}\\right) = 0.\n$$\n两边除以 $n_{0}$ 并整理：\n$$\n- i\\,\\frac{3}{2}\\,\\omega\\,T_{1} + i k\\,T_{0}\\,u_{1} - \\alpha\\,|k|\\,v_{t}\\,T_{1} = 0,\n$$\n因为 $i k\\,i\\,\\mathrm{sgn}(k) = - |k|$。\n\n代入 $T_{1} = \\dfrac{u_{1}}{k}\\left(\\omega\\,m - \\dfrac{k^{2}\\,T_{0}}{\\omega}\\right)$：\n$$\n- i\\,\\frac{3}{2}\\,\\omega\\,\\frac{u_{1}}{k}\\left(\\omega\\,m - \\frac{k^{2}\\,T_{0}}{\\omega}\\right) + i k\\,T_{0}\\,u_{1} - \\alpha\\,|k|\\,v_{t}\\,\\frac{u_{1}}{k}\\left(\\omega\\,m - \\frac{k^{2}\\,T_{0}}{\\omega}\\right) = 0.\n$$\n两边除以 $u_{1}$ 并乘以 $k$：\n$$\n- i\\,\\frac{3}{2}\\,\\omega\\left(\\omega\\,m - \\frac{k^{2}\\,T_{0}}{\\omega}\\right) + i k^{2}\\,T_{0} - \\alpha\\,|k|\\,v_{t}\\left(\\omega\\,m - \\frac{k^{2}\\,T_{0}}{\\omega}\\right) = 0.\n$$\n展开乘积：\n$$\n- i\\,\\frac{3}{2}\\left(m\\,\\omega^{2} - k^{2}\\,T_{0}\\right) + i k^{2}\\,T_{0} - \\alpha\\,|k|\\,v_{t}\\left(m\\,\\omega - \\frac{k^{2}\\,T_{0}}{\\omega}\\right) = 0.\n$$\n合并含 $i$ 的项：\n$$\n- i\\,\\frac{3}{2}\\,m\\,\\omega^{2} + i\\,\\frac{5}{2}\\,k^{2}\\,T_{0} - \\alpha\\,|k|\\,v_{t}\\left(m\\,\\omega - \\frac{k^{2}\\,T_{0}}{\\omega}\\right) = 0.\n$$\n两边乘以 $\\omega$：\n$$\n- i\\,\\frac{3}{2}\\,m\\,\\omega^{3} + i\\,\\frac{5}{2}\\,k^{2}\\,T_{0}\\,\\omega - \\alpha\\,|k|\\,v_{t}\\left(m\\,\\omega^{2} - k^{2}\\,T_{0}\\right) = 0.\n$$\n定义声速 $c_{s}^{2} \\equiv T_{0}/m$ 并将方程两边除以 $m$，以紧凑形式获得色散关系：\n$$\n\\frac{3}{2}\\,i\\,\\omega^{3} - \\frac{5}{2}\\,i\\,k^{2}\\,c_{s}^{2}\\,\\omega - \\alpha\\,|k|\\,v_{t}\\left(\\omega^{2} - k^{2}\\,c_{s}^{2}\\right) = 0.\n$$\n\n在没有朗道闭合（$\\alpha = 0$）的情况下，色散关系简化为\n$$\n\\frac{3}{2}\\,i\\,\\omega^{3} - \\frac{5}{2}\\,i\\,k^{2}\\,c_{s}^{2}\\,\\omega = 0 \\quad \\Rightarrow \\quad i\\,\\omega\\left(\\frac{3}{2}\\,\\omega^{2} - \\frac{5}{2}\\,k^{2}\\,c_{s}^{2}\\right) = 0,\n$$\n得到绝热声学分支\n$$\n\\omega_{0}^{2}(k) = \\frac{5}{3}\\,c_{s}^{2}\\,k^{2}.\n$$\n\n现在我们通过写出以下形式来计算小 $|\\alpha|$ 的主阶复数修正\n$$\n\\omega(k) = \\omega_{0}(k) + i\\,\\gamma(k;\\alpha),\n$$\n其中 $|\\gamma| \\ll \\omega_{0}$。我们记\n$$\nF(\\omega) \\equiv \\frac{3}{2}\\,i\\,\\omega^{3} - \\frac{5}{2}\\,i\\,k^{2}\\,c_{s}^{2}\\,\\omega - \\alpha\\,|k|\\,v_{t}\\left(\\omega^{2} - k^{2}\\,c_{s}^{2}\\right).\n$$\n我们在 $\\omega_{0}$ 附近将 $F(\\omega)$ 按 $\\gamma$ 展开到一阶。将 $F(\\omega)$ 写为 $F(\\omega) = i\\,G(\\omega) + H(\\omega)$，其中\n$$\nG(\\omega) \\equiv \\frac{3}{2}\\,\\omega^{3} - \\frac{5}{2}\\,k^{2}\\,c_{s}^{2}\\,\\omega, \\quad H(\\omega) \\equiv - \\alpha\\,|k|\\,v_{t}\\left(\\omega^{2} - k^{2}\\,c_{s}^{2}\\right).\n$$\n在 $\\omega_{0}$ 处，根据构造有 $G(\\omega_{0}) = 0$，并且\n$$\nH(\\omega_{0}) = - \\alpha\\,|k|\\,v_{t}\\left(\\omega_{0}^{2} - k^{2}\\,c_{s}^{2}\\right) = - \\alpha\\,|k|\\,v_{t}\\left(\\frac{5}{3} - 1\\right)c_{s}^{2}\\,k^{2} = - \\alpha\\,|k|\\,v_{t}\\,\\frac{2}{3}\\,c_{s}^{2}\\,k^{2}.\n$$\n一阶展开给出\n$$\nG(\\omega) \\approx G(\\omega_{0}) + \\left.\\frac{dG}{d\\omega}\\right|_{\\omega_{0}}\\,(i\\,\\gamma), \\quad \\frac{dG}{d\\omega} = \\frac{9}{2}\\,\\omega^{2} - \\frac{5}{2}\\,k^{2}\\,c_{s}^{2}.\n$$\n在 $\\omega_{0}^{2} = \\frac{5}{3}\\,c_{s}^{2}\\,k^{2}$ 处，\n$$\n\\left.\\frac{dG}{d\\omega}\\right|_{\\omega_{0}} = \\frac{9}{2}\\left(\\frac{5}{3}\\,c_{s}^{2}\\,k^{2}\\right) - \\frac{5}{2}\\,c_{s}^{2}\\,k^{2} = \\left(\\frac{15}{2} - \\frac{5}{2}\\right)c_{s}^{2}\\,k^{2} = 5\\,c_{s}^{2}\\,k^{2}.\n$$\n因此\n$$\ni\\,G(\\omega) \\approx i \\cdot \\left(5\\,c_{s}^{2}\\,k^{2}\\,i\\,\\gamma\\right) = - 5\\,c_{s}^{2}\\,k^{2}\\,\\gamma.\n$$\n类似地，\n$$\nH(\\omega) \\approx H(\\omega_{0}) + \\left.\\frac{dH}{d\\omega}\\right|_{\\omega_{0}}\\,(i\\,\\gamma), \\quad \\frac{dH}{d\\omega} = - \\alpha\\,|k|\\,v_{t}\\,(2\\,\\omega).\n$$\n于是\n$$\n\\left.\\frac{dH}{d\\omega}\\right|_{\\omega_{0}} = - 2\\,\\alpha\\,|k|\\,v_{t}\\,\\omega_{0}, \\quad \\Rightarrow \\quad H(\\omega) \\approx H(\\omega_{0}) - i\\,2\\,\\alpha\\,|k|\\,v_{t}\\,\\omega_{0}\\,\\gamma.\n$$\n收集 $F(\\omega) \\approx i\\,G(\\omega) + H(\\omega)$ 的一阶实部和虚部：\n- 实部：\n$$\n\\Re[F] \\approx - 5\\,c_{s}^{2}\\,k^{2}\\,\\gamma + H(\\omega_{0}) = 0.\n$$\n- 虚部：\n$$\n\\Im[F] \\approx - 2\\,\\alpha\\,|k|\\,v_{t}\\,\\omega_{0}\\,\\gamma = 0.\n$$\n对于非零的 $\\gamma$，仅当 $\\alpha = 0$ 时，虚部在这一阶自动为零。但在这里，它代表了来自闭合的一阶修正，并且在主阶上不约束 $\\gamma$，因为主要的虚部贡献来自 $i\\,G(\\omega)$，而我们已经在实部中用它与 $H(\\omega_{0})$ 进行了平衡。求解实部的平衡方程得到\n$$\n\\gamma(k;\\alpha) = \\frac{H(\\omega_{0})}{5\\,c_{s}^{2}\\,k^{2}} = \\frac{- \\alpha\\,|k|\\,v_{t}\\,\\frac{2}{3}\\,c_{s}^{2}\\,k^{2}}{5\\,c_{s}^{2}\\,k^{2}} = - \\frac{2}{15}\\,\\alpha\\,|k|\\,v_{t}.\n$$\n\n这个主阶结果表明，当 $\\alpha > 0$ 时，绝热声学分支是阻尼的（因为 $\\gamma  0$）；当 $\\alpha  0$ 时，它会伪增长（因为 $\\gamma > 0$）。因此，避免绝热声学分支上出现伪不稳定性的参数范围是 $\\alpha \\ge 0$。\n\n最后，所求的小 $|\\alpha|$ 增长/阻尼率的封闭解析表达式为\n$$\n\\gamma(k;\\alpha) = - \\frac{2}{15}\\,\\alpha\\,|k|\\,v_{t}.\n$$\n该表达式具有时间的倒数单位，因为 $|k|\\,v_{t}$ 具有频率的量纲。以 $\\mathrm{s}^{-1}$ 为单位表示，计算完成。",
            "answer": "$$\\boxed{-\\frac{2}{15}\\,\\alpha\\,|k|\\,v_{t}}$$"
        },
        {
            "introduction": "一个理论闭合模型的价值取决于其在模拟代码中的正确实现。本实践将介绍一种用于代码验证的严谨且不可或缺的技术——“人造解方法”（Method of Manufactured Solutions, MMS）。您将把MMS应用于各向异性的布拉金斯基热流闭合的二维实现中，这是许多聚变等离子体模拟中的一个关键组成部分。这个动手编码练习将指导您推导一个精确的解析源项，并用它来衡量数值格式的收敛率，从而为您开发可靠的计算模型提供基本技能。",
            "id": "4034676",
            "problem": "考虑一个准中性、磁化的等离子体，该等离子体通过流体描述进行建模，并使用 Braginskii 型闭合来处理电子热通量。在准中性假设下，电子数密度约等于离子数密度，并且需要闭合关系式来用低阶矩表示高阶矩。在磁化等离子体中，Braginskii 电子热通量闭合相对于磁场方向表现出强烈的各向异性。在二维空间中，当恒定磁场的单位矢量指向一个固定方向时，热通量闭合可以用平行和垂直热导率来表示。目标是通过人造解方法（Method of Manufactured Solutions, MMS）验证此闭合的数值实现的正确性，并在网格加密过程中测量其收敛率。\n\n您必须从以下基础出发：\n- 在二维域中，对于恒定磁场方向的 Braginskii 电子热通量闭合由下式给出\n$$\n\\boldsymbol{q} = -\\kappa_{\\perp} \\nabla T - \\left(\\kappa_{\\parallel} - \\kappa_{\\perp}\\right)\\left(\\boldsymbol{b}\\cdot\\nabla T\\right)\\boldsymbol{b},\n$$\n其中 $T$ 是电子温度，$\\boldsymbol{b}$ 是沿磁场方向的恒定单位矢量，$\\kappa_{\\parallel}$ 是平行热导率，$\\kappa_{\\perp}$ 是垂直热导率。在高碰撞、强磁化极限下，一种广泛使用的形式是 $\\kappa_{\\parallel} = C T^{5/2}$（其中 $C$ 是一个常数），以及 $\\kappa_{\\perp} = \\epsilon \\kappa_{\\parallel}$（其中 $\\epsilon \\in [0,1]$ 是一个无量纲的各向异性比）。\n- 热通量的散度作为源项进入电子能量方程，并由 $-\\nabla\\cdot\\boldsymbol{q}$ 给出。\n\n您的任务是构造一个人造温度场，并推导出该场下 Braginskii 热通量的精确解析散度。然后，使用具有周期性边界条件的二阶中心有限差分实现数值近似，以计算散度，并测量网格加密时的误差和收敛率。\n\n域和人造解：\n- 使用一个方形周期域 $[0,2\\pi]\\times[0,2\\pi]$。\n- 设人造温度场为\n$$\nT(x,y) = T_0 + A \\sin(k_x x)\\cos(k_y y),\n$$\n其中常数 $T_0>0$，$A>0$，$k_x>0$，$k_y>0$。\n- 设 $\\boldsymbol{b} = (\\cos\\theta,\\sin\\theta)$ 是由角度 $\\theta$ 设定的恒定磁场单位矢量。\n- 设 $\\kappa_{\\parallel} = C T^{5/2}$ 且 $\\kappa_{\\perp} = \\epsilon \\kappa_{\\parallel}$，其中 $C>0$ 且 $\\epsilon\\in[0,1]$。\n\n需要推导的解析表达式：\n- 为给定的人造 $T(x,y)$ 推导 $\\nabla\\cdot\\boldsymbol{q}$ 的显式解析公式，该公式用 $T$、其梯度和 Hessian 矩阵、$C$、$\\epsilon$ 和 $\\boldsymbol{b}$ 表示。您的推导必须从上述闭合定义和基本矢量微积分恒等式出发。您必须仅使用 $T$、$\\nabla T$、$\\nabla^2 T$、$T$ 的 Hessian 矩阵和常数来表示 $\\nabla\\cdot\\boldsymbol{q}$。\n\n数值方法：\n- 在具有周期性边界条件的均匀网格上，实现二阶精确的中心有限差分，以数值近似 $\\boldsymbol{q}$ 和 $\\nabla\\cdot\\boldsymbol{q}$。对于在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格上采样的标量场 $f$，使用中心差分公式\n$$\n\\partial_x f_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x},\\quad \\partial_y f_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y},\n$$\n以及矢量场散度的相应表达式。\n\n误差和收敛率：\n- 对于每个分辨率为 $N\\times N$（每个方向有 $N$ 个点）的网格，计算均方根误差\n$$\nE(N) = \\sqrt{\\frac{1}{N^2}\\sum_{i,j}\\left[\\left(\\nabla\\cdot\\boldsymbol{q}\\right)^{\\text{num}}_{i,j} - \\left(\\nabla\\cdot\\boldsymbol{q}\\right)^{\\text{exact}}_{i,j}\\right]^2}.\n$$\n- 对于连续的网格加密，使用最后两个网格尺寸通过以下公式估算观察到的收敛阶\n$$\np = \\frac{\\log\\left(E(N_{\\text{coarse}})/E(N_{\\text{fine}})\\right)}{\\log(2)},\n$$\n其中 $N_{\\text{fine}} = 2 N_{\\text{coarse}}$。\n\n测试套件：\n- 使用以下四个测试用例，它们探究了该闭合的不同方面：\n    - 用例 1：$(T_0,A,k_x,k_y,C,\\epsilon,\\theta) = (2.0, 0.5, 3, 2, 1.0, 0.05, 0)$。\n    - 用例 2：$(T_0,A,k_x,k_y,C,\\epsilon,\\theta) = (2.0, 0.5, 3, 2, 1.0, 0.05, \\pi/3)$。\n    - 用例 3：$(T_0,A,k_x,k_y,C,\\epsilon,\\theta) = (2.0, 0.5, 3, 2, 1.0, 1.0, \\pi/5)$。\n    - 用例 4：$(T_0,A,k_x,k_y,C,\\epsilon,\\theta) = (2.0, 0.5, 3, 2, 1.0, 0.0, \\pi/4)$。\n- 对于每个用例，计算网格尺寸为 $N\\in\\{32,64,128,256\\}$ 时的误差。\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含四个测试用例的观察收敛阶 $p$，格式为方括号括起来的逗号分隔列表，每个值四舍五入到三位小数（无单位）。例如，输出格式必须与下面完全一样\n$$\n[\\text{p\\_case1},\\text{p\\_case2},\\text{p\\_case3},\\text{p\\_case4}],\n$$\n其中每个 $\\text{p\\_casek}$ 是一个四舍五入到三位小数的浮点数。",
            "solution": "所提出的问题是计算科学领域一个定义明确的练习，特别是在等离子体流体建模的范畴内。它要求应用人造解方法（MMS）来验证各向异性 Braginskii 电子热通量闭合的数值实现。该问题具有科学依据，数学上一致，并且为获得唯一解提供了所有必要的参数和条件。我们确认该问题有效，并着手求解，求解过程包括两个主要部分：源项的解析推导和数值验证程序的设计。\n\n### 1. 热通量散度的解析推导\n\n起点是在具有恒定磁场单位矢量 $\\boldsymbol{b}$ 的磁化等离子体中，电子热通量矢量 $\\boldsymbol{q}$ 的 Braginskii 闭合：\n$$\n\\boldsymbol{q} = -\\kappa_{\\perp} \\nabla T - (\\kappa_{\\parallel} - \\kappa_{\\perp})(\\boldsymbol{b}\\cdot\\nabla T)\\boldsymbol{b}\n$$\n这里，$T$ 是电子温度，$\\kappa_{\\parallel}$ 和 $\\kappa_{\\perp}$ 分别是平行和垂直于磁场的热导率。热导率是温度的函数：$\\kappa_{\\parallel} = C T^{5/2}$ 和 $\\kappa_{\\perp} = \\epsilon \\kappa_{\\parallel} = \\epsilon C T^{5/2}$，其中 $C$ 是一个常数，$\\epsilon \\in [0,1]$ 是各向异性比。\n\n目标是推导该热通量散度 $\\nabla\\cdot\\boldsymbol{q}$ 的解析表达式，它作为源项出现在电子能量守恒方程中。我们对 $\\boldsymbol{q}$ 的表达式取散度：\n$$\n\\nabla\\cdot\\boldsymbol{q} = -\\nabla\\cdot(\\kappa_{\\perp} \\nabla T) - \\nabla\\cdot\\left[(\\kappa_{\\parallel} - \\kappa_{\\perp})(\\boldsymbol{b}\\cdot\\nabla T)\\boldsymbol{b}\\right]\n$$\n我们使用标准矢量微积分恒等式分别分析每一项。\n\n对于第一项，我们应用标量与矢量场乘积的散度乘积法则，$\\nabla\\cdot(\\phi \\boldsymbol{A}) = \\nabla\\phi\\cdot\\boldsymbol{A} + \\phi\\nabla\\cdot\\boldsymbol{A}$：\n$$\n\\nabla\\cdot(\\kappa_{\\perp} \\nabla T) = (\\nabla\\kappa_{\\perp})\\cdot(\\nabla T) + \\kappa_{\\perp}(\\nabla\\cdot\\nabla T) = (\\nabla\\kappa_{\\perp})\\cdot(\\nabla T) + \\kappa_{\\perp}\\nabla^2 T\n$$\n$\\kappa_{\\perp}$ 的梯度使用链式法则求得：\n$$\n\\nabla\\kappa_{\\perp} = \\frac{d\\kappa_{\\perp}}{dT} \\nabla T = \\frac{d}{dT}(\\epsilon C T^{5/2}) \\nabla T = \\epsilon C \\left(\\frac{5}{2}T^{3/2}\\right) \\nabla T\n$$\n将其代回，第一项变为：\n$$\n\\nabla\\cdot(\\kappa_{\\perp} \\nabla T) = \\epsilon C \\frac{5}{2}T^{3/2} |\\nabla T|^2 + \\epsilon C T^{5/2} \\nabla^2 T\n$$\n\n对于第二项，我们定义标量场 $\\chi = \\kappa_{\\parallel} - \\kappa_{\\perp} = (1-\\epsilon)\\kappa_{\\parallel} = (1-\\epsilon)C T^{5/2}$。待求项为 $\\nabla\\cdot[\\chi (\\boldsymbol{b}\\cdot\\nabla T)\\boldsymbol{b}]$。由于 $\\boldsymbol{b}$ 是一个常数矢量，其散度为零，即 $\\nabla\\cdot\\boldsymbol{b} = 0$。应用乘积法则 $\\nabla\\cdot(\\phi\\boldsymbol{A})$，其中 $\\phi = \\chi(\\boldsymbol{b}\\cdot\\nabla T)$ 且 $\\boldsymbol{A} = \\boldsymbol{b}$：\n$$\n\\nabla\\cdot[\\phi\\boldsymbol{b}] = (\\nabla\\phi)\\cdot\\boldsymbol{b} + \\phi(\\nabla\\cdot\\boldsymbol{b}) = (\\nabla\\phi)\\cdot\\boldsymbol{b}\n$$\n现在我们计算 $\\nabla\\phi$：\n$$\n\\nabla\\phi = \\nabla[\\chi (\\boldsymbol{b}\\cdot\\nabla T)] = (\\boldsymbol{b}\\cdot\\nabla T)\\nabla\\chi + \\chi\\nabla(\\boldsymbol{b}\\cdot\\nabla T)\n$$\n将此梯度投影到 $\\boldsymbol{b}$ 上：\n$$\n(\\nabla\\phi)\\cdot\\boldsymbol{b} = (\\boldsymbol{b}\\cdot\\nabla T)(\\nabla\\chi\\cdot\\boldsymbol{b}) + \\chi[\\nabla(\\boldsymbol{b}\\cdot\\nabla T)\\cdot\\boldsymbol{b}]\n$$\n各分量为：\n$$\n\\nabla\\chi = \\frac{d\\chi}{dT}\\nabla T = (1-\\epsilon)C\\frac{5}{2}T^{3/2}\\nabla T \\implies \\nabla\\chi \\cdot \\boldsymbol{b} = (1-\\epsilon)C\\frac{5}{2}T^{3/2}(\\nabla T \\cdot \\boldsymbol{b})\n$$\n项 $\\nabla(\\boldsymbol{b}\\cdot\\nabla T)$ 是 $T$ 的 Hessian 矩阵（记为 $\\mathbf{H}_T$）作用于 $\\boldsymbol{b}$。因此，$\\nabla(\\boldsymbol{b}\\cdot\\nabla T)\\cdot\\boldsymbol{b} = (\\mathbf{H}_T\\cdot\\boldsymbol{b})\\cdot\\boldsymbol{b} = \\boldsymbol{b}\\cdot\\mathbf{H}_T\\cdot\\boldsymbol{b}$，这表示 $T$ 沿 $\\boldsymbol{b}$ 方向的二阶方向导数。\n将这些部分组合起来，$\\nabla\\cdot\\boldsymbol{q}$ 的第二项变为：\n$$\n-\\nabla\\cdot[\\dots] = -(1-\\epsilon)C\\left[\\frac{5}{2}T^{3/2}(\\boldsymbol{b}\\cdot\\nabla T)^2 + T^{5/2}(\\boldsymbol{b}\\cdot\\mathbf{H}_T\\cdot\\boldsymbol{b})\\right]\n$$\n\n结合两项，我们得到热通量散度的最终解析表达式：\n$$\n\\nabla\\cdot\\boldsymbol{q} = -\\epsilon C \\left(\\frac{5}{2}T^{3/2}|\\nabla T|^2 + T^{5/2}\\nabla^2 T\\right) - (1-\\epsilon)C\\left(\\frac{5}{2}T^{3/2}(\\boldsymbol{b}\\cdot\\nabla T)^2 + T^{5/2}(\\boldsymbol{b}\\cdot\\mathbf{H}_T\\cdot\\boldsymbol{b})\\right)\n$$\n\n### 2. 在人造解上的应用\n\n给定的人造温度场为 $T(x,y) = T_0 + A \\sin(k_x x)\\cos(k_y y)$。我们计算其必要的导数：\n- 梯度：$\\nabla T = \\begin{pmatrix} A k_x \\cos(k_x x)\\cos(k_y y) \\\\ -A k_y \\sin(k_x x)\\sin(k_y y) \\end{pmatrix}$\n- 拉普拉斯算子：$\\nabla^2 T = -A(k_x^2 + k_y^2) \\sin(k_x x)\\cos(k_y y)$\n- Hessian 矩阵：$\\mathbf{H}_T = \\begin{pmatrix} -A k_x^2 \\sin(k_x x)\\cos(k_y y)  -A k_x k_y \\cos(k_x x)\\sin(k_y y) \\\\ -A k_x k_y \\cos(k_x x)\\sin(k_y y)  -A k_y^2 \\sin(k_x x)\\cos(k_y y) \\end{pmatrix}$\n\n这些表达式在数值网格的每个点上进行计算，为 MMS 过程提供“精确”的源项 $(\\nabla\\cdot\\boldsymbol{q})^{\\text{exact}}$。矢量 $\\boldsymbol{b} = (\\cos\\theta, \\sin\\theta)$ 用于计算所需的点积。\n\n### 3. 数值格式与验证\n\n数值近似是在域 $[0,2\\pi]\\times[0,2\\pi]$ 上的均匀 $N \\times N$ 网格上构建的，网格间距为 $\\Delta x = \\Delta y = 2\\pi/N$。我们使用具有周期性边界条件的二阶中心差分。\n\n数值计算过程如下：\n1.  将温度场 $T(x,y)$ 离散化到网格点 $(x_i, y_j)$ 上，得到 $T_{i,j}$。\n2.  使用中心差分公式数值计算温度梯度 $(\\nabla T)_{i,j}$：\n    $$\n    (\\partial_x T)_{i,j} \\approx \\frac{T_{i+1,j} - T_{i-1,j}}{2\\Delta x}, \\quad (\\partial_y T)_{i,j} \\approx \\frac{T_{i,j+1} - T_{i,j-1}}{2\\Delta y}\n    $$\n    周期性通过环绕索引来处理（例如，$T_{N,j} = T_{0,j}$ 和 $T_{-1,j} = T_{N-1,j}$）。\n3.  计算电导率场 $\\kappa_{\\parallel, i,j} = C T_{i,j}^{5/2}$ 和 $\\kappa_{\\perp, i,j} = \\epsilon \\kappa_{\\parallel, i,j}$。\n4.  使用离散化的量组装数值热通量矢量场 $\\boldsymbol{q}_{i,j} = ((q_x)_{i,j}, (q_y)_{i,j})$：\n    $$\n    \\boldsymbol{q}_{i,j} = -\\kappa_{\\perp, i,j} (\\nabla T)_{i,j} - (\\kappa_{\\parallel, i,j} - \\kappa_{\\perp, i,j})(\\boldsymbol{b}\\cdot(\\nabla T)_{i,j})\\boldsymbol{b}\n    $$\n5.  使用其分量的中心差分数值计算 $\\boldsymbol{q}_{i,j}$ 的散度：\n    $$\n    (\\nabla\\cdot\\boldsymbol{q})^{\\text{num}}_{i,j} \\approx \\frac{(q_x)_{i+1,j} - (q_x)_{i-1,j}}{2\\Delta x} + \\frac{(q_y)_{i,j+1} - (q_y)_{i,j-1}}{2\\Delta y}\n    $$\n\n数值格式的误差通过网格上数值和精确散度场之间的均方根（RMS）误差 $E(N)$ 来量化。观察到的收敛阶 $p$ 是根据两个连续加密的网格（$N_{\\text{coarse}}$ 和 $N_{\\text{fine}}=2N_{\\text{coarse}}$）上的误差计算得出的：\n$$\np = \\frac{\\log\\left(E(N_{\\text{coarse}})/E(N_{\\text{fine}})\\right)}{\\log(2)}\n$$\n对于应用于光滑（解析）人造解的二阶精确格式，理论收敛率为 $p=2$。数值实验旨在确认该实现达到了这个预期速率。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run the MMS test for the Braginskii heat flux closure.\n    \"\"\"\n\n    test_cases = [\n        # (T0, A, kx, ky, C, epsilon, theta)\n        (2.0, 0.5, 3, 2, 1.0, 0.05, 0),\n        (2.0, 0.5, 3, 2, 1.0, 0.05, np.pi / 3),\n        (2.0, 0.5, 3, 2, 1.0, 1.0, np.pi / 5),\n        (2.0, 0.5, 3, 2, 1.0, 0.0, np.pi / 4),\n    ]\n\n    grid_sizes = [32, 64, 128, 256]\n\n    convergence_rates = []\n\n    for params in test_cases:\n        errors = []\n        for N in grid_sizes:\n            error = calculate_rms_error(N, params)\n            errors.append(error)\n        \n        # Calculate convergence rate using the last two grid sizes\n        # p = log(E_coarse / E_fine) / log(2)\n        p = np.log(errors[-2] / errors[-1]) / np.log(2)\n        convergence_rates.append(p)\n\n    # Format the final output as specified.\n    print(f\"[{','.join([f'{p:.3f}' for p in convergence_rates])}]\")\n\ndef calculate_rms_error(N, params):\n    \"\"\"\n    Calculates the RMS error for a given grid size N and parameter set.\n    \"\"\"\n    T0, A, kx, ky, C, epsilon, theta = params\n    \n    # --- Grid Setup ---\n    L = 2.0 * np.pi\n    dx = L / N\n    dy = L / N\n    x_1d = np.linspace(0, L, N, endpoint=False)\n    y_1d = np.linspace(0, L, N, endpoint=False)\n    x, y = np.meshgrid(x_1d, y_1d)\n\n    # Magnetic field components\n    bx = np.cos(theta)\n    by = np.sin(theta)\n\n    # --- 1. Analytical Calculation ---\n    # Manufactured solution and its derivatives\n    sin_kx_x = np.sin(kx * x)\n    cos_kx_x = np.cos(kx * x)\n    sin_ky_y = np.sin(ky * y)\n    cos_ky_y = np.cos(ky * y)\n\n    T_exact = T0 + A * sin_kx_x * cos_ky_y\n\n    dT_dx = A * kx * cos_kx_x * cos_ky_y\n    dT_dy = -A * ky * sin_kx_x * sin_ky_y\n\n    d2T_dx2 = -A * kx**2 * sin_kx_x * cos_ky_y\n    d2T_dy2 = -A * ky**2 * sin_kx_x * cos_ky_y\n    d2T_dxdy = -A * kx * ky * cos_kx_x * sin_ky_y\n\n    lap_T = d2T_dx2 + d2T_dy2\n    \n    # Terms for the divergence formula\n    grad_T_sq = dT_dx**2 + dT_dy**2\n    b_dot_grad_T = bx * dT_dx + by * dT_dy\n    b_dot_H_b = bx**2 * d2T_dx2 + 2 * bx * by * d2T_dxdy + by**2 * d2T_dy2\n    \n    # Temperature powers\n    T_pow_3_2 = T_exact**(3. / 2.)\n    T_pow_5_2 = T_exact**(5. / 2.)\n    \n    # Assemble the exact divergence of heat flux\n    term_perp = epsilon * C * (5./2. * T_pow_3_2 * grad_T_sq + T_pow_5_2 * lap_T)\n    term_par = (1 - epsilon) * C * (5./2. * T_pow_3_2 * b_dot_grad_T**2 + T_pow_5_2 * b_dot_H_b)\n    \n    div_q_exact = - (term_perp + term_par)\n\n    # --- 2. Numerical Calculation ---\n    # Helper functions for central differences with periodicity\n    def grad(field, dx, dy):\n        fx = (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2 * dx)\n        fy = (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2 * dy)\n        return fx, fy\n\n    def div(fx, fy, dx, dy):\n        dfx_dx = (np.roll(fx, -1, axis=1) - np.roll(fx, 1, axis=1)) / (2 * dx)\n        dfy_dy = (np.roll(fy, -1, axis=0) - np.roll(fy, 1, axis=0)) / (2 * dy)\n        return dfx_dx + dfy_dy\n\n    # Discretized temperature field\n    T_num = T0 + A * np.sin(kx * x) * np.cos(ky * y)\n    \n    # Conductivities\n    kappa_par = C * T_num**(5./2.)\n    kappa_perp = epsilon * kappa_par\n\n    # Numerical gradient of T\n    grad_T_num_x, grad_T_num_y = grad(T_num, dx, dy)\n    \n    # b dot grad(T)\n    b_dot_grad_T_num = bx * grad_T_num_x + by * grad_T_num_y\n    \n    # Components of the heat flux vector q\n    q_x = -kappa_perp * grad_T_num_x - (kappa_par - kappa_perp) * b_dot_grad_T_num * bx\n    q_y = -kappa_perp * grad_T_num_y - (kappa_par - kappa_perp) * b_dot_grad_T_num * by\n    \n    # Numerical divergence of q\n    div_q_num = div(q_x, q_y, dx, dy)\n\n    # --- 3. Error Calculation ---\n    rms_error = np.sqrt(np.mean((div_q_num - div_q_exact)**2))\n    \n    return rms_error\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}