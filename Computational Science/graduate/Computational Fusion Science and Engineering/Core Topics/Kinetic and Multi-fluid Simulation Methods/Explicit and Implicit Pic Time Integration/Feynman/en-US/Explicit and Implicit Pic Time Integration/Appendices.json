{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of any computational method, there is no substitute for walking through the core algorithm by hand. This first exercise guides you through one complete cycle of a standard explicit Particle-in-Cell (PIC) simulation, often called the \"PIC loop\" or \"PIC dance\" . By manually performing the steps of charge deposition, field solving, field interpolation, and particle pushing, you will gain a concrete understanding of how discrete particles and grid-based fields interact to self-consistently model plasma dynamics.",
            "id": "3977527",
            "problem": "Consider a one-dimensional, electrostatic Particle-In-Cell (PIC) model in normalized units where electron mass $m_{e}=1$, electron charge magnitude $e=1$, and vacuum permittivity $\\varepsilon_{0}=1$. The domain is periodic with length $L=1$, discretized by $N_{g}=4$ equally spaced grid nodes at positions $x_{i}=i\\Delta x$ for $i=0,1,2,3$, where $\\Delta x=L/N_{g}$. Electrons are cold, and ions are immobile, providing a uniform neutralizing background charge density. Use the following data at the integer time $t^{n}$:\n\n- Two electron macroparticles, each with charge $q=-1$, located at positions $x_{1}^{n}=0.125$ and $x_{2}^{n}=0.375$. Their velocities at the previous half-step are $v_{1}^{n-1/2}=0$ and $v_{2}^{n-1/2}=0$.\n- The immobile ion background charge density is uniform with value $\\rho_{\\mathrm{ion}}=+2$ (per unit length).\n- The time step is $\\Delta t=0.1$.\n\nPerform one complete PIC cycle at time $t^{n}$ using a standard explicit time integration:\n\n1. Deposit the electron charge density on the grid nodes by the Cloud-In-Cell (CIC) method. The linear shape function centered at a node $x_{i}$ is defined by $S(x-x_{i})=\\max\\!\\left(0,1-\\frac{|x-x_{i}|}{\\Delta x}\\right)$. The charge density contribution from a particle of charge $q$ at position $x_{p}^{n}$ onto node $i$ is $q\\,S(x_{p}^{n}-x_{i})/\\Delta x$. Superpose the contributions from both electrons and the uniform ion background to obtain the total charge density $\\rho_{i}^{n}$ at each node.\n2. Solve the discrete electrostatic Poisson equation on the grid with periodic boundary conditions,\n$$-\\frac{\\phi_{i+1}^{n}-2\\phi_{i}^{n}+\\phi_{i-1}^{n}}{\\Delta x^{2}}=\\frac{\\rho_{i}^{n}}{\\varepsilon_{0}},$$\nfor the electrostatic potential $\\phi_{i}^{n}$, enforcing the gauge condition $\\sum_{i=0}^{N_{g}-1}\\phi_{i}^{n}=0$. Then compute the electric field at the nodes by the centered difference,\n$$E_{i}^{n}=-\\frac{\\phi_{i+1}^{n}-\\phi_{i-1}^{n}}{2\\,\\Delta x}.$$\n3. Interpolate the electric field from the nodes to the particle positions using the same linear shape function to obtain $E(x_{p}^{n})$ for each electron.\n4. Advance the electron velocities using Newton’s second law with the explicit leapfrog update,\n$$v_{p}^{n+1/2}=v_{p}^{n-1/2}+\\frac{q}{m_{e}}\\,E(x_{p}^{n})\\,\\Delta t.$$\n\nCompute the updated velocity $v_{1}^{n+1/2}$ of the first electron after this single explicit PIC timestep. Express your final answer in normalized units and round your result to four significant figures.",
            "solution": "The problem requires performing one complete cycle of a one-dimensional electrostatic Particle-In-Cell (PIC) simulation. The process is broken down into four distinct steps as specified in the problem statement. The physical and numerical parameters are given in normalized units.\n\n**Parameters and Grid Setup**\n- Domain length: $L=1$.\n- Number of grid nodes: $N_g=4$.\n- Grid spacing: $\\Delta x = L/N_g = 1/4 = 0.25$.\n- Grid node positions: $x_i = i\\Delta x$ for $i \\in \\{0, 1, 2, 3\\}$. This gives $x_0=0$, $x_1=0.25$, $x_2=0.5$, and $x_3=0.75$.\n- Normalized physical constants: electron mass $m_e=1$, electron charge magnitude $e=1$, vacuum permittivity $\\varepsilon_0=1$.\n- Particle data at time $t^n$:\n    - Electron 1: charge $q=-1$, position $x_1^n = 0.125$.\n    - Electron 2: charge $q=-1$, position $x_2^n = 0.375$.\n- Initial velocities at $t^{n-1/2}$: $v_1^{n-1/2}=0$ and $v_2^{n-1/2}=0$.\n- Background ion charge density: $\\rho_{\\mathrm{ion}}=+2$.\n- Time step: $\\Delta t=0.1$.\n\n**Step 1: Charge Deposition**\n\nWe use the Cloud-In-Cell (CIC) method to deposit the electron charge onto the grid. The linear shape function is $S(x-x_i) = \\max \\left(0, 1 - \\frac{|x-x_i|}{\\Delta x}\\right)$. The charge density at a node $i$ from a particle $p$ is $\\rho_{p,i} = q_p S(x_p^n-x_i) / \\Delta x$.\n\nFor particle 1 at $x_1^n=0.125$:\nThe particle is between nodes $x_0=0$ and $x_1=0.25$. The distance to both nodes is $0.125$.\nThe interpolation weights are:\n$w_{1,0} = S(x_1^n-x_0) = 1 - \\frac{|0.125-0|}{0.25} = 1 - 0.5 = 0.5$.\n$w_{1,1} = S(x_1^n-x_1) = 1 - \\frac{|0.125-0.25|}{0.25} = 1 - 0.5 = 0.5$.\nThe weights for nodes $x_2$ and $x_3$ are $0$.\nThe charge density contributions from particle 1 are:\n$\\rho_{1,0} = \\frac{q w_{1,0}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$.\n$\\rho_{1,1} = \\frac{q w_{1,1}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$.\n\nFor particle 2 at $x_2^n=0.375$:\nThe particle is between nodes $x_1=0.25$ and $x_2=0.5$. The distance to both nodes is $0.125$.\nThe interpolation weights are:\n$w_{2,1} = S(x_2^n-x_1) = 1 - \\frac{|0.375-0.25|}{0.25} = 1 - 0.5 = 0.5$.\n$w_{2,2} = S(x_2^n-x_2) = 1 - \\frac{|0.375-0.5|}{0.25} = 1 - 0.5 = 0.5$.\nThe weights for nodes $x_0$ and $x_3$ are $0$.\nThe charge density contributions from particle 2 are:\n$\\rho_{2,1} = \\frac{q w_{2,1}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$.\n$\\rho_{2,2} = \\frac{q w_{2,2}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$.\n\nThe total electron charge density on the grid, $\\rho_{e,i}$, is the sum of contributions from both particles:\n$\\rho_{e,0} = \\rho_{1,0} + \\rho_{2,0} = -2 + 0 = -2$.\n$\\rho_{e,1} = \\rho_{1,1} + \\rho_{2,1} = -2 + (-2) = -4$.\n$\\rho_{e,2} = \\rho_{1,2} + \\rho_{2,2} = 0 + (-2) = -2$.\n$\\rho_{e,3} = \\rho_{1,3} + \\rho_{2,3} = 0 + 0 = 0$.\n\nThe total charge density $\\rho_i^n$ is the sum of the electron density and the uniform ion background density, $\\rho_{\\mathrm{ion}}=+2$:\n$\\rho_0^n = \\rho_{e,0} + \\rho_{\\mathrm{ion}} = -2 + 2 = 0$.\n$\\rho_1^n = \\rho_{e,1} + \\rho_{\\mathrm{ion}} = -4 + 2 = -2$.\n$\\rho_2^n = \\rho_{e,2} + \\rho_{\\mathrm{ion}} = -2 + 2 = 0$.\n$\\rho_3^n = \\rho_{e,3} + \\rho_{\\mathrm{ion}} = 0 + 2 = 2$.\nThe vector of total charge densities is $\\vec{\\rho}^n = (0, -2, 0, 2)$.\n\n**Step 2: Field Solve**\n\nWe solve the discrete Poisson equation with periodic boundary conditions: $-\\frac{\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n}{\\Delta x^2} = \\frac{\\rho_i^n}{\\varepsilon_0}$. With $\\varepsilon_0=1$ and $\\Delta x=0.25$, this becomes a system of linear equations for the potentials $\\phi_i^n$:\n$$2\\phi_i^n - \\phi_{i+1}^n - \\phi_{i-1}^n = \\Delta x^2 \\rho_i^n = (0.25)^2 \\rho_i^n = 0.0625 \\rho_i^n$$\nThe indices are taken modulo $N_g=4$. The system is:\n$i=0: 2\\phi_0 - \\phi_1 - \\phi_3 = 0.0625 \\times 0 = 0$.\n$i=1: 2\\phi_1 - \\phi_2 - \\phi_0 = 0.0625 \\times (-2) = -0.125$.\n$i=2: 2\\phi_2 - \\phi_3 - \\phi_1 = 0.0625 \\times 0 = 0$.\n$i=3: 2\\phi_3 - \\phi_0 - \\phi_2 = 0.0625 \\times 2 = 0.125$.\n\nFrom the first and third equations, we deduce $2\\phi_0 = \\phi_1 + \\phi_3$ and $2\\phi_2 = \\phi_1 + \\phi_3$, which implies $\\phi_0 = \\phi_2$.\nSubstituting $\\phi_2 = \\phi_0$ into the second and fourth equations gives:\n$2\\phi_1 - 2\\phi_0 = -0.125 \\implies \\phi_1 - \\phi_0 = -0.0625$.\n$2\\phi_3 - 2\\phi_0 = 0.125 \\implies \\phi_3 - \\phi_0 = 0.0625$.\nWe can express $\\phi_1$, $\\phi_2$, and $\\phi_3$ in terms of $\\phi_0$: $\\phi_1 = \\phi_0 - 0.0625$, $\\phi_2 = \\phi_0$, $\\phi_3 = \\phi_0 + 0.0625$.\nUsing the gauge condition $\\sum_{i=0}^{3} \\phi_i^n = 0$:\n$\\phi_0 + (\\phi_0 - 0.0625) + \\phi_0 + (\\phi_0 + 0.0625) = 4\\phi_0 = 0$, which gives $\\phi_0=0$.\nThe potentials are:\n$\\phi_0^n = 0$.\n$\\phi_1^n = -0.0625$.\n$\\phi_2^n = 0$.\n$\\phi_3^n = 0.0625$.\n\nNext, we compute the electric field at the nodes using the centered difference formula $E_i^n = -\\frac{\\phi_{i+1}^n - \\phi_{i-1}^n}{2\\Delta x}$, with $2\\Delta x = 0.5$:\n$E_0^n = -\\frac{\\phi_1 - \\phi_3}{0.5} = -\\frac{-0.0625 - 0.0625}{0.5} = -\\frac{-0.125}{0.5} = 0.25$.\n$E_1^n = -\\frac{\\phi_2 - \\phi_0}{0.5} = -\\frac{0 - 0}{0.5} = 0$.\n$E_2^n = -\\frac{\\phi_3 - \\phi_1}{0.5} = -\\frac{0.0625 - (-0.0625)}{0.5} = -\\frac{0.125}{0.5} = -0.25$.\n$E_3^n = -\\frac{\\phi_0 - \\phi_2}{0.5} = -\\frac{0 - 0}{0.5} = 0$.\nThe vector of electric fields is $\\vec{E}^n = (0.25, 0, -0.25, 0)$.\n\n**Step 3: Interpolate Electric Field**\n\nWe interpolate the electric field to the position of particle 1, $x_1^n=0.125$, using the same linear shape function (i.e., the same weights as in Step 1):\n$E(x_1^n) = \\sum_{i=0}^{3} E_i^n S(x_1^n - x_i) = E_0^n w_{1,0} + E_1^n w_{1,1}$.\n$E(x_1^n) = (0.25 \\times 0.5) + (0 \\times 0.5) = 0.125$.\n\n**Step 4: Advance Electron Velocity**\n\nFinally, we update the velocity of particle 1 using the explicit leapfrog scheme:\n$v_p^{n+1/2} = v_p^{n-1/2} + \\frac{q}{m_e} E(x_p^n) \\Delta t$.\nFor particle 1, we have $v_1^{n-1/2}=0$, $q=-1$, $m_e=1$, $E(x_1^n)=0.125$, and $\\Delta t=0.1$.\n$v_1^{n+1/2} = 0 + \\frac{-1}{1} \\times 0.125 \\times 0.1$.\n$v_1^{n+1/2} = -0.0125$.\n\nThe problem asks for the result to be rounded to four significant figures. The calculated value is exactly $-0.0125$. To express this with four significant figures, we add a trailing zero.\n$v_1^{n+1/2} \\approx -0.01250$.",
            "answer": "$$\\boxed{-0.01250}$$"
        },
        {
            "introduction": "The simplicity of the explicit leapfrog scheme comes at a cost, which is determined by strict stability constraints on the time step $\\Delta t$. This exercise explores the two most common physical phenomena that limit the time step in an explicit electromagnetic PIC simulation: the propagation speed of light waves and the frequency of electron plasma oscillations . Deriving these constraints from first principles is essential for predicting the performance of an explicit code and for understanding the motivation behind developing implicit methods that can overcome them.",
            "id": "3977923",
            "problem": "A magnetically confined fusion plasma is modeled by a coupled explicit Finite-Difference Time-Domain (FDTD) electromagnetic solver and a leapfrog Particle-In-Cell (PIC) particle mover on a uniform three-dimensional Yee grid. The electromagnetic field update is performed in vacuum regions with permittivity $\\varepsilon_0$ and permeability $\\mu_0$, and the particle advance uses the cold-plasma electron equation of motion. The computational domain has uniform grid spacing $\\Delta x = \\Delta y = \\Delta z = 2 \\,\\text{mm}$. The speed of light is $c = 3 \\times 10^{8} \\,\\text{m/s}$, and the plasma has a characteristic electron plasma angular frequency $\\omega_p = 5 \\times 10^{10} \\,\\text{s}^{-1}$.\n\nStarting only from the fundamental laws and core definitions\n- Maxwell's equations in vacuum, $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$ and $\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}$ with $\\mathbf{D} = \\varepsilon_0 \\mathbf{E}$ and $\\mathbf{B} = \\mu_0 \\mathbf{H}$, and $c = \\frac{1}{\\sqrt{\\varepsilon_0 \\mu_0}}$,\n- the cold-plasma electron equation of motion $m_e \\frac{d \\mathbf{v}}{d t} = - e \\mathbf{E}$ and the definition of the electron plasma angular frequency $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$,\n\nderive the explicit time integration stability constraints for\n1. the Yee FDTD update of the electromagnetic fields on the given grid, and\n2. the leapfrog discretization of plasma electron oscillations characterized by $\\omega_p$,\n\nthen determine the single maximum stable timestep $\\Delta t_{\\max}$ that guarantees stability of the coupled FDTD–PIC update. Use the given numerical values, express your final answer in seconds, and round your answer to three significant figures.",
            "solution": "The problem requires the derivation of two separate stability constraints for a coupled Particle-In-Cell (PIC) and Finite-Difference Time-Domain (FDTD) simulation, and the subsequent calculation of the most restrictive maximum stable timestep, $\\Delta t_{\\max}$. The two constraints arise from the electromagnetic field update (FDTD) and the plasma particle dynamics (PIC leapfrog mover), respectively.\n\nFirst, we derive the stability constraint for the FDTD update of Maxwell's equations in a vacuum on a uniform three-dimensional Yee grid. The governing equations are Maxwell's curl equations:\n$$\n\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\nUsing the constitutive relations for vacuum, $\\mathbf{D} = \\varepsilon_0 \\mathbf{E}$ and $\\mathbf{B} = \\mu_0 \\mathbf{H}$, these become:\n$$\n\\nabla \\times \\mathbf{E} = - \\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\n$$\nTo obtain the wave equation, we take the curl of the first equation and use the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$.\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = - \\mu_0 \\frac{\\partial}{\\partial t} (\\nabla \\times \\mathbf{H})\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E} = - \\mu_0 \\frac{\\partial}{\\partial t} \\left(\\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\\right)\n$$\nIn a source-free vacuum region, Gauss's law gives $\\nabla \\cdot \\mathbf{E} = 0$. Using the definition of the speed of light in vacuum, $c = \\frac{1}{\\sqrt{\\varepsilon_0 \\mu_0}}$, the equation simplifies to the homogeneous vector wave equation:\n$$\n\\nabla^2 \\mathbf{E} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = 0\n$$\nThe stability of the explicit FDTD method for this equation is governed by the Courant-Friedrichs-Lewy (CFL) condition. For a uniform three-dimensional grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$, the CFL condition requires that the numerical domain of dependence contains the physical domain of dependence. For the standard leapfrog FDTD scheme on a Yee grid, this condition is:\n$$\nc \\Delta t \\leq \\frac{1}{\\sqrt{\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} + \\frac{1}{(\\Delta z)^2}}}\n$$\nThe problem specifies a uniform grid where $\\Delta x = \\Delta y = \\Delta z = \\Delta s$.Substituting this into the inequality gives:\n$$\nc \\Delta t \\leq \\frac{1}{\\sqrt{\\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta s)^2}}} = \\frac{1}{\\sqrt{\\frac{3}{(\\Delta s)^2}}} = \\frac{\\Delta s}{\\sqrt{3}}\n$$\nThis gives the first stability constraint on the timestep, $\\Delta t_{\\text{CFL}}$:\n$$\n\\Delta t \\leq \\Delta t_{\\text{CFL}} = \\frac{\\Delta s}{c \\sqrt{3}}\n$$\n\nSecond, we derive the stability constraint for the leapfrog integration of plasma electron oscillations. The dynamics are described by the cold-plasma electron equation of motion and the definition of the current density $\\mathbf{J} = -n_0 e \\mathbf{v}$, where $n_0$ is the equilibrium electron density, $-e$ is the electron charge, and $\\mathbf{v}$ is the electron fluid velocity.\nThe equation of motion is given as:\n$$\nm_e \\frac{d \\mathbf{v}}{d t} = - e \\mathbf{E}\n$$\nTaking the time derivative of the current density definition:\n$$\n\\frac{d \\mathbf{J}}{d t} = -n_0 e \\frac{d \\mathbf{v}}{d t}\n$$\nSubstituting the equation of motion into this expression yields:\n$$\n\\frac{d \\mathbf{J}}{d t} = -n_0 e \\left( -\\frac{e}{m_e} \\mathbf{E} \\right) = \\frac{n_0 e^2}{m_e} \\mathbf{E}\n$$\nWe use the given definition of the electron plasma angular frequency, $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$, to rewrite the coefficient as $\\frac{n_0 e^2}{m_e} = \\varepsilon_0 \\omega_p^2$. Thus:\n$$\n\\frac{d \\mathbf{J}}{d t} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}\n$$\nTo find the characteristic oscillation, we consider the high-frequency electrostatic limit where magnetic fields are negligible. Ampere's law, $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$, in the absence of spatial variation (i.e., for long-wavelength modes where $\\nabla \\times \\mathbf{H} \\approx 0$), simplifies to $\\mathbf{J} + \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} \\approx 0$. This gives $\\frac{\\partial \\mathbf{E}}{\\partial t} \\approx -\\frac{1}{\\varepsilon_0}\\mathbf{J}$.\nTaking the time derivative of $\\frac{d \\mathbf{J}}{d t} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}$ gives:\n$$\n\\frac{d^2 \\mathbf{J}}{d t^2} = \\varepsilon_0 \\omega_p^2 \\frac{d \\mathbf{E}}{d t}\n$$\nSubstituting $\\frac{d \\mathbf{E}}{d t} \\approx -\\frac{1}{\\varepsilon_0}\\mathbf{J}$, we obtain the simple harmonic oscillator equation for the plasma current:\n$$\n\\frac{d^2 \\mathbf{J}}{d t^2} = \\varepsilon_0 \\omega_p^2 \\left( -\\frac{1}{\\varepsilon_0} \\mathbf{J} \\right) = -\\omega_p^2 \\mathbf{J} \\quad \\implies \\quad \\frac{d^2 \\mathbf{J}}{d t^2} + \\omega_p^2 \\mathbf{J} = 0\n$$\nThis equation describes oscillations at the plasma frequency $\\omega_p$. For a leapfrog scheme to remain numerically stable when integrating an oscillator equation of the form $\\ddot{x} + \\omega^2 x = 0$, the timestep $\\Delta t$ must resolve the oscillation. The stability limit for the standard leapfrog integrator is:\n$$\n\\omega \\Delta t < 2\n$$\nApplying this to the plasma oscillations, where the highest frequency is $\\omega_p$, we get the second stability constraint, $\\Delta t_{\\text{plasma}}$:\n$$\n\\Delta t < \\Delta t_{\\text{plasma}} = \\frac{2}{\\omega_p}\n$$\nNote that for accuracy, a much stricter condition (e.g., $\\omega_p \\Delta t \\lesssim 0.2$) is often used, but the question asks for the fundamental stability constraint.\n\nFinally, for the coupled FDTD-PIC simulation to be stable, the single timestep $\\Delta t$ must satisfy both constraints simultaneously. Therefore, the maximum stable timestep $\\Delta t_{\\max}$ is the minimum of the two individual limits:\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{CFL}}, \\Delta t_{\\text{plasma}}) = \\min\\left(\\frac{\\Delta s}{c \\sqrt{3}}, \\frac{2}{\\omega_p}\\right)\n$$\nWe now substitute the given numerical values:\n$\\Delta s = 2 \\,\\text{mm} = 2 \\times 10^{-3} \\,\\text{m}$\n$c = 3 \\times 10^{8} \\,\\text{m/s}$\n$\\omega_p = 5 \\times 10^{10} \\,\\text{s}^{-1}$\n\nCalculate $\\Delta t_{\\text{CFL}}$:\n$$\n\\Delta t_{\\text{CFL}} = \\frac{2 \\times 10^{-3} \\,\\text{m}}{(3 \\times 10^{8} \\,\\text{m/s}) \\sqrt{3}} = \\frac{2}{3 \\sqrt{3}} \\times 10^{-11} \\,\\text{s} \\approx 0.38490 \\times 10^{-11} \\,\\text{s} = 3.8490 \\times 10^{-12} \\,\\text{s}\n$$\nCalculate $\\Delta t_{\\text{plasma}}$:\n$$\n\\Delta t_{\\text{plasma}} = \\frac{2}{5 \\times 10^{10} \\,\\text{s}^{-1}} = 0.4 \\times 10^{-10} \\,\\text{s} = 4 \\times 10^{-11} \\,\\text{s}\n$$\nComparing the two values:\n$3.8490 \\times 10^{-12} \\,\\text{s} < 4 \\times 10^{-11} \\,\\text{s}$\nThus, the CFL condition is more restrictive. The maximum stable timestep is determined by $\\Delta t_{\\text{CFL}}$.\n$$\n\\Delta t_{\\max} = 3.8490 \\times 10^{-12} \\,\\text{s}\n$$\nRounding the result to three significant figures, as requested, we get:\n$$\n\\Delta t_{\\max} \\approx 3.85 \\times 10^{-12} \\,\\text{s}\n$$",
            "answer": "$$\\boxed{3.85 \\times 10^{-12}}$$"
        },
        {
            "introduction": "Implicit methods overcome the strict time step limits of explicit schemes by solving for the system's state at the future time $t^{n+1}$ self-consistently. This leads to a coupled, nonlinear system of equations that must be solved iteratively. This final practice problem plunges into the heart of an advanced implicit PIC algorithm, tasking you with setting up the iterative solver for a fully implicit, relativistic model . By deriving the residual function and its derivative, you will construct the core components of a Newton-Raphson solver, revealing the underlying mathematical structure of implicit PIC codes.",
            "id": "3977534",
            "problem": "Consider a spatially uniform, one-dimensional plasma slab of volume $V$ modeled with Particle-In-Cell (PIC), a method for representing a continuum of charged particles by a finite number of weighted macroparticles. Assume a single species of charge $q$ and mass $m$, with macroparticles indexed by $p=1,\\dots,N$ and weights $w_p$. The electric field $E(t)$ is uniform in space and points along the slab direction, and the magnetic field is neglected so that $B(t)=0$. The current density is defined by $J(t)=\\dfrac{q}{V}\\sum_{p=1}^{N} w_p\\, v_p(t)$, where $v_p(t)$ is the velocity of macroparticle $p$.\n\nStart from Maxwell–Ampère’s law in vacuum and the relativistic particle momentum equation. Use a time step $\\Delta t$ from $t^n$ to $t^{n+1}=t^n+\\Delta t$ and apply the backward Euler method to both field and particle equations to form a single nonlinear equation in the unknown $E^{n+1}$ by eliminating the particle momenta. Specifically:\n\n- Begin with Maxwell–Ampère’s law in vacuum and enforce spatial uniformity to relate the electric field time derivative to the current density.\n- Use the relativistic momentum equation for each macroparticle, where the momentum is $p_p(t)=\\gamma_p(t)\\, m\\, v_p(t)$ and $\\gamma_p(t)=\\sqrt{1+\\left(\\dfrac{p_p(t)}{m c}\\right)^2}$, and discretize it implicitly with backward Euler.\n- Express the current density at the new time $J^{n+1}$ in terms of the macroparticle velocities, and hence in terms of $E^{n+1}$ via the implicit particle push.\n\nDefine a scalar residual $R(E^{n+1})$ for the discrete Maxwell–Ampère relation with the implicit particle coupling. Derive $R(E^{n+1})$ and its derivative with respect to $E^{n+1}$ required for Newton’s method, and set up the Newton iteration $E_{k+1}=E_k+\\Delta E_k$ by giving the closed-form analytic expression for the Newton increment $\\Delta E_k$ in terms of $E_k$, the known data $E^n$, $\\Delta t$, $q$, $m$, $c$, $\\varepsilon_0$, $V$, $N$, $w_p$, and $p_p^n$.\n\nYour final answer must be the single analytic expression for the Newton increment $\\Delta E_k$. If evaluated numerically, $\\Delta E_k$ would carry SI units of volts per meter, but do not include units in the final boxed answer.",
            "solution": "The problem requires the derivation of the Newton increment, $\\Delta E_k$, for an iterative solution of the fully implicit, relativistic, electrostatic Particle-In-Cell (PIC) equations. The derivation proceeds by first establishing the discrete, nonlinear residual equation for the electric field at the advanced time step, $E^{n+1}$, and then linearizing it to find the Newton-Raphson update.\n\nFirst, we state the governing continuous equations.\nMaxwell–Ampère’s law in vacuum is given by $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$. The problem specifies a uniform system with zero magnetic field, $\\mathbf{B}(t)=0$. Under these conditions, the curl of the magnetic field is zero, and the equation simplifies to a one-dimensional form representing charge conservation:\n$$\n\\varepsilon_0 \\frac{dE(t)}{dt} + J(t) = 0\n$$\nHere, $E(t)$ is the spatially uniform electric field, $J(t)$ is the current density, and $\\varepsilon_0$ is the vacuum permittivity.\n\nThe second governing equation is the relativistic Lorentz force law for each macroparticle $p$. With no magnetic field, the equation for the particle momentum $p_p(t)$ is:\n$$\n\\frac{dp_p(t)}{dt} = q E(t)\n$$\nwhere $q$ is the particle charge.\n\nWe discretize these two ordinary differential equations in time from $t^n$ to $t^{n+1} = t^n + \\Delta t$ using the backward Euler method. For the field equation, this yields:\n$$\n\\varepsilon_0 \\frac{E^{n+1} - E^n}{\\Delta t} + J^{n+1} = 0\n$$\nwhere $E^n$ and $E^{n+1}$ are the electric fields at times $t^n$ and $t^{n+1}$, respectively, and $J^{n+1}$ is the current density at $t^{n+1}$.\n\nFor the particle momentum equation, the backward Euler discretization is:\n$$\n\\frac{p_p^{n+1} - p_p^n}{\\Delta t} = q E^{n+1}\n$$\nThis allows us to express the momentum of each particle $p$ at time $t^{n+1}$ as a function of the unknown future electric field $E^{n+1}$ and known quantities from time $t^n$:\n$$\np_p^{n+1} = p_p^n + q \\Delta t E^{n+1}\n$$\nThe current density $J^{n+1}$ is defined in terms of the particle velocities at time $t^{n+1}$:\n$$\nJ^{n+1} = \\frac{q}{V} \\sum_{p=1}^{N} w_p v_p^{n+1}\n$$\nwhere $V$ is the volume, $w_p$ are macroparticle weights, and $N$ is the number of macroparticles. The relativistic velocity $v_p^{n+1}$ is related to the momentum $p_p^{n+1}$ by $v_p^{n+1} = \\frac{p_p^{n+1}}{m \\gamma_p^{n+1}}$, where $m$ is the particle mass and $\\gamma_p^{n+1}$ is the Lorentz factor at $t^{n+1}$. The Lorentz factor is given by $\\gamma_p^{n+1} = \\sqrt{1 + \\left(\\frac{p_p^{n+1}}{mc}\\right)^2}$, with $c$ being the speed of light.\n\nSubstituting the expression for $p_p^{n+1}$ into the velocity relation, we couple the particle dynamics to the electric field $E^{n+1}$:\n$$\nv_p^{n+1} = \\frac{p_p^n + q \\Delta t E^{n+1}}{m \\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E^{n+1}}{mc}\\right)^2}}\n$$\nSubstituting this velocity and the subsequent current density $J^{n+1}$ back into the discretized Maxwell–Ampère equation gives a single nonlinear equation for the unknown $E^{n+1}$. We define the residual function $R(E^{n+1})$ to be the left-hand side of this equation:\n$$\nR(E^{n+1}) = \\varepsilon_0 \\frac{E^{n+1} - E^n}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{p_p^n + q \\Delta t E^{n+1}}{m \\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E^{n+1}}{mc}\\right)^2}} = 0\n$$\nThis is the nonlinear equation we must solve for $E^{n+1}$. Newton's method is an iterative procedure for finding the root of $R$. Starting with an initial guess $E_0$ (e.g., $E_0 = E^n$), the method generates a sequence of improved guesses $E_k$ using the iteration:\n$$\nE_{k+1} = E_k + \\Delta E_k\n$$\nwhere the increment $\\Delta E_k$ is given by\n$$\n\\Delta E_k = - \\frac{R(E_k)}{R'(E_k)}\n$$\nand $R'(E_k)$ is the derivative of $R$ with respect to its argument, evaluated at $E_k$.\n\nWe must now compute the derivative $R'(E^{n+1}) = \\frac{dR}{dE^{n+1}}$.\n$$\nR'(E^{n+1}) = \\frac{d}{dE^{n+1}} \\left( \\varepsilon_0 \\frac{E^{n+1} - E^n}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p v_p^{n+1} \\right)\n$$\n$$\nR'(E^{n+1}) = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{dv_p^{n+1}}{dE^{n+1}}\n$$\nTo find $\\frac{dv_p^{n+1}}{dE^{n+1}}$, we use the chain rule: $\\frac{dv_p^{n+1}}{dE^{n+1}} = \\frac{dv_p^{n+1}}{dp_p^{n+1}} \\frac{dp_p^{n+1}}{dE^{n+1}}$.\nFrom $p_p^{n+1} = p_p^n + q \\Delta t E^{n+1}$, we have $\\frac{dp_p^{n+1}}{dE^{n+1}} = q \\Delta t$.\nThe derivative of velocity with respect to momentum is a standard result in special relativity:\n$$\n\\frac{dv_p}{dp_p} = \\frac{d}{dp_p} \\left( \\frac{p_p c}{\\sqrt{m^2c^2 + p_p^2}} \\right) = \\frac{c}{\\sqrt{m^2c^2 + p_p^2}} - \\frac{p_p c \\cdot p_p}{(m^2c^2 + p_p^2)^{3/2}} = \\frac{c(m^2c^2 + p_p^2) - c p_p^2}{(m^2c^2 + p_p^2)^{3/2}} = \\frac{m^2c^3}{(m^2c^2 + p_p^2)^{3/2}}\n$$\nRecognizing that $\\gamma_p = \\frac{\\sqrt{m^2c^2 + p_p^2}}{mc}$, the denominator is $(mc\\gamma_p)^3$. Thus,\n$$\n\\frac{dv_p}{dp_p} = \\frac{m^2c^3}{m^3c^3\\gamma_p^3} = \\frac{1}{m\\gamma_p^3}\n$$\nApplying this to our case at time $t^{n+1}$: $\\frac{dv_p^{n+1}}{dp_p^{n+1}} = \\frac{1}{m(\\gamma_p^{n+1})^3}$.\nCombining the parts, $\\frac{dv_p^{n+1}}{dE^{n+1}} = \\frac{q \\Delta t}{m(\\gamma_p^{n+1})^3}$.\n\nSubstituting this back into the expression for $R'(E^{n+1})$:\n$$\nR'(E^{n+1}) = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{q \\Delta t}{m(\\gamma_p^{n+1})^3} = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{(\\gamma_p^{n+1})^3}\n$$\nNow we assemble the Newton increment $\\Delta E_k$. We evaluate $R$ and $R'$ at the current guess $E_k$ for $E^{n+1}$. Let $p_{p,k}^{n+1} = p_p^n + q \\Delta t E_k$ and $\\gamma_{p,k}^{n+1} = \\sqrt{1 + \\left(\\frac{p_{p,k}^{n+1}}{mc}\\right)^2}$.\nThe residual evaluated at $E_k$ is:\n$$\nR(E_k) = \\varepsilon_0 \\frac{E_k - E^n}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{p_{p,k}^{n+1}}{m \\gamma_{p,k}^{n+1}}\n$$\nThe derivative evaluated at $E_k$ is:\n$$\nR'(E_k) = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{(\\gamma_{p,k}^{n+1})^3}\n$$\nThe Newton increment is $\\Delta E_k = -R(E_k)/R'(E_k)$. Substituting the expressions and explicitly writing out $p_{p,k}^{n+1}$ gives the final expression:\n$$\n\\Delta E_k = - \\frac{\\varepsilon_0 \\frac{E_k - E^n}{\\Delta t} + \\frac{q}{mV} \\sum_{p=1}^{N} w_p \\frac{p_p^n + q \\Delta t E_k}{\\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2}}}{\\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{\\left(1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2\\right)^{3/2}}}\n$$\nThis is the closed-form analytic expression for the Newton increment as required.",
            "answer": "$$\n\\boxed{- \\frac{\\varepsilon_0 \\frac{E_k - E^n}{\\Delta t} + \\frac{q}{mV} \\sum_{p=1}^{N} w_p \\frac{p_p^n + q \\Delta t E_k}{\\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2}}}{\\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{\\left(1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2\\right)^{3/2}}}}\n$$"
        }
    ]
}