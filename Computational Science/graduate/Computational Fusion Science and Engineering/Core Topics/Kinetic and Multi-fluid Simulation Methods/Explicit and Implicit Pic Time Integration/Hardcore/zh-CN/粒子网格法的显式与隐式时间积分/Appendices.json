{
    "hands_on_practices": [
        {
            "introduction": "掌握任何计算方法的第一步都是亲手执行其核心算法。本练习将引导您完成一个标准显式PIC模拟的完整时间步长，通过具体的计算来固化从粒子到网格再回到粒子的基本循环流程。这有助于建立对显式粒子模拟中各个环节如何协同工作的直观理解。",
            "id": "3977527",
            "problem": "考虑一个一维静电粒子云网格（PIC；Particle-In-Cell）模型，采用归一化单位制，其中电子质量 $m_{e}=1$，电子电荷大小 $e=1$，真空介电常数 $\\varepsilon_{0}=1$。计算区域是长度为 $L=1$ 的周期性区域，由 $N_{g}=4$ 个等距的网格节点离散化，节点位置为 $x_{i}=i\\Delta x$（其中 $i=0,1,2,3$），网格间距 $\\Delta x=L/N_{g}$。电子是冷的，离子是固定的，形成均匀的中性化背景电荷密度。使用整数时间步 $t^{n}$ 的以下数据：\n\n- 两个电子宏粒子，每个电荷为 $q=-1$，位置分别为 $x_{1}^{n}=0.125$ 和 $x_{2}^{n}=0.375$。它们在前一个半步的速度为 $v_{1}^{n-1/2}=0$ 和 $v_{2}^{n-1/2}=0$。\n- 固定的背景离子电荷密度是均匀的，其值为 $\\rho_{\\mathrm{ion}}=+2$（每单位长度）。\n- 时间步长为 $\\Delta t=0.1$。\n\n使用标准的显式时间积分，在时间 $t^{n}$ 执行一个完整的 PIC 循环：\n\n1. 通过云中单元法（CIC）将电子电荷密度分配到网格节点上。以节点 $x_{i}$ 为中心的线性形函数定义为 $S(x-x_{i})=\\max\\!\\left(0,1-\\frac{|x-x_{i}|}{\\Delta x}\\right)$。位于位置 $x_{p}^{n}$、电荷为 $q$ 的粒子对节点 $i$ 的电荷密度贡献为 $q\\,S(x_{p}^{n}-x_{i})/\\Delta x$。叠加两个电子和均匀背景离子的贡献，以获得每个节点上的总电荷密度 $\\rho_{i}^{n}$。\n2. 在网格上求解带周期性边界条件的离散静电泊松方程，\n$$-\\frac{\\phi_{i+1}^{n}-2\\phi_{i}^{n}+\\phi_{i-1}^{n}}{\\Delta x^{2}}=\\frac{\\rho_{i}^{n}}{\\varepsilon_{0}},$$\n以求得静电势 $\\phi_{i}^{n}$，同时施加规范条件 $\\sum_{i=0}^{N_{g}-1}\\phi_{i}^{n}=0$。然后通过中心差分计算节点上的电场，\n$$E_{i}^{n}=-\\frac{\\phi_{i+1}^{n}-\\phi_{i-1}^{n}}{2\\,\\Delta x}。$$\n3. 使用相同的线性形函数将电场从节点内插到粒子位置，以获得每个电子的 $E(x_{p}^{n})$。\n4. 使用牛顿第二定律和显式蛙跳格式更新来推进电子速度，\n$$v_{p}^{n+1/2}=v_{p}^{n-1/2}+\\frac{q}{m_{e}}\\,E(x_{p}^{n})\\,\\Delta t。$$\n\n计算在单个显式 PIC 时间步后第一个电子的更新速度 $v_{1}^{n+1/2}$。以归一化单位表示你的最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "该问题要求执行一维静电粒子云网格（PIC）模拟的一个完整循环。该过程分为问题陈述中指定的四个不同步骤。物理和数值参数均以归一化单位给出。\n\n**参数与网格设置**\n- 区域长度：$L=1$。\n- 网格节点数：$N_g=4$。\n- 网格间距：$\\Delta x = L/N_g = 1/4 = 0.25$。\n- 网格节点位置：$x_i = i\\Delta x$，其中 $i \\in \\{0, 1, 2, 3\\}$。这给出 $x_0=0, x_1=0.25, x_2=0.5, x_3=0.75$。\n- 归一化的物理常数：电子质量 $m_e=1$，电子电荷大小 $e=1$，真空介电常数 $\\varepsilon_0=1$。\n- $t^n$ 时刻的粒子数据：\n    - 电子 1：电荷 $q=-1$，位置 $x_1^n = 0.125$。\n    - 电子 2：电荷 $q=-1$，位置 $x_2^n = 0.375$。\n- $t^{n-1/2}$ 时刻的初始速度：$v_1^{n-1/2}=0$ 和 $v_2^{n-1/2}=0$。\n- 背景离子电荷密度：$\\rho_{\\mathrm{ion}}=+2$。\n- 时间步长：$\\Delta t=0.1$。\n\n**步骤 1：电荷分配**\n\n我们使用云中单元法（CIC）将电子电荷分配到网格上。线性形函数为 $S(x-x_i) = \\max \\left(0, 1 - \\frac{|x-x_i|}{\\Delta x}\\right)$。来自粒子 $p$ 对节点 $i$ 的电荷密度为 $\\rho_{p,i} = q_p S(x_p^n-x_i) / \\Delta x$。\n\n对于位于 $x_1^n=0.125$ 的粒子 1：\n该粒子位于节点 $x_0=0$ 和 $x_1=0.25$ 之间。其到两个节点的距离均为 $0.125$。\n内插权重为：\n$w_{1,0} = S(x_1^n-x_0) = 1 - \\frac{|0.125-0|}{0.25} = 1 - 0.5 = 0.5$。\n$w_{1,1} = S(x_1^n-x_1) = 1 - \\frac{|0.125-0.25|}{0.25} = 1 - 0.5 = 0.5$。\n对于节点 $x_2$ 和 $x_3$ 的权重为 $0$。\n粒子 1 的电荷密度贡献为：\n$\\rho_{1,0} = \\frac{q w_{1,0}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n$\\rho_{1,1} = \\frac{q w_{1,1}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n\n对于位于 $x_2^n=0.375$ 的粒子 2：\n该粒子位于节点 $x_1=0.25$ 和 $x_2=0.5$ 之间。其到两个节点的距离均为 $0.125$。\n内插权重为：\n$w_{2,1} = S(x_2^n-x_1) = 1 - \\frac{|0.375-0.25|}{0.25} = 1 - 0.5 = 0.5$。\n$w_{2,2} = S(x_2^n-x_2) = 1 - \\frac{|0.375-0.5|}{0.25} = 1 - 0.5 = 0.5$。\n对于节点 $x_0$ 和 $x_3$ 的权重为 $0$。\n粒子 2 的电荷密度贡献为：\n$\\rho_{2,1} = \\frac{q w_{2,1}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n$\\rho_{2,2} = \\frac{q w_{2,2}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n\n网格上的总电子电荷密度 $\\rho_{e,i}$ 是两个粒子贡献之和：\n$\\rho_{e,0} = \\rho_{1,0} + \\rho_{2,0} = -2 + 0 = -2$。\n$\\rho_{e,1} = \\rho_{1,1} + \\rho_{2,1} = -2 + (-2) = -4$。\n$\\rho_{e,2} = \\rho_{1,2} + \\rho_{2,2} = 0 + (-2) = -2$。\n$\\rho_{e,3} = \\rho_{1,3} + \\rho_{2,3} = 0 + 0 = 0$。\n\n总电荷密度 $\\rho_i^n$ 是电子密度与均匀背景离子密度 $\\rho_{\\mathrm{ion}}=+2$ 之和：\n$\\rho_0^n = \\rho_{e,0} + \\rho_{\\mathrm{ion}} = -2 + 2 = 0$。\n$\\rho_1^n = \\rho_{e,1} + \\rho_{\\mathrm{ion}} = -4 + 2 = -2$。\n$\\rho_2^n = \\rho_{e,2} + \\rho_{\\mathrm{ion}} = -2 + 2 = 0$。\n$\\rho_3^n = \\rho_{e,3} + \\rho_{\\mathrm{ion}} = 0 + 2 = 2$。\n总电荷密度向量为 $\\vec{\\rho}^n = (0, -2, 0, 2)$。\n\n**步骤 2：场求解**\n\n我们求解带周期性边界条件的离散泊松方程：$-\\frac{\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n}{\\Delta x^2} = \\frac{\\rho_i^n}{\\varepsilon_0}$。当 $\\varepsilon_0=1$ 且 $\\Delta x=0.25$ 时，这成为一个关于电势 $\\phi_i^n$ 的线性方程组：\n$$2\\phi_i^n - \\phi_{i+1}^n - \\phi_{i-1}^n = \\Delta x^2 \\rho_i^n = (0.25)^2 \\rho_i^n = 0.0625 \\rho_i^n$$\n索引以 $N_g=4$ 为模。该方程组为：\n$i=0: 2\\phi_0 - \\phi_1 - \\phi_3 = 0.0625 \\times 0 = 0$。\n$i=1: 2\\phi_1 - \\phi_2 - \\phi_0 = 0.0625 \\times (-2) = -0.125$。\n$i=2: 2\\phi_2 - \\phi_3 - \\phi_1 = 0.0625 \\times 0 = 0$。\n$i=3: 2\\phi_3 - \\phi_0 - \\phi_2 = 0.0625 \\times 2 = 0.125$。\n\n由第一个和第三个方程，我们推断 $2\\phi_0 = \\phi_1 + \\phi_3$ 和 $2\\phi_2 = \\phi_1 + \\phi_3$，这意味着 $\\phi_0 = \\phi_2$。\n将 $\\phi_2 = \\phi_0$ 代入第二个和第四个方程，得到：\n$2\\phi_1 - 2\\phi_0 = -0.125 \\implies \\phi_1 - \\phi_0 = -0.0625$。\n$2\\phi_3 - 2\\phi_0 = 0.125 \\implies \\phi_3 - \\phi_0 = 0.0625$。\n我们可以用 $\\phi_0$ 表示 $\\phi_1$、$\\phi_2$ 和 $\\phi_3$：$\\phi_1 = \\phi_0 - 0.0625$，$\\phi_2 = \\phi_0$，$\\phi_3 = \\phi_0 + 0.0625$。\n使用规范条件 $\\sum_{i=0}^{3} \\phi_i^n = 0$：\n$\\phi_0 + (\\phi_0 - 0.0625) + \\phi_0 + (\\phi_0 + 0.0625) = 4\\phi_0 = 0$，这给出 $\\phi_0=0$。\n电势为：\n$\\phi_0^n = 0$。\n$\\phi_1^n = -0.0625$。\n$\\phi_2^n = 0$。\n$\\phi_3^n = 0.0625$。\n\n接下来，我们使用中心差分公式 $E_i^n = -\\frac{\\phi_{i+1}^n - \\phi_{i-1}^n}{2\\Delta x}$ 计算节点上的电场，其中 $2\\Delta x = 0.5$：\n$E_0^n = -\\frac{\\phi_1 - \\phi_3}{0.5} = -\\frac{-0.0625 - 0.0625}{0.5} = -\\frac{-0.125}{0.5} = 0.25$。\n$E_1^n = -\\frac{\\phi_2 - \\phi_0}{0.5} = -\\frac{0 - 0}{0.5} = 0$。\n$E_2^n = -\\frac{\\phi_3 - \\phi_1}{0.5} = -\\frac{0.0625 - (-0.0625)}{0.5} = -\\frac{0.125}{0.5} = -0.25$。\n$E_3^n = -\\frac{\\phi_0 - \\phi_2}{0.5} = -\\frac{0 - 0}{0.5} = 0$。\n电场向量为 $\\vec{E}^n = (0.25, 0, -0.25, 0)$。\n\n**步骤 3：内插电场**\n\n我们使用相同的线性形函数（即与步骤 1 中相同的权重）将电场内插到粒子 1 的位置 $x_1^n=0.125$：\n$E(x_1^n) = \\sum_{i=0}^{3} E_i^n S(x_1^n - x_i) = E_0^n w_{1,0} + E_1^n w_{1,1}$。\n$E(x_1^n) = (0.25 \\times 0.5) + (0 \\times 0.5) = 0.125$。\n\n**步骤 4：推进电子速度**\n\n最后，我们使用显式蛙跳格式更新粒子 1 的速度：\n$v_p^{n+1/2} = v_p^{n-1/2} + \\frac{q}{m_e} E(x_p^n) \\Delta t$。\n对于粒子 1，我们有 $v_1^{n-1/2}=0$, $q=-1$, $m_e=1$, $E(x_1^n)=0.125$, 以及 $\\Delta t=0.1$。\n$v_1^{n+1/2} = 0 + \\frac{-1}{1} \\times 0.125 \\times 0.1$。\n$v_1^{n+1/2} = -0.0125$。\n\n题目要求结果四舍五入到四位有效数字。计算值恰好是 $-0.0125$。为了用四位有效数字表示，我们在末尾添加一个零。\n$v_1^{n+1/2} \\approx -0.01250$。",
            "answer": "$$\\boxed{-0.01250}$$"
        },
        {
            "introduction": "显式方法虽然直观，但其稳定性受到严格的时间步长限制，这在多尺度问题中尤其具有挑战性。本练习将探讨这些限制的物理来源，引导您推导出决定显式PIC模拟成败的两个关键判据：电磁波的CFL条件和等离子体振荡的稳定性条件。理解这些约束是高效设计和运行显式模拟的前提。",
            "id": "3977923",
            "problem": "一个磁约束聚变等离子体通过一个耦合的显式时域有限差分(FDTD)电磁求解器和一个在均匀三维Yee网格上的蛙跳格式粒子模拟(PIC)粒子推进器进行建模。电磁场更新在介电常数为 $\\varepsilon_0$ 且磁导率为 $\\mu_0$ 的真空区域中执行，粒子推进使用冷等离子体电子运动方程。计算域具有均匀的网格间距 $\\Delta x = \\Delta y = \\Delta z = 2 \\,\\text{mm}$。光速为 $c = 3 \\times 10^{8} \\,\\text{m/s}$，等离子体的特征电子等离子体角频率为 $\\omega_p = 5 \\times 10^{10} \\,\\text{s}^{-1}$。\n\n仅从以下基本定律和核心定义出发\n- 真空中的麦克斯韦方程组：$\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$ 和 $\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}$，其中 $\\mathbf{D} = \\varepsilon_0 \\mathbf{E}$，$\\mathbf{B} = \\mu_0 \\mathbf{H}$，以及 $c = \\frac{1}{\\sqrt{\\varepsilon_0 \\mu_0}}$，\n- 冷等离子体电子运动方程 $m_e \\frac{d \\mathbf{v}}{d t} = - e \\mathbf{E}$ 和电子等离子体角频率的定义 $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$，\n\n推导以下两项的显式时间积分稳定性约束：\n1. 在给定网格上对电磁场进行的Yee FDTD更新，以及\n2. 以 $\\omega_p$ 为特征的等离子体电子振荡的蛙跳格式离散化，\n\n然后确定能够保证耦合的FDTD-PIC更新稳定性的单个最大稳定时间步长 $\\Delta t_{\\max}$。使用给定的数值，以秒为单位表示你的最终答案，并将其四舍五入到三位有效数字。",
            "solution": "该问题要求为一个耦合的粒子模拟(PIC)和时域有限差分(FDTD)仿真推导两个独立的稳定性约束，并随后计算出最严格的最大稳定时间步长 $\\Delta t_{\\max}$。这两个约束分别来自电磁场更新(FDTD)和等离子体粒子动力学(PIC蛙跳格式推进器)。\n\n首先，我们推导在均匀三维Yee网格上对真空中麦克斯韦方程组进行FDTD更新的稳定性约束。控制方程是麦克斯韦旋度方程：\n$$\n\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n使用真空中的本构关系 $\\mathbf{D} = \\varepsilon_0 \\mathbf{E}$ 和 $\\mathbf{B} = \\mu_0 \\mathbf{H}$，方程变为：\n$$\n\\nabla \\times \\mathbf{E} = - \\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\n$$\n为得到波动方程，我们对第一个方程取旋度，并使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$。\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = - \\mu_0 \\frac{\\partial}{\\partial t} (\\nabla \\times \\mathbf{H})\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E} = - \\mu_0 \\frac{\\partial}{\\partial t} \\left(\\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\\right)\n$$\n在无源的真空区域中，高斯定律给出 $\\nabla \\cdot \\mathbf{E} = 0$。使用真空中光速的定义 $c = \\frac{1}{\\sqrt{\\varepsilon_0 \\mu_0}}$，该方程简化为齐次矢量波动方程：\n$$\n\\nabla^2 \\mathbf{E} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = 0\n$$\n显式FDTD方法对此方程的稳定性由Courant-Friedrichs-Lewy (CFL)条件决定。对于一个网格间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的均匀三维网格，CFL条件要求数值依赖域必须包含物理依赖域。对于Yee网格上的标准蛙跳格式FDTD方案，此条件为：\n$$\nc \\Delta t \\leq \\frac{1}{\\sqrt{\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} + \\frac{1}{(\\Delta z)^2}}}\n$$\n问题指定了一个均匀网格，其中 $\\Delta x = \\Delta y = \\Delta z = \\Delta s$。将此代入不等式，得到：\n$$\nc \\Delta t \\leq \\frac{1}{\\sqrt{\\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta s)^2}}} = \\frac{1}{\\sqrt{\\frac{3}{(\\Delta s)^2}}} = \\frac{\\Delta s}{\\sqrt{3}}\n$$\n这给出了对时间步长的第一个稳定性约束 $\\Delta t_{\\text{CFL}}$：\n$$\n\\Delta t \\leq \\Delta t_{\\text{CFL}} = \\frac{\\Delta s}{c \\sqrt{3}}\n$$\n\n其次，我们推导对等离子体电子振荡进行蛙跳积分的稳定性约束。其动力学由冷等离子体电子运动方程和电流密度定义 $\\mathbf{J} = -n_0 e \\mathbf{v}$ 描述，其中 $n_0$ 是平衡电子密度，$-e$ 是电子电荷，$\\mathbf{v}$ 是电子流体速度。\n运动方程由下式给出：\n$$\nm_e \\frac{d \\mathbf{v}}{d t} = - e \\mathbf{E}\n$$\n对电流密度定义求时间导数：\n$$\n\\frac{d \\mathbf{J}}{d t} = -n_0 e \\frac{d \\mathbf{v}}{d t}\n$$\n将运动方程代入此表达式，得到：\n$$\n\\frac{d \\mathbf{J}}{d t} = -n_0 e \\left( -\\frac{e}{m_e} \\mathbf{E} \\right) = \\frac{n_0 e^2}{m_e} \\mathbf{E}\n$$\n我们使用给定的电子等离子体角频率定义 $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$，将系数重写为 $\\frac{n_0 e^2}{m_e} = \\varepsilon_0 \\omega_p^2$。因此：\n$$\n\\frac{d \\mathbf{J}}{d t} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}\n$$\n为了找到特征振荡，我们考虑高频静电极限，此时磁场可以忽略。安培定律 $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$，在没有空间变化的情况下（即，对于长波模式，$\\nabla \\times \\mathbf{H} \\approx 0$），简化为 $\\mathbf{J} + \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} \\approx 0$。这得到 $\\frac{\\partial \\mathbf{E}}{\\partial t} \\approx -\\frac{1}{\\varepsilon_0}\\mathbf{J}$。\n对 $\\frac{d \\mathbf{J}}{d t} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}$ 求时间导数，得到：\n$$\n\\frac{d^2 \\mathbf{J}}{d t^2} = \\varepsilon_0 \\omega_p^2 \\frac{d \\mathbf{E}}{d t}\n$$\n代入 $\\frac{d \\mathbf{E}}{d t} \\approx -\\frac{1}{\\varepsilon_0}\\mathbf{J}$，我们得到等离子体电流的简谐振子方程：\n$$\n\\frac{d^2 \\mathbf{J}}{d t^2} = \\varepsilon_0 \\omega_p^2 \\left( -\\frac{1}{\\varepsilon_0} \\mathbf{J} \\right) = -\\omega_p^2 \\mathbf{J} \\quad \\implies \\quad \\frac{d^2 \\mathbf{J}}{d t^2} + \\omega_p^2 \\mathbf{J} = 0\n$$\n这个方程描述了在等离子体频率 $\\omega_p$ 下的振荡。为了使蛙跳格式在对形如 $\\ddot{x} + \\omega^2 x = 0$ 的振荡器方程进行积分时保持数值稳定，时间步长 $\\Delta t$ 必须能解析该振荡。标准蛙跳积分器的稳定性极限是：\n$$\n\\omega \\Delta t \\le 2\n$$\n将此应用于最高频率为 $\\omega_p$ 的等离子体振荡，我们得到第二个稳定性约束 $\\Delta t_{\\text{plasma}}$：\n$$\n\\Delta t \\le \\Delta t_{\\text{plasma}} = \\frac{2}{\\omega_p}\n$$\n注意，为了保证精度，通常会使用一个更严格的条件（例如 $\\omega_p \\Delta t \\lesssim 0.2$），但问题问的是基本稳定性约束。\n\n最后，为了使耦合的FDTD-PIC仿真稳定，单个时间步长 $\\Delta t$ 必须同时满足这两个约束。因此，最大稳定时间步长 $\\Delta t_{\\max}$ 是这两个独立极限中的较小者：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{CFL}}, \\Delta t_{\\text{plasma}}) = \\min\\left(\\frac{\\Delta s}{c \\sqrt{3}}, \\frac{2}{\\omega_p}\\right)\n$$\n现在我们代入给定的数值：\n$\\Delta s = 2 \\,\\text{mm} = 2 \\times 10^{-3} \\,\\text{m}$\n$c = 3 \\times 10^{8} \\,\\text{m/s}$\n$\\omega_p = 5 \\times 10^{10} \\,\\text{s}^{-1}$\n\n计算 $\\Delta t_{\\text{CFL}}$：\n$$\n\\Delta t_{\\text{CFL}} = \\frac{2 \\times 10^{-3} \\,\\text{m}}{(3 \\times 10^{8} \\,\\text{m/s}) \\sqrt{3}} = \\frac{2}{3 \\sqrt{3}} \\times 10^{-11} \\,\\text{s} \\approx 0.38490 \\times 10^{-11} \\,\\text{s} = 3.8490 \\times 10^{-12} \\,\\text{s}\n$$\n计算 $\\Delta t_{\\text{plasma}}$：\n$$\n\\Delta t_{\\text{plasma}} = \\frac{2}{5 \\times 10^{10} \\,\\text{s}^{-1}} = 0.4 \\times 10^{-10} \\,\\text{s} = 4 \\times 10^{-11} \\,\\text{s}\n$$\n比较这两个值：\n$3.8490 \\times 10^{-12} \\,\\text{s}  4 \\times 10^{-11} \\,\\text{s}$\n因此，CFL条件更具限制性。最大稳定时间步长由 $\\Delta t_{\\text{CFL}}$ 决定。\n$$\n\\Delta t_{\\max} = 3.8490 \\times 10^{-12} \\,\\text{s}\n$$\n按照要求将结果四舍五入到三位有效数字，我们得到：\n$$\n\\Delta t_{\\max} \\approx 3.85 \\times 10^{-12} \\,\\text{s}\n$$",
            "answer": "$$\\boxed{3.85 \\times 10^{-12}}$$"
        },
        {
            "introduction": "隐式方法通过求解耦合的非线性方程组，克服了显式方法中的稳定性限制，从而允许使用更大的时间步长。本练习揭示了隐式求解的核心机制，要求您为一个完全隐式的相对论性系统构建牛顿迭代法的关键部分——残差及其导数。这展示了隐式格式强大稳定性的背后所需的计算框架。",
            "id": "3977534",
            "problem": "考虑一个体积为 $V$、空间均匀的一维等离子体板，该等离子体板使用粒子模拟（PIC）方法进行建模，其中粒子模拟（PIC）方法是指用有限数量的加权宏粒子来表示连续的带电粒子。假设只有一种粒子，其电荷为 $q$，质量为 $m$，宏粒子由 $p=1,\\dots,N$ 索引，权重为 $w_p$。电场 $E(t)$ 在空间上是均匀的，并沿板方向，磁场被忽略，因此 $B(t)=0$。电流密度定义为 $J(t)=\\dfrac{q}{V}\\sum_{p=1}^{N} w_p\\, v_p(t)$，其中 $v_p(t)$ 是宏粒子 $p$ 的速度。\n\n从真空中的麦克斯韦-安培定律和相对论性粒子动量方程出发。使用从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的时间步长 $\\Delta t$，并对场方程和粒子方程应用后向欧拉法，通过消去粒子动量，形成一个关于未知数 $E^{n+1}$ 的非线性方程。具体来说：\n\n- 从真空中的麦克斯韦-安培定律开始，并利用空间均匀性将电场时间导数与电流密度联系起来。\n- 对每个宏粒子使用相对论性动量方程，其中动量为 $p_p(t)=\\gamma_p(t)\\, m\\, v_p(t)$，洛伦兹因子为 $\\gamma_p(t)=\\sqrt{1+\\left(\\dfrac{p_p(t)}{m c}\\right)^2}$，并使用后向欧拉法对其进行隐式离散化。\n- 将新时刻的电流密度 $J^{n+1}$ 表示为宏粒子速度的函数，进而通过隐式粒子推进表示为 $E^{n+1}$ 的函数。\n\n为带有隐式粒子耦合的离散麦克斯韦-安培关系定义一个标量残差 $R(E^{n+1})$。推导牛顿法所需的 $R(E^{n+1})$ 及其关于 $E^{n+1}$ 的导数，并通过给出牛顿增量 $\\Delta E_k$ 关于 $E_k$、已知数据 $E^n$、$\\Delta t$、$q$、$m$、$c$、$\\varepsilon_0$、$V$、$N$、$w_p$ 和 $p_p^n$ 的闭式解析表达式来建立牛顿迭代 $E_{k+1}=E_k+\\Delta E_k$。\n\n你的最终答案必须是牛顿增量 $\\Delta E_k$ 的单个解析表达式。如果进行数值计算，$\\Delta E_k$ 的国际单位制单位应为伏特/米，但不要在最终的方框答案中包含单位。",
            "solution": "该问题要求为全隐式、相对论性、静电粒子模拟（PIC）方程的迭代解推导牛顿增量 $\\Delta E_k$。推导过程首先为前推时间步的电场 $E^{n+1}$ 建立离散的非线性残差方程，然后对其进行线性化以求得牛顿-拉夫逊更新。\n\n首先，我们陈述控制连续方程。\n真空中的麦克斯韦-安培定律由 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$ 给出。问题指定了一个磁场为零的均匀系统，即 $\\mathbf{B}(t)=0$。在这些条件下，磁场的旋度为零，方程简化为代表电荷守恒的一维形式：\n$$\n\\varepsilon_0 \\frac{dE(t)}{dt} + J(t) = 0\n$$\n此处，$E(t)$ 是空间均匀的电场，$J(t)$ 是电流密度，$\\varepsilon_0$ 是真空介电常数。\n\n第二个控制方程是每个宏粒子 $p$ 的相对论性洛伦兹力定律。在没有磁场的情况下，粒子动量 $p_p(t)$ 的方程为：\n$$\n\\frac{dp_p(t)}{dt} = q E(t)\n$$\n其中 $q$ 是粒子电荷。\n\n我们使用后向欧拉法将这两个常微分方程在从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的时间段内进行离散化。对于场方程，这得到：\n$$\n\\varepsilon_0 \\frac{E^{n+1} - E^n}{\\Delta t} + J^{n+1} = 0\n$$\n其中 $E^n$ 和 $E^{n+1}$ 分别是 $t^n$ 和 $t^{n+1}$ 时刻的电场，$J^{n+1}$ 是 $t^{n+1}$ 时刻的电流密度。\n\n对于粒子动量方程，后向欧拉离散化为：\n$$\n\\frac{p_p^{n+1} - p_p^n}{\\Delta t} = q E^{n+1}\n$$\n这使我们能够将每个粒子 $p$ 在 $t^{n+1}$ 时刻的动量表示为未知的未来电场 $E^{n+1}$ 和 $t^n$ 时刻的已知量的函数：\n$$\np_p^{n+1} = p_p^n + q \\Delta t E^{n+1}\n$$\n电流密度 $J^{n+1}$ 根据 $t^{n+1}$ 时刻的粒子速度定义：\n$$\nJ^{n+1} = \\frac{q}{V} \\sum_{p=1}^{N} w_p v_p^{n+1}\n$$\n其中 $V$ 是体积，$w_p$ 是宏粒子权重，$N$ 是宏粒子的数量。相对论性速度 $v_p^{n+1}$ 通过 $v_p^{n+1} = \\frac{p_p^{n+1}}{m \\gamma_p^{n+1}}$ 与动量 $p_p^{n+1}$ 相关，其中 $m$ 是粒子质量，$\\gamma_p^{n+1}$ 是 $t^{n+1}$ 时刻的洛伦兹因子。洛伦兹因子由 $\\gamma_p^{n+1} = \\sqrt{1 + \\left(\\frac{p_p^{n+1}}{mc}\\right)^2}$ 给出，其中 $c$ 是光速。\n\n将 $p_p^{n+1}$ 的表达式代入速度关系式，我们将粒子动力学与电场 $E^{n+1}$ 耦合起来：\n$$\nv_p^{n+1} = \\frac{p_p^n + q \\Delta t E^{n+1}}{m \\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E^{n+1}}{mc}\\right)^2}}\n$$\n将这个速度以及随后的电流密度 $J^{n+1}$ 代回到离散化的麦克斯韦-安培方程中，得到一个关于未知数 $E^{n+1}$ 的单一非线性方程。我们将残差函数 $R(E^{n+1})$ 定义为该方程的左侧：\n$$\nR(E^{n+1}) = \\varepsilon_0 \\frac{E^{n+1} - E^n}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{p_p^n + q \\Delta t E^{n+1}}{m \\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E^{n+1}}{mc}\\right)^2}} = 0\n$$\n这就是我们必须求解 $E^{n+1}$ 的非线性方程。牛顿法是寻找 $R$ 的根的一种迭代过程。从一个初始猜测 $E_0$（例如 $E_0 = E^n$）开始，该方法使用以下迭代生成一系列改进的猜测 $E_k$：\n$$\nE_{k+1} = E_k + \\Delta E_k\n$$\n其中增量 $\\Delta E_k$ 由下式给出：\n$$\n\\Delta E_k = - \\frac{R(E_k)}{R'(E_k)}\n$$\n而 $R'(E_k)$ 是 $R$ 对其自变量的导数，在 $E_k$ 处求值。\n\n我们现在必须计算导数 $R'(E^{n+1}) = \\frac{dR}{dE^{n+1}}$。\n$$\nR'(E^{n+1}) = \\frac{d}{dE^{n+1}} \\left( \\varepsilon_0 \\frac{E^{n+1} - E^n}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p v_p^{n+1} \\right)\n$$\n$$\nR'(E^{n+1}) = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{dv_p^{n+1}}{dE^{n+1}}\n$$\n为了求得 $\\frac{dv_p^{n+1}}{dE^{n+1}}$，我们使用链式法则：$\\frac{dv_p^{n+1}}{dE^{n+1}} = \\frac{dv_p^{n+1}}{dp_p^{n+1}} \\frac{dp_p^{n+1}}{dE^{n+1}}$。\n由 $p_p^{n+1} = p_p^n + q \\Delta t E^{n+1}$ 可得 $\\frac{dp_p^{n+1}}{dE^{n+1}} = q \\Delta t$。\n速度对动量的导数是狭义相对论中的一个标准结果：\n$$\n\\frac{dv_p}{dp_p} = \\frac{d}{dp_p} \\left( \\frac{p_p c}{\\sqrt{m^2c^2 + p_p^2}} \\right) = \\frac{c}{\\sqrt{m^2c^2 + p_p^2}} - \\frac{p_p c \\cdot p_p}{(m^2c^2 + p_p^2)^{3/2}} = \\frac{c(m^2c^2 + p_p^2) - c p_p^2}{(m^2c^2 + p_p^2)^{3/2}} = \\frac{m^2c^3}{(m^2c^2 + p_p^2)^{3/2}}\n$$\n注意到 $\\gamma_p = \\frac{\\sqrt{m^2c^2 + p_p^2}}{mc}$，分母为 $(mc\\gamma_p)^3$。因此，\n$$\n\\frac{dv_p}{dp_p} = \\frac{m^2c^3}{m^3c^3\\gamma_p^3} = \\frac{1}{m\\gamma_p^3}\n$$\n将此应用于我们在 $t^{n+1}$ 时刻的情况：$\\frac{dv_p^{n+1}}{dp_p^{n+1}} = \\frac{1}{m(\\gamma_p^{n+1})^3}$。\n合并各部分，$\\frac{dv_p^{n+1}}{dE^{n+1}} = \\frac{q \\Delta t}{m(\\gamma_p^{n+1})^3}$。\n\n将此代回到 $R'(E^{n+1})$ 的表达式中：\n$$\nR'(E^{n+1}) = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{q \\Delta t}{m(\\gamma_p^{n+1})^3} = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{(\\gamma_p^{n+1})^3}\n$$\n现在我们来组装牛顿增量 $\\Delta E_k$。我们在当前对 $E^{n+1}$ 的猜测值 $E_k$ 处计算 $R$ 和 $R'$。令 $p_{p,k}^{n+1} = p_p^n + q \\Delta t E_k$ 且 $\\gamma_{p,k}^{n+1} = \\sqrt{1 + \\left(\\frac{p_{p,k}^{n+1}}{mc}\\right)^2}$。\n在 $E_k$ 处求值的残差为：\n$$\nR(E_k) = \\varepsilon_0 \\frac{E_k - E^n}{\\Delta t} + \\frac{q}{V} \\sum_{p=1}^{N} w_p \\frac{p_{p,k}^{n+1}}{m \\gamma_{p,k}^{n+1}}\n$$\n在 $E_k$ 处求值的导数为：\n$$\nR'(E_k) = \\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{(\\gamma_{p,k}^{n+1})^3}\n$$\n牛顿增量为 $\\Delta E_k = -R(E_k)/R'(E_k)$。代入这些表达式并明确写出 $p_{p,k}^{n+1}$，得到最终表达式：\n$$\n\\Delta E_k = - \\frac{\\varepsilon_0 \\frac{E_k - E^n}{\\Delta t} + \\frac{q}{mV} \\sum_{p=1}^{N} w_p \\frac{p_p^n + q \\Delta t E_k}{\\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2}}}{\\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{\\left(1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2\\right)^{3/2}}}\n$$\n这就是所要求的牛顿增量的闭式解析表达式。",
            "answer": "$$\n\\boxed{- \\frac{\\varepsilon_0 \\frac{E_k - E^n}{\\Delta t} + \\frac{q}{mV} \\sum_{p=1}^{N} w_p \\frac{p_p^n + q \\Delta t E_k}{\\sqrt{1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2}}}{\\frac{\\varepsilon_0}{\\Delta t} + \\frac{q^2 \\Delta t}{mV} \\sum_{p=1}^{N} \\frac{w_p}{\\left(1 + \\left(\\frac{p_p^n + q \\Delta t E_k}{mc}\\right)^2\\right)^{3/2}}}}\n$$"
        }
    ]
}