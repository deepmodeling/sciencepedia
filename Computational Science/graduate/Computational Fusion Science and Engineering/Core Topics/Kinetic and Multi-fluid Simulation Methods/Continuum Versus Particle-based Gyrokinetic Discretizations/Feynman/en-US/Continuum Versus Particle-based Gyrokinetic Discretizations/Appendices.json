{
    "hands_on_practices": [
        {
            "introduction": "Before comparing different numerical methods, it is crucial to understand the physical approximation they are built upon. Gyrokinetic theory relies on the fundamental assumption that the particle gyroradius is much smaller than the characteristic scales of the background plasma. This practice  guides you through a foundational calculation to quantify this scale separation, defined by the ordering parameter $\\epsilon \\equiv \\rho_i/L$, for a typical fusion plasma, demonstrating why the gyrokinetic model is a valid and powerful tool for studying plasma turbulence.",
            "id": "3959024",
            "problem": "A central requirement for the fidelity of gyrokinetic modeling in magnetized fusion plasmas is the smallness of a dimensionless ordering parameter that measures the ratio of gyroradius to macroscopic system scale. Consider deuterium ions in a tokamak with magnetic field magnitude $B=3\\,\\mathrm{T}$, ion temperature $T_i=2\\,\\mathrm{keV}$, major radius $R=1.7\\,\\mathrm{m}$, and characteristic perpendicular fluctuation scale characterized by $k_{\\perp}\\rho_i\\sim 0.3$. Using only fundamental definitions, derive the ion thermal speed $v_{th,i}$, the ion cyclotron frequency $\\Omega_i$, and the thermal ion gyroradius $\\rho_i$, and then evaluate them numerically for deuterium ions. Use $Z=1$, $m_i=2m_p$, with the proton mass $m_p=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$ and the elementary charge $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$. Treat $T_i$ as an energy per ion and convert $\\mathrm{keV}$ to Joules via $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$. Adopt the definitions $v_{th,i}\\equiv\\sqrt{2T_i/m_i}$, $\\Omega_i\\equiv ZeB/m_i$, and $\\rho_i\\equiv v_{th,i}/\\Omega_i$. Then, using $L=R$ as the macroscopic scale, form the gyrokinetic ordering parameter $\\epsilon\\equiv \\rho_i/L$ and evaluate it. Briefly justify, based on first principles, why the resulting magnitude of $\\epsilon$ supports the validity of the gyrokinetic approximation for both continuum and Particle-In-Cell (PIC) discretizations when $k_{\\perp}\\rho_i\\sim 0.3$. \n\nReport only the final numerical value of $\\epsilon$ as a dimensionless number, rounded to three significant figures.",
            "solution": "The problem statement has been evaluated and is determined to be scientifically grounded, well-posed, and objective. It presents a standard calculation in plasma physics relevant to the gyrokinetic modeling of fusion devices. All necessary data and definitions are provided and are consistent with established principles. Therefore, a complete solution is warranted.\n\nThe problem requires the calculation of the gyrokinetic ordering parameter $\\epsilon$ for a deuterium plasma in a tokamak. We are given the following parameters:\nMagnetic field magnitude: $B=3\\,\\mathrm{T}$\nIon temperature: $T_i=2\\,\\mathrm{keV}$\nMajor radius: $R=1.7\\,\\mathrm{m}$\nCharacteristic perpendicular fluctuation scale: $k_{\\perp}\\rho_i\\sim 0.3$\nIon charge state: $Z=1$\nIon mass (deuterium): $m_i=2m_p$\nProton mass: $m_p=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$\nElementary charge: $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n\nThe problem provides the following definitions:\nIon thermal speed: $v_{th,i}\\equiv\\sqrt{2T_i/m_i}$\nIon cyclotron frequency: $\\Omega_i\\equiv ZeB/m_i$\nThermal ion gyroradius: $\\rho_i\\equiv v_{th,i}/\\Omega_i$\nGyrokinetic ordering parameter: $\\epsilon\\equiv \\rho_i/L$, with the macroscopic scale length $L=R$.\n\nFirst, we must express all quantities in base SI units. The ion temperature $T_i$ is given in kilo-electron-volts ($\\mathrm{keV}$) and must be converted to Joules ($\\mathrm{J}$). Using the provided conversion $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$, where $e$ is the elementary charge in Coulombs, we have:\n$$T_i = 2\\,\\mathrm{keV} = 2 \\times 10^3\\,\\mathrm{eV} = (2 \\times 10^3) \\times (1.602176634\\times 10^{-19}) \\,\\mathrm{J}$$\n$$T_i = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}$$\n\nNext, we calculate the mass of a deuterium ion, $m_i$:\n$$m_i = 2m_p = 2 \\times (1.67262192369\\times 10^{-27}\\,\\mathrm{kg}) = 3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}$$\n\nWith $T_i$ and $m_i$ in SI units, we can now derive and evaluate $v_{th,i}$, $\\Omega_i$, and $\\rho_i$.\n\n1.  **Ion Thermal Speed ($v_{th,i}$)**\n    Using the definition $v_{th,i} = \\sqrt{2T_i/m_i}$:\n    $$v_{th,i} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx 4.37694 \\times 10^5\\,\\mathrm{m/s}$$\n\n2.  **Ion Cyclotron Frequency ($\\Omega_i$)**\n    Using the definition $\\Omega_i = ZeB/m_i$:\n    $$\\Omega_i = \\frac{1 \\times (1.602176634\\times 10^{-19}\\,\\mathrm{C}) \\times (3\\,\\mathrm{T})}{3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}} \\approx 1.43682 \\times 10^8\\,\\mathrm{rad/s}$$\n\n3.  **Thermal Ion Gyroradius ($\\rho_i$)**\n    Using the definition $\\rho_i = v_{th,i}/\\Omega_i$:\n    $$\\rho_i = \\frac{4.37694 \\times 10^5\\,\\mathrm{m/s}}{1.43682 \\times 10^8\\,\\mathrm{rad/s}} \\approx 3.0462 \\times 10^{-3}\\,\\mathrm{m}$$\n    Alternatively, we can express $\\rho_i$ directly in terms of the fundamental parameters:\n    $$\\rho_i = \\frac{v_{th,i}}{\\Omega_i} = \\frac{\\sqrt{2T_i/m_i}}{ZeB/m_i} = \\frac{\\sqrt{2T_im_i}}{ZeB}$$\n    Plugging in the values confirms the result:\n    $$\\rho_i = \\frac{\\sqrt{2 \\times (3.20435... \\times 10^{-16}\\,\\mathrm{J}) \\times (3.34524... \\times 10^{-27}\\,\\mathrm{kg})}}{1 \\times (1.60217... \\times 10^{-19}\\,\\mathrm{C}) \\times (3\\,\\mathrm{T})} \\approx 3.0462 \\times 10^{-3}\\,\\mathrm{m}$$\n\nNow, we calculate the gyrokinetic ordering parameter $\\epsilon$. The problem specifies using the major radius $R$ as the macroscopic scale length $L$.\n$$L = R = 1.7\\,\\mathrm{m}$$\nThe ordering parameter $\\epsilon$ is the ratio of the thermal ion gyroradius to this macroscopic scale length:\n$$\\epsilon = \\frac{\\rho_i}{L} = \\frac{3.0462 \\times 10^{-3}\\,\\mathrm{m}}{1.7\\,\\mathrm{m}} \\approx 1.79188 \\times 10^{-3}$$\n\nRounding to three significant figures, as requested, gives:\n$$\\epsilon \\approx 1.79 \\times 10^{-3}$$\n\nFinally, we justify why this result supports the validity of the gyrokinetic approximation.\nThe gyrokinetic model is a rigorous asymptotic limit of the fundamental Vlasov-Maxwell system of equations. Its derivation relies on a formal ordering scheme in which the gyroradius $\\rho_i$ is much smaller than the characteristic scale lengths $L$ of the macroscopic equilibrium plasma profiles (such as density, temperature, and magnetic field). The dimensionless parameter $\\epsilon \\equiv \\rho_i/L$ quantifies this scale separation. Our calculated value of $\\epsilon \\approx 1.79 \\times 10^{-3}$ is very small, satisfying the crucial condition $\\epsilon \\ll 1$. This large separation of scales validates the central procedure of gyrokinetics: averaging the particle motion over the fast gyromotion orbit. This procedure, known as gyro-averaging, is justified because background quantities are effectively constant over the spatial extent of a gyro-orbit, allowing the complex 6-dimensional particle dynamics in $(\\mathbf{x}, \\mathbf{v})$ phase space to be reduced to a more tractable 5-dimensional model in gyrocenter coordinates.\n\nThe problem also states that $k_{\\perp}\\rho_i \\sim 0.3$. This condition specifies that the perpendicular wavelength of the turbulence is comparable to the ion gyroradius. This is the regime of \"finite Larmor radius\" (FLR) effects, which are critical for describing micro-instabilities (like ion temperature gradient modes) that drive turbulent transport. The gyrokinetic model is specifically designed for this regime, where $\\rho_i/L \\ll 1$ but $k_{\\perp}\\rho_i \\sim \\mathcal{O}(1)$. Simpler models like ideal magnetohydrodynamics (MHD) or fluid theories often fail in this regime.\n\nThe validity of the underlying physical approximation, confirmed by $\\epsilon \\ll 1$, is a prerequisite for any numerical discretization method. Both continuum (Eulerian) and Particle-In-Cell (PIC, a Lagrangian approach) methods are numerical techniques designed to solve the *same set* of gyrokinetic equations. Therefore, the smallness of $\\epsilon$ underpins the fidelity of both discretization strategies, as it confirms that the equations they are designed to solve provide a valid physical description of the plasma dynamics in the specified regime.",
            "answer": "$$\\boxed{1.79 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Particle-In-Cell (PIC) methods, a cornerstone of the Lagrangian approach, discretize the plasma distribution function using a finite number of computational markers. This representation is powerful but introduces an inherent statistical uncertainty, or noise, which is a defining characteristic of the method. This exercise  challenges you to derive the statistical error in a PIC density estimate from first principles, providing direct insight into the fundamental trade-off between computational cost (the number of markers, $N$) and accuracy in particle-based simulations.",
            "id": "3959012",
            "problem": "Consider a uniform gyrocenter density field in a gyrokinetic plasma, with constant continuum density $n_0$ in a periodic domain of volume $V$ in three dimensions. In a Particle-In-Cell (PIC) discretization of the gyrokinetic density, $N$ independent markers are drawn from the uniform distribution over the domain. The PIC estimate of the density at a fixed spatial point $\\boldsymbol{x}$ is constructed using a compactly supported, symmetric shape function $S(\\boldsymbol{r})$ that is normalized such that $\\int_{\\mathbb{R}^3} S(\\boldsymbol{r})\\,\\mathrm{d}^3\\boldsymbol{r} = 1$ and has support volume $V_s$, meaning $S(\\boldsymbol{r}) = 0$ outside a region of volume $V_s$. Assume a top-hat shape function,\n$$\nS(\\boldsymbol{r}) = \\begin{cases}\n\\frac{1}{V_s}, & \\text{if } \\boldsymbol{r} \\in \\text{support region of volume } V_s, \\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nand that the support region translated to $\\boldsymbol{x}$ is fully contained within the periodic domain (ignore boundary overlap corrections).\n\nEach marker carries identical weight $w$ chosen so that the PIC estimator is unbiased, i.e., $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$, where\n$$\n\\tilde{n}(\\boldsymbol{x}) = \\sum_{i=1}^{N} w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right),\n$$\nand $\\boldsymbol{X}_i$ are the independent marker positions.\n\nStarting from first principles of independent sampling, unbiased estimation, and variance of sums of independent random variables, derive the analytic expression for the relative root-mean-square error of the PIC density estimator at the point $\\boldsymbol{x}$,\n$$\n\\epsilon_{\\mathrm{rel}}(\\boldsymbol{x}) \\equiv \\frac{\\sqrt{\\mathrm{Var}(\\tilde{n}(\\boldsymbol{x}))}}{n_0},\n$$\nas a function of $N$, $V$, and $V_s$. Your derivation should begin from the definitions given above, compute the required expectations explicitly, and should not assume any pre-known PIC variance formula. Provide your final answer as a single closed-form expression in terms of $N$, $V$, and $V_s$. No rounding is required. Because $\\epsilon_{\\mathrm{rel}}$ is dimensionless, do not include units in your final expression.",
            "solution": "We begin by formalizing the estimator and its statistical properties under the assumptions given. The domain is periodic with volume $V$, and the markers $\\{\\boldsymbol{X}_i\\}_{i=1}^{N}$ are independent and identically distributed with uniform probability density $p(\\boldsymbol{r}) = \\frac{1}{V}$ over the domain. The PIC estimator of the density at a fixed point $\\boldsymbol{x}$ is\n$$\n\\tilde{n}(\\boldsymbol{x}) = \\sum_{i=1}^{N} w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right).\n$$\nWe first choose the weight $w$ to ensure unbiasedness, $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$. Using linearity of expectation and independence,\n$$\n\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = \\sum_{i=1}^{N} w\\, \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right) \\right] = N w\\, \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right],\n$$\nwhere $\\boldsymbol{X}$ is a generic uniform random position in the domain. The expectation of $S$ under the uniform distribution is\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = \\int_{V} \\frac{1}{V} S\\!\\left(\\boldsymbol{x} - \\boldsymbol{r}\\right)\\, \\mathrm{d}^3\\boldsymbol{r}.\n$$\nUnder the assumption that the shape support region translated to $\\boldsymbol{x}$ lies entirely within the domain and using the normalization $\\int_{\\mathbb{R}^3} S(\\boldsymbol{r})\\,\\mathrm{d}^3\\boldsymbol{r} = 1$, we have\n$$\n\\int_{V} S\\!\\left(\\boldsymbol{x} - \\boldsymbol{r}\\right)\\, \\mathrm{d}^3\\boldsymbol{r} = 1,\n$$\nso\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = \\frac{1}{V}.\n$$\nUnbiasedness $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$ then gives\n$$\nN w \\left( \\frac{1}{V} \\right) = n_0 \\quad \\Rightarrow \\quad w = \\frac{n_0 V}{N}.\n$$\n\nNext, we compute the variance of the estimator. Because the markers are independent and identically distributed,\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = \\sum_{i=1}^{N} \\mathrm{Var}\\!\\left( w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right) \\right) = N w^2\\, \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right).\n$$\nTherefore,\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = N \\left( \\frac{n_0 V}{N} \\right)^2 \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right) = \\frac{n_0^2 V^2}{N} \\, \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right).\n$$\n\nWe now compute $\\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right)$ for the top-hat shape function. Define the indicator random variable $I$ that equals $1$ if $\\boldsymbol{X}$ lies within the support region of $S$ translated to $\\boldsymbol{x}$ and equals $0$ otherwise. The probability that $\\boldsymbol{X}$ lies in the support region is\n$$\np \\equiv \\mathbb{P}(I = 1) = \\frac{V_s}{V}.\n$$\nFor the top-hat shape,\n$$\nS\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) = \\begin{cases}\n\\frac{1}{V_s}, & I = 1, \\\\\n0, & I = 0.\n\\end{cases}\n$$\nHence $S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)$ is a Bernoulli-mixture random variable taking value $\\frac{1}{V_s}$ with probability $p$ and $0$ with probability $1 - p$. Its mean and second moment are\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = p \\cdot \\frac{1}{V_s} = \\frac{V_s}{V} \\cdot \\frac{1}{V_s} = \\frac{1}{V},\n$$\nconsistent with the earlier calculation, and\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)^2 \\right] = p \\cdot \\left( \\frac{1}{V_s} \\right)^2 = \\frac{V_s}{V} \\cdot \\frac{1}{V_s^2} = \\frac{1}{V V_s}.\n$$\nTherefore the variance is\n$$\n\\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right) = \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)^2 \\right] - \\left( \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] \\right)^2 = \\frac{1}{V V_s} - \\left( \\frac{1}{V} \\right)^2 = \\frac{V - V_s}{V^2 V_s}.\n$$\nSubstituting into the variance of the estimator gives\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = \\frac{n_0^2 V^2}{N} \\cdot \\left( \\frac{1}{V V_s} - \\frac{1}{V^2} \\right) = \\frac{n_0^2}{N} \\left( \\frac{V}{V_s} - 1 \\right).\n$$\nThe relative root-mean-square error is defined as\n$$\n\\epsilon_{\\mathrm{rel}}(\\boldsymbol{x}) \\equiv \\frac{\\sqrt{\\mathrm{Var}(\\tilde{n}(\\boldsymbol{x}))}}{n_0} = \\sqrt{ \\frac{1}{N} \\left( \\frac{V}{V_s} - 1 \\right) }.\n$$\n\nThis result encapsulates the continuum versus particle-based discretization contrast: the continuum density is exactly $n_0$, while the particle-based estimate exhibits sampling noise that scales as $N^{-1/2}$ and increases as the support volume $V_s$ shrinks (weaker smoothing), with a dependence on the ratio $\\frac{V}{V_s}$ arising from the probability that a given marker contributes to the estimate at $\\boldsymbol{x}$. The periodic domain assumption eliminates boundary corrections; for $V \\gg V_s$ the dominant scaling is $\\epsilon_{\\mathrm{rel}} \\sim \\sqrt{\\frac{V}{N V_s}}$.",
            "answer": "$$\\boxed{\\sqrt{\\frac{1}{N}\\left(\\frac{V}{V_s}-1\\right)}}$$"
        },
        {
            "introduction": "In contrast to the particle-based approach, continuum methods solve the gyrokinetic equation on a fixed grid in phase space, avoiding statistical noise entirely. However, these Eulerian schemes have their own fundamental constraints, particularly when using explicit time-stepping schemes. This practice  explores the ubiquitous Courant-Friedrichs-Lewy (CFL) condition, which limits the numerical time step to ensure stability, highlighting the critical interplay between grid resolution, physical velocities, and computational cost that governs continuum simulations.",
            "id": "3959038",
            "problem": "Consider an explicit finite-volume continuum solver for the collisionless gyrokinetic equation in a simplified four-dimensional phase space $(x,y,z,v_\\parallel)$ for a single ion species. The solver advances the distribution function $f(x,y,z,v_\\parallel,t)$ using a conservative upwind flux with forward Euler time integration and dimensional splitting. In the absence of sources and collisions, the governing equation can be written in linearized advective form\n$$\n\\frac{\\partial f}{\\partial t} + u_x \\frac{\\partial f}{\\partial x} + u_y \\frac{\\partial f}{\\partial y} + v_{\\parallel} \\frac{\\partial f}{\\partial z} + a_{\\parallel} \\frac{\\partial f}{\\partial v_{\\parallel}} = 0,\n$$\nwhere $u_x$ and $u_y$ are the maximum resolved perpendicular drift velocities (for example, electric cross magnetic drift and magnetic drift), $v_\\parallel$ is the maximum resolved parallel streaming speed, and $a_\\parallel$ is the maximum resolved parallel acceleration due to the parallel electric field. For explicit methods, the Courant–Friedrichs–Lewy (CFL) condition constrains the time step so that the numerical domain of dependence contains the physical domain of dependence for each characteristic direction.\n\nAssume a uniform grid with spacings $\\Delta x$, $\\Delta y$, $\\Delta z$, and $\\Delta v_\\parallel$ in each coordinate. The maximum resolved characteristic speeds (taken over the computational domain and time) are provided as\n$u_x^{\\max} = 1.8 \\times 10^{4} \\ \\mathrm{m/s}$, $u_y^{\\max} = 2.2 \\times 10^{3} \\ \\mathrm{m/s}$, $v_{\\parallel}^{\\max} = 7.0 \\times 10^{4} \\ \\mathrm{m/s}$, and $a_{\\parallel}^{\\max} = 3.0 \\times 10^{6} \\ \\mathrm{m/s^2}$. The grid spacings are $\\Delta x = 2.5 \\times 10^{-3} \\ \\mathrm{m}$, $\\Delta y = 1.5 \\times 10^{-3} \\ \\mathrm{m}$, $\\Delta z = 4.0 \\times 10^{-2} \\ \\mathrm{m}$, and $\\Delta v_{\\parallel} = 1.2 \\times 10^{4} \\ \\mathrm{m/s}$.\n\nStarting from the physical interpretation of characteristics and the requirement that during one time step, information travels no more than one cell length in any coordinate direction, derive the corresponding explicit time step constraint and compute the maximum stable CFL time step $\\Delta t_{\\mathrm{CFL}}$ for this solver, taking the most restrictive direction. Express your final answer in seconds and round your result to four significant figures.",
            "solution": "The problem presented is judged to be valid. It is scientifically grounded in the principles of computational fluid dynamics and plasma physics, specifically concerning the numerical stability of explicit advection schemes. The problem is well-posed, providing all necessary data and a clear objective. It is free from ambiguities, contradictions, and subjective claims. We may therefore proceed with a formal solution.\n\nThe problem asks for the maximum stable time step, $\\Delta t_{\\mathrm{CFL}}$, for an explicit finite-volume solver based on the Courant–Friedrichs–Lewy (CFL) condition. The solver is used for the collisionless gyrokinetic equation, which, in its linearized advective form for a four-dimensional phase space $(x, y, z, v_\\parallel)$, is given as:\n$$\n\\frac{\\partial f}{\\partial t} + u_x \\frac{\\partial f}{\\partial x} + u_y \\frac{\\partial f}{\\partial y} + v_{\\parallel} \\frac{\\partial f}{\\partial z} + a_{\\parallel} \\frac{\\partial f}{\\partial v_{\\parallel}} = 0\n$$\nHere, $f(x, y, z, v_\\parallel, t)$ is the distribution function. The coefficients $u_x$, $u_y$, $v_\\parallel$, and $a_\\parallel$ represent the advection velocities in the phase space coordinates $x$, $y$, $z$, and $v_\\parallel$, respectively. Note that $v_\\parallel$ is both a coordinate and the advection velocity in the $z$ direction, while $a_\\parallel$ is the advection velocity in the $v_\\parallel$ direction (i.e., acceleration).\n\nThe CFL condition for an explicit, first-order, one-dimensional advection scheme, $\\frac{\\partial f}{\\partial t} + c \\frac{\\partial f}{\\partial \\xi} = 0$, on a grid with spacing $\\Delta \\xi$, is given by the Courant number, $C \\le 1$. The Courant number is defined as $C = |c| \\frac{\\Delta t}{\\Delta \\xi}$. This condition ensures that the numerical domain of dependence of a grid point contains the physical domain of dependence. It means that during a single time step $\\Delta t$, information cannot travel more than one grid cell. The resulting constraint on the time step is:\n$$\n\\Delta t \\le \\frac{\\Delta \\xi}{|c|}\n$$\nThe problem specifies that the solver employs dimensional splitting. This means the advection in each of the four phase-space dimensions is treated independently. Consequently, the time step $\\Delta t$ must satisfy the CFL condition for each dimension simultaneously. For stability, the overall time step must be less than or equal to the minimum of the maximum allowed time steps for each dimension. We must use the maximum advection speed in each direction over the entire computational domain to ensure stability everywhere.\n\nLet us establish the individual time step constraint for each dimension:\n\n1.  For the $x$-direction, the advection velocity is $u_x$. The grid spacing is $\\Delta x$. The CFL constraint is:\n    $$\n    \\Delta t \\le \\frac{\\Delta x}{u_x^{\\max}}\n    $$\n2.  For the $y$-direction, the advection velocity is $u_y$. The grid spacing is $\\Delta y$. The CFL constraint is:\n    $$\n    \\Delta t \\le \\frac{\\Delta y}{u_y^{\\max}}\n    $$\n3.  For the $z$-direction, the advection velocity is the parallel velocity $v_\\parallel$. The grid spacing is $\\Delta z$. The CFL constraint is:\n    $$\n    \\Delta t \\le \\frac{\\Delta z}{v_{\\parallel}^{\\max}}\n    $$\n4.  For the $v_\\parallel$-direction, the advection \"velocity\" is the parallel acceleration $a_\\parallel$. The grid spacing is $\\Delta v_\\parallel$. The CFL constraint is:\n    $$\n    \\Delta t \\le \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}}\n    $$\n\nThe overall maximum stable time step, $\\Delta t_{\\mathrm{CFL}}$, is the most restrictive of these four conditions, which corresponds to their minimum:\n$$\n\\Delta t_{\\mathrm{CFL}} = \\min \\left( \\frac{\\Delta x}{u_x^{\\max}}, \\frac{\\Delta y}{u_y^{\\max}}, \\frac{\\Delta z}{v_{\\parallel}^{\\max}}, \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}} \\right)\n$$\nWe are given the following values:\n$u_x^{\\max} = 1.8 \\times 10^{4} \\ \\mathrm{m/s}$\n$u_y^{\\max} = 2.2 \\times 10^{3} \\ \\mathrm{m/s}$\n$v_{\\parallel}^{\\max} = 7.0 \\times 10^{4} \\ \\mathrm{m/s}$\n$a_{\\parallel}^{\\max} = 3.0 \\times 10^{6} \\ \\mathrm{m/s^2}$\n$\\Delta x = 2.5 \\times 10^{-3} \\ \\mathrm{m}$\n$\\Delta y = 1.5 \\times 10^{-3} \\ \\mathrm{m}$\n$\\Delta z = 4.0 \\times 10^{-2} \\ \\mathrm{m}$\n$\\Delta v_{\\parallel} = 1.2 \\times 10^{4} \\ \\mathrm{m/s}$\n\nNow we compute the value for each term in the minimum function:\n\n1.  $\\Delta t_x = \\frac{\\Delta x}{u_x^{\\max}} = \\frac{2.5 \\times 10^{-3}}{1.8 \\times 10^{4}} \\ \\mathrm{s} = \\frac{2.5}{1.8} \\times 10^{-7} \\ \\mathrm{s} \\approx 1.3888... \\times 10^{-7} \\ \\mathrm{s}$\n2.  $\\Delta t_y = \\frac{\\Delta y}{u_y^{\\max}} = \\frac{1.5 \\times 10^{-3}}{2.2 \\times 10^{3}} \\ \\mathrm{s} = \\frac{1.5}{2.2} \\times 10^{-6} \\ \\mathrm{s} \\approx 0.6818... \\times 10^{-6} \\ \\mathrm{s} = 6.8181... \\times 10^{-7} \\ \\mathrm{s}$\n3.  $\\Delta t_z = \\frac{\\Delta z}{v_{\\parallel}^{\\max}} = \\frac{4.0 \\times 10^{-2}}{7.0 \\times 10^{4}} \\ \\mathrm{s} = \\frac{4.0}{7.0} \\times 10^{-6} \\ \\mathrm{s} \\approx 0.5714... \\times 10^{-6} \\ \\mathrm{s} = 5.7142... \\times 10^{-7} \\ \\mathrm{s}$\n4.  $\\Delta t_{v_{\\parallel}} = \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}} = \\frac{1.2 \\times 10^{4}}{3.0 \\times 10^{6}} \\ \\mathrm{s} = \\frac{1.2}{3.0} \\times 10^{-2} \\ \\mathrm{s} = 0.4 \\times 10^{-2} \\ \\mathrm{s} = 4.0 \\times 10^{-3} \\ \\mathrm{s}$\n\nComparing these four time scales:\n$\\Delta t_x \\approx 1.389 \\times 10^{-7} \\ \\mathrm{s}$\n$\\Delta t_y \\approx 6.818 \\times 10^{-7} \\ \\mathrm{s}$\n$\\Delta t_z \\approx 5.714 \\times 10^{-7} \\ \\mathrm{s}$\n$\\Delta t_{v_{\\parallel}} = 4000 \\times 10^{-7} \\ \\mathrm{s}$\n\nThe minimum of these values is $\\Delta t_x$:\n$$\n\\Delta t_{\\mathrm{CFL}} = \\min(1.3888..., 6.8181..., 5.7142..., 4000) \\times 10^{-7} \\ \\mathrm{s} \\approx 1.3888... \\times 10^{-7} \\ \\mathrm{s}\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\n\\Delta t_{\\mathrm{CFL}} \\approx 1.389 \\times 10^{-7} \\ \\mathrm{s}\n$$\nThe most restrictive constraint on the time step comes from the advection in the $x$-direction.",
            "answer": "$$\\boxed{1.389 \\times 10^{-7}}$$"
        }
    ]
}