{
    "hands_on_practices": [
        {
            "introduction": "在比较不同的离散化方法之前，我们必须首先确认其底层物理模型——回旋动理学近似——的有效性。这个练习将抽象的排序参数 $\\epsilon$ 与一个使用真实托卡马克参数的具体计算联系起来，让你亲手验证回旋动理学近似的适用性 。通过计算，你将理解为何对于磁约束聚变等离子体中的微观湍流研究，回旋动理学是比完整动力学模型更优越且有效的简化。",
            "id": "3959024",
            "problem": "在磁化聚变等离子体的回旋动理学模拟中，一个核心要求是衡量回旋半径与宏观系统尺度之比的无量纲级数参数必须很小。考虑一个托卡马克中的氘离子，其磁场强度 $B=3\\,\\mathrm{T}$，离子温度 $T_i=2\\,\\mathrm{keV}$，大半径 $R=1.7\\,\\mathrm{m}$，以及由 $k_{\\perp}\\rho_i\\sim 0.3$ 表征的特征垂直涨落尺度。仅使用基本定义，推导离子热速度 $v_{th,i}$、离子回旋频率 $\\Omega_i$ 和离子热回旋半径 $\\rho_i$，然后对氘离子进行数值计算。使用 $Z=1$，$m_i=2m_p$，其中质子质量 $m_p=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$，元电荷 $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$。将 $T_i$ 视为每个离子的能量，并通过 $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$ 将 $\\mathrm{keV}$ 转换为焦耳。采用以下定义：$v_{th,i}\\equiv\\sqrt{2T_i/m_i}$，$\\Omega_i\\equiv ZeB/m_i$ 和 $\\rho_i\\equiv v_{th,i}/\\Omega_i$。然后，使用 $L=R$ 作为宏观尺度，构建回旋动理学级数参数 $\\epsilon\\equiv \\rho_i/L$ 并计算其值。基于第一性原理，简要论证当 $k_{\\perp}\\rho_i\\sim 0.3$ 时，所得 $\\epsilon$ 的量值为何能支持回旋动理学近似在连续介质和粒子模拟（PIC）两种离散化方法中的有效性。\n\n仅报告 $\\epsilon$ 的最终数值，作为一个无量纲数，并四舍五入到三位有效数字。",
            "solution": "题目陈述经评估，被确定为具有科学依据、良定且客观。它提出了一个等离子体物理学中的标准计算，与聚变装置的回旋动理学模拟相关。所有必要的数据和定义都已提供，并与既定原理一致。因此，有必要给出完整解答。\n\n该问题要求计算托卡马克中氘等离子体的回旋动理学级数参数 $\\epsilon$。我们已知以下参数：\n磁场强度：$B=3\\,\\mathrm{T}$\n离子温度：$T_i=2\\,\\mathrm{keV}$\n大半径：$R=1.7\\,\\mathrm{m}$\n特征垂直涨落尺度：$k_{\\perp}\\rho_i\\sim 0.3$\n离子电荷态：$Z=1$\n离子质量（氘）：$m_i=2m_p$\n质子质量：$m_p=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$\n元电荷：$e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n\n题目提供了以下定义：\n离子热速度：$v_{th,i}\\equiv\\sqrt{2T_i/m_i}$\n离子回旋频率：$\\Omega_i\\equiv ZeB/m_i$\n离子热回旋半径：$\\rho_i\\equiv v_{th,i}/\\Omega_i$\n回旋动理学级数参数：$\\epsilon\\equiv \\rho_i/L$，其中宏观尺度长度 $L=R$。\n\n首先，我们必须将所有物理量表示为国际单位制（SI）基本单位。离子温度 $T_i$ 以千电子伏（$\\mathrm{keV}$）给出，必须转换为焦耳（$\\mathrm{J}$）。使用提供的转换关系 $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$，其中 $e$ 是以库仑为单位的元电荷，我们有：\n$$T_i = 2\\,\\mathrm{keV} = 2 \\times 10^3\\,\\mathrm{eV} = (2 \\times 10^3) \\times (1.602176634\\times 10^{-19}) \\,\\mathrm{J}$$\n$$T_i = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}$$\n\n接下来，我们计算氘离子的质量 $m_i$：\n$$m_i = 2m_p = 2 \\times (1.67262192369\\times 10^{-27}\\,\\mathrm{kg}) = 3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}$$\n\n在 $T_i$ 和 $m_i$ 均使用SI单位后，我们现在可以推导并计算 $v_{th,i}$、$\\Omega_i$ 和 $\\rho_i$。\n\n1.  **离子热速度 ($v_{th,i}$)**\n    使用定义 $v_{th,i} = \\sqrt{2T_i/m_i}$：\n    $$v_{th,i} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx 4.37694 \\times 10^5\\,\\mathrm{m/s}$$\n\n2.  **离子回旋频率 ($\\Omega_i$)**\n    使用定义 $\\Omega_i = ZeB/m_i$：\n    $$\\Omega_i = \\frac{1 \\times (1.602176634\\times 10^{-19}\\,\\mathrm{C}) \\times (3\\,\\mathrm{T})}{3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}} \\approx 1.43682 \\times 10^8\\,\\mathrm{rad/s}$$\n\n3.  **离子热回旋半径 ($\\rho_i$)**\n    使用定义 $\\rho_i = v_{th,i}/\\Omega_i$：\n    $$\\rho_i = \\frac{4.37694 \\times 10^5\\,\\mathrm{m/s}}{1.43682 \\times 10^8\\,\\mathrm{rad/s}} \\approx 3.0462 \\times 10^{-3}\\,\\mathrm{m}$$\n    或者，我们可以用基本参数直接表示 $\\rho_i$：\n    $$\\rho_i = \\frac{v_{th,i}}{\\Omega_i} = \\frac{\\sqrt{2T_i/m_i}}{ZeB/m_i} = \\frac{\\sqrt{2T_im_i}}{ZeB}$$\n    代入数值验证了结果：\n    $$\\rho_i = \\frac{\\sqrt{2 \\times (3.20435... \\times 10^{-16}\\,\\mathrm{J}) \\times (3.34524... \\times 10^{-27}\\,\\mathrm{kg})}}{1 \\times (1.60217... \\times 10^{-19}\\,\\mathrm{C}) \\times (3\\,\\mathrm{T})} \\approx 3.0462 \\times 10^{-3}\\,\\mathrm{m}$$\n\n现在，我们计算回旋动理学级数参数 $\\epsilon$。题目指定使用大半径 $R$ 作为宏观尺度长度 $L$。\n$$L = R = 1.7\\,\\mathrm{m}$$\n级数参数 $\\epsilon$ 是离子热回旋半径与此宏观尺度长度的比值：\n$$\\epsilon = \\frac{\\rho_i}{L} = \\frac{3.0462 \\times 10^{-3}\\,\\mathrm{m}}{1.7\\,\\mathrm{m}} \\approx 1.79188 \\times 10^{-3}$$\n\n按要求四舍五入到三位有效数字，得到：\n$$\\epsilon \\approx 1.79 \\times 10^{-3}$$\n\n最后，我们论证为何这个结果支持回旋动理学近似的有效性。\n回旋动理学模型是基本弗拉索夫-麦克斯韦方程组的一个严格渐近极限。其推导依赖于一个形式化的级数方案，其中回旋半径 $\\rho_i$ 远小于宏观平衡等离子体剖面（如密度、温度和磁场）的特征尺度长度 $L$。无量纲参数 $\\epsilon \\equiv \\rho_i/L$ 量化了这种尺度分离。我们计算出的值 $\\epsilon \\approx 1.79 \\times 10^{-3}$ 非常小，满足了关键条件 $\\epsilon \\ll 1$。这种大的尺度分离验证了回旋动理学的核心步骤：对快速回旋运动轨道上的粒子运动进行平均。这个被称为“回旋平均”的步骤是合理的，因为在回旋轨道的空间范围内，背景量可视为常数，这使得 $(\\mathbf{x}, \\mathbf{v})$ 相空间中复杂的六维粒子动力学可以简化为在回旋中心坐标下更易处理的五维模型。\n\n题目还指出 $k_{\\perp}\\rho_i \\sim 0.3$。这个条件指明了湍流的垂直波长与离子回旋半径相当。这属于“有限拉莫尔半径”（FLR）效应的范畴，这些效应对描述驱动湍流输运的微观不稳定性（如离子温度梯度模）至关重要。回旋动理学模型正是为这个 $\\rho_i/L \\ll 1$ 但 $k_{\\perp}\\rho_i \\sim \\mathcal{O}(1)$ 的区域而设计的。更简单的模型，如理想磁流体力学（MHD）或流体理论，在这个区域通常会失效。\n\n由 $\\epsilon \\ll 1$ 所证实的底层物理近似的有效性，是任何数值离散化方法的先决条件。连续介质（欧拉）方法和粒子模拟（PIC，一种拉格朗日方法）都是为求解*同一套*回旋动理学方程而设计的数值技术。因此，$\\epsilon$ 的小量性是这两种离散化策略保真度的基础，因为它证实了它们所要解的方程组为指定区域的等离子体动力学提供了有效的物理描述。",
            "answer": "$$\\boxed{1.79 \\times 10^{-3}}$$"
        },
        {
            "introduction": "建立共享的物理基础后，我们转向粒子模拟方法（拉格朗日方法）的具体特征。本练习直接探讨了单元内粒子（PIC）方法最显著的特点：统计采样噪声 。通过从第一性原理推导噪声的标度关系，你将深入理解模拟粒子数与结果精度之间的权衡，这是评估PIC方法性能的关键。",
            "id": "3959012",
            "problem": "考虑一个回旋动理学等离子体中的均匀回旋中心密度场，其位于一个三维体积为 $V$ 的周期性区域内，具有恒定的连续密度 $n_0$。在回旋动理学密度的粒子模拟 (PIC) 离散化中，从该区域的均匀分布中抽取 $N$ 个独立的标记粒子。在固定空间点 $\\boldsymbol{x}$ 处的密度 PIC 估计量是使用一个紧支集对称形状函数 $S(\\boldsymbol{r})$ 构建的。该函数被归一化，使得 $\\int_{\\mathbb{R}^3} S(\\boldsymbol{r})\\,\\mathrm{d}^3\\boldsymbol{r} = 1$，并且其支撑体积为 $V_s$，意味着在体积为 $V_s$ 的区域之外 $S(\\boldsymbol{r}) = 0$。假设形状函数为平顶帽函数，\n$$\nS(\\boldsymbol{r}) = \\begin{cases}\n\\frac{1}{V_s},  \\text{如果 } \\boldsymbol{r} \\in \\text{体积为 } V_s \\text{ 的支撑区域}, \\\\\n0,  \\text{其他情况},\n\\end{cases}\n$$\n并且平移到 $\\boldsymbol{x}$ 的支撑区域完全包含在周期性区域内（忽略边界重叠修正）。\n\n每个标记粒子携带相同的权重 $w$，其选择应使得 PIC 估计量是无偏的，即 $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$，其中\n$$\n\\tilde{n}(\\boldsymbol{x}) = \\sum_{i=1}^{N} w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right),\n$$\n且 $\\boldsymbol{X}_i$ 是独立的标记粒子位置。\n\n从独立抽样、无偏估计和独立随机变量和的方差等第一性原理出发，推导在点 $\\boldsymbol{x}$ 处 PIC 密度估计量的相对均方根误差\n$$\n\\epsilon_{\\mathrm{rel}}(\\boldsymbol{x}) \\equiv \\frac{\\sqrt{\\mathrm{Var}(\\tilde{n}(\\boldsymbol{x}))}}{n_0},\n$$\n作为 $N$、$V$ 和 $V_s$ 的函数的解析表达式。你的推导应从上述定义开始，明确计算所需的期望值，并且不应假定任何已知的 PIC 方差公式。请以包含 $N$、$V$ 和 $V_s$ 的单个闭式表达式的形式给出你的最终答案。不需要四舍五入。由于 $\\epsilon_{\\mathrm{rel}}$ 是无量纲的，最终表达式中不应包含单位。",
            "solution": "我们首先在给定假设下，将该估计量及其统计性质进行形式化。该区域是周期性的，体积为 $V$，标记粒子 $\\{\\boldsymbol{X}_i\\}_{i=1}^{N}$ 是独立同分布的，其在整个区域上的均匀概率密度为 $p(\\boldsymbol{r}) = \\frac{1}{V}$。在固定点 $\\boldsymbol{x}$ 处的密度 PIC 估计量是\n$$\n\\tilde{n}(\\boldsymbol{x}) = \\sum_{i=1}^{N} w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right).\n$$\n我们首先选择权重 $w$ 以确保无偏性，即 $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$。利用期望的线性性和独立性，\n$$\n\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = \\sum_{i=1}^{N} w\\, \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right) \\right] = N w\\, \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right],\n$$\n其中 $\\boldsymbol{X}$ 是区域内一个泛化的均匀随机位置。在均匀分布下 $S$ 的期望是\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = \\int_{V} \\frac{1}{V} S\\!\\left(\\boldsymbol{x} - \\boldsymbol{r}\\right)\\, \\mathrm{d}^3\\boldsymbol{r}.\n$$\n在假设平移到 $\\boldsymbol{x}$ 的形状函数支撑区域完全位于域内，并利用归一化条件 $\\int_{\\mathbb{R}^3} S(\\boldsymbol{r})\\,\\mathrm{d}^3\\boldsymbol{r} = 1$，我们有\n$$\n\\int_{V} S\\!\\left(\\boldsymbol{x} - \\boldsymbol{r}\\right)\\, \\mathrm{d}^3\\boldsymbol{r} = 1,\n$$\n所以\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = \\frac{1}{V}.\n$$\n无偏性条件 $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$ 于是给出\n$$\nN w \\left( \\frac{1}{V} \\right) = n_0 \\quad \\Rightarrow \\quad w = \\frac{n_0 V}{N}.\n$$\n\n接下来，我们计算估计量的方差。因为标记粒子是独立同分布的，\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = \\sum_{i=1}^{N} \\mathrm{Var}\\!\\left( w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right) \\right) = N w^2\\, \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right).\n$$\n因此，\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = N \\left( \\frac{n_0 V}{N} \\right)^2 \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right) = \\frac{n_0^2 V^2}{N} \\, \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right).\n$$\n\n现在我们计算平顶帽形状函数的 $\\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right)$。定义指示随机变量 $I$，如果 $\\boldsymbol{X}$ 位于平移到 $\\boldsymbol{x}$ 的 $S$ 的支撑区域内，则 $I$ 等于 $1$，否则等于 $0$。$\\boldsymbol{X}$ 位于支撑区域内的概率是\n$$\np \\equiv \\mathbb{P}(I = 1) = \\frac{V_s}{V}.\n$$\n对于平顶帽形状，\n$$\nS\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) = \\begin{cases}\n\\frac{1}{V_s},  I = 1, \\\\\n0,  I = 0.\n\\end{cases}\n$$\n因此 $S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)$ 是一个随机变量，它以概率 $p$ 取值 $\\frac{1}{V_s}$，以概率 $1-p$ 取值 $0$。其均值和二阶矩是\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = p \\cdot \\frac{1}{V_s} = \\frac{V_s}{V} \\cdot \\frac{1}{V_s} = \\frac{1}{V},\n$$\n这与前面的计算结果一致，并且\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)^2 \\right] = p \\cdot \\left( \\frac{1}{V_s} \\right)^2 = \\frac{V_s}{V} \\cdot \\frac{1}{V_s^2} = \\frac{1}{V V_s}.\n$$\n因此方差为\n$$\n\\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right) = \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)^2 \\right] - \\left( \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] \\right)^2 = \\frac{1}{V V_s} - \\left( \\frac{1}{V} \\right)^2 = \\frac{V - V_s}{V^2 V_s}.\n$$\n将此代入估计量的方差表达式中，得到\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = \\frac{n_0^2 V^2}{N} \\cdot \\left( \\frac{1}{V V_s} - \\frac{1}{V^2} \\right) = \\frac{n_0^2}{N} \\left( \\frac{V}{V_s} - 1 \\right).\n$$\n相对均方根误差定义为\n$$\n\\epsilon_{\\mathrm{rel}}(\\boldsymbol{x}) \\equiv \\frac{\\sqrt{\\mathrm{Var}(\\tilde{n}(\\boldsymbol{x}))}}{n_0} = \\sqrt{ \\frac{1}{N} \\left( \\frac{V}{V_s} - 1 \\right) }.\n$$\n\n这个结果概括了连续介质与基于粒子的离散化之间的对比：连续密度恰好是 $n_0$，而基于粒子的估计则表现出采样噪声，该噪声以 $N^{-1/2}$ 的比例变化，并随着支撑体积 $V_s$ 的缩小（即平滑作用减弱）而增加，其对比率 $\\frac{V}{V_s}$ 的依赖性源于给定标记粒子对 $\\boldsymbol{x}$ 处估计值有贡献的概率。周期性区域的假设消除了边界修正；当 $V \\gg V_s$ 时，主要的标度关系为 $\\epsilon_{\\mathrm{rel}} \\sim \\sqrt{\\frac{V}{N V_s}}$。",
            "answer": "$$\\boxed{\\sqrt{\\frac{1}{N}\\left(\\frac{V}{V_s}-1\\right)}}$$"
        },
        {
            "introduction": "作为对PIC噪声讨论的对照，这个练习将审视连续谱方法（欧拉方法）的一个关键约束。本练习聚焦于Courant-Friedrichs-Lewy (CFL) 条件，它限制了显式网格求解器的模拟时间步长 。通过计算CFL极限，你将揭示高维相空间和快速物理现象如何给连续谱回旋动理学模拟带来严峻的计算成本，这为比较两种离散化方法的效率提供了重要视角。",
            "id": "3959038",
            "problem": "考虑一个用于单一离子种类的无碰撞回旋动理学方程的显式有限体积连续介质求解器，该求解器在一个简化的四维相空间 $(x,y,z,v_{\\parallel})$ 中运行。该求解器使用守恒迎风通量、前向欧拉时间积分和维度分裂法来推进分布函数 $f(x,y,z,v_{\\parallel},t)$。在没有源项和碰撞的情况下，控制方程可以写成线性化平流形式\n$$\n\\frac{\\partial f}{\\partial t} + u_x \\frac{\\partial f}{\\partial x} + u_y \\frac{\\partial f}{\\partial y} + v_{\\parallel} \\frac{\\partial f}{\\partial z} + a_{\\parallel} \\frac{\\partial f}{\\partial v_{\\parallel}} = 0,\n$$\n其中 $u_x$ 和 $u_y$ 是解析的最大垂直漂移速度（例如，$\\mathbf{E} \\times \\mathbf{B}$ 漂移和磁漂移），$v_{\\parallel}$ 是解析的最大平行流速度，而 $a_{\\parallel}$ 是由平行电场引起的最大平行加速度。对于显式方法，Courant–Friedrichs–Lewy (CFL) 条件对时间步长进行约束，以确保对于每个特征方向，数值依赖域都包含物理依赖域。\n\n假设一个均匀网格，在每个坐标上的间距分别为 $\\Delta x$、$\\Delta y$、$\\Delta z$ 和 $\\Delta v_{\\parallel}$。解析的最大特征速度（在整个计算域和时间内取值）如下：\n$u_x^{\\max} = 1.8 \\times 10^{4} \\ \\mathrm{m/s}$，$u_y^{\\max} = 2.2 \\times 10^{3} \\ \\mathrm{m/s}$，$v_{\\parallel}^{\\max} = 7.0 \\times 10^{4} \\ \\mathrm{m/s}$，以及 $a_{\\parallel}^{\\max} = 3.0 \\times 10^{6} \\ \\mathrm{m/s^2}$。网格间距为：$\\Delta x = 2.5 \\times 10^{-3} \\ \\mathrm{m}$，$\\Delta y = 1.5 \\times 10^{-3} \\ \\mathrm{m}$，$\\Delta z = 4.0 \\times 10^{-2} \\ \\mathrm{m}$，以及 $\\Delta v_{\\parallel} = 1.2 \\times 10^{4} \\ \\mathrm{m/s}$。\n\n从特征线的物理解释以及在一个时间步长内信息在任何坐标方向上的传播距离不超过一个网格单元长度的要求出发，推导出相应的显式时间步长约束，并计算该求解器的最大稳定CFL时间步长 $\\Delta t_{\\mathrm{CFL}}$，取限制最严格的方向。你的最终答案需以秒为单位表示，并四舍五入至四位有效数字。",
            "solution": "所提出的问题被判定为有效。它在科学上基于计算流体力学和等离子体物理学的原理，特别是关于显式平流格式的数值稳定性。该问题是适定的，提供了所有必要的数据和明确的目标。它没有歧义、矛盾和主观论断。因此，我们可以进行正式求解。\n\n问题要求计算一个基于Courant–Friedrichs–Lewy (CFL)条件的显式有限体积求解器的最大稳定时间步长 $\\Delta t_{\\mathrm{CFL}}$。该求解器用于无碰撞回旋动理学方程，其在线性化平流形式下，对于四维相空间 $(x, y, z, v_{\\parallel})$，表示为：\n$$\n\\frac{\\partial f}{\\partial t} + u_x \\frac{\\partial f}{\\partial x} + u_y \\frac{\\partial f}{\\partial y} + v_{\\parallel} \\frac{\\partial f}{\\partial z} + a_{\\parallel} \\frac{\\partial f}{\\partial v_{\\parallel}} = 0\n$$\n此处，$f(x, y, z, v_{\\parallel}, t)$ 是分布函数。系数 $u_x$、$u_y$、$v_{\\parallel}$ 和 $a_{\\parallel}$ 分别代表在相空间坐标 $x$、$y$、$z$ 和 $v_{\\parallel}$ 中的平流速度。请注意，$v_{\\parallel}$既是坐标，也是$z$方向的平流速度，而$a_{\\parallel}$是$v_{\\parallel}$方向的平流速度（即加速度）。\n\n对于一个网格间距为 $\\Delta \\xi$ 的显式一阶一维平流格式 $\\frac{\\partial f}{\\partial t} + c \\frac{\\partial f}{\\partial \\xi} = 0$，CFL条件由库朗数 $C \\le 1$ 给出。库朗数定义为 $C = |c| \\frac{\\Delta t}{\\Delta \\xi}$。该条件确保了网格点的数值依赖域包含物理依赖域。这意味着在单个时间步长 $\\Delta t$ 内，信息传播的距离不能超过一个网格单元。由此产生的时间步长约束为：\n$$\n\\Delta t \\le \\frac{\\Delta \\xi}{|c|}\n$$\n问题指明求解器采用维度分裂法。这意味着四个相空间维度中的每一个平流项都被独立处理。因此，时间步长 $\\Delta t$ 必须同时满足每个维度的CFL条件。为保证稳定性，总的时间步长必须小于或等于每个维度所允许的最大时间步长的最小值。我们必须使用整个计算域上每个方向的最大平流速度来确保处处稳定。\n\n让我们为每个维度建立独立的时间步长约束：\n\n1.  对于$x$方向，平流速度为 $u_x$。网格间距为 $\\Delta x$。CFL约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta x}{u_x^{\\max}}\n    $$\n2.  对于$y$方向，平流速度为 $u_y$。网格间距为 $\\Delta y$。CFL约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta y}{u_y^{\\max}}\n    $$\n3.  对于$z$方向，平流速度为平行速度 $v_{\\parallel}$。网格间距为 $\\Delta z$。CFL约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta z}{v_{\\parallel}^{\\max}}\n    $$\n4.  对于$v_{\\parallel}$方向，平流“速度”是平行加速度 $a_{\\parallel}$。网格间距为 $\\Delta v_{\\parallel}$。CFL约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}}\n    $$\n\n总的最大稳定时间步长 $\\Delta t_{\\mathrm{CFL}}$ 是这四个条件中最严格的一个，即对应于它们的最小值：\n$$\n\\Delta t_{\\mathrm{CFL}} = \\min \\left( \\frac{\\Delta x}{u_x^{\\max}}, \\frac{\\Delta y}{u_y^{\\max}}, \\frac{\\Delta z}{v_{\\parallel}^{\\max}}, \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}} \\right)\n$$\n给定的数值如下：\n$u_x^{\\max} = 1.8 \\times 10^{4} \\ \\mathrm{m/s}$\n$u_y^{\\max} = 2.2 \\times 10^{3} \\ \\mathrm{m/s}$\n$v_{\\parallel}^{\\max} = 7.0 \\times 10^{4} \\ \\mathrm{m/s}$\n$a_{\\parallel}^{\\max} = 3.0 \\times 10^{6} \\ \\mathrm{m/s^2}$\n$\\Delta x = 2.5 \\times 10^{-3} \\ \\mathrm{m}$\n$\\Delta y = 1.5 \\times 10^{-3} \\ \\mathrm{m}$\n$\\Delta z = 4.0 \\times 10^{-2} \\ \\mathrm{m}$\n$\\Delta v_{\\parallel} = 1.2 \\times 10^{4} \\ \\mathrm{m/s}$\n\n现在我们计算最小值函数中的每一项：\n\n1.  $\\Delta t_x = \\frac{\\Delta x}{u_x^{\\max}} = \\frac{2.5 \\times 10^{-3}}{1.8 \\times 10^{4}} \\ \\mathrm{s} = \\frac{2.5}{1.8} \\times 10^{-7} \\ \\mathrm{s} \\approx 1.3888... \\times 10^{-7} \\ \\mathrm{s}$\n2.  $\\Delta t_y = \\frac{\\Delta y}{u_y^{\\max}} = \\frac{1.5 \\times 10^{-3}}{2.2 \\times 10^{3}} \\ \\mathrm{s} = \\frac{1.5}{2.2} \\times 10^{-6} \\ \\mathrm{s} \\approx 0.6818... \\times 10^{-6} \\ \\mathrm{s} = 6.8181... \\times 10^{-7} \\ \\mathrm{s}$\n3.  $\\Delta t_z = \\frac{\\Delta z}{v_{\\parallel}^{\\max}} = \\frac{4.0 \\times 10^{-2}}{7.0 \\times 10^{4}} \\ \\mathrm{s} = \\frac{4.0}{7.0} \\times 10^{-6} \\ \\mathrm{s} \\approx 0.5714... \\times 10^{-6} \\ \\mathrm{s} = 5.7142... \\times 10^{-7} \\ \\mathrm{s}$\n4.  $\\Delta t_{v_{\\parallel}} = \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}} = \\frac{1.2 \\times 10^{4}}{3.0 \\times 10^{6}} \\ \\mathrm{s} = \\frac{1.2}{3.0} \\times 10^{-2} \\ \\mathrm{s} = 0.4 \\times 10^{-2} \\ \\mathrm{s} = 4.0 \\times 10^{-3} \\ \\mathrm{s}$\n\n比较这四个时间尺度：\n$\\Delta t_x \\approx 1.389 \\times 10^{-7} \\ \\mathrm{s}$\n$\\Delta t_y \\approx 6.818 \\times 10^{-7} \\ \\mathrm{s}$\n$\\Delta t_z \\approx 5.714 \\times 10^{-7} \\ \\mathrm{s}$\n$\\Delta t_{v_{\\parallel}} = 4000 \\times 10^{-7} \\ \\mathrm{s}$\n\n这些值中的最小值是 $\\Delta t_x$：\n$$\n\\Delta t_{\\mathrm{CFL}} = \\min(1.3888..., 6.8181..., 5.7142..., 4000) \\times 10^{-7} \\ \\mathrm{s} \\approx 1.3888... \\times 10^{-7} \\ \\mathrm{s}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n\\Delta t_{\\mathrm{CFL}} \\approx 1.389 \\times 10^{-7} \\ \\mathrm{s}\n$$\n对时间步长最严格的约束来自$x$方向的平流。",
            "answer": "$$\\boxed{1.389 \\times 10^{-7}}$$"
        }
    ]
}