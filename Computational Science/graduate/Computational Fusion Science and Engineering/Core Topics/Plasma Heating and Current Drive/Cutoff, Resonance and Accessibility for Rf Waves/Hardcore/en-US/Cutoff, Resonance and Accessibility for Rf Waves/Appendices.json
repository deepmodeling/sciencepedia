{
    "hands_on_practices": [
        {
            "introduction": "The journey of a radio-frequency wave into a plasma is often blocked by cutoffs and facilitated by resonances. This first practice explores the canonical \"Budden problem,\" a cornerstone model that captures the essential physics of this interaction. By analyzing a wave encountering a cutoff-resonance pair, you will apply the Wentzel-Kramers-Brillouin (WKB) tunneling approximation and the Landau-Zener formula to quantitatively determine how the incident energy is partitioned into reflected, transmitted, and absorbed components . Mastering this idealized scenario provides the fundamental intuition needed to understand wave accessibility in more complex, realistic fusion plasmas.",
            "id": "3962793",
            "problem": "Consider a one-dimensional, cold, magnetized plasma stratified along the spatial coordinate $x$, with a monochromatic Radio Frequency (RF) wave incident from $x\\to -\\infty$ onto a region that contains a single cutoff followed, at a larger $x$, by a single resonance. Assume the wave is polarized such that, away from the resonance, it can be modeled by a single scalar field amplitude $E(x)$ obeying the second-order ordinary differential equation $E''(x) + k_{x}^{2}(x)\\,E(x) = 0$ for slowly varying $k_{x}(x)$, where primes denote derivatives with respect to $x$. The energy flux is proportional to $|E|^{2}$ in the WKB (Wentzel-Kramers-Brillouin) regime.\n\nModel the cutoff region for $0 \\le x \\le L$ as a smooth evanescent barrier with local wavenumber\n$$\nk_{x}^{2}(x) = -\\gamma^{2}\\,x,\n$$\nso that the propagation domain for $x0$ ($k_{x}^{2}0$) is separated from the resonance at $x=L$ ($L0$) by an evanescent layer ($k_{x}^{2}0$) of finite width. Beyond the cutoff ($xL$), assume the wave enters a narrow resonance-coupling region in which the original branch (denote its amplitude by $a(x)$) couples to a resonant branch (denote its amplitude by $b(x)$). In the vicinity of the resonance, suppose the two-mode spatial evolution is well-described by the standard Landau-Zener spatial coupled-mode equations\n$$\n\\mathrm{i}\\,\\frac{d}{dx}\n\\begin{pmatrix}\na(x)\\\\\nb(x)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\Delta(x)/2  \\kappa\\\\\n\\kappa  -\\Delta(x)/2\n\\end{pmatrix}\n\\begin{pmatrix}\na(x)\\\\\nb(x)\n\\end{pmatrix},\n\\qquad \\Delta(x) = \\alpha\\,(x-L),\n$$\nwith constant coupling $\\kappa0$ and linear detuning slope $\\alpha0$. Assume that energy transferred to the resonant branch $b$ is irreversibly dissipated (mode-converted/absorbed) and does not re-emit into the original branch. The incident RF wave has unit energy flux in the propagation region at $x\\to -\\infty$, and there is no incoming wave from $x\\to+\\infty$.\n\nUsing first-principles asymptotics and well-tested formulas, proceed as follows:\n- Across the evanescent cutoff layer, apply the WKB barrier tunneling approximation to determine the energy-flux transmission factor $D$ multiplying the incident energy as it reaches the entrance to the resonance region at $x=L$.\n- Within the resonance region, apply the Landau-Zener mode-conversion result for spatially varying detuning to determine the fraction $P_{\\mathrm{stay}}$ that remains in the original branch after crossing the resonance and the complementary fraction $P_{\\mathrm{conv}} = 1 - P_{\\mathrm{stay}}$ that is irreversibly mode-converted.\n- Combine these to obtain the three energy fractions relative to unit incident energy: the reflected fraction $R$, the transmitted fraction $T$, and the mode-converted fraction $C$, with $R+T+C=1$.\n\nFor definiteness, use the parameter values\n$$\n\\gamma = \\frac{3}{2},\\quad L = 1,\\quad \\alpha = 1,\\quad \\kappa = \\sqrt{\\frac{\\ln 2}{2\\pi}}.\n$$\nCompute the numerical values of the three fractions $T$, $R$, and $C$, and express your final answers as dimensionless decimals. Round your answers to eight significant figures. Provide the three numbers in the order $(T, R, C)$.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. The solution is constructed by following the sequence of physical processes described: wave tunneling through an evanescent barrier, followed by partial absorption at a resonance.\n\nThe problem can be decomposed into three main steps:\n1.  Calculation of the energy flux transmission factor, $D$, for the evanescent layer between the cutoff at $x=0$ and the resonance at $x=L$. This is achieved using the WKB approximation.\n2.  Calculation of the probabilities of staying in the original wave branch, $P_{\\mathrm{stay}}$, and converting to the resonant branch, $P_{\\mathrm{conv}}$, upon crossing the resonance. This is accomplished using the Landau-Zener formula.\n3.  Combination of these factors to determine the total reflected ($R$), transmitted ($T$), and converted/absorbed ($C$) energy fractions relative to the unit incident energy flux.\n\n**Step 1: WKB Tunneling Factor**\n\nThe incident wave propagates from $x \\to -\\infty$ and encounters an evanescent region for $x \\in [0, L]$, where the local wavenumber squared is negative:\n$$\nk_{x}^{2}(x) = -\\gamma^{2}\\,x  0 \\quad \\text{for } x  0.\n$$\nThe magnitude of the imaginary wavenumber in this region is\n$$\n|k_{x}(x)| = \\sqrt{-k_{x}^{2}(x)} = \\sqrt{\\gamma^{2}\\,x} = \\gamma\\,x^{1/2}.\n$$\nThe WKB approximation for the energy-flux transmission factor, $D$, through an evanescent barrier extending from $x_1$ to $x_2$ is given by\n$$\nD = \\exp\\left(-2 \\int_{x_1}^{x_2} |k_{x}(x')|\\,dx'\\right).\n$$\nIn this problem, the evanescent barrier spans from the cutoff at $x_1=0$ to the resonance at $x_2=L$. We calculate the integral (often called the Gamow factor in this context):\n$$\nS = \\int_{0}^{L} |k_{x}(x')|\\,dx' = \\int_{0}^{L} \\gamma\\,(x')^{1/2}\\,dx'.\n$$\nPerforming the integration yields:\n$$\nS = \\gamma \\left[ \\frac{(x')^{3/2}}{3/2} \\right]_{0}^{L} = \\frac{2}{3}\\,\\gamma\\,L^{3/2}.\n$$\nSubstituting this into the formula for $D$:\n$$\nD = \\exp(-2S) = \\exp\\left(-\\frac{4}{3}\\,\\gamma\\,L^{3/2}\\right).\n$$\nUsing the given parameter values $\\gamma = 3/2$ and $L=1$:\n$$\nD = \\exp\\left(-\\frac{4}{3} \\cdot \\frac{3}{2} \\cdot 1^{3/2}\\right) = \\exp(-2).\n$$\nThis factor $D$ represents the fraction of the incident energy flux that tunnels through the barrier and reaches the resonance region at $x=L$.\n\n**Step 2: Landau-Zener Mode Conversion**\n\nAt $x=L$, the wave that has tunneled through the barrier enters a region where it can couple to a resonant mode. The dynamics are described by the Landau-Zener coupled-mode equations:\n$$\n\\mathrm{i}\\,\\frac{d}{dx}\n\\begin{pmatrix}\na(x) \\\\\nb(x)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\Delta(x)/2  \\kappa \\\\\n\\kappa  -\\Delta(x)/2\n\\end{pmatrix}\n\\begin{pmatrix}\na(x) \\\\\nb(x)\n\\end{pmatrix},\n$$\nwith a linearly varying detuning $\\Delta(x) = \\alpha\\,(x-L)$. The system starts in the state corresponding to branch 'a' before the crossing (at $x  L$) and evolves through the resonance at $x=L$. The standard Landau-Zener formula gives the probability of remaining in the initial diabatic state (branch 'a') after passing through the resonance. This probability, which we denote $P_{\\mathrm{stay}}$, is:\n$$\nP_{\\mathrm{stay}} = \\exp\\left(-\\frac{2\\pi\\kappa^{2}}{\\left|\\frac{d\\Delta}{dx}\\right|_{x=L}}\\right).\n$$\nFrom the definition of the detuning, we have the rate of change:\n$$\n\\frac{d\\Delta}{dx} = \\alpha.\n$$\nThus, the probability of staying in branch 'a' is:\n$$\nP_{\\mathrm{stay}} = \\exp\\left(-\\frac{2\\pi\\kappa^{2}}{\\alpha}\\right).\n$$\nWe are given the parameter values $\\alpha=1$ and $\\kappa = \\sqrt{\\frac{\\ln 2}{2\\pi}}$. Squaring $\\kappa$ gives $\\kappa^2 = \\frac{\\ln 2}{2\\pi}$. Substituting these values:\n$$\nP_{\\mathrm{stay}} = \\exp\\left(-\\frac{2\\pi \\left(\\frac{\\ln 2}{2\\pi}\\right)}{1}\\right) = \\exp(-\\ln 2) = \\frac{1}{2}.\n$$\nThe complementary probability, $P_{\\mathrm{conv}}$, represents the fraction of the wave's energy flux (at the resonance entrance) that is converted to branch 'b'. Since the problem states this energy is irreversibly dissipated, $P_{\\mathrm{conv}}$ is the absorption probability at the resonance.\n$$\nP_{\\mathrm{conv}} = 1 - P_{\\mathrm{stay}} = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n\n**Step 3: Energy Fraction Accounting**\n\nWe now combine these results to find the total reflected, transmitted, and converted fractions of the initial unit energy flux. The problem assumes irreversible absorption of the converted wave and no reflection from the resonance region itself. This allows for a simple sequential partitioning of energy.\n\n-   The incident energy flux is $1$.\n-   A fraction $D$ of this flux tunnels through the barrier to reach $x=L$. The remaining fraction, $1-D$, is reflected by the barrier. Thus, the total reflected fraction is $R = 1-D$.\n-   The flux $D$ reaching the resonance is then partitioned. A fraction $P_{\\mathrm{stay}}$ of this flux remains in branch 'a' and is transmitted through the resonance region. Therefore, the total transmitted fraction is $T = D \\times P_{\\mathrm{stay}}$.\n-   A fraction $P_{\\mathrm{conv}}$ of the flux $D$ is converted to branch 'b' and absorbed. Therefore, the total converted/absorbed fraction is $C = D \\times P_{\\mathrm{conv}}$.\n\nWe verify that the energy is conserved:\n$$\nR + T + C = (1-D) + (D \\times P_{\\mathrm{stay}}) + (D \\times P_{\\mathrm{conv}}) = 1 - D + D(P_{\\mathrm{stay}} + P_{\\mathrm{conv}}).\n$$\nSince $P_{\\mathrm{stay}} + P_{\\mathrm{conv}} = 1$, we have:\n$$\nR + T + C = 1 - D + D(1) = 1.\n$$\nNow, we substitute the analytical values for $D$, $P_{\\mathrm{stay}}$, and $P_{\\mathrm{conv}}$:\n$$\nD = \\exp(-2), \\quad P_{\\mathrm{stay}} = \\frac{1}{2}, \\quad P_{\\mathrm{conv}} = \\frac{1}{2}.\n$$\nThe energy fractions are:\n-   Transmitted fraction: $T = D \\times P_{\\mathrm{stay}} = \\exp(-2) \\times \\frac{1}{2} = \\frac{1}{2}\\exp(-2)$.\n-   Reflected fraction: $R = 1 - D = 1 - \\exp(-2)$.\n-   Converted fraction: $C = D \\times P_{\\mathrm{conv}} = \\exp(-2) \\times \\frac{1}{2} = \\frac{1}{2}\\exp(-2)$.\n\n**Numerical Evaluation**\n\nWe compute the numerical values and round to eight significant figures as requested.\n$$\n\\exp(-2) \\approx 0.13533528\n$$\n-   $T = \\frac{1}{2} \\exp(-2) \\approx \\frac{1}{2} \\times 0.13533528 = 0.06766764$.\n    To eight significant figures, $T \\approx 0.067667642$.\n-   $R = 1 - \\exp(-2) \\approx 1 - 0.13533528 = 0.86466472$.\n    To eight significant figures, $R \\approx 0.86466472$.\n-   $C = \\frac{1}{2} \\exp(-2) \\approx \\frac{1}{2} \\times 0.13533528 = 0.06766764$.\n    To eight significant figures, $C \\approx 0.067667642$.\n\nThe final answer is the triplet $(T, R, C)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.067667642  0.86466472  0.067667642\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Before a wave can interact with plasma resonances, it must first be successfully launched by an antenna and traverse a vacuum gap. This computational exercise shifts the focus from the plasma interior to this critical edge region, tackling the practical challenge of antenna-plasma coupling . You will model how a realistic antenna launches a spectrum of waves and determine what fraction of this launched power is \"accessible\" to the plasma, considering the influence of nearby conducting walls and the natural decay of evanescent spectral components in the vacuum region.",
            "id": "3962756",
            "problem": "You are asked to implement a computational model, grounded in first principles, to assess the Radio Frequency (RF) wave accessibility from an antenna through a finite vacuum gap to a plasma interface in a two-dimensional slab geometry. The antenna is placed at a finite distance from a perfectly conducting wall, and the vacuum gap separates the antenna aperture from the plasma boundary. The goal is to determine, for several specified parameter sets, the fraction of the launched spectral power that reaches the plasma interface without being eliminated by vacuum evanescence to below a specified amplitude threshold. All calculations must be based on physically consistent modeling of the near-field using the angular spectrum representation and propagation in vacuum using Maxwell's equations.\n\nAssume the following simplified, scientifically realistic configuration:\n- A two-dimensional geometry with coordinates $(x,z)$, where $z$ is normal to the plasma boundary and $x$ is tangential.\n- The antenna aperture is located at $z=0$ and radiates a real-valued, monochromatic, time-harmonic electric field in vacuum at angular frequency $\\omega = 2\\pi f$, with $f$ specified per test case. The vacuum gap of thickness $g$ separates the antenna aperture from the plasma interface at $z=g$.\n- A perfectly conducting wall is located at a distance $a$ behind the aperture in the $-z$ direction. Its presence modifies the near-field spectrum through constructive or destructive interference depending on the axial wavenumber.\n- The aperture field distribution is a Gaussian $E(x)$ with spatial width parameter $w$:\n$$\nE(x) = \\exp\\left(-\\frac{x^2}{2w^2}\\right).\n$$\n\nFoundational base and modeling requirements:\n1. In homogeneous vacuum, Maxwell's equations with time-harmonic dependence $\\exp(-i\\omega t)$ imply the homogeneous Helmholtz equation for each Cartesian component of the electric field:\n$$\n\\nabla^2 E + k_0^2 E = 0, \\quad k_0 = \\frac{\\omega}{c} = \\frac{2\\pi f}{c},\n$$\nwhere $c$ is the speed of light in vacuum.\n2. Use the angular spectrum representation to model near-field and propagation along $z$: express the field as a superposition of plane-wave components with transverse wavenumber $k_x$. For each spectral component $k_x$, define the axial wavenumber\n$$\nk_z(k_x) = \n\\begin{cases}\n\\sqrt{k_0^2 - k_x^2},  |k_x| \\le k_0 \\quad \\text{(propagating)} \\\\\ni\\sqrt{k_x^2 - k_0^2},  |k_x|  k_0 \\quad \\text{(evanescent)}.\n\\end{cases}\n$$\n3. Model the effect of the finite conducting wall distance by an interference factor that modifies the launched spectrum magnitude. Using a physically motivated image-field superposition for a perfectly conducting wall, apply the spectral multiplier\n$$\nF(k_x, a) = \\left|1 + \\exp\\left(2 i k_z(k_x) a\\right)\\right|,\n$$\nwhich yields constructive interference when $k_z(k_x)a$ is an integer multiple of $\\pi$ and yields attenuation otherwise. For evanescent components, note that $k_z = i\\alpha$ implies $F = |1 + \\exp(-2\\alpha a)|$.\n4. Propagation across the vacuum gap $g$ from $z=0$ to $z=g$ is governed by the axial propagation factor. For propagating components $|k_x| \\le k_0$, the magnitude is preserved. For evanescent components $|k_x|  k_0$, the magnitude is attenuated by\n$$\n\\exp\\left(-\\alpha g\\right), \\quad \\alpha = \\sqrt{k_x^2 - k_0^2}.\n$$\n5. Define an accessibility criterion based on a dimensionless amplitude threshold $t \\in (0,1)$. A spectral component is deemed accessible if either it is propagating ($|k_x| \\le k_0$) or if it is evanescent but its attenuation across the gap leaves its magnitude at least $t$, i.e.,\n$$\n\\exp(-\\alpha g) \\ge t.\n$$\n\nNumerical implementation requirements:\n- Discretize the aperture field $E(x)$ on a uniform grid in $x$ of length $L_x$ and $N_x$ points, with $L_x = 10w$ and $N_x = 4096$ for all test cases. Use the Fast Fourier Transform to compute the angular spectrum $S(k_x)$ as a discrete approximation to the continuous Fourier transform of $E(x)$. Use the standard relation between the sample spacing and Fourier frequencies to obtain the $k_x$ grid, with $k_x$ in radians per meter. You may use any consistent numerical normalization, since only ratios of spectral powers are requested.\n- Compute the modified spectrum $S_{\\text{eff}}(k_x) = S(k_x)\\,F(k_x,a)$.\n- Define the accessibility mask\n$$\n\\chi(k_x) =\n\\begin{cases}\n1,  |k_x| \\le k_0 \\\\\n1,  |k_x|  k_0 \\ \\text{and} \\ \\exp(-\\alpha g) \\ge t \\\\\n0,  \\text{otherwise,}\n\\end{cases}\n$$\nand compute the accessible spectral power fraction\n$$\nP_{\\text{acc}} = \\frac{\\sum_{k_x} |S_{\\text{eff}}(k_x)|^2 \\, \\chi(k_x)}{\\sum_{k_x} |S_{\\text{eff}}(k_x)|^2}.\n$$\n\nUnits and output specification:\n- Use $f$ in hertz (Hz), distances $w$, $a$, and $g$ in meters (m), and $c = 299{,}792{,}458 \\ \\text{m/s}$.\n- The final output must be a dimensionless float for each test case, equal to $P_{\\text{acc}}$, rounded to six decimal places.\n\nTest suite:\nImplement your program to evaluate $P_{\\text{acc}}$ for the following four parameter sets:\n1. Case A (happy path): $f = 3.7\\times 10^9 \\ \\text{Hz}$, $w = 0.05 \\ \\text{m}$, $a = 0.015 \\ \\text{m}$, $g = 0.03 \\ \\text{m}$, $t = 0.01$.\n2. Case B (large vacuum gap boundary): $f = 3.7\\times 10^9 \\ \\text{Hz}$, $w = 0.05 \\ \\text{m}$, $a = 0.015 \\ \\text{m}$, $g = 0.30 \\ \\text{m}$, $t = 0.01$.\n3. Case C (low frequency edge case): $f = 5.5\\times 10^7 \\ \\text{Hz}$, $w = 0.05 \\ \\text{m}$, $a = 0.015 \\ \\text{m}$, $g = 0.03 \\ \\text{m}$, $t = 0.01$.\n4. Case D (finite wall distance tuned near constructive interference at normal incidence): $f = 3.7\\times 10^9 \\ \\text{Hz}$, $w = 0.05 \\ \\text{m}$, $a = 0.0405 \\ \\text{m}$, $g = 0.03 \\ \\text{m}$, $t = 0.01$.\n\nFinal output format:\n- Your program should produce a single line of output containing the four computed values of $P_{\\text{acc}}$ for the cases A–D, as a comma-separated list enclosed in square brackets, with no spaces, and each value rounded to six decimal places. For example:\n\"[0.XXXXX,0.XXXXX,0.XXXXX,0.XXXXX]\".",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of wave propagation and Fourier optics, is well-posed with a complete and consistent set of parameters, and is objective in its formulation. The provided model, including the specific form of the wall interference factor, is taken as a given for the system to be simulated.\n\nThe solution computes the fraction of accessible spectral power, $P_{\\text{acc}}$, by modeling the propagation of an electromagnetic wave from an antenna aperture through a vacuum gap. The methodology follows these steps:\n\n1.  **System Parameters**: For each test case, we are given the wave frequency $f$, the Gaussian aperture width $w$, the distance to the conducting wall $a$, the vacuum gap thickness $g$, and the amplitude attenuation threshold $t$. The speed of light is $c = 299,792,458 \\, \\text{m/s}$. From these, we calculate the angular frequency $\\omega = 2\\pi f$ and the vacuum wavenumber $k_0 = \\omega/c$.\n\n2.  **Spatial and Spectral domains**: The aperture electric field, $E(x) = \\exp(-x^2/(2w^2))$, is discretized on a spatial grid. The problem specifies a grid of length $L_x = 10w$ with $N_x = 4096$ points. The spatial sampling interval is $\\Delta x = L_x / N_x$. The corresponding grid in the transverse wavenumber domain, $k_x$, is determined using the properties of the Discrete Fourier Transform (DFT). The wavenumbers are given by $k_x = 2\\pi \\nu_k$, where $\\nu_k$ are the spatial frequencies obtained via `numpy.fft.fftfreq`.\n\n3.  **Angular Spectrum**: The angular spectrum of the aperture field, $S(k_x)$, is computed using the Fast Fourier Transform (FFT) of the discretized field $E(x_j)$.\n    $$\n    S(k_x) \\propto \\text{FFT}\\{E(x)\\}\n    $$\n    Since the final quantity $P_{\\text{acc}}$ is a ratio of powers, the normalization constant of the FFT is irrelevant as it cancels out. For numerical convenience, the spectra are shifted to center the $k_x=0$ component.\n\n4.  **Axial Wavenumber**: For each transverse wavenumber $k_x$, the axial wavenumber $k_z$ in vacuum is determined by the dispersion relation derived from the Helmholtz equation, $\\nabla^2 E + k_0^2 E = 0$. This gives $k_x^2 + k_z^2 = k_0^2$.\n    $$\n    k_z(k_x) = \\sqrt{k_0^2 - k_x^2}\n    $$\n    This expression is evaluated using complex arithmetic. For propagating waves ($|k_x| \\le k_0$), $k_z$ is real. For evanescent waves ($|k_x|  k_0$), $k_z$ is purely imaginary, i.e., $k_z = i\\alpha$, where $\\alpha = \\sqrt{k_x^2 - k_0^2}$ is the attenuation rate.\n\n5.  **Wall Interference**: The perfectly conducting wall at $z=-a$ modifies the field at the aperture plane $z=0$ via reflection. According to the problem statement, this effect is modeled by a spectral multiplier $F(k_x, a)$, which is applied to the amplitude of the launched spectrum.\n    $$\n    F(k_x, a) = |1 + \\exp(2i k_z(k_x) a)|\n    $$\n    The effective launched spectrum is thus $S_{\\text{eff}}(k_x) = S(k_x) F(k_x, a)$. The corresponding spectral power is proportional to $|S_{\\text{eff}}(k_x)|^2$.\n\n6.  **Accessibility Criterion**: A spectral component $k_x$ is considered \"accessible\" if it can reach the plasma interface at $z=g$ without significant decay. The criterion is formalized by an accessibility mask, $\\chi(k_x)$:\n    - If $|k_x| \\le k_0$, the wave is propagating and experiences no attenuation in vacuum. It is always accessible, so $\\chi(k_x) = 1$.\n    - If $|k_x|  k_0$, the wave is evanescent and its amplitude decays as $\\exp(-\\alpha z)$, where $\\alpha = \\text{Im}\\{k_z\\}$. The wave is accessible only if its amplitude at $z=g$ remains above a fraction $t$ of its initial amplitude. This condition is $\\exp(-\\alpha g) \\ge t$.\n    The mask is therefore:\n    $$\n    \\chi(k_x) =\n    \\begin{cases}\n    1,  |k_x| \\le k_0 \\\\\n    1,  |k_x|  k_0 \\ \\text{and} \\ \\exp(-\\sqrt{k_x^2 - k_0^2} \\, g) \\ge t \\\\\n    0,  \\text{otherwise}\n    \\end{cases}\n    $$\n    This condition on evanescent waves can be rewritten as $\\sqrt{k_x^2 - k_0^2} \\le -\\ln(t)/g$.\n\n7.  **Accessible Power Fraction**: The final quantity, $P_{\\text{acc}}$, is the ratio of the total accessible spectral power to the total effective launched spectral power. Both are calculated by summing over all discrete $k_x$ components.\n    $$\n    P_{\\text{acc}} = \\frac{\\sum_{k_x} |S_{\\text{eff}}(k_x)|^2 \\, \\chi(k_x)}{\\sum_{k_x} |S_{\\text{eff}}(k_x)|^2}\n    $$\n    This value is computed for each of the four test cases provided, and the results are rounded to six decimal places.\n\nThe numerical implementation uses the `numpy` library for array operations and the FFT. Complex number capabilities are used to handle $k_z$ for both propagating and evanescent regimes seamlessly.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RF wave accessibility fraction for given antenna and vacuum parameters.\n    \"\"\"\n    # Define physical constants and numerical parameters\n    c = 299792458.0  # Speed of light in m/s\n    Nx = 4096       # Number of points in spatial grid\n    Lx_factor = 10.0  # Domain size in units of aperture width w\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Happy path\n        {'f': 3.7e9, 'w': 0.05, 'a': 0.015, 'g': 0.03, 't': 0.01},\n        # Case B: Large vacuum gap\n        {'f': 3.7e9, 'w': 0.05, 'a': 0.015, 'g': 0.30, 't': 0.01},\n        # Case C: Low frequency\n        {'f': 5.5e7, 'w': 0.05, 'a': 0.015, 'g': 0.03, 't': 0.01},\n        # Case D: Tuned wall distance\n        {'f': 3.7e9, 'w': 0.05, 'a': 0.0405, 'g': 0.03, 't': 0.01},\n    ]\n\n    results = []\n    for params in test_cases:\n        f = params['f']\n        w = params['w']\n        a = params['a']\n        g = params['g']\n        t = params['t']\n\n        # 1. Calculate derived parameters\n        omega = 2.0 * np.pi * f\n        k0 = omega / c\n        Lx = Lx_factor * w\n        dx = Lx / Nx\n\n        # 2. Create spatial grid and aperture field distribution\n        x = dx * (np.arange(Nx) - Nx / 2)\n        E_x = np.exp(-x**2 / (2.0 * w**2))\n\n        # 3. Compute the angular spectrum S(k_x) using FFT\n        # The kx grid is obtained from fftfreq and scaled by 2*pi\n        kx_unsh = 2.0 * np.pi * np.fft.fftfreq(Nx, d=dx)\n        S_unsh = np.fft.fft(E_x)\n\n        # Shift spectra to have zero frequency at the center for easier analysis\n        kx = np.fft.fftshift(kx_unsh)\n        S = np.fft.fftshift(S_unsh)\n\n        # 4. Calculate axial wavenumber k_z for each k_x\n        # Using complex numbers takes care of both propagating and evanescent cases\n        kz_squared = k0**2 - kx**2\n        kz = np.sqrt(kz_squared.astype(complex))\n\n        # 5. Calculate wall interference factor F and effective spectrum S_eff\n        F = np.abs(1.0 + np.exp(2.0j * kz * a))\n        S_eff = S * F\n        \n        # 6. Define the accessibility mask chi(k_x)\n        propagating_mask = np.abs(kx) = k0\n        \n        # For evanescent waves, calculate attenuation rate alpha\n        alpha = kz.imag  # alpha = Im(k_z)  0 for evanescent waves\n        \n        # Evanescent accessibility condition: exp(-alpha * g) = t\n        # This is more numerically stable as -alpha*g = log(t)\n        # We need to handle alpha=0 to avoid issues.\n        # Only apply condition where alpha  0\n        evanescent_mask = np.abs(kx)  k0\n        evanescent_accessible_mask = np.zeros_like(kx, dtype=bool)\n        \n        # Filter for evanescent components to apply the condition\n        valid_evanescent_indices = np.where(evanescent_mask)[0]\n        if valid_evanescent_indices.size  0:\n            alpha_ev = alpha[valid_evanescent_indices]\n            # Use log inequality for better numerical stability with small t\n            # -alpha * g = log(t)  =  alpha * g = -log(t)\n            evanescent_accessible_mask[valid_evanescent_indices] = (alpha_ev * g = -np.log(t))\n\n        chi = propagating_mask | evanescent_accessible_mask\n\n        # 7. Compute the accessible power fraction P_acc\n        S_eff_power = np.abs(S_eff)**2\n        \n        total_power = np.sum(S_eff_power)\n        accessible_power = np.sum(S_eff_power[chi])\n\n        if total_power  0:\n            p_acc = accessible_power / total_power\n        else:\n            p_acc = 0.0\n\n        results.append(p_acc)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f'{r:.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The propagation of RF waves becomes particularly rich in plasmas containing more than one ion species, a common scenario in fusion experiments. This exercise delves into the physics of Ion Cyclotron Range of Frequencies (ICRF) heating in a two-species plasma, revealing the crucial role of the ion-ion hybrid resonance . Through a conceptual analysis of the plasma dielectric tensor, you will uncover the mechanism behind the highly effective \"minority heating\" scheme, where the presence of a small fraction of a second ion species creates a resonance that dramatically enhances local wave absorption.",
            "id": "3962795",
            "problem": "A uniform, cold, magnetized plasma with a static magnetic field $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ supports Radio Frequency (RF) waves. Consider a two-ion-species plasma composed of a majority ion species $i_1$ with charge $Z_1 e$ and mass $m_1$, and a minority ion species $i_2$ with charge $Z_2 e$ and mass $m_2$, along with electrons of charge $-e$ and mass $m_e$. Assume quasi-neutrality, linear response, and time-harmonic fields with frequency $\\omega$ and wave vector $\\mathbf{k}$ making an angle with $\\mathbf{B}_0$ such that the parallel refractive index $n_\\parallel \\equiv c k_\\parallel/\\omega$ is fixed and finite. Focus on the ion cyclotron range of frequencies (Ion Cyclotron Range of Frequencies (ICRF)) defined by $\\omega \\ll |\\Omega_e|$ where $\\Omega_s \\equiv Z_s e B_0/m_s$ is the cyclotron frequency of species $s$. Work in the cold-plasma dielectric description and the Stix basis, where the dielectric tensor components are $S$, $D$, and $P$, and the right- and left-handed permittivities are $R \\equiv S + D$ and $L \\equiv S - D$.\n\nStarting from Maxwell’s equations with the cold-plasma current closure, one obtains the general dispersion relation for electromagnetic waves in a uniform magnetized plasma. In the ion cyclotron range and for finite $n_\\parallel$, a slow wave branch exists whose perpendicular refractive index $n_\\perp \\equiv c k_\\perp/\\omega$ is governed by a dispersion relation of the form\n$$\nn_\\perp^2 = \\mathcal{F}(R, L, S; n_\\parallel^2),\n$$\nwhere $\\mathcal{F}$ is a rational function that is regular except when a resonance condition is met. The cold-plasma resonances relevant for the slow wave include: (i) species cyclotron resonances where $L$ has simple poles at $\\omega = \\Omega_s$ for left-hand polarization, and (ii) an ion–ion hybrid resonance where $n_\\perp^2 \\to \\infty$ when a condition of the form $S = n_\\parallel^2$ is satisfied.\n\nSpecialize to a deuterium–hydrogen plasma in the following parameter regime:\n- Majority: deuterium with $Z_1 = 1$, $m_1 = 2 m_p$, number density fraction $x_1 \\equiv n_1/n_e = 0.95$.\n- Minority: hydrogen with $Z_2 = 1$, $m_2 = m_p$, number density fraction $x_2 \\equiv n_2/n_e = 0.05$.\n- Electrons: $n_e = 5 \\times 10^{19} \\,\\mathrm{m^{-3}}$, $m_e \\ll m_i$ so that $\\omega \\ll |\\Omega_e|$.\n- Magnetic field: $B_0 = 3.5 \\,\\mathrm{T}$.\n- Parallel refractive index: $n_\\parallel^2 = 2$ (typical of Ion Cyclotron Resonance Heating (ICRH) antenna spectra).\n\nUsing the cold-plasma dielectric description and the assumptions above, reason from first principles to address the following:\n\n(1) Explain qualitatively, by analyzing the analytic structure of $L(\\omega)$ and $S(\\omega)$, why the slow wave branch exhibits mode splitting in frequency as $\\omega$ is swept across the interval between the deuterium and hydrogen cyclotron frequencies. In particular, identify how the poles in $L(\\omega)$ at $\\omega = \\Omega_{\\mathrm{D}}$ and $\\omega = \\Omega_{\\mathrm{H}}$, together with the condition for an ion–ion hybrid resonance of the form $S(\\omega) = n_\\parallel^2$, imply that the slow wave splits into separate branches separated by a resonance between $\\Omega_{\\mathrm{D}}$ and $\\Omega_{\\mathrm{H}}$.\n\n(2) Using ordering arguments valid for $\\omega \\ll |\\Omega_e|$ and $x_2 \\ll 1$, show that the ion–ion hybrid resonance frequency $\\omega_{\\mathrm{IIH}}$ lies between $\\Omega_{\\mathrm{D}}$ and $\\Omega_{\\mathrm{H}}$ and approaches the minority cyclotron frequency $\\Omega_{\\mathrm{H}}$ as $x_2 \\to 0$. You may invoke continuity of $S(\\omega)$ between its neighboring singularities and the intermediate value theorem to argue existence and location, but provide a clear step-by-step reasoning grounded in the cold-plasma expressions.\n\n(3) Minority single-pass absorption at a cyclotron layer scales as $\\alpha_s \\propto x_s |E_+|^2$ evaluated at $\\omega = \\Omega_s$, where $E_+$ is the left-hand circularly polarized component of the electric field. Using your conclusions from parts (1) and (2) about the position of $\\omega_{\\mathrm{IIH}}$ relative to $\\Omega_{\\mathrm{H}}$ and the polarization of the slow wave in the vicinity, predict which ion cyclotron resonance (majority or minority) will dominate power absorption for the parameters given.\n\nWhich statement best captures the correct physics?\n\nA. The slow wave splits into two branches separated by an ion–ion hybrid resonance located between $\\Omega_{\\mathrm{D}}$ and $\\Omega_{\\mathrm{H}}$; for small $x_2$, $\\omega_{\\mathrm{IIH}}$ lies close to $\\Omega_{\\mathrm{H}}$, enhancing $|E_+|$ near the minority layer. Therefore, minority absorption at $\\omega = \\Omega_{\\mathrm{H}}$ dominates.\n\nB. The slow wave does not split; absorption is shared equally between $\\omega = \\Omega_{\\mathrm{D}}$ and $\\omega = \\Omega_{\\mathrm{H}}$ irrespective of $x_2$ and $n_\\parallel$, because cold-plasma polarization is independent of composition.\n\nC. Mode splitting occurs, but because the deuterium density is larger, the majority resonance at $\\omega = \\Omega_{\\mathrm{D}}$ always dominates absorption, independent of the location of $\\omega_{\\mathrm{IIH}}$.\n\nD. Two hard cutoffs occur exactly at $\\omega = \\Omega_{\\mathrm{D}}$ and $\\omega = \\Omega_{\\mathrm{H}}$, prohibiting any resonance between them; minority heating is therefore impossible in a two-ion mixture at ICRF.",
            "solution": "The problem statement is a valid exercise in cold plasma wave theory, specifically concerning ion cyclotron resonance heating (ICRH) in a two-ion-species plasma. All provided data and assumptions are scientifically sound, consistent, and standard within the field of computational fusion science. The problem is well-posed and asks for an analysis of well-established physical phenomena. We may therefore proceed with the solution.\n\nThe analysis is broken down into the three parts requested by the problem statement, which collectively justify the choice of the correct option.\n\n### Part (1): Mode Splitting Analysis\n\nThe behavior of waves in the plasma is governed by the dispersion relation, which relates the wave frequency $\\omega$ to the wave vector $\\mathbf{k} = (k_\\perp, k_\\parallel)$. The problem focuses on the slow wave branch in the ion cyclotron range of frequencies (ICRF). The key quantities are the components of the cold plasma dielectric tensor, specifically the Stix parameters $S$, $L$, and $R$. For a plasma with electrons ($e$) and two ion species ($i_1$=deuterium D, $i_2$=hydrogen H), these are given by summing over all species $s$:\n$$ S = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2} \\quad , \\quad L = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)} $$\nwhere $\\omega_{ps} = \\sqrt{n_s Z_s^2 e^2 / (\\epsilon_0 m_s)}$ is the plasma frequency of species $s$ and $\\Omega_s = Z_s e B_0 / m_s$ is its cyclotron frequency. The given plasma consists of electrons, deuterium (D), and hydrogen (H). We have $\\Omega_H = eB_0/m_p$ and $\\Omega_D = eB_0/(2m_p)$, so $\\Omega_H = 2\\Omega_D$.\n\nIn the ICRF range, we assume $\\omega \\ll |\\Omega_e|$. The electron contributions to $S$ and $L$ can be approximated:\n$$ S(\\omega) \\approx 1 + \\frac{\\omega_{pe}^2}{\\Omega_e^2} - \\frac{\\omega_{pD}^2}{\\omega^2 - \\Omega_D^2} - \\frac{\\omega_{pH}^2}{\\omega^2 - \\Omega_H^2} $$\n$$ L(\\omega) \\approx 1 + \\frac{\\omega_{pe}^2}{\\omega|\\Omega_e|} - \\frac{\\omega_{pD}^2}{\\omega(\\omega - \\Omega_D)} - \\frac{\\omega_{pH}^2}{\\omega(\\omega - \\Omega_H)} $$\nNote that $\\Omega_e  0$. The terms $1 + \\omega_{pe}^2/\\Omega_e^2$ and $1 + \\omega_{pe}^2/(\\omega|\\Omega_e|)$ are large, positive background constants.\n\nLet's analyze the structure of these functions in the frequency interval $(\\Omega_D, \\Omega_H)$:\n1.  **Structure of $L(\\omega)$**: The function $L(\\omega)$ has simple poles at $\\omega = \\Omega_D$ and $\\omega = \\Omega_H$. As $\\omega$ approaches $\\Omega_D$ from above ($\\omega \\to \\Omega_D^+$), the term $-\\frac{\\omega_{pD}^2}{\\omega(\\omega - \\Omega_D)}$ dominates and goes to $-\\infty$. As $\\omega$ approaches $\\Omega_H$ from below ($\\omega \\to \\Omega_H^-$), the term $-\\frac{\\omega_{pH}^2}{\\omega(\\omega - \\Omega_H)}$ dominates and goes to $+\\infty$. Since $L(\\omega)$ is continuous between these poles, it must pass through zero at some frequency. A zero of $L(\\omega)$ corresponds to a cutoff for the left-hand circularly polarized wave ($L=0$ cutoff).\n\n2.  **Structure of $S(\\omega)$**: The function $S(\\omega)$ also has poles at $\\omega = \\Omega_D$ and $\\omega = \\Omega_H$. Similarly, as $\\omega \\to \\Omega_D^+$, $S(\\omega) \\to -\\infty$. As $\\omega \\to \\Omega_H^-$, $S(\\omega) \\to +\\infty$. Since $S(\\omega)$ is continuous and monotonically increasing on the interval $(\\Omega_D, \\Omega_H)$, it spans all real values from $-\\infty$ to $+\\infty$.\n\nThe problem states that the slow wave exhibits a resonance (where $n_\\perp^2 \\to \\infty$) when $S = n_\\parallel^2$. Given that $n_\\parallel^2=2$ is a finite value, the Intermediate Value Theorem guarantees that there exists a unique frequency $\\omega_{\\mathrm{IIH}} \\in (\\Omega_D, \\Omega_H)$ such that $S(\\omega_{\\mathrm{IIH}}) = n_\\parallel^2$. This is the ion-ion hybrid resonance.\n\nA \"mode\" or \"branch\" corresponds to a continuous range of frequencies where the wave can propagate, i.e., $n_\\perp^2  0$. The presence of a resonance at $\\omega_{\\mathrm{IIH}}$ and a cutoff (e.g., the $L=0$ cutoff, or others arising from the full dispersion relation) within the interval $(\\Omega_D, \\Omega_H)$ interrupts what might otherwise be a single continuous branch of the slow wave. Instead, the slow wave is \"split\" into separate branches. For instance, a low-frequency branch exists near $\\Omega_D$ and a high-frequency branch exists near $\\Omega_H$, but they are separated by an evanescent region ($n_\\perp^2  0$) around the resonance/cutoff pair. This explains the phenomenon of mode splitting.\n\n### Part (2): Location of the Ion-Ion Hybrid Resonance\n\nWe need to show that $\\omega_{\\mathrm{IIH}}$ is between $\\Omega_D$ and $\\Omega_H$ and that $\\omega_{\\mathrm{IIH}} \\to \\Omega_H$ as the minority fraction $x_2 = x_H \\to 0$.\n\nThe first part, $\\Omega_D  \\omega_{\\mathrm{IIH}}  \\Omega_H$, was established in Part (1) by applying the Intermediate Value Theorem to the function $S(\\omega)$ on this interval.\n\nFor the second part, let's analyze the resonance condition $S(\\omega) = n_\\parallel^2$ in the limit of small minority concentration ($x_H \\ll 1$, so $x_D \\approx 1$).\nThe condition is:\n$$ 1 + \\frac{\\omega_{pe}^2}{\\Omega_e^2} - \\frac{\\omega_{pD}^2}{\\omega^2 - \\Omega_D^2} - \\frac{\\omega_{pH}^2}{\\omega^2 - \\Omega_H^2} = n_\\parallel^2 $$\nLet's look for a solution near $\\omega = \\Omega_H$. Let $\\omega_{IIH} = \\Omega_H - \\delta\\omega$, where $\\delta\\omega$ is a small, positive frequency shift.\nThen $\\omega_{IIH}^2 - \\Omega_H^2 = (\\Omega_H - \\delta\\omega)^2 - \\Omega_H^2 \\approx -2\\Omega_H \\delta\\omega$.\nThe hydrogen (minority) term becomes:\n$$ \\frac{\\omega_{pH}^2}{\\omega_{IIH}^2 - \\Omega_H^2} \\approx -\\frac{\\omega_{pH}^2}{2\\Omega_H \\delta\\omega} $$\nThis term becomes very large as $\\delta\\omega \\to 0$. The other terms can be evaluated at $\\omega=\\Omega_H$ since they are not singular there.\nRearranging the resonance equation:\n$$ \\frac{\\omega_{pH}^2}{\\omega_{IIH}^2 - \\Omega_H^2} = 1 + \\frac{\\omega_{pe}^2}{\\Omega_e^2} - n_\\parallel^2 - \\frac{\\omega_{pD}^2}{\\Omega_H^2 - \\Omega_D^2} $$\nThe right-hand side is a constant with respect to $\\omega$. The term $\\omega_{pH}^2 = x_H n_e e^2 / (\\epsilon_0 m_H)$ is proportional to the minority fraction $x_H$. So we have:\n$$ \\omega_{IIH}^2 - \\Omega_H^2 = \\frac{\\omega_{pH}^2}{\\text{Constant}} \\propto x_H $$\nAs $x_H \\to 0$, the numerator on the right goes to zero. Therefore, $\\omega_{IIH}^2 - \\Omega_H^2 \\to 0$, which implies $\\omega_{IIH} \\to \\Omega_H$. The sign of the \"Constant\" term determines whether $\\omega_{IIH}$ is above or below $\\Omega_H$. A detailed calculation shows the denominator is negative, leading to $\\omega_{IIH}^2 - \\Omega_H^2  0$, so $\\omega_{IIH}$ approaches $\\Omega_H$ from below, consistent with the analysis in Part (1).\n\n### Part (3): Dominant Absorption Mechanism\n\nPower absorption by species $s$ at its cyclotron resonance, $\\omega = \\Omega_s$, is given to scale as $\\alpha_s \\propto x_s |E_+|^2$, where $E_+$ is the left-hand circularly polarized component of the wave electric field. We need to compare minority absorption $\\alpha_H \\propto x_H |E_+|^2$ at $\\omega = \\Omega_H$ with majority absorption $\\alpha_D \\propto x_D |E_+|^2$ at $\\omega = \\Omega_D$. The RF source frequency $\\omega$ is chosen for a specific heating scheme. The most common and effective scheme is minority heating, where we choose $\\omega \\approx \\Omega_H$.\n\nFrom Part (2), we established that for a small minority fraction $x_H$, the ion-ion hybrid resonance frequency $\\omega_{\\mathrm{IIH}}$ is very close to the minority cyclotron frequency $\\Omega_H$. The IIH resonance is associated with the slow wave, a wave which is predominantly left-hand circularly polarized (i.e., it has a very large $|E_+|$ component).\n\nWhen a fast wave is launched from an antenna at $\\omega \\approx \\Omega_H$, it propagates into the plasma. As it encounters the region where the local cyclotron frequency matches the source frequency, it also finds the IIH resonance layer in close proximity. This proximity facilitates efficient mode conversion from the incident fast wave to the slow wave. The resonant excitation of the slow wave leads to a dramatic enhancement of the local electric field, specifically the $|E_+|$ component.\n\nTherefore, at the minority resonance layer ($\\omega = \\Omega_H$), $|E_+|^2$ becomes very large. In the absorption scaling $\\alpha_H \\propto x_H |E_+|^2$, the large $|E_+|^2$ term more than compensates for the smallness of the density fraction $x_H$. In contrast, for majority heating at $\\omega=\\Omega_D$, there is no nearby fundamental resonance to enhance the wave fields in the same way, so $|E_+|^2$ remains modest. Consequently, even though $x_H \\ll x_D$, the absorption is dominated by the minority species: $\\alpha_H \\gg \\alpha_D$.\n\nThis phenomenon, where the presence of a small amount of a second ion species leads to strong absorption by that species, is the basis of the highly effective ICRH minority heating scheme.\n\n### Evaluation of Options\n\n*   **A. The slow wave splits into two branches separated by an ion–ion hybrid resonance located between $\\Omega_{\\mathrm{D}}$ and $\\Omega_{\\mathrm{H}}$; for small $x_2$, $\\omega_{\\mathrm{IIH}}$ lies close to $\\Omega_{\\mathrm{H}}$, enhancing $|E_+|$ near the minority layer. Therefore, minority absorption at $\\omega = \\Omega_{\\mathrm{H}}$ dominates.**\n    This statement accurately combines all the conclusions from our analysis. It correctly describes the mode splitting, the location of the ion-ion hybrid resonance, the resulting field enhancement, and the dominance of minority absorption. This statement is **Correct**.\n\n*   **B. The slow wave does not split; absorption is shared equally between $\\omega = \\Omega_{\\mathrm{D}}$ and $\\omega = \\Omega_{\\mathrm{H}}$ irrespective of $x_2$ and $n_\\parallel$, because cold-plasma polarization is independent of composition.**\n    This statement is incorrect on multiple grounds. The slow wave does split. Absorption is not shared equally. Plasma wave polarization is fundamentally dependent on plasma composition through the dielectric tensor elements. This statement is **Incorrect**.\n\n*   **C. Mode splitting occurs, but because the deuterium density is larger, the majority resonance at $\\omega = \\Omega_{\\mathrm{D}}$ always dominates absorption, independent of the location of $\\omega_{\\mathrm{IIH}}$.**\n    This statement correctly acknowledges mode splitting but draws an incorrect conclusion about absorption. It ignores the critical role of wave polarization enhancement near the ion-ion hybrid resonance, which is the dominant physical effect. The claim that absorption is independent of the location of $\\omega_{\\mathrm{IIH}}$ is false. This statement is **Incorrect**.\n\n*   **D. Two hard cutoffs occur exactly at $\\omega = \\Omega_{\\mathrm{D}}$ and $\\omega = \\Omega_{\\mathrm{H}}$, prohibiting any resonance between them; minority heating is therefore impossible in a two-ion mixture at ICRF.**\n    This statement confuses resonances with cutoffs and is factually wrong. Resonances, not cutoffs, occur at the cyclotron frequencies. The ion-ion hybrid resonance demonstrably exists between them. Minority heating is a well-established and effective heating method. This statement is **Incorrect**.\n\nThe only statement that correctly describes the physics is A.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}