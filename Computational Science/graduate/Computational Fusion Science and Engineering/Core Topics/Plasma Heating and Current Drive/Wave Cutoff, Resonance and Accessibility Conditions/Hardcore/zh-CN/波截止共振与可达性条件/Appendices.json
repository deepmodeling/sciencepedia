{
    "hands_on_practices": [
        {
            "introduction": "波与等离子体相互作用的最基本形式之一是波在截止点处的反射。本练习将引导你分析一个普通模（O-mode）波垂直入射到非均匀等离子体时的行为，这是一个经典的波传播转折点问题。通过运用 WKB 近似和艾里函数（Airy functions）来求解波动方程，你将亲自推导出波在无损耗介质中被完全反射的结论，从而对波的截止现象建立起坚实的物理直觉。",
            "id": "4064421",
            "problem": "一束角频率为 $\\omega$ 的普通电磁波（O模）从真空中正入射到一个磁约束聚变等离子体的边缘，该等离子体的电子密度 $n_{e}(x)$ 随位置坐标 $x$ 单调增加。该等离子体被模拟为具有静止离子的冷电子流体，且忽略了电子碰撞和热修正。背景磁场被视为均匀且与波电场方向一致，因此普通模式仅通过标量介电响应与电子密度相互作用。冷等离子体普通模式的介电常数可以用 Stix 参数 $P(x)$ 来表示，其定义为 $P(x) = 1 - \\omega_{pe}^{2}(x)/\\omega^{2}$，其中 $\\omega_{pe}(x) = \\sqrt{n_{e}(x) e^{2}/(\\epsilon_{0} m_{e})}$ 是局域电子等离子体频率，$e$ 是元电荷，$\\epsilon_{0}$ 是真空介电常数，$m_{e}$ 是电子质量。$P=0$ 层是 $P(x)$ 穿过零点的局域截止层。\n\n从色散介质中的 Maxwell 方程组和冷电子流体模型出发，推导控制垂直于界面的的一维传播的横向电场振幅 $E(x)$ 的标量常微分方程。然后，对于导致平滑非均匀性的单调密度斜坡，建立远离截止区的 $E(x)$ 的 Wentzel–Kramers–Brillouin (WKB) 解。将注意力集中在截止点 $x=0$ 的邻域，其中 $P(x)$ 可以被线性化为 $P(x) \\approx -\\alpha x$（$\\alpha>0$ 为常数），并使用一致近似来一致地处理转折点区域。施加从 $x0$ 入射的波和在 $x>0$ 处没有增长解的物理边界条件。\n\n在所述假设下，计算这种线性 $P(x)$ 分布的反射率，反射率定义为复反射系数的模平方。将最终反射率表示为无单位的纯数。无需四舍五入。",
            "solution": "本题要求计算一束普通电磁波入射到截止区附近具有线性密度分布的冷非磁化等离子体上的反射率。\n\n首先，我们从 Maxwell 方程组推导控制波动方程。对于角频率为 $\\omega$ 的时谐波，场可以写作 $\\vec{E}(\\vec{r}, t) = \\vec{E}(\\vec{r}) e^{-i\\omega t}$ 和 $\\vec{B}(\\vec{r}, t) = \\vec{B}(\\vec{r}) e^{-i\\omega t}$。在色散介质中，Maxwell 的旋度方程为：\n$$ \\nabla \\times \\vec{E} = i\\omega \\vec{B} $$\n$$ \\nabla \\times \\vec{B} = -i\\omega \\mu_0 \\epsilon_0 \\epsilon_r \\vec{E} $$\n其中 $\\epsilon_r$ 是相对介电常数。对于所述的普通模式（O模），波电场平行于背景磁场，等离子体响应是标量的。给定 $\\epsilon_r(x) = P(x)$，其中 $P(x) = 1 - \\omega_{pe}^2(x)/\\omega^2$ 是 Stix 参数。传播方向为 $x$ 方向，因此我们假设 $\\vec{E} = E(x)\\hat{z}$。\n\n对第一个方程取旋度并代入第二个方程，得到波动方程：\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = i\\omega (\\nabla \\times \\vec{B}) = i\\omega (-i\\omega \\mu_0 \\epsilon_0 P(x) \\vec{E}) = \\frac{\\omega^2}{c^2} P(x) \\vec{E} $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E}$，并注意到对于 $\\vec{E} = E(x)\\hat{z}$，我们有 $\\nabla \\cdot \\vec{E} = 0$。波动方程简化为：\n$$ -\\nabla^2 \\vec{E} = \\frac{\\omega^2}{c^2} P(x) \\vec{E} $$\n对于一维传播，这成为电场振幅 $E(x)$ 的标量常微分方程：\n$$ \\frac{d^2 E}{dx^2} + \\frac{\\omega^2}{c^2} P(x) E(x) = 0 $$\n这就是所要求的微分方程。\n\n题目指定，在截止层 $x=0$ 附近，等离子体分布可以线性化为 $P(x) \\approx -\\alpha x$，其中 $\\alpha>0$ 为常数。将此代入波动方程得到：\n$$ \\frac{d^2 E}{dx^2} - \\frac{\\omega^2 \\alpha}{c^2} x E(x) = 0 $$\n这个方程是 Airy 方程的一种形式。为了将其转换为标准形式 $y''(z) - z y(z) = 0$，我们引入一个无量纲变量 $z$：\n$$ z = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{1/3} x $$\n导数变换如下：\n$$ \\frac{d}{dx} = \\frac{dz}{dx}\\frac{d}{dz} = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{1/3} \\frac{d}{dz} $$\n$$ \\frac{d^2}{dx^2} = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2}{dz^2} $$\n将这些代入波动方程得到：\n$$ \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2 E}{dz^2} - \\frac{\\omega^2 \\alpha}{c^2} \\left(\\frac{c^2}{\\omega^2 \\alpha}\\right)^{1/3} z E(z) = 0 $$\n$$ \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2 E}{dz^2} - \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} z E(z) = 0 $$\n简化为 Airy 方程：\n$$ \\frac{d^2 E}{dz^2} - z E(z) = 0 $$\n该方程的通解是第一类和第二类 Airy 函数 $\\mathrm{Ai}(z)$ 和 $\\mathrm{Bi}(z)$ 的线性组合：\n$$ E(z) = c_1 \\mathrm{Ai}(z) + c_2 \\mathrm{Bi}(z) $$\n现在我们必须应用边界条件。对于 $x>0$，我们处于 $P(x)0$ 的渐逝区。这对应于 $z>0$。当 $z \\to +\\infty$ 时，Airy 函数的渐近行为是：\n$$ \\mathrm{Ai}(z) \\sim \\frac{1}{2\\sqrt{\\pi} z^{1/4}} \\exp\\left(-\\frac{2}{3} z^{3/2}\\right) \\quad (\\text{衰减解}) $$\n$$ \\mathrm{Bi}(z) \\sim \\frac{1}{\\sqrt{\\pi} z^{1/4}} \\exp\\left(+\\frac{2}{3} z^{3/2}\\right) \\quad (\\text{增长解}) $$\n物理边界条件规定，对于 $x>0$ 不应有增长解。这要求增长的 Bi 函数的系数为零，所以 $c_2 = 0$。因此，解与第一类 Airy 函数成正比：\n$$ E(z) = c_1 \\mathrm{Ai}(z) $$\n为了求得反射率，我们必须分析传播区域 $x0$ 中的解，这对应于 $z0$。当 $z \\to -\\infty$ 时，$\\mathrm{Ai}(z)$ 的渐近行为是：\n$$ \\mathrm{Ai}(z) \\sim \\frac{1}{\\sqrt{\\pi} (-z)^{1/4}} \\sin\\left(\\frac{2}{3}(-z)^{3/2} + \\frac{\\pi}{4}\\right) $$\n我们用复指数表示正弦函数，以分离入射波和反射波：\n$$ \\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i} $$\n令 $\\phi(z) = \\frac{2}{3}(-z)^{3/2}$。对于 $z0$，解为：\n$$ E(z) \\propto \\frac{1}{(-z)^{1/4}} \\frac{1}{2i} \\left[ \\exp\\left(i\\left(\\phi(z) + \\frac{\\pi}{4}\\right)\\right) - \\exp\\left(-i\\left(\\phi(z) + \\frac{\\pi}{4}\\right)\\right) \\right] $$\n$$ E(z) \\propto \\frac{1}{(-z)^{1/4}} \\left[ \\frac{e^{i\\pi/4}}{2i} e^{i\\phi(z)} - \\frac{e^{-i\\pi/4}}{2i} e^{-i\\phi(z)} \\right] $$\n我们识别入射波和反射波分量。沿 $+x$ 方向传播的波（入射波）具有 $\\exp(i\\int k dx)$ 形式的相位依赖关系。对于 $x0$，局域波数为 $k(x) = \\frac{\\omega}{c}\\sqrt{P(x)} = \\frac{\\omega}{c}\\sqrt{-\\alpha x}$。相位积分 $\\int_x^0 k(x')dx'$ 即为 $\\phi(z)$。因此，朝 $x=0$ 传播的波（入射波）的相位为 $\\exp(-i\\phi(z))$，而远离 $x=0$ 传播的波（反射波）的相位为 $\\exp(i\\phi(z))$。\n\n从 $E(z)$ 的渐近形式中，我们识别出复振幅：\n- 反射波的振幅（含 $e^{i\\phi(z)}$ 的项）为 $A_{refl} \\propto \\frac{e^{i\\pi/4}}{2i}$。\n- 入射波的振幅（含 $e^{-i\\phi(z)}$ 的项）为 $A_{inc} \\propto -\\frac{e^{-i\\pi/4}}{2i}$。\n\n复反射系数 $R$ 是反射振幅与入射振幅之比：\n$$ R = \\frac{A_{refl}}{A_{inc}} = \\frac{e^{i\\pi/4}/(2i)}{-e^{-i\\pi/4}/(2i)} = -\\frac{e^{i\\pi/4}}{e^{-i\\pi/4}} = -e^{i\\pi/2} $$\n因为 $e^{i\\pi/2} = i$，所以复反射系数为 $R = -i$。\n\n反射率 $\\mathcal{R}$ 定义为复反射系数的模的平方：\n$$ \\mathcal{R} = |R|^2 = |-i|^2 = 1 $$\n这个结果意味着全反射。这在物理上是预料之中的，因为该模型是无损的（没有碰撞或其他耗散机制），并且波入射到传播被禁止的截止区域（$P(x)0$），阻止了任何能量传输到 $x \\to \\infty$。因此，所有入射能量都必须被反射。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在截止点导致波被反射的基础上，当一个倏逝区被一个截止点和一个共振点同时包围时，波的传播行为会变得更加复杂。本练习探讨了波的隧穿效应，即波“穿透”这一势垒的能力，这是决定波能否进入等离子体核心进行加热或电流驱动的关键。你将通过推导一个决定透射率的隧穿参数 $\\tau$，亲手建立起它与等离子体密度梯度标长 $L_n$ 之间的定量关系，从而深刻理解波的可及性条件。",
            "id": "4064395",
            "problem": "一束角频率为 $\\omega$ 的平面静电低混杂（LH）慢波从真空入射到占据 $x \\ge 0$ 区域的半无限、磁化、冷双组分等离子体中。等离子体中存在沿 $\\hat{\\mathbf{z}}$ 方向的均匀磁场 $\\mathbf{B}_0$，以及一个固定的平行波数 $k_{\\parallel}$（沿 $\\mathbf{B}_0$ 方向）。在平板几何中，场包络 $\\psi(x)$ 满足在准静电近似下由麦克斯韦方程组得到的标量亥姆霍兹方程：\n$$\n\\frac{d^{2}\\psi}{dx^{2}} + k_{\\perp}^{2}(x)\\,\\psi \\;=\\; 0,\n$$\n其中 $k_{\\perp}^{2}(x) \\equiv k_{0}^{2}\\,n_{\\perp}^{2}(x)$ 且 $k_{0} \\equiv \\omega/c$。电子密度随 $x$ 单调递增，并具有局部恒定的密度梯度标长 $L_{n}$，其定义为 $L_{n} \\equiv \\left|\\frac{n_{e}}{dn_{e}/dx}\\right|$，并在下文指定的势垒中点处计算。假设满足低混杂波的频率排序 $\\omega_{ci} \\ll \\omega \\ll \\omega_{ce}$，离子和电子为冷的，并且 $k_{\\parallel}$ 在 $x$ 方向上是常数。\n\n对于给定的 $\\omega$ 和 $k_{\\parallel}$，冷等离子体慢波的垂直折射率平方 $n_{\\perp}^{2}(x)$ 表现出一个倏逝势垒，其边界分别为密度为 $n_{c1}$ 的截止和密度为 $n_{c2}$ 的共振，且 $n_{c1}  n_{c2}$。在这个单一的截止-共振对附近，可以通过对精确的冷等离子体纵向介电响应函数按密度进行泰勒展开，并对其两个邻近的零点进行因式分解，来构建一个对慢波色散关系一致有效的局域近似。这给出了一个二次模型：\n$$\nn_{\\perp}^{2}(x) \\;\\approx\\; -\\,C\\,\\bigl(n_{e}(x) - n_{c1}\\bigr)\\,\\bigl(n_{c2} - n_{e}(x)\\bigr),\n$$\n其中 $C>0$ 是一个参数，它依赖于 $\\omega$、$k_{\\parallel}$、$\\mathbf{B}_0$ 以及离子的荷质比，但在这个局域模型中，它在整个势垒范围内被视为常数。倏逝区对应于 $n_{c1}  n_{e}(x)  n_{c2}$。\n\n假设势垒区的密度剖面为线性：\n$$\nn_{e}(x) \\;=\\; n_{c1} + \\alpha\\,(x - x_{1}), \\quad \\text{其中} \\quad \\alpha \\equiv \\left.\\frac{dn_{e}}{dx}\\right|_{x_b} \\;=\\; \\frac{n_{b}}{L_{n}},\n$$\n其中 $x_{1}$ 是截止位置（$n_{e}=n_{c1}$），$x_{2}$ 是共振位置（$n_{e}=n_{c2}$），而 $x_{b} \\equiv \\frac{x_{1}+x_{2}}{2}$ 是势垒中点，在该点计算 $n_{b} \\equiv \\frac{n_{c1}+n_{c2}}{2}$ 和 $L_{n}$。令 $\\Delta n \\equiv n_{c2}-n_{c1}$。\n\n在半经典的 Wentzel–Kramers–Brillouin (WKB) 近似下，控制通过势垒透射的穿隧参数 $\\tau$ 为：\n$$\n\\tau \\;\\equiv\\; \\int_{x_{1}}^{x_{2}} \\kappa(x)\\,dx, \\quad \\kappa(x) \\equiv \\sqrt{-\\,k_{\\perp}^{2}(x)}.\n$$\n\n从一维亥姆霍兹方程、上述定义以及 WKB 框架出发，推导 $\\tau$ 作为 $L_{n}$、$k_{0}$、$C$、$n_{c1}$ 和 $n_{c2}$ 的函数的显式闭合形式解析表达式（你可以使用 $\\Delta n$ 和 $n_{b}$ 来简化符号）。你的推导必须清楚地表明密度梯度标长 $L_{n}$ 是如何进入结果的。\n\n将你得到的 $\\tau$ 的最终结果以单一闭合形式的解析表达式给出。不要将中间的不等式或方程作为最终答案。无需进行数值计算。",
            "solution": "经评估，该问题是有效的，因为它在科学上基于等离子体波理论的原理，并且提法恰当、客观、自洽且无矛盾。所做的假设，例如线性密度剖面和折射率的局域二次近似，是在该领域中为获得解析解而采用的标准建模选择。因此，我们可以进行推导。\n\n目标是计算 Wentzel–Kramers–Brillouin (WKB) 穿隧参数 $\\tau$，其定义为：\n$$\n\\tau \\equiv \\int_{x_{1}}^{x_{2}} \\kappa(x)\\,dx\n$$\n其中 $x_{1}$ 和 $x_{2}$ 分别是截止和共振的位置，$\\kappa(x)$ 是倏逝波数。倏逝波数由垂直波矢 $k_{\\perp}(x)$ 定义为 $\\kappa(x) \\equiv \\sqrt{-k_{\\perp}^{2}(x)}$。\n\n首先，我们使用给定的关系式来表达 $\\kappa(x)$。我们有 $k_{\\perp}^{2}(x) = k_{0}^{2}n_{\\perp}^{2}(x)$，所以：\n$$\n\\kappa(x) = \\sqrt{-k_{0}^{2}n_{\\perp}^{2}(x)} = k_{0}\\sqrt{-n_{\\perp}^{2}(x)}\n$$\n问题给出了在截止-共振对附近垂直折射率平方 $n_{\\perp}^{2}(x)$ 的一个局域二次近似：\n$$\nn_{\\perp}^{2}(x) \\approx -C(n_{e}(x) - n_{c1})(n_{c2} - n_{e}(x))\n$$\n其中 $C$ 是一个正常数，$n_{c1}$ 和 $n_{c2}$ 是截止和共振处的电子密度。倏逝区，其中 $\\kappa(x)$ 为实数，由 $n_{c1}  n_{e}(x)  n_{c2}$ 定义。在此区域内，因子 $(n_{e}(x) - n_{c1})$ 和 $(n_{c2} - n_{e}(x))$ 均为正，使得 $n_{\\perp}^{2}(x)$ 为负，这与倏逝波的预期相符。\n\n将此近似代入 $\\kappa(x)$ 的表达式中，得到：\n$$\n\\kappa(x) = k_{0}\\sqrt{-[-C(n_{e}(x) - n_{c1})(n_{c2} - n_{e}(x))]} = k_{0}\\sqrt{C}\\sqrt{(n_{e}(x) - n_{c1})(n_{c2} - n_{e}(x))}\n$$\n$\\tau$ 的积分是关于空间坐标 $x$ 的。为了计算该积分，我们必须将电子密度 $n_{e}(x)$ 表示为 $x$ 的函数。问题指明了势垒区的线性密度剖面：\n$$\nn_{e}(x) = n_{c1} + \\alpha(x - x_{1})\n$$\n其中 $\\alpha$ 是恒定的密度梯度。使用这个剖面，我们可以将被积函数中的项表示为 $x$ 的函数：\n第一项是 $n_{e}(x) - n_{c1} = \\alpha(x - x_{1})$。\n对于第二项，我们首先找到势垒的空间宽度 $x_{2} - x_{1}$ 和密度范围 $n_{c2} - n_{c1}$ 之间的关系。在共振位置 $x_{2}$，密度为 $n_{e}(x_{2}) = n_{c2}$。根据线性剖面：\n$$\nn_{c2} = n_{c1} + \\alpha(x_{2} - x_{1}) \\implies n_{c2} - n_{c1} = \\alpha(x_{2} - x_{1})\n$$\n利用这一点，第二项变为：\n$$\nn_{c2} - n_{e}(x) = n_{c2} - [n_{c1} + \\alpha(x - x_{1})] = (n_{c2} - n_{c1}) - \\alpha(x - x_{1}) = \\alpha(x_{2} - x_{1}) - \\alpha(x - x_{1}) = \\alpha(x_{2} - x)\n$$\n将这些表达式代回 $\\kappa(x)$ 中：\n$$\n\\kappa(x) = k_{0}\\sqrt{C}\\sqrt{[\\alpha(x - x_{1})][\\alpha(x_{2} - x)]} = k_{0}\\alpha\\sqrt{C}\\sqrt{(x - x_{1})(x_{2} - x)}\n$$\n现在，我们可以完全用 $x$ 来写出 $\\tau$ 的积分：\n$$\n\\tau = \\int_{x_{1}}^{x_{2}} k_{0}\\alpha\\sqrt{C}\\sqrt{(x - x_{1})(x_{2} - x)}\\,dx = k_{0}\\alpha\\sqrt{C} \\int_{x_{1}}^{x_{2}} \\sqrt{(x - x_{1})(x_{2} - x)}\\,dx\n$$\n剩下的定积分 $I = \\int_{x_{1}}^{x_{2}} \\sqrt{(x - x_{1})(x_{2} - x)}\\,dx$ 是一个标准形式。被积函数描述了一个圆的上半部分。我们可以通过配方法或三角代换来计算它。让我们对平方根内的参数进行配方：\n$$\n(x - x_{1})(x_{2} - x) = -x^{2} + (x_{1} + x_{2})x - x_{1}x_{2} = -\\left[x - \\frac{x_{1}+x_{2}}{2}\\right]^{2} + \\left(\\frac{x_{1}+x_{2}}{2}\\right)^{2} - x_{1}x_{2} = \\left(\\frac{x_{2}-x_{1}}{2}\\right)^{2} - \\left[x - \\frac{x_{1}+x_{2}}{2}\\right]^{2}\n$$\n令 $R = \\frac{x_{2}-x_{1}}{2}$ 为半径， $x_{c} = \\frac{x_{1}+x_{2}}{2}$ 为圆心。积分为 $\\int_{x_{c}-R}^{x_{c}+R} \\sqrt{R^{2} - (x-x_{c})^{2}} \\,dx$。这个积分代表了半径为 $R$ 的半圆的面积，即 $\\frac{1}{2}\\pi R^{2}$。\n因此，该积分的值为：\n$$\nI = \\frac{1}{2}\\pi\\left(\\frac{x_{2}-x_{1}}{2}\\right)^{2} = \\frac{\\pi}{8}(x_{2}-x_{1})^{2}\n$$\n现在，将此结果代回 $\\tau$ 的表达式中：\n$$\n\\tau = k_{0}\\alpha\\sqrt{C} \\left( \\frac{\\pi}{8}(x_{2}-x_{1})^{2} \\right)\n$$\n我们需要用给定的物理参数来表示这个结果。使用关系式 $\\Delta n \\equiv n_{c2} - n_{c1} = \\alpha(x_{2} - x_{1})$，我们可以写出 $x_{2} - x_{1} = \\frac{\\Delta n}{\\alpha}$。\n$$\n\\tau = \\frac{\\pi}{8} k_{0}\\alpha\\sqrt{C} \\left(\\frac{\\Delta n}{\\alpha}\\right)^{2} = \\frac{\\pi}{8} k_{0}\\sqrt{C} \\frac{(\\Delta n)^{2}}{\\alpha}\n$$\n最后一步是代入密度梯度 $\\alpha$ 的表达式。问题指出 $\\alpha$ 与在势垒中点 $x_{b}$（该点密度为 $n_{b} = \\frac{n_{c1}+n_{c2}}{2}$）处计算的密度梯度标长 $L_{n}$ 相关。其定义为 $\\alpha = \\frac{n_{b}}{L_{n}}$。\n将 $\\alpha$ 代入 $\\tau$ 的表达式中：\n$$\n\\tau = \\frac{\\pi}{8} k_{0}\\sqrt{C} \\frac{(\\Delta n)^{2}}{n_{b}/L_{n}} = \\frac{\\pi}{8} k_{0}\\sqrt{C} \\frac{L_{n}(\\Delta n)^{2}}{n_{b}}\n$$\n最后，我们将 $\\Delta n$ 和 $n_{b}$ 用 $n_{c1}$ 和 $n_{c2}$ 表示：\n$$\n\\Delta n = n_{c2} - n_{c1}\n$$\n$$\nn_{b} = \\frac{n_{c1} + n_{c2}}{2}\n$$\n将这些代入 $\\tau$ 的表达式中：\n$$\n\\tau = \\frac{\\pi}{8} k_{0}\\sqrt{C} \\frac{L_{n}(n_{c2} - n_{c1})^{2}}{(n_{c1} + n_{c2})/2} = \\frac{\\pi}{4} k_{0}\\sqrt{C} L_{n} \\frac{(n_{c2} - n_{c1})^{2}}{n_{c1} + n_{c2}}\n$$\n这就是穿隧参数 $\\tau$ 作为指定参数的函数的最终闭合形式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\pi k_{0} \\sqrt{C} L_{n} (n_{c2} - n_{c1})^{2}}{4(n_{c1} + n_{c2})}}\n$$"
        },
        {
            "introduction": "理论分析往往依赖于简化的剖面模型，而要评估波在真实聚变装置中的可及性，则必须借助计算方法。本练习将理论付诸实践，要求你编写一个程序来系统性地寻找反常模（X-mode）波在给定密度和磁场剖面下的截止点与共振点位置。通过这项计算实践，你将掌握确定波传播路径和核心可及性的实用技能，完美连接了理论物理与计算科学。",
            "id": "4064462",
            "problem": "要求您编写一个完整的、可运行的程序，用于沿从等离子体边界到核心的一维径向路径，判断一个在冷磁化等离子体中的异常电磁波（即所谓的 X 模）首先遇到以下哪个事件：右手截止（R-截止）、左手截止（L-截止）或上混杂共振（UHR）。假设波严格垂直于局部磁场传播。该判断必须纯粹基于冷等离子体介电响应的第一性原理。任务是给定电子密度和磁场的解析剖面以及指定的波频率，确定色散关系的这些特征中哪一个首先出现在沿从边界到核心路径上的最小归一化半径处。\n\n请从以下经过充分检验的冷电子-离子等离子体和垂直波传播的基础关系式开始：\n- 电子等离子体频率定义为 $ \\omega_{pe}(r) = \\sqrt{ \\dfrac{n_{e}(r) e^{2}}{\\varepsilon_{0} m_{e}} } $，其中 $ n_{e}(r) $ 是电子数密度，$ e $ 是基本电荷，$ \\varepsilon_{0} $ 是真空介电常数，$ m_{e} $ 是电子质量。\n- 电子回旋频率为 $ \\omega_{ce}(r) = \\dfrac{e B(r)}{m_{e}} $，其中 $ B(r) $ 是磁场强度。\n- 定义无量纲参数 $ X(r) = \\dfrac{\\omega_{pe}^{2}(r)}{\\omega^{2}} $ 和 $ Y(r) = \\dfrac{\\omega_{ce}(r)}{\\omega} $，其中 $ \\omega = 2 \\pi f $ 是给定频率 $ f $ 的波角频率。\n- 冷等离子体 Stix 参数为 $ R(r) = 1 - \\dfrac{X(r)}{1 + Y(r)} $，$ L(r) = 1 - \\dfrac{X(r)}{1 - Y(r)} $，以及 $ S(r) = 1 - \\dfrac{X(r)}{1 - Y^{2}(r)} $。\n- 对于垂直传播，X 模色散关系可以写成 $ n^{2}(r) = \\dfrac{R(r) L(r)}{S(r)} $，其中 $ n^{2}(r) $ 是折射率的平方。当 $ n^{2}(r) = 0 $ 时（即 $ R(r) = 0 $ 或 $ L(r) = 0 $），达到截止；当 $ n^{2}(r) \\to \\infty $ 时（即 $ S(r) = 0 $），发生共振。\n\n在这些定义下，事件条件可以重新表述为找到最小的归一化半径 $ \\rho \\in [0, 1] $，使得以下等式之一成立：\n- R-截止条件：$ X(\\rho) = 1 + Y(\\rho) $。\n- L-截止条件：$ X(\\rho) = 1 - Y(\\rho) $，其物理有效域为 $ 1 - Y(\\rho)  0 $。\n- 上混杂共振条件：$ X(\\rho) = 1 - Y^{2}(\\rho) $，其物理有效域为 $ 1 - Y^{2}(\\rho)  0 $。\n\n您必须实现一个数值程序，从 $ \\rho = 0 $ 处的等离子体边界扫描到 $ \\rho = 1 $ 处的核心，并确定首先发生哪个事件（如果有的话）。如果在 $ \\rho \\in [0, 1] $ 上未找到任何事件，则返回代码“none”。\n\n使用以下建模假设和定义：\n- 径向坐标是归一化半径 $ \\rho \\in [0, 1] $。\n- 密度和磁场剖面是解析的，定义为\n  - $ n_{e}(\\rho) = n_{\\text{edge}} + \\left( n_{\\text{core}} - n_{\\text{edge}} \\right) \\rho^{p} $，\n  - $ B(\\rho) = B_{\\text{edge}} + \\left( B_{\\text{core}} - B_{\\text{edge}} \\right) \\rho^{q} $，\n  其中 $ n_{\\text{edge}} $、$ n_{\\text{core}} $、$ B_{\\text{edge}} $、$ B_{\\text{core}} $、$ p $ 和 $ q $ 是每个测试用例的给定参数。\n- 使用真空介电常数 $ \\varepsilon_{0} $（单位：法拉/米）、电子质量 $ m_{e} $（单位：千克）、基本电荷 $ e $（单位：库仑）、磁场 $ B $（单位：特斯拉）、频率 $ f $（单位：赫兹）和密度 $ n_{e} $（单位：每立方米）。所有计算都必须在国际单位制（SI）中进行。\n\n您的程序必须：\n- 对每个测试用例，计算 $ \\omega = 2 \\pi f $，然后在从 $ \\rho = 0 $ 到 $ \\rho = 1 $ 的路径上评估 $ X(\\rho) $ 和 $ Y(\\rho) $。\n- 确定在满足其有效域的情况下，事件条件之一被满足的最小 $ \\rho $ 值。\n- 每个测试用例返回一个整数代码，指示遇到的第一个事件：\n  - $ 1 $ 如果第一个事件是 R-截止，\n  - $ 2 $ 如果第一个事件是 L-截止，\n  - $ 3 $ 如果第一个事件是上混杂共振，\n  - $ 0 $ 如果在 $ \\rho \\in [0, 1] $ 上未找到任何事件。\n\n您必须在足够精细的网格上实现一个数值上稳健的区间套定程序，以在以下函数中找到第一个根：\n- $ \\varphi_{R}(\\rho) = X(\\rho) - \\left( 1 + Y(\\rho) \\right) $，\n- $ \\varphi_{L}(\\rho) = X(\\rho) - \\left( 1 - Y(\\rho) \\right) $，在 $ 1 - Y(\\rho)  0 $ 时有效，\n- $ \\varphi_{UH}(\\rho) = X(\\rho) - \\left( 1 - Y^{2}(\\rho) \\right) $，在 $ 1 - Y^{2}(\\rho)  0 $ 时有效。\n对于每个具有有效域的 $ \\varphi(\\rho) $，您只能考虑其有效域内的根。对于每个函数，识别符号首次改变或首次出现零的最小 $ \\rho $，并通过二分法或线性插值在包围区间上精确化根的位置。然后在找到的事件中选择具有最小 $ \\rho $ 的那个。\n\n测试套件：\n- 情况 $ 1 $（在典型的电子回旋共振加热方案中，预期首先出现 L-截止）：\n  - $ f = 110 \\times 10^{9} \\, \\text{Hz} $，\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $，$ n_{\\text{core}} = 1.0 \\times 10^{20} \\, \\text{m}^{-3} $，\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $，$ B_{\\text{core}} = 2.4 \\, \\text{T} $，\n  - $ p = 2 $，$ q = 1 $。\n- 情况 $ 2 $（对于相对于回旋频率较低的波，预期首先出现 R-截止）：\n  - $ f = 20 \\times 10^{9} \\, \\text{Hz} $，\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $，$ n_{\\text{core}} = 5.0 \\times 10^{19} \\, \\text{m}^{-3} $，\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $，$ B_{\\text{core}} = 2.4 \\, \\text{T} $，\n  - $ p = 2 $，$ q = 1 $。\n- 情况 $ 3 $（一个在区间内没有事件的边缘情况）：\n  - $ f = 170 \\times 10^{9} \\, \\text{Hz} $，\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $，$ n_{\\text{core}} = 3.0 \\times 10^{19} \\, \\text{m}^{-3} $，\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $，$ B_{\\text{core}} = 2.4 \\, \\text{T} $，\n  - $ p = 2 $，$ q = 1 $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为方括号内以逗号分隔的列表，按三个测试用例的顺序排列，例如 $ [r_{1}, r_{2}, r_{3}] $。每个 $ r_{i} $ 必须是上面定义的 $ 0 $、$ 1 $、$ 2 $ 或 $ 3 $ 之一。不应打印任何其他文本。",
            "solution": "该问题要求确定一个在冷磁化等离子体中垂直于磁场传播的异常（X模）电磁波遇到的第一个波-粒子相互作用事件——截止或共振。等离子体的特征由电子密度 $n_e(\\rho)$ 和磁场强度 $B(\\rho)$ 的一维径向剖面描述，其中 $ \\rho \\in [0, 1] $ 是从边界到核心的归一化半径。\n\n首先，我们使用所提供的物理原理来形式化该问题。冷等离子体相对于波的状态由两个无量纲参数描述：\n- $X(\\rho) = \\dfrac{\\omega_{pe}^2(\\rho)}{\\omega^2}$，它比较了局部电子等离子体频率 $\\omega_{pe}$ 与恒定的波频率 $\\omega$。\n- $Y(\\rho) = \\dfrac{\\omega_{ce}(\\rho)}{\\omega}$，它比较了局部电子回旋频率 $\\omega_{ce}$ 与波频率 $\\omega$。\n\n电子等离子体频率 $\\omega_{pe}(\\rho)$ 取决于电子密度 $n_e(\\rho)$，关系为 $\\omega_{pe}^2(\\rho) = \\frac{n_e(\\rho) e^2}{\\varepsilon_0 m_e}$。电子回旋频率 $\\omega_{ce}(\\rho)$ 取决于磁场 $B(\\rho)$，关系为 $\\omega_{ce}(\\rho) = \\frac{e B(\\rho)}{m_e}$。给定的解析剖面为：\n$$\nn_{e}(\\rho) = n_{\\text{edge}} + \\left( n_{\\text{core}} - n_{\\text{edge}} \\right) \\rho^{p}\n$$\n$$\nB(\\rho) = B_{\\text{edge}} + \\left( B_{\\text{core}} - B_{\\text{edge}} \\right) \\rho^{q}\n$$\n其中 $n_{\\text{edge}}$、$n_{\\text{core}}$、$B_{\\text{edge}}$、$B_{\\text{core}}$、$p$ 和 $q$ 是指定的参数。对于给定的频率 $f$，波的角频率为 $\\omega = 2\\pi f$。所有计算均使用国际单位制（SI），并采用基本电荷 $e$、电子质量 $m_e$ 和真空介电常数 $\\varepsilon_0$ 的基本常数。\n\n对于垂直于磁场传播的 X 模，色散关系由 $n^2(\\rho) = \\frac{R(\\rho)L(\\rho)}{S(\\rho)}$ 给出，其中 $R$、$L$ 和 $S$ 是 Stix 参数。\n- 当折射率 $n \\to 0$ 时发生**截止**，这意味着 $R(\\rho)=0$ 或 $L(\\rho)=0$。\n- 当 $n \\to \\infty$ 时发生**共振**，这意味着 $S(\\rho)=0$。\n\n这些条件用 $X(\\rho)$ 和 $Y(\\rho)$ 明确定义如下：\n1.  **右手（R）截止（$R=0$）：** $X(\\rho) = 1 + Y(\\rho)$。我们定义函数 $\\varphi_R(\\rho) = X(\\rho) - (1 + Y(\\rho))$ 并寻找其在 $\\rho \\in [0, 1]$ 中的最小根。\n2.  **左手（L）截止（$L=0$）：** $X(\\rho) = 1 - Y(\\rho)$。我们定义 $\\varphi_L(\\rho) = X(\\rho) - (1 - Y(\\rho))$。此条件仅在右侧为正时物理有效，即 $1 - Y(\\rho) > 0$。仅在此有效域内寻找根。\n3.  **上混杂共振（UHR, $S=0$）：** $X(\\rho) = 1 - Y^2(\\rho)$。我们定义 $\\varphi_{UH}(\\rho) = X(\\rho) - (1 - Y^2(\\rho))$。此条件仅在 $1 - Y^2(\\rho) > 0$ 时有效。仅在此有效域内寻找根。\n\n任务是找到满足这三个方程中任何一个的最小 $\\rho \\in [0, 1]$，且该值在其各自的有效域内。\n\n算法方法如下：\n1.  对于每个测试用例，使用物理和剖面参数构造函数 $X(\\rho)$ 和 $Y(\\rho)$。根据这些，定义三个事件函数 $\\varphi_R(\\rho)$、$\\varphi_L(\\rho)$ 和 $\\varphi_{UH}(\\rho)$，以及 $\\varphi_L$ 和 $\\varphi_{UH}$ 的有效性条件。\n2.  实现一个数值求根程序，以找到每个函数 $\\varphi(\\rho)$ 在区间 $[0, 1]$ 上的最小根。此过程封装在函数 `find_smallest_root` 中，通过首先将区间 $\\rho \\in [0, 1]$ 离散化为一个精细的网格（例如，$1000$ 个子区间）来操作。\n3.  从 $\\rho=0$ 到 $\\rho=1$ 扫描网格。对于每个子区间 $[\\rho_i, \\rho_{i+1}]$，我们首先检查该区间是否在函数的有效域内。如果是，我们计算函数在端点处的值。符号变化，即 $\\varphi(\\rho_i) \\cdot \\varphi(\\rho_{i+1}) \\le 0$，表示在该子区间内套定了一个根。\n4.  找到第一个这样的区间后，调用一个更精确的数值求解器。我们使用 Brent 方法，如 `scipy.optimize.brentq` 中所实现的，它是一个稳健且高效的算法，结合了二分法、割线法和逆二次插值，以高精度在套定的区间内找到根。\n5.  独立应用此过程，为三种事件分别找到最小的有效根：$\\rho_R$、$\\rho_L$ 和 $\\rho_{UH}$。如果某个特定事件函数在 $[0, 1]$ 中没有有效根，则其结果被视为无穷大。\n6.  比较已识别的根：$\\rho_{first} = \\min(\\rho_R, \\rho_L, \\rho_{UH})$。与 $\\rho_{first}$ 对应的事件是波首先遇到的事件。记录此事件的整数代码（$1$ 表示 R-截止，$2$ 表示 L-截止，$3$ 表示 UHR）。\n7.  如果在区间 $[0, 1]$ 中未找到任何三种事件的有效根，则结果为“无”，由代码 $0$ 表示。\n\n该方法通过系统地数值求解控制方程，并遵守所有指定的约束和物理有效域，为确定第一个波相互作用事件提供了一个稳健且物理上正确的解决方案。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes which event (R-cutoff, L-cutoff, or UHR) an X-mode wave \n    encounters first along a radial path in a plasma.\n    \"\"\"\n    \n    # Fundamental physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kilograms\n    EPSILON_0 = 8.8541878128e-12   # Vacuum permittivity in F/m\n\n    # Pre-calculated combinations of constants for efficiency\n    E2_OVER_EPS0_ME = E_CHARGE**2 / (EPSILON_0 * M_ELECTRON)\n    E_OVER_ME = E_CHARGE / M_ELECTRON\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        # Case 1: Expecting L-cutoff (2)\n        {'f': 110e9, 'n_edge': 1.0e18, 'n_core': 1.0e20, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n        # Case 2: Expecting R-cutoff (1)\n        {'f': 20e9, 'n_edge': 1.0e18, 'n_core': 5.0e19, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n        # Case 3: Expecting no event (0)\n        {'f': 170e9, 'n_edge': 1.0e18, 'n_core': 3.0e19, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n    ]\n\n    def find_smallest_root(func, validity_func, rho_min=0.0, rho_max=1.0, grid_points=1001):\n        \"\"\"\n        Finds the smallest root of a function `func` on [rho_min, rho_max]\n        where `validity_func` returns True.\n        \n        Args:\n            func: The function for which to find a root.\n            validity_func: A function that returns True if func is physically valid at a given rho.\n            rho_min, rho_max: The search interval.\n            grid_points: The number of points to use for the initial grid scan.\n\n        Returns:\n            The smallest root found, or None if no root is found.\n        \"\"\"\n        rhos = np.linspace(rho_min, rho_max, grid_points)\n        \n        # Check the very first point separately\n        if validity_func(rhos[0]) and func(rhos[0]) == 0:\n            return rhos[0]\n        \n        val_prev = None\n        if validity_func(rhos[0]):\n            val_prev = func(rhos[0])\n            \n        for i in range(1, len(rhos)):\n            rho_prev, rho_curr = rhos[i-1], rhos[i]\n            \n            is_valid_curr = validity_func(rho_curr)\n            is_valid_prev = val_prev is not None\n\n            if not (is_valid_prev and is_valid_curr):\n                val_prev = func(rho_curr) if is_valid_curr else None\n                continue\n            \n            val_curr = func(rho_curr)\n\n            # A sign change indicates a bracketed root\n            if val_prev * val_curr = 0:\n                try:\n                    root = brentq(func, rho_prev, rho_curr)\n                    return root\n                except ValueError:\n                    # This can happen if one of the endpoints is exactly zero,\n                    # or if signs are not opposite due to floating point issues.\n                    if val_prev == 0: return rho_prev\n                    if val_curr == 0: return rho_curr\n                    # otherwise, it might be a grazing contact, continue search\n            \n            val_prev = val_curr\n            \n        return None\n\n    results = []\n    for params in test_cases:\n        omega = 2 * np.pi * params['f']\n\n        # Define profile and dimensionless parameter functions for the current case\n        def n_e(rho): return params['n_edge'] + (params['n_core'] - params['n_edge']) * rho**params['p']\n        def B(rho): return params['B_edge'] + (params['B_core'] - params['B_edge']) * rho**params['q']\n        def X(rho): return (n_e(rho) * E2_OVER_EPS0_ME) / omega**2\n        def Y(rho): return (B(rho) * E_OVER_ME) / omega\n\n        # Define the three event functions phi(rho) = 0\n        def phi_R(rho): return X(rho) - (1 + Y(rho))\n        def phi_L(rho): return X(rho) - (1 - Y(rho))\n        def phi_UH(rho): return X(rho) - (1 - Y(rho)**2)\n\n        # Define validity functions for L-cutoff and UHR\n        def valid_L(rho): return 1 - Y(rho) > 0\n        def valid_UH(rho): return 1 - Y(rho)**2 > 0\n        def valid_always(rho): return True\n\n        # Find the smallest root for each event type\n        root_R = find_smallest_root(phi_R, valid_always)\n        root_L = find_smallest_root(phi_L, valid_L)\n        root_UH = find_smallest_root(phi_UH, valid_UH)\n\n        # Collect all found valid roots with their corresponding event codes\n        found_events = []\n        if root_R is not None: found_events.append((root_R, 1))  # 1: R-cutoff\n        if root_L is not None: found_events.append((root_L, 2))  # 2: L-cutoff\n        if root_UH is not None: found_events.append((root_UH, 3)) # 3: UHR\n\n        # Determine the first event\n        if not found_events:\n            results.append(0)  # 0: No event found\n        else:\n            # The first event is the one with the minimum rho\n            first_event = min(found_events, key=lambda item: item[0])\n            results.append(first_event[1])\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}