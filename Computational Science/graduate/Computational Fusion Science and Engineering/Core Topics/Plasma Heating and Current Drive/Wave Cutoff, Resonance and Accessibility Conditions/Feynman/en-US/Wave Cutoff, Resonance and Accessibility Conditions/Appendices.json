{
    "hands_on_practices": [
        {
            "introduction": "This first exercise explores the most fundamental interaction between a wave and a plasma: reflection from a cutoff. We will analyze an ordinary (O-mode) wave incident on a plasma density ramp, a scenario that isolates the effect of the plasma frequency cutoff where the Stix parameter $P$ vanishes. By solving the wave equation using the Wentzel–Kramers–Brillouin (WKB) approximation and treating the turning point with Airy functions, you will demonstrate from first principles why a lossless plasma totally reflects waves below the local plasma frequency .",
            "id": "4064421",
            "problem": "An ordinary electromagnetic wave (O-mode) of fixed angular frequency $\\omega$ is incident normally from vacuum onto the edge of a magnetically confined fusion plasma whose electron density $n_{e}(x)$ increases monotonically with the position coordinate $x$. The plasma is modeled as a cold electron fluid with immobile ions, and electron collisions and thermal corrections are neglected. The background magnetic field is taken to be uniform and aligned with the wave electric field so that the ordinary mode interacts only with the electron density via the scalar dielectric response. The cold-plasma ordinary-mode permittivity can be expressed in terms of the Stix parameter $P(x)$, defined by $P(x) = 1 - \\omega_{pe}^{2}(x)/\\omega^{2}$, where $\\omega_{pe}(x) = \\sqrt{n_{e}(x) e^{2}/(\\epsilon_{0} m_{e})}$ is the local electron plasma frequency, $e$ is the elementary charge, $\\epsilon_{0}$ is the vacuum permittivity, and $m_{e}$ is the electron mass. The $P=0$ layer is the local cutoff where $P(x)$ passes through zero.\n\nStarting from Maxwell’s equations in a dispersive medium and the cold electron fluid model, derive the scalar ordinary differential equation for the transverse electric field amplitude $E(x)$ governing one-dimensional propagation normal to the interface. Then, for a monotonic density ramp resulting in a smooth inhomogeneity, set up the Wentzel–Kramers–Brillouin (WKB) solution for $E(x)$ away from the cutoff. Focus attention on a neighborhood of the cutoff $x=0$ where $P(x)$ can be linearized as $P(x) \\approx -\\alpha x$ with $\\alpha0$ constant, and use a uniform approximation to treat the turning-point region consistently. Impose the physical boundary condition of an incident wave from $x0$ and no growing solution for $x>0$.\n\nEvaluate the reflectivity, defined as the squared magnitude of the complex reflection coefficient, for this linear $P(x)$ profile under the stated assumptions. Express the final reflectivity as a pure number without units. No rounding is required.",
            "solution": "The problem asks for the reflectivity of an ordinary electromagnetic wave incident on a cold, unmagnetized plasma with a linear density profile near the cutoff.\n\nFirst, we derive the governing wave equation from Maxwell's equations. For a time-harmonic wave with angular frequency $\\omega$, the fields are written as $\\vec{E}(\\vec{r}, t) = \\vec{E}(\\vec{r}) e^{-i\\omega t}$ and $\\vec{B}(\\vec{r}, t) = \\vec{B}(\\vec{r}) e^{-i\\omega t}$. Maxwell's curl equations in a dispersive medium are:\n$$ \\nabla \\times \\vec{E} = i\\omega \\vec{B} $$\n$$ \\nabla \\times \\vec{B} = -i\\omega \\mu_0 \\epsilon_0 \\epsilon_r \\vec{E} $$\nwhere $\\epsilon_r$ is the relative permittivity. For the ordinary mode (O-mode) described, the wave electric field is parallel to the background magnetic field, and the plasma response is scalar. We are given $\\epsilon_r(x) = P(x)$, where $P(x) = 1 - \\omega_{pe}^2(x)/\\omega^2$ is the Stix parameter. The propagation is in the $x$-direction, so we assume $\\vec{E} = E(x)\\hat{z}$.\n\nTaking the curl of the first equation and substituting the second gives the wave equation:\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = i\\omega (\\nabla \\times \\vec{B}) = i\\omega (-i\\omega \\mu_0 \\epsilon_0 P(x) \\vec{E}) = \\frac{\\omega^2}{c^2} P(x) \\vec{E} $$\nUsing the vector identity $\\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E}$ and noting that for $\\vec{E} = E(x)\\hat{z}$, we have $\\nabla \\cdot \\vec{E} = 0$. The wave equation simplifies to:\n$$ -\\nabla^2 \\vec{E} = \\frac{\\omega^2}{c^2} P(x) \\vec{E} $$\nFor one-dimensional propagation, this becomes a scalar ordinary differential equation for the electric field amplitude $E(x)$:\n$$ \\frac{d^2 E}{dx^2} + \\frac{\\omega^2}{c^2} P(x) E(x) = 0 $$\nThis is the required differential equation.\n\nThe problem specifies that near the cutoff layer at $x=0$, the plasma profile can be linearized as $P(x) \\approx -\\alpha x$ for a constant $\\alpha>0$. Substituting this into the wave equation yields:\n$$ \\frac{d^2 E}{dx^2} - \\frac{\\omega^2 \\alpha}{c^2} x E(x) = 0 $$\nThis equation is a form of the Airy equation. To transform it into the canonical form $y''(z) - z y(z) = 0$, we introduce a dimensionless variable $z$:\n$$ z = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{1/3} x $$\nThe derivatives transform as:\n$$ \\frac{d}{dx} = \\frac{dz}{dx}\\frac{d}{dz} = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{1/3} \\frac{d}{dz} $$\n$$ \\frac{d^2}{dx^2} = \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2}{dz^2} $$\nSubstituting these into the wave equation gives:\n$$ \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2 E}{dz^2} - \\frac{\\omega^2 \\alpha}{c^2} \\left(\\frac{c^2}{\\omega^2 \\alpha}\\right)^{1/3} z E(z) = 0 $$\n$$ \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} \\frac{d^2 E}{dz^2} - \\left(\\frac{\\omega^2 \\alpha}{c^2}\\right)^{2/3} z E(z) = 0 $$\nwhich simplifies to the Airy equation:\n$$ \\frac{d^2 E}{dz^2} - z E(z) = 0 $$\nThe general solution to this equation is a linear combination of the Airy functions of the first and second kind, $\\mathrm{Ai}(z)$ and $\\mathrm{Bi}(z)$:\n$$ E(z) = c_1 \\mathrm{Ai}(z) + c_2 \\mathrm{Bi}(z) $$\nWe must now apply the boundary conditions. For $x>0$, we are in the evanescent region where $P(x)0$. This corresponds to $z>0$. The asymptotic behaviors of the Airy functions for $z \\to +\\infty$ are:\n$$ \\mathrm{Ai}(z) \\sim \\frac{1}{2\\sqrt{\\pi} z^{1/4}} \\exp\\left(-\\frac{2}{3} z^{3/2}\\right) \\quad (\\text{decaying solution}) $$\n$$ \\mathrm{Bi}(z) \\sim \\frac{1}{\\sqrt{\\pi} z^{1/4}} \\exp\\left(+\\frac{2}{3} z^{3/2}\\right) \\quad (\\text{growing solution}) $$\nThe physical boundary condition states there should be no growing solution for $x>0$. This requires the coefficient of Bi(z) to be zero, so $c_2 = 0$. The solution is therefore proportional to the Airy function of the first kind:\n$$ E(z) = c_1 \\mathrm{Ai}(z) $$\nTo find the reflectivity, we must analyze the solution in the propagation region $x0$, which corresponds to $z0$. The asymptotic behavior of $\\mathrm{Ai}(z)$ for $z \\to -\\infty$ is:\n$$ \\mathrm{Ai}(z) \\sim \\frac{1}{\\sqrt{\\pi} (-z)^{1/4}} \\sin\\left(\\frac{2}{3}(-z)^{3/2} + \\frac{\\pi}{4}\\right) $$\nWe express the sine function using complex exponentials to separate the incident and reflected waves:\n$$ \\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i} $$\nLet $\\phi(z) = \\frac{2}{3}(-z)^{3/2}$. The solution for $z0$ is:\n$$ E(z) \\propto \\frac{1}{(-z)^{1/4}} \\frac{1}{2i} \\left[ \\exp\\left(i\\left(\\phi(z) + \\frac{\\pi}{4}\\right)\\right) - \\exp\\left(-i\\left(\\phi(z) + \\frac{\\pi}{4}\\right)\\right) \\right] $$\n$$ E(z) \\propto \\frac{1}{(-z)^{1/4}} \\left[ \\frac{e^{i\\pi/4}}{2i} e^{i\\phi(z)} - \\frac{e^{-i\\pi/4}}{2i} e^{-i\\phi(z)} \\right] $$\nWe identify the incident and reflected wave components. A wave propagating in the $+x$ direction (incident wave) has a phase dependence of the form $\\exp(i\\int k dx)$. For $x0$, the local wavenumber is $k(x) = \\frac{\\omega}{c}\\sqrt{P(x)} = \\frac{\\omega}{c}\\sqrt{-\\alpha x}$. The phase integral $\\int_x^0 k(x')dx'$ is $\\phi(z)$. Thus, a wave propagating towards $x=0$ (incident wave) has a phase $\\exp(-i\\phi(z))$, and a wave propagating away from $x=0$ (reflected wave) has a phase $\\exp(i\\phi(z))$.\n\nFrom the asymptotic form of $E(z)$, we identify the complex amplitudes:\n- The amplitude of the reflected wave (term with $e^{i\\phi(z)}$) is $A_{refl} \\propto \\frac{e^{i\\pi/4}}{2i}$.\n- The amplitude of the incident wave (term with $e^{-i\\phi(z)}$) is $A_{inc} \\propto -\\frac{e^{-i\\pi/4}}{2i}$.\n\nThe complex reflection coefficient $R$ is the ratio of the reflected amplitude to the incident amplitude:\n$$ R = \\frac{A_{refl}}{A_{inc}} = \\frac{e^{i\\pi/4}/(2i)}{-e^{-i\\pi/4}/(2i)} = -\\frac{e^{i\\pi/4}}{e^{-i\\pi/4}} = -e^{i\\pi/2} $$\nSince $e^{i\\pi/2} = i$, the complex reflection coefficient is $R = -i$.\n\nThe reflectivity $\\mathcal{R}$ is defined as the squared magnitude of the complex reflection coefficient:\n$$ \\mathcal{R} = |R|^2 = |-i|^2 = 1 $$\nThis result signifies total reflection. This is physically expected, as the model is lossless (no collisions or other dissipation mechanisms) and the wave is incident on a cutoff region where propagation is forbidden ($P(x)0$), preventing any energy from being transmitted to $x \\to \\infty$. Therefore, all incident energy must be reflected.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Building on the concept of a cutoff, we now move to the more complex behavior of waves in a magnetized plasma. This practice focuses on the extraordinary (X-mode) wave, whose properties are dictated by the anisotropic cold-plasma dielectric tensor $\\boldsymbol{\\epsilon}$. You will derive how the wave's polarization state evolves adiabatically as it propagates through an inhomogeneous plasma, connecting the abstract tensor components to the physical R- and L-cutoffs . This exercise is crucial for understanding how wave energy is coupled and guided in applications like electron cyclotron resonance heating.",
            "id": "4064454",
            "problem": "Consider a cold, homogeneous-in-$y$ magnetized electron–ion plasma with a uniform background magnetic field $\\mathbf{B}_{0}$ aligned with the $z$-axis, $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$. The plasma has an electron density profile $n_{e}(x)$ that varies slowly with $x$ so that the WKB (Wentzel–Kramers–Brillouin) approximation is valid for wave propagation. A monochromatic plane wave of angular frequency $\\omega$ propagates in the $x$–$z$ plane at a fixed angle $\\theta$ relative to $\\mathbf{B}_{0}$, so that the unit vector along the wave vector is $\\hat{\\mathbf{k}} = \\sin\\theta\\,\\hat{\\mathbf{x}} + \\cos\\theta\\,\\hat{\\mathbf{z}}$.\n\nUnder the cold plasma model, Maxwell’s equations with the constitutive relation $\\mathbf{D} = \\boldsymbol{\\epsilon}\\cdot\\mathbf{E}$ lead to the frequency-domain wave equation\n$$\n\\left(n^{2}\\mathbf{I} - \\hat{\\mathbf{k}}\\hat{\\mathbf{k}} - \\boldsymbol{\\epsilon}\\right)\\cdot\\mathbf{E} = \\mathbf{0},\n$$\nwhere $n = ck/\\omega$ is the refractive index, $\\mathbf{I}$ is the identity tensor, and $\\boldsymbol{\\epsilon}$ is the cold plasma dielectric tensor. In the Stix notation, for a single electron species and a single ion species, the dielectric tensor in the laboratory frame aligned with $\\mathbf{B}_{0}$ is\n$$\n\\boldsymbol{\\epsilon} = \n\\begin{pmatrix}\nS  -iD  0 \\\\\niD  S  0 \\\\\n0  0  P\n\\end{pmatrix},\n$$\nwith\n$$\nS = 1 - \\sum_{s\\in\\{e,i\\}}\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}},\\quad\nD = \\sum_{s\\in\\{e,i\\}}\\frac{\\Omega_{s}}{\\omega}\\,\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}},\\quad\nP = 1 - \\sum_{s\\in\\{e,i\\}}\\frac{\\omega_{ps}^{2}}{\\omega^{2}},\n$$\nwhere $\\omega_{ps}^{2} = n_{s}q_{s}^{2}/(\\epsilon_{0}m_{s})$ is the species plasma frequency squared and $\\Omega_{s} = q_{s}B_{0}/m_{s}$ is the species cyclotron frequency. Assume an electron–ion plasma with singly charged ions and $\\Omega_{i} \\ll \\omega \\lesssim \\Omega_{e}$ so that electron contributions dominate $S$ and $D$ in the frequency range of interest for Electron Cyclotron Resonance Heating (ECRH) in fusion plasmas.\n\nFocus on the extraordinary mode (X-mode), defined here as the branch whose electric field resides in the plane spanned by $\\hat{\\mathbf{x}}$ and $\\hat{\\mathbf{y}}$ with a nonzero admixture along $\\hat{\\mathbf{z}}$ for oblique incidence. The right-hand and left-hand circular polarization vectors in the plane perpendicular to $\\mathbf{B}_{0}$ are the local eigenvectors of the $2\\times 2$ sub-tensor of $\\boldsymbol{\\epsilon}$ in the $\\hat{\\mathbf{x}}$–$\\hat{\\mathbf{y}}$ plane,\n$$\n\\mathbf{e}_{R} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ i \\\\ 0\\end{pmatrix},\\quad\n\\mathbf{e}_{L} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ -i \\\\ 0\\end{pmatrix}.\n$$\nAs the wave propagates through the inhomogeneous plasma, the X-mode polarization $\\mathbf{E}(x)$ adiabatically follows the local eigenstructure of $\\boldsymbol{\\epsilon}(x)$. Introduce a polarization rotation parameter $\\alpha(x)$ by writing the instantaneous transverse polarization state as a coherent superposition of the circular basis,\n$$\n\\mathbf{E}_{\\perp}(x) = c_{R}(x)\\,\\mathbf{e}_{R} + c_{L}(x)\\,\\mathbf{e}_{L},\\quad c_{R}(x) = \\cos\\alpha(x),\\quad c_{L}(x) = \\sin\\alpha(x),\n$$\nwith a common complex amplitude suppressed. This definition makes $\\alpha(x) = 0$ correspond to purely right-hand circular polarization and $\\alpha(x) = \\frac{\\pi}{2}$ correspond to purely left-hand circular polarization, and intermediate values describe elliptical polarization.\n\nStarting from the fundamental laws stated above and using the cold plasma dielectric properties, derive the local relation between the field components $E_{y}(x)$ and $E_{x}(x)$ for the extraordinary mode at oblique incidence $\\theta$, and use it to eliminate the coefficients $c_{R}(x)$ and $c_{L}(x)$ in favor of the plasma response functions. Then, quantify the polarization rotation by deriving a closed-form analytic expression for $\\alpha(x)$ entirely in terms of the Stix parameters $S(x)$, $D(x)$, and the local extraordinary-mode refractive index $n^{2}(x)$ for the given geometry. Your final expression must be valid in the adiabatic limit and must reduce to the expected right-hand or left-hand circular limits as the wave approaches the R or L cutoffs, defined respectively by $R(x) \\equiv S(x) + D(x) = 0$ and $L(x) \\equiv S(x) - D(x) = 0$ in the perpendicular limit.\n\nExpress your final answer for the rotation angle in radians, as a single closed-form analytic expression $\\alpha(x)$, with no numerical evaluation and no inequalities. Do not include any units in the final answer box.",
            "solution": "The derivation of the polarization rotation angle, $\\alpha(x)$, proceeds by first establishing a relationship between the electric field components from the wave equation and then equating this to the relationship derived from the parametric definition of the polarization state.\n\nThe wave equation for a monochromatic plane wave in a cold plasma is given by:\n$$\n\\left(n^{2}\\mathbf{I} - n^2\\hat{\\mathbf{k}}\\hat{\\mathbf{k}} - \\boldsymbol{\\epsilon}\\right)\\cdot\\mathbf{E} = \\mathbf{0}\n$$\nwhere we have followed standard convention and used the refractive index vector $\\mathbf{n} = n\\hat{\\mathbf{k}}$. For propagation in the $x$-$z$ plane, the wave vector direction is $\\hat{\\mathbf{k}} = (\\sin\\theta, 0, \\cos\\theta)$, and the refractive index vector is $\\mathbf{n} = (n\\sin\\theta, 0, n\\cos\\theta)$. The tensor in the wave equation is:\n$$\n\\mathbf{M} = n^2\\mathbf{I} - n^2\\hat{\\mathbf{k}}\\hat{\\mathbf{k}} - \\boldsymbol{\\epsilon} = \\begin{pmatrix} n^2\\cos^2\\theta - S  iD  -n^2\\sin\\theta\\cos\\theta \\\\ -iD  n^2 - S  0 \\\\ -n^2\\sin\\theta\\cos\\theta  0  n^2\\sin^2\\theta - P \\end{pmatrix}\n$$\nThe wave equation $\\mathbf{M}\\cdot\\mathbf{E} = \\mathbf{0}$ is a system of three linear homogeneous equations for the components of the electric field vector $\\mathbf{E} = (E_x, E_y, E_z)^T$. The second row of this system of equations provides a direct relationship between the transverse electric field components $E_x$ and $E_y$:\n$$\n-iD E_x + (n^2 - S) E_y = 0\n$$\nThis equation must hold for any non-trivial wave solution. Thus, we derive the local ratio of these field components, which characterizes the polarization in the $x$-$y$ plane, as a function of the local plasma properties and the wave's refractive index:\n$$\n\\frac{E_y(x)}{E_x(x)} = \\frac{iD(x)}{n^2(x) - S(x)}\n$$\nNote that the Stix parameters $S$ and $D$, and the refractive index $n$, are functions of position $x$ due to the varying electron density $n_e(x)$, as indicated by the WKB approximation.\n\nNext, we use the problem's parametric representation of the transverse polarization state. The transverse electric field $\\mathbf{E}_{\\perp}$ is expressed as a superposition of right-hand ($\\mathbf{e}_R$) and left-hand ($\\mathbf{e}_L$) circular polarization basis vectors:\n$$\n\\mathbf{E}_{\\perp}(x) = c_{R}(x)\\,\\mathbf{e}_{R} + c_{L}(x)\\,\\mathbf{e}_{L}\n$$\nWith the given definitions $\\mathbf{e}_{R} = \\frac{1}{\\sqrt{2}}(1, i, 0)^T$ and $\\mathbf{e}_{L} = \\frac{1}{\\sqrt{2}}(1, -i, 0)^T$, and the coefficients $c_R(x) = \\cos\\alpha(x)$ and $c_L(x) = \\sin\\alpha(x)$, we can write the Cartesian components of $\\mathbf{E}_{\\perp}$:\n$$\n\\mathbf{E}_{\\perp} = \\cos\\alpha(x) \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ i \\\\ 0 \\end{pmatrix} + \\sin\\alpha(x) \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -i \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\cos\\alpha(x) + \\sin\\alpha(x) \\\\ i(\\cos\\alpha(x) - \\sin\\alpha(x)) \\\\ 0 \\end{pmatrix}\n$$\nFrom this, we find a second expression for the ratio of the transverse field components, this time in terms of the polarization angle $\\alpha(x)$. Suppressing the common amplitude, we have:\n$$\nE_x(x) = \\cos\\alpha(x) + \\sin\\alpha(x)\n$$\n$$\nE_y(x) = i(\\cos\\alpha(x) - \\sin\\alpha(x))\n$$\nThe ratio is therefore:\n$$\n\\frac{E_y(x)}{E_x(x)} = \\frac{i(\\cos\\alpha(x) - \\sin\\alpha(x))}{\\cos\\alpha(x) + \\sin\\alpha(x)}\n$$\nTo simplify this expression, we divide the numerator and denominator by $\\cos\\alpha(x)$:\n$$\n\\frac{E_y(x)}{E_x(x)} = i\\frac{1 - \\tan\\alpha(x)}{1 + \\tan\\alpha(x)}\n$$\nUsing the tangent subtraction formula, $\\tan(A-B) = (\\tan A - \\tan B)/(1+\\tan A \\tan B)$, with $A = \\pi/4$ ($\\tan A = 1$) and $B=\\alpha$, we get:\n$$\n\\frac{E_y(x)}{E_x(x)} = i\\tan\\left(\\frac{\\pi}{4} - \\alpha(x)\\right)\n$$\nNow, we equate the two derived expressions for the ratio $E_y/E_x$:\n$$\n\\frac{iD(x)}{n^2(x) - S(x)} = i\\tan\\left(\\frac{\\pi}{4} - \\alpha(x)\\right)\n$$\nThe imaginary unit $i$ cancels, leaving a direct equation for $\\alpha(x)$:\n$$\n\\tan\\left(\\frac{\\pi}{4} - \\alpha(x)\\right) = \\frac{D(x)}{n^2(x) - S(x)}\n$$\nTo solve for $\\alpha(x)$, we can take the arctangent of both sides. However, a more elegant form can be obtained by first solving for $\\tan\\alpha(x)$. Let $K(x) = \\frac{D(x)}{n^2(x) - S(x)}$ and $t = \\tan\\alpha(x)$. The equation is:\n$$\n\\frac{1-t}{1+t} = K(x)\n$$\nSolving for $t$:\n$$\n1 - t = K(x)(1+t) = K(x) + K(x)t\n$$\n$$\n1 - K(x) = t(1+K(x))\n$$\n$$\nt = \\tan\\alpha(x) = \\frac{1 - K(x)}{1 + K(x)}\n$$\nSubstituting the expression for $K(x)$ back into this equation:\n$$\n\\tan\\alpha(x) = \\frac{1 - \\frac{D(x)}{n^2(x) - S(x)}}{1 + \\frac{D(x)}{n^2(x) - S(x)}} = \\frac{(n^2(x) - S(x)) - D(x)}{(n^2(x) - S(x)) + D(x)}\n$$\nFinally, taking the inverse tangent gives the closed-form expression for the polarization rotation angle $\\alpha(x)$:\n$$\n\\alpha(x) = \\arctan\\left(\\frac{n^2(x) - S(x) - D(x)}{n^2(x) - S(x) + D(x)}\\right)\n$$\nThis expression quantifies the local polarization state entirely in terms of the local Stix parameters $S(x)$ and $D(x)$ and the local refractive index $n^2(x)$ for the extraordinary mode, as required. The expression is valid for oblique incidence and, as can be verified, correctly reduces to the R-mode ($\\alpha=0$) and L-mode ($\\alpha=\\pi/2$) polarization limits at the respective cutoffs where $n^2 \\to 0$ and $S+D \\to 0$ or $S-D \\to 0$.",
            "answer": "$$\\boxed{\\arctan\\left(\\frac{n^{2}(x) - S(x) - D(x)}{n^{2}(x) - S(x) + D(x)}\\right)}$$"
        },
        {
            "introduction": "The final practice bridges the gap between analytical theory and computational engineering, a core skill in modern fusion science. Having explored the analytical conditions for cutoffs and resonances, you will now develop a numerical tool to automatically identify these critical layers for an X-mode wave in a plasma with realistic density and magnetic field profiles . This computational exercise translates the dispersion relation into a practical algorithm for mapping wave accessibility, providing a direct method to determine if a wave launched from the edge can reach the hot plasma core.",
            "id": "4064462",
            "problem": "You are asked to write a complete, runnable program that, for a one-dimensional radial path from the plasma edge to the core, decides which event an extraordinary electromagnetic wave in a cold magnetized plasma (the so-called X-mode) encounters first: the right-hand cutoff (R-cutoff), the left-hand cutoff (L-cutoff), or the upper-hybrid resonance (UHR). The wave is assumed to propagate strictly perpendicular to the local magnetic field. The decision must be made purely from first principles using the cold plasma dielectric response. The task is to determine, given analytic profiles of electron density and magnetic field and a specified wave frequency, which of these signatures of the dispersion relation occurs at the smallest normalized radius along the path from the edge to the core.\n\nStart from the following well-tested foundational relationships for a cold electron-ion plasma and perpendicular wave propagation:\n- The electron plasma frequency is defined by $ \\omega_{pe}(r) = \\sqrt{ \\dfrac{n_{e}(r) e^{2}}{\\varepsilon_{0} m_{e}} } $, where $ n_{e}(r) $ is the electron number density, $ e $ is the elementary charge, $ \\varepsilon_{0} $ is the vacuum permittivity, and $ m_{e} $ is the electron mass.\n- The electron cyclotron frequency is $ \\omega_{ce}(r) = \\dfrac{e B(r)}{m_{e}} $, where $ B(r) $ is the magnetic field magnitude.\n- Define the dimensionless parameters $ X(r) = \\dfrac{\\omega_{pe}^{2}(r)}{\\omega^{2}} $ and $ Y(r) = \\dfrac{\\omega_{ce}(r)}{\\omega} $, where $ \\omega = 2 \\pi f $ is the wave angular frequency for a given frequency $ f $.\n- The cold plasma Stix parameters are $ R(r) = 1 - \\dfrac{X(r)}{1 + Y(r)} $, $ L(r) = 1 - \\dfrac{X(r)}{1 - Y(r)} $, and $ S(r) = 1 - \\dfrac{X(r)}{1 - Y^{2}(r)} $.\n- For perpendicular propagation, the X-mode dispersion relation can be written as $ n^{2}(r) = \\dfrac{R(r) L(r)}{S(r)} $, where $ n^{2}(r) $ is the squared refractive index. A cutoff is reached where $ n^{2}(r) = 0 $ (that is, where either $ R(r) = 0 $ or $ L(r) = 0 $), and a resonance occurs where $ n^{2}(r) \\to \\infty $ (that is, where $ S(r) = 0 $).\n\nUnder these definitions, the event conditions can be restated as finding the smallest normalized radius $ \\rho \\in [0, 1] $ such that one of the following equalities holds:\n- R-cutoff condition: $ X(\\rho) = 1 + Y(\\rho) $.\n- L-cutoff condition: $ X(\\rho) = 1 - Y(\\rho) $ with the physical validity domain $ 1 - Y(\\rho)  0 $.\n- Upper-hybrid resonance condition: $ X(\\rho) = 1 - Y^{2}(\\rho) $ with the physical validity domain $ 1 - Y^{2}(\\rho)  0 $.\n\nYou must implement a numerical procedure that scans from the plasma edge at $ \\rho = 0 $ to the core at $ \\rho = 1 $ and determines which event occurs first, if any. If no event is found on $ \\rho \\in [0, 1] $, return the code for \"none.\"\n\nUse the following modeling assumptions and definitions:\n- The radial coordinate is the normalized radius $ \\rho \\in [0, 1] $.\n- The density and magnetic field profiles are analytic and defined by\n  - $ n_{e}(\\rho) = n_{\\text{edge}} + \\left( n_{\\text{core}} - n_{\\text{edge}} \\right) \\rho^{p} $,\n  - $ B(\\rho) = B_{\\text{edge}} + \\left( B_{\\text{core}} - B_{\\text{edge}} \\right) \\rho^{q} $,\n  where $ n_{\\text{edge}} $, $ n_{\\text{core}} $, $ B_{\\text{edge}} $, $ B_{\\text{core}} $, $ p $, and $ q $ are given parameters for each test case.\n- Use vacuum permittivity $ \\varepsilon_{0} $ in farads per meter, electron mass $ m_{e} $ in kilograms, elementary charge $ e $ in coulombs, magnetic field $ B $ in teslas, frequency $ f $ in hertz, and density $ n_{e} $ in per cubic meter. All calculations must be done in the International System of Units (SI).\n\nYour program must:\n- For each test case, compute $ \\omega = 2 \\pi f $, then evaluate $ X(\\rho) $ and $ Y(\\rho) $ along the path from $ \\rho = 0 $ to $ \\rho = 1 $.\n- Determine the smallest $ \\rho $ at which one of the event conditions is satisfied subject to its validity domain.\n- Return an integer code per test case indicating the first event encountered:\n  - $ 1 $ if the first event is the R-cutoff,\n  - $ 2 $ if the first event is the L-cutoff,\n  - $ 3 $ if the first event is the upper-hybrid resonance,\n  - $ 0 $ if no event is found on $ \\rho \\in [0, 1] $.\n\nYou must implement a numerically robust bracketing procedure on a sufficiently fine grid to locate the first root among\n- $ \\varphi_{R}(\\rho) = X(\\rho) - \\left( 1 + Y(\\rho) \\right) $,\n- $ \\varphi_{L}(\\rho) = X(\\rho) - \\left( 1 - Y(\\rho) \\right) $, valid when $ 1 - Y(\\rho)  0 $,\n- $ \\varphi_{UH}(\\rho) = X(\\rho) - \\left( 1 - Y^{2}(\\rho) \\right) $, valid when $ 1 - Y^{2}(\\rho)  0 $.\nFor each $ \\varphi(\\rho) $ with a validity domain, you may only consider roots within its validity domain. For each function, identify the smallest $ \\rho $ where a sign change or a zero first occurs, and refine the root location by bisection or linear interpolation on the bracketing interval. Then select the event with the smallest $ \\rho $ among those found.\n\nTest suite:\n- Case $ 1 $ (expecting an L-cutoff first in a typical electron cyclotron resonance heating regime):\n  - $ f = 110 \\times 10^{9} \\, \\text{Hz} $,\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $, $ n_{\\text{core}} = 1.0 \\times 10^{20} \\, \\text{m}^{-3} $,\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $, $ B_{\\text{core}} = 2.4 \\, \\text{T} $,\n  - $ p = 2 $, $ q = 1 $.\n- Case $ 2 $ (expecting an R-cutoff first for a low-frequency wave relative to cyclotron frequency):\n  - $ f = 20 \\times 10^{9} \\, \\text{Hz} $,\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $, $ n_{\\text{core}} = 5.0 \\times 10^{19} \\, \\text{m}^{-3} $,\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $, $ B_{\\text{core}} = 2.4 \\, \\text{T} $,\n  - $ p = 2 $, $ q = 1 $.\n- Case $ 3 $ (an edge case with no event on the interval):\n  - $ f = 170 \\times 10^{9} \\, \\text{Hz} $,\n  - $ n_{\\text{edge}} = 1.0 \\times 10^{18} \\, \\text{m}^{-3} $, $ n_{\\text{core}} = 3.0 \\times 10^{19} \\, \\text{m}^{-3} $,\n  - $ B_{\\text{edge}} = 2.0 \\, \\text{T} $, $ B_{\\text{core}} = 2.4 \\, \\text{T} $,\n  - $ p = 2 $, $ q = 1 $.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the three test cases, for example $ [r_{1}, r_{2}, r_{3}] $. Each $ r_{i} $ must be one of $ 0 $, $ 1 $, $ 2 $, or $ 3 $ as defined above. No additional text should be printed.",
            "solution": "The problem requires the determination of the first wave-particle interaction event—either a cutoff or a resonance—encountered by an extraordinary (X-mode) electromagnetic wave propagating perpendicularly to the magnetic field in a cold, magnetized plasma. The plasma is characterized by one-dimensional radial profiles for electron density $n_e(\\rho)$ and magnetic field strength $B(\\rho)$, where $\\rho \\in [0, 1]$ is the normalized radius from the edge to the core.\n\nFirst, we formalize the problem using the provided physical principles. The state of the cold plasma relative to the wave is described by two dimensionless parameters:\n- $X(\\rho) = \\dfrac{\\omega_{pe}^2(\\rho)}{\\omega^2}$, which compares the local electron plasma frequency $\\omega_{pe}$ to the constant wave frequency $\\omega$.\n- $Y(\\rho) = \\dfrac{\\omega_{ce}(\\rho)}{\\omega}$, which compares the local electron cyclotron frequency $\\omega_{ce}$ to the wave frequency $\\omega$.\n\nThe electron plasma frequency $\\omega_{pe}(\\rho)$ depends on the electron density $n_e(\\rho)$ as $\\omega_{pe}^2(\\rho) = \\frac{n_e(\\rho) e^2}{\\varepsilon_0 m_e}$. The electron cyclotron frequency $\\omega_{ce}(\\rho)$ depends on the magnetic field $B(\\rho)$ as $\\omega_{ce}(\\rho) = \\frac{e B(\\rho)}{m_e}$. The given analytic profiles are:\n$$\nn_{e}(\\rho) = n_{\\text{edge}} + \\left( n_{\\text{core}} - n_{\\text{edge}} \\right) \\rho^{p}\n$$\n$$\nB(\\rho) = B_{\\text{edge}} + \\left( B_{\\text{core}} - B_{\\text{edge}} \\right) \\rho^{q}\n$$\nwhere $n_{\\text{edge}}$, $n_{\\text{core}}$, $B_{\\text{edge}}$, $B_{\\text{core}}$, $p$, and $q$ are specified parameters. The wave angular frequency is $\\omega = 2\\pi f$ for a given frequency $f$. All calculations use SI units with the fundamental constants for elementary charge $e$, electron mass $m_e$, and vacuum permittivity $\\varepsilon_0$.\n\nThe dispersion relation for the X-mode propagating perpendicularly to the magnetic field is given by $n^2(\\rho) = \\frac{R(\\rho)L(\\rho)}{S(\\rho)}$, where $R$, $L$, and $S$ are the Stix parameters.\n- A **cutoff** occurs when the refractive index $n \\to 0$, which implies $R(\\rho)=0$ or $L(\\rho)=0$.\n- A **resonance** occurs when $n \\to \\infty$, which implies $S(\\rho)=0$.\n\nThese conditions are explicitly defined in terms of $X(\\rho)$ and $Y(\\rho)$:\n1.  **Right-hand (R) cutoff ($R=0$):** $X(\\rho) = 1 + Y(\\rho)$. We define the function $\\varphi_R(\\rho) = X(\\rho) - (1 + Y(\\rho))$ and seek its smallest root in $\\rho \\in [0, 1]$.\n2.  **Left-hand (L) cutoff ($L=0$):** $X(\\rho) = 1 - Y(\\rho)$. We define $\\varphi_L(\\rho) = X(\\rho) - (1 - Y(\\rho))$. This condition is physically valid only when the right-hand side is positive, i.e., $1 - Y(\\rho)  0$. Roots are sought only within this validity domain.\n3.  **Upper-hybrid resonance (UHR, $S=0$):** $X(\\rho) = 1 - Y^2(\\rho)$. We define $\\varphi_{UH}(\\rho) = X(\\rho) - (1 - Y^2(\\rho))$. This is valid only when $1 - Y^2(\\rho)  0$. Roots are sought only within this validity domain.\n\nThe task is to find the smallest $\\rho \\in [0, 1]$ that satisfies any of these three equations within its respective validity domain.\n\nThe algorithmic approach is as follows:\n1.  For each test case, the physical and profile parameters are used to construct the functions $X(\\rho)$ and $Y(\\rho)$. From these, the three event functions $\\varphi_R(\\rho)$, $\\varphi_L(\\rho)$, and $\\varphi_{UH}(\\rho)$ are defined, along with the validity conditions for $\\varphi_L$ and $\\varphi_{UH}$.\n2.  A numerical root-finding procedure is implemented to find the smallest root of each function $\\varphi(\\rho)$ on the interval $[0, 1]$. This procedure, encapsulated in a function `find_smallest_root`, operates by first discretizing the interval $\\rho \\in [0, 1]$ into a fine grid (e.g., $1000$ subintervals).\n3.  The grid is scanned from $\\rho=0$ to $\\rho=1$. For each subinterval $[\\rho_i, \\rho_{i+1}]$, we first check if the interval is within the function's validity domain. If it is, we evaluate the function at the endpoints. A sign change, $\\varphi(\\rho_i) \\cdot \\varphi(\\rho_{i+1}) \\le 0$, indicates that a root is bracketed within this subinterval.\n4.  Upon finding the first such bracket, a more precise numerical solver is invoked. We use Brent's method, as implemented in `scipy.optimize.brentq`, which is a robust and efficient algorithm that combines bisection, the secant method, and inverse quadratic interpolation to find the root within the bracketed interval to high precision.\n5.  This procedure is applied independently to find the smallest valid root for each of the three events: $\\rho_R$, $\\rho_L$, and $\\rho_{UH}$. If a particular event function does not have a valid root in $[0, 1]$, its result is considered infinite.\n6.  The identified roots are compared: $\\rho_{first} = \\min(\\rho_R, \\rho_L, \\rho_{UH})$. The event corresponding to $\\rho_{first}$ is the first one the wave encounters. The integer code for this event ($1$ for R-cutoff, $2$ for L-cutoff, $3$ for UHR) is recorded.\n7.  If no valid roots are found for any of the three events in the interval $[0, 1]$, the result is \"none\", represented by the code $0$.\n\nThis methodology provides a robust and physically correct determination of the first wave interaction event by systematically solving the governing equations numerically, respecting all specified constraints and physical validity domains.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes which event (R-cutoff, L-cutoff, or UHR) an X-mode wave \n    encounters first along a radial path in a plasma.\n    \"\"\"\n    \n    # Fundamental physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kilograms\n    EPSILON_0 = 8.8541878128e-12   # Vacuum permittivity in F/m\n\n    # Pre-calculated combinations of constants for efficiency\n    E2_OVER_EPS0_ME = E_CHARGE**2 / (EPSILON_0 * M_ELECTRON)\n    E_OVER_ME = E_CHARGE / M_ELECTRON\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        # Case 1: Expecting L-cutoff (2)\n        {'f': 110e9, 'n_edge': 1.0e18, 'n_core': 1.0e20, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n        # Case 2: Expecting R-cutoff (1)\n        {'f': 20e9, 'n_edge': 1.0e18, 'n_core': 5.0e19, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n        # Case 3: Expecting no event (0)\n        {'f': 170e9, 'n_edge': 1.0e18, 'n_core': 3.0e19, 'B_edge': 2.0, 'B_core': 2.4, 'p': 2, 'q': 1},\n    ]\n\n    def find_smallest_root(func, validity_func, rho_min=0.0, rho_max=1.0, grid_points=1001):\n        \"\"\"\n        Finds the smallest root of a function `func` on [rho_min, rho_max]\n        where `validity_func` returns True.\n        \n        Args:\n            func: The function for which to find a root.\n            validity_func: A function that returns True if func is physically valid at a given rho.\n            rho_min, rho_max: The search interval.\n            grid_points: The number of points to use for the initial grid scan.\n\n        Returns:\n            The smallest root found, or None if no root is found.\n        \"\"\"\n        rhos = np.linspace(rho_min, rho_max, grid_points)\n        \n        # Check the very first point separately\n        if validity_func(rhos[0]) and func(rhos[0]) == 0:\n            return rhos[0]\n        \n        val_prev = None\n        if validity_func(rhos[0]):\n            val_prev = func(rhos[0])\n            \n        for i in range(1, len(rhos)):\n            rho_prev, rho_curr = rhos[i-1], rhos[i]\n            \n            is_valid_curr = validity_func(rho_curr)\n            is_valid_prev = val_prev is not None\n\n            if not (is_valid_prev and is_valid_curr):\n                val_prev = func(rho_curr) if is_valid_curr else None\n                continue\n            \n            val_curr = func(rho_curr)\n\n            # A sign change indicates a bracketed root\n            if val_prev * val_curr = 0:\n                try:\n                    root = brentq(func, rho_prev, rho_curr)\n                    return root\n                except ValueError:\n                    # This can happen if one of the endpoints is exactly zero,\n                    # or if signs are not opposite due to floating point issues.\n                    if val_prev == 0: return rho_prev\n                    if val_curr == 0: return rho_curr\n                    # otherwise, it might be a grazing contact, continue search\n            \n            val_prev = val_curr\n            \n        return None\n\n    results = []\n    for params in test_cases:\n        omega = 2 * np.pi * params['f']\n\n        # Define profile and dimensionless parameter functions for the current case\n        def n_e(rho): return params['n_edge'] + (params['n_core'] - params['n_edge']) * rho**params['p']\n        def B(rho): return params['B_edge'] + (params['B_core'] - params['B_edge']) * rho**params['q']\n        def X(rho): return (n_e(rho) * E2_OVER_EPS0_ME) / omega**2\n        def Y(rho): return (B(rho) * E_OVER_ME) / omega\n\n        # Define the three event functions phi(rho) = 0\n        def phi_R(rho): return X(rho) - (1 + Y(rho))\n        def phi_L(rho): return X(rho) - (1 - Y(rho))\n        def phi_UH(rho): return X(rho) - (1 - Y(rho)**2)\n\n        # Define validity functions for L-cutoff and UHR\n        def valid_L(rho): return 1 - Y(rho)  0\n        def valid_UH(rho): return 1 - Y(rho)**2  0\n        def valid_always(rho): return True\n\n        # Find the smallest root for each event type\n        root_R = find_smallest_root(phi_R, valid_always)\n        root_L = find_smallest_root(phi_L, valid_L)\n        root_UH = find_smallest_root(phi_UH, valid_UH)\n\n        # Collect all found valid roots with their corresponding event codes\n        found_events = []\n        if root_R is not None: found_events.append((root_R, 1))  # 1: R-cutoff\n        if root_L is not None: found_events.append((root_L, 2))  # 2: L-cutoff\n        if root_UH is not None: found_events.append((root_UH, 3)) # 3: UHR\n\n        # Determine the first event\n        if not found_events:\n            results.append(0)  # 0: No event found\n        else:\n            # The first event is the one with the minimum rho\n            first_event = min(found_events, key=lambda item: item[0])\n            results.append(first_event[1])\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}