{
    "hands_on_practices": [
        {
            "introduction": "Before modeling power deposition, one must first understand if a wave can even travel through the plasma. This foundational exercise has you derive the dispersion relation for the Ordinary mode (O-mode) from first principles, connecting Maxwell's equations to the plasma's collective response. By calculating the refractive index for a given scenario, you will practice identifying the critical density cutoff that governs wave accessibility in radiofrequency heating schemes .",
            "id": "4037789",
            "problem": "An electromagnetic plane wave of angular frequency $\\omega$ is launched into a spatially uniform, magnetized, fully ionized deuterium plasma with equilibrium electron density $n_{e}$ and equilibrium magnetic field $\\mathbf{B}_{0}$ of magnitude $B$. The wave vector $\\mathbf{k}$ is perpendicular to $\\mathbf{B}_{0}$, so the propagation angle is $\\theta=90^{\\circ}$. Neglect collisions and assume a cold-plasma limit with linear electron-fluid response; further assume that the radiofrequency (RF) wave frequency is much greater than the deuterium ion cyclotron frequency so that ion motion can be neglected in the high-frequency electron response. Starting from Maxwell’s equations and the linearized cold electron-fluid equations, derive the cold-plasma dielectric response sufficient to identify the ordinary mode (O-mode) dispersion relation for $\\theta=90^{\\circ}$. Use this to compute the refractive index magnitude $n$ for the O-mode, and determine whether the O-mode is propagating or evanescent under the given parameters.\n\nUse the following parameters:\n- $\\omega = 2\\pi f$ with $f = 80.0~\\mathrm{GHz}$,\n- $B = 5.00~\\mathrm{T}$,\n- $n_{e} = 5.00 \\times 10^{19}~\\mathrm{m}^{-3}$.\n\nFundamental constants to be used are:\n- electron charge $e$,\n- electron mass $m_{e}$,\n- vacuum permittivity $\\varepsilon_{0}$.\n\nReport the final refractive index magnitude $n$ as a dimensionless number, rounded to four significant figures. State in your reasoning whether the O-mode is propagating or evanescent, based on the sign of the appropriate dispersion quantity at $\\theta=90^{\\circ}$, but provide only the refractive index as the final numerical answer.",
            "solution": "The problem asks for the derivation of the ordinary mode (O-mode) dispersion relation in a cold, magnetized plasma for perpendicular propagation, and the subsequent calculation of the refractive index for a given set of parameters.\n\nFirst, we validate the problem statement.\nThe givens are:\n- Wave angular frequency $\\omega = 2\\pi f$ where $f = 80.0~\\mathrm{GHz} = 8.00 \\times 10^{10}~\\mathrm{Hz}$.\n- Equilibrium electron density $n_{e} = 5.00 \\times 10^{19}~\\mathrm{m}^{-3}$.\n- Equilibrium magnetic field magnitude $B = 5.00~\\mathrm{T}$.\n- The wave vector $\\mathbf{k}$ is perpendicular to the equilibrium magnetic field $\\mathbf{B}_{0}$, so the propagation angle is $\\theta=90^{\\circ}$.\n- The plasma is a fully ionized deuterium plasma.\n- Assumptions: cold-plasma limit, collisionless, linear response, and ion motion is neglected.\nThe problem is scientifically grounded in established plasma physics theory (cold-plasma model and Maxwell's equations). It is well-posed, objective, and provides all necessary data for a unique solution. The parameters are physically realistic for a fusion-grade plasma. The assumption of neglecting ion motion is valid as the wave frequency $\\omega$ is much larger than the deuterium ion cyclotron frequency $\\Omega_D$. Given $\\omega \\approx 5 \\times 10^{11}~\\mathrm{rad/s}$ and $\\Omega_D = eB/m_D \\approx 2.4 \\times 10^8~\\mathrm{rad/s}$ (where $m_D \\approx 2 m_p$), we have $\\omega \\gg \\Omega_D$. Thus, the problem is deemed valid.\n\nWe begin the derivation from the linearized equation of motion for the electron fluid in a cold, collisionless plasma. For a wave with time dependence $\\exp(-i\\omega t)$, the equation is:\n$$ -i\\omega m_{e} \\mathbf{v}_{1} = -e(\\mathbf{E}_{1} + \\mathbf{v}_{1} \\times \\mathbf{B}_{0}) $$\nwhere $\\mathbf{v}_{1}$ and $\\mathbf{E}_{1}$ are the first-order perturbed electron velocity and electric field, respectively. $m_e$ is the electron mass, $e$ is the elementary charge, and $\\mathbf{B}_{0}$ is the equilibrium magnetic field.\n\nThe perturbed current density is given by $\\mathbf{J}_{1} = -n_{e} e \\mathbf{v}_{1}$. By solving the equation of motion for $\\mathbf{v}_{1}$ in terms of $\\mathbf{E}_{1}$, we can find the conductivity tensor $\\sigma$ defined by $\\mathbf{J}_{1} = \\sigma \\cdot \\mathbf{E}_{1}$. The dielectric tensor $\\epsilon$ is then related to the conductivity tensor by:\n$$ \\epsilon = \\mathbf{I} + \\frac{i}{\\omega \\varepsilon_{0}} \\sigma $$\nwhere $\\mathbf{I}$ is the identity tensor and $\\varepsilon_{0}$ is the vacuum permittivity.\n\nLet's establish a coordinate system where $\\mathbf{B}_{0} = B \\hat{\\mathbf{z}}$. The resulting dielectric tensor for a cold plasma is:\n$$ \\epsilon = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix} $$\nThe components $S$, $D$, and $P$ are the Stix parameters, defined as:\n$$ S = 1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} $$\n$$ D = \\frac{\\omega_{ce}}{\\omega} \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} $$\n$$ P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2} $$\nHere, $\\omega_{pe} = \\sqrt{\\frac{n_{e}e^2}{m_{e}\\varepsilon_{0}}}$ is the electron plasma frequency and $\\omega_{ce} = \\frac{eB}{m_{e}}$ is the electron cyclotron frequency.\n\nThe wave equation derived from Maxwell's equations for a plane wave of the form $\\exp(i\\mathbf{k} \\cdot \\mathbf{r} - i\\omega t)$ in a medium described by $\\epsilon$ is:\n$$ \\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}_{1}) + \\frac{\\omega^2}{c^2} \\epsilon \\cdot \\mathbf{E}_{1} = 0 $$\nUsing the vector identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$ and defining the refractive index vector $\\mathbf{n} = \\frac{c}{\\omega}\\mathbf{k}$, the wave equation becomes:\n$$ \\left( \\mathbf{n}\\mathbf{n} - n^2 \\mathbf{I} + \\epsilon \\right) \\cdot \\mathbf{E}_{1} = 0 $$\nwhere $n = |\\mathbf{n}|$.\n\nFor propagation perpendicular to the magnetic field, $\\mathbf{k} \\perp \\mathbf{B}_{0}$. We chose $\\mathbf{B}_{0}$ along $\\hat{\\mathbf{z}}$, so $\\mathbf{k}$ must lie in the $xy$-plane. Without loss of generality, let $\\mathbf{k} = k \\hat{\\mathbf{x}}$. Then the refractive index vector is $\\mathbf{n} = n \\hat{\\mathbf{x}} = (n, 0, 0)$. The tensor $\\mathbf{n}\\mathbf{n}$ is:\n$$ \\mathbf{n}\\mathbf{n} = \\begin{pmatrix} n^2  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\nSubstituting this into the wave equation gives the following system for $\\mathbf{E}_{1} = (E_x, E_y, E_z)$:\n$$ \\begin{pmatrix} S  -iD  0 \\\\ iD  S-n^2  0 \\\\ 0  0  P-n^2 \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nFor a non-trivial solution for $\\mathbf{E}_{1}$, the determinant of the matrix must be zero:\n$$ \\det \\begin{pmatrix} S  -iD  0 \\\\ iD  S-n^2  0 \\\\ 0  0  P-n^2 \\end{pmatrix} = (P - n^2) [S(S-n^2) - (-iD)(iD)] = (P - n^2)(S^2 - n^2S - D^2) = 0 $$\nThis equation yields two decoupled modes:\n1.  Ordinary mode (O-mode): $P - n^2 = 0$. This mode solution has $E_x=E_y=0$ and $E_z \\neq 0$. The electric field of the wave is parallel to the background magnetic field ($\\mathbf{E}_{1} \\parallel \\mathbf{B}_{0}$).\n2.  Extraordinary mode (X-mode): $S^2 - n^2S - D^2 = 0$. This mode solution has $E_z=0$ ($\\mathbf{E}_{1} \\perp \\mathbf{B}_{0}$).\n\nThe problem requests the analysis of the O-mode. The dispersion relation is:\n$$ n^2 = P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2} $$\nThis relation shows that the O-mode is not affected by the magnetic field for perpendicular propagation, as the electron motion driven by $\\mathbf{E}_1$ is along the magnetic field lines, so the Lorentz force term $\\mathbf{v}_1 \\times \\mathbf{B}_0$ vanishes.\n\nA wave is propagating if its wave number is real, which corresponds to $n^2 > 0$. For the O-mode, this condition is:\n$$ 1 - \\frac{\\omega_{pe}^2}{\\omega^2} > 0 \\implies \\omega^2 > \\omega_{pe}^2 \\implies \\omega > \\omega_{pe} $$\nSo, the wave propagates if its frequency $\\omega$ is above the electron plasma frequency $\\omega_{pe}$, which serves as a cutoff frequency. If $\\omega  \\omega_{pe}$, $n^2$ is negative, $n$ is imaginary, and the wave is evanescent.\n\nNow we compute the numerical values.\nThe wave frequency is $\\omega = 2\\pi f = 2\\pi(8.00 \\times 10^{10}~\\mathrm{s}^{-1}) \\approx 5.0265 \\times 10^{11}~\\mathrm{rad/s}$.\nThe square of the wave frequency is $\\omega^2 \\approx 2.5266 \\times 10^{23}~\\mathrm{s}^{-2}$.\n\nThe square of the electron plasma frequency is:\n$$ \\omega_{pe}^2 = \\frac{n_{e}e^2}{m_{e}\\varepsilon_{0}} = \\frac{(5.00 \\times 10^{19}~\\mathrm{m}^{-3})(1.602177 \\times 10^{-19}~\\mathrm{C})^2}{(9.109384 \\times 10^{-31}~\\mathrm{kg})(8.854188 \\times 10^{-12}~\\mathrm{F/m})} $$\n$$ \\omega_{pe}^2 \\approx 1.5913 \\times 10^{23}~\\mathrm{s}^{-2} $$\nComparing the frequencies, we have $\\omega^2 \\approx 2.5266 \\times 10^{23}~\\mathrm{s}^{-2}$ and $\\omega_{pe}^2 \\approx 1.5913 \\times 10^{23}~\\mathrm{s}^{-2}$. Since $\\omega^2 > \\omega_{pe}^2$, the condition for propagation is met. The O-mode is a propagating wave under these parameters.\n\nFinally, we calculate the refractive index magnitude $n$ for the O-mode:\n$$ n^2 = 1 - \\frac{\\omega_{pe}^2}{\\omega^2} \\approx 1 - \\frac{1.5913 \\times 10^{23}}{2.5266 \\times 10^{23}} \\approx 1 - 0.62985 $$\n$$ n^2 \\approx 0.37015 $$\nTaking the square root to find the magnitude of the refractive index:\n$$ n = \\sqrt{0.37015} \\approx 0.608399 $$\nRounding to four significant figures, the refractive index magnitude is $0.6084$.",
            "answer": "$$\\boxed{0.6084}$$"
        },
        {
            "introduction": "Moving beyond the cold-plasma picture, we now explore how wave energy is transferred to plasma particles. This problem focuses on Landau damping, a crucial collisionless absorption mechanism that cannot be captured by simple fluid models. By deriving the absorbed power from kinetic theory, you will gain a deeper understanding of the resonant wave-particle interactions that are fundamental to plasma heating .",
            "id": "4037815",
            "problem": "Consider a one-dimensional slab model of a magnetized fusion plasma supporting a lower hybrid wave (LHW). The lower hybrid wave (LHW) has angular frequency $\\omega$ and a nonzero parallel wavenumber $k_{\\parallel}$ with respect to the ambient magnetic field. Assume that the parallel electric field component $E_{\\parallel}(x,t)$ of the wave is uniform across a thin resonance layer of thickness $\\ell$ and can be represented as a monochromatic complex amplitude $E_{\\parallel 0}$ such that $E_{\\parallel}(x,t) = \\Re\\{E_{\\parallel 0}\\exp(-i\\omega t)\\}$. Electrons are described by a spatially uniform, isotropic Maxwellian equilibrium distribution with number density $n_{e}$ and temperature $T_{e}$. Ions are assumed cold enough that their parallel Landau resonance contribution to power deposition is negligible. The electron thermal speed is $v_{T e} = \\sqrt{2 k_{B} T_{e}/m_{e}}$ and the electron plasma frequency is $\\omega_{p e} = \\sqrt{n_{e} e^{2}/(\\varepsilon_{0} m_{e})}$, where $e$ is the elementary charge, $m_{e}$ is the electron mass, $k_{B}$ is the Boltzmann constant, and $\\varepsilon_{0}$ is the vacuum permittivity.\n\nStarting from the linearized Vlasov equation for electrons and Maxwell’s equations, model the electron parallel conduction current response $J_{\\parallel}$ to the parallel electric field $E_{\\parallel}$ and use it to evaluate the time-averaged local power density absorbed by electrons, $\\langle \\mathbf{E}\\cdot\\mathbf{J} \\rangle$, due to Landau resonance. Then, compute the total power deposited per unit area by Landau damping across the resonance layer by integrating $\\langle \\mathbf{E}\\cdot\\mathbf{J} \\rangle$ across the layer thickness $\\ell$.\n\nExpress your final answer as a single closed-form analytic expression in terms of $\\omega$, $\\varepsilon_{0}$, $\\omega_{p e}$, $k_{\\parallel}$, $v_{T e}$, $\\ell$, and $|E_{\\parallel 0}|$, using the dimensionless parameter $\\zeta = \\omega/(k_{\\parallel} v_{T e})$ and the property of the plasma dispersion function that captures the Landau resonance. Your answer must be the total deposited power per unit area in joules per second per square meter (W m$^{-2}$). Do not substitute numerical values. Provide the final expression only.",
            "solution": "The problem statement will first be validated for scientific soundness, completeness, and objectivity.\n\n### Step 1: Extract Givens\n-   **System**: One-dimensional slab model of a magnetized fusion plasma.\n-   **Wave**: Lower hybrid wave (LHW) with angular frequency $\\omega$ and parallel wavenumber $k_{\\parallel} \\neq 0$.\n-   **Electric Field**: Parallel electric field component $E_{\\parallel}(x,t) = \\Re\\{E_{\\parallel 0}\\exp(-i\\omega t)\\}$ is uniform across a resonance layer of thickness $\\ell$. $E_{\\parallel 0}$ is a complex amplitude.\n-   **Electrons**: Described by a spatially uniform, isotropic Maxwellian equilibrium distribution with number density $n_{e}$ and temperature $T_{e}$.\n-   **Ions**: Assumed cold, negligible contribution to parallel Landau resonance.\n-   **Definitions**:\n    -   Electron thermal speed: $v_{T e} = \\sqrt{2 k_{B} T_{e}/m_{e}}$.\n    -   Electron plasma frequency: $\\omega_{p e} = \\sqrt{n_{e} e^{2}/(\\varepsilon_{0} m_{e})}$.\n    -   Dimensionless parameter: $\\zeta = \\omega/(k_{\\parallel} v_{T e})$.\n-   **Constants**: $e$ (elementary charge), $m_{e}$ (electron mass), $k_{B}$ (Boltzmann constant), $\\varepsilon_{0}$ (vacuum permittivity).\n-   **Task**:\n    1.  Model the electron parallel conduction current response $J_{\\parallel}$ to $E_{\\parallel}$.\n    2.  Evaluate the time-averaged local power density absorbed by electrons, $\\langle \\mathbf{E}\\cdot\\mathbf{J} \\rangle$, due to Landau resonance.\n    3.  Compute the total power deposited per unit area by integrating $\\langle \\mathbf{E}\\cdot\\mathbf{J} \\rangle$ across the layer thickness $\\ell$.\n    4.  Express the final answer as a single closed-form analytic expression in terms of $\\omega$, $\\varepsilon_{0}$, $\\omega_{p e}$, $k_{\\parallel}$, $v_{T e}$, $\\ell$, and $|E_{\\parallel 0}|$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n\n-   **Scientific Groundedness**: The problem is rooted in the standard kinetic theory of plasmas, specifically the Vlasov-Maxwell model. The concepts of lower hybrid waves, Landau damping, the plasma dispersion function, and power absorption are all fundamental and well-established in plasma physics and fusion science. The setup is a standard, simplified model used for analytical studies of wave-particle interactions.\n-   **Well-Posedness**: The problem is well-posed. It provides all necessary physical quantities and definitions ($\\omega$, $k_{\\parallel}$, $n_e$, $T_e$, $\\ell$, $E_{\\parallel 0}$) to derive a unique analytical solution for the power deposition per unit area. The assumptions (uniform layer, Maxwellian distribution, cold ions) serve to make the problem analytically tractable.\n-   **Objectivity**: The language is precise, quantitative, and free of any subjective or speculative claims. The terms are standard in the field.\n\nThe problem does not exhibit any flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, or trivial. It represents a a standard calculation in the field of computational fusion science.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\nThe time-averaged power density $P_V$ deposited by the wave into the electrons is given by the time average of the dot product of the electric field and the induced current, $P_V = \\langle \\mathbf{E} \\cdot \\mathbf{J} \\rangle$. For the parallel components, this is $P_V = \\langle E_{\\parallel} J_{\\parallel} \\rangle$.\n\nGiven the monochromatic nature of the wave, we use complex phasors. The parallel electric field is $E_{\\parallel}(t) = \\Re\\{E_{\\parallel 0} \\exp(-i\\omega t)\\}$, and the resulting parallel electron current will have the same temporal dependence, $J_{\\parallel}(t) = \\Re\\{J_{\\parallel 0} \\exp(-i\\omega t)\\}$. The time-averaged power density is then given by:\n$$\nP_V = \\frac{1}{2} \\Re\\{E_{\\parallel 0} J_{\\parallel 0}^*\\}\n$$\nwhere $J_{\\parallel 0}^*$ is the complex conjugate of the current amplitude.\n\nThe parallel electron current response is linearly related to the parallel electric field by the parallel conductivity, $\\sigma_{\\parallel}$, such that $J_{\\parallel 0} = \\sigma_{\\parallel} E_{\\parallel 0}$. Substituting this into the power density expression gives:\n$$\nP_V = \\frac{1}{2} \\Re\\{\\sigma_{\\parallel} E_{\\parallel 0} E_{\\parallel 0}^*\\} = \\frac{1}{2} \\Re\\{\\sigma_{\\parallel}\\} |E_{\\parallel 0}|^2\n$$\nPower is absorbed only if the conductivity has a non-zero real part, which corresponds to a dissipative process.\n\nThe conductivity $\\sigma_{\\parallel}$ is related to the parallel component of the dielectric susceptibility tensor for electrons, $\\chi_{ee, \\parallel}$, through the general relation derived from Maxwell's equations. The polarization current density is $J = \\frac{\\partial P}{\\partial t}$. In the frequency domain, this becomes $J_0 = -i\\omega P_0$. The polarization is $P_0 = \\varepsilon_0 \\chi E_0$. Combining these yields $J_0 = -i\\omega\\varepsilon_0 \\chi E_0$, from which we identify the conductivity as $\\sigma = -i\\omega\\varepsilon_0 \\chi$. For the parallel electron response:\n$$\n\\sigma_{\\parallel} = -i \\omega \\varepsilon_0 \\chi_{ee, \\parallel}\n$$\nThe real part of the conductivity is therefore:\n$$\n\\Re\\{\\sigma_{\\parallel}\\} = \\Re\\{-i \\omega \\varepsilon_0 (\\Re\\{\\chi_{ee, \\parallel}\\} + i\\Im\\{\\chi_{ee, \\parallel}\\})\\} = \\omega \\varepsilon_0 \\Im\\{\\chi_{ee, \\parallel}\\}\n$$\nThe power density can thus be written as:\n$$\nP_V = \\frac{1}{2} \\omega \\varepsilon_0 \\Im\\{\\chi_{ee, \\parallel}\\} |E_{\\parallel 0}|^2\n$$\nThe parallel susceptibility for electrons described by a Maxwellian distribution is a standard result from kinetic theory obtained by solving the linearized Vlasov equation:\n$$\n\\chi_{ee, \\parallel}(\\omega, k_{\\parallel}) = \\frac{\\omega_{pe}^2}{k_{\\parallel}^2 v_{Te}^2} [1 + \\zeta Z(\\zeta)]\n$$\nwhere $\\zeta = \\omega/(k_{\\parallel} v_{Te})$ is the ratio of the wave phase velocity to the electron thermal speed, and $Z(\\zeta)$ is the plasma dispersion function.\n\nThe power absorption associated with Landau damping arises from the imaginary part of $\\chi_{ee, \\parallel}$. For real $\\zeta$:\n$$\n\\Im\\{\\chi_{ee, \\parallel}\\} = \\frac{\\omega_{pe}^2}{k_{\\parallel}^2 v_{Te}^2} \\Im\\{1 + \\zeta Z(\\zeta)\\} = \\frac{\\omega_{pe}^2}{k_{\\parallel}^2 v_{Te}^2} \\zeta \\Im\\{Z(\\zeta)\\}\n$$\nThe problem specifies to use the property of the plasma dispersion function that captures Landau resonance. This is its imaginary part for real arguments, which results from the proper treatment of the resonant denominator in the velocity integral:\n$$\n\\Im\\{Z(\\zeta)\\} = \\sqrt{\\pi} \\exp(-\\zeta^2)\n$$\nSubstituting this into the expression for $\\Im\\{\\chi_{ee, \\parallel}\\}$ yields:\n$$\n\\Im\\{\\chi_{ee, \\parallel}\\} = \\frac{\\omega_{pe}^2}{k_{\\parallel}^2 v_{Te}^2} \\zeta \\sqrt{\\pi} \\exp(-\\zeta^2)\n$$\nNow, we can write the local power density absorbed by the electrons:\n$$\nP_V = \\frac{1}{2} \\omega \\varepsilon_0 |E_{\\parallel 0}|^2 \\left( \\frac{\\omega_{pe}^2}{k_{\\parallel}^2 v_{Te}^2} \\zeta \\sqrt{\\pi} \\exp(-\\zeta^2) \\right)\n$$\nTo express this in the most compact form using the given variables, we can substitute $k_{\\parallel}^2 v_{Te}^2 = \\omega^2 / \\zeta^2$ from the definition of $\\zeta$:\n$$\nP_V = \\frac{\\sqrt{\\pi}}{2} \\omega \\varepsilon_0 \\omega_{pe}^2 |E_{\\parallel 0}|^2 \\frac{1}{(\\omega^2 / \\zeta^2)} \\zeta \\exp(-\\zeta^2) = \\frac{\\sqrt{\\pi}}{2} \\varepsilon_0 \\frac{\\omega_{pe}^2}{\\omega} |E_{\\parallel 0}|^2 \\zeta^3 \\exp(-\\zeta^2)\n$$\nThe problem states that all relevant quantities ($n_e, T_e, E_{\\parallel 0}$) are uniform across a resonance layer of thickness $\\ell$. Therefore, the power density $P_V$ is constant throughout this layer. The total power deposited per unit area, $P_A$, is obtained by integrating $P_V$ across the thickness of the layer:\n$$\nP_A = \\int_0^{\\ell} P_V \\, dx = P_V \\cdot \\ell\n$$\nSubstituting the expression for $P_V$:\n$$\nP_A = \\frac{\\sqrt{\\pi}}{2} \\varepsilon_0 \\frac{\\omega_{pe}^2}{\\omega} \\ell |E_{\\parallel 0}|^2 \\zeta^3 \\exp(-\\zeta^2)\n$$\nThis is the final expression for the total deposited power per unit area, given in joules per second per square meter (W m$^{-2}$), in terms of the specified parameters.",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{\\pi}}{2} \\varepsilon_0 \\frac{\\omega_{pe}^2}{\\omega} \\ell |E_{\\parallel 0}|^2 \\zeta^3 \\exp(-\\zeta^2)}\n$$"
        },
        {
            "introduction": "This practice bridges theory and application by tasking you with building a computational model for power deposition. You will implement the Beer-Lambert attenuation law to simulate how an ECRH beam deposits its energy along a path through an inhomogeneous tokamak plasma. This hands-on coding exercise develops essential skills in translating a physical model into a working algorithm and analyzing the output to characterize the deposition profile .",
            "id": "4037839",
            "problem": "You are tasked with computing the deposited Electron Cyclotron Resonance Heating (ECRH) power profile using Beer–Lambert attenuation along a simplified straight radial ray trajectory in a toroidal plasma (tokamak) with given electron density and temperature profiles and launching geometry. The calculation must be performed from first principles grounded in conservation of electromagnetic energy flux and local absorption, using a physically plausible, self-consistent model.\n\nThe fundamental base to be used includes:\n- Conservation of energy flux for electromagnetic waves along a ray, leading to the Beer–Lambert law for attenuation.\n- Definition of local absorption described by an absorption coefficient that depends on local plasma conditions and resonance detuning.\n\nAssume a circular cross-section tokamak with minor radius $a$ in $\\mathrm{m}$, and model the electron density and electron temperature profiles as\n$$\nn_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\beta}, \\quad 0 \\le r \\le a,\n$$\n$$\nT_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\gamma}, \\quad 0 \\le r \\le a,\n$$\nwith $n_e(r) = 0$ and $T_e(r) = 0$ outside $0 \\le r \\le a$. Let the local absorption coefficient be modeled as\n$$\n\\alpha(r) = \\alpha_0 \\left(\\frac{n_e(r)}{n_{\\mathrm{ref}}}\\right) \\left(\\frac{T_{\\mathrm{ref}}}{T_e(r)}\\right) \\exp\\left(-\\frac{(r - r_{\\mathrm{res}})^2}{2\\sigma_{\\mathrm{res}}^2}\\right),\n$$\nwith $\\alpha(r)$ in $\\mathrm{m}^{-1}$, where $n_{\\mathrm{ref}}$ in $\\mathrm{m}^{-3}$ and $T_{\\mathrm{ref}}$ in $\\mathrm{eV}$ are reference values used to normalize the coefficient. The resonance center is at radius $r_{\\mathrm{res}}$ in $\\mathrm{m}$, with resonance width $\\sigma_{\\mathrm{res}}$ in $\\mathrm{m}$. This form captures the basic radiofrequency wave–particle resonance physics by modulating absorption with proximity to the cyclotron resonance and with local plasma parameters.\n\nAssume a single, straight radial ray is launched at the outboard edge with initial radius $r = a$, propagating inward toward $r = 0$ with path length parameter $s$ in $\\mathrm{m}$ satisfying $dr/ds = -1$. Let the initial beam power at launch be $P_0$ in $\\mathrm{W}$. Under Beer–Lambert attenuation, the power carried by the ray obeys\n$$\n\\frac{dI}{ds} = -\\alpha(r(s)) I(s),\n$$\nwhere $I(s)$ is the local wave power along the ray and $\\alpha(r)$ is as defined above. The absorbed power per unit path length is then $dP_{\\mathrm{abs}}/ds = \\alpha(r(s)) I(s)$. Discretize the path $s \\in [0, a]$ using $N_s$ uniform steps of size $ds = a/N_s$, and bin the deposited power into $N_r$ uniform radial bins covering $r \\in [0, a]$ of width $dr = a/N_r$ to form a deposited power density per unit radius profile $p(r)$ in $\\mathrm{W}/\\mathrm{m}$ such that its integral over $r$ equals the total absorbed power. In discrete form, at each step $i$ with mid-step radius $r_i$, the absorbed power is\n$$\n\\Delta P_{\\mathrm{abs}, i} = I_i \\left(1 - e^{-\\alpha(r_i) ds}\\right),\n$$\nwith the update $I_{i+1} = I_i - \\Delta P_{\\mathrm{abs}, i}$.\n\nFor each test case, compute:\n1. The absorbed fraction $f_{\\mathrm{abs}} = P_{\\mathrm{abs}}/P_0$ (dimensionless decimal).\n2. The radius of peak deposition $r_{\\mathrm{peak}}$ in $\\mathrm{m}$, defined as the bin center at which $p(r)$ attains its maximum value.\n3. The full width at half maximum $w_{\\mathrm{FWHM}}$ in $\\mathrm{m}$ of $p(r)$, computed using linear interpolation between radial bins to determine the two radii where $p(r)$ crosses half the peak value; if the profile does not cross on both sides, define $w_{\\mathrm{FWHM}} = 0$.\n\nYour program must implement this model and produce results for the following test suite. Use exactly these parameter values for each case.\n\nTest case $1$ (general \"happy path\"):\n- Minor radius: $a = 0.5\\,\\mathrm{m}$.\n- Launch power: $P_0 = 1.0 \\times 10^{6}\\,\\mathrm{W}$.\n- Electron density: $n_0 = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $\\beta = 0.8$.\n- Electron temperature: $T_0 = 3500\\,\\mathrm{eV}$, $\\gamma = 1.2$.\n- Absorption normalization: $n_{\\mathrm{ref}} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_{\\mathrm{ref}} = 3500\\,\\mathrm{eV}$.\n- Absorption parameters: $\\alpha_0 = 1.2\\,\\mathrm{m}^{-1}$, $r_{\\mathrm{res}} = 0.1\\,\\mathrm{m}$, $\\sigma_{\\mathrm{res}} = 0.07\\,\\mathrm{m}$.\n- Discretization: $N_s = 4000$, $N_r = 800$.\n\nTest case $2$ (off-axis, narrower resonance):\n- Minor radius: $a = 0.5\\,\\mathrm{m}$.\n- Launch power: $P_0 = 0.75 \\times 10^{6}\\,\\mathrm{W}$.\n- Electron density: $n_0 = 5.5 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $\\beta = 1.0$.\n- Electron temperature: $T_0 = 3000\\,\\mathrm{eV}$, $\\gamma = 1.4$.\n- Absorption normalization: $n_{\\mathrm{ref}} = 5.5 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_{\\mathrm{ref}} = 3000\\,\\mathrm{eV}$.\n- Absorption parameters: $\\alpha_0 = 0.9\\,\\mathrm{m}^{-1}$, $r_{\\mathrm{res}} = 0.3\\,\\mathrm{m}$, $\\sigma_{\\mathrm{res}} = 0.05\\,\\mathrm{m}$.\n- Discretization: $N_s = 5000$, $N_r = 1000$.\n\nTest case $3$ (edge case: weak absorption, resonance outside plasma):\n- Minor radius: $a = 0.5\\,\\mathrm{m}$.\n- Launch power: $P_0 = 1.0 \\times 10^{6}\\,\\mathrm{W}$.\n- Electron density: $n_0 = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $\\beta = 0.8$.\n- Electron temperature: $T_0 = 3500\\,\\mathrm{eV}$, $\\gamma = 1.2$.\n- Absorption normalization: $n_{\\mathrm{ref}} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_{\\mathrm{ref}} = 3500\\,\\mathrm{eV}$.\n- Absorption parameters: $\\alpha_0 = 0.05\\,\\mathrm{m}^{-1}$, $r_{\\mathrm{res}} = 0.6\\,\\mathrm{m}$, $\\sigma_{\\mathrm{res}} = 0.08\\,\\mathrm{m}$.\n- Discretization: $N_s = 4000$, $N_r = 800$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case contributing a sub-list of the form $[f_{\\mathrm{abs}}, r_{\\mathrm{peak}}, w_{\\mathrm{FWHM}}]$ and no spaces, for example: $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$. Express $r_{\\mathrm{peak}}$ and $w_{\\mathrm{FWHM}}$ in $\\mathrm{m}$ and $f_{\\mathrm{abs}}$ as a decimal. Angles are not used in this problem. Percentages must not be used; express $f_{\\mathrm{abs}}$ as a decimal between $0$ and $1$.",
            "solution": "### Problem Validation\n\n#### Step 1: Extract Givens\n\nThe problem provides the following explicit definitions, equations, and initial conditions:\n\n1.  **Tokamak and Plasma Profiles**:\n    -   Minor radius: $a$ in $\\mathrm{m}$.\n    -   Electron density profile: $n_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\beta}$ for $0 \\le r \\le a$.\n    -   Electron temperature profile: $T_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\gamma}$ for $0 \\le r \\le a$.\n    -   Outside the plasma ($r  a$): $n_e(r) = 0$ and $T_e(r) = 0$.\n\n2.  **Absorption Coefficient**:\n    -   Local absorption coefficient model: $\\alpha(r) = \\alpha_0 \\left(\\frac{n_e(r)}{n_{\\mathrm{ref}}}\\right) \\left(\\frac{T_{\\mathrm{ref}}}{T_e(r)}\\right) \\exp\\left(-\\frac{(r - r_{\\mathrm{res}})^2}{2\\sigma_{\\mathrm{res}}^2}\\right)$, with units of $\\mathrm{m}^{-1}$.\n    -   Reference parameters: $n_{\\mathrm{ref}}$ (in $\\mathrm{m}^{-3}$), $T_{\\mathrm{ref}}$ (in $\\mathrm{eV}$), $\\alpha_0$ (in $\\mathrm{m}^{-1}$), $r_{\\mathrm{res}}$ (in $\\mathrm{m}$), and $\\sigma_{\\mathrm{res}}$ (in $\\mathrm{m}$).\n\n3.  **Wave Propagation and Power Deposition**:\n    -   Ray trajectory: Straight radial path from $r=a$ to $r=0$.\n    -   Path parameterization: $s$ in $\\mathrm{m}$, with $dr/ds = -1$.\n    -   Initial power: $P_0$ in $\\mathrm{W}$ at $s=0$ (i.e., $r=a$).\n    -   Power attenuation law (Beer–Lambert): $\\frac{dI}{ds} = -\\alpha(r(s)) I(s)$, where $I(s)$ is the local power.\n    -   Absorbed power per unit path length: $dP_{\\mathrm{abs}}/ds = \\alpha(r(s)) I(s)$.\n\n4.  **Numerical Discretization**:\n    -   Path discretization: $N_s$ uniform steps of size $ds = a/N_s$.\n    -   Radial binning: $N_r$ uniform bins of width $dr = a/N_r$.\n    -   Discrete absorbed power per step: $\\Delta P_{\\mathrm{abs}, i} = I_i \\left(1 - e^{-\\alpha(r_i) ds}\\right)$ at mid-step radius $r_i$.\n    -   Power update rule: $I_{i+1} = I_i - \\Delta P_{\\mathrm{abs}, i}$.\n\n5.  **Required Outputs**:\n    -   Absorbed fraction: $f_{\\mathrm{abs}} = P_{\\mathrm{abs}}/P_0$.\n    -   Radius of peak deposition: $r_{\\mathrm{peak}}$, the center of the bin where the power density profile $p(r)$ is maximum.\n    -   Full Width at Half Maximum: $w_{\\mathrm{FWHM}}$ of $p(r)$, with a special condition ($w_{\\mathrm{FWHM}}=0$) if the profile does not cross the half-maximum threshold on both sides of the peak.\n\n#### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria:\n\n-   **Scientifically Grounded**: The problem is based on the fundamental principle of energy flux conservation leading to the Beer–Lambert law for wave attenuation, a core concept in physics. The application context is Electron Cyclotron Resonance Heating (ECRH) in a tokamak, a valid topic in computational fusion science. The plasma profiles ($n_e, T_e$) are standard, simplified models. The absorption coefficient $\\alpha(r)$ is a given phenomenological model. While its dependence on temperature as $1/T_e$ is not typical for standard ECRH theory (which often scales with positive powers of $T_e$), it does not violate any fundamental physical laws and is provided as an explicit definition for this problem. As such, the problem is a valid exercise in implementing a given, self-consistent physical model.\n\n-   **Well-Posed**: The problem is well-posed. The governing ordinary differential equation for power has a unique solution for the given initial condition. The numerical task is clearly defined with all necessary parameters, initial conditions, and discretization rules. The requested outputs are unambiguously defined.\n\n-   **Objective**: The problem statement is written in precise, objective language. All parameters are given as concrete numerical values, and all functional forms are explicit mathematical equations. There is no subjective or opinion-based content.\n\nThe problem does not exhibit any invalidity flaws. It is a self-contained, scientifically consistent, and well-posed numerical problem.\n\n#### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be provided.\n\n### Solution Design\n\nThe solution implements a numerical simulation of radiofrequency wave power deposition along a straight radial path in a tokamak plasma. The algorithm proceeds as follows:\n\n1.  **Discretization Setup**: The radial domain from $r=0$ to $r=a$ is discretized into $N_r$ uniform bins of width $dr = a/N_r$. The bin centers are stored. The ray path from $s=0$ (at $r=a$) to $s=a$ (at $r=0$) is discretized into $N_s$ steps of size $ds = a/N_s$. An array of mid-step radii, $r_{i} = a - (i+0.5)ds$ for $i=0, \\dots, N_s-1$, is created.\n\n2.  **Plasma and Absorption Profile Calculation**: To optimize the computation, the plasma parameters and the absorption coefficient are pre-calculated for all mid-step radii.\n    -   The electron density $n_e(r_i)$ and temperature $T_e(r_i)$ are computed for all $r_i$ using the given profile equations. This is done in a vectorized fashion using `numpy` for efficiency.\n    -   The absorption coefficient $\\alpha(r_i)$ is then computed for all $r_i$ using its definition, which depends on the pre-calculated $n_e(r_i)$ and $T_e(r_i)$ values. Since all $r_i$ are strictly within the domain $(0, a)$, singularities at $r=a$ (where $T_e=0$) are naturally avoided.\n\n3.  **Power Attenuation Simulation**: The core of the simulation is an iterative loop over the $N_s$ path steps.\n    -   The wave power $I$ is initialized to the launch power $P_0$. A variable for total absorbed power, $P_{\\mathrm{abs\\_total}}$, is initialized to $0$. An array to store the power deposited in each radial bin, `p_deposited_bins`, is initialized to zeros.\n    -   The loop iterates from $i=0$ to $N_s-1$. In each step $i$:\n        -   The power absorbed, $\\Delta P_{\\mathrm{abs}, i}$, is calculated. The discrete formula $I_i (1 - e^{-\\alpha(r_i) ds})$ is equivalent to solving the Beer-Lambert law exactly over a step with constant $\\alpha$. For numerical stability with small arguments, this is computed as $-I_i \\cdot \\mathrm{expm1}(-\\alpha(r_i) ds)$, where `expm1(x)` computes $e^x - 1$ accurately.\n        -   The ray power is updated for the next step: $I_{i+1} = I_i - \\Delta P_{\\mathrm{abs}, i}$.\n        -   The total absorbed power is accumulated: $P_{\\mathrm{abs\\_total}} = P_{\\mathrm{abs\\_total}} + \\Delta P_{\\mathrm{abs}, i}$.\n        -   The calculated $\\Delta P_{\\mathrm{abs}, i}$ is added to the corresponding radial bin. The bin index $j$ is determined by the mid-step radius $r_i$ via $j = \\lfloor r_i / dr \\rfloor$.\n\n4.  **Calculation of Output Metrics**: After the simulation loop completes, the final results are derived from the accumulated data.\n    -   **Power Density Profile**: The total power deposited in each bin is divided by the bin width $dr$ to obtain the power density profile $p(r)$ in $\\mathrm{W}/\\mathrm{m}$.\n    -   **Absorbed Fraction ($f_{\\mathrm{abs}}$)**: This is computed as the total absorbed power divided by the initial power: $f_{\\mathrm{abs}} = P_{\\mathrm{abs\\_total}} / P_0$.\n    -   **Peak Deposition Radius ($r_{\\mathrm{peak}}$)**: The index of the maximum value in the power density profile $p(r)$ is found. $r_{\\mathrm{peak}}$ is the radial coordinate of the center of this bin.\n    -   **Full Width at Half Maximum ($w_{\\mathrm{FWHM}}$)**:\n        -   The peak power density $p_{\\mathrm{max}}$ and the half-maximum value $p_{\\mathrm{half}} = p_{\\mathrm{max}}/2$ are determined.\n        -   If $p_{\\mathrm{max}} = 0$, $w_{\\mathrm{FWHM}}$ is $0$.\n        -   The algorithm searches for the two radii, $r_1  r_{\\mathrm{peak}}$ and $r_2  r_{\\mathrm{peak}}$, where the profile crosses $p_{\\mathrm{half}}$.\n        -   The left crossing $r_1$ is found by searching inward from the peak and performing linear interpolation between the two bin centers that straddle $p_{\\mathrm{half}}$.\n        -   The right crossing $r_2$ is found by searching outward from the peak and using similar linear interpolation.\n        -   If both crossings are successfully found, $w_{\\mathrm{FWHM}} = r_2 - r_1$. Otherwise, as per the problem definition, $w_{\\mathrm{FWHM}}=0$.\n\nThis structured approach ensures that all aspects of the problem are addressed correctly and efficiently, leading to an accurate computation of the required physical quantities.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the ECRH power deposition simulation for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: General \"happy path\"\n        {\n            'a': 0.5, 'P0': 1.0e6, 'n0': 6.0e19, 'beta': 0.8, 'T0': 3500.0, 'gamma': 1.2,\n            'n_ref': 6.0e19, 'T_ref': 3500.0, 'alpha0': 1.2, 'r_res': 0.1, 'sigma_res': 0.07,\n            'Ns': 4000, 'Nr': 800\n        },\n        # Case 2: Off-axis, narrower resonance\n        {\n            'a': 0.5, 'P0': 0.75e6, 'n0': 5.5e19, 'beta': 1.0, 'T0': 3000.0, 'gamma': 1.4,\n            'n_ref': 5.5e19, 'T_ref': 3000.0, 'alpha0': 0.9, 'r_res': 0.3, 'sigma_res': 0.05,\n            'Ns': 5000, 'Nr': 1000\n        },\n        # Case 3: Edge case: weak absorption, resonance outside plasma\n        {\n            'a': 0.5, 'P0': 1.0e6, 'n0': 6.0e19, 'beta': 0.8, 'T0': 3500.0, 'gamma': 1.2,\n            'n_ref': 6.0e19, 'T_ref': 3500.0, 'alpha0': 0.05, 'r_res': 0.6, 'sigma_res': 0.08,\n            'Ns': 4000, 'Nr': 800\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_deposition_profile(**params)\n        results.append(result)\n\n    formatted_sublists = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    print(f\"[{','.join(formatted_sublists)}]\")\n\ndef compute_deposition_profile(a, P0, n0, beta, T0, gamma, n_ref, T_ref, alpha0, r_res, sigma_res, Ns, Nr):\n    \"\"\"\n    Computes the ECRH power deposition profile and derived metrics for a single case.\n    \"\"\"\n    # 1. Discretization Setup\n    ds = a / Ns\n    dr = a / Nr\n    \n    # Mid-points of path steps\n    s_mids = (np.arange(Ns) + 0.5) * ds\n    r_mids = a - s_mids\n    \n    # Centers of radial bins\n    r_bin_centers = (np.arange(Nr) + 0.5) * dr\n\n    # 2. Profile and Coefficient Calculation (Vectorized)\n    r_norm_sq = (r_mids / a)**2\n    \n    # The term 1 - r_norm_sq is always  0 for mid-points\n    # as r_mids is always in (0, a)\n    profile_factor = 1.0 - r_norm_sq\n    \n    ne_vals = n0 * (profile_factor**beta)\n    Te_vals = T0 * (profile_factor**gamma)\n    \n    # Ensure no division by zero, although not expected with this discretization\n    Te_vals[Te_vals  1e-12] = 1e-12\n\n    alpha_vals = alpha0 * (ne_vals / n_ref) * (T_ref / Te_vals) * \\\n                 np.exp(-((r_mids - r_res)**2) / (2 * sigma_res**2))\n\n    # 3. Power Attenuation Simulation\n    I = P0\n    p_abs_total = 0.0\n    p_deposited_bins = np.zeros(Nr)\n\n    for i in range(Ns):\n        alpha_r = alpha_vals[i]\n        \n        # Power absorbed in this step, using expm1 for numerical stability\n        delta_p_abs = I * (-np.expm1(-alpha_r * ds))\n        \n        I -= delta_p_abs\n        p_abs_total += delta_p_abs\n        \n        # Bin the deposited power\n        r_mid = r_mids[i]\n        bin_idx = int(r_mid / dr)\n        if 0 = bin_idx  Nr:\n            p_deposited_bins[bin_idx] += delta_p_abs\n\n    # 4. Calculation of Output Metrics\n    f_abs = p_abs_total / P0 if P0  0 else 0.0\n    \n    if p_abs_total  1e-9:\n        return [f_abs, 0.0, 0.0]\n\n    p_profile = p_deposited_bins / dr\n\n    # Radis of peak deposition\n    j_max = np.argmax(p_profile)\n    r_peak = r_bin_centers[j_max]\n    \n    # FWHM\n    p_max = p_profile[j_max]\n    if p_max == 0:\n        return [f_abs, r_peak, 0.0]\n\n    p_half = p_max / 2.0\n    \n    r1, r2 = None, None\n    \n    # Find left crossing point r1 (from peak towards core)\n    # Check if profile at r=0 is already below half max\n    if p_profile[0] = p_half:\n        for j in range(j_max, 0, -1):\n            if p_profile[j]  p_half and p_profile[j-1] = p_half:\n                p_hi, p_lo = p_profile[j], p_profile[j-1]\n                r_hi, r_lo = r_bin_centers[j], r_bin_centers[j-1]\n                r1 = r_lo + (r_hi - r_lo) * (p_half - p_lo) / (p_hi - p_lo)\n                break\n                \n    # Find right crossing point r2 (from peak towards edge)\n    # Check if profile at r=a is already below half max\n    if p_profile[-1] = p_half:\n        for j in range(j_max, Nr - 1):\n            if p_profile[j]  p_half and p_profile[j+1] = p_half:\n                p_hi, p_lo = p_profile[j], p_profile[j+1]\n                r_hi, r_lo = r_bin_centers[j], r_bin_centers[j+1]\n                r2 = r_hi + (r_lo - r_hi) * (p_half - p_hi) / (p_lo - p_hi)\n                break\n\n    w_fwhm = 0.0\n    if r1 is not None and r2 is not None:\n        w_fwhm = r2 - r1\n        \n    return [f_abs, r_peak, w_fwhm]\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}