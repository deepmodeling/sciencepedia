{
    "hands_on_practices": [
        {
            "introduction": "掌握中性束沉积分布的第一步是在一个典型的场景下进行解析推导。这个练习将通过把比尔-朗伯定律应用于非均匀介质（这是聚变等离子体中的常见情况），来建立您的基础分析技能。您将为一个具有抛物线密度分布的等离子体推导穿透部分，这是一个核心计算，它揭示了等离子体密度剖面对束流衰减的直接影响。",
            "id": "4019509",
            "problem": "一条准直的中性束注入（NBI）束线穿过一个圆形截面的托卡马克等离子体，该等离子体的小半径为 $a$。束线沿一条直弦传播，其最小径向偏移（碰撞参数）为 $b$，其中 $0 \\leq b  a$。电子密度分布为抛物线形，$n(r) = n_{0}\\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right]$。假设存在一个与能量无关、空间均匀的有效衰减截面 $\\sigma$，该截面考虑了碰撞电离和电荷交换，同时散射和再中性化可忽略不计。设束线坐标 $s$ 沿弦定义，在最接近磁轴的点处 $s=0$。设等离子体内的径向映射为 $r(s) = \\sqrt{b^{2} + s^{2}}$，束流分别在 $s = -\\sqrt{a^{2} - b^{2}}$ 和 $s = +\\sqrt{a^{2} - b^{2}}$ 处进入和离开等离子体。利用准直束沿其路径穿过介质时指数衰减的第一性原理，推导穿透分数 $I(L)/I_{0}$ 的闭式表达式，其中 $I_{0}$ 是入射点处的入射束强度，$I(L)$ 是出射点处的透射强度，$L = 2\\sqrt{a^{2} - b^{2}}$ 是等离子体内的弦长。请将你的最终答案表示为关于 $n_{0}$、$a$、$b$ 和 $\\sigma$ 的单一解析表达式。无需进行数值计算或四舍五入。",
            "solution": "问题陈述已经过验证，被认为是自洽的、科学上基于粒子-物质相互作用原理且问题是适定的。所有给定的参数、函数和边界条件在物理上是一致的，并且足以推导出一个唯一的解析解。\n\n控制准直中性粒子束穿过介质时衰减的基本原理是比尔-朗伯定律。在无穷小路径长度 $ds$ 上，束流强度的微分变化 $dI$ 与局部强度 $I(s)$、衰减粒子的局域数密度 $n(s)$ 以及有效相互作用截面 $\\sigma$ 成正比。此关系表示为：\n$$\n\\frac{dI}{I(s)} = - \\sigma n(s) ds\n$$\n负号表示当束流穿透介质时，强度会降低。将此方程从束流入射点 $s_{entry}$ 积分到出射点 $s_{exit}$，可得出射强度 $I_{exit}$ 与入射强度 $I_{inc}$ 的比值。设入射点 $s_{entry}$ 处的强度为 $I_0$。则出射点 $s_{exit}$ 处的强度 $I(s_{exit})$ 由下式给出：\n$$\n\\ln\\left(\\frac{I(s_{exit})}{I_{0}}\\right) = - \\sigma \\int_{s_{entry}}^{s_{exit}} n(s) ds\n$$\n穿透分数是出射点的透射强度与入射点的入射强度之比，因此为：\n$$\n\\frac{I(s_{exit})}{I_{0}} = \\exp\\left(-\\sigma \\int_{s_{entry}}^{s_{exit}} n(s) ds \\right)\n$$\n问题将束流路径定义为穿过半径为 $a$ 的圆形等离子体的一条弦，其碰撞参数为 $b$。束线坐标 $s$ 沿该弦测量，在最接近中心的点处 $s=0$。束流在径向位置 $r$ 等于小半径 $a$ 的地方进入和离开等离子体。径向坐标 $r$ 和路径坐标 $s$ 之间的关系由 $r(s) = \\sqrt{b^{2} + s^{2}}$ 给出。因此，入射点和出射点对应于 $r(s)=a$，即 $a^{2} = b^{2} + s^{2}$，或 $s = \\pm\\sqrt{a^{2}-b^{2}}$。入射点是 $s_{entry} = -\\sqrt{a^{2}-b^{2}}$，出射点是 $s_{exit} = +\\sqrt{a^{2}-b^{2}}$。等离子体内的总弦长为 $L = 2\\sqrt{a^2-b^2}$，透射强度记为 $I(L)$。\n\n因此，穿透分数为：\n$$\n\\frac{I(L)}{I_{0}} = \\exp\\left(-\\sigma \\int_{-\\sqrt{a^{2}-b^{2}}}^{\\sqrt{a^{2}-b^{2}}} n(r(s)) ds \\right)\n$$\n电子密度分布由 $n(r) = n_{0}\\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right]$ 给出。我们必须通过代入 $r(s) = \\sqrt{b^{2} + s^{2}}$ 将此密度表示为路径坐标 $s$ 的函数：\n$$\nn(s) = n_{0}\\left[1 - \\frac{b^{2} + s^{2}}{a^{2}}\\right]\n$$\n指数中的积分，通常称为光学深度 $\\tau$，是密度沿弦的线积分：\n$$\n\\tau = \\sigma \\int_{-\\sqrt{a^{2}-b^{2}}}^{\\sqrt{a^{2}-b^{2}}} n_{0}\\left(1 - \\frac{b^{2} + s^{2}}{a^{2}}\\right) ds\n$$\n被积函数 $n(s)$ 是 $s$ 的偶函数，因为它只包含 $s^{2}$ 项。积分区间关于 $s=0$ 对称。因此，我们可以简化积分为：\n$$\n\\tau = 2 \\sigma n_{0} \\int_{0}^{\\sqrt{a^{2}-b^{2}}} \\left(1 - \\frac{b^{2}}{a^{2}} - \\frac{s^{2}}{a^{2}}\\right) ds\n$$\n对 $s$ 进行积分：\n$$\n\\tau = 2 \\sigma n_{0} \\left[ \\left(1 - \\frac{b^{2}}{a^{2}}\\right)s - \\frac{s^{3}}{3a^{2}} \\right]_{0}^{\\sqrt{a^{2}-b^{2}}}\n$$\n在上限 $s = \\sqrt{a^{2}-b^{2}}$ 处计算表达式（下限 $s=0$ 得到 $0$）：\n$$\n\\tau = 2 \\sigma n_{0} \\left[ \\left(\\frac{a^{2}-b^{2}}{a^{2}}\\right)\\sqrt{a^{2}-b^{2}} - \\frac{\\left(\\sqrt{a^{2}-b^{2}}\\right)^{3}}{3a^{2}} \\right]\n$$\n我们可以将 $(\\sqrt{a^{2}-b^{2}})^{3}$ 重写为 $(a^{2}-b^{2})\\sqrt{a^{2}-b^{2}}$，它等于 $(a^{2}-b^{2})^{3/2}$。\n$$\n\\tau = 2 \\sigma n_{0} \\left[ \\frac{(a^{2}-b^{2})^{3/2}}{a^{2}} - \\frac{(a^{2}-b^{2})^{3/2}}{3a^{2}} \\right]\n$$\n提出公共项：\n$$\n\\tau = 2 \\sigma n_{0} \\frac{(a^{2}-b^{2})^{3/2}}{a^{2}} \\left(1 - \\frac{1}{3}\\right)\n$$\n$$\n\\tau = 2 \\sigma n_{0} \\frac{(a^{2}-b^{2})^{3/2}}{a^{2}} \\left(\\frac{2}{3}\\right)\n$$\n$$\n\\tau = \\frac{4}{3} \\sigma n_{0} \\frac{(a^{2}-b^{2})^{3/2}}{a^{2}}\n$$\n将光学深度 $\\tau$ 的这个表达式代回穿透分数的公式，得到最终的闭式表达式：\n$$\n\\frac{I(L)}{I_{0}} = \\exp(-\\tau) = \\exp\\left(-\\frac{4}{3} \\sigma n_{0} \\frac{(a^{2}-b^{2})^{3/2}}{a^{2}}\\right)\n$$\n根据要求，该表达式用给定的参数 $n_{0}$、$a$、$b$ 和 $\\sigma$ 表示。",
            "answer": "$$\n\\boxed{\\exp\\left(-\\frac{4}{3} \\sigma n_{0} \\frac{\\left(a^{2}-b^{2}\\right)^{3/2}}{a^{2}}\\right)}\n$$"
        },
        {
            "introduction": "现在，我们将理论应用于一个实际的工程问题，这在聚变装置的运行中至关重要。这个练习将束流衰减物理与确保机器安全的关键任务联系起来。您将计算所需的最低等离子体密度，以防止过多的束流穿透对第一壁造成损害，同时还会使用更真实的、与能量相关的反应截面。",
            "id": "4019505",
            "problem": "一个视线中性束注入（NBI）系统，将束能量为 $E_{b}$ 的单能氘中性粒子发射，穿过一块厚度为 $L$ 的均匀、单电离、准中性等离子体板。未经电离或电荷交换就穿出等离子体的束功率份额，称为穿透份额 $\\phi_{\\mathrm{st}}$，必须保持在规定的安全极限 $\\phi_{\\mathrm{safe}}$ 以下，以避免下游壁承受过度的负载。从“单位长度上束中性粒子的移除量与等离子体密度和能量相关的有效截面之积成正比”这一动力学图像出发，推导在给定 $E_{b}$ 和 $L$ 的情况下，保证 $\\phi_{\\mathrm{st}} \\le \\phi_{\\mathrm{safe}}$ 的最小均匀等离子体密度 $n_{\\min}$ 的表达式。\n\n将有效移除截面建模为电子碰撞电离和电荷交换贡献之和，\n$$\n\\sigma_{\\mathrm{eff}}(E_{b}) \\equiv \\sigma_{i}(E_{b}) + \\sigma_{\\mathrm{cx}}(E_{b}),\n$$\n相对于参考能量 $E_{\\mathrm{ref}}$，其幂律标度关系为：\n$$\n\\sigma_{i}(E_{b}) = \\sigma_{i0}\\left(\\frac{E_{b}}{E_{\\mathrm{ref}}}\\right)^{-\\alpha_{i}}, \\quad \\sigma_{\\mathrm{cx}}(E_{b}) = \\sigma_{\\mathrm{cx}0}\\left(\\frac{E_{b}}{E_{\\mathrm{ref}}}\\right)^{-\\alpha_{\\mathrm{cx}}}.\n$$\n假设等离子体是准中性的，且离子为单电荷离子，因此电子密度等于离子密度，并可用整个路径上的单个均匀值 $n$ 表示；忽略幸存中性粒子的角散射和能量损失，因此功率份额等于幸存粒子份额。\n\n给定以下参数：$E_{b} = 80\\,\\mathrm{keV}$，$L = 1.4\\,\\mathrm{m}$，$\\phi_{\\mathrm{safe}} = 0.03$，$E_{\\mathrm{ref}} = 100\\,\\mathrm{keV}$，$\\sigma_{i0} = 1.0 \\times 10^{-20}\\,\\mathrm{m^{2}}$，$\\alpha_{i} = 0.50$，$\\sigma_{\\mathrm{cx}0} = 2.0 \\times 10^{-20}\\,\\mathrm{m^{2}}$，以及 $\\alpha_{\\mathrm{cx}} = 0.80$。\n\n将最终密度阈值 $n_{\\min}$ 以 $\\mathrm{m^{-3}}$ 为单位表示，并将答案四舍五入至四位有效数字。",
            "solution": "首先对问题进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：视线中性束注入（NBI）系统。\n- **束流**：能量为 $E_{b}$ 的单能氘中性粒子。\n- **等离子体**：厚度为 $L$ 的均匀、单电离、准中性等离子体板。\n- **穿透份额**：$\\phi_{\\mathrm{st}}$，未经相互作用穿出等离子体的束功率份额。\n- **安全极限**：$\\phi_{\\mathrm{st}} \\le \\phi_{\\mathrm{safe}}$。\n- **目标**：推导满足安全极限的最小均匀等离子体密度 $n_{\\min}$ 的表达式。\n- **物理模型**：单位长度内束中性粒子的移除量与等离子体密度 $n$ 和有效截面 $\\sigma_{\\mathrm{eff}}(E_{b})$ 的乘积成正比。\n- **截面定义**：$\\sigma_{\\mathrm{eff}}(E_{b}) \\equiv \\sigma_{i}(E_{b}) + \\sigma_{\\mathrm{cx}}(E_{b})$。\n- **截面标度关系**：\n  - 电子碰撞电离：$\\sigma_{i}(E_{b}) = \\sigma_{i0}\\left(\\frac{E_{b}}{E_{\\mathrm{ref}}}\\right)^{-\\alpha_{i}}$。\n  - 电荷交换：$\\sigma_{\\mathrm{cx}}(E_{b}) = \\sigma_{\\mathrm{cx}0}\\left(\\frac{E_{b}}{E_{\\mathrm{ref}}}\\right)^{-\\alpha_{\\mathrm{cx}}}$。\n- **假设**：\n  1. 具有单电荷离子的准中性：电子密度 $n_e$ 等于离子密度 $n_i$，两者均由单个值 $n$ 表示。\n  2. 等离子体密度 $n$ 是均匀的。\n  3. 幸存中性粒子的角散射和能量损失被忽略，因此功率份额等于幸存粒子份额。\n- **给定参数**：\n  - $E_{b} = 80\\,\\mathrm{keV}$\n  - $L = 1.4\\,\\mathrm{m}$\n  - $\\phi_{\\mathrm{safe}} = 0.03$\n  - $E_{\\mathrm{ref}} = 100\\,\\mathrm{keV}$\n  - $\\sigma_{i0} = 1.0 \\times 10^{-20}\\,\\mathrm{m^{2}}$\n  - $\\alpha_{i} = 0.50$\n  - $\\sigma_{\\mathrm{cx}0} = 2.0 \\times 10^{-20}\\,\\mathrm{m^{2}}$\n  - $\\alpha_{\\mathrm{cx}} = 0.80$\n- **要求输出**：$n_{\\min}$，单位为 $\\mathrm{m^{-3}}$，四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上基于粒子-物质相互作用的原理，特别是在等离子体中的中性束衰减，这是聚变科学与工程领域的一个标准课题。使用类似比尔-朗伯定律来描述衰减是一种有效且常用的一阶模型。截面的幂律标度关系是经验性的，但在给定能量范围内是符合实际的近似。该问题是适定的，提供了推导 $n_{\\min}$ 唯一解所需的所有物理关系、假设和数值常数。语言客观、精确。所提供的数值对于托卡马克NBI系统而言是符合物理实际的。该问题未违反任何无效性标准。\n\n### 步骤3：结论与行动\n问题是**有效的**。将推导解答。\n\n### 解答推导\n设 $I(x)$ 为中性束粒子在进入等离子体板距离 $x$ 处的通量。问题陈述，束中性粒子的移除率与局部中性粒子通量 $I(x)$、等离子体密度 $n$ 和有效移除截面 $\\sigma_{\\mathrm{eff}}$ 成正比。对于厚度为 $dx$ 的微分板，通量变化 $dI$ 由下式给出：\n$$\ndI = -I(x) \\, n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, dx\n$$\n这是一个关于 $I(x)$ 的一阶常微分方程。由于等离子体是均匀的（$n$ 是常数）且束是单能的（$E_b$ 是常数），截面 $\\sigma_{\\mathrm{eff}}(E_{b})$ 在束的路径上也为常数。我们可以重写方程，并对其在等离子体板上从 $x=0$ 到 $x=L$ 进行积分。\n$$\n\\frac{dI}{I} = -n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, dx\n$$\n从等离子体入口（$x=0$，通量为 $I_0$）积分到出口（$x=L$，通量为 $I_L$）：\n$$\n\\int_{I_0}^{I_L} \\frac{dI}{I} = \\int_{0}^{L} -n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, dx\n$$\n$$\n[\\ln(I)]_{I_0}^{I_L} = -n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, [x]_{0}^{L}\n$$\n$$\n\\ln(I_L) - \\ln(I_0) = -n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, L\n$$\n$$\n\\ln\\left(\\frac{I_L}{I_0}\\right) = -n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, L\n$$\n对两边取指数，得到衰减定律：\n$$\n\\frac{I_L}{I_0} = \\exp\\left(-n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, L\\right)\n$$\n穿透份额 $\\phi_{\\mathrm{st}}$ 定义为出射的束功率份额，根据问题的假设，它等于幸存粒子份额 $I_L/I_0$。\n$$\n\\phi_{\\mathrm{st}} = \\exp\\left(-n \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, L\\right)\n$$\n安全要求是 $\\phi_{\\mathrm{st}} \\le \\phi_{\\mathrm{safe}}$。为了找到实现这一点的最小密度 $n_{\\min}$，我们将 $\\phi_{\\mathrm{st}}$ 设置为其最大允许值 $\\phi_{\\mathrm{safe}}$：\n$$\n\\phi_{\\mathrm{safe}} = \\exp\\left(-n_{\\min} \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, L\\right)\n$$\n求解 $n_{\\min}$，我们对两边取自然对数：\n$$\n\\ln(\\phi_{\\mathrm{safe}}) = -n_{\\min} \\, \\sigma_{\\mathrm{eff}}(E_{b}) \\, L\n$$\n$$\nn_{\\min} = -\\frac{\\ln(\\phi_{\\mathrm{safe}})}{\\sigma_{\\mathrm{eff}}(E_{b}) \\, L}\n$$\n现在，我们必须计算 $\\sigma_{\\mathrm{eff}}(E_{b})$ 的数值。首先，我们使用给定的幂律标度关系计算各个截面。能量比为：\n$$\n\\frac{E_{b}}{E_{\\mathrm{ref}}} = \\frac{80\\,\\mathrm{keV}}{100\\,\\mathrm{keV}} = 0.8\n$$\n电子碰撞电离截面为：\n$$\n\\sigma_{i}(E_{b}) = \\sigma_{i0}\\left(\\frac{E_{b}}{E_{\\mathrm{ref}}}\\right)^{-\\alpha_{i}} = (1.0 \\times 10^{-20}\\,\\mathrm{m^{2}}) \\times (0.8)^{-0.50}\n$$\n$$\n\\sigma_{i}(E_{b}) \\approx (1.0 \\times 10^{-20}) \\times 1.118034\\,\\mathrm{m^{2}} = 1.118034 \\times 10^{-20}\\,\\mathrm{m^{2}}\n$$\n电荷交换截面为：\n$$\n\\sigma_{\\mathrm{cx}}(E_{b}) = \\sigma_{\\mathrm{cx}0}\\left(\\frac{E_{b}}{E_{\\mathrm{ref}}}\\right)^{-\\alpha_{\\mathrm{cx}}} = (2.0 \\times 10^{-20}\\,\\mathrm{m^{2}}) \\times (0.8)^{-0.80}\n$$\n$$\n\\sigma_{\\mathrm{cx}}(E_{b}) \\approx (2.0 \\times 10^{-20}) \\times 1.195430\\,\\mathrm{m^{2}} = 2.390860 \\times 10^{-20}\\,\\mathrm{m^{2}}\n$$\n总有效截面是这两者之和：\n$$\n\\sigma_{\\mathrm{eff}}(E_{b}) = \\sigma_{i}(E_{b}) + \\sigma_{\\mathrm{cx}}(E_{b}) \\approx (1.118034 + 2.390860) \\times 10^{-20}\\,\\mathrm{m^{2}}\n$$\n$$\n\\sigma_{\\mathrm{eff}}(E_{b}) \\approx 3.508894 \\times 10^{-20}\\,\\mathrm{m^{2}}\n$$\n最后，我们将 $\\phi_{\\mathrm{safe}}$、$L$ 和 $\\sigma_{\\mathrm{eff}}(E_{b})$ 的值代入 $n_{\\min}$ 的表达式中：\n$$\nn_{\\min} = -\\frac{\\ln(0.03)}{(3.508894 \\times 10^{-20}\\,\\mathrm{m^{2}}) \\times (1.4\\,\\mathrm{m})}\n$$\n$$\nn_{\\min} \\approx -\\frac{-3.506558}{4.912452 \\times 10^{-20}\\,\\mathrm{m^{3}}}\n$$\n$$\nn_{\\min} \\approx 0.713809 \\times 10^{20}\\,\\mathrm{m^{-3}}\n$$\n$$\nn_{\\min} \\approx 7.13809 \\times 10^{19}\\,\\mathrm{m^{-3}}\n$$\n将结果四舍五入到四位有效数字，得到：\n$$\nn_{\\min} = 7.138 \\times 10^{19}\\,\\mathrm{m^{-3}}\n$$",
            "answer": "$$\n\\boxed{7.138 \\times 10^{19}}\n$$"
        },
        {
            "introduction": "我们之前的模型将中性束视为理想的“笔形束”，但实际的束流具有有限的宽度和发散度。这个计算练习将演示如何使用卷积来模拟这种展宽效应，并量化其对峰值功率沉积的影响。理解这种效应对于准确预测加热效率和评估材料相互作用至关重要。",
            "id": "4019522",
            "problem": "考虑在环形聚变等离子体中的中性束注入 (NBI) 加热，沿小半径线近似为一维带符号的径向坐标 $r$（单位为米）。一个以 $\\mathrm{W\\,m^{-3}}$ 为单位的束状射束体沉积剖面 $S_0(r)$ 代表了没有束流发散情况下的理想化中心线沉积。中性束的有限角向发散和光学模糊通过一个标准差为 $\\sigma_G$（单位为米）、归一化为单位面积的高斯包络 $G(r)$ 来建模。展宽的沉积剖面 $S(r)$ 由卷积积分定义\n$$\nS(r) = \\int_{-\\infty}^{\\infty} S_0(r')\\,G(r - r')\\,dr' \\quad ,\n$$\n其中\n$$\nG(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_G}\\,\\exp\\left(-\\frac{r^2}{2\\sigma_G^2}\\right) \\quad ,\n$$\n使得 $\\int_{-\\infty}^{\\infty} G(r)\\,dr = 1$。峰值缩减因子 $\\mathcal{R}$ 是一个无量纲比率\n$$\n\\mathcal{R} = \\frac{S(0)}{S_0(0)} \\quad .\n$$\n您必须从第一性原理出发，使用离散网格通过数值积分实现卷积，并为每个测试用例计算 $\\mathcal{R}$。您的程序必须在 $[-0.5,\\,0.5]\\,\\mathrm{m}$ 区间内用 $N = 65536$ 个点均匀采样 $r$，并使用黎曼和近似来计算积分。每个测试用例最终只需要峰值缩减因子 $\\mathcal{R}$ (无量纲) 这一个量。\n\n使用以下束状射束剖面 $S_0(r)$ 和高斯包络宽度 $\\sigma_G$ 的测试套件，所有幅值单位为 $\\mathrm{W\\,m^{-3}}$，所有长度单位为 $\\mathrm{m}$：\n\n- 测试用例 $1$ (“高斯束状射束”):\n  - $S_0(r) = S_{00}\\,\\exp\\left(-\\frac{r^2}{2\\sigma_0^2}\\right)$\n  - $S_{00} = 2.0\\times 10^{6}\\,\\mathrm{W\\,m^{-3}}$\n  - $\\sigma_0 = 0.015\\,\\mathrm{m}$\n  - $\\sigma_G = 0.010\\,\\mathrm{m}$\n\n- 测试用例 $2$ (“平顶帽束状射束”):\n  - 当 $\\lvert r \\rvert \\le \\frac{w_0}{2}$ 时，$S_0(r) = S_{00}$，其他情况下 $S_0(r) = 0$\n  - $S_{00} = 1.5\\times 10^{6}\\,\\mathrm{W\\,m^{-3}}$\n  - $w_0 = 0.010\\,\\mathrm{m}$\n  - $\\sigma_G = 0.015\\,\\mathrm{m}$\n\n- 测试用例 $3$ (“近狄拉克包络极限”):\n  - $S_0(r) = S_{00}\\,\\exp\\left(-\\frac{r^2}{2\\sigma_0^2}\\right)$\n  - $S_{00} = 1.0\\times 10^{6}\\,\\mathrm{W\\,m^{-3}}$\n  - $\\sigma_0 = 0.008\\,\\mathrm{m}$\n  - $\\sigma_G = 1.0\\times 10^{-4}\\,\\mathrm{m}$\n\n- 测试用例 $4$ (“强模糊极限”):\n  - $S_0(r) = S_{00}\\,\\exp\\left(-\\frac{r^2}{2\\sigma_0^2}\\right)$\n  - $S_{00} = 2.0\\times 10^{6}\\,\\mathrm{W\\,m^{-3}}$\n  - $\\sigma_0 = 0.005\\,\\mathrm{m}$\n  - $\\sigma_G = 0.050\\,\\mathrm{m}$\n\n实现要求和假设：\n- 使用 $N = 65536$ 个样本将 $r$ 在 $[-0.5,\\,0.5]\\,\\mathrm{m}$ 上离散化。设 $\\Delta r$ 为网格间距，单位为米。\n- 根据每个测试用例的定义构建 $S_0(r)$。\n- 按照给定方式构建高斯包络 $G(r)$，确保在连续域上单位面积归一化。在离散网格上，使用黎曼和近似积分，因此 $S(0) \\approx \\Delta r \\sum_{k=0}^{N-1} S_0(r_k)\\,G(r_k)$，这里利用了 $G(r)$ 的偶对称性。\n- 从 $r=0$ 处的采样 $S_0(r)$ 计算 $S_0(0)$。\n- 为每个测试用例计算峰值缩减因子 $\\mathcal{R} = S(0)/S_0(0)$。\n\n您的程序应生成单行输出，其中包含四个 $\\mathcal{R}$ 值，形式为方括号括起来的逗号分隔列表，每个值格式化为六位小数（例如 $[\\text{r}_1,\\text{r}_2,\\text{r}_3,\\text{r}_4]$）。输出的 $\\mathcal{R}$ 值必须是无量纲的。不应打印任何其他文本。",
            "solution": "问题要求计算聚变等离子体中因物理效应而展宽的中性束沉积剖面的峰值缩减因子 $\\mathcal{R}$。解决方案需要基于所提供的物理模型和实现规范来开发一个数值算法。\n\n核心物理过程是由于束流发散等效应，理想化的束状射束沉积剖面 $S_0(r)$ 展宽成更符合实际的剖面 $S(r)$。这种展宽在数学上被建模为初始剖面 $S_0(r)$ 与高斯模糊核 $G(r)$ 的卷积。卷积由以下积分给出：\n$$\nS(r) = (S_0 * G)(r) = \\int_{-\\infty}^{\\infty} S_0(r')\\,G(r - r')\\,dr'\n$$\n高斯核 $G(r)$ 定义为：\n$$\nG(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_G}\\,\\exp\\left(-\\frac{r^2}{2\\sigma_G^2}\\right)\n$$\n其中 $\\sigma_G$ 是代表模糊程度的标准差。该函数被归一化，使其在整个定义域上的积分为 1，即 $\\int_{-\\infty}^{\\infty} G(r)\\,dr = 1$。\n\n我们感兴趣的量是峰值缩减因子 $\\mathcal{R}$，定义为展宽剖面的峰值与原始剖面峰值的比率：\n$$\n\\mathcal{R} = \\frac{S(0)}{S_0(0)}\n$$\n为了计算 $\\mathcal{R}$，我们首先需要 $S(0)$ 的表达式。将 $r=0$ 代入卷积积分，我们得到：\n$$\nS(0) = \\int_{-\\infty}^{\\infty} S_0(r')\\,G(0 - r')\\,dr' = \\int_{-\\infty}^{\\infty} S_0(r')\\,G(-r')\\,dr'\n$$\n高斯函数是一个偶函数，意味着 $G(-r') = G(r')$。这个性质将 $S(0)$ 的表达式简化为：\n$$\nS(0) = \\int_{-\\infty}^{\\infty} S_0(r')\\,G(r')\\,dr'\n$$\n这个结果意义重大，因为它表明要找到展宽剖面的峰值 $S(0)$，我们不需要为所有的 $r$ 计算完整的卷积。相反，我们只需要计算两个原始函数乘积的单个定积分。\n\n问题要求采用数值方法计算该积分。我们将在离散网格上使用黎曼和近似。数值实现的步骤如下：\n\n1.  **网格离散化**：连续径向坐标 $r$ 在 $[-0.5, 0.5]\\,\\mathrm{m}$ 区间上被离散化为 $N = 65536$ 个点。问题陈述要求在 $r=0$ 处采样以获得 $S_0(0)$。对于偶数点数 $N$，一个包含两个端点的标准网格（如 `numpy.linspace(start, stop, N)`）将不包含 $r=0$ 点。因此，为确保与所有陈述的要求一致，该区间被解释为 $[-0.5, 0.5)$，不包括右端点。这定义了一个间距为 $\\Delta r = (0.5 - (-0.5))/N = 1/N$ 的网格，网格点为 $r_k = -0.5 + k \\cdot \\Delta r$，其中 $k \\in \\{0, 1, \\dots, N-1\\}$。对于 $N=65536$，点 $r=0$ 对应于索引 $k = N/2 = 32768$。\n\n2.  **函数采样**：函数 $S_0(r)$ 和 $G(r)$ 在离散网格上的每个点 $r_k$ 处被求值，以创建它们的值的数组，我们记为 $S_{0,k}$ 和 $G_k$。对于每个测试用例，使用 $S_0(r)$ 的特定形式和参数。\n\n3.  **数值积分**：$S(0)$ 的积分通过黎曼和近似：\n    $$\n    S(0) \\approx \\sum_{k=0}^{N-1} S_0(r_k)\\,G(r_k)\\,\\Delta r\n    $$\n    这是对指定数值积分规则的直接应用。所选的 $[-0.5, 0.5]\\,\\mathrm{m}$ 积分域是无限积分的一个有效近似，因为函数的特征宽度（在 $0.005\\,\\mathrm{m}$ 至 $0.05\\,\\mathrm{m}$ 的范围内）确保了函数值在域边界处可以忽略不计。\n\n4.  **峰值计算**：值 $S_0(0)$ 是未展宽剖面的峰值。由于网格的构建包含 $r=0$，这个值可以通过在 $r=0$ 处对 $S_0(r)$ 采样直接获得。对于所有提供的测试用例，$S_0(r)$ 的解析形式都以 $r=0$ 为中心，其峰值由参数 $S_{00}$ 给出。因此，$S_0(0) = S_{00}$。\n\n5.  **比率计算**：最后，通过将数值计算出的 $S(0)$ 除以峰值 $S_0(0)$ 来计算峰值缩减因子 $\\mathcal{R}$。\n\n此过程应用于指定的四个测试用例中的每一个：\n- **情况1**：高斯束状射束与高斯包络的卷积。解析上已知结果是另一个高斯函数，这为验证数值实现提供了一种方法。\n- **情况2**：平顶帽（矩形）束状射束与高斯函数的卷积。这测试了算法处理不连续函数的能力。\n- **情况3**：高斯束状射束与一个非常窄的高斯包络的卷积，该包络接近狄拉克δ函数。在此极限下，卷积应返回原始函数，因此 $\\mathcal{R}$ 应非常接近于 $1$。\n- **情况4**：一个窄的高斯束状射束与一个非常宽的高斯包络的卷积。这代表了强烈的模糊效应，应导致显著的峰值降低，即 $\\mathcal{R}$ 的值很小。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the peak reduction factor for neutral beam deposition profiles\n    based on a convolution model, computed via numerical quadrature.\n    \"\"\"\n    \n    # Define grid parameters as per the problem statement.\n    N = 65536\n    r_min, r_max = -0.5, 0.5  # meters\n    \n    # Discretize the radial coordinate r.\n    # The interval is interpreted as [r_min, r_max) to ensure r=0 is a grid point\n    # for an even N, which is required to sample S0(0) directly as instructed.\n    # The grid spacing dr will be (r_max - r_min) / N.\n    r, dr = np.linspace(r_min, r_max, N, endpoint=False, retstep=True)\n\n    # Define the test cases from the problem statement.\n    # Units: S00 in W/m^3; sigma0, w0, sigmaG in m.\n    test_cases = [\n        # Case 1: Gaussian pencil-beam\n        {'type': 'gaussian', 'S00': 2.0e6, 'sigma0': 0.015, 'sigmaG': 0.010},\n        # Case 2: Top-hat pencil-beam\n        {'type': 'tophat', 'S00': 1.5e6, 'w0': 0.010, 'sigmaG': 0.015},\n        # Case 3: Near-delta envelope limit\n        {'type': 'gaussian', 'S00': 1.0e6, 'sigma0': 0.008, 'sigmaG': 1.0e-4},\n        # Case 4: Strong blur limit\n        {'type': 'gaussian', 'S00': 2.0e6, 'sigma0': 0.005, 'sigmaG': 0.050},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Construct the pencil-beam profile S0(r) on the discrete grid.\n        if case['type'] == 'gaussian':\n            S0_r = case['S00'] * np.exp(-r**2 / (2 * case['sigma0']**2))\n        elif case['type'] == 'tophat':\n            S0_r = np.where(np.abs(r) = case['w0'] / 2, case['S00'], 0.0)\n\n        # Construct the Gaussian envelope G(r) on the discrete grid.\n        sigmaG = case['sigmaG']\n        G_r = (1 / (np.sqrt(2 * np.pi) * sigmaG)) * np.exp(-r**2 / (2 * sigmaG**2))\n\n        # Calculate S(0) via Riemann sum approximation of the integral:\n        # S(0) = integral(S0(r) * G(r) dr)\n        S_at_0 = np.sum(S0_r * G_r) * dr\n\n        # The peak of the original profile, S0(0), is the amplitude S00, as\n        # all profiles are centered at r=0 and the grid includes r=0.\n        S0_peak = case['S00']\n        \n        # Calculate the dimensionless peak reduction factor R.\n        R_factor = S_at_0 / S0_peak\n        results.append(R_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{res:.6f}' for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}