{
    "hands_on_practices": [
        {
            "introduction": "To build robust plasma simulations, one must first master the implementation of boundary conditions and understand their consequences. This first exercise provides a direct, hands-on opportunity to code and test two fundamental types: periodic and absorbing boundary conditions, using the simple yet physically relevant model of a shear Alfvén wave . By implementing a first-order upwind scheme and measuring the resulting phase error and amplitude decay, you will gain practical insight into the concepts of numerical dispersion and dissipation, which are inherent properties of virtually all discrete simulation schemes.",
            "id": "3946071",
            "problem": "You are to implement a one-dimensional numerical experiment for the linear shear Alfvén wave using a first-order upwind scheme and evaluate the effects of boundary conditions and solver accuracy through phase error and amplitude decay. The physical base is ideal magnetohydrodynamics (MHD), linearized about a uniform magnetic field, which yields the Elsässer form for shear Alfvén waves. For a constant background magnetic field $B_0$ and mass density $\\rho_0$, the Alfvén speed is given by the well-tested formula $v_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$, where $\\mu_0$ is the magnetic permeability of free space. In the linear regime for a one-dimensional shear Alfvén wave, the Elsässer variable $z^+$ satisfies the pure advection equation $\\partial_t z^+ + v_A \\partial_x z^+ = 0$, whose plane-wave solutions have dispersion relation $\\omega = k v_A$. For a single-mode periodic wave $u(x,t) = \\sin(k x - \\omega t)$ or $u(x,t) = \\cos(k x - \\omega t)$, the exact amplitude is constant and the phase advances linearly with time.\n\nYour program must:\n- Discretize $\\partial_t u + v_A \\partial_x u = 0$ using a first-order upwind scheme on a uniform grid in one spatial dimension.\n- Implement two types of boundary conditions:\n  - Periodic boundary conditions.\n  - Absorbing boundary conditions via a damping \"sponge\" layer near the outflow boundary, modeled by adding a term $- \\sigma(x) u$ to the right-hand side, where $\\sigma(x)$ is nonzero only in the sponge region and smoothly increases toward the boundary.\n- Use the Fourier transform to extract the phase of a chosen periodic mode and compute the phase error in radians against the exact dispersion relation at the final simulation time. The angle unit must be radians.\n- Compute the amplitude decay (ratio of final to initial amplitude) of the fundamental mode for periodic runs. For the absorbing case, compute the residual interior amplitude ratio after the pulse has exited the domain (excluding the sponge region). All amplitude ratios are dimensionless.\n\nStart from the following fundamental base:\n- Ideal magnetohydrodynamics (MHD) linearized about a uniform field.\n- The Alfvén speed $v_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$.\n- The linear advection equation $\\partial_t u + v_A \\partial_x u = 0$.\n- The exact dispersion relation $\\omega = k v_A$ and period $T = 2\\pi / \\omega$.\n- The Courant-Friedrichs-Lewy (CFL) number $C = v_A \\Delta t / \\Delta x$ for stability in the upwind scheme.\n\nNumerical method requirements:\n- For a positive Alfvén speed $v_A > 0$, update the solution on grid index $i$ by $u_i^{n+1} = u_i^n - C (u_i^n - u_{i-1}^n)$.\n- For periodic boundary conditions, set $u_{-1}^n \\equiv u_{N-1}^n$.\n- For absorbing boundary conditions, use outflow on the right boundary and include a sponge layer damping update $u_i^{n+1} \\leftarrow u_i^{n+1} (1 - \\sigma_i \\Delta t)$ with a smooth $\\sigma_i$ over the last portion of the domain.\n\nDefine the phase error as the wrapped difference between the measured phase advance of the chosen Fourier mode and the exact phase advance $-\\omega t_{\\text{end}}$, expressed in radians. Define the amplitude ratio as the ratio of the magnitude of the chosen Fourier mode at $t_{\\text{end}}$ to its magnitude at $t = 0$ for periodic runs. For the absorbing case, define the residual amplitude ratio as the maximum absolute interior amplitude (excluding the sponge region) at $t_{\\text{end}}$ divided by the initial maximum interior amplitude.\n\nPhysical and numerical units:\n- Use meters for length, seconds for time, kilograms per cubic meter for mass density, and Tesla for magnetic field.\n- Express the phase error in radians.\n- Express amplitude ratios as dimensionless floats.\n\nTest suite and parameters:\n- Case $1$ (periodic, moderate stability).\n  - Domain length $L = 2\\pi$ meters, grid points $N = 256$.\n  - Background magnetic field $B_0 = 3$ Tesla, mass density $\\rho_0 = 1.67 \\times 10^{-7}$ kilograms per cubic meter, magnetic permeability $\\mu_0 = 4\\pi \\times 10^{-7}$ newton per ampere squared.\n  - Mode number $m = 3$ (so $k = m$ on $[0, 2\\pi)$), initial condition $u(x,0) = \\sin(m x)$.\n  - Courant-Friedrichs-Lewy (CFL) number $C = 0.2$.\n  - Final time $t_{\\text{end}}$ equal to the smallest multiple of $\\Delta t$ not less than the exact period $T = 2\\pi / (v_A m)$.\n  - Outputs: phase error in radians and amplitude ratio for the fundamental mode.\n\n- Case $2$ (periodic, near-CFL limit).\n  - Same as Case $1$ except $C = 0.9$.\n  - Outputs: phase error in radians and amplitude ratio for the fundamental mode.\n\n- Case $3$ (absorbing, outgoing pulse).\n  - Domain length $L = 10$ meters, grid points $N = 512$.\n  - Background magnetic field $B_0 = 0.1$ Tesla, mass density $\\rho_0 = 10^{-6}$ kilograms per cubic meter, magnetic permeability $\\mu_0 = 4\\pi \\times 10^{-7}$ newton per ampere squared.\n  - Courant-Friedrichs-Lewy (CFL) number $C = 0.5$.\n  - Initial condition: a right-going localized Alfvén pulse $u(x,0) = \\sin(k_0 x) \\exp\\left(-\\frac{(x - x_c)^2}{2 w^2}\\right)$ with $k_0 = 6$ radians per meter, center $x_c = L/4$, and envelope width $w = 0.5$ meters.\n  - Absorbing sponge region of width $L_s = 2$ meters adjacent to the right boundary, with damping profile $\\sigma(x) = \\sigma_0 \\left(\\frac{x - (L - L_s)}{L_s}\\right)^2$ for $x \\ge L - L_s$ and $\\sigma(x) = 0$ otherwise, where $\\sigma_0 = 50$ per second.\n  - Final time $t_{\\text{end}}$ sufficient for the pulse to exit the interior domain: $t_{\\text{end}} = \\left( L - x_c + 3 w \\right) / v_A$ rounded up to the nearest multiple of $\\Delta t$.\n  - Output: residual interior amplitude ratio excluding the sponge region.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order: $[\\text{phase\\_error\\_case1}, \\text{amplitude\\_ratio\\_case1}, \\text{phase\\_error\\_case2}, \\text{amplitude\\_ratio\\_case2}, \\text{residual\\_amplitude\\_ratio\\_case3}]$. All phase errors must be in radians, and all amplitude ratios are dimensionless floats. No additional text should be printed.",
            "solution": "The problem is valid. It presents a well-posed numerical experiment in computational plasma physics, grounded in the established principles of linearized ideal magnetohydrodynamics (MHD). All parameters and conditions are scientifically sound, consistent, and sufficient to obtain a unique numerical solution.\n\nThe core of the problem is to solve the one-dimensional linear advection equation for a shear Alfvén wave, given by:\n$$\n\\partial_t u + v_A \\partial_x u = 0\n$$\nwhere $u$ represents the magnitude of a field perturbation (e.g., a component of the Elsässer variable $z^+$), and $v_A$ is the constant Alfvén speed. The Alfvén speed is determined by the background magnetic field $B_0$ and mass density $\\rho_0$ through the relation:\n$$\nv_A = \\frac{B_0}{\\sqrt{\\mu_0 \\rho_0}}\n$$\nwhere $\\mu_0$ is the permeability of free space. Since $v_A$ is given to be positive, the wave propagates in the positive $x$ direction.\n\nWe will discretize this equation on a uniform spatio-temporal grid. The spatial domain of length $L$ is divided into $N$ grid cells of width $\\Delta x = L/N$, with grid points $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N-1$. Time is advanced in discrete steps of $\\Delta t$, such that $t_n = n \\Delta t$.\n\nThe numerical scheme specified is the first-order upwind method. For $v_A > 0$, the spatial derivative $\\partial_x u$ at grid point $x_i$ is approximated using a first-order backward difference:\n$$\n\\left. \\partial_x u \\right|_{i} \\approx \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\nwhere $u_i$ denotes the value of $u$ at $x_i$. Using a forward Euler method for the time derivative $\\partial_t u \\approx (u_i^{n+1} - u_i^n)/\\Delta t$, the fully discretized equation becomes:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} + v_A \\frac{u_i^n - u_{i-1}^n}{\\Delta x} = 0\n$$\nRearranging for the solution at the next time step, $u_i^{n+1}$, we obtain the specified update rule:\n$$\nu_i^{n+1} = u_i^n - \\frac{v_A \\Delta t}{\\Delta x} (u_i^n - u_{i-1}^n) = u_i^n - C (u_i^n - u_{i-1}^n)\n$$\nHere, $C = v_A \\Delta t / \\Delta x$ is the Courant-Friedrichs-Lewy (CFL) number. For this explicit scheme, stability is guaranteed for $C \\le 1$.\n\nThe problem requires implementing two types of boundary conditions:\n\n1.  **Periodic Boundary Conditions**: For a domain periodic in $x$, the grid points are topologically connected in a ring. The value $u_{-1}^n$ required for the stencil at $i=0$ is taken from the other end of the domain: $u_{-1}^n \\equiv u_{N-1}^n$. This is efficiently implemented using a circular shift operation on the solution array.\n\n2.  **Absorbing Boundary Conditions**: To prevent unphysical reflections from the outflow boundary ($x=L$), a \"sponge\" layer is introduced. This is achieved by adding a damping term to the PDE, making it $\\partial_t u + v_A \\partial_x u = - \\sigma(x) u$. The damping coefficient $\\sigma(x)$ is non-zero only in a \"sponge\" region near the boundary. The problem specifies an operator-split approach for the update. First, the advection step is performed, yielding an intermediate state $u_i^{\\star}$. Then, the damping is applied:\n    $$\n    u_i^{\\star} = u_i^n - C (u_i^n - u_{i-1}^n)\n    $$\n    $$\n    u_i^{n+1} = u_i^{\\star} (1 - \\sigma_i \\Delta t)\n    $$\n    The damping coefficient $\\sigma_i = \\sigma(x_i)$ is zero outside the sponge region. For the inflow boundary at $x=0$, since the initial wave packet is localized far from it and moves away, a simple zero-gradient condition, $u_{-1}^n = u_0^n$, is a reasonable and sufficient choice. This simplifies the advection update at $i=0$ to $u_0^{n+1} = u_0^n$.\n\nThe analysis of the numerical results involves two key metrics:\n\n-   **Phase Error**: The upwind scheme introduces numerical dispersion, causing waves of different wavelengths to travel at slightly different speeds. The exact dispersion relation is $\\omega = k v_A$, which implies a phase advance of $\\Delta \\phi_{\\text{exact}} = -\\omega t_{\\text{end}}$ over a time $t_{\\text{end}}$. We measure the numerical phase advance by tracking a specific Fourier mode $m$. The initial phase $\\phi_m(0)$ and final phase $\\phi_m(t_{\\text{end}})$ are computed as the argument of the $m$-th coefficient of the Fast Fourier Transform (FFT) of the solution at $t=0$ and $t=t_{\\text{end}}$, respectively. The measured phase advance is $\\Delta \\phi_{\\text{num}} = \\phi_m(t_{\\text{end}}) - \\phi_m(0)$. The phase error is the wrapped difference: $\\epsilon_\\phi = \\text{wrap}(\\Delta \\phi_{\\text{num}} - \\Delta \\phi_{\\text{exact}})$, where $\\text{wrap}(x)$ maps $x$ to the interval $(-\\pi, \\pi]$.\n\n-   **Amplitude Ratio**: The first-order upwind scheme is also dissipative, causing the amplitude of waves to decay over time. For periodic cases, this is measured as the ratio of the final to initial amplitude of the fundamental mode, $|c_m(t_{\\text{end}})| / |c_m(0)|$. For the absorbing case, the metric is the residual interior amplitude ratio, defined as the maximum absolute amplitude in the domain (excluding the sponge region) at $t_{\\text{end}}$, divided by the initial maximum absolute amplitude in the same region. This quantifies the effectiveness of the sponge layer in absorbing the wave and preventing reflections.\n\nThe implementation will proceed by setting up the grid and parameters for each of the three test cases, running the time-stepping loop with the appropriate boundary conditions, and then performing the specified analysis to compute the required outputs.\n\n**Case 1 & 2**: These cases compare a moderately stable CFL number ($C=0.2$) with one near the stability limit ($C=0.9$) for a single-mode sinusoidal wave on a periodic domain. The final time is one exact wave period, $T = 2\\pi/(m v_A)$. This allows for a direct assessment of the scheme's cumulative phase error and dissipation over a characteristic timescale.\n\n**Case 3**: This case tests the absorbing boundary condition. A localized Gaussian-modulated wave packet is initialized and evolved for a time sufficient for it to propagate across the domain and into the sponge layer. The analysis focuses on the residual wave energy left in the physical domain, indicating the performance of the absorbing layer.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves a 1D linear advection equation for shear Alfvén waves\n    using a first-order upwind scheme, evaluating phase error and\n    amplitude decay under periodic and absorbing boundary conditions.\n    \"\"\"\n\n    def wrap_phase(phi):\n        \"\"\"Wraps a phase angle to the interval (-pi, pi].\"\"\"\n        return (phi + np.pi) % (2 * np.pi) - np.pi\n\n    def run_case_periodic(C_val):\n        \"\"\"\n        Runs a simulation for the periodic boundary condition case.\n\n        Args:\n            C_val (float): The Courant-Friedrichs-Lewy (CFL) number.\n\n        Returns:\n            tuple: A tuple containing the phase error (radians) and\n                   the amplitude ratio (dimensionless).\n        \"\"\"\n        # Parameters\n        L = 2.0 * np.pi\n        N = 256\n        B0 = 3.0\n        rho0 = 1.67e-7\n        mu0 = 4.0 * np.pi * 1e-7\n        m = 3\n\n        # Derived quantities\n        dx = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        vA = B0 / np.sqrt(mu0 * rho0)\n        k = float(m)  # Wave number is integer 'm' for domain [0, 2*pi)\n        omega = k * vA\n        T_period = 2.0 * np.pi / omega\n        \n        dt = C_val * dx / vA\n        num_steps = int(np.ceil(T_period / dt))\n        t_end = num_steps * dt\n\n        # Initial condition\n        u0 = np.sin(k * x)\n\n        # FFT of initial condition for analysis\n        fft_u0 = np.fft.fft(u0)\n        initial_amp_mode_m = np.abs(fft_u0[m])\n        initial_phase_mode_m = np.angle(fft_u0[m])\n        \n        # Time evolution\n        u = u0.copy()\n        for _ in range(num_steps):\n            u_prev = np.roll(u, 1)  # Implements periodic u_{i-1}\n            u = u - C_val * (u - u_prev)\n            \n        # FFT of final condition\n        fft_u_final = np.fft.fft(u)\n        final_amp_mode_m = np.abs(fft_u_final[m])\n        final_phase_mode_m = np.angle(fft_u_final[m])\n\n        # Analysis\n        measured_phase_advance = final_phase_mode_m - initial_phase_mode_m\n        exact_phase_advance = -omega * t_end\n        phase_error = wrap_phase(measured_phase_advance - exact_phase_advance)\n        \n        amplitude_ratio = final_amp_mode_m / initial_amp_mode_m\n        \n        return phase_error, amplitude_ratio\n\n    def run_case_absorbing():\n        \"\"\"\n        Runs a simulation for the absorbing boundary condition case.\n\n        Returns:\n            float: The residual interior amplitude ratio (dimensionless).\n        \"\"\"\n        # Parameters\n        L = 10.0\n        N = 512\n        B0 = 0.1\n        rho0 = 1e-6\n        mu0 = 4.0 * np.pi * 1e-7\n        C = 0.5\n        k0 = 6.0\n        xc = L / 4.0\n        w = 0.5\n        Ls = 2.0\n        sigma0 = 50.0\n\n        # Derived quantities\n        dx = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        vA = B0 / np.sqrt(mu0 * rho0)\n        \n        dt = C * dx / vA\n        t_end_raw = (L - xc + 3.0 * w) / vA\n        num_steps = int(np.ceil(t_end_raw / dt))\n\n        # Initial condition\n        u0 = np.sin(k0 * x) * np.exp(-((x - xc)**2) / (2 * w**2))\n\n        # Sponge layer setup\n        sigma = np.zeros(N)\n        sponge_start_x = L - Ls\n        sponge_indices = np.where(x >= sponge_start_x)\n        x_sponge = x[sponge_indices]\n        sigma[sponge_indices] = sigma0 * (((x_sponge - sponge_start_x) / Ls)**2)\n        damping_factor = 1.0 - sigma * dt\n\n        # Interior region for analysis\n        interior_indices = np.where(x < sponge_start_x)[0]\n        initial_max_interior_amp = np.max(np.abs(u0[interior_indices]))\n\n        # Time evolution\n        u = u0.copy()\n        for _ in range(num_steps):\n            u_i_minus_1 = np.roll(u, 1)\n            # Left boundary (inflow): zero-gradient condition u_{-1}=u_0\n            # This makes the update at i=0 trivial: u_0^{n+1} = u_0^n.\n            u_i_minus_1[0] = u[0]\n            \n            u = u - C * (u - u_i_minus_1)\n            \n            # Apply sponge layer damping\n            u = u * damping_factor\n\n        # Analysis\n        final_max_interior_amp = np.max(np.abs(u[interior_indices]))\n        if initial_max_interior_amp == 0:\n            residual_amplitude_ratio = 0.0\n        else:\n            residual_amplitude_ratio = final_max_interior_amp / initial_max_interior_amp\n        \n        return residual_amplitude_ratio\n\n    # Define test cases implicitly through function calls\n    test_cases = [\n        {\"type\": \"periodic\", \"C\": 0.2},\n        {\"type\": \"periodic\", \"C\": 0.9},\n        {\"type\": \"absorbing\"}\n    ]\n    \n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"periodic\":\n            phase_error, amp_ratio = run_case_periodic(case[\"C\"])\n            results.extend([phase_error, amp_ratio])\n        elif case[\"type\"] == \"absorbing\":\n            residual_ratio = run_case_absorbing()\n            results.append(residual_ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having observed numerical phase error in practice, we now turn to a theoretical investigation of its origin. This exercise guides you through the analytical derivation of the discrete dispersion relation for the widely-used Finite-Difference Time-Domain (FDTD) scheme under periodic boundary conditions . By comparing the numerical dispersion relation to its continuum counterpart, you will derive the leading-order expression for phase velocity error, providing a rigorous mathematical explanation for how the discretized grid itself alters wave propagation.",
            "id": "3946089",
            "problem": "Consider one-dimensional vacuum electromagnetic wave propagation along the $x$ axis with transverse fields $E_{y}(x,t)$ and $H_{z}(x,t)$ in a periodic domain of length $L$, so that $E_{y}(x+L,t)=E_{y}(x,t)$ and $H_{z}(x+L,t)=H_{z}(x,t)$. The fields satisfy Maxwell’s equations in vacuum, which imply the wave equation with wave speed $c$, where $c^{2}=1/(\\mu_{0}\\epsilon_{0})$. Discretize the domain with $N$ uniform cells of spacing $\\Delta x=L/N$ and time step $\\Delta t$, and use the Yee finite-difference time-domain (FDTD) staggered scheme, with $E_{y}$ defined at spatial indices $i\\in\\mathbb{Z}$ and half-time levels $n+\\tfrac{1}{2}$, and $H_{z}$ defined at half spatial indices $i+\\tfrac{1}{2}$ and integer time levels $n$. The scheme advances the fields using centered differences in space and time consistent with Maxwell’s curl equations. Let the Courant number be $r=c\\,\\Delta t/\\Delta x$ and define the nondimensional wavenumber $\\kappa=k\\,\\Delta x$ and nondimensional frequency $\\Omega=\\omega\\,\\Delta t$ for a plane wave with physical wavenumber $k$ and angular frequency $\\omega$. Periodic boundary conditions imply discrete allowed wavenumbers $k_{m}=2\\pi m/L$ for integers $m$, equivalently $\\kappa_{m}=2\\pi m/N$, but you may treat $\\kappa$ symbolically.\n\nStarting from the vacuum Maxwell equations and the Yee scheme described above, and imposing periodic boundary conditions via a discrete plane-wave ansatz consistent with the grid staggering, derive the discrete dispersion relation connecting $\\Omega$ and $\\kappa$ in terms of $r$. Compare this to the continuum dispersion $\\omega=c\\,|k|$ to define the numerical phase velocity $v_{p,\\mathrm{num}}=\\omega/k$ and the fractional phase velocity error $\\varepsilon(\\kappa,r)=\\dfrac{v_{p,\\mathrm{num}}}{c}-1$. Using a systematic small-$\\kappa$ asymptotic expansion, obtain the leading-order closed-form expression for $\\varepsilon(\\kappa,r)$ as $\\kappa\\to 0$ in terms of $\\kappa$ and $r$ only.\n\nProvide as your final answer a single analytic expression for the leading-order $\\varepsilon(\\kappa,r)$. No numerical evaluation is required and no units should be included in the final expression.",
            "solution": "The problem statement is analyzed and deemed valid as it is scientifically grounded in Maxwell's theory and the finite-difference time-domain (FDTD) method, is well-posed, objective, and self-contained. The derivation proceeds as follows.\n\nThe governing equations for one-dimensional electromagnetic wave propagation in a vacuum with fields $E_{y}(x,t)$ and $H_{z}(x,t)$ are Maxwell's curl equations:\n$$ \\frac{\\partial E_{y}}{\\partial t} = -\\frac{1}{\\epsilon_{0}} \\frac{\\partial H_{z}}{\\partial x} $$\n$$ \\frac{\\partial H_{z}}{\\partial t} = -\\frac{1}{\\mu_{0}} \\frac{\\partial E_{y}}{\\partial x} $$\nHere, $\\epsilon_{0}$ and $\\mu_{0}$ are the vacuum permittivity and permeability, respectively, and the speed of light is $c = 1/\\sqrt{\\mu_{0}\\epsilon_{0}}$.\n\nThe problem specifies a Yee FDTD staggered grid. Let $E_{y}(i\\Delta x, (n+1/2)\\Delta t)$ be denoted by $E_{y}|_{i}^{n+1/2}$ and $H_{z}((i+1/2)\\Delta x, n\\Delta t)$ by $H_{z}|_{i+1/2}^{n}$. The centered-difference approximations of Maxwell's equations are:\n$$ \\frac{E_{y}|_{i}^{n+1/2} - E_{y}|_{i}^{n-1/2}}{\\Delta t} = -\\frac{1}{\\epsilon_{0}} \\frac{H_{z}|_{i+1/2}^{n} - H_{z}|_{i-1/2}^{n}}{\\Delta x} \\quad (1)$$\n$$ \\frac{H_{z}|_{i+1/2}^{n+1} - H_{z}|_{i+1/2}^{n}}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\frac{E_{y}|_{i+1}^{n+1/2} - E_{y}|_{i}^{n+1/2}}{\\Delta x} \\quad (2)$$\n\nTo find the discrete dispersion relation, we substitute a discrete plane-wave ansatz for a wave with angular frequency $\\omega$ and wavenumber $k$:\n$$ E_{y}|_{i}^{n+1/2} = E_{0} \\exp\\left[j\\left(k(i\\Delta x) - \\omega(n+1/2)\\Delta t\\right)\\right] $$\n$$ H_{z}|_{i+1/2}^{n} = H_{0} \\exp\\left[j\\left(k(i+1/2)\\Delta x - \\omega(n)\\Delta t\\right)\\right] $$\nwhere $j=\\sqrt{-1}$, and $E_{0}$ and $H_{0}$ are constant amplitudes. Using the nondimensional variables $\\kappa=k\\Delta x$ and $\\Omega=\\omega\\Delta t$, the ansatz becomes:\n$$ E_{y}|_{i}^{n+1/2} = E_{0} \\exp\\left[j\\left(i\\kappa - (n+1/2)\\Omega\\right)\\right] $$\n$$ H_{z}|_{i+1/2}^{n} = H_{0} \\exp\\left[j\\left((i+1/2)\\kappa - n\\Omega\\right)\\right] $$\n\nSubstituting into equation $(1)$:\n$$ \\frac{E_{0} e^{j(i\\kappa - (n+1/2)\\Omega)} - E_{0} e^{j(i\\kappa - (n-1/2)\\Omega)}}{\\Delta t} = -\\frac{1}{\\epsilon_{0}} \\frac{H_{0} e^{j((i+1/2)\\kappa - n\\Omega)} - H_{0} e^{j((i-1/2)\\kappa - n\\Omega)}}{\\Delta x} $$\nFactoring out common terms:\n$$ \\frac{E_{0} e^{j(i\\kappa - n\\Omega)} (e^{-j\\Omega/2} - e^{j\\Omega/2})}{\\Delta t} = -\\frac{1}{\\epsilon_{0}} \\frac{H_{0} e^{j(i\\kappa - n\\Omega)} (e^{j\\kappa/2} - e^{-j\\kappa/2})}{\\Delta x} $$\nUsing Euler's identity ($e^{j\\theta} - e^{-j\\theta} = 2j\\sin\\theta$):\n$$ \\frac{E_{0} (-2j\\sin(\\Omega/2))}{\\Delta t} = -\\frac{1}{\\epsilon_{0}} \\frac{H_{0} (2j\\sin(\\kappa/2))}{\\Delta x} $$\n$$ E_{0} \\frac{\\sin(\\Omega/2)}{\\Delta t} = \\frac{H_{0}}{\\epsilon_{0}\\Delta x} \\sin(\\kappa/2) \\quad (3)$$\n\nFor the second FDTD equation, it is more convenient to analyze it by shifting the time indices by $-1/2$ for $E_y$ and $-1$ for $H_z$ to match the central time level of equation $(1)$. A cleaner method is to use symmetric discrete operators, which leads to the same result. Let us analyze equation $(2)$ directly by substituting the ansatz. To maintain symmetry, we analyze the $H$ update centered at time $n$:\n$$ \\frac{H_{z}|_{i+1/2}^{n} - H_{z}|_{i+1/2}^{n-1}}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\frac{E_{y}|_{i+1}^{n-1/2} - E_{y}|_{i}^{n-1/2}}{\\Delta x} $$\nSubstitution of the plane-wave ansatz gives:\n$$ \\frac{H_{0} e^{j((i+1/2)\\kappa - n\\Omega)} - H_{0} e^{j((i+1/2)\\kappa - (n-1)\\Omega)}}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\frac{E_{0} e^{j((i+1)\\kappa - (n-1/2)\\Omega)} - E_{0} e^{j(i\\kappa - (n-1/2)\\Omega)}}{\\Delta x} $$\n$$ \\frac{H_{0} e^{j((i+1/2)\\kappa - (n-1/2)\\Omega)} (e^{-j\\Omega/2} - e^{j\\Omega/2})}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\frac{E_{0} e^{j((i+1/2)\\kappa - (n-1/2)\\Omega)} (e^{j\\kappa/2} - e^{-j\\kappa/2})}{\\Delta x} $$\nSimplifying with Euler's identity:\n$$ \\frac{H_{0} (-2j\\sin(\\Omega/2))}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\frac{E_{0} (2j\\sin(\\kappa/2))}{\\Delta x} $$\n$$ H_{0} \\frac{\\sin(\\Omega/2)}{\\Delta t} = \\frac{E_{0}}{\\mu_{0}\\Delta x} \\sin(\\kappa/2) \\quad (4)$$\n\nEquations $(3)$ and $(4)$ form a linear system for the amplitudes $E_{0}$ and $H_{0}$:\n$$ \\begin{pmatrix} \\frac{\\sin(\\Omega/2)}{\\Delta t} & -\\frac{\\sin(\\kappa/2)}{\\epsilon_{0}\\Delta x} \\\\ -\\frac{\\sin(\\kappa/2)}{\\mu_{0}\\Delta x} & \\frac{\\sin(\\Omega/2)}{\\Delta t} \\end{pmatrix} \\begin{pmatrix} E_{0} \\\\ H_{0} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nFor a non-trivial solution, the determinant of the matrix must be zero:\n$$ \\left(\\frac{\\sin(\\Omega/2)}{\\Delta t}\\right)^2 - \\left(-\\frac{\\sin(\\kappa/2)}{\\epsilon_{0}\\Delta x}\\right) \\left(-\\frac{\\sin(\\kappa/2)}{\\mu_{0}\\Delta x}\\right) = 0 $$\n$$ \\frac{\\sin^2(\\Omega/2)}{(\\Delta t)^2} = \\frac{1}{\\mu_{0}\\epsilon_{0}} \\frac{\\sin^2(\\kappa/2)}{(\\Delta x)^2} $$\nUsing $c^2=1/(\\mu_{0}\\epsilon_{0})$ and taking the positive square root (for forward-propagating waves):\n$$ \\frac{\\sin(\\Omega/2)}{\\Delta t} = c \\frac{\\sin(\\kappa/2)}{\\Delta x} $$\nIntroducing the Courant number $r = c\\,\\Delta t/\\Delta x$, we obtain the discrete dispersion relation:\n$$ \\sin(\\Omega/2) = r \\sin(\\kappa/2) $$\nor, in terms of physical variables, $\\sin(\\omega\\Delta t/2)=r\\sin(k\\Delta x/2)$.\n\nThe numerical phase velocity is $v_{p,\\mathrm{num}} = \\omega/k$. We solve the dispersion relation for $\\omega$:\n$$ \\omega = \\frac{2}{\\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) $$\nThus, the phase velocity is:\n$$ v_{p,\\mathrm{num}} = \\frac{\\omega}{k} = \\frac{2}{k\\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) $$\nTo express this in terms of $\\kappa$ and $r$, we substitute $k=\\kappa/\\Delta x$:\n$$ v_{p,\\mathrm{num}} = \\frac{2\\Delta x}{\\kappa\\Delta t} \\arcsin\\left(r \\sin\\left(\\frac{\\kappa}{2}\\right)\\right) $$\nUsing $c/r = \\Delta x/\\Delta t$:\n$$ v_{p,\\mathrm{num}} = \\frac{2c}{r\\kappa} \\arcsin\\left(r \\sin\\left(\\frac{\\kappa}{2}\\right)\\right) $$\n\nThe fractional phase velocity error is $\\varepsilon(\\kappa,r) = \\dfrac{v_{p,\\mathrm{num}}}{c}-1$:\n$$ \\varepsilon(\\kappa,r) = \\frac{2}{r\\kappa} \\arcsin\\left(r \\sin\\left(\\frac{\\kappa}{2}\\right)\\right) - 1 $$\nTo find the leading-order behavior as $\\kappa\\to 0$, we perform a Taylor expansion. First, expand the argument of $\\arcsin$:\n$$ \\sin\\left(\\frac{\\kappa}{2}\\right) = \\frac{\\kappa}{2} - \\frac{1}{3!}\\left(\\frac{\\kappa}{2}\\right)^3 + O(\\kappa^5) = \\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + O(\\kappa^5) $$\nLet $X = r \\sin(\\kappa/2)$. Then:\n$$ X = r\\left(\\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + O(\\kappa^5)\\right) = \\frac{r\\kappa}{2} - \\frac{r\\kappa^3}{48} + O(\\kappa^5) $$\nNow, expand $\\arcsin(X)$ for small $X$: $\\arcsin(X) = X + \\frac{X^3}{6} + O(X^5)$.\n$$ \\arcsin\\left(r\\sin\\left(\\frac{\\kappa}{2}\\right)\\right) = \\left(\\frac{r\\kappa}{2} - \\frac{r\\kappa^3}{48}\\right) + \\frac{1}{6}\\left(\\frac{r\\kappa}{2}\\right)^3 + O(\\kappa^5) $$\n$$ = \\frac{r\\kappa}{2} - \\frac{r\\kappa^3}{48} + \\frac{r^3\\kappa^3}{48} + O(\\kappa^5) = \\frac{r\\kappa}{2} + \\frac{r(r^2-1)}{48}\\kappa^3 + O(\\kappa^5) $$\nSubstitute this expansion back into the expression for $v_{p,\\mathrm{num}}/c$:\n$$ \\frac{v_{p,\\mathrm{num}}}{c} = \\frac{2}{r\\kappa} \\left[ \\frac{r\\kappa}{2} + \\frac{r(r^2-1)}{48}\\kappa^3 + O(\\kappa^5) \\right] $$\n$$ = 1 + \\frac{2}{r\\kappa} \\left(\\frac{r(r^2-1)}{48}\\kappa^3\\right) + O(\\kappa^4) = 1 + \\frac{r^2-1}{24}\\kappa^2 + O(\\kappa^4) $$\nThe fractional phase velocity error is therefore:\n$$ \\varepsilon(\\kappa,r) = \\left(1 + \\frac{r^2-1}{24}\\kappa^2 + O(\\kappa^4)\\right) - 1 = \\frac{r^2-1}{24}\\kappa^2 + O(\\kappa^4) $$\nThe leading-order closed-form expression for the error is the first term of this expansion.",
            "answer": "$$\\boxed{\\frac{r^2 - 1}{24}\\kappa^2}$$"
        },
        {
            "introduction": "The final practice bridges the gap between numerical methods and physical discovery by examining how simulation parameters affect the development of a key plasma phenomenon. You will analyze the two-stream instability, a classic kinetic process, within the constraints of a finite, periodic simulation domain . This exercise requires you to determine how the discrete spectrum of wavenumbers allowed by the box size and grid resolution can limit or even prevent the growth of the instability, highlighting the critical importance of choosing simulation parameters that can adequately resolve the physics you intend to study.",
            "id": "3946029",
            "problem": "Consider a one-dimensional, electrostatic, collisionless plasma comprised of two cold electron beams with equal number density streaming through each other with drift velocities $\\pm v_0$ in the presence of a uniform, immobile ion background that ensures overall charge neutrality. Assume periodic boundary conditions over a finite-length domain of size $L$ as is standard in Particle-In-Cell (PIC) simulations, so that admissible Fourier modes are discretized and given by $k_m = 2\\pi m/L$ for integer mode index $m$. Let $N$ denote the number of spatial grid points used to represent the fields in the PIC discretization; the resolvable wavenumber range is limited by the Nyquist wavenumber, so that only modes with $m = 1,2,\\ldots,\\lfloor N/2 \\rfloor$ are admissible.\n\nStarting from the linearized Vlasov–Poisson system, assume cold beams so that the unperturbed distribution functions are $f_{0,1}(v) = \\tfrac{n_0}{2}\\,\\delta(v - v_0)$ and $f_{0,2}(v) = \\tfrac{n_0}{2}\\,\\delta(v + v_0)$, where $\\delta(\\cdot)$ denotes the Dirac delta function and $n_0$ is the total electron number density. Using Fourier analysis with perturbations proportional to $\\exp(i k x - i \\omega t)$, the cold-beam electrostatic dispersion relation for the two-stream system is\n$$\n1 \\;-\\; \\frac{\\omega_{b}^2}{\\left(\\omega - k v_0\\right)^2} \\;-\\; \\frac{\\omega_{b}^2}{\\left(\\omega + k v_0\\right)^2} \\;=\\; 0,\n$$\nwhere $\\omega_b^2 = \\tfrac{n_0 e^2}{2 \\varepsilon_0 m_e}$ is the squared electron plasma frequency of a single beam, $e$ is the elementary charge, $\\varepsilon_0$ is the vacuum permittivity, and $m_e$ is the electron mass. Define the total electron plasma frequency $\\omega_p^2 = \\tfrac{n_0 e^2}{\\varepsilon_0 m_e}$ so that $\\omega_p^2 = 2 \\omega_b^2$. Let $a(k) = k^2 v_0^2$ and $X \\equiv \\omega^2$. Show that the dispersion reduces to a quadratic equation in $X$,\n$$\nX^2 \\;-\\; \\left(2 a + \\omega_p^2\\right) X \\;+\\; \\left(a^2 - \\omega_p^2 a\\right) \\;=\\; 0,\n$$\nand that the unstable branch exists for $0 < a < \\omega_p^2$, with the growth rate $\\gamma(k)$ given by the purely imaginary root $\\omega = i \\gamma$ built from the negative solution $X_{-}$:\n$$\nX_{-}(k) \\;=\\; \\frac{\\left(2 a + \\omega_p^2\\right) \\;-\\; \\omega_p \\sqrt{\\omega_p^2 + 8 a}}{2}, \n\\quad\n\\gamma(k) \\;=\\; \\sqrt{-X_{-}(k)}.\n$$\nIn the continuum (unbounded) limit, the fastest growing mode occurs at $a^\\star = \\tfrac{3}{8} \\omega_p^2$, yielding the maximum growth rate\n$$\n\\gamma_{\\mathrm{max,\\,cont}} \\;=\\; \\frac{\\omega_p}{2 \\sqrt{2}}.\n$$\n\nUnder periodic boundary conditions with a finite box of length $L$ and a finite grid resolution $N$, the allowed wavenumbers are discretized as $k_m = 2\\pi m/L$ with $m = 1,2,\\ldots,\\lfloor N/2 \\rfloor$. The box size and discretization jointly determine both the spacing $\\Delta k = 2\\pi/L$ and the maximum resolvable wavenumber $k_{\\mathrm{Nyquist}} = \\pi N/L$. This affects whether the fastest growing continuum mode is representable and how closely its growth rate is approximated.\n\nYour task is to implement a complete, runnable program that, for each test case listed below, computes:\n1. The discrete maximum growth rate $\\gamma_{\\mathrm{max,\\,disc}}$ over all admissible $k_m$ with $m = 1,2,\\ldots,\\lfloor N/2 \\rfloor$, using the above cold-beam dispersion relation.\n2. The continuum maximum growth rate $\\gamma_{\\mathrm{max,\\,cont}} = \\omega_p/(2\\sqrt{2})$ for the same physical parameters.\n3. The sensitivity ratio $R = \\gamma_{\\mathrm{max,\\,disc}} / \\gamma_{\\mathrm{max,\\,cont}}$.\n\nUse the following physical constants in the International System of Units (SI): $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$, and $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$. All quantities must be handled in SI units. The final program output must be the list of sensitivity ratios for all test cases, each formatted as a floating-point decimal rounded to six decimal places. No percentage signs are permitted.\n\nTest Suite (each case is a tuple $(n_0, v_0, L, N)$):\n- Case 1 (happy path, high resolution, broad wavenumber coverage): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = 1.0\\,\\mathrm{m}$, $N = 8192$.\n- Case 2 (finite box size with limited high-$k$ representation): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = 10.0\\,\\mathrm{m}$, $N = 2048$.\n- Case 3 (edge case: no unstable discrete mode due to box-induced minimum wavenumber exceeding the instability threshold): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = 9.0 \\times 10^{-4}\\,\\mathrm{m}$, $N = 64$.\n- Case 4 (near-threshold box where only the lowest mode lies in the unstable band): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = \\frac{2\\pi}{5500}\\,\\mathrm{m}$, $N = 16$.\n\nRequired final output format: Your program should produce a single line of output containing the sensitivity ratios for the four test cases as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is a floating-point number rounded to six decimal places, expressed in pure decimal form.",
            "solution": "The problem is valid as it is scientifically grounded in the established theory of the two-stream instability in plasma physics, is well-posed with a clear objective and sufficient data, and is presented in an objective, formal manner free of contradictions or ambiguities.\n\nThe solution proceeds by implementing the provided physical model to compare the maximum instability growth rate in an idealized continuum system with that of a discretized system, which is representative of numerical simulations. The core of the problem lies in understanding how finite domain size $L$ and finite grid resolution $N$ in a Particle-In-Cell (PIC) simulation constrain the spectrum of representable wavenumbers $k$, thereby affecting the observed growth rate of physical instabilities.\n\nThe fundamental physical model is the cold-beam electrostatic dispersion relation for two counter-streaming electron beams:\n$$\n1 \\;-\\; \\frac{\\omega_{b}^2}{\\left(\\omega - k v_0\\right)^2} \\;-\\; \\frac{\\omega_{b}^2}{\\left(\\omega + k v_0\\right)^2} \\;=\\; 0\n$$\nwhere $\\omega$ is the frequency, $k$ is the wavenumber, $\\pm v_0$ are the beam velocities, and $\\omega_b$ is the plasma frequency of a single beam. Using the total electron plasma frequency $\\omega_p$ where $\\omega_p^2 = 2\\omega_b^2$, this relation leads to a condition for purely growing modes (instability), where $\\omega = i\\gamma$ for a real growth rate $\\gamma > 0$. The instability exists for wavenumbers $k$ such that $0 < k^2 v_0^2 < \\omega_p^2$.\n\nThe growth rate $\\gamma(k)$ is derived from the dispersion relation and is given by $\\gamma(k) = \\sqrt{-X_{-}(k)}$, where $X_{-} \\equiv \\omega^2$ is the negative root of the corresponding quadratic equation. The formula for the growth rate squared is:\n$$\n\\gamma(k)^2 = -X_{-}(k) = \\frac{\\omega_p \\sqrt{\\omega_p^2 + 8 k^2 v_0^2} - (2 k^2 v_0^2 + \\omega_p^2)}{2}\n$$\n\nThe algorithmic procedure to solve the problem for each test case $(n_0, v_0, L, N)$ is as follows:\n\n1.  **Calculate Physical Constants**: From the given fundamental constants ($e, \\varepsilon_0, m_e$) and the input parameter for total electron density $n_0$, we first compute the squared total electron plasma frequency, $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$. We then take its square root to find $\\omega_p$.\n\n2.  **Compute Continuum Maximum Growth Rate**: The problem states that in the continuum limit (where all $k$ are allowed), the maximum growth rate $\\gamma_{\\mathrm{max,\\,cont}}$ occurs at a specific wavenumber and has the value $\\gamma_{\\mathrm{max,\\,cont}} = \\frac{\\omega_p}{2\\sqrt{2}}$. This value serves as the ideal benchmark.\n\n3.  **Compute Discrete Maximum Growth Rate**: This step accounts for the constraints of a numerical simulation.\n    a.  **Generate Admissible Wavenumbers**: In a periodic domain of length $L$ discretized with $N$ grid points, the resolvable wavenumbers are given by $k_m = \\frac{2\\pi m}{L}$, for positive integer mode numbers $m = 1, 2, \\ldots, \\lfloor N/2 \\rfloor$. The upper limit $m_{max} = \\lfloor N/2 \\rfloor$ arises from the Nyquist-Shannon sampling theorem, where $k_{Nyquist} = \\frac{\\pi N}{L}$ is the maximum resolvable wavenumber. A vector of these $k_m$ values is generated.\n    b.  **Identify Unstable Modes**: The instability condition is $k^2 v_0^2 < \\omega_p^2$. We apply this filter to our vector of admissible wavenumbers $k_m$ to find the subset of modes that are physically unstable.\n    c.  **Calculate Growth Rates**: For each unstable wavenumber $k_m$ in the filtered subset, we calculate the corresponding growth rate $\\gamma(k_m)$ using the formula for $\\gamma(k)^2$ provided above.\n    d.  **Find Maximum**: If the set of unstable modes is empty (which can occur if the fundamental mode $k_1 = 2\\pi/L$ is already beyond the instability cutoff, i.e., $k_1 > \\omega_p/v_0$), the discrete maximum growth rate $\\gamma_{\\mathrm{max,\\,disc}}$ is $0$. Otherwise, $\\gamma_{\\mathrm{max,\\,disc}}$ is the maximum value found among the calculated growth rates $\\gamma(k_m)$.\n\n4.  **Compute Sensitivity Ratio**: The final step is to compute the ratio $R = \\frac{\\gamma_{\\mathrm{max,\\,disc}}}{\\gamma_{\\mathrm{max,\\,cont}}}$. This ratio quantifies how well the discretized system can capture the fastest-growing mode of the physical instability. A ratio close to $1$ indicates high fidelity, while a ratio close to $0$ suggests that the simulation parameters ($L$ and $N$) are poorly chosen to study this particular instability.\n\nThis entire procedure is implemented for each test case. Vectorized operations using the `numpy` library are employed for efficiency in handling the arrays of wavenumbers and their corresponding growth rates.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity ratio of discrete vs. continuum maximum growth rates\n    for the two-stream instability under various simulation parameters.\n    \"\"\"\n    \n    # Physical Constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    M_E = 9.1093837015e-31       # Electron mass (kg)\n\n    # Test Suite: (n0, v0, L, N)\n    # n0: total electron number density (m^-3)\n    # v0: beam drift velocity (m/s)\n    # L: domain length (m)\n    # N: number of grid points\n    test_cases = [\n        (1.0e16, 1.0e6, 1.0, 8192),\n        (1.0e16, 1.0e6, 10.0, 2048),\n        (1.0e16, 1.0e6, 9.0e-4, 64),\n        (1.0e16, 1.0e6, 2 * np.pi / 5500, 16),\n    ]\n\n    results = []\n    \n    for n0, v0, L, N in test_cases:\n        # 1. Calculate physical parameters\n        omega_p_sq = (n0 * E_CHARGE**2) / (EPSILON_0 * M_E)\n        omega_p = np.sqrt(omega_p_sq)\n        \n        # 2. Compute continuum maximum growth rate\n        gamma_max_cont = omega_p / (2 * np.sqrt(2))\n        \n        # 3. Compute discrete maximum growth rate\n        m_max = int(np.floor(N / 2))\n        \n        gamma_max_disc = 0.0\n        if m_max >= 1:\n            # 3a. Generate admissible wavenumbers\n            m_values = np.arange(1, m_max + 1)\n            k_values = 2 * np.pi * m_values / L\n            \n            # Helper variable a = k^2 * v0^2\n            a_values = k_values**2 * v0**2\n            \n            # 3b. Identify unstable modes (0 < a < omega_p^2)\n            unstable_mask = a_values < omega_p_sq\n            \n            if np.any(unstable_mask):\n                unstable_a = a_values[unstable_mask]\n                \n                # 3c. Calculate growth rates for unstable modes\n                # gamma^2 = -X_minus = 0.5 * (omega_p * sqrt(omega_p^2 + 8a) - (2a + omega_p^2))\n                gamma_sq_unstable = 0.5 * (\n                    omega_p * np.sqrt(omega_p_sq + 8 * unstable_a) - (2 * unstable_a + omega_p_sq)\n                )\n                \n                # Clip to 0 before sqrt to handle potential floating point inaccuracies near boundary\n                gamma_unstable = np.sqrt(np.maximum(0, gamma_sq_unstable))\n                \n                # 3d. Find maximum discrete growth rate\n                gamma_max_disc = np.max(gamma_unstable)\n\n        # 4. Compute sensitivity ratio\n        if gamma_max_cont > 1e-9: # Avoid division by zero, though not expected here\n            ratio = gamma_max_disc / gamma_max_cont\n        else:\n            ratio = 0.0\n\n        results.append(ratio)\n        \n    # Final print statement in the exact required format.\n    formatted_results = [\"{:.6f}\".format(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}