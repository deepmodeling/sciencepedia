{
    "hands_on_practices": [
        {
            "introduction": "在等离子体模型中，许多积分在积分区间的端点处会遇到被积函数趋于无穷大的情况，即奇点。虽然这些奇点是可积的，但标准的求积方法在处理它们时会产生很大的误差。本练习将引导你分析一个常见的 $E^{-1/2}$ 奇点所导致的误差，并演示如何通过巧妙的变量变换来消除奇点，从而将积分转化为一个光滑、易于处理的形式，这是确保数值积分精度的关键一步。",
            "id": "4023213",
            "problem": "在计算聚变科学与工程中的能量分辨等离子体输运模拟中，当将与速度相关的量用能量变量表示时，许多关于粒子能量 $E$ 的积分由于相空间雅可比行列式的缘故，会表现出可积的端点奇点。具体来说，在麦克斯韦-玻尔兹曼 (MB) 能量加权积分中，当 $E$ 趋近于0时，被积函数的行为通常类似于 $E^{-1/2}$ 乘以一个光滑函数。考虑以下形式的积分族\n$$\nI = \\int_{0}^{E_{\\max}} E^{-1/2}\\,g(E)\\,\\mathrm{d}E,\n$$\n其中 $E_{\\max} > 0$ 是有限的，且 $g(E)$ 在 $E=0$ 的一个邻域内是实解析的，并且 $g(0) \\neq 0$。在 $[0,E_{\\max}]$ 上的复合求积中，当被积函数具有 $E^{-1/2}$ 行为时，与 $E=0$ 相邻的第一个区间的误差占主导地位。\n\n仅使用本层次可用的第一性原理（数值求积法则的定义、解析函数的泰勒展开和基本积分恒等式），完成以下任务：\n\n1. 令 $h>0$ 表示第一个区间 $[0,h]$ 的宽度。在该区间上使用中点法则，将 $g(E)$ 写为 $g(E) = g(0) + g'(0)E + \\mathcal{O}(E^{2})$，并推导对于被积函数 $E^{-1/2}g(E)$，由中点法则在 $[0,h]$ 上贡献的局部求积误差的主阶渐近式。用 $h$ 的幂次表示主阶项，并明确显示其对 $g(0)$ 的依赖关系。\n\n2. 提出一个变量变换，以消除给定形式积分在 $E=0$ 处的 $E^{-1/2}$ 奇点。从该变换出发，推导变换后的被积函数，并证明其在新变量的原点处是光滑的。基于这个变换后的被积函数，说明在中点近似下，变换后变量的对应第一个区间上的新的主阶局部误差缩放规律。\n\n3. 为了与一个典型的麦克斯韦-玻尔兹曼加权等离子体积分联系起来，计算积分\n$$\nI(T) = \\int_{0}^{\\infty} E^{-1/2}\\,\\exp\\!\\left(-\\frac{E}{T}\\right)\\,\\mathrm{d}E,\n$$\n其中 $T>0$ 是一个正能量标度（例如，玻尔兹曼常数乘以热力学温度）。使用第2部分中的变量变换和基本高斯积分恒等式，计算 $I(T)$ 的一个闭式解析表达式。\n\n最终答案请以仅含 $T$ 的单个闭式表达式的形式给出。不需要进行数值四舍五入，并且最终方框内的答案不得包含单位。",
            "solution": "该问题研究形式为 $I = \\int_{0}^{E_{\\max}} E^{-1/2}\\,g(E)\\,\\mathrm{d}E$ 的函数的数值积分，其中 $g(E)$ 是在 $E=0$ 邻域内的实解析函数。被积函数 $f(E) = E^{-1/2}g(E)$ 在积分下限 $E=0$ 处具有一个可积奇点。\n\n1. 中点法则主阶误差的推导。\n\n设第一个求积区间为 $[0, h]$，其中 $h > 0$。该区间上的积分精确值为 $I_h = \\int_{0}^{h} E^{-1/2}\\,g(E)\\,\\mathrm{d}E$。\n中点求积法则将此积分近似为一个矩形的面积，其宽度为 $h$，高度等于被积函数在区间中点 $E = h/2$ 处的值。因此，近似值（记为 $M_h$）为：\n$$\nM_h = h \\cdot f(h/2) = h \\cdot (h/2)^{-1/2}\\,g(h/2)\n$$\n问题陈述 $g(E)$ 在 $E=0$ 附近是实解析的，其泰勒展开为 $g(E) = g(0) + g'(0)E + \\mathcal{O}(E^2)$。我们使用此展开来求当 $h \\to 0$ 时，精确积分 $I_h$ 和近似值 $M_h$ 的渐近形式。\n\n对于精确积分 $I_h$：\n$$\nI_h = \\int_0^h E^{-1/2} \\left[ g(0) + g'(0)E + \\mathcal{O}(E^2) \\right] \\mathrm{d}E\n$$\n$$\nI_h = \\int_0^h \\left[ g(0)E^{-1/2} + g'(0)E^{1/2} + \\mathcal{O}(E^{3/2}) \\right] \\mathrm{d}E\n$$\n逐项积分：\n$$\nI_h = \\left[ g(0) \\cdot 2E^{1/2} + g'(0) \\cdot \\frac{2}{3}E^{3/2} + \\mathcal{O}(E^{5/2}) \\right]_0^h\n$$\n$$\nI_h = 2g(0)h^{1/2} + \\frac{2}{3}g'(0)h^{3/2} + \\mathcal{O}(h^{5/2})\n$$\n\n对于中点法则近似值 $M_h$：\n$$\nM_h = h \\cdot \\frac{\\sqrt{2}}{h^{1/2}} \\cdot g(h/2) = \\sqrt{2}h^{1/2} g(h/2)\n$$\n代入 $g(h/2)$ 的泰勒级数：\n$$\ng(h/2) = g(0) + g'(0)(h/2) + \\mathcal{O}(h^2)\n$$\n$$\nM_h = \\sqrt{2}h^{1/2} \\left[ g(0) + \\frac{1}{2}g'(0)h + \\mathcal{O}(h^2) \\right]\n$$\n$$\nM_h = \\sqrt{2}g(0)h^{1/2} + \\frac{\\sqrt{2}}{2}g'(0)h^{3/2} + \\mathcal{O}(h^{5/2})\n$$\n\n第一个区间上的局部求积误差 $E_h$ 是精确积分与其近似值之差，即 $E_h = I_h - M_h$。\n$$\nE_h = \\left( 2g(0)h^{1/2} + \\frac{2}{3}g'(0)h^{3/2} \\right) - \\left( \\sqrt{2}g(0)h^{1/2} + \\frac{\\sqrt{2}}{2}g'(0)h^{3/2} \\right) + \\mathcal{O}(h^{5/2})\n$$\n$$\nE_h = (2 - \\sqrt{2})g(0)h^{1/2} + \\left(\\frac{2}{3} - \\frac{\\sqrt{2}}{2}\\right)g'(0)h^{3/2} + \\mathcal{O}(h^{5/2})\n$$\n误差的主阶项是 $h$ 的最低次幂项。由于 $g(0) \\neq 0$，这就是第一项。误差的主阶渐近式为：\n$$\nE_h \\sim (2 - \\sqrt{2})g(0)h^{1/2}\n$$\n这表明收敛速度非常慢，为 $\\mathcal{O}(h^{1/2})$，这是将标准求积法则应用于具有端点奇点的被积函数的直接后果。\n\n2. 消除奇点的变量变换。\n\n为消除 $E^{-1/2}$ 奇点，我们引入一个变量变换来抵消这个有问题的项。合适的变换是 $E=u^2$。\n在此变换下，微分变为 $\\mathrm{d}E = 2u\\,\\mathrm{d}u$。原积分的奇异部分变换如下：\n$$\nE^{-1/2}\\,\\mathrm{d}E = (u^2)^{-1/2}\\,(2u\\,\\mathrm{d}u) = u^{-1}\\,(2u\\,\\mathrm{d}u) = 2\\,\\mathrm{d}u\n$$\n该变换将积分限从 $E \\in [0, E_{\\max}]$ 变为 $u \\in [0, \\sqrt{E_{\\max}}]$。完整的积分变为：\n$$\nI = \\int_{0}^{E_{\\max}} E^{-1/2}\\,g(E)\\,\\mathrm{d}E = \\int_{0}^{\\sqrt{E_{\\max}}} g(u^2) (2\\,\\mathrm{d}u) = \\int_{0}^{\\sqrt{E_{\\max}}} 2g(u^2)\\,\\mathrm{d}u\n$$\n变换后的被积函数为 $f_{\\text{new}}(u) = 2g(u^2)$。由于 $g(E)$ 在 $E=0$ 的邻域内是实解析的，它可以表示为一个收敛的幂级数 $g(E) = \\sum_{k=0}^{\\infty} a_k E^k$。代入 $E=u^2$，我们得到新被积函数的级数：\n$$\nf_{\\text{new}}(u) = 2g(u^2) = 2 \\sum_{k=0}^{\\infty} a_k (u^2)^k = \\sum_{k=0}^{\\infty} 2a_k u^{2k}\n$$\n这是一个在 $u=0$ 邻域内收敛的关于 $u$ 的幂级数。一个由收敛幂级数表示的函数是实解析的，因此是无穷次可微（光滑）的。因此，新的被积函数 $f_{\\text{new}}(u)$ 在新原点 $u=0$ 处是光滑的。\n\n对于光滑的被积函数，标准求积法则能恢复其通常的精度。对于一个光滑函数 $\\phi(x)$，中点法则在区间 $[a,b]$ 上的局部误差由 $\\frac{(b-a)^3}{24}\\phi''(\\xi)$ 给出，其中 $\\xi \\in (a,b)$。对于变换后变量的第一个区间 $[0,k]$，误差的缩放规律为 $\\mathcal{O}(k^3)$，其中 $k$ 是 $u$ 坐标下的区间宽度。这与原变量中 $\\mathcal{O}(h^{1/2})$ 的缩放规律形成鲜明对比。区间宽度之间的关系是 $k = \\sqrt{h}$，因此以原区间宽度 $h$ 表示的误差的缩放规律为 $\\mathcal{O}(k^3) = \\mathcal{O}((\\sqrt{h})^3) = \\mathcal{O}(h^{3/2})$。在中点近似下，变换后变量的第一个区间上的新的主阶局部误差缩放规律是 $\\mathcal{O}(k^3)$。\n\n3. 积分 $I(T)$ 的计算。\n\n我们需要计算积分：\n$$\nI(T) = \\int_{0}^{\\infty} E^{-1/2}\\,\\exp\\!\\left(-\\frac{E}{T}\\right)\\,\\mathrm{d}E\n$$\n该积分是所讨论的形式，其中 $g(E) = \\exp(-E/T)$ 且积分上限为 $\\infty$。我们应用变换 $E = u^2$。\n微分是 $\\mathrm{d}E = 2u\\,\\mathrm{d}u$。积分限的形式不变：当 $E$ 从 $0$ 趋于 $\\infty$ 时， $u$ 也从 $0$ 趋于 $\\infty$。\n代入积分中：\n$$\nI(T) = \\int_{0}^{\\infty} (u^2)^{-1/2} \\exp\\!\\left(-\\frac{u^2}{T}\\right) (2u\\,\\mathrm{d}u)\n$$\n$$\nI(T) = \\int_{0}^{\\infty} u^{-1} \\exp\\!\\left(-\\frac{u^2}{T}\\right) (2u\\,\\mathrm{d}u) = 2 \\int_{0}^{\\infty} \\exp\\!\\left(-\\frac{u^2}{T}\\right) \\mathrm{d}u\n$$\n这是一种高斯积分的形式。高斯积分的基本恒等式为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x = \\sqrt{\\frac{\\pi}{a}} \\quad \\text{for } a > 0\n$$\n由于被积函数 $\\exp(-ax^2)$ 是一个偶函数，其在 $[0, \\infty)$ 上的积分是在 $(-\\infty, \\infty)$ 上积分的一半：\n$$\n\\int_{0}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}\n$$\n在我们的例子中，变量是 $u$，常数 $a$ 是 $1/T$。应用此恒等式：\n$$\n\\int_{0}^{\\infty} \\exp\\!\\left(-\\frac{u^2}{T}\\right) \\mathrm{d}u = \\frac{1}{2}\\sqrt{\\frac{\\pi}{1/T}} = \\frac{1}{2}\\sqrt{\\pi T}\n$$\n最后，将此结果代回 $I(T)$ 的表达式中：\n$$\nI(T) = 2 \\cdot \\left( \\frac{1}{2}\\sqrt{\\pi T} \\right) = \\sqrt{\\pi T}\n$$\n因此，该积分的闭式解析表达式为 $\\sqrt{\\pi T}$。",
            "answer": "$$\n\\boxed{\\sqrt{\\pi T}}\n$$"
        },
        {
            "introduction": "处理完奇点之后，另一个常见的挑战是在无限区间上进行积分，例如速度空间积分。本练习展示了一种将半无限区间 $[0, \\infty)$ 映射到有限区间 $[-1, 1]$ 的强大技术，从而使其适用于高斯-勒让德求积等高效方法。我们将探讨这种变换（包括其雅可比行列式）如何影响积分的结构以及数值结果的准确性。",
            "id": "4023279",
            "problem": "在磁约束聚变等离子体的碰撞输運模型中，经常出现对各向同性麦克斯韦分布的速度空间积分。考虑类能量矩积分\n$$\nI(\\beta) \\equiv \\int_{0}^{\\infty} v^{2}\\,\\exp(-\\beta v^{2})\\,dv,\n$$\n其中 $\\beta = m/(2 k_{B} T)$，$m$ 是粒子质量，$k_{B}$ 是玻尔兹曼常数，$T$ 是温度。为了能够使用高斯-勒让德 (Gauss–Legendre, GL) 求积法进行高精度积分，引入了一个端点映射，将半无限区间 $[0,\\infty)$ 变换到一个有限区间。使用映射\n$$\nv(x) = \\alpha\\,\\frac{1+x}{1-x}, \\quad x \\in (-1,1),\n$$\n其中 $\\alpha$ 为正常数缩放因子，并使用相应的雅可比因子。\n\n任务：\n1. 从上述定义和变量替换的第一性原理出发，推导在区间 $x \\in (-1,1)$ 上的变换后积分，包括正确的雅可比因子。\n2. 使用 $[-1,1]$ 上的两点高斯-勒让德求积法则（节点为 $x = \\pm 1/\\sqrt{3}$，权重相等），写出 $I(\\beta)$ 的映射求积近似值 $Q(\\alpha)$。\n3. 定义热速度 $v_{\\mathrm{th}} \\equiv \\sqrt{2 k_{B} T/m}$。选择 $\\alpha$ 使得映射后的上节点 $x=+1/\\sqrt{3}$ 对应于 $v_{\\mathrm{th}}$，并用 $\\beta$ 表示 $\\alpha$。\n4. 使用标准高斯积分，以闭合形式计算精确积分 $I(\\beta)$。然后，构建有符号相对误差\n$$\nE \\equiv \\frac{Q(\\alpha) - I(\\beta)}{I(\\beta)}.\n$$\n对于您选择的 $\\alpha$，计算 $E$ 作为一个纯数，并尽可能地简化它。将 $E$ 的最终数值结果四舍五入到四位有效数字。相对误差是无量纲的；最终数值答案中不要包含单位。",
            "solution": "### 1. 变换后积分的推导\n\n待求的积分为\n$$\nI(\\beta) = \\int_{0}^{\\infty} v^{2}\\,\\exp(-\\beta v^{2})\\,dv.\n$$\n我们应用变量替换，使用映射\n$$\nv(x) = \\alpha\\,\\frac{1+x}{1-x},\n$$\n将 $v \\in [0,\\infty)$ 变换到 $x \\in (-1,1)$，其中 $\\alpha$ 是一个正常数。首先，我们必须求出此变换的雅可比矩阵，即导数 $\\frac{dv}{dx}$。使用商法则求导，\n$$\n\\frac{d}{dx} \\left( \\frac{1+x}{1-x} \\right) = \\frac{(1)(1-x) - (1+x)(-1)}{(1-x)^2} = \\frac{1-x+1+x}{(1-x)^2} = \\frac{2}{(1-x)^2}.\n$$\n因此，雅可比因子为\n$$\n\\frac{dv}{dx} = \\frac{2\\alpha}{(1-x)^2}.\n$$\n微分元变换为 $dv = \\frac{2\\alpha}{(1-x)^2} dx$。\n我们检查积分限的映射。当 $x \\to -1^{+}$ 时，$v(x) \\to \\alpha \\frac{1-1}{1-(-1)} = 0$。当 $x \\to 1^{-}$ 时，分母 $1-x \\to 0^{+}$，因此 $v(x) \\to \\infty$。该映射正确地将积分区间从 $[0,\\infty)$ 变换到 $[-1,1)$（或者更准确地说是开区间 $(-1,1)$）。\n\n将 $v(x)$ 和 $dv$ 代入 $I(\\beta)$ 的积分表达式，我们得到关于 $x$ 的变换后积分：\n$$\nI(\\beta) = \\int_{-1}^{1} \\left(\\alpha \\frac{1+x}{1-x}\\right)^2 \\exp\\left(-\\beta \\left(\\alpha \\frac{1+x}{1-x}\\right)^2\\right) \\frac{2\\alpha}{(1-x)^2} dx.\n$$\n令 $x$ 域中的被积函数表示为 $f(x)$。合并各项，我们得到\n$$\nf(x) = 2\\alpha^3 \\frac{(1+x)^2}{(1-x)^4} \\exp\\left(-\\beta\\alpha^2 \\left(\\frac{1+x}{1-x}\\right)^2\\right).\n$$\n所以变换后的积分为\n$$\nI(\\beta) = \\int_{-1}^{1} f(x) dx = \\int_{-1}^{1} 2\\alpha^3 \\frac{(1+x)^2}{(1-x)^4} \\exp\\left(-\\beta\\alpha^2 \\left(\\frac{1+x}{1-x}\\right)^2\\right) dx.\n$$\n\n### 2. 高斯-勒让德求积近似 $Q(\\alpha)$\n\n区间 $[-1,1]$ 上的两点高斯-勒让德求积法则将积分 $\\int_{-1}^{1} f(x) dx$ 近似为被积函数在两个特定节点处取值的加权和：\n$$\n\\int_{-1}^{1} f(x) dx \\approx w_1 f(x_1) + w_2 f(x_2).\n$$\n对于两点法则，节点为 $x_1 = -1/\\sqrt{3}$ 和 $x_2 = 1/\\sqrt{3}$，权重为 $w_1 = w_2 = 1$。\n因此，我们记为 $Q(\\alpha)$ 的求积近似值为\n$$\nQ(\\alpha) = f(-1/\\sqrt{3}) + f(1/\\sqrt{3}).\n$$\n为了写出 $Q(\\alpha)$ 的显式表达式，我们在节点处计算 $f(x)$ 的各组成部分。\n让我们在节点处计算 $y(x) = \\frac{1+x}{1-x}$ 的值：\n在 $x_1 = -1/\\sqrt{3}$ 处：$y(x_1) = \\frac{1-1/\\sqrt{3}}{1+1/\\sqrt{3}} = \\frac{\\sqrt{3}-1}{\\sqrt{3}+1} = \\frac{(\\sqrt{3}-1)^2}{3-1} = \\frac{3-2\\sqrt{3}+1}{2} = 2-\\sqrt{3}$。\n在 $x_2 = 1/\\sqrt{3}$ 处：$y(x_2) = \\frac{1+1/\\sqrt{3}}{1-1/\\sqrt{3}} = \\frac{\\sqrt{3}+1}{\\sqrt{3}-1} = \\frac{(\\sqrt{3}+1)^2}{3-1} = \\frac{3+2\\sqrt{3}+1}{2} = 2+\\sqrt{3}$。\n\n被积函数可以更简洁地写为 $f(x) = v(x)^2 \\exp(-\\beta v(x)^2) \\frac{dv}{dx}$。让我们在节点处计算 $v(x)$ 和 $\\frac{dv}{dx}$ 的分量。\n$v_1 = v(x_1) = \\alpha y(x_1) = \\alpha(2-\\sqrt{3})$。\n$v_2 = v(x_2) = \\alpha y(x_2) = \\alpha(2+\\sqrt{3})$。\n\n节点处的雅可比行列式：\n$\\frac{dv}{dx}\\bigg|_{x_1} = \\frac{2\\alpha}{(1+1/\\sqrt{3})^2} = \\frac{2\\alpha \\cdot 3}{(\\sqrt{3}+1)^2} = \\frac{6\\alpha}{4+2\\sqrt{3}} = \\frac{3\\alpha}{2+\\sqrt{3}} = 3\\alpha(2-\\sqrt{3})$。\n$\\frac{dv}{dx}\\bigg|_{x_2} = \\frac{2\\alpha}{(1-1/\\sqrt{3})^2} = \\frac{2\\alpha \\cdot 3}{(\\sqrt{3}-1)^2} = \\frac{6\\alpha}{4-2\\sqrt{3}} = \\frac{3\\alpha}{2-\\sqrt{3}} = 3\\alpha(2+\\sqrt{3})$。\n\n现在我们求 $f(x_1)$ 和 $f(x_2)$ 这两项：\n$f(x_1) = v_1^2 \\exp(-\\beta v_1^2) \\left(\\frac{dv}{dx}\\right)_{x_1} = [\\alpha^2(2-\\sqrt{3})^2] \\exp(-\\beta \\alpha^2(2-\\sqrt{3})^2) [3\\alpha(2-\\sqrt{3})]$。\n$f(x_1) = 3\\alpha^3 (2-\\sqrt{3})^3 \\exp(-\\beta \\alpha^2(7-4\\sqrt{3})) = 3\\alpha^3 (26-15\\sqrt{3}) \\exp(-\\beta \\alpha^2(7-4\\sqrt{3}))$。\n$f(x_2) = v_2^2 \\exp(-\\beta v_2^2) \\left(\\frac{dv}{dx}\\right)_{x_2} = [\\alpha^2(2+\\sqrt{3})^2] \\exp(-\\beta \\alpha^2(2+\\sqrt{3})^2) [3\\alpha(2+\\sqrt{3})]$。\n$f(x_2) = 3\\alpha^3 (2+\\sqrt{3})^3 \\exp(-\\beta \\alpha^2(7+4\\sqrt{3})) = 3\\alpha^3 (26+15\\sqrt{3}) \\exp(-\\beta \\alpha^2(7+4\\sqrt{3}))$。\n\n将这两项相加得到求积近似值 $Q(\\alpha)$：\n$$\nQ(\\alpha) = 3\\alpha^3 \\left[ (26-15\\sqrt{3}) \\exp(-\\beta\\alpha^2(7-4\\sqrt{3})) + (26+15\\sqrt{3}) \\exp(-\\beta\\alpha^2(7+4\\sqrt{3})) \\right].\n$$\n\n### 3. 缩放参数 $\\alpha$ 的选择\n\n我们被要求选择正常数缩放参数 $\\alpha$，使得映射后的上节点 $x = 1/\\sqrt{3}$ 对应于热速度 $v_{\\mathrm{th}}$。\n热速度定义为 $v_{\\mathrm{th}} \\equiv \\sqrt{2 k_{B} T/m}$。\n参数 $\\beta$ 已知为 $\\beta = m/(2 k_{B} T)$，所以 $v_{\\mathrm{th}} = \\sqrt{1/\\beta} = 1/\\sqrt{\\beta}$。\n条件是 $v(1/\\sqrt{3}) = v_{\\mathrm{th}}$。从上一节我们知道 $v(1/\\sqrt{3}) = \\alpha(2+\\sqrt{3})$。\n令两者相等得到：\n$$\n\\alpha(2+\\sqrt{3}) = v_{\\mathrm{th}} = \\frac{1}{\\sqrt{\\beta}}.\n$$\n解出 $\\alpha$ 得：\n$$\n\\alpha = \\frac{1}{(2+\\sqrt{3})\\sqrt{\\beta}} = \\frac{2-\\sqrt{3}}{\\sqrt{\\beta}}.\n$$\n\n### 4. 精确积分与相对误差\n\n首先，我们以闭合形式计算精确积分 $I(\\beta)$。积分 $I(\\beta) = \\int_{0}^{\\infty} v^{2}\\,\\exp(-\\beta v^{2})\\,dv$ 是高斯积分的一种标准形式。对于非负整数 $n$ 的通用公式是：\n$$\n\\int_{0}^{\\infty} u^{2n} \\exp(-a u^2) du = \\frac{(2n-1)!!}{2^{n+1}a^n} \\sqrt{\\frac{\\pi}{a}}.\n$$\n对于我们的积分，$n=1$ 且 $a=\\beta$。双阶乘 $(2(1)-1)!! = 1!! = 1$。\n将这些值代入公式得到：\n$$\nI(\\beta) = \\frac{1}{2^{1+1}\\beta^1} \\sqrt{\\frac{\\pi}{\\beta}} = \\frac{1}{4\\beta} \\sqrt{\\frac{\\pi}{\\beta}} = \\frac{\\sqrt{\\pi}}{4\\beta^{3/2}}.\n$$\n接下来，我们针对第3部分中 $\\alpha$ 的特定选择，计算求积近似值 $Q(\\alpha)$。\n我们将 $\\alpha = (2-\\sqrt{3})/\\sqrt{\\beta}$ 代入 $Q(\\alpha)$ 的表达式。\n我们需要 $\\alpha^2$ 和 $\\alpha^3$：\n$\\alpha^2 = \\frac{(2-\\sqrt{3})^2}{\\beta} = \\frac{7-4\\sqrt{3}}{\\beta}$。\n$\\alpha^3 = \\frac{(2-\\sqrt{3})^3}{\\beta^{3/2}} = \\frac{26-15\\sqrt{3}}{\\beta^{3/2}}$。\n\n现在我们计算 $Q(\\alpha)$ 中指数函数的参数：\n第1项参数：$-\\beta\\alpha^2(7-4\\sqrt{3}) = -\\beta \\frac{7-4\\sqrt{3}}{\\beta} (7-4\\sqrt{3}) = -(7-4\\sqrt{3})^2 = -(49 - 56\\sqrt{3} + 48) = -(97-56\\sqrt{3})$。\n第2项参数：$-\\beta\\alpha^2(7+4\\sqrt{3}) = -\\beta \\frac{7-4\\sqrt{3}}{\\beta} (7+4\\sqrt{3}) = -(49-48) = -1$。\n\n将这些代入 $Q(\\alpha)$ 的表达式中，并分配前导因子得到：\n$$\nQ(\\alpha) = \\frac{3}{\\beta^{3/2}} \\left[ (26-15\\sqrt{3})^2 \\exp(-(97-56\\sqrt{3})) + (26-15\\sqrt{3})(26+15\\sqrt{3}) \\exp(-1) \\right].\n$$\n由于 $(26-15\\sqrt{3})(26+15\\sqrt{3}) = 26^2 - (15\\sqrt{3})^2 = 676 - 225 \\cdot 3 = 676 - 675 = 1$，表达式简化为：\n$$\nQ(\\alpha) = \\frac{3}{\\beta^{3/2}} \\left[ (26-15\\sqrt{3})^2 \\exp(-(97-56\\sqrt{3})) + \\exp(-1) \\right].\n$$\n\n最后，我们计算有符号相对误差 $E$：\n$$\nE = \\frac{Q(\\alpha) - I(\\beta)}{I(\\beta)} = \\frac{Q(\\alpha)}{I(\\beta)} - 1.\n$$\n比值 $\\frac{Q(\\alpha)}{I(\\beta)}$ 为：\n$$\n\\frac{Q(\\alpha)}{I(\\beta)} = \\frac{\\frac{3}{\\beta^{3/2}} \\left[ (1351-780\\sqrt{3}) \\exp(-(97-56\\sqrt{3})) + \\exp(-1) \\right]}{\\frac{\\sqrt{\\pi}}{4\\beta^{3/2}}}.\n$$\n因子 $\\beta^{3/2}$ 消去，我们得到一个纯数：\n$$\n\\frac{Q(\\alpha)}{I(\\beta)} = \\frac{12}{\\sqrt{\\pi}} \\left[ (1351-780\\sqrt{3}) \\exp(-(97-56\\sqrt{3})) + \\exp(-1) \\right].\n$$\n现在我们计算数值。\n使用 $\\sqrt{3} \\approx 1.7320508$ 和 $\\sqrt{\\pi} \\approx 1.7724539$：\n$1351 - 780\\sqrt{3} \\approx 1351 - 780(1.7320508) \\approx 0.000376$。\n$97 - 56\\sqrt{3} \\approx 97 - 56(1.7320508) \\approx 0.005155$。\n$\\exp(-(97-56\\sqrt{3})) \\approx \\exp(-0.005155) \\approx 0.994859$。\n$\\exp(-1) \\approx 0.367879$。\n方括号中的项近似为：\n$0.000376 \\times 0.994859 + 0.367879 \\approx 0.000374 + 0.367879 = 0.368253$。\n该比值为 $\\frac{12}{\\sqrt{\\pi}} \\times 0.368253 \\approx 6.770287 \\times 0.368253 \\approx 2.493235$。\n相对误差为 $E \\approx 2.493235 - 1 = 1.493235$。\n四舍五入到四位有效数字，我们得到 $1.493$。",
            "answer": "$$\\boxed{1.493}$$"
        },
        {
            "introduction": "在许多物理问题中，被积函数包含一个非奇异但结构特殊的权重函数，例如在计算等离子体螺距角积分时出现的 $(1-\\mu^2)$ 因子。与其将这个权重函数作为被积函数的一部分进行近似，不如设计一个专门的求积法则，将其影响精确地包含在内。本练习将向你展示如何通过“待定系数法”推导这类定制求积法则的节点和权重，从而为特定类型的积分提供一种更高效、更精确的计算方案。",
            "id": "4023292",
            "problem": "在磁化等离子体的简化动理学描述中，经常需要计算关于螺距角余弦的垂直速度矩。设螺距角余弦表示为 $\\mu \\in [-1,1]$，垂直投影因子 $\\sin^{2}\\theta$ 写作 $1-\\mu^{2}$。考虑形式为\n$$\nI[f] \\equiv \\int_{-1}^{1} \\left(1-\\mu^{2}\\right) f(\\mu)\\, d\\mu,\n$$\n的积分，这种积分在计算轴对称条件下分布函数 $f(\\mu)$ 的垂直速度矩时出现。\n\n从数值求积的多项式精度定义以及区间 $[-1,1]$ 和偶权重 $1-\\mu^{2}$ 的基本对称性出发，建立一个形如\n$$\nQ[f] \\equiv \\omega_{1} f(\\mu_{1}) + \\omega_{2} f(\\mu_{2})\n$$\n的两点对称求积格式，该格式对所有次数至多为 $3$ 的多项式 $f(\\mu)$ 都是精确的。通过对与权重对称性一致的最低阶矩强制精确性，来确定节点 $\\mu_{1}$ 和 $\\mu_{2}$ 以及权重 $\\omega_{1}$ 和 $\\omega_{2}$。\n\n然后，使用你推导出的求积格式，通过闭合形式比较 $I[f]$ 和 $Q[f]$，来验证其对于 $f(\\mu)=1$、$f(\\mu)=\\mu$、$f(\\mu)=\\mu^{2}$ 和 $f(\\mu)=\\mu^{3}$ 的精确性。你无需在最终答案中报告这些验证值。\n\n以单行矩阵的形式报告你的最终答案，顺序为 $(\\mu_{1}, \\mu_{2}, \\omega_{1}, \\omega_{2})$。不需要四舍五入。不涉及物理单位。",
            "solution": "目标是找到求积法则\n$$\nQ[f] = \\omega_{1}f(\\mu_{1}) + \\omega_{2}f(\\mu_{2})\n$$\n的节点 $\\mu_{1}, \\mu_{2}$ 和权重 $\\omega_{1}, \\omega_{2}$，使得它在区间 $[-1, 1]$ 上能对任何次数至多为 $3$ 的多项式 $f(\\mu)$ 在权重函数 $w(\\mu) = 1-\\mu^{2}$ 下精确积分。\n精确积分为\n$$\nI[f] = \\int_{-1}^{1} (1-\\mu^{2}) f(\\mu) \\,d\\mu\n$$\n\n问题指定了一个对称求积。积分区间 $[-1, 1]$ 关于 $\\mu=0$ 对称，且权重函数 $w(\\mu) = 1-\\mu^{2}$ 是一个偶函数。对于对称求积法则，节点必须关于原点对称放置，并且相应的权重必须相等。因此，我们必须有：\n$$\n\\mu_{2} = -\\mu_{1} \\quad \\text{且} \\quad \\omega_{2} = \\omega_{1}\n$$\n我们定义一个正节点 $\\mu_{0} = \\mu_{1}$（不失一般性地假设 $\\mu_1 > 0$）和一个权重 $\\omega_{0} = \\omega_{1}$。那么求积法则简化为：\n$$\nQ[f] = \\omega_{0}f(\\mu_{0}) + \\omega_{0}f(-\\mu_{0}) = \\omega_{0} \\left( f(\\mu_{0}) + f(-\\mu_{0}) \\right)\n$$\n我们必须对次数至多为 $3$ 的多项式基，即 $f(\\mu) \\in \\{1, \\mu, \\mu^2, \\mu^3\\}$，强制执行条件 $I[f] = Q[f]$。\n\n我们来考察对称性。对于任何奇函数 $f(\\mu)$，被积函数 $(1-\\mu^2)f(\\mu)$ 是奇函数，因此在对称区间 $[-1,1]$ 上的精确积分 $I[f]$ 为零。\n$$\nI[f_{\\text{odd}}] = \\int_{-1}^{1} (1-\\mu^2) f_{\\text{odd}}(\\mu) \\,d\\mu = 0\n$$\n由于其对称构造，对于奇函数的求积也为零：\n$$\nQ[f_{\\text{odd}}] = \\omega_{0} \\left( f_{\\text{odd}}(\\mu_{0}) + f_{\\text{odd}}(-\\mu_{0}) \\right) = \\omega_{0} \\left( f_{\\text{odd}}(\\mu_{0}) - f_{\\text{odd}}(\\mu_{0}) \\right) = 0\n$$\n因此，该求积对所有奇次多项式自动精确。这涵盖了 $f(\\mu) = \\mu$ 和 $f(\\mu) = \\mu^3$ 的情况。我们只需要对基中的偶次多项式：$f(\\mu) = 1$ 和 $f(\\mu) = \\mu^2$ 强制执行精确性条件。这将为我们的两个未知数 $\\omega_{0}$ 和 $\\mu_{0}$ 产生两个方程。\n\n**对于 $f(\\mu) = 1$ 的条件：**\n精确积分为：\n$$\nI[1] = \\int_{-1}^{1} (1-\\mu^{2})(1) \\,d\\mu = \\left[ \\mu - \\frac{\\mu^{3}}{3} \\right]_{-1}^{1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^{3}}{3}\\right) = \\frac{2}{3} - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n求积近似为：\n$$\nQ[1] = \\omega_{0} (1+1) = 2\\omega_{0}\n$$\n令两者相等得到我们的第一个方程：\n$$\n2\\omega_{0} = \\frac{4}{3} \\implies \\omega_{0} = \\frac{2}{3}\n$$\n\n**对于 $f(\\mu) = \\mu^2$ 的条件：**\n精确积分为：\n$$\nI[\\mu^2] = \\int_{-1}^{1} (1-\\mu^{2})\\mu^{2} \\,d\\mu = \\int_{-1}^{1} (\\mu^2 - \\mu^4) \\,d\\mu = \\left[ \\frac{\\mu^{3}}{3} - \\frac{\\mu^{5}}{5} \\right]_{-1}^{1} = \\left(\\frac{1}{3} - \\frac{1}{5}\\right) - \\left(\\frac{-1}{3} - \\frac{-1}{5}\\right) = \\frac{2}{15} - \\left(-\\frac{2}{15}\\right) = \\frac{4}{15}\n$$\n求积近似为：\n$$\nQ[\\mu^2] = \\omega_{0} \\left( (\\mu_{0})^2 + (-\\mu_{0})^2 \\right) = \\omega_{0} (2\\mu_{0}^2) = 2\\omega_{0}\\mu_{0}^2\n$$\n令两者相等得到我们的第二个方程：\n$$\n2\\omega_{0}\\mu_{0}^2 = \\frac{4}{15}\n$$\n\n现在，我们求解这个方程组。将 $\\omega_{0} = \\frac{2}{3}$ 的值代入第二个方程：\n$$\n2\\left(\\frac{2}{3}\\right)\\mu_{0}^2 = \\frac{4}{15} \\implies \\frac{4}{3}\\mu_{0}^2 = \\frac{4}{15}\n$$\n$$\n\\mu_{0}^2 = \\frac{4}{15} \\cdot \\frac{3}{4} = \\frac{3}{15} = \\frac{1}{5}\n$$\n由于我们将 $\\mu_0$ 定义为正节点，我们取正平方根：\n$$\n\\mu_{0} = \\sqrt{\\frac{1}{5}} = \\frac{1}{\\sqrt{5}} = \\frac{\\sqrt{5}}{5}\n$$\n\n我们现在已经确定了基本参数 $\\mu_0$ 和 $\\omega_0$。我们可以写出完整的节点和权重集。采用从负到正排列节点的约定，我们设 $\\mu_1 = -\\mu_0$ 和 $\\mu_2 = \\mu_0$。权重相等：$\\omega_1 = \\omega_2 = \\omega_0$。\n-   节点 1: $\\mu_{1} = -\\frac{\\sqrt{5}}{5}$\n-   节点 2: $\\mu_{2} = \\frac{\\sqrt{5}}{5}$\n-   权重 1: $\\omega_{1} = \\frac{2}{3}$\n-   权重 2: $\\omega_{2} = \\frac{2}{3}$\n\n该求积对所有次数至多为 $3$ 的多项式都是精确的，符合要求。最终答案按 $(\\mu_{1}, \\mu_{2}, \\omega_{1}, \\omega_{2})$ 的顺序报告这些值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\sqrt{5}}{5} & \\frac{\\sqrt{5}}{5} & \\frac{2}{3} & \\frac{2}{3} \\end{pmatrix}}\n$$"
        }
    ]
}