{
    "hands_on_practices": [
        {
            "introduction": "Many integrals in plasma physics, particularly those involving a change of variables from particle speed to energy, feature integrable singularities that can cripple the accuracy of standard numerical methods. This first exercise  challenges you to analyze such a singularity, specifically the common $E^{-1/2}$ behavior near $E=0$. By deriving the poor error scaling of a simple rule and then applying a clever variable transformation, you will learn a fundamental technique to regularize the integrand and restore the high-order accuracy of numerical quadrature.",
            "id": "4023213",
            "problem": "In energy-resolved plasma transport modeling within computational fusion science and engineering, many integrals over particle energy $E$ exhibit integrable endpoint singularities arising from the phase-space Jacobian when expressing speed-dependent quantities in energy variables. Specifically, in Maxwell–Boltzmann (MB) energy-weighted integrals, the integrand near $E=0$ often behaves like $E^{-1/2}$ multiplied by a smooth function. Consider the family of integrals of the form\n$$\nI = \\int_{0}^{E_{\\max}} E^{-1/2}\\,g(E)\\,\\mathrm{d}E,\n$$\nwhere $E_{\\max} > 0$ is finite, and $g(E)$ is real-analytic in a neighborhood of $E=0$ with $g(0) \\neq 0$. In composite quadrature over $[0,E_{\\max}]$, the first panel adjacent to $E=0$ dominates the error when the integrand has $E^{-1/2}$ behavior. \n\nUsing only first principles available at this level (definitions of numerical quadrature rules, Taylor expansions of analytic functions, and fundamental integral identities), do the following:\n\n1. Let $h>0$ denote the width of the first panel $[0,h]$. Using the midpoint rule on this panel, write $g(E) = g(0) + g'(0)E + \\mathcal{O}(E^{2})$ and derive the leading-order asymptotic of the local quadrature error contributed by the midpoint rule on $[0,h]$ for the integrand $E^{-1/2}g(E)$. Express the leading-order term in powers of $h$ and show explicitly its dependence on $g(0)$.\n\n2. Propose a variable transformation that eliminates the $E^{-1/2}$ singularity at $E=0$ for integrals of the given form. Starting from the transformation, derive the transformed integrand and demonstrate that it is smooth at the new variable’s origin. Based on this transformed integrand, state the new leading-order local error scaling of a midpoint approximation on the corresponding first panel in the transformed variable.\n\n3. To connect with a canonical MB-weighted plasma integral, evaluate the integral\n$$\nI(T) = \\int_{0}^{\\infty} E^{-1/2}\\,\\exp\\!\\left(-\\frac{E}{T}\\right)\\,\\mathrm{dE},\n$$\nwhere $T>0$ is a positive energy scale (for example, Boltzmann’s constant times thermodynamic temperature). Use your variable transformation from part 2 and fundamental Gaussian integral identities to compute a closed-form analytic expression for $I(T)$. \n\nProvide your final answer as a single closed-form expression in terms of $T$ only. No numerical rounding is required, and you must not include units in your final boxed answer.",
            "solution": "The user-provided problem has been validated and is determined to be a well-posed, scientifically grounded problem in the field of computational science and numerical analysis. The solution proceeds in three parts as requested.\n\nThe problem investigates the numerical integration of functions of the form $I = \\int_{0}^{E_{\\max}} E^{-1/2}\\,g(E)\\,\\mathrm{d}E$, where $g(E)$ is a real-analytic function in a neighborhood of $E=0$. The integrand $f(E) = E^{-1/2}g(E)$ possesses an integrable singularity at the lower integration limit $E=0$.\n\n1. Derivation of the leading-order error for the midpoint rule.\n\nLet the first quadrature panel be the interval $[0, h]$, where $h > 0$. The exact value of the integral over this panel is $I_h = \\int_{0}^{h} E^{-1/2}\\,g(E)\\,\\mathrm{d}E$.\nThe midpoint quadrature rule approximates this integral as the area of a rectangle with width $h$ and height equal to the integrand's value at the midpoint of the interval, $E = h/2$. The approximation, denoted $M_h$, is thus:\n$$\nM_h = h \\cdot f(h/2) = h \\cdot (h/2)^{-1/2}\\,g(h/2)\n$$\nThe problem states that $g(E)$ is real-analytic near $E=0$ with the Taylor expansion $g(E) = g(0) + g'(0)E + \\mathcal{O}(E^2)$. We use this expansion to find asymptotic forms for both the exact integral $I_h$ and the approximation $M_h$ as $h \\to 0$.\n\nFor the exact integral $I_h$:\n$$\nI_h = \\int_0^h E^{-1/2} \\left[ g(0) + g'(0)E + \\mathcal{O}(E^2) \\right] \\mathrm{d}E\n$$\n$$\nI_h = \\int_0^h \\left[ g(0)E^{-1/2} + g'(0)E^{1/2} + \\mathcal{O}(E^{3/2}) \\right] \\mathrm{d}E\n$$\nIntegrating term by term:\n$$\nI_h = \\left[ g(0) \\cdot 2E^{1/2} + g'(0) \\cdot \\frac{2}{3}E^{3/2} + \\mathcal{O}(E^{5/2}) \\right]_0^h\n$$\n$$\nI_h = 2g(0)h^{1/2} + \\frac{2}{3}g'(0)h^{3/2} + \\mathcal{O}(h^{5/2})\n$$\n\nFor the midpoint rule approximation $M_h$:\n$$\nM_h = h \\cdot \\frac{\\sqrt{2}}{h^{1/2}} \\cdot g(h/2) = \\sqrt{2}h^{1/2} g(h/2)\n$$\nSubstituting the Taylor series for $g(h/2)$:\n$$\ng(h/2) = g(0) + g'(0)(h/2) + \\mathcal{O}(h^2)\n$$\n$$\nM_h = \\sqrt{2}h^{1/2} \\left[ g(0) + \\frac{1}{2}g'(0)h + \\mathcal{O}(h^2) \\right]\n$$\n$$\nM_h = \\sqrt{2}g(0)h^{1/2} + \\frac{\\sqrt{2}}{2}g'(0)h^{3/2} + \\mathcal{O}(h^{5/2})\n$$\n\nThe local quadrature error on the first panel, $E_h$, is the difference between the exact integral and its approximation, $E_h = I_h - M_h$.\n$$\nE_h = \\left( 2g(0)h^{1/2} + \\frac{2}{3}g'(0)h^{3/2} \\right) - \\left( \\sqrt{2}g(0)h^{1/2} + \\frac{\\sqrt{2}}{2}g'(0)h^{3/2} \\right) + \\mathcal{O}(h^{5/2})\n$$\n$$\nE_h = (2 - \\sqrt{2})g(0)h^{1/2} + \\left(\\frac{2}{3} - \\frac{\\sqrt{2}}{2}\\right)g'(0)h^{3/2} + \\mathcal{O}(h^{5/2})\n$$\nThe leading-order term of the error is the term with the lowest power of $h$. Since $g(0) \\neq 0$, this is the first term. The leading-order asymptotic of the error is:\n$$\nE_h \\sim (2 - \\sqrt{2})g(0)h^{1/2}\n$$\nThis demonstrates a very slow convergence rate of $\\mathcal{O}(h^{1/2})$, a direct consequence of applying a standard quadrature rule to an integrand with an endpoint singularity.\n\n2. Variable transformation to remove the singularity.\n\nTo eliminate the $E^{-1/2}$ singularity, we introduce a variable transformation that cancels the problematic term. The appropriate transformation is $E=u^2$.\nUnder this transformation, the differential becomes $\\mathrm{d}E = 2u\\,\\mathrm{d}u$. The singular part of the original integral is transformed as follows:\n$$\nE^{-1/2}\\,\\mathrm{d}E = (u^2)^{-1/2}\\,(2u\\,\\mathrm{d}u) = u^{-1}\\,(2u\\,\\mathrm{d}u) = 2\\,\\mathrm{d}u\n$$\nThe transformation changes the integration limits from $E \\in [0, E_{\\max}]$ to $u \\in [0, \\sqrt{E_{\\max}}]$. The full integral becomes:\n$$\nI = \\int_{0}^{E_{\\max}} E^{-1/2}\\,g(E)\\,\\mathrm{d}E = \\int_{0}^{\\sqrt{E_{\\max}}} g(u^2) (2\\,\\mathrm{d}u) = \\int_{0}^{\\sqrt{E_{\\max}}} 2g(u^2)\\,\\mathrm{d}u\n$$\nThe transformed integrand is $f_{\\text{new}}(u) = 2g(u^2)$. Since $g(E)$ is real-analytic in a neighborhood of $E=0$, it can be represented by a convergent power series $g(E) = \\sum_{k=0}^{\\infty} a_k E^k$. Substituting $E=u^2$, we get the series for the new integrand:\n$$\nf_{\\text{new}}(u) = 2g(u^2) = 2 \\sum_{k=0}^{\\infty} a_k (u^2)^k = \\sum_{k=0}^{\\infty} 2a_k u^{2k}\n$$\nThis is a power series in $u$ that converges in a neighborhood of $u=0$. A function represented by a convergent power series is real-analytic, and therefore infinitely differentiable (smooth). The new integrand $f_{\\text{new}}(u)$ is thus smooth at the new origin $u=0$.\n\nWith a smooth integrand, standard quadrature rules recover their usual accuracy. The local error for the midpoint rule on an interval $[a,b]$ for a smooth function $\\phi(x)$ is given by $\\frac{(b-a)^3}{24}\\phi''(\\xi)$ for some $\\xi \\in (a,b)$. For the first panel in the transformed variable, $[0,k]$, the error scales as $\\mathcal{O}(k^3)$, where $k$ is the panel width in the $u$-coordinate. This contrasts sharply with the $\\mathcal{O}(h^{1/2})$ scaling in the original variable. The relationship between the panel widths is $k = \\sqrt{h}$, so the error in terms of the original panel width $h$ scales as $\\mathcal{O}(k^3) = \\mathcal{O}((\\sqrt{h})^3) = \\mathcal{O}(h^{3/2})$. The new leading-order local error scaling of a midpoint approximation on the first panel in the transformed variable is $\\mathcal{O}(k^3)$.\n\n3. Evaluation of the integral $I(T)$.\n\nWe are asked to evaluate the integral:\n$$\nI(T) = \\int_{0}^{\\infty} E^{-1/2}\\,\\exp\\!\\left(-\\frac{E}{T}\\right)\\,\\mathrm{d}E\n$$\nThis integral is of the form discussed, with $g(E) = \\exp(-E/T)$ and an upper limit of $\\infty$. We apply the transformation $E = u^2$.\nThe differential is $\\mathrm{dE} = 2u\\,\\mathrm{d}u$. The integration limits are unchanged in form: as $E$ goes from $0$ to $\\infty$, $u$ also goes from $0$ to $\\infty$.\nSubstituting into the integral:\n$$\nI(T) = \\int_{0}^{\\infty} (u^2)^{-1/2} \\exp\\!\\left(-\\frac{u^2}{T}\\right) (2u\\,\\mathrm{d}u)\n$$\n$$\nI(T) = \\int_{0}^{\\infty} u^{-1} \\exp\\!\\left(-\\frac{u^2}{T}\\right) (2u\\,\\mathrm{d}u) = 2 \\int_{0}^{\\infty} \\exp\\!\\left(-\\frac{u^2}{T}\\right) \\mathrm{d}u\n$$\nThis is a form of the Gaussian integral. The fundamental identity for the Gaussian integral is:\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x = \\sqrt{\\frac{\\pi}{a}} \\quad \\text{for } a > 0\n$$\nSince the integrand $\\exp(-ax^2)$ is an even function, the integral over $[0, \\infty)$ is half of the integral over $(-\\infty, \\infty)$:\n$$\n\\int_{0}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}\n$$\nIn our case, the variable is $u$ and the constant $a$ is $1/T$. Applying this identity:\n$$\n\\int_{0}^{\\infty} \\exp\\!\\left(-\\frac{u^2}{T}\\right) \\mathrm{d}u = \\frac{1}{2}\\sqrt{\\frac{\\pi}{1/T}} = \\frac{1}{2}\\sqrt{\\pi T}\n$$\nFinally, substituting this result back into the expression for $I(T)$:\n$$\nI(T) = 2 \\cdot \\left( \\frac{1}{2}\\sqrt{\\pi T} \\right) = \\sqrt{\\pi T}\n$$\nThus, the closed-form analytic expression for the integral is $\\sqrt{\\pi T}$.",
            "answer": "$$\n\\boxed{\\sqrt{\\pi T}}\n$$"
        },
        {
            "introduction": "After mastering integrand singularities, we turn to another common challenge: integration domains that extend to infinity. This practice  demonstrates how to handle such cases by using a rational mapping to transform the semi-infinite velocity domain $[0, \\infty)$ into the finite interval $[-1, 1]$ required by standard high-accuracy methods like Gauss–Legendre quadrature. You will not only perform the change of variables but also explore how to intelligently choose a scaling parameter based on physical scales, a crucial step in optimizing numerical performance.",
            "id": "4023279",
            "problem": "In collisional transport modeling for magnetically confined fusion plasmas, velocity-space integrals over an isotropic Maxwellian often appear. Consider the energy-like moment integral\n$$\nI(\\beta) \\equiv \\int_{0}^{\\infty} v^{2}\\,\\exp(-\\beta v^{2})\\,dv,\n$$\nwhere $\\beta = m/(2 k_{B} T)$, $m$ is the particle mass, $k_{B}$ is the Boltzmann constant, and $T$ is the temperature. To enable high-accuracy integration using Gauss–Legendre (GL) quadrature, an endpoint mapping is introduced that takes the semi-infinite domain $[0,\\infty)$ to a finite interval. Use the mapping\n$$\nv(x) = \\alpha\\,\\frac{1+x}{1-x}, \\quad x \\in (-1,1),\n$$\nwith a positive scaling $\\alpha$, and the corresponding Jacobian factor.\n\nTasks:\n1. Starting from the definitions above and first principles of change of variables, derive the transformed integral on the interval $x \\in (-1,1)$, including the correct Jacobian factor.\n2. Using the two-point Gauss–Legendre quadrature rule on $[-1,1]$ (nodes $x = \\pm 1/\\sqrt{3}$, equal weights), write down the mapped quadrature approximation $Q(\\alpha)$ for $I(\\beta)$.\n3. Define the thermal speed $v_{\\mathrm{th}} \\equiv \\sqrt{2 k_{B} T/m}$. Choose $\\alpha$ such that the mapped upper node $x=+1/\\sqrt{3}$ corresponds to $v_{\\mathrm{th}}$, and express $\\alpha$ in terms of $\\beta$.\n4. Evaluate the exact integral $I(\\beta)$ in closed form using a standard Gaussian integral. Then, form the signed relative error\n$$\nE \\equiv \\frac{Q(\\alpha) - I(\\beta)}{I(\\beta)}.\n$$\nCompute $E$ as a pure number for your choice of $\\alpha$ and simplify it as much as possible. Round your final numerical result for $E$ to four significant figures. The relative error is dimensionless; do not include units in your final numerical answer.",
            "solution": "The user provides a multi-part problem concerning the numerical evaluation of a velocity-space integral common in plasma physics. The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and self-contained. We proceed with a detailed solution to the four specified tasks.\n\n### 1. Derivation of the Transformed Integral\n\nThe integral to be evaluated is\n$$\nI(\\beta) = \\int_{0}^{\\infty} v^{2}\\,\\exp(-\\beta v^{2})\\,dv.\n$$\nWe apply the change of variables from $v \\in [0,\\infty)$ to $x \\in (-1,1)$ using the mapping\n$$\nv(x) = \\alpha\\,\\frac{1+x}{1-x},\n$$\nwhere $\\alpha$ is a positive constant. First, we must find the Jacobian of this transformation, which is the derivative $\\frac{dv}{dx}$. Using the quotient rule for differentiation,\n$$\n\\frac{d}{dx} \\left( \\frac{1+x}{1-x} \\right) = \\frac{(1)(1-x) - (1+x)(-1)}{(1-x)^2} = \\frac{1-x+1+x}{(1-x)^2} = \\frac{2}{(1-x)^2}.\n$$\nThus, the Jacobian factor is\n$$\n\\frac{dv}{dx} = \\frac{2\\alpha}{(1-x)^2}.\n$$\nThe differential element transforms as $dv = \\frac{2\\alpha}{(1-x)^2} dx$.\nWe check the mapping of the integration limits. As $x \\to -1^{+}$, $v(x) \\to \\alpha \\frac{1-1}{1-(-1)} = 0$. As $x \\to 1^{-}$, the denominator $1-x \\to 0^{+}$, so $v(x) \\to \\infty$. The mapping correctly transforms the integration interval from $[0,\\infty)$ to $[-1,1)$ (or more properly, the open interval $(-1,1)$).\n\nSubstituting $v(x)$ and $dv$ into the integral expression for $I(\\beta)$, we get the transformed integral over $x$:\n$$\nI(\\beta) = \\int_{-1}^{1} \\left(\\alpha \\frac{1+x}{1-x}\\right)^2 \\exp\\left(-\\beta \\left(\\alpha \\frac{1+x}{1-x}\\right)^2\\right) \\frac{2\\alpha}{(1-x)^2} dx.\n$$\nLet the integrand in the $x$-domain be denoted by $f(x)$. Combining terms, we have\n$$\nf(x) = 2\\alpha^3 \\frac{(1+x)^2}{(1-x)^4} \\exp\\left(-\\beta\\alpha^2 \\left(\\frac{1+x}{1-x}\\right)^2\\right).\n$$\nSo the transformed integral is\n$$\nI(\\beta) = \\int_{-1}^{1} f(x) dx = \\int_{-1}^{1} 2\\alpha^3 \\frac{(1+x)^2}{(1-x)^4} \\exp\\left(-\\beta\\alpha^2 \\left(\\frac{1+x}{1-x}\\right)^2\\right) dx.\n$$\n\n### 2. Gauss–Legendre Quadrature Approximation $Q(\\alpha)$\n\nThe two-point Gauss-Legendre quadrature rule on the interval $[-1,1]$ approximates an integral $\\int_{-1}^{1} f(x) dx$ as a weighted sum of the integrand evaluated at two specific nodes:\n$$\n\\int_{-1}^{1} f(x) dx \\approx w_1 f(x_1) + w_2 f(x_2).\n$$\nFor the two-point rule, the nodes are $x_1 = -1/\\sqrt{3}$ and $x_2 = 1/\\sqrt{3}$, and the weights are $w_1 = w_2 = 1$.\nThe quadrature approximation, which we denote $Q(\\alpha)$, is therefore\n$$\nQ(\\alpha) = f(-1/\\sqrt{3}) + f(1/\\sqrt{3}).\n$$\nTo write the explicit expression for $Q(\\alpha)$, we evaluate the components of $f(x)$ at the nodes.\nLet us evaluate the term $y(x) = \\frac{1+x}{1-x}$ at the nodes:\nAt $x_1 = -1/\\sqrt{3}$: $y(x_1) = \\frac{1-1/\\sqrt{3}}{1+1/\\sqrt{3}} = \\frac{\\sqrt{3}-1}{\\sqrt{3}+1} = \\frac{(\\sqrt{3}-1)^2}{3-1} = \\frac{3-2\\sqrt{3}+1}{2} = 2-\\sqrt{3}$.\nAt $x_2 = 1/\\sqrt{3}$: $y(x_2) = \\frac{1+1/\\sqrt{3}}{1-1/\\sqrt{3}} = \\frac{\\sqrt{3}+1}{\\sqrt{3}-1} = \\frac{(\\sqrt{3}+1)^2}{3-1} = \\frac{3+2\\sqrt{3}+1}{2} = 2+\\sqrt{3}$.\n\nThe integrand can be written more simply as $f(x) = v(x)^2 \\exp(-\\beta v(x)^2) \\frac{dv}{dx}$. Let's evaluate the components $v(x)$ and $\\frac{dv}{dx}$ at the nodes.\n$v_1 = v(x_1) = \\alpha y(x_1) = \\alpha(2-\\sqrt{3})$.\n$v_2 = v(x_2) = \\alpha y(x_2) = \\alpha(2+\\sqrt{3})$.\n\nThe Jacobian at the nodes:\n$\\frac{dv}{dx}\\bigg|_{x_1} = \\frac{2\\alpha}{(1+1/\\sqrt{3})^2} = \\frac{2\\alpha \\cdot 3}{(\\sqrt{3}+1)^2} = \\frac{6\\alpha}{4+2\\sqrt{3}} = \\frac{3\\alpha}{2+\\sqrt{3}} = 3\\alpha(2-\\sqrt{3})$.\n$\\frac{dv}{dx}\\bigg|_{x_2} = \\frac{2\\alpha}{(1-1/\\sqrt{3})^2} = \\frac{2\\alpha \\cdot 3}{(\\sqrt{3}-1)^2} = \\frac{6\\alpha}{4-2\\sqrt{3}} = \\frac{3\\alpha}{2-\\sqrt{3}} = 3\\alpha(2+\\sqrt{3})$.\n\nNow we find the terms $f(x_1)$ and $f(x_2)$:\n$f(x_1) = v_1^2 \\exp(-\\beta v_1^2) \\left(\\frac{dv}{dx}\\right)_{x_1} = [\\alpha^2(2-\\sqrt{3})^2] \\exp(-\\beta \\alpha^2(2-\\sqrt{3})^2) [3\\alpha(2-\\sqrt{3})]$.\n$f(x_1) = 3\\alpha^3 (2-\\sqrt{3})^3 \\exp(-\\beta \\alpha^2(7-4\\sqrt{3})) = 3\\alpha^3 (26-15\\sqrt{3}) \\exp(-\\beta \\alpha^2(7-4\\sqrt{3}))$.\n$f(x_2) = v_2^2 \\exp(-\\beta v_2^2) \\left(\\frac{dv}{dx}\\right)_{x_2} = [\\alpha^2(2+\\sqrt{3})^2] \\exp(-\\beta \\alpha^2(2+\\sqrt{3})^2) [3\\alpha(2+\\sqrt{3})]$.\n$f(x_2) = 3\\alpha^3 (2+\\sqrt{3})^3 \\exp(-\\beta \\alpha^2(7+4\\sqrt{3})) = 3\\alpha^3 (26+15\\sqrt{3}) \\exp(-\\beta \\alpha^2(7+4\\sqrt{3}))$.\n\nSumming these two terms gives the quadrature approximation $Q(\\alpha)$:\n$$\nQ(\\alpha) = 3\\alpha^3 \\left[ (26-15\\sqrt{3}) \\exp(-\\beta\\alpha^2(7-4\\sqrt{3})) + (26+15\\sqrt{3}) \\exp(-\\beta\\alpha^2(7+4\\sqrt{3})) \\right].\n$$\n\n### 3. Choice of the Scaling Parameter $\\alpha$\n\nWe are asked to choose the positive scaling parameter $\\alpha$ such that the mapped upper node $x = 1/\\sqrt{3}$ corresponds to the thermal speed $v_{\\mathrm{th}}$.\nThe thermal speed is defined as $v_{\\mathrm{th}} \\equiv \\sqrt{2 k_{B} T/m}$.\nThe parameter $\\beta$ is given as $\\beta = m/(2 k_{B} T)$, so $v_{\\mathrm{th}} = \\sqrt{1/\\beta} = 1/\\sqrt{\\beta}$.\nThe condition is $v(1/\\sqrt{3}) = v_{\\mathrm{th}}$. From the previous section, we know $v(1/\\sqrt{3}) = \\alpha(2+\\sqrt{3})$.\nSetting these equal gives:\n$$\n\\alpha(2+\\sqrt{3}) = v_{\\mathrm{th}} = \\frac{1}{\\sqrt{\\beta}}.\n$$\nSolving for $\\alpha$ yields:\n$$\n\\alpha = \\frac{1}{(2+\\sqrt{3})\\sqrt{\\beta}} = \\frac{2-\\sqrt{3}}{\\sqrt{\\beta}}.\n$$\n\n### 4. Exact Integral and Relative Error\n\nFirst, we evaluate the exact integral $I(\\beta)$ in closed form. The integral $I(\\beta) = \\int_{0}^{\\infty} v^{2}\\,\\exp(-\\beta v^{2})\\,dv$ is a standard form of a Gaussian integral. The general formula for non-negative integer $n$ is:\n$$\n\\int_{0}^{\\infty} u^{2n} \\exp(-a u^2) du = \\frac{(2n-1)!!}{2^{n+1}a^n} \\sqrt{\\frac{\\pi}{a}}.\n$$\nFor our integral, $n=1$ and $a=\\beta$. The double factorial $(2(1)-1)!! = 1!! = 1$.\nSubstituting these values into the formula gives:\n$$\nI(\\beta) = \\frac{1}{2^{1+1}\\beta^1} \\sqrt{\\frac{\\pi}{\\beta}} = \\frac{1}{4\\beta} \\sqrt{\\frac{\\pi}{\\beta}} = \\frac{\\sqrt{\\pi}}{4\\beta^{3/2}}.\n$$\nNext, we evaluate the quadrature approximation $Q(\\alpha$) for the specific choice of $\\alpha$ from part 3.\nWe substitute $\\alpha = (2-\\sqrt{3})/\\sqrt{\\beta}$ into the expression for $Q(\\alpha)$.\nWe need $\\alpha^2$ and $\\alpha^3$:\n$\\alpha^2 = \\frac{(2-\\sqrt{3})^2}{\\beta} = \\frac{7-4\\sqrt{3}}{\\beta}$.\n$\\alpha^3 = \\frac{(2-\\sqrt{3})^3}{\\beta^{3/2}} = \\frac{26-15\\sqrt{3}}{\\beta^{3/2}}$.\n\nNow we evaluate the arguments of the exponentials in $Q(\\alpha)$:\nTerm 1 argument: $-\\beta\\alpha^2(7-4\\sqrt{3}) = -\\beta \\frac{7-4\\sqrt{3}}{\\beta} (7-4\\sqrt{3}) = -(7-4\\sqrt{3})^2 = -(49 - 56\\sqrt{3} + 48) = -(97-56\\sqrt{3})$.\nTerm 2 argument: $-\\beta\\alpha^2(7+4\\sqrt{3}) = -\\beta \\frac{7-4\\sqrt{3}}{\\beta} (7+4\\sqrt{3}) = -(49-48) = -1$.\n\nSubstituting these into the expression for $Q(\\alpha)$:\n$$\nQ(\\alpha) = 3\\frac{26-15\\sqrt{3}}{\\beta^{3/2}} \\left[ (26-15\\sqrt{3}) \\exp(-(97-56\\sqrt{3})) + (26+15\\sqrt{3}) \\exp(-1) \\right].\n$$\nDistributing the leading factor gives:\n$$\nQ(\\alpha) = \\frac{3}{\\beta^{3/2}} \\left[ (26-15\\sqrt{3})^2 \\exp(-(97-56\\sqrt{3})) + (26-15\\sqrt{3})(26+15\\sqrt{3}) \\exp(-1) \\right].\n$$\nSince $(26-15\\sqrt{3})(26+15\\sqrt{3}) = 26^2 - (15\\sqrt{3})^2 = 676 - 225 \\cdot 3 = 676 - 675 = 1$, the expression simplifies to:\n$$\nQ(\\alpha) = \\frac{3}{\\beta^{3/2}} \\left[ (26-15\\sqrt{3})^2 \\exp(-(97-56\\sqrt{3})) + \\exp(-1) \\right].\n$$\nNote that $(26-15\\sqrt{3})^2 = 1351 - 780\\sqrt{3}$.\n\nFinally, we compute the signed relative error $E$:\n$$\nE = \\frac{Q(\\alpha) - I(\\beta)}{I(\\beta)} = \\frac{Q(\\alpha)}{I(\\beta)} - 1.\n$$\nThe ratio $\\frac{Q(\\alpha)}{I(\\beta)}$ is:\n$$\n\\frac{Q(\\alpha)}{I(\\beta)} = \\frac{\\frac{3}{\\beta^{3/2}} \\left[ (1351-780\\sqrt{3}) \\exp(-(97-56\\sqrt{3})) + \\exp(-1) \\right]}{\\frac{\\sqrt{\\pi}}{4\\beta^{3/2}}}.\n$$\nThe factor $\\beta^{3/2}$ cancels, and we are left with a pure number:\n$$\n\\frac{Q(\\alpha)}{I(\\beta)} = \\frac{12}{\\sqrt{\\pi}} \\left[ (1351-780\\sqrt{3}) \\exp(-(97-56\\sqrt{3})) + \\exp(-1) \\right].\n$$\nNow we compute the numerical value.\nUsing $\\sqrt{3} \\approx 1.7320508$ and $\\sqrt{\\pi} \\approx 1.7724539$:\n$1351 - 780\\sqrt{3} \\approx 1351 - 780(1.7320508) \\approx 0.000376$.\n$97 - 56\\sqrt{3} \\approx 97 - 56(1.7320508) \\approx 0.005155$.\n$\\exp(-(97-56\\sqrt{3})) \\approx \\exp(-0.005155) \\approx 0.994859$.\n$\\exp(-1) \\approx 0.367879$.\nThe term in brackets is approximately:\n$0.000376 \\times 0.994859 + 0.367879 \\approx 0.000374 + 0.367879 = 0.368253$.\nThe ratio is $\\frac{12}{\\sqrt{\\pi}} \\times 0.368253 \\approx 6.770287 \\times 0.368253 \\approx 2.493235$.\nThe relative error is $E \\approx 2.493235 - 1 = 1.493235$.\nRounding to four significant figures, we get $1.493$.",
            "answer": "$$\\boxed{1.493}$$"
        },
        {
            "introduction": "While standard quadrature rules are powerful, maximum efficiency is often achieved by designing a rule tailored to the specific structure of the integral. This final exercise  guides you through the construction of a custom two-point Gaussian quadrature for an integral containing the weight function $(1-\\mu^2)$, which frequently appears in perpendicular velocity moments. By enforcing polynomial exactness, you will derive the nodes and weights from first principles, gaining insight into the theoretical foundation of these powerful numerical tools.",
            "id": "4023292",
            "problem": "In reduced kinetic descriptions of magnetized plasmas, perpendicular velocity moments over the pitch-angle cosine are frequently required. Let the pitch-angle cosine be denoted by $\\mu \\in [-1,1]$, with the perpendicular projection factor $\\sin^{2}\\theta$ written as $1-\\mu^{2}$. Consider integrals of the form\n$$\nI[f] \\equiv \\int_{-1}^{1} \\left(1-\\mu^{2}\\right) f(\\mu)\\, d\\mu,\n$$\nwhich arise when computing perpendicular velocity moments of distribution functions $f(\\mu)$ under axisymmetry.\n\nStarting from the definition of polynomial exactness for numerical quadrature and the basic symmetry properties of the interval $[-1,1]$ and the even weight $1-\\mu^{2}$, develop a two-point symmetric quadrature of the form\n$$\nQ[f] \\equiv \\omega_{1} f(\\mu_{1}) + \\omega_{2} f(\\mu_{2})\n$$\nthat is exact for all polynomials $f(\\mu)$ of degree at most $3$. Determine the nodes $\\mu_{1}$ and $\\mu_{2}$ and the weights $\\omega_{1}$ and $\\omega_{2}$ by enforcing exactness on the lowest-degree moments consistent with the symmetry of the weight.\n\nThen, using your derived quadrature, verify exactness for $f(\\mu)=1$, $f(\\mu)=\\mu$, $f(\\mu)=\\mu^{2}$, and $f(\\mu)=\\mu^{3}$ by comparing $I[f]$ and $Q[f]$ in closed form. You do not need to report these verification values in the final answer.\n\nReport your final answer as the nodes and weights in the order $(\\mu_{1}, \\mu_{2}, \\omega_{1}, \\omega_{2})$ in a single row matrix. No rounding is required. No physical units are involved.",
            "solution": "The user wants to solve the problem by following these steps:\n1.  Verify the problem statement.\n2.  If the problem is valid, solve for the quadrature nodes and weights.\n3.  Format the output according to the specified rules.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Integral to be approximated: $I[f] \\equiv \\int_{-1}^{1} \\left(1-\\mu^{2}\\right) f(\\mu)\\, d\\mu$.\n-   Domain of integration for the variable $\\mu$: $\\mu \\in [-1,1]$.\n-   The weight function is identified as $w(\\mu) = 1-\\mu^{2}$.\n-   The form of the quadrature rule is a two-point symmetric quadrature: $Q[f] \\equiv \\omega_{1} f(\\mu_{1}) + \\omega_{2} f(\\mu_{2})$.\n-   The quadrature rule must be exact for all polynomials $f(\\mu)$ of degree at most $3$. This means $I[f] = Q[f]$ for $f(\\mu) = 1, \\mu, \\mu^2, \\mu^3$.\n-   The determination of nodes and weights should be based on enforcing exactness for the lowest-degree moments consistent with the symmetry of the problem.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is well-grounded in numerical analysis and computational physics. The integral form is common in kinetic theory for magnetized plasmas, and the development of a custom quadrature rule for a non-standard weight function ($w(\\mu) = 1-\\mu^2$) is a standard and practical task in scientific computing. The principles invoked are those of numerical integration, specifically Gaussian quadrature.\n-   **Well-Posed**: The problem asks for the determination of four unknowns: two nodes ($\\mu_1, \\mu_2$) and two weights ($\\omega_1, \\omega_2$). The requirement of exactness for polynomials of degree up to $3$ provides four linear constraints on a basis $\\{1, \\mu, \\mu^2, \\mu^3\\}$, which in principle is sufficient to determine the four unknowns. The additional constraint of symmetry ($\\mu_2 = -\\mu_1$, $\\omega_2 = \\omega_1$) simplifies the system, reducing it to two unknowns and two non-trivial equations, which is a well-posed algebraic problem.\n-   **Objective**: The problem is stated in precise mathematical language, free from any subjective or ambiguous terminology.\n-   The problem does not violate any of the other invalidity criteria. It is complete, consistent, realistic, and requires non-trivial reasoning.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. The solution process will now proceed.\n\n### Solution Derivation\n\nThe objective is to find the nodes $\\mu_{1}, \\mu_{2}$ and weights $\\omega_{1}, \\omega_{2}$ for the quadrature rule\n$$\nQ[f] = \\omega_{1}f(\\mu_{1}) + \\omega_{2}f(\\mu_{2})\n$$\nsuch that it exactly integrates any polynomial $f(\\mu)$ of degree up to $3$ with the weight function $w(\\mu) = 1-\\mu^{2}$ over the interval $[-1, 1]$.\nThe exact integral is given by\n$$\nI[f] = \\int_{-1}^{1} (1-\\mu^{2}) f(\\mu) \\,d\\mu\n$$\n\nThe problem specifies a symmetric quadrature. The integration interval $[-1, 1]$ is symmetric about $\\mu=0$, and the weight function $w(\\mu) = 1-\\mu^{2}$ is an even function. For a symmetric quadrature rule, the nodes must be placed symmetrically about the origin, and the corresponding weights must be equal. Therefore, we must have:\n$$\n\\mu_{2} = -\\mu_{1} \\quad \\text{and} \\quad \\omega_{2} = \\omega_{1}\n$$\nLet's define a single positive node $\\mu_{0} = \\mu_{2}$ (assuming $\\mu_2 > 0$ without loss of generality) and a single weight $\\omega_{0} = \\omega_{1} = \\omega_2$. Then the quadrature rule simplifies to:\n$$\nQ[f] = \\omega_{0}f(\\mu_{0}) + \\omega_{0}f(-\\mu_{0}) = \\omega_{0} \\left( f(\\mu_{0}) + f(-\\mu_{0}) \\right)\n$$\nWe must enforce the condition $I[f] = Q[f]$ for a basis of polynomials up to degree $3$, i.e., $f(\\mu) \\in \\{1, \\mu, \\mu^2, \\mu^3\\}$.\n\nLet's examine the symmetry. For any odd function $f(\\mu)$, the integrand $(1-\\mu^2)f(\\mu)$ is odd, so the exact integral $I[f]$ over the symmetric interval $[-1,1]$ is zero.\n$$\nI[f_{\\text{odd}}] = \\int_{-1}^{1} (1-\\mu^2) f_{\\text{odd}}(\\mu) \\,d\\mu = 0\n$$\nThe quadrature for an odd function is also zero due to its symmetric construction:\n$$\nQ[f_{\\text{odd}}] = \\omega_{0} \\left( f_{\\text{odd}}(\\mu_{0}) + f_{\\text{odd}}(-\\mu_{0}) \\right) = \\omega_{0} \\left( f_{\\text{odd}}(\\mu_{0}) - f_{\\text{odd}}(\\mu_{0}) \\right) = 0\n$$\nThus, the quadrature is automatically exact for all odd polynomials. This covers the cases $f(\\mu) = \\mu$ and $f(\\mu) = \\mu^3$. We only need to enforce the exactness condition for the even polynomials in our basis: $f(\\mu) = 1$ and $f(\\mu) = \\mu^2$. This yields two equations for our two unknowns, $\\omega_{0}$ and $\\mu_{0}$.\n\n**Condition for $f(\\mu) = 1$:**\nThe exact integral is:\n$$\nI[1] = \\int_{-1}^{1} (1-\\mu^{2})(1) \\,d\\mu = \\left[ \\mu - \\frac{\\mu^{3}}{3} \\right]_{-1}^{1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^{3}}{3}\\right) = \\frac{2}{3} - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nThe quadrature approximation is:\n$$\nQ[1] = \\omega_{0} (1+1) = 2\\omega_{0}\n$$\nEquating the two gives our first equation:\n$$\n2\\omega_{0} = \\frac{4}{3} \\implies \\omega_{0} = \\frac{2}{3}\n$$\n\n**Condition for $f(\\mu) = \\mu^2$:**\nThe exact integral is:\n$$\nI[\\mu^2] = \\int_{-1}^{1} (1-\\mu^{2})\\mu^{2} \\,d\\mu = \\int_{-1}^{1} (\\mu^2 - \\mu^4) \\,d\\mu = \\left[ \\frac{\\mu^{3}}{3} - \\frac{\\mu^{5}}{5} \\right]_{-1}^{1} = \\left(\\frac{1}{3} - \\frac{1}{5}\\right) - \\left(\\frac{-1}{3} - \\frac{-1}{5}\\right) = \\frac{2}{15} - \\left(-\\frac{2}{15}\\right) = \\frac{4}{15}\n$$\nThe quadrature approximation is:\n$$\nQ[\\mu^2] = \\omega_{0} \\left( (\\mu_{0})^2 + (-\\mu_{0})^2 \\right) = \\omega_{0} (2\\mu_{0}^2) = 2\\omega_{0}\\mu_{0}^2\n$$\nEquating the two gives our second equation:\n$$\n2\\omega_{0}\\mu_{0}^2 = \\frac{4}{15}\n$$\n\nNow, we solve the system of two equations. Substitute the value of $\\omega_{0} = \\frac{2}{3}$ into the second equation:\n$$\n2\\left(\\frac{2}{3}\\right)\\mu_{0}^2 = \\frac{4}{15} \\implies \\frac{4}{3}\\mu_{0}^2 = \\frac{4}{15}\n$$\n$$\n\\mu_{0}^2 = \\frac{4}{15} \\cdot \\frac{3}{4} = \\frac{3}{15} = \\frac{1}{5}\n$$\nSince we defined $\\mu_0$ to be the positive node, we take the positive square root:\n$$\n\\mu_{0} = \\sqrt{\\frac{1}{5}} = \\frac{1}{\\sqrt{5}} = \\frac{\\sqrt{5}}{5}\n$$\n\nWe have now determined the fundamental parameters. We can write down the full set of nodes and weights. Adopting the convention of ordering nodes from negative to positive, we set $\\mu_1 = -\\mu_0$ and $\\mu_2 = \\mu_0$. The weights are equal: $\\omega_1 = \\omega_2 = \\omega_0$.\n-   Node 1: $\\mu_{1} = -\\frac{\\sqrt{5}}{5}$\n-   Node 2: $\\mu_{2} = \\frac{\\sqrt{5}}{5}$\n-   Weight 1: $\\omega_{1} = \\frac{2}{3}$\n-   Weight 2: $\\omega_{2} = \\frac{2}{3}$\n\nAs requested, we verify exactness for the basis polynomials.\n-   For $f(\\mu)=1$: $I[1]=\\frac{4}{3}$. $Q[1]=\\frac{2}{3}(1) + \\frac{2}{3}(1) = \\frac{4}{3}$. Correct.\n-   For $f(\\mu)=\\mu$: $I[\\mu]=0$. $Q[\\mu]=\\frac{2}{3}(-\\frac{\\sqrt{5}}{5}) + \\frac{2}{3}(\\frac{\\sqrt{5}}{5}) = 0$. Correct.\n-   For $f(\\mu)=\\mu^2$: $I[\\mu^2]=\\frac{4}{15}$. $Q[\\mu^2]=\\frac{2}{3}(-\\frac{\\sqrt{5}}{5})^2 + \\frac{2}{3}(\\frac{\\sqrt{5}}{5})^2 = \\frac{2}{3}(\\frac{1}{5}) + \\frac{2}{3}(\\frac{1}{5}) = 2 \\cdot \\frac{2}{3} \\cdot \\frac{1}{5} = \\frac{4}{15}$. Correct.\n-   For $f(\\mu)=\\mu^3$: $I[\\mu^3]=0$. $Q[\\mu^3]=\\frac{2}{3}(-\\frac{\\sqrt{5}}{5})^3 + \\frac{2}{3}(\\frac{\\sqrt{5}}{5})^3 = 0$. Correct.\nThe quadrature is exact for all polynomials up to degree $3$, as required.\n\nThe final answer should report the values in the order $(\\mu_{1}, \\mu_{2}, \\omega_{1}, \\omega_{2})$. As chosen above, with $\\mu_1  \\mu_2$, the parameters are: $\\mu_1 = - \\frac{\\sqrt{5}}{5}$, $\\mu_2 = \\frac{\\sqrt{5}}{5}$, $\\omega_1 = \\frac{2}{3}$, $\\omega_2 = \\frac{2}{3}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\sqrt{5}}{5}  \\frac{\\sqrt{5}}{5}  \\frac{2}{3}  \\frac{2}{3} \\end{pmatrix}}\n$$"
        }
    ]
}