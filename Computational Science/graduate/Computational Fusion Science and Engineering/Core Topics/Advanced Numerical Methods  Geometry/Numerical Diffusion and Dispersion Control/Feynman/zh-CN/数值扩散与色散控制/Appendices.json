{
    "hands_on_practices": [
        {
            "introduction": "数值格式的准确性是计算聚变科学中的核心问题。本练习通过冯·诺依曼分析，为一阶迎风格式和二阶Lax-Wendroff格式推导其复数放大因子，从而在理论层面量化数值耗散与频散误差。通过理查森外推法估计收敛阶，你将掌握从解析角度评估和比较不同数值格式性能的基本技能，为选择合适的算法打下坚实基础 。",
            "id": "4022216",
            "problem": "考虑守恒形式的一维线性平流方程，其相速度为常数，由 $u_t + c\\,u_x = 0$ 给出，其中 $u(x,t)$ 表示一个标量场，$c$ 是物理平流速度。目标是通过在网格加密中使用傅里叶分析和理查森外推来量化和控制数值扩散与色散。工作背景为计算聚变科学与工程，其中精确的波传播（例如，磁流体动力学波包）需要将色散误差（相速度失真）与耗散误差（振幅衰减）分离开来。\n\n你将分析均匀网格上的两种显式有限差分格式：\n- 一阶迎风格式（时间上向前欧拉，空间上一阶迎风），由更新方程定义\n$$\nu_j^{n+1} = u_j^n - \\lambda\\left(u_j^n - u_{j-1}^n\\right),\n$$\n其中 $u_j^n$ 近似于 $u(jh, n\\Delta t)$，$h$ 是网格间距，$\\Delta t$ 是时间步长，$j$ 和 $n$ 是整数，$\\lambda = c\\,\\Delta t / h$ 是 Courant-Friedrichs-Lewy (CFL) 数。\n- 二阶Lax–Wendroff格式（时间上和空间上均为二阶），定义为\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\lambda^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right).\n$$\n\n使用冯·诺依曼傅里叶分析：代入单个傅里叶模 $u_j^n = \\hat{u}^n \\exp(i k j h)$，其中波数 $k$ 的单位是弧度/米，并推导出复放大因子 $G(\\theta,\\lambda)$，其中 $\\theta = k h$ 是每个网格单元的无量纲相角。关系式 $G = \\exp(-i \\omega_{\\mathrm{num}} \\Delta t)$ 和 $|G| = \\exp(\\sigma_{\\mathrm{num}} \\Delta t)$ 定义了数值角频率 $\\omega_{\\mathrm{num}}$ 和数值阻尼率 $\\sigma_{\\mathrm{num}}$。精确角频率为 $\\omega_{\\mathrm{exact}} = c\\,k$，平流方程的精确阻尼率为 $\\sigma_{\\mathrm{exact}} = 0$。数值相速度为 $c_{\\mathrm{num}} = \\omega_{\\mathrm{num}}/k$。\n\n将色散误差大小定义为 $E_{\\mathrm{disp}}(h) = |c_{\\mathrm{num}}(h) - c|$，耗散误差大小定义为 $E_{\\mathrm{diss}}(h) = |\\sigma_{\\mathrm{num}}(h) - \\sigma_{\\mathrm{exact}}| = |\\sigma_{\\mathrm{num}}(h)|$。对于固定的 CFL 数 $\\lambda$ 和固定的物理平流速度 $c$，通过将 $h$ 减半并相应地将 $\\Delta t$ 减半来加密网格（以保持 $\\lambda$ 不变）。使用理查森外推通过以下公式估计每个误差分量的观测收敛阶 $p$：\n$$\np \\approx \\frac{\\log\\left(E(h)/E(h/2)\\right)}{\\log(2)}.\n$$\n对每种格式的色散误差和耗散误差分别计算此 $p$。\n\n角度量必须以弧度处理。物理平流速度 $c$ 必须以 $\\mathrm{m/s}$ 表示和解释，波数 $k$ 以 $\\mathrm{rad/m}$ 表示，网格间距 $h$ 以 $\\mathrm{m}$ 表示，时间步长 $\\Delta t$ 以 $\\mathrm{s}$ 表示，阻尼率以 $\\mathrm{s}^{-1}$ 表示。所有输出必须是无量纲的浮点数。\n\n实现一个程序，该程序：\n- 对于每个测试用例和每种格式，使用傅里叶分析在固定的 $\\lambda$ 下计算两种加密网格 $h$ 和 $h/2$ 的放大因子，然后计算 $E_{\\mathrm{disp}}(h)$、$E_{\\mathrm{disp}}(h/2)$、$E_{\\mathrm{diss}}(h)$ 和 $E_{\\mathrm{diss}}(h/2)$，最后返回理查森阶数估计值 $p_{\\mathrm{disp}}$ 和 $p_{\\mathrm{diss}}$。\n- 将所有结果汇总到一行中，格式化为方括号内以逗号分隔的列表，按测试用例排序为 $[p_{\\mathrm{disp}}^{\\mathrm{upwind}}, p_{\\mathrm{diss}}^{\\mathrm{upwind}}, p_{\\mathrm{disp}}^{\\mathrm{LW}}, p_{\\mathrm{diss}}^{\\mathrm{LW}}]$，并为所有测试用例连接起来。\n\n使用以下参数值的测试套件以确保覆盖范围：\n- 测试用例 1（一般情况）：$c = 1.7\\,\\mathrm{m/s}$，$\\lambda = 0.65$，$k = 7.5\\,\\mathrm{rad/m}$，$h = 0.12\\,\\mathrm{m}$，$h/2 = 0.06\\,\\mathrm{m}$。\n- 测试用例 2（长波极限）：$c = 1.7\\,\\mathrm{m/s}$，$\\lambda = 0.65$，$k = 1.2\\,\\mathrm{rad/m}$，$h = 0.12\\,\\mathrm{m}$，$h/2 = 0.06\\,\\mathrm{m}$。\n- 测试用例 3（近奈奎斯特挑战）：$c = 1.7\\,\\mathrm{m/s}$，$\\lambda = 0.65$，$k = 26.0\\,\\mathrm{rad/m}$，$h = 0.12\\,\\mathrm{m}$，$h/2 = 0.06\\,\\mathrm{m}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，按测试用例 1、测试用例 2、测试用例 3 的顺序排列，每个测试用例按上述顺序提供四个浮点数，总共十二个浮点数，例如 $[r_1,r_2,r_3,r_4,r_5,r_6,r_7,r_8,r_9,r_{10},r_{11},r_{12}]$。",
            "solution": "问题分析始于验证其前提。该问题是偏微分方程数值分析中的一个标准练习，具体来说是利用冯·诺依曼稳定性和相误差分析来研究线性平流方程的有限差分格式。所有给定的方程、定义和参数在科学上都是合理的、适定的和一致的。因此，该问题被认为是有效的，可以构建一个完整的解决方案。\n\n问题的核心是量化波传播模拟中的数值误差，这是计算聚变科学中的一个关键方面，其中像磁流体动力学波这样的现象必须以高保真度建模。该分析将误差分为两类：耗散（或阻尼）误差，它导致非物理的振幅衰减；以及色散误差，它导致不同波长的波以不正确的速度传播。\n\n控制方程是一维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x,t)$ 是一个标量， $c$ 是恒定的平流速度。对于初始剖面 $u(x,0) = f(x)$，其精确解为 $u(x,t) = f(x-ct)$，表示初始剖面以速度 $c$ 进行纯平移。对于单个傅里叶模 $u(x,t) = \\exp(i(kx - \\omega t))$，精确的色散关系是 $\\omega = ck$，精确的阻尼率是 $\\sigma_{\\mathrm{exact}} = 0$。\n\n我们在具有间距 $h$ 和时间步长 $\\Delta t$ 的均匀网格上分析两种有限差分格式。\n\n**一阶迎风 (FOU) 格式**\n对于正平流速度 $c > 0$，空间上的迎风方向是向左。在时间上使用向前差分，在空间上使用向后差分，格式为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{h} = 0\n$$\n整理后得到问题陈述中的更新方程：\n$$\nu_j^{n+1} = u_j^n - \\lambda \\left(u_j^n - u_{j-1}^n\\right)\n$$\n其中 $\\lambda = c \\Delta t / h$ 是 Courant-Friedrichs-Lewy (CFL) 数。\n\n**二阶Lax–Wendroff (LW) 格式**\n该格式由时间上的二阶泰勒级数展开推导而来，由下式给出：\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\lambda^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right)\n$$\n\n**冯·诺依曼傅里叶分析**\n为了找到每种格式的数值特性，我们代入单个傅里叶模 $u_j^n = \\hat{u}^n \\exp(ikjh)$，其中 $k$ 是波数，$j$ 是空间索引。解通过复放大因子 $G$ 向前推进一个时间步，使得 $u_j^{n+1} = G u_j^n$。\n\n对于FOU格式，代入得到：\n$$\nG \\hat{u}^n e^{ikjh} = \\hat{u}^n e^{ikjh} - \\lambda \\left(\\hat{u}^n e^{ikjh} - \\hat{u}^n e^{ik(j-1)h}\\right)\n$$\n除以 $\\hat{u}^n e^{ikjh}$ 并引入无量纲相角 $\\theta = kh$：\n$$\nG_{\\mathrm{FOU}}(\\theta, \\lambda) = 1 - \\lambda(1 - e^{-i\\theta}) = 1 - \\lambda(1 - (\\cos\\theta - i\\sin\\theta))\n$$\n$$\nG_{\\mathrm{FOU}}(\\theta, \\lambda) = \\left(1 - \\lambda(1-\\cos\\theta)\\right) + i\\lambda\\sin\\theta\n$$\n注意虚部是正的，这在 $G = \\exp(-i\\omega_{\\mathrm{num}}\\Delta t)$ 的约定下是前向传播波所要求的。\n\n对于LW格式，代入得到：\n$$\nG = 1 - \\frac{\\lambda}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\lambda^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})\n$$\n使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$：\n$$\nG_{\\mathrm{LW}}(\\theta, \\lambda) = 1 - i\\lambda\\sin\\theta + \\lambda^2(\\cos\\theta - 1)\n$$\n$$\nG_{\\mathrm{LW}}(\\theta, \\lambda) = \\left(1 - \\lambda^2(1-\\cos\\theta)\\right) - i\\lambda\\sin\\theta\n$$\n\n**误差量化**\n复放大因子 $G$ 通过以下关系编码了数值阻尼率 $\\sigma_{\\mathrm{num}}$ 和数值频率 $\\omega_{\\mathrm{num}}$：\n$$\n|G| = e^{\\sigma_{\\mathrm{num}}\\Delta t} \\quad \\text{和} \\quad \\arg(G) = -\\omega_{\\mathrm{num}}\\Delta t\n$$\n从这些关系中，我们推导出数值特性：\n$$\n\\sigma_{\\mathrm{num}}(h) = \\frac{\\ln|G(kh, \\lambda)|}{\\Delta t} = \\frac{c}{\\lambda h}\\ln|G(kh, \\lambda)|\n$$\n$$\n\\omega_{\\mathrm{num}}(h) = -\\frac{\\arg(G(kh, \\lambda))}{\\Delta t} = -\\frac{c}{\\lambda h}\\arg(G(kh, \\lambda))\n$$\n数值相速度是 $c_{\\mathrm{num}} = \\omega_{\\mathrm{num}}/k$。误差则定义为：\n- 耗散误差：$E_{\\mathrm{diss}}(h) = |\\sigma_{\\mathrm{num}}(h) - \\sigma_{\\mathrm{exact}}| = |\\sigma_{\\mathrm{num}}(h)|$，因为 $\\sigma_{\\mathrm{exact}}=0$。\n- 色散误差：$E_{\\mathrm{disp}}(h) = |c_{\\mathrm{num}}(h) - c|$。\n\n**用于收敛阶的理查森外推**\n对于一个数值方法，其误差 $E(h)$ 表现为 $E(h) \\approx C h^p$（其中 $C$ 是某个常数，$p$ 是收敛阶），我们可以通过比较在两个不同网格 $h$ 和 $h/2$ 上的误差来估计 $p$：\n$$\nE(h) \\approx C h^p \\quad \\text{和} \\quad E(h/2) \\approx C (h/2)^p = C h^p / 2^p\n$$\n取其比值得到 $E(h)/E(h/2) \\approx 2^p$。解出 $p$ 即可得到问题中提供的公式：\n$$\np \\approx \\frac{\\log(E(h)/E(h/2))}{\\log(2)}\n$$\n对每种格式的 $E_{\\mathrm{disp}}$ 和 $E_{\\mathrm{diss}}$ 分别执行此计算，以找到它们各自的观测收敛阶 $p_{\\mathrm{disp}}$ 和 $p_{\\mathrm{diss}}$。实现将遍历给定的测试用例，为每个用例计算这四个阶数参数，并汇总结果。\n\n理论上，FOU格式在空间和时间上是一阶的，所以我们期望 $p_{\\mathrm{disp}} \\approx 1$ 和 $p_{\\mathrm{diss}} \\approx 1$。LW格式是二阶的，其主截断误差项与 $u_{xxx}$ 成正比，导致色散；更高阶项与 $u_{xxxx}$ 成正比，导致耗散。因此，我们期望 $p_{\\mathrm{disp}} \\approx 2$ 和 $p_{\\mathrm{diss}} \\approx 3$。所提供的测试用例探索了 $\\theta=kh$ 的不同范围，以检查这些理论阶数是否成立。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical diffusion and dispersion problem by implementing\n    Von Neumann analysis and Richardson extrapolation for two finite difference schemes.\n    \"\"\"\n\n    test_cases = [\n        # Test Case 1 (general case)\n        {'c': 1.7, 'lam': 0.65, 'k': 7.5, 'h1': 0.12, 'h2': 0.06},\n        # Test Case 2 (long-wave limit)\n        {'c': 1.7, 'lam': 0.65, 'k': 1.2, 'h1': 0.12, 'h2': 0.06},\n        # Test Case 3 (near-Nyquist challenge)\n        {'c': 1.7, 'lam': 0.65, 'k': 26.0, 'h1': 0.12, 'h2': 0.06},\n    ]\n\n    def calculate_errors(c, lam, k, h, scheme):\n        \"\"\"\n        Calculates the dispersive and dissipative errors for a given scheme and parameters.\n\n        Args:\n            c (float): Physical advection speed.\n            lam (float): CFL number.\n            k (float): Wavenumber.\n            h (float): Grid spacing.\n            scheme (str): 'upwind' or 'lw' (Lax-Wendroff).\n\n        Returns:\n            tuple: A tuple containing (E_disp, E_diss).\n        \"\"\"\n        theta = k * h\n        delta_t = lam * h / c\n\n        if scheme == 'upwind':\n            # G = 1 - lam * (1 - exp(-i*theta))\n            G = 1.0 - lam * (1.0 - np.exp(-1j * theta))\n        elif scheme == 'lw':\n            # G = 1 - lam^2*(1-cos(theta)) - i*lam*sin(theta)\n            G = 1.0 - lam**2 * (1.0 - np.cos(theta)) - 1j * lam * np.sin(theta)\n        else:\n            raise ValueError(\"Unknown scheme type\")\n\n        mag_G = np.abs(G)\n        arg_G = np.angle(G)\n\n        # Handle the case where mag_G is 0 or 1 to avoid log errors or division by zero.\n        if mag_G > 1e-15:\n            sigma_num = np.log(mag_G) / delta_t\n        else:\n            # If magnitude is zero, damping is effectively infinite.\n            # Using a large negative number.\n            sigma_num = -np.inf\n        \n        omega_num = -arg_G / delta_t\n        c_num = omega_num / k\n\n        E_disp = np.abs(c_num - c)\n        E_diss = np.abs(sigma_num)\n\n        return E_disp, E_diss\n\n    def calculate_p(E_h, E_h_half):\n        \"\"\"\n        Calculates the observed order of convergence p using Richardson extrapolation.\n        \"\"\"\n        # If the error at the finer grid is zero or negative (due to floating point),\n        # convergence order calculation is not meaningful.\n        if E_h_half == 0 or E_h == 0:\n            return np.nan # Not a number indicates failure to compute order.\n        \n        ratio = E_h / E_h_half\n        # If the ratio is == 1, it means the error is not decreasing,\n        # so the order is non-positive or undefined.\n        if ratio == 1.0:\n            return np.log2(ratio)\n\n        return np.log2(ratio)\n\n    results = []\n    for case in test_cases:\n        c, lam, k, h1, h2 = case['c'], case['lam'], case['k'], case['h1'], case['h2']\n\n        # Upwind Scheme\n        E_disp_up_h1, E_diss_up_h1 = calculate_errors(c, lam, k, h1, 'upwind')\n        E_disp_up_h2, E_diss_up_h2 = calculate_errors(c, lam, k, h2, 'upwind')\n        p_disp_up = calculate_p(E_disp_up_h1, E_disp_up_h2)\n        p_diss_up = calculate_p(E_diss_up_h1, E_diss_up_h2)\n\n        # Lax-Wendroff Scheme\n        E_disp_lw_h1, E_diss_lw_h1 = calculate_errors(c, lam, k, h1, 'lw')\n        E_disp_lw_h2, E_diss_lw_h2 = calculate_errors(c, lam, k, h2, 'lw')\n        p_disp_lw = calculate_p(E_disp_lw_h1, E_disp_lw_h2)\n        p_diss_lw = calculate_p(E_diss_lw_h1, E_diss_lw_h2)\n        \n        results.extend([p_disp_up, p_diss_up, p_disp_lw, p_diss_lw])\n\n    # Format output as a comma-separated list of floats within brackets.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "理论分析与实际计算结果的吻合是验证代码正确性的关键步骤。本练习将理论与实践相结合，要求你编写一个程序来模拟线性平流方程，并直接从仿真数据中测量数值频散和阻尼率。通过将测量结果与冯·诺依曼分析的理论预测进行比较，你将学会一套标准的验证与确认(VV)流程，这是确保计算模型可靠性的必备技能 。",
            "id": "4022200",
            "problem": "考虑定义在长度为 $ L $ 的周期性域上的一维线性平流方程 $ \\partial_t u + a \\, \\partial_x u = 0 $，该方程在一个包含 $ N_x $ 个点、间距为 $ \\Delta x = L/N_x $ 的均匀网格上进行离散化。对于 $ a > 0 $ 和离散时间步长 $ \\Delta t $，使用 Courant–Friedrichs–Lewy 数为 $ \\lambda = a \\Delta t / \\Delta x $ 的一阶迎风有限差分法，即更新规则为 $ u_i^{n+1} = u_i^n - \\lambda \\left( u_i^n - u_{i-1}^n \\right) $，并采用周期性索引。该格式在计算流体动力学以及计算聚变科学与工程中被广泛用于管理双曲输运问题中的数值耗散和数值色散，并且它提供了一个受控环境，用于对照 von Neumann 分析来验证数值色散和阻尼。\n\n您的任务是设计并实现一个完整、可运行的程序，该程序能够：\n\n1. 使用单个复傅里叶模式 $ u_i^0 = \\exp\\!\\left( i k x_i \\right) $ 初始化场，其中 $ k = 2\\pi m/L $，$ x_i = i \\Delta x $，并且 $ m \\in \\{0,1,\\dots,N_x-1\\} $ 是一个整数模式指数。\n2. 使用上述迎风格式将解在时间上推进 $ N_t $ 个时间步。\n3. 在每个时间步 $ n $，通过离散空间傅里叶投影 $ a_m^n = \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} u_i^n \\exp\\!\\left( - i k x_i \\right) $ 提取所选空间傅里叶模式 $ m $ 的复振幅。\n4. 根据时间序列 $ \\{ a_m^n \\}_{n=0}^{N_t-1} $，执行时间快速傅里叶变换（FFT）来估计该模式的数值角频率 $ \\omega_{\\text{num}}(k) $ 和数值增长（阻尼）率 $ \\gamma_{\\text{num}}(k) $：\n   - 定义离散角频率网格 $ \\omega_j = 2\\pi f_j $，其中 $ f_j $ 是以单位时间的周期数为单位、时间步长为 $ \\Delta t $ 的 FFT 频率。将 $ \\omega_{\\text{num}}(k) $ 确定为功率谱 $ P(\\omega) = | \\mathcal{F}[a_m^n](\\omega) |^2 $ 最大值所对应的角频率。\n   - 直接从时间谱中使用主导谱峰的半峰全宽（FWHM）来估计 $ \\gamma_{\\text{num}}(k) $，取 $ \\gamma_{\\text{num}}(k) = -\\frac{1}{2} \\text{FWHM} $。如果谱峰位于频率边界，以至于只有一个单侧半峰值交叉点可用，则通过将单侧半宽加倍来近似 $ \\text{FWHM} $。\n5. 对同一格式独立执行 von Neumann 稳定性和色散分析，以获得放大因子 $ G(k) $，并由此通过 $ \\omega_{\\text{vn}}(k) = -\\arg(G(k))/\\Delta t $ 和 $ \\gamma_{\\text{vn}}(k) = \\ln |G(k)| / \\Delta t $ 得到预测的角频率和增长率。\n6. 通过报告绝对差 $ |\\omega_{\\text{num}}(k) - \\omega_{\\text{vn}}(k)| $ 和 $ |\\gamma_{\\text{num}}(k) - \\gamma_{\\text{vn}}(k)| $，将您从时间 FFT 测得的 $ \\omega_{\\text{num}}(k) $ 和 $ \\gamma_{\\text{num}}(k) $ 与 von Neumann 预测的 $ \\omega_{\\text{vn}}(k) $ 和 $ \\gamma_{\\text{vn}}(k) $ 进行比较。\n\n假设使用无量纲单位，其中 $ a = 1 $（单位：长度/单位时间），因此角频率 $ \\omega $ 必须以弧度/单位时间表示，增长/阻尼率 $ \\gamma $ 必须以 1/单位时间表示。角度以弧度为单位。\n\n您的程序必须对所有测试使用以下通用固定参数：$ N_x = 256 $，$ L = 1 $，$ a = 1 $ 以及 $ N_t = 4096 $。使用下面列出的三元组 $ (\\lambda, m) $ 构建测试套件，这些三元组探测了不同的机制：\n- 一般情况：$ (\\lambda, m) = (0.5, 12) $。\n- 边界 Courant 数（当 $ k \\neq 0 $ 时无数值耗散）：$ (\\lambda, m) = (1.0, 20) $。\n- 接近奈奎斯特模式的高波数：$ (\\lambda, m) = (0.9, 128) $。\n\n对于每个测试用例，将第 $ 6 $ 项中描述的两个绝对差计算为浮点数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个双元素列表 $ [|\\omega_{\\text{num}}-\\omega_{\\text{vn}}|, |\\gamma_{\\text{num}}-\\gamma_{\\text{vn}}|] $。例如，输出格式必须为 $ [[d_{\\omega,1},d_{\\gamma,1}],[d_{\\omega,2},d_{\\gamma,2}],[d_{\\omega,3},d_{\\gamma,3}]] $，所有条目均采用上述指定单位。",
            "solution": "所述问题在科学上是合理的、自洽的且适定的。它展示了一个计算物理学中标准的验证与确认练习，特别是针对应用于双曲偏微分方程的数值方法。参数、初始条件、数值格式和分析方法都得到了清晰且正确的定义。未检测到任何缺陷、矛盾或歧义。因此，我们可以着手进行正式求解。\n\n求解过程包括两个并行的轨道：使用 von Neumann 方法的理论分析和直接数值模拟。然后对两者的结果进行比较。\n\n### 1. 理论分析：Von Neumann 色散与稳定性\n\n我们分析一阶迎风格式的数值特性，\n$$ u_i^{n+1} = u_i^n - \\lambda \\left( u_i^n - u_{i-1}^n \\right) $$\n其中 $\\lambda = a \\Delta t / \\Delta x$ 是 Courant 数。我们将单个傅里叶模式 ansatz（拟设）$u_i^n = \\hat{u}^n(k) e^{i k x_i}$ 代入格式中。振幅 $\\hat{u}^n(k)$ 预计将根据 $\\hat{u}^{n+1}(k) = G(k) \\hat{u}^n(k)$ 演化，其中 $G(k)$ 是复放大因子。\n\n代入 ansatz 并使用 $x_i = i \\Delta x$：\n$$ G(k) \\hat{u}^n(k) e^{i k i \\Delta x} = \\hat{u}^n(k) e^{i k i \\Delta x} - \\lambda \\left( \\hat{u}^n(k) e^{i k i \\Delta x} - \\hat{u}^n(k) e^{i k (i-1) \\Delta x} \\right) $$\n除以公因子 $\\hat{u}^n(k) e^{i k i \\Delta x}$：\n$$ G(k) = 1 - \\lambda \\left( 1 - e^{-i k \\Delta x} \\right) $$\n令 $\\tilde{k} = k \\Delta x$ 为归一化波数。放大因子为：\n$$ G(\\tilde{k}) = 1 - \\lambda (1 - e^{-i\\tilde{k}}) = (1 - \\lambda + \\lambda \\cos\\tilde{k}) + i (\\lambda \\sin\\tilde{k}) $$\n对于模式 $e^{ikx}$，平流方程 $\\partial_t u + a \\partial_x u = 0$ 的精确解是 $e^{ik(x-at)}$，其在一个时间步长 $\\Delta t$ 内的放大因子为 $G_{\\text{exact}} = e^{-i a k \\Delta t}$。数值格式会引入振幅误差（数值耗散）和相位误差（数值色散）。\n\n从放大因子 $G(k)$ 中，我们可以提取理论数值增长率 $\\gamma_{\\text{vn}}(k)$ 和角频率 $\\omega_{\\text{vn}}(k)$。一个时间步后，模式的振幅乘以 $|G(k)|$，其相位移动 $\\arg(G(k))$。问题明确定义了 $\\omega_{\\text{vn}}(k) = -\\arg(G(k)) / \\Delta t$ 和 $\\gamma_{\\text{vn}}(k) = \\ln|G(k)|/\\Delta t$。这意味着 $G(k) = |G(k)| e^{i \\arg(G(k))} = e^{\\ln|G(k)|} e^{i \\arg(G(k))} = e^{\\gamma_{\\text{vn}}\\Delta t} e^{-i \\omega_{\\text{vn}}\\Delta t} = e^{(\\gamma_{\\text{vn}} - i\\omega_{\\text{vn}})\\Delta t}$。我们将遵循这些定义。\n\n因此，von Neumann 预测为：\n$$ \\gamma_{\\text{vn}}(k) = \\frac{\\ln|G(k)|}{\\Delta t} $$\n$$ \\omega_{\\text{vn}}(k) = -\\frac{\\arg(G(k))}{\\Delta t} $$\n我们将为每个测试用例三元组 $(\\lambda, m)$ 计算这些值。\n\n### 2. 数值模拟与测量\n\n数值部分的核心是模拟单个纯傅里叶模式的演化，并分析其随时间的行为。\n\n**初始化：** 空间网格在长度为 $L=1$ 的域上包含 $N_x=256$ 个点，因此 $\\Delta x = L/N_x = 1/256$。初始条件是波数为 $k = 2 \\pi m / L$ 的单个复模式 $u_i^0 = \\exp(i k x_i)$。\n\n**时间演化：** 使用迎风格式将场 $u$ 推进 $N_t = 4096$ 步。在每一步 $n$，我们将解投影到初始傅里叶模式上以获得其复振幅：\n$$ a_m^n = \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} u_i^n \\exp(-i k x_i) $$\n这等效于场 $u^n$ 的离散傅里叶变换的第 $m$ 个分量。序列 $\\{a_m^n\\}_{n=0}^{N_t-1}$ 跟踪我们感兴趣的模式随时间的振幅和相位。对于一个理想的格式，我们应有 $a_m^n \\approx (G(k))^n$。\n\n**谱分析：** 我们对复数时间序列 $\\{a_m^n\\}$ 执行时间快速傅里叶变换（FFT）。离散时间步长为 $\\Delta t = \\lambda \\Delta x / a$。\n$$ \\mathcal{F}[a_m^n](\\omega_j) = \\sum_{n=0}^{N_t-1} a_m^n e^{-i \\omega_j n \\Delta t} $$\n得到的功率谱 $P(\\omega_j) = |\\mathcal{F}[a_m^n](\\omega_j)|^2$ 将呈尖峰状。\n\n**参数估计：**\n1.  **数值频率 $\\omega_{\\text{num}}(k)$**：这被确定为与功率谱 $P(\\omega_j)$ 的最大值相对应的角频率 $\\omega_j$。\n2.  **数值增长率 $\\gamma_{\\text{num}}(k)$**：这是根据谱峰的半峰全宽（FWHM）估算的。对于一个衰减指数信号（$e^{-\\gamma_0 t}$）的功率谱，其 FWHM 与衰减率 $\\gamma_0$ 之间的关系（对于洛伦兹峰）是 $\\text{FWHM} = 2\\gamma_0$。问题将估计值定义为 $\\gamma_{\\text{num}}(k) = -\\frac{1}{2}\\text{FWHM}$。负号正确地将宽度（一个正量）转换为阻尼率（一个负的增长率）。为了找到 FWHM，我们定位峰值，找到半峰值功率水平，然后在峰的两侧找到谱与该水平相交的频率。为保证准确性，我们使用离散频率点之间的线性插值。如果峰值位于频率边界（例如奈奎斯特频率），则找到单侧宽度并将其加倍，如问题所述。\n\n### 3. 比较\n\n最后，对于每个测试用例，计算理论预测值和数值测量值之间的绝对差：\n$$ d_\\omega = |\\omega_{\\text{num}}(k) - \\omega_{\\text{vn}}(k)| $$\n$$ d_\\gamma = |\\gamma_{\\text{num}}(k) - \\gamma_{\\text{vn}}(k)| $$\n这些差异量化了基于时间 FFT 的测量技术在恢复 von Neumann 分析所预测的属性方面的准确性。实现将精确遵循这些步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing numerical vs. theoretical dispersion and diffusion\n    for the 1D linear advection equation.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    N_x = 256\n    L = 1.0\n    a = 1.0\n    N_t = 4096\n    \n    # --- Test Suite ---\n    test_cases = [\n        (0.5, 12),   # General case\n        (1.0, 20),   # Boundary Courant number (exact translation)\n        (0.9, 128),  # High wavenumber (Nyquist mode)\n    ]\n\n    results = []\n\n    def _calculate_fwhm(omega_axis, power_spectrum):\n        \"\"\"\n        Calculates the Full Width at Half Maximum (FWHM) of a peak in a power spectrum.\n        Uses linear interpolation for sub-grid accuracy. Handles boundary peaks.\n        \"\"\"\n        if not np.any(power_spectrum):\n            return 0.0\n\n        peak_idx = np.argmax(power_spectrum)\n        peak_omega = omega_axis[peak_idx]\n        peak_power = power_spectrum[peak_idx]\n        \n        if peak_power == 0:\n            return 0.0\n\n        half_max_power = peak_power / 2.0\n\n        # --- Find left crossing ---\n        # Find indices of points to the left of the peak that are below half-max\n        left_indices = np.where(power_spectrum[:peak_idx]  half_max_power)[0]\n        omega_left = None\n        if left_indices.size > 0:\n            idx1 = left_indices[-1]\n            idx2 = idx1 + 1\n            if idx2  peak_idx + 1:\n                p1, p2 = power_spectrum[idx1], power_spectrum[idx2]\n                w1, w2 = omega_axis[idx1], omega_axis[idx2]\n                if (p2 - p1) != 0:\n                    omega_left = w1 + (w2 - w1) * (half_max_power - p1) / (p2 - p1)\n\n        # --- Find right crossing ---\n        # Find indices of points to the right of the peak that are below half-max\n        right_indices = np.where(power_spectrum[peak_idx + 1:]  half_max_power)[0]\n        omega_right = None\n        if right_indices.size > 0:\n            idx2 = right_indices[0] + peak_idx + 1\n            idx1 = idx2 - 1\n            if idx1 > peak_idx - 1:\n                p1, p2 = power_spectrum[idx1], power_spectrum[idx2]\n                w1, w2 = omega_axis[idx1], omega_axis[idx2]\n                if (p2 - p1) != 0:\n                    omega_right = w1 + (w2 - w1) * (half_max_power - p1) / (p2 - p1)\n        \n        # --- Calculate FWHM based on available crossings ---\n        if omega_left is not None and omega_right is not None:\n            return omega_right - omega_left\n        elif omega_left is not None: # Right crossing not found (peak at boundary)\n            return 2 * (peak_omega - omega_left)\n        elif omega_right is not None: # Left crossing not found (peak at boundary)\n            return 2 * (omega_right - peak_omega)\n        else: # No crossings found (e.g., a single delta-function-like peak)\n            return 0.0\n\n    for lam, m in test_cases:\n        # --- Derived Parameters ---\n        delta_x = L / N_x\n        delta_t = lam * delta_x / a\n        k = 2 * np.pi * m / L\n\n        # --- 1. Theoretical (von Neumann) Analysis ---\n        k_tilde = k * delta_x\n        # Amplification factor G = 1 - lambda * (1 - exp(-i*k_tilde))\n        G = 1.0 - lam * (1.0 - np.exp(-1j * k_tilde))\n        \n        # Theoretical growth rate and angular frequency\n        gamma_vn = np.log(np.abs(G)) / delta_t\n        omega_vn = -np.angle(G) / delta_t\n\n        # --- 2. Numerical Simulation ---\n        # Initialize field u with a single Fourier mode\n        x_grid = np.arange(N_x) * delta_x\n        u = np.exp(1j * k * x_grid)\n        \n        a_m_series = np.zeros(N_t, dtype=np.complex128)\n\n        # Time evolution loop\n        for n in range(N_t):\n            # Project onto the mode m to get its amplitude\n            # This is equivalent to the m-th component of the un-normalized FFT divided by N_x\n            a_m_series[n] = np.fft.fft(u)[m] / N_x\n            \n            # Update u using first-order upwind scheme with periodic boundaries\n            u_prev = np.roll(u, 1)\n            u = u - lam * (u - u_prev)\n            \n        # --- 3. Numerical Measurement from Simulation ---\n        # Temporal FFT of the modal amplitude time series\n        temporal_freqs = np.fft.fftfreq(N_t, d=delta_t)\n        temporal_omega = 2 * np.pi * temporal_freqs\n        \n        spectrum = np.fft.fft(a_m_series)\n        power_spectrum = np.abs(spectrum)**2\n\n        # For FWHM calculation, it's easier to work with a shifted spectrum\n        shifted_omega = np.fft.fftshift(temporal_omega)\n        shifted_power = np.fft.fftshift(power_spectrum)\n\n        # Find numerical frequency from the peak of the power spectrum\n        peak_idx = np.argmax(power_spectrum)\n        omega_num = temporal_omega[peak_idx]\n\n        # Estimate numerical growth rate from FWHM of the spectral peak\n        fwhm = _calculate_fwhm(shifted_omega, shifted_power)\n        gamma_num = -0.5 * fwhm\n\n        # --- 4. Comparison ---\n        diff_omega = np.abs(omega_num - omega_vn)\n        diff_gamma = np.abs(gamma_num - gamma_vn)\n        \n        results.append([diff_omega, diff_gamma])\n\n    # --- Final Output Formatting ---\n    # Create the final string in the format [[d_w1, d_g1],[d_w2, d_g2],...]\n    result_strings = [f\"[{r[0]},{r[1]}]\" for r in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "理解数值误差的最终目的是为了控制它。本练习引导你从误差分析走向算法设计，通过推导控制数值相位和振幅误差的输运方程，来建立误差累积的模型。基于此模型，你将设计出自适应的时间步长 $\\Delta t$ 和网格间距 $\\Delta x$ 的准则，以在满足给定精度容差的同时最小化计算成本，这体现了计算科学中理论指导实践的核心思想 。",
            "id": "4022261",
            "problem": "考虑一维线性平流方程 $\\,\\partial_t u + c\\,\\partial_x u = 0\\,$，其中被动标量 $\\,u(x,t)\\,$ 表示在聚变边缘通道中沿直线磁场的平行输运，具有恒定的平流速度 $\\,c0\\,$ 和长度为 $\\,L0\\,$ 的周期性区域。假设一个波数为 $\\,k0\\,$ 的单一傅里叶模式 $\\,u(x,0) = \\Re\\{ \\hat{u}_0 \\exp(i k x) \\}\\,$。数值解在间距为 $\\,\\Delta x\\,$ 的均匀网格上使用二阶Lax–Wendroff有限差分格式和显式时间步长 $\\,\\Delta t\\,$ 进行推进，并定义Courant–Friedrichs–Lewy (CFL) 数 $\\,\\alpha = c\\,\\Delta t / \\Delta x\\,$，其中 $\\,0\\alpha1\\,$。对于关注的最高波数 $\\,k\\,$，假设 $\\,k\\,\\Delta x \\ll 1\\,$。\n\n从von Neumann傅里叶模式分析的基本原理（线性格式的放大因子）和连续平流方程的精确放大因子出发，推导出一阶小 $\\,k\\,\\Delta x\\,$ 误差输运方程，这些方程分别控制傅里叶模式的数值相位误差和数值振幅误差。将这些输运方程解释为对相速度的有效色散修正和对振幅的有效超粘性阻尼，分别表示为乘以 $\\,\\partial_x^3 u\\,$ 和 $\\,\\partial_x^4 u\\,$ 的系数。使用这些输运方程为时间步长 $\\,\\Delta t\\,$ 和网格间距 $\\,\\Delta x\\,$ 设计自适应准则，以在模式 $\\,k\\,$ 的一个区域穿越时间 $\\,T = L/c\\,$ 内同时满足以下容差：\n- 累积相位漂移的大小受限于一个给定的容差 $\\,\\epsilon_\\phi\\,$（单位为弧度）。\n- 累积相对振幅衰减受限于一个给定的容差 $\\,\\epsilon_A\\,$（无量纲）。\n\n将容差视为小量，并要求领先阶贡献同时达到两个界限的饱和，以最小化计算成本。将 $\\,\\Delta t\\,$ 和 $\\,\\Delta x\\,$ 的最终公式表示为关于 $\\,c\\,$, $\\,k\\,$, $\\,L\\,$, $\\,\\epsilon_A\\,$ 和 $\\,\\epsilon_\\phi\\,$ 的闭式解析表达式。以秒为单位提供 $\\,\\Delta t\\,$，以米为单位提供 $\\,\\Delta x\\,$。不需要进行数值计算。",
            "solution": "我们从线性平流的基本表示 $\\,\\partial_t u + c\\,\\partial_x u = 0\\,$ 开始，其对于 $\\,u(x,t) = \\hat{u}(t)\\,\\exp(i k x)\\,$ 的精确傅里叶模式解为 $\\,\\hat{u}(t) = \\hat{u}_0 \\exp(-i\\,\\omega\\,t)\\,$，具有精确色散关系 $\\,\\omega_{\\text{exact}} = c\\,k\\,$ 且振幅守恒。在一个时间步长 $\\,\\Delta t\\,$ 内的单步精确放大因子为 $\\,E = \\exp(-i\\,\\omega_{\\text{exact}}\\,\\Delta t) = \\exp(-i\\,\\alpha\\,\\kappa)\\,$，其中我们引入了无量纲波数 $\\,\\kappa = k\\,\\Delta x\\,$ 和Courant数 $\\,\\alpha = c\\,\\Delta t / \\Delta x\\,$。\n\n对于均匀网格上线性平流的Lax–Wendroff离散格式，在时间层 $\\,t^n\\,$ 的网格值 $\\,u_j^n\\,$ 的更新公式为\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{\\alpha}{2}\\,\\big(u_{j+1}^n - u_{j-1}^n\\big) \\;+\\; \\frac{\\alpha^2}{2}\\,\\big(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\big).\n$$\n应用von Neumann分析，代入傅里叶假设 $\\,u_j^n = \\hat{u}^n \\exp(i j \\kappa)\\,$，得到数值放大因子\n$$\nG(\\kappa) \\;=\\; 1 \\;-\\; i\\,\\alpha\\,\\sin\\kappa \\;+\\; \\alpha^2\\,(\\cos\\kappa - 1).\n$$\n我们通过对小 $\\,\\kappa\\,$ 展开 $\\,G(\\kappa)\\,$ 和精确放大因子 $\\,E(\\kappa) = \\exp(-i \\alpha \\kappa)\\,$ 来进行比较。使用 $\\,\\sin\\kappa = \\kappa - \\kappa^3/6 + \\kappa^5/120 + \\mathcal{O}(\\kappa^7)\\,$ 和 $\\,\\cos\\kappa = 1 - \\kappa^2/2 + \\kappa^4/24 + \\mathcal{O}(\\kappa^6)\\,$，我们得到\n\n$$\n\\begin{aligned}\nG(\\kappa) \\,=\\, 1 \\;-\\; i\\,\\alpha\\,\\kappa \\;-\\; \\frac{\\alpha^2}{2}\\,\\kappa^2 \\;+\\; i\\,\\frac{\\alpha}{6}\\,\\kappa^3 \\;+\\; \\frac{\\alpha^2}{24}\\,\\kappa^4 \\;-\\; i\\,\\frac{\\alpha}{120}\\,\\kappa^5 \\;+\\; \\mathcal{O}(\\kappa^6),\\\\\nE(\\kappa) \\,=\\, 1 \\;-\\; i\\,\\alpha\\,\\kappa \\;-\\; \\frac{\\alpha^2}{2}\\,\\kappa^2 \\;+\\; i\\,\\frac{\\alpha^3}{6}\\,\\kappa^3 \\;+\\; \\frac{\\alpha^4}{24}\\,\\kappa^4 \\;-\\; i\\,\\frac{\\alpha^5}{120}\\,\\kappa^5 \\;+\\; \\mathcal{O}(\\kappa^6).\n\\end{aligned}\n$$\n\n在 $\\,\\kappa^3\\,$ 阶，虚部的领先阶差异表示色散相位误差，每步的相位增量误差为\n$$\n\\Delta \\phi_{\\text{step}} \\;=\\; \\frac{(\\alpha - \\alpha^3)}{6}\\,\\kappa^3 \\;+\\; \\mathcal{O}(\\kappa^5).\n$$\n实部的领先阶差异影响振幅；等效地，计算模 $\\,|G|\\,$，我们发现（使用 $\\,|G|^2 = \\big(1 + \\alpha^2(\\cos\\kappa - 1)\\big)^2 + \\alpha^2\\sin^2\\kappa\\,$ 并展开到 $\\,\\mathcal{O}(\\kappa^4)\\,$ 阶）\n$$\n|G|^2 \\;=\\; 1 \\;+\\; \\frac{\\alpha^2(\\alpha^2 - 1)}{4}\\,\\kappa^4 \\;+\\; \\mathcal{O}(\\kappa^6).\n$$\n对于小误差，$\\,|G| \\approx 1 + \\frac{1}{2}\\frac{\\alpha^2(\\alpha^2 - 1)}{4}\\,\\kappa^4$。这似乎与振幅变化不符。让我们直接从 $|G|^2$ 推导。$\\ln|G| = \\frac{1}{2}\\ln|G|^2 \\approx \\frac{1}{2}\\ln(1+X) \\approx \\frac{X}{2}$ for small X. 因此，\n$$\n\\ln|G| \\approx \\frac{\\alpha^2(\\alpha^2 - 1)}{8}\\,\\kappa^4.\n$$\n因此，每步的相对振幅变化为\n$$\n\\Delta A_{\\text{step}}/A = \\ln|G| \\approx \\frac{\\alpha^2(\\alpha^2 - 1)}{8}\\,\\kappa^4 \\;+\\; \\mathcal{O}(\\kappa^6),\n$$\n对于 $\\,0\\alpha1\\,$，该值为负，对应于弱阻尼。\n\n为了将这些误差解释为时间上连续的输运，我们引入一个修正方程框架，在该框架中，数值格式近似为\n$$\n\\partial_t u \\;+\\; c\\,\\partial_x u \\;=\\; -\\,\\nu_4\\,\\partial_x^4 u \\;-\\; \\sigma\\,\\partial_x^3 u,\n$$\n其中 $\\,\\sigma\\,$ 是实色散系数，$\\,\\nu_40\\,$ 是实超粘性系数。对于一个傅里叶模式 $\\,u \\propto \\exp(i k x)\\,$，我们有 $\\,\\partial_x^3 u = i^3 k^3 u = -\\,i\\,k^3 u\\,$ 和 $\\,\\partial_x^4 u = k^4 u\\,$，这意味着振幅和相位的演化如下\n\n$$\n\\begin{aligned}\n\\text{相位:}\\quad  \\omega_{\\text{num}} \\;=\\; c\\,k \\;+\\; \\sigma\\,k^3, \\\\\n\\text{振幅:}\\quad  \\frac{dA}{dt} \\;=\\; -\\,\\nu_4\\,k^4\\,A.\n\\end{aligned}\n$$\n\n将每步误差与一个时间步长 $\\,\\Delta t\\,$ 内的修正方程相匹配，得到\n\n$$\n\\begin{aligned}\n\\sigma\\,k^3\\,\\Delta t \\;=\\; \\frac{(\\alpha - \\alpha^3)}{6}\\,(k\\,\\Delta x)^3 \\quad \\Rightarrow \\quad \\sigma \\;=\\; \\frac{c\\,\\Delta x^2}{6}\\,\\big(1 - \\alpha^2\\big),\\\\\n\\nu_4\\,k^4\\,\\Delta t \\;=\\; -\\,\\frac{\\alpha^2(\\alpha^2 - 1)}{8}\\,(k\\,\\Delta x)^4 \\quad \\Rightarrow \\quad \\nu_4 \\;=\\; \\frac{c^2\\,\\Delta t\\,\\Delta x^2}{8}\\,\\big(1 - \\alpha^2\\big),\n\\end{aligned}\n$$\n\n这里我们使用了 $\\,\\alpha = c\\,\\Delta t / \\Delta x\\,$ 且 $\\,0\\alpha1\\,$，因此 $\\,1 - \\alpha^20\\,$。\n\n这些是领先阶误差输运系数。在区域穿越时间 $\\,T = L/c\\,$ 内，累积相位漂移的大小为\n$$\n|\\Delta \\phi| \\;\\approx\\; \\sigma\\,k^3\\,T \\;=\\; \\frac{c\\,\\Delta x^2}{6}\\,\\big(1 - \\alpha^2\\big)\\,k^3\\,\\frac{L}{c} \\;=\\; \\frac{\\Delta x^2}{6}\\,\\big(1 - \\alpha^2\\big)\\,k^3\\,L,\n$$\n累积相对振幅衰减为\n$$\n1 - \\frac{A(T)}{A(0)} \\;\\approx\\; 1 - \\exp\\big(-\\nu_4\\,k^4\\,T\\big) \\;\\approx\\; \\nu_4\\,k^4\\,T \\;=\\; \\frac{c^2\\,\\Delta t\\,\\Delta x^2}{8}\\,\\big(1 - \\alpha^2\\big)\\,k^4\\,\\frac{L}{c} \\;=\\; \\frac{c\\,\\Delta t\\,\\Delta x^2}{8}\\,\\big(1 - \\alpha^2\\big)\\,k^4\\,L,\n$$\n这里我们使用了小容差假设来线性化指数函数。\n\n在领先阶上施加容差 $\\,|\\Delta \\phi| \\le \\epsilon_\\phi\\,$ 和 $\\,\\nu_4\\,k^4\\,T \\le \\epsilon_A\\,$，并选择同时使两个界限饱和（以最小化计算成本），我们强制执行等式\n\n$$\n\\begin{aligned}\n\\frac{\\Delta x^2}{6}\\,\\big(1 - \\alpha^2\\big)\\,k^3\\,L \\;=\\; \\epsilon_\\phi,\\\\\n\\frac{c\\,\\Delta t\\,\\Delta x^2}{8}\\,\\big(1 - \\alpha^2\\big)\\,k^4\\,L \\;=\\; \\epsilon_A.\n\\end{aligned}\n$$\n\n引入共同因子 $\\,P = \\big(1 - \\alpha^2\\big)\\,\\Delta x^2\\,$。这两个方程变为\n\n$$\n\\begin{aligned}\n\\frac{P}{6}\\,k^3\\,L \\;=\\; \\epsilon_\\phi \\quad \\Rightarrow \\quad P \\;=\\; \\frac{6\\,\\epsilon_\\phi}{k^3\\,L},\\\\\n\\frac{c\\,\\Delta t\\,P}{8}\\,k^4\\,L \\;=\\; \\epsilon_A \\quad \\Rightarrow \\quad \\Delta t \\;=\\; \\frac{8\\,\\epsilon_A}{c\\,k^4\\,L}\\,\\frac{1}{P}.\n\\end{aligned}\n$$\n\n消去 $\\,P\\,$ 得到\n$$\n\\Delta t \\;=\\; \\frac{8\\,\\epsilon_A}{c\\,k^4\\,L}\\,\\frac{k^3\\,L}{6\\,\\epsilon_\\phi} \\;=\\; \\frac{4}{3}\\,\\frac{\\epsilon_A}{\\epsilon_\\phi}\\,\\frac{1}{c\\,k}.\n$$\n接下来，从 $\\,P = \\Delta x^2 - c^2\\,\\Delta t^2\\,$ 中恢复 $\\,\\Delta x\\,$，因为 $\\,P = (1 - \\alpha^2)\\,\\Delta x^2 = \\Delta x^2 - \\alpha^2\\,\\Delta x^2 = \\Delta x^2 - c^2\\,\\Delta t^2\\,$。使用 $\\,P = 6\\,\\epsilon_\\phi/(k^3\\,L)\\,$ 和上面求得的 $\\,\\Delta t\\,$，\n\n$$\n\\begin{aligned}\n\\Delta x^2 \\;=\\; P + c^2\\,\\Delta t^2 \\;=\\; \\frac{6\\,\\epsilon_\\phi}{k^3\\,L} \\;+\\; c^2\\,\\left(\\frac{4}{3}\\,\\frac{\\epsilon_A}{\\epsilon_\\phi}\\,\\frac{1}{c\\,k}\\right)^2 \\;=\\; \\frac{6\\,\\epsilon_\\phi}{k^3\\,L} \\;+\\; \\frac{16}{9}\\,\\frac{\\epsilon_A^2}{\\epsilon_\\phi^2}\\,\\frac{1}{k^2}.\n\\end{aligned}\n$$\n\n因此，\n$$\n\\Delta x \\;=\\; \\sqrt{\\,\\frac{16}{9}\\,\\frac{\\epsilon_A^2}{\\epsilon_\\phi^2}\\,\\frac{1}{k^2} \\;+\\; \\frac{6\\,\\epsilon_\\phi}{k^3\\,L}\\,}.\n$$\n\n这些闭式表达式给出了一个自适应配对 $\\,(\\Delta t,\\Delta x)\\,$，它在指定的容差下，在一个区域穿越时间 $\\,T=L/c\\,$ 内，共同控制模式 $\\,k\\,$ 的色散相位漂移和超粘性振幅阻尼。只要容差满足 $\\,\\alpha = c\\,\\Delta t/\\Delta x  1\\,$，它们就与 $\\,0\\alpha1\\,$ 一致，这在实际的聚变计算中，对于足够小的 $\\,\\epsilon_A\\,$ 和 $\\,\\epsilon_\\phi\\,$ 是可以保证的。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\dfrac{4}{3}\\,\\dfrac{\\epsilon_A}{\\epsilon_\\phi}\\,\\dfrac{1}{c\\,k}  \\sqrt{\\,\\dfrac{16}{9}\\,\\dfrac{\\epsilon_A^2}{\\epsilon_\\phi^2}\\,\\dfrac{1}{k^2} \\;+\\; \\dfrac{6\\,\\epsilon_\\phi}{k^3\\,L}\\,} \\end{pmatrix}}$$"
        }
    ]
}