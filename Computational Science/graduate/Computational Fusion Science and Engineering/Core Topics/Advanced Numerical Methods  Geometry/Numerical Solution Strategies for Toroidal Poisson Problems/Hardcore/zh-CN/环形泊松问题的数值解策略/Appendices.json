{
    "hands_on_practices": [
        {
            "introduction": "数值求解复杂偏微分方程的第一步通常是将其简化。在本练习中，我们将利用聚变研究中的常用技术——大环径比近似和傅里叶分析，将环几何中的三维泊松方程转化为一组更易于处理的一维常微分方程。这项实践对于开发谱方法和半谱方法求解器至关重要。",
            "id": "4024013",
            "problem": "考虑一个大环径比托卡马克中的静电势，其模型为同心圆环。使用正交环坐标 $(r,\\theta,\\phi)$，其中 $r \\in [0,a]$ 是小半径，$\\theta \\in [0,2\\pi)$ 是极向角，$\\phi \\in [0,2\\pi)$ 是环向角。假设磁通量面为同心圆，由 $R(r,\\theta) = R_0 + r \\cos\\theta$ 和 $Z(r,\\theta) = r \\sin\\theta$ 给出，其中 $R_0 \\gg a$ 是大半径，$a$ 是小半径。线元为 $ds^2 = dr^2 + r^2 d\\theta^2 + (R_0 + r \\cos\\theta)^2 d\\phi^2$。静电势 $\\Phi(r,\\theta,\\phi)$ 满足泊松方程 $- \\nabla^2 \\Phi = S(r,\\theta,\\phi)$，其中 $S$ 是在 $\\theta$ 和 $\\phi$ 上光滑、平方可积的双周期源项。在 $r=0$ 处施加正则性条件，并在 $r=a$ 处施加理想导电壁条件，即 $\\Phi(a,\\theta,\\phi)=0$。\n\n从拉普拉斯算子在正交坐标系下使用标度因子 $h_r$、$h_\\theta$、$h_\\phi$ 的曲线坐标定义出发，\n$$\n\\nabla^2 \\Phi = \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial r}\\!\\left(\\frac{h_\\theta h_\\phi}{h_r}\\,\\frac{\\partial \\Phi}{\\partial r}\\right)\n+ \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\theta}\\!\\left(\\frac{h_r h_\\phi}{h_\\theta}\\,\\frac{\\partial \\Phi}{\\partial \\theta}\\right)\n+ \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\phi}\\!\\left(\\frac{h_r h_\\theta}{h_\\phi}\\,\\frac{\\partial \\Phi}{\\partial \\phi}\\right).\n$$\n对于同心圆环，标度因子为 $h_r=1$、$h_\\theta=r$ 和 $h_\\phi=R_0 + r \\cos\\theta$。将 $\\Phi$ 和 $S$ 在角度上展开为双傅里叶级数，\n$$\n\\Phi(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} R_{mn}(r)\\,\\exp\\!\\big(i m \\theta\\big)\\,\\exp\\!\\big(i n \\phi\\big), \n\\qquad\nS(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} S_{mn}(r)\\,\\exp\\!\\big(i m \\theta\\big)\\,\\exp\\!\\big(i n \\phi\\big),\n$$\n并采用大环径比近似，取 $\\epsilon = a/R_0 \\ll 1$ 的一阶主导项，使得度规中依赖于 $\\theta$ 的系数可以用它们在 $R_0$ 中的一阶主导常数值替换。在此近似下，进行变量分离，推导出每个模式 $(m,n)$ 的解耦径向常微分方程，并将其重写为守恒自伴形式和一种除以 $r$ 的形式，后者便于在 $r \\in [0,a]$上进行逐模式的数值离散化。\n\n最后，识别出在除以 $r$ 的方程中乘以 $R_{mn}(r)$ 的有效径向波数平方函数 $k_{mn}^2(r)$，\n$$\n-\\,\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + k_{mn}^2(r)\\,R_{mn}(r) = S_{mn}(r),\n$$\n并提供 $k_{mn}^2(r)$ 作为 $r$、$m$、$n$ 和 $R_0$ 的显式符号函数。\n\n将你的最终答案表示为 $k_{mn}^2(r)$ 的显式表达式，不带单位。最终答案中不要包含任何中间方程。",
            "solution": "该问题需经过验证。\n\n### 步骤 1：提取给定信息\n- **系统**：大环径比托卡马克中的静电势 $\\Phi$。\n- **坐标**：正交环坐标 $(r,\\theta,\\phi)$，其中 $r \\in [0,a]$，$\\theta \\in [0,2\\pi)$，$\\phi \\in [0,2\\pi)$。\n- **几何**：$R(r,\\theta) = R_0 + r \\cos\\theta$，$Z(r,\\theta) = r \\sin\\theta$，其中大半径 $R_0 \\gg a$（小半径）。\n- **线元**：$ds^2 = dr^2 + r^2 d\\theta^2 + (R_0 + r \\cos\\theta)^2 d\\phi^2$。\n- **标度因子**：$h_r=1$，$h_\\theta=r$，$h_\\phi=R_0 + r \\cos\\theta$。\n- **控制方程**：$-\\nabla^2 \\Phi = S(r,\\theta,\\phi)$，其中 $S$ 是一个光滑、平方可积的双周期源。\n- **边界条件**：在 $r=0$ 处正则，且 $\\Phi(a,\\theta,\\phi)=0$。\n- **拉普拉斯算子形式**：$\\nabla^2 \\Phi = \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial r}\\!\\left(\\frac{h_\\theta h_\\phi}{h_r}\\,\\frac{\\partial \\Phi}{\\partial r}\\right) + \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\theta}\\!\\left(\\frac{h_r h_\\phi}{h_\\theta}\\,\\frac{\\partial \\Phi}{\\partial \\theta}\\right) + \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\phi}\\!\\left(\\frac{h_r h_\\theta}{h_\\phi}\\,\\frac{\\partial \\Phi}{\\partial \\phi}\\right)$。\n- **傅里叶展开**：$\\Phi(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} R_{mn}(r)\\,\\exp(i m \\theta)\\,\\exp(i n \\phi)$ 和 $S(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} S_{mn}(r)\\,\\exp(i m \\theta)\\,\\exp(i n \\phi)$。\n- **近似**：“采用大环径比近似，取 $\\epsilon = a/R_0 \\ll 1$ 的一阶主导项，使得度规中依赖于 $\\theta$ 的系数可以用它们在 $R_0$ 中的一阶主导常数值替换。”\n- **最终目标**：求径向常微分方程 $-\\,\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + k_{mn}^2(r)\\,R_{mn}(r) = S_{mn}(r)$ 中的函数 $k_{mn}^2(r)$。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，植根于托卡马克中等离子体约束的标准数学物理。简化环坐标系、泊松方程、傅里叶分析以及大环径比近似的使用都是该领域中标准且成熟的方法。该问题是适定的，提供了明确的控制方程、边界条件和具体、定义明确的近似方案。所有必要信息均已提供，且无内部矛盾。该任务是计算物理学中一个不平凡但标准的推导。\n\n### 步骤 3：结论与行动\n该问题有效。将推导严谨的解。\n\n求解过程首先将指定的近似应用于拉普拉斯算子，然后使用提供的傅里叶级数进行变量分离，最后重新整理得到的常微分方程以识别所要求的项。\n\n给定环坐标系的标度因子为 $h_r=1$，$h_\\theta=r$ 和 $h_\\phi = R_0 + r \\cos\\theta$。体积元为 $J = h_r h_\\theta h_\\phi = r(R_0 + r \\cos\\theta)$。拉普拉斯算子由下式给出：\n$$\n\\nabla^2 \\Phi = \\frac{1}{r(R_0 + r \\cos\\theta)} \\left[ \\frac{\\partial}{\\partial r}\\left( r(R_0 + r \\cos\\theta) \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{\\partial}{\\partial \\theta}\\left( \\frac{R_0 + r \\cos\\theta}{r} \\frac{\\partial\\Phi}{\\partial \\theta} \\right) + \\frac{\\partial}{\\partial \\phi}\\left( \\frac{r}{R_0 + r \\cos\\theta} \\frac{\\partial\\Phi}{\\partial \\phi} \\right) \\right]\n$$\n问题指定了大环径比近似，即“度规中依赖于 $\\theta$ 的系数可以用它们在 $R_0$ 中的一阶主导常数值替换”。唯一这样的系数是标度因子 $h_\\phi$，它依赖于 $\\theta$。由于 $r \\le a$ 且 $a/R_0 \\ll 1$，我们有 $r/R_0 \\ll 1$。$h_\\phi = R_0 + r \\cos\\theta$ 的一阶主导常数值是 $R_0$。\n因此，我们将 $R_0 + r \\cos\\theta \\approx R_0$ 代入拉普拉斯算子的系数中。这一简化至关重要，因为它消除了度规分量中对 $\\theta$ 的显式依赖，从而使得傅里叶模式能够解耦。\n\n近似的拉普拉斯算子，记作 $\\nabla_{approx}^2$，变为：\n$$\n\\nabla_{approx}^2 \\Phi = \\frac{1}{r R_0} \\left[ \\frac{\\partial}{\\partial r}\\left( r R_0 \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{\\partial}{\\partial \\theta}\\left( \\frac{R_0}{r} \\frac{\\partial\\Phi}{\\partial \\theta} \\right) + \\frac{\\partial}{\\partial \\phi}\\left( \\frac{r}{R_0} \\frac{\\partial\\Phi}{\\partial \\phi} \\right) \\right]\n$$\n括号内前两项分子中的 $R_0$ 与整体前因子中的 $R_0$ 相消：\n$$\n\\nabla_{approx}^2 \\Phi = \\frac{1}{r} \\frac{\\partial}{\\partial r}\\left( r \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2\\Phi}{\\partial \\theta^2} + \\frac{1}{R_0^2} \\frac{\\partial^2\\Phi}{\\partial \\phi^2}\n$$\n这是柱坐标 $(r, \\theta, z)$ 下的拉普拉斯算子，其中坐标 $z$ 被弧长坐标 $R_0\\phi$ 替换。\n\n现在，我们将 $\\Phi$ 和 $S$ 的傅里叶级数展开式代入泊松方程 $-\\nabla_{approx}^2 \\Phi = S$：\n$$\n-\\sum_{m,n} \\left[ \\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\frac{1}{r^2} (im)^2 R_{mn} + \\frac{1}{R_0^2} (in)^2 R_{mn} \\right] e^{im\\theta} e^{in\\phi} = \\sum_{m,n} S_{mn}(r) e^{im\\theta} e^{in\\phi}\n$$\n角向导数已被其在傅里叶模式上的相应作用所取代：$\\frac{\\partial^2}{\\partial \\theta^2} \\to -m^2$ 和 $\\frac{\\partial^2}{\\partial \\phi^2} \\to -n^2$。\n\n基函数 $e^{im\\theta} e^{in\\phi}$ 是正交的。因此，我们可以独立地对每个模式 $(m, n)$ 的系数进行等式匹配：\n$$\n-\\left[ \\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) - \\frac{m^2}{r^2} R_{mn}(r) - \\frac{n^2}{R_0^2} R_{mn}(r) \\right] = S_{mn}(r)\n$$\n将负号分配到左侧，我们得到模式振幅 $R_{mn}(r)$ 的解耦径向常微分方程：\n$$\n-\\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\frac{m^2}{r^2} R_{mn}(r) + \\frac{n^2}{R_0^2} R_{mn}(r) = S_{mn}(r)\n$$\n该方程可以通过乘以 $r$ 写成“守恒自伴形式”：\n$$\n-\\frac{d}{dr}\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + \\left(\\frac{m^2}{r} + \\frac{n^2 r}{R_0^2}\\right) R_{mn}(r) = rS_{mn}(r)\n$$\n然而，问题要求从“除以 $r$”的形式中识别出项 $k_{mn}^2(r)$：\n$$\n-\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + k_{mn}^2(r)\\,R_{mn}(r) = S_{mn}(r)\n$$\n通过组合我们推导出的方程中乘以 $R_{mn}(r)$ 的项，我们得到：\n$$\n-\\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\left( \\frac{m^2}{r^2} + \\frac{n^2}{R_0^2} \\right) R_{mn}(r) = S_{mn}(r)\n$$\n将此方程与目标形式直接比较，即可得出有效径向波数平方 $k_{mn}^2(r)$ 的表达式。该项包含取决于小半径 $r$ 的极向贡献和在此近似下不随 $r$ 变化的环向贡献。\n$$\nk_{mn}^2(r) = \\frac{m^2}{r^2} + \\frac{n^2}{R_0^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{m^2}{r^2} + \\frac{n^2}{R_0^2}}\n$$"
        },
        {
            "introduction": "当我们在数值网格上离散化导出的方程时，常常会遇到坐标奇点这样的数学难题。本练习聚焦于磁轴（$r=0$）处，一个朴素的拉普拉斯算子离散格式会在此处失效。你将学习如何结合物理正则性条件和严谨的数学分析，推导出一个自洽且精确的数值格式。",
            "id": "4023945",
            "problem": "在计算聚变科学与工程中，诸如托卡马克（tokamak）的环形位形具有一根磁轴，在该磁轴周围，磁通面在局部极向截面中近似为圆形。考虑在磁轴附近的极向平面中，一个光滑轴对称势 $\\phi$ 的静电泊松方程，用极坐标 $r$ 和 $\\theta$ 写为\n$$\n\\nabla^2 \\phi = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial \\phi}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 \\phi}{\\partial \\theta^2} = s(r),\n$$\n其中 $s(r)$ 是一个给定的光滑源项。对于磁轴附近的轴对称情况，假设 $\\partial \\phi/\\partial \\theta = 0$ 和 $\\partial^2 \\phi/\\partial \\theta^2 = 0$，因此算子简化为\n$$\n\\mathcal{L}\\phi(r) = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial \\phi}{\\partial r}\\right).\n$$\n设均匀径向网格由 $r_i = i\\Delta r$ 定义，其中整数 $i \\ge 0$，且 $\\phi_i = \\phi(r_i)$。在磁轴 $r_0 = 0$ 处，坐标因子 $1/r$ 是奇异的，必须构建一个相容的离散化方案，该方案要遵循光滑轴对称场的正则性，特别是 $\\frac{\\partial \\phi}{\\partial r}|_{r=0} = 0$，并保持 2 阶精度。\n\n从极坐标下拉普拉斯算子的基本定义以及光滑轴对称解在 $r=0$ 处的正则性出发，以下哪种用于轴节点 $i=0$ 处 $\\mathcal{L}\\phi$ 的离散格式可以避免坐标奇异性并达到二阶精度？当需要时，假设使用镜像虚拟值 $\\phi_{-1} = \\phi_1$ 来施加 $\\frac{\\partial \\phi}{\\partial r}|_{r=0} = 0$ 的条件。\n\nA. $\\mathcal{L}\\phi|_{i=0} = \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2}$\n\nB. $\\mathcal{L}\\phi|_{i=0} = \\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{\\Delta r^2}$\n\nC. $\\mathcal{L}\\phi|_{i=0} = \\frac{\\phi_1 - \\phi_0}{\\Delta r^2}$\n\nD. $\\mathcal{L}\\phi|_{i=0} = \\frac{1}{r_0}\\frac{1}{\\Delta r}\\left[r_{1/2}\\frac{\\phi_1 - \\phi_0}{\\Delta r} - r_{-1/2}\\frac{\\phi_0 - \\phi_{-1}}{\\Delta r}\\right]$ with $r_{\\pm 1/2} = r_0 \\pm \\frac{\\Delta r}{2}$",
            "solution": "### 第1步：提取已知条件\n- **控制方程**：极坐标 $(r, \\theta)$ 下的轴对称泊松方程由 $\\nabla^2 \\phi = s(r)$ 给出。\n- **算子定义**：轴对称势 $\\phi(r)$ 的拉普拉斯算子为 $\\mathcal{L}\\phi(r) = \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)$。\n- **网格**：均匀径向网格由 $r_i = i\\,\\Delta r$ 定义，其中整数 $i \\ge 0$。网格点上的势记为 $\\phi_i = \\phi(r_i)$。\n- **关注点**：需要在磁轴 $r_0 = 0$ 处进行离散化。\n- **奇异性**：由于因子 $1/r$，算子 $\\mathcal{L}$ 在 $r_0=0$ 处存在坐标奇异性。\n- **正则性条件**：对于光滑的轴对称解，势在轴上的径向导数必须为零：$\\frac{\\partial \\phi}{\\partial r}\\big|_{r=0} = 0$。\n- **虚拟点条件**：假定可以使用镜像虚拟值 $\\phi_{-1} = \\phi_1$ 来施加正则性条件。\n- **要求**：在 $i=0$ 处 $\\mathcal{L}\\phi$ 的离散格式必须避免奇异性、具有相容性，并达到二阶精度，即截断误差必须为 $O(\\Delta r^2)$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题陈述在科学上和数学上是合理的。它提出了在非笛卡尔坐标系中数值求解偏微分方程时的一个标准挑战，特别是坐标奇异性的处理。控制方程、算子、边界/正则性条件以及对数值格式的要求都得到了清晰和正确的定义。该问题是适定的、客观的，并且完全属于计算物理和数值分析的范畴。它没有自相矛盾、不完整或过于简单。因此，该问题是有效的。\n\n### 第3步：推导正确的格式\n算子由 $\\mathcal{L}\\phi(r) = \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)$ 给出。展开导数，我们得到：\n$$ \\mathcal{L}\\phi(r) = \\frac{1}{r} \\left( \\frac{\\partial \\phi}{\\partial r} + r\\,\\frac{\\partial^2 \\phi}{\\partial r^2} \\right) = \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} + \\frac{\\partial^2 \\phi}{\\partial r^2} $$\n我们需要计算该表达式在 $r=0$ 处的值。在这一点上，项 $\\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r}$ 是一个 $0/0$ 型的不定式，因为光滑轴对称解的正则性条件是 $\\frac{\\partial \\phi}{\\partial r}\\big|_{r=0} = 0$。为了解决这个不定式，我们应用洛必达法则 (L'Hôpital's rule)：\n$$ \\lim_{r \\to 0} \\left( \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} \\right) = \\lim_{r \\to 0} \\frac{\\frac{\\partial}{\\partial r}\\left(\\frac{\\partial \\phi}{\\partial r}\\right)}{\\frac{\\partial}{\\partial r}(r)} = \\lim_{r \\to 0} \\frac{\\frac{\\partial^2 \\phi}{\\partial r^2}}{1} = \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} $$\n将此结果代回到算子在 $r=0$ 处的表达式中：\n$$ \\mathcal{L}\\phi\\big|_{r=0} = \\left( \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} \\right)\\bigg|_{r=0} + \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} = \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} + \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} = 2\\,\\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} $$\n这就是算子在轴上精确的、非奇异的形式。现在的任务是为 $\\frac{\\partial^2 \\phi}{\\partial r^2}\\big|_{r=0}$ 找到一个二阶精度的有限差分近似。\n\n$\\phi$ 在 $r_0=0$ 处的二阶导数的标准二阶中心差分近似是：\n$$ \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} \\approx \\frac{\\phi(r_0 + \\Delta r) - 2\\phi(r_0) + \\phi(r_0 - \\Delta r)}{\\Delta r^2} = \\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{\\Delta r^2} $$\n问题提供了可以使用镜像虚拟值 $\\phi_{-1} = \\phi_1$ 的条件。这个条件是正则性条件 $\\frac{\\partial \\phi}{\\partial r}\\big|_{r=0} = 0$ 的离散实现，因为一阶导数的中心差分近似为 $\\frac{\\phi_1 - \\phi_{-1}}{2\\Delta r} = 0$，这意味着 $\\phi_1 = \\phi_{-1}$。\n\n将 $\\phi_{-1} = \\phi_1$ 代入二阶导数的近似中：\n$$ \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} \\approx \\frac{\\phi_1 - 2\\phi_0 + \\phi_1}{\\Delta r^2} = \\frac{2\\phi_1 - 2\\phi_0}{\\Delta r^2} = \\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2} $$\n最后，我们将此近似代回到我们在轴上的算子表达式中：\n$$ \\mathcal{L}\\phi\\big|_{r=0} \\approx 2 \\left( \\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2} \\right) = \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2} $$\n\n为了确认二阶精度，我们使用泰勒级数展开。对于一个光滑的轴对称函数，$\\phi(r)$ 在 $r=0$ 附近的展开式只包含 $r$ 的偶数次幂：\n$$ \\phi(r) = \\phi(0) + \\frac{\\phi''(0)}{2!}r^2 + \\frac{\\phi''''(0)}{4!}r^4 + O(r^6) $$\n设 $\\phi_0 = \\phi(0)$ 和 $\\phi_1 = \\phi(\\Delta r)$。那么：\n$$ \\phi_1 = \\phi_0 + \\frac{\\phi''(0)}{2}\\Delta r^2 + \\frac{\\phi''''(0)}{24}\\Delta r^4 + O(\\Delta r^6) $$\n提出的离散算子是：\n$$ \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2} = \\frac{4}{\\Delta r^2} \\left[ \\frac{\\phi''(0)}{2}\\Delta r^2 + \\frac{\\phi''''(0)}{24}\\Delta r^4 + O(\\Delta r^6) \\right] = 2\\phi''(0) + \\frac{\\phi''''(0)}{6}\\Delta r^2 + O(\\Delta r^4) $$\n精确算子是 $\\mathcal{L}\\phi\\big|_{r=0} = 2\\phi''(0)$。截断误差是离散算子与精确算子之差：\n$$ \\text{Error} = \\left( 2\\phi''(0) + \\frac{\\phi''''(0)}{6}\\Delta r^2 + \\dots \\right) - 2\\phi''(0) = \\frac{\\phi''''(0)}{6}\\Delta r^2 + O(\\Delta r^4) $$\n误差与 $\\Delta r^2$ 成正比，这证实了该格式是二阶精度的。\n\n### 选项评估\n\n**A. $\\mathcal{L}\\phi|_{i=0} = \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2}$**\n这个表达式与我们推导出的格式相匹配。推导过程表明，它通过计算算子在 $r=0$ 处的解析极限来正确处理奇异性，然后应用了一个与正则性条件相符的二阶精度有限差分近似。结论：**正确**。\n\n**B. $\\mathcal{L}\\phi|_{i=0} = \\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{\\Delta r^2}$**\n这是二阶导数 $\\frac{\\partial^2 \\phi}{\\partial r^2}\\big|_{r=0}$ 的标准中心差分近似。然而，我们的分析表明 $\\mathcal{L}\\phi\\big|_{r=0} = 2\\,\\frac{\\partial^2 \\phi}{\\partial r^2}\\big|_{r=0}$。因此，这个格式缺少了一个因子 $2$。使用虚拟点条件 $\\phi_{-1}=\\phi_1$，这变为 $\\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2}$，这仍然与正确结果相差一个因子 $2$。结论：**不正确**。\n\n**C. $\\mathcal{L}\\phi|_{i=0} = \\frac{\\phi_1 - \\phi_0}{\\Delta r^2}$**\n这个格式比正确结果小 $4$ 倍。通过泰勒级数确定的其主阶行为将近似于 $\\frac{1}{2}\\phi''(0)$，而正确的值是 $2\\phi''(0)$。当 $\\Delta r \\to 0$ 时，差异不会消失，因此该格式不具有相容性（即，它有 $O(1)$ 的误差，甚至不是零阶精度的）。结论：**不正确**。\n\n**D. $\\mathcal{L}\\phi|_{i=0} = \\frac{1}{r_0}\\frac{1}{\\Delta r}\\left[r_{1/2}\\frac{\\phi_1 - \\phi_0}{\\Delta r} - r_{-1/2}\\frac{\\phi_0 - \\phi_{-1}}{\\Delta r}\\right]$ with $r_{\\pm 1/2} = r_0 \\pm \\frac{\\Delta r}{2}$**\n这是算子 $\\mathcal{L}\\phi(r_i)$ 的通用有限体积式中心差分格式。对于 $i=0$，我们有 $r_0=0$。该格式包含一个 $1/r_0$ 项，这会导致除以零。这个公式在 $r=0$ 处是显式奇异的，不能使用。这个问题的全部目的就是找到一个能正确表示算子在轴上极限的非奇异格式。此选项代表了将通用公式天真地应用于其无效点的情况。结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "方程离散化后，我们得到一个大型线性方程组 $K u = f$。迭代求解器通过最小化残差来寻找解，但我们真正的目标是最小化实际误差。本练习将揭示求解器残差与解的物理误差之间的关键关系，使你能够为模拟设置智能的停止准则。",
            "id": "4023942",
            "problem": "考虑一个圆形托卡马克上的环形泊松问题，其大半径为 $R_0$，小半径为 $a$，静电势为 $\\phi$。该问题由常数电导率算子 $\\nabla \\cdot (\\kappa \\nabla \\phi)=s$ 建模，其中 $\\kappa=1$。坐标系为直场线磁通坐标 $(\\rho,\\theta,\\zeta)$，其中 $\\rho\\in[0,1]$ 是归一化小半径，$\\theta$ 是极向角，$\\zeta$ 是环向角。在对 $\\theta$ 和 $\\zeta$ 进行傅里叶分解以获得单个 $(m,n)$ 模式，并使用三个 $H^{1}$-协调的分段线性基函数在 $\\rho$ 上进行伽辽金投影后，其弱形式产生一个对称正定线性系统 $K u = f$。对于这个 $(m,n)$ 块，假设刚度矩阵 $K$ 和载荷向量 $f$ 为\n$$\nK =\n\\begin{pmatrix}\n6  & -1 & 0 \\\\\n-1 & 6  & -1 \\\\\n0  & -1 & 6\n\\end{pmatrix},\n\\qquad\nf =\n\\begin{pmatrix}\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix}.\n$$\n一个数值迭代求解器（例如共轭梯度法 (CG)）当前持有一个迭代解 $u_h^{(k)}$。总残差定义为 $r^{(k)} = f - K u_h^{(k)}$，求解器使用欧几里得范数 $\\|r^{(k)}\\|_{2}$。误差的能量范数定义为 $\\|e^{(k)}\\|_{E}=\\sqrt{\\int_{\\Omega} |\\nabla(\\phi-\\phi_h^{(k)})|^{2}dV}$，对于离散系统，这等同于 $\\|e^{(k)}\\|_{E}=\\sqrt{(e^{(k)})^{\\top} K e^{(k)}}$，其中 $e^{(k)}=u-u_h^{(k)}$。\n\n假设当前迭代解为 $u_h^{(k)}=\\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$。请执行以下操作：\n\n1. 计算总残差 $r^{(k)}$ 及其欧几里得范数 $\\|r^{(k)}\\|_{2}$。\n2. 仅使用离散系统和当前残差中的可用量，计算误差的能量范数 $\\|e^{(k)}\\|_{E}$。\n3. 使用对称正定矩阵的谱特征，推导出一个严格的不等式，将 $\\|e^{(k)}\\|_{E}$ 与 $\\|r^{(k)}\\|_{2}$ 以及 $K$ 的最小特征值 $\\lambda_{\\min}(K)$ 联系起来。\n4. 求解器应用形式为 $\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}$ 的绝对停止准则。确定能保证 $\\|e^{(k)}\\|_{E} \\le \\tau_{E}$（其中 $\\tau_{E} = 5 \\times 10^{-2}$）的最小绝对残差容限 $\\varepsilon_{\\text{stop}}$。\n\n将最终的数值停止容限四舍五入到四位有效数字，并将其表示为无量纲量。",
            "solution": "问题陈述经过严格验证如下。\n\n**步骤1：提取已知条件**\n-   线性系统为 $K u = f$，其中 $K$ 是对称正定 (SPD) 矩阵，$f$ 是载荷向量。\n-   刚度矩阵：$K = \\begin{pmatrix} 6  -1  0 \\\\ -1  6  -1 \\\\ 0  -1  6 \\end{pmatrix}$。\n-   载荷向量：$f = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n-   当前迭代解：$u_h^{(k)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n-   残差定义：$r^{(k)} = f - K u_h^{(k)}$。\n-   残差范数：欧几里得范数，$\\|r^{(k)}\\|_{2}$。\n-   误差定义：$e^{(k)} = u - u_h^{(k)}$，其中 $K u = f$。\n-   误差范数 (能量范数)：$\\|e^{(k)}\\|_{E} = \\sqrt{(e^{(k)})^{\\top} K e^{(k)}}$。\n-   目标误差容限：$\\tau_{E} = 5 \\times 10^{-2}$。\n-   停止准则形式：$\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}$。\n\n**步骤2：验证已知条件**\n-   **科学依据**：该问题在数值分析领域有充分的依据，特别是针对偏微分方程（泊松问题）的有限元离散化所产生的线性系统的迭代求解器研究。残差、误差、范数和特征值的概念是该领域的核心。计算聚变科学的物理背景是恰当的。\n-   **适定性**：问题陈述 $K$ 是对称正定的。这可以被验证。$K$ 显然是对称的。$K$ 的主子式为：\n    -   $|6| = 6 > 0$\n    -   $\\det \\begin{pmatrix} 6  -1 \\\\ -1  6 \\end{pmatrix} = (6)(6) - (-1)(-1) = 36 - 1 = 35 > 0$\n    -   $\\det(K) = 6(35) - (-1)((-1)(6) - (-1)(0)) = 210 - 6 = 204 > 0$\n    由于所有主子式均为正，因此 $K$ 确实是正定的。这确保了唯一解 $u=K^{-1}f$ 的存在，使得问题是适定的。\n-   **客观性和完整性**：问题以客观的方式陈述，给出了精确的数学定义，并提供了执行所需任务的所有必要数据。\n\n**步骤3：结论**\n问题有效。将提供解答。\n\n**求解推导**\n\n**第1部分：计算残差及其欧几里得范数**\n\n在迭代次数 $k$ 时的残差定义为 $r^{(k)} = f - K u_h^{(k)}$。给定当前迭代解 $u_h^{(k)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$、矩阵 $K$ 和向量 $f$，我们有：\n$$\nr^{(k)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 6  -1  0 \\\\ -1  6  -1 \\\\ 0  -1  6 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n残差的欧几里得范数 $\\|r^{(k)}\\|_{2}$ 计算如下：\n$$\n\\|r^{(k)}\\|_{2} = \\sqrt{1^{2} + 1^{2} + 1^{2}} = \\sqrt{3}\n$$\n\n**第2部分：计算误差的能量范数**\n\n误差 $e^{(k)} = u - u_h^{(k)}$ 的能量范数定义为 $\\|e^{(k)}\\|_{E} = \\sqrt{(e^{(k)})^{\\top} K e^{(k)}}$。\n我们可以将误差 $e^{(k)}$ 与残差 $r^{(k)}$ 联系起来。根据定义，精确解 $u$ 满足 $K u = f$。\n$$\nr^{(k)} = f - K u_h^{(k)} = K u - K u_h^{(k)} = K (u - u_h^{(k)}) = K e^{(k)}\n$$\n由于 $K$ 是对称正定的，它是可逆的，所以我们可以将误差写为 $e^{(k)} = K^{-1} r^{(k)}$。\n将此代入能量范数平方的定义中：\n$$\n\\|e^{(k)}\\|_E^2 = (e^{(k)})^{\\top} K e^{(k)} = (K^{-1} r^{(k)})^{\\top} K (K^{-1} r^{(k)})\n$$\n由于 $K$ 是对称的，$(K^{-1})^{\\top} = (K^{\\top})^{-1} = K^{-1}$。\n$$\n\\|e^{(k)}\\|_E^2 = (r^{(k)})^{\\top} (K^{-1})^{\\top} K K^{-1} r^{(k)} = (r^{(k)})^{\\top} K^{-1} K K^{-1} r^{(k)} = (r^{(k)})^{\\top} K^{-1} r^{(k)}\n$$\n为了计算这个值，我们需要 $K$ 的逆矩阵。$K$ 的行列式是 $\\det(K) = 204$。逆矩阵是 $K^{-1} = \\frac{1}{\\det(K)} \\text{adj}(K)$。伴随矩阵是代数余子式矩阵的转置。\n$$\n\\text{adj}(K) = \\begin{pmatrix} 35  6  1 \\\\ 6  36  6 \\\\ 1  6  35 \\end{pmatrix}\n$$\n所以，逆矩阵是：\n$$\nK^{-1} = \\frac{1}{204} \\begin{pmatrix} 35  6  1 \\\\ 6  36  6 \\\\ 1  6  35 \\end{pmatrix}\n$$\n现在我们用 $r^{(k)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 来计算 $\\|e^{(k)}\\|_E^2$：\n$$\n\\|e^{(k)}\\|_E^2 = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\frac{1}{204} \\begin{pmatrix} 35  6  1 \\\\ 6  36  6 \\\\ 1  6  35 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{204} \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 35+6+1 \\\\ 6+36+6 \\\\ 1+6+35 \\end{pmatrix}\n$$\n$$\n\\|e^{(k)}\\|_E^2 = \\frac{1}{204} \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 42 \\\\ 48 \\\\ 42 \\end{pmatrix} = \\frac{1}{204} (42 + 48 + 42) = \\frac{132}{204} = \\frac{11}{17}\n$$\n因此，误差的能量范数为：\n$$\n\\|e^{(k)}\\|_{E} = \\sqrt{\\frac{11}{17}}\n$$\n\n**第3部分：推导关联范数的不等式**\n\n我们希望推导一个不等式，将 $\\|e^{(k)}\\|_{E}$ 与 $\\|r^{(k)}\\|_{2}$ 和 $K$ 的最小特征值 $\\lambda_{\\min}(K)$ 联系起来。\n我们利用第2部分推导出的能量范数平方的表达式：$\\|e^{(k)}\\|_{E}^2 = (r^{(k)})^{\\top} K^{-1} r^{(k)}$。\n对于任何实对称矩阵 $A$ 和任何非零向量 $x$，瑞利-里兹商 $\\frac{x^{\\top} A x}{x^{\\top} x}$ 受 $A$ 的特征值限制。具体来说，$\\lambda_{\\min}(A) \\le \\frac{x^{\\top} A x}{x^{\\top} x} \\le \\lambda_{\\max}(A)$。\n我们将此定理应用于对称矩阵 $K^{-1}$ 和向量 $r^{(k)}$：\n$$\n\\frac{(r^{(k)})^{\\top} K^{-1} r^{(k)}}{(r^{(k)})^{\\top} r^{(k)}} \\le \\lambda_{\\max}(K^{-1})\n$$\n$K^{-1}$ 的特征值是 $K$ 的特征值的倒数。由于对称正定矩阵 $K$ 的所有特征值都是正的，所以 $K^{-1}$ 的最大特征值对应于 $K$ 的最小特征值的倒数：\n$$\n\\lambda_{\\max}(K^{-1}) = \\frac{1}{\\lambda_{\\min}(K)}\n$$\n将范数定义 $\\|e^{(k)}\\|_{E}^2 = (r^{(k)})^{\\top} K^{-1} r^{(k)}$ 和 $\\|r^{(k)}\\|_{2}^2 = (r^{(k)})^{\\top} r^{(k)}$ 代入瑞利商不等式，我们得到：\n$$\n\\frac{\\|e^{(k)}\\|_{E}^2}{\\|r^{(k)}\\|_{2}^2} \\le \\frac{1}{\\lambda_{\\min}(K)}\n$$\n整理得到范数平方的不等式：\n$$\n\\|e^{(k)}\\|_{E}^2 \\le \\frac{1}{\\lambda_{\\min}(K)} \\|r^{(k)}\\|_{2}^2\n$$\n对两边取平方根（所有量都是非负的），得到所需的不等式：\n$$\n\\|e^{(k)}\\|_{E} \\le \\frac{1}{\\sqrt{\\lambda_{\\min}(K)}} \\|r^{(k)}\\|_{2}\n$$\n\n**第4部分：确定停止容限**\n\n我们需要找到最小绝对残差容限 $\\varepsilon_{\\text{stop}}$，使得如果 $\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}$，则可以保证 $\\|e^{(k)}\\|_{E} \\le \\tau_{E}$，其中 $\\tau_{E} = 5 \\times 10^{-2}$。\n使用第3部分的不等式：\n$$\n\\|e^{(k)}\\|_{E} \\le \\frac{\\|r^{(k)}\\|_{2}}{\\sqrt{\\lambda_{\\min}(K)}}\n$$\n如果我们强制执行条件 $\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}$，误差能量范数的上界变为：\n$$\n\\|e^{(k)}\\|_{E} \\le \\frac{\\varepsilon_{\\text{stop}}}{\\sqrt{\\lambda_{\\min}(K)}}\n$$\n为保证 $\\|e^{(k)}\\|_{E} \\le \\tau_{E}$，我们必须要求这个上界本身小于或等于 $\\tau_{E}$：\n$$\n\\frac{\\varepsilon_{\\text{stop}}}{\\sqrt{\\lambda_{\\min}(K)}} \\le \\tau_{E}\n$$\n为找到满足此条件的最小（限制最少的）容限 $\\varepsilon_{\\text{stop}}$，我们令两项相等：\n$$\n\\varepsilon_{\\text{stop}} = \\tau_{E} \\sqrt{\\lambda_{\\min}(K)}\n$$\n首先，我们必须通过求解特征方程 $\\det(K - \\lambda I) = 0$ 来找到 $K$ 的特征值。\n$$\n\\det \\begin{pmatrix} 6-\\lambda  -1  0 \\\\ -1  6-\\lambda  -1 \\\\ 0  -1  6-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 1 \\right) - (-1) \\left( -(6-\\lambda) - 0 \\right) = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 1 \\right) - (6-\\lambda) = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 1 - 1 \\right) = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 2 \\right) = 0\n$$\n这给出了 $\\lambda$ 的三个解：\n1.  $6 - \\lambda = 0 \\implies \\lambda_1 = 6$\n2.  $(6 - \\lambda)^{2} = 2 \\implies 6 - \\lambda = \\pm\\sqrt{2} \\implies \\lambda = 6 \\mp \\sqrt{2}$\n特征值为 $\\lambda = 6$、$\\lambda = 6 - \\sqrt{2}$ 和 $\\lambda = 6 + \\sqrt{2}$。由于 $\\sqrt{2} \\approx 1.414$，最小的特征值是 $\\lambda_{\\min}(K) = 6 - \\sqrt{2}$。\n\n现在，我们可以计算 $\\varepsilon_{\\text{stop}}$：\n$$\n\\varepsilon_{\\text{stop}} = (5 \\times 10^{-2}) \\sqrt{6 - \\sqrt{2}}\n$$\n数值上，这等于：\n$$\n\\varepsilon_{\\text{stop}} \\approx (0.05) \\sqrt{6 - 1.41421356} = (0.05) \\sqrt{4.58578644} \\approx (0.05) (2.14144499) \\approx 0.10707225\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\varepsilon_{\\text{stop}} \\approx 1.071 \\times 10^{-1}\n$$",
            "answer": "$$\\boxed{1.071 \\times 10^{-1}}$$"
        }
    ]
}