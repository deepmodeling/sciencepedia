{
    "hands_on_practices": [
        {
            "introduction": "This practice gets to the heart of why divergence control is a central issue in numerical magnetohydrodynamics. By comparing a simple, collocated discretization of the induction equation with a staggered Constrained Transport (CT) scheme , you will directly calculate the spurious divergence generated by the former. This exercise provides a concrete demonstration of how the non-commutativity of discrete difference operators can numerically violate the solenoidal constraint, $\\nabla \\cdot \\mathbf{B} = 0$, motivating the need for more sophisticated, carefully constructed numerical methods.",
            "id": "3968369",
            "problem": "Consider two finite-difference discretizations of the induction equation of ideal Magnetohydrodynamics (MHD) in two spatial dimensions for a uniform advection velocity. The continuous induction equation is\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}),\n$$\nwith ideal Ohm’s law $\\mathbf{E} = -\\mathbf{u} \\times \\mathbf{B}$ and magnetic field $\\mathbf{B} = (B_x, B_y, 0)$. Assume a spatially uniform velocity $\\mathbf{u} = (U, 0, 0)$ with constant $U$, periodic boundary conditions, and a uniform Cartesian grid with spacing $\\Delta$ in both directions. Cell centers are located at $(x_i, y_j) = (i\\,\\Delta, j\\,\\Delta)$ for integers $i, j$.\n\nDefine the initial magnetic field to be exactly discretely divergence-free by introducing a stream function $\\psi(x,y)$ and setting\n$$\nB_x(x,y) = \\frac{\\partial \\psi}{\\partial y}(x,y), \\qquad B_y(x,y) = -\\frac{\\partial \\psi}{\\partial x}(x,y),\n$$\nwith\n$$\n\\psi(x,y) = \\psi_0 \\sin(k x) \\sin(k y),\n$$\nwhere $\\psi_0$ and $k$ are real constants. On the grid, use pointwise sampling at cell centers: $B_x^n(i,j) = \\psi_0 k \\cos(k y_j) \\sin(k x_i)$ and $B_y^n(i,j) = -\\psi_0 k \\cos(k x_i) \\sin(k y_j)$ at time $t^n$.\n\nYou will compare the one-step update of the following two schemes over a single time step $\\Delta t$:\n\n1. A collocated divergence-violating scheme at cell centers, obtained by discretizing the right-hand side of the induction equation with one-sided (upwind) differences applied directly to $B_y$ in each component update:\n$$\nB_x^{n+1}(i,j) = B_x^{n}(i,j) + U\\,\\Delta t\\, D_y^{-}\\!\\left[B_y^{n}\\right](i,j),\n$$\n$$\nB_y^{n+1}(i,j) = B_y^{n}(i,j) - U\\,\\Delta t\\, D_x^{-}\\!\\left[B_y^{n}\\right](i,j),\n$$\nwhere the backward-difference operators are\n$$\nD_x^{-}[f](i,j) = \\frac{f(i,j) - f(i-1,j)}{\\Delta}, \\qquad D_y^{-}[f](i,j) = \\frac{f(i,j) - f(i,j-1)}{\\Delta}.\n$$\nDefine the collocated discrete divergence at cell centers by central differences\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}(i,j) = D_x^{c}\\!\\left[B_x\\right](i,j) + D_y^{c}\\!\\left[B_y\\right](i,j),\n$$\nwith\n$$\nD_x^{c}[f](i,j) = \\frac{f(i+1,j) - f(i-1,j)}{2\\,\\Delta}, \\qquad D_y^{c}[f](i,j) = \\frac{f(i,j+1) - f(i,j-1)}{2\\,\\Delta}.\n$$\n\n2. A face-centered Constrained Transport (CT) scheme that updates the face-normal components via edge-centered electric fields to ensure a discrete divergence-free evolution. Let $B_x$ be stored on $x$-faces as $B_x(i+\\tfrac{1}{2}, j)$ and $B_y$ on $y$-faces as $B_y(i, j+\\tfrac{1}{2})$. The CT update is\n$$\nB_x^{n+1}\\!\\left(i+\\tfrac{1}{2}, j\\right) = B_x^{n}\\!\\left(i+\\tfrac{1}{2}, j\\right) - \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j-\\tfrac{1}{2}\\right)\\right],\n$$\n$$\nB_y^{n+1}\\!\\left(i, j+\\tfrac{1}{2}\\right) = B_y^{n}\\!\\left(i, j+\\tfrac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i-\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right)\\right],\n$$\nwith $E_z^{n} = -U\\,B_y^{n}$ sampled at edge centers $(i\\pm\\tfrac{1}{2}, j\\pm\\tfrac{1}{2})$ by any second-order consistent interpolation of $B_y$. The CT discrete divergence at cell centers is defined by face-normal flux differences\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}(i,j) = \\frac{B_x\\!\\left(i+\\tfrac{1}{2}, j\\right) - B_x\\!\\left(i-\\tfrac{1}{2}, j\\right)}{\\Delta} + \\frac{B_y\\!\\left(i, j+\\tfrac{1}{2}\\right) - B_y\\!\\left(i, j-\\tfrac{1}{2}\\right)}{\\Delta}.\n$$\n\nStarting from the given initial field, perform a single time step $\\Delta t$ with each scheme and compute the resulting discrete divergence at cell center $(i,j)$. Express your answers as closed-form analytic expressions in terms of $\\Delta t$, $U$, $\\psi_0$, $k$, $\\Delta$, $x_i$, and $y_j$. Provide both $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j)$ and $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{\\,n+1}(i,j)$ after the step. No rounding is required, and no units are needed in your final expressions.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of computational magnetohydrodynamics, well-posed with a complete and consistent set of givens, and expressed in objective, formal language. All necessary equations, initial conditions, and numerical scheme definitions are provided to find a unique, analytical solution. The problem does not violate any of the specified invalidity criteria. We may therefore proceed with the solution.\n\nThe problem asks for the discrete divergence of the magnetic field, $(\\nabla \\cdot \\mathbf{B})$, after a single time step of size $\\Delta t$ for two different numerical schemes, starting from a specified initial condition. The continuous induction equation for a uniform velocity $\\mathbf{u} = (U, 0, 0)$ simplifies to:\n$$\n\\frac{\\partial B_x}{\\partial t} = U \\frac{\\partial B_y}{\\partial y}\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = -U \\frac{\\partial B_y}{\\partial x}\n$$\nThe initial magnetic field is derived from a stream function $\\psi(x,y) = \\psi_0 \\sin(k x) \\sin(k y)$, which, by construction, gives a continuously divergence-free field, $\\nabla \\cdot \\mathbf{B} = \\frac{\\partial B_x}{\\partial x} + \\frac{\\partial B_y}{\\partial y} = \\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial^2 \\psi}{\\partial y \\partial x} = 0$.\nThe problem specifies discretely sampled initial fields at time $t^n$:\nFor the collocated scheme, at cell centers $(x_i, y_j) = (i\\Delta, j\\Delta)$:\n$$\nB_x^n(i,j) = \\psi_0 k \\sin(k x_i) \\cos(k y_j)\n$$\n$$\nB_y^n(i,j) = -\\psi_0 k \\cos(k x_i) \\sin(k y_j)\n$$\nAs demonstrated during the validation process, this initial field is also discretely divergence-free with respect to the specified central difference operator, i.e., $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n}(i,j) = 0$.\n\n### Scheme 1: Collocated Divergence-Violating Scheme\n\nThe update for the magnetic field components over one time step $\\Delta t$ is given by:\n$$\nB_x^{n+1}(i,j) = B_x^{n}(i,j) + U\\,\\Delta t\\, D_y^{-}\\!\\left[B_y^{n}\\right](i,j)\n$$\n$$\nB_y^{n+1}(i,j) = B_y^{n}(i,j) - U\\,\\Delta t\\, D_x^{-}\\!\\left[B_y^{n}\\right](i,j)\n$$\nThe discrete divergence at time $t^{n+1}$ is defined as:\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = D_x^{c}\\!\\left[B_x^{n+1}\\right](i,j) + D_y^{c}\\!\\left[B_y^{n+1}\\right](i,j)\n$$\nSubstituting the update equations into the divergence definition:\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = D_x^{c}\\!\\left[B_x^{n} + U\\,\\Delta t\\, D_y^{-}\\!B_y^{n}\\right](i,j) + D_y^{c}\\!\\left[B_y^{n} - U\\,\\Delta t\\, D_x^{-}\\!B_y^{n}\\right](i,j)\n$$\nBy linearity of the difference operators:\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = \\left(D_x^{c}\\!B_x^{n} + D_y^{c}\\!B_y^{n}\\right) + U\\,\\Delta t \\left(D_x^{c} D_y^{-}\\!B_y^{n} - D_y^{c} D_x^{-}\\!B_y^{n}\\right)\n$$\nThe first term is the initial discrete divergence, $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n}(i,j)$, which is $0$. Thus, the divergence after one step is generated entirely by the non-commutativity of the discrete difference operators:\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = U\\,\\Delta t\\, \\left[D_x^{c}, D_y^{-}\\right]B_y^{n}(i,j)\n$$\nLet's compute the action of the commutator $[D_x^c, D_y^-] = D_x^c D_y^- - D_y^c D_x^-$ on $B_y^n(i,j) = -\\psi_0 k \\cos(k x_i) \\sin(k y_j)$. Let $C = -\\psi_0 k$.\n$$\nD_x^c D_y^- [B_y^n] = D_x^c \\left[ \\frac{B_y^n(i,j) - B_y^n(i,j-1)}{\\Delta} \\right] = \\frac{1}{\\Delta} \\left( D_x^c [B_y^n(i,j)] - D_x^c [B_y^n(i,j-1)] \\right)\n$$\n$$\nD_x^c[B_y^n(i,j)] = C \\sin(ky_j) D_x^c[\\cos(kx_i)] = C \\sin(ky_j) \\frac{\\cos(k(x_i+\\Delta)) - \\cos(k(x_i-\\Delta))}{2\\Delta}\n$$\nUsing the identity $\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$, this becomes:\n$$\nD_x^c[B_y^n(i,j)] = C \\sin(ky_j) \\frac{-2\\sin(kx_i)\\sin(k\\Delta)}{2\\Delta}\n$$\nSimilarly, $D_y^c D_x^- [B_y^n] = D_y^c \\left[ \\frac{B_y^n(i,j) - B_y^n(i-1,j)}{\\Delta} \\right]$.\nLet's evaluate the commutator term $D_x^c D_y^- [B_y^n] - D_y^c D_x^- [B_y^n]$ more directly.\nLet $f(i,j) = B_y^n(i,j) = C \\cos(kx_i)\\sin(ky_j)$.\n$$\nD_x^c D_y^- [f] = \\frac{1}{2\\Delta} D_x^c\\left[\\frac{f(i,j)-f(i,j-1)}{\\Delta}\\right] = \\frac{C}{2\\Delta^2}\\left( \\sin(ky_j)-\\sin(ky_{j-1}) \\right)\\left( \\cos(kx_{i+1})-\\cos(kx_{i-1}) \\right)\n$$\n$$\nD_y^c D_x^- [f] = \\frac{1}{2\\Delta} D_y^c\\left[\\frac{f(i,j)-f(i-1,j)}{\\Delta}\\right] = \\frac{C}{2\\Delta^2}\\left( \\cos(kx_i)-\\cos(kx_{i-1}) \\right)\\left( \\sin(ky_{j+1})-\\sin(ky_{j-1}) \\right)\n$$\nUsing trigonometric sum-to-product identities:\n$\\sin(A) - \\sin(B) = 2\\cos(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$\n$\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$\nWe get:\n$\\sin(ky_j)-\\sin(ky_{j-1}) = 2\\cos(k(y_j - \\Delta/2))\\sin(k\\Delta/2)$\n$\\cos(kx_{i+1})-\\cos(kx_{i-1}) = -2\\sin(kx_i)\\sin(k\\Delta)$\n$\\cos(kx_i)-\\cos(kx_{i-1}) = -2\\sin(k(x_i - \\Delta/2))\\sin(k\\Delta/2)$\n$\\sin(ky_{j+1})-\\sin(ky_{j-1}) = 2\\cos(ky_j)\\sin(k\\Delta)$\nSubstituting these into the commutator expression:\n$$\n[D_x^c, D_y^-]B_y^n = \\frac{C}{2\\Delta^2} \\left[ (2\\cos(k(y_j-\\frac{\\Delta}{2}))\\sin(\\frac{k\\Delta}{2}))(-2\\sin(kx_i)\\sin(k\\Delta)) - (-2\\sin(k(x_i-\\frac{\\Delta}{2}))\\sin(\\frac{k\\Delta}{2}))(2\\cos(ky_j)\\sin(k\\Delta)) \\right]\n$$\n$$\n= \\frac{-2C \\sin(\\frac{k\\Delta}{2})\\sin(k\\Delta)}{\\Delta^2} \\left[ \\sin(kx_i)\\cos(k(y_j-\\frac{\\Delta}{2})) - \\cos(ky_j)\\sin(k(x_i-\\frac{\\Delta}{2})) \\right]\n$$\nThe term in brackets can be simplified by expanding the functions of shifted arguments:\n$\\sin(kx_i)\\cos(ky_j-\\frac{k\\Delta}{2}) = \\sin(kx_i)[\\cos(ky_j)\\cos(\\frac{k\\Delta}{2}) + \\sin(ky_j)\\sin(\\frac{k\\Delta}{2})]$\n$\\cos(ky_j)\\sin(kx_i-\\frac{k\\Delta}{2}) = \\cos(ky_j)[\\sin(kx_i)\\cos(\\frac{k\\Delta}{2}) - \\cos(kx_i)\\sin(\\frac{k\\Delta}{2})]$\nSubtracting the second from the first yields:\n$\\sin(\\frac{k\\Delta}{2}) [\\sin(kx_i)\\sin(ky_j) + \\cos(kx_i)\\cos(ky_j)] = \\sin(\\frac{k\\Delta}{2})\\cos(k(x_i-y_j))$\nSo the commutator is:\n$$\n[D_x^c, D_y^-]B_y^n = \\frac{-2C \\sin(\\frac{k\\Delta}{2})\\sin(k\\Delta)}{\\Delta^2} \\left[ \\sin(\\frac{k\\Delta}{2})\\cos(k(x_i-y_j)) \\right] = \\frac{-2C}{\\Delta^2} \\sin^2(\\frac{k\\Delta}{2})\\sin(k\\Delta)\\cos(k(x_i-y_j))\n$$\nFinally, substituting $C = -\\psi_0 k$ and using $\\sin(k\\Delta) = 2\\sin(k\\Delta/2)\\cos(k\\Delta/2)$:\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = U\\Delta t \\frac{-2(-\\psi_0 k)}{\\Delta^2} \\sin^2(\\frac{k\\Delta}{2})[2\\sin(\\frac{k\\Delta}{2})\\cos(\\frac{k\\Delta}{2})]\\cos(k(x_i-y_j))\n$$\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = \\frac{4 U \\Delta t \\psi_0 k}{\\Delta^2} \\sin^3\\left(\\frac{k\\Delta}{2}\\right)\\cos\\left(\\frac{k\\Delta}{2}\\right) \\cos(k(x_i-y_j))\n$$\n\n### Scheme 2: Face-Centered Constrained Transport (CT) Scheme\n\nThe Constrained Transport (CT) scheme is designed to maintain the discrete divergence of the magnetic field at exactly zero (to machine precision) for all time, provided it is initially zero. The discrete divergence at a cell center $(i,j)$ is defined using fluxes on its faces:\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}(i,j) = \\frac{B_x\\!\\left(i+\\tfrac{1}{2}, j\\right) - B_x\\!\\left(i-\\tfrac{1}{2}, j\\right)}{\\Delta} + \\frac{B_y\\!\\left(i, j+\\tfrac{1}{2}\\right) - B_y\\!\\left(i, j-\\tfrac{1}{2}\\right)}{\\Delta}\n$$\nThe update equations are:\n$$\nB_x^{n+1}\\!\\left(i+\\tfrac{1}{2}, j\\right) = B_x^{n}\\!\\left(i+\\tfrac{1}{2}, j\\right) - \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j-\\tfrac{1}{2}\\right)\\right]\n$$\n$$\nB_y^{n+1}\\!\\left(i, j+\\tfrac{1}{2}\\right) = B_y^{n}\\!\\left(i, j+\\tfrac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i-\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right)\\right]\n$$\nTo find the divergence at time $t^{n+1}$, we compute the change over one time step, $\\Delta (\\nabla \\cdot \\mathbf{B})^{n+1} - \\Delta (\\nabla \\cdot \\mathbf{B})^{n}$. This is the sum of the changes in the four face-centered field components. Let $\\delta B_x(i+1/2,j) = B_x^{n+1}-B_x^n$, etc.\n$$\n\\Delta \\cdot \\left((\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n}\\right) = \\left[\\delta B_x(i+\\tfrac{1}{2},j) - \\delta B_x(i-\\tfrac{1}{2},j)\\right] + \\left[\\delta B_y(i,j+\\tfrac{1}{2}) - \\delta B_y(i,j-\\tfrac{1}{2})\\right]\n$$\nSubstituting the update rules (multiplied by $\\Delta t$):\n$$\n-\\frac{\\Delta t}{\\Delta}\\left[E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}) - E_z(i+\\tfrac{1}{2}, j-\\tfrac{1}{2})\\right] - \\left(-\\frac{\\Delta t}{\\Delta}\\left[E_z(i-\\tfrac{1}{2}, j+\\tfrac{1}{2}) - E_z(i-\\tfrac{1}{2}, j-\\tfrac{1}{2})\\right]\\right)\n$$\n$$\n+ \\frac{\\Delta t}{\\Delta}\\left[E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}) - E_z(i-\\tfrac{1}{2}, j+\\tfrac{1}{2})\\right] - \\left(\\frac{\\Delta t}{\\Delta}\\left[E_z(i+\\tfrac{1}{2}, j-\\tfrac{1}{2}) - E_z(i-\\tfrac{1}{2}, j-\\tfrac{1}{2})\\right]\\right)\n$$\nGrouping terms by the electric field locations shows that all terms cancel out in a telescoping sum:\n$$\n\\frac{\\Delta t}{\\Delta} \\left[ (-E_z + E_z)_{i+\\frac{1}{2}, j+\\frac{1}{2}} + (E_z - E_z)_{i+\\frac{1}{2}, j-\\frac{1}{2}} + (E_z - E_z)_{i-\\frac{1}{2}, j+\\frac{1}{2}} + (-E_z + E_z)_{i-\\frac{1}{2}, j-\\frac{1}{2}} \\right] = 0\n$$\nThis demonstrates that $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n+1}(i,j) = (\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n}(i,j)$. The discrete divergence is exactly preserved.\nThe initial field for the CT scheme is sampled at face centers from the continuous definition. As demonstrated during validation, this initial staggered field is discretely divergence-free with respect to the CT divergence operator, i.e., $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n}(i,j) = 0$.\nTherefore, after one time step (and for all subsequent steps), the divergence remains zero.\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{\\,n+1}(i,j) = 0\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4 U \\Delta t \\psi_0 k}{\\Delta^2} \\sin^3\\left(\\frac{k\\Delta}{2}\\right)\\cos\\left(\\frac{k\\Delta}{2}\\right) \\cos(k(x_i-y_j))  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Once we accept the need for active divergence control, we must consider the practical costs of implementing such fixes. This problem explores the Generalized Lagrange Multiplier (GLM) method, a popular technique that treats divergence error as a wave to be propagated away and damped. By deriving the Courant–Friedrichs–Lewy (CFL) stability condition for the combined GLM-MHD system , you will quantify the trade-off between the speed of divergence cleaning and the maximum allowable simulation time step, a crucial consideration for computational efficiency.",
            "id": "3968355",
            "problem": "Consider the linearized, one-dimensional ideal Magnetohydrodynamics (MHD) system augmented with the Generalized Lagrange Multiplier (GLM) hyperbolic divergence-cleaning method. In this formulation, a scalar cleaning field couples to the magnetic field and propagates divergence errors with a prescribed speed $c_h$. Let $c_f$ denote the magnitude of the fastest magnetosonic wave speed at the state of interest. Assume a uniform grid with spacing $\\Delta x$ and an explicit finite-volume Godunov-type update characterized by a Courant–Friedrichs–Lewy (CFL) number $\\nu$ strictly between $0$ and $1$. Work in the fluid rest frame so that advective contributions do not alter the characteristic speeds.\n\nStarting from the hyperbolic character of the augmented GLM–MHD system and the principle that explicit time stepping must respect the fastest signal propagation present in the equations, derive the combined stability constraint for the nondimensional time-step bound, defined as $\\lambda \\equiv \\Delta t_{\\max} c_f / \\Delta x$, in terms of the ratio $r \\equiv c_h / c_f$ and the parameter $\\nu$. Your derivation should begin from the foundational concept that explicit schemes for hyperbolic systems are stable only when the numerical domain of dependence contains the physical domain of dependence determined by the largest characteristic speed, and should use the spectrum of characteristic speeds of the augmented system.\n\nIn addition, briefly explain the trade-off between increasing $c_h$ to accelerate divergence-error removal and the impact on the allowable time step. Express the final answer as a single closed-form analytic expression for $\\lambda$ in terms of $\\nu$ and $r$. Do not attach physical units to the final expression, and do not provide any numerical value; no rounding is required.",
            "solution": "The problem asks for the derivation of a nondimensional time-step bound for the one-dimensional, linearized ideal Magnetohydrodynamics (MHD) system augmented with the Generalized Lagrange Multiplier (GLM) hyperbolic divergence-cleaning method. The derivation must be based on the Courant–Friedrichs–Lewy (CFL) stability condition.\n\nFirst, we establish the fundamental principle governing the stability of explicit time-integration schemes for hyperbolic systems. The CFL condition dictates that for a scheme to be stable, the numerical domain of dependence of any grid point must contain the physical domain of dependence. For a one-dimensional system on a uniform grid with spacing $\\Delta x$, this condition for the maximum allowable time step, $\\Delta t_{\\max}$, is expressed as:\n$$\n\\Delta t_{\\max} \\le \\nu \\frac{\\Delta x}{\\lambda_{\\max}}\n$$\nHere, $\\lambda_{\\max}$ is the magnitude of the fastest characteristic speed (eigenvalue) of the governing system of partial differential equations, and $\\nu$ is the CFL number, a parameter given to be strictly between $0$ and $1$ ($0  \\nu  1$). For a Godunov-type scheme, the maximum stable CFL number is typically $1$, so $\\nu$ acts as a safety factor. The problem asks for the strict inequality to be considered as the bound, so we write:\n$$\n\\Delta t_{\\max} = \\nu \\frac{\\Delta x}{\\lambda_{\\max}}\n$$\n\nNext, we must identify the characteristic speeds of the augmented GLM-MHD system to determine $\\lambda_{\\max}$. The problem is set in the fluid rest frame, so the bulk fluid velocity is $u=0$. The characteristic speeds of the one-dimensional ideal MHD system propagating along the x-axis are the eigenvalues of the system's Jacobian matrix. In the rest frame, these are:\n\\begin{itemize}\n    \\item The entropy wave, with speed $0$.\n    \\item The two Alfvén waves, with speeds $\\pm c_{Ax}$, where $c_{Ax}$ is the Alfvén speed based on the magnetic field component parallel to the direction of wave propagation.\n    \\item The two slow magnetosonic waves, with speeds $\\pm c_s$.\n    \\item The two fast magnetosonic waves, with speeds $\\pm c_f$.\n\\end{itemize}\nThe problem states that $c_f$ is the magnitude of the fastest magnetosonic wave speed. By definition, $c_f \\ge c_{Ax}$ and $c_f \\ge c_s$. Therefore, the fastest signal speed intrinsic to the ideal MHD equations is $c_f$.\n\nThe GLM method introduces an additional scalar field, $\\psi$, to the system. This field is governed by a hyperbolic equation designed to transport violations of the divergence constraint, $\\nabla \\cdot \\mathbf{B} \\ne 0$, out of the computational domain. The propagation speed of these divergence errors is a user-defined parameter, $c_h$. This introduces two new characteristic speeds into the full GLM-MHD system, corresponding to waves propagating at speeds $\\pm c_h$.\n\nThe complete set of characteristic speeds for the one-dimensional GLM-MHD system in the fluid rest frame is the union of the ideal MHD speeds and the new GLM speeds:\n$$\n\\Lambda = \\{0, \\pm c_{Ax}, \\pm c_s, \\pm c_f, \\pm c_h\\}\n$$\nThe fastest signal speed in the entire system, $\\lambda_{\\max}$, is the maximum of the absolute values of all these speeds:\n$$\n\\lambda_{\\max} = \\max(|0|, |c_{Ax}|, |c_s|, |c_f|, |c_h|)\n$$\nGiven that $c_f$ is the largest of the physical MHD wave speeds, this simplifies to:\n$$\n\\lambda_{\\max} = \\max(c_f, c_h)\n$$\n\nNow we can substitute this expression for $\\lambda_{\\max}$ into the CFL condition for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\nu \\frac{\\Delta x}{\\max(c_f, c_h)}\n$$\nThe problem asks for the nondimensional time-step bound, which is defined as $\\lambda \\equiv \\Delta t_{\\max} c_f / \\Delta x$. We can derive an expression for $\\lambda$ by multiplying the equation for $\\Delta t_{\\max}$ by $c_f / \\Delta x$:\n$$\n\\lambda = \\left( \\nu \\frac{\\Delta x}{\\max(c_f, c_h)} \\right) \\frac{c_f}{\\Delta x}\n$$\nThe grid spacing $\\Delta x$ cancels out, yielding:\n$$\n\\lambda = \\nu \\frac{c_f}{\\max(c_f, c_h)}\n$$\nTo express this in terms of the given ratio $r \\equiv c_h / c_f$, we can factor $c_f$ out of the $\\max$ function in the denominator:\n$$\n\\max(c_f, c_h) = \\max(c_f, r \\cdot c_f) = c_f \\cdot \\max(1, r)\n$$\nSubstituting this back into the expression for $\\lambda$:\n$$\n\\lambda = \\nu \\frac{c_f}{c_f \\cdot \\max(1, r)}\n$$\nFinally, canceling $c_f$ from the numerator and denominator gives the desired closed-form expression for the nondimensional time-step bound:\n$$\n\\lambda = \\frac{\\nu}{\\max(1, r)}\n$$\n\nRegarding the trade-off involving $c_h$:\nThe purpose of the GLM method is to control divergence errors. The speed $c_h$ determines how quickly these numerical errors are advected away. A higher value of $c_h$ cleans the magnetic field more rapidly, which is beneficial for the physical accuracy of the simulation. However, as shown by the stability analysis, the overall time step $\\Delta t_{\\max}$ is constrained by $\\lambda_{\\max} = \\max(c_f, c_h)$. If one chooses $c_h > c_f$ (i.e., $r > 1$) to accelerate divergence cleaning, the cleaning speed $c_h$ becomes the limiting factor for the time step. This forces $\\Delta t_{\\max}$ to be smaller than what would be required by the physical MHD waves alone, specifically $\\Delta t_{\\max} = \\nu \\Delta x / c_h$. A smaller time step increases the total number of computations required to simulate a given physical duration, thus increasing the overall computational cost. Therefore, the trade-off is between the efficiency of divergence error removal (which favors a large $c_h$) and computational expense (which favors a smaller $c_h$ to allow for a larger $\\Delta t_{\\max}$). A common practical choice is to set $c_h$ equal to the local fast magnetosonic speed, $c_f$ (i.e., $r=1$), which balances effective cleaning with the time-step constraint already imposed by the physics of the system.",
            "answer": "$$\\boxed{\\frac{\\nu}{\\max(1, r)}}$$"
        },
        {
            "introduction": "Numerical methods must ultimately contend with the physics of domain boundaries. This exercise examines the implications of a stationary, perfectly conducting wall on the magnetic field and the divergence cleaning methods used to simulate it. You will first derive the physical boundary condition on the normal component of $\\mathbf{B}$ from fundamental laws, and then determine the necessary constraints on the scalar potentials used in GLM and elliptic projection methods to ensure the simulation respects this physical law .",
            "id": "3968332",
            "problem": "Consider ideal Magnetohydrodynamics (MHD) in a simply connected plasma domain bounded by a stationary, perfectly conducting wall with outward unit normal vector $\\boldsymbol{n}$. The magnetic field is $\\boldsymbol{B}(\\boldsymbol{x},t)$, the velocity is $\\boldsymbol{v}(\\boldsymbol{x},t)$, and the electric field is $\\boldsymbol{E}(\\boldsymbol{x},t)$. The fundamental starting point is Maxwell–Faraday’s law and ideal Ohm’s law:\n$$\\partial_{t}\\boldsymbol{B}=-\\nabla\\times\\boldsymbol{E},\\qquad \\boldsymbol{E}+\\boldsymbol{v}\\times\\boldsymbol{B}=\\boldsymbol{0}.$$\nAt a perfectly conducting wall, the tangential electric field vanishes, i.e., $\\boldsymbol{n}\\times\\boldsymbol{E}=\\boldsymbol{0}$, and the wall is stationary so that $\\boldsymbol{v}=\\boldsymbol{0}$ at the wall. In numerical Magnetohydrodynamics (MHD), divergence cleaning methods are often used to control numerical violations of the solenoidal constraint $\\nabla\\cdot\\boldsymbol{B}=0$. One widely used approach is the Generalized Lagrange Multiplier (GLM) hyperbolic–parabolic cleaning, which modifies the induction equation by introducing a scalar field $\\psi(\\boldsymbol{x},t)$ to propagate and damp $\\nabla\\cdot\\boldsymbol{B}$ errors:\n$$\\partial_{t}\\boldsymbol{B}+\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})+\\nabla\\psi=\\boldsymbol{0},\\qquad \\partial_{t}\\psi+c_{h}^{2}\\,\\nabla\\cdot\\boldsymbol{B}=-\\kappa\\,\\psi,$$\nwhere $c_h$ is a cleaning wave speed and $\\kappa$ determines the damping rate. Another common approach is elliptic projection (also called Poisson projection), which corrects the magnetic field by solving a scalar potential $\\phi(\\boldsymbol{x},t)$ from a Poisson equation and applying $\\boldsymbol{B}\\leftarrow\\boldsymbol{B}-\\nabla\\phi$. Constrained Transport (CT) methods update face-centered magnetic fluxes using edge-centered electric fields in a way that preserves a discrete divergence-free condition.\n\nStarting from the above fundamental laws and facts, perform the following:\n\n- Derive the boundary condition at the perfectly conducting wall that ensures the normal magnetic component $\\,\\boldsymbol{n}\\cdot\\boldsymbol{B}\\,$ remains fixed in time at the wall.\n- Using the GLM cleaning equations, derive the boundary condition on the scalar cleaning field $\\psi$ that is sufficient to enforce $\\partial_{t}(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$ at the wall.\n- Show, for the elliptic projection cleaning, what boundary condition on the projection potential $\\phi$ preserves the value of $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ at the wall after the correction $\\boldsymbol{B}\\leftarrow\\boldsymbol{B}-\\nabla\\phi$.\n- Explain, in words grounded by the above derivations, how Constrained Transport (CT), GLM, and elliptic projection cleaning enforce or respect the constraint $\\,\\boldsymbol{n}\\cdot\\boldsymbol{B}\\,$ fixed at perfectly conducting walls in practice.\n\nYour final reported answer must be the single analytic expression for the boundary condition on $\\psi$ at the wall that enforces $\\partial_{t}(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$. No numerical evaluation is required, and no units should be included in the final reported expression. Define $\\partial_{n}$ to mean $\\boldsymbol{n}\\cdot\\nabla$.",
            "solution": "The problem statement is a valid exercise in theoretical and computational magnetohydrodynamics (MHD). It is scientifically grounded, well-posed, and objective. All necessary equations, definitions, and boundary conditions are provided to perform the requested derivations and explanations. The problem is free of the invalidating flaws listed in the instructions. We may therefore proceed with the solution.\n\nThe problem asks for four interrelated derivations and explanations concerning the behavior of the magnetic field at a stationary, perfectly conducting wall in ideal MHD, particularly in the context of numerical divergence cleaning methods.\n\nFirst, we derive the temporal behavior of the normal magnetic field component, $\\boldsymbol{n}\\cdot\\boldsymbol{B}$, at the wall based on fundamental laws. The rate of change of $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ is given by $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})$. Since the wall is stationary, the outward unit normal vector $\\boldsymbol{n}$ is constant in time, so we have:\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = \\boldsymbol{n}\\cdot\\partial_t\\boldsymbol{B}\n$$\nFrom Maxwell–Faraday’s law of induction, $\\partial_t\\boldsymbol{B} = -\\nabla\\times\\boldsymbol{E}$. Substituting this into the previous equation gives:\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = -\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{E})\n$$\nWe can use the vector identity $\\nabla\\cdot(\\boldsymbol{A}\\times\\boldsymbol{C}) = \\boldsymbol{C}\\cdot(\\nabla\\times\\boldsymbol{A}) - \\boldsymbol{A}\\cdot(\\nabla\\times\\boldsymbol{C})$. Letting $\\boldsymbol{A}=\\boldsymbol{E}$ and $\\boldsymbol{C}=\\boldsymbol{n}$ (where $\\boldsymbol{n}$ is a constant vector field in the context of derivatives with respect to position on the boundary), we have $\\nabla\\times\\boldsymbol{n} = \\boldsymbol{0}$. Thus, the identity simplifies to $\\nabla\\cdot(\\boldsymbol{E}\\times\\boldsymbol{n}) = -\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{E})$. This relation is also known as the tangential part of Stokes' theorem, where $\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{E})$ represents the surface curl of the tangential component of $\\boldsymbol{E}$. Therefore, we can write:\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = \\nabla\\cdot(\\boldsymbol{E}\\times\\boldsymbol{n})\n$$\nThe boundary is a perfectly conducting wall, where the tangential component of the electric field vanishes, i.e., $\\boldsymbol{n}\\times\\boldsymbol{E}=\\boldsymbol{0}$. This is equivalent to $\\boldsymbol{E}\\times\\boldsymbol{n} = - (\\boldsymbol{n}\\times\\boldsymbol{E}) = \\boldsymbol{0}$. Since the vector field $\\boldsymbol{E}\\times\\boldsymbol{n}$ is identically zero everywhere on the boundary surface, its surface divergence, $\\nabla\\cdot(\\boldsymbol{E}\\times\\boldsymbol{n})$, must also be zero. Consequently:\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = 0\n$$\nThis demonstrates that the fundamental laws of ideal MHD and the boundary condition at a perfectly conducting wall naturally imply that the normal component of the magnetic field at the wall is constant in time.\n\nSecond, we analyze the Generalized Lagrange Multiplier (GLM) cleaning method. The modified induction equation is:\n$$\n\\partial_{t}\\boldsymbol{B}+\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})+\\nabla\\psi=\\boldsymbol{0}\n$$\nWe wish to find a boundary condition on the scalar field $\\psi$ that enforces $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$ at the stationary wall. Taking the dot product of the GLM equation with $\\boldsymbol{n}$ yields:\n$$\n\\boldsymbol{n}\\cdot\\partial_t\\boldsymbol{B} + \\boldsymbol{n}\\cdot(\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})) + \\boldsymbol{n}\\cdot\\nabla\\psi = 0\n$$\nTo enforce $\\boldsymbol{n}\\cdot\\partial_t\\boldsymbol{B} = \\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = 0$, we require:\n$$\n\\boldsymbol{n}\\cdot(\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})) + \\boldsymbol{n}\\cdot\\nabla\\psi = 0\n$$\nAt the wall, the fluid velocity is zero, $\\boldsymbol{v}=\\boldsymbol{0}$. Therefore, the vector field $\\boldsymbol{F} = \\boldsymbol{v}\\times\\boldsymbol{B}$ is identically zero on the boundary surface. The term $\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{F})$ evaluated at a surface where $\\boldsymbol{F}=\\boldsymbol{0}$ is zero. This can be seen from the identity $\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{F}) = \\nabla_S \\cdot (\\boldsymbol{F} \\times \\boldsymbol{n})$, where $\\nabla_S \\cdot$ is the surface divergence operator. Since $\\boldsymbol{F}=\\boldsymbol{0}$ on the surface, $\\boldsymbol{F}\\times\\boldsymbol{n}=\\boldsymbol{0}$ on the surface, and its surface divergence is also zero. Thus, the condition reduces to:\n$$\n\\boldsymbol{n}\\cdot\\nabla\\psi = 0\n$$\nUsing the provided definition for the normal derivative, $\\partial_n \\equiv \\boldsymbol{n}\\cdot\\nabla$, the required boundary condition on $\\psi$ is a homogeneous Neumann condition:\n$$\n\\partial_n\\psi = 0\n$$\n\nThird, we consider the elliptic projection method. After a time step, the magnetic field, which may have acquired some numerical divergence, is denoted $\\boldsymbol{B}_{\\text{old}}$. It is corrected by subtracting the gradient of a scalar potential $\\phi$:\n$$\n\\boldsymbol{B}_{\\text{new}} \\leftarrow \\boldsymbol{B}_{\\text{old}} - \\nabla\\phi\n$$\nwhere $\\phi$ is found by solving the Poisson equation $\\nabla^2\\phi = \\nabla\\cdot\\boldsymbol{B}_{\\text{old}}$. We want to find the boundary condition on $\\phi$ that preserves the normal component of the magnetic field at the wall, i.e., $\\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{new}} = \\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{old}}$. Taking the dot product of the correction step with $\\boldsymbol{n}$ gives:\n$$\n\\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{new}} = \\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{old}} - \\boldsymbol{n}\\cdot\\nabla\\phi\n$$\nFor the normal component to be preserved, we must have $\\boldsymbol{n}\\cdot\\nabla\\phi = 0$. Again, using the definition of the normal derivative, this leads to the homogeneous Neumann boundary condition for the projection potential $\\phi$:\n$$\n\\partial_n\\phi = 0\n$$\n\nFourth, we provide a comparative explanation of how the three methods handle the constraint $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$.\n- **Constrained Transport (CT)** methods are designed to preserve a discrete version of $\\nabla\\cdot\\boldsymbol{B}=0$ to machine precision. They do this by updating face-centered magnetic fields using edge-centered electric fields, in a way that mimics Stokes' theorem. At a perfectly conducting wall, the physical boundary condition is that the tangential electric field is zero. In a CT scheme, this means setting the edge-centered electric fields on the wall boundary to zero. The update for the normal magnetic field component on a wall face depends on the line integral of these edge electric fields. Since they are all zero, the time derivative of the normal magnetic flux is exactly zero. Thus, CT enforces $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$ intrinsically and exactly as a direct consequence of its formulation and the implementation of the physical boundary condition.\n- **Generalized Lagrange Multiplier (GLM)** does not intrinsically preserve the condition. As derived above, to enforce $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$ at a wall where $\\boldsymbol{v}=\\boldsymbol{0}$, one must explicitly impose a homogeneous Neumann boundary condition, $\\partial_n\\psi=0$, for the scalar cleaning field $\\psi$. This condition ensures that the corrective term $\\nabla\\psi$ has no component normal to the wall, and therefore does not alter $\\boldsymbol{n}\\cdot\\boldsymbol{B}$. The divergence cleaning mechanism is thus forced to operate only tangentially at the boundary.\n- **Elliptic Projection** is a corrective, not a preventative, method. It is applied after a time step to remove any accumulated divergence. As shown in our derivation, to preserve the physically-constant value of $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ at the wall during this correction, the Poisson equation for the potential $\\phi$ must be solved with a homogeneous Neumann boundary condition, $\\partial_n\\phi = 0$. This ensures the corrective field $-\\nabla\\phi$ is purely tangential at the wall, so the projection only modifies the tangential components of $\\boldsymbol{B}$ there, leaving the normal component untouched.\n\nIn summary, CT enforces the constraint by its fundamental structure, while GLM and elliptic projection require the explicit imposition of a homogeneous Neumann boundary condition on their respective scalar potentials ($\\psi$ and $\\phi$) to respect the physical constraint at a perfectly conducting wall.",
            "answer": "$$\n\\boxed{\\partial_n \\psi = 0}\n$$"
        }
    ]
}