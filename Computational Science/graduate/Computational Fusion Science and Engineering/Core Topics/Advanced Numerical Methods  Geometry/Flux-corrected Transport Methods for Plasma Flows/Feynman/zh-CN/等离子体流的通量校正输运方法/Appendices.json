{
    "hands_on_practices": [
        {
            "introduction": "为了领会通量修正方法的精髓，我们必须首先理解它旨在修正的误差。本练习将使用修正方程分析法，揭示像一阶迎风格式这类简单、稳定格式中所隐藏的“数值扩散”项。通过这个分析，我们能从根本上理解为何需要发展通量修正输运（FCT）方法来处理等离子体流动问题 。",
            "id": "3981250",
            "problem": "考虑一个一维被动标量场 $u(x,t)$，它代表在一个简化的静电机制中，由一个恒定的漂移速度 $a$ 沿着一个沿场向直线坐标 $x$ 平流的归一化等离子体密度。其控制输运方程为线性平流方程 $u_{t} + a\\,u_{x} = 0$。在通量修正输运（FCT）中，一个单调低阶基本格式通常由空间上的一阶迎风离散和时间上的显式向前欧拉更新提供。令 $\\Delta x$ 为均匀网格间距，$\\Delta t$ 为时间步长，并假设 $u(x,t)$ 足够光滑。\n\n在均匀网格上，根据 $a$ 的符号使用适当的迎风模板来定义一阶迎风法。从连续方程和离散更新出发，对 $\\Delta x$ 和 $\\Delta t$ 进行修正方程分析至主导非平凡阶，该分析需与一个稳定的 Courant-Friedrichs-Lewy (CFL) 数相符。推导该格式所求解的主阶偏微分方程，其形式为 $u_{t} + a\\,u_{x} = D_{\\text{num}}\\,u_{xx} + \\text{高阶项}$，并找出数值扩散系数 $D_{\\text{num}}$ 作为 $a$、$\\Delta x$ 和 $\\Delta t$ 的函数的解析表达式。\n\n将最终的 $D_{\\text{num}}$ 表示为单个闭式解析表达式。由于答案是符号形式，最终表达式中不包含物理单位。无需四舍五入。",
            "solution": "用户要求我对一阶迎风格式进行修正方程分析。我已经验证了问题，现在开始解答。\n\n问题始于一维被动标量场 $u(x,t)$ 的线性平流方程：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $u_t = \\frac{\\partial u}{\\partial t}$ 且 $u_x = \\frac{\\partial u}{\\partial x}$。速度 $a$ 是一个常数。待分析的数值格式是空间上的一阶迎风法与时间上的向前欧拉法相结合。计算网格是均匀的，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。我们将网格点 $x_j = j\\Delta x$ 和时间 $t_n = n\\Delta t$ 上的离散解记为 $u_j^n \\equiv u(x_j, t_n)$。\n\n项 $u_t$ 的向前欧拉时间离散由下式给出：\n$$\nu_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n空间导数项 $a\\,u_x$ 的一阶迎风离散取决于平流速度 $a$ 的符号。“迎风”方向是信息流动的来源方向。\n\n情况1：$a > 0$\n如果速度 $a$ 为正，则流动方向为从左到右。迎风方向是左侧，因此我们对空间导数使用后向差分：\n$$\nu_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n$$\n结合时间和空间离散，得到完整的更新方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0\n$$\n\n为了进行修正方程分析，我们对离散方程中的每一项围绕点 $(x_j, t_n)$ 进行泰勒级数展开。如前所述，我们假设 $u(x,t)$ 足够光滑。展开式为：\n$$\nu_j^{n+1} = u(x_j, t_n + \\Delta t) = u_j^n + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\nu_{j-1}^n = u(x_j - \\Delta x, t_n) = u_j^n - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}((\\Delta x)^4)\n$$\n此处，$u$ 及其偏导数 $u_t$、$u_{tt}$、$u_x$、$u_{xx}$ 等都在点 $(x_j, t_n)$ 处取值。\n\n将这些展开式代入 $a > 0$ 的离散方程中：\n$$\n\\frac{1}{\\Delta t} \\left( \\left( u_j^n + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\right) - u_j^n \\right) + \\frac{a}{\\Delta x} \\left( u_j^n - \\left( u_j^n - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) \\right) = 0\n$$\n简化代数运算：\n$$\n\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x} \\left( \\Delta x u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) = 0\n$$\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + a u_x - \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta t^2, (\\Delta x)^2) = 0\n$$\n重新整理以匹配原始偏微分方程的形式，我们得到该格式实际求解的修正方程：\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\dots\n$$\n等式右边代表主阶截断误差。为了将此误差表达为所要求的形式，我们必须消去时间导数 $u_{tt}$，用空间导数来代替。我们可以对原始偏微分方程 $u_t = -a u_x$ 求导来找到这种关系。\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} (u_t) = \\frac{\\partial}{\\partial t} (-a u_x) = -a \\frac{\\partial^2 u}{\\partial t \\partial x} = -a \\frac{\\partial}{\\partial x} (u_t) = -a \\frac{\\partial}{\\partial x} (-a u_x) = a^2 u_{xx}\n$$\n将 $u_{tt} = a^2 u_{xx}$ 代入修正方程：\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\text{高阶项}\n$$\n$$\nu_t + a u_x = \\left( \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + \\text{H.O.T.}\n$$\n因此，对于 $a>0$，数值扩散系数为 $D_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$。\n\n情况2：$a  0$\n如果速度 $a$ 为负，则流动方向为从右到左。迎风方向是右侧，因此我们对空间导数使用前向差分：\n$$\nu_x \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}\n$$\n完整的更新方程为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_{j+1}^n - u_j^n}{\\Delta x} \\right) = 0\n$$\n$u_{j+1}^n$ 的泰勒展开式为：\n$$\nu_{j+1}^n = u(x_j + \\Delta x, t_n) = u_j^n + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}((\\Delta x)^4)\n$$\n将 $u_j^{n+1}$ 和 $u_{j+1}^n$ 的展开式代入 $a  0$ 的离散方程中：\n$$\n\\frac{1}{\\Delta t} \\left( \\left( u_j^n + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\right) - u_j^n \\right) + \\frac{a}{\\Delta x} \\left( \\left( u_j^n + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) - u_j^n \\right) = 0\n$$\n简化：\n$$\n\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x} \\left( \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) = 0\n$$\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + a u_x + \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta t^2, (\\Delta x)^2) = 0\n$$\n修正方程为：\n$$\nu_t + a u_x = -\\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\dots\n$$\n再次代入 $u_{tt} = a^2 u_{xx}$：\n$$\nu_t + a u_x = -\\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\text{H.O.T.}\n$$\n$$\nu_t + a u_x = \\left( -\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + \\text{H.O.T.}\n$$\n因此，对于 $a0$，数值扩散系数为 $D_{\\text{num}} = -\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$。\n\n$D_{\\text{num}}$ 的通用表达式\n我们可以使用绝对值函数 $|a|$ 将 $a > 0$ 和 $a  0$ 的结果合并为一个表达式。\n对于 $a > 0$，我们有 $|a| = a$，因此 $D_{\\text{num}} = \\frac{|a| \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$。\n对于 $a  0$，我们有 $|a| = -a$，因此 $D_{\\text{num}} = -\\frac{(-|a|) \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} = \\frac{|a| \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$。\n两种情况得出相同的公式。因此，数值扩散系数的通用表达式为：\n$$\nD_{\\text{num}} = \\frac{1}{2} \\left( |a| \\Delta x - a^2 \\Delta t \\right)\n$$\n这也可以用库朗数 $C = \\frac{|a|\\Delta t}{\\Delta x}$ 表示为 $D_{\\text{um}} = \\frac{1}{2} |a| \\Delta x (1 - C)$。该格式的稳定性条件是 $0 \\le C \\le 1$，这确保了 $D_{\\text{num}} \\ge 0$，与耗散（稳定化）的数值误差相符。主阶误差项在系统中引入了人工扩散，这是一阶迎风格式的一个典型特征。",
            "answer": "$$\n\\boxed{\\frac{1}{2}(|a|\\Delta x - a^2\\Delta t)}\n$$"
        },
        {
            "introduction": "通量修正输运（FCT）算法始于一个稳健的低阶解，该解必须保证物理上的合理性（例如，密度非负）。这要求满足特定的稳定性条件。本练习将引导你推导一个时间步长约束（即CFL条件），它能保证一个常用的低阶格式（Rusanov或局部Lax-Friedrichs格式）具有这种至关重要的“单调性”，从而为后续的修正步骤奠定坚实的基础 。",
            "id": "3981265",
            "problem": "在计算聚变科学与工程中，由双曲守恒律控制的等离子体流的显式高分辨率模拟通常采用通量修正输运 (FCT) 作为一种非线性稳定化策略，其中一个可证明单调的低阶格式与受限的反扩散修正相混合。考虑一个用于等离子体模型（如磁流体力学 (MHD)）的通用多维双曲守恒律，其守恒形式写作 $$\\partial_{t}\\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0},$$ 其中 $\\boldsymbol{U}$ 表示守恒变量向量，$\\boldsymbol{F}(\\boldsymbol{U})$ 表示物理通量。设在由控制体（单元）$K_{i}$ 构成的网格剖分上定义一个有限体积离散，控制体体积为 $V_{i}$，边界面为 $f \\in \\partial K_{i}$，其面积为 $A_{f}$，外单位法向量为 $\\boldsymbol{n}_{f}$。一个显式更新可写为 $$\\boldsymbol{U}_{i}^{n+1} = \\boldsymbol{U}_{i}^{n} - \\frac{\\Delta t}{V_{i}} \\sum_{f \\in \\partial K_{i}} A_{f} \\,\\boldsymbol{\\mathcal{F}}_{f}^{n},$$ 其中 $\\boldsymbol{\\mathcal{F}}_{f}^{n}$ 是在时间层 $n$ 穿过面 $f$ 的一个相容的数值通量。假设低阶数值通量为局部 Lax–Friedrichs (LLF) 通量，也称为 Rusanov 通量，其在面 $f$ 上的耗散参数选择为 $$\\alpha_{f} = \\lambda_{\\max,f},$$ 即在适当的局部状态下计算的与法向通量雅可比矩阵 $A_{n_{f}}(\\boldsymbol{U}) = \\partial (\\boldsymbol{F}(\\boldsymbol{U}) \\cdot \\boldsymbol{n}_{f}) / \\partial \\boldsymbol{U}$ 相关联的最大绝对特征速度，并用 $\\lambda_{\\max}$ 表示在所有面和单元上 $\\lambda_{\\max,f}$ 的一个一致上界。在多维显式格式的 Courant–Friedrichs–Lewy (CFL) 稳定性的背景下，用 $\\lambda_{\\max}$ 和网格度量来定义 CFL 条件，并从上述守恒形式、基于面的有限体积更新以及 LLF 通量构造出发，推导出一个充分的时间步长限制。该限制需保证每个单元中的低阶更新是其自身状态和相邻状态的凸组合（低阶单调性），从而适用于通量修正输运 (FCT)。假设在一个 $d$ 维空间中的均匀笛卡尔网格，其沿坐标方向的间距为 $\\Delta x_{1}, \\dots, \\Delta x_{d}$，并且最大法向波速满足对所有面都有 $|\\lambda_{\\max,f}| \\le \\lambda_{\\max}$。请以单个闭式解析表达式的形式，给出在该均匀网格上最大允许显式时间步长 $\\Delta t_{\\max}$ 的最终答案，该表达式用 $\\lambda_{\\max}$ 和 $\\Delta x_{1}, \\dots, \\Delta x_{d}$ 表示。无需进行数值计算。",
            "solution": "问题陈述是计算物理学领域一个良定的理论练习，具体涉及双曲守恒律的数值解。它要求为一种广泛使用的数值格式推导稳定性条件。\n\n### 步骤1：问题验证\n\n**提取的已知条件：**\n1.  **控制方程：** 一个多维双曲守恒律，其守恒形式为：$$\\partial_{t}\\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$$\n2.  **有限体积更新：** 控制体 $K_{i}$（体积为 $V_{i}$）中单元平均状态 $\\boldsymbol{U}_{i}$ 的显式时间更新：$$\\boldsymbol{U}_{i}^{n+1} = \\boldsymbol{U}_{i}^{n} - \\frac{\\Delta t}{V_{i}} \\sum_{f \\in \\partial K_{i}} A_{f} \\,\\boldsymbol{\\mathcal{F}}_{f}^{n}$$\n3.  **低阶通量：** 局部 Lax–Friedrichs (LLF) 或 Rusanov 通量被用作低阶数值通量 $\\boldsymbol{\\mathcal{F}}_{f}$。\n4.  **耗散参数：** 在面 $f$ 上，LLF 通量的耗散为 $\\alpha_{f} = \\lambda_{\\max,f}$，其中 $\\lambda_{\\max,f}$ 是与法向通量雅可比矩阵 $A_{n_{f}}(\\boldsymbol{U}) = \\partial (\\boldsymbol{F}(\\boldsymbol{U}) \\cdot \\boldsymbol{n}_{f}) / \\partial \\boldsymbol{U}$ 相关的最大绝对特征速度。\n5.  **波速界：** 存在一个一致上界 $\\lambda_{\\max}$，使得对所有面都有 $|\\lambda_{\\max,f}| \\le \\lambda_{\\max}$。\n6.  **网格几何：** 一个 $d$ 维空间中的均匀笛卡尔网格，坐标间距为 $\\Delta x_{1}, \\dots, \\Delta x_{d}$。\n7.  **目标：** 推导一个充分的时间步长限制 $\\Delta t_{\\max}$，该限制要确保每个单元的低阶更新是其自身状态和相邻状态的凸组合，并用 $\\lambda_{\\max}$ 和网格间距表示。\n\n**验证结论：**\n该问题是**有效的**。它在科学上植根于已建立的偏微分方程数值方法理论。问题是良定的，为推导提供了所有必要的信息。术语精确客观。该任务是计算流体力学和磁流体力学领域一个标准的、不平凡的推导。\n\n### 步骤2：时间步长限制的推导\n\n单元 $i$ 的更新是其自身状态及其相邻单元状态的凸组合，这一条件是保证低阶格式单调（或对于系统是保正的）的充分条件，也是 FCT 方法的一个关键要求。对于非线性系统，可以通过考察更新函数的雅可比矩阵来分析此属性。\n\n设单元 $i$ 的更新写为其模板中（单元 $i$ 及其紧邻单元 $j \\in N(i)$）各状态的函数 $\\boldsymbol{G}_{i}$：\n$$\\boldsymbol{U}_{i}^{n+1} = \\boldsymbol{G}_{i}(\\boldsymbol{U}_{i}^{n}, \\{\\boldsymbol{U}_{j}^{n}\\}_{j \\in N(i)})$$\n为使格式单调，$\\boldsymbol{G}_{i}$ 对其每个参数的雅可比矩阵为半正定矩阵是充分条件（或者对于标量问题，偏导数非负）。凸组合的条件意味着这些雅可比矩阵之和为单位矩阵，即 $\\sum_{k \\in \\{i\\} \\cup N(i)} \\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{k}} = I$。\n\nLLF 格式在分隔单元 $i$（左态）和单元 $j$（右态）的面 $f_{ij}$ 处的数值通量为（法向量 $\\boldsymbol{n}_{ij}$ 从单元 $i$ 指出）：\n$$\\boldsymbol{\\mathcal{F}}_{f_{ij}}(\\boldsymbol{U}_{i}, \\boldsymbol{U}_{j}) = \\frac{1}{2} \\left[ \\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\boldsymbol{n}_{ij} + \\boldsymbol{F}(\\boldsymbol{U}_{j}) \\cdot \\boldsymbol{n}_{ij} \\right] - \\frac{1}{2} \\alpha_{ij} (\\boldsymbol{U}_{j} - \\boldsymbol{U}_{i})$$\n其中 $\\alpha_{ij} = \\lambda_{\\max, f_{ij}}$。更新函数 $\\boldsymbol{G}_{i}$ 为：\n$$\\boldsymbol{G}_{i} = \\boldsymbol{U}_{i} - \\frac{\\Delta t}{V_{i}} \\sum_{j \\in N(i)} A_{ij} \\boldsymbol{\\mathcal{F}}_{f_{ij}}(\\boldsymbol{U}_{i}, \\boldsymbol{U}_{j})$$\n\n我们分析 $\\boldsymbol{G}_i$ 相对于 $\\boldsymbol{U}_i$ 的雅可比矩阵：\n$$\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}} = I - \\frac{\\Delta t}{V_{i}} \\sum_{j \\in N(i)} A_{ij} \\frac{\\partial \\boldsymbol{\\mathcal{F}}_{f_{ij}}}{\\partial \\boldsymbol{U}_{i}}$$\n通量相对于 $\\boldsymbol{U}_{i}$ 的导数为：\n$$\\frac{\\partial \\boldsymbol{\\mathcal{F}}_{f_{ij}}}{\\partial \\boldsymbol{U}_{i}} = \\frac{1}{2} \\frac{\\partial (\\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\boldsymbol{n}_{ij})}{\\partial \\boldsymbol{U}_{i}} - \\frac{1}{2} \\alpha_{ij} \\frac{\\partial(\\boldsymbol{U}_{j} - \\boldsymbol{U}_{i})}{\\partial \\boldsymbol{U}_{i}} = \\frac{1}{2} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) + \\frac{1}{2} \\alpha_{ij} I$$\n其中 $A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i})$ 是关于法向量 $\\boldsymbol{n}_{ij}$ 的通量雅可比矩阵。将此代入 $\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}}$ 的表达式中：\n$$\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}} = I - \\frac{\\Delta t}{V_{i}} \\sum_{j \\in N(i)} A_{ij} \\left[ \\frac{1}{2} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) + \\frac{1}{2} \\alpha_{ij} I \\right]$$\n$$ = I - \\frac{\\Delta t}{2V_{i}} \\left( \\sum_{j \\in N(i)} A_{ij} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) \\right) - \\frac{\\Delta t}{2V_{i}} \\left( \\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} \\right) I$$\n对于任何闭合控制体 $K_i$，一个关键的几何恒等式是，面面积加权的外法向量之和为零：$\\sum_{f \\in \\partial K_i} A_f \\boldsymbol{n}_f = \\boldsymbol{0}$。这可以推广到通量雅可比项：\n$$\\sum_{j \\in N(i)} A_{ij} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) = \\sum_{j \\in N(i)} A_{ij} \\frac{\\partial (\\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\boldsymbol{n}_{ij})}{\\partial \\boldsymbol{U}_{i}} = \\frac{\\partial}{\\partial \\boldsymbol{U}_{i}} \\left( \\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\sum_{j \\in N(i)} A_{ij} \\boldsymbol{n}_{ij} \\right) = \\frac{\\partial}{\\partial \\boldsymbol{U}_{i}} (\\boldsymbol{0}) = \\boldsymbol{0}$$\n因此，雅可比矩阵简化为单位矩阵的标量倍：\n$$\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}} = \\left( 1 - \\frac{\\Delta t}{2V_{i}} \\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} \\right) I$$\n为使“凸组合”中 $\\boldsymbol{U}_{i}$ 的系数非负，该标量乘子必须非负：\n$$1 - \\frac{\\Delta t}{2V_{i}} \\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} \\ge 0$$\n这就得出了时间步长限制：\n$$\\Delta t \\le \\frac{2V_{i}}{\\sum_{j \\in N(i)} A_{ij} \\alpha_{ij}}$$\n（相邻单元系数的条件 $\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{j}} \\ge 0$ 也得到满足，因为选择 $\\alpha_{ij}$ 作为最大绝对特征值，使得矩阵 $(\\alpha_{ij}I - A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_j))$ 是半正定的）。\n\n现在我们将这个一般结果应用于指定的网格。对于一个 $d$ 维空间中、间距为 $\\Delta x_{1}, \\dots, \\Delta x_{d}$ 的均匀笛卡尔网格，一个单元 $i$ 是一个体积为 $V_i = \\prod_{k=1}^{d} \\Delta x_{k}$ 的超矩形。单元 $i$ 有 $2d$ 个相邻单元，每个坐标轴 $k \\in \\{1, \\dots, d\\}$ 方向上各有两个。将单元 $i$ 与其在 $+x_k$ 方向上的相邻单元分隔开的面的面积为 $A_k = V_i / \\Delta x_k$，法向量为 $\\boldsymbol{e}_k$。在 $-x_k$ 方向上相邻单元的面的面积同样为 $A_k$，法向量为 $-\\boldsymbol{e}_k$。\n\n时间步长限制分母中的求和项变为：\n$$\\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} = \\sum_{k=1}^{d} \\left( A_k \\alpha_{f_{k}^{+}} + A_k \\alpha_{f_{k}^{-}} \\right)$$\n其中 $f_{k}^{+}$ 和 $f_{k}^{-}$ 是在 $\\pm x_k$ 方向上的面。耗散参数 $\\alpha_f$ 是相应法向方向上的最大绝对特征速度。设 $\\lambda_{\\max}^{(k)}$ 为第 $k$ 个坐标方向上的最大速度。由于 $\\alpha_f$ 基于特征值的绝对值，$\\alpha_{f_{k}^{+}}$ 和 $\\alpha_{f_{k}^{-}}$ 都可以用与 $k$ 方向传播相关的同一个值来界定。为了获得整个模拟域的单个、鲁棒的时间步长，我们使用全局上界 $\\lambda_{\\max}$，该值已知大于或等于任何局部波速 $\\alpha_{ij}$：\n$$\\alpha_{ij} \\le \\lambda_{\\max} \\quad \\forall i, j$$\n因此，通过将 $\\alpha_{ij}$ 替换为 $\\lambda_{\\max}$，可以获得一个充分条件：\n$$\\Delta t \\le \\frac{2V_{i}}{\\sum_{j \\in N(i)} A_{ij} \\lambda_{\\max}} = \\frac{2V_{i}}{\\lambda_{\\max} \\sum_{j \\in N(i)} A_{ij}}$$\n超矩形单元的所有面面积之和为：\n$$\\sum_{j \\in N(i)} A_{ij} = \\sum_{k=1}^{d} (A_k + A_k) = 2 \\sum_{k=1}^{d} A_k = 2 \\sum_{k=1}^{d} \\frac{V_i}{\\Delta x_k} = 2V_i \\sum_{k=1}^{d} \\frac{1}{\\Delta x_k}$$\n将此代入时间步长不等式：\n$$\\Delta t \\le \\frac{2V_{i}}{\\lambda_{\\max} \\left( 2V_i \\sum_{k=1}^{d} \\frac{1}{\\Delta x_k} \\right)} = \\frac{1}{\\lambda_{\\max} \\sum_{k=1}^{d} \\frac{1}{\\Delta x_k}}$$\n这就给出了在给定网格上，满足 LLF 格式单调性条件的最大允许时间步长 $\\Delta t_{\\max}$。",
            "answer": "$$\\boxed{\\frac{1}{\\lambda_{\\max} \\sum_{k=1}^{d} \\frac{1}{\\Delta x_{k}}}}$$"
        },
        {
            "introduction": "在获得一个带有数值扩散的低阶解之后，FCT方法的“魔力”在于施加一个修正项，该修正项既能锐化特征，又不会产生新的、非物理的振荡。这通过一个“限制器”（limiter）来实现。最后一个练习将提供一个关于限制器的动手计算，演示如何利用物理边界来约束修正性的“反扩散通量”，从而确保最终解兼具高精度和稳健性 。",
            "id": "3981228",
            "problem": "考虑托卡马克边缘等离子体中沿磁力线坐标 $s$ 的标量离子数密度 $n(s,t)$ 的一维有限体积离散化。对于由给定平行流 $u(s,t)$ 平流且无源的被动标量，其控制守恒律为\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial s}\\big(n u\\big) = 0.\n$$\n在一个时间步长 $\\Delta t$ 内，一个低阶、保正的输运更新在共享一个界面的相邻单元 $i$ 和 $j$ 中产生单元平均值 $n_{i}^{L}$ 和 $n_{j}^{L}$。然后，通量修正输运（FCT）方法中的高阶修正阶段在界面间形成成对的反扩散质量通量，以恢复精度，同时强制执行物理上允许的界限。\n\n我们关注单元 $i$ 和 $j$ 之间的一个单一界面，在该时间步长内的原始反扩散质量传输表示为 $\\tilde{F}_{ij}$，并采用符号约定，$\\tilde{F}_{ij} > 0$ 表示质量从单元 $j$ 传输到单元 $i$。单元体积为 $V_{i}$ 和 $V_{j}$。每个单元的物理允许界限由下界 $n_{k}^{\\min}$ 和上界 $n_{k}^{\\max}$ 指定，其中 $k\\in\\{i,j\\}$。低阶更新满足 $n_{k}^{\\min} \\le n_{k}^{L} \\le n_{k}^{\\max}$。\n\n科学真实性要求反扩散通量的限制器必须从第一性原理导出：每个有限体积内的质量守恒、添加反扩散修正后 $n_{k}$ 不能超过 $n_{k}^{\\max}$ 或低于 $n_{k}^{\\min}$ 的有界性约束，以及一种通过基于节点“蓄水池”容量（根据允许界限与低阶解之差计算得出）限制反扩散通量来确保不违反这些界限的构造方法。\n\n给定以下关于该界面的物理一致数据：\n- 单元体积：$V_{i} = 2.0\\times 10^{-6}\\ \\mathrm{m}^{3}$，$V_{j} = 3.0\\times 10^{-6}\\ \\mathrm{m}^{3}$。\n- 低阶密度：$n_{i}^{L} = 3.2\\times 10^{19}\\ \\mathrm{m}^{-3}$，$n_{j}^{L} = 4.0\\times 10^{19}\\ \\mathrm{m}^{-3}$。\n- 允许界限：$n_{i}^{\\min} = 0$，$n_{i}^{\\max} = 3.5\\times 10^{19}\\ \\mathrm{m}^{-3}$；$n_{j}^{\\min} = 3.5\\times 10^{19}\\ \\mathrm{m}^{-3}$，$n_{j}^{\\max} = 4.2\\times 10^{19}\\ \\mathrm{m}^{-3}$。\n- 时间步长内的原始反扩散质量传输：$\\tilde{F}_{ij} = +1.2\\times 10^{13}$。\n\n从守恒律和有限体积更新的定义出发，推导由允许界限所隐含的节点接受和提供质量的“蓄水池”容量表达式，然后构建界面上允许的反扩散通量界限。利用这些界限，定义并计算边限制器 $\\alpha_{ij}$，其值为所需修正量与参与单元可用节点容量之比的最小值，并进一步限制其值不超过1。将无量纲的限制器值 $\\alpha_{ij}$ 作为最终答案报告。无需四舍五入。",
            "solution": "该问题要求计算应用于标量平流方程的通量修正输运（FCT）格式的限制器 $\\alpha_{ij}$。FCT方法旨在修正一个低阶、保正的解 $n_k^L$，以在不违反物理界限的情况下实现更高阶的精度。这是通过添加一个受限的反扩散通量来完成的。\n\n控制守恒律由下式给出：\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial s}\\big(n u\\big) = 0\n$$\n在有限体积框架中，单元 $k$（其中 $k \\in \\{i, j\\}$）中粒子数 $N_k = n_k V_k$ 从低阶状态 $N_k^L = n_k^L V_k$ 更新到新状态 $N_k^{\\text{new}} = n_k^{\\text{new}} V_k$ 是通过添加一个修正后的反扩散质量传输 $F_{ij}^{\\text{corrected}}$ 来执行的。问题指明，原始反扩散质量传输 $\\tilde{F}_{ij}$ 是从单元 $j$ 到单元 $i$ 的，因为其值为正，$\\tilde{F}_{ij} = +1.2 \\times 10^{13}  0$。\n\n单元对 $i$ 和 $j$ 的质量守恒决定了以下更新：\n$$\nN_i^{\\text{new}} = N_i^L + F_{ij}^{\\text{corrected}} \\quad \\implies \\quad n_i^{\\text{new}} V_i = n_i^L V_i + F_{ij}^{\\text{corrected}}\n$$\n$$\nN_j^{\\text{new}} = N_j^L - F_{ij}^{\\text{corrected}} \\quad \\implies \\quad n_j^{\\text{new}} V_j = n_j^L V_j - F_{ij}^{\\text{corrected}}\n$$\n修正后的反扩散通量通过限制器 $\\alpha_{ij}$ 与原始反扩散通量相关联：\n$$\nF_{ij}^{\\text{corrected}} = \\alpha_{ij} \\tilde{F}_{ij}\n$$\n新的密度必须满足规定的物理界限：\n$$\nn_k^{\\min} \\le n_k^{\\text{new}} \\le n_k^{\\max} \\quad \\text{for } k \\in \\{i, j\\}\n$$\n我们使用这些约束来推导 $F_{ij}^{\\text{corrected}}$ 的限制。\n\n对于接收质量的单元 $i$，其密度增加。上界提供了以下约束：\n$$\nn_i^{\\text{new}} \\le n_i^{\\max}\n$$\n$$\nn_i^L + \\frac{F_{ij}^{\\text{corrected}}}{V_i} \\le n_i^{\\max}\n$$\n$$\nF_{ij}^{\\text{corrected}} \\le (n_i^{\\max} - n_i^L) V_i\n$$\n右边的项 $P_i^+ = (n_i^{\\max} - n_i^L) V_i$ 代表单元 $i$ 在违反其上界之前可以接受的最大质量。这就是节点接受质量的“蓄水池”容量。\n\n对于提供质量的单元 $j$，其密度减少。下界提供了以下约束：\n$$\nn_j^{\\text{new}} \\ge n_j^{\\min}\n$$\n$$\nn_j^L - \\frac{F_{ij}^{\\text{corrected}}}{V_j} \\ge n_j^{\\min}\n$$\n$$\nF_{ij}^{\\text{corrected}} \\le (n_j^L - n_j^{\\min}) V_j\n$$\n右边的项 $Q_j^- = (n_j^L - n_j^{\\min}) V_j$ 代表单元 $j$ 在违反其下界之前可以提供的最大质量。这就是节点提供质量的“蓄水池”容量。\n\n修正后的通量 $F_{ij}^{\\text{corrected}}$ 必须同时满足两个约束。由于 $F_{ij}^{\\text{corrected}}  0$，我们有：\n$$\nF_{ij}^{\\text{corrected}} \\le \\min(P_i^+, Q_j^-)\n$$\n代入 $F_{ij}^{\\text{corrected}} = \\alpha_{ij} \\tilde{F}_{ij}$ 并已知 $\\tilde{F}_{ij}  0$：\n$$\n\\alpha_{ij} \\tilde{F}_{ij} \\le \\min(P_i^+, Q_j^-)\n$$\n$$\n\\alpha_{ij} \\le \\frac{\\min(P_i^+, Q_j^-)}{\\tilde{F}_{ij}} = \\min\\left(\\frac{P_i^+}{\\tilde{F}_{ij}}, \\frac{Q_j^-}{\\tilde{F}_{ij}}\\right)\n$$\n问题还指出限制器的值不能超过1，即 $\\alpha_{ij} \\le 1$。综合这些，限制器为：\n$$\n\\alpha_{ij} = \\min\\left(1, \\frac{P_i^+}{\\tilde{F}_{ij}}, \\frac{Q_j^-}{\\tilde{F}_{ij}}\\right)\n$$\n我们现在使用给定数据计算 $\\alpha_{ij}$ 的数值：\n- $V_{i} = 2.0 \\times 10^{-6}\\ \\mathrm{m}^{3}$\n- $V_{j} = 3.0 \\times 10^{-6}\\ \\mathrm{m}^{3}$\n- $n_{i}^{L} = 3.2 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $n_{j}^{L} = 4.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $n_{i}^{\\min} = 0$, $n_{i}^{\\max} = 3.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $n_{j}^{\\min} = 3.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $n_{j}^{\\max} = 4.2 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $\\tilde{F}_{ij} = 1.2 \\times 10^{13}$\n\n首先，计算蓄水池容量：\n单元 $i$ 接受质量的容量：\n$$\nP_i^+ = (n_i^{\\max} - n_i^L) V_i = (3.5 \\times 10^{19} - 3.2 \\times 10^{19}) \\times (2.0 \\times 10^{-6})\n$$\n$$\nP_i^+ = (0.3 \\times 10^{19}) \\times (2.0 \\times 10^{-6}) = 0.6 \\times 10^{13} = 6.0 \\times 10^{12}\n$$\n单元 $j$ 提供质量的容量：\n$$\nQ_j^- = (n_j^L - n_j^{\\min}) V_j = (4.0 \\times 10^{19} - 3.5 \\times 10^{19}) \\times (3.0 \\times 10^{-6})\n$$\n$$\nQ_j^- = (0.5 \\times 10^{19}) \\times (3.0 \\times 10^{-6}) = 1.5 \\times 10^{13}\n$$\n接下来，计算可用容量与原始反扩散质量传输的比率：\n接收单元 $i$ 的比率：\n$$\n\\frac{P_i^+}{\\tilde{F}_{ij}} = \\frac{6.0 \\times 10^{12}}{1.2 \\times 10^{13}} = \\frac{0.6 \\times 10^{13}}{1.2 \\times 10^{13}} = 0.5\n$$\n提供单元 $j$ 的比率：\n$$\n\\frac{Q_j^-}{\\tilde{F}_{ij}} = \\frac{1.5 \\times 10^{13}}{1.2 \\times 10^{13}} = \\frac{1.5}{1.2} = \\frac{5}{4} = 1.25\n$$\n最后，确定限制器 $\\alpha_{ij}$：\n$$\n\\alpha_{ij} = \\min(1, 0.5, 1.25)\n$$\n这些值的最小值是 $0.5$。\n$$\n\\alpha_{ij} = 0.5\n$$\n该限制器确保修正后的反扩散通量不会导致任何单元的密度违反其物理界限。具体来说，值为 $0.5$ 的限制器将原始通量减少到使接收单元 $i$ 的密度恰好达到其最大允许值 $n_i^{\\max}$ 的水平。",
            "answer": "$$\\boxed{0.5}$$"
        }
    ]
}