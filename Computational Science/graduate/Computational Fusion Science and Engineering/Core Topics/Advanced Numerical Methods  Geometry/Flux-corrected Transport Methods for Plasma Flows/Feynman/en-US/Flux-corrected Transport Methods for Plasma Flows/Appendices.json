{
    "hands_on_practices": [
        {
            "introduction": "To appreciate the design of Flux-Corrected Transport (FCT), we must first diagnose the problem it is built to solve: the inherent inaccuracies of simple, stable schemes. This practice employs modified equation analysis, a powerful technique that reveals the partial differential equation a numerical scheme *actually* solves, including its leading error terms. By analyzing the first-order upwind method—a common low-order base for FCT—you will discover that its principal error introduces an artificial diffusion, quantified by a numerical diffusion coefficient $D_{\\text{num}}$, which smears sharp gradients in plasma profiles .",
            "id": "3981250",
            "problem": "Consider a one-dimensional passive scalar field $u(x,t)$ representing a normalized plasma density being advected along a straight field-aligned coordinate $x$ by a constant drift velocity $a$ in a simplified electrostatic regime. The governing transport equation is the linear advection equation $u_{t} + a\\,u_{x} = 0$. In flux-corrected transport (FCT), a monotone low-order base scheme is typically provided by a first-order upwind discretization in space and an explicit forward Euler update in time. Let $\\Delta x$ be the uniform grid spacing, $\\Delta t$ be the time step, and assume $u(x,t)$ is sufficiently smooth.\n\nDefine the first-order upwind method on the uniform mesh using the appropriate upwind stencil for the sign of $a$. Starting from the continuous equation and the discrete update, perform a modified equation analysis to leading nontrivial order in $\\Delta x$ and $\\Delta t$ that is consistent with a stable Courant-Friedrichs-Lewy (CFL) number. Derive the leading-order partial differential equation that the scheme solves, written in the form $u_{t} + a\\,u_{x} = D_{\\text{num}}\\,u_{xx} + \\text{higher-order terms}$, and identify the analytic expression for the numerical diffusion coefficient $D_{\\text{num}}$ as a function of $a$, $\\Delta x$, and $\\Delta t$.\n\nExpress the final $D_{\\text{num}}$ as a single closed-form analytic expression. Since the answer is symbolic, do not include physical units in the final expression. No rounding is required.",
            "solution": "The user wants me to perform a modified equation analysis for a first-order upwind scheme. I have validated the problem and will now proceed with the solution.\n\nThe problem starts with the one-dimensional linear advection equation for a passive scalar field $u(x,t)$:\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nwhere $u_t = \\frac{\\partial u}{\\partial t}$ and $u_x = \\frac{\\partial u}{\\partial x}$. The velocity $a$ is a constant. The numerical scheme to be analyzed is a first-order upwind method in space combined with a forward Euler method in time. The computational grid is uniform with spacing $\\Delta x$ in space and $\\Delta t$ in time. We denote the discrete solution at grid point $x_j = j\\Delta x$ and time $t_n = n\\Delta t$ as $u_j^n \\equiv u(x_j, t_n)$.\n\nThe forward Euler time discretization of the term $u_t$ is given by:\n$$\nu_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\nThe first-order upwind discretization for the spatial derivative term $a\\,u_x$ depends on the sign of the advection velocity $a$. The \"upwind\" direction is the direction from which the information is flowing.\n\nCase 1: $a > 0$\nIf the velocity $a$ is positive, the flow is from left to right. The upwind direction is to the left, so we use a backward difference for the spatial derivative:\n$$\nu_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n$$\nCombining the time and space discretizations gives the full update equation:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0\n$$\n\nTo perform the modified equation analysis, we use Taylor series expansions for each term in the discrete equation around the point $(x_j, t_n)$. We assume $u(x,t)$ is sufficiently smooth, as stated. The expansions are:\n$$\nu_j^{n+1} = u(x_j, t_n + \\Delta t) = u_j^n + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\nu_{j-1}^n = u(x_j - \\Delta x, t_n) = u_j^n - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}((\\Delta x)^4)\n$$\nHere, $u$ and its partial derivatives $u_t$, $u_{tt}$, $u_x$, $u_{xx}$, etc., are all evaluated at $(x_j, t_n)$.\n\nSubstituting these expansions into the discrete equation for $a > 0$:\n$$\n\\frac{1}{\\Delta t} \\left( \\left( u_j^n + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\right) - u_j^n \\right) + \\frac{a}{\\Delta x} \\left( u_j^n - \\left( u_j^n - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) \\right) = 0\n$$\nSimplifying the algebra:\n$$\n\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x} \\left( \\Delta x u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) = 0\n$$\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + a u_x - \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta t^2, (\\Delta x)^2) = 0\n$$\nRearranging to match the form of the original PDE, we obtain the modified equation that the scheme actually solves:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\dots\n$$\nThe right-hand side represents the leading-order truncation error. To express this error in the requested form, we must eliminate the time derivative $u_{tt}$ in favor of spatial derivatives. We can differentiate the original PDE, $u_t = -a u_x$, to find the relationship.\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} (u_t) = \\frac{\\partial}{\\partial t} (-a u_x) = -a \\frac{\\partial^2 u}{\\partial t \\partial x} = -a \\frac{\\partial}{\\partial x} (u_t) = -a \\frac{\\partial}{\\partial x} (-a u_x) = a^2 u_{xx}\n$$\nSubstituting $u_{tt} = a^2 u_{xx}$ into the modified equation:\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\text{higher-order terms}\n$$\n$$\nu_t + a u_x = \\left( \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + \\text{H.O.T.}\n$$\nThus, for $a>0$, the numerical diffusion coefficient is $D_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$.\n\nCase 2: $a < 0$\nIf the velocity $a$ is negative, the flow is from right to left. The upwind direction is to the right, so we use a forward difference for the spatial derivative:\n$$\nu_x \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}\n$$\nThe full update equation is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_{j+1}^n - u_j^n}{\\Delta x} \\right) = 0\n$$\nThe Taylor expansion for $u_{j+1}^n$ is:\n$$\nu_{j+1}^n = u(x_j + \\Delta x, t_n) = u_j^n + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}((\\Delta x)^4)\n$$\nSubstituting the expansions for $u_j^{n+1}$ and $u_{j+1}^n$ into the discrete equation for $a < 0$:\n$$\n\\frac{1}{\\Delta t} \\left( \\left( u_j^n + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\right) - u_j^n \\right) + \\frac{a}{\\Delta x} \\left( \\left( u_j^n + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) - u_j^n \\right) = 0\n$$\nSimplifying:\n$$\n\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x} \\left( \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) = 0\n$$\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + a u_x + \\frac{a \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta t^2, (\\Delta x)^2) = 0\n$$\nThe modified equation is:\n$$\nu_t + a u_x = -\\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\dots\n$$\nAgain, substituting $u_{tt} = a^2 u_{xx}$:\n$$\nu_t + a u_x = -\\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\text{H.O.T.}\n$$\n$$\nu_t + a u_x = \\left( -\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + \\text{H.O.T.}\n$$\nThus, for $a<0$, the numerical diffusion coefficient is $D_{\\text{num}} = -\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$.\n\nGeneral Expression for $D_{\\text{num}}$\nWe can combine the results for $a > 0$ and $a < 0$ into a single expression using the absolute value function, $|a|$.\nFor $a > 0$, we have $|a| = a$, so $D_{\\text{num}} = \\frac{|a| \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$.\nFor $a < 0$, we have $|a| = -a$, so $D_{\\text{num}} = -\\frac{(-|a|) \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} = \\frac{|a| \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$.\nBoth cases yield the same formula. Therefore, the general expression for the numerical diffusion coefficient is:\n$$\nD_{\\text{num}} = \\frac{1}{2} \\left( |a| \\Delta x - a^2 \\Delta t \\right)\n$$\nThis can also be written in terms of the Courant number $C = \\frac{|a|\\Delta t}{\\Delta x}$ as $D_{\\text{num}} = \\frac{1}{2} |a| \\Delta x (1 - C)$. The stability condition for this scheme is $0 \\le C \\le 1$, which ensures that $D_{\\text{num}} \\ge 0$, consistent with a dissipative (stabilizing) numerical error. The leading-order error term introduces an artificial diffusion into the system, which is a characteristic feature of the first-order upwind scheme.",
            "answer": "$$\n\\boxed{\\frac{1}{2}(|a|\\Delta x - a^2\\Delta t)}\n$$"
        },
        {
            "introduction": "Having established that low-order schemes are overly diffusive, we now turn to the corrective mechanism at the heart of FCT: the flux limiter. The method computes a high-order, antidiffusive flux to counteract the numerical diffusion, but this correction must be carefully constrained to prevent non-physical oscillations. In this exercise, you will perform a concrete calculation of the FCT limiter for a plasma density transport problem, determining the maximum allowable antidiffusive flux based on the \"reservoir\" capacity of adjacent cells to donate or accept particles without violating physical bounds . This practice demystifies the core logic that ensures FCT's robustness and accuracy.",
            "id": "3981228",
            "problem": "Consider a one-dimensional finite-volume discretization along a magnetic field line coordinate $s$ of a scalar ion number density $n(s,t)$ in a tokamak edge plasma. The governing conservation law for a passive scalar advected by a given parallel flow $u(s,t)$ without sources is\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial s}\\big(n u\\big) = 0.\n$$\nA low-order, positivity-preserving transport update over a time step $\\Delta t$ yields cell-averaged values $n_{i}^{L}$ and $n_{j}^{L}$ at neighboring cells $i$ and $j$ that share an interface. A high-order correction stage in a Flux-Corrected Transport (FCT) method then forms pairwise antidiffusive mass fluxes across interfaces to recover accuracy while enforcing physically admissible bounds.\n\nFocus on a single interface between cells $i$ and $j$, with a raw antidiffusive mass transfer over the time step denoted by $\\tilde{F}_{ij}$, using the sign convention that $\\tilde{F}_{ij} > 0$ represents mass transfer from cell $j$ into cell $i$. The cell volumes are $V_{i}$ and $V_{j}$. The physically admissible bounds for each cell are specified by a lower bound $n_{k}^{\\min}$ and an upper bound $n_{k}^{\\max}$ for $k\\in\\{i,j\\}$. The low-order update satisfies $n_{k}^{\\min} \\le n_{k}^{L} \\le n_{k}^{\\max}$.\n\nScientific realism requires that the limiter for the antidiffusive flux be derived from first principles: conservation of mass in each finite volume, the boundedness constraint that $n_{k}$ cannot exceed $n_{k}^{\\max}$ or fall below $n_{k}^{\\min}$ after adding the antidiffusive corrections, and a construction that ensures no violation of these bounds by limiting the antidiffusive flux based on nodal “reservoir” capacities, computed from the difference between the admissible bounds and the low-order solution.\n\nYou are given the following physically consistent data for the interface:\n- Cell volumes: $V_{i} = 2.0\\times 10^{-6}\\ \\mathrm{m}^{3}$, $V_{j} = 3.0\\times 10^{-6}\\ \\mathrm{m}^{3}$.\n- Low-order densities: $n_{i}^{L} = 3.2\\times 10^{19}\\ \\mathrm{m}^{-3}$, $n_{j}^{L} = 4.0\\times 10^{19}\\ \\mathrm{m}^{-3}$.\n- Admissible bounds: $n_{i}^{\\min} = 0$, $n_{i}^{\\max} = 3.5\\times 10^{19}\\ \\mathrm{m}^{-3}$; $n_{j}^{\\min} = 3.5\\times 10^{19}\\ \\mathrm{m}^{-3}$, $n_{j}^{\\max} = 4.2\\times 10^{19}\\ \\mathrm{m}^{-3}$.\n- Raw antidiffusive mass transfer over the time step: $\\tilde{F}_{ij} = +1.2\\times 10^{13}$.\n\nStarting from the conservation law and the definition of finite-volume updates, derive expressions for the nodal “reservoir” capacities to accept and donate mass implied by the admissible bounds, then construct the allowable antidiffusive flux bounds at the interface. Using these bounds, define and compute the edge limiter $\\alpha_{ij}$ as the minimum ratio of the needed correction to the available nodal capacity at the participating cells, further restricted so that its value does not exceed unity. Report the dimensionless limiter value $\\alpha_{ij}$ as your final answer. No rounding is required.",
            "solution": "The problem asks for the computation of a limiter, $\\alpha_{ij}$, for a Flux-Corrected Transport (FCT) scheme applied to a scalar advection equation. The FCT method aims to correct a low-order, positivity-preserving solution, $n_k^L$, to achieve higher-order accuracy without violating physical bounds. This is done by adding a limited antidiffusive flux.\n\nThe governing conservation law is given by:\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial s}\\big(n u\\big) = 0\n$$\nIn a finite-volume framework, the update for the number of particles, $N_k = n_k V_k$, in a cell $k$ (where $k \\in \\{i, j\\}$) from the low-order state $N_k^L = n_k^L V_k$ to the new state $N_k^{\\text{new}} = n_k^{\\text{new}} V_k$ is performed by adding a corrected antidiffusive mass transfer, $F_{ij}^{\\text{corrected}}$. The problem specifies that the raw antidiffusive mass transfer, $\\tilde{F}_{ij}$, is from cell $j$ to cell $i$ since its value is positive, $\\tilde{F}_{ij} = +1.2 \\times 10^{13} > 0$.\n\nThe conservation of mass for the pair of cells $i$ and $j$ dictates the updates:\n$$\nN_i^{\\text{new}} = N_i^L + F_{ij}^{\\text{corrected}} \\quad \\implies \\quad n_i^{\\text{new}} V_i = n_i^L V_i + F_{ij}^{\\text{corrected}}\n$$\n$$\nN_j^{\\text{new}} = N_j^L - F_{ij}^{\\text{corrected}} \\quad \\implies \\quad n_j^{\\text{new}} V_j = n_j^L V_j - F_{ij}^{\\text{corrected}}\n$$\nThe corrected antidiffusive flux is related to the raw antidiffusive flux by the limiter $\\alpha_{ij}$:\n$$\nF_{ij}^{\\text{corrected}} = \\alpha_{ij} \\tilde{F}_{ij}\n$$\nThe new densities must satisfy the prescribed physical bounds:\n$$\nn_k^{\\min} \\le n_k^{\\text{new}} \\le n_k^{\\max} \\quad \\text{for } k \\in \\{i, j\\}\n$$\nWe use these constraints to derive the limits on $F_{ij}^{\\text{corrected}}$.\n\nFor cell $i$, which is receiving mass, the density increases. The upper bound provides the constraint:\n$$\nn_i^{\\text{new}} \\le n_i^{\\max}\n$$\n$$\nn_i^L + \\frac{F_{ij}^{\\text{corrected}}}{V_i} \\le n_i^{\\max}\n$$\n$$\nF_{ij}^{\\text{corrected}} \\le (n_i^{\\max} - n_i^L) V_i\n$$\nThe term on the right, $P_i^+ = (n_i^{\\max} - n_i^L) V_i$, represents the maximum amount of mass cell $i$ can accept before violating its upper bound. This is the nodal \"reservoir\" capacity to accept mass.\n\nFor cell $j$, which is donating mass, the density decreases. The lower bound provides the constraint:\n$$\nn_j^{\\text{new}} \\ge n_j^{\\min}\n$$\n$$\nn_j^L - \\frac{F_{ij}^{\\text{corrected}}}{V_j} \\ge n_j^{\\min}\n$$\n$$\nF_{ij}^{\\text{corrected}} \\le (n_j^L - n_j^{\\min}) V_j\n$$\nThe term on the right, $Q_j^- = (n_j^L - n_j^{\\min}) V_j$, represents the maximum amount of mass cell $j$ can donate before violating its lower bound. This is the nodal \"reservoir\" capacity to donate mass.\n\nThe corrected flux $F_{ij}^{\\text{corrected}}$ must satisfy both constraints simultaneously. Since $F_{ij}^{\\text{corrected}} > 0$, we have:\n$$\nF_{ij}^{\\text{corrected}} \\le \\min(P_i^+, Q_j^-)\n$$\nSubstituting $F_{ij}^{\\text{corrected}} = \\alpha_{ij} \\tilde{F}_{ij}$ and knowing $\\tilde{F}_{ij} > 0$:\n$$\n\\alpha_{ij} \\tilde{F}_{ij} \\le \\min(P_i^+, Q_j^-)\n$$\n$$\n\\alpha_{ij} \\le \\frac{\\min(P_i^+, Q_j^-)}{\\tilde{F}_{ij}} = \\min\\left(\\frac{P_i^+}{\\tilde{F}_{ij}}, \\frac{Q_j^-}{\\tilde{F}_{ij}}\\right)\n$$\nThe problem also states that the limiter's value cannot exceed unity, $\\alpha_{ij} \\le 1$. Combining these, the limiter is:\n$$\n\\alpha_{ij} = \\min\\left(1, \\frac{P_i^+}{\\tilde{F}_{ij}}, \\frac{Q_j^-}{\\tilde{F}_{ij}}\\right)\n$$\nWe now compute the numerical value of $\\alpha_{ij}$ using the given data:\n- $V_{i} = 2.0 \\times 10^{-6}\\ \\mathrm{m}^{3}$\n- $V_{j} = 3.0 \\times 10^{-6}\\ \\mathrm{m}^{3}$\n- $n_{i}^{L} = 3.2 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $n_{j}^{L} = 4.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $n_{i}^{\\min} = 0$, $n_{i}^{\\max} = 3.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $n_{j}^{\\min} = 3.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $n_{j}^{\\max} = 4.2 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- $\\tilde{F}_{ij} = 1.2 \\times 10^{13}$\n\nFirst, calculate the reservoir capacities:\nCapacity of cell $i$ to accept mass:\n$$\nP_i^+ = (n_i^{\\max} - n_i^L) V_i = (3.5 \\times 10^{19} - 3.2 \\times 10^{19}) \\times (2.0 \\times 10^{-6})\n$$\n$$\nP_i^+ = (0.3 \\times 10^{19}) \\times (2.0 \\times 10^{-6}) = 0.6 \\times 10^{13} = 6.0 \\times 10^{12}\n$$\nCapacity of cell $j$ to donate mass:\n$$\nQ_j^- = (n_j^L - n_j^{\\min}) V_j = (4.0 \\times 10^{19} - 3.5 \\times 10^{19}) \\times (3.0 \\times 10^{-6})\n$$\n$$\nQ_j^- = (0.5 \\times 10^{19}) \\times (3.0 \\times 10^{-6}) = 1.5 \\times 10^{13}\n$$\nNext, compute the ratios of available capacities to the raw antidiffusive mass transfer:\nRatio for the receiving cell $i$:\n$$\n\\frac{P_i^+}{\\tilde{F}_{ij}} = \\frac{6.0 \\times 10^{12}}{1.2 \\times 10^{13}} = \\frac{0.6 \\times 10^{13}}{1.2 \\times 10^{13}} = 0.5\n$$\nRatio for the donating cell $j$:\n$$\n\\frac{Q_j^-}{\\tilde{F}_{ij}} = \\frac{1.5 \\times 10^{13}}{1.2 \\times 10^{13}} = \\frac{1.5}{1.2} = \\frac{5}{4} = 1.25\n$$\nFinally, determine the limiter $\\alpha_{ij}$:\n$$\n\\alpha_{ij} = \\min(1, 0.5, 1.25)\n$$\nThe minimum of these values is $0.5$.\n$$\n\\alpha_{ij} = 0.5\n$$\nThis limiter ensures that the corrected antidiffusive flux does not cause the density in any cell to violate its physical bounds. Specifically, a limiter of $0.5$ reduces the raw flux to a level where the density in the receiving cell $i$ exactly reaches its maximum allowed value, $n_i^{\\max}$.",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "A robust numerical method for plasma flows must be stable across a wide range of conditions. For explicit time-stepping schemes, this stability is dictated by the Courant–Friedrichs–Lewy (CFL) condition, which restricts the time step size $\\Delta t$ based on the grid spacing and the fastest wave speeds in the plasma. This final practice extends our analysis to a multidimensional context, where you will derive a sufficient time-step restriction that guarantees the monotonicity of the low-order scheme . Satisfying this condition is a non-negotiable prerequisite for the entire FCT algorithm to function correctly and is a critical step in any practical implementation.",
            "id": "3981265",
            "problem": "In computational fusion science and engineering, explicit high-resolution simulation of plasma flows governed by hyperbolic conservation laws often employs Flux-Corrected Transport (FCT) as a nonlinear stabilization strategy, wherein a provably monotone low-order scheme is blended with limited antidiffusive corrections. Consider a general multidimensional hyperbolic conservation law for a plasma model such as magnetohydrodynamics (MHD), written in conservative form as $$\\partial_{t}\\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0},$$ where $\\boldsymbol{U}$ denotes the vector of conserved variables and $\\boldsymbol{F}(\\boldsymbol{U})$ denotes the physical flux. Let a finite-volume discretization be defined on a tessellation by control volumes (cells) $K_{i}$ with volume $V_{i}$ and boundary faces $f \\in \\partial K_{i}$ of area $A_{f}$ and outward unit normals $\\boldsymbol{n}_{f}$. An explicit update reads $$\\boldsymbol{U}_{i}^{n+1} = \\boldsymbol{U}_{i}^{n} - \\frac{\\Delta t}{V_{i}} \\sum_{f \\in \\partial K_{i}} A_{f} \\,\\boldsymbol{\\mathcal{F}}_{f}^{n},$$ where $\\boldsymbol{\\mathcal{F}}_{f}^{n}$ is a consistent numerical flux across face $f$ at time level $n$. Suppose that the low-order numerical flux is the Local Lax–Friedrichs (LLF) flux, also known as the Rusanov flux, with dissipation parameter on face $f$ chosen as $$\\alpha_{f} = \\lambda_{\\max,f},$$ the maximum absolute characteristic speed associated with the normal flux Jacobian $A_{n_{f}}(\\boldsymbol{U}) = \\partial (\\boldsymbol{F}(\\boldsymbol{U}) \\cdot \\boldsymbol{n}_{f}) / \\partial \\boldsymbol{U}$ evaluated in an appropriate local state, and denote by $\\lambda_{\\max}$ a uniform upper bound on $\\lambda_{\\max,f}$ over all faces and cells. In the context of Courant–Friedrichs–Lewy (CFL) stability for multidimensional explicit schemes, define the CFL condition in terms of $\\lambda_{\\max}$ and mesh metrics, and, starting from the conservative form and the face-based finite-volume update above together with the LLF flux construction, derive a sufficient time-step restriction that guarantees that the low-order update in each cell is a convex combination of its own and neighboring states (low-order monotonicity), suitable for use within Flux-Corrected Transport (FCT). Assume a uniform Cartesian grid in $d$ spatial dimensions with spacings $\\Delta x_{1}, \\dots, \\Delta x_{d}$ along the coordinate directions, and that the maximum normal wave speed satisfies $|\\lambda_{\\max,f}| \\le \\lambda_{\\max}$ for all faces. Provide your final answer as a single closed-form analytical expression for the maximum allowable explicit time step $\\Delta t_{\\max}$ on this uniform grid, expressed in terms of $\\lambda_{\\max}$ and $\\Delta x_{1}, \\dots, \\Delta x_{d}$. No numerical evaluation is required.",
            "solution": "The condition that the update for cell $i$ is a convex combination of its own state and its neighbors' states is a sufficient condition for the low-order scheme to be monotone (or positivity-preserving for systems), a key requirement for FCT methods. For a nonlinear system, this property can be analyzed by inspecting the Jacobians of the update function.\n\nLet the update for cell $i$ be written as a function $\\boldsymbol{G}_{i}$ of the states in its stencil (cell $i$ and its immediate neighbors $j \\in N(i)$):\n$$\\boldsymbol{U}_{i}^{n+1} = \\boldsymbol{G}_{i}(\\boldsymbol{U}_{i}^{n}, \\{\\boldsymbol{U}_{j}^{n}\\}_{j \\in N(i)})$$\nFor the scheme to be monotone, it is sufficient that the Jacobian matrix of $\\boldsymbol{G}_{i}$ with respect to each of its arguments is a positive-semidefinite matrix (or for scalar problems, the partial derivatives are non-negative). The condition of being a convex combination implies that the sum of these Jacobian matrices is the identity matrix, $\\sum_{k \\in \\{i\\} \\cup N(i)} \\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{k}} = I$.\n\nThe numerical flux for the LLF scheme at a face $f_{ij}$ separating cells $i$ (left state) and $j$ (right state), with outward normal $\\boldsymbol{n}_{ij}$ from cell $i$, is:\n$$\\boldsymbol{\\mathcal{F}}_{f_{ij}}(\\boldsymbol{U}_{i}, \\boldsymbol{U}_{j}) = \\frac{1}{2} \\left[ \\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\boldsymbol{n}_{ij} + \\boldsymbol{F}(\\boldsymbol{U}_{j}) \\cdot \\boldsymbol{n}_{ij} \\right] - \\frac{1}{2} \\alpha_{ij} (\\boldsymbol{U}_{j} - \\boldsymbol{U}_{i})$$\nwhere $\\alpha_{ij} = \\lambda_{\\max, f_{ij}}$. The update function $\\boldsymbol{G}_{i}$ is:\n$$\\boldsymbol{G}_{i} = \\boldsymbol{U}_{i} - \\frac{\\Delta t}{V_{i}} \\sum_{j \\in N(i)} A_{ij} \\boldsymbol{\\mathcal{F}}_{f_{ij}}(\\boldsymbol{U}_{i}, \\boldsymbol{U}_{j})$$\n\nWe analyze the Jacobian of $\\boldsymbol{G}_i$ with respect to $\\boldsymbol{U}_i$:\n$$\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}} = I - \\frac{\\Delta t}{V_{i}} \\sum_{j \\in N(i)} A_{ij} \\frac{\\partial \\boldsymbol{\\mathcal{F}}_{f_{ij}}}{\\partial \\boldsymbol{U}_{i}}$$\nThe derivative of the flux with respect to $\\boldsymbol{U}_{i}$ is:\n$$\\frac{\\partial \\boldsymbol{\\mathcal{F}}_{f_{ij}}}{\\partial \\boldsymbol{U}_{i}} = \\frac{1}{2} \\frac{\\partial (\\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\boldsymbol{n}_{ij})}{\\partial \\boldsymbol{U}_{i}} - \\frac{1}{2} \\alpha_{ij} \\frac{\\partial(\\boldsymbol{U}_{j} - \\boldsymbol{U}_{i})}{\\partial \\boldsymbol{U}_{i}} = \\frac{1}{2} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) + \\frac{1}{2} \\alpha_{ij} I$$\nwhere $A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i})$ is the flux Jacobian with respect to the normal $\\boldsymbol{n}_{ij}$. Substituting this into the expression for $\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}}$:\n$$\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}} = I - \\frac{\\Delta t}{V_{i}} \\sum_{j \\in N(i)} A_{ij} \\left[ \\frac{1}{2} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) + \\frac{1}{2} \\alpha_{ij} I \\right]$$\n$$ = I - \\frac{\\Delta t}{2V_{i}} \\left( \\sum_{j \\in N(i)} A_{ij} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) \\right) - \\frac{\\Delta t}{2V_{i}} \\left( \\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} \\right) I$$\nA crucial geometric identity for any closed control volume $K_i$ is that the sum of face-area-weighted outward normal vectors is zero: $\\sum_{f \\in \\partial K_i} A_f \\boldsymbol{n}_f = \\boldsymbol{0}$. This extends to the flux Jacobian term:\n$$\\sum_{j \\in N(i)} A_{ij} A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_{i}) = \\sum_{j \\in N(i)} A_{ij} \\frac{\\partial (\\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\boldsymbol{n}_{ij})}{\\partial \\boldsymbol{U}_{i}} = \\frac{\\partial}{\\partial \\boldsymbol{U}_{i}} \\left( \\boldsymbol{F}(\\boldsymbol{U}_{i}) \\cdot \\sum_{j \\in N(i)} A_{ij} \\boldsymbol{n}_{ij} \\right) = \\frac{\\partial}{\\partial \\boldsymbol{U}_{i}} (\\boldsymbol{0}) = \\boldsymbol{0}$$\nThus, the Jacobian simplifies to a scalar multiple of the identity matrix:\n$$\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{i}} = \\left( 1 - \\frac{\\Delta t}{2V_{i}} \\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} \\right) I$$\nFor the coefficient of $\\boldsymbol{U}_{i}$ in the \"convex combination\" to be non-negative, the scalar multiplier must be non-negative:\n$$1 - \\frac{\\Delta t}{2V_{i}} \\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} \\ge 0$$\nThis yields the time-step restriction:\n$$\\Delta t \\le \\frac{2V_{i}}{\\sum_{j \\in N(i)} A_{ij} \\alpha_{ij}}$$\n(The condition for the neighbor coefficients, $\\frac{\\partial \\boldsymbol{G}_{i}}{\\partial \\boldsymbol{U}_{j}} \\ge 0$, is also satisfied by the choice of $\\alpha_{ij}$ as the maximum absolute eigenvalue, as this makes the matrix $(\\alpha_{ij}I - A_{\\boldsymbol{n}_{ij}}(\\boldsymbol{U}_j))$ positive-semidefinite).\n\nNow we apply this general result to the specified grid. For a uniform Cartesian grid in $d$ dimensions with spacings $\\Delta x_{1}, \\dots, \\Delta x_{d}$, a cell $i$ is a hyperrectangle with volume $V_i = \\prod_{k=1}^{d} \\Delta x_{k}$. Cell $i$ has $2d$ neighbors, two along each coordinate axis $k \\in \\{1, \\dots, d\\}$. The face separating cell $i$ from its neighbor in the $+x_k$ direction has an area $A_k = V_i / \\Delta x_k$ and normal $\\boldsymbol{e}_k$. The face for the neighbor in the $-x_k$ direction has the same area $A_k$ and normal $-\\boldsymbol{e}_k$.\n\nThe sum in the denominator of the time-step restriction becomes:\n$$\\sum_{j \\in N(i)} A_{ij} \\alpha_{ij} = \\sum_{k=1}^{d} \\left( A_k \\alpha_{f_{k}^{+}} + A_k \\alpha_{f_{k}^{-}} \\right)$$\nwhere $f_{k}^{+}$ and $f_{k}^{-}$ are the faces in the $\\pm x_k$ directions. The dissipation parameters $\\alpha_f$ are the maximum absolute characteristic speeds for the corresponding normal directions. Let $\\lambda_{\\max}^{(k)}$ be the maximum speed for the $k$-th coordinate direction. Since $\\alpha_f$ is based on the absolute value of the eigenvalues, $\\alpha_{f_{k}^{+}}$ and $\\alpha_{f_{k}^{-}}$ can both be bounded by the same value, related to propagation in the $k$-th direction. To obtain a single, robust time-step for the entire simulation domain, we use the global upper bound $\\lambda_{\\max}$, which is given to be greater than or equal to any local wave speed $\\alpha_{ij}$:\n$$\\alpha_{ij} \\le \\lambda_{\\max} \\quad \\forall i, j$$\nA sufficient condition is therefore obtained by replacing $\\alpha_{ij}$ with $\\lambda_{\\max}$:\n$$\\Delta t \\le \\frac{2V_{i}}{\\sum_{j \\in N(i)} A_{ij} \\lambda_{\\max}} = \\frac{2V_{i}}{\\lambda_{\\max} \\sum_{j \\in N(i)} A_{ij}}$$\nThe sum of all face areas of the hyperrectangular cell is:\n$$\\sum_{j \\in N(i)} A_{ij} = \\sum_{k=1}^{d} (A_k + A_k) = 2 \\sum_{k=1}^{d} A_k = 2 \\sum_{k=1}^{d} \\frac{V_i}{\\Delta x_k} = 2V_i \\sum_{k=1}^{d} \\frac{1}{\\Delta x_k}$$\nSubstituting this into the time-step inequality:\n$$\\Delta t \\le \\frac{2V_{i}}{\\lambda_{\\max} \\left( 2V_i \\sum_{k=1}^{d} \\frac{1}{\\Delta x_k} \\right)} = \\frac{1}{\\lambda_{\\max} \\sum_{k=1}^{d} \\frac{1}{\\Delta x_k}}$$\nThis provides the maximum allowable time step $\\Delta t_{\\max}$ that satisfies the monotonicity condition for the LLF scheme on the given grid.",
            "answer": "$$\\boxed{\\frac{1}{\\lambda_{\\max} \\sum_{k=1}^{d} \\frac{1}{\\Delta x_{k}}}}$$"
        }
    ]
}