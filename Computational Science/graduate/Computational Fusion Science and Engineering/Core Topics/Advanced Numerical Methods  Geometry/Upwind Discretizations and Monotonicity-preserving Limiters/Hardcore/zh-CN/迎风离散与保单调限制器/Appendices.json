{
    "hands_on_practices": [
        {
            "introduction": "在求解平流方程时，最简单的数值格式面临着一个关键选择。中心差分格式具有较高的精度，但其本身是不稳定的，会在解中产生非物理的振荡。而一阶迎风格式是稳定的，但会引入过度的数值扩散，导致解变得模糊。这项练习  将让你亲身体验这种权衡，并引入总变差 (Total Variation, TV) 作为量化振荡的指标，从而揭示了开发更高级格式的根本动机。",
            "id": "4061462",
            "problem": "考虑一维线性平流方程 $\\partial_t u + a\\,\\partial_x u = 0$，该方程模拟了聚变边界输运基准问题中标量边缘剖面的被动平流，其中平流速度为 $a = 10^{4}\\,\\mathrm{m/s}$。计算网格是均匀的，间距为 $\\Delta x = 1\\,\\mathrm{mm}$，网格中心位于 $x_j = j\\,\\Delta x$（$j$ 为整数）。初始数据为位于界面 $x=0$ 处的单位阶跃，在网格中心上定义为：当 $j \\geq 0$ 时 $u_j^0 = 1$，当 $j  0$ 时 $u_j^0 = 0$。使用单个前向欧拉时间步长 $\\Delta t = 5.0 \\times 10^{-8}\\,\\mathrm{s}$。\n\n从控制方程和空间导数离散近似的标准定义出发，推导以下方法的单步更新公式：\n- 用于 $\\partial_x u$ 的空间中心差分的前向欧拉法，以及\n- 适用于正 $a$ 的迎风差分的前向欧拉法。\n\n将每种格式应用于给定的初始数据，并计算间断点及其附近的新值 $u_j^{1}$。然后，使用网格上总变差的定义 $TV(u) = \\sum_{j} |u_{j+1} - u_j|$，计算每种格式一步后的总变差变化量，$\\Delta TV_{\\mathrm{central}} = TV(u^{1}_{\\mathrm{central}}) - TV(u^{0})$ 和 $\\Delta TV_{\\mathrm{upwind}} = TV(u^{1}_{\\mathrm{upwind}}) - TV(u^{0})$。\n\n最后，报告单个无量纲量 $\\Delta TV_{\\mathrm{central}} - \\Delta TV_{\\mathrm{upwind}}$。该差异可作为过冲（非单调振荡）与抹平（扩散性展宽）的定量比较。最终答案以单个实数表示。无需四舍五入。在首次提及时定义所使用的任何缩写（例如，Courant–Friedrichs–Lewy (CFL) 或总变差递减 (Total Variation Diminishing, TVD)）。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、适定的、客观的和完整的。所有必要的数据和定义都已提供，没有内部矛盾或违反物理原则。我们可以开始求解。\n\n该问题要求分析用于一维线性平流方程的两种数值格式：\n$$\n\\partial_t u + a\\,\\partial_x u = 0\n$$\n其中平流速度为 $a = 10^{4}\\,\\mathrm{m/s}$。离散化参数给定为网格间距 $\\Delta x = 1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$ 和时间步长 $\\Delta t = 5.0 \\times 10^{-8}\\,\\mathrm{s}$。一个关键的无量纲参数是 Courant–Friedrichs–Lewy (CFL) 数 $\\nu$，定义为：\n$$\n\\nu = a \\frac{\\Delta t}{\\Delta x}\n$$\n代入给定值：\n$$\n\\nu = (10^{4}\\,\\mathrm{m/s}) \\frac{5.0 \\times 10^{-8}\\,\\mathrm{s}}{10^{-3}\\,\\mathrm{m}} = 10^{4} \\times 5.0 \\times 10^{-8} \\times 10^{3} = 5.0 \\times 10^{-1} = 0.5\n$$\nCFL 数的值为 $\\nu = 0.5$。\n\n我们将使用前向欧拉时间离散化。在网格点 $x_j$ 处，平流方程的半离散形式为 $\\frac{du_j}{dt} = -a (\\partial_x u)_j$。应用前向欧拉法，其中 $u_j^n$ 是时间 $t_n = n\\Delta t$ 处解的近似值，可得：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -a (\\partial_x u)_j^n\n$$\n其中 $(\\partial_x u)_j^n$ 是时间 $t_n$ 处空间导数的离散近似。这可以重排为通用的单步更新公式：\n$$\nu_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x} (\\Delta x (\\partial_x u)_j^n) = u_j^n - \\nu (\\Delta x (\\partial_x u)_j^n)\n$$\n\n首先，我们为两种指定的空间离散格式推导更新公式。\n\n1.  **前向欧拉法结合中心差分：**\n    $x_j$ 处空间导数的二阶精确中心差分近似为：\n    $$\n    (\\partial_x u)_j^n \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}\n    $$\n    将其代入通用更新公式，得到：\n    $$\n    u_j^{n+1} = u_j^n - \\nu \\left( \\Delta x \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} \\right) \\right) = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)\n    $$\n\n2.  **前向欧拉法结合迎风差分：**\n    对于正的平流速度 ($a > 0$)，“迎风”方向是负 $x$ 方向（来自较小的索引 $j$）。一阶精确的迎风格式使用后向差分：\n    $$\n    (\\partial_x u)_j^n \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n    $$\n    将其代入通用更新公式，得到：\n    $$\n    u_j^{n+1} = u_j^n - \\nu \\left( \\Delta x \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) \\right) = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n    $$\n    这也可以写成 $u_j^{n+1} = (1-\\nu)u_j^n + \\nu u_{j-1}^n$。\n\n接下来，我们将每种格式应用于给定的初始数据，进行一个时间步的计算。初始条件是一个阶跃函数：\n$$\nu_j^0 = \\begin{cases} 0  \\text{for } j  0 \\\\ 1  \\text{for } j \\geq 0 \\end{cases}\n$$\n所以，初始网格值为 $... , u_{-2}^0=0, u_{-1}^0=0, u_0^0=1, u_1^0=1, u_2^0=1, ...$。我们使用 $\\nu=0.5$。\n\n- **中心格式的应用 ($u_j^{1, \\mathrm{central}}$)：**\n  $u_j^1 = u_j^0 - \\frac{0.5}{2}(u_{j+1}^0 - u_{j-1}^0) = u_j^0 - 0.25(u_{j+1}^0 - u_{j-1}^0)$。我们计算间断点及其附近的新值：\n  - 对于 $j \\leq -2$：$u_{j+1}^0=0$ 且 $u_{j-1}^0=0$，所以 $u_j^1 = u_j^0 - 0.25(0-0) = 0$。\n  - 对于 $j = -1$：$u_{-1}^1 = u_{-1}^0 - 0.25(u_0^0 - u_{-2}^0) = 0 - 0.25(1 - 0) = -0.25$。这显示了一个非物理的下冲。\n  - 对于 $j = 0$：$u_0^1 = u_0^0 - 0.25(u_1^0 - u_{-1}^0) = 1 - 0.25(1 - 0) = 0.75$。\n  - 对于 $j \\geq 1$：$u_{j+1}^0=1$ 且 $u_{j-1}^0=1$（因为 $j-1 \\ge 0$），所以 $u_j^1 = u_j^0 - 0.25(1-1) = u_j^0 = 1$。\n  一步之后的状态是 $u^1_{\\mathrm{central}}: ..., 0, 0, -0.25, 0.75, 1, 1, ...$\n\n- **迎风格式的应用 ($u_j^{1, \\mathrm{upwind}}$)：**\n  $u_j^1 = u_j^0 - 0.5(u_j^0 - u_{j-1}^0)$。\n  - 对于 $j \\leq -1$：$u_j^0=0$ 且 $u_{j-1}^0=0$，所以 $u_j^1 = 0 - 0.5(0-0) = 0$。\n  - 对于 $j = 0$：$u_0^1 = u_0^0 - 0.5(u_0^0 - u_{-1}^0) = 1 - 0.5(1 - 0) = 0.5$。阶跃被抹平了。\n  - 对于 $j \\geq 1$：$u_j^0=1$ 且 $u_{j-1}^0=1$（因为 $j-1 \\ge 0$），所以 $u_j^1 = 1 - 0.5(1-1) = 1$。\n  一步之后的状态是 $u^1_{\\mathrm{upwind}}: ..., 0, 0, 0, 0.5, 1, 1, ...$\n\n现在，我们计算每种状态的总变差 (Total Variation, TV)。TV 定义为 $TV(u) = \\sum_{j} |u_{j+1} - u_j|$。\n- **初始总变差 $TV(u^0)$：**\n  唯一的非零差值出现在 $j=-1$ 和 $j=0$ 之间。\n  $$ TV(u^0) = \\sum_j |u_{j+1}^0 - u_j^0| = |u_0^0 - u_{-1}^0| = |1 - 0| = 1 $$\n\n- **中心格式的总变差 $TV(u^1_{\\mathrm{central}})$：**\n  非零差值出现在原始阶跃附近。\n  $|u_{-1}^1 - u_{-2}^1| = |-0.25 - 0| = 0.25$。\n  $|u_0^1 - u_{-1}^1| = |0.75 - (-0.25)| = |1.0| = 1.0$。\n  $|u_1^1 - u_0^1| = |1 - 0.75| = 0.25$。\n  所有其他差值均为零。\n  $$ TV(u^1_{\\mathrm{central}}) = 0.25 + 1.0 + 0.25 = 1.5 $$\n  总变差的变化量是 $\\Delta TV_{\\mathrm{central}} = TV(u^1_{\\mathrm{central}}) - TV(u^0) = 1.5 - 1 = 0.5$。TV 的增加是产生新极值（下冲）的直接结果。\n\n- **迎风格式的总变差 $TV(u^1_{\\mathrm{upwind}})$：**\n  非零差值为：\n  $|u_0^1 - u_{-1}^1| = |0.5 - 0| = 0.5$。\n  $|u_1^1 - u_0^1| = |1 - 0.5| = 0.5$。\n  所有其他差值均为零。\n  $$ TV(u^1_{\\mathrm{upwind}}) = 0.5 + 0.5 = 1.0 $$\n  总变差的变化量是 $\\Delta TV_{\\mathrm{upwind}} = TV(u^1_{\\mathrm{upwind}}) - TV(u^0) = 1.0 - 1 = 0$。在这种情况下，总变差是守恒的。一个数值格式如果满足 $TV(u^{n+1}) \\leq TV(u^n)$，则被称为总变差递减 (Total Variation Diminishing, TVD)。对于 $\\nu \\in [0, 1]$，一阶迎风格式是 TVD 的。\n\n最后，我们计算所要求的量：\n$$\n\\Delta TV_{\\mathrm{central}} - \\Delta TV_{\\mathrm{upwind}} = 0.5 - 0 = 0.5\n$$\n这个正值量化了中心差分格式产生虚假振荡（增加TV）的程度，与之相比，迎风格式是单调的但更具扩散性（抹平阶跃而不增加TV）。",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "现代高分辨率格式的目标是两全其美：在解的光滑区域实现高精度，在陡峭梯度附近保持稳定性。这可以通过诸如 MUSCL (Monotonic Upstream-centered Schemes for Conservation Laws) 这样的高阶格式与限制器相结合来实现。本练习  将指导你完整地、一步一步地计算一个时间步长，展示如何限制斜率并用其构造稳定且高阶的数值通量，从而将理论付诸实践。",
            "id": "4061484",
            "problem": "考虑托卡马克芯部闭合磁通量面上归一化标量 $n(s,t)$ 的一维场向平流，其由守恒形式的偏微分方程 (PDE) 建模：\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial s}\\!\\left(v_{\\parallel}\\,n\\right) \\;=\\; S(s,t),\n$$\n其中 $s$ 是沿磁场线的弧长坐标，$v_{\\parallel}$ 是恒定的平行平流速度，$S$ 是一个源项。在一个具有三个宽度为 $\\Delta s$ 的单元的均匀有限体积网格上，设初始的单元中心值为：\n$$\nn_1 = 1,\\quad n_2 = 0.5,\\quad n_3 = 0.2,\n$$\n采用周期性边界条件，因此 $n_0 \\equiv n_3$ 且 $n_4 \\equiv n_1$。使用带有 minmod 限制器的二阶守恒律单调上游中心格式 (MUSCL) 重构来获得界面值。具体来说，定义受限斜率为：\n$$\n\\sigma_i \\;=\\; \\operatorname{minmod}\\!\\left(\\frac{n_i - n_{i-1}}{\\Delta s},\\,\\frac{n_{i+1} - n_i}{\\Delta s}\\right),\n$$\n其中\n$$\n\\operatorname{minmod}(a,b) \\;=\\; \\begin{cases}\n\\min(|a|,|b|)  \\text{if } a>0 \\text{ and } b>0 \\\\\n-\\min(|a|,|b|)  \\text{if } a0 \\text{ and } b0 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n并从单元 $i$ 重构界面 $i+\\tfrac{1}{2}$ 处的左状态为：\n$$\nn_{i+\\frac{1}{2}}^{L} \\;=\\; n_i + \\frac{\\Delta s}{2}\\,\\sigma_i,\n$$\n以及从单元 $i+1$ 重构界面 $i+\\tfrac{1}{2}$ 处的右状态为：\n$$\nn_{i+\\frac{1}{2}}^{R} \\;=\\; n_{i+1} - \\frac{\\Delta s}{2}\\,\\sigma_{i+1}.\n$$\n在恒定的正平行速度 $v_{\\parallel}0$ 的情况下，使用迎风格式定义界面 $i+\\tfrac{1}{2}$ 处的数值通量为：\n$$\nF_{i+\\frac{1}{2}} \\;=\\; v_{\\parallel}\\,n_{i+\\frac{1}{2}}^{L}.\n$$\n使用以下公式将有限体积解推进一个时间步长：\n$$\nn_i^{\\text{new}} \\;=\\; n_i^{\\text{old}} \\;-\\; \\frac{\\Delta t}{\\Delta s}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right) \\;+\\; \\Delta t\\,S_i,\n$$\n其中对所有 $i$ 都有 $S_i=0$。\n\n给定 $v_{\\parallel} = 2\\times 10^{4}\\,\\mathrm{m/s}$，$\\Delta s = 5\\,\\mathrm{mm}$，$\\Delta t = 0.1\\,\\mu\\mathrm{s}$，以及具有周期性索引的初始值 $n=\\{1,\\,0.5,\\,0.2\\}$，计算：\n- 迎风通量 $F_{1+\\frac{1}{2}}$、$F_{2+\\frac{1}{2}}$ 和 $F_{3+\\frac{1}{2}}$（每个均以 $\\mathrm{m/s}$ 为单位表示），以及\n- 更新后的单元中心值 $n_1^{\\text{new}}$、$n_2^{\\text{new}}$ 和 $n_3^{\\text{new}}$（无量纲）。\n\n请按以下顺序以单行矩阵的形式提供最终答案：\n$$\n\\left(F_{1+\\frac{1}{2}},\\;F_{2+\\frac{1}{2}},\\;F_{3+\\frac{1}{2}},\\;n_1^{\\text{new}},\\;n_2^{\\text{new}},\\;n_3^{\\text{new}}\\right),\n$$\n无需四舍五入。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于计算流体力学和等离子体物理的原理，特别是求解双曲守恒律的有限体积法。该问题是适定的，提供了所有必要的数据、初始条件、边界条件和数值格式参数。单位是一致的，参数（$v_{\\parallel}$、$\\Delta s$、$\\Delta t$）在物理上是合理的，并且满足显式平流格式的 Courant-Friedrichs-Lewy (CFL) 稳定性条件，因为库朗数 $C = v_{\\parallel} \\Delta t / \\Delta s = (2 \\times 10^4 \\, \\mathrm{m/s})(0.1 \\times 10^{-6} \\, \\mathrm{s}) / (5 \\times 10^{-3} \\, \\mathrm{m}) = 0.4 \\le 1$。该问题是客观、无歧义的，并且需要直接应用指定的 MUSCL-Hancock 方法。\n\n我们开始求解。目标是计算在一个时间步长后的数值通量 $F_{1+\\frac{1}{2}}$、$F_{2+\\frac{1}{2}}$、$F_{3+\\frac{1}{2}}$，以及更新后的单元中心值 $n_1^{\\text{new}}$、$n_2^{\\text{new}}$ 和 $n_3^{\\text{new}}$。\n\n给定的初始单元中心值为：\n$$\nn_1 = 1, \\quad n_2 = 0.5, \\quad n_3 = 0.2\n$$\n问题指定了在 3 单元域上的周期性边界条件。为了计算斜率，我们需要来自相邻单元的值。我们定义“虚拟”单元 $n_0$ 和 $n_4$ 为：\n$$\nn_0 \\equiv n_3 = 0.2\n$$\n$$\nn_4 \\equiv n_1 = 1\n$$\n因此，单元中心值的扩展数组为 $(n_0, n_1, n_2, n_3, n_4) = (0.2, 1, 0.5, 0.2, 1)$。\n\n给定的物理和数值参数为：\n$$\nv_{\\parallel} = 2 \\times 10^4 \\, \\mathrm{m/s}\n$$\n$$\n\\Delta s = 5 \\, \\mathrm{mm} = 5 \\times 10^{-3} \\, \\mathrm{m}\n$$\n$$\n\\Delta t = 0.1 \\, \\mu\\mathrm{s} = 1 \\times 10^{-7} \\, \\mathrm{s}\n$$\n\n计算分四步进行。\n\n**第 1 步：计算 $i=1, 2, 3$ 的受限斜率 $\\sigma_i$。**\n单元 $i$ 中的受限斜率由 $\\sigma_i = \\operatorname{minmod}(\\frac{n_i - n_{i-1}}{\\Delta s}, \\frac{n_{i+1} - n_i}{\\Delta s})$ 给出。\n\n对于单元 $i=1$：\nminmod 函数的两个参数是：\n$$\na = \\frac{n_1 - n_0}{\\Delta s} = \\frac{1 - 0.2}{\\Delta s} = \\frac{0.8}{\\Delta s} > 0\n$$\n$$\nb = \\frac{n_2 - n_1}{\\Delta s} = \\frac{0.5 - 1}{\\Delta s} = \\frac{-0.5}{\\Delta s}  0\n$$\n由于 $a$ 和 $b$ 的符号相反，受限斜率为零：\n$$\n\\sigma_1 = \\operatorname{minmod}(a,b) = 0\n$$\n\n对于单元 $i=2$：\nminmod 函数的两个参数是：\n$$\na = \\frac{n_2 - n_1}{\\Delta s} = \\frac{0.5 - 1}{\\Delta s} = \\frac{-0.5}{\\Delta s}  0\n$$\n$$\nb = \\frac{n_3 - n_2}{\\Delta s} = \\frac{0.2 - 0.5}{\\Delta s} = \\frac{-0.3}{\\Delta s}  0\n$$\n由于 $a$ 和 $b$ 均为负值，受限斜率为：\n$$\n\\sigma_2 = -\\min\\left(\\left|\\frac{-0.5}{\\Delta s}\\right|, \\left|\\frac{-0.3}{\\Delta s}\\right|\\right) = -\\min\\left(\\frac{0.5}{\\Delta s}, \\frac{0.3}{\\Delta s}\\right) = -\\frac{0.3}{\\Delta s}\n$$\n\n对于单元 $i=3$：\nminmod 函数的两个参数是：\n$$\na = \\frac{n_3 - n_2}{\\Delta s} = \\frac{0.2 - 0.5}{\\Delta s} = \\frac{-0.3}{\\Delta s}  0\n$$\n$$\nb = \\frac{n_4 - n_3}{\\Delta s} = \\frac{1 - 0.2}{\\Delta s} = \\frac{0.8}{\\Delta s} > 0\n$$\n由于 $a$ 和 $b$ 的符号相反，受限斜率为零：\n$$\n\\sigma_3 = \\operatorname{minmod}(a,b) = 0\n$$\n\n**第 2 步：重构左偏置的界面值 $n_{i+\\frac{1}{2}}^{L}$。**\n由于平流速度 $v_{\\parallel}$ 为正，界面 $i+\\frac{1}{2}$ 处的迎风通量由从左侧单元 $i$ 重构的状态确定。单元 $i$ 右侧面的重构值为 $n_{i+\\frac{1}{2}}^{L} = n_i + \\frac{\\Delta s}{2}\\sigma_i$。\n\n对于界面 $1+\\frac{1}{2}$：\n$$\nn_{1+\\frac{1}{2}}^{L} = n_1 + \\frac{\\Delta s}{2}\\sigma_1 = 1 + \\frac{\\Delta s}{2}(0) = 1\n$$\n\n对于界面 $2+\\frac{1}{2}$：\n$$\nn_{2+\\frac{1}{2}}^{L} = n_2 + \\frac{\\Delta s}{2}\\sigma_2 = 0.5 + \\frac{\\Delta s}{2}\\left(-\\frac{0.3}{\\Delta s}\\right) = 0.5 - \\frac{0.3}{2} = 0.5 - 0.15 = 0.35\n$$\n\n对于界面 $3+\\frac{1}{2}$：\n$$\nn_{3+\\frac{1}{2}}^{L} = n_3 + \\frac{\\Delta s}{2}\\sigma_3 = 0.2 + \\frac{\\Delta s}{2}(0) = 0.2\n$$\n\n**第 3 步：计算迎风数值通量 $F_{i+\\frac{1}{2}}$。**\n数值通量为 $F_{i+\\frac{1}{2}} = v_{\\parallel}\\,n_{i+\\frac{1}{2}}^{L}$。\n\n对于界面 $1+\\frac{1}{2}$：\n$$\nF_{1+\\frac{1}{2}} = v_{\\parallel}\\,n_{1+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(1) = 20000 \\, \\mathrm{m/s}\n$$\n\n对于界面 $2+\\frac{1}{2}$：\n$$\nF_{2+\\frac{1}{2}} = v_{\\parallel}\\,n_{2+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(0.35) = 7000 \\, \\mathrm{m/s}\n$$\n\n对于界面 $3+\\frac{1}{2}$：\n$$\nF_{3+\\frac{1}{2}} = v_{\\parallel}\\,n_{3+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(0.2) = 4000 \\, \\mathrm{m/s}\n$$\n\n**第 4 步：更新单元中心值 $n_i^{\\text{new}}$。**\n时间更新公式为 $n_i^{\\text{new}} = n_i^{\\text{old}} - \\frac{\\Delta t}{\\Delta s}(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}})$。由于周期性，单元 1 左侧面的通量 $F_{1-\\frac{1}{2}}$ 与单元 3 右侧面的通量 $F_{3+\\frac{1}{2}}$ 相同。\n更新预因子为：\n$$\n\\frac{\\Delta t}{\\Delta s} = \\frac{1 \\times 10^{-7} \\, \\mathrm{s}}{5 \\times 10^{-3} \\, \\mathrm{m}} = 2 \\times 10^{-5} \\, \\mathrm{s/m}\n$$\n\n对于单元 $i=1$：\n$$\nn_1^{\\text{new}} = n_1 - \\frac{\\Delta t}{\\Delta s}(F_{1+\\frac{1}{2}} - F_{3+\\frac{1}{2}}) = 1 - (2 \\times 10^{-5})(20000 - 4000) = 1 - (2 \\times 10^{-5})(16000) = 1 - 0.32 = 0.68\n$$\n\n对于单元 $i=2$：\n$$\nn_2^{\\text{new}} = n_2 - \\frac{\\Delta t}{\\Delta s}(F_{2+\\frac{1}{2}} - F_{1+\\frac{1}{2}}) = 0.5 - (2 \\times 10^{-5})(7000 - 20000) = 0.5 - (2 \\times 10^{-5})(-13000) = 0.5 + 0.26 = 0.76\n$$\n\n对于单元 $i=3$：\n$$\nn_3^{\\text{new}} = n_3 - \\frac{\\Delta t}{\\Delta s}(F_{3+\\frac{1}{2}} - F_{2+\\frac{1}{2}}) = 0.2 - (2 \\times 10^{-5})(4000 - 7000) = 0.2 - (2 \\times 10^{-5})(-3000) = 0.2 + 0.06 = 0.26\n$$\n\n计算出的值为：\n通量：$F_{1+\\frac{1}{2}} = 20000 \\, \\mathrm{m/s}$，$F_{2+\\frac{1}{2}} = 7000 \\, \\mathrm{m/s}$，$F_{3+\\frac{1}{2}} = 4000 \\, \\mathrm{m/s}$。\n更新后的密度：$n_1^{\\text{new}} = 0.68$，$n_2^{\\text{new}} = 0.76$，$n_3^{\\text{new}} = 0.26$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 20000  7000  4000  0.68  0.76  0.26 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "通量限制器是高分辨率格式的“大脑”，它决定了应用多少高阶修正量。不同的限制器函数在抑制振荡和最小化数值扩散之间提供了不同的平衡。这项练习  允许你在一个简单的场景下，比较几个著名的限制器（如 minmod, van Leer, MC 和 superbee），以理解它们的基本行为，并观察它们是如何被设计来保持光滑解的精度的。",
            "id": "4061467",
            "problem": "一个用于描述托卡马克刮削层中沿磁力线被动平流标量的平行对流输运的一维模型，可以用具有恒定速度 $a0$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$ 来表示。考虑一个间距为 $\\Delta x$ 的均匀网格和显式时间步长 $\\Delta t$，并将 Courant–Friedrichs–Lewy (CFL) 数记为 $\\lambda = a\\,\\Delta t/\\Delta x$。一种高分辨率全变差递减 (TVD) 方法通过一个守恒的、由限制器控制的反扩散修正来增强一阶迎风 Godunov 通量。对于 $a0$，在分母不为零时，定义网格单元 $i$ 处连续梯度的比率为\n$r_{i} = \\dfrac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}}$\n进入界面 $x_{i+1/2}$ 处数值通量的受限高阶修正与类斜率量\n$s_{i} = \\dfrac{1}{2}\\,\\phi(r_{i})\\,(1 - \\lambda)\\,(u_{i+1} - u_{i})$\n成正比，其中 $\\phi(r)$ 是从 TVD 容许族中选择的限制器函数。\n\n在给定的时间层，假设离散序列满足 $u_{i-1} = 0$、 $u_{i} = 1$、 $u_{i+1} = 2$，并且 Courant–Friedrichs–Lewy (CFL) 数为 $\\lambda = 0.8$。使用 minmod、van Leer、单调中心 (MC) 和 superbee 限制器的标准定义，计算这四种限制器各自的 $r_{i}$ 和相应的受限修正 $s_{i}$。作为最终答案，报告这四个受限修正的总和\n$S = s_{i}^{\\text{minmod}} + s_{i}^{\\text{van Leer}} + s_{i}^{\\text{MC}} + s_{i}^{\\text{superbee}}$。\n请提供精确值，无需四舍五入。最终答案必须是单个无单位的实数。",
            "solution": "该问题是有效的，因为它具有科学依据、适定且客观。它提供了在双曲守恒律的高分辨率全变差递减 (TVD) 格式背景下应用通量限制器的标准练习，这是计算科学与工程中的一个核心课题。\n\n问题要求计算在一维线性平流方程 $u_{t} + a\\,u_{x} = 0$下，给定特定的离散数据分布和 Courant–Friedrichs–Lewy (CFL) 数时，受限高阶修正的总和 $S = s_{i}^{\\text{minmod}} + s_{i}^{\\text{van Leer}} + s_{i}^{\\text{MC}} + s_{i}^{\\text{superbee}}$。\n\n求解过程分几步进行。首先，我们计算连续梯度的比率 $r_{i}$。其次，我们在此值上计算四个指定的限制器函数 $\\phi(r_{i})$ 的值。最后，我们计算相应的修正项 $s_{i}$ 并将它们相加。\n\n问题提供了以下数据：\n- 在网格单元 $i-1$、$i$ 和 $i+1$ 处标量场 $u$ 的离散序列：$u_{i-1} = 0$、$u_{i} = 1$ 和 $u_{i+1} = 2$。\n- CFL 数：$\\lambda = 0.8$。\n- 平流速度为正，$a0$。\n\n在网格单元 $i$ 处连续梯度的比率定义为：\n$$r_{i} = \\dfrac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}}$$\n代入给定值，我们计算 $r_{i}$：\n$$r_{i} = \\dfrac{1 - 0}{2 - 1} = \\dfrac{1}{1} = 1$$\n梯度比的值为 $r_{i} = 1$。这表明离散解的分布在局部是线性的，在网格单元 $i-1$、$i$ 和 $i+1$ 之间具有恒定的斜率。\n\n受限高阶修正项 $s_{i}$ 由以下公式给出：\n$$s_{i} = \\dfrac{1}{2}\\,\\phi(r_{i})\\,(1 - \\lambda)\\,(u_{i+1} - u_{i})$$\n我们需要对四个指定的限制器函数 $\\phi(r)$ 分别计算此表达式的值。可以先计算表达式 $s_i$ 中的公共因子：\n$$(1 - \\lambda) = (1 - 0.8) = 0.2$$\n$$(u_{i+1} - u_{i}) = (2 - 1) = 1$$\n因此，$s_i$ 的表达式简化为：\n$$s_{i} = \\dfrac{1}{2}\\,\\phi(1)\\,(0.2)\\,(1) = 0.1\\,\\phi(1)$$\n\n现在，我们计算每个限制器函数在 $r=1$ 时的值。\n1.  **Minmod 限制器：** 标准定义为 $\\phi_{\\text{minmod}}(r) = \\max(0, \\min(1, r))$。\n    在 $r=1$ 时：\n    $$\\phi_{\\text{minmod}}(1) = \\max(0, \\min(1, 1)) = \\max(0, 1) = 1$$\n    相应的修正为：\n    $$s_{i}^{\\text{minmod}} = 0.1 \\times \\phi_{\\text{minmod}}(1) = 0.1 \\times 1 = 0.1$$\n\n2.  **Van Leer 限制器：** 对于 $r  0$ 的标准定义为 $\\phi_{\\text{van Leer}}(r) = \\dfrac{2r}{1+r}$。\n    在 $r=1$ 时：\n    $$\\phi_{\\text{van Leer}}(1) = \\dfrac{2 \\times 1}{1 + 1} = \\dfrac{2}{2} = 1$$\n    相应的修正为：\n    $$s_{i}^{\\text{van Leer}} = 0.1 \\times \\phi_{\\text{van Leer}}(1) = 0.1 \\times 1 = 0.1$$\n\n3.  **单调中心 (MC) 限制器：** 标准定义为 $\\phi_{\\text{MC}}(r) = \\max(0, \\min(2r, \\frac{1+r}{2}, 2))$。\n    在 $r=1$ 时：\n    $$\\phi_{\\text{MC}}(1) = \\max\\left(0, \\min\\left(2 \\times 1, \\dfrac{1+1}{2}, 2\\right)\\right) = \\max(0, \\min(2, 1, 2)) = \\max(0, 1) = 1$$\n    相应的修正为：\n    $$s_{i}^{\\text{MC}} = 0.1 \\times \\phi_{\\text{MC}}(1) = 0.1 \\times 1 = 0.1$$\n\n4.  **Superbee 限制器：** 标准定义为 $\\phi_{\\text{superbee}}(r) = \\max(0, \\min(2r, 1), \\min(r, 2))$。\n    在 $r=1$ 时：\n    $$\\phi_{\\text{superbee}}(1) = \\max(0, \\min(2 \\times 1, 1), \\min(1, 2)) = \\max(0, \\min(2, 1), \\min(1, 2)) = \\max(0, 1, 1) = 1$$\n    相应的修正为：\n    $$s_{i}^{\\text{superbee}} = 0.1 \\times \\phi_{\\text{superbee}}(1) = 0.1 \\times 1 = 0.1$$\n\n所有四个限制器在 $r=1$ 时的值均为 $\\phi(1) = 1$。这是标准限制器的一个基本性质，确保对于解的光滑、单调区域（其中 $r \\approx 1$），格式恢复为二阶精度方法，从而最小化数值扩散。\n\n最后，我们计算所需的总和 $S$：\n$$S = s_{i}^{\\text{minmod}} + s_{i}^{\\text{van Leer}} + s_{i}^{\\text{MC}} + s_{i}^{\\text{superbee}}$$\n$$S = 0.1 + 0.1 + 0.1 + 0.1 = 0.4$$\n四个受限修正的总和为 $0.4$。",
            "answer": "$$\\boxed{0.4}$$"
        }
    ]
}