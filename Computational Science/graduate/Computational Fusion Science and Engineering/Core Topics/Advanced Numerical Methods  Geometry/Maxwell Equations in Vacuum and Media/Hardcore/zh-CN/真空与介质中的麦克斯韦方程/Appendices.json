{
    "hands_on_practices": [
        {
            "introduction": "在聚变等离子体中，射频（RF）波的传播与吸收是实现稳态燃烧的关键技术之一。为了高效地分析这种具有周期性的波，将麦克斯韦方程组从时域转换到频域（即相量法）是一种极其强大的分析工具。本节实践将指导你完成这一基础但关键的转换，并推导在导电介质中的色散关系，这是理解波如何在等离子体等复杂介质中传播、衰减或被吸收的物理基础。",
            "id": "4008786",
            "problem": "考虑用于射频 (RF) 波注入的聚变相关导电介质中的一个均匀、各向同性、无源区域，该区域被建模为具有欧姆传导的线性时不变系统。假设时谐场具有 $e^{-i \\omega t}$ 的时间依赖性，其中物理场由相应复相量的实部给出。该介质具有标量磁导率 $\\mu$、标量介电常数 $\\epsilon$ 和标量电导率 $\\sigma$，在窄带近似下，这些都被视为频率局域参数。\n\n从真空和介质中的时域麦克斯韦方程组以及标准线性本构关系出发，完成以下任务：\n\n1. 在所述的 $e^{-i \\omega t}$ 约定下，将麦克斯韦方程组改写为相量域形式，明确写出用复场振幅表示的旋度方程。\n2. 陈述并论证在线性介质中，对于窄带时谐激励，复数表示法和相量法有效的假设条件，包括线性、时不变性、因果性和叠加性的作用。\n3. 利用相量域方程和所述假设，推导电场相量 $\\mathbf{E}$ 的无源矢量亥姆霍兹方程，并求得介质中均匀平面波的色散关系。将最终结果表示为复波数的平方 $k^{2}$ 关于 $\\omega$、$\\mu$、$\\epsilon$ 和 $\\sigma$ 的单个闭式解析表达式。\n\n你的最终答案必须是单个解析表达式。最终的方框表达式中不要包含单位。如果中间表达式需要物理单位，请使用国际单位制 (SI)。无需进行四舍五入。",
            "solution": "该问题被验证为具有科学依据、适定且客观。这是电磁学中的一个标准推导，与聚变等离子体中的波传播直接相关。所有必要信息均已提供，且无矛盾之处。\n\n按照题目要求，解答分为三部分。\n\n### 1. 相量域中的麦克斯韦方程组\n\n分析始于物质介质中的宏观时域麦克斯韦方程组。设时域矢量场用花体字母表示（例如 $\\mathcal{E}(\\mathbf{r}, t)$）。方程组为：\n$$\n\\nabla \\cdot \\mathcal{D} = \\rho_f \\\\\n\\nabla \\cdot \\mathcal{B} = 0 \\\\\n\\nabla \\times \\mathcal{E} = -\\frac{\\partial \\mathcal{B}}{\\partial t} \\\\\n\\nabla \\times \\mathcal{H} = \\mathcal{J}_f + \\frac{\\partial \\mathcal{D}}{\\partial t}\n$$\n问题指定了一个无源区域，这意味着自由电荷密度 $\\rho_f = 0$ 且不存在任何外加电流源。存在的电流密度 $\\mathcal{J}_f$ 仅为电场感应的传导电流。\n\n介质由线性、时不变、各向同性且均匀的本构关系描述：\n$$\n\\mathcal{D}(\\mathbf{r}, t) = \\epsilon \\mathcal{E}(\\mathbf{r}, t) \\\\\n\\mathcal{B}(\\mathbf{r}, t) = \\mu \\mathcal{H}(\\mathbf{r}, t) \\\\\n\\mathcal{J}_f(\\mathbf{r}, t) = \\sigma \\mathcal{E}(\\mathbf{r}, t) \\quad \\text{(欧姆定律)}\n$$\n其中 $\\epsilon$ (介电常数)、$\\mu$ (磁导率) 和 $\\sigma$ (电导率) 均为标量常数。\n\n对于角频率为 $\\omega$ 的时谐场，我们使用相量表示法。一个时域场 $\\mathcal{A}(\\mathbf{r},t)$ 与其复相量 $\\mathbf{A}(\\mathbf{r})$ 的关系为：\n$$\n\\mathcal{A}(\\mathbf{r},t) = \\text{Re}[\\mathbf{A}(\\mathbf{r})e^{-i\\omega t}]\n$$\n$\\mathcal{A}$ 的时间导数为：\n$$\n\\frac{\\partial \\mathcal{A}}{\\partial t} = \\frac{\\partial}{\\partial t}\\text{Re}[\\mathbf{A}e^{-i\\omega t}] = \\text{Re}\\left[\\frac{\\partial}{\\partial t}(\\mathbf{A}e^{-i\\omega t})\\right] = \\text{Re}[-i\\omega \\mathbf{A}e^{-i\\omega t}]\n$$\n这表明，对于任何线性运算，时域中的时间导数算符 $\\frac{\\partial}{\\partial t}$ 对应于相量域中的乘以 $-i\\omega$。将此变换应用于麦克斯韦方程组的两个旋度方程：\n\n法拉第定律：$\\nabla \\times \\mathcal{E} = -\\frac{\\partial \\mathcal{B}}{\\partial t}$ 变为：\n$$\n\\nabla \\times \\mathbf{E} = -(-i\\omega\\mathbf{B}) \\implies \\nabla \\times \\mathbf{E} = i\\omega\\mathbf{B}\n$$\n\n安培-麦克斯韦定律：$\\nabla \\times \\mathcal{H} = \\mathcal{J}_f + \\frac{\\partial \\mathcal{D}}{\\partial t}$ 变为：\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J}_f + (-i\\omega\\mathbf{D}) \\implies \\nabla \\times \\mathbf{H} = \\mathbf{J}_f - i\\omega\\mathbf{D}\n$$\n问题要求用复场振幅 $\\mathbf{E}$、$\\mathbf{B}$、$\\mathbf{D}$、$\\mathbf{H}$ 和 $\\mathbf{J}_f$ 表示旋度方程。在相量域中使用本构关系（$\\mathbf{D}=\\epsilon\\mathbf{E}$，$\\mathbf{B}=\\mu\\mathbf{H}$，$\\mathbf{J}_f=\\sigma\\mathbf{E}$），我们也可以将这些方程写为：\n$$\n\\nabla \\times \\mathbf{E} = i\\omega\\mu\\mathbf{H} \\\\\n\\nabla \\times \\mathbf{H} = (\\sigma - i\\omega\\epsilon)\\mathbf{E}\n$$\n这些就是所要求的相量域旋度方程。\n\n### 2. 相量法的合理性论证\n\n用于分析线性时不变 (LTI) 系统的相量法的有效性基于以下几个关键原则：\n\n-   **线性**：麦克斯韦方程组和给定的本构关系是线性的。这意味着对于代表一个物理过程（如微分或系统响应）的任何线性算符 $L$ 和任意两个场 $\\mathbf{A}_1$ 和 $\\mathbf{A}_2$，对于标量常数 $c_1, c_2$，有 $L(c_1\\mathbf{A}_1 + c_2\\mathbf{A}_2) = c_1L(\\mathbf{A}_1) + c_2L(\\mathbf{A}_2)$。实线性算符 $L$ 的一个基本性质是它与取实部算符对易：$L(\\text{Re}[\\mathbf{Z}]) = \\text{Re}[L(\\mathbf{Z})]$，其中 $\\mathbf{Z}$ 为一个复数量。这使我们能够完全使用复相量进行运算，并仅在最后取实部以恢复物理场。\n\n-   **时不变性**：介质的属性（$\\epsilon, \\mu, \\sigma$）被假定为不随时间变化。这确保了系统对输入信号的响应仅取决于输入本身，而不是施加信号的时间。这种时不变性对于时间导数算符 $\\frac{\\partial}{\\partial t}$ 能够映射为与一个常数（$-i\\omega$）的简单乘法至关重要，因为指数函数 $e^{-i\\omega t}$ 是线性时不变微分算符的本征函数。\n\n-   **叠加性**：线性的一个直接推论。叠加原理允许通过傅里叶分析将任何任意信号分解为正弦分量的和（或积分）。LTI 系统的总响应就是其对每个单独正弦分量响应的总和。这证明了在“窄带近似”所指定的单个代表性频率 $\\omega$ 下分析系统行为的合理性。\n\n-   **因果性**：即结果不能先于原因的原则。在频域分析中，因果性由系统响应函数（例如，介电常数 $\\epsilon(\\omega)$ 或电导率 $\\sigma(\\omega)$）的解析性质来体现，这些函数必须满足 Kramers-Kronig 关系。在本问题中，将 $\\epsilon$、$\\mu$ 和 $\\sigma$ 视为频率局域的实常数是一种理想化。一个更完备的模型将极化和传导的效应合并为一个单一的复介电常数 $\\epsilon_c(\\omega) = \\epsilon(\\omega) + i\\frac{\\sigma(\\omega)}{\\omega}$。虚部代表耗散（损耗），并由因果性与实部从根本上联系在一起。相量形式通过允许使用复响应函数来正确处理这些效应。\n\n总而言之，相量法是一个强大的工具，因为它将时域中具有常系数的线性常微分或偏微分方程转换为频域中更简单的代数方程。其有效性严格建立在系统的 LTI 性质之上。\n\n### 3. 矢量亥姆霍兹方程和色散关系的推导\n\n我们从第1部分中为均匀介质推导的相量域旋度方程开始：\n(1) $\\nabla \\times \\mathbf{E} = i\\omega\\mu\\mathbf{H}$\n(2) $\\nabla \\times \\mathbf{H} = (\\sigma - i\\omega\\epsilon)\\mathbf{E}$\n\n为了推导电场 $\\mathbf{E}$ 的波动方程，我们对（1）式取旋度：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla \\times (i\\omega\\mu\\mathbf{H})\n$$\n由于 $\\omega$ 和 $\\mu$ 是常数（因时不变性和均匀性），它们可以移出旋度算符：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = i\\omega\\mu(\\nabla \\times \\mathbf{H})\n$$\n现在，将方程(2)代入 $\\nabla \\times \\mathbf{H}$：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = i\\omega\\mu [(\\sigma - i\\omega\\epsilon)\\mathbf{E}]\n$$\n展开右边的项可得：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = (i\\omega\\mu\\sigma - i^2\\omega^2\\mu\\epsilon)\\mathbf{E} = (\\omega^2\\mu\\epsilon + i\\omega\\mu\\sigma)\\mathbf{E}\n$$\n接下来，我们将矢量微积分恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}$ 应用于电场 $\\mathbf{E}$：\n$$\n\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2\\mathbf{E} = (\\omega^2\\mu\\epsilon + i\\omega\\mu\\sigma)\\mathbf{E}\n$$\n为了简化此式，我们必须计算 $\\nabla \\cdot \\mathbf{E}$。问题陈述该区域是“无源的”，意味着 $\\rho_f = 0$。根据相量域中的高斯定律，$\\nabla \\cdot \\mathbf{D} = \\rho_f = 0$。对于均匀介质（$\\epsilon$ 是常数），这给出 $\\epsilon(\\nabla \\cdot \\mathbf{E}) = 0$，即 $\\nabla \\cdot \\mathbf{E} = 0$。此条件表明电场是无散的。\n\n当 $\\nabla \\cdot \\mathbf{E} = 0$ 时，$\\nabla(\\nabla \\cdot \\mathbf{E})$ 项为零，方程简化为：\n$$\n- \\nabla^2\\mathbf{E} = (\\omega^2\\mu\\epsilon + i\\omega\\mu\\sigma)\\mathbf{E}\n$$\n这可以重新整理为矢量亥姆霍兹方程的标准形式：\n$$\n\\nabla^2\\mathbf{E} + (\\omega^2\\mu\\epsilon + i\\omega\\mu\\sigma)\\mathbf{E} = 0\n$$\n该方程描述了波的传播。一个均匀平面波解的形式为 $\\mathbf{E}(\\mathbf{r}) = \\mathbf{E}_0 e^{i\\mathbf{k} \\cdot \\mathbf{r}}$，其中 $\\mathbf{k}$ 是复波矢量。将此解代入亥姆霍兹方程得到：\n$$\n\\nabla^2( \\mathbf{E}_0 e^{i\\mathbf{k} \\cdot \\mathbf{r}} ) = (i k_x)^2 + (i k_y)^2 + (i k_z)^2 \\mathbf{E} = -(k_x^2 + k_y^2 + k_z^2)\\mathbf{E} = -k^2\\mathbf{E}\n$$\n其中 $k^2 = \\mathbf{k} \\cdot \\mathbf{k}$ 是波矢量大小的平方。因此，亥姆霍兹方程变成一个代数方程：\n$$\n-k^2\\mathbf{E} + (\\omega^2\\mu\\epsilon + i\\omega\\mu\\sigma)\\mathbf{E} = 0\n$$\n对于非平庸解（$\\mathbf{E} \\neq 0$），标量系数必须为零。这就给出了色散关系，它将波数 $k$ 与频率 $\\omega$ 以及介质的性质联系起来：\n$$\n-k^2 + \\omega^2\\mu\\epsilon + i\\omega\\mu\\sigma = 0\n$$\n解出复波数的平方 $k^2$，我们得到最终结果：\n$$\nk^2 = \\omega^2\\mu\\epsilon + i\\omega\\mu\\sigma\n$$\n该表达式是在均匀、各向同性、线性导电介质中均匀平面波的色散关系。$k^2$ 的实部与能量储存有关（如在无损耗电介质中），而虚部则与由欧姆传导引起的能量耗散有关。",
            "answer": "$$\\boxed{\\omega^{2}\\mu\\epsilon + i\\omega\\mu\\sigma}$$"
        },
        {
            "introduction": "从无限介质中的行波转向有界系统中的驻波，我们能更深入地理解能量的局域化和守恒。谐振腔不仅是理想化的物理模型，其原理也适用于分析托卡马克真空室等受限几何结构中的电磁场行为。通过这个实践，你将求解一个理想谐振腔内的完整电磁场时空演化，并计算能量密度和坡印廷矢量，从而直观地验证在无损系统中能量是如何守恒的。",
            "id": "4008751",
            "problem": "一个理想导电平行板谐振腔由位于 $z=0$ 和 $z=L$ 的两个无限大理想导电平面构成，其间为真空。为使所有积分保持有限，我们将注意力限制在 $x$–$y$ 平面内横截面积为 $A$ 的矩形计算单元上，并在此单元的侧面 $x=0$、$x=a$ 和 $y=0$、$y=b$ 处施加周期性边界条件，从而使场在 $x$ 和 $y$ 方向上具有平移不变性，且侧向通量因周期性而两两抵消。在时间 $t=0$ 时，谐振腔内的电场指定为 $\\,\\mathbf{E}(z,0) = E_{0}\\,\\sin\\!\\big(n\\pi z/L\\big)\\,\\hat{\\mathbf{x}}\\,$，磁场为 $\\,\\mathbf{B}(z,0)=\\mathbf{0}\\,$，其中 $E_{0}>0$ 是一个恒定振幅，$n\\in\\mathbb{N}$ 是纵向模式指数。位于 $z=0$ 和 $z=L$ 的谐振腔壁是理想电导体（PEC），因此在这些平面上，切向电场为零。介质是真空，其特性由介电常数 $\\varepsilon_{0}$ 和磁导率 $\\mu_{0}$ 描述，并遵循微分形式的麦克斯韦方程组\n$$\n\\nabla\\times \\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t},\\quad\n\\nabla\\times \\mathbf{B}=\\mu_{0}\\varepsilon_{0}\\frac{\\partial \\mathbf{E}}{\\partial t},\\quad\n\\nabla\\cdot \\mathbf{E}=0,\\quad\n\\nabla\\cdot \\mathbf{B}=0.\n$$\n从这些基本定律和理想电导体（PEC）边界条件出发，完成以下任务：\n1. 推导在所有 $t\\ge 0$ 和 $z\\in[0,L]$ 范围内，与给定初始条件和边界条件一致的电磁场 $\\mathbf{E}(z,t)$ 和 $\\mathbf{B}(z,t)$。\n2. 使用标准电磁能量密度 $\\,u(z,t)=\\tfrac{1}{2}\\big(\\varepsilon_{0}\\,|\\mathbf{E}(z,t)|^{2}+\\tfrac{1}{\\mu_{0}}\\,|\\mathbf{B}(z,t)|^{2}\\big)\\,$ 和坡印亭矢量 $\\,\\mathbf{S}(z,t)=\\tfrac{1}{\\mu_{0}}\\mathbf{E}(z,t)\\times \\mathbf{B}(z,t)\\,$，计算该驻波场的显式空间分布。\n3. 计算通过计算单元整个边界的总瞬时电磁能流，即，\n$$\n\\Phi(t)=\\oint_{\\partial V}\\mathbf{S}(z,t)\\cdot \\hat{\\mathbf{n}}\\,\\mathrm{d}A,\n$$\n其中 $\\partial V$ 由位于 $z=0$ 和 $z=L$、面积为 $A$ 的两个理想电导体（PEC）平面以及周期单元的四个侧面组成。将 $\\Phi(t)$ 的最终答案以瓦特（Watts）为单位表示。\n\n您最终报告的量必须是瞬时净通量 $\\Phi(t)$ 的单一闭合形式表达式。请勿提供不等式。如果您选择简化为常数，请提供该常数。请以瓦特（Watts）为单位陈述您的最终答案。",
            "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。已提供所有必要的数据和边界条件，以求得电磁场及派生量的唯一稳定解。该问题是经典电磁学中的一个标准练习，具体涉及谐振腔中的驻波。因此，我们可以开始求解。\n\n该问题涉及一个理想导电平行板谐振腔内电磁场的时间演化。题目说明场在 $x$ 和 $y$ 方向上具有平移不变性，这意味着所有关于 $x$ 和 $y$ 的偏导数都为零。因此，场 $\\mathbf{E}$ 和 $\\mathbf{B}$ 仅是空间坐标 $z$ 和时间 $t$ 的函数。\n\n### 1. 电磁场 $\\mathbf{E}(z,t)$ 和 $\\mathbf{B}(z,t)$ 的推导\n\n我们从真空中的麦克斯韦方程组开始：\n$$ \\nabla\\times \\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t} \\quad (1) $$\n$$ \\nabla\\times \\mathbf{B}=\\mu_{0}\\varepsilon_{0}\\frac{\\partial \\mathbf{E}}{\\partial t} \\quad (2) $$\n$$ \\nabla\\cdot \\mathbf{E}=0 \\quad (3) $$\n$$ \\nabla\\cdot \\mathbf{B}=0 \\quad (4) $$\n电场的初始条件是 $\\mathbf{E}(z,0) = E_{0}\\,\\sin(n\\pi z/L)\\,\\hat{\\mathbf{x}}$。由于 $\\mathbf{E}$ 最初沿 $\\hat{\\mathbf{x}}$ 方向极化，并且系统在 $x$ 和 $y$ 方向上具有平移不变性，因此电场在所有时间内都将保持沿 $\\hat{\\mathbf{x}}$ 方向极化。我们因此寻求形式为 $\\mathbf{E}(z,t) = E_x(z,t)\\,\\hat{\\mathbf{x}}$ 的解。\n\n使用 $\\partial/\\partial x = 0$ 和 $\\partial/\\partial y = 0$，法拉第定律 (1) 变为：\n$$ \\nabla\\times \\mathbf{E} = \\begin{vmatrix} \\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\ 0  0  \\frac{\\partial}{\\partial z} \\\\ E_x  0  0 \\end{vmatrix} = \\frac{\\partial E_x}{\\partial z} \\hat{\\mathbf{y}} $$\n因此，方程 (1) 意味着 $\\frac{\\partial E_x}{\\partial z} \\hat{\\mathbf{y}} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$。这表明 $\\mathbf{B}$ 必须在 $\\hat{\\mathbf{y}}$ 方向上极化，因此我们可以写成 $\\mathbf{B}(z,t) = B_y(z,t)\\,\\hat{\\mathbf{y}}$。该方程简化为一个标量偏微分方程：\n$$ \\frac{\\partial E_x}{\\partial z} = -\\frac{\\partial B_y}{\\partial t} \\quad (5) $$\n类似地，安培定律 (2) 变为：\n$$ \\nabla\\times \\mathbf{B} = \\begin{vmatrix} \\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\ 0  0  \\frac{\\partial}{\\partial z} \\\\ 0  B_y  0 \\end{vmatrix} = -\\frac{\\partial B_y}{\\partial z} \\hat{\\mathbf{x}} $$\n因此，方程 (2) 给出：\n$$ -\\frac{\\partial B_y}{\\partial z} = \\mu_{0}\\varepsilon_{0}\\frac{\\partial E_x}{\\partial t} \\quad (6) $$\n为了求出 $E_x$ 的波动方程，我们将 (5) 对 $z$ 求导，将 (6) 对 $t$ 求导：\n$$ \\frac{\\partial^2 E_x}{\\partial z^2} = -\\frac{\\partial^2 B_y}{\\partial z \\partial t} \\quad \\text{和} \\quad -\\frac{\\partial^2 B_y}{\\partial t \\partial z} = \\mu_{0}\\varepsilon_{0}\\frac{\\partial^2 E_x}{\\partial t^2} $$\n令 $B_y$ 的混合偏导数相等，得到 $E_x$ 的一维波动方程：\n$$ \\frac{\\partial^2 E_x}{\\partial z^2} = \\mu_{0}\\varepsilon_{0}\\frac{\\partial^2 E_x}{\\partial t^2} = \\frac{1}{c^2}\\frac{\\partial^2 E_x}{\\partial t^2} $$\n其中 $c = 1/\\sqrt{\\mu_0\\varepsilon_0}$ 是真空中的光速。可以通过分离变量法 $E_x(z,t) = Z(z)T(t)$ 求得通解。将理想电导体（PEC）边界条件 $E_x(0,t)=0$ 和 $E_x(L,t)=0$ 应用于空间函数 $Z(z)$，得到形式为 $Z(z) = \\sin(k_z z)$ 的解，其中波数 $k_z$ 被量子化为 $k_z = n\\pi/L$，$n \\in \\mathbb{N}$。相应的时间函数 $T(t)$ 必须满足 $\\frac{d^2T}{dt^2} + \\omega_n^2 T = 0$，其中 $\\omega_n = k_z c = \\frac{n\\pi c}{L}$。$T(t)$ 的通解是 $A \\cos(\\omega_n t) + B \\sin(\\omega_n t)$。\n\n对于问题中给定的特定模式 $n$，电场具有以下形式：\n$$ E_x(z,t) = \\sin\\left(\\frac{n\\pi z}{L}\\right) \\left[ C_1 \\cos(\\omega_n t) + C_2 \\sin(\\omega_n t) \\right] $$\n初始条件 $\\mathbf{E}(z,0) = E_{0}\\sin(n\\pi z/L)\\hat{\\mathbf{x}}$ 给出：\n$$ E_x(z,0) = \\sin\\left(\\frac{n\\pi z}{L}\\right) [C_1] = E_0\\sin\\left(\\frac{n\\pi z}{L}\\right) \\implies C_1 = E_0 $$\n所以，$E_x(z,t) = \\sin(n\\pi z/L) [E_0 \\cos(\\omega_n t) + C_2 \\sin(\\omega_n t)]$。为了求出 $C_2$，我们使用磁场的初始条件 $\\mathbf{B}(z,0)=\\mathbf{0}$。我们首先使用方程 (5) 从 $E_x(z,t)$ 求出 $B_y(z,t)$：\n$$ \\frac{\\partial B_y}{\\partial t} = -\\frac{\\partial E_x}{\\partial z} = -\\frac{n\\pi}{L}\\cos\\left(\\frac{n\\pi z}{L}\\right) \\left[ E_0 \\cos(\\omega_n t) + C_2 \\sin(\\omega_n t) \\right] $$\n对时间 $t$ 积分：\n$$ B_y(z,t) = -\\frac{n\\pi}{L\\omega_n}\\cos\\left(\\frac{n\\pi z}{L}\\right) \\left[ E_0 \\sin(\\omega_n t) - C_2 \\cos(\\omega_n t) \\right] + F(z) $$\n其中 $F(z)$ 是一个积分常数。任何静磁场都必须满足 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$，对于 $\\mathbf{B} = F(z)\\hat{\\mathbf{y}}$，这意味着 $\\partial F/\\partial z = 0$，所以 $F$ 必须是一个常数。初始条件 $\\mathbf{B}(z,0)=\\mathbf{0}$ 得到：\n$$ B_y(z,0) = -\\frac{n\\pi}{L\\omega_n}\\cos\\left(\\frac{n\\pi z}{L}\\right) [-C_2] + F = \\frac{n\\pi C_2}{L\\omega_n}\\cos\\left(\\frac{n\\pi z}{L}\\right) + F = 0 $$\n为使此式对所有 $z$ 成立，我们必须有 $C_2=0$ 和 $F=0$。\n将 $\\omega_n = n\\pi c/L = n\\pi/(L\\sqrt{\\mu_0\\varepsilon_0})$ 代回表达式中，我们得到场的最终形式：\n$$ \\mathbf{E}(z,t) = E_0 \\cos(\\omega_n t) \\sin\\left(\\frac{n\\pi z}{L}\\right) \\hat{\\mathbf{x}} $$\n$$ \\mathbf{B}(z,t) = -\\frac{n\\pi E_0}{L\\omega_n} \\sin(\\omega_n t) \\cos\\left(\\frac{n\\pi z}{L}\\right) \\hat{\\mathbf{y}} = -E_0\\sqrt{\\mu_0\\varepsilon_0} \\sin(\\omega_n t) \\cos\\left(\\frac{n\\pi z}{L}\\right) \\hat{\\mathbf{y}} $$\n其中 $\\omega_n = \\frac{n\\pi}{L\\sqrt{\\mu_0\\varepsilon_0}}$。\n\n### 2. 能量密度和坡印亭矢量\n\n电磁能量密度为 $u(z,t)=\\tfrac{1}{2}(\\varepsilon_{0}|\\mathbf{E}|^2+\\tfrac{1}{\\mu_{0}}|\\mathbf{B}|^2)$。\n$$ |\\mathbf{E}|^2 = E_0^2 \\cos^2(\\omega_n t) \\sin^2\\left(\\frac{n\\pi z}{L}\\right) $$\n$$ |\\mathbf{B}|^2 = E_0^2 \\mu_0\\varepsilon_0 \\sin^2(\\omega_n t) \\cos^2\\left(\\frac{n\\pi z}{L}\\right) $$\n将这些代入 $u(z,t)$ 的表达式中：\n$$ u(z,t) = \\frac{1}{2}\\left[\\varepsilon_0 E_0^2 \\cos^2(\\omega_n t) \\sin^2\\left(\\frac{n\\pi z}{L}\\right) + \\frac{1}{\\mu_0}E_0^2 \\mu_0\\varepsilon_0 \\sin^2(\\omega_n t) \\cos^2\\left(\\frac{n\\pi z}{L}\\right)\\right] $$\n$$ u(z,t) = \\frac{1}{2}\\varepsilon_0 E_0^2 \\left[\\cos^2(\\omega_n t) \\sin^2\\left(\\frac{n\\pi z}{L}\\right) + \\sin^2(\\omega_n t) \\cos^2\\left(\\frac{n\\pi z}{L}\\right)\\right] $$\n坡印亭矢量为 $\\mathbf{S}(z,t)=\\tfrac{1}{\\mu_{0}}\\mathbf{E}(z,t)\\times \\mathbf{B}(z,t)$。\n$$ \\mathbf{E} \\times \\mathbf{B} = \\left(E_x \\hat{\\mathbf{x}}\\right) \\times \\left(B_y \\hat{\\mathbf{y}}\\right) = E_x B_y \\hat{\\mathbf{z}} $$\n$$ E_x B_y = \\left(E_0 \\cos(\\omega_n t) \\sin\\left(\\frac{n\\pi z}{L}\\right)\\right)\\left(-E_0\\sqrt{\\mu_0\\varepsilon_0} \\sin(\\omega_n t) \\cos\\left(\\frac{n\\pi z}{L}\\right)\\right) $$\n$$ E_x B_y = -E_0^2 \\sqrt{\\mu_0\\varepsilon_0} \\cos(\\omega_n t) \\sin(\\omega_n t) \\sin\\left(\\frac{n\\pi z}{L}\\right) \\cos\\left(\\frac{n\\pi z}{L}\\right) $$\n使用恒等式 $\\sin(2\\theta)=2\\sin\\theta\\cos\\theta$，这可以简化为：\n$$ E_x B_y = -E_0^2 \\sqrt{\\mu_0\\varepsilon_0} \\frac{\\sin(2\\omega_n t)}{2} \\frac{\\sin(2n\\pi z/L)}{2} = -\\frac{E_0^2 \\sqrt{\\mu_0\\varepsilon_0}}{4} \\sin(2\\omega_n t) \\sin\\left(\\frac{2n\\pi z}{L}\\right) $$\n所以，坡印亭矢量是：\n$$ \\mathbf{S}(z,t) = -\\frac{E_0^2 \\sqrt{\\mu_0\\varepsilon_0}}{4\\mu_0} \\sin(2\\omega_n t) \\sin\\left(\\frac{2n\\pi z}{L}\\right) \\hat{\\mathbf{z}} = -\\frac{E_0^2}{4}\\sqrt{\\frac{\\varepsilon_0}{\\mu_0}} \\sin(2\\omega_n t) \\sin\\left(\\frac{2n\\pi z}{L}\\right) \\hat{\\mathbf{z}} $$\n\n### 3. 总瞬时能流 $\\Phi(t)$\n\n通过计算单元边界 $\\partial V$ 的总通量 $\\Phi(t)$ 由 $\\Phi(t)=\\oint_{\\partial V}\\mathbf{S}(z,t)\\cdot \\hat{\\mathbf{n}}\\,\\mathrm{d}A$ 给出。边界由位于 $z=L$ 的顶板（法向量 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$）、位于 $z=0$ 的底板（法向量 $\\hat{\\mathbf{n}}=-\\hat{\\mathbf{z}}$）和四个侧面组成。\n坡印亭矢量 $\\mathbf{S}(z,t)$ 纯粹沿 $\\hat{\\mathbf{z}}$ 轴方向。因此，它与侧面法向量（$\\pm \\hat{\\mathbf{x}}$、$\\pm \\hat{\\mathbf{y}}$）的点积恒为零。因此，通过侧边界的通量为零，这与问题陈述中由于周期性而两两抵消的说法一致。\n\n总通量是穿过顶面和底面的通量之和：\n$$ \\Phi(t) = \\int_{z=L} \\mathbf{S}(L,t) \\cdot (\\hat{\\mathbf{z}}) \\,\\mathrm{d}A + \\int_{z=0} \\mathbf{S}(0,t) \\cdot (-\\hat{\\mathbf{z}}) \\,\\mathrm{d}A $$\n由于 $\\mathbf{S}$ 与 $x$ 和 $y$ 无关，对面积 $A$ 的积分变成简单的乘法：\n$$ \\Phi(t) = A \\cdot S_z(L,t) - A \\cdot S_z(0,t) $$\n其中 $S_z(z,t)$ 是坡印亭矢量的 z 分量。我们在边界处计算 $S_z$：\n在 $z=L$ 处：\n$$ S_z(L,t) = -\\frac{E_0^2}{4}\\sqrt{\\frac{\\varepsilon_0}{\\mu_0}} \\sin(2\\omega_n t) \\sin\\left(\\frac{2n\\pi L}{L}\\right) = -\\frac{E_0^2}{4}\\sqrt{\\frac{\\varepsilon_0}{\\mu_0}} \\sin(2\\omega_n t) \\sin(2n\\pi) $$\n由于 $n$ 是整数（$n \\in \\mathbb{N}$），$\\sin(2n\\pi)=0$。因此，$S_z(L,t)=0$。\n在 $z=0$ 处：\n$$ S_z(0,t) = -\\frac{E_0^2}{4}\\sqrt{\\frac{\\varepsilon_0}{\\mu_0}} \\sin(2\\omega_n t) \\sin\\left(\\frac{2n\\pi \\cdot 0}{L}\\right) = -\\frac{E_0^2}{4}\\sqrt{\\frac{\\varepsilon_0}{\\mu_0}} \\sin(2\\omega_n t) \\sin(0) $$\n因此，$S_z(0,t)=0$。\n\n将这些结果代入总通量的表达式中：\n$$ \\Phi(t) = A \\cdot (0) - A \\cdot (0) = 0 $$\n在所有时间 $t$，从计算体积流出的总瞬时能流均为零。对于一个无损系统（理想导体，无材料耗散），这个结果是符合物理预期的。腔内的总能量是守恒的，只是在电能和磁能形式之间以及不同空间位置之间振荡。坡印亭定理 $\\oint \\mathbf{S}\\cdot\\hat{\\mathbf{n}}\\,\\mathrm{d}A = - \\frac{d}{dt}\\int_V u\\,\\mathrm{d}V$ 证实，如果总能量 $U_{EM} = \\int_V u\\,\\mathrm{d}V$ 是恒定的，净通量必须为零。直接计算表明 $U_{EM} = \\frac{1}{4}\\varepsilon_0 E_0^2 A L$，这确实是一个常数，从而验证了我们关于通量的结果。\n\n瞬时净通量 $\\Phi(t)$ 的最终答案是 $0$ 瓦特。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "连接连续的解析理论与离散的计算实践是计算聚变科学的核心挑战之一。若直接在计算网格上离散麦克斯韦方程组，可能会在数值上破坏 $\\nabla \\cdot \\mathbf{B} = 0$ 这一基本物理定律，从而导致非物理的模拟结果。本节实践将介绍一种在计算磁流体力学和电磁学模拟中至关重要的技术——约束输运方法，并从第一性原理出发，推导为何在交错网格（Yee网格）上使用该方法能够精确地保持磁场的无散度条件。",
            "id": "4008762",
            "problem": "在磁化聚变等离子体的三维笛卡尔模拟中，使用了一种麦克斯韦方程组的有限体积离散化方法，该模拟采用结构化网格，网格单元由 $(i,j,k)$ 索引，并具有均匀的间距 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$。磁场 $\\mathbf{B}$ 以交错方式表示：分量 $B_x$ 作为面平均值存储在位于 $(i+\\tfrac{1}{2},j,k)$ 的 $x$ 方向法向面上，$B_y$ 存储在位于 $(i,j+\\tfrac{1}{2},k)$ 的 $y$ 方向法向面上，$B_z$ 存储在位于 $(i,j,k+\\tfrac{1}{2})$ 的 $z$ 方向法向面上。电场 $\\mathbf{E}$ 作为棱平均值存储：$E_x$ 存储在位于 $(i,j+\\tfrac{1}{2},k+\\tfrac{1}{2})$ 且平行于 $x$ 轴的棱上，$E_y$ 存储在位于 $(i+\\tfrac{1}{2},j,k+\\tfrac{1}{2})$ 且平行于 $y$ 轴的棱上，$E_z$ 存储在位于 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2},k)$ 且平行于 $z$ 轴的棱上。这种交错排列通常被称为 Yee 网格。\n\n要求您在计算聚变科学与工程的背景下，分析用于保持磁场无散条件的约束输运策略。从麦克斯韦方程组的积分形式开始：\n- 磁高斯定律：对于任何闭合曲面 $S$，$\\oiint_{S} \\mathbf{B} \\cdot d\\mathbf{S} = 0$。\n- 法拉第定律：对于任何边界为 $\\partial S$ 的开放曲面 $S$，$\\dfrac{\\partial}{\\partial t} \\int_{S} \\mathbf{B}\\cdot d\\mathbf{S} = - \\oint_{\\partial S} \\mathbf{E} \\cdot d\\mathbf{l}$。\n\n将网格单元 $(i,j,k)$ 处的离散散度定义为\n$$\n(\\nabla_h \\cdot \\mathbf{B})_{i,j,k} = \\frac{1}{\\Delta x \\Delta y \\Delta z}\\Big[ B_x\\big(i+\\tfrac{1}{2},j,k\\big)\\,\\Delta y \\Delta z - B_x\\big(i-\\tfrac{1}{2},j,k\\big)\\,\\Delta y \\Delta z \n+ B_y\\big(i,j+\\tfrac{1}{2},k\\big)\\,\\Delta x \\Delta z - B_y\\big(i,j-\\tfrac{1}{2},k\\big)\\,\\Delta x \\Delta z \n+ B_z\\big(i,j,k+\\tfrac{1}{2}\\big)\\,\\Delta x \\Delta y - B_z\\big(i,j,k-\\tfrac{1}{2}\\big)\\,\\Delta x \\Delta y \\Big],\n$$\n并通过对每个面应用环路积分，将面心 $\\mathbf{B}$ 的约束输运更新定义为棱心 $\\mathbf{E}$ 的离散旋度，这与法拉第定律以及每个面及其边界棱的方向一致：\n$$\nB_f^{n+1} = B_f^{n} - \\frac{\\Delta t}{A_f} \\sum_{e \\in \\partial f} \\sigma_{f,e}\\, E_e^n\\, L_e,\n$$\n其中 $f$ 表示一个面，$e$ 表示属于 $f$ 边界的一条棱，$A_f$ 是面面积，$L_e$ 是棱长度，$\\sigma_{f,e} \\in \\{+1,-1\\}$ 编码了面环流方向和棱方向之间的相对方向。假设边界条件为周期性或理想导电壁，使得边界项的处理与约束输运更新一致。\n\n仅使用所述的积分定律和这些离散算子，从第一性原理推导为什么约束输运更新能在所有时间步上精确地保持每个内部网格单元中 $\\mathbf{B}$ 的离散散度，从而在初始值为零的情况下保持 $(\\nabla_h \\cdot \\mathbf{B})_{i,j,k} = 0$。您的推导应明确地追踪跨面和棱的带方向求和，并解释导致此结果的抵消过程。\n\n然后，通过选择所有关于散度保持和交错离散化的正确陈述来回答以下多项选择题：\n\nA. 对于面心 $\\mathbf{B}$ 和棱心 $\\mathbf{E}$，如果磁场更新对每个面使用与 Stokes 定理一致的离散线积分，则在所有时间步上，每个内部网格单元的离散散度都被精确保持（取决于边界处理），只要初始离散散度为零。\n\nB. 使用体心 $\\mathbf{B}$ 和体心 $\\mathbf{E}$，并采用旋度的分量式中心差分近似，可以精确保持离散散度，因为解析恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{E}) = 0$ 逐点成立。\n\nC. 约束输运要求将电场存储在网格单元的面心；将 $\\mathbf{E}$ 置于棱上会导致散度保持失效。\n\nD. 在一个均匀的逻辑矩形网格上，如果在一个交错（Yee）网格上执行约束输运更新，并且所有相邻面一致地使用相同的棱电动势（例如，通过与 Riemann 求解器一致的面通量平均值计算），那么只要初始离散散度为零，离散散度就会在舍入误差范围内得到保持，且与材料本构性质无关。\n\nE. 在具有空间变化磁导率的介质中，约束输运不能保持 $\\nabla \\cdot \\mathbf{B} = 0$，因为当 $\\mathbf{B} = \\mu \\mathbf{H}$ 时，无散条件适用于 $\\mathbf{H}$ 而不是 $\\mathbf{B}$。\n\n选择所有适用项。您的选择中不要提供推导；您的推导应出现在选择选项之前。",
            "solution": "首先验证问题陈述，以确保其科学上合理、适定且客观。\n\n### 步骤 1：提取已知条件\n- **网格**：三维笛卡尔网格，网格单元为 $(i,j,k)$，均匀间距为 $\\Delta x$、$\\Delta y$、$\\Delta z$。\n- **磁场 ($\\mathbf{B}$)**：存储为面平均值。$B_x$ 在位于 $(i+\\tfrac{1}{2},j,k)$ 的面上，$B_y$ 在 $(i,j+\\tfrac{1}{2},k)$ 的面上，$B_z$ 在 $(i,j,k+\\tfrac{1}{2})$ 的面上。\n- **电场 ($\\mathbf{E}$)**：存储为棱平均值。$E_x$ 在位于 $(i,j+\\tfrac{1}{2},k+\\tfrac{1}{2})$ 的棱上，$E_y$ 在 $(i+\\tfrac{1}{2},j,k+\\tfrac{1}{2})$ 的棱上，$E_z$ 在 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2},k)$ 的棱上。这是一个 Yee 网格。\n- **控制积分定律**：\n    - 磁高斯定律：对于任何闭合曲面 $S$，$\\oiint_{S} \\mathbf{B} \\cdot d\\mathbf{S} = 0$。\n    - 法拉第感应定律：对于任何边界为 $\\partial S$ 的开放曲面 $S$，$\\dfrac{\\partial}{\\partial t} \\int_{S} \\mathbf{B}\\cdot d\\mathbf{S} = - \\oint_{\\partial S} \\mathbf{E} \\cdot d\\mathbf{l}$。\n- **离散散度**：\n$$\n(\\nabla_h \\cdot \\mathbf{B})_{i,j,k} = \\frac{1}{\\Delta x \\Delta y \\Delta z}\\Big[ B_x\\big(i+\\tfrac{1}{2},j,k\\big)\\,\\Delta y \\Delta z - B_x\\big(i-\\tfrac{1}{2},j,k\\big)\\,\\Delta y \\Delta z \n+ B_y\\big(i,j+\\tfrac{1}{2},k\\big)\\,\\Delta x \\Delta z - B_y\\big(i,j-\\tfrac{1}{2},k\\big)\\,\\Delta x \\Delta z \n+ B_z\\big(i,j,k+\\tfrac{1}{2}\\big)\\,\\Delta x \\Delta y - B_z\\big(i,j,k-\\tfrac{1}{2}\\big)\\,\\Delta x \\Delta y \\Big]\n$$\n- **约束输运更新法则**：\n$$\nB_f^{n+1} = B_f^{n} - \\frac{\\Delta t}{A_f} \\sum_{e \\in \\partial f} \\sigma_{f,e}\\, E_e^n\\, L_e\n$$\n其中 $f$ 是一个面，$e$ 是其边界 $\\partial f$ 上的一条棱，$A_f$ 是面面积，$L_e$ 是棱长度，$\\sigma_{f,e}$ 是一个方向符号。\n- **边界条件**：周期性或理想导电壁，处理方式一致。\n- **目标**：从第一性原理推导为什么约束输运更新能保持 $(\\nabla_h \\cdot \\mathbf{B})_{i,j,k} = 0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题基于麦克斯韦方程组及其在 Yee 网格上的离散化，这是计算电磁学和计算聚变科学中的一个标准和基本课题。所提供的方程和定义是对物理定律和数值方法的正确表述。\n- **适定性**：任务是进行特定的数学推导并据此评估论断。所提供的定义和定律足以完成任务。问题清晰且有确切答案。\n- **客观性**：问题使用精确的技术语言，没有主观或模糊的术语。\n- **完整性**：推导所需的所有组成部分——积分定律、离散算子和网格结构——都已明确定义。\n- **未检测到其他缺陷**：问题并非微不足道、不切实际或不科学。\n\n### 步骤 3：结论与行动\n问题陈述有效。将继续进行求解。\n\n### 散度保持性的推导\n\n核心任务是证明如果离散散度在时间步 $n$ 为零，那么在时间步 $n+1$ 它仍然为零。这意味着我们必须证明 $(\\nabla_h \\cdot \\mathbf{B})^{n+1}_{i,j,k} = (\\nabla_h \\cdot \\mathbf{B})^{n}_{i,j,k}$。\n\n让我们从问题中提供的网格单元 $(i,j,k)$ 处的离散散度定义开始。这可以被看作是磁高斯定律的离散版本，应用于网格单元 $(i,j,k)$ 的控制体积。设 $V_{cell} = \\Delta x \\Delta y \\Delta z$ 为网格单元体积。离散散度是流出该网格单元的净磁通量除以网格单元体积。\n$$\n(\\nabla_h \\cdot \\mathbf{B})_{i,j,k} = \\frac{1}{V_{cell}} \\oiint_{\\partial C_{i,j,k}} \\mathbf{B} \\cdot d\\mathbf{S}\n$$\n其中积分被离散化为通过网格单元 $C_{i,j,k}$ 六个面的通量之和：\n$$\n\\oiint_{\\partial C_{i,j,k}} \\mathbf{B} \\cdot d\\mathbf{S} \\equiv \\sum_{f \\in \\partial C_{i,j,k}} (B_f \\cdot n_f) A_f\n$$\n这里，$f$ 表示构成网格单元 $C_{i,j,k}$ 边界的六个面之一，$A_f$ 是面 $f$ 的面积，$B_f$ 是垂直于该面的面平均磁场分量。项 $(B_f \\cdot n_f)$ 对应于问题陈述中特定面位置上的特定分量（例如，对于法向朝向 $+x$ 方向的面，是 $B_x(i+\\tfrac{1}{2},j,k)$）。问题中 $(\\nabla_h \\cdot \\mathbf{B})$ 公式中的符号正确地实现了向外通量的计算。\n\n让我们求解下一个时间步 $n+1$ 的离散散度：\n$$\n(\\nabla_h \\cdot \\mathbf{B})^{n+1}_{i,j,k} = \\frac{1}{V_{cell}} \\sum_{f \\in \\partial C_{i,j,k}} (B_f^{n+1} \\cdot n_f) A_f\n$$\n现在，为每个 $B_f^{n+1}$ 代入约束输运更新法则：\n$$\nB_f^{n+1} = B_f^{n} - \\frac{\\Delta t}{A_f} \\sum_{e \\in \\partial f} \\sigma_{f,e}\\, E_e^n\\, L_e\n$$\n注意，$\\sum_{e \\in \\partial f} \\sigma_{f,e}\\, E_e^n\\, L_e$ 是围绕面 $f$ 边界的离散线积分，或称电动势 (EMF)，我们将其记为 $\\oint_{\\partial f} \\mathbf{E}^n \\cdot d\\mathbf{l}$。符号 $\\sigma_{f,e}$ 的选择遵循了关联 $\\partial f$ 周围环流方向和面法向量的右手定则。\n将更新法则代入 $n+1$ 时刻的散度表达式中：\n$$\n(\\nabla_h \\cdot \\mathbf{B})^{n+1}_{i,j,k} = \\frac{1}{V_{cell}} \\sum_{f \\in \\partial C_{i,j,k}} A_f \\left( B_f^n - \\frac{\\Delta t}{A_f} \\oint_{\\partial f} \\mathbf{E}^n \\cdot d\\mathbf{l} \\right)\n$$\n$$\n(\\nabla_h \\cdot \\mathbf{B})^{n+1}_{i,j,k} = \\frac{1}{V_{cell}} \\sum_{f \\in \\partial C_{i,j,k}} A_f B_f^n - \\frac{\\Delta t}{V_{cell}} \\sum_{f \\in \\partial C_{i,j,k}} \\oint_{\\partial f} \\mathbf{E}^n \\cdot d\\mathbf{l}\n$$\n右侧第一项就是时间 $n$ 的离散散度：\n$$\n(\\nabla_h \\cdot \\mathbf{B})^{n+1}_{i,j,k} = (\\nabla_h \\cdot \\mathbf{B})^{n}_{i,j,k} - \\frac{\\Delta t}{V_{cell}} \\sum_{f \\in \\partial C_{i,j,k}} \\oint_{\\partial f} \\mathbf{E}^n \\cdot d\\mathbf{l}\n$$\n为了证明散度是保持的，我们必须证明第二项恒等于零：\n$$\n\\sum_{f \\in \\partial C_{i,j,k}} \\oint_{\\partial f} \\mathbf{E}^n \\cdot d\\mathbf{l} = 0\n$$\n这是六个线积分的和，立方体单元 $C_{i,j,k}$ 的每个面各一个。让我们分析来自棱的贡献。网格单元 $C_{i,j,k}$ 有12条棱。其中的每一条棱都恰好被该单元边界上六个面中的两个面所共享。\n\n考虑网格单元 $C_{i,j,k}$ 边界上的任意一条棱 $e_0$。设这条棱被两个相邻的面 $f_1$ 和 $f_2$ 共享，这两个面都是边界 $\\partial C_{i,j,k}$ 的一部分。这条棱上的电场为 $E_{e_0}$，其长度为 $L_{e_0}$。\n棱 $e_0$ 的项将在总和中出现两次：一次在 $f_1$ 的线积分中，一次在 $f_2$ 的线积分中。\n$$\n\\sum_{f \\in \\partial C_{i,j,k}} \\oint_{\\partial f} \\mathbf{E} \\cdot d\\mathbf{l} = \\dots + (\\text{来自} e_0 \\text{在} \\oint_{\\partial f_1} \\text{中的贡献}) + (\\text{来自} e_0 \\text{在} \\oint_{\\partial f_2} \\text{中的贡献}) + \\dots\n$$\n每个面的线积分 $\\oint_{\\partial f}$ 的方向是由相对于该面朝外法向量的右手定则决定的。\n让我们举一个具体的例子。考虑位于 $(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k)$ 且平行于 $z$ 轴的棱。它承载了电场分量 $E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k)$。这条棱被位于 $(i+\\tfrac{1}{2}, j, k)$ 的面 $f_x$ 和位于 $(i, j+\\tfrac{1}{2}, k)$ 的面 $f_y$ 共享。\n1.  对于位于 $(i+\\tfrac{1}{2}, j, k)$ 的面 $f_x$，其朝外法向量在 $+x$ 方向。根据右手定则，其边界上的环流路径包括沿 $+z$ 方向遍历我们所选的棱。它对 $f_x$ 线积分的贡献是 $+ E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k) \\Delta z$。\n2.  对于位于 $(i, j+\\tfrac{1}{2}, k)$ 的面 $f_y$，其朝外法向量在 $+y$ 方向。根据右手定则，其边界上的环流路径包括沿 $-z$ 方向遍历我们所选的棱。它对 $f_y$ 线积分的贡献是 $- E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k) \\Delta z$。\n\n这条棱 $E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k)$ 对所有面的总和的贡献之和是：\n$$\n+E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k)\\Delta z - E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k)\\Delta z = 0\n$$\n这种抵消的发生是因为，当单元表面上的任何给定棱被视为其分隔的两个相邻面边界的一部分时，它被以相反的方向遍历。由于这对网格单元的所有12条棱都成立，所有棱贡献的总和为零。每条棱的电动势 $E_e L_e$ 在总和中恰好出现两次，符号相反。\n\n因此，我们证明了：\n$$\n\\sum_{f \\in \\partial C_{i,j,k}} \\oint_{\\partial f} \\mathbf{E}^n \\cdot d\\mathbf{l} = 0\n$$\n这是向量微积分恒等式 $\\oiint_S (\\nabla \\times \\mathbf{E}) \\cdot d\\mathbf{S} = 0$ (对于任意闭合曲面 $S$) 的一个离散模拟。Yee 网格中变量的交错排列确保了该恒等式在离散层面上精确成立。\n\n这导出了离散散度时间演化的最终结果：\n$$\n(\\nabla_h \\cdot \\mathbf{B})^{n+1}_{i,j,k} = (\\nabla_h \\cdot \\mathbf{B})^{n}_{i,j,k} - 0\n$$\n$$\n(\\nabla_h \\cdot \\mathbf{B})^{n+1}_{i,j,k} = (\\nabla_h \\cdot \\mathbf{B})^{n}_{i,j,k}\n$$\n这证明了约束输运更新方案在所有时间内都保持了每个网格单元中磁场的离散散度。如果初始条件满足 $(\\nabla_h \\cdot \\mathbf{B})^0_{i,j,k} = 0$，那么对于所有 $n > 0$，$(\\nabla_h \\cdot \\mathbf{B})^n_{i,j,k} = 0$ (在浮点舍入误差范围内)。\n\n### 选项评估\n\n**A. 对于面心 B 和棱心 E，如果磁场更新对每个面使用与 Stokes 定理一致的离散线积分，则在所有时间步上，每个内部网格单元的离散散度都被精确保持（取决于边界处理），只要初始离散散度为零。**\n**正确。** 该陈述准确地总结了上述推导的结果。Yee 网格（面心 $\\mathbf{B}$，棱心 $\\mathbf{E}$）和约束输运更新（离散线积分）正是导致精确的几何抵消的要素，从而保持了离散散度。\n\n**B. 使用体心 B 和体心 E，并采用旋度的分量式中心差分近似，可以精确保持离散散度，因为解析恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{E}) = 0$ 逐点成立。**\n**错误。** 这描述的是一种并置网格方案。虽然在均匀网格上，对于标准的中心差分算子 $(\\delta)$，恒等式 $\\delta_x \\delta_y = \\delta_y \\delta_x$ 成立，从而导致 $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{E}) = 0$ 中的形式上的抵消，但这类方案是出了名的问题重重。它们容易受到数值不稳定性的影响，例如奇偶解耦（棋盘格模式），其中非物理的高频振荡可以存在于解中，而根据中心差分模板其导数为零。这使得散度的“保持”不具鲁棒性。Yee 方案的交错网格正是为了克服这些问题而发明的。此外，其论证“因为解析恒等式...逐点成立”是一个有缺陷的论点，因为它在没有合理解释的情况下将连续属性与离散属性混为一谈。\n\n**C. 约束输运要求将电场存储在网格单元的面心；将 E 置于棱上会导致散度保持失效。**\n**错误。** 该陈述与问题描述和推导直接矛盾。问题设置了一个 $\\mathbf{E}$ 在棱上的 Yee 网格，并要求证明散度保持性，我们刚刚完成了这个证明。因此，将 $\\mathbf{E}$ 放在棱上不仅可行，而且对于这种类型的交错网格是标准且正确的方法。\n\n**D. 在一个均匀的逻辑矩形网格上，如果在一个交错（Yee）网格上执行约束输运更新，并且所有相邻面一致地使用相同的棱电动势（例如，通过与 Riemann 求解器一致的面通量平均值计算），那么只要初始离散散度为零，离散散度就会在舍入误差范围内得到保持，且与材料本构性质无关。**\n**正确。** 这是陈述 A 的一个更详细、计算上更精确的版本。它正确地指出了抵消的关键条件：所有共享该棱的面在更新时使用*相同*的棱电动势值 ($E_e L_e$)。提及“在舍入误差范围内保持”是对有限精度算法的实际承认，比“精确地”更严谨。最后，它正确地指出，这种抵消是该方案纯粹的几何/拓扑性质，因此与决定 $\\mathbf{E}$ *值*的材料性质（如 $\\mu$ 或 $\\epsilon$）无关，而与基于法拉第定律的更新结构无关。\n\n**E. 在具有空间变化磁导率的介质中，约束输运不能保持 $\\nabla \\cdot \\mathbf{B} = 0$，因为当 $\\mathbf{B} = \\mu \\mathbf{H}$ 时，无散条件适用于 $\\mathbf{H}$ 而不是 $\\mathbf{B}$。**\n**错误。** 这个陈述有两个根本性的错误。首先，磁高斯定律 $\\nabla \\cdot \\mathbf{B} = 0$ 是一条普适的物理定律，在所有材料中都有效，无论磁导率 $\\mu$ 是常数还是空间变化的。从根本上说无散的场是 $\\mathbf{B}$，而不是 $\\mathbf{H}$。其次，正如在推导和选项 D 的分析中所确立的，约束输运的散度保持性质是法拉第定律 ($\\partial \\mathbf{B}/\\partial t = -\\nabla \\times \\mathbf{E}$) 离散化几何结构的结果，与本构关系 $\\mathbf{B} = \\mu \\mathbf{H}$ 无关。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}