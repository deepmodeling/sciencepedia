{
    "hands_on_practices": [
        {
            "introduction": "要掌握制造解方法（Method of Manufactured Solutions, MMS），第一步是将其应用于一个基础但重要的方程。本练习将以一个线性的平流-扩散偏微分方程（PDE）为起点，引导您实践MMS的核心流程。通过为一个精心选择的解析解计算其偏导数，并将其代入控制方程，您将能够推导出使该解成立所必需的源项，从而在一个相对简单的框架内，牢固掌握MMS的基本操作 。",
            "id": "3952656",
            "problem": "在计算聚变科学与工程中，代码验证要求证明数值实现能够再现一个控制模型的已知精确解。一种标准方法是“人造解法”（Method of Manufactured Solutions, MMS），该方法选择一个解析函数，并推导出使该函数成为目标方程精确解的源项。考虑具有常系数的一维线性平流-扩散偏微分方程（PDE），\n$u_t + a u_x = \\nu u_{xx}$，\n该方程定义在空间域 $x\\in[0,1]$ 上，具有周期性边界条件，其中 $a0$ 是平流速度，$\\nu0$ 是扩散系数。使用“人造解法”（MMS），指定人造解为\n$u(x,t) = \\sin(2\\pi x)\\,\\exp(-t)$，\n该解与 $[0,1]$ 上的周期性边界条件兼容。为了使该人造解对所有 $x\\in[0,1]$ 和所有 $t\\ge 0$ 都是精确解，用一个源项扩充该偏微分方程如下\n$u_t + a u_x = \\nu u_{xx} + S(x,t)$。\n仅从偏导数的定义、标准三角恒等式以及上述控制偏微分方程出发，推导所需源项 $S(x,t)$ 的闭式解析表达式，从而使人造解在空间和时间上恒等地满足扩充后的偏微分方程。将您的最终答案表示为单个解析表达式。无需四舍五入，也无需单位。",
            "solution": "所述问题是有效的。这是一个适定的数学问题，基于偏微分方程的既定原理和“人造解法”——计算科学中代码验证的一种标准技术。所有提供的信息都是自洽的，足以推导出一个唯一的解。\n\n目标是确定源项 $S(x,t)$，该源项使得人造解 $u(x,t)$ 成为扩充后的一维线性平流-扩散方程的精确解。扩充后的偏微分方程由下式给出：\n$$u_{t} + a u_{x} = \\nu u_{xx} + S(x,t)$$\n其中 $u_t = \\frac{\\partial u}{\\partial t}$，$u_x = \\frac{\\partial u}{\\partial x}$，以及 $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$。系数 $a$ 和 $\\nu$ 是正常数。\n\n为了求源项 $S(x,t)$，我们首先整理偏微分方程以分离出 $S(x,t)$：\n$$S(x,t) = u_{t} + a u_{x} - \\nu u_{xx}$$\n\n指定的人造解是：\n$$u(x,t) = \\sin(2\\pi x)\\,\\exp(-t)$$\n\n现在我们必须计算 $u(x,t)$ 关于时间 $t$ 和空间 $x$ 的必要偏导数。\n\n首先，我们计算关于时间的偏导数 $u_t$：\n$$u_{t} = \\frac{\\partial}{\\partial t} \\left[ \\sin(2\\pi x)\\,\\exp(-t) \\right]$$\n由于 $\\sin(2\\pi x)$ 与 $t$ 无关，在对时间求导时，我们将其视为一个常数因子：\n$$u_{t} = \\sin(2\\pi x) \\cdot \\frac{d}{dt}\\left[\\exp(-t)\\right]$$\n使用求导的链式法则，其中 $\\frac{d}{dt}\\exp(f(t)) = \\exp(f(t)) \\cdot f'(t)$，我们得到：\n$$u_{t} = \\sin(2\\pi x) \\cdot \\left[ \\exp(-t) \\cdot (-1) \\right]$$\n$$u_{t} = -\\sin(2\\pi x)\\,\\exp(-t)$$\n\n接下来，我们计算关于空间的一阶偏导数 $u_x$：\n$$u_{x} = \\frac{\\partial}{\\partial x} \\left[ \\sin(2\\pi x)\\,\\exp(-t) \\right]$$\n在这里，$\\exp(-t)$ 与 $x$ 无关，被视为一个常数因子：\n$$u_{x} = \\exp(-t) \\cdot \\frac{d}{dx}\\left[\\sin(2\\pi x)\\right]$$\n使用链式法则，其中 $\\frac{d}{dx}\\sin(g(x)) = \\cos(g(x)) \\cdot g'(x)$，我们发现：\n$$u_{x} = \\exp(-t) \\cdot \\left[ \\cos(2\\pi x) \\cdot (2\\pi) \\right]$$\n$$u_{x} = 2\\pi\\,\\cos(2\\pi x)\\,\\exp(-t)$$\n\n最后，我们通过对 $u_x$ 求导来计算关于空间的二阶偏导数 $u_{xx}$：\n$$u_{xx} = \\frac{\\partial}{\\partial x} \\left[ u_{x} \\right] = \\frac{\\partial}{\\partial x} \\left[ 2\\pi\\,\\cos(2\\pi x)\\,\\exp(-t) \\right]$$\n同样，项 $2\\pi$ 和 $\\exp(-t)$ 相对于 $x$ 是常数：\n$$u_{xx} = 2\\pi\\,\\exp(-t) \\cdot \\frac{d}{dx}\\left[\\cos(2\\pi x)\\right]$$\n使用链式法则，其中 $\\frac{d}{dx}\\cos(g(x)) = -\\sin(g(x)) \\cdot g'(x)$，我们得到：\n$$u_{xx} = 2\\pi\\,\\exp(-t) \\cdot \\left[ -\\sin(2\\pi x) \\cdot (2\\pi) \\right]$$\n$$u_{xx} = -(2\\pi)^{2}\\,\\sin(2\\pi x)\\,\\exp(-t)$$\n$$u_{xx} = -4\\pi^{2}\\,\\sin(2\\pi x)\\,\\exp(-t)$$\n\n现在我们将这些推导出的偏导数代入 $S(x,t)$ 的表达式中：\n$$S(x,t) = u_{t} + a u_{x} - \\nu u_{xx}$$\n$$S(x,t) = \\left[ -\\sin(2\\pi x)\\,\\exp(-t) \\right] + a\\left[ 2\\pi\\,\\cos(2\\pi x)\\,\\exp(-t) \\right] - \\nu\\left[ -4\\pi^{2}\\,\\sin(2\\pi x)\\,\\exp(-t) \\right]$$\n\n为了获得最终的闭式表达式，我们提出公因子 $\\exp(-t)$：\n$$S(x,t) = \\exp(-t) \\left[ -\\sin(2\\pi x) + 2a\\pi\\,\\cos(2\\pi x) + 4\\nu\\pi^{2}\\,\\sin(2\\pi x) \\right]$$\n\n最后，我们将包含 $\\sin(2\\pi x)$ 和 $\\cos(2\\pi x)$ 的项组合起来，以简化括号内的表达式：\n$$S(x,t) = \\exp(-t) \\left[ (4\\nu\\pi^{2} - 1)\\sin(2\\pi x) + 2a\\pi\\,\\cos(2\\pi x) \\right]$$\n\n这就是所需的源项 $S(x,t)$，它确保了人造函数 $u(x,t) = \\sin(2\\pi x)\\,\\exp(-t)$ 是扩充后的平流-扩散方程的精确解。",
            "answer": "$$\\boxed{\\exp(-t) \\left[ (4\\pi^{2}\\nu - 1)\\sin(2\\pi x) + 2a\\pi\\cos(2\\pi x) \\right]}$$"
        },
        {
            "introduction": "在掌握了线性方程的MMS应用后，下一步是挑战更复杂的非线性问题。本练习将研究黏性伯格斯方程，这是一个能够代表聚变等离子体和流体动力学中对流与扩散耦合的关键非线性模型。虽然MMS的基本程序保持不变，但非线性项 $u u_x$ 的存在需要更细致的微积分处理，这充分展示了MMS在处理计算科学中更广泛、更现实的非线性问题时的强大能力 。",
            "id": "3952620",
            "problem": "在计算聚变科学与工程中，降维一维输运模型常用于测试近似非线性对流和扩散动力学的数值算法。考虑粘性 Burgers 方程，这是一个代表耦合对流和扩散过程的典型非线性偏微分方程 (PDE)：\n$u_t + u u_x = \\nu u_{xx}$，\n该方程定义在空间域 $x \\in [0,\\pi]$ 和时间 $t \\geq 0$ 上，其中 $\\nu  0$ 是一个恒定的运动粘度。为了使用人工解方法 (MMS) 进行代码验证，该偏微分方程被增加了一个源项，从而使得一个指定的平滑函数成为该受迫偏微分方程的精确解。具体来说，考虑受迫偏微分方程\n$u_t + u u_x = \\nu u_{xx} + f(x,t)$，\n和人工解\n$u^{\\mathrm{MMS}}(x,t) = \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t)$，\n该解是光滑的，在三角函数内容的意义上，在 $[0,\\pi]$ 上是空间周期的，并且确保了在内部对流和扩散都被激活。\n\n仅使用微积分的基本定义和人工解方法 (MMS)，推导源项 $f(x,t)$，使 $u^{\\mathrm{MMS}}(x,t)$ 成为受迫偏微分方程的精确解。同时，确定与域上的 $u^{\\mathrm{MMS}}(x,t)$ 一致的初始条件 $u(x,0)$ 和 Dirichlet 边界数据 $u(0,t)$ 和 $u(\\pi,t)$。将你的最终答案表示为 $f(x,t)$ 的单个闭式解析表达式。不需要单位。不需要四舍五入。",
            "solution": "该问题是有效的。这是一个在计算科学领域内适定且有科学依据的问题，具体涉及用于偏微分方程（PDE）数值格式代码验证的人工解方法（MMS）。该问题要求直接应用多元微积分来推导源项及相关条件，这是一个标准的、可形式化的过程。所有需要的数据和定义都已提供，没有矛盾或歧义。\n\n任务是找到源项 $f(x,t)$，使人工解 $u^{\\mathrm{MMS}}(x,t)$ 成为受迫粘性 Burgers 方程的精确解。源项的方程通过重新排列给定的偏微分方程得到：\n$$f(x,t) = u_{t} + u u_{x} - \\nu u_{xx}$$\n我们给定的人工解是：\n$$u(x,t) = u^{\\mathrm{MMS}}(x,t) = \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t)$$\n为了找到 $f(x,t)$，我们必须计算 $u(x,t)$ 的必要偏导数，并将它们代入 $f(x,t)$ 的表达式中。\n\n首先，我们计算关于时间的偏导数 $u_t$：\n$$u_{t} = \\frac{\\partial}{\\partial t} \\left( \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t) \\right) = \\sin(x)\\,\\exp(t) - \\cos(2x)\\,\\exp(-t)$$\n\n接下来，我们计算关于空间的一阶偏导数 $u_x$：\n$$u_{x} = \\frac{\\partial}{\\partial x} \\left( \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t) \\right) = \\cos(x)\\,\\exp(t) - 2\\sin(2x)\\,\\exp(-t)$$\n\n然后，我们计算关于空间的二阶偏导数 $u_{xx}$：\n$$u_{xx} = \\frac{\\partial}{\\partial x} \\left( \\cos(x)\\,\\exp(t) - 2\\sin(2x)\\,\\exp(-t) \\right) = -\\sin(x)\\,\\exp(t) - 4\\cos(2x)\\,\\exp(-t)$$\n\n现在，我们计算非线性对流项 $u u_x$：\n$$u u_{x} = \\left( \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t) \\right) \\left( \\cos(x)\\,\\exp(t) - 2\\sin(2x)\\,\\exp(-t) \\right)$$\n展开此乘积得到四项：\n$$u u_{x} = \\sin(x)\\cos(x)\\,\\exp(2t) - 2\\sin(x)\\sin(2x) + \\cos(x)\\cos(2x) - 2\\sin(2x)\\cos(2x)\\,\\exp(-2t)$$\n我们使用三角恒等式 $\\sin(A)\\cos(A) = \\frac{1}{2}\\sin(2A)$ 和 $2\\sin(A)\\cos(A) = \\sin(2A)$：\n$$u u_{x} = \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - 2\\sin(x)\\sin(2x) + \\cos(x)\\cos(2x) - \\sin(4x)\\,\\exp(-2t)$$\n不含时间的部分 $\\cos(x)\\cos(2x) - 2\\sin(x)\\sin(2x)$ 可以使用积化和差恒等式进行简化，最终等于 $-\\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$。因此，对流项是：\n$$u u_{x} = \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$$\n\n最后，我们将 $u_t$、$u u_x$ 和 $u_{xx}$ 的表达式代入 $f(x,t)$ 的方程中：\n$$f(x,t) = \\left( \\sin(x)\\,\\exp(t) - \\cos(2x)\\,\\exp(-t) \\right) + \\left( \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x) \\right) - \\nu \\left( -\\sin(x)\\,\\exp(t) - 4\\cos(2x)\\,\\exp(-t) \\right)$$\n我们合并具有相同时间依赖性的项：\n$$f(x,t) = \\left( \\sin(x)\\,\\exp(t) + \\nu\\sin(x)\\,\\exp(t) \\right) + \\left( -\\cos(2x)\\,\\exp(-t) + 4\\nu\\cos(2x)\\,\\exp(-t) \\right) + \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$$\n简化系数得到源项的最终表达式：\n$$f(x,t) = (1+\\nu)\\sin(x)\\,\\exp(t) + (4\\nu-1)\\cos(2x)\\,\\exp(-t) + \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$$\n\n问题还要求确定与人工解一致的初始条件和边界条件。\n在 $t=0$ 时的初始条件是：\n$$u(x,0) = u^{\\mathrm{MMS}}(x,0) = \\sin(x)\\,\\exp(0) + \\cos(2x)\\,\\exp(0) = \\sin(x) + \\cos(2x)$$\n在 $x=0$ 处的 Dirichlet 边界条件是：\n$$u(0,t) = u^{\\mathrm{MMS}}(0,t) = \\sin(0)\\,\\exp(t) + \\cos(0)\\,\\exp(-t) = 0 + 1 \\cdot \\exp(-t) = \\exp(-t)$$\n在 $x=\\pi$ 处的 Dirichlet 边界条件是：\n$$u(\\pi,t) = u^{\\mathrm{MMS}}(\\pi,t) = \\sin(\\pi)\\,\\exp(t) + \\cos(2\\pi)\\,\\exp(-t) = 0 + 1 \\cdot \\exp(-t) = \\exp(-t)$$\n这些为验证目的设置一个适定的数值问题提供了必要的数据。最终要求的答案是 $f(x,t)$ 的解析表达式。",
            "answer": "$$\\boxed{(1+\\nu)\\sin(x)\\exp(t) + (4\\nu-1)\\cos(2x)\\exp(-t) + \\frac{1}{2}\\sin(2x)\\exp(2t) - \\sin(4x)\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)}$$"
        },
        {
            "introduction": "通过制造解方法验证代码不仅仅是生成一个源项，更关键的步骤在于如何分析仿真结果以确认代码的准确性。本练习将带您从MMS测试的“设计阶段”进入“分析阶段”。您将使用来自两个不同网格分辨率的假设仿真数据，推导并应用理查森外推法（Richardson extrapolation），这是一种仅利用数值输出就能估计精确解并验证收敛阶的强大技术，它展示了如何利用MMS数据从简单的“通过/失败”测试升华为对数值误差的深刻洞察 。",
            "id": "3952625",
            "problem": "在沿托卡马克磁场线的平行电子热传导的数值验证中，考虑沿场坐标 $s$ 的一维稳态平行传导方程，其一般形式写作\n$$-\\frac{d}{ds}\\left(\\kappa_{\\parallel}(T)\\frac{dT}{ds}\\right)=S(s),$$\n其中 $\\kappa_{\\parallel}(T)$ 是平行热导率，$S(s)$ 是通过“人造解方法”（Method of Manufactured Solutions, MMS）构造的体积源。此处，MMS定义为指定一个解析解并推导出一个匹配的源项，以实现可控的代码验证。使用中心二阶有限差分格式来近似 $T(s)$。\n\n设 $s_{0}$ 是沿场线的一个固定点，并用 $U_{h}(s_{0})$ 和 $U_{h/2}(s_{0})$ 分别表示在间距为 $h$ 和 $h/2$ 的两个均匀网格上获得的 $T(s_{0})$ 的数值近似。在光滑的人造解和相容的二阶方法下，某一点的主阶离散误差与网格间距的平方成正比。通过MMS将点误差定义为 $E_{h}\\equiv T(s_{0})-U_{h}(s_{0})$ 和 $E_{h/2}\\equiv T(s_{0})-U_{h/2}(s_{0})$。\n\n在 $s_{0}$ 处的一项验证研究产生了以下值（电子温度单位为千电子伏特 (keV)）：\n- 数值近似：$U_{h}(s_{0})=3.200$ 和 $U_{h/2}(s_{0})=3.260$。\n- MMS点误差：$E_{h}=0.080$ 和 $E_{h/2}=0.020$。\n\n从二阶方法的主阶误差模型的定义出发，且不使用任何快捷公式，利用离散误差随网格间距的标度关系，推导出一个用 $U_{h}(s_{0})$ 和 $U_{h/2}(s_{0})$ 表示的精确温度 $T(s_{0})$ 的理查森型外推估计，然后使用给定数据进行数值计算。将您的最终答案四舍五入到四位有效数字，并以keV为单位表示。",
            "solution": "该问题在科学上是合理的，并且是计算科学中代码验证领域的一个标准练习。它要求应用理查森外推法，这是一种从一系列网格上的数值解来估计更高阶精确解的技术。\n\n问题的核心是利用该数值方法的已知收敛阶来消除主导误差项。\n\n1.  **建立误差模型**：\n    对于一个二阶收敛的有限差分方法，在某一点 $s_0$ 的数值解 $U_h(s_0)$ 与精确解 $T(s_0)$ 之间的误差可以表示为：\n    $E_h = T(s_0) - U_h(s_0) = C h^2 + O(h^4)$\n    其中 $C$ 是一个不依赖于网格间距 $h$ 的常数，$O(h^4)$ 代表更高阶的误差项。\n\n2.  **在两个网格上应用模型**：\n    我们有两个网格，一个间距为 $h$，另一个为 $h/2$。我们可以为两者分别写出误差表达式：\n    (1) $T(s_0) - U_h(s_0) = C h^2 + O(h^4)$\n    (2) $T(s_0) - U_{h/2}(s_0) = C (h/2)^2 + O((h/2)^4) = \\frac{1}{4} C h^2 + O(h^4)$\n\n3.  **推导理查森外推公式**：\n    我们的目标是消去主导误差项 $C h^2$ 来得到一个对 $T(s_0)$ 的更好估计。为此，我们将方程 (2) 乘以 4：\n    (3) $4T(s_0) - 4U_{h/2}(s_0) = C h^2 + O(h^4)$\n    现在，我们从方程 (3) 中减去方程 (1)：\n    $(4T(s_0) - 4U_{h/2}(s_0)) - (T(s_0) - U_h(s_0)) = (C h^2 - C h^2) + O(h^4)$\n    $3T(s_0) - 4U_{h/2}(s_0) + U_h(s_0) = O(h^4)$\n    整理上式以求解 $T(s_0)$：\n    $3T(s_0) \\approx 4U_{h/2}(s_0) - U_h(s_0)$\n    $$T_{\\text{extrapolated}}(s_0) = \\frac{4U_{h/2}(s_0) - U_h(s_0)}{3}$$\n    这个公式就是理查森外推估计，它提供了一个四阶精度的解估计值（因为 $O(h^2)$ 项被消除了）。\n\n4.  **代入数值进行计算**：\n    问题给出了以下数值：\n    -   $U_h(s_0) = 3.200$ keV\n    -   $U_{h/2}(s_0) = 3.260$ keV\n    将这些值代入我们推导出的公式：\n    $T_{\\text{extrapolated}}(s_0) = \\frac{4 \\times 3.260 - 3.200}{3}$\n    $T_{\\text{extrapolated}}(s_0) = \\frac{13.040 - 3.200}{3}$\n    $T_{\\text{extrapolated}}(s_0) = \\frac{9.840}{3}$\n    $T_{\\text{extrapolated}}(s_0) = 3.280$ keV\n\n5.  **最终答案**：\n    根据问题要求，将结果四舍五入到四位有效数字，最终答案是 3.280 keV。\n\n    （验证：问题还提供了点误差 $E_h = 0.080$ 和 $E_{h/2} = 0.020$。我们可以用这些信息来验证我们的结果。根据定义，$T(s_0) = U_h(s_0) + E_h = 3.200 + 0.080 = 3.280$ keV。这与我们的外推结果完全一致，证实了计算的正确性。）",
            "answer": "$$\\boxed{3.280}$$"
        }
    ]
}