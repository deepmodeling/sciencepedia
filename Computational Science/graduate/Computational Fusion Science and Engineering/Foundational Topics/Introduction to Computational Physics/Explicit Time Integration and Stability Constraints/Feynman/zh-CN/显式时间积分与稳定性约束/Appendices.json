{
    "hands_on_practices": [
        {
            "introduction": "在数值模拟中，一个基础但至关重要的概念是区分数值稳定性和准确性。时间步长 $\\Delta t$ 的选择可能受其中任一因素的限制，但二者并非等同。此练习以用于模拟磁化等离子体中带电粒子运动的Boris算法为例，探讨了这一区别。通过分析这个在某些条件下无条件稳定但对准确性有要求的经典算法，您将深入理解为何即使一个方法不会“崩溃”，仍需小步长来精确解析物理过程。",
            "id": "3977945",
            "problem": "一个电荷为 $q$、质量为 $m$ 的非相对论带电粒子，在空间均匀磁场 $\\mathbf{B} = B_0 \\,\\hat{\\mathbf{z}}$ 和零电场 $\\mathbf{E} = \\mathbf{0}$ 中运动。在用于磁化聚变等离子体的粒子模拟 (PIC) 计算中，显式 Boris 推送器被广泛用于推进粒子的速度和位置。从洛伦兹力定律和回旋频率 $\\Omega_c = q B_0 / m$ 的定义出发，推断在这种情况下，由 Boris 推送器执行的显式时间积分在稳定性和准确性方面的定性和定量差异。特别要辨析，该方法是否以及为何可以在没有 Courant–Friedrichs–Lewy (CFL) 约束的情况下保持稳定，同时却仍然需要满足 $\\Delta t\\,\\Omega_c \\ll 1$ 才能精确解析回旋运动。\n\n选择所有正确描述 Boris 推送器在这些条件下的稳定性与准确性的陈述：\n\nA. 在 $\\mathbf{E}=\\mathbf{0}$ 的均匀磁场中，Boris 推送器对任意 $\\Delta t$ 都能精确保持动能，这意味着离散速度更新是线性稳定的，无需一个将 $\\Delta t$ 与 $\\Omega_c$ 关联起来的 Courant–Friedrichs–Lewy (CFL) 约束。\n\nB. 在均匀磁场中，Boris 推送器通过在垂直于 $\\mathbf{B}$ 的平面内旋转来推进速度，旋转角度精确等于 $\\theta = \\Omega_c \\Delta t$，因此在任何 $\\Delta t$ 下都没有相位误差。\n\nC. 尽管 Boris 推送器对任意 $\\Delta t$ 都是稳定的，但要以定量的准确性解析回旋运动，则需要满足 $\\Delta t\\,\\Omega_c \\ll 1$，因为每一步的相位误差标度为 $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^3\\right)$，在多次回旋后产生的累积（全局）相位误差标度为 $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^2\\right)$。\n\nD. 为了保证显式稳定性，Boris 推送器需要满足 $\\Delta t\\,\\Omega_c  2$，否则离散映射会变得不稳定，粒子速度会激增。\n\nE. 在聚变相关场中，例如在 $B_0 = 5\\,\\mathrm{T}$ 中的氘核，选择 $\\Delta t = \\dfrac{0.1}{\\Omega_c}$ 在回旋中不产生相位误差，同时保持动能，因此稳定性和精确的准确性都得以实现。",
            "solution": "### 解答\n\n粒子的运动由非相对论洛伦兹力方程控制，在 $\\mathbf{E} = \\mathbf{0}$ 时简化为：\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m} (\\mathbf{v} \\times \\mathbf{B}) = \\Omega_c (\\mathbf{v} \\times \\hat{\\mathbf{z}}) $$\n该方程描述了速度矢量 $\\mathbf{v}$ 以角频率 $\\Omega_c$ 绕 $\\hat{\\mathbf{z}}$ 轴旋转。动能 $K = \\frac{1}{2}mv^2$ 是一个精确的运动守恒量，因为磁力不做功。\n\nBoris 算法是一种时间中心的蛙跳式方案。关键在于它对速度的更新可以表示为一个纯粹的旋转操作，即 $\\mathbf{v}^{n+1/2} = \\mathbf{R} \\mathbf{v}^{n-1/2}$，其中 $\\mathbf{R}$ 是一个旋转矩阵。\n\n**稳定性分析：**\n对于 $\\mathbf{E}=0$ 的情况，Boris 推送完全是对速度矢量的一个旋转。旋转是一种幺正变换，意味着它保持其作用的矢量的长度（范数）。因此：\n$$ |\\mathbf{v}^{n+1/2}| = |\\mathbf{v}^{n-1/2}| $$\n这对于时间步长 $\\Delta t$ 的大小无关，始终成立。由于速度矢量的大小在每一步都精确守恒，动能 $K = \\frac{1}{2}m|\\mathbf{v}|^2$ 也是精确守恒的。一个能精确保持像能量这样的运动守恒量的数值格式不会变得不稳定。这个性质对任何 $\\Delta t > 0$ 都成立，因此在纯磁场中 Boris 方法是无条件稳定的。没有与 $\\Omega_c$ 相关的类似 CFL 的稳定性约束施加在 $\\Delta t$ 上。\n\n**准确性分析：**\n精确解是在一个时间步长 $\\Delta t$ 内将 $\\mathbf{v}_{\\perp}$ 旋转一个角度 $\\theta_{\\text{exact}} = \\Omega_c \\Delta t$。\n可以证明 Boris 算法通过一个数值确定的角度 $\\theta_B$ 来旋转速度矢量，该角度由下式给出：\n$$ \\theta_B = 2 \\arctan\\left(\\frac{\\Omega_c \\Delta t}{2}\\right) $$\n为了使数值解准确，数值旋转角 $\\theta_B$ 必须是精确物理角 $\\theta_{\\text{exact}}$ 的一个良好近似。我们用泰勒级数展开来分析这个差异：\n$$ \\theta_B = 2 \\left( \\frac{\\Omega_c \\Delta t}{2} - \\frac{1}{3}\\left(\\frac{\\Omega_c \\Delta t}{2}\\right)^3 + \\dots \\right) = \\Omega_c \\Delta t - \\frac{(\\Omega_c \\Delta t)^3}{12} + \\mathcal{O}((\\Omega_c \\Delta t)^5) $$\n数值角度和精确角度之间的差异，即每步的局部相位误差，是：\n$$ \\Delta\\theta = \\theta_B - \\theta_{\\text{exact}} \\approx -\\frac{(\\Omega_c \\Delta t)^3}{12} $$\n相位的局部截断误差是 $\\mathcal{O}((\\Omega_c \\Delta t)^3)$ 阶的。为了精确地跟踪相位，这个误差必须很小，这要求 $\\Omega_c \\Delta t \\ll 1$。这是一个准确性要求，而不是稳定性约束。\n在时间 $T = N\\Delta t$ 之后的累积或全局相位误差标度为 $N \\times \\Delta\\theta \\propto \\frac{T}{\\Delta t} \\times (\\Delta t)^3 \\propto (\\Delta t)^2$。因此全局相位误差是 $\\mathcal{O}((\\Omega_c \\Delta t)^2)$。\n\n### 逐项分析\n\n**A. 在 $\\mathbf{E}=\\mathbf{0}$ 的均匀磁场中，Boris 推送器对任意 $\\Delta t$ 都能精确保持动能，这意味着离散速度更新是线性稳定的，无需一个将 $\\Delta t$ 与 $\\Omega_c$ 关联起来的 Courant–Friedrichs–Lewy (CFL) 约束。**\n这是正确的。如上所述，该方法精确守恒能量，因此是无条件稳定的，没有 CFL 类型的稳定性限制。\n**结论：正确**\n\n**B. 在均匀磁场中，Boris 推送器通过在垂直于 $\\mathbf{B}$ 的平面内旋转来推进速度，旋转角度精确等于 $\\theta = \\Omega_c \\Delta t$，因此在任何 $\\Delta t$ 下都没有相位误差。**\n这是错误的。数值旋转角是 $\\theta_B = 2 \\arctan(\\Omega_c \\Delta t / 2)$，这不等于 $\\Omega_c \\Delta t$。不等式 $\\arctan(x)  x$ 确保了对于任何 $x>0$ 总会存在相位误差。\n**结论：错误**\n\n**C. 尽管 Boris 推送器对任意 $\\Delta t$ 都是稳定的，但要以定量的准确性解析回旋运动，则需要满足 $\\Delta t\\,\\Omega_c \\ll 1$，因为每一步的相位误差标度为 $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^3\\right)$，在多次回旋后产生的累积（全局）相位误差标度为 $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^2\\right)$。**\n这是正确的。它准确地区分了无条件稳定性和对准确性的要求，并正确指出了局部和全局相位误差的阶数。\n**结论：正确**\n\n**D. 为了保证显式稳定性，Boris 推送器需要满足 $\\Delta t\\,\\Omega_c  2$，否则离散映射会变得不稳定，粒子速度会激增。**\n这是错误的。这与该方法无条件稳定性的事实相矛盾。这个稳定性条件适用于其他一些显式积分器，但不适用于 Boris 算法。\n**结论：错误**\n\n**E. 在聚变相关场中，例如在 $B_0 = 5\\,\\mathrm{T}$ 中的氘核，选择 $\\Delta t = \\dfrac{0.1}{\\Omega_c}$ 在回旋中不产生相位误差，同时保持动能，因此稳定性和精确的准确性都得以实现。**\n这是错误的。虽然动能被保持，但由于 $\\Omega_c \\Delta t = 0.1 \\ne 0$，所以存在一个有限的相位误差。因此它不是“精确的”准确。\n**结论：错误**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "真实的聚变等离子体模拟通常涉及多种相互作用的物理现象，每种现象都有其自身的时间尺度和稳定性要求。为了确保整个显式模拟的稳定性，必须从所有限制中找出最严格的那个。这项练习模拟了一个多物理场场景，要求您计算并整合由平流、磁流体动力学(MHD)波、各向异性热传导和电阻磁扩散等不同过程施加的时间步长限制，从而确定全局时间步长。",
            "id": "3977943",
            "problem": "在一个由均匀笛卡尔网格离散化的矩形域中，对具有各向异性热传导的电阻磁流体力学 (MHD) 进行三维显式模拟，网格间距为 $\\,\\Delta x = 1.0 \\times 10^{-3}\\,$ m、$\\,\\Delta y = 5.0 \\times 10^{-3}\\,$ m 和 $\\,\\Delta z = 1.0 \\times 10^{-2}\\,$ m。等离子体的质量密度为 $\\,\\rho = 3.343 \\times 10^{-7}\\,$ kg/m$^{3}$，标量热压为 $\\,p = 1.602 \\times 10^{5}\\,$ Pa，比热比为 $\\,\\gamma = 5/3\\,$，以及一个大小为 $\\,B = 5\\,$ T、沿着 $\\,y\\,$ 轴方向的均匀磁场。流速在空间上是均匀的，其分量为 $\\,u_{x} = 5.0 \\times 10^{3}\\,$ m/s、$\\,u_{y} = 2.0 \\times 10^{4}\\,$ m/s 和 $\\,u_{z} = 1.0 \\times 10^{4}\\,$ m/s。电阻磁扩散率为 $\\,\\eta_{m} = 5.0\\,$ m$^{2}$/s。各向异性热输运由一个扩散张量建模，其平行和垂直热扩散率分别为 $\\,\\chi_{\\parallel} = 1.0 \\times 10^{8}\\,$ m$^{2}$/s 和 $\\,\\chi_{\\perp} = 1.0\\,$ m$^{2}$/s，其中平行方向与磁场对齐。\n\n该代码使用非分裂有限体积法和一阶前向欧拉时间积分来推进所有场。对流和 MHD 波通量使用迎风 Godunov 通量计算，当方向库朗数之和不超过 Courant–Friedrichs–Lewy (CFL) 常数 $\\,C_{\\mathrm{hyp}} = 0.5\\,$ 时，该方法是稳定的。扩散项（热传导和电阻扩散）通过二阶中心差分进行离散化并显式推进，受抛物线型稳定性常数 $\\,C_{\\mathrm{diff}} = 0.5\\,$ 的约束。假设最大 MHD 信号速度为快磁声速 $\\,c_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}}\\,$，其中 $\\,c_{s} = \\sqrt{\\gamma p / \\rho}\\,$ 是声速，$\\,v_{A} = B/\\sqrt{\\mu_{0}\\rho}\\,$ 是阿尔芬速度，磁导率为 $\\,\\mu_{0} = 4\\pi \\times 10^{-7}\\,$ H/m。将快磁声速视为各向同性。\n\n通过汇总以下各项的独立稳定性约束，计算最终的显式时间步长：\n1) 流速的纯对流，\n2) 以快磁声速传播的双曲型 MHD 波，\n3) 与磁场对齐的各向异性热传导，以及\n4) 电阻磁扩散。\n\n使用给定的稳定性常数，取全局时间步长为所有单个边界中的最小值。在您的推导中，用文字指出主要的限制机制，但仅报告最终时间步长的数值作为您的答案。将您的数值答案四舍五入到三位有效数字。以秒为单位表示最终时间步长。",
            "solution": "目标是确定显式时间积分方案的最大允许时间步长 $\\Delta t$，该步长受多种物理现象的制约。总时间步长是每个独立过程所施加的时间步长中的最小值：\n$$ \\Delta t = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{MHD}}, \\Delta t_{\\text{th}}, \\Delta t_{\\text{res}}) $$\n我们将计算这四个稳定性限制中的每一个。\n\n首先，我们使用给定的参数计算等离子体的特征波速：\n- 质量密度: $\\rho = 3.343 \\times 10^{-7}\\,$ kg/m$^3$\n- 热压: $p = 1.602 \\times 10^{5}\\,$ Pa\n- 比热比: $\\gamma = 5/3$\n- 磁场大小: $B = 5\\,$ T\n- 真空磁导率: $\\mu_0 = 4\\pi \\times 10^{-7}\\,$ H/m\n\n声速 $c_s$ 由下式给出：\n$$ c_s = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(5/3) \\times (1.602 \\times 10^5 \\text{ Pa})}{3.343 \\times 10^{-7} \\text{ kg/m}^3}} \\approx 8.937 \\times 10^5 \\text{ m/s} $$\n\n阿尔芬速度 $v_A$ 由下式给出：\n$$ v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} = \\frac{5 \\text{ T}}{\\sqrt{(4\\pi \\times 10^{-7} \\text{ H/m}) \\times (3.343 \\times 10^{-7} \\text{ kg/m}^3)}} \\approx 7.714 \\times 10^6 \\text{ m/s} $$\n\n快磁声速 $c_f$ 是声速和阿尔芬速度的平方和的平方根：\n$$ c_f = \\sqrt{c_s^2 + v_A^2} = \\sqrt{(8.937 \\times 10^5 \\text{ m/s})^2 + (7.714 \\times 10^6 \\text{ m/s})^2} \\approx 7.766 \\times 10^6 \\text{ m/s} $$\n\n在一个非分裂的三维显式方案中，双曲型（对流、波）和抛物线型（扩散）现象的稳定性约束由以下公式给出：\n- 双曲型 CFL 条件: $\\Delta t_{\\text{hyp}} \\le \\frac{C_{\\mathrm{hyp}}}{\\sum_{i=x,y,z} \\frac{v_i}{\\Delta i}}$，其中 $v_i$ 是在 $i$ 方向上的最大信号速度。\n- 抛物线型条件: $\\Delta t_{\\text{diff}} \\le \\frac{C_{\\mathrm{diff}}}{\\sum_{i=x,y,z} \\frac{D_i}{(\\Delta i)^2}}$，其中 $D_i$ 是在 $i$ 方向上的扩散率。\n\n给定的网格间距为 $\\Delta x = 1.0 \\times 10^{-3}\\,$ m, $\\Delta y = 5.0 \\times 10^{-3}\\,$ m, 和 $\\Delta z = 1.0 \\times 10^{-2}\\,$ m。稳定性常数为 $C_{\\mathrm{hyp}} = 0.5$ 和 $C_{\\mathrm{diff}} = 0.5$。\n\n1.  **纯对流约束 ($\\Delta t_{\\text{adv}}$)**\n    此约束由流体速度 $\\vec{u} = (u_x, u_y, u_z)$ 决定，其中 $u_x = 5.0 \\times 10^3\\,$ m/s, $u_y = 2.0 \\times 10^4\\,$ m/s, 和 $u_z = 1.0 \\times 10^4\\,$ m/s。\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + \\frac{|u_z|}{\\Delta z}} $$\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{0.5}{\\frac{5.0 \\times 10^3}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4}{1.0 \\times 10^{-2}}} = \\frac{0.5}{5.0 \\times 10^6 + 4.0 \\times 10^6 + 1.0 \\times 10^6} = \\frac{0.5}{1.0 \\times 10^7} $$\n    $$ \\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8} \\text{ s} $$\n\n2.  **双曲型 MHD 波约束 ($\\Delta t_{\\text{MHD}}$)**\n    在 $i$ 方向上的最大信号速度是 $|u_i| + c_f$。\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x| + c_f}{\\Delta x} + \\frac{|u_y| + c_f}{\\Delta y} + \\frac{|u_z| + c_f}{\\Delta z}} $$\n    分母中时间尺度倒数之和为：\n    $$ \\sum \\frac{v_i}{\\Delta i} = \\frac{5.0 \\times 10^3 + 7.766 \\times 10^6}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4 + 7.766 \\times 10^6}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4 + 7.766 \\times 10^6}{1.0 \\times 10^{-2}} $$\n    $$ \\sum \\frac{v_i}{\\Delta i} \\approx (7.771 \\times 10^9) + (1.557 \\times 10^9) + (0.778 \\times 10^9) = 1.0106 \\times 10^{10} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{0.5}{1.0106 \\times 10^{10}} \\approx 4.948 \\times 10^{-11} \\text{ s} $$\n\n3.  **各向异性热传导约束 ($\\Delta t_{\\text{th}}$)**\n    这是一个抛物线型约束。磁场与 $y$ 轴对齐，因此热扩散是高度各向异性的。沿网格轴的扩散系数为 $\\chi_x = \\chi_{\\perp} = 1.0\\,$ m$^2$/s，$\\chi_y = \\chi_{\\parallel} = 1.0 \\times 10^8\\,$ m$^2$/s，和 $\\chi_z = \\chi_{\\perp} = 1.0\\,$ m$^2$/s。\n    $$ \\Delta t_{\\text{th}} \\le \\frac{C_{\\mathrm{diff}}}{\\frac{\\chi_x}{(\\Delta x)^2} + \\frac{\\chi_y}{(\\Delta y)^2} + \\frac{\\chi_z}{(\\Delta z)^2}} $$\n    网格间距的平方为 $(\\Delta x)^2 = 1.0 \\times 10^{-6}\\,$ m$^2$, $(\\Delta y)^2 = 2.5 \\times 10^{-5}\\,$ m$^2$, 和 $(\\Delta z)^2 = 1.0 \\times 10^{-4}\\,$ m$^2$。\n    分母中时间尺度倒数之和为：\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} = \\frac{1.0}{1.0 \\times 10^{-6}} + \\frac{1.0 \\times 10^8}{2.5 \\times 10^{-5}} + \\frac{1.0}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^{12} + 1.0 \\times 10^4 $$\n    平行传导项 $\\frac{\\chi_{\\parallel}}{(\\Delta y)^2}$ 占主导地位。\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} \\approx 4.0 \\times 10^{12} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{th}} \\le \\frac{0.5}{4.0 \\times 10^{12}} = 1.25 \\times 10^{-13} \\text{ s} $$\n\n4.  **电阻磁扩散约束 ($\\Delta t_{\\text{res}}$)**\n    这是一个各向同性的抛物线型过程，扩散率为 $\\eta_m = 5.0\\,$ m$^2$/s。\n    $$ \\Delta t_{\\text{res}} \\le \\frac{C_{\\mathrm{diff}}}{\\eta_m \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} + \\frac{1}{(\\Delta z)^2} \\right)} $$\n    几何因子之和为：\n    $$ \\sum \\frac{1}{(\\Delta i)^2} = \\frac{1}{1.0 \\times 10^{-6}} + \\frac{1}{2.5 \\times 10^{-5}} + \\frac{1}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^4 + 1.0 \\times 10^4 = 1.05 \\times 10^6 \\text{ m}^{-2} $$\n    $$ \\Delta t_{\\text{res}} \\le \\frac{0.5}{5.0 \\times (1.05 \\times 10^6)} = \\frac{0.5}{5.25 \\times 10^6} \\approx 9.524 \\times 10^{-8} \\text{ s} $$\n\n比较四个时间步长限制：\n- $\\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8}\\,$ s\n- $\\Delta t_{\\text{MHD}} \\le 4.948 \\times 10^{-11}\\,$ s\n- $\\Delta t_{\\text{th}} \\le 1.25 \\times 10^{-13}\\,$ s\n- $\\Delta t_{\\text{res}} \\le 9.524 \\times 10^{-8}\\,$ s\n\n最小值决定了显式模拟的全局时间步长。\n$$ \\Delta t = \\min(5.0 \\times 10^{-8}, 4.948 \\times 10^{-11}, 1.25 \\times 10^{-13}, 9.524 \\times 10^{-8}) = 1.25 \\times 10^{-13} \\text{ s} $$\n主要的限制机制是对各向异性热传导的显式处理。平行于磁场方向的极高扩散率与该方向的空间分辨率相结合，施加了非常严格的时间步长限制。最终答案，四舍五入到三位有效数字，是 $1.25 \\times 10^{-13}$ 秒。",
            "answer": "$$ \\boxed{1.25 \\times 10^{-13}} $$"
        },
        {
            "introduction": "在掌握了如何确定静态稳定性极限后，下一步是学习如何动态地管理时间步长以提高计算效率和准确性。自适应时间步进是一种先进技术，它根据局部截断误差的估计来调整步长，同时必须遵守由物理波速设定的严格CFL稳定性上限。本练习将指导您推导一个标准的步长控制器，并将其与一个硬性的稳定性上限相结合，这反映了现代数值求解器中平衡计算效率与数值鲁棒性的核心挑战。",
            "id": "3977905",
            "problem": "在计算磁流体力学（MHD）中一个半离散双曲系统的显式时间积分中，考虑使用一个阶数为 $p$ 和 $p-1$ 的嵌入式龙格-库塔（RK）对来推进求解。该嵌入式对使用相同的阶段导数，在时间 $t_{n}+\\Delta t_{n}$ 产生两个近似解：一个高阶解 $y_{n+1}^{[p]}$ 和一个嵌入的低阶解 $y_{n+1}^{[p-1]}$，它们的差值用于估计局部截断误差。假设显式RK方法具有标准的渐近局部误差展开，并且误差估计器被归一化为一个无量纲标量 $\\text{err}_{n}$，该标量渐近正比于 $\\Delta t_{n}^{p+1}$。\n\n任务1：简要描述嵌入式RK对如何从单次阶段计算中构造局部误差估计。然后，从局部截断误差与时间步长的渐近关系出发，推导一个步长控制器，该控制器根据 $\\Delta t_{n}$、用户容差 $\\text{tol}$、测得的标量误差 $\\text{err}_{n}$ 和方法阶数 $p$ 来更新 $\\Delta t_{n+1}$。控制器应包含一个安全因子 $s\\in(0,1)$。\n\n任务2：在一维（$1\\text{D}$）MHD中，设流速为 $u$，声速为 $c_{s}$，阿尔芬速度为 $v_{A}$。在场对齐的情况下，快磁声速为 $c_{f}=\\sqrt{c_{s}^{2}+v_{A}^{2}}$，相对于网格的最大特征速度的一个保守上界是 $a_{\\max}=|u|+c_{f}$。对于间距为 $\\Delta x$ 的均匀网格，采用显式RK时间积分器的显式有限体积法必须满足形式为 $\\Delta t\\le \\nu_{\\max}\\,\\Delta x/a_{\\max}$ 的库朗-弗里德里希斯-列维（CFL）条件以保证稳定性，其中 $\\nu_{\\max}\\in(0,1)$ 是一个与所选时空离散化的线性稳定域一致的预设库朗数界限。\n\n将任务1中的控制器与CFL稳定性极限施加的硬性上限相结合，得出一个用于更新 $\\Delta t_{n+1}$ 的单一公式，该公式选择基于误差的提议步长和CFL上限中的较小者。然后，根据以下参数数值计算 $\\Delta t_{n+1}$：\n- 接受解的嵌入式对阶数：$p=5$。\n- 安全因子：$s=0.9$。\n- 当前步长：$\\Delta t_{n}=1.2\\times 10^{-8}\\ \\text{s}$。\n- 用户容差：$\\text{tol}=1.0\\times 10^{-5}$。\n- 测得的标量误差：$\\text{err}_{n}=2.5\\times 10^{-4}$。\n- 网格间距：$\\Delta x=5.2\\times 10^{-3}\\ \\text{m}$。\n- 流速大小：$|u|=1.0\\times 10^{5}\\ \\text{m}\\,\\text{s}^{-1}$。\n- 声速：$c_{s}=1.5\\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}$。\n- 阿尔芬速度：$v_{A}=2.0\\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}$。\n- 库朗数界限：$\\nu_{\\max}=0.8$。\n\n将你的最终答案表示为 $\\Delta t_{n+1}$ 的单一数值（单位为秒），并四舍五入到三位有效数字。",
            "solution": "该问题分为两个任务。第一个任务是描述嵌入式龙格-库塔（RK）对的误差估计机制并推导自适应步长控制器。第二个任务是将此控制器与库朗-弗里德里希斯-列维（CFL）稳定性约束相结合，并进行数值计算。\n\n**任务1：误差估计和步长控制器推导**\n\n嵌入式龙格-库塔对由两个阶数分别为 $p$ 和 $p-1$ 的显式RK方法组成。它们利用同一组阶段导数在时间 $t_{n+1}$ 处产生两个不同的近似解：高阶解 $y_{n+1}^{[p]}$ 和低阶嵌入解 $y_{n+1}^{[p-1]}$。这两个解之差 $E_{n+1} = y_{n+1}^{[p]} - y_{n+1}^{[p-1]}$，可作为局部截断误差（LTE）的估计。\n\n在第 $n$ 步的估计误差 $\\text{err}_n$ 与步长 $\\Delta t_n$ 之间的渐近关系如下：\n$$\n\\text{err}_{n} \\approx C \\Delta t_{n}^{p+1}\n$$\n其中 $C$ 是一个常数，假定在连续的时间步长上近似恒定。\n\n自适应步长控制器的目标是选择下一个时间步长 $\\Delta t_{n+1}$，使得该步的预测误差 $\\text{err}_{n+1}$ 满足预设的用户容差 $\\text{tol}$。因此，我们设定目标：\n$$\n\\text{tol} \\approx C \\Delta t_{n+1}^{p+1}\n$$\n\n通过取前面两个表达式的比值来消去未知常数 $C$：\n$$\n\\frac{\\text{tol}}{\\text{err}_{n}} \\approx \\frac{C \\Delta t_{n+1}^{p+1}}{C \\Delta t_{n}^{p+1}} = \\left(\\frac{\\Delta t_{n+1}}{\\Delta t_{n}}\\right)^{p+1}\n$$\n求解 $\\Delta t_{n+1}$ 并引入一个安全因子 $s \\in (0,1)$，得到由误差控制器提议的步长公式，记为 $\\Delta t_{\\text{err}}$：\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}}\n$$\n\n**任务2：组合控制器和数值计算**\n\n对于显式时间积分，时间步长必须满足CFL条件以确保数值稳定性。该条件给步长施加了一个硬性上限 $\\Delta t_{\\text{CFL}} = \\nu_{\\max}\\,\\Delta x/a_{\\max}$。\n\n最终的时间步长 $\\Delta t_{n+1}$ 必须同时满足精度和稳定性要求。因此，新的步长选择为误差控制器提议的值与CFL稳定性极限之间的较小者：\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text{err}}, \\Delta t_{\\text{CFL}})\n$$\n\n现在我们使用提供的数值参数来计算该表达式。\n首先，我们计算CFL时间步长限制 $\\Delta t_{\\text{CFL}}$。这需要最大特征速度 $a_{\\max}$。\n快磁声速 $c_f$ 为：\n$$\nc_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}} = \\sqrt{(1.5 \\times 10^{6})^{2} + (2.0 \\times 10^{6})^{2}} = \\sqrt{6.25 \\times 10^{12}} = 2.5 \\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}\n$$\n相对于网格的最大特征速度为：\n$$\na_{\\max} = |u| + c_{f} = 1.0 \\times 10^{5} + 2.5 \\times 10^{6} = 2.6 \\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}\n$$\n现在，我们可以计算CFL步长限制：\n$$\n\\Delta t_{\\text{CFL}} = \\nu_{\\max} \\frac{\\Delta x}{a_{\\max}} = 0.8 \\times \\frac{5.2 \\times 10^{-3}}{2.6 \\times 10^{6}} = 0.8 \\times (2.0 \\times 10^{-9}) = 1.6 \\times 10^{-9}\\ \\text{s}\n$$\n接下来，我们计算误差控制器提议的步长 $\\Delta t_{\\text{err}}$。参数为 $p=5$, $s=0.9$, $\\Delta t_n = 1.2 \\times 10^{-8}$, $\\text{tol}=1.0 \\times 10^{-5}$ 和 $\\text{err}_n = 2.5 \\times 10^{-4}$。控制器中的指数为 $\\frac{1}{p+1} = \\frac{1}{6}$。\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}} = 0.9 \\cdot (1.2 \\times 10^{-8}) \\left(\\frac{1.0 \\times 10^{-5}}{2.5 \\times 10^{-4}}\\right)^{\\frac{1}{6}}\n$$\n$$\n\\Delta t_{\\text{err}} = 1.08 \\times 10^{-8} \\left(0.04\\right)^{\\frac{1}{6}} \\approx 1.08 \\times 10^{-8} \\times 0.5735 \\approx 6.19 \\times 10^{-9}\\ \\text{s}\n$$\n最后，我们通过取两个计算值的最小值来选择新的步长 $\\Delta t_{n+1}$：\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text{err}}, \\Delta t_{\\text{CFL}}) = \\min(6.19 \\times 10^{-9}\\ \\text{s}, 1.6 \\times 10^{-9}\\ \\text{s}) = 1.6 \\times 10^{-9}\\ \\text{s}\n$$\n在这种情况下，时间步长受到CFL稳定性条件的限制，而不是精度要求。问题要求最终答案四舍五入到三位有效数字。\n$$\n\\Delta t_{n+1} = 1.60 \\times 10^{-9}\\ \\text{s}\n$$",
            "answer": "$$\n\\boxed{1.60 \\times 10^{-9}}\n$$"
        }
    ]
}