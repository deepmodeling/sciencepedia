{
    "hands_on_practices": [
        {
            "introduction": "In realistic magnetohydrodynamics (MHD) simulations, the evolution of the plasma is governed by a combination of distinct physical processes, such as bulk advection, fast-propagating waves, and diffusion of heat and magnetic fields. When using an explicit time integration scheme, each of these processes imposes its own stability constraint on the time step $\\Delta t$. This exercise provides hands-on practice in the fundamental task of calculating the individual time step limits for both hyperbolic (waves and advection) and parabolic (diffusion) phenomena and then combining them to find the single global time step that ensures the entire simulation remains stable .",
            "id": "3977943",
            "problem": "A three-dimensional explicit simulation of resistive magnetohydrodynamics (MHD) with anisotropic thermal conduction is performed in a rectangular domain discretized by a uniform Cartesian grid with spacings $\\,\\Delta x = 1.0 \\times 10^{-3}\\,$ m, $\\,\\Delta y = 5.0 \\times 10^{-3}\\,$ m, and $\\,\\Delta z = 1.0 \\times 10^{-2}\\,$ m. The plasma has mass density $\\,\\rho = 3.343 \\times 10^{-7}\\,$ kg/m$^{3}$, scalar thermal pressure $\\,p = 1.602 \\times 10^{5}\\,$ Pa, ratio of specific heats $\\,\\gamma = 5/3\\,$, and a uniform magnetic field of magnitude $\\,B = 5\\,$ T directed along the $\\,y\\,$-axis. The flow velocity is spatially uniform with components $\\,u_{x} = 5.0 \\times 10^{3}\\,$ m/s, $\\,u_{y} = 2.0 \\times 10^{4}\\,$ m/s, and $\\,u_{z} = 1.0 \\times 10^{4}\\,$ m/s. The resistive magnetic diffusivity is $\\,\\eta_{m} = 5.0\\,$ m$^{2}$/s. Anisotropic thermal transport is modeled by a diffusion tensor with parallel and perpendicular thermal diffusivities $\\,\\chi_{\\parallel} = 1.0 \\times 10^{8}\\,$ m$^{2}$/s and $\\,\\chi_{\\perp} = 1.0\\,$ m$^{2}$/s, respectively, with the parallel direction aligned with the magnetic field.\n\nThe code advances all fields using an unsplit finite-volume method with first-order Forward Euler time integration. Advective and MHD wave fluxes are computed with an upwind Godunov flux that is stable when the sum of directional Courant numbers does not exceed a Courant–Friedrichs–Lewy (CFL) constant $\\,C_{\\mathrm{hyp}} = 0.5\\,$. Diffusive terms (thermal conduction and resistive diffusion) are discretized by second-order central differences and advanced explicitly, subject to a parabolic stability constant $\\,C_{\\mathrm{diff}} = 0.5\\,$. Assume the maximum MHD signal speed is the fast magnetosonic speed $\\,c_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}}\\,$, where $\\,c_{s} = \\sqrt{\\gamma p / \\rho}\\,$ is the sound speed and $\\,v_{A} = B/\\sqrt{\\mu_{0}\\rho}\\,$ is the Alfvén speed, with magnetic permeability $\\,\\mu_{0} = 4\\pi \\times 10^{-7}\\,$ H/m. Treat the fast magnetosonic speed as isotropic.\n\nCompute the final explicit time step obtained by aggregating the individual stability constraints from:\n1) pure advection of the flow velocity,\n2) hyperbolic MHD waves at the fast magnetosonic speed,\n3) anisotropic thermal conduction aligned with the magnetic field, and\n4) resistive magnetic diffusion.\n\nTake the global time step as the minimum of all individual bounds using the given stability constants. Identify, in words, the dominant limiting mechanism in your derivation, but report only the numerical value of the final time step as your answer. Round your numerical answer to three significant figures. Express the final time step in seconds.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. All necessary parameters and definitions for computing the explicit time step constraints in a resistive magnetohydrodynamics (MHD) simulation are provided. The physical model and numerical-method constraints are standard in computational plasma physics. Therefore, the problem is valid and a solution will be provided.\n\nThe goal is to determine the maximum allowable time step, $\\Delta t$, for an explicit time integration scheme, which is constrained by several physical phenomena. The overall time step is the minimum of the time steps imposed by each individual process:\n$$ \\Delta t = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{MHD}}, \\Delta t_{\\text{th}}, \\Delta t_{\\text{res}}) $$\nWe will calculate each of these four stability limits.\n\nFirst, we compute the characteristic wave speeds of the plasma using the provided parameters:\n- Mass density: $\\rho = 3.343 \\times 10^{-7}\\,$ kg/m$^3$\n- Thermal pressure: $p = 1.602 \\times 10^{5}\\,$ Pa\n- Ratio of specific heats: $\\gamma = 5/3$\n- Magnetic field magnitude: $B = 5\\,$ T\n- Magnetic permeability of free space: $\\mu_0 = 4\\pi \\times 10^{-7}\\,$ H/m\n\nThe sound speed, $c_s$, is given by:\n$$ c_s = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(5/3) \\times (1.602 \\times 10^5 \\text{ Pa})}{3.343 \\times 10^{-7} \\text{ kg/m}^3}} \\approx 8.937 \\times 10^5 \\text{ m/s} $$\n\nThe Alfvén speed, $v_A$, is given by:\n$$ v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} = \\frac{5 \\text{ T}}{\\sqrt{(4\\pi \\times 10^{-7} \\text{ H/m}) \\times (3.343 \\times 10^{-7} \\text{ kg/m}^3)}} \\approx 7.714 \\times 10^6 \\text{ m/s} $$\n\nThe fast magnetosonic speed, $c_f$, is the quadrature sum of the sound and Alfvén speeds:\n$$ c_f = \\sqrt{c_s^2 + v_A^2} = \\sqrt{(8.937 \\times 10^5 \\text{ m/s})^2 + (7.714 \\times 10^6 \\text{ m/s})^2} \\approx 7.766 \\times 10^6 \\text{ m/s} $$\n\nThe stability constraints for hyperbolic (advection, waves) and parabolic (diffusion) phenomena in an unsplit, three-dimensional explicit scheme are given by:\n- Hyperbolic CFL condition: $\\Delta t_{\\text{hyp}} \\le \\frac{C_{\\mathrm{hyp}}}{\\sum_{i=x,y,z} \\frac{v_i}{\\Delta i}}$, where $v_i$ is the maximum signal speed in direction $i$.\n- Parabolic condition: $\\Delta t_{\\text{diff}} \\le \\frac{C_{\\mathrm{diff}}}{\\sum_{i=x,y,z} \\frac{D_i}{(\\Delta i)^2}}$, where $D_i$ is the diffusivity in direction $i$.\n\nThe given grid spacings are $\\Delta x = 1.0 \\times 10^{-3}\\,$ m, $\\Delta y = 5.0 \\times 10^{-3}\\,$ m, and $\\Delta z = 1.0 \\times 10^{-2}\\,$ m. The stability constants are $C_{\\mathrm{hyp}} = 0.5$ and $C_{\\mathrm{diff}} = 0.5$.\n\n1.  **Pure Advection Constraint ($\\Delta t_{\\text{adv}}$)**\n    This constraint is determined by the fluid velocity $\\vec{u} = (u_x, u_y, u_z)$, where $u_x = 5.0 \\times 10^3\\,$ m/s, $u_y = 2.0 \\times 10^4\\,$ m/s, and $u_z = 1.0 \\times 10^4\\,$ m/s.\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + \\frac{|u_z|}{\\Delta z}} $$\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{0.5}{\\frac{5.0 \\times 10^3}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4}{1.0 \\times 10^{-2}}} = \\frac{0.5}{5.0 \\times 10^6 + 4.0 \\times 10^6 + 1.0 \\times 10^6} = \\frac{0.5}{1.0 \\times 10^7} $$\n    $$ \\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8} \\text{ s} $$\n\n2.  **Hyperbolic MHD Wave Constraint ($\\Delta t_{\\text{MHD}}$)**\n    The maximum signal speed in direction $i$ is $|u_i| + c_f$.\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x| + c_f}{\\Delta x} + \\frac{|u_y| + c_f}{\\Delta y} + \\frac{|u_z| + c_f}{\\Delta z}} $$\n    The sum of inverse time scales in the denominator is:\n    $$ \\sum \\frac{v_i}{\\Delta i} = \\frac{5.0 \\times 10^3 + 7.766 \\times 10^6}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4 + 7.766 \\times 10^6}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4 + 7.766 \\times 10^6}{1.0 \\times 10^{-2}} $$\n    $$ \\sum \\frac{v_i}{\\Delta i} \\approx (7.771 \\times 10^9) + (1.557 \\times 10^9) + (0.778 \\times 10^9) = 1.0106 \\times 10^{10} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{0.5}{1.0106 \\times 10^{10}} \\approx 4.948 \\times 10^{-11} \\text{ s} $$\n\n3.  **Anisotropic Thermal Conduction Constraint ($\\Delta t_{\\text{th}}$)**\n    This is a parabolic constraint. The magnetic field is aligned with the $y$-axis, so thermal diffusion is highly anisotropic. The diffusion coefficients along the grid axes are $\\chi_x = \\chi_{\\perp} = 1.0\\,$ m$^2$/s, $\\chi_y = \\chi_{\\parallel} = 1.0 \\times 10^8\\,$ m$^2$/s, and $\\chi_z = \\chi_{\\perp} = 1.0\\,$ m$^2$/s.\n    $$ \\Delta t_{\\text{th}} \\le \\frac{C_{\\mathrm{diff}}}{\\frac{\\chi_x}{(\\Delta x)^2} + \\frac{\\chi_y}{(\\Delta y)^2} + \\frac{\\chi_z}{(\\Delta z)^2}} $$\n    The grid spacings squared are $(\\Delta x)^2 = 1.0 \\times 10^{-6}\\,$ m$^2$, $(\\Delta y)^2 = 2.5 \\times 10^{-5}\\,$ m$^2$, and $(\\Delta z)^2 = 1.0 \\times 10^{-4}\\,$ m$^2$.\n    The sum of inverse time scales in the denominator is:\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} = \\frac{1.0}{1.0 \\times 10^{-6}} + \\frac{1.0 \\times 10^8}{2.5 \\times 10^{-5}} + \\frac{1.0}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^{12} + 1.0 \\times 10^4 $$\n    The term for parallel conduction, $\\frac{\\chi_{\\parallel}}{(\\Delta y)^2}$, is dominant.\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} \\approx 4.0 \\times 10^{12} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{th}} \\le \\frac{0.5}{4.0 \\times 10^{12}} = 1.25 \\times 10^{-13} \\text{ s} $$\n\n4.  **Resistive Magnetic Diffusion Constraint ($\\Delta t_{\\text{res}}$)**\n    This is an isotropic parabolic process with diffusivity $\\eta_m = 5.0\\,$ m$^2$/s.\n    $$ \\Delta t_{\\text{res}} \\le \\frac{C_{\\mathrm{diff}}}{\\eta_m \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} + \\frac{1}{(\\Delta z)^2} \\right)} $$\n    The sum of the geometric factors is:\n    $$ \\sum \\frac{1}{(\\Delta i)^2} = \\frac{1}{1.0 \\times 10^{-6}} + \\frac{1}{2.5 \\times 10^{-5}} + \\frac{1}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^4 + 1.0 \\times 10^4 = 1.05 \\times 10^6 \\text{ m}^{-2} $$\n    $$ \\Delta t_{\\text{res}} \\le \\frac{0.5}{5.0 \\times (1.05 \\times 10^6)} = \\frac{0.5}{5.25 \\times 10^6} \\approx 9.524 \\times 10^{-8} \\text{ s} $$\n\nComparing the four time step limits:\n- $\\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8}\\,$ s\n- $\\Delta t_{\\text{MHD}} \\le 4.948 \\times 10^{-11}\\,$ s\n- $\\Delta t_{\\text{th}} \\le 1.25 \\times 10^{-13}\\,$ s\n- $\\Delta t_{\\text{res}} \\le 9.524 \\times 10^{-8}\\,$ s\n\nThe minimum value determines the global time step for the explicit simulation.\n$$ \\Delta t = \\min(5.0 \\times 10^{-8}, 4.948 \\times 10^{-11}, 1.25 \\times 10^{-13}, 9.524 \\times 10^{-8}) = 1.25 \\times 10^{-13} \\text{ s} $$\nThe dominant limiting mechanism is the explicit treatment of anisotropic thermal conduction. The extremely high diffusivity parallel to the magnetic field combined with the spatial resolution in that direction imposes a very severe time step restriction. The final answer, rounded to three significant figures, is $1.25 \\times 10^{-13}$ seconds.",
            "answer": "$$ \\boxed{1.25 \\times 10^{-13}} $$"
        },
        {
            "introduction": "The Courant-Friedrichs-Lewy (CFL) condition is a cornerstone of stability for explicit hyperbolic solvers, but its application requires care, especially at domain boundaries. A naive implementation that works for the interior of the grid may lead to instability at the edges. This practice explores the effect of a reflective boundary condition, a common scenario in fluid and plasma simulations, on the local time step constraint . By analyzing wave reflection, you will understand why the effective signal speed influencing a boundary cell is higher than in the interior, and how to formulate a robust stability criterion that accounts for this crucial effect.",
            "id": "3977873",
            "problem": "A one-dimensional hyperbolic conservation law representative of fast magnetosonic transport in magnetohydrodynamics (MHD) is discretized on a uniform mesh of length $L$ with $N$ cells using a finite-volume method and integrated in time by an explicit scheme. The numerical flux at each face is computed by the local Lax–Friedrichs (Rusanov) flux, which introduces a face-local dissipation parameter equal to the maximum absolute characteristic speed normal to the face. For a face with left and right states having normal velocity $u$ and fast magnetosonic speed $c_{f}$, the characteristic speeds are $S_{L} = -( |u| + c_{f} )$ and $S_{R} = +( |u| + c_{f} )$, and the face-local dissipation parameter is $\\alpha = |u| + c_{f}$. Reflective boundary conditions (RBC) are imposed at $x=0$, which enforce no-penetration at the wall by mirroring the ghost-cell normal velocity as $u_{\\text{ghost}} = - u_{\\text{adjacent}}$ and appropriate symmetry for other variables.\n\nStarting from the semi-discrete finite-volume update for cell-averaged states $U_{i}$,\n$$\n\\frac{d U_{i}}{dt} = - \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x},\n$$\nand the property that explicit time stepping must satisfy a Courant–Friedrichs–Lewy (CFL) stability constraint based on the total wave-carrying capacity across the cell faces, derive a conservative local time-step bound that correctly accounts for the effect of RBC on the cell adjacent to the wall. In particular, explain physically why the effective wave speed entering the stability constraint doubles in the boundary-adjacent cell and show how this changes the local bound from the naive single-face estimate to a sum-over-faces estimate.\n\nThen, for a domain of length $L = 1 \\ \\text{m}$ with $N = 128$ uniform cells (so that $\\Delta x = L/N$), with maximum normal velocity magnitude $|u| = 1.0 \\times 10^{5} \\ \\text{m}\\,\\text{s}^{-1}$ and fast magnetosonic speed $c_{f} = 2.0 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1}$ everywhere, and with a chosen CFL number $\\text{CFL} = 0.8$, compute a conservative global time step $\\Delta t$ that ensures stability everywhere, explicitly accounting for the doubling of effective wave speed in the boundary-adjacent cell due to RBC. Assume the global time step is the minimum of the local bounds over all cells and that interior cells use the same $\\alpha$ but do not experience reflective doubling.\n\nWhich of the following is the correct conservative global $\\Delta t$?\n\nA. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{|u| + c_{f}} = 2.98 \\times 10^{-9} \\ \\text{s}$\n\nB. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{2 ( |u| + c_{f} )} = 1.49 \\times 10^{-9} \\ \\text{s}$\n\nC. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{|u| + 2 c_{f}} = 1.44 \\times 10^{-9} \\ \\text{s}$\n\nD. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{2 |u| + 2 c_{f}} = 1.36 \\times 10^{-9} \\ \\text{s}$\n\nProvide your reasoning based on first principles of hyperbolic transport, finite-volume updates, and explicit CFL stability, including the physical interpretation of reflective boundaries as generating counter-propagating characteristics that increase the effective wave-carrying capacity across the boundary-adjacent cell.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\n-   **System**: A one-dimensional hyperbolic conservation law, representative of fast magnetosonic transport in magnetohydrodynamics (MHD).\n-   **Discretization Method**: Finite-volume method.\n-   **Mesh**: Uniform mesh of length $L$ with $N$ cells.\n-   **Cell width**: $\\Delta x = L/N$.\n-   **Time Integration**: Explicit scheme.\n-   **Numerical Flux**: Local Lax–Friedrichs (Rusanov) flux, $F_{i+1/2}$.\n-   **Dissipation Parameter**: $\\alpha = |u| + c_{f}$, where $u$ is the normal velocity and $c_{f}$ is the fast magnetosonic speed. This is the maximum absolute characteristic speed.\n-   **Characteristic Speeds**: $S_{L} = -( |u| + c_{f} )$ and $S_{R} = +( |u| + c_{f} )$.\n-   **Boundary Conditions (BC)**: Reflective boundary conditions (RBC) at $x=0$.\n-   **RBC Implementation**: Ghost-cell normal velocity is set to $u_{\\text{ghost}} = - u_{\\text{adjacent}}$.\n-   **Semi-discrete Equation**: $\\frac{d U_{i}}{dt} = - \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}$.\n-   **Domain Parameters**: $L = 1 \\ \\text{m}$, $N = 128$.\n-   **Flow Parameters**: Maximum $|u| = 1.0 \\times 10^{5} \\ \\text{m}\\,\\text{s}^{-1}$ (uniform), $c_{f} = 2.0 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1}$ (uniform).\n-   **Stability Parameter**: Courant–Friedrichs–Lewy (CFL) number, $\\text{CFL} = 0.8$.\n-   **Objective**: Compute the conservative global time step $\\Delta t$, defined as the minimum of the local time-step bounds over all cells, accounting for the effect of RBC.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is well-grounded in the principles of computational fluid dynamics and magnetohydrodynamics. The finite-volume method, Rusanov flux, CFL stability condition, and reflective boundary conditions are standard and well-established concepts. The physics of wave propagation and reflection is correctly represented.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary parameters ($L$, $N$, $|u|$, $c_f$, CFL number) and a clear definition of the numerical scheme and boundary conditions to uniquely determine the stability-limited time step.\n-   **Objective**: The problem is stated using precise, objective, and standard terminology from the field of computational physics. There is no ambiguity or subjective content.\n-   **Completeness and Consistency**: The setup is complete and internally consistent. The definitions of the numerical flux, dissipation, and boundary conditions are mutually compatible.\n-   **Other Flaws**: The problem does not exhibit any other flaws from the checklist, such as being unrealistic, ill-posed, or trivial. It tests a key concept in numerical stability for hyperbolic systems with boundaries.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation and Solution\n\nThe stability of an explicit time-integration scheme for a hyperbolic system is governed by the Courant–Friedrichs–Lewy (CFL) condition. This condition ensures that the numerical domain of dependence of a cell's updated value contains the physical domain of dependence. For a one-dimensional finite-volume scheme, this means that information propagating as waves from adjacent cells must not travel further than the cell's own width in a single time step $\\Delta t$.\n\nThe semi-discrete finite-volume equation for cell $i$ is:\n$$\n\\frac{d U_{i}}{dt} = - \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}\n$$\nFor a Godunov-type scheme using Riemann-solver-based fluxes like Rusanov, a rigorous stability analysis for cell $i$ relates the time step $\\Delta t_i$ to the maximum speeds of waves entering cell $i$ from its neighboring faces. Let $\\lambda_{R, i-1/2}$ be the maximum speed of a right-propagating wave from the Riemann problem at face $i-1/2$, and $\\lambda_{L, i+1/2}$ be the maximum speed of a left-propagating wave from face $i+1/2$. The stability constraint is:\n$$\n\\Delta t_i \\left( \\lambda_{R, i-1/2} - \\lambda_{L, i+1/2} \\right) \\le \\text{CFL} \\cdot \\Delta x\n$$\nThe Rusanov flux uses a symmetric estimate for wave speeds. The dissipation parameter $\\alpha_{i+1/2}$ is the maximum absolute characteristic speed at face $i+1/2$. Thus, we have $\\lambda_R = +\\alpha$ and $\\lambda_L = -\\alpha$. Substituting these into the stability constraint gives:\n$$\n\\Delta t_i \\left( \\alpha_{i-1/2} - (-\\alpha_{i+1/2}) \\right) \\le \\text{CFL} \\cdot \\Delta x\n$$\n$$\n\\Delta t_i \\le \\text{CFL} \\frac{\\Delta x}{\\alpha_{i-1/2} + \\alpha_{i+1/2}}\n$$\nThis is the conservative \"sum-over-faces\" time-step bound. The denominator represents the total rate at which a cell's volume is \"swept\" by waves from all its faces. This is more restrictive and robust than a \"naive single-face\" estimate of the form $\\Delta t_i \\le \\text{CFL} \\frac{\\Delta x}{\\alpha}$, which only considers the fastest wave speed in isolation.\n\n**Interior Cell Analysis:**\nFor an interior cell, say cell $i$, it has two faces: $i-1/2$ and $i+1/2$. The problem states that the flow parameters $|u|$ and $c_f$ are uniform. Therefore, the dissipation parameter $\\alpha = |u| + c_f$ is a constant for all interior faces.\n$$\n\\alpha_{i-1/2} = \\alpha_{i+1/2} = |u| + c_f\n$$\nThe local time-step bound for an interior cell is:\n$$\n\\Delta t_{\\text{interior}} \\le \\text{CFL} \\frac{\\Delta x}{(|u| + c_f) + (|u| + c_f)} = \\text{CFL} \\frac{\\Delta x}{2(|u| + c_f)}\n$$\n\n**Boundary Cell Analysis:**\nNow we analyze the cell adjacent to the reflective wall at $x=0$. Let's label this cell $i=1$. Its faces are at $x=0$ (face $1/2$) and $x=\\Delta x$ (face $3/2$).\n\nThe physical interpretation of a reflective boundary is that any wave incident upon it is reflected back into the domain. A wave packet entering the boundary cell from the interior (at face $3/2$) propagates towards the wall. Upon reaching the wall, it reflects and propagates back towards the interior. For the purpose of stability, this means the signal traverses the cell, is reflected, and immediately begins to traverse the cell again in the opposite direction. The effective speed of information propagation that influences the cell's state is doubled. This leads to a halving of the stable time step compared to a naive estimate that ignores the reflection.\n\nLet's formalize this using the sum-over-faces criterion. The bound for cell $1$ is:\n$$\n\\Delta t_{1} \\le \\text{CFL} \\frac{\\Delta x}{\\alpha_{1/2} + \\alpha_{3/2}}\n$$\nThe face $3/2$ is an interior face, so $\\alpha_{3/2} = |u| + c_f$.\nThe face $1/2$ is the boundary. The flux here is computed using the state in cell $1$ ($U_1$) and a ghost cell state ($U_{\\text{ghost}}$). The Rusanov dissipation parameter $\\alpha_{1/2}$ is the maximum of the characteristic speeds from $U_1$ and $U_{\\text{ghost}}$.\nThe characteristic speed is $\\lambda_{\\max}(U) = |u| + c_f$.\nFor $U_1$, we have $\\lambda_{\\max}(U_1) = |u_1| + c_{f,1}$.\nFor $U_{\\text{ghost}}$, we use the RBC: $u_{\\text{ghost}} = -u_1$. Other scalar quantities like pressure and density are typically set with even symmetry, meaning $c_{f, \\text{ghost}} = c_{f,1}$.\nTherefore, $\\lambda_{\\max}(U_{\\text{ghost}}) = |u_{\\text{ghost}}| + c_{f, \\text{ghost}} = |-u_1| + c_{f,1} = |u_1| + c_{f,1}$.\nThe dissipation at the wall face is $\\alpha_{1/2} = \\max(\\lambda_{\\max}(U_1), \\lambda_{\\max}(U_{\\text{ghost}})) = |u_1| + c_{f,1}$.\nSince the problem specifies uniform values, we have $\\alpha_{1/2} = |u| + c_f$.\n\nSubstituting the face speeds into the bound for cell $1$:\n$$\n\\Delta t_{\\text{boundary}} \\le \\text{CFL} \\frac{\\Delta x}{(|u| + c_f) + (|u| + c_f)} = \\text{CFL} \\frac{\\Delta x}{2(|u| + c_f)}\n$$\nThis demonstrates that the rigorous \"sum-over-faces\" criterion naturally incorporates the \"doubling\" of the effective wave speed, yielding a bound for the boundary cell that is identical to that of an interior cell (under uniform conditions). The physical picture of reflection and the formal analysis of the ghost-cell method are consistent.\n\n**Global Time Step Calculation:**\nThe global time step $\\Delta t$ must be stable for all cells. Since the local time-step bound is the same for all interior and boundary cells, the global time step is:\n$$\n\\Delta t = \\text{CFL} \\frac{\\Delta x}{2(|u| + c_f)}\n$$\n\nFirst, we compute the required parameters:\n-   Cell width: $\\Delta x = \\frac{L}{N} = \\frac{1 \\ \\text{m}}{128} = 0.0078125 \\ \\text{m}$.\n-   Maximum characteristic speed: $\\alpha = |u| + c_f = 1.0 \\times 10^{5} \\ \\text{m}\\,\\text{s}^{-1} + 2.0 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1} = 2.1 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1}$.\n-   The denominator term for the conservative bound is $2 \\alpha = 2 \\times (2.1 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1}) = 4.2 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1}$.\n\nNow, we compute the global time step $\\Delta t$:\n$$\n\\Delta t = (0.8) \\frac{0.0078125 \\ \\text{m}}{4.2 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1}}\n$$\n$$\n\\Delta t = \\frac{0.00625 \\ \\text{m}}{4.2 \\times 10^{6} \\ \\text{m}\\,\\text{s}^{-1}} \\approx 1.488095 \\times 10^{-9} \\ \\text{s}\n$$\nRounding to three significant figures, we get:\n$$\n\\Delta t \\approx 1.49 \\times 10^{-9} \\ \\text{s}\n$$\n\n### Option-by-Option Analysis\n\n**A. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{|u| + c_{f}} = 2.98 \\times 10^{-9} \\ \\text{s}$**\nThis formula represents the \"naive single-face\" stability estimate. It does not account for wave interactions from both sides of an interior cell, nor does it correctly account for the reflection at the boundary. It is not a conservative bound for this scheme. The numerical value is approximately twice the correct value ($0.8 \\times 0.0078125 / (2.1 \\times 10^6) \\approx 2.98 \\times 10^{-9}$), which is consistent with the less restrictive formula.\n**Verdict: Incorrect.**\n\n**B. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{2 ( |u| + c_{f} )} = 1.49 \\times 10^{-9} \\ \\text{s}$**\nThis formula corresponds to the conservative \"sum-over-faces\" stability criterion, $\\text{CFL} \\frac{\\Delta x}{2\\alpha}$. As derived, this is the correct bound for both interior cells and the boundary-adjacent cell. The numerical value matches our calculation.\n**Verdict: Correct.**\n\n**C. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{|u| + 2 c_{f}} = 1.44 \\times 10^{-9} \\ \\text{s}$**\nThe denominator $|u| + 2c_f$ has no theoretical basis in the context of Rusanov flux or CFL conditions. The \"doubling\" effect applies to the entire characteristic speed $\\alpha = |u| + c_f$, not just the sound speed component $c_f$. The formula is physically and mathematically unfounded.\n**Verdict: Incorrect.**\n\n**D. $\\Delta t = \\text{CFL} \\, \\frac{\\Delta x}{2 |u| + 2 c_{f}} = 1.36 \\times 10^{-9} \\ \\text{s}$**\nThe formula in the denominator is $2|u| + 2c_f$, which is equal to $2(|u|+c_f)$, the same correct denominator as in option B. However, the provided numerical result, $1.36 \\times 10^{-9} \\ \\text{s}$, is inconsistent with the calculation for this formula, which yields $1.49 \\times 10^{-9} \\ \\text{s}$. Since the numerical value is incorrect, the option as a whole is incorrect.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Ensuring numerical stability is necessary, but not always sufficient; a simulation must also be accurate. This practice moves beyond fixed time steps to explore adaptive timestepping, a powerful strategy for achieving efficiency and accuracy simultaneously. Using an embedded Runge-Kutta method, you will learn how to estimate the local truncation error and use it to control the step size to meet a desired tolerance . The key challenge, which this problem addresses, is to then harmonize this accuracy-based controller with the hard, non-negotiable stability limit imposed by the CFL condition.",
            "id": "3977905",
            "problem": "In an explicit time integration of a semi-discrete hyperbolic system arising in computational magnetohydrodynamics (MHD), consider advancing the solution with an embedded Runge–Kutta (RK) pair of orders $p$ and $p-1$. The embedded pair produces two approximations at time $t_{n}+\\Delta t_{n}$ using the same stage derivatives: a higher-order solution $y_{n+1}^{[p]}$ and an embedded lower-order solution $y_{n+1}^{[p-1]}$, whose difference is used to estimate the local truncation error. Assume the standard asymptotic local error expansion for explicit RK methods and that the error estimator is normalized to a dimensionless scalar $\\text{err}_{n}$ that is asymptotically proportional to $\\Delta t_{n}^{p+1}$. \n\nTask 1: Concisely describe how an embedded RK pair constructs a local error estimate from a single stage computation. Then, starting from the asymptotic relation between the local truncation error and the time step size, derive a step-size controller that updates $\\Delta t_{n+1}$ in terms of $\\Delta t_{n}$, a user tolerance $\\text{tol}$, the measured scalar error $\\text{err}_{n}$, and the method order $p$. Include a safety factor $s\\in(0,1)$.\n\nTask 2: In one-dimensional ($1\\text{D}$) MHD with flow speed $u$, sound speed $c_{s}$, and Alfvén speed $v_{A}$, the fast magnetosonic speed is $c_{f}=\\sqrt{c_{s}^{2}+v_{A}^{2}}$ for the aligned-field case, and a conservative upper bound on the maximum characteristic speed relative to the mesh is $a_{\\max}=|u|+c_{f}$. For a uniform grid of spacing $\\Delta x$, an explicit finite-volume method with an explicit RK time integrator must satisfy a Courant–Friedrichs–Lewy (CFL) condition of the form $\\Delta t\\le \\nu_{\\max}\\,\\Delta x/a_{\\max}$ for stability, where $\\nu_{\\max}\\in(0,1)$ is a prescribed Courant number bound consistent with the linear stability region of the chosen spatial–temporal discretization.\n\nCombine your controller from Task 1 with a hard cap imposed by the CFL stability limit to produce a single update formula for $\\Delta t_{n+1}$ that selects the smaller of the error-based proposal and the CFL cap. Then evaluate $\\Delta t_{n+1}$ numerically for the following parameters:\n- Embedded pair order for the accepted solution: $p=5$.\n- Safety factor: $s=0.9$.\n- Current step size: $\\Delta t_{n}=1.2\\times 10^{-8}\\ \\text{s}$.\n- User tolerance: $\\text{tol}=1.0\\times 10^{-5}$.\n- Measured scalar error: $\\text{err}_{n}=2.5\\times 10^{-4}$.\n- Grid spacing: $\\Delta x=5.2\\times 10^{-3}\\ \\text{m}$.\n- Flow speed magnitude: $|u|=1.0\\times 10^{5}\\ \\text{m}\\,\\text{s}^{-1}$.\n- Sound speed: $c_{s}=1.5\\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}$.\n- Alfvén speed: $v_{A}=2.0\\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}$.\n- Courant number bound: $\\nu_{\\max}=0.8$.\n\nExpress your final answer as the single numerical value of $\\Delta t_{n+1}$ in seconds, rounded to three significant figures.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically sound, well-posed, and free of contradictions or ambiguities, resting upon established principles of numerical methods for partial differential equations in computational physics. A full solution is therefore presented.\n\nThe problem is divided into two tasks. The first is to describe the error estimation mechanism of an embedded Runge-Kutta (RK) pair and derive an adaptive step-size controller. The second is to combine this controller with a Courant–Friedrichs–Lewy (CFL) stability constraint and perform a numerical calculation.\n\n**Task 1: Error Estimation and Step-Size Controller Derivation**\n\nAn embedded Runge-Kutta pair consists of two explicit RK methods of orders $p$ and $p-1$. Its defining feature is that both methods utilize the same set of stage derivatives (function evaluations) to advance the solution from time $t_n$ by a step $\\Delta t_n$. This yields two distinct approximations at time $t_{n+1} = t_n + \\Delta t_n$: a higher-order solution $y_{n+1}^{[p]}$ and a lower-order embedded solution $y_{n+1}^{[p-1]}$. The difference between these two approximations, $E_{n+1} = y_{n+1}^{[p]} - y_{n+1}^{[p-1]}$, serves as an estimate of the local truncation error (LTE). Typically, this difference is an estimate for the LTE of the lower-order method, which is of order $p$. However, the problem statement specifies that a normalized scalar error metric, $\\text{err}_n$, is asymptotically proportional to $\\Delta t_{n}^{p+1}$. This indicates that the error being controlled is the LTE of the higher-order method. We proceed based on this given premise.\n\nThe asymptotic relationship between the estimated error $\\text{err}_n$ at step $n$ and the step size $\\Delta t_n$ is given as:\n$$\n\\text{err}_{n} \\approx C \\Delta t_{n}^{p+1}\n$$\nwhere $C$ is a constant that depends on the solution's higher-order derivatives but is assumed to be approximately constant over consecutive time steps.\n\nThe objective of an adaptive step-size controller is to select the next time step, $\\Delta t_{n+1}$, such that the predicted error for that step, $\\text{err}_{n+1}$, meets a prescribed user tolerance, $\\text{tol}$. We thus set the target:\n$$\n\\text{tol} \\approx C \\Delta t_{n+1}^{p+1}\n$$\n\nTo find the new step size $\\Delta t_{n+1}$, we can eliminate the unknown constant $C$ by taking the ratio of the two preceding expressions:\n$$\n\\frac{\\text{tol}}{\\text{err}_{n}} \\approx \\frac{C \\Delta t_{n+1}^{p+1}}{C \\Delta t_{n}^{p+1}} = \\left(\\frac{\\Delta t_{n+1}}{\\Delta t_{n}}\\right)^{p+1}\n$$\nSolving for $\\Delta t_{n+1}$ yields the optimal step-size estimate:\n$$\n\\Delta t_{n+1} \\approx \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}}\n$$\nTo create a more robust controller that avoids overly optimistic step-size increases and reduces the frequency of rejected steps, a safety factor $s \\in (0,1)$ is introduced. The resulting formula for the step size proposed by the error controller, which we denote $\\Delta t_{\\text{err}}$, is:\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}}\n$$\n\n**Task 2: Combined Controller and Numerical Evaluation**\n\nFor an explicit time integration scheme applied to a hyperbolic system, the time step must satisfy a CFL condition for numerical stability. The problem provides this condition as $\\Delta t \\le \\nu_{\\max}\\,\\Delta x/a_{\\max}$, where $a_{\\max}$ is the maximum characteristic speed. This imposes a hard upper limit on the step size, $\\Delta t_{\\text{CFL}} = \\nu_{\\max}\\,\\Delta x/a_{\\max}$, independent of accuracy considerations.\n\nThe final time step $\\Delta t_{n+1}$ must satisfy both the accuracy requirement (to keep the error below $\\text{tol}$) and the stability requirement. Therefore, the new step size is chosen as the minimum of the value proposed by the error controller and the CFL stability limit:\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text{err}}, \\Delta t_{\\text{CFL}})\n$$\n\nWe now evaluate this expression using the provided numerical parameters.\nFirst, we calculate the CFL time-step limit, $\\Delta t_{\\text{CFL}}$. This requires the maximum characteristic speed, $a_{\\max}$.\nThe fast magnetosonic speed $c_f$ is:\n$$\nc_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}} = \\sqrt{(1.5 \\times 10^{6})^{2} + (2.0 \\times 10^{6})^{2}} = \\sqrt{2.25 \\times 10^{12} + 4.0 \\times 10^{12}} = \\sqrt{6.25 \\times 10^{12}} = 2.5 \\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}\n$$\nThe maximum characteristic speed relative to the mesh is:\n$$\na_{\\max} = |u| + c_{f} = 1.0 \\times 10^{5} + 2.5 \\times 10^{6} = 2.6 \\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}\n$$\nNow, we can compute the CFL step-size limit:\n$$\n\\Delta t_{\\text{CFL}} = \\nu_{\\max} \\frac{\\Delta x}{a_{\\max}} = 0.8 \\times \\frac{5.2 \\times 10^{-3}}{2.6 \\times 10^{6}} = 0.8 \\times (2.0 \\times 10^{-9}) = 1.6 \\times 10^{-9}\\ \\text{s}\n$$\nNext, we calculate the step size proposed by the error controller, $\\Delta t_{\\text{err}}$. The parameters are $p=5$, $s=0.9$, $\\Delta t_n = 1.2 \\times 10^{-8}$, $\\text{tol}=1.0 \\times 10^{-5}$, and $\\text{err}_n = 2.5 \\times 10^{-4}$. The exponent in the controller is $\\frac{1}{p+1} = \\frac{1}{5+1} = \\frac{1}{6}$.\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}} = 0.9 \\cdot (1.2 \\times 10^{-8}) \\left(\\frac{1.0 \\times 10^{-5}}{2.5 \\times 10^{-4}}\\right)^{\\frac{1}{6}}\n$$\n$$\n\\Delta t_{\\text{err}} = 1.08 \\times 10^{-8} \\left(\\frac{1}{25}\\right)^{\\frac{1}{6}} = 1.08 \\times 10^{-8} \\left(0.04\\right)^{\\frac{1}{6}}\n$$\n$$\n\\Delta t_{\\text procrastinate} \\approx 1.08 \\times 10^{-8} \\times 0.573539 \\approx 6.1942 \\times 10^{-9}\\ \\text{s}\n$$\nFinally, we select the new step size $\\Delta t_{n+1}$ by taking the minimum of the two calculated values:\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text procrastinate}, \\Delta t_{\\text{CFL}}) = \\min(6.1942 \\times 10^{-9}\\ \\text{s}, 1.6 \\times 10^{-9}\\ \\text{s}) = 1.6 \\times 10^{-9}\\ \\text{s}\n$$\nIn this case, the time step is limited by the CFL stability condition, not the accuracy requirement. The problem requires the final answer to be rounded to three significant figures.\n$$\n\\Delta t_{n+1} = 1.60 \\times 10^{-9}\\ \\text{s}\n$$",
            "answer": "$$\n\\boxed{1.60 \\times 10^{-9}}\n$$"
        }
    ]
}