{
    "hands_on_practices": [
        {
            "introduction": "在复杂的计算模型中，多种物理过程同时发生，每种过程都有其固有的时间尺度。此练习将指导您应对这种情况，通过计算和汇总来自不同物理现象（包括对流、磁流体动力学（MHD）波、各向异性热传导和电阻扩散）的稳定性约束，来确定一个最终的全局时间步长 。这项实践强调了在多物理场问题中，必须全面地分析所有可能限制时间步长的因素，并找出其中最严格的“瓶颈”效应。",
            "id": "3977943",
            "problem": "在一个由均匀笛卡尔网格离散化的矩形域中，进行了一场包含各向异性热传导的电阻磁流体力学（MHD）的三维显式模拟。网格间距为 $\\,\\Delta x = 1.0 \\times 10^{-3}\\,$ m, $\\,\\Delta y = 5.0 \\times 10^{-3}\\,$ m, 以及 $\\,\\Delta z = 1.0 \\times 10^{-2}\\,$ m。该等离子体的质量密度为 $\\,\\rho = 3.343 \\times 10^{-7}\\,$ kg/m$^{3}$，标量热压为 $\\,p = 1.602 \\times 10^{5}\\,$ Pa，比热比为 $\\,\\gamma = 5/3\\,$，并有一个沿 $\\,y\\,$ 轴方向、大小为 $\\,B = 5\\,$ T 的均匀磁场。流速在空间上是均匀的，其分量为 $\\,u_{x} = 5.0 \\times 10^{3}\\,$ m/s, $\\,u_{y} = 2.0 \\times 10^{4}\\,$ m/s, 和 $\\,u_{z} = 1.0 \\times 10^{4}\\,$ m/s。电阻磁扩散率为 $\\,\\eta_{m} = 5.0\\,$ m$^{2}$/s。各向异性热输运通过一个扩散张量进行建模，其平行和垂直热扩散率分别为 $\\,\\chi_{\\parallel} = 1.0 \\times 10^{8}\\,$ m$^{2}$/s 和 $\\,\\chi_{\\perp} = 1.0\\,$ m$^{2}$/s，其中平行方向与磁场方向一致。\n\n该代码使用非分裂有限体积法和一阶前向欧拉时间积分来推进所有场。对流通量和 MHD 波通量通过一种迎风 Godunov 通量计算，当各方向 Courant 数之和不超过 Courant–Friedrichs–Lewy (CFL) 常数 $\\,C_{\\mathrm{hyp}} = 0.5\\,$ 时，该方法是稳定的。扩散项（热传导和电阻扩散）通过二阶中心差分进行离散并显式推进，受抛物型稳定性常数 $\\,C_{\\mathrm{diff}} = 0.5\\,$ 的约束。假设最大 MHD 信号速度是快磁声速 $\\,c_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}}\\,$，其中 $\\,c_{s} = \\sqrt{\\gamma p / \\rho}\\,$ 是声速，$\\,v_{A} = B/\\sqrt{\\mu_{0}\\rho}\\,$ 是 Alfvén 速度，磁导率 $\\,\\mu_{0} = 4\\pi \\times 10^{-7}\\,$ H/m。将快磁声速视为各向同性。\n\n请通过汇总以下各项的独立稳定性约束来计算最终的显式时间步长：\n1) 流速的纯对流，\n2) 以快磁声速传播的双曲 MHD 波，\n3) 与磁场方向一致的各向异性热传导，以及\n4) 电阻磁扩散。\n\n使用给定的稳定性常数，取所有单个边界中的最小值为全局时间步长。在你的推导过程中，用文字说明主导的限制机制，但仅报告最终时间步长的数值作为答案。将数值答案四舍五入至三位有效数字。以秒为单位表示最终时间步长。",
            "solution": "所述问题具有科学依据、适定、客观且内部一致。计算电阻磁流体力学（MHD）模拟中显式时间步长约束所需的所有必要参数和定义均已提供。物理模型和数值方法约束在计算等离子体物理学中是标准的。因此，该问题是有效的，并将提供解答。\n\n目标是确定显式时间积分方案的最大允许时间步长 $\\Delta t$，它受到几种物理现象的约束。总时间步长是每个独立过程所要求的时间步长中的最小值：\n$$ \\Delta t = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{MHD}}, \\Delta t_{\\text{th}}, \\Delta t_{\\text{res}}) $$\n我们将计算这四个稳定性极限中的每一个。\n\n首先，我们使用提供的参数计算等离子体的特征波速：\n- 质量密度: $\\rho = 3.343 \\times 10^{-7}\\,$ kg/m$^3$\n- 热压: $p = 1.602 \\times 10^{5}\\,$ Pa\n- 比热比: $\\gamma = 5/3$\n- 磁场大小: $B = 5\\,$ T\n- 真空磁导率: $\\mu_0 = 4\\pi \\times 10^{-7}\\,$ H/m\n\n声速 $c_s$ 由下式给出：\n$$ c_s = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(5/3) \\times (1.602 \\times 10^5 \\text{ Pa})}{3.343 \\times 10^{-7} \\text{ kg/m}^3}} \\approx 8.937 \\times 10^5 \\text{ m/s} $$\n\nAlfvén 速度 $v_A$ 由下式给出：\n$$ v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} = \\frac{5 \\text{ T}}{\\sqrt{(4\\pi \\times 10^{-7} \\text{ H/m}) \\times (3.343 \\times 10^{-7} \\text{ kg/m}^3)}} \\approx 7.714 \\times 10^6 \\text{ m/s} $$\n\n快磁声速 $c_f$ 是声速和 Alfvén 速度的平方和的平方根：\n$$ c_f = \\sqrt{c_s^2 + v_A^2} = \\sqrt{(8.937 \\times 10^5 \\text{ m/s})^2 + (7.714 \\times 10^6 \\text{ m/s})^2} \\approx 7.766 \\times 10^6 \\text{ m/s} $$\n\n在非分裂、三维显式方案中，针对双曲型（对流、波）和抛物型（扩散）现象的稳定性约束由以下公式给出：\n- 双曲型 CFL 条件：$\\Delta t_{\\text{hyp}} \\le \\frac{C_{\\mathrm{hyp}}}{\\sum_{i=x,y,z} \\frac{v_i}{\\Delta i}}$，其中 $v_i$ 是 $i$ 方向上的最大信号速度。\n- 抛物型条件：$\\Delta t_{\\text{diff}} \\le \\frac{C_{\\mathrm{diff}}}{\\sum_{i=x,y,z} \\frac{D_i}{(\\Delta i)^2}}$，其中 $D_i$ 是 $i$ 方向上的扩散率。\n\n给定的网格间距为 $\\Delta x = 1.0 \\times 10^{-3}\\,$ m, $\\Delta y = 5.0 \\times 10^{-3}\\,$ m, 和 $\\Delta z = 1.0 \\times 10^{-2}\\,$ m。稳定性常数为 $C_{\\mathrm{hyp}} = 0.5$ 和 $C_{\\mathrm{diff}} = 0.5$。\n\n1.  **纯对流约束 ($\\Delta t_{\\text{adv}}$)**\n    此约束由流体速度 $\\vec{u} = (u_x, u_y, u_z)$ 决定，其中 $u_x = 5.0 \\times 10^3\\,$ m/s, $u_y = 2.0 \\times 10^4\\,$ m/s, 且 $u_z = 1.0 \\times 10^4\\,$ m/s。\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + \\frac{|u_z|}{\\Delta z}} $$\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{0.5}{\\frac{5.0 \\times 10^3}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4}{1.0 \\times 10^{-2}}} = \\frac{0.5}{5.0 \\times 10^6 + 4.0 \\times 10^6 + 1.0 \\times 10^6} = \\frac{0.5}{1.0 \\times 10^7} $$\n    $$ \\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8} \\text{ s} $$\n\n2.  **双曲 MHD 波约束 ($\\Delta t_{\\text{MHD}}$)**\n    在 $i$ 方向上的最大信号速度是 $|u_i| + c_f$。\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x| + c_f}{\\Delta x} + \\frac{|u_y| + c_f}{\\Delta y} + \\frac{|u_z| + c_f}{\\Delta z}} $$\n    分母中时间尺度倒数之和为：\n    $$ \\sum \\frac{v_i}{\\Delta i} = \\frac{5.0 \\times 10^3 + 7.766 \\times 10^6}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4 + 7.766 \\times 10^6}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4 + 7.766 \\times 10^6}{1.0 \\times 10^{-2}} $$\n    $$ \\sum \\frac{v_i}{\\Delta i} \\approx (7.771 \\times 10^9) + (1.557 \\times 10^9) + (0.778 \\times 10^9) = 1.0106 \\times 10^{10} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{0.5}{1.0106 \\times 10^{10}} \\approx 4.948 \\times 10^{-11} \\text{ s} $$\n\n3.  **各向异性热传导约束 ($\\Delta t_{\\text{th}}$)**\n    这是一个抛物型约束。磁场与 $y$ 轴对齐，因此热扩散是高度各向异性的。沿网格轴的扩散系数为 $\\chi_x = \\chi_{\\perp} = 1.0\\,$ m$^2$/s, $\\chi_y = \\chi_{\\parallel} = 1.0 \\times 10^8\\,$ m$^2$/s, 和 $\\chi_z = \\chi_{\\perp} = 1.0\\,$ m$^2$/s。\n    $$ \\Delta t_{\\text{th}} \\le \\frac{C_{\\mathrm{diff}}}{\\frac{\\chi_x}{(\\Delta x)^2} + \\frac{\\chi_y}{(\\Delta y)^2} + \\frac{\\chi_z}{(\\Delta z)^2}} $$\n    网格间距的平方为 $(\\Delta x)^2 = 1.0 \\times 10^{-6}\\,$ m$^2$, $(\\Delta y)^2 = 2.5 \\times 10^{-5}\\,$ m$^2$, 和 $(\\Delta z)^2 = 1.0 \\times 10^{-4}\\,$ m$^2$。\n    分母中时间尺度倒数之和为：\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} = \\frac{1.0}{1.0 \\times 10^{-6}} + \\frac{1.0 \\times 10^8}{2.5 \\times 10^{-5}} + \\frac{1.0}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^{12} + 1.0 \\times 10^4 $$\n    平行传导项 $\\frac{\\chi_{\\parallel}}{(\\Delta y)^2}$ 占主导地位。\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} \\approx 4.0 \\times 10^{12} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{th}} \\le \\frac{0.5}{4.0 \\times 10^{12}} = 1.25 \\times 10^{-13} \\text{ s} $$\n\n4.  **电阻磁扩散约束 ($\\Delta t_{\\text{res}}$)**\n    这是一个各向同性的抛物型过程，扩散率为 $\\eta_m = 5.0\\,$ m$^2$/s。\n    $$ \\Delta t_{\\text{res}} \\le \\frac{C_{\\mathrm{diff}}}{\\eta_m \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} + \\frac{1}{(\\Delta z)^2} \\right)} $$\n    几何因子之和为：\n    $$ \\sum \\frac{1}{(\\Delta i)^2} = \\frac{1}{1.0 \\times 10^{-6}} + \\frac{1}{2.5 \\times 10^{-5}} + \\frac{1}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^4 + 1.0 \\times 10^4 = 1.05 \\times 10^6 \\text{ m}^{-2} $$\n    $$ \\Delta t_{\\text{res}} \\le \\frac{0.5}{5.0 \\times (1.05 \\times 10^6)} = \\frac{0.5}{5.25 \\times 10^6} \\approx 9.524 \\times 10^{-8} \\text{ s} $$\n\n比较四个时间步长限制：\n- $\\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8}\\,$ s\n- $\\Delta t_{\\text{MHD}} \\le 4.948 \\times 10^{-11}\\,$ s\n- $\\Delta t_{\\text{th}} \\le 1.25 \\times 10^{-13}\\,$ s\n- $\\Delta t_{\\text{res}} \\le 9.524 \\times 10^{-8}\\,$ s\n\n最小值决定了显式模拟的全局时间步长。\n$$ \\Delta t = \\min(5.0 \\times 10^{-8}, 4.948 \\times 10^{-11}, 1.25 \\times 10^{-13}, 9.524 \\times 10^{-8}) = 1.25 \\times 10^{-13} \\text{ s} $$\n主导的限制机制是对各向异性热传导的显式处理。平行于磁场的极高扩散率与该方向的空间分辨率相结合，施加了一个非常严格的时间步长限制。最终答案，四舍五入到三位有效数字，是 $1.25 \\times 10^{-13}$ 秒。",
            "answer": "$$ \\boxed{1.25 \\times 10^{-13}} $$"
        },
        {
            "introduction": "确保数值稳定性是显式时间积分的首要任务，但这并不等同于获得了物理上精确的解。本练习通过分析在磁化聚变等离子体模拟中广泛使用的Boris算法，来探讨数值稳定性和计算精度之间的关键区别 。您将深入理解为何一个数值方法可以对任意大的时间步长都保持稳定，但为了准确地解析如带电粒子回旋运动这类快速物理过程，却必须采用远小于其周期的时间步长。",
            "id": "3977945",
            "problem": "一个电荷为$q$、质量为$m$的非相对论带电粒子，在空间均匀磁场$\\mathbf{B} = B_0 \\,\\hat{\\mathbf{z}}$和零电场$\\mathbf{E} = \\mathbf{0}$中运动。在用于磁化聚变等离子体的粒子模拟（PIC）计算中，显式Boris推子被广泛用于推进粒子的速度和位置。从洛伦兹力定律和回旋频率$\\Omega_c = q B_0 / m$的定义出发，论述在这种情况下，由Boris推子执行的显式时间积分在稳定性和精度方面的定性和定量差异。特别地，请辨析该方法是否以及为何可以在没有Courant–Friedrichs–Lewy (CFL) 约束的情况下保持稳定，同时仍然需要$\\Delta t\\,\\Omega_c \\ll 1$来精确解析回旋运动。\n\n选择所有在此条件下正确描述Boris推子稳定性和精度特性的陈述：\n\nA. 在$\\mathbf{E}=\\mathbf{0}$的均匀磁场中，Boris推子对任意$\\Delta t$都能精确保持动能守恒，这意味着离散速度更新是线性稳定的，并且没有将$\\Delta t$与$\\Omega_c$关联的Courant–Friedrichs–Lewy (CFL) 约束。\n\nB. 在均匀磁场中，Boris推子通过在垂直于$\\mathbf{B}$的平面上旋转一个角度来推进速度，该角度恰好为$\\theta = \\Omega_c \\Delta t$，因此对于任何$\\Delta t$都没有相位误差。\n\nC. 尽管Boris推子对任意$\\Delta t$都是稳定的，但要定量精确地解析回旋运动，需要$\\Delta t\\,\\Omega_c \\ll 1$，因为每步的相位误差尺度为$\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^3\\right)$，在多次回旋后产生的累积（全局）相位误差为$\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^2\\right)$。\n\nD. 为了保证显式稳定性，Boris推子要求$\\Delta t\\,\\Omega_c  2$，否则离散映射将变得不稳定，粒子速度会发散。\n\nE. 在聚变相关场中，例如$B_0 = 5\\,\\mathrm{T}$下的氘核，选择$\\Delta t = \\dfrac{0.1}{\\Omega_c}$在保持动能守恒的同时，在回旋运动中不会产生相位误差，因此同时实现了稳定性和精确的精度。",
            "solution": "用户要求对问题陈述进行批判性验证，然后给出详细解答和选项评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 一个电荷为$q$、质量为$m$的非相对论带电粒子。\n- 运动在空间均匀磁场$\\mathbf{B} = B_0 \\,\\hat{\\mathbf{z}}$中。\n- 电场为零，$\\mathbf{E} = \\mathbf{0}$。\n- 数值方法是显式Boris推子。\n- 回旋频率定义为$\\Omega_c = q B_0 / m$。\n- 核心问题是辨析该方法的稳定性和精度约束之间的区别，特别是为何它可以在没有Courant–Friedrichs–Lewy (CFL) 约束的情况下保持稳定，同时仍然需要$\\Delta t\\,\\Omega_c \\ll 1$来保证精度。\n\n**步骤2：使用已知条件进行验证**\n- **科学依据：** 该问题描述了拉莫尔回旋，这是带电粒子在磁场中由洛伦兹力支配的基本运动。Boris推子是在等离子体的粒子模拟（PIC）中使用了几十年的标准、经典的算法。数值稳定性、CFL条件、精度和相位误差等概念都是计算物理学中严谨的核心课题。该问题牢固地植根于既定的物理学和数值分析。\n- **适定性：** 物理系统定义明确（$\\mathbf{E}=0$，均匀$\\mathbf{B}$）。数值方法已指定（Boris推子）。问题是精确的，要求辨析稳定性和精度约束之间的区别。进行独特而有意义的分析是可能的。\n- **客观性：** 语言是技术性的、精确的，并且没有主观性。所有术语都是该领域的标准术语。\n\n**步骤3：结论和行动**\n问题陈述在科学上是合理的、适定的和客观的。它提出了一个计算等离子体物理学中标准的、非平凡的问题，适合进行严谨的分析。该问题是有效的。\n\n### 基于原理的推导\n\n粒子的运动由非相对论洛伦兹力方程决定：\n$$ m \\frac{d\\mathbf{v}}{dt} = q (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) $$\n给定$\\mathbf{E} = \\mathbf{0}$，这简化为磁力方程：\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m} (\\mathbf{v} \\times \\mathbf{B}) $$\n对于均匀磁场$\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$，并使用$\\Omega_c = qB_0/m$，方程变为：\n$$ \\frac{d\\mathbf{v}}{dt} = \\Omega_c (\\mathbf{v} \\times \\hat{\\mathbf{z}}) $$\n该方程描述了速度矢量$\\mathbf{v}$以角频率$\\Omega_c$绕$\\hat{\\mathbf{z}}$轴旋转。平行于$\\mathbf{B}$的速度分量$v_z$是恒定的，而垂直分量$\\mathbf{v}_{\\perp}$则旋转。动能$K = \\frac{1}{2}mv^2$是一个精确的运动守恒量，因为磁力不做功（$(\\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{v} = 0$）。\n\nBoris算法是一种蛙跳时间积分格式。对于磁场项，它基于微分方程的一个二阶精度、时间中心的有限差分近似：\n$$ \\frac{\\mathbf{v}^{n+1/2} - \\mathbf{v}^{n-1/2}}{\\Delta t} = \\frac{q}{m} \\left( \\frac{\\mathbf{v}^{n+1/2} + \\mathbf{v}^{n-1/2}}{2} \\times \\mathbf{B}^n \\right) $$\n其中$\\mathbf{v}^{n\\pm1/2}$表示在时间$t^n \\pm \\Delta t/2$的速度。重新整理并使用$\\Omega_c$的定义：\n$$ \\mathbf{v}^{n+1/2} - \\mathbf{v}^{n-1/2} = \\frac{\\Omega_c \\Delta t}{2} \\left( (\\mathbf{v}^{n+1/2} + \\mathbf{v}^{n-1/2}) \\times \\hat{\\mathbf{z}} \\right) $$\n这个方程为$\\mathbf{v}^{n+1/2}$定义了一个隐式更新。Boris的洞见在于能够显式且高效地求解此方程以得到$\\mathbf{v}^{n+1/2}$。这种代数处理的结果是一个纯旋转。让我们定义$\\mathbf{v}^- = \\mathbf{v}^{n-1/2}$和$\\mathbf{v}^+ = \\mathbf{v}^{n+1/2}$。更新可以写成$\\mathbf{v}^+ = \\mathbf{R} \\mathbf{v}^-$，其中$\\mathbf{R}$是一个旋转矩阵。\n\n**稳定性分析：**\n对于$\\mathbf{E}=0$的情况，Boris推子精确地是对速度矢量的旋转。旋转是一种幺正变换，意味着它保持其作用的矢量的长度（范数）不变。因此：\n$$ |\\mathbf{v}^{n+1/2}| = |\\mathbf{v}^{n-1/2}| $$\n这对于时间步长$\\Delta t$的任何大小都成立。由于速度矢量的大小在每一步都精确守恒，动能$K = \\frac{1}{2}m|\\mathbf{v}|^2$也精确守恒。一个能够精确保持能量等运动守恒量的数值格式不会变得不稳定（即，它不会导致速度的非物理增长）。此性质对任何$\\Delta t > 0$都成立，因此在纯磁场中Boris方法是无条件稳定的。没有与$\\Omega_c$相关的CFL类型的稳定性约束作用于$\\Delta t$。\n\n**精度分析：**\n精确解是在一个时间步长$\\Delta t$内，$\\mathbf{v}_{\\perp}$旋转一个角度$\\theta_{\\text{exact}} = \\Omega_c \\Delta t$。\n可以证明，Boris算法通过一个数值确定的角度$\\theta_B$来旋转速度矢量。该角度由下式给出：\n$$ \\theta_B = 2 \\arctan\\left(\\frac{\\Omega_c \\Delta t}{2}\\right) $$\n为了使数值解精确，数值旋转角$\\theta_B$必须是精确物理角$\\theta_{\\text{exact}}$的良好近似。让我们使用泰勒级数展开来分析小宗量$x = \\frac{\\Omega_c \\Delta t}{2}$的差值：\n$$ \\arctan(x) = x - \\frac{x^3}{3} + \\mathcal{O}(x^5) $$\n将此代入$\\theta_B$的表达式中：\n$$ \\theta_B = 2 \\left( \\frac{\\Omega_c \\Delta t}{2} - \\frac{1}{3}\\left(\\frac{\\Omega_c \\Delta t}{2}\\right)^3 + \\dots \\right) = \\Omega_c \\Delta t - \\frac{(\\Omega_c \\Delta t)^3}{12} + \\mathcal{O}((\\Omega_c \\Delta t)^5) $$\n数值角和精确角之间的差异，即每步的局部相位误差，为：\n$$ \\Delta\\theta = \\theta_B - \\theta_{\\text{exact}} \\approx -\\frac{(\\Omega_c \\Delta t)^3}{12} $$\n相位的局部截断误差为$\\mathcal{O}((\\Omega_c \\Delta t)^3)$阶。为了精确跟踪相位，这个误差必须很小，这要求$\\Omega_c \\Delta t \\ll 1$。这是一个精度要求，而不是稳定性约束。\n\n在时间$T = N\\Delta t$之后的累积或全局相位误差是$N = T/\\Delta t$步的局部误差之和。全局误差的尺度为：\n$$ \\text{Global Error} \\approx N \\times \\Delta\\theta \\approx \\frac{T}{\\Delta t} \\times \\mathcal{O}((\\Omega_c \\Delta t)^3) = T \\Omega_c^3 \\mathcal{O}((\\Delta t)^2) = \\mathcal{O}((\\Omega_c \\Delta t)^2) $$\n这意味着该方法对于相位是二阶精度的。为了在多次回旋中保持精度，必须选择足够小的$\\Delta t$以使$\\Omega_c \\Delta t \\ll 1$。\n\n### 逐项分析选项\n\n**A. 在$\\mathbf{E}=\\mathbf{0}$的均匀磁场中，Boris推子对任意$\\Delta t$都能精确保持动能守恒，这意味着离散速度更新是线性稳定的，并且没有将$\\Delta t$与$\\Omega_c$关联的Courant–Friedrichs–Lewy (CFL) 约束。**\n如上所述，这种情况下的速度更新是一个纯旋转，这是一个保范数操作。这意味着$|\\mathbf{v}|$以及动能在任何$\\Delta t$值下都精确守恒。精确的能量守恒保证了解不会无界增长，因此该方法是稳定的。这种稳定性与$\\Delta t$无关，所以没有CFL类型的稳定性限制。这个陈述准确地描述了稳定性属性。\n**结论：正确**\n\n**B. 在均匀磁场中，Boris推子通过在垂直于$\\mathbf{B}$的平面上旋转一个角度来推进速度，该角度恰好为$\\theta = \\Omega_c \\Delta t$，因此对于任何$\\Delta t$都没有相位误差。**\n这个陈述是错误的。如精度分析中推导的，数值旋转角为$\\theta_B = 2 \\arctan(\\Omega_c \\Delta t / 2)$，对于任何$\\Delta t > 0$，它都不等于精确的物理角$\\theta_{\\text{exact}} = \\Omega_c \\Delta t$。对于$x>0$，不等式$\\arctan(x)  x$确保了总是存在相位误差，导致数值回旋滞后于物理回旋。\n**结论：错误**\n\n**C. 尽管Boris推子对任意$\\Delta t$都是稳定的，但要定量精确地解析回旋运动，需要$\\Delta t\\,\\Omega_c \\ll 1$，因为每步的相位误差尺度为$\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^3\\right)$，在多次回旋后产生的累积（全局）相位误差为$\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^2\\right)$。**\n这个陈述正确地总结了关键区别。第一部分，“对任意$\\Delta t$稳定”，是正确的。第二部分，“精度要求$\\Delta t\\,\\Omega_c \\ll 1$”，也是正确的。所提供的理由也恰好是推导出的结论：局部（每步）相位误差是$\\mathcal{O}((\\Omega_c \\Delta t)^3)$，而全局（累积）相位误差是$\\mathcal{O}((\\Omega_c \\Delta t)^2)$。这是该方法精度的教科书式描述。\n**结论：正确**\n\n**D. 为了保证显式稳定性，Boris推子要求$\\Delta t\\,\\Omega_c  2$，否则离散映射将变得不稳定，粒子速度会发散。**\n这个陈述是错误的。它声称存在一个有条件的稳定性限制，这与由精确能量守恒证明的无条件稳定性相矛盾。稳定性条件$\\Omega_c \\Delta t  2$很有名，但它适用于其他更简单的显式格式，例如应用于简谐振子方程（$y'' = -\\omega^2 y$）的标准蛙跳积分器，而不是具有更优越稳定性属性的Boris推子。Boris推子对所有$\\Delta t$都是稳定的。\n**结论：错误**\n\n**E. 在聚变相关场中，例如$B_0 = 5\\,\\mathrm{T}$下的氘核，选择$\\Delta t = \\dfrac{0.1}{\\Omega_c}$在保持动能守恒的同时，在回旋运动中不会产生相位误差，因此同时实现了稳定性和精确的精度。**\n这个陈述包含两个主张。第一个，“保持动能守恒”，对于Boris推子是正确的。第二个，“不产生相位误差”并实现“精确的精度”，是错误的。无量纲参数是$\\Omega_c \\Delta t = 0.1$。由于这个值不为零，所以存在一个有限的、尽管很小的相位误差。$B_0$的数值和粒子种类与此结论无关。选择$\\Omega_c \\Delta t = 0.1$是实现良好（但非精确）精度的实用选择，但该陈述关于“没有相位误差”的主张是错误的。\n**结论：错误**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "此最终练习将稳定性和精度的概念融合到一个动态的自适应算法中，这在现代科学计算中至关重要。您将推导并应用一个基于嵌入式Runge-Kutta方法的自适应时间步长控制器，该控制器能根据局部截断误差的估计值动态调整时间步长，以满足用户设定的精度容差 。同时，该控制器必须严格遵守由Courant–Friedrichs–Lewy (CFL) 条件设定的稳定性上限，这个练习完美展示了现代计算代码如何在精度、稳定性和计算效率之间进行智能权衡。",
            "id": "3977905",
            "problem": "在一个源于计算磁流体力学（MHD）的半离散双曲系统的显式时间积分中，考虑使用一个阶数为 $p$ 和 $p-1$ 的嵌入式龙格-库塔（RK）对来推进求解。该嵌入式对使用相同的阶段导数，在时间 $t_{n}+\\Delta t_{n}$ 产生两个近似解：一个高阶解 $y_{n+1}^{[p]}$ 和一个嵌入的低阶解 $y_{n+1}^{[p-1]}$，它们的差值用于估计局部截断误差。假设显式 RK 方法具有标准的渐近局部误差展开，并且误差估计量被归一化为一个无量纲标量 $\\text{err}_{n}$，该标量渐近正比于 $\\Delta t_{n}^{p+1}$。\n\n任务1：简要描述嵌入式 RK 对如何从单次阶段计算中构造局部误差估计。然后，从局部截断误差和时间步长之间的渐近关系出发，推导出一个步长控制器，该控制器根据 $\\Delta t_{n}$、用户容差 $\\text{tol}$、测量的标量误差 $\\text{err}_{n}$ 和方法阶数 $p$ 来更新 $\\Delta t_{n+1}$。包括一个安全因子 $s\\in(0,1)$。\n\n任务2：在一维（$1\\text{D}$）MHD中，流速为 $u$，声速为 $c_{s}$，阿尔芬波速为 $v_{A}$，对于场向对齐情况，快磁声速为 $c_{f}=\\sqrt{c_{s}^{2}+v_{A}^{2}}$，相对于网格的最大特征速度的一个保守上界是 $a_{\\max}=|u|+c_{f}$。对于间距为 $\\Delta x$ 的均匀网格，带有显式 RK 时间积分器的显式有限体积法必须满足形式为 $\\Delta t \\le \\nu_{\\max}\\,\\Delta x/a_{\\max}$ 的 Courant–Friedrichs–Lewy（CFL）条件以保证稳定性，其中 $\\nu_{\\max}\\in(0,1)$ 是一个预设的库朗数界限，与所选时空离散化的线性稳定区域一致。\n\n将任务1中得到的控制器与 CFL 稳定性极限施加的硬上限相结合，得出一个 $\\Delta t_{n+1}$ 的单一更新公式，该公式选择基于误差的建议值和 CFL 上限中的较小者。然后，使用以下参数数值计算 $\\Delta t_{n+1}$：\n- 接受解的嵌入式对阶数：$p=5$。\n- 安全因子：$s=0.9$。\n- 当前步长：$\\Delta t_{n}=1.2\\times 10^{-8}\\ \\text{s}$。\n- 用户容差：$\\text{tol}=1.0\\times 10^{-5}$。\n- 测量的标量误差：$\\text{err}_{n}=2.5\\times 10^{-4}$。\n- 网格间距：$\\Delta x=5.2\\times 10^{-3}\\ \\text{m}$。\n- 流速大小：$|u|=1.0\\times 10^{5}\\ \\text{m}\\,\\text{s}^{-1}$。\n- 声速：$c_{s}=1.5\\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}$。\n- 阿尔芬波速：$v_{A}=2.0\\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}$。\n- 库朗数界限：$\\nu_{\\max}=0.8$。\n\n将您的最终答案表示为 $\\Delta t_{n+1}$ 的单个数值（以秒为单位），并四舍五入到三位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上是合理的，提法恰当，没有矛盾或含糊之处，其基础是计算物理中偏微分方程数值方法的既定原则。因此，下面给出完整解法。\n\n该问题分为两个任务。第一个任务是描述嵌入式龙格-库塔（RK）对的误差估计机制并推导自适应步长控制器。第二个任务是将此控制器与 Courant–Friedrichs–Lewy（CFL）稳定性约束相结合并进行数值计算。\n\n**任务1：误差估计和步长控制器推导**\n\n一个嵌入式龙格-库塔对由两个阶数分别为 $p$ 和 $p-1$ 的显式 RK 方法组成。其定义性特征是两种方法都利用同一组阶段导数（函数求值）将解从时间 $t_n$ 推进一个步长 $\\Delta t_n$。这在时间 $t_{n+1} = t_n + \\Delta t_n$ 产生两个不同的近似解：一个高阶解 $y_{n+1}^{[p]}$ 和一个低阶嵌入解 $y_{n+1}^{[p-1]}$。这两个近似解之间的差值 $E_{n+1} = y_{n+1}^{[p]} - y_{n+1}^{[p-1]}$，可作为局部截断误差（LTE）的估计。通常，这个差值是低阶方法的 LTE 的估计，其阶数为 $p$。然而，问题陈述指明，一个归一化的标量误差度量 $\\text{err}_n$ 渐近正比于 $\\Delta t_{n}^{p+1}$。这表明被控制的误差是高阶方法的 LTE。我们基于这一给定的前提进行推导。\n\n在第 $n$ 步的估计误差 $\\text{err}_n$ 与步长 $\\Delta t_n$ 之间的渐近关系如下：\n$$\n\\text{err}_{n} \\approx C \\Delta t_{n}^{p+1}\n$$\n其中 $C$ 是一个常数，它依赖于解的高阶导数，但假定在连续的时间步长内近似为常数。\n\n自适应步长控制器的目标是选择下一个时间步长 $\\Delta t_{n+1}$，使得该步的预测误差 $\\text{err}_{n+1}$ 满足预设的用户容差 $\\text{tol}$。因此我们设定目标：\n$$\n\\text{tol} \\approx C \\Delta t_{n+1}^{p+1}\n$$\n\n为了找到新的步长 $\\Delta t_{n+1}$，我们可以通过对前面两个表达式取比值来消去未知常数 $C$：\n$$\n\\frac{\\text{tol}}{\\text{err}_{n}} \\approx \\frac{C \\Delta t_{n+1}^{p+1}}{C \\Delta t_{n}^{p+1}} = \\left(\\frac{\\Delta t_{n+1}}{\\Delta t_{n}}\\right)^{p+1}\n$$\n求解 $\\Delta t_{n+1}$ 得到最优步长估计：\n$$\n\\Delta t_{n+1} \\approx \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}}\n$$\n为了创建一个更鲁棒的控制器，避免过于乐观的步长增加并减少被拒绝步长的频率，引入了一个安全因子 $s \\in (0,1)$。由误差控制器提出的步长（我们记为 $\\Delta t_{\\text{err}}$）的最终公式是：\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}}\n$$\n\n**任务2：组合控制器和数值计算**\n\n对于应用于双曲系统的显式时间积分方案，时间步长必须满足 CFL 条件以确保数值稳定性。问题给出的该条件为 $\\Delta t \\le \\nu_{\\max}\\,\\Delta x/a_{\\max}$，其中 $a_{\\max}$ 是最大特征速度。这给步长施加了一个硬性上限 $\\Delta t_{\\text{CFL}} = \\nu_{\\max}\\,\\Delta x/a_{\\max}$，该上限与精度考虑无关。\n\n最终的时间步长 $\\Delta t_{n+1}$ 必须同时满足精度要求（使误差低于 $\\text{tol}$）和稳定性要求。因此，新的步长选择为误差控制器建议值和 CFL 稳定性极限中的较小者：\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text{err}}, \\Delta t_{\\text{CFL}})\n$$\n\n现在我们使用给定的数值参数来计算这个表达式。\n首先，我们计算 CFL 时间步长限制 $\\Delta t_{\\text{CFL}}$。这需要最大特征速度 $a_{\\max}$。\n快磁声速 $c_f$ 为：\n$$\nc_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}} = \\sqrt{(1.5 \\times 10^{6})^{2} + (2.0 \\times 10^{6})^{2}} = \\sqrt{2.25 \\times 10^{12} + 4.0 \\times 10^{12}} = \\sqrt{6.25 \\times 10^{12}} = 2.5 \\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}\n$$\n相对于网格的最大特征速度为：\n$$\na_{\\max} = |u| + c_{f} = 1.0 \\times 10^{5} + 2.5 \\times 10^{6} = 2.6 \\times 10^{6}\\ \\text{m}\\,\\text{s}^{-1}\n$$\n现在，我们可以计算 CFL 步长限制：\n$$\n\\Delta t_{\\text{CFL}} = \\nu_{\\max} \\frac{\\Delta x}{a_{\\max}} = 0.8 \\times \\frac{5.2 \\times 10^{-3}}{2.6 \\times 10^{6}} = 0.8 \\times (2.0 \\times 10^{-9}) = 1.6 \\times 10^{-9}\\ \\text{s}\n$$\n接下来，我们计算误差控制器建议的步长 $\\Delta t_{\\text{err}}$。参数为 $p=5$, $s=0.9$, $\\Delta t_n = 1.2 \\times 10^{-8}$, $\\text{tol}=1.0 \\times 10^{-5}$ 和 $\\text{err}_n = 2.5 \\times 10^{-4}$。控制器中的指数为 $\\frac{1}{p+1} = \\frac{1}{5+1} = \\frac{1}{6}$。\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}} = 0.9 \\cdot (1.2 \\times 10^{-8}) \\left(\\frac{1.0 \\times 10^{-5}}{2.5 \\times 10^{-4}}\\right)^{\\frac{1}{6}}\n$$\n$$\n\\Delta t_{\\text{err}} = 1.08 \\times 10^{-8} \\left(\\frac{1}{25}\\right)^{\\frac{1}{6}} = 1.08 \\times 10^{-8} \\left(0.04\\right)^{\\frac{1}{6}}\n$$\n$$\n\\Delta t_{\\text{err}} \\approx 1.08 \\times 10^{-8} \\times 0.573539 \\approx 6.1942 \\times 10^{-9}\\ \\text{s}\n$$\n最后，我们通过取两个计算值的最小值来选择新的步长 $\\Delta t_{n+1}$：\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text{err}}, \\Delta t_{\\text{CFL}}) = \\min(6.1942 \\times 10^{-9}\\ \\text{s}, 1.6 \\times 10^{-9}\\ \\text{s}) = 1.6 \\times 10^{-9}\\ \\text{s}\n$$\n在这种情况下，时间步长受到 CFL 稳定性条件的限制，而不是精度要求的限制。问题要求将最终答案四舍五入到三位有效数字。\n$$\n\\Delta t_{n+1} = 1.60 \\times 10^{-9}\\ \\text{s}\n$$",
            "answer": "$$\n\\boxed{1.60 \\times 10^{-9}}\n$$"
        }
    ]
}