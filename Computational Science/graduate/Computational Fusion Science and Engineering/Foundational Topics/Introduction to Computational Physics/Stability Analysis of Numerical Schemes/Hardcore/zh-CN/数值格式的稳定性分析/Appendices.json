{
    "hands_on_practices": [
        {
            "introduction": "我们从一个冯·诺依曼稳定性分析的基本应用开始，将其应用于Lax-Friedrichs格式。这项实践将指导你推导放大因子并建立著名的Courant-Friedrichs-Lewy (CFL)条件。这是一个基石性的概念，它将物理信息传播的速度与数值网格的速度联系起来，决定了许多求解双曲型方程的显式格式的稳定性。",
            "id": "4047698",
            "problem": "在计算聚变科学与工程中，沿磁场线的平行对流输运的简化一维模型常被用于研究离散格式的数值稳定性，之后再将这些格式集成到多物理场求解器中。考虑线性平流方程\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\n其中 $u(x,t)$ 表示一个被输运的标量（例如，边缘等离子体密度的被动示踪剂），$a$ 是一个恒定的平流速度，且空间域是周期性的。在间距为 $\\Delta x$ 的均匀网格上对 $x$ 进行离散，并以均匀步长 $\\Delta t$ 对时间进行离散化，然后用 Lax–Friedrichs 格式来近似求解\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\n其中 $j$ 是空间索引，$n$ 是时间索引，而 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 是与 Courant–Friedrichs–Lewy (CFL) 条件相关的 Courant 数。\n\n使用 Von Neumann 稳定性分析方法，并代入傅里葉模式 $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)$，推导上述格式的放大因子 $G(\\theta)$ 以及相关的稳定性条件 $|G(\\theta)| \\le 1$。由此，得出确保对所有实数 $\\theta$ 都稳定的 CFL 条件对 $\\nu$ 的限制。请将你的最终答案表示为保证所有傅里葉模式都稳定的 $|\\nu|$ 的最大允许值。无需四舍五入。最终答案是无量纲的；不要包含单位。",
            "solution": "该问题被验证为具有科学依据、提法恰当、客观，并包含获得唯一解所需的所有信息。这是偏微分方程数值方法稳定性分析中的一个标准问题。\n\n任务是 对线性平流方程的 Lax–Friedrichs 格式进行 Von Neumann 稳定性分析。该格式如下：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n其中 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 是 Courant 数。\n\nVon Neumann 分析通过将单个傅里叶模式代入差分方程来进行。一个通解可以表示为这些模式的叠加。如果每个模式随时间衰减或保持有界，则数值格式是稳定的。我们考虑一个单一的傅里叶模式，形式如下：\n$$\nu_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)\n$$\n其中 $\\hat{u}^{n}$ 是时间步 $n$ 处模式的振幅，$j$ 是空间网格索引，$\\theta = k \\Delta x$ 是无量纲波数或相位角，其中 $k$ 是波数，$\\Delta x$ 是网格间距。\n\n放大因子 $G(\\theta)$ 由关系式 $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^{n}$ 定义。因此，我们有 $u_j^{n+1} = G(\\theta) \\hat{u}^{n} \\exp(i \\theta j)$。格式中的其他项可以表示为：\n$$\nu_{j+1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j+1)) = \\hat{u}^{n} \\exp(i \\theta j) \\exp(i \\theta)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j-1)) = \\hat{u}^{n} \\exp(i \\theta j) \\exp(-i \\theta)\n$$\n将这些表达式代入 Lax–Friedrichs 格式得到：\n$$\nG(\\theta) \\hat{u}^{n} \\exp(i \\theta j) = \\frac{1}{2}\\left(\\hat{u}^{n} \\exp(i \\theta j) \\exp(i \\theta) + \\hat{u}^{n} \\exp(i \\theta j) \\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\hat{u}^{n} \\exp(i \\theta j) \\exp(i \\theta) - \\hat{u}^{n} \\exp(i \\theta j) \\exp(-i \\theta)\\right)\n$$\n公因子 $\\hat{u}^{n} \\exp(i \\theta j)$ 非零，可以从等式两边消去，从而分離出放大因子 $G(\\theta)$：\n$$\nG(\\theta) = \\frac{1}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\n使用 Euler 恒等式 $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$ 和 $\\sin(\\theta) = \\frac{\\exp(i \\theta) - \\exp(-i \\theta)}{2i}$，我们可以简化 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = \\cos(\\theta) - \\frac{\\nu}{2} (2i \\sin(\\theta))\n$$\n$$\nG(\\theta) = \\cos(\\theta) - i \\nu \\sin(\\theta)\n$$\n为使数值格式稳定，对于相位角 $\\theta$ 的任何可能值，放大因子的模都不能超过 1。这就是 Von Neumann 稳定性条件：\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in \\mathbb{R}\n$$\n我们计算 $G(\\theta)$ 模的平方，$G(\\theta)$ 是一个复数，其实部为 $\\cos(\\theta)$，虚部为 $-\\nu \\sin(\\theta)$：\n$$\n|G(\\theta)|^2 = (\\text{Re}[G(\\theta)])^2 + (\\text{Im}[G(\\theta)])^2\n$$\n$$\n|G(\\theta)|^2 = (\\cos(\\theta))^2 + (-\\nu \\sin(\\theta))^2 = \\cos^2(\\theta) + \\nu^2 \\sin^2(\\theta)\n$$\n因此，稳定性条件变为：\n$$\n\\cos^2(\\theta) + \\nu^2 \\sin^2(\\theta) \\le 1\n$$\n这个不等式必须对所有实数值 $\\theta$ 都成立。为了找到对 $\\nu$ 最严格的限制条件，我们可以使用三角恒等式 $\\cos^2(\\theta) = 1 - \\sin^2(\\theta)$ 来重排不等式：\n$$\n(1 - \\sin^2(\\theta)) + \\nu^2 \\sin^2(\\theta) \\le 1\n$$\n$$\n1 + (\\nu^2 - 1) \\sin^2(\\theta) \\le 1\n$$\n两边减 1 得：\n$$\n(\\nu^2 - 1) \\sin^2(\\theta) \\le 0\n$$\n由于对所有实数 $\\theta$，$\\sin^2(\\theta) \\ge 0$ 恒成立，因此只有当系数 $(\\nu^2 - 1)$ 非正时，才能保证该不等式对所有 $\\theta$ 都成立。如果 $(\\nu^2 - 1)  0$，我们可以选择一个使 $\\sin^2(\\theta)  0$ 的 $\\theta$（例如 $\\theta = \\frac{\\pi}{2}$），这将违反不等式。\n因此，我们必须施加条件：\n$$\n\\nu^2 - 1 \\le 0\n$$\n这可以简化为：\n$$\n\\nu^2 \\le 1\n$$\n对两边取平方根，我们得到关于 Courant 数 $\\nu$ 的稳定性判据：\n$$\n|\\nu| \\le 1\n$$\n这就是应用于线性平流方程的 Lax–Friedrichs 格式的 Courant–Friedrichs–Lewy (CFL) 条件。问题要求保证所有傅里叶模式都稳定的 $|\\nu|$ 的最大允许值。根据推导出的不等式 $|\\nu| \\le 1$，这个最大值是 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "并非所有直观的数值格式都是可行的，本练习提供了一个经典的警示案例。通过分析时间前向-空间中心 (FTCS) 差分格式，你将发现一个与偏微分方程相容的格式如何会变得无条件不稳定。这突显了Lax-Richtmyer等价定理的深刻内涵，该定理指出对于一个相容的格式，稳定性和收敛性是等价的。",
            "id": "4047683",
            "problem": "在磁约束聚变等离子体中，模拟沿磁力线的无源标量微扰的平行对流输运时，标量振幅 $u(x,t)$ 由一维线性平流方程 $u_{t} + a\\,u_{x} = 0$ 在周期性区域 $x \\in [0,L]$ 上控制，其中 $a \\neq 0$ 是一个常数平行平流速度，$L  0$ 是周期长度。考虑一个空间步长为 $\\Delta x  0$、时间步长为 $\\Delta t  0$ 的均匀网格，并定义库朗数 $\\nu = a\\,\\Delta t/\\Delta x$。\n\n您需要分析该问题的时间前向-空间中心 (FTCS) 差分格式，该格式在上述均匀网格上使用时间上的前向差分和空间上的中心差分。假设所有离散时间下都采用周期性边界条件，以便应用空间傅里叶分析。按以下步骤进行：\n\n- 在均匀网格上写出 $u_{t} + a\\,u_{x} = 0$ 的 FTCS 离散格式，并利用在 $t$ 和 $x$ 上的泰勒展开，验证该格式与偏微分方程是相容的，即其局部截断误差在 $\\Delta t \\to 0$ 和 $\\Delta x \\to 0$ 时趋于零。\n- 通过代入形式为 $u^{n}_{j} = \\hat{u}^{n}\\exp(\\mathrm{i} j \\theta)$ 的离散傅里叶模，进行 von Neumann (傅里叶) 稳定性分析，其中 $j$ 索引空间网格点，$n$ 索引时间层，$\\theta \\in [-\\pi,\\pi]$ 是以弧度为单位的相角，且 $\\mathrm{i} = \\sqrt{-1}$。推导由 $\\hat{u}^{n+1} = G(\\theta,\\nu)\\,\\hat{u}^{n}$ 定义的复放大因子 $G(\\theta,\\nu)$。\n- 以 $\\nu$ 的函数形式，计算放大因子在所有相角上的最大模 $\\rho(\\nu) = \\max_{\\theta \\in [-\\pi,\\pi]} |G(\\theta,\\nu)|$ 的闭合形式解。\n\n最后，利用针对线性初值问题的 Lax–Richtmyer 等价定理，简要论证为何这个相容格式对于具有周期性边界条件的平流方程不收敛。\n\n答案规格：请提供 $\\rho(\\nu)$ 的精确解析表达式作为最终答案，不带单位。无需进行数值四舍五入。最终表达式必须完全简化。",
            "solution": "该问题陈述是偏微分方程有限差分方法分析中的一个标准练习。它有科学依据、适定、客观且自洽。因此，该问题有效，下面提供完整解答。\n\n一维线性平流方程由下式给出：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $u(x,t)$ 是标量振幅，$a \\neq 0$ 是常数平流速度，并且问题在周期性区域 $x \\in [0,L]$ 上考虑。我们使用一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格。网格点记为 $x_j = j\\Delta x$ 和 $t_n = n\\Delta t$，在这些点上的数值解为 $u^n_j \\approx u(x_j, t_n)$。\n\n首先，我们建立时间前向-空间中心 (FTCS) 离散格式并验证其相容性。\n时间导数 $u_t$ 用前向差分近似：\n$$\nu_t \\approx \\frac{u^{n+1}_j - u^n_j}{\\Delta t}\n$$\n空间导数 $u_x$ 用中心差分近似：\n$$\nu_x \\approx \\frac{u^n_{j+1} - u^n_{j-1}}{2\\Delta x}\n$$\n将这些近似代入偏微分方程 (PDE)，得到 FTCS 格式：\n$$\n\\frac{u^{n+1}_j - u^n_j}{\\Delta t} + a \\frac{u^n_{j+1} - u^n_{j-1}}{2\\Delta x} = 0\n$$\n对 $u^{n+1}_j$ 求解，我们得到显式更新规则：\n$$\nu^{n+1}_j = u^n_j - \\frac{a\\Delta t}{2\\Delta x} (u^n_{j+1} - u^n_{j-1})\n$$\n使用库朗数的定义 $\\nu = a\\Delta t/\\Delta x$，该格式可写为：\n$$\nu^{n+1}_j = u^n_j - \\frac{\\nu}{2} (u^n_{j+1} - u^n_{j-1})\n$$\n为验证相容性，我们确定局部截断误差 (LTE)，它是通过将精确解 $u(x,t)$ 代入有限差分算子得到的。LTE 记为 $\\tau$，为：\n$$\n\\tau = \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} + a \\frac{u(x_j+\\Delta x, t_n) - u(x_j-\\Delta x, t_n)}{2\\Delta x}\n$$\n我们对每一项在点 $(x_j, t_n)$ 附近进行泰勒级数展开，将 $u(x_j, t_n)$ 及其在该点的偏导数记为 $u, u_t, u_x, u_{tt}, u_{xx}$ 等。\n$$\nu(x_j, t_n+\\Delta t) = u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O((\\Delta t)^3)\n$$\n$$\nu(x_j+\\Delta x, t_n) = u + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4)\n$$\n$$\nu(x_j-\\Delta x, t_n) = u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4)\n$$\n将这些展开式代入 $\\tau$ 的表达式中：\n$$\n\\tau = \\frac{(u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots) - u}{\\Delta t} + a \\frac{(u + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots) - (u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\dots)}{2\\Delta x}\n$$\n$$\n\\tau = \\left(u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots\\right) + a \\frac{2\\Delta x u_x + \\frac{(\\Delta x)^3}{3} u_{xxx} + \\dots}{2\\Delta x}\n$$\n$$\n\\tau = \\left(u_t + a u_x\\right) + \\frac{\\Delta t}{2} u_{tt} + a \\frac{(\\Delta x)^2}{6} u_{xxx} + O((\\Delta t)^2, (\\Delta x)^4)\n$$\n由于 $u(x,t)$ 是 PDE 的精确解，我们有 $u_t + a u_x = 0$。因此，LTE 为：\n$$\n\\tau = \\frac{\\Delta t}{2} u_{tt} + a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\n从原始 PDE 中，我们可以找到导数之间的关系。将 $u_t = -a u_x$ 对 $t$ 求导得到 $u_{tt} = -a u_{xt} = -a (u_t)_x = -a(-a u_x)_x = a^2 u_{xx}$。因此，误差的主项不为零。LTE 的阶为 $O(\\Delta t, (\\Delta x)^2)$。当 $\\Delta t \\to 0$ 和 $\\Delta x \\to 0$ 时，LTE 趋于零，这证实了该格式与 PDE 是相容的。\n\n接下来，我们进行 von Neumann 稳定性分析。我们将单个傅里叶模 $u^n_j = \\hat{u}^n \\exp(\\mathrm{i} j \\theta)$ 代入 FTCS 格式，其中 $\\hat{u}^n$ 是在时间层 $n$ 的模的振幅，$j$ 是空间网格索引，$\\theta = k_x \\Delta x$ 是与空间波数 $k_x$ 相关的相角。\n$$\n\\hat{u}^{n+1} \\exp(\\mathrm{i}j\\theta) = \\hat{u}^n \\exp(\\mathrm{i}j\\theta) - \\frac{\\nu}{2} \\left( \\hat{u}^n \\exp(\\mathrm{i}(j+1)\\theta) - \\hat{u}^n \\exp(\\mathrm{i}(j-1)\\theta) \\right)\n$$\n用 $\\hat{u}^n \\exp(\\mathrm{i}j\\theta)$ 除（假设 $\\hat{u}^n \\neq 0$）：\n$$\n\\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - \\frac{\\nu}{2} \\left( \\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta) \\right)\n$$\n比值 $\\hat{u}^{n+1}/\\hat{u}^n$ 是复放大因子 $G(\\theta,\\nu)$。使用欧拉公式 $\\sin\\theta = (\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta))/(2\\mathrm{i})$，该表达式简化为：\n$$\nG(\\theta,\\nu) = 1 - \\frac{\\nu}{2} (2\\mathrm{i}\\sin\\theta) = 1 - \\mathrm{i}\\nu\\sin\\theta\n$$\n这是应用于线性平流方程的 FTCS 格式的复放大因子。\n\n现在，我们计算放大因子的最大模，$\\rho(\\nu) = \\max_{\\theta \\in [-\\pi,\\pi]} |G(\\theta,\\nu)|$。$G(\\theta,\\nu)$ 的模是一个复数 $z = x + \\mathrm{i}y$ 的模，其中 $x=1$，$y=-\\nu\\sin\\theta$。\n$$\n|G(\\theta,\\nu)| = \\sqrt{1^2 + (-\\nu\\sin\\theta)^2} = \\sqrt{1 + \\nu^2\\sin^2\\theta}\n$$\n为了找到最大模，我们必须对 $\\theta \\in [-\\pi,\\pi]$ 最大化此表达式。$\\nu^2$ 的值是非负的。函数 $\\sin^2\\theta$ 的范围是从 $0$ 到 $1$。$|G(\\theta,\\nu)|$ 的最大值在 $\\sin^2\\theta$ 取最大值时出现，即 $\\sin^2\\theta = 1$。这在 $\\theta = \\pm \\pi/2$ 时发生。\n因此，最大模 $\\rho(\\nu)$ 为：\n$$\n\\rho(\\nu) = \\max_{\\theta \\in [-\\pi,\\pi]} \\sqrt{1 + \\nu^2\\sin^2\\theta} = \\sqrt{1 + \\nu^2(1)} = \\sqrt{1 + \\nu^2}\n$$\n\n最后，我们使用 Lax–Richtmyer 等价定理来论证该格式的不收敛性。该定理指出，对于一个线性初值问题，一个相容的有限差分格式是收敛的，当且仅当它是稳定的。\n我们已经证明了 FTCS 格式与平流方程是相容的。\nvon Neumann 稳定性条件要求，对于所有可能的相角 $\\theta$，放大因子的模必须小于或等于 $1$，即 $|G(\\theta,\\nu)| \\le 1$。\n根据我们的分析，有 $|G(\\theta,\\nu)| = \\sqrt{1 + \\nu^2\\sin^2\\theta}$。稳定性条件变为：\n$$\n\\sqrt{1 + \\nu^2\\sin^2\\theta} \\le 1\n$$\n两边平方得到 $1 + \\nu^2\\sin^2\\theta \\le 1$，简化为 $\\nu^2\\sin^2\\theta \\le 0$。由于 $\\nu^2 \\ge 0$ 且 $\\sin^2\\theta \\ge 0$，这个不等式仅当 $\\nu^2\\sin^2\\theta = 0$ 时才能满足。\n问题陈述中说明 $a \\neq 0$，并且对于任何非平凡的离散化，$\\Delta t  0$ 且 $\\Delta x  0$，所以库朗数 $\\nu = a\\Delta t/\\Delta x \\neq 0$。因此 $\\nu^2  0$。条件 $\\nu^2\\sin^2\\theta \\le 0$ 仅在 $\\sin\\theta = 0$ 时成立，这对应于 $\\theta=0, \\pm\\pi$ 的模式。对于任何其他 $\\sin\\theta \\neq 0$ 的模式，我们有 $\\nu^2\\sin^2\\theta  0$，因此 $|G(\\theta,\\nu)| = \\sqrt{1 + \\nu^2\\sin^2\\theta}  1$。\n对于任何 $\\sin\\theta \\neq 0$ 的模式，该格式都是数值不稳定的，无论 $\\Delta t$ 和 $\\Delta x$ 如何选择（只要 $\\nu \\neq 0$）。因此，FTCS 格式对于线性平流方程是无条件不稳定的。\n由于该格式是相容的但不稳定，Lax–Richtmyer 等价定理意味着该格式不收敛。",
            "answer": "$$\\boxed{\\sqrt{1 + \\nu^2}}$$"
        },
        {
            "introduction": "聚变等离子体常常表现出多尺度现象，其中不同的物理过程在迥异的时间尺度上运作，导致刚性系统，这对数值模拟提出了巨大挑战。本问题介绍了一种强大的隐式-显式 (IMEX) 方法，这是一种实用的策略，其中刚性项（如扩散）被隐式处理以保证稳定性，而非刚性项（如对流）则被显式处理以提高效率。通过此分析，你将推导出一个能够克服纯显式方法在处理扩散问题时所面临的严格时间步长限制的稳定性条件。",
            "id": "4047673",
            "problem": "考虑周期性域上的一维对流-扩散偏微分方程 (PDE) $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$，其中 $a$ 是恒定的对流速度，$\\nu$ 是恒定的扩散系数。在计算聚变科学与工程中，该方程可以表示一个简化输运模型，用于描述被动标量被平均流对流输运并跨磁力线扩散。构建一个空间间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀空间网格，并令 $u_{j}^{n}$ 表示在网格点 $x_{j}$ 和时间 $t^{n}$ 处 $u(x_{j}, t^{n})$ 的近似值。建立一个隐式-显式 (IMEX) 格式，其中对流项在时间上进行显式处理，扩散项在时间上进行隐式处理，而两个空间导数均采用二阶中心有限差分进行近似。假设采用周期性边界条件，以便应用傅里叶模态分析。使用 von Neumann 线性稳定性分析，推导该格式对所有空间傅里叶模态保持线性稳定的条件，然后推导出最大稳定时间步长，表示为仅含 $\\nu$、$a$ 和任何必要网格参数的单个闭式解析表达式。最终时间步长以秒为单位表示。仅提供最大允许 $\\Delta t$ 的表达式作为最终答案。",
            "solution": "所述问题具有科学依据、是适定的、客观的且内部一致。它构成了偏微分方程数值分析领域中一个标准的、可解的问题。因此，该问题被认为是有效的。我们着手进行求解。\n\n一维对流-扩散方程由下式给出：\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx}\n$$\n其中 $u(x,t)$ 是所关注的量，$a$ 是恒定的对流速度，$\\nu$ 是恒定的扩散系数。\n\n该问题指定了在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上的一个数值格式。令 $u_{j}^{n}$ 表示 $u(x_j, t^n)$ 的数值近似，其中 $x_j = j\\Delta x$ 且 $t^n = n\\Delta t$。指定的隐式-显式 (IMEX) 格式对对流项进行显式处理，对扩散项进行隐式处理。空间导数使用二阶中心有限差分进行近似。时间导数用向前差分近似。得到的有限差分方程为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\left( \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\Delta x} \\right) = \\nu \\left( \\frac{u_{j+1}^{n+1} - 2u_{j}^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n为了进行 von Neumann 稳定性分析，我们假设一个形式如下的单傅里叶模态解：\n$$\nu_{j}^{n} = G(k)^{n} \\exp(i k x_j) = G^{n} e^{i k j \\Delta x}\n$$\n其中 $k$ 是波数，$i = \\sqrt{-1}$，$G(k)$ 是该模态的放大因子。该格式稳定的充分必要条件是，对于所有相关的波数 $k$，都有 $|G(k)| \\le 1$。\n\n将此假设形式代入有限差分方程，需要用到移位网格点和下一时间步的表达式：\n$$\nu_{j\\pm1}^{n} = G^{n} e^{i k (j\\pm1) \\Delta x} = u_{j}^{n} e^{\\pm i k \\Delta x}\n$$\n$$\nu_{j}^{n+1} = G u_{j}^{n}\n$$\n$$\nu_{j\\pm1}^{n+1} = G u_{j}^{n} e^{\\pm i k \\Delta x}\n$$\n将这些代入格式中：\n$$\n\\frac{G u_{j}^{n} - u_{j}^{n}}{\\Delta t} + a \\left( \\frac{u_{j}^{n} e^{i k \\Delta x} - u_{j}^{n} e^{-i k \\Delta x}}{2\\Delta x} \\right) = \\nu \\left( \\frac{G u_{j}^{n} e^{i k \\Delta x} - 2G u_{j}^{n} + G u_{j}^{n} e^{-i k \\Delta x}}{(\\Delta x)^2} \\right)\n$$\n除以公因子 $u_{j}^{n}$ (非零)，得到一个关于 $G$ 的方程：\n$$\n\\frac{G-1}{\\Delta t} + \\frac{a}{2\\Delta x} (e^{i k \\Delta x} - e^{-i k \\Delta x}) = \\frac{\\nu G}{(\\Delta x)^2} (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x})\n$$\n使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$ 和 $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos(\\theta) - 2 = -4\\sin^2(\\theta/2)$，其中 $\\theta = k\\Delta x$，我们得到：\n$$\n\\frac{G-1}{\\Delta t} + \\frac{a}{2\\Delta x} (2i\\sin(k\\Delta x)) = \\frac{\\nu G}{(\\Delta x)^2} (-4\\sin^2(k\\Delta x/2))\n$$\n我们定义库朗数 $C = \\frac{a \\Delta t}{\\Delta x}$ 和扩散数 $d = \\frac{\\nu \\Delta t}{(\\Delta x)^2}$。方程变为：\n$$\nG-1 + i C \\sin(k\\Delta x) = -4d G \\sin^2(k\\Delta x/2)\n$$\n现在，我们求解放大因子 $G$：\n$$\nG (1 + 4d \\sin^2(k\\Delta x/2)) = 1 - i C \\sin(k\\Delta x)\n$$\n$$\nG = \\frac{1 - i C \\sin(k\\Delta x)}{1 + 4d \\sin^2(k\\Delta x/2)}\n$$\n稳定性条件是 $|G| \\le 1$，这等价于 $|G|^2 \\le 1$。\n$$\n|G|^2 = \\frac{|1 - i C \\sin(k\\Delta x)|^2}{|1 + 4d \\sin^2(k\\Delta x/2)|^2} = \\frac{1^2 + (C \\sin(k\\Delta x))^2}{(1 + 4d \\sin^2(k\\Delta x/2))^2} \\le 1\n$$\n这给出了不等式：\n$$\n1 + C^2 \\sin^2(k\\Delta x) \\le \\left(1 + 4d \\sin^2(k\\Delta x/2)\\right)^2\n$$\n$$\n1 + C^2 \\sin^2(k\\Delta x) \\le 1 + 8d \\sin^2(k\\Delta x/2) + 16d^2 \\sin^4(k\\Delta x/2)\n$$\n$$\nC^2 \\sin^2(k\\Delta x) \\le 8d \\sin^2(k\\Delta x/2) + 16d^2 \\sin^4(k\\Delta x/2)\n$$\n使用二倍角恒等式 $\\sin(k\\Delta x) = 2\\sin(k\\Delta x/2)\\cos(k\\Delta x/2)$，我们可以将 $\\sin^2(k\\Delta x)$ 写为 $4\\sin^2(k\\Delta x/2)\\cos^2(k\\Delta x/2)$。令 $S = \\sin^2(k\\Delta x/2)$。同时，$\\cos^2(k\\Delta x/2) = 1-S$。不等式变为：\n$$\nC^2 (4S(1-S)) \\le 8dS + 16d^2 S^2\n$$\n对于非零波数，$S  0$，所以我们可以除以 $4S$：\n$$\nC^2 (1-S) \\le 2d + 4d^2 S\n$$\n重新整理各项，将常数项与依赖于 $S$ 的项分开：\n$$\nC^2 - 2d \\le C^2 S + 4d^2 S = (C^2 + 4d^2)S\n$$\n这个不等式必须对所有可能的空间模态都成立，这意味着它必须对 $S = \\sin^2(k\\Delta x/2)$ 的所有可能值都成立。在离散网格上，波数的范围对应于 $S \\in [0, 1]$。令 $f(S) = (C^2 + 4d^2)S - (C^2 - 2d)$。我们需要对于所有 $S \\in [0, 1]$ 都有 $f(S) \\ge 0$。\n函数 $f(S)$ 是关于 $S$ 的线性函数。其斜率 $(C^2 + 4d^2)$ 是非负的。因此，$f(S)$ 是一个关于 $S$ 的非减函数。$f(S)$ 在区间 $[0, 1]$ 上的最小值在 $S=0$ 处取得。为确保在整个区间上 $f(S) \\ge 0$，我们必须满足其最小值处的条件：\n$$\nf(0) \\ge 0\n$$\n$$\n(C^2 + 4d^2)(0) - (C^2 - 2d) \\ge 0\n$$\n$$\n-(C^2 - 2d) \\ge 0\n$$\n$$\n2d - C^2 \\ge 0 \\implies C^2 \\le 2d\n$$\n这就是该 IMEX 格式的一般稳定性条件。现在我们将 $C$ 和 $d$ 的定义代回到这个不等式中，以求出对时间步长 $\\Delta t$ 的约束：\n$$\n\\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2 \\le 2\\left(\\frac{\\nu \\Delta t}{(\\Delta x)^2}\\right)\n$$\n$$\n\\frac{a^2 (\\Delta t)^2}{(\\Delta x)^2} \\le \\frac{2\\nu \\Delta t}{(\\Delta x)^2}\n$$\n假设 $\\Delta t  0$ 且 $a \\ne 0$，我们可以将两边同乘以 $\\frac{(\\Delta x)^2}{a^2 \\Delta t}$ 来解出 $\\Delta t$：\n$$\n\\Delta t \\le \\frac{2\\nu}{a^2}\n$$\n这就给出了为使该格式对所有傅里叶模态保持线性稳定所允许的最大时间步长。这个结果值得注意，因为它与空间网格间距 $\\Delta x$ 无关。该表达式的单位是 $(\\text{长度}^2/\\text{时间}) / (\\text{长度}/\\text{时间})^2 = \\text{时间}$，符合要求。因此，以秒为单位的最大稳定时间步长由该表达式给出。",
            "answer": "$$\\boxed{\\frac{2\\nu}{a^2}}$$"
        }
    ]
}