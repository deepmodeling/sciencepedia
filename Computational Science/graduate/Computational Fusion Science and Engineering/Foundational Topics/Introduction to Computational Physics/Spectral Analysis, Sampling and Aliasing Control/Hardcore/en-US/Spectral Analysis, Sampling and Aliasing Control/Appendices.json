{
    "hands_on_practices": [
        {
            "introduction": "Before any complex spectral analysis can be performed, the continuous analog signal from a sensor must be converted into a discrete digital format by an Analog-to-Digital Converter (ADC). This fundamental process of quantization is not perfect and introduces an unavoidable error known as quantization noise. This exercise  guides you through a first-principles derivation of the quantization noise power and the resulting signal-to-noise ratio (SNR), providing a critical understanding of the ultimate fidelity limit of your digitized data based on the ADC's resolution.",
            "id": "4046221",
            "problem": "A magnetic pick-up coil in a tokamak diagnostic chain is digitized by a uniform mid-tread Analog-to-Digital Converter (ADC) with resolution $B$ bits and a full-scale peak-to-peak input range $V_{\\mathrm{pp}} = 10\\,\\mathrm{V}$ (corresponding to $\\pm 5\\,\\mathrm{V}$). The sampling frequency is sufficiently high, and a well-designed anti-alias filter ensures that out-of-band spectral components are attenuated before sampling. Assume the quantization error is additive, uncorrelated with the input, and white across the Nyquist band.\n\nA sinusoidal calibration tone with peak amplitude $A = 1.25\\,\\mathrm{V}$ is applied at the ADC input, well within the passband. Starting from first principles and core definitions, do the following:\n\n1. From the definition of a uniform quantizer with step size $\\Delta$, derive the quantization error power by modeling the quantization error as a random variable uniformly distributed over its quantization cell. Do not assume any target formula; begin from the uniform probability density function and compute its variance.\n\n2. Using the root-mean-square value of a sinusoid of peak amplitude $A$, and the definition of signal-to-noise ratio (SNR) as the ratio of average signal power to noise power, derive an expression for the SNR in terms of $A$, $B$, and $V_{\\mathrm{pp}}$.\n\n3. Evaluate the SNR for $B=14$, $V_{\\mathrm{pp}}=10\\,\\mathrm{V}$, and $A=1.25\\,\\mathrm{V}$, expressing the SNR in decibels. Round your final numeric answer to four significant figures.\n\nReport only the SNR in decibels as your final answer. Do not report intermediate quantities in the final answer.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information to derive a unique solution. The process involves three main steps as outlined in the problem statement: deriving the quantization error power, deriving the signal-to-noise ratio (SNR) expression, and evaluating the SNR for the given parameters.\n\nPart 1: Derivation of Quantization Error Power\n\nA uniform $B$-bit quantizer divides its full-scale peak-to-peak voltage range, $V_{\\mathrm{pp}}$, into $2^B$ discrete levels. The voltage difference between adjacent levels is the quantization step size, $\\Delta$.\n$$ \\Delta = \\frac{V_{\\mathrm{pp}}}{2^B} $$\nThe quantization error, $e_q$, is the difference between the continuous input voltage and the discrete output voltage. For a uniform mid-tread quantizer, this error is bounded in the range $[-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}]$. The problem states to model this error as a random variable uniformly distributed over its quantization cell. The probability density function (PDF) of the quantization error, $p(e_q)$, is therefore:\n$$ p(e_q) = \\begin{cases} \\frac{1}{\\Delta}  \\text{for } -\\frac{\\Delta}{2} \\le e_q \\le \\frac{\\Delta}{2} \\\\ 0  \\text{otherwise} \\end{cases} $$\nThe average power of the quantization noise, $P_N$, is equal to its variance, $\\sigma_q^2$, since its mean is zero. We first verify the mean, $E[e_q]$, is zero.\n$$ E[e_q] = \\int_{-\\infty}^{\\infty} e_q p(e_q) de_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q \\frac{1}{\\Delta} de_q = \\frac{1}{\\Delta} \\left[ \\frac{e_q^2}{2} \\right]_{-\\Delta/2}^{\\Delta/2} $$\n$$ E[e_q] = \\frac{1}{2\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^2 - \\left(-\\frac{\\Delta}{2}\\right)^2 \\right) = \\frac{1}{2\\Delta} \\left( \\frac{\\Delta^2}{4} - \\frac{\\Delta^2}{4} \\right) = 0 $$\nThe noise power $P_N$ is the variance $\\sigma_q^2 = E[e_q^2] - (E[e_q])^2 = E[e_q^2]$. We compute this mean-square value from the PDF:\n$$ P_N = E[e_q^2] = \\int_{-\\infty}^{\\infty} e_q^2 p(e_q) de_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q^2 \\frac{1}{\\Delta} de_q $$\n$$ P_N = \\frac{1}{\\Delta} \\left[ \\frac{e_q^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right) $$\n$$ P_N = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right) = \\frac{1}{3\\Delta} \\left( \\frac{2\\Delta^3}{8} \\right) = \\frac{\\Delta^2}{12} $$\nThis concludes the first part of the derivation.\n\nPart 2: Derivation of the SNR Expression\n\nThe input signal is a sinusoid with peak amplitude $A$. The instantaneous voltage can be written as $s(t) = A \\sin(\\omega t)$. The average signal power, $P_S$, is a general property of a signal and is defined as the mean of its squared value. For a periodic signal, this is calculated over one period. For a sinusoid, this is equivalent to the square of its root-mean-square (RMS) value. The RMS value, $V_{\\mathrm{rms}}$, of a sinusoid with peak amplitude $A$ is $A/\\sqrt{2}$.\n$$ P_S = V_{\\mathrm{rms}}^2 = \\left( \\frac{A}{\\sqrt{2}} \\right)^2 = \\frac{A^2}{2} $$\nThe signal-to-noise ratio (SNR) is defined as the ratio of the average signal power to the average noise power.\n$$ \\mathrm{SNR} = \\frac{P_S}{P_N} $$\nSubstituting the derived expressions for $P_S$ and $P_N$:\n$$ \\mathrm{SNR} = \\frac{A^2/2}{\\Delta^2/12} = \\frac{12A^2}{2\\Delta^2} = \\frac{6A^2}{\\Delta^2} $$\nTo express the SNR in terms of $A$, $B$, and $V_{\\mathrm{pp}}$, we substitute $\\Delta = V_{\\mathrm{pp}}/2^B$:\n$$ \\mathrm{SNR} = \\frac{6A^2}{\\left( V_{\\mathrm{pp}}/2^B \\right)^2} = \\frac{6A^2 (2^B)^2}{V_{\\mathrm{pp}}^2} = \\frac{6A^2 2^{2B}}{V_{\\mathrm{pp}}^2} $$\nThis is the required analytical expression for the SNR.\n\nPart 3: Evaluation of the SNR in Decibels\n\nWe are given the values $B = 14$, $V_{\\mathrm{pp}} = 10\\,\\mathrm{V}$, and $A = 1.25\\,\\mathrm{V}$. We substitute these into the SNR expression.\n$$ \\mathrm{SNR} = \\frac{6 \\times (1.25)^2 \\times 2^{2 \\times 14}}{(10)^2} = \\frac{6 \\times 1.5625 \\times 2^{28}}{100} $$\n$$ \\mathrm{SNR} = \\frac{9.375 \\times 268435456}{100} = \\frac{2516582400}{100} = 25165824 $$\nThis is the linear power ratio. To express the SNR in decibels ($\\mathrm{dB}$), we use the formula:\n$$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(\\mathrm{SNR}) $$\n$$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(25165824) $$\nCalculating the value of the logarithm:\n$$ \\log_{10}(25165824) \\approx 7.40082046 $$\nNow, we find the SNR in decibels:\n$$ \\mathrm{SNR}_{\\mathrm{dB}} \\approx 10 \\times 7.40082046 \\approx 74.0082046\\,\\mathrm{dB} $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ \\mathrm{SNR}_{\\mathrm{dB}} \\approx 74.01\\,\\mathrm{dB} $$",
            "answer": "$$\n\\boxed{74.01}\n$$"
        },
        {
            "introduction": "Once we have a stream of digital data, the Fast Fourier Transform (FFT) is our primary tool for converting it into the frequency domain. However, its application in real-time monitoring systems, such as tracking instabilities in a fusion plasma, involves a delicate balancing act. This practical design problem  challenges you to navigate the trade-offs between frequency resolution, which depends on the analysis window size, and time resolution, which depends on how frequently you process a new window, all while staying within a fixed computational budget.",
            "id": "4046203",
            "problem": "A tokamak diagnostic measures poloidal magnetic fluctuations with Mirnov coils to track rotating Magnetohydrodynamic (MHD) modes in real time. The digitizer streams a single precision time series at sampling frequency $f_s = 200\\,\\mathrm{kHz}$ and an analog anti-aliasing low-pass filter with cutoff $f_c = 90\\,\\mathrm{kHz}$ is installed ahead of the digitizer. The band of interest for the rotating MHD modes is $f \\in [5,20]\\,\\mathrm{kHz}$. The real-time monitor must satisfy two constraints simultaneously: (i) its spectral estimates must be updated with time resolution better than $2\\,\\mathrm{ms}$, and (ii) its frequency resolution must be finer than or equal to $150\\,\\mathrm{Hz}$. The processor executes a radix-2 Fast Fourier Transform (FFT) and can sustain a rate of at most $B = 1.6\\times 10^7$ radix-2 butterflies per second, where a butterfly is defined as one complex twiddle multiplication and two complex additions. To ensure stable operation under scheduler overhead, the spectral pipeline is permitted to consume at most $0.9B$ butterflies per second. The FFT is computed on overlapping windows of length $N$ samples, advanced by a stride (hop) of $H$ samples per update, and a Hann window is applied to each frame to control spectral leakage. Assume a standard radix-2 implementation.\n\nWhich option provides a correct explanation of the computational complexity of the radix-2 FFT and a justifiable choice of $(N,H)$ that meets the time-resolution, frequency-resolution, aliasing control, and compute-budget constraints stated above?\n\nA. Choose $N = 2048$ and $H = 256$. Explain complexity by counting the number of radix-2 stages and butterflies, and show that the total butterfly rate stays below $0.9B$; argue that the analog filter at $f_c$ together with $f_s$ controls aliasing in the band of interest, and that both the time and frequency resolutions are satisfied.\n\nB. Choose $N = 1024$ and $H = 128$. Explain complexity by asserting that the radix-2 FFT halves the operations compared to the Discrete Fourier Transform (DFT) and therefore the compute load is easily below $0.9B$; argue that the frequency resolution is acceptable for $f \\in [5,20]\\,\\mathrm{kHz}$ and that the time resolution is satisfied; aliasing is not a concern due to $f_c$.\n\nC. Choose $N = 4096$ and $H = 512$. Explain complexity by stating that the radix-2 FFT has linear complexity in $N$ and thus the compute load scales gently with $N$; argue that the analog filter prevents aliasing and that the larger $N$ improves frequency resolution, while the stride meets the time-resolution requirement.\n\nD. Choose $N = 4096$ and $H = 256$. Explain complexity by counting radix-2 stages and butterflies and show that the compute load is below $0.9B$; argue that both frequency and time resolutions are satisfied and aliasing is controlled by the analog filter.\n\nE. Choose $N = 2048$ and $H = 128$. Explain complexity by counting radix-2 stages and butterflies and show that the compute load is below $0.9B$; argue that both frequency and time resolutions are satisfied and aliasing is controlled by the analog filter.",
            "solution": "The user-provided problem will first be subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   **Signal Source**: Poloidal magnetic fluctuations from Mirnov coils in a tokamak, representing rotating Magnetohydrodynamic (MHD) modes.\n-   **Sampling Frequency**: $f_s = 200\\,\\mathrm{kHz}$\n-   **Anti-aliasing Filter**: Analog low-pass filter with cutoff frequency $f_c = 90\\,\\mathrm{kHz}$.\n-   **Band of Interest**: $f \\in [5, 20]\\,\\mathrm{kHz}$.\n-   **Time Resolution Constraint**: Spectral estimate update time resolution must be better than $2\\,\\mathrm{ms}$.\n-   **Frequency Resolution Constraint**: Spectral frequency resolution must be finer than or equal to $150\\,\\mathrm{Hz}$.\n-   **Computational Algorithm**: Radix-2 Fast Fourier Transform (FFT).\n-   **Processor Maximum Throughput**: $B = 1.6 \\times 10^7$ radix-2 butterflies per second.\n-   **Operational Compute Budget**: At most $0.9B$ butterflies per second.\n-   **Butterfly Definition**: One complex twiddle multiplication and two complex additions.\n-   **Processing Scheme**: Overlapping windows of length $N$ samples, advanced by a stride (hop) of $H$ samples.\n-   **Windowing Function**: Hann window.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is grounded in the standard practices of digital signal processing for experimental physics data. The use of Mirnov coils, FFT for spectral analysis of MHD modes, anti-aliasing filters, windowing, and consideration of computational constraints are all standard and scientifically sound concepts in computational fusion science and engineering.\n2.  **Well-Posedness**: The problem provides a set of quantitative constraints and asks for a valid parameter choice $(N,H)$ from a list of options. This is a well-posed design and optimization problem. A unique solution among the options is expected to exist if the constraints are collectively satisfiable by one of the proposals.\n3.  **Objectivity**: The problem is stated using precise, objective, and quantitative language, free of subjective or ambiguous terminology.\n4.  **Completeness and Consistency**: The problem provides all necessary information to evaluate the constraints. The relationship between $N$ and frequency resolution, $H$ and time resolution, and $(N,H)$ and computational load are all well-defined. The use of a radix-2 FFT implies $N$ must be a power of $2$, which is consistent with the options provided. The data are dimensionally consistent. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a well-defined, scientifically grounded, and self-contained engineering problem. I will now proceed with the solution derivation and option analysis.\n\n### Solution Derivation\n\nThe solution requires finding a pair of parameters $(N, H)$, where $N$ is the FFT window length and $H$ is the stride, that simultaneously satisfies four constraints: aliasing control, frequency resolution, time resolution, and computational budget.\n\n1.  **Aliasing Control**:\n    The sampling frequency is $f_s = 200\\,\\mathrm{kHz}$, which gives a Nyquist frequency of $f_{Nyquist} = f_s / 2 = 100\\,\\mathrm{kHz}$. The analog anti-aliasing filter has a cutoff frequency $f_c = 90\\,\\mathrm{kHz}$. Since $f_c  f_{Nyquist}$, the filter attenuates frequencies above $90\\,\\mathrm{kHz}$ before they are sampled. This prevents high-frequency components from aliasing (folding) into the frequency range below $f_{Nyquist}$, and specifically into the band of interest, which is $[5, 20]\\,\\mathrm{kHz}$. This part of the system is correctly designed to control aliasing. All options correctly identify that aliasing is controlled.\n\n2.  **Frequency Resolution Constraint**:\n    The frequency resolution, $\\Delta f$, of an FFT of length $N$ for a signal sampled at $f_s$ is given by $\\Delta f = f_s / N$.\n    The constraint is $\\Delta f \\le 150\\,\\mathrm{Hz}$.\n    $$ \\frac{f_s}{N} \\le 150\\,\\mathrm{Hz} $$\n    $$ N \\ge \\frac{f_s}{150\\,\\mathrm{Hz}} = \\frac{200,000\\,\\mathrm{Hz}}{150\\,\\mathrm{Hz}} \\approx 1333.33 $$\n    Since a radix-2 FFT is employed, $N$ must be a power of $2$. The smallest power of $2$ that is greater than or equal to $1333.33$ is $2^{11} = 2048$.\n    Thus, we must have $N \\ge 2048$. This constraint immediately eliminates any option with $N  2048$.\n\n3.  **Time Resolution Constraint**:\n    The time between consecutive spectral updates, $\\Delta t_{update}$, is determined by the stride $H$ and the sampling frequency $f_s$: $\\Delta t_{update} = H / f_s$.\n    The constraint is $\\Delta t_{update}  2\\,\\mathrm{ms} = 2 \\times 10^{-3}\\,\\mathrm{s}$.\n    $$ \\frac{H}{f_s}  2 \\times 10^{-3}\\,\\mathrm{s} $$\n    $$ H  (2 \\times 10^{-3}\\,\\mathrm{s}) \\times f_s = (2 \\times 10^{-3}) \\times (2 \\times 10^5) = 400 $$\n    Thus, the stride must be $H  400$ samples.\n\n4.  **Computational Budget Constraint**:\n    The number of butterflies, $C_{FFT}$, for a radix-2 FFT of size $N$ is $C_{FFT} = \\frac{N}{2} \\log_2(N)$.\n    The rate of FFT computations is $R_{FFT} = f_s / H$ FFTs per second.\n    The total butterfly rate, $R_B$, is the product of these two quantities:\n    $$ R_B = C_{FFT} \\times R_{FFT} = \\left(\\frac{N}{2} \\log_2(N)\\right) \\left(\\frac{f_s}{H}\\right) $$\n    The allowed budget is $0.9B = 0.9 \\times (1.6 \\times 10^7) = 1.44 \\times 10^7$ butterflies per second.\n    The constraint is $R_B \\le 1.44 \\times 10^7$.\n\n### Option-by-Option Analysis\n\nWe now evaluate each option against the derived constraints.\n\n**A. Choose $N = 2048$ and $H = 256$.**\n-   **Frequency Resolution**: $N = 2048$. This satisfies $N \\ge 2048$. The resolution is $\\Delta f = 200,000 / 2048 \\approx 97.7\\,\\mathrm{Hz}$, which is $\\le 150\\,\\mathrm{Hz}$. **(Constraint Met)**\n-   **Time Resolution**: $H = 256$. This satisfies $H  400$. The update time is $\\Delta t_{update} = 256 / 200,000 = 1.28\\,\\mathrm{ms}$, which is $ 2\\,\\mathrm{ms}$. **(Constraint Met)**\n-   **Computational Budget**: With $N=2048=2^{11}$ and $H=256$:\n    $$ R_B = \\left(\\frac{2048}{2} \\log_2(2048)\\right) \\left(\\frac{200,000}{256}\\right) = (1024 \\times 11) \\times 781.25 = 11,264 \\times 781.25 = 8.8 \\times 10^6\\,\\text{butterflies/s} $$\n    Since $8.8 \\times 10^6 \\le 1.44 \\times 10^7$, this is within the budget. **(Constraint Met)**\n-   **Complexity Explanation**: The option proposes to \"explain complexity by counting the number of radix-2 stages and butterflies,\" which is the correct and rigorous method for quantifying the computational load of an FFT.\n-   **Verdict**: **Correct**. All constraints are satisfied, and the rationale for complexity is sound.\n\n**B. Choose $N = 1024$ and $H = 128$.**\n-   **Frequency Resolution**: $N = 1024$. This violates the requirement $N \\ge 2048$. The resolution is $\\Delta f = 200,000 / 1024 \\approx 195.3\\,\\mathrm{Hz}$, which is not $\\le 150\\,\\mathrm{Hz}$. **(Constraint Failed)**\n-   **Complexity Explanation**: The explanation asserts that radix-2 FFT \"halves the operations\" of a DFT. This is a gross oversimplification and is incorrect. The complexity reduction is from $O(N^2)$ for DFT to $O(N \\log N)$ for FFT, which is a much more significant improvement than halving.\n-   **Verdict**: **Incorrect**. Fails the frequency resolution constraint and provides a flawed complexity argument.\n\n**C. Choose $N = 4096$ and $H = 512$.**\n-   **Time Resolution**: $H = 512$. This violates the requirement $H  400$. The update time is $\\Delta t_{update} = 512 / 200,000 = 2.56\\,\\mathrm{ms}$, which is not $ 2\\,\\mathrm{ms}$. **(Constraint Failed)**\n-   **Complexity Explanation**: The explanation states that radix-2 FFT has \"linear complexity in $N$\". This is false. The complexity is $O(N \\log N)$, which is quasi-linear, not linear ($O(N)$).\n-   **Verdict**: **Incorrect**. Fails the time resolution constraint and provides a false complexity statement.\n\n**D. Choose $N = 4096$ and $H = 256$.**\n-   **Frequency Resolution**: $N = 4096$. Satisfies $N \\ge 2048$. **(Constraint Met)**\n-   **Time Resolution**: $H = 256$. Satisfies $H  400$. **(Constraint Met)**\n-   **Computational Budget**: With $N=4096=2^{12}$ and $H=256$:\n    $$ R_B = \\left(\\frac{4096}{2} \\log_2(4096)\\right) \\left(\\frac{200,000}{256}\\right) = (2048 \\times 12) \\times 781.25 = 24,576 \\times 781.25 = 1.92 \\times 10^7\\,\\text{butterflies/s} $$\n    Since $1.92 \\times 10^7  1.44 \\times 10^7$, this exceeds the budget. **(Constraint Failed)**\n-   **Verdict**: **Incorrect**. Fails the computational budget constraint.\n\n**E. Choose $N = 2048$ and $H = 128$.**\n-   **Frequency Resolution**: $N = 2048$. Satisfies $N \\ge 2048$. **(Constraint Met)**\n-   **Time Resolution**: $H = 128$. Satisfies $H  400$. **(Constraint Met)**\n-   **Computational Budget**: With $N=2048=2^{11}$ and $H=128$:\n    $$ R_B = \\left(\\frac{2048}{2} \\log_2(2048)\\right) \\left(\\frac{200,000}{128}\\right) = (1024 \\times 11) \\times 1562.5 = 11,264 \\times 1562.5 = 1.76 \\times 10^7\\,\\text{butterflies/s} $$\n    Since $1.76 \\times 10^7  1.44 \\times 10^7$, this exceeds the budget. **(Constraint Failed)**\n-   **Verdict**: **Incorrect**. Fails the computational budget constraint.\n\nBased on this comprehensive analysis, only option A provides a set of parameters $(N, H)$ that satisfies all stated constraints, along with a correct justification of its complexity analysis.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Spectral data from fusion experiments often contains a rich mixture of signals, and a key task is to isolate a specific frequency band corresponding to a particular physical phenomenon. This requires the design of digital filters with precisely defined passband and stopband characteristics. This advanced practice  simulates a realistic task in fusion diagnostics: designing a high-order digital bandpass filter to isolate Alfvénic wave activity, translating frequency-domain requirements into a concrete filter order using the bilinear transform and a Chebyshev prototype.",
            "id": "4046301",
            "problem": "A Mirnov coil array on a tokamak measures magnetic fluctuations to diagnose shear Alfvén wave activity. The data are sampled by an Analog-to-Digital Converter (ADC) at sampling frequency $f_{s} = 2.0 \\times 10^{6}\\ \\mathrm{Hz}$, and subsequent spectral analysis aims to isolate the Alfvénic band between $80\\ \\mathrm{kHz}$ and $120\\ \\mathrm{kHz}$. To suppress magnetohydrodynamic (MHD) activity outside this band and to control spectral leakage and aliasing in downstream processing, you are tasked with designing a causal, stable, digital bandpass filter derived via the bilinear transform from an analog lowpass prototype.\n\nThe design requirements are:\n- Passband edges at $f_{p1} = 80\\ \\mathrm{kHz}$ and $f_{p2} = 120\\ \\mathrm{kHz}$, with maximum passband ripple $R_{p} = 0.2\\ \\mathrm{dB}$.\n- Stopband edges at $f_{s1} = 60\\ \\mathrm{kHz}$ (below the passband) and $f_{s2} = 140\\ \\mathrm{kHz}$ (above the passband), with minimum stopband attenuation $R_{s} = 60\\ \\mathrm{dB}$.\n- Use bilinear prewarping of frequency to account for the frequency mapping inherent in the bilinear transform.\n- Use a Chebyshev Type I approximation for the analog lowpass prototype and the standard bandpass-to-lowpass frequency transformation to assess the worst-case stopband separation.\n\nStarting from the sampling theorem, the bilinear transform definition, and the Chebyshev Type I magnitude characteristics, derive the minimal filter order of the resulting digital bandpass Infinite Impulse Response (IIR) filter. Your derivation must explicitly perform frequency prewarping and the bandpass-to-lowpass mapping to obtain the lowpass prototype order and then account for the order multiplication incurred by the bandpass transformation. Provide the final answer as the minimal integer order of the digital bandpass filter. No rounding by significant figures is necessary; report the exact integer.",
            "solution": "The objective is to determine the minimal integer order of a digital bandpass filter based on a Chebyshev Type I analog lowpass prototype, designed using the bilinear transform with frequency prewarping. The derivation proceeds in four main steps:\n1. Prewarping the digital frequency specifications to the analog domain.\n2. Transforming the analog bandpass specifications to an equivalent analog lowpass prototype's specifications.\n3. Calculating the required order of the analog lowpass prototype.\n4. Determining the final order of the digital bandpass filter.\n\nFirst, we compile the given design specifications:\n- Sampling frequency: $f_s = 2.0 \\times 10^6\\ \\mathrm{Hz}$. The sampling period is $T_s = 1/f_s = 0.5 \\times 10^{-6}\\ \\mathrm{s}$.\n- Passband edges: $f_{p1} = 80\\ \\mathrm{kHz} = 80 \\times 10^3\\ \\mathrm{Hz}$, $f_{p2} = 120\\ \\mathrm{kHz} = 120 \\times 10^3\\ \\mathrm{Hz}$.\n- Stopband edges: $f_{s1} = 60\\ \\mathrm{kHz} = 60 \\times 10^3\\ \\mathrm{Hz}$, $f_{s2} = 140\\ \\mathrm{kHz} = 140 \\times 10^3\\ \\mathrm{Hz}$.\n- Maximum passband ripple: $R_p = 0.2\\ \\mathrm{dB}$.\n- Minimum stopband attenuation: $R_s = 60\\ \\mathrm{dB}$.\n\n**Step 1: Frequency Prewarping**\nThe bilinear transform relates the digital frequency $\\omega \\in [-\\pi, \\pi]$ to the analog frequency $\\Omega$ by the mapping $s = \\frac{2}{T_s} \\frac{1-z^{-1}}{1+z^{-1}}$. For a sinusoidal steady state, where $s=j\\Omega$ and $z=e^{j\\omega}$, this implies $\\Omega = \\frac{2}{T_s} \\tan(\\frac{\\omega}{2})$. Since the digital frequency is related to the continuous-time frequency $f$ by $\\omega = 2\\pi f / f_s$, we can prewarp the critical digital frequencies ($f_{p1}$, $f_{p2}$, $f_{s1}$, $f_{s2}$) to their corresponding analog counterparts:\n$$ \\Omega = \\frac{2}{T_s} \\tan\\left(\\frac{2\\pi f}{2 f_s}\\right) = \\frac{2}{T_s} \\tan\\left(\\frac{\\pi f}{f_s}\\right) $$\nWith $T_s = 0.5 \\times 10^{-6}\\ \\mathrm{s}$, the prewarping factor is $\\frac{2}{T_s} = 4.0 \\times 10^6\\ \\mathrm{s}^{-1}$. The prewarped analog frequencies are:\n- $\\Omega_{p1} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 80 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.04\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{p2} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 120 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.06\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{s1} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 60 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.03\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{s2} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 140 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.07\\pi)\\ \\mathrm{rad/s}$\n\n**Step 2: Analog Bandpass to Lowpass Transformation**\nThe analog bandpass filter specifications must be transformed into specifications for a normalized lowpass prototype. The standard frequency mapping is given by $\\Omega_{LP} = \\frac{\\Omega_{BP}^2 - \\Omega_0^2}{B \\Omega_{BP}}$, where $\\Omega_0 = \\sqrt{\\Omega_{p1}\\Omega_{p2}}$ is the geometric center frequency and $B = \\Omega_{p2} - \\Omega_{p1}$ is the passband bandwidth of the analog bandpass filter.\nThis transformation maps the bandpass passband $[\\Omega_{p1}, \\Omega_{p2}]$ to the lowpass prototype passband $[-1, 1]$. Thus, the lowpass prototype passband edge is $\\Omega_{LP,p} = 1\\ \\mathrm{rad/s}$.\n\nWe must determine the corresponding stopband frequency for the lowpass prototype, $\\Omega_{LP,s}$. The two bandpass stopband edges, $\\Omega_{s1}$ and $\\Omega_{s2}$, map to two frequencies in the lowpass domain:\n$$ \\Omega_1 = \\frac{\\Omega_{s1}^2 - \\Omega_0^2}{B \\Omega_{s1}} = \\frac{\\Omega_{s1}^2 - \\Omega_{p1}\\Omega_{p2}}{(\\Omega_{p2}-\\Omega_{p1})\\Omega_{s1}} $$\n$$ \\Omega_2 = \\frac{\\Omega_{s2}^2 - \\Omega_0^2}{B \\Omega_{s2}} = \\frac{\\Omega_{s2}^2 - \\Omega_{p1}\\Omega_{p2}}{(\\Omega_{p2}-\\Omega_{p1})\\Omega_{s2}} $$\nThe lowpass prototype must satisfy the stopband attenuation requirement for all frequencies $|\\Omega| \\ge \\Omega_{LP,s}$. The stricter constraint corresponds to the narrowest transition band, i.e., the stopband frequency magnitude that is closest to the passband edge magnitude of $1$. This is given by $\\Omega_{LP,s} = \\min(|\\Omega_1|, |\\Omega_2|)$.\nSubstituting the expressions for the warped frequencies (the common factor of $4.0 \\times 10^6$ cancels out):\n$$ \\Omega_1 = \\frac{\\tan^2(0.03\\pi) - \\tan(0.04\\pi)\\tan(0.06\\pi)}{[\\tan(0.06\\pi) - \\tan(0.04\\pi)]\\tan(0.03\\pi)} \\approx \\frac{(0.094914)^2 - (0.126868)(0.190983)}{[0.190983 - 0.126868](0.094914)} \\approx -2.5025 $$\n$$ \\Omega_2 = \\frac{\\tan^2(0.07\\pi) - \\tan(0.04\\pi)\\tan(0.06\\pi)}{[\\tan(0.06\\pi) - \\tan(0.04\\pi)]\\tan(0.07\\pi)} \\approx \\frac{(0.223866)^2 - (0.126868)(0.190983)}{[0.190983 - 0.126868](0.223866)} \\approx 1.8039 $$\nThe critical stopband frequency for the lowpass prototype is $\\Omega_{LP,s} = \\min(|-2.5025|, 1.8039) = 1.8039\\ \\mathrm{rad/s}$.\n\n**Step 3: Chebyshev Lowpass Prototype Order Calculation**\nFor a Chebyshev Type I filter, the required order $N_{LP}$ is given by the formula:\n$$ N_{LP} \\ge \\frac{\\arccosh\\left(\\frac{\\sqrt{A^2-1}}{\\epsilon}\\right)}{\\arccosh\\left(\\frac{\\Omega_{LP,s}}{\\Omega_{LP,p}}\\right)} $$\nThe parameter $\\epsilon$ is related to the passband ripple $R_p = 0.2\\ \\mathrm{dB}$:\n$$ \\epsilon = \\sqrt{10^{R_p/10} - 1} = \\sqrt{10^{0.2/10} - 1} = \\sqrt{10^{0.02} - 1} \\approx 0.21709 $$\nThe parameter $A$ is related to the stopband attenuation $R_s = 60\\ \\mathrm{dB}$:\n$$ A = 10^{R_s/20} = 10^{60/20} = 10^3 = 1000 $$\nNow, we can compute the numerator and denominator for the order formula.\nThe argument of the numerator's $\\arccosh$ function is:\n$$ \\frac{\\sqrt{A^2-1}}{\\epsilon} = \\frac{\\sqrt{1000^2 - 1}}{\\sqrt{10^{0.02} - 1}} \\approx \\frac{999.9995}{0.21709} \\approx 4606.32 $$\nThe argument of the denominator's $\\arccosh$ function is the selectivity factor:\n$$ \\frac{\\Omega_{LP,s}}{\\Omega_{LP,p}} = \\frac{1.8039}{1} = 1.8039 $$\nUsing the identity $\\arccosh(x) = \\ln(x + \\sqrt{x^2 - 1})$:\n$$ N_{LP} \\ge \\frac{\\arccosh(4606.32)}{\\arccosh(1.8039)} = \\frac{\\ln(4606.32 + \\sqrt{4606.32^2 - 1})}{\\ln(1.8039 + \\sqrt{1.8039^2 - 1})} \\approx \\frac{\\ln(9212.64)}{1.1955} \\approx \\frac{9.1283}{1.1955} \\approx 7.6358 $$\nSince the filter order must be an integer, we must take the ceiling of this value:\n$$ N_{LP} = \\lceil 7.6358 \\rceil = 8 $$\n\n**Step 4: Final Digital Bandpass Filter Order**\nThe transformation from a lowpass prototype filter of order $N_{LP}$ to a bandpass filter is achieved by the substitution $s \\rightarrow \\frac{s^2+\\Omega_0^2}{Bs}$. This substitution replaces each pole and zero of the lowpass transfer function with a pair of poles and zeros, effectively doubling the filter order. Thus, the order of the analog bandpass filter is:\n$$ N_{BP} = 2 \\times N_{LP} = 2 \\times 8 = 16 $$\nThe bilinear transform maps a rational transfer function in the $s$-domain of order $N$ to a rational transfer function in the $z$-domain of the same order $N$. Therefore, the order of the final digital bandpass filter is the same as the order of the intermediate analog bandpass filter.\n$$ N_{digital} = N_{BP} = 16 $$\nThis completes the derivation. The minimal integer order of the digital bandpass filter that meets the specifications is $16$.",
            "answer": "$$\\boxed{16}$$"
        }
    ]
}