{
    "hands_on_practices": [
        {
            "introduction": "Before any spectral analysis can be performed, an analog signal must be converted into a digital format by an Analog-to-Digital Converter (ADC). This exercise explores the fundamental limit on signal fidelity imposed by this process: quantization noise. By deriving the signal-to-noise ratio (SNR) from first principles , you will gain a concrete understanding of how an ADC's resolution determines the ultimate noise floor of a measurement.",
            "id": "4046221",
            "problem": "A magnetic pick-up coil in a tokamak diagnostic chain is digitized by a uniform mid-tread Analog-to-Digital Converter (ADC) with resolution $B$ bits and a full-scale peak-to-peak input range $V_{\\mathrm{pp}} = 10\\,\\mathrm{V}$ (corresponding to $\\pm 5\\,\\mathrm{V}$). The sampling frequency is sufficiently high, and a well-designed anti-alias filter ensures that out-of-band spectral components are attenuated before sampling. Assume the quantization error is additive, uncorrelated with the input, and white across the Nyquist band.\n\nA sinusoidal calibration tone with peak amplitude $A = 1.25\\,\\mathrm{V}$ is applied at the ADC input, well within the passband. Starting from first principles and core definitions, do the following:\n\n1. From the definition of a uniform quantizer with step size $\\Delta$, derive the quantization error power by modeling the quantization error as a random variable uniformly distributed over its quantization cell. Do not assume any target formula; begin from the uniform probability density function and compute its variance.\n\n2. Using the root-mean-square value of a sinusoid of peak amplitude $A$, and the definition of signal-to-noise ratio (SNR) as the ratio of average signal power to noise power, derive an expression for the SNR in terms of $A$, $B$, and $V_{\\mathrm{pp}}$.\n\n3. Evaluate the SNR for $B=14$, $V_{\\mathrm{pp}}=10\\,\\mathrm{V}$, and $A=1.25\\,\\mathrm{V}$, expressing the SNR in decibels. Round your final numeric answer to four significant figures.\n\nReport only the SNR in decibels as your final answer. Do not report intermediate quantities in the final answer.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information to derive a unique solution. The process involves three main steps as outlined in the problem statement: deriving the quantization error power, deriving the signal-to-noise ratio (SNR) expression, and evaluating the SNR for the given parameters.\n\nPart 1: Derivation of Quantization Error Power\n\nA uniform $B$-bit quantizer divides its full-scale peak-to-peak voltage range, $V_{\\mathrm{pp}}$, into $2^B$ discrete levels. The voltage difference between adjacent levels is the quantization step size, $\\Delta$.\n$$ \\Delta = \\frac{V_{\\mathrm{pp}}}{2^B} $$\nThe quantization error, $e_q$, is the difference between the continuous input voltage and the discrete output voltage. For a uniform mid-tread quantizer, this error is bounded in the range $[-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}]$. The problem states to model this error as a random variable uniformly distributed over its quantization cell. The probability density function (PDF) of the quantization error, $p(e_q)$, is therefore:\n$$ p(e_q) = \\begin{cases} \\frac{1}{\\Delta} & \\text{for } -\\frac{\\Delta}{2} \\le e_q \\le \\frac{\\Delta}{2} \\\\ 0 & \\text{otherwise} \\end{cases} $$\nThe average power of the quantization noise, $P_N$, is equal to its variance, $\\sigma_q^2$, since its mean is zero. We first verify the mean, $E[e_q]$, is zero.\n$$ E[e_q] = \\int_{-\\infty}^{\\infty} e_q p(e_q) de_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q \\frac{1}{\\Delta} de_q = \\frac{1}{\\Delta} \\left[ \\frac{e_q^2}{2} \\right]_{-\\Delta/2}^{\\Delta/2} $$\n$$ E[e_q] = \\frac{1}{2\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^2 - \\left(-\\frac{\\Delta}{2}\\right)^2 \\right) = \\frac{1}{2\\Delta} \\left( \\frac{\\Delta^2}{4} - \\frac{\\Delta^2}{4} \\right) = 0 $$\nThe noise power $P_N$ is the variance $\\sigma_q^2 = E[e_q^2] - (E[e_q])^2 = E[e_q^2]$. We compute this mean-square value from the PDF:\n$$ P_N = E[e_q^2] = \\int_{-\\infty}^{\\infty} e_q^2 p(e_q) de_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q^2 \\frac{1}{\\Delta} de_q $$\n$$ P_N = \\frac{1}{\\Delta} \\left[ \\frac{e_q^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right) $$\n$$ P_N = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right) = \\frac{1}{3\\Delta} \\left( \\frac{2\\Delta^3}{8} \\right) = \\frac{\\Delta^2}{12} $$\nThis concludes the first part of the derivation.\n\nPart 2: Derivation of the SNR Expression\n\nThe input signal is a sinusoid with peak amplitude $A$. The instantaneous voltage can be written as $s(t) = A \\sin(\\omega t)$. The average signal power, $P_S$, is a general property of a signal and is defined as the mean of its squared value. For a periodic signal, this is calculated over one period. For a sinusoid, this is equivalent to the square of its root-mean-square (RMS) value. The RMS value, $V_{\\mathrm{rms}}$, of a sinusoid with peak amplitude $A$ is $A/\\sqrt{2}$.\n$$ P_S = V_{\\mathrm{rms}}^2 = \\left( \\frac{A}{\\sqrt{2}} \\right)^2 = \\frac{A^2}{2} $$\nThe signal-to-noise ratio (SNR) is defined as the ratio of the average signal power to the average noise power.\n$$ \\mathrm{SNR} = \\frac{P_S}{P_N} $$\nSubstituting the derived expressions for $P_S$ and $P_N$:\n$$ \\mathrm{SNR} = \\frac{A^2/2}{\\Delta^2/12} = \\frac{12A^2}{2\\Delta^2} = \\frac{6A^2}{\\Delta^2} $$\nTo express the SNR in terms of $A$, $B$, and $V_{\\mathrm{pp}}$, we substitute $\\Delta = V_{\\mathrm{pp}}/2^B$:\n$$ \\mathrm{SNR} = \\frac{6A^2}{\\left( V_{\\mathrm{pp}}/2^B \\right)^2} = \\frac{6A^2 (2^B)^2}{V_{\\mathrm{pp}}^2} = \\frac{6A^2 2^{2B}}{V_{\\mathrm{pp}}^2} $$\nThis is the required analytical expression for the SNR.\n\nPart 3: Evaluation of the SNR in Decibels\n\nWe are given the values $B = 14$, $V_{\\mathrm{pp}} = 10\\,\\mathrm{V}$, and $A = 1.25\\,\\mathrm{V}$. We substitute these into the SNR expression.\n$$ \\mathrm{SNR} = \\frac{6 \\times (1.25)^2 \\times 2^{2 \\times 14}}{(10)^2} = \\frac{6 \\times 1.5625 \\times 2^{28}}{100} $$\n$$ \\mathrm{SNR} = \\frac{9.375 \\times 268435456}{100} = \\frac{2516582400}{100} = 25165824 $$\nThis is the linear power ratio. To express the SNR in decibels ($\\mathrm{dB}$), we use the formula:\n$$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(\\mathrm{SNR}) $$\n$$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(25165824) $$\nCalculating the value of the logarithm:\n$$ \\log_{10}(25165824) \\approx 7.40082046 $$\nNow, we find the SNR in decibels:\n$$ \\mathrm{SNR}_{\\mathrm{dB}} \\approx 10 \\times 7.40082046 \\approx 74.0082046\\,\\mathrm{dB} $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ \\mathrm{SNR}_{\\mathrm{dB}} \\approx 74.01\\,\\mathrm{dB} $$",
            "answer": "$$\n\\boxed{74.01}\n$$"
        },
        {
            "introduction": "A raw periodogram of a long data stream is often too noisy to be a reliable estimate of the true power spectral density (PSD). This practice delves into Welch's method, a robust technique that mitigates this issue by averaging the spectra of smaller, windowed, and overlapping data segments. Through the analysis in , you will derive the resulting variance reduction and quantify the inherent trade-off with frequency resolution, building intuition for the key parameters that control the quality of a PSD estimate.",
            "id": "4046281",
            "problem": "A toroidal magnetic fluctuation signal $x(t)$ from a tokamak Mirnov coil is prefiltered by an analog low-pass anti-aliasing filter to a one-sided bandwidth of $W = 2.0 \\times 10^{5}\\,\\mathrm{Hz}$ and sampled uniformly at rate $f_{s} = 2.0 \\times 10^{6}\\,\\mathrm{Hz}$, yielding $N_{\\mathrm{tot}} = 1.31072 \\times 10^{5}$ samples. You are tasked with estimating the power spectral density (PSD) near $f_{0} = 5.0 \\times 10^{4}\\,\\mathrm{Hz}$ using Welch’s method of averaged periodograms with a length-$L$ Hann data window, $L = 4096$, $50\\,\\%$ overlap, and a hop size $H = L/2$. Assume the process is wide-sense stationary, ergodic, and that over a narrow band around $f_{0}$ it can be modeled as a zero-mean Gaussian process with locally flat PSD.\n\nStarting from the foundational definitions of the periodogram, windowed segmenting, second-order stationarity, and the properties of Gaussian random processes under linear time-invariant operations, do the following:\n\n1. Explain conceptually what Welch’s method is estimating and why windowing and overlap are used from the standpoint of spectral leakage control and variance reduction.\n2. Derive, from the definition of the averaged periodogram as the mean of $K$ overlapped, windowed segment periodograms, an expression for the variance of the Welch PSD estimator at $f_{0}$, normalized by the square of the true PSD at $f_{0}$, in terms of the number of segments $K$ and the normalized covariance between periodograms of overlapped segments. Specialize your derivation to the case of $50\\,\\%$ overlap and a Hann window, and show how the normalized covariance reduces to the square of the normalized inner product of adjacent shifted windows. Using large-$L$ asymptotics justified by $L \\gg 1$, compute this normalized inner product explicitly for the Hann window and $50\\,\\%$ overlap.\n3. Using the above, obtain a closed-form expression for the effective number of independent averages $K_{\\mathrm{eff}}$ for the specified setup, expressed as a function of $K$ and the adjacent-segment covariance you computed.\n4. Quantify the spectral resolution loss due to the Hann window using the equivalent noise bandwidth (ENBW) in discrete-frequency-bin units, relative to the rectangular window, by evaluating the large-$L$ sums of the window and its square.\n5. Let the number of Welch segments be $K = \\left\\lfloor \\dfrac{N_{\\mathrm{tot}} - L}{H} \\right\\rfloor + 1$ with $H = L/2$. Define the scalar figure of merit\n$$\n\\eta \\equiv \\frac{K_{\\mathrm{eff}}}{\\beta_{\\mathrm{Hann}}},\n$$\nwhere $\\beta_{\\mathrm{Hann}}$ is the ENBW of the Hann window expressed in units of discrete frequency bins and normalized by the rectangular window’s ENBW. Compute $\\eta$ for the given numerical parameters. Express $\\eta$ as a pure number (dimensionless) and round your answer to four significant figures.",
            "solution": "The problem requires an analysis of Welch's method for power spectral density (PSD) estimation, including conceptual explanation, derivation of variance properties, and calculation of a performance figure of merit for a specific signal processing scenario in computational fusion science.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- Signal: Toroidal magnetic fluctuation signal $x(t)$ from a Mirnov coil.\n- Analog Prefiltering: One-sided bandwidth $W = 2.0 \\times 10^{5}\\,\\mathrm{Hz}$.\n- Sampling Rate: $f_{s} = 2.0 \\times 10^{6}\\,\\mathrm{Hz}$.\n- Total Samples: $N_{\\mathrm{tot}} = 1.31072 \\times 10^{5}$.\n- Target Frequency: Estimation near $f_{0} = 5.0 \\times 10^{4}\\,\\mathrm{Hz}$.\n- Estimation Method: Welch’s method of averaged periodograms.\n- Window Function: Hann data window of length $L = 4096$.\n- Overlap: $50\\,\\%$, with hop size $H = L/2$.\n- Process Assumptions: Wide-sense stationary (WSS), ergodic, zero-mean Gaussian process with a locally flat PSD around $f_0$.\n- Definition of Number of Segments: $K = \\left\\lfloor \\dfrac{N_{\\mathrm{tot}} - L}{H} \\right\\rfloor + 1$.\n- Definition of Figure of Merit: $\\eta \\equiv \\frac{K_{\\mathrm{eff}}}{\\beta_{\\mathrm{Hann}}}$, where $K_{\\mathrm{eff}}$ is the effective number of independent averages and $\\beta_{\\mathrm{Hann}}$ is the ENBW of the Hann window normalized to the rectangular window's ENBW.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly based on the established principles of digital signal processing and spectral analysis. Welch's method is a standard and robust technique. The application to Mirnov coil data from a tokamak is a realistic scenario in plasma physics diagnostics.\n- **Well-Posed:** All necessary parameters ($W$, $f_s$, $N_{tot}$, $L$, overlap) and process assumptions (WSS, Gaussian) are provided. The questions are structured logically, building from fundamental concepts to a final numerical calculation. The problem is self-contained and free of contradictions. The sampling rate $f_s = 2.0 \\times 10^6\\,\\mathrm{Hz}$ satisfies the Nyquist criterion for the prefiltered signal bandwidth $W = 2.0 \\times 10^5\\,\\mathrm{Hz}$ ($f_s > 2W$).\n- **Objective:** The problem is stated in precise, quantitative, and unbiased language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n### Detailed Solution\n\n**1. Conceptual Explanation of Welch's Method**\n\nWelch's method provides an estimate of the Power Spectral Density (PSD), $S_{xx}(f)$, of a random process. The PSD quantifies the distribution of the signal's power as a function of frequency. The method involves three key steps:\n1.  The total data record of length $N_{\\mathrm{tot}}$ is divided into $K$ smaller segments of length $L$.\n2.  Each segment is multiplied by a window function, $w(n)$, to create a windowed segment. A periodogram (an estimate of the PSD) is then computed for each windowed segment.\n3.  The final PSD estimate, $\\hat{S}_{xx}(f)$, is obtained by averaging the $K$ individual periodograms.\n\n**Windowing** is employed to control **spectral leakage**. The Discrete Fourier Transform (DFT), used to compute the periodogram, inherently treats a finite data segment as one period of an infinitely repeating signal. This implicit periodicity can introduce sharp discontinuities at the segment boundaries, which convolves the true spectrum of the signal with the Fourier transform of the implicit rectangular window (a sinc function). The large sidelobes of the sinc function cause power from strong frequency components to \"leak\" into and obscure weaker, nearby frequency components. A tapered window function, such as the Hann window, smoothly reduces the signal amplitude to zero at the segment's endpoints. The Fourier transform of a Hann window has significantly lower sidelobes than that of a rectangular window, which drastically reduces spectral leakage. The trade-off is a wider main lobe, which implies a lower frequency resolution.\n\n**Overlap** is used to reduce the **variance** of the final PSD estimate. When a tapered window is applied, the data near the ends of each segment is down-weighted or effectively discarded. By overlapping consecutive segments (e.g., by $50\\%$), the data that was attenuated at the end of one segment is fully weighted at the center of the next segment. This practice allows for the recovery of information that would otherwise be lost in a non-overlapping scheme. While overlapping introduces correlation between the periodograms of adjacent segments, the averaging of a larger number of these correlated estimates still results in a greater variance reduction compared to averaging fewer, independent estimates from non-overlapping segments, for a fixed total data length.\n\n**2. Derivation of the Normalized Variance**\n\nLet the Welch PSD estimate be $\\hat{S}_{xx}(f) = \\frac{1}{K} \\sum_{k=1}^K I_k(f)$, where $I_k(f)$ is the periodogram of the $k$-th windowed segment. The variance of the estimator is:\n$$ \\mathrm{Var}[\\hat{S}_{xx}(f)] = \\mathrm{Var}\\left[\\frac{1}{K} \\sum_{k=1}^K I_k(f)\\right] = \\frac{1}{K^2} \\sum_{k=1}^K \\sum_{l=1}^K \\mathrm{Cov}[I_k(f), I_l(f)] $$\nFor a zero-mean, WSS Gaussian process with a locally flat spectrum $S_{xx}(f)$, the variance of a single periodogram (at frequencies not DC or Nyquist) is $\\mathrm{Var}[I_k(f)] \\approx S_{xx}^2(f)$. The covariance between periodograms of segments separated by $m=|k-l|$ hops is $\\mathrm{Cov}[I_k(f), I_l(f)] \\approx S_{xx}^2(f) |\\rho(m)|^2$, where $\\rho(m)$ is the normalized autocorrelation of the window function:\n$$ \\rho(m) = \\frac{\\sum_{n=0}^{L-1} w(n) w(n-mH)}{\\sum_{n=0}^{L-1} w(n)^2} $$\nSince the covariance depends only on the separation $m$, we can rewrite the variance sum:\n$$ \\mathrm{Var}[\\hat{S}_{xx}(f)] \\approx \\frac{S_{xx}^2(f)}{K^2} \\left[ K|\\rho(0)|^2 + 2\\sum_{m=1}^{K-1} (K-m) |\\rho(m)|^2 \\right] $$\nBy definition, $\\rho(0)=1$. For $50\\%$ overlap, the hop size is $H=L/2$. For a segment separation of $m=2$ hops, the shift is $mH=L$. For a window of length $L$, the functions $w(n)$ and $w(n-L)$ do not overlap, so their product is zero. Thus, $\\rho(m)=0$ for all $m \\geq 2$. The expression for variance simplifies to terms involving only adjacent segments ($m=1$).\nLet $c$ be the squared normalized inner product of adjacent shifted windows, which is the normalized covariance between adjacent periodograms: $c = |\\rho(1)|^2$. The variance is:\n$$ \\mathrm{Var}[\\hat{S}_{xx}(f)] \\approx \\frac{S_{xx}^2(f)}{K^2} \\left[ K + 2(K-1)c \\right] $$\nThe normalized variance is therefore:\n$$ \\frac{\\mathrm{Var}[\\hat{S}_{xx}(f)]}{S_{xx}^2(f)} \\approx \\frac{1}{K} + \\frac{2(K-1)}{K^2}c $$\nWe now compute $c$ for the Hann window, $w(n) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi n}{L}\\right)\\right)$, with $H=L/2$. Using large-$L$ asymptotics, sums are approximated by known exact results for the DFT-periodic version of the window for integer $L$.\nThe sum of squares of the window is:\n$$ \\sum_{n=0}^{L-1} w^2(n) = \\sum_{n=0}^{L-1} \\frac{1}{4}\\left(1 - \\cos\\left(\\frac{2\\pi n}{L}\\right)\\right)^2 = \\frac{1}{4}\\sum_{n=0}^{L-1}\\left(1-2\\cos\\left(\\frac{2\\pi n}{L}\\right)+\\frac{1}{2}\\left(1+\\cos\\left(\\frac{4\\pi n}{L}\\right)\\right)\\right) $$\nSince $\\sum_{n=0}^{L-1} \\cos(2\\pi kn/L)=0$ for integer $k$ not a multiple of $L$, this simplifies to $\\sum w^2(n) = \\frac{1}{4} \\sum \\frac{3}{2} = \\frac{3L}{8}$.\nThe inner product of adjacent windows is non-zero only over the overlapping region (for $n=L/2, \\dots, L-1$):\n$$ \\sum_{n=L/2}^{L-1} w(n)w(n-L/2) = \\sum_{n=L/2}^{L-1} \\frac{1}{2}\\left(1-\\cos\\frac{2\\pi n}{L}\\right) \\frac{1}{2}\\left(1+\\cos\\frac{2\\pi n}{L}\\right) = \\sum_{n=L/2}^{L-1} \\frac{1}{4}\\sin^2\\frac{2\\pi n}{L} $$\nThis equals $\\sum_{n=L/2}^{L-1} \\frac{1}{8}\\left(1-\\cos\\frac{4\\pi n}{L}\\right) = \\frac{1}{8}\\left(\\frac{L}{2} - \\sum_{n=L/2}^{L-1}\\cos\\frac{4\\pi n}{L}\\right)$. The sum of the cosine term is zero, yielding $\\frac{L}{16}$.\nSo, $\\rho(1) = \\frac{L/16}{3L/8} = \\frac{1}{6}$. The normalized covariance is $c = |\\rho(1)|^2 = \\left(\\frac{1}{6}\\right)^2 = \\frac{1}{36}$.\n\n**3. Effective Number of Independent Averages, $K_{\\mathrm{eff}}$**\n\nThe variance of an ideal estimator based on $K_{\\mathrm{eff}}$ independent averages would be $S_{xx}^2(f)/K_{\\mathrm{eff}}$. Equating this to the derived variance of the Welch estimator:\n$$ \\frac{S_{xx}^2(f)}{K_{\\mathrm{eff}}} = \\frac{S_{xx}^2(f)}{K^2} \\left[ K + 2(K-1)c \\right] $$\nSolving for $K_{\\mathrm{eff}}$ yields:\n$$ K_{\\mathrm{eff}} = \\frac{K^2}{K + 2(K-1)c} = \\frac{K}{1 + 2\\left(1-\\frac{1}{K}\\right)c} $$\nThis is the expression for the effective number of independent averages as a function of the total number of segments $K$ and the adjacent-segment covariance $c$.\n\n**4. Spectral Resolution Loss and Equivalent Noise Bandwidth (ENBW)**\n\nThe resolution loss due to windowing is quantified by the Equivalent Noise Bandwidth (ENBW), which measures the width of the window's main spectral lobe. For a discrete window, the ENBW, in units of frequency bins ($\\Delta f = f_s/L$), is given by:\n$$ \\beta = L \\frac{\\sum_{n=0}^{L-1} w^2(n)}{\\left(\\sum_{n=0}^{L-1} w(n)\\right)^2} $$\nFor a rectangular window, $w_R(n)=1$, so $\\sum w_R^2(n) = L$ and $\\sum w_R(n)=L$, thus $\\beta_R = L(L/L^2) = 1$ bin.\nFor the Hann window, we have $\\sum w^2(n) = 3L/8$. The sum of the window coefficients is $\\sum w(n) = \\sum \\frac{1}{2}(1 - \\cos(2\\pi n/L)) = \\frac{L}{2}$.\nThe ENBW for the Hann window, normalized to the rectangular window's ENBW, is:\n$$ \\beta_{\\mathrm{Hann}} = L \\frac{3L/8}{(L/2)^2} = L \\frac{3L/8}{L^2/4} = \\frac{12L^2}{8L^2} = \\frac{3}{2} = 1.5 $$\nThis means the Hann window degrades the frequency resolution by a factor of $1.5$ compared to an unwindowed (or rectangularly windowed) analysis.\n\n**5. Computation of the Figure of Merit $\\eta$**\n\nFirst, we compute the number of segments $K$ using the given parameters: $N_{\\mathrm{tot}} = 131072$, $L = 4096$, and $H = L/2 = 2048$.\n$$ K = \\left\\lfloor \\frac{N_{\\mathrm{tot}} - L}{H} \\right\\rfloor + 1 = \\left\\lfloor \\frac{131072 - 4096}{2048} \\right\\rfloor + 1 = \\left\\lfloor \\frac{126976}{2048} \\right\\rfloor + 1 = \\lfloor 62 \\rfloor + 1 = 63 $$\nNext, we compute the effective number of averages $K_{\\mathrm{eff}}$ using $K=63$ and $c=1/36$:\n$$ K_{\\mathrm{eff}} = \\frac{K}{1 + 2\\left(1-\\frac{1}{K}\\right)c} = \\frac{63}{1 + 2\\left(1-\\frac{1}{63}\\right)\\frac{1}{36}} = \\frac{63}{1 + 2\\left(\\frac{62}{63}\\right)\\frac{1}{36}} = \\frac{63}{1 + \\frac{62}{1134}} $$\n$$ K_{\\mathrm{eff}} = \\frac{63}{\\frac{1134+62}{1134}} = \\frac{63 \\times 1134}{1196} = \\frac{71442}{1196} \\approx 59.7341137 $$\nFinally, we compute the figure of merit $\\eta = K_{\\mathrm{eff}} / \\beta_{\\mathrm{Hann}}$:\n$$ \\eta = \\frac{59.7341137}{1.5} \\approx 39.8227425 $$\nRounding to four significant figures, we get $\\eta = 39.82$.",
            "answer": "$$\\boxed{39.82}$$"
        },
        {
            "introduction": "In many diagnostic applications, we are interested in a specific band of frequencies and need to eliminate contributions from others to isolate a physical phenomenon or prevent aliasing. This advanced practice guides you through the complete design process for a digital bandpass filter tailored to isolate a specific range of Alfvén wave frequencies . You will apply the bilinear transform with frequency prewarping and use the Chebyshev approximation to determine the minimal filter order required to meet demanding specifications.",
            "id": "4046301",
            "problem": "A Mirnov coil array on a tokamak measures magnetic fluctuations to diagnose shear Alfvén wave activity. The data are sampled by an Analog-to-Digital Converter (ADC) at sampling frequency $f_{s} = 2.0 \\times 10^{6}\\ \\mathrm{Hz}$, and subsequent spectral analysis aims to isolate the Alfvénic band between $f_{p1} = 80\\ \\mathrm{kHz}$ and $f_{p2} = 120\\ \\mathrm{kHz}$. To suppress magnetohydrodynamic (MHD) activity outside this band and to control spectral leakage and aliasing in downstream processing, you are tasked with designing a causal, stable, digital bandpass filter derived via the bilinear transform from an analog lowpass prototype.\n\nThe design requirements are:\n- Passband edges at $f_{p1} = 80\\ \\mathrm{kHz}$ and $f_{p2} = 120\\ \\mathrm{kHz}$, with maximum passband ripple $R_{p} = 0.2\\ \\mathrm{dB}$.\n- Stopband edges at $f_{s1} = 60\\ \\mathrm{kHz}$ and $f_{s2} = 140\\ \\mathrm{kHz}$ (above the passband), with minimum stopband attenuation $R_{s} = 60\\ \\mathrm{dB}$.\n- Use bilinear prewarping of frequency to account for the frequency mapping inherent in the bilinear transform.\n- Use a Chebyshev Type I approximation for the analog lowpass prototype and the standard bandpass-to-lowpass frequency transformation to assess the worst-case stopband separation.\n\nStarting from the sampling theorem, the bilinear transform definition, and the Chebyshev Type I magnitude characteristics, derive the minimal filter order of the resulting digital bandpass Infinite Impulse Response (IIR) filter. Your derivation must explicitly perform frequency prewarping and the bandpass-to-lowpass mapping to obtain the lowpass prototype order and then account for the order multiplication incurred by the bandpass transformation. Provide the final answer as the minimal integer order of the digital bandpass filter. No rounding by significant figures is necessary; report the exact integer.",
            "solution": "The objective is to determine the minimal integer order of a digital bandpass filter based on a Chebyshev Type I analog lowpass prototype, designed using the bilinear transform with frequency prewarping. The derivation proceeds in four main steps:\n1. Prewarping the digital frequency specifications to the analog domain.\n2. Transforming the analog bandpass specifications to an equivalent analog lowpass prototype's specifications.\n3. Calculating the required order of the analog lowpass prototype.\n4. Determining the final order of the digital bandpass filter.\n\nFirst, we compile the given design specifications:\n- Sampling frequency: $f_s = 2.0 \\times 10^6\\ \\mathrm{Hz}$. The sampling period is $T_s = 1/f_s = 0.5 \\times 10^{-6}\\ \\mathrm{s}$.\n- Passband edges: $f_{p1} = 80\\ \\mathrm{kHz} = 80 \\times 10^3\\ \\mathrm{Hz}$, $f_{p2} = 120\\ \\mathrm{kHz} = 120 \\times 10^3\\ \\mathrm{Hz}$.\n- Stopband edges: $f_{s1} = 60\\ \\mathrm{kHz} = 60 \\times 10^3\\ \\mathrm{Hz}$, $f_{s2} = 140\\ \\mathrm{kHz} = 140 \\times 10^3\\ \\mathrm{Hz}$.\n- Maximum passband ripple: $R_p = 0.2\\ \\mathrm{dB}$.\n- Minimum stopband attenuation: $R_s = 60\\ \\mathrm{dB}$.\n\n**Step 1: Frequency Prewarping**\nThe bilinear transform relates the digital frequency $\\omega \\in [-\\pi, \\pi]$ to the analog frequency $\\Omega$ by the mapping $s = \\frac{2}{T_s} \\frac{1-z^{-1}}{1+z^{-1}}$. For a sinusoidal steady state, where $s=j\\Omega$ and $z=e^{j\\omega}$, this implies $\\Omega = \\frac{2}{T_s} \\tan(\\frac{\\omega}{2})$. Since the digital frequency is related to the continuous-time frequency $f$ by $\\omega = 2\\pi f / f_s$, we can prewarp the critical digital frequencies ($f_{p1}$, $f_{p2}$, $f_{s1}$, $f_{s2}$) to their corresponding analog counterparts:\n$$ \\Omega = \\frac{2}{T_s} \\tan\\left(\\frac{2\\pi f}{2 f_s}\\right) = \\frac{2}{T_s} \\tan\\left(\\frac{\\pi f}{f_s}\\right) $$\nWith $T_s = 0.5 \\times 10^{-6}\\ \\mathrm{s}$, the prewarping factor is $\\frac{2}{T_s} = 4.0 \\times 10^6\\ \\mathrm{s}^{-1}$. The prewarped analog frequencies are:\n- $\\Omega_{p1} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 80 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.04\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{p2} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 120 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.06\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{s1} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 60 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.03\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{s2} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 140 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.07\\pi)\\ \\mathrm{rad/s}$\n\n**Step 2: Analog Bandpass to Lowpass Transformation**\nThe analog bandpass filter specifications must be transformed into specifications for a normalized lowpass prototype. The standard frequency mapping is given by $\\Omega_{LP} = \\frac{\\Omega_{BP}^2 - \\Omega_0^2}{B \\Omega_{BP}}$, where $\\Omega_0 = \\sqrt{\\Omega_{p1}\\Omega_{p2}}$ is the geometric center frequency and $B = \\Omega_{p2} - \\Omega_{p1}$ is the passband bandwidth of the analog bandpass filter.\nThis transformation maps the bandpass passband $[\\Omega_{p1}, \\Omega_{p2}]$ to the lowpass prototype passband $[-1, 1]$. Thus, the lowpass prototype passband edge is $\\Omega_{LP,p} = 1\\ \\mathrm{rad/s}$.\n\nWe must determine the corresponding stopband frequency for the lowpass prototype, $\\Omega_{LP,s}$. The two bandpass stopband edges, $\\Omega_{s1}$ and $\\Omega_{s2}$, map to two frequencies in the lowpass domain:\n$$ \\Omega_1 = \\frac{\\Omega_{s1}^2 - \\Omega_0^2}{B \\Omega_{s1}} = \\frac{\\Omega_{s1}^2 - \\Omega_{p1}\\Omega_{p2}}{(\\Omega_{p2}-\\Omega_{p1})\\Omega_{s1}} $$\n$$ \\Omega_2 = \\frac{\\Omega_{s2}^2 - \\Omega_0^2}{B \\Omega_{s2}} = \\frac{\\Omega_{s2}^2 - \\Omega_{p1}\\Omega_{p2}}{(\\Omega_{p2}-\\Omega_{p1})\\Omega_{s2}} $$\nThe lowpass prototype must satisfy the stopband attenuation requirement for all frequencies $|\\Omega| \\ge \\Omega_{LP,s}$. The stricter constraint corresponds to the narrowest transition band, i.e., the stopband frequency magnitude that is closest to the passband edge magnitude of $1$. This is given by $\\Omega_{LP,s} = \\min(|\\Omega_1|, |\\Omega_2|)$.\nSubstituting the expressions for the warped frequencies (the common factor of $4.0 \\times 10^6$ cancels out):\n$$ \\Omega_1 = \\frac{\\tan^2(0.03\\pi) - \\tan(0.04\\pi)\\tan(0.06\\pi)}{[\\tan(0.06\\pi) - \\tan(0.04\\pi)]\\tan(0.03\\pi)} \\approx \\frac{(0.094914)^2 - (0.126868)(0.190983)}{[0.190983 - 0.126868](0.094914)} \\approx -2.5025 $$\n$$ \\Omega_2 = \\frac{\\tan^2(0.07\\pi) - \\tan(0.04\\pi)\\tan(0.06\\pi)}{[\\tan(0.06\\pi) - \\tan(0.04\\pi)]\\tan(0.07\\pi)} \\approx \\frac{(0.223866)^2 - (0.126868)(0.190983)}{[0.190983 - 0.126868](0.223866)} \\approx 1.8039 $$\nThe critical stopband frequency for the lowpass prototype is $\\Omega_{LP,s} = \\min(|-2.5025|, 1.8039) = 1.8039\\ \\mathrm{rad/s}$.\n\n**Step 3: Chebyshev Lowpass Prototype Order Calculation**\nFor a Chebyshev Type I filter, the required order $N_{LP}$ is given by the formula:\n$$ N_{LP} \\ge \\frac{\\arccosh\\left(\\frac{\\sqrt{A^2-1}}{\\epsilon}\\right)}{\\arccosh\\left(\\frac{\\Omega_{LP,s}}{\\Omega_{LP,p}}\\right)} $$\nThe parameter $\\epsilon$ is related to the passband ripple $R_p = 0.2\\ \\mathrm{dB}$:\n$$ \\epsilon = \\sqrt{10^{R_p/10} - 1} = \\sqrt{10^{0.2/10} - 1} = \\sqrt{10^{0.02} - 1} \\approx 0.21709 $$\nThe parameter $A$ is related to the stopband attenuation $R_s = 60\\ \\mathrm{dB}$:\n$$ A = 10^{R_s/20} = 10^{60/20} = 10^3 = 1000 $$\nNow, we can compute the numerator and denominator for the order formula.\nThe argument of the numerator's $\\arccosh$ function is:\n$$ \\frac{\\sqrt{A^2-1}}{\\epsilon} = \\frac{\\sqrt{1000^2 - 1}}{\\sqrt{10^{0.02} - 1}} \\approx \\frac{999.9995}{0.21709} \\approx 4606.32 $$\nThe argument of the denominator's $\\arccosh$ function is the selectivity factor:\n$$ \\frac{\\Omega_{LP,s}}{\\Omega_{LP,p}} = \\frac{1.8039}{1} = 1.8039 $$\nUsing the identity $\\arccosh(x) = \\ln(x + \\sqrt{x^2 - 1})$:\n$$ N_{LP} \\ge \\frac{\\arccosh(4606.32)}{\\arccosh(1.8039)} = \\frac{\\ln(4606.32 + \\sqrt{4606.32^2 - 1})}{\\ln(1.8039 + \\sqrt{1.8039^2 - 1})} \\approx \\frac{\\ln(9212.64)}{1.1955} \\approx \\frac{9.1283}{1.1955} \\approx 7.6358 $$\nSince the filter order must be an integer, we must take the ceiling of this value:\n$$ N_{LP} = \\lceil 7.6358 \\rceil = 8 $$\n\n**Step 4: Final Digital Bandpass Filter Order**\nThe transformation from a lowpass prototype filter of order $N_{LP}$ to a bandpass filter is achieved by the substitution $s \\rightarrow \\frac{s^2+\\Omega_0^2}{Bs}$. This substitution replaces each pole and zero of the lowpass transfer function with a pair of poles and zeros, effectively doubling the filter order. Thus, the order of the analog bandpass filter is $N_{BP} = 2 \\times N_{LP} = 2 \\times 8 = 16$.\nThe bilinear transform maps a rational transfer function in the $s$-domain of order $N$ to a rational transfer function in the $z$-domain of the same order $N$. Therefore, the order of the final digital bandpass filter is the same as the order of the intermediate analog bandpass filter.\nThe minimal integer order of the digital bandpass filter is $N_{digital} = N_{BP} = 16$.",
            "answer": "$$\\boxed{16}$$"
        }
    ]
}