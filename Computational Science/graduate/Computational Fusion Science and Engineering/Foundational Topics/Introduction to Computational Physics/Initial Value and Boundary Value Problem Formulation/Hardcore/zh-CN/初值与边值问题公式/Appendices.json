{
    "hands_on_practices": [
        {
            "introduction": "对于像理想磁流体力学（MHD）这样的双曲型系统，边界条件的设置并非任意，而是由信息传播的物理学决定的。本练习将指导您分析特征波，根据等离子体的局部状态（如马赫数$M$和贝塔值$\\beta$）来确定在边界上必须提供多少信息，从而确保初边值问题的适定性。",
            "id": "3996424",
            "problem": "在理想可压缩磁流体力学 (MHD) 中，考虑一个位于 $x=0$ 的一维平面边界，其计算域为 $\\Omega=\\{x>0\\}$。一个空间均匀的等离子体，其密度为 $\\rho_{0}$、压强为 $p_{0}$、绝热指数为 $\\gamma$，以及一个与 $x$ 方向对齐的均匀磁场 $\\mathbf{B}_{0}=B_{0}\\,\\hat{\\mathbf{x}}$，以恒定的法向速度 $U>0$ 沿 $+\\hat{\\mathbf{x}}$ 方向流入该域。控制方程为理想可压缩 MHD 的守恒律，以及螺线管约束 $\\nabla\\cdot\\mathbf{B}=0$ 和一个与理想气体一致的热力学闭合关系，使得绝热声速为 $c_{s}=\\sqrt{\\gamma p/\\rho}$。\n\n您将通过确定哪些特征是从边界传入 $\\Omega$ 的，来分析 $x=0$ 处的特征边界条件。请使用以下无量纲化方法：以参考声速 $c_{s0}=\\sqrt{\\gamma p_{0}/\\rho_{0}}$ 对所有速度进行标度，定义马赫数 $M=U/c_{s0}$，并定义等离子体 beta 值 $\\beta=2\\mu_{0}p_{0}/B_{0}^{2}$，其中 $\\mu_{0}$ 是真空磁导率。假设扰动沿磁场平行传播（波矢与 $\\hat{\\mathbf{x}}$ 对齐），并仅关注沿边界法向的线性化特征速度。\n\n任务：\n1) 从守恒律和理想感应方程出发，围绕均匀态 $(\\rho_{0},p_{0},\\mathbf{u}_{0}=U\\hat{\\mathbf{x}},\\mathbf{B}_{0}=B_{0}\\hat{\\mathbf{x}})$ 进行线性化，并论证沿边界法向，一维理想 MHD 系统有七个特征波，其相速度形式为 $u_{n}\\pm c_{f}$、$u_{n}\\pm c_{a}$、$u_{n}\\pm c_{s}$ 和 $u_{n}$，其中 $u_{n}$ 是法向流速，$c_{s}$ 是绝热声速，$c_{a}$ 是阿尔芬速度 $c_{a}=B/\\sqrt{\\mu_{0}\\rho}$。然后，使用 $c_{s0}$ 作为速度标度，以无量纲形式表示这些特征速度，并用 $\\gamma$ 和 $\\beta$ 表示比值 $a=c_{a}/c_{s}$。\n\n2) 法向被选择为指向计算域内部（即沿 $+\\hat{\\mathbf{x}}$ 方向），如果一个特征沿 $+\\hat{\\mathbf{x}}$ 的无量纲速度为正，则将其定义为传入特征。使用您在第 (1) 部分得到的无量纲特征值，建立用 $M$ 和 $a$ 表示的符号条件，以确定哪些特征是传入的。\n\n3) 对于特定参数 $\\gamma=\\frac{5}{3}$、$\\beta=0.5$ 和 $M=0.8$，计算在域 $\\Omega=\\{x>0\\}$ 中，$x=0$ 处的传入特征数量。请以纯数字形式提供最终答案。不需要单位。如果需要任何数值近似，请对中间步骤进行一致的四舍五入，但最终的整数计数必须精确，无需四舍五入指令。",
            "solution": "首先将根据指定标准验证问题陈述。\n\n### 第 1 步：提取已知条件\n- 计算域：$\\Omega=\\{x>0\\}$，在 $x=0$ 处有平面边界。\n- 物理模型：一维理想可压缩磁流体力学 (MHD)。\n- 控制方程：理想可压缩 MHD 的守恒律，$\\nabla\\cdot\\mathbf{B}=0$，以及理想气体热力学闭合关系 $c_{s}=\\sqrt{\\gamma p/\\rho}$。\n- 背景态（均匀）：密度 $\\rho_{0}$，压强 $p_{0}$，速度 $\\mathbf{u}_{0}=U\\hat{\\mathbf{x}}$ (其中 $U>0$)，磁场 $\\mathbf{B}_{0}=B_{0}\\,\\hat{\\mathbf{x}}$。\n- 无量纲化：速度以参考声速 $c_{s0}=\\sqrt{\\gamma p_{0}/\\rho_{0}}$ 进行标度。马赫数 $M=U/c_{s0}$。等离子体 beta 值 $\\beta=2\\mu_{0}p_{0}/B_{0}^{2}$。\n- 假设：扰动沿磁场平行传播。分析仅限于沿边界法向 ($+\\hat{\\mathbf{x}}$) 的线性化特征速度。\n- 任务 1：论证一维理想 MHD 系统有七个特征波，其速度形式为 $u_{n}\\pm c_{f}$、$u_{n}\\pm c_{a}$、$u_{n}\\pm c_{s}$ 和 $u_{n}$。以无量纲形式表示这些速度。用 $\\gamma$ 和 $\\beta$ 表示比值 $a=c_{a}/c_{s}$。\n- 任务 2：为传入特征（定义为沿 $+\\hat{\\mathbf{x}}$ 速度为正）建立符号条件。\n- 任务 3：对于 $\\gamma=\\frac{5}{3}$、$\\beta=0.5$ 和 $M=0.8$，计算传入特征的数量。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上基于成熟的理想 MHD 理论，这是等离子体物理和计算聚变科学的基石。问题是适定的，提供了一个清晰的背景态，并要求进行标准的特征分析。术语精确且客观。\n\n任务 1 中对特征速度的描述“$u_{n}\\pm c_{f}$、$u_{n}\\pm c_{a}$、$u_{n}\\pm c_{s}$ 和 $u_{n}$”中存在一个潜在的混淆点。在一般的一维 MHD 中，存在七个特征波：快磁声波 ($u_n \\pm c_f$)、慢磁声波 ($u_n \\pm c_s$)、阿尔芬波 ($u_n \\pm c_a$) 和熵波 ($u_n$)。然而，对于问题中规定的特定情况——平行传播——这些模式并非全部不同。快、慢模式退化为纯声波和纯阿尔芬波。仔细分析表明，这七个速度的集合实际上是 $\\{u_n, u_n \\pm c_s, u_n \\pm c_a, u_n \\pm c_a\\}$，这对应于一个熵波、两个声波和两对退化的阿尔芬波。问题陈述要求“论证”这一点，这意味着解释这种退化性是任务的一部分。这是物理学中的一个微妙之处，并非问题陈述的缺陷。因此，该问题是自洽且内部一致的。它没有违反任何无效标准。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n分析始于线性化一维理想 MHD 方程。对于仅在 $x$ 方向上存在变化的情况，原始变量的状态向量 $\\mathbf{W} = (\\rho, u_x, u_y, u_z, B_y, B_z, p)^T$ 的系统可以写成 $\\partial_t \\mathbf{W} + \\mathbf{A}(\\mathbf{W}) \\partial_x \\mathbf{W} = 0$。条件 $\\nabla\\cdot\\mathbf{B}=0$ 意味着 $\\partial_x B_x=0$，所以 $B_x$ 是一个常数参数，$B_x=B_0$。我们围绕均匀背景态 $\\mathbf{W}_0 = (\\rho_0, U, 0, 0, 0, 0, p_0)^T$ 进行线性化。特征速度是雅可比矩阵 $\\mathbf{A}_0 = \\mathbf{A}(\\mathbf{W}_0)$ 的特征值。对于这个背景态，该矩阵为：\n$$\n\\mathbf{A}_0 = \\begin{pmatrix}\nU  \\rho_0  0  0  0  0  0 \\\\\n0  U  0  0  0  0  1/\\rho_0 \\\\\n0  0  U  0  -B_0/(\\mu_0\\rho_0)  0  0 \\\\\n0  0  0  U  0  -B_0/(\\mu_0\\rho_0)  0 \\\\\n0  0  -B_0  0  U  0  0 \\\\\n0  0  0  -B_0  0  U  0 \\\\\n0  \\gamma p_0  0  0  0  0  U\n\\end{pmatrix}\n$$\n特征值 $\\lambda$ 由 $\\det(\\mathbf{A}_0 - \\lambda \\mathbf{I}) = 0$ 求得。该矩阵是块对角的，这简化了计算。\n\n一个 $3 \\times 3$ 的块描述了通过 $(\\delta\\rho, \\delta u_x, \\delta p)$ 耦合的纵波：\n$$ \\det \\begin{pmatrix} U-\\lambda  \\rho_0  0 \\\\ 0  U-\\lambda  1/\\rho_0 \\\\ 0  \\gamma p_0  U-\\lambda \\end{pmatrix} = (U-\\lambda)((U-\\lambda)^2 - \\frac{\\gamma p_0}{\\rho_0}) = 0 $$\n这给出了特征值 $\\lambda = U$ 和 $\\lambda = U \\pm \\sqrt{\\gamma p_0/\\rho_0}$。它们对应于熵波 ($\\lambda = U$) 和两个声波 ($\\lambda = U \\pm c_{s0}$)，其中 $c_{s0}=\\sqrt{\\gamma p_0/\\rho_0}$ 是背景等离子体中的声速。\n\n两个相同的 $2 \\times 2$ 块描述了横波。第一个块耦合了 $(\\delta u_y, \\delta B_y)$，给出：\n$$ \\det \\begin{pmatrix} U-\\lambda  -B_0/(\\mu_0\\rho_0) \\\\ -B_0  U-\\lambda \\end{pmatrix} = (U-\\lambda)^2 - \\frac{B_0^2}{\\mu_0\\rho_0} = 0 $$\n这给出了特征值 $\\lambda = U \\pm \\sqrt{B_0^2/(\\mu_0\\rho_0)}$。这就是两个阿尔芬波，以速度 $U \\pm c_{a0}$ 传播，其中 $c_{a0} = |B_0|/\\sqrt{\\mu_0\\rho_0}$ 是阿尔芬速度。第二个块，对应 $(\\delta u_z, \\delta B_z)$，是相同的，并产生相同的特征值对，对应于阿尔芬波的另一个偏振方向。\n\n因此，七个特征速度是：$\\lambda = U$（熵波），$\\lambda = U \\pm c_{s0}$（声波），以及 $\\lambda = U \\pm c_{a0}$（阿尔芬波，二重）。\n\n问题要求将此与一般的 MHD 波模（快波、慢波、阿尔芬波）联系起来。对于任意传播角度，快、慢磁声速是不同的。然而，对于完全平行于磁场的传播（如此处情况），模式解耦。纵向运动是纯声波，横向运动是纯阿尔芬波。在此极限下，一般的磁声速发生退化。具体来说，快磁声速变为 $c_f = \\max(c_{s0}, c_{a0})$，慢磁声速变为 $c_s = \\min(c_{s0}, c_{a0})$。中间（阿尔芬）波速保持为 $c_a = c_{a0}$。因此，速度集合 $\\{U \\pm c_f, U \\pm c_s, U \\pm c_a\\}$ 变为 $\\{U \\pm \\max(c_{s0}, c_{a0}), U \\pm \\min(c_{s0}, c_{a0}), U \\pm c_{a0}\\}$，这仅仅是对 $\\{U \\pm c_{s0}, U \\pm c_{a0}, U \\pm c_{a0}\\}$ 的重新标记。七个波确实存在，但其速度存在退化。这提供了任务 1 所要求的论证。\n\n法向流速为 $u_n=U$。七个特征速度为 $U$、$U \\pm c_{s0}$ 和 $U \\pm c_{a0}$（二重）。我们通过除以 $c_{s0}$ 来进行无量纲化。设 $\\lambda'$ 为无量纲速度。\n无量纲速度为：\n1. 熵波：$\\lambda'_1 = U/c_{s0} = M$。\n2. 声波：$\\lambda'_{2,3} = (U \\pm c_{s0})/c_{s0} = M \\pm 1$。\n3. 阿尔芬波（两个偏振方向）：$\\lambda'_{4,5,6,7} = (U \\pm c_{a0})/c_{s0} = M \\pm a$，其中 $a=c_{a0}/c_{s0}$。\n\n现在我们用 $\\gamma$ 和 $\\beta$ 表示 $a$：\n$$ a^2 = \\frac{c_{a0}^2}{c_{s0}^2} = \\frac{B_0^2/(\\mu_0\\rho_0)}{\\gamma p_0/\\rho_0} = \\frac{B_0^2}{\\mu_0 \\gamma p_0} $$\n给定 $\\beta = 2\\mu_0 p_0 / B_0^2$，我们可以写出 $B_0^2/(\\mu_0 p_0) = 2/\\beta$。将此代入 $a^2$ 的表达式中：\n$$ a^2 = \\frac{1}{\\gamma} \\left(\\frac{B_0^2}{\\mu_0 p_0}\\right) = \\frac{2}{\\gamma \\beta} $$\n\n所以，$a = \\sqrt{\\frac{2}{\\gamma \\beta}}$。这完成了任务 1。\n\n对于任务 2，我们确定特征为“传入”的条件。计算域是 $\\Omega=\\{x>0\\}$，所以指向域内的法向是 $+\\hat{\\mathbf{x}}$。如果一个特征沿此方向的传播速度为正，即 $\\lambda > 0$，则该特征是传入的，这等价于无量纲速度为正，$\\lambda' > 0$。流体流入域内，所以 $U>0$，这意味着 $M=U/c_{s0}>0$。参数 $\\gamma$ 和 $\\beta$ 是正的，所以 $a>0$。\n\n我们检查七个无量纲速度中每一个的符号：\n1. $\\lambda' = M$：由于 $M>0$，这个波总是传入的。\n2. $\\lambda' = M+1$：由于 $M>0$，这个值总是正的，因此是传入的。\n3. $\\lambda' = M-1$：如果 $M-1>0$，即 $M>1$，则该值为正。\n4. $\\lambda' = M+a$：由于 $M>0$ 和 $a>0$，这个值总是正的，因此是传入的。这适用于两个阿尔芬波偏振，因此是两个波。\n5. $\\lambda' = M-a$：如果 $M-a>0$，即 $M>a$，则该值为正。这适用于两个阿尔芬波偏振，因此可能是两个波。\n\n传入特征的数量由条件 $M>1$ 和 $M>a$ 决定。数量为 $1 (\\text{对于 } M) + 1 (\\text{对于 } M+1) + I(M>1) + 2 (\\text{对于 } M+a) + 2 \\cdot I(M>a)$，其中 $I(\\cdot)$ 是指示函数，如果条件为真则为 $1$，否则为 $0$。总数为 $4 + I(M>1) + 2 \\cdot I(M>a)$。\n\n对于任务 3，我们使用特定参数 $\\gamma=\\frac{5}{3}$、$\\beta=0.5$ 和 $M=0.8$。\n首先，我们计算无量纲阿尔芬速度 $a$：\n$$ a = \\sqrt{\\frac{2}{\\gamma \\beta}} = \\sqrt{\\frac{2}{(\\frac{5}{3})(0.5)}} = \\sqrt{\\frac{2}{5/6}} = \\sqrt{\\frac{12}{5}} $$\n数值上，$a^2 = 2.4$，所以 $a = \\sqrt{2.4} \\approx 1.549$。\n\n现在我们用 $M=0.8$ 检查任务 2 中的条件：\n- $M>1$ 吗？$0.8>1$ 吗？不是。\n- $M>a$ 吗？$0.8 > \\sqrt{12/5}$ 吗？由于 $M^2 = 0.8^2 = 0.64$ 且 $a^2=2.4$，我们有 $M^2  a^2$，并且因为 $M$ 和 $a$ 都是正数，所以 $M  a$。所以条件不满足。\n\n我们现在可以通过检查七个速度中每一个的符号来计算传入特征的数量：\n1. $\\lambda' = M = 0.8$：正，传入。\n2. $\\lambda' = M+1 = 0.8+1 = 1.8$：正，传入。\n3. $\\lambda' = M-1 = 0.8-1 = -0.2$：负，传出。\n4. $\\lambda' = M+a = 0.8+\\sqrt{2.4}$：正，传入。这计为两个波。\n5. $\\lambda' = M-a = 0.8-\\sqrt{2.4}$：负，传出。这计为两个波。\n\n传入的特征是熵波 ($M$)、正向传播的声波 ($M+1$) 和两个正向传播的阿尔芬波 ($M+a$)。\n传入特征总数 = $1 + 1 + 2 = 4$。\n\n或者，使用任务 2 中的公式：\n传入波数 = $4 + I(0.81) + 2 \\cdot I(0.8\\sqrt{2.4}) = 4 + 0 + 2 \\cdot 0 = 4$。\n结果是一致的。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "在确定了边界上需要指定哪些物理量后，下一个关键问题是如何在离散化的数值格式中精确地施加这些条件。本练习将探讨两种主流方法——强施加法和罚函数法（一种弱施加形式）——在有限元和谱方法背景下的应用，并帮助您理解它们在精度、收敛性和系统条件数方面的权衡。",
            "id": "3996410",
            "problem": "一个用于聚变装置边缘区域的一维跨场热传导模型被构建在区间 $\\Omega = (0,1)$ 上，其温度分布 $u(x)$ 是一个边值问题\n$$\n-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right) = s(x), \\quad x \\in (0,1), \\qquad u(0) = g_0, \\quad u(1) = g_1,\n$$\n其中 $k(x) \\ge k_{\\min}  0$ 代表有效热导率，$s(x)$ 是一个光滑的体积源项。考虑在计算聚变科学与工程中用于初边值问题求解器的两类空间离散化方法：在尺寸为 $h$ 的网格上使用多项式次数为 $p \\ge 1$ 的协调有限元方法，以及在具有 $N+1$ 个节点的 Chebyshev–Gauss–Lobatto 点上使用谱配置法。\n\n对于有限元方法，令 $V_h \\subset H^1(\\Omega)$ 为协调空间，并定义对称双线性形式\n$$\na(u,v) = \\int_0^1 k(x)\\, u'(x)\\, v'(x)\\, dx,\n$$\n和线性形式\n$$\n\\ell(v) = \\int_0^1 s(x)\\, v(x)\\, dx.\n$$\n考虑施加 Dirichlet 边界条件的两种策略：\n- 强施加：将试探空间限制为 $V_h^g = \\{ v_h \\in V_h \\mid v_h(0) = g_0,\\ v_h(1) = g_1 \\}$，测试空间限制为 $V_h^0 = \\{ v_h \\in V_h \\mid v_h(0)=0,\\ v_h(1)=0 \\}$，并对所有 $v_h \\in V_h^0$ 求解 $a(u_h,v_h) = \\ell(v_h)$。\n- 罚函数法施加：对试探函数和测试函数均使用无约束空间 $V_h$，并求解\n$$\na(u_h,v_h) + \\alpha \\left[u_h(0)v_h(0) + u_h(1)v_h(1)\\right] = \\ell(v_h) + \\alpha \\left[g_0 v_h(0) + g_1 v_h(1)\\right] \\quad \\text{对所有 } v_h \\in V_h,\n$$\n其中罚参数 $\\alpha  0$。\n\n对于谱配置法，令映射到 $\\Omega$ 上的 Chebyshev–Gauss–Lobatto 点为 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$，$j=0,\\ldots,N$，并令 $D$ 和 $D^{(2)}$ 表示一阶和二阶 Chebyshev 微分矩阵。考虑施加 Dirichlet 边界条件的两种策略：\n- 强施加：将端点未知数设置为给定值，$u(x_0) = g_1$ 和 $u(x_N) = g_0$，并在 $j=1,\\ldots,N-1$ 上求解内部配置方程 $-\\left(k D u\\right)' = s$。\n- 罚函数 (tau) 施加：保留所有 $N+1$ 个未知数，并通过在端点方程中添加罚项 $\\tau \\left(u(x_0) - g_1\\right)$ 和 $\\tau \\left(u(x_N) - g_0\\right)$ 来增广离散系统，其中罚参数 $\\tau  0$。\n\n从基本原理出发，使用有限元方法的弱形式和谱配置法的离散算子缩放，来推断这两种边界施加策略的一致性、收敛性和条件数性质。以下哪个陈述是正确的？\n\nA. 对于有限元罚函数法，当罚参数 $\\alpha$ 是一个与 $h$ 无关的固定值时，该方法与原始 Dirichlet 问题是一致的，并且在能量范数下能达到与强施加法相同的最优收敛阶。\n\nB. 在有限元罚函数法中，为了恢复能量范数下的最优收敛性，罚参数必须以 $\\alpha \\sim c\\, h^{-1}$ 的形式增长（或相对于 $h$ 更快），否则边界一致性误差会限制精度。\n\nC. 对于使用 tau 罚函数法的谱配置法，对这个二阶问题选择与 $N^2$ 成正比的 $\\tau$ 可以保持光滑解的谱（指数）收敛性，而过小的 $\\tau$ 会产生一个与 $N$ 无关的 $\\mathcal{O}\\!\\left(\\tau^{-1}\\right)$ 饱和误差。\n\nD. 在谱配置法中，于边界节点处强施加边界条件不会降低谱精度，并且比使用非常大的 tau 罚函数能产生更好的条件数。\n\nE. 在有限元方法中，与使用大 $\\alpha$ 的罚函数法相比，强施加 Dirichlet 边界条件会降低刚度矩阵的全局条件数。",
            "solution": "问题陈述已经过验证，被认为是合理的。它描述了一个良定的一维热传导边值问题，并提出了求解该问题的标准数值方法：有限元方法 (FEM) 和谱配置法。问题关注在每种方法中施加 Dirichlet 边界条件的两种常见策略的性质：强施加法和罚函数/tau 施加法。我们将基于偏微分方程数值分析的既定原理来分析每个陈述。\n\n控制边值问题为：\n$$\n-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right) = s(x), \\quad x \\in (0,1),\n$$\n边界条件为 $u(0)=g_0$ 和 $u(1)=g_1$。有限元方法所源于的弱形式是：寻找 $u \\in H^1(\\Omega)$ 且满足 $u(0)=g_0$ 和 $u(1)=g_1$，使得对于所有测试函数 $v \\in H_0^1(\\Omega) = \\{ v \\in H^1(\\Omega) \\mid v(0)=0, v(1)=0 \\}$，下式成立：\n$$\na(u,v) = \\int_0^1 k(x) u'(x) v'(x) dx = \\int_0^1 s(x) v(x) dx = \\ell(v)\n$$\n\n**A. 对于有限元罚函数法，当罚参数 $\\alpha$ 是一个与 $h$ 无关的固定值时，该方法与原始 Dirichlet 问题是一致的，并且在能量范数下能达到与强施加法相同的最优收敛阶。**\n\n我们来分析一致性和收敛性。罚函数法公式为：寻找 $u_h \\in V_h$ 使得\n$$\na(u_h,v_h) + \\alpha \\left[u_h(0)v_h(0) + u_h(1)v_h(1)\\right] = \\ell(v_h) + \\alpha \\left[g_0 v_h(0) + g_1 v_h(1)\\right]\n$$\n对所有 $v_h \\in V_h$ 成立。为了检验一致性，我们将精确解 $u$ 代入离散形式。由于 $a(u,v_h) = \\ell(v_h)$ 且 $u(0)=g_0$，$u(1)=g_1$，我们发现精确解 $u$ 满足罚函数方程。在这种形式意义上，该方法是一致的。\n\n然而，该陈述的关键部分是关于达到最优收敛阶。误差 $e_h = u - u_h$ 不满足边界条件，即 $e_h(0) \\ne 0$ 且 $e_h(1) \\ne 0$。罚函数法仅近似地施加边界条件。误差分析（例如，使用 Strang 第二引理处理变分犯罪）表明，总误差由一个逼近误差项和一个由边界条件不精确满足而引起的一致性误差项组成。此边界一致性误差与罚参数 $\\alpha$ 成反比。如果 $\\alpha$ 是一个与网格尺寸 $h$ 无关的固定常数，那么当 $h \\to 0$ 时，这个误差项不会消失。它会产生一个误差平台，或误差饱和，从而阻止该方法达到最优收敛阶。例如，能量范数下的误差 $||u-u_h||_a$ 将受限于一个不趋于零的项，因此失去了 $\\mathcal{O}(h^p)$ 的最优收敛率。\n\n因此，该方法能达到与强施加法相同的最优收敛阶的陈述是错误的。\n\n结论：**不正确**。\n\n**B. 在有限元罚函数法中，为了恢复能量范数下的最优收敛性，罚参数必须以 $\\alpha \\sim c\\, h^{-1}$ 的形式增长（或相对于 $h$ 更快），否则边界一致性误差会限制精度。**\n\n这个陈述准确地描述了对陈述 A 分析中发现的问题的补救措施。所描述的罚函数法是 Nitsche's 方法的一种形式。对 Nitsche 型方法的严格误差分析要求平衡误差估计中的各项。这种平衡涉及来自有限元空间的标准逼近误差和源于边界的项。为确保稳定性并控制边界一致性误差，需要使用有限元空间上的一个反不等式，该不等式表明对于函数 $v_h \\in V_h$，在边界单元 $E$ 上有 $|v_h(x)|^2 \\le C h^{-1} ||v_h||_{L^2(E)}^2$。为了主导这个 $h^{-1}$ 缩放并足够强地施加边界条件以不污染全局误差，罚参数 $\\alpha$ 必须选择得足够大。正确的缩放是 $\\alpha = \\gamma/h$，其中 $\\gamma$ 是一个足以保证稳定性的常数。通过这种选择，边界一致性误差被控制，使得总误差以最优速率收敛，例如，假设解具有足够的正则性，对于次数为 $p$ 的多项式，在能量范数下为 $\\mathcal{O}(h^p)$。如果 $\\alpha$ 太小（例如，常数或增长慢于 $h^{-1}$），边界误差将占主导地位并限制整体精度。\n\n结论：**正确**。\n\n**C. 对于使用 tau 罚函数法的谱配置法，对这个二阶问题选择与 $N^2$ 成正比的 $\\tau$ 可以保持光滑解的谱（指数）收敛性，而过小的 $\\tau$ 会产生一个与 $N$ 无关的 $\\mathcal{O}\\!\\left(\\tau^{-1}\\right)$ 饱和误差。**\n\n在谱方法中，微分矩阵的元素和范数随节点数 $N$ 缩放。对于使用 Chebyshev 配置法离散化的二阶微分算子，离散算子矩阵中对应于边界点的行的元素大小约为 $\\mathcal{O}(N^2)$。tau（或罚函数）方法通过添加一项 $\\tau(u_j - g)$ 来修改这些边界点上的方程以施加边界条件。为确保该边界条件项不被方程的微分算子部分所压倒，参数 $\\tau$ 必须具有相同或更大的数量级。因此，选择 $\\tau \\sim c N^2$（其中 $c  0$ 为某个常数）是平衡各项并有效施加边界条件的正确缩放。已知这种选择可以保持该方法对光滑解的谱（指数）收敛性。\n\n相反，如果 $\\tau$ 选择得太小（例如，一个与 $N$ 无关的常数），边界条件仅被弱施加。边界条件中的误差 $u(x_j)-g$ 将大致与算子大小与罚函数大小之比成正比，导致边界上的误差约为 $\\mathcal{O}(1/\\tau)$。此误差不会随着 $N$ 的增加而减小。它作为一个固定水平的误差源，“饱和”了总误差，阻止了谱方法在 $N$ 较大时预期的指数收敛。\n\n结论：**正确**。\n\n**D. 在谱配置法中，于边界节点处强施加边界条件不会降低谱精度，并且比使用非常大的 tau 罚函数能产生更好的条件数。**\n\n谱配置中的强施加方法包括移除边界点处的配置方程，并用精确的边界条件替换它们。这将待解线性系统的大小从 $(N+1) \\times (N+1)$ 减小到 $(N-1) \\times (N-1)$。这是一种标准的、鲁棒的技术，众所周知，它能为具有光滑解的问题保持谱精度。\n\n陈述的第二部分涉及条件数。对于一维二阶问题，由强施加法得到的内部问题的矩阵条件数通常为 $\\mathcal{O}(N^2)$。对于 tau/罚函数法，$(N+1) \\times (N+1)$ 矩阵的条件数取决于 $\\tau$ 的选择。条件数通常随 $\\tau$ 增长。虽然最优选择 $\\tau \\sim N^2$ 可以导致 $\\mathcal{O}(N^2)$ 的条件数（与强施加法相当），但该陈述提到了“非常大的 tau 罚函数”。如果选择的 $\\tau$ 远大于所需的缩放比例，比如 $\\tau \\sim N^4$ 或 $\\tau \\sim 10^{16}$，则罚函数项将主导矩阵，导致非常大的条件数，约为 $\\mathcal{O}(\\tau)$。因此，对于 $\\tau \\gg N^2$，tau 方法的条件数将显著差于强施加方法的 $\\mathcal{O}(N^2)$。\n\n结论：**正确**。\n\n**E. 在有限元方法中，与使用大 $\\alpha$ 的罚函数法相比，强施加 Dirichlet 边界条件会降低刚度矩阵的全局条件数。**\n\n该陈述比较了两种有限元策略产生的线性系统的条件数。对于强施加法，边界自由度被消除，求解的是内部自由度的系统。所得刚度矩阵的条件数 $\\kappa_{strong}$ 约为 $\\mathcal{O}(h^{-2})$。\n\n对于罚函数法，组装的是完整系统，矩阵为 $A_h + P_\\alpha$，其中 $A_h$ 是奇异刚度矩阵，$P_\\alpha$ 是罚矩阵。这个罚矩阵的条件数 $\\kappa_{penalty}$ 高度依赖于 $\\alpha$。对于大的 $\\alpha$，矩阵的最大特征值由 $\\alpha$ 主导，而最小特征值由一个与区域大小相关的常数界定。这导致 $\\kappa_{penalty} \\sim \\mathcal{O}(\\alpha)$。\n\n该陈述是一个比较：它声称对于“大 $\\alpha$”，有 $\\kappa_{strong}  \\kappa_{penalty}$。这等价于问对于大 $\\alpha$，是否有 $\\mathcal{O}(h^{-2})  \\mathcal{O}(\\alpha)$。对于任何固定的网格尺寸 $h$，总可以找到足够大的 $\\alpha$ 使得对于任何常数 $C$，都有 $\\alpha  C h^{-2}$。例如，一个朴素的选择 $\\alpha=10^{12}$ 几乎肯定会导致一个比强施加法得到的系统条件更差的罚函数系统。因此，强施加法避免了用户选择的大参数恶化条件数的问题，并且其条件数确实小于使用过大 $\\alpha$ 的罚函数法的条件数。\n\n结论：**正确**。",
            "answer": "$$\\boxed{BCDE}$$"
        },
        {
            "introduction": "最后的这项实践将理论与应用融为一体，要求您将特征波分析与数值通量计算相结合，为有限体积法MHD求解器编写一个完整的特征边界条件。这是一个高级练习，旨在模拟计算科学家将复杂的物理和数学理论转化为可执行代码的实际工作流程，是计算聚变科学领域的关键技能。",
            "id": "3996395",
            "problem": "考虑在计算聚变科学与工程领域中，与等离子体相关的一维理想磁流体力学 (MHD) 在 $x$ 方向上的守恒律。设守恒状态向量为 $U = [\\rho, \\rho u, \\rho v, \\rho w, B_y, B_z, E]^T$，其中法向磁场分量 $B_x$ 为常数。热力学压力为 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho(u^2 + v^2 + w^2) - \\tfrac{1}{2}(B_x^2 + B_y^2 + B_z^2)\\right)$，总压力为 $p_{\\text{tot}} = p + \\tfrac{1}{2}(B_x^2 + B_y^2 + B_z^2)$。$x$ 方向上的无粘通量 $F(U)$ 为\n$$\nF(U) =\n\\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 + p_{\\text{tot}} - B_x^2 \\\\\n\\rho u v - B_x B_y \\\\\n\\rho u w - B_x B_z \\\\\nB_y u - B_x v \\\\\nB_z u - B_x w \\\\\n(E + p_{\\text{tot}})u - B_x(B_x u + B_y v + B_z w)\n\\end{bmatrix}.\n$$\n\n我们考虑在一个带有物理边界的半无限域上进行有限体积离散。必须构造边界通量以得到一个适定的初边值问题。在边界处，定义沿 $x$ 方向的外单位法向量为 $n_x \\in \\{-1, +1\\}$，其中 $n_x = -1$ 表示左侧域边界，$n_x = +1$ 表示右侧域边界。令 $U_L$ 表示边界相邻单元内的内部状态，$U_{\\text{bc}}$ 表示一个指定的外部边界状态，该状态编码了所需的入射特征信息。离散特征边界条件通过将状态跳跃投影到由通量雅可比矩阵 $A = \\partial F/\\partial U$（在 $U_L$ 处求值）决定的入射特征子空间上来构造。\n\n从守恒律基础和特征的定义出发：\n- 一维理想 MHD 守恒律定义了一个双曲系统。对于给定的状态 $U_L$，通量雅可比矩阵 $A(U_L)$ 容许一个特征分解 $A = R \\Lambda L$，其中 $R$ 和 $L$ 分别是右、左特征向量矩阵，$\\Lambda$ 是 $x$ 方向上特征值（特征速度）$\\lambda_i$ 的对角矩阵。\n- 与特征值 $\\lambda_i$ 相关的特征是入射到计算域的，当且仅当 $n_x \\lambda_i  0$。\n\n将离散特征边界构造定义如下：\n- 计算 $A(U_L)$ 及其特征分解 $A = R \\Lambda L$。\n- 计算边界状态跳跃 $\\Delta U_{\\text{bc}} = U_{\\text{bc}} - U_L$。\n- 计算特征振幅 $\\alpha = L \\Delta U_{\\text{bc}}$。\n- 定义过滤后的振幅 $\\tilde{\\alpha}_i = \\alpha_i$（如果 $n_x \\lambda_i  0$，即入射），否则 $\\tilde{\\alpha}_i = 0$（出射）。\n- 重构虚拟状态 $U_R = U_L + R \\tilde{\\alpha}$。\n- 通过局部 Lax-Friedrichs (Rusanov) 通量形成边界数值通量，\n$$\nF_{\\text{bc}} = \\tfrac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\tfrac{1}{2} a_{\\max} \\left(U_R - U_L\\right),\n$$\n其中 $a_{\\max} = \\max_i |\\lambda_i|$ 在 $U_L$ 处计算。\n\n此过程确保只有指定的入射特征信息从外部引入，而出射特征由内部解确定，从而为双曲 MHD 系统提供一个自洽的边值问题表述。\n\n实现一个完整、可运行的程序，该程序：\n- 编码用于理想 MHD 在 $x$ 方向上的 $F(U)$。\n- 使用关于守恒变量的 $F(U)$ 的对称有限差分来数值近似 $A(U_L)$。\n- 执行上述的特征投影和虚拟状态重构。\n- 为每个测试用例返回边界通量 $F_{\\text{bc}}$。\n\n使用 $\\gamma = \\tfrac{5}{3}$。程序必须以单行形式输出结果，结果为一个用方括号括起来的逗号分隔列表。每个结果都必须是一个包含七个浮点数的列表，顺序为 $[F_{\\rho}, F_{\\rho u}, F_{\\rho v}, F_{\\rho w}, F_{B_y}, F_{B_z}, F_E]$，其中 $F_{\\rho}$ 表示 $F_{\\text{bc}}$ 的第一个分量，依此类推。\n\n测试套件：\n- 用例 1 (右边界，亚音速出流，无反射)：$n_x = +1$, $B_x = 0.75$, 内部原始变量状态 $[\\rho, u, v, w, B_y, B_z, p] = [1.0, 0.5, 0.0, 0.0, 0.1, -0.05, 0.8]$, 且 $U_{\\text{bc}}$ 等于 $U_L$。\n- 用例 2 (右边界，超音速出流，无反射)：$n_x = +1$, $B_x = 0.2$, 内部原始变量状态 $[\\rho, u, v, w, B_y, B_z, p] = [1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.5]$, 且 $U_{\\text{bc}}$ 等于 $U_L$。\n- 用例 3 (左边界，亚音速入流，指定的入射内容)：$n_x = -1$, $B_x = 0.5$, 内部原始变量状态 $[\\rho, u, v, w, B_y, B_z, p] = [1.2, 0.2, 0.0, 0.0, 0.05, 0.1, 1.1]$, 外部原始变量状态 $[\\rho, u, v, w, B_y, B_z, p] = [1.0, 0.1, -0.05, 0.02, 0.2, 0.05, 1.0]$。\n- 用例 4 (右边界，法向速度为零的边界情况，无反射)：$n_x = +1$, $B_x = 0.3$, 内部原始变量状态 $[\\rho, u, v, w, B_y, B_z, p] = [1.0, 0.0, 0.1, -0.1, 0.0, 0.2, 1.0]$, 且 $U_{\\text{bc}}$ 等于 $U_L$。\n\n所有原始变量状态必须通过以下方式转换为守恒变量\n$$\nE = \\frac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho(u^2 + v^2 + w^2) + \\tfrac{1}{2}(B_x^2 + B_y^2 + B_z^2).\n$$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含四个边界通量向量，格式为一个用方括号括起来的逗号分隔列表。每个边界通量向量表示为包含七个浮点数的列表，例如 $[[f_{1,1}, \\dots, f_{1,7}], [f_{2,1}, \\dots, f_{2,7}], [f_{3,1}, \\dots, f_{3,7}], [f_{4,1}, \\dots, f_{4,7}]]$.\n\n不涉及物理单位或角度；所有值都应视为无量纲。输出条目必须是浮点数。程序必须是自包含的，并且不需要任何输入。",
            "solution": "该问题要求为一维理想磁流体力学 (MHD) 方程实现一个基于特征的边界条件，并为几个测试用例计算得到的数值边界通量 $F_{\\text{bc}}$。该方法基于将边界上的状态跳跃分解为特征波，筛选出入射波，并利用结果为数值通量函数构造一个虚拟单元状态。\n\n该物理系统由一维 ($x$) 理想 MHD 守恒律 $\\partial_t U + \\partial_x F(U) = 0$ 描述，其中 $U$ 是守恒量向量，$F(U)$ 是通量向量。\n状态向量为 $U = [\\rho, \\rho u, \\rho v, \\rho w, B_y, B_z, E]^T$。其中，$\\rho$ 是质量密度，$[u, v, w]$ 是速度分量，$[B_y, B_z]$ 是横向磁场分量，$E$ 是总能量密度。磁场的法向分量 $B_x$ 是一个常数。\n通量向量由下式给出：\n$$\nF(U) =\n\\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 + p_{\\text{tot}} - B_x^2 \\\\\n\\rho u v - B_x B_y \\\\\n\\rho u w - B_x B_z \\\\\nB_y u - B_x v \\\\\nB_z u - B_x w \\\\\n(E + p_{\\text{tot}})u - B_x(B_x u + B_y v + B_z w)\n\\end{bmatrix}\n$$\n该系统通过理想气体状态方程封闭，其中热力学压力 $p$ 通过以下方式与总能量 $E$ 相关：\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho(u^2 + v^2 + w^2) - \\tfrac{1}{2}(B_x^2 + B_y^2 + B_z^2)\\right)\n$$\n总压力 $p_{\\text{tot}}$ 是热力学压力和磁压力之和：$p_{\\text{tot}} = p + \\tfrac{1}{2}(B_x^2 + B_y^2 + B_z^2)$。绝热指数为 $\\gamma = \\tfrac{5}{3}$。\n\n计算边界通量 $F_{\\text{bc}}$ 的数值步骤如下：\n\n**步骤 1：状态变量转换**\n测试用例提供了原始变量 $[\\rho, u, v, w, B_y, B_z, p]$。必须将这些变量转换为内部状态 ($U_L$) 和指定的边界状态 ($U_{\\text{bc}}$) 的守恒状态向量 $U$。转换是使用守恒变量的定义完成的，总能量 $E$ 计算如下：\n$$\nE = \\frac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho(u^2 + v^2 + w^2) + \\tfrac{1}{2}(B_x^2 + B_y^2 + B_z^2)\n$$\n\n**步骤 2：通量雅可比矩阵和特征分解**\n基于特征的方法依赖于通量雅可比矩阵 $A(U) = \\partial F/\\partial U$ 的特征系统。由于 $7 \\times 7$ 雅可比矩阵的解析推导非常繁琐，我们将在内部状态 $U_L$ 处对其进行数值近似。对于每个元素 $A_{ij} = \\partial F_i / \\partial U_j$，我们使用对称有限差分格式：\n$$\nA_{ij}(U_L) \\approx \\frac{F_i(U_L + h \\mathbf{e}_j) - F_i(U_L - h \\mathbf{e}_j)}{2h}\n$$\n其中 $\\mathbf{e}_j$ 是第 $j$ 个标准基向量，$h$ 是一个小扰动。\n然后将计算出的雅可比矩阵 $A(U_L)$ 对角化，以求得其特征值 $\\lambda_i$（特征波速）及其右特征向量（矩阵 $R$ 的列向量）。这就得到了分解 $A = R \\Lambda L$，其中 $\\Lambda$ 是特征值的对角矩阵，$L = R^{-1}$ 是左特征向量矩阵。\n\n**步骤 3：特征筛选**\n核心原则是只允许与入射特征波相关的信息从指定的外部状态传入计算域。如果特征波 $i$ 的速度 $\\lambda_i$ 指向域内，则该波是入射的，其数学表述为 $n_x \\lambda_i  0$，其中 $n_x$ 是边界处的外单位法向量（对于左边界，$n_x = -1$；对于右边界，$n_x = +1$）。\n\n为实现这一点，我们首先计算指定状态与内部状态之间的跳跃 $\\Delta U_{\\text{bc}} = U_{\\text{bc}} - U_L$。然后通过计算波强度振幅 $\\alpha = L \\Delta U_{\\text{bc}}$，将此跳跃投影到特征基上。通过只保留与入射波对应的振幅来构造一组经过筛选的振幅 $\\tilde{\\alpha}$：\n$$\n\\tilde{\\alpha}_i =\n\\begin{cases}\n\\alpha_i  \\text{if } n_x \\lambda_i  0 \\text{ (入射)} \\\\\n0  \\text{if } n_x \\lambda_i \\geq 0 \\text{ (出射)}\n\\end{cases}\n$$\n\n**步骤 4：虚拟状态重构**\n将筛选后的振幅投影回守恒变量空间，形成一个修正量 $R \\tilde{\\alpha}$。将此修正量加到内部状态 $U_L$ 上，以定义一个“虚拟”状态 $U_R$：\n$$\nU_R = U_L + R \\tilde{\\alpha}\n$$\n这个虚拟状态 $U_R$ 现在包含了来自内部状态 $U_L$ 的出射信息和来自指定外部状态 $U_{\\text{bc}}$ 的入射信息。\n\n**步骤 5：数值通量计算**\n最终的边界通量 $F_{\\text{bc}}$ 使用局部 Lax-Friedrichs（或 Rusanov）数值通量函数计算，这是双曲系统的一个鲁棒且常见的选择。其定义如下：\n$$\nF_{\\text{bc}} = \\tfrac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\tfrac{1}{2} a_{\\max} \\left(U_R - U_L\\right)\n$$\n其中 $F(U_L)$ 和 $F(U_R)$ 分别是在内部状态和虚拟状态下计算的物理通量，$a_{\\max} = \\max_i |\\lambda_i|$ 是在内部状态 $U_L$ 处计算的最大绝对特征速度。这样就完成了计算。对于无反射边界条件，其中 $U_{\\text{bc}} = U_L$，状态跳跃 $\\Delta U_{\\text{bc}}$ 为零，这导致 $\\tilde{\\alpha} = 0$，$U_R = U_L$，通量简化为 $F_{\\text{bc}} = F(U_L)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define the constant gamma\n    GAMMA = 5.0 / 3.0\n\n    def primitive_to_conserved(prim, Bx):\n        \"\"\"Converts primitive variables [rho, u, v, w, By, Bz, p] to conserved variables.\"\"\"\n        rho, u, v, w, By, Bz, p = prim\n        \n        U = np.zeros(7)\n        U[0] = rho\n        U[1] = rho * u\n        U[2] = rho * v\n        U[3] = rho * w\n        U[4] = By\n        U[5] = Bz\n        \n        kinetic_energy = 0.5 * rho * (u**2 + v**2 + w**2)\n        magnetic_energy = 0.5 * (Bx**2 + By**2 + Bz**2)\n        internal_energy = p / (GAMMA - 1.0)\n        U[6] = internal_energy + kinetic_energy + magnetic_energy\n        \n        return U\n\n    def get_pressure_from_conserved(U, Bx):\n        \"\"\"Calculates thermodynamic pressure from the conserved state vector.\"\"\"\n        rho = U[0]\n        if rho = 1e-12:\n            raise ValueError(\"Density is non-positive.\")\n        \n        kinetic_energy = 0.5 * (U[1]**2 + U[2]**2 + U[3]**2) / rho\n        magnetic_energy = 0.5 * (Bx**2 + U[4]**2 + U[5]**2)\n        internal_energy = U[6] - kinetic_energy - magnetic_energy\n        \n        p = internal_energy * (GAMMA - 1.0)\n        return p\n\n    def mhd_flux(U, Bx):\n        \"\"\"Computes the 1D ideal MHD flux vector F(U).\"\"\"\n        rho = U[0]\n        if rho = 1e-12:\n            return np.zeros(7)\n\n        u = U[1] / rho\n        v = U[2] / rho\n        w = U[3] / rho\n        By = U[4]\n        Bz = U[5]\n        E = U[6]\n        \n        p = get_pressure_from_conserved(U, Bx)\n        p_tot = p + 0.5 * (Bx**2 + By**2 + Bz**2)\n        \n        F = np.zeros(7)\n        F[0] = U[1]\n        F[1] = U[1] * u + p_tot - Bx**2\n        F[2] = U[1] * v - Bx * By\n        F[3] = U[1] * w - Bx * Bz\n        F[4] = By * u - Bx * v\n        F[5] = Bz * u - Bx * w\n        F[6] = (E + p_tot) * u - Bx * (Bx * u + By * v + Bz * w)\n        \n        return F\n\n    def compute_jacobian_fd(U, Bx, h=1e-7):\n        \"\"\"Computes the flux Jacobian A = dF/dU using symmetric finite differences.\"\"\"\n        N = len(U)\n        A = np.zeros((N, N))\n        \n        for j in range(N):\n            U_plus_h = U.copy()\n            U_minus_h = U.copy()\n            \n            step = h * (1.0 + abs(U[j]))\n            \n            U_plus_h[j] += step\n            U_minus_h[j] -= step\n            \n            F_plus_h = mhd_flux(U_plus_h, Bx)\n            F_minus_h = mhd_flux(U_minus_h, Bx)\n            \n            A[:, j] = (F_plus_h - F_minus_h) / (2.0 * step)\n            \n        return A\n\n    def calculate_boundary_flux(case):\n        \"\"\"Main function to calculate the characteristic boundary flux for a single case.\"\"\"\n        nx, Bx, prim_L_list, prim_bc_list = case\n        prim_L = np.array(prim_L_list)\n        prim_bc = np.array(prim_bc_list)\n\n        U_L = primitive_to_conserved(prim_L, Bx)\n        U_bc = primitive_to_conserved(prim_bc, Bx)\n        \n        if np.allclose(U_L, U_bc):\n            return mhd_flux(U_L, Bx).tolist()\n\n        A_L = compute_jacobian_fd(U_L, Bx)\n        eigenvalues, R = np.linalg.eig(A_L)\n        lambdas = np.real(eigenvalues)\n        \n        try:\n            L = np.linalg.inv(R)\n        except np.linalg.LinAlgError:\n            L = np.linalg.pinv(R)\n\n        delta_U_bc = U_bc - U_L\n        alpha = L @ delta_U_bc\n        \n        tilde_alpha = np.zeros_like(alpha, dtype=complex)\n        for i in range(len(lambdas)):\n            if nx * lambdas[i]  0:\n                tilde_alpha[i] = alpha[i]\n\n        update = R @ tilde_alpha\n        U_R = U_L + np.real(update)\n\n        F_L = mhd_flux(U_L, Bx)\n        F_R = mhd_flux(U_R, Bx)\n        \n        a_max = np.max(np.abs(lambdas))\n        \n        F_bc = 0.5 * (F_L + F_R) - 0.5 * a_max * (U_R - U_L)\n        \n        return F_bc.tolist()\n\n    test_cases = [\n        (1.0, 0.75, [1.0, 0.5, 0.0, 0.0, 0.1, -0.05, 0.8], [1.0, 0.5, 0.0, 0.0, 0.1, -0.05, 0.8]),\n        (1.0, 0.2, [1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.5], [1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.5]),\n        (-1.0, 0.5, [1.2, 0.2, 0.0, 0.0, 0.05, 0.1, 1.1], [1.0, 0.1, -0.05, 0.02, 0.2, 0.05, 1.0]),\n        (1.0, 0.3, [1.0, 0.0, 0.1, -0.1, 0.0, 0.2, 1.0], [1.0, 0.0, 0.1, -0.1, 0.0, 0.2, 1.0]),\n    ]\n    \n    results = []\n    for case in test_cases:\n        result = calculate_boundary_flux(case)\n        results.append(result)\n\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}