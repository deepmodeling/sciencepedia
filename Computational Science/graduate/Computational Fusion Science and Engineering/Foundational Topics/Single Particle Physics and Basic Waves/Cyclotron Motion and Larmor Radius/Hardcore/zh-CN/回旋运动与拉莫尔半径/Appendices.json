{
    "hands_on_practices": [
        {
            "introduction": "单个粒子的拉莫尔半径由其垂直速度唯一确定，但对于处于热平衡状态的等离子体（由大量粒子组成），我们如何定义一个具有代表性的“热拉莫尔半径”？这个练习将引导我们从第一性原理出发，应用麦克斯韦-玻尔兹曼分布和能量均分定理，推导出一个基于统计物理的严谨定义。通过这项实践，你将能区分不同热速度定义（例如，$\\sqrt{2 k_B T / m}$ 与 $\\sqrt{k_B T / m}$）之间的物理含义，从而加深对拉莫尔半径在统计描述中应用的理解 。",
            "id": "3963242",
            "problem": "在一个与计算聚变科学与工程相关的磁化等离子体导心模拟中，对于质量为 $m$、电荷为 $q$、温度为 $T$ 的离子，在大小为 $B$ 的均匀磁场 $\\mathbf{B}$ 中，使用了一个宽度等于“热拉莫尔半径” $\\rho_{\\mathrm{th}}$ 的高斯电荷平滑核。回旋频率定义为 $\\Omega_c = |q| B / m$。假设速度分布为由麦克斯韦-玻尔兹曼分布 (MBD) 描述的各向同性分布，并根据麦克斯韦统计而非专门约定来一致地定义热学量。\n\n从第一性原理出发，即洛伦兹力定律和麦克斯韦-玻尔兹曼分布的统计特性，推导一个基于垂直速度大小 $v_\\perp$ 的、有原理依据的 $\\rho_{\\mathrm{th}}$ 定义，并解释在 $\\rho_{\\mathrm{th}}$ 中使用 $v_\\perp = \\sqrt{2 k_B T / m}$ 和 $v_\\perp = \\sqrt{k_B T / m}$ 之间的区别。这里 $k_B$ 是玻尔兹曼常数。选择在所述假设下最准确定义 $\\rho_{\\mathrm{th}}$ 并正确描述两种约定之间差异的选项。\n\nA. 使用各向同性的麦克斯韦-玻尔兹曼分布，$\\rho_{\\mathrm{th}}$ 应使用均方根 (RMS) 垂直速度大小 $v_{\\perp,\\mathrm{rms}} = \\sqrt{2 k_B T / m}$ 来定义，得出 $\\rho_{\\mathrm{th}} = v_{\\perp,\\mathrm{rms}} / \\Omega_c$。备选的 $v_\\perp = \\sqrt{k_B T / m}$ 对应于单个笛卡尔分量的均方根值，并将 $\\rho_{\\mathrm{th}}$ 低估了 $1/\\sqrt{2}$ 倍。\n\nB. 能量均分意味着 $\\langle v_\\perp^2 \\rangle = k_B T / m$，因此热拉莫尔半径是 $\\rho_{\\mathrm{th}} = \\sqrt{k_B T / m} / \\Omega_c$，而使用 $\\sqrt{2 k_B T / m}$ 会将 $\\rho_{\\mathrm{th}}$ 高估 $\\sqrt{2}$ 倍。\n\nC. 因为麦克斯韦-玻尔兹曼分布有三个自由度，所以正确的热拉莫尔半径是 $\\rho_{\\mathrm{th}} = \\sqrt{3 k_B T / m} / \\Omega_c$，而 $\\sqrt{2 k_B T / m}$ 和 $\\sqrt{k_B T / m}$ 约定之间的差异是 2 倍。\n\nD. “热拉莫尔半径”应基于平均垂直速率 $\\langle v_\\perp \\rangle$ 而非均方根值，因此 $\\rho_{\\mathrm{th}} = \\langle v_\\perp \\rangle / \\Omega_c$，其中 $\\langle v_\\perp \\rangle = \\sqrt{\\pi k_B T / (2 m)}$，并且两种约定 $\\sqrt{2 k_B T / m}$ 与 $\\sqrt{k_B T / m}$ 在一个量级为1的常数范围内是等价的，不会实质性影响计算分辨率。",
            "solution": "在尝试解答之前，首先对问题的科学合理性、一致性和清晰度进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   **系统：** 磁化等离子体的导心模拟。\n-   **粒子：** 质量为 $m$、电荷为 $q$、温度为 $T$ 的离子。\n-   **场：** 大小为 $B$ 的均匀磁场 $\\mathbf{B}$。\n-   **工具：** 宽度等于“热拉莫尔半径” $\\rho_{\\mathrm{th}}$ 的高斯电荷平滑核。\n-   **分布：** 由麦克斯韦-玻尔兹曼分布 (MBD) 描述的各向同性速度分布。\n-   **定义：** 回旋频率为 $\\Omega_c = |q| B / m$。\n-   **约束：** 热拉莫尔半径 $\\rho_{\\mathrm{th}}$ 需从第一性原理出发，并与麦克斯韦统计一致地定义。\n-   **问题：** 推导一个基于垂直速度大小 $v_\\perp$ 的、有原理依据的 $\\rho_{\\mathrm{th}}$ 定义。解释使用 $v_\\perp = \\sqrt{2 k_B T / m}$ 和 $v_\\perp = \\sqrt{k_B T / m}$ 之间的区别。选择最佳选项。\n-   **常数：** 玻尔兹曼常数为 $k_B$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学上成立：** 该问题牢固地植根于应用于等离子体物理学的经典力学和统计物理学。洛伦兹力、拉莫尔半径、导心模型和麦克斯韦-玻尔兹曼分布都是基础且成熟的概念。该场景是计算等离子体物理学中使用的标准理想化模型。\n-   **良态问题：** 该问题提供了一个明确的框架（MBD，各向同性分布），并要求基于“第一性原理”和“麦克斯韦统计”进行推导。这引导推导过程朝向一个基于分布统计矩的、唯一的、具有物理意义的答案。\n-   **客观性：** 语言技术性强且精确。措辞“有原理依据的定义”指导解题者使用基本的物理推理（例如，能量均分），而不是任意的约定。\n\n**缺陷检查清单：**\n1.  **科学或事实不健全：** 无。\n2.  **不可形式化或不相关：** 无。该问题可直接形式化，并且是计算聚变科学这一主题的核心。\n3.  **不完整或矛盾的设置：** 无。所有必要的物理量和统计假设都已提供。\n4.  **不切实际或不可行：** 无。该设置描述了一个标准的、简化的物理模型。\n5.  **病态或结构不良：** 无。问题陈述清晰，旨在寻求一个特定的推导和比较。\n6.  **伪深刻、琐碎或同义反复：** 无。该问题探讨了在多维系统中应用统计力学定义热速度时的一个常见混淆点，需要对自由度有清晰的理解。\n7.  **超出科学可验证性：** 无。该推导是数学物理中的一个标准练习。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。将进行推导求解。\n\n### 推导与分析\n\n**1. 从第一性原理推导拉莫尔半径**\n\n带电荷 $q$、速度为 $\\mathbf{v}$ 的粒子在均匀磁场 $\\mathbf{B}$ 中的运动由洛伦兹力定律 $\\mathbf{F} = q(\\mathbf{v} \\times \\mathbf{B})$ 决定。平行于 $\\mathbf{B}$ 的速度分量 $v_\\parallel$ 不受影响。垂直于 $\\mathbf{B}$ 的速度分量 $\\mathbf{v}_\\perp$ 导致圆周运动。磁场力提供了所需的向心力。设垂直速度的大小为 $v_\\perp = |\\mathbf{v}_\\perp|$，圆周路径的半径为拉莫尔半径 $r_L$。\n\n磁场力的大小为 $|F| = |q| v_\\perp B$。向心力的大小为 $F_c = m v_\\perp^2 / r_L$。令二者相等，可得：\n$$|q| v_\\perp B = \\frac{m v_\\perp^2}{r_L}$$\n解出单个粒子的拉莫尔半径：\n$$r_L = \\frac{m v_\\perp}{|q| B}$$\n使用回旋频率的定义 $\\Omega_c = |q| B / m$，我们可以将拉莫尔半径写为：\n$$r_L = \\frac{v_\\perp}{\\Omega_c}$$\n此表达式将单个粒子的拉莫尔半径与其特定的垂直速度 $v_\\perp$ 联系起来。\n\n**2. 从麦克斯韦统计推导热拉莫尔半径 ($\\rho_{\\mathrm{th}}$)**\n\n对于温度为 $T$ 的粒子系综，存在一个速度分布。问题陈述此为各向同性的麦克斯韦-玻尔兹曼分布。为了定义一个特征性的“热拉莫尔半径” $\\rho_{\\mathrm{th}}$，我们必须选择一个特征热速度。对于与动能相关的量，均方根 (RMS) 速度是物理上最有原理依据的选择。因此，热拉莫尔半径使用均方根垂直速度 $v_{\\perp,\\mathrm{rms}}$ 来定义：\n$$\\rho_{\\mathrm{th}} = \\frac{v_{\\perp,\\mathrm{rms}}}{\\Omega_c} = \\frac{\\sqrt{\\langle v_\\perp^2 \\rangle}}{\\Omega_c}$$\n我们现在必须计算二维麦克斯韦-玻尔兹曼分布的 $\\langle v_\\perp^2 \\rangle$。\n\n假设磁场 $\\mathbf{B}$ 沿 $z$ 轴方向。垂直速度为 $\\mathbf{v}_\\perp = v_x \\hat{\\mathbf{i}} + v_y \\hat{\\mathbf{j}}$，其大小的平方为 $v_\\perp^2 = v_x^2 + v_y^2$。根据期望算子的线性性质：\n$$\\langle v_\\perp^2 \\rangle = \\langle v_x^2 + v_y^2 \\rangle = \\langle v_x^2 \\rangle + \\langle v_y^2 \\rangle$$\n能量均分定理指出，对于处于热平衡的系统，与每个二次自由度相关的平均能量为 $\\frac{1}{2} k_B T$。动能有三个这样的自由度，分别对应于 $v_x$、$v_y$ 和 $v_z$。垂直于 $\\mathbf{B}$ 的运动涉及两个自由度（$x$ 和 $y$）。\n因此，每个垂直分量的平均动能为：\n$$\\left\\langle \\frac{1}{2} m v_x^2 \\right\\rangle = \\frac{1}{2} k_B T \\implies \\langle v_x^2 \\rangle = \\frac{k_B T}{m}$$\n$$\\left\\langle \\frac{1}{2} m v_y^2 \\right\\rangle = \\frac{1}{2} k_B T \\implies \\langle v_y^2 \\rangle = \\frac{k_B T}{m}$$\n将这些代入 $\\langle v_\\perp^2 \\rangle$ 的表达式中：\n$$\\langle v_\\perp^2 \\rangle = \\frac{k_B T}{m} + \\frac{k_B T}{m} = \\frac{2 k_B T}{m}$$\n因此，均方根垂直速度为：\n$$v_{\\perp,\\mathrm{rms}} = \\sqrt{\\langle v_\\perp^2 \\rangle} = \\sqrt{\\frac{2 k_B T}{m}}$$\n热拉莫尔半径的有原理依据的定义为：\n$$\\rho_{\\mathrm{th}} = \\frac{v_{\\perp,\\mathrm{rms}}}{\\Omega_c} = \\frac{\\sqrt{2 k_B T / m}}{\\Omega_c}$$\n\n**3. 对备选约定的分析**\n\n所讨论的备选速度是 $v_\\perp = \\sqrt{k_B T / m}$。根据我们上面的推导，我们看到：\n$$\\sqrt{\\frac{k_B T}{m}} = \\sqrt{\\langle v_x^2 \\rangle} = v_{x,\\mathrm{rms}}$$\n这个速度是速度的*单个*笛卡尔分量的均方根值，而不是二维垂直速度矢量大小的均方根值。使用这个值来定义拉莫尔半径 $\\rho' = \\sqrt{k_B T / m} / \\Omega_c$ 在物理上是值得商榷的，因为它基于二维运动在一维投影上的统计。\n\n正确的热拉莫尔半径与此备选定义的比值为：\n$$\\frac{\\rho_{\\mathrm{th}}}{\\rho'} = \\frac{\\sqrt{2 k_B T / m} / \\Omega_c}{\\sqrt{k_B T / m} / \\Omega_c} = \\sqrt{2}$$\n因此，使用 $v_\\perp = \\sqrt{k_B T / m}$ 会将有物理动机的热拉莫尔半径低估 $1/\\sqrt{2}$ 倍。\n\n### 选项评估\n\n**A. 使用各向同性的麦克斯韦-玻尔兹曼分布，$\\rho_{\\mathrm{th}}$ 应使用均方根 (RMS) 垂直速度大小 $v_{\\perp,\\mathrm{rms}} = \\sqrt{2 k_B T / m}$ 来定义，得出 $\\rho_{\\mathrm{th}} = v_{\\perp,\\mathrm{rms}} / \\Omega_c$。备选的 $v_\\perp = \\sqrt{k_B T / m}$ 对应于单个笛卡尔分量的均方根值，并将 $\\rho_{\\mathrm{th}}$ 低估了 $1/\\sqrt{2}$ 倍。**\n该陈述与我们的推导完全相符。它通过将能量均分定理应用于两个垂直自由度，正确地确定了 $v_{\\perp,\\mathrm{rms}}$。它正确地指出了备选速度 $\\sqrt{k_B T / m}$ 的物理意义，即单个分量的均方根值。它也正确地说明了 $1/\\sqrt{2}$ 的低估因子。\n**结论：正确。**\n\n**B. 能量均分意味着 $\\langle v_\\perp^2 \\rangle = k_B T / m$，因此热拉莫尔半径是 $\\rho_{\\mathrm{th}} = \\sqrt{k_B T / m} / \\Omega_c$，而使用 $\\sqrt{2 k_B T / m}$ 会将 $\\rho_{\\mathrm{th}}$ 高估 $\\sqrt{2}$ 倍。**\n该选项错误地应用了能量均分定理。它将仅一个自由度的能量（$\\frac{1}{2} k_B T$）分配给了总的垂直动能（$\\langle \\frac{1}{2} m v_\\perp^2 \\rangle$），导致了 $\\langle v_\\perp^2 \\rangle = k_B T / m$ 的错误结论。垂直运动有两个自由度。\n**结论：错误。**\n\n**C. 因为麦克斯韦-玻尔兹曼分布有三个自由度，所以正确的热拉莫尔半径是 $\\rho_{\\mathrm{th}} = \\sqrt{3 k_B T / m} / \\Omega_c$，而 $\\sqrt{2 k_B T / m}$ 和 $\\sqrt{k_B T / m}$ 约定之间的差异是 2 倍。**\n该选项错误地使用了总均方根速率 $v_{\\mathrm{rms}} = \\sqrt{\\langle v^2 \\rangle} = \\sqrt{3 k_B T / m}$，它包含了平行速度分量。拉莫尔半径完全由垂直运动决定。平行于 $\\mathbf{B}$ 的速度分量对回旋运动没有贡献。此外，$\\sqrt{2 k_B T / m}$ 与 $\\sqrt{k_B T / m}$ 的比值是 $\\sqrt{2}$，而不是 $2$。\n**结论：错误。**\n\n**D. “热拉莫尔半径”应基于平均垂直速率 $\\langle v_\\perp \\rangle$ 而非均方根值，因此 $\\rho_{\\mathrm{th}} = \\langle v_\\perp \\rangle / \\Omega_c$，其中 $\\langle v_\\perp \\rangle = \\sqrt{\\pi k_B T / (2 m)}$，并且两种约定 $\\sqrt{2 k_B T / m}$ 与 $\\sqrt{k_B T / m}$ 在一个量级为1的常数范围内是等价的，不会实质性影响计算分辨率。**\n虽然使用平均速率 $\\langle v_\\perp \\rangle$ 是一种可能的约定，但均方根速率 $v_{\\perp,\\mathrm{rms}}$ 更直接地与平均垂直动能（$ \\langle K_\\perp \\rangle = \\frac{1}{2} m \\langle v_\\perp^2 \\rangle = k_B T$）相关，使其成为题目所要求的更“有原理依据”的选择。$\\langle v_\\perp \\rangle = \\sqrt{\\pi k_B T / (2m)}$ 的计算对于二维麦克斯韦分布是正确的。然而，最后的论断，即一个约为 $1.414$ 的因子 $\\sqrt{2}$ 不会“实质性影响计算分辨率”，是一种主观、含糊的论证，不适用于严谨的科学分析，并且在实践中往往是错误的。这样的因子对于数值模拟的准确性和稳定性可能至关重要。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "磁约束聚变的成功关键在于将高温等离子体粒子有效地束缚在磁场中。这一有效性的核心是粒子是否被“磁化”——即粒子在因碰撞而大幅偏离其轨道之前，能否完成许多次回旋运动。本练习提供了一种定量评估磁化程度的方法，通过计算并比较回旋频率 $\\Omega$ 和碰撞频率 $\\nu$。这项实践是理解和设计聚变装置中输运和约束性能的基础，它将理论概念与托卡马克等设备中的实际等离子体参数联系起来 。",
            "id": "3963204",
            "problem": "一个代表紧凑型聚变装置的准中性、单组分氘等离子体，其特征参数为：电子数密度 $n_{e} = 4.0 \\times 10^{19}~\\text{m}^{-3}$，离子数密度 $n_{i} = 4.0 \\times 10^{19}~\\text{m}^{-3}$，电子温度 $T_{e} = 7.5~\\text{keV}$，离子温度 $T_{i} = 10~\\text{keV}$，以及均匀磁场 $B = 3.2~\\text{T}$。离子是电荷数 $Z = 1$ 的单电荷氘核。在此状态下，库仑对数 $\\ln \\Lambda = 16$。请使用基本原理和经过充分检验的输运理论，通过计算无量纲磁化参数来确定电子和离子的磁化程度：\n$$M_{e} = \\frac{\\nu_{ei}}{\\Omega_{e}}, \\quad M_{i} = \\frac{\\nu_{ii}}{\\Omega_{i}},$$\n其中 $\\nu_{ei}$ 是电子-离子碰撞频率，$\\nu_{ii}$ 是离子-离子碰撞频率，而 $\\Omega_{e}$ 和 $\\Omega_{i}$ 分别是电子和离子的回旋（陀螺）频率。请从第一性原理出发，推导所使用的 $\\Omega_{s}$ 和 $\\nu_{ss'}$ 的表达式，然后对给定的等离子体状态数值计算 $M_{e}$ 和 $M_{i}$。\n\n使用以下常数：基本电荷 $e = 1.602176634 \\times 10^{-19}~\\text{C}$，电子质量 $m_{e} = 9.1093837015 \\times 10^{-31}~\\text{kg}$，氘核质量 $m_{D} = 3.343583719 \\times 10^{-27}~\\text{kg}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}~\\text{J/K}$，以及真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}~\\text{F/m}$。\n\n说明：\n- 将电子和离子的速度分布视为麦克斯韦分布。\n- 基于在麦克斯韦分布上平均的小角度库仑散射来计算碰撞频率。\n- 将最终答案表示为两个无量纲比值 $M_{e}$ 和 $M_{i}$。\n- 将每个比值四舍五入至三位有效数字。\n- 将最终结果报告为无量纲数。在最终的方框答案中不要包含单位。",
            "solution": "该问题被认为是有效的，因为它有科学依据，提法恰当，客观，并包含了获得唯一解所需的所有信息。所提供的参数与磁约束聚变研究中的参数一致。该任务是等离子体物理学中的一个标准计算。\n\n目标是计算电子和离子的磁化参数，定义为 $M_{e} = \\frac{\\nu_{ei}}{\\Omega_{e}}$ 和 $M_{i} = \\frac{\\nu_{ii}}{\\Omega_{i}}$。这些无量纲量比较了倾向于扰乱粒子轨道的碰撞率与围绕磁力线的迴旋率。一个很小的值 ($M_s \\ll 1$) 表明粒子种类 $s$ 是强磁化的，这意味着在一次碰撞显著改变其轨迹之前，它会完成许多次迴旋。我们将首先从基本原理推导回旋频率 $\\Omega_s$ 和碰撞频率 $\\nu_{ss'}$ 的表达式。\n\n回旋频率（或称陀螺频率）描述了带电粒子在均匀磁场中做圆周运动的角频率。这种运动源于洛伦兹力 $\\vec{F} = q_s(\\vec{E} + \\vec{v} \\times \\vec{B})$。在没有电场（$\\vec{E}=0$）的情况下，力纯粹是磁力：$\\vec{F} = q_s(\\vec{v} \\times \\vec{B})$。这个力总是同时垂直于速度 $\\vec{v}$ 和磁场 $\\vec{B}$。对于垂直于磁场的速度分量 $v_\\perp$，磁力提供了圆周运动所需的向心力：\n$$ |q_s| v_\\perp B = \\frac{m_s v_\\perp^2}{r_L} $$\n其中 $q_s$ 是粒子种类 $s$ 的电荷，$m_s$ 是其质量，$r_L$ 是回旋半径（或拉莫尔半径）。该圆周运动的角频率为 $\\Omega_s = v_\\perp / r_L$。从力平衡方程，我们推导出回旋频率的表达式：\n$$ \\Omega_s = \\frac{|q_s| B}{m_s} $$\n频率被定义为一个正值，因此取电荷的绝对值。对于本问题中的粒子种类：\n电子回旋频率为：\n$$ \\Omega_e = \\frac{e B}{m_e} $$\n因为电子电荷为 $|q_e| = |-e| = e$。\n离子（氘核）回旋频率为：\n$$ \\Omega_i = \\frac{|q_i| B}{m_i} = \\frac{Z e B}{m_D} $$\n其中 $Z=1$ 是电荷数，$m_i = m_D$ 是氘核质量。\n\n碰撞频率 $\\nu_{ei}$ 和 $\\nu_{ii}$ 表示由库仑碰撞引起的动量传递率。在高温、完全电离的等离子体中，碰撞主要由许多小角度散射事件的累积效应主导。这里使用的公式是通过对相互作用的粒子种类的麦克斯韦速度分布上的动量传递截面进行平均而得出的。\n\n电子-离子碰撞频率 $\\nu_{ei}$ 表征了电子动量损失给离子的速率，由标准的 Spitzer-Braginskii 公式给出：\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi} n_i Z^2 e^4 \\ln \\Lambda}{3 m_e^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2}} $$\n此处，$n_i$ 是离子数密度，$Z$ 是离子电荷数，$e$ 是基本电荷，$\\ln \\Lambda$ 是库仑对数，$m_e$ 是电子质量，$\\varepsilon_0$ 是真空介电常数，$k_B T_e$ 是电子热能。$T_e^{-3/2}$ 的依赖关系源于卢瑟福散射截面对相对速度的依赖性。\n\n离子-离子碰撞频率 $\\nu_{ii}$ 是类似的，但描述的是同类粒子（离子）之间的碰撞。其公式为：\n$$ \\nu_{ii} = \\frac{4 \\sqrt{\\pi} n_i Z^4 e^4 \\ln \\Lambda}{3 m_i^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_i)^{3/2}} $$\n注意与 $\\nu_{ei}$ 的区别：质量是离子质量 $m_i$，温度是离子温度 $T_i$，电荷数被提升到四次方 ($Z^4$)，并且由于计算涉及同类粒子碰撞，数值前因子包含 $\\sqrt{\\pi}$ 而不是 $\\sqrt{2\\pi}$。\n\n现在我们可以构建磁化参数的表达式。\n对于电子：\n$$ M_e = \\frac{\\nu_{ei}}{\\Omega_e} = \\left( \\frac{4 \\sqrt{2\\pi} n_i Z^2 e^4 \\ln \\Lambda}{3 m_e^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2}} \\right) \\left( \\frac{m_e}{e B} \\right) = \\frac{4 \\sqrt{2\\pi} n_i Z^2 e^3 m_e^{1/2} \\ln \\Lambda}{3 (4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2} B} $$\n对于离子：\n$$ M_i = \\frac{\\nu_{ii}}{\\Omega_i} = \\left( \\frac{4 \\sqrt{\\pi} n_i Z^4 e^4 \\ln \\Lambda}{3 m_i^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_i)^{3/2}} \\right) \\left( \\frac{m_i}{Z e B} \\right) = \\frac{4 \\sqrt{\\pi} n_i Z^3 e^3 m_i^{1/2} \\ln \\Lambda}{3 (4\\pi\\varepsilon_0)^2 (k_B T_i)^{3/2} B} $$\n\n我们现在使用所提供的数据进行数值计算：\n- 电子/离子密度: $n_e = n_i = 4.0 \\times 10^{19}~\\text{m}^{-3}$\n- 电子温度: $T_e = 7.5~\\text{keV}$\n- 离子温度: $T_i = 10~\\text{keV}$\n- 磁场: $B = 3.2~\\text{T}$\n- 离子电荷数: $Z = 1$\n- 库仑对数: $\\ln \\Lambda = 16$\n- 基本电荷: $e = 1.602176634 \\times 10^{-19}~\\text{C}$\n- 电子质量: $m_e = 9.1093837015 \\times 10^{-31}~\\text{kg}$\n- 氘核质量: $m_D = 3.343583719 \\times 10^{-27}~\\text{kg}$\n- 真空介电常数: $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}~\\text{F/m}$\n\n首先，我们将以千电子伏特 (keV) 为单位的温度转换为焦耳 (Joule)，因为 $1~\\text{keV}$ 的能量等于 $10^3 \\times e$ 焦耳。\n$$ k_B T_e = 7.5 \\times 10^3~\\text{eV} \\times (1.602176634 \\times 10^{-19}~\\text{J/eV}) = 1.2016324755 \\times 10^{-15}~\\text{J} $$\n$$ k_B T_i = 10 \\times 10^3~\\text{eV} \\times (1.602176634 \\times 10^{-19}~\\text{J/eV}) = 1.602176634 \\times 10^{-15}~\\text{J} $$\n\n接下来，我们计算回旋频率：\n$$ \\Omega_e = \\frac{e B}{m_e} = \\frac{(1.60217... \\times 10^{-19}~\\text{C})(3.2~\\text{T})}{9.10938... \\times 10^{-31}~\\text{kg}} \\approx 5.6267 \\times 10^{11}~\\text{rad/s} $$\n$$ \\Omega_i = \\frac{Z e B}{m_D} = \\frac{(1)(1.60217... \\times 10^{-19}~\\text{C})(3.2~\\text{T})}{3.34358... \\times 10^{-27}~\\text{kg}} \\approx 1.5317 \\times 10^{8}~\\text{rad/s} $$\n\n然后，我们计算碰撞频率。对于 $\\nu_{ei}$，其中 $Z=1$ 且 $n_i=n_e$：\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi} (4.0 \\times 10^{19}) (1)^2 (1.602... \\times 10^{-19})^4 (16)}{3 (9.109... \\times 10^{-31})^{1/2} (4\\pi \\times 8.854... \\times 10^{-12})^2 (1.2016... \\times 10^{-15})^{3/2}} \\approx 9.0441 \\times 10^3~\\text{s}^{-1} $$\n对于 $\\nu_{ii}$：\n$$ \\nu_{ii} = \\frac{4 \\sqrt{\\pi} (4.0 \\times 10^{19}) (1)^4 (1.602... \\times 10^{-19})^4 (16)}{3 (3.343... \\times 10^{-27})^{1/2} (4\\pi \\times 8.854... \\times 10^{-12})^2 (1.602... \\times 10^{-15})^{3/2}} \\approx 68.513~\\text{s}^{-1} $$\n\n最后，我们计算磁化参数：\n$$ M_e = \\frac{\\nu_{ei}}{\\Omega_e} = \\frac{9.0441 \\times 10^3~\\text{s}^{-1}}{5.6267 \\times 10^{11}~\\text{rad/s}} \\approx 1.6073 \\times 10^{-8} $$\n$$ M_i = \\frac{\\nu_{ii}}{\\Omega_i} = \\frac{68.513~\\text{s}^{-1}}{1.5317 \\times 10^{8}~\\text{rad/s}} \\approx 4.4729 \\times 10^{-7} $$\n这些值非常小，表明在该等离子体中电子和离子都是强磁化的，这是实现有效磁约束的一个先决条件。平均而言，一个电子在两次碰撞之间会进行 $\\sim 1/M_e \\approx 6.2 \\times 10^7$ 次回旋，一个离子会进行 $\\sim 1/M_i \\approx 2.2 \\times 10^6$ 次回旋。\n\n按照要求将最终结果四舍五入到三位有效数字：\n$M_e = 1.61 \\times 10^{-8}$\n$M_i = 4.47 \\times 10^{-7}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.61 \\times 10^{-8}  4.47 \\times 10^{-7} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在计算模拟和实验诊断中，我们通常获得的是粒子随时间变化的原始轨道数据，即位置 $\\mathbf{r}(t)$ 和速度 $\\mathbf{v}(t)$。一项基本而关键的任务是将这种复杂的螺旋运动分解为缓慢漂移的回旋中心运动和快速的回旋运动。本练习要求你从洛伦兹力定律出发，推导并实现一个从原始数据中提取瞬时回旋中心位置 $\\mathbf{R}(t)$ 和拉莫尔半径 $\\rho(t)$ 的实用算法。掌握这项技能对于分析磁化等离子体中的粒子动力学至关重要 。",
            "id": "3963203",
            "problem": "给定均匀磁化单粒子数据，包括在静态均匀磁场中带电粒子的位置和速度的时间序列。从第一性原理出发，推导并实现一个算法，该算法在每个时间瞬间，通过对相对于磁场方向的运动进行回旋相位分解，计算瞬时导引中心（GC）位置 $\\mathbf{R}(t)$ 和瞬时拉莫尔半径 $\\rho(t)$。使用已知的均匀磁场解析轨道来验证该算法。\n\n仅使用以下基本原理：非相对论性洛伦兹力定律 $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$，运动学恒等式 $\\mathbf{v} = d\\mathbf{r}/dt$，以及任意矢量分解为平行和垂直于给定单位矢量的分量。不要在问题陈述中使用预先推导的导引中心位置或拉莫尔半径的简化公式；相反，应从这些基本原理出发，定义一个可计算的回旋相位分解以及相关的导引中心和半径。\n\n科学情景和约束条件：\n- 磁场是恒定且空间均匀的：$\\mathbf{B}(\\mathbf{r},t) = \\mathbf{B}_0$。\n- 对于每种情况，粒子的质量 $m$ 和电荷 $q$ 随时间保持恒定。\n- 粒子运动可能包含一个平行于 $\\mathbf{B}_0$ 的分量，以及一个在垂直于 $\\mathbf{B}_0$ 的平面内的圆周运动。\n- 所有计算必须以国际单位制（SI）表示：位置单位为米，速度单位为米/秒，磁场单位为特斯拉，电荷单位为库仑，质量单位为千克，时间单位为秒。如果在回旋相位分析中引入角度，请以弧度表示。\n- 您的算法必须直接对所提供的数组 $\\{\\mathbf{r}(t_i)\\}$ 和 $\\{\\mathbf{v}(t_i)\\}$ 进行操作，生成数组 $\\{\\mathbf{R}(t_i)\\}$ 和 $\\{\\rho(t_i)\\}$。\n\n验证方法学：\n- 对于均匀磁场，解析轨道是已知的：垂直运动是以恒定角频率进行的匀速圆周运动，平行运动是匀速平移。为下面的测试套件构建解析轨道，并在每个时间样本上计算解析预期的导引中心位置和拉莫尔半径。将您的算法输出与这些解析预期值进行比较。\n- 通过为每个测试案例计算两个标量指标来量化验证：\n  1. 导引中心在时间序列上的最大绝对位置误差，定义为 $\\max_i \\|\\mathbf{R}_{\\text{alg}}(t_i) - \\mathbf{R}_{\\text{analytic}}(t_i)\\|$，单位为米。\n  2. 拉莫尔半径在时间序列上的最大绝对误差，定义为 $\\max_i |\\rho_{\\text{alg}}(t_i) - \\rho_{\\text{analytic}}|$，单位为米。\n- 以浮点数形式报告这些指标，单位为米。\n\n测试套件（四个案例），所有案例的 $\\mathbf{B}_0$ 均与 $z$ 轴对齐：\n- 案例1（氘核，典型托卡马克场）：\n  - $q = +1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 3.343583719\\times 10^{-27}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,5.0)\\ \\text{T}$。\n  - 垂直速度大小 $v_\\perp = 1.0\\times 10^{5}\\ \\text{m/s}$。\n  - 平行速度 $v_\\parallel = 1.0\\times 10^{4}\\ \\text{m/s}$。\n  - 初始回旋相位 $\\phi_0 = 0.3$ 弧度。\n  - 导引中心垂直偏移 $\\mathbf{R}_{\\perp} = (0.02,-0.015,0.0)\\ \\text{m}$。\n  - 初始平行位置 $z_0 = 0.0\\ \\text{m}$。\n  - 在 $2$ 个回旋周期内进行模拟，使用 $1200$ 个均匀间隔的时间样本。\n- 案例2（电子，负电荷，更高速度）：\n  - $q = -1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 9.10938356\\times 10^{-31}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,2.0)\\ \\text{T}$。\n  - $v_\\perp = 3.0\\times 10^{6}\\ \\text{m/s}$，$v_\\parallel = 1.0\\times 10^{5}\\ \\text{m/s}$。\n  - $\\phi_0 = 1.2$ 弧度，$\\mathbf{R}_{\\perp} = (-0.001,0.002,0.0)\\ \\text{m}$，$z_0 = 0.0\\ \\text{m}$。\n  - 在 $3$ 个回旋周期内进行模拟，使用 $1500$ 个样本。\n- 案例3（α粒子，垂直速度为零的边缘情况）：\n  - $q = +2\\times 1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 6.644657\\times 10^{-27}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,3.0)\\ \\text{T}$。\n  - $v_\\perp = 0.0\\ \\text{m/s}$，$v_\\parallel = 2.0\\times 10^{4}\\ \\text{m/s}$。\n  - $\\phi_0 = 0.0$ 弧度，$\\mathbf{R}_{\\perp} = (0.05,0.05,0.0)\\ \\text{m}$，$z_0 = 0.1\\ \\text{m}$。\n  - 在 $1$ 个回旋周期内进行模拟，使用 $800$ 个样本。\n- 案例4（α粒子，强磁场，多周期，非零相位）：\n  - $q = +2\\times 1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 6.644657\\times 10^{-27}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,10.0)\\ \\text{T}$。\n  - $v_\\perp = 5.0\\times 10^{4}\\ \\text{m/s}$，$v_\\parallel = 0.0\\ \\text{m/s}$。\n  - $\\phi_0 = -0.7$ 弧度，$\\mathbf{R}_{\\perp} = (0.0,0.0,0.0)\\ \\text{m}$，$z_0 = -0.02\\ \\text{m}$。\n  - 在 $5$ 个回旋周期内进行模拟，使用 $2000$ 个样本。\n\n实现要求：\n- 为每个案例构建与均匀磁场基本原理一致的解析轨道数据。生成 $\\mathbf{r}(t_i)$ 和 $\\mathbf{v}(t_i)$ 的数组，其中包括在垂直于 $\\mathbf{B}_0$ 的平面内的匀速圆周运动和沿 $\\mathbf{B}_0$ 的匀速平移。\n- 实现回旋相位分解算法，直接从 $\\mathbf{r}(t_i)$ 和 $\\mathbf{v}(t_i)$ 根据给定的 $q$、$m$ 和 $\\mathbf{B}_0$ 来计算 $\\mathbf{R}(t_i)$ 和 $\\rho(t_i)$。\n- 为每个案例计算两个验证指标，单位为米，以浮点数表示。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,...]\"）。\n- 按测试案例对结果进行排序，在每个测试案例中，先输出最大导引中心位置误差，然后是最大拉莫尔半径误差，两者单位均为米。对于四个测试案例，列表中总共将有八个数字。",
            "solution": "该问题是有效的，因为它在科学上基于经典力学和电磁学原理，问题提法清晰且数据充分，并且陈述客观。我们将从第一性原理出发推导一个解决方案。\n\n一个质量为 $m$、电荷为 $q$ 的粒子在静态均匀磁场 $\\mathbf{B}_0$ 中的运动由非相对论性洛伦兹力定律决定，其中电场为零：\n$$\nm\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B}_0)\n$$\n我们用速度的运动学定义来补充这个定律，$\\mathbf{v} = d\\mathbf{r}/dt$。\n\n首先，我们将粒子的速度矢量 $\\mathbf{v}$ 分解为平行和垂直于磁场的分量。令 $\\hat{\\mathbf{b}} = \\mathbf{B}_0 / |\\mathbf{B}_0|$ 为沿磁场方向的单位矢量。\n平行速度为 $\\mathbf{v}_\\parallel = (\\mathbf{v} \\cdot \\hat{\\mathbf{b}})\\hat{\\mathbf{b}}$，垂直速度为 $\\mathbf{v}_\\perp = \\mathbf{v} - \\mathbf{v}_\\parallel$。\n将 $\\mathbf{v} = \\mathbf{v}_\\parallel + \\mathbf{v}_\\perp$ 代入洛伦兹力定律：\n$$\nm\\frac{d}{dt}(\\mathbf{v}_\\parallel + \\mathbf{v}_\\perp) = q((\\mathbf{v}_\\parallel + \\mathbf{v}_\\perp) \\times \\mathbf{B}_0) = q(\\mathbf{v}_\\parallel \\times \\mathbf{B}_0) + q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)\n$$\n由于 $\\mathbf{v}_\\parallel$ 平行于 $\\mathbf{B}_0$，它们的叉积为零：$\\mathbf{v}_\\parallel \\times \\mathbf{B}_0 = \\mathbf{0}$。方程简化为：\n$$\nm\\frac{d\\mathbf{v}_\\parallel}{dt} + m\\frac{d\\mathbf{v}_\\perp}{dt} = q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)\n$$\n力矢量 $q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)$ 与 $\\mathbf{B}_0$ 正交，因此没有平行于磁场的分量。因此，我们可以将该方程分离为平行和垂直两个分量：\n1.  平行运动：$m\\frac{d\\mathbf{v}_\\parallel}{dt} = \\mathbf{0}$，这意味着 $\\mathbf{v}_\\parallel$ 是恒定的。粒子沿磁场线以匀速运动。\n2.  垂直运动：$m\\frac{d\\mathbf{v}_\\perp}{dt} = q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)$。这描述了在垂直于 $\\mathbf{B}_0$ 的平面内的运动。力始终垂直于 $\\mathbf{v}_\\perp$，因此它只改变速度的方向而不改变其大小，$v_\\perp = |\\mathbf{v}_\\perp|$。这是匀速圆周运动的方程。\n\n这个圆周运动的中心是导引中心，$\\mathbf{R}(t)$。粒子的位置 $\\mathbf{r}(t)$ 是导引中心位置和连接导引中心与粒子的回旋半径矢量 $\\boldsymbol{\\rho}(t)$ 的和：$\\mathbf{r}(t) = \\mathbf{R}(t) + \\boldsymbol{\\rho}(t)$。\n对这个分解求导得到 $\\mathbf{v} = \\dot{\\mathbf{R}} + \\dot{\\boldsymbol{\\rho}}$。我们将 $\\dot{\\mathbf{R}}$ 视为导引中心的速度，即平行速度 $\\mathbf{v}_\\parallel$，将 $\\dot{\\boldsymbol{\\rho}}$ 视为回旋运动的速度，即 $\\mathbf{v}_\\perp$。\n\n为了构建用于验证的解析轨道，我们求解这些运动方程。对于 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，其中 $B_0$ 是磁场大小：\n回旋的角频率是回旋频率，$\\Omega_c = q B_0 / m$。\n回旋半径矢量 $\\boldsymbol{\\rho}(t)$ 的运动由在 $x-y$ 平面内的旋转给出。其速度为 $\\mathbf{v}_\\perp(t) = \\dot{\\boldsymbol{\\rho}}(t)$，大小为 $v_\\perp$。拉莫尔半径为 $\\rho = v_\\perp / |\\Omega_c| = m v_\\perp / (|q| B_0)$。\n导引中心以恒定速度 $\\mathbf{v}_\\parallel$ 运动：$\\mathbf{R}(t) = \\mathbf{R}(0) + \\mathbf{v}_\\parallel t$。\n结合这些，解析轨迹为：\n$$\n\\mathbf{r}(t) = \\mathbf{R}(0) + \\mathbf{v}_\\parallel t + \\boldsymbol{\\rho}(t)\n$$\n$$\n\\mathbf{v}(t) = \\mathbf{v}_\\parallel + \\dot{\\boldsymbol{\\rho}}(t)\n$$\n这些方程用于生成测试数据 $\\{\\mathbf{r}(t_i)\\}$ 和 $\\{\\mathbf{v}(t_i)\\}$，以及导引中心 $\\{\\mathbf{R}_{\\text{analytic}}(t_i)\\}$ 和拉莫尔半径 $\\rho_{\\text{analytic}}$ 的解析基准真相。\n\n核心任务是推导一个算法，从 $\\mathbf{r}(t)$ 和 $\\mathbf{v}(t)$ 的瞬时值计算出 $\\mathbf{R}(t)$ 和 $\\rho(t)$。目标是通过找到回旋半径矢量 $\\boldsymbol{\\rho}$ 关于已知量的表达式来反转关系 $\\mathbf{r} = \\mathbf{R} + \\boldsymbol{\\rho}$。\n我们从垂直速度和回旋频率的关系出发。回旋半径矢量 $\\boldsymbol{\\rho}$ 与垂直速度 $\\mathbf{v}_\\perp$ 垂直，并且满足 $\\mathbf{v}_\\perp = \\dot{\\boldsymbol{\\rho}}$。在均匀磁场中，$\\mathbf{v}_\\perp$ 的运动方程 $\\dot{\\mathbf{v}}_\\perp = \\Omega_c (\\mathbf{v}_\\perp \\times \\hat{\\mathbf{b}})$ 可以积分得到 $\\mathbf{v}_\\perp$。反过来，我们可以从 $\\mathbf{v}_\\perp$ 得到 $\\boldsymbol{\\rho}$。\n标准关系是 $\\boldsymbol{\\rho} = \\frac{\\mathbf{v}_\\perp \\times \\hat{\\mathbf{b}}}{\\Omega_c}$。让我们验证一下。\n$\\dot{\\boldsymbol{\\rho}} = \\frac{\\dot{\\mathbf{v}}_\\perp \\times \\hat{\\mathbf{b}}}{\\Omega_c} = \\frac{(\\Omega_c (\\mathbf{v}_\\perp \\times \\hat{\\mathbf{b}})) \\times \\hat{\\mathbf{b}}}{\\Omega_c} = (\\mathbf{v}_\\perp \\times \\hat{\\mathbf{b}}) \\times \\hat{\\mathbf{b}} = \\hat{\\mathbf{b}}(\\mathbf{v}_\\perp \\cdot \\hat{\\mathbf{b}}) - \\mathbf{v}_\\perp(\\hat{\\mathbf{b}} \\cdot \\hat{\\mathbf{b}}) = 0 - \\mathbf{v}_\\perp = -\\mathbf{v}_\\perp$。\n这表明符号有误。正确的公式应该是：\n$$ \\boldsymbol{\\rho} = - \\frac{\\mathbf{v}_\\perp \\times \\hat{\\mathbf{b}}}{\\Omega_c} $$\n这样 $\\dot{\\boldsymbol{\\rho}} = \\mathbf{v}_\\perp$。\n将 $\\Omega_c = qB_0/m$ 和 $\\hat{\\mathbf{b}} = \\mathbf{B}_0/B_0$ 代入：\n$$ \\boldsymbol{\\rho} = - \\frac{\\mathbf{v}_\\perp \\times (\\mathbf{B}_0/B_0)}{qB_0/m} = -\\frac{m}{q B_0^2}(\\mathbf{v}_\\perp \\times \\mathbf{B}_0) $$\n因为 $\\mathbf{v}_\\parallel$ 与 $\\mathbf{B}_0$ 平行，$\\mathbf{v}_\\parallel \\times \\mathbf{B}_0 = 0$，所以 $\\mathbf{v}_\\perp \\times \\mathbf{B}_0 = (\\mathbf{v} - \\mathbf{v}_\\parallel) \\times \\mathbf{B}_0 = \\mathbf{v} \\times \\mathbf{B}_0$。因此：\n$$ \\boldsymbol{\\rho}(t) = -\\frac{m}{q |\\mathbf{B}_0|^2} (\\mathbf{v}(t) \\times \\mathbf{B}_0) = \\frac{m}{q |\\mathbf{B}_0|^2} (\\mathbf{B}_0 \\times \\mathbf{v}(t)) $$\n这个公式是从第一性原理推导出来的，允许直接计算回旋半径矢量。由此，我们得到导引中心位置和拉莫尔半径。\n\n最终要实现的算法如下：\n给定瞬时粒子固定数据 $\\mathbf{r}(t_i)$ 和 $\\mathbf{v}(t_i)$，以及常数 $m$、$q$ 和 $\\mathbf{B}_0$。\n1.  计算瞬时导引中心位置 $\\mathbf{R}_{\\text{alg}}(t_i)$：\n    $$\n    \\mathbf{R}_{\\text{alg}}(t_i) = \\mathbf{r}(t_i) - \\boldsymbol{\\rho}(t_i) = \\mathbf{r}(t_i) - \\frac{m}{q |\\mathbf{B}_0|^2} (\\mathbf{B}_0 \\times \\mathbf{v}(t_i))\n    $$\n2.  计算瞬时拉莫尔半径 $\\rho_{\\text{alg}}(t_i)$，即回旋半径矢量的大小：\n    $$\n    \\rho_{\\text{alg}}(t_i) = \\left\\| \\boldsymbol{\\rho}(t_i) \\right\\|_2 = \\left\\| \\frac{m}{q |\\mathbf{B}_0|^2} (\\mathbf{B}_0 \\times \\mathbf{v}(t_i)) \\right\\|_2\n    $$\n该算法是鲁棒的，能正确处理垂直或平行速度为零的情况。对于 $v_\\perp=0$，$\\mathbf{v}$ 平行于 $\\mathbf{B}_0$，叉积为零，得到 $\\boldsymbol{\\rho}=\\mathbf{0}$，因此 $\\mathbf{R}=\\mathbf{r}$ 和 $\\rho=0$，符合预期。验证将包括将此算法应用于解析生成的轨迹，并将结果与已知的解析 $\\mathbf{R}_{\\text{analytic}}(t)$ 和 $\\rho_{\\text{analytic}}$ 进行比较。",
            "answer": "```python\nimport numpy as np\n\ndef run_case(case_params):\n    \"\"\"\n    Generates analytic orbit, applies the decomposition algorithm,\n    and computes validation metrics for a single test case.\n    \"\"\"\n    # Unpack case parameters\n    q = case_params[\"q\"]\n    m = case_params[\"m\"]\n    B0_vec = np.array(case_params[\"B0_vec\"])\n    v_perp_mag = case_params[\"v_perp\"]\n    v_para_mag = case_params[\"v_para\"]\n    phi0 = case_params[\"phi0\"]\n    R_perp = np.array(case_params[\"R_perp\"])\n    z0 = case_params[\"z0\"]\n    num_periods = case_params[\"num_periods\"]\n    num_samples = case_params[\"num_samples\"]\n\n    B0_mag = np.linalg.norm(B0_vec)\n    b_hat = B0_vec / B0_mag if B0_mag > 1e-12 else np.array([0, 0, 1])\n\n    # --- 1. Generate Analytic Orbit Data (Ground Truth) ---\n\n    Omega_c = q * B0_mag / m if m > 0 else 0\n    \n    if abs(q * B0_mag) > 1e-12:\n        rho_analytic_scalar = m * v_perp_mag / (abs(q) * B0_mag)\n    else:\n        rho_analytic_scalar = 0.0\n\n    if abs(Omega_c) > 1e-12:\n        T_c = 2 * np.pi / abs(Omega_c)\n        t_end = num_periods * T_c\n    else:\n        T_c = 1.0\n        t_end = 1.0 if num_periods > 0 else 0.0\n\n    t = np.linspace(0, t_end, num_samples)\n\n    # Generate analytic position and velocity time series\n    # For B = B0_mag * z_hat\n    theta = Omega_c * t + phi0\n    \n    r_perp_x = R_perp[0] + rho_analytic_scalar * np.cos(theta)\n    r_perp_y = R_perp[1] + rho_analytic_scalar * np.sin(theta)\n    \n    v_perp_x = -rho_analytic_scalar * Omega_c * np.sin(theta)\n    v_perp_y = rho_analytic_scalar * Omega_c * np.cos(theta)\n\n    r_para_z = R_perp[2] + z0 + v_para_mag * t\n    v_para_z = np.full_like(t, v_para_mag)\n    \n    r_input = np.vstack([r_perp_x, r_perp_y, r_para_z]).T\n    v_input = np.vstack([v_perp_x, v_perp_y, v_para_z]).T\n    \n    # Generate analytic guiding center and Larmor radius for comparison\n    v_para_vec_t = v_para_mag * b_hat\n    R_analytic = np.tile(R_perp, (num_samples, 1))\n    R_analytic[:, 2] += z0\n    R_analytic += t[:, np.newaxis] * v_para_vec_t\n    \n    rho_analytic = np.full(num_samples, rho_analytic_scalar)\n\n    # --- 2. Apply the Gyro-Phase Decomposition Algorithm ---\n\n    B0_mag_sq = B0_mag**2\n    \n    # This is -(v x B) = B x v\n    B_cross_v = np.cross(B0_vec, v_input)\n    \n    # This is the gyro-radius vector rho = (m / (q * B^2)) * (B x v)\n    gyro_vector = (m / (q * B0_mag_sq)) * B_cross_v if q != 0 and B0_mag_sq != 0 else np.zeros_like(r_input)\n    \n    # R = r - rho\n    R_alg = r_input - gyro_vector\n    \n    rho_alg = np.linalg.norm(gyro_vector, axis=1)\n\n    # --- 3. Compute Validation Metrics ---\n\n    R_error_mag = np.linalg.norm(R_alg - R_analytic, axis=1)\n    max_R_error = np.max(R_error_mag) if R_error_mag.size > 0 else 0.0\n\n    rho_error_mag = np.abs(rho_alg - rho_analytic)\n    max_rho_error = np.max(rho_error_mag) if rho_error_mag.size > 0 else 0.0\n\n    return max_R_error, max_rho_error\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    e_charge = 1.602176634e-19\n\n    test_cases = [\n        {\n            \"name\": \"deuteron\",\n            \"q\": +1 * e_charge, \"m\": 3.343583719e-27,\n            \"B0_vec\": (0.0, 0.0, 5.0), \"v_perp\": 1.0e5, \"v_para\": 1.0e4,\n            \"phi0\": 0.3, \"R_perp\": (0.02, -0.015, 0.0), \"z0\": 0.0,\n            \"num_periods\": 2, \"num_samples\": 1200,\n        },\n        {\n            \"name\": \"electron\",\n            \"q\": -1 * e_charge, \"m\": 9.10938356e-31,\n            \"B0_vec\": (0.0, 0.0, 2.0), \"v_perp\": 3.0e6, \"v_para\": 1.0e5,\n            \"phi0\": 1.2, \"R_perp\": (-0.001, 0.002, 0.0), \"z0\": 0.0,\n            \"num_periods\": 3, \"num_samples\": 1500,\n        },\n        {\n            \"name\": \"alpha_zero_vperp\",\n            \"q\": +2 * e_charge, \"m\": 6.644657e-27,\n            \"B0_vec\": (0.0, 0.0, 3.0), \"v_perp\": 0.0, \"v_para\": 2.0e4,\n            \"phi0\": 0.0, \"R_perp\": (0.05, 0.05, 0.0), \"z0\": 0.1,\n            \"num_periods\": 1, \"num_samples\": 800,\n        },\n        {\n            \"name\": \"alpha_zero_vpara\",\n            \"q\": +2 * e_charge, \"m\": 6.644657e-27,\n            \"B0_vec\": (0.0, 0.0, 10.0), \"v_perp\": 5.0e4, \"v_para\": 0.0,\n            \"phi0\": -0.7, \"R_perp\": (0.0, 0.0, 0.0), \"z0\": -0.02,\n            \"num_periods\": 5, \"num_samples\": 2000,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        max_R_error, max_rho_error = run_case(case)\n        results.extend([max_R_error, max_rho_error])\n    \n    print(f\"[{','.join(f'{r:.17e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}