{
    "hands_on_practices": [
        {
            "introduction": "在磁约束聚变中，一个核心原则是带电粒子被磁力线紧紧束缚，从而限制其横越磁场的运动。此练习旨在量化这一关键概念，即将单个粒子的回旋运动与等离子体中的集体碰撞过程联系起来。通过计算和比较回旋频率与碰撞频率 ()，您将能评估在典型的聚变装置条件下，电子和离子在何种程度上被“磁化”，这是理解并设计有效磁约束方案的基础。",
            "id": "3963204",
            "problem": "一种代表紧凑型聚变装置的准中性、单一成分的氘等离子体，其特征参数如下：电子数密度 $n_{e} = 4.0 \\times 10^{19}~\\text{m}^{-3}$，离子数密度 $n_{i} = 4.0 \\times 10^{19}~\\text{m}^{-3}$，电子温度 $T_{e} = 7.5~\\text{keV}$，离子温度 $T_{i} = 10~\\text{keV}$，以及均匀磁场 $B = 3.2~\\text{T}$。离子是电荷数 $Z = 1$ 的单电荷氘核。在此状态下，库仑对数为 $\\ln \\Lambda = 16$。请利用基本原理和经过充分检验的输运理论，通过计算无量纲磁化参数来确定电子和离子的磁化程度：\n$$M_{e} = \\frac{\\nu_{ei}}{\\Omega_{e}}, \\quad M_{i} = \\frac{\\nu_{ii}}{\\Omega_{i}},$$\n其中 $\\nu_{ei}$ 是电子-离子碰撞频率，$\\nu_{ii}$ 是离子-离子碰撞频率，$\\Omega_{e}$ 和 $\\Omega_{i}$ 分别是电子和离子的回旋频率。请从第一性原理出发，推导 $\\Omega_{s}$ 和 $\\nu_{ss'}$ 所使用的表达式，然后对给定的等离子体状态数值计算 $M_{e}$ 和 $M_{i}$。\n\n使用以下常数：基本电荷 $e = 1.602176634 \\times 10^{-19}~\\text{C}$，电子质量 $m_{e} = 9.1093837015 \\times 10^{-31}~\\text{kg}$，氘核质量 $m_{D} = 3.343583719 \\times 10^{-27}~\\text{kg}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}~\\text{J/K}$，以及真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}~\\text{F/m}$。\n\n说明：\n- 将电子和离子的速度分布视为麦克斯韦分布。\n- 碰撞频率的计算应基于在麦克斯韦分布上取平均的小角度库仑散射。\n- 以两个无量纲比值 $M_{e}$ 和 $M_{i}$ 的形式表示最终答案。\n- 将每个比值四舍五入到三位有效数字。\n- 以无量纲数的形式报告最终结果。最终方框内的答案不应包含单位。",
            "solution": "该问题是有效的，因为它具有科学依据、适定、客观，并包含获得唯一解所需的所有信息。所提供的参数与磁约束聚变研究中的参数一致。该任务是等离子体物理学中的一个标准计算。\n\n目标是计算电子和离子的磁化参数，分别定义为 $M_{e} = \\frac{\\nu_{ei}}{\\Omega_{e}}$ 和 $M_{i} = \\frac{\\nu_{ii}}{\\Omega_{i}}$。这些无量纲量比较了倾向于破坏粒子轨道的碰撞率与围绕磁力线的回旋率。一个很小的值（$M_s \\ll 1$）表明粒子种类 $s$ 是强磁化的，意味着在一次碰撞显著改变其轨道之前，它会完成许多次回旋。我们将首先从基本原理出发，推导回旋频率 $\\Omega_s$ 和碰撞频率 $\\nu_{ss'}$ 的表达式。\n\n回旋频率（或称陀螺频率）描述了带电粒子在均匀磁场中做圆周运动的角频率。这种运动源于洛伦兹力 $\\mathbf{F} = q_s(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$。在没有电场（$\\mathbf{E}=0$）的情况下，力纯粹是磁力：$\\mathbf{F} = q_s(\\mathbf{v} \\times \\mathbf{B})$。这个力总是垂直于速度 $\\mathbf{v}$ 和磁场 $\\mathbf{B}$。对于垂直于磁场的速度分量 $v_\\perp$，磁力提供了圆周运动所需的向心力：\n$$ |q_s| v_\\perp B = \\frac{m_s v_\\perp^2}{r_L} $$\n其中 $q_s$ 是粒子种类 $s$ 的电荷，$m_s$ 是其质量，$r_L$ 是回旋半径（或拉莫尔半径）。这种圆周运动的角频率是 $\\Omega_s = v_\\perp / r_L$。从力平衡方程中，我们推导出回旋频率的表达式：\n$$ \\Omega_s = \\frac{|q_s| B}{m_s} $$\n频率被定义为一个正量，因此取电荷的绝对值。对于本问题中的粒子种类：\n电子回旋频率为：\n$$ \\Omega_e = \\frac{e B}{m_e} $$\n因为电子电荷为 $|q_e| = |-e| = e$。\n离子（氘核）回旋频率为：\n$$ \\Omega_i = \\frac{|q_i| B}{m_i} = \\frac{Z e B}{m_D} $$\n其中 $Z=1$ 是电荷数，$m_i = m_D$ 是氘核质量。\n\n碰撞频率 $\\nu_{ei}$ 和 $\\nu_{ii}$ 表示由库仑碰撞引起的动量传递率。在高温、完全电离的等离子体中，碰撞主要由许多小角度散射事件的累积效应主导。此处使用的公式是通过在相互作用的粒子种类的麦克斯韦速度分布上对动量传递截面进行平均而得出的。\n\n电子-离子碰撞频率 $\\nu_{ei}$，表征电子因与离子碰撞而损失动量的速率，由标准的 Spitzer-Braginskii 公式给出：\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi} n_i Z^2 e^4 \\ln \\Lambda}{3 m_e^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2}} $$\n此处，$n_i$ 是离子数密度，$Z$ 是离子电荷数，$e$ 是基本电荷，$\\ln \\Lambda$ 是库仑对数，$m_e$ 是电子质量，$\\varepsilon_0$ 是真空介电常数，$k_B T_e$ 是电子热能。$T_e^{-3/2}$ 的依赖关系源于卢瑟福散射截面对相对速度的依赖性。\n\n离子-离子碰撞频率 $\\nu_{ii}$ 与此类似，但描述的是同种粒子（离子）之间的碰撞。其公式为：\n$$ \\nu_{ii} = \\frac{4 \\sqrt{\\pi} n_i Z^4 e^4 \\ln \\Lambda}{3 m_i^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_i)^{3/2}} $$\n注意与 $\\nu_{ei}$ 的区别：质量是离子质量 $m_i$，温度是离子温度 $T_i$，电荷数是四次方（$Z^4$），并且由于计算涉及同种粒子碰撞，数值前因子包含 $\\sqrt{\\pi}$ 而不是 $\\sqrt{2\\pi}$。\n\n现在我们可以构建磁化参数的表达式。\n对于电子：\n$$ M_e = \\frac{\\nu_{ei}}{\\Omega_e} = \\left( \\frac{4 \\sqrt{2\\pi} n_i Z^2 e^4 \\ln \\Lambda}{3 m_e^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2}} \\right) \\left( \\frac{m_e}{e B} \\right) = \\frac{4 \\sqrt{2\\pi} n_i Z^2 e^3 m_e^{1/2} \\ln \\Lambda}{3 (4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2} B} $$\n对于离子：\n$$ M_i = \\frac{\\nu_{ii}}{\\Omega_i} = \\left( \\frac{4 \\sqrt{\\pi} n_i Z^4 e^4 \\ln \\Lambda}{3 m_i^{1/2} (4\\pi\\varepsilon_0)^2 (k_B T_i)^{3/2}} \\right) \\left( \\frac{m_i}{Z e B} \\right) = \\frac{4 \\sqrt{\\pi} n_i Z^3 e^3 m_i^{1/2} \\ln \\Lambda}{3 (4\\pi\\varepsilon_0)^2 (k_B T_i)^{3/2} B} $$\n\n现在我们使用所提供的数据进行数值计算：\n- 电子/离子密度：$n_e = n_i = 4.0 \\times 10^{19}~\\text{m}^{-3}$\n- 电子温度：$T_e = 7.5~\\text{keV}$\n- 离子温度：$T_i = 10~\\text{keV}$\n- 磁场：$B = 3.2~\\text{T}$\n- 离子电荷数：$Z = 1$\n- 库仑对数：$\\ln \\Lambda = 16$\n- 基本电荷：$e = 1.602176634 \\times 10^{-19}~\\text{C}$\n- 电子质量：$m_e = 9.1093837015 \\times 10^{-31}~\\text{kg}$\n- 氘核质量：$m_D = 3.343583719 \\times 10^{-27}~\\text{kg}$\n- 真空介电常数：$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}~\\text{F/m}$\n\n首先，我们将以千电子伏特（keV）为单位给出的温度转换为焦耳。\n$$ k_B T_e = 7.5 \\times 10^3~\\text{eV} \\times (1.602176634 \\times 10^{-19}~\\text{J/eV}) = 1.2016324755 \\times 10^{-15}~\\text{J} $$\n$$ k_B T_i = 10 \\times 10^3~\\text{eV} \\times (1.602176634 \\times 10^{-19}~\\text{J/eV}) = 1.602176634 \\times 10^{-15}~\\text{J} $$\n\n接下来，我们计算回旋频率：\n$$ \\Omega_e = \\frac{e B}{m_e} = \\frac{(1.60217... \\times 10^{-19}~\\text{C})(3.2~\\text{T})}{9.10938... \\times 10^{-31}~\\text{kg}} \\approx 5.6267 \\times 10^{11}~\\text{rad/s} $$\n$$ \\Omega_i = \\frac{Z e B}{m_D} = \\frac{(1)(1.60217... \\times 10^{-19}~\\text{C})(3.2~\\text{T})}{3.34358... \\times 10^{-27}~\\text{kg}} \\approx 1.5317 \\times 10^{8}~\\text{rad/s} $$\n\n然后，我们计算碰撞频率。对于 $\\nu_{ei}$，其中 $Z=1$ 且 $n_i=n_e$：\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi} (4.0 \\times 10^{19}) (1)^2 (1.602... \\times 10^{-19})^4 (16)}{3 (9.109... \\times 10^{-31})^{1/2} (4\\pi \\times 8.854... \\times 10^{-12})^2 (1.2016... \\times 10^{-15})^{3/2}} \\approx 9.0441 \\times 10^3~\\text{s}^{-1} $$\n对于 $\\nu_{ii}$：\n$$ \\nu_{ii} = \\frac{4 \\sqrt{\\pi} (4.0 \\times 10^{19}) (1)^4 (1.602... \\times 10^{-19})^4 (16)}{3 (3.343... \\times 10^{-27})^{1/2} (4\\pi \\times 8.854... \\times 10^{-12})^2 (1.602... \\times 10^{-15})^{3/2}} \\approx 68.513~\\text{s}^{-1} $$\n\n最后，我们计算磁化参数：\n$$ M_e = \\frac{\\nu_{ei}}{\\Omega_e} = \\frac{9.0441 \\times 10^3~\\text{s}^{-1}}{5.6267 \\times 10^{11}~\\text{rad/s}} \\approx 1.6073 \\times 10^{-8} $$\n$$ M_i = \\frac{\\nu_{ii}}{\\Omega_i} = \\frac{68.513~\\text{s}^{-1}}{1.5317 \\times 10^{8}~\\text{rad/s}} \\approx 4.4729 \\times 10^{-7} $$\n这些值非常小，表明在这种等离子体中电子和离子都被非常强地磁化，这是实现有效磁约束的先决条件。一个电子在两次碰撞之间平均完成约 $1/M_e \\approx 6.2 \\times 10^7$ 次回旋，一个离子则完成约 $1/M_i \\approx 2.2 \\times 10^6$ 次回旋。\n\n按要求将最终结果四舍五入到三位有效数字：\n$M_e = 1.61 \\times 10^{-8}$\n$M_i = 4.47 \\times 10^{-7}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.61 \\times 10^{-8}  4.47 \\times 10^{-7} \\end{pmatrix} } $$"
        },
        {
            "introduction": "理论模型通常使用导心和拉莫尔半径等简化坐标来描述等离子体动力学，但在模拟或实验中，我们首先获得的是海量的粒子瞬时位置和速度数据。本练习旨在弥合理论与实际数据分析之间的鸿沟，要求您从第一性原理出发，推导并实施一个算法，从原始的粒子轨迹数据中精确计算出瞬时导心位置和拉莫尔半径 ()。这项任务不仅能加深您对导心理论的理解，也是计算等离子体物理学家必备的一项核心数据处理技能。",
            "id": "3963203",
            "problem": "给定均匀磁化单粒子数据，其包含在静态、空间均匀磁场中带电粒子的位置和速度时间序列。从第一性原理出发，推导并实现一个算法，在每个时刻通过相对于磁场方向运动的回旋相位分解，计算瞬时导心 (GC) 位置 $\\mathbf{R}(t)$ 和瞬时拉莫尔半径 $\\rho(t)$。使用已知均匀磁场下的解析轨道来验证该算法。\n\n仅使用以下基本原理：非相对论性洛伦兹力定律 $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$，运动学恒等式 $\\mathbf{v} = d\\mathbf{r}/dt$，以及将任意向量分解为平行于和垂直于给定单位向量的分量。请勿在问题陈述中使用预先推导的导心位置或拉莫尔半径的快捷公式；相反，应基于这些基本原理进行推理，以定义一个可计算的回旋相位分解以及相关的导心和半径。\n\n科学情景和约束条件：\n- 磁场是恒定且空间均匀的：$\\mathbf{B}(\\mathbf{r},t) = \\mathbf{B}_0$。\n- 对于每个案例，粒子质量 $m$ 和电荷 $q$ 随时间保持不变。\n- 粒子运动可包括平行于 $\\mathbf{B}_0$ 的分量，以及在垂直于 $\\mathbf{B}_0$ 的平面上的圆周运动。\n- 所有计算必须以国际单位制 (SI) 表示：位置单位为米，速度单位为米/秒，磁场单位为特斯拉，电荷单位为库仑，质量单位为千克，时间单位为秒。如果在回旋相位分析中引入角度，请以弧度表示。\n- 您的算法必须直接对所提供的数组 $\\{\\mathbf{r}(t_i)\\}$ 和 $\\{\\mathbf{v}(t_i)\\}$ 进行操作，生成数组 $\\{\\mathbf{R}(t_i)\\}$ 和 $\\{\\rho(t_i)\\}$。\n\n验证方法：\n- 对于均匀磁场，解析轨道是已知的：垂直运动是以恒定角频率进行的匀速圆周运动，平行运动是匀速平移。为下方的测试套件构建解析轨道，并计算每个时间样本下解析预期的导心位置和拉莫爾半径。将您的算法输出与这些解析预期值进行比较。\n- 通过计算每个测试案例的两个标量指标来量化验证结果：\n  1. 导心在整个时间序列中的最大绝对位置误差，定义为 $\\max_i \\|\\mathbf{R}_{\\text{alg}}(t_i) - \\mathbf{R}_{\\text{analytic}}(t_i)\\|$（单位：米）。\n  2. 拉莫尔半径在整个时间序列中的最大绝对误差，定义为 $\\max_i |\\rho_{\\text{alg}}(t_i) - \\rho_{\\text{analytic}}|$（单位：米）。\n- 以浮点数形式报告这些指标，单位为米。\n\n测试套件（四个案例），所有案例的 $\\mathbf{B}_0$ 均与 $z$ 轴对齐：\n- 案例1（氘核，典型托卡马克场）：\n  - $q = +1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 3.343583719\\times 10^{-27}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,5.0)\\ \\text{T}$。\n  - 垂直速度大小 $v_\\perp = 1.0\\times 10^{5}\\ \\text{m/s}$。\n  - 平行速度 $v_\\parallel = 1.0\\times 10^{4}\\ \\text{m/s}$。\n  - 初始回旋相位 $\\phi_0 = 0.3$ 弧度。\n  - 导心垂直偏移量 $\\mathbf{R}_{\\perp} = (0.02,-0.015,0.0)\\ \\text{m}$。\n  - 初始平行位置 $z_0 = 0.0\\ \\text{m}$。\n  - 模拟 $2$ 个回旋周期，使用 $1200$ 个均匀时间间隔的采样点。\n- 案例2（电子，负电荷，更高速度）：\n  - $q = -1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 9.10938356\\times 10^{-31}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,2.0)\\ \\text{T}$。\n  - $v_\\perp = 3.0\\times 10^{6}\\ \\text{m/s}$，$v_\\parallel = 1.0\\times 10^{5}\\ \\text{m/s}$。\n  - $\\phi_0 = 1.2$ 弧度，$\\mathbf{R}_{\\perp} = (-0.001,0.002,0.0)\\ \\text{m}$，$z_0 = 0.0\\ \\text{m}$。\n  - 模拟 $3$ 个回旋周期，使用 $1500$ 个采样点。\n- 案例3（α粒子，垂直速度为零的边界情况）：\n  - $q = +2\\times 1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 6.644657\\times 10^{-27}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,3.0)\\ \\text{T}$。\n  - $v_\\perp = 0.0\\ \\text{m/s}$，$v_\\parallel = 2.0\\times 10^{4}\\ \\text{m/s}$。\n  - $\\phi_0 = 0.0$ 弧度，$\\mathbf{R}_{\\perp} = (0.05,0.05,0.0)\\ \\text{m}$，$z_0 = 0.1\\ \\text{m}$。\n  - 模拟 $1$ 个回旋周期，使用 $800$ 个采样点。\n- 案例4（α粒子，强磁场，多周期，非零相位）：\n  - $q = +2\\times 1.602176634\\times 10^{-19}\\ \\text{C}$，$m = 6.644657\\times 10^{-27}\\ \\text{kg}$。\n  - $\\mathbf{B}_0 = (0,0,10.0)\\ \\text{T}$。\n  - $v_\\perp = 5.0\\times 10^{4}\\ \\text{m/s}$，$v_\\parallel = 0.0\\ \\text{m/s}$。\n  - $\\phi_0 = -0.7$ 弧度，$\\mathbf{R}_{\\perp} = (0.0,0.0,0.0)\\ \\text{m}$，$z_0 = -0.02\\ \\text{m}$。\n  - 模拟 $5$ 个回旋周期，使用 $2000$ 个采样点。\n\n实现要求：\n- 为每个案例构建与均匀磁场基本原理一致的解析轨道数据。生成数组 $\\mathbf{r}(t_i)$ 和 $\\mathbf{v}(t_i)$，其中包含在垂直于 $\\mathbf{B}_0$ 的平面上的匀速圆周运动和沿 $\\mathbf{B}_0$ 的匀速平移。\n- 实现回旋相位分解算法，根据给定的 $q$、$m$ 和 $\\mathbf{B}_0$，直接从 $\\mathbf{r}(t_i)$ 和 $\\mathbf{v}(t_i)$ 计算 $\\mathbf{R}(t_i)$ 和 $\\rho(t_i)$。\n- 为每个案例计算两个验证指标，单位为米，以浮点数表示。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,...]”）。\n- 按测试案例对结果进行排序，并在每个测试案例中，先输出最大导心位置误差，然后是最大拉莫尔半径误差，两者单位均为米。对于四个测试案例，列表中总共将有八个数字。",
            "solution": "该问题是有效的，因为它在科学上基于经典力学和电磁学原理，问题提法适定且数据充分，陈述客观。我们将从第一性原理出发推导解答。\n\n在静态、均匀磁场 $\\mathbf{B}_0$ 中，质量为 $m$、电荷为 $q$ 的粒子的运动由非相对论性洛伦兹力定律决定，其中电场为零：\n$$\nm\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B}_0)\n$$\n我们用速度的运动学定义 $\\mathbf{v} = d\\mathbf{r}/dt$ 对其进行补充。\n\n首先，我们将粒子的速度矢量 $\\mathbf{v}$ 分解为平行于和垂直于磁场的分量。令 $\\hat{\\mathbf{b}} = \\mathbf{B}_0 / |\\mathbf{B}_0|$ 为沿磁场方向的单位矢量。\n平行速度为 $\\mathbf{v}_\\parallel = (\\mathbf{v} \\cdot \\hat{\\mathbf{b}})\\hat{\\mathbf{b}}$，垂直速度为 $\\mathbf{v}_\\perp = \\mathbf{v} - \\mathbf{v}_\\parallel$。\n将 $\\mathbf{v} = \\mathbf{v}_\\parallel + \\mathbf{v}_\\perp$ 代入洛伦兹力定律：\n$$\nm\\frac{d}{dt}(\\mathbf{v}_\\parallel + \\mathbf{v}_\\perp) = q((\\mathbf{v}_\\parallel + \\mathbf{v}_\\perp) \\times \\mathbf{B}_0) = q(\\mathbf{v}_\\parallel \\times \\mathbf{B}_0) + q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)\n$$\n由于 $\\mathbf{v}_\\parallel$ 平行于 $\\mathbf{B}_0$，它们的叉积为零：$\\mathbf{v}_\\parallel \\times \\mathbf{B}_0 = \\mathbf{0}$。方程简化为：\n$$\nm\\frac{d\\mathbf{v}_\\parallel}{dt} + m\\frac{d\\mathbf{v}_\\perp}{dt} = q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)\n$$\n力矢量 $q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)$ 与 $\\mathbf{B}_0$ 正交，因此没有平行于磁场的分量。因此，我们可以将方程分解为平行和垂直分量：\n1.  平行运动：$m\\frac{d\\mathbf{v}_\\parallel}{dt} = \\mathbf{0}$，这意味着 $\\mathbf{v}_\\parallel$ 是恒定的。粒子沿磁力线以匀速运动。\n2.  垂直运动：$m\\frac{d\\mathbf{v}_\\perp}{dt} = q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)$。这描述了在垂直于 $\\mathbf{B}_0$ 的平面内的运动。力始终垂直于 $\\mathbf{v}_\\perp$，因此它只改变速度的方向而不改变其大小 $v_\\perp = |\\mathbf{v}_\\perp|$。这是匀速圆周运动的方程。\n\n这个圆周运动的中心是导心 $\\mathbf{R}(t)$。粒子的位置 $\\mathbf{r}(t)$ 是导心位置和连接导心与粒子的回旋半径矢量 $\\boldsymbol{\\rho}(t)$ 的和：$\\mathbf{r}(t) = \\mathbf{R}(t) + \\boldsymbol{\\rho}(t)$。\n对该分解求导得到 $\\mathbf{v} = \\dot{\\mathbf{R}} + \\dot{\\boldsymbol{\\rho}}$。我们将 $\\dot{\\mathbf{R}}$ 视为导心的速度，即平行速度 $\\mathbf{v}_\\parallel$，将 $\\dot{\\boldsymbol{\\rho}}$ 视为回旋运动的速度，即 $\\mathbf{v}_\\perp$。\n\n为了构建用于验证的解析轨道，我们求解这些运动方程。对于 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，其中 $B_0$ 是带符号的大小 $B_z$：\n回旋的角频率是回旋频率 $\\Omega_c = q B_0 / m$。\n回旋半径矢量 $\\boldsymbol{\\rho}(t)$ 的运动由 $x-y$ 平面内的旋转给出：\n$$\n\\boldsymbol{\\rho}(t) = \\rho \\begin{pmatrix} \\cos(\\Omega_c t + \\phi_0) \\\\ \\sin(\\Omega_c t + \\phi_0) \\\\ 0 \\end{pmatrix}\n$$\n其中 $\\phi_0$ 是初始回旋相位，$\\rho$ 是拉莫尔半径。垂直速度是 $\\mathbf{v}_\\perp(t) = \\dot{\\boldsymbol{\\rho}}(t)$，其大小为 $v_\\perp = |\\dot{\\boldsymbol{\\rho}}| = |\\Omega_c| \\rho$。由此可得恒定的拉莫尔半径为 $\\rho = v_\\perp / |\\Omega_c| = m v_\\perp / (|q| B_0)$。\n导心以恒定速度 $\\mathbf{v}_\\parallel$ 运动：$\\mathbf{R}(t) = \\mathbf{R}(0) + \\mathbf{v}_\\parallel t$。\n综合这些，解析轨迹为：\n$$\n\\mathbf{r}(t) = \\mathbf{R}(0) + \\mathbf{v}_\\parallel t + \\boldsymbol{\\rho}(t)\n$$\n$$\n\\mathbf{v}(t) = \\mathbf{v}_\\parallel + \\dot{\\boldsymbol{\\rho}}(t)\n$$\n这些方程用于生成测试数据 $\\{\\mathbf{r}(t_i)\\}$ 和 $\\{\\mathbf{v}(t_i)\\}$，以及用于比较的解析基准值，即导心 $\\{\\mathbf{R}_{\\text{analytic}}(t_i)\\}$ 和拉莫尔半径 $\\rho_{\\text{analytic}}$。\n\n核心任务是推导一个算法，从 $\\mathbf{r}(t)$ 和 $\\mathbf{v}(t)$ 的瞬时值计算 $\\mathbf{R}(t)$ 和 $\\rho(t)$。目标是通过找到回旋半径矢量 $\\boldsymbol{\\rho}$ 关于已知量的表达式来反演关系 $\\mathbf{r} = \\mathbf{R} + \\boldsymbol{\\rho}$。\n从垂直运动方程可知，加速度为 $\\mathbf{a}_\\perp = \\dot{\\mathbf{v}}_\\perp = \\frac{q}{m}(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)$。对于匀速圆周运动，加速度矢量 $\\mathbf{a}_\\perp$ 是向心的，从粒子指向导心，即方向为 $-\\boldsymbol{\\rho}$。因此，$\\boldsymbol{\\rho}$ 与 $\\mathbf{a}_\\perp$ 反平行。\n这意味着 $\\boldsymbol{\\rho}$ 平行于 $-(\\mathbf{v}_\\perp \\times \\mathbf{B}_0) = \\mathbf{B}_0 \\times \\mathbf{v}_\\perp$。我们可以写成 $\\boldsymbol{\\rho} = C(\\mathbf{B}_0 \\times \\mathbf{v}_\\perp)$，其中 $C$ 是某个标量。\n其大小为 $|\\boldsymbol{\\rho}| = \\rho = |C| |\\mathbf{B}_0 \\times \\mathbf{v}_\\perp| = |C| B_0 v_\\perp$。\n因为我们知道 $\\rho = \\frac{m v_\\perp}{|q| B_0}$，所以可以解出 $|C|$：\n$$\n|C| B_0 v_\\perp = \\frac{m v_\\perp}{|q| B_0} \\implies |C| = \\frac{m}{|q| B_0^2}\n$$\n向心力是 $q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)$，它必须指向中心，即沿 $-\\boldsymbol{\\rho}$ 方向。所以，$-\\boldsymbol{\\rho}$ 与 $q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0)$ 方向相同。这意味着 $\\boldsymbol{\\rho}$ 与 $-q(\\mathbf{v}_\\perp \\times \\mathbf{B}_0) = q(\\mathbf{B}_0 \\times \\mathbf{v}_\\perp)$ 方向相同。\n我们的拟设是 $\\boldsymbol{\\rho} = C(\\mathbf{B}_0 \\times \\mathbf{v}_\\perp)$，所以 $C$ 必须与 $q$ 同号。\n结合大小和符号的要求，我们发现 $C = \\frac{m}{q B_0^2}$。\n因此，回旋半径矢量为：\n$$\n\\boldsymbol{\\rho} = \\frac{m}{q B_0^2} (\\mathbf{B}_0 \\times \\mathbf{v}_\\perp)\n$$\n由于 $\\mathbf{B}_0 \\times \\mathbf{v} = \\mathbf{B}_0 \\times (\\mathbf{v}_\\parallel + \\mathbf{v}_\\perp) = \\mathbf{B}_0 \\times \\mathbf{v}_\\perp$，我们可以用总速度 $\\mathbf{v}$ 来表示它：\n$$\n\\boldsymbol{\\rho}(t) = \\frac{m}{q |\\mathbf{B}_0|^2} (\\mathbf{B}_0 \\times \\mathbf{v}(t))\n$$\n这个公式是从第一性原理推导出来的，允许直接计算回旋半径矢量。由此，我们得到导心位置和拉莫尔半径。\n\n最终要实现的算法如下：\n给定瞬时粒子固定数据 $\\mathbf{r}(t_i)$ 和 $\\mathbf{v}(t_i)$，以及常数 $m$、$q$ 和 $\\mathbf{B}_0$。\n1.  计算瞬时导心位置 $\\mathbf{R}_{\\text{alg}}(t_i)$：\n    $$\n    \\mathbf{R}_{\\text{alg}}(t_i) = \\mathbf{r}(t_i) - \\frac{m}{q |\\mathbf{B}_0|^2} (\\mathbf{B}_0 \\times \\mathbf{v}(t_i))\n    $$\n2.  计算瞬时拉莫尔半径 $\\rho_{\\text{alg}}(t_i)$，作为回旋半径矢量的大小：\n    $$\n    \\rho_{\\text{alg}}(t_i) = \\left\\| \\mathbf{r}(t_i) - \\mathbf{R}_{\\text{alg}}(t_i) \\right\\|_2 = \\left\\| \\frac{m}{q |\\mathbf{B}_0|^2} (\\mathbf{B}_0 \\times \\mathbf{v}(t_i)) \\right\\|_2\n    $$\n该算法是稳健的，能正确处理垂直或平行速度为零的情况。对于 $v_\\perp=0$，$\\mathbf{v}$ 平行于 $\\mathbf{B}_0$，叉积为零，得到 $\\mathbf{R}=\\mathbf{r}$ 和 $\\rho=0$，符合预期。验证过程将包括将此算法应用于解析生成的轨迹，并将结果与已知的解析 $\\mathbf{R}_{\\text{analytic}}(t)$ 和 $\\rho_{\\text{analytic}}$ 进行比较。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(case_params):\n    \"\"\"\n    Generates analytic orbit, applies the decomposition algorithm,\n    and computes validation metrics for a single test case.\n    \"\"\"\n    # Unpack case parameters\n    q = case_params[\"q\"]\n    m = case_params[\"m\"]\n    B0_vec = np.array(case_params[\"B0_vec\"])\n    v_perp = case_params[\"v_perp\"]\n    v_para = case_params[\"v_para\"]\n    phi0 = case_params[\"phi0\"]\n    R_perp = np.array(case_params[\"R_perp\"])\n    z0 = case_params[\"z0\"]\n    num_periods = case_params[\"num_periods\"]\n    num_samples = case_params[\"num_samples\"]\n\n    B0_mag = np.linalg.norm(B0_vec)\n    b_hat = B0_vec / B0_mag\n\n    # --- 1. Generate Analytic Orbit Data (Ground Truth) ---\n\n    # Calculate derived physical constants\n    # Note: Omega_c is signed, reflecting the direction of gyration\n    Omega_c = q * B0_mag / m\n    \n    # Handle the v_perp = 0 edge case for rho\n    if v_perp > 0:\n        rho_analytic_scalar = m * v_perp / (abs(q) * B0_mag)\n    else:\n        rho_analytic_scalar = 0.0\n\n    # Create time array\n    if abs(Omega_c) > 0:\n        T_c = 2 * np.pi / abs(Omega_c)\n    else: # If B=0 or q/m=0, period is infinite. Use an arbitrary time scale.\n        T_c = 1.0 \n    \n    t_end = num_periods * T_c\n    t = np.linspace(0, t_end, num_samples)\n\n    # Generate analytic position and velocity time series\n    theta = Omega_c * t + phi0\n    \n    # Perpendicular components assuming B is along z-axis.\n    # The derivation in the solution text holds for any B direction,\n    # but for analytic orbit generation, we use the specified z-aligned field.\n    r_perp_x = R_perp[0] + rho_analytic_scalar * np.cos(theta)\n    r_perp_y = R_perp[1] + rho_analytic_scalar * np.sin(theta)\n    \n    v_perp_x = -rho_analytic_scalar * Omega_c * np.sin(theta)\n    v_perp_y = rho_analytic_scalar * Omega_c * np.cos(theta)\n\n    # Parallel components\n    r_para = z0 + v_para * t\n    v_para_vec_t = v_para * b_hat\n    \n    # Combine into 3D vectors\n    r_analytic = np.vstack([r_perp_x, r_perp_y, r_para]).T\n    v_analytic = np.vstack([v_perp_x, v_perp_y, np.full_like(t, v_para)]).T\n    \n    # Generate analytic guiding center and Larmor radius for comparison\n    R_analytic = np.tile(R_perp, (num_samples, 1)) + t[:, np.newaxis] * v_para_vec_t\n    R_analytic[:, 2] += z0 # Add initial parallel position\n    \n    rho_analytic = np.full(num_samples, rho_analytic_scalar)\n\n    # --- 2. Apply the Gyro-Phase Decomposition Algorithm ---\n\n    B0_mag_sq = B0_mag**2\n    v_cross_B = np.cross(B0_vec, v_analytic) # This is B x v\n    \n    gyrovector_term = (m / (q * B0_mag_sq)) * v_cross_B # This is the gyro-radius vector rho\n    \n    R_alg = r_analytic - gyrovector_term\n    \n    # Calculate rho as the magnitude of the gyrovector\n    rho_alg = np.linalg.norm(gyrovector_term, axis=1)\n\n    # --- 3. Compute Validation Metrics ---\n\n    # Max absolute error in Guiding Center position\n    R_error_mag = np.linalg.norm(R_alg - R_analytic, axis=1)\n    max_R_error = np.max(R_error_mag)\n\n    # Max absolute error in Larmor Radius\n    rho_error_mag = np.abs(rho_alg - rho_analytic)\n    max_rho_error = np.max(rho_error_mag)\n\n    return max_R_error, max_rho_error\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    e_charge = 1.602176634e-19\n\n    test_cases = [\n        {\n            \"name\": \"deuteron\",\n            \"q\": +1 * e_charge,\n            \"m\": 3.343583719e-27,\n            \"B0_vec\": (0.0, 0.0, 5.0),\n            \"v_perp\": 1.0e5,\n            \"v_para\": 1.0e4,\n            \"phi0\": 0.3,\n            \"R_perp\": (0.02, -0.015, 0.0),\n            \"z0\": 0.0,\n            \"num_periods\": 2,\n            \"num_samples\": 1200,\n        },\n        {\n            \"name\": \"electron\",\n            \"q\": -1 * e_charge,\n            \"m\": 9.10938356e-31,\n            \"B0_vec\": (0.0, 0.0, 2.0),\n            \"v_perp\": 3.0e6,\n            \"v_para\": 1.0e5,\n            \"phi0\": 1.2,\n            \"R_perp\": (-0.001, 0.002, 0.0),\n            \"z0\": 0.0,\n            \"num_periods\": 3,\n            \"num_samples\": 1500,\n        },\n        {\n            \"name\": \"alpha_zero_vperp\",\n            \"q\": +2 * e_charge,\n            \"m\": 6.644657e-27,\n            \"B0_vec\": (0.0, 0.0, 3.0),\n            \"v_perp\": 0.0,\n            \"v_para\": 2.0e4,\n            \"phi0\": 0.0,\n            \"R_perp\": (0.05, 0.05, 0.0),\n            \"z0\": 0.1,\n            \"num_periods\": 1,\n            \"num_samples\": 800,\n        },\n        {\n            \"name\": \"alpha_zero_vpara\",\n            \"q\": +2 * e_charge,\n            \"m\": 6.644657e-27,\n            \"B0_vec\": (0.0, 0.0, 10.0),\n            \"v_perp\": 5.0e4,\n            \"v_para\": 0.0,\n            \"phi0\": -0.7,\n            \"R_perp\": (0.0, 0.0, 0.0),\n            \"z0\": -0.02,\n            \"num_periods\": 5,\n            \"num_samples\": 2000,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        max_R_error, max_rho_error = run_case(case)\n        results.extend([max_R_error, max_rho_error])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "导心理论通过对快速回旋运动进行平均，极大地简化了等离子体动力学的描述，但这只是第一步。要理解湍流等更复杂的现象，我们必须研究这个简化的导心系统如何响应微小的扰动。本练习将引导您运用线性响应分析这一强大工具，精确推导初始速度的无限小扰动如何改变导心位置和回旋相位 ()，这不仅能加深您对导心运动稳定性的理解，也为进入回旋动理学等前沿理论奠定了重要的分析基础。",
            "id": "3963210",
            "problem": "考虑一个电荷为 $q$、质量为 $m$ 的非相对论带电粒子，在均匀静态磁场 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$ 中运动，且不存在电场。在时间 $t=0$ 时，粒子的位置为 $\\mathbf{r}_{0}$，其速度可分解为一个平行分量 $v_{\\parallel 0}\\,\\hat{\\mathbf{z}}$ 和一个位于 $x$–$y$ 平面内的垂直分量 $\\mathbf{v}_{\\perp 0}$。随后的运动是标准的围绕导心的回旋运动。定义沿磁场方向的单位矢量为 $\\hat{\\mathbf{b}} \\equiv \\hat{\\mathbf{z}}$，以及（带符号的）回旋频率为 $\\Omega \\equiv \\frac{q B_{0}}{m}$。设回旋相位 $\\phi(t)$ 为 $x$–$y$ 平面内垂直运动的相位（从 $x$ 轴开始测量），并设导心位置 $\\mathbf{R}$ 为回旋轨道的中心。\n\n在 $t=0$ 时，对初始垂直速度施加一个无穷小微扰 $\\delta \\mathbf{v}$，其中 $\\delta \\mathbf{v}$ 被约束为与 $\\mathbf{B}$ 垂直（因此 $\\delta \\mathbf{v}$ 位于 $x$–$y$ 平面内且 $\\delta \\mathbf{v}\\cdot\\hat{\\mathbf{z}}=0$）。将 $\\delta \\mathbf{v}$ 处理到一阶，确定此扰动如何改变：\n- 随时间变化的回旋相位 $\\phi(t)$，以及\n- 导心位置 $\\mathbf{R}$。\n\n您的推导必须从洛伦兹力定律以及磁化粒子运动中使用的回旋相位和导心的核心定义出发，并通过对 $\\delta \\mathbf{v}$ 进行线性化来继续。将最终答案表示为一个单行矩阵，其元素为 $\\delta \\phi(t)$（以弧度为单位）以及 $x$–$y$ 平面内导心位移 $\\delta \\mathbf{R}$ 的两个笛卡尔分量，即 $\\delta R_{x}$ 和 $\\delta R_{y}$。最终表达式必须纯粹用 $q$、$m$、$B_{0}$、$\\hat{\\mathbf{z}}$、$\\mathbf{v}_{\\perp 0}$ 和 $\\delta \\mathbf{v}$ 来表示。不需要进行数值计算，也不需要四舍五入。角度必须以弧度表示。",
            "solution": "该问题陈述已经过验证，被认为具有科学依据、提法恰当且客观。它代表了经典等离子体物理学中一个关于带电粒子在均匀磁场中运动的标准的、非平凡的问题。它没有矛盾或含糊之处，并包含得出唯一解所需的所有必要信息。\n\n在磁场 $\\mathbf{B}$ 中且无电场的情况下，一个电荷为 $q$、质量为 $m$ 的非相对论粒子的运动遵循洛伦兹力定律，该定律可简化为：\n$$\nm \\frac{d\\mathbf{v}}{dt} = q (\\mathbf{v} \\times \\mathbf{B})\n$$\n给定的磁场是均匀且静态的，$\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$。沿磁场方向的单位矢量是 $\\hat{\\mathbf{b}} = \\hat{\\mathbf{z}}$。平行于 $\\mathbf{B}$ 的运动不受磁力的影响，因此 $v_\\parallel(t) = v_{\\parallel 0}$ 是一个常数。扰动 $\\delta\\mathbf{v}$ 垂直于 $\\mathbf{B}$，因此它只影响垂直运动。我们将分析重点放在 $x-y$ 平面内的运动上。\n\n垂直速度 $\\mathbf{v}_\\perp$ 的方程为：\n$$\n\\frac{d\\mathbf{v}_\\perp}{dt} = \\frac{q B_0}{m} (\\mathbf{v}_\\perp \\times \\hat{\\mathbf{z}}) = -\\Omega (\\hat{\\mathbf{z}} \\times \\mathbf{v}_\\perp)\n$$\n其中 $\\Omega \\equiv \\frac{q B_0}{m}$ 是带符号的回旋频率。\n\n导心位置 $\\mathbf{R}$ 是回旋轨道的中心。它的定义使得粒子的位置矢量 $\\mathbf{r}$ 可以写成导心位置和回旋半径矢量 $\\boldsymbol{\\rho}$ 的和：$\\mathbf{r} = \\mathbf{R} + \\boldsymbol{\\rho}$。在均匀磁场中，一个标准的定义将回旋半径矢量与垂直速度联系起来：\n$$\n\\mathbf{v}_{\\perp} = \\Omega \\boldsymbol{\\rho} \\times \\hat{\\mathbf{b}}\n$$\n解出 $\\boldsymbol{\\rho}$ 可得 $\\boldsymbol{\\rho} = \\frac{\\hat{\\mathbf{b}} \\times \\mathbf{v}_{\\perp}}{\\Omega}$。因此，导心位置由下式给出：\n$$\n\\mathbf{R} = \\mathbf{r}_{\\perp} - \\boldsymbol{\\rho} = \\mathbf{r}_{\\perp} - \\frac{\\hat{\\mathbf{b}} \\times \\mathbf{v}_{\\perp}}{\\Omega}\n$$\n对于一个均匀、静态且无电场的磁场，导心 $\\mathbf{R}$ 是恒定的。我们可以在任何时刻计算它，例如在 $t=0$ 时：\n$$\n\\mathbf{R} = \\mathbf{r}_{\\perp 0} - \\frac{\\hat{\\mathbf{z}} \\times \\mathbf{v}_{\\perp 0}}{\\Omega}\n$$\n\n现在我们对初始垂直速度 $\\mathbf{v}_{\\perp 0}$ 施加无穷小微扰 $\\delta\\mathbf{v}$。新的初始速度为 $\\mathbf{v}'_{\\perp 0} = \\mathbf{v}_{\\perp 0} + \\delta\\mathbf{v}$。初始位置 $\\mathbf{r}_{\\perp 0}$ 保持不变。新的导心 $\\mathbf{R}'$ 为：\n$$\n\\mathbf{R}' = \\mathbf{r}_{\\perp 0} - \\frac{\\hat{\\mathbf{z}} \\times \\mathbf{v}'_{\\perp 0}}{\\Omega} = \\mathbf{r}_{\\perp 0} - \\frac{\\hat{\\mathbf{z}} \\times (\\mathbf{v}_{\\perp 0} + \\delta\\mathbf{v})}{\\Omega}\n$$\n导心位置的一阶修正量 $\\delta\\mathbf{R}$ 是 $\\mathbf{R}'$ 与 $\\mathbf{R}$ 之间的差值：\n$$\n\\delta\\mathbf{R} = \\mathbf{R}' - \\mathbf{R} = \\left(\\mathbf{r}_{\\perp 0} - \\frac{\\hat{\\mathbf{z}} \\times (\\mathbf{v}_{\\perp 0} + \\delta\\mathbf{v})}{\\Omega}\\right) - \\left(\\mathbf{r}_{\\perp 0} - \\frac{\\hat{\\mathbf{z}} \\times \\mathbf{v}_{\\perp 0}}{\\Omega}\\right)\n$$\n$$\n\\delta\\mathbf{R} = - \\frac{\\hat{\\mathbf{z}} \\times \\delta\\mathbf{v}}{\\Omega}\n$$\n由于 $\\Omega = q B_0 / m$，上式变为：\n$$\n\\delta\\mathbf{R} = - \\frac{m}{q B_0} (\\hat{\\mathbf{z}} \\times \\delta\\mathbf{v})\n$$\n问题要求笛卡尔分量 $\\delta R_x$ 和 $\\delta R_y$。它们是 $\\delta\\mathbf{R}$ 在基矢量 $\\hat{\\mathbf{x}}$ 和 $\\hat{\\mathbf{y}}$ 上的标量投影：\n$$\n\\delta R_x = \\delta\\mathbf{R} \\cdot \\hat{\\mathbf{x}} = - \\frac{m}{q B_0} (\\hat{\\mathbf{z}} \\times \\delta\\mathbf{v}) \\cdot \\hat{\\mathbf{x}}\n$$\n使用标量三重积恒等式 $\\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{C} \\cdot (\\mathbf{A} \\times \\mathbf{B})$，我们有 $(\\hat{\\mathbf{z}} \\times \\delta\\mathbf{v}) \\cdot \\hat{\\mathbf{x}} = \\delta\\mathbf{v} \\cdot (\\hat{\\mathbf{x}} \\times \\hat{\\mathbf{z}})$。由于 $\\hat{\\mathbf{x}} \\times \\hat{\\mathbf{z}} = -\\hat{\\mathbf{y}}$，该项为 $\\delta\\mathbf{v} \\cdot (-\\hat{\\mathbf{y}})$。\n$$\n\\delta R_x = - \\frac{m}{q B_0} (\\delta\\mathbf{v} \\cdot (-\\hat{\\mathbf{y}})) = \\frac{m}{q B_0} (\\delta\\mathbf{v} \\cdot \\hat{\\mathbf{y}})\n$$\n类似地，对于 $y$ 分量：\n$$\n\\delta R_y = \\delta\\mathbf{R} \\cdot \\hat{\\mathbf{y}} = - \\frac{m}{q B_0} (\\hat{\\mathbf{z}} \\times \\delta\\mathbf{v}) \\cdot \\hat{\\mathbf{y}}\n$$\n标量三重积变为 $\\delta\\mathbf{v} \\cdot (\\hat{\\mathbf{y}} \\times \\hat{\\mathbf{z}})$。由于 $\\hat{\\mathbf{y}} \\times \\hat{\\mathbf{z}} = \\hat{\\mathbf{x}}$，该项为 $\\delta\\mathbf{v} \\cdot \\hat{\\mathbf{x}}$。\n$$\n\\delta R_y = - \\frac{m}{q B_0} (\\delta\\mathbf{v} \\cdot \\hat{\\mathbf{x}})\n$$\n\n接下来，我们确定对回旋相位 $\\phi(t)$ 的修正。垂直速度方程的解是一个旋转：$\\mathbf{v}_\\perp(t)$ 在平面内以角频率 $-\\Omega$ 旋转。因此，速度矢量的相位演化为 $\\phi_v(t) = \\alpha_0 - \\Omega t$，其中 $\\alpha_0$ 是速度矢量 $\\mathbf{v}_{\\perp 0}$ 的初始相位。回旋相位 $\\phi(t)$，即回旋半径矢量 $\\boldsymbol{\\rho}(t)$ 的相位，与 $\\phi_v(t)$ 相差一个恒定的偏移量（具体来说，如果 $\\Omega>0$ 则 $\\phi(t) = \\phi_v(t) + \\pi/2$，如果 $\\Omega<0$ 则 $\\phi(t) = \\phi_v(t) - \\pi/2$）。相位的变化量 $\\delta\\phi(t)$ 将与这个恒定的偏移量无关。微扰只影响初始速度，因此只有初始相位 $\\alpha_0$ 发生变化。频率 $\\Omega$ 保持不变。因此，随时间变化的相位的变化量在时间上是恒定的：\n$$\n\\delta\\phi(t) = \\delta\\alpha_0\n$$\n初始相角 $\\alpha_0$ 由 $\\mathbf{v}_{\\perp 0} = v_{x0} \\hat{\\mathbf{x}} + v_{y0} \\hat{\\mathbf{y}}$ 定义。它可以表示为 $\\alpha_0 = \\arctan(v_{y0}/v_{x0})$。我们对这个函数进行线性化，以求出由扰动 $\\delta\\mathbf{v} = \\delta v_x \\hat{\\mathbf{x}} + \\delta v_y \\hat{\\mathbf{y}}$ 引起的变化。\n$$\n\\delta\\alpha_0 \\approx \\frac{\\partial \\alpha_0}{\\partial v_{x0}}\\delta v_x + \\frac{\\partial \\alpha_0}{\\partial v_{y0}}\\delta v_y\n$$\n偏导数分别为：\n$$\n\\frac{\\partial}{\\partial v_{x0}} \\arctan\\left(\\frac{v_{y0}}{v_{x0}}\\right) = \\frac{1}{1+(v_{y0}/v_{x0})^2} \\left(-\\frac{v_{y0}}{v_{x0}^2}\\right) = -\\frac{v_{y0}}{v_{x0}^2 + v_{y0}^2} = -\\frac{v_{y0}}{|\\mathbf{v}_{\\perp 0}|^2}\n$$\n$$\n\\frac{\\partial}{\\partial v_{y0}} \\arctan\\left(\\frac{v_{y0}}{v_{x0}}\\right) = \\frac{1}{1+(v_{y0}/v_{x0})^2} \\left(\\frac{1}{v_{x0}}\\right) = \\frac{v_{x0}}{v_{x0}^2 + v_{y0}^2} = \\frac{v_{x0}}{|\\mathbf{v}_{\\perp 0}|^2}\n$$\n将这些代入 $\\delta\\alpha_0$ 的表达式中：\n$$\n\\delta\\phi(t) = \\delta\\alpha_0 = \\frac{-v_{y0} \\delta v_x + v_{x0} \\delta v_y}{|\\mathbf{v}_{\\perp 0}|^2}\n$$\n分子可以被看作是沿 $\\hat{\\mathbf{z}}$ 方向的叉积分量：\n$$\n-v_{y0} \\delta v_x + v_{x0} \\delta v_y = (\\mathbf{v}_{\\perp 0} \\times \\delta \\mathbf{v}) \\cdot \\hat{\\mathbf{z}}\n$$\n因此，回旋相位的变化量为：\n$$\n\\delta\\phi(t) = \\frac{(\\mathbf{v}_{\\perp 0} \\times \\delta \\mathbf{v}) \\cdot \\hat{\\mathbf{z}}}{|\\mathbf{v}_{\\perp 0}|^2}\n$$\n此表达式已恰当地用指定的量给出。\n\n我们现在整理出所需的三个量：\n1.  $\\delta\\phi(t) = \\frac{(\\mathbf{v}_{\\perp 0} \\times \\delta \\mathbf{v}) \\cdot \\hat{\\mathbf{z}}}{|\\mathbf{v}_{\\perp 0}|^2}$\n2.  $\\delta R_x = \\frac{m}{q B_0} (\\delta\\mathbf{v} \\cdot \\hat{\\mathbf{y}})$\n3.  $\\delta R_y = - \\frac{m}{q B_0} (\\delta\\mathbf{v} \\cdot \\hat{\\mathbf{x}})$\n这些就是一阶修正的最终表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{(\\mathbf{v}_{\\perp 0} \\times \\delta \\mathbf{v}) \\cdot \\hat{\\mathbf{z}}}{|\\mathbf{v}_{\\perp 0}|^2}  \\frac{m}{q B_0} (\\delta\\mathbf{v} \\cdot \\hat{\\mathbf{y}})  - \\frac{m}{q B_0} (\\delta\\mathbf{v} \\cdot \\hat{\\mathbf{x}})\n\\end{pmatrix}\n}\n$$"
        }
    ]
}