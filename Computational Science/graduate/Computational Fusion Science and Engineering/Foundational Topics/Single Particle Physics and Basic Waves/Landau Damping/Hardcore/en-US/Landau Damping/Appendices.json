{
    "hands_on_practices": [
        {
            "introduction": "To build a deep intuition for Landau damping, it is incredibly instructive to analyze a system where it is absent. This exercise explores a hypothetical \"waterbag\" velocity distribution, which is flat and has sharp cutoffs. By deriving the dispersion relation for this distribution, you will discover that plasma waves are undamped, forcing a confrontation with the question: what essential feature of the Maxwellian distribution is missing here? This practice illuminates the critical role of resonant particles and the slope of the distribution function, $f_0'(v)$, at the wave's phase velocity .",
            "id": "4000814",
            "problem": "Consider an unmagnetized, one-dimensional, electrostatic electron plasma representative of core turbulence modeling in computational fusion science and engineering. Electrons obey the linearized Vlasov–Poisson system about a spatially homogeneous equilibrium with number density $n_{e}$ and a velocity distribution function $f_{0}(v)$ normalized so that $\\int_{-\\infty}^{\\infty} f_{0}(v)\\, dv = 1$. Assume singly charged ions provide a fixed neutralizing background. Let perturbations be proportional to $\\exp(i k x - i \\omega t)$ with real wavenumber $k$ and complex frequency $\\omega$.\n\nThe equilibrium electron distribution is a waterbag (top-hat) of finite width,\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},  |v| \\le \\Delta, \\\\\n0,  |v| > \\Delta,\n\\end{cases}\n$$\nwith constant half-width $\\Delta > 0$.\n\nStarting from first principles, namely the linearized Vlasov equation for electrons and Poisson’s equation,\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} - \\frac{e}{m_{e}} E \\frac{\\partial f}{\\partial v} = 0, \\qquad \\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right),\n$$\nderive the dispersion relation in the standard dielectric form and compute the Landau damping rate $\\gamma$ of the electron plasma wave for the waterbag distribution. Use the Landau contour prescription for analytic continuation in the complex $\\omega$-plane. Express your final answer for the damping rate in $\\mathrm{s}^{-1}$.\n\nIn addition, explain, based on your derivation, how the absence of exponential tails in the waterbag distribution modifies resonance contributions relative to a Maxwellian equilibrium. Your explanation must be grounded in the structure of the velocity-space derivative of $f_{0}(v)$ and the analytic properties of the velocity integral.\n\nIf your final numerical result requires rounding, round your answer to four significant figures. If your final result is an exact closed-form analytic expression, provide it exactly with no rounding.",
            "solution": "The problem statement is critically evaluated and found to be valid. It presents a well-posed, scientifically grounded problem in plasma kinetic theory. Initially, the requirement to provide a numerical answer in units of $\\mathrm{s}^{-1}$ without supplying numerical values for plasma parameters ($n_e$, $\\Delta$) or wave parameters ($k$) suggests the problem is underspecified. However, a full derivation reveals that the Landau damping rate for the specified waterbag distribution is exactly zero, a result that is independent of any specific parameter values. Thus, the problem is self-contained and solvable as stated.\n\nThe problem asks for the derivation of the dispersion relation and the computation of the Landau damping rate for electron plasma waves in an unmagnetized plasma with a waterbag equilibrium distribution function.\n\nThe starting points are the linearized Vlasov and Poisson equations for electrons. We assume perturbations of the form $\\exp(i k x - i \\omega t)$, where $k$ is real and $\\omega = \\omega_r + i\\gamma$ is complex. The linearized Vlasov equation yields the perturbed distribution function $f_1$:\n$$\nf_1(v) = -i \\frac{e E_1}{m_{e}} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v}\n$$\nThe linearized Poisson equation for the perturbed quantities is $ik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv$. Substituting the expression for $f_1$ and canceling the common factor $iE_1$ leads to the general dispersion relation:\n$$\n1 + \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{v - \\omega/k} dv = 0\n$$\nHere, $\\omega_p^2 = \\frac{n_e e^2}{m_e \\epsilon_0}$ is the electron plasma frequency squared, $f_0'(v) = \\frac{d f_{0}}{d v}$, and the integral is performed using the Landau contour. This form defines the dielectric function $\\epsilon(\\omega, k) = 1 + \\chi_e(\\omega, k)$, where the dispersion relation is $\\epsilon(\\omega, k) = 0$.\n\nNow we apply this to the specific waterbag distribution:\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},  |v| \\le \\Delta, \\\\\n0,  |v| > \\Delta.\n\\end{cases}\n$$\nThe derivative of this function is given in terms of Dirac delta functions:\n$$\nf_0'(v) = \\frac{d}{dv} \\left( \\frac{1}{2\\Delta} [H(v+\\Delta) - H(v-\\Delta)] \\right) = \\frac{1}{2\\Delta} [\\delta(v+\\Delta) - \\delta(v-\\Delta)]\n$$\nwhere $H(v)$ is the Heaviside step function.\nWe substitute this derivative into the velocity integral of the dispersion relation. Let $u = \\omega/k$.\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\int_{-\\infty}^{\\infty} \\frac{1}{2\\Delta} \\frac{\\delta(v+\\Delta) - \\delta(v-\\Delta)}{v - u} dv\n$$\nUsing the sifting property of the delta function, $\\int g(x) \\delta(x-a) dx = g(a)$:\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\frac{1}{2\\Delta} \\left( \\frac{1}{-\\Delta - u} - \\frac{1}{\\Delta - u} \\right) = \\frac{1}{2\\Delta} \\left( \\frac{-1}{\\Delta + u} - \\frac{1}{\\Delta - u} \\right)\n$$\n$$\n= \\frac{1}{2\\Delta} \\frac{-(\\Delta - u) - (\\Delta + u)}{(\\Delta+u)(\\Delta-u)} = \\frac{1}{2\\Delta} \\frac{-2\\Delta}{\\Delta^2 - u^2} = \\frac{1}{u^2 - \\Delta^2}\n$$\nThis result is valid for any complex $u$ as long as $u \\neq \\pm \\Delta$. The integral is an analytic function of $u$ except for simple poles at $u=\\pm \\Delta$. The Landau contour prescription is trivially satisfied as there are no singularities of the integrand on the real axis unless $u$ is real and equals $\\pm \\Delta$.\n\nSubstituting this result back into the dispersion relation:\n$$\n1 + \\frac{\\omega_p^2}{k^2} \\left( \\frac{1}{(\\omega/k)^2 - \\Delta^2} \\right) = 0\n$$\n$$\n1 = - \\frac{\\omega_p^2}{k^2} \\frac{1}{\\omega^2/k^2 - \\Delta^2} = - \\frac{\\omega_p^2}{\\omega^2 - k^2\\Delta^2}\n$$\nSolving for $\\omega^2$:\n$$\n\\omega^2 - k^2\\Delta^2 = -\\omega_p^2\n$$\n$$\n\\omega^2 = k^2\\Delta^2 - \\omega_p^2\n$$\nThe frequency $\\omega$ is purely real if $k^2\\Delta^2 > \\omega_p^2$ and purely imaginary if $k^2\\Delta^2  \\omega_p^2$. In either case, the frequency $\\omega$ has no real and imaginary parts simultaneously. It is either purely real or purely imaginary. The standard oscillating Langmuir wave corresponds to the case where $\\omega$ is approximately real. In any case, there is no damping of an oscillatory mode. The imaginary part of the frequency, $\\gamma = \\Im(\\omega)$, which represents the damping rate of an oscillatory mode, is zero.\n$$\n\\gamma = 0\n$$\nThus, the electron plasma waves in a plasma with a waterbag distribution are undamped. The result is $0 \\ \\mathrm{s}^{-1}$.\n\nThe absence of damping can be explained by analyzing the resonance condition and the structure of $f_0'(v)$. Landau damping arises from the net exchange of energy between the wave and particles moving at or near the wave's phase velocity, $v_{ph} = \\Re(\\omega)/k = \\omega_r/k$. The rate of this energy exchange is proportional to the slope of the distribution function at the phase velocity, $f_0'(v_{ph})$.\n\nFor the waterbag distribution, for an oscillatory wave to exist ($k^2\\Delta^2 > \\omega_p^2$), the wave's phase velocity is:\n$$\n|v_{ph}| = \\frac{|\\omega_r|}{k} = \\frac{\\sqrt{k^2\\Delta^2 - \\omega_p^2}}{k} = \\sqrt{\\Delta^2 - \\frac{\\omega_p^2}{k^2}}\n$$\nFrom this, it is clear that $|v_{ph}|  \\Delta$.\nThe waterbag distribution has a finite width, meaning there are particles only for velocities $|v| \\le \\Delta$. The derivative, $f_0'(v)$, is non-zero only at the precise velocities $v = \\pm\\Delta$. Since the wave's phase velocity $|v_{ph}|$ is strictly less than $\\Delta$, it does not coincide with the velocities where $f_0'(v)$ is non-zero. More importantly, while there are particles at $v=v_{ph}$, the slope of the distribution function is exactly zero in this region ($f_0'(v)=0$ for $|v|  \\Delta$). Without a non-zero slope at the resonant velocity, there can be no net energy exchange, and thus no Landau damping.\n\nIn contrast, for a Maxwellian equilibrium distribution, $f_M(v) \\propto \\exp(-v^2/v_{th}^2)$, the function and its derivative are non-zero for all velocities. A Maxwellian distribution has \"exponential tails\", meaning there is a small but finite population of particles at any velocity, no matter how high. When an electron plasma wave propagates, its phase velocity $v_{ph}$ is typically greater than the thermal velocity $v_{th}$, but because of the tails, there are always particles with $v \\approx v_{ph}$. The derivative $f_M'(v_{ph})$ is non-zero (and negative for $v_{ph} > 0$), leading to a net transfer of energy from the wave to the particles, and thus wave damping.\n\nMathematically, the difference lies in the analytic properties of the velocity integral.\nFor the waterbag, the compact support of $f_0(v)$ leads to a dispersion relation that is a simple algebraic (rational) function of $\\omega^2$. The solutions for $\\omega$ are the roots of this algebraic equation, which are never complex with both non-zero real and imaginary parts.\nFor the Maxwellian, the infinite support of $f_0(v)$ leads to a dispersion function involving the transcendental plasma dispersion function, $Z(\\xi)$. This function is complex for real arguments, which fundamentally introduces an imaginary part to the frequency $\\omega$ for any real $k$. This mathematical feature reflects the physical presence of a continuum of resonant particles where the distribution has a non-zero slope.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "While analytical theory provides the fundamental equations, obtaining precise, quantitative predictions for damping rates often requires numerical computation. This practice bridges the gap between formalism and application by tasking you to solve the full kinetic dispersion relation for electron plasma waves. You will implement a numerical root-finder for the complex frequency $\\omega$, using standard computational library functions for the plasma dispersion function, a core skill for any kinetic modeler . The exercise also probes the sensitivity of the damping rate to numerical errors, a crucial consideration in computational science.",
            "id": "4000841",
            "problem": "Consider an unmagnetized, collisionless, homogeneous electron plasma with a Maxwellian equilibrium electron distribution and immobile ions. Starting from the linearized Vlasov–Poisson system, the electron susceptibility can be expressed in terms of the plasma dispersion function. Let the equilibrium electron distribution be isotropic and Maxwellian with electron thermal speed $v_{\\mathrm{th}} = \\sqrt{2 k_{\\mathrm{B}} T_{e}/m_{e}}$, electron plasma frequency $\\omega_{\\mathrm{pe}} = \\sqrt{n_{e} e^{2}/(\\varepsilon_{0} m_{e})}$, and Debye length $\\lambda_{\\mathrm{D}} = \\sqrt{\\varepsilon_{0} k_{\\mathrm{B}} T_{e}/(n_{e} e^{2})}$. Note the relationship $v_{\\mathrm{th}} = \\sqrt{2}\\,\\lambda_{\\mathrm{D}}\\,\\omega_{\\mathrm{pe}}$. Define the dimensionless wavenumber $\\hat{k} = k v_{\\mathrm{th}}/\\omega_{\\mathrm{pe}}$ and the dimensionless complex frequency $\\hat{\\omega} = \\omega/\\omega_{\\mathrm{pe}}$. The electrostatic electron dielectric function is\n$$\n\\varepsilon(\\omega, k) = 1 + \\chi_{e}(\\omega, k), \\quad \\chi_{e}(\\omega, k) = \\frac{\\omega_{\\mathrm{pe}}^{2}}{k^{2} v_{\\mathrm{th}}^{2}} \\left[ 1 + \\xi\\, Z(\\xi) \\right],\n$$\nwhere $\\xi = \\omega/(k v_{\\mathrm{th}})$ and $Z(\\xi)$ is the plasma dispersion function. The Landau-damped Langmuir wave corresponds to the complex root $\\omega$ such that $\\varepsilon(\\omega, k) = 0$ with $\\operatorname{Im}(\\omega)  0$. The Landau damping rate normalized to the electron plasma frequency is the dimensionless quantity $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$, which is unitless.\n\nYour task is to implement a numerical solver that:\n- Represents $Z(\\xi)$ via the Faddeeva function $w(z)$ using the identity $Z(\\xi) = i \\sqrt{\\pi}\\, w(\\xi)$, where $w(z) = e^{-z^{2}} \\operatorname{erfc}(-i z)$.\n- Solves for the complex root $\\hat{\\omega}$ of the normalized dielectric function\n$$\n\\varepsilon(\\hat{\\omega}, \\hat{k}) = 1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, Z(\\hat{\\xi}) \\right] = 0, \\quad \\hat{\\xi} = \\frac{\\hat{\\omega}}{\\hat{k}},\n$$\nusing a two-dimensional nonlinear root-finding method on the real and imaginary parts of $\\varepsilon$.\n- Computes and returns $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$.\n\nIn addition, quantify the sensitivity of $\\gamma/\\omega_{\\mathrm{pe}}$ to numerical errors in $Z(\\xi)$ by introducing a controlled multiplicative perturbation of the form $Z_{\\epsilon}(\\xi) = (1 + \\epsilon)\\, Z(\\xi)$ and recomputing the damping rate for several values of $\\epsilon$. This models a relative numerical error in the evaluation of $Z(\\xi)$.\n\nImplement your program to evaluate and output the following test suite:\n- Case 1 (happy path): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 0.0$.\n- Case 2 (near machine precision perturbation): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-8}$.\n- Case 3 (small perturbation): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-5}$.\n- Case 4 (moderate perturbation): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-3}$.\n- Case 5 (boundary in $k \\lambda_{\\mathrm{D}}$): $k \\lambda_{\\mathrm{D}} = 0.05$, $\\epsilon = 0.0$.\n- Case 6 (edge in $k \\lambda_{\\mathrm{D}}$): $k \\lambda_{\\mathrm{D}} = 0.5$, $\\epsilon = 0.0$.\n\nUse the normalization $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$ and return the numerical values of $\\gamma/\\omega_{\\mathrm{pe}}$ for each case. No physical units are required because the output is dimensionless.\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[result1,result2,result3]\"). Each result must be a single floating-point number $\\gamma/\\omega_{\\mathrm{pe}}$ corresponding to the cases listed above, ordered as given.",
            "solution": "The problem requires the numerical computation of the Landau damping rate of electron plasma waves in an unmagnetized, collisionless plasma with a Maxwellian electron distribution. The solution involves finding the complex roots of the electrostatic dielectric function. This will be accomplished by implementing a numerical root-finding algorithm. Additionally, a sensitivity analysis will be performed to quantify the effect of numerical errors in the plasma dispersion function on the calculated damping rate.\n\nThe fundamental equation to be solved is the dispersion relation, given by $\\varepsilon(\\omega, k) = 0$, where $\\varepsilon$ is the dielectric function. For the specified plasma conditions, the normalized form of this equation is:\n$$\n\\varepsilon(\\hat{\\omega}, \\hat{k}) = 1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, Z(\\hat{\\xi}) \\right] = 0\n$$\nHere, $\\hat{\\omega} = \\omega/\\omega_{\\mathrm{pe}}$ is the complex wave frequency normalized to the electron plasma frequency, $\\hat{k} = k v_{\\mathrm{th}}/\\omega_{\\mathrm{pe}}$ is the wavenumber normalized using the electron thermal speed $v_{\\mathrm{th}}$, and $\\hat{\\xi} = \\hat{\\omega}/\\hat{k}$ is their ratio. The function $Z(\\hat{\\xi})$ is the plasma dispersion function. The damping rate is given by the negative of the imaginary part of the frequency root, $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$. The problem also specifies the normalization relationship $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$, where $\\lambda_{\\mathrm{D}}$ is the electron Debye length.\n\nThe task is to find the complex root $\\hat{\\omega} = \\hat{\\omega}_r + i \\hat{\\omega}_i$ for given values of $\\hat{k}$. This is equivalent to solving a system of two coupled, nonlinear real equations for two real variables, $\\hat{\\omega}_r$ and $\\hat{\\omega}_i$:\n$$\n\\operatorname{Re}\\left[ \\varepsilon(\\hat{\\omega}_r + i\\hat{\\omega}_i, \\hat{k}) \\right] = 0\n$$\n$$\n\\operatorname{Im}\\left[ \\varepsilon(\\hat{\\omega}_r + i\\hat{\\omega}_i, \\hat{k}) \\right] = 0\n$$\nTo evaluate the dielectric function, we must compute the plasma dispersion function $Z(\\xi)$. The problem provides the relation $Z(\\xi) = i \\sqrt{\\pi}\\, w(\\xi)$, where $w(\\xi) = e^{-\\xi^{2}} \\operatorname{erfc}(-i \\xi)$ is the Faddeeva function. A robust numerical implementation of $w(\\xi)$ is available in the SciPy library as `scipy.special.wofz`.\n\nA numerical root-finding algorithm is required to solve this system. The `scipy.optimize.root` function is well-suited for this purpose. It requires an initial guess for the solution vector $(\\hat{\\omega}_r, \\hat{\\omega}_i)$. A physically motivated initial guess significantly improves the likelihood of convergence to the correct root (the forward-propagating, damped Langmuir wave). In the long-wavelength limit ($k \\lambda_{\\mathrm{D}} \\ll 1$), the real part of the frequency is well-approximated by the Bohm-Gross dispersion relation, $\\omega^2 \\approx \\omega_{\\mathrm{pe}}^2 + 3 k^2 v_{\\text{th,rms}}^2$. Using the problem's definition $v_{\\mathrm{th}} = \\sqrt{2} v_{\\text{th,rms}}$, this becomes $\\omega^2 \\approx \\omega_{pe}^2 + \\frac{3}{2} k^2 v_{\\mathrm{th}}^2$. In normalized units, this provides an excellent initial guess for the real part:\n$$\n\\hat{\\omega}_r \\approx \\sqrt{1 + \\frac{3}{2} \\hat{k}^2}\n$$\nFor the imaginary part, Landau damping is known to be weak for small $\\hat{k}$, implying $\\hat{\\omega}_i$ is a small negative number. A reasonable initial guess such as $\\hat{\\omega}_i = -0.01$ is sufficient to guide the solver towards the damped root ($\\operatorname{Im}(\\omega)  0$).\n\nThe sensitivity analysis is conducted by introducing a controlled multiplicative perturbation $\\epsilon$ into the plasma dispersion function, defining a perturbed function $Z_{\\epsilon}(\\xi) = (1 + \\epsilon)\\, Z(\\xi)$. The dispersion relation is then re-solved using this perturbed function:\n$$\n1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, (1 + \\epsilon)Z(\\hat{\\xi}) \\right] = 0\n$$\nBy solving for $\\hat{\\omega}$ for various small values of $\\epsilon$, we can observe the resulting change in the damping rate, $\\gamma/\\omega_{\\mathrm{pe}}$.\n\nThe overall algorithm proceeds as follows:\n1.  For each test case defined by $(k \\lambda_{\\mathrm{D}}, \\epsilon)$:\n2.  Calculate the normalized wavenumber $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$.\n3.  Establish an initial guess for the root $(\\hat{\\omega}_r, \\hat{\\omega}_i)$ using the Bohm-Gross relation and a small negative imaginary part.\n4.  Define a target function that takes a vector $(\\hat{\\omega}_r, \\hat{\\omega}_i)$ and returns the real and imaginary parts of the dielectric function $\\varepsilon(\\hat{\\omega}, \\hat{k})$, incorporating the perturbation $\\epsilon$.\n5.  Invoke the `scipy.optimize.root` solver to find the root $(\\hat{\\omega}_{r, \\text{sol}}, \\hat{\\omega}_{i, \\text{sol}})$.\n6.  The Landau damping rate is then $\\gamma/\\omega_{\\mathrm{pe}} = -\\hat{\\omega}_{i, \\text{sol}}$.\n7.  Collect the results from all test cases and format them into the specified output string. This step-by-step process is implemented in the provided Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import wofz\nfrom scipy.optimize import root\n\ndef dielectric_system_for_solver(omega_vec, k_hat, epsilon):\n    \"\"\"\n    Represents the system of equations Re(epsilon)=0, Im(epsilon)=0.\n\n    Args:\n        omega_vec (list-like): A list or array [omega_r, omega_i] representing\n                               the real and imaginary parts of the normalized\n                               complex frequency omega_hat.\n        k_hat (float): The normalized wavenumber.\n        epsilon (float): The multiplicative perturbation for Z(xi).\n\n    Returns:\n        list: A list containing [Re(epsilon), Im(epsilon)].\n    \"\"\"\n    omega_hat = omega_vec[0] + 1j * omega_vec[1]\n\n    # The argument to the plasma dispersion function\n    xi_hat = omega_hat / k_hat\n\n    # Calculate Z(xi) using the Faddeeva function w(z) from SciPy.\n    # The relation is Z(xi) = i * sqrt(pi) * w(xi), where w(z) is computed by wofz.\n    w_val = wofz(xi_hat)\n    z_val = 1j * np.sqrt(np.pi) * w_val\n\n    # Apply the controlled multiplicative perturbation\n    z_perturbed = (1.0 + epsilon) * z_val\n\n    # Calculate the complex dielectric function epsilon(omega, k)\n    eps_val = 1.0 + (1.0 / k_hat**2) * (1.0 + xi_hat * z_perturbed)\n\n    # Return the real and imaginary parts for the 2D root finder\n    return [eps_val.real, eps_val.imag]\n\ndef solve():\n    \"\"\"\n    Main solver function to compute Landau damping rates for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (k * lambda_D, epsilon).\n    test_cases = [\n        (0.2, 0.0),\n        (0.2, 1e-8),\n        (0.2, 1e-5),\n        (0.2, 1e-3),\n        (0.05, 0.0),\n        (0.5, 0.0),\n    ]\n\n    results = []\n    \n    # A single reasonable initial guess for the imaginary part of omega_hat is sufficient\n    # for all cases. The damped root has Im(omega)  0.\n    omega_i_guess = -0.01\n\n    for k_lambda_d, epsilon in test_cases:\n        # Convert the given k*lambda_D to the normalized wavenumber k_hat\n        k_hat = np.sqrt(2.0) * k_lambda_d\n\n        # Calculate an initial guess for the real part of omega_hat using the\n        # Bohm-Gross dispersion relation in the appropriate normalization.\n        omega_r_guess = np.sqrt(1.0 + 1.5 * k_hat**2)\n\n        initial_guess = [omega_r_guess, omega_i_guess]\n\n        # Use scipy.optimize.root to find the solution.\n        # The 'args' parameter passes additional arguments to the target function.\n        # We use a tight tolerance for high accuracy.\n        solution = root(\n            dielectric_system_for_solver,\n            initial_guess,\n            args=(k_hat, epsilon),\n            tol=1e-13,\n            method='hybr' # Default and robust method\n        )\n\n        if not solution.success:\n            # This indicates the solver failed to converge. For these test cases,\n            # this is not expected. Append NaN as a failure indicator.\n            results.append(float('nan'))\n            continue\n\n        # The solution vector is solution.x = [omega_r, omega_i]\n        omega_i_solution = solution.x[1]\n\n        # The normalized damping rate is gamma/omega_pe = -Im(omega_hat)\n        damping_rate = -omega_i_solution\n        results.append(damping_rate)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The most powerful validation of a physical theory comes from simulating it from first principles and directly observing the predicted effects. This capstone exercise guides you through the development of a Vlasov-Poisson solver to model the evolution of an electron plasma wave. More importantly, you will implement a field-particle correlation diagnostic, a sophisticated tool used in modern plasma research to measure the velocity-resolved energy transfer between the wave and the particles. This allows you to computationally \"see\" the resonant interaction at the heart of Landau damping, providing a direct, quantitative visualization of the microscopic physics .",
            "id": "4000790",
            "problem": "Consider a one-dimensional, one-velocity electrostatic Vlasov–Poisson system for electrons with immobile ions in dimensionless units. Let the electron distribution function be $f(x,v,t)$, the electric field be $E(x,t)$, the electron charge be $q=-1$, and the electron mass be $m=1$. The governing equations are the Vlasov equation and Poisson’s equation:\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\nwith periodic boundary conditions in $x$ and truncated velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ chosen large enough that $f$ is negligible at the boundaries. The initial condition is a weakly perturbed spatial mode of a Maxwellian:\n$$\nf(x,v,0) = f_0(v)\\left[1 + \\alpha \\cos(k x)\\right], \\quad f_0(v) = \\frac{1}{\\sqrt{2\\pi} v_{\\mathrm{th}}}\\exp\\left(-\\frac{v^2}{2 v_{\\mathrm{th}}^2}\\right),\n$$\nwhere $k$ is the fundamental wavenumber of the perturbation, $\\alpha$ is the perturbation amplitude, and $v_{\\mathrm{th}}$ is the electron thermal speed.\n\nDefine the velocity-resolved field–particle correlation diagnostic that measures the time-averaged energy transfer density from the field to particles at each velocity:\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\nwhere $\\langle \\cdot \\rangle_{x,t}$ denotes an average over space and over the simulation time interval. The resonant velocity $v_{\\mathrm{res}}$ associated with Landau damping is identified as the velocity $v \\ge 0$ at which $C(v)$ attains its maximum value.\n\nYour task is to implement a dimensionless numerical solver for the above Vlasov–Poisson system using a Strang-splitting semi-Lagrangian scheme with periodic advection in $x$ and linear-interpolation advection in $v$, coupled with a Fourier-space solver for Poisson’s equation. Then implement the field–particle correlation diagnostic $C(v)$ and, for each specified test case, compute and return $v_{\\mathrm{res}}$.\n\nUse the following domain and discretization choices:\n- Spatial domain length $L = 2\\pi$, periodic in $x$.\n- Number of spatial grid points $N_x = 64$.\n- Velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ with $v_{\\max} = 5$.\n- Number of velocity grid points $N_v = 256$.\n- Time step $\\Delta t = 0.05$.\n- Number of time steps $N_t = 300$.\n- Electron thermal speed $v_{\\mathrm{th}} = 1$.\n\nImplement the Strang splitting for each time step $n$:\n1. Half-step in $v$: advect $f$ along the $v$-characteristics using the current field $E^n(x)$ for $\\Delta t/2$.\n2. Full-step in $x$: advect $f$ along the $x$-characteristics using the particle velocities for $\\Delta t$ with periodic boundary conditions.\n3. Update the field: solve Poisson’s equation to obtain $E^{n+1}(x)$ from the updated $f$.\n4. Half-step in $v$: advect $f$ along the $v$-characteristics using $E^{n+1}(x)$ for $\\Delta t/2$.\n\nAt each full time step, accumulate $C(v)$ using the instantaneous $E(x,t)$ and $f(x,v,t)$ by averaging over $x$ and summing over time, and finally divide by the number of samples to obtain the time average. Identify $v_{\\mathrm{res}}$ by selecting the velocity $v \\ge 0$ at which $C(v)$ is maximized.\n\nAll quantities are dimensionless. The required output for each test case is a single float $v_{\\mathrm{res}}$. The program must process the following test suite of parameter values:\n- Test case $1$: $k = 1$, $\\alpha = 10^{-3}$.\n- Test case $2$: $k = 2$, $\\alpha = 10^{-3}$.\n- Test case $3$: $k = 3$, $\\alpha = 5 \\times 10^{-4}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_i$ is the computed $v_{\\mathrm{res}}$ for test case $i$ as a float.",
            "solution": "The foundation of the problem is the electrostatic Vlasov–Poisson system, which in one dimension and one velocity dimension can be written as\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\nwith $q=-1$ and $m=1$, and periodic boundary conditions in $x$. Starting from first principles, the Vlasov equation expresses phase-space advection along characteristics of motion: particles translate in position with velocity $v$ and in velocity according to acceleration $a = q E$. The Poisson equation relates the spatial derivative of the electric field to the net charge density, here the difference between the constant ion background (normalized to $1$) and the electron density $n_e(x,t) = \\int f(x,v,t)\\, dv$.\n\nThe rate of change of the electron kinetic energy density $W(x,t) = \\int \\frac{1}{2} m v^2 f(x,v,t)\\, dv$ due to the electric field follows from the Vlasov equation by multiplying by $\\frac{1}{2} m v^2$ and integrating over $v$:\n$$\n\\frac{\\partial W}{\\partial t} = \\int \\frac{1}{2} m v^2 \\left[ - v \\frac{\\partial f}{\\partial x} - q E \\frac{\\partial f}{\\partial v} \\right] dv.\n$$\nThe spatial-advection term becomes a divergence in $x$ of the kinetic energy flux and does not contribute to the net field–particle energy exchange rate when spatially averaged in a periodic domain. For the velocity-advection term, integrate by parts in $v$ (assuming $f \\to 0$ at the velocity boundaries and $m=1$):\n$$\n\\int \\frac{1}{2} v^2 \\left(- q E \\frac{\\partial f}{\\partial v} \\right) dv = q E \\int v f \\, dv.\n$$\nTherefore, the instantaneous rate of energy transfer density from the field to the electrons at position $x$ is\n$$\n\\dot{W}(x,t) = \\int q\\, E(x,t)\\, v\\, f(x,v,t)\\, dv.\n$$\nTo resolve this transfer as a function of velocity, define the velocity-resolved field–particle correlation diagnostic\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\nwhere $\\langle \\cdot \\rangle_{x,t}$ denotes an average over space and over the simulation time interval. In the presence of Landau damping of a single electrostatic mode with wavenumber $k$, the resonant energy exchange is localized near the phase velocity $v_\\phi \\approx \\omega/k$, where $\\omega$ is the real frequency of the mode. Thus, the velocity $v$ at which $C(v)$ peaks for $v \\ge 0$ identifies the resonant velocity contributing to damping:\n$$\nv_{\\mathrm{res}} = \\arg\\max_{v \\ge 0} \\, C(v).\n$$\n\nAlgorithmic design:\n- Discretize the spatial domain $x \\in [0,L)$ with $N_x$ points and periodic boundary conditions, and the velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ with $N_v$ points.\n- Initialize $f(x,v,0)$ as a weakly perturbed Maxwellian $f_0(v)\\left[1 + \\alpha \\cos(kx)\\right]$ with thermal speed $v_{\\mathrm{th}}$.\n- Use Strang splitting to advance $f$ in time:\n  - Half-step velocity advection: For each spatial point $x_i$, advect the distribution in $v$ by $\\Delta v = a(x_i)\\, \\Delta t/2$ with $a(x_i) = q E(x_i)$, implemented via semi-Lagrangian linear interpolation along the $v$ grid with clamped boundary indices.\n  - Full-step spatial advection: For each velocity point $v_j$, advect the distribution in $x$ by $\\Delta x = v_j\\, \\Delta t$, implemented via semi-Lagrangian linear interpolation along the $x$ grid with periodic wrapping (using integer shifts and linear fractional interpolation).\n  - Solve Poisson’s equation in Fourier space: Compute the electron density $n_e(x) = \\int f(x,v)\\, dv$ via numerical quadrature (discrete sum times $\\Delta v$), form the charge density $\\rho(x) = 1 - n_e(x)$, take its discrete Fourier transform $\\hat{\\rho}(k_n)$, then for each nonzero Fourier mode with wavenumber $k_n$, obtain $\\hat{E}(k_n) = - i\\, \\hat{\\rho}(k_n)/k_n$, and inverse transform to get $E(x)$; set the zero mode of $\\hat{E}$ to zero to enforce periodic neutrality.\n  - Half-step velocity advection with the updated field.\n- At each full time step, accumulate the correlation $C(v)$ by computing the spatial average of $q\\, E(x,t)\\, v\\, f(x,v,t)$ at each velocity and summing over time, and at the end divide by the number of samples to obtain the time average.\n- Determine $v_{\\mathrm{res}}$ by finding the velocity $v \\ge 0$ at which $C(v)$ is maximal.\n\nNumerical details:\n- Choose $L = 2\\pi$, $N_x = 64$, $v_{\\max} = 5$, $N_v = 256$, $\\Delta t = 0.05$, $N_t = 300$, and $v_{\\mathrm{th}} = 1$.\n- The initial perturbation uses $k \\in \\{1,2,3\\}$ to align with the discrete Fourier modes of the periodic domain.\n- Use small $\\alpha$ (e.g., $\\alpha = 10^{-3}$ or $\\alpha = 5 \\times 10^{-4}$) to remain in the weakly nonlinear regime approximating linear Landau damping.\n- The velocity advection uses clamped interpolation near the boundaries; truncation errors are minimized by choosing $v_{\\max}$ so that $f$ is negligible at the boundaries for the chosen $v_{\\mathrm{th}}$.\n\nTest suite and outputs:\n- Test case $1$: $k = 1$, $\\alpha = 10^{-3}$.\n- Test case $2$: $k = 2$, $\\alpha = 10^{-3}$.\n- Test case $3$: $k = 3$, $\\alpha = 5 \\times 10^{-4}$.\nFor each test case, compute $C(v)$ and return $v_{\\mathrm{res}}$ as a float. The program must print a single line containing a comma-separated list of the three results enclosed in square brackets, e.g., $[r_1,r_2,r_3]$.\n\nThis approach strictly follows from the fundamental Vlasov–Poisson dynamics, derives the velocity-resolved energy transfer diagnostic from the kinetic energy equation, and implements a robust semi-Lagrangian numerical method suitable for capturing Landau damping and identifying the resonant velocity via the correlation $C(v)$.",
            "answer": "```python\nimport numpy as np\n\n# Vlasov-Poisson 1D1V solver with field–particle correlation diagnostic\n# Dimensionless units: q = -1, m = 1, L = 2*pi, v_th = 1\n\ndef maxwellian(v, v_th):\n    return (1.0 / (np.sqrt(2.0 * np.pi) * v_th)) * np.exp(-0.5 * (v / v_th) ** 2)\n\ndef solve_poisson(ne, dx, L):\n    # Solve dE/dx = 1 - ne using FFT with periodic boundary conditions\n    rho = 1.0 - ne  # Charge density (ions = 1)\n    rho_k = np.fft.fft(rho)\n    kfreq = np.fft.fftfreq(ne.size, d=dx)  # cycles per unit length\n    k = 2.0 * np.pi * kfreq  # angular wavenumbers\n    E_k = np.zeros_like(rho_k, dtype=np.complex128)\n    nonzero = k != 0.0\n    E_k[nonzero] = -1j * rho_k[nonzero] / k[nonzero]\n    E_k[~nonzero] = 0.0 + 0.0j  # enforce neutrality\n    E = np.fft.ifft(E_k).real\n    return E\n\ndef advect_x(f, vgrid, dt, dx):\n    # Semi-Lagrangian advection in x with periodic boundary\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    for j in range(Nv):\n        s = vgrid[j] * dt / dx\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        # Linear interpolation between shifted fields\n        out[:, j] = (1.0 - a) * np.roll(f[:, j], n) + a * np.roll(f[:, j], n + 1)\n    return out\n\ndef advect_v(f, E, dt, dv):\n    # Semi-Lagrangian advection in v with clamped boundary indices\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    j = np.arange(Nv)\n    for i in range(Nx):\n        s = (-E[i]) * dt / dv  # dv/dt = qE/m = -E\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        j0 = j - n\n        j1 = j - n - 1\n        j0 = np.clip(j0, 0, Nv - 1)\n        j1 = np.clip(j1, 0, Nv - 1)\n        out[i, :] = (1.0 - a) * f[i, j0] + a * f[i, j1]\n    return out\n\ndef run_case(k_mode, alpha, params):\n    # Unpack parameters\n    L = params['L']\n    Nx = params['Nx']\n    Nv = params['Nv']\n    vmax = params['vmax']\n    dt = params['dt']\n    Nt = params['Nt']\n    v_th = params['v_th']\n    q = -1.0\n\n    # Grids\n    x = np.linspace(0.0, L, Nx, endpoint=False)\n    v = np.linspace(-vmax, vmax, Nv)\n    dx = x[1] - x[0]\n    dv = v[1] - v[0]\n\n    # Initial distribution: weakly perturbed Maxwellian\n    f0 = maxwellian(v, v_th)  # shape (Nv,)\n    f = f0[None, :] * (1.0 + alpha * np.cos(k_mode * x)[:, None])  # shape (Nx, Nv)\n\n    # Initial field from Poisson\n    ne = np.sum(f, axis=1) * dv\n    E = solve_poisson(ne, dx, L)\n\n    # Correlation accumulator C(v)\n    C = np.zeros(Nv)\n\n    # Time loop with Strang splitting\n    for _ in range(Nt):\n        # Half-step in v\n        f = advect_v(f, E, dt * 0.5, dv)\n        # Full-step in x\n        f = advect_x(f, v, dt, dx)\n        # Update field\n        ne = np.sum(f, axis=1) * dv\n        E = solve_poisson(ne, dx, L)\n        # Half-step in v with updated field\n        f = advect_v(f, E, dt * 0.5, dv)\n\n        # Accumulate correlation C(v) =  q E v f _{x}\n        Ef = (E[:, None] * f)  # shape (Nx, Nv)\n        C += q * v * (Ef.mean(axis=0))\n\n    # Time-average\n    C /= Nt\n\n    # Identify resonant velocity v_res for v = 0 as location of maximum C(v)\n    pos_mask = v = 0.0\n    v_pos = v[pos_mask]\n    C_pos = C[pos_mask]\n    idx = int(np.argmax(C_pos))\n    v_res = float(v_pos[idx])\n    return v_res\n\ndef solve():\n    # Simulation parameters\n    params = {\n        'L': 2.0 * np.pi,\n        'Nx': 64,\n        'Nv': 256,\n        'vmax': 5.0,\n        'dt': 0.05,\n        'Nt': 300,\n        'v_th': 1.0,\n    }\n\n    # Test cases: (k, alpha)\n    test_cases = [\n        (1, 1e-3),\n        (2, 1e-3),\n        (3, 5e-4),\n    ]\n\n    results = []\n    for k_mode, alpha in test_cases:\n        v_res = run_case(k_mode, alpha, params)\n        results.append(v_res)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}