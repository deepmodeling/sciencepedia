{
    "hands_on_practices": [
        {
            "introduction": "Before simulating complex plasma phenomena, it is essential to cast the governing equations into a dimensionless form. This practice guides you through the process of nondimensionalizing the Vlasov-Poisson system, revealing the fundamental scales—the Debye length, plasma frequency, and thermal velocity—that govern electrostatic wave dynamics. By performing this foundational exercise , you will gain crucial insight into the natural units for length, time, and velocity in a plasma, a prerequisite for designing and interpreting numerical simulations.",
            "id": "3998548",
            "problem": "Consider a spatially uniform, collisionless, unmagnetized, two-species plasma composed of electrons and ions of charge number $Z$ and mass $m_i$, with electrons of mass $m_e$. Treat one-dimensional (1D) electrostatic waves with scalar electrostatic potential $\\phi(x,t)$, electric field $E(x,t) = -\\partial \\phi/\\partial x$, and species distribution functions $f_s(x,v,t)$, where $s \\in \\{e,i\\}$ denotes electrons ($e$) and ions ($i$). The dynamics are governed by the Vlasov equation for each species,\n$$\n\\frac{\\partial f_s}{\\partial t} + v \\frac{\\partial f_s}{\\partial x} + \\frac{q_s}{m_s} E \\frac{\\partial f_s}{\\partial v} = 0,\n$$\nand Poisson's equation,\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} = -\\frac{1}{\\epsilon_0}\\left(Z e \\int f_i\\, dv - e \\int f_e\\, dv\\right),\n$$\nwith $q_e = -e$ and $q_i = Z e$, and equilibrium number density $n_0$. Let the electron temperature be $T_e$ (assumed isotropic and time-independent for the purpose of nondimensionalization), and define the Debye length $\\lambda_D = \\sqrt{\\epsilon_0 k_B T_e/(n_0 e^2)}$, electron thermal speed $v_{Te} = \\sqrt{k_B T_e/m_e}$, and electron plasma frequency $\\omega_{pe} = \\sqrt{n_0 e^2/(\\epsilon_0 m_e)}$, where $k_B$ is the Boltzmann constant and $\\epsilon_0$ is the vacuum permittivity.\n\nFrom first principles, introduce dimensionless variables using $\\lambda_D$, $v_{Te}$, and $\\omega_{pe}$ to nondimensionalize the Vlasov–Poisson system such that the electron equation acquires order-unity coefficients. Then, linearize about a spatially uniform Maxwellian equilibrium and, using physically justified orderings appropriate to electron Langmuir waves (high-frequency electron oscillations with negligible ion response) and ion acoustic waves (low-frequency modes with negligible electron inertia and isothermal electron pressure), derive the dimensionless dispersion relations in terms of $\\tilde{\\omega} \\equiv \\omega/\\omega_{pe}$ and $\\tilde{k} \\equiv k \\lambda_D$.\n\nExplain the physical rationale for choosing $\\lambda_D$, $v_{Te}$, and $\\omega_{pe}$ as the characteristic length, velocity, and time scales for electrostatic wave dynamics, and explicitly state the ordering assumptions employed for the two branches (e.g., $\\omega \\sim \\omega_{pe}$, $\\omega \\ll \\omega_{pe}$, $k \\lambda_D \\ll 1$ or arbitrary).\n\nExpress the final answer as a single composite expression written as a row matrix whose six entries are, in order: $(1)$ the variable scalings defining $\\tilde{x}$, $\\tilde{t}$, $\\tilde{v}$, $\\tilde{\\phi}$, and $\\tilde{f}_s$ in terms of dimensional quantities; $(2)$ the dimensionless electron Vlasov equation; $(3)$ the dimensionless ion Vlasov equation; $(4)$ the dimensionless Poisson equation; $(5)$ the dimensionless Langmuir-wave dispersion relation; $(6)$ the dimensionless ion-acoustic-wave dispersion relation. No numerical evaluation is required; provide closed-form analytic expressions only.",
            "solution": "The problem statement is a standard, well-posed problem in introductory plasma kinetic theory. It is scientifically sound, self-contained, and all terms are well-defined. We may proceed with the solution.\n\nThe problem asks for the nondimensionalization of the 1D Vlasov-Poisson system, an explanation of the physical scales, and the derivation of the dispersion relations for Langmuir and ion-acoustic waves.\n\n**1. Nondimensionalization of the Vlasov-Poisson System**\n\nThe problem provides the characteristic scales for length, velocity, and frequency (or time) based on electron properties:\n- Length: $\\lambda_D = \\sqrt{\\epsilon_0 k_B T_e / (n_0 e^2)}$\n- Velocity: $v_{Te} = \\sqrt{k_B T_e / m_e}$\n- Frequency: $\\omega_{pe} = \\sqrt{n_0 e^2 / (\\epsilon_0 m_e)}$\n\nThese scales are related by $\\omega_{pe} \\lambda_D = v_{Te}$. We define the dimensionless variables (denoted by a tilde) as follows:\n- Position: $\\tilde{x} = x / \\lambda_D$\n- Time: $\\tilde{t} = t \\omega_{pe}$\n- Velocity: $\\tilde{v} = v / v_{Te}$\n- Electrostatic Potential: $\\tilde{\\phi} = e \\phi / (k_B T_e)$. This normalization compares the potential energy of an electron in the wave, $e\\phi$, to its thermal energy, $k_B T_e$.\n- Distribution Function: $\\tilde{f}_s = f_s v_{Te} / n_0$ for species $s \\in \\{e,i\\}$. This normalization is chosen such that the dimensionless number density is $\\tilde{n}_s = \\int \\tilde{f}_s d\\tilde{v}$.\n\nWe now transform the derivatives:\n$\\frac{\\partial}{\\partial t} = \\omega_{pe} \\frac{\\partial}{\\partial \\tilde{t}}$, $\\frac{\\partial}{\\partial x} = \\frac{1}{\\lambda_D} \\frac{\\partial}{\\partial \\tilde{x}}$, $\\frac{\\partial}{\\partial v} = \\frac{1}{v_{Te}} \\frac{\\partial}{\\partial \\tilde{v}}$.\nThe electric field becomes $E = -\\frac{\\partial \\phi}{\\partial x} = - \\frac{1}{\\lambda_D} \\frac{\\partial}{\\partial \\tilde{x}} \\left( \\frac{k_B T_e}{e} \\tilde{\\phi} \\right) = -\\frac{k_B T_e}{e \\lambda_D} \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}}$.\n\nSubstituting these into the Vlasov equation for species $s$:\n$$\n\\omega_{pe} \\frac{\\partial}{\\partial \\tilde{t}}\\left(\\frac{n_0}{v_{Te}}\\tilde{f}_s\\right) + (\\tilde{v}v_{Te}) \\frac{1}{\\lambda_D} \\frac{\\partial}{\\partial \\tilde{x}}\\left(\\frac{n_0}{v_{Te}}\\tilde{f}_s\\right) + \\frac{q_s}{m_s} \\left(-\\frac{k_B T_e}{e \\lambda_D} \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}}\\right) \\frac{1}{v_{Te}} \\frac{\\partial}{\\partial \\tilde{v}}\\left(\\frac{n_0}{v_{Te}}\\tilde{f}_s\\right) = 0\n$$\nDividing the entire equation by the constant factor $\\omega_{pe} n_0 / v_{Te}$:\n$$\n\\frac{\\partial \\tilde{f}_s}{\\partial \\tilde{t}} + \\frac{v_{Te}}{\\omega_{pe} \\lambda_D} \\tilde{v} \\frac{\\partial \\tilde{f}_s}{\\partial \\tilde{x}} - \\frac{1}{\\omega_{pe}} \\frac{q_s}{m_s} \\frac{k_B T_e}{e \\lambda_D v_{Te}} \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}} \\frac{\\partial \\tilde{f}_s}{\\partial \\tilde{v}} = 0\n$$\nThe coefficient of the second term is $\\frac{v_{Te}}{\\omega_{pe} \\lambda_D} = 1$. The coefficient of the third term is:\n$$\n\\frac{q_s}{m_s \\omega_{pe}} \\frac{k_B T_e}{e \\lambda_D v_{Te}} = \\left(\\frac{q_s}{e}\\right) \\frac{1}{m_s} \\frac{m_e v_{Te}^2}{\\omega_{pe} \\lambda_D v_{Te}} = \\left(\\frac{q_s}{e}\\right) \\frac{m_e}{m_s} \\frac{v_{Te}}{\\omega_{pe} \\lambda_D} = \\left(\\frac{q_s}{e}\\right) \\frac{m_e}{m_s}\n$$\nSo the general dimensionless Vlasov equation is:\n$$\n\\frac{\\partial \\tilde{f}_s}{\\partial \\tilde{t}} + \\tilde{v} \\frac{\\partial \\tilde{f}_s}{\\partial \\tilde{x}} - \\left(\\frac{q_s}{e}\\frac{m_e}{m_s}\\right) \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}} \\frac{\\partial \\tilde{f}_s}{\\partial \\tilde{v}} = 0\n$$\nFor electrons ($s=e$): $q_e = -e$, $m_s=m_e$. The coefficient is $(-1)(1) = -1$.\n$$\n\\frac{\\partial \\tilde{f}_e}{\\partial \\tilde{t}} + \\tilde{v} \\frac{\\partial \\tilde{f}_e}{\\partial \\tilde{x}} + \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}} \\frac{\\partial \\tilde{f}_e}{\\partial \\tilde{v}} = 0\n$$\nFor ions ($s=i$): $q_i = Ze$, $m_s=m_i$. The coefficient is $(Z)(m_e/m_i)$.\n$$\n\\frac{\\partial \\tilde{f}_i}{\\partial \\tilde{t}} + \\tilde{v} \\frac{\\partial \\tilde{f}_i}{\\partial \\tilde{x}} - Z\\frac{m_e}{m_i} \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}} \\frac{\\partial \\tilde{f}_i}{\\partial \\tilde{v}} = 0\n$$\nNext, we nondimensionalize Poisson's equation:\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} = -\\frac{1}{\\epsilon_0}\\left(Z e \\int f_i\\, dv - e \\int f_e\\, dv\\right)\n$$\nSubstituting the dimensionless variables:\n$$\n\\frac{1}{\\lambda_D^2} \\frac{\\partial^2}{\\partial \\tilde{x}^2}\\left(\\frac{k_B T_e}{e} \\tilde{\\phi}\\right) = -\\frac{e}{\\epsilon_0}\\left(Z \\int \\frac{n_0}{v_{Te}}\\tilde{f}_i (v_{Te}d\\tilde{v}) - \\int \\frac{n_0}{v_{Te}}\\tilde{f}_e (v_{Te}d\\tilde{v})\\right)\n$$\n$$\n\\frac{k_B T_e}{e \\lambda_D^2} \\frac{\\partial^2 \\tilde{\\phi}}{\\partial \\tilde{x}^2} = -\\frac{e n_0}{\\epsilon_0} \\left(Z \\int \\tilde{f}_i \\,d\\tilde{v} - \\int \\tilde{f}_e \\,d\\tilde{v} \\right)\n$$\nMultiplying by $\\frac{\\epsilon_0 \\lambda_D^2}{k_B T_e}$:\n$$\n\\frac{\\partial^2 \\tilde{\\phi}}{\\partial \\tilde{x}^2} = -\\frac{n_0 e^2 \\lambda_D^2}{\\epsilon_0 k_B T_e} \\left(Z \\int \\tilde{f}_i \\,d\\tilde{v} - \\int \\tilde{f}_e \\,d\\tilde{v} \\right)\n$$\nThe coefficient is $\\frac{n_0 e^2}{\\epsilon_0 k_B T_e} \\lambda_D^2 = 1$ by definition of $\\lambda_D$. So, the dimensionless Poisson equation is:\n$$\n\\frac{\\partial^2 \\tilde{\\phi}}{\\partial \\tilde{x}^2} = \\int \\tilde{f}_e \\,d\\tilde{v} - Z \\int \\tilde{f}_i \\,d\\tilde{v}\n$$\n\n**2. Physical Rationale for Characteristic Scales**\n\nThe choice of $\\omega_{pe}$, $v_{Te}$, and $\\lambda_D$ as characteristic scales is physically motivated by the central role of electrons in electrostatic plasma phenomena.\n- **Electron Plasma Frequency, $\\omega_{pe}$**: This is the natural frequency of oscillation for electrons when displaced from their equilibrium positions in a fixed ion background. The restoring force is electrostatic attraction to the ions. It represents the fastest collective timescale in the plasma, making it the natural unit for time or frequency.\n- **Electron Thermal Velocity, $v_{Te}$**: This is the typical speed of an electron due to its thermal energy. It governs kinetic processes such as the rate at which particles traverse a given distance, setting the scale for wave-particle interactions like Landau damping.\n- **Debye Length, $\\lambda_D$**: This is the fundamental length scale for electrostatic interactions. Over distances greater than $\\lambda_D$, the electric field of a charge is effectively screened by a cloud of mobile, oppositely charged particles (primarily electrons). The plasma maintains quasi-neutrality on scales $L \\gg \\lambda_D$, while significant charge separation can occur on scales $L \\lesssim \\lambda_D$.\nThese three quantities are interconnected via $\\omega_{pe} \\lambda_D = v_{Te}$, which signifies that a thermal electron traverses one Debye length in a time $1/\\omega_{pe}$. This inherent consistency makes them an ideal set of units for normalizing the Vlasov-Poisson system, particularly for phenomena where electron dynamics are dominant.\n\n**3. Linearization and Dispersion Relations**\n\nWe linearize the system by assuming small perturbations around a stationary, homogeneous Maxwellian equilibrium: $f_s = f_{s0}(v) + f_{s1}(x,v,t)$ and $\\phi = \\phi_1(x,t)$, where $f_{s1}$ and $\\phi_1$ are small. The equilibrium distributions are:\n$$\nf_{e0}(v) = \\frac{n_0}{\\sqrt{2\\pi} v_{Te}} \\exp\\left(-\\frac{v^2}{2v_{Te}^2}\\right), \\quad f_{i0}(v) = \\frac{n_0/Z}{\\sqrt{2\\pi} v_{Ti}} \\exp\\left(-\\frac{v^2}{2v_{Ti}^2}\\right)\n$$\nwhere $v_{Ti} = \\sqrt{k_B T_i/m_i}$. The linearized Vlasov equation is $\\frac{\\partial f_{s1}}{\\partial t} + v \\frac{\\partial f_{s1}}{\\partial x} + \\frac{q_s}{m_s} E_1 \\frac{\\partial f_{s0}}{\\partial v} = 0$.\nAssuming plane wave solutions $\\propto \\exp[i(kx - \\omega t)]$, we get:\n$$\n-i\\omega f_{s1} + ikv f_{s1} + \\frac{q_s}{m_s} (-ik\\phi_1) \\frac{\\partial f_{s0}}{\\partial v} = 0 \\implies f_{s1} = \\frac{q_s k \\phi_1}{m_s(\\omega - kv)} \\frac{\\partial f_{s0}}{\\partial v}\n$$\nThe linearized Poisson equation is $-k^2 \\phi_1 = -\\frac{1}{\\epsilon_0}(Ze n_{i1} - e n_{e1})$, where $n_{s1} = \\int f_{s1} dv$. Substituting for $f_{s1}$ and simplifying yields the general dielectric function $\\epsilon(\\omega, k) = 0$:\n$$\n\\epsilon(\\omega, k) = 1 - \\sum_{s \\in \\{e,i\\}} \\frac{\\omega_{ps}^2}{k} \\int_{-\\infty}^{\\infty} \\frac{\\partial f_{s0}/\\partial v}{v - \\omega/k} \\frac{dv}{n_{s0}} = 0\n$$\nwhere we use distributions normalized to unity.\n\n**A. Electron Langmuir Waves**\n- **Ordering Assumptions**: These are high-frequency oscillations, so $\\omega \\sim \\omega_{pe}$. Ions are much heavier than electrons ($m_i \\gg m_e$), so they cannot respond on this fast timescale and are treated as a fixed, neutralizing background ($\\chi_i \\approx 0$). We also assume the phase velocity is much larger than the electron thermal velocity, $\\omega/k \\gg v_{Te}$, which corresponds to long wavelengths $k\\lambda_D \\ll 1$ and weak damping.\n- **Derivation**: With $\\chi_i = 0$, the dispersion relation becomes $1+\\chi_e(\\omega, k)=0$.\n$$\n1 + \\frac{\\omega_{pe}^2}{k^2} \\int \\frac{\\partial f_{e0}/\\partial v}{v - \\omega/k} \\frac{dv}{n_0} = 0\n$$\nUsing integration by parts, this is equivalent to $1 = \\frac{\\omega_{pe}^2}{n_0}\\int \\frac{f_{e0}(v)}{(\\omega-kv)^2}dv$. Expanding for $\\omega \\gg kv$:\n$$\n1 \\approx \\frac{\\omega_{pe}^2}{n_0 \\omega^2} \\int f_{e0}\\left(1 + \\frac{2kv}{\\omega} + \\frac{3k^2v^2}{\\omega^2}\\right) dv = \\frac{\\omega_{pe}^2}{\\omega^2}\\left(1 + 0 + \\frac{3k^2\\langle v^2 \\rangle_e}{\\omega^2}\\right)\n$$\nWith $\\langle v^2 \\rangle_e = v_{Te}^2$ for the 1D Maxwellian, and approximating $\\omega \\approx \\omega_{pe}$ in the small correction term:\n$$\n\\omega^2 \\approx \\omega_{pe}^2 \\left(1 + 3k^2 \\frac{v_{Te}^2}{\\omega_{pe}^2}\\right) = \\omega_{pe}^2(1 + 3k^2\\lambda_D^2)\n$$\n- **Dimensionless Form**: Let $\\tilde{\\omega} = \\omega/\\omega_{pe}$ and $\\tilde{k} = k\\lambda_D$.\n$$\n\\tilde{\\omega}^2 \\omega_{pe}^2 = \\omega_{pe}^2(1 + 3\\tilde{k}^2) \\implies \\tilde{\\omega}^2 = 1 + 3\\tilde{k}^2\n$$\n\n**B. Ion Acoustic Waves**\n- **Ordering Assumptions**: These are low-frequency modes, $\\omega \\ll \\omega_{pe}$. Electron inertia is negligible; they respond isothermally to the potential, maintaining a Boltzmann distribution. This corresponds to the phase velocity being much smaller than the electron thermal velocity, $\\omega/k \\ll v_{Te}$. For the wave to propagate with weak damping, the phase velocity must be much larger than the ion thermal velocity, $\\omega/k \\gg v_{Ti}$. This requires $T_e \\gg T_i$.\n- **Derivation**: In the limit $\\omega/k \\ll v_{Te}$, the electron susceptibility becomes $\\chi_e \\approx 1/(k^2\\lambda_D^2)$. This represents Debye shielding. The ions are treated as a cold fluid, $\\omega/k \\gg v_{Ti}$, so their susceptibility is $\\chi_i \\approx -\\omega_{pi}^2/\\omega^2$. The dispersion relation $1 + \\chi_e + \\chi_i = 0$ becomes:\n$$\n1 + \\frac{1}{k^2\\lambda_D^2} - \\frac{\\omega_{pi}^2}{\\omega^2} = 0\n$$\nSolving for $\\omega^2$:\n$$\n\\omega^2 = \\frac{\\omega_{pi}^2}{1 + 1/(k^2\\lambda_D^2)} = \\frac{\\omega_{pi}^2 k^2\\lambda_D^2}{1 + k^2\\lambda_D^2}\n$$\n- **Dimensionless Form**: Using $\\tilde{\\omega} = \\omega/\\omega_{pe}$ and $\\tilde{k} = k\\lambda_D$:\n$$\n\\tilde{\\omega}^2 \\omega_{pe}^2 = \\frac{\\omega_{pi}^2 \\tilde{k}^2}{1 + \\tilde{k}^2}\n$$\nDividing by $\\omega_{pe}^2$ and using the ratio $\\omega_{pi}^2/\\omega_{pe}^2 = (Z n_0 e^2/\\epsilon_0 m_i) / (n_0 e^2/\\epsilon_0 m_e) = Z m_e/m_i$:\n$$\n\\tilde{\\omega}^2 = \\frac{Z m_e}{m_i} \\frac{\\tilde{k}^2}{1+\\tilde{k}^2}\n$$\n\nThe six required expressions have been derived and are summarized in the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{array}{l} \\tilde{x} = x/\\lambda_D \\\\ \\tilde{t} = \\omega_{pe}t \\\\ \\tilde{v} = v/v_{Te} \\\\ \\tilde{\\phi} = e\\phi/(k_B T_e) \\\\ \\tilde{f}_s = f_s v_{Te}/n_0 \\end{array}\n\n\\frac{\\partial \\tilde{f}_e}{\\partial \\tilde{t}} + \\tilde{v} \\frac{\\partial \\tilde{f}_e}{\\partial \\tilde{x}} + \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}} \\frac{\\partial \\tilde{f}_e}{\\partial \\tilde{v}} = 0\n\n\\frac{\\partial \\tilde{f}_i}{\\partial \\tilde{t}} + \\tilde{v} \\frac{\\partial \\tilde{f}_i}{\\partial \\tilde{x}} - Z\\frac{m_e}{m_i} \\frac{\\partial \\tilde{\\phi}}{\\partial \\tilde{x}} \\frac{\\partial \\tilde{f}_i}{\\partial \\tilde{v}} = 0\n\n\\frac{\\partial^2 \\tilde{\\phi}}{\\partial \\tilde{x}^2} = \\int \\tilde{f}_e d\\tilde{v} - Z \\int \\tilde{f}_i d\\tilde{v}\n\n\\tilde{\\omega}^2 = 1 + 3\\tilde{k}^2\n\n\\tilde{\\omega}^2 = \\frac{Z m_e}{m_i} \\frac{\\tilde{k}^2}{1+\\tilde{k}^2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The accuracy and stability of a numerical simulation are not just matters of programming; they are fundamentally tied to the physics being modeled. This exercise  provides a crucial link between the physical properties of plasma waves and the practical constraints of an explicit time-stepping algorithm. By calculating the maximum phase velocity of electrostatic modes, you will determine the Courant-Friedrichs-Lewy (CFL) stability limit, a hard ceiling on the simulation time step required to prevent numerical instability.",
            "id": "3998560",
            "problem": "Consider a one-dimensional, collisionless, electrostatic plasma composed of electrons and singly charged deuterium ions described by the kinetic Vlasov–Poisson system. The species distribution functions $f_{s}(x,v,t)$ satisfy the Vlasov equations\n$$\\frac{\\partial f_{s}}{\\partial t} + v\\,\\frac{\\partial f_{s}}{\\partial x} + \\frac{q_{s}}{m_{s}}\\,E(x,t)\\,\\frac{\\partial f_{s}}{\\partial v} = 0,$$\nwith $s \\in \\{e,i\\}$, and the electric field $E(x,t)$ is related to the charge density by Poisson’s equation\n$$\\frac{\\partial E}{\\partial x} = \\frac{q_{i} n_{i}(x,t) + q_{e} n_{e}(x,t)}{\\varepsilon_{0}}, \\quad n_{s}(x,t) = \\int_{-\\infty}^{\\infty} f_{s}(x,v,t)\\,dv,$$\nwhere $q_{e} = -e$, $q_{i} = +e$, and $\\varepsilon_{0}$ is the vacuum permittivity. Assume spatial periodicity in a domain of length $L_{x}$ so that admissible wavenumbers are $k_{m} = \\frac{2\\pi m}{L_{x}}$ for integer $m \\neq 0$.\n\nYou are tasked to determine the explicit time-stepping stability restriction (a Courant–Friedrichs–Lewy (CFL)-like condition) for finite-difference discretizations that resolve the fastest electrostatic normal modes supported by the linearized Vlasov–Poisson system. Proceed from the following fundamental base:\n- Linearize the system about a spatially homogeneous Maxwellian equilibrium for each species with temperatures $T_{e}$ and $T_{i}$ and common density $n_{0}$.\n- Use well-tested long-wavelength limits for the dispersion of electrostatic modes: the electron plasma (Langmuir) branch and the ion acoustic branch. In the warm-fluid limit for electrons, the Langmuir dispersion is consistent with the Bohm–Gross relation, and for ion acoustic waves with isothermal electrons and cold ions, the dispersion includes finite Debye length effects through Poisson’s equation.\n\nLet the spatial discretization have uniform grid spacing $\\Delta x$ and assume an explicit finite-difference update whose stability is governed by a standard CFL bound of the form\n$$\\Delta t \\leq \\frac{\\Delta x}{\\max\\limits_{k} v_{\\mathrm{ph}}(k)},$$\nwhere $v_{\\mathrm{ph}}(k)$ is the phase speed of the fastest resolvable electrostatic mode at wavenumber $k$ and the maximum is over all nonzero wavenumbers supported by the discrete periodic domain.\n\nUsing the parameters\n- $n_{0} = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$,\n- $T_{e} = 100\\,\\mathrm{eV}$, $T_{i} \\to 0$ (cold ions for ion acoustic),\n- $m_{e} = 9.109\\,\\times 10^{-31}\\,\\mathrm{kg}$, $m_{i} = 3.344\\,\\times 10^{-27}\\,\\mathrm{kg}$,\n- $e = 1.602\\,\\times 10^{-19}\\,\\mathrm{C}$, $\\varepsilon_{0} = 8.854\\,\\times 10^{-12}\\,\\mathrm{F/m}$,\n- $L_{x} = 2.0 \\times 10^{-3}\\,\\mathrm{m}$, and $N_{x} = 1024$ so that $\\Delta x = \\frac{L_{x}}{N_{x}}$,\n\nderive from first principles the relevant linear electrostatic phase speeds $v_{\\mathrm{ph},L}(k)$ for Langmuir waves and $v_{\\mathrm{ph},S}(k)$ for ion acoustic waves. Identify the maximum resolvable phase speed over the discrete wavenumber set and determine the most restrictive CFL-like bound on the explicit time step $\\Delta t$. Compute the resulting numerical upper bound on $\\Delta t$ using the given parameters. Express the final time step in seconds and round your answer to three significant figures.",
            "solution": "The user has requested a solution to a problem in computational plasma physics. My first obligation is to validate the problem statement.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- **System**: One-dimensional, collisionless, electrostatic plasma with electrons ($e$) and singly charged deuterium ions ($i$).\n- **Governing Equations**:\n    - Vlasov equation: $\\frac{\\partial f_{s}}{\\partial t} + v\\,\\frac{\\partial f_{s}}{\\partial x} + \\frac{q_{s}}{m_{s}}\\,E(x,t)\\,\\frac{\\partial f_{s}}{\\partial v} = 0$, for $s \\in \\{e,i\\}$.\n    - Poisson's equation: $\\frac{\\partial E}{\\partial x} = \\frac{q_{i} n_{i} + q_{e} n_{e}}{\\varepsilon_{0}}$, where $n_{s}(x,t) = \\int_{-\\infty}^{\\infty} f_{s}(x,v,t)\\,dv$.\n- **Charges**: $q_{e} = -e$, $q_{i} = +e$.\n- **Domain**: Spatially periodic with length $L_{x}$.\n- **Wavenumbers**: $k_{m} = \\frac{2\\pi m}{L_{x}}$ for integer $m \\neq 0$.\n- **Assumptions for Linearization**: Linearize about a spatially homogeneous Maxwellian equilibrium with temperatures $T_{e}$, $T_{i}$ and common density $n_{0}$.\n- **Dispersion Relations (to be used)**:\n    - Langmuir (electron plasma) waves: Bohm–Gross relation, consistent with a warm-fluid limit.\n    - Ion acoustic waves: Isothermal electrons ($T_{e}$) and cold ions ($T_{i} \\to 0$), including finite Debye length effects.\n- **Discretization and Stability**:\n    - Uniform spatial grid with spacing $\\Delta x$.\n    - Explicit finite-difference scheme with a CFL-like bound: $\\Delta t \\leq \\frac{\\Delta x}{\\max\\limits_{k} v_{\\mathrm{ph}}(k)}$, where $v_{\\mathrm{ph}}(k)$ is the phase speed of the fastest resolvable mode at wavenumber $k$, and the maximum is over all nonzero wavenumbers supported by the discrete domain.\n- **Numerical Parameters**:\n    - $n_{0} = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n    - $T_{e} = 100\\,\\mathrm{eV}$\n    - $T_{i} \\to 0$\n    - $m_{e} = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$\n    - $m_{i} = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$ (deuterium)\n    - $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n    - $\\varepsilon_{0} = 8.854 \\times 10^{-12}\\,\\mathrm{F/m}$\n    - $L_{x} = 2.0 \\times 10^{-3}\\,\\mathrm{m}$\n    - $N_{x} = 1024$, with $\\Delta x = L_{x}/N_{x}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is set within the standard framework of plasma kinetic theory (Vlasov-Poisson system) and its numerical simulation. The concepts of Langmuir waves, ion acoustic waves, Debye shielding, and CFL conditions are fundamental to plasma physics and computational science. The models specified (Bohm-Gross, isothermal electrons) are well-established, valid approximations in certain regimes. The problem is scientifically sound.\n- **Well-Posed**: The problem asks for the calculation of a numerical stability bound based on a clearly defined formula and a set of physical parameters. The required inputs are all provided, and the task is to derive and compute a single value. A unique solution exists.\n- **Objective**: The language is precise and technical. It provides specific models and parameters, leaving no room for subjective interpretation.\n\nThe problem does not exhibit any of the invalidity flaws. The use of approximate dispersion relations is a standard pedagogical simplification and does not render the problem scientifically unsound, especially since their use is an explicit instruction.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with a full, reasoned solution.\n\nThe task is to determine the upper bound on the time step $\\Delta t$ for a finite-difference scheme, subject to the stability condition $\\Delta t \\leq \\frac{\\Delta x}{\\max\\limits_{k} v_{\\mathrm{ph}}(k)}$. This requires identifying the maximum phase speed, $v_{\\mathrm{ph}}(k) = \\omega(k)/k$, over all relevant wave modes and all wavenumbers $k$ supported by the numerical grid.\n\nFirst, we identify the dispersion relations for the two types of electrostatic modes as per the problem's instructions.\n\n1.  **Langmuir Waves**: The problem specifies using the Bohm-Gross dispersion relation:\n    $$ \\omega_{L}^2(k) = \\omega_{pe}^2 + 3 k^2 v_{th,e}^2 $$\n    Here, $\\omega_{pe} = \\sqrt{\\frac{n_{0} e^2}{m_{e} \\varepsilon_{0}}}$ is the electron plasma frequency, and $v_{th,e} = \\sqrt{\\frac{k_{B} T_{e}}{m_{e}}}$ is the electron thermal velocity. Note that the temperature $T_e$ is given in electron-volts (eV), so the energy $k_B T_e$ in Joules is obtained by multiplying by the elementary charge $e$. The phase speed is:\n    $$ v_{\\mathrm{ph},L}(k) = \\frac{\\omega_{L}(k)}{k} = \\sqrt{\\frac{\\omega_{pe}^2}{k^2} + 3 v_{th,e}^2} $$\n\n2.  **Ion Acoustic Waves**: For isothermal electrons ($T_{e}$) and cold ions ($T_{i} \\to 0$), the dispersion relation is:\n    $$ \\omega_{S}^2(k) = \\frac{k^2 c_{s}^2}{1 + k^2 \\lambda_{De}^2} $$\n    Here, $c_{s} = \\sqrt{\\frac{k_{B} T_{e}}{m_{i}}}$ is the ion sound speed, and $\\lambda_{De} = \\sqrt{\\frac{\\varepsilon_{0} k_{B} T_{e}}{n_{0} e^2}}$ is the electron Debye length. The phase speed is:\n    $$ v_{\\mathrm{ph},S}(k) = \\frac{\\omega_{S}(k)}{k} = \\frac{c_{s}}{\\sqrt{1 + k^2 \\lambda_{De}^2}} $$\n\nNext, we must find the maximum phase speed, $\\max\\limits_{k} v_{\\mathrm{ph}}(k)$, over the set of allowed wavenumbers. The domain is periodic of length $L_x$ and discretized with $N_x$ points, giving a grid spacing of $\\Delta x = L_x / N_x$. The supported wavenumbers are $k_m = \\frac{2\\pi m}{L_x}$ for $m = 1, 2, \\dots, N_x/2$. The smallest non-zero wavenumber is $k_{\\min} = \\frac{2\\pi}{L_x}$ (for $m=1$), and the largest is the Nyquist wavenumber $k_{\\max} = \\frac{\\pi}{\\Delta x}$ (for $m=N_x/2$).\n\nWe analyze the dependence of the phase speeds on $k$:\n-   For Langmuir waves, $v_{\\mathrm{ph},L}(k) = \\sqrt{\\frac{\\omega_{pe}^2}{k^2} + 3 v_{th,e}^2}$. Since $k^2$ is in the denominator of the first term, $v_{\\mathrm{ph},L}(k)$ is a monotonically decreasing function for $k  0$. Its maximum value occurs at the smallest possible wavenumber, $k_{\\min}$.\n-   For ion acoustic waves, $v_{\\mathrm{ph},S}(k) = \\frac{c_{s}}{\\sqrt{1 + k^2 \\lambda_{De}^2}}$. Similarly, this is a monotonically decreasing function of $k$ for $k  0$. Its maximum value also occurs at $k_{\\min}$.\n\nThe overall maximum phase speed is therefore $\\max(v_{\\mathrm{ph},L}(k_{\\min}), v_{\\mathrm{ph},S}(k_{\\min}))$. We compare the two. The electron thermal velocity $v_{th,e} = \\sqrt{k_B T_e / m_e}$ is significantly larger than the ion sound speed $c_s = \\sqrt{k_B T_e / m_i}$ because the electron mass $m_e$ is much smaller than the ion mass $m_i$. Specifically, $v_{th,e}^2/c_s^2 = m_i/m_e \\gg 1$.\nThe squared phase speed for Langmuir waves is $v_{\\mathrm{ph},L}^2 = \\frac{\\omega_{pe}^2}{k^2} + 3 v_{th,e}^2$. The squared phase speed for ion acoustic waves is $v_{\\mathrm{ph},S}^2 = \\frac{c_{s}^2}{1 + k^2 \\lambda_{De}^2}  c_s^2$.\nSince $v_{th,e}^2 \\gg c_s^2$, it is clear that $v_{\\mathrm{ph},L}^2(k)  3 v_{th,e}^2 \\gg c_s^2  v_{\\mathrm{ph},S}^2(k)$ for all $k$. Thus, the Langmuir waves are significantly faster than the ion acoustic waves.\n\nThe fastest mode in the system is the Langmuir wave at the smallest possible wavenumber. The maximum phase speed is:\n$$ v_{\\max} = v_{\\mathrm{ph},L}(k_{\\min}) = \\sqrt{\\frac{\\omega_{pe}^2}{k_{\\min}^2} + 3 v_{th,e}^2} $$\nThe stability condition is therefore:\n$$ \\Delta t \\leq \\frac{\\Delta x}{v_{\\max}} = \\frac{\\Delta x}{\\sqrt{\\frac{\\omega_{pe}^2}{(2\\pi/L_x)^2} + 3 v_{th,e}^2}} $$\n\nNow we substitute the given numerical values to compute the bound on $\\Delta t$.\n**1. Grid parameters**:\n$L_{x} = 2.0 \\times 10^{-3}\\,\\mathrm{m}$\n$N_{x} = 1024$\n$\\Delta x = \\frac{L_{x}}{N_{x}} = \\frac{2.0 \\times 10^{-3}}{1024} = 1.953125 \\times 10^{-6}\\,\\mathrm{m}$\n$k_{\\min} = \\frac{2\\pi}{L_{x}} = \\frac{2\\pi}{2.0 \\times 10^{-3}} = 1000\\pi\\,\\mathrm{m}^{-1}$\n$k_{\\min}^2 = (1000\\pi)^2 = 10^6 \\pi^2\\,\\mathrm{m}^{-2}$\n\n**2. Physical parameters**:\n$n_{0} = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n$e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n$m_{e} = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$\n$\\varepsilon_{0} = 8.854 \\times 10^{-12}\\,\\mathrm{F/m}$\n$T_{e} = 100\\,\\mathrm{eV}$, so $k_B T_e = 100 \\times (1.602 \\times 10^{-19}) = 1.602 \\times 10^{-17}\\,\\mathrm{J}$\n\n**3. Derived physical quantities**:\nElectron plasma frequency squared:\n$$ \\omega_{pe}^2 = \\frac{n_{0} e^2}{m_{e} \\varepsilon_{0}} = \\frac{(1.0 \\times 10^{19})(1.602 \\times 10^{-19})^2}{(9.109 \\times 10^{-31})(8.854 \\times 10^{-12})} \\approx 3.182 \\times 10^{22}\\,\\mathrm{s}^{-2} $$\nElectron thermal velocity squared:\n$$ v_{th,e}^2 = \\frac{k_{B} T_{e}}{m_{e}} = \\frac{1.602 \\times 10^{-17}}{9.109 \\times 10^{-31}} \\approx 1.759 \\times 10^{13}\\,\\mathrm{(m/s)}^2 $$\n\n**4. Maximum phase speed calculation**:\n$$ v_{\\max}^2 = \\frac{\\omega_{pe}^2}{k_{\\min}^2} + 3 v_{th,e}^2 = \\frac{3.182 \\times 10^{22}}{10^6 \\pi^2} + 3(1.759 \\times 10^{13}) $$\n$$ v_{\\max}^2 \\approx \\frac{3.182 \\times 10^{22}}{9.870 \\times 10^6} + 5.277 \\times 10^{13} \\approx 3.224 \\times 10^{15} + 0.05277 \\times 10^{15} \\approx 3.277 \\times 10^{15}\\,\\mathrm{(m/s)}^2 $$\n$$ v_{\\max} = \\sqrt{3.277 \\times 10^{15}} \\approx 5.725 \\times 10^7\\,\\mathrm{m/s} $$\n\n**5. Time step calculation**:\n$$ \\Delta t \\leq \\frac{\\Delta x}{v_{\\max}} = \\frac{1.953125 \\times 10^{-6}\\,\\mathrm{m}}{5.725 \\times 10^7\\,\\mathrm{m/s}} \\approx 3.4116 \\times 10^{-14}\\,\\mathrm{s} $$\nRounding to three significant figures, the numerical upper bound on the time step is $3.41 \\times 10^{-14}\\,\\mathrm{s}$.",
            "answer": "$$\\boxed{3.41 \\times 10^{-14}}$$"
        },
        {
            "introduction": "This practice moves from analysis to direct implementation, challenging you to build a numerical solver for the Zakharov equations, a cornerstone model for studying the nonlinear interaction between Langmuir and ion acoustic waves. You will implement a split-step Fourier method to simulate the onset of modulational instability, a key process in the development of strong plasma turbulence. This exercise  will culminate in a quantitative comparison between your simulation results and linear theory, a vital skill for verifying the correctness of any scientific code.",
            "id": "3998535",
            "problem": "You are asked to implement a numerical solver for the coupled dynamics of Langmuir waves and ion acoustic waves in one spatial dimension using the Zakharov equations. The aim is to compute modulational instability growth rates from direct numerical simulation and compare them to linear theory obtained by Fourier-mode linearization. All quantities are normalized and dimensionless.\n\nThe one-dimensional Zakharov equations for the complex Langmuir envelope $E(x,t)$ and the real ion density perturbation $n(x,t)$ are\n$$\ni \\,\\partial_t E + \\partial_{xx} E = n\\,E,\n$$\n$$\n\\partial_{tt} n - c_s^2\\,\\partial_{xx} n = \\partial_{xx} \\left|E\\right|^2,\n$$\nwhere $c_s$ is the dimensionless ion acoustic speed. Consider periodic boundary conditions on the interval $x \\in [0,L]$ with $L0$.\n\nStarting from the above equations, you must:\n- Implement a Split-Step Fourier Method (SSFM) for the Langmuir envelope equation, splitting the evolution into the linear dispersive part and the nonlinear coupling to the ion density $n(x,t)$. The linear part is solved exactly in Fourier space, and the nonlinear part is solved in physical space by a phase multiplication. Use Strang splitting over each time step of size $\\Delta t$.\n- Implement a spectral, second-order accurate update for the ion density $n(x,t)$ based on a leapfrog-type scheme for the forced wave equation in Fourier space:\n$$\n\\hat{n}_{k}(t+\\Delta t) = 2\\,\\hat{n}_{k}(t) - \\hat{n}_{k}(t-\\Delta t) - \\Delta t^2 \\left(c_s^2\\,k^2 \\hat{n}_{k}(t) + k^2 \\hat{S}_{k}(t)\\right),\n$$\nwhere $\\hat{n}_{k}$ denotes the Fourier transform of $n(x,t)$ at wavenumber $k$, and $\\hat{S}_{k}(t)$ is the Fourier transform of $S(x,t) = |E(x,t)|^2$. Initialize $\\hat{n}_{k}(t-\\Delta t)$ consistently using a second-order Taylor expansion at $t=0$ with $n(x,0)=0$ and $\\partial_t n(x,0)=0$.\n\nUse the following initial conditions:\n- The Langmuir envelope is initialized with a small-amplitude modulation at wavenumber $k_0$:\n$$\nE(x,0) = E_0\\left(1 + a_0 \\cos(k_0 x)\\right),\n$$\nwith $E_00$ and $0a_0\\ll 1$.\n- The ion density perturbation and its initial time derivative are zero:\n$$\nn(x,0)=0,\\quad \\partial_t n(x,0)=0.\n$$\n\nTo quantify the modulational instability growth rate from simulation, track the amplitude of the Fourier component of $E(x,t)$ at wavenumber $k_0$. Let $\\hat{E}_{k_0}(t)$ be the Fourier transform of $E(x,t)$ at the mode $k_0$. Define $A(t) = \\left|\\hat{E}_{k_0}(t)\\right|$. Estimate the simulated growth rate $\\gamma_{\\mathrm{sim}}$ by performing a least-squares fit of $\\ln A(t)$ versus $t$ over the early-time window where the amplitude remains small (use the initial segment of the time series to avoid nonlinear saturation). The estimated $\\gamma_{\\mathrm{sim}}$ is the slope of this fit, clipped below at zero if the fit yields a negative value.\n\nTo obtain the linear theory growth rate, linearize the Zakharov system around the uniform pump state $E(x,t)=E_0$ and $n(x,t)=0$. Introduce real and imaginary parts of the complex perturbation $\\delta E(x,t)=u(x,t)+i\\,v(x,t)$ and Fourier-decompose at a single wavenumber $k_0$. The linearized system for the mode amplitudes $u_{k_0}(t)$, $v_{k_0}(t)$, $n_{k_0}(t)$, and $m_{k_0}(t)=\\partial_t n_{k_0}(t)$ is\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\nu_{k_0} \\\\\nv_{k_0} \\\\\nn_{k_0} \\\\\nm_{k_0}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0  k_0^2  0  0 \\\\\n-k_0^2  0  -E_0  0 \\\\\n0  0  0  1 \\\\\n-2 E_0 k_0^2  0  -c_s^2 k_0^2  0\n\\end{bmatrix}\n\\begin{bmatrix}\nu_{k_0} \\\\\nv_{k_0} \\\\\nn_{k_0} \\\\\nm_{k_0}\n\\end{bmatrix}.\n$$\nLet $\\lambda$ denote the eigenvalues of the $4\\times 4$ matrix above. The linear growth rate $\\gamma_{\\mathrm{lin}}$ is defined as the maximum of the real parts of $\\lambda$, clipped below at zero.\n\nImplement the numerical solver with the following fixed discretization and test suite. All quantities are dimensionless, and angles are expressed in radians:\n- Spatial domain length $L = 2\\pi$.\n- Number of grid points $N = 256$.\n- Time step $\\Delta t = 10^{-3}$.\n- Total simulated time $T = 1.0$.\n- Initial modulation index $m$ such that $k_0 = m \\cdot \\frac{2\\pi}{L}$, with $m=1$ in all tests.\n- Initial modulation amplitude $a_0 = 10^{-4}$.\n\nTest suite (each test is a tuple $(E_0,c_s)$ with $m=1$ fixed):\n1. $(E_0,c_s)=(1.0,\\,0.1)$: a general case where modulational instability is expected.\n2. $(E_0,c_s)=(0.3,\\,0.1)$: a near-threshold case where growth, if present, is weaker.\n3. $(E_0,c_s)=(0.05,\\,0.1)$: a stable case where no growth should be observed.\n\nFor each test case, compute the absolute difference between the simulated growth rate and the linear growth rate,\n$$\n\\Delta \\gamma = \\left|\\gamma_{\\mathrm{sim}} - \\gamma_{\\mathrm{lin}}\\right|,\n$$\nand aggregate the three differences into a single output line.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where each result is a float corresponding to $\\Delta \\gamma$ for the respective test case. No other text should be printed.",
            "solution": "The user-provided problem is assessed to be valid. It is a well-posed, scientifically grounded problem in computational plasma physics, with all necessary parameters and methods specified for a unique solution.\n\nThe problem requires the numerical investigation of modulational instability in the one-dimensional Zakharov system, a canonical model for the interaction of high-frequency Langmuir waves and low-frequency ion acoustic waves. The core task is to implement a numerical solver, compute the instability growth rate from the simulation, and compare it with the growth rate derived from linear stability analysis.\n\n### 1. Theoretical Framework\n\nThe dynamics are governed by the coupled, dimensionless Zakharov equations for the complex Langmuir wave envelope $E(x,t)$ and the real ion density perturbation $n(x,t)$:\n$$\ni \\,\\partial_t E + \\partial_{xx} E = n\\,E\n$$\n$$\n\\partial_{tt} n - c_s^2\\,\\partial_{xx} n = \\partial_{xx} \\left|E\\right|^2\n$$\nHere, $c_s$ represents the dimensionless ion acoustic speed. The system is considered on a periodic domain $x \\in [0,L]$.\n\nModulational instability refers to the exponential growth of small perturbations on a uniform-amplitude (\"pump\") Langmuir wave. To analyze this, we linearize the system around a steady state defined by a constant pump wave amplitude $E=E_0$ and zero ion density perturbation $n=0$. A small perturbation is introduced, and its temporal evolution determines the stability of the system.\n\nThe linear theory growth rate, $\\gamma_{\\mathrm{lin}}$, is found by seeking solutions of the form $\\delta E(x,t) \\propto e^{\\lambda t + i k_0 x}$ and $n(x,t) \\propto e^{\\lambda t + i k_0 x}$. This yields an eigenvalue problem for the growth rate $\\lambda$. As specified in the problem, the linearized dynamics for the Fourier amplitudes of the real and imaginary parts of the perturbation, $u_{k_0}(t)$ and $v_{k_0}(t)$, and the ion density and its time derivative, $n_{k_0}(t)$ and $m_{k_0}(t)$, are described by the matrix system:\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\nu_{k_0} \\\\ v_{k_0} \\\\ n_{k_0} \\\\ m_{k_0}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0  k_0^2  0  0 \\\\\n-k_0^2  0  -E_0  0 \\\\\n0  0  0  1 \\\\\n-2 E_0 k_0^2  0  -c_s^2 k_0^2  0\n\\end{bmatrix}\n\\begin{bmatrix}\nu_{k_0} \\\\ v_{k_0} \\\\ n_{k_0} \\\\ m_{k_0}\n\\end{bmatrix}\n$$\nThe theoretical growth rate $\\gamma_{\\mathrm{lin}}$ is the maximum of the real parts of the eigenvalues of this $4 \\times 4$ matrix, clipped at zero to account for stable or marginally stable cases.\n\n### 2. Numerical Implementation\n\nTo solve the full nonlinear system numerically, we discretize the spatial domain into $N$ grid points and advance the solution in discrete time steps of size $\\Delta t$. The use of periodic boundary conditions makes spectral methods, which are based on the Fourier series, exceptionally accurate and efficient.\n\n#### 2.1. Langmuir Envelope Equation Solver\n\nThe Langmuir equation is a nonlinear Schrödinger-type equation. It is efficiently solved using a Split-Step Fourier Method (SSFM). The equation can be formally written as $\\partial_t E = (\\hat{L} + \\hat{N})E$, where $\\hat{L} = i\\partial_{xx}$ is the linear (dispersive) operator and $\\hat{N} = -in$ is the nonlinear (coupling) operator.\n\nThe SSFM works by splitting the evolution over a time step $\\Delta t$ into a sequence of steps where only the linear or the nonlinear part acts. The linear part is diagonal in Fourier space, while the nonlinear part is diagonal in physical space. A second-order accurate Strang splitting scheme is employed, which symmetrizes the operations:\n1.  **Half Nonlinear Step:** Evolve with $\\hat{N}$ for a time $\\Delta t/2$. In physical space, this is an exact integration:\n    $$E'(x) = E(x, t) \\exp\\left(-i n(x,t) \\frac{\\Delta t}{2}\\right)$$\n2.  **Full Linear Step:** Evolve with $\\hat{L}$ for a full time step $\\Delta t$. This is performed in Fourier space where $\\partial_{xx}$ becomes multiplication by $-k^2$:\n    $$\\hat{E}''(k) = \\mathcal{F}[E'(x)] \\exp\\left(-i k^2 \\Delta t\\right)$$\n    where $\\mathcal{F}$ denotes the Fast Fourier Transform (FFT).\n3.  **Half Nonlinear Step:** Evolve again with $\\hat{N}$ for $\\Delta t/2$.\n    $$E(x, t+\\Delta t) = \\mathcal{F}^{-1}[\\hat{E}''(k)] \\exp\\left(-i n(x,t) \\frac{\\Delta t}{2}\\right)$$\nNote that $n(x,t)$ from the beginning of the time step is used for both nonlinear steps, a standard explicit implementation of the splitting method.\n\n#### 2.2. Ion Density Equation Solver\n\nThe ion density equation is a forced linear wave equation. It is also solved spectrally. In Fourier space, the equation becomes a set of independent ordinary differential equations for each wavenumber $k$:\n$$\n\\partial_{tt} \\hat{n}_{k} + c_s^2 k^2 \\hat{n}_{k} = -k^2 \\hat{S}_{k}\n$$\nwhere $\\hat{S}_{k}(t) = \\mathcal{F}[\\left|E(x,t)\\right|^2]$. This second-order ODE is discretized in time using the second-order accurate leapfrog method:\n$$\n\\frac{\\hat{n}_{k}(t+\\Delta t) - 2\\hat{n}_{k}(t) + \\hat{n}_{k}(t-\\Delta t)}{\\Delta t^2} = - \\left(c_s^2 k^2 \\hat{n}_{k}(t) + k^2 \\hat{S}_{k}(t)\\right)\n$$\nRearranging gives the update rule provided in the problem statement. The leapfrog scheme requires two previous time steps. To initialize it, we use the initial conditions $n(x,0)=0$ and $\\partial_t n(x,0)=0$. From these, we have $\\hat{n}_{k}(0)=0$ and $\\partial_t \\hat{n}_{k}(0)=0$. The value at the fictitious time $t=-\\Delta t$ is found via a second-order Taylor expansion:\n$$\n\\hat{n}_{k}(-\\Delta t) \\approx \\hat{n}_{k}(0) - \\Delta t\\,\\partial_t\\hat{n}_{k}(0) + \\frac{\\Delta t^2}{2}\\partial_{tt}\\hat{n}_{k}(0) = \\frac{\\Delta t^2}{2}\\partial_{tt}\\hat{n}_{k}(0)\n$$\nFrom the governing equation at $t=0$, since $n(x,0)=0$, we have $\\partial_{tt} \\hat{n}_{k}(0) = -k^2 \\hat{S}_{k}(0)$. This gives the required initial value:\n$$\n\\hat{n}_{k}(-\\Delta t) = -\\frac{\\Delta t^2}{2} k^2 \\hat{S}_{k}(0)\n$$\n\nThe overall algorithm proceeds by applying these updates for $E$ and $n$ iteratively in a time-stepping loop.\n\n### 3. Growth Rate Analysis\n\nTo determine the simulated growth rate $\\gamma_{\\text{sim}}$, we monitor the amplitude of the Fourier mode corresponding to the initial perturbation wavenumber, $k_0$. Let this be $A(t) = |\\hat{E}_{k_0}(t)|$. For a linear instability, this amplitude grows exponentially, i.e., $A(t) \\propto e^{\\gamma_{\\text{sim}} t}$. Therefore, $\\ln A(t)$ should grow linearly with time: $\\ln A(t) = \\gamma_{\\text{sim}} t + \\text{const}$.\n\nThe value of $\\gamma_{\\text{sim}}$ is extracted by performing a linear least-squares fit to the data $(\\{t_i\\}, \\{\\ln A(t_i)\\})$ over an initial time interval where the growth is still in the exponential phase and has not yet been affected by nonlinear saturation. The slope of this fit gives the growth rate. The result is clipped at zero, as a negative slope indicates decay or stability, corresponding to a growth rate of zero.\n\nFinally, the absolute difference $\\Delta \\gamma = |\\gamma_{\\text{sim}} - \\gamma_{\\mathrm{lin}}|$ quantifies the agreement between the numerical simulation and the linear theory.",
            "answer": "```python\nimport numpy as np\n\ndef get_linear_growth_rate(E0, cs, k0):\n    \"\"\"\n    Computes the linear theory growth rate for the Zakharov equations.\n    \"\"\"\n    k0_sq = k0**2\n    \n    # Construct the 4x4 matrix from the problem statement\n    matrix = np.array([\n        [0,       k0_sq,         0,                0],\n        [-k0_sq,  0,             -E0,              0],\n        [0,       0,             0,                1],\n        [-2 * E0 * k0_sq, 0,    -cs**2 * k0_sq,    0]\n    ])\n    \n    # Compute eigenvalues\n    eigenvalues = np.linalg.eigvals(matrix)\n    \n    # The growth rate is the maximum of the real parts of the eigenvalues\n    gamma_lin = np.max(np.real(eigenvalues))\n    \n    # Clip at zero for stable cases\n    return max(0, gamma_lin)\n\ndef run_simulation(E0, cs, k0, L, N, dt, T, a0):\n    \"\"\"\n    Runs the 1D Zakharov simulation using a Split-Step Fourier Method.\n    \"\"\"\n    # Spatial grid\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Wavenumber grid for FFT\n    k = np.fft.fftfreq(N, d=L / (2 * np.pi))\n    k_sq = k**2\n    \n    # Time steps\n    num_steps = int(T / dt)\n    time_points = np.linspace(0, T, num_steps + 1)\n    \n    # --- Initial Conditions ---\n    # Langmuir envelope E(x,0)\n    E = E0 * (1.0 + a0 * np.cos(k0 * x))\n    \n    # Ion density n(x,0) = 0 and its Fourier transform\n    n_hat_curr = np.zeros(N, dtype=complex)\n    \n    # Initialization for leapfrog scheme requires n(-dt)\n    # n_hat(-dt) = (dt^2/2) * d^2(n_hat)/dt^2 (t=0)\n    # d^2(n_hat)/dt^2 (t=0) = -k^2 * S_hat(0) where S = |E|^2\n    S0 = np.abs(E)**2\n    S0_hat = np.fft.fft(S0)\n    n_hat_prev = -0.5 * dt**2 * k_sq * S0_hat\n    \n    # FFT propagators\n    linear_propagator = np.exp(-1j * k_sq * dt)\n    \n    # The index corresponding to wavenumber k0\n    k0_idx = int(k0 * L / (2 * np.pi))\n    \n    # Array to store the amplitude of the k0 mode\n    mode_amplitudes = np.zeros(num_steps + 1)\n    \n    # --- Time-stepping loop ---\n    for i in range(num_steps + 1):\n        \n        # Store amplitude of the k0 mode\n        E_hat = np.fft.fft(E)\n        mode_amplitudes[i] = np.abs(E_hat[k0_idx])\n        \n        if i == num_steps:\n            break\n\n        # Get n(t) in real space for the E-step\n        n_t = np.fft.ifft(n_hat_curr).real\n        \n        # --- Update E using Strang splitting SSFM ---\n        # 1. Half nonlinear step\n        nonlinear_propagator_half = np.exp(-1j * n_t * dt / 2.0)\n        E_temp = E * nonlinear_propagator_half\n        \n        # 2. Full linear step in Fourier space\n        E_hat_temp = np.fft.fft(E_temp)\n        E_hat_temp *= linear_propagator\n        E_temp = np.fft.ifft(E_hat_temp)\n        \n        # 3. Half nonlinear step\n        E = E_temp * nonlinear_propagator_half\n\n        # --- Update n using spectral leapfrog ---\n        # The scheme is centered around time t, so we use S(t) = |E(t)|^2\n        # where E(t) is from the beginning of this loop step.\n        # We need S_hat(t) which we already calculated as S0_hat ifi==0, otherwise need recalculation\n        if i == 0:\n            S_hat_t = S0_hat\n        else:\n             # This E is from previous step, i.e., at time t\n             # E_old = np.fft.ifft(E_hat_before_update)\n             S_t = np.abs(np.fft.ifft(E_hat))**2 # Get E(t) from E_hat(t)\n             S_hat_t = np.fft.fft(S_t)\n\n        n_hat_next = (2.0 * n_hat_curr - n_hat_prev -\n                      dt**2 * (cs**2 * k_sq * n_hat_curr + k_sq * S_hat_t))\n        \n        # Cycle the history arrays for n\n        n_hat_prev = n_hat_curr\n        n_hat_curr = n_hat_next\n\n    # --- Analysis ---\n    # Fit ln(A(t)) vs t to find the growth rate\n    # Use first half of the simulation to avoid saturation effects\n    fit_end_idx = num_steps // 2\n    \n    # Avoid log(0)\n    amplitudes_to_fit = mode_amplitudes[1:fit_end_idx]\n    if np.any(amplitudes_to_fit <= 0):\n       return 0.0 # No growth or numerical noise\n    \n    log_amplitudes = np.log(amplitudes_to_fit)\n    times_to_fit = time_points[1:fit_end_idx]\n    \n    # Perform linear regression to get the slope\n    # polyfit returns [slope, intercept]\n    try:\n        slope, _ = np.polyfit(times_to_fit, log_amplitudes, 1)\n    except np.linalg.LinAlgError:\n        slope = 0.0\n\n    # Clip at zero for stable cases\n    gamma_sim = max(0.0, slope)\n    \n    return gamma_sim\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Fixed simulation parameters\n    L = 2 * np.pi\n    N = 256\n    dt = 1e-3\n    T = 1.0\n    m = 1\n    k0 = m * 2 * np.pi / L  # which is 1.0\n    a0 = 1e-4\n\n    test_cases = [\n        (1.0, 0.1),   # unstable\n        (0.3, 0.1),   # near-threshold\n        (0.05, 0.1),  # stable\n    ]\n\n    results = []\n    for E0, cs in test_cases:\n        gamma_lin = get_linear_growth_rate(E0, cs, k0)\n        gamma_sim = run_simulation(E0, cs, k0, L, N, dt, T, a0)\n        delta_gamma = np.abs(gamma_sim - gamma_lin)\n        results.append(delta_gamma)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}