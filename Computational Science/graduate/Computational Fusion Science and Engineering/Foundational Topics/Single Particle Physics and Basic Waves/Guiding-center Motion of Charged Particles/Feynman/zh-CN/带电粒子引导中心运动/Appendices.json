{
    "hands_on_practices": [
        {
            "introduction": "这个实践探讨了磁镜中粒子约束的基本机制。通过从第一性原理推导平行运动方程，您将理解磁场梯度如何形成一个有效势阱，从而导致被俘获粒子的特征“弹跳”运动。本练习旨在巩固您对镜像力、能量守恒和第一绝热不变量这些核心概念的理解。",
            "id": "3987292",
            "problem": "考虑一个质量为 $m$、电荷为 $q$ 的单电荷粒子，在一个静磁场中运动，该磁场的大小 $B(s)$ 仅沿磁力线的弧长坐标 $s$ 变化。假设电场可以忽略，磁场在粒子拉莫尔半径的尺度上变化缓慢，且导心（GC）近似适用。设粒子的磁矩 $\\mu$ 近似不变，其运动被限制在一个对称磁阱中，该磁阱在 $s=0$ 处有最小值 $B(s)$，并在 $s=\\pm s_{m}$ 处有磁镜点，其中 $v_{\\parallel}=0$。\n\n从洛伦兹力定律和磁矩的不变性出发，\n- 推导导心坐标 $s(t)$ 和平行速度 $v_{\\parallel}(t)$ 的有效平行运动方程，该方程需与无电场情况下的能量守恒一致；\n- 接着，通过对 $B(s)$ 在 $s_{m}$ 附近进行关于 $(s-s_{m})$ 的二阶泰勒展开，分析在单个磁镜点 $s=s_{m}$ 附近 $v_{\\parallel}$ 的小振幅行为。仔细确定 $v_{\\parallel}$ 对 $(s-s_{m})$ 的主导阶依赖关系以及在磁镜点附近的相应短时行为 $s(t)$；\n- 最后，假设磁阱底部附近的磁场是二次的，即 $B(s)=B_{0}+\\frac{1}{2}\\kappa s^{2}$，其中 $\\kappa=\\left.\\frac{d^{2}B}{ds^{2}}\\right|_{s=0}>0$。仅使用从您推导的平行运动方程出发的第一性原理推导，证明导心沿 $s$ 的反弹运动在小振幅下是简谐的，并确定角反弹频率的解析表达式。\n\n将最终答案表示为角反弹频率的闭式解析表达式，用 $\\mu$、$m$ 和局部二阶导数 $\\left.\\frac{d^{2}B}{ds^{2}}\\right|_{s=0}$ 表示。角频率的单位为弧度/秒。无需进行数值计算或四舍五入。",
            "solution": "该问题被评估为有效，因为它科学地基于等离子体物理原理，特别是导心理论，并且是良定的、自洽的和客观的。\n\n解答按照题目要求分为三个部分展开。\n\n**第1部分：平行运动方程的推导**\n\n由于磁场不做功且电场可忽略不计，带电粒子的总能量 $E$ 纯粹是动能。能量由下式给出：\n$$E = \\frac{1}{2}m(v_{\\perp}^2 + v_{\\parallel}^2)$$\n其中 $m$ 是粒子质量，$v_{\\perp}$ 是垂直于磁场 $\\vec{B}$ 的速度分量，$v_{\\parallel}$ 是平行于 $\\vec{B}$ 的速度分量。当粒子运动时，$E$ 是一个守恒量。\n\n题目指出磁矩 $\\mu$ 是一个绝热不变量。磁矩定义为：\n$$\\mu = \\frac{m v_{\\perp}^2}{2 B}$$\n其中 $B = |\\vec{B}|$ 是磁场的大小。由于 $\\mu$ 是常数，垂直动能可以表示为 $\\frac{1}{2}m v_{\\perp}^2 = \\mu B(s)$，其中 $B$ 是沿磁力线弧长 $s$ 的函数。\n\n将此代入能量守恒方程，得到：\n$$E = \\mu B(s) + \\frac{1}{2}m v_{\\parallel}^2$$\n这个方程将平行速度 $v_{\\parallel}$ 与粒子沿磁力线的位置 $s$ 联系起来。\n\n为了推导运动方程，我们考虑作用在导心上的力。对于一个在磁场中磁矩为 $\\mu$ 的粒子，存在一个有效力，称为磁镜力，由 $\\vec{F} = -\\mu \\nabla B$ 给出。这个力平行于磁力线的分量 $F_{\\parallel}$ 驱动导心沿 $s$ 运动。沿磁力线的单位矢量是 $\\hat{b} = \\vec{B}/B$。\n$$F_{\\parallel} = \\vec{F} \\cdot \\hat{b} = (-\\mu \\nabla B) \\cdot \\hat{b}$$\n由于给定的磁场大小 $B(s)$ 仅沿弧长坐标 $s$ 变化，其沿磁力线的梯度分量就是对 $s$ 的导数：$(\\nabla B) \\cdot \\hat{b} = \\frac{dB}{ds}$。\n因此，平行力为：\n$$F_{\\parallel} = -\\mu \\frac{dB}{ds}$$\n根据牛顿第二定律，导心沿磁力线的加速度 $a_{\\parallel} = \\frac{d v_{\\parallel}}{dt} = \\frac{d^2s}{dt^2}$ 由 $F_{\\parallel} = m a_{\\parallel}$ 给出。\n这得到了导心坐标 $s(t)$ 的平行运动方程：\n$$m \\frac{d^2s}{dt^2} = -\\mu \\frac{dB}{ds}$$\n这个方程表明，导心的运动就像一个质量为 $m$ 的粒子在有效势 $U_{eff}(s) = \\mu B(s)$ 中运动。这种表述与能量守恒是一致的，可以通过将运动方程乘以 $v_{\\parallel} = \\frac{ds}{dt}$ 来验证：\n$$m \\frac{ds}{dt} \\frac{d^2s}{dt^2} = -\\mu \\frac{dB}{ds} \\frac{ds}{dt}$$\n$$\\frac{d}{dt}\\left(\\frac{1}{2}m\\left(\\frac{ds}{dt}\\right)^2\\right) = -\\mu \\frac{dB}{dt} = \\frac{d}{dt}(-\\mu B(s))$$\n$$\\frac{d}{dt}\\left(\\frac{1}{2}m v_{\\parallel}^2 + \\mu B(s)\\right) = 0$$\n这证实了总能量 $E = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B(s)$ 是守恒的。\n\n**第2部分：磁镜点附近运动的分析**\n\n在磁镜点 $s = s_m$ 处，粒子的平行运动反向，因此 $v_{\\parallel}(s_m)=0$。根据能量守恒方程，总能量由磁镜点的场强决定：\n$$E = \\mu B(s_m)$$\n对于任意位置 $s$，平行速度的平方可以通过重新整理能量方程得到：\n$$\\frac{1}{2}m v_{\\parallel}^2 = E - \\mu B(s) = \\mu B(s_m) - \\mu B(s)$$\n$$v_{\\parallel}^2(s) = \\frac{2\\mu}{m} (B(s_m) - B(s))$$\n为了分析 $s_m$ 附近的行为，我们对 $B(s)$ 在 $s=s_m$ 附近进行泰勒级数展开：\n$$B(s) = B(s_m) + \\left.\\frac{dB}{ds}\\right|_{s_m} (s - s_m) + \\frac{1}{2}\\left.\\frac{d^2B}{ds^2}\\right|_{s_m} (s - s_m)^2 + \\dots$$\n我们记 $B'(s_m) = \\left.\\frac{dB}{ds}\\right|_{s_m}$。为了使粒子被捕获，$B(s)$ 必须在远离 $s=0$ 处的最小值时增加，因此对于 $s_m > 0$，有 $B'(s_m) > 0$。\n将展开式代入 $v_{\\parallel}^2$ 的表达式中：\n$$v_{\\parallel}^2(s) = \\frac{2\\mu}{m} \\left(B(s_m) - \\left[B(s_m) + B'(s_m)(s - s_m) + O((s - s_m)^2)\\right]\\right)$$\n$$v_{\\parallel}^2(s) \\approx -\\frac{2\\mu B'(s_m)}{m} (s - s_m)$$\n粒子从 $s  s_m$（对于 $s_m0$）接近磁镜点，所以 $(s - s_m)  0$。这保证了 $v_{\\parallel}^2 \\ge 0$。平行速度大小对离磁镜点距离 $(s_m - s)$ 的主导阶依赖关系是：\n$$|v_{\\parallel}(s)| \\propto \\sqrt{s_m - s}$$\n为了找到 $s_m$ 附近的 $s(t)$ 的短时行为，设粒子在 $t=t_m$ 时到达磁镜点。当粒子在 $t  t_m$ 时接近磁镜点，其速度为 $v_{\\parallel} = \\frac{ds}{dt} > 0$。我们有：\n$$\\frac{ds}{dt} = \\sqrt{\\frac{2\\mu B'(s_m)}{m}(s_m-s)}$$\n这是一个可分离的微分方程。令 $C = \\sqrt{\\frac{2\\mu B'(s_m)}{m}}$。\n$$\\frac{ds}{\\sqrt{s_m - s}} = C dt$$\n从 $t$ 到 $t_m$（并相应地从 $s(t)$ 到 $s_m$）积分：\n$$\\int_{s(t)}^{s_m} \\frac{du}{\\sqrt{s_m - u}} = \\int_{t}^{t_m} C d\\tau$$\n$$\\left[ -2\\sqrt{s_m - u} \\right]_{s(t)}^{s_m} = C(t_m-t)$$\n$$-2\\sqrt{s_m - s_m} - (-2\\sqrt{s_m-s(t)}) = C(t_m-t)$$\n$$2\\sqrt{s_m - s(t)} = C(t_m-t)$$\n两边平方并求解 $s(t)$：\n$$4(s_m - s(t)) = C^2(t_m-t)^2$$\n$$s(t) = s_m - \\frac{C^2}{4}(t_m-t)^2 = s_m - \\frac{1}{4}\\left(\\frac{2\\mu B'(s_m)}{m}\\right)(t_m-t)^2$$\n$$s(t) = s_m - \\frac{\\mu B'(s_m)}{2m}(t_m-t)^2$$\n这表明在磁镜点附近，位置随相对于反射时间的平方而变化，这是匀加速运动的一个特征。\n\n**第3部分：反弹运动和频率**\n\n在磁阱底部 $s=0$ 附近，磁场近似为一个二次函数：\n$$B(s) = B_0 + \\frac{1}{2}\\kappa s^2$$\n其中 $\\kappa = \\left.\\frac{d^2B}{ds^2}\\right|_{s=0}  0$。\n为了分析在 $s=0$ 附近小振幅的反弹运动，我们使用在第1部分中推导的平行运动方程：\n$$m \\frac{d^2s}{dt^2} = -\\mu \\frac{dB}{ds}$$\n我们首先计算给定磁场分布的导数：\n$$\\frac{dB}{ds} = \\frac{d}{ds} \\left(B_0 + \\frac{1}{2}\\kappa s^2\\right) = \\kappa s$$\n将此代入运动方程：\n$$m \\frac{d^2s}{dt^2} = -\\mu (\\kappa s)$$\n重新整理各项，我们得到：\n$$\\frac{d^2s}{dt^2} + \\left(\\frac{\\mu \\kappa}{m}\\right)s = 0$$\n这是简谐振子方程的典范形式，$\\ddot{x} + \\omega^2 x = 0$。通过将我们的 $s(t)$ 方程与标准形式进行比较，我们可以确定角反弹频率的平方 $\\omega_b^2$：\n$$\\omega_b^2 = \\frac{\\mu \\kappa}{m}$$\n因此，在磁阱中小振幅振荡的角反弹频率是：\n$$\\omega_b = \\sqrt{\\frac{\\mu \\kappa}{m}}$$\n题目要求用 $\\mu$、$m$ 和 $B$ 在 $s=0$ 处的二阶导数来表示这个表达式。代入 $\\kappa = \\left.\\frac{d^2B}{ds^2}\\right|_{s=0}$ 的定义：\n$$\\omega_b = \\sqrt{\\frac{\\mu}{m} \\left.\\frac{d^2B}{ds^2}\\right|_{s=0}}$$\n这就是角反弹频率的最终解析表达式。",
            "answer": "$$\\boxed{\\sqrt{\\frac{\\mu}{m} \\left.\\frac{d^2B}{ds^2}\\right|_{s=0}}}$$"
        },
        {
            "introduction": "在静态磁镜概念的基础上，这个实践引入了时变场的复杂性。您将研究磁场的缓慢变化如何导致粒子在俘获态和通行态之间转换，以及当场的调制频率与粒子的弹跳频率发生共振时，第二绝热不变量（纵向不变量）如何被破坏。本练习深入探讨了绝热理论的适用边界，这是等离子体加热和输运研究中的一个关键课题。",
            "id": "3987319",
            "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子在一个直的、轴对称的磁镜室中运动，其轴上磁场模型为\n$$\nB(s,t) \\;=\\; B_{0}\\,\\bigl[1 + a(t)\\,\\cos(ks)\\bigr],\n$$\n其中 $s$ 是沿磁力线的弧长，$B_{0}0$ 是一个恒定的参考磁场，$k0$ 是一个恒定的空间波数，$a(t)$ 是一个无量纲振幅，由于镜场的可控斜坡变化而随时间缓慢变化，其特征频率远小于典型的回旋频率。假设标准的导心（GC）排序，并且第一绝热不变量（磁矩）$\\mu = m v_{\\perp}^{2}/(2B)$ 在感兴趣的时间尺度上是守恒的。导心的平行运动由单自由度哈密顿量控制\n$$\nH_{\\parallel}(p,s,t) \\;=\\; \\frac{p^{2}}{2m} \\;+\\; \\mu\\,B(s,t),\n$$\n其中 $p$ 是正则平行动量，垂直动力学已通过 $\\mu$ 进行了简化。\n\n1) 仅使用哈密顿量 $H_{\\parallel}$ 和 $a(t)$ 的慢时间依赖性，推导平行运动的分界线（捕获-通行）穿越条件，用粒子相对于磁镜阱底部的平行能量 $E_{\\parallel,\\min}(t)$、磁矩 $\\mu$、参考磁场 $B_{0}$ 和调制振幅 $a(t)$ 来表示。您的推导必须从 $H_{\\parallel}$ 的基本形式和分界线的定义（即连接有效势相邻鞍点的能量等值线）开始。\n\n2) 在单个磁镜阱底部附近，通过对有效势在局域极小值点进行二次展开，将平行运动近似为谐振子。从第一性原理出发，推导小振幅弹跳频率 $\\omega_{b}(a)$ 作为 $a$ 的函数。假设镜场振幅通过与弱周期性调制的共振缓慢斜坡变化，因此在共振时间 $t_{r}$ 的邻域内，可以写成\n$$\na(t) \\;=\\; a_{r} \\;+\\; \\alpha\\,(t - t_{r}),\n$$\n其中常数 $\\alpha$ 满足 $|\\alpha| \\ll \\omega_{b}(a_{r})$，共振条件为 $\\omega_{b}(a_{r}) = \\Omega$，$\\Omega$ 是慢调制频率。使用第二绝热不变量（SAI）守恒的绝热性判据，即 $|(1/\\omega_{b}^{2})\\,d\\omega_{b}/dt| \\ll 1$，通过在 $a=a_{r}$ 处施加临界条件 $|(1/\\omega_{b}^{2})\\,d\\omega_{b}/dt| \\sim 1$ 来估计 SAI 在共振时破缺的阈值斜坡率 $\\alpha_{c}$。将您最终的 $\\alpha_{c}$ 结果表示为仅含 $m$、$k$、$\\mu$、$B_{0}$ 和 $\\Omega$ 的单个闭式解析表达式。如果进行数值计算，$\\alpha_{c}$ 的单位应为秒的倒数 (s$^{-1}$)。不要使用任何快捷公式；从哈密顿量和谐振子近似出发，论证每一步。\n\n您的最终答案必须仅为 $\\alpha_{c}$ 的单个解析表达式。不需要数值计算，最终方框表达式内不应出现单位。",
            "solution": "该问题是适定的，有科学依据，并包含足够的信息以获得唯一解。其物理模型和数学框架在磁约束系统中的导心动力学研究中是标准的。因此，我们可以着手求解。\n\n问题分为两部分。第一部分要求推导分界线穿越条件。第二部分要求推导小振幅弹跳频率，并随后计算第二绝热不变量破缺的临界斜坡率 $\\alpha_c$。\n\n导心的平行运动由哈密顿量描述：\n$$\nH_{\\parallel}(p,s,t) \\;=\\; \\frac{p^{2}}{2m} \\;+\\; \\mu\\,B(s,t)\n$$\n平行运动的有效势能为 $V_{eff}(s,t) = \\mu B(s,t)$。使用给定的磁场形式 $B(s,t) = B_{0}\\,[1 + a(t)\\,\\cos(ks)]$，势为：\n$$\nV_{eff}(s,t) \\;=\\; \\mu B_{0} \\bigl[1 + a(t)\\,\\cos(ks)\\bigr]\n$$\n其中 $m$、$q$、$\\mu$、$B_0$ 和 $k$ 是常数，$a(t)$ 是时间 $t$ 的缓变函数。\n\n**1) 分界线穿越条件的推导**\n\n相空间中的分界线分隔了不同类型的运动，在此情况下是捕获轨道和通行轨道。它对应于有效势 $V_{eff}(s,t)$ 鞍点的能级。为了找到这些点，我们首先通过对势取关于空间坐标 $s$ 的偏导数并将其设为零来找到极值点。\n$$\n\\frac{\\partial V_{eff}}{\\partial s} \\;=\\; \\frac{\\partial}{\\partial s} \\left( \\mu B_{0} \\bigl[1 + a(t)\\,\\cos(ks)\\bigr] \\right) \\;=\\; -\\mu B_{0} a(t) k \\sin(ks)\n$$\n设 $\\frac{\\partial V_{eff}}{\\partial s} = 0$ 得到 $\\sin(ks) = 0$，这意味着对任意整数 $n$，$ks = n\\pi$。\n\n为了对这些极值点进行分类，我们检查关于 $s$ 的二阶偏导数：\n$$\n\\frac{\\partial^2 V_{eff}}{\\partial s^2} \\;=\\; -\\mu B_{0} a(t) k^2 \\cos(ks)\n$$\n假设 $a(t)  0$，这是磁捕获所必需的：\n- 对于偶数 $n=2j$，$ks=2j\\pi$，我们有 $\\cos(ks)=1$。二阶导数为 $\\frac{\\partial^2 V_{eff}}{\\partial s^2} = -\\mu B_{0} a(t) k^2  0$。这些点是局域极大值（鞍点），对应于磁场极大值（“磁镜喉”）。\n- 对于奇数 $n=2j+1$，$ks=(2j+1)\\pi$，我们有 $\\cos(ks)=-1$。二阶导数为 $\\frac{\\partial^2 V_{eff}}{\\partial s^2} = \\mu B_{0} a(t) k^2  0$。这些点是局域极小值（稳定平衡点），对应于磁场极小值（“磁镜阱”）。\n\n势极小值处的能量为：\n$$\nE_{\\parallel,\\min}(t) = V_{eff}\\big|_{ks=(2j+1)\\pi} = \\mu B_{0} \\bigl[1 + a(t)(-1)\\bigr] = \\mu B_{0} \\bigl(1 - a(t)\\bigr)\n$$\n势极大值（鞍点）处的能量定义了分界线能量：\n$$\nE_{sep}(t) = V_{eff}\\big|_{ks=2j\\pi} = \\mu B_{0} \\bigl[1 + a(t)(+1)\\bigr] = \\mu B_{0} \\bigl(1 + a(t)\\bigr)\n$$\n如果粒子的总平行能量 $E_{\\parallel} = H_{\\parallel}$ 小于 $E_{sep}(t)$，则粒子被捕获。如果 $E_{\\parallel}  E_{sep}(t)$，则粒子是通行的。当粒子的能量恰好等于分界线能量时，即 $E_{\\parallel} = E_{sep}(t)$，它将穿越分界线。\n\n问题要求用粒子相对于磁镜阱底部的平行能量来表示该条件，我们将其记为 $\\Delta E_{\\parallel} = E_{\\parallel} - E_{\\parallel,\\min}(t)$。因此，分界线穿越条件是：\n$$\nE_{\\parallel} = E_{sep}(t)\n$$\n题目中的 $E_{\\parallel, \\min}(t)$ 是阱底部的势能，不是粒子的最小平行能量。粒子的平行能量是 $E_\\parallel$。因此，穿越条件为 $E_{\\parallel} = E_{sep}(t)$。如果用相对于阱底的能量来表示，那么粒子的平行能量可以写成 $E_\\parallel = E_{\\parallel,\\min}(t) + E_{k,\\parallel, \\text{bottom}}$。\n$E_{\\parallel,\\min}(t) + E_{k,\\parallel, \\text{bottom}} = E_{sep}(t)$.\n$E_{k,\\parallel, \\text{bottom}} = E_{sep}(t) - E_{\\parallel,\\min}(t) = \\mu B_{0} \\bigl(1 + a(t)\\bigr) - \\mu B_{0} \\bigl(1 - a(t)\\bigr) = 2 \\mu B_{0} a(t)$.\n这表示当粒子在阱底的平行动能等于势垒高度时，它会穿越分界线。\n\n**2) 阈值斜坡率 $\\alpha_c$ 的推导**\n\n首先，我们推导小振幅弹跳频率 $\\omega_b(a)$。我们通过在局域极小值点附近展开势 $V_{eff}(s,t)$，将平行运动近似为谐振子。我们选择极小值点在 $s_0 = \\pi/k$。我们定义从极小值点的位移为 $\\delta s = s - s_0 = s - \\pi/k$。\n则 $ks = k(s_0 + \\delta s) = \\pi + k\\delta s$。使用恒等式 $\\cos(\\pi + x) = -\\cos(x)$，势变为：\n$$\nV_{eff}(\\delta s, t) = \\mu B_{0} \\bigl[1 + a(t)\\cos(\\pi + k\\delta s)\\bigr] = \\mu B_{0} \\bigl[1 - a(t)\\cos(k\\delta s)\\bigr]\n$$\n对于小振幅振荡，即 $|k\\delta s| \\ll 1$，我们使用余弦的泰勒展开：$\\cos(x) \\approx 1 - x^2/2!$。\n$$\nV_{eff}(\\delta s, t) \\approx \\mu B_{0} \\left[1 - a(t)\\left(1 - \\frac{(k\\delta s)^2}{2}\\right)\\right] = \\mu B_{0} \\bigl(1 - a(t)\\bigr) + \\frac{1}{2} \\mu B_{0} a(t) k^2 (\\delta s)^2\n$$\n这是谐振子的势，$V(\\delta s) = V_{min} + \\frac{1}{2}\\mathcal{K}(\\delta s)^2$，其有效弹性系数为 $\\mathcal{K} = \\mu B_{0} a(t) k^2$。\n小振荡的运动方程是 $m \\ddot{(\\delta s)} = -\\mathcal{K} (\\delta s)$，这从关系式 $\\omega_b^2 = \\mathcal{K}/m$ 给出弹跳频率 $\\omega_b$。\n$$\n\\omega_b^2(a) = \\frac{\\mu B_{0} k^2 a(t)}{m} \\implies \\omega_b(a) = k \\sqrt{\\frac{\\mu B_{0} a}{m}}\n$$\n接下来，我们使用给定的第二绝热不变量（SAI）破缺的判据：\n$$\n\\left|\\frac{1}{\\omega_b^2}\\frac{d\\omega_b}{dt}\\right| \\sim 1\n$$\n我们需要计算 $\\frac{d\\omega_b}{dt}$。使用链式法则，$\\frac{d\\omega_b}{dt} = \\frac{d\\omega_b}{da} \\frac{da}{dt}$。\n斜坡模型为 $a(t) = a_r + \\alpha(t - t_r)$，所以 $\\frac{da}{dt} = \\alpha$。\n$\\omega_b$ 对 $a$ 的导数为：\n$$\n\\frac{d\\omega_b}{da} = \\frac{d}{da} \\left( k \\sqrt{\\frac{\\mu B_{0}}{m}} a^{1/2} \\right) = k \\sqrt{\\frac{\\mu B_{0}}{m}} \\left(\\frac{1}{2}a^{-1/2}\\right) = \\frac{k}{2a} \\sqrt{\\frac{\\mu B_{0} a}{m}} = \\frac{\\omega_b}{2a}\n$$\n因此，$\\frac{d\\omega_b}{dt} = \\frac{\\omega_b}{2a} \\alpha$。\n将此代入破缺判据：\n$$\n\\left|\\frac{1}{\\omega_b^2} \\left(\\frac{\\omega_b \\alpha}{2a}\\right)\\right| = \\left|\\frac{\\alpha}{2 a \\omega_b}\\right|\n$$\n破缺阈值 $\\alpha_c$ 是通过在共振点应用临界条件得到的，此时 $a=a_r$ 且 $\\omega_b(a_r) = \\Omega$。我们假设 $\\alpha_c  0$。\n$$\n\\frac{\\alpha_c}{2 a_r \\omega_b(a_r)} = 1 \\implies \\alpha_c = 2 a_r \\Omega\n$$\n最终表达式必须用 $m$、$k$、$\\mu$、$B_0$ 和 $\\Omega$ 表示。我们必须使用共振条件 $\\omega_b(a_r) = \\Omega$ 来消去 $a_r$。\n$$\nk \\sqrt{\\frac{\\mu B_0 a_r}{m}} = \\Omega \\implies k^2 \\frac{\\mu B_0 a_r}{m} = \\Omega^2 \\implies a_r = \\frac{m \\Omega^2}{k^2 \\mu B_0}\n$$\n现在，将这个 $a_r$ 的表达式代入 $\\alpha_c$ 的方程中：\n$$\n\\alpha_c = 2 \\left( \\frac{m \\Omega^2}{k^2 \\mu B_0} \\right) \\Omega\n$$\n$$\n\\alpha_c = \\frac{2 m \\Omega^3}{k^2 \\mu B_0}\n$$\n这是阈值斜坡率 $\\alpha_c$ 的最终解析表达式。",
            "answer": "$$\\boxed{\\frac{2m\\Omega^{3}}{k^{2}\\mu B_{0}}}$$"
        },
        {
            "introduction": "最后一个实践将您从解析理论带到计算应用，这是现代聚变研究中的一项至关重要的技能。您的任务是设计并实现一个用于求解导心运动方程的数值积分器，其方法类似于经典的Boris算法，采用了算子分裂技术。通过测试算法的守恒特性，本练习将帮助您获得关于在复杂磁场中模拟粒子长期行为的挑战和技术的实践见ें解。",
            "id": "3987359",
            "problem": "你需要构建并分析一个数值积分器，用于在计算聚变科学与工程领域中，求解带电粒子在预设静态电磁场中的导心运动。该积分器必须是一个类Boris时间推进格式，通过分离平行运动和漂移运动来适应导心动力学。请从基本、经过充分检验的方程和定义出发推导你的方法；不要依赖任何记忆的最终更新公式。你的任务是实现该算法，并量化其在变化的磁场中对磁矩守恒的误差。\n\n假设一个质量为 $m$、电荷为 $q$ 的非相对论性带电粒子在静态磁场 $\\mathbf{B}(\\mathbf{x})$ 和静态电场 $\\mathbf{E}(\\mathbf{x})$ 中运动。在导心描述中，状态变量是导心位置 $\\mathbf{x}(t)$、平行速度 $v_{\\parallel}(t)$ 和磁矩 $\\mu(t)$。使用以下基本依据：\n\n- 导心速度由下式给出\n$$\n\\frac{d\\mathbf{x}}{dt} = v_{\\parallel}\\,\\hat{\\mathbf{b}} + \\mathbf{v}_{d},\n$$\n其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/\\|\\mathbf{B}\\|$ 是沿磁场方向的单位矢量，$\\mathbf{v}_{d}$ 是垂直于 $\\hat{\\mathbf{b}}$ 的漂移速度之和。\n\n- 对于静态场和缓慢变化的磁场强度，两种标准的漂移是：\n$$\n\\mathbf{v}_{E} = \\frac{\\mathbf{E}\\times\\mathbf{B}}{\\|\\mathbf{B}\\|^{2}}, \\quad\n\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q}\\,\\frac{\\hat{\\mathbf{b}}\\times\\nabla \\|\\mathbf{B}\\|}{\\|\\mathbf{B}\\|^{2}}.\n$$\n\n- 由磁镜力引起的平行加速度为\n$$\n\\frac{dv_{\\parallel}}{dt} = -\\frac{\\mu}{m}\\,\\hat{\\mathbf{b}}\\cdot\\nabla \\|\\mathbf{B}\\|.\n$$\n\n- 在没有时变场和碰撞的情况下，磁矩是一个绝热不变量：\n$$\n\\frac{d\\mu}{dt} = 0,\n$$\n并且总能量守恒：\n$$\n\\mathcal{W} = \\frac{m}{2}\\,v_{\\parallel}^{2} + \\mu \\,\\|\\mathbf{B}\\| = \\text{constant}.\n$$\n\n为导心方程构建一个类Boris积分器，该积分器在一个时间步长 $\\Delta t$ 内将沿 $\\hat{\\mathbf{b}}$ 的平行运动和横场漂移运动分解为独立的子步骤。该格式必须是时间中心和对称的（二阶精度），其精神类似于Boris算法的速度更新分裂，但应用于导心动力学。不要提供或依赖预先存在的更新公式；从给定的基本方程推导它们。你的程序必须使用这种分裂方法在指定的时间间隔内传播 $\\mathbf{x}$ 和 $v_{\\parallel}$，并通过构造保持 $\\mu$ 恒定。然后，为了评估算法在空间变化的磁场中保持磁矩守恒的保真度，使用能量不变量计算最终时刻的有效磁矩，\n$$\n\\mu_{\\mathrm{eff}} = \\frac{\\mathcal{W}_{0} - \\frac{m}{2}\\,v_{\\parallel}(t_{\\mathrm{final}})^{2}}{\\|\\mathbf{B}(\\mathbf{x}(t_{\\mathrm{final}}))\\|},\n$$\n其中 $\\mathcal{W}_{0}$ 是初始能量 $\\mathcal{W}_{0} = \\frac{m}{2}\\,v_{\\parallel}(t_{0})^{2} + \\mu_{0}\\,\\|\\mathbf{B}(\\mathbf{x}(t_{0}))\\|$。将磁矩守恒的相对误差报告为\n$$\n\\epsilon_{\\mu} = \\frac{\\left|\\mu_{\\mathrm{eff}} - \\mu_{0}\\right|}{\\mu_{0}},\n$$\n以十进制数表示。\n\n对测试套件使用以下科学上合理且内部一致的场模型和参数。磁场在各处都沿 $\\hat{\\mathbf{z}}$ 方向，但其大小在 $x$ 和 $z$ 方向上线性变化：\n$$\n\\mathbf{B}(\\mathbf{x}) = B_{0}\\,\\left(1 + \\alpha\\,x + \\beta\\,z\\right)\\,\\hat{\\mathbf{z}},\n$$\n电场为零：\n$$\n\\mathbf{E}(\\mathbf{x}) = \\mathbf{0}.\n$$\n所有量都必须在国际单位制（SI）中处理。在此模型中，单位矢量为 $\\hat{\\mathbf{b}} = \\hat{\\mathbf{z}}$，梯度为 $\\nabla \\|\\mathbf{B}\\| = B_{0}\\,\\left(\\alpha, 0, \\beta\\right)$。\n\n实现你的积分器，并对以下四个测试用例评估 $\\epsilon_{\\mu}$。在每个案例中，于 $\\mathbf{x}_{0} = (x_{0}, y_{0}, z_{0})$，$v_{\\parallel,0}$ 和 $\\mu_{0}$ 进行初始化，然后积分到 $t_{\\mathrm{final}} = N\\,\\Delta t$。对单电荷离子使用给定的常数 $q$ 和 $m$。\n\n- 案例1（均匀磁场，基准）：\n    - $B_{0} = 3.0\\,\\mathrm{T}$，$\\alpha = 0.0\\,\\mathrm{m}^{-1}$，$\\beta = 0.0\\,\\mathrm{m}^{-1}$。\n    - $x_{0} = 0.0\\,\\mathrm{m}$，$y_{0} = 0.0\\,\\mathrm{m}$，$z_{0} = 0.0\\,\\mathrm{m}$。\n    - $v_{\\parallel,0} = 2.0\\times 10^{5}\\,\\mathrm{m/s}$，$\\mu_{0} = 2.8\\times 10^{-18}\\,\\mathrm{J/T}$。\n    - $\\Delta t = 1.0\\times 10^{-8}\\,\\mathrm{s}$，$N = 1000$。\n\n- 案例2（弱 $x$ 梯度，中等时间步长）：\n    - $B_{0} = 3.0\\,\\mathrm{T}$，$\\alpha = 1.0\\,\\mathrm{m}^{-1}$，$\\beta = 0.0\\,\\mathrm{m}^{-1}$。\n    - $x_{0} = 0.0\\,\\mathrm{m}$，$y_{0} = 0.0\\,\\mathrm{m}$，$z_{0} = 0.0\\,\\mathrm{m}$。\n    - $v_{\\parallel,0} = 1.0\\times 10^{5}\\,\\mathrm{m/s}$，$\\mu_{0} = 2.8\\times 10^{-18}\\,\\mathrm{J/T}$。\n    - $\\Delta t = 5.0\\times 10^{-8}\\,\\mathrm{s}$，$N = 2000$。\n\n- 案例3（强 $x$ 梯度，大时间步长，压力测试）：\n    - $B_{0} = 3.0\\,\\mathrm{T}$，$\\alpha = 10.0\\,\\mathrm{m}^{-1}$，$\\beta = 0.0\\,\\mathrm{m}^{-1}$。\n    - $x_{0} = 0.0\\,\\mathrm{m}$，$y_{0} = 0.0\\,\\mathrm{m}$，$z_{0} = 0.0\\,\\mathrm{m}$。\n    - $v_{\\parallel,0} = 1.0\\times 10^{5}\\,\\mathrm{m/s}$，$\\mu_{0} = 2.8\\times 10^{-18}\\,\\mathrm{J/T}$。\n    - $\\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s}$，$N = 1000$。\n\n- 案例4（组合 $x$ 和 $z$ 梯度，磁镜力活跃）：\n    - $B_{0} = 3.0\\,\\mathrm{T}$，$\\alpha = 1.0\\,\\mathrm{m}^{-1}$，$\\beta = 0.01\\,\\mathrm{m}^{-1}$。\n    - $x_{0} = 0.0\\,\\mathrm{m}$，$y_{0} = 0.0\\,\\mathrm{m}$，$z_{0} = 0.0\\,\\mathrm{m}$。\n    - $v_{\\parallel,0} = 1.0\\times 10^{5}\\,\\mathrm{m/s}$，$\\mu_{0} = 2.8\\times 10^{-18}\\,\\mathrm{J/T}$。\n    - $\\Delta t = 1.0\\times 10^{-8}\\,\\mathrm{s}$，$N = 3000$。\n\n使用 $q = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$ 和 $m = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$。所有距离单位必须为 $\\mathrm{m}$，速度单位为 $\\mathrm{m/s}$，时间单位为 $\\mathrm{s}$，磁场单位为 $\\mathrm{T}$，能量相关量单位为 $\\mathrm{J}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的条目是案例1-4的相对误差 $\\epsilon_{\\mu}$，按顺序排列，表示为无单位的十进制数。例如，输出应具有以下形式\n$$\n[\\epsilon_{\\mu,1},\\epsilon_{\\mu,2},\\epsilon_{\\mu,3},\\epsilon_{\\mu,4}].\n$$",
            "solution": "问题陈述要求开发和分析一个用于带电粒子导心运动的数值积分器。该积分器必须基于基本原理和指定的平行运动与垂直（漂移）运动的分裂来构建。要求对算法在保持磁矩 $\\mu$ 守恒方面的保真度进行定量评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **状态变量：** 导心位置 $\\mathbf{x}(t)$，平行速度 $v_{\\parallel}(t)$，磁矩 $\\mu(t)$。\n- **粒子参数：** 质量 $m = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$，电荷 $q = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n- **控制方程：**\n  - 导心速度：$\\frac{d\\mathbf{x}}{dt} = v_{\\parallel}\\,\\hat{\\mathbf{b}} + \\mathbf{v}_{d}$，其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/\\|\\mathbf{B}\\|$。\n  - 漂移速度和 $\\mathbf{v}_d = \\mathbf{v}_E + \\mathbf{v}_{\\nabla B}$。\n  - 电漂移：$\\mathbf{v}_{E} = \\frac{\\mathbf{E}\\times\\mathbf{B}}{\\|\\mathbf{B}\\|^{2}}$。\n  - 梯度B漂移：$\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q}\\,\\frac{\\hat{\\mathbf{b}}\\times\\nabla \\|\\mathbf{B}\\|}{\\|\\mathbf{B}\\|^{2}}$。\n  - 平行加速度：$\\frac{dv_{\\parallel}}{dt} = -\\frac{\\mu}{m}\\,\\hat{\\mathbf{b}}\\cdot\\nabla \\|\\mathbf{B}\\|$。\n- **不变量：**\n  - 磁矩：$\\frac{d\\mu}{dt} = 0$，因此 $\\mu(t) = \\mu_0$ 是一个常数参数。\n  - 能量：$\\mathcal{W} = \\frac{m}{2}\\,v_{\\parallel}^{2} + \\mu \\,\\|\\mathbf{B}\\| = \\text{constant}$。\n- **场模型：**\n  - $\\mathbf{E}(\\mathbf{x}) = \\mathbf{0}$。\n  - $\\mathbf{B}(\\mathbf{x}) = B_{0}\\,\\left(1 + \\alpha\\,x + \\beta\\,z\\right)\\,\\hat{\\mathbf{z}}$。\n- **误差度量：**\n  - 相对误差：$\\epsilon_{\\mu} = \\frac{\\left|\\mu_{\\mathrm{eff}} - \\mu_{0}\\right|}{\\mu_{0}}$。\n  - 有效磁矩：$\\mu_{\\mathrm{eff}} = \\frac{\\mathcal{W}_{0} - \\frac{m}{2}\\,v_{\\parallel}(t_{\\mathrm{final}})^{2}}{\\|\\mathbf{B}(\\mathbf{x}(t_{\\mathrm{final}}))\\|}$。\n  - 初始能量：$\\mathcal{W}_{0} = \\frac{m}{2}\\,v_{\\parallel}(t_{0})^{2} + \\mu_{0}\\,\\|\\mathbf{B}(\\mathbf{x}(t_{0}))\\|$。\n- **测试用例：** 四个案例均已指定所有参数（$B_0, \\alpha, \\beta, \\mathbf{x}_0, v_{\\parallel,0}, \\mu_0, \\Delta t, N$）。\n\n**步骤2：已知条件验证**\n该问题在等离子体物理学中成熟的导心运动理论中有坚实的科学依据。在所述的静态、非相对论性体系的假设下，所提供的方程是标准且正确的。该问题是适定的，提供了一整套常微分方程组、初始条件和物理常数。语言精确客观。使用一个简单但非平凡的磁场模型，可以集中分析数值方法的性质。推导数值格式并测试其守恒特性是计算科学中一项标准且有意义的练习。所选的误差度量利用已知的能量守恒定律来检查影响不变量（$\\mu$）的数值赝象，这是一种有效且有洞察力的技术。该问题是自洽的、一致的且科学上可靠的。\n\n**步骤3：结论**\n该问题是**有效的**。我们可以继续进行求解。\n\n### 算法推导与设计\n\n任务是通过将导心动力学分解为平行运动和漂移运动，来构建一个类Boris、时间中心、对称的积分器。这建议使用Strang分裂法，这是一种从低阶格式构造二阶精度格式的通用技术。\n\n系统的状态是数对 $(\\mathbf{x}, v_{\\parallel})$。运动方程为：\n$$\n\\frac{d\\mathbf{x}}{dt} = v_{\\parallel}(t)\\,\\hat{\\mathbf{b}}(\\mathbf{x}) + \\mathbf{v}_{d}(\\mathbf{x})\n$$\n$$\n\\frac{dv_{\\parallel}}{dt} = -\\frac{\\mu}{m}\\,\\hat{\\mathbf{b}}(\\mathbf{x})\\cdot\\nabla \\|\\mathbf{B}(\\mathbf{x})\\|\n$$\n\n我们将演化分为两部分：\n1.  **平行运动（算子 $\\mathcal{P}$）：** 这部分包括沿磁力线的运动和平行加速度。\n    $$\n    \\frac{d\\mathbf{x}}{dt} = v_{\\parallel}\\,\\hat{\\mathbf{b}}(\\mathbf{x}), \\quad \\frac{dv_{\\parallel}}{dt} = -\\frac{\\mu}{m}\\,\\hat{\\mathbf{b}}(\\mathbf{x})\\cdot\\nabla \\|\\mathbf{B}(\\mathbf{x})\\|\n    $$\n2.  **漂移运动（算子 $\\mathcal{D}$）：** 这部分描述横场漂移。\n    $$\n    \\frac{d\\mathbf{x}}{dt} = \\mathbf{v}_{d}(\\mathbf{x}), \\quad \\frac{dv_{\\parallel}}{dt} = 0\n    $$\n\n一个用于将状态从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$ 的二阶对称Strang分裂格式构造如下：\n$$\n(\\mathbf{x}_{n+1}, v_{\\parallel, n+1}) = \\Phi_{\\mathcal{D}}^{\\Delta t/2} \\circ \\Phi_{\\mathcal{P}}^{\\Delta t} \\circ \\Phi_{\\mathcal{D}}^{\\Delta t/2} (\\mathbf{x}_n, v_{\\parallel, n})\n$$\n其中 $\\Phi^{\\delta t}$ 表示时间步长为 $\\delta t$ 的流算子。现在我们需要为这些算子定义数值近似。\n\n**特定场模型的分析：**\n对于给定的场，$\\mathbf{E}=\\mathbf{0}$，$\\mathbf{B}(\\mathbf{x}) = B_{0}\\,(1 + \\alpha\\,x + \\beta\\,z)\\,\\hat{\\mathbf{z}}$，我们有：\n- 磁场单位矢量是恒定的：$\\hat{\\mathbf{b}} = \\hat{\\mathbf{z}}$。\n- 磁场大小为 $\\|\\mathbf{B}\\| = B_0(1+\\alpha x + \\beta z)$。\n- 磁场大小的梯度是恒定的：$\\nabla\\|\\mathbf{B}\\| = B_0(\\alpha, 0, \\beta)$。\n- 平行加速度是恒定的：$A_{\\parallel} = -\\frac{\\mu_0}{m}\\,\\hat{\\mathbf{z}}\\cdot (B_0(\\alpha, 0, \\beta)) = -\\frac{\\mu_0 B_0 \\beta}{m}$。\n- 唯一非零的漂移是 $\\nabla B$ 漂移，因为 $\\mathbf{v}_E=0$：\n$$\n\\mathbf{v}_d = \\mathbf{v}_{\\nabla B} = \\frac{\\mu_0}{q} \\frac{\\hat{\\mathbf{z}} \\times B_0(\\alpha, 0, \\beta)}{B_0^2(1+\\alpha x + \\beta z)^2} = \\frac{\\mu_0 \\alpha}{q B_0 (1+\\alpha x + \\beta z)^2} \\hat{\\mathbf{y}}\n$$\n漂移速度纯粹在 $\\hat{\\mathbf{y}}$ 方向上，并取决于位置坐标 $x$ 和 $z$。\n\n**算子的离散化：**\n基于这些简化，我们设计数值步骤：\n\n1.  **算子 $\\Phi_{\\mathcal{D}}^{\\delta t}$（漂移步）：** 我们求解 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{v}_d(\\mathbf{x})$。一个简单的显式欧拉步是 $\\mathbf{x}(t+\\delta t) = \\mathbf{x}(t) + \\mathbf{v}_d(\\mathbf{x}(t)) \\delta t$。这是一阶的，但Strang分裂中的对称组合恢复了二阶精度。\n\n2.  **算子 $\\Phi_{\\mathcal{P}}^{\\Delta t}$（平行步）：** 系统是 $\\frac{dv_{\\parallel}}{dt} = A_{\\parallel}$ 和 $\\frac{d\\mathbf{x}}{dt} = v_{\\parallel}\\hat{\\mathbf{z}}$。由于 $A_{\\parallel}$ 是常数，我们可以在区间 $\\Delta t$ 上精确积分该系统。这可以用一个标准的Verlet或时间中心格式来实现：\n    $$ z(t+\\Delta t) = z(t) + \\left(v_{\\parallel}(t) + \\frac{A_{\\parallel}\\Delta t}{2}\\right) \\Delta t $$\n    $$ v_{\\parallel}(t+\\Delta t) = v_{\\parallel}(t) + A_{\\parallel}\\Delta t $$\n\n**完整的更新算法：**\n为了在一个时间步长 $\\Delta t$ 内将状态 $(\\mathbf{x}_n, v_{\\parallel,n})$ 推进到 $(\\mathbf{x}_{n+1}, v_{\\parallel,n+1})$，我们执行以下序列：\n\n1.  **第一个漂移半步 $(\\Phi_{\\mathcal{D}}^{\\Delta t/2})$：**\n    - 在初始位置计算漂移速度：$\\mathbf{v}_{d,n} = \\mathbf{v}_d(\\mathbf{x}_n)$。\n    - 将位置更新到中间状态 $\\mathbf{x}'$：\n      $$ \\mathbf{x}' = \\mathbf{x}_n + \\mathbf{v}_{d,n} \\frac{\\Delta t}{2} $$\n\n2.  **完整的平行步 $(\\Phi_{\\mathcal{P}}^{\\Delta t})$：**\n    - 使用时间中心的平行速度将位置从 $\\mathbf{x}'$ 更新到第二个中间状态 $\\mathbf{x}''$：\n      $$ \\mathbf{x}'' = \\mathbf{x}' + \\left(v_{\\parallel,n} + \\frac{A_{\\parallel}\\Delta t}{2}\\right) \\hat{\\mathbf{z}} \\Delta t $$\n    - 更新整个时间步长的平行速度：\n      $$ v_{\\parallel,n+1} = v_{\\parallel,n} + A_{\\parallel} \\Delta t $$\n\n3.  **第二个漂移半步 $(\\Phi_{\\mathcal{D}}^{\\Delta t/2})$：**\n    - 在第二个中间位置 $\\mathbf{x}''$ 计算漂移速度：$\\mathbf{v}_{d,n+1} = \\mathbf{v}_d(\\mathbf{x}'')$。\n    - 将位置更新到其最终状态 $\\mathbf{x}_{n+1}$：\n      $$ \\mathbf{x}_{n+1} = \\mathbf{x}'' + \\mathbf{v}_{d,n+1} \\frac{\\Delta t}{2} $$\n\n**误差分析：**\n对于给定的场模型和初始条件 $x_0=0$，导心运动方程为 $\\dot{x}=0, \\dot{y}=v_d(z), \\dot{z}=v_\\parallel$。由于 $\\dot{x}=0$, $x(t)$ 始终为0。因此，磁场大小 $\\|\\mathbf{B}\\| = B_0(1+\\beta z)$ 和漂移速度 $v_d = \\frac{\\mu_0 \\alpha}{q B_0(1+\\beta z)^2}$ 实际上不依赖于 $\\alpha$ 或 $x$。平行加速度 $A_\\parallel = -\\frac{\\mu_0 B_0 \\beta}{m}$ 是常数。\n在此简化下，平行运动的数值积分（Velocity-Verlet）是精确的。漂移运动的数值积分只影响 $y$ 坐标。然而，能量和 $\\mu_\\mathrm{eff}$ 的计算仅依赖于 $v_\\parallel$ 和 $z$。由于 $v_\\parallel(t)$ 和 $z(t)$ 被精确积分，数值能量应该被精确守恒。因此，计算出的误差 $\\epsilon_\\mu$ 理论上应为零（或在机器精度范围内）。原始问题中提供的代码和其非零结果是错误的。正确的实现应反映出零误差。",
            "answer": "[0.0000000000,0.0000000000,0.0000000000,0.0000000000]"
        }
    ]
}