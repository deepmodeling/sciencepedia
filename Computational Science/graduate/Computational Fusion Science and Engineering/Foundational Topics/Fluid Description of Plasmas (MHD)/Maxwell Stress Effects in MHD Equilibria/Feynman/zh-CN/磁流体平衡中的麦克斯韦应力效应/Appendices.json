{
    "hands_on_practices": [
        {
            "introduction": "麦克斯韦应力在磁流体动力学（MHD）平衡中最直接的体现，就是磁压力与等离子体压力之间的抗衡。本练习在一个圆柱形的$\\theta$-箍缩（theta-pinch）位形中，清晰地、解析地审视了这种基本平衡关系，这是一个基础的模型系统。在处理更复杂的几何构型之前，掌握这个核心概念是至关重要的第一步。",
            "id": "4009453",
            "problem": "考虑一个在柱形几何中，于 θ-箍缩位形下经历准静态压缩的理想、完全电离的等离子体柱。假设轴对称且无流动，因此等离子体处于稳态平衡。磁场是纯轴向的，并依赖于半径 $B_{z}(r)$，没有 $z$ 方向的依赖性，也没有方位角分量。等离子体占据 $0 \\leq r \\leq a$ 的区域。\n\n从平衡状态下的磁流体动力学（MHD）动量方程出发，并引用电磁力的 Maxwell 应力表述，推导所需的径向压力梯度 $dp/dr$ 的表达式，该梯度在压缩过程中平衡由空间变化的轴向场 $B_{z}(r)$ 产生的径向磁力。\n\n然后，对于特定的轴向场分布\n$$\nB_{z}(r) = B_{0}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)^{\\alpha}, \\quad 0 \\leq r \\leq a,\n$$\n其中 $B_{0} > 0$，$a > 0$ 且 $\\alpha > 0$，计算径向压力梯度 $dp/dr$ 作为 $r$、$B_{0}$、$a$ 和 $\\alpha$ 的函数的解析表达式。\n\n请用国际单位制（SI）中的帕斯卡/米（Pascals per meter）来表示你的最终答案。不需要进行数值计算或四舍五入；请提供一个封闭形式的表达式。",
            "solution": "物理背景是一个 θ-箍缩压缩，其中磁场是轴向的，并随半径 $B_{z}(r)$ 变化。我们考虑一个无流动的稳态、轴对称状态。用于此推导的恰当基本定律是平衡状态的磁流体动力学（MHD）动量方程和磁力的 Maxwell 应力张量表示。\n\n平衡状态（无流动，无时间依赖性）下的 MHD 动量方程为\n$$\n\\boldsymbol{0} = -\\nabla p + \\boldsymbol{J} \\times \\boldsymbol{B},\n$$\n其中 $p$ 是标量等离子体压力，$\\boldsymbol{J}$ 是电流密度，$\\boldsymbol{B}$ 是磁场。这也可以通过 Maxwell 应力张量 $\\boldsymbol{T}$ 表示为\n$$\n\\nabla \\cdot \\boldsymbol{T} = \\frac{1}{\\mu_{0}} (\\nabla \\times \\boldsymbol{B}) \\times \\boldsymbol{B},\n$$\n其中 Maxwell 应力张量定义为\n$$\n\\boldsymbol{T} = \\frac{1}{\\mu_{0}} \\left( \\boldsymbol{B}\\boldsymbol{B} - \\frac{1}{2} B^{2} \\boldsymbol{I} \\right),\n$$\n其中 $\\mu_{0}$ 是真空磁导率，$B^{2} = \\boldsymbol{B} \\cdot \\boldsymbol{B}$，$\\boldsymbol{I}$ 是单位张量。在平衡状态下，总应力（流体加电磁）必须是无散的：\n$$\n\\nabla \\cdot (p \\boldsymbol{I} + \\boldsymbol{T}) = \\boldsymbol{0}.\n$$\n\n我们通过考虑 MHD 力平衡的径向分量来推导径向压力梯度。对于给定的几何结构，磁场为 $\\boldsymbol{B} = B_{z}(r) \\,\\hat{\\boldsymbol{z}}$，没有 $z$ 依赖性，也没有方位角或径向分量。电流密度可由（静磁学中的）Ampère 定律得出，\n$$\n\\nabla \\times \\boldsymbol{B} = \\mu_{0} \\boldsymbol{J}.\n$$\n在柱坐标系 $(r,\\theta,z)$ 中，对于 $\\boldsymbol{B} = B_{z}(r)\\,\\hat{\\boldsymbol{z}}$，$\\nabla \\times \\boldsymbol{B}$ 唯一非零的分量是方位角分量，\n$$\n(\\nabla \\times \\boldsymbol{B})_{\\theta} = -\\frac{d B_{z}(r)}{d r}.\n$$\n因此，\n$$\nJ_{\\theta}(r) = -\\frac{1}{\\mu_{0}} \\frac{d B_{z}}{d r}.\n$$\nLorentz 力密度为 $\\boldsymbol{f} = \\boldsymbol{J} \\times \\boldsymbol{B}$。其径向分量为\n$$\nf_{r} = J_{\\theta} B_{z} = -\\frac{1}{\\mu_{0}} B_{z} \\frac{d B_{z}}{d r}.\n$$\n在平衡状态下，$-\\nabla p + \\boldsymbol{J} \\times \\boldsymbol{B} = \\boldsymbol{0}$ 的径向分量给出\n$$\n-\\frac{d p}{d r} + f_{r} = 0 \\quad \\Rightarrow \\quad \\frac{d p}{d r} = f_{r} = -\\frac{1}{\\mu_{0}} B_{z} \\frac{d B_{z}}{d r}.\n$$\n注意到\n$$\n\\frac{d}{d r} \\left( \\frac{B_{z}^{2}}{2 \\mu_{0}} \\right) = \\frac{1}{\\mu_{0}} B_{z} \\frac{d B_{z}}{d r},\n$$\n我们也可以写成\n$$\n\\frac{d p}{d r} = -\\frac{d}{d r} \\left( \\frac{B_{z}^{2}}{2 \\mu_{0}} \\right).\n$$\n这与 Maxwell 应力描述一致，其中径向磁力密度是磁压力的负梯度，并且对于纯轴向场，沿场线方向曲率没有变化，磁张力对径向分量没有贡献。\n\n我们现在对给定的分布计算径向压力梯度，\n$$\nB_{z}(r) = B_{0} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{\\alpha}, \\quad 0 \\leq r \\leq a,\n$$\n其中 $B_{0} > 0$，$a > 0$ 且 $\\alpha > 0$。首先计算 $B_{z}^{2}(r)$：\n$$\nB_{z}^{2}(r) = B_{0}^{2} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha}.\n$$\n那么磁压力为\n$$\np_{m}(r) = \\frac{B_{z}^{2}(r)}{2 \\mu_{0}} = \\frac{B_{0}^{2}}{2 \\mu_{0}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha}.\n$$\n对 $r$ 求导：\n$$\n\\frac{d p_{m}}{d r} = \\frac{B_{0}^{2}}{2 \\mu_{0}} \\cdot 2\\alpha \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1} \\cdot \\frac{d}{d r} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right).\n$$\n因为\n$$\n\\frac{d}{d r} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right) = -\\frac{2 r}{a^{2}},\n$$\n我们得到\n$$\n\\frac{d p_{m}}{d r} = \\frac{B_{0}^{2}}{2 \\mu_{0}} \\cdot 2\\alpha \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1} \\cdot \\left( -\\frac{2 r}{a^{2}} \\right) = -\\frac{2 \\alpha B_{0}^{2}}{\\mu_{0}} \\frac{r}{a^{2}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1}.\n$$\n因此，平衡条件\n$$\n\\frac{d p}{d r} = -\\frac{d p_{m}}{d r}\n$$\n给出\n$$\n\\frac{d p}{d r} = \\frac{2 \\alpha B_{0}^{2}}{\\mu_{0}} \\frac{r}{a^{2}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1}.\n$$\n\n这个表达式是在压缩过程中平衡轴向场磁压力梯度所需的径向压力梯度。当 $\\alpha > 0$ 时，对于 $0  r  a$，该表达式为正，这意味着等离子体压力必须向外增加，以补偿该特定分布下减小的磁压力。该表达式采用国际单位制（SI），其中 $\\mu_{0}$ 的单位是 $\\mathrm{N/A^{2}}$，$B_{0}$ 的单位是 $\\mathrm{T}$，$r$ 和 $a$ 的单位是 $\\mathrm{m}$，最终得到 $dp/dr$ 的单位为所要求的帕斯卡/米。",
            "answer": "$$\\boxed{\\frac{2 \\alpha B_{0}^{2}}{\\mu_{0}} \\frac{r}{a^{2}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1}}$$"
        },
        {
            "introduction": "在磁压力概念的基础上，本练习将探讨复杂几何形状如何影响力的平衡。通过分析一个简化的托卡马克模型，你将推导出磁力如何因环向曲率而在极向（poloidal）方向上变化，这是聚变装置的一个关键特征。这项练习强调了麦克斯韦应力的各向异性及其在决定等离子体形状和稳定性方面的重要性。",
            "id": "4009480",
            "problem": "考虑一个轴对称、大环径比、圆形截面的托卡马克平衡，其小半径为 $a$，大半径为 $R_{0}$。设极向角为 $\\theta$，从外侧中平面量起，因此等离子体边界处的几何大半径为 $R(\\theta)=R_{0}+a\\cos\\theta$。环向磁场由外部线圈产生，并遵循环向磁通守恒，因此边界上的环向场为 $B_{\\phi}(\\theta)$，且 $B_{\\phi}(\\theta)\\propto 1/R(\\theta)$。边缘安全因子 $q_{a}$ 假定在边界上为常数，并由圆形截面轴对称平衡中的标准关系式 $q = r B_{\\phi}/(R B_{\\theta})$ 定义，其中 $B_{\\theta}$ 是极向磁场，$r$ 是小半径。假设为理想磁流体动力学（MHD），因此磁场与平衡边界相切，在 $r=a$ 处没有法向分量。\n\n你将分析麦克斯韦应力对平衡边界的影响。从麦克斯韦应力概念的静磁形式和表面牵引力矢量的定义开始。仅使用基本原理和给定的几何与平衡假设，推导由磁场产生的等离子体边界上的无量纲法向牵引力分布。用 $B_{0}^{2}/\\mu_{0}$ 对麦克斯韦应力张量进行归一化，其中 $B_{0}$ 是在大半径 $R_{0}$ 处的环向磁场，以使你的最终表达式为无量纲。将你的最终答案表示为关于 $R_{0}$、$a$、$q_{a}$ 和 $\\theta$ 的单个闭合形式解析表达式 $\\tau_{n}(\\theta)$。不要引入除指定参数外的任何其他参数。最终答案必须是单个符号表达式；不需要进行数值评估，最终答案中也不应包含单位。",
            "solution": "首先验证问题，以确保其科学上合理、良定且客观。\n\n### 步骤 1：提取已知条件\n-   系统：轴对称、大环径比的托卡马克平衡。\n-   几何形状：圆形截面，小半径为 $a$，大半径为 $R_{0}$。\n-   坐标：极向角 $\\theta$ 从外侧中平面量起。\n-   边界大半径：等离子体边界处的大半径为 $R(\\theta) = R_{0} + a\\cos\\theta$。\n-   环向场：$B_{\\phi}$ 由外部线圈产生，且遵循 $B_{\\phi}(\\theta) \\propto 1/R(\\theta)$。在大半径 $R_0$ 处的场为 $B_0$。\n-   边缘安全因子：$q_{a}$ 在边界 $r=a$ 上为常数。\n-   安全因子定义：$q = r B_{\\phi}/(R B_{\\theta})$，其中 $B_{\\theta}$ 是极向磁场。\n-   MHD模型：理想磁流体动力学（MHD）。\n-   边界条件：磁场 $\\mathbf{B}$ 与平衡边界相切，意味着在 $r=a$ 处没有法向分量。\n-   任务：推导等离子体边界上的无量纲法向牵引力分布 $\\tau_{n}(\\theta)$。\n-   归一化：麦克斯韦应力张量需用 $B_{0}^{2}/\\mu_{0}$ 进行归一化。\n-   输出：关于 $R_{0}$、$a$、$q_{a}$ 和 $\\theta$ 的单个闭合形式解析表达式 $\\tau_{n}(\\theta)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。它使用了一个在聚变等离子体物理学中常见的、虽然简化了的托卡马克平衡模型。所有概念，如麦克斯韦应力张量、理想MHD、安全因子 $q$ 以及磁场拓扑结构（$B_{\\phi}$ 的 $1/R$ 标度），都是该领域的基本原理。该问题是良定的，提供了足够的信息和清晰的定义来推导出一个唯一的解。语言客观且专业。没有矛盾、关键信息缺失或科学上不合理的假设。因此，该问题被认定为有效。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、附有推理过程的解答。\n\n### 解答推导\n由电磁场施加在具有向外单位法向量 $\\mathbf{\\hat{n}}$ 的表面上的单位面积力，即牵引力矢量 $\\mathbf{t}$，由麦克斯韦应力张量 $\\mathbf{T}$ 与 $\\mathbf{\\hat{n}}$ 的缩并给出。静磁麦克斯韦应力张量为：\n$$\n\\mathbf{T} = \\frac{1}{\\mu_0} \\left( \\mathbf{B} \\mathbf{B} - \\frac{1}{2} \\mathbf{I} B^2 \\right)\n$$\n其中 $\\mathbf{B}$ 是磁场矢量，$B^2 = \\mathbf{B} \\cdot \\mathbf{B}$ 是磁场大小的平方，$\\mathbf{I}$ 是单位张量。用张量指标表示法，即为 $T_{ij} = \\frac{1}{\\mu_0} \\left( B_i B_j - \\frac{1}{2} \\delta_{ij} B^2 \\right)$。\n\n表面上的牵引力矢量 $\\mathbf{t}$ 则为：\n$$\n\\mathbf{t} = \\mathbf{T} \\cdot \\mathbf{\\hat{n}} = \\frac{1}{\\mu_0} \\left[ (\\mathbf{B} \\cdot \\mathbf{\\hat{n}})\\mathbf{B} - \\frac{1}{2} B^2 \\mathbf{\\hat{n}} \\right]\n$$\n问题陈述磁场与平衡边界相切。这意味着磁场的法向分量为零，即 $\\mathbf{B} \\cdot \\mathbf{\\hat{n}} = 0$。在此条件下，牵引力矢量简化为：\n$$\n\\mathbf{t} = - \\frac{B^2}{2\\mu_0} \\mathbf{\\hat{n}}\n$$\n此表达式代表一个垂直向内作用于表面的压力，称为磁压力。法向牵引力 $\\tau_n$ 是牵引力矢量在法向量 $\\mathbf{\\hat{n}}$ 方向上的标量分量：\n$$\n\\tau_{n,\\text{dim}} = \\mathbf{t} \\cdot \\mathbf{\\hat{n}} = \\left( - \\frac{B^2}{2\\mu_0} \\mathbf{\\hat{n}} \\right) \\cdot \\mathbf{\\hat{n}} = - \\frac{B^2}{2\\mu_0}\n$$\n问题要求无量纲的法向牵引力 $\\tau_n(\\theta)$。麦克斯韦应力张量需用 $B_{0}^{2}/\\mu_{0}$ 进行归一化。无量纲应力张量为 $\\mathbf{T}_{\\text{norm}} = \\mathbf{T} / (B_0^2/\\mu_0)$。因此，无量纲牵引力矢量为 $\\mathbf{t}_{\\text{norm}} = \\mathbf{t} / (B_0^2/\\mu_0)$。所以无量纲法向牵引力为：\n$$\n\\tau_n = \\frac{\\tau_{n,\\text{dim}}}{B_0^2/\\mu_0} \\quad \\text{这在量纲上不一致。一个更好的解释是：} \\quad \\tau_n = \\mathbf{t}_{\\text{norm}} \\cdot \\mathbf{\\hat{n}}\n$$\n我们遵循后一种更严谨的定义：\n$$\n\\mathbf{t}_{\\text{norm}} = \\frac{\\mathbf{t}}{B_0^2/\\mu_0} = \\frac{- \\frac{B^2}{2\\mu_0} \\mathbf{\\hat{n}}}{B_0^2/\\mu_0} = -\\frac{B^2}{2B_0^2} \\mathbf{\\hat{n}}\n$$\n$$\n\\tau_n(\\theta) = \\mathbf{t}_{\\text{norm}} \\cdot \\mathbf{\\hat{n}} = -\\frac{B^2(\\theta)}{2B_0^2}\n$$\n为了求出 $\\tau_n(\\theta)$，我们必须确定边界上的磁场强度 $B^2(\\theta)$。磁场有环向 ($\\phi$) 和极向 ($\\theta$) 分量，因此 $\\mathbf{B} = B_{\\phi}\\mathbf{\\hat{e}}_{\\phi} + B_{\\theta}\\mathbf{\\hat{e}}_{\\theta}$。其大小的平方为 $B^2 = B_{\\phi}^2 + B_{\\theta}^2$。\n\n首先，我们求环向场 $B_{\\phi}(\\theta)$。已知 $B_{\\phi} \\propto 1/R$ 且在大半径 $R_0$ 处的场为 $B_0$。这意味着 $B_{\\phi}(R) R = B_0 R_0$。在等离子体边界处，大半径为 $R(\\theta) = R_0 + a\\cos\\theta$。因此，边界上的环向场为：\n$$\nB_{\\phi}(\\theta) = \\frac{B_0 R_0}{R(\\theta)} = \\frac{B_0 R_0}{R_0 + a\\cos\\theta}\n$$\n接下来，我们使用边缘安全因子 $q_a$ 的定义来求解极向场 $B_{\\theta}(\\theta)$。在边界 $r=a$ 处：\n$$\nq_a = \\frac{a B_{\\phi}(\\theta)}{R(\\theta) B_{\\theta}(\\theta)}\n$$\n求解 $B_{\\theta}(\\theta)$：\n$$\nB_{\\theta}(\\theta) = \\frac{a B_{\\phi}(\\theta)}{q_a R(\\theta)}\n$$\n代入 $B_{\\phi}(\\theta)$ 的表达式：\n$$\nB_{\\theta}(\\theta) = \\frac{a}{q_a R(\\theta)} \\left( \\frac{B_0 R_0}{R(\\theta)} \\right) = \\frac{a B_0 R_0}{q_a R(\\theta)^2} = \\frac{a B_0 R_0}{q_a (R_0 + a\\cos\\theta)^2}\n$$\n现在我们可以计算总磁场强度的平方 $B^2(\\theta)$：\n$$\nB^2(\\theta) = B_{\\phi}(\\theta)^2 + B_{\\theta}(\\theta)^2 = \\left( \\frac{B_0 R_0}{R_0 + a\\cos\\theta} \\right)^2 + \\left( \\frac{a B_0 R_0}{q_a (R_0 + a\\cos\\theta)^2} \\right)^2\n$$\n$$\nB^2(\\theta) = \\frac{B_0^2 R_0^2}{(R_0 + a\\cos\\theta)^2} + \\frac{a^2 B_0^2 R_0^2}{q_a^2 (R_0 + a\\cos\\theta)^4}\n$$\n我们可以提出公因子：\n$$\nB^2(\\theta) = \\frac{B_0^2 R_0^2}{(R_0 + a\\cos\\theta)^2} \\left[ 1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2} \\right]\n$$\n最后，我们将 $B^2(\\theta)$ 的这个表达式代入无量纲法向牵引力 $\\tau_n(\\theta)$ 的公式中：\n$$\n\\tau_n(\\theta) = -\\frac{B^2(\\theta)}{2B_0^2} = -\\frac{1}{2B_0^2} \\left( \\frac{B_0^2 R_0^2}{(R_0 + a\\cos\\theta)^2} \\left[ 1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2} \\right] \\right)\n$$\n通过消去 $B_0^2$ 项进行简化，我们得到无量纲法向牵引力分布的最终表达式：\n$$\n\\tau_n(\\theta) = -\\frac{R_0^2}{2(R_0 + a\\cos\\theta)^2} \\left( 1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2} \\right)\n$$\n这就是关于指定参数 $R_0$、$a$、$q_a$ 和 $\\theta$ 的 $\\tau_n(\\theta)$ 的单个闭合形式解析表达式。负号证实了该牵引力是一个指向等离子体内部的压力。",
            "answer": "$$\n\\boxed{-\\frac{R_0^2}{2(R_0 + a\\cos\\theta)^2} \\left(1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2}\\right)}\n$$"
        },
        {
            "introduction": "真实的聚变等离子体具有复杂的、非解析的几何形状，这使得纯粹的解析计算变得不切实际。本练习将理论与实际应用联系起来，指导你完成对一个成形环状表面上磁力的数值计算。通过实现一个表面积分方案并比较不同网格分辨率下的结果，你将获得现代聚变模拟中所用方法的实践经验，并体会到确保数值准确性所面临的挑战。",
            "id": "4009436",
            "problem": "您必须编写一个完整且可运行的程序，用于计算离散化环形磁通面上由磁麦克斯韦应力张量产生的面积平均法向牵引力，并将此粗网格估算值与高分辨率表面求积结果进行比较。物理背景是磁流体力学（Magnetohydrodynamics, MHD），重点是麦克斯韦应力在MHD平衡中的效应。该程序必须是自包含的，使用国际单位制（SI），并以纯数学和逻辑格式生成结果，同时指明单位和输出格式。\n\n起点和定义：\n- 在静磁学中，麦克斯韦应力张量定义为 $$T_{ij} = \\frac{1}{\\mu_0} \\left( B_i B_j - \\frac{1}{2} \\delta_{ij} B^2 \\right),$$ 其中 $\\mu_0$ 是自由空间磁导率，$\\delta_{ij}$ 是克罗内克δ函数，$\\mathbf{B}$ 是磁场矢量。\n- 由于磁场在单位法向量为 $\\mathbf{n}$ 的表面上产生的标量法向牵引力（类压力的法向应力）为 $$\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} = \\frac{1}{\\mu_0} \\left( (\\mathbf{B}\\cdot \\mathbf{n})^2 - \\frac{1}{2} \\mathbf{B}^2 \\right)。$$\n- 在闭合曲面 $\\mathcal{S}$ 上的面积平均法向牵引力为 $$\\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle = \\frac{1}{A} \\int_{\\mathcal{S}} \\left(\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n}\\right) \\,\\mathrm{d}A,$$ 总面积为 $$A = \\int_{\\mathcal{S}} \\mathrm{d}A。$$\n\n几何模型与参数化：\n- 考虑一个由极向角 $\\theta \\in [0, 2\\pi)$ 和环向角 $\\zeta \\in [0, 2\\pi)$ 参数化的环形磁通面，单位均为弧度。\n- 该曲面通过柱坐标 $\\left(R(\\theta), Z(\\theta), \\phi = \\zeta\\right)$ 嵌入三维笛卡尔坐标系，并映射到笛卡尔坐标：$$x(\\theta,\\zeta) = R(\\theta)\\cos\\zeta,\\quad y(\\theta,\\zeta) = R(\\theta)\\sin\\zeta,\\quad z(\\theta,\\zeta) = Z(\\theta)。$$\n- 成形的截面遵循一个拉长和三角形化的模型：$$R(\\theta) = R_0 + a \\cos\\left(\\theta + \\delta \\sin\\theta \\right),\\quad Z(\\theta) = \\kappa a \\sin\\theta,$$ 其中 $R_0$ 是大半径，$a$ 是小半径，$\\kappa$ 是拉长率，$\\delta$ 是三角形变率。\n- 曲面偏导数定义为 $$\\frac{\\partial \\mathbf{r}}{\\partial \\theta} = \\left( \\frac{\\mathrm{d}R}{\\mathrm{d}\\theta}\\cos\\zeta,\\, \\frac{\\mathrm{d}R}{\\mathrm{d}\\theta}\\sin\\zeta,\\, \\frac{\\mathrm{d}Z}{\\mathrm{d}\\theta} \\right),\\quad \\frac{\\partial \\mathbf{r}}{\\partial \\zeta} = \\left( -R(\\theta)\\sin\\zeta,\\, R(\\theta)\\cos\\zeta,\\, 0 \\right),$$ 其中 $$\\frac{\\mathrm{d}R}{\\mathrm{d}\\theta} = -a \\sin\\left(\\theta + \\delta \\sin\\theta\\right)\\left(1 + \\delta \\cos\\theta\\right),\\quad \\frac{\\mathrm{d}Z}{\\mathrm{d}\\theta} = \\kappa a \\cos\\theta。$$\n- 曲面元为 $$\\mathrm{d}A = \\left\\| \\frac{\\partial \\mathbf{r}}{\\partial \\theta} \\times \\frac{\\partial \\mathbf{r}}{\\partial \\zeta} \\right\\| \\,\\mathrm{d}\\theta\\,\\mathrm{d}\\zeta,$$ 单位法向量为 $$\\mathbf{n} = \\frac{\\frac{\\partial \\mathbf{r}}{\\partial \\theta} \\times \\frac{\\partial \\mathbf{r}}{\\partial \\zeta}}{\\left\\| \\frac{\\partial \\mathbf{r}}{\\partial \\theta} \\times \\frac{\\partial \\mathbf{r}}{\\partial \\zeta} \\right\\|}。$$\n\n磁场模型：\n- 磁场在磁通面上以切向分量为主，包含环向和极向分量，外加一个可选的小法向分量以测试灵敏度：\n- 令 $$\\mathbf{t}_\\theta = \\frac{\\partial \\mathbf{r}}{\\partial \\theta},\\quad \\mathbf{t}_\\zeta = \\frac{\\partial \\mathbf{r}}{\\partial \\zeta},\\quad \\hat{\\mathbf{t}}_\\theta = \\frac{\\mathbf{t}_\\theta}{\\|\\mathbf{t}_\\theta\\|},\\quad \\hat{\\mathbf{t}}_\\zeta = \\frac{\\mathbf{t}_\\zeta}{\\|\\mathbf{t}_\\zeta\\|}。$$\n- 定义环向磁场大小 $$B_\\phi(\\theta) = B_0 \\frac{R_0}{R(\\theta)},$$ 其中 $B_0$ 是大半径 $R_0$ 处的参考环向场。\n- 定义一个恒定的极向磁场大小 $$B_\\theta = B_p,$$ 其中 $B_p$ 是一个给定的常数。\n- 切向场为 $$\\mathbf{B}_\\mathrm{tan}(\\theta,\\zeta) = B_\\phi(\\theta)\\,\\hat{\\mathbf{t}}_\\zeta(\\theta,\\zeta) + B_\\theta\\,\\hat{\\mathbf{t}}_\\theta(\\theta,\\zeta)。$$\n- 总磁场包含一个可选的法向分量，其强度为相对于局部切向场大小的分数 $\\epsilon$：$$\\mathbf{B}(\\theta,\\zeta) = \\mathbf{B}_\\mathrm{tan}(\\theta,\\zeta) + \\epsilon\\,\\|\\mathbf{B}_\\mathrm{tan}(\\theta,\\zeta)\\|\\,\\mathbf{n}(\\theta,\\zeta)。$$\n\n数值计算要求：\n- 通过分别使用 $N_\\theta$ 和 $N_\\zeta$ 个点对 $\\theta$ 和 $\\zeta$ 进行均匀离散化，计算粗网格的面积平均 $\\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle$。在 $[0,2\\pi)$ 弧度范围内使用不包含端点的均匀采样。\n- 使用矩形法则，权重由曲面雅可比行列式的大小 $J(\\theta,\\zeta) = \\left\\| \\frac{\\partial \\mathbf{r}}{\\partial \\theta} \\times \\frac{\\partial \\mathbf{r}}{\\partial \\zeta} \\right\\|$ 给出，以形成加权平均 $$\\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle \\approx \\frac{\\sum_{i,j} \\left(\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n}\\right)_{ij} J_{ij}}{\\sum_{i,j} J_{ij}}。$$\n- 使用更精细的网格，采用相同方法计算一个高分辨率的“参考”值，作为比较的表面求积基准。\n\n单位与输出：\n- 所有物理参数均采用国际单位制（SI）：几何尺寸单位为米（$\\mathrm{m}$），磁场单位为特斯拉（$\\mathrm{T}$），最终的平均法向牵引力单位为帕斯卡（$\\mathrm{Pa}$）。\n- 角度单位为弧度。\n- 对于每个测试案例，计算粗网格的面积平均 $\\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle$（单位为 $\\mathrm{Pa}$）和高分辨率参考值（单位为 $\\mathrm{Pa}$），然后仅报告定义为如下的相对误差 $$\\mathrm{error} = \\frac{\\left|\\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle_\\mathrm{coarse} - \\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle_\\mathrm{ref}\\right|}{\\left|\\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle_\\mathrm{ref}\\right|}。$$\n- 误差必须以小数形式报告。\n\n测试套件：\n实现程序以评估以下四个测试案例。每个案例是一个参数元组 $(R_0, a, \\kappa, \\delta, B_0, B_p, \\epsilon, N_\\theta, N_\\zeta, N_{\\theta,\\mathrm{ref}}, N_{\\zeta,\\mathrm{ref}})$：\n1. 案例1（理想路径，中等分辨率，成形表面，切向场）：$(R_0=\\;3.0\\,\\mathrm{m},\\; a=\\;1.0\\,\\mathrm{m},\\; \\kappa=\\;1.5,\\; \\delta=\\;0.3,\\; B_0=\\;5.0\\,\\mathrm{T},\\; B_p=\\;0.5\\,\\mathrm{T},\\; \\epsilon=\\;0.0,\\; N_\\theta=\\;32,\\; N_\\zeta=\\;64,\\; N_{\\theta,\\mathrm{ref}}=\\;256,\\; N_{\\zeta,\\mathrm{ref}}=\\;512)$。\n2. 案例2（边界情况，极粗分辨率）：$(R_0=\\;3.0\\,\\mathrm{m},\\; a=\\;1.0\\,\\mathrm{m},\\; \\kappa=\\;1.5,\\; \\delta=\\;0.3,\\; B_0=\\;5.0\\,\\mathrm{T},\\; B_p=\\;0.5\\,\\mathrm{T},\\; \\epsilon=\\;0.0,\\; N_\\theta=\\;8,\\; N_\\zeta=\\;16,\\; N_{\\theta,\\mathrm{ref}}=\\;256,\\; N_{\\zeta,\\mathrm{ref}}=\\;512)$。\n3. 案例3（灵敏度，小法向场分量）：$(R_0=\\;3.0\\,\\mathrm{m},\\; a=\\;0.8\\,\\mathrm{m},\\; \\kappa=\\;1.2,\\; \\delta=\\;0.2,\\; B_0=\\;6.0\\,\\mathrm{T},\\; B_p=\\;0.8\\,\\mathrm{T},\\; \\epsilon=\\;0.05,\\; N_\\theta=\\;64,\\; N_\\zeta=\\;128,\\; N_{\\theta,\\mathrm{ref}}=\\;256,\\; N_{\\zeta,\\mathrm{ref}}=\\;512)$。\n4. 案例4（形状应力，高拉长率，切向场）：$(R_0=\\;2.5\\,\\mathrm{m},\\; a=\\;0.9\\,\\mathrm{m},\\; \\kappa=\\;2.2,\\; \\delta=\\;0.4,\\; B_0=\\;4.5\\,\\mathrm{T},\\; B_p=\\;0.3\\,\\mathrm{T},\\; \\epsilon=\\;0.0,\\; N_\\theta=\\;48,\\; N_\\zeta=\\;96,\\; N_{\\theta,\\mathrm{ref}}=\\;256,\\; N_{\\zeta,\\mathrm{ref}}=\\;512)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试案例的相对误差，格式为逗号分隔的列表并用方括号括起；例如，$$[\\mathrm{err}_1,\\mathrm{err}_2,\\mathrm{err}_3,\\mathrm{err}_4].$$。这些数字必须是小数，不带任何单位符号。",
            "solution": "用户提供的问题已经过验证，被确定为一个在计算磁流体力学领域定义明确且科学合理的问题。任务是计算参数化环形曲面上的面积平均法向磁应力，并评估粗网格计算相对于高分辨率参考值的数值误差。\n\n解决方案的开发首先通过形式化基础物理和几何学，然后设计一个直接实现指定计算方法的数值算法。\n\n**1. 基本原理与控制方程**\n\n该问题围绕麦克斯韦应力张量展开，在静磁学中，其表达式为：\n$$\nT_{ij} = \\frac{1}{\\mu_0} \\left( B_i B_j - \\frac{1}{2} \\delta_{ij} B^2 \\right)\n$$\n其中 $\\mathbf{B}$ 是磁场矢量，$B^2 = \\mathbf{B} \\cdot \\mathbf{B}$ 是其大小的平方，$\\mu_0$ 是自由空间磁导率，$\\delta_{ij}$ 是克罗内克δ函数。\n\n法向牵引力，一个作用在单位法向量为 $\\mathbf{n}$ 的表面上的标量类压应力，是全收缩 $\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n}$。其显式形式已给出：\n$$\n\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} = \\frac{1}{\\mu_0} \\left( (\\mathbf{B}\\cdot \\mathbf{n})^2 - \\frac{1}{2} B^2 \\right)\n$$\n我们主要关注的量是闭合环形曲面 $\\mathcal{S}$ 上的面积平均法向牵引力，由曲面积分定义：\n$$\n\\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle = \\frac{\\int_{\\mathcal{S}} \\left(\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n}\\right) \\,\\mathrm{d}A}{\\int_{\\mathcal{S}} \\mathrm{d}A}\n$$\n\n**2. 曲面参数化与几何量**\n\n环形曲面 $\\mathcal{S}$ 由极向角 $\\theta \\in [0, 2\\pi)$ 和环向角 $\\zeta \\in [0, 2\\pi)$ 参数化。位置矢量 $\\mathbf{r}(\\theta, \\zeta)$ 在笛卡尔坐标系 $(x, y, z)$ 中通过柱坐标映射给出：\n$$\nx(\\theta,\\zeta) = R(\\theta)\\cos\\zeta, \\quad y(\\theta,\\zeta) = R(\\theta)\\sin\\zeta, \\quad z(\\theta,\\zeta) = Z(\\theta)\n$$\n横截面形状定义为：\n$$\nR(\\theta) = R_0 + a \\cos\\left(\\theta + \\delta \\sin\\theta \\right), \\quad Z(\\theta) = \\kappa a \\sin\\theta\n$$\n其中 $R_0, a, \\kappa, \\delta$ 分别是大半径、小半径、拉长率和三角形变率。\n\n为了计算该曲面上的积分，我们需要局部切向量和曲面元 $\\mathrm{d}A$。切向量是 $\\mathbf{r}$ 的偏导数：\n$$\n\\mathbf{t}_\\theta = \\frac{\\partial \\mathbf{r}}{\\partial \\theta} = \\left( \\frac{\\mathrm{d}R}{\\mathrm{d}\\theta}\\cos\\zeta, \\frac{\\mathrm{d}R}{\\mathrm{d}\\theta}\\sin\\zeta, \\frac{\\mathrm{d}Z}{\\mathrm{d}\\theta} \\right)\n$$\n$$\n\\mathbf{t}_\\zeta = \\frac{\\partial \\mathbf{r}}{\\partial \\zeta} = \\left( -R(\\theta)\\sin\\zeta, R(\\theta)\\cos\\zeta, 0 \\right)\n$$\n关于 $\\theta$ 的导数为：\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}\\theta} = -a \\sin\\left(\\theta + \\delta \\sin\\theta\\right)\\left(1 + \\delta \\cos\\theta\\right), \\quad \\frac{\\mathrm{d}Z}{\\mathrm{d}\\theta} = \\kappa a \\cos\\theta\n$$\n矢量曲面元为 $\\mathrm{d}\\mathbf{A} = (\\mathbf{t}_\\theta \\times \\mathbf{t}_\\zeta) \\,\\mathrm{d}\\theta\\,\\mathrm{d}\\zeta$。该矢量的大小，$J(\\theta, \\zeta) = \\|\\mathbf{t}_\\theta \\times \\mathbf{t}_\\zeta\\|$，是变换的雅可比行列式，标量曲面元为 $\\mathrm{d}A = J(\\theta, \\zeta) \\,\\mathrm{d}\\theta\\,\\mathrm{d}\\zeta$。向外的单位法向量为 $\\mathbf{n} = (\\mathbf{t}_\\theta \\times \\mathbf{t}_\\zeta) / J(\\theta, \\zeta)$。\n\n**3. 磁场模型**\n\n磁场 $\\mathbf{B}$ 是相对于曲面的局部几何来定义的。它由与单位切向量 $\\hat{\\mathbf{t}}_\\theta = \\mathbf{t}_\\theta / \\|\\mathbf{t}_\\theta\\|$ 和 $\\hat{\\mathbf{t}}_\\zeta = \\mathbf{t}_\\zeta / \\|\\mathbf{t}_\\zeta\\|$ 以及单位法向量 $\\mathbf{n}$ 对齐的分量构成。\n\n场的切向部分指定为：\n$$\n\\mathbf{B}_\\mathrm{tan}(\\theta,\\zeta) = B_\\phi(\\theta)\\,\\hat{\\mathbf{t}}_\\zeta(\\theta,\\zeta) + B_\\theta\\,\\hat{\\mathbf{t}}_\\theta(\\theta,\\zeta)\n$$\n其中环向场大小随大半径变化，$B_\\phi(\\theta) = B_0 R_0 / R(\\theta)$，而极向场大小 $B_\\theta = B_p$ 是恒定的。总磁场可能包含一个小的法向分量：\n$$\n\\mathbf{B}(\\theta,\\zeta) = \\mathbf{B}_\\mathrm{tan}(\\theta,\\zeta) + \\epsilon\\,\\|\\mathbf{B}_\\mathrm{tan}(\\theta,\\zeta)\\|\\,\\mathbf{n}(\\theta,\\zeta)\n$$\n其中 $\\epsilon$ 是一个无量纲的强度参数。\n\n**4. 数值算法设计**\n\n该问题要求使用二维矩形法在均匀网格上对面积平均牵引力进行数值评估。对于给定的网格分辨率 $(N_\\theta, N_\\zeta)$，算法流程如下：\n\n1.  **离散化**：为角度生成均匀网格：$\\theta_i = 2\\pi i/N_\\theta$ 对于 $i \\in [0, N_\\theta-1]$ 和 $\\zeta_j = 2\\pi j/N_\\zeta$ 对于 $j \\in [0, N_\\zeta-1]$。\n2.  **矢量化计算**：对于二维网格上的每个点 $(\\theta_i, \\zeta_j)$，使用 NumPy 的矢量化操作高效计算所有必要的量。\n    -   计算几何函数 $R(\\theta_{ij})$ 及其导数。\n    -   构建切向量 $\\mathbf{t}_\\theta$ 和 $\\mathbf{t}_\\zeta$ 的笛卡尔分量。\n    -   计算叉积 $\\mathbf{t}_\\theta \\times \\mathbf{t}_\\zeta$ 以求得法向量和雅可比行列式 $J = \\|\\mathbf{t}_\\theta \\times \\mathbf{t}_\\zeta\\|$。归一化以获得单位法向量 $\\mathbf{n}$。\n    -   构建单位切向量 $\\hat{\\mathbf{t}}_\\theta$ 和 $\\hat{\\mathbf{t}}_\\zeta$。\n    -   根据其定义组装磁场矢量 $\\mathbf{B}$。\n    -   计算标量 $(\\mathbf{B}\\cdot\\mathbf{n})^2$ 和 $B^2 = \\mathbf{B}\\cdot\\mathbf{B}$。\n    -   使用公式计算局部法向牵引力 $(\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n})_{ij}$。\n3.  **加权求和**：计算面积平均牵引力的离散近似值：\n    $$\n    \\left\\langle \\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n} \\right\\rangle \\approx \\frac{\\sum_{i,j} \\left(\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n}\\right)_{ij} J_{ij}}{\\sum_{i,j} J_{ij}}\n    $$\n    求和遍及所有 $N_\\theta \\times N_\\zeta$ 个网格点。\n4.  **误差计算**：整个计算执行两次：一次用于粗网格 $(N_\\theta, N_\\zeta)$ 以获得 $\\langle T_{nn} \\rangle_\\mathrm{coarse}$，一次用于参考网格 $(N_{\\theta,\\mathrm{ref}}, N_{\\zeta,\\mathrm{ref}})$ 以获得 $\\langle T_{nn} \\rangle_\\mathrm{ref}$。然后相对误差计算如下：\n    $$\n    \\mathrm{error} = \\frac{\\left|\\langle T_{nn} \\rangle_\\mathrm{coarse} - \\langle T_{nn} \\rangle_\\mathrm{ref}\\right|}{\\left|\\langle T_{nn} \\rangle_\\mathrm{ref}\\right|}\n    $$\n\n**分析注记**：对于所提供的特定几何和磁场模型，切向量 $\\mathbf{t}_\\theta$ 和 $\\mathbf{t}_\\zeta$ 在每一点都是正交的。这一性质带来了一个显著的分析简化：法向牵引力 $\\mathbf{n}\\cdot\\mathbf{T}\\cdot\\mathbf{n}$ 和雅可比行列式 $J$ 都仅是 $\\theta$ 的函数，与 $\\zeta$ 无关。因此，二维积分将简化为对 $\\theta$ 的一维积分。虽然这可以实现更高效的一维数值积分，但此处的实现严格遵守指定的二维求和方法，以完全符合问题的要求。这确保了代码是对给定数值方案的直接和忠实的实现。\n\n最终的 Python 程序将此逻辑封装到一个函数中，该函数处理每个测试案例并计算所需的相对误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import mu_0\n\ndef calculate_average_traction(params):\n    \"\"\"\n    Computes the area-averaged normal magnetic traction on a toroidal surface.\n\n    This function implements the full 2D numerical integration as specified,\n    discretizing over both poloidal (theta) and toroidal (zeta) angles.\n    \"\"\"\n    R0, a, kappa, delta, B0, Bp, epsilon, N_theta, N_zeta = params\n\n    # 1. Discretization: Create 2D grids for theta and zeta\n    theta_1d = np.linspace(0, 2 * np.pi, N_theta, endpoint=False)\n    zeta_1d = np.linspace(0, 2 * np.pi, N_zeta, endpoint=False)\n    theta, zeta = np.meshgrid(theta_1d, zeta_1d, indexing='ij')\n\n    # 2. Geometric Quantities (as 2D arrays)\n    # R(theta) and its derivatives\n    arg_cos = theta + delta * np.sin(theta)\n    R = R0 + a * np.cos(arg_cos)\n    dR_dtheta = -a * np.sin(arg_cos) * (1 + delta * np.cos(theta))\n    \n    # Z(theta) and its derivative\n    dZ_dtheta = kappa * a * np.cos(theta)\n\n    # 3. Tangent Vectors, Normal Vector, and Jacobian\n    cos_zeta = np.cos(zeta)\n    sin_zeta = np.sin(zeta)\n\n    # Tangent vector t_theta = d(r)/d(theta)\n    t_theta_x = dR_dtheta * cos_zeta\n    t_theta_y = dR_dtheta * sin_zeta\n    # t_theta_z is dZ_dtheta, which needs to be broadcast to the grid shape\n    t_theta_z = np.broadcast_to(dZ_dtheta, theta.shape)\n    t_theta = np.stack([t_theta_x, t_theta_y, t_theta_z], axis=-1)\n\n    # Tangent vector t_zeta = d(r)/d(zeta)\n    t_zeta_x = -R * sin_zeta\n    t_zeta_y = R * cos_zeta\n    t_zeta_z = np.zeros_like(R)\n    t_zeta = np.stack([t_zeta_x, t_zeta_y, t_zeta_z], axis=-1)\n\n    # Cross product, Jacobian, and unit normal vector\n    cross_prod = np.cross(t_theta, t_zeta, axisa=-1, axisb=-1)\n    # Jacobian J = ||t_theta x t_zeta||\n    J = np.linalg.norm(cross_prod, axis=-1)\n    # Unit normal n\n    n = cross_prod / J[..., np.newaxis]\n\n    # 4. Magnetic Field Vector\n    # Unit tangent vectors\n    norm_t_theta = np.linalg.norm(t_theta, axis=-1, keepdims=True)\n    norm_t_zeta = np.linalg.norm(t_zeta, axis=-1, keepdims=True)\n    t_hat_theta = t_theta / norm_t_theta\n    t_hat_zeta = t_zeta / norm_t_zeta\n\n    # B-field magnitudes\n    B_phi = B0 * R0 / R\n    # B_p is a scalar constant\n    \n    # Tangent B-field\n    B_tan = B_phi[..., np.newaxis] * t_hat_zeta + Bp * t_hat_theta\n    norm_B_tan = np.linalg.norm(B_tan, axis=-1, keepdims=True)\n    \n    # Total B-field\n    B = B_tan + epsilon * norm_B_tan * n\n\n    # 5. Normal Traction Calculation\n    B_dot_n = np.sum(B * n, axis=-1)\n    B_squared = np.sum(B**2, axis=-1)\n    \n    # Local normal traction T_nn = n.T.n\n    T_nn = (1.0 / mu_0) * (B_dot_n**2 - 0.5 * B_squared)\n\n    # 6. Weighted Summation (Numerical Integration)\n    numerator = np.sum(T_nn * J)\n    denominator = np.sum(J)\n    \n    if denominator == 0:\n        return 0.0 # Should not happen in a valid physical case\n\n    average_traction = numerator / denominator\n    return average_traction\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and compute relative errors.\n    \"\"\"\n    # Test cases: (R0, a, kappa, delta, B0, Bp, epsilon, N_theta, N_zeta, N_theta_ref, N_zeta_ref)\n    test_cases = [\n        (3.0, 1.0, 1.5, 0.3, 5.0, 0.5, 0.0, 32, 64, 256, 512),\n        (3.0, 1.0, 1.5, 0.3, 5.0, 0.5, 0.0, 8, 16, 256, 512),\n        (3.0, 0.8, 1.2, 0.2, 6.0, 0.8, 0.05, 64, 128, 256, 512),\n        (2.5, 0.9, 2.2, 0.4, 4.5, 0.3, 0.0, 48, 96, 256, 512),\n    ]\n\n    results = []\n    for case in test_cases:\n        R0, a, kappa, delta, B0, Bp, epsilon, N_theta, N_zeta, N_theta_ref, N_zeta_ref = case\n        \n        coarse_params = (R0, a, kappa, delta, B0, Bp, epsilon, N_theta, N_zeta)\n        ref_params = (R0, a, kappa, delta, B0, Bp, epsilon, N_theta_ref, N_zeta_ref)\n\n        traction_coarse = calculate_average_traction(coarse_params)\n        traction_ref = calculate_average_traction(ref_params)\n\n        if traction_ref == 0.0:\n            # Handle case of zero reference value, though unlikely\n            relative_error = np.inf if traction_coarse != 0.0 else 0.0\n        else:\n            relative_error = np.abs(traction_coarse - traction_ref) / np.abs(traction_ref)\n        \n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}