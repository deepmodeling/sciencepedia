{
    "hands_on_practices": [
        {
            "introduction": "“磁冻结”条件是理想磁流体动力学中的一个核心近似，但它的适用性取决于等离子体的具体参数。本练习旨在通过计算一个关键的无量纲数，来量化这一近似的有效性。通过对比磁场因电阻效应而耗散的特征时间与磁场随等离子体流体运动的特征时间，我们将判断在典型的聚变等离子体中，磁场的主要行为是“冻结”在流体中，还是会发生扩散。",
            "id": "4052944",
            "problem": "一个大环径比的托卡马克等离子体可以通过单流体电阻磁流体力学（MHD）来建模，假设电阻率为标量、等离子体为准中性且位移电流可忽略不计。从 Maxwell–Faraday 定律、导电媒质的 Ohm 定律以及无位移电流的 Ampère 定律出发，\n- $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$,\n- $\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B} = \\eta \\mathbf{J}$,\n- $\\mu_0 \\mathbf{J} = \\nabla \\times \\mathbf{B}$,\n推导磁感应方程，并通过标度分析确定特征磁平流时间和扩散时间。然后，对于以下托卡马克芯部参数，计算比值 $\\tau_{\\eta}/\\tau_A$，其中将特征平流速度解释为 Alfvén 速度，将特征长度解释为中尺度磁结构尺寸。\n\n使用以下数据：\n- 环向磁场强度 $\\,B = 5.8\\,\\mathrm{T}\\,$。\n- 电子数密度 $\\,n_e = 1.2 \\times 10^{20}\\,\\mathrm{m}^{-3}\\,$。\n- 主要离子是 50/50 的氘-氚混合物，平均离子质量为 $\\,m_i = 2.5\\,m_u\\,$，其中 $\\,m_u = 1.66054 \\times 10^{-27}\\,\\mathrm{kg}\\,$ 是原子质量单位。假设主要离子为单电荷，因此 $\\,n_i \\approx n_e\\,$ 且质量密度为 $\\,\\rho \\approx n_i m_i\\,$。\n- 电子温度 $\\,T_e = 12\\,\\mathrm{keV}\\,$，有效离子电荷 $\\,Z_{\\mathrm{eff}} = 1.5\\,$，库仑对数 $\\,\\ln\\Lambda = 17\\,$。\n- 特征长度 $\\,L = 0.60\\,\\mathrm{m}\\,$。\n- 真空磁导率 $\\,\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}\\,$。\n\n对于标量 Spitzer 电阻率，使用在高温、完全电离极限下的标准拟合公式：\n$$\n\\eta_{\\mathrm{Sp}} \\approx 1.65 \\times 10^{-9}\\,\\dfrac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{\\left(T_e/\\mathrm{keV}\\right)^{3/2}}\\,\\,\\mathrm{\\Omega\\,m}.\n$$\n\n定义 Alfvén 速度 $\\,v_A = B/\\sqrt{\\mu_0 \\rho}\\,$、Alfvén 时间 $\\,\\tau_A = L/v_A\\,$，以及磁扩散时间 $\\,\\tau_{\\eta} = L^2/\\eta_m\\,$，其中磁扩散率为 $\\,\\eta_m = \\eta_{\\mathrm{Sp}}/\\mu_0\\,$。计算无量纲比值 $\\,\\tau_{\\eta}/\\tau_A\\,$，并将答案四舍五入到三位有效数字。仅以科学记数法报告数值（无单位）。比值 $\\,\\tau_{\\eta}/\\tau_A\\,$ 足以推断在该等离子体中磁场特征是主要被平流还是扩散。将最终答案表示为单个数字。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、适定且完整的。所有必需的物理定律、假设和数据都已提供，足以进行所需的推导和计算。这些参数与高温聚变等离子体的情况一致。\n\n磁感应方程的推导始于所给出的三个磁流体力学（MHD）基本方程：\n1. Maxwell-Faraday 定律：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n2. 导电媒质的广义 Ohm 定律：\n$$ \\mathbf{E} + \\mathbf{u} \\times \\mathbf{B} = \\eta\\,\\mathbf{J} $$\n3. 忽略位移电流的 Ampère 定律：\n$$ \\mu_0\\,\\mathbf{J} = \\nabla \\times \\mathbf{B} $$\n这里，$\\mathbf{E}$ 是电场，$\\mathbf{B}$ 是磁场，$\\mathbf{u}$ 是流体速度，$\\mathbf{J}$ 是电流密度，$\\eta$ 是标量电阻率，$\\mu_0$ 是真空磁导率。\n\n首先，我们从 Ohm 定律中解出电场 $\\mathbf{E}$：\n$$ \\mathbf{E} = \\eta\\,\\mathbf{J} - \\mathbf{u} \\times \\mathbf{B} $$\n接下来，我们将这个 $\\mathbf{E}$ 的表达式代入 Maxwell-Faraday 定律：\n$$ \\nabla \\times (\\eta\\,\\mathbf{J} - \\mathbf{u} \\times \\mathbf{B}) = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n为消去电流密度 $\\mathbf{J}$，我们使用 Ampère 定律 $\\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}$：\n$$ \\nabla \\times \\left( \\frac{\\eta}{\\mu_0} \\nabla \\times \\mathbf{B} - \\mathbf{u} \\times \\mathbf{B} \\right) = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n重排方程以求解 $\\frac{\\partial \\mathbf{B}}{\\partial t}$，得到：\n$$ \\frac{\\partial \\mathbf{B}}{\\partial t} = - \\nabla \\times \\left( \\frac{\\eta}{\\mu_0} \\nabla \\times \\mathbf{B} \\right) + \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) $$\n定义磁扩散率为 $\\eta_m = \\eta / \\mu_0$，我们得到磁感应方程：\n$$ \\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) - \\nabla \\times (\\eta_m \\nabla \\times \\mathbf{B}) $$\n方程右边的第一项 $\\nabla \\times (\\mathbf{u} \\times \\mathbf{B})$ 代表磁场随流体的平流。第二项 $-\\nabla \\times (\\eta_m \\nabla \\times \\mathbf{B})$ 代表由有限电阻率引起的磁场扩散。\n\n为进行标度分析，我们引入物理量的特征标度：长度标度 $L$、速度标度 $U$、磁场标度 $B_0$ 和时间标度 $\\tau$。导数的标度为 $\\nabla \\sim 1/L$ 和 $\\partial/\\partial t \\sim 1/\\tau$。将这些代入磁感应方程，得到一个标度关系式：\n$$ \\frac{B_0}{\\tau} \\sim \\frac{U B_0}{L} + \\frac{\\eta_m B_0}{L^2} $$\n特征平流时间 $\\tau_{\\text{advect}}$ 通过平衡时间演化项与平流项得到：\n$$ \\frac{1}{\\tau_{\\text{advect}}} \\sim \\frac{U}{L} \\implies \\tau_{\\text{advect}} \\sim \\frac{L}{U} $$\n问题指定特征平流速度为 Alfvén 速度 $v_A$。因此，特征平流时间为 Alfvén 时间 $\\tau_A = L/v_A$。\n特征扩散时间 $\\tau_{\\eta}$ 通过平衡时间演化项与扩散项得到：\n$$ \\frac{1}{\\tau_{\\eta}} \\sim \\frac{\\eta_m}{L^2} \\implies \\tau_{\\eta} \\sim \\frac{L^2}{\\eta_m} $$\n这就是磁扩散时间。\n\n我们被要求计算比值 $\\tau_{\\eta}/\\tau_A$：\n$$ \\frac{\\tau_{\\eta}}{\\tau_A} = \\frac{L^2/\\eta_m}{L/v_A} = \\frac{L v_A}{\\eta_m} $$\n这个无量纲比值是 Lundquist 数 $S$。为了计算它的值，我们首先使用所提供的数据计算必要的物理量。\n\n1.  **质量密度 ($\\rho$)**：\n    给定 $n_e = 1.2 \\times 10^{20}\\,\\mathrm{m}^{-3}$，准中性 ($n_i \\approx n_e$)，以及平均离子质量 $m_i = 2.5\\,m_u$，其中 $m_u = 1.66054 \\times 10^{-27}\\,\\mathrm{kg}$。\n    $$ \\rho \\approx n_i m_i = (1.2 \\times 10^{20}\\,\\mathrm{m}^{-3}) \\times (2.5 \\times 1.66054 \\times 10^{-27}\\,\\mathrm{kg}) $$\n    $$ \\rho \\approx 4.98162 \\times 10^{-7}\\,\\mathrm{kg\\,m}^{-3} $$\n\n2.  **Spitzer 电阻率 ($\\eta_{\\mathrm{Sp}}$)**：\n    给定 $Z_{\\mathrm{eff}} = 1.5$, $\\ln\\Lambda = 17$, 以及 $T_e = 12\\,\\mathrm{keV}$。\n    $$ \\eta_{\\mathrm{Sp}} \\approx 1.65 \\times 10^{-9}\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{\\left(T_e/\\mathrm{keV}\\right)^{3/2}}\\,\\,\\mathrm{\\Omega\\,m} $$\n    $$ \\eta_{\\mathrm{Sp}} \\approx 1.65 \\times 10^{-9}\\,\\frac{1.5 \\times 17}{(12)^{3/2}} = 1.65 \\times 10^{-9}\\,\\frac{25.5}{41.5692...} \\approx 1.01216 \\times 10^{-9}\\,\\mathrm{\\Omega\\,m} $$\n\n3.  **磁扩散率 ($\\eta_m$)**：\n    使用 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$。\n    $$ \\eta_m = \\frac{\\eta_{\\mathrm{Sp}}}{\\mu_0} \\approx \\frac{1.01216 \\times 10^{-9}\\,\\mathrm{\\Omega\\,m}}{4\\pi \\times 10^{-7}\\,\\mathrm{H/m}} \\approx 8.0545 \\times 10^{-4}\\,\\mathrm{m^2\\,s^{-1}} $$\n\n4.  **Alfvén 速度 ($v_A$)**：\n    使用 $B = 5.8\\,\\mathrm{T}$。\n    $$ v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} \\approx \\frac{5.8\\,\\mathrm{T}}{\\sqrt{(4\\pi \\times 10^{-7}\\,\\mathrm{H/m}) \\times (4.98162 \\times 10^{-7}\\,\\mathrm{kg\\,m}^{-3})}} $$\n    $$ v_A \\approx \\frac{5.8}{\\sqrt{6.2608 \\times 10^{-13}}} \\approx \\frac{5.8}{7.9125 \\times 10^{-7}} \\approx 7.3301 \\times 10^6\\,\\mathrm{m\\,s^{-1}} $$\n\n5.  **比值 $\\tau_{\\eta}/\\tau_A$**：\n    使用特征长度 $L = 0.60\\,\\mathrm{m}$。\n    $$ \\frac{\\tau_{\\eta}}{\\tau_A} = \\frac{L v_A}{\\eta_m} \\approx \\frac{(0.60\\,\\mathrm{m}) \\times (7.3301 \\times 10^6\\,\\mathrm{m\\,s^{-1}})}{8.0545 \\times 10^{-4}\\,\\mathrm{m^2\\,s^{-1}}} $$\n    $$ \\frac{\\tau_{\\eta}}{\\tau_A} \\approx \\frac{4.39806 \\times 10^6}{8.0545 \\times 10^{-4}} \\approx 5.4605 \\times 10^9 $$\n这个比值的大数值（$S \\gg 1$）表明磁扩散时间远长于平流时间。因此，电阻效应很弱，磁场有效地“冻结”在等离子体流体中。磁结构主要是随流体平流，而不是扩散消失。\n\n将结果四舍五入到三位有效数字，我们得到 $5.46 \\times 10^9$。",
            "answer": "$$\\boxed{5.46 \\times 10^9}$$"
        },
        {
            "introduction": "当磁冻结条件被破坏时，磁力线会相对于等离子体流体发生“滑移”，导致磁拓扑结构的改变。这个过程，即磁重联，是等离子体物理学中的一个基本现象。本练习将深入探讨磁力线滑移的根本物理机制，阐明平行于磁场的电场分量（$E_{\\parallel}$）在打破理想冻结、驱动磁拓扑演化中的决定性作用。",
            "id": "4053014",
            "problem": "在聚变工程中一个具有代表性的环形等离子体装置中，考虑一个薄的物质环路 $\\,\\mathcal{C}(t)\\,$，它是一个物质曲面 $\\,\\mathcal{S}(t)\\,$ 的边界，该曲面由相同的标记等离子体元构成，并以局域等离子体速度 $\\,\\mathbf{v}(\\mathbf{x},t)\\,$ 运动。该环路被磁场 $\\,\\mathbf{B}(\\mathbf{x},t)\\,$ 的磁力线穿过，并受到电场 $\\,\\mathbf{E}(\\mathbf{x},t)\\,$ 的作用。使用 Faraday 感应定律和运动轮廓的运动学，评估磁力线的足点在何种条件下保持附着于 $\\,\\mathcal{C}(t)\\,$，以及在何种条件下它们会相对于运动物质发生滑移，并明确地参考 $\\,\\mathbf{E}\\,$ 平行于 $\\,\\mathbf{B}\\,$ 的分量，记为 $\\,\\mathbf{E}_{\\parallel} \\equiv (\\mathbf{E}\\cdot\\hat{\\mathbf{b}})\\,\\hat{\\mathbf{b}}\\,$，其中 $\\,\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|\\,$。假定磁流体力学 (MHD) 及其扩展理论有效，并允许存在非理想效应。\n\n哪个陈述是正确的？\n\nA. 对于一个以速度 $\\,\\mathbf{v}\\,$ 运动的物质环路，磁足点保持附着当且仅当沿着每一条穿过 $\\,\\mathcal{C}(t)\\,$ 的磁力线，平行电场的线积分都为零，即 $\\,\\int_{\\text{field line}} \\mathbf{E}\\cdot\\hat{\\mathbf{b}}\\,\\mathrm{d}\\ell = 0\\,$。在这种情况下，通过随动环路的磁通量满足 $\\,\\mathrm{d}\\Phi/\\mathrm{d}t = -\\oint_{\\mathcal{C}(t)} (\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})\\cdot \\mathrm{d}\\boldsymbol{\\ell} = 0\\,$，并且足点保持附着。滑移发生的精确位置和程度取决于穿越一个非理想区域的积分 $\\,\\int_{\\text{field line}} \\mathbf{E}_{\\parallel}\\,\\mathrm{d}\\ell \\neq 0\\,$。\n\nB. 如果 $\\,\\nabla\\times \\mathbf{E}_{\\parallel} = \\mathbf{0}\\,$，那么根据 Faraday 定律，平行电场不能改变磁通量；因此即使沿磁力线的积分 $\\,\\int \\mathbf{E}_{\\parallel}\\cdot \\mathrm{d}\\boldsymbol{\\ell} \\neq 0\\,$，足点也保持附着。\n\nC. 冻结条件仅仅由垂直分量 $\\,\\mathbf{E}_{\\perp}\\,$ 决定；只要 $|\\mathbf{E}_{\\perp}| |\\mathbf{v} \\times \\mathbf{B}|$, 无论 $\\,\\mathbf{E}_{\\parallel}\\,$ 如何，足点都保持附着。\n\nD. 在霍尔磁流体力学 (Hall MHD) 中，即使是有限的 $\\,\\mathbf{E}_{\\parallel}\\,$ 也不能引起磁足点相对于离子流体的滑移；磁力线严格冻结在离子速度 $\\,\\mathbf{v}_{i}\\,$ 中。",
            "solution": "### 问题验证\n\n#### 第一步：提取已知条件\n- **系统：** 聚变工程中的环形等离子体装置。\n- **物体与运动：** 一个薄的物质环路 $\\mathcal{C}(t)$ 是一个物质曲面 $\\mathcal{S}(t)$ 的边界。两者都由以局域等离子体速度 $\\mathbf{v}(\\mathbf{x},t)$ 运动的等离子体元构成。\n- **场：** 磁场 $\\mathbf{B}(\\mathbf{x},t)$ 和电场 $\\mathbf{E}(\\mathbf{x},t)$。\n- **定义：** $\\mathbf{E}$ 平行于 $\\mathbf{B}$ 的分量为 $\\mathbf{E}_{\\parallel} \\equiv (\\mathbf{E}\\cdot\\hat{\\mathbf{b}})\\,\\hat{\\mathbf{b}}$，其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|$。\n- **基本原理：** Faraday 感应定律、运动轮廓的运动学、磁流体力学 (MHD) 及其扩展理论均有效。\n- **关键条件：** 允许存在非理想效应。\n- **问题：** 评估磁力线足点相对于物质环路 $\\mathcal{C}(t)$ 的附着（冻结）和滑移的条件，并特别参考 $\\mathbf{E}_{\\parallel}$。\n\n#### 第二步：使用已知条件进行验证\n1.  **科学依据：** 该问题牢固地植根于等离子体物理学和磁流体力学的基本原理。它涉及 Faraday 定律、物质环路的概念、磁通量、冻结条件 (Alfvén 定理) 以及非理想效应（这会导致磁重联）。这些都是聚变等离子体物理学中的标准和关键概念。\n2.  **提法明确：** 该问题要求的是控制一个明确现象（磁力线滑移）的物理条件。所提供的信息足以从第一性原理推导出这些条件。可以得出一个唯一且有意义的物理结论。\n3.  **客观性：** 该问题使用精确、标准的科学术语来表述。没有主观或模棱两可的陈述。\n\n#### 第三步：结论与行动\n问题陈述在科学上是合理的、提法明确且客观。它不包含任何使其无效的缺陷。因此，该问题是**有效的**。我将继续进行推导和求解。\n\n### 推导\n\n分析始于穿过物质曲面 $\\mathcal{S}(t)$ 的磁通量 $\\Phi$，该曲面的边界是物质环路 $\\mathcal{C}(t)$。\n磁通量定义为：\n$$ \\Phi(t) = \\int_{\\mathcal{S}(t)} \\mathbf{B}(\\mathbf{x}, t) \\cdot d\\mathbf{A} $$\n对于以速度 $\\mathbf{v}$ 运动的曲面，该通量的变化率由曲面的 Reynolds 输运定理（也称为运动曲面的 Leibniz 积分法则）给出：\n$$ \\frac{d\\Phi}{dt} = \\int_{\\mathcal{S}(t)} \\left( \\frac{\\partial \\mathbf{B}}{\\partial t} - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) \\right) \\cdot d\\mathbf{A} $$\n我们使用 Faraday 感应定律 $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$ 来替换 $\\mathbf{B}$ 的时间导数：\n$$ \\frac{d\\Phi}{dt} = \\int_{\\mathcal{S}(t)} \\left( -(\\nabla \\times \\mathbf{E}) - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) \\right) \\cdot d\\mathbf{A} = - \\int_{\\mathcal{S}(t)} \\nabla \\times (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot d\\mathbf{A} $$\n应用 Stokes 定理，我们将 $\\mathcal{S}(t)$ 上的面积分转换为沿其边界，即物质环路 $\\mathcal{C}(t)$ 的线积分：\n$$ \\frac{d\\Phi}{dt} = - \\oint_{\\mathcal{C}(t)} (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot d\\boldsymbol{\\ell} $$\n矢量 $\\mathbf{E}' = \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}$ 是在随等离子体运动的局域参考系中的电场。因此，通过物质环路的磁通量变化率等于在随动参考系中测量的该环路周围电动势 (EMF) 的负值。\n\n磁力线“冻结”或“附着”在等离子体中的概念意味着通过任何物质环路的磁通量都是守恒的，即 $\\frac{d\\Phi}{dt} = 0$。这意味着相对于流体元的磁拓扑是保持不变的。对于任何环路 $\\mathcal{C}(t)$，$\\frac{d\\Phi}{dt} = 0$ 这个条件要求被积函数在局域为零（或者是一个标量势的梯度）。最简单和最普遍的条件是理想欧姆定律：\n$$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $$\n这个矢量方程可以分解为平行于和垂直于 $\\mathbf{B}$ 的分量：\n1.  平行分量：$(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\hat{\\mathbf{b}} = \\mathbf{E} \\cdot \\hat{\\mathbf{b}} = E_{\\parallel} = 0$。\n2.  垂直分量：$\\mathbf{E}_{\\perp} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$。\n\n磁足点的滑移是磁场拓扑变化的一种可视化。这个过程被称为磁重联。它发生在冻结条件被违反时，即当 $\\frac{d\\Phi}{dt} \\neq 0$ 时。这要求 $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\neq \\mathbf{0}$。这个非零项源于非理想效应，例如电阻率 ($\\eta \\mathbf{J}$)、霍尔效应 ($\\frac{1}{ne}\\mathbf{J}\\times\\mathbf{B}$) 或电子压力梯度 ($-\\frac{1}{ne}\\nabla p_e$) 。\n\n现代磁重联理论的一个核心论点是，磁连接性的改变需要沿磁力线存在一个非零的电势降。该电势降由平行电场的线积分给出：\n$$ V_{\\parallel} = \\int_{\\text{field line}} \\mathbf{E} \\cdot d\\boldsymbol{\\ell} = \\int_{\\text{field line}} E_{\\parallel} d\\ell $$\n在理想 MHD 中，处处都有 $E_{\\parallel}=0$，因此 $V_{\\parallel} = 0$，重联是被禁止的。在具有非理想效应的真实等离子体中，一个局域区域可以支持有限的 $E_{\\parallel}$，导致非零的 $V_{\\parallel}$。这个“重联电压”决定了磁力线断开并以新的拓扑结构重新形成的速度，这正是足点滑移的现象。因此，足点保持附着的条件是对于所有穿过环路的磁力线，都有 $\\int E_{\\parallel} d\\ell = 0$。当、在何处以及在此积分不为零的程度上，就会发生滑移。\n\n### 逐项分析\n\n**A. 对于一个以速度 $\\,\\mathbf{v}\\,$ 运动的物质环路，磁足点保持附着当且仅当沿着每一条穿过 $\\,\\mathcal{C}(t)\\,$ 的磁力线，平行电场的线积分都为零，即 $\\,\\int_{\\text{field line}} \\mathbf{E}\\cdot\\hat{\\mathbf{b}}\\,\\mathrm{d}\\ell = 0\\,$。在这种情况下，通过随动环路的磁通量满足 $\\,\\mathrm{d}\\Phi/\\mathrm{d}t = -\\oint_{\\mathcal{C}(t)} (\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})\\cdot \\mathrm{d}\\boldsymbol{\\ell} = 0\\,$，并且足点保持附着。滑移发生的精确位置和程度取决于穿越一个非理想区域的积分 $\\,\\int_{\\text{field line}} \\mathbf{E}_{\\parallel}\\,\\mathrm{d}\\ell \\neq 0\\,$。**\n\n该陈述与我们的推导完全一致。它正确地指出了积分平行电场为零是维持磁拓扑（无滑移）的充分必要条件。它正确地说明了如果足点附着，通过随动环路的通量是守恒的（$\\frac{d\\Phi}{dt}=0$），并正确地提供了此变化率的积分表达式。最后，它准确地描述了滑移是由非零的积分平行电场引起的，并且其程度与之成正比，而这种电场只能存在于非理想区域。\n**结论：正确。**\n\n**B. 如果 $\\,\\nabla\\times \\mathbf{E}_{\\parallel} = \\mathbf{0}\\,$，那么根据 Faraday 定律，平行电场不能改变磁通量；因此即使沿磁力线的积分 $\\,\\int \\mathbf{E}_{\\parallel}\\cdot \\mathrm{d}\\boldsymbol{\\ell} \\neq 0\\,$，足点也保持附着。**\n\n这个陈述是有缺陷的。首先，Faraday 定律将 $\\frac{\\partial \\mathbf{B}}{\\partial t}$ 与 $\\nabla \\times \\mathbf{E} = \\nabla \\times (\\mathbf{E}_{\\parallel} + \\mathbf{E}_{\\perp})$ 相关联，而不仅仅是 $\\nabla \\times \\mathbf{E}_{\\parallel}$。不能用这种方式分离出其贡献。其次，更关键的是，即使 $\\int E_{\\parallel} d\\ell \\neq 0$，足点也保持附着的结论在根本上是错误的。正如推导所示，一个非零的 $E_{\\parallel}$ 线积分正是驱动磁拓扑变化（即足点滑移）的重联电压的定义。\n**结论：不正确。**\n\n**C. 冻结条件仅仅由垂直分量 $\\,\\mathbf{E}_{\\perp}\\,$ 决定；只要 $|\\mathbf{E}_{\\perp}| |\\mathbf{v} \\times \\mathbf{B}|$, 无论 $\\,\\mathbf{E}_{\\parallel}\\,$ 如何，足点都保持附着。**\n\n这是不正确的。冻结条件 $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$ 是一个矢量方程，其平行和垂直分量都必须成立。具体来说，它要求 $E_{\\parallel}=0$。关于条件“仅仅由垂直分量决定”以及“无论 $\\mathbf{E}_{\\parallel}$ 如何”都阻止滑移的说法是错误的。非零的 $\\mathbf{E}_{\\parallel}$ 直接违反了理想条件，并且正是它使重联成为可能。此外，关于大小的条件 $|\\mathbf{E}_{\\perp}| |\\mathbf{v} \\times \\mathbf{B}|$ 并不是正确的条件；理想条件是一个矢量等式，$\\mathbf{E}_{\\perp} = - \\mathbf{v} \\times \\mathbf{B}$。\n**结论：不正确。**\n\n**D. 在霍尔磁流体力学 (Hall MHD) 中，即使是有限的 $\\,\\mathbf{E}_{\\parallel}\\,$ 也不能引起磁足点相对于离子流体的滑移；磁力线严格冻结在离子速度 $\\,\\mathbf{v}_{i}\\,$ 中。**\n\n这个陈述包含一个关于霍尔 MHD 的根本性错误。在霍尔 MHD 模型中，感应方程的形式为 $\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v}_e \\times \\mathbf{B})$，其中 $\\mathbf{v}_e$ 是电子流体速度。这意味着磁力线冻结在*电子流体*中，而不是离子流体 ($\\mathbf{v}_i$) 中。速度差 $\\mathbf{v}_i - \\mathbf{v}_e = \\mathbf{J}/(ne)$ 代表了离子流体相对于磁场的滑移。磁力线冻结在离子中的断言是不正确的。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理解了磁冻结的物理条件后，一个关键的实践步骤是在计算中正确地实现它。本练习要求您为一个理想的剪切流场景推导并实现磁场的精确演化，这个过程被称为“冻结推前”（frozen-in pushforward）。通过将这个精确解与一个将磁场分量视为独立无源标量的“朴素”平流模型进行对比，您将亲手揭示矢量场在流体中被拉伸和旋转的本质，并量化忽略这种效应所导致的误差。",
            "id": "4053049",
            "problem": "考虑不可压缩理想磁流体动力学（MHD），它由麦克斯韦-法拉第方程和理想欧姆定律共同定义。相关的基本原理是：麦克斯韦-法拉第方程 $ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $，理想欧姆定律 $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $，以及不可压缩流的质量守恒 $ \\nabla \\cdot \\mathbf{v} = 0 $。对于没有磁源的静磁学，螺线管约束 $ \\nabla \\cdot \\mathbf{B} = 0 $ 成立。在理想极限下，磁场线被预期冻结在流体运动中。\n\n您需要在一个二维周期性方形域中设计一个用于剪切平流的计算基准，其中存在解析解以验证冻结行为。速度场是由 $ \\mathbf{v}(x,y) = (\\gamma y, 0) $ 给出的线性剪切，其中 $ \\gamma $ 是一个恒定的剪切率，单位为 $ \\mathrm{s}^{-1} $。域为 $ [0, L) \\times [0, L) $，在两个方向上都具有周期性边界条件，其中 $ L $ 的单位为 $ \\mathrm{m} $。\n\n您的任务是：\n\n- 从上述基本定律和定义出发，推导在此剪切流的理想假设下磁场的解析演化，用从初始坐标 $ \\mathbf{a} $ 到当前坐标 $ \\mathbf{x} $ 的流映射以及相关的形变梯度表示。不要使用或引用任何已经特化于该结果的快捷公式；相反，应从提供的基本原理中推导结果。清晰地陈述推导所需的假设，包括对 $ \\nabla \\cdot \\mathbf{v} $ 和 $ \\nabla \\cdot \\mathbf{B} $ 的任何约束。\n\n- 实现一个数值模型，在给定时间 $ t $ 计算以下两者：\n  1. 从您的推导中获得的解析演化磁场（不可压缩剪切下的冻结推前）。\n  2. 一个朴素的被动平流模型，该模型将磁场分量视为由流场输运的独立被动标量，而不考虑由速度梯度引起的任何拉伸或旋转。\n\n- 通过计算域上的相对 $ L^2 $ 误差来量化朴素被动平流模型与解析正确的冻结演化之间的差异，该误差定义为\n$$\n\\varepsilon = \\sqrt{\\frac{\\sum_{i,j} \\left( \\left[B_x^{\\mathrm{naive}}(x_i,y_j,t) - B_x^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 + \\left[B_y^{\\mathrm{naive}}(x_i,y_j,t) - B_y^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 \\right)}{\\sum_{i,j} \\left( \\left[B_x^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 + \\left[B_y^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 \\right)}} \\, .\n$$\n\n使用逆流映射 $ \\mathbf{a}(\\mathbf{x},t) $ 在适当的拉格朗日标签处评估初始条件，并通过在评估三角函数之前将坐标对 $ L $ 取模来强制周期性。三角函数评估中的所有角度都必须是弧度。\n\n初始条件和测试套件：\n\n- 使用标量势 $ A_z(\\mathbf{a}) $ 定义一个无散度的初始磁场，使得 $ \\mathbf{B}_0(\\mathbf{a}) = \\nabla \\times \\left( A_z(\\mathbf{a}) \\, \\hat{\\mathbf{z}} \\right) $。使用以下选择\n$$\nA_z(\\mathbf{a}) = \\frac{B_\\star}{k} \\sin\\left(k a_x\\right) \\sin\\left(k a_y\\right) \\, ,\n$$\n其中 $ B_\\star $ 的单位是 $ \\mathrm{T} $，$ k $ 的单位是 $ \\mathrm{rad}\\,\\mathrm{m}^{-1} $，因此\n$$\nB_{0x}(\\mathbf{a}) = B_\\star \\sin\\left(k a_x\\right) \\cos\\left(k a_y\\right) \\, , \\quad B_{0y}(\\mathbf{a}) = - B_\\star \\cos\\left(k a_x\\right) \\sin\\left(k a_y\\right) \\, .\n$$\n还包括一个均匀初始场的情况 $ \\mathbf{B}_0(\\mathbf{a}) = (0, B_\\star) $，其中 $ B_\\star $ 为常数。\n\n- 使用边长为 $ L $ 的周期性方形域，并采用 $ N \\times N $ 个点的均匀笛卡尔网格。为实现周期性，在 $ \\mathbf{a}(\\mathbf{x},t) $ 的每个方向上对 $ L $ 取模后评估初始条件。\n\n- 为以下每个测试用例提供相对 $ L^2 $ 误差 $ \\varepsilon $（这些用例构成测试套件）：\n  1. 用例 $ A $（理想路径，剪切下的恒定场）：$ L = 1.0 \\, \\mathrm{m} $，$ N = 128 $，$ \\gamma = 1.0 \\, \\mathrm{s}^{-1} $，$ t = 0.3 \\, \\mathrm{s} $，$ B_\\star = 0.7 \\, \\mathrm{T} $。使用均匀初始场 $ \\mathbf{B}_0 = (0, B_\\star) $。\n  2. 用例 $ B $（无散度正弦初始场）：$ L = 1.0 \\, \\mathrm{m} $，$ N = 128 $，$ \\gamma = 0.6 \\, \\mathrm{s}^{-1} $，$ t = 0.5 \\, \\mathrm{s} $，$ B_\\star = 0.5 \\, \\mathrm{T} $，$ k = \\frac{2\\pi}{L} \\, \\mathrm{rad}\\,\\mathrm{m}^{-1} $。使用上面定义的无散度初始场。\n  3. 用例 $ C $（零时刻的边界条件）：参数与用例 $ B $ 相同，但 $ t = 0.0 \\, \\mathrm{s} $。\n  4. 用例 $ D $（零剪切的边缘情况）：参数与用例 $ B $ 相同，但 $ \\gamma = 0.0 \\, \\mathrm{s}^{-1} $。\n\n单位和角度规范：\n\n- 距离 $ L $ 的单位是 $ \\mathrm{m} $，剪切率 $ \\gamma $ 的单位是 $ \\mathrm{s}^{-1} $，时间 $ t $ 的单位是 $ \\mathrm{s} $，磁场振幅 $ B_\\star $ 的单位是 $ \\mathrm{T} $，波数 $ k $ 的单位是 $ \\mathrm{rad}\\,\\mathrm{m}^{-1} $。所有三角函数的参数必须是弧度。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含用例 $ A $、$ B $、$ C $ 和 $ D $ 的相对 $ L^2 $ 误差，格式为方括号内的逗号分隔列表，例如 $ [e_A, e_B, e_C, e_D] $。每个条目必须是一个浮点数。将每个条目表示为四舍五入到八位小数的无量纲浮点数。\n\n不需要用户输入；所有参数均已在上面指定，并且必须硬编码。您的实现应该是自包含的，并且可以在任何具有标准数值库的现代编程环境中执行。",
            "solution": "该问题要求推导理想、不可压缩剪切流中磁场演化的解析解，并将其与一个朴素的被动平流模型进行比较。问题陈述的验证已确认其科学合理性、完整性和清晰性。我们现在开始进行形式推导和数值实现的设计。\n\n### 第1部分：解析磁场演化（冻结定律）的推导\n\n理想导电流体中磁场 $ \\mathbf{B} $ 的演化由麦克斯韦-法拉第方程和理想欧姆定律共同决定。\n\n提供的基本方程是：\n1.  麦克斯韦-法拉第方程：$ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $\n2.  理想欧姆定律：$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $\n3.  流的不可压缩性条件：$ \\nabla \\cdot \\mathbf{v} = 0 $\n4.  磁场的螺线管约束：$ \\nabla \\cdot \\mathbf{B} = 0 $\n\n根据欧姆定律，我们将电场表示为 $ \\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B} $。将其代入麦克斯韦-法拉第方程，得到理想感应方程：\n$$\n\\partial_t \\mathbf{B} = - \\nabla \\times (-\\mathbf{v} \\times \\mathbf{B}) = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\n我们使用矢量微积分恒等式 $ \\nabla \\times (\\mathbf{A} \\times \\mathbf{C}) = (\\mathbf{C} \\cdot \\nabla) \\mathbf{A} - (\\mathbf{A} \\cdot \\nabla) \\mathbf{C} + \\mathbf{A}(\\nabla \\cdot \\mathbf{C}) - \\mathbf{C}(\\nabla \\cdot \\mathbf{A}) $。将 $ \\mathbf{A} $ 对应于 $ \\mathbf{v} $，将 $ \\mathbf{C} $ 对应于 $ \\mathbf{B} $，我们展开旋度项：\n$$\n\\partial_t \\mathbf{B} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v} - (\\mathbf{v} \\cdot \\nabla) \\mathbf{B} + \\mathbf{v}(\\nabla \\cdot \\mathbf{B}) - \\mathbf{B}(\\nabla \\cdot \\mathbf{v})\n$$\n应用给定的约束条件 $ \\nabla \\cdot \\mathbf{v} = 0 $ 和 $ \\nabla \\cdot \\mathbf{B} = 0 $，方程简化为：\n$$\n\\partial_t \\mathbf{B} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{B} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v}\n$$\n左侧是磁场的物质导数 $ \\frac{D\\mathbf{B}}{Dt} $，它描述了随流体微元移动的观察者所看到的 $ \\mathbf{B} $ 的变化率。因此，我们有：\n$$\n\\frac{D\\mathbf{B}}{Dt} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v}\n$$\n项 $ (\\mathbf{B} \\cdot \\nabla) \\mathbf{v} $ 表示由速度梯度张量 $ \\nabla\\mathbf{v} $ 引起的场的拉伸和旋转。让我们用分量形式表示。第 $i$ 个分量是 $ \\frac{DB_i}{Dt} = \\sum_j B_j \\frac{\\partial v_i}{\\partial x_j} $。以矩阵形式表示为 $ \\frac{D\\mathbf{B}}{Dt} = (\\nabla\\mathbf{v})\\mathbf{B} $。\n\n为了求解这个方程，我们在拉格朗日框架中考虑演化。设 $ \\mathbf{a} $ 是一个流体微元在时间 $ t=0 $ 时的初始位置，设 $ \\mathbf{x} = \\mathbf{\\Phi}(\\mathbf{a}, t) $ 是它在时间 $ t $ 的位置。形变梯度张量定义为 $ \\mathbf{F}(\\mathbf{a}, t) $，其分量为 $ F_{ij} = \\frac{\\partial x_i}{\\partial a_j} $。$ \\mathbf{F} $ 的演化由 $ \\frac{D\\mathbf{F}}{Dt} = (\\nabla\\mathbf{v})\\mathbf{F} $ 给出。在拉格朗日框架中，这是 $ \\frac{\\partial \\mathbf{F}}{\\partial t}\\Big|_{\\mathbf{a}} = (\\nabla\\mathbf{v})\\mathbf{F} $。\n\n设 $ \\tilde{\\mathbf{B}}(\\mathbf{a}, t) = \\mathbf{B}(\\mathbf{\\Phi}(\\mathbf{a}, t), t) $ 是最初位于 $ \\mathbf{a} $ 的流体微元的磁场矢量。物质导数则为 $ \\frac{D\\mathbf{B}}{Dt} = \\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\\Big|_{\\mathbf{a}} $。在此框架中，感应方程变为：\n$$\n\\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\\Big|_{\\mathbf{a}} = (\\nabla\\mathbf{v}) \\tilde{\\mathbf{B}}\n$$\n我们观察到，对于一个固定的微元 $ \\mathbf{a} $，$ \\tilde{\\mathbf{B}} $ 和 $ \\mathbf{F} $ 在时间上满足形式上相同的线性常微分方程。我们构造一个量 $ \\mathbf{C}(\\mathbf{a}, t) = \\mathbf{F}^{-1}(\\mathbf{a}, t) \\tilde{\\mathbf{B}}(\\mathbf{a}, t) $ 并证明它在时间上是守恒的。\n$$\n\\frac{\\partial \\mathbf{C}}{\\partial t} = \\frac{\\partial \\mathbf{F}^{-1}}{\\partial t}\\tilde{\\mathbf{B}} + \\mathbf{F}^{-1}\\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\n$$\n使用恒等式 $ \\frac{\\partial \\mathbf{F}^{-1}}{\\partial t} = -\\mathbf{F}^{-1} \\frac{\\partial \\mathbf{F}}{\\partial t} \\mathbf{F}^{-1} $ 并代入 $ \\tilde{\\mathbf{B}} $ 和 $ \\mathbf{F} $ 的演化方程：\n$$\n\\frac{\\partial \\mathbf{C}}{\\partial t} = \\left( -\\mathbf{F}^{-1} (\\nabla\\mathbf{v})\\mathbf{F} \\mathbf{F}^{-1} \\right) \\tilde{\\mathbf{B}} + \\mathbf{F}^{-1} \\left( (\\nabla\\mathbf{v}) \\tilde{\\mathbf{B}} \\right) = -\\mathbf{F}^{-1}(\\nabla\\mathbf{v})\\tilde{\\mathbf{B}} + \\mathbf{F}^{-1}(\\nabla\\mathbf{v})\\tilde{\\mathbf{B}} = \\mathbf{0}\n$$\n因此，$ \\mathbf{C}(\\mathbf{a}, t) $ 在时间上是常数。我们可以在 $ t=0 $ 时对其进行评估：\n$$\n\\mathbf{C}(\\mathbf{a}, t) = \\mathbf{C}(\\mathbf{a}, 0) = \\mathbf{F}^{-1}(\\mathbf{a}, 0) \\tilde{\\mathbf{B}}(\\mathbf{a}, 0)\n$$\n在 $ t=0 $ 时，$ \\mathbf{x}=\\mathbf{a} $，所以形变梯度是单位矩阵，$ \\mathbf{F}(\\mathbf{a}, 0) = \\mathbf{I} $，且 $ \\tilde{\\mathbf{B}}(\\mathbf{a}, 0) = \\mathbf{B}(\\mathbf{a}, 0) \\equiv \\mathbf{B}_0(\\mathbf{a}) $。\n因此，$ \\mathbf{C}(\\mathbf{a}, t) = \\mathbf{I}^{-1} \\mathbf{B}_0(\\mathbf{a}) = \\mathbf{B}_0(\\mathbf{a}) $。\n\n从 $ \\mathbf{B}_0(\\mathbf{a}) = \\mathbf{F}^{-1}(\\mathbf{a}, t) \\tilde{\\mathbf{B}}(\\mathbf{a}, t) $，我们得到 $ \\tilde{\\mathbf{B}} $ 的解：\n$$\n\\tilde{\\mathbf{B}}(\\mathbf{a}, t) = \\mathbf{F}(\\mathbf{a}, t) \\mathbf{B}_0(\\mathbf{a})\n$$\n转换回欧拉坐标 $ (\\mathbf{x}, t) $，其中 $ \\mathbf{a} = \\mathbf{\\Phi}^{-1}(\\mathbf{x}, t) $ 是所需的拉格朗日标签：\n$$\n\\mathbf{B}(\\mathbf{x}, t) = \\mathbf{F}(\\mathbf{\\Phi}^{-1}(\\mathbf{x}, t), t) \\cdot \\mathbf{B}_0(\\mathbf{\\Phi}^{-1}(\\mathbf{x}, t))\n$$\n这是在冻结条件下演化磁场的解析表达式，从指定的基本定律和假设推导得出。\n\n### 第2部分：应用于线性剪切流\n\n我们现在将这个一般结果应用于指定的二维线性剪切流 $ \\mathbf{v}(x, y) = (\\gamma y, 0) $。\n通过积分 $ \\frac{d\\mathbf{x}}{dt} = \\mathbf{v}(\\mathbf{x}) $，初始条件为 $ \\mathbf{x}(0) = \\mathbf{a} = (a_x, a_y) $，可以找到流体微元的轨迹。\n$$\n\\frac{dx}{dt} = \\gamma y \\quad ; \\quad \\frac{dy}{dt} = 0\n$$\n对第二个方程积分得到 $ y(t) = a_y $。将此代入第一个方程得到 $ \\frac{dx}{dt} = \\gamma a_y $，积分后得到 $ x(t) = a_x + \\gamma t a_y $。\n流映射为 $ \\mathbf{x}(\\mathbf{a}, t) = (a_x + \\gamma t a_y, a_y) $。\n\n通过对给定的 $ \\mathbf{x}=(x,y) $ 求解 $ \\mathbf{a} $，可以找到逆流映射 $ \\mathbf{a}(\\mathbf{x}, t) $：\n$$\na_y = y \\quad ; \\quad a_x = x - \\gamma t a_y = x - \\gamma t y\n$$\n形变梯度张量 $ F_{ij} = \\frac{\\partial x_i}{\\partial a_j} $ 为：\n$$\n\\mathbf{F}(\\mathbf{a}, t) = \\begin{pmatrix} \\frac{\\partial x}{\\partial a_x} & \\frac{\\partial x}{\\partial a_y} \\\\ \\frac{\\partial y}{\\partial a_x} & \\frac{\\partial y}{\\partial a_y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial a_x}(a_x + \\gamma t a_y) & \\frac{\\partial}{\\partial a_y}(a_x + \\gamma t a_y) \\\\ \\frac{\\partial}{\\partial a_x}(a_y) & \\frac{\\partial}{\\partial a_y}(a_y) \\end{pmatrix} = \\begin{pmatrix} 1 & \\gamma t \\\\ 0 & 1 \\end{pmatrix}\n$$\n注意 $ \\mathbf{F} $ 与位置 $ \\mathbf{a} $ 无关。解析正确的演化场为：\n$$\n\\mathbf{B}^{\\mathrm{analytic}}(\\mathbf{x}, t) = \\begin{pmatrix} 1 & \\gamma t \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} B_{0x}(a_x, a_y) \\\\ B_{0y}(a_x, a_y) \\end{pmatrix}\n$$\n其中 $ (a_x, a_y) = (x - \\gamma t y, y) $。以分量形式表示：\n$$\nB_x^{\\mathrm{analytic}}(x, y, t) = B_{0x}(x - \\gamma t y, y) + \\gamma t \\, B_{0y}(x - \\gamma t y, y)\n$$\n$$\nB_y^{\\mathrm{analytic}}(x, y, t) = B_{0y}(x - \\gamma t y, y)\n$$\n\n### 第3部分：朴素被动平流模型\n\n朴素模型将磁场的每个分量 $ B_x $ 和 $ B_y $ 视为独立的被动标量。被动标量 $ S $ 的演化由 $ \\frac{DS}{Dt} = \\partial_t S + (\\mathbf{v} \\cdot \\nabla)S = 0 $ 给出。这意味着标量值只是沿着流轨迹平流，即 $ S(\\mathbf{x}, t) = S_0(\\mathbf{a}) $，其中 $ S_0 $ 是初始条件，$ \\mathbf{a} = \\mathbf{\\Phi}^{-1}(\\mathbf{x}, t) $。\n将此应用于 $ B_x $ 和 $ B_y $：\n$$\nB_x^{\\mathrm{naive}}(x, y, t) = B_{0x}(a_x, a_y) = B_{0x}(x - \\gamma t y, y)\n$$\n$$\nB_y^{\\mathrm{naive}}(x, y, t) = B_{0y}(a_x, a_y) = B_{0y}(x - \\gamma t y, y)\n$$\n该模型错误地忽略了 $ B_x $ 分量中的拉伸项 $ \\gamma t \\, B_{0y} $，该项是由于垂直磁场分量被剪切成水平分量而产生的。\n\n### 第4部分：数值实现计划\n\n计算任务是在离散网格上评估解析模型和朴素模型之间的相对 $ L^2 $ 误差。\n\n1.  **网格设置：** 在域 $ [0, L) \\times [0, L) $ 上定义一个 $ N \\times N $ 个点 $ (x_i, y_j) $ 的均匀笛卡尔网格。坐标为 $ x_i = i L/N $ 和 $ y_j = j L/N $，其中 $ i, j \\in \\{0, 1, ..., N-1\\} $。\n\n2.  **评估循环：** 对于每个网格点 $ (x_i, y_j) $：\n    a. 计算拉格朗日坐标：$ a_x = x_i - \\gamma t y_j $ 和 $ a_y = y_j $。\n    b. 对拉格朗日坐标应用周期性边界条件。初始条件以 $ L $ 为周期，因此我们在 $ a_x^{\\mathrm{p}} = a_x \\pmod L $ 和 $ a_y^{\\mathrm{p}} = a_y \\pmod L $ 处对其进行评估。\n    c. 使用指定函数为均匀或正弦情况评估初始磁场分量 $ B_{0x}(a_x^{\\mathrm{p}}, a_y^{\\mathrm{p}}) $ 和 $ B_{0y}(a_x^{\\mathrm{p}}, a_y^{\\mathrm{p}}) $。\n    d. 在 $ (x_i, y_j, t) $ 计算解析场分量：$ B_x^{\\mathrm{analytic}} = B_{0x} + \\gamma t B_{0y} $ 和 $ B_y^{\\mathrm{analytic}} = B_{0y} $。\n    e. 计算朴素场分量：$ B_x^{\\mathrm{naive}} = B_{0x} $ 和 $ B_y^{\\mathrm{naive}} = B_{0y} $。\n\n3.  **误差计算：** 在整个网格上计算场分量后，相对 $ L^2 $ 误差 $ \\varepsilon $ 按以下方式计算：\n    $$\n    \\varepsilon = \\sqrt{\\frac{\\sum_{i,j=0}^{N-1} \\left( [B_x^{\\mathrm{naive}} - B_x^{\\mathrm{analytic}}]^2 + [B_y^{\\mathrm{naive}} - B_y^{\\mathrm{analytic}}]^2 \\right) }{\\sum_{i,j=0}^{N-1} \\left( [B_x^{\\mathrm{analytic}}]^2 + [B_y^{\\mathrm{analytic}}]^2 \\right)}}\n    $$\n    分子中的差简化为：\n    $ [B_x^{\\mathrm{naive}} - B_x^{\\mathrm{analytic}}]^2 = [B_{0x} - (B_{0x} + \\gamma t B_{0y})]^2 = (-\\gamma t B_{0y})^2 $。\n    $ [B_y^{\\mathrm{naive}} - B_y^{\\mathrm{analytic}}]^2 = [B_{0y} - B_{0y}]^2 = 0 $。\n    分子和为 $ \\sum_{i,j} (\\gamma t B_{0y})^2 $。分母是解析场分量的平方和，$ \\sum_{i,j} ( (B_{0x} + \\gamma t B_{0y})^2 + B_{0y}^2 ) $。实现将计算这些和，并求其比值的平方根。分母为零（例如 $ \\mathbf{B}_0 = \\mathbf{0} $）导致未定义误差的特殊情况在测试套件中不存在。对于 $t=0$ 或 $\\gamma=0$ 的情况，分子为零，从而得到 $\\varepsilon=0$。\n将为提供的每个测试用例实现此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative L2 error between a naive passive-advection model and the\n    analytically correct frozen-in evolution of a magnetic field in a shear flow.\n    \"\"\"\n\n    def calculate_error(L, N, gamma, t, B_star, k, initial_field_type):\n        \"\"\"\n        Calculates the relative L2 error for a single test case.\n\n        Args:\n            L (float): Domain side length [m].\n            N (int): Number of grid points per dimension.\n            gamma (float): Shear rate [s^-1].\n            t (float): Time [s].\n            B_star (float): Magnetic field amplitude [T].\n            k (float): Wavenumber [rad/m].\n            initial_field_type (str): 'uniform' or 'sinusoidal'.\n\n        Returns:\n            float: The relative L2 error.\n        \"\"\"\n        # 1. Set up the grid\n        grid_coords = np.linspace(0, L, N, endpoint=False)\n        x, y = np.meshgrid(grid_coords, grid_coords)\n\n        # 2. Compute Lagrangian coordinates (inverse flow map)\n        a_x = x - gamma * t * y\n        a_y = y\n\n        # 3. Apply periodic boundary conditions to Lagrangian coordinates\n        a_x_periodic = a_x % L\n        a_y_periodic = a_y % L\n\n        # 4. Evaluate initial magnetic field B0 at Lagrangian coordinates\n        if initial_field_type == 'uniform':\n            B_0x = np.zeros_like(a_x_periodic)\n            B_0y = np.full_like(a_y_periodic, B_star)\n        elif initial_field_type == 'sinusoidal':\n            B_0x = B_star * np.sin(k * a_x_periodic) * np.cos(k * a_y_periodic)\n            B_0y = -B_star * np.cos(k * a_x_periodic) * np.sin(k * a_y_periodic)\n        else:\n            raise ValueError(\"Invalid initial_field_type\")\n\n        # 5. Compute analytic and naive field components\n        # Analytic field (frozen-in pushforward)\n        B_x_analytic = B_0x + gamma * t * B_0y\n        B_y_analytic = B_0y\n\n        # Naive field (passive scalar advection)\n        B_x_naive = B_0x\n        B_y_naive = B_0y\n\n        # 6. Calculate L2 error\n        # Numerator: sum of squared differences\n        diff_sq_sum = np.sum((B_x_naive - B_x_analytic)**2 + (B_y_naive - B_y_analytic)**2)\n\n        # Denominator: sum of squared analytic field components\n        analytic_norm_sq_sum = np.sum(B_x_analytic**2 + B_y_analytic**2)\n\n        if analytic_norm_sq_sum == 0.0:\n            # This can happen if the initial field is zero everywhere.\n            # If the difference is also zero, the error is 0. Otherwise it's undefined (inf).\n            return 0.0 if diff_sq_sum == 0.0 else np.inf\n\n        error = np.sqrt(diff_sq_sum / analytic_norm_sq_sum)\n        return error\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case A: uniform field\n        {'L': 1.0, 'N': 128, 'gamma': 1.0, 't': 0.3, 'B_star': 0.7, 'k': 0.0, 'type': 'uniform'},\n        # Case B: sinusoidal field\n        {'L': 1.0, 'N': 128, 'gamma': 0.6, 't': 0.5, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n        # Case C: sinusoidal field at t=0\n        {'L': 1.0, 'N': 128, 'gamma': 0.6, 't': 0.0, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n        # Case D: sinusoidal field with gamma=0\n        {'L': 1.0, 'N': 128, 'gamma': 0.0, 't': 0.5, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n    ]\n\n    results = []\n    for case in test_cases:\n        error = calculate_error(\n            L=case['L'],\n            N=case['N'],\n            gamma=case['gamma'],\n            t=case['t'],\n            B_star=case['B_star'],\n            k=case['k'],\n            initial_field_type=case['type']\n        )\n        results.append(error)\n\n    # Format the final output string as required\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}