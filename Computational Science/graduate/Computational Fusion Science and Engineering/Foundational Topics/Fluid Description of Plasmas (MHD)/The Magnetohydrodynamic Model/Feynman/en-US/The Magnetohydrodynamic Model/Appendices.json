{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex simulations, a crucial first step in computational plasma physics is to characterize the system using fundamental dimensionless parameters. This practice guides you through calculating the plasma beta ($\\beta$), Alfvén speed ($v_A$), and Lundquist number ($S$) for a typical tokamak scenario. These values provide a vital \"zeroth-order\" understanding of the plasma, indicating whether its dynamics are dominated by thermal pressure or the magnetic field, and how closely it adheres to the ideal MHD limit .",
            "id": "4053886",
            "problem": "A toroidal magnetically confined plasma in a tokamak is modeled by resistive Magnetohydrodynamics (MHD), assuming a uniform scalar resistivity. Consider a homogeneous plasma with magnetic field magnitude $B=5\\,\\mathrm{T}$, number density $n=10^{20}\\,\\mathrm{m}^{-3}$, electron and ion temperatures equal to $T=10\\,\\mathrm{keV}$, and characteristic macroscopic length scale $L=1\\,\\mathrm{m}$. Assume a singly ionized hydrogen plasma with ion mass $m_i=m_p$ and quasi-neutrality so that $n_e=n_i=n$. Neglect electron mass in the mass density. Using first-principles definitions from MHD and Maxwell’s equations, do the following:\n\n- Starting from the definition of thermal pressure and magnetic energy density, derive the plasma beta $\\beta$ and evaluate it for the given parameters.\n- Starting from the MHD wave dynamics, derive the Alfvén speed $v_A$ and evaluate it for the given parameters.\n- Using the resistive MHD induction equation to identify characteristic Alfvén and resistive diffusion timescales, derive the Lundquist number $S$ and evaluate it for the given parameters.\n- Briefly explain, based on your computed $S$, the qualitative expectation for magnetic reconnection dynamics in such a tokamak plasma.\n\nUse the following physical constants as needed: the permeability of free space $\\mu_0=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$, the elementary charge $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$, and the proton mass $m_p=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$. Treat the given temperature as an energy per particle via $k_B T = e\\,T_{\\mathrm{eV}}$, where $T_{\\mathrm{eV}}$ is the temperature in electronvolts. The resistivity is $\\eta=10^{-6}\\,\\Omega\\,\\mathrm{m}$.\n\nReport your final numerical results for $\\beta$, $v_A$, and $S$ in that order. Round each quantity to three significant figures. Express $v_A$ in $\\mathrm{m/s}$. Your final answer must be a single row vector containing the three numbers, with no units.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained, with all necessary parameters provided for the derivation and calculation of the requested physical quantities within the framework of resistive Magnetohydrodynamics (MHD).\n\nThe solution proceeds by deriving and evaluating the plasma beta ($\\beta$), the Alfvén speed ($v_A$), and the Lundquist number ($S$).\n\n**1. Plasma Beta ($\\beta$)**\n\nThe plasma beta, $\\beta$, is defined as the ratio of the plasma's thermal pressure, $P$, to the magnetic pressure, $P_{mag}$.\n$$\n\\beta = \\frac{P}{P_{mag}}\n$$\nThe thermal pressure of a two-species plasma is the sum of the electron and ion pressures, $P = P_e + P_i$. Using the ideal gas law for each species, we have $P_e = n_e k_B T_e$ and $P_i = n_i k_B T_i$. The problem states that the plasma is quasi-neutral ($n_e = n_i = n$) and in thermal equilibrium ($T_e = T_i = T$). Therefore, the total thermal pressure is:\n$$\nP = n k_B T + n k_B T = 2 n k_B T\n$$\nThe magnetic pressure is the energy density of the magnetic field:\n$$\nP_{mag} = \\frac{B^2}{2\\mu_0}\n$$\nSubstituting these expressions into the definition of $\\beta$ gives:\n$$\n\\beta = \\frac{2 n k_B T}{B^2 / (2\\mu_0)} = \\frac{4 n \\mu_0 k_B T}{B^2}\n$$\nThe temperature is given in units of kilo-electronvolts ($keV$). We convert this to energy in Joules using the provided relation $k_B T = e T_{\\mathrm{eV}}$. With $T = 10\\,\\mathrm{keV} = 10^4\\,\\mathrm{eV}$:\n$$\nk_B T = (1.602176634\\times 10^{-19}\\,\\mathrm{C}) \\times (10^4\\,\\mathrm{V}) = 1.602176634\\times 10^{-15}\\,\\mathrm{J}\n$$\nNow, we substitute the given numerical values:\n- $n = 10^{20}\\,\\mathrm{m}^{-3}$\n- $\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$\n- $B = 5\\,\\mathrm{T}$\n- $k_B T = 1.602176634\\times 10^{-15}\\,\\mathrm{J}$\n\n$$\n\\beta = \\frac{4 (10^{20}\\,\\mathrm{m}^{-3}) (4\\pi\\times 10^{-7}\\,\\mathrm{H/m}) (1.602176634\\times 10^{-15}\\,\\mathrm{J})}{(5\\,\\mathrm{T})^2}\n$$\n$$\n\\beta = \\frac{4 \\times 10^{20} \\times 4\\pi \\times 10^{-7} \\times 1.602176634 \\times 10^{-15}}{25} \\approx 0.032214\n$$\nRounding to three significant figures, $\\beta \\approx 0.0322$.\n\n**2. Alfvén Speed ($v_A$)**\n\nThe Alfvén speed, $v_A$, is the characteristic propagation speed of transverse waves along magnetic field lines. It is derived from the ideal MHD equations and is given by:\n$$\nv_A = \\frac{B}{\\sqrt{\\mu_0 \\rho_m}}\n$$\nwhere $\\rho_m$ is the plasma mass density. The problem specifies a singly ionized hydrogen plasma and instructs to neglect the electron mass. Thus, the mass density is determined by the ions:\n$$\n\\rho_m = n_i m_i + n_e m_e \\approx n_i m_i\n$$\nWith $n_i = n$ and $m_i = m_p$ (proton mass), the mass density is:\n$$\n\\rho_m = n m_p\n$$\nSubstituting the given values:\n- $n = 10^{20}\\,\\mathrm{m}^{-3}$\n- $m_p = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$\n$$\n\\rho_m = (10^{20}\\,\\mathrm{m}^{-3}) \\times (1.67262192369\\times 10^{-27}\\,\\mathrm{kg}) \\approx 1.67262\\times 10^{-7}\\,\\mathrm{kg/m^3}\n$$\nNow we can calculate the Alfvén speed:\n- $B = 5\\,\\mathrm{T}$\n- $\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$\n$$\nv_A = \\frac{5\\,\\mathrm{T}}{\\sqrt{(4\\pi\\times 10^{-7}\\,\\mathrm{H/m}) \\times (1.67262\\times 10^{-7}\\,\\mathrm{kg/m^3})}}\n$$\n$$\nv_A \\approx \\frac{5}{\\sqrt{2.1018\\times 10^{-13}}} \\approx 1.0906\\times 10^7\\,\\mathrm{m/s}\n$$\nRounding to three significant figures, $v_A \\approx 1.09 \\times 10^7\\,\\mathrm{m/s}$.\n\n**3. Lundquist Number ($S$)**\n\nThe Lundquist number, $S$, is a dimensionless quantity representing the ratio of the resistive magnetic diffusion time, $\\tau_R$, to the Alfvén transit time, $\\tau_A$.\n$$\nS = \\frac{\\tau_R}{\\tau_A}\n$$\nThe resistive diffusion time is derived from the resistive term in the induction equation, $\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B} - \\eta \\mathbf{J})$. Using $\\mathbf{J} \\approx \\frac{1}{\\mu_0}\\nabla\\times\\mathbf{B}$ and dimensional analysis, the diffusion timescale over a length $L$ is:\n$$\n\\tau_R = \\frac{\\mu_0 L^2}{\\eta}\n$$\nThe Alfvén transit time is the time for an Alfvén wave to travel the characteristic distance $L$:\n$$\n\\tau_A = \\frac{L}{v_A}\n$$\nCombining these gives the expression for the Lundquist number:\n$$\nS = \\frac{\\mu_0 L^2 / \\eta}{L / v_A} = \\frac{\\mu_0 L v_A}{\\eta}\n$$\nWe substitute the given and previously calculated values:\n- $\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$\n- $L = 1\\,\\mathrm{m}$\n- $v_A \\approx 1.0906\\times 10^7\\,\\mathrm{m/s}$ (using the unrounded value)\n- $\\eta = 10^{-6}\\,\\Omega\\,\\mathrm{m}$\n$$\nS = \\frac{(4\\pi\\times 10^{-7}\\,\\mathrm{H/m}) (1\\,\\mathrm{m}) (1.0906\\times 10^7\\,\\mathrm{m/s})}{10^{-6}\\,\\Omega\\,\\mathrm{m}}\n$$\n$$\nS \\approx \\frac{1.3704\\times 10^1}{10^{-6}} \\approx 1.3704\\times 10^7\n$$\nRounding to three significant figures, $S \\approx 1.37 \\times 10^7$.\n\n**4. Role of $S$ in Magnetic Reconnection**\n\nThe Lundquist number $S$ quantifies the degree to which a plasma is \"ideal\". It compares the rate of magnetic field advection with the plasma flow to the rate of resistive diffusion. Our calculated value of $S \\approx 1.37 \\times 10^7$ is very large. This signifies that magnetic diffusion is extremely slow compared to the dynamic (Alfvénic) timescale of the plasma.\n\nQualitatively, this means the magnetic field is \"frozen-in\" to the plasma fluid almost everywhere. Magnetic reconnection, the process that allows for a change in magnetic field topology, is suppressed in ideal MHD ($S \\to \\infty$). In resistive MHD, reconnection can occur, but for such a large $S$, classical reconnection theories (like the Sweet-Parker model) predict it to be a very slow process. However, the high value of $S$ is a prerequisite for the formation of very thin current sheets where the assumptions of classical models may break down and \"fast\" reconnection can be triggered. In a tokamak, such a high $S$ implies the general magnetic configuration is stable against resistive tearing modes, but it can still allow for rapid, localized reconnection events that are implicated in instabilities like sawtooth oscillations and Edge Localized Modes (ELMs).",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.0322 & 1.09 \\times 10^7 & 1.37 \\times 10^7\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The Magnetohydrodynamic model, while powerful, rests on a set of assumptions that can break down under certain conditions. This exercise explores the limits of single-fluid resistive MHD by examining the process of magnetic reconnection. By deriving the scaling of the reconnection layer and comparing it to the ion skin depth ($d_i$), you will determine the critical Lundquist number ($S_c$) where two-fluid (Hall) effects become important, a pivotal concept for understanding fast reconnection phenomena observed in fusion devices .",
            "id": "4053912",
            "problem": "A planar, collisionally dominated current sheet forms in a magnetized plasma representative of a toroidal fusion device. The plasma dynamics are modeled using the single-fluid Magnetohydrodynamics (MHD) framework derived from the momentum conservation of ions and electrons, Faraday’s law, Ampère’s law, and a generalized Ohm’s law. In resistive MHD, the electric field is governed by the simplified Ohm’s law $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta\\,\\mathbf{J}$, where $\\eta$ is the scalar resistivity, $\\mathbf{v}$ is the bulk plasma velocity, $\\mathbf{B}$ is the magnetic field, and $\\mathbf{J}$ is the current density. In Hall-MHD, the generalized Ohm’s law includes the Hall term $(\\mathbf{J} \\times \\mathbf{B})/(n e)$, where $n$ is the electron number density and $e$ is the elementary charge, which becomes dynamically important when ions decouple from the magnetic field on scales comparable to the ion skin depth.\n\nUsing first-principles scaling arguments based on:\n- Faraday’s law and the induction equation,\n- Mass continuity across the reconnection layer,\n- The definition of the Alfvén speed $V_{A} = B/\\sqrt{\\mu_{0}\\rho}$, where $\\mu_{0}$ is the vacuum permeability and $\\rho$ is the mass density,\n- The definition of the Lundquist number $S \\equiv \\mu_{0} L V_{A}/\\eta$ for a layer of half-length $L$,\n- The physical meaning of the ion skin depth $d_{i}$ as the characteristic scale below which ion inertia causes decoupling from magnetic field lines,\n\nderive the scaling for the resistive reconnection layer thickness and determine the criterion for onset of Hall-dominated effects by equating the resistive layer thickness to $d_{i}$. Then, for a system of size $L = 0.1\\,\\mathrm{m}$ with ion skin depth $d_{i} = 0.01\\,\\mathrm{m}$, compute the critical Lundquist number $S_{c}$ above which Hall effects are expected to alter reconnection rates relative to resistive MHD.\n\nProvide the final answer as the single dimensionless number $S_{c}$. No rounding is necessary. Do not include any units in the final answer.",
            "solution": "The problem requires the derivation of the resistive reconnection layer thickness scaling and the calculation of a critical Lundquist number, $S_{c}$, for the onset of Hall-MHD effects. The derivation is based on scaling arguments in the context of the Sweet-Parker model of magnetic reconnection.\n\nLet us model the planar current sheet as a rectangular region of half-length $L$ and half-thickness $\\delta$. The magnetic field, with magnitude $B$, is carried into the layer by a plasma inflow velocity $v_{in}$, and the reconnected plasma is ejected from the ends of the layer with an outflow velocity $v_{out}$.\n\nFirst, we apply the principle of mass conservation in a steady state. The rate of mass flowing into the layer must equal the rate of mass flowing out. Considering a two-dimensional slab of unit depth, the mass inflow rate is $\\rho (2L) v_{in}$ and the mass outflow rate is $\\rho (2\\delta) v_{out}$, where $\\rho$ is the plasma mass density. Equating these gives:\n$$\n\\rho L v_{in} = \\rho \\delta v_{out}\n$$\nThis simplifies to a relationship between the velocities and the aspect ratio of the layer:\n$$\n\\frac{v_{in}}{v_{out}} = \\frac{\\delta}{L}\n$$\n\nNext, we determine the outflow velocity $v_{out}$. The outflow is driven by the magnetic pressure gradient along the layer. The magnetic energy density upstream of the layer, $B^2/(2\\mu_0)$, is converted into the kinetic energy density of the outflow jet, $\\rho v_{out}^2/2$. By equating these energies, we find that the outflow speed is approximately the Alfvén speed, $V_A$:\n$$\n\\frac{1}{2} \\rho v_{out}^2 \\approx \\frac{B^2}{2\\mu_0} \\implies v_{out} \\approx \\sqrt{\\frac{B^2}{\\mu_0 \\rho}} = V_A\n$$\nSubstituting $v_{out} = V_A$ into the mass conservation result yields an expression for the normalized inflow velocity, which is the reconnection rate:\n$$\n\\frac{v_{in}}{V_A} = \\frac{\\delta}{L} \\label{eq:1} \\tag{1}\n$$\n\nNow, we use the resistive Ohm's law, $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}$, combined with Faraday's law in steady state. In steady state ($\\partial \\mathbf{B} / \\partial t = 0$), Faraday's law, $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B} / \\partial t$, implies $\\nabla \\times \\mathbf{E} = 0$. In our two-dimensional geometry, this means the out-of-plane electric field $E$ must be spatially uniform.\nFar outside the resistive layer, the plasma is highly conductive ($\\eta \\approx 0$), and Ohm's law reduces to the ideal condition $\\mathbf{E} \\approx -\\mathbf{v} \\times \\mathbf{B}$. The magnitude of the electric field is thus set by the inflow conditions: $E \\approx v_{in} B$.\nInside the reconnection layer, the plasma is assumed to be nearly stationary, so the convective term $\\mathbf{v} \\times \\mathbf{B}$ is small, and the electric field is balanced by the resistive term: $E \\approx \\eta J$.\nFrom Ampère's law, $\\mu_0 \\mathbf{J} = \\nabla \\times \\mathbf{B}$, we can estimate the current density $J$ inside the layer. The magnetic field reverses its sign over the thickness $2\\delta$, so the curl can be approximated as $|\\nabla \\times \\mathbf{B}| \\approx B/\\delta$. This gives a current density of $J \\approx B/(\\mu_0 \\delta)$.\nSubstituting this into the resistive balance $E \\approx \\eta J$, we get $E \\approx \\eta B / (\\mu_0 \\delta)$.\nBy equating the two expressions for the uniform electric field $E$, we find a second relationship for the inflow velocity:\n$$\nv_{in} B \\approx \\frac{\\eta B}{\\mu_0 \\delta} \\implies v_{in} \\approx \\frac{\\eta}{\\mu_0 \\delta} \\label{eq:2} \\tag{2}\n$$\n\nWe now have two independent expressions for $v_{in}$, from Eq. \\eqref{eq:1} (via mass conservation) and Eq. \\eqref{eq:2} (via Ohm's law). We can equate them to solve for the layer half-thickness $\\delta$:\n$$\nV_A \\frac{\\delta}{L} \\approx \\frac{\\eta}{\\mu_0 \\delta}\n$$\nSolving for $\\delta^2$ gives:\n$$\n\\delta^2 \\approx \\frac{\\eta L}{\\mu_0 V_A}\n$$\nThe problem defines the Lundquist number as $S \\equiv \\mu_0 L V_A / \\eta$. We can rewrite the expression for $\\delta^2$ in terms of $S$:\n$$\n\\delta^2 \\approx L^2 \\left( \\frac{\\eta}{\\mu_0 L V_A} \\right) = \\frac{L^2}{S}\n$$\nTaking the square root gives the scaling for the resistive reconnection layer half-thickness:\n$$\n\\delta \\approx L S^{-1/2}\n$$\n\nThe problem states that Hall-MHD effects become important when the characteristic scale of the resistive layer, $\\delta$, becomes comparable to the ion skin depth, $d_i$. The ion skin depth is the scale at which ion dynamics decouple from the magnetic field, and the Hall term $(\\mathbf{J} \\times \\mathbf{B})/(n e)$ in the generalized Ohm's law becomes significant. The onset of Hall-dominated reconnection occurs at a critical Lundquist number, $S_c$, where $\\delta = d_i$.\n\nUsing our derived scaling for $\\delta$, we set up the criterion for the onset of Hall effects:\n$$\nL S_c^{-1/2} = d_i\n$$\nWe solve this equation for the critical Lundquist number, $S_c$:\n$$\nS_c^{1/2} = \\frac{L}{d_i}\n$$\n$$\nS_c = \\left(\\frac{L}{d_i}\\right)^2\n$$\n\nFinally, we substitute the numerical values provided in the problem statement: the system size $L = 0.1\\,\\mathrm{m}$ and the ion skin depth $d_i = 0.01\\,\\mathrm{m}$.\n$$\n\\frac{L}{d_i} = \\frac{0.1}{0.01} = 10\n$$\nPlugging this ratio into the expression for $S_c$:\n$$\nS_c = (10)^2 = 100\n$$\nThus, for a Lundquist number greater than approximately $100$, the reconnection dynamics in this system are expected to be significantly altered by Hall effects, leading to a departure from the predictions of purely resistive MHD.",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "The ultimate goal of computational science is to build reliable numerical tools. This practice bridges the gap between analytic theory and computational implementation through the Method of Manufactured Solutions (MMS), a cornerstone of code verification. You will first derive the exact solution for a shear-Alfvén wave and then use it to rigorously test a numerical solver, quantifying its convergence and ensuring the code correctly represents the underlying physics of ideal MHD .",
            "id": "4053914",
            "problem": "Consider the ideal magnetohydrodynamics model for a single-fluid, electrically conducting plasma, specialized to a one-dimensional, homogeneous, shear-Alfvén wave propagating along a uniform magnetic field. Begin from first principles for ideal magnetohydrodynamics: conservation of momentum, the induction equation, solenoidality of the magnetic field, and the incompressibility constraint. Assume a uniform equilibrium with constant mass density $\\rho_0$, uniform background magnetic field $\\mathbf{B}_0$ aligned with the $x$-axis, and zero equilibrium flow. Linearize the governing equations about this equilibrium and derive the analytical solution for a small-amplitude, linearly polarized, shear-Alfvén wave using appropriate boundary conditions on a periodic domain.\n\nAfter rigorously deriving the analytical solution, use it as a manufactured solution for verification of spatial and temporal convergence of a numerical solver. Implement a second-order accurate finite difference scheme in space (using second-order centered differences with periodic boundaries) and a second-order explicit Runge–Kutta time integrator (the midpoint method). Use the derived analytical solution as the manufactured solution to compute discrete errors at a specified final time and quantify observed orders of convergence.\n\nScientific and numerical setup:\n\n- Domain length is $L = 1\\,\\mathrm{m}$, with periodic boundary conditions.\n- Angle units must be in radians.\n- Physical parameters: $\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$, $\\rho_0 = 1\\,\\mathrm{kg/m^3}$, background field magnitude $B_0 = v_A\\sqrt{\\mu_0\\rho_0}$ with prescribed Alfvén speed $v_A = 1\\,\\mathrm{m/s}$.\n- Wavenumber $k = 2\\pi/L\\,\\mathrm{rad/m}$ and angular frequency $\\omega = v_A k\\,\\mathrm{rad/s}$. The fundamental period is $T = 2\\pi/\\omega = L/v_A\\,\\mathrm{s}$.\n- Manufactured wave amplitude $A = 1\\,\\mathrm{m/s}$ for the velocity component.\n\nNumerical method specifications:\n\n- Spatial discretization uses $N$ equally spaced points over $[0,L)$, grid spacing $\\Delta x = L/N$, and second-order periodic centered differences to approximate $\\partial_x$.\n- Temporal discretization uses the explicit second-order Runge–Kutta (midpoint) method with a time step $\\Delta t$, and the number of steps chosen so that the final time is exactly $T$.\n- The solver advances the coupled linearized shear-Alfvén system for the transverse pair $v_y(x,t)$ and $b_y(x,t)$ from the manufactured initial condition at $t=0$ to $t=T$. The discrete $L^2$ error at $t=T$ is computed as the root-mean-square norm over the grid of the difference between the numerical solution and the analytical manufactured solution for both fields aggregated as a single norm.\n\nTest suite and output requirements:\n\n1. Spatial convergence study:\n   - Use $N \\in \\{50, 100, 200, 400\\}$.\n   - For each $N$, set the Courant number $C = 0.2$ so that $\\Delta t = C\\,\\Delta x / v_A$.\n   - Compute the discrete $L^2$ error at $t=T$ for each $N$, and estimate the observed spatial order $p_s$ by linear regression of $\\log(e)$ versus $\\log(\\Delta x)$. Also check whether the error is strictly decreasing as $N$ increases (equivalently, as $\\Delta x$ decreases), producing a boolean.\n\n2. Temporal convergence study:\n   - Fix $N = 400$.\n   - Use Courant numbers $C \\in \\{0.2, 0.1, 0.05, 0.025\\}$ so that $\\Delta t = C\\,\\Delta x / v_A$.\n   - Compute the discrete $L^2$ error at $t=T$ for each $C$, and estimate the observed temporal order $p_t$ by linear regression of $\\log(e)$ versus $\\log(\\Delta t)$. Also check whether the error is strictly decreasing as $\\Delta t$ decreases, producing a boolean.\n\nUnits and answer specification:\n\n- All physical quantities in the solver must be handled with consistent SI units: meters ($\\mathrm{m}$), seconds ($\\mathrm{s}$), tesla ($\\mathrm{T}$), henry per meter ($\\mathrm{H/m}$), and kilograms per cubic meter ($\\mathrm{kg/m^3}$).\n- The final outputs are dimensionless convergence rates and boolean monotonicity indicators.\n- Your program must produce a single line of output containing the results aggregated in the following format: a comma-separated list enclosed in square brackets $[p_s, p_t, `is_space_monotonic`, `is_time_monotonic`]$, where $p_s$ and $p_t$ are floating-point values and the monotonicity indicators are booleans.\n\nYour implementation must be self-contained and must not require any user input. It must use only the specified runtime environment. The program should take the test suite specified above and print the final single-line result in the exact format described.",
            "solution": "The problem requires the derivation of an analytical solution for a one-dimensional shear-Alfvén wave within the ideal magnetohydrodynamics (MHD) framework, and the subsequent use of this solution to verify a numerical solver via the method of manufactured solutions. The verification involves assessing the spatial and temporal convergence rates of a finite difference scheme.\n\n### Part 1: Derivation of the Analytical Solution\n\nWe begin from the fundamental equations of ideal, incompressible MHD for a single-fluid plasma:\n1.  Conservation of momentum:\n    $$ \\rho \\frac{D\\mathbf{v}}{Dt} = \\rho \\left(\\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v}\\right) = -\\nabla p + \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}) \\times \\mathbf{B} $$\n2.  Induction equation:\n    $$ \\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) $$\n3.  Incompressibility condition (constant density $\\rho$):\n    $$ \\nabla \\cdot \\mathbf{v} = 0 $$\n4.  Solenoidality of the magnetic field:\n    $$ \\nabla \\cdot \\mathbf{B} = 0 $$\nHere, $\\rho$ is the mass density, $\\mathbf{v}$ is the fluid velocity, $p$ is the pressure, $\\mathbf{B}$ is the magnetic field, and $\\mu_0$ is the permeability of free space.\n\nThe problem specifies a uniform equilibrium state characterized by:\n- Constant density: $\\rho = \\rho_0$\n- Uniform background magnetic field: $\\mathbf{B} = \\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$\n- Zero equilibrium flow: $\\mathbf{v} = \\mathbf{v}_0 = \\mathbf{0}$\n- Constant equilibrium pressure: $p = p_0$\n\nWe linearize the MHD equations by considering small perturbations about this equilibrium. We let $\\mathbf{v} = \\mathbf{v}_0 + \\mathbf{v}_1 = \\mathbf{v}_1$, $\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_1$, and $p = p_0 + p_1$, where the subscript '$1$' denotes small first-order quantities. Keeping only first-order terms, the equations become:\n\n- **Linearized Momentum Equation**:\n  $$ \\rho_0 \\frac{\\partial \\mathbf{v}_1}{\\partial t} = -\\nabla p_1 + \\frac{1}{\\mu_0}[(\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0 + (\\nabla \\times \\mathbf{B}_0) \\times \\mathbf{B}_1] $$\n  Since $\\mathbf{B}_0$ is uniform, $\\nabla \\times \\mathbf{B}_0 = \\mathbf{0}$. The equation simplifies to:\n  $$ \\rho_0 \\frac{\\partial \\mathbf{v}_1}{\\partial t} = -\\nabla p_1 + \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0 $$\n\n- **Linearized Induction Equation**:\n  $$ \\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0) $$\n  Using the vector identity $\\nabla \\times (\\mathbf{A} \\times \\mathbf{C}) = (\\mathbf{C} \\cdot \\nabla)\\mathbf{A} - (\\mathbf{A} \\cdot \\nabla)\\mathbf{C} + \\mathbf{A}(\\nabla \\cdot \\mathbf{C}) - \\mathbf{C}(\\nabla \\cdot \\mathbf{A})$, and noting that $\\mathbf{B}_0$ is constant ($\\nabla \\mathbf{B}_0 = 0$) and $\\nabla \\cdot \\mathbf{v}_1 = 0$, we get:\n  $$ \\frac{\\partial \\mathbf{B}_1}{\\partial t} = (\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{v}_1 = B_0 \\frac{\\partial \\mathbf{v}_1}{\\partial x} $$\n\nFor a one-dimensional wave propagating along the $x$-axis, all perturbed quantities are functions of $x$ and $t$ only, so $\\partial/\\partial y = 0$ and $\\partial/\\partial z = 0$.\nThe linearized constraints $\\nabla \\cdot \\mathbf{v}_1 = \\partial v_{1x}/\\partial x = 0$ and $\\nabla \\cdot \\mathbf{B}_1 = \\partial B_{1x}/\\partial x = 0$ imply that $v_{1x}$ and $B_{1x}$ are constant in space. For a periodic domain, any non-zero mean would be a background flow/field, so for wave perturbations, we take $v_{1x}=0$ and $B_{1x}=0$. The perturbations are purely transverse.\n\nThe linearized equations for the transverse components $(v_y, v_z, B_y, B_z)$ (dropping the subscript '1') are:\nFrom the induction equation:\n$$ \\frac{\\partial B_y}{\\partial t} = B_0 \\frac{\\partial v_y}{\\partial x} \\quad \\text{and} \\quad \\frac{\\partial B_z}{\\partial t} = B_0 \\frac{\\partial v_z}{\\partial x} $$\nFrom the momentum equation, the term $(\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0$ becomes $B_0 (\\partial_x B_y \\hat{\\mathbf{y}} + \\partial_x B_z \\hat{\\mathbf{z}})$, and the pressure gradient term $\\nabla p_1$ has no transverse components since $p_1$ is a function of $x$ and $t$ only. In fact, the $x$-component of the momentum equation, $\\rho_0 \\partial_t v_x = -\\partial_x p_1$, becomes $\\partial_x p_1 = 0$, so $p_1$ is uniform in space, and we can set the total pressure perturbation $p_{1,total} = p_1 + B_0 B_{1x}/\\mu_0 = 0$. The transverse momentum equations are:\n$$ \\rho_0 \\frac{\\partial v_y}{\\partial t} = \\frac{B_0}{\\mu_0} \\frac{\\partial B_y}{\\partial x} \\quad \\text{and} \\quad \\rho_0 \\frac{\\partial v_z}{\\partial t} = \\frac{B_0}{\\mu_0} \\frac{\\partial B_z}{\\partial x} $$\n\nWe focus on the linearly polarized wave in the $y$-direction. The system for $(v_y, B_y)$ is:\n$$ \\frac{\\partial v_y}{\\partial t} = \\frac{B_0}{\\mu_0 \\rho_0} \\frac{\\partial B_y}{\\partial x} \\quad \\text{and} \\quad \\frac{\\partial B_y}{\\partial t} = B_0 \\frac{\\partial v_y}{\\partial x} $$\nLet's introduce the Alfvén speed $v_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$ and a normalized magnetic field perturbation $b_y = B_y / \\sqrt{\\mu_0 \\rho_0}$ (which has units of velocity). The system simplifies to:\n$$ \\frac{\\partial v_y}{\\partial t} = v_A \\frac{\\partial b_y}{\\partial x} \\quad \\text{and} \\quad \\frac{\\partial b_y}{\\partial t} = v_A \\frac{\\partial v_y}{\\partial x} $$\nThese can be combined to form a standard wave equation, $\\partial_{tt}v_y = v_A^2 \\partial_{xx}v_y$. A traveling wave solution for $v_y$ is of the form $v_y(x,t) = f(kx \\pm \\omega t)$. We seek a solution with a given amplitude $A$, wavenumber $k$, and angular frequency $\\omega$. Let's select a forward-propagating wave:\n$$ v_y(x, t) = A \\cos(kx - \\omega t) $$\nSubstituting this into the second equation gives $\\partial_t b_y = v_A \\partial_x (A \\cos(kx - \\omega t)) = -v_A A k \\sin(kx - \\omega t)$.\nIntegrating with respect to time, $b_y = \\int -v_A A k \\sin(kx - \\omega t) dt = -\\frac{v_A A k}{\\omega} \\cos(kx - \\omega t)$.\nThe dispersion relation for shear-Alfvén waves is $\\omega = v_A k$. This simplifies the expression for $b_y$:\n$$ b_y(x, t) = -A \\cos(kx - \\omega t) $$\nThis solution also satisfies the first equation. Thus, the manufactured solution is:\n$$ v_y(x, t) = A \\cos(kx - \\omega t) $$\n$$ b_y(x, t) = -A \\cos(kx - \\omega t) $$\nWith the given parameters $A=1\\,\\mathrm{m/s}$, $L=1\\,\\mathrm{m}$, $v_A=1\\,\\mathrm{m/s}$, we have $k=2\\pi/L=2\\pi\\,\\mathrm{rad/m}$ and $\\omega=v_A k=2\\pi\\,\\mathrm{rad/s}$. The final time is one wave period $T=2\\pi/\\omega=1\\,\\mathrm{s}$. The specific manufactured solution is:\n$$ v_y(x, t) = \\cos(2\\pi x - 2\\pi t) $$\n$$ b_y(x, t) = -\\cos(2\\pi x - 2\\pi t) $$\nAt the final time $t=T=1$, the solution is $v_y(x, 1) = \\cos(2\\pi x - 2\\pi) = \\cos(2\\pi x)$ and $b_y(x, 1) = -\\cos(2\\pi x)$. This is identical to the initial condition at $t=0$.\n\n### Part 2: Numerical Method and Verification\n\nThe numerical scheme solves the system $\\partial_t \\mathbf{U} = \\mathcal{L}(\\mathbf{U})$ where $\\mathbf{U} = [v_y, b_y]^T$ and $\\mathcal{L}$ is the spatial operator matrix involving $v_A \\partial_x$.\n\n- **Spatial Discretization**: A uniform grid with $N$ points $x_i = i \\Delta x$ for $i=0, \\dots, N-1$ and spacing $\\Delta x=L/N$ is used. The spatial derivative $\\partial_x f$ at grid point $x_i$ is approximated by a second-order centered difference with periodic boundary conditions:\n  $$ \\left. \\frac{\\partial f}{\\partial x} \\right|_{x_i} \\approx \\frac{f_{i+1} - f_{i-1}}{2 \\Delta x} $$\n  where indices are taken modulo $N$ (e.g., $f_{-1} = f_{N-1}$, $f_N=f_0$).\n\n- **Temporal Discretization**: The system is advanced in time using the second-order explicit Runge-Kutta method (midpoint method). For an ODE $\\dot{\\mathbf{U}} = F(\\mathbf{U})$, a single step from $t_n$ to $t_{n+1}=t_n+\\Delta t$ is:\n  1.  Predictor step: $\\mathbf{U}^* = \\mathbf{U}^n + \\frac{\\Delta t}{2} F(\\mathbf{U}^n)$\n  2.  Corrector step: $\\mathbf{U}^{n+1} = \\mathbf{U}^n + \\Delta t F(\\mathbf{U}^*)$\n  This scheme is second-order accurate in time.\n\n- **Convergence Analysis**: The numerical solution $\\mathbf{U}_{\\text{num}}$ at final time $t=T$ is compared to the analytical solution $\\mathbf{U}_{\\text{an}}(T)$. The error is quantified using the aggregated discrete $L^2$ norm:\n  $$ e = \\sqrt{\\frac{1}{2N} \\sum_{i=0}^{N-1} \\left( (v_{y,i}^{\\text{num}} - v_{y,i}^{\\text{an}})^2 + (b_{y,i}^{\\text{num}} - b_{y,i}^{\\text{an}})^2 \\right)} $$\n  For a method of order $p$, the error is expected to scale as $e \\propto (\\Delta z)^p$, where $\\Delta z$ is the discretization step ($\\Delta x$ for spatial convergence, $\\Delta t$ for temporal convergence). Taking the logarithm, $\\log(e) \\propto p \\log(\\Delta z)$, the order of convergence $p$ is the slope of the line in a log-log plot of error versus step size. This slope is estimated via linear regression. Both the spatial and temporal schemes are second-order, so we expect the measured convergence rates $p_s$ and $p_t$ to be close to $2$. The boolean `is_monotonic` check verifies that the error decreases with finer resolution, which is a necessary condition for convergence.",
            "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Derives and implements a verification test for a 1D shear-Alfvén wave solver.\n\n    The function performs two convergence studies: one for spatial resolution and one\n    for the time step size. It calculates the observed order of convergence for each\n    and checks if the error monotonically decreases with refinement.\n    \"\"\"\n\n    # -------------------\n    # Problem Setup\n    # -------------------\n    # Physical and wave parameters (all in SI units)\n    L = 1.0  # Domain length [m]\n    rho0 = 1.0  # Equilibrium density [kg/m^3]\n    va = 1.0  # Alfvén speed [m/s]\n    A = 1.0  # Wave amplitude for velocity [m/s]\n\n    # Derived parameters\n    k = 2.0 * np.pi / L  # Wavenumber [rad/m]\n    omega = va * k  # Angular frequency [rad/s]\n    T = L / va  # Wave period / Final time [s]\n\n    # -------------------\n    # Core Functions\n    # -------------------\n\n    def analytical_solution(x, t, k_val, omega_val, A_val):\n        \"\"\"Computes the analytical solution for vy and by at given x and t.\"\"\"\n        phase = k_val * x - omega_val * t\n        vy = A_val * np.cos(phase)\n        by = -A_val * np.cos(phase)\n        return vy, by\n\n    def periodic_centered_diff(f, dx):\n        \"\"\"Computes the 2nd-order centered difference on a periodic grid.\"\"\"\n        return (np.roll(f, -1) - np.roll(f, 1)) / (2.0 * dx)\n\n    def get_rhs(vy, by, dx, va_val):\n        \"\"\"Computes the right-hand side of the discretized PDE system.\"\"\"\n        dvydt = va_val * periodic_centered_diff(by, dx)\n        dbydt = va_val * periodic_centered_diff(vy, dx)\n        return dvydt, dbydt\n\n    def rk2_step(vy, by, dt, dx, va_val):\n        \"\"\"Performs one step of the 2nd-order Runge-Kutta (midpoint) method.\"\"\"\n        # Predictor step (k1)\n        k1_vy, k1_by = get_rhs(vy, by, dx, va_val)\n        vy_mid = vy + 0.5 * dt * k1_vy\n        by_mid = by + 0.5 * dt * k1_by\n\n        # Corrector step (k2)\n        k2_vy, k2_by = get_rhs(vy_mid, by_mid, dx, va_val)\n        vy_new = vy + dt * k2_vy\n        by_new = by + dt * k2_by\n        return vy_new, by_new\n\n    def run_simulation(N, dt, T_final, va_val, k_val, omega_val, A_val):\n        \"\"\"Runs a full simulation and computes the L2 error.\"\"\"\n        dx = L / N\n        x_grid = np.linspace(0, L, N, endpoint=False)\n\n        # Initial conditions from analytical solution at t=0\n        vy, by = analytical_solution(x_grid, 0.0, k_val, omega_val, A_val)\n\n        # Time integration\n        num_steps = int(round(T_final / dt))\n        # Ensure final time is exactly T_final\n        if not np.isclose(num_steps * dt, T_final):\n            raise ValueError(\n                f\"Number of steps {num_steps} and dt {dt} do not result in T={T_final}\"\n            )\n\n        for _ in range(num_steps):\n            vy, by = rk2_step(vy, by, dt, dx, va_val)\n\n        # Analytical solution at final time T\n        vy_an, by_an = analytical_solution(x_grid, T_final, k_val, omega_val, A_val)\n\n        # Compute aggregated L2 error\n        err_vy = vy - vy_an\n        err_by = by - by_an\n        error_vec = np.concatenate((err_vy, err_by))\n        l2_error = np.sqrt(np.mean(error_vec**2))\n\n        return l2_error\n\n    def check_monotonicity(errors_list):\n        \"\"\"Checks if a list of errors is strictly monotonically decreasing.\"\"\"\n        return all(errors_list[i] > errors_list[i+1] for i in range(len(errors_list) - 1))\n\n    # -------------------\n    # Convergence Studies\n    # -------------------\n\n    # 1. Spatial Convergence Study\n    N_values_spatial = [50, 100, 200, 400]\n    C_spatial = 0.2\n    \n    errors_spatial = []\n    dx_values = []\n    for N in N_values_spatial:\n        dx = L / N\n        dt = C_spatial * dx / va\n        error = run_simulation(N, dt, T, va, k, omega, A)\n        errors_spatial.append(error)\n        dx_values.append(dx)\n\n    # Calculate spatial convergence order\n    log_dx = np.log(dx_values)\n    log_errors_s = np.log(errors_spatial)\n    p_s_result = stats.linregress(log_dx, log_errors_s)\n    ps = p_s_result.slope\n    is_space_monotonic = check_monotonicity(errors_spatial)\n\n    # 2. Temporal Convergence Study\n    N_temporal = 400\n    C_values_temporal = [0.2, 0.1, 0.05, 0.025]\n    \n    errors_temporal = []\n    dt_values = []\n    dx_temporal = L / N_temporal\n    for C in C_values_temporal:\n        dt = C * dx_temporal / va\n        error = run_simulation(N_temporal, dt, T, va, k, omega, A)\n        errors_temporal.append(error)\n        dt_values.append(dt)\n\n    # Calculate temporal convergence order\n    log_dt = np.log(dt_values)\n    log_errors_t = np.log(errors_temporal)\n    p_t_result = stats.linregress(log_dt, log_errors_t)\n    pt = p_t_result.slope\n    is_time_monotonic = check_monotonicity(errors_temporal)\n    \n    # -------------------\n    # Final Output\n    # -------------------\n    print(\n        f\"[{ps},{pt},{str(is_space_monotonic).lower()},{str(is_time_monotonic).lower()}]\"\n    )\n\nsolve()\n\n```"
        }
    ]
}