{
    "hands_on_practices": [
        {
            "introduction": "在磁约束聚变研究中，等离子体与装置壁的相互作用至关重要。理想磁流体动力学（MHD）模型中的边界条件直接决定了能量和粒子是否能被有效约束。本练习引导我们从麦克斯韦方程组和理想导体的基本物理原理出发，推导通过导电壁的电磁能流，即坡印廷通量 。通过这个实践，我们可以加深对理想MHD模型在物理边界上能量守恒的理解，并阐明实现完美能量约束所需的严格条件。",
            "id": "3992290",
            "problem": "一个轴对称的磁约束等离子体占据了一个单连通区域 $\\Omega$，该区域由一个光滑、静止的理想导电壁 $\\partial \\Omega$ 界定，其单位外法向量为 $\\mathbf{n}(\\mathbf{x})$。该等离子体由理想磁流体动力学 (MHD) 描述，特别是理想欧姆定律 $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$，并且电磁场在等离子体区域内遵循麦克斯韦方程组。该壁是理想导体，相对于实验室参考系没有运动。\n\n从基本电磁守恒定律和麦克斯韦方程组在理想导电表面所隐含的边界条件出发，确定穿过壁的电磁能流密度（坡印廷矢量）的法向分量在 $\\partial \\Omega$ 上的积分，即计算穿过边界的净电磁功率，\n$$\nP \\equiv \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA,\n$$\n其中 $\\mathbf{S}$ 是电磁能流密度。以瓦特 (Watts) 为单位表示最终答案。无需四舍五入。\n\n此外，请陈述在理想 MHD 中，穿过壁的净电磁能量传输为零的边界条件（用 $\\partial \\Omega$ 上的场和流动分量表示）。\n\n您的推导必须从电磁能量守恒定律和麦克斯韦方程组所导出的理想导体边界条件开始，不得使用启发式捷径。请清晰地阐述将基本定律与在理想导电壁处计算 $P$ 值联系起来的每一步。",
            "solution": "该问题要求计算穿过等离子体约束区域边界 $\\partial\\Omega$ 的净电磁功率 $P$，并确定在该功率传输为零时理想磁流体动力学 (MHD) 的边界条件。区域 $\\Omega$ 由一个理想导电、光滑、静止的壁 $\\partial\\Omega$ 包围。\n\n问题陈述的验证过程如下。\n步骤 1：提取已知条件。\n- 等离子体区域 $\\Omega$ 是轴对称且单连通的。\n- 边界 $\\partial\\Omega$ 是一个光滑、静止的理想导电壁。\n- 壁的单位外法向量是 $\\mathbf{n}(\\mathbf{x})$。\n- 等离子体由理想 MHD 描述，包括理想欧姆定律：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$。\n- 电磁场遵循麦克斯韦方程组。\n- 待计算的量是净电磁功率 $P \\equiv \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA$，其中 $\\mathbf{S}$ 是坡印廷矢量。\n- 第二个任务是陈述 $P=0$ 时的边界条件。\n- 推导必须从第一性原理出发。\n\n步骤 2：使用提取的已知条件进行验证。\n- 科学性和事实合理性：该问题是在经典电磁学和理想 MHD 的标准、完善的理论框架内提出的。所有概念，如麦克斯韦方程组、坡印廷矢量、理想导体和理想欧姆定律，都是等离子体物理学的基础。该问题具有科学依据。\n- 适定性和完备性：该问题是适定的。它指明了物理模型、区域、边界属性以及待计算的量。所提供的信息是充分且自洽的，足以推导出唯一解。\n- 客观性和清晰度：该问题使用精确、客观、无歧义的科学语言进行陈述。\n\n步骤 3：结论和行动。\n该问题是有效的。这是一个应用电磁学和等离子体物理学基本原理的标准的、不平凡的练习。可以进行求解过程。\n\n电磁能流密度由坡印亭矢量 $\\mathbf{S}$ 给出。在国际单位制 (SI) 中，其定义为：\n$$\n\\mathbf{S} = \\frac{1}{\\mu_0} (\\mathbf{E} \\times \\mathbf{B})\n$$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{B}$ 是磁场，$\\mu_0$ 是真空磁导率。\n\n从区域 $\\Omega$ 经其边界 $\\partial\\Omega$ 流出的净电磁功率 $P$ 是坡印亭矢量法向分量的面积分：\n$$\nP = \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA = \\int_{\\partial \\Omega} \\frac{1}{\\mu_0} (\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n} \\, dA\n$$\n为计算此积分，我们必须确定被积函数 $(\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n}$ 在边界 $\\partial\\Omega$ 上的值。我们可以使用标量三重积恒等式 $(\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C} = \\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C})$ 来重写被积函数：\n$$\n(\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n} = \\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n})\n$$\n问题陈述壁 $\\partial\\Omega$ 是一个理想导体。麦克斯韦方程组在理想导体表面的一个基本边界条件是电场的切向分量必须为零。如果存在切向分量，它将驱动无限大的表面电流，这是非物理的。该条件表示为：\n$$\n\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\n这个矢量方程意味着在表面 $\\partial\\Omega$ 上任意一点的电场矢量 $\\mathbf{E}$ 都必须垂直于该点的表面。换句话说，$\\mathbf{E}$ 必须与法向量 $\\mathbf{n}$ 平行。我们可以将其写为在 $\\partial\\Omega$ 上 $\\mathbf{E} = (\\mathbf{E} \\cdot \\mathbf{n}) \\mathbf{n}$。\n\n现在考虑点积中的另一个矢量 $(\\mathbf{B} \\times \\mathbf{n})$。根据叉积的定义，由 $\\mathbf{B} \\times \\mathbf{n}$ 产生的矢量同时垂直于 $\\mathbf{B}$ 和 $\\mathbf{n}$。由于它垂直于 $\\mathbf{n}$，矢量 $(\\mathbf{B} \\times \\mathbf{n})$ 必须位于与表面 $\\partial\\Omega$ 相切的平面内。\n\n我们现在计算表面 $\\partial\\Omega$ 上两个矢量的点积：一个是与表面垂直的电场 $\\mathbf{E}$，另一个是与表面相切的矢量 $(\\mathbf{B} \\times \\mathbf{n})$。在表面上同一点的任意法向矢量与任意切向矢量的点积为零。因此，我们有：\n$$\n\\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n}) = 0 \\quad \\text{on } \\partial\\Omega\n$$\n由于被积函数 $\\mathbf{S} \\cdot \\mathbf{n} = \\frac{1}{\\mu_0} \\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n})$ 在边界 $\\partial\\Omega$ 上的所有点都恒等于零，因此积分也必须为零：\n$$\nP = \\int_{\\partial \\Omega} 0 \\, dA = 0\n$$\n穿过边界的净电磁功率为零。答案是 $0$ 瓦特。这个结果是边界为静止理想导体的直接推论，与内部等离子体的理想 MHD 模型无关。\n\n问题的第二部分要求用场和流动分量来表示实现零净能量传输的边界条件。如上所示，$P=0$ 的条件是由理想导体上的电磁边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ 保证的。我们现在将其与理想 MHD 的流体和场变量联系起来。该问题指明了三个关键的物理约束：\n1. 壁是理想导体：在 $\\partial\\Omega$ 上 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$。\n2. 等离子体遵循理想欧姆定律：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$。\n3. 壁是静止且不可穿透的，因此等离子体在壁上的速度法向分量为零：在 $\\partial\\Omega$ 上 $\\mathbf{v} \\cdot \\mathbf{n} = 0$。\n\n我们可以通过确保这三个约束相互一致来推导相应的理想 MHD 边界条件。根据欧姆定律（约束 2），我们有 $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$。将此代入理想导体条件（约束 1）得到：\n$$\n\\mathbf{n} \\times (-\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\n使用矢量三重积恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$，我们展开该表达式：\n$$\n-[\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(\\mathbf{n} \\cdot \\mathbf{v})] = \\mathbf{0}\n$$\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(\\mathbf{n} \\cdot \\mathbf{v}) = \\mathbf{0}\n$$\n现在，我们应用不可穿透壁条件（约束 3），$\\mathbf{v} \\cdot \\mathbf{n} = 0$：\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(0) = \\mathbf{0}\n$$\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\n该方程意味着在边界上的任意一点，以下至少有一项必须成立：要么流体速度矢量 $\\mathbf{v}$ 为零，要么磁场的标量法向分量 $\\mathbf{B} \\cdot \\mathbf{n}$ 为零。一般而言，理想 MHD 允许沿边界存在非零的切向流动（自由滑移条件），因此我们不能假设在 $\\partial\\Omega$ 上处处都有 $\\mathbf{v} = \\mathbf{0}$。为了对任意切向速度 $\\mathbf{v}$ 都满足该方程，另一因子必须为零。\n因此，我们必须有：\n$$\n\\mathbf{B} \\cdot \\mathbf{n} = 0 \\quad \\text{on } \\partial\\Omega\n$$\n这个条件表明磁场必须纯粹与理想导电壁相切。\n\n总之，对于静止、不可穿透的理想导电壁，确保净电磁能量传输为零的一致的理想 MHD 边界条件集是：\n1. 等离子体速度的法向分量为零：$\\mathbf{v} \\cdot \\mathbf{n} = 0$。\n2. 磁场的法向分量为零：$\\mathbf{B} \\cdot \\mathbf{n} = 0$。\n\n这两个关于 MHD 变量 $\\mathbf{v}$ 和 $\\mathbf{B}$ 的条件是该问题约束条件的物理体现，并且足以保证 $P=0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "将理想MHD方程从理论转化为计算模型时，我们面临着独特的数值挑战。尽管数值格式在设计上保证了总能量的守恒，但在动能极高或磁能极强的区域，计算热力学压力时可能会因数值误差产生负值，这在物理上是不可能的。本练习  介绍了一种先进的“压力正性调节器”算法，它通过在保持总能量守恒的前提下，将多余的动能转化为内能，来修正非物理状态。这个实践对于开发稳健的MHD模拟程序至关重要。",
            "id": "3992296",
            "problem": "理想极限下的单流体磁流体动力学（MHD）模型演化了可压缩导电等离子体的守恒变量。在有限体积离散化中，每个单元储存质量密度 $ \\rho $（单位 $ \\mathrm{kg/m^3} $）、动量密度矢量 $ \\mathbf{m} = \\rho \\mathbf{v} $（单位 $ \\mathrm{kg/(m^2 \\, s)} $）、磁场 $ \\mathbf{B} $（单位 $ \\mathrm{T} $）和总能量密度 $ E $（单位 $ \\mathrm{J/m^3} $，等效于 $ \\mathrm{Pa} $）。绝热指数为 $ \\gamma $（无量纲）。在具有理想气体闭合的理想 MHD 模型中，总能量密度满足\n$$\nE \\;=\\; \\rho \\varepsilon \\;+\\; \\frac{1}{2} \\rho \\lVert \\mathbf{v} \\rVert^2 \\;+\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0},\n$$\n其中 $ \\varepsilon $ 是比内能（单位 $ \\mathrm{J/kg} $），$ \\mu_0 $ 是自由空间的磁导率（单位 $ \\mathrm{N/A^2} $，等效于 $ \\mathrm{H/m} $）。理想气体压力 $ p $（单位 $ \\mathrm{Pa} $）与内能密度 $ \\rho \\varepsilon $ 的关系为\n$$\np \\;=\\; (\\gamma - 1) \\, \\rho \\varepsilon.\n$$\n因此，从守恒状态 $ (\\rho, \\mathbf{m}, \\mathbf{B}, E) $，可以通过以下方式重构压力\n$$\nK \\;=\\; \\frac{1}{2} \\, \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho}, \\qquad\nE_{\\mathrm{mag}} \\;=\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}, \\qquad\np \\;=\\; (\\gamma - 1) \\, \\big( E - K - E_{\\mathrm{mag}} \\big).\n$$\n\n然而，在计算聚变科学与工程中出现的近真空单元（例如在等离子体边缘或材料界面附近），即使 $ E $ 是非负的且散度误差得到控制，数值误差也可能导致重构的压力为负。为了稳健地保持压力正性，请设计一个调节器，该调节器在对守恒状态进行最小扰动的同时，对压力施加一个具有物理动机的下限（一个“底”）。考虑一个形式如下的压力下限\n$$\np_{\\min} \\;=\\; \\max\\!\\Big( p_{\\mathrm{abs}}, \\; \\beta_{\\min} \\, p_{\\mathrm{mag}} \\Big), \\qquad p_{\\mathrm{mag}} \\;=\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0},\n$$\n其中 $ p_{\\mathrm{abs}} $（单位 $ \\mathrm{Pa} $）是一个绝对压力下限，$ \\beta_{\\min} $ 是一个规定的最小等离子体贝塔值。您的调节器必须按以下顺序操作，以最小的修改实现压力正性：\n- 首先，尝试通过缩放动量来减少动能，以在总能量固定的情况下增加内能，即，设置 $ \\mathbf{m}' = \\alpha \\, \\mathbf{m} $，其中 $ \\alpha \\in [0,1] $ 的选择应使得目标内能密度在可行的情况下等于 $ p_{\\min} / (\\gamma - 1) $。\n- 如果即使动量为零也不足以满足条件（即，总能量减去磁能无法提供所需的内能），则通过设置 $ E' = E_{\\mathrm{mag}} + p_{\\min} / (\\gamma - 1) $ 和 $ \\mathbf{m}' = \\mathbf{0} $，注入与 $ p = p_{\\min} $ 一致的最小总能量。\n\n任务：\n- 仅从上述关系以及动能和磁能密度的定义出发，推导从 $ (\\rho, \\mathbf{m}, \\mathbf{B}, E) $ 计算 $ p $ 的表达式。\n- 提出并形式化所描述的正性调节器，并以算法方式实现它。该调节器必须：\n  - 计算未调节的压力 $ p $。\n  - 计算压力下限 $ p_{\\min} $。\n  - 如果 $ p \\ge p_{\\min} $，则保持状态不变并报告压力。\n  - 否则，计算所需的内能密度 $ e_{\\min} = p_{\\min} / (\\gamma - 1) $。设当前的动能密度为 $ K = \\frac{1}{2} \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho} $。定义目标动能密度\n    $$\n    K_{\\mathrm{tgt}} \\;=\\; E - E_{\\mathrm{mag}} - e_{\\min}.\n    $$\n    如果 $ K_{\\mathrm{tgt}} \\in [0, K] $ 且 $ K > 0 $，则设置 $ \\alpha = \\sqrt{ K_{\\mathrm{tgt}} / K } $ 和 $ \\mathbf{m}' = \\alpha \\mathbf{m} $，保持 $ E $ 不变，这将精确地得到 $ p = p_{\\min} $。如果 $ K_{\\mathrm{tgt}} \\le 0 $ 或 $ K = 0 $，则设置 $ \\mathbf{m}' = \\mathbf{0} $ 和 $ E' = E_{\\mathrm{mag}} + e_{\\min} $，这也将精确地得到 $ p = p_{\\min} $。\n- 以 $ \\mathrm{Pa} $ 为单位表示所有压力。\n\n使用以下常数和测试套件。所有量均采用国际单位制（SI）：\n- $ \\gamma = \\frac{5}{3} $,\n- $ \\mu_0 = 4 \\pi \\times 10^{-7} $,\n- $ \\beta_{\\min} = 10^{-3} $,\n- $ p_{\\mathrm{abs}} = 10^{-6} $.\n\n测试套件案例 $ (\\rho, \\mathbf{m}, \\mathbf{B}, E) $：\n- 案例 A（无需调节）：$ \\rho = 1.0 $，$ \\mathbf{m} = (10.0, 0.0, 0.0) $，$ \\mathbf{B} = (0.1, 0.1, 0.0) $。选择一个预期的热力学压力 $ p_\\ast = 1000.0 $，并设置\n  $$\n  E \\;=\\; \\frac{p_\\ast}{\\gamma - 1} \\;+\\; \\frac{1}{2} \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho} \\;+\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0} \\;=\\; 9507.747154594767.\n  $$\n- 案例 B（仅通过动量缩放进行调节）：$ \\rho = 10^{-5} $，$ \\mathbf{m} = (1.0, 0.0, 0.0) $，$ \\mathbf{B} = (0.0, 0.0, 0.0) $，$ E = 1.0 $。\n- 案例 C（通过能量注入进行调节，动量为零）：$ \\rho = 10^{-6} $，$ \\mathbf{m} = (0.0, 0.0, 0.0) $，$ \\mathbf{B} = (0.0, 0.0, 0.0) $，$ E = 10^{-6} $。\n- 案例 D（通过构造恰好在下限上）：$ \\rho = 0.1 $，$ \\mathbf{m} = (0.3, 0.0, 0.0) $，$ \\mathbf{B} = (0.2, 0.0, 0.0) $，$ E = 15939.817550653318 $。\n- 案例 E（强磁场，通过动量缩放进行调节）：$ \\rho = 1.0 $，$ \\mathbf{m} = (100.0, 0.0, 0.0) $，$ \\mathbf{B} = (1.0, 0.0, 0.0) $，$ E = 403257.1705534973 $。\n\n您的程序必须对每个案例，使用上述算法计算调节后的压力 $ p_{\\mathrm{reg}} $（单位 $ \\mathrm{Pa} $），并按顺序 $ [A, B, C, D, E] $ 输出 $ p_{\\mathrm{reg}} $ 值的列表。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$ [\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D,\\text{result}_E] $）。\n- 列表中的每个条目都必须是一个实数（浮点数），代表相应测试案例的调节后压力（单位 $ \\mathrm{Pa} $）。",
            "solution": "问题陈述已经过严格评估并被确定为有效。它在科学上基于理想磁流体动力学（MHD）的原理，问题设定良好，目标明确，并提供了一套自洽、一致的定义、常数和测试案例。其中没有矛盾、模糊之处或事实错误。\n\n任务是从一组守恒变量中推导热力学压力的表达式，并设计和实现一个数值调节器以确保该压力保持非负，这是计算等离子体物理学中的一个常见挑战。\n\n首先，我们从给定的守恒状态变量推导压力 $p$ 的表达式：质量密度 $\\rho$、动量密度 $\\mathbf{m}$、磁场 $\\mathbf{B}$ 和总能量密度 $E$。\n\n总能量密度 $E$ 由内能、动能和磁能密度的总和给出：\n$$\nE = \\rho \\varepsilon + \\frac{1}{2} \\rho \\lVert \\mathbf{v} \\rVert^2 + \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}\n$$\n其中 $\\varepsilon$ 是比内能，$\\mathbf{v}$ 是流体速度，$\\mu_0$ 是自由空间的磁导率。项 $\\rho \\varepsilon$ 代表内能密度。\n\n动量密度定义为 $\\mathbf{m} = \\rho \\mathbf{v}$。由此，速度为 $\\mathbf{v} = \\mathbf{m} / \\rho$。\n动能密度，记为 $K$，可以用守恒变量 $\\rho$ 和 $\\mathbf{m}$ 表示：\n$$\nK = \\frac{1}{2} \\rho \\lVert \\mathbf{v} \\rVert^2 = \\frac{1}{2} \\rho \\left\\lVert \\frac{\\mathbf{m}}{\\rho} \\right\\rVert^2 = \\frac{1}{2} \\rho \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho^2} = \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho}\n$$\n磁能密度，记为 $E_{\\mathrm{mag}}$，由以下公式给出：\n$$\nE_{\\mathrm{mag}} = \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}\n$$\n我们现在可以重排总能量密度 $E$ 的方程，以求解内能密度 $\\rho \\varepsilon$：\n$$\n\\rho \\varepsilon = E - K - E_{\\mathrm{mag}} = E - \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho} - \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}\n$$\n问题陈述指出，对于理想气体，压力 $p$ 与内能密度的关系为：\n$$\np = (\\gamma - 1) \\rho \\varepsilon\n$$\n其中 $\\gamma$ 是绝热指数。代入 $\\rho \\varepsilon$ 的表达式，得到压力的公式：\n$$\np = (\\gamma - 1) \\left( E - \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho} - \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0} \\right)\n$$\n这样就完成了从守恒状态变量推导压力的过程。\n\n接下来，我们形式化压力正性调节器算法。目标是当计算出的压力 $p$ 低于某个下限时，强制施加一个最小压力 $p_{\\min}$，同时对守恒状态的扰动最小。\n\n该算法流程如下：\n\n1.  **输入**：状态变量 $(\\rho, \\mathbf{m}, \\mathbf{B}, E)$ 和物理/数值常数 $(\\gamma, \\mu_0, \\beta_{\\min}, p_{\\mathrm{abs}})$。\n\n2.  **计算派生量**：\n    - 动能密度：$K = \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho}$。\n    - 磁能密度：$E_{\\mathrm{mag}} = \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}$。\n    - 压力：$p = (\\gamma - 1) (E - K - E_{\\mathrm{mag}})$。\n\n3.  **计算压力下限**：\n    - 磁压力定义为 $p_{\\mathrm{mag}} = E_{\\mathrm{mag}}$。\n    - 压力下限是 $p_{\\min} = \\max(p_{\\mathrm{abs}}, \\beta_{\\min} \\cdot p_{\\mathrm{mag}})$。\n\n4.  **决策与调节**：\n    - 检查是否 $p \\ge p_{\\min}$。\n    - **如果 $p \\ge p_{\\min}$**：状态在物理上是有效的。调节后的压力 $p_{\\mathrm{reg}}$ 就是 $p$。状态变量 $(\\mathbf{m}, E)$ 不变。\n    - **如果 $p  p_{\\min}$**：压力低得不合物理，必须进行调节。目标调节压力为 $p_{\\min}$。\n        a. 计算达到此压力所需的内能密度：$e_{\\min} = \\frac{p_{\\min}}{\\gamma - 1}$。\n        b. 计算目标动能密度 $K_{\\mathrm{tgt}}$。这是在总能量 $E$ 和磁能 $E_{\\mathrm{mag}}$ 固定的情况下，将内能提高到 $e_{\\min}$ 后剩余的动能：\n           $$\n           K_{\\mathrm{tgt}} = E - E_{\\mathrm{mag}} - e_{\\min}\n           $$\n        c. **通过动量缩放进行调节**：这是首选方法，因为它守恒总能量。如果目标动能为非负值，$K_{\\mathrm{tgt}} \\ge 0$，则此方法可行。检查条件指定为 $K_{\\mathrm{tgt}} \\in [0, K]$ 且 $K  0$。如果 $p  p_{\\min}$，可以证明 $K_{\\mathrm{tgt}}  K$，因此条件简化为 $K_{\\mathrm{tgt}} \\ge 0$ 且 $K  0$。\n           - 如果此条件成立，计算动量缩放因子 $\\alpha$：\n             $$\n             \\alpha = \\sqrt{\\frac{K_{\\mathrm{tgt}}}{K}}\n             $$\n           - 状态更新为：$\\mathbf{m}' = \\alpha \\mathbf{m}$ 和 $E' = E$。新的动能为 $K' = K_{\\mathrm{tgt}}$，新的压力恰好为 $p_{\\min}$。调节后的压力为 $p_{\\mathrm{reg}} = p_{\\min}$。\n        d. **通过能量注入进行调节**：当动量缩放不足时（即 $K_{\\mathrm{tgt}}  0$ 时），或没有动能可以移除时（$K=0$），使用此备用方法。必须增加总能量以满足压力下限的要求。\n           - 状态更新为：$\\mathbf{m}' = \\mathbf{0}$（所有动能被移除），总能量被设置为与压力下限一致的最小值：\n             $$\n             E' = E_{\\mathrm{mag}} + e_{\\min}\n             $$\n           - 新的动能为 $K' = 0$，新的压力恰好为 $p_{\\min}$。调节后的压力为 $p_{\\mathrm{reg}} = p_{\\min}$。\n\n这个两阶段过程确保了压力的正性，它首先尝试将多余的动能转化为内能（守恒总能量），仅在万不得已时才注入能量。最终报告的调节后压力是此过程的结果。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Implements and tests a pressure positivity regulator for ideal MHD simulations.\n    \"\"\"\n    \n    # Define physical and numerical constants\n    gamma = 5.0 / 3.0\n    mu0 = 4.0 * math.pi * 1e-7\n    beta_min = 1e-3\n    p_abs = 1e-6\n\n    # Test suite cases (rho, m_vec, B_vec, E)\n    test_cases = [\n        # Case A: No regulation needed\n        (1.0, np.array([10.0, 0.0, 0.0]), np.array([0.1, 0.1, 0.0]), 9507.747154594767),\n        \n        # Case B: Regulation via momentum scaling\n        (1e-5, np.array([1.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]), 1.0),\n        \n        # Case C: Regulation via energy injection\n        (1e-6, np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]), 1e-6),\n        \n        # Case D: Exactly on the floor\n        (0.1, np.array([0.3, 0.0, 0.0]), np.array([0.2, 0.0, 0.0]), 15939.817550653318),\n        \n        # Case E: Strong B-field, regulation via momentum scaling\n        (1.0, np.array([100.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), 403257.1705534973)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        rho, m_vec, B_vec, E = case\n        \n        # Compute squared norms\n        m_sq = np.dot(m_vec, m_vec)\n        B_sq = np.dot(B_vec, B_vec)\n        \n        # Compute kinetic and magnetic energy densities\n        # A small epsilon is added to rho to prevent division by zero in pathological cases,\n        # although not strictly necessary for the given test suite.\n        K = 0.5 * m_sq / (rho + 1e-99)\n        E_mag = B_sq / (2.0 * mu0)\n        \n        # Compute the initial pressure\n        p = (gamma - 1.0) * (E - K - E_mag)\n\n        # Compute the pressure floor\n        p_mag = E_mag\n        p_min = max(p_abs, beta_min * p_mag)\n\n        # Check if regulation is needed\n        if p >= p_min:\n            # No regulation needed\n            p_reg = p\n        else:\n            # Regulation is needed; the final pressure will be p_min\n            p_reg = p_min\n            \n            # This part of the code would modify the state (m, E)\n            # but for this problem, we only need to report the regulated pressure.\n            # The logic is retained for completeness.\n            \n            # Required internal energy density for p_min\n            e_min = p_min / (gamma - 1.0)\n            \n            # Target kinetic energy density\n            K_tgt = E - E_mag - e_min\n            \n            # Decide on the regulation strategy\n            if K > 1e-99 and K_tgt >= 0.0:\n                # Strategy 1: Momentum scaling\n                # alpha = math.sqrt(K_tgt / K)\n                # m_vec_new = alpha * m_vec\n                # E_new = E\n                pass # State change not needed for final output\n            else:\n                # Strategy 2: Energy injection\n                # m_vec_new = np.array([0.0, 0.0, 0.0])\n                # E_new = E_mag + e_min\n                pass # State change not needed for final output\n                \n        results.append(p_reg)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了能量守恒和热力学一致性，保持磁场的无散度条件（$\\nabla \\cdot \\mathbf{B} = 0$）是MHD模拟的另一个核心挑战。数值离散化不可避免地会引入虚假的磁单极子，导致非物理力的产生和模拟的崩溃。本练习  探讨了广义拉格朗日乘子（GLM）方法，这是一种通过引入一个辅助标量场来主动输运和衰减散度误差的优雅技术。通过推导该系统的特征波速和阻尼率，你将学会如何分析和量化一种先进的散度清理方案的有效性。",
            "id": "3992275",
            "problem": "考虑将广义拉格朗日乘子 (GLM) 双曲-抛物线清理方法应用于理想磁流体力学 (MHD) 方程组，其中磁场 $\\mathbf{B}$ 通过一个标量清理场 $\\psi$ 进行增强，以减少和移流散度误差。从基本定律（即法拉第电磁感应定律和理想欧姆定律）以及对磁场的无散度约束出发，推导一个一维线性清理子系统，在该子系统中，通过将 $\\psi$ 与 $\\mathbf{B}$ 适当耦合，$\\mathbf{B}$ 中的散度误差既被移流又被阻尼。利用该子系统，获得特征速度、散度误差波的相速度以及散度误差幅值的主导衰减率的闭式表达式，这些表达式应表示为双曲清理速度 $c_h$ (单位 $\\mathrm{m/s}$)、线性阻尼系数 $\\alpha$ (单位 $\\mathrm{s^{-1}}$) 和波数 $k$ (单位 $\\mathrm{m^{-1}}$) 的函数。确保您的推导植根于基本物理定律，且不假设任何预先推导出的 GLM 公式。\n\n您的程序必须实现您推导的表达式，并对以下参数三元组 $(c_h,\\alpha,k)$ 的测试套件进行评估：\n- 测试用例 1 (欠阻尼状态)：$c_h = 1.00\\times 10^{5}\\ \\mathrm{m/s}$，$\\alpha = 1.00\\times 10^{3}\\ \\mathrm{s^{-1}}$， $k = 1.00\\times 10^{-1}\\ \\mathrm{m^{-1}}$。\n- 测试用例 2 (临界状态)：$c_h = 3.00\\times 10^{4}\\ \\mathrm{m/s}$，$\\alpha = 1.20\\times 10^{5}\\ \\mathrm{s^{-1}}$， $k = 2.00\\ \\mathrm{m^{-1}}$。\n- 测试用例 3 (过阻尼状态)：$c_h = 2.00\\times 10^{4}\\ \\mathrm{m/s}$，$\\alpha = 1.00\\times 10^{5}\\ \\mathrm{s^{-1}}$， $k = 1.00\\times 10^{-1}\\ \\mathrm{m^{-1}}$。\n- 测试用例 4 (高 $k$ 欠阻尼状态)：$c_h = 5.00\\times 10^{5}\\ \\mathrm{m/s}$，$\\alpha = 1.00\\times 10^{3}\\ \\mathrm{s^{-1}}$， $k = 1.00\\times 10^{3}\\ \\mathrm{m^{-1}}$。\n\n对于每个测试用例，您的程序必须计算并输出一个包含五个浮点数的列表：\n1. 正特征速度 $+c_h$，单位为 $\\mathrm{m/s}$。\n2. 负特征速度 $-c_h$，单位为 $\\mathrm{m/s}$。\n3. 散度误差波的正相速度，单位为 $\\mathrm{m/s}$。\n4. 散度误差波的负相速度，单位为 $\\mathrm{m/s}$。\n5. 散度误差幅值的主导阻尼率，单位为 $\\mathrm{s^{-1}}$。\n\n如果状态是振荡的（欠阻尼），相速度必须反映角频率的实部除以 $k$ 的结果；如果状态是非振荡的（过阻尼或临界），相速度必须报告为 $0\\ \\mathrm{m/s}$，且主导阻尼率必须对应于最慢衰减的指数模。所有速度均以 $\\mathrm{m/s}$ 表示，所有阻尼率均以 $\\mathrm{s^{-1}}$ 表示，并四舍五入至六位有效数字。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也是一个用方括号括起来的逗号分隔列表。例如，输出格式必须为\n$[\\,[x_{1},y_{1},z_{1},w_{1},r_{1}],\\,[x_{2},y_{2},z_{2},w_{2},r_{2}],\\,\\dots\\,]$\n且行内任何地方都没有空格。",
            "solution": "经评估，用户提供的问题是有效的。它在科学上基于计算磁流体力学的原理，问题表述清晰，并包含进行严格推导和求解所需的所有信息。\n\n一维线性广义拉格朗日乘子 (GLM) 清理子系统的推导始于控制理想磁流体力学 (MHD) 中磁场 $\\mathbf{B}$ 的基本定律。\n\n法拉第电磁感应定律由下式给出：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\n在理想 MHD 中，电场 $\\mathbf{E}$ 由理想欧姆定律确定：\n$$\n\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\n其中 $\\mathbf{v}$ 是等离子体流体速度。将两者结合得到感应方程：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\n无散度约束是麦克斯韦方程组的一个推论，它要求磁场是无散度的：\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\n对感应方程取散度，得到 $\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{B}) = \\nabla \\cdot (\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})) \\equiv 0$。这意味着任何初始的非零散度（可能由数值离散化误差引起）会随时间守恒，而不会被物理方程所修正。\n\nGLM 方法通过增强理想 MHD 系统来解决此问题。引入一个标量场 $\\psi$，并修改方程以主动输运和阻尼散度误差。修改后的感应方程和 $\\psi$ 的新演化方程如下：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) + \\nabla \\psi = 0\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 (\\nabla \\cdot \\mathbf{B}) + \\alpha \\psi = 0\n$$\n这里，$c_h$ 是一个双曲清理速度，$\\alpha$ 是一个抛物线阻尼系数。对修改后的感应方程取散度，并使用恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$，我们发现在散度误差的时间演化与 $\\psi$ 之间存在耦合关系：\n$$\n\\frac{\\partial (\\nabla \\cdot \\mathbf{B})}{\\partial t} + \\nabla^2 \\psi = 0\n$$\n该系统确保如果存在散度误差 $\\nabla \\cdot \\mathbf{B}$，它将引起 $\\psi$ 的变化，进而驱动系统趋向 $\\nabla \\cdot \\mathbf{B} = 0$ 的状态。\n\n为按要求推导一维线性清理子系统，我们考虑一个简化的情景，其中变化仅沿 $x$ 轴发生，因此 $\\nabla = (\\frac{\\partial}{\\partial x}, 0, 0)$。此外，我们在没有流体运动（$\\mathbf{v}=0$）的情况下分析该系统，以隔离清理机制。$\\mathbf{B}$ 的分量为 $(B_x, B_y, B_z)$。\n散度变为 $\\nabla \\cdot \\mathbf{B} = \\frac{\\partial B_x}{\\partial x}$。项 $\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})$ 消失。修改后的感应方程变为：\n$$\n\\frac{\\partial B_x}{\\partial t} + \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = 0\n$$\n$$\n\\frac{\\partial B_z}{\\partial t} = 0\n$$\n$\\psi$ 在一维中的演化方程为：\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 \\frac{\\partial B_x}{\\partial x} + \\alpha \\psi = 0\n$$\n$B_y$ 和 $B_z$ 的方程是平凡的。非平凡的一维线性子系统耦合了 $B_x$ 和 $\\psi$：\n$$\n\\frac{\\partial B_x}{\\partial t} + \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 \\frac{\\partial B_x}{\\partial x} + \\alpha \\psi = 0\n$$\n该系统可以写成矩阵形式 $\\frac{\\partial \\mathbf{U}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{U}}{\\partial x} + \\mathbf{S} = 0$，其中 $\\mathbf{U} = [B_x, \\psi]^T$：\n$$\n\\frac{\\partial}{\\partial t} \\begin{pmatrix} B_x \\\\ \\psi \\end{pmatrix} + \\begin{pmatrix} 0  1 \\\\ c_h^2  0 \\end{pmatrix} \\frac{\\partial}{\\partial x} \\begin{pmatrix} B_x \\\\ \\psi \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\alpha \\psi \\end{pmatrix} = 0\n$$\n该双曲系统的特征速度是矩阵 $\\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ c_h^2  0 \\end{pmatrix}$ 的特征值。特征方程为 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = (-\\lambda)(-\\lambda) - c_h^2 = \\lambda^2 - c_h^2 = 0$。特征值为 $\\lambda = \\pm c_h$。\n因此，特征速度为 $+c_h$ 和 $-c_h$。\n\n为求出散度误差波的相速度和阻尼率，我们进行傅里叶分析。我们假设平面波解的形式为 $B_x(x, t) = \\hat{B}_x e^{i(kx - \\omega t)}$ 和 $\\psi(x, t) = \\hat{\\psi} e^{i(kx - \\omega t)}$，其中 $k$ 是波数，$\\omega$ 是复角频率。将这些代入子系统得到：\n$$\n-i\\omega \\hat{B}_x + ik \\hat{\\psi} = 0 \\implies \\omega \\hat{B}_x = k \\hat{\\psi}\n$$\n$$\n-i\\omega \\hat{\\psi} + c_h^2 (ik) \\hat{B}_x + \\alpha \\hat{\\psi} = 0\n$$\n将 $\\hat{\\psi} = (\\omega/k)\\hat{B}_x$ 代入第二个方程，得到色散关系：\n$$\n-i\\omega \\left(\\frac{\\omega}{k}\\right) \\hat{B}_x + ikc_h^2 \\hat{B}_x + \\alpha \\left(\\frac{\\omega}{k}\\right) \\hat{B}_x = 0\n$$\n$$\n-i\\omega^2 + ik^2c_h^2 + \\alpha\\omega = 0\n$$\n$$\n\\omega^2 + i\\alpha\\omega - k^2c_h^2 = 0\n$$\n解这个关于 $\\omega$ 的二次方程：\n$$\n\\omega = \\frac{-i\\alpha \\pm \\sqrt{(i\\alpha)^2 - 4(1)(-k^2c_h^2)}}{2} = \\frac{-i\\alpha \\pm \\sqrt{4k^2c_h^2 - \\alpha^2}}{2}\n$$\n解的性质取决于判别式 $\\Delta = 4k^2c_h^2 - \\alpha^2$ 的符号。令 $\\omega = \\omega_r + i\\omega_i$。相速度为 $v_{ph} = \\omega_r/k$，振幅阻尼率为 $\\gamma = -\\omega_i$ (对于 $\\omega_i  0$)。\n\n情况 1：欠阻尼状态 ($4k^2c_h^2 > \\alpha^2$)。\n判别式为正实数。\n$$\n\\omega = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2} - i\\frac{\\alpha}{2}\n$$\n频率的实部为 $\\omega_r = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2}$。\n相速度为 $v_{ph} = \\frac{\\omega_r}{k} = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2k} = \\pm \\sqrt{c_h^2 - \\left(\\frac{\\alpha}{2k}\\right)^2}$。\n两种模式的虚部均为 $\\omega_i = -\\frac{\\alpha}{2}$。\n两种模式的振幅均按 $e^{\\omega_i t} = e^{-(\\alpha/2)t}$ 衰减。主导（也是唯一）的阻尼率为 $\\gamma = \\frac{\\alpha}{2}$。\n\n情况 2：过阻尼或临界阻尼状态 ($4k^2c_h^2 \\le \\alpha^2$)。\n判别式为非正数。\n$$\n\\omega = \\frac{-i\\alpha \\pm i\\sqrt{\\alpha^2 - 4k^2c_h^2}}{2} = -i \\left( \\frac{\\alpha \\mp \\sqrt{\\alpha^2 - 4k^2c_h^2}}{2} \\right)\n$$\n频率的实部为 $\\omega_r = 0$，因此相速度为 $v_{ph} = 0$。\n虚部为纯实数且为负：\n$$\n\\omega_{i,1} = -\\frac{1}{2}\\left(\\alpha - \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)\n$$\n$$\n\\omega_{i,2} = -\\frac{1}{2}\\left(\\alpha + \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)\n$$\n相应的阻尼率为 $\\gamma_1 = |\\omega_{i,1}|$ 和 $\\gamma_2 = |\\omega_{i,2}|$。由于 $\\sqrt{\\alpha^2 - 4k^2c_h^2}  \\alpha$ (对于 $k \\neq 0$)，所以 $\\gamma_1  \\gamma_2$。主导（最慢）的阻尼率是较小的一个，即 $\\gamma_1$。\n主导阻尼率为 $\\gamma = \\frac{1}{2}\\left(\\alpha - \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)$。这个单一公式涵盖了临界阻尼 ($4k^2c_h^2 = \\alpha^2$，得出 $\\gamma = \\alpha/2$) 和过阻尼 ($4k^2c_h^2  \\alpha^2$) 两种情况。\n\n待实现的表达式总结：\n1. 正特征速度：$+c_h$。\n2. 负特征速度：$-c_h$。\n3. 如果 $(2kc_h)^2 > \\alpha^2$：正相速度为 $\\sqrt{c_h^2 - (\\alpha/(2k))^2}$，负相速度为 $-\\sqrt{c_h^2 - (\\alpha/(2k))^2}$，主导阻尼率为 $\\alpha/2$。\n4. 如果 $(2kc_h)^2 \\le \\alpha^2$：两个相速度均为 $0$，主导阻尼率为 $\\frac{1}{2}(\\alpha - \\sqrt{\\alpha^2 - (2kc_h)^2})$。当 $(2kc_h)^2 \\ll \\alpha^2$ 时，为保证数值稳定性，最好按如下方式计算：$\\frac{(2kc_h)^2}{2(\\alpha + \\sqrt{\\alpha^2 - (2kc_h)^2})}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the GLM-MHD divergence cleaning problem by deriving and evaluating\n    characteristic speeds, phase speeds, and damping rates.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (c_h, alpha, k)\n    test_cases = [\n        (1.00e5, 1.00e3, 1.00e-1), # Test case 1 (underdamped)\n        (3.00e4, 1.20e5, 2.00),     # Test case 2 (critical)\n        (2.00e4, 1.00e5, 1.00e-1), # Test case 3 (overdamped)\n        (5.00e5, 1.00e3, 1.00e3),     # Test case 4 (high-k underdamped)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c_h, alpha, k = case\n        \n        # 1.  2. Characteristic speeds\n        c_char_pos = c_h\n        c_char_neg = -c_h\n        \n        # Determine the regime by comparing (2*k*c_h)^2 and alpha^2\n        # This is equivalent to comparing 2*k*c_h and alpha (since all are positive)\n        term_hyperbolic = 2.0 * k * c_h\n        \n        if term_hyperbolic > alpha:\n            # Underdamped regime\n            \n            # 3.  4. Phase speeds\n            # Formula: v_ph = sqrt(c_h^2 - (alpha/(2*k))^2)\n            phase_speed_val = np.sqrt(c_h**2 - (alpha / (2.0 * k))**2)\n            v_phase_pos = phase_speed_val\n            v_phase_neg = -phase_speed_val\n            \n            # 5. Dominant damping rate\n            # Formula: gamma = alpha/2\n            damping_rate = alpha / 2.0\n            \n        else:\n            # Overdamped or critical regime\n            \n            # 3.  4. Phase speeds\n            # Phase speed is 0 for non-oscillatory modes\n            v_phase_pos = 0.0\n            v_phase_neg = 0.0\n            \n            # 5. Dominant damping rate\n            # Formula: gamma = 0.5 * (alpha - sqrt(alpha^2 - (2*k*c_h)^2))\n            # The following numerically stable form is used to avoid\n            # catastrophic cancellation when (2*k*c_h)^2 is small compared to alpha^2.\n            # gamma = (2*k*c_h)^2 / (2 * (alpha + sqrt(alpha^2 - (2*k*c_h)^2)))\n            term_hyperbolic_sq = term_hyperbolic**2\n            alpha_sq = alpha**2\n            \n            # The term under the square root is guaranteed non-negative in this branch.\n            sqrt_term = np.sqrt(alpha_sq - term_hyperbolic_sq)\n            \n            # In the critical case, sqrt_term is 0 and this simplifies to\n            # (alpha^2) / (2*alpha) = alpha/2, which is correct.\n            damping_rate = term_hyperbolic_sq / (2.0 * (alpha + sqrt_term))\n\n        case_results = [\n            c_char_pos,\n            c_char_neg,\n            v_phase_pos,\n            v_phase_neg,\n            damping_rate\n        ]\n        results.append(case_results)\n\n    # Format the final output string exactly as required.\n    # Each number is formatted to 6 significant figures using {:.5e}\n    # No spaces are used, only commas.\n    outer_parts = []\n    for inner_list in results:\n        formatted_inner_list = [f\"{val:.6g}\" if val == 0 else f\"{val:.5e}\" for val in inner_list]\n        outer_parts.append(f\"[{','.join(formatted_inner_list)}]\")\n    \n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    # Correcting the output format to avoid scientific notation for 0 and have 6 significant figures.\n    final_output_string = final_output_string.replace('.000000e+00', '.00000e+00').replace('e+0', 'e+').replace('e-0', 'e-')\n\n    # Re-generating string with correct formatting logic from scratch to be more robust\n    final_parts = []\n    for inner_list in results:\n        inner_parts = []\n        for val in inner_list:\n            if val == 0.0:\n                inner_parts.append(f\"{val:.6g}\")\n            else:\n                # Format to 6 significant figures in scientific notation\n                inner_parts.append(f\"{val:.5e}\")\n        final_parts.append(f\"[{','.join(inner_parts)}]\")\n    final_output_string = f\"[{','.join(final_parts)}]\"\n    # Python's default scientific notation might use 'e+05', but problem asks for 'e+5' style if possible.\n    # Let's adjust for that\n    final_output_string = final_output_string.replace('e+0', 'e+').replace('e-0', 'e-')\n\n\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}