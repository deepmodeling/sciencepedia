{
    "hands_on_practices": [
        {
            "introduction": "This exercise solidifies your understanding of fundamental energy conservation in electromagnetism and its application to ideal MHD. You will apply Maxwell's equations and the perfect conductor boundary condition to derive the net energy flux, represented by the Poynting vector $\\mathbf{S}$, across the boundary of a confined plasma. This practice is crucial for analyzing power balance and plasma-wall interactions in fusion devices. ",
            "id": "3992290",
            "problem": "An axisymmetric magnetically confined plasma occupies a simply connected domain $\\Omega$ bounded by a smooth, stationary, perfectly conducting wall $\\partial \\Omega$ with unit outward normal $\\mathbf{n}(\\mathbf{x})$. The plasma is described by ideal magnetohydrodynamics (MHD), specifically the ideal Ohm’s law $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$, and the electromagnetic fields obey Maxwell’s equations in the plasma region. The wall is a perfect conductor with no motion relative to the laboratory frame.\n\nStarting from the fundamental electromagnetic conservation laws and boundary conditions implied by Maxwell’s equations at a perfectly conducting surface, determine the normal component of the electromagnetic energy flux density (the Poynting vector) through the wall, integrated over $\\partial \\Omega$, i.e., compute the net electromagnetic power crossing the boundary,\n$$\nP \\equiv \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA,\n$$\nwhere $\\mathbf{S}$ is the electromagnetic energy flux density. Express the final answer in Watts. No rounding is required.\n\nIn addition, state the boundary conditions (in terms of field and flow components at $\\partial \\Omega$) under which there is zero net electromagnetic energy transfer across the wall in ideal MHD.\n\nYour derivation must begin from the electromagnetic energy conservation law and the perfect conductor boundary conditions that follow from Maxwell’s equations, without invoking heuristic shortcuts. Clearly articulate each step connecting the fundamental laws to the evaluation of $P$ at the perfectly conducting wall.",
            "solution": "The problem requires the calculation of the net electromagnetic power $P$ crossing the boundary $\\partial\\Omega$ of a plasma confinement domain, and the identification of the ideal magnetohydrodynamics (MHD) boundary conditions under which this power transfer is zero. The domain $\\Omega$ is enclosed by a perfectly conducting, smooth, stationary wall $\\partial\\Omega$.\n\nThe validation of the problem statement proceeds as follows.\nStep 1: Extract Givens.\n- The plasma domain $\\Omega$ is axisymmetric and simply connected.\n- The boundary $\\partial\\Omega$ is a smooth, stationary, perfectly conducting wall.\n- The unit outward normal to the wall is $\\mathbf{n}(\\mathbf{x})$.\n- The plasma is described by ideal MHD, including the ideal Ohm's law: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$.\n- Electromagnetic fields obey Maxwell’s equations.\n- The quantity to be computed is the net electromagnetic power $P \\equiv \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA$, where $\\mathbf{S}$ is the Poynting vector.\n- A secondary task is to state the boundary conditions for $P=0$.\n- The derivation must be from first principles.\n\nStep 2: Validate Using Extracted Givens.\n- Scientific and Factual Soundness: The problem is formulated within the standard, well-established theoretical frameworks of classical electromagnetism and ideal MHD. All concepts, such as Maxwell's equations, the Poynting vector, perfect conductors, and ideal Ohm's law, are fundamental to plasma physics. The problem is scientifically grounded.\n- Well-Posedness and Completeness: The problem is well-posed. It specifies the physical model, the domain, the boundary properties, and the quantity to be calculated. The information provided is sufficient and self-consistent to derive a unique solution.\n- Objectivity and Clarity: The problem is stated using precise, objective, and unambiguous scientific language.\n\nStep 3: Verdict and Action.\nThe problem is valid. It is a standard, non-trivial exercise in applying fundamental principles of electromagnetism and plasma physics. The solution process may proceed.\n\nThe electromagnetic energy flux density is given by the Poynting vector, $\\mathbf{S}$. In SI units, this is defined as:\n$$\n\\mathbf{S} = \\frac{1}{\\mu_0} (\\mathbf{E} \\times \\mathbf{B})\n$$\nwhere $\\mathbf{E}$ is the electric field, $\\mathbf{B}$ is the magnetic field, and $\\mu_0$ is the permeability of free space.\n\nThe net electromagnetic power $P$ flowing out of the domain $\\Omega$ through its boundary $\\partial\\Omega$ is the surface integral of the normal component of the Poynting vector:\n$$\nP = \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA = \\int_{\\partial \\Omega} \\frac{1}{\\mu_0} (\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n} \\, dA\n$$\nTo evaluate this integral, we must determine the value of the integrand $(\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n}$ on the boundary $\\partial\\Omega$. We can use the scalar triple product identity, $(\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C} = \\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C})$, to rewrite the integrand:\n$$\n(\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n} = \\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n})\n$$\nThe problem states that the wall $\\partial\\Omega$ is a perfect conductor. A fundamental boundary condition from Maxwell's equations at the surface of a perfect conductor is that the tangential component of the electric field must be zero. If a tangential component existed, it would drive an infinite surface current, which is unphysical. This condition is expressed as:\n$$\n\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\nThis vector equation implies that the electric field vector $\\mathbf{E}$ at any point on the surface $\\partial\\Omega$ must be perpendicular to the surface at that point. In other words, $\\mathbf{E}$ must be parallel to the normal vector $\\mathbf{n}$. We can write this as $\\mathbf{E} = (\\mathbf{E} \\cdot \\mathbf{n}) \\mathbf{n}$ on $\\partial\\Omega$.\n\nNow consider the other vector in the dot product, $(\\mathbf{B} \\times \\mathbf{n})$. By the definition of the cross product, the vector resulting from $\\mathbf{B} \\times \\mathbf{n}$ is perpendicular to both $\\mathbf{B}$ and $\\mathbf{n}$. Since it is perpendicular to $\\mathbf{n}$, the vector $(\\mathbf{B} \\times \\mathbf{n})$ must lie in the plane tangent to the surface $\\partial\\Omega$.\n\nWe are now evaluating the dot product of two vectors on the surface $\\partial\\Omega$: the electric field $\\mathbf{E}$, which is normal to the surface, and the vector $(\\mathbf{B} \\times \\mathbf{n})$, which is tangential to the surface. The dot product of any normal vector with any tangential vector at the same point on a surface is zero. Therefore, we have:\n$$\n\\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n}) = 0 \\quad \\text{on } \\partial\\Omega\n$$\nSince the integrand $\\mathbf{S} \\cdot \\mathbf{n} = \\frac{1}{\\mu_0} \\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n})$ is identically zero at all points on the boundary $\\partial\\Omega$, the integral must also be zero:\n$$\nP = \\int_{\\partial \\Omega} 0 \\, dA = 0\n$$\nThe net electromagnetic power crossing the boundary is zero. The answer is $0$ Watts. This result is a direct consequence of the boundary being a stationary perfect conductor, independent of the ideal MHD model of the interior plasma.\n\nThe second part of the problem asks for the boundary conditions, in terms of field and flow components, under which this zero net energy transfer occurs. As shown above, the condition $P=0$ is guaranteed by the electromagnetic boundary condition $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ at a perfect conductor. We now connect this to the fluid and field variables of ideal MHD. The problem specifies three key physical constraints:\n1. The wall is a perfect conductor: $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ on $\\partial\\Omega$.\n2. The plasma obeys ideal Ohm's Law: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$.\n3. The wall is stationary and impermeable, so the normal component of the plasma velocity at the wall is zero: $\\mathbf{v} \\cdot \\mathbf{n} = 0$ on $\\partial\\Omega$.\n\nWe can derive the corresponding ideal MHD boundary conditions by ensuring these three constraints are mutually consistent. From Ohm's law (constraint 2), we have $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$. Substituting this into the perfect conductor condition (constraint 1) gives:\n$$\n\\mathbf{n} \\times (-\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\nUsing the vector triple product identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$, we expand the expression:\n$$\n-[\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(\\mathbf{n} \\cdot \\mathbf{v})] = \\mathbf{0}\n$$\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(\\mathbf{n} \\cdot \\mathbf{v}) = \\mathbf{0}\n$$\nNow, we apply the impermeable wall condition (constraint 3), $\\mathbf{v} \\cdot \\mathbf{n} = 0$:\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(0) = \\mathbf{0}\n$$\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\nThis equation, $\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) = \\mathbf{0}$, presents a dichotomy: at any point on the boundary, either the plasma is stationary ($\\mathbf{v}=\\mathbf{0}$, the line-tying condition), or the magnetic field is parallel to the wall ($\\mathbf{n}\\cdot\\mathbf{B}=0$). For a plasma that is perfectly confined within the domain $\\Omega$ and assumed to be free to slip along the boundary, the condition must hold for arbitrary tangential velocities. This requires the magnetic field itself to be tangential to the boundary.\nTherefore, for such a confined plasma configuration, we must have:\n$$\n\\mathbf{B} \\cdot \\mathbf{n} = 0 \\quad \\text{on } \\partial\\Omega\n$$\nThis condition states that the magnetic field must be purely tangential to the perfectly conducting wall.\n\nIn summary, the consistent set of boundary conditions for ideal MHD at a stationary, impermeable, perfectly conducting wall, which ensures zero net electromagnetic energy transfer, is:\n1. The normal component of the plasma velocity is zero: $\\mathbf{v} \\cdot \\mathbf{n} = 0$.\n2. The normal component of the magnetic field is zero: $\\mathbf{B} \\cdot \\mathbf{n} = 0$.\n\nThese two conditions on the MHD variables $\\mathbf{v}$ and $\\mathbf{B}$ are the physical manifestation of the problem's constraints and are sufficient to guarantee $P=0$.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Moving from theory to computation, this practice addresses a critical step in numerical MHD solvers: the conversion from conserved to primitive variables. You will derive the expression for thermal pressure $p$ from the total energy density $E$ and design a \"positivity-preserving\" algorithm. This type of regulator is essential for handling numerical errors that can arise in extreme regimes, such as near-vacuum regions, ensuring the simulation remains physically plausible. ",
            "id": "3992296",
            "problem": "A single-fluid model of Magnetohydrodynamics (MHD) in the ideal limit advances conserved variables for a compressible, electrically conducting plasma. In a finite-volume discretization, at any cell one stores the mass density $ \\rho $ in $ \\mathrm{kg/m^3} $, the momentum density vector $ \\mathbf{m} = \\rho \\mathbf{v} $ in $ \\mathrm{kg/(m^2 \\, s)} $, the magnetic field $ \\mathbf{B} $ in $ \\mathrm{T} $, and the total energy density $ E $ in $ \\mathrm{J/m^3} $ (equivalently $ \\mathrm{Pa} $). The adiabatic index is $ \\gamma $ (dimensionless). In the ideal MHD model with an ideal gas closure, the total energy density satisfies\n$$\nE \\;=\\; \\rho \\varepsilon \\;+\\; \\frac{1}{2} \\rho \\lVert \\mathbf{v} \\rVert^2 \\;+\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0},\n$$\nwhere $ \\varepsilon $ is the specific internal energy in $ \\mathrm{J/kg} $, and $ \\mu_0 $ is the magnetic permeability of free space in $ \\mathrm{N/A^2} $ (equivalently $ \\mathrm{H/m} $). The ideal-gas pressure $ p $ in $ \\mathrm{Pa} $ is related to the internal energy density $ \\rho \\varepsilon $ by\n$$\np \\;=\\; (\\gamma - 1) \\, \\rho \\varepsilon.\n$$\nHence, from the conserved state $ (\\rho, \\mathbf{m}, \\mathbf{B}, E) $, one may reconstruct the pressure via\n$$\nK \\;=\\; \\frac{1}{2} \\, \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho}, \\qquad\nE_{\\mathrm{mag}} \\;=\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}, \\qquad\np \\;=\\; (\\gamma - 1) \\, \\big( E - K - E_{\\mathrm{mag}} \\big).\n$$\n\nHowever, in near-vacuum cells emerging in computational fusion science and engineering (for example at the plasma edge or near material interfaces), numerical errors may drive the reconstructed pressure negative even if $ E $ is nonnegative and divergence errors are controlled. To robustly preserve pressure positivity, design a regulator that imposes a physically motivated lower bound (a floor) on the pressure while minimally perturbing the conserved state. Consider a floor of the form\n$$\np_{\\min} \\;=\\; \\max\\!\\Big( p_{\\mathrm{abs}}, \\; \\beta_{\\min} \\, p_{\\mathrm{mag}} \\Big), \\qquad p_{\\mathrm{mag}} \\;=\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0},\n$$\nwhere $ p_{\\mathrm{abs}} $ in $ \\mathrm{Pa} $ is an absolute pressure floor and $ \\beta_{\\min} $ is a prescribed minimum plasma beta. Your regulator must act in the following order to achieve pressure positivity with minimal modification:\n- First, attempt to reduce the kinetic energy by scaling the momentum to increase the internal energy at fixed total energy, i.e., set $ \\mathbf{m}' = \\alpha \\, \\mathbf{m} $ with $ \\alpha \\in [0,1] $ chosen such that the target internal energy density equals $ p_{\\min} / (\\gamma - 1) $ if feasible.\n- If even zero momentum is insufficient (i.e., the total energy minus magnetic energy cannot supply the required internal energy), then inject the smallest amount of total energy consistent with $ p = p_{\\min} $ by setting $ E' = E_{\\mathrm{mag}} + p_{\\min} / (\\gamma - 1) $ and $ \\mathbf{m}' = \\mathbf{0} $.\n\nTasks:\n- Starting only from the relations above and the definitions of kinetic and magnetic energy densities, derive the expression to compute $ p $ from $ (\\rho, \\mathbf{m}, \\mathbf{B}, E) $.\n- Propose and formalize the positivity regulator described, and implement it algorithmically. The regulator must:\n  - Compute the unregulated pressure $ p $.\n  - Compute the floor $ p_{\\min} $.\n  - If $ p \\ge p_{\\min} $, leave the state unchanged and report the pressure.\n  - Otherwise, compute the required internal energy density $ e_{\\min} = p_{\\min} / (\\gamma - 1) $. Let the current kinetic energy density be $ K = \\frac{1}{2} \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho} $. Define the target kinetic energy density\n    $$\n    K_{\\mathrm{tgt}} \\;=\\; E - E_{\\mathrm{mag}} - e_{\\min}.\n    $$\n    If $ K_{\\mathrm{tgt}} \\in [0, K] $ and $ K > 0 $, set $ \\alpha = \\sqrt{ K_{\\mathrm{tgt}} / K } $ and $ \\mathbf{m}' = \\alpha \\mathbf{m} $, leaving $ E $ unchanged, which yields exactly $ p = p_{\\min} $. If $ K_{\\mathrm{tgt}} \\le 0 $ or $ K = 0 $, set $ \\mathbf{m}' = \\mathbf{0} $ and $ E' = E_{\\mathrm{mag}} + e_{\\min} $, which yields exactly $ p = p_{\\min} $.\n- Express all pressures in $ \\mathrm{Pa} $.\n\nUse the following constants and test suite. All quantities are in the International System of Units (SI):\n- $ \\gamma = \\frac{5}{3} $,\n- $ \\mu_0 = 4 \\pi \\times 10^{-7} $,\n- $ \\beta_{\\min} = 10^{-3} $,\n- $ p_{\\mathrm{abs}} = 10^{-6} $.\n\nTest suite cases $ (\\rho, \\mathbf{m}, \\mathbf{B}, E) $:\n- Case A (no regulation needed): $ \\rho = 1.0 $, $ \\mathbf{m} = (10.0, 0.0, 0.0) $, $ \\mathbf{B} = (0.1, 0.1, 0.0) $. Choose an intended thermodynamic pressure $ p_\\ast = 1000.0 $, and set\n  $$\n  E \\;=\\; \\frac{p_\\ast}{\\gamma - 1} \\;+\\; \\frac{1}{2} \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho} \\;+\\; \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0} \\;=\\; 9507.747154594767.\n  $$\n- Case B (regulation via momentum scaling only): $ \\rho = 10^{-5} $, $ \\mathbf{m} = (1.0, 0.0, 0.0) $, $ \\mathbf{B} = (0.0, 0.0, 0.0) $, $ E = 1.0 $.\n- Case C (regulation via energy injection with zero momentum): $ \\rho = 10^{-6} $, $ \\mathbf{m} = (0.0, 0.0, 0.0) $, $ \\mathbf{B} = (0.0, 0.0, 0.0) $, $ E = 10^{-6} $.\n- Case D (exactly on the floor by construction): $ \\rho = 0.1 $, $ \\mathbf{m} = (0.3, 0.0, 0.0) $, $ \\mathbf{B} = (0.2, 0.0, 0.0) $, $ E = 15939.817550653318 $.\n- Case E (strong magnetic field, regulation via momentum scaling): $ \\rho = 1.0 $, $ \\mathbf{m} = (100.0, 0.0, 0.0) $, $ \\mathbf{B} = (1.0, 0.0, 0.0) $, $ E = 403257.1705534973 $.\n\nYour program must, for each case, compute the regulated pressure $ p_{\\mathrm{reg}} $ in $ \\mathrm{Pa} $ using the algorithm above and output the list of $ p_{\\mathrm{reg}} $ values in order $ [A, B, C, D, E] $.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D,\\text{result}_E] $).\n- Each list entry must be a real number (a float) representing the regulated pressure in $ \\mathrm{Pa} $ for the corresponding test case.",
            "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of ideal magnetohydrodynamics (MHD), is well-posed with a clear objective, and provides a self-contained, consistent set of definitions, constants, and test cases. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe task is to derive the expression for thermodynamic pressure from a set of conserved variables and to design and implement a numerical regulator to ensure this pressure remains non-negative, a common challenge in computational plasma physics.\n\nFirst, we derive the expression for pressure $p$ from the given conserved state variables: mass density $\\rho$, momentum density $\\mathbf{m}$, magnetic field $\\mathbf{B}$, and total energy density $E$.\n\nThe total energy density $E$ is given by the sum of internal, kinetic, and magnetic energy densities:\n$$\nE = \\rho \\varepsilon + \\frac{1}{2} \\rho \\lVert \\mathbf{v} \\rVert^2 + \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}\n$$\nwhere $\\varepsilon$ is the specific internal energy, $\\mathbf{v}$ is the fluid velocity, and $\\mu_0$ is the permeability of free space. The term $\\rho \\varepsilon$ represents the internal energy density.\n\nThe momentum density is defined as $\\mathbf{m} = \\rho \\mathbf{v}$. From this, the velocity is $\\mathbf{v} = \\mathbf{m} / \\rho$.\nThe kinetic energy density, denoted $K$, can be expressed in terms of the conserved variables $\\rho$ and $\\mathbf{m}$:\n$$\nK = \\frac{1}{2} \\rho \\lVert \\mathbf{v} \\rVert^2 = \\frac{1}{2} \\rho \\left\\lVert \\frac{\\mathbf{m}}{\\rho} \\right\\rVert^2 = \\frac{1}{2} \\rho \\frac{\\lVert \\mathbf{m} \\rVert^2}{\\rho^2} = \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho}\n$$\nThe magnetic energy density, denoted $E_{\\mathrm{mag}}$, is given by:\n$$\nE_{\\mathrm{mag}} = \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}\n$$\nWe can now rearrange the equation for total energy density $E$ to solve for the internal energy density $\\rho \\varepsilon$:\n$$\n\\rho \\varepsilon = E - K - E_{\\mathrm{mag}} = E - \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho} - \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}\n$$\nThe problem states that for an ideal gas, the pressure $p$ is related to the internal energy density by:\n$$\np = (\\gamma - 1) \\rho \\varepsilon\n$$\nwhere $\\gamma$ is the adiabatic index. Substituting the expression for $\\rho \\varepsilon$ yields the formula for pressure:\n$$\np = (\\gamma - 1) \\left( E - \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho} - \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0} \\right)\n$$\nThis completes the derivation of the pressure from the conserved state variables.\n\nNext, we formalize the pressure positivity regulator algorithm. The goal is to enforce a minimum pressure $p_{\\min}$ if the calculated pressure $p$ falls below this floor, while minimally perturbing the conserved state.\n\nThe algorithm proceeds as follows:\n\n1.  **Input**: State variables $(\\rho, \\mathbf{m}, \\mathbf{B}, E)$ and physical/numerical constants $(\\gamma, \\mu_0, \\beta_{\\min}, p_{\\mathrm{abs}})$.\n\n2.  **Compute Derived Quantities**:\n    - Kinetic energy density: $K = \\frac{\\lVert \\mathbf{m} \\rVert^2}{2 \\rho}$.\n    - Magnetic energy density: $E_{\\mathrm{mag}} = \\frac{\\lVert \\mathbf{B} \\rVert^2}{2 \\mu_0}$.\n    - Pressure: $p = (\\gamma - 1) (E - K - E_{\\mathrm{mag}})$.\n\n3.  **Compute Pressure Floor**:\n    - The magnetic pressure is defined as $p_{\\mathrm{mag}} = E_{\\mathrm{mag}}$.\n    - The pressure floor is $p_{\\min} = \\max(p_{\\mathrm{abs}}, \\beta_{\\min} \\cdot p_{\\mathrm{mag}})$.\n\n4.  **Decision and Regulation**:\n    - Check if $p \\ge p_{\\min}$.\n    - **If $p \\ge p_{\\min}$**: The state is physically valid. The regulated pressure $p_{\\mathrm{reg}}$ is simply $p$. The state variables $(\\mathbf{m}, E)$ are unchanged.\n    - **If $p < p_{\\min}$**: The pressure is unphysically low and must be regulated. The target regulated pressure is $p_{\\min}$.\n        a. Calculate the required internal energy density to achieve this pressure: $e_{\\min} = \\frac{p_{\\min}}{\\gamma - 1}$.\n        b. Calculate the target kinetic energy density, $K_{\\mathrm{tgt}}$. This is the amount of kinetic energy that would remain if the internal energy were raised to $e_{\\min}$ while keeping the total energy $E$ and magnetic energy $E_{\\mathrm{mag}}$ fixed:\n           $$\n           K_{\\mathrm{tgt}} = E - E_{\\mathrm{mag}} - e_{\\min}\n           $$\n        c. **Regulation by Momentum Scaling**: This is the preferred method, as it conserves total energy. It is possible if the target kinetic energy is non-negative, $K_{\\mathrm{tgt}} \\ge 0$. The check is specified as $K_{\\mathrm{tgt}} \\in [0, K]$ and $K > 0$. If $p < p_{\\min}$, it can be shown that $K_{\\mathrm{tgt}} < K$, so the condition simplifies to $K_{\\mathrm{tgt}} \\ge 0$ and $K > 0$.\n           - If this condition holds, calculate the momentum scaling factor $\\alpha$:\n             $$\n             \\alpha = \\sqrt{\\frac{K_{\\mathrm{tgt}}}{K}}\n             $$\n           - The state is updated: $\\mathbf{m}' = \\alpha \\mathbf{m}$ and $E' = E$. The new kinetic energy is $K' = K_{\\mathrm{tgt}}$, and the new pressure is exactly $p_{\\min}$. The regulated pressure is $p_{\\mathrm{reg}} = p_{\\min}$.\n        d. **Regulation by Energy Injection**: This is the fallback method used when momentum scaling is insufficient, i.e., when $K_{\\mathrm{tgt}} < 0$, or when there is no kinetic energy to remove ($K=0$). The total energy must be increased to accommodate the floor pressure.\n           - The state is updated: $\\mathbf{m}' = \\mathbf{0}$ (all kinetic energy is removed), and the total energy is set to the minimum value consistent with the pressure floor:\n             $$\n             E' = E_{\\mathrm{mag}} + e_{\\min}\n             $$\n           - The new kinetic energy is $K' = 0$, and the new pressure is exactly $p_{\\min}$. The regulated pressure is $p_{\\mathrm{reg}} = p_{\\min}$.\n\nThis two-stage procedure ensures pressure positivity by first attempting to convert excess kinetic energy into internal energy (conserving total energy) and only injecting energy as a last resort. The final regulated pressure reported will be the result of this process.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Implements and tests a pressure positivity regulator for ideal MHD simulations.\n    \"\"\"\n    \n    # Define physical and numerical constants\n    gamma = 5.0 / 3.0\n    mu0 = 4.0 * math.pi * 1e-7\n    beta_min = 1e-3\n    p_abs = 1e-6\n\n    # Test suite cases (rho, m_vec, B_vec, E)\n    test_cases = [\n        # Case A: No regulation needed\n        (1.0, np.array([10.0, 0.0, 0.0]), np.array([0.1, 0.1, 0.0]), 9507.747154594767),\n        \n        # Case B: Regulation via momentum scaling\n        (1e-5, np.array([1.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]), 1.0),\n        \n        # Case C: Regulation via energy injection\n        (1e-6, np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]), 1e-6),\n        \n        # Case D: Exactly on the floor\n        (0.1, np.array([0.3, 0.0, 0.0]), np.array([0.2, 0.0, 0.0]), 15939.817550653318),\n        \n        # Case E: Strong B-field, regulation via momentum scaling\n        (1.0, np.array([100.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), 403257.1705534973)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        rho, m_vec, B_vec, E = case\n        \n        # Compute squared norms\n        m_sq = np.dot(m_vec, m_vec)\n        B_sq = np.dot(B_vec, B_vec)\n        \n        # Compute kinetic and magnetic energy densities\n        # A small epsilon is added to rho to prevent division by zero in pathological cases,\n        # although not strictly necessary for the given test suite.\n        K = 0.5 * m_sq / (rho + 1e-99)\n        E_mag = B_sq / (2.0 * mu0)\n        \n        # Compute the initial pressure\n        p = (gamma - 1.0) * (E - K - E_mag)\n\n        # Compute the pressure floor\n        p_mag = E_mag\n        p_min = max(p_abs, beta_min * p_mag)\n\n        # Check if regulation is needed\n        if p >= p_min:\n            # No regulation needed\n            p_reg = p\n        else:\n            # Regulation is needed; the final pressure will be p_min\n            p_reg = p_min\n            \n            # This part of the code would modify the state (m, E)\n            # but for this problem, we only need to report the regulated pressure.\n            # The logic is retained for completeness.\n            \n            # Required internal energy density for p_min\n            e_min = p_min / (gamma - 1.0)\n            \n            # Target kinetic energy density\n            K_tgt = E - E_mag - e_min\n            \n            # Decide on the regulation strategy\n            if K > 1e-99 and K_tgt >= 0.0:\n                # Strategy 1: Momentum scaling\n                # alpha = math.sqrt(K_tgt / K)\n                # m_vec_new = alpha * m_vec\n                # E_new = E\n                pass # State change not needed for final output\n            else:\n                # Strategy 2: Energy injection\n                # m_vec_new = np.array([0.0, 0.0, 0.0])\n                # E_new = E_mag + e_min\n                pass # State change not needed for final output\n                \n        results.append(p_reg)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The ideal MHD equations include the challenging constraint that the magnetic field must remain divergence-free, $\\nabla \\cdot \\mathbf{B} = 0$. This practice explores the Generalized Lagrange Multiplier (GLM) method, a powerful technique for numerically enforcing this constraint. By deriving and analyzing the properties of the GLM cleaning waves, you will gain insight into how divergence errors are propagated and damped in modern MHD simulations. ",
            "id": "3992275",
            "problem": "Consider the Generalized Lagrange Multiplier (GLM) hyperbolic-parabolic cleaning method applied to the ideal Magnetohydrodynamics (MHD) equations, where the magnetic field $\\mathbf{B}$ is augmented with a scalar cleaning field $\\psi$ to reduce and advect divergence errors. Starting from fundamental laws, namely Faraday's law of induction and the ideal Ohm's law, together with the solenoidal constraint on the magnetic field, derive a one-dimensional linear cleaning subsystem in which divergence errors in $\\mathbf{B}$ are both advected and damped by appropriately coupling $\\psi$ to $\\mathbf{B}$. Use this subsystem to obtain closed-form expressions for the characteristic speeds, the phase speed of divergence-error waves, and the dominant decay rate of divergence-error amplitudes, expressed as functions of a hyperbolic cleaning speed $c_h$ (with units $\\mathrm{m/s}$), a linear damping coefficient $\\alpha$ (with units $\\mathrm{s^{-1}}$), and a wavenumber $k$ (with units $\\mathrm{m^{-1}}$). Ensure your derivation is rooted in the base physical laws and does not assume any pre-derived GLM formulas.\n\nYour program must implement the expressions you derive and evaluate them for the following test suite of parameter triples $(c_h,\\alpha,k)$:\n- Test case 1 (underdamped regime): $c_h = 1.00\\times 10^{5}\\ \\mathrm{m/s}$, $\\alpha = 1.00\\times 10^{3}\\ \\mathrm{s^{-1}}$, $k = 1.00\\times 10^{-1}\\ \\mathrm{m^{-1}}$.\n- Test case 2 (critical regime): $c_h = 3.00\\times 10^{4}\\ \\mathrm{m/s}$, $\\alpha = 1.20\\times 10^{5}\\ \\mathrm{s^{-1}}$, $k = 2.00\\ \\mathrm{m^{-1}}$.\n- Test case 3 (overdamped regime): $c_h = 2.00\\times 10^{4}\\ \\mathrm{m/s}$, $\\alpha = 1.00\\times 10^{5}\\ \\mathrm{s^{-1}}$, $k = 1.00\\times 10^{-1}\\ \\mathrm{m^{-1}}$.\n- Test case 4 (high-$k$ underdamped regime): $c_h = 5.00\\times 10^{5}\\ \\mathrm{m/s}$, $\\alpha = 1.00\\times 10^{3}\\ \\mathrm{s^{-1}}$, $k = 1.00\\times 10^{3}\\ \\mathrm{m^{-1}}$.\n\nFor each test case, your program must compute and output a list of five floats:\n1. The positive characteristic speed $+c_h$ in $\\mathrm{m/s}$.\n2. The negative characteristic speed $-c_h$ in $\\mathrm{m/s}$.\n3. The positive phase speed of divergence-error waves in $\\mathrm{m/s}$.\n4. The negative phase speed of divergence-error waves in $\\mathrm{m/s}$.\n5. The dominant damping rate of divergence-error amplitude in $\\mathrm{s^{-1}}$.\n\nIf the regime is oscillatory (underdamped), the phase speeds must reflect the real part of the angular frequency divided by $k$; if the regime is non-oscillatory (overdamped or critical), the phase speeds must be reported as $0$ in $\\mathrm{m/s}$, and the dominant damping rate must correspond to the slowest decaying exponential mode. Express all speeds in $\\mathrm{m/s}$ and all damping rates in $\\mathrm{s^{-1}}$, rounded to six significant figures.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a comma-separated list enclosed in square brackets. For example, the output format must be of the form\n$[\\,[x_{1},y_{1},z_{1},w_{1},r_{1}],\\,[x_{2},y_{2},z_{2},w_{2},r_{2}],\\,\\dots\\,]$\nwith no spaces anywhere in the line.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of computational magnetohydrodynamics, well-posed, and contains all necessary information for a rigorous derivation and solution.\n\nThe derivation of the one-dimensional linear Generalized Lagrange Multiplier (GLM) cleaning subsystem begins with the fundamental laws governing the magnetic field $\\mathbf{B}$ in ideal Magnetohydrodynamics (MHD).\n\nFaraday's law of induction is given by:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\nIn ideal MHD, the electric field $\\mathbf{E}$ is determined by the ideal Ohm's law:\n$$\n\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\nwhere $\\mathbf{v}$ is the plasma fluid velocity. Combining these gives the induction equation:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\nThe solenoidal constraint, a consequence of Maxwell's equations, requires that the magnetic field be divergence-free:\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\nTaking the divergence of the induction equation yields $\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{B}) = \\nabla \\cdot (\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})) \\equiv 0$. This implies that any initial non-zero divergence, which may arise from numerical discretization errors, is conserved over time and not corrected by the physical equations.\n\nThe GLM method addresses this by augmenting the ideal MHD system. A scalar field, $\\psi$, is introduced, and the equations are modified to actively transport and damp divergence errors. The modified induction equation and a new evolution equation for $\\psi$ are introduced as follows:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) + \\nabla \\psi = 0\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 (\\nabla \\cdot \\mathbf{B}) + \\alpha \\psi = 0\n$$\nHere, $c_h$ is a hyperbolic cleaning speed and $\\alpha$ is a parabolic damping coefficient. Taking the divergence of the modified induction equation, and using the identity $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$, we find a coupling between the time evolution of the divergence error and $\\psi$:\n$$\n\\frac{\\partial (\\nabla \\cdot \\mathbf{B})}{\\partial t} + \\nabla^2 \\psi = 0\n$$\nThis system ensures that if a divergence error $\\nabla \\cdot \\mathbf{B}$ exists, it will induce a change in $\\psi$, which in turn drives the system towards a state where $\\nabla \\cdot \\mathbf{B} = 0$.\n\nTo derive the one-dimensional linear cleaning subsystem as requested, we consider a simplified scenario where variations occur only along the $x$-axis, so $\\nabla = (\\frac{\\partial}{\\partial x}, 0, 0)$. Furthermore, we analyze the system in the absence of fluid motion ($\\mathbf{v}=0$) to isolate the cleaning mechanism. The components of $\\mathbf{B}$ are $(B_x, B_y, B_z)$.\nThe divergence becomes $\\nabla \\cdot \\mathbf{B} = \\frac{\\partial B_x}{\\partial x}$. The term $\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})$ vanishes. The modified induction equation becomes:\n$$\n\\frac{\\partial B_x}{\\partial t} + \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = 0\n$$\n$$\n\\frac{\\partial B_z}{\\partial t} = 0\n$$\nThe evolution equation for $\\psi$ in 1D is:\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 \\frac{\\partial B_x}{\\partial x} + \\alpha \\psi = 0\n$$\nThe equations for $B_y$ and $B_z$ are trivial. The non-trivial 1D linear subsystem couples $B_x$ and $\\psi$:\n$$\n\\frac{\\partial B_x}{\\partial t} + \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 \\frac{\\partial B_x}{\\partial x} + \\alpha \\psi = 0\n$$\nThis system can be written in matrix form, $\\frac{\\partial \\mathbf{U}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{U}}{\\partial x} + \\mathbf{S} = 0$, where $\\mathbf{U} = [B_x, \\psi]^T$:\n$$\n\\frac{\\partial}{\\partial t} \\begin{pmatrix} B_x \\\\ \\psi \\end{pmatrix} + \\begin{pmatrix} 0 & 1 \\\\ c_h^2 & 0 \\end{pmatrix} \\frac{\\partial}{\\partial x} \\begin{pmatrix} B_x \\\\ \\psi \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\alpha \\psi \\end{pmatrix} = 0\n$$\nThe characteristic speeds of this hyperbolic system are the eigenvalues of the matrix $\\mathbf{A} = \\begin{pmatrix} 0 & 1 \\\\ c_h^2 & 0 \\end{pmatrix}$. The characteristic equation is $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = (-\\lambda)(-\\lambda) - c_h^2 = \\lambda^2 - c_h^2 = 0$. The eigenvalues are $\\lambda = \\pm c_h$.\nThus, the characteristic speeds are $+c_h$ and $-c_h$.\n\nTo find the phase speed and damping rate of divergence-error waves, we perform a Fourier analysis. We assume plane wave solutions of the form $B_x(x, t) = \\hat{B}_x e^{i(kx - \\omega t)}$ and $\\psi(x, t) = \\hat{\\psi} e^{i(kx - \\omega t)}$, where $k$ is the wavenumber and $\\omega$ is the complex angular frequency. Substituting these into the subsystem gives:\n$$\n-i\\omega \\hat{B}_x + ik \\hat{\\psi} = 0 \\implies \\omega \\hat{B}_x = k \\hat{\\psi}\n$$\n$$\n-i\\omega \\hat{\\psi} + c_h^2 (ik) \\hat{B}_x + \\alpha \\hat{\\psi} = 0\n$$\nSubstituting $\\hat{\\psi} = (\\omega/k)\\hat{B}_x$ into the second equation yields the dispersion relation:\n$$\n-i\\omega \\left(\\frac{\\omega}{k}\\right) \\hat{B}_x + ikc_h^2 \\hat{B}_x + \\alpha \\left(\\frac{\\omega}{k}\\right) \\hat{B}_x = 0\n$$\n$$\n-i\\omega^2 + ik^2c_h^2 + \\alpha\\omega = 0\n$$\n$$\n\\omega^2 + i\\alpha\\omega - k^2c_h^2 = 0\n$$\nSolving this quadratic equation for $\\omega$:\n$$\n\\omega = \\frac{-i\\alpha \\pm \\sqrt{(i\\alpha)^2 - 4(1)(-k^2c_h^2)}}{2} = \\frac{-i\\alpha \\pm \\sqrt{4k^2c_h^2 - \\alpha^2}}{2}\n$$\nThe nature of the solution depends on the sign of the discriminant $\\Delta = 4k^2c_h^2 - \\alpha^2$. Let $\\omega = \\omega_r + i\\omega_i$. The phase speed is $v_{ph} = \\omega_r/k$ and the amplitude damping rate is $\\gamma = -\\omega_i$ (for $\\omega_i < 0$).\n\nCase 1: Underdamped regime ($4k^2c_h^2 > \\alpha^2$).\nThe discriminant is positive and real.\n$$\n\\omega = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2} - i\\frac{\\alpha}{2}\n$$\nThe real part of the frequency is $\\omega_r = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2}$.\nThe phase speeds are $v_{ph} = \\frac{\\omega_r}{k} = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2k} = \\pm \\sqrt{c_h^2 - \\left(\\frac{\\alpha}{2k}\\right)^2}$.\nThe imaginary part is $\\omega_i = -\\frac{\\alpha}{2}$ for both modes.\nThe amplitude of both modes decays as $e^{\\omega_i t} = e^{-(\\alpha/2)t}$. The dominant (and only) damping rate is $\\gamma = \\frac{\\alpha}{2}$.\n\nCase 2: Overdamped or Critically Damped regimes ($4k^2c_h^2 \\le \\alpha^2$).\nThe discriminant is non-positive.\n$$\n\\omega = \\frac{-i\\alpha \\pm i\\sqrt{\\alpha^2 - 4k^2c_h^2}}{2} = -i \\left( \\frac{\\alpha \\mp \\sqrt{\\alpha^2 - 4k^2c_h^2}}{2} \\right)\n$$\nThe real part of the frequency is $\\omega_r = 0$, so the phase speeds are $v_{ph} = 0$.\nThe imaginary parts are purely real and negative:\n$$\n\\omega_{i,1} = -\\frac{1}{2}\\left(\\alpha - \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)\n$$\n$$\n\\omega_{i,2} = -\\frac{1}{2}\\left(\\alpha + \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)\n$$\nThe corresponding damping rates are $\\gamma_1 = |\\omega_{i,1}|$ and $\\gamma_2 = |\\omega_{i,2}|$. Since $\\sqrt{\\alpha^2 - 4k^2c_h^2} < \\alpha$ (for $k \\neq 0$), $\\gamma_1 < \\gamma_2$. The dominant (slowest) damping rate is the smaller one, $\\gamma_1$.\nThe dominant damping rate is $\\gamma = \\frac{1}{2}\\left(\\alpha - \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)$. This single formula covers both critical damping ($4k^2c_h^2 = \\alpha^2$, giving $\\gamma = \\alpha/2$) and overdamping ($4k^2c_h^2 < \\alpha^2$).\n\nSummary of expressions to be implemented:\n1. Positive characteristic speed: $+c_h$.\n2. Negative characteristic speed: $-c_h$.\n3. If $(2kc_h)^2 > \\alpha^2$: Positive phase speed is $\\sqrt{c_h^2 - (\\alpha/(2k))^2}$, Negative phase speed is $-\\sqrt{c_h^2 - (\\alpha/(2k))^2}$, Dominant damping rate is $\\alpha/2$.\n4. If $(2kc_h)^2 \\le \\alpha^2$: Both phase speeds are $0$, Dominant damping rate is $\\frac{1}{2}(\\alpha - \\sqrt{\\alpha^2 - (2kc_h)^2})$. For numerical stability when $(2kc_h)^2 \\ll \\alpha^2$, this is better computed as $\\frac{(2kc_h)^2}{2(\\alpha + \\sqrt{\\alpha^2 - (2kc_h)^2})}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the GLM-MHD divergence cleaning problem by deriving and evaluating\n    characteristic speeds, phase speeds, and damping rates.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (c_h, alpha, k)\n    test_cases = [\n        (1.00e5, 1.00e3, 1.00e-1), # Test case 1 (underdamped)\n        (3.00e4, 1.20e5, 2.00),     # Test case 2 (critical)\n        (2.00e4, 1.00e5, 1.00e-1), # Test case 3 (overdamped)\n        (5.00e5, 1.00e3, 1.00e3),     # Test case 4 (high-k underdamped)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c_h, alpha, k = case\n        \n        # 1. & 2. Characteristic speeds\n        c_char_pos = c_h\n        c_char_neg = -c_h\n        \n        # Determine the regime by comparing (2*k*c_h)^2 and alpha^2\n        # This is equivalent to comparing 2*k*c_h and alpha (since all are positive)\n        term_hyperbolic = 2.0 * k * c_h\n        \n        if term_hyperbolic > alpha:\n            # Underdamped regime\n            \n            # 3. & 4. Phase speeds\n            # Formula: v_ph = sqrt(c_h^2 - (alpha/(2*k))^2)\n            phase_speed_val = np.sqrt(c_h**2 - (alpha / (2.0 * k))**2)\n            v_phase_pos = phase_speed_val\n            v_phase_neg = -phase_speed_val\n            \n            # 5. Dominant damping rate\n            # Formula: gamma = alpha/2\n            damping_rate = alpha / 2.0\n            \n        else:\n            # Overdamped or critical regime\n            \n            # 3. & 4. Phase speeds\n            # Phase speed is 0 for non-oscillatory modes\n            v_phase_pos = 0.0\n            v_phase_neg = 0.0\n            \n            # 5. Dominant damping rate\n            # Formula: gamma = 0.5 * (alpha - sqrt(alpha^2 - (2*k*c_h)^2))\n            # The following numerically stable form is used to avoid\n            # catastrophic cancellation when (2*k*c_h)^2 is small compared to alpha^2.\n            # gamma = (2*k*c_h)^2 / (2 * (alpha + sqrt(alpha^2 - (2*k*c_h)^2)))\n            term_hyperbolic_sq = term_hyperbolic**2\n            alpha_sq = alpha**2\n            \n            # The term under the square root is guaranteed non-negative in this branch.\n            sqrt_term = np.sqrt(alpha_sq - term_hyperbolic_sq)\n            \n            # In the critical case, sqrt_term is 0 and this simplifies to\n            # (alpha^2) / (2*alpha) = alpha/2, which is correct.\n            damping_rate = term_hyperbolic_sq / (2.0 * (alpha + sqrt_term))\n\n        case_results = [\n            c_char_pos,\n            c_char_neg,\n            v_phase_pos,\n            v_phase_neg,\n            damping_rate\n        ]\n        results.append(case_results)\n\n    # Format the final output string exactly as required.\n    # Each number is formatted to 6 significant figures using {:.5e}\n    # No spaces are used, only commas.\n    outer_parts = []\n    for inner_list in results:\n        formatted_inner_list = [f\"{val:.5e}\" for val in inner_list]\n        outer_parts.append(f\"[{','.join(formatted_inner_list)}]\")\n    \n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}