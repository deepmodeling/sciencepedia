{
    "hands_on_practices": [
        {
            "introduction": "在我们深入研究等离子体体区域的复杂数值格式之前，我们必须首先正确地定义其在边界上的相互作用。在聚变装置中，等离子体被导电壁所约束。本练习将从基本物理原理出发，探讨在理想导体边界上的电磁学边界条件。通过从麦克斯韦方程组和理想欧姆定律这些第一性原理出发，推导理想磁流体力学（MHD）的边界条件（$ \\mathbf{B} \\cdot \\mathbf{n} = 0 $ 和 $ \\mathbf{v} \\cdot \\mathbf{n} = 0 $），您将巩固对抽象模型如何与物理容器相联系的理解，并明白为何在静止的理想导电壁中，能量不能通过电磁场逸出。",
            "id": "3992290",
            "problem": "一个轴对称的磁约束等离子体占据一个单连通区域 $\\Omega$，其边界为一个光滑、静止的理想导电壁 $\\partial \\Omega$，单位外法向矢量为 $\\mathbf{n}(\\mathbf{x})$。该等离子体由理想磁流体动力学 (MHD) 描述，特别是理想欧姆定律 $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$，并且电磁场在等离子体区域内遵循麦克斯韦方程组。边界壁是理想导体，相对于实验室坐标系静止。\n\n从基本电磁守恒定律和麦克斯韦方程组在理想导电表面上所蕴含的边界条件出发，确定穿过边界壁的电磁能流密度（坡印亭矢量）的法向分量在 $\\partial \\Omega$ 上的积分，即计算穿过边界的总电磁功率，\n$$\nP \\equiv \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA,\n$$\n其中 $\\mathbf{S}$ 是电磁能流密度。最终答案以瓦特 (Watts) 为单位表示。无需四舍五入。\n\n此外，请阐明在理想 MHD 中，穿过边界壁的净电磁能量传输为零的边界条件（用 $\\partial \\Omega$ 上的场和流动的分量表示）。\n\n你的推导必须从电磁能量守恒定律和由麦克斯韦方程组得出的理想导体边界条件开始，不得使用任何启发式捷径。请清晰地阐述将基本定律与在理想导电壁上计算 $P$ 值联系起来的每一步。",
            "solution": "该问题要求计算穿过等离子体约束区域边界 $\\partial\\Omega$ 的净电磁功率 $P$，并确定在该功率传输为零的情况下，理想磁流体动力学 (MHD) 的边界条件。区域 $\\Omega$ 由一个理想导电、光滑、静止的壁 $\\partial\\Omega$ 包围。\n\n问题陈述的验证过程如下。\n步骤 1：提取已知条件。\n- 等离子体区域 $\\Omega$ 是轴对称和单连通的。\n- 边界 $\\partial\\Omega$ 是一个光滑、静止的理想导电壁。\n- 壁的单位外法向矢量是 $\\mathbf{n}(\\mathbf{x})$。\n- 等离子体由理想 MHD 描述，包括理想欧姆定律：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$。\n- 电磁场遵循麦克斯韦方程组。\n- 要计算的量是净电磁功率 $P \\equiv \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA$，其中 $\\mathbf{S}$ 是坡印亭矢量。\n- 第二个任务是陈述 $P=0$ 的边界条件。\n- 推导必须从第一性原理出发。\n\n步骤 2：使用提取的已知条件进行验证。\n- 科学和事实的合理性：问题是在经典电磁学和理想 MHD 的标准、成熟的理论框架内提出的。诸如麦克斯韦方程组、坡印亭矢量、理想导体和理想欧姆定律等所有概念都是等离子体物理学的基础。该问题具有科学依据。\n- 适定性和完备性：问题是适定的。它指定了物理模型、区域、边界属性以及要计算的量。所提供的信息足以推导出唯一解，并且是自洽的。\n- 客观性和清晰度：问题使用精确、客观、无歧义的科学语言进行陈述。\n\n步骤 3：结论和行动。\n问题有效。这是应用电磁学和等离子体物理学基本原理的一个标准的、非平凡的练习。可以进行求解过程。\n\n电磁能流密度由坡印亭矢量 $\\mathbf{S}$ 给出。在国际单位制 (SI) 中，其定义为：\n$$\n\\mathbf{S} = \\frac{1}{\\mu_0} (\\mathbf{E} \\times \\mathbf{B})\n$$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{B}$ 是磁场，$\\mu_0$ 是真空磁导率。\n\n从区域 $\\Omega$ 穿过其边界 $\\partial\\Omega$ 流出的净电磁功率 $P$ 是坡印亭矢量法向分量的面积分：\n$$\nP = \\int_{\\partial \\Omega} \\mathbf{S} \\cdot \\mathbf{n} \\, dA = \\int_{\\partial \\Omega} \\frac{1}{\\mu_0} (\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n} \\, dA\n$$\n为了计算这个积分，我们必须确定在边界 $\\partial\\Omega$ 上被积函数 $(\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n}$ 的值。我们可以使用标量三重积恒等式 $(\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C} = \\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C})$ 来重写被积函数：\n$$\n(\\mathbf{E} \\times \\mathbf{B}) \\cdot \\mathbf{n} = \\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n})\n$$\n问题陈述边界壁 $\\partial\\Omega$ 是一个理想导体。根据麦克斯韦方程组，在理想导体表面的一个基本边界条件是电场的切向分量必须为零。如果存在切向分量，它将驱动无穷大的表面电流，这是不符合物理实际的。该条件表示为：\n$$\n\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\n这个矢量方程意味着在表面 $\\partial\\Omega$ 上任意一点的电场矢量 $\\mathbf{E}$ 必须与该点的表面垂直。换句话说，$\\mathbf{E}$ 必须与法向矢量 $\\mathbf{n}$ 平行。我们可以将其写作 $\\mathbf{E} = (\\mathbf{E} \\cdot \\mathbf{n}) \\mathbf{n}$ on $\\partial\\Omega$。\n\n现在考虑点积中的另一个矢量 $(\\mathbf{B} \\times \\mathbf{n})$。根据叉积的定义，由 $\\mathbf{B} \\times \\mathbf{n}$ 产生的矢量同时垂直于 $\\mathbf{B}$ 和 $\\mathbf{n}$。因为它垂直于 $\\mathbf{n}$，所以矢量 $(\\mathbf{B} \\times \\mathbf{n})$ 必定位于与表面 $\\partial\\Omega$ 相切的平面内。\n\n我们现在计算在表面 $\\partial\\Omega$ 上的两个矢量的点积：一个是与表面垂直的电场 $\\mathbf{E}$，另一个是与表面相切的矢量 $(\\mathbf{B} \\times \\mathbf{n})$。在表面上同一点的任何法向矢量与任何切向矢量的点积都为零。因此，我们有：\n$$\n\\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n}) = 0 \\quad \\text{on } \\partial\\Omega\n$$\n由于被积函数 $\\mathbf{S} \\cdot \\mathbf{n} = \\frac{1}{\\mu_0} \\mathbf{E} \\cdot (\\mathbf{B} \\times \\mathbf{n})$ 在边界 $\\partial\\Omega$ 上所有点都恒为零，所以积分也必定为零：\n$$\nP = \\int_{\\partial \\Omega} 0 \\, dA = 0\n$$\n穿过边界的净电磁功率为零。答案是 $0$ 瓦特。这个结果是边界为静止理想导体的直接推论，与内部等离子体的理想 MHD 模型无关。\n\n问题的第二部分要求用场和流动的分量来表述实现零净能量传输的边界条件。如上所示，条件 $P=0$ 是由理想导体上的电磁边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ 保证的。我们现在将其与理想 MHD 的流体和场变量联系起来。该问题指定了三个关键的物理约束：\n1. 边界壁是理想导体：在 $\\partial\\Omega$ 上 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$。\n2. 等离子体遵循理想欧姆定律：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$。\n3. 边界壁是静止且不可穿透的，因此在壁上等离子体速度的法向分量为零：在 $\\partial\\Omega$ 上 $\\mathbf{v} \\cdot \\mathbf{n} = 0$。\n\n我们可以通过确保这三个约束相互一致来推导相应的理想 MHD 边界条件。根据欧姆定律（约束 2），我们有 $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$。将此代入理想导体条件（约束 1）得到：\n$$\n\\mathbf{n} \\times (-\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\n使用矢量三重积恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$，我们展开该表达式：\n$$\n-[\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(\\mathbf{n} \\cdot \\mathbf{v})] = \\mathbf{0}\n$$\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(\\mathbf{n} \\cdot \\mathbf{v}) = \\mathbf{0}\n$$\n现在，我们应用不可穿透壁条件（约束 3），$\\mathbf{v} \\cdot \\mathbf{n} = 0$：\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) - \\mathbf{B}(0) = \\mathbf{0}\n$$\n$$\n\\mathbf{v}(\\mathbf{n} \\cdot \\mathbf{B}) = \\mathbf{0} \\quad \\text{on } \\partial\\Omega\n$$\n这个方程意味着在边界上的任意一点，以下至少有一项必须为真：要么流体速度矢量 $\\mathbf{v}$ 为零，要么磁场的标量法向分量 $\\mathbf{B} \\cdot \\mathbf{n}$ 为零。一般而言，理想 MHD 允许沿边界存在非零切向流（自由滑移条件），因此我们不能假设在 $\\partial\\Omega$ 上处处 $\\mathbf{v} = \\mathbf{0}$。为了对任意切向速度 $\\mathbf{v}$ 都满足该方程，另一个因子必须为零。\n因此，我们必须有：\n$$\n\\mathbf{B} \\cdot \\mathbf{n} = 0 \\quad \\text{on } \\partial\\Omega\n$$\n这个条件表明磁场必须纯粹与理想导电壁相切。\n\n总之，在静止、不可穿透的理想导电壁上，确保净电磁能量传输为零的一致的理想 MHD 边界条件集是：\n1. 等离子体速度的法向分量为零：$\\mathbf{v} \\cdot \\mathbf{n} = 0$。\n2. 磁场的法向分量为零：$\\mathbf{B} \\cdot \\mathbf{n} = 0$。\n\n这两个关于 MHD 变量 $\\mathbf{v}$ 和 $\\mathbf{B}$ 的条件是问题约束条件的物理体现，并且足以保证 $P=0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "现代MHD模拟程序的一项核心任务，是从守恒变量（如总能量，随时间演化）转换到基元变量（如压强，用于计算通量）。然而，在某些特定的物理区间，这种转换是出了名的脆弱。本练习将处理在高阿尔芬马赫数流动中发生的“相减抵消”问题，在这种情况下，动能会主导总能量，导致数值误差产生非物理的负压强。您将实现并分析一种稳健的备用策略，该策略能在不违反模拟基本守恒律的前提下确保压强为正，从而亲身体验在极端等离子体场景中维持数值稳定性和物理一致性的关键挑战。",
            "id": "3992283",
            "problem": "考虑一维理想磁流体动力学 (MHD)，其守恒状态向量分量为 $\\rho$ (质量密度)、$\\mathbf{m} = \\rho \\mathbf{u}$ (动量密度)、$\\mathbf{B}$ (磁场) 和 $E$ (总能量密度)。理想 MHD 方程表达了质量、动量和能量的守恒，以及磁感应方程。该问题的基本基础包括：质量守恒、动量守恒、总能量守恒，以及绝热指数为 $\\gamma$ 的多方理想气体的热力学闭合。\n\n对于理想多方气体，总能量密度可分解为\n$$\nE = e_{\\mathrm{int}} + \\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2 + \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0},\n$$\n其中 $e_{\\mathrm{int}}$ 是内能密度，$\\mathbf{u} = \\mathbf{m} / \\rho$ 是流体速度，$\\mu_0$ 是磁导率（在无量纲代码单位中，通常设置 $\\mu_0 = 1$）。气体压力 $p$ 与内能密度通过以下关系式关联\n$$\np = (\\gamma - 1)\\, e_{\\mathrm{int}}.\n$$\n阿尔芬速度为\n$$\nv_A = \\frac{\\lVert \\mathbf{B} \\rVert}{\\sqrt{\\mu_0 \\rho}},\n$$\n阿尔芬马赫数 $M_A$ 为\n$$\nM_A = \\frac{\\lVert \\mathbf{u} \\rVert}{v_A}.\n$$\n\n在计算聚变科学与工程中，有限体积戈杜诺夫类求解器的一个关键步骤是从守恒变量 $(\\rho, \\mathbf{m}, \\mathbf{B}, E)$ 中恢复原始变量 $(\\rho, \\mathbf{u}, p, \\mathbf{B})$。在高阿尔芬马赫数流（大 $M_A$）中，动能密度 $\\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2$ 可能会在总能量预算中占主导地位，在计算 $e_{\\mathrm{int}} = E - \\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2 - \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0}$ 时，相消误差可能导致数值上得到非正的 $e_{\\mathrm{int}}$。这会导致原始变量恢复失败模式，例如出现非物理的负压。\n\n您的任务是编写一个完整的、可运行的程序，该程序能够：\n- 从上述基本定律和定义出发，实现一个鲁棒的守恒变量到原始变量的恢复程序。\n- 当从守恒总能量推断出的内能为非正或非有限值时，检测原始变量恢复失败。\n- 实现一个保持守恒的回退策略，该策略不改变守恒状态 $(\\rho, \\mathbf{m}, \\mathbf{B}, E)$，但为黎曼求解器提供物理上有意义的原始压力 $p$。使用以下两级回退策略：\n  1. 如果提供了守恒熵示踪剂 $S$（作为满足等熵理想气体 $S = p / \\rho^\\gamma$ 的被动标量进行平流输运），则将回退压力设置为 $p_S = S \\rho^\\gamma$。\n  2. 应用最小等离子体贝塔值下限，通过 $p_{\\beta} = \\beta_{\\min}\\, \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0}$ 来确保正性，其中 $\\beta_{\\min}  0$ 是一个预设的小参数。\n  3. 最终的回退压力为 $p_{\\mathrm{fb}} = \\max\\{p_S,\\; p_{\\beta},\\; \\epsilon\\}$，其中有一个用于数值安全性的微小正数 $\\epsilon$。\n- 保持守恒状态不变以维护守恒性，并报告能量一致性残差\n$$\n\\Delta E = E - \\left(\\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2 + \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0} + \\frac{p}{\\gamma - 1}\\right),\n$$\n其中 $p$ 在标称情况下是直接从能量恢复的压力，或者在检测到失败时是回退压力 $p_{\\mathrm{fb}}$。\n\n对于每个测试用例，计算并返回：\n- 一个布尔值，指示最终的原始变量是否根据准则 $p  0$、$\\rho  0$ 和有限的 $M_A$ 在物理上可接受。\n- 恢复的压力 $p$（标称值或回退值），为浮点数。\n- 阿尔芬马赫数 $M_A$，为浮点数。\n- 能量一致性残差 $\\Delta E$，为浮点数。\n\n在每个案例中按指定使用无量纲单位，并设 $\\mu_0 = 1$。此问题不涉及角度。所有浮点输出均以十进制形式表示。在恢复过程中，您不得修改给定的守恒变量。\n\n测试套件。实现您的程序，使其精确使用以下四个测试用例，这些用例代表了高 $M_A$ 流中的典型和边缘场景：\n\n- 案例 1（正常路径，中等 $M_A$）：\n  - $\\rho = 1.0$, $\\mathbf{m} = (0.2, 0.0, 0.0)$, $\\mathbf{B} = (0.1, 0.0, 0.0)$, $E = 0.175$, $\\gamma = 5/3$, $\\mu_0 = 1$, $S = 0.1$, $\\beta_{\\min} = 10^{-4}$。\n- 案例 2（极高 $M_A$，相消误差导致负内能）：\n  - $\\rho = 1.0$, $\\mathbf{m} = (100.0, 0.0, 0.0)$, $\\mathbf{B} = (10^{-3}, 0.0, 0.0)$, $E = 4999.9999905$, $\\gamma = 5/3$, $\\mu_0 = 1$, $S = 10^{-2}$, $\\beta_{\\min} = 10^{-4}$。\n- 案例 3（强磁场，内能不足；熵给出的压力过小，贝塔下限起主导作用）：\n  - $\\rho = 1.0$, $\\mathbf{m} = (100.0, 0.0, 0.0)$, $\\mathbf{B} = (10.0, 0.0, 0.0)$, $E = 5040.0$, $\\gamma = 5/3$, $\\mu_0 = 1$, $S = 10^{-6}$, $\\beta_{\\min} = 10^{-4}$。\n- 案例 4（近真空密度，因灾难性相消导致 E 为负；回退策略必须提供正压力）：\n  - $\\rho = 10^{-9}$, $\\mathbf{m} = (10^{-8}, 0.0, 0.0)$, $\\mathbf{B} = (10^{-4}, 0.0, 0.0)$, $E = -4.5\\times 10^{-8}$, $\\gamma = 5/3$, $\\mu_0 = 1$, $S = 10^{-3}$, $\\beta_{\\min} = 10^{-4}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含每个案例结果的列表，每个案例由一个 $[{\\tt valid\\_bool}, p, M_A, \\Delta E]$ 形式的列表表示。将所有四个案例聚合到一个顶级列表中，并将其完全打印为 Python 风格的列表字面量，例如：\n$[ [\\dots], [\\dots], [\\dots], [\\dots] ]$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上是合理的、适定的，并提供了一套完整且一致的定义和数据来指定一个清晰、可形式化的任务。\n\n所描述的场景——高马赫数理想 MHD 流中的原始变量恢复失败及回退策略的使用——是计算等离子体物理学和天体物理学中的一个标准且重要课题。\n\n任务是为一维理想磁流体动力学 (MHD) 方程实现一个鲁棒的守恒变量到原始变量的恢复程序。原始变量 $(\\rho, \\mathbf{u}, p, \\mathbf{B})$ 需要从守恒状态向量 $(\\rho, \\mathbf{m}, \\mathbf{B}, E)$ 中恢复。这个过程是戈杜诺夫类数值格式的基础。将实施以下基于连续介质力学和等离子体物理学原理的逐步程序。\n\n首先，我们确定哪些原始变量可以直接恢复。质量密度 $\\rho$ 和磁场 $\\mathbf{B}$ 本身既是守恒变量也是原始变量。流体速度 $\\mathbf{u}$ 通过定义 $\\mathbf{m} = \\rho \\mathbf{u}$ 从动量密度 $\\mathbf{m}$ 和质量密度 $\\rho$ 中恢复，得到：\n$$\n\\mathbf{u} = \\frac{\\mathbf{m}}{\\rho}\n$$\n只要质量密度为正（即 $\\rho  0$），此步骤就是良定义的。在数值模拟的背景下，这是物理状态的必要条件，并且通常会应用密度下限值以防止除以零，尽管提供的测试用例都具有 $\\rho  0$。\n\n恢复挑战的核心在于确定气体压力 $p$。这通过分解总能量密度 $E$ 来完成。在 MHD 中，对于理想多方气体，给定的 $E$ 分解为：\n$$\nE = e_{\\mathrm{int}} + E_{\\mathrm{kin}} + E_{\\mathrm{mag}} = e_{\\mathrm{int}} + \\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2 + \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0}\n$$\n其中 $e_{\\mathrm{int}}$ 是内能密度，$E_{\\mathrm{kin}}$ 是动能密度，$E_{\\mathrm{mag}}$ 是磁能密度。压力 $p$ 通过多方状态方程与内能密度相关：\n$$\np = (\\gamma - 1) e_{\\mathrm{int}}\n$$\n其中 $\\gamma$ 是绝热指数。\n\n恢复压力的标称程序是，首先从已恢复的原始变量计算动能和磁能密度，然后将它们从总能量 E 中减去以求得内能：\n$$\ne_{\\mathrm{int}} = E - \\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2 - \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0}\n$$\n然后压力为 $p = (\\gamma - 1) e_{\\mathrm{int}}$。为了使状态具有物理意义，我们必须有 $p  0$。由于对于典型气体 $\\gamma  1$，这等同于要求 $e_{\\mathrm{int}}  0$。\n\n当流具有非常高的动能以至于 $E_{\\mathrm{kin}} \\approx E$ 时，会出现一个关键的失败模式。在这种情况下，计算 $e_{\\mathrm{int}}$ 涉及两个几乎相等的大数相减。浮点精度限制可能导致结果为非正或非有限值，即 $e_{\\mathrm{int}} \\le 0$ 或不是一个有限数。这将对应于非物理的负压或零压。该问题要求检测这种失败并应用回退策略。\n\n回退策略必须提供一个物理上合理、为正的压力 $p_{\\mathrm{fb}}$，同时不修改守恒状态向量 $(\\rho, \\mathbf{m}, \\mathbf{B}, E)$。这保留了数值格式的全局守恒属性，这是一个至关重要的问题。这种不一致性局限于单元的热力学，并通过能量残差 $\\Delta E$ 进行量化。规定的回退压力 $p_{\\mathrm{fb}}$ 是三个下限的组合，以确保鲁棒性：\n$$\np_{\\mathrm{fb}} = \\max\\{p_S, p_{\\beta}, \\epsilon\\}\n$$\n这些组成部分是：\n$1$. 基于熵的压力，$p_S = S \\rho^\\gamma$。这使用一个独立平流输运的熵示踪剂 $S = p/\\rho^\\gamma$ 来重构一个与等熵历史一致的压力。\n$2$. 等离子体贝塔下限，$p_{\\beta} = \\beta_{\\min} \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0}$。这强制规定了热压力与磁压力的最小比率，防止在磁主导区域坍缩到非物理的低压。$\\beta_{\\min}$ 是一个小的正参数。\n$3$. 一个小的绝对压力下限，$\\epsilon  0$（例如，像 $10^{-12}$ 这样的值），以保证严格的正性并防止后续计算中的数值问题。\n\n一旦确定了压力 $p$（无论是通过标称方式还是回退方式），就计算剩余的量。阿尔芬速度 $v_A$ 为：\n$$\nv_A = \\frac{\\lVert \\mathbf{B} \\rVert}{\\sqrt{\\mu_0 \\rho}}\n$$\n这要求 $\\rho  0$。阿尔芬马赫数 $M_A$ 为：\n$$\nM_A = \\frac{\\lVert \\mathbf{u} \\rVert}{v_A}\n$$\n如果 $v_A = 0$（当 $\\mathbf{B} = \\mathbf{0}$ 时发生），必须小心处理。在这种情况下，如果 $\\lVert \\mathbf{u} \\rVert  0$，则 $M_A$ 是无穷大。如果 $\\lVert \\mathbf{u} \\rVert$ 也为 $0$，则 $M_A$ 是不确定的 ($0/0$)，通常设为 $0$。\n\n如果满足以下标准，则状态被认为是物理上可接受的：$\\rho  0$，$p  0$，且 $M_A$ 是有限的。\n\n最后，计算能量一致性残差 $\\Delta E$。它衡量给定的守恒总能量 $E$ 与使用最终压力 $p$ 重构的总能量之间的差异：\n$$\nE_{\\mathrm{recon}} = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2 + \\frac{\\lVert \\mathbf{B} \\rVert^2}{2\\mu_0}\n$$\n$$\n\\Delta E = E - E_{\\mathrm{recon}}\n$$\n在标称情况下，$\\Delta E$ 在机器精度范围内应为零。在回退情况下，非零的 $\\Delta E$ 明确地量化了为强制施加物理压力而引入的能量误差。\n\n为每个测试用例实现的算法如下：\n$1$. 给定 $(\\rho, \\mathbf{m}, \\mathbf{B}, E, \\gamma, \\mu_0, S, \\beta_{\\min})$，计算 $\\mathbf{u} = \\mathbf{m}/\\rho$。\n$2$. 计算 $E_{\\mathrm{kin}} = \\frac{1}{2}\\rho \\lVert \\mathbf{u} \\rVert^2$ 和 $E_{\\mathrm{mag}} = \\frac{1}{2\\mu_0}\\lVert \\mathbf{B} \\rVert^2$。\n$3$. 计算 $e_{\\mathrm{int}} = E - E_{\\mathrm{kin}} - E_{\\mathrm{mag}}$。\n$4$. 如果 $e_{\\mathrm{int}}  0$ 且为有限值，则设置 $p = (\\gamma - 1)e_{\\mathrm{int}}$。\n$5$. 否则，计算 $p_S = S \\rho^\\gamma$、$p_{\\beta} = \\beta_{\\min} E_{\\mathrm{mag}}$，并设置 $p = \\max\\{p_S, p_{\\beta}, \\epsilon\\}$。\n$6$. 计算 $v_A$ 和 $M_A$，处理 $v_A=0$ 的情况。\n$7$. 基于 $\\rho  0$、$p  0$ 和有限的 $M_A$ 确定物理可接受性的布尔值。\n$8$. 计算能量残差 $\\Delta E = E - (\\frac{p}{\\gamma - 1} + E_{\\mathrm{kin}} + E_{\\mathrm{mag}})$。\n$9$. 返回元组 $(\\text{valid\\_bool}, p, M_A, \\Delta E)$。\n现在将对此过程进行编码。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef recover_primitives(rho, m_vec, B_vec, E, gamma, mu0, S, beta_min):\n    \"\"\"\n    Performs conservative-to-primitive variable recovery for ideal MHD.\n\n    Args:\n        rho (float): Mass density.\n        m_vec (np.ndarray): Momentum density vector.\n        B_vec (np.ndarray): Magnetic field vector.\n        E (float): Total energy density.\n        gamma (float): Adiabatic index.\n        mu0 (float): Magnetic permeability.\n        S (float): Conserved entropy tracer.\n        beta_min (float): Minimum plasma beta for pressure floor.\n\n    Returns:\n        list: A list containing [valid_bool, p, M_A, delta_E].\n    \"\"\"\n    # A tiny positive number for numerical safety.\n    EPSILON = 1e-12\n\n    # Step 1: Recover velocity\n    # This calculation is safe as all test cases have rho  0.\n    u_vec = m_vec / rho\n    u_sq = np.dot(u_vec, u_vec)\n    \n    # Step 2: Compute kinetic and magnetic energy densities\n    B_sq = np.dot(B_vec, B_vec)\n    E_kin = 0.5 * rho * u_sq\n    E_mag = 0.5 * B_sq / mu0\n\n    # Step 3: Attempt to recover internal energy density and pressure\n    e_int = E - E_kin - E_mag\n\n    # Step 4-5: Check for failure and apply fallback if necessary\n    if e_int  0 and np.isfinite(e_int):\n        # Nominal case: recovery is successful\n        p = (gamma - 1.0) * e_int\n    else:\n        # Fallback case: e_int is non-positive or not finite\n        p_S = S * rho**gamma\n        p_beta = beta_min * E_mag\n        p = max(p_S, p_beta, EPSILON)\n\n    # Step 6: Compute derived quantities (Alfvén speed and Mach number)\n    u_norm = np.sqrt(u_sq)\n    B_norm = np.sqrt(B_sq)\n    \n    # Denominator for v_A. Safe as rho  0 in all cases.\n    v_A_denom = np.sqrt(mu0 * rho)\n    \n    if v_A_denom  0:\n        v_A = B_norm / v_A_denom\n    else: # Should not happen with given test cases\n        v_A = np.inf\n\n    if v_A  0:\n        M_A = u_norm / v_A\n    elif u_norm  0: # v_A is zero, but u is not, so M_A is infinite\n        M_A = np.inf\n    else: # Both u and B (so v_A) are zero. M_A = 0/0 is taken as 0.\n        M_A = 0.0\n\n    # Step 7: Determine physical acceptability\n    is_valid = p  0 and rho  0 and np.isfinite(M_A)\n    \n    # Step 8: Compute energy consistency residual\n    e_int_final = p / (gamma - 1.0)\n    E_recon = e_int_final + E_kin + E_mag\n    delta_E = E - E_recon\n\n    # Step 9: Return the results\n    return [is_valid, p, M_A, delta_E]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate M_A)\n        {'rho': 1.0, 'm': (0.2, 0.0, 0.0), 'B': (0.1, 0.0, 0.0), 'E': 0.175, \n         'gamma': 5/3, 'mu0': 1.0, 'S': 0.1, 'beta_min': 1e-4},\n        # Case 2 (very high M_A, subtractive cancellation)\n        {'rho': 1.0, 'm': (100.0, 0.0, 0.0), 'B': (1e-3, 0.0, 0.0), 'E': 4999.9999905, \n         'gamma': 5/3, 'mu0': 1.0, 'S': 1e-2, 'beta_min': 1e-4},\n        # Case 3 (strong magnetic field, beta floor dominates)\n        {'rho': 1.0, 'm': (100.0, 0.0, 0.0), 'B': (10.0, 0.0, 0.0), 'E': 5040.0, \n         'gamma': 5/3, 'mu0': 1.0, 'S': 1e-6, 'beta_min': 1e-4},\n        # Case 4 (near-vacuum, negative E)\n        {'rho': 1e-9, 'm': (1e-8, 0.0, 0.0), 'B': (1e-4, 0.0, 0.0), 'E': -4.5e-8, \n         'gamma': 5/3, 'mu0': 1.0, 'S': 1e-3, 'beta_min': 1e-4}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Convert tuple inputs to numpy arrays for vector operations\n        m_vec = np.array(case['m'])\n        B_vec = np.array(case['B'])\n        \n        # Call the recovery routine\n        result = recover_primitives(\n            case['rho'], m_vec, B_vec, case['E'],\n            case['gamma'], case['mu0'], case['S'], case['beta_min']\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # str() produces a Python-style list literal, as requested.\n    print(str(results))\n\nsolve()\n```"
        },
        {
            "introduction": "除了确保能量守恒和热力学一致性，MHD模拟中的一个核心挑战是维持螺线管约束，即 $ \\nabla \\cdot \\mathbf{B} = 0 $。数值误差不可避免地会引入非零散度，这可能导致非物理的力和不稳定性。本练习深入探讨了广义拉格朗日乘子（GLM）方法，这是一种优雅且被广泛使用的技术，它将散度误差视为一个场，并主动地将其衰减和对流输运走。通过推导GLM的一维线性子系统并分析其波动和扩散特性，您将深入理解这种“散度清理”机制的工作原理，这是任何计算磁流体力学专家为开发稳健、准确的程序所必备的工具。",
            "id": "3992275",
            "problem": "考虑应用于理想磁流体力学 (MHD) 方程的广义拉格朗日乘子 (GLM) 双曲-抛物线清理方法，其中磁场 $\\mathbf{B}$ 通过一个标量清理场 $\\psi$ 进行增广，以减少和移流散度误差。从基本定律，即法拉第电磁感应定律和理想欧姆定律，以及对磁场的无散度约束出发，推导一个一维线性清理子系统。在该子系统中，$\\mathbf{B}$ 中的散度误差通过将 $\\psi$ 与 $\\mathbf{B}$ 适当耦合而被移流和阻尼。利用此子系统，获得特征速度、散度误差波的相速度以及散度误差幅值的主导衰减率的闭式表达式，这些表达式应表示为双曲清理速度 $c_h$（单位为 $\\mathrm{m/s}$）、线性阻尼系数 $\\alpha$（单位为 $\\mathrm{s^{-1}}$）和波数 $k$（单位为 $\\mathrm{m^{-1}}$）的函数。确保您的推导植根于基础物理定律，不假定任何预先推导的 GLM 公式。\n\n您的程序必须实现您推导出的表达式，并针对以下参数三元组 $(c_h, \\alpha, k)$ 的测试套件进行评估：\n- 测试用例 1（欠阻尼状态）：$c_h = 1.00\\times 10^{5}\\ \\mathrm{m/s}$，$\\alpha = 1.00\\times 10^{3}\\ \\mathrm{s^{-1}}$，$k = 1.00\\times 10^{-1}\\ \\mathrm{m^{-1}}$。\n- 测试用例 2（临界状态）：$c_h = 3.00\\times 10^{4}\\ \\mathrm{m/s}$，$\\alpha = 1.20\\times 10^{5}\\ \\mathrm{s^{-1}}$，$k = 2.00\\ \\mathrm{m^{-1}}$。\n- 测试用例 3（过阻尼状态）：$c_h = 2.00\\times 10^{4}\\ \\mathrm{m/s}$，$\\alpha = 1.00\\times 10^{5}\\ \\mathrm{s^{-1}}$，$k = 1.00\\times 10^{-1}\\ \\mathrm{m^{-1}}$。\n- 测试用例 4（高-$k$ 欠阻尼状态）：$c_h = 5.00\\times 10^{5}\\ \\mathrm{m/s}$，$\\alpha = 1.00\\times 10^{3}\\ \\mathrm{s^{-1}}$，$k = 1.00\\times 10^{3}\\ \\mathrm{m^{-1}}$。\n\n对于每个测试用例，您的程序必须计算并输出一个包含五个浮点数的列表：\n1. 正特征速度 $+c_h$，单位为 $\\mathrm{m/s}$。\n2. 负特征速度 $-c_h$，单位为 $\\mathrm{m/s}$。\n3. 散度误差波的正相速度，单位为 $\\mathrm{m/s}$。\n4. 散度误差波的负相速度，单位为 $\\mathrm{m/s}$。\n5. 散度误差幅值的主导阻尼率，单位为 $\\mathrm{s^{-1}}$。\n\n如果状态是振荡的（欠阻尼），相速度必须反映角频率的实部除以 $k$；如果状态是非振荡的（过阻尼或临界），相速度必须报告为 $0\\ \\mathrm{m/s}$，并且主导阻尼率必须对应于最慢衰减的指数模式。所有速度以 $\\mathrm{m/s}$ 表示，所有阻尼率以 $\\mathrm{s^{-1}}$ 表示，四舍五入到六位有效数字。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也是一个用方括号括起来的逗号分隔列表。例如，输出格式必须为\n$[\\,[x_{1},y_{1},z_{1},w_{1},r_{1}],\\,[x_{2},y_{2},z_{2},w_{2},r_{2}],\\,\\dots\\,]$\n且行内任何地方都没有空格。",
            "solution": "用户提供的问题被评估为有效。它在科学上基于计算磁流体力学的原理，是适定的，并包含进行严格推导和求解所需的所有信息。\n\n一维线性广义拉格朗日乘子 (GLM) 清理子系统的推导始于理想磁流体力学 (MHD) 中控制磁场 $\\mathbf{B}$ 的基本定律。\n\n法拉第电磁感应定律由下式给出：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\n在理想 MHD 中，电场 $\\mathbf{E}$ 由理想欧姆定律确定：\n$$\n\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\n其中 $\\mathbf{v}$ 是等离子体流体速度。将两者结合得到感应方程：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\n作为 Maxwell 方程组推论的无散度约束要求磁场是无散的：\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\n对感应方程取散度可得 $\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{B}) = \\nabla \\cdot (\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})) \\equiv 0$。这意味着任何初始的非零散度（可能由数值离散化误差引起）会随时间守恒，而不会被物理方程校正。\n\nGLM 方法通过增广理想 MHD 系统来解决这个问题。引入一个标量场 $\\psi$，并修改方程以主动传输和阻尼散度误差。修改后的感应方程和 $\\psi$ 的新演化方程如下：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) + \\nabla \\psi = 0\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 (\\nabla \\cdot \\mathbf{B}) + \\alpha \\psi = 0\n$$\n这里，$c_h$ 是双曲清理速度，$\\alpha$ 是抛物线阻尼系数。对修改后的感应方程取散度，并使用恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$，我们发现散度误差的时间演化与 $\\psi$ 之间存在耦合关系：\n$$\n\\frac{\\partial (\\nabla \\cdot \\mathbf{B})}{\\partial t} + \\nabla^2 \\psi = 0\n$$\n该系统确保如果存在散度误差 $\\nabla \\cdot \\mathbf{B}$，它将引起 $\\psi$ 的变化，从而驱动系统趋向于 $\\nabla \\cdot \\mathbf{B} = 0$ 的状态。\n\n为了按要求推导一维线性清理子系统，我们考虑一个简化的情景，其中变化仅沿 $x$ 轴发生，因此 $\\nabla = (\\frac{\\partial}{\\partial x}, 0, 0)$。此外，我们在没有流体运动（$\\mathbf{v}=0$）的情况下分析该系统，以隔离清理机制。$\\mathbf{B}$ 的分量为 $(B_x, B_y, B_z)$。\n散度变为 $\\nabla \\cdot \\mathbf{B} = \\frac{\\partial B_x}{\\partial x}$。项 $\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})$ 消失。修改后的感应方程变为：\n$$\n\\frac{\\partial B_x}{\\partial t} + \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = 0\n$$\n$$\n\\frac{\\partial B_z}{\\partial t} = 0\n$$\n$\\psi$ 在一维下的演化方程为：\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 \\frac{\\partial B_x}{\\partial x} + \\alpha \\psi = 0\n$$\n$B_y$ 和 $B_z$ 的方程是平凡的。非平凡的一维线性子系统耦合了 $B_x$ 和 $\\psi$：\n$$\n\\frac{\\partial B_x}{\\partial t} + \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 \\frac{\\partial B_x}{\\partial x} + \\alpha \\psi = 0\n$$\n该系统可以写成矩阵形式 $\\frac{\\partial \\mathbf{U}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{U}}{\\partial x} + \\mathbf{S} = 0$，其中 $\\mathbf{U} = [B_x, \\psi]^T$：\n$$\n\\frac{\\partial}{\\partial t} \\begin{pmatrix} B_x \\\\ \\psi \\end{pmatrix} + \\begin{pmatrix} 0  1 \\\\ c_h^2  0 \\end{pmatrix} \\frac{\\partial}{\\partial x} \\begin{pmatrix} B_x \\\\ \\psi \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\alpha \\psi \\end{pmatrix} = 0\n$$\n此双曲系统的特征速度是矩阵 $\\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ c_h^2  0 \\end{pmatrix}$ 的特征值。特征方程为 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = (-\\lambda)(-\\lambda) - c_h^2 = \\lambda^2 - c_h^2 = 0$。特征值为 $\\lambda = \\pm c_h$。\n因此，特征速度为 $+c_h$ 和 $-c_h$。\n\n为了找到散度误差波的相速度和阻尼率，我们进行傅里叶分析。我们假设平面波解的形式为 $B_x(x, t) = \\hat{B}_x e^{i(kx - \\omega t)}$ 和 $\\psi(x, t) = \\hat{\\psi} e^{i(kx - \\omega t)}$，其中 $k$ 是波数，$\\omega$ 是复角频率。将这些代入子系统得到：\n$$\n-i\\omega \\hat{B}_x + ik \\hat{\\psi} = 0 \\implies \\omega \\hat{B}_x = k \\hat{\\psi}\n$$\n$$\n-i\\omega \\hat{\\psi} + c_h^2 (ik) \\hat{B}_x + \\alpha \\hat{\\psi} = 0\n$$\n将 $\\hat{\\psi} = (\\omega/k)\\hat{B}_x$ 代入第二个方程得到色散关系：\n$$\n-i\\omega \\left(\\frac{\\omega}{k}\\right) \\hat{B}_x + ikc_h^2 \\hat{B}_x + \\alpha \\left(\\frac{\\omega}{k}\\right) \\hat{B}_x = 0\n$$\n$$\n-i\\omega^2 + ik^2c_h^2 + \\alpha\\omega = 0\n$$\n$$\n\\omega^2 + i\\alpha\\omega - k^2c_h^2 = 0\n$$\n解这个关于 $\\omega$ 的二次方程：\n$$\n\\omega = \\frac{-i\\alpha \\pm \\sqrt{(i\\alpha)^2 - 4(1)(-k^2c_h^2)}}{2} = \\frac{-i\\alpha \\pm \\sqrt{4k^2c_h^2 - \\alpha^2}}{2}\n$$\n解的性质取决于判别式 $\\Delta = 4k^2c_h^2 - \\alpha^2$ 的符号。设 $\\omega = \\omega_r + i\\omega_i$。相速度为 $v_{ph} = \\omega_r/k$，振幅阻尼率为 $\\gamma = -\\omega_i$ (对于 $\\omega_i  0$)。\n\n情况1：欠阻尼状态 ($4k^2c_h^2  \\alpha^2$)。\n判别式为正实数。\n$$\n\\omega = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2} - i\\frac{\\alpha}{2}\n$$\n频率的实部为 $\\omega_r = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2}$。\n相速度为 $v_{ph} = \\frac{\\omega_r}{k} = \\pm \\frac{\\sqrt{4k^2c_h^2 - \\alpha^2}}{2k} = \\pm \\sqrt{c_h^2 - \\left(\\frac{\\alpha}{2k}\\right)^2}$。\n两种模式的虚部均为 $\\omega_i = -\\frac{\\alpha}{2}$。\n两种模式的振幅都按 $e^{\\omega_i t} = e^{-(\\alpha/2)t}$ 衰减。主导（也是唯一）的阻尼率为 $\\gamma = \\frac{\\alpha}{2}$。\n\n情况2：过阻尼或临界阻尼状态 ($4k^2c_h^2 \\le \\alpha^2$)。\n判别式为非正数。\n$$\n\\omega = \\frac{-i\\alpha \\pm i\\sqrt{\\alpha^2 - 4k^2c_h^2}}{2} = -i \\left( \\frac{\\alpha \\mp \\sqrt{\\alpha^2 - 4k^2c_h^2}}{2} \\right)\n$$\n频率的实部为 $\\omega_r = 0$，因此相速度为 $v_{ph} = 0$。\n虚部为纯实数且为负：\n$$\n\\omega_{i,1} = -\\frac{1}{2}\\left(\\alpha - \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)\n$$\n$$\n\\omega_{i,2} = -\\frac{1}{2}\\left(\\alpha + \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)\n$$\n相应的阻尼率为 $\\gamma_1 = |\\omega_{i,1}|$ 和 $\\gamma_2 = |\\omega_{i,2}|$。由于 $\\sqrt{\\alpha^2 - 4k^2c_h^2}  \\alpha$ (对于 $k \\neq 0$), $\\gamma_1  \\gamma_2$。主导（最慢）的阻尼率是较小的一个，即 $\\gamma_1$。\n主导阻尼率为 $\\gamma = \\frac{1}{2}\\left(\\alpha - \\sqrt{\\alpha^2 - 4k^2c_h^2}\\right)$。这个单一公式涵盖了临界阻尼（$4k^2c_h^2 = \\alpha^2$，得到 $\\gamma = \\alpha/2$）和过阻尼（$4k^2c_h^2  \\alpha^2$）。\n\n待实现的表达式总结：\n1. 正特征速度：$+c_h$。\n2. 负特征速度：$-c_h$。\n3. 如果 $(2kc_h)^2  \\alpha^2$：正相速度为 $\\sqrt{c_h^2 - (\\alpha/(2k))^2}$，负相速度为 $-\\sqrt{c_h^2 - (\\alpha/(2k))^2}$，主导阻尼率为 $\\alpha/2$。\n4. 如果 $(2kc_h)^2 \\le \\alpha^2$：两个相速度均为 $0$，主导阻尼率为 $\\frac{1}{2}(\\alpha - \\sqrt{\\alpha^2 - (2kc_h)^2})$。为保证在 $(2kc_h)^2 \\ll \\alpha^2$ 时的数值稳定性，最好计算为 $\\frac{(2kc_h)^2}{2(\\alpha + \\sqrt{\\alpha^2 - (2kc_h)^2})}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the GLM-MHD divergence cleaning problem by deriving and evaluating\n    characteristic speeds, phase speeds, and damping rates.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (c_h, alpha, k)\n    test_cases = [\n        (1.00e5, 1.00e3, 1.00e-1), # Test case 1 (underdamped)\n        (3.00e4, 1.20e5, 2.00),     # Test case 2 (critical)\n        (2.00e4, 1.00e5, 1.00e-1), # Test case 3 (overdamped)\n        (5.00e5, 1.00e3, 1.00e3),     # Test case 4 (high-k underdamped)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c_h, alpha, k = case\n        \n        # 1.  2. Characteristic speeds\n        c_char_pos = c_h\n        c_char_neg = -c_h\n        \n        # Determine the regime by comparing (2*k*c_h)^2 and alpha^2\n        # This is equivalent to comparing 2*k*c_h and alpha (since all are positive)\n        term_hyperbolic = 2.0 * k * c_h\n        \n        if term_hyperbolic > alpha:\n            # Underdamped regime\n            \n            # 3.  4. Phase speeds\n            # Formula: v_ph = sqrt(c_h^2 - (alpha/(2*k))^2)\n            phase_speed_val = np.sqrt(c_h**2 - (alpha / (2.0 * k))**2)\n            v_phase_pos = phase_speed_val\n            v_phase_neg = -phase_speed_val\n            \n            # 5. Dominant damping rate\n            # Formula: gamma = alpha/2\n            damping_rate = alpha / 2.0\n            \n        else:\n            # Overdamped or critical regime\n            \n            # 3.  4. Phase speeds\n            # Phase speed is 0 for non-oscillatory modes\n            v_phase_pos = 0.0\n            v_phase_neg = 0.0\n            \n            # 5. Dominant damping rate\n            # Formula: gamma = 0.5 * (alpha - sqrt(alpha^2 - (2*k*c_h)^2))\n            # The following numerically stable form is used to avoid\n            # catastrophic cancellation when (2*k*c_h)^2 is small compared to alpha^2.\n            # gamma = (2*k*c_h)^2 / (2 * (alpha + sqrt(alpha^2 - (2*k*c_h)^2)))\n            term_hyperbolic_sq = term_hyperbolic**2\n            alpha_sq = alpha**2\n            \n            # The term under the square root is guaranteed non-negative in this branch.\n            sqrt_term = np.sqrt(alpha_sq - term_hyperbolic_sq)\n            \n            # In the critical case, sqrt_term is 0 and this simplifies to\n            # (alpha^2) / (2*alpha) = alpha/2, which is correct.\n            damping_rate = term_hyperbolic_sq / (2.0 * (alpha + sqrt_term))\n\n        case_results = [\n            c_char_pos,\n            c_char_neg,\n            v_phase_pos,\n            v_phase_neg,\n            damping_rate\n        ]\n        results.append(case_results)\n\n    # Format the final output string exactly as required.\n    # Each number is formatted to 6 significant figures using {:.5e}\n    # No spaces are used, only commas.\n    outer_parts = []\n    for inner_list in results:\n        formatted_inner_list = [f\"{val:.5e}\" for val in inner_list]\n        outer_parts.append(f\"[{','.join(formatted_inner_list)}]\")\n    \n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}