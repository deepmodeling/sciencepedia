{
    "hands_on_practices": [
        {
            "introduction": "The ideal MHD model, where the magnetic field is perfectly \"frozen-in\" to the plasma flow, is a powerful but often idealized limit. This first practice explores the most common breakdown of this idealization by incorporating finite electrical resistivity. You will derive the resistive induction equation and use scaling analysis to compute the Lundquist number, a key dimensionless parameter that quantifies the relative importance of magnetic field advection versus resistive diffusion, providing a quantitative answer to when the ideal approximation is valid .",
            "id": "4216306",
            "problem": "Consider a homogeneous, fully ionized astrophysical plasma on a single characteristic length scale $L$, described by the single-fluid equations of Magnetohydrodynamics (MHD). Start from Faraday’s law and the generalized Ohm’s law for a collisional plasma,\n$$\\frac{\\partial \\boldsymbol{B}}{\\partial t}=-\\nabla\\times \\boldsymbol{E},$$\n$$\\boldsymbol{E}+\\boldsymbol{v}\\times \\boldsymbol{B}=\\eta\\,\\boldsymbol{J}+\\frac{1}{ne}\\,\\boldsymbol{J}\\times \\boldsymbol{B}-\\frac{\\nabla p_{e}}{ne}+\\frac{m_{e}}{ne^{2}}\\frac{d\\boldsymbol{J}}{dt},$$\nwhere $\\eta$ is the scalar electrical resistivity of the plasma, $n$ is the number density, $e$ is the elementary charge, $p_{e}$ is the electron pressure, and $m_{e}$ is the electron mass. Assume quasi-neutrality, neglect the displacement current, treat $\\eta$ as spatially uniform, and work in the regime where the Hall term, electron pressure-gradient term, and electron inertia term are negligible at the scale $L$ and times of interest. Derive the form of the induction equation that contains an advective term and a diffusive term, identify the magnetic diffusivity $\\eta_{m}$ in terms of the electrical conductivity $\\sigma$, and use scaling arguments to define a magnetic field diffusion timescale $\\tau_{\\eta}$ and a characteristic Alfvénic advection time $\\tau_{A}$. \n\nYou are given the following uniform plasma parameters representative of a solar-coronal current sheet:\n- Length scale $L=1.0\\times 10^{6}\\ \\mathrm{m}$,\n- Mass density $\\rho=1.7\\times 10^{-12}\\ \\mathrm{kg\\ m^{-3}}$,\n- Magnetic field magnitude $B_{0}=5.0\\times 10^{-3}\\ \\mathrm{T}$,\n- Electrical conductivity $\\sigma=1.0\\times 10^{14}\\ \\mathrm{S\\ m^{-1}}$,\n- Magnetic permeability of free space $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N\\ A^{-2}}$.\n\nCompute the ratio $\\tau_{\\eta}/\\tau_{A}$ using your derived expressions, where the Alfvén speed is defined by $V_{A}=B_{0}/\\sqrt{\\mu_{0}\\rho}$. Interpret the magnitude of this ratio in terms of whether Ohmic diffusion dominates or whether the ideal MHD limit of the generalized Ohm’s law is appropriate at scale $L$. Round your final numerical ratio to four significant figures. Express your final answer as a dimensionless number (no units).",
            "solution": "The problem is first validated. The premises are grounded in the standard framework of magnetohydrodynamics (MHD), a core subject in astrophysical plasma physics. The problem provides all necessary equations, definitions, assumptions, and numerical constants. The given values are physically plausible for the specified environment (a solar-coronal current sheet). The problem is self-contained, well-posed, objective, and internally consistent. No flaws are identified. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe derivation of the induction equation begins with the two provided laws: Faraday's law and the generalized Ohm's law.\nFaraday's law is given as:\n$$\n\\frac{\\partial \\boldsymbol{B}}{\\partial t}=-\\nabla\\times \\boldsymbol{E}\n$$\nThe generalized Ohm's law is:\n$$\n\\boldsymbol{E}+\\boldsymbol{v}\\times \\boldsymbol{B}=\\eta\\,\\boldsymbol{J}+\\frac{1}{ne}\\,\\boldsymbol{J}\\times \\boldsymbol{B}-\\frac{\\nabla p_{e}}{ne}+\\frac{m_{e}}{ne^{2}}\\frac{d\\boldsymbol{J}}{dt}\n$$\nThe problem states that we should neglect the Hall term ($\\frac{1}{ne}\\,\\boldsymbol{J}\\times \\boldsymbol{B}$), the electron pressure-gradient term ($-\\frac{\\nabla p_{e}}{ne}$), and the electron inertia term ($\\frac{m_{e}}{ne^{2}}\\frac{d\\boldsymbol{J}}{dt}$). Applying these simplifications to the generalized Ohm's law yields the resistive Ohm's law for a collisional plasma:\n$$\n\\boldsymbol{E}+\\boldsymbol{v}\\times \\boldsymbol{B}=\\eta\\,\\boldsymbol{J}\n$$\nWe can rearrange this equation to solve for the electric field $\\boldsymbol{E}$:\n$$\n\\boldsymbol{E} = -\\boldsymbol{v}\\times \\boldsymbol{B} + \\eta\\,\\boldsymbol{J}\n$$\nSubstituting this expression for $\\boldsymbol{E}$ into Faraday's law gives:\n$$\n\\frac{\\partial \\boldsymbol{B}}{\\partial t} = -\\nabla\\times(-\\boldsymbol{v}\\times \\boldsymbol{B} + \\eta\\,\\boldsymbol{J}) = \\nabla\\times(\\boldsymbol{v}\\times \\boldsymbol{B}) - \\nabla\\times(\\eta\\,\\boldsymbol{J})\n$$\nThe problem also states to neglect the displacement current, which implies we can use the magnetostatic form of Ampere's law:\n$$\n\\nabla\\times\\boldsymbol{B} = \\mu_{0}\\boldsymbol{J}\n$$\nwhere $\\mu_{0}$ is the magnetic permeability of free space. We can write the current density $\\boldsymbol{J}$ in terms of the magnetic field $\\boldsymbol{B}$:\n$$\n\\boldsymbol{J} = \\frac{1}{\\mu_{0}}\\nabla\\times\\boldsymbol{B}\n$$\nSubstituting this into the evolving induction equation, and noting that the electrical resistivity $\\eta$ is assumed to be spatially uniform, we get:\n$$\n\\frac{\\partial \\boldsymbol{B}}{\\partial t} = \\nabla\\times(\\boldsymbol{v}\\times \\boldsymbol{B}) - \\nabla\\times\\left(\\frac{\\eta}{\\mu_{0}}\\nabla\\times\\boldsymbol{B}\\right) = \\nabla\\times(\\boldsymbol{v}\\times \\boldsymbol{B}) - \\frac{\\eta}{\\mu_{0}}\\nabla\\times(\\nabla\\times\\boldsymbol{B})\n$$\nThe first term on the right-hand side, $\\nabla\\times(\\boldsymbol{v}\\times \\boldsymbol{B})$, is the advective term, which describes the transport of the magnetic field with the plasma fluid motion. The second term, $-\\frac{\\eta}{\\mu_{0}}\\nabla\\times(\\nabla\\times\\boldsymbol{B})$, is the diffusive term. We use the vector identity $\\nabla\\times(\\nabla\\times\\boldsymbol{A}) = \\nabla(\\nabla\\cdot\\boldsymbol{A}) - \\nabla^{2}\\boldsymbol{A}$. In magnetohydrodynamics, the magnetic field is always divergence-free, i.e., $\\nabla\\cdot\\boldsymbol{B}=0$. Applying this, the diffusive term simplifies:\n$$\n\\nabla\\times(\\nabla\\times\\boldsymbol{B}) = \\nabla(\\nabla\\cdot\\boldsymbol{B}) - \\nabla^{2}\\boldsymbol{B} = -\\nabla^{2}\\boldsymbol{B}\n$$\nThus, the final form of the induction equation is:\n$$\n\\frac{\\partial \\boldsymbol{B}}{\\partial t} = \\nabla\\times(\\boldsymbol{v}\\times \\boldsymbol{B}) + \\frac{\\eta}{\\mu_{0}}\\nabla^{2}\\boldsymbol{B}\n$$\nThis equation contains an advective term, $\\nabla\\times(\\boldsymbol{v}\\times \\boldsymbol{B})$, and a diffusive term, $\\frac{\\eta}{\\mu_{0}}\\nabla^{2}\\boldsymbol{B}$.\n\nThe magnetic diffusivity, denoted as $\\eta_{m}$, is the coefficient of the diffusive term. By inspection, we have:\n$$\n\\eta_{m} = \\frac{\\eta}{\\mu_{0}}\n$$\nThe electrical resistivity $\\eta$ is the reciprocal of the electrical conductivity $\\sigma$, so $\\eta = 1/\\sigma$. Therefore, the magnetic diffusivity can be expressed in terms of $\\sigma$ as:\n$$\n\\eta_{m} = \\frac{1}{\\mu_{0}\\sigma}\n$$\nNext, we define the characteristic timescales. The magnetic field diffusion timescale, $\\tau_{\\eta}$, is found by balancing the time-derivative term with the diffusion term in the induction equation. Using scaling analysis, where operators are replaced by characteristic scales ($\\partial/\\partial t \\sim 1/\\tau_{\\eta}$, $\\nabla \\sim 1/L$, and we denote the characteristic field strength by $B$):\n$$\n\\frac{B}{\\tau_{\\eta}} \\sim \\eta_{m} \\frac{B}{L^{2}} \\implies \\tau_{\\eta} = \\frac{L^{2}}{\\eta_{m}} = L^{2}\\mu_{0}\\sigma\n$$\nThe characteristic advection time, $\\tau_{A}$, is found by balancing the time-derivative term with the advection term. The characteristic velocity is the Alfvén speed, $V_{A}$.\n$$\n\\frac{B}{\\tau_{A}} \\sim \\frac{V_{A}B}{L} \\implies \\tau_{A} = \\frac{L}{V_{A}}\n$$\nWe are asked to compute the ratio $\\tau_{\\eta}/\\tau_{A}$:\n$$\n\\frac{\\tau_{\\eta}}{\\tau_{A}} = \\frac{L^{2}/\\eta_{m}}{L/V_{A}} = \\frac{LV_{A}}{\\eta_{m}}\n$$\nThis dimensionless ratio is known as the Lundquist number, $S$. Substituting the expressions for $V_{A}$ and $\\eta_{m}$:\n$$\nS = \\frac{L(B_{0}/\\sqrt{\\mu_{0}\\rho})}{1/(\\mu_{0}\\sigma)} = L V_{A} \\mu_{0} \\sigma = L\\left(\\frac{B_{0}}{\\sqrt{\\mu_{0}\\rho}}\\right)\\mu_{0}\\sigma = L \\sigma B_{0} \\sqrt{\\frac{\\mu_{0}}{\\rho}}\n$$\nNow, we substitute the given numerical values:\n$L = 1.0\\times 10^{6}\\ \\mathrm{m}$\n$\\sigma = 1.0\\times 10^{14}\\ \\mathrm{S\\ m^{-1}}$\n$B_{0} = 5.0\\times 10^{-3}\\ \\mathrm{T}$\n$\\mu_{0} = 4\\pi\\times 10^{-7}\\ \\mathrm{N\\ A^{-2}}$\n$\\rho = 1.7\\times 10^{-12}\\ \\mathrm{kg\\ m^{-3}}$\n\n$$\nS = (1.0 \\times 10^{6}) (1.0 \\times 10^{14}) (5.0 \\times 10^{-3}) \\sqrt{\\frac{4\\pi\\times 10^{-7}}{1.7\\times 10^{-12}}}\n$$\n$$\nS = (5.0 \\times 10^{17}) \\sqrt{\\frac{4\\pi}{1.7} \\times 10^{5}}\n$$\n$$\nS \\approx (5.0 \\times 10^{17}) \\sqrt{7.3919826 \\times 10^{5}}\n$$\n$$\nS \\approx (5.0 \\times 10^{17}) \\times 859.76639\n$$\n$$\nS \\approx 4298.83195 \\times 10^{17} = 4.29883195 \\times 10^{20}\n$$\nRounding to four significant figures, the ratio is $4.299 \\times 10^{20}$.\n\nThe ratio $\\tau_{\\eta}/\\tau_{A} = S \\approx 4.299 \\times 10^{20}$ is an extremely large number. This means that $\\tau_{\\eta} \\gg \\tau_{A}$. The timescale for magnetic diffusion is vastly longer than the timescale for hydromagnetic motions (advection). Consequently, on the scales of interest ($L$ and $\\tau_{A}$), the effects of Ohmic diffusion are negligible. The advective term $\\nabla\\times(\\boldsymbol{v}\\times \\boldsymbol{B})$ dominates the diffusive term $\\eta_{m}\\nabla^{2}\\boldsymbol{B}$ in the induction equation. This dominance implies that the magnetic field is \"frozen-in\" to the plasma, meaning the magnetic field lines are transported along with the bulk plasma flow. Therefore, the ideal MHD limit of the generalized Ohm's law, which corresponds to setting the right-hand side to zero ($\\boldsymbol{E}+\\boldsymbol{v}\\times \\boldsymbol{B} = 0$), is an excellent approximation for describing the plasma dynamics at the given scale in a solar-coronal current sheet.",
            "answer": "$$\n\\boxed{4.299 \\times 10^{20}}\n$$"
        },
        {
            "introduction": "Beyond simple resistivity, the generalized Ohm's law contains other terms that can break the frozen-in condition, particularly those arising from two-fluid physics. This exercise focuses on the Hall term, which becomes critical when characteristic length scales of the system become comparable to the ion inertial length, $d_i$. Through a careful scaling analysis, you will quantify the error introduced by neglecting the Hall term and derive the condition under which the single-fluid ideal MHD model remains accurate .",
            "id": "3703089",
            "problem": "Consider a high-temperature, quasi-neutral, magnetized fusion plasma (e.g., a tokamak core) composed of ions with mass $m_i$ and electrons, with uniform number density $n$ and a background magnetic field of magnitude $B_0$. Let the macroscopic flow be characterized by a single-fluid bulk speed $v$ and a characteristic spatial scale $L$ over which the magnetic field varies. Define the ion inertial length $d_i \\equiv c/\\omega_{pi}$, with $\\omega_{pi}^2 \\equiv n e^2/(\\varepsilon_0 m_i)$, and the Alfvén speed $v_A \\equiv B_0/\\sqrt{\\mu_0 n m_i}$, where $e$ is the elementary charge, $\\varepsilon_0$ is the vacuum permittivity, and $\\mu_0$ is the vacuum permeability.\n\nStarting from the electron momentum balance that leads to the generalized Ohm’s law and using Ampère’s law without displacement current, systematically estimate the leading-order fractional error in the electric field incurred when the Hall term $(\\boldsymbol{J} \\times \\boldsymbol{B})/(n e)$ is neglected in the reduction to ideal Magnetohydrodynamics (MHD). The fractional error should be defined as the ratio of the magnitude of the neglected Hall contribution to the magnitude of the ideal convective term $ \\boldsymbol{v} \\times \\boldsymbol{B}$.\n\nThen, for a prescribed small tolerance $\\delta$ (dimensionless) on this fractional error, express the corresponding threshold requirement on the ratio $d_i/L$ in terms of $\\delta$, $v$, and $v_A$ for which the single-fluid ideal MHD limit remains accurate.\n\nYour final answer must be analytic expressions. Do not include units in your final answer.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Plasma Composition and State**: A high-temperature, quasi-neutral, magnetized fusion plasma composed of ions with mass $m_i$ and electrons.\n- **Plasma Parameters**: Uniform number density $n$, background magnetic field of magnitude $B_0$.\n- **Flow Characteristics**: Macroscopic single-fluid bulk speed $v$, characteristic spatial scale $L$ for magnetic field variation.\n- **Definitions**:\n    - Ion inertial length: $d_i \\equiv c/\\omega_{pi}$\n    - Ion plasma frequency squared: $\\omega_{pi}^2 \\equiv n e^2/(\\varepsilon_0 m_i)$\n    - Alfvén speed: $v_A \\equiv B_0/\\sqrt{\\mu_0 n m_i}$\n- **Constants**: elementary charge $e$, vacuum permittivity $\\varepsilon_0$, vacuum permeability $\\mu_0$.\n- **Governing Physics**: Electron momentum balance (leading to generalized Ohm's law) and Ampère’s law without displacement current.\n- **Task 1**: Estimate the leading-order fractional error in the electric field, defined as the ratio of the magnitude of the neglected Hall term $(\\boldsymbol{J} \\times \\boldsymbol{B})/(n e)$ to the magnitude of the ideal convective term $\\boldsymbol{v} \\times \\boldsymbol{B}$.\n- **Task 2**: For a prescribed small dimensionless tolerance $\\delta$, express the threshold requirement on the ratio $d_i/L$ in terms of $\\delta$, $v$, and $v_A$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is formulated within the standard theoretical framework of plasma physics and Magnetohydrodynamics (MHD). All concepts, such as the generalized Ohm's law, Hall term, ideal MHD, Alfvén speed, and ion inertial length, are fundamental and well-established in the field. The context of a tokamak core fusion plasma is scientifically appropriate.\n- **Well-Posed**: The problem is clearly stated. It specifies the quantities to be calculated and the variables in which the final expressions should be presented. The request for an \"estimate\" is appropriate for this type of scaling analysis, and sufficient information is provided to perform it.\n- **Objective**: The language is precise, technical, and free of subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It meets all criteria for a valid problem statement. I will proceed with the solution.\n\nThe ideal MHD model is derived from a more complete two-fluid or kinetic description by making a series of approximations. One of the crucial steps is the simplification of the generalized Ohm's law. The full generalized Ohm's law, derived from the electron momentum equation, is:\n$$ \\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B} = \\eta \\boldsymbol{J} + \\frac{1}{ne}(\\boldsymbol{J} \\times \\boldsymbol{B}) - \\frac{1}{ne}\\boldsymbol{\\nabla} p_e + \\frac{m_e}{ne^2}\\frac{\\partial \\boldsymbol{J}}{\\partial t} $$\nIn ideal MHD, all terms on the right-hand side are neglected, yielding the ideal Ohm's law:\n$$ \\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B} = 0 $$\nThis implies that the electric field in the plasma frame, $\\boldsymbol{E}' = \\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B}$, is zero. The problem asks for the fractional error incurred by neglecting the Hall term, which is the second term on the right-hand side, $\\boldsymbol{E}_{Hall} = (\\boldsymbol{J} \\times \\boldsymbol{B})/(ne)$. The error is to be measured relative to the ideal convective term, $\\boldsymbol{v} \\times \\boldsymbol{B}$.\n\nLet the fractional error be denoted by $\\epsilon$. It is defined as the ratio of the magnitudes of the Hall term and the ideal convective term:\n$$ \\epsilon = \\frac{|\\boldsymbol{E}_{Hall}|}{|\\boldsymbol{v} \\times \\boldsymbol{B}|} = \\frac{|(\\boldsymbol{J} \\times \\boldsymbol{B})/(ne)|}{|\\boldsymbol{v} \\times \\boldsymbol{B}|} $$\nTo estimate this ratio, we perform a scaling analysis. Let the characteristic magnitudes of the quantities be $v$, $B_0$, $J$, and $L$. The magnitude of the denominator can be estimated as:\n$$ |\\boldsymbol{v} \\times \\boldsymbol{B}| \\sim v B_0 $$\nwhere we assume that $\\boldsymbol{v}$ and $\\boldsymbol{B}$ are not collinear, which is typical for cross-field dynamics.\n\nThe magnitude of the numerator is:\n$$ \\left|\\frac{\\boldsymbol{J} \\times \\boldsymbol{B}}{ne}\\right| \\sim \\frac{J B_0}{ne} $$\nTo estimate the magnitude of the current density, $J$, we use Ampère's law without the displacement current, as stated in the problem:\n$$ \\boldsymbol{\\nabla} \\times \\boldsymbol{B} = \\mu_0 \\boldsymbol{J} $$\nThe curl operator, $\\boldsymbol{\\nabla} \\times$, can be approximated in magnitude by $1/L$, where $L$ is the characteristic length scale over which the magnetic field varies. Thus, the magnitude of the current density is:\n$$ J \\sim |\\boldsymbol{J}| \\sim \\frac{|\\boldsymbol{\\nabla} \\times \\boldsymbol{B}|}{\\mu_0} \\sim \\frac{B_0/L}{\\mu_0} = \\frac{B_0}{\\mu_0 L} $$\nSubstituting this estimate for $J$ into the expression for the magnitude of the Hall term, we get:\n$$ |\\boldsymbol{E}_{Hall}| \\sim \\frac{1}{ne} \\left(\\frac{B_0}{\\mu_0 L}\\right) B_0 = \\frac{B_0^2}{\\mu_0 n e L} $$\nNow, we can compute the fractional error $\\epsilon$:\n$$ \\epsilon \\sim \\frac{B_0^2 / (\\mu_0 n e L)}{v B_0} = \\frac{B_0}{\\mu_0 n e v L} $$\nThis expression for $\\epsilon$ must be reformulated in terms of the given parameters $v_A$, $d_i$, $v$, and $L$. We use the definitions for the Alfvén speed $v_A$ and the ion inertial length $d_i$.\nUsing the relations $c^2 = 1/(\\varepsilon_0 \\mu_0)$ and $d_i = c/\\omega_{pi}$, we can write $d_i$ as:\n$$ d_i = \\frac{c}{\\sqrt{ne^2/(\\varepsilon_0 m_i)}} = c \\sqrt{\\frac{\\varepsilon_0 m_i}{ne^2}} = \\frac{1}{\\sqrt{\\mu_0}} \\sqrt{\\frac{m_i}{ne^2}} = \\frac{\\sqrt{m_i}}{e\\sqrt{\\mu_0 n}} $$\nNow, we rearrange our expression for $\\epsilon$ to isolate terms that match $v_A$ and $d_i$:\n$$ \\epsilon \\sim \\frac{1}{vL} \\frac{B_0}{\\mu_0 n e} = \\frac{1}{vL} \\left(\\frac{B_0}{\\sqrt{\\mu_0 n m_i}}\\right) \\left(\\frac{\\sqrt{\\mu_0 n m_i}}{\\mu_0 n e}\\right) $$\nThe first parenthesis contains the Alfvén speed, $v_A = B_0/\\sqrt{\\mu_0 n m_i}$. The second parenthesis can be simplified to:\n$$ \\frac{\\sqrt{\\mu_0 n m_i}}{\\mu_0 n e} = \\frac{\\sqrt{m_i}}{e \\sqrt{\\mu_0 n}} $$\nThis is precisely our expression for the ion inertial length $d_i$. Therefore, we can write the fractional error as:\n$$ \\epsilon \\sim \\frac{1}{vL} (v_A) (d_i) = \\frac{d_i v_A}{L v} $$\nThis is the first required result: the estimated leading-order fractional error. It can be written as the product of two dimensionless numbers: $(d_i/L)$ and the ratio of the Alfvén speed to the flow speed $(v_A/v)$.\n\nFor the second part of the problem, we are given a small tolerance $\\delta$ for this fractional error. The single-fluid ideal MHD description is considered accurate if the neglected Hall term is small compared to the ideal convective term, which means $\\epsilon < \\delta$.\nUsing our derived expression for $\\epsilon$:\n$$ \\frac{d_i v_A}{L v} < \\delta $$\nWe are asked to find the corresponding threshold requirement on the ratio $d_i/L$. We can isolate this term by rearranging the inequality:\n$$ \\frac{d_i}{L} < \\delta \\frac{v}{v_A} $$\nThis inequality is the threshold requirement. It signifies that for the ideal MHD approximation to be valid, the ion inertial length $d_i$ must be much smaller than the characteristic scale length $L$ of the system. The specific required smallness depends on the tolerance $\\delta$ and the ratio of the bulk flow speed to the Alfvén speed, $v/v_A$. The expression on the right-hand side, $\\delta(v/v_A)$, represents the threshold value.\n\nThe two required analytic expressions are the estimate for the fractional error $\\epsilon$ and the threshold value that $d_i/L$ must be less than.",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{d_i v_A}{L v} & \\delta \\frac{v}{v_A} \\end{pmatrix}} $$"
        },
        {
            "introduction": "Theoretical understanding must translate into practical application, especially in computational science, where the governing equations dictate the behavior of simulations. This final practice bridges theory and computation by having you derive and implement the numerical stability constraints for the induction equation, including ideal, resistive, and Hall effects. This exercise highlights how each physical term imposes a distinct limit on the simulation time step due to their different mathematical characters (hyperbolic, parabolic, and dispersive), providing a concrete understanding of their impact on numerical modeling .",
            "id": "3984608",
            "problem": "You are to design and implement a program that computes an explicit time step constraint for the induction equation obtained from the generalized Magnetohydrodynamics (MHD) Ohm’s law, focusing on the numerical stability of a forward-Euler time integration with second-order central finite differences in one spatial dimension. Your program must implement the most restrictive stability constraint among the three operators that appear in the induction equation when the generalized Ohm’s law is truncated to the ideal, resistive, and Hall contributions.\n\nBegin from the following fundamental base:\n- Faraday’s law: $\\displaystyle \\frac{\\partial \\mathbf{B}}{\\partial t} = -\\,\\nabla \\times \\mathbf{E}$.\n- Ampère’s law neglecting displacement current: $\\displaystyle \\mu_{0}\\,\\mathbf{J} = \\nabla \\times \\mathbf{B}$.\n- Quasi-neutrality with single ion species and unit charge state: $\\displaystyle n_{e} \\approx n_{i}$.\n- A truncated generalized Ohm’s law that keeps the ideal, resistive, and Hall contributions: $\\displaystyle \\mathbf{E} = -\\,\\mathbf{v}\\times\\mathbf{B} + \\eta\\,\\mathbf{J} + \\frac{1}{n_{e} e}\\,\\mathbf{J}\\times \\mathbf{B}$, with uniform $\\eta$ and uniform background $\\mathbf{B}$ for linearization.\n- Equation of state for the sound speed: $\\displaystyle c_{s} = \\sqrt{\\gamma\\,p/\\rho}$ with adiabatic index $\\gamma$.\n\nFrom these, you must:\n1) Derive appropriate characteristic speeds or frequencies for each term under a linearization about a uniform background magnetic field $\\mathbf{B}_{0}$ in a homogeneous plasma with mass density $\\rho$, electron number density $n_{e}$, and pressure $p$. Assume single-ion species of mass $m_{i}$ and charge $+e$, and neglect electron pressure gradients at leading order for the induction equation. Specifically:\n- For the ideal contribution, determine the relevant hyperbolic characteristic speed using linear MHD waves and justify a bound based on the fast magnetosonic speed in the worst-case perpendicular propagation, $\\displaystyle c_{f} = \\sqrt{c_{s}^{2}+v_{A}^{2}}$, with Alfvén speed $\\displaystyle v_{A} = \\frac{B_{0}}{\\sqrt{\\mu_{0}\\rho}}$ and sound speed $\\displaystyle c_{s} = \\sqrt{\\gamma p/\\rho}$.\n- For the Hall contribution, linearize to obtain the whistler dispersion $\\displaystyle \\omega \\propto k^{2}$ for waves propagating along $\\mathbf{B}_{0}$, and use the ion inertial length $\\displaystyle d_{i} = \\sqrt{\\frac{m_{i}}{\\mu_{0} n_{e} e^{2}}}$ to show the scaling $\\displaystyle \\omega \\sim v_{A} d_{i} k^{2}$.\n- For the resistive contribution, show that the induction equation reduces locally to a diffusion equation with magnetic diffusivity $\\displaystyle \\eta_{m} = \\eta/\\mu_{0}$.\n\n2) Convert the above into explicit time-step constraints for a forward-Euler time integrator with second-order central differencing on a uniform grid with spacing $\\Delta x$. Your constraints must be expressed in terms of the following scheme parameters:\n- A hyperbolic Courant-Friedrichs-Lewy (CFL) constant $\\displaystyle C_{\\text{hyp}}$ such that $\\displaystyle \\Delta t_{\\text{hyp}} \\le C_{\\text{hyp}}\\,\\frac{\\Delta x}{c_{f}}$.\n- A whistler stability constant $\\displaystyle C_{\\text{wh}}$ using the maximum resolvable wavenumber $\\displaystyle k_{\\max} \\approx \\pi/\\Delta x$, i.e., $\\displaystyle \\Delta t_{\\text{wh}} \\le \\frac{C_{\\text{wh}}}{v_{A} d_{i} k_{\\max}^{2}}$ when $\\displaystyle v_{A} d_{i} > 0$, and otherwise no Hall constraint.\n- A resistive stability constant $\\displaystyle C_{\\eta}$ such that $\\displaystyle \\Delta t_{\\eta} \\le C_{\\eta}\\,\\frac{\\Delta x^{2}}{\\eta_{m}}$.\nCombine them with a global safety factor $\\displaystyle S$ as $\\displaystyle \\Delta t = S \\,\\min\\{\\Delta t_{\\text{hyp}},\\Delta t_{\\text{wh}},\\Delta t_{\\eta}\\}$, with the convention that constraints that are not active (e.g., $\\displaystyle v_{A} d_{i} = 0$ or $\\displaystyle \\eta = 0$) are treated as $+\\infty$.\n\n3) Implement a program that, for each test case below, computes $\\displaystyle \\Delta t$ in seconds using the derived constraints. You must use International System of Units (SI) for all inputs and outputs. Use the following constants in SI units: $\\displaystyle \\mu_{0} = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$, elementary charge $\\displaystyle e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, and adiabatic index $\\displaystyle \\gamma = 5/3$ unless otherwise specified.\n\nAdopt the scheme parameters $\\displaystyle C_{\\text{hyp}} = 0.8$, $\\displaystyle C_{\\text{wh}} = 0.4$, $\\displaystyle C_{\\eta} = 0.5$, and $\\displaystyle S = 0.9$.\n\nYour program must evaluate the following five test cases, each defined by a tuple $\\displaystyle (\\rho, p, B_{0}, n_{e}, m_{i}, \\eta, \\Delta x)$, all in SI units:\n- Case A (tokamak core, moderate resistivity, moderate grid): $\\displaystyle \\rho = 3.345\\times 10^{-7}\\,\\mathrm{kg/m^{3}}$, $\\displaystyle p = 3.204\\times 10^{5}\\,\\mathrm{Pa}$, $\\displaystyle B_{0} = 5\\,\\mathrm{T}$, $\\displaystyle n_{e} = 1\\times 10^{20}\\,\\mathrm{m^{-3}}$, $\\displaystyle m_{i} = 3.345243848\\times 10^{-27}\\,\\mathrm{kg}$, $\\displaystyle \\eta = 1\\times 10^{-7}\\,\\Omega\\cdot \\mathrm{m}$, $\\displaystyle \\Delta x = 1\\times 10^{-3}\\,\\mathrm{m}$.\n- Case B (Hall-dominated by fine grid): $\\displaystyle \\rho = 3.345\\times 10^{-7}\\,\\mathrm{kg/m^{3}}$, $\\displaystyle p = 3.204\\times 10^{5}\\,\\mathrm{Pa}$, $\\displaystyle B_{0} = 5\\,\\mathrm{T}$, $\\displaystyle n_{e} = 1\\times 10^{20}\\,\\mathrm{m^{-3}}$, $\\displaystyle m_{i} = 3.345243848\\times 10^{-27}\\,\\mathrm{kg}$, $\\displaystyle \\eta = 1\\times 10^{-7}\\,\\Omega\\cdot \\mathrm{m}$, $\\displaystyle \\Delta x = 1\\times 10^{-5}\\,\\mathrm{m}$.\n- Case C (resistive-dominated): $\\displaystyle \\rho = 3.345\\times 10^{-8}\\,\\mathrm{kg/m^{3}}$, $\\displaystyle p = 1.000\\times 10^{3}\\,\\mathrm{Pa}$, $\\displaystyle B_{0} = 0.5\\,\\mathrm{T}$, $\\displaystyle n_{e} = 1\\times 10^{19}\\,\\mathrm{m^{-3}}$, $\\displaystyle m_{i} = 3.345243848\\times 10^{-27}\\,\\mathrm{kg}$, $\\displaystyle \\eta = 1\\times 10^{-2}\\,\\Omega\\cdot \\mathrm{m}$, $\\displaystyle \\Delta x = 1\\times 10^{-3}\\,\\mathrm{m}$.\n- Case D (weak field, sound-speed limited): $\\displaystyle \\rho = 3.345\\times 10^{-7}\\,\\mathrm{kg/m^{3}}$, $\\displaystyle p = 3.204\\times 10^{5}\\,\\mathrm{Pa}$, $\\displaystyle B_{0} = 1.0\\times 10^{-4}\\,\\mathrm{T}$, $\\displaystyle n_{e} = 1\\times 10^{20}\\,\\mathrm{m^{-3}}$, $\\displaystyle m_{i} = 3.345243848\\times 10^{-27}\\,\\mathrm{kg}$, $\\displaystyle \\eta = 1\\times 10^{-7}\\,\\Omega\\cdot \\mathrm{m}$, $\\displaystyle \\Delta x = 1\\times 10^{-3}\\,\\mathrm{m}$.\n- Case E (edge-like, strong field, fine grid, low density): $\\displaystyle \\rho = 3.345\\times 10^{-9}\\,\\mathrm{kg/m^{3}}$, $\\displaystyle p = 1.000\\times 10^{4}\\,\\mathrm{Pa}$, $\\displaystyle B_{0} = 8.0\\,\\mathrm{T}$, $\\displaystyle n_{e} = 1\\times 10^{18}\\,\\mathrm{m^{-3}}$, $\\displaystyle m_{i} = 3.345243848\\times 10^{-27}\\,\\mathrm{kg}$, $\\displaystyle \\eta = 1\\times 10^{-8}\\,\\Omega\\cdot \\mathrm{m}$, $\\displaystyle \\Delta x = 5\\times 10^{-5}\\,\\mathrm{m}$.\n\nOutput specification:\n- For each case, your program must compute the stable explicit time step $\\displaystyle \\Delta t$ in seconds.\n- Your program must produce a single line of output containing the results for Cases A through E in order, as a comma-separated list enclosed in square brackets, e.g., $\\displaystyle [x_{A},x_{B},x_{C},x_{D},x_{E}]$, where each $\\displaystyle x_{i}$ is a floating-point number in seconds, formatted in scientific notation with exactly six significant digits (for example, $\\displaystyle 1.234560\\mathrm{e}{-3}$).",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of magnetohydrodynamics and numerical analysis of partial differential equations. The problem is well-posed, objective, and provides all necessary information for a unique solution. We will proceed with the derivation and implementation as requested.\n\nThe evolution of the magnetic field $\\mathbf{B}$ is governed by Faraday's law of induction:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\nThe problem provides a truncated generalized Ohm's law for the electric field $\\mathbf{E}$:\n$$\n\\mathbf{E} = -\\mathbf{v}\\times\\mathbf{B} + \\eta\\,\\mathbf{J} + \\frac{1}{n_{e} e}\\,\\mathbf{J}\\times \\mathbf{B}\n$$\nwhere the terms on the right-hand side represent the ideal MHD, resistive, and Hall effects, respectively. Using Ampère's law, $\\mu_{0}\\,\\mathbf{J} = \\nabla \\times \\mathbf{B}$, we can express the current density $\\mathbf{J}$ in terms of $\\mathbf{B}$. Substituting the expressions for $\\mathbf{E}$ and $\\mathbf{J}$ into Faraday's law yields the induction equation:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v}\\times\\mathbf{B}) - \\nabla \\times \\left(\\frac{\\eta}{\\mu_0} \\nabla \\times \\mathbf{B}\\right) - \\nabla \\times \\left(\\frac{1}{n_{e} e \\mu_0} (\\nabla \\times \\mathbf{B}) \\times \\mathbf{B}\\right)\n$$\nFor a numerical solution using an explicit time integration method such as forward Euler, the time step $\\Delta t$ is limited by the fastest dynamics in the system. We analyze the stability constraint imposed by each of the three terms separately.\n\n1.  **Ideal (Hyperbolic) Contribution**: The term $\\nabla \\times (\\mathbf{v}\\times\\mathbf{B})$ describes the advection of magnetic field lines with the plasma flow. This term gives rise to hyperbolic phenomena, namely MHD waves. The fastest possible propagation speed for any disturbance in an ideal MHD plasma is the fast magnetosonic speed, $c_f$. For a wave propagating perpendicular to the background magnetic field $\\mathbf{B}_0$, this speed is given by $c_{f} = \\sqrt{c_{s}^{2}+v_{A}^{2}}$, where $c_{s} = \\sqrt{\\gamma p/\\rho}$ is the sound speed and $v_{A} = B_{0}/\\sqrt{\\mu_{0}\\rho}$ is the Alfvén speed. Using a forward-Euler time-stepping scheme with second-order central differences in space for a one-dimensional system with grid spacing $\\Delta x$, the Courant-Friedrichs-Lewy (CFL) condition imposes a limit on the time step. The most restrictive case corresponds to the fastest speed, $c_f$. The stability constraint is:\n    $$\n    \\Delta t_{\\text{hyp}} \\le C_{\\text{hyp}}\\,\\frac{\\Delta x}{c_{f}}\n    $$\n    where $C_{\\text{hyp}}$ is a numerical constant of order unity, given as $0.8$.\n\n2.  **Resistive (Parabolic) Contribution**: The term $-\\nabla \\times (\\frac{\\eta}{\\mu_0} \\nabla \\times \\mathbf{B})$ describes the diffusion of the magnetic field. Assuming a uniform resistivity $\\eta$, and using the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B}$ along with the solenoidal constraint $\\nabla \\cdot \\mathbf{B} = 0$, this term simplifies to $\\frac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B}$. The induction equation thus contains a diffusion term of the form $\\frac{\\partial \\mathbf{B}}{\\partial t} = \\eta_m \\nabla^2 \\mathbf{B}$, where $\\eta_m = \\eta/\\mu_0$ is the magnetic diffusivity. For the 1D diffusion equation discretized with forward-Euler in time and second-order central differences in space, the stability condition is $\\Delta t \\le \\frac{\\Delta x^2}{2\\eta_m}$. The problem provides a generalized form:\n    $$\n    \\Delta t_{\\eta} \\le C_{\\eta}\\,\\frac{\\Delta x^{2}}{\\eta_{m}}\n    $$\n    with a given numerical constant $C_{\\eta} = 0.5$. If $\\eta=0$, then $\\eta_m=0$, and this constraint is inactive (i.e., $\\Delta t_{\\eta} \\to \\infty$).\n\n3.  **Hall (Dispersive) Contribution**: The term $-\\nabla \\times (\\frac{1}{n_{e} e \\mu_0} (\\nabla \\times \\mathbf{B}) \\times \\mathbf{B})$ is the Hall term, which becomes significant at scales comparable to the ion inertial length. To find its characteristic frequency, we linearize the equation for a small perturbation $\\mathbf{b}_1$ around a uniform background field $\\mathbf{B}_0 = B_0 \\hat{z}$ and a stationary plasma ($\\mathbf{v}=0$).\n    $$\n    \\frac{\\partial \\mathbf{b}_1}{\\partial t} \\approx -\\frac{1}{n_{e} e \\mu_0} \\nabla \\times ((\\nabla \\times \\mathbf{b}_1) \\times \\mathbf{B}_0)\n    $$\n    Assuming a plane wave solution $\\mathbf{b}_1 \\propto \\exp(i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t))$ propagating parallel to the field ($\\mathbf{k} = k \\hat{z}$), the dispersion relation for these circularly polarized waves (whistler waves) is $\\omega(k) = \\pm \\frac{B_0}{n_e e \\mu_0} k^2$. The problem requires us to show the scaling $\\omega \\sim v_{A} d_{i} k^{2}$. The ion inertial length is $d_{i} = \\sqrt{\\frac{m_{i}}{\\mu_{0} n_{e} e^{2}}}$ and the Alfvén speed is $v_{A} = \\frac{B_0}{\\sqrt{\\mu_0 \\rho}}$. With plasma mass density $\\rho \\approx n_i m_i$ and quasi-neutrality $n_i \\approx n_e$, we have $\\rho \\approx n_e m_i$. The product is:\n    $$\n    v_A d_i = \\frac{B_0}{\\sqrt{\\mu_0 n_e m_i}} \\sqrt{\\frac{m_i}{\\mu_0 n_e e^2}} = \\frac{B_0}{\\mu_0 n_e e}\n    $$\n    This confirms that the whistler dispersion relation is $\\omega(k) \\propto (v_A d_i) k^2$. This quadratic dependence of frequency on wavenumber imposes a severe stability constraint on explicit time-stepping schemes, which scales with $\\Delta x^2$. The shortest wavelength (largest wavenumber) resolvable on the grid is $k_{\\max} \\approx \\pi / \\Delta x$. The stability constraint is given as:\n    $$\n    \\Delta t_{\\text{wh}} \\le \\frac{C_{\\text{wh}}}{v_{A} d_{i} k_{\\max}^{2}} = \\frac{C_{\\text{wh}} \\Delta x^2}{(B_0 / (\\mu_0 n_e e)) \\pi^2}\n    $$\n    where $C_{\\text{wh}}$ is a numerical constant given as $0.4$. This constraint is active only if the Hall term is present, i.e., $B_0 > 0$. If $B_0=0$, the prefactor $v_A d_i = 0$, and this constraint is inactive ($\\Delta t_{\\text{wh}} \\to \\infty$).\n\n**Final Time Step Calculation**:\nTo ensure stability against all three physical processes, the overall time step $\\Delta t$ must be smaller than the minimum of the individual limits. A global safety factor $S$, given as $0.9$, is applied to stay safely below the stability boundary.\n$$\n\\Delta t = S \\cdot \\min(\\Delta t_{\\text{hyp}}, \\Delta t_{\\eta}, \\Delta t_{\\text{wh}})\n$$\nInactive constraints are treated as having an infinite time step limit, so they do not affect the minimum. We now implement this logic to compute $\\Delta t$ for the given test cases. All calculations are performed in SI units.",
            "answer": "[9.192534e-11,1.636665e-11,3.562767e-07,6.398604e-10,4.881452e-12]"
        }
    ]
}