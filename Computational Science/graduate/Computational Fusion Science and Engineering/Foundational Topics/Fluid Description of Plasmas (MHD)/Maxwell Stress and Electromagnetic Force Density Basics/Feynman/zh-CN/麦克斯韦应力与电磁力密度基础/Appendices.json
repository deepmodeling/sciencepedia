{
    "hands_on_practices": [
        {
            "introduction": "在深入研究麦克斯韦应力张量的复杂应用之前，首要任务是建立对其物理本质的直观理解。通过量纲分析，我们可以验证该张量的各个分量确实具有力/面积（即压强）的单位。这项基础练习不仅是物理学研究中的一个重要“健全性检查”，还能帮助我们将抽象的张量与能量密度等具体物理概念联系起来。",
            "id": "4009092",
            "problem": "在用于磁约束聚变的磁流体动力学（MHD）建模中，电磁场施加在面向等离子体边界上的表面牵引力由麦克斯韦应力张量计算得出。考虑形式为 $\\epsilon_{0}\\left(E_{i}E_{j}-\\frac{1}{2}\\delta_{ij}E^{2}\\right)$ 的电场贡献和形式为 $\\frac{1}{\\mu_{0}}\\left(B_{i}B_{j}-\\frac{1}{2}\\delta_{ij}B^{2}\\right)$ 的磁场贡献，其中 $\\epsilon_{0}$ 是真空介电常数，$\\mu_{0}$ 是真空磁导率，$E_{i}$ 和 $B_{i}$ 分别是电场和磁场的笛卡尔分量，而 $\\delta_{ij}$ 是克罗内克δ。\n\n从国际单位制（SI）中的基本定义和洛伦兹力定律 $F = q\\left(E + v \\times B\\right)$ 出发，并仅使用以下基本单位关系：\n- $[q] = \\mathrm{A}\\,\\mathrm{s}$ 代表电荷，\n- $[V] = \\mathrm{kg}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-3}\\,\\mathrm{A}^{-1}$ 代表伏特，\n- $[F] = \\mathrm{C}\\,\\mathrm{V}^{-1}$ 代表法拉，\n- $[H] = \\mathrm{V}\\,\\mathrm{s}\\,\\mathrm{A}^{-1}$ 代表亨利，\n- $[E] = \\mathrm{V}\\,\\mathrm{m}^{-1}$ 代表电场，\n- $[B] = \\mathrm{T} = \\mathrm{Wb}\\,\\mathrm{m}^{-2}$ 且 $[Wb] = \\mathrm{V}\\,\\mathrm{s}$ 代表磁场，\n\n推导质量-长度-时间量纲指数 $(\\alpha,\\beta,\\gamma)$，使得麦克斯韦应力张量的每一项 $\\epsilon_{0}E^{2}$ 和 $\\frac{1}{\\mu_{0}}B^{2}$ 都具有量纲 $\\mathrm{kg}^{\\alpha}\\,\\mathrm{m}^{\\beta}\\,\\mathrm{s}^{\\gamma}$。\n\n将最终答案表示为包含 $(\\alpha,\\beta,\\gamma)$ 的单行矩阵。最终答案中不要包含单位。",
            "solution": "该问题要求推导麦克斯韦应力张量项 $\\epsilon_{0}E^{2}$ 和 $\\frac{1}{\\mu_{0}}B^{2}$ 的质量-长度-时间量纲指数 $(\\alpha, \\beta, \\gamma)$。这些项的量纲应为 $\\mathrm{kg}^{\\alpha}\\,\\mathrm{m}^{\\beta}\\,\\mathrm{s}^{\\gamma}$ 的形式。推导过程必须仅使用所提供的基本定义和单位关系。\n\n设物理量 $X$ 的量纲用 $[X]$ 表示。我们将使用的基本量纲是质量（$\\mathrm{M}$）、长度（$\\mathrm{L}$）、时间（$\\mathrm{T}$）和电流（$\\mathrm{A}$），它们分别对应于国际单位制（SI）的基本单位千克（$\\mathrm{kg}$）、米（$\\mathrm{m}$）、秒（$\\mathrm{s}$）和安培（$\\mathrm{A}$）。\n\n首先，我们用这些基本量纲来表示给定导出单位的量纲。\n根据题目陈述：\n电荷的量纲，$[q]$，给出为 $\\mathrm{A}\\,\\mathrm{s}$。因此，$[q] = \\mathrm{A}\\mathrm{T}$。\n电势的量纲，$[V]$，给出为 $\\mathrm{kg}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-3}\\,\\mathrm{A}^{-1}$。因此，$[V] = \\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-3}\\mathrm{A}^{-1}$。\n\n我们将分别分析每一项 $\\epsilon_{0}E^{2}$ 和 $\\frac{1}{\\mu_{0}}B^{2}$，以找出它们的量纲并验证它们是相同的。\n\n**第一部分：电场项 $\\epsilon_{0}E^{2}$ 的量纲分析**\n\n1.  **电场的量纲, $[E]$**：\n    电场的单位给出为伏特每米，$[E] = \\mathrm{V}\\,\\mathrm{m}^{-1}$。\n    使用伏特的量纲，我们得到：\n    $$[E] = \\frac{[V]}{\\mathrm{L}} = \\frac{\\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-3}\\mathrm{A}^{-1}}{\\mathrm{L}} = \\mathrm{M}\\mathrm{L}\\mathrm{T}^{-3}\\mathrm{A}^{-1}$$\n\n2.  **真空介电常数的量纲, $[\\epsilon_0]$**：\n    电容的单位是法拉（$\\mathrm{F}$），给出为 $[F] = \\mathrm{C}\\,\\mathrm{V}^{-1}$，其中 $\\mathrm{C}$ 是库仑，电荷的单位。真空介电常数 $\\epsilon_0$ 的单位是法拉每米。\n    首先，我们求出法拉的量纲。由于库仑是电荷的单位，$[\\mathrm{C}] = [q] = \\mathrm{A}\\mathrm{T}$。\n    $$[\\text{法拉}] = \\frac{[\\mathrm{C}]}{[V]} = \\frac{\\mathrm{A}\\mathrm{T}}{\\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-3}\\mathrm{A}^{-1}} = \\mathrm{M}^{-1}\\mathrm{L}^{-2}\\mathrm{T}^{4}\\mathrm{A}^{2}$$\n    $\\epsilon_0$ 的量纲是单位长度的电容：\n    $$[\\epsilon_0] = \\frac{[\\text{法拉}]}{\\mathrm{L}} = \\frac{\\mathrm{M}^{-1}\\mathrm{L}^{-2}\\mathrm{T}^{4}\\mathrm{A}^{2}}{\\mathrm{L}} = \\mathrm{M}^{-1}\\mathrm{L}^{-3}\\mathrm{T}^{4}\\mathrm{A}^{2}$$\n\n3.  **$\\epsilon_{0}E^{2}$ 的量纲**：\n    现在我们组合 $\\epsilon_0$ 和 $E^2$ 的量纲：\n    $$[\\epsilon_{0}E^{2}] = [\\epsilon_0][E]^2 = (\\mathrm{M}^{-1}\\mathrm{L}^{-3}\\mathrm{T}^{4}\\mathrm{A}^{2}) \\cdot (\\mathrm{M}\\mathrm{L}\\mathrm{T}^{-3}\\mathrm{A}^{-1})^2$$\n    $$[\\epsilon_{0}E^{2}] = (\\mathrm{M}^{-1}\\mathrm{L}^{-3}\\mathrm{T}^{4}\\mathrm{A}^{2}) \\cdot (\\mathrm{M}^{2}\\mathrm{L}^{2}\\mathrm{T}^{-6}\\mathrm{A}^{-2})$$\n    将这些量纲相乘，即对每个基本单位的指数求和：\n    $$[\\epsilon_{0}E^{2}] = \\mathrm{M}^{-1+2} \\mathrm L^{-3+2} \\mathrm T^{4-6} \\mathrm A^{2-2} = \\mathrm{M}^{1}\\mathrm{L}^{-1}\\mathrm{T}^{-2}\\mathrm{A}^{0} = \\mathrm{M}\\mathrm{L}^{-1}\\mathrm{T}^{-2}$$\n\n**第二部分：磁场项 $\\frac{1}{\\mu_{0}}B^{2}$ 的量纲分析**\n\n1.  **磁场的量纲, $[B]$**：\n    磁场的单位是特斯拉（$\\mathrm{T}$），给出为韦伯每平方米，$[B] = \\mathrm{Wb}\\,\\mathrm{m}^{-2}$。韦伯（$\\mathrm{Wb}$）定义为伏特-秒，$[Wb] = \\mathrm{V}\\,\\mathrm{s}$。\n    首先，我们求出韦伯的量纲：\n    $$[Wb] = [V]\\mathrm{T} = (\\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-3}\\mathrm{A}^{-1})\\mathrm{T} = \\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-2}\\mathrm{A}^{-1}$$\n    现在，我们求出磁场的量纲：\n    $$[B] = \\frac{[Wb]}{\\mathrm{L}^2} = \\frac{\\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-2}\\mathrm{A}^{-1}}{\\mathrm{L}^2} = \\mathrm{M}\\mathrm{T}^{-2}\\mathrm{A}^{-1}$$\n\n2.  **真空磁导率的量纲, $[\\mu_0]$**：\n    电感的单位是亨利（$\\mathrm{H}$），给出为 $[H] = \\mathrm{V}\\,\\mathrm{s}\\,\\mathrm{A}^{-1}$。真空磁导率 $\\mu_0$ 的单位是亨利每米。\n    首先，我们求出亨利的量纲：\n    $$[\\text{亨利}] = \\frac{[V]\\mathrm{T}}{\\mathrmA} = \\frac{(\\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-3}\\mathrm{A}^{-1})\\mathrm{T}}{\\mathrmA} = \\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-2}\\mathrm{A}^{-2}$$\n    $\\mu_0$ 的量纲是单位长度的电感：\n    $$[\\mu_0] = \\frac{[\\text{亨利}]}{\\mathrm{L}} = \\frac{\\mathrm{M}\\mathrm{L}^{2}\\mathrm{T}^{-2}\\mathrm{A}^{-2}}{\\mathrm{L}} = \\mathrm{M}\\mathrm{L}\\mathrm{T}^{-2}\\mathrm{A}^{-2}$$\n\n3.  **$\\frac{1}{\\mu_{0}}B^{2}$ 的量纲**：\n    我们组合 $B^2$ 和 $\\frac{1}{\\mu_0}$ 的量纲：\n    $$[\\frac{1}{\\mu_{0}}B^{2}] = \\frac{[B]^2}{[\\mu_0]} = \\frac{(\\mathrm{M}\\mathrm{T}^{-2}\\mathrm{A}^{-1})^2}{\\mathrm{M}\\mathrm{L}\\mathrm{T}^{-2}\\mathrm{A}^{-2}}$$\n    $$[\\frac{1}{\\mu_{0}}B^{2}] = \\frac{\\mathrm{M}^{2}\\mathrm{T}^{-4}\\mathrm{A}^{-2}}{\\mathrm{M}\\mathrm{L}\\mathrm{T}^{-2}\\mathrm{A}^{-2}}$$\n    将这些量纲相除，即将分母中每个基本单位的指数从分子中相应的指数减去：\n    $$[\\frac{1}{\\mu_{0}}B^{2}] = \\mathrm{M}^{2-1} \\mathrm L^{0-1} \\mathrm T^{-4-(-2)} \\mathrm A^{-2-(-2)} = \\mathrm{M}^{1}\\mathrm{L}^{-1}\\mathrm{T}^{-2}\\mathrm{A}^{0} = \\mathrm{M}\\mathrm{L}^{-1}\\mathrm{T}^{-2}$$\n\n**结论**\n\n$\\epsilon_{0}E^{2}$ 和 $\\frac{1}{\\mu_{0}}B^{2}$ 这两项具有相同的量纲：$\\mathrm{M}\\mathrm{L}^{-1}\\mathrm{T}^{-2}$。这个量纲对应于压强（单位面积的力）或能量密度（单位体积的能量），这也是麦克斯韦应力张量分量所期望的量纲。\n$$[\\mathrm{压强}] = \\frac{[\\mathrm{力}]}{[\\mathrm{面积}]} = \\frac{\\mathrm{M}\\mathrm{L}\\mathrm{T}^{-2}}{\\mathrm{L}^2} = \\mathrm{M}\\mathrm{L}^{-1}\\mathrm{T}^{-2}$$\n为了将其表示为 $\\mathrm{kg}^{\\alpha}\\,\\mathrm{m}^{\\beta}\\,\\mathrm{s}^{\\gamma}$ 的形式，我们将基本量纲映射到国际单位制基本单位：$\\mathrm{M} \\rightarrow \\mathrm{kg}$，$\\mathrm{L} \\rightarrow \\mathrm{m}$，$\\mathrm{T} \\rightarrow \\mathrm{s}$。\n得到的量纲是 $\\mathrm{kg}^{1}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-2}$。\n因此，指数为 $\\alpha = 1$，$\\beta = -1$，$\\gamma = -2$。",
            "answer": "$$\\boxed{\\begin{pmatrix}1  -1  -2\\end{pmatrix}}$$"
        },
        {
            "introduction": "理解了麦克斯韦应力张量的物理量纲后，下一步是探究其理论根源。本练习要求从第一性原理出发，即洛伦兹力密度和安培定律，推导出静磁场下的应力张量。这个推导过程清晰地揭示了应力张量是如何作为一种数学工具，用于描述力在空间中的分布，其张量散度等效于作用在物质上的洛伦兹力密度。 此外，通过计算张量的迹，我们将抽象的数学形式与磁压这一核心物理概念直接联系起来。",
            "id": "4009130",
            "problem": "在磁静力学体系下运行的磁约束聚变等离子体中，电场可忽略不计，磁场是静态的。考虑一个单连通区域，其中场是平滑的，等离子体电流是稳恒的，因此磁场由麦克斯韦方程组支配，而洛伦兹力密度是场对物质的唯一作用力。从经典电动力学的基本关系——磁静力学中的麦克斯韦方程组和洛伦兹力密度——出发，在不引用任何已知应力公式的情况下，推导出在静态情况下平衡洛伦兹力的对称场应力。利用此结果计算静态磁场下应力张量 $T_{ij}$ 的迹。将最终答案表示为关于磁场大小 $B$ 和真空磁导率 $\\mu_{0}$ 的闭合形式解析表达式。最后，简要地用磁压强解释迹的符号和大小，并说明在该体系下为何没有电场的贡献。如果要对你的表达式进行数值计算，迹的单位是压强，应以帕斯卡表示。本题无需进行数值计算。",
            "solution": "问题陈述经评估是有效的。它在经典电动力学方面有科学依据，是自洽、适定和客观的。它提出了一个磁流体力学中标准的、非平凡的推导任务，没有矛盾或歧义。\n\n目标是在磁静力学体系中推导出平衡洛伦兹力的对称场应力张量，然后计算其迹。\n\n电磁场对介质的基本力密度是洛伦兹力密度，由 $\\mathbf{f} = \\rho\\mathbf{E} + \\mathbf{J}\\times\\mathbf{B}$ 给出，其中 $\\rho$ 是电荷密度，$\\mathbf{E}$ 是电场，$\\mathbf{J}$ 是电流密度，$\\mathbf{B}$ 是磁场。问题指定了一个磁静力学体系，其中电场可忽略不计，即 $\\mathbf{E} \\approx \\mathbf{0}$。在此条件下，洛伦兹力密度简化为其磁分量：\n$$\n\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}\n$$\n问题进一步指出，等离子体电流是稳恒的，这与磁静力学近似一致。在此体系下，麦克斯韦方程组得以简化。具体来说，磁静力学形式下的安培定律将电流密度与磁场联系起来：\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}\n$$\n其中 $\\mu_0$ 是真空磁导率。我们可以使用这个方程从力的表达式中消去电流密度 $\\mathbf{J}$，从而仅用磁场来表示力：\n$$\n\\mathbf{J} = \\frac{1}{\\mu_0} (\\nabla \\times \\mathbf{B})\n$$\n将此代入力密度方程，得到：\n$$\n\\mathbf{f} = \\frac{1}{\\mu_0} (\\nabla \\times \\mathbf{B}) \\times \\mathbf{B}\n$$\n问题要求找到一个对称应力张量 $\\mathbf{T}$，使其散度等于力密度，即 $\\mathbf{f} = \\nabla \\cdot \\mathbf{T}$。为了推导该张量的分量 $T_{ij}$，我们在笛卡尔坐标系下的指标表示法中进行。力密度的第 $i$ 个分量是：\n$$\nf_i = \\frac{1}{\\mu_0} [(\\nabla \\times \\mathbf{B}) \\times \\mathbf{B}]_i\n$$\n使用列维-奇维塔符号 $\\epsilon_{ijk}$ 来表示叉积，我们有：\n$$\nf_i = \\frac{1}{\\mu_0} \\epsilon_{ijk} (\\nabla \\times \\mathbf{B})_j B_k\n$$\n$\\mathbf{B}$ 的旋度的第 $j$ 个分量是 $(\\nabla \\times \\mathbf{B})_j = \\epsilon_{jl m} \\partial_l B_m$，其中 $\\partial_l$ 表示对第 $l$ 个坐标的偏导数。代入此式可得：\n$$\nf_i = \\frac{1}{\\mu_0} \\epsilon_{ijk} (\\epsilon_{jlm} \\partial_l B_m) B_k\n$$\n我们使用两个列维-奇维塔符号乘积的恒等式 $\\epsilon_{ijk}\\epsilon_{jlm} = \\epsilon_{kij}\\epsilon_{lmj} = \\delta_{kl}\\delta_{im} - \\delta_{km}\\delta_{il}$。注意，重复的指标 $j$ 表示求和。\n$$\nf_i = \\frac{1}{\\mu_0} (\\delta_{kl}\\delta_{im} - \\delta_{km}\\delta_{il}) (\\partial_l B_m) B_k\n$$\n通过应用克罗内克符号展开此表达式：\n$$\nf_i = \\frac{1}{\\mu_0} [(\\partial_k B_i) B_k - (\\partial_i B_k) B_k]\n$$\n这个表达式还不是张量散度的形式。我们必须对其进行变换，以便在前面得到一个单一的微分算子 $\\partial_j$。让我们分析每一项。\n对于第二项，我们可以使用导数的乘积法则：$B_k (\\partial_i B_k) = \\frac{1}{2}\\partial_i (B_k B_k) = \\frac{1}{2}\\partial_i (B^2)$，其中 $B^2 = \\mathbf{B} \\cdot \\mathbf{B} = B_k B_k$ 是磁场大小的平方。\n对于第一项，我们再次使用乘积法则：$B_k (\\partial_k B_i) = \\partial_k(B_k B_i) - (\\partial_k B_k)B_i$。麦克斯韦方程组的另一个方程是磁场高斯定律 $\\nabla \\cdot \\mathbf{B} = 0$，其指标表示法为 $\\partial_k B_k = 0$。因此，$(\\partial_k B_k)B_i$ 项为零，我们剩下 $B_k (\\partial_k B_i) = \\partial_k(B_k B_i)$。\n\n将这些修改后的项代回 $f_i$ 的表达式中：\n$$\nf_i = \\frac{1}{\\mu_0} [\\partial_k(B_k B_i) - \\frac{1}{2}\\partial_i(B^2)]\n$$\n为了将其表示为单个散度，我们使用克罗内克符号重写第二项：$\\partial_i(X) = \\delta_{ik} \\partial_k(X)$。\n$$\nf_i = \\frac{1}{\\mu_0} [\\partial_k(B_i B_k) - \\partial_k(\\frac{1}{2}\\delta_{ik} B^2)]\n$$\n在这里，我们将第一项的哑指标从 $k$ 重命名为 $j$，并将第二项的从 $i,k$ 重命名为 $i,j$。最好使用一个一致的哑指标，比如 $j$。\n$$\nf_i = \\frac{1}{\\mu_0} [\\partial_j(B_i B_j) - \\frac{1}{2}\\partial_i(B^2)] = \\frac{1}{\\mu_0} [\\partial_j(B_i B_j) - \\frac{1}{2}\\delta_{ij}\\partial_j(B^2)]\n$$\n现在我们可以将微分算子 $\\partial_j$ 提取出来：\n$$\nf_i = \\partial_j \\left[ \\frac{1}{\\mu_0} \\left( B_i B_j - \\frac{1}{2} \\delta_{ij} B^2 \\right) \\right]\n$$\n这是 $f_i = \\partial_j T_{ji}$ 的形式。因此，平衡洛伦兹力的应力张量是：\n$$\nT_{ij} = \\frac{1}{\\mu_0} \\left( B_i B_j - \\frac{1}{2} \\delta_{ij} B^2 \\right)\n$$\n这个张量是对称的 ($T_{ij} = T_{ji}$)。这是完整的麦克斯韦应力张量的磁场部分。\n\n接下来，我们计算这个张量的迹 $T_{kk}$，也就是其对角元素之和。我们使用爱因斯坦求和约定，其中重复的指标意味着对空间维度求和 ($k=1, 2, 3$)。\n$$\n\\mathrm{Tr}(\\mathbf{T}) = T_{kk} = \\sum_{k=1}^{3} T_{kk} = \\sum_{k=1}^{3} \\frac{1}{\\mu_0} \\left( B_k B_k - \\frac{1}{2} \\delta_{kk} B^2 \\right)\n$$\n让我们计算每一项的和。\n求和中的第一项是 $\\sum_{k=1}^{3} B_k B_k = B_1^2 + B_2^2 + B_3^2 = B^2$。\n第二项涉及克罗内克符号的迹，$\\sum_{k=1}^{3} \\delta_{kk} = \\delta_{11} + \\delta_{22} + \\delta_{33} = 1 + 1 + 1 = 3$。\n将这些结果代回迹的表达式中：\n$$\nT_{kk} = \\frac{1}{\\mu_0} \\left( B^2 - \\frac{3}{2} B^2 \\right) = \\frac{1}{\\mu_0} \\left( B^2 - \\frac{3}{2} B^2 \\right) = \\frac{1}{\\mu_0} \\left( -\\frac{1}{2} B^2 \\right)\n$$\n因此，磁应力张量的迹为：\n$$\n\\mathrm{Tr}(\\mathbf{T}) = -\\frac{B^2}{2\\mu_0}\n$$\n\n最后，我们解释这个结果。\n量 $P_B = \\frac{B^2}{2\\mu_0}$ 是磁能量密度，其在数值上具有压强的单位（在国际单位制中为帕斯卡）。它被称为磁压强。应力张量的迹 $\\mathrm{Tr}(\\mathbf{T})$ 表示作用在沿坐标轴方向的表面上的正应力（单位面积上的力）之和。一个正的正应力 ($T_{ii} > 0$) 对应于张力，而一个负的正应力 ($T_{ii} < 0$) 对应于压力。\n我们的结果 $\\mathrm{Tr}(\\mathbf{T}) = -P_B$ 表明，迹是负的，且其大小等于磁压强。磁场沿磁力线方向施加大小为 $P_B$ 的张力，并在所有垂直于磁力线的方向上施加大小相等的压力 $P_B$。迹是这些效应的总和：一个张力 ($+P_B$) 和两个压力 ($-P_B - P_B$)，得到的净值为 $-P_B$。负号表示磁场正应力的总体效应是压缩性的（像压力一样）。\n\n这个结果中没有电场的贡献是初始问题设定的直接后果。问题将背景定义为磁静力学体系，其中电场 $\\mathbf{E}$ 可忽略不计。完整的麦克斯韦应力张量包括与电场相关的项：$T_{ij}^{\\text{full}} = \\epsilon_0 (E_i E_j - \\frac{1}{2}\\delta_{ij}E^2) + \\frac{1}{\\mu_0} (B_i B_j - \\frac{1}{2}\\delta_{ij}B^2)$。由于我们从 $\\mathbf{E} = \\mathbf{0}$ 的前提开始，电场项恒等于零，因此推导过程自然只产生应力张量的磁分量。洛伦兹力本身简化为 $\\mathbf{J} \\times \\mathbf{B}$，从推导的第一步就消除了对 $\\mathbf{E}$ 的任何依赖。",
            "answer": "$$\n\\boxed{-\\frac{B^2}{2 \\mu_{0}}}\n$$"
        },
        {
            "introduction": "理论和分析推导为我们提供了坚实的基础，但计算聚变科学的最终目标是解决实际的工程问题。本练习将理论付诸实践，要求通过两种等效的方法——体积积分洛伦兹力密度和面积分麦克斯韦应力张量——来计算作用在导体上的电磁力。 通过数值实现这两种方法并比较其结果，我们不仅可以验证电磁理论的自洽性，还能深入理解在开发和验证计算代码时，这两种力计算方法的优缺点和数值差异。",
            "id": "4009111",
            "problem": "一段长为 $L$、半径为 $a$ 的直圆柱形载流导体段，在真空中与 $\\hat{z}$ 轴对齐。它在 $+\\hat{z}$ 方向上传导均匀的总电流 $I$，对应于导体内部的均匀电流密度 $\\mathbf{J}=J_z\\,\\hat{z}$。一个外部施加的、空间均匀的磁场 $\\mathbf{B}_0=B_0\\,\\hat{x}$ 弥漫于整个空间。假设为静磁学情况，电场为零，且没有磁性材料。真空磁导率为 $\\mu_0$。\n\n您的任务是使用两种等效的公式计算作用在导体段上的净电磁力，并比较它们的数值一致性：\n\n1. 基于真空 Maxwell 应力张量的表面通量公式。用一个半径为 $r_s$（其中 $r_s>a$）、长度为 $L$ 的同轴圆柱面包裹导体，并对侧面进行面积分 $\\oint \\mathbf{T}\\cdot\\mathbf{n}\\, dS$ 的数值计算，以获得合力矢量。使用与真空中静磁学一致的场：总磁场是施加的均匀场和长直电流的方位角自生磁场的叠加，侧面上的单位法向量是径向的。角度必须以弧度为单位处理。在此配置中，包围圆柱体的两个端盖对力的 $y$ 分量没有贡献，因此对于该分量可以忽略不计。力必须以 $\\mathrm{N}$（牛顿）为单位计算。\n\n2. 基于 Lorentz 力密度的体积分公式。在导体的体积上使用柱坐标对 $\\int \\mathbf{J}\\times\\mathbf{B}\\, dV$ 进行数值积分，其中导体内部的磁场是施加的均匀场和根据 Ampère 定律得出的均匀载流圆形截面的方位角自生磁场的叠加。角度必须以弧度为单位处理。力必须以 $\\mathrm{N}$（牛顿）为单位计算。\n\n从适用于真空中静磁学的基本定律出发：静磁学中的 Maxwell 方程组和电磁场的动量守恒定律。从这些定律出发，构建真空 Maxwell 应力张量和相关的自生磁场表达式。除了这些基础知识外，不要假设任何快捷公式。\n\n通过用均匀网格离散化相应的表面和体积来实现这两种数值计算。使用以下参数测试套件；所有角度单位为弧度，长度单位为 $\\mathrm{m}$，电流单位为 $\\mathrm{A}$，磁通量密度单位为 $\\mathrm{T}$：\n\n- 测试用例 1：$I=1000$，$B_0=0.5$，$a=0.02$，$L=0.5$，$r_s=0.05$，$N_\\phi^{\\text{surf}}=200$，$N_z^{\\text{surf}}=200$，$N_r^{\\text{vol}}=100$，$N_\\phi^{\\text{vol}}=200$。\n- 测试用例 2 (粗略离散化)：$I=1000$，$B_0=0.5$，$a=0.02$，$L=0.5$，$r_s=0.05$，$N_\\phi^{\\text{surf}}=20$，$N_z^{\\text{surf}}=20$，$N_r^{\\text{vol}}=20$，$N_\\phi^{\\text{vol}}=20$。\n- 测试用例 3 (近表面场峰值)：$I=2000$，$B_0=1.2$，$a=0.05$，$L=0.2$，$r_s=0.051$，$N_\\phi^{\\text{surf}}=400$，$N_z^{\\text{surf}}=100$，$N_r^{\\text{vol}}=100$，$N_\\phi^{\\text{vol}}=400$。\n- 测试用例 4 (长段)：$I=500$，$B_0=0.8$，$a=0.01$，$L=2.0$，$r_s=0.04$，$N_\\phi^{\\text{surf}}=150$，$N_z^{\\text{surf}}=300$，$N_r^{\\text{vol}}=80$，$N_\\phi^{\\text{vol}}=150$。\n\n对于每个测试用例，计算：\n\n- 通过表面通量法计算出的合力的 $y$ 分量，单位为 $\\mathrm{N}$。\n- 通过体积分法计算出的合力的 $y$ 分量，单位为 $\\mathrm{N}$。\n- 解析参考值大小 $F_{\\text{ref}}=I\\,L\\,B_0$，单位为 $\\mathrm{N}$，该值在所述假设下由第一性原理导出。\n\n然后，为每个测试用例报告三个无量纲浮点数：\n\n- 两种数值方法之间的相对差异：$\\left|\\;F_y^{\\text{surf}}-F_y^{\\text{vol}}\\;\\right|/\\left|F_{\\text{ref}}\\right|$。\n- 表面通量结果与解析参考值之间的相对误差：$\\left|\\;F_y^{\\text{surf}}-F_{\\text{ref}}\\;\\right|/\\left|F_{\\text{ref}}\\right|$。\n- 体积分结果与解析参考值之间的相对误差：$\\left|\\;F_y^{\\text{vol}}-F_{\\text{ref}}\\;\\right|/\\left|F_{\\text{ref}}\\right|$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个按上述顺序排列的包含三个浮点数的列表。例如，最终输出必须类似于 $[\\,[x_1,y_1,z_1],\\,[x_2,y_2,z_2],\\,[x_3,y_3,z_3],\\,[x_4,y_4,z_4]\\,]$，其中每个 $x_i$、$y_i$、$z_i$ 都是一个浮点数。",
            "solution": "用户提供了一个在尝试求解前需要进行严格验证的问题。\n\n### 步骤 1：提取已知条件\n- **系统**：一段长为 $L$、半径为 $a$ 的直圆柱形导体，在真空中与 $\\hat{z}$ 轴对齐。\n- **电流**：在 $+\\hat{z}$ 方向上的均匀总电流 $I$。\n- **电流密度**：对于 $r \\le a$，$\\mathbf{J} = J_z\\,\\hat{z}$，其中 $J_z = I/(\\pi a^2)$。\n- **外磁场**：均匀磁场 $\\mathbf{B}_0 = B_0\\,\\hat{x}$。\n- **物理**：静磁学假设，电场为零（$\\mathbf{E}=0$），无磁性材料。\n- **常数**：真空磁导率 $\\mu_0$。\n- **任务 1 (表面通量法)**：通过 $\\oint \\mathbf{T}\\cdot\\mathbf{n}\\, dS$ 计算合力 $\\mathbf{F}$。\n  - 积分表面：一个半径为 $r_s > a$、长度为 $L$ 的同轴圆柱面。\n  - 法向量：侧面上的单位法向量为 $\\mathbf{n} = \\hat{r}$。\n  - 简化：对于力的 $y$ 分量，可以忽略端盖的贡献。\n- **任务 2 (体积分法)**：通过 $\\int \\mathbf{J}\\times\\mathbf{B}\\, dV$ 计算合力 $\\mathbf{F}$。\n  - 积分体积：导体的体积（$r \\le a$，$z \\in [0, L]$）。\n- **总磁场**：$\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_{\\text{self}}$。\n- **离散化参数**：\n  - $N_\\phi^{\\text{surf}}$、$N_z^{\\text{surf}}$ 用于面积分。\n  - $N_r^{\\text{vol}}$、$N_\\phi^{\\text{vol}}$ 用于体积分（隐式地对横截面积分，结果乘以长度 $L$）。\n- **测试用例**：\n  - 用例 1：$I=1000$ A, $B_0=0.5$ T, $a=0.02$ m, $L=0.5$ m, $r_s=0.05$ m, $N_\\phi^{\\text{surf}}=200$, $N_z^{\\text{surf}}=200$, $N_r^{\\text{vol}}=100$, $N_\\phi^{\\text{vol}}=200$。\n  - 用例 2：$I=1000$ A, $B_0=0.5$ T, $a=0.02$ m, $L=0.5$ m, $r_s=0.05$ m, $N_\\phi^{\\text{surf}}=20$, $N_z^{\\text{surf}}=20$, $N_r^{\\text{vol}}=20$, $N_\\phi^{\\text{vol}}=20$。\n  - 用例 3：$I=2000$ A, $B_0=1.2$ T, $a=0.05$ m, $L=0.2$ m, $r_s=0.051$ m, $N_\\phi^{\\text{surf}}=400$, $N_z^{\\text{surf}}=100$, $N_r^{\\text{vol}}=100$, $N_\\phi^{\\text{vol}}=400$。\n  - 用例 4：$I=500$ A, $B_0=0.8$ T, $a=0.01$ m, $L=2.0$ m, $r_s=0.04$ m, $N_\\phi^{\\text{surf}}=150$, $N_z^{\\text{surf}}=300$, $N_r^{\\text{vol}}=80$, $N_\\phi^{\\text{vol}}=150$。\n- **输出**：对于每个用例，计算三个无量纲比率：\n  1. $\\left|\\;F_y^{\\text{surf}}-F_y^{\\text{vol}}\\;\\right|/\\left|F_{\\text{ref}}\\right|$\n  2. $\\left|\\;F_y^{\\text{surf}}-F_{\\text{ref}}\\;\\right|/\\left|F_{\\text{ref}}\\right|$\n  3. $\\left|\\;F_y^{\\text{vol}}-F_{\\text{ref}}\\;\\right|/\\left|F_{\\text{ref}}\\right|$\n  其中 $F_{\\text{ref}} = I\\,L\\,B_0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是静磁学中的一个标准练习，基于 Maxwell 方程组和 Lorentz 力定律。所有概念（Maxwell 应力张量、Lorentz 力密度、Ampère 定律）都是经典电磁学的基本内容。该设置在物理上是现实的。\n2.  **适定性**：该问题是适定（well-defined）的。几何形状、场和电流都已指定。任务是对明确定义的物理量进行数值积分。与解析结果的比较为正确性提供了明确的基准。预期会有一个唯一、稳定的解。\n3.  **客观性**：问题以精确、客观的数学和物理语言陈述。没有主观或基于意见的元素。\n4.  **完整性和一致性**：为每个测试用例提供了所有必要的参数（$I$、$B_0$、$L$、$a$、$r_s$）和离散化数（$N$）。边界条件（由“长直电流”模型隐含的无穷远处的场）和物理假设（静磁学、真空）清晰且一致。\n5.  **可行性**：参数值对于大电流应用（例如，聚变实验、工业磁体）在物理上是合理的。计算是数值密集型的，但可以使用标准编程环境处理。\n\n该问题具有科学有效性和适定性，是通过计算应用和验证电磁学基本原理的一个极佳范例。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 基于原理的求解推导\n\n分析始于在静磁真空环境中控制电磁力的基本定律。电磁场在体积 $V$ 内对电荷和电流载流子所施加的力由 Lorentz 力密度 $\\mathbf{f}$ 的积分给出：\n$$ \\mathbf{F}_{\\text{mech}} = \\int_V \\mathbf{f} \\, dV $$\n在给定情景中，没有净电荷 ($\\rho=0$) 且电场为零 ($\\mathbf{E}=0$)，因此力密度简化为作用在电流上的磁力：\n$$ \\mathbf{f} = \\mathbf{J} \\times \\mathbf{B} $$\n其中 $\\mathbf{J}$ 是电流密度，$\\mathbf{B}$ 是总磁场。这给出了力的第一种公式，即体积分法。\n\n第二种公式源于电磁场的动量守恒原理。在静态情况下，力密度与 Maxwell 应力张量 $\\mathbf{T}$ 的散度相平衡：\n$$ \\mathbf{f} + \\nabla \\cdot \\mathbf{T} = 0 $$\n将此方程在一个体积 $V$ 上积分并应用散度定理，得到：\n$$ \\int_V \\mathbf{f} \\, dV + \\int_V (\\nabla \\cdot \\mathbf{T}) \\, dV = 0 $$\n$$ \\mathbf{F}_{\\text{mech}} + \\oint_S (\\mathbf{T} \\cdot \\mathbf{n}) \\, dS = 0 $$\n其中 $S$ 是包围 $V$ 的表面，$\\mathbf{n}$ 是向外的单位法向量。这表明作用在 $V$ 内部物质上的机械力等于通过其表面 $S$ 离开该体积的动量通量：\n$$ \\mathbf{F}_{\\text{mech}} = -\\oint_S (\\mathbf{T} \\cdot \\mathbf{n}) \\, dS $$\n等一下，需要仔细处理符号。作用在物质上的力是 $\\mathbf{F}_{\\text{mech}} = \\int_V \\mathbf{f} dV$。一个封闭系统（物质+场）的总力为零。场对物质施加的力与物质对场施加的力大小相等，方向相反。量 $\\oint_S \\mathbf{T} \\cdot \\mathbf{n} \\, dS$ 表示场将动量带出体积 $V$ 的速率。在静态情况下，该动量通量必须与场对 $V$ 内部源施加的力相平衡。因此，作用在载流导体上的力可以正确地表示为：\n$$ \\mathbf{F}_{\\text{mech}} = \\oint_S \\mathbf{T} \\cdot \\mathbf{n} \\, dS $$\n这是表面通量公式的基础。对于真空中的静磁学，Maxwell 应力张量为：\n$$ T_{ij} = \\frac{1}{\\mu_0} \\left( B_i B_j - \\frac{1}{2} \\delta_{ij} B^2 \\right) \\quad \\text{或张量表示法} \\quad \\mathbf{T} = \\frac{1}{\\mu_0} \\left( \\mathbf{B} \\mathbf{B} - \\frac{1}{2} B^2 \\mathbf{I} \\right) $$\n其中 $\\mathbf{I}$ 是单位张量，$B^2 = \\mathbf{B} \\cdot \\mathbf{B}$。\n\n总磁场是外场和导线自生磁场的叠加：$\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_{\\text{self}}$。\n- 外场为 $\\mathbf{B}_0 = B_0 \\hat{x}$。\n- 自生磁场 $\\mathbf{B}_{\\text{self}}$ 可通过 Ampère 定律 $\\oint \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{encl}}$ 求得。根据对称性，$\\mathbf{B}_{\\text{self}}$ 是纯方位角的，即 $\\mathbf{B}_{\\text{self}} = B_{\\phi}(r)\\hat{\\phi}$。\n  - 对于 $r \\le a$：$I_{\\text{encl}} = J_z (\\pi r^2) = (I/\\pi a^2)(\\pi r^2) = I (r^2/a^2)$。因此，$B_{\\phi}(r) (2\\pi r) = \\mu_0 I (r^2/a^2)$，这给出 $\\mathbf{B}_{\\text{self}}(r) = \\frac{\\mu_0 I r}{2\\pi a^2} \\hat{\\phi}$。\n  - 对于 $r > a$：$I_{\\text{encl}} = I$。因此，$B_{\\phi}(r) (2\\pi r) = \\mu_0 I$，这给出 $\\mathbf{B}_{\\text{self}}(r) = \\frac{\\mu_0 I}{2\\pi r} \\hat{\\phi}$。\n\n### 1. 表面通量公式 ($F_y^{\\text{surf}}$)\n我们在半径为 $r_s > a$ 的圆柱面上积分。单位法向量为 $\\mathbf{n}=\\hat{r}$。面元为 $dS = r_s d\\phi dz$。力为 $\\mathbf{F} = \\int_0^L \\int_0^{2\\pi} (\\mathbf{T} \\cdot \\hat{r}) r_s d\\phi dz$。\n矢量 $\\mathbf{T} \\cdot \\hat{r}$ 在柱坐标系下的分量为 $\\frac{1}{\\mu_0}((B_r^2 - \\frac{1}{2}B^2)\\hat{r} + B_r B_{\\phi} \\hat{\\phi} + B_r B_z \\hat{z})$。\n在 $r=r_s$ 的表面上，总场为 $\\mathbf{B} = B_0 \\hat{x} + \\mathbf{B}_{\\text{self}}(r_s)$。在柱坐标系中（$\\hat{x} = \\cos\\phi\\,\\hat{r} - \\sin\\phi\\,\\hat{\\phi}$）：\n$$ \\mathbf{B}(r_s, \\phi) = (B_0 \\cos\\phi)\\hat{r} + \\left(\\frac{\\mu_0 I}{2\\pi r_s} - B_0 \\sin\\phi\\right)\\hat{\\phi} $$\n所以，$B_r = B_0 \\cos\\phi$，$B_\\phi = \\frac{\\mu_0 I}{2\\pi r_s} - B_0 \\sin\\phi$，$B_z = 0$。模的平方为 $B^2 = B_r^2 + B_\\phi^2 = B_0^2 + \\left(\\frac{\\mu_0 I}{2\\pi r_s}\\right)^2 - \\frac{\\mu_0 I B_0}{\\pi r_s}\\sin\\phi$。\n我们需要力的 $y$ 分量，$F_y = \\int (\\mathbf{F} \\cdot \\hat{y}) dS$。被积函数为 $(\\mathbf{T} \\cdot \\hat{r}) \\cdot \\hat{y}$。使用 $\\hat{r}\\cdot\\hat{y}=\\sin\\phi$ 和 $\\hat{\\phi}\\cdot\\hat{y}=\\cos\\phi$：\n$$ (\\mathbf{T} \\cdot \\hat{r}) \\cdot \\hat{y} = \\frac{1}{\\mu_0} \\left( (B_r^2 - \\frac{1}{2}B^2)\\sin\\phi + B_r B_{\\phi} \\cos\\phi \\right) $$\n代入场分量并化简（如解析草稿所示），这变为：\n$$ (\\mathbf{T} \\cdot \\hat{r}) \\cdot \\hat{y} = \\frac{1}{\\mu_0} \\left[ \\frac{\\mu_0 I B_0}{2\\pi r_s} - \\frac{1}{2} \\left( B_0^2 + \\left(\\frac{\\mu_0 I}{2\\pi r_s}\\right)^2 \\right)\\sin\\phi \\right] $$\n总力 $F_y^{\\text{surf}}$ 是该量在侧面积上的积分：\n$$ F_y^{\\text{surf}} = \\int_0^L dz \\int_0^{2\\pi} \\frac{1}{\\mu_0} \\left[ \\frac{\\mu_0 I B_0}{2\\pi r_s} - \\dots \\right] r_s d\\phi = L r_s \\int_0^{2\\pi} (\\dots) d\\phi $$\n$\\sin\\phi$ 项在 $[0, 2\\pi]$ 上的积分为零。常数项给出 $I L B_0$。\n对于数值计算，我们将积分离散化：\n$$ F_y^{\\text{surf}} \\approx L r_s \\sum_{j=1}^{N_\\phi^{\\text{surf}}} \\left[ \\frac{1}{\\mu_0} \\left( (B_r(\\phi_j)^2 - \\frac{1}{2}B(\\phi_j)^2)\\sin\\phi_j + B_r(\\phi_j) B_{\\phi}(\\phi_j) \\cos\\phi_j \\right) \\right] \\Delta\\phi $$\n其中 $\\phi_j$ 是角度段的中点，$\\Delta\\phi = 2\\pi/N_\\phi^{\\text{surf}}$。对 $z$ 的积分只是简单地乘以 $L$，因为被积函数与 $z$ 无关。\n\n### 2. 体积分公式 ($F_y^{\\text{vol}}$)\n我们在导体的体积（$r \\le a$）上对 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$ 进行积分。\n这里 $\\mathbf{J} = \\frac{I}{\\pi a^2}\\hat{z}$，内部的场为 $\\mathbf{B}(r, \\phi) = B_0\\hat{x} + \\mathbf{B}_{\\text{self}}(r)$（对于 $r \\le a$）：\n$$ \\mathbf{B}(r, \\phi) = (B_0 \\cos\\phi)\\hat{r} + \\left(\\frac{\\mu_0 I r}{2\\pi a^2} - B_0 \\sin\\phi\\right)\\hat{\\phi} $$\n力密度为 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B} = (\\frac{I}{\\pi a^2}\\hat{z}) \\times (B_r \\hat{r} + B_\\phi \\hat{\\phi}) = \\frac{I}{\\pi a^2} (B_r \\hat{\\phi} - B_\\phi \\hat{r})$。\n力密度的 $y$ 分量为 $f_y = \\mathbf{f} \\cdot \\hat{y} = \\frac{I}{\\pi a^2} (B_r \\cos\\phi - B_\\phi \\sin\\phi)$。代入场分量：\n$$ f_y(r, \\phi) = \\frac{I}{\\pi a^2} \\left[ (B_0 \\cos\\phi)\\cos\\phi - \\left(\\frac{\\mu_0 I r}{2\\pi a^2} - B_0 \\sin\\phi\\right)\\sin\\phi \\right] $$\n$$ f_y(r, \\phi) = \\frac{I}{\\pi a^2} \\left[ B_0(\\cos^2\\phi+\\sin^2\\phi) - \\frac{\\mu_0 I r}{2\\pi a^2}\\sin\\phi \\right] = \\frac{I}{\\pi a^2} \\left( B_0 - \\frac{\\mu_0 I r}{2\\pi a^2}\\sin\\phi \\right) $$\n总力 $F_y^{\\text{vol}}$ 是 $f_y$ 在导体体积 $V$ 上的积分，其中 $dV = r dr d\\phi dz$：\n$$ F_y^{\\text{vol}} = \\int_0^L dz \\int_0^{2\\pi} d\\phi \\int_0^a dr \\, r \\, f_y(r, \\phi) $$\n与 $\\sin\\phi$ 成正比的项积分为零，表示净自生力为零。剩余项给出了预期的结果 $I L B_0$。\n对于数值计算，我们将横截面积分进行离散化，并乘以 $L$：\n$$ F_y^{\\text{vol}} \\approx L \\sum_{j=1}^{N_r^{\\text{vol}}} \\sum_{k=1}^{N_\\phi^{\\text{vol}}} f_y(r_j, \\phi_k) \\, r_j \\Delta r \\Delta \\phi $$\n其中 $r_j, \\phi_k$ 是网格中点，$\\Delta r = a/N_r^{\\text{vol}}$，$\\Delta\\phi = 2\\pi/N_\\phi^{\\text{vol}}$。\n\n### 3. 解析参考值 ($F_{\\text{ref}}$)\n在均匀外磁场 $\\mathbf{B}_0$ 中，长度为 $L$、载有电流 $I$ 的直导线段所受的宏观 Lorentz 力由 $\\mathbf{F} = I (\\mathbf{L} \\times \\mathbf{B}_0)$ 给出。这里，矢量 $\\mathbf{L}$ 是 $L\\hat{z}$。\n$$ \\mathbf{F} = I (L\\hat{z} \\times B_0\\hat{x}) = I L B_0 (\\hat{z} \\times \\hat{x}) = I L B_0 \\hat{y} $$\n力的大小为 $F_{\\text{ref}} = I L B_0$。该力完全在 $+\\hat{y}$ 方向上。两种数值方法都预期会收敛到这个值。差异将由离散化误差和浮点运算引起。自生力部分，源于电流与其自身磁场的相互作用，对整个物体积分后为零，这是牛顿第三定律的结果。\n\n该实现将通过在离散化网格上进行数值求和来计算 $F_y^{\\text{surf}}$ 和 $F_y^{\\text{vol}}$，计算解析参考值 $F_{\\text{ref}}$，然后计算所需的相对差异和误差。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the electromagnetic force problem for all test cases.\n    \"\"\"\n    mu_0 = 4 * np.pi * 1e-7\n\n    test_cases = [\n        # (I, B0, a, L, rs, N_phi_surf, N_z_surf, N_r_vol, N_phi_vol)\n        (1000.0, 0.5, 0.02, 0.5, 0.05, 200, 200, 100, 200),\n        (1000.0, 0.5, 0.02, 0.5, 0.05, 20, 20, 20, 20),\n        (2000.0, 1.2, 0.05, 0.2, 0.051, 400, 100, 100, 400),\n        (500.0, 0.8, 0.01, 2.0, 0.04, 150, 300, 80, 150),\n    ]\n\n    results = []\n    for case in test_cases:\n        I, B0, a, L, rs, N_phi_surf, _, N_r_vol, N_phi_vol = case\n\n        # 1. Surface-Flux Method\n        # The integral over z is trivial as the integrand is z-independent.\n        dphi_surf = 2 * np.pi / N_phi_surf\n        phi_surf = (np.arange(N_phi_surf) + 0.5) * dphi_surf\n\n        # Field components on the integration surface r=rs\n        Br_s = B0 * np.cos(phi_surf)\n        Bphi_s = (mu_0 * I) / (2 * np.pi * rs) - B0 * np.sin(phi_surf)\n        B2_s = Br_s**2 + Bphi_s**2\n\n        # y-component of the force per unit area (T . n)_y\n        # (T . n)_y = (1/mu_0) * ((Br^2 - 0.5*B^2)*sin(phi) + Br*Bphi*cos(phi))\n        T_dot_n_y_values = (1 / mu_0) * (\n            (Br_s**2 - 0.5 * B2_s) * np.sin(phi_surf) + \n            (Br_s * Bphi_s) * np.cos(phi_surf)\n        )\n        Fy_surf = L * rs * np.sum(T_dot_n_y_values) * dphi_surf\n\n        # 2. Volume-Integral Method\n        # The integral over z is trivial (multiplication by L).\n        # We perform a 2D integral over the cross-section.\n        dr_vol = a / N_r_vol\n        dphi_vol = 2 * np.pi / N_phi_vol\n\n        r_vol = (np.arange(N_r_vol) + 0.5) * dr_vol\n        phi_vol = (np.arange(N_phi_vol) + 0.5) * dphi_vol\n\n        r_grid, phi_grid = np.meshgrid(r_vol, phi_vol, indexing='ij')\n\n        # y-component of the force density f_y = Jz * (B_x)\n        # Bx = B0 - B_self_y = B0 - (B_self_phi * sin(phi))\n        # f_y = (I/(pi*a^2)) * ( B0 - (mu_0*I*r/(2*pi*a^2))*sin(phi) )\n        fy_grid = (I / (np.pi * a**2)) * (\n            B0 - (mu_0 * I * r_grid / (2 * np.pi * a**2)) * np.sin(phi_grid)\n        )\n        \n        # Differential area element in polar coordinates is r*dr*dphi\n        dA_grid = r_grid * dr_vol * dphi_vol\n        Fy_vol = L * np.sum(fy_grid * dA_grid)\n        \n        # 3. Analytic Reference\n        F_ref = I * L * B0\n        \n        # Avoid division by zero if F_ref is zero\n        if np.abs(F_ref)  1e-12:\n            F_ref_safe = 1.0\n        else:\n            F_ref_safe = F_ref\n\n        # 4. Ratios\n        rel_diff = np.abs(Fy_surf - Fy_vol) / np.abs(F_ref_safe)\n        rel_err_surf = np.abs(Fy_surf - F_ref) / np.abs(F_ref_safe)\n        rel_err_vol = np.abs(Fy_vol - F_ref) / np.abs(F_ref_safe)\n\n        results.append([rel_diff, rel_err_surf, rel_err_vol])\n\n    # Format the final output string as [[r1,r2,r3],[...],...]\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}