{
    "hands_on_practices": [
        {
            "introduction": "The resistive MHD model is defined by the inclusion of the term $\\eta \\mathbf{J}$ in the generalized Ohm's law, but what is the physical origin of the resistivity $\\eta$? This practice connects the macroscopic fluid model to the underlying microphysics of the plasma . By deriving the famous Spitzer resistivity from the principles of electron-ion Coulomb collisions, you will gain a first-principles understanding of how plasma temperature and charge state determine this crucial transport coefficient and why its value varies dramatically between the hot core and cooler edge of a fusion device.",
            "id": "4039149",
            "problem": "In Resistive Magnetohydrodynamics (MHD), the collisional electrical resistivity that enters the generalized Ohm’s law arises from electron momentum loss to ions via Coulomb collisions. Starting from a first-principles base, do the following:\n\n- Begin with the electron momentum balance, relate the frictional force density to a collision frequency, and define the resistivity as the proportionality between the electric field and the current density in the collisional limit of the generalized Ohm’s law.\n- Using the small-angle Coulomb collision theory in the weakly coupled, fully ionized plasma limit, derive the electron-ion collision frequency and show how it sets the resistivity’s temperature scaling. Explicitly connect the scaling to the ion charge state and the Coulomb logarithm.\n- Carefully carry the derivation in the International System of Units (SI), expressing the final resistivity as a closed-form analytic expression in terms of the electron charge $e$, electron mass $m_e$, vacuum permittivity $\\varepsilon_0$, Boltzmann constant $k_B$, the electron temperature $T_e$ (in $\\mathrm{eV}$), the effective charge number $Z$, and the Coulomb logarithm $\\ln\\Lambda$.\n\nThen, evaluate the magnitude of the resistivity for two scientifically realistic tokamak conditions:\n\n- Core: $T_e = 12\\,\\mathrm{keV}$, $Z = 1.7$, $\\ln\\Lambda = 17.5$.\n- Edge: $T_e = 150\\,\\mathrm{eV}$, $Z = 3.5$, $\\ln\\Lambda = 15.0$.\n\nAssume quasi-neutrality and full ionization. Use the following physical constants in SI units: $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$, $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}$, $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$. Express the final numerical resistivities in $\\Omega\\cdot\\mathrm{m}$. Round each numerical value to four significant figures. Return the final answer as the two numbers for core and edge, respectively, arranged as a single row matrix.",
            "solution": "The problem statement is a valid scientific exercise in plasma physics. It requests the derivation of the collisional electrical resistivity from first principles and its evaluation for realistic fusion plasma parameters.\n\n### Step 1: Extract Givens\n- **Task**: Derive the expression for electrical resistivity $\\eta$ in resistive MHD.\n- **Starting Point**: Electron momentum balance.\n- **Methodology**: Relate frictional force to collision frequency, define $\\eta$ via Ohm's law, use small-angle Coulomb collision theory for a weakly coupled, fully ionized plasma.\n- **Units**: International System of Units (SI).\n- **Final Expression Variables**: Electron charge $e$, electron mass $m_e$, vacuum permittivity $\\varepsilon_0$, Boltzmann constant $k_B$, electron temperature in eV $T_e$, effective charge number $Z$, and Coulomb logarithm $\\ln\\Lambda$.\n- **Assumptions**: Quasi-neutrality ($n_e = Z n_i$), full ionization.\n- **Condition 1 (Core)**: $T_e = 12\\,\\mathrm{keV}$, $Z = 1.7$, $\\ln\\Lambda = 17.5$.\n- **Condition 2 (Edge)**: $T_e = 150\\,\\mathrm{eV}$, $Z = 3.5$, $\\ln\\Lambda = 15.0$.\n- **Physical Constants (SI units)**:\n  - $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n  - $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$\n  - $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}$\n  - $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$\n- **Output Requirement**: Numerical values for $\\eta_{core}$ and $\\eta_{edge}$ in $\\Omega\\cdot\\mathrm{m}$, rounded to four significant figures, presented as a row matrix.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: The derivation of Spitzer resistivity is a canonical topic in plasma physics, based on classical electromagnetism and statistical mechanics. The problem is firmly rooted in established principles.\n- **Well-Posedness**: The request is for a standard derivation followed by a direct calculation. All necessary constants and parameters are provided. The assumptions are clearly stated. A unique solution exists.\n- **Objectivity**: The language is precise and unbiased. The parameters for the tokamak core and edge are scientifically realistic.\n- **Completeness**: The problem provides all necessary information for the derivation and calculations.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of Electrical Resistivity\n\nThe electrical resistivity $\\eta$ in a plasma quantifies the opposition to the flow of electric current. It arises primarily from the momentum lost by charge-carrying electrons in collisions with ions.\n\n**1. Resistivity from Electron Momentum Balance (Generalized Ohm's Law)**\n\nThe motion of the electron fluid is described by the electron momentum balance equation:\n$$ m_e n_e \\left( \\frac{\\partial \\mathbf{v}_e}{\\partial t} + \\mathbf{v}_e \\cdot \\nabla \\mathbf{v}_e \\right) = -n_e e (\\mathbf{E} + \\mathbf{v}_e \\times \\mathbf{B}) - \\nabla p_e + \\mathbf{R}_{ei} $$\nwhere $m_e$ is the electron mass, $n_e$ is the electron number density, $\\mathbf{v}_e$ is the electron fluid velocity, $e$ is the elementary charge, $\\mathbf{E}$ is the electric field, $\\mathbf{B}$ is the magnetic field, $p_e$ is the electron pressure, and $\\mathbf{R}_{ei}$ is the frictional force density on the electrons due to collisions with ions.\n\nIn the collisional limit for a steady state ($\\frac{\\partial}{\\partial t} = 0$) and uniform plasma ($\\nabla = 0$), neglecting the Lorentz force and pressure gradient terms (which is exact for the component parallel to $\\mathbf{B}$ or in an unmagnetized plasma), the equation simplifies to a balance between the electric force and the collisional friction:\n$$ 0 = -n_e e \\mathbf{E} + \\mathbf{R}_{ei} $$\nThe frictional force density $\\mathbf{R}_{ei}$ is proportional to the mean momentum lost per electron per unit time. This is modeled as:\n$$ \\mathbf{R}_{ei} = n_e m_e \\nu_{ei} (\\mathbf{v}_i - \\mathbf{v}_e) $$\nwhere $\\nu_{ei}$ is the momentum-transfer electron-ion collision frequency and $\\mathbf{v}_i$ is the ion fluid velocity.\n\nThe electric current density $\\mathbf{j}$ is defined as $\\mathbf{j} = q_i n_i \\mathbf{v}_i + q_e n_e \\mathbf{v}_e = Z e n_i \\mathbf{v}_i - e n_e \\mathbf{v}_e$. Using the quasi-neutrality condition $n_e = Z n_i$ and assuming stationary ions ($\\mathbf{v}_i \\approx 0$) as is typical for electron-driven currents, we have $\\mathbf{j} \\approx -n_e e \\mathbf{v}_e$. Also, $(\\mathbf{v}_i - \\mathbf{v}_e) \\approx -\\mathbf{v}_e = \\frac{\\mathbf{j}}{n_e e}$.\n\nSubstituting these relations into the force balance equation:\n$$ n_e e \\mathbf{E} = \\mathbf{R}_{ei} = n_e m_e \\nu_{ei} \\left( \\frac{\\mathbf{j}}{n_e e} \\right) = \\frac{m_e \\nu_{ei}}{e} \\mathbf{j} $$\nRearranging for $\\mathbf{E}$ yields the simple Ohm's law:\n$$ \\mathbf{E} = \\left( \\frac{m_e \\nu_{ei}}{n_e e^2} \\right) \\mathbf{j} $$\nBy definition, the resistivity $\\eta$ is the proportionality constant in $\\mathbf{E} = \\eta \\mathbf{j}$. Thus, we have:\n$$ \\eta = \\frac{m_e \\nu_{ei}}{n_e e^2} $$\nThis expression connects the macroscopic resistivity to the microscopic collision frequency $\\nu_{ei}$.\n\n**2. Electron-Ion Collision Frequency**\n\nThe electron-ion momentum transfer collision frequency, $\\nu_{ei}$, is derived from considering the cumulative effect of many small-angle Coulomb scatterings. A detailed kinetic theory calculation (averaging over Maxwellian distributions for both electrons and ions) gives the standard Braginskii/Spitzer result:\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{n_i Z^2 e^4 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} $$\nwhere $k_B$ is the Boltzmann constant, $T_e$ is the electron temperature in Kelvin, and $\\ln\\Lambda$ is the Coulomb logarithm, which accounts for the range of impact parameters in the screened Coulomb potential. Using the quasi-neutrality condition $n_e = Z n_i$, we can write $n_i = n_e/Z$:\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{(n_e/Z) Z^2 e^4 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} = \\frac{4 \\sqrt{2\\pi} n_e Z e^4 \\ln\\Lambda}{3 (4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} $$\n\n**3. Final Expression for Resistivity**\n\nSubstituting the expression for $\\nu_{ei}$ into the formula for $\\eta$:\n$$ \\eta = \\frac{m_e}{n_e e^2} \\left[ \\frac{4 \\sqrt{2\\pi} n_e Z e^4 \\ln\\Lambda}{3 (4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} \\right] $$\nThe electron density $n_e$ cancels out, demonstrating that resistivity is an intrinsic property of the plasma, independent of density.\n$$ \\eta = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{\\sqrt{m_e} Z e^2 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2}} $$\nThis is the celebrated Spitzer resistivity (in the Lorentz gas approximation, which is accurate for large $Z$). It clearly shows the dependencies: $\\eta \\propto Z \\ln\\Lambda T_e^{-3/2}$.\n\nTo express this in terms of $T_e$ in electron-volts ($T_{e,eV}$), we use the relation $k_B T_e(\\mathrm{K}) = e T_{e,eV}$.\n$$ \\eta = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{\\sqrt{m_e} Z e^2 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 (e T_{e,eV})^{3/2}} = \\frac{4 \\sqrt{2\\pi}}{3 \\cdot 16\\pi^2} \\frac{\\sqrt{m_e} Z e^2 \\ln\\Lambda}{\\varepsilon_0^2 e^{3/2} T_{e,eV}^{3/2}} $$\nSimplifying the constants gives the requested closed-form analytic expression:\n$$ \\eta = \\frac{\\sqrt{2}}{12 \\pi^{3/2}} \\frac{\\sqrt{m_e} e^{1/2} Z \\ln\\Lambda}{\\varepsilon_0^2 T_{e,eV}^{3/2}} $$\n\n### Numerical Evaluation\n\nWe first evaluate the constant prefactor $C_0$:\n$$ C_0 = \\frac{\\sqrt{2m_e} e^{1/2}}{12 \\pi^{3/2} \\varepsilon_0^2} $$\nUsing the provided physical constants:\n$C_0 = \\frac{\\sqrt{2 \\cdot (9.1093837015\\times 10^{-31})} \\sqrt{1.602176634\\times 10^{-19}}}{12 \\pi^{3/2} (8.8541878128\\times 10^{-12})^2}$\n$C_0 \\approx \\frac{\\sqrt{1.82187674\\times 10^{-30}} \\cdot (4.0027199 \\times 10^{-10})}{12 \\cdot (5.568328) \\cdot (7.8396676 \\times 10^{-23})}$\n$C_0 \\approx \\frac{(1.34976915 \\times 10^{-15}) \\cdot (4.0027199 \\times 10^{-10})}{5.2410313 \\times 10^{-21}}$\n$C_0 \\approx 1.03091 \\times 10^{-4} \\, \\frac{\\Omega\\cdot\\mathrm{m}\\cdot(\\mathrm{eV})^{3/2}}{\\mathrm{unitless}}$\nThus, our working formula is:\n$$ \\eta \\approx (1.03091 \\times 10^{-4}) \\frac{Z \\ln\\Lambda}{T_{e,eV}^{3/2}} \\, \\Omega\\cdot\\mathrm{m} $$\n\n**Tokamak Core Condition:**\n- $T_e = 12\\,\\mathrm{keV} = 1.2 \\times 10^4\\,\\mathrm{eV}$\n- $Z = 1.7$\n- $\\ln\\Lambda = 17.5$\n\n$$ \\eta_{core} = (1.03091 \\times 10^{-4}) \\frac{1.7 \\times 17.5}{(1.2 \\times 10^4)^{3/2}} $$\n$$ \\eta_{core} = (1.03091 \\times 10^{-4}) \\frac{29.75}{1314534.5} \\approx 2.33314 \\times 10^{-9} \\, \\Omega\\cdot\\mathrm{m} $$\nRounding to four significant figures, $\\eta_{core} = 2.333 \\times 10^{-9} \\, \\Omega\\cdot\\mathrm{m}$.\n\n**Tokamak Edge Condition:**\n- $T_e = 150\\,\\mathrm{eV}$\n- $Z = 3.5$\n- $\\ln\\Lambda = 15.0$\n\n$$ \\eta_{edge} = (1.03091 \\times 10^{-4}) \\frac{3.5 \\times 15.0}{150^{3/2}} $$\n$$ \\eta_{edge} = (1.03091 \\times 10^{-4}) \\frac{52.5}{1837.117} \\approx 2.94605 \\times 10^{-6} \\, \\Omega\\cdot\\mathrm{m} $$\nRounding to four significant figures, $\\eta_{edge} = 2.946 \\times 10^{-6} \\, \\Omega\\cdot\\mathrm{m}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.333 \\times 10^{-9}  2.946 \\times 10^{-6} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While often small in hot fusion plasmas, resistivity enables one of the most important processes in MHD: magnetic reconnection. In ideal MHD where $\\eta=0$, magnetic topology is frozen, but finite resistivity allows field lines to break and reconfigure, releasing enormous amounts of magnetic energy. This exercise guides you through the derivation of the classic Sweet-Parker model of reconnection and applies it to the problem of sawtooth crashes in tokamaks . By comparing the theoretical timescale with experimental observations, you will confront a famous discrepancy that highlights the limitations of the simple resistive model and motivates the study of \"anomalous\" resistivity and more complex reconnection physics.",
            "id": "4039208",
            "problem": "Consider a cylindrical tokamak core approximated locally by a two-dimensional current sheet undergoing magnetic reconnection described by resistive magnetohydrodynamics (MHD). Use the following core plasma parameters, representative of the safety factor $q=1$ surface:\n\n- Magnetic field magnitude $B = 3.0\\,\\mathrm{T}$.\n- Electron density $n_{e} = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$.\n- Electron temperature $T_{e} = 1.5\\,\\mathrm{keV}$.\n- Ion species is deuterium with ion mass $m_{i} = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$ and charge number $Z=1$.\n- Current sheet half-length (characteristic reconnecting scale) $L = 1.0\\,\\mathrm{m}$.\n- Coulomb logarithm $\\ln\\Lambda = 17$ (typical for core conditions).\n\nObserved sawtooth crash durations in modern tokamaks are of order $\\tau_{\\mathrm{obs}} = 1.0\\,\\mathrm{ms}$.\n\nStarting from the resistive MHD induction equation and Ohm's law, and using mass conservation and Ampère's law to obtain the Sweet–Parker scaling, derive the reconnection inflow speed $v_{\\mathrm{in}}$ and the corresponding reconnection timescale $\\tau_{\\mathrm{SP}}$ in terms of the Alfvén speed $V_{A}$, the magnetic permeability $\\mu_{0}$, and the electrical resistivity $\\eta$. Compute the Alfvén speed $V_{A}$ from the given $B$, $n_{e}$, and $m_{i}$ by treating the mass density as $\\rho = m_{i} n_{i}$ with quasineutrality $n_{i} = n_{e}$. Estimate the classical (Spitzer) resistivity $\\eta_{\\mathrm{Sp}}$ from $T_{e}$ and $\\ln\\Lambda$ using the standard parallel conductivity for a fully ionized plasma,\n$$\\sigma_{\\parallel} \\approx \\frac{1.96 \\times 10^{4}\\,T_{e}^{3/2}}{Z\\,\\ln\\Lambda}\\ \\mathrm{S/m},$$\nwith $T_{e}$ expressed in $\\mathrm{eV}$, and $\\eta_{\\mathrm{Sp}} = 1/\\sigma_{\\parallel}$. Compare the resulting Sweet–Parker reconnection timescale $\\tau_{\\mathrm{SP}}$ for $\\eta_{\\mathrm{Sp}}$ to $\\tau_{\\mathrm{obs}}$ and, by inverting the Sweet–Parker scaling, determine the value of the effective resistivity $\\eta_{\\mathrm{req}}$ required to make $\\tau_{\\mathrm{SP}}$ equal to $\\tau_{\\mathrm{obs}}$.\n\nRound your final answer for $\\eta_{\\mathrm{req}}$ to three significant figures. Express the final answer in $\\mathrm{\\Omega\\cdot m}$. All steps must be derived from first principles of resistive MHD and basic plasma definitions; do not assume any reconnection-rate formula without derivation.",
            "solution": "The problem requires the derivation of the Sweet–Parker reconnection timescale, its calculation using classical plasma parameters, and finally the determination of an effective resistivity that would explain the observed reconnection timescale in a tokamak.\n\nFirst, we derive the Sweet–Parker scaling. The model considers a steady-state ($\\frac{\\partial}{\\partial t} = 0$) two-dimensional magnetic reconnection process in a current sheet of half-length $L$ and half-width $\\delta$. We begin with the resistive MHD Ohm's law:\n$$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{j} $$\nIn steady-state, Faraday's law $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$ implies $\\nabla \\times \\mathbf{E} = 0$, which in this 2D geometry means there is a uniform reconnection electric field, let's call it $E_z$, pointing out of the plane.\n\nIn the \"ideal\" inflow region, far from the current sheet, the resistivity $\\eta$ is negligible. The plasma flows in with a speed $v_{\\mathrm{in}}$ and the magnetic field has a magnitude $B$. Ohm's law simplifies to $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\approx 0$. The magnitude of the reconnection electric field is thus set by the inflow conditions:\n$$ E_z \\approx v_{\\mathrm{in}} B $$\nAt the center of the resistive layer (the X-point), the magnetic field and the plasma velocity are ideally zero, so the $\\mathbf{v} \\times \\mathbf{B}$ term vanishes. Here, Ohm's law gives:\n$$ E_z = \\eta j_z $$\nwhere $j_z$ is the current density in the sheet. Equating the two expressions for $E_z$ gives the fundamental relation for the reconnection rate:\n$$ v_{\\mathrm{in}} B = \\eta j_z $$\nUsing Ampère's law, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{j}$, we can estimate the current density. The magnetic field reverses over the width of the sheet ($2\\delta$), so the curl can be approximated as $|\\nabla \\times \\mathbf{B}| \\sim \\frac{B}{\\delta}$. This gives a current density of $j_z \\sim \\frac{B}{\\mu_0 \\delta}$. Substituting this into our reconnection relation:\n$$ v_{\\mathrm{in}} B \\approx \\eta \\frac{B}{\\mu_0 \\delta} \\implies v_{\\mathrm{in}} \\approx \\frac{\\eta}{\\mu_0 \\delta} $$\nNext, we invoke mass conservation. Assuming an incompressible plasma ($\\nabla \\cdot \\mathbf{v} = 0$), the mass flux entering the reconnection region must equal the mass flux exiting it. Plasma enters through an area $2L \\times 1$ (length $1$ in the z-direction) and exits through an area $2\\delta \\times 1$. This gives:\n$$ \\rho v_{\\mathrm{in}} (2L) = \\rho v_{\\mathrm{out}} (2\\delta) \\implies v_{\\mathrm{in}} L = v_{\\mathrm{out}} \\delta $$\nFinally, we use momentum conservation. The magnetic pressure $P_m = \\frac{B^2}{2\\mu_0}$ in the inflow region is converted to the kinetic energy of the outflowing plasma jet, $\\frac{1}{2}\\rho v_{\\mathrm{out}}^2$.\n$$ \\frac{B^2}{2\\mu_0} \\approx \\frac{1}{2}\\rho v_{\\mathrm{out}}^2 \\implies v_{\\mathrm{out}} \\approx \\frac{B}{\\sqrt{\\mu_0 \\rho}} $$\nThis outflow speed is the Alfvén speed, $V_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$. So, $v_{\\mathrm{out}} \\approx V_A$.\n\nWe now have a system of three equations:\n1. $v_{\\mathrm{in}} \\approx \\frac{\\eta}{\\mu_0 \\delta}$\n2. $v_{\\mathrm{in}} L = v_{\\mathrm{out}} \\delta$\n3. $v_{\\mathrm{out}} \\approx V_A$\n\nFrom (2) and (3), we express $\\delta$ as $\\delta = \\frac{v_{\\mathrm{in}} L}{V_A}$. Substituting this into (1):\n$$ v_{\\mathrm{in}} \\approx \\frac{\\eta}{\\mu_0} \\left( \\frac{V_A}{v_{\\mathrm{in}} L} \\right) = \\frac{\\eta V_A}{\\mu_0 L v_{\\mathrm{in}}} $$\n$$ v_{\\mathrm{in}}^2 \\approx \\frac{\\eta V_A}{\\mu_0 L} \\implies v_{\\mathrm{in}} \\approx \\sqrt{\\frac{\\eta V_A}{\\mu_0 L}} $$\nThe Sweet–Parker reconnection timescale, $\\tau_{\\mathrm{SP}}$, is the time it takes for plasma to be processed through the length of the sheet, $\\tau_{\\mathrm{SP}} = L / v_{\\mathrm{in}}$.\n$$ \\tau_{\\mathrm{SP}} = \\frac{L}{v_{\\mathrm{in}}} = L \\sqrt{\\frac{\\mu_0 L}{\\eta V_A}} = \\sqrt{\\frac{\\mu_0 L^3}{\\eta V_A}} $$\nThis completes the required derivation.\n\nNow, we compute the numerical values. The givens are:\n$B = 3.0\\,\\mathrm{T}$\n$n_{e} = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n$T_{e} = 1.5\\,\\mathrm{keV} = 1500\\,\\mathrm{eV}$\n$m_{i} = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$\n$Z = 1$\n$L = 1.0\\,\\mathrm{m}$\n$\\ln\\Lambda = 17$\n$\\tau_{\\mathrm{obs}} = 1.0\\,\\mathrm{ms} = 1.0 \\times 10^{-3}\\,\\mathrm{s}$\nThe magnetic permeability of free space is $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{T\\cdot m/A}$.\n\n1.  Calculate the mass density $\\rho$. With quasineutrality, $n_i = n_e = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$.\n    $$ \\rho = n_i m_i = (1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}) (3.345 \\times 10^{-27}\\,\\mathrm{kg}) = 3.345 \\times 10^{-7}\\,\\mathrm{kg/m^3} $$\n\n2.  Calculate the Alfvén speed $V_A$.\n    $$ V_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} = \\frac{3.0}{\\sqrt{(4\\pi \\times 10^{-7}) (3.345 \\times 10^{-7})}} = \\frac{3.0}{\\sqrt{4.2035 \\times 10^{-13}}} \\approx 4.6273 \\times 10^{6}\\,\\mathrm{m/s} $$\n\n3.  Calculate the classical Spitzer resistivity $\\eta_{\\mathrm{Sp}}$. First, we find the conductivity $\\sigma_{\\parallel}$.\n    $$ \\sigma_{\\parallel} = \\frac{1.96 \\times 10^{4} \\, T_{e}^{3/2}}{Z\\,\\ln\\Lambda} = \\frac{1.96 \\times 10^{4} \\, (1500)^{3/2}}{1 \\times 17} \\approx \\frac{1.96 \\times 10^{4} \\times 58095}{17} \\approx 6.698 \\times 10^{7}\\,\\mathrm{S/m} $$\n    The resistivity is the inverse of the conductivity:\n    $$ \\eta_{\\mathrm{Sp}} = \\frac{1}{\\sigma_{\\parallel}} \\approx \\frac{1}{6.698 \\times 10^{7}} \\approx 1.493 \\times 10^{-8}\\,\\mathrm{\\Omega\\cdot m} $$\n\n4.  Calculate the Sweet–Parker timescale $\\tau_{\\mathrm{SP}}$ using $\\eta_{\\mathrm{Sp}}$.\n    $$ \\tau_{\\mathrm{SP}} = \\sqrt{\\frac{\\mu_0 L^3}{\\eta_{\\mathrm{Sp}} V_A}} = \\sqrt{\\frac{(4\\pi \\times 10^{-7}) (1.0)^3}{(1.493 \\times 10^{-8}) (4.6273 \\times 10^{6})}} \\approx \\sqrt{\\frac{1.2566 \\times 10^{-6}}{0.06909}} \\approx \\sqrt{1.819 \\times 10^{-5}} \\approx 0.004265\\,\\mathrm{s} $$\n    This timescale is $\\approx 4.3\\,\\mathrm{ms}$. While much closer to the observed sawtooth crash time of $\\tau_{\\mathrm{obs}} = 1.0\\,\\mathrm{ms}$, it still shows a discrepancy, highlighting that classical Sweet-Parker theory is too slow and motivating the study of faster reconnection mechanisms.\n\n5.  Determine the required resistivity $\\eta_{\\mathrm{req}}$ to match the observed timescale. We set $\\tau_{\\mathrm{SP}} = \\tau_{\\mathrm{obs}}$ and solve the timescale equation for $\\eta = \\eta_{\\mathrm{req}}$.\n    $$ \\tau_{\\mathrm{obs}} = \\sqrt{\\frac{\\mu_0 L^3}{\\eta_{\\mathrm{req}} V_A}} $$\n    Squaring both sides and rearranging for $\\eta_{\\mathrm{req}}$:\n    $$ \\tau_{\\mathrm{obs}}^2 = \\frac{\\mu_0 L^3}{\\eta_{\\mathrm{req}} V_A} \\implies \\eta_{\\mathrm{req}} = \\frac{\\mu_0 L^3}{V_A \\tau_{\\mathrm{obs}}^2} $$\n    Now, substitute the numerical values:\n    $$ \\eta_{\\mathrm{req}} = \\frac{(4\\pi \\times 10^{-7}\\,\\mathrm{T\\cdot m/A}) (1.0\\,\\mathrm{m})^3}{(4.6273 \\times 10^{6}\\,\\mathrm{m/s}) (1.0 \\times 10^{-3}\\,\\mathrm{s})^2} = \\frac{4\\pi \\times 10^{-7}}{4.6273 \\times 10^{6} \\times 1.0 \\times 10^{-6}} = \\frac{4\\pi \\times 10^{-7}}{4.6273} $$\n    $$ \\eta_{\\mathrm{req}} \\approx 2.7163 \\times 10^{-7}\\,\\mathrm{\\Omega\\cdot m} $$\n\nRounding to three significant figures, the required effective resistivity is $2.72 \\times 10^{-7}\\,\\mathrm{\\Omega\\cdot m}$. This anomalously high resistivity suggests that non-MHD, possibly turbulent or two-fluid, effects are dominant in fast reconnection events like sawtooth crashes.",
            "answer": "$$\n\\boxed{2.72 \\times 10^{-7}}\n$$"
        },
        {
            "introduction": "Modeling resistive effects brings not only new physics but also new computational challenges. The inclusion of the resistive term introduces a diffusive character to the induction equation, which places a strict constraint on the time step size for explicit numerical solvers. This practice explores the practical consequences of the resistive term in a computational setting . By performing a von Neumann stability analysis and implementing a simple code, you will derive and verify the diffusive time step limit, $\\Delta t \\le C \\Delta x^2 / \\eta$, a fundamental stability criterion for the numerical simulation of any dissipative process.",
            "id": "4039209",
            "problem": "Consider the induction equation from Resistive Magnetohydrodynamics (MHD), specialized to a uniform, electrically conducting medium with constant magnetic diffusivity $\\eta$ (magnetic diffusivity is the electrical resistivity divided by the magnetic permeability, with units $\\mathrm{m^2/s}$). Starting from Maxwell–Faraday law and the generalized Ohm’s law, and assuming zero fluid velocity, show that the induction equation reduces to a diffusion equation for a single magnetic field component. Then, using a spatially second-order central difference approximation and a forward Euler explicit time integrator on a one-dimensional uniform grid with periodic boundary conditions, perform a von Neumann stability analysis and derive the stability bound for the timestep. Specifically, identify the constant $C$ in the standard diffusive timestep restriction of the form where the timestep scales like $\\Delta t \\sim \\Delta x^2/\\eta$ for stability.\n\nAfter completing the derivation, implement a program that integrates the resistive induction equation in one spatial dimension under the following constraints and specifications:\n\n- Fundamental base for derivation:\n  - Maxwell–Faraday law: $\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$.\n  - Generalized Ohm’s law (isotropic scalar resistivity): $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_e \\mathbf{J}$, with $\\mathbf{J} = \\nabla \\times \\mathbf{B} / \\mu_0$ and magnetic diffusivity $\\eta = \\eta_e / \\mu_0$.\n  - Divergence-free magnetic field: $\\nabla \\cdot \\mathbf{B} = 0$.\n- Numerical model:\n  - Reduce to one spatial dimension $x$ and a single magnetic field component $B(x,t)$ by taking zero velocity $\\mathbf{v}=\\mathbf{0}$ and constant magnetic diffusivity $\\eta$.\n  - The resulting partial differential equation is of diffusion type: $\\partial_t B = \\eta \\, \\partial_{xx} B$.\n  - Discretize space on a periodic domain of length $L$ using $N$ uniformly spaced points with spacing $\\Delta x = L/N$.\n  - Use a forward Euler explicit time integrator with a second-order central difference approximation for the Laplacian: $$B_i^{n+1} = B_i^n + \\eta \\, \\Delta t \\, \\frac{B_{i-1}^n - 2 B_i^n + B_{i+1}^n}{\\Delta x^2},$$ with periodic indexing for $B_{-1}^n$ and $B_{N}^n$.\n- Initial condition:\n  - Choose the highest-resolvable Fourier mode on the grid to probe the worst-case stability behavior: $B_i^0 = B_0 (-1)^i$ with $B_0 = 1$ in units of Tesla ($\\mathrm{T}$).\n- Units:\n  - Take $L$ in meters ($\\mathrm{m}$), $\\eta$ in $\\mathrm{m^2/s}$, $\\Delta t$ in seconds ($\\mathrm{s}$), and $B$ in Tesla ($\\mathrm{T}$).\n- Stability decision rule for the program:\n  - For each test case, integrate for the specified number of steps and compute the maximum absolute value of $B$ over the grid at the final time, $M_{\\text{final}}$.\n  - Define the case as “stable” (boolean true) if $M_{\\text{final}} \\le 10 \\, M_{\\text{initial}}$, where $M_{\\text{initial}}$ is the maximum absolute value at $t=0$. Otherwise, define it as “unstable” (boolean false).\n\nTest suite specification:\n- For each tuple in the test suite, the parameters are $(L, N, \\eta, r, n_{\\text{steps}})$, with $L$ in meters, $N$ an integer number of grid points, $\\eta$ in $\\mathrm{m^2/s}$, $r$ a dimensionless ratio used to set the timestep $\\Delta t = r \\, \\Delta x^2 / \\eta$, and $n_{\\text{steps}}$ the number of forward Euler steps to take.\n- Use the following test suite that covers a general case, the boundary of stability, and clearly unstable regimes, across different grid resolutions and diffusivities:\n  1. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 128, 1.0, 0.45, 500)$\n  2. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 128, 1.0, 0.50, 500)$\n  3. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 128, 1.0, 0.60, 60)$\n  4. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 16, 0.5, 0.55, 120)$\n  5. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 64, 2.0, 0.49, 400)$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets (e.g., “[True,False,True,False,True]”), corresponding to the five test cases in the order listed above.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of Magnetohydrodynamics (MHD) and numerical analysis, is well-posed with a clear objective, and contains all necessary information for a complete solution. The derivation path is logically sound, and the numerical task is precisely specified.\n\n### Part 1: Derivation of the Governing Equation\n\nThe derivation begins from the provided fundamental laws of resistive MHD in the absence of fluid flow.\n\n1.  **Given Equations**:\n    -   Maxwell-Faraday Law: $\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$\n    -   Generalized Ohm's Law: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_e \\mathbf{J}$\n    -   Current Density (from Ampere's Law): $\\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}$\n    -   Solenoidal condition: $\\nabla \\cdot \\mathbf{B} = 0$\n\n2.  **Simplification with Given Conditions**:\n    -   The problem states to assume zero fluid velocity, $\\mathbf{v} = \\mathbf{0}$. Ohm's law reduces to $\\mathbf{E} = \\eta_e \\mathbf{J}$.\n    -   Substituting the expression for current density $\\mathbf{J}$ into the simplified Ohm's law yields an expression for the electric field $\\mathbf{E}$ in terms of the magnetic field $\\mathbf{B}$:\n        $$ \\mathbf{E} = \\eta_e \\left( \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B} \\right) = \\frac{\\eta_e}{\\mu_0} (\\nabla \\times \\mathbf{B}) $$\n    -   The magnetic diffusivity $\\eta$ is defined as $\\eta = \\eta_e / \\mu_0$. Substituting this, we obtain:\n        $$ \\mathbf{E} = \\eta (\\nabla \\times \\mathbf{B}) $$\n\n3.  **Derivation of the Induction Equation**:\n    -   We substitute this expression for $\\mathbf{E}$ into the Maxwell-Faraday law:\n        $$ \\partial_t \\mathbf{B} = -\\nabla \\times \\left( \\eta (\\nabla \\times \\mathbf{B}) \\right) $$\n    -   Given that the magnetic diffusivity $\\eta$ is a constant scalar, it can be factored out of the curl operator:\n        $$ \\partial_t \\mathbf{B} = -\\eta \\nabla \\times (\\nabla \\times \\mathbf{B}) $$\n    -   We employ the vector calculus identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$, where $\\nabla^2$ is the vector Laplacian. Applying this to our equation gives:\n        $$ \\partial_t \\mathbf{B} = -\\eta \\left( \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B} \\right) $$\n    -   Using the divergence-free condition $\\nabla \\cdot \\mathbf{B} = 0$, the first term on the right-hand side vanishes:\n        $$ \\partial_t \\mathbf{B} = -\\eta (0 - \\nabla^2 \\mathbf{B}) = \\eta \\nabla^2 \\mathbf{B} $$\n    -   This is the magnetic induction equation, which takes the form of a vector diffusion equation. For a one-dimensional system varying only in the $x$-direction, considering a single component $B(x,t)$, this equation simplifies to the scalar diffusion equation:\n        $$ \\frac{\\partial B}{\\partial t} = \\eta \\frac{\\partial^2 B}{\\partial x^2} $$\nThis completes the derivation of the governing PDE.\n\n### Part 2: Von Neumann Stability Analysis\n\nWe analyze the stability of the specified numerical scheme for the 1D diffusion equation.\n\n1.  **Numerical Scheme**: The problem specifies a Forward-Time Central-Space (FTCS) discretization:\n    $$ B_i^{n+1} = B_i^n + \\eta \\frac{\\Delta t}{\\Delta x^2} \\left( B_{i-1}^n - 2 B_i^n + B_{i+1}^n \\right) $$\n    where $B_i^n \\approx B(i\\Delta x, n\\Delta t)$.\n\n2.  **Fourier Mode Analysis**: We use the standard von Neumann analysis by substituting a single Fourier mode ansatz, $B_i^n = G^n e^{\\mathrm{i} k x_i} = G^n e^{\\mathrm{i} k i \\Delta x}$, into the difference equation. Here, $G$ is the amplification factor for wavenumber $k$, and $\\mathrm{i}$ is the imaginary unit.\n    $$ G^{n+1} e^{\\mathrm{i} k i \\Delta x} = G^n e^{\\mathrm{i} k i \\Delta x} + \\frac{\\eta \\Delta t}{\\Delta x^2} \\left( G^n e^{\\mathrm{i} k (i-1) \\Delta x} - 2 G^n e^{\\mathrm{i} k i \\Delta x} + G^n e^{\\mathrm{i} k (i+1) \\Delta x} \\right) $$\n\n3.  **Derivation of the Amplification Factor**: Dividing by $G^n e^{\\mathrm{i} k i \\Delta x}$ yields the expression for $G$:\n    $$ G = 1 + \\frac{\\eta \\Delta t}{\\Delta x^2} \\left( e^{-\\mathrm{i} k \\Delta x} - 2 + e^{\\mathrm{i} k \\Delta x} \\right) $$\n    Using the identity $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2 \\cos(\\theta)$, this simplifies to:\n    $$ G = 1 + \\frac{2\\eta \\Delta t}{\\Delta x^2} \\left( \\cos(k \\Delta x) - 1 \\right) $$\n    With the half-angle identity $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$, we get:\n    $$ G = 1 - \\frac{4\\eta \\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) $$\n\n4.  **Stability Condition**: For the scheme to be stable, the magnitude of the amplification factor must be less than or equal to one, $|G| \\le 1$. Since $G$ is real, this is equivalent to $-1 \\le G \\le 1$.\n    -   The term $4 \\frac{\\eta \\Delta t}{\\Delta x^2} \\sin^2(\\frac{k \\Delta x}{2})$ is always non-negative, so $G \\le 1$ is always satisfied.\n    -   The non-trivial constraint arises from the lower bound, $G \\ge -1$:\n        $$ -1 \\le 1 - \\frac{4\\eta \\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) $$\n        $$ \\frac{4\\eta \\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 2 $$\n        $$ \\frac{\\eta \\Delta t}{\\Delta x^2} \\le \\frac{1}{2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)} $$\n    This condition must hold for all wavenumbers $k$. The most restrictive case (the \"worst case\") occurs when $\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$ is maximum, which is $1$. This corresponds to the highest resolvable frequency on the grid, the Nyquist mode, where $k \\Delta x = \\pi$.\n    -   Substituting this maximum value yields the Courant-Friedrichs-Lewy (CFL) stability condition for this scheme:\n        $$ \\frac{\\eta \\Delta t}{\\Delta x^2} \\le \\frac{1}{2} $$\n    The problem formulates the timestep as $\\Delta t = r \\frac{\\Delta x^2}{\\eta}$, where $r$ is a dimensionless ratio. Substituting this into our condition gives $r \\le 1/2$. The problem asks for the constant $C$ in the scaling $\\Delta t \\sim \\Delta x^2 / \\eta$, which our analysis identifies as $C=1/2$. Therefore, the scheme is stable for $r \\le 0.5$.\n\n### Part 3: Program Implementation and Execution\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Integrates the 1D resistive induction equation and determines the numerical\n    stability for a set of test cases.\n    \"\"\"\n    # Test suite specification:\n    # Each tuple contains (L, N, eta, r, n_steps)\n    # L: domain length (m)\n    # N: number of grid points\n    # eta: magnetic diffusivity (m^2/s)\n    # r: dimensionless ratio for timestep, r = eta * dt / dx^2\n    # n_steps: number of integration steps\n    test_cases = [\n        (1.0, 128, 1.0, 0.45, 500), # Stable (r  0.5)\n        (1.0, 128, 1.0, 0.50, 500), # Marginally stable (r = 0.5)\n        (1.0, 128, 1.0, 0.60, 60),  # Unstable (r > 0.5)\n        (1.0, 16, 0.5, 0.55, 120),  # Unstable (r > 0.5)\n        (1.0, 64, 2.0, 0.49, 400),  # Stable (r  0.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        L, N, eta, r, n_steps = case\n        \n        # Spatial grid spacing\n        dx = L / N\n        \n        # The problem defines the timestep via r = eta * dt / dx^2.\n        # This dimensionless number, r, is what governs stability.\n        \n        # Initial condition: B(x,0) = B_0 * (-1)^i, with B_0 = 1.\n        # This corresponds to the highest-resolvable (Nyquist) Fourier mode on the\n        # grid, which is the most unstable mode for this scheme.\n        B = np.array([(-1.0)**i for i in range(N)], dtype=np.float64)\n        \n        # The initial maximum absolute value of B is M_initial = 1.0.\n        # The stability decision rule is M_final = 10 * M_initial.\n        # The threshold is therefore 10.0.\n        stability_threshold = 10.0\n\n        # Main time-integration loop using a Forward-Time Central-Space (FTCS) scheme.\n        for _ in range(n_steps):\n            # The update rule is B_i^{n+1} = B_i^n + r * (B_{i-1}^n - 2*B_i^n + B_{i+1}^n).\n            # We use np.roll for an efficient implementation of the finite difference\n            # operator with periodic boundary conditions.\n            # np.roll(B, 1) provides the B_{i-1} term for all i.\n            # np.roll(B, -1) provides the B_{i+1} term for all i.\n            laplacian_B = np.roll(B, 1) + np.roll(B, -1) - 2 * B\n            B += r * laplacian_B\n            \n            # This check prevents numerical overflow for very unstable cases.\n            # It will not alter the final stability decision, as the value will\n            # have already far exceeded the stability_threshold.\n            if np.max(np.abs(B)) > 1e12:\n                break\n\n        # After integration, determine stability based on the specified rule.\n        M_final = np.max(np.abs(B))\n        is_stable = M_final = stability_threshold\n        results.append(is_stable)\n    return results\n\n# This part is for execution and formatting the final answer string\n# It is separated from the core logic for clarity.\nfinal_results = solve()\nprint(f\"[{','.join(str(res).capitalize() for res in final_results)}]\")\n```",
            "answer": "[True,True,False,False,True]"
        }
    ]
}