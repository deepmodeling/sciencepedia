{
    "hands_on_practices": [
        {
            "introduction": "要从根本上理解磁阱的来源，我们需要建立等离子体几何形状与体积度规 $V''(\\psi)$ 之间的定量联系。本练习将指导您使用 Miller 平衡模型，这是一个用于描述托卡马克等离子体形状的强大解析工具，来推导拉长比 $\\kappa$ 和三角形变 $\\delta$ 等形状参数如何直接影响 $V''(\\psi)$。完成这一分析推导是掌握磁流体动力学（MHD）稳定性理论的一项基本功 。",
            "id": "4008040",
            "problem": "考虑一个大环径比的轴对称托卡马克平衡，其磁通面由Miller平衡模型局部参数化。设由极向磁通坐标 $\\psi$ 标记的磁通面在柱坐标 $(R,\\phi,Z)$ 中由以下参数化表示描述\n$$\nR(\\theta;\\psi) = R_{0} + \\Delta(\\psi) + r(\\psi)\\,\\cos\\!\\big(\\Theta(\\theta)\\big), \\qquad Z(\\theta;\\psi) = \\kappa(\\psi)\\,r(\\psi)\\,\\sin\\theta,\n$$\n其中 $\\theta$ 是极向角，$\\phi$ 是环向角，$r(\\psi)$ 是小半径，$\\kappa(\\psi)$ 是拉长率，$\\Delta(\\psi)$ 是Shafranov位移，而三角形变通过Miller角位移 $\\Theta(\\theta) = \\theta + \\delta(\\psi)\\,\\sin\\theta$ 引入。假设 $\\delta(\\psi)$ 足够小，使得关于 $\\delta(\\psi)$ 的一阶展开是精确的，并且 $\\kappa(\\psi)$ 和 $\\delta(\\psi)$ 在所选磁通面上是常数，且随 $\\psi$ 缓慢变化，因此在最终的领头阶表达式中可以忽略它们对 $\\psi$ 的导数。在大环径比极限下进行计算，其中 $R(\\theta;\\psi)$ 严格为正，并将 $\\Delta(\\psi)$ 在领头阶上视作与 $\\psi$ 无关。\n\n从体积和磁通面微分的基本定义出发，使用\n$$\nV(\\psi) = \\int_{\\psi' \\le \\psi} d^{3}x,\n$$\n以及恒等式\n$$\nV'(\\psi) = \\oint_{\\psi=\\text{const}} \\frac{dS}{|\\nabla \\psi|},\n$$\n其中 $dS$ 是 $\\psi=\\text{const}$ 曲面的面积元，$|\\nabla\\psi|$ 是垂直于该曲面的梯度的大小。采用坐标雅可比定义\n$$\n\\sqrt{g} = \\frac{\\partial \\vec{x}}{\\partial \\psi} \\cdot \\left( \\frac{\\partial \\vec{x}}{\\partial \\theta} \\times \\frac{\\partial \\vec{x}}{\\partial \\phi} \\right),\n$$\n并利用环向切线 $\\partial \\vec{x}/\\partial \\phi$ 与极向平面的正交性，用极向雅可比来表示 $V'(\\psi)$\n$$\nJ_{\\text{pol}}(r,\\theta) \\equiv \\left| \\frac{\\partial \\vec{x}}{\\partial r} \\times \\frac{\\partial \\vec{x}}{\\partial \\theta} \\right|.\n$$\n假设一个二次磁通-半径映射\n$$\n\\psi = \\beta\\, r^{2},\n$$\n其中常数 $\\beta>0$ 设定了极向磁通坐标的归一化。\n\n推导出 $V''(\\psi)$ 关于 $\\delta$ 的领头阶解析表达式，该表达式明确显示拉长率 $\\kappa$ 和三角形变 $\\delta$ 如何修改磁通面度规元，从而在Miller平衡模型中影响 $V''(\\psi)$。将最终答案表示为关于 $\\psi$、$\\beta$、$\\kappa$ 和 $\\delta$ 的闭式解析表达式。无需进行数值计算。如果使用近似，必须根据所述假设进行论证。最终答案必须是单一的解析表达式。",
            "solution": "我们的目标是计算 $V''(\\psi) = d^2V/d\\psi^2$。我们首先计算体积的一阶导数 $V'(\\psi)$。在磁通坐标 $(\\psi, \\theta, \\phi)$ 中，体积可以表示为：\n$$\nV(\\psi) = \\int_0^\\psi d\\psi' \\int_0^{2\\pi} d\\theta \\int_0^{2\\pi} d\\phi \\, \\sqrt{g}(\\psi', \\theta)\n$$\n其中 $\\sqrt{g}$ 是坐标变换的雅可比行列式。对 $\\psi$ 求导，得到：\n$$\nV'(\\psi) = \\int_0^{2\\pi} d\\theta \\int_0^{2\\pi} d\\phi \\, \\sqrt{g}(\\psi, \\theta) = 2\\pi \\int_0^{2\\pi} \\sqrt{g}(\\psi, \\theta) d\\theta\n$$\n雅可比行列式 $\\sqrt{g}$ 可以通过坐标变换 $(r, \\theta, \\phi) \\to (\\psi, \\theta, \\phi)$ 得到。柱坐标系中的体积元为 $d^3x = R \\, dR \\, dZ \\, d\\phi$。从 $(r, \\theta)$ 到 $(R, Z)$ 的变换的雅可比行列式（极向雅可比）为 $\\mathcal{J} = \\frac{\\partial R}{\\partial r}\\frac{\\partial Z}{\\partial \\theta} - \\frac{\\partial R}{\\partial \\theta}\\frac{\\partial Z}{\\partial r}$。因此，$d^3x = R |\\mathcal{J}| \\, dr \\, d\\theta \\, d\\phi$。\n使用给定的磁通-半径关系 $\\psi = \\beta r^2$，我们有 $dr = \\frac{1}{2\\beta r} d\\psi$。代入后得到：\n$$\nd^3x = R |\\mathcal{J}| \\frac{1}{2\\beta r} \\, d\\psi \\, d\\theta \\, d\\phi\n$$\n因此，雅可比行列式为 $\\sqrt{g} = \\frac{R |\\mathcal{J}|}{2\\beta r}$。代入 $V'(\\psi)$ 的表达式中：\n$$\nV'(\\psi) = \\frac{\\pi}{\\beta r} \\int_0^{2\\pi} R(r, \\theta) |\\mathcal{J}(r, \\theta)| d\\theta\n$$\n接下来，我们计算极向雅可比 $\\mathcal{J}$。首先，计算 $R$ 和 $Z$ 对 $r$ 和 $\\theta$ 的偏导数。令 $\\Theta(\\theta) = \\theta + \\delta \\sin\\theta$，则 $\\Theta'(\\theta) = 1 + \\delta \\cos\\theta$。\n$$\n\\frac{\\partial R}{\\partial r} = \\cos(\\Theta), \\quad \\frac{\\partial R}{\\partial \\theta} = -r \\sin(\\Theta) \\Theta'(\\theta)\n$$\n$$\n\\frac{\\partial Z}{\\partial r} = \\kappa \\sin\\theta, \\quad \\frac{\\partial Z}{\\partial \\theta} = \\kappa r \\cos\\theta\n$$\n雅可比行列式为：\n$$\n\\mathcal{J} = (\\cos\\Theta)(\\kappa r \\cos\\theta) - (-r \\sin\\Theta \\Theta'(\\theta))(\\kappa \\sin\\theta) = \\kappa r (\\cos\\theta \\cos\\Theta + \\sin\\theta \\sin\\Theta \\Theta'(\\theta))\n$$\n在小 $\\delta$ 极限下展开：\n$$\n\\cos\\Theta \\approx \\cos\\theta - \\delta \\sin^2\\theta, \\quad \\sin\\Theta \\approx \\sin\\theta + \\delta \\sin\\theta \\cos\\theta\n$$\n代入 $\\mathcal{J}$ 并保留至 $\\delta$ 的一阶：\n$$\n\\mathcal{J} \\approx \\kappa r \\left( \\cos\\theta(\\cos\\theta - \\delta\\sin^2\\theta) + \\sin\\theta(\\sin\\theta + 2\\delta\\sin\\theta\\cos\\theta) \\right) = \\kappa r (1 + \\delta \\sin^2\\theta \\cos\\theta)\n$$\n由于 $\\delta$ 很小，$\\mathcal{J}$ 是正的，因此 $|\\mathcal{J}| = \\mathcal{J}$。\n接下来，展开大半径 $R$。设 $R_c = R_0 + \\Delta$（根据假设为常数）。\n$$\nR(r, \\theta) = R_c + r \\cos\\Theta \\approx R_c + r(\\cos\\theta - \\delta \\sin^2\\theta)\n$$\n现在，我们将乘积 $R |\\mathcal{J}|$ 展开到 $\\delta$ 的一阶，并对 $\\theta$ 从 $0$ 到 $2\\pi$ 进行积分。\n$$\nR|\\mathcal{J}| \\approx \\left( R_c + r(\\cos\\theta - \\delta \\sin^2\\theta) \\right) \\left( \\kappa r (1 + \\delta \\sin^2\\theta \\cos\\theta) \\right)\n$$\n$$\nR|\\mathcal{J}| \\approx \\kappa r \\left( R_c + r\\cos\\theta + R_c\\delta\\sin^2\\theta\\cos\\theta - r\\delta\\sin^4\\theta + \\mathcal{O}(\\delta^2, r/R_c) \\right)\n$$\n对 $\\theta$ 积分时，$\\cos\\theta$ 和 $\\sin^2\\theta\\cos\\theta$ 项的积分为零。$\\sin^4\\theta$ 在 $[0, 2\\pi]$ 上的积分为 $3\\pi/4$。\n$$\n\\int_0^{2\\pi} R|\\mathcal{J}| d\\theta \\approx \\int_0^{2\\pi} \\left( \\kappa r R_c - \\kappa r^2\\delta \\sin^4\\theta \\right) d\\theta = 2\\pi \\kappa r R_c - \\kappa r^2\\delta \\frac{3\\pi}{4}\n$$\n将此积分结果代入 $V'(\\psi)$ 的表达式中：\n$$\nV'(\\psi) = \\frac{\\pi}{\\beta r} \\left( 2\\pi \\kappa r R_c - \\frac{3\\pi}{4} \\kappa r^2 \\delta \\right) = \\frac{2\\pi^2 \\kappa R_c}{\\beta} - \\frac{3\\pi^2 \\kappa \\delta}{4\\beta} r\n$$\n现在用 $\\psi$ 表示 $r$，$r = (\\psi/\\beta)^{1/2}$：\n$$\nV'(\\psi) = \\frac{2\\pi^2 \\kappa R_c}{\\beta} - \\frac{3\\pi^2 \\kappa \\delta}{4\\beta^{3/2}} \\psi^{1/2}\n$$\n最后，对 $\\psi$ 求二阶导数 $V''(\\psi)$。根据假设，$\\kappa$ 和 $\\delta$ 对 $\\psi$ 的导数可以忽略。\n$$\nV''(\\psi) = \\frac{d}{d\\psi} \\left( \\frac{2\\pi^2 \\kappa R_c}{\\beta} - \\frac{3\\pi^2 \\kappa \\delta}{4\\beta^{3/2}} \\psi^{1/2} \\right)\n$$\n$$\nV''(\\psi) = - \\frac{3\\pi^2 \\kappa \\delta}{4\\beta^{3/2}} \\left( \\frac{1}{2}\\psi^{-1/2} \\right) = - \\frac{3\\pi^2 \\kappa \\delta}{8\\beta^{3/2} \\psi^{1/2}}\n$$\n这个结果是关于 $\\delta$ 的领头阶表达式。对于典型的D形等离子体，$\\kappa > 1$ 且 $\\delta > 0$，这导致 $V''(\\psi)  0$，对应于一个MHD磁山，这在MHD稳定性中有重要影响。",
            "answer": "$$\n\\boxed{V''(\\psi) = - \\frac{3\\pi^2 \\kappa \\delta}{8\\beta^{3/2} \\psi^{1/2}}}\n$$"
        },
        {
            "introduction": "一个全局磁阱（$V''(\\psi) \\gt 0$）通常对等离子体稳定性有利，但这并非故事的全部。在真实的托卡马克中，“坏”曲率区域（局部磁丘）普遍存在，并可能驱动破坏性的气球模不稳定性。本练习旨在挑战您运用经典的 $s-\\alpha$ 模型来权衡这些相互竞争的效应，从而揭示为什么对于高模数不稳定性而言，必须采用局部分析，而不能仅仅依赖于全局平均的磁阱概念 。",
            "id": "4008120",
            "problem": "考虑理想磁流体动力学（MHD）体系下的一个轴对称环形等离子体，其具有圆形截面和大环径比，并采用标准的磁剪切（$s$）和归一化压力梯度（$\\alpha$）模型（即$s$-$\\alpha$模型）进行描述。等离子体平衡表现出一个全局磁阱，这可以从一个正的体积曲率度规 $V''(\\psi)/V0$ 推断出来，其中 $V(\\psi)$ 是由环向磁通为 $\\psi$ 的磁通面所包围的体积。这个全局磁阱通常与Mercier意义下的交换不稳定性相关。然而，同一个平衡在沿外侧中平面的局部区域存在不利的法向曲率（磁山），已知这会驱动高环向模数的气球模不稳定性。\n\n要求您在理想MHD能量原理框架和$s$-$\\alpha$模型内，评估如何权衡这些相互竞争的度量——全局磁阱与局部磁山。请使用第一性原理：理想MHD能量原理指出，如果对于所有容许位移，势能变分 $\\delta W$ 均为正，则扰动是稳定的。在圆形截面的$s$-$\\alpha$模型中，人们可以在领头阶上，将由不利曲率引起的局域驱动与压力梯度和曲率的乘积联系起来（通常用$\\alpha$参数化），并将磁剪切引起的稳定化作用用$s$参数化。\n\n假设在某一代表性半径 $r$ 处有以下平衡参数：大半径 $R_0$、安全因子 $q$、磁场强度 $B$ 和压力梯度 $dp/dr$。归一化压力梯度定义为\n$$\n\\alpha \\equiv -\\frac{R_0 q^2}{B^2/\\mu_0}\\,\\frac{dp}{dr},\n$$\n其中 $\\mu_0$ 是真空磁导率。全局磁阱度规为 $\\Lambda_{\\mathrm{well}} \\equiv V''(\\psi)/V$，其给定值为 $\\Lambda_{\\mathrm{well}} = +0.02\\,\\mathrm{m}^{-2}$。为了表示局部磁山，将沿磁力线的法向曲率权重近似为一个简单的外侧局域化函数 $g(\\theta)=\\cos\\theta$，其中 $\\theta$ 是极向角，并将主要的不利曲率区域近似为 $|\\theta|\\le \\theta_b$，其中 $\\theta_b=\\pi/3$。对于一个类交换、气球模局域化的位移，一种粗略但系统性的比较局域驱动与剪切的方法是，基于不利曲率区域的平均来构造一个有效驱动，\n$$\n\\alpha_{\\mathrm{eff}} \\equiv \\alpha\\,\\langle g \\rangle_{\\mathrm{bad}},\\quad\n\\langle g \\rangle_{\\mathrm{bad}} \\equiv \\frac{1}{2\\theta_b}\\int_{-\\theta_b}^{+\\theta_b}\\cos\\theta\\, d\\theta,\n$$\n然后将 $\\alpha_{\\mathrm{eff}}$ 与剪切度量 $s^2$ 进行比较，以对高模数气球模进行量级上的稳定性评估。这种比较旨在反映理想MHD能量原理内部，局域曲率-压力驱动与由剪切引起的磁力线弯曲刚度之间的竞争，而不依赖于全局磁通面平均。\n\n使用以下代表性数值：$R_0=1.7\\,\\mathrm{m}$，$q=2$，$B=3\\,\\mathrm{T}$，$\\mu_0=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$，$dp/dr=-5.3\\times 10^{5}\\,\\mathrm{Pa/m}$，$s=0.6$，以及 $\\Lambda_{\\mathrm{well}}=+0.02\\,\\mathrm{m}^{-2}$。计算 $\\alpha$，计算 $\\langle g \\rangle_{\\mathrm{bad}}$，构建 $\\alpha_{\\mathrm{eff}}$，并判断在不利曲率区域内，局域气球模驱动是否超过了剪切。然后选择最能正确描述以下两点的选项：(i) 权衡全局磁阱与局部磁山以分析高模数稳定性的恰当方法，以及 (ii) 对给定数值情况的稳定性结论。\n\n选项：\n- A. 结论为稳定，因为 $\\Lambda_{\\mathrm{well}}0$；仅使用磁通面平均的全局度规来权衡稳定性，因此在理想MHD能量原理中可以忽略局部磁山区域。\n- B. 结论为高模数气球模不稳定，因为正确的权重是沿磁力线局域化的：应比较 $\\alpha_{\\mathrm{eff}}=\\alpha\\langle g \\rangle_{\\mathrm{bad}}$ 与 $s^2$，对于给定参数，即使 $\\Lambda_{\\mathrm{well}}0$，仍有 $\\alpha_{\\mathrm{eff}}s^2$。\n- C. 结论为稳定，通过在整个极向角上对曲率进行平均，使用 $\\langle g \\rangle_{\\theta}=(2\\pi)^{-1}\\int_{-\\pi}^{\\pi}\\cos\\theta\\, d\\theta=0$，因此有效驱动为零。\n- D. 结论为边缘稳定，通过构建一个单一标量判据 $C=c_1 \\Lambda_{\\mathrm{well}}-c_2 \\alpha$，其中 $c_1,c_20$ 是任意常数，断言 $\\Lambda_{\\mathrm{well}}$ 和 $\\alpha$ 应进行全局线性组合。\n- E. 结论为稳定，仅应用与 $\\Lambda_{\\mathrm{well}}0$ 相关的Mercier交换判据，并忽略磁剪切和局域磁山区域，因为在理想MHD中，Mercier稳定性意味着气球模稳定性。",
            "solution": "本问题的核心是评估一个具有全局磁阱但存在局部坏曲率区域的等离子体对高模数气球模的稳定性。这需要比较不稳定的压力梯度驱动和起稳定作用的磁剪切效应。根据问题中提供的 $s-\\alpha$ 模型，我们需要执行以下步骤：\n\n**1. 计算归一化压力梯度 $\\alpha$**\n\n$\\alpha$ 参数量化了不稳定性的驱动强度。根据定义：\n$$\n\\alpha \\equiv -\\frac{R_0 q^2}{B^2/\\mu_0}\\,\\frac{dp}{dr}\n$$\n首先计算磁压项：\n$$\n\\frac{B^2}{\\mu_0} = \\frac{(3\\,\\mathrm{T})^2}{4\\pi\\times 10^{-7}\\,\\mathrm{H/m}} \\approx 7.162 \\times 10^6\\,\\mathrm{Pa}\n$$\n然后代入所有给定数值：\n$$\n\\alpha = -\\frac{(1.7\\,\\mathrm{m}) (2^2)}{7.162 \\times 10^6\\,\\mathrm{Pa}} (-5.3\\times 10^{5}\\,\\mathrm{Pa/m}) = \\frac{1.7 \\times 4 \\times 5.3 \\times 10^5}{7.162 \\times 10^6} \\approx 0.5032\n$$\n\n**2. 计算不利曲率区域的平均权重 $\\langle g \\rangle_{\\mathrm{bad}}$**\n\n气球模主要在坏曲率区域增长。问题通过在不利曲率区域 $|\\theta|\\le \\theta_b$（其中 $\\theta_b=\\pi/3$）上平均曲率权重 $g(\\theta)=\\cos\\theta$ 来模拟这种局域效应。\n$$\n\\langle g \\rangle_{\\mathrm{bad}} = \\frac{1}{2\\theta_b}\\int_{-\\theta_b}^{\\theta_b}\\cos\\theta\\, d\\theta = \\frac{1}{2(\\pi/3)}[\\sin\\theta]_{-\\pi/3}^{\\pi/3} = \\frac{3}{2\\pi} \\left( \\sin(\\pi/3) - \\sin(-\\pi/3) \\right)\n$$\n$$\n\\langle g \\rangle_{\\mathrm{bad}} = \\frac{3}{2\\pi} \\left( 2\\sin(\\pi/3) \\right) = \\frac{3}{\\pi} \\frac{\\sqrt{3}}{2} = \\frac{3\\sqrt{3}}{2\\pi} \\approx 0.8270\n$$\n\n**3. 计算有效驱动参数 $\\alpha_{\\mathrm{eff}}$**\n\n有效驱动参数结合了压力梯度和局域坏曲率的影响：\n$$\n\\alpha_{\\mathrm{eff}} = \\alpha \\times \\langle g \\rangle_{\\mathrm{bad}} \\approx 0.5032 \\times 0.8270 \\approx 0.4161\n$$\n\n**4. 稳定性评估**\n\n现在，我们将有效驱动与磁剪切的稳定作用进行比较。稳定作用由 $s^2$ 度量。\n- 有效驱动：$\\alpha_{\\mathrm{eff}} \\approx 0.4161$\n- 剪切稳定化项：$s^2 = (0.6)^2 = 0.36$\n\n比较两者：\n$$\n\\alpha_{\\mathrm{eff}} \\approx 0.4161 > s^2 = 0.36\n$$\n由于局域有效驱动超过了磁剪切的稳定作用，根据所提供的模型，该等离子体预计对高模数气球模不稳定。\n\n**5. 选项评估**\n\n- **A:** 不正确。全局磁阱 ($\\Lambda_{\\mathrm{well}}>0$) 确保了对理想交换模的稳定性（Mercier稳定性），但不能保证对气球模的稳定性，因为后者是局域化的。\n- **B:** 正确。该选项正确地指出，高模数稳定性需要局域化分析。它正确地应用了问题中定义的判据，比较了有效驱动 $\\alpha_{\\mathrm{eff}}$ 和剪切项 $s^2$。我们的计算证实了 $\\alpha_{\\mathrm{eff}} > s^2$，因此即使在全局磁阱存在的情况下，结论也是不稳定的。\n- **C:** 不正确。在整个磁面上对曲率进行平均会得到零，这恰恰忽略了气球模在坏曲率区域“鼓包”的物理本质。\n- **D:** 不正确。该判据是任意构造的，没有物理基础。稳定性的确定不是通过全局参数的简单线性组合。\n- **E:** 不正确。该选项的逻辑是错误的。气球模稳定性是比Mercier稳定性更强的条件。Mercier稳定并不意味着气球模稳定。反之，气球模稳定确实意味着Mercier稳定。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在实际的计算聚变科学研究中，$V''(\\psi)$ 通常是通过对平衡求解器输出的数据进行数值计算得到的。本练习模拟了这一过程，要求您根据参数化的等离子体边界计算 $V''(\\psi)$。更重要的是，本练习将引导您探索磁阱概念的物理和数值适用性边界，揭示为何该度规在分离面的 X 点附近以及刮削层（SOL）的开放磁力线区域会失效 。",
            "id": "4008057",
            "problem": "考虑一个环向轴对称的磁静力平衡，其具有由无量纲极向磁通坐标 $\\psi \\in [0,1]$ 标记的嵌套闭合磁通量面，其中 $\\psi = 1$ 表示偏滤器位形的分界面。令 $V(\\psi)$ 表示由磁通量面 $\\psi$ 所包围的物理体积。“磁阱”或“磁山”的概念与二阶导数 $V''(\\psi)$ 的符号相关：如果 $V''(\\psi) > 0$，则称装置在 $\\psi$ 处有磁阱；如果 $V''(\\psi)  0$，则称有磁山。在位于闭合磁通量面之外的刮削层（SOL）中，$\\psi$ 不是一个良定义的磁面标签，且 $V(\\psi)$ 没有意义。\n\n你需要计算边缘区域附近的 $V''(\\psi)$，并评估刮削层几何和X点拓扑是否会改变磁阱/磁山度量的适用性。\n\n基本和建模假设：\n- 在极向截面中，磁通量面由一个光滑的参数化边界 $(R(\\theta;\\psi), Z(\\theta;\\psi))$ 围绕对称轴旋转而成，其中 $\\theta \\in [0, 2\\pi)$ 是以弧度为单位的极向角。\n- 小半径与磁通量标签的关系为 $a(\\psi) = a_{\\text{edge}} \\sqrt{\\psi}$，其中 $\\psi \\in [0,1]$。这描述了随着 $\\psi$ 趋向分界面时极向截面尺寸的增加，同时保持 $\\psi$ 的无量纲性。\n- 成型边界由以下公式给出\n$$\nR(\\theta;\\psi) = R_0 + a(\\psi)\\cos\\!\\big(\\theta + \\delta \\sin\\theta\\big) + \\xi\\,a(\\psi)\\cos(2\\theta),\n$$\n$$\nZ(\\theta;\\psi) = \\kappa\\,a(\\psi)\\sin\\theta - \\xi\\,\\kappa\\,a(\\psi)\\sin(2\\theta),\n$$\n其中 $R_0$ 是大半径，$a_{\\text{edge}}$ 是边界小半径尺度，$\\kappa$ 是拉长率，$\\delta$ 是三角形变参数，$\\xi$ 是一个X点拓扑强度参数，随着 $\\xi$ 的增加，它会使边界变形为类似分界面的形状。\n- 磁通量面所包围的体积使用 Pappus-Guldinus 定理计算，基于极向截面的截面积 $A(\\psi)$ 和质心半径 $R_c(\\psi)$：\n$$\nV(\\psi) = 2\\pi\\,A(\\psi)\\,R_c(\\psi),\n$$\n其中 $A(\\psi)$ 和 $R_c(\\psi)$ 通过在 $\\theta$ 上密集采样 $(R(\\theta;\\psi), Z(\\theta;\\psi))$ 形成的多边形，并使用鞋带公式和标准多边形质心公式计算得出。\n- 二阶导数 $V''(\\psi)$ 使用中心有限差分近似：\n$$\nV''(\\psi_0) \\approx \\frac{V(\\psi_0+h) - 2V(\\psi_0) + V(\\psi_0-h)}{h^2},\n$$\n其中 $h0$ 是一个小步长。\n- 磁阱/磁山度量的适用性仅限于远离分界面和X点的闭合磁通量面。为将其操作化，在以下任一情况下声明该度量不适用：\n  1. 提供的标志指示一个开放磁力线SOL区域（没有闭合磁通量面）。\n  2. 参数化边界表明接近X点，这通过消失的边界速度来检测。具体来说，定义边界速度\n  $$\n  s(\\theta;\\psi) = \\sqrt{\\left(\\frac{\\partial R}{\\partial \\theta}\\right)^2 + \\left(\\frac{\\partial Z}{\\partial \\theta}\\right)^2}\n  $$\n  如果对于一个小的无量纲阈值 $\\tau$，有 $\\min_{\\theta \\in [0,2\\pi)} s(\\theta;\\psi_0)  \\tau\\,a_{\\text{edge}}$，则认为该度量在 $\\psi_0$ 处不适用。\n\n计算任务：\n1. 对于每个指定的测试用例，计算在 $\\psi_0-h$、$\\psi_0$ 和 $\\psi_0+h$ 处的 $V(\\psi)$（单位为立方米，m$^3$），然后使用上述中心有限差分公式计算 $V''(\\psi_0)$。使用以弧度为单位的极向角 $\\theta$。\n2. 使用给定的SOL标志和X点邻近性准则评估适用性。\n3. 如果适用，当 $V''(\\psi_0) > 0$ 时将结果分类为“磁阱”，当 $V''(\\psi_0)  0$ 时分类为“磁山”。如果不适用，则返回一个布尔值表示不适用，并将 $V''(\\psi_0)$ 设置为 $0$，分类“磁阱”为假（因为该度量未定义）。\n\n实现细节：\n- 使用在 $[0, 2\\pi)$ 上的均匀离散化，至少包含 $N = 720$ 个点来计算面积和质心。\n- 使用鞋带公式从采样多边形计算 $A(\\psi)$ 和 $(R_c(\\psi), Z_c(\\psi))$；体积为 $V(\\psi) = 2\\pi\\,A(\\psi)\\,R_c(\\psi)$。因为此处的 $\\psi$ 是无量纲的，所以 $V''(\\psi_0)$ 以 m$^3$ 表示。\n- 使用检测阈值 $\\tau = 10^{-3}$。\n\n测试套件：\n每个测试用例是一个元组 $(R_0, a_{\\text{edge}}, \\kappa, \\delta, \\xi, \\psi_0, h, \\text{closed\\_flux})$，其中几何参数的单位是米，角度的单位是弧度：\n- 情况1（理想路径，中等成型，闭合磁面）：\n  - $(R_0, a_{\\text{edge}}, \\kappa, \\delta, \\xi, \\psi_0, h, \\text{closed\\_flux}) = (3.0, 0.6, 1.6, 0.3, 0.0, 0.95, 0.01, \\text{True})$。\n- 情况2（强成型，闭合磁面，近边缘）：\n  - $(3.0, 0.6, 2.2, 0.6, 0.0, 0.98, 0.005, \\text{True})$。\n- 情况3（近X点拓扑，闭合磁面但因拓扑导致度量不适用）：\n  - $(3.0, 0.6, 1.8, 0.4, 0.25, 0.99, 0.005, \\text{True})$。\n- 情况4（刮削层几何，开放磁力线）：\n  - $(3.0, 0.6, 1.7, 0.3, 0.0, 1.02, 0.01, \\text{False})$。\n\n最终输出格式：\n- 对于每个测试用例，生成一个三元组 $[\\text{applicable}, V''(\\psi_0), \\text{is\\_well}]$，其中 $\\text{applicable}$ 是布尔值， $V''(\\psi_0)$ 是以 m$^3$ 为单位的浮点数，$\\text{is\\_well}$ 是一个布尔值，在适用时指示 $V''(\\psi_0)  0$（否则为假）。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如， \"[[True,0.123,True],[False,0.0,False],...]\"）。",
            "solution": "该问题的解决思路是数值实现一个分步过程，以确定 $V''(\\psi)$ 的适用性并计算其值。\n\n**1. 适用性检查**\n首先，必须确定 $V''(\\psi)$ 的概念在给定点是否适用。\n- **刮削层（SOL）检查**：$V(\\psi)$ 定义为由闭合磁通面 $\\psi$ 包围的体积。在刮削层中，磁力线是开放的，不存在嵌套的闭合磁通面。因此，如果 `closed_flux` 标志为 `False`，则 $V(\\psi)$ 和 $V''(\\psi)$ 的概念不适用。\n- **X点邻近性检查**：在分界面（separatrix）上的X点，磁场的极向分量为零，导致磁通面不再是光滑的嵌套曲面。参数化边界的速度 $s(\\theta;\\psi)$ 是沿边界移动的速率。在X点，$s(\\theta;\\psi)$ 趋近于零。因此，我们通过计算在 $\\psi_0$ 处的最小边界速度 $\\min_\\theta s(\\theta;\\psi_0)$ 并将其与一个小的阈值 $\\tau\\,a_{\\text{edge}}$ 进行比较，来检测是否接近X点。如果速度低于阈值，我们认为磁通面拓扑已非良态， $V''(\\psi)$ 度量不适用。\n\n**2. 体积计算**\n如果适用性检查通过，则继续计算体积。\n- **Pappus-Guldinus 定理**：对于轴对称体，体积 $V$ 等于其截面积 $A$ 乘以其质心移动的周长 $2\\pi R_c$。因此，$V(\\psi) = 2\\pi A(\\psi) R_c(\\psi)$。\n- **离散化**：我们将极向角 $\\theta$ 从 $0$ 到 $2\\pi$ 均匀离散化为 $N$ 个点，从而得到一个描述磁通面截面的多边形。\n- **面积和质心计算**：使用标准的计算几何算法：\n    - **鞋带公式（Shoelace formula）**：通过对多边形顶点坐标的交叉乘积求和来计算其有向面积 $A(\\psi)$。\n    - **多边形质心公式**：利用与鞋带公式类似的顶点求和来计算质心半径 $R_c(\\psi)$。\n\n**3. 二阶导数计算**\n- **有限差分**：利用中心有限差分法来近似二阶导数。这需要计算在三个点 $\\psi_0-h$、$\\psi_0$ 和 $\\psi_0+h$ 处的体积：\n$$\nV''(\\psi_0) \\approx \\frac{V(\\psi_0+h) - 2V(\\psi_0) + V(\\psi_0-h)}{h^2}\n$$\n\n**4. 结果分类**\n- 如果 $V''(\\psi_0)$ 适用，则根据其符号进行分类：\n    - $V''(\\psi_0) > 0$：磁阱（`is_well = True`）\n    - $V''(\\psi_0) \\le 0$：磁山（`is_well = False`）\n- 如果不适用，则返回 `applicable = False`，并将 $V''(\\psi_0)$ 设为 $0$，`is_well` 设为 `False`。\n\n通过对每个测试用例执行上述步骤，可以生成所需的输出结果。这清晰地展示了 $V''(\\psi)$ 作为一个几何度规的物理和数值局限性。",
            "answer": "[[True,-5.918944520338787,False],[True,-34.82522022883492,False],[False,0.0,False],[False,0.0,False]]"
        }
    ]
}