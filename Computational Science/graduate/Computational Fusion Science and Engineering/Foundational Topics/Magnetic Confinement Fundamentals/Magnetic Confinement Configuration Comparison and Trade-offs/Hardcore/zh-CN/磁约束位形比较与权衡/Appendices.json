{
    "hands_on_practices": [
        {
            "introduction": "磁场几何形态的一个直接后果是粒子囚禁。在非均匀磁场中，一些粒子会在磁场强的区域被反射，从而在磁场弱的区域来回振荡，这些粒子被称为“捕获粒子”。捕获粒子的比例是决定新经典输运（一种主要的能量损失渠道）的关键因素。本练习  将指导你从第一性原理出发，推导捕获粒子份额的表达式，并计算其在托卡马克和仿星器几何下的数值，从而揭示磁场几何如何决定这一关键的约束性能。",
            "id": "4004617",
            "problem": "您的任务是从第一性原理出发，推导并计算磁约束等离子体中的捕获粒子份额 $f_t$。计算将使用沿磁通面上单根闭合磁力线的最大和最小磁场强度 $B_{\\max}$ 和 $B_{\\min}$ 的比值。您将比较两种磁约束位形族：圆形轴对称托卡马克和螺旋纹波仿星器。推导和计算必须基于基本原理以及合理且自洽的 $B(\\theta)$ 几何模型，其中 $\\theta$ 是参数化沿磁力线位置的角向角。\n\n使用的基本原理：\n- 对于在缓慢变化的场中充分磁化的粒子，磁矩 $\\mu = m v_\\perp^2/(2 B)$ 守恒；在没有碰撞的情况下，总动能 $E = m(v_\\perp^2 + v_\\parallel^2)/2$ 守恒。\n- 各向同性的速度空间分布，意味着粒子方向在单位球面上均匀分布。\n- 磁镜条件，将 $B_{\\min}$ 处的螺距角与 $B_{\\max}$ 处的反射联系起来。\n\n圆形同心磁通面上沿磁力线的磁场大小的几何模型：\n- 由环向曲率引起的类托卡马克变化：\n  $$B_{\\mathrm{tok}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta},$$\n  其中 $B_0$ 是轴上磁场，单位为 $\\mathrm{T}$；$R_0$ 是大半径，单位为 $\\mathrm{m}$；$r$ 是小半径，单位为 $\\mathrm{m}$；$\\theta \\in [0, 2\\pi)$ 是角向角，单位为弧度。\n- 在类托卡马克变化上叠加了额外螺旋纹波的类仿星器变化：\n  $$B_{\\mathrm{stel}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta} \\, \\left(1 + \\delta \\cos(N \\theta)\\right),$$\n  其中 $\\delta$ 是无量纲的纹波幅度，$N$ 是整数场周期数。选择的 $\\delta$ 应使所有 $\\theta$ 的 $1 + \\delta \\cos(N \\theta) > 0$，以保持 $B(\\theta)$ 的物理正性。\n\n您的任务：\n1. 仅从磁矩守恒、动能守恒和各向同性速度空间分布的定义出发，推导捕获粒子份额 $f_t$ 的封闭形式表达式，用磁镜比 $R = B_{\\max}/B_{\\min}$ 表示，其中 $B_{\\max}$ 和 $B_{\\min}$ 是沿磁力线上 $B(\\theta)$ 的最大值和最小值。\n2. 实现一个程序，该程序：\n   - 在 $[0, 2\\pi)$ 范围内均匀采样 $\\theta$（弧度），以近似 $B_{\\max}$ 和 $B_{\\min}$。\n   - 为每种位形情况计算 $R = B_{\\max}/B_{\\min}$。\n   - 使用您在任务1中推导的表达式计算 $f_t$。\n   - 将所有测试案例的结果汇总到一行输出中，格式如下文规定。\n\n科学真实性与单位：\n- 这些模型是近似的，但被广泛使用且在科学上对于第一性原理比较是合理的。磁场 $B$ 的单位是 $\\mathrm{T}$，长度 $R_0$ 和 $r$ 的单位是 $\\mathrm{m}$，角度 $\\theta$ 的单位是弧度。捕获份额 $f_t$ 是无量纲的。\n- 确保对于所有采样的 $\\theta$，$B(\\theta) > 0$。\n\n采样要求：\n- 每个测试案例使用 $N_\\theta = 2000$ 个在 $[0, 2\\pi)$ 内均匀间隔的 $\\theta$ 样本。\n\n测试套件：\n为以下参数集提供计算，这些参数集涵盖了典型行为、边界极限和几何权衡：\n- 案例1（托卡马克，一般情况）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.3$ $\\mathrm{m}$。\n- 案例2（托卡马克，近乎均匀的 $B$，边界情况）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.001$ $\\mathrm{m}$。\n- 案例3（仿星器，中等纹波，曲率和纹波极值可能未对齐）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.3$ $\\mathrm{m}$，$\\delta = 0.06$，$N = 5$。\n- 案例4（仿星器，更强纹波，多个磁阱）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.2$ $\\mathrm{m}$，$\\delta = 0.25$，$N = 10$。\n\n答案类型和输出规范：\n- 对于每个案例，程序必须计算一个等于捕获粒子份额 $f_t$ 的浮点数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[f_1,f_2,f_3,f_4]$），值的顺序与上述案例相同。",
            "solution": "该问题陈述已被验证为科学上合理、定义明确且客观。它基于等离子体物理学的既定原理，并为可解的计算任务提供了一套完整且一致的参数。其推导和后续计算是磁约束聚变研究中的标准程序。因此，我们可以着手解决问题。\n\n主要任务是推导捕获粒子份额 $f_t$ 的表达式，然后针对几种磁场位形进行计算。推导将基于所提供的第一性原理：粒子磁矩 $\\mu$ 和其总动能 $E$ 的守恒。\n\n让我们从在磁场 $B$ 中运动的单个质量为 $m$、电荷为 $q$ 的粒子的守恒量定义开始：\n磁矩由 $\\mu = \\frac{m v_{\\perp}^2}{2 B}$ 给出，其中 $v_{\\perp}$ 是粒子速度垂直于磁场矢量的分量。\n动能为 $E = \\frac{1}{2} m v^2 = \\frac{1}{2} m (v_{\\perp}^2 + v_{\\parallel}^2)$，其中 $v_{\\parallel}$ 是平行于场的速度分量，$v$ 是总速率。\n\n在静态磁场中，$E$ 是守恒的，这意味着粒子的总速率 $v$ 是恒定的。磁矩 $\\mu$ 是一个绝热不变量，只要磁场在空间和时间上的变化相对于粒子的回旋运动是缓慢的，它就守恒。我们假设这些条件成立。\n\n从 $\\mu$ 和 $E$ 的守恒，我们可以建立粒子捕获的条件。$\\mu$ 的恒定性意味着 $\\frac{v_{\\perp}^2}{B}$ 沿粒子轨迹是一个常数。让我们用螺距角 $\\alpha$ 来表示它，定义为 $v_{\\perp} = v \\sin \\alpha$ 和 $v_{\\parallel} = v \\cos \\alpha$。将其代入不变量中得到：\n$$ \\frac{v^2 \\sin^2 \\alpha}{B} = \\text{常数} $$\n由于 $v$ 也是常数，我们得到关系式：\n$$ \\frac{\\sin^2 \\alpha}{B} = \\text{常数} $$\n\n如果一个粒子沿磁力线的运动被磁镜效应反转，则该粒子被认为是“捕获”的。这发生在一个“反转点”，在该点平行速度 $v_{\\parallel}$ 变为零。在这样的点上，总动能完全是垂直的，所以 $v_{\\perp} = v$，这意味着螺距角 $\\alpha = \\pi/2$，因此 $\\sin^2 \\alpha = 1$。设 $B_{\\text{turn}}$ 为该反转点处的磁场强度。\n\n让我们在磁力线上的两个位置评估不变量 $\\frac{\\sin^2 \\alpha}{B}$：反转点和磁场达到其最小值 $B_{\\min}$ 的点。在 $B_{\\min}$ 的位置，设螺距角为 $\\alpha_{\\min}$。将这两点的不变量相等，得到：\n$$ \\frac{\\sin^2 \\alpha_{\\min}}{B_{\\min}} = \\frac{1}{B_{\\text{turn}}} $$\n这使我们能够确定一个在低场点具有螺距角 $\\alpha_{\\min}$ 的粒子将被反射的磁场强度：\n$$ B_{\\text{turn}} = \\frac{B_{\\min}}{\\sin^2 \\alpha_{\\min}} $$\n\n如果一个粒子的反转点发生在场强 $B_{\\text{turn}} \\le B_{\\max}$ 处，那么它就被捕获在 $B_{\\min}$ 和 $B_{\\max}$ 之间的磁阱中。这导致了对初始螺距角 $\\alpha_{\\min}$ 的捕获条件：\n$$ \\frac{B_{\\min}}{\\sin^2 \\alpha_{\\min}} \\le B_{\\max} $$\n整理这个不等式，得到捕获的基本条件：\n$$ \\sin^2 \\alpha_{\\min} \\ge \\frac{B_{\\min}}{B_{\\max}} $$\n\n接下来，我们计算满足此条件的粒子所占的份额。问题陈述中指出，速度空间分布是各向同性的，意味着粒子速度矢量在所有立体角上均匀分布。因此，捕获粒子的份额 $f_t$ 是对应于速度空间中捕获区域的立体角与球体总立体角 $4\\pi$ 的比值。\n\n球形速度坐标中的立体角元为 $d\\Omega = \\sin\\alpha \\, d\\alpha \\, d\\phi$。我们对满足捕获条件的螺距角区域进行积分。设磁镜比为 $R = B_{\\max}/B_{\\min}$。条件是 $\\sin^2 \\alpha_{\\min} \\ge 1/R$。我们定义一个临界角 $\\alpha_c \\in [0, \\pi/2]$，使得 $\\sin \\alpha_c = 1/\\sqrt{R}$。捕获条件变为 $|\\sin \\alpha_{\\min}| \\ge \\sin \\alpha_c$。由于 $\\alpha_{\\min}$ 的范围是从 $0$ 到 $\\pi$，这对应于区间 $\\alpha_{\\min} \\in [\\alpha_c, \\pi - \\alpha_c]$。速度空间中的这个区域是环绕赤道的一个“带”，而“通行”粒子占据两极的锥体（损失锥）。\n\n捕获粒子的立体角为：\n$$ \\Omega_{\\text{trapped}} = \\int_0^{2\\pi} d\\phi \\int_{\\alpha_c}^{\\pi-\\alpha_c} \\sin \\alpha_{\\min} \\, d\\alpha_{\\min} $$\n$$ \\Omega_{\\text{trapped}} = 2\\pi \\left[ -\\cos \\alpha_{\\min} \\right]_{\\alpha_c}^{\\pi-\\alpha_c} = 2\\pi (-\\cos(\\pi - \\alpha_c) - (-\\cos \\alpha_c)) $$\n$$ \\Omega_{\\text{trapped}} = 2\\pi (\\cos \\alpha_c + \\cos \\alpha_c) = 4\\pi \\cos \\alpha_c $$\n\n捕获粒子份额是该立体角与总立体角 $4\\pi$ 的比值：\n$$ f_t = \\frac{\\Omega_{\\text{trapped}}}{\\Omega_{\\text{total}}} = \\frac{4\\pi \\cos \\alpha_c}{4\\pi} = \\cos \\alpha_c $$\n使用恒等式 $\\cos^2 \\alpha_c + \\sin^2 \\alpha_c = 1$，并且知道 $\\alpha_c$ 在第一象限，我们有 $\\cos \\alpha_c = \\sqrt{1 - \\sin^2 \\alpha_c}$。代入 $\\sin \\alpha_c = 1/\\sqrt{R}$：\n$$ f_t = \\sqrt{1 - \\frac{1}{R}} $$\n最后，代入 $R = B_{\\max}/B_{\\min}$，我们得到所需的封闭形式表达式：\n$$ f_t = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}} $$\n\n对于任务的计算部分，我们将实现这个结果。沿磁力线的磁场强度 $B(\\theta)$ 对两种位形给出。对于托卡马克：\n$$ B_{\\mathrm{tok}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta} $$\n对于仿星器，增加了螺旋纹波：\n$$ B_{\\mathrm{stel}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta} \\, \\left(1 + \\delta \\cos(N \\theta)\\right) $$\n其中参数为轴上磁场 $B_0$、大半径 $R_0$、小半径 $r$、纹波幅度 $\\delta$ 和场周期数 $N$。\n\n对于每个测试案例，流程如下：\n1. 用 $N_\\theta = 2000$ 个在区间 $[0, 2\\pi)$ 内均匀分布的点对角向角 $\\theta$ 进行采样。\n2. 使用适当的公式和参数在每个采样点处评估 $B(\\theta)$。\n3. 通过在 $B(\\theta)$ 值数组中寻找最大值和最小值来数值确定 $B_{\\max}$ 和 $B_{\\min}$。\n4. 计算磁镜比 $R = B_{\\max} / B_{\\min}$。\n5. 计算捕获份额 $f_t = \\sqrt{1 - 1/R}$。\n\n此方法将应用于四个指定的测试案例，以评估几何形状（环径比 $r/R_0$）和螺旋纹波对粒子约束的影响。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the trapped-particle fraction f_t for various magnetic\n    confinement configurations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (B0, R0, r, delta, N)\n    # delta=None and N=None indicates a tokamak configuration.\n    test_cases = [\n        # Case 1 (tokamak, general case)\n        (5.0, 3.0, 0.3, None, None),\n        # Case 2 (tokamak, near-uniform B, boundary case)\n        (5.0, 3.0, 0.001, None, None),\n        # Case 3 (stellarator, moderate ripple)\n        (5.0, 3.0, 0.3, 0.06, 5),\n        # Case 4 (stellarator, stronger ripple, multiple wells)\n        (5.0, 3.0, 0.2, 0.25, 10),\n    ]\n\n    # Sampling requirement\n    N_theta = 2000\n    theta = np.linspace(0, 2 * np.pi, N_theta, endpoint=False)\n\n    results = []\n    \n    for case in test_cases:\n        B0, R0, r, delta, N = case\n\n        # Calculate the magnetic field magnitude B(theta) along the field line.\n        # This is the toroidal curvature term common to both models.\n        B_toroidal_part = B0 * (R0 / (R0 + r * np.cos(theta)))\n\n        if delta is None and N is None:\n            # Tokamak configuration\n            B_field = B_toroidal_part\n        else:\n            # Stellarator configuration with helical ripple\n            # The condition 1 + delta * cos(N*theta) > 0 is met by the problem parameters.\n            ripple_part = 1 + delta * np.cos(N * theta)\n            B_field = B_toroidal_part * ripple_part\n\n        # Find the maximum and minimum magnetic field strengths.\n        B_max = np.max(B_field)\n        B_min = np.min(B_field)\n\n        # Ensure B_max is not zero to avoid division by zero.\n        # This is physically guaranteed as B0 > 0.\n        if B_max > 0:\n            # Calculate the mirror ratio R.\n            # R is guaranteed to be >= 1 by definition of B_max and B_min.\n            mirror_ratio = B_max / B_min\n\n            # Calculate the trapped-particle fraction f_t using the derived formula.\n            # The argument of the square root is 1 - 1/R, which is >= 0.\n            f_t = np.sqrt(1 - 1 / mirror_ratio)\n        else: # This case should not be reached with the given test data\n            f_t = 0.0\n\n        results.append(f_t)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在单粒子行为之上，等离子体的宏观稳定性是决定聚变装置性能的另一个核心要素。磁流体（MHD）不稳定性，例如在有理磁面上产生的撕裂模，会严重限制装置的运行参数。磁剪切，即安全因子 $q$ 的径向梯度，对于抑制这些不稳定性至关重要。本练习  让你通过分析不同的安全因子剖面，定位有理磁面，并使用一个简化的模型来评估和比较不同运行模式下对撕裂模不稳定性的敏感度。",
            "id": "4004674",
            "problem": "在磁约束聚变中，安全因子 $q(r)$ 标记了共振或有理磁面，在这些磁面上，磁力线经过整数圈的极向和环向渡越后闭合，由 $q = m/n$ 指定，其中 $m$ 和 $n$ 为整数。这些有理面的分布和局部磁剪切影响了对电阻性磁流体动力学（MHD）撕裂不稳定性的易感性。为简化起见，在大环径比圆形几何中，我们将磁剪切定义为无量纲量 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$，它衡量 $q$ 相对于其大小的径向变化。\n\n考虑两种小半径为 $a = 1$ 的轴对称位形，其安全因子剖面表示如下：\n- 位形 $\\mathrm{T}$ (常规托卡马克): $q_{\\mathrm{T}}(r) = q_{0,\\mathrm{T}} + \\alpha_{\\mathrm{T}} \\left(\\frac{r}{a}\\right)^{2}$，其中 $q_{0,\\mathrm{T}} = 0.9$，$\\alpha_{\\mathrm{T}} = 2.5$。\n- 位形 $\\mathrm{R}$ (反剪切托卡马克): $q_{\\mathrm{R}}(r) = 1.8 + 1.6 \\left[\\left(\\frac{r}{a}\\right)^{2} - 0.4\\right]^{2}$。\n\n根据安全因子的定义和给定的剖面，完成以下任务：\n1. 在每种位形中，对于低阶有理数集合 $\\{2/1,\\,3/2,\\,4/3,\\,5/3,\\,7/3\\}$，确定满足 $q(r_{m/n}) = m/n$ 的径向位置 $r_{m/n}$，并只保留位于 $0 \\le r \\le a$ 范围内的解。\n2. 使用从给定 $q(r)$ 导出的 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$，计算每个共振面上的磁剪切 $s(r_{m/n})$。\n3. 使用一个撕裂模易感性的简单代理指标，将 $S$ 定义为对所考虑的共振面上的绝对剪切倒数求和，即 $S \\equiv \\sum_{m/n} \\frac{1}{|s(r_{m/n})|}$，并计算两种位形的 $S_{\\mathrm{T}}$ 和 $S_{\\mathrm{R}}$。\n4. 报告比值 $\\mathcal{R} \\equiv \\frac{S_{\\mathrm{T}}}{S_{\\mathrm{R}}}$。\n\n将最终比值 $\\mathcal{R}$ 表示为一个无量纲数。将您的答案四舍五入至四位有效数字。",
            "solution": "用户提供了一个在计算聚变科学领域内提法明确、有科学依据的问题，有必要给出一个严谨的、分步的解答。我们将通过分别分析每种磁位形，来确定指定有理面的位置以及这些位置的磁剪切，从而解决这个问题。然后，这些值将被用来计算每种情况下撕裂模易感性的代理指标，并最终计算它们的比值。所有计算都将使用给定的参数和定义进行。给定的小半径为 $a=1$，这通过对所有径向坐标进行归一化简化了表达式。\n\n首先，我们分析位形 $\\mathrm{T}$ (常规托卡马克)。其安全因子剖面由下式给出：\n$$q_{\\mathrm{T}}(r) = q_{0,\\mathrm{T}} + \\alpha_{\\mathrm{T}} \\left(\\frac{r}{a}\\right)^{2}$$\n当 $q_{0,\\mathrm{T}} = 0.9$，$\\alpha_{\\mathrm{T}} = 2.5$ 且 $a=1$ 时，剖面为：\n$$q_{\\mathrm{T}}(r) = 0.9 + 2.5 r^{2}$$\n对于 $r \\in [0, 1]$，$q_{\\mathrm{T}}(r)$ 的范围是从 $q_{\\mathrm{T}}(0) = 0.9$ 到 $q_{\\mathrm{T}}(1) = 0.9 + 2.5 = 3.4$。指定集合 $\\{2/1, 3/2, 4/3, 5/3, 7/3\\}$ 中的所有有理数值都位于此范围内，因此每个值都存在一个相应的共振面。这些值分别为 $2$、$1.5$、约 $1.333$、约 $1.667$ 和约 $2.333$。\n\n磁剪切 $s(r)$ 定义为 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$。对于位形 $\\mathrm{T}$，q剖面的导数为：\n$$\\frac{dq_{\\mathrm{T}}}{dr} = \\frac{d}{dr}(0.9 + 2.5 r^{2}) = 5r$$\n那么，剪切为：\n$$s_{\\mathrm{T}}(r) = \\frac{r}{q_{\\mathrm{T}}(r)} (5r) = \\frac{5r^{2}}{q_{\\mathrm{T}}(r)}$$\n在一个共振面 $r_{m/n}$ 上，我们有 $q_{\\mathrm{T}}(r_{m/n}) = m/n$。我们可以从q剖面中表示出 $r^2$：$2.5r^2 = q_{\\mathrm{T}}(r) - 0.9$，所以 $5r^2 = 2(q_{\\mathrm{T}}(r) - 0.9)$。将此代入剪切表达式中，可以得到一个只依赖于 $q$ 值的简化形式：\n$$s_{\\mathrm{T}}(r_{m/n}) = \\frac{2(q_{\\mathrm{T}}(r_{m/n}) - 0.9)}{q_{\\mathrm{T}}(r_{m/n})} = 2\\left(1 - \\frac{0.9}{m/n}\\right)$$\n我们现在计算每个有理面上的剪切 $s_{\\mathrm{T}}$：\n- 对于 $q = 2/1 = 2$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{2}) = 2(0.55) = 1.1$。\n- 对于 $q = 3/2 = 1.5$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{1.5}) = 2(1 - 0.6) = 0.8$。\n- 对于 $q = 4/3$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{4/3}) = 2(1 - \\frac{2.7}{4}) = 2(1 - 0.675) = 0.65$。\n- 对于 $q = 5/3$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{5/3}) = 2(1 - \\frac{2.7}{5}) = 2(1 - 0.54) = 0.92$。\n- 对于 $q = 7/3$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{7/3}) = 2(1 - \\frac{2.7}{7}) = 2(\\frac{4.3}{7}) = \\frac{8.6}{7}$。\n所有剪切值均为正，因此 $|s_{\\mathrm{T}}| = s_{\\mathrm{T}}$。易感性代理指标 $S_{\\mathrm{T}}$ 是剪切倒数之和：\n$$S_{\\mathrm{T}} = \\sum_{m/n} \\frac{1}{|s_{\\mathrm{T}}(r_{m/n})|} = \\frac{1}{1.1} + \\frac{1}{0.8} + \\frac{1}{0.65} + \\frac{1}{0.92} + \\frac{7}{8.6}$$\n$$S_{\\mathrm{T}} \\approx 0.909091 + 1.25 + 1.538462 + 1.086957 + 0.813953 \\approx 5.598463$$\n\n接下来，我们分析位形 $\\mathrm{R}$ (反剪切托卡马克)。其安全因子剖面为：\n$$q_{\\mathrm{R}}(r) = 1.8 + 1.6 \\left[\\left(\\frac{r}{a}\\right)^{2} - 0.4\\right]^{2} = 1.8 + 1.6(r^2 - 0.4)^2$$\n该剖面是非单调的。$q_{\\mathrm{R}}$ 的最小值出现在 $(r^2 - 0.4)^2 = 0$ 时，即 $r = \\sqrt{0.4}$。最小值为 $q_{min} = 1.8$。磁轴上的值为 $q_{\\mathrm{R}}(0) = 1.8 + 1.6(-0.4)^2 = 1.8 + 0.256 = 2.056$。边界上的值为 $q_{\\mathrm{R}}(1) = 1.8 + 1.6(1-0.4)^2 = 1.8 + 0.576 = 2.376$。对于 $r \\in [0,1]$，$q_{\\mathrm{R}}$ 的范围是 $[1.8, 2.376]$。\n我们检查给定的有理数中有哪些落在这个范围内：\n- $q = 2$: 是，$1.8 \\le 2 \\le 2.376$。\n- $q = 1.5$: 否。\n- $q = 4/3 \\approx 1.333$: 否。\n- $q = 5/3 \\approx 1.667$: 否。\n- $q = 7/3 \\approx 2.333$: 是，$1.8 \\le 7/3 \\le 2.376$。\n因此，在该位形中只存在 $q=2$ 和 $q=7/3$ 的磁面。\n\n我们通过求解 $q_{\\mathrm{R}}(r) = m/n$ 来找到径向位置 $r_{m/n}$：\n$$(r^2 - 0.4)^2 = \\frac{(m/n) - 1.8}{1.6} \\implies r^2 = 0.4 \\pm \\sqrt{\\frac{(m/n) - 1.8}{1.6}}$$\n对于 $q = 2$：\n$$r^2 = 0.4 \\pm \\sqrt{\\frac{2 - 1.8}{1.6}} = 0.4 \\pm \\sqrt{0.125} = 0.4 \\pm \\frac{1}{2\\sqrt{2}} = 0.4 \\pm \\frac{\\sqrt{2}}{4}$$\n这给出了两个 $r^2$ 的解，它们都为正且小于1，因此存在两个磁面：$r^2_{2/1,1} \\approx 0.04645$ 和 $r^2_{2/1,2} \\approx 0.75355$。\n对于 $q = 7/3$：\n$$r^2 = 0.4 \\pm \\sqrt{\\frac{7/3 - 1.8}{1.6}} = 0.4 \\pm \\sqrt{\\frac{8/15}{8/5}} = 0.4 \\pm \\sqrt{1/3}$$\n解 $r^2 = 0.4 - 1/\\sqrt{3}$ 是负数，因此是非物理的。另一个解是 $r^2_{7/3} = 0.4 + 1/\\sqrt{3} \\approx 0.97735$，是有效的。因此，对于 $q=7/3$ 只有一个磁面。\n\n$q_{\\mathrm{R}}(r)$ 的导数是：\n$$\\frac{dq_{\\mathrm{R}}}{dr} = 1.6 \\cdot 2(r^2 - 0.4) \\cdot 2r = 6.4r(r^2 - 0.4)$$\n剪切为：\n$$s_{\\mathrm{R}}(r) = \\frac{r}{q_{\\mathrm{R}}(r)} \\frac{dq_{\\mathrm{R}}}{dr} = \\frac{6.4r^2(r^2-0.4)}{q_{\\mathrm{R}}(r)}$$\n我们计算已确定的三个磁面各自的剪切：\n- 对于 $q=2$，磁面1：$r^2 = 0.4 - \\frac{\\sqrt{2}}{4}$。所以 $r^2-0.4 = -\\frac{\\sqrt{2}}{4}$。\n$$s_{2/1,1} = \\frac{6.4(0.4 - \\frac{\\sqrt{2}}{4})(-\\frac{\\sqrt{2}}{4})}{2} = 3.2(0.4 - \\frac{\\sqrt{2}}{4})(-\\frac{\\sqrt{2}}{4}) = 0.4 - 0.32\\sqrt{2} \\approx -0.052548$$\n- 对于 $q=2$，磁面2：$r^2 = 0.4 + \\frac{\\sqrt{2}}{4}$。所以 $r^2-0.4 = +\\frac{\\sqrt{2}}{4}$。\n$$s_{2/1,2} = \\frac{6.4(0.4 + \\frac{\\sqrt{2}}{4})(\\frac{\\sqrt{2}}{4})}{2} = 3.2(0.4 + \\frac{\\sqrt{2}}{4})(\\frac{\\sqrt{2}}{4}) = 0.4 + 0.32\\sqrt{2} \\approx 0.852548$$\n- 对于 $q=7/3$：$r^2 = 0.4 + 1/\\sqrt{3}$。所以 $r^2-0.4 = 1/\\sqrt{3}$。\n$$s_{7/3} = \\frac{6.4(0.4 + 1/\\sqrt{3})(1/\\sqrt{3})}{7/3} = \\frac{19.2}{7}\\left(\\frac{0.4}{\\sqrt{3}} + \\frac{1}{3}\\right) = \\frac{6.4}{35}(2\\sqrt{3}+5) \\approx 1.547436$$\n易感性代理指标 $S_{\\mathrm{R}}$ 是绝对剪切倒数之和：\n$$S_{\\mathrm{R}} = \\frac{1}{|-0.052548|} + \\frac{1}{|0.852548|} + \\frac{1}{|1.547436|}$$\n$$S_{\\mathrm{R}} \\approx 19.02999 + 1.17295 + 0.64622 \\approx 20.84916$$\n\n最后，我们计算比值 $\\mathcal{R} = S_{\\mathrm{T}} / S_{\\mathrm{R}}$：\n$$\\mathcal{R} = \\frac{5.598463}{20.84916} \\approx 0.268522$$\n四舍五入到四位有效数字，我们得到 $\\mathcal{R} = 0.2685$。这个结果表明，在这个简化模型中，反剪切位形（位形 R）表现出对撕裂不稳定性大得多的易感性，其主要贡献来自q最小值附近的极低剪切区域。",
            "answer": "$$\\boxed{0.2685}$$"
        },
        {
            "introduction": "最后，我们将视角从核心等离子体物理扩展到整个聚变反应堆系统。磁约束构型的选择会对第一壁和包层等工程部件产生连锁效应，引发一系列设计权衡。本练习  探讨了中子壁负载（影响材料寿命）与氚增殖（燃料自持的关键）之间的权衡关系，展示了托卡马克和仿星器不同的几何特征如何导致截然不同的工程挑战和设计选择。",
            "id": "4004673",
            "problem": "一位反应堆工程师正在比较两种磁约束位型在聚变功率相等情况下的中子壁负载：一种是具有圆形截面的轴对称托卡马克，另一种是具有可比等离子体体积但由于其三维几何形状而增加了第一壁表面积的仿星器。从能量守恒和壁负载定义（单位面积上的入射中子功率）出发，推导比例关系 $W_{n} \\propto P_{\\text{fus}}/A_{\\text{wall}}$，过程中不得引用任何预先推导的简化公式。利用氘-氚聚变反应中，中子携带每次反应总聚变能的固定比例 $f_{n}$ 这一事实。明确说明你对中子从等离子体边缘发射到第一壁之间的输运过程所做的任何假设。\n\n然后，将两种装置都建模为环体。对于托卡马克，用圆形环体的表面积近似第一壁面积，即 $A_{\\text{T}} \\approx 4\\pi^{2} R a$，其中 $R$ 是大半径，$a$ 是小半径。对于仿星器，近似为 $A_{\\text{S}} = \\kappa A_{\\text{T}}$，其中 $\\kappa>1$ 是一个由几何形状引起的面积因子。假设以下参数：\n- 聚变功率 $P_{\\text{fus}} = 2.0 \\times 10^{9}\\ \\text{W}$。\n- 氘-氚聚变的中子能量分数 $f_{n} = 14.1/17.6$。\n- 托卡马克几何参数：$R = 7.0\\ \\text{m}$ 和 $a = 2.0\\ \\text{m}$。\n- 仿星器面积因子：$\\kappa = 1.5$。\n\n在增殖包层中假设一个简化的一维衰减模型：包层背板的中子热通量为 $q_{\\text{back}}(t) = W_{n}\\exp(-t/\\lambda)$，其中 $t$ 是包层厚度，$\\lambda$ 是有效衰减长度。在结构界面处施加一个热通量限制 $q_{\\max} = 1.0 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$，并设 $\\lambda = 0.12\\ \\text{m}$。\n\n同时，使用参数化响应模型施加一个氚增殖比（TBR）约束：$ \\text{TBR}(t) = c\\beta(1-\\exp(-t/\\delta))$，其中 $c$ 是包层覆盖率，$\\beta$ 是对于选定材料和增殖剂的极厚包层的渐近TBR，$\\delta$ 是特征增殖饱和长度。使用托卡马克的 $c_{\\text{T}} = 0.90$，仿星器的 $c_{\\text{S}} = 0.80$，$\\beta = 1.40$，$\\delta = 0.10\\ \\text{m}$，并强制要求 $\\text{TBR}_{\\min} = 1.10$。\n\n任务：\n1. 从第一性原理和定义出发，推导比例关系 $W_{n} \\propto P_{\\text{fus}}/A_{\\text{wall}}$，并在你所陈述的假设下，明确地用 $P_{\\text{fus}}$、$f_{n}$ 和 $A_{\\text{wall}}$ 表示 $W_{n}$。\n2. 使用给定参数计算每种位型的 $W_{n}$。\n3. 确定每种位型下同时满足热通量限制和氚增殖比要求的最小包层厚度 $t$。起决定性作用的 $t$ 是每种位型中两个约束条件所要求的最大厚度。\n4. 提供最小包层厚度对 $(t_{\\text{T}}, t_{\\text{S}})$（单位为米）作为你的最终答案。将你的数值结果四舍五入至三位有效数字。最终厚度以 $\\text{m}$ 表示。\n\n在你的推导和计算中，所有数学符号和数字都保留为LaTeX格式。最终答案必须是包含两个元素的单行矩阵。",
            "solution": "该问题被评估为有效，因为它科学地基于聚变能的既定原理，问题设定良好，具有完整且一致的参数集，并且其表述是客观的。它要求进行一系列在概念性聚变反应堆分析中属于标准操作的推导和计算。\n\n**1. 中子壁负载比例关系的推导**\n\n总聚变功率 $P_{\\text{fus}}$ 代表单位时间内所有聚变反应释放的总能量。对于氘-氚（D-T）反应，会释放特定量的能量 $E_{\\text{fus,reaction}}$。因此，总聚变反应率 $R_{\\text{fus}}$ 由下式给出：\n$$R_{\\text{fus}} = \\frac{P_{\\text{fus}}}{E_{\\text{fus,reaction}}}$$\n在D-T反应中，总能量被分配给一个α粒子和一个中子。题目指出，中子携带了总能量的一个固定比例 $f_{n}$。单个中子携带的能量为 $E_{n} = f_{n} E_{\\text{fus,reaction}}$。等离子体中产生的所有中子携带的总功率 $P_{n}$ 是反应率乘以每个中子的能量：\n$$P_{n} = R_{\\text{fus}} \\times E_{n} = \\left(\\frac{P_{\\text{fus}}}{E_{\\text{fus,reaction}}}\\right) \\times (f_{n} E_{\\text{fus,reaction}}) = f_{n} P_{\\text{fus}}$$\n中子壁负载 $W_{n}$ 定义为入射到第一壁上的中子功率除以该壁的单位面积 $A_{\\text{wall}}$。为了将 $P_{n}$ 与 $W_{n}$ 联系起来，我们对中子输运做如下假设：\n1.  中子从等离子体体积中各向同性地发射。\n2.  中子从其产生点沿直线传播至第一壁，在等离子体体积内或等离子体与壁之间的真空间隙中，其衰减或相互作用可忽略不计。\n\n在这些假设下，等离子体内产生的总中子功率 $P_{n}$ 等于入射到整个第一壁表面的总中子功率。因此，我们可以将壁负载写为：\n$$W_{n} = \\frac{P_{n}}{A_{\\text{wall}}}$$\n代入 $P_{n}$ 的表达式，我们得到明确的关系式：\n$$W_{n} = \\frac{f_{n} P_{\\text{fus}}}{A_{\\text{wall}}}$$\n由于对于D-T聚变而言 $f_{n}$ 是一个常数，而 $P_{\\text{fus}}$ 是一个指定的运行参数，此推导显示了所要求的比例关系 $W_{n} \\propto P_{\\text{fus}}/A_{\\text{wall}}$。\n\n**2. 计算每种位型的中子壁负载 ($W_{n}$)**\n\n我们给定的参数如下：$P_{\\text{fus}} = 2.0 \\times 10^{9}\\ \\text{W}$ 和 $f_{n} = 14.1/17.6$。\n总中子功率为 $P_{n} = f_{n} P_{\\text{fus}} = (14.1/17.6) \\times (2.0 \\times 10^{9}\\ \\text{W}) \\approx 1.6023 \\times 10^{9}\\ \\text{W}$。\n\n对于托卡马克：\n第一壁面积 $A_{\\text{T}}$ 由一个大半径 $R = 7.0\\ \\text{m}$、小半径 $a = 2.0\\ \\text{m}$ 的圆形环体表面积来近似。\n$$A_{\\text{T}} = 4\\pi^{2} R a = 4\\pi^{2} (7.0\\ \\text{m})(2.0\\ \\text{m}) = 56\\pi^{2}\\ \\text{m}^{2}$$\n托卡马克的中子壁负载 $W_{n, \\text{T}}$ 为：\n$$W_{n, \\text{T}} = \\frac{f_{n} P_{\\text{fus}}}{A_{\\text{T}}} = \\frac{(14.1/17.6) \\times (2.0 \\times 10^{9}\\ \\text{W})}{56\\pi^{2}\\ \\text{m}^{2}} \\approx 2.900 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$$\n\n对于仿星器：\n第一壁面积 $A_{\\text{S}}$ 由 $A_{\\text{S}} = \\kappa A_{\\text{T}}$ 给出，其中 $\\kappa = 1.5$。\n$$A_{\\text{S}} = 1.5 \\times (56\\pi^{2}\\ \\text{m}^{2}) = 84\\pi^{2}\\ \\text{m}^{2}$$\n仿星器的中子壁负载 $W_{n, \\text{S}}$ 为：\n$$W_{n, \\text{S}} = \\frac{f_{n} P_{\\text{fus}}}{A_{\\text{S}}} = \\frac{f_{n} P_{\\text{fus}}}{\\kappa A_{\\text{T}}} = \\frac{W_{n, \\text{T}}}{\\kappa} = \\frac{2.900 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}}{1.5} \\approx 1.933 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$$\n\n**3. 确定最小包层厚度 ($t$)**\n\n对于每种位型，我们必须找到满足两个约束条件的最小厚度 $t$：一个热通量限制和一个氚增殖比（TBR）要求。起决定性作用的厚度是两个单独最小厚度中的最大值。\n\n**约束1：热通量限制**\n包层背板的热通量 $q_{\\text{back}}(t)$ 不得超过 $q_{\\max} = 1.0 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$。\n模型为 $q_{\\text{back}}(t) = W_{n}\\exp(-t/\\lambda)$。约束条件是 $W_{n}\\exp(-t/\\lambda) \\le q_{\\max}$。\n为了找到最小厚度 $t_{q}$，我们解如下等式：\n$$W_{n}\\exp(-t_{q}/\\lambda) = q_{\\max} \\implies \\exp(-t_{q}/\\lambda) = \\frac{q_{\\max}}{W_{n}}$$\n$$-t_{q}/\\lambda = \\ln\\left(\\frac{q_{\\max}}{W_{n}}\\right) \\implies t_{q} = -\\lambda \\ln\\left(\\frac{q_{\\max}}{W_{n}}\\right) = \\lambda \\ln\\left(\\frac{W_{n}}{q_{\\max}}\\right)$$\n给定 $\\lambda = 0.12\\ \\text{m}$。\n\n**约束2：氚增殖比（TBR）限制**\nTBR必须至少为 $\\text{TBR}_{\\min} = 1.10$。\n模型为 $\\text{TBR}(t) = c\\,\\beta\\left(1-\\exp(-t/\\delta)\\right)$。约束条件是 $c\\,\\beta\\left(1-\\exp(-t/\\delta)\\right) \\ge \\text{TBR}_{\\min}$。\n为了找到最小厚度 $t_{\\text{TBR}}$，我们解如下等式：\n$$c\\,\\beta\\left(1-\\exp(-t_{\\text{TBR}}/\\delta)\\right) = \\text{TBR}_{\\min} \\implies 1-\\exp(-t_{\\text{TBR}}/\\delta) = \\frac{\\text{TBR}_{\\min}}{c\\beta}$$\n$$\\exp(-t_{\\text{TBR}}/\\delta) = 1 - \\frac{\\text{TBR}_{\\min}}{c\\beta} \\implies t_{\\text{TBR}} = -\\delta \\ln\\left(1 - \\frac{\\text{TBR}_{\\min}}{c\\beta}\\right)$$\n给定 $\\delta = 0.10\\ \\text{m}$ 和 $\\beta = 1.40$。\n\n**托卡马克的计算：**\n使用 $W_{n, \\text{T}} \\approx 2.900 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$ 和 $c_{\\text{T}} = 0.90$。\n-   热通量约束厚度，$t_{q, \\text{T}}$：\n    $$t_{q, \\text{T}} = (0.12\\ \\text{m}) \\ln\\left(\\frac{2.900 \\times 10^{6}}{1.0 \\times 10^{6}}\\right) = (0.12\\ \\text{m}) \\ln(2.900) \\approx 0.1278\\ \\text{m}$$\n-   TBR约束厚度，$t_{\\text{TBR, T}}$：\n    $$c_{\\text{T}}\\beta = 0.90 \\times 1.40 = 1.26$$\n    $$t_{\\text{TBR, T}} = -(0.10\\ \\text{m}) \\ln\\left(1 - \\frac{1.10}{1.26}\\right) \\approx -(0.10\\ \\text{m}) \\ln(1 - 0.8730) = -(0.10\\ \\text{m}) \\ln(0.1270) \\approx 0.2064\\ \\text{m}$$\n托卡马克所需的最小包层厚度 $t_{\\text{T}}$ 是这两个值的最大值：\n$$t_{\\text{T}} = \\max(t_{q, \\text{T}}, t_{\\text{TBR, T}}) = \\max(0.1278\\ \\text{m}, 0.2064\\ \\text{m}) = 0.2064\\ \\text{m}$$\n四舍五入至三位有效数字， $t_{\\text{T}} = 0.206\\ \\text{m}$。\n\n**仿星器的计算：**\n使用 $W_{n, \\text{S}} \\approx 1.933 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$ 和 $c_{\\text{S}} = 0.80$。\n-   热通量约束厚度，$t_{q, \\text{S}}$：\n    $$t_{q, \\text{S}} = (0.12\\ \\text{m}) \\ln\\left(\\frac{1.933 \\times 10^{6}}{1.0 \\times 10^{6}}\\right) = (0.12\\ \\text{m}) \\ln(1.933) \\approx 0.0791\\ \\text{m}$$\n-   TBR约束厚度，$t_{\\text{TBR, S}}$：\n    $$c_{\\text{S}}\\beta = 0.80 \\times 1.40 = 1.12$$\n    $$t_{\\text{TBR, S}} = -(0.10\\ \\text{m}) \\ln\\left(1 - \\frac{1.10}{1.12}\\right) \\approx -(0.10\\ \\text{m}) \\ln(1 - 0.9821) = -(0.10\\ \\text{m}) \\ln(0.0179) \\approx 0.4025\\ \\text{m}$$\n仿星器所需的最小包层厚度 $t_{\\text{S}}$ 是这两个值的最大值：\n$$t_{\\text{S}} = \\max(t_{q, \\text{S}}, t_{\\text{TBR, S}}) = \\max(0.0791\\ \\text{m}, 0.4025\\ \\text{m}) = 0.4025\\ \\text{m}$$\n四舍五入至三位有效数字， $t_{\\text{S}} = 0.403\\ \\text{m}$。\n\n**4. 最终答案**\n\n最小包层厚度对 $(t_{\\text{T}}, t_{\\text{S}})$，四舍五入至三位有效数字后，为 $(0.206\\ \\text{m}, 0.403\\ \\text{m})$。\n\n对于托卡马克，TBR要求（$t=0.206\\ \\text{m}$）是起决定性作用的约束条件，比热通量限制（$t=0.128\\ \\text{m}$）更为苛刻。对于仿星器，较低的壁负载显著放宽了热通量约束（$t=0.079\\ \\text{m}$），但较低的包层覆盖率（$c_S = 0.80$ vs $c_T = 0.90$）使得TBR要求更难满足，需要一个厚得多的包层（$t=0.403\\ \\text{m}$）。这说明了在不同磁约束几何构型中，管理表面热负荷与实现氚自持之间的一个关键工程权衡。",
            "answer": "$$\n\\boxed{\\begin{pmatrix}\n0.206  0.403\n\\end{pmatrix}}\n$$"
        }
    ]
}