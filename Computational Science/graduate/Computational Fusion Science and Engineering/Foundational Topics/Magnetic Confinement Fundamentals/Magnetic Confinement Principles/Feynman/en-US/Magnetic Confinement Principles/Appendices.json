{
    "hands_on_practices": [
        {
            "introduction": "The stability of a tokamak plasma is critically dependent on the pitch of the helical magnetic field lines, quantified by the safety factor, $q$. This first exercise  provides practice in deriving the radial profile of $q(r)$ from first principles in a simplified cylindrical geometry. Mastering this calculation is a crucial first step in understanding how the plasma's internal current distribution dictates its overall stability.",
            "id": "320519",
            "problem": "Consider a large aspect-ratio tokamak, which can be approximated by a cylindrical plasma column of minor radius $a$ and length $2\\pi R_0$, where $R_0$ is the major radius. The strong, externally applied toroidal magnetic field is assumed to be uniform across the plasma cross-section, given by $\\mathbf{B}_z = B_0 \\mathbf{\\hat{z}}$. The plasma carries a total toroidal current $I_p$, which generates the poloidal magnetic field $\\mathbf{B}_\\theta(r) = B_\\theta(r) \\mathbf{\\hat{\\theta}}$.\n\nThe radial profile of the toroidal current density, $J_z(r)$, is given by a parabolic form:\n$$J_z(r) = J_0 \\left(1 - \\frac{r^2}{a^2}\\right)$$\nfor $0 \\le r \\le a$, and $J_z(r) = 0$ for $r > a$. Here, $J_0$ is the current density on the magnetic axis ($r=0$).\n\nThe magnetohydrodynamic (MHD) stability of the plasma is critically dependent on the safety factor, $q(r)$, which measures the pitch of the magnetic field lines. In the cylindrical approximation, it is defined as:\n$$q(r) = \\frac{r B_z}{R_0 B_\\theta(r)}$$\nDerive the expression for the safety factor profile, $q(r)$, for $0 \\le r \\le a$. Your final answer must be expressed in terms of the radial coordinate $r$, the minor radius $a$, the major radius $R_0$, the toroidal field strength $B_0$, the total plasma current $I_p$, and the permeability of free space $\\mu_0$.",
            "solution": "The derivation begins by finding the poloidal magnetic field, $B_\\theta(r)$, generated by the toroidal current density, $J_z(r)$, using Ampere's law in integral form. For a circular loop of radius $r$ centered on the magnetic axis, Ampere's law is:\n$$\\oint \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}}(r)$$\nwhere $I_{\\text{enc}}(r)$ is the total current enclosed by the loop. Due to cylindrical symmetry, $B_\\theta$ is constant on the loop, so the line integral becomes:\n$$B_\\theta(r) (2\\pi r) = \\mu_0 \\int_0^r J_z(r') (2\\pi r') dr'$$\nSolving for $B_\\theta(r)$:\n$$B_\\theta(r) = \\frac{\\mu_0}{r} \\int_0^r J_z(r') r' dr'$$\nNow, substitute the given parabolic current density profile, $J_z(r') = J_0 \\left(1 - \\frac{(r')^2}{a^2}\\right)$:\n$$B_\\theta(r) = \\frac{\\mu_0 J_0}{r} \\int_0^r \\left(1 - \\frac{(r')^2}{a^2}\\right) r' dr'$$\n$$B_\\theta(r) = \\frac{\\mu_0 J_0}{r} \\int_0^r \\left(r' - \\frac{(r')^3}{a^2}\\right) dr'$$\nPerforming the integration:\n$$B_\\theta(r) = \\frac{\\mu_0 J_0}{r} \\left[ \\frac{(r')^2}{2} - \\frac{(r')^4}{4a^2} \\right]_0^r$$\n$$B_\\theta(r) = \\frac{\\mu_0 J_0}{r} \\left( \\frac{r^2}{2} - \\frac{r^4}{4a^2} \\right)$$\nSimplifying the expression for $B_\\theta(r)$:\n$$B_\\theta(r) = \\frac{\\mu_0 J_0 r}{2} \\left( 1 - \\frac{r^2}{2a^2} \\right)$$\nNext, we substitute this expression for $B_\\theta(r)$ into the definition of the safety factor $q(r)$:\n$$q(r) = \\frac{r B_z}{R_0 B_\\theta(r)} = \\frac{r B_0}{R_0 \\left[ \\frac{\\mu_0 J_0 r}{2} \\left( 1 - \\frac{r^2}{2a^2} \\right) \\right]}$$\n$$q(r) = \\frac{2 B_0}{\\mu_0 R_0 J_0 \\left( 1 - \\frac{r^2}{2a^2} \\right)}$$\nThe problem requires the final answer to be in terms of the total plasma current $I_p$, not the on-axis current density $J_0$. We find the relationship between $I_p$ and $J_0$ by integrating the current density over the entire plasma cross-section (from $r=0$ to $r=a$):\n$$I_p = \\int_0^a J_z(r) (2\\pi r) dr = 2\\pi \\int_0^a J_0 \\left(1 - \\frac{r^2}{a^2}\\right) r dr$$\n$$I_p = 2\\pi J_0 \\left[ \\frac{r^2}{2} - \\frac{r^4}{4a^2} \\right]_0^a$$\n$$I_p = 2\\pi J_0 \\left( \\frac{a^2}{2} - \\frac{a^4}{4a^2} \\right) = 2\\pi J_0 \\left( \\frac{a^2}{2} - \\frac{a^2}{4} \\right) = 2\\pi J_0 \\left( \\frac{a^2}{4} \\right)$$\n$$I_p = \\frac{\\pi a^2 J_0}{2}$$\nFrom this, we can express $J_0$ in terms of $I_p$:\n$$J_0 = \\frac{2 I_p}{\\pi a^2}$$\nFinally, we substitute this expression for $J_0$ into our equation for $q(r)$:\n$$q(r) = \\frac{2 B_0}{\\mu_0 R_0 \\left( \\frac{2 I_p}{\\pi a^2} \\right) \\left( 1 - \\frac{r^2}{2a^2} \\right)}$$\n$$q(r) = \\frac{\\pi a^2 B_0}{\\mu_0 R_0 I_p \\left( 1 - \\frac{r^2}{2a^2} \\right)}$$\nTo write this in a more compact form, we combine the terms in the denominator:\n$$1 - \\frac{r^2}{2a^2} = \\frac{2a^2 - r^2}{2a^2}$$\nSubstituting this back into the expression for $q(r)$:\n$$q(r) = \\frac{\\pi a^2 B_0}{\\mu_0 R_0 I_p} \\frac{1}{\\frac{2a^2-r^2}{2a^2}} = \\frac{2 \\pi a^4 B_0}{\\mu_0 R_0 I_p (2a^2 - r^2)}$$\nLet's use the slightly simpler form from the previous step, by multiplying the numerator and denominator by 2:\n$$q(r) = \\frac{\\pi a^2 B_0 (2)}{\\mu_0 R_0 I_p \\left( 1 - \\frac{r^2}{2a^2} \\right) (2)} = \\frac{2 \\pi a^2 B_0}{\\mu_0 R_0 I_p \\left( 2 - \\frac{r^2}{a^2} \\right)}$$\nThis is the final expression for the safety factor profile.",
            "answer": "$$ \\boxed{ \\frac{2 \\pi a^2 B_0}{\\mu_0 R_0 I_p \\left( 2 - \\frac{r^2}{a^2} \\right)} } $$"
        },
        {
            "introduction": "While a simple cylindrical model is instructive, a real tokamak's toroidal geometry introduces crucial new physics. This practice  challenges you to derive the expression for the parallel current, $j_{\\parallel}$, that must flow to maintain force balance in a torus, a phenomenon known as the Pfirsch-Schlüter effect. This exercise reveals the intricate connection between pressure gradients and the structure of plasma currents required for a stable equilibrium.",
            "id": "4004985",
            "problem": "Consider an axisymmetric, large–aspect-ratio toroidal plasma (tokamak) with circular, concentric magnetic flux surfaces. Let the major radius be $R_0$, minor radius coordinate $r$, and inverse aspect ratio $\\varepsilon \\equiv r/R_0 \\ll 1$. Use a straight-field-line poloidal angle $\\theta$ measured in radians. Assume magnetostatic equilibrium in ideal Magnetohydrodynamics (MHD), with scalar pressure $p$ that is a flux function, $p = p(\\psi)$, where $\\psi$ is the poloidal magnetic flux.\n\nThe magnetic field is axisymmetric with dominant toroidal component. To leading order in $\\varepsilon$, take the magnetic field magnitude on a given flux surface to be given by the toroidal-field variation\n$$\nB(\\theta) \\simeq B_0 \\frac{R_0}{R(\\theta)} \\quad \\text{with} \\quad R(\\theta) = R_0 + r \\cos\\theta = R_0\\left(1+\\varepsilon \\cos\\theta\\right),\n$$\nand define $I(\\psi) \\equiv R B_{\\phi}$ so that in the large–aspect-ratio, vacuum-toroidal-field limit $I(\\psi) \\approx B_0 R_0$ is independent of $\\theta$ on a given surface. You may neglect the poloidal-field contribution to $| \\mathbf{B} |$ in the magnitude wherever it is higher order in $\\varepsilon$.\n\nStarting only from the ideal MHD equilibrium force balance and current continuity,\n$$\n\\nabla p = \\mathbf{j} \\times \\mathbf{B}, \\qquad \\nabla \\cdot \\mathbf{j} = 0,\n$$\nperform the following:\n\n1. Decompose the current density into components perpendicular and parallel to the magnetic field, $\\mathbf{j} = \\mathbf{j}_{\\perp} + j_{\\parallel} \\mathbf{b}$ with $\\mathbf{b} \\equiv \\mathbf{B}/B$, and derive a field-line differential constraint that determines $j_{\\parallel}$ from $\\nabla \\cdot \\mathbf{j}_{\\perp}$.\n\n2. Specialize to axisymmetry with $p = p(\\psi)$, and use a standard axisymmetric representation of $\\mathbf{B}$ consistent with the Grad–Shafranov framework to reduce the field-line constraint to an integrable form for $j_{\\parallel}/B$ involving $p'(\\psi) \\equiv dp/d\\psi$, the function $I(\\psi)$, and the poloidal variation of $B(\\theta)$. Impose a flux-surface condition that selects the physically relevant integration constant by requiring the flux-surface average of $j_{\\parallel}/B$ to vanish.\n\n3. For a specific pressure profile $p(\\psi) = p_0 - \\alpha \\psi$ with constant $\\alpha > 0$, compute the poloidal variation $j_{\\parallel}(\\theta)$ on a given flux surface to first order in $\\varepsilon$, expressing the answer in closed form in terms of $\\alpha$, $\\varepsilon$, $R_0$, and $\\theta$.\n\nProvide the final result as a single closed-form analytic expression for $j_{\\parallel}(\\theta)$. If any approximation is needed, retain terms only up to first order in $\\varepsilon$. Angles must be expressed in radians. Do not evaluate numerically.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the field of computational fusion science and engineering, specifically concerning magnetohydrodynamic (MHD) equilibrium in a tokamak. The provided equations, definitions, and approximations are consistent with established plasma physics theory for a large–aspect-ratio, axisymmetric torus. All necessary information is provided to derive a unique, meaningful solution.\n\nThe derivation proceeds in three parts as requested.\n\n**Part 1: Derivation of the Field-Line Differential Constraint for $j_{\\parallel}$**\n\nWe begin with the ideal MHD equilibrium equations: the force balance equation and the current continuity equation.\n$$\n\\nabla p = \\mathbf{j} \\times \\mathbf{B} \\quad (1)\n$$\n$$\n\\nabla \\cdot \\mathbf{j} = 0 \\quad (2)\n$$\nThe current density $\\mathbf{j}$ is decomposed into components perpendicular and parallel to the magnetic field $\\mathbf{B}$:\n$$\n\\mathbf{j} = \\mathbf{j}_{\\perp} + j_{\\parallel} \\mathbf{b}\n$$\nwhere $\\mathbf{b} \\equiv \\mathbf{B}/B$ is the unit vector in the direction of the magnetic field, and $B = |\\mathbf{B}|$.\n\nSubstituting this decomposition into the current continuity equation $(2)$, we have:\n$$\n\\nabla \\cdot (\\mathbf{j}_{\\perp} + j_{\\parallel} \\mathbf{b}) = 0\n$$\n$$\n\\nabla \\cdot \\mathbf{j}_{\\perp} + \\nabla \\cdot (j_{\\parallel} \\mathbf{b}) = 0\n$$\nUsing the vector identity $\\nabla \\cdot (f\\mathbf{A}) = f(\\nabla \\cdot \\mathbf{A}) + \\mathbf{A} \\cdot \\nabla f$, the second term becomes:\n$$\n\\nabla \\cdot (j_{\\parallel} \\mathbf{b}) = j_{\\parallel} (\\nabla \\cdot \\mathbf{b}) + \\mathbf{b} \\cdot \\nabla j_{\\parallel}\n$$\nThe divergence of a magnetic field is always zero, $\\nabla \\cdot \\mathbf{B} = 0$. Applying the same vector identity to $\\mathbf{B} = B\\mathbf{b}$:\n$$\n\\nabla \\cdot (B\\mathbf{b}) = B(\\nabla \\cdot \\mathbf{b}) + \\mathbf{b} \\cdot \\nabla B = 0\n$$\nThis implies that $\\nabla \\cdot \\mathbf{b} = - \\frac{\\mathbf{b} \\cdot \\nabla B}{B}$. Substituting this back into the expression for $\\nabla \\cdot (j_{\\parallel} \\mathbf{b})$ gives:\n$$\n\\nabla \\cdot (j_{\\parallel} \\mathbf{b}) = j_{\\parallel} \\left(-\\frac{\\mathbf{b} \\cdot \\nabla B}{B}\\right) + \\mathbf{b} \\cdot \\nabla j_{\\parallel} = \\frac{1}{B} (\\mathbf{b} \\cdot \\nabla j_{\\parallel}) B - \\frac{j_{\\parallel}}{B} (\\mathbf{b} \\cdot \\nabla B) = B \\left[ \\frac{1}{B} (\\mathbf{b} \\cdot \\nabla j_{\\parallel}) - \\frac{j_{\\parallel}}{B^2} (\\mathbf{b} \\cdot \\nabla B) \\right]\n$$\nThe term in the square brackets is the derivative of $j_{\\parallel}/B$ along the magnetic field line, operated on by $\\mathbf{b} \\cdot \\nabla$. Thus:\n$$\n\\nabla \\cdot (j_{\\parallel} \\mathbf{b}) = B (\\mathbf{b} \\cdot \\nabla) \\left(\\frac{j_{\\parallel}}{B}\\right)\n$$\nThe current continuity equation then becomes the desired differential constraint:\n$$\nB (\\mathbf{b} \\cdot \\nabla) \\left(\\frac{j_{\\parallel}}{B}\\right) = - \\nabla \\cdot \\mathbf{j}_{\\perp}\n$$\n\n**Part 2: Reduction to Integrable Form and Application of Flux-Surface Condition**\n\nFirst, we determine $\\mathbf{j}_{\\perp}$ from the force balance equation $(1)$. Taking the cross product with $\\mathbf{B}$:\n$$\n\\nabla p \\times \\mathbf{B} = (\\mathbf{j} \\times \\mathbf{B}) \\times \\mathbf{B}\n$$\nUsing the vector triple-product identity $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{C} = (\\mathbf{A} \\cdot \\mathbf{C})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{C})\\mathbf{A}$:\n$$\n\\nabla p \\times \\mathbf{B} = (\\mathbf{j} \\cdot \\mathbf{B})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{B})\\mathbf{j} = (j_{\\parallel}B)\\mathbf{B} - B^2 \\mathbf{j}\n$$\nSolving for $\\mathbf{j}$:\n$$\n\\mathbf{j} = \\frac{(j_{\\parallel}B)\\mathbf{B}}{B^2} - \\frac{\\nabla p \\times \\mathbf{B}}{B^2} = j_{\\parallel}\\mathbf{b} + \\frac{\\mathbf{B} \\times \\nabla p}{B^2}\n$$\nComparing this with $\\mathbf{j} = \\mathbf{j}_{\\perp} + j_{\\parallel}\\mathbf{b}$, we identify the perpendicular current component:\n$$\n\\mathbf{j}_{\\perp} = \\frac{\\mathbf{B} \\times \\nabla p}{B^2}\n$$\nNow, we compute its divergence, $\\nabla \\cdot \\mathbf{j}_{\\perp}$. Using the identity $\\nabla \\cdot (\\mathbf{A} \\times \\mathbf{C}) = \\mathbf{C} \\cdot (\\nabla \\times \\mathbf{A}) - \\mathbf{A} \\cdot (\\nabla \\times \\mathbf{C})$ with $\\mathbf{A} = \\mathbf{B}/B^2$ and $\\mathbf{C} = \\nabla p$:\n$$\n\\nabla \\cdot \\mathbf{j}_{\\perp} = \\nabla p \\cdot \\left(\\nabla \\times \\frac{\\mathbf{B}}{B^2}\\right) - \\frac{\\mathbf{B}}{B^2} \\cdot (\\nabla \\times \\nabla p)\n$$\nThe second term vanishes since the curl of a gradient is identically zero, $\\nabla \\times \\nabla p = 0$. For the first term, we use another identity, $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + \\nabla f \\times \\mathbf{A}$, with $f=1/B^2$:\n$$\n\\nabla \\times \\frac{\\mathbf{B}}{B^2} = \\frac{1}{B^2}(\\nabla \\times \\mathbf{B}) + \\nabla\\left(\\frac{1}{B^2}\\right) \\times \\mathbf{B} = \\frac{1}{B^2}(\\nabla \\times \\mathbf{B}) - \\frac{2}{B^3}\\nabla B \\times \\mathbf{B}\n$$\nSo, $\\nabla \\cdot \\mathbf{j}_{\\perp} = \\frac{\\nabla p \\cdot (\\nabla \\times \\mathbf{B})}{B^2} - \\frac{2}{B^3} \\nabla p \\cdot (\\nabla B \\times \\mathbf{B})$.\nIn MHD equilibrium, $\\nabla p = \\mathbf{j} \\times \\mathbf{B}$, so $\\nabla p$ is orthogonal to both $\\mathbf{j}$ and $\\mathbf{B}$. From Ampere's law, neglecting the displacement current, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{j}$. Thus, $\\nabla p \\cdot (\\nabla \\times \\mathbf{B}) = \\mu_0 (\\nabla p \\cdot \\mathbf{j}) = 0$.\nThe divergence of the perpendicular current simplifies to:\n$$\n\\nabla \\cdot \\mathbf{j}_{\\perp} = - \\frac{2}{B^3} \\nabla p \\cdot (\\nabla B \\times \\mathbf{B}) = \\frac{2}{B^3} \\nabla p \\cdot (\\mathbf{B} \\times \\nabla B)\n$$\nSubstituting this into the constraint for $j_{\\parallel}$:\n$$\nB (\\mathbf{b} \\cdot \\nabla) \\left(\\frac{j_{\\parallel}}{B}\\right) = -\\frac{2}{B^3} \\nabla p \\cdot (\\mathbf{B} \\times \\nabla B)\n$$\nIn an axisymmetric system where $p=p(\\psi)$, we have $\\nabla p = p'(\\psi)\\nabla\\psi$. The magnetic field is $\\mathbf{B} = \\mathbf{B}_p + B_{\\phi}\\hat{\\boldsymbol{\\phi}}$, where $\\mathbf{B}_p$ is the poloidal field and $B_{\\phi} = I(\\psi)/R$. Since $\\nabla\\psi$ and $\\nabla B$ lie in the poloidal plane for an axisymmetric equilibrium, their cross product $\\nabla\\psi \\times \\nabla B$ is purely toroidal. Thus only the toroidal component of $\\mathbf{B}$ contributes to the scalar triple product: $\\mathbf{B} \\cdot (\\nabla\\psi \\times \\nabla B) = B_{\\phi}\\hat{\\boldsymbol{\\phi}} \\cdot (\\nabla\\psi \\times \\nabla B)$.\nAlso, the operator $\\mathbf{b}\\cdot\\nabla$ can be written as $\\frac{1}{B}(\\mathbf{B}_p \\cdot \\nabla_{pol})$. Combining these facts and simplifying gives a differential equation in the poloidal angle $\\theta$:\n$$\n\\frac{\\partial}{\\partial\\theta}\\left(\\frac{j_{\\parallel}}{B}\\right) = \\frac{2 I(\\psi)p'(\\psi)}{B^3}\\frac{\\partial B}{\\partial\\theta}\n$$\nThis is an integrable form. Integrating with respect to $\\theta$ (holding $\\psi$ constant):\n$$\n\\frac{j_{\\parallel}(\\theta)}{B(\\theta)} = \\int \\frac{2 I p'}{B^3} dB = 2 I p' \\left(-\\frac{1}{2}B^{-2}\\right) + C(\\psi) = -\\frac{I(\\psi)p'(\\psi)}{[B(\\theta)]^2} + C(\\psi)\n$$\nHere $C(\\psi)$ is an integration constant that is a flux function. To determine $C(\\psi)$, we impose the condition that the flux-surface average of $j_{\\parallel}/B$ vanishes: $\\langle j_{\\parallel}/B \\rangle = 0$. For a large aspect ratio, this average is $\\langle A \\rangle \\approx \\frac{1}{2\\pi}\\int_0^{2\\pi} A d\\theta$.\n$$\n\\left\\langle -\\frac{I p'}{B^2} + C(\\psi) \\right\\rangle = -I p' \\left\\langle \\frac{1}{B^2} \\right\\rangle + C(\\psi) = 0\n$$\nSolving for $C(\\psi)$ gives $C(\\psi) = I p' \\langle 1/B^2 \\rangle$. Substituting this back:\n$$\n\\frac{j_{\\parallel}}{B} = I p' \\left( \\left\\langle \\frac{1}{B^2} \\right\\rangle - \\frac{1}{B^2} \\right) \\quad \\implies \\quad j_{\\parallel}(\\theta) = I p' B(\\theta) \\left( \\left\\langle \\frac{1}{B^2} \\right\\rangle - \\frac{1}{B^2(\\theta)} \\right)\n$$\n\n**Part 3: Calculation of $j_{\\parallel}(\\theta)$ to First Order in $\\varepsilon$**\n\nWe use the given pressure profile $p(\\psi) = p_0 - \\alpha\\psi$, which implies $p'(\\psi) = -\\alpha$.\nWe are given the approximations for large aspect ratio $\\varepsilon \\ll 1$:\n$I(\\psi) \\approx B_0 R_0$\n$B(\\theta) \\approx B_0 \\frac{R_0}{R_0(1+\\varepsilon\\cos\\theta)} = B_0(1+\\varepsilon\\cos\\theta)^{-1} \\approx B_0(1 - \\varepsilon\\cos\\theta)$\n\nWe need to calculate the terms involving $1/B^2$. To first order in $\\varepsilon$:\n$$\n\\frac{1}{B^2(\\theta)} \\approx \\frac{1}{[B_0(1-\\varepsilon\\cos\\theta)]^2} = \\frac{1}{B_0^2}(1-\\varepsilon\\cos\\theta)^{-2} \\approx \\frac{1}{B_0^2}(1+2\\varepsilon\\cos\\theta)\n$$\nNext, we compute the flux-surface average:\n$$\n\\left\\langle \\frac{1}{B^2} \\right\\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{1}{B_0^2}(1+2\\varepsilon\\cos\\theta) d\\theta = \\frac{1}{B_0^2} \\frac{1}{2\\pi} \\left[ \\int_0^{2\\pi} d\\theta + 2\\varepsilon \\int_0^{2\\pi} \\cos\\theta d\\theta \\right]\n$$\nSince $\\int_0^{2\\pi} \\cos\\theta d\\theta = 0$, the average is simply:\n$$\n\\left\\langle \\frac{1}{B^2} \\right\\rangle = \\frac{1}{B_0^2}\n$$\nNow we assemble the expression for $j_{\\parallel}(\\theta)$, retaining terms up to first order in $\\varepsilon$:\n$$\nj_{\\parallel}(\\theta) \\approx (B_0 R_0)(-\\alpha) [B_0(1-\\varepsilon\\cos\\theta)] \\left( \\frac{1}{B_0^2} - \\frac{1}{B_0^2}(1+2\\varepsilon\\cos\\theta) \\right)\n$$\nSimplify the term in the large parentheses:\n$$\n\\frac{1}{B_0^2} - \\frac{1}{B_0^2} - \\frac{2\\varepsilon\\cos\\theta}{B_0^2} = -\\frac{2\\varepsilon\\cos\\theta}{B_0^2}\n$$\nSubstitute this back:\n$$\nj_{\\parallel}(\\theta) \\approx (-\\alpha B_0 R_0) [B_0(1-\\varepsilon\\cos\\theta)] \\left( -\\frac{2\\varepsilon\\cos\\theta}{B_0^2} \\right)\n$$\n$$\nj_{\\parallel}(\\theta) \\approx \\alpha B_0^2 R_0 (1-\\varepsilon\\cos\\theta) \\left( \\frac{2\\varepsilon\\cos\\theta}{B_0^2} \\right)\n$$\n$$\nj_{\\parallel}(\\theta) \\approx \\alpha R_0 (1-\\varepsilon\\cos\\theta) (2\\varepsilon\\cos\\theta)\n$$\nExpanding the product and keeping only terms up to order $\\varepsilon$:\n$$\nj_{\\parallel}(\\theta) \\approx \\alpha R_0 (2\\varepsilon\\cos\\theta - 2\\varepsilon^2\\cos^2\\theta)\n$$\nThe second term is of order $\\varepsilon^2$ and is therefore neglected. The final expression for the parallel current to first order in $\\varepsilon$ is:\n$$\nj_{\\parallel}(\\theta) = 2 \\alpha R_0 \\varepsilon \\cos(\\theta)\n$$",
            "answer": "$$\\boxed{2 \\alpha R_0 \\varepsilon \\cos(\\theta)}$$"
        },
        {
            "introduction": "A central goal of magnetic confinement is to maintain a stable equilibrium, but plasmas are often susceptible to instabilities that can degrade performance. This computational exercise  moves beyond static equilibrium to model the dynamic evolution of a resistive tearing mode, a common instability that creates magnetic islands. By implementing the Rutherford equation, you will simulate the nonlinear growth and saturation of an island, gaining insight into the balance between destabilizing forces and stabilizing effects.",
            "id": "4004906",
            "problem": "Consider the resistive Magnetohydrodynamics (MHD) tearing mode in a magnetically confined plasma. In the nonlinear regime, the magnetic island half-width $w$ at the rational surface evolves according to the Rutherford equation $dw/dt = C \\eta \\Delta'$, where $C$ is a geometry-dependent constant, $\\eta$ is the plasma resistivity, and $\\Delta'$ is the tearing mode stability parameter determined by the outer-region matching. In the presence of stabilizing magnetic shear, the effective drive may be modeled to decrease with increasing island width. Adopt the reduced model $\\Delta'(w) = \\Delta'_0 - \\sigma w$, where $\\Delta'_0$ is the baseline tearing drive from equilibrium current gradients and $\\sigma$ is a positive coefficient representing stabilizing shear effects. Assume this reduced model holds for the test cases below and that $w \\ge 0$ at all times.\n\nStarting from the fundamental MHD induction equation $\\partial \\mathbf{B}/\\partial t = - \\nabla \\times \\mathbf{E}$ and resistive Ohm's law $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{j}$, justify the Rutherford form $dw/dt = C \\eta \\Delta'$ for island width evolution as a quasi-static balance near the rational surface and then incorporate the shear-modified $\\Delta'(w)$ to obtain a closed scalar evolution equation for $w(t)$ with initial width $w(0) = w_0$. Derive an expression for the time evolution $w(t)$ and identify the saturated width $w_{\\mathrm{sat}}$ under stabilizing shear. Explain the physically consistent handling of cases with $\\sigma = 0$ (no shear) and $\\Delta'_0 \\le 0$ (net stabilizing drive), ensuring that $w(t)$ remains nonnegative.\n\nYour task is to implement a program that, for each test case, computes:\n- The island width $w(T)$ at a specified final time $T$ in seconds.\n- The saturated width $w_{\\mathrm{sat}}$ in meters under stabilizing shear.\n\nIf $\\sigma = 0$, interpret the saturated width as unbounded and return the floating-point infinity. If $\\sigma > 0$ but $\\Delta'_0 \\le 0$, the physically realizable saturated width is zero. In all cases, enforce $w(t) \\ge 0$.\n\nPhysical units and conventions:\n- Time $t$ and $T$ must be in seconds.\n- Widths $w$, $w_0$, and $w(T)$ must be in meters.\n- Resistivity $\\eta$ must be in ohm-meters.\n- The parameter $\\Delta'$ and coefficients $\\Delta'_0$ and $\\sigma$ must be in inverse meters.\n- The constant $C$ must be in meters per ohm-second so that $C \\eta \\Delta'$ has units of meters per second.\n- No angles are used in this problem.\n\nTest suite:\nProvide results for the following four test cases. Each case is a tuple $(C, \\eta, \\Delta'_0, \\sigma, w_0, T)$ with values in the units specified above.\n1. Case A (nominal growth with shear): ($C = 5 \\times 10^{5}$, $\\eta = 1 \\times 10^{-6}$, $\\Delta'_0 = 10$, $\\sigma = 2000$, $w_0 = 0.001$, $T = 0.01$).\n2. Case B (boundary drive $\\Delta'_0 = 0$): ($C = 5 \\times 10^{5}$, $\\eta = 1 \\times 10^{-6}$, $\\Delta'_0 = 0$, $\\sigma = 2000$, $w_0 = 0.004$, $T = 0.01$).\n3. Case C (no shear $\\sigma = 0$): ($C = 5 \\times 10^{5}$, $\\eta = 1 \\times 10^{-6}$, $\\Delta'_0 = 10$, $\\sigma = 0$, $w_0 = 0.001$, $T = 0.01$).\n4. Case D (net stabilizing drive $\\Delta'_0  0$): ($C = 5 \\times 10^{5}$, $\\eta = 1 \\times 10^{-6}$, $\\Delta'_0 = -5$, $\\sigma = 2000$, $w_0 = 0.004$, $T = 0.005$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a two-element list $[w(T), w_{\\mathrm{sat}}]$ in meters, using floating-point values, with $w_{\\mathrm{sat}} = \\infty$ represented by the Python floating-point infinity. For example, the overall format is $[[w_1, w_{\\mathrm{sat},1}],[w_2, w_{\\mathrm{sat},2}],\\ldots]$ printed as a single line without any additional text.",
            "solution": "The user-provided problem has been analyzed and is determined to be **valid**. It is scientifically grounded in magnetohydrodynamics, well-posed as an initial value problem for an ordinary differential equation, and objectively stated with all necessary parameters provided.\n\n### Justification of the Rutherford Equation\n\nThe Rutherford equation for the evolution of the magnetic island half-width, $w$, is a cornerstone of nonlinear tearing mode theory. Its derivation arises from a quasi-static force balance analysis in the vicinity of a rational magnetic surface. The fundamental equations are the resistive MHD induction equation and Ohm's law:\n$$ \\frac{\\partial \\mathbf{B}}{\\partial t} = - \\nabla \\times \\mathbf{E} $$\n$$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{j} $$\nwhere $\\mathbf{B}$ is the magnetic field, $\\mathbf{E}$ is the electric field, $\\mathbf{v}$ is the plasma fluid velocity, $\\eta$ is the plasma resistivity, and $\\mathbf{j}$ is the current density.\n\nA tearing mode is a resistive instability that occurs at a rational surface, where the magnetic field lines close upon themselves after a finite number of toroidal and poloidal transits. In the linear phase, a small perturbation grows exponentially. In the nonlinear phase, this perturbation saturates into a magnetic island structure, a region of closed, helical magnetic flux surfaces separated from the ambient plasma by a magnetic separatrix.\n\nThe evolution of this island is governed by physics in two distinct regions:\n1.  The **Outer Region**: Away from the rational surface, the plasma is treated as a perfect conductor ($\\eta=0$). The plasma dynamics are governed by ideal MHD. The equilibrium current profile contains free energy that can drive the tearing mode. This drive is quantified by the tearing stability parameter, $\\Delta'$, which is the discontinuity in the logarithmic derivative of the perturbed magnetic flux across the inner layer. A positive $\\Delta'$ indicates available free energy for island growth.\n2.  The **Inner Region**: A thin layer centered on the rational surface where resistivity is crucial. It is within this layer that magnetic field lines can break and reconnect, allowing the island to grow.\n\nRutherford's analysis connects these two regions. The growth of the island, $dw/dt$, corresponds to the rate of magnetic flux reconnection. This reconnection rate is determined by the resistive electric field, $E \\approx \\eta j$, within the layer. The current density, $j$, inside the nonlinear island is itself modified by the island's presence. By performing an energy balance (or, equivalently, a force balance) that equates the power dissipated resistively within the layer to the magnetic energy flux from the outer region (proportional to $\\Delta'$), one arrives at the celebrated result:\n$$ \\frac{dw}{dt} = C \\eta \\Delta' $$\nwhere $w$ is the island half-width and $C$ is a constant of proportionality that depends on the specific magnetic geometry. This equation describes the slow, quasi-static evolution of the island width in the nonlinear regime, driven by the available free energy from the global current profile and limited by the local resistivity.\n\n### Derivation of the Island Evolution and Saturation\n\nThe problem provides a model for the stability parameter that includes the stabilizing effect of magnetic shear, which becomes more effective as the island grows:\n$$ \\Delta'(w) = \\Delta'_0 - \\sigma w $$\nwhere $\\Delta'_0$ is the drive from the equilibrium current profile and $\\sigma$ is a positive coefficient quantifying the shear stabilization. Substituting this into the Rutherford equation gives the governing ordinary differential equation (ODE) for the island half-width $w(t)$:\n$$ \\frac{dw}{dt} = C \\eta (\\Delta'_0 - \\sigma w) $$\nThis is a first-order, linear, inhomogeneous ODE subject to the initial condition $w(0) = w_0$.\n\nThe saturated island width, $w_{\\mathrm{sat}}$, is the equilibrium state where the island ceases to grow, i.e., $dw/dt = 0$.\n$$ C \\eta (\\Delta'_0 - \\sigma w_{\\mathrm{sat}}) = 0 $$\nAssuming $C\\eta \\ne 0$, we analyze the solution for $w_{\\mathrm{sat}}$ based on the parameters $\\sigma$ and $\\Delta'_0$:\n\n1.  **With Shear ($\\sigma > 0$):**\n    The condition becomes $\\Delta'_0 - \\sigma w_{\\mathrm{sat}} = 0$, which yields $w_{\\mathrm{sat}} = \\Delta'_0 / \\sigma$.\n    -   If $\\Delta'_0 > 0$, there is a net positive drive that is balanced by shear at a finite width $w_{\\mathrm{sat}} = \\Delta'_0 / \\sigma > 0$.\n    -   If $\\Delta'_0 \\le 0$, the drive $\\Delta'(w) = \\Delta'_0 - \\sigma w$ is always negative for any $w > 0$. Any pre-existing island will decay. The physically realizable saturated width is $w_{\\mathrm{sat}} = 0$, as a width cannot be negative.\n\n2.  **Without Shear ($\\sigma = 0$):**\n    The evolution equation becomes $dw/dt = C\\eta\\Delta'_0$.\n    -   If $\\Delta'_0 > 0$, the growth rate is constant and positive. The island width grows linearly in time without bound. Therefore, the saturated width is interpreted as unbounded, $w_{\\mathrm{sat}} = \\infty$.\n    -   If $\\Delta'_0 \\le 0$, the island width decays or remains static. As per the problem's explicit instruction for the case $\\sigma=0$, the saturated width is reported as unbounded regardless of $\\Delta'_0$.\n\n### Analytical Solution for Island Width Evolution $w(t)$\n\nWe solve the ODE for the two main regimes. In all cases, the physical constraint $w(t) \\ge 0$ must be enforced.\n\n**Case 1: With Shear ($\\sigma > 0$)**\nThe ODE can be written as:\n$$ \\frac{dw}{dt} + (C\\eta\\sigma)w = C\\eta\\Delta'_0 $$\nThe solution to this standard linear first-order ODE with the initial condition $w(0) = w_0$ is:\n$$ w(t) = \\frac{\\Delta'_0}{\\sigma} + \\left(w_0 - \\frac{\\Delta'_0}{\\sigma}\\right) e^{-C\\eta\\sigma t} $$\nThis mathematical solution must be reconciled with the physical constraint $w(t) \\ge 0$. If $\\Delta'_0  0$, the mathematical solution can become negative. A negative width is unphysical; it implies the island has fully decayed. Therefore, the physical width is given by:\n$$ w(t)_{\\text{physical}} = \\max\\left(0, \\frac{\\Delta'_0}{\\sigma} + \\left(w_0 - \\frac{\\Delta'_0}{\\sigma}\\right) e^{-C\\eta\\sigma t}\\right) $$\n\n**Case 2: Without Shear ($\\sigma = 0$)**\nThe ODE simplifies to:\n$$ \\frac{dw}{dt} = C\\eta\\Delta'_0 $$\nIntegrating with respect to time from $0$ to $t$ gives:\n$$ w(t) - w_0 = (C\\eta\\Delta'_0)t $$\n$$ w(t) = w_0 + C\\eta\\Delta'_0 t $$\nApplying the non-negativity constraint yields the physical solution:\n$$ w(t)_{\\text{physical}} = \\max(0, w_0 + C\\eta\\Delta'_0 t) $$\n\n### Summary of Formulas for Implementation\n\nFor each test case $(C, \\eta, \\Delta'_0, \\sigma, w_0, T)$, we calculate $[w(T), w_{\\mathrm{sat}}]$ as follows.\n\n**Saturated Width $w_{\\mathrm{sat}}$:**\n- If $\\sigma = 0$: $w_{\\mathrm{sat}} = \\infty$.\n- If $\\sigma > 0$:\n    - If $\\Delta'_0 \\le 0$: $w_{\\mathrm{sat}} = 0$.\n    - If $\\Delta'_0 > 0$: $w_{\\mathrm{sat}} = \\Delta'_0 / \\sigma$.\n\n**Island Width at time $T$, $w(T)$:**\n- If $\\sigma = 0$:\n    - Calculate $w_{\\text{calc}} = w_0 + C \\eta \\Delta'_0 T$.\n    - $w(T) = \\max(0, w_{\\text{calc}})$.\n- If $\\sigma > 0$:\n    - Let $w_{\\text{sat\\_math}} = \\Delta'_0 / \\sigma$.\n    - Calculate $w_{\\text{calc}} = w_{\\text{sat\\_math}} + (w_0 - w_{\\text{sat\\_math}}) \\exp(-C \\eta \\sigma T)$.\n    - $w(T) = \\max(0, w_{\\text{calc}})$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the tearing mode island width evolution and saturation\n    based on the Rutherford model with shear stabilization.\n    \"\"\"\n\n    # Test cases: (C, eta, Delta'_0, sigma, w_0, T)\n    # Units: C [m/(ohm*s)], eta [ohm*m], Delta'_0 [1/m], sigma [1/m], w_0 [m], T [s]\n    test_cases = [\n        # Case A (nominal growth with shear)\n        (5e5, 1e-6, 10, 2000, 0.001, 0.01),\n        # Case B (boundary drive Delta'_0 = 0)\n        (5e5, 1e-6, 0, 2000, 0.004, 0.01),\n        # Case C (no shear sigma = 0)\n        (5e5, 1e-6, 10, 0, 0.001, 0.01),\n        # Case D (net stabilizing drive Delta'_0  0)\n        (5e5, 1e-6, -5, 2000, 0.004, 0.005),\n    ]\n\n    results = []\n    for case in test_cases:\n        C, eta, Delta0, sigma, w0, T = case\n\n        w_sat = 0.0\n        w_T = 0.0\n\n        # Calculate the saturated width (w_sat)\n        if sigma == 0:\n            # As per instruction, w_sat is unbounded if there's no shear stabilization.\n            w_sat = float('inf')\n        else: # sigma  0\n            if Delta0  0:\n                # Saturation from balance of drive and shear stabilization.\n                w_sat = Delta0 / sigma\n            else: # Delta0 = 0\n                # Drive is always stabilizing, so any island decays to zero.\n                w_sat = 0.0\n\n        # Calculate the island width at time T (w_T)\n        # The evolution equation is dw/dt = C * eta * (Delta0 - sigma * w)\n        C_eta = C * eta\n        \n        if sigma == 0:\n            # Linear growth/decay: w(t) = w0 + C*eta*Delta0*t\n            w_calc = w0 + C_eta * Delta0 * T\n        else: # sigma  0\n            # Exponential approach to saturation:\n            # w(t) = w_sat_math + (w0 - w_sat_math) * exp(-C*eta*sigma*t)\n            # where w_sat_math = Delta0 / sigma\n            w_sat_math = Delta0 / sigma\n            beta = C_eta * sigma\n            w_calc = w_sat_math + (w0 - w_sat_math) * np.exp(-beta * T)\n\n        # Enforce physical non-negativity constraint for width\n        w_T = max(0.0, w_calc)\n\n        results.append([w_T, w_sat])\n\n    # Format the final output string to match the required format.\n    # The default string representation of a list of lists is \"[[], [], ...]\"\n    # which we can compact by removing spaces.\n    final_output = str(results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}