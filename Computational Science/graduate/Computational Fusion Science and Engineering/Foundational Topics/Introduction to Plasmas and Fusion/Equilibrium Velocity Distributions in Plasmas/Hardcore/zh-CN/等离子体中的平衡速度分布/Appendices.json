{
    "hands_on_practices": [
        {
            "introduction": "本练习具有基础性意义。我们将从最大熵原理出发，推导最常见的平衡速度分布——漂移麦克斯韦分布 ()。这项实践旨在巩固等离子体平衡的统计力学基础，并展示宏观约束（如密度、流动速度和温度）如何决定微观分布函数的形式。",
            "id": "3975367",
            "problem": "在计算聚变科学与工程代码中，处于热力学平衡的均匀单组分等离子体通常使用一个平衡速度分布进行初始化，该分布在宏观矩守恒的约束下使动能熵最大化。考虑一个粒子种类，其质量为 $m$，数密度为 $n$，温度为 $T$，平均流速矢量为 $\\mathbf{u}$。单个粒子的速度为 $\\mathbf{v}=(v_x,v_y,v_z)$。令 $k_B$ 表示玻尔兹曼常数。假设等离子体是空间均匀的，并且碰撞已使其达到一个符合最大熵原理的稳态。\n\n从速度分布 $f(\\mathbf{v})$ 的连续熵泛函出发，并施加粒子数守恒、平均流守恒和动能守恒的约束条件，推导关于 $\\mathbf{v}$ 的平衡速度分布 $f(\\mathbf{v})$ 的形式。然后，计算沿单个笛卡尔分量的一维边际分布，其定义为\n$$\nf_{1D}(v_x)=\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(v_x,v_y,v_z)\\, dv_y\\, dv_z.\n$$\n请将 $f_{1D}(v_x)$ 表示为包含 $n$、$m$、$k_B$、$T$ 和 $u_x$ 的闭式解析表达式，并通过将其与单个速度分量 $v_x$ 上的标准高斯分布进行比较，来确定其均值和方差。\n\n你的最终答案必须仅为 $f_{1D}(v_x)$ 的单个闭式表达式。使用国际单位制（SI）。不要代入数值。无需四舍五入。在最终的方框表达式中不要包含单位。",
            "solution": "该问题要求推导均匀单组分等离子体的一维边际平衡速度分布函数 $f_{1D}(v_x)$。推导从最大熵原理开始，这是统计力学的一个基石。\n\n等离子体的状态由速度分布函数 $f(\\mathbf{v})$ 描述，其中 $\\mathbf{v}=(v_x, v_y, v_z)$ 是粒子速度。我们的目标是找到使玻尔兹曼-吉布斯熵泛函最大化的函数 $f(\\mathbf{v})$：\n$$\nS[f] = -k_B \\int f(\\mathbf{v}) \\ln f(\\mathbf{v}) \\, d^3\\mathbf{v}\n$$\n该泛函受宏观约束条件的限制。常数 $k_B$ 是玻尔兹曼常数。积分遍及整个速度空间。\n\n约束条件由粒子数、动量和能量守恒给出。对于空间均匀的等离子体，这些约束用数密度 $n$、平均流速 $\\mathbf{u}$ 和温度 $T$ 来表示。\n对 $f(\\mathbf{v})$ 的约束条件如下：\n1.  数密度守恒：分布函数在所有速度上的积分必须得出总数密度 $n$。\n    $$\n    \\int f(\\mathbf{v}) \\, d^3\\mathbf{v} = n\n    $$\n2.  平均流速的定义：分布函数的一阶矩定义了平均速度 $\\mathbf{u}$。\n    $$\n    \\int \\mathbf{v} f(\\mathbf{v}) \\, d^3\\mathbf{v} = n\\mathbf{u}\n    $$\n    这等价于三个标量约束，速度矢量的每个分量各一个。\n3.  温度的定义：温度 $T$ 与随平均流移动的参考系中粒子的平均动能有关。实验室参考系中的总动能密度是热能密度与整体流动动能密度之和。因此，总动能密度由 $\\frac{3}{2}nk_BT + \\frac{1}{2}nm|\\mathbf{u}|^2$ 给出。分布函数的二阶矩约束为：\n    $$\n    \\int \\frac{1}{2} m |\\mathbf{v}|^2 f(\\mathbf{v}) \\, d^3\\mathbf{v} = \\frac{3}{2} n k_B T + \\frac{1}{2} n m |\\mathbf{u}|^2\n    $$\n    其中 $m$ 是单个粒子的质量。\n\n为解决这个约束优化问题，我们使用拉格朗日乘子法。我们构造一个新的泛函 $L[f]$，并在没有约束的情况下将其最大化：\n$$\nL[f] = -\\int f\\ln f \\,d^3\\mathbf{v} - \\lambda_0\\left(\\int f \\, d^3\\mathbf{v} - n\\right) - \\boldsymbol{\\lambda}_1 \\cdot \\left(\\int \\mathbf{v} f \\, d^3\\mathbf{v} - n\\mathbf{u}\\right) - \\lambda_2\\left(\\int \\frac{1}{2} m |\\mathbf{v}|^2 f \\, d^3\\mathbf{v} - E_{kin}\\right)\n$$\n这里，为方便起见，我们将熵除以 $k_B$，拉格朗日乘子为 $\\lambda_0$、$\\boldsymbol{\\lambda}_1$（一个矢量）和 $\\lambda_2$。\n为了找到最大值，我们取 $L[f]$ 关于 $f$ 的泛函导数，并令其为零：\n$$\n\\frac{\\delta L}{\\delta f} = -(\\ln f(\\mathbf{v}) + 1) - \\lambda_0 - \\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} - \\lambda_2 \\frac{1}{2} m |\\mathbf{v}|^2 = 0\n$$\n求解 $\\ln f(\\mathbf{v})$：\n$$\n\\ln f(\\mathbf{v}) = -(1 + \\lambda_0) - \\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} - \\lambda_2 \\frac{1}{2} m |\\mathbf{v}|^2\n$$\n这给出了 $f(\\mathbf{v})$ 的函数形式：\n$$\nf(\\mathbf{v}) = \\exp\\left(-(1 + \\lambda_0)\\right) \\exp\\left(-\\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} - \\lambda_2 \\frac{1}{2} m |\\mathbf{v}|^2\\right)\n$$\n指数部分可以通过配方法重新整理：\n$$\n-\\frac{m\\lambda_2}{2}|\\mathbf{v}|^2 - \\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} = -\\frac{m\\lambda_2}{2}\\left(|\\mathbf{v}|^2 + \\frac{2}{m\\lambda_2}\\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v}\\right) = -\\frac{m\\lambda_2}{2}\\left(\\left|\\mathbf{v} + \\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}\\right|^2 - \\left|\\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}\\right|^2\\right)\n$$\n分布函数变为：\n$$\nf(\\mathbf{v}) = C \\exp\\left(-\\frac{m\\lambda_2}{2}\\left|\\mathbf{v} + \\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}\\right|^2\\right)\n$$\n其中 $C$ 是一个包含所有其他项的归一化常数。这是一个关于 $\\mathbf{v}$ 的高斯分布，中心位于 $\\langle\\mathbf{v}\\rangle = -\\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}$。从第二个约束条件可知，平均速度为 $\\mathbf{u}$。因此，$\\mathbf{u} = -\\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}$，这意味着 $\\boldsymbol{\\lambda}_1 = -m\\lambda_2\\mathbf{u}$。\n\n将 $\\boldsymbol{\\lambda}_1$ 代回原始指数中得到：\n$$\n-\\frac{m\\lambda_2}{2}|\\mathbf{v}|^2 - (-m\\lambda_2\\mathbf{u}) \\cdot \\mathbf{v} = -\\frac{m\\lambda_2}{2}(|\\mathbf{v}|^2 - 2\\mathbf{u}\\cdot\\mathbf{v}) = -\\frac{m\\lambda_2}{2}(|\\mathbf{v}-\\mathbf{u}|^2 - |\\mathbf{u}|^2)\n$$\n于是分布为：\n$$\nf(\\mathbf{v}) = A \\exp\\left(-\\frac{m\\lambda_2}{2}|\\mathbf{v}-\\mathbf{u}|^2\\right)\n$$\n其中 $A$ 是一个新的归一化常数。\n\n为了确定拉格朗日乘子 $\\lambda_2$ 和常数 $A$，我们应用第一个和第三个约束条件。\n温度与速度分布之间的关系由共动参考系中的平均动能给出：\n$$\n\\frac{3}{2} k_B T = \\frac{1}{n} \\int \\frac{1}{2}m|\\mathbf{v}-\\mathbf{u}|^2 f(\\mathbf{v}) \\, d^3\\mathbf{v}\n$$\n通过执行归一化和能量约束所需的高斯积分，可以严格证明 $\\lambda_2 = \\frac{1}{k_B T}$。\n已知 $\\lambda_2$ 后，归一化常数 $A$ 可由第一个约束条件 $\\int f(\\mathbf{v}) \\,d^3\\mathbf{v} = n$ 求出。\n$$\nn = \\int A \\exp\\left(-\\frac{m|\\mathbf{v}-\\mathbf{u}|^2}{2k_B T}\\right) \\, d^3\\mathbf{v} = A \\left(\\frac{2\\pi k_B T}{m}\\right)^{3/2}\n$$\n这得出 $A = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2}$。\n平衡速度分布是漂移麦克斯韦分布：\n$$\nf(\\mathbf{v}) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m|\\mathbf{v}-\\mathbf{u}|^2}{2k_B T}\\right)\n$$\n\n下一步是计算一维边际分布 $f_{1D}(v_x)$：\n$$\nf_{1D}(v_x) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(v_x, v_y, v_z) \\, dv_y \\, dv_z\n$$\n我们展开指数中的平方项：$|\\mathbf{v}-\\mathbf{u}|^2 = (v_x - u_x)^2 + (v_y - u_y)^2 + (v_z - u_z)^2$。分布函数可以分解为关于 $v_x$、$v_y$ 和 $v_z$ 的函数的乘积：\n$$\nf(\\mathbf{v}) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right) \\exp\\left(-\\frac{m(v_y-u_y)^2}{2k_B T}\\right) \\exp\\left(-\\frac{m(v_z-u_z)^2}{2k_B T}\\right)\n$$\n对 $v_y$ 和 $v_z$ 的积分可以独立进行：\n$$\nf_{1D}(v_x) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right) \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m(v_y-u_y)^2}{2k_B T}\\right) dv_y \\right] \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m(v_z-u_z)^2}{2k_B T}\\right) dv_z \\right]\n$$\n两个积分都是标准高斯形式 $\\int_{-\\infty}^{\\infty} \\exp(-a(x-b)^2)dx = \\sqrt{\\pi/a}$。在这里，$a = \\frac{m}{2k_B T}$。因此，每个积分的计算结果为 $\\sqrt{\\frac{2\\pi k_B T}{m}}$。\n这两个积分的乘积是 $\\left(\\sqrt{\\frac{2\\pi k_B T}{m}}\\right)^2 = \\frac{2\\pi k_B T}{m}$。\n将此结果代入 $f_{1D}(v_x)$ 的表达式中：\n$$\nf_{1D}(v_x) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left(\\frac{2\\pi k_B T}{m}\\right) \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right)\n$$\n简化前置因子：\n$$\nn \\left(\\frac{m}{2\\pi k_B T}\\right)^{(3/2) - 1} = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2}\n$$\n得到的一维边际分布为：\n$$\nf_{1D}(v_x) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right)\n$$\n此表达式是 $v_x$ 的一维高斯分布。为了确定其均值和方差，我们可以将其相关的概率密度函数 $p(v_x) = f_{1D}(v_x)/n$ 与均值为 $\\mu$、方差为 $\\sigma^2$ 的标准正态分布形式进行比较：\n$$\np(v_x) = \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp\\left(-\\frac{(v_x-\\mu)^2}{2\\sigma^2}\\right)\n$$\n我们的概率密度是：\n$$\np(v_x) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right)\n$$\n通过比较指数中的项，我们立即可以确定均值为 $\\mu = u_x$。\n通过比较指数的分母，$2\\sigma^2 = \\frac{2k_B T}{m}$，我们发现方差为 $\\sigma^2 = \\frac{k_B T}{m}$。前置因子 $\\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} = \\frac{1}{\\sqrt{2\\pi (k_B T/m)}} = \\frac{1}{\\sigma\\sqrt{2\\pi}}$ 与此识别结果一致。$f_{1D}(v_x)$ 的均值是整体流速的 $x$ 分量 $u_x$，其方差与热展宽 $\\frac{k_B T}{m}$ 有关。",
            "answer": "$$\n\\boxed{n \\left( \\frac{m}{2 \\pi k_B T} \\right)^{\\frac{1}{2}} \\exp\\left( -\\frac{m(v_x - u_x)^{2}}{2 k_B T} \\right)}\n$$"
        },
        {
            "introduction": "在理想麦克斯韦分布的基础上，本练习将探讨一个与聚变装置更相关的实际情景：等离子体与材料壁的相互作用。我们将通过截断麦克斯韦分布来模拟静电鞘层的粒子过滤效应，并计算由此产生的热通量 ()。这项练习阐释了动理学理论如何应用于边界值问题，并为理解等离子体-材料相互作用提供了关键的物理洞察。",
            "id": "3975397",
            "problem": "考虑在磁约束聚变等离子体的刮削层中，毗邻一个完全吸收的平面壁处，存在一个平衡、三维 (3D)、各向同性的电子速度分布。远离壁的电子群体可以很好地由麦克斯韦分布描述，其数密度为 $n_{e}$，电子质量为 $m_{e}$，温度为 $T_{e}$，其分布函数为\n$$\nf_{M}(\\mathbf{v}) \\;=\\; n_{e}\\left(\\frac{m_{e}}{2\\pi k_{B} T_{e}}\\right)^{3/2}\\exp\\!\\left(-\\frac{m_{e} v^{2}}{2 k_{B} T_{e}}\\right),\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，且 $v = |\\mathbf{v}|$.\n\n由于壁面附近存在鞘层电势为 $\\Phi_{s} > 0$ 的静电鞘层，动能小于势垒的电子被反射，不会到达壁面。在鞘层入口处，我们通过一个截断的麦克斯韦分布来模拟此效应，其中朝向壁面的入射分布为\n$$\nf_{t}(\\mathbf{v}) = \\begin{cases} f_{M}(\\mathbf{v}),  v \\ge v_{c} \\\\ 0,  v  v_{c} \\end{cases}\n$$\n其中截止速度为 $v_{c} = \\sqrt{2 e \\Phi_{s}/m_{e}}$，$e$ 是元电荷。假设除了速度截断外，该分布在速度空间中保持各向同性，并且鞘层内的碰撞可以忽略不计。\n\n由电子带向壁面的能量通量密度（热通量）的动力学定义为\n$$\nq \\;=\\; \\int_{v_{x}  0} \\frac{1}{2} m_{e} v^{2} \\, v_{x} \\, f(\\mathbf{v}) \\, d^{3}v,\n$$\n其中 $v_{x}$ 是垂直于壁面且指向壁面的速度分量。使用动力学理论的第一性原理和上述模型，推导比值\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{q_{t}}{q_{M}},\n$$\n的精确闭式解析表达式，其中 $q_{t}$ 是从 $f_{t}$ 得到的热通量，$q_{M}$ 是从 $f_{M}$ 得到的热通量，而 $\\chi = \\frac{e \\Phi_{s}}{k_{B} T_{e}}$ 是无量纲鞘层电势。将您的最终答案表示为一个仅含 $\\chi$ 的单一简化解析表达式。无需进行数值计算，且最终答案中不应包含单位。",
            "solution": "由电子带向壁面的热通量密度 q 由动力学定义给出：\n$$\nq \\;=\\; \\int_{v_{x}  0} \\frac{1}{2} m_{e} v^{2} \\, v_{x} \\, f(\\mathbf{v}) \\, d^{3}v\n$$\n其中 $v_{x}$ 是垂直于壁面的速度分量。为计算该积分，我们切换到速度空间中的球坐标系，其中 $\\mathbf{v} = (v, \\theta, \\phi)$，$v$ 是速率，$\\theta$ 是相对于x轴的极角，$\\phi$ 是方位角。各分量为 $v_x = v \\cos\\theta$，$v_y = v \\sin\\theta \\cos\\phi$，$v_z = v \\sin\\theta \\sin\\phi$。体元为 $d^3v = v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$。积分域 $v_x  0$ 对应于 $0 \\le \\theta  \\pi/2$，而 $v \\ge 0$ 且 $0 \\le \\phi  2\\pi$。\n\n问题指明麦克斯韦分布 $f_M(\\mathbf{v})$ 和截断分布 $f_t(\\mathbf{v})$ 都是各向同性的，这意味着它们只依赖于速率 $v=|\\mathbf{v}|$。对于任何此类各向同性分布 $f(v)$，热通量积分变为：\n$$\nq \\;=\\; \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi/2} d\\theta \\int_{0}^{\\infty} dv \\, \\left( \\frac{1}{2} m_{e} v^{2} \\right) (v \\cos\\theta) (f(v)) (v^2 \\sin\\theta)\n$$\n角度积分可以独立于速率积分进行：\n$$\n\\int_{0}^{2\\pi} d\\phi = 2\\pi\n$$\n$$\n\\int_{0}^{\\pi/2} \\sin\\theta \\cos\\theta \\, d\\theta = \\left[ \\frac{1}{2}\\sin^2\\theta \\right]_{0}^{\\pi/2} = \\frac{1}{2}\n$$\n代入这些结果，热通量的表达式简化为：\n$$\nq \\;=\\; (2\\pi) \\left(\\frac{1}{2}\\right) \\int_{0}^{\\infty} \\frac{1}{2} m_{e} v^{5} f(v) \\, dv \\;=\\; \\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f(v) \\, dv\n$$\n我们需要求出比值 $\\mathcal{R}(\\chi) = q_t/q_M$。由于分布 $f_M(v)$ 和 $f_t(v)$ 都是各向同性的，我们可以使用 $q$ 的简化表达式。\n\n对于完整的麦克斯韦分布 $f_M(v)$，热通量为：\n$$\nq_{M} \\;=\\; \\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f_{M}(v) \\, dv\n$$\n对于截断的麦克斯韦分布 $f_t(v)$，热通量为：\n$$\nq_{t} \\;=\\; \\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f_{t}(v) \\, dv\n$$\n根据定义，$f_t(v) = f_M(v)$ 对 $v \\ge v_c$ 成立，而 $f_t(v)=0$ 对 $v  v_c$ 成立。因此，$q_t$ 的积分下限为 $v_c$：\n$$\nq_{t} \\;=\\; \\frac{\\pi m_e}{2} \\int_{v_c}^{\\infty} v^{5} f_{M}(v) \\, dv\n$$\n因此，比值 $\\mathcal{R}(\\chi)$ 是这两个积分的比值，因为前面的系数会相互抵消：\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{q_t}{q_M} \\;=\\; \\frac{\\frac{\\pi m_e}{2} \\int_{v_c}^{\\infty} v^{5} f_{M}(v) \\, dv}{\\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f_{M}(v) \\, dv} \\;=\\; \\frac{\\int_{v_c}^{\\infty} v^{5} f_{M}(v) \\, dv}{\\int_{0}^{\\infty} v^{5} f_{M}(v) \\, dv}\n$$\n麦克斯韦分布为 $f_{M}(v) = n_{e}\\left(\\frac{m_{e}}{2\\pi k_{B} T_{e}}\\right)^{3/2}\\exp\\left(-\\frac{m_{e} v^{2}}{2 k_{B} T_{e}}\\right)$。常数系数 $n_{e}\\left(\\frac{m_{e}}{2\\pi k_{B} T_{e}}\\right)^{3/2}$ 也会从分子和分母中消去。我们定义一个新变量 $x = \\frac{m_e v^2}{2 k_B T_e}$。这得到 $v = \\sqrt{\\frac{2 k_B T_e}{m_e} x}$ 和 $dv = \\frac{1}{2} \\sqrt{\\frac{2 k_B T_e}{m_e}} x^{-1/2} dx$。\n$v^5$ 项变为 $\\left(\\frac{2 k_B T_e}{m_e}\\right)^{5/2} x^{5/2}$。\n$v^5 dv$ 项变为 $\\frac{1}{2}\\left(\\frac{2 k_B T_e}{m_e}\\right)^3 x^2 dx$。\n指数项变为 $\\exp(-x)$。\n积分变为：\n$$\n\\int v^5 \\exp\\left(-\\frac{m_e v^2}{2 k_B T_e}\\right) dv \\;=\\; \\frac{1}{2}\\left(\\frac{2 k_B T_e}{m_e}\\right)^3 \\int x^2 \\exp(-x) dx\n$$\n系数 $\\frac{1}{2}\\left(\\frac{2 k_B T_e}{m_e}\\right)^3$ 是常数，将在比值中消去。我们只需要考虑对 $x$ 的积分。\n\n分子中的积分下限是 $v_c = \\sqrt{2e\\Phi_s/m_e}$。用 $x$ 表示，这变为：\n$$\nx_c \\;=\\; \\frac{m_e v_c^2}{2 k_B T_e} \\;=\\; \\frac{m_e}{2 k_B T_e} \\left(\\frac{2e\\Phi_s}{m_e}\\right) \\;=\\; \\frac{e\\Phi_s}{k_B T_e} \\;=\\; \\chi\n$$\n分母积分的下限是 $v=0$，对应于 $x=0$。\n比值 $\\mathcal{R}(\\chi)$ 现在是：\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{\\int_{\\chi}^{\\infty} x^2 \\exp(-x) dx}{\\int_{0}^{\\infty} x^2 \\exp(-x) dx}\n$$\n分母是完全伽马函数 $\\Gamma(3)$：\n$$\n\\int_{0}^{\\infty} x^2 \\exp(-x) dx = \\Gamma(3) = (3-1)! = 2! = 2\n$$\n分子是上不完全伽马函数 $\\Gamma(3, \\chi)$。我们可以通过两次分部积分来计算它：\n$$\n\\int x^2 \\exp(-x) dx = -x^2\\exp(-x) - \\int (- \\exp(-x))(2x) dx = -x^2\\exp(-x) + 2\\int x\\exp(-x) dx\n$$\n$$\n\\int x\\exp(-x) dx = -x\\exp(-x) - \\int(-\\exp(-x))dx = -x\\exp(-x) - \\exp(-x) = -(x+1)\\exp(-x)\n$$\n结合以上结果：\n$$\n\\int x^2 \\exp(-x) dx = -x^2\\exp(-x) + 2(-(x+1)\\exp(-x)) = (-x^2 - 2x - 2)\\exp(-x)\n$$\n现在我们计算分子的定积分：\n$$\n\\int_{\\chi}^{\\infty} x^2 \\exp(-x) dx = \\left[ (-x^2 - 2x - 2)\\exp(-x) \\right]_{\\chi}^{\\infty}\n$$\n当 $x \\to \\infty$ 时，该项的计算结果为 $0$。在下限 $x=\\chi$ 处，其值为 $(-\\chi^2 - 2\\chi - 2)\\exp(-\\chi)$。\n$$\n\\int_{\\chi}^{\\infty} x^2 \\exp(-x) dx = 0 - ((-\\chi^2 - 2\\chi - 2)\\exp(-\\chi)) = (\\chi^2 + 2\\chi + 2)\\exp(-\\chi)\n$$\n最后，我们计算比值 $\\mathcal{R}(\\chi)$：\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{(\\chi^2 + 2\\chi + 2)\\exp(-\\chi)}{2} \\;=\\; \\frac{1}{2}(\\chi^2 + 2\\chi + 2)\\exp(-\\chi)\n$$\n这就是热通量之比的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{2}(\\chi^{2} + 2\\chi + 2)\\exp(-\\chi)}\n$$"
        },
        {
            "introduction": "最后的这项实践是连接理论与计算的桥梁，这正是计算聚变科学的一项核心技能。我们将设计一种数值方案，在离散的速度空间网格上表示连续的麦克斯韦分布 ()。这涉及到选择一种合适的求积方法（高斯-拉盖尔求积），以确保密度和温度等关键物理量是守恒的，这是精确动理学模拟的一项至关重要的要求。",
            "id": "3975349",
            "problem": "您的任务是设计一个具有 $N_v$ 个点的速度空间离散化方案，以表示等离子体中的各向同性麦克斯韦平衡，并指定量化标准，以确保在保持数密度 $n$ 和温度 $T$ 守恒的同时，准确捕捉指数尾部。设计必须从动理学第一性原理出发，并严格处理无限速度域。目标是生成一个程序，该程序能够构建离散化方案，计算用于速度空间矩的守恒求积权重，并在一组给定的测试套件上评估尾部分辨率标准和守恒误差。\n\n此任务的基本依据：\n- 三维速度空间中的各向同性麦克斯韦分布由一个粒子分布函数 $f(\\mathbf{v})$ 定义，该函数取决于速率 $v = \\lVert \\mathbf{v} \\rVert$。该分布必须对 $\\mathrm{d}^3 v$ 进行积分以获得宏观矩，如数密度和温度。\n- 数密度满足 $n = \\int f(\\mathbf{v}) \\, \\mathrm{d}^3 v$。\n- 温度（通过每个粒子的动能表示）满足 $n \\, E_T = \\dfrac{m}{3} \\int v^2 f(\\mathbf{v}) \\, \\mathrm{d}^3 v$，其中 $m$ 是粒子质量，$E_T = k_B T$ 是每个粒子的热能。本问题中的温度以电子伏特为单位指定，必须使用 $E_T = T \\times q_e$（其中 $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{J/eV}$）将其转换为焦耳。\n- 麦克斯韦分布通过参数 $a = \\dfrac{m}{2 E_T}$ 依赖于热速率。\n\n设计要求：\n1. 构建一个速度空间网格 $\\{ v_i \\}_{i=1}^{N_v}$ 和相关的正求积权重 $\\{ W_i \\}_{i=1}^{N_v}$，使得对于任何各向同性函数 $g(v)$，速度空间上的积分可以近似为\n   $$ \\int_0^{\\infty} 4\\pi v^2 g(v) \\, \\mathrm{d}v \\approx \\sum_{i=1}^{N_v} W_i \\, g(v_i). $$\n   $\\{ v_i, W_i \\}$ 的选择必须基于麦克斯韦分布的结构和无限定义域的特点。\n2. 以容差 $\\epsilon_{\\mathrm{tail}}$ 的形式陈述并执行一个量化的尾部分辨率标准，以保证网格延伸到麦克斯韦分布幅度低于 $\\epsilon_{\\mathrm{tail}}$ 的区域。该标准必须从麦克斯韦分布的指数衰减尺度推导得出，并且必须可以直接根据网格参数进行检验。用最大网格横坐标和 $\\epsilon_{\\mathrm{tail}}$ 明确表达该标准。\n3. 通过从麦克斯韦分布的网格计算离散数密度和温度来展示守恒性，并报告相对误差\n   $$ \\delta_n = \\left| \\frac{n_{\\mathrm{disc}} - n}{n} \\right|, \\qquad \\delta_T = \\left| \\frac{T_{\\mathrm{disc}} - T}{T} \\right|, $$\n   其中 $n_{\\mathrm{disc}} = \\sum_{i=1}^{N_v} W_i f(v_i)$ 且 $T_{\\mathrm{disc}}$ 通过离散二阶速度矩从关系式 $n \\, E_T = \\dfrac{m}{3} \\int v^2 f(\\mathbf{v}) \\, \\mathrm{d}^3 v$ 获得。\n\n程序规格：\n- 使用与上述动理学定义一致的三维各向同性麦克斯韦分布 $f(v)$。\n- 将温度从电子伏特转换为焦耳，即使用 $E_T = T \\times q_e$，其中 $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{J/eV}$。\n- 使用以下测试套件。每个测试用例是一个元组 $(N_v, n, T, m, \\epsilon_{\\mathrm{tail}})$，单位如下：\n  - $N_v$：速度网格点的整数数量。\n  - $n$：数密度，单位为 $\\mathrm{m}^{-3}$。\n  - $T$：温度，单位为 $\\mathrm{eV}$。\n  - $m$：粒子质量，单位为 $\\mathrm{kg}$。\n  - $\\epsilon_{\\mathrm{tail}}$：无量纲的尾部容差（以小数表示）。\n  待评估的测试套件是：\n  1. $(16, \\ 1.0 \\times 10^{19} \\ \\mathrm{m}^{-3}, \\ 15000 \\ \\mathrm{eV}, \\ 3.343583719 \\times 10^{-27} \\ \\mathrm{kg}, \\ 1.0 \\times 10^{-10})$，\n  2. $(2, \\ 5.0 \\times 10^{18} \\ \\mathrm{m}^{-3}, \\ 20 \\ \\mathrm{eV}, \\ 9.1093837015 \\times 10^{-31} \\ \\mathrm{kg}, \\ 1.0 \\times 10^{-4})$，\n  3. $(3, \\ 1.0 \\times 10^{18} \\ \\mathrm{m}^{-3}, \\ 5000 \\ \\mathrm{eV}, \\ 5.006412 \\times 10^{-27} \\ \\mathrm{kg}, \\ 1.0 \\times 10^{-8})$，\n  4. $(1, \\ 1.0 \\times 10^{20} \\ \\mathrm{m}^{-3}, \\ 1000 \\ \\mathrm{eV}, \\ 1.67262192369 \\times 10^{-27} \\ \\mathrm{kg}, \\ 5.0 \\times 10^{-1})$。\n- 对于每个测试用例，您的程序必须构建网格和权重，计算 $(\\delta_n, \\delta_T)$，并评估尾部分辨率布尔值\n  $$ b_{\\mathrm{tail}} = \\left( e^{-x_{\\max}} \\le \\epsilon_{\\mathrm{tail}} \\right), $$\n  其中 $x_{\\max}$ 是对应于速度网格设计的最大无量纲横坐标。\n- 输出格式：您的程序应生成单行输出，其中包含每个测试用例的结果列表，每个结果都是 $[b_{\\mathrm{tail}}, \\delta_n, \\delta_T]$ 形式的列表。最终输出必须是精确的单行格式\n  $$ [ [b_{\\mathrm{tail},1}, \\delta_{n,1}, \\delta_{T,1}], [b_{\\mathrm{tail},2}, \\delta_{n,2}, \\delta_{T,2}], [b_{\\mathrm{tail},3}, \\delta_{n,3}, \\delta_{T,3}], [b_{\\mathrm{tail},4}, \\delta_{n,4}, \\delta_{T,4}] ]。 $$\n所有误差的数值输出必须是无量纲小数。不涉及角度，因此不需要角度单位。所有物理输入均使用国际单位制（SI）。",
            "solution": "该问题要求设计一种用于各向同性麦克斯韦分布的速度空间离散化方案，包括构建能够保持粒子数和能量守恒的求积点和权重，以及一个用于解析分布指数尾部的标准。该解决方案必须从动理学的第一性原理推导得出。\n\n三维各向同性麦克斯韦分布函数 $f(\\mathbf{v})$ 仅依赖于速率 $v = \\lVert \\mathbf{v} \\rVert$，并由下式给出：\n$$ f(v) = n \\left(\\frac{m}{2\\pi E_T}\\right)^{3/2} \\exp\\left(-\\frac{m v^2}{2 E_T}\\right), $$\n其中 $n$ 是数密度，$m$ 是粒子质量，$E_T = k_B T$ 是热能。对于本问题，温度以电子伏特给出，必须使用 $E_T = T \\times q_e$（其中 $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{J/eV}$）转换为焦耳。该分布被归一化，使其在整个速度空间上的积分得到数密度，即 $\\int f(\\mathbf{v}) \\, \\mathrm{d}^3v = n$。在球速度坐标系中，这个积分是 $\\int_0^\\infty 4\\pi v^2 f(v) \\, \\mathrm{d}v = n$。\n\n核心任务是设计一个求积法则——即一组网格点（横坐标） $\\{v_i\\}_{i=1}^{N_v}$ 和权重 $\\{W_i\\}_{i=1}^{N_v}$——能够为各向同性函数 $g(v)$ 精确地近似在无限速度域上的积分：\n$$ \\mathcal{I}[g] = \\int_0^\\infty 4\\pi v^2 g(v) \\, \\mathrm{d}v \\approx \\sum_{i=1}^{N_v} W_i g(v_i). $$\n该设计必须受麦克斯韦分布结构的启发。关键的思路是进行变量替换，从速率 $v$ 替换为一个无量纲能量，以简化麦克斯韦分布中的指数项。设动能为 $\\mathcal{E} = \\frac{1}{2} m v^2$，并定义无量纲能量为 $\\xi = \\mathcal{E}/E_T = \\frac{m v^2}{2 E_T}$。通过此代换，指数项变为简单的 $e^{-\\xi}$。\n\n我们使用此变量替换来变换积分 $\\mathcal{I}[g]$。从 $\\xi = \\frac{m v^2}{2 E_T}$，我们有 $v = \\sqrt{2 \\xi E_T / m}$ 和 $\\mathrm{d}v = \\sqrt{2 E_T / m} \\cdot \\frac{1}{2\\sqrt{\\xi}} \\, \\mathrm{d}\\xi$。体积元 $4\\pi v^2 \\, \\mathrm{d}v$ 变为：\n$$ 4\\pi v^2 \\, \\mathrm{d}v = 4\\pi \\left(\\frac{2 \\xi E_T}{m}\\right) \\left(\\sqrt{\\frac{2 E_T}{m}} \\frac{1}{2\\sqrt{\\xi}}\\right) \\, \\mathrm{d}\\xi = \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}} \\sqrt{\\xi} \\, \\mathrm{d}\\xi. $$\n积分 $\\mathcal{I}[g]$ 变换如下：\n$$ \\mathcal{I}[g] = \\int_0^\\infty g(v) (4\\pi v^2 \\, \\mathrm{d}v) = \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}} \\int_0^\\infty \\sqrt{\\xi} \\, g\\left(\\sqrt{\\frac{2 \\xi E_T}{m}}\\right) \\, \\mathrm{d}\\xi. $$\n这一变换揭示了在无量纲能量空间中的态密度与 $\\sqrt{\\xi} = \\xi^{1/2}$ 成正比。现在，该积分的形式天然适合一种特定类型的数值求积方法。麦克斯韦分布本身，当用 $\\xi$ 表示时，包含因子 $e^{-\\xi}$。结合这些见解，麦克斯韦分布的矩涉及形如 $\\int_0^\\infty \\xi^\\alpha e^{-\\xi} p(\\xi) \\, \\mathrm{d}\\xi$ 的积分，其中 $p(\\xi)$ 是 $\\xi$ 的多项式。\n\n这种结构直接指向了广义 Gauss-Laguerre 求积法的使用，该方法旨在精确积分形如 $x^\\alpha e^{-x} P(x)$ 的函数，其中 $P(x)$ 是一个次数最高为 $2N_v-1$ 的多项式。我们积分的结构，带有 $\\sqrt{\\xi} = \\xi^{1/2}$ 项，建议选择参数 $\\alpha=1/2$。该求积法则将积分近似为：\n$$ \\int_0^\\infty x^{1/2} h(x) \\, \\mathrm{d}x \\approx \\sum_{j=1}^{N_v} w_j^{\\text{GLa}} h(x_j), $$\n其中 $\\{x_j, w_j^{\\text{GLa}}\\}_{j=1}^{N_v}$ 是阶数为 $N_v$ 且 $\\alpha=1/2$ 的广义 Gauss-Laguerre 求积的横坐标和权重。\n\n将此应用于我们变换后的积分 $\\mathcal{I}[g]$，我们将 $x$ 与 $\\xi$ 等同，将 $h(x)$ 与其余项等同：\n$$ \\mathcal{I}[g] = \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}} \\int_0^\\infty \\xi^{1/2} \\, g\\left(\\sqrt{\\frac{2 \\xi E_T}{m}}\\right) \\, \\mathrm{d}\\xi \\approx \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}} \\sum_{j=1}^{N_v} w_j^{\\text{GLa}} \\, g\\left(\\sqrt{\\frac{2 \\xi_j E_T}{m}}\\right). $$\n这里，$\\{\\xi_j\\}$ 是求积横坐标。通过将此近似值与所需形式 $\\sum_{i=1}^{N_v} W_i g(v_i)$ 进行比较，我们可以定义我们的速度网格点和求积权重：\n1.  **速度横坐标**：$v_j = \\sqrt{\\frac{2 \\xi_j E_T}{m}}$，对于 $j=1, \\dots, N_v$。\n2.  **求积权重**：$W_j = \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}} w_j^{\\text{GLa}}$，对于 $j=1, \\dots, N_v$。\n\n通过这种设计，我们可以评估守恒性和尾部分辨率标准。\n\n**尾部分辨率标准：**\n该标准检查网格是否充分延伸到麦克斯韦分布的尾部。衰减由 $e^{-\\xi}$ 控制。问题将标准指定为 $e^{-x_{\\max}} \\le \\epsilon_{\\mathrm{tail}}$，其中 $x_{\\max}$ 是最大的无量纲横坐标。在我们的设计中，无量纲横坐标是广义 Laguerre 多项式的根 $\\{\\xi_j\\}$。因此，我们设 $x_{\\max} = \\max(\\{\\xi_j\\})$。布尔测试是：\n$$ b_{\\mathrm{tail}} = \\left( \\exp(-\\max(\\{\\xi_j\\})) \\le \\epsilon_{\\mathrm{tail}} \\right). $$\n\n**数密度和温度的守恒性：**\n离散数密度 $n_{\\mathrm{disc}}$ 是通过将求积应用于分布函数本身来计算的，即设 $g(v) = f(v)$：\n$$ n_{\\mathrm{disc}} = \\sum_{j=1}^{N_v} W_j f(v_j). $$\n密度守恒的相对误差为 $\\delta_n = |n_{\\mathrm{disc}}/n - 1|$。\n\n温度与分布的二阶速度矩有关。平均动能是 $\\frac{3}{2}E_T = \\frac{1}{n} \\int \\frac{1}{2} m v^2 f(\\mathbf{v}) \\, \\mathrm{d}^3v$。整理后可得 $n E_T = \\frac{m}{3} \\int v^2 f(v) 4\\pi v^2 \\, \\mathrm{d}v$。我们从这个矩的离散版本计算离散热能 $E_{T, \\mathrm{disc}}$：\n$$ n E_{T, \\mathrm{disc}} = \\frac{m}{3} \\sum_{j=1}^{N_v} W_j v_j^2 f(v_j). $$\n这得到 $E_{T, \\mathrm{disc}} = \\frac{m}{3n} \\sum_{j=1}^{N_v} W_j v_j^2 f(v_j)$。相应的离散温度是 $T_{\\mathrm{disc}} = E_{T, \\mathrm{disc}} / q_e$。温度的相对误差是 $\\delta_T = |T_{\\mathrm{disc}}/T - 1| = |E_{T, \\mathrm{disc}}/E_T - 1|$。\n\n因此，实现将包括：\n1.  对于每个测试用例，计算 $E_T$。\n2.  使用 `scipy.special.roots_genlaguerre(Nv, 0.5)` 获取基本横坐标 $\\{\\xi_j\\}$ 和权重 $\\{w_j^{\\text{GLa}}\\}$。\n3.  根据推导出的公式构建速度网格 $\\{v_j\\}$ 和最终权重 $\\{W_j\\}$。\n4.  在网格点上评估麦克斯韦函数 $f(v_j)$。\n5.  通过求和计算 $n_{\\mathrm{disc}}$ 和 $E_{T, \\mathrm{disc}}$。\n6.  计算相对误差 $\\delta_n$ 和 $\\delta_T$。\n7.  检查尾部分辨率标准 $b_{\\mathrm{tail}}$。\n8.  按要求格式化结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_genlaguerre\n\ndef solve():\n    \"\"\"\n    Designs a velocity-space discretization for an isotropic Maxwellian,\n    constructs conservative quadrature weights, and evaluates tail resolution\n    and conservation errors for a suite of test cases.\n    \"\"\"\n    # Physical constant\n    # Elementary charge in J/eV\n    q_e = 1.602176634e-19\n\n    # Test suite: (Nv, n, T, m, epsilon_tail)\n    test_cases = [\n        (16, 1.0e19, 15000.0, 3.343583719e-27, 1.0e-10),  # Deuterium-like\n        (2, 5.0e18, 20.0, 9.1093837015e-31, 1.0e-4),    # Electron-like\n        (3, 1.0e18, 5000.0, 5.006412e-27, 1.0e-8),      # Helium3-like\n        (1, 1.0e20, 1000.0, 1.67262192369e-27, 5.0e-1)     # Proton-like\n    ]\n\n    results = []\n    for Nv, n, T, m, epsilon_tail in test_cases:\n        # Step 1: Calculate thermal energy in Joules\n        E_T = T * q_e\n\n        # Step 2: Generate base abscissae and weights for generalized\n        # Gauss-Laguerre quadrature with alpha = 1/2.\n        # This is for integrals of the form integral(x^(1/2) * exp(-x) * h(x)) dx\n        xi, w_gla = roots_genlaguerre(Nv, 0.5)\n\n        # Step 3: Construct the velocity grid and final quadrature weights\n        # v_j = sqrt(2 * xi_j * E_T / m)\n        v = np.sqrt(2 * xi * E_T / m)\n        \n        # W_j = (4*pi*sqrt(2)*E_T^(3/2) / m^(3/2)) * w_gla_j\n        weight_factor = (4 * np.pi * np.sqrt(2) * E_T**1.5) / (m**1.5)\n        W = weight_factor * w_gla\n\n        # Step 4: Define and evaluate the Maxwellian distribution function\n        # f(v) = n * (m / (2*pi*E_T))^(3/2) * exp(-m*v^2 / (2*E_T))\n        norm_const = n * (m / (2 * np.pi * E_T))**1.5\n        # Note: m*v^2/(2*E_T) is just xi\n        f_vals = norm_const * np.exp(-xi)\n\n        # Step 5: Compute discrete number density and its relative error\n        n_disc = np.sum(W * f_vals)\n        delta_n = np.abs(n_disc / n - 1.0)\n\n        # Step 6: Compute discrete temperature and its relative error\n        # E_T_disc = (m / (3*n)) * sum(W_j * v_j^2 * f(v_j))\n        moment_2 = np.sum(W * v**2 * f_vals)\n        E_T_disc = (m / (3.0 * n)) * moment_2\n        delta_T = np.abs(E_T_disc / E_T - 1.0)\n\n        # Step 7: Evaluate the tail-resolution criterion\n        # b_tail = (exp(-max(xi)) = epsilon_tail)\n        x_max = np.max(xi)\n        b_tail = np.exp(-x_max) = epsilon_tail\n\n        # Step 8: Store the results for this test case\n        results.append([b_tail, delta_n, delta_T])\n\n    # Final print statement in the exact required format.\n    # Convert boolean to lowercase string for JSON-like format\n    formatted_results = []\n    for res in results:\n        b, dn, dt = res\n        b_str = 'true' if b else 'false'\n        formatted_results.append(f\"[{b_str},{dn:.15e},{dt:.15e}]\")\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}