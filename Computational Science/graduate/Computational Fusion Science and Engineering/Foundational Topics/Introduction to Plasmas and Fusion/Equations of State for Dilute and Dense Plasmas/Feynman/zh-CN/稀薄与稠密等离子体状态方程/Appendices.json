{
    "hands_on_practices": [
        {
            "introduction": "任何关于物态方程的深入研究都始于最简单的模型：理想等离子体。此练习将作为我们的起点，我们将理想气体定律应用于由电子和离子组成的双组分等离子体，这是对某些聚变实验中常见的稀薄、高温条件的有效近似。通过这个实践，你将掌握根据各组分的分压计算总压力的基本技能，为后续更复杂的模型建立一个重要的基准。",
            "id": "3974789",
            "problem": "考虑一个在国际单位制 (SI) 下的均匀、准中性、完全电离的氢等离子体，其电子数密度 $n_e$ 和离子数密度 $n_i$ 满足 $n_e = n_i = 10^{19}\\,\\mathrm{m}^{-3}$。假设电子和离子是经典的、非简并的、非相对论性的，并且每种粒子在共同的动能温度 $T = 10\\,\\mathrm{eV}$ 下都具有麦克斯韦速度分布，其中电子伏特 (eV) 的定义为 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$，基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。从理想单原子气体的气体动理论压强定义以及适用于稀薄、弱耦合等离子体的热力学假设出发，推导该双组分混合物的总压强表达式，用粒子数密度和温度表示。然后，在给定条件下数值计算总压强，并确定电子对总压强的贡献分数。最终压强以帕斯卡表示，贡献分数以无百分号的纯数（小数或分数）表示。将您的答案四舍五入到 $4$ 位有效数字。",
            "solution": "该问题被验证为有科学依据、良定、客观且完整。所有给定的条件和数据都是自洽的，并且对于实验室等离子体是现实的。\n\n推导从气体动理论开始。对于被视为理想单原子气体的单一种类粒子（例如电子或离子），施加在容器壁上的压强 $P$ 由单位面积上的平均动量传递率给出。这导出了以下表达式：\n$$P = \\frac{1}{3} n m \\langle v^2 \\rangle$$\n其中 $n$ 是粒子的数密度，$m$ 是单个粒子的质量，$\\langle v^2 \\rangle$ 是粒子的均方速率。\n\n问题指出，每种粒子在动能温度 $T$ 下都具有麦克斯韦速度分布。对于三维空间中的麦克斯韦气体，能量均分定理指出，每个粒子的平均动能与温度的关系如下：\n$$\\frac{1}{2} m \\langle v^2 \\rangle = \\frac{3}{2} k_B T$$\n其中 $k_B$ 是玻尔兹曼常数。由此，我们可以得到：\n$$m \\langle v^2 \\rangle = 3 k_B T$$\n\n将此结果代回压强的动力学表达式，我们得到单一组分的理想气体定律：\n$$P = \\frac{1}{3} n (3 k_B T) = n k_B T$$\n\n问题描述的是一种稀薄、弱耦合等离子体，它是两种粒子——电子（下标为 $e$）和离子（下标为 $i$）的混合物。在这种混合物中，确定状态方程时可以忽略粒子间的相互作用。因此，根据道尔顿分压定律 (Dalton's Law of Partial Pressures)，总压强 $P_{total}$ 是各组成组分分压的总和。\n$$P_{total} = P_e + P_i$$\n每种粒子都被视为理想气体，因此它们的分压由下式给出：\n$$P_e = n_e k_B T_e$$\n$$P_i = n_i k_B T_i$$\n其中 $n_e$ 和 $T_e$ 分别是电子的数密度和温度，$n_i$ 和 $T_i$ 分别是离子的数密度和温度。\n\n问题为两种粒子指定了共同的动能温度，因此 $T_e = T_i = T$。总压强因此为：\n$$P_{total} = n_e k_B T + n_i k_B T = (n_e + n_i) k_B T$$\n这是处于热平衡状态的双组分理想等离子体总压强的通用表达式。\n\n问题提供了以下数值：\n电子数密度：$n_e = 10^{19}\\,\\mathrm{m}^{-3}$\n离子数密度：$n_i = 10^{19}\\,\\mathrm{m}^{-3}$\n动能温度：$T = 10\\,\\mathrm{eV}$\n\n请注意，在等离子体物理学中，温度常以电子伏特 ($\\mathrm{eV}$) 为单位。这是关于平均热能 $k_B T$ 的一种表述。换算关系为 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$，其中 $e$ 是基本电荷。因此，热能为：\n$$k_B T = 10\\,\\mathrm{eV} = 10 \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (1\\,\\mathrm{J/C}) = 1.602176634 \\times 10^{-18}\\,\\mathrm{J}$$\n\n现在我们可以计算总压强。\n$$P_{total} = (n_e + n_i) k_B T$$\n$$P_{total} = (10^{19}\\,\\mathrm{m}^{-3} + 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-18}\\,\\mathrm{J})$$\n$$P_{total} = (2 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-18}\\,\\mathrm{J})$$\n$$P_{total} = 3.204353268 \\times 10^{1}\\,\\mathrm{J/m^3}$$\n由于 $1\\,\\mathrm{J/m^3} = 1\\,\\mathrm{Pa}$，总压强为：\n$$P_{total} = 32.04353268\\,\\mathrm{Pa}$$\n四舍五入到 $4$ 位有效数字，我们得到：\n$$P_{total} \\approx 32.04\\,\\mathrm{Pa}$$\n\n接下来，我们确定电子对总压强的贡献分数。这个分数 $f_e$ 由电子分压与总压强之比给出：\n$$f_e = \\frac{P_e}{P_{total}} = \\frac{n_e k_B T}{(n_e + n_i) k_B T}$$\n$k_B T$ 项被消去，剩下：\n$$f_e = \\frac{n_e}{n_e + n_i}$$\n使用给定的数密度 $n_e = n_i = 10^{19}\\,\\mathrm{m}^{-3}$：\n$$f_e = \\frac{10^{19}}{10^{19} + 10^{19}} = \\frac{10^{19}}{2 \\times 10^{19}} = \\frac{1}{2}$$\n作为小数，其值为 $0.5$。问题要求答案四舍五入到 $4$ 位有效数字，这给出：\n$$f_e = 0.5000$$\n这个结果与温度无关，仅取决于相对数密度。由于在完全电离的氢等离子体中电子和离子的数密度相等，它们对总压强的贡献也相等。",
            "answer": "$$\\boxed{\\begin{pmatrix} 32.04 & 0.5000 \\end{pmatrix}}$$"
        },
        {
            "introduction": "当等离子体密度增加时，粒子间的相互作用变得不可忽略，理想气体模型也随之失效。本练习将引导你进入非理想等离子体的领域，引入一个关键的无量纲参数——库仑耦合参数 $\\Gamma$。通过计算 $\\Gamma$，我们可以量化平均相互作用势能与热动能的比值，从而判断等离子体是否进入“强耦合”状态，并为采用如单组分等离子体（OCP）模型等更高级的理论框架提供物理依据。",
            "id": "3974855",
            "problem": "一个完全电离的碳等离子体的特征是离子电荷数 $Z=6$，温度 $T=1\\,\\mathrm{eV}$，以及离子数密度 $n_i=10^{28}\\,\\mathrm{m}^{-3}$。从第一性原理出发，将离子的库仑耦合参数定义为特征库仑势能与特征热能之比。使用通过 Wigner-Seitz 结构估算的平均离子间距（通过离子数密度表示）作为相互作用的特征长度尺度。推导离子库仑耦合参数 $\\Gamma$ 关于 $Z$、$n_i$ 和 $T$ 的闭式表达式，然后计算其对于给定等离子体的数值。将您计算的 $\\Gamma$ 值四舍五入到三位有效数字，并以无单位的无量纲数形式报告。\n\n计算出 $\\Gamma$ 后，简要评估基于单组分等离子体 (OCP) 模型的状态方程是否适用于该等离子体中的离子，并说明指导此评估的物理判据。\n\n使用以下常数：\n- 基本电荷 $e=1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$，\n- 真空介电常数 $\\varepsilon_0=8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m}$，\n- 玻尔兹曼常数 $k_B=1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$，\n- 能量转换 $1\\,\\mathrm{eV}=1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$。",
            "solution": "该问题是有效的，因为它具有科学依据、提法得当且客观。它提出了一个等离子体物理学中的标准问题，可以使用基本原理和所提供的数据来解决。\n\n离子库仑耦合参数，记为 $\\Gamma$，定义为两个离子间的特征库仑势能 $U_C$ 与特征热能 $E_{th}$ 之比。\n$$\n\\Gamma = \\frac{U_C}{E_{th}}\n$$\n温度为 $T$ 的离子的特征热能由 $k_B T$ 给出，其中 $k_B$ 是玻尔兹曼常数。\n$$\nE_{th} = k_B T\n$$\n特征库仑势能 $U_C$ 是两个离子在特征分离距离处的静电势能。对于完全电离的碳等离子体，每个离子的电荷为 $q=Ze$，其中 $Z=6$ 是离子电荷数，$e$ 是基本电荷。问题指明特征分离距离应为 Wigner-Seitz 半径 $a$。该半径定义为一个球体的半径，该球体平均包含一个离子。该球体的体积 $V_{ion} = \\frac{4}{3}\\pi a^3$ 是离子数密度 $n_i$ 的倒数。\n$$\n\\frac{4}{3}\\pi a^3 = \\frac{1}{n_i}\n$$\n求解 Wigner-Seitz 半径 $a$：\n$$\na = \\left( \\frac{3}{4\\pi n_i} \\right)^{1/3}\n$$\n根据库仑定律，两个电荷为 $Ze$、相距为 $a$ 的离子之间的库仑势能为：\n$$\nU_C = \\frac{1}{4\\pi\\varepsilon_0} \\frac{(Ze)(Ze)}{a} = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a}\n$$\n其中 $\\varepsilon_0$ 是真空介电常数。\n将 $E_{th}$、$U_C$ 和 $a$ 的表达式代入 $\\Gamma$ 的定义，我们得到离子库仑耦合参数的闭式表达式：\n$$\n\\Gamma = \\frac{\\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a}}{k_B T} = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a k_B T}\n$$\n代入 $a$ 的表达式：\n$$\n\\Gamma = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 k_B T} \\left( \\frac{1}{a} \\right) = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 k_B T} \\left( \\frac{4\\pi n_i}{3} \\right)^{1/3}\n$$\n现在我们计算给定等离子体参数下 $\\Gamma$ 的数值：\n- 离子电荷数：$Z=6$\n- 离子数密度：$n_i=10^{28}\\,\\mathrm{m}^{-3}$\n- 温度：$T=1\\,\\mathrm{eV}$。这是一个能量单位，因此它代表热能 $k_B T$。我们使用给定的转换因子将其转换为焦耳：$k_B T = 1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$。\n- 常数：\n  - $e=1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$\n  - $\\varepsilon_0=8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m}$\n\n首先，我们计算 Wigner-Seitz 半径 $a$：\n$$\na = \\left( \\frac{3}{4\\pi (10^{28}\\,\\mathrm{m}^{-3})} \\right)^{1/3} \\approx 2.8794 \\times 10^{-10}\\,\\mathrm{m}\n$$\n接下来，我们使用公式 $\\Gamma = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a k_B T}$ 计算 $\\Gamma$：\n$$\n\\Gamma = \\frac{1}{4\\pi\\varepsilon_0} \\frac{Z^2 e^2}{a (k_B T)}\n$$\n我们代入数值：\n$$\n\\Gamma = \\frac{1}{4\\pi (8.854\\,187\\,8128 \\times 10^{-12})} \\frac{(6 \\times 1.602\\,176\\,634 \\times 10^{-19})^2}{(2.8794 \\times 10^{-10}) (1.602\\,176\\,634 \\times 10^{-19})}\n$$\n$$\n\\Gamma \\approx (8.98755 \\times 10^9) \\frac{9.24109 \\times 10^{-37}}{4.61331 \\times 10^{-29}}\n$$\n$$\n\\Gamma \\approx (8.98755 \\times 10^9) \\times (2.00269 \\times 10^{-8})\n$$\n$$\n\\Gamma \\approx 180.03\n$$\n四舍五入到三位有效数字，值为 $\\Gamma \\approx 180$。\n\n接下来，我们评估基于单组分等离子体 (OCP) 模型的状态方程是否适用于该等离子体中的离子。OCP 模型将离子视为通过库仑势相互作用的单一种类的点电荷，浸没在刚性、均匀、电中性的相反电荷背景（电子）中。该模型的有效性取决于两个物理判据：\n1. 离子必须是强耦合的，这意味着它们的相互作用势能显著超过其动能。当离子耦合参数 $\\Gamma$ 远大于1时，此条件得到满足。在我们的例子中，$\\Gamma \\approx 180 \\gg 1$，所以离子确实是强耦合的。它们预计处于液态或类固态。\n\n2. 电子必须形成一个近乎理想的均匀背景。当电子高度量子简并时，这种情况就会发生。电子简并度由热能 $k_B T$ 与电子费米能 $E_F$ 的比值来衡量。简并参数为 $\\Theta_e = k_B T / E_F$。如果 $\\Theta_e \\ll 1$，则 OCP 模型适用。\n\n为了检验这个条件，我们首先根据电中性条件计算电子数密度 $n_e$：$n_e = Z n_i$。\n$$\nn_e = 6 \\times (10^{28}\\,\\mathrm{m}^{-3}) = 6 \\times 10^{28}\\,\\mathrm{m}^{-3}\n$$\n非相对论性电子气的费米能 $E_F$ 由以下公式给出：\n$$\nE_F = \\frac{\\hbar^2}{2m_e}(3\\pi^2 n_e)^{2/3}\n$$\n其中 $\\hbar$ 是约化普朗克常数，$m_e$ 是电子质量。\n$$\nE_F = \\frac{(1.05457 \\times 10^{-34}\\,\\mathrm{J\\cdot s})^2}{2(9.10938 \\times 10^{-31}\\,\\mathrm{kg})} (3\\pi^2 (6 \\times 10^{28}\\,\\mathrm{m}^{-3}))^{2/3}\n$$\n$$\nE_F \\approx (6.1042 \\times 10^{-39}\\,\\mathrm{J\\cdot m^2}) \\times (1.7765 \\times 10^{30}\\,\\mathrm{m}^{-3})^{2/3}\n$$\n$$\nE_F \\approx (6.1042 \\times 10^{-39}\\,\\mathrm{J\\cdot m^2}) \\times (1.4682 \\times 10^{20}\\,\\mathrm{m}^{-2}) \\approx 8.962 \\times 10^{-18}\\,\\mathrm{J}\n$$\n热能为 $k_B T = 1\\,\\mathrm{eV} = 1.602 \\times 10^{-19}\\,\\mathrm{J}$。电子简并参数为：\n$$\n\\Theta_e = \\frac{k_B T}{E_F} = \\frac{1.602 \\times 10^{-19}\\,\\mathrm{J}}{8.962 \\times 10^{-18}\\,\\mathrm{J}} \\approx 0.01787\n$$\n由于 $\\Theta_e \\approx 0.018 \\ll 1$，电子是高度简并的。它们的费米能远超过热能，这使它们表现得像一个近乎理想的高压量子气体，为离子形成了一个光滑的、电中性的背景。\n\n两个判据（$\\Gamma \\gg 1$ 和 $\\Theta_e \\ll 1$）都得到了很好的满足。因此，单组分等离子体模型是描述该等离子体离子状态方程的一个极好的近似。",
            "answer": "$$\\boxed{1.80 \\times 10^{2}}$$"
        },
        {
            "introduction": "在计算物理学中，一个理论模型的正确性不仅取决于其物理假设，还依赖于其数值实现的准确性。本练习将带你进入物态方程模型的计算实践核心，专注于一项基本而关键的验证任务：检验麦克斯韦关系。通过编写程序来数值验证热力学自洽性，你将学习如何确保你所构建的复杂数值模型严格遵守热力学基本定律，这是开发可靠模拟工具的必备技能。",
            "id": "3974863",
            "problem": "您收到的任务是为一种双组分经典等离子体的状态方程 (EOS) 实现一个数值一致性检验，该任务应用于计算聚变科学与工程领域。该检验针对的是通过亥姆霍兹自由能连接压强和熵的麦克斯韦关系式，这需要验证亥姆霍兹自由能的混合二阶导数相等，即等式 $\\left(\\partial P/\\partial T\\right)_V = \\left(\\partial S/\\partial V\\right)_T$ 成立。您的程序必须在温度和体积的矩形网格上构建一个 EOS 表，数值计算相关导数，并报告该等式在多个测试场景中是否在指定的容差范围内成立。\n\n基本原理和模型构建要求：\n- 使用亥姆霍兹自由能 $F(T,V,N_e,N_i)$，其中电子和离子的粒子数 $N_e$ 和 $N_i$ 是固定的。总亥姆霍兹自由能 $F$ 是电子和离子的理想气体贡献与一个非理想的过剩项之和，该过剩项在指定时由 Debye–Hückel (DH) 极限法则给出。\n- 对于每种物种 $j \\in \\{e,i\\}$，理想气体亥姆霍兹自由能为 $F_{\\mathrm{id},j}(T,V,N_j) = N_j k_B T \\left[\\ln\\!\\left(n_j \\lambda_j^3\\right) - 1\\right]$，其中 $n_j = N_j/V$ 是数密度，$\\lambda_j = h/\\sqrt{2\\pi m_j k_B T}$ 是热德布罗意波长。这里，$m_e$ 和 $m_i$ 分别是电子和离子的质量，$k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数。\n- 当启用时，Debye–Hückel 过剩自由能为 $F_{\\mathrm{ex}}(T,V,N_e,N_i) = - V k_B T \\, k_D^3 / (12 \\pi)$，其中德拜波数满足 $k_D^2 = \\sum_j n_j z_j^2 e^2 / (\\varepsilon_0 k_B T)$，且 $z_e^2 = 1$，$z_i^2 = 1$。$e$ 是元电荷，$\\varepsilon_0$ 是真空介电常数。在对称情况 $N_e = N_i = N$ 下，有 $k_D^2 = 2 N e^2 / (\\varepsilon_0 k_B T V)$，这意味着 $F_{\\mathrm{ex}}(T,V) = - C (k_B T)^{-1/2} V^{-1/2}$，其中 $C = \\left(2 N e^2 / \\varepsilon_0\\right)^{3/2} / (12 \\pi)$。\n- 压强和熵必须通过 $P(T,V) = -\\left(\\partial F/\\partial V\\right)_T$ 和 $S(T,V) = -\\left(\\partial F/\\partial T\\right)_V$ 从亥姆霍兹自由能中获得。\n\n数值一致性检验：\n- 构建一个温度 $T$ 和体积 $V$ 的矩形网格。在此网格上计算 EOS 表 $P(T,V)$ 和 $S(T,V)$。\n- 在内部网格点上，使用沿温度轴的中心差分计算 $\\left(\\partial P/\\partial T\\right)_V$，即对于内部索引 $i$，$\\left(\\partial P/\\partial T\\right)_V \\approx \\left[P(T_{i+1},V) - P(T_{i-1},V)\\right] / \\left(T_{i+1}-T_{i-1}\\right)$。\n- 在内部网格点上，使用沿体积轴的中心差分计算 $\\left(\\partial S/\\partial V\\right)_T$，即对于内部索引 $j$，$\\left(\\partial S/\\partial V\\right)_T \\approx \\left[S(T,V_{j+1}) - S(T,V_{j-1})\\right] / \\left(V_{j+1}-V_{j-1}\\right)$。\n- 在内部子网格上使用逐点归一化偏差 $R = \\left|\\Delta\\right| / \\max\\!\\left(\\left|\\left(\\partial P/\\partial T\\right)_V\\right|,\\left|\\left(\\partial S/\\partial V\\right)_T\\right|,\\epsilon\\right)$ 比较这两个导数，其中 $\\Delta = \\left(\\partial P/\\partial T\\right)_V - \\left(\\partial S/\\partial V\\right)_T$，$\\epsilon$ 是一个小的正数以避免除以零。使用 $\\epsilon = 10^{-300}$。\n- 对于每个测试用例，计算内部子网格上的最大值 $R$。如果最大值 $R$ 小于或等于指定的容差，则测试通过。\n\n单位和常数：\n- 使用国际单位制 (SI)。温度 $T$ 的单位必须是开尔文，体积 $V$ 是 $\\mathrm{m}^3$，压强 $P$ 是帕斯卡，熵 $S$ 是焦耳/开尔文。\n- 使用常数 $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$，$h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\cdot s}$，$e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$，$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$，$m_e = 9.1093837015 \\times 10^{-31}\\ \\mathrm{kg}$，以及 $m_i = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$。\n\n测试套件：\n- 测试用例 1（理想路径，非理想情况）：使用 $N_e = N_i = N$ 且 $N = n_{\\mathrm{ref}} V_{\\mathrm{ref}}$，其中 $n_{\\mathrm{ref}} = 10^{20}\\ \\mathrm{m}^{-3}$，$V_{\\mathrm{ref}} = 10^{-6}\\ \\mathrm{m}^3$，因此 $N = 10^{14}$。使用一个从 $T_{\\min} = 10^{5}\\ \\mathrm{K}$ 到 $T_{\\max} = 5\\times 10^{6}\\ \\mathrm{K}$ 的包含 41 个等距点的温度网格，以及一个从 $V_{\\min} = 10^{-6}\\ \\mathrm{m}^3$ 到 $V_{\\max} = 5\\times 10^{-6}\\ \\mathrm{m}^3$ 的包含 41 个等距点的体积网格。启用 Debye–Hückel 过剩自由能。容差 $= 10^{-4}$。\n- 测试用例 2（粗糙网格，非理想情况）：与测试用例 1 相同的 $N$ 和范围，但温度和体积网格均使用 9 个等距点。启用 Debye–Hückel 过剩自由能。容差 $= 5\\times 10^{-3}$。\n- 测试用例 3（仅理想情况）：与测试用例 1 相同的 $N$ 和网格，但禁用 Debye–Hückel 过剩自由能。容差 $= 10^{-6}$。\n\n最终输出规范：\n- 您的程序应生成包含三个测试用例的通过/失败结果的单行输出，该结果是一个用方括号括起来的逗号分隔列表，其中每个条目为小写的 $\\,\\texttt{true}\\,$ 或 $\\,\\texttt{false}\\,$。例如，输出格式必须与 $\\texttt{[true,false,true]}$ 完全一样。\n\n不允许外部输入；所有参数必须在程序内部定义。",
            "solution": "该问题要求为一种双组分经典等离子体的状态方程 (EOS) 实现一个数值验证程序，以确保其热力学自洽性。此验证的核心在于确认一个源于亥姆霍兹自由能 $F(T,V)$ 的基本麦克斯韦关系式。具体来说，我们必须验证自由能的混合二阶偏导数相等，即 $F_{TV} = F_{VT}$，这意味着等式 $\\left(\\partial P/\\partial T\\right)_V = \\left(\\partial S/\\partial V\\right)_T$ 成立。此处，$P$ 是压强，$S$ 是熵，这两个量由 $F$ 导出，公式为 $P = -\\left(\\partial F/\\partial V\\right)_T$ 和 $S = -\\left(\\partial F/\\partial T\\right)_V$。\n\n首先对问题进行验证，确认其在科学上是合理的、适定的且完整的。该物理模型由理想气体贡献和 Debye-Hückel 过剩项组成，是弱耦合经典等离子体的一种标准且恰当的近似。所用的数值方法，即中心差分法，是导数近似的标准方法。测试用例和参数在物理上是合理的，并且是内部一致的。\n\n解决方案分为两个主要阶段：首先，从指定的亥姆霍兹自由能模型解析推导压强和熵；其次，设计用于计算和比较所需导数的数值算法。\n\n对于一个电中性的等离子体（其中 $N_e = N_i = N$），总亥姆霍兹自由能 $F$ 是电子 ($e$) 和离子 ($i$) 的理想气体贡献与 Debye-Hückel (DH) 模型的过剩项 $F_{\\mathrm{ex}}$ 之和：\n$$\nF(T,V,N) = F_{\\mathrm{id},e}(T,V,N) + F_{\\mathrm{id},i}(T,V,N) + F_{\\mathrm{ex}}(T,V,N)\n$$\n\n物种 $j$ 的理想气体自由能由 $F_{\\mathrm{id},j} = N k_B T \\left[\\ln(n \\lambda_j^3) - 1\\right]$ 给出，其中 $n=N/V$ 是数密度，$\\lambda_j = h/\\sqrt{2\\pi m_j k_B T}$ 是热德布罗意波长。结合电子和离子的项，得到总的理想自由能：\n$$\nF_{\\mathrm{id}}(T,V,N) = -2 N k_B T \\ln(V) - 3 N k_B T \\ln(T) + T \\cdot \\text{const}(N, m_e, m_i)\n$$\n\n在对称情况下，Debye-Hückel 过剩自由能指定为 $F_{\\mathrm{ex}}(T,V) = -C (k_B T)^{-1/2} V^{-1/2}$，其中常数 $C = \\left(2 N e^2 / \\varepsilon_0\\right)^{3/2} / (12 \\pi)$ 取决于粒子数 $N$、元电荷 $e$ 和真空介电常数 $\\varepsilon_0$。\n\n从这些表达式中，我们推导出压强 $P$ 和熵 $S$：\n\n1.  **压强 $P(T,V)$**：\n    $P = -\\left(\\frac{\\partial F}{\\partial V}\\right)_T = -\\left(\\frac{\\partial F_{\\mathrm{id}}}{\\partial V}\\right)_T - \\left(\\frac{\\partial F_{\\mathrm{ex}}}{\\partial V}\\right)_T$。\n    理想部分得到 $2N$ 个粒子的理想气体定律：$P_{\\mathrm{id}} = -(-2 N k_B T/V) = 2 N k_B T/V$。\n    过剩部分贡献为：$P_{\\mathrm{ex}} = - \\frac{\\partial}{\\partial V}\\left(-C (k_B T)^{-1/2} V^{-1/2}\\right) = -C (k_B T)^{-1/2} (\\frac{1}{2}V^{-3/2})$。\n    总压强为：\n    $$\n    P(T,V) = \\frac{2 N k_B T}{V} - \\frac{C}{2} (k_B T)^{-1/2} V^{-3/2}\n    $$\n    仅当启用 Debye-Hückel 模型时，才计算第二项。\n\n2.  **熵 $S(T,V)$**：\n    $S = -\\left(\\frac{\\partial F}{\\partial T}\\right)_V = -\\left(\\frac{\\partial F_{\\mathrm{id}}}{\\partial T}\\right)_V - \\left(\\frac{\\partial F_{\\mathrm{ex}}}{\\partial T}\\right)_V$。\n    理想部分给出了双组分混合物的 Sackur-Tetrode 方程：\n    $S_{\\mathrm{id}} = S_{\\mathrm{id},e} + S_{\\mathrm{id},i}$，其中 $S_{\\mathrm{id},j} = N k_B \\left[ \\ln\\left(\\frac{V}{N} \\left(\\frac{2\\pi m_j k_B T}{h^2}\\right)^{3/2}\\right) + \\frac{5}{2} \\right]$。\n    过剩部分贡献为：$S_{\\mathrm{ex}} = - \\frac{\\partial}{\\partial T}\\left(-C (k_B T)^{-1/2} V^{-1/2}\\right) = -C V^{-1/2} \\frac{\\partial}{\\partial T}( (k_B T)^{-1/2} ) = - C V^{-1/2} (-\\frac{1}{2}(k_B T)^{-3/2} k_B)$。\n    化简后得到：$S_{\\mathrm{ex}} = -\\frac{C}{2} k_B^{-1/2} V^{-1/2} T^{-3/2}$。\n    总熵为：\n    $$\n    S(T,V) = S_{\\mathrm{id},e} + S_{\\mathrm{id},i} - \\frac{C}{2} k_B^{-1/2} V^{-1/2} T^{-3/2}\n    $$\n    与压强一样，仅在指定时才包含过剩项。\n\n对于每个测试用例，数值实现遵循以下步骤：\n1.  **网格生成**：使用 `numpy.linspace` 和 `numpy.meshgrid` 创建温度和体积的矩形网格。对于一个 $N_T \\times N_V$ 点的网格，这将生成两个形状为 $(N_T, N_V)$ 的数组 `T` 和 `V`，其中 `T` 沿第一轴变化，`V` 沿第二轴变化。\n2.  **EOS 表计算**：$P(T,V)$ 和 $S(T,V)$ 的解析表达式在网格上进行求值，得到两个形状为 $(N_T, N_V)$ 的表 `P_table` 和 `S_table`。这可以通过使用 NumPy 的向量化操作高效完成。\n3.  **数值微分**：在网格内部，使用二阶中心差分格式来近似偏导数。\n    -   网格点 $(T_i, V_j)$ 处的 $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$ 计算为 $\\frac{P_{i+1,j} - P_{i-1,j}}{T_{i+1} - T_{i-1}}$。这对所有内部温度点（$i=1, \\dots, N_T-2$）和所有体积点进行计算。\n    -   $(T_i, V_j)$ 处的 $\\left(\\frac{\\partial S}{\\partial V}\\right)_T$ 计算为 $\\frac{S_{i,j+1} - S_{i,j-1}}{V_{j+1} - V_{j-1}}$。这对所有内部体积点（$j=1, \\dots, N_V-2$）和所有温度点进行计算。\n    -   然后对两个得到的导数数组进行切片，以表示维度为 $(N_T-2) \\times (N_V-2)$ 的共同内部子网格。\n4.  **偏差计算**：一致性通过内部子网格上的逐点归一化偏差 $R$ 来量化：\n    $$\n    R = \\frac{\\left| \\left(\\frac{\\partial P}{\\partial T}\\right)_V - \\left(\\frac{\\partial S}{\\partial V}\\right)_T \\right|}{\\max\\left(\\left|\\left(\\frac{\\partial P}{\\partial T}\\right)_V\\right|, \\left|\\left(\\frac{\\partial S}{\\partial V}\\right)_T\\right|, \\epsilon\\right)}\n    $$\n    其中 $\\epsilon=10^{-300}$ 是一个小的正则化参数，以防止除以零。\n5.  **验证**：确定整个内部子网格上 $R$ 的最大值。如果此最大偏差小于或等于指定的容差，则测试用例通过。然后记录结果（`true` 或 `false`）。\n\n对所有三个在问题中定义的测试用例重复此过程，并将最终结果格式化为指定的字符串输出。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the numerical consistency check for the three test cases.\n    \"\"\"\n    # Physical constants in SI units as specified in the problem.\n    k_B = 1.380649e-23       # Boltzmann constant (J/K)\n    h = 6.62607015e-34       # Planck constant (J*s)\n    e = 1.602176634e-19       # Elementary charge (C)\n    eps0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    m_e = 9.1093837015e-31   # Electron mass (kg)\n    m_i = 1.67262192369e-27  # Ion mass (proton) (kg)\n    \n    # Epsilon for normalized discrepancy calculation.\n    epsilon = 1e-300\n\n    # Definition of the three test cases.\n    test_cases = [\n        {\n            \"name\": \"Case 1: Standard Grid, Non-Ideal\",\n            \"n_ref\": 1e20, \"v_ref\": 1e-6,\n            \"T_min\": 1e5, \"T_max\": 5e6, \"T_points\": 41,\n            \"V_min\": 1e-6, \"V_max\": 5e-6, \"V_points\": 41,\n            \"use_DH\": True, \"tolerance\": 1e-4\n        },\n        {\n            \"name\": \"Case 2: Coarse Grid, Non-Ideal\",\n            \"n_ref\": 1e20, \"v_ref\": 1e-6,\n            \"T_min\": 1e5, \"T_max\": 5e6, \"T_points\": 9,\n            \"V_min\": 1e-6, \"V_max\": 5e-6, \"V_points\": 9,\n            \"use_DH\": True, \"tolerance\": 5e-3\n        },\n        {\n            \"name\": \"Case 3: Standard Grid, Ideal-Only\",\n            \"n_ref\": 1e20, \"v_ref\": 1e-6,\n            \"T_min\": 1e5, \"T_max\": 5e6, \"T_points\": 41,\n            \"V_min\": 1e-6, \"V_max\": 5e-6, \"V_points\": 41,\n            \"use_DH\": False, \"tolerance\": 1e-6\n        },\n    ]\n\n    results = []\n    # Process each test case.\n    for params in test_cases:\n        passed = run_consistency_check(params, k_B, h, e, eps0, m_e, m_i, epsilon)\n        results.append(str(passed).lower())\n    \n    # Print the final output in the specified format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_pressure(T, V, N, k_B, C_dh, use_DH):\n    \"\"\"\n    Computes the pressure P(T, V) for the plasma.\n    P = 2*N*k_B*T/V - (C_dh/2) * (k_B*T)^(-1/2) * V^(-3/2)\n    \"\"\"\n    P_ideal = 2 * N * k_B * T / V\n    if not use_DH:\n        return P_ideal\n    \n    P_ex = - (1/2) * C_dh * (k_B * T)**(-1/2) * V**(-3/2)\n    return P_ideal + P_ex\n\ndef calculate_entropy(T, V, N, k_B, C_dh, use_DH, h, m_e, m_i):\n    \"\"\"\n    Computes the entropy S(T, V) for the plasma.\n    S_id,j = N*k_B * [ ln(V/N * (2*pi*m_j*k_B*T/h^2)^(3/2)) + 5/2 ]\n    S_ex = - (C_dh/2) * k_B^(-1/2) * T^(-3/2) * V^(-1/2)\n    \"\"\"\n    # Ideal gas contribution (Sackur-Tetrode equation for electrons and ions).\n    lambda_e_sq_inv = (2 * np.pi * m_e * k_B * T) / (h**2)\n    S_ideal_e = N * k_B * (np.log((V / N) * lambda_e_sq_inv**(3/2)) + 2.5)\n    \n    lambda_i_sq_inv = (2 * np.pi * m_i * k_B * T) / (h**2)\n    S_ideal_i = N * k_B * (np.log((V / N) * lambda_i_sq_inv**(3/2)) + 2.5)\n    \n    S_ideal = S_ideal_e + S_ideal_i\n    \n    if not use_DH:\n        return S_ideal\n    \n    # Debye-Hückel excess contribution.\n    S_ex = - (1/2) * C_dh * k_B**(-1/2) * V**(-1/2) * T**(-3/2)\n    return S_ideal + S_ex\n\ndef run_consistency_check(params, k_B, h, e, eps0, m_e, m_i, epsilon):\n    \"\"\"\n    Performs the numerical consistency check for a single test case.\n    \"\"\"\n    # Unpack parameters for the current test case.\n    N = params['n_ref'] * params['v_ref']\n    t_grid = np.linspace(params['T_min'], params['T_max'], params['T_points'])\n    v_grid = np.linspace(params['V_min'], params['V_max'], params['V_points'])\n    \n    # Create meshgrids for vectorized calculations.\n    T, V = np.meshgrid(t_grid, v_grid, indexing='ij')\n    \n    # Calculate the Debye-Hückel constant C if required.\n    C_dh = 0.0\n    if params['use_DH']:\n        C_dh = ((2 * N * e**2 / eps0)**(3/2)) / (12 * np.pi)\n\n    # Compute Pressure and Entropy tables on the grid.\n    P_table = calculate_pressure(T, V, N, k_B, C_dh, params['use_DH'])\n    S_table = calculate_entropy(T, V, N, k_B, C_dh, params['use_DH'], h, m_e, m_i)\n    \n    # Step sizes for finite differences.\n    dt = t_grid[1] - t_grid[0]\n    dv = v_grid[1] - v_grid[0]\n    \n    # Compute (dP/dT)_V using centered finite differences on the T-axis.\n    # Result is an array of shape (T_points-2, V_points).\n    dPdT = (P_table[2:, :] - P_table[:-2, :]) / (2 * dt)\n    \n    # Compute (dS/dV)_T using centered finite differences on the V-axis.\n    # Result is an array of shape (T_points, V_points-2).\n    dSdV = (S_table[:, 2:] - S_table[:, :-2]) / (2 * dv)\n\n    # Align derivatives on the interior subgrid of shape (T_points-2, V_points-2).\n    dPdT_interior = dPdT[:, 1:-1]\n    dSdV_interior = dSdV[1:-1, :]\n    \n    # Calculate the pointwise normalized discrepancy R.\n    Delta = dPdT_interior - dSdV_interior\n    norm = np.maximum(np.abs(dPdT_interior), np.abs(dSdV_interior))\n    norm = np.maximum(norm, epsilon)\n    R_table = np.abs(Delta) / norm\n    \n    # Find the maximum discrepancy over the interior subgrid.\n    max_R = np.max(R_table)\n    \n    # Test passes if the maximum discrepancy is within the specified tolerance.\n    return max_R = params['tolerance']\n\nif __name__ == '__main__':\n    solve()\n```",
            "answer": "$$\\boxed{\\text{[true,true,true]}}$$"
        }
    ]
}