{
    "hands_on_practices": [
        {
            "introduction": "我们实践的第一步是回到最基本的问题：单次聚变反应究竟能释放多少能量？这个练习将引导你运用爱因斯坦的质能等效原理（$E = mc^2$），通过精确的原子质量数据来计算D-T和D-D聚变反应的Q值。掌握这项基础计算不仅能让你深入理解聚变能量的来源，也为后续更复杂的等离子体功率平衡和反应率分析奠定了重要的数字基础。",
            "id": "3983985",
            "problem": "氘-氚反应和氘-氘反应通过不同的通道进行，这些通道由重子数、电荷和质能守恒定律决定。利用质能守恒第一性原理 $E = mc^{2}$，且不借助任何快捷的反应能量学方法，确定每次氘-氘聚变事件的热核平均能量释放，并将其与氘-氚聚变的能量释放进行比较。具体要求如下：\n\n- 根据守恒原理，确定氘-氘聚变和氘-氚聚变在能量上允许的轻粒子出射通道，并使用原子静止质量通过公式 $Q = \\left(m_{\\mathrm{initial}} - m_{\\mathrm{final}}\\right)c^{2}$ 计算每个通道对应的 $Q$ 值。\n- 假设在质心能量 $E_{\\mathrm{cm}} = 50\\,\\mathrm{keV}$ 时，两个氘-氘通道具有相等的偏截面，因此热核平均的氘-氘能量释放是两个氘-氘通道 $Q$ 值的算术平均值。\n\n使用以下以统一原子质量单位 $\\,\\mathrm{u}\\,$ 表示的原子静止质量（中性原子，因此在反应物和生成物中，束缚电子的质量会一致地抵消）：\n$m_{\\mathrm{D}} = 2.01410177812\\,\\mathrm{u}$，$m_{\\mathrm{T}} = 3.01604928199\\,\\mathrm{u}$，$m_{{}^{3}\\mathrm{He}} = 3.0160293201\\,\\mathrm{u}$，$m_{{}^{4}\\mathrm{He}} = 4.00260325413\\,\\mathrm{u}$，$m_{\\mathrm{H}} = 1.00782503223\\,\\mathrm{u}$，$m_{n} = 1.00866491588\\,\\mathrm{u}$，以及转换关系 $1\\,\\mathrm{u} = 931.49410242\\,\\mathrm{MeV}/c^{2}$。\n\n计算氘-氚 $Q$ 值与热核平均氘-氘 $Q$ 值的比率 $\\mathcal{R}$。将 $\\mathcal{R}$ 表示为一个无量纲数，并将最终答案四舍五入到四位有效数字。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 步骤1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n-   **原理1**：氘-氚（D–T）和氘-氘（D–D）反应由重子数、电荷和质能守恒定律决定。\n-   **原理2**：质能守恒由 $E = mc^{2}$ 给出。\n-   **公式**：能量释放，即 $Q$ 值，为 $Q = \\left(m_{\\mathrm{initial}} - m_{\\mathrm{final}}\\right)c^{2}$。\n-   **条件**：对于质心能量为 $E_{\\mathrm{cm}} = 50\\,\\mathrm{keV}$ 的D–D聚变，两个能量上允许的轻粒子出射通道具有相等的偏截面。\n-   **定义**：热核平均D–D能量释放是两个D–D通道 $Q$ 值的算术平均值。\n-   **原子静止质量（以统一原子质量单位 $\\mathrm{u}$ 计）**：\n    -   $m_{\\mathrm{D}} = 2.01410177812\\,\\mathrm{u}$\n    -   $m_{\\mathrm{T}} = 3.01604928199\\,\\mathrm{u}$\n    -   $m_{{}^{3}\\mathrm{He}} = 3.0160293201\\,\\mathrm{u}$\n    -   $m_{{}^{4}\\mathrm{He}} = 4.00260325413\\,\\mathrm{u}$\n    -   $m_{\\mathrm{H}} = 1.00782503223\\,\\mathrm{u}$ （对于氕，${}^{1}\\mathrm{H}$）\n    -   $m_{n} = 1.00866491588\\,\\mathrm{u}$ （对于中子）\n-   **转换常数**：$1\\,\\mathrm{u} = 931.49410242\\,\\mathrm{MeV}/c^{2}$。\n-   **目标**：计算D–T的 $Q$ 值与热核平均D–D的 $Q$ 值的比率 $\\mathcal{R}$。\n-   **格式要求**：将 $\\mathcal{R}$ 的最终答案四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准评估问题的有效性。\n-   **科学依据**：该问题在根本上是合理的。它基于核物理的核心原理，即质能等效性（$E=mc^2$）和守恒定律（重子数和电荷）。D–T和D–D反应是聚变能研究的核心。所提供的原子质量与高精度、公认的数值（例如，来自AME2020原子质量评估）一致。使用中性原子质量计算Q值是一种标准且有效的方法，因为当电荷守恒时，电子的质量会相互抵消。对于两个D–D通道，假设分支比相等（$50\\%/50\\%$）是一个合理且常见的简化，适用于教学问题，因为在很宽的能量范围内（包括所述的$50\\,\\mathrm{keV}$），实验值几乎相等。\n-   **适定性**：该问题是适定的。它提供了所有必要的数据（质量、转换因子）和清晰、明确的计算路径。目标具体，且存在唯一解。\n-   **客观性**：语言精确、量化，没有任何主观性或偏见。\n\n该问题未违反任何无效性标准。它科学合理、可形式化、完整、现实、适定且不平凡。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解答\n解答过程首先使用守恒定律确定反应产物，然后计算每个反应通道的质量亏损和相应的 $Q$ 值，最后计算所需的比率。\n\n**1. 确定反应通道**\n我们将原子核表示为 ${}^{A}_{Z}X$，其中 $A$ 是重子数（质子和中子的总数），$Z$ 是电荷数（质子数）。守恒定律要求反应物的 $A$ 和 $Z$ 的总和等于产物的总和。\n\n-   **氘-氚（D–T）聚变：**\n    反应物是氘（${}^{2}_{1}\\mathrm{D}$）和氚（${}^{3}_{1}\\mathrm{T}$）。\n    -   初始状态：${}^{2}_{1}\\mathrm{D} + {}^{3}_{1}\\mathrm{T}$\n    -   初始总重子数：$A_{\\mathrm{initial}} = 2 + 3 = 5$\n    -   初始总电荷数：$Z_{\\mathrm{initial}} = 1 + 1 = 2$\n    产物必须满足 $A_{\\mathrm{final}} = 5$ 和 $Z_{\\mathrm{final}} = 2$。一个高度稳定的原子核是α粒子（${}^{4}_{2}\\mathrm{He}$）。如果这是其中一个产物，则另一个产物必须具有 $A = 5 - 4 = 1$ 和 $Z = 2 - 2 = 0$。这个粒子是中子（${}^{1}_{0}n$）。\n    反应式为：\n    $$ {}^{2}_{1}\\mathrm{D} + {}^{3}_{1}\\mathrm{T} \\rightarrow {}^{4}_{2}\\mathrm{He} + {}^{1}_{0}n $$\n\n-   **氘-氘（D–D）聚变：**\n    反应物是两个氘核（${}^{2}_{1}\\mathrm{D}$）。\n    -   初始状态：${}^{2}_{1}\\mathrm{D} + {}^{2}_{1}\\mathrm{D}$\n    -   初始总重子数：$A_{\\mathrm{initial}} = 2 + 2 = 4$\n    -   初始总电荷数：$Z_{\\mathrm{initial}} = 1 + 1 = 2$\n    产物必须满足 $A_{\\mathrm{final}} = 4$ 和 $Z_{\\mathrm{final}} = 2$。存在两个主要的轻粒子通道：\n    -   **通道1（中子分支）：** 产物可以是氦-3（${}^{3}_{2}\\mathrm{He}$）和一个中子（${}^{1}_{0}n$）。此时，$A_{\\mathrm{final}} = 3 + 1 = 4$ 且 $Z_{\\mathrm{final}} = 2 + 0 = 2$。反应式为：\n        $$ {}^{2}_{1}\\mathrm{D} + {}^{2}_{1}\\mathrm{D} \\rightarrow {}^{3}_{2}\\mathrm{He} + {}^{1}_{0}n $$\n    -   **通道2（质子分支）：** 产物可以是氚（${}^{3}_{1}\\mathrm{T}$）和一个质子（${}^{1}_{1}\\mathrm{H}$）。此时，$A_{\\mathrm{final}} = 3 + 1 = 4$ 且 $Z_{\\mathrm{final}} = 1 + 1 = 2$。反应式为：\n        $$ {}^{2}_{1}\\mathrm{D} + {}^{2}_{1}\\mathrm{D} \\rightarrow {}^{3}_{1}\\mathrm{T} + {}^{1}_{1}\\mathrm{H} $$\n\n**2. Q值的计算**\n$Q$ 值由质量亏损 $\\Delta m = m_{\\mathrm{initial}} - m_{\\mathrm{final}}$ 和给定的原子质量计算得出。使用中性原子质量是合适的，因为在每个反应中总电荷 $Z$ 是守恒的，这确保了轨道电子的总质量在质量平衡方程的两边相互抵消。转换常数 $C = 931.49410242\\,\\mathrm{MeV}/(c^{2} \\cdot \\mathrm{u})$ 允许我们写出 $Q = (\\Delta m / \\mathrm{u}) \\times 931.49410242\\,\\mathrm{MeV}$。\n\n-   **D–T聚变的 $Q$ 值 ($Q_{\\mathrm{D-T}}$)：**\n    -   初始质量：$m_{\\mathrm{initial}} = m_{\\mathrm{D}} + m_{\\mathrm{T}} = 2.01410177812\\,\\mathrm{u} + 3.01604928199\\,\\mathrm{u} = 5.03015106011\\,\\mathrm{u}$\n    -   最终质量：$m_{\\mathrm{final}} = m_{{}^{4}\\mathrm{He}} + m_{n} = 4.00260325413\\,\\mathrm{u} + 1.00866491588\\,\\mathrm{u} = 5.01126816901\\,\\mathrm{u}$\n    -   质量亏损：$\\Delta m_{\\mathrm{D-T}} = m_{\\mathrm{initial}} - m_{\\mathrm{final}} = 5.03015106011\\,\\mathrm{u} - 5.01126816901\\,\\mathrm{u} = 0.0188828911\\,\\mathrm{u}$\n\n-   **D–D聚变的 $Q$ 值：**\n    -   两个通道的初始质量：$m_{\\mathrm{initial}} = m_{\\mathrm{D}} + m_{\\mathrm{D}} = 2 \\times 2.01410177812\\,\\mathrm{u} = 4.02820355624\\,\\mathrm{u}$\n    -   **通道1 ($Q_{\\mathrm{D-D},1}$)：**\n        -   最终质量：$m_{\\mathrm{final},1} = m_{{}^{3}\\mathrm{He}} + m_{n} = 3.0160293201\\,\\mathrm{u} + 1.00866491588\\,\\mathrm{u} = 4.02469423598\\,\\mathrm{u}$\n        -   质量亏损：$\\Delta m_{\\mathrm{D-D},1} = 4.02820355624\\,\\mathrm{u} - 4.02469423598\\,\\mathrm{u} = 0.00350932026\\,\\mathrm{u}$\n    -   **通道2 ($Q_{\\mathrm{D-D},2}$)：**\n        -   最终质量：$m_{\\mathrm{final},2} = m_{\\mathrm{T}} + m_{\\mathrm{H}} = 3.01604928199\\,\\mathrm{u} + 1.00782503223\\,\\mathrm{u} = 4.02387431422\\,\\mathrm{u}$\n        -   质量亏损：$\\Delta m_{\\mathrm{D-D},2} = 4.02820355624\\,\\mathrm{u} - 4.02387431422\\,\\mathrm{u} = 0.00432924202\\,\\mathrm{u}$\n\n**3. 热核平均D–D Q值**\n问题规定两个D–D通道具有相等的偏截面，因此热核平均 $Q$ 值 $\\langle Q_{\\mathrm{D-D}} \\rangle$ 是各通道 $Q$ 值的算术平均值。这等同于对质量亏损进行平均。\n$$ \\langle \\Delta m_{\\mathrm{D-D}} \\rangle = \\frac{\\Delta m_{\\mathrm{D-D},1} + \\Delta m_{\\mathrm{D-D},2}}{2} $$\n$$ \\langle \\Delta m_{\\mathrm{D-D}} \\rangle = \\frac{0.00350932026\\,\\mathrm{u} + 0.00432924202\\,\\mathrm{u}}{2} = \\frac{0.00783856228\\,\\mathrm{u}}{2} = 0.00391928114\\,\\mathrm{u} $$\n\n**4. 比率 $\\mathcal{R}$ 的计算**\n比率 $\\mathcal{R}$ 定义为 $\\frac{Q_{\\mathrm{D-T}}}{\\langle Q_{\\mathrm{D-D}} \\rangle}$。由于 $Q$ 与 $\\Delta m$ 成正比，转换常数会抵消，因此可以直接从质量亏损计算该比率。\n$$ \\mathcal{R} = \\frac{Q_{\\mathrm{D-T}}}{\\langle Q_{\\mathrm{D-D}} \\rangle} = \\frac{\\Delta m_{\\mathrm{D-T}} \\cdot c^2}{\\langle \\Delta m_{\\mathrm{D-D}} \\rangle \\cdot c^2} = \\frac{\\Delta m_{\\mathrm{D-T}}}{\\langle \\Delta m_{\\mathrm{D-D}} \\rangle} $$\n$$ \\mathcal{R} = \\frac{0.0188828911\\,\\mathrm{u}}{0.00391928114\\,\\mathrm{u}} \\approx 4.81804006 $$\n根据问题要求，将此结果四舍五入到四位有效数字，得到 $4.818$。\n为完整起见，各个能量释放值为：\n$Q_{\\mathrm{D-T}} = 0.0188828911 \\times 931.49410242 \\approx 17.589\\,\\mathrm{MeV}$\n$\\langle Q_{\\mathrm{D-D}} \\rangle = 0.00391928114 \\times 931.49410242 \\approx 3.651\\,\\mathrm{MeV}$\n该比率为 $\\frac{17.589...}{3.651...} \\approx 4.818$。",
            "answer": "$$\\boxed{4.818}$$"
        },
        {
            "introduction": "了解了单次反应的能量释放后，我们自然会问：在宏观尺度上，一个高温等离子体反应堆能产生多大的功率？这个练习将微观物理与宏观工程参数联系起来，要求你运用反应率密度的概念来计算聚变功率密度。此过程特别强调了在物理和工程计算中，量纲分析和单位一致性的关键作用，这是将理论模型转化为实际预测的必备技能。",
            "id": "4038580",
            "problem": "一个热等离子体包含等量的氘和氚数密度，并且碰撞足够频繁，其相对速度分布接近麦克斯韦分布。反应率密度定义为由粒子碰撞导致的单位体积单位时间内的双体聚变反应次数。请仅从微观截面和粒子速度的量纲定义出发，推导麦克斯韦平均反应率 $\\langle \\sigma v \\rangle$ 的国际单位制（SI）单位，其中 $\\sigma$ 是具有面积单位的微观聚变截面，而 $v$ 是相对速度。将此 SI 单位与聚变数据表中常用的单位进行对比。然后，使用这些单位关系计算氘-氚反应的物理一致的聚变功率密度。\n\n假设在指定条件下，以下数据在科学上是合理的：\n- 氘数密度 $n_{\\mathrm{D}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$。\n- 氚数密度 $n_{\\mathrm{T}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$。\n- 在给定等离子体温度下的麦克斯韦平均反应率 $\\langle \\sigma v \\rangle = 1.0 \\times 10^{-16}\\,\\text{cm}^{3}\\,\\text{s}^{-1}$。\n- 氘-氚聚变的 $Q$ 值（每次反应释放的能量）：$17.6\\,\\text{MeV}$。\n- 能量单位转换：$1\\,\\text{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$。\n\n任务：\n1. 通过量纲推导，从以 $\\text{m}^{2}$ 计量的 $\\sigma$ 和以 $\\text{m}\\,\\text{s}^{-1}$ 计量的 $v$ 出发，推导 $\\langle \\sigma v \\rangle$ 的 SI 单位，并解释为什么这个量会自然地出现在反应率密度的参数化中。\n2. 确定常用单位 $\\text{cm}^{3}\\,\\text{s}^{-1}$ 和 $\\langle \\sigma v \\rangle$ 的 SI 单位之间的转换因子，并将给定的 $\\langle \\sigma v \\rangle$ 转换为 SI 单位。\n3. 仅使用量纲一致的量，计算氘-氚聚变功率密度，以 $\\text{MW}\\,\\text{m}^{-3}$ 表示。\n\n将您的最终数值答案四舍五入到三位有效数字，并以 $\\text{MW}\\,\\text{m}^{-3}$ 表示。",
            "solution": "反应率密度是单位体积单位时间内发生的双体聚变反应的次数。对于数密度分别为 $n_{1}$ 和 $n_{2}$ 的两种粒子，其相对速度分布由一个关于相对速度的概率密度来表征，总反应率密度可以写成在相对速度空间上的积分。相关的微观输入是截面 $\\sigma$ 和相对速度 $v_{\\mathrm{rel}}$。\n\n首先，确定基本构成部分的量纲：\n- 微观截面具有面积的单位，所以 $[\\sigma] = \\text{m}^{2}$。\n- 相对速度具有速度的单位，所以 $[v_{\\mathrm{rel}}] = \\text{m}\\,\\text{s}^{-1}$。\n\n因此，乘积 $\\sigma v_{\\mathrm{rel}}$ 的单位为\n$$\n[\\sigma v_{\\mathrm{rel}}] = \\text{m}^{2} \\cdot \\text{m}\\,\\text{s}^{-1} = \\text{m}^{3}\\,\\text{s}^{-1}.\n$$\n麦克斯韦平均反应率 $\\langle \\sigma v \\rangle$ 定义为 $\\sigma v_{\\mathrm{rel}}$ 在相对速度分布上的平均值，这不会改变其量纲。因此，$\\langle \\sigma v \\rangle$ 的 SI 单位是\n$$\n[\\langle \\sigma v \\rangle] = \\text{m}^{3}\\,\\text{s}^{-1}.\n$$\n这个量自然地出现在反应率密度的参数化中，因为对于不同种类粒子之间的双体碰撞，反应率密度 $R$ 可以表示为数密度和平均微观反应核的乘积，即 $R$ 正比于 $n_{1} n_{2} \\langle \\sigma v \\rangle$。量纲一致性证实了这一点：$[n_{1} n_{2} \\langle \\sigma v \\rangle] = (\\text{m}^{-3})(\\text{m}^{-3})(\\text{m}^{3}\\,\\text{s}^{-1}) = \\text{m}^{-3}\\,\\text{s}^{-1}$，这是单位体积单位时间内的反应次数的单位。\n\n接下来，将 SI 单位与聚变数据表中使用的常用单位进行对比。$\\langle \\sigma v \\rangle$ 的常用单位是 $\\text{cm}^{3}\\,\\text{s}^{-1}$。由于 $1\\,\\text{cm} = 10^{-2}\\,\\text{m}$，因此\n$$\n1\\,\\text{cm}^{3} = (10^{-2}\\,\\text{m})^{3} = 10^{-6}\\,\\text{m}^{3}.\n$$\n因此，$\\text{cm}^{3}\\,\\text{s}^{-1}$ 和 $\\text{m}^{3}\\,\\text{s}^{-1}$ 之间的转换因子是\n$$\n1\\,\\text{cm}^{3}\\,\\text{s}^{-1} = 10^{-6}\\,\\text{m}^{3}\\,\\text{s}^{-1}.\n$$\n将此转换应用于给定的反应率，\n$$\n\\langle \\sigma v \\rangle = 1.0 \\times 10^{-16}\\,\\text{cm}^{3}\\,\\text{s}^{-1} = 1.0 \\times 10^{-16} \\times 10^{-6}\\,\\text{m}^{3}\\,\\text{s}^{-1} = 1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1}.\n$$\n\n现在计算氘-氚碰撞的反应率密度。已知 $n_{\\mathrm{D}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$ 和 $n_{\\mathrm{T}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$，并使用 SI 单位的麦克斯韦平均反应率，\n$$\nR = n_{\\mathrm{D}}\\,n_{\\mathrm{T}}\\,\\langle \\sigma v \\rangle = \\left(1.0 \\times 10^{20}\\,\\text{m}^{-3}\\right)\\left(1.0 \\times 10^{20}\\,\\text{m}^{-3}\\right)\\left(1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1}\\right) = 1.0 \\times 10^{18}\\,\\text{m}^{-3}\\,\\text{s}^{-1}.\n$$\n接下来，将氘-氚聚变的 $Q$ 值转换为焦耳。给定的 $Q$ 值为 $17.6\\,\\text{MeV}$。\n$$\nQ = 17.6 \\times 10^{6}\\,\\text{eV} \\times (1.602176634 \\times 10^{-19}\\,\\text{J}/\\text{eV}) \\approx 2.8198 \\times 10^{-12}\\,\\text{J}.\n$$\n聚变功率密度 $P$ 是反应率密度与每次反应释放能量的乘积：\n$$\nP = R \\times Q \\approx (1.0 \\times 10^{18}\\,\\text{m}^{-3}\\,\\text{s}^{-1}) \\times (2.8198 \\times 10^{-12}\\,\\text{J}) \\approx 2.8198 \\times 10^{6}\\,\\text{W}\\,\\text{m}^{-3}.\n$$\n题目要求以 $\\text{MW}\\,\\text{m}^{-3}$ 为单位表示，所以 $P \\approx 2.8198\\,\\text{MW}\\,\\text{m}^{-3}$。四舍五入到三位有效数字，我们得到\n$$\nP \\approx 2.82\\,\\text{MW}\\,\\text{m}^{-3}.\n$$\n这个结果与以 SI 单位推导的 $\\langle \\sigma v \\rangle$ 及其从 $\\text{cm}^{3}\\,\\text{s}^{-1}$ 的转换是一致的。",
            "answer": "$$\\boxed{2.82}$$"
        },
        {
            "introduction": "在之前的练习中，我们直接使用了给定的聚变反应率参数 $\\langle \\sigma v \\rangle$。然而，这个关键的、与温度相关的参数本身是如何得到的呢？这个高级计算练习将揭示其背后的秘密，指导你使用蒙特卡洛方法——特别是针对“伽莫夫峰”进行重要性抽样——来数值计算反应率积分。通过这个实践，你将掌握一种解决物理学中复杂积分问题的强大计算技术，并学会如何设计数值实验来精确确定关键物理量，一窥现代计算聚变科学的前沿。",
            "id": "3983973",
            "problem": "你的任务是设计一个完整、可运行的程序，该程序使用集中在 Gamow 峰附近的重要性采样方法为氘-氚聚变反应率 $\\langle \\sigma v \\rangle$ 构建一个蒙特卡洛估计器，并分析其方差。该程序必须从基本定义出发推导估计器，实现采样方案，并为指定的测试套件计算数值估计。所有符号和数学实体都必须用 LaTeX 表示。\n\n出发点是在热等离子体中每对粒子的反应率的定义。对于两个离子种类，其折合质量为 $\\,\\mu\\,$，在离子温度为 $\\,T\\,$ 的热平衡状态下，相对运动的速度分布是 Maxwell–Boltzmann 分布。反应率定义为热平均值\n$$\n\\langle \\sigma v \\rangle = \\int_{0}^{\\infty} \\sigma(v)\\, v\\, f_v(v;T)\\, dv,\n$$\n其中 $\\,\\sigma(v)\\,$ 是聚变截面，$\\,f_v(v;T)\\,$ 是相对速率的 Maxwell–Boltzmann 分布。使用动能 $\\,E = \\tfrac{1}{2}\\mu v^2\\,$，反应率可以表示为\n$$\n\\langle \\sigma v \\rangle = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2}{\\mu}\\right)^{1/2} \\frac{1}{(k_B T)^{3/2}} \\int_{0}^{\\infty} \\sigma(E)\\, E\\, \\exp\\!\\left(-\\frac{E}{k_B T}\\right) dE,\n$$\n其中 $\\,k_B\\,$ 是 Boltzmann 常数。定义积分\n$$\nI(T) \\equiv \\int_{0}^{\\infty} \\sigma(E)\\, E\\, \\exp\\!\\left(-\\frac{E}{k_B T}\\right) dE,\n$$\n这样\n$$\n\\langle \\sigma v \\rangle = C(T) \\, I(T), \\quad C(T) = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2}{\\mu}\\right)^{1/2} \\frac{1}{(k_B T)^{3/2}}.\n$$\n\n对于带电粒子反应，截面表现出由 Gamow 因子描述的隧穿抑制效应。采用广泛使用的非共振近似来表示氘-氚截面\n$$\n\\sigma(E) = \\frac{S_0}{E} \\, \\exp\\!\\left(-\\sqrt{\\frac{E_G}{E}}\\right),\n$$\n其中 $\\,S_0\\,$ 是一个缓慢变化的天体物理因子，在我们感兴趣的热能范围内近似为常数，而 $\\,E_G\\,$ 是对于 $\\,Z_1 = Z_2 = 1\\,$ 的 Gamow 能量，由下式给出\n$$\nE_G = \\frac{1}{2} \\, \\mu \\, c^2 \\, \\left(2\\pi \\alpha\\right)^2.\n$$\n这里 $\\,\\alpha\\,$ 是精细结构常数，$\\,c\\,$ 是光速。这使得 $\\,I(T)\\,$ 的被积函数为\n$$\nh_T(E) = \\sigma(E)\\, E\\, \\exp\\!\\left(-\\frac{E}{k_B T}\\right) = S_0 \\, \\exp\\!\\left(-\\frac{E}{k_B T} - \\sqrt{\\frac{E_G}{E}}\\right).\n$$\nGamow 峰 $\\,E_0\\,$ 的位置由指数 $\\,g_T(E) = \\frac{E}{k_B T} + \\sqrt{\\frac{E_G}{E}}\\,$ 的驻点定义，即 $\\,g_T'(E_0) = 0\\,$，这意味着\n$$\nE_0(T) = \\left(\\frac{1}{2} \\sqrt{E_G} \\, k_B T \\right)^{2/3}.\n$$\n局部曲率决定了宽度。使用 $\\,g_T''(E_0) = \\frac{3}{2 k_B T E_0}\\,$，在 $\\,E_0\\,$ 附近对 $\\,\\exp(-g_T(E))\\,$ 的高斯近似，其方差为\n$$\n\\sigma_T^2 \\approx \\frac{1}{g_T''(E_0)} = \\frac{2}{3}\\, k_B T\\, E_0,\n$$\n并且在高斯函数下降到 $\\,\\exp(-1)\\,$ 的点处的特征全宽为\n$$\n\\Delta_T \\approx \\frac{4}{\\sqrt{3}} \\sqrt{k_B T \\, E_0}.\n$$\n\n你必须构建一个支撑集在 $\\,E>0\\,$ 上的重要性采样密度 $\\,q_T(E)\\,$，用以近似 $\\,h_T(E)\\,$ 的峰值区域。使用伽马分布，其参数为形状参数 $\\,k_T\\,$ 和尺度参数 $\\,\\theta_T\\,$，使其均值和方差与 $\\,E_0(T)\\,$ 和 $\\,\\sigma_T^2\\,$ 匹配：\n$$\nq_T(E) = \\frac{1}{\\Gamma(k_T) \\, \\theta_T^{k_T}}\\, E^{k_T - 1}\\, \\exp\\!\\left(-\\frac{E}{\\theta_T}\\right), \\quad \\mathbb{E}_{q_T}[E] = k_T \\theta_T = E_0, \\quad \\mathrm{Var}_{q_T}[E] = k_T \\theta_T^2 = \\sigma_T^2.\n$$\n从这些约束条件中，推导出\n$$\n\\theta_T = \\frac{2}{3} k_B T, \\quad k_T = \\frac{3}{2} \\frac{E_0}{k_B T}.\n$$\n有了这个 $\\,q_T\\,$，$\\,I(T)\\,$ 的重要性采样蒙特卡洛估计器为\n$$\n\\widehat{I}_{\\mathrm{IS}}(T) = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{h_T(E_i)}{q_T(E_i)}, \\quad E_i \\sim q_T.\n$$\n估计器的方差为\n$$\n\\mathrm{Var}\\!\\left[\\widehat{I}_{\\mathrm{IS}}(T)\\right] = \\frac{1}{N} \\left( \\mathbb{E}_{q_T}\\!\\left[\\left(\\frac{h_T(E)}{q_T(E)}\\right)^2\\right] - I(T)^2 \\right).\n$$\n在实践中，通过权重的样本方差除以 $\\,N\\,$ 来估计它。为了进行比较，构建一个使用纯 Boltzmann 指数提议分布的基准估计器\n$$\nq_0(E) = \\frac{1}{k_B T} \\exp\\!\\left(-\\frac{E}{k_B T}\\right), \\quad \\widehat{I}_{0}(T) = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{h_T(E_i)}{q_0(E_i)} = \\frac{1}{N} \\sum_{i=1}^{N} k_B T \\, \\sigma(E_i)\\, E_i, \\quad E_i \\sim q_0.\n$$\n\n氘-氚的科学常数必须使用国际单位制 (SI)：\n- 光速 $\\,c = 299792458\\,\\mathrm{m/s}$。\n- 精细结构常数 $\\,\\alpha = 7.2973525693\\times 10^{-3}$。\n- 原子质量单位 $\\,u = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$。\n- 氘质量 $\\,m_D = 2.013553212745\\,\\mathrm{u}$。\n- 氚质量 $\\,m_T = 3.0155007139\\,\\mathrm{u}$。\n- 折合质量 $\\,\\mu = \\frac{m_D m_T}{m_D + m_T}$。\n- 电子伏特转换 $\\,1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$，因此 $\\,1\\,\\mathrm{keV} = 1.602176634\\times 10^{-16}\\,\\mathrm{J}$。\n- 采用 $\\,S_0 = 3.7\\times 10^{-40}\\,\\mathrm{m^2\\cdot J}\\,$ 作为一个经过校准的常数天体物理因子，它能在几十 $\\mathrm{keV}$ 范围内为 $\\,\\sigma(E)\\,$ 生成实际的量级。\n\n所有温度都以千电子伏特 (keV) 为单位的能量尺度 $\\,k_B T\\,$ 来指定，即，将 $\\,T_{\\mathrm{keV}}\\,$ 解释为 $\\,k_B T = T_{\\mathrm{keV}} \\times 1\\,\\mathrm{keV}\\,$。输出的反应率 $\\,\\langle \\sigma v \\rangle\\,$ 必须以 $\\,\\mathrm{m^3/s}\\,$ 为单位表示，方差以 $\\,\\mathrm{m^6/s^2}\\,$ 为单位表示。\n\n设计并实现程序以完成以下任务：\n- 为每个测试用例计算 $\\,E_G\\,$, $\\,E_0(T)\\,$, $\\,k_T\\,$, $\\,\\theta_T\\,$，以及重要性采样估计器 $\\,\\widehat{I}_{\\mathrm{IS}}(T)\\,$。\n- 计算相应的反应率估计值 $\\,\\widehat{R}_{\\mathrm{IS}}(T) = C(T)\\, \\widehat{I}_{\\mathrm{IS}}(T)\\,$。\n- 估计 $\\,\\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)]\\,$ 并传播到 $\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}(T)] = C(T)^2 \\, \\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)]\\,$。\n- 计算基准指数提议分布估计器 $\\,\\widehat{I}_0(T)\\,$ 及其方差，以及传播后的基准反应率方差 $\\,\\mathrm{Var}[\\widehat{R}_0(T)]\\,$。\n\n测试套件：\n提供以下参数集 $\\,\\{(T_{\\mathrm{keV}}, N)\\}\\,$ 的结果：\n- $\\,\\left(10, 50000\\right)\\,$，一个典型的“理想路径”案例。\n- $\\,\\left(5, 50000\\right)\\,$，一个较低温度的案例。\n- $\\,\\left(20, 50000\\right)\\,$，一个较高温度的案例。\n- $\\,\\left(10, 100\\right)\\,$，一个低样本量的边界案例。\n- $\\,\\left(100, 50000\\right)\\,$，一个非常高温度的案例。\n\n最终输出格式：\n你的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，对于上述顺序的每个测试用例，包含三个浮点数：\n$\\,\\left[\\widehat{R}_{\\mathrm{IS}},\\, \\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}],\\, \\mathrm{Var}[\\widehat{R}_0],\\, \\ldots \\right]\\,$。所有值必须使用国际单位制，反应率单位为 $\\,\\mathrm{m^3/s}\\,$，方差单位为 $\\,\\mathrm{m^6/s^2}\\,$。",
            "solution": "本任务是为氘-氚 (D–T) 聚变反应率 $\\langle \\sigma v \\rangle$ 构建并分析一个蒙特卡洛估计器，该估计器使用重要性采样方案。解决方案的开发首先要建立物理和数学框架，然后概述计算算法，其中包括与一个更简单的基准蒙特卡洛方法的比较。\n\n在温度为 $\\,T\\,$ 的热等离子体中，D–T聚变反应率由聚变截面 $\\,\\sigma(E)\\,$ 和相对速度 $\\,v\\,$ 的乘积对相对动能 $\\,E\\,$ 的 Maxwell–Boltzmann 分布的积分给出。这可以写作\n$$\n\\langle \\sigma v \\rangle = C(T) \\, I(T),\n$$\n其中\n$$\nI(T) = \\int_{0}^{\\infty} h_T(E) \\, dE = \\int_{0}^{\\infty} S_0 \\, \\exp\\!\\left(-\\frac{E}{k_B T} - \\sqrt{\\frac{E_G}{E}}\\right) dE,\n$$\n且系数 $\\,C(T)\\,$ 为\n$$\nC(T) = \\sqrt{\\frac{8}{\\pi \\mu}} \\frac{1}{(k_B T)^{3/2}}.\n$$\n这里，$\\,h_T(E)\\,$ 是被积函数，$\\,S_0\\,$ 是天体物理因子，$\\,E_G\\,$ 是 Gamow 能量，$\\,\\mu\\,$ 是 D-T 对的折合质量，$\\,k_B\\,$ 是 Boltzmann 常数。所有计算都必须使用国际单位制 (SI) 进行。\n\n首先，我们计算必要的物理常数。D-T 折合质量 $\\,\\mu\\,$ 是根据给定的氘 ($\\,m_D\\,$) 和氚 ($\\,m_T\\,$) 的质量计算的：\n$$\n\\mu = \\frac{m_D m_T}{m_D + m_T}.\n$$\n然后，使用 $\\,\\mu\\,$、光速 $\\,c\\,$ 和精细结构常数 $\\,\\alpha\\,$ 计算 Gamow 能量 $\\,E_G\\,$：\n$$\nE_G = \\frac{1}{2} \\, \\mu \\, c^2 \\, (2\\pi \\alpha)^2.\n$$\n这些常数，连同 $\\,S_0\\,$ 和电子伏特到焦耳的转换因子，构成了所有后续计算的基础。\n\n问题的核心是使用蒙特卡洛方法估计积分 $\\,I(T)\\,$。被积函数 $\\,h_T(E)\\,$ 在 Gamow 峰能量 $\\,E_0(T)\\,$ 附近呈尖峰状，这使得朴素的采样方法效率低下。采用重要性采样将采样点集中在这个高贡献区域，从而减小估计器的方差。\n\n选择一个重要性采样概率密度函数 $\\,q_T(E)\\,$ 来近似 $\\,h_T(E)\\,$ 的形状。选用伽马分布，因为它定义在 $\\,E>0\\,$ 上并且其形状可以调整。伽马分布由下式给出\n$$\nq_T(E) = \\frac{1}{\\Gamma(k_T) \\, \\theta_T^{k_T}}\\, E^{k_T - 1}\\, \\exp\\!\\left(-\\frac{E}{\\theta_T}\\right),\n$$\n其形状参数为 $\\,k_T\\,$，尺度参数为 $\\,\\theta_T\\,$。这些参数是通过将 $\\,q_T(E)\\,$ 的均值和方差与 Gamow 峰的位置和宽度相匹配来确定的。Gamow 峰的位置 $\\,E_0\\,$ 是在 $\\,h_T(E)\\,$ 的负指数取最小值处找到的：\n$$\nE_0(T) = \\left(\\frac{1}{2} \\sqrt{E_G} \\, k_B T \\right)^{2/3}.\n$$\n方差通过峰值处指数的二阶导数来近似，得到 $\\,\\sigma_T^2 \\approx \\frac{2}{3} k_B T E_0\\,$。匹配 $\\,\\mathbb{E}_{q_T}[E] = k_T \\theta_T = E_0\\,$ 和 $\\,\\mathrm{Var}_{q_T}[E] = k_T \\theta_T^2 = \\sigma_T^2\\,$ 可以得出采样分布的参数：\n$$\n\\theta_T = \\frac{\\sigma_T^2}{E_0} = \\frac{2}{3} k_B T, \\qquad k_T = \\frac{E_0}{\\theta_T} = \\frac{3}{2} \\frac{E_0}{k_B T}.\n$$\n对于测试套件中的每个温度 $\\,T\\,$，都会计算这些参数 $\\,E_0(T)\\,$, $\\,k_T\\,$ 和 $\\,\\theta_T\\,$。\n\n定义了采样分布 $\\,q_T(E)\\,$ 后，基于从 $\\,q_T\\,$ 分布中抽取的 $\\,N\\,$ 个样本 $\\,E_i\\,$ 的 $\\,I(T)\\,$ 的重要性采样估计器为\n$$\n\\widehat{I}_{\\mathrm{IS}}(T) = \\frac{1}{N} \\sum_{i=1}^{N} w_i, \\quad \\text{其中 } w_i = \\frac{h_T(E_i)}{q_T(E_i)}.\n$$\n相应的反应率估计值为 $\\,\\widehat{R}_{\\mathrm{IS}}(T) = C(T) \\widehat{I}_{\\mathrm{IS}}(T)\\,$。统计不确定性由该估计器的方差来量化。$\\,\\widehat{I}_{\\mathrm{IS}}(T)\\,$ 的方差由权重 $\\,w_i\\,$ 的样本方差估计得出：\n$$\n\\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)] \\approx \\frac{1}{N} \\mathrm{Var}(w) = \\frac{1}{N} \\left( \\frac{1}{N-1} \\sum_{i=1}^{N} (w_i - \\widehat{I}_{\\mathrm{IS}})^2 \\right).\n$$\n然后将方差传播到反应率估计上：$\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}(T)] = C(T)^2 \\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)]\\,$。\n\n为了进行比较，构建了一个基准蒙特卡洛估计器，它使用一个更简单的提议分布 $\\,q_0(E)\\,$，即纯 Boltzmann 指数项：\n$$\nq_0(E) = \\frac{1}{k_B T} \\exp\\!\\left(-\\frac{E}{k_B T}\\right).\n$$\n这对应于从尺度参数为 $\\,k_B T\\,$ 的指数分布中采样。$\\,I(T)\\,$ 的基准估计器是 $\\,\\widehat{I}_{0}(T) = \\frac{1}{N} \\sum_{i=1}^{N} w'_i\\,$，其权重为\n$$\nw'_i = \\frac{h_T(E_i)}{q_0(E_i)} = k_B T \\, \\sigma(E_i) E_i = k_B T \\, S_0 \\, \\exp\\!\\left(-\\sqrt{\\frac{E_G}{E_i}}\\right),\n$$\n其中 $\\,E_i\\,$ 从 $\\,q_0\\,$ 分布中抽样。相应反应率估计的方差 $\\,\\mathrm{Var}[\\widehat{R}_0(T)]\\,$ 的计算方法类似，即计算权重 $\\,w'_i\\,$ 的样本方差，并用因子 $\\,C(T)^2 / N\\,$ 进行传播。预计该方法的效率较低（方差较大），因为它没有专门针对 Gamow 峰区域进行采样。\n\n每个测试用例 $\\,(T_{\\mathrm{keV}}, N)\\,$ 的计算过程如下：\n1. 将温度 $\\,T_{\\mathrm{keV}}\\,$ 转换为焦耳：$\\,k_B T = T_{\\mathrm{keV}} \\times (1000 \\times 1.602176634\\times 10^{-19}) \\,\\mathrm{J}\\,$。\n2. 计算与温度相关的参数 $\\,E_0(T)\\,$, $\\,k_T\\,$, $\\,\\theta_T\\,$ 和 $\\,C(T)\\,$。\n3. 从伽马分布 $\\,\\text{Gamma}(k_T, \\theta_T)\\,$ 中生成 $\\,N\\,$ 个随机能量样本 $\\,\\{E_i\\}\\,$。\n4. 对于每个样本 $\\,E_i\\,$，计算权重 $\\,w_i = h_T(E_i)/q_T(E_i)\\,$。\n5. 计算重要性采样的反应率估计值 $\\,\\widehat{R}_{\\mathrm{IS}}\\,$ 及其方差 $\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}]\\,$。\n6. 从尺度为 $\\,k_B T\\,$ 的指数分布中生成 $\\,N\\,$ 个随机能量样本 $\\,\\{E'_i\\}\\,$。\n7. 对于每个样本 $\\,E'_i\\,$，计算基准权重 $\\,w'_i = k_B T S_0 \\exp(-\\sqrt{E_G/E'_i})\\,$。\n8. 计算基准反应率估计的方差 $\\,\\mathrm{Var}[\\widehat{R}_0]\\,$。\n9. 存储三个结果值：$\\,\\widehat{R}_{\\mathrm{IS}}\\,$, $\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}]\\,$ 和 $\\,\\mathrm{Var}[\\widehat{R}_0]\\,$。\n\n对所有指定的测试用例重复此过程，并将结果收集到单个格式化的输出字符串中。使用 `numpy` 有助于进行基于数组的计算以提高效率，而 `scipy.special.gammaln` 用于对 $\\,q_T(E)\\,$ 分母中的伽马函数对数进行数值稳定的计算。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Computes D-T fusion reactivity using importance-sampled Monte Carlo\n    and analyzes its variance compared to a baseline method.\n    \"\"\"\n    # Scientific constants in SI units\n    C_LIGHT = 299792458.0  # m/s\n    ALPHA = 7.2973525693e-3  # Fine-structure constant\n    AMU = 1.66053906660e-27  # kg\n    M_D = 2.013553212745 * AMU  # kg\n    M_T = 3.0155007139 * AMU  # kg\n    EV_TO_J = 1.602176634e-19  # J/eV\n    KEV_TO_J = EV_TO_J * 1000  # J/keV\n    S0 = 3.7e-40  # m^2 * J\n\n    # Derived constants\n    MU = (M_D * M_T) / (M_D + M_T)  # Reduced mass, kg\n    E_G = 0.5 * MU * C_LIGHT**2 * (2 * np.pi * ALPHA)**2  # Gamow energy, J\n\n    # Test suite: (T_keV, N_samples)\n    test_cases = [\n        (10, 50000),\n        (5, 50000),\n        (20, 50000),\n        (10, 100),\n        (100, 50000),\n    ]\n\n    results = []\n\n    for T_keV, N in test_cases:\n        # Set a seed for reproducibility of random numbers per case\n        np.random.seed(hash((T_keV, N)) % 0xFFFFFFFF)\n\n        kBT = T_keV * KEV_TO_J  # Thermal energy in Joules\n\n        # --- Temperature-dependent parameters ---\n        # Gamow peak energy E0\n        E0 = ((0.5 * np.sqrt(E_G) * kBT))**(2/3)\n\n        # Importance sampling (gamma distribution) parameters\n        theta_T = (2/3) * kBT\n        k_T = (3/2) * E0 / kBT\n\n        # Coefficient C(T) to get reactivity from the integral I(T)\n        C_T = np.sqrt(8 / (np.pi * MU)) / (kBT**1.5)\n\n        # --- Importance Sampling (IS) Calculation ---\n        # 1. Sample energies from the gamma distribution q_T(E)\n        #    numpy.random.gamma takes shape (k) and scale (theta)\n        E_samples_is = np.random.gamma(shape=k_T, scale=theta_T, size=N)\n        \n        # Avoid E=0 if it occurs, though highly improbable for these parameters\n        E_samples_is[E_samples_is == 0] = np.finfo(float).eps\n\n        # 2. Calculate the integrand h_T(E)\n        h_T = S0 * np.exp(-E_samples_is / kBT - np.sqrt(E_G / E_samples_is))\n\n        # 3. Calculate the proposal PDF q_T(E) using log-gamma for stability\n        log_q_T = (-gammaln(k_T) - k_T * np.log(theta_T) +\n                   (k_T - 1) * np.log(E_samples_is) - E_samples_is / theta_T)\n        q_T = np.exp(log_q_T)\n\n        # 4. Calculate importance weights\n        weights_is = h_T / q_T\n\n        # 5. Compute estimator for I(T) and its variance\n        I_hat_is = np.mean(weights_is)\n        # Variance of the mean is sample variance / N\n        var_I_hat_is = np.var(weights_is, ddof=1) / N\n\n        # 6. Propagate to reactivity and its variance\n        R_hat_is = C_T * I_hat_is\n        var_R_hat_is = C_T**2 * var_I_hat_is\n\n        # --- Baseline (Exponential) Calculation ---\n        # 1. Sample energies from the exponential distribution q_0(E)\n        #    numpy.random.exponential takes scale (beta = 1/lambda)\n        E_samples_base = np.random.exponential(scale=kBT, size=N)\n        \n        # Avoid E=0\n        E_samples_base[E_samples_base == 0] = np.finfo(float).eps\n\n        # 2. Calculate weights for the baseline estimator\n        weights_base = kBT * S0 * np.exp(-np.sqrt(E_G / E_samples_base))\n\n        # 3. Compute estimator variance\n        #    We only need the variance for the final output\n        var_I_hat_base = np.var(weights_base, ddof=1) / N\n\n        # 4. Propagate to reactivity variance\n        var_R_hat_base = C_T**2 * var_I_hat_base\n\n        results.extend([R_hat_is, var_R_hat_is, var_R_hat_base])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}