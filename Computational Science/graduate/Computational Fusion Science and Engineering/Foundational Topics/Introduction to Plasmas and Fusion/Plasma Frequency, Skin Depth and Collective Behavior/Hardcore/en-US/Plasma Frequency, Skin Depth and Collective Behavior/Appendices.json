{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of plasma physics is the principle of timescale separation, which allows us to use different physical models to describe phenomena occurring at vastly different speeds. This exercise challenges you to quantify this separation in a realistic fusion context by deriving a dimensionless parameter comparing the timescale of rapid electron plasma oscillations to that of slow, large-scale magnetohydrodynamic (MHD) transport . By deriving the electron plasma frequency and the Alfvén transit time from first principles, you will gain a deeper appreciation for why phenomena like Langmuir waves and MHD instabilities can be treated independently in many computational models.",
            "id": "4029341",
            "problem": "A magnetically confined deuterium–tritium fusion plasma in a large–aspect ratio toroidal device has a uniform minor radius $a$, a uniform toroidal magnetic field $B_0$, and a uniform electron number density $n_e$. Assume quasi-neutrality with singly charged ions ($Z=1$), and an equal deuterium–tritium mixture so that the mean ion mass is $m_i = 2.5\\,m_p$, where $m_p$ is the proton mass. You may assume that, for the purpose of electron plasma oscillations, the electrons can be modeled as a cold, pressureless fluid and the ions are stationary on the electron oscillation timescale. For magnetohydrodynamic (MHD) Alfvén dynamics, use the ideal, perfectly conducting single-fluid description with mass density dominated by the ions. \n\nStarting from fundamental electrodynamics and fluid momentum conservation, derive a dimensionless parameter $\\Xi$ that quantifies the separation of electron collective oscillation and MHD transport, defined as the product of the electron plasma angular frequency and the Alfvén transit time across the minor radius, namely $\\Xi \\equiv \\omega_{pe}\\,t_A$, where $t_A$ is the time required for an Alfvénic disturbance to traverse the distance $a$. Express $\\Xi$ in terms of the given physical parameters and universal constants, and then evaluate it numerically for the following scientifically realistic values:\n- $a = 0.75\\ \\mathrm{m}$,\n- $B_0 = 5.2\\ \\mathrm{T}$,\n- $n_e = 1.1 \\times 10^{20}\\ \\mathrm{m}^{-3}$,\n- $m_i = 2.5\\,m_p$.\n\nUse the following constants as needed in your derivation and evaluation: $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$, $m_e = 9.1093837015 \\times 10^{-31}\\ \\mathrm{kg}$, $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$, $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$, $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$. \n\nExpress your final result for $\\Xi$ as a dimensionless number. Round your answer to three significant figures.",
            "solution": "The problem statement is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n-   System: Magnetically confined deuterium–tritium fusion plasma.\n-   Geometry: Uniform minor radius $a$, large–aspect ratio torus.\n-   Fields and Densities: Uniform toroidal magnetic field $B_0$, uniform electron number density $n_e$.\n-   Plasma Composition: Quasi-neutral with singly charged ions ($Z=1$), equal deuterium–tritium mixture giving a mean ion mass $m_i = 2.5\\,m_p$, where $m_p$ is the proton mass.\n-   Model for Electron Oscillations: Cold, pressureless electron fluid; ions are stationary.\n-   Model for MHD Dynamics: Ideal, perfectly conducting single-fluid; mass density dominated by ions.\n-   Parameter to Derive: $\\Xi \\equiv \\omega_{pe}\\,t_A$, where $\\omega_{pe}$ is the electron plasma angular frequency and $t_A$ is the Alfvén transit time across the minor radius $a$.\n-   Numerical Values:\n    -   $a = 0.75\\ \\mathrm{m}$\n    -   $B_0 = 5.2\\ \\mathrm{T}$\n    -   $n_e = 1.1 \\times 10^{20}\\ \\mathrm{m}^{-3}$\n    -   $m_i = 2.5\\,m_p$\n-   Constants:\n    -   $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n    -   $m_e = 9.1093837015 \\times 10^{-31}\\ \\mathrm{kg}$\n    -   $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n    -   $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$\n    -   $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is deeply rooted in fundamental plasma physics, specifically the concepts of electron plasma (Langmuir) waves and magnetohydrodynamic (MHD) Alfvén waves. These are cornerstone topics in fusion science. The physical parameters and plasma composition are representative of current and future fusion energy experiments like ITER.\n-   **Well-Posedness**: The problem clearly defines the target parameter $\\Xi$ and provides all necessary information and simplifying assumptions (cold fluid, ideal MHD) required to derive a unique analytical expression and subsequently compute a numerical value.\n-   **Objectivity**: The language is technical and devoid of subjective or ambiguous terminology.\n-   **Completeness and Consistency**: The problem is self-contained. All variables, constants, and assumptions are provided. The assumptions for different physical regimes (high-frequency electron dynamics vs. low-frequency MHD dynamics) are standard and consistent with a timescale separation analysis.\n-   **Realism**: The numerical values for magnetic field, density, and device size are scientifically realistic for a high-performance tokamak.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a well-posed, scientifically grounded problem in computational fusion science. The solution process will now proceed.\n\nThe goal is to derive and evaluate the dimensionless parameter $\\Xi \\equiv \\omega_{pe}\\,t_A$. This requires deriving expressions for the electron plasma frequency $\\omega_{pe}$ and the Alfvén transit time $t_A$ from fundamental principles.\n\n**Derivation of the Electron Plasma Frequency $\\omega_{pe}$**\nWe model the electrons as a cold, pressureless fluid responding to an electric field, with the massive ions providing a stationary, uniform neutralizing background charge. The relevant equations are the electron fluid momentum equation, the electron continuity equation, and Gauss's law.\n\nLet the equilibrium electron density be $n_e$ and the ion density be $n_i$. For a quasi-neutral plasma with $Z=1$ ions, $n_i = n_e$.\nWe consider small perturbations from equilibrium:\n-   Electron density: $n(\\mathbf{x}, t) = n_e + n_1(\\mathbf{x}, t)$\n-   Electron fluid velocity: $\\mathbf{v}(\\mathbf{x}, t) = \\mathbf{0} + \\mathbf{v}_1(\\mathbf{x}, t)$\n-   Electric field: $\\mathbf{E}(\\mathbf{x}, t) = \\mathbf{0} + \\mathbf{E}_1(\\mathbf{x}, t)$\n\nThe linearized electron momentum equation is:\n$$m_e \\frac{\\partial \\mathbf{v}_1}{\\partial t} = -e \\mathbf{E}_1$$\nThe linearized electron continuity equation is:\n$$\\frac{\\partial n_1}{\\partial t} + \\nabla \\cdot (n_e \\mathbf{v}_1) = 0 \\implies \\frac{\\partial n_1}{\\partial t} + n_e \\nabla \\cdot \\mathbf{v}_1 = 0$$\nGauss's law relates the electric field to the net charge density perturbation, which is solely due to the electron density perturbation $n_1$ since the ions are assumed stationary:\n$$\\nabla \\cdot \\mathbf{E}_1 = \\frac{-e n_1}{\\epsilon_0}$$\nWe seek harmonic solutions of the form $e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}$. The differential operators become algebraic: $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$ and $\\nabla \\rightarrow i\\mathbf{k}$.\nThe equations become:\n$$-i\\omega m_e \\mathbf{v}_1 = -e \\mathbf{E}_1$$\n$$-i\\omega n_1 + i n_e (\\mathbf{k} \\cdot \\mathbf{v}_1) = 0$$\n$$i (\\mathbf{k} \\cdot \\mathbf{E}_1) = \\frac{-e n_1}{\\epsilon_0}$$\nFrom the first equation, $\\mathbf{v}_1 = \\frac{e \\mathbf{E}_1}{i\\omega m_e}$. Substituting this into the second equation:\n$$-\\omega n_1 + n_e \\left(\\mathbf{k} \\cdot \\frac{e \\mathbf{E}_1}{i\\omega m_e}\\right) = 0 \\implies \\omega n_1 = \\frac{n_e e}{i\\omega m_e} (\\mathbf{k} \\cdot \\mathbf{E}_1)$$\nFrom the third equation, $(\\mathbf{k} \\cdot \\mathbf{E}_1) = \\frac{i e n_1}{\\epsilon_0}$. Substituting this into the previous result:\n$$\\omega n_1 = \\frac{n_e e}{i\\omega m_e} \\left(\\frac{i e n_1}{\\epsilon_0}\\right) = \\frac{n_e e^2 n_1}{\\omega m_e \\epsilon_0}$$\nFor a non-trivial solution ($n_1 \\neq 0$), we must have:\n$$\\omega^2 = \\frac{n_e e^2}{m_e \\epsilon_0}$$\nThis defines the electron plasma angular frequency, $\\omega_{pe}$:\n$$\\omega_{pe} = \\sqrt{\\frac{n_e e^2}{m_e \\epsilon_0}}$$\n\n**Derivation of the Alfvén Transit Time $t_A$**\nThe Alfvén transit time is the time for an Alfvén wave to cross the minor radius $a$, given by $t_A = a / v_A$, where $v_A$ is the Alfvén speed.\nWe derive $v_A$ from the equations of ideal, single-fluid MHD. The mass density of the single fluid is dominated by the ions, so $\\rho \\approx n_i m_i$. With $Z=1$ and quasi-neutrality, $n_i=n_e$, so $\\rho = n_e m_i$.\nThe linearized ideal MHD momentum and induction equations are:\n$$\\rho \\frac{\\partial \\mathbf{v}_1}{\\partial t} = \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0$$\n$$\\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0)$$\nHere, $\\mathbf{B}_0$ is the uniform background magnetic field and $\\mathbf{B}_1$, $\\mathbf{v}_1$ are the small perturbations.\nUsing the vector identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$, the momentum equation becomes:\n$$\\rho \\frac{\\partial \\mathbf{v}_1}{\\partial t} = \\frac{1}{\\mu_0}[(\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{B}_1 - \\nabla(\\mathbf{B}_0 \\cdot \\mathbf{B}_1)]$$\nThe induction equation becomes:\n$$\\frac{\\partial \\mathbf{B}_1}{\\partial t} = (\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{v}_1 - \\mathbf{B}_0(\\nabla \\cdot \\mathbf{v}_1)$$\nFor shear Alfvén waves propagating parallel to $\\mathbf{B}_0$, we can set $\\nabla \\cdot \\mathbf{v}_1 = 0$ (incompressible) and $\\mathbf{B}_0 \\cdot \\mathbf{B}_1 = 0$ (transverse perturbation). The equations simplify to:\n$$\\rho \\frac{\\partial \\mathbf{v}_1}{\\partial t} = \\frac{1}{\\mu_0}(\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{B}_1$$\n$$\\frac{\\partial \\mathbf{B}_1}{\\partial t} = (\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{v}_1$$\nTaking the time derivative of the first equation and substituting the second gives a wave equation for $\\mathbf{v}_1$:\n$$\\rho \\frac{\\partial^2 \\mathbf{v}_1}{\\partial t^2} = \\frac{1}{\\mu_0}(\\mathbf{B}_0 \\cdot \\nabla)\\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\frac{1}{\\mu_0}(\\mathbf{B}_0 \\cdot \\nabla)[(\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{v}_1] = \\frac{1}{\\mu_0}(\\mathbf{B}_0 \\cdot \\nabla)^2 \\mathbf{v}_1$$\nAssuming a plane wave solution $e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}$ with wavevector $\\mathbf{k}$ parallel to $\\mathbf{B}_0$, the operator $(\\mathbf{B}_0 \\cdot \\nabla)$ becomes $i(\\mathbf{B}_0 \\cdot \\mathbf{k}) = i B_0 k$. The wave equation becomes:\n$$\\rho (-\\omega^2) \\mathbf{v}_1 = \\frac{1}{\\mu_0}(i B_0 k)^2 \\mathbf{v}_1 = -\\frac{B_0^2 k^2}{\\mu_0} \\mathbf{v}_1$$\nThis yields the dispersion relation for Alfvén waves:\n$$\\omega^2 = \\left(\\frac{B_0^2}{\\rho \\mu_0}\\right) k^2$$\nThe phase velocity is $v_A = \\omega/k$, so the Alfvén speed is:\n$$v_A = \\sqrt{\\frac{B_0^2}{\\rho \\mu_0}} = \\frac{B_0}{\\sqrt{\\mu_0 \\rho}}$$\nSubstituting $\\rho = n_e m_i$:\n$$v_A = \\frac{B_0}{\\sqrt{\\mu_0 n_e m_i}}$$\nThe Alfvén transit time is therefore:\n$$t_A = \\frac{a}{v_A} = \\frac{a \\sqrt{\\mu_0 n_e m_i}}{B_0}$$\n\n**Derivation of the Dimensionless Parameter $\\Xi$**\nNow we combine the expressions for $\\omega_{pe}$ and $t_A$:\n$$\\Xi = \\omega_{pe} \\, t_A = \\left(\\sqrt{\\frac{n_e e^2}{m_e \\epsilon_0}}\\right) \\left(\\frac{a \\sqrt{\\mu_0 n_e m_i}}{B_0}\\right)$$\nGrouping terms:\n$$\\Xi = \\frac{a e}{B_0} \\sqrt{\\frac{n_e}{m_e \\epsilon_0}} \\sqrt{\\mu_0 n_e m_i} = \\frac{a e n_e}{B_0} \\sqrt{\\frac{\\mu_0 m_i}{m_e \\epsilon_0}}$$\nThis is the final symbolic expression for $\\Xi$.\n\n**Numerical Evaluation**\nWe substitute the given values into the derived expression:\n-   $a = 0.75\\ \\mathrm{m}$\n-   $n_e = 1.1 \\times 10^{20}\\ \\mathrm{m}^{-3}$\n-   $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n-   $B_0 = 5.2\\ \\mathrm{T}$\n-   $m_i = 2.5\\,m_p = 2.5 \\times (1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}) = 4.181554809225 \\times 10^{-27}\\ \\mathrm{kg}$\n-   $m_e = 9.1093837015 \\times 10^{-31}\\ \\mathrm{kg}$\n-   $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$\n-   $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n\nLet's calculate the two parts of the expression for $\\Xi$:\nThe prefactor term:\n$$\\frac{a e n_e}{B_0} = \\frac{(0.75) (1.602176634 \\times 10^{-19}) (1.1 \\times 10^{20})}{5.2} \\approx 2.54191485$$\nThe square root term:\n$$\\sqrt{\\frac{\\mu_0 m_i}{m_e \\epsilon_0}} = \\sqrt{\\frac{(4\\pi \\times 10^{-7}) (4.1815548 \\times 10^{-27})}{(9.1093837 \\times 10^{-31}) (8.8541878 \\times 10^{-12})}}$$\n$$\\sqrt{\\frac{5.25405105 \\times 10^{-33}}{8.06450638 \\times 10^{-42}}} = \\sqrt{651493064.6} \\approx 25524.3621$$\nMultiplying the two parts:\n$$\\Xi = (2.54191485) \\times (25524.3621) \\approx 64881.05$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\Xi \\approx 6.49 \\times 10^4$$\nThis large value confirms the validity of the timescale separation assumption: electron plasma oscillations are many tens of thousands of times faster than the macroscopic MHD transport phenomena over the scale of the minor radius.",
            "answer": "$$\\boxed{6.49 \\times 10^4}$$"
        },
        {
            "introduction": "Understanding how electromagnetic waves interact with a plasma is crucial for applications ranging from plasma heating to diagnostics. This practice problem moves from internal oscillations to the plasma's response to an external driver, specifically a radio-frequency (RF) wave . You will derive the plasma's complex surface impedance and reflection coefficient, accounting for both the collective electron response and the dissipative effect of collisions. This exercise provides a concrete link between the abstract concept of a plasma's dielectric function and the practical engineering challenge of efficiently coupling power into a fusion device.",
            "id": "4029338",
            "problem": "A semi-infinite, spatially uniform, unmagnetized, electron-ion plasma occupies the half-space $z > 0$, and vacuum occupies $z  0$. A normally incident, linearly polarized Radio Frequency (RF) plane wave of frequency $f$ is incident from vacuum onto the planar plasma boundary at $z = 0$. The plasma has electron number density $n_{e}$, electron mass $m_{e}$, electron charge $e$, and a phenomenological electron collision frequency $\\nu$; ions are assumed stationary and only provide a neutralizing background. The plasma is isotropic, and magnetic permeability is taken to be the vacuum value $\\mu_{0}$ throughout. The given parameters are $n_{e} = 5.0 \\times 10^{19}\\ \\text{m}^{-3}$, $\\nu = 2.0 \\times 10^{7}\\ \\text{s}^{-1}$, and $f = 80\\ \\text{MHz}$, so that $\\omega = 2\\pi f$. The incident field is monochromatic with time dependence $\\exp(- i \\omega t)$, and the vacuum fields satisfy the standard plane-wave relations.\n\nUsing Maxwell’s equations, the linearized electron-fluid momentum equation $m_{e}\\,\\frac{d \\mathbf{v}}{dt} = - e\\,\\mathbf{E} - m_{e}\\,\\nu\\,\\mathbf{v}$ and $\\mathbf{J} = - n_{e}\\,e\\,\\mathbf{v}$, and the appropriate electromagnetic boundary conditions for tangential fields at $z = 0$, derive the complex surface impedance $Z_{s} \\equiv E_{t}/H_{t}$ seen by the incident wave at the plasma boundary in terms of the plasma’s collective response. Then, use this to determine the normal-incidence reflection coefficient for the electric field at the vacuum–plasma interface and compute the reflected power fraction $\\mathcal{R}$ as a real number, where $\\mathcal{R} = |r|^{2}$ and $r$ is the complex field reflection coefficient.\n\nExpress the final reflected power fraction $\\mathcal{R}$ as a decimal number, and round your answer to four significant figures. No units should be included in the final answer.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and all necessary information is provided.\n\n**Step 1: Extract Givens**\n-   Geometry: Semi-infinite plasma for $z > 0$, vacuum for $z  0$.\n-   Plasma is spatially uniform, unmagnetized, and consists of electrons and stationary ions.\n-   Incident wave: Normally incident, linearly polarized RF plane wave from vacuum.\n-   Wave frequency: $f = 80\\ \\text{MHz}$.\n-   Electron number density: $n_{e} = 5.0 \\times 10^{19}\\ \\text{m}^{-3}$.\n-   Electron collision frequency: $\\nu = 2.0 \\times 10^{7}\\ \\text{s}^{-1}$.\n-   Constants and assumed properties: electron mass $m_e$, electron charge $e$, vacuum permeability $\\mu_0$ everywhere.\n-   Time dependence: $\\exp(- i \\omega t)$, with $\\omega = 2\\pi f$.\n-   Governing equations: Maxwell’s equations, linearized electron-fluid momentum equation $m_{e}\\,\\frac{d \\mathbf{v}}{dt} = - e\\,\\mathbf{E} - m_{e}\\,\\nu\\,\\mathbf{v}$, and current density $\\mathbf{J} = - n_{e}\\,e\\,\\mathbf{v}$.\n-   Boundary conditions: Continuity of tangential electric ($E_t$) and magnetic ($H_t$) fields at $z=0$.\n-   Definitions: Complex surface impedance $Z_{s} \\equiv E_{t}/H_{t}$ at $z = 0$, complex field reflection coefficient $r$, and reflected power fraction $\\mathcal{R} = |r|^{2}$.\n-   Objective: Compute the real number $\\mathcal{R}$, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard model of RF wave interaction with a cold, collisional plasma (the Drude-Lorentz model). The governing equations are fundamental to plasma physics and electromagnetism. The problem is well-posed, providing a complete set of parameters ($n_e, \\nu, f$) and a clear objective. The provided numerical values are physically realistic for laboratory and fusion plasmas. For instance, the calculated plasma frequency ($\\omega_{pe} \\sim 4 \\times 10^{11} \\text{ rad/s}$) is much greater than the wave frequency ($\\omega \\sim 5 \\times 10^8 \\text{ rad/s}$), representing a common \"overdense\" scenario. The problem is objective and contains no contradictions or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We will proceed with a full derivation and solution.\n\n**Derivation and Solution**\n\nThe first step is to determine the electromagnetic response of the plasma, which is characterized by its complex dielectric permittivity. We start with the linearized electron momentum equation, assuming a harmonic time dependence $\\exp(-i\\omega t)$ for the fields and the electron fluid velocity $\\mathbf{v}$. This means the time derivative operator can be replaced as $\\frac{d}{dt} \\to -i\\omega$.\n\nThe momentum equation becomes:\n$$ -i\\omega m_e \\mathbf{v} = -e\\mathbf{E} - m_e \\nu \\mathbf{v} $$\nWe solve for the electron velocity $\\mathbf{v}$ in terms of the electric field $\\mathbf{E}$:\n$$ m_e(\\nu - i\\omega) \\mathbf{v} = -e\\mathbf{E} $$\n$$ \\mathbf{v} = -\\frac{e}{m_e(\\nu - i\\omega)}\\mathbf{E} $$\nThe plasma current density is given by $\\mathbf{J} = -n_e e \\mathbf{v}$. Substituting the expression for $\\mathbf{v}$:\n$$ \\mathbf{J} = -n_e e \\left( -\\frac{e}{m_e(\\nu - i\\omega)}\\mathbf{E} \\right) = \\frac{n_e e^2}{m_e(\\nu - i\\omega)}\\mathbf{E} $$\nThis expression is in the form of Ohm's law, $\\mathbf{J} = \\sigma \\mathbf{E}$, where $\\sigma$ is the complex conductivity of the plasma:\n$$ \\sigma = \\frac{n_e e^2}{m_e(\\nu - i\\omega)} $$\nNext, we incorporate this into Maxwell's equations. Ampere's law in a conducting medium is $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t}$. With $\\mathbf{D} = \\varepsilon_0 \\mathbf{E}$ and harmonic time dependence, this becomes:\n$$ \\nabla \\times \\mathbf{H} = \\sigma \\mathbf{E} - i\\omega \\varepsilon_0 \\mathbf{E} = (\\sigma - i\\omega\\varepsilon_0)\\mathbf{E} $$\nWe can define a complex permittivity for the plasma, $\\epsilon_p$, such that $\\nabla \\times \\mathbf{H} = -i\\omega \\epsilon_p \\mathbf{E}$. Comparing the two expressions, we find:\n$$ -i\\omega \\epsilon_p = \\sigma - i\\omega\\varepsilon_0 \\implies \\epsilon_p = \\varepsilon_0 + \\frac{\\sigma}{ -i\\omega} = \\varepsilon_0 + i\\frac{\\sigma}{\\omega} $$\nSubstituting the expression for $\\sigma$:\n$$ \\epsilon_p = \\varepsilon_0 + i \\frac{n_e e^2}{\\omega m_e(\\nu - i\\omega)} = \\varepsilon_0 - \\frac{n_e e^2}{m_e \\omega(i\\nu + \\omega)} $$\nIt is standard to introduce the electron plasma frequency, $\\omega_{pe}$, defined by $\\omega_{pe}^2 = \\frac{n_e e^2}{m_e \\varepsilon_0}$. This allows us to write $\\epsilon_p$ in terms of the relative permittivity $\\epsilon_r = \\epsilon_p / \\varepsilon_0$:\n$$ \\epsilon_p = \\varepsilon_0 \\left( 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + i\\nu)} \\right) \\implies \\epsilon_r = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + i\\nu)} $$\nThe surface impedance $Z_s$ seen by a normally incident plane wave is the wave impedance of the medium it is entering. The wave impedance of the plasma, $Z_p$, is given by:\n$$ Z_s = Z_p = \\sqrt{\\frac{\\mu_0}{\\epsilon_p}} = \\sqrt{\\frac{\\mu_0}{\\varepsilon_0 \\epsilon_r}} = \\sqrt{\\frac{\\mu_0}{\\varepsilon_0}} \\frac{1}{\\sqrt{\\epsilon_r}} = \\frac{Z_0}{\\sqrt{\\epsilon_r}} $$\nwhere $Z_0 = \\sqrt{\\mu_0/\\varepsilon_0}$ is the impedance of free space.\n\nThe reflection coefficient $r$ at the interface ($z=0$) is found by applying boundary conditions: continuity of the tangential electric field ($E_{tan}$) and tangential magnetic field ($H_{tan}$). For a wave incident from a medium with impedance $Z_0$ onto a medium with impedance $Z_p$, this yields the standard result:\n$$ r = \\frac{Z_p - Z_0}{Z_p + Z_0} $$\nSubstituting $Z_p = Z_0/\\sqrt{\\epsilon_r}$:\n$$ r = \\frac{Z_0/\\sqrt{\\epsilon_r} - Z_0}{Z_0/\\sqrt{\\epsilon_r} + Z_0} = \\frac{1/\\sqrt{\\epsilon_r} - 1}{1/\\sqrt{\\epsilon_r} + 1} = \\frac{1 - \\sqrt{\\epsilon_r}}{1 + \\sqrt{\\epsilon_r}} $$\nThe reflected power fraction is $\\mathcal{R} = |r|^2$.\n\nNow, we perform the numerical calculation.\nThe given parameters are:\n$f = 80\\ \\text{MHz} = 8.0 \\times 10^7\\ \\text{Hz}$\n$n_e = 5.0 \\times 10^{19}\\ \\text{m}^{-3}$\n$\\nu = 2.0 \\times 10^7\\ \\text{s}^{-1}$\nPhysical constants:\n$e = 1.602177 \\times 10^{-19}\\ \\text{C}$\n$m_e = 9.109384 \\times 10^{-31}\\ \\text{kg}$\n$\\varepsilon_0 = 8.854188 \\times 10^{-12}\\ \\text{F/m}$\n\nFirst, we calculate the angular wave frequency $\\omega$ and the squared plasma frequency $\\omega_{pe}^2$:\n$$ \\omega = 2\\pi f = 2\\pi(8.0 \\times 10^7) \\approx 5.026548 \\times 10^8\\ \\text{rad/s} $$\n$$ \\omega_{pe}^2 = \\frac{n_e e^2}{m_e \\varepsilon_0} = \\frac{(5.0 \\times 10^{19})(1.602177 \\times 10^{-19})^2}{(9.109384 \\times 10^{-31})(8.854188 \\times 10^{-12})} \\approx 1.59151 \\times 10^{23}\\ \\text{s}^{-2} $$\nNow, compute the complex relative permittivity $\\epsilon_r$:\n$$ \\epsilon_r = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + i\\nu)} = 1 - \\frac{1.59151 \\times 10^{23}}{5.026548 \\times 10^8 (5.026548 \\times 10^8 + i(2.0 \\times 10^7))} $$\n$$ \\epsilon_r = 1 - \\frac{1.59151 \\times 10^{23}}{ (2.52661 \\times 10^{17}) + i(1.00531 \\times 10^{16}) } $$\nWe rationalize the denominator of the fraction:\n$$ \\frac{1.59151 \\times 10^{23}}{ (2.52661 \\times 10^{17}) + i(1.00531 \\times 10^{16}) } \\approx 6.2890 \\times 10^5 - i(2.5024 \\times 10^4) $$\nSo, $\\epsilon_r$ is:\n$$ \\epsilon_r = 1 - (6.2890 \\times 10^5 - i(2.5024 \\times 10^4)) = -6.28899 \\times 10^5 + i(2.5024 \\times 10^4) $$\nNext, we find the square root of $\\epsilon_r$. For a complex number $A+iB$, its square root is given by $\\sqrt{\\frac{\\sqrt{A^2+B^2}+A}{2}} + i \\cdot \\text{sgn}(B) \\sqrt{\\frac{\\sqrt{A^2+B^2}-A}{2}}$.\nHere, $A = -6.28899 \\times 10^5$ and $B = 2.5024 \\times 10^4$.\n$$ \\sqrt{\\epsilon_r} \\approx 15.811 + i(793.53) $$\nNow we calculate the reflection coefficient $r$:\n$$ r = \\frac{1 - \\sqrt{\\epsilon_r}}{1 + \\sqrt{\\epsilon_r}} = \\frac{1 - (15.811 + i(793.53))}{1 + (15.811 + i(793.53))} = \\frac{-14.811 - i(793.53)}{16.811 + i(793.53)} $$\nThe reflected power fraction $\\mathcal{R}$ is the squared magnitude of $r$:\n$$ \\mathcal{R} = |r|^2 = \\frac{|-14.811 - i(793.53)|^2}{|16.811 + i(793.53)|^2} = \\frac{(-14.811)^2 + (-793.53)^2}{(16.811)^2 + (793.53)^2} $$\n$$ \\mathcal{R} = \\frac{219.366 + 629690}{282.608 + 629690} = \\frac{629909.366}{629972.608} \\approx 0.9998996 $$\nThe problem requires the answer to be rounded to four significant figures.\nThe calculated value is $0.9998996...$. The first four significant figures are $9, 9, 9, 8$. The fifth significant figure is $9$, which means we must round up the fourth digit.\n$$ \\mathcal{R} \\approx 0.9999 $$",
            "answer": "$$\\boxed{0.9999}$$"
        },
        {
            "introduction": "While idealized models often assume a uniform plasma, real-world systems feature strong gradients, particularly near material boundaries where sheaths form. This advanced computational exercise bridges the gap between analytic theory and numerical practice by calculating the effective penetration depth of a wave into an inhomogeneous plasma . Instead of a simple skin depth formula, you will implement a numerical integration to account for a spatially varying density profile. This task hones the skills necessary to adapt fundamental physical principles into robust computational tools for modeling realistic plasma-material interaction scenarios.",
            "id": "4029332",
            "problem": "Consider a one-dimensional, planar, semi-infinite cold electron plasma occupying all positions $x \\geq 0$, with a conducting wall at $x=0$. A thin, electron-depleted Radio Frequency (RF) sheath of thickness $s$ is present adjacent to the wall, such that the electron number density $n_e(x)$ is zero in the sheath and rises smoothly into the bulk plasma beyond the sheath. The plasma is driven harmonically at angular frequency $\\omega$ (time dependence $\\exp(-i \\omega t)$) with collisions characterized by a constant electron-neutral effective collision frequency $\\nu$. The aim is to compute an effective electromagnetic penetration depth that reflects collective behavior, plasma frequency, and skin effect near the RF sheath.\n\nStart from first principles appropriate to computational fusion science and engineering:\n- Maxwell’s equations in matter with a linear constitutive relation between current and electric field,\n- The linearized, cold electron fluid equation of motion including a friction term proportional to velocity,\n- The definition of electron-plasma frequency and its relation to collective charge response.\n\nFrom this base, infer the local complex electromagnetic response of the medium and the associated one-dimensional wave equation for a tangential electric field amplitude $E(x)$ that varies only in $x$ for $x \\geq 0$. The electron density profile models near-wall effects and sheath depletion as follows:\n$$\nn_e(x) = \n\\begin{cases}\n0,  0 \\le x  s, \\\\\nn_0\\left(1 - e^{-\\frac{x-s}{L_n}}\\right),  x \\ge s,\n\\end{cases}\n$$\nwhere $n_0$ is the asymptotic bulk electron number density and $L_n$ is the near-wall density scale length.\n\nLet the local electron-plasma frequency be defined by\n$$\n\\omega_p(x)^2 = \\frac{n_e(x) e^2}{\\varepsilon_0 m_e},\n$$\nwhere $e$ is the elementary charge, $m_e$ is the electron mass, and $\\varepsilon_0$ is the vacuum permittivity. Under the cold, linear, collisional electron fluid approximation, the medium’s local complex permittivity $\\varepsilon(x)$ and the corresponding local complex wavenumber $k(x)$ for a tangential electric field satisfy\n$$\n\\varepsilon(x) = \\varepsilon_0 \\,\\varepsilon_r(x), \\qquad \\varepsilon_r(x) \\in \\mathbb{C}, \\qquad \nk(x) = \\omega \\sqrt{\\mu_0 \\varepsilon(x)},\n$$\nwhere $\\mu_0$ is the vacuum permeability. The solution for the field amplitude in a slowly varying medium has the form of a local exponential with attenuation governed by the integral of the imaginary part of $k(x)$:\n$$\n|E(x)| \\propto \\exp\\left(-\\int_0^x \\operatorname{Im}\\{k(x')\\}\\,dx'\\right).\n$$\nDefine the effective penetration depth $\\ell_{\\text{eff}}$ as the smallest distance from the wall such that the amplitude has decayed by a factor of $e$, namely\n$$\n\\int_0^{\\ell_{\\text{eff}}} \\operatorname{Im}\\{k(x)\\}\\,dx = 1.\n$$\nIf the integral does not reach $1$ within a computational domain of size $X_{\\max}$, declare the penetration depth indeterminate within the domain and return the sentinel value $-1.0$.\n\nUse the following physical constants in the computation:\n- $e = 1.602\\,176\\,634\\times 10^{-19}\\,\\text{C}$,\n- $m_e = 9.109\\,383\\,7015\\times 10^{-31}\\,\\text{kg}$,\n- $\\varepsilon_0 = 8.854\\,187\\,817\\times 10^{-12}\\,\\text{F/m}$,\n- $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\text{H/m}$,\n- $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$.\n\nFor numerical computation, use a uniform grid in $x \\in [0, X_{\\max}]$ with step size $\\Delta x$ and assume $X_{\\max}$ is sufficiently large that the integral either reaches the target value $1$ or the sentinel condition is triggered. The algorithm must enforce the physically relevant branch of the complex square root such that $\\operatorname{Im}\\{k(x)\\} \\ge 0$ for attenuation (if a negative value arises from branch choice, flip the sign of $k(x)$).\n\nYour task is to implement a program that computes $\\ell_{\\text{eff}}$ for each case in the following test suite, expressing the final answers in meters and rounding each result to six significant figures:\n\nTest Suite (each case is $(n_0,\\ \\nu,\\ f,\\ L_n,\\ s)$ with $n_0$ in $\\text{m}^{-3}$, $\\nu$ in $\\text{s}^{-1}$, $f$ in $\\text{Hz}$, $L_n$ and $s$ in $\\text{m}$):\n1. $(5.0\\times 10^{18},\\ 5.0\\times 10^{7},\\ 13.56\\times 10^{6},\\ 2.0\\times 10^{-3},\\ 5.0\\times 10^{-4})$,\n2. $(5.0\\times 10^{18},\\ 5.0\\times 10^{7},\\ 13.56\\times 10^{6},\\ 2.0\\times 10^{-3},\\ 0.0)$,\n3. $(5.0\\times 10^{18},\\ 5.0\\times 10^{8},\\ 13.56\\times 10^{6},\\ 2.0\\times 10^{-3},\\ 5.0\\times 10^{-4})$,\n4. $(5.0\\times 10^{18},\\ 5.0\\times 10^{7},\\ 13.56\\times 10^{6},\\ 1.0\\times 10^{-4},\\ 5.0\\times 10^{-4})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$). Each entry must be a float in $\\text{m}$ rounded to six significant figures, with the sentinel $-1.0$ used where applicable.",
            "solution": "The problem requires the computation of an effective electromagnetic penetration depth, $\\ell_{\\text{eff}}$, into a semi-infinite, cold, collisional plasma with a spatially varying electron density profile. The solution is founded upon the principles of electromagnetism in continuous media and the fluid description of plasma.\n\nFirst, we must derive the local complex relative permittivity, $\\varepsilon_r(x)$, of the plasma. We begin with the linearized, cold electron fluid equation of motion in the presence of an oscillating electric field $\\vec{E}$ and a collisional drag force:\n$$\nm_e \\frac{\\partial \\vec{v}_e}{\\partial t} = -e\\vec{E} - m_e \\nu \\vec{v}_e\n$$\nHere, $m_e$ is the electron mass, $\\vec{v}_e$ is the electron fluid velocity, $-e$ is the electron charge, and $\\nu$ is the effective electron-neutral collision frequency. Assuming a harmonic time dependence of the form $e^{-i\\omega t}$ for all field and fluid quantities, the time derivative operator $\\frac{\\partial}{\\partial t}$ can be replaced by $-i\\omega$. The equation for the complex amplitudes becomes:\n$$\n-i\\omega m_e \\vec{v}_e = -e\\vec{E} - m_e \\nu \\vec{v}_e\n$$\nSolving for the electron velocity amplitude $\\vec{v}_e$ gives:\n$$\n(\\nu - i\\omega) m_e \\vec{v}_e = -e\\vec{E} \\implies \\vec{v}_e = -\\frac{e\\vec{E}}{m_e(\\nu - i\\omega)} = \\frac{e\\vec{E}}{m_e(i\\omega - \\nu)}\n$$\nThe plasma current density, $\\vec{J}$, is carried by the moving electrons, and its amplitude is given by $\\vec{J} = -n_e(x) e \\vec{v}_e$, where $n_e(x)$ is the position-dependent electron number density. Substituting the expression for $\\vec{v}_e$:\n$$\n\\vec{J}(x) = -n_e(x) e \\left( \\frac{e\\vec{E}}{m_e(i\\omega - \\nu)} \\right) = \\frac{-n_e(x) e^2}{m_e(i\\omega - \\nu)} \\vec{E}\n$$\nThis establishes a linear constitutive relation of the form $\\vec{J} = \\sigma \\vec{E}$, where $\\sigma$ is the complex conductivity of the plasma:\n$$\n\\sigma(x) = \\frac{-n_e(x) e^2}{m_e(i\\omega - \\nu)} = \\frac{n_e(x) e^2}{m_e(\\nu - i\\omega)} = \\frac{n_e(x) e^2 (\\nu + i\\omega)}{m_e(\\nu^2 + \\omega^2)}\n$$\nTo find the complex permittivity, we use Ampere's law, $\\nabla \\times \\vec{H} = \\vec{J} + \\frac{\\partial \\vec{D}}{\\partial t}$. With the assumed time dependence and $\\vec{D} = \\varepsilon_0 \\vec{E}$ for the vacuum contribution, this becomes:\n$$\n\\nabla \\times \\vec{H} = \\vec{J} - i\\omega\\varepsilon_0 \\vec{E} = (\\sigma(x) - i\\omega\\varepsilon_0) \\vec{E}\n$$\nWe define the complex permittivity $\\varepsilon(x)$ such that $\\nabla \\times \\vec{H} = -i\\omega\\varepsilon(x)\\vec{E}$. Comparing the two expressions, we get:\n$$\n-i\\omega\\varepsilon(x) = \\sigma(x) - i\\omega\\varepsilon_0 \\implies \\varepsilon(x) = \\varepsilon_0 + \\frac{\\sigma(x)}{i\\omega}\n$$\nSubstituting the expression for $\\sigma(x)$:\n$$\n\\varepsilon(x) = \\varepsilon_0 + \\frac{n_e(x) e^2}{i\\omega m_e(\\nu - i\\omega)} = \\varepsilon_0 - \\frac{n_e(x) e^2}{\\omega m_e(\\omega + i\\nu)}\n$$\nFactoring out $\\varepsilon_0$ and using the definition of the local electron-plasma frequency, $\\omega_p(x)^2 = \\frac{n_e(x) e^2}{\\varepsilon_0 m_e}$, we arrive at the expression for the local complex relative permittivity $\\varepsilon_r(x) = \\varepsilon(x)/\\varepsilon_0$:\n$$\n\\varepsilon_r(x) = 1 - \\frac{\\omega_p(x)^2}{\\omega(\\omega + i\\nu)}\n$$\nThe problem specifies a tangential electric field, for which the one-dimensional wave equation yields a local complex wavenumber $k(x)$ given by:\n$$\nk(x) = \\omega \\sqrt{\\mu_0 \\varepsilon(x)} = \\omega \\sqrt{\\mu_0 \\varepsilon_0 \\varepsilon_r(x)} = \\frac{\\omega}{c} \\sqrt{\\varepsilon_r(x)}\n$$\nwhere $c=1/\\sqrt{\\mu_0 \\varepsilon_0}$ is the speed of light in vacuum. To find the attenuation, we must compute $\\operatorname{Im}\\{k(x)\\}$. Let's first separate $\\varepsilon_r(x)$ into its real and imaginary parts.\n$$\n\\varepsilon_r(x) = 1 - \\frac{\\omega_p(x)^2(\\omega - i\\nu)}{\\omega(\\omega^2 + \\nu^2)} = \\left(1 - \\frac{\\omega_p(x)^2}{\\omega^2 + \\nu^2}\\right) + i \\left(\\frac{\\nu}{\\omega} \\frac{\\omega_p(x)^2}{\\omega^2 + \\nu^2}\\right)\n$$\nLet's denote $\\varepsilon_r(x) = A(x) + iB(x)$, where $A(x) = 1 - \\frac{\\omega_p(x)^2}{\\omega^2 + \\nu^2}$ and $B(x) = \\frac{\\nu}{\\omega} \\frac{\\omega_p(x)^2}{\\omega^2 + \\nu^2}$. We need to compute $\\sqrt{A+iB}$. Let this be $u+iv$. Then $u^2-v^2 = A$ and $u^2+v^2 = \\sqrt{A^2+B^2}$. Solving for $v^2$ gives $2v^2 = \\sqrt{A^2+B^2} - A$. The imaginary part of the square root is $v = \\operatorname{sgn}(B) \\sqrt{(\\sqrt{A^2+B^2}-A)/2}$. Since $\\nu, \\omega,$ and $\\omega_p^2$ are non-negative, $B(x) \\geq 0$, so we take the positive root.\n$$\n\\operatorname{Im}\\{\\sqrt{\\varepsilon_r(x)}\\} = \\sqrt{\\frac{\\sqrt{A(x)^2 + B(x)^2} - A(x)}{2}}\n$$\nThus, the imaginary part of the local wavenumber is:\n$$\n\\operatorname{Im}\\{k(x)\\} = \\frac{\\omega}{c} \\sqrt{\\frac{\\sqrt{A(x)^2 + B(x)^2} - A(x)}{2}}\n$$\nThe electron density profile is given by:\n$$\nn_e(x) = \n\\begin{cases}\n0,  0 \\le x  s, \\\\\nn_0\\left(1 - e^{-\\frac{x-s}{L_n}}\\right),  x \\ge s,\n\\end{cases}\n$$\nIn the sheath region ($0 \\le x  s$), $n_e(x)=0$, which implies $\\omega_p(x)^2=0$. This leads to $A(x)=1, B(x)=0$, resulting in $\\operatorname{Im}\\{k(x)\\} = 0$. So, attenuation only begins for $x \\geq s$.\n\nThe effective penetration depth $\\ell_{\\text{eff}}$ is defined by the integral equation:\n$$\n\\int_0^{\\ell_{\\text{eff}}} \\operatorname{Im}\\{k(x)\\}\\,dx' = 1\n$$\nSince $\\operatorname{Im}\\{k(x)\\}=0$ for $x  s$, the integral is equivalent to $\\int_s^{\\ell_{\\text{eff}}} \\operatorname{Im}\\{k(x)\\}\\,dx' = 1$. To solve this for $\\ell_{\\text{eff}}$, we employ a numerical integration algorithm. We discretize the spatial domain $x \\ge 0$ into small steps of size $\\Delta x$. We then compute the cumulative integral $I(x) = \\int_0^x \\operatorname{Im}\\{k(x')\\}\\,dx'$ iteratively using the trapezoidal rule:\n$$\nI(x_i) = I(x_{i-1}) + \\frac{\\operatorname{Im}\\{k(x_{i-1})\\} + \\operatorname{Im}\\{k(x_i)\\}}{2} \\Delta x\n$$\nstarting with $I(0)=0$. We march forward in $x$, calculating $I(x_i)$ at each step $x_i = i\\Delta x$. When we find an interval $[x_{i-1}, x_i]$ such that $I(x_{i-1})  1$ and $I(x_i) \\geq 1$, we know that $\\ell_{\\text{eff}}$ lies within this interval. We then use linear interpolation to find a more precise value:\n$$\n\\ell_{\\text{eff}} = x_{i-1} + \\Delta x \\frac{1 - I(x_{i-1})}{I(x_i) - I(x_{i-1})}\n$$\nA sufficiently large computational domain $X_{\\max}$ and a small step size $\\Delta x$ are chosen to ensure accuracy. If the integral does not reach $1$ by $x=X_{\\max}$, we conclude the penetration depth is indeterminate within the domain and report the sentinel value $-1.0$. The prescribed physical constants and test case parameters are used to perform the calculation for each case.",
            "answer": "```python\nimport numpy as np\nfrom math import log10, floor\nimport sys\n\ndef solve():\n    \"\"\"\n    Computes the effective electromagnetic penetration depth in a semi-infinite\n    plasma with a near-wall sheath and density gradient.\n    \"\"\"\n    # Physical constants (SI units)\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kg\n    EPS_0 = 8.854187817e-12     # Vacuum permittivity in F/m\n    MU_0 = 4 * np.pi * 1.0e-7   # Vacuum permeability in H/m\n    C_LIGHT = 1.0 / np.sqrt(EPS_0 * MU_0) # Speed of light in m/s\n\n    test_cases = [\n        (5.0e18, 5.0e7, 13.56e6, 2.0e-3, 5.0e-4),\n        (5.0e18, 5.0e7, 13.56e6, 2.0e-3, 0.0),\n        (5.0e18, 5.0e8, 13.56e6, 2.0e-3, 5.0e-4),\n        (5.0e18, 5.0e7, 13.56e6, 1.0e-4, 5.0e-4),\n    ]\n\n    results = []\n\n    # Numerical parameters for integration\n    X_max = 0.05  # m, computational domain size\n    num_steps = 50000\n    dx = X_max / num_steps\n\n    def round_sig(x, sig=6):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return round(x, sig - int(floor(log10(abs(x)))) - 1)\n\n    for case in test_cases:\n        n0, nu, f, Ln, s = case\n        \n        omega = 2 * np.pi * f\n\n        def get_imag_k(x_val):\n            \"\"\"Computes the imaginary part of the wavenumber k at position x.\"\"\"\n            if x_val  s:\n                return 0.0\n            \n            # Electron density at x\n            ne_x = n0 * (1.0 - np.exp(-(x_val - s) / Ln))\n            \n            if ne_x == 0:\n                return 0.0\n            \n            # Squared plasma frequency at x\n            wp_sq = (ne_x * E_CHARGE**2) / (EPS_0 * M_ELECTRON)\n            \n            # Real and imaginary parts of the relative permittivity\n            denom_real = omega**2 + nu**2\n            A = 1.0 - wp_sq / denom_real\n            B = (nu / omega) * wp_sq / denom_real\n            \n            # Imaginary part of sqrt(epsilon_r)\n            sqrt_A_sq_B_sq = np.sqrt(A**2 + B**2)\n            # The term inside the square root is guaranteed to be non-negative\n            imag_sqrt_eps_r = np.sqrt(0.5 * (sqrt_A_sq_B_sq - A))\n            \n            # Imaginary part of the wavenumber\n            k_imag = (omega / C_LIGHT) * imag_sqrt_eps_r\n            \n            # Per problem spec, ensure imag(k) = 0. Our formula naturally satisfies this.\n            return k_imag\n            \n        integral_val = 0.0\n        prev_imag_k = 0.0 # Im{k(0)} is 0\n        l_eff = -1.0\n        \n        for i in range(1, num_steps + 1):\n            x_current = i * dx\n            current_imag_k = get_imag_k(x_current)\n            \n            # Trapezoidal rule for integration increment\n            integral_increment = 0.5 * (current_imag_k + prev_imag_k) * dx\n            new_integral_val = integral_val + integral_increment\n            \n            if integral_val  1.0 and new_integral_val = 1.0:\n                # Target value 1 is crossed in this step. Interpolate to find l_eff.\n                x_prev = (i - 1) * dx\n                l_eff = x_prev + dx * (1.0 - integral_val) / (new_integral_val - integral_val)\n                break\n                \n            integral_val = new_integral_val\n            prev_imag_k = current_imag_k\n\n        if l_eff != -1.0:\n            results.append(str(round_sig(l_eff, 6)))\n        else:\n            results.append(str(-1.0))\n\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solver function\nsolve()\n```"
        }
    ]
}