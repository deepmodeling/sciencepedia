{
    "hands_on_practices": [
        {
            "introduction": "为了将抽象的动理学方程与可观测的宏观现象联系起来，第一个练习将探讨一个核心的物理过程。通过使用在磁化等离子体中描述碰撞的常用模型——倾角散射算符，你将推导压力各向异性 $A(t) = P_{\\parallel}(t) - P_{\\perp}(t)$ 是如何随时间演化的。这项实践提供了一个亲身实践的机会，让你了解微观相互作用如何驱动等离子体趋向于更均匀（各向同性）的状态，这是理解聚变等离子体中输运和稳定性的关键一步 ()。",
            "id": "4014780",
            "problem": "考虑一个空间均匀的磁化等离子体，其回旋各向同性离子分布函数为 $f(v,\\xi,t)$，其中 $v = |\\boldsymbol{v}|$ 是速率，$\\xi = \\cos\\theta = v_{\\parallel}/v$ 是相对于磁场方向的投掷角余弦。其时间演化仅由一个洛伦兹类型的投掷角散射算子决定，\n$$\n\\frac{\\partial f}{\\partial t} = C[f], \\quad C[f] = \\frac{\\nu_{p}}{2}\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f}{\\partial \\xi}\\right],\n$$\n其中 $\\nu_{p}$ 是一个与 $v$ 和 $t$ 无关的常数偏转频率。假设 $f$ 具有足够的光滑性，使得在 $\\xi=\\pm 1$ 处的所有边界项都为零，并且当 $v\\to\\infty$ 时，$f$ 足够快地衰减。\n\n定义平行和垂直压强（垂直压强按每个方向计算）为\n$$\nP_{\\parallel}(t) = m \\int v^{2}\\,\\xi^{2}\\,f\\,d^{3}v, \\qquad P_{\\perp}(t) = \\frac{m}{2} \\int v^{2}\\,(1-\\xi^{2})\\,f\\,d^{3}v,\n$$\n以及标量压强 $p(t) = \\left(P_{\\parallel} + 2 P_{\\perp}\\right)/3$。这里 $m$ 是离子质量，$d^{3}v = v^{2}\\,dv\\,d\\Omega$，其中 $d\\Omega$ 是立体角元。\n\n从动理学方程和上述定义出发，仅使用角向积分的基本性质、投掷角散射下的守恒性以及标准微积分（例如，分部积分法）来：\n- 推导仅由碰撞引起的关于 $\\dot{P}_{\\parallel}$ 和 $\\dot{P}_{\\perp}$ 的矩方程，用 $P_{\\parallel}$ 和 $P_{\\perp}$ 表示，并验证 $\\dot{p}=0$。\n- 证明压强各向异性 $A(t) \\equiv P_{\\parallel}(t) - P_{\\perp}(t)$ 呈指数形式弛豫，即 $\\dot{A} = -\\gamma_{\\mathrm{iso}}\\,A$，其中 $\\gamma_{\\mathrm{iso}}$ 是一个常数各向同性化率。\n\n你的最终答案应该是关于各向同性化率 $\\gamma_{\\mathrm{iso}}$ 的、用 $\\nu_{p}$ 表示的闭式解析表达式。不要计算任何数值。如果将 $\\nu_{p}$ 的单位解释为逆秒，则最终的率以逆秒为单位表示。最终答案必须是单个解析表达式。",
            "solution": "用户提供的问题已经过分析，并被认为是**有效的**。该问题在等离子体动理学理论中有科学依据，是适定的，并且包含了获得唯一解所需的所有信息。推导过程如下。\n\n我们的目标是求出压强各向异性 $A(t) = P_{\\parallel}(t) - P_{\\perp}(t)$ 的各向同性化率 $\\gamma_{\\mathrm{iso}}$。这需要推导平行压强 $P_{\\parallel}$ 和垂直压强 $P_{\\perp}$ 的时间演化方程。\n\n首先，我们考虑平行压强 $P_{\\parallel}(t) = m \\int v^{2}\\,\\xi^{2}\\,f\\,d^{3}v$ 的时间导数。由于速度空间中的积分体积是固定的，导数作用于分布函数 $f$：\n$$\n\\dot{P}_{\\parallel} = \\frac{d P_{\\parallel}}{dt} = m \\int v^{2}\\,\\xi^{2}\\,\\frac{\\partial f}{\\partial t}\\,d^{3}v\n$$\n我们代入动理学方程 $\\frac{\\partial f}{\\partial t} = C[f]$：\n$$\n\\dot{P}_{\\parallel} = m \\int v^{2}\\,\\xi^{2}\\,C[f]\\,d^{3}v\n$$\n对于回旋各向同性分布函数，速度空间体积元为 $d^{3}v = 2\\pi v^{2}\\,dv\\,d\\xi$。代入此式以及碰撞算子 $C[f]$ 的表达式，得到：\n$$\n\\dot{P}_{\\parallel} = m \\int_{0}^{\\infty} 2\\pi v^{4}\\,dv \\int_{-1}^{1} \\xi^{2} \\left( \\frac{\\nu_{p}}{2}\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f}{\\partial \\xi}\\right] \\right) d\\xi\n$$\n我们关注对投掷角余弦 $\\xi$ 的积分：\n$$\nI_{\\parallel} = \\int_{-1}^{1} \\xi^{2} \\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f}{\\partial \\xi}\\right] d\\xi\n$$\n我们使用分部积分法，令 $u=\\xi^{2}$ 且 $dv = \\frac{\\partial}{\\partial \\xi}(...)\\,d\\xi$。这得到 $du=2\\xi\\,d\\xi$ 且 $v = (1-\\xi^{2})\\frac{\\partial f}{\\partial \\xi}$。\n$$\nI_{\\parallel} = \\left[ \\xi^{2}(1-\\xi^{2})\\frac{\\partial f}{\\partial \\xi} \\right]_{-1}^{1} - \\int_{-1}^{1} 2\\xi (1-\\xi^{2})\\frac{\\partial f}{\\partial \\xi} d\\xi\n$$\n由于因子 $(1-\\xi^{2})$ 在 $\\xi=\\pm 1$ 处为零，边界项消失。我们得到：\n$$\nI_{\\parallel} = -2\\int_{-1}^{1} (\\xi-\\xi^{3})\\frac{\\partial f}{\\partial \\xi} d\\xi\n$$\n我们第二次使用分部积分法，令 $u = \\xi-\\xi^{3}$ 且 $dv = \\frac{\\partial f}{\\partial \\xi}d\\xi$。这得到 $du=(1-3\\xi^{2})d\\xi$ 且 $v=f$。\n$$\nI_{\\parallel} = -2 \\left( \\left[ (\\xi - \\xi^{3})f \\right]_{-1}^{1} - \\int_{-1}^{1} (1-3\\xi^{2})f d\\xi \\right)\n$$\n边界项再次消失。这简化为：\n$$\nI_{\\parallel} = 2 \\int_{-1}^{1} (1-3\\xi^{2})f d\\xi = 2 \\int_{-1}^{1} f d\\xi - 6 \\int_{-1}^{1} \\xi^{2} f d\\xi\n$$\n将此结果代回到 $\\dot{P}_{\\parallel}$ 的表达式中：\n$$\n\\dot{P}_{\\parallel} = m \\int_{0}^{\\infty} 2\\pi v^{4}\\,dv \\left( \\frac{\\nu_{p}}{2} \\left[ 2 \\int_{-1}^{1} f d\\xi - 6 \\int_{-1}^{1} \\xi^{2} f d\\xi \\right] \\right)\n$$\n$$\n\\dot{P}_{\\parallel} = \\nu_{p} \\left( m \\int 2\\pi v^{4} f dv d\\xi - 3m \\int 2\\pi v^{4} \\xi^{2} f dv d\\xi \\right)\n$$\n我们将这些积分与压强矩联系起来。第二项就是 $3P_{\\parallel}$。对于第一项，我们回顾标量压强 $p = (P_{\\parallel} + 2P_{\\perp})/3$ 的定义：\n$$\np = \\frac{1}{3} \\left( m \\int v^{2}\\xi^{2} f d^{3}v + 2\\frac{m}{2} \\int v^{2}(1-\\xi^{2}) f d^{3}v \\right) = \\frac{m}{3} \\int v^{2} f d^{3}v\n$$\n因此，$3p = m \\int v^{2} f d^{3}v = m \\int 2\\pi v^{4} f dv d\\xi$。通过这些识别，我们找到了 $\\dot{P}_{\\parallel}$ 的矩方程：\n$$\n\\dot{P}_{\\parallel} = \\nu_{p} (3p - 3P_{\\parallel}) = 3\\nu_{p}(p-P_{\\parallel})\n$$\n代入 $p = (P_{\\parallel}+2P_{\\perp})/3$：\n$$\n\\dot{P}_{\\parallel} = 3\\nu_{p}\\left(\\frac{P_{\\parallel}+2P_{\\perp}}{3} - P_{\\parallel}\\right) = \\nu_{p}(P_{\\parallel}+2P_{\\perp}-3P_{\\parallel}) = -2\\nu_{p}(P_{\\parallel}-P_{\\perp})\n$$\n接下来，我们推导 $\\dot{P}_{\\perp}(t) = \\frac{m}{2} \\int v^{2}\\,(1-\\xi^{2})\\,f\\,d^{3}v$ 的方程：\n$$\n\\dot{P}_{\\perp} = \\frac{m}{2} \\int v^{2}(1-\\xi^{2}) C[f] d^{3}v = \\frac{m}{2} \\int_{0}^{\\infty} 2\\pi v^{4} dv \\int_{-1}^{1} (1-\\xi^{2}) \\frac{\\nu_{p}}{2} \\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f}{\\partial \\xi}\\right] d\\xi\n$$\n对 $\\xi$ 的积分为 $I_{\\perp} = \\int_{-1}^{1} (1-\\xi^{2}) \\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f}{\\partial \\xi}\\right] d\\xi$。使用分部积分法，令 $u=1-\\xi^2$ 且 $dv = \\frac{\\partial}{\\partial \\xi}(...)d\\xi$：\n$$\nI_{\\perp} = \\left[ (1-\\xi^{2})^{2}\\frac{\\partial f}{\\partial \\xi} \\right]_{-1}^{1} - \\int_{-1}^{1} (-2\\xi) (1-\\xi^{2})\\frac{\\partial f}{\\partial \\xi} d\\xi = 2 \\int_{-1}^{1} \\xi (1-\\xi^{2}) \\frac{\\partial f}{\\partial \\xi} d\\xi\n$$\n这恰好是在计算 $\\dot{P}_{\\parallel}$ 过程中遇到的相应积分的负值。因此，$I_{\\perp} = -I_{\\parallel} = -2 \\int_{-1}^{1} (1-3\\xi^{2})f d\\xi$。将此代回：\n$$\n\\dot{P}_{\\perp} = \\frac{m\\nu_{p}}{4} \\int 2\\pi v^{4} dv \\left( -2 \\int_{-1}^{1} (1-3\\xi^{2})f d\\xi \\right) = -\\frac{\\nu_{p}}{2} (3p-3P_{\\parallel}) = -\\frac{3\\nu_{p}}{2}(p-P_{\\parallel})\n$$\n代入 $p-P_{\\parallel} = -\\frac{2}{3}(P_{\\parallel}-P_{\\perp})$：\n$$\n\\dot{P}_{\\perp} = -\\frac{3\\nu_{p}}{2}\\left(-\\frac{2}{3}(P_{\\parallel}-P_{\\perp})\\right) = \\nu_{p}(P_{\\parallel}-P_{\\perp})\n$$\n推导出的矩方程为：\n$$\n\\dot{P}_{\\parallel} = -2\\nu_{p}(P_{\\parallel}-P_{\\perp}) \\quad \\text{和} \\quad \\dot{P}_{\\perp} = \\nu_{p}(P_{\\parallel}-P_{\\perp})\n$$\n作为验证，我们检查标量压强 $p$ 的演化：\n$$\n\\dot{p} = \\frac{1}{3}(\\dot{P}_{\\parallel} + 2\\dot{P}_{\\perp}) = \\frac{1}{3} \\left[ -2\\nu_{p}(P_{\\parallel}-P_{\\perp}) + 2\\nu_{p}(P_{\\parallel}-P_{\\perp}) \\right] = 0\n$$\n这证实了标量压强（以及总动能）在投掷角散射下是守恒的，与预期相符。\n\n最后，我们求出压强各向异性 $A = P_{\\parallel}-P_{\\perp}$ 的演化：\n$$\n\\dot{A} = \\dot{P}_{\\parallel} - \\dot{P}_{\\perp} = \\left[-2\\nu_{p}(P_{\\parallel}-P_{\\perp})\\right] - \\left[\\nu_{p}(P_{\\parallel}-P_{\\perp})\\right]\n$$\n$$\n\\dot{A} = -3\\nu_{p}(P_{\\parallel}-P_{\\perp}) = -3\\nu_{p}A\n$$\n这就是所要求的指数弛豫方程 $\\dot{A} = -\\gamma_{\\mathrm{iso}}A$。通过直接比较，我们确定了各向同性化率 $\\gamma_{\\mathrm{iso}}$。",
            "answer": "$$\\boxed{3\\nu_{p}}$$"
        },
        {
            "introduction": "计算等离子体物理学不仅需要理解物理模型，还需要评估用于求解这些模型的数值方法的准确性。本练习将引导你分析一个核心的计算问题：在计算机上对分布函数进行离散化求矩时，会引入多大的数值误差？你将通过解析推导，研究在均匀网格上计算数密度时产生的求积误差 ()，并揭示该误差如何依赖于网格分辨率以及等离子体的物理特性。",
            "id": "4014748",
            "problem": "考虑磁化聚变等离子体中的单一离子种类，其速度分布函数 $f(\\mathbf{v})$ 在一个均匀的笛卡尔速度网格上进行采样，网格在每个方向上的间距均为 $\\Delta$，即网格点为 $\\mathbf{v}_{ijk} = (i \\Delta, j \\Delta, k \\Delta)$，其中 $i,j,k$ 为整数。数密度 $n$ 定义为速度空间积分 $n = \\int_{\\mathbb{R}^3} f(\\mathbf{v}) \\,\\mathrm{d}^3 v$。在离散速度方法中，$n$ 的一个估计量由无穷均匀黎曼和构成\n$$\nn_{\\Delta} \\equiv \\sum_{i=-\\infty}^{\\infty} \\sum_{j=-\\infty}^{\\infty} \\sum_{k=-\\infty}^{\\infty} f_{ijk} \\,\\Delta^3,\n$$\n其中 $f_{ijk} \\equiv f(i\\Delta, j\\Delta, k\\Delta)$。\n\n(a) 将此离散速度空间估计量如上式显式写出，并陈述相对求积误差 $E(\\Delta) \\equiv \\frac{n_{\\Delta} - n}{n}$。\n\n(b) 现在，针对聚变等离子体中两种物理上重要的情形来分析 $E(\\Delta)$：\n- 各向同性麦克斯韦分布\n$$\nf_{\\mathrm{iso}}(\\mathbf{v}) = n_{0} \\left(\\frac{m}{2 \\pi k_{B} T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m |\\mathbf{v}|^{2}}{2 k_{B} T}\\right),\n$$\n其质量为 $m$，数密度为 $n_{0}$，温度为 $T$。\n- 与磁场（取为沿 $z$ 轴方向）对齐的轴对称双麦克斯韦分布，\n$$\nf_{\\mathrm{aniso}}(\\mathbf{v}) = n_{0} \\left(\\frac{m}{2 \\pi k_{B} T_{\\perp}}\\right)\\left(\\frac{m}{2 \\pi k_{B} T_{\\parallel}}\\right)^{1/2} \\exp\\!\\left(-\\frac{m (v_{x}^{2} + v_{y}^{2})}{2 k_{B} T_{\\perp}} - \\frac{m v_{z}^{2}}{2 k_{B} T_{\\parallel}}\\right),\n$$\n其垂直温度和和平行温度分别为 $T_{\\perp}$ 和 $T_{\\parallel}$。\n\n假设采用上述的无穷均匀网格求和（即，忽略在有限速度边界处的截断），并仅使用物理上经过充分检验的数学事实来估计当 $\\Delta \\to 0$ 时 $E(\\Delta)$ 的领头阶行为。具体而言，从泊松求和的观点来考虑均匀三维梯形/中点求积误差，并只保留来自六个最小的非零倒易晶格矢量的贡献。推导领头阶相对误差 $E_{\\mathrm{iso}}(\\Delta)$ 和 $E_{\\mathrm{aniso}}(\\Delta)$ 的闭式解析表达式，用 $m$、$k_{B}$、$T$、$T_{\\perp}$、$T_{\\parallel}$ 和 $\\Delta$ 表示。\n\n以包含 $E_{\\mathrm{iso}}(\\Delta)$ 和 $E_{\\mathrm{aniso}}(\\Delta)$（按此顺序）的单行矩阵形式给出你的最终答案。无需进行数值计算。如果引入任何角度量，请用弧度表示。最终方框内的表达式中不应出现单位。",
            "solution": "我们从数密度的定义，即速度空间积分，\n$$\nn \\equiv \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}) \\,\\mathrm{d}^{3} v,\n$$\n及其在间距为 $\\Delta$ 的均匀笛卡尔网格上的离散速度空间估计量开始，\n$$\nn_{\\Delta} \\equiv \\sum_{i=-\\infty}^{\\infty} \\sum_{j=-\\infty}^{\\infty} \\sum_{k=-\\infty}^{\\infty} f(i\\Delta, j\\Delta, k\\Delta)\\,\\Delta^{3}.\n$$\n相对求积误差为\n$$\nE(\\Delta) \\equiv \\frac{n_{\\Delta} - n}{n}.\n$$\n\n为分析在各速度分量上可分离的高斯分布的 $E(\\Delta)$，我们使用泊松求和公式，这是一个用于理解光滑、快速衰减函数在均匀梯形/中点求积下误差的经过充分检验的工具。在一维情况下，对于一个函数 $g(v)$，其傅里叶变换为 $\\hat g(\\omega) \\equiv \\int_{-\\infty}^{\\infty} g(v)\\,\\exp(-\\mathrm{i}\\,\\omega v)\\,\\mathrm{d}v$，泊松求和公式表述为\n$$\n\\Delta \\sum_{n=-\\infty}^{\\infty} g(n\\Delta) = \\sum_{k=-\\infty}^{\\infty} \\hat g\\!\\left(\\frac{2\\pi k}{\\Delta}\\right).\n$$\n对于高斯函数 $g(v)=C \\exp(-a v^{2})$（其中 $a>0$），我们有其精确的傅里叶变换\n$$\n\\hat g(\\omega) = C \\sqrt{\\frac{\\pi}{a}}\\;\\exp\\!\\left(-\\frac{\\omega^{2}}{4 a}\\right).\n$$\n因此，在一维情况下，\n$$\n\\Delta \\sum_{n=-\\infty}^{\\infty} g(n\\Delta) = C \\sqrt{\\frac{\\pi}{a}} \\sum_{k=-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{\\pi^{2} k^{2}}{a \\Delta^{2}}\\right).\n$$\n除以精确积分 $I_{1\\mathrm{D}}=\\int g = C \\sqrt{\\pi/a}$，相对误差为\n$$\n\\frac{\\Delta \\sum_{n} g(n\\Delta) - I_{1\\mathrm{D}}}{I_{1\\mathrm{D}}} = \\sum_{k \\neq 0} \\exp\\!\\left(-\\frac{\\pi^{2} k^{2}}{a \\Delta^{2}}\\right) = 2 \\sum_{k=1}^{\\infty} \\exp\\!\\left(-\\frac{\\pi^{2} k^{2}}{a \\Delta^{2}}\\right).\n$$\n对于小的 $\\Delta$（细网格），领头贡献来自 $k=\\pm 1$ 对，因此\n$$\nE_{1\\mathrm{D}}(\\Delta) \\sim 2 \\exp\\!\\left(-\\frac{\\pi^{2}}{a \\Delta^{2}}\\right) \\quad \\text{当 } \\Delta \\to 0.\n$$\n\n在三维情况下，对于一个可分离的高斯函数 $f(\\mathbf{v}) = C \\exp(-a_{x} v_{x}^{2} - a_{y} v_{y}^{2} - a_{z} v_{z}^{2})$，三维变换可以因子分解，泊松求和得出\n$$\nn_{\\Delta} = \\Delta^{3} \\sum_{i,j,k} f(i\\Delta, j\\Delta, k\\Delta) = C \\frac{\\pi^{3/2}}{\\sqrt{a_{x} a_{y} a_{z}}} \\prod_{d \\in \\{x,y,z\\}} \\left[\\sum_{k_{d}=-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{\\pi^{2} k_{d}^{2}}{a_{d} \\Delta^{2}}\\right)\\right].\n$$\n精确积分为 $n = \\int f = C \\pi^{3/2}/\\sqrt{a_{x} a_{y} a_{z}}$，因此相对误差为\n$$\nE(\\Delta) = \\frac{n_{\\Delta} - n}{n} = \\prod_{d \\in \\{x,y,z\\}} \\left[\\sum_{k_{d}=-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{\\pi^{2} k_{d}^{2}}{a_{d} \\Delta^{2}}\\right)\\right] - 1.\n$$\n展开此乘积并仅保留最小量级的倒易晶格贡献，即六个其中一个分量等于 $\\pm 1$ 而其他分量为零的矢量，我们得到领头阶行为\n$$\nE(\\Delta) \\sim 2 \\left[\\exp\\!\\left(-\\frac{\\pi^{2}}{a_{x} \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{\\pi^{2}}{a_{y} \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{\\pi^{2}}{a_{z} \\Delta^{2}}\\right)\\right],\n$$\n因为每个坐标轴贡献了一对 $k_{d}=\\pm 1$（所有其他分量为零）。\n\n现在我们具体到两种等离子体分布。\n\n各向同性麦克斯韦分布。对于\n$$\nf_{\\mathrm{iso}}(\\mathbf{v}) = n_{0} \\left(\\frac{m}{2 \\pi k_{B} T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m (v_{x}^{2} + v_{y}^{2} + v_{z}^{2})}{2 k_{B} T}\\right),\n$$\n我们识别出 $a_{x}=a_{y}=a_{z}=a$，其中\n$$\na \\equiv \\frac{m}{2 k_{B} T}.\n$$\n因此，领头阶相对误差为\n$$\nE_{\\mathrm{iso}}(\\Delta) \\sim 2 \\left[ \\exp\\!\\left(-\\frac{\\pi^{2}}{a \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{\\pi^{2}}{a \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{\\pi^{2}}{a \\Delta^{2}}\\right) \\right] = 6 \\exp\\!\\left(-\\frac{\\pi^{2}}{a \\Delta^{2}}\\right).\n$$\n代入 $a=m/(2 k_{B} T)$ 得到以温度表示的形式\n$$\nE_{\\mathrm{iso}}(\\Delta) \\sim 6 \\exp\\!\\left(-\\frac{2 \\pi^{2} k_{B} T}{m \\Delta^{2}}\\right).\n$$\n\n各向异性双麦克斯韦分布。对于\n$$\nf_{\\mathrm{aniso}}(\\mathbf{v}) = n_{0} \\left(\\frac{m}{2 \\pi k_{B} T_{\\perp}}\\right)\\left(\\frac{m}{2 \\pi k_{B} T_{\\parallel}}\\right)^{1/2} \\exp\\!\\left(-\\frac{m (v_{x}^{2} + v_{y}^{2})}{2 k_{B} T_{\\perp}} - \\frac{m v_{z}^{2}}{2 k_{B} T_{\\parallel}}\\right),\n$$\n我们识别出\n$$\na_{x}=a_{y}=\\frac{m}{2 k_{B} T_{\\perp}}, \\qquad a_{z}=\\frac{m}{2 k_{B} T_{\\parallel}}.\n$$\n因此，领头阶相对误差变为\n$$\nE_{\\mathrm{aniso}}(\\Delta) \\sim 2 \\left[ \\exp\\!\\left(-\\frac{\\pi^{2}}{a_{x} \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{\\pi^{2}}{a_{y} \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{\\pi^{2}}{a_{z} \\Delta^{2}}\\right) \\right].\n$$\n使用 $a_{x}=a_{y}=m/(2 k_{B} T_{\\perp})$ 和 $a_{z}=m/(2 k_{B} T_{\\parallel})$，我们有\n$$\nE_{\\mathrm{aniso}}(\\Delta) \\sim 2 \\left[ \\exp\\!\\left(-\\frac{2 \\pi^{2} k_{B} T_{\\perp}}{m \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{2 \\pi^{2} k_{B} T_{\\perp}}{m \\Delta^{2}}\\right) + \\exp\\!\\left(-\\frac{2 \\pi^{2} k_{B} T_{\\parallel}}{m \\Delta^{2}}\\right) \\right],\n$$\n可以简化为\n$$\nE_{\\mathrm{aniso}}(\\Delta) \\sim 4 \\exp\\!\\left(-\\frac{2 \\pi^{2} k_{B} T_{\\perp}}{m \\Delta^{2}}\\right) + 2 \\exp\\!\\left(-\\frac{2 \\pi^{2} k_{B} T_{\\parallel}}{m \\Delta^{2}}\\right).\n$$\n\n这些表达式给出了在各向同性和各向异性麦克斯韦分布的速度空间密度矩上应用无穷均匀网格梯形/中点法则时的领头阶相对求积误差，其中只保留了六个最小的非零倒易晶格贡献。它们依赖于网格间距 $\\Delta$、质量 $m$、玻尔兹曼常数 $k_{B}$ 以及相应的温度。高阶修正是指数级更小的，涉及具有两个或三个非零分量和更高整数值的矢量，而在有限速度边界处的截断会为麦克斯韦分布增加独立的、同样是指数级小的尾部贡献，这些贡献可以独立分析。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n6\\,\\exp\\!\\left(-\\dfrac{2 \\pi^{2} k_{B} T}{m \\Delta^{2}}\\right) & 4\\,\\exp\\!\\left(-\\dfrac{2 \\pi^{2} k_{B} T_{\\perp}}{m \\Delta^{2}}\\right) + 2\\,\\exp\\!\\left(-\\dfrac{2 \\pi^{2} k_{B} T_{\\parallel}}{m \\Delta^{2}}\\right)\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "最后的这项实践将前面的理论概念融入到一个具体的编码任务中，旨在巩固你对动理学矩计算的理解。你将亲手实现一个数值方案，用于计算各向异性等离子体的压力张量分量，并执行一次完整的收敛性研究。这个练习将把关于数值误差的理论知识 () 应用于实践，让你直观地看到网格分辨率如何影响计算精度，这是验证任何计算模型的基石 ()。",
            "id": "4014797",
            "problem": "考虑一个空间均匀、时间平稳的等离子体，该等离子体由质量为 $m$、数密度为 $n$ 的单一离子种类构成，并以各向异性速度分布为特征。设其分布函数在笛卡尔速度分量上是可分离的，定义为\n$$\nf(\\mathbf{v}) = n \\, g_x(v_x) \\, g_y(v_y) \\, g_z(v_z),\n$$\n其中对于每个笛卡尔分量 $i \\in \\{x,y,z\\}$，\n$$\ng_i(v_i) = \\sqrt{\\frac{m}{2 \\pi \\Theta_i}} \\, \\exp\\!\\left(-\\frac{m v_i^2}{2 \\Theta_i}\\right).\n$$\n这里 $\\Theta_i$ 表示方向温度能，定义为 $\\Theta_i = k_{\\mathrm{B}} T_i$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T_i$ 是方向温度。所有物理量必须在国际单位制（SI）中处理。\n\n动压张量根据第一性原理通过分布函数的二阶矩定义，\n$$\nP_{ij} = m \\int_{\\mathbb{R}^3} (v_i - u_i) (v_j - u_j) f(\\mathbf{v}) \\, d^3 v,\n$$\n其中 $\\mathbf{u}$ 是整体流速。在本问题中，取 $\\mathbf{u} = \\mathbf{0}$，因此 $P_{ij}$ 直接由 $f(\\mathbf{v})$ 的速度空间矩计算得出。零阶矩（数密度）为\n$$\nn = \\int_{\\mathbb{R}^3} f(\\mathbf{v}) \\, d^3 v.\n$$\n\n您的任务是针对计算得到的对角压力张量分量 $P_{xx}$、$P_{yy}$ 和 $P_{zz}$ 进行收敛性研究。这些分量是通过在每个速度坐标上的有界均匀网格上进行数值积分获得的。具体来说：\n\n- 对于每个笛卡尔速度分量 $v_i$，将无穷积分限替换为有界积分限 $[-L_i, L_i]$，其中\n$$\nL_i = c \\, \\sqrt{\\frac{2 \\Theta_i}{m}},\n$$\n而 $c$ 是一个无量纲截断因子，用于指定包含多少个热速度。这通过捕捉分布支撑的主要部分来减少截断误差。\n\n- 在每个有界区间 $[-L_i, L_i]$ 上，定义一个具有 $N$ 个点的均匀网格，并使用梯形法则来近似一维积分。利用 $f(\\mathbf{v})$ 的可分离性，将三维压力分量积分表示为一维积分的乘积。\n\n- 对于给定的参数集 $(m, n, \\Theta_x, \\Theta_y, \\Theta_z, \\varepsilon, c)$，在搜索区间 $[N_{\\min}, N_{\\max}]$ 内确定最小整数网格尺寸 $N$，使得所有三个对角分量的相对误差，\n$$\n\\mathrm{rel\\_err}(P_{ii}) = \\frac{\\left| P_{ii}^{\\mathrm{num}} - P_{ii}^{\\mathrm{exact}} \\right|}{\\left| P_{ii}^{\\mathrm{exact}} \\right|},\n$$\n同时满足\n$$\n\\mathrm{rel\\_err}(P_{xx}) \\le \\varepsilon, \\quad \\mathrm{rel\\_err}(P_{yy}) \\le \\varepsilon, \\quad \\mathrm{rel\\_err}(P_{zz}) \\le \\varepsilon.\n$$\n所有压力必须在内部以帕斯卡（Pascals）为单位进行计算。程序的输出是整数 $N$，并且是无量纲的。\n\n- 如果在 $[N_{\\min}, N_{\\max}]$ 内没有 $N$ 满足指定的容差 $\\varepsilon$，则报告 $N_{\\max}$。\n\n使用以下测试套件，这些套件旨在探测与计算聚变科学与工程相关的典型、严格容差和边缘情况：\n\n- 测试用例 1（中等各向异性，典型截断）：$m = 3.343583719 \\times 10^{-27} \\, \\mathrm{kg}$（氘离子质量），$n = 5.0 \\times 10^{19} \\, \\mathrm{m}^{-3}$，$\\Theta_x = 3 \\, \\mathrm{keV}$，$\\Theta_y = 3 \\, \\mathrm{keV}$，$\\Theta_z = 9 \\, \\mathrm{keV}$，$\\varepsilon = 1.0 \\times 10^{-4}$，$c = 6$。\n\n- 测试用例 2（各向同性，严格容差）：$m = 3.343583719 \\times 10^{-27} \\, \\mathrm{kg}$，$n = 1.0 \\times 10^{20} \\, \\mathrm{m}^{-3}$，$\\Theta_x = 10 \\, \\mathrm{keV}$，$\\Theta_y = 10 \\, \\mathrm{keV}$，$\\Theta_z = 10 \\, \\mathrm{keV}$，$\\varepsilon = 1.0 \\times 10^{-6}$，$c = 6$。\n\n- 测试用例 3（强各向异性）：$m = 3.343583719 \\times 10^{-27} \\, \\mathrm{kg}$，$n = 1.0 \\times 10^{19} \\, \\mathrm{m}^{-3}$，$\\Theta_x = 0.5 \\, \\mathrm{keV}$，$\\Theta_y = 20 \\, \\mathrm{keV}$，$\\Theta_z = 5 \\, \\mathrm{keV}$，$\\varepsilon = 5.0 \\times 10^{-5}$，$c = 6$。\n\n- 测试用例 4（截断受限域）：$m = 3.343583719 \\times 10^{-27} \\, \\mathrm{kg}$，$n = 1.0 \\times 10^{19} \\, \\mathrm{m}^{-3}$，$\\Theta_x = 15 \\, \\mathrm{keV}$，$\\Theta_y = 15 \\, \\mathrm{keV}$，$\\Theta_z = 15 \\, \\mathrm{keV}$，$\\varepsilon = 1.0 \\times 10^{-3}$，$c = 3$。\n\n在所有情况下，$\\Theta_i$ 以千电子伏（keV）为单位指定，必须使用 $1 \\, \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\, \\mathrm{J}$ 转换为焦耳。将搜索边界设置为 $N_{\\min} = 8$ 和 $N_{\\max} = 4096$。\n\n您的程序应生成单行输出，其中包含每个测试用例的最小 $N$，按顺序排列，形式为逗号分隔的列表，并用方括号括起来（例如 $[N_1,N_2,N_3,N_4]$）。输出的整数是无量纲的，而所有内部物理计算必须使用 SI 单位，任何内部压力均以 $\\mathrm{Pa}$ 表示，任何角度（如果适用）均以 $\\mathrm{radians}$ 表示（本问题中没有出现角度）。不要输出任何压力；仅按规定输出整数列表。",
            "solution": "用户提供的问题经过严格验证，被确定为**有效的**。它在科学上是合理的、适定的、客观的，并包含了唯一解所需的所有必要信息。该问题要求对各向异性等离子体的对角压力张量分量的数值计算进行收敛性研究，这是计算等离子体物理学中的一项标准任务。\n\n解决方案将分三个阶段进行：首先，解析推导精确的压力分量，作为基准；其次，制定用于近似这些分量的数值方案；第三，为收敛性研究进行算法设计。\n\n### 1. 压力张量分量的解析解\n\n动压张量 $P_{ij}$ 定义为分布函数 $f(\\mathbf{v})$ 的二阶速度矩。鉴于问题陈述中整体流速为零，即 $\\mathbf{u} = \\mathbf{0}$，定义简化为：\n$$\nP_{ij} = m \\int_{\\mathbb{R}^3} v_i v_j f(\\mathbf{v}) \\, d^3 v\n$$\n所提供的分布函数在笛卡尔速度坐标中是可分离的：\n$$\nf(\\mathbf{v}) = n \\, g_x(v_x) \\, g_y(v_y) \\, g_z(v_z)\n$$\n其中每个 $g_i(v_i)$ 是一维高斯（麦克斯韦）分布：\n$$\ng_i(v_i) = \\sqrt{\\frac{m}{2 \\pi \\Theta_i}} \\, \\exp\\!\\left(-\\frac{m v_i^2}{2 \\Theta_i}\\right)\n$$\n函数 $g_i(v_i)$ 是归一化概率密度函数，满足 $\\int_{-\\infty}^{\\infty} g_i(v_i) \\, dv_i = 1$。\n\n让我们计算对角分量 $P_{xx}$：\n$$\nP_{xx} = m \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} v_x^2 \\, n \\, g_x(v_x) \\, g_y(v_y) \\, g_z(v_z) \\, dv_x \\, dv_y \\, dv_z\n$$\n由于可分离性，这变为：\n$$\nP_{xx} = m n \\left( \\int_{-\\infty}^{\\infty} v_x^2 g_x(v_x) \\, dv_x \\right) \\left( \\int_{-\\infty}^{\\infty} g_y(v_y) \\, dv_y \\right) \\left( \\int_{-\\infty}^{\\infty} g_z(v_z) \\, dv_z \\right)\n$$\n由于 $g_y$ 和 $g_z$ 的归一化，后两个积分等于 $1$。第一个积分是高斯分布 $g_x(v_x)$ 的方差，即 $\\sigma_{v_x}^2 = \\Theta_x/m$。\n$$\n\\int_{-\\infty}^{\\infty} v_x^2 g_x(v_x) \\, dv_x = \\frac{\\Theta_x}{m}\n$$\n将这些结果代回，我们得到 $P_{xx}$ 的精确解析表达式：\n$$\nP_{xx}^{\\mathrm{exact}} = m n \\left( \\frac{\\Theta_x}{m} \\right) (1) (1) = n \\Theta_x\n$$\n通过对称性，其他对角分量可被发现为：\n$$\nP_{yy}^{\\mathrm{exact}} = n \\Theta_y, \\quad P_{zz}^{\\mathrm{exact}} = n \\Theta_z\n$$\n这些解析结果以 SI 单位（帕斯卡）表示，并将作为与数值结果进行比较的基准。对于非对角分量 $P_{ij}$（$i \\neq j$），积分涉及在一个对称域上的奇函数（例如 $v_i g_i(v_i)$），其计算结果为零。因此，压力张量是对角的，正如对这种分布所预期的那样。\n\n### 2. 数值积分方案\n\n数值任务是在有界速度网格上计算对角压力分量，并确定达到指定精度 $\\varepsilon$ 所需的网格分辨率 $N$。\n\n对 $\\mathbb{R}^3$ 的积分被替换为在有限盒子 $[-L_x, L_x] \\times [-L_y, L_y] \\times [-L_z, L_z]$ 上的积分，其中 $L_i = c \\sqrt{2 \\Theta_i / m}$。有限域的选择引入了截断误差，该误差由因子 $c$ 控制。$P_{xx}$ 的数值近似为：\n$$\nP_{xx}^{\\mathrm{num}} = m n \\left( \\int_{-L_x}^{L_x} v_x^2 g_x(v_x) \\, dv_x \\right) \\left( \\int_{-L_y}^{L_y} g_y(v_y) \\, dv_y \\right) \\left( \\int_{-L_z}^{L_z} g_z(v_z) \\, dv_z \\right)\n$$\n这需要为每个方向 $i \\in \\{x,y,z\\}$ 计算两种类型的一维积分：\n1.  零阶矩积分：$I_{0,i}(N) = \\int_{-L_i}^{L_i} g_i(v_i) \\, dv_i$\n2.  二阶矩积分：$I_{2,i}(N) = \\int_{-L_i}^{L_i} v_i^2 g_i(v_i) \\, dv_i$\n\n每个积分都使用梯形法则在 $N$ 个点的均匀网格上进行近似。对于一个通用积分 $I = \\int_a^b F(x) dx$，网格点为 $x_k = a + k \\Delta x$（$k = 0, \\ldots, N-1$），步长为 $\\Delta x = (b-a)/(N-1)$。梯形近似为：\n$$\nI_{\\mathrm{trapz}} = \\Delta x \\left( \\frac{F(x_0) + F(x_{N-1})}{2} + \\sum_{k=1}^{N-2} F(x_k) \\right)\n$$\n使用这些一维积分近似，数值压力分量被组装为：\n$$\nP_{xx}^{\\mathrm{num}}(N) = m n \\, I_{2,x}(N) \\, I_{0,y}(N) \\, I_{0,z}(N) \\\\\nP_{yy}^{\\mathrm{num}}(N) = m n \\, I_{0,x}(N) \\, I_{2,y}(N) \\, I_{0,z}(N) \\\\\nP_{zz}^{\\mathrm{num}}(N) = m n \\, I_{0,x}(N) \\, I_{2,z}(N) \\, I_{0,y}(N)\n$$\n\n### 3. 收敛性研究算法\n\n问题的核心是在范围 $[N_{\\min}, N_{\\max}]$ 内找到最小的整数 $N$，使得所有三个对角压力分量的相对误差都小于或等于容差 $\\varepsilon$。\n分量 $P_{ii}$ 的相对误差为：\n$$\n\\mathrm{rel\\_err}(P_{ii}) = \\frac{\\left| P_{ii}^{\\mathrm{num}}(N) - P_{ii}^{\\mathrm{exact}} \\right|}{\\left| P_{ii}^{\\mathrm{exact}} \\right|}\n$$\n需要满足的条件是：\n$$\n\\max \\left( \\mathrm{rel\\_err}(P_{xx}), \\mathrm{rel\\_err}(P_{yy}), \\mathrm{rel\\_err}(P_{zz}) \\right) \\le \\varepsilon\n$$\n对于每个测试用例，算法按以下步骤进行：\n1.  获取参数 $(m, n, \\Theta_x, \\Theta_y, \\Theta_z, \\varepsilon, c)$，并使用给定的转换因子将温度从 keV 转换为焦耳。\n2.  计算精确压力 $P_{ii}^{\\mathrm{exact}} = n \\Theta_i$（对于 $i \\in \\{x,y,z\\}$）。\n3.  从 $N_{\\min}$ 到 $N_{\\max}$ 遍历网格尺寸 $N$。\n4.  对于每个 $N$：\n    a. 对于每个方向 $i \\in \\{x,y,z\\}$，定义速度域 $[-L_i, L_i]$ 并创建一个 $N$ 个点的均匀网格。\n    b. 在此网格上评估 $I_{0,i}$ 和 $I_{2,i}$ 的被积函数。\n    c. 使用梯形法则计算 $I_{0,i}(N)$ 和 $I_{2,i}(N)$ 的数值。\n    d. 组装数值压力 $P_{xx}^{\\mathrm{num}}(N)$、$P_{yy}^{\\mathrm{num}}(N)$ 和 $P_{zz}^{\\mathrm{num}}(N)$。\n    e. 计算三个相对误差。\n    f. 如果三个相对误差的最大值小于或等于 $\\varepsilon$，则当前的 $N$ 是满足标准的最小网格尺寸。记录此值并继续下一个测试用例。\n5.  如果循环完成而没有找到合适的 $N$，则表示在给定约束条件下无法达到所需的精度（例如，由于过度的截断误差，如测试用例4）。在这种情况下，要报告的值是 $N_{\\max}$。\n\n此过程系统地确定了给定一组物理参数和精度要求所需的网格分辨率，为物理相关背景下的数值收敛性提供了一个实际演示。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a convergence study to find the minimum grid size N for calculating\n    plasma pressure tensor components to a specified accuracy.\n    \"\"\"\n\n    # --- Constants ---\n    # Conversion factor from eV to Joules\n    E_CHARGE = 1.602176634e-19\n    # Search bounds for grid size N\n    N_MIN = 8\n    N_MAX = 4096\n\n    # --- Test Cases ---\n    test_cases = [\n        {\n            \"m\": 3.343583719e-27,  # Deuterium mass (kg)\n            \"n\": 5.0e19,           # Number density (m^-3)\n            \"thetas_keV\": (3.0, 3.0, 9.0), # Directional temperatures (keV)\n            \"epsilon\": 1.0e-4,     # Relative error tolerance\n            \"c\": 6.0,              # Truncation factor\n        },\n        {\n            \"m\": 3.343583719e-27,\n            \"n\": 1.0e20,\n            \"thetas_keV\": (10.0, 10.0, 10.0),\n            \"epsilon\": 1.0e-6,\n            \"c\": 6.0,\n        },\n        {\n            \"m\": 3.343583719e-27,\n            \"n\": 1.0e19,\n            \"thetas_keV\": (0.5, 20.0, 5.0),\n            \"epsilon\": 5.0e-5,\n            \"c\": 6.0,\n        },\n        {\n            \"m\": 3.343583719e-27,\n            \"n\": 1.0e19,\n            \"thetas_keV\": (15.0, 15.0, 15.0),\n            \"epsilon\": 1.0e-3,\n            \"c\": 3.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        m = case[\"m\"]\n        n = case[\"n\"]\n        thetas_keV = case[\"thetas_keV\"]\n        epsilon = case[\"epsilon\"]\n        c = case[\"c\"]\n\n        # Convert temperatures from keV to Joules (SI units)\n        thetas_J = np.array(thetas_keV) * 1000.0 * E_CHARGE\n\n        # Calculate exact analytical pressures (in Pascals)\n        P_exact = n * thetas_J\n\n        found_N = N_MAX\n        for N in range(N_MIN, N_MAX + 1):\n            \n            integrals_0 = []\n            integrals_2 = []\n\n            for i in range(3): # Loop over x, y, z directions\n                theta_i = thetas_J[i]\n                \n                # Define truncated integration domain [-L_i, L_i]\n                L_i = c * np.sqrt(2 * theta_i / m)\n                \n                # Create uniform velocity grid\n                v_grid = np.linspace(-L_i, L_i, N)\n                \n                # Evaluate the 1D Maxwellian distribution g_i(v_i) on the grid\n                # g_i(v_i) = sqrt(m / (2 * pi * Theta_i)) * exp(-m * v_i^2 / (2 * Theta_i))\n                g_const = np.sqrt(m / (2.0 * np.pi * theta_i))\n                exponent = -m * v_grid**2 / (2.0 * theta_i)\n                g_vals = g_const * np.exp(exponent)\n                \n                # Numerically compute 1D integrals using the trapezoidal rule\n                # Zeroth moment integral: integral(g_i(v_i)) dv_i\n                I_0 = np.trapz(g_vals, x=v_grid)\n                integrals_0.append(I_0)\n                \n                # Second moment integral: integral(v_i^2 * g_i(v_i)) dv_i\n                v2g_vals = v_grid**2 * g_vals\n                I_2 = np.trapz(v2g_vals, x=v_grid)\n                integrals_2.append(I_2)\n\n            I0_x, I0_y, I0_z = integrals_0\n            I2_x, I2_y, I2_z = integrals_2\n            \n            # Assemble numerical pressure components\n            P_num = np.array([\n                m * n * I2_x * I0_y * I0_z,\n                m * n * I0_x * I2_y * I0_z,\n                m * n * I0_x * I0_y * I2_z\n            ])\n            \n            # Calculate relative errors\n            rel_errs = np.abs(P_num - P_exact) / np.abs(P_exact)\n            \n            # Check if all errors are within the tolerance\n            if np.all(rel_errs = epsilon):\n                found_N = N\n                break # Found the minimal N, exit the loop\n\n        results.append(found_N)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}