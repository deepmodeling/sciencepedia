{
    "hands_on_practices": [
        {
            "introduction": "朗道碰撞算符通常通过罗森布鲁斯势来表达，这些势由速度空间上的积分定义。然而，在计算中，处理微分方程通常比处理积分更高效。本练习将引导您完成罗森布鲁斯势所满足的泊松型微分方程的基本推导，并将其转换到适用于轴对称等离子体的 $(v, \\xi)$ 坐标系中。掌握从积分表述到微分表述的转换，是构建现代朗道算符数值求解器的关键第一步。",
            "id": "4033040",
            "problem": "考虑速度空间 $\\mathbf{v} \\in \\mathbb{R}^{3}$ 中的单种离子分布函数 $f(\\mathbf{v})$，该函数用于磁约束聚变（MCF）中库仑碰撞的计算模型。测试粒子与场粒子相互作用的 Landau 碰撞算符可以用 Rosenbluth 势 $G(\\mathbf{v})$ 和 $H(\\mathbf{v})$ 表示，其定义为以下速度空间积分：\n$$G(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} \\frac{f(\\mathbf{v}')}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}', \\qquad H(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\, |\\mathbf{v}-\\mathbf{v}'| \\,\\mathrm{d}^{3} \\mathbf{v}'.$$\n假设分布函数 $f(\\mathbf{v})$ 关于背景磁场方向 $\\mathbf{B}$ 轴对称，因此 $f$ 仅依赖于速率 $v = |\\mathbf{v}|$ 和投掷角余弦 $\\xi = \\cos \\theta = v_{\\parallel}/v$，其中 $\\theta$ 是从 $\\mathbf{B}$ 测量的极角，$v_{\\parallel}$ 是平行于 $\\mathbf{B}$ 的速度分量；函数不依赖于方位角 $\\phi$。仅使用三维拉普拉斯算符的基本性质和标准坐标变换来推导控制方程及其变换。\n\n从以下基本事实出发：\n- 作用于牛顿格林函数的三维拉普拉斯算符满足 $\\nabla_{\\mathbf{v}}^{2}\\!\\left(\\frac{1}{|\\mathbf{v}-\\mathbf{v}'|}\\right) = -4\\pi \\,\\delta(\\mathbf{v}-\\mathbf{v}')$，并且，对于 $|\\mathbf{v}-\\mathbf{v}'| \\neq 0$，$\\nabla_{\\mathbf{v}}^{2}\\!\\left(|\\mathbf{v}-\\mathbf{v}'|\\right) = \\frac{2}{|\\mathbf{v}-\\mathbf{v}'|}$。\n- 从笛卡尔坐标 $(v_{x}, v_{y}, v_{z})$ 到球极速度坐标 $(v, \\theta, \\phi)$ 的变量变换，其中投掷角余弦为 $\\xi = \\cos \\theta$。\n\n按顺序推导以下内容：\n1. 在 $\\mathbf{v}$ 空间中，$G(\\mathbf{v})$ 和 $H(\\mathbf{v})$ 满足的耦合类泊松方程。\n2. 在轴对称假设下，作用于仅依赖于 $(v,\\xi)$ 的标量函数的速度空间拉普拉斯算符 $\\nabla_{\\mathbf{v}}^{2}$ 的显式形式，用 $(v,\\xi)$ 变量直接表示。\n3. 使用第2部分得到的算符，写出以 $(v,\\xi)$ 表示的 $G(v,\\xi)$ 和 $H(v,\\xi)$ 的变换后的 Rosenbluth 泊松方程。\n4. 在 $(v,\\xi)$ 坐标下，$G(v,\\xi)$ 和 $H(v,\\xi)$ 的物理上合适的边界条件，这些条件确保在 $v=0$ 处的正则性，在 $v \\to \\infty$ 时的衰减，以及在投掷角端点 $\\xi = \\pm 1$ 处的正则性。\n\n将您的最终结果表示为单个解析表达式，其中列出：\n- $(v,\\xi)$ 坐标系下轴对称的算符 $\\nabla_{\\mathbf{v}}^{2}$，\n- 两个变换后的方程，\n- 在 $v \\to \\infty$，$v=0$ 和 $\\xi=\\pm 1$ 处的三个边界条件声明。\n\n无需数值计算。您的最终答案必须是单个闭式解析表达式。",
            "solution": "问题陈述是数学物理中一个适定且科学上合理的练习，特别是在等离子体动理学理论的背景下。它要求在轴对称假设下推导 Rosenbluth 势的控制方程及其相关边界条件。所有给出的定义和恒等式都是标准且正确的。因此，该问题是有效的，可以构建解答。\n\n推导过程如问题中所述，分四个步骤进行。\n\n### 第1步：在 $\\mathbf{v}$ 空间中推导类泊松方程\n\nRosenbluth 势 $G(\\mathbf{v})$ 和 $H(\\mathbf{v})$ 定义为：\n$$G(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{1}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n$$H(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\, |\\mathbf{v}-\\mathbf{v}'| \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n\n我们将三维速度空间拉普拉斯算符 $\\nabla_{\\mathbf{v}}^{2}$ 应用于每个势。由于微分是关于 $\\mathbf{v}$ 的，而积分是关于哑变量 $\\mathbf{v}'$ 的，因此算符可以移到积分内部。\n\n对于势 $G(\\mathbf{v})$：\n$$\\nabla_{\\mathbf{v}}^{2} G(\\mathbf{v}) = \\nabla_{\\mathbf{v}}^{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{1}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}' = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\nabla_{\\mathbf{v}}^{2} \\left(\\frac{1}{|\\mathbf{v}-\\mathbf{v}'|}\\right) \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n使用所给的格林函数拉普拉斯算符的恒等式 $\\nabla_{\\mathbf{v}}^{2} (|\\mathbf{v}-\\mathbf{v}'|^{-1}) = -4\\pi \\, \\delta(\\mathbf{v}-\\mathbf{v}')$，我们得到：\n$$\\nabla_{\\mathbf{v}}^{2} G(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') (-4\\pi \\, \\delta(\\mathbf{v}-\\mathbf{v}')) \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n根据 Dirac δ 函数的筛选性质，该积分的计算结果为函数 $f(\\mathbf{v})$ 乘以 $-4\\pi$。\n$$\\nabla_{\\mathbf{v}}^{2} G(\\mathbf{v}) = -4\\pi f(\\mathbf{v})$$\n这就是势 $G(\\mathbf{v})$ 的泊松方程。\n\n对于势 $H(\\mathbf{v})$：\n$$\\nabla_{\\mathbf{v}}^{2} H(\\mathbf{v}) = \\nabla_{\\mathbf{v}}^{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\, |\\mathbf{v}-\\mathbf{v}'| \\,\\mathrm{d}^{3} \\mathbf{v}' = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\nabla_{\\mathbf{v}}^{2} (|\\mathbf{v}-\\mathbf{v}'|) \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n使用所给的第二个恒等式 $\\nabla_{\\mathbf{v}}^{2} (|\\mathbf{v}-\\mathbf{v}'|) = 2/|\\mathbf{v}-\\mathbf{v}'|$（对于 $\\mathbf{v} \\neq \\mathbf{v}'$），该恒等式在积分中成立，我们有：\n$$\\nabla_{\\mathbf{v}}^{2} H(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{2}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n认识到该积分是 $G(\\mathbf{v})$ 定义的 $2$ 倍：\n$$\\nabla_{\\mathbf{v}}^{2} H(\\mathbf{v}) = 2 \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{1}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}' = 2 G(\\mathbf{v})$$\n这是第二个类泊松方程，它将 $H(\\mathbf{v})$ 与 $G(\\mathbf{v})$ 耦合起来。\n\n### 第2步：$(v, \\xi)$ 坐标系下的速度空间拉普拉斯算符\n\n在三维球极坐标 $(v, \\theta, \\phi)$ 中，作用于标量函数 $\\Psi(v, \\theta, \\phi)$ 的拉普拉斯算符是：\n$$\\nabla_{\\mathbf{v}}^{2}\\Psi = \\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial \\Psi}{\\partial v} \\right) + \\frac{1}{v^{2}\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial \\Psi}{\\partial \\theta} \\right) + \\frac{1}{v^{2}\\sin^{2}\\theta} \\frac{\\partial^{2} \\Psi}{\\partial \\phi^{2}}$$\n在轴对称假设下，函数 $f$、$G$ 和 $H$ 不依赖于方位角 $\\phi$，因此 $\\partial \\Psi / \\partial \\phi = 0$，最后一项消失。这些函数依赖于 $(v, \\xi)$，其中 $\\xi = \\cos\\theta$。我们必须将关于 $\\theta$ 的导数项变换为关于 $\\xi$ 的导数项。\n关于 $\\theta$ 的导数的链式法则给出：\n$$\\frac{\\partial}{\\partial \\theta} = \\frac{\\mathrm{d}\\xi}{\\mathrm{d}\\theta} \\frac{\\partial}{\\partial \\xi} = (-\\sin\\theta) \\frac{\\partial}{\\partial \\xi}$$\n让我们变换拉普拉斯算符的角度部分：\n$$\\frac{1}{\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial \\Psi}{\\partial \\theta} \\right) = \\frac{1}{\\sin\\theta} \\left( (-\\sin\\theta)\\frac{\\partial}{\\partial \\xi} \\right) \\left( \\sin\\theta \\left( (-\\sin\\theta)\\frac{\\partial \\Psi}{\\partial \\xi} \\right) \\right)$$\n$$= -\\frac{\\partial}{\\partial \\xi} \\left( -\\sin^{2}\\theta \\frac{\\partial \\Psi}{\\partial \\xi} \\right) = \\frac{\\partial}{\\partial \\xi} \\left( \\sin^{2}\\theta \\frac{\\partial \\Psi}{\\partial \\xi} \\right)$$\n使用恒等式 $\\sin^{2}\\theta = 1 - \\cos^{2}\\theta = 1 - \\xi^{2}$，我们得到勒让德算符：\n$$\\frac{1}{\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial \\Psi}{\\partial \\theta} \\right) = \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial \\Psi}{\\partial \\xi} \\right)$$\n将此代回拉普拉斯算符的表达式，对于任意轴对称标量函数 $\\Psi(v, \\xi)$，我们有：\n$$\\nabla_{\\mathbf{v}}^{2}\\Psi(v, \\xi) = \\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial \\Psi}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial \\Psi}{\\partial \\xi} \\right)$$\n\n### 第3步：$(v, \\xi)$ 坐标系下变换后的 Rosenbluth 方程\n\n现在我们将第2步中推导出的算符代入第1步的方程中。势 $G$ 和 $H$ 以及分布函数 $f$ 现在都是 $(v, \\xi)$ 的函数。\n$G(v, \\xi)$ 的泊松方程变为：\n$$\\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial G}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial G}{\\partial \\xi} \\right) = -4\\pi f(v, \\xi)$$\n$H(v, \\xi)$ 的类泊松方程变为：\n$$\\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial H}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial H}{\\partial \\xi} \\right) = 2 G(v, \\xi)$$\n\n### 第4步：物理上合适的边界条件\n\n边界条件由物理正则性以及势在 $(v, \\xi)$ 域边界上的行为确定。该域为 $v \\in [0, \\infty)$ 和 $\\xi \\in [-1, 1]$。\n\n1.  **当 $v \\to \\infty$ 时**：分布函数 $f(\\mathbf{v}')$ 是局域化的，因此对于大的 $v=|\\mathbf{v}|$，我们可以使用多极展开。\n    $|\\mathbf{v}-\\mathbf{v}'|^{-1} \\approx 1/v$。所以 $G(\\mathbf{v}) \\approx \\frac{1}{v} \\int f(\\mathbf{v}') \\mathrm{d}^3\\mathbf{v}' \\propto 1/v$。\n    $|\\mathbf{v}-\\mathbf{v}'| \\approx v$。所以 $H(\\mathbf{v}) \\approx v \\int f(\\mathbf{v}') \\mathrm{d}^3\\mathbf{v}' \\propto v$。\n    因此，渐近行为是 $G \\sim \\mathcal{O}(v^{-1})$ 和 $H \\sim \\mathcal{O}(v)$。这意味着当 $v \\to \\infty$ 时，$G \\to 0$。\n\n2.  **在 $v=0$ 处**：为了使势 $G$ 和 $H$ 在速度空间原点处是正则的，它们的空间梯度必须为零，即 $\\nabla_{\\mathbf{v}} G|_{\\mathbf{v}=0} = \\mathbf{0}$ 和 $\\nabla_{\\mathbf{v}} H|_{\\mathbf{v}=0} = \\mathbf{0}$。如果梯度不为零，它会在原点引入一个优先方向，这与势在该点的标量性质不符。非零梯度还会在拉普拉斯算符中导致一个与 $1/v$ 成比例的奇异项，使得方程在原点处无效。这意味着径向导数必须为零。\n    $$\\left.\\frac{\\partial G}{\\partial v}\\right|_{v=0} = 0, \\qquad \\left.\\frac{\\partial H}{\\partial v}\\right|_{v=0} = 0$$\n\n3.  **在 $\\xi = \\pm 1$ 处**：这些点对应于对称轴（$\\theta=0, \\pi$）。为了使势在该轴上是光滑函数，它们必须是垂直速度分量 $v_{\\perp}$ 的局部偶函数。这意味着相对于垂直于轴的坐标的导数在轴上为零。由此可知 $\\partial G/\\partial \\theta = 0$ 和 $\\partial H/\\partial \\theta = 0$ 在 $\\theta=0, \\pi$ 处成立。由于 $\\partial/\\partial\\xi = (-\\sin\\theta)^{-1} \\partial/\\partial\\theta$，这意味着 $\\partial G/\\partial \\xi$ 和 $\\partial H/\\partial \\xi$ 在 $\\xi = \\pm 1$ 处必须是有限的。这确保了勒让德算符中的“通量”项 $(1-\\xi^2)\\partial\\Psi/\\partial\\xi$ 在边界 $\\xi=\\pm 1$ 处为零。\n    $$\\left.(1-\\xi^2)\\frac{\\partial G}{\\partial \\xi}\\right|_{\\xi=\\pm 1} = 0, \\qquad \\left.(1-\\xi^2)\\frac{\\partial H}{\\partial \\xi}\\right|_{\\xi=\\pm 1} = 0$$\n\n这四个步骤完成了问题陈述中要求的推导。",
            "answer": "$$\n\\boxed{\n\\begin{gathered}\n\\text{$(v,\\xi)$ 坐标系下的轴对称拉普拉斯算符：} \\\\\n\\nabla_{\\mathbf{v}}^{2} \\equiv \\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial}{\\partial \\xi} \\right) \\\\\n\\\\\n\\text{变换后的 Rosenbluth 方程：} \\\\\n\\nabla_{\\mathbf{v}}^{2} G(v, \\xi) = -4\\pi f(v, \\xi) \\\\\n\\nabla_{\\mathbf{v}}^{2} H(v, \\xi) = 2 G(v, \\xi) \\\\\n\\\\\n\\text{边界条件：} \\\\\n\\text{当 } v \\to \\infty: \\quad G(v, \\xi) \\sim \\mathcal{O}(v^{-1}), \\quad H(v, \\xi) \\sim \\mathcal{O}(v) \\\\\n\\text{在 } v=0 \\text{ 处}: \\quad \\left.\\frac{\\partial G}{\\partial v}\\right|_{v=0} = 0, \\quad \\left.\\frac{\\partial H}{\\partial v}\\right|_{v=0} = 0 \\\\\n\\text{在 } \\xi=\\pm 1 \\text{ 处}: \\quad \\lim_{\\xi \\to \\pm 1} \\left( (1-\\xi^{2})\\frac{\\partial G}{\\partial \\xi} \\right) = 0, \\quad \\lim_{\\xi \\to \\pm 1} \\left( (1-\\xi^{2})\\frac{\\partial H}{\\partial \\xi} \\right) = 0\n\\end{gathered}\n}\n$$"
        },
        {
            "introduction": "完整的朗道碰撞算符非常复杂，但其效应可以通过分析其各个分量（如节距角散射）来理解。在合适的基函数下表示算符可以揭示其基本性质。本练习将展示，当分布函数在勒让德多项式基中展开时，节距角散射算符如何呈现为对角形式。这一深刻见解不仅在理论上十分优雅，也构成了动理学模拟中高效谱方法的基础。",
            "id": "4033086",
            "problem": "考虑一种单组分磁化等离子体，其处于弱耦合、小角度库仑碰撞区，因此速度空间分布函数的缓慢碰撞弛豫由 Landau 形式的 Fokker–Planck (FP) 算符控制。假设在固定速率下，能量扩散和动力学摩擦与投掷角散射相比可以忽略不计，则作用于分布函数的投掷角散射算符可以被建模为固定速率 $v$ 下的角向扩散算符，写作 $C_{\\mathrm{pa}}[f](v,\\xi)=\\nu_{D}(v)\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f(v,\\xi)}{\\partial \\xi}\\right]$，其中 $\\xi=\\cos\\theta$ 是投掷角余弦，$\\nu_{D}(v)$ 是在静止的麦克斯韦背景上由库仑散射引起的偏转频率。假设 $\\nu_{D}(v)$ 是关于 $v$ 的一个正的、光滑的函数。\n\n将分布函数展开为 Legendre 多项式 $P_{l}(\\xi)$ 的级数形式 $f(v,\\xi)=\\sum_{l=0}^{\\infty}f_{l}(v)\\,P_{l}(\\xi)$，其标准正交性为 $\\int_{-1}^{1}P_{l}(\\xi)P_{l'}(\\xi)\\,d\\xi=\\frac{2}{2l+1}\\,\\delta_{ll'}$。将 $C_{\\mathrm{pa}}[f]$ 到第 $l$ 个 Legendre 模式上的谱投影定义为 $(C_{\\mathrm{pa}}f)_{l}(v)\\equiv\\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\,C_{\\mathrm{pa}}[f](v,\\xi)\\,d\\xi$，并通过 $(C_{\\mathrm{pa}}f)_{l}(v)=\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v)$ 定义矩阵元 $M_{ll'}(v)$。\n\n从上述物理建模假设和单位球面上旋转对称性所蕴含的 Legendre 多项式的基本性质出发，推导矩阵元 $M_{ll'}(v)$ 作为 $l$、$l'$ 和 $v$ 的函数的闭合形式表达式。您的答案必须是单一的闭合形式解析表达式。不需要进行数值评估，也不允许四舍五入。最终答案无需单位。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、良定性及客观性。\n\n### 第 1 步：提取已知条件\n- **投掷角散射算符**：$C_{\\mathrm{pa}}[f](v,\\xi)=\\nu_{D}(v)\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f(v,\\xi)}{\\partial \\xi}\\right]$，其中 $\\xi = \\cos\\theta$。\n- **偏转频率**：$\\nu_{D}(v)$ 是关于速率 $v$ 的一个正的光滑函数。\n- **分布函数展开**：$f(v,\\xi)=\\sum_{l=0}^{\\infty}f_{l}(v)\\,P_{l}(\\xi)$，其中 $P_l(\\xi)$ 是 Legendre 多项式。\n- **Legendre 多项式的正交性**：$\\int_{-1}^{1}P_{l}(\\xi)P_{l'}(\\xi)\\,d\\xi=\\frac{2}{2l+1}\\,\\delta_{ll'}$。\n- **谱投影定义**：$(C_{\\mathrm{pa}}f)_{l}(v)\\equiv\\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\,C_{\\mathrm{pa}}[f](v,\\xi)\\,d\\xi$。\n- **矩阵元定义**：$(C_{\\mathrm{pa}}f)_{l}(v)=\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v)$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了 Landau-Fokker-Planck 碰撞算符的投掷角散射分量，这是等离子体动理学理论中一个标准且基本的模型。使用 Legendre 多项式分析此类算符是输运理论中一种成熟的技术。该模型是一个有效且广泛使用的近似。\n- **良定性**：该问题是良定的。它要求在一个给定的完备基中求出线性算符的矩阵元。所有必要的定义和数学性质（算符形式、基展开、正交性）都已提供，从而可以推导出唯一解。\n- **客观性**：问题以精确的数学语言陈述，没有歧义或主观性陈述。\n\n### 第 3 步：结论与行动\n该问题在科学上是合理的、自洽的且良定的。因此判定为**有效**。可以开始推导解答。\n\n我们的目标是找到矩阵元 $M_{ll'}(v)$ 的闭合形式表达式。我们首先将分布函数 $f(v,\\xi)$ 的 Legendre 展开式代入投掷角散射算符 $C_{\\mathrm{pa}}[f]$ 的表达式中。\n在涉及投掷角余弦 $\\xi$ 的运算中，速率 $v$ 作为一个参数。\n\n$C_{\\mathrm{pa}}[f](v,\\xi) = \\nu_{D}(v)\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial}{\\partial \\xi} \\left( \\sum_{l'=0}^{\\infty}f_{l'}(v)\\,P_{l'}(\\xi) \\right) \\right]$。\n\n由于求和与对 $\\xi$ 的偏导数是线性运算，且系数 $f_{l'}(v)$ 与 $\\xi$ 无关，我们可以交换求和与微分的顺序：\n\n$C_{\\mathrm{pa}}[f](v,\\xi) = \\nu_{D}(v) \\sum_{l'=0}^{\\infty} f_{l'}(v) \\left( \\frac{d}{d\\xi}\\left[\\left(1-\\xi^{2}\\right)\\frac{d P_{l'}(\\xi)}{d\\xi}\\right] \\right)$。\n\n括号内的表达式是作用于 Legendre 多项式 $P_{l'}(\\xi)$ 的 Legendre 微分算符。根据定义，Legendre 多项式是该算符的本征函数。Legendre 微分方程为：\n$\\frac{d}{d\\xi}\\left[\\left(1-\\xi^{2}\\right)\\frac{d y}{d\\xi}\\right] + l(l+1)y = 0$。\n\n对于 $y = P_{l'}(\\xi)$，这给出了本征值关系：\n$\\frac{d}{d\\xi}\\left[\\left(1-\\xi^{2}\\right)\\frac{d P_{l'}(\\xi)}{d\\xi}\\right] = -l'(l'+1)P_{l'}(\\xi)$。\n\n将此结果代回 $C_{\\mathrm{pa}}[f](v,\\xi)$ 的表达式，我们得到：\n\n$C_{\\mathrm{pa}}[f](v,\\xi) = \\nu_{D}(v) \\sum_{l'=0}^{\\infty} f_{l'}(v) [-l'(l'+1)P_{l'}(\\xi)] = -\\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v)P_{l'}(\\xi)$。\n\n这表明算符 $C_{\\mathrm{pa}}$ 作用于 $f$ 的展开式的结果是另一个 Legendre 多项式级数，其中每个系数 $f_{l'}(v)$ 仅被乘以一个因子 $-\\nu_{D}(v)l'(l'+1)$。\n\n接下来，我们使用其定义计算谱投影 $(C_{\\mathrm{pa}}f)_{l}(v)$：\n$(C_{\\mathrm{pa}}f)_{l}(v) = \\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\,C_{\\mathrm{pa}}[f](v,\\xi)\\,d\\xi$。\n\n将 $C_{\\mathrm{pa}}[f](v,\\xi)$ 的级数形式代入此积分：\n$(C_{\\mathrm{pa}}f)_{l}(v) = \\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\left( -\\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v)P_{l'}(\\xi) \\right)\\,d\\xi$。\n\n项 $-\\nu_{D}(v)$、$l'(l'+1)$ 和 $f_{l'}(v)$ 相对于积分变量 $\\xi$ 是常数。因此，我们可以将它们连同求和符号一起移到积分之外：\n$(C_{\\mathrm{pa}}f)_{l}(v) = -\\frac{2l+1}{2} \\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v) \\int_{-1}^{1} P_{l}(\\xi)P_{l'}(\\xi) \\,d\\xi$。\n\n现在，我们使用 Legendre 多项式的正交性 $\\int_{-1}^{1}P_{l}(\\xi)P_{l'}(\\xi)\\,d\\xi=\\frac{2}{2l+1}\\,\\delta_{ll'}$，其中 $\\delta_{ll'}$ 是 Kronecker delta。\n\n$(C_{\\mathrm{pa}}f)_{l}(v) = -\\frac{2l+1}{2} \\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v) \\left( \\frac{2}{2l'+1}\\,\\delta_{ll'} \\right)$。\n\nKronecker delta $\\delta_{ll'}$ 在所有 $l' \\neq l$ 时为零，在 $l'=l$ 时为一。此性质导致无穷级数坍缩为对应于 $l'=l$ 的单个项。在此项中，我们必须将每个 $l'$ 替换为 $l$。\n\n$(C_{\\mathrm{pa}}f)_{l}(v) = -\\frac{2l+1}{2} \\nu_{D}(v) \\left( l(l+1)f_{l}(v) \\frac{2}{2l+1} \\right)$。\n\n因子 $\\frac{2l+1}{2}$ 和 $\\frac{2}{2l+1}$ 相互抵消，将表达式简化为：\n$(C_{\\mathrm{pa}}f)_{l}(v) = -l(l+1)\\nu_{D}(v)f_{l}(v)$。\n\n最后，我们将此结果与矩阵元 $M_{ll'}(v)$ 的定义进行比较：\n$(C_{\\mathrm{pa}}f)_{l}(v)=\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v)$。\n\n我们已经推导出 $(C_{\\mathrm{pa}}f)_{l}(v)$ 仅与 $f_l(v)$ 成正比。为了使比较更加明确，我们可以使用 Kronecker delta 来写出我们的结果：\n$-l(l+1)\\nu_{D}(v)f_{l}(v) = \\sum_{l'=0}^{\\infty} [-l(l+1)\\nu_{D}(v)\\delta_{ll'}] f_{l'}(v)$。\n请注意，由于仅当 $l'=l$ 时该项非零，我们可以在方括号内用 $l'$ 替换 $l$：$\\sum_{l'=0}^{\\infty} [-l'(l'+1)\\nu_{D}(v)\\delta_{ll'}] f_{l'}(v)$。然而，为了识别 $M_{ll'}$，第一种形式更为直接。\n\n通过比较 $(C_{\\mathrm{pa}}f)_{l}(v)$ 两个表达式中 $f_{l'}(v)$ 的系数，我们确定了矩阵元：\n$\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v) = \\sum_{l'=0}^{\\infty} [-l(l+1)\\nu_{D}(v)\\delta_{ll'}] f_{l'}(v)$。\n\n对于任意一组系数 $f_{l'}(v)$，该关系都必须成立，这意味着对于每个 $l'$，求和内的项必须相等。这给出了矩阵元的闭合形式表达式：\n$M_{ll'}(v) = -l(l+1)\\nu_{D}(v)\\delta_{ll'}$。\n\n这个结果表明，投掷角散射算符 $C_{\\mathrm{pa}}$ 在 Legendre 多项式基中是对角的，其本征值为 $-l(l+1)\\nu_{D}(v)$。\n对于 $l=0$，$M_{0l'}(v) = 0$，这反映了碰撞算符保持粒子数守恒的物理原理，因为 $l=0$ 模式与给定速率下的粒子密度成正比。",
            "answer": "$$\\boxed{-l(l+1)\\nu_{D}(v)\\delta_{ll'}}$$"
        },
        {
            "introduction": "在推导出罗森布鲁斯势的微分方程之后，下一步自然是进行数值求解。这个编码练习将理论付诸实践，指导您为各向同性的罗森布鲁斯势实现一个有限差分求解器。您将学习如何离散化控制方程、处理边界条件并验证您的结果，这些都是计算物理学家的核心技能。",
            "id": "4033041",
            "problem": "考虑在速度空间中，背景粒子种类的分布函数为 $f_b(v)$ 时，Landau 碰撞算子的各向同性 Rosenbluth 势。在各向同性情况下，Rosenbluth 势 $H_b(v)$ 和 $G_b(v)$ 在有界球形域 $v \\in [0, V_{\\max}]$ 上满足以下速度空间泊松问题：\n$$\n\\nabla_v^2 H_b(v) = -4\\pi f_b(v), \\quad \\nabla_v^2 G_b(v) = H_b(v),\n$$\n其中，球对称情况下的拉普拉斯算子简化为\n$$\n\\nabla_v^2 \\phi(v) \\equiv \\frac{1}{v^2}\\frac{d}{dv}\\!\\left(v^2 \\frac{d\\phi}{dv}\\right),\n$$\n对任何足够光滑的各向同性标量场 $\\phi(v)$ 均成立。变量 $v$、$V_{\\max}$、$H_b$、$G_b$ 和 $f_b$ 均为无量纲量，速度由粒子种类的热速度归一化，因此所有数值输出都是无量纲的。\n\n施加以下边界条件：\n- $v=0$ 处的正则性：势为有限值的物理要求意味着 $\\frac{dH_b}{dv}(0)=0$ 和 $\\frac{dG_b}{dv}(0)=0$。\n- 在 $v=V_{\\max}$ 处，使用狄利克雷边界条件 $H_b(V_{\\max})=0$，$G_b(V_{\\max})=0$，或使用齐次罗宾边界条件 $\\frac{dH_b}{dv}(V_{\\max})+\\alpha H_b(V_{\\max})=0$ 和 $\\frac{dG_b}{dv}(V_{\\max})+\\alpha G_b(V_{\\max})=0$，其中 $\\alpha$ 是给定的正参数。\n\n从这些定义和边界条件出发，在均匀网格 $v_i = i\\,\\Delta v$（$i=0,1,\\dots,N-1$，其中 $\\Delta v = V_{\\max}/(N-1)$）上，为 $H_b$ 和 $G_b$ 推导二阶精确的有限差分离散方程：\n- 对于内部点 $i=1,2,\\dots,N-2$，将算子以守恒散度形式离散化，\n$$\n\\left(\\nabla_v^2 \\phi\\right)_i \\approx \\frac{1}{v_i^2}\\,\\frac{1}{\\Delta v}\\left[ v_{i+\\frac{1}{2}}^2\\,\\frac{\\phi_{i+1}-\\phi_i}{\\Delta v} - v_{i-\\frac{1}{2}}^2\\,\\frac{\\phi_i-\\phi_{i-1}}{\\Delta v} \\right],\n$$\n其中 $v_{i\\pm \\frac{1}{2}} \\equiv v_i \\pm \\frac{\\Delta v}{2}$。\n- 在 $i=0$ 处，通过 $v\\to 0$ 的极限来施加正则性，\n$$\n\\left(\\nabla_v^2 \\phi\\right)_0 \\approx \\frac{6}{\\Delta v^2}\\left(\\phi_1 - \\phi_0\\right),\n$$\n该式可由 $\\nabla_v^2 \\phi = \\frac{1}{v^2}\\frac{d}{dv}(v^2 \\phi')$ 在 $v\\to 0$ 时的极限以及对称性条件 $\\phi'(0)=0$ 得到。\n- 在 $i=N-1$ 处，通过 $\\phi_{N-1}=0$ 施加狄利克雷条件，或通过以下方式施加齐次罗宾条件\n$$\n\\frac{\\phi_{N-1}-\\phi_{N-2}}{\\Delta v} + \\alpha\\,\\phi_{N-1} = 0.\n$$\n\n建立离散线性系统 $L\\mathbf{H} = \\mathbf{b}_H$ (对于 $\\mathbf{H} \\equiv \\{H_{b,i}\\}$）和 $L\\mathbf{G} = \\mathbf{b}_G$ (对于 $\\mathbf{G} \\equiv \\{G_{b,i}\\}$），其中 $L$ 表示上述 $\\nabla_v^2$ 的离散化，$\\mathbf{b}_H$ 表示 $-4\\pi f_b(v_i)$ 并包含与所选边界条件一致的边界行修改，$\\mathbf{b}_G$ 表示 $H_{b,i}$ 并包含相同的边界行修改。你的程序必须组装 $L$，求解这两个系统，并报告定量诊断指标。\n\n测试套件。使用以下参数集来测试求解器的不同方面；所有速度和输出均为无量纲：\n- 情况 A (正常路径)：$N=101$，$V_{\\max}=4$，在 $v=V_{\\max}$ 处为狄利克雷条件，$f_b(v)=\\exp(-v^2)$。\n- 情况 B (罗宾边界)：$N=51$，$V_{\\max}=3$，在 $v=V_{\\max}$ 处为罗宾条件，$\\alpha=1$，$f_b(v)=v^2\\exp(-v)$。\n- 情况 C (解析验证)：$N=81$，$V_{\\max}=2.5$，在 $v=V_{\\max}$ 处为狄利克雷条件，常数 $f_b(v)=c$，其中 $c=\\frac{1}{4\\pi}$，因此源项 $-4\\pi f_b(v)$ 等于 $-1$。在这种情况下，精确解为\n$$\nH_b(v)=\\frac{4\\pi c}{6}\\left(V_{\\max}^2 - v^2\\right),\\quad\nG_b(v)=\\frac{4\\pi c}{6}\\left(\\frac{v^2}{6}V_{\\max}^2 - \\frac{v^4}{20} - \\frac{V_{\\max}^4}{6} + \\frac{V_{\\max}^4}{20}\\right),\n$$\n通过对在 $v=0$ 处具正则性且在 $v=V_{\\max}$ 处为狄利克雷条件的径向泊松问题进行积分得到。\n- 情况 D (粗网格边界情况)：$N=3$，$V_{\\max}=1$，在 $v=V_{\\max}$ 处为狄利克雷条件，$f_b(v)=\\exp(-v)$。\n\n对于情况 A、B 和 D，计算最大绝对离散残差\n$$\nR_H \\equiv \\max_i \\left| (L\\mathbf{H} - \\mathbf{b}_H)_i \\right|,\\quad R_G \\equiv \\max_i \\left| (L\\mathbf{G} - \\mathbf{b}_G)_i \\right|.\n$$\n对于情况 C，计算相对于解析解的最大绝对误差，\n$$\nE_H \\equiv \\max_i \\left| H_{b,i} - H_b^{\\mathrm{exact}}(v_i) \\right|,\\quad E_G \\equiv \\max_i \\left| G_{b,i} - G_b^{\\mathrm{exact}}(v_i) \\right|.\n$$\n\n最终输出格式。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n[R_H^{\\mathrm{A}}, R_G^{\\mathrm{A}}, R_H^{\\mathrm{B}}, R_G^{\\mathrm{B}}, E_H^{\\mathrm{C}}, E_G^{\\mathrm{C}}, R_H^{\\mathrm{D}}, R_G^{\\mathrm{D}}].\n$$\n所有条目必须是十进制数。不涉及角度，因此不需要角度单位。由于所选的归一化，不出现物理单位。",
            "solution": "该问题要求在一个空间维度（速率 $v$）上，为各向同性 Rosenbluth 势 $H_b(v)$ 和 $G_b(v)$ 求解一对耦合的类泊松方程。这些势对于计算等离子体物理学中的 Landau 碰撞算子至关重要。控制方程为：\n$$\n\\nabla_v^2 H_b(v) = -4\\pi f_b(v)\n$$\n$$\n\\nabla_v^2 G_b(v) = H_b(v)\n$$\n在有界域 $v \\in [0, V_{\\max}]$ 上。由于球对称性，拉普拉斯算子简化为 $\\nabla_v^2 \\phi(v) = \\frac{1}{v^2}\\frac{d}{dv}(v^2 \\frac{d\\phi}{dv})$。\n\n求解策略包括使用有限差分法在均匀网格上离散化这些偏微分方程，这将微分方程转换为一个线性代数方程组 $L\\mathbf{\\phi} = \\mathbf{b}$，其中 $\\mathbf{\\phi}$ 代表网格点上的解向量。然后求解该系统得到 $\\mathbf{H}$（$H_{b,i}$ 值的向量），随后得到 $\\mathbf{G}$（$G_{b,i}$ 值的向量）。\n\n首先，我们建立离散域。速度 $v$ 上的均匀网格定义为 $v_i = i \\cdot \\Delta v$，$i = 0, 1, \\dots, N-1$，其中网格间距为 $\\Delta v = V_{\\max} / (N-1)$。解向量 $\\mathbf{H}$ 和 $\\mathbf{G}$ 将有 $N$ 个分量，代表势在这些网格点上的值。\n\n该方法的核心是构建离散拉普拉斯矩阵 $L$。这个 $N \\times N$ 矩阵表示线性算子 $\\nabla_v^2$。我们逐行构建它，每一行对应一个网格点 $v_i$。\n\n对于内部网格点 $v_i$（其中 $i \\in \\{1, 2, \\dots, N-2\\}$），问题提供了一个二阶精确的守恒有限差分近似：\n$$\n(\\nabla_v^2 \\phi)_i \\approx \\frac{1}{v_i^2 \\Delta v^2} \\left[ v_{i+\\frac{1}{2}}^2 (\\phi_{i+1} - \\phi_i) - v_{i-\\frac{1}{2}}^2 (\\phi_i - \\phi_{i-1}) \\right]\n$$\n其中 $v_{i\\pm\\frac{1}{2}} = v_i \\pm \\frac{\\Delta v}{2}$。将其重排为矩阵-向量乘积 $(L\\mathbf{\\phi})_i$ 的形式，我们确定 $L$ 的第 $i$ 行中的非零元素：\n$$\nL_{i, i-1} = \\frac{v_{i-\\frac{1}{2}}^2}{v_i^2 \\Delta v^2}\n$$\n$$\nL_{i, i} = -\\frac{v_{i+\\frac{1}{2}}^2 + v_{i-\\frac{1}{2}}^2}{v_i^2 \\Delta v^2}\n$$\n$$\nL_{i, i+1} = \\frac{v_{i+\\frac{1}{2}}^2}{v_i^2 \\Delta v^2}\n$$\n这定义了内部点对应的矩阵的三对角结构。\n\n在原点 $v_0=0$ 处，内部点公式是奇异的。物理正则性条件 $\\frac{d\\phi}{dv}(0)=0$ 导致了拉普拉斯算子在 $v \\to 0$ 极限下的特定形式。问题提供了相应的二阶精确离散化：\n$$\n(\\nabla_v^2 \\phi)_0 \\approx \\frac{6}{\\Delta v^2}(\\phi_1 - \\phi_0)\n$$\n这给出了矩阵 $L$ 第一行（$i=0$）的元素：\n$$\nL_{0, 0} = -\\frac{6}{\\Delta v^2}\n$$\n$$\nL_{0, 1} = \\frac{6}{\\Delta v^2}\n$$\n\n在外部边界 $v_{N-1} = V_{\\max}$ 处，偏微分方程被边界条件替代。这意味着矩阵 $L$ 的最后一行（$i=N-1$）以及右端向量 $\\mathbf{b}$ 的相应元素由指定的边界条件确定。\n对于狄利克雷条件 $\\phi(V_{\\max}) = 0$，我们强制施加 $\\phi_{N-1}=0$。最后一行的方程变得平凡：\n$$\nL_{N-1, N-1} = 1, \\quad \\text{且} \\quad b_{N-1} = 0\n$$\n对于 $j \\neq N-1$ 的所有其他元素 $L_{N-1, j}$ 均为零。\n对于齐次罗宾条件 $\\frac{d\\phi}{dv}(V_{\\max}) + \\alpha \\phi(V_{\\max}) = 0$，我们使用所提供的一阶后向差分近似：\n$$\n\\frac{\\phi_{N-1} - \\phi_{N-2}}{\\Delta v} + \\alpha \\phi_{N-1} = 0\n$$\n这转化为最后一行的以下矩阵元素：\n$$\nL_{N-1, N-2} = -\\frac{1}{\\Delta v}\n$$\n$$\nL_{N-1, N-1} = \\frac{1}{\\Delta v} + \\alpha\n$$\n右端项元素为 $b_{N-1} = 0$。\n\n在矩阵 $L$ 完全定义后，我们构造右端向量 $\\mathbf{b}_H$ 和 $\\mathbf{b}_G$。\n对于势 $H_b$，源项是 $-4\\pi f_b(v)$。构造向量 $\\mathbf{b}_H$，使其对于 $i=0, \\dots, N-2$ 的元素为 $b_{H,i} = -4\\pi f_b(v_i)$。最后一个元素 $b_{H, N-1}$ 被设置为 $0$，以与对 $L$ 的最后一行所做的边界条件修改保持一致。\n然后我们求解线性系统 $L\\mathbf{H} = \\mathbf{b}_H$ 来找到离散势 $\\mathbf{H} = \\{H_{b,i}\\}$。\n\n接下来，我们求解 $G_b$。$G_b$ 方程的源项是 $H_b(v)$。我们使用刚计算出的数值解 $\\mathbf{H}$ 作为源项。构造右端向量 $\\mathbf{b}_G$，使其对于 $i=0, \\dots, N-2$ 的元素为 $b_{G,i} = H_{b,i}$。和之前一样，$b_{G, N-1}$ 被设置为 $0$。然后我们求解第二个线性系统 $L\\mathbf{G} = \\mathbf{b}_G$ 来找到离散势 $\\mathbf{G} = \\{G_{b,i}\\}$。\n\n最后，计算所需的诊断指标。对于情况 A、B 和 D，使用线性求解器得到的矩阵 $L$ 和向量 $\\mathbf{b}_H$、$\\mathbf{b}_G$ 计算最大绝对离散残差 $R = \\max_i |(L\\mathbf{\\phi} - \\mathbf{b})_i|$，分别对 $\\mathbf{H}$ 和 $\\mathbf{G}$ 进行计算。这衡量了线性求解的数值精度。对于情况 C，其中解析解是已知的，诊断指标是最大绝对误差 $E = \\max_i |\\phi_i - \\phi_{\\text{exact}}(v_i)|$，这衡量了有限差分格式的离散化误差。所提供的代码为每个指定的测试用例实现了这整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n\n    def solve_case(N, V_max, bc_type, f_b, alpha=None, is_analytic_case=False):\n        \"\"\"\n        Solves the Rosenbluth potential equations for a single test case.\n\n        Args:\n            N (int): Number of grid points.\n            V_max (float): Maximum velocity in the domain.\n            bc_type (str): Type of boundary condition, 'dirichlet' or 'robin'.\n            f_b (callable): Background distribution function f_b(v).\n            alpha (float, optional): Parameter for Robin boundary condition.\n            is_analytic_case (bool): Flag for Case C to compute error instead of residual.\n\n        Returns:\n            tuple: A pair of diagnostic values (R_H, R_G) or (E_H, E_G).\n        \"\"\"\n        # 1. Setup grid\n        dv = V_max / (N - 1) if N > 1 else 0\n        v = np.linspace(0, V_max, N)\n\n        # 2. Assemble the discrete Laplacian matrix L\n        L = np.zeros((N, N))\n\n        # Row i=0 (origin)\n        if N > 1:\n            L[0, 0] = -6.0 / dv**2\n            L[0, 1] = 6.0 / dv**2\n        elif N == 1:\n            L[0,0] = 1.0 # Trivial case for N=1\n\n        # Rows i=1 to N-2 (interior)\n        for i in range(1, N - 1):\n            v_i = v[i]\n            v_minus_half = v_i - dv / 2.0\n            v_plus_half = v_i + dv / 2.0\n            \n            coeff = 1.0 / (v_i**2 * dv**2)\n            \n            L[i, i - 1] = coeff * v_minus_half**2\n            L[i, i + 1] = coeff * v_plus_half**2\n            L[i, i] = -coeff * (v_minus_half**2 + v_plus_half**2)\n\n        # Row i=N-1 (outer boundary)\n        if N > 1:\n            if bc_type == 'dirichlet':\n                L[N - 1, N - 1] = 1.0\n            elif bc_type == 'robin':\n                if alpha is None:\n                    raise ValueError(\"alpha must be provided for Robin boundary condition\")\n                L[N - 1, N - 2] = -1.0 / dv\n                L[N - 1, N - 1] = 1.0 / dv + alpha\n\n        # 3. Solve for H_b\n        f_b_vals = f_b(v)\n        b_H = -4.0 * np.pi * f_b_vals\n        \n        # Apply boundary conditions to the right-hand-side vector\n        if N > 0:\n            if bc_type == 'dirichlet':\n                b_H[N - 1] = 0.0\n            elif bc_type == 'robin':\n                b_H[N - 1] = 0.0\n        \n        if N == 1 and bc_type == 'dirichlet':\n             b_H[0] = 0.0\n\n        H = np.linalg.solve(L, b_H)\n\n        # 4. Solve for G_b\n        b_G = H.copy()  # Source for G is the solution H\n        \n        # Apply boundary conditions to the right-hand-side vector\n        if N > 0:\n            if bc_type == 'dirichlet':\n                b_G[N - 1] = 0.0\n            elif bc_type == 'robin':\n                b_G[N - 1] = 0.0\n        \n        if N == 1 and bc_type == 'dirichlet':\n             b_G[0] = 0.0\n\n        G = np.linalg.solve(L, b_G)\n\n        # 5. Calculate diagnostics\n        if is_analytic_case:\n            # Case C: Compute max absolute error against analytic solution\n            # With c = 1/(4*pi), the term 4*pi*c becomes 1.\n            H_exact = (1.0/6.0) * (V_max**2 - v**2)\n            # Full expression for G exact constant part: - (Vmax^4/6 - Vmax^4/20) = - Vmax^4 * (10-3)/60 = -7*Vmax^4/60.\n            # No, that's not right. C3 = -4pic/6 * (Vmax^4/6-Vmax^4/20) = -1/6 * (Vmax^4 * (10-3)/60) = -7*Vmax^4/360.\n            G_exact = (1.0/6.0) * ((v**2/6.0)*V_max**2 - v**4/20.0 - (V_max**4/6.0) + (V_max**4/20.0))\n\n            E_H = np.max(np.abs(H - H_exact))\n            E_G = np.max(np.abs(G - G_exact))\n            return E_H, E_G\n        else:\n            # Cases A, B, D: Compute max absolute discrete residual\n            R_H = np.max(np.abs(np.dot(L, H) - b_H))\n            R_G = np.max(np.abs(np.dot(L, G) - b_G))\n            return R_H, R_G\n\n    # Define test cases from the problem statement.\n    test_cases = [\n        {'id': 'A', 'N': 101, 'V_max': 4.0, 'bc_type': 'dirichlet', 'f_b': lambda v: np.exp(-v**2), 'analytic': False},\n        {'id': 'B', 'N': 51, 'V_max': 3.0, 'bc_type': 'robin', 'f_b': lambda v: v**2 * np.exp(-v), 'alpha': 1.0, 'analytic': False},\n        {'id': 'C', 'N': 81, 'V_max': 2.5, 'bc_type': 'dirichlet', 'f_b': lambda v: np.full_like(v, 1.0 / (4.0 * np.pi)), 'analytic': True},\n        {'id': 'D', 'N': 3, 'V_max': 1.0, 'bc_type': 'dirichlet', 'f_b': lambda v: np.exp(-v), 'analytic': False}\n    ]\n\n    results = []\n    for case in test_cases:\n        diag1, diag2 = solve_case(\n            N=case['N'],\n            V_max=case['V_max'],\n            bc_type=case['bc_type'],\n            f_b=case['f_b'],\n            alpha=case.get('alpha'),\n            is_analytic_case=case['analytic']\n        )\n        results.extend([diag1, diag2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}