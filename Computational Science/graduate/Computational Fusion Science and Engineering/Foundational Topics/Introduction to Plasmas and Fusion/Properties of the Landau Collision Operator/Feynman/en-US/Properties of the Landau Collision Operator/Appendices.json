{
    "hands_on_practices": [
        {
            "introduction": "The Landau collision operator is fundamentally defined through integrals over the particle distribution function. To make the problem computationally tractable, we reformulate this integral representation into a set of differential equations. This practice  guides you through the essential derivation of the Rosenbluth potential equations, transforming the velocity-space integrals into a system of coupled Poisson-type equations under the common assumption of axisymmetry. Mastering this transformation is key to understanding how kinetic simulation codes efficiently model Coulomb collisions.",
            "id": "4033040",
            "problem": "Consider a single-species ion distribution function $f(\\mathbf{v})$ in velocity space $\\mathbf{v} \\in \\mathbb{R}^{3}$, as used in computational models of Coulomb collisions in Magnetic Confinement Fusion (MCF). The Landau collision operator for test species interacting with field species can be expressed in terms of the Rosenbluth potentials $H(\\mathbf{v})$ and $G(\\mathbf{v})$, defined by the velocity-space integrals\n$$H(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} \\frac{f(\\mathbf{v}')}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}', \\qquad G(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\, |\\mathbf{v}-\\mathbf{v}'| \\,\\mathrm{d}^{3} \\mathbf{v}'.$$\nAssume the distribution function $f(\\mathbf{v})$ is axisymmetric about the background magnetic field direction $\\mathbf{B}$, so that $f$ depends only on the speed $v = |\\mathbf{v}|$ and the pitch-angle cosine $\\xi = \\cos \\theta = v_{\\parallel}/v$, where $\\theta$ is the polar angle measured from $\\mathbf{B}$ and $v_{\\parallel}$ is the velocity component parallel to $\\mathbf{B}$; there is no dependence on the azimuthal angle $\\phi$. Use only fundamental properties of the Laplacian in three dimensions and standard coordinate transformations to derive the governing equations and their transformation.\n\nStarting from the following foundational facts:\n- The three-dimensional Laplacian acting on the Newtonian Green’s function satisfies $\\nabla_{\\mathbf{v}}^{2}\\!\\left(\\frac{1}{|\\mathbf{v}-\\mathbf{v}'|}\\right) = -4\\pi \\,\\delta(\\mathbf{v}-\\mathbf{v}')$ and, for $|\\mathbf{v}-\\mathbf{v}'| \\neq 0$, $\\nabla_{\\mathbf{v}}^{2}\\!\\left(|\\mathbf{v}-\\mathbf{v}'|\\right) = \\frac{2}{|\\mathbf{v}-\\mathbf{v}'|}$.\n- The change of variables from Cartesian $(v_{x}, v_{y}, v_{z})$ to spherical-polar velocity coordinates $(v, \\theta, \\phi)$ with the pitch-angle cosine $\\xi = \\cos \\theta$.\n\nDerive the following, in order:\n1. The coupled Poisson-type equations satisfied by $H(\\mathbf{v})$ and $G(\\mathbf{v})$ in $\\mathbf{v}$-space.\n2. The explicit form of the velocity-space Laplacian $\\nabla_{\\mathbf{v}}^{2}$ acting on a scalar function that depends only on $(v,\\xi)$ under the axisymmetry assumption, expressed directly in the $(v,\\xi)$ variables.\n3. The transformed Rosenbluth Poisson equations for $H(v,\\xi)$ and $G(v,\\xi)$ written in $(v,\\xi)$, using the operator from part $2$.\n4. The physically appropriate boundary conditions for $H(v,\\xi)$ and $G(v,\\xi)$ in $(v,\\xi)$ coordinates that ensure regularity at $v=0$, decay as $v \\to \\infty$, and regularity at the pitch-angle endpoints $\\xi = \\pm 1$.\n\nExpress your final result as a single analytical expression that lists:\n- The $(v,\\xi)$ operator $\\nabla_{\\mathbf{v}}^{2}$ under axisymmetry,\n- The two transformed equations,\n- The three boundary-condition statements at $v \\to \\infty$, $v=0$, and $\\xi=\\pm 1$.\n\nNo numerical evaluation is required. Your final answer must be a single closed-form analytic expression.",
            "solution": "The problem statement is a well-posed and scientifically sound exercise in mathematical physics, specifically in the context of plasma kinetic theory. It asks for the derivation of the governing equations for the Rosenbluth potentials under an axisymmetry assumption, along with the associated boundary conditions. All provided definitions and identities are standard and correct. Therefore, the problem is valid, and a solution can be formulated.\n\nThe derivation proceeds in four sequential steps as outlined in the problem.\n\n### Step 1: Derivation of the Poisson-type Equations in $\\mathbf{v}$-space\n\nThe Rosenbluth potentials $H(\\mathbf{v})$ and $G(\\mathbf{v})$ are defined by:\n$$H(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{1}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n$$G(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\, |\\mathbf{v}-\\mathbf{v}'| \\,\\mathrm{d}^{3} \\mathbf{v}'$$\n\nWe apply the three-dimensional velocity-space Laplacian, $\\nabla_{\\mathbf{v}}^{2}$, to each potential. Since the differentiation is with respect to $\\mathbf{v}$ and the integration is over the dummy variable $\\mathbf{v}'$, the operator can be moved inside the integral.\n\nFor the potential $H(\\mathbf{v})$:\n$$\\nabla_{\\mathbf{v}}^{2} H(\\mathbf{v}) = \\nabla_{\\mathbf{v}}^{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{1}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}' = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\nabla_{\\mathbf{v}}^{2} \\left(\\frac{1}{|\\mathbf{v}-\\mathbf{v}'|}\\right) \\,\\mathrm{d}^{3} \\mathbf{v}'$$\nUsing the provided identity for the Laplacian of the Green's function, $\\nabla_{\\mathbf{v}}^{2} (|\\mathbf{v}-\\mathbf{v}'|^{-1}) = -4\\pi \\, \\delta(\\mathbf{v}-\\mathbf{v}')$, we get:\n$$\\nabla_{\\mathbf{v}}^{2} H(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') (-4\\pi \\, \\delta(\\mathbf{v}-\\mathbf{v}')) \\,\\mathrm{d}^{3} \\mathbf{v}'$$\nBy the sifting property of the Dirac delta function, the integral evaluates to the function $f(\\mathbf{v})$ multiplied by $-4\\pi$.\n$$\\nabla_{\\mathbf{v}}^{2} H(\\mathbf{v}) = -4\\pi f(\\mathbf{v})$$\nThis is the Poisson equation for the potential $H(\\mathbf{v})$.\n\nFor the potential $G(\\mathbf{v})$:\n$$\\nabla_{\\mathbf{v}}^{2} G(\\mathbf{v}) = \\nabla_{\\mathbf{v}}^{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\, |\\mathbf{v}-\\mathbf{v}'| \\,\\mathrm{d}^{3} \\mathbf{v}' = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\nabla_{\\mathbf{v}}^{2} (|\\mathbf{v}-\\mathbf{v}'|) \\,\\mathrm{d}^{3} \\mathbf{v}'$$\nUsing the second provided identity, $\\nabla_{\\mathbf{v}}^{2} (|\\mathbf{v}-\\mathbf{v}'|) = 2/|\\mathbf{v}-\\mathbf{v}'|$ (for $\\mathbf{v} \\neq \\mathbf{v}'$), which holds for the integration, we have:\n$$\\nabla_{\\mathbf{v}}^{2} G(\\mathbf{v}) = \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{2}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}'$$\nRecognizing that the integral is $2$ times the definition of $H(\\mathbf{v})$:\n$$\\nabla_{\\mathbf{v}}^{2} G(\\mathbf{v}) = 2 \\int_{\\mathbb{R}^{3}} f(\\mathbf{v}') \\frac{1}{|\\mathbf{v}-\\mathbf{v}'|} \\,\\mathrm{d}^{3} \\mathbf{v}' = 2 H(\\mathbf{v})$$\nThis is the second Poisson-type equation, which couples $G(\\mathbf{v})$ to $H(\\mathbf{v})$.\n\n### Step 2: Velocity-Space Laplacian in $(v, \\xi)$ Coordinates\n\nThe Laplacian operator in three-dimensional spherical-polar coordinates $(v, \\theta, \\phi)$ acting on a scalar function $\\Psi(v, \\theta, \\phi)$ is:\n$$\\nabla_{\\mathbf{v}}^{2}\\Psi = \\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial \\Psi}{\\partial v} \\right) + \\frac{1}{v^{2}\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial \\Psi}{\\partial \\theta} \\right) + \\frac{1}{v^{2}\\sin^{2}\\theta} \\frac{\\partial^{2} \\Psi}{\\partial \\phi^{2}}$$\nUnder the axisymmetry assumption, the functions $f$, $H$, and $G$ do not depend on the azimuthal angle $\\phi$, so $\\partial \\Psi / \\partial \\phi = 0$ and the last term vanishes. The functions depend on $(v, \\xi)$, where $\\xi = \\cos\\theta$. We must transform the $\\theta$-derivative term to a $\\xi$-derivative term.\nThe chain rule for derivatives with respect to $\\theta$ gives:\n$$\\frac{\\partial}{\\partial \\theta} = \\frac{\\mathrm{d}\\xi}{\\mathrm{d}\\theta} \\frac{\\partial}{\\partial \\xi} = (-\\sin\\theta) \\frac{\\partial}{\\partial \\xi}$$\nLet's transform the angular part of the Laplacian:\n$$\\frac{1}{\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial \\Psi}{\\partial \\theta} \\right) = \\frac{1}{\\sin\\theta} \\left( (-\\sin\\theta)\\frac{\\partial}{\\partial \\xi} \\right) \\left( \\sin\\theta \\left( (-\\sin\\theta)\\frac{\\partial \\Psi}{\\partial \\xi} \\right) \\right)$$\n$$= -\\frac{\\partial}{\\partial \\xi} \\left( -\\sin^{2}\\theta \\frac{\\partial \\Psi}{\\partial \\xi} \\right) = \\frac{\\partial}{\\partial \\xi} \\left( \\sin^{2}\\theta \\frac{\\partial \\Psi}{\\partial \\xi} \\right)$$\nUsing the identity $\\sin^{2}\\theta = 1 - \\cos^{2}\\theta = 1 - \\xi^{2}$, we obtain the Legendre operator:\n$$\\frac{1}{\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial \\Psi}{\\partial \\theta} \\right) = \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial \\Psi}{\\partial \\xi} \\right)$$\nSubstituting this back into the expression for the Laplacian, for any axisymmetric scalar function $\\Psi(v, \\xi)$, we have:\n$$\\nabla_{\\mathbf{v}}^{2}\\Psi(v, \\xi) = \\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial \\Psi}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial \\Psi}{\\partial \\xi} \\right)$$\n\n### Step 3: Transformed Rosenbluth Equations in $(v, \\xi)$ Coordinates\n\nWe now substitute the operator derived in Step 2 into the equations from Step 1. The potentials $H$ and $G$ and the distribution function $f$ are now functions of $(v, \\xi)$.\nThe Poisson equation for $H(v, \\xi)$ becomes:\n$$\\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial H}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial H}{\\partial \\xi} \\right) = -4\\pi f(v, \\xi)$$\nThe Poisson-type equation for $G(v, \\xi)$ becomes:\n$$\\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial G}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial G}{\\partial \\xi} \\right) = 2 H(v, \\xi)$$\n\n### Step 4: Physically Appropriate Boundary Conditions\n\nThe boundary conditions are determined by physical regularity and the behavior of the potentials at the boundaries of the $(v, \\xi)$ domain. The domain is $v \\in [0, \\infty)$ and $\\xi \\in [-1, 1]$.\n\n1.  **As $v \\to \\infty$**: The distribution function $f(\\mathbf{v}')$ is localized, so for large $v=|\\mathbf{v}|$, we can use a multipole expansion.\n    $|\\mathbf{v}-\\mathbf{v}'|^{-1} \\approx 1/v$. So $H(\\mathbf{v}) \\approx \\frac{1}{v} \\int f(\\mathbf{v}') \\mathrm{d}^3\\mathbf{v}' \\propto 1/v$.\n    $|\\mathbf{v}-\\mathbf{v}'| \\approx v$. So $G(\\mathbf{v}) \\approx v \\int f(\\mathbf{v}') \\mathrm{d}^3\\mathbf{v}' \\propto v$.\n    The asymptotic behavior is thus $H \\sim \\mathcal{O}(v^{-1})$ and $G \\sim \\mathcal{O}(v)$. This implies $H \\to 0$ as $v \\to \\infty$.\n\n2.  **At $v=0$**: For the potentials $H$ and $G$ to be regular at the origin of velocity space, their spatial gradient must vanish, i.e., $\\nabla_{\\mathbf{v}} H|_{\\mathbf{v}=0} = \\mathbf{0}$ and $\\nabla_{\\mathbf{v}} G|_{\\mathbf{v}=0} = \\mathbf{0}$. If the gradient were non-zero, it would introduce a preferred direction at the origin, which is inconsistent with the scalar nature of the potentials at that point. A non-zero gradient would also lead to a singular term proportional to $1/v$ in the Laplacian operator, invalidating the equations at the origin. This implies that the radial derivatives must be zero.\n    $$\\left.\\frac{\\partial H}{\\partial v}\\right|_{v=0} = 0, \\qquad \\left.\\frac{\\partial G}{\\partial v}\\right|_{v=0} = 0$$\n\n3.  **At $\\xi = \\pm 1$**: These points correspond to the axis of symmetry ($\\theta=0, \\pi$). For the potentials to be smooth functions on this axis, they must be locally even functions of the perpendicular velocity component $v_{\\perp}$. This implies that derivatives with respect to coordinates perpendicular to the axis vanish on the axis. It follows that $\\partial H/\\partial \\theta = 0$ and $\\partial G/\\partial \\theta = 0$ at $\\theta=0, \\pi$. Since $\\partial/\\partial\\xi = (-\\sin\\theta)^{-1} \\partial/\\partial\\theta$, this implies that $\\partial H/\\partial \\xi$ and $\\partial G/\\partial \\xi$ must be finite at $\\xi = \\pm 1$. This ensures that the \"flux\" term in the Legendre operator, $(1-\\xi^2)\\partial\\Psi/\\partial\\xi$, vanishes at the boundaries $\\xi=\\pm 1$.\n    $$\\left.(1-\\xi^2)\\frac{\\partial H}{\\partial \\xi}\\right|_{\\xi=\\pm 1} = 0, \\qquad \\left.(1-\\xi^2)\\frac{\\partial G}{\\partial \\xi}\\right|_{\\xi=\\pm 1} = 0$$\n\nThese four steps complete the derivation requested in the problem statement.",
            "answer": "$$\n\\boxed{\n\\begin{gathered}\n\\text{Axisymmetric Laplacian Operator in } (v,\\xi) \\text{ coordinates:} \\\\\n\\nabla_{\\mathbf{v}}^{2} \\equiv \\frac{1}{v^{2}} \\frac{\\partial}{\\partial v} \\left( v^{2} \\frac{\\partial}{\\partial v} \\right) + \\frac{1}{v^{2}} \\frac{\\partial}{\\partial \\xi} \\left( (1-\\xi^{2}) \\frac{\\partial}{\\partial \\xi} \\right) \\\\\n\\\\\n\\text{Transformed Rosenbluth Equations:} \\\\\n\\nabla_{\\mathbf{v}}^{2} H(v, \\xi) = -4\\pi f(v, \\xi) \\\\\n\\nabla_{\\mathbf{v}}^{2} G(v, \\xi) = 2 H(v, \\xi) \\\\\n\\\\\n\\text{Boundary Conditions:} \\\\\n\\text{As } v \\to \\infty: \\quad H(v, \\xi) \\sim \\mathcal{O}(v^{-1}), \\quad G(v, \\xi) \\sim \\mathcal{O}(v) \\\\\n\\text{At } v=0: \\quad \\left.\\frac{\\partial H}{\\partial v}\\right|_{v=0} = 0, \\quad \\left.\\frac{\\partial G}{\\partial v}\\right|_{v=0} = 0 \\\\\n\\text{At } \\xi=\\pm 1: \\quad \\lim_{\\xi \\to \\pm 1} \\left( (1-\\xi^{2})\\frac{\\partial H}{\\partial \\xi} \\right) = 0, \\quad \\lim_{\\xi \\to \\pm 1} \\left( (1-\\xi^{2})\\frac{\\partial G}{\\partial \\xi} \\right) = 0\n\\end{gathered}\n}\n$$"
        },
        {
            "introduction": "A powerful technique for analyzing complex operators is to study their action on a well-chosen basis. In this exercise , you will explore the spectral properties of the pitch-angle scattering component of the Landau operator by expanding the distribution function in a basis of Legendre polynomials. This process reveals that the operator becomes diagonal in this basis, a critical insight that simplifies both analytical models and the design of efficient numerical solvers.",
            "id": "4033086",
            "problem": "Consider a single-species magnetized plasma in the weakly coupled, small-angle Coulomb collision regime, so that the slow collisional relaxation of the velocity-space distribution function is governed by the Landau form of the Fokker–Planck (FP) operator. Under the assumption that energy diffusion and dynamical friction are negligible compared to pitch-angle scattering at fixed speed, the pitch-angle scattering operator acting on the distribution function can be modeled by an angular diffusion operator at fixed speed $v$, written as:\n$$C_{\\mathrm{pa}}[f](v,\\xi)=\\nu_{D}(v)\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f(v,\\xi)}{\\partial \\xi}\\right]$$\nwhere $\\xi=\\cos\\theta$ is the pitch-angle cosine and $\\nu_{D}(v)$ is the deflection frequency arising from Coulomb scattering on a stationary Maxwellian background. Assume $\\nu_{D}(v)$ is a positive, smooth function of $v$.\n\nExpand the distribution function in Legendre polynomials $P_{l}(\\xi)$ as:\n$$f(v,\\xi)=\\sum_{l=0}^{\\infty}f_{l}(v)\\,P_{l}(\\xi)$$\nwith the standard orthogonality:\n$$\\int_{-1}^{1}P_{l}(\\xi)P_{l'}(\\xi)\\,d\\xi=\\frac{2}{2l+1}\\,\\delta_{ll'}$$\nDefine the spectral projection of $C_{\\mathrm{pa}}[f]$ onto the $l$-th Legendre mode as:\n$$(C_{\\mathrm{pa}}f)_{l}(v)\\equiv\\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\,C_{\\mathrm{pa}}[f](v,\\xi)\\,d\\xi$$\nand define the matrix elements $M_{ll'}(v)$ by:\n$$(C_{\\mathrm{pa}}f)_{l}(v)=\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v)$$\n\nStarting from the above physical modeling assumptions and the fundamental properties of Legendre polynomials implied by rotational symmetry on the unit sphere, derive the closed-form expression for the matrix elements $M_{ll'}(v)$ as a function of $l$, $l'$, and $v$. Your answer must be a single closed-form analytic expression. No numerical evaluation is required and no rounding is permitted. Express your final answer without units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Pitch-Angle Scattering Operator**: $C_{\\mathrm{pa}}[f](v,\\xi)=\\nu_{D}(v)\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial f(v,\\xi)}{\\partial \\xi}\\right]$, where $\\xi = \\cos\\theta$.\n- **Deflection Frequency**: $\\nu_{D}(v)$ is a positive, smooth function of speed $v$.\n- **Distribution Function Expansion**: $f(v,\\xi)=\\sum_{l=0}^{\\infty}f_{l}(v)\\,P_{l}(\\xi)$, where $P_l(\\xi)$ are the Legendre polynomials.\n- **Orthogonality of Legendre Polynomials**: $\\int_{-1}^{1}P_{l}(\\xi)P_{l'}(\\xi)\\,d\\xi=\\frac{2}{2l+1}\\,\\delta_{ll'}$.\n- **Spectral Projection Definition**: $(C_{\\mathrm{pa}}f)_{l}(v)\\equiv\\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\,C_{\\mathrm{pa}}[f](v,\\xi)\\,d\\xi$.\n- **Matrix Element Definition**: $(C_{\\mathrm{pa}}f)_{l}(v)=\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v)$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem describes the pitch-angle scattering component of the Landau-Fokker-Planck collision operator, a standard and fundamental model in plasma kinetic theory. The use of Legendre polynomials to analyze such an operator is a well-established technique in transport theory. The model is a valid and widely used approximation.\n- **Well-Posedness**: The problem is well-posed. It asks for the matrix elements of a linear operator in a given complete basis. All necessary definitions and mathematical properties (operator form, basis expansion, orthogonality) are provided, allowing for a unique solution to be derived.\n- **Objectivity**: The problem is stated using precise mathematical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, self-contained, and well-posed. It is deemed **valid**. The derivation of the solution can proceed.\n\nOur objective is to find the closed-form expression for the matrix elements $M_{ll'}(v)$. We begin by inserting the Legendre expansion of the distribution function $f(v,\\xi)$ into the expression for the pitch-angle scattering operator $C_{\\mathrm{pa}}[f]$.\nThe speed $v$ acts as a parameter in the operations involving the pitch-angle cosine $\\xi$.\n\n$C_{\\mathrm{pa}}[f](v,\\xi) = \\nu_{D}(v)\\,\\frac{\\partial}{\\partial \\xi}\\!\\left[\\left(1-\\xi^{2}\\right)\\frac{\\partial}{\\partial \\xi} \\left( \\sum_{l'=0}^{\\infty}f_{l'}(v)\\,P_{l'}(\\xi) \\right) \\right]$.\n\nSince the summation and the partial derivatives with respect to $\\xi$ are linear operations, and the coefficients $f_{l'}(v)$ are independent of $\\xi$, we can interchange the order of summation and differentiation:\n\n$C_{\\mathrm{pa}}[f](v,\\xi) = \\nu_{D}(v) \\sum_{l'=0}^{\\infty} f_{l'}(v) \\left( \\frac{d}{d\\xi}\\left[\\left(1-\\xi^{2}\\right)\\frac{d P_{l'}(\\xi)}{d\\xi}\\right] \\right)$.\n\nThe expression within the parentheses is the Legendre differential operator acting on the Legendre polynomial $P_{l'}(\\xi)$. The Legendre polynomials are, by definition, the eigenfunctions of this operator. The Legendre differential equation is:\n$\\frac{d}{d\\xi}\\left[\\left(1-\\xi^{2}\\right)\\frac{d y}{d\\xi}\\right] + l(l+1)y = 0$.\n\nFor $y = P_{l'}(\\xi)$, this gives the eigenvalue relation:\n$\\frac{d}{d\\xi}\\left[\\left(1-\\xi^{2}\\right)\\frac{d P_{l'}(\\xi)}{d\\xi}\\right] = -l'(l'+1)P_{l'}(\\xi)$.\n\nSubstituting this result back into the expression for $C_{\\mathrm{pa}}[f](v,\\xi)$, we find:\n\n$C_{\\mathrm{pa}}[f](v,\\xi) = \\nu_{D}(v) \\sum_{l'=0}^{\\infty} f_{l'}(v) [-l'(l'+1)P_{l'}(\\xi)] = -\\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v)P_{l'}(\\xi)$.\n\nThis shows that the action of the operator $C_{\\mathrm{pa}}$ on the expansion of $f$ results in another series of Legendre polynomials, where each coefficient $f_{l'}(v)$ is simply multiplied by a factor of $-\\nu_{D}(v)l'(l'+1)$.\n\nNext, we compute the spectral projection $(C_{\\mathrm{pa}}f)_{l}(v)$ using its definition:\n$(C_{\\mathrm{pa}}f)_{l}(v) = \\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\,C_{\\mathrm{pa}}[f](v,\\xi)\\,d\\xi$.\n\nSubstitute the series form of $C_{\\mathrm{pa}}[f](v,\\xi)$ into this integral:\n$(C_{\\mathrm{pa}}f)_{l}(v) = \\frac{2l+1}{2}\\int_{-1}^{1}P_{l}(\\xi)\\left( -\\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v)P_{l'}(\\xi) \\right)\\,d\\xi$.\n\nThe terms $-\\nu_{D}(v)$, $l'(l'+1)$, and $f_{l'}(v)$ are constant with respect to the integration variable $\\xi$. We can thus move them, along with the summation, outside the integral:\n$(C_{\\mathrm{pa}}f)_{l}(v) = -\\frac{2l+1}{2} \\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v) \\int_{-1}^{1} P_{l}(\\xi)P_{l'}(\\xi) \\,d\\xi$.\n\nNow, we use the orthogonality property of the Legendre polynomials, $\\int_{-1}^{1}P_{l}(\\xi)P_{l'}(\\xi)\\,d\\xi=\\frac{2}{2l+1}\\,\\delta_{ll'}$, where $\\delta_{ll'}$ is the Kronecker delta.\n\n$(C_{\\mathrm{pa}}f)_{l}(v) = -\\frac{2l+1}{2} \\nu_{D}(v) \\sum_{l'=0}^{\\infty} l'(l'+1)f_{l'}(v) \\left( \\frac{2}{2l'+1}\\,\\delta_{ll'} \\right)$.\n\nThe Kronecker delta $\\delta_{ll'}$ is zero for all $l' \\neq l$ and one for $l'=l$. This property causes the infinite sum to collapse to a single term corresponding to $l'=l$. In this term, we must replace every instance of $l'$ with $l$.\n\n$(C_{\\mathrm{pa}}f)_{l}(v) = -\\frac{2l+1}{2} \\nu_{D}(v) \\left( l(l+1)f_{l}(v) \\frac{2}{2l+1} \\right)$.\n\nThe factors of $\\frac{2l+1}{2}$ and $\\frac{2}{2l+1}$ cancel out, simplifying the expression to:\n$(C_{\\mathrm{pa}}f)_{l}(v) = -l(l+1)\\nu_{D}(v)f_{l}(v)$.\n\nFinally, we compare this result with the definition of the matrix elements $M_{ll'}(v)$:\n$(C_{\\mathrm{pa}}f)_{l}(v)=\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v)$.\n\nWe have derived that $(C_{\\mathrm{pa}}f)_{l}(v)$ is proportional only to $f_l(v)$. To make the comparison explicit, we can write our result using a Kronecker delta:\n$-l(l+1)\\nu_{D}(v)f_{l}(v) = \\sum_{l'=0}^{\\infty} [-l(l+1)\\nu_{D}(v)\\delta_{ll'}] f_{l'}(v)$.\nNote that we can replace $l$ inside the brackets with $l'$ since the term is non-zero only when $l'=l$:\n$\\sum_{l'=0}^{\\infty} [-l'(l'+1)\\nu_{D}(v)\\delta_{ll'}] f_{l'}(v)$. However, for identifying $M_{ll'}$, the first form is more direct.\n\nBy comparing the coefficients of $f_{l'}(v)$ in the two expressions for $(C_{\\mathrm{pa}}f)_{l}(v)$, we identify the matrix elements:\n$\\sum_{l'=0}^{\\infty}M_{ll'}(v)\\,f_{l'}(v) = \\sum_{l'=0}^{\\infty} [-l(l+1)\\nu_{D}(v)\\delta_{ll'}] f_{l'}(v)$.\n\nThis relation must hold for any arbitrary set of coefficients $f_{l'}(v)$, which implies that the terms inside the sums must be equal for each $l'$. This gives the closed-form expression for the matrix elements:\n$M_{ll'}(v) = -l(l+1)\\nu_{D}(v)\\delta_{ll'}$.\n\nThis result shows that the pitch-angle scattering operator $C_{\\mathrm{pa}}$ is diagonal in the basis of Legendre polynomials, with the eigenvalues being $-l(l+1)\\nu_{D}(v)$.\nFor $l=0$, $M_{0l'}(v) = 0$, which reflects the physical principle of particle number conservation by the collision operator, as the $l=0$ mode is proportional to the particle density at a given speed.",
            "answer": "$$\\boxed{-l(l+1)\\nu_{D}(v)\\delta_{ll'}}$$"
        },
        {
            "introduction": "After deriving the continuous form of the Rosenbluth potential equations, the next step is to solve them computationally. This practice  transitions from pure theory to numerical implementation, tasking you with building a finite-difference solver for the potentials in the simplified, yet important, isotropic case. By translating the differential equations into a linear system and solving it, you will develop practical skills in numerical discretization, boundary condition implementation, and code verification.",
            "id": "4033041",
            "problem": "Consider the isotropic Rosenbluth potentials of the Landau collision operator for a background species with distribution function $f_b(v)$ in velocity space. In the isotropic case, the Rosenbluth potentials $H_b(v)$ and $G_b(v)$ satisfy the velocity-space Poisson problems on a bounded spherical domain $v \\in [0, V_{\\max}]$:\n$$\n\\nabla_v^2 H_b(v) = -4\\pi f_b(v), \\quad \\nabla_v^2 G_b(v) = H_b(v),\n$$\nwhere the Laplacian in spherical symmetry reduces to\n$$\n\\nabla_v^2 \\phi(v) \\equiv \\frac{1}{v^2}\\frac{d}{dv}\\!\\left(v^2 \\frac{d\\phi}{dv}\\right),\n$$\nfor any sufficiently smooth isotropic scalar field $\\phi(v)$. The variables $v$, $V_{\\max}$, $H_b$, $G_b$, and $f_b$ are dimensionless, with velocity normalized by the species thermal speed so that all numerical outputs are dimensionless.\n\nImpose the following boundary conditions:\n- Regularity at $v=0$: the physical requirement of finite potentials implies $\\frac{dH_b}{dv}(0)=0$ and $\\frac{dG_b}{dv}(0)=0$.\n- At $v=V_{\\max}$, use either Dirichlet boundary conditions $H_b(V_{\\max})=0$, $G_b(V_{\\max})=0$, or homogeneous Robin boundary conditions $\\frac{dH_b}{dv}(V_{\\max})+\\alpha H_b(V_{\\max})=0$ and $\\frac{dG_b}{dv}(V_{\\max})+\\alpha G_b(V_{\\max})=0$, with a given positive parameter $\\alpha$.\n\nStarting from these definitions and boundary conditions, derive second-order accurate, finite-difference discrete equations on a uniform grid $v_i = i\\,\\Delta v$, $i=0,1,\\dots,N-1$, where $\\Delta v = V_{\\max}/(N-1)$, for both $H_b$ and $G_b$:\n- For interior points $i=1,2,\\dots,N-2$, discretize the operator in conservative divergence form,\n$$\n\\left(\\nabla_v^2 \\phi\\right)_i \\approx \\frac{1}{v_i^2}\\,\\frac{1}{\\Delta v}\\left[ v_{i+\\frac{1}{2}}^2\\,\\frac{\\phi_{i+1}-\\phi_i}{\\Delta v} - v_{i-\\frac{1}{2}}^2\\,\\frac{\\phi_i-\\phi_{i-1}}{\\Delta v} \\right],\n$$\nwith $v_{i\\pm \\frac{1}{2}} \\equiv v_i \\pm \\frac{\\Delta v}{2}$.\n- At $i=0$, enforce regularity via the $v\\to 0$ limit,\n$$\n\\left(\\nabla_v^2 \\phi\\right)_0 \\approx \\frac{6}{\\Delta v^2}\\left(\\phi_1 - \\phi_0\\right),\n$$\nwhich follows from the limit $v\\to 0$ of $\\nabla_v^2 \\phi = \\frac{1}{v^2}\\frac{d}{dv}(v^2 \\phi')$ and the symmetry condition $\\phi'(0)=0$.\n- At $i=N-1$, impose either Dirichlet via $\\phi_{N-1}=0$ or homogeneous Robin via\n$$\n\\frac{\\phi_{N-1}-\\phi_{N-2}}{\\Delta v} + \\alpha\\,\\phi_{N-1} = 0.\n$$\n\nForm the discrete linear system $L\\,\\mathbf{H} = \\mathbf{b}_H$ for $\\mathbf{H} \\equiv \\{H_{b,i}\\}$ and $L\\,\\mathbf{G} = \\mathbf{b}_G$ for $\\mathbf{G} \\equiv \\{G_{b,i}\\}$, where $L$ encodes the above discretization of $\\nabla_v^2$, $\\mathbf{b}_H$ encodes $-4\\pi f_b(v_i)$ with boundary-row modifications consistent with the chosen boundary condition, and $\\mathbf{b}_G$ encodes $H_{b,i}$ with the same boundary-row modifications. Your program must assemble $L$, solve both systems, and report quantitative diagnostics.\n\nTest suite. Use the following parameter sets to exercise different aspects of the solver; all velocities and outputs are dimensionless:\n- Case $\\mathrm{A}$ (happy path): $N=101$, $V_{\\max}=4$, Dirichlet at $v=V_{\\max}$, $f_b(v)=\\exp(-v^2)$.\n- Case $\\mathrm{B}$ (Robin boundary): $N=51$, $V_{\\max}=3$, Robin at $v=V_{\\max}$ with $\\alpha=1$, $f_b(v)=v^2\\exp(-v)$.\n- Case $\\mathrm{C}$ (analytic verification): $N=81$, $V_{\\max}=2.5$, Dirichlet at $v=V_{\\max}$, constant $f_b(v)=c$ with $c=\\frac{1}{4\\pi}$ so that the source $-4\\pi f_b(v)$ equals $-1$. In this case, the exact solutions are\n$$\nH_b(v)=\\frac{4\\pi c}{6}\\left(V_{\\max}^2 - v^2\\right),\\quad\nG_b(v)=\\frac{4\\pi c}{6}\\left(\\frac{v^2}{6}V_{\\max}^2 - \\frac{v^4}{20} - \\frac{V_{\\max}^4}{6} + \\frac{V_{\\max}^4}{20}\\right),\n$$\nobtained by integrating the radial Poisson problem with regularity at $v=0$ and Dirichlet at $v=V_{\\max}$.\n- Case $\\mathrm{D}$ (coarse-grid edge case): $N=3$, $V_{\\max}=1$, Dirichlet at $v=V_{\\max}$, $f_b(v)=\\exp(-v)$.\n\nFor Cases $\\mathrm{A}$, $\\mathrm{B}$, and $\\mathrm{D}$, compute the maximum absolute discrete residuals\n$$\nR_H \\equiv \\max_i \\left| (L\\mathbf{H} - \\mathbf{b}_H)_i \\right|,\\quad R_G \\equiv \\max_i \\left| (L\\mathbf{G} - \\mathbf{b}_G)_i \\right|.\n$$\nFor Case $\\mathrm{C}$, compute the maximum absolute errors relative to the analytic solutions,\n$$\nE_H \\equiv \\max_i \\left| H_{b,i} - H_b^{\\mathrm{exact}}(v_i) \\right|,\\quad E_G \\equiv \\max_i \\left| G_{b,i} - G_b^{\\mathrm{exact}}(v_i) \\right|.\n$$\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n[R_H^{\\mathrm{A}}, R_G^{\\mathrm{A}}, R_H^{\\mathrm{B}}, R_G^{\\mathrm{B}}, E_H^{\\mathrm{C}}, E_G^{\\mathrm{C}}, R_H^{\\mathrm{D}}, R_G^{\\mathrm{D}}].\n$$\nAll entries must be decimal numbers. Angles are not involved, so no angle unit is required. No physical units appear because of the chosen normalization.",
            "solution": "The problem requires the numerical solution of a pair of coupled Poisson-like equations in one spatial dimension (velocity magnitude $v$) for the isotropic Rosenbluth potentials, $H_b(v)$ and $G_b(v)$. These potentials are central to the evaluation of the Landau collision operator in plasma physics. The governing equations are:\n$$\n\\nabla_v^2 H_b(v) = -4\\pi f_b(v)\n$$\n$$\n\\nabla_v^2 G_b(v) = H_b(v)\n$$\non a bounded domain $v \\in [0, V_{\\max}]$. Due to spherical symmetry, the Laplacian operator simplifies to $\\nabla_v^2 \\phi(v) = \\frac{1}{v^2}\\frac{d}{dv}(v^2 \\frac{d\\phi}{dv})$.\n\nThe solution strategy involves discretizing these partial differential equations using a finite-difference method on a uniform grid, which transforms the differential equations into a system of linear algebraic equations, $L\\mathbf{\\phi} = \\mathbf{b}$, where $\\mathbf{\\phi}$ represents the solution vector on the grid points. This system is then solved for $\\mathbf{H}$ (the vector of $H_{b,i}$ values) and subsequently for $\\mathbf{G}$ (the vector of $G_{b,i}$ values).\n\nFirst, we establish the discrete domain. A uniform grid in velocity $v$ is defined as $v_i = i \\cdot \\Delta v$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $\\Delta v = V_{\\max} / (N-1)$. The solution vectors $\\mathbf{H}$ and $\\mathbf{G}$ will have $N$ components, representing the values of the potentials at these grid points.\n\nThe core of the method is the construction of the discrete Laplacian matrix, $L$. This $N \\times N$ matrix represents the linear operator $\\nabla_v^2$. We construct it row by row, with each row corresponding to a grid point $v_i$.\n\nFor an interior grid point $v_i$ where $i \\in \\{1, 2, \\dots, N-2\\}$, the problem provides a second-order accurate conservative finite-difference approximation:\n$$\n(\\nabla_v^2 \\phi)_i \\approx \\frac{1}{v_i^2 \\Delta v^2} \\left[ v_{i+\\frac{1}{2}}^2 (\\phi_{i+1} - \\phi_i) - v_{i-\\frac{1}{2}}^2 (\\phi_i - \\phi_{i-1}) \\right]\n$$\nwhere $v_{i\\pm\\frac{1}{2}} = v_i \\pm \\frac{\\Delta v}{2}$. Rearranging this into the form of a matrix-vector product $(L\\mathbf{\\phi})_i$, we identify the non-zero elements in the $i$-th row of $L$:\n$$\nL_{i, i-1} = \\frac{v_{i-\\frac{1}{2}}^2}{v_i^2 \\Delta v^2}\n$$\n$$\nL_{i, i} = -\\frac{v_{i+\\frac{1}{2}}^2 + v_{i-\\frac{1}{2}}^2}{v_i^2 \\Delta v^2}\n$$\n$$\nL_{i, i+1} = \\frac{v_{i+\\frac{1}{2}}^2}{v_i^2 \\Delta v^2}\n$$\nThis defines the tridiagonal structure of the matrix for the interior points.\n\nAt the origin, $v_0=0$, the interior formula is singular. The physical regularity condition, $\\frac{d\\phi}{dv}(0)=0$, leads to a specific form for the Laplacian in the limit $v \\to 0$. The problem provides the corresponding second-order accurate discretization:\n$$\n(\\nabla_v^2 \\phi)_0 \\approx \\frac{6}{\\Delta v^2}(\\phi_1 - \\phi_0)\n$$\nThis gives the elements for the first row ($i=0$) of the matrix $L$:\n$$\nL_{0, 0} = -\\frac{6}{\\Delta v^2}\n$$\n$$\nL_{0, 1} = \\frac{6}{\\Delta v^2}\n$$\n\nAt the outer boundary, $v_{N-1} = V_{\\max}$, the PDE is replaced by a boundary condition. This means the last row ($i=N-1$) of the matrix $L$ and the corresponding element of the right-hand-side vector $\\mathbf{b}$ are determined by the specified boundary condition.\nFor a Dirichlet condition, $\\phi(V_{\\max}) = 0$, we enforce $\\phi_{N-1}=0$. The equation for the last row becomes trivial:\n$$\nL_{N-1, N-1} = 1, \\quad \\text{and} \\quad b_{N-1} = 0\n$$\nAll other elements $L_{N-1, j}$ for $j \\neq N-1$ are zero.\nFor a homogeneous Robin condition, $\\frac{d\\phi}{dv}(V_{\\max}) + \\alpha \\phi(V_{\\max}) = 0$, we use the provided first-order backward-difference approximation:\n$$\n\\frac{\\phi_{N-1} - \\phi_{N-2}}{\\Delta v} + \\alpha \\phi_{N-1} = 0\n$$\nThis translates to the following matrix elements for the last row:\n$$\nL_{N-1, N-2} = -\\frac{1}{\\Delta v}\n$$\n$$\nL_{N-1, N-1} = \\frac{1}{\\Delta v} + \\alpha\n$$\nThe right-hand-side element is $b_{N-1} = 0$.\n\nWith the matrix $L$ fully defined, we construct the right-hand-side vectors $\\mathbf{b}_H$ and $\\mathbf{b}_G$.\nFor the potential $H_b$, the source term is $-4\\pi f_b(v)$. The vector $\\mathbf{b}_H$ is constructed such that for $i=0, \\dots, N-2$, its elements are $b_{H,i} = -4\\pi f_b(v_i)$. The last element, $b_{H, N-1}$, is set to $0$ to be consistent with the boundary condition modifications made to the last row of $L$.\nWe then solve the linear system $L\\mathbf{H} = \\mathbf{b}_H$ to find the discrete potential $\\mathbf{H} = \\{H_{b,i}\\}$.\n\nNext, we solve for $G_b$. The source term for the $G_b$ equation is $H_b(v)$. We use the just-computed numerical solution $\\mathbf{H}$ as the source. The right-hand-side vector $\\mathbf{b}_G$ is constructed such that $b_{G,i} = H_{b,i}$ for $i=0, \\dots, N-2$. As before, $b_{G, N-1}$ is set to $0$. We then solve the second linear system, $L\\mathbf{G} = \\mathbf{b}_G$, to find the discrete potential $\\mathbf{G} = \\{G_{b,i}\\}$.\n\nFinally, the required diagnostics are computed. For cases A, B, and D, the maximum absolute discrete residual is calculated as $R = \\max_i |(L\\mathbf{\\phi} - \\mathbf{b})_i|$ for both $\\mathbf{H}$ and $\\mathbf{G}$, using the matrix $L$ and vectors $\\mathbf{b}_H$ and $\\mathbf{b}_G$ from the linear solver. This measures the numerical accuracy of the linear solve. For case C, where an analytic solution is known, the diagnostic is the maximum absolute error, $E = \\max_i |\\phi_i - \\phi_{\\text{exact}}(v_i)|$, which measures the discretization error of the finite-difference scheme. The provided code implements this entire procedure for each of the specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n\n    def solve_case(N, V_max, bc_type, f_b, alpha=None, is_analytic_case=False):\n        \"\"\"\n        Solves the Rosenbluth potential equations for a single test case.\n\n        Args:\n            N (int): Number of grid points.\n            V_max (float): Maximum velocity in the domain.\n            bc_type (str): Type of boundary condition, 'dirichlet' or 'robin'.\n            f_b (callable): Background distribution function f_b(v).\n            alpha (float, optional): Parameter for Robin boundary condition.\n            is_analytic_case (bool): Flag for Case C to compute error instead of residual.\n\n        Returns:\n            tuple: A pair of diagnostic values (R_H, R_G) or (E_H, E_G).\n        \"\"\"\n        # 1. Setup grid\n        dv = V_max / (N - 1)\n        v = np.linspace(0, V_max, N)\n\n        # 2. Assemble the discrete Laplacian matrix L\n        L = np.zeros((N, N))\n\n        # Row i=0 (origin)\n        if N > 1:\n            L[0, 0] = -6.0 / dv**2\n            L[0, 1] = 6.0 / dv**2\n\n        # Rows i=1 to N-2 (interior)\n        for i in range(1, N - 1):\n            v_i = v[i]\n            v_minus_half = v_i - dv / 2.0\n            v_plus_half = v_i + dv / 2.0\n            \n            coeff = 1.0 / (v_i**2 * dv**2)\n            \n            L[i, i - 1] = coeff * v_minus_half**2\n            L[i, i + 1] = coeff * v_plus_half**2\n            L[i, i] = -coeff * (v_minus_half**2 + v_plus_half**2)\n\n        # Row i=N-1 (outer boundary)\n        if bc_type == 'dirichlet':\n            L[N - 1, N - 1] = 1.0\n        elif bc_type == 'robin':\n            if alpha is None:\n                raise ValueError(\"alpha must be provided for Robin boundary condition\")\n            if N > 1:\n                L[N - 1, N - 2] = -1.0 / dv\n            L[N - 1, N - 1] = 1.0 / dv + alpha\n\n        # 3. Solve for H_b\n        f_b_vals = f_b(v)\n        b_H = -4.0 * np.pi * f_b_vals\n        \n        # Apply boundary conditions to the right-hand-side vector\n        if N > 0:\n            if bc_type == 'dirichlet':\n                b_H[N - 1] = 0.0\n            elif bc_type == 'robin':\n                b_H[N - 1] = 0.0\n\n        H = np.linalg.solve(L, b_H)\n\n        # 4. Solve for G_b\n        b_G = H.copy()  # Source for G is the solution H\n        \n        # Apply boundary conditions to the right-hand-side vector\n        if N > 0:\n            if bc_type == 'dirichlet':\n                b_G[N - 1] = 0.0\n            elif bc_type == 'robin':\n                b_G[N - 1] = 0.0\n\n        G = np.linalg.solve(L, b_G)\n\n        # 5. Calculate diagnostics\n        if is_analytic_case:\n            # Case C: Compute max absolute error against analytic solution\n            # With c = 1/(4*pi), the term 4*pi*c becomes 1.\n            H_exact = (1.0/6.0) * (V_max**2 - v**2)\n            G_exact = (V_max**2 * v**2 / 36.0) - (v**4 / 120.0) - (7.0 * V_max**4 / 360.0)\n            \n            E_H = np.max(np.abs(H - H_exact))\n            E_G = np.max(np.abs(G - G_exact))\n            return E_H, E_G\n        else:\n            # Cases A, B, D: Compute max absolute discrete residual\n            R_H = np.max(np.abs(np.dot(L, H) - b_H))\n            R_G = np.max(np.abs(np.dot(L, G) - b_G))\n            return R_H, R_G\n\n    # Define test cases from the problem statement.\n    test_cases = [\n        {'id': 'A', 'N': 101, 'V_max': 4.0, 'bc_type': 'dirichlet', 'f_b': lambda v: np.exp(-v**2), 'analytic': False},\n        {'id': 'B', 'N': 51, 'V_max': 3.0, 'bc_type': 'robin', 'f_b': lambda v: v**2 * np.exp(-v), 'alpha': 1.0, 'analytic': False},\n        {'id': 'C', 'N': 81, 'V_max': 2.5, 'bc_type': 'dirichlet', 'f_b': lambda v: np.full_like(v, 1.0 / (4.0 * np.pi)), 'analytic': True},\n        {'id': 'D', 'N': 3, 'V_max': 1.0, 'bc_type': 'dirichlet', 'f_b': lambda v: np.exp(-v), 'analytic': False}\n    ]\n\n    results = []\n    for case in test_cases:\n        diag1, diag2 = solve_case(\n            N=case['N'],\n            V_max=case['V_max'],\n            bc_type=case['bc_type'],\n            f_b=case['f_b'],\n            alpha=case.get('alpha'),\n            is_analytic_case=case['analytic']\n        )\n        results.extend([diag1, diag2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}