{
    "hands_on_practices": [
        {
            "introduction": "This first exercise solidifies the physical intuition behind plasma beta. By deriving a relationship between $\\beta$, the sound speed $c_s$, and the Alfvén speed $v_A$, you will see that $\\beta$ is more than a simple pressure ratio; it quantifies the competition between fluid-dynamic and magnetohydrodynamic phenomena. This practice  is crucial for understanding how $\\beta$ defines distinct plasma regimes, from magnetically dominated fusion cores to kinetically active space plasmas.",
            "id": "4028408",
            "problem": "Consider a uniform, isotropic, single-fluid plasma described by ideal Magnetohydrodynamics (MHD), with mass density $\\rho$, thermal pressure $p$, magnetic field magnitude $B$, adiabatic index $\\gamma$, vacuum permeability $\\mu_{0}$, Alfvén speed $v_{A}$, and adiabatic sound speed $c_{s}$. In such a plasma, define the dimensionless plasma beta $\\beta$ as the ratio of thermal pressure to magnetic pressure. Starting from fundamental definitions of the adiabatic sound speed and the Alfvén speed, and from the definition of magnetic pressure in terms of the magnetic field and vacuum permeability, derive an expression for $\\beta$ written purely in terms of $c_{s}$, $v_{A}$, and $\\gamma$. Clearly state any physical assumptions used. Then briefly discuss, on the basis of your derived expression, the qualitative range of $\\beta$ expected in a high-field tokamak core compared to the near-Earth solar wind, indicating how the ratio $c_{s}^{2}/v_{A}^{2}$ and the value of $\\gamma$ control the magnitude of $\\beta$. Your final reported answer must be the closed-form analytic expression for $\\beta$ in terms of $c_{s}$, $v_{A}$, and $\\gamma$; no numerical evaluation is required.",
            "solution": "The problem statement is scrutinized for validity according to the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **System:** A uniform, isotropic, single-fluid plasma.\n-   **Framework:** Ideal Magnetohydrodynamics (MHD).\n-   **Variables and Constants:** Mass density $\\rho$, thermal pressure $p$, magnetic field magnitude $B$, adiabatic index $\\gamma$, vacuum permeability $\\mu_{0}$.\n-   **Defined Speeds:** Alfvén speed $v_{A}$, adiabatic sound speed $c_{s}$.\n-   **Definition of Plasma Beta ($\\beta$):** The ratio of thermal pressure to magnetic pressure, $\\beta = \\frac{p}{p_{\\text{mag}}}$.\n-   **Implicit Definitions (from \"starting from fundamental definitions\"):**\n    -   Magnetic pressure: $p_{\\text{mag}} = \\frac{B^2}{2\\mu_0}$.\n    -   Adiabatic sound speed: $c_s = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\n    -   Alfvén speed: $v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$.\n-   **Task 1 (Derivation):** Derive an expression for $\\beta$ purely in terms of $c_s$, $v_A$, and $\\gamma$.\n-   **Task 2 (Discussion):** Briefly discuss the qualitative range of $\\beta$ in a high-field tokamak core compared to the near-Earth solar wind, based on the derived expression.\n-   **Final Answer Requirement:** The closed-form analytic expression for $\\beta$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is based entirely on the standard, well-established framework of ideal MHD. The definitions of plasma beta, Alfvén speed, and sound speed are fundamental concepts in plasma physics. The problem is scientifically sound.\n-   **Well-Posed:** The problem requests a specific derivation from a set of consistent and sufficient definitions. The goal is clearly stated, and a unique analytical solution is expected. The qualitative discussion is a standard interpretive task based on the quantitative result.\n-   **Objective:** The language is formal, precise, and devoid of subjective or ambiguous terminology.\n-   **Completeness and Consistency:** All necessary physical quantities and their standard definitions are either provided or implicitly requested from fundamental principles, which are unambiguous in this context. There are no contradictions.\n-   **Realism and Feasibility:** The problem operates within the idealized model of ideal MHD, which is a standard and necessary approximation in theoretical plasma physics. The conditions are not physically impossible or inconsistent.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard, well-posed problem in introductory plasma physics that tests the understanding of fundamental MHD parameters. A full solution will be provided.\n\n### Solution\n\nThe objective is to derive an expression for the plasma beta, $\\beta$, in terms of the adiabatic sound speed $c_s$, the Alfvén speed $v_A$, and the adiabatic index $\\gamma$.\n\nThe plasma beta, $\\beta$, is defined as the ratio of the plasma's thermal pressure, $p$, to the magnetic pressure, $p_{\\text{mag}}$.\n$$\n\\beta = \\frac{p}{p_{\\text{mag}}}\n$$\nThe magnetic pressure is fundamentally defined in terms of the magnetic field magnitude, $B$, and the vacuum permeability, $\\mu_{0}$, as:\n$$\np_{\\text{mag}} = \\frac{B^2}{2\\mu_{0}}\n$$\nSubstituting this definition into the expression for $\\beta$ gives:\n$$\n\\beta = \\frac{p}{\\frac{B^2}{2\\mu_{0}}} = \\frac{2\\mu_{0} p}{B^2}\n$$\nThis expression currently depends on $p$, $B$, and $\\mu_{0}$. The problem requires an expression in terms of $c_s$, $v_A$, and $\\gamma$. To achieve this, we must use the definitions of the adiabatic sound speed and the Alfvén speed to replace $p$ and $B^2$.\n\nThe adiabatic sound speed, $c_s$, is defined as:\n$$\nc_s = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\nwhere $\\rho$ is the plasma mass density. Squaring this equation and rearranging for the thermal pressure $p$ yields:\n$$\nc_s^2 = \\frac{\\gamma p}{\\rho} \\implies p = \\frac{\\rho c_s^2}{\\gamma}\n$$\nThe Alfvén speed, $v_A$, is defined as:\n$$\nv_A = \\frac{B}{\\sqrt{\\mu_{0} \\rho}}\n$$\nSquaring this equation and rearranging for $B^2$ yields:\n$$\nv_A^2 = \\frac{B^2}{\\mu_{0} \\rho} \\implies B^2 = \\mu_{0} \\rho v_A^2\n$$\nNow, we substitute the expressions for $p$ and $B^2$ into our equation for $\\beta$:\n$$\n\\beta = \\frac{2\\mu_{0} p}{B^2} = \\frac{2\\mu_{0} \\left(\\frac{\\rho c_s^2}{\\gamma}\\right)}{\\mu_{0} \\rho v_A^2}\n$$\nWe can now simplify this expression. The vacuum permeability, $\\mu_{0}$, present in both the numerator and the denominator, cancels out. Similarly, the mass density, $\\rho$, also cancels out.\n$$\n\\beta = \\frac{2 \\left(\\frac{c_s^2}{\\gamma}\\right)}{v_A^2}\n$$\nRearranging the terms gives the final, elegant expression for $\\beta$:\n$$\n\\beta = \\frac{2}{\\gamma} \\frac{c_s^2}{v_A^2} = \\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2\n$$\nThis derivation relies on the assumptions of a uniform, isotropic, single-fluid plasma governed by ideal MHD, for which these definitions of $v_A$ and $c_s$ are valid.\n\n### Discussion\n\nThe derived relationship $\\beta = \\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2$ illuminates the physical meaning of $\\beta$ as a measure of the relative importance of fluid-dynamic effects (propagating at $c_s$) versus magnetohydrodynamic effects (propagating at $v_A$). The magnitude of $\\beta$ is directly controlled by the ratio $\\frac{c_s^2}{v_A^2}$ and inversely by $\\gamma$.\n\nFor most fully ionized plasmas, the particles have three translational degrees of freedom, so the adiabatic index is $\\gamma = \\frac{5}{3}$. The factor $\\frac{2}{\\gamma}$ is therefore $\\frac{2}{(5/3)} = \\frac{6}{5} = 1.2$, a constant of order unity. Thus, the magnitude of $\\beta$ is primarily determined by the ratio of the squared speeds, $\\left(\\frac{c_s}{v_A}\\right)^2$.\n\n**High-Field Tokamak Core:**\n-   Tokamaks are designed for magnetic confinement of a fusion plasma. This requires the magnetic pressure to be substantially greater than the plasma's thermal pressure to maintain stability and confine the hot plasma away from the vessel walls.\n-   This implies $p_{\\text{mag}} \\gg p$, which by definition means $\\beta \\ll 1$. Typical values for $\\beta$ in a tokamak core are in the range of a few percent (e.g., $0.01  \\beta  0.1$).\n-   From our derived relationship, if $\\beta \\ll 1$, then it must be that $\\left(\\frac{c_s}{v_A}\\right)^2 \\ll 1$, or $c_s \\ll v_A$.\n-   This is consistent with the physical conditions: tokamaks operate with very strong magnetic fields ($B$ is several Teslas) and moderate densities, leading to an extremely high Alfvén speed $v_A$. While the core temperature is very high (leading to a high sound speed $c_s$), the magnitude of $v_A$ is dominant.\n\n**Near-Earth Solar Wind:**\n-   The solar wind is a stream of plasma flowing outward from the Sun. In the near-Earth environment, the interplanetary magnetic field is relatively weak (on the order of nanoteslas), and the plasma is much less dense than in a tokamak.\n-   In this regime, the thermal and magnetic pressures are often comparable in magnitude. It is not a strongly magnetically dominated environment.\n-   Consequently, $\\beta$ is typically of order unity ($\\beta \\approx 1$). In some regions or during certain events, the plasma can be thermally dominated ($\\beta > 1$) or magnetically dominated ($\\beta  1$), but $\\beta \\approx 1$ is a characteristic value.\n-   From our derived relationship, if $\\beta \\approx 1$, then it must be that $\\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2 \\approx 1$. Since $\\frac{2}{\\gamma}$ is itself of order unity, this implies that $\\left(\\frac{c_s}{v_A}\\right)^2 \\approx 1$, or $c_s \\approx v_A$.\n-   Physically, this means that in the solar wind, the characteristic speeds of thermal phenomena and magnetic wave phenomena are comparable.\n\nIn summary, the ratio $\\frac{c_s^2}{v_A^2}$ is the primary determinant of the plasma regime. A small ratio signifies a low-$\\beta$, magnetically dominated plasma like a tokamak core, while a ratio of order unity signifies a high-$\\beta$ or comparable-pressure plasma like the solar wind.",
            "answer": "$$\n\\boxed{\\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^{2}}\n$$"
        },
        {
            "introduction": "Building upon the fundamental definition, this practice moves to a concrete application within a tokamak model. You will derive key properties of a Solov’ev equilibrium, a widely used analytical solution to the Grad-Shafranov equation, and calculate its corresponding toroidal beta, $\\beta_T$. This exercise  demonstrates how the abstract functions describing pressure and magnetic field in an equilibrium are directly linked to macroscopic performance metrics.",
            "id": "4028344",
            "problem": "Consider a large-aspect-ratio tokamak with major radius $R_0$ and minor radius $a$, in axisymmetric, static, ideal Magnetohydrodynamic (MHD) equilibrium. Let the poloidal flux function be $\\psi(R,Z)$, with the magnetic field written in terms of $\\psi$ and the toroidal field function $F(\\psi)$ as $\\mathbf{B} = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} + \\frac{F(\\psi)}{R}\\hat{\\boldsymbol{\\phi}}$, where $R$ is the cylindrical radius and $\\hat{\\boldsymbol{\\phi}}$ the toroidal unit vector. A Solov’ev equilibrium is specified by linear profiles $p(\\psi)$ and $F(\\psi)$, where $p(\\psi)$ is the scalar pressure and $F(\\psi) = R B_{\\phi}$ encodes the toroidal magnetic field $B_{\\phi}$. Assume\n- $p(\\psi) = p_0 - \\alpha \\psi$ with $p_0  0$ and $\\alpha  0$,\n- $F(\\psi) = F_0 + \\beta \\psi$ with $F_0 = R_0 B_0$ and $\\beta$ a constant,\n\nand boundary conditions $\\psi|_{r=0} = 0$ and $\\psi|_{r=a} = \\psi_b  0$, where $r$ is the minor radius labeling circular cross-section flux surfaces, consistent with a large-aspect-ratio ordering $R_0 \\gg a$.\n\nStarting from the ideal MHD force balance $\\nabla p = \\mathbf{J} \\times \\mathbf{B}$ and axisymmetry, construct the leading–order Solov’ev equilibrium by obtaining the dominant radial dependence $\\psi(r)$ in the large-aspect-ratio limit, justifying any approximations used. Then, using the definition of toroidal beta,\n$$\\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_0^2},$$\nwhere $\\mu_0$ is the vacuum permeability, $B_0$ is the toroidal magnetic field at $R_0$, and $\\langle p \\rangle$ denotes the volume average of $p$ over the torus, compute $\\beta_T$ for this equilibrium in closed form. Express the final answer as a single analytic expression in terms of $p_0$ and $B_0$. Finally, briefly discuss the limitations of the resulting Solov’ev model for high–beta ($\\beta$) modeling, focusing on physical and mathematical assumptions that break down as $\\beta$ increases.\n\nThe final answer must be a single closed-form analytic expression without units. No rounding is required.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **System:** A large-aspect-ratio ($R_0 \\gg a$) tokamak in axisymmetric, static, ideal Magnetohydrodynamic (MHD) equilibrium.\n- **Coordinates  Geometry:** Major radius $R_0$, minor radius $a$. Cylindrical radius $R$, toroidal unit vector $\\hat{\\boldsymbol{\\phi}}$, minor radius $r$ labeling circular cross-section flux surfaces.\n- **Magnetic Field:** The magnetic field is given by $\\mathbf{B} = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} + \\frac{F(\\psi)}{R}\\hat{\\boldsymbol{\\phi}}$, where $\\psi(R,Z)$ is the poloidal flux function and $F(\\psi)$ is the toroidal field function.\n- **Constitutive Relations (Solov'ev profiles):**\n    - Pressure: $p(\\psi) = p_0 - \\alpha \\psi$, with $p_0  0$ and $\\alpha  0$.\n    - Toroidal field function: $F(\\psi) = F_0 + \\beta \\psi$, with $F_0 = R_0 B_0$ and $\\beta$ being a constant.\n- **Boundary Conditions:**\n    - On the magnetic axis: $\\psi|_{r=0} = 0$.\n    - At the plasma edge: $\\psi|_{r=a} = \\psi_b  0$.\n- **Definition:** Toroidal beta is defined as $\\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_0^2}$, where $\\mu_0$ is the vacuum permeability, $B_0$ is the toroidal magnetic field at $R_0$, and $\\langle p \\rangle$ is the volume average of the pressure $p$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established theory of MHD equilibria in tokamaks, specifically using the Grad-Shafranov formalism. The concept of a Solov'ev equilibrium, characterized by linear source terms in the Grad-Shafranov equation, is a standard topic in fusion plasma physics. The provided profiles for $p(\\psi)$ and $F(\\psi)$ are specific choices that lead to a solvable model. The problem is well-posed, providing sufficient definitions and boundary conditions to determine a unique solution in the specified large-aspect-ratio limit. The language is objective and precise. The problem is thus deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Solution Derivation\nThe starting point is the ideal MHD force balance equation for a static equilibrium:\n$$ \\nabla p = \\mathbf{J} \\times \\mathbf{B} $$\nWith Ampere's law (in the absence of displacement current), $\\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}$. Substituting this into the force balance equation relates the pressure gradient to the magnetic field. For an axisymmetric system described by the poloidal flux function $\\psi$, this relationship yields the Grad-Shafranov (GS) equation:\n$$ R^2 \\nabla \\cdot \\left( \\frac{1}{R^2} \\nabla \\psi \\right) = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi} $$\nIn cylindrical coordinates $(R, \\phi, Z)$, the operator on the left, $\\Delta^*$, is given by $\\Delta^*\\psi = \\frac{\\partial^2 \\psi}{\\partial R^2} - \\frac{1}{R} \\frac{\\partial \\psi}{\\partial R} + \\frac{\\partial^2 \\psi}{\\partial Z^2}$.\n\nFrom the given profiles:\n- $p(\\psi) = p_0 - \\alpha \\psi \\implies \\frac{dp}{d\\psi} = -\\alpha$\n- $F(\\psi) = F_0 + \\beta \\psi \\implies \\frac{dF}{d\\psi} = \\beta$\n\nThe source term on the right-hand side of the GS equation becomes:\n$$ -\\mu_0 R^2 (-\\alpha) - (F_0 + \\beta\\psi)(\\beta) = \\mu_0 \\alpha R^2 - \\beta F_0 - \\beta^2 \\psi $$\nThe GS equation is therefore:\n$$ \\Delta^* \\psi = \\mu_0 \\alpha R^2 - \\beta F_0 - \\beta^2 \\psi $$\nWe now apply the large-aspect-ratio approximation ($R_0 \\gg a$). We introduce local coordinates $(r, \\theta)$ centered on the magnetic axis, such that $R = R_0 + r\\cos\\theta$ and $Z = r\\sin\\theta$. In this limit, the flux surfaces are assumed to be concentric circles, so $\\psi$ is a function of the minor radius $r$ only, $\\psi=\\psi(r)$. The operator $\\Delta^*$ simplifies to the leading-order cylindrical Laplacian in the poloidal plane:\n$$ \\Delta^* \\psi \\approx \\frac{1}{r} \\frac{d}{dr} \\left(r \\frac{d\\psi}{dr}\\right) $$\nFor the source term, we also take the leading-order approximation by setting $R \\approx R_0$. The term $\\beta^2\\psi$ is a higher-order term in plasma beta and can be neglected for a leading-order calculation. This corresponds to assuming a flat toroidal current density profile, a common simplification for introductory models. The GS equation thus reduces to:\n$$ \\frac{1}{r} \\frac{d}{dr} \\left(r \\frac{d\\psi}{dr}\\right) \\approx \\mu_0 \\alpha R_0^2 - \\beta F_0 = \\mu_0 \\alpha R_0^2 - \\beta R_0 B_0 $$\nLet the constant right-hand side be $K$. Integrating this equation twice with respect to $r$:\n$$ r \\frac{d\\psi}{dr} = \\frac{K}{2} r^2 + C_1 $$\n$$ \\frac{d\\psi}{dr} = \\frac{K}{2} r + \\frac{C_1}{r} $$\nFor the magnetic field (and thus $d\\psi/dr$) to be finite at the magnetic axis ($r=0$), we must have $C_1=0$. Integrating again:\n$$ \\psi(r) = \\frac{K}{4} r^2 + C_2 $$\nThe boundary condition $\\psi(0)=0$ implies $C_2=0$. Therefore, the leading-order solution for the poloidal flux is a parabolic profile:\n$$ \\psi(r) = \\frac{K}{4} r^2 = \\frac{1}{4}(\\mu_0 \\alpha R_0^2 - \\beta R_0 B_0) r^2 $$\nWe use the boundary condition at $r=a$ to relate this to the pressure. At the plasma edge ($r=a$), the pressure is typically assumed to vanish, so $p(a)=0$.\n$$ p(a) = p(\\psi_b) = p_0 - \\alpha \\psi_b = 0 \\implies \\psi_b = \\frac{p_0}{\\alpha} $$\nSubstituting the expression for $\\psi(r)$ at $r=a$:\n$$ \\psi_b = \\psi(a) = \\frac{K}{4} a^2 $$\nNow we can write the pressure profile $p(r)$ in terms of $p_0$:\n$$ p(r) = p_0 - \\alpha \\psi(r) = p_0 - \\alpha \\left(\\frac{K}{4} r^2\\right) = p_0 - \\alpha\\left(\\frac{\\psi_b}{a^2} r^2\\right) = p_0 - \\alpha\\left(\\frac{p_0/\\alpha}{a^2} r^2\\right) $$\n$$ p(r) = p_0 \\left(1 - \\frac{r^2}{a^2}\\right) $$\nThis is the standard parabolic pressure profile resulting from the flat current density approximation.\n\nNext, we compute the volume average of the pressure, $\\langle p \\rangle$. The volume element in the torus, to leading order in aspect ratio where $R \\approx R_0$, is $dV \\approx (2\\pi R_0) r\\,dr\\,d\\theta$. The total volume is then $V = \\int_0^{2\\pi} \\int_0^a (2\\pi R_0) r\\,dr\\,d\\theta = 2\\pi^2 R_0 a^2$. The volume average of the pressure is:\n$$ \\langle p \\rangle = \\frac{1}{V} \\int_V p \\, dV = \\frac{1}{2\\pi^2 R_0 a^2} \\int_0^{2\\pi} \\int_0^a p(r) (2\\pi R_0) r\\,dr\\,d\\theta = \\frac{4\\pi^2 R_0}{2\\pi^2 R_0 a^2} \\int_0^a p(r) r\\,dr = \\frac{2}{a^2} \\int_0^a p(r) r\\,dr $$\nSubstituting the parabolic profile for $p(r)$:\n$$ \\langle p \\rangle = \\frac{2}{a^2} \\int_0^a p_0 \\left(1 - \\frac{r^2}{a^2}\\right) r dr = \\frac{2 p_0}{a^2} \\left[ \\int_0^a r dr - \\frac{1}{a^2} \\int_0^a r^3 dr \\right] $$\n$$ \\langle p \\rangle = \\frac{2 p_0}{a^2} \\left[ \\frac{a^2}{2} - \\frac{1}{a^2}\\frac{a^4}{4} \\right] = \\frac{2 p_0}{a^2} \\left[ \\frac{a^2}{2} - \\frac{a^2}{4} \\right] = \\frac{2 p_0}{a^2} \\left( \\frac{a^2}{4} \\right) = \\frac{p_0}{2} $$\nFinally, we compute the toroidal beta $\\beta_T$ using its definition:\n$$ \\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_0^2} = \\frac{2 \\mu_0 (p_0/2)}{B_0^2} = \\frac{\\mu_0 p_0}{B_0^2} $$\n\n### Discussion of Limitations\nThe derived Solov'ev equilibrium model relies on several key assumptions that limit its applicability, especially for high-beta plasmas.\n$1$. **Large-Aspect-Ratio and Circular Flux Surfaces:** The model assumes $R_0 \\gg a$ and that flux surfaces are concentric circles. At high beta, the plasma pressure becomes a significant fraction of the magnetic pressure. This large pressure gradient pushes the plasma outward, causing a significant shift of the magnetic axis relative to the geometric center of the vacuum vessel (the Shafranov shift). The flux surfaces are compressed on the outboard side and become non-circular (typically D-shaped). The simple $\\psi(r)$ dependence and the cylindrical Laplacian approximation fail, and the full two-dimensional GS equation must be solved.\n$2$. **Leading-Order Source Term Approximation:** In deriving the parabolic pressure profile, we neglected the $\\beta^2 \\psi$ term in the GS equation. This is equivalent to assuming a flat toroidal current density profile. At high beta, the pressure gradient itself drives a significant \"bootstrap\" current, which is peaked off-axis. The total current profile becomes highly non-uniform and is coupled to the pressure profile. The simple linear model cannot capture this crucial self-consistency, which is essential for both equilibrium and stability analysis in high-performance plasmas.\n$3$. **Linear Profiles:** The assumption that $p(\\psi)$ and $F(\\psi)$ are linear functions of $\\psi$ is a mathematical convenience for obtaining an analytic solution. Real plasma profiles are determined by complex transport physics and do not generally follow such simple laws. For instance, the formation of transport barriers can lead to very steep, localized gradients not representable by a global linear function. This makes the Solov'ev model a poor representation of experimentally observed profiles.\n$4$. **Ideal MHD Framework:** The entire model is based on ideal MHD, which treats the plasma as a perfectly conducting fluid. This neglects important non-ideal and kinetic effects such as resistivity, viscosity, and anisotropic pressure, which can modify the equilibrium and become critical for understanding stability at high beta.\n\nIn summary, the Solov'ev model is a valuable pedagogical tool but breaks down for high-beta modeling because its core geometric and physical assumptions (concentric circular flux surfaces, flat current profile) are violated by the plasma's strong self-interaction through pressure and current.",
            "answer": "$$\\boxed{\\frac{\\mu_0 p_0}{B_0^2}}$$"
        },
        {
            "introduction": "Our final practice addresses a core task in computational fusion engineering: validating a model against experimental results. Using a set of reconstructed plasma profiles, you will compute global parameters, including the normalized beta, $\\beta_N$, and compare them to measured values. This exercise  highlights the role of beta as a critical figure of merit and provides hands-on experience in the consistency checks that underpin reliable plasma analysis.",
            "id": "4028357",
            "problem": "Consider an axisymmetric, large-aspect-ratio tokamak plasma in static Magnetohydrodynamic (MHD) equilibrium with circular cross-section of minor radius $a$ and major radius $R_0$. The poloidal magnetic flux per radian is $\\psi(r)$, the pressure is $p(\\psi)$, and $F(\\psi) \\equiv R B_\\phi$ with $B_\\phi$ the toroidal magnetic field and $R$ the major radius coordinate. Under axisymmetry and large-aspect-ratio assumptions ($R \\approx R_0$ across the cross-section), the following fundamental relations hold:\n- Force balance in MHD equilibrium: $\\nabla p = \\mathbf{j} \\times \\mathbf{B}$.\n- The Grad-Shafranov (GS) framework implies $p = p(\\psi)$ and $F = F(\\psi)$.\n- The poloidal magnetic field satisfies $B_\\theta(r) = \\frac{1}{R_0} \\frac{d\\psi}{dr}$.\n- Ampère's law applied to the toroidal current gives $I_p = \\frac{2\\pi R_0}{\\mu_0} B_\\theta(a)$, where $\\mu_0$ is the vacuum permeability.\n\nYou are given that the reconstruction provides the functions\n$$p(\\psi) = p_0 \\left(1 - \\frac{\\psi}{\\psi_{\\mathrm{edge}}}\\right)^\\alpha,$$\n$$F(\\psi) = F_0 + c_F \\psi,$$\nwith a prescribed flux-radius mapping\n$$\\psi(r) = \\psi_{\\mathrm{edge}} \\left(\\frac{r}{a}\\right)^2,$$\nso that $\\frac{d\\psi}{dr}\\big|_{r=a} = \\frac{2\\psi_{\\mathrm{edge}}}{a}$.\n\nFor consistency checking with experiment, define the following quantities:\n- The area-averaged pressure over the circular cross-section is\n$$\\langle p \\rangle = \\frac{1}{\\pi a^2} \\int_0^{2\\pi} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr\\,d\\theta,$$\nwhich simplifies, under the given $p(\\psi)$ and $\\psi(r)$, to an integral in $r$ only.\n- The reconstructed toroidal magnetic field at the edge is\n$$B_{\\phi,\\mathrm{edge}} = \\frac{F(\\psi_{\\mathrm{edge}})}{R_0}.$$\n- The reconstructed plasma current is\n$$I_{p,\\mathrm{rec}} = \\frac{2\\pi R_0}{\\mu_0} B_\\theta(a) = \\frac{2\\pi R_0}{\\mu_0} \\frac{1}{R_0} \\frac{d\\psi}{dr}\\bigg|_{r=a} = \\frac{4\\pi \\psi_{\\mathrm{edge}}}{\\mu_0 a}.$$\n- The toroidal beta (as a decimal fraction) referenced to the vacuum toroidal field $B_{T0}$ is\n$$\\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_{T0}^2}.$$\n- The normalized beta (dimensionless) is defined (with current in mega-amperes) as\n$$\\beta_N = \\beta_T \\frac{a\\,B_{T0}}{I_p^{\\mathrm{MA}}},$$\nwhere $I_p^{\\mathrm{MA}}$ denotes the plasma current in mega-amperes. No percentage signs are to be used; all fractions must be expressed as decimals.\n\nYour program must, for each test case:\n1. Compute $\\langle p \\rangle$ from the given $p(\\psi)$ and $\\psi(r)$ mapping.\n2. Compute $B_{\\phi,\\mathrm{edge}}$ from $F(\\psi)$ at $\\psi_{\\mathrm{edge}}$ and compare it to the experimental $B_{T0}$.\n3. Compute $I_{p,\\mathrm{rec}}$ from $\\psi_{\\mathrm{edge}}$ and compare it to the experimental $I_{p,\\mathrm{exp}}$.\n4. Compute $\\beta_T$ and then $\\beta_N$ using $B_{T0}$ and compare $\\beta_N$ to the experimental $\\beta_{N,\\mathrm{exp}}$.\n\nDefine the case to be \"consistent\" if and only if the following three relative discrepancies are simultaneously bounded:\n- Toroidal field consistency: $\\left| B_{\\phi,\\mathrm{edge}} - B_{T0} \\right| / B_{T0} \\leq \\delta_B$, with tolerance $\\delta_B = 10^{-2}$.\n- Plasma current consistency: $\\left| I_{p,\\mathrm{rec}} - I_{p,\\mathrm{exp}} \\right| / I_{p,\\mathrm{exp}} \\leq \\delta_I$, with tolerance $\\delta_I = 10^{-2}$.\n- Normalized beta consistency: $\\left| \\beta_N - \\beta_{N,\\mathrm{exp}} \\right| / \\beta_{N,\\mathrm{exp}} \\leq \\delta_\\beta$, with tolerance $\\delta_\\beta = 5\\times 10^{-2}$.\n\nUse International System of Units (SI): $R_0$ and $a$ in meters, $B_{T0}$ in teslas, $I_{p,\\mathrm{exp}}$ in amperes, $p_0$ and $\\langle p \\rangle$ in pascals, and $\\psi_{\\mathrm{edge}}$ in webers per radian. Express $\\beta_T$ and $\\beta_N$ as dimensionless decimal fractions.\n\nTest suite:\n- Case 1 (happy path, expected consistent):\n    - $R_0 = 3.0$, $a = 1.0$, $B_{T0} = 3.0$, $I_{p,\\mathrm{exp}} = 1.5\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.15$, $p_0 = 2.148\\times 10^5$, $\\alpha = 1.0$, $F_0 = 9.0$, $c_F = 0.0$, $\\beta_{N,\\mathrm{exp}} = 0.06$.\n- Case 2 (edge toroidal field mismatch, expected inconsistent):\n    - $R_0 = 3.0$, $a = 1.0$, $B_{T0} = 3.0$, $I_{p,\\mathrm{exp}} = 1.5\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.15$, $p_0 = 2.148\\times 10^5$, $\\alpha = 1.0$, $F_0 = 8.0$, $c_F = 0.0$, $\\beta_{N,\\mathrm{exp}} = 0.06$.\n- Case 3 (boundary case with weak $F(\\psi)$ variation, expected consistent):\n    - $R_0 = 3.5$, $a = 0.6$, $B_{T0} = 2.7$, $I_{p,\\mathrm{exp}} = 0.8\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.048$, $p_0 = 1.7412\\times 10^5$, $\\alpha = 2.0$, $F_0 = 9.45$, $c_F = -0.1$, $\\beta_{N,\\mathrm{exp}} = 0.0405$.\n- Case 4 (pressure-induced $\\beta_N$ mismatch, expected inconsistent):\n    - $R_0 = 3.0$, $a = 1.0$, $B_{T0} = 3.0$, $I_{p,\\mathrm{exp}} = 1.0\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.1$, $p_0 = 4.3\\times 10^5$, $\\alpha = 1.0$, $F_0 = 9.0$, $c_F = 0.0$, $\\beta_{N,\\mathrm{exp}} = 0.02$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be a boolean indicating whether the corresponding test case is consistent under the criteria above. No other text must be printed.",
            "solution": "The problem statement has been meticulously validated and is determined to be valid. It is scientifically grounded in the principles of Magnetohydrodynamics (MHD) as applied to tokamak plasmas, is mathematically well-posed, and is formulated with objective and unambiguous language. All necessary data for the prescribed calculations are provided.\n\nThe core task is to verify the consistency of a given plasma equilibrium reconstruction against a set of experimental measurements. This is performed by computing several physical quantities from the reconstructed profiles and comparing them to their experimental counterparts within specified tolerance margins. The analysis proceeds in a series of well-defined steps.\n\nFirst, we derive an analytical expression for the area-averaged plasma pressure, $\\langle p \\rangle$. The definition is given as:\n$$\n\\langle p \\rangle = \\frac{1}{\\pi a^2} \\int_0^{2\\pi} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr\\,d\\theta\n$$\nGiven that the pressure profile $p(\\psi(r))$ is independent of the poloidal angle $\\theta$, the angular integral yields a factor of $2\\pi$:\n$$\n\\langle p \\rangle = \\frac{2\\pi}{\\pi a^2} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr = \\frac{2}{a^2} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr\n$$\nWe are provided with the pressure profile $p(\\psi) = p_0 \\left(1 - \\frac{\\psi}{\\psi_{\\mathrm{edge}}}\\right)^\\alpha$ and the flux-radius mapping $\\psi(r) = \\psi_{\\mathrm{edge}} \\left(\\frac{r}{a}\\right)^2$. Substituting these into the integrand gives:\n$$\np(\\psi(r)) = p_0 \\left(1 - \\frac{\\psi_{\\mathrm{edge}} (r/a)^2}{\\psi_{\\mathrm{edge}}}\\right)^\\alpha = p_0 \\left(1 - \\frac{r^2}{a^2}\\right)^\\alpha\n$$\nThe integral for $\\langle p \\rangle$ becomes:\n$$\n\\langle p \\rangle = \\frac{2 p_0}{a^2} \\int_0^a \\left(1 - \\frac{r^2}{a^2}\\right)^\\alpha r\\,dr\n$$\nTo solve this integral, we employ the substitution $u = 1 - \\frac{r^2}{a^2}$. The differential is $du = -\\frac{2r}{a^2} dr$, which implies $r\\,dr = -\\frac{a^2}{2} du$. The limits of integration change from $r=0$ to $u=1$ and from $r=a$ to $u=0$. The integral transforms to:\n$$\n\\langle p \\rangle = \\frac{2 p_0}{a^2} \\int_{u=1}^{u=0} u^\\alpha \\left(-\\frac{a^2}{2} du\\right) = -p_0 \\int_1^0 u^\\alpha du = p_0 \\int_0^1 u^\\alpha du\n$$\nThis is a standard elementary integral, which evaluates to:\n$$\n\\langle p \\rangle = p_0 \\left[ \\frac{u^{\\alpha+1}}{\\alpha+1} \\right]_0^1 = p_0 \\left( \\frac{1^{\\alpha+1}}{\\alpha+1} - \\frac{0^{\\alpha+1}}{\\alpha+1} \\right) = \\frac{p_0}{\\alpha+1}\n$$\nThis elegant result allows for the direct calculation of the average pressure from the input parameters $p_0$ and $\\alpha$.\n\nWith the expression for $\\langle p \\rangle$ established, we can now outline the full computational procedure for verifying the consistency of each test case.\n\n1.  **Compute Area-Averaged Pressure $\\langle p \\rangle$**:\n    Using the derived formula, calculate $\\langle p \\rangle = \\frac{p_0}{\\alpha+1}$.\n\n2.  **Compute Reconstructed Toroidal Field $B_{\\phi,\\mathrm{edge}}$**:\n    This is calculated from the function $F(\\psi) = F_0 + c_F \\psi$ at the plasma edge, where $\\psi = \\psi_{\\mathrm{edge}}$, and normalized by the major radius $R_0$.\n    $$\n    B_{\\phi,\\mathrm{edge}} = \\frac{F(\\psi_{\\mathrm{edge}})}{R_0} = \\frac{F_0 + c_F \\psi_{\\mathrm{edge}}}{R_0}\n    $$\n    Compare this value to the experimental vacuum toroidal field $B_{T0}$ using the relative difference: $\\frac{\\left| B_{\\phi,\\mathrm{edge}} - B_{T0} \\right|}{B_{T0}} \\leq \\delta_B$, with $\\delta_B = 10^{-2}$.\n\n3.  **Compute Reconstructed Plasma Current $I_{p,\\mathrm{rec}}$**:\n    The reconstructed current is given by the formula:\n    $$\n    I_{p,\\mathrm{rec}} = \\frac{4\\pi \\psi_{\\mathrm{edge}}}{\\mu_0 a}\n    $$\n    Using the vacuum permeability constant $\\mu_0 = 4\\pi \\times 10^{-7}$ T·m/A, this simplifies to $I_{p,\\mathrm{rec}} = \\frac{\\psi_{\\mathrm{edge}}}{a} \\times 10^7$ Amperes. Compare this to the experimental plasma current $I_{p,\\mathrm{exp}}$: $\\frac{\\left| I_{p,\\mathrm{rec}} - I_{p,\\mathrm{exp}} \\right|}{I_{p,\\mathrm{exp}}} \\leq \\delta_I$, with $\\delta_I = 10^{-2}$.\n\n4.  **Compute Normalized Beta $\\beta_N$**:\n    This requires two sub-steps. First, calculate the toroidal beta, $\\beta_T$:\n    $$\n    \\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_{T0}^2}\n    $$\n    Next, use this to find the normalized beta, $\\beta_N$. This is normalized using the experimental plasma current $I_{p,\\mathrm{exp}}$ converted to Mega-Amperes ($I_{p,\\mathrm{exp}}^{\\mathrm{MA}} = I_{p,\\mathrm{exp}} / 10^6$).\n    $$\n    \\beta_N = \\beta_T \\frac{a\\,B_{T0}}{I_{p,\\mathrm{exp}}^{\\mathrm{MA}}}\n    $$\n    Compare this computed $\\beta_N$ to the experimental value $\\beta_{N,\\mathrm{exp}}$: $\\frac{\\left| \\beta_N - \\beta_{N,\\mathrm{exp}} \\right|}{\\beta_{N,\\mathrm{exp}}} \\leq \\delta_\\beta$, with $\\delta_\\beta = 5\\times 10^{-2}$.\n\n5.  **Final Verdict**: A test case is deemed \"consistent\" if and only if all three of the above inequality checks are satisfied. Otherwise, it is \"inconsistent\". The program will implement these steps for each test case and report the boolean outcome.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plasma equilibrium consistency problem for a suite of test cases.\n    \"\"\"\n    # Define physical and problem-specific constants\n    MU0 = 4 * np.pi * 1e-7  # Vacuum permeability in T·m/A\n    DELTA_B = 1e-2\n    DELTA_I = 1e-2\n    DELTA_BETA = 5e-2\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case 1: happy path, expected consistent\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_T0\": 3.0, \"I_p_exp\": 1.5e6, \"psi_edge\": 0.15,\n            \"p0\": 2.148e5, \"alpha\": 1.0, \"F0\": 9.0, \"c_F\": 0.0, \"beta_N_exp\": 0.06\n        },\n        # Case 2: edge toroidal field mismatch, expected inconsistent\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_T0\": 3.0, \"I_p_exp\": 1.5e6, \"psi_edge\": 0.15,\n            \"p0\": 2.148e5, \"alpha\": 1.0, \"F0\": 8.0, \"c_F\": 0.0, \"beta_N_exp\": 0.06\n        },\n        # Case 3: boundary case, expected consistent\n        {\n            \"R0\": 3.5, \"a\": 0.6, \"B_T0\": 2.7, \"I_p_exp\": 0.8e6, \"psi_edge\": 0.048,\n            \"p0\": 1.7412e5, \"alpha\": 2.0, \"F0\": 9.45, \"c_F\": -0.1, \"beta_N_exp\": 0.0405\n        },\n        # Case 4: pressure-induced beta_N mismatch, expected inconsistent\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_T0\": 3.0, \"I_p_exp\": 1.0e6, \"psi_edge\": 0.1,\n            \"p0\": 4.3e5, \"alpha\": 1.0, \"F0\": 9.0, \"c_F\": 0.0, \"beta_N_exp\": 0.02\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for clarity\n        R0 = case[\"R0\"]\n        a = case[\"a\"]\n        B_T0 = case[\"B_T0\"]\n        I_p_exp = case[\"I_p_exp\"]\n        psi_edge = case[\"psi_edge\"]\n        p0 = case[\"p0\"]\n        alpha = case[\"alpha\"]\n        F0 = case[\"F0\"]\n        c_F = case[\"c_F\"]\n        beta_N_exp = case[\"beta_N_exp\"]\n\n        # 1. Compute area-averaged pressure\n        avg_pressure = p0 / (alpha + 1.0)\n\n        # 2. Toroidal field consistency check\n        F_psi_edge = F0 + c_F * psi_edge\n        B_phi_edge_rec = F_psi_edge / R0\n        discrepancy_B = abs(B_phi_edge_rec - B_T0) / B_T0\n        is_consistent_B = discrepancy_B = DELTA_B\n\n        # 3. Plasma current consistency check\n        # I_p_rec = (4 * np.pi * psi_edge) / (MU0 * a)\n        # Simplified formula: I_p_rec = (psi_edge / a) * 1e7\n        I_p_rec = (psi_edge / a) * 1e7\n        discrepancy_I = abs(I_p_rec - I_p_exp) / I_p_exp\n        is_consistent_I = discrepancy_I = DELTA_I\n\n        # 4. Normalized beta consistency check\n        # Compute toroidal beta\n        beta_T_rec = (2 * MU0 * avg_pressure) / (B_T0**2)\n        \n        # Convert experimental current to Mega-Amperes for beta_N formula\n        I_p_exp_MA = I_p_exp / 1e6\n        \n        # Compute normalized beta\n        beta_N_rec = beta_T_rec * (a * B_T0) / I_p_exp_MA\n        \n        # Handle the case where beta_N_exp is zero to avoid division by zero\n        if beta_N_exp == 0:\n            discrepancy_beta = abs(beta_N_rec)\n        else:\n            discrepancy_beta = abs(beta_N_rec - beta_N_exp) / beta_N_exp\n            \n        is_consistent_beta = discrepancy_beta = DELTA_BETA\n\n        # A case is consistent if and only if all three checks pass\n        is_consistent_case = is_consistent_B and is_consistent_I and is_consistent_beta\n        results.append(is_consistent_case)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}