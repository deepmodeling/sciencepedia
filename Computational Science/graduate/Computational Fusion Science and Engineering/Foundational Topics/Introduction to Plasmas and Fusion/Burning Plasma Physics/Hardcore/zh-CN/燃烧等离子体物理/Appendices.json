{
    "hands_on_practices": [
        {
            "introduction": "维持燃烧等离子体的关键在于实现功率平衡。本练习采用一个简化的零维（0D）模型来分析离子的和电子的稳态功率平衡，这是一个理解托卡马克中加热、损失和能量流动基本原理的绝佳起点。通过计算“阿尔法通道”效应对外部加热需求的改变，我们可以深入了解控制聚变性能的先进概念，并量化阿尔法粒子加热在维持等离子体燃烧中的核心作用 。",
            "id": "3956393",
            "problem": "一个空间均匀的磁约束氘-氚（D-T）燃烧等离子体，采用独立的离子和电子能量平衡进行建模。等离子体体积为 $V = 800\\,\\text{m}^{3}$，电子密度为 $n_{e} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$。离子和电子温度固定为 $T_{i} = T_{e} = 15\\,\\text{keV}$。假设氘-氚混合比例为 50/50，因此 $n_{D} = n_{T} = n_{i}/2$ 且 $n_{i} = n_{e}$。在 $T_{i} = 15\\,\\text{keV}$ 时，氘-氚聚变反应率为 $\\langle \\sigma v \\rangle = 1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1}$。每次聚变反应产生一个携带能量 $E_{\\alpha} = 3.5\\,\\text{MeV}$ 的 alpha 粒子。在 $T_{e} = 15\\,\\text{keV}$ 时，总轫致辐射功率损失（完全来自电子）为 $P_{\\text{rad}} = 16.5\\,\\text{MW}$。离子和电子的输运功率损失建模为 $P_{i,\\text{trans}} = W_{i}/\\tau_{i}$ 和 $P_{e,\\text{trans}} = W_{e}/\\tau_{e}$，其中 $\\tau_{i} = 3.5\\,\\text{s}$，$\\tau_{e} = 2.5\\,\\text{s}$，并且对于粒子种类 $s \\in \\{i,e\\}$，$W_{s} = \\tfrac{3}{2} n_{s} V k_{B} T_{s}$，$k_{B}$ 是玻尔兹曼常数。忽略所有杂质辐射，并假设由于 $T_{i} = T_{e}$，离子-电子碰撞能量交换项在稳态时为零。\n\n考虑 alpha 粒子能量沉积的两种稳态情况：\n- 情况 A（无通道效应）：所有 alpha 能量都沉积到电子上。\n- 情况 B（alpha 通道效应）：总 alpha 功率的一部分 $f = 0.30$ 直接沉积到离子上，剩余部分 $1 - f$ 沉积到电子上。\n\n使用基于第一性原理的离子和电子双温稳态功率平衡，计算情况 B 和情况 A 之间所需外部电子加热功率的变化量，即计算 $P_{e,\\text{ext}}^{(B)} - P_{e,\\text{ext}}^{(A)}$。你的最终答案以 $\\text{MW}$ 为单位，并四舍五入到三位有效数字。",
            "solution": "我们从独立的离子和电子热能定义及稳态功率平衡方程开始。对于粒子种类 $s \\in \\{i,e\\}$，储存的热能为\n$$\nW_{s} = \\frac{3}{2} n_{s} V k_{B} T_{s},\n$$\n输运损失功率为\n$$\nP_{s,\\text{trans}} = \\frac{W_{s}}{\\tau_{s}}.\n$$\n在稳态且 $T_{i} = T_{e}$ 的条件下，离子-电子碰撞交换功率为零，因此平衡方程简化为\n$$\n\\begin{aligned}\n\\text{离子:}\\quad  0 = P_{\\alpha \\rightarrow i} + P_{i,\\text{ext}} - P_{i,\\text{trans}}, \\\\\n\\text{电子:}\\quad  0 = P_{\\alpha \\rightarrow e} + P_{e,\\text{ext}} - P_{e,\\text{trans}} - P_{\\text{rad}}.\n\\end{aligned}\n$$\n此处 $P_{\\alpha \\rightarrow i}$ 和 $P_{\\alpha \\rightarrow e}$ 分别表示总 alpha 功率 $P_{\\alpha}$ 中沉积到离子和电子上的部分，且 $P_{\\alpha \\rightarrow i} + P_{\\alpha \\rightarrow e} = P_{\\alpha}$。\n\n首先，根据聚变反应率计算总 alpha 功率 $P_{\\alpha}$。对于 50/50 的氘-氚混合物，\n$$\nn_{D} = n_{T} = \\frac{n_{i}}{2} = \\frac{n_{e}}{2}.\n$$\n总聚变反应速率为\n$$\nR = n_{D} n_{T} \\langle \\sigma v \\rangle V = \\left(\\frac{n_{e}}{2}\\right)^{2} \\langle \\sigma v \\rangle V.\n$$\n代入给定值，\n$$\nn_{e} = 1.0 \\times 10^{20}\\,\\text{m}^{-3},\\quad \\langle \\sigma v \\rangle = 1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1},\\quad V = 800\\,\\text{m}^{3},\n$$\n我们得到\n$$\nR = \\left( \\frac{1.0 \\times 10^{20}}{2} \\right)^{2} \\left( 1.0 \\times 10^{-22} \\right) \\left( 800 \\right)\n= \\left( 5.0 \\times 10^{19} \\right)^{2} \\times 1.0 \\times 10^{-22} \\times 800\n= 2.5 \\times 10^{39} \\times 10^{-22} \\times 800\n= 2.0 \\times 10^{20}\\,\\text{s}^{-1}.\n$$\n每次聚变反应产生一个能量为 $E_{\\alpha} = 3.5\\,\\text{MeV} = 3.5 \\times 10^{6}\\,\\text{eV}$ 的 alpha 粒子。使用 $1\\,\\text{eV} = 1.602 \\times 10^{-19}\\,\\text{J}$ 换算为焦耳，\n$$\nE_{\\alpha} = 3.5 \\times 10^{6} \\times 1.602 \\times 10^{-19}\\,\\text{J} = 5.607 \\times 10^{-13}\\,\\text{J}.\n$$\n因此总 alpha 功率为\n$$\nP_{\\alpha} = R E_{\\alpha} = \\left( 2.0 \\times 10^{20}\\,\\text{s}^{-1} \\right) \\left( 5.607 \\times 10^{-13}\\,\\text{J} \\right)\n= 1.1214 \\times 10^{8}\\,\\text{W} = 112.14\\,\\text{MW}.\n$$\n\n接下来，计算输运损失功率 $P_{i,\\text{trans}}$ 和 $P_{e,\\text{trans}}$。由于 $n_{i} = n_{e}$ 且 $T_{i} = T_{e}$，离子和电子的储能相等：\n$$\nW_{e} = \\frac{3}{2} n_{e} V k_{B} T_{e}, \\qquad W_{i} = \\frac{3}{2} n_{i} V k_{B} T_{i} = W_{e}.\n$$\n数值上，\n$$\nk_{B} T_{e} = \\left( 1.602 \\times 10^{-19}\\,\\text{J/eV} \\right) \\left( 1.5 \\times 10^{4}\\,\\text{eV} \\right) = 2.403 \\times 10^{-15}\\,\\text{J},\n$$\n且\n$$\nn_{e} V = \\left( 1.0 \\times 10^{20}\\,\\text{m}^{-3} \\right) \\left( 800\\,\\text{m}^{3} \\right) = 8.0 \\times 10^{22}.\n$$\n因此\n$$\nW_{e} = \\frac{3}{2} \\left( 8.0 \\times 10^{22} \\right) \\left( 2.403 \\times 10^{-15}\\,\\text{J} \\right)\n= \\frac{3}{2} \\left( 1.9224 \\times 10^{8}\\,\\text{J} \\right)\n= 2.8836 \\times 10^{8}\\,\\text{J}.\n$$\n当 $\\tau_{e} = 2.5\\,\\text{s}$ 且 $\\tau_{i} = 3.5\\,\\text{s}$ 时，\n$$\nP_{e,\\text{trans}} = \\frac{W_{e}}{\\tau_{e}} = \\frac{2.8836 \\times 10^{8}\\,\\text{J}}{2.5\\,\\text{s}} = 1.15344 \\times 10^{8}\\,\\text{W} = 115.344\\,\\text{MW},\n$$\n$$\nP_{i,\\text{trans}} = \\frac{W_{i}}{\\tau_{i}} = \\frac{2.8836 \\times 10^{8}\\,\\text{J}}{3.5\\,\\text{s}} = 8.23886 \\times 10^{7}\\,\\text{W} = 82.3886\\,\\text{MW}.\n$$\n\n现在写出每种情况下的稳态电子功率平衡方程。\n\n情况 A（无通道效应）：$P_{\\alpha \\rightarrow e}^{(A)} = P_{\\alpha}$ 且 $P_{\\alpha \\rightarrow i}^{(A)} = 0$。电子平衡方程给出\n$$\n0 = P_{\\alpha} + P_{e,\\text{ext}}^{(A)} - P_{e,\\text{trans}} - P_{\\text{rad}} \\quad \\Rightarrow \\quad\nP_{e,\\text{ext}}^{(A)} = P_{e,\\text{trans}} + P_{\\text{rad}} - P_{\\alpha}.\n$$\n\n情况 B（部分 $f$ 通道化至离子）：$P_{\\alpha \\rightarrow i}^{(B)} = f P_{\\alpha}$ 且 $P_{\\alpha \\rightarrow e}^{(B)} = (1 - f) P_{\\alpha}$。电子平衡方程给出\n$$\n0 = (1 - f) P_{\\alpha} + P_{e,\\text{ext}}^{(B)} - P_{e,\\text{trans}} - P_{\\text{rad}} \\quad \\Rightarrow \\quad\nP_{e,\\text{ext}}^{(B)} = P_{e,\\text{trans}} + P_{\\text{rad}} - (1 - f) P_{\\alpha}.\n$$\n\n所要求的外部电子加热功率的变化量为\n$$\n\\Delta P_{e,\\text{ext}} \\equiv P_{e,\\text{ext}}^{(B)} - P_{e,\\text{ext}}^{(A)} = \\left[ P_{e,\\text{trans}} + P_{\\text{rad}} - (1 - f) P_{\\alpha} \\right] - \\left[ P_{e,\\text{trans}} + P_{\\text{rad}} - P_{\\alpha} \\right] = f P_{\\alpha}.\n$$\n因此，该变化量仅取决于通道化比例和总 alpha 功率。当 $f = 0.30$ 且 $P_{\\alpha} = 112.14\\,\\text{MW}$ 时，\n$$\n\\Delta P_{e,\\text{ext}} = f P_{\\alpha} = 0.30 \\times 112.14\\,\\text{MW} = 33.642\\,\\text{MW}.\n$$\n四舍五入到三位有效数字并以 $\\text{MW}$ 为单位表示，该变化量为 $33.6\\,\\text{MW}$。",
            "answer": "$$\\boxed{33.6}$$"
        },
        {
            "introduction": "在了解了总体的功率平衡之后，下一步是理解聚变功率在空间上的分布。阿尔法粒子的加热剖面对于等离子体的稳定性和整体性能至关重要，它直接受密度和温度剖面形状的影响。本练习通过对比密度和温度 peaked 的两种理想情况，让学生定量分析剖面参数如何决定阿尔法加热的集中程度，从而揭示聚变燃烧等离子体中自我加热过程的内在物理 。",
            "id": "3956500",
            "problem": "一个具有大环径比的环形氘-氚（D-T）聚变等离子体，其大半径为 $R_{0}$，小半径为 $a$。假设轴对称、磁通面平均的物理量仅依赖于小半径 $r \\in [0,a]$，并定义归一化半径 $x = r/a$。该等离子体是等摩尔的，因此 $n_{D}(r) = n_{T}(r) = n(r)/2$。聚变阿尔法粒子产生源密度由标准定义给出：$S_{\\alpha}(r) = n_{D}(r)\\,n_{T}(r)\\,\\langle \\sigma v \\rangle(T(r))$，其中 $\\langle \\sigma v \\rangle(T)$ 是反应率。在与燃烧等离子体相关的温度范围内，用幂律 $\\langle \\sigma v \\rangle(T) = K\\,T(r)^{\\nu}$ 来近似反应率，其中常数 $K0$ 且指数 $\\nu0$。\n\n考虑两种其他方面相同，具有相同中心密度 $n_{0}$ 和中心温度 $T_{0}$，但分布剖面形状不同的等离子体：\n\n1. 密度峰化情况：$n(r) = n_{0}(1 - x^{2})^{\\alpha_{p}}$ 且 $T(r) = T_{0}$。\n2. 温度峰化情况：$n(r) = n_{0}$ 且 $T(r) = T_{0}(1 - x^{2})^{\\beta_{p}}$。\n\n假设在慢化极限下阿尔法粒子能量是局域沉积的，因此阿尔法粒子加热密度 $H_{\\alpha}(r)$ 与 $S_{\\alpha}(r)$ 成正比，并使用大环径比环近似，其中微分体积元满足 $dV \\propto r\\,dr$。作为加热分布宽度的一种度量，定义加热剖面的截面加权均方半径为\n$$\n\\langle r^{2} \\rangle \\equiv \\frac{\\int_{0}^{a} r^{2}\\,H_{\\alpha}(r)\\,r\\,dr}{\\int_{0}^{a} H_{\\alpha}(r)\\,r\\,dr}.\n$$\n以闭合解析形式计算比值\n$$\n\\mathcal{R} \\equiv \\frac{\\langle r^{2} \\rangle_{\\text{temperature-peaked}}}{\\langle r^{2} \\rangle_{\\text{density-peaked}}}\n$$\n将其表示为峰化指数 $\\alpha_{p}$、$\\beta_{p}$ 和反应率指数 $\\nu$ 的函数。您的最终答案必须是单一的闭合形式表达式。不需要进行四舍五入，最终表达式中不应包含任何单位。",
            "solution": "阿尔法粒子产生源密度 $S_{\\alpha}(r)$ 由下式给出\n$$\nS_{\\alpha}(r) = n_{D}(r)\\,n_{T}(r)\\,\\langle \\sigma v \\rangle(T(r))\n$$\n给定一个等摩尔的氘-氚（D-T）等离子体，有 $n_{D}(r) = n_{T}(r) = n(r)/2$。反应率用幂律近似为 $\\langle \\sigma v \\rangle(T) = K\\,T(r)^{\\nu}$。将这些代入源的定义中可得\n$$\nS_{\\alpha}(r) = \\left(\\frac{n(r)}{2}\\right) \\left(\\frac{n(r)}{2}\\right) K\\,T(r)^{\\nu} = \\frac{K}{4} n(r)^2 T(r)^{\\nu}\n$$\n问题陈述阿尔法粒子加热密度 $H_{\\alpha}(r)$ 与 $S_{\\alpha}(r)$ 成正比，因此我们可以写成 $H_{\\alpha}(r) = C' S_{\\alpha}(r)$，其中 $C'$ 为某个常数。截面加权均方半径定义为\n$$\n\\langle r^{2} \\rangle \\equiv \\frac{\\int_{0}^{a} r^{2}\\,H_{\\alpha}(r)\\,r\\,dr}{\\int_{0}^{a} H_{\\alpha}(r)\\,r\\,dr} = \\frac{\\int_{0}^{a} r^{3}\\,S_{\\alpha}(r)\\,dr}{\\int_{0}^{a} r\\,S_{\\alpha}(r)\\,dr}\n$$\n$S_{\\alpha}(r)$ 中的常数前因子 $C'K/4$ 会在分子和分母中被约去，因此我们在计算中可以忽略它。\n\n使用归一化半径 $x=r/a$ 进行计算会很方便。微分关系为 $dr = a\\,dx$。$x$ 的积分限为从 $0$ 到 $1$。\n$$\n\\langle r^{2} \\rangle = \\frac{\\int_{0}^{1} (ax)^{3}\\,S_{\\alpha}(x)\\,a\\,dx}{\\int_{0}^{1} (ax)\\,S_{\\alpha}(x)\\,a\\,dx} = \\frac{a^4 \\int_{0}^{1} x^{3}\\,S_{\\alpha}(x)\\,dx}{a^2 \\int_{0}^{1} x\\,S_{\\alpha}(x)\\,dx} = a^2 \\frac{\\int_{0}^{1} x^{3}\\,S_{\\alpha}(x)\\,dx}{\\int_{0}^{1} x\\,S_{\\alpha}(x)\\,dx}\n$$\n我们现在将对两种指定情况计算此表达式。\n\n情况1：密度峰化等离子体\n密度和温度剖面由 $n(r) = n_{0}(1 - x^{2})^{\\alpha_{p}}$ 和 $T(r) = T_{0}$ 给出。源项（忽略将约去的常数因子如 $n_0$ 和 $T_0$）为\n$$\nS_{\\alpha, \\text{dp}}(x) \\propto n(x)^2 T(x)^{\\nu} \\propto \\left( (1-x^2)^{\\alpha_p} \\right)^2 T_0^{\\nu} \\propto (1-x^2)^{2\\alpha_p}\n$$\n让我们定义一个在计算 $\\langle r^2 \\rangle$ 中出现的通用积分形式。分子和分母的积分都具有 $\\int_0^1 x^m (1-x^2)^\\gamma dx$ 的形式。令 $u = x^2$，则 $du = 2x\\,dx$ 或 $x\\,dx = du/2$。\n$$\n\\int_0^1 x (1-x^2)^\\gamma dx = \\int_0^1 (1-u)^\\gamma \\frac{du}{2} = \\frac{1}{2} \\left[ -\\frac{(1-u)^{\\gamma+1}}{\\gamma+1} \\right]_0^1 = \\frac{1}{2(\\gamma+1)}\n$$\n$$\n\\int_0^1 x^3 (1-x^2)^\\gamma dx = \\int_0^1 x^2 (1-x^2)^\\gamma (x\\,dx) = \\int_0^1 u(1-u)^\\gamma \\frac{du}{2}\n$$\n这是 $\\frac{1}{2}$ 乘以贝塔函数 $B(2, \\gamma+1) = \\frac{\\Gamma(2)\\Gamma(\\gamma+1)}{\\Gamma(2+\\gamma+1)} = \\frac{1!\\Gamma(\\gamma+1)}{(\\gamma+2)(\\gamma+1)\\Gamma(\\gamma+1)} = \\frac{1}{(\\gamma+1)(\\gamma+2)}$。\n所以，该积分为 $\\frac{1}{2(\\gamma+1)(\\gamma+2)}$。\n这些积分的比值为\n$$\n\\frac{\\int_{0}^{1} x^{3}\\,(1-x^2)^\\gamma\\,dx}{\\int_{0}^{1} x\\,(1-x^2)^\\gamma\\,dx} = \\frac{1/(2(\\gamma+1)(\\gamma+2))}{1/(2(\\gamma+1))} = \\frac{1}{\\gamma+2}\n$$\n对于密度峰化的情况，源剖面的指数为 $\\gamma_{\\text{dp}} = 2\\alpha_p$。因此，\n$$\n\\langle r^{2} \\rangle_{\\text{density-peaked}} = a^2 \\frac{1}{2\\alpha_p+2}\n$$\n\n情况2：温度峰化等离子体\n密度和温度剖面由 $n(r) = n_{0}$ 和 $T(r) = T_{0}(1 - x^{2})^{\\beta_{p}}$ 给出。源项（同样忽略常数）为\n$$\nS_{\\alpha, \\text{tp}}(x) \\propto n(x)^2 T(x)^{\\nu} \\propto n_0^2 \\left( (1-x^2)^{\\beta_p} \\right)^{\\nu} \\propto (1-x^2)^{\\nu\\beta_p}\n$$\n其函数形式与前一种情况相同。源剖面的指数为 $\\gamma_{\\text{tp}} = \\nu\\beta_p$。\n使用上面推导出的相同通用结果，我们得到\n$$\n\\langle r^{2} \\rangle_{\\text{temperature-peaked}} = a^2 \\frac{1}{\\nu\\beta_p+2}\n$$\n\n最后，我们按要求计算比值 $\\mathcal{R}$：\n$$\n\\mathcal{R} \\equiv \\frac{\\langle r^{2} \\rangle_{\\text{temperature-peaked}}}{\\langle r^{2} \\rangle_{\\text{density-peaked}}} = \\frac{a^2 \\frac{1}{\\nu\\beta_p+2}}{a^2 \\frac{1}{2\\alpha_p+2}}\n$$\n$$\n\\mathcal{R} = \\frac{2\\alpha_p+2}{\\nu\\beta_p+2}\n$$\n该表达式给出了加热剖面均方半径的比值，它是密度峰化指数 $\\alpha_p$、温度峰化指数 $\\beta_p$ 和反应率指数 $\\nu$ 的函数。",
            "answer": "$$\\boxed{\\frac{2\\alpha_p+2}{\\nu\\beta_p+2}}$$"
        },
        {
            "introduction": "聚变功率产生的核心是聚变反应率系数 $\\langle \\sigma v \\rangle$，它是决定等离子体能量输出的微观基础。本练习要求从第一性原理出发，设计并实现一个完整的数值计算流程，用于从实验测量的截面数据计算反应率系数。这项综合性实践不仅涵盖了动力学理论和数值积分方法（如高斯-拉盖尔求积），还包括了对截面数据不确定性的统计传播分析，是连接理论物理与计算科学的桥梁 。",
            "id": "3956420",
            "problem": "您的任务是设计并实现一个数值积分策略，用以计算燃烧等离子体的热核反应率系数。该系数由碰撞截面、相对速度和能量空间中的麦克斯韦-玻尔兹曼概率密度的乘积的积分定义。基本依据是反应率系数由第一性原理通过相对速度分布的积分以及动能与速度之间的关系定义。请从以下核心定义开始：\n- 温度为 $T$ 时，具有约化质量 $\\mu$ 的两个粒子的相对速度的麦克斯韦-玻尔兹曼分布为 $f_v(v;T)$，这是动力学理论中一个经过充分检验的结果。能量-速度关系为 $E = \\tfrac{1}{2}\\,\\mu\\,v^2$，反应率系数定义为 $\\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v)\\, v\\, f_v(v;T)\\, dv$。\n- 反应截面作为质心动能 $E$ 的函数以表格形式给出，并附有不确定度。\n\n您的程序必须基于这些基本事实，推导出一个计算上可靠且高效的积分策略，该策略应能：\n- 将积分变换为能量空间中的数值稳定形式，然后进一步变换为一个无量纲变量，以分离源于热统计的指数权重。\n- 从带有独立分数一西格玛不确定度 $u_i$ 的列表数据 $(E_i,\\sigma_i)$ 中精确插值 $\\sigma(E)$，强制保证 $\\sigma(E)$ 的物理正定性，并在积分节点需要时，在列表范围之外提供合理的外推。\n- 使用统计上合理的方法，将列表中的不确定度传播到最终的 $\\langle \\sigma v \\rangle$ 值，得到其均值和一西格玛标准差。\n\n使用的物理单位和常数：\n- 测试套件中的所有温度均以 $\\mathrm{keV}$ 为单位指定，并且必须使用 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 转换为以 $\\mathrm{J}$ 为单位的 $k_B T$，因此 $1\\,\\mathrm{keV} = 10^3\\,\\mathrm{eV}$。\n- 截面以靶（barns）为单位指定，并且必须使用 $1\\,\\mathrm{barn} = 10^{-28}\\,\\mathrm{m}^2$ 转换为 $\\mathrm{m}^2$。\n- 约化质量 $\\mu$ 必须由氘-氚对计算得出，其中 $m_D = 2.013553212745\\,\\mathrm{u}$ 和 $m_T = 3.01550071632\\,\\mathrm{u}$，且 $1\\,\\mathrm{u} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$。\n- 玻尔兹曼常数为 $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n- 最终的反应率系数 $\\langle \\sigma v \\rangle$ 必须以 $\\mathrm{m}^3/\\mathrm{s}$ 为单位报告。\n\n物理上合理的氘-氚反应的列表化截面数据（能量单位为 $\\mathrm{keV}$，截面单位为靶，不确定度为分数一西格玛小数）：\n- $i=1,\\dots,6$ 的 $(E_i,\\sigma_i,u_i)$：\n  - $(1, 1.0\\times 10^{-3}, 0.20)$\n  - $(5, 5.0\\times 10^{-2}, 0.10)$\n  - $(10, 2.0\\times 10^{-1}, 0.10)$\n  - $(20, 1.0, 0.05)$\n  - $(50, 4.5, 0.05)$\n  - $(100, 3.0, 0.10)$\n\n不确定度传播要求：\n- 将列表中的不确定度 $u_i$ 视为独立的分数一西格玛不确定度。您的程序必须通过应用一种统计上一致的程序来计算所得的 $\\langle \\sigma v \\rangle$ 的均值和一西格玛标准差，该程序应确保在采样过程中所有能量下的 $\\sigma(E)0$。\n\n数值积分要求：\n- 您的策略必须有理论依据：推导出一个以无量纲变量表示的积分形式，该形式能揭示一个指数权重，并选择与该权重匹配的积分方法。您的实现必须证明该选择的合理性，并对积分节点处的 $\\sigma(E)$ 执行相应的插值。\n- 您的插值方法应在对数-对数空间中保形且单调，以反映典型的截面行为并保持正定性。对于超出列表范围的外推，必须以一种在热权重下仍保持物理合理性的方式处理。\n\n您的程序必须实现上述要求并计算以下测试套件。对所有测试用例使用相同的列表化截面和约化质量，仅改变等离子体温度：\n- 测试温度 $T$（单位 $\\mathrm{keV}$）：\n  - $0.1$\n  - $0.5$\n  - $10$\n  - $50$\n\n对于每个测试温度，计算：\n- 标称的 $\\langle \\sigma v \\rangle$（单位 $\\mathrm{m}^3/\\mathrm{s}$）及其一西格玛不确定度（单位 $\\mathrm{m}^3/\\mathrm{s}$），两者均以浮点数表示。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按 $[\\mathrm{mean}_{T_1},\\mathrm{std}_{T_1},\\mathrm{mean}_{T_2},\\mathrm{std}_{T_2},\\mathrm{mean}_{T_3},\\mathrm{std}_{T_3},\\mathrm{mean}_{T_4},\\mathrm{std}_{T_4}]$ 的顺序展开。\n- 所有值必须以 $\\mathrm{m}^3/\\mathrm{s}$ 为单位表示。\n\n角度单位不涉及。如果在推导过程中使用了任何中间角度，它们必须以弧度处理，但所需的计算中不出现任何角度。\n\n科学真实性与约束条件：\n- 确保积分、插值和不确定度传播遵循动力学理论和数值分析的原理，并且是自洽的。\n- 不要假设问题陈述中给出了目标积分的任何快捷公式。您的推导和算法必须完全基于上述基本定义。\n\n您的实现必须是确定性且自包含的，不读取任何输入文件。您可以选择合理的数值参数，如积分节点的数量和不确定度样本的数量，但需在解决方案中证明其合理性。最终输出必须以 $\\mathrm{m}^3/\\mathrm{s}$ 为单位，表示为浮点数。",
            "solution": "该问题要求设计并实现一个数值策略，用于计算氘-氚等离子体的热核反应率系数 $\\langle \\sigma v \\rangle$。这涉及使用带有不确定度的列表化截面数据，对粒子能量分布进行积分。该解决方案从第一性原理出发，包含对控制积分的解析变换、一个稳健的数值积分方案、一个具有物理动机的截面数据插值方法，以及一个统计上可靠的不确定度传播方法。\n\n### 1. 反应率积分的解析公式\n\n反应率系数的基本定义是反应截面 $\\sigma$ 与相对粒子速度 $v$ 的乘积在归一化相对速度分布 $f_v(v;T)$ 上的平均值。温度以能量单位给出，我们将其表示为 $\\mathcal{T}$。\n$$\n\\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v) v f_v(v;\\mathcal{T}) dv\n$$\n对于处于热平衡的系统，在热能为 $\\mathcal{T}$（等效于 $k_B T$）时，具有约化质量 $\\mu$ 的两种粒子之间的相对速度分布是三维麦克斯韦-玻尔兹曼速率分布：\n$$\nf_v(v;\\mathcal{T}) = 4\\pi v^2 \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\exp\\left(-\\frac{\\mu v^2}{2\\mathcal{T}}\\right)\n$$\n将此分布代入 $\\langle \\sigma v \\rangle$ 的定义中，得到：\n$$\n\\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v) v \\left[ 4\\pi v^2 \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\exp\\left(-\\frac{\\mu v^2}{2\\mathcal{T}}\\right) \\right] dv\n$$\n$$\n\\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\int_0^\\infty \\sigma(v) v^3 \\exp\\left(-\\frac{\\mu v^2}{2\\mathcal{T}}\\right) dv\n$$\n截面数据 $\\sigma$ 是作为质心动能 $E$ 的函数提供的。能量与相对速度之间的关系是 $E = \\frac{1}{2}\\mu v^2$。我们执行从速度 $v$ 到能量 $E$ 的变量替换：\n$$\nv = \\sqrt{\\frac{2E}{\\mu}}, \\quad dv = \\frac{1}{2} \\sqrt{\\frac{2}{\\mu E}} dE = \\frac{dE}{\\sqrt{2\\mu E}}\n$$\n通过这个变量替换，$v^3 dv$ 项变换为：\n$$\nv^3 dv = \\left(\\frac{2E}{\\mu}\\right)^{3/2} \\frac{dE}{\\sqrt{2\\mu E}} = \\frac{2^{3/2} E^{3/2}}{\\mu^{3/2}} \\frac{1}{2^{1/2} \\mu^{1/2} E^{1/2}} dE = \\frac{2E}{\\mu^2} dE\n$$\n指数项变为 $\\exp(-E/\\mathcal{T})$。将这些代入积分中，得到：\n$$\n\\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\int_0^\\infty \\sigma(E) \\frac{2E}{\\mu^2} \\exp\\left(-\\frac{E}{\\mathcal{T}}\\right) dE\n$$\n简化常数前置因子：\n$$\n4\\pi \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\frac{2}{\\mu^2} = \\frac{8\\pi \\mu^{3/2}}{(2\\pi)^{3/2} \\mathcal{T}^{3/2} \\mu^2} = \\frac{2^3 \\pi}{2^{3/2} \\pi^{3/2} \\mu^{1/2} \\mathcal{T}^{3/2}} = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{\\mathcal{T}^{3/2}}\n$$\n这导出了反应率系数在能量空间中的标准表示形式：\n$$\n\\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{\\mathcal{T}^{3/2}} \\int_0^\\infty \\sigma(E) E \\exp\\left(-\\frac{E}{\\mathcal{T}}\\right) dE\n$$\n为了获得一个适合标准数值积分的无量纲积分，我们引入无量纲变量 $x = E/\\mathcal{T}$。这给出 $E = x\\mathcal{T}$ 和 $dE = \\mathcal{T}dx$。积分变为：\n$$\n\\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{\\mathcal{T}^{3/2}} \\int_0^\\infty \\sigma(x\\mathcal{T}) (x\\mathcal{T}) \\exp(-x) (\\mathcal{T}dx)\n$$\n$$\n\\langle \\sigma v \\rangle = \\sqrt{\\frac{8\\mathcal{T}}{\\pi\\mu}} \\int_0^\\infty \\left[x \\sigma(x\\mathcal{T})\\right] \\exp(-x) dx\n$$\n这个最终形式在数值上是理想的。积分是关于一个无量纲变量的，并且具有典型的权重函数 $\\exp(-x)$，对此存在高效的积分法则。\n\n### 2. 数值积分与插值\n\n该积分的形式为 $\\int_0^\\infty f(x) e^{-x} dx$，其中 $f(x) = x \\sigma(x\\mathcal{T})$。对此类积分最适合的数值方法是高斯-拉盖尔积分，它将积分近似为一个加权和：\n$$\n\\int_0^\\infty f(x) e^{-x} dx \\approx \\sum_{j=1}^{N} w_j f(x_j)\n$$\n其中 $x_j$ 是 $N$ 阶拉盖尔​多项式 $L_N(x)$ 的根（节点），$w_j$ 是相应的权重。我们选择 $N=32$，这个选择对于平滑变化的被积函数能提供高度的准确性，同时平衡了精度和计算成本。\n\n计算需要在能量 $E_j = x_j \\mathcal{T}$ 处得到截面 $\\sigma(E)$ 的值。由于 $\\sigma(E)$ 是以一组离散点 $(E_i, \\sigma_i)$ 的形式给出的，必须通过插值构建一个连续模型。为了强制正定性并反映截面在远离共振区时典型的类幂律行为，我们对数据的对数进行线性插值：即 $\\log(\\sigma)$ 对 $\\log(E)$ 进行插值。对于任意能量 $E$，我们通过在列表化点 $(\\log(E_i), \\log(\\sigma_i))$ 之间进行线性插值来找到 $\\log(\\sigma(E))$。这等效于一个分段幂律模型，该模型在物理上是合理的，并能保证 $\\sigma(E) > 0$。对于超出列表范围 $[E_{\\min}, E_{\\max}]$ 的能量，我们在对数-对数空间中应用线性外推，对于 $E  E_{\\min}$ 使用前两个点定义的斜率，对于 $E > E_{\\max}$ 使用最后两个点定义的斜率。\n\n### 3. 不确定度传播\n\n列表化的截面 $\\sigma_i$ 附有独立的分数一西格玛不确定度 $u_i = \\delta\\sigma_i / \\sigma_i$。为了将这些不确定度传播到 $\\langle \\sigma v \\rangle$ 的最终值，我们采用蒙特卡洛模拟。这种方法稳健可靠，并且能自然地处理由对数-对数插值和积分过程引入的非线性依赖关系。\n\n为确保 $\\sigma > 0$ 的物理约束，我们将每个 $\\sigma_i$ 建模为遵循对数正态分布的随机变量。每个数据点的对数正态分布参数的选择是为了匹配给定的标称值和分数不确定度。如果 $Y = \\log(\\sigma)$ 是一个均值为 $\\mu_Y$、标准差为 $\\sigma_Y$ 的正态分布，那么 $\\sigma=\\exp(Y)$ 的分数不确定度为 $u = \\sqrt{\\exp(\\sigma_Y^2) - 1}$。由此，我们推导出其底层正态变量的标准差为 $\\sigma_Y = \\sqrt{\\log(u^2+1)}$。对数正态分布的均值为 $E[\\sigma] = \\sigma_{i,\\text{nominal}} = \\exp(\\mu_Y + \\sigma_Y^2/2)$，因此底层正态变量的均值为 $\\mu_Y = \\log(\\sigma_{i,\\text{nominal}}) - \\sigma_Y^2/2$。\n\n不确定度分析按以下步骤进行：\n1.  总共执行 $M=2000$ 次蒙特卡洛试验。这个数量足以获得稳定的均值和标准差统计数据。\n2.  在每次试验中，通过从各自的对数正态分布中抽样，生成一组新的截面值 $\\{\\sigma_{i}^{(k)}\\}_{i=1 \\dots 6}$。\n3.  对于每次实现 $k$，使用上述的高斯-拉盖尔积分和对数-对数插值方案计算反应率系数 $\\langle \\sigma v \\rangle^{(k)}$。\n4.  最终报告的不确定度是所得的 $M$ 个 $\\langle \\sigma v \\rangle$ 值分布的样本标准差。标称值是使用未扰动的标称截面数据计算一次得到的。\n\n所有物理常数和数据都转换并以国际单位制（米、千克、秒、焦耳）处理，以确保 $\\langle \\sigma v \\rangle$ 的最终结果能正确地以 $\\mathrm{m}^3/\\mathrm{s}$ 表示。最后，通过为伪随机数生成器设置种子来确保结果的确定性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_laguerre\n\ndef solve():\n    \"\"\"\n    Computes the D-T thermonuclear reaction rate coefficient and its uncertainty.\n    \"\"\"\n    # ------------------\n    # 1. CONSTANTS AND DATA\n    # ------------------\n\n    # Physical Constants\n    E_CHARGE = 1.602176634e-19  # J/eV\n    AMU_KG = 1.66053906660e-27    # kg/u\n    BARN_M2 = 1.0e-28            # m^2/barn\n\n    # Masses in atomic mass units (u)\n    M_D_U = 2.013553212745\n    M_T_U = 3.01550071632\n\n    # Tabulated cross-section data for D-T reaction\n    # (Energy_keV, Sigma_barns, Fractional_Uncertainty)\n    SIGMA_DATA = np.array([\n        (1.0, 1.0e-3, 0.20),\n        (5.0, 5.0e-2, 0.10),\n        (10.0, 2.0e-1, 0.10),\n        (20.0, 1.0, 0.05),\n        (50.0, 4.5, 0.05),\n        (100.0, 3.0, 0.10),\n    ])\n\n    # Test cases: Plasma temperatures in keV\n    TEST_TEMPERATURES_KEV = [0.1, 0.5, 10, 50]\n\n    # Numerical parameters\n    QUADRATURE_ORDER = 32\n    MC_SAMPLES = 2000\n    RNG_SEED = 42\n\n    # ------------------\n    # 2. DATA PRE-PROCESSING\n    # ------------------\n    \n    # Set seed for reproducibility\n    np.random.seed(RNG_SEED)\n\n    # Calculate reduced mass in kg\n    mu_u = (M_D_U * M_T_U) / (M_D_U + M_T_U)\n    mu_kg = mu_u * AMU_KG\n\n    # Convert tabulated data to SI units (J, m^2)\n    e_table_keV = SIGMA_DATA[:, 0]\n    sigma_table_barn = SIGMA_DATA[:, 1]\n    u_table = SIGMA_DATA[:, 2]\n\n    e_table_j = e_table_keV * 1000.0 * E_CHARGE\n    sigma_table_m2 = sigma_table_barn * BARN_M2\n\n    # Pre-calculate logs for log-log interpolation\n    log_e_table_j = np.log(e_table_j)\n    log_sigma_table_m2 = np.log(sigma_table_m2)\n\n    # Pre-calculate Gauss-Laguerre nodes and weights\n    quad_nodes, quad_weights = roots_laguerre(QUADRATURE_ORDER)\n\n    # ------------------\n    # 3. CORE FUNCTIONS\n    # ------------------\n\n    def interp_extrap_loglog(log_e_query_j, log_e_ref_j, log_sigma_ref_m2):\n        \"\"\"\n        Performs linear interpolation and extrapolation in log-log space.\n        \"\"\"\n        log_sigma_interp = np.interp(log_e_query_j, log_e_ref_j, log_sigma_ref_m2)\n\n        # Boolean masks for extrapolation\n        low_extrap_mask = log_e_query_j  log_e_ref_j[0]\n        high_extrap_mask = log_e_query_j > log_e_ref_j[-1]\n\n        # Low-energy extrapolation\n        if np.any(low_extrap_mask):\n            slope_low = (log_sigma_ref_m2[1] - log_sigma_ref_m2[0]) / \\\n                        (log_e_ref_j[1] - log_e_ref_j[0])\n            offset = log_sigma_ref_m2[0] - slope_low * log_e_ref_j[0]\n            log_sigma_interp[low_extrap_mask] = slope_low * log_e_query_j[low_extrap_mask] + offset\n\n        # High-energy extrapolation\n        if np.any(high_extrap_mask):\n            slope_high = (log_sigma_ref_m2[-1] - log_sigma_ref_m2[-2]) / \\\n                         (log_e_ref_j[-1] - log_e_ref_j[-2])\n            offset = log_sigma_ref_m2[-1] - slope_high * log_e_ref_j[-1]\n            log_sigma_interp[high_extrap_mask] = slope_high * log_e_query_j[high_extrap_mask] + offset\n\n        return np.exp(log_sigma_interp)\n\n    def calculate_rate_coeff(temp_kev, log_e_j, current_log_sigma_m2):\n        \"\"\"\n        Calculates the reaction rate coefficient for a given temperature and sigma table.\n        \"\"\"\n        # Convert temperature to Joules\n        temp_j = temp_kev * 1000.0 * E_CHARGE\n\n        # Energies at which to evaluate sigma, based on quadrature nodes\n        energies_j = temp_j * quad_nodes\n        \n        # Interpolate sigma at the required energies\n        sigma_at_nodes_m2 = interp_extrap_loglog(np.log(energies_j), log_e_j, current_log_sigma_m2)\n\n        # The function to integrate is f(x) = x * sigma(x*T)\n        integrand_values = quad_nodes * sigma_at_nodes_m2\n\n        # Perform the quadrature sum\n        integral_val = np.sum(quad_weights * integrand_values)\n\n        # Calculate the pre-factor\n        pre_factor = np.sqrt(8.0 * temp_j / (np.pi * mu_kg))\n\n        return pre_factor * integral_val\n\n    # ------------------\n    # 4. MAIN CALCULATION LOOP\n    # ------------------\n\n    final_results = []\n    \n    # Calculate log-normal distribution parameters for MC sampling\n    log_sigma_stds = np.sqrt(np.log(u_table**2 + 1))\n    log_sigma_means = log_sigma_table_m2 - 0.5 * log_sigma_stds**2\n\n    for temp_kev in TEST_TEMPERATURES_KEV:\n        # Calculate nominal value with unperturbed cross-sections\n        nominal_rate = calculate_rate_coeff(temp_kev, log_e_table_j, log_sigma_table_m2)\n\n        # Monte Carlo simulation for uncertainty\n        mc_rates = np.zeros(MC_SAMPLES)\n        for i in range(MC_SAMPLES):\n            # Generate a perturbed set of cross-sections\n            perturbed_log_sigma_table = np.random.normal(log_sigma_means, log_sigma_stds)\n            \n            # Calculate rate for this perturbed set\n            mc_rates[i] = calculate_rate_coeff(temp_kev, log_e_table_j, perturbed_log_sigma_table)\n        \n        # Calculate the standard deviation of the results\n        std_dev_rate = np.std(mc_rates, ddof=1)\n\n        final_results.extend([nominal_rate, std_dev_rate])\n\n    # ------------------\n    # 5. FINAL OUTPUT\n    # ------------------\n    \n    # Print the results in the required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}