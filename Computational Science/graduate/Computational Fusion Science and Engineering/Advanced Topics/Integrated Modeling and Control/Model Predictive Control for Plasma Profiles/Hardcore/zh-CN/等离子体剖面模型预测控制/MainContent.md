## 引言
在寻求可持续[聚变能](@entry_id:138601)源的道路上，对[托卡马克](@entry_id:160432)中高温等离子体的精确控制是实现[稳态](@entry_id:139253)、高性能运行的核心挑战。等离子体的行为由多尺度、[多物理场](@entry_id:164478)过程控制，呈现出高度耦合、[非线性](@entry_id:637147)的动态特性，并受到严格的物理与工程运行约束。传统的控制方法往往难以应对如此复杂的系统，这构成了当前聚变控制领域的一个关键知识缺口。模型预测控制（MPC）作为一种先进的控制策略，通过其基于模型的预测能力和对约束的显式处理能力，为解决这一挑战提供了强有力的框架。

本文旨在全面而深入地探讨模型预测控制在[等离子体剖面控制](@entry_id:1129800)中的应用。通过本文的学习，读者将掌握从理论到实践的全过程。我们将分三个章节展开：

在“原理与机制”一章中，我们将奠定理论基石，深入剖析如何为控制目的建立等离子体模型，如何构建MPC优化问题，以及如何通过精巧的设计保证控制器的稳定与鲁棒。
接着，在“应用与跨学科联系”一章中，我们将展示MPC在实际聚变场景中的强大威力，探讨其如何用于优化运行效率、主动预防灾难性的不稳定性，并揭示其核心思想如何与其他前沿科学领域（如生物医学工程）产生共鸣。
最后，在“动手实践”部分，您将通过一系列精心设计的编程练习，将理论知识转化为解决实际问题的能力，亲手构建和评估一个[等离子体控制](@entry_id:753487)器。

让我们首先从MPC的核心——其背后的科学原理与工程机制——开始探索。

## 原理与机制

本章旨在深入阐述用于[等离子体剖面控制](@entry_id:1129800)的[模型预测控制](@entry_id:1128006)（MPC）背后的核心科学原理与工程机制。我们将从等离子体物理的基础出发，构建适用于控制的数学模型，系统地阐述MPC优化问题的构建，并探讨保证控制器稳定性、鲁棒性及实时性的关键理论与技术。本章内容将为后续章节中关于算法实现与应用的讨论奠定坚实的基础。

### 控制导向的等离子体建模

模型预测控制的性能在很大程度上取决于其内部模型的准确性与适用性。对于托卡马克等离子体剖面控制而言，我们的目标是构建一个既能捕捉关键物理过程，又能在计算上易于处理的模型。这通常涉及从复杂的[偏微分](@entry_id:194612)方程（PDE）物理模型到适用于控制算法的[状态空间表示](@entry_id:147149)的简化过程。

#### 连续时间输运模型

现代托卡马克等离子体的核心剖面，如[电子温度](@entry_id:180280)（$T_e$）、[离子温度](@entry_id:191275)（$T_i$）、电子密度（$n_e$）以及安全因子（$q$），其演化主要由径向输运过程决定。在控制周期的特征时间尺度（通常为能量和[粒子约束时间](@entry_id:753199)）上，这些过程可以由一组耦合的一维（径向）反应-扩散-对流方程来描述。

一个适用于模型预测控制的最小但物理耦合的PD[E模](@entry_id:160271)型集，必须包含描述剖面间相互作用的关键项。例如，一个典型的模型集包括 ：
1.  **[能量守恒方程](@entry_id:748978)（$T_e$ 和 $T_i$）**：这些方程描述了热量的输运。其核心是傅里叶式的热流，表现为扩散项。源项包括外部辅助加热（如[电子回旋共振加热](@entry_id:748908)ECRH、中性束注入NBI）、[欧姆加热](@entry_id:190028)（电流流经等离子体电阻产生的热量，$\eta(T_e)j^2$），以及电子和离子之间的[碰撞能量](@entry_id:183483)交换。这种交换是一个弛豫过程，正比于温度差 $(T_e - T_i)$，是连接电子和离子温度动态的关键。
2.  **粒子守恒方程（$n_e$）**：该方程描述了[等离子体密度](@entry_id:202836)的演化，通常由[菲克定律](@entry_id:155177)描述的扩散项和外部粒子源（如充气）项构成。在核心等离子体中，对流（粒子箍缩）效应有时可以被简化或忽略，以获得更易于处理的模型。
3.  **磁通[扩散方程](@entry_id:170713)（$q$ 或电流密度 $j$）**：安全因子 $q$ 剖面与环向电流密度 $j$ 剖面密切相关。电流密度的演化可以通过磁通扩散方程来描述，其扩散系数即为[磁扩散](@entry_id:187718)率 $\eta/\mu_0$。一个关键的物理耦合在于，[等离子体电阻率](@entry_id:196902)（[斯皮策电阻率](@entry_id:190492)）强烈依赖于[电子温度](@entry_id:180280)，通常为 $\eta \propto T_e^{-3/2}$。这意味着温度剖面的变化会直接影响电流的重新分布，进而改变 $q$ 剖面。此方程还必须包含由外部驱动（如低混杂波电流驱动）和等离子体自身产生的自举电流的源项。

因此，一个最小的耦合模型集可写为如下形式：
$$ \frac{\partial}{\partial t}\left(\frac{3}{2} n_e T_e\right) = \frac{1}{r}\frac{\partial}{\partial r}\left(r n_e \chi_e \frac{\partial T_e}{\partial r}\right) + \eta(T_e) j^2 + P_{e,\mathrm{aux}} - Q_{ei} $$
$$ \frac{\partial}{\partial t}\left(\frac{3}{2} n_i T_i\right) = \frac{1}{r}\frac{\partial}{\partial r}\left(r n_i \chi_i \frac{\partial T_i}{\partial r}\right) + P_{i,\mathrm{aux}} + Q_{ei} $$
$$ \frac{\partial n_e}{\partial t} = \frac{1}{r}\frac{\partial}{\partial r}\left(r D \frac{\partial n_e}{\partial r}\right) + S_n $$
$$ \frac{\partial j}{\partial t} \approx \frac{1}{\mu_0 r}\frac{\partial}{\partial r}\left(r \eta(T_e) \frac{\partial j}{\partial r}\right) + S_{cd} + S_{bs} $$
其中 $\chi_e, \chi_i, D$ 是有效的[热扩散](@entry_id:148740)系数和粒子扩散系数，$P_{\mathrm{aux}}$ 和 $S$ 代表外部加热和源，$Q_{ei}$ 是电子-离子能量交换项，$S_{cd}$ 和 $S_{bs}$ 分别为外部[电流驱动](@entry_id:186346)和自举电流源。$q$ 剖面可以从 $j$ 剖面通过磁平衡关系代数重构。这个模型集捕捉了 $T_e \leftrightarrow \eta \leftrightarrow j \leftrightarrow q$ 的核心耦合链，是剖面控制的基础。

#### 空间离散化与[状态空间表示](@entry_id:147149)

为了在数字计算机上实现控制器，连续的PDE模型必须被离散化。常见的[离散化方法](@entry_id:272547)包括[有限差分法](@entry_id:1124968)、[有限体积法](@entry_id:141374)和谱方法（如[伽辽金法](@entry_id:749698)）。

**[有限差分](@entry_id:167874)/体积法**
通过在[径向坐标](@entry_id:165186)上划分 $N$ 个网格点或控制体积，我们可以用代数方程近似空间导数，从而将PDE系统转化为一个大规模的[常微分方程组](@entry_id:907499)（ODE） 。对于包含 $M$ 个剖面（例如 $T_e, T_i, n_e, q$，$M=4$）和 $N$ 个空间节点的状态，总的[状态向量](@entry_id:154607) $x(t) \in \mathbb{R}^{MN}$ 将所有节点的剖面值堆叠起来。由此产生的ODE系统通常可以写成如下的[非线性](@entry_id:637147)[状态空间](@entry_id:160914)形式：
$$ \dot{x}(t) = f(x(t), u(t)) $$
其中 $u(t)$ 是作动器输入向量。为了设计线性MPC，通常将此系统在目标[工作点](@entry_id:173374) $(x^\star, u^\star)$ 附近线性化，得到：
$$ \dot{x}(t) = A x(t) + B u(t) + d $$
其中 $A = \frac{\partial f}{\partial x}\big|_{(x^\star, u^\star)}$ 和 $B = \frac{\partial f}{\partial u}\big|_{(x^\star, u^\star)}$ 分别是系统矩阵和输入矩阵。

由于[输运方程](@entry_id:174281)中的[扩散算子](@entry_id:136699)（二阶空间导数）在离散化后仅涉及相邻网格点，系统矩阵 $A$ 呈现出高度稀疏的**块三对角**结构。每个对角块（$4 \times 4$）表示同一空间位置上不同物理量之间的局部耦合（如[碰撞能量](@entry_id:183483)交换），而次对角块则表示相邻空间点之间同种物理量的[输运耦合](@entry_id:1133391)。同样，由于加热和[电流驱动](@entry_id:186346)等作动器的作用通常是空间局域的，输入矩阵 $B$ 也是稀疏的，其非零元素集中在对应作动器沉积剖面的空间位置上。

**伽辽金（Galerkin）基函数法**
另一种强大的方法是使用一组预定义的基函数（如[B样条](@entry_id:172303)）来[参数化](@entry_id:265163)空间剖面 。例如，[电子温度](@entry_id:180280)剖面可以近似为：
$$ T_e(\rho, t) \approx \sum_{i=1}^m x_i(t) N_i(\rho) $$
其中 $N_i(\rho)$ 是[B样条基函数](@entry_id:164756)，$x_i(t)$ 是[随时间变化的系数](@entry_id:894705)。现在，状态向量变成了低维的系数向量 $x(t) \in \mathbb{R}^m$。通过将此展开式代入[PDE的弱形式](@entry_id:1134006)（乘以[测试函数](@entry_id:166589)并积分），可以推导出关于系数向量 $x(t)$ 的[ODE系统](@entry_id:907499)：
$$ M \dot{x}(t) = -K x(t) + B u(t) + d(t) $$
这里，$M$ 是**质量矩阵**，源于时间导数项；$K$ 是**刚度矩阵**，源于扩散项；$B$ 和 $d$ 分别是投影到基[函数空间](@entry_id:143478)上的输入和源项。例如，对于上述温度方程，这些矩阵的元素由以下积分给出：
$$ M_{ij} = \int_0^1 \frac{3}{2}n_e(\rho) \rho N_i(\rho) N_j(\rho) d\rho $$
$$ K_{ij} = \int_0^1 n_e(\rho)\chi_e(\rho) \rho \frac{\partial N_i}{\partial \rho} \frac{\partial N_j}{\partial \rho} d\rho $$
这种方法不仅能有效降低模型维度，还能灵活地处理边界条件，并生成性质良好（如[对称正定](@entry_id:145886)）的[系统矩阵](@entry_id:172230)，非常适合控制设计。

#### 时间离散化与[数值刚性](@entry_id:752836)

无论采用哪种空间离散化方法，最终都会得到一个形式为 $\dot{x} = Ax+Bu$ 的[ODE系统](@entry_id:907499)。MPC控制器在离散时间步上运行，因此需要将此[ODE系统](@entry_id:907499)转化为[离散时间状态空间](@entry_id:261361)模型：
$$ x_{k+1} = A_d x_k + B_d u_k $$
其中 $A_d = \exp(A \Delta t)$ 和 $B_d = A^{-1}(A_d - I)B$（对于[时不变系统](@entry_id:264083)），$\Delta t$ 是控制器的[采样周期](@entry_id:265475)。

一个关键的数值问题是**刚性（Stiffness）** 。等离子体输运模型中不同物理过程的时间尺度可能相差悬殊。例如，磁扩散（决定 $q$ 剖面演化）通常很慢（秒级），而热扩散（决定 $T_e$ 剖面演化）则快得多（毫秒级）。这种时间尺度的巨大差异导致离散化后的系统矩阵 $A$ 的[特征值谱](@entry_id:1124216)分布范围很广。最大的特征值（由最快的物理过程和最精细的空间网格决定）决定了数值积分的稳定性边界。

对于[显式时间积分](@entry_id:165797)方法（如前向欧拉法），为保证[数值稳定性](@entry_id:175146)，时间步长 $\Delta t$ 必须小于一个由最大特征值决定的阈值，即 $\Delta t \lesssim 2/|\lambda_{\max}| \propto \Delta r^2 / \chi_e$。这个稳定性约束通常比MPC控制器实际的采样周期（例如 $10-20$ ms）要小好几个数量级。如果强行使用显式方法，就必须用极小的时间步进行内插，计算成本高昂。因此，为了能在实际的控制周期下稳定地预测系统未来行为，**必须采用[隐式时间积分](@entry_id:171761)方法**（如[后向欧拉法](@entry_id:139674)或Crank-Nicolson法）。这些方法是A-稳定的，即它们的[稳定区域](@entry_id:166035)覆盖了整个左半复平面，因此对于具有负实部特征值的[刚性系统](@entry_id:146021)是[无条件稳定](@entry_id:146281)的。

### 构建模型预测控制优化问题

MPC的核心思想是在每个控制时刻，基于当前系统状态，求解一个有限时间域内的开环优化问题，以获得一系列未来的最优控制输入。然后，仅将这一系列输入的第一个施加于系统，并在下一个时刻重复此过程。这个过程包含了对未来行为的预测、对目标的优化以及对约束的处理。

#### [目标函数](@entry_id:267263)的设计

MPC的目标函数（或成本函数）量化了控制性能的优劣。一个典型的二次型[目标函数](@entry_id:267263)旨在实现对参考轨迹的精确跟踪，同时限制控制代价 。其[标准形式](@entry_id:153058)如下：
$$ J = \sum_{i=0}^{N-1} \left( \|x_{k+i} - x^\star_{k+i}\|_{W_x}^2 + \|u_{k+i} - u^\star_{k+i}\|_{W_u}^2 + \|\Delta u_{k+i}\|_{W_{\Delta u}}^2 \right) + \|x_{k+N} - x^\star_{k+N}\|_{W_f}^2 $$
其中，$N$ 是[预测时域](@entry_id:261473)长度，$k$ 是当前时刻。各部分的含义如下：
- **状态跟踪项** $\|x_{k+i} - x^\star_{k+i}\|_{W_x}^2$：惩罚预测的状态轨迹 $x_{k+i}$ 与期望的参考轨迹 $x^\star_{k+i}$ 之间的偏差。权重矩阵 $W_x$ 至关重要，它不仅用于**归一化**不同物理量（如温度和安全因子）的偏差，使其在量纲和数值上可比，还用于**设定优先级**。例如，为了避免[锯齿不稳定性](@entry_id:754513)，可以对等离子体核心区的 $q$ 剖面偏差赋予更高的权重。
- **输入调节项** $\|u_{k+i} - u^\star_{k+i}\|_{W_u}^2$：惩罚控制输入 $u_{k+i}$ 相对于参考输入 $u^\star_{k+i}$ 的偏差。这用于限制总的控制功率或成本。
- **输入变化率项** $\|\Delta u_{k+i}\|_{W_{\Delta u}}^2$：其中 $\Delta u_{k+i} = u_{k+i} - u_{k+i-1}$，惩罚控制输入的快速变化（摆动率）。这一项对于等离子体这类扩散主导的系统尤为关键。它不仅能体现作动器的物理响应速率限制，更重要的是，它能保证控制动作的平滑性，避免在剖面中激发不必要的振荡，从而提高控制品质。
- **终端代价项** $\|x_{k+N} - x^\star_{k+N}\|_{W_f}^2$：惩罚[预测时域](@entry_id:261473)末端的状态偏差，对保证[闭环系统](@entry_id:270770)的稳定性起着核心作用，我们将在后续小节中详细讨论。

#### 约束的处理

显式处理约束是MPC相较于传统控制方法（如PID）最显著的优势之一。在[托卡马克](@entry_id:160432)运行中，必须严格遵守各种物理和工程限制，以保证设备安全和等离子体稳定。

**作动器约束**
物理硬件的限制直接转化为对控制输入 $u_k$ 的约束 。这些约束通常是线性的，可以直接加入优化问题中：
- **幅值约束**：作动器的输出功率或驱动电流不能超过其设计极限。例如，中性束注入系统的功率 $P_{\text{NBI}}$ 必须在 $[0, P_{\text{max}}]$ 之间。这表现为简单的边界约束：
  $$ u_{\min} \le u_k \le u_{\max} $$
- **变化率约束**：作动器的响应速度是有限的。例如，射频天线相位或功率的调整速率有限。这表现为对输入增量的约束。对于采样时间为 $\Delta t$ 的离散系统，连续时间的变化率限制 $|\dot{u}| \le r_{\max}$ 转化为：
  $$ |u_k - u_{k-1}| \le r_{\max} \Delta t $$
  即：
  $$ -r_{\max} \Delta t \le u_k - u_{k-1} \le r_{\max} \Delta t $$

**状态与运行约束**
为了维持等离子体的稳定和高性能运行，必须对状态剖面本身施加约束 。这些物理约束需要被转化为关于[状态向量](@entry_id:154607) $x_k$ 的数学不等式：
- **MHD不稳定性约束**：例如，为了避免核心区的[锯齿不稳定性](@entry_id:754513)，轴心安全因子 $q_0$ 必须大于1。在优化中，通常会加入一个小的安全裕量 $\delta$，表示为[线性不等式](@entry_id:174297)：
  $$ q_0[k] \ge 1 + \delta $$
- **输运极限约束**：例如，电子温度梯度不能过大，否则可能触发[微观不稳定性](@entry_id:1127873)，导致输运恶化。这个约束 $|\partial T_e / \partial r| \le G_{\max}$ 在离散化后，可以用[有限差分近似](@entry_id:1124978)，转化为对相邻节点温度值差异的[线性约束](@entry_id:636966)：
  $$ |T_e[i+1, k] - T_e[i, k]| / \Delta r \le G_{\max} $$
- **密度极限约束**：为了避免密度极限破裂，线平均密度 $\bar{n}_e$ 必须低于格林瓦尔德密度极限 $n_G$ 的某个比例 $f_G$。线平均密度的定义通常是一个积分 $\bar{n}_e = \frac{1}{a} \int_0^a n_e(r) dr$（或[体积平均](@entry_id:1133895)）。通过数值求积（如[梯形法则](@entry_id:145375)或矩形法则），这个积分可以被近似为状态向量 $n_e[i,k]$ 的[线性组合](@entry_id:154743)，从而得到一个[线性不等式](@entry_id:174297)约束。

### 保证稳定性与鲁棒性

将上述[目标函数](@entry_id:267263)和约束组合起来，我们可以在每个时刻求解一个优化问题。然而，一个朴素的有限时域MPC并不能自动保证[闭环系统](@entry_id:270770)的稳定性。当系统存在不确定性时，甚至连约束能否被始终满足都无法保证。因此，必须引入更精巧的机制。

#### [闭环稳定性](@entry_id:265949)：[终端约束](@entry_id:176488)与终端代价

MPC稳定性的核心挑战在于，在[预测时域](@entry_id:261473) $N$ 结束时，系统可能处于一个“悬崖边”状态——尽管在当前优化中看起来很好，但在下一步就可能无法找到满足约束的控制序列。为了解决这个问题，标准做法是引入**[终端约束](@entry_id:176488)集** $\mathcal{X}_f$ 和**终端代价** $V_f(x_N) = \|x_N - x^\star\|_{W_f}^2$ 。

其核心思想是，我们要求[预测时域](@entry_id:261473)的终点状态 $x_N$ 必须进入一个预先计算好的“安全”区域 $\mathcal{X}_f$。在这个区域内：
1.  存在一个简单的局部[反馈控制](@entry_id:272052)器（如[LQR控制器](@entry_id:267871)）$u=K(x-x^\star)$，它能够使系统稳定地收敛到目标点 $x^\star$，并且
2.  在该局部控制器作用下，系统状态将永远保持在 $\mathcal{X}_f$ 内部（即 $\mathcal{X}_f$ 是一个**控制[不变集](@entry_id:275226)**），同时满足所有的状态和输入约束。

终端代价函数 $V_f$ 被设计成该局部控制器的[李雅普诺夫函数](@entry_id:273986)。具体而言，最经典的构造方法是：
-   首先，为线性化系统 $(A, B)$ 和代价权重 $(Q, R)$ 求解无限时域[LQR问题](@entry_id:267315)，得到最优[反馈增益](@entry_id:271155) $K$ 和离散代数里卡提方程（DARE）的解 $P$。
-   然后，将终端代价权重矩阵设为 $W_f=P$。这个 $P$ 正好是[LQR控制器](@entry_id:267871)闭环系统的一个李雅普诺夫矩阵。
-   将[终端约束](@entry_id:176488)集 $\mathcal{X}_f$ 定义为在反馈律 $u=K(x-x^\star)$ 下，同时满足状态和输入约束的最大控制不变集。

通过强制 $x_N \in \mathcal{X}_f$ 并使用正确的终端代价，可以从理论上证明闭环MPC系统是递归可行且渐进稳定的。

#### [模型鲁棒性](@entry_id:636975)：Tube-MPC

实际的等离子体模型总存在不确定性，例如[输运系数](@entry_id:136790) $\chi_e, \chi_i, D$ 并非精确已知，而是存在于一个[不确定集](@entry_id:634516)合内 。这种[参数不确定性](@entry_id:264387)会导致实际系统状态偏离MPC[内部模型](@entry_id:923968)的预测，可能导致约束被违反。

**Tube-MPC** 是一种有效的[鲁棒控制](@entry_id:260994)策略，其思想是将真实状态 $x_k$ 分解为两部分：一个由MPC优化的**标称轨迹** $z_k$，和一个表示偏差的**误差** $e_k = x_k - z_k$。[控制器设计](@entry_id:274982)也分为两部分：
1.  **标称控制器**：一个MPC，用于规划标称轨迹 $z_k$ 和标称输入 $v_k$。
2.  **辅助控制器**：一个简单的局部反馈律 $u_{fb} = K e_k$，用于在线抑制误差。

总的控制输入为 $u_k = v_k + K e_k$。误差的动态[演化方程](@entry_id:268137)为：
$$ e_{k+1} = (A(\hat{\theta}) + B(\hat{\theta})K)e_k + d_k $$
其中 $d_k$ 是一个集总扰动项，它包含了[模型参数不确定性](@entry_id:752081)（如 $(A(\theta) - A(\hat{\theta}))z_k$）和外部扰动。

Tube-MPC的关键步骤是：
1.  **界定扰动集**：根据[参数不确定性](@entry_id:264387)范围和外部扰动边界，计算出集总扰动 $d_k$ 可能存在的所有值的集合 $\mathcal{W}$。
2.  **计算[不变集](@entry_id:275226)**：为稳定的误差动态系统计算一个**鲁棒正不变（RPI）集** $\Omega$。这个集合的特性是，一旦误差 $e_k$ 进入 $\Omega$，在任何可能的扰动作用下，未来的所有误差 $e_{k+j}$ 都将保持在 $\Omega$ 内。$\Omega$ 通常由 $\Omega = \bigoplus_{i=0}^{\infty} A_K^i \mathcal{W}$ 给出，其中 $\bigoplus$ 表示[闵可夫斯基和](@entry_id:176841)。
3.  **约束收紧**：为了确保真实的系统 $(x_k, u_k)$ 始终满足约束 $(x_k \in \mathcal{X}, u_k \in \mathcal{U})$，无论误差 $e_k \in \Omega$ 如何取值，我们必须对标称轨迹 $(z_k, v_k)$ 施加更严格的约束。这是通过**庞特里亚金差（Pontryagin Difference）** 实现的：
    $$ z_k \in \mathcal{X} \ominus \Omega $$
    $$ v_k \in \mathcal{U} \ominus K\Omega $$
    直观上，就是从原始的可行域中“挖掉”一个与不变集 $\Omega$ 大小相当的边界，为可能出现的误差预留出“安全裕度”。标称MPC控制器在这个收紧的约束集内进行优化，从而保证了整个[闭环系统](@entry_id:270770)的鲁棒可行性。

### 计算层面的考量

最终，MPC在每个时刻都需要求解一个约束优化问题。对于我们讨论的二次型[目标函数](@entry_id:267263)和[线性约束](@entry_id:636966)，该问题是一个**二次规划（Quadratic Program, QP）**问题。

将[预测时域](@entry_id:261473)内所有的状态和输入变量 $z = [x_0^\top, u_0^\top, \dots, x_N^\top]^\top$ 堆叠成一个大的决策向量，MPC优化问题可以写成标准QP形式 ：
$$ \min_{z} \quad \frac{1}{2} z^\top H z + f^\top z $$
$$ \text{s.t.} \quad A_{eq} z = b_{eq} $$
$$ \quad C_{in} z \le d_{in} $$
其中，目标函数由代价函数 $J$ 给出，其二次项构成了块对角的Hessian矩阵 $H$。[等式约束](@entry_id:175290) $A_{eq} z = b_{eq}$ 代表了连接各个时刻状态的离散动态模型 $x_{k+1}=A_dx_k+B_du_k$。[不等式约束](@entry_id:176084) $C_{in} z \le d_{in}$ 则包含了所有的作动器限制和状态约束。

这个Q[P问题](@entry_id:267898)的规模可能很大（变量数量等于 $(n_x+n_u) \times N$），但其结构是高度稀疏的。特别是，表示系统动态的[等式约束](@entry_id:175290)矩阵 $A_{eq}$ 具有带状或块二对角结构，因为它只耦合相邻时间步的变量。

这种[稀疏结构](@entry_id:755138)是实现快速求解的关键。描述该Q[P问题](@entry_id:267898)[最优性条件](@entry_id:634091)的KKT（[Karush-Kuhn-Tucker](@entry_id:634966)）系统，其[系数矩阵](@entry_id:151473)也具有相应的**块三对角**结构。利用这种结构，可以采用专门的[稀疏线性代数](@entry_id:755102)算法（如带状[LDL分解](@entry_id:751202)）或[动态规划](@entry_id:141107)方法（类似于黎卡提方程的求解）来高效地求解Q[P问题](@entry_id:267898)。其计算复杂度与[预测时域](@entry_id:261473)长度 $N$ 成线性关系 $\mathcal{O}(N)$，而非[稠密矩阵](@entry_id:174457)求解的 $\mathcal{O}(N^3)$。正是这种[计算效率](@entry_id:270255)，使得MPC在[采样周期](@entry_id:265475)仅为数十毫秒的[等离子体控制](@entry_id:753487)中得以实时应用。