{
    "hands_on_practices": [
        {
            "introduction": "集成建模的第一步是精确定义核心区和边界区之间的边界条件。本练习侧重于计算磁分界面处的向外粒子通量 $\\Gamma_s$，该通量由等离子体湍流驱动，并作为刮削层（Scrape-Off Layer, SOL）的主要粒子源。量化这一通量  是连接核心输运模型与边界等离子体模拟器以及预测面向等离子体部件粒子负载的基础。",
            "id": "3960702",
            "problem": "处于高约束模式的磁约束聚变等离子体在小半径 $r=r_s$ 处的分界面附近有一个陡峭的边界密度台基。考虑一个轴对称环形等离子体，其径向坐标 $r$ 向外增加。假设局域边界输运在一个跨越台基肩部的薄壳层中建模，使得磁几何可以被视为局域平板状，并且径向粒子输运由跨场过程主导。从粒子连续性方程、通量散度的定义以及在该薄壳层中体积粒子源可忽略的稳态假设出发。通过假设跨场径向输运的标准对流-扩散表示来封闭该模型，该表示由一个具有标量湍流扩散系数的菲克扩散分量和一个具有给定向外速度的附加对流分量组成。采用符号约定，即正的径向粒子通量指向穿过分界面进入刮削层的方向。\n\n根据界面处的局域参数：密度 $n_s \\equiv n(r_s)$、径向梯度 $g_s \\equiv \\left.\\frac{dn}{dr}\\right|_{r_s}$、湍流粒子扩散系数 $D_s$ 和向外对流速度 $V_s$，推导分界面 $r=r_s$ 处局域向外径向粒子通量的表达式。然后，使用以下在外侧中平面的科学上合理的台基边界参数，数值计算该通量：\n- 分界面密度 $n_s = 3.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$。\n- 台基梯度 $g_s = -5.0 \\times 10^{20}\\ \\mathrm{m}^{-4}$（密度向外减小）。\n- 湍流粒子扩散系数 $D_s = 0.30\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$。\n- 向外对流速度 $V_s = 2.0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。\n\n将穿过分界面的最终向外粒子通量 $\\Gamma_s$ 明确地表示为单个实数。最终通量以 $\\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$ 为单位，并将您的答案四舍五入到三位有效数字。\n\n简要地用一两句话解释，在芯部-边界集成建模工作流程中，为了确保此通量与刮削层等离子体模拟器（Scrape-Off Layer Plasma Simulator, SOLPS）的边界区域相匹配，必须在芯部-边界界面处指定什么，并强调 $D_s$ 和 $V_s$ 的作用。",
            "solution": "该问题要求基于一个简化的一维对流-扩散模型，推导和计算托卡马克等离子体分界面处的径向粒子通量。\n\n首先，推导通量的理论表达式。出发点是粒子连续性方程，其一般形式为：\n$$\n\\frac{\\partial n}{\\partial t} + \\nabla \\cdot \\vec{\\Gamma} = S\n$$\n其中 $n$ 是粒子密度，$\\vec{\\Gamma}$ 是粒子通量矢量，$S$ 是单位体积的粒子源率。\n\n问题为等离子体边界的薄壳层指定了几个简化假设：\n1.  **稳态**：系统不随时间变化，因此 $\\frac{\\partial n}{\\partial t} = 0$。\n2.  **可忽略的体积源**：在所关注的薄壳层中，$S=0$。\n3.  **局域平板状几何**：复杂的环形几何可以近似为径向坐标 $r$ 上的一维系统。\n4.  **主导的径向输运**：只有通量的径向分量 $\\Gamma_r$ 被认为是显著的。\n\n应用稳态和无源假设，连续性方程简化为：\n$$\n\\nabla \\cdot \\vec{\\Gamma} = 0\n$$\n在简化的一维径向几何中（“局域平板状”假设的结果），作用于径向通量 $\\Gamma_r$ 的散度算子简化为 $\\frac{d\\Gamma_r}{dr}$。因此，连续性方程意味着径向通量在这个无源区域内是恒定的：\n$$\n\\frac{d\\Gamma_r}{dr} = 0 \\implies \\Gamma_r(r) = \\text{常数}\n$$\n这意味着分界面处的通量 $\\Gamma_s$ 与整个薄壳层中的通量相同。\n\n问题提供了径向粒子通量的封闭关系，即一个对流-扩散模型：\n$$\n\\Gamma_r(r) = \\Gamma_{\\text{diff}}(r) + \\Gamma_{\\text{conv}}(r)\n$$\n扩散分量由菲克定律给出：\n$$\n\\Gamma_{\\text{diff}}(r) = -D(r)\\frac{dn}{dr}\n$$\n其中 $D(r)$ 是湍流粒子扩散系数。负号确保了扩散通量沿着密度梯度向下的方向（从高密度到低密度）。\n\n对流分量由下式给出：\n$$\n\\Gamma_{\\text{conv}}(r) = n(r)V(r)\n$$\n其中 $V(r)$ 是对流速度。\n\n结合这些分量，得到总的径向粒子通量：\n$$\n\\Gamma_r(r) = -D(r)\\frac{dn}{dr} + n(r)V(r)\n$$\n符号约定是正通量指向外。一个典型的台基具有向外减小的密度，因此 $\\frac{dn}{dr}  0$，使得扩散项 $-D\\frac{dn}{dr}$ 为正（向外）。问题指定了一个向外的对流速度 $V > 0$，因此对流项 $nV$ 也为正（向外）。该模型是一致的。\n\n为了求得分界面处的通量，我们在 $r=r_s$ 处计算此表达式，使用给定的局域参数：$n_s \\equiv n(r_s)$、$g_s \\equiv \\left.\\frac{dn}{dr}\\right|_{r_s}$、$D_s \\equiv D(r_s)$ 和 $V_s \\equiv V(r_s)$。\n分界面处向外径向粒子通量的最终表达式为：\n$$\n\\Gamma_s = -D_s g_s + n_s V_s\n$$\n这完成了推导。\n\n接下来，使用提供的参数对该表达式进行数值计算：\n- 分界面密度：$n_s = 3.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- 台基梯度：$g_s = -5.0 \\times 10^{20}\\ \\mathrm{m}^{-4}$\n- 湍流粒子扩散系数：$D_s = 0.30\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$\n- 向外对流速度：$V_s = 2.0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n\n将这些值代入推导出的公式中：\n$$\n\\Gamma_s = -(0.30\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1})(-5.0 \\times 10^{20}\\ \\mathrm{m}^{-4}) + (3.0 \\times 10^{19}\\ \\mathrm{m}^{-3})(2.0\\ \\mathrm{m}\\ \\mathrm{s}^{-1})\n$$\n分别计算通量的扩散和对流部分：\n$$\n\\Gamma_{\\text{diff},s} = -D_s g_s = -(0.30)(-5.0 \\times 10^{20})\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 1.5 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\Gamma_{\\text{conv},s} = n_s V_s = (3.0 \\times 10^{19})(2.0)\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 6.0 \\times 10^{19}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 0.6 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}\n$$\n总通量是这两个分量的和：\n$$\n\\Gamma_s = (1.5 \\times 10^{20} + 0.6 \\times 10^{20})\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 2.1 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}\n$$\n问题要求答案四舍五入到三位有效数字。因此，最终的数值是 $2.10 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$。\n\n最后，关于与刮削层等离子体模拟器（Scrape-Off Layer Plasma Simulator, SOLPS）的芯部-边界界面，为了实现通量匹配，必须指定以下内容。在芯部-边界集成建模工作流程中，必须在界面上一致地指定湍流输运系数 $D_s$ 和 $V_s$。这些系数代表了潜在的输运物理，它们决定了芯部模型施加在 SOLPS 边界区域上的粒子通量边界条件，从而确保了从芯部等离子体到刮削层的物理上一致的粒子流。",
            "answer": "$$\\boxed{2.10 \\times 10^{20}}$$"
        },
        {
            "introduction": "一旦粒子和能量穿过磁分界面，它们就会沿着开放的磁力线被快速输运至偏滤器。本练习将介绍刮削层物理学的基石——经典的双点模型，用以关联核心区附近的上游温度（$T_u$）与偏滤器靶板上的靶板温度（$T_t$）。通过应用此模型 ，你将探索平行热传导的主导作用，并推导出热通量通道的特征宽度 $\\lambda_q$。",
            "id": "3960723",
            "problem": "磁约束聚变等离子体中的刮削层（SOL）被建模为一个沿磁力线和跨磁力线的稳态、各向异性热传导问题。设 $s$ 表示从 $s=0$ 处的上游中平面到 $s=L_{\\parallel}$ 处的偏滤器靶板的平行坐标，设 $r$ 表示跨场径向坐标。假设连接上游区域与靶板的开放磁力线上没有体热源或热沉，因此平行热通量是守恒的。电子平行传导热通量由 Spitzer–Härm 形式给出：$q_{\\parallel} = - \\kappa_{0}\\, T^{5/2} \\, \\frac{\\partial T}{\\partial s}$，其中 $T(s)$ 是以电子伏特为单位的电子温度，$\\kappa_{0}$ 是一个常系数，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$。跨场热通量被建模为 $q_{r} = - \\kappa_{\\perp} \\, \\frac{\\partial T}{\\partial r}$，其中 $\\kappa_{\\perp}$ 在 $r$ 方向上为常数，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-1}$。\n\n1. 从稳态平行热通量平衡和边界值 $T(0)=T_{u}$（上游）及 $T(L_{\\parallel})=T_{t}$（靶板）出发，推导 $T_{u}$ 和 $T_{t}$ 之间关于恒定平行热通量 $q_{\\parallel}$、连接长度 $L_{\\parallel}$ 和系数 $\\kappa_{0}$ 的两点模型关系。\n\n2. 使用稳态各向异性传导方程 $\\frac{\\partial}{\\partial s}\\!\\left(\\kappa_{0} T^{5/2} \\frac{\\partial T}{\\partial s}\\right) + \\frac{\\partial}{\\partial r}\\!\\left(\\kappa_{\\perp} \\frac{\\partial T}{\\partial r}\\right) = 0$，通过平衡特征平行和跨场传导项，估算上游中平面处的热通量衰减长度 $\\lambda_{q}$。用 $L_{\\parallel}$、$\\kappa_{0}$、$\\kappa_{\\perp}$ 和一个参考温度表示 $\\lambda_{q}$。在上游温度 $T_{u}$ 处计算你的表达式的值。\n\n对于数值计算，使用 $L_{\\parallel} = 20\\,\\mathrm{m}$，$\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$，$\\kappa_{\\perp} = 0.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-1}$ 和 $T_{u} = 80\\,\\mathrm{eV}$。将你计算出的 $\\lambda_{q}$ 的数值结果四舍五入到三位有效数字，并以米为单位表示。",
            "solution": "**第1部分：两点模型关系的推导**\n\n我们从电子平行热通量的 Spitzer–Härm 定律出发，并假设它沿着磁力线坐标 $s$ 是恒定的。由于在此一维分析中，温度 $T$ 仅为 $s$ 的函数，我们可以将该定律写成一个常微分方程：\n$$q_{\\parallel} = - \\kappa_{0}\\, T(s)^{5/2} \\, \\frac{dT}{ds}$$\n其中 $q_{\\parallel}$ 和 $\\kappa_{0}$ 是常数。为了找到上游温度 $T_u$ 和靶板温度 $T_t$ 之间的关系，我们对该方程进行积分。首先，分离变量：\n$$\\kappa_{0}\\, T^{5/2} \\, dT = -q_{\\parallel} \\, ds$$\n然后，我们在各自的定义域上对两边进行积分。温度从 $s=0$ 处的 $T_u$ 变化到 $s=L_{\\parallel}$ 处的 $T_t$：\n$$\\int_{T_u}^{T_t} \\kappa_{0} \\, T^{5/2} \\, dT = \\int_{0}^{L_{\\parallel}} -q_{\\parallel} \\, ds$$\n由于 $\\kappa_{0}$ 和 $q_{\\parallel}$ 是常数，可将它们移到积分号外：\n$$\\kappa_{0} \\int_{T_u}^{T_t} T^{5/2} \\, dT = -q_{\\parallel} \\int_{0}^{L_{\\parallel}} ds$$\n执行积分：\n$$\\kappa_{0} \\left[ \\frac{T^{7/2}}{7/2} \\right]_{T_u}^{T_t} = -q_{\\parallel} [s]_{0}^{L_{\\parallel}}$$\n$$\\frac{2\\kappa_{0}}{7} \\left( T_t^{7/2} - T_u^{7/2} \\right) = -q_{\\parallel} L_{\\parallel}$$\n整理后可得两点模型的标准关系式：\n$$T_u^{7/2} - T_t^{7/2} = \\frac{7 q_{\\parallel} L_{\\parallel}}{2 \\kappa_{0}}$$\n此方程将上游和靶板的温度与平行热通量和磁场连接长度联系起来。\n\n**第2部分：热通量衰减长度 $\\lambda_{q}$ 的估算**\n\n第二部分涉及稳态二维各向异性热传导方程：\n$$\\frac{\\partial}{\\partial s}\\!\\left(\\kappa_{0} T^{5/2} \\frac{\\partial T}{\\partial s}\\right) + \\frac{\\partial}{\\partial r}\\!\\left(\\kappa_{\\perp} \\frac{\\partial T}{\\partial r}\\right) = 0$$\n我们通过平衡方程中的两项来进行标度分析，以估算特征径向衰减长度 $\\lambda_{q}$。我们将平行方向（$s$）和径向（$r$）的特征长度分别表示为 $L_s$ 和 $L_r$。\n\n根据题意，特征平行长度为连接长度 $L_{\\parallel}$，即 $L_s \\sim L_{\\parallel}$。我们所求的特征径向长度为 $\\lambda_q$，即 $L_r \\sim \\lambda_q$。特征温度取上游温度 $T_u$，即 $T \\sim T_u$。\n利用这些标度，我们可以估算偏导数的量级：\n$$\\frac{\\partial}{\\partial s} \\sim \\frac{1}{L_{\\parallel}}, \\quad \\frac{\\partial}{\\partial r} \\sim \\frac{1}{\\lambda_q}$$\n现在，我们估算方程中每一项的大小：\n-   平行传导项：$\\frac{\\partial}{\\partial s}\\!\\left(\\kappa_{0} T^{5/2} \\frac{\\partial T}{\\partial s}\\right) \\sim \\frac{1}{L_{\\parallel}} \\left( \\kappa_{0} T_u^{5/2} \\frac{T_u}{L_{\\parallel}} \\right) = \\frac{\\kappa_{0} T_u^{7/2}}{L_{\\parallel}^2}$\n-   跨场传导项：$\\frac{\\partial}{\\partial r}\\!\\left(\\kappa_{\\perp} \\frac{\\partial T}{\\partial r}\\right) \\sim \\frac{1}{\\lambda_q} \\left( \\kappa_{\\perp} \\frac{T_u}{\\lambda_q} \\right) = \\frac{\\kappa_{\\perp} T_u}{\\lambda_q^2}$\n\n平衡这两项的大小，可得：\n$$\\frac{\\kappa_{\\perp} T_u}{\\lambda_q^2} \\approx \\frac{\\kappa_{0} T_u^{7/2}}{L_{\\parallel}^2}$$\n求解 $\\lambda_q^2$：\n$$\\lambda_q^2 \\approx \\frac{\\kappa_{\\perp} T_u}{\\kappa_{0} T_u^{7/2}} L_{\\parallel}^2 = \\frac{\\kappa_{\\perp}}{\\kappa_{0} T_u^{5/2}} L_{\\parallel}^2$$\n取平方根，得到热通量衰减长度 $\\lambda_q$ 的表达式：\n$$\\lambda_q \\approx \\sqrt{\\frac{\\kappa_{\\perp}}{\\kappa_{0} T_u^{5/2}}} L_{\\parallel}$$\n\n**数值计算**\n\n代入给定数值：\n-   $L_{\\parallel} = 20\\,\\mathrm{m}$\n-   $\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$\n-   $\\kappa_{\\perp} = 0.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-1}$\n-   $T_{u} = 80\\,\\mathrm{eV}$\n\n计算 $(80)^{5/2}$：\n$$(80)^{5/2} = (80^2)\\sqrt{80} = 6400 \\sqrt{16 \\times 5} = 6400 \\times 4\\sqrt{5} = 25600\\sqrt{5} \\approx 57243.34$$\n代入 $\\lambda_q$ 的表达式中：\n$$\\lambda_q \\approx 20 \\times \\sqrt{\\frac{0.5}{2000 \\times 57243.34}} = 20 \\times \\sqrt{\\frac{0.5}{114486677}}$$\n$$\\lambda_q \\approx 20 \\times \\sqrt{4.3674 \\times 10^{-9}} \\approx 20 \\times 6.6086 \\times 10^{-5} \\approx 0.0013217\\,\\mathrm{m}$$\n根据题目要求，将结果四舍五入到三位有效数字：\n$$\\lambda_q \\approx 0.00132\\,\\mathrm{m}$$\n这也可以表示为 $1.32 \\times 10^{-3}\\,\\mathrm{m}$。",
            "answer": "$$\\boxed{1.32 \\times 10^{-3}}$$"
        },
        {
            "introduction": "排出的粒子和热量的最终目的地是偏滤器，在此处复杂的等离子体-材料相互作用会产生涉及中性粒子的关键反馈回路。本练习从简单的1D模型进阶到偏滤器室的耦合多节点网络模型。通过这个练习 ，你将计算再循环、抽气和中性气体导纳如何相互作用，以确定中性气体壓力分布以及维持自洽等离子体解所需的外部供料率。",
            "id": "3960728",
            "problem": "一个三节点中性气体电导模型被用于耦合托卡马克中的偏滤器几何和抽运与边缘等离子体加料，该模型与芯部-边缘集成建模相一致。这三个节点分别代表外偏滤器 ($\\mathrm{O}$)、内偏滤器 ($\\mathrm{I}$) 和连接到泵的公共偏滤器管道 ($\\mathrm{D}$)。目标是计算稳态中性气体压力分布以及维持刮削层 (Scrape-Off Layer, SOL) 中指定的分界面等离子体密度所需的外部加料率。\n\n基本原理：\n- 理想气体定律通过 $n_{\\mathrm{n}} = p/(k_{\\mathrm{B}} T_{\\mathrm{n}})$ 将中性粒子数密度 $n_{\\mathrm{n}}$ 与压力 $p$ 联系起来，其中 $k_{\\mathrm{B}}$ 是 Boltzmann 常数，$T_{\\mathrm{n}}$ 是中性气体温度。\n- 分子流网络理论将节点 $i$ 和 $j$ 之间的中性气体通量 $Q$ 描述为 $Q_{ij} = C_{ij} (p_i - p_j)$，其中 $C_{ij}$ 是电导（与几何形状相关，单位为 $\\mathrm{m^3/s}$）。节点 $i$ 处的抽运移除了通量 $Q_{\\mathrm{pump},i} = S_i p_i$，其中 $S_i$ 是节点 $i$ 处的抽运速率（单位为 $\\mathrm{m^3/s}$）。节点 $i$ 处的再循环源表示为通量 $Q_{\\mathrm{rec},i} = R \\, \\Gamma_i \\, A_{t,i} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$，其中 $R$ 是再循环系数（无量纲），$\\Gamma_i$ 是入射离子通量密度（单位为 $\\mathrm{m^{-2} s^{-1}}$），$A_{t,i}$ 是靶板表面积（单位为 $\\mathrm{m^2}$）。外部加料以粒子速率 $\\dot{N}_{\\mathrm{fuel}}$ 在选定节点注入，在网络中表示为该节点的通量 $Q_{\\mathrm{fuel}} = \\dot{N}_{\\mathrm{fuel}} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$。\n- 到等离子体的边缘电离源可近似为 $ \\dot{N}_{\\mathrm{ion}} = \\sum_i \\int n_{\\mathrm{n}} n_{\\mathrm{e}} \\langle \\sigma v \\rangle \\, dV \\approx \\sum_i \\left( \\frac{p_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}} \\right) n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i$，其中分界面附近的 $n_{\\mathrm{e}}$ 由目标分界面密度 $n_{\\mathrm{sep}}$ 近似，$\\langle \\sigma v \\rangle$ 是氘的电子碰撞电离速率系数（单位为 $\\mathrm{m^3/s}$），$V_i$ 是节点 $i$ 的有效边缘相互作用体积（单位为 $\\mathrm{m^3}$）。\n- 沿开放磁力线的平行粒子流出汇通过 $ \\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} \\, c_s \\, A_{\\mathrm{sep}}$ 建模，其中等温离子声速为 $ c_s = \\sqrt{k_{\\mathrm{B}} T_{\\mathrm{e}} / m_i}$，其中 $T_{\\mathrm{e}}$ 是电子温度，$m_i$ 是离子质量（氘），$A_{\\mathrm{sep}}$ 是有效分界面面积（单位为 $\\mathrm{m^2}$）。\n\n模型方程：\n- 每个节点的稳态中性粒子平衡满足\n$$ \\sum_j C_{ij} (p_i - p_j) + S_i p_i = Q_{\\mathrm{rec},i} + Q_{\\mathrm{fuel},i}.$$\n这可以写成一个线性系统 $ \\mathbf{A} \\mathbf{p} = \\mathbf{Q}$，其中 $\\mathbf{A}$ 是由电导和抽运速率构成的矩阵，$\\mathbf{p}$ 是节点压力向量，$\\mathbf{Q}$ 是源通量（再循环加加料）向量。\n\n- 电离源与 $\\mathbf{p}$ 呈线性关系：\n$$ \\dot{N}_{\\mathrm{ion}} = \\sum_i K_i p_i, \\quad K_i = \\frac{n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}}.$$\n\n- 边缘稳态条件要求总电离源等于平行流出汇：\n$$ \\dot{N}_{\\mathrm{ion}} = \\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} \\sqrt{\\frac{k_{\\mathrm{B}} T_{\\mathrm{e}}}{m_i}} A_{\\mathrm{sep}}.$$\n\n- 因为 $ \\mathbf{p} = \\mathbf{A}^{-1} (\\mathbf{Q}_{\\mathrm{rec}} + \\mathbf{e}_f Q_{\\mathrm{fuel}})$，其中 $\\mathbf{e}_f$ 选择加料节点，可以写成\n$$ \\dot{N}_{\\mathrm{ion}} = K_0 + K_1 \\, \\dot{N}_{\\mathrm{fuel}}, $$\n其中\n$$ K_0 = \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}]_i, \\quad K_1 = k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{e}_f]_i.$$\n那么所需的加料率为\n$$ \\dot{N}_{\\mathrm{fuel}}^{\\ast} = \\max\\left( 0, \\frac{ \\dot{N}_{\\mathrm{out}} - K_0 }{ K_1 } \\right). $$\n\n任务：\n- 为一个三节点网络（外节点 $\\mathrm{O}$、内节点 $\\mathrm{I}$ 和管道节点 $\\mathrm{D}$）实现上述模型，其中电导为 $C_{\\mathrm{OD}}$ 和 $C_{\\mathrm{ID}}$（$\\mathrm{O}$–$\\mathrm{I}$ 之间无直接耦合），抽运速率 $S_{\\mathrm{D}}$ 仅存在于管道节点。外部加料从外节点进入。\n- 计算满足粒子平衡以维持目标分界面密度的稳态压力分布 $\\{p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}\\}$ 和所需的外部加料率 $\\dot{N}_{\\mathrm{fuel}}^{\\ast}$。压力以 $\\mathrm{Pa}$ 表示，加料率以粒子/秒（单位 $\\mathrm{s^{-1}}$）表示。\n\n常数：\n- 使用 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$。\n- 使用氘离子质量 $m_i = 3.345 \\times 10^{-27} \\, \\mathrm{kg}$。\n- 使用 $1 \\, \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\, \\mathrm{J}$ 将电子温度从电子伏特转换。\n\n测试套件：\n提供四个具有以下参数的测试用例。所有量均采用国际单位制 (SI)。\n\n- 案例 1（基准线）：\n  - 电导：$C_{\\mathrm{OD}} = 3.0$，$C_{\\mathrm{ID}} = 3.0$。\n  - 抽运：$S_{\\mathrm{D}} = 50.0$。\n  - 再循环：$R = 0.6$，$\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$，$A_{t,\\mathrm{O}} = 4.0$；$\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$，$A_{t,\\mathrm{I}} = 3.0$。\n  - 边缘：$n_{\\mathrm{sep}} = 5.0 \\times 10^{19}$，$T_{\\mathrm{e}} = 20.0$ $\\mathrm{eV}$，$A_{\\mathrm{sep}} = 50.0$。\n  - 中性粒子：$T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$。\n  - 体积：$V_{\\mathrm{O}} = 0.4$，$V_{\\mathrm{I}} = 0.3$，$V_{\\mathrm{D}} = 0.2$。\n  - 电离系数：$\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$。\n\n- 案例 2（强抽运和弱再循环）：\n  - 电导：$C_{\\mathrm{OD}} = 3.0$，$C_{\\mathrm{ID}} = 3.0$。\n  - 抽运：$S_{\\mathrm{D}} = 200.0$。\n  - 再循环：$R = 0.1$，$\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$，$A_{t,\\mathrm{O}} = 4.0$；$\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$，$A_{t,\\mathrm{I}} = 3.0$。\n  - 边缘：$n_{\\mathrm{sep}} = 5.0 \\times 10^{19}$，$T_{\\mathrm{e}} = 20.0$ $\\mathrm{eV}$，$A_{\\mathrm{sep}} = 50.0$。\n  - 中性粒子：$T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$。\n  - 体积：$V_{\\mathrm{O}} = 0.4$，$V_{\\mathrm{I}} = 0.3$，$V_{\\mathrm{D}} = 0.2$。\n  - 电离系数：$\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$。\n\n- 案例 3（热边缘等离子体）：\n  - 电导：$C_{\\mathrm{OD}} = 3.0$，$C_{\\mathrm{ID}} = 3.0$。\n  - 抽运：$S_{\\mathrm{D}} = 50.0$。\n  - 再循环：$R = 0.6$，$\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$，$A_{t,\\mathrm{O}} = 4.0$；$\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$，$A_{t,\\mathrm{I}} = 3.0$。\n  - 边缘：$n_{\\mathrm{sep}} = 5.0 \\times 10^{19}$，$T_{\\mathrm{e}} = 100.0$ $\\mathrm{eV}$，$A_{\\mathrm{sep}} = 50.0$。\n  - 中性粒子：$T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$。\n  - 体积：$V_{\\mathrm{O}} = 0.4$，$V_{\\mathrm{I}} = 0.3$，$V_{\\mathrm{D}} = 0.2$。\n  - 电离系数：$\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$。\n\n- 案例 4（无再循环，高电导）：\n  - 电导：$C_{\\mathrm{OD}} = 5.0$，$C_{\\mathrm{ID}} = 4.0$。\n  - 抽运：$S_{\\mathrm{D}} = 50.0$。\n  - 再循环：$R = 0.0$，$\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$，$A_{t,\\mathrm{O}} = 4.0$；$\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$，$A_{t,\\mathrm{I}} = 3.0$。\n  - 边缘：$n_{\\mathrm{sep}} = 3.0 \\times 10^{19}$，$T_{\\mathrm{e}} = 20.0$ $\\mathrm{eV}$，$A_{\\mathrm{sep}} = 50.0$。\n  - 中性粒子：$T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$。\n  - 体积：$V_{\\mathrm{O}} = 0.4$，$V_{\\mathrm{I}} = 0.3$，$V_{\\mathrm{D}} = 0.2$。\n  - 电离系数：$\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$。\n\n所需输出：\n- 对于每个测试用例，计算加料率 $\\dot{N}_{\\mathrm{fuel}}^{\\ast}$（单位 $\\mathrm{s^{-1}}$）和压力三元组 $\\{p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}\\}$（单位 $\\mathrm{Pa}$）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个包含四个浮点数的子列表，顺序为 $[\\dot{N}_{\\mathrm{fuel}}^{\\ast}, p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}]$，例如 $[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\dots]$。",
            "solution": "该解决方案基于中性气体动力学的第一性原理和边缘区域的等离子体粒子平衡，系统地将偏滤器几何、抽运和再循环与中性气体压力场联系起来，而压力场又控制着等离子体的电离加料。推导过程如下。\n\n定义代表外偏滤器 ($\\mathrm{O}$)、内偏滤器 ($\\mathrm{I}$) 和管道 ($\\mathrm{D}$) 的三个节点。电导 $C_{\\mathrm{OD}}$ 连接 $\\mathrm{O}$ 和 $\\mathrm{D}$，$C_{\\mathrm{ID}}$ 连接 $\\mathrm{I}$ 和 $\\mathrm{D}$。仅在 $\\mathrm{D}$ 处存在抽运速率 $S_{\\mathrm{D}}$。设中性气体温度为 $T_{\\mathrm{n}}$。\n\n对于每个节点 $i$，稳态中性气体通量平衡为\n$$ \\sum_j C_{ij} (p_i - p_j) + S_i p_i = Q_{\\mathrm{rec},i} + Q_{\\mathrm{fuel},i}, $$\n其中 $Q_{\\mathrm{rec},i} = R \\, \\Gamma_i \\, A_{t,i} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$ 代表再循环，$Q_{\\mathrm{fuel},i} = \\dot{N}_{\\mathrm{fuel}} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$ 在加料节点（在此设置中为 $\\mathrm{O}$）代表外部加料。对于没有直接 $\\mathrm{O}$–$\\mathrm{I}$ 路径且仅在 $\\mathrm{D}$ 处抽运的三节点网络，该线性系统可以写成矩阵形式：\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{Q}, \\quad\n\\mathbf{A} =\n\\begin{bmatrix}\nC_{\\mathrm{OD}}  0  -C_{\\mathrm{OD}} \\\\\n0  C_{\\mathrm{ID}}  -C_{\\mathrm{ID}} \\\\\n-C_{\\mathrm{OD}}  -C_{\\mathrm{ID}}  C_{\\mathrm{OD}} + C_{\\mathrm{ID}} + S_{\\mathrm{D}}\n\\end{bmatrix},\n$$\n$$\n\\mathbf{Q} =\n\\begin{bmatrix}\nQ_{\\mathrm{rec},\\mathrm{O}} + Q_{\\mathrm{fuel}} \\\\\nQ_{\\mathrm{rec},\\mathrm{I}} \\\\\n0\n\\end{bmatrix}.\n$$\n求解 $\\mathbf{p}$ 得到 $ \\mathbf{p} = \\mathbf{A}^{-1} \\mathbf{Q}$。由于 $\\mathbf{Q}$ 是再循环和加料贡献的总和，且系统是线性的，可以将压力分解为\n$$ \\mathbf{p} = \\mathbf{p}_{\\mathrm{rec}} + \\mathbf{p}_{\\mathrm{fuel}}, \\quad \\mathbf{p}_{\\mathrm{rec}} = \\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}, \\quad \\mathbf{p}_{\\mathrm{fuel}} = \\mathbf{A}^{-1} \\mathbf{e}_f Q_{\\mathrm{fuel}}, $$\n其中 $\\mathbf{e}_f$ 选择加料节点（对于外部加料，$\\mathbf{e}_f = [1,0,0]^T$），且 $Q_{\\mathrm{fuel}} = \\dot{N}_{\\mathrm{fuel}} k_{\\mathrm{B}} T_{\\mathrm{n}}$。\n\n边缘的等离子体电离源由理想气体关系式 $n_{\\mathrm{n}} = p/(k_{\\mathrm{B}} T_{\\mathrm{n}})$ 和碰撞电离率得到：\n$$ \\dot{N}_{\\mathrm{ion}} = \\sum_i \\int n_{\\mathrm{n}} n_{\\mathrm{e}} \\langle \\sigma v \\rangle \\, dV \\approx \\sum_i \\left( \\frac{p_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}} \\right) n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i = \\sum_i K_i p_i, $$\n其中\n$$ K_i = \\frac{n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}}. $$\n由于 $\\mathbf{p}$ 在再循环和加料方面是线性的，电离源可以写成\n$$ \\dot{N}_{\\mathrm{ion}} = \\sum_i K_i p_{\\mathrm{rec},i} + \\sum_i K_i p_{\\mathrm{fuel},i} = K_0 + \\left( k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{e}_f]_i \\right) \\dot{N}_{\\mathrm{fuel}} = K_0 + K_1 \\dot{N}_{\\mathrm{fuel}}, $$\n其中\n$$ K_0 = \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}]_i, \\quad K_1 = k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{e}_f]_i. $$\n平行流出汇为\n$$ \\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} c_s A_{\\mathrm{sep}}, \\quad c_s = \\sqrt{\\frac{k_{\\mathrm{B}} T_{\\mathrm{e}}}{m_i}}. $$\n在稳态下，$\\dot{N}_{\\mathrm{ion}} = \\dot{N}_{\\mathrm{out}}$。求解所需的加料率，\n$$ \\dot{N}_{\\mathrm{fuel}}^{\\ast} = \\max \\left( 0, \\frac{\\dot{N}_{\\mathrm{out}} - K_0}{K_1} \\right). $$\n这个表达式确保了非负的加料，并且在物理上是一致的：如果仅再循环就提供了足够的电离（$K_0 \\ge \\dot{N}_{\\mathrm{out}}$），则加料为零；否则，加料率随亏损量线性增加。\n\n每个测试用例的算法步骤：\n- 从 $C_{\\mathrm{OD}}$、$C_{\\mathrm{ID}}$ 和 $S_{\\mathrm{D}}$ 组装矩阵 $\\mathbf{A}$。\n- 计算再循环通量 $Q_{\\mathrm{rec},\\mathrm{O}} = R \\Gamma_{\\mathrm{O}} A_{t,\\mathrm{O}} k_{\\mathrm{B}} T_{\\mathrm{n}}$，$Q_{\\mathrm{rec},\\mathrm{I}} = R \\Gamma_{\\mathrm{I}} A_{t,\\mathrm{I}} k_{\\mathrm{B}} T_{\\mathrm{n}}$，$Q_{\\mathrm{rec},\\mathrm{D}} = 0$，和 $\\mathbf{Q}_{\\mathrm{rec}}$。\n- 求解 $\\mathbf{p}_{\\mathrm{rec}} = \\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}$。\n- 求解单位通量的加料响应 $\\mathbf{p}_{\\mathrm{resp}} = \\mathbf{A}^{-1} \\mathbf{e}_f$，使得 $\\mathbf{p}_{\\mathrm{fuel}} = \\mathbf{p}_{\\mathrm{resp}} \\, Q_{\\mathrm{fuel}}$。\n- 计算 $i \\in \\{\\mathrm{O},\\mathrm{I},\\mathrm{D}\\}$ 的 $K_i = n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i /(k_{\\mathrm{B}} T_{\\mathrm{n}})$。\n- 计算 $K_0 = \\sum_i K_i p_{\\mathrm{rec},i}$ 和 $K_1 = k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i p_{\\mathrm{resp},i}$。\n- 计算 $c_s = \\sqrt{k_{\\mathrm{B}} T_{\\mathrm{e}} / m_i}$ 和 $\\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} c_s A_{\\mathrm{sep}}$。\n- 如果 $K_1 > 0$，则计算 $\\dot{N}_{\\mathrm{fuel}}^{\\ast} = \\max(0, (\\dot{N}_{\\mathrm{out}} - K_0)/K_1)$；否则将 $\\dot{N}_{\\mathrm{fuel}}^{\\ast}$ 设为 0 作为安全备用。\n- 计算总压力 $\\mathbf{p} = \\mathbf{p}_{\\mathrm{rec}} + \\mathbf{p}_{\\mathrm{resp}} ( \\dot{N}_{\\mathrm{fuel}}^{\\ast} k_{\\mathrm{B}} T_{\\mathrm{n}} )$。\n- 返回 $[\\dot{N}_{\\mathrm{fuel}}^{\\ast}, p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_case(params):\n    # Constants\n    kB = 1.380649e-23  # J/K\n    eV_to_J = 1.602176634e-19  # J/eV\n    m_i = 3.345e-27  # kg (deuterium ion mass)\n\n    # Unpack parameters\n    C_OD = params[\"C_OD\"]\n    C_ID = params[\"C_ID\"]\n    S_D = params[\"S_D\"]\n    R = params[\"R\"]\n    Gamma_O = params[\"Gamma_O\"]\n    A_t_O = params[\"A_t_O\"]\n    Gamma_I = params[\"Gamma_I\"]\n    A_t_I = params[\"A_t_I\"]\n    n_sep = params[\"n_sep\"]\n    T_e_eV = params[\"T_e_eV\"]\n    A_sep = params[\"A_sep\"]\n    T_n = params[\"T_n\"]\n    V_O, V_I, V_D = params[\"V\"]\n    sigma_v = params[\"sigma_v\"]\n\n    # Build A matrix for 3-node network: O(0), I(1), D(2)\n    A = np.array([\n        [C_OD,     0.0,     -C_OD],\n        [0.0,      C_ID,    -C_ID],\n        [-C_OD,    -C_ID,   C_OD + C_ID + S_D]\n    ], dtype=float)\n\n    # Recycling throughputs (Pa*m^3/s)\n    Q_rec_O = R * Gamma_O * A_t_O * kB * T_n\n    Q_rec_I = R * Gamma_I * A_t_I * kB * T_n\n    Q_rec_D = 0.0\n    Q_rec = np.array([Q_rec_O, Q_rec_I, Q_rec_D], dtype=float)\n\n    # Solve for recycling-only pressures\n    p_rec = np.linalg.solve(A, Q_rec)\n\n    # Fueling at outer node: unit throughput response\n    e_f = np.array([1.0, 0.0, 0.0], dtype=float)\n    p_resp = np.linalg.solve(A, e_f)  # Pa per (Pa*m^3/s) of throughput\n\n    # Ionization coupling coefficients per pressure (1/s/Pa)\n    K_O = n_sep * sigma_v * V_O / (kB * T_n)\n    K_I = n_sep * sigma_v * V_I / (kB * T_n)\n    K_D = n_sep * sigma_v * V_D / (kB * T_n)\n    K_vec = np.array([K_O, K_I, K_D], dtype=float)\n\n    # K0 and K1\n    K0 = float(np.dot(K_vec, p_rec))\n    K1 = float(kB * T_n * np.dot(K_vec, p_resp))\n\n    # Outflow sink\n    T_e_J = T_e_eV * eV_to_J\n    c_s = np.sqrt(kB * T_e_J / m_i)\n    Ndot_out = n_sep * c_s * A_sep\n\n    # Fueling requirement\n    if K1 > 0.0:\n        Ndot_fuel = max(0.0, (Ndot_out - K0) / K1)\n    else:\n        Ndot_fuel = 0.0  # Fallback; physically K1 should be > 0\n\n    # Total pressures with fueling\n    Q_fuel = Ndot_fuel * kB * T_n\n    p_total = p_rec + p_resp * Q_fuel\n\n    # Return fueling rate and pressures\n    return [Ndot_fuel, p_total[0], p_total[1], p_total[2]]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C_OD\": 3.0,\n            \"C_ID\": 3.0,\n            \"S_D\": 50.0,\n            \"R\": 0.6,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 5.0e19,\n            \"T_e_eV\": 20.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        },\n        {\n            \"C_OD\": 3.0,\n            \"C_ID\": 3.0,\n            \"S_D\": 200.0,\n            \"R\": 0.1,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 5.0e19,\n            \"T_e_eV\": 20.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        },\n        {\n            \"C_OD\": 3.0,\n            \"C_ID\": 3.0,\n            \"S_D\": 50.0,\n            \"R\": 0.6,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 5.0e19,\n            \"T_e_eV\": 100.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        },\n        {\n            \"C_OD\": 5.0,\n            \"C_ID\": 4.0,\n            \"S_D\": 50.0,\n            \"R\": 0.0,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 3.0e19,\n            \"T_e_eV\": 20.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(compute_case(params))\n\n    # Final print statement in the exact required format.\n    # Single line, list of lists with floats.\n    # Ensure default str formatting to keep comma-separated list representation.\n    print(f\"[{','.join([str(res) for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}