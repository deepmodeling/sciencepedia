{
    "hands_on_practices": [
        {
            "introduction": "The interface between the hot, confined core plasma and the cooler edge region is where the action begins for any edge model. To accurately simulate the scrape-off layer, we must first define the source of particles flowing across this boundary, the separatrix. This exercise  provides hands-on practice with the standard advection-diffusion model, allowing you to calculate the outward particle flux based on the local plasma density, its gradient, and the underlying turbulent transport coefficients.",
            "id": "3960702",
            "problem": "A magnetic confinement fusion plasma in high-confinement mode has a steep edge density pedestal adjacent to the separatrix at minor radius $r=r_s$. Consider an axisymmetric toroidal plasma with radial coordinate $r$ increasing outward. Let the local edge transport be modeled in a thin shell straddling the pedestal shoulder such that the magnetic geometry may be treated as locally slab-like and the radial particle transport is dominated by cross-field processes. Start from the particle continuity equation, the definition of flux divergence, and a steady-state assumption with negligible volumetric particle sources in this thin shell. Close the model by assuming a standard advection–diffusion representation of the cross-field radial transport, composed of a Fickian diffusive component with a scalar turbulent diffusivity and an additive convective component with a prescribed outward velocity. Adopt the sign convention that a positive radial particle flux is outward across the separatrix into the scrape-off layer.\n\nDerive an expression for the local outward radial particle flux at the separatrix, $r=r_s$, in terms of the local parameters at the interface: the density $n_s \\equiv n(r_s)$, the radial gradient $g_s \\equiv \\left.\\frac{dn}{dr}\\right|_{r_s}$, the turbulent particle diffusivity $D_s$, and the outward convective velocity $V_s$. Then evaluate this flux numerically for the following scientifically plausible pedestal-edge parameters at the outboard midplane:\n- Separatrix density $n_s = 3.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$.\n- Pedestal gradient $g_s = -5.0 \\times 10^{20}\\ \\mathrm{m}^{-4}$ (the density decreases outward).\n- Turbulent particle diffusivity $D_s = 0.30\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$.\n- Outward convective velocity $V_s = 2.0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\n\nState clearly the resulting outward particle flux across the separatrix, $\\Gamma_s$, as a single real number. Express the final flux in $\\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$ and round your answer to three significant figures.\n\nBriefly, in one or two sentences, explain what must be specified at the core–edge interface to ensure that this flux matches a Scrape-Off Layer Plasma Simulator (SOLPS) edge domain in a core–edge integrated modeling workflow, emphasizing the role of $D_s$ and $V_s$.",
            "solution": "The problem requires the derivation and evaluation of the radial particle flux at the separatrix of a tokamak plasma, based on a simplified one-dimensional advection-diffusion model.\n\nFirst, the theoretical expression for the flux is derived. The starting point is the particle continuity equation, which in its general form is:\n$$\n\\frac{\\partial n}{\\partial t} + \\nabla \\cdot \\vec{\\Gamma} = S\n$$\nwhere $n$ is the particle density, $\\vec{\\Gamma}$ is the particle flux vector, and $S$ is the particle source rate per unit volume.\n\nThe problem specifies several simplifying assumptions for the thin shell at the plasma edge:\n1.  **Steady-state**: The system does not change in time, thus $\\frac{\\partial n}{\\partial t} = 0$.\n2.  **Negligible volumetric sources**: In the thin shell of interest, $S=0$.\n3.  **Locally slab-like geometry**: The complex toroidal geometry can be approximated as a one-dimensional system in the radial coordinate $r$.\n4.  **Dominant radial transport**: Only the radial component of the flux, $\\Gamma_r$, is considered significant.\n\nApplying the steady-state and source-free assumptions, the continuity equation reduces to:\n$$\n\\nabla \\cdot \\vec{\\Gamma} = 0\n$$\nIn a simplified one-dimensional radial geometry (a consequence of the \"locally slab-like\" assumption), the divergence operator acting on the radial flux $\\Gamma_r$ simplifies to $\\frac{d\\Gamma_r}{dr}$. Therefore, the continuity equation implies that the radial flux is constant within this source-free region:\n$$\n\\frac{d\\Gamma_r}{dr} = 0 \\implies \\Gamma_r(r) = \\text{constant}\n$$\nThis means the flux at the separatrix, $\\Gamma_s$, is the same as the flux throughout this thin shell.\n\nThe problem provides the closure relation for the radial particle flux, which is an advection-diffusion model:\n$$\n\\Gamma_r(r) = \\Gamma_{\\text{diff}}(r) + \\Gamma_{\\text{conv}}(r)\n$$\nThe diffusive component is given by Fick's law:\n$$\n\\Gamma_{\\text{diff}}(r) = -D(r)\\frac{dn}{dr}\n$$\nwhere $D(r)$ is the turbulent particle diffusivity. The negative sign ensures that the diffusive flux is directed down the density gradient (from higher to lower density).\n\nThe convective component is given by:\n$$\n\\Gamma_{\\text{conv}}(r) = n(r)V(r)\n$$\nwhere $V(r)$ is the convective velocity.\n\nCombining these components gives the total radial particle flux:\n$$\n\\Gamma_r(r) = -D(r)\\frac{dn}{dr} + n(r)V(r)\n$$\nThe sign convention is that a positive flux is directed outward. A typical pedestal has density decreasing outward, so $\\frac{dn}{dr}  0$, making the diffusive term $-D\\frac{dn}{dr}$ positive (outward). The problem specifies an outward convective velocity $V  0$, so the convective term $nV$ is also positive (outward). The model is consistent.\n\nTo find the flux at the separatrix, we evaluate this expression at $r=r_s$, using the given local parameters: $n_s \\equiv n(r_s)$, $g_s \\equiv \\left.\\frac{dn}{dr}\\right|_{r_s}$, $D_s \\equiv D(r_s)$, and $V_s \\equiv V(r_s)$.\nThe resulting expression for the outward radial particle flux at the separatrix is:\n$$\n\\Gamma_s = -D_s g_s + n_s V_s\n$$\nThis completes the derivation.\n\nNext, this expression is evaluated numerically using the provided parameters:\n- Separatrix density: $n_s = 3.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$\n- Pedestal gradient: $g_s = -5.0 \\times 10^{20}\\ \\mathrm{m}^{-4}$\n- Turbulent particle diffusivity: $D_s = 0.30\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$\n- Outward convective velocity: $V_s = 2.0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n\nSubstituting these values into the derived formula:\n$$\n\\Gamma_s = -(0.30\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1})(-5.0 \\times 10^{20}\\ \\mathrm{m}^{-4}) + (3.0 \\times 10^{19}\\ \\mathrm{m}^{-3})(2.0\\ \\mathrm{m}\\ \\mathrm{s}^{-1})\n$$\nThe diffusive and convective parts of the flux are calculated separately:\n$$\n\\Gamma_{\\text{diff},s} = -D_s g_s = -(0.30)(-5.0 \\times 10^{20})\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 1.5 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\Gamma_{\\text{conv},s} = n_s V_s = (3.0 \\times 10^{19})(2.0)\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 6.0 \\times 10^{19}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 0.6 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}\n$$\nThe total flux is the sum of these two components:\n$$\n\\Gamma_s = (1.5 \\times 10^{20} + 0.6 \\times 10^{20})\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} = 2.1 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}\n$$\nThe problem requires the answer to be rounded to three significant figures. Thus, the final numerical value is $2.10 \\times 10^{20}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$.\n\nIn a core-edge integrated modeling workflow, to ensure this calculated flux matches the input for a Scrape-Off Layer Plasma Simulator (SOLPS), the turbulent transport coefficients $D_s$ and $V_s$ must be specified consistently at the interface. These coefficients determine the particle flux boundary condition that the core model imposes on the edge domain, ensuring a physically consistent particle flow into the scrape-off layer.",
            "answer": "$$\\boxed{2.10 \\times 10^{20}}$$"
        },
        {
            "introduction": "Once particles and heat cross the separatrix, their fate is dictated by a stark anisotropy: they move rapidly along magnetic field lines but diffuse slowly across them. This fundamental competition sets the characteristic width of the scrape-off layer (SOL) and the temperature drop towards the divertor targets. In this practice , you will explore this balance by deriving the classic two-point model for parallel heat conduction and estimating the SOL width, $\\lambda_q$, providing crucial insight into how edge plasma profiles are formed.",
            "id": "3960723",
            "problem": "A magnetically confined fusion plasma in the Scrape-Off Layer (SOL) is modeled as a steady, anisotropic heat conduction problem along and across magnetic field lines. Let $s$ denote the parallel coordinate from the upstream midplane at $s=0$ to the divertor target at $s=L_{\\parallel}$, and let $r$ denote the cross-field radial coordinate. Assume no volumetric heat sources or sinks along the open field line connecting the upstream region to the target, so the parallel heat flux is conserved. The electron parallel conductive heat flux is given by the Spitzer–Härm form $q_{\\parallel} = - \\kappa_{0}\\, T^{5/2} \\, \\frac{\\partial T}{\\partial s}$, where $T(s)$ is the electron temperature measured in electronvolts and $\\kappa_{0}$ is a constant coefficient with units $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$. The cross-field heat flux is modeled as $q_{r} = - \\kappa_{\\perp} \\, \\frac{\\partial T}{\\partial r}$ with $\\kappa_{\\perp}$ constant in $r$ and units $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-1}$. \n\n1. Starting from the steady parallel heat flux balance and the boundary values $T(0)=T_{u}$ (upstream) and $T(L_{\\parallel})=T_{t}$ (target), derive the two-point model relation between $T_{u}$ and $T_{t}$ in terms of the constant parallel heat flux $q_{\\parallel}$, the connection length $L_{\\parallel}$, and the coefficient $\\kappa_{0}$.\n\n2. Using the steady anisotropic conduction equation $\\frac{\\partial}{\\partial s}\\!\\left(\\kappa_{0} T^{5/2} \\frac{\\partial T}{\\partial s}\\right) + \\frac{\\partial}{\\partial r}\\!\\left(\\kappa_{\\perp} \\frac{\\partial T}{\\partial r}\\right) = 0$, estimate the heat-flux decay length $\\lambda_{q}$ at the upstream midplane by balancing the characteristic parallel and cross-field conduction terms. Express $\\lambda_{q}$ in terms of $L_{\\parallel}$, $\\kappa_{0}$, $\\kappa_{\\perp}$, and a reference temperature. Evaluate your expression at the upstream temperature $T_{u}$.\n\nFor the numerical evaluation, use $L_{\\parallel} = 20\\,\\mathrm{m}$, $\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$, $\\kappa_{\\perp} = 0.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-1}$, and $T_{u} = 80\\,\\mathrm{eV}$. Round your numerical answer for $\\lambda_{q}$ to three significant figures and express it in meters.",
            "solution": "**Part 1: Derivation of the two-point model relation**\n\nThe problem starts with the Spitzer–Härm law for electron parallel heat flux, $q_{\\parallel}$, under the assumption that it is constant along the magnetic field line coordinate, $s$. Since the temperature $T$ is considered only as a function of $s$ in this one-dimensional analysis, we can write the governing equation as a first-order ordinary differential equation:\n$$q_{\\parallel} = - \\kappa_{0}\\, T(s)^{5/2} \\, \\frac{dT}{ds}$$\nHere, $q_{\\parallel}$ and $\\kappa_{0}$ are constants. To find the relationship between the upstream temperature $T_{u}$ and the target temperature $T_{t}$, we must integrate this equation. We separate the variables $T$ and $s$:\n$$\\kappa_{0}\\, T^{5/2} \\, dT = -q_{\\parallel} \\, ds$$\nNext, we integrate both sides over their respective domains. The temperature $T$ varies from $T_u$ at $s=0$ to $T_t$ at $s=L_{\\parallel}$.\n$$\\int_{T_u}^{T_t} \\kappa_{0} \\, T^{5/2} \\, dT = \\int_{0}^{L_{\\parallel}} -q_{\\parallel} \\, ds$$\nSince $\\kappa_{0}$ and $q_{\\parallel}$ are constants with respect to the integration variables, we can move them outside the integrals:\n$$\\kappa_{0} \\int_{T_u}^{T_t} T^{5/2} \\, dT = -q_{\\parallel} \\int_{0}^{L_{\\parallel}} ds$$\nPerforming the integration yields:\n$$\\kappa_{0} \\left[ \\frac{T^{7/2}}{7/2} \\right]_{T_u}^{T_t} = -q_{\\parallel} [s]_{0}^{L_{\\parallel}}$$\n$$\\frac{2\\kappa_{0}}{7} \\left( T_t^{7/2} - T_u^{7/2} \\right) = -q_{\\parallel} \\left( L_{\\parallel} - 0 \\right)$$\nMultiplying by $-1$ and rearranging gives the standard form of the two-point model relation:\n$$T_u^{7/2} - T_t^{7/2} = \\frac{7 q_{\\parallel} L_{\\parallel}}{2 \\kappa_{0}}$$\nThis equation relates the upstream and target temperatures to the parallel heat flux and the connection length.\n\n**Part 2: Estimation of the heat-flux decay length $\\lambda_{q}$**\n\nThe second part of the problem involves the steady, two-dimensional anisotropic heat conduction equation:\n$$\\frac{\\partial}{\\partial s}\\!\\left(\\kappa_{0} T^{5/2} \\frac{\\partial T}{\\partial s}\\right) + \\frac{\\partial}{\\partial r}\\!\\left(\\kappa_{\\perp} \\frac{\\partial T}{\\partial r}\\right) = 0$$\nWe are asked to estimate the characteristic radial decay length, $\\lambda_{q}$, by balancing the two terms in this equation. This is a scale analysis. Let's denote the characteristic length scales for the variations in the parallel ($s$) and radial ($r$) directions as $L_s$ and $L_r$, respectively. The characteristic temperature is denoted by $T_{char}$.\n\nThe problem specifies the upstream midplane. The characteristic parallel length scale is the connection length to the target, so $L_s \\sim L_{\\parallel}$. The characteristic radial length scale is the quantity we are looking for, $\\lambda_q$, so $L_r \\sim \\lambda_q$. The problem asks to evaluate the expression at the upstream temperature, so we take the characteristic temperature to be $T_{char} \\sim T_u$.\n\nWith these scales, we can estimate the order of magnitude of the partial derivatives:\n$$\\frac{\\partial}{\\partial s} \\sim \\frac{1}{L_{\\parallel}}, \\quad \\frac{\\partial}{\\partial r} \\sim \\frac{1}{\\lambda_q}, \\quad T \\sim T_u$$\nNow, we estimate the magnitude of each term in the PDE:\n-   Parallel conduction term: $\\frac{\\partial}{\\partial s}\\!\\left(-\\underbrace{q_{\\parallel}}_{-\\kappa_{0} T^{5/2} \\frac{\\partial T}{\\partial s}}\\right) \\sim \\frac{1}{L_{\\parallel}} \\left( \\kappa_{0} T_u^{5/2} \\frac{T_u}{L_{\\parallel}} \\right) = \\frac{\\kappa_{0} T_u^{7/2}}{L_{\\parallel}^2}$\n-   Cross-field conduction term: $\\frac{\\partial}{\\partial r}\\!\\left(-\\underbrace{q_{r}}_{-\\kappa_{\\perp} \\frac{\\partial T}{\\partial r}}\\right) \\sim \\frac{1}{\\lambda_q} \\left( \\kappa_{\\perp} \\frac{T_u}{\\lambda_q} \\right) = \\frac{\\kappa_{\\perp} T_u}{\\lambda_q^2}$\n\nBalancing these two terms means setting their magnitudes approximately equal:\n$$\\frac{\\kappa_{\\perp} T_u}{\\lambda_q^2} \\approx \\frac{\\kappa_{0} T_u^{7/2}}{L_{\\parallel}^2}$$\nWe can now solve for $\\lambda_q^2$:\n$$\\lambda_q^2 \\approx \\frac{\\kappa_{\\perp} T_u}{\\kappa_{0} T_u^{7/2}} L_{\\parallel}^2 = \\frac{\\kappa_{\\perp}}{\\kappa_{0} T_u^{5/2}} L_{\\parallel}^2$$\nTaking the square root gives the expression for the heat-flux decay length $\\lambda_q$:\n$$\\lambda_q \\approx \\sqrt{\\frac{\\kappa_{\\perp}}{\\kappa_{0} T_u^{5/2}}} L_{\\parallel}$$\n\n**Numerical Evaluation**\nWe are given the following values:\n-   $L_{\\parallel} = 20\\,\\mathrm{m}$\n-   $\\kappa_{0} = 2000\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$\n-   $\\kappa_{\\perp} = 0.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-1}$\n-   $T_{u} = 80\\,\\mathrm{eV}$\n\nSubstitute these values into the derived expression for $\\lambda_q$:\n$$\\lambda_q \\approx \\sqrt{\\frac{0.5}{2000 \\cdot (80)^{5/2}}} \\cdot 20$$\nFirst, calculate $(80)^{5/2}$:\n$$(80)^{5/2} = (80^2)\\sqrt{80} = 6400 \\sqrt{16 \\cdot 5} = 6400 \\cdot 4\\sqrt{5} = 25600\\sqrt{5} \\approx 57243.34$$\nNow, substitute this into the expression for $\\lambda_q$:\n$$\\lambda_q \\approx 20 \\cdot \\sqrt{\\frac{0.5}{2000 \\cdot 57243.34}} = 20 \\cdot \\sqrt{\\frac{0.5}{114486677}} \\approx 20 \\cdot \\sqrt{4.3674 \\times 10^{-9}}$$\n$$\\lambda_q \\approx 20 \\cdot (6.6086 \\times 10^{-5}) \\approx 0.0013217\\,\\mathrm{m}$$\nThe problem requires the numerical answer for $\\lambda_q$ to be rounded to three significant figures and expressed in meters.\n$$\\lambda_q \\approx 0.00132\\,\\mathrm{m}$$\nExpressed in scientific notation, this is $1.32 \\times 10^{-3}\\,\\mathrm{m}$.",
            "answer": "$$\\boxed{1.32 \\times 10^{-3}}$$"
        },
        {
            "introduction": "A truly 'integrated' model must capture the feedback loops that couple disparate physical systems together. In fusion plasmas, one of the most critical loops involves the recycling of plasma particles as neutral gas, which then fuels the plasma through ionization. This comprehensive practice  guides you through building a simplified but complete system model that connects divertor geometry, pumping, neutral gas dynamics, and plasma particle balance to determine the required external fueling rate—a central task in predictive simulation.",
            "id": "3960728",
            "problem": "A three-node neutral gas conductance model is used to couple divertor geometry and pumping to edge plasma fueling in a tokamak, consistent with core–edge integrated modeling. The three nodes represent the outer divertor ($\\mathrm{O}$), inner divertor ($\\mathrm{I}$), and the common divertor duct ($\\mathrm{D}$) that connects to a pump. The objective is to compute the steady-state neutral pressure distribution and the external fueling rate required to maintain a specified separatrix plasma density in the Scrape-Off Layer (SOL).\n\nFundamental base:\n- Ideal gas law relates neutral number density $n_{\\mathrm{n}}$ to pressure $p$ via $n_{\\mathrm{n}} = p/(k_{\\mathrm{B}} T_{\\mathrm{n}})$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T_{\\mathrm{n}}$ is the neutral gas temperature.\n- Molecular flow network theory describes neutral throughput $Q$ between nodes $i$ and $j$ as $Q_{ij} = C_{ij} (p_i - p_j)$, where $C_{ij}$ is the conductance (geometry-dependent, units $\\mathrm{m^3/s}$). Pumping at node $i$ removes throughput $Q_{\\mathrm{pump},i} = S_i p_i$, where $S_i$ is the pumping speed at node $i$ (units $\\mathrm{m^3/s}$). Recycling sources at node $i$ are represented as throughput $Q_{\\mathrm{rec},i} = R \\, \\Gamma_i \\, A_{t,i} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$, where $R$ is the recycling coefficient (dimensionless), $\\Gamma_i$ is the incident ion flux density (units $\\mathrm{m^{-2} s^{-1}}$), and $A_{t,i}$ is the target surface area (units $\\mathrm{m^2}$). External fueling injects a particle rate $\\dot{N}_{\\mathrm{fuel}}$ at a chosen node, represented in the network as throughput $Q_{\\mathrm{fuel}} = \\dot{N}_{\\mathrm{fuel}} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$ at that node.\n- Edge ionization source to plasma is approximated by $ \\dot{N}_{\\mathrm{ion}} = \\sum_i \\int n_{\\mathrm{n}} n_{\\mathrm{e}} \\langle \\sigma v \\rangle \\, dV \\approx \\sum_i \\left( \\frac{p_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}} \\right) n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i$, where $n_{\\mathrm{e}}$ near the separatrix is approximated by the target separatrix density $n_{\\mathrm{sep}}$, $\\langle \\sigma v \\rangle$ is the electron-impact ionization rate coefficient for deuterium (units $\\mathrm{m^3/s}$), and $V_i$ is the effective edge interaction volume for node $i$ (units $\\mathrm{m^3}$).\n- Parallel particle outflow sink along open field lines is modeled by $ \\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} \\, c_s \\, A_{\\mathrm{sep}}$, where the isothermal ion sound speed is $ c_s = \\sqrt{k_{\\mathrm{B}} T_{\\mathrm{e}} / m_i}$ with electron temperature $T_{\\mathrm{e}}$ and ion mass $m_i$ (deuterium), and $A_{\\mathrm{sep}}$ is the effective separatrix area (units $\\mathrm{m^2}$).\n\nModel equations:\n- Steady-state neutral balances at each node satisfy\n$$ \\sum_j C_{ij} (p_i - p_j) + S_i p_i = Q_{\\mathrm{rec},i} + Q_{\\mathrm{fuel},i}.$$\nThis can be written as a linear system $ \\mathbf{A} \\mathbf{p} = \\mathbf{Q}$, where $\\mathbf{A}$ is a matrix constructed from conductances and pumping speeds, $\\mathbf{p}$ is the vector of node pressures, and $\\mathbf{Q}$ is the vector of source throughputs (recycling plus fueling).\n\n- The ionization source is linear in $\\mathbf{p}$:\n$$ \\dot{N}_{\\mathrm{ion}} = \\sum_i K_i p_i, \\quad K_i = \\frac{n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}}.$$\n\n- The edge steady-state condition requires the total ionization source to equal the parallel outflow sink:\n$$ \\dot{N}_{\\mathrm{ion}} = \\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} \\sqrt{\\frac{k_{\\mathrm{B}} T_{\\mathrm{e}}}{m_i}} A_{\\mathrm{sep}}.$$\n\n- Because $ \\mathbf{p} = \\mathbf{A}^{-1} (\\mathbf{Q}_{\\mathrm{rec}} + \\mathbf{e}_f Q_{\\mathrm{fuel}})$, where $\\mathbf{e}_f$ selects the fueling node, one can write\n$$ \\dot{N}_{\\mathrm{ion}} = K_0 + K_1 \\, \\dot{N}_{\\mathrm{fuel}}, $$\nwhere\n$$ K_0 = \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}]_i, \\quad K_1 = k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{e}_f]_i.$$\nThen the required fueling rate is\n$$ \\dot{N}_{\\mathrm{fuel}}^{\\ast} = \\max\\left( 0, \\frac{ \\dot{N}_{\\mathrm{out}} - K_0 }{ K_1 } \\right). $$\n\nTasks:\n- Implement the above model for a three-node network with outer ($\\mathrm{O}$), inner ($\\mathrm{I}$), and duct ($\\mathrm{D}$) nodes, with conductances $C_{\\mathrm{OD}}$ and $C_{\\mathrm{ID}}$ (no direct $\\mathrm{O}$–$\\mathrm{I}$ coupling), and pumping speed $S_{\\mathrm{D}}$ at the duct node only. External fueling enters at the outer node.\n- Compute the steady-state pressure distribution $\\{p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}\\}$ and the required external fueling rate $\\dot{N}_{\\mathrm{fuel}}^{\\ast}$ that maintains the target separatrix density by satisfying the particle balance. Express pressures in $\\mathrm{Pa}$ and the fueling rate in particles per second (units $\\mathrm{s^{-1}}$).\n\nConstants:\n- Use $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$.\n- Use deuterium ion mass $m_i = 3.345 \\times 10^{-27} \\, \\mathrm{kg}$.\n- Convert electron temperature from electron-volts using $1 \\, \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\, \\mathrm{J}$.\n\nTest suite:\nProvide four test cases with the following parameters. All quantities are in SI units.\n\n- Case $1$ (baseline):\n  - Conductances: $C_{\\mathrm{OD}} = 3.0$, $C_{\\mathrm{ID}} = 3.0$.\n  - Pumping: $S_{\\mathrm{D}} = 50.0$.\n  - Recycling: $R = 0.6$, $\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$, $A_{t,\\mathrm{O}} = 4.0$; $\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$, $A_{t,\\mathrm{I}} = 3.0$.\n  - Edge: $n_{\\mathrm{sep}} = 5.0 \\times 10^{19}$, $T_{\\mathrm{e}} = 20.0$ $\\mathrm{eV}$, $A_{\\mathrm{sep}} = 50.0$.\n  - Neutral: $T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$.\n  - Volumes: $V_{\\mathrm{O}} = 0.4$, $V_{\\mathrm{I}} = 0.3$, $V_{\\mathrm{D}} = 0.2$.\n  - Ionization coefficient: $\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$.\n\n- Case $2$ (strong pumping and weak recycling):\n  - Conductances: $C_{\\mathrm{OD}} = 3.0$, $C_{\\mathrm{ID}} = 3.0$.\n  - Pumping: $S_{\\mathrm{D}} = 200.0$.\n  - Recycling: $R = 0.1$, $\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$, $A_{t,\\mathrm{O}} = 4.0$; $\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$, $A_{t,\\mathrm{I}} = 3.0$.\n  - Edge: $n_{\\mathrm{sep}} = 5.0 \\times 10^{19}$, $T_{\\mathrm{e}} = 20.0$ $\\mathrm{eV}$, $A_{\\mathrm{sep}} = 50.0$.\n  - Neutral: $T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$.\n  - Volumes: $V_{\\mathrm{O}} = 0.4$, $V_{\\mathrm{I}} = 0.3$, $V_{\\mathrm{D}} = 0.2$.\n  - Ionization coefficient: $\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$.\n\n- Case $3$ (hot edge plasma):\n  - Conductances: $C_{\\mathrm{OD}} = 3.0$, $C_{\\mathrm{ID}} = 3.0$.\n  - Pumping: $S_{\\mathrm{D}} = 50.0$.\n  - Recycling: $R = 0.6$, $\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$, $A_{t,\\mathrm{O}} = 4.0$; $\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$, $A_{t,\\mathrm{I}} = 3.0$.\n  - Edge: $n_{\\mathrm{sep}} = 5.0 \\times 10^{19}$, $T_{\\mathrm{e}} = 100.0$ $\\mathrm{eV}$, $A_{\\mathrm{sep}} = 50.0$.\n  - Neutral: $T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$.\n  - Volumes: $V_{\\mathrm{O}} = 0.4$, $V_{\\mathrm{I}} = 0.3$, $V_{\\mathrm{D}} = 0.2$.\n  - Ionization coefficient: $\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$.\n\n- Case $4$ (no recycling, high conductance):\n  - Conductances: $C_{\\mathrm{OD}} = 5.0$, $C_{\\mathrm{ID}} = 4.0$.\n  - Pumping: $S_{\\mathrm{D}} = 50.0$.\n  - Recycling: $R = 0.0$, $\\Gamma_{\\mathrm{O}} = 1.0 \\times 10^{20}$, $A_{t,\\mathrm{O}} = 4.0$; $\\Gamma_{\\mathrm{I}} = 8.0 \\times 10^{19}$, $A_{t,\\mathrm{I}} = 3.0$.\n  - Edge: $n_{\\mathrm{sep}} = 3.0 \\times 10^{19}$, $T_{\\mathrm{e}} = 20.0$ $\\mathrm{eV}$, $A_{\\mathrm{sep}} = 50.0$.\n  - Neutral: $T_{\\mathrm{n}} = 300.0$ $\\mathrm{K}$.\n  - Volumes: $V_{\\mathrm{O}} = 0.4$, $V_{\\mathrm{I}} = 0.3$, $V_{\\mathrm{D}} = 0.2$.\n  - Ionization coefficient: $\\langle \\sigma v \\rangle = 2.0 \\times 10^{-14}$.\n\nRequired output:\n- For each test case, compute the fueling rate $\\dot{N}_{\\mathrm{fuel}}^{\\ast}$ (units $\\mathrm{s^{-1}}$) and the pressure triplet $\\{p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}\\}$ (units $\\mathrm{Pa}$).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a sublist of four floats in the order $[\\dot{N}_{\\mathrm{fuel}}^{\\ast}, p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}]$, for example $[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\dots]$.",
            "solution": "The solution is based on first principles of neutral gas dynamics and plasma particle balance in the edge region, systematically connecting divertor geometry, pumping, and recycling to the neutral pressure field, which in turn controls ionization fueling of the plasma. The derivation is as follows.\n\nDefine three nodes representing the outer divertor ($\\mathrm{O}$), inner divertor ($\\mathrm{I}$), and duct ($\\mathrm{D}$). Conductances are $C_{\\mathrm{OD}}$ connecting $\\mathrm{O}$ to $\\mathrm{D}$ and $C_{\\mathrm{ID}}$ connecting $\\mathrm{I}$ to $\\mathrm{D}$. There is pumping speed $S_{\\mathrm{D}}$ at $\\mathrm{D}$ only. Let the neutral gas temperature be $T_{\\mathrm{n}}$.\n\nFor each node $i$, the steady-state neutral throughput balance is\n$$ \\sum_j C_{ij} (p_i - p_j) + S_i p_i = Q_{\\mathrm{rec},i} + Q_{\\mathrm{fuel},i}, $$\nwhere $Q_{\\mathrm{rec},i} = R \\, \\Gamma_i \\, A_{t,i} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$ represents recycling and $Q_{\\mathrm{fuel},i} = \\dot{N}_{\\mathrm{fuel}} \\, k_{\\mathrm{B}} T_{\\mathrm{n}}$ at the fueling node ($\\mathrm{O}$ in this setup) represents external fueling. For the three-node network with no direct $\\mathrm{O}$–$\\mathrm{I}$ path and pumping only at $\\mathrm{D}$, the linear system can be written in matrix form:\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{Q}, \\quad\n\\mathbf{A} =\n\\begin{bmatrix}\nC_{\\mathrm{OD}}  0  -C_{\\mathrm{OD}} \\\\\n0  C_{\\mathrm{ID}}  -C_{\\mathrm{ID}} \\\\\n-C_{\\mathrm{OD}}  -C_{\\mathrm{ID}}  C_{\\mathrm{OD}} + C_{\\mathrm{ID}} + S_{\\mathrm{D}}\n\\end{bmatrix},\n$$\n$$\n\\mathbf{Q} =\n\\begin{bmatrix}\nQ_{\\mathrm{rec},\\mathrm{O}} + Q_{\\mathrm{fuel}} \\\\\nQ_{\\mathrm{rec},\\mathrm{I}} \\\\\n0\n\\end{bmatrix}.\n$$\nSolving for $\\mathbf{p}$ gives $ \\mathbf{p} = \\mathbf{A}^{-1} \\mathbf{Q}$. Because $\\mathbf{Q}$ is the sum of recycling and fueling contributions, and the system is linear, one may decompose the pressure as\n$$ \\mathbf{p} = \\mathbf{p}_{\\mathrm{rec}} + \\mathbf{p}_{\\mathrm{fuel}}, \\quad \\mathbf{p}_{\\mathrm{rec}} = \\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}, \\quad \\mathbf{p}_{\\mathrm{fuel}} = \\mathbf{A}^{-1} \\mathbf{e}_f Q_{\\mathrm{fuel}}, $$\nwhere $\\mathbf{e}_f$ selects the fueling node ($\\mathbf{e}_f = [1,0,0]^T$ for outer fueling) and $Q_{\\mathrm{fuel}} = \\dot{N}_{\\mathrm{fuel}} k_{\\mathrm{B}} T_{\\mathrm{n}}$.\n\nThe plasma ionization source in the edge is obtained from the ideal gas relation $n_{\\mathrm{n}} = p/(k_{\\mathrm{B}} T_{\\mathrm{n}})$ and the collisional ionization rate:\n$$ \\dot{N}_{\\mathrm{ion}} = \\sum_i \\int n_{\\mathrm{n}} n_{\\mathrm{e}} \\langle \\sigma v \\rangle \\, dV \\approx \\sum_i \\left( \\frac{p_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}} \\right) n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i = \\sum_i K_i p_i, $$\nwith\n$$ K_i = \\frac{n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i}{k_{\\mathrm{B}} T_{\\mathrm{n}}}. $$\nBecause $\\mathbf{p}$ is linear in recycling and fueling, the ionization source can be written as\n$$ \\dot{N}_{\\mathrm{ion}} = \\sum_i K_i p_{\\mathrm{rec},i} + \\sum_i K_i p_{\\mathrm{fuel},i} = K_0 + \\left( k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{e}_f]_i \\right) \\dot{N}_{\\mathrm{fuel}} = K_0 + K_1 \\dot{N}_{\\mathrm{fuel}}, $$\nwhere\n$$ K_0 = \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}]_i, \\quad K_1 = k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i [\\mathbf{A}^{-1} \\mathbf{e}_f]_i. $$\nThe parallel outflow sink is\n$$ \\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} c_s A_{\\mathrm{sep}}, \\quad c_s = \\sqrt{\\frac{k_{\\mathrm{B}} T_{\\mathrm{e}}}{m_i}}. $$\nAt steady state, $\\dot{N}_{\\mathrm{ion}} = \\dot{N}_{\\mathrm{out}}$. Solving for the required fueling rate,\n$$ \\dot{N}_{\\mathrm{fuel}}^{\\ast} = \\max \\left( 0, \\frac{\\dot{N}_{\\mathrm{out}} - K_0}{K_1} \\right). $$\nThis expression ensures nonnegative fueling and is physically consistent: if recycling alone provides sufficient ionization ($K_0 \\ge \\dot{N}_{\\mathrm{out}}$), fueling is zero; otherwise, fueling increases linearly with the deficit.\n\nAlgorithmic steps for each test case:\n- Assemble $\\mathbf{A}$ from $C_{\\mathrm{OD}}$, $C_{\\mathrm{ID}}$, and $S_{\\mathrm{D}}$.\n- Compute recycling throughputs $Q_{\\mathrm{rec},\\mathrm{O}} = R \\Gamma_{\\mathrm{O}} A_{t,\\mathrm{O}} k_{\\mathrm{B}} T_{\\mathrm{n}}$, $Q_{\\mathrm{rec},\\mathrm{I}} = R \\Gamma_{\\mathrm{I}} A_{t,\\mathrm{I}} k_{\\mathrm{B}} T_{\\mathrm{n}}$, $Q_{\\mathrm{rec},\\mathrm{D}} = 0$, and $\\mathbf{Q}_{\\mathrm{rec}}$.\n- Solve $\\mathbf{p}_{\\mathrm{rec}} = \\mathbf{A}^{-1} \\mathbf{Q}_{\\mathrm{rec}}$.\n- Solve the fueling response per unit throughput $\\mathbf{p}_{\\mathrm{resp}} = \\mathbf{A}^{-1} \\mathbf{e}_f$, so that $\\mathbf{p}_{\\mathrm{fuel}} = \\mathbf{p}_{\\mathrm{resp}} \\, Q_{\\mathrm{fuel}}$.\n- Compute $K_i = n_{\\mathrm{sep}} \\langle \\sigma v \\rangle V_i /(k_{\\mathrm{B}} T_{\\mathrm{n}})$ for $i \\in \\{\\mathrm{O},\\mathrm{I},\\mathrm{D}\\}$.\n- Compute $K_0 = \\sum_i K_i p_{\\mathrm{rec},i}$ and $K_1 = k_{\\mathrm{B}} T_{\\mathrm{n}} \\sum_i K_i p_{\\mathrm{resp},i}$.\n- Compute $c_s = \\sqrt{k_{\\mathrm{B}} T_{\\mathrm{e}} / m_i}$ and $\\dot{N}_{\\mathrm{out}} = n_{\\mathrm{sep}} c_s A_{\\mathrm{sep}}$.\n- Compute $\\dot{N}_{\\mathrm{fuel}}^{\\ast} = \\max(0, (\\dot{N}_{\\mathrm{out}} - K_0)/K_1)$ if $K_1  0$; otherwise set $\\dot{N}_{\\mathrm{fuel}}^{\\ast} = 0$ as a safe fallback.\n- Compute total pressures $\\mathbf{p} = \\mathbf{p}_{\\mathrm{rec}} + \\mathbf{p}_{\\mathrm{resp}} ( \\dot{N}_{\\mathrm{fuel}}^{\\ast} k_{\\mathrm{B}} T_{\\mathrm{n}} )$.\n- Return $[\\dot{N}_{\\mathrm{fuel}}^{\\ast}, p_{\\mathrm{O}}, p_{\\mathrm{I}}, p_{\\mathrm{D}}]$.\n\nScientific realism and edge cases:\n- All parameters use SI units, and the throughput-pressure-conductance relationships follow vacuum technology conventions.\n- The test suite includes a baseline case, a strong-pumping weak-recycling case (fueling needed), a hot-edge case (larger outflow sink), and a no-recycling case (fueling dominates).\n- The linear network guarantees a unique steady-state solution because $\\mathbf{A}$ is strictly diagonally dominant for positive conductances and pumping speeds, ensuring physical solvability.\n\nThe final program implements these steps, solves each test case using linear algebra, and prints a single-line aggregate list of sublists, each containing the fueling rate in $\\mathrm{s^{-1}}$ followed by the three node pressures in $\\mathrm{Pa}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_case(params):\n    # Constants\n    kB = 1.380649e-23  # J/K\n    eV_to_J = 1.602176634e-19  # J/eV\n    m_i = 3.345e-27  # kg (deuterium ion mass)\n\n    # Unpack parameters\n    C_OD = params[\"C_OD\"]\n    C_ID = params[\"C_ID\"]\n    S_D = params[\"S_D\"]\n    R = params[\"R\"]\n    Gamma_O = params[\"Gamma_O\"]\n    A_t_O = params[\"A_t_O\"]\n    Gamma_I = params[\"Gamma_I\"]\n    A_t_I = params[\"A_t_I\"]\n    n_sep = params[\"n_sep\"]\n    T_e_eV = params[\"T_e_eV\"]\n    A_sep = params[\"A_sep\"]\n    T_n = params[\"T_n\"]\n    V_O, V_I, V_D = params[\"V\"]\n    sigma_v = params[\"sigma_v\"]\n\n    # Build A matrix for 3-node network: O(0), I(1), D(2)\n    A = np.array([\n        [C_OD,     0.0,     -C_OD],\n        [0.0,      C_ID,    -C_ID],\n        [-C_OD,    -C_ID,   C_OD + C_ID + S_D]\n    ], dtype=float)\n\n    # Recycling throughputs (Pa*m^3/s)\n    Q_rec_O = R * Gamma_O * A_t_O * kB * T_n\n    Q_rec_I = R * Gamma_I * A_t_I * kB * T_n\n    Q_rec_D = 0.0\n    Q_rec = np.array([Q_rec_O, Q_rec_I, Q_rec_D], dtype=float)\n\n    # Solve for recycling-only pressures\n    p_rec = np.linalg.solve(A, Q_rec)\n\n    # Fueling at outer node: unit throughput response\n    e_f = np.array([1.0, 0.0, 0.0], dtype=float)\n    p_resp = np.linalg.solve(A, e_f)  # Pa per (Pa*m^3/s) of throughput\n\n    # Ionization coupling coefficients per pressure (1/s/Pa)\n    K_O = n_sep * sigma_v * V_O / (kB * T_n)\n    K_I = n_sep * sigma_v * V_I / (kB * T_n)\n    K_D = n_sep * sigma_v * V_D / (kB * T_n)\n    K_vec = np.array([K_O, K_I, K_D], dtype=float)\n\n    # K0 and K1\n    K0 = float(np.dot(K_vec, p_rec))\n    K1 = float(kB * T_n * np.dot(K_vec, p_resp))\n\n    # Outflow sink\n    T_e_J = T_e_eV * eV_to_J\n    c_s = np.sqrt(kB * T_e_J / m_i)\n    Ndot_out = n_sep * c_s * A_sep\n\n    # Fueling requirement\n    if K1 > 0.0:\n        Ndot_fuel = max(0.0, (Ndot_out - K0) / K1)\n    else:\n        Ndot_fuel = 0.0  # Fallback; physically K1 should be > 0\n\n    # Total pressures with fueling\n    Q_fuel = Ndot_fuel * kB * T_n\n    p_total = p_rec + p_resp * Q_fuel\n\n    # Return fueling rate and pressures\n    return [Ndot_fuel, p_total[0], p_total[1], p_total[2]]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C_OD\": 3.0,\n            \"C_ID\": 3.0,\n            \"S_D\": 50.0,\n            \"R\": 0.6,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 5.0e19,\n            \"T_e_eV\": 20.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        },\n        {\n            \"C_OD\": 3.0,\n            \"C_ID\": 3.0,\n            \"S_D\": 200.0,\n            \"R\": 0.1,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 5.0e19,\n            \"T_e_eV\": 20.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        },\n        {\n            \"C_OD\": 3.0,\n            \"C_ID\": 3.0,\n            \"S_D\": 50.0,\n            \"R\": 0.6,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 5.0e19,\n            \"T_e_eV\": 100.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        },\n        {\n            \"C_OD\": 5.0,\n            \"C_ID\": 4.0,\n            \"S_D\": 50.0,\n            \"R\": 0.0,\n            \"Gamma_O\": 1.0e20,\n            \"A_t_O\": 4.0,\n            \"Gamma_I\": 8.0e19,\n            \"A_t_I\": 3.0,\n            \"n_sep\": 3.0e19,\n            \"T_e_eV\": 20.0,\n            \"A_sep\": 50.0,\n            \"T_n\": 300.0,\n            \"V\": (0.4, 0.3, 0.2),\n            \"sigma_v\": 2.0e-14\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(compute_case(params))\n\n    # Final print statement in the exact required format.\n    # Single line, list of lists with floats.\n    # Ensure default str formatting to keep comma-separated list representation.\n    print(f\"[{','.join([str(res) for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}