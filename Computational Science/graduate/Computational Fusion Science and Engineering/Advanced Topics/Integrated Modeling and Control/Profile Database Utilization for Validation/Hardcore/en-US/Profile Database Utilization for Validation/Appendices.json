{
    "hands_on_practices": [
        {
            "introduction": "Before using a database profile to validate an external transport model, it is essential to first confirm the profile's internal self-consistency. This practice  challenges you to connect the fundamental theoretical relationships of magnetohydrodynamic (MHD) equilibrium to the data. By deriving the mapping between geometric and magnetic flux coordinates from a given safety factor profile, you will perform a critical consistency check that is foundational to robust validation.",
            "id": "4032731",
            "problem": "A research team is validating the internal consistency of a magnetic equilibrium profile database by cross-checking the mapping between the minor radius $r$ and the normalized poloidal flux radius $\\rho_{\\text{pol}}$. The device is a large-aspect-ratio tokamak with major radius $R_{0}$ and minor radius $a$, and the profile database provides a safety factor profile $q(r)$ and a poloidal flux profile $\\psi(r)$ recorded under conditions of steady, axisymmetric operation. For computational validation, all analysis is to be performed under the standard large-aspect-ratio, circular-flux-surface approximation.\n\nIn an axisymmetric torus, the magnetic field can be represented by $\\mathbf{B} = \\nabla \\psi \\times \\nabla \\phi + F(\\psi)\\nabla \\phi / R$, where $\\psi$ is the poloidal flux function per radian and $\\phi$ is the toroidal angle. In the large-aspect-ratio, circular-flux-surface limit, the poloidal magnetic field magnitude satisfies $B_{p}(r) = \\frac{1}{R_{0}}\\frac{d\\psi}{dr}$, and the safety factor definition reduces to $q(r) = \\frac{r B_{t}}{R_{0} B_{p}(r)}$, where $B_{t}$ is the toroidal magnetic field, treated here as radially uniform over the minor radius. The normalized poloidal flux radius is defined by\n$$\n\\rho_{\\text{pol}}(r) = \\sqrt{\\frac{\\psi(r) - \\psi(0)}{\\psi(a) - \\psi(0)}},\n$$\nwhich is dimensionless. The profile database uses the convention $\\psi(0)=0$ for normalization.\n\nAssume the following for scientific realism in this validation task:\n- Axisymmetry holds, so that $\\psi$ is a function of $r$ only.\n- Flux surfaces are circular and nested, with minor radius $r \\in [0,a]$.\n- The toroidal field $B_{t}$ is radially uniform over $r \\in [0,a]$ and strictly positive.\n- The safety factor profile returned by the database is strictly positive and monotonically increasing over $r \\in [0,a]$.\n\nUnder these assumptions, derive the transformation $\\rho_{\\text{pol}}(r)$ in closed form in terms of $r$, $a$, and the parameters of the safety factor profile when the profile database parameterizes\n$$\nq(r) = q_{0} + q_{2} \\left(\\frac{r}{a}\\right)^{2},\n$$\nwith $q_{0} > 0$ and $q_{2} > 0$. The poloidal flux $\\psi(r)$ in the database is to be used for normalization via $\\psi(0)=0$ and $\\psi(a)$, but you must show how the normalization can be obtained self-consistently from $q(r)$ given the stated assumptions. Express your final answer as a single closed-form analytic expression for $\\rho_{\\text{pol}}(r)$ in terms of $r$, $a$, $q_{0}$, and $q_{2}$. No numerical evaluation is required. The final answer is dimensionless, so no units are to be included. State clearly any assumptions you have used regarding axisymmetry and monotonicity as part of your derivation.",
            "solution": "The problem statement is first subjected to a rigorous validation procedure.\n\n### Step 1: Extract Givens\n- **Device and Geometry**: Large-aspect-ratio tokamak with major radius $R_{0}$ and minor radius $a$.\n- **Coordinates and Variables**: Minor radius $r \\in [0,a]$, toroidal angle $\\phi$, poloidal flux per radian $\\psi(r)$, safety factor $q(r)$.\n- **Operating Conditions and Approximations**: Steady, axisymmetric operation. Large-aspect-ratio, circular-flux-surface approximation.\n- **Physical Relations**:\n    - Magnetic field: $\\mathbf{B} = \\nabla \\psi \\times \\nabla \\phi + F(\\psi)\\nabla \\phi / R$.\n    - Poloidal magnetic field (approximate): $B_{p}(r) = \\frac{1}{R_{0}}\\frac{d\\psi}{dr}$.\n    - Safety factor (approximate): $q(r) = \\frac{r B_{t}}{R_{0} B_{p}(r)}$.\n    - Toroidal magnetic field $B_{t}$ is treated as radially uniform and strictly positive.\n- **Definitions**:\n    - Normalized poloidal flux radius: $\\rho_{\\text{pol}}(r) = \\sqrt{\\frac{\\psi(r) - \\psi(0)}{\\psi(a) - \\psi(0)}}$.\n    - Normalization convention: $\\psi(0)=0$.\n- **Specific Profile**:\n    - Safety factor: $q(r) = q_{0} + q_{2} \\left(\\frac{r}{a}\\right)^{2}$, with parameters $q_{0} > 0$ and $q_{2} > 0$.\n- **Assumptions for Validation Task**:\n    - Axisymmetry: $\\psi = \\psi(r)$.\n    - Nested circular flux surfaces.\n    - $B_{t}$ is uniform and positive.\n    - $q(r)$ is strictly positive and monotonically increasing.\n- **Objective**: Derive a closed-form expression for $\\rho_{\\text{pol}}(r)$ in terms of $r$, $a$, $q_{0}$, and $q_{2}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria.\n- **Scientifically Grounded**: The problem is based on standard magnetohydrodynamic (MHD) equilibrium theory for tokamaks, specifically the widely used large-aspect-ratio, circular-flux-surface approximation. The definitions of poloidal flux $\\psi$, safety factor $q$, and the normalized coordinate $\\rho_{\\text{pol}}$ are all standard in the field of magnetic confinement fusion. The parabolic model for $q(r)$ is a common and physically reasonable parameterization. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a complete set of definitions and relations to derive the desired quantity. The relationship between $q(r)$ and $\\psi(r)$ can be established through a first-order ordinary differential equation for $\\psi(r)$. With the boundary condition $\\psi(0)=0$, this equation can be integrated to find a unique solution for $\\psi(r)$, and subsequently for $\\rho_{\\text{pol}}(r)$. The problem is well-posed.\n- **Objective**: The problem is stated using precise mathematical and physical language, free of ambiguity or subjective claims.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist. The given constraints $q_0 > 0$ and $q_2 > 0$ are consistent with the assumption that $q(r)$ is positive and monotonically increasing for $r \\in [0, a]$. The setup is self-contained, logically consistent, and scientifically valid.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived.\n\n### Derivation\nThe objective is to find the transformation $\\rho_{\\text{pol}}(r)$. We begin with the provided definitions within the large-aspect-ratio, circular-flux-surface approximation. The safety factor $q(r)$ is given by\n$$q(r) = \\frac{r B_{t}}{R_{0} B_{p}(r)}$$\nand the poloidal magnetic field $B_{p}(r)$ is related to the poloidal flux $\\psi(r)$ by\n$$B_{p}(r) = \\frac{1}{R_{0}}\\frac{d\\psi}{dr}$$\nSubstituting the expression for $B_{p}(r)$ into the definition of $q(r)$ allows us to relate $q(r)$ directly to the derivative of the poloidal flux:\n$$q(r) = \\frac{r B_{t}}{R_{0} \\left(\\frac{1}{R_{0}}\\frac{d\\psi}{dr}\\right)} = \\frac{r B_{t}}{\\frac{d\\psi}{dr}}$$\nThis equation can be rearranged to give a first-order ordinary differential equation for $\\psi(r)$:\n$$\\frac{d\\psi}{dr} = \\frac{r B_{t}}{q(r)}$$\nThe problem specifies the safety factor profile as $q(r) = q_{0} + q_{2} \\left(\\frac{r}{a}\\right)^{2}$. Substituting this form into the differential equation yields:\n$$\\frac{d\\psi}{dr} = \\frac{r B_{t}}{q_{0} + q_{2} \\left(\\frac{r}{a}\\right)^{2}}$$\nTo find $\\psi(r)$, we integrate this expression with respect to the minor radius from the magnetic axis ($r=0$) to an arbitrary radius $r$. Let $r'$ be the integration variable.\n$$\\psi(r) - \\psi(0) = \\int_{0}^{r} \\frac{r' B_{t}}{q_{0} + q_{2} \\left(\\frac{r'}{a}\\right)^{2}} dr'$$\nUsing the given normalization convention $\\psi(0)=0$:\n$$\\psi(r) = B_{t} \\int_{0}^{r} \\frac{r'}{q_{0} + \\frac{q_{2}}{a^{2}}(r')^{2}} dr'$$\nTo solve this integral, we use the method of substitution. Let $u = q_{0} + \\frac{q_{2}}{a^{2}}(r')^{2}$. The differential is $du = \\frac{2q_{2}}{a^{2}}r' dr'$, which implies $r' dr' = \\frac{a^{2}}{2q_{2}} du$. We must also transform the limits of integration:\n- When $r' = 0$, $u = q_{0}$.\n- When $r' = r$, $u = q_{0} + \\frac{q_{2}}{a^{2}}r^{2}$.\nThe integral for $\\psi(r)$ becomes:\n$$\\psi(r) = B_{t} \\int_{q_{0}}^{q_{0} + \\frac{q_{2}}{a^{2}}r^{2}} \\frac{1}{u} \\left(\\frac{a^{2}}{2q_{2}} du\\right) = \\frac{B_{t} a^{2}}{2q_{2}} \\int_{q_{0}}^{q_{0} + \\frac{q_{2}}{a^{2}}r^{2}} \\frac{1}{u} du$$\nThis is the integral of $1/u$, which is the natural logarithm:\n$$\\psi(r) = \\frac{B_{t} a^{2}}{2q_{2}} \\left[ \\ln(u) \\right]_{q_{0}}^{q_{0} + \\frac{q_{2}}{a^{2}}r^{2}}$$\nThe conditions $q_{0}>0$ and $q_{2}>0$ ensure the argument of the logarithm is always positive, so the absolute value is not needed.\n$$\\psi(r) = \\frac{B_{t} a^{2}}{2q_{2}} \\left( \\ln\\left(q_{0} + \\frac{q_{2}}{a^{2}}r^{2}\\right) - \\ln(q_{0}) \\right)$$\nUsing the logarithmic identity $\\ln(A) - \\ln(B) = \\ln(A/B)$, we simplify the expression:\n$$\\psi(r) = \\frac{B_{t} a^{2}}{2q_{2}} \\ln\\left(\\frac{q_{0} + \\frac{q_{2}}{a^{2}}r^{2}}{q_{0}}\\right) = \\frac{B_{t} a^{2}}{2q_{2}} \\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\left(\\frac{r}{a}\\right)^{2}\\right)$$\nThis expression for $\\psi(r)$ allows for the self-consistent determination of the normalization factor $\\psi(a)$, which corresponds to the total poloidal flux inside the last closed flux surface at $r=a$:\n$$\\psi(a) = \\frac{B_{t} a^{2}}{2q_{2}} \\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\left(\\frac{a}{a}\\right)^{2}\\right) = \\frac{B_{t} a^{2}}{2q_{2}} \\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\right)$$\nNow we can construct the normalized poloidal flux radius $\\rho_{\\text{pol}}(r)$ using its definition:\n$$\\rho_{\\text{pol}}(r) = \\sqrt{\\frac{\\psi(r) - \\psi(0)}{\\psi(a) - \\psi(0)}}$$\nWith $\\psi(0)=0$:\n$$\\rho_{\\text{pol}}(r) = \\sqrt{\\frac{\\psi(r)}{\\psi(a)}} = \\sqrt{\\frac{\\frac{B_{t} a^{2}}{2q_{2}} \\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\left(\\frac{r}{a}\\right)^{2}\\right)}{\\frac{B_{t} a^{2}}{2q_{2}} \\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\right)}}$$\nThe constant pre-factor $\\frac{B_{t} a^{2}}{2q_{2}}$ cancels, yielding the final expression for $\\rho_{\\text{pol}}(r)$ in terms of the given parameters:\n$$\\rho_{\\text{pol}}(r) = \\sqrt{\\frac{\\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\left(\\frac{r}{a}\\right)^{2}\\right)}{\\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\right)}}$$\nThis derivation relies on the validity of the large-aspect-ratio, circular-flux-surface approximation as specified in the problem, and the assumption of axisymmetry, which allows $\\psi$ to be treated as a function of $r$ alone. The result is dimensionless and depends only on the shape parameters of the safety factor profile ($q_{0}$, $q_{2}$) and the geometry ($r$, $a$), as expected.",
            "answer": "$$\\boxed{\\sqrt{\\frac{\\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\left(\\frac{r}{a}\\right)^{2}\\right)}{\\ln\\left(1 + \\frac{q_{2}}{q_{0}}\\right)}}}$$"
        },
        {
            "introduction": "A meaningful validation requires not just comparing model predictions to data, but also correctly quantifying the disagreement in the context of measurement uncertainty. This exercise  delves into the critical topic of error analysis, guiding you to construct a full covariance matrix that captures correlations from shared systematic errors. By comparing a naive $\\chi^2$ statistic with a correct one, you will see firsthand how ignoring these correlations can drastically alter validation conclusions.",
            "id": "4032708",
            "problem": "A fusion device profile database is used to validate a core transport model by comparing stored electron temperature profiles against model predictions. Consider a single discharge entry in the database in which electron temperature, denoted by $x(r)$, is measured at $N=3$ normalized flux radii $r_1$, $r_2$, and $r_3$. The measurements suffer from two discharge-wide systematic calibration errors: a multiplicative absolute calibration factor error and an additive background offset error, in addition to pointwise statistical noise. Assume the following stochastic measurement model for each profile point:\n- The measurement at $r_i$ satisfies $x(r_i) = (1 + k)\\,x_{\\mathrm{true}}(r_i) + b + \\epsilon_i$, where $k$ is a zero-mean multiplicative calibration error, $b$ is a zero-mean additive offset error, and $\\epsilon_i$ is a zero-mean statistical noise term.\n- The variables $k$, $b$, and the vector $\\boldsymbol{\\epsilon} = (\\epsilon_1,\\epsilon_2,\\epsilon_3)^{\\mathsf{T}}$ are mutually independent, with $k \\sim \\mathcal{N}(0,\\sigma_k^2)$, $b \\sim \\mathcal{N}(0,\\sigma_b^2)$, and $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma_i^2)$.\n- You may assume the small-error regime and linearize about the model prediction so that wherever $x_{\\mathrm{true}}(r_i)$ appears in a variance or covariance, you may substitute $x_{\\mathrm{model}}(r_i)$.\n\nThe database entry provides the following for this discharge:\n- The model predictions at the three radii are $x_{\\mathrm{model}}(r_1) = 2.0$, $x_{\\mathrm{model}}(r_2) = 1.5$, $x_{\\mathrm{model}}(r_3) = 1.0$ (in $\\mathrm{keV}$).\n- The corresponding measurements are $x(r_1) = 2.1$, $x(r_2) = 1.6$, $x(r_3) = 0.9$ (in $\\mathrm{keV}$).\n- The pointwise statistical standard deviations are $\\sigma_1 = 0.1$, $\\sigma_2 = 0.1$, $\\sigma_3 = 0.1$ (in $\\mathrm{keV}$).\n- The calibration metadata reports a fractional absolute calibration uncertainty $\\sigma_k = 0.05$ and an additive background uncertainty $\\sigma_b = 0.05$ (in $\\mathrm{keV}$).\n\nTasks:\n1) Starting from the definition of covariance and the properties of independent zero-mean Gaussian variables together with linearization in the small-error regime, derive the covariance structure $C_{ij} = \\mathrm{Cov}\\!\\left[x(r_i), x(r_j)\\right]$ in terms of $\\delta_{ij}$, $\\sigma_i$, $\\sigma_k$, $\\sigma_b$, and $x_{\\mathrm{model}}(r_i)$.\n2) Using the derived covariance, construct the full covariance matrix $\\mathbf{C}$ for this discharge and compute the quadratic form associated with the chi-square statistic $\\chi^2 = \\boldsymbol{d}^{\\mathsf{T}} \\mathbf{C}^{-1} \\boldsymbol{d}$, where the residual vector is $\\boldsymbol{d} = \\big(x(r_1)-x_{\\mathrm{model}}(r_1),\\,x(r_2)-x_{\\mathrm{model}}(r_2),\\,x(r_3)-x_{\\mathrm{model}}(r_3)\\big)^{\\mathsf{T}}$.\n3) For comparison, compute the naive uncorrelated chi-square $\\chi^2_{\\mathrm{naive}}$ that ignores shared calibration errors by treating the uncertainties as uncorrelated with variance $\\sigma_i^2$ only.\n4) Define the overestimation factor $R = \\chi^2_{\\mathrm{naive}} / \\chi^2$ that quantifies the impact of shared systematics on chi-square-based validation decisions. Provide $R$ as your final answer in exact form as a reduced fraction. No units are required. Do not round.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard problem in statistical data analysis and model validation, common in experimental physics and engineering disciplines. All necessary data and definitions are provided to arrive at a unique, meaningful solution.\n\nThe solution proceeds by addressing the four tasks in sequence.\n\nTask 1: Derivation of the covariance structure $C_{ij}$.\n\nThe measurement at a normalized flux radius $r_i$ is given by the stochastic model:\n$$x(r_i) = (1 + k)\\,x_{\\mathrm{true}}(r_i) + b + \\epsilon_i$$\nHere, $k$, $b$, and $\\epsilon_i$ are independent, zero-mean Gaussian random variables with variances $\\sigma_k^2$, $\\sigma_b^2$, and $\\sigma_i^2$, respectively. Let's denote $x_i = x(r_i)$ and $x_{i, \\mathrm{true}} = x_{\\mathrm{true}}(r_i)$.\n\nThe covariance between two measurements $x_i$ and $x_j$ is defined as $C_{ij} = \\mathrm{Cov}(x_i, x_j) = E[(x_i - E[x_i])(x_j - E[x_j])]$. First, we find the expectation value of $x_i$:\n$$E[x_i] = E[(1 + k)x_{i, \\mathrm{true}} + b + \\epsilon_i] = E[x_{i, \\mathrm{true}} + k x_{i, \\mathrm{true}} + b + \\epsilon_i]$$\nUsing the linearity of expectation and the fact that $E[k] = 0$, $E[b] = 0$, and $E[\\epsilon_i] = 0$:\n$$E[x_i] = x_{i, \\mathrm{true}} + E[k]x_{i, \\mathrm{true}} + E[b] + E[\\epsilon_i] = x_{i, \\mathrm{true}}$$\nThe deviation of a measurement from its expected (true) value is:\n$$x_i - E[x_i] = x_i - x_{i, \\mathrm{true}} = k x_{i, \\mathrm{true}} + b + \\epsilon_i$$\nNow we compute the covariance:\n$$C_{ij} = E[(x_i - x_{i, \\mathrm{true}})(x_j - x_{j, \\mathrm{true}})] = E[(k x_{i, \\mathrm{true}} + b + \\epsilon_i)(k x_{j, \\mathrm{true}} + b + \\epsilon_j)]$$\nExpanding the product:\n$$C_{ij} = E[k^2 x_{i, \\mathrm{true}} x_{j, \\mathrm{true}} + k b (x_{i, \\mathrm{true}} + x_{j, \\mathrm{true}}) + b^2 + k(x_{i, \\mathrm{true}}\\epsilon_j + x_{j, \\mathrm{true}}\\epsilon_i) + b(\\epsilon_i + \\epsilon_j) + \\epsilon_i \\epsilon_j]$$\nDue to the mutual independence and zero-mean property of $k$, $b$, and $\\epsilon_i$, the expectation of any cross-term is zero (e.g., $E[kb] = E[k]E[b]=0$). The only non-zero expectations are for the squared terms: $E[k^2] = \\sigma_k^2$, $E[b^2] = \\sigma_b^2$, and $E[\\epsilon_i \\epsilon_j]$. The statistical noise terms $\\epsilon_i$ are independent for different points, so $E[\\epsilon_i \\epsilon_j] = 0$ for $i \\neq j$, and $E[\\epsilon_i^2] = \\sigma_i^2$. This can be written compactly using the Kronecker delta, $\\delta_{ij}$, as $E[\\epsilon_i \\epsilon_j] = \\sigma_i^2 \\delta_{ij}$.\n\nSubstituting these into the expanded expression for $C_{ij}$:\n$$C_{ij} = \\sigma_k^2 x_{i, \\mathrm{true}} x_{j, \\mathrm{true}} + \\sigma_b^2 + \\sigma_i^2 \\delta_{ij}$$\nThe problem permits linearization in the small-error regime, allowing the substitution of the true values $x_{i, \\mathrm{true}}$ with the model predictions $x_{\\mathrm{model}}(r_i)$, which we denote as $x_{i, \\mathrm{model}}$. Thus, the final expression for the covariance structure is:\n$$C_{ij} = \\sigma_k^2 x_{i, \\mathrm{model}} x_{j, \\mathrm{model}} + \\sigma_b^2 + \\sigma_i^2 \\delta_{ij}$$\n\nTask 2: Construction of the covariance matrix $\\mathbf{C}$ and computation of $\\chi^2$.\n\nWe are given the following numerical values:\n- Model predictions: $\\mathbf{x}_{\\mathrm{model}} = (x_{1, \\mathrm{model}}, x_{2, \\mathrm{model}}, x_{3, \\mathrm{model}})^{\\mathsf{T}} = (2.0, 1.5, 1.0)^{\\mathsf{T}}$.\n- Measurements: $\\mathbf{x} = (x_1, x_2, x_3)^{\\mathsf{T}} = (2.1, 1.6, 0.9)^{\\mathsf{T}}$.\n- Statistical standard deviations: $\\sigma_1 = \\sigma_2 = \\sigma_3 = 0.1$, so $\\sigma_i^2 = 0.01$ for all $i$.\n- Calibration uncertainties: $\\sigma_k = 0.05$ (so $\\sigma_k^2 = 0.0025$) and $\\sigma_b = 0.05$ (so $\\sigma_b^2 = 0.0025$).\n\nThe residual vector is $\\mathbf{d} = \\mathbf{x} - \\mathbf{x}_{\\mathrm{model}} = (0.1, 0.1, -0.1)^{\\mathsf{T}}$.\n\nWe compute the elements of the $3 \\times 3$ covariance matrix $\\mathbf{C}$:\n$C_{11} = (0.05)^2 (2.0)^2 + (0.05)^2 + (0.1)^2 = 0.0025 \\cdot 4 + 0.0025 + 0.01 = 0.01 + 0.0025 + 0.01 = 0.0225$.\n$C_{22} = (0.05)^2 (1.5)^2 + (0.05)^2 + (0.1)^2 = 0.0025 \\cdot 2.25 + 0.0025 + 0.01 = 0.005625 + 0.0025 + 0.01 = 0.018125$.\n$C_{33} = (0.05)^2 (1.0)^2 + (0.05)^2 + (0.1)^2 = 0.0025 \\cdot 1 + 0.0025 + 0.01 = 0.005 + 0.01 = 0.015$.\n$C_{12} = C_{21} = (0.05)^2 (2.0)(1.5) + (0.05)^2 = 0.0025 \\cdot 3 + 0.0025 = 0.01$.\n$C_{13} = C_{31} = (0.05)^2 (2.0)(1.0) + (0.05)^2 = 0.0025 \\cdot 2 + 0.0025 = 0.0075$.\n$C_{23} = C_{32} = (0.05)^2 (1.5)(1.0) + (0.05)^2 = 0.0025 \\cdot 1.5 + 0.0025 = 0.00625$.\n\nThe full covariance matrix $\\mathbf{C}$ is:\n$$ \\mathbf{C} = \\begin{pmatrix} 0.0225 & 0.01 & 0.0075 \\\\ 0.01 & 0.018125 & 0.00625 \\\\ 0.0075 & 0.00625 & 0.015 \\end{pmatrix} $$\nTo compute $\\chi^2 = \\mathbf{d}^{\\mathsf{T}} \\mathbf{C}^{-1} \\mathbf{d}$, we first find the inverse of $\\mathbf{C}$. It is computationally advantageous to work with fractions.\n$\\sigma_k^2 = (\\frac{1}{20})^2=\\frac{1}{400}$, $\\sigma_b^2 = \\frac{1}{400}$, $\\sigma_i^2 = (\\frac{1}{10})^2=\\frac{1}{100}$. $x_{1, \\mathrm{model}}=2, x_{2, \\mathrm{model}}=\\frac{3}{2}, x_{3, \\mathrm{model}}=1$.\n$C_{11} = \\frac{4}{400}+\\frac{1}{400}+\\frac{4}{400}=\\frac{9}{400}$. $C_{22} = \\frac{9/4}{400}+\\frac{1}{400}+\\frac{4}{400}=\\frac{9}{1600}+\\frac{4}{1600}+\\frac{16}{1600}=\\frac{29}{1600}$. $C_{33} = \\frac{1}{400}+\\frac{1}{400}+\\frac{4}{400}=\\frac{6}{400}$.\n$C_{12} = \\frac{3}{400}+\\frac{1}{400}=\\frac{4}{400}$. $C_{13} = \\frac{2}{400}+\\frac{1}{400}=\\frac{3}{400}$. $C_{23} = \\frac{3/2}{400}+\\frac{1}{400}=\\frac{5}{800}$.\n$$ \\mathbf{C} = \\frac{1}{1600} \\begin{pmatrix} 36 & 16 & 12 \\\\ 16 & 29 & 10 \\\\ 12 & 10 & 24 \\end{pmatrix} $$\nLet $\\mathbf{M}$ be the inner matrix. The determinant of $\\mathbf{M}$ is $\\det(\\mathbf{M}) = 14976$. The inverse matrix is $\\mathbf{C}^{-1} = 1600 \\cdot \\mathbf{M}^{-1} = 1600 \\frac{\\mathrm{adj}(\\mathbf{M})}{\\det(\\mathbf{M})}$.\n$$ \\mathrm{adj}(\\mathbf{M}) = \\begin{pmatrix} 596 & -264 & -188 \\\\ -264 & 720 & -168 \\\\ -188 & -168 & 788 \\end{pmatrix} $$\n$$ \\mathbf{C}^{-1} = \\frac{1600}{14976} \\mathrm{adj}(\\mathbf{M}) = \\frac{25}{234} \\mathrm{adj}(\\mathbf{M}) $$\nThe chi-square statistic is $\\chi^2 = \\mathbf{d}^{\\mathsf{T}} \\mathbf{C}^{-1} \\mathbf{d}$:\n$$ \\chi^2 = (0.1, 0.1, -0.1) \\frac{25}{234} \\begin{pmatrix} 596 & -264 & -188 \\\\ -264 & 720 & -168 \\\\ -188 & -168 & 788 \\end{pmatrix} \\begin{pmatrix} 0.1 \\\\ 0.1 \\\\ -0.1 \\end{pmatrix} $$\n$$ \\chi^2 = \\frac{0.01 \\times 25}{234} (1, 1, -1) \\begin{pmatrix} 596 & -264 & -188 \\\\ -264 & 720 & -168 \\\\ -188 & -168 & 788 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} $$\nThe quadratic form evaluates to:\n$$ (1, 1, -1) \\begin{pmatrix} 596-264+188 \\\\ -264+720+168 \\\\ -188-168-788 \\end{pmatrix} = (1, 1, -1) \\begin{pmatrix} 520 \\\\ 624 \\\\ -1144 \\end{pmatrix} = 520+624+1144 = 2288 $$\n$$ \\chi^2 = \\frac{0.25}{234} \\times 2288 = \\frac{1}{4} \\frac{2288}{234} = \\frac{572}{234} = \\frac{286}{117} = \\frac{22 \\times 13}{9 \\times 13} = \\frac{22}{9} $$\n\nTask 3: Computation of the naive uncorrelated chi-square $\\chi^2_{\\mathrm{naive}}$.\n\nThis calculation ignores the shared systematic errors, treating the measurements as independent. The covariance matrix becomes diagonal, with entries being only the statistical variances $\\sigma_i^2$.\n$$ \\mathbf{C}_{\\mathrm{naive}} = \\mathrm{diag}(\\sigma_1^2, \\sigma_2^2, \\sigma_3^2) = \\mathrm{diag}(0.01, 0.01, 0.01) $$\nThe chi-square is calculated as:\n$$ \\chi^2_{\\mathrm{naive}} = \\sum_{i=1}^3 \\frac{(x_i - x_{i, \\mathrm{model}})^2}{\\sigma_i^2} = \\frac{d_1^2}{\\sigma_1^2} + \\frac{d_2^2}{\\sigma_2^2} + \\frac{d_3^2}{\\sigma_3^2} $$\n$$ \\chi^2_{\\mathrm{naive}} = \\frac{(0.1)^2}{(0.1)^2} + \\frac{(0.1)^2}{(0.1)^2} + \\frac{(-0.1)^2}{(0.1)^2} = 1 + 1 + 1 = 3 $$\n\nTask 4: Computation of the overestimation factor $R$.\n\nThe factor $R$ quantifies the ratio of the naive chi-square to the correct one.\n$$ R = \\frac{\\chi^2_{\\mathrm{naive}}}{\\chi^2} = \\frac{3}{22/9} = 3 \\times \\frac{9}{22} = \\frac{27}{22} $$\nThe naive calculation overestimates the statistical significance of the model-data mismatch by ignoring the positive correlations induced by shared systematic errors.",
            "answer": "$$\\boxed{\\frac{27}{22}}$$"
        },
        {
            "introduction": "The true power of a profile database lies in its ability to reveal trends that transcend a single experiment. This practice  involves a multi-device statistical analysis to derive an empirical scaling law for a key plasma parameter. You will also learn to decompose data variability into within-device and between-device components, a sophisticated technique for setting realistic validation targets when applying models to new or different machines.",
            "id": "4032768",
            "problem": "A computational fusion science and engineering validation study aims to quantify how the pedestal electron temperature height scales with the toroidal magnetic field and the external heating power, using a multi-device profile database. The goal is to derive a cross-device scaling relation that is both scientifically grounded and testable, and then use it to adjust validation expectations for target devices by accounting for between-device variability.\n\nStarting point and scientific basis: The pedestal energy balance is governed by conservation of energy and transport. The externally injected heating power is balanced by cross-field heat transport out of the pedestal region. By dimensional reasoning and well-tested empirical observations in fusion experiments, the pedestal electron temperature $T_{e,\\text{ped}}$ often exhibits a power-law dependence on the toroidal magnetic field $B_T$ and on the total heating power $P_{\\text{heat}}$. This motivates the model\n$$\nT_{e,\\text{ped}} \\propto B_T^{a}\\, P_{\\text{heat}}^{b},\n$$\nwith exponents $a$ and $b$ to be inferred. A log-transformation yields a linear relation,\n$$\n\\ln T_{e,\\text{ped}} = \\ln C + a \\ln B_T + b \\ln P_{\\text{heat}},\n$$\nwhere $C$ is a constant prefactor. Across devices, systematic offsets may exist due to geometry, wall conditions, or operational specifics. These can be represented statistically as device-level random effects that broaden expectations across devices, compared to within-device variability.\n\nDatabase: Use the following multi-device dataset of pedestal electron temperature heights. Each tuple is $(B_T, P_{\\text{heat}}, T_{e,\\text{ped}})$ with $B_T$ in Tesla, $P_{\\text{heat}}$ in megawatts, and $T_{e,\\text{ped}}$ in electron-volts. Devices are labeled $\\text{D1}$, $\\text{D2}$, $\\text{D3}$, $\\text{D4}$.\n\nDevice $\\text{D1}$:\n- $(\\,$ $2.0$, $5.0$, $410.0$ $\\,)$\n- $(\\,$ $2.5$, $8.0$, $535.0$ $\\,)$\n- $(\\,$ $2.5$, $10.0$, $561.0$ $\\,)$\n- $(\\,$ $3.0$, $5.0$, $493.0$ $\\,)$\n- $(\\,$ $3.0$, $8.0$, $597.0$ $\\,)$\n- $(\\,$ $3.5$, $10.0$, $672.0$ $\\,)$\n\nDevice $\\text{D2}$:\n- $(\\,$ $2.0$, $6.0$, $373.0$ $\\,)$\n- $(\\,$ $2.5$, $4.0$, $354.0$ $\\,)$\n- $(\\,$ $3.0$, $12.0$, $559.0$ $\\,)$\n- $(\\,$ $3.0$, $8.0$, $500.0$ $\\,)$\n- $(\\,$ $3.5$, $6.0$, $498.0$ $\\,)$\n- $(\\,$ $4.0$, $10.0$, $612.0$ $\\,)$\n\nDevice $\\text{D3}$:\n- $(\\,$ $1.5$, $5.0$, $329.0$ $\\,)$\n- $(\\,$ $2.0$, $8.0$, $435.0$ $\\,)$\n- $(\\,$ $3.0$, $10.0$, $581.0$ $\\,)$\n- $(\\,$ $3.5$, $12.0$, $676.0$ $\\,)$\n- $(\\,$ $4.0$, $5.0$, $511.0$ $\\,)$\n- $(\\,$ $5.0$, $8.0$, $708.0$ $\\,)$\n\nDevice $\\text{D4}$:\n- $(\\,$ $2.0$, $3.0$, $271.0$ $\\,)$\n- $(\\,$ $2.5$, $6.0$, $394.0$ $\\,)$\n- $(\\,$ $3.0$, $4.0$, $372.0$ $\\,)$\n- $(\\,$ $3.5$, $8.0$, $501.0$ $\\,)$\n- $(\\,$ $4.0$, $6.0$, $499.0$ $\\,)$\n- $(\\,$ $5.0$, $10.0$, $660.0$ $\\,)$\n\nTasks:\n1. Infer the scaling exponents $a$ and $b$ and the prefactor $C$ by minimizing the sum of squared errors in the log-transformed space for the model $\\ln T_{e,\\text{ped}} = \\ln C + a \\ln B_T + b \\ln P_{\\text{heat}}$ over the entire database.\n2. Compute residuals $r_i = \\ln T_{e,\\text{ped},i} - (\\ln C + a \\ln B_{T,i} + b \\ln P_{\\text{heat},i})$ and decompose variability into a between-device component and a within-device component. Let $m_d$ be the mean residual for device $d$, and let $w_i = r_i - m_{d(i)}$ be the within-device residual for datum $i$. Estimate the within-device variance $\\sigma_e^2$ from $\\{w_i\\}$ and the between-device variance $\\sigma_d^2$ from $\\{m_d\\}$, accounting for the finite-sample correction due to $\\sigma_e^2 / n_d$, where $n_d$ is the number of data points for device $d$. Use $D = 4$ devices and the total number of data points $N = 24$.\n3. For validation across devices, define an adjusted confidence interval for a predicted $\\ln T_{e,\\text{ped}}$ at confidence level $0.95$ as follows:\n   - For a new device not present in the database, use the total standard deviation $\\sqrt{\\sigma_d^2 + \\sigma_e^2}$.\n   - For an existing device present in the database, use only the within-device standard deviation $\\sqrt{\\sigma_e^2}$.\n   Let $z$ be the two-sided quantile such that the coverage is $0.95$ for a standard normal distribution, and form the interval in log-space as $[\\hat{y} - z s, \\hat{y} + z s]$. Map it back to electron-volts via the exponential function to obtain $[T_{\\text{low}}, T_{\\text{high}}]$.\n4. Apply the scaling to the test suite below and evaluate whether the measured pedestal electron temperature is consistent with the adjusted expectation for each case. For each case, compute the predicted pedestal electron temperature $T_{e,\\text{pred}}$ in electron-volts and, when a measured value is provided, a boolean indicating whether the measured value falls within the adjusted confidence interval.\n\nTest suite:\n- Case $1$ (new device): $B_T = 2.5$ (Tesla), $P_{\\text{heat}} = 10.0$ (megawatts), measured $T_{e,\\text{ped}} = 560.0$ (electron-volts).\n- Case $2$ (new device, boundary): $B_T = 1.5$ (Tesla), $P_{\\text{heat}} = 3.0$ (megawatts), measured $T_{e,\\text{ped}} = 210.0$ (electron-volts).\n- Case $3$ (new device, edge): $B_T = 5.0$ (Tesla), $P_{\\text{heat}} = 8.0$ (megawatts), measured $T_{e,\\text{ped}} = 750.0$ (electron-volts).\n- Case $4$ (existing device $\\text{D2}$): $B_T = 3.0$ (Tesla), $P_{\\text{heat}} = 12.0$ (megawatts), measured $T_{e,\\text{ped}} = 520.0$ (electron-volts).\n- Case $5$ (prediction only): $B_T = 2.0$ (Tesla), $P_{\\text{heat}} = 5.0$ (megawatts), no measured value; report only $T_{e,\\text{pred}}$.\n\nAnswer specification:\n- Physical units: Express all pedestal electron temperatures in electron-volts.\n- Confidence level: Use $0.95$ with its corresponding two-sided normal quantile $z$.\n- Output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be $[b_1,b_2,b_3,b_4,t_5]$ where $b_k$ are booleans for Cases $1$ to $4$ (true if the measured value is within the adjusted interval, false otherwise), and $t_5$ is the predicted pedestal electron temperature for Case $5$ as a float rounded to one decimal place. For example, a valid output would look like $[\\,\\text{True},\\text{False},\\text{True},\\text{False},362.0\\,]$.",
            "solution": "The objective is to construct a physically motivated, statistically calibrated, and algorithmically implementable cross-device scaling for the pedestal electron temperature height as a function of toroidal magnetic field and total heating power, using a multi-device profile database, and then use it to adjust validation expectations across devices.\n\nPrincipled derivation:\n\n1. Physical foundation and scaling form. In the pedestal region, conservation of energy requires that the external heating power deposited in the plasma is balanced by transport losses. The cross-field heat flux $q$ at the pedestal is determined by transport coefficients that depend on magnetic field strength and thermodynamic gradients. For a wide class of microinstability-limited transport regimes, dimensionless analysis and empirical observation support a power-law relation between the electron temperature height and control parameters such as $B_T$ and $P_{\\text{heat}}$. This leads to the hypothesis\n$$\nT_{e,\\text{ped}} \\propto B_T^{a} P_{\\text{heat}}^{b},\n$$\nwith unknown exponents $a$ and $b$ to be estimated from data. This model is universal enough to be testable across devices while grounded in the physics that stronger magnetic fields and increased heating tend to raise the temperature.\n\n2. Linearization and estimation. To estimate the parameters, apply the logarithm to both sides to obtain\n$$\n\\ln T_{e,\\text{ped}} = \\ln C + a \\ln B_T + b \\ln P_{\\text{heat}},\n$$\nwhere $C$ is a prefactor to be determined. This is a linear model in the variables $\\ln B_T$ and $\\ln P_{\\text{heat}}$. Define $y_i = \\ln T_{e,\\text{ped},i}$, $x_{1,i} = \\ln B_{T,i}$, and $x_{2,i} = \\ln P_{\\text{heat},i}$. Stack the data into a design matrix\n$$\nX = \\begin{bmatrix}\n1 & x_{1,1} & x_{2,1} \\\\\n\\vdots & \\vdots & \\vdots \\\\\n1 & x_{1,N} & x_{2,N}\n\\end{bmatrix}, \\quad y = \\begin{bmatrix} y_1 \\\\ \\vdots \\\\ y_N \\end{bmatrix}.\n$$\nEstimate $\\beta = [\\ln C, a, b]^T$ by minimizing the sum of squared residuals $\\sum_{i=1}^{N} (y_i - X_i \\beta)^2$, where $X_i$ is the $i$-th row of $X$. The least-squares solution is\n$$\n\\hat{\\beta} = (X^T X)^{-1} X^T y,\n$$\nyielding $\\widehat{\\ln C}$, $\\hat{a}$, and $\\hat{b}$. The predicted log-temperature for a new $(B_T,P_{\\text{heat}})$ pair is\n$$\n\\hat{y} = \\widehat{\\ln C} + \\hat{a} \\ln B_T + \\hat{b} \\ln P_{\\text{heat}}, \\quad T_{e,\\text{pred}} = \\exp(\\hat{y}).\n$$\n\n3. Variability decomposition across devices. Because the database spans multiple devices, systematic device-level offsets can arise. Let $r_i = y_i - X_i \\hat{\\beta}$ be residuals. For each device $d$ with index set $I_d$ and sample count $n_d$, define the device mean residual\n$$\nm_d = \\frac{1}{n_d} \\sum_{i \\in I_d} r_i,\n$$\nand the within-device residuals\n$$\nw_i = r_i - m_{d(i)},\n$$\nwhere $d(i)$ denotes the device for datum $i$. The within-device variance can be estimated by the unbiased estimator\n$$\n\\hat{\\sigma}_e^2 = \\frac{1}{N - D} \\sum_{d=1}^{D} \\sum_{i \\in I_d} w_i^2,\n$$\nwhere $D$ is the number of devices. The variation of the device means $\\{m_d\\}$ estimates the between-device variance, but each $m_d$ contains a contribution from the within-device noise $\\sigma_e^2$ scaled by $n_d^{-1}$. A corrected estimator can be obtained by subtracting the average within-device contribution:\n$$\n\\operatorname{Var}_{\\text{unb}}(m_d) = \\frac{1}{D - 1} \\sum_{d=1}^{D} \\left(m_d - \\overline{m}\\right)^2, \\quad \\overline{m} = \\frac{1}{D} \\sum_{d=1}^{D} m_d,\n$$\n$$\n\\hat{\\sigma}_d^2 = \\max\\left(0,\\ \\operatorname{Var}_{\\text{unb}}(m_d) - \\frac{1}{D} \\sum_{d=1}^{D} \\frac{\\hat{\\sigma}_e^2}{n_d} \\right).\n$$\nThe maximum with $0$ ensures a nonnegative variance estimate.\n\n4. Adjusted validation expectations. For cross-device validation at confidence level $0.95$, use a normal approximation in log-space. Let $z$ be the two-sided quantile such that the coverage of the interval $[-z,z]$ is $0.95$ for a standard normal random variable. Then define the standard deviation used in prediction as\n$$\ns_{\\text{new}} = \\sqrt{\\hat{\\sigma}_d^2 + \\hat{\\sigma}_e^2} \\quad \\text{for a new device},\n$$\n$$\ns_{\\text{existing}} = \\sqrt{\\hat{\\sigma}_e^2} \\quad \\text{for an existing device present in the database}.\n$$\nThe adjusted confidence interval in log-space is $[\\hat{y} - z s, \\hat{y} + z s]$ with $s$ chosen appropriately, and the interval in electron-volts is $[T_{\\text{low}}, T_{\\text{high}}] = [\\exp(\\hat{y} - z s), \\exp(\\hat{y} + z s)]$. A measured pedestal electron temperature $T_{e,\\text{meas}}$ is considered consistent if $T_{\\text{low}} \\le T_{e,\\text{meas}} \\le T_{\\text{high}}$.\n\nAlgorithmic implementation details:\n- Construct the database vectors $B_T$, $P_{\\text{heat}}$, $T_{e,\\text{ped}}$, and device labels.\n- Build $X$ and $y$ in log-space and solve for $\\hat{\\beta}$ using least squares.\n- Compute residuals $r_i$, group by device to compute $m_d$, $w_i$, and then $\\hat{\\sigma}_e^2$ and $\\hat{\\sigma}_d^2$ using the formulas above.\n- For each test case, compute $\\hat{y}$, select $s$ based on whether the device is new or existing, form the interval bounds $T_{\\text{low}}$ and $T_{\\text{high}}$, and compare to the measured $T_{e,\\text{meas}}$ when provided. Also compute $T_{e,\\text{pred}} = \\exp(\\hat{y})$.\n- Report booleans for Cases $1$ through $4$ and the predicted pedestal electron temperature for Case $5$ rounded to one decimal place, in a single-line list format as specified, with all temperatures in electron-volts.\n\nScientific realism: The database values span plausible pedestal electron temperatures in electron-volts across a range of toroidal magnetic fields in Tesla and heating powers in megawatts. The regression and variance decomposition are standard and well-tested for empirical scaling analysis in fusion profile databases, and the adjusted expectations are grounded in device-level variability modeling. The confidence level is specified as a decimal probability $0.95$, avoiding percent notation.\n\nThis principled approach integrates physics-motivated scaling, statistical estimation in log-space, and a validation framework that adapts expectations across devices by explicitly accounting for between-device and within-device variability.",
            "answer": "[True,False,False,True,401.4]"
        }
    ]
}