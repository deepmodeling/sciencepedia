{
    "hands_on_practices": [
        {
            "introduction": "创建数字孪生的第一步是为物理系统建立一个数学模型。本练习将引导你将托卡马克等离子体垂直位置的基本物理定律，转化为适用于现代控制和实时模拟的状态空间表示形式。通过这个过程 ，你将掌握如何将等离子体动力学、执行器和传感器模型整合为一个统一的离散时间系统，为后续的控制设计和状态估计奠定基础。",
            "id": "3965909",
            "problem": "将要部署一个托卡马克（tokamak）垂直位置控制环路的数字孪生（Digital Twin, DT），用于实时状态预测和估计。该DT必须使用一个离散时间模型，该模型通过在标称工作点附近对连续时间物理模型进行线性化，然后在零阶保持器（Zero-Order Hold, ZOH）假设下进行离散化而获得。连续时间物理原理如下。\n\n等离子体柱的垂直位置被建模为一个由Newton第二定律控制的刚体自由度。设垂直位移为$z$，有效惯性参数为$m$，黏性阻尼系数为$c$，无源垂直恢复刚度为$k$。净垂直力包含一个通过常数$\\alpha$与线圈电流$i$成正比的分量，因此垂直运动方程为\n$$\nm\\,\\ddot{z} + c\\,\\dot{z} + k\\,z = \\alpha\\,i.\n$$\n垂直控制执行器是一个等效的垂直场线圈，由一个增益为$K_{a}$的电源驱动，其线圈参数电感$L$和电阻$R$由Kirchhoff电压定律所隐含的电路方程描述，\n$$\nL\\,\\dot{i} + R\\,i = K_{a}\\,u,\n$$\n其中$u$是指令控制输入。垂直位置测量中的一个一阶抗混叠滤波器提供测量输出$y$，其时间常数为$\\tau_{s}$，根据\n$$\n\\tau_{s}\\,\\dot{y} + y = z.\n$$\n\n考虑工作点$(z_{0}, \\dot{z}_{0}, i_{0}, y_{0}, u_{0}) = (0, 0, 0, 0, 0)$。定义状态向量\n$$\nx = \\begin{pmatrix} z \\\\ \\dot{z} \\\\ i \\\\ y \\end{pmatrix},\n$$\n并假设模型参数$m, c, k, \\alpha, L, R, K_{a}, \\tau_{s}$均为严格正值且不随时间变化。该数字孪生采用一个离散时间模型，采样周期为$T_{s}$，并在输入$u$上采用零阶保持器（ZOH）。\n\n任务：\n1. 从上述控制定律和工作点出发，进行第一性原理线性化，以获得连续时间线性时不变（LTI）状态空间模型$\\dot{x} = A_{c}\\,x + B_{c}\\,u$, $y = C_{c}\\,x$，并用物理参数表示。\n2. 从此模型出发，推导在ZOH和采样周期$T_{s}$下的精确离散时间状态空间模型，即$x_{k+1} = A_{d}\\,x_{k} + B_{d}\\,u_{k}$, $y_{k} = C_{d}\\,x_{k}$，其中$A_{d}$、$B_{d}$和$C_{d}$是通过精确采样从$A_{c}$、$B_{c}$和$C_{c}$获得的。\n3. 使用你的离散时间模型，确定离散时间状态转移矩阵行列式$\\det(A_{d})$的闭式解析表达式，仅用$m$、$c$、$L$、$R$、$\\tau_{s}$和$T_{s}$表示。你的最终答案必须是单一的闭式表达式。不要四舍五入。最终答案不报告单位。\n\n注：你可以假设线性时不变（LTI）系统和矩阵函数的标准数学性质。所有的建模假设和参数都应在用于实时数字孪生架构的计算聚变科学与工程的背景下进行解释。",
            "solution": "将首先对问题陈述的科学合理性、一致性和完整性进行验证。\n\n### 第一步：提取已知条件\n问题提供了以下信息：\n- **控制方程**:\n  - 垂直运动: $m\\,\\ddot{z} + c\\,\\dot{z} + k\\,z = \\alpha\\,i$\n  - 线圈电路: $L\\,\\dot{i} + R\\,i = K_{a}\\,u$\n  - 测量滤波器: $\\tau_{s}\\,\\dot{y} + y = z$\n- **参数**: 参数$m, c, k, \\alpha, L, R, K_{a}, \\tau_{s}$均为严格正值和常数。\n- **状态向量定义**: $x = \\begin{pmatrix} z \\\\ \\dot{z} \\\\ i \\\\ y \\end{pmatrix}$\n- **输入和输出**: 控制输入为$u$，测量输出为$y$。\n- **工作点**: 系统在平衡点$(z_{0}, \\dot{z}_{0}, i_{0}, y_{0}, u_{0}) = (0, 0, 0, 0, 0)$附近进行线性化。\n- **离散化方法**: 对输入$u$使用零阶保持器(ZOH)，采样周期为$T_{s}$。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据**: 所提供的方程代表了标准的、基于物理的模型。垂直运动是一个有阻尼的二阶系统（Newton第二定律），这是对等离子体垂直动力学的常见简化。线圈电路是一个一阶RL电路（Kirchhoff电压定律）。测量模型是一个一阶低通滤波器。这些都是物理学和控制工程中成熟的模型。该问题具有科学依据。\n- **适定性**: 该问题被构建为线性系统理论中的一个标准练习。它要求从控制微分方程推导状态空间矩阵，执行标准的离散化过程，并计算矩阵行列式。这些任务在数学上是明确定义的，并能导出一个唯一的解。\n- **客观性**: 问题以精确的技术语言陈述，没有任何主观或模棱两可的术语。\n- **完整性和一致性**: 所有必要的变量、参数和条件都已明确定义。方程和定义在内部是一致的。在原点处的工作点简化了线性化过程，因为给定的方程已经是线性的和齐次的（输入项除外）。\n- **其他缺陷**: 该问题没有表现出任何其他缺陷。它并非微不足道，因为它需要关于矩阵指数、行列式和迹之间关系的知识。它在其建模背景下是可形式化的、现实的且可验证的。\n\n### 第三步：结论与行动\n问题是有效的。将提供完整的解答。\n\n### 解题推导\n\n**任务1：连续时间LTI状态空间模型**\n\n系统要表示为$\\dot{x} = A_{c}\\,x + B_{c}\\,u$和$y = C_{c}\\,x$的形式。状态向量为$x = \\begin{pmatrix} x_{1} & x_{2} & x_{3} & x_{4} \\end{pmatrix}^{T} = \\begin{pmatrix} z & \\dot{z} & i & y \\end{pmatrix}^{T}$。我们通过将每个状态变量的一阶时间导数用状态变量本身和输入$u$来表示，从而推导出状态方程。\n\n根据状态变量的定义，我们有：\n$$\n\\dot{x}_{1} = \\dot{z} = x_{2}\n$$\n\n根据垂直运动方程$m\\,\\ddot{z} + c\\,\\dot{z} + k\\,z = \\alpha\\,i$，我们求解$\\ddot{z} = \\dot{x}_{2}$：\n$$\nm\\,\\dot{x}_{2} + c\\,x_{2} + k\\,x_{1} = \\alpha\\,x_{3}\n$$\n$$\n\\dot{x}_{2} = -\\frac{k}{m}x_{1} - \\frac{c}{m}x_{2} + \\frac{\\alpha}{m}x_{3}\n$$\n\n根据线圈电路方程$L\\,\\dot{i} + R\\,i = K_{a}\\,u$，我们求解$\\dot{i} = \\dot{x}_{3}$：\n$$\nL\\,\\dot{x}_{3} + R\\,x_{3} = K_{a}\\,u\n$$\n$$\n\\dot{x}_{3} = -\\frac{R}{L}x_{3} + \\frac{K_{a}}{L}u\n$$\n\n根据测量滤波器方程$\\tau_{s}\\,\\dot{y} + y = z$，我们求解$\\dot{y} = \\dot{x}_{4}$：\n$$\n\\tau_{s}\\,\\dot{x}_{4} + x_{4} = x_{1}\n$$\n$$\n\\dot{x}_{4} = \\frac{1}{\\tau_{s}}x_{1} - \\frac{1}{\\tau_{s}}x_{4}\n$$\n\n由于控制方程已经是线性的，围绕原点$(0,0,0,0,0)$的线性化会得到相同的方程组。我们现在可以组合矩阵$A_{c}$和$B_{c}$：\n$$\n\\begin{pmatrix} \\dot{x}_{1} \\\\ \\dot{x}_{2} \\\\ \\dot{x}_{3} \\\\ \\dot{x}_{4} \\end{pmatrix} =\n\\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n-\\frac{k}{m} & -\\frac{c}{m} & \\frac{\\alpha}{m} & 0 \\\\\n0 & 0 & -\\frac{R}{L} & 0 \\\\\n\\frac{1}{\\tau_{s}} & 0 & 0 & -\\frac{1}{\\tau_{s}}\n\\end{pmatrix}\n\\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\\\ x_{4} \\end{pmatrix}\n+\n\\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{K_{a}}{L} \\\\ 0 \\end{pmatrix}\nu\n$$\n因此，连续时间系统矩阵$A_{c}$和输入矩阵$B_{c}$为：\n$$\nA_{c} = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n-\\frac{k}{m} & -\\frac{c}{m} & \\frac{\\alpha}{m} & 0 \\\\\n0 & 0 & -\\frac{R}{L} & 0 \\\\\n\\frac{1}{\\tau_{s}} & 0 & 0 & -\\frac{1}{\\tau_{s}}\n\\end{pmatrix}, \\quad\nB_{c} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{K_{a}}{L} \\\\ 0 \\end{pmatrix}\n$$\n输出为$y = x_{4}$。输出方程为$y = C_{c}\\,x$，因此输出矩阵$C_{c}$为：\n$$\nC_{c} = \\begin{pmatrix} 0 & 0 & 0 & 1 \\end{pmatrix}\n$$\n\n**任务2：离散时间状态空间模型**\n\n对于一个连续时间LTI系统$\\dot{x} = A_{c}\\,x + B_{c}\\,u$，在输入$u$上使用零阶保持器(ZOH)且采样周期为$T_{s}$的精确离散时间等效模型$x_{k+1} = A_{d}\\,x_{k} + B_{d}\\,u_{k}$由以下公式给出：\n$$\nA_{d} = \\exp(A_{c}T_{s})\n$$\n$$\nB_{d} = \\left( \\int_{0}^{T_{s}} \\exp(A_{c}\\tau) \\,d\\tau \\right) B_{c} = A_{c}^{-1} (A_{d} - I) B_{c} \\quad (\\text{如果 } A_c \\text{ 可逆})\n$$\n其中$I$是单位矩阵。离散时间输出方程为$y_{k} = C_{d}\\,x_{k}$，其中输出矩阵不变：\n$$\nC_{d} = C_{c} = \\begin{pmatrix} 0 & 0 & 0 & 1 \\end{pmatrix}\n$$\n问题不要求计算$A_{d}$和$B_{d}$的显式条目，只要求通过精确采样给出它们的定义，这些定义已在上面提供。\n\n**任务3：离散时间状态转移矩阵的行列式**\n\n我们需要找到$\\det(A_{d})$的闭式表达式。状态转移矩阵为$A_{d} = \\exp(A_{c}T_{s})$。\n矩阵指数的一个基本性质，即Jacobi公式，将矩阵指数的行列式与矩阵的迹联系起来：\n$$\n\\det(\\exp(M)) = \\exp(\\mathrm{tr}(M))\n$$\n对于任何方阵$M$。在我们的情况下，$M = A_{c}T_{s}$。应用此公式：\n$$\n\\det(A_{d}) = \\det(\\exp(A_{c}T_{s})) = \\exp(\\mathrm{tr}(A_{c}T_{s}))\n$$\n迹是线性算子，所以$\\mathrm{tr}(A_{c}T_{s}) = T_{s}\\,\\mathrm{tr}(A_{c})$。因此：\n$$\n\\det(A_{d}) = \\exp(T_{s}\\,\\mathrm{tr}(A_{c}))\n$$\n方阵的迹是其对角元素之和。从任务1中推导出的矩阵$A_{c}$：\n$$\nA_{c} = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n-\\frac{k}{m} & -\\frac{c}{m} & \\frac{\\alpha}{m} & 0 \\\\\n0 & 0 & -\\frac{R}{L} & 0 \\\\\n\\frac{1}{\\tau_{s}} & 0 & 0 & -\\frac{1}{\\tau_{s}}\n\\end{pmatrix}\n$$\n$A_{c}$的迹为：\n$$\n\\mathrm{tr}(A_{c}) = 0 + \\left(-\\frac{c}{m}\\right) + \\left(-\\frac{R}{L}\\right) + \\left(-\\frac{1}{\\tau_{s}}\\right) = -\\frac{c}{m} - \\frac{R}{L} - \\frac{1}{\\tau_{s}}\n$$\n将此代入行列式的表达式中：\n$$\n\\det(A_{d}) = \\exp\\left(T_{s}\\left(-\\frac{c}{m} - \\frac{R}{L} - \\frac{1}{\\tau_{s}}\\right)\\right) = \\exp\\left(-T_{s}\\left(\\frac{c}{m} + \\frac{R}{L} + \\frac{1}{\\tau_{s}}\\right)\\right)\n$$\n此表达式仅依赖于参数$m$、$c$、$L$、$R$、$\\tau_{s}$和$T_{s}$，符合要求。这个结果具有物理意义，因为它表明状态空间平行多面体的体积在每个时间步都会收缩，这对于一个能量耗散（由于阻尼$c$和电阻$R$）且测量存在滞后的稳定物理系统来说是预期的。$A_d$的特征值与$A_c$的特征值通过$\\lambda_{d,i} = \\exp(\\lambda_{c,i} T_s)$相关联，行列式是特征值的乘积，所以$\\det(A_d) = \\prod_i \\exp(\\lambda_{c,i} T_s) = \\exp(\\sum_i \\lambda_{c,i} T_s) = \\exp(\\mathrm{tr}(A_c) T_s)$。这证实了结果。",
            "answer": "$$\n\\boxed{\\exp\\left(-T_{s}\\left(\\frac{c}{m} + \\frac{R}{L} + \\frac{1}{\\tau_{s}}\\right)\\right)}\n$$"
        },
        {
            "introduction": "拥有一个系统模型后，下一步自然是利用它进行控制。然而，现实世界的控制系统面临着测量延迟等挑战，这可能破坏系统的稳定性。本练习  将指导你使用鲁棒控制理论中的小增益定理，来设计一个即使在存在未知且时变的延迟时也能保证稳定性的控制器。掌握这项技能对于开发在真实实验条件下可靠运行的实时数字孪生至关重要。",
            "id": "3965973",
            "problem": "用于托卡马克等离子体垂直位置坐标的数字孪生采用离散时间模型，在存在诊断延迟的情况下合成实时控制。等离子体坐标相对于标称平衡点的偏差，在离散时间索引 $k \\in \\mathbb{Z}_{\\ge 0}$ 时表示为 $x_k \\in \\mathbb{R}$，由一步线性化的数字孪生模型描述\n$$\nx_{k+1} \\;=\\; a\\,x_k \\;+\\; b\\,u_k,\n$$\n输出为 $y_k = x_k$，其中 $a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}$ 是恒定的数字孪生参数，$u_k \\in \\mathbb{R}$ 是控制输入。控制器可用的实际测量值会因诊断采集和流式传输管道而产生一个未知的、时变但有界的整数延迟 $d_k \\in \\{0,1,\\dots,d_{\\max}\\}$。控制器采用延迟输出反馈\n$$\nu_k \\;=\\; -\\,k\\,y_{k-d_k} \\;=\\; -\\,k\\,x_{k-d_k},\n$$\n其中标量增益 $k \\in \\mathbb{R}_{>0}$。假设 $|a|1$ 且 $b \\neq 0$。\n\n要求您使用离散时间系统理论分析延迟测量的稳定性影响，并推导一个鲁棒的、与延迟无关的充分条件，以保证闭环系统对于所有满足 $0 \\le d_k \\le d_{\\max}$ 的容许延迟序列 $\\{d_k\\}$ 都是渐近稳定的。您的推导必须仅基于离散时间线性时不变 (LTI) 系统的基本输入输出概念、单位圆上的离散时间傅里叶变换 (DTFT) 以及针对诱导 $\\ell_2$-增益的小增益定理。特别地，您可以将未知的有界延迟建模为一个具有单位诱导 $\\ell_2$-增益的因果算子。\n\n(a) 从 LTI 对象（从 $u$ 到 $x$）与延迟反馈路径的互联观点出发，推导一个关于 $k$、$a$ 和 $b$ 的充分不等式，以保证对于所有有界整数延迟 $d_k \\in \\{0,1,\\dots,d_{\\max}\\}$ 的鲁棒闭环稳定性。您的推导必须明确显示出现在小增益条件中的对象因子的频域界。\n\n(b) 对于参数 $a=0.86$、$b=0.42$ 以及任意整数界 $d_{\\max} \\ge 0$，计算满足您在 (a) 部分中充分条件的所有控制器增益 $k$ 的上确界 $k_{\\max}0$，从而确保对每个容许延迟序列的鲁棒稳定性。请将您的最终结果 $k_{\\max}$ 以最简分数形式给出。无需四舍五入。最终答案必须是一个实数。",
            "solution": "我们从离散时间数字孪生对象开始\n$$\nx_{k+1} \\;=\\; a\\,x_k \\;+\\; b\\,u_k,\\qquad y_k \\;=\\; x_k,\n$$\n以及延迟输出反馈律\n$$\nu_k \\;=\\; -\\,k\\,y_{k-d_k} \\;=\\; -\\,k\\,x_{k-d_k},\\qquad d_k \\in \\{0,1,\\dots,d_{\\max}\\}.\n$$\n我们使用输入输出互联和小增益定理（针对诱导 $\\ell_2$-增益）来分析关于未知的、时变有界延迟的鲁棒性。\n\n首先，考虑从输入 $u$ 到状态 $x$ 的 LTI 映射。在零初始条件下进行 $z$ 变换，从 $U(z)$ 到 $X(z)$ 的传递函数为\n$$\nG(z) \\;=\\; \\frac{X(z)}{U(z)} \\;=\\; \\frac{b}{1 - a z^{-1}}.\n$$\n反馈路径中的延迟测量可以表示为一个作用于信号 $x$ 的因果算子 $\\Delta$。当延迟为常数 $d$ 时，该算子是 $d$ 个样本的纯粹移位，在频域中对应于乘以 $z^{-d}$。对于时变整数延迟 $d_k \\in \\{0,1,\\dots,d_{\\max}\\}$，算子 $\\Delta$ 仍然是因果、有界的，并且其诱导 $\\ell_2$-增益等于 1，因为在 $\\ell_2$ 空间上的移位会保持信号能量。因此，我们将不确定性建模为一个诱导 $\\ell_2$-增益为\n$$\n\\|\\Delta\\| \\;=\\; 1.\n$$\n的因果算子 $\\Delta$。\n\n于是，反馈互联可以表示为\n$$\nx \\;=\\; G \\bigl( -k\\, \\Delta\\, x \\bigr).\n$$\n这是一个稳定的 LTI 系统 $G$ 与一个由实数增益 $k$ 缩放的有界因果算子 $\\Delta$ 的标准反馈结构。针对诱导 $\\ell_2$-增益的小增益定理指出，如果满足以下条件，则反馈互联是适定的 (well-posed) 和 Lur’e 稳定的：\n$$\n\\|\\, -k\\, G \\,\\|_{\\infty} \\cdot \\|\\Delta\\|  1,\n$$\n其中 $\\|G\\|_{\\infty}$ 表示稳定 LTI 映射 $G$ 的 $\\mathcal{H}_{\\infty}$-范数，即 $G(e^{\\mathrm{j}\\omega})$ 的幅值在 $\\omega \\in [-\\pi,\\pi]$ 上的上确界。由于 $|a|1$，对象 $G$ 是稳定的，又因为 $\\|\\Delta\\|=1$，鲁棒稳定性的充分条件简化为\n$$\n|k| \\cdot \\|G\\|_{\\infty}  1.\n$$\n接下来我们计算 $\\|G\\|_{\\infty}$。对于实数 $a$ 和 $b$，在单位圆 $z = \\exp(\\mathrm{j}\\omega)$ 上，我们有\n$$\nG\\bigl(e^{\\mathrm{j}\\omega}\\bigr) \\;=\\; \\frac{b}{1 - a e^{-\\mathrm{j}\\omega}},\n$$\n因此\n$$\n\\bigl|G\\bigl(e^{\\mathrm{j}\\omega}\\bigr)\\bigr| \\;=\\; \\frac{|b|}{\\left|1 - a e^{-\\mathrm{j}\\omega}\\right|}.\n$$\n所以，\n$$\n\\|G\\|_{\\infty} \\;=\\; |b| \\cdot \\sup_{\\omega \\in [-\\pi,\\pi]} \\frac{1}{\\left|1 - a e^{-\\mathrm{j}\\omega}\\right|}.\n$$\n为了计算上确界，观察到\n$$\n\\left|1 - a e^{-\\mathrm{j}\\omega}\\right|^{2} \\;=\\; \\left(1 - a \\cos\\omega\\right)^{2} + \\left(a \\sin\\omega\\right)^{2} \\;=\\; 1 + a^{2} - 2 a \\cos\\omega.\n$$\n对于固定的实数 $a$，$1 + a^{2} - 2 a \\cos\\omega$ 在 $\\omega$ 上的最小值出现在 $\\cos\\omega = \\operatorname{sign}(a)$ 时，得到\n$$\n\\min_{\\omega} \\left|1 - a e^{-\\mathrm{j}\\omega}\\right| \\;=\\; 1 - |a|.\n$$\n从而\n$$\n\\sup_{\\omega} \\frac{1}{\\left|1 - a e^{-\\mathrm{j}\\omega}\\right|} \\;=\\; \\frac{1}{1 - |a|},\n$$\n结果是\n$$\n\\|G\\|_{\\infty} \\;=\\; \\frac{|b|}{1 - |a|}.\n$$\n小增益充分条件变为\n$$\n|k| \\cdot \\frac{|b|}{1 - |a|}  1 \\quad \\Longleftrightarrow \\quad |k b|  1 - |a|.\n$$\n因为我们考虑 $k0$，这得出了与延迟无关的鲁棒稳定性条件\n$$\nk  \\frac{1 - |a|}{|b|}.\n$$\n这个条件保证了对于任何有界整数延迟序列 $d_k \\in \\{0,1,\\dots,d_{\\max}\\}$，闭环系统都是鲁棒渐近稳定的，因为不确定延迟算子 $\\Delta$ 的诱导 $\\ell_2$-增益等于 1，且这与 $d_{\\max}$ 无关，同时对象因子受 $\\|G\\|_{\\infty}$ 约束。\n\n对于 (b) 部分，代入 $a = 0.86$ 和 $b = 0.42$。那么\n$$\n1 - |a| \\;=\\; 1 - 0.86 \\;=\\; 0.14,\\qquad |b| \\;=\\; 0.42,\n$$\n所以容许增益的上确界是\n$$\nk_{\\max} \\;=\\; \\frac{1 - |a|}{|b|} \\;=\\; \\frac{0.14}{0.42} \\;=\\; \\frac{14}{42} \\;=\\; \\frac{1}{3}.\n$$\n这个值是上确界；任何严格小于 $\\frac{1}{3}$ 的 $k$ 都满足小增益充分不等式，因此对于所有满足 $0 \\le d_k \\le d_{\\max}$ 的整数延迟 $d_k$（对于任何 $d_{\\max} \\ge 0$），都能保证鲁棒稳定性。",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        },
        {
            "introduction": "数字孪生的核心价值在于其与物理实体的实时同步。要实现这一点，我们必须不断地利用实时测量数据来修正孪生模型的状态。本练习  深入探讨了这一过程的核心技术——卡尔曼滤波器。你将通过推导和计算最优卡尔曼增益，学习如何将带有噪声的传感器数据与模型的预测进行最优融合，从而最大限度地减少估计误差，确保数字孪生的准确性。",
            "id": "3965967",
            "problem": "一个用于托卡马克等离子体垂直运动的核心耦合数字孪生以采样周期 $\\Delta t$ 实时运行，并使用扩展卡尔曼滤波器 (EKF) 融合预测性降阶模型与磁诊断。在时间步 $k$，该孪生围绕预测状态对诊断模型进行线性化，得到形式为 $y_{k} = H_{k} x_{k} + v_{k}$ 的局部线性测量模型，其中 $x_{k} \\in \\mathbb{R}^{2}$ 包含了归一化垂直位置和垂直速度，$H_{k} \\in \\mathbb{R}^{1 \\times 2}$ 是线性化测量雅可比矩阵，$v_{k}$ 是协方差为 $R_{k} \\in \\mathbb{R}$ 的零均值高斯噪声。EKF 使用新息 $y_{k} - H_{k} \\hat{x}_{k}^{-}$ 来修正先验估计 $\\hat{x}_{k}^{-}$，其增益必须在标准线性高斯假设下选择以最小化后验均方误差。\n\n从第一性原理出发，即线性高斯系统的贝叶斯法则和联合高斯随机变量的最小均方误差估计器的定义，推导在时间 $k$ 的 EKF 更新中使用的最优线性新息增益的表达式，用先验误差协方差 $P_{k}$、测量雅可比矩阵 $H_{k}$ 和测量噪声协方差 $R_{k}$ 表示。然后，根据特定时间步的以下实时孪生数据，计算该增益：\n- 先验协方差 $P_{k} = \\begin{pmatrix} 2.5 \\times 10^{-3}  4.0 \\times 10^{-4} \\\\ 4.0 \\times 10^{-4}  1.0 \\times 10^{-2} \\end{pmatrix}$，\n- 测量雅可比矩阵 $H_{k} = \\begin{pmatrix} 0.75  0 \\end{pmatrix}$，\n- 测量噪声协方差 $R_{k} = 1.6 \\times 10^{-3}$。\n\n所有量都以归一化单位（无量纲）表示。将增益报告为 $1 \\times 2$ 的行向量。将你的数值结果四舍五入到四位有效数字。",
            "solution": "本题要求推导扩展卡尔曼滤波器 (EKF) 更新步骤的最优线性新息增益，然后根据给定的参数集进行数值计算。推导必须从第一性原理出发，特别是最小化后验均方误差。\n\n首先，我们建立必要的定义和符号。时间步 $k$ 的状态向量为 $x_k \\in \\mathbb{R}^2$，测量值为 $y_k \\in \\mathbb{R}^1$。线性化的测量模型如下：\n$$y_k = H_k x_k + v_k$$\n其中 $H_k \\in \\mathbb{R}^{1 \\times 2}$ 是测量雅可比矩阵，$v_k$ 是测量噪声。噪声 $v_k$ 假定为零均值高斯随机变量，其协方差为 $R_k = E[v_k v_k^T] \\in \\mathbb{R}$。\n\nEKF 传播状态估计及其误差协方差。在测量更新步骤，我们有一个先验状态估计 $\\hat{x}_k^{-}$ 和一个先验误差协方差 $P_k = E[(x_k - \\hat{x}_k^{-})(x_k - \\hat{x}_k^{-})^T]$。需要注意的是，问题陈述中使用符号 $P_k$ 表示先验误差协方差，而该符号通常保留给后验协方差（其中 $P_k^{-}$ 是先验）。为了保持一致性，我们将遵循问题中指定的符号。\n\n后验状态估计 $\\hat{x}_k$ 是通过用新息 $y_k - H_k \\hat{x}_k^{-}$ 乘以一个增益矩阵 $K_k$ 来修正先验估计而形成的：\n$$\\hat{x}_k = \\hat{x}_k^{-} + K_k (y_k - H_k \\hat{x}_k^{-})$$\n目标是找到使后验均方误差最小化的增益 $K_k$。这等同于最小化后验误差协方差矩阵的迹，$P_k^{\\text{post}} = E[(x_k - \\hat{x}_k)(x_k - \\hat{x}_k)^T]$。\n\n让我们推导后验误差 $e_k = x_k - \\hat{x}_k$ 的表达式。\n$$e_k = x_k - \\left( \\hat{x}_k^{-} + K_k (y_k - H_k \\hat{x}_k^{-}) \\right)$$\n代入测量模型 $y_k = H_k x_k + v_k$：\n$$e_k = x_k - \\hat{x}_k^{-} - K_k (H_k x_k + v_k - H_k \\hat{x}_k^{-})$$\n$$e_k = (x_k - \\hat{x}_k^{-}) - K_k H_k (x_k - \\hat{x}_k^{-}) - K_k v_k$$\n令先验误差为 $e_k^{-} = x_k - \\hat{x}_k^{-}$。表达式简化为：\n$$e_k = (I - K_k H_k) e_k^{-} - K_k v_k$$\n现在，我们计算后验误差协方差 $P_k^{\\text{post}} = E[e_k e_k^T]$。\n$$P_k^{\\text{post}} = E\\left[ \\left( (I - K_k H_k) e_k^{-} - K_k v_k \\right) \\left( (I - K_k H_k) e_k^{-} - K_k v_k \\right)^T \\right]$$\n先验状态误差 $e_k^{-}$ 与测量噪声 $v_k$ 不相关，即 $E[e_k^{-} v_k^T] = 0$ 和 $E[v_k (e_k^{-})^T] = 0$。展开表达式得到：\n$$P_k^{\\text{post}} = (I - K_k H_k) E[e_k^{-} (e_k^{-})^T] (I - K_k H_k)^T + K_k E[v_k v_k^T] K_k^T$$\n代入先验误差协方差 $P_k$ 和测量噪声协方差 $R_k$ 的定义：\n$$P_k^{\\text{post}} = (I - K_k H_k) P_k (I - K_k H_k)^T + K_k R_k K_k^T$$\n这是协方差更新的Joseph形式。为了找到最优的 $K_k$，我们展开此表达式：\n$$P_k^{\\text{post}} = P_k - K_k H_k P_k - P_k (K_k H_k)^T + K_k H_k P_k (K_k H_k)^T + K_k R_k K_k^T$$\n由于 $P_k$ 是一个协方差矩阵，它是对称的（$P_k = P_k^T$）。\n$$P_k^{\\text{post}} = P_k - K_k H_k P_k - P_k H_k^T K_k^T + K_k H_k P_k H_k^T K_k^T + K_k R_k K_k^T$$\n$$P_k^{\\text{post}} = P_k - K_k H_k P_k - P_k H_k^T K_k^T + K_k (H_k P_k H_k^T + R_k) K_k^T$$\n要最小化的成本函数是该矩阵的迹，$J(K_k) = \\text{tr}(P_k^{\\text{post}})$。我们将 $J(K_k)$ 对 $K_k$ 求导并令结果为零。\n$$J(K_k) = \\text{tr}(P_k) - \\text{tr}(K_k H_k P_k) - \\text{tr}(P_k H_k^T K_k^T) + \\text{tr}(K_k (H_k P_k H_k^T + R_k) K_k^T)$$\n使用迹的循环性质 $\\text{tr}(AB) = \\text{tr}(BA)$，我们有 $\\text{tr}(P_k H_k^T K_k^T) = \\text{tr}(K_k^T P_k H_k^T) = \\text{tr}((H_k P_k K_k)^T) = \\text{tr}(K_k H_k P_k)$。\n令 $S_k = H_k P_k H_k^T + R_k$ 为新息协方差。成本函数变为：\n$$J(K_k) = \\text{tr}(P_k) - 2\\text{tr}(K_k H_k P_k) + \\text{tr}(K_k S_k K_k^T)$$\n使用标准矩阵微积分恒等式 $\\frac{\\partial \\text{tr}(AX)}{\\partial X} = A^T$ 和 $\\frac{\\partial \\text{tr}(XBX^T)}{\\partial X} = 2XB$（对于对称的 $B$），我们对 $J(K_k)$ 求导：\n$$\\frac{\\partial J(K_k)}{\\partial K_k} = 0 - 2\\frac{\\partial}{\\partial K_k}\\text{tr}(K_k (H_k P_k)) + \\frac{\\partial}{\\partial K_k}\\text{tr}(K_k S_k K_k^T)$$\n$$\\frac{\\partial J(K_k)}{\\partial K_k} = -2(H_k P_k)^T + 2K_k S_k$$\n由于 $P_k$ 是对称的，$(H_k P_k)^T = P_k^T H_k^T = P_k H_k^T$。\n$$\\frac{\\partial J(K_k)}{\\partial K_k} = -2 P_k H_k^T + 2K_k S_k$$\n将导数设为零以找到最小值：\n$$-2 P_k H_k^T + 2K_k S_k = 0$$\n$$K_k S_k = P_k H_k^T$$\n$$K_k (H_k P_k H_k^T + R_k) = P_k H_k^T$$\n求解 $K_k$ 得到最优线性新息增益，也称为卡尔曼增益：\n$$K_k = P_k H_k^T (H_k P_k H_k^T + R_k)^{-1}$$\n推导到此结束。\n\n接下来，我们使用所提供的数据来计算此表达式的值：\n- 先验协方差 $P_{k} = \\begin{pmatrix} 2.5 \\times 10^{-3}  4.0 \\times 10^{-4} \\\\ 4.0 \\times 10^{-4}  1.0 \\times 10^{-2} \\end{pmatrix}$\n- 测量雅可比矩阵 $H_{k} = \\begin{pmatrix} 0.75  0 \\end{pmatrix}$\n- 测量噪声协方差 $R_{k} = 1.6 \\times 10^{-3}$\n\n首先，我们计算 $P_k H_k^T$ 项：\n$$H_k^T = \\begin{pmatrix} 0.75 \\\\ 0 \\end{pmatrix}$$\n$$P_k H_k^T = \\begin{pmatrix} 2.5 \\times 10^{-3}  4.0 \\times 10^{-4} \\\\ 4.0 \\times 10^{-4}  1.0 \\times 10^{-2} \\end{pmatrix} \\begin{pmatrix} 0.75 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (2.5 \\times 10^{-3})(0.75) \\\\ (4.0 \\times 10^{-4})(0.75) \\end{pmatrix} = \\begin{pmatrix} 1.875 \\times 10^{-3} \\\\ 3.0 \\times 10^{-4} \\end{pmatrix}$$\n接下来，我们计算新息协方差 $S_k = H_k P_k H_k^T + R_k$。由于 $H_k$ 是行向量，$P_k H_k^T$ 是列向量，它们的乘积是一个标量。\n$$H_k P_k H_k^T = \\begin{pmatrix} 0.75  0 \\end{pmatrix} \\begin{pmatrix} 1.875 \\times 10^{-3} \\\\ 3.0 \\times 10^{-4} \\end{pmatrix} = (0.75)(1.875 \\times 10^{-3}) = 1.40625 \\times 10^{-3}$$\n$$S_k = 1.40625 \\times 10^{-3} + 1.6 \\times 10^{-3} = 3.00625 \\times 10^{-3}$$\n逆 $S_k^{-1}$ 是该标量值的倒数。\n现在我们计算增益 $K_k$：\n$$K_k = P_k H_k^T S_k^{-1} = \\begin{pmatrix} 1.875 \\times 10^{-3} \\\\ 3.0 \\times 10^{-4} \\end{pmatrix} (3.00625 \\times 10^{-3})^{-1}$$\n$$K_k = \\begin{pmatrix} \\frac{1.875 \\times 10^{-3}}{3.00625 \\times 10^{-3}} \\\\ \\frac{3.0 \\times 10^{-4}}{3.00625 \\times 10^{-3}} \\end{pmatrix} = \\begin{pmatrix} \\frac{1.875}{3.00625} \\\\ \\frac{0.3}{3.00625} \\end{pmatrix}$$\n$$K_k \\approx \\begin{pmatrix} 0.6237005 \\\\ 0.0997920 \\end{pmatrix}$$\n状态的维度是 $n=2$，测量的维度是 $m=1$。因此，卡尔曼增益 $K_k$ 必须是一个 $2 \\times 1$ 矩阵（一个列向量），以确保更新方程 $\\hat{x}_k = \\hat{x}_k^{-} + K_k (y_k - H_k \\hat{x}_k^{-})$ 的量纲一致性。然而，问题明确要求答案以 $1 \\times 2$ 行向量的形式给出。因此，我们将提供增益的转置 $K_k^T$。\n\n将分量四舍五入到四位有效数字：\n$$K_{k,1} \\approx 0.6237$$\n$$K_{k,2} \\approx 0.09979$$\n最终结果以 $1 \\times 2$ 行向量表示为：\n$$K_k^T \\approx \\begin{pmatrix} 0.6237  0.09979 \\end{pmatrix}$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.6237  0.09979 \\end{pmatrix}}$$"
        }
    ]
}