{
    "hands_on_practices": [
        {
            "introduction": "集成建模通常需要将描述不同区域和物理现象的模型耦合起来。本练习将重点关注一个关键的边界区域——刮削层（Scrape-Off Layer, SOL），这里的等离子体与壁材料相互作用。通过平衡垂直于磁场线的扩散输运和沿着磁场线的平行损失这两个相互竞争的物理过程，我们将推导出一个关键参数——刮削层热通量宽度 $\\lambda_q$。这个练习展示了如何从第一性原理出发，为集成模型构建一个简化的、但物理上合理的子模型。",
            "id": "3997030",
            "problem": "一个环向轴对称的托卡马克等离子体在某一工作模式下运行，该模式的刮削层（SOL）由跨场扩散和平行损失主导。考虑一个基于沿磁场和跨磁场能量输运第一性原理的简化SOL集成模型。假设存在以下稳态情景：\n\n- 从SOL磁通管中沿场移除的能量是对流性的，其特征在于平行热通量密度 $q_{\\parallel}$ 和鞘层能量传输因子 $\\gamma_{\\mathrm{sh}}$。\n- 在单电离氘等离子体中，平行声速 $c_{s}$ 遵循离子声学关系。\n- 跨SOL的热量径向扩展由一个恒定的垂直热扩散系数 $\\chi_{\\perp}$ 控制。\n- 从外中平面到外偏滤器的平行连接长度 $L_{\\parallel}$ 由磁几何结构确定。\n- 偏滤器靶板的取向使得磁场的入射角等于打击点处的极向倾斜角，其中 $\\sin\\alpha = B_{p}/B$。\n\n从基本定律和经过充分检验的公式出发，通过平衡垂直扩散时间尺度与平行损失时间尺度，推导出SOL热通量宽度 $\\lambda_{q}$ 的表达式，然后估算到偏滤器靶板的法向热通量。\n\n使用以下参数，这些参数在科学上都是符合实际的：\n- 环向磁场大小 $B = 2.1\\,\\mathrm{T}$。\n- 大半径 $R = 1.7\\,\\mathrm{m}$ 和边缘安全因子 $q_{\\mathrm{sf}} = 4.5$。\n- 打击点磁通面处的小半径 $r = 0.60\\,\\mathrm{m}$。\n- 垂直热扩散系数 $\\chi_{\\perp} = 0.40\\,\\mathrm{m^{2}/s}$。\n- 平行热通量密度（上游） $q_{\\parallel} = 2.0 \\times 10^{8}\\,\\mathrm{W/m^{2}}$。\n- 边缘密度 $n = 2.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$。\n- 鞘层能量传输因子 $\\gamma_{\\mathrm{sh}} = 7$。\n- 氘离子质量 $m_{i} = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$。\n\n假设：\n- 平行连接长度满足 $L_{\\parallel} \\approx \\pi R q_{\\mathrm{sf}}$。\n- 打击点处的极向磁场满足 $B_{p} = \\dfrac{r B}{R q_{\\mathrm{sf}}}$。\n- 平行损失是对流性的，有 $q_{\\parallel} = \\gamma_{\\mathrm{sh}}\\, n\\, k_{B}\\, T\\, c_{s}$ 和 $c_{s}^{2} = \\dfrac{k_{B} T}{m_{i}}$。\n- SOL宽度通过令垂直扩散时间 $\\tau_{\\perp} = \\dfrac{\\lambda_{q}^{2}}{\\chi_{\\perp}}$ 等于平行损失时间 $\\tau_{\\parallel} = \\dfrac{L_{\\parallel}}{c_{s}}$ 来确定。\n\n任务：\n1. 推导 $\\lambda_{q}$ 关于 $\\chi_{\\perp}$、$L_{\\parallel}$、$q_{\\parallel}$、$\\gamma_{\\mathrm{sh}}$、$n$ 和 $m_{i}$ 的解析表达式。\n2. 使用给定的数值，计算 $\\lambda_{q}$ 和偏滤器靶板法向热通量 $q_{\\mathrm{target}} = q_{\\parallel} \\sin\\alpha$，其中 $\\sin\\alpha = \\dfrac{B_{p}}{B}$。\n3. 将 $\\lambda_{q}$ 以米为单位表示，将 $q_{\\mathrm{target}}$ 以 $\\mathrm{MW/m^{2}}$ 为单位表示。\n4. 将两个结果都四舍五入到三位有效数字。\n\n按 $\\lambda_{q}$ 和 $q_{\\mathrm{target}}$ 的顺序提供最终的数值结果，作为两个量。",
            "solution": "用户提供了一个科学上合理、定义明确且客观的问题。这是一个计算聚变科学领域的标准物理问题，尽管经过了简化，但为得出唯一解所需的所有参数和定义都已提供。该问题是有效的。\n\n该问题要求推导刮削层（SOL）热通量宽度（记为 $\\lambda_{q}$）的解析表达式，并对 $\\lambda_{q}$ 和到偏滤器靶板的法向热通量 $q_{\\mathrm{target}}$ 进行数值估算。\n\n推导基于平衡垂直和平行热输运的特征时间尺度。垂直输运是扩散性的，而平行输运是对流性的。\n\n热量径向扩散距离 $\\lambda_{q}$ 的特征时间由下式给出：\n$$\n\\tau_{\\perp} = \\frac{\\lambda_{q}^{2}}{\\chi_{\\perp}}\n$$\n其中 $\\chi_{\\perp}$ 是恒定的垂直热扩散系数。\n\n热量沿磁力线损失到偏滤器靶板的特征时间由下式给出：\n$$\n\\tau_{\\parallel} = \\frac{L_{\\parallel}}{c_{s}}\n$$\n其中 $L_{\\parallel}$ 是平行连接长度，$c_{s}$ 是平行声速。\n\nSOL宽度 $\\lambda_{q}$ 由这两个时间尺度相等的条件确定：\n$$\n\\tau_{\\perp} = \\tau_{\\parallel}\n$$\n代入时间尺度的表达式可得：\n$$\n\\frac{\\lambda_{q}^{2}}{\\chi_{\\perp}} = \\frac{L_{\\parallel}}{c_{s}}\n$$\n解出 $\\lambda_{q}^{2}$ 可得：\n$$\n\\lambda_{q}^{2} = \\frac{\\chi_{\\perp} L_{\\parallel}}{c_{s}}\n$$\n\n为了继续，我们需要一个用给定的上游等离子体参数表示声速 $c_{s}$ 的表达式。该问题为单电离氘等离子体提供了两个关键关系：\n1.  平行热通量密度 $q_{\\parallel}$ 由 $q_{\\parallel} = \\gamma_{\\mathrm{sh}}\\, n\\, k_{B}\\, T\\, c_{s}$ 给出，其中 $\\gamma_{\\mathrm{sh}}$ 是鞘层能量传输因子，$n$ 是等离子体密度，$k_{B}$ 是玻尔兹曼常数，$T$ 是温度。\n2.  离子声速由 $c_{s}^{2} = \\dfrac{k_{B} T}{m_{i}}$ 给出，其中 $m_{i}$ 是离子质量。\n\n我们可以从这两个方程中消去温度 $T$。从第二个方程，我们将 $k_{B}T$ 表示为：\n$$\nk_{B}T = m_{i} c_{s}^{2}\n$$\n将 $k_{B}T$ 的这个表达式代入 $q_{\\parallel}$ 的方程中：\n$$\nq_{\\parallel} = \\gamma_{\\mathrm{sh}}\\, n\\, (m_{i} c_{s}^{2})\\, c_{s} = \\gamma_{\\mathrm{sh}}\\, n\\, m_{i}\\, c_{s}^{3}\n$$\n我们现在可以解出用 $q_{\\parallel}$、$n$、$m_{i}$ 和 $\\gamma_{\\mathrm{sh}}$ 表示的声速 $c_{s}$：\n$$\nc_{s}^{3} = \\frac{q_{\\parallel}}{\\gamma_{\\mathrm{sh}}\\, n\\, m_{i}} \\implies c_{s} = \\left( \\frac{q_{\\parallel}}{\\gamma_{\\mathrm{sh}}\\, n\\, m_{i}} \\right)^{1/3}\n$$\n现在，我们将 $c_s$ 的这个表达式代回 $\\lambda_{q}^{2}$ 的方程中：\n$$\n\\lambda_{q}^{2} = \\chi_{\\perp} L_{\\parallel} \\left( \\left( \\frac{q_{\\parallel}}{\\gamma_{\\mathrm{sh}}\\, n\\, m_{i}} \\right)^{1/3} \\right)^{-1} = \\chi_{\\perp} L_{\\parallel} \\left( \\frac{q_{\\parallel}}{\\gamma_{\\mathrm{sh}}\\, n\\, m_{i}} \\right)^{-1/3} = \\chi_{\\perp} L_{\\parallel} \\left( \\frac{\\gamma_{\\mathrm{sh}}\\, n\\, m_{i}}{q_{\\parallel}} \\right)^{1/3}\n$$\n取平方根得到 $\\lambda_{q}$ 的最终解析表达式，这是第一个任务的答案：\n$$\n\\lambda_{q} = \\sqrt{\\chi_{\\perp} L_{\\parallel} \\left( \\frac{\\gamma_{\\mathrm{sh}}\\, n\\, m_{i}}{q_{\\parallel}} \\right)^{1/3}}\n$$\n\n对于第二个任务，我们计算数值。首先，我们使用提供的参数计算中间量 $L_{\\parallel}$ 和 $c_{s}$：\n- 环向磁场：$B = 2.1\\,\\mathrm{T}$\n- 大半径：$R = 1.7\\,\\mathrm{m}$\n- 边缘安全因子：$q_{\\mathrm{sf}} = 4.5$\n- 打击点处的小半径：$r = 0.60\\,\\mathrm{m}$\n- 垂直热扩散系数：$\\chi_{\\perp} = 0.40\\,\\mathrm{m^{2}/s}$\n- 上游平行热通量：$q_{\\parallel} = 2.0 \\times 10^{8}\\,\\mathrm{W/m^{2}}$\n- 边缘密度：$n = 2.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n- 鞘层能量传输因子：$\\gamma_{\\mathrm{sh}} = 7$\n- 氘离子质量：$m_{i} = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$\n\n平行连接长度 $L_{\\parallel}$ 由 $L_{\\parallel} \\approx \\pi R q_{\\mathrm{sf}}$ 给出：\n$$\nL_{\\parallel} = \\pi \\times (1.7\\,\\mathrm{m}) \\times 4.5 = 7.65\\pi\\,\\mathrm{m} \\approx 24.033\\,\\mathrm{m}\n$$\n声速 $c_{s}$ 是：\n$$\nc_{s} = \\left( \\frac{2.0 \\times 10^{8}\\,\\mathrm{W/m^{2}}}{7 \\times (2.0 \\times 10^{19}\\,\\mathrm{m^{-3}}) \\times (3.345 \\times 10^{-27}\\,\\mathrm{kg})} \\right)^{1/3}\n$$\n$$\nc_{s} = \\left( \\frac{2.0 \\times 10^{8}}{4.683 \\times 10^{-7}} \\right)^{1/3} \\mathrm{m/s} = (4.270766 \\times 10^{14})^{1/3}\\,\\mathrm{m/s} \\approx 75313.3\\,\\mathrm{m/s}\n$$\n现在我们可以计算 $\\lambda_{q}$：\n$$\n\\lambda_{q} = \\sqrt{\\frac{\\chi_{\\perp} L_{\\parallel}}{c_{s}}} = \\sqrt{\\frac{(0.40\\,\\mathrm{m^{2}/s}) \\times (24.033\\,\\mathrm{m})}{75313.3\\,\\mathrm{m/s}}} = \\sqrt{1.2764 \\times 10^{-4}\\,\\mathrm{m^2}}\n$$\n$$\n\\lambda_{q} \\approx 0.011298\\,\\mathrm{m}\n$$\n四舍五入到三位有效数字，我们得到 $\\lambda_{q} = 1.13 \\times 10^{-2}\\,\\mathrm{m}$。\n\n接下来，我们计算到偏滤器靶板的法向热通量 $q_{\\mathrm{target}}$。它由 $q_{\\mathrm{target}} = q_{\\parallel} \\sin\\alpha$ 给出，其中 $\\alpha$ 是磁场的入射角。我们已知 $\\sin\\alpha = B_{p}/B$ 且 $B_{p} = \\dfrac{r B}{R q_{\\mathrm{sf}}}$。\n因此：\n$$\n\\sin\\alpha = \\frac{1}{B} \\left( \\frac{r B}{R q_{\\mathrm{sf}}} \\right) = \\frac{r}{R q_{\\mathrm{sf}}}\n$$\n代入数值：\n$$\n\\sin\\alpha = \\frac{0.60\\,\\mathrm{m}}{(1.7\\,\\mathrm{m}) \\times 4.5} = \\frac{0.60}{7.65} \\approx 0.078431\n$$\n现在，我们可以计算 $q_{\\mathrm{target}}$：\n$$\nq_{\\mathrm{target}} = q_{\\parallel} \\sin\\alpha = (2.0 \\times 10^{8}\\,\\mathrm{W/m^{2}}) \\times 0.078431 = 1.56862 \\times 10^{7}\\,\\mathrm{W/m^{2}}\n$$\n问题要求结果以 $\\mathrm{MW/m^{2}}$ 为单位。因为 $1\\,\\mathrm{MW} = 10^{6}\\,\\mathrm{W}$：\n$$\nq_{\\mathrm{target}} = 15.6862\\,\\mathrm{MW/m^{2}}\n$$\n四舍五入到三位有效数字，我们得到 $q_{\\mathrm{target}} = 15.7\\,\\mathrm{MW/m^{2}}$。\n\n最终结果是 $\\lambda_{q} = 1.13 \\times 10^{-2}\\,\\mathrm{m}$ 和 $q_{\\mathrm{target}} = 15.7\\,\\mathrm{MW/m^{2}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.13 \\times 10^{-2}  15.7 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在核心等离子体中，杂质的积累会严重影响聚变反应的效率。因此，准确模拟杂质输运是集成建模的核心任务之一。本练习将引导你解决一个一维稳态输运方程，该方程使用标准的扩散-对流模型来描述杂质径向通量。你将计算杂质汇聚因子——一个衡量杂质在等离子体核心汇聚程度的无量纲参数，并评估其对不同物理效应（如湍流内向夹缩）的敏感性。",
            "id": "3997063",
            "problem": "考虑一个一维（1D）磁通面平均、径向对称的近似模型，用于描述环形磁约束装置中的杂质输运。装置的小半径为 $a$，单位为米。令 $r \\in [0,a]$ 表示径向坐标，单位为米；杂质数密度表示为 $n_Z(r)$，单位为 $\\mathrm{m}^{-3}$。假设在芯部区域，稳态连续性方程不包含体积源项，并且杂质径向粒子通量由扩散和对流共同决定。具体而言，杂质径向粒子通量 $\\Gamma_Z(r)$ 被建模为扩散项和对流项之和。装置芯部被认为具有净径向杂质通量为零的特性。在此建模框架下，目标是计算芯部区域的杂质集聚因子，并评估其对杂质对流速度中由湍流引起的向内箍缩分量的敏感性。\n\n基本建模假设：\n- 芯部区域无源的稳态连续性方程意味着，杂质径向通量 $\\Gamma_Z(r)$ 在芯部区域内是关于 $r$ 的常数。\n- 杂质径向通量的本构关系是扩散和对流之和，其中扩散系数为 $D_Z(r)$，单位为 $\\mathrm{m}^2/\\mathrm{s}$，对流速度为 $V_Z(r)$，单位为 $\\mathrm{m}/\\mathrm{s}$。\n\n定义和要求：\n- 芯部杂质集聚因子应以无量纲量的形式报告。该集聚因子定义为在内部芯区 $0 \\le r \\le r_c$（其中 $r_c = \\rho_c a$ 且 $0  \\rho_c  1$ 为归一化芯部半径）内，杂质对数密度梯度的面积加权平均值，并以小半径进行归一化。权重为圆柱截面积。形式上，杂质集聚因子为\n$$\n\\mathrm{PF}_{\\mathrm{core}} \\equiv - a \\,\\frac{\\int_{0}^{r_c} \\left(\\frac{1}{n_Z(r)}\\frac{d n_Z}{dr}\\right) r \\, dr}{\\int_{0}^{r_c} r \\, dr}.\n$$\n- 湍流引起的箍缩表示为对 $V_Z(r)$ 的一个附加的向内（负）贡献，其大小由无量纲箍缩幅度 $C_{\\mathrm{pinch}} \\ge 0$ 缩放。\n- 对湍流引起的箍缩的敏感度定义为 $\\mathrm{PF}_{\\mathrm{core}}$ 对 $C_{\\mathrm{pinch}}$ 的导数，通过使用小增量 $\\Delta C$ 的对称有限差分进行数值近似：\n$$\nS_{\\mathrm{pinch}} \\equiv \\frac{\\partial \\mathrm{PF}_{\\mathrm{core}}}{\\partial C_{\\mathrm{pinch}}} \\approx \\frac{\\mathrm{PF}_{\\mathrm{core}}(C_{\\mathrm{pinch}}+\\Delta C) - \\mathrm{PF}_{\\mathrm{core}}(C_{\\mathrm{pinch}}-\\Delta C)}{2\\,\\Delta C}.\n$$\n- 所有物理单位必须一致处理：$a$ 的单位是米，$r$ 的单位是米，$D_Z$ 的单位是 $\\mathrm{m}^2/\\mathrm{s}$，$V_Z$ 的单位是 $\\mathrm{m}/\\mathrm{s}$，而 $\\mathrm{PF}_{\\mathrm{core}}$ 和 $S_{\\mathrm{pinch}}$ 是无量纲的。\n\n给定的函数形式：\n- 杂质扩散系数剖面为\n$$\nD_Z(r) = D_0 \\left[1 + c_D \\left(\\frac{r}{a}\\right)^2\\right],\n$$\n其中 $D_0$ 是一个单位为 $\\mathrm{m}^2/\\mathrm{s}$ 的正常数，$c_D$ 是一个非负的无量纲剖面形状参数。\n- 杂质对流速度是类新经典项 $V_{\\mathrm{neo}}(r)$ 和湍流引起的箍缩项 $V_{\\mathrm{turb}}(r)$ 之和：\n$$\nV_Z(r) = V_{\\mathrm{neo}}(r) + V_{\\mathrm{turb}}(r),\n$$\n其中\n$$\nV_{\\mathrm{neo}}(r) = V_{n0}\\left(\\frac{r}{a}\\right),\n\\quad\nV_{\\mathrm{turb}}(r) = - C_{\\mathrm{pinch}}\\,\\frac{D_Z(r)}{a}\\left[1 - \\left(\\frac{r}{a}\\right)^2\\right],\n$$\n其中 $V_{n0}$ 的单位是 $\\mathrm{m}/\\mathrm{s}$，$C_{\\mathrm{pinch}} \\ge 0$ 是无量纲的。\n\n芯部通量条件：\n- 在建模的芯部区域，取杂质径向通量为零。在求解杂质剖面或其梯度时，应一致地使用此条件。\n\n计算内容：\n- 对于每个测试案例，使用上述定义和给定的函数形式计算 $\\mathrm{PF}_{\\mathrm{core}}$，并使用指定的 $\\Delta C$ 通过对称有限差分计算 $S_{\\mathrm{pinch}}$。\n\n数值方法要求：\n- 将芯部半径表示为 $r_c = \\rho_c a$。\n- 在计算 $\\mathrm{PF}_{\\mathrm{core}}$ 的平均积分中，使用与 $r$ 成正比的面积权重。\n- 在 $r \\in [0,r_c]$ 或归一化坐标 $\\rho \\equiv r/a \\in [0,\\rho_c]$ 上使用足够高分辨率的数值积分。\n\n测试套件：\n- 使用以下参数集。每个案例指定 $(a, \\rho_c, D_0, c_D, V_{n0}, C_{\\mathrm{pinch}}, \\Delta C)$。\n    - 案例1（理想情况，中等强度向内箍缩）：$a = 0.5\\,\\mathrm{m}$, $\\rho_c = 0.2$, $D_0 = 0.3\\,\\mathrm{m}^2/\\mathrm{s}$, $c_D = 0.2$, $V_{n0} = 0.3\\,\\mathrm{m}/\\mathrm{s}$, $C_{\\mathrm{pinch}} = 0.5$, $\\Delta C = 0.05$。\n    - 案例2（无箍缩基准）：$a = 0.5\\,\\mathrm{m}$, $\\rho_c = 0.2$, $D_0 = 0.3\\,\\mathrm{m}^2/\\mathrm{s}$, $c_D = 0.2$, $V_{n0} = 0.3\\,\\mathrm{m}/\\mathrm{s}$, $C_{\\mathrm{pinch}} = 0.0$, $\\Delta C = 0.05$。\n    - 案例3（强向内箍缩）：$a = 0.5\\,\\mathrm{m}$, $\\rho_c = 0.2$, $D_0 = 0.3\\,\\mathrm{m}^2/\\mathrm{s}$, $c_D = 0.2$, $V_{n0} = 0.3\\,\\mathrm{m}/\\mathrm{s}$, $C_{\\mathrm{pinch}} = 1.0$, $\\Delta C = 0.05$。\n    - 案例4（边界情况：零对流，无箍缩）：$a = 0.5\\,\\mathrm{m}$, $\\rho_c = 0.2$, $D_0 = 0.3\\,\\mathrm{m}^2/\\mathrm{s}$, $c_D = 0.2$, $V_{n0} = 0.0\\,\\mathrm{m}/\\mathrm{s}$, $C_{\\mathrm{pinch}} = 0.0$, $\\Delta C = 0.05$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试案例，输出两个浮点数：首先是 $\\mathrm{PF}_{\\mathrm{core}}$，然后是 $S_{\\mathrm{pinch}}$。最终输出必须按以下顺序排列\n$$\n[\\mathrm{PF}_1, S_1, \\mathrm{PF}_2, S_2, \\mathrm{PF}_3, S_3, \\mathrm{PF}_4, S_4],\n$$\n其中 $\\mathrm{PF}_i$ 和 $S_i$ 对应于案例 $i$。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题设定良好且客观。它提出了一个标准但简化的聚变等离子体中杂质输运模型，该模型是可形式化和可解的。所有必要的数据和定义都已提供，并且没有内部矛盾。\n\n求解过程首先推导了目标量——芯部杂质集聚因子 $\\mathrm{PF}_{\\mathrm{core}}$ 的解析表达式。这种方法优于纯数值方法，因为它在模型内部提供了精确解，从而消除了数值积分误差。\n\n核心指导原则是稳态、无源的连续性方程。在给定条件下，这意味着在芯部区域（即 $r \\in [0, r_c]$）内，杂质径向粒子通量为零，即 $\\Gamma_Z(r) = 0$。通量的本构关系如下：\n$$\n\\Gamma_Z(r) = -D_Z(r) \\frac{d n_Z}{dr} + V_Z(r) n_Z(r)\n$$\n设 $\\Gamma_Z(r) = 0$，我们可以解出对数密度梯度，这是集聚因子定义中的一个关键组成部分：\n$$\n\\frac{1}{n_Z(r)}\\frac{d n_Z}{dr} = \\frac{V_Z(r)}{D_Z(r)}\n$$\n问题给出了扩散系数 $D_Z(r)$ 和对流速度 $V_Z(r)$ 的函数形式。代入这些形式，得到对数梯度作为半径 $r$ 的函数：\n$$\n\\frac{1}{n_Z(r)}\\frac{d n_Z}{dr} = \\frac{V_{\\mathrm{neo}}(r) + V_{\\mathrm{turb}}(r)}{D_Z(r)} = \\frac{V_{n0}\\left(\\frac{r}{a}\\right)}{D_0 \\left[1 + c_D \\left(\\frac{r}{a}\\right)^2\\right]} + \\frac{- C_{\\mathrm{pinch}}\\,\\frac{D_Z(r)}{a}\\left[1 - \\left(\\frac{r}{a}\\right)^2\\right]}{D_Z(r)}\n$$\n简化后得到：\n$$\n\\frac{1}{n_Z(r)}\\frac{d n_Z}{dr} = \\frac{V_{n0}}{D_0} \\frac{r/a}{1 + c_D (r/a)^2} - \\frac{C_{\\mathrm{pinch}}}{a}\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)\n$$\n芯部杂质集聚因子 $\\mathrm{PF}_{\\mathrm{core}}$ 定义为该梯度在芯区 $r \\in [0, r_c]$ 上的面积加权平均值：\n$$\n\\mathrm{PF}_{\\mathrm{core}} \\equiv - a \\,\\frac{\\int_{0}^{r_c} \\left(\\frac{1}{n_Z(r)}\\frac{d n_Z}{dr}\\right) r \\, dr}{\\int_{0}^{r_c} r \\, dr}\n$$\n分母是一个简单的积分：$\\int_{0}^{r_c} r \\, dr = \\frac{r_c^2}{2}$。我们将对数梯度的表达式代入分子。为了便于积分，我们引入归一化径向坐标 $\\rho = r/a$，芯部边界为 $\\rho_c = r_c/a$。通过此变量替换（$r = a\\rho$, $dr = a\\,d\\rho$），集聚因子变为：\n$$\n\\mathrm{PF}_{\\mathrm{core}} = - a \\frac{2}{(a\\rho_c)^2} \\int_{0}^{\\rho_c} \\left[ \\frac{V_{n0}}{D_0} \\frac{\\rho}{1+c_D\\rho^2} - \\frac{C_{\\mathrm{pinch}}}{a}(1-\\rho^2) \\right] (a\\rho) (a\\,d\\rho)\n$$\n经过代数简化，表达式分为两项，分别对应于新经典输运和湍流输运的贡献：\n$$\n\\mathrm{PF}_{\\mathrm{core}} = -\\frac{2a V_{n0}}{D_0 \\rho_c^2} \\int_{0}^{\\rho_c} \\frac{\\rho^2}{1+c_D\\rho^2} \\,d\\rho + \\frac{2 C_{\\mathrm{pinch}}}{\\rho_c^2} \\int_{0}^{\\rho_c} (\\rho-\\rho^3) \\,d\\rho\n$$\n我们将这两个积分定义为 $I_1$ 和 $I_2$：\n$$\nI_1 = \\int_{0}^{\\rho_c} \\frac{\\rho^2}{1+c_D\\rho^2} \\,d\\rho \\quad \\text{and} \\quad I_2 = \\int_{0}^{\\rho_c} (\\rho-\\rho^3) \\,d\\rho\n$$\n这两个定积分可以解析求解。\n对于 $I_2$：\n$$\nI_2 = \\left[ \\frac{\\rho^2}{2} - \\frac{\\rho^4}{4} \\right]_0^{\\rho_c} = \\frac{\\rho_c^2}{2} - \\frac{\\rho_c^4}{4}\n$$\n对于 $I_1$，我们首先考虑 $c_D  0$ 的情况：\n$$\nI_1 = \\int_{0}^{\\rho_c} \\frac{1}{c_D}\\left(1 - \\frac{1}{1+c_D\\rho^2}\\right) d\\rho = \\frac{1}{c_D} \\left[\\rho - \\frac{1}{\\sqrt{c_D}}\\arctan(\\sqrt{c_D}\\rho)\\right]_0^{\\rho_c} = \\frac{1}{c_D}\\left(\\rho_c - \\frac{\\arctan(\\sqrt{c_D}\\rho_c)}{\\sqrt{c_D}}\\right)\n$$\n在 $c_D = 0$ 的特殊情况下，该积分简化为 $I_1 = \\int_0^{\\rho_c} \\rho^2 d\\rho = \\rho_c^3/3$。\n综合这些结果，集聚因子的解析表达式为：\n$$\n\\mathrm{PF}_{\\mathrm{core}} = -\\frac{2a V_{n0}}{D_0 \\rho_c^2} I_1 + \\frac{2 C_{\\mathrm{pinch}}}{\\rho_c^2} I_2\n$$\n该公式被用于实现 $\\mathrm{PF}_{\\mathrm{core}}$ 的计算。\n\n敏感度 $S_{\\mathrm{pinch}}$ 使用给定的对称有限差分公式进行数值计算：\n$$\nS_{\\mathrm{pinch}} = \\frac{\\mathrm{PF}_{\\mathrm{core}}(C_{\\mathrm{pinch}}+\\Delta C) - \\mathrm{PF}_{\\mathrm{core}}(C_{\\mathrm{pinch}}-\\Delta C)}{2\\,\\Delta C}\n$$\n这需要计算在 $C_{\\mathrm{pinch}} + \\Delta C$ 和 $C_{\\mathrm{pinch}} - \\Delta C$ 处的集聚因子。由于 $\\mathrm{PF}_{\\mathrm{core}}$ 是 $C_{\\mathrm{pinch}}$ 的线性函数，该数值导数将是精确的，并等于解析导数 $\\partial \\mathrm{PF}_{\\mathrm{core}}/\\partial C_{\\mathrm{pinch}} = \\frac{2 I_2}{\\rho_c^2} = 1 - \\frac{\\rho_c^2}{2}$。对于所有 $\\rho_c = 0.2$ 的测试案例，敏感度预期为 $1 - 0.2^2/2 = 0.98$。\n\n最终的Python代码在一个函数中实现了这些解析公式，该函数被每个测试案例调用以计算 $\\mathrm{PF}_{\\mathrm{core}}$ 和 $S_{\\mathrm{pinch}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the impurity transport problem for a suite of test cases.\n    \"\"\"\n\n    # Test suite: (a, rho_c, D0, cD, Vn0, C_pinch, delta_C)\n    test_cases = [\n        # Case 1 (happy path, moderate inward pinch)\n        (0.5, 0.2, 0.3, 0.2, 0.3, 0.5, 0.05),\n        # Case 2 (no pinch baseline)\n        (0.5, 0.2, 0.3, 0.2, 0.3, 0.0, 0.05),\n        # Case 3 (strong inward pinch)\n        (0.5, 0.2, 0.3, 0.2, 0.3, 1.0, 0.05),\n        # Case 4 (edge case: zero convection, no pinch)\n        (0.5, 0.2, 0.3, 0.2, 0.0, 0.0, 0.05),\n    ]\n\n    results = []\n\n    def _calculate_pf_core(params):\n        \"\"\"\n        Calculates the core impurity peaking factor based on derived analytical solution.\n        \n        Args:\n            params (tuple): A tuple containing the physical parameters:\n                            (a, rhoc, D0, cD, Vn0, C_pinch)\n        \n        Returns:\n            float: The dimensionless core impurity peaking factor PF_core.\n        \"\"\"\n        a, rhoc, D0, cD, Vn0, C_pinch = params\n\n        # Integral I1: term related to neoclassical convection\n        if cD == 0.0:\n            # Special case for constant diffusion coefficient\n            I1 = rhoc**3 / 3.0\n        else:\n            # General case for radially varying diffusion coefficient\n            sqrt_cD = np.sqrt(cD)\n            I1 = (1.0 / cD) * (rhoc - (1.0 / sqrt_cD) * np.arctan(sqrt_cD * rhoc))\n\n        # Integral I2: term related to turbulent pinch\n        I2 = rhoc**2 / 2.0 - rhoc**4 / 4.0\n\n        # Contribution from the neoclassical term\n        # The problem states D0 is a positive constant, so no check for D0=0 needed for test cases.\n        term_neo = - (2.0 * a * Vn0) / (D0 * rhoc**2) * I1\n        \n        # Contribution from the turbulent pinch term\n        term_turb = (2.0 * C_pinch) / (rhoc**2) * I2\n\n        pf_core = term_neo + term_turb\n        return pf_core\n\n    for case in test_cases:\n        a, rhoc, D0, cD, Vn0, C_pinch, delta_C = case\n\n        # Calculate PF_core for the nominal C_pinch\n        params_nom = (a, rhoc, D0, cD, Vn0, C_pinch)\n        pf = _calculate_pf_core(params_nom)\n        \n        # Calculate PF_core for C_pinch + delta_C\n        params_plus = (a, rhoc, D0, cD, Vn0, C_pinch + delta_C)\n        pf_plus = _calculate_pf_core(params_plus)\n\n        # Calculate PF_core for C_pinch - delta_C\n        params_minus = (a, rhoc, D0, cD, Vn0, C_pinch - delta_C)\n        pf_minus = _calculate_pf_core(params_minus)\n        \n        # Calculate sensitivity S_pinch using symmetric finite difference\n        S_pinch = (pf_plus - pf_minus) / (2.0 * delta_C)\n        \n        results.extend([pf, S_pinch])\n\n    # Final print statement in the exact required format.\n    # Use f-string with general format 'g' to avoid trailing zeros and use scientific notation if needed.\n    print(f\"[{','.join(f'{r:g}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在复杂的集成建模工作流中，高保真度的物理模型（如回旋动理学模拟）虽然精确，但计算成本极高。为了实现快速和大规模的模拟，我们常常使用计算上更高效的“代理”模型（surrogate models）。本练习的核心在于评估一个简化代理模型的准确性，通过将其预测的全局能量约束时间 $\\tau_E$ 与更完整的模型进行比较，来判断代理模型在何种物理条件下会失效。这揭示了在实际集成建模工作中，模型简化与验证之间重要的权衡过程。",
            "id": "3997054",
            "problem": "考虑一个用于托卡马克等离子体的零维集成建模工作流，该工作流结合了全局能量平衡和输运闭合。全局能量约束时间 $\\tau_E$ 是通过准稳态下的能量平衡来定义的。目的是将有效热扩散系数的全回旋动理学 (GK) 耦合模型与一个简化代理模型进行比较，计算由此产生的全局约束时间误差，并划分代理模型失效的工况区间。\n\n从以下基本定律和定义开始：\n- 全局热能含量为 $W = \\frac{3}{2} n V k_B (T_e + T_i)$，其中 $n$ 是体平均密度，$V$ 是等离子体体积，$k_B$ 是玻尔兹曼常数，$T_e$、$T_i$ 分别是电子和离子温度。通过能量含量 $W$，温度被处理为组合标量 $T_e + T_i$。\n- 传导热通量遵循傅里叶定律 $q = - n c \\chi \\nabla T$，其中 $c$ 是单粒子比热，$\\chi$ 是代表湍流输运的有效热扩散系数。\n- 对于大环径比环体，等离子体体积和表面积分别为 $V = 2 \\pi^2 R a^2$ 和 $S = 4 \\pi^2 R a$，其中 $R$ 是大半径，$a$ 是小半径。\n- 在准稳态下，能量平衡为 $P_{\\text{in}} = P_{\\text{cond}} + P_{\\text{rad}}$，其中 $P_{\\text{in}}$ 是外部加热功率，$P_{\\text{rad}}$ 是辐射损失功率。全局能量约束时间为 $\\tau_E = W / P_{\\text{loss}}$，在稳态下 $P_{\\text{loss}} = P_{\\text{in}}$。\n\n假设以下集成闭合：\n- 设传导损失功率为 $P_{\\text{cond}} = S \\, n \\, (3 k_B) \\, \\chi_{\\text{eff}} \\, \\frac{T_e + T_i}{a}$，这与傅里葉定律和环形几何一致，其中 $3 k_B$ 是电子和离子的组合单粒子比热。\n- 假设输入功率的辐射份额 $f_{\\text{rad}}$ 是固定的，因此 $P_{\\text{rad}} = f_{\\text{rad}} P_{\\text{in}}$，其中 $0 \\le f_{\\text{rad}}  1$。\n- 在这些假设下，通过 $W$ 消去 $(T_e + T_i)$ 可得出稳态全局约束时间\n$$\n\\tau_E = \\frac{W}{P_{\\text{in}}} = (1 - f_{\\text{rad}})\\,\\frac{a V}{2 S \\, \\chi_{\\text{eff}}}.\n$$\n此公式将 $\\tau_E$ 完全用几何形状、辐射份额和有效热扩散系数 $\\chi_{\\text{eff}}$ 来表示。\n\n定义由两种闭合预测的有效热扩散系数：\n1. 全回旋动理学耦合模型 (GK):\n$$\n\\chi_{\\text{GK}} = \\chi_{\\text{ref}} \\left(\\frac{\\rho_*}{\\rho_{*,\\text{ref}}}\\right)^{\\alpha} \\left(\\frac{\\nu_*}{\\nu_{*,\\text{ref}}}\\right)^{\\delta} \\left(1 + c_{\\beta} \\frac{\\beta}{\\beta_{\\text{ref}}}\\right)\\;+\\;\\chi_{\\text{EM}} \\left(\\frac{\\beta}{\\beta_{\\text{ref}}}\\right)^{2}\\;+\\;\\chi_{\\text{grad}} \\left[\\max\\left(0, \\frac{R}{L_T} - \\kappa_c\\right)\\right]^p,\n$$\n其中 $\\rho_*$ 是归一化离子回旋半径，$\\beta$ 是等离子体贝塔值，$\\nu_*$ 是归一化碰撞率，$R/L_T$ 是归一化温度梯度。\n2. 简化代理模型:\n$$\n\\chi_{\\text{surr}} = \\chi_{\\text{ref}} \\left(\\frac{\\rho_*}{\\rho_{*,\\text{ref}}}\\right)^{\\alpha} \\left(\\frac{\\nu_*}{\\nu_{*,\\text{ref}}}\\right)^{\\delta}\\;+\\;\\chi_{\\text{grad}} \\left[\\max\\left(0, \\frac{R}{L_T} - \\kappa_c\\right)\\right]^p,\n$$\n该模型忽略了显式的电磁增强项。\n\n两个模型使用以下常数：\n- $\\chi_{\\text{ref}} = 0.5\\,\\text{m}^2/\\text{s}$，$\\rho_{*,\\text{ref}} = 1\\times 10^{-3}$，$\\nu_{*,\\text{ref}} = 0.3$，$\\beta_{\\text{ref}} = 0.01$，$c_{\\beta} = 0.6$，$\\chi_{\\text{EM}} = 0.1\\,\\text{m}^2/\\text{s}$，$\\chi_{\\text{grad}} = 0.3\\,\\text{m}^2/\\text{s}$，$\\kappa_c = 3.0$，$p = 2.0$，$\\alpha = 1.0$，$\\delta = 0.5$。\n- 玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}\\,\\text{J}/\\text{K}$，但它在上面给出的 $\\tau_E$ 最终表达式中被约掉，因此在数值计算中不需要。\n\n对于每个测试用例，计算：\n- 使用 $\\chi_{\\text{GK}}$ 计算的 $\\tau_{E,\\text{GK}}$（单位：秒）。\n- 使用 $\\chi_{\\text{surr}}$ 计算的 $\\tau_{E,\\text{surr}}$（单位：秒）。\n- 相对误差 $\\epsilon = \\left|\\tau_{E,\\text{surr}} - \\tau_{E,\\text{GK}}\\right| / \\tau_{E,\\text{GK}}$，以小数表示。\n- 一个失效布尔值，定义为 $\\epsilon  \\epsilon_{\\text{th}}$，其中 $\\epsilon_{\\text{th}} = 0.25$。\n\n所有 $\\tau_E$ 值以秒为单位表示。相对误差 $\\epsilon$ 以小数表示。不涉及角度。每个用例的输出必须是一个包含四个元素的列表 $[\\tau_{E,\\text{GK}}, \\tau_{E,\\text{surr}}, \\epsilon, \\text{fail}]$。\n\n使用环形几何公式 $V = 2 \\pi^2 R a^2$ 和 $S = 4 \\pi^2 R a$。每个用例的输入参数为 $(R, a, n, P_{\\text{in}}, f_{\\text{rad}}, \\rho_*, \\beta, \\nu_*, R/L_T, B)$，其中 $B$ 是磁场强度（单位为特斯拉），但在这些闭合模型中，$B$ 不被直接使用，提供它是为了信息的完整性。\n\n测试套件参数值：\n- 用例 1 (标称离子温度梯度工况): $R = 3.0\\,\\text{m}$，$a = 0.6\\,\\text{m}$，$n = 8.0 \\times 10^{19}\\,\\text{m}^{-3}$，$P_{\\text{in}} = 1.5 \\times 10^{7}\\,\\text{W}$，$f_{\\text{rad}} = 0.2$，$\\rho_* = 2.0 \\times 10^{-3}$，$\\beta = 0.01$，$\\nu_* = 0.3$，$R/L_T = 6.0$，$B = 5.3\\,\\text{T}$。\n- 用例 2 (高电磁活动): $R = 6.0\\,\\text{m}$，$a = 0.9\\,\\text{m}$，$n = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$，$P_{\\text{in}} = 2.5 \\times 10^{7}\\,\\text{W}$，$f_{\\text{rad}} = 0.3$，$\\rho_* = 1.0 \\times 10^{-3}$，$\\beta = 0.04$，$\\nu_* = 0.2$，$R/L_T = 5.0$，$B = 5.0\\,\\text{T}$。\n- 用例 3 (近阈值低梯度): $R = 1.65\\,\\text{m}$，$a = 0.5\\,\\text{m}$，$n = 6.0 \\times 10^{19}\\,\\text{m}^{-3}$，$P_{\\text{in}} = 8.0 \\times 10^{6}\\,\\text{W}$，$f_{\\text{rad}} = 0.1$，$\\rho_* = 3.0 \\times 10^{-3}$，$\\beta = 0.005$，$\\nu_* = 0.5$，$R/L_T = 2.9$，$B = 2.5\\,\\text{T}$。\n- 用例 4 (高碰撞率和强梯度): $R = 2.8\\,\\text{m}$，$a = 0.8\\,\\text{m}$，$n = 1.5 \\times 10^{20}\\,\\text{m}^{-3}$，$P_{\\text{in}} = 1.2 \\times 10^{7}\\,\\text{W}$，$f_{\\text{rad}} = 0.5$，$\\rho_* = 5.0 \\times 10^{-4}$，$\\beta = 0.015$，$\\nu_* = 1.5$，$R/L_T = 7.0$，$B = 3.0\\,\\text{T}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是上面描述的特定用例的列表，例如 $[[\\tau_{E,1}^{\\text{GK}},\\tau_{E,1}^{\\text{surr}},\\epsilon_1,\\text{fail}_1],[\\tau_{E,2}^{\\text{GK}},\\tau_{E,2}^{\\text{surr}},\\epsilon_2,\\text{fail}_2],\\dots]$，打印输出中不含空格。所有数值输出必须是浮点数（$\\tau_E$ 以秒为单位，$\\epsilon$ 为小数），失效标志为布尔值。",
            "solution": "问题陈述已经过严格验证，并被确定为计算等离子体物理领域中一个有效、自洽且有科学依据的问题。所有必需的常数、参数和物理模型均已提供，并且与聚变科学的既定原理一致。该问题是适定的，并且可以通过算法确定唯一解。\n\n核心任务是使用两种不同的有效热扩散系数 $\\chi_{\\text{eff}}$ 理论模型，评估和比较托卡马克等离子体的全局能量约束时间 $\\tau_E$。第一个模型 $\\chi_{\\text{GK}}$ 代表一个更完整、包含电磁效应的基于回旋动理学的公式，而第二个模型 $\\chi_{\\text{surr}}$ 是一个忽略了这些效应的简化代理模型。这种比较是集成建模中的一种常见做法，用于评估简化、计算成本更低的模型的有效范围。\n\n首先，我们从所提供的零维稳态模型中建立全局能量约束时间 $\\tau_E$ 的公式。能量平衡由 $P_{\\text{in}} = P_{\\text{cond}} + P_{\\text{rad}}$ 给出。将辐射功率份额定义为 $P_{\\text{rad}} = f_{\\text{rad}} P_{\\text{in}}$，则传导功率损失为 $P_{\\text{cond}} = (1 - f_{\\text{rad}}) P_{\\text{in}}$。全局能量约束时间定义为 $\\tau_E = W / P_{\\text{in}}$，其中 $W$ 是总等离子体热能，$W = \\frac{3}{2} n V k_B (T_e + T_i)$。问题提供了基于环形几何中傅里叶定律的传導功率閉合：$P_{\\text{cond}} = S \\, n \\, (3 k_B) \\, \\chi_{\\text{eff}} \\, \\frac{T_e + T_i}{a}$。\n\n通过令 $P_{\\text{cond}}$ 的两个表达式相等，我们得到：\n$$\n(1 - f_{\\text{rad}}) P_{\\text{in}} = S \\, n \\, (3 k_B) \\, \\chi_{\\text{eff}} \\, \\frac{T_e + T_i}{a}\n$$\n根据 $W$ 的定义，我们可以将组合温度项表示为 $k_B(T_e + T_i) = \\frac{2W}{3nV}$。将此代入能量平衡方程可得：\n$$\n(1 - f_{\\text{rad}}) P_{\\text{in}} = S \\, n \\, 3 \\, \\chi_{\\text{eff}} \\, \\frac{1}{a} \\left( \\frac{2W}{3nV} \\right) = \\frac{2 S \\chi_{\\text{eff}} W}{aV}\n$$\n重新整理此方程以求解比率 $W/P_{\\text{in}}$，直接得到 $\\tau_E$ 的表达式：\n$$\n\\tau_E = \\frac{W}{P_{\\text{in}}} = (1 - f_{\\text{rad}}) \\frac{aV}{2S\\chi_{\\text{eff}}}\n$$\n问题指定了大环径比环体的几何形状：等离子体体积 $V = 2 \\pi^2 R a^2$ 和表面积 $S = 4 \\pi^2 R a$。将这些代入 $\\tau_E$ 的表达式中可得到显著简化：\n$$\n\\tau_E = (1 - f_{\\text{rad}}) \\frac{a(2 \\pi^2 R a^2)}{2(4 \\pi^2 R a)\\chi_{\\text{eff}}} = (1 - f_{\\text{rad}}) \\frac{2 \\pi^2 R a^3}{8 \\pi^2 R a \\chi_{\\text{eff}}} = (1 - f_{\\text{rad}}) \\frac{a^2}{4\\chi_{\\text{eff}}}\n$$\n这个简化公式是我们计算的基础。它揭示了在这个零维模型中，$\\tau_E$ 僅取決於小半徑 $a$、辐射份额 $f_{\\text{rad}}$ 和有效热扩散系数 $\\chi_{\\text{eff}}$。\n\n接下来，我们定义 $\\chi_{\\text{eff}}$ 的两个模型。全回旋动理学模型为：\n$$\n\\chi_{\\text{GK}} = \\chi_{\\text{ref}} \\left(\\frac{\\rho_*}{\\rho_{*,\\text{ref}}}\\right)^{\\alpha} \\left(\\frac{\\nu_*}{\\nu_{*,\\text{ref}}}\\right)^{\\delta} \\left(1 + c_{\\beta} \\frac{\\beta}{\\beta_{\\text{ref}}}\\right)\\;+\\;\\chi_{\\text{EM}} \\left(\\frac{\\beta}{\\beta_{\\text{ref}}}\\right)^{2}\\;+\\;\\chi_{\\text{grad}} \\left[\\max\\left(0, \\frac{R}{L_T} - \\kappa_c\\right)\\right]^p\n$$\n简化代理模型为：\n$$\n\\chi_{\\text{surr}} = \\chi_{\\text{ref}} \\left(\\frac{\\rho_*}{\\rho_{*,\\text{ref}}}\\right)^{\\alpha} \\left(\\frac{\\nu_*}{\\nu_{*,\\text{ref}}}\\right)^{\\delta}\\;+\\;\\chi_{\\text{grad}} \\left[\\max\\left(0, \\frac{R}{L_T} - \\kappa_c\\right)\\right]^p\n$$\n代理模型 $\\chi_{\\text{surr}}$ 忽略了依赖于等离子体贝塔值 $\\beta$ 的项，这些项代表电磁输运效应。两个模型之间的差异在于以下两项：\n$$\n\\chi_{\\text{GK}} - \\chi_{\\text{surr}} = \\left[\\chi_{\\text{ref}} \\left(\\frac{\\rho_*}{\\rho_{*,\\text{ref}}}\\right)^{\\alpha} \\left(\\frac{\\nu_*}{\\nu_{*,\\text{ref}}}\\right)^{\\delta}\\right] \\left(c_{\\beta} \\frac{\\beta}{\\beta_{\\text{ref}}}\\right) + \\chi_{\\text{EM}} \\left(\\frac{\\beta}{\\beta_{\\text{ref}}}\\right)^{2}\n$$\n\n每个测试用例的计算步骤如下：\n1.  对于一组给定的参数 $(a, f_{\\text{rad}}, \\rho_*, \\beta, \\nu_*, R/L_T)$，使用各自的公式和提供的物理常数计算 $\\chi_{\\text{GK}}$ 和 $\\chi_{\\text{surr}}$。\n2.  使用推导出的公式 $\\tau_E = (1 - f_{\\text{rad}}) a^2 / (4\\chi_{\\text{eff}})$ 计算约束时间 $\\tau_{E,\\text{GK}}$ 和 $\\tau_{E,\\text{surr}}$。\n3.  计算相对误差 $\\epsilon = |\\tau_{E,\\text{surr}} - \\tau_{E,\\text{GK}}| / \\tau_{E,\\text{GK}}$。\n4.  确定布尔失效标志 $\\text{fail} = (\\epsilon  \\epsilon_{\\text{th}})$，其中阈值给定为 $\\epsilon_{\\text{th}} = 0.25$。\n5.  为每个测试用例收集四个结果值 $[\\tau_{E,\\text{GK}}, \\tau_{E,\\text{surr}}, \\epsilon, \\text{fail}]$。\n此过程将对所有提供的测试用例执行。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plasma confinement time problem for the given test cases.\n    \"\"\"\n    \n    # Define the constants for the thermal diffusivity models.\n    constants = {\n        'chi_ref': 0.5,      # m^2/s\n        'rho_star_ref': 1e-3,\n        'nu_star_ref': 0.3,\n        'beta_ref': 0.01,\n        'c_beta': 0.6,\n        'chi_EM': 0.1,       # m^2/s\n        'chi_grad': 0.3,     # m^2/s\n        'kappa_c': 3.0,\n        'p': 2.0,\n        'alpha': 1.0,\n        'delta': 0.5,\n    }\n    \n    # Threshold for surrogate model failure\n    epsilon_th = 0.25\n\n    # Define the test cases from the problem statement.\n    # Format: (R, a, n, P_in, f_rad, rho_star, beta, nu_star, R_L_T, B)\n    test_cases = [\n        # Case 1: nominal ion temperature gradient regime\n        (3.0, 0.6, 8.0e19, 1.5e7, 0.2, 2.0e-3, 0.01, 0.3, 6.0, 5.3),\n        # Case 2: high electromagnetic activity\n        (6.0, 0.9, 1.0e20, 2.5e7, 0.3, 1.0e-3, 0.04, 0.2, 5.0, 5.0),\n        # Case 3: near-threshold low-gradient\n        (1.65, 0.5, 6.0e19, 8.0e6, 0.1, 3.0e-3, 0.005, 0.5, 2.9, 2.5),\n        # Case 4: high collisionality and strong gradients\n        (2.8, 0.8, 1.5e20, 1.2e7, 0.5, 5.0e-4, 0.015, 1.5, 7.0, 3.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        # Unpack parameters. Note that R, n, P_in, B are not used in the final simplified formula.\n        _R, a, _n, _P_in, f_rad, rho_star, beta, nu_star, R_L_T, _B = case\n\n        # 1. Calculate chi_surr\n        \n        # Base electrostatic gyro-Bohm term\n        base_term = constants['chi_ref'] * \\\n                    (rho_star / constants['rho_star_ref'])**constants['alpha'] * \\\n                    (nu_star / constants['nu_star_ref'])**constants['delta']\n        \n        # Critical gradient term\n        grad_term = constants['chi_grad'] * \\\n                    (max(0, R_L_T - constants['kappa_c']))**constants['p']\n        \n        chi_surr = base_term + grad_term\n\n        # 2. Calculate chi_GK\n        \n        # Additional electromagnetic terms for the GK model\n        em_term_1 = base_term * constants['c_beta'] * (beta / constants['beta_ref'])\n        em_term_2 = constants['chi_EM'] * (beta / constants['beta_ref'])**2\n        \n        chi_gk = chi_surr + em_term_1 + em_term_2\n\n        # 3. Calculate confinement times\n        \n        # The simplified formula for tau_E is (1 - f_rad) * a^2 / (4 * chi_eff)\n        # The geometric pre-factor is a^2 / 4\n        geo_factor = a**2 / 4.0\n        \n        tau_e_gk = (1.0 - f_rad) * geo_factor / chi_gk if chi_gk != 0 else float('inf')\n        tau_e_surr = (1.0 - f_rad) * geo_factor / chi_surr if chi_surr != 0 else float('inf')\n\n        # 4. Calculate relative error\n        \n        if tau_e_gk == 0:\n            epsilon = float('inf') if tau_e_surr != 0 else 0.0\n        else:\n            epsilon = abs(tau_e_surr - tau_e_gk) / tau_e_gk\n            \n        # 5. Determine failure flag\n        fail = epsilon > epsilon_th\n\n        all_results.append([tau_e_gk, tau_e_surr, epsilon, fail])\n\n    # Format the output string manually to ensure no spaces\n    case_strings = []\n    for res in all_results:\n        # str(True) -> 'True', str(False) -> 'False'. This is acceptable.\n        case_str = f\"[{res[0]},{res[1]},{res[2]},{str(res[3]).lower()}]\"\n        case_strings.append(case_str)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(case_strings)}]\")\n\nsolve()\n```"
        }
    ]
}