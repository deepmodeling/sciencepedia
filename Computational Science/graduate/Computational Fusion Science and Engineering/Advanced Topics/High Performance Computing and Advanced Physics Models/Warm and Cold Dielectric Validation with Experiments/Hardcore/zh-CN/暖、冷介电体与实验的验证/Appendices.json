{
    "hands_on_practices": [
        {
            "introduction": "这个练习连接了理论与实验。我们将从基本的流体动量方程出发，推导出一个包含热效应的等离子体电导率模型。通过将该模型的预测与假设的实验测量值进行比较，你将练习一项至关重要的等离子体诊断技能：从测量的电学特性中推断出如电子温度等物理参数。这个问题  展示了“温”等离子体修正如何解释与更简单的“冷”等离子体模型的偏差。",
            "id": "4063070",
            "problem": "一根均匀的、单电离的、低温等离子体柱，其电子数密度为 $n_{0}$，处在一个均匀背景磁场 $\\mathbf{B}_{0} = \\hat{\\mathbf{z}} B_{0}$ 中，并受到一个空间变化的时间谐波电场 $\\mathbf{E}(x,t) = \\Re\\{ \\hat{\\mathbf{x}} E_{0} \\exp(i k x - i \\omega t) \\}$ 的作用。低频区域满足 $|\\omega| \\ll \\omega_{pe}$，且离子运动可以忽略。电子与中性粒子的动量传递碰撞通过一个恒定的碰撞频率 $\\nu$ 来建模。一个实验在固定的角频率 $\\omega$ 和波数 $k$ 下测量了关联 $J_{x}$ 与 $E_{x}$ 的复电导率 $\\sigma_{xx}$。\n\n从包含碰撞和压力梯度力的线性化电子流体动量方程、电子连续性方程以及电子回旋（陀螺）频率 $\\Omega_{e}$ 的定义出发，推导一个用于横场复电导率 $\\sigma_{xx}(\\omega,k)$ 的类似Drude模型的低频响应模型，该模型：\n- 在热压力消失的极限下，简化为冷、磁化Drude响应，\n- 并且包含由波数为 $k$ 的纵向扰动所引起的等温电子压力梯度导致的主导暖等离子体修正项。\n\n然后，使用推导出的模型，在一个受控的冷等离子体实验中，用测得的复电导率验证冷等离子体预测，并推断出可以解释测量偏差的电子热能 $\\Theta_{e} = k_{B} T_{e}$（等温电子压力）。最后，以电子伏特为单位报告 $T_{e}$。\n\n假设：\n- 线性化电子动量方程有效，且压力为标量、等温压力 $p_{e} = n k_{B} T_{e}$，其中 $k_{B}$ 是玻尔兹曼常数，$T_{e}$ 是电子温度。\n- 连续性方程通过波数 $k$ 将密度和速度扰动耦合起来。\n- 测量的电导率是在横截面上进行空间平均的，并对应于 $x$ 分量 $\\sigma_{xx}$。\n\n给定参数：\n- $n_{0} = 1.0 \\times 10^{18}\\ \\mathrm{m}^{-3}$，\n- $B_{0} = 0.080\\ \\mathrm{T}$，\n- $\\nu = 6.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$，\n- 驱动频率 $f = 4.0 \\times 10^{6}\\ \\mathrm{Hz}$，因此 $\\omega = 2 \\pi f$，\n- 波数 $k = 1.20 \\times 10^{4}\\ \\mathrm{m}^{-1}$，\n- 电子电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{C}$，\n- 电子质量 $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\ \\mathrm{kg}$，\n- 玻尔兹曼常数 $k_{B} = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J/K}$，\n- 电子回旋频率 $\\Omega_{e} = e B_{0}/m_{e}$。\n\n在 $(\\omega,k)$ 处测得的复电导率：\n- $\\sigma_{xx}^{\\mathrm{meas}} = (2.258 \\times 10^{-3}) - i\\,(4.191 \\times 10^{-3})\\ \\mathrm{S/m}$。\n\n任务：\n1. 从第一性原理出发，推导一个包含碰撞、磁化以及波数为 $k$ 的沿 $x$ 方向的等温压力梯度响应的电子流体的横场电导率 $\\sigma_{xx}(\\omega,k)$ 的表达式。清晰地指出冷等离子体极限和暖等离子体修正的结构。\n2. 使用推导出的模型，为给定的参数计算冷等离子体预测值 $\\sigma_{xx}^{\\mathrm{cold}}$（令 $T_{e} \\to 0$）。\n3. 使用 $\\sigma_{xx}^{\\mathrm{meas}}$ 和你的模型，确定在等温暖等离子体修正下能够最好地解释 $\\sigma_{xx}^{\\mathrm{meas}}$ 和 $\\sigma_{xx}^{\\mathrm{cold}}$ 之间偏差的电子温度 $T_{e}$。以电子伏特表示最终的 $T_{e}$。将你的答案四舍五入到三位有效数字。\n\n以 $\\mathrm{eV}$ 为单位表示最终的 $T_{e}$。",
            "solution": "该问题要求推导横场电导率 $\\sigma_{xx}$ 的暖等离子体模型，用其验证冷等离子体预测，并从给定的测量值推断电子温度 $T_e$。\n\n### 步骤 1：问题验证\n\n对问题进行严格的验证过程。\n\n**1. 提取给定条件：**\n-   电子数密度：$n_{0} = 1.0 \\times 10^{18}\\ \\mathrm{m}^{-3}$\n-   背景磁场：$\\mathbf{B}_{0} = \\hat{\\mathbf{z}} B_{0}$，其中 $B_{0} = 0.080\\ \\mathrm{T}$\n-   电场扰动：$\\mathbf{E}(x,t) = \\Re\\{ \\hat{\\mathbf{x}} E_{0} \\exp(i k x - i \\omega t) \\}$\n-   电子-中性粒子碰撞频率：$\\nu = 6.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$\n-   驱动频率：$f = 4.0 \\times 10^{6}\\ \\mathrm{Hz}$，因此 $\\omega = 2 \\pi f$\n-   波数：$k = 1.20 \\times 10^{4}\\ \\mathrm{m}^{-1}$\n-   基本常数：$e$, $m_{e}$, $k_{B}$\n-   测量的复电导率：$\\sigma_{xx}^{\\mathrm{meas}} = (2.258 \\times 10^{-3}) - i\\,(4.191 \\times 10^{-3})\\ \\mathrm{S/m}$\n-   假设：线性化电子流体方程，单电离等离子体，忽略离子运动，标量等温压力 $p_{e} = n k_{B} T_{e}$。\n\n**2. 使用提取的给定条件进行验证：**\n-   **科学依据：** 该问题牢固地植根于等离子体物理的标准流体模型，这是该领域的基石。所使用的概念（Drude模型、回旋运动、压力梯度）是基础性的。\n-   **适定性：** 问题定义清晰，提供了足够的信息来推导模型并计算所要求的量。它能导出一个关于 $T_e$ 的唯一、稳定的解。\n-   **客观性：** 问题使用精确、无歧义的科学语言和定量数据陈述。\n-   **一致性检查：** 问题陈述 $|\\omega| \\ll \\omega_{pe}$。我们可以验证这一点。\n    $\\omega = 2\\pi(4.0 \\times 10^6\\ \\mathrm{s}^{-1}) \\approx 2.51 \\times 10^7\\ \\mathrm{rad/s}$。\n    电子等离子体频率为 $\\omega_{pe} = \\sqrt{n_0 e^2 / (\\epsilon_0 m_e)} \\approx \\sqrt{(10^{18})(1.6\\times 10^{-19})^2 / ((8.85\\times 10^{-12})(9.1\\times 10^{-31}))} \\approx 5.6 \\times 10^{10}\\ \\mathrm{rad/s}$。\n    条件 $2.51 \\times 10^7 \\ll 5.6 \\times 10^{10}$ 得到满足。所有参数对于实验室等离子体都是物理上现实的。\n\n**3. 结论与行动：**\n问题陈述在科学上是合理的、自洽的且适定的。验证通过。我们开始求解。\n\n### 任务 1：暖等离子体电导率 $\\sigma_{xx}(\\omega, k)$ 的推导\n\n我们从电子流体的线性化动量方程开始：\n$$m_e n_0 \\frac{\\partial \\mathbf{v}_{e1}}{\\partial t} = -n_0 e (\\mathbf{E}_1 + \\mathbf{v}_{e1} \\times \\mathbf{B}_0) - \\nabla p_{e1} - m_e n_0 \\nu \\mathbf{v}_{e1}$$\n其中下标 '1' 表示一阶扰动量。对于形式为 $\\exp(i k x - i \\omega t)$ 的时间谐波扰动，微分算子变为 $\\frac{\\partial}{\\partial t} \\to -i\\omega$ 和 $\\nabla \\to i \\mathbf{k} = i k \\hat{\\mathbf{x}}$。\n\n动量方程变为：\n$$-i\\omega m_e n_0 \\mathbf{v}_{e1} = -n_0 e (\\mathbf{E}_1 + \\mathbf{v}_{e1} \\times \\mathbf{B}_0) - i k \\hat{\\mathbf{x}} p_{e1} - m_e n_0 \\nu \\mathbf{v}_{e1}$$\n两边除以 $n_0$ 并重新整理得到：\n$$m_e(\\nu - i\\omega)\\mathbf{v}_{e1} + e(\\mathbf{v}_{e1} \\times \\mathbf{B}_0) = -e\\mathbf{E}_1 - \\frac{i k \\hat{\\mathbf{x}} p_{e1}}{n_0}$$\n当 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 且 $\\mathbf{v}_{e1} = v_{x}\\hat{\\mathbf{x}} + v_{y}\\hat{\\mathbf{y}}$ 时，叉积为 $e(\\mathbf{v}_{e1} \\times \\mathbf{B}_0) = eB_0(v_y \\hat{\\mathbf{x}} - v_x \\hat{\\mathbf{y}})$。我们将电子回旋频率定义为 $\\Omega_e = eB_0/m_e$。分量方程为：\n$$x: \\quad m_e(\\nu-i\\omega)v_x + m_e\\Omega_e v_y = -eE_x - \\frac{ik p_{e1}}{n_0}$$\n$$y: \\quad m_e(\\nu-i\\omega)v_y - m_e\\Omega_e v_x = 0$$\n压力扰动 $p_{e1}$ 通过等温假设与密度扰动 $n_{e1}$ 相关，$p_{e1} = n_{e1} k_B T_e$。密度扰动由线性化连续性方程得出：\n$$\\frac{\\partial n_{e1}}{\\partial t} + \\nabla \\cdot (n_0 \\mathbf{v}_{e1}) = 0 \\implies -i\\omega n_{e1} + i n_0 k v_x = 0$$\n这给出 $n_{e1} = \\frac{n_0 k}{\\omega}v_x$。于是压力梯度项为：\n$$\\frac{ik p_{e1}}{n_0} = \\frac{ik}{n_0}(n_{e1} k_B T_e) = \\frac{ik}{n_0} \\left(\\frac{n_0 k v_x}{\\omega}\\right) k_B T_e = i \\frac{k^2 k_B T_e}{\\omega} v_x$$\n将此代入x方向的动量方程：\n$$m_e(\\nu-i\\omega)v_x + m_e\\Omega_e v_y = -eE_x - i \\frac{k^2 k_B T_e}{\\omega} v_x$$\n从y方向的动量方程，我们得到 $v_y = \\frac{\\Omega_e}{\\nu-i\\omega}v_x$。将其代入修正后的x方向动量方程得到：\n$$v_x \\left[ m_e(\\nu-i\\omega) + \\frac{m_e \\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 k_B T_e}{\\omega} \\right] = -eE_x$$\n电流密度为 $J_x = -n_0 e v_x$，电导率为 $\\sigma_{xx} = J_x/E_x$。因此：\n$$\\sigma_{xx}(\\omega, k) = \\frac{n_0 e^2}{m_e(\\nu-i\\omega) + \\frac{m_e \\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 k_B T_e}{\\omega}}$$\n将电子热速度的平方定义为 $v_{th,e}^2 = k_B T_e / m_e$，我们得到模型的最终形式：\n$$\\sigma_{xx}(\\omega, k) = \\frac{n_0 e^2/m_e}{(\\nu-i\\omega) + \\frac{\\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 v_{th,e}^2}{\\omega}}$$\n**冷等离子体极限：** 在 $T_e \\to 0$ 极限下，我们有 $v_{th,e} \\to 0$，表达式简化为冷、磁化Drude响应：\n$$\\sigma_{xx}^{\\mathrm{cold}} = \\frac{n_0 e^2/m_e}{(\\nu-i\\omega) + \\frac{\\Omega_e^2}{\\nu-i\\omega}} = \\frac{n_0 e^2}{m_e} \\frac{\\nu-i\\omega}{(\\nu-i\\omega)^2 + \\Omega_e^2}$$\n**暖等离子体修正：** 暖等离子体修正是分母中的 $i \\frac{k^2 v_{th,e}^2}{\\omega}$ 项，它源于电子压力梯度。\n\n### 任务 2：冷等离子体预测值 $\\sigma_{xx}^{\\mathrm{cold}}$\n\n我们计算所需的物理参数：\n-   $\\omega = 2\\pi f = 2\\pi (4.0 \\times 10^6\\ \\mathrm{s}^{-1}) \\approx 2.5133 \\times 10^7\\ \\mathrm{rad/s}$\n-   $\\nu = 6.0 \\times 10^7\\ \\mathrm{s}^{-1}$\n-   $\\Omega_e = \\frac{eB_0}{m_e} = \\frac{(1.6022 \\times 10^{-19}\\ \\mathrm{C})(0.080\\ \\mathrm{T})}{9.1094 \\times 10^{-31}\\ \\mathrm{kg}} \\approx 1.4071 \\times 10^{10}\\ \\mathrm{rad/s}$\n\n由于 $\\Omega_e \\gg \\omega, \\nu$，$\\sigma_{xx}^{\\mathrm{cold}}$ 的分母可以近似为 $(\\nu-i\\omega)^2 + \\Omega_e^2 \\approx \\Omega_e^2$。\n$$\\sigma_{xx}^{\\mathrm{cold}} \\approx \\frac{n_0 e^2}{m_e} \\frac{\\nu-i\\omega}{\\Omega_e^2} = \\frac{n_0 e^2}{m_e} \\frac{\\nu-i\\omega}{(eB_0/m_e)^2} = \\frac{n_0 m_e}{B_0^2}(\\nu - i\\omega)$$\n计算前置因子：\n$$\\frac{n_0 m_e}{B_0^2} = \\frac{(1.0 \\times 10^{18}\\ \\mathrm{m}^{-3})(9.1094 \\times 10^{-31}\\ \\mathrm{kg})}{(0.080\\ \\mathrm{T})^2} \\approx 1.4233 \\times 10^{-10}\\ \\mathrm{s^2/(\\Omega \\cdot m)}$$\n现在，我们计算 $\\sigma_{xx}^{\\mathrm{cold}}$:\n$$\\sigma_{xx}^{\\mathrm{cold}} \\approx (1.4233 \\times 10^{-10}) \\left( (6.0 \\times 10^7) - i(2.5133 \\times 10^7) \\right)\\ \\mathrm{S/m}$$\n$$\\sigma_{xx}^{\\mathrm{cold}} \\approx (8.540 \\times 10^{-3}) - i(3.578 \\times 10^{-3})\\ \\mathrm{S/m}$$\n\n### 任务 3：推断电子温度 $T_e$\n\n从推导出的 $\\sigma_{xx}$ 模型开始，我们可以将其倒数表示为：\n$$\\frac{1}{\\sigma_{xx}(\\omega, k)} = \\frac{m_e}{n_0 e^2} \\left( (\\nu-i\\omega) + \\frac{\\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 k_B T_e}{m_e \\omega} \\right)$$\n这可以分离为冷等离子体部分和暖等离子体修正项：\n$$\\frac{1}{\\sigma_{xx}(\\omega, k)} = \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}} + \\frac{m_e}{n_0 e^2} \\left( i \\frac{k^2 k_B T_e}{m_e \\omega} \\right) = \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}} + i \\frac{k^2 k_B T_e}{n_0 e^2 \\omega}$$\n这种通过倒数进行分离的方法在数值上通常比直接处理电导率更稳定。现在我们可以通过代入 $\\sigma_{xx} = \\sigma_{xx}^{\\mathrm{meas}}$ 来求解热能 $\\Theta_e = k_B T_e$：\n$$i \\frac{k^2 \\Theta_e}{n_0 e^2 \\omega} = \\frac{1}{\\sigma_{xx}^{\\mathrm{meas}}} - \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}}$$\n我们分别计算每一项的倒数：\n$$ \\frac{1}{\\sigma_{xx}^{\\mathrm{meas}}} = \\frac{1}{(2.258 - i\\,4.191) \\times 10^{-3}} = \\frac{2.258 + i\\,4.191}{(2.258^2 + 4.191^2) \\times 10^{-6}} = \\frac{2.258 + i\\,4.191}{22.673 \\times 10^{-6}} \\approx 99.59 + i\\,184.85\\ \\mathrm{S^{-1}m} $$\n$$ \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}} = \\frac{1}{(8.540 - i\\,3.578) \\times 10^{-3}} = \\frac{8.540 + i\\,3.578}{(8.540^2 + 3.578^2) \\times 10^{-6}} = \\frac{8.540 + i\\,3.578}{85.733 \\times 10^{-6}} \\approx 99.61 + i\\,41.73\\ \\mathrm{S^{-1}m} $$\n它们的差值为：\n$$ \\frac{1}{\\sigma_{xx}^{\\mathrm{meas}}} - \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}} \\approx (99.59 - 99.61) + i(184.85 - 41.73) = -0.02 + i\\,143.12 $$\n因此：\n$$i \\frac{k^2 \\Theta_e}{n_0 e^2 \\omega} = -0.02 + i\\,143.12$$\n求解 $\\Theta_e$：\n$$ \\Theta_e = \\frac{n_0 e^2 \\omega}{i k^2} (-0.02 + i\\,143.12) = -i \\frac{n_0 e^2 \\omega}{k^2} (-0.02 + i\\,143.12) $$\n计算前置因子 $C = \\frac{n_0 e^2 \\omega}{k^2}$：\n$$ C = \\frac{(1.0 \\times 10^{18})(1.6022 \\times 10^{-19})^2(2.5133 \\times 10^7)}{(1.20 \\times 10^4)^2} \\approx 4.481 \\times 10^{-21}\\ \\mathrm{J} $$\n现在，我们求 $\\Theta_e$：\n$$ \\Theta_e = -i (4.481 \\times 10^{-21}) (-0.02 + i\\,143.12) = (4.481 \\times 10^{-21} \\times 143.12) + i(4.481 \\times 10^{-21} \\times 0.02) $$\n$$ \\Theta_e \\approx (6.414 \\times 10^{-19}) + i(8.96 \\times 10^{-23})\\ \\mathrm{J} $$\n热能 $k_B T_e$ 必须是实数。微小的虚部可归因于实验不确定性或所提供数据中的舍入误差。我们取实部作为物理值。\n$$\\Theta_e = k_B T_e \\approx 6.414 \\times 10^{-19}\\ \\mathrm{J}$$\n为了以电子伏特（eV）表示该能量，我们将其除以基本电荷 $e$：\n$$T_e\\,[\\mathrm{eV}] = \\frac{\\Theta_e}{e} = \\frac{6.414 \\times 10^{-19}\\ \\mathrm{J}}{1.6022 \\times 10^{-19}\\ \\mathrm{J/eV}} \\approx 4.003\\ \\mathrm{eV}$$\n四舍五入到三位有效数字，我们得到 $T_e = 4.00\\ \\mathrm{eV}$。",
            "answer": "$$\\boxed{4.00}$$"
        },
        {
            "introduction": "在等离子体响应概念的基础上，这个实践将我们的重点转移到波的传播轨迹上。我们将使用哈密顿射线追踪这一计算波物理学的基石，来模拟电子回旋波在空间变化的磁场中的路径。这项计算练习  要求你同时实现用于折射率的冷、温等离子体模型，并比较由此产生的射线路径，生动地说明热效应如何导致波能量沉积位置的显著差异。",
            "id": "4063062",
            "problem": "考虑一个与计算聚变科学与工程相关的二维平板等离子体模型，其中角频率为 $\\omega$ 的电子回旋波在垂直于静磁场 $\\mathbf{B}$ 的平面内传播。磁场沿 $\\hat{\\mathbf{z}}$ 方向，且仅随笛卡尔坐标 $x$ 变化，其形式为 $B(x) = B_{0}\\left(1 + s\\, x\\right)$，其中 $B_{0}$ 是轴上场强，$s$ 是一个单位为米分之一的恒定磁剪切参数。电子数密度 $n_{e}$ 在空间上是均匀的。波从位置 $x = x_{0}$ 处发射，其传播方向与 $x$ 轴的初始夹角为 $\\alpha_{0}$（以度为单位），并被追踪直至到达 $x = x_{1}$ 处，其中 $x_{1}  x_{0}$。\n\n从磁化等离子体中的麦克斯韦方程组和程函（几何光学）近似出发，波色散可以用冷等离子体介电张量 $\\boldsymbol{\\varepsilon}(\\omega, \\mathbf{B}, n_{e})$ 来表示。请将此一般关系式特殊化为相对于 $\\mathbf{B}$ 的垂直传播情况，并根据由电子等离子体频率 $\\omega_{pe}$ 和电子回旋频率 $\\omega_{ce}$ 构建的标准 Stix 参数，确定非常波（也称为 $X$ 模）的折射率 $n(x)$。将等离子体视为由电子和静态离子背景组成，在电子回旋波频率下，离子的动力学效应可以忽略。对于温等离子体修正，使用一个有效的相对论质量因子 $\\gamma = 1 + \\tfrac{3}{2}\\,\\theta$，其中 $\\theta = k_{B} T_{e}/(m_{e} c^{2})$，$T_{e}$ 是电子温度，$k_{B}$ 是玻尔兹曼常数，$m_{e}$ 是电子静止质量，$c$ 是光速。通过替换 $\\omega_{ce} \\to \\omega_{ce}/\\gamma$ 和 $\\omega_{pe}^{2} \\to \\omega_{pe}^{2}/\\gamma$ 来实现温等离子体修正。\n\n在非均匀但横向不变（$y$ 方向不变）的介质中使用哈密顿射线追踪，证明波矢量的 $y$ 分量 $k_{y}$ 是一个运动不变量，并且射线轨迹 $y(x)$ 满足以下形式的一阶微分方程：\n$$\n\\frac{dy}{dx} = \\frac{k_{y}}{k_{x}(x)},\n$$\n其中 $|\\mathbf{k}(x)| = \\tfrac{\\omega}{c}\\, n(x)$ 且 $k_{x}(x) = \\sqrt{|\\mathbf{k}(x)|^{2} - k_{y}^{2}}$。不变量 $k_{y}$ 由 $x = x_{0}$ 处的发射条件通过 $k_{y} = |\\mathbf{k}(x_{0})| \\sin\\alpha_{0}$ 确定，其中 $\\alpha_{0}$ 需转换为弧度。假设对于垂直传播，$X$ 模的折射率在垂直于 $\\mathbf{B}$ 的平面内是一个各向同性函数，因此 $n(x)$ 仅通过 $B(x)$ 和 $n_{e}$ 依赖于 $x$。\n\n你的任务是针对以下每个测试用例，计算在 $x = x_{1}$ 处，温等离子体修正模型和冷等离子体模型的预测横向位移之差：\n$$\n\\Delta y \\equiv y_{\\text{warm}}(x_{1}) - y_{\\text{cold}}(x_{1}).\n$$\n对于冷等离子体和温等离子体两种情况，使用一种能够处理 $n(x)$ 平滑空间变化的数值稳定方法，对射线方程从 $x_{0}$ 到 $x_{1}$ 进行积分。如果在定义域内任一模型的 $n^{2}(x)$ 变为非正值，则在奇点前停止积分并使用最后一个明确定义的值，但所提供的测试用例已设计为确保在该区间内 $n^{2}(x)  0$。\n\n物理常数必须使用国际单位制（SI）单位。最终结果 $\\Delta y$ 以米为单位表示，并四舍五入到六位小数。角度输入时必须以度为单位，并在内部计算时转换为弧度。\n\n使用以下测试套件，它为每个用例设置了 $(B_{0}, s, n_{e}, f, T_{e}, x_{0}, x_{1}, \\alpha_{0})$，其中 $f$ 是频率（单位：赫兹），$T_{e}$ 是电子温度（单位：电子伏特），所有长度单位均为米：\n\n- 用例 A（无磁剪切，基准比较）：$B_{0} = 5.0$ T, $s = 0.0$ m$^{-1}$, $n_{e} = 5.0\\times 10^{19}$ m$^{-3}$, $f = 170.0\\times 10^{9}$ Hz, $T_{e} = 10{,}000$ eV, $x_{0} = 0.0$ m, $x_{1} = 0.05$ m, $\\alpha_{0} = 30.0$ 度。\n- 用例 B（中等负磁剪切）：$B_{0} = 5.0$ T, $s = -1.0$ m$^{-1}$, $n_{e} = 5.0\\times 10^{19}$ m$^{-3}$, $f = 170.0\\times 10^{9}$ Hz, $T_{e} = 10{,}000$ eV, $x_{0} = 0.0$ m, $x_{1} = 0.05$ m, $\\alpha_{0} = 30.0$ 度。\n- 用例 C（更强负磁剪切）：$B_{0} = 5.0$ T, $s = -4.0$ m$^{-1}$, $n_{e} = 5.0\\times 10^{19}$ m$^{-3}$, $f = 170.0\\times 10^{9}$ Hz, $T_{e} = 10{,}000$ eV, $x_{0} = 0.0$ m, $x_{1} = 0.05$ m, $\\alpha_{0} = 30.0$ 度。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[\\Delta y_{A},\\Delta y_{B},\\Delta y_{C}]$，其中每个条目都是一个以米为单位、四舍五入到六位小数的浮点值。",
            "solution": "该问题要求计算穿越磁化平板等离子体的电子回旋波在温等离子体模型和冷等离子体模型下的横向位移差 $\\Delta y$。解决方案涉及推导波的折射率，建立射线追踪方程，并对这些方程进行数值积分。\n\n首先，我们建立物理框架。波在二维平板几何结构（$x,y$平面）中传播，静磁场 $\\mathbf{B}$ 与 $\\hat{\\mathbf{z}}$ 方向对齐。场强随位置 $x$ 变化，其形式为 $B(x) = B_{0}(1 + s\\,x)$。电子数密度 $n_e$ 是均匀的。波的角频率为 $\\omega = 2\\pi f$。\n\n描述波传播的关键是折射率 $n(x)$，它由等离子体的介电张量 $\\boldsymbol{\\varepsilon}$ 推导得出。对于忽略离子运动（这在电子回旋波等高频下是有效的）的电子-离子等离子体，并且对于垂直于 $\\mathbf{B}$ 的传播，色散关系分裂为两种模式：寻常波（O 模）和非常波（X 模）。本问题指定的是 X 模。\n\nX 模折射率 $n_X$ 由以下公式给出：\n$$\nn_X^2 = \\frac{R L}{S}\n$$\n其中 $R$、$L$ 和 $S$ 是 Stix 参数。这些参数通过无量纲量 $X = \\omega_{pe}^2/\\omega^2$ 和 $Y(x) = \\omega_{ce}(x)/\\omega$ 来定义。由于 $n_e$ 是均匀的，电子等离子体频率 $\\omega_{pe}$ 是一个常数：$\\omega_{pe}^2 = \\frac{n_e e^2}{\\varepsilon_0 m_e}$。电子回旋频率 $\\omega_{ce}(x)$ 依赖于当地磁场：$\\omega_{ce}(x) = \\frac{|e| B(x)}{m_e}$。这里，$e$ 是基本电荷，$m_e$ 是电子静止质量，$\\varepsilon_0$ 是真空介电常数。\nStix 参数为：\n$$\nR(x) = 1 - \\frac{X}{1-Y(x)}, \\quad L(x) = 1 - \\frac{X}{1+Y(x)}, \\quad S(x) = \\frac{R(x)+L(x)}{2} = 1 - \\frac{X}{1-Y(x)^2}\n$$\n将这些参数代入 $n_X^2$ 的公式，可以得到一个用 $X$ 和 $Y(x)$ 表示的表达式：\n$$\nn_X^2(x) = \\frac{(1-X)^2 - Y(x)^2}{1 - Y(x)^2 - X}\n$$\n这个表达式构成了我们的冷等离子体模型，我们将其表示为 $n_{\\text{cold}}^2(x)$。\n\n问题通过一个有效的相对论质量因子 $\\gamma$ 引入了温等离子体修正。这考虑了一阶热效应。该因子由 $\\gamma = 1 + \\frac{3}{2}\\theta$ 给出，其中 $\\theta = \\frac{k_B T_e}{m_e c^2}$，$T_e$ 是电子温度，$k_B$ 是玻尔兹曼常数，$c$ 是光速。注意，如果 $T_e$ 以电子伏特（eV）为单位，则热能为 $k_B T_e \\equiv T_e[\\text{eV}] \\times e$。温等离子体模型是通过将电子静止质量 $m_e$ 替换为有效质量 $\\gamma m_e$ 来实现的。这会如下修改特征频率：\n$$\n\\omega_{ce} \\to \\omega_{ce,w} = \\frac{\\omega_{ce}}{\\gamma}, \\quad \\omega_{pe}^2 \\to \\omega_{pe, w}^2 = \\frac{\\omega_{pe}^2}{\\gamma}\n$$\n因此，无量纲参数变为 $X_w = X/\\gamma$ 和 $Y_w(x) = Y(x)/\\gamma$。温等离子体折射率 $n_{\\text{warm}}^2(x)$ 则为：\n$$\nn_{\\text{warm}}^2(x) = \\frac{(1-X_w)^2 - Y_w(x)^2}{1 - Y_w(x)^2 - X_w}\n$$\n定义了折射率模型后，我们进行射线追踪。问题指出，对于在 $y$ 方向具有不变性的介质，波矢量的 $y$ 分量 $k_y$ 是一个守恒量（运动不变量）。这是斯涅尔定律在连续变化介质中的一种表现形式。$k_y$ 的初始值由发射位置 $x=x_0$ 和发射角 $\\alpha_0$ 决定：\n$$\nk_y = |\\mathbf{k}(x_0)| \\sin(\\alpha_{0,rad}) = \\frac{\\omega}{c} n(x_0) \\sin(\\alpha_{0,rad})\n$$\n其中 $\\alpha_{0,rad}$ 是以弧度为单位的发射角。请注意，由于 $n_{\\text{cold}}(x_0) \\neq n_{\\text{warm}}(x_0)$，守恒量 $k_y$ 对于每个模型将有不同的值：$k_{y, \\text{cold}} \\neq k_{y, \\text{warm}}$。\n\n射线轨迹 $y(x)$ 由以下微分方程确定：\n$$\n\\frac{dy}{dx} = \\frac{k_y}{k_x(x)}\n$$\n其中 $k_x(x)$ 是波矢量的 $x$ 分量。从基本关系 $|\\mathbf{k}(x)|^2 = k_x(x)^2 + k_y^2 = (\\frac{\\omega}{c} n(x))^2$，我们可以解出 $k_x(x)$：\n$$\nk_x(x) = \\sqrt{\\left(\\frac{\\omega}{c} n(x)\\right)^2 - k_y^2}\n$$\n射线要能传播，必须满足 $k_x^2(x)  0$。$k_x(x) = 0$ 的点是转折点或反射点。问题陈述保证在积分区间 $[x_0, x_1]$ 内不会遇到这样的点。\n\n假设射线从 $y(x_0)=0$ 开始，通过对射线方程积分可以找到在 $x=x_1$ 处的总横向位移：\n$$\ny(x_1) = \\int_{x_0}^{x_1} \\frac{dy}{dx} dx = \\int_{x_0}^{x_1} \\frac{k_y}{\\sqrt{(\\frac{\\omega}{c} n(x))^2 - k_y^2}} dx\n$$\n对冷等离子体和温等离子体模型都需对该积分进行数值计算。\n对于冷模型：\n$$\ny_{\\text{cold}}(x_1) = \\int_{x_0}^{x_1} \\frac{k_{y, \\text{cold}}}{\\sqrt{(\\frac{\\omega}{c} n_{\\text{cold}}(x))^2 - k_{y, \\text{cold}}^2}} dx\n$$\n对于温模型：\n$$\ny_{\\text{warm}}(x_1) = \\int_{x_0}^{x_1} \\frac{k_{y, \\text{warm}}}{\\sqrt{(\\frac{\\omega}{c} n_{\\text{warm}}(x))^2 - k_{y, \\text{warm}}^2}} dx\n$$\n最终我们关心的量是这两个位移之差：\n$$\n\\Delta y = y_{\\text{warm}}(x_1) - y_{\\text{cold}}(x_1)\n$$\n对每个测试用例，使用所提供的参数进行计算。对于磁剪切 $s=0$ 的特殊情况，磁场 $B(x)$ 是恒定的，使得整个介质中的折射率 $n$ 也是恒定的。在这种情况下，被积函数 $\\frac{dy}{dx}$ 简化为 $\\tan(\\alpha_{0, rad})$，积分变为 $y(x_1) = (x_1 - x_0) \\tan(\\alpha_{0,rad})$。这个结果与折射率的值无关，因此 $y_{\\text{warm}}(x_1) = y_{\\text{cold}}(x_1)$，导致 $\\Delta y = 0$。这可以作为我们方法论的验证。对于 $s \\neq 0$ 的情况，$n(x)$ 的空间变化使得数值积分成为必要。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to solve the ray tracing problem for all test cases.\n    \"\"\"\n    \n    # Physical constants in SI units\n    C = 299792458.0  # Speed of light in m/s\n    M_E = 9.1093837015e-31  # Electron rest mass in kg\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in F/m\n\n    def calculate_n_squared(B, ne, omega, Te_eV=None):\n        \"\"\"\n        Calculates the square of the X-mode refractive index for a given set of\n        plasma parameters.\n        \n        Args:\n            B (float): Magnetic field strength in Tesla.\n            ne (float): Electron number density in m^-3.\n            omega (float): Wave angular frequency in rad/s.\n            Te_eV (float, optional): Electron temperature in eV. If provided,\n                                     a warm plasma correction is applied.\n                                     Defaults to None (cold plasma).\n        Returns:\n            float: The square of the refractive index, n^2.\n        \"\"\"\n        # Base plasma parameter (frequency squared)\n        omega_pe_sq = (ne * E_CHARGE**2) / (EPSILON_0 * M_E)\n        \n        # Base cyclotron frequency\n        omega_ce = (E_CHARGE * B) / M_E\n        \n        # Apply warm plasma correction if temperature is specified\n        if Te_eV is not None:\n            # Thermal energy in Joules\n            Te_J = Te_eV * E_CHARGE\n            # Relativistic parameter theta\n            theta = Te_J / (M_E * C**2)\n            # Effective relativistic mass factor gamma\n            gamma = 1.0 + 1.5 * theta\n            \n            # Apply correction to frequencies\n            omega_pe_sq /= gamma\n            omega_ce /= gamma\n            \n        # Standard Stix parameters\n        X = omega_pe_sq / omega**2\n        Y = omega_ce / omega\n        \n        # The problem cases are designed to avoid resonances/cutoffs where\n        # denominators are zero.\n        denominator = 1.0 - Y**2 - X\n        if abs(denominator)  1e-15:\n            # Return a large negative value to indicate a singularity\n            return -1e20\n\n        numerator = (1.0 - X)**2 - Y**2\n        \n        n_sq = numerator / denominator\n        \n        return n_sq\n\n    def solve_case(params):\n        \"\"\"\n        Solves for the lateral displacement difference for a single test case.\n        \"\"\"\n        B0, s, ne, f, Te_eV, x0, x1, alpha0_deg = params\n        \n        omega = 2.0 * np.pi * f\n        alpha0_rad = np.deg2rad(alpha0_deg)\n        \n        # --- Cold Plasma Calculation ---\n        def dydx_cold(x, k_y_cold_val):\n            B_x = B0 * (1.0 + s * x)\n            n_sq_x = calculate_n_squared(B_x, ne, omega, Te_eV=None)\n            \n            if n_sq_x = 0:\n                raise ValueError(f\"Cold plasma n^2 = 0 at x={x}\")\n                \n            kx_sq = (omega/C)**2 * n_sq_x - k_y_cold_val**2\n            \n            if kx_sq = 0:\n                raise ValueError(f\"Cold plasma turning point reached at x={x}\")\n            \n            return k_y_cold_val / np.sqrt(kx_sq)\n\n        B_at_x0 = B0 * (1.0 + s * x0)\n        n_sq_cold_x0 = calculate_n_squared(B_at_x0, ne, omega, Te_eV=None)\n        n_cold_x0 = np.sqrt(n_sq_cold_x0)\n        k_y_cold = (omega / C) * n_cold_x0 * np.sin(alpha0_rad)\n        \n        y_cold_x1, _ = integrate.quad(dydx_cold, x0, x1, args=(k_y_cold,))\n        \n        # --- Warm Plasma Calculation ---\n        def dydx_warm(x, k_y_warm_val):\n            B_x = B0 * (1.0 + s * x)\n            n_sq_x = calculate_n_squared(B_x, ne, omega, Te_eV=Te_eV)\n\n            if n_sq_x = 0:\n                raise ValueError(f\"Warm plasma n^2 = 0 at x={x}\")\n\n            kx_sq = (omega/C)**2 * n_sq_x - k_y_warm_val**2\n\n            if kx_sq = 0:\n                raise ValueError(f\"Warm plasma turning point reached at x={x}\")\n                \n            return k_y_warm_val / np.sqrt(kx_sq)\n\n        n_sq_warm_x0 = calculate_n_squared(B_at_x0, ne, omega, Te_eV=Te_eV)\n        n_warm_x0 = np.sqrt(n_sq_warm_x0)\n        k_y_warm = (omega / C) * n_warm_x0 * np.sin(alpha0_rad)\n        \n        y_warm_x1, _ = integrate.quad(dydx_warm, x0, x1, args=(k_y_warm,))\n        \n        # --- Final Result ---\n        delta_y = y_warm_x1 - y_cold_x1\n        return delta_y\n\n    # Test suite from the problem description\n    test_cases = [\n        # (B0, s, ne, f, Te, x0, x1, alpha0)\n        (5.0, 0.0, 5.0e19, 170.0e9, 10000.0, 0.0, 0.05, 30.0), # Case A\n        (5.0, -1.0, 5.0e19, 170.0e9, 10000.0, 0.0, 0.05, 30.0),# Case B\n        (5.0, -4.0, 5.0e19, 170.0e9, 10000.0, 0.0, 0.05, 30.0),# Case C\n    ]\n    \n    results = []\n    for case in test_cases:\n        delta_y = solve_case(case)\n        # Format to six decimal places\n        results.append(f\"{delta_y:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在了解了温等离子体效应的宏观影响之后，我们现在深入探讨驱动这些模型的数值引擎。温等离子体介电张量由回旋谐波的求和构成，其中涉及复杂的速度空间积分。这项高级实践  将挑战你实现并比较用于计算这些积分的不同数值求积方案，重点关注波长与拉莫尔半径相当的关键区域（$k_{\\perp}\\rho \\sim 1$）。这对于开发稳健且精确的动理学模拟代码是一项至关重要的技能。",
            "id": "4063091",
            "problem": "温磁化等离子体介电模型需要对回旋谐波上的粒子种类磁化率进行求和，而这些求和的准确性取决于对速度空间平均值的数值计算，这些平均值出现在从麦克斯韦分布粒子的 Vlasov 方程推导出的线性响应中。在温等离子体响应中，一个核心量是由麦克斯韦分布加权的柱状贝塞尔函数平方在垂直速度空间上的平均值。对于一种热拉莫尔半径参数为 $a = (k_\\perp \\rho)^2$ 的粒子，其中 $k_\\perp$ 是垂直波数，$\\rho$ 是由 $\\rho = v_{\\mathrm{th}}/\\Omega$ 定义的热拉莫尔半径（$v_{\\mathrm{th}}$ 为热速度，$\\Omega$ 为回旋频率），按谐波分辨的垂直平均值定义为\n$$\n\\Gamma_n(a) \\equiv \\int_{0}^{\\infty} e^{-u}\\, J_n^2\\!\\big(\\sqrt{2 a\\, u}\\big)\\, du,\n$$\n其中 $J_n$ 是整数阶 $n$ 的第一类柱状贝塞尔函数，$u = v_\\perp^2 / v_{\\mathrm{th}}^2$ 是无量纲的垂直动能变量。温等离子体磁化率张量元包含对回旋谐波指数 $n$ 的形式为 $\\sum_{n=-\\infty}^{\\infty} \\Gamma_n(a)\\,(\\cdots)$ 的求和。在 $k_\\perp \\rho \\sim 1$ 的区域内，对不同 $n$ 值的 $\\Gamma_n(a)$ 进行精确计算，对于对照探测有限拉莫尔半径效应的测量结果来验证温介电模型至关重要。\n\n从以上定义和经过充分检验的特殊函数恒等式出发，可以证明 $\\Gamma_n(a)$ 的精确值可以用第一类修正贝塞尔函数 $I_n$ 表示为一个闭式表达式。然而，在计算实践中，通常通过数值积分方法来计算 $\\Gamma_n(a)$，并且必须在准确性和性能之间取得平衡。\n\n任务：实现两种不同的数值积分方案，对每个整数 $n \\in \\{-N,\\ldots,N\\}$ 计算 $\\Gamma_n(a)$，然后构成截断的温等离子体磁化率和 $S_N(a) = \\sum_{n=-N}^{N} \\Gamma_n(a)$。你必须比较的两种方案是：\n- M 阶 Gauss–Laguerre 求积法，该方法通过在 $M$ 个特定节点上使用相应的权重计算 $f(u)$ 的值，来处理 $\\int_{0}^{\\infty} e^{-u} f(u)\\, du$ 形式的积分。\n- 在有限区间 $[0,U]$ 上使用偶数个子区间 $K$ 的复化 Simpson 法则，直接应用于加权被积函数 $e^{-u} J_n^2(\\sqrt{2 a u})$。对于此方案，你必须选择一个有限的 $U$，并保守地处理被忽略的尾部积分 $\\int_{U}^{\\infty} e^{-u} J_n^2(\\sqrt{2 a u})\\, du$；注意，对于实数宗量，$0 \\le J_n^2(\\cdot) \\le 1$，因此尾部积分的上界为 $e^{-U}$。\n\n使用由标准温等离子体理论和上述基本定义所隐含的、用已知特殊函数表示的 $\\Gamma_n(a)$ 精确值作为参考基准。对每个测试用例，计算：\n- Gauss–Laguerre 方法在 $n \\in \\{-N,\\ldots,N\\}$ 上的最大绝对误差，定义为 $\\max_{-N \\le n \\le N} |\\Gamma_n^{\\mathrm{GL}}(a) - \\Gamma_n^{\\mathrm{exact}}(a)|$。\n- Simpson 方法在 $n \\in \\{-N,\\ldots,N\\}$ 上的最大绝对误差，定义类似。\n- 每个方案对所有 $n$ 执行的被积函数求值总次数。对于 Gauss–Laguerre 方法，将在一个求积节点上对 $J_n^2(\\sqrt{2 a u})$ 的每次求值计为一次被积函数求值，并对所有 $n$ 求和。对于 Simpson 方法，将在一个网格点上对加权被积函数 $e^{-u} J_n^2(\\sqrt{2 a u})$ 的每次求值计为一次被积函数求值，并对所有 $n$ 求和。\n- 每种方法计算的截断磁化率和 $S_N(a)$ 的绝对误差，定义为 $|S_N^{\\mathrm{method}}(a) - S_N^{\\mathrm{exact}}(a)|$，其中 $S_N^{\\mathrm{exact}}(a) \\equiv \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{exact}}(a)$。\n\n此问题中的所有量均为无量纲。你的程序必须为每个测试用例计算上述四个指标，并以浮点数或整数形式输出。设计你的实现时，应确保特殊函数的求值使用广泛可用且数值稳定的例程。\n\n测试套件：\n- 用例1（理想情况，有限拉莫尔半径）：$a = 1$，$N = 10$，Gauss–Laguerre 阶数 $M = 32$，Simpson 区间 $[0,U]$，$U = 20$，$K = 2000$ 个子区间。\n- 用例2（冷等离子体极限边界）：$a = 10^{-4}$，$N = 2$，$M = 16$，$U = 20$，$K = 1000$。\n- 用例3（强有限拉莫尔半径）：$a = 5$，$N = 30$，$M = 48$，$U = 20$，$K = 4000$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含三个测试用例的结果。结果为一个逗号分隔的列表，并用方括号括起来。每个测试用例的结果本身是一个包含六个条目的列表，顺序如下：[max_error_GaussLaguerre, max_error_Simpson, evals_GaussLaguerre, evals_Simpson, sum_error_GaussLaguerre, sum_error_Simpson]。例如：[[eGL1,eSM1,evalGL1,evalSM1,sumErrGL1,sumErrSM1],[eGL2,eSM2,evalGL2,evalSM2,sumErrGL2,sumErrSM2],[eGL3,eSM3,evalGL3,evalSM3,sumErrGL3,sumErrSM3]]。",
            "solution": "磁化麦克斯韦等离子体的线性响应可以通过对 Vlasov 方程进行回旋角谐波分解来推导。在此框架下，一种粒子的温等离子体磁化率张量元涉及对回旋谐波指数 $n$ 的求和，求和项为贝塞尔函数加权的垂直速度平均值。对于麦克斯韦垂直分布和无量纲垂直动能变量 $u = v_\\perp^2 / v_{\\mathrm{th}}^2$，权重因子为 $e^{-u}$。有限拉莫尔半径效应通过柱状贝塞尔函数 $J_n$ 的宗量体现出来。按照标准温等离子体表示法，参数 $a = (k_\\perp \\rho)^2$ 控制着有限拉莫尔半径效应的量级，其中 $\\rho = v_{\\mathrm{th}}/\\Omega$ 是热拉莫尔半径。按谐波分辨的垂直平均值可以写为\n$$\n\\Gamma_n(a) = \\int_{0}^{\\infty} e^{-u}\\, J_n^2\\!\\big(\\sqrt{2 a\\, u}\\big)\\, du,\n$$\n这是磁化率中乘以平行响应函数的有限拉莫尔半径因子。\n\n$\\Gamma_n(a)$ 的闭式表达式可由标准特殊函数恒等式推得。利用第一类修正贝塞尔函数 $I_n(x)$ 的生成函数和积分恒等式\n$$\n\\int_0^\\infty e^{-t}\\, J_n^2\\!\\big(2\\sqrt{x t}\\big)\\, dt = e^{-2x}\\, I_n(2x),\n$$\n并取 $x = a/2$，我们得到\n$$\n\\Gamma_n(a) = e^{-a}\\, I_n(a).\n$$\n这是热磁化等离子体理论中一个经过充分检验的结果：宗量为 $\\sqrt{2 a u}$ 的贝塞尔函数平方在垂直麦克斯韦分布下的平均值恰好简化为 $e^{-a} I_n(a)$。从这个表达式，可以立即得到恒等式\n$$\n\\sum_{n=-\\infty}^{\\infty} \\Gamma_n(a) = e^{-a} \\sum_{n=-\\infty}^{\\infty} I_n(a) = e^{-a}\\, e^{a} = 1,\n$$\n其中我们使用了已知的级数恒等式 $\\sum_{n=-\\infty}^{\\infty} I_n(a) = e^{a}$。这个恒等式可以作为对实现方案的强有力的内部检验，并经常用于对照冷等离子体极限来验证温介电模型，在冷等离子体极限下，$a \\to 0$ 导致 $\\Gamma_0(0) = 1$ 和 $\\Gamma_{n\\ne 0}(0) = 0$。\n\n现在我们设计数值积分方案来计算 $\\Gamma_n(a)$，并比较它们的性能和准确性。\n\nGauss–Laguerre 求积法：\n- M 阶 Gauss–Laguerre 法则提供节点 $\\{u_i\\}_{i=1}^M$ 和权重 $\\{w_i\\}_{i=1}^M$，使得\n$$\n\\int_{0}^{\\infty} e^{-u} f(u)\\, du \\approx \\sum_{i=1}^{M} w_i\\, f(u_i).\n$$\n- 对于我们的被积函数 $f(u) = J_n^2(\\sqrt{2 a u})$，求积近似为\n$$\n\\Gamma_n^{\\mathrm{GL}}(a) = \\sum_{i=1}^{M} w_i\\, J_n^2\\!\\big(\\sqrt{2 a\\, u_i}\\big).\n$$\n- 每个 $n$ 的被积函数求值次数为 $M$，因此对于 $n \\in \\{-N,\\ldots,N\\}$，总次数为 $M (2N+1)$。\n\n在 $[0,U]$ 上的复化 Simpson 法则：\n- 我们选择一个有限的截断值 $U  0$，并用偶数个子区间 $K$ 对限制在 $[0,U]$ 上的积分应用 Simpson 法则：\n$$\n\\int_{0}^{U} e^{-u} J_n^2\\!\\big(\\sqrt{2 a u}\\big)\\, du \\approx \\frac{h}{3}\\left[g(u_0) + g(u_K) + 4 \\sum_{j=1,\\,\\text{odd}}^{K-1} g(u_j) + 2 \\sum_{j=2,\\,\\text{even}}^{K-2} g(u_j)\\right],\n$$\n其中 $h = U/K$，$u_j = j h$，且 $g(u) = e^{-u} J_n^2(\\sqrt{2 a u})$。\n- 被忽略的尾部积分 $\\int_{U}^{\\infty} e^{-u} J_n^2(\\sqrt{2 a u})\\, du$ 的上界为 $e^{-U}$，因为对于实数宗量，$0 \\le J_n^2(\\cdot) \\le 1$。因此选择 $U = 20$ 会使尾部积分 $\\le e^{-20} \\approx 2.06\\times 10^{-9}$，这对于此处使用的容差来说是可以忽略的。\n- 每个 $n$ 的被积函数求值次数为 $(K+1)$，因此对于所有 $n$，总次数为 $(K+1)(2N+1)$。\n\n参考基准：\n- 精确值为\n$$\n\\Gamma_n^{\\mathrm{exact}}(a) = e^{-a} I_n(a),\n$$\n我们使用一个数值稳定的特殊函数例程来计算 $I_n(a)$。\n- 精确的截断和为\n$$\nS_N^{\\mathrm{exact}}(a) = \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{exact}}(a).\n$$\n虽然无穷和等于 $1$，但截断和与 $1$ 的差值为超出 $|n|  N$ 范围的尾部项，它为比较使用相同截断的求积方案提供了一个公平的基准。\n\n误差指标：\n- 对每种方法，计算在所有 $n$ 上的最大绝对误差：\n$$\nE_{\\max}^{\\mathrm{GL}} = \\max_{-N \\le n \\le N} \\left| \\Gamma_n^{\\mathrm{GL}}(a) - \\Gamma_n^{\\mathrm{exact}}(a) \\right|,\n\\quad\nE_{\\max}^{\\mathrm{S}} = \\max_{-N \\le n \\le N} \\left| \\Gamma_n^{\\mathrm{S}}(a) - \\Gamma_n^{\\mathrm{exact}}(a) \\right|.\n$$\n- 计算每种方法的截断和的绝对误差：\n$$\n\\Delta S^{\\mathrm{GL}} = \\left| \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{GL}}(a) - S_N^{\\mathrm{exact}}(a) \\right|,\n\\quad\n\\Delta S^{\\mathrm{S}} = \\left| \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{S}}(a) - S_N^{\\mathrm{exact}}(a) \\right|.\n$$\n\n算法步骤：\n1. 对每个测试用例 $(a, N, M, U, K)$，预先计算 M 阶 Gauss–Laguerre 的节点和权重。\n2. 对每个 $n \\in \\{-N,\\ldots,N\\}$：\n   - 通过 Gauss–Laguerre 方法计算 $\\Gamma_n^{\\mathrm{GL}}(a)$。\n   - 通过在 $[0,U]$ 上的复化 Simpson 方法计算 $\\Gamma_n^{\\mathrm{S}}(a)$。\n   - 计算 $\\Gamma_n^{\\mathrm{exact}}(a) = e^{-a} I_n(a)$。\n3. 累加计算每种方法在所有 $n$ 上的最大绝对误差，以及截断和 $S_N^{\\mathrm{GL}}(a)$、$S_N^{\\mathrm{S}}(a)$ 和 $S_N^{\\mathrm{exact}}(a)$。\n4. 计算每种方法的被积函数求值总次数：Gauss–Laguerre 方法为 $M (2N+1)$ 次，Simpson 方法为 $(K+1)(2N+1)$ 次。\n5. 对每个测试用例，报告一个包含 $[E_{\\max}^{\\mathrm{GL}}, E_{\\max}^{\\mathrm{S}}, M(2N+1), (K+1)(2N+1), \\Delta S^{\\mathrm{GL}}, \\Delta S^{\\mathrm{S}}]$ 的列表。\n\n此过程直接反映了温介电模型底层的物理和数学原理：它分离出垂直有限拉莫尔半径因子 $\\Gamma_n(a)$，使用为麦克斯韦权重定制的求积法 (Gauss–Laguerre) 和带有保守尾部边界的标准复化法则 (Simpson)，并对照从基本特殊函数恒等式推导出的精确表达式进行验证。$a=1$ 的测试用例覆盖了 $k_\\perp \\rho \\sim 1$ 的区域，同时包含了边界和强有限拉莫尔半径区域，以评估在计算聚变科学与工程验证工作相关条件下的鲁棒性和准确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.laguerre import laggauss\nfrom scipy.special import jv, iv\n\ndef gamma_n_exact(a: float, n: int) - float:\n    \"\"\"\n    Exact value of Gamma_n(a) = e^{-a} I_n(a) for integer n.\n    Uses modified Bessel function of the first kind iv.\n    \"\"\"\n    return float(np.exp(-a) * iv(abs(n), a))\n\ndef gamma_n_gauss_laguerre(a: float, n: int, M: int) - float:\n    \"\"\"\n    Gauss-Laguerre quadrature for Gamma_n(a) = ∫_0^∞ e^{-u} J_n^2(sqrt(2 a u)) du.\n    Order M Gauss-Laguerre provides nodes u_i and weights w_i such that:\n    ∫_0^∞ e^{-u} f(u) du ≈ ∑ w_i f(u_i)\n    \"\"\"\n    # nodes and weights for the Laguerre polynomials (with weighting e^{-u})\n    u_nodes, w_weights = laggauss(M)\n    # Evaluate the integrand f(u) = J_n^2(sqrt(2 a u)) at Laguerre nodes\n    # Note: jv supports non-negative and negative n; we use abs(n) since the square removes sign.\n    sqrt2a = np.sqrt(2.0 * a)\n    args = sqrt2a * np.sqrt(u_nodes)\n    jn_vals = jv(abs(n), args)\n    f_vals = jn_vals * jn_vals  # J_n^2\n    return float(np.dot(w_weights, f_vals))\n\ndef gamma_n_simpson(a: float, n: int, U: float, K: int) - float:\n    \"\"\"\n    Composite Simpson's rule on [0, U] with K even subintervals for:\n    ∫_0^U e^{-u} J_n^2(sqrt(2 a u)) du\n    The neglected tail beyond U is ≤ e^{-U}.\n    \"\"\"\n    assert K % 2 == 0, \"K must be even for Simpson's rule.\"\n    h = U / K\n    # grid points u_j = j h\n    u = np.linspace(0.0, U, K + 1)\n    sqrt2a = np.sqrt(2.0 * a)\n    args = sqrt2a * np.sqrt(u)\n    jn_vals = jv(abs(n), args)\n    g = np.exp(-u) * (jn_vals * jn_vals)\n    # Simpson weights\n    S = g[0] + g[-1] + 4.0 * np.sum(g[1:-1:2]) + 2.0 * np.sum(g[2:-1:2])\n    return float(h * S / 3.0)\n\ndef run_case(a: float, N: int, M: int, U: float, K: int):\n    \"\"\"\n    Run one test case:\n    Returns [max_error_GL, max_error_Simpson, evals_GL, evals_Simpson, sum_error_GL, sum_error_Simpson]\n    \"\"\"\n    # Evaluate across n from -N to N\n    ns = list(range(-N, N + 1))\n    gamma_exact = []\n    gamma_GL = []\n    gamma_S = []\n    max_err_GL = 0.0\n    max_err_S = 0.0\n\n    for n in ns:\n        g_exact = gamma_n_exact(a, n)\n        g_GL = gamma_n_gauss_laguerre(a, n, M)\n        g_S = gamma_n_simpson(a, n, U, K)\n\n        gamma_exact.append(g_exact)\n        gamma_GL.append(g_GL)\n        gamma_S.append(g_S)\n\n        err_GL = abs(g_GL - g_exact)\n        err_S = abs(g_S - g_exact)\n        if err_GL  max_err_GL:\n            max_err_GL = err_GL\n        if err_S  max_err_S:\n            max_err_S = err_S\n\n    # Truncated sums and their errors\n    S_exact = float(np.sum(gamma_exact))\n    S_GL = float(np.sum(gamma_GL))\n    S_S = float(np.sum(gamma_S))\n    sum_err_GL = abs(S_GL - S_exact)\n    sum_err_S = abs(S_S - S_exact)\n\n    # Integrand evaluation counts\n    evals_GL = M * (2 * N + 1)\n    evals_S = (K + 1) * (2 * N + 1)\n\n    return [max_err_GL, max_err_S, evals_GL, evals_S, sum_err_GL, sum_err_S]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (a, N, M, U, K)\n    test_cases = [\n        (1.0, 10, 32, 20.0, 2000),     # Case 1: k_perp rho ~ 1\n        (1.0e-4, 2, 16, 20.0, 1000),   # Case 2: cold limit boundary\n        (5.0, 30, 48, 20.0, 4000),     # Case 3: strong finite Larmor radius\n    ]\n\n    results = []\n    for a, N, M, U, K in test_cases:\n        result = run_case(a, N, M, U, K)\n        results.append(result)\n\n    # Final print statement in the exact required format: list of lists with no spaces.\n    print(\"[\" + \",\".join(str(r).replace(\" \", \"\") for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}