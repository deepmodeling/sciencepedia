{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will first derive a plasma's conductive response from fundamental fluid principles. This exercise demonstrates how to build a simple warm-plasma model by adding a thermal pressure term to the cold-plasma equations of motion. By comparing the model's prediction with hypothetical experimental data, you will learn a vital skill in physics and engineering: using measurements to validate a theoretical model and infer physical parameters, such as the electron temperature, that account for observed discrepancies .",
            "id": "4063070",
            "problem": "A uniform, singly ionized, low-temperature plasma column of electron number density $n_{0}$ is subjected to a spatially varying, time-harmonic electric field $\\mathbf{E}(x,t) = \\Re\\{ \\hat{\\mathbf{x}} E_{0} \\exp(i k x - i \\omega t) \\}$ in the presence of a uniform background magnetic field $\\mathbf{B}_{0} = \\hat{\\mathbf{z}} B_{0}$. The low-frequency regime satisfies $|\\omega| \\ll \\omega_{pe}$ and ion motion is negligible. Electron-neutral momentum-transfer collisions are modeled by a constant collision frequency $\\nu$. An experiment measures the complex conductivity $\\sigma_{xx}$ relating $J_{x}$ to $E_{x}$ at a fixed angular frequency $\\omega$ and wavenumber $k$.\n\nStarting from the linearized electron fluid momentum equation with collisions and the pressure-gradient force, the electron continuity equation, and the definition of the electron cyclotron (gyro) frequency $\\Omega_{e}$, derive a Drude-like low-frequency response model for the cross-field complex conductivity $\\sigma_{xx}(\\omega,k)$ that:\n- reduces to the cold, magnetized Drude response in the limit of vanishing thermal pressure,\n- and includes the leading warm correction due to the isothermal electron pressure gradient for a longitudinal perturbation with wavenumber $k$.\n\nThen, using the derived model, validate the cold-plasma prediction against the measured complex conductivity in a controlled cold-plasma experiment, and infer the electron thermal energy $\\Theta_{e} = k_{B} T_{e}$ (isothermal electron pressure) that accounts for the measured deviation. Finally, report $T_{e}$ in electron-volts.\n\nAssume:\n- The linearized electron momentum equations are valid with a scalar, isothermal pressure $p_{e} = n k_{B} T_{e}$, where $k_{B}$ is the Boltzmann constant and $T_{e}$ is the electron temperature.\n- The continuity equation couples density and velocity perturbations through the wavenumber $k$.\n- The measured conductivity is spatially averaged over the cross-section and corresponds to the $x$-component $\\sigma_{xx}$.\n\nGiven parameters:\n- $n_{0} = 1.0 \\times 10^{18}\\ \\mathrm{m}^{-3}$,\n- $B_{0} = 0.080\\ \\mathrm{T}$,\n- $\\nu = 6.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$,\n- driving frequency $f = 4.0 \\times 10^{6}\\ \\mathrm{Hz}$ so that $\\omega = 2 \\pi f$,\n- wavenumber $k = 1.20 \\times 10^{4}\\ \\mathrm{m}^{-1}$,\n- electron charge $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{C}$,\n- electron mass $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\ \\mathrm{kg}$,\n- Boltzmann constant $k_{B} = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J/K}$,\n- electron cyclotron frequency $\\Omega_{e} = e B_{0}/m_{e}$.\n\nMeasured complex conductivity at $(\\omega,k)$:\n- $\\sigma_{xx}^{\\mathrm{meas}} = (2.258 \\times 10^{-3}) - i\\,(4.191 \\times 10^{-3})\\ \\mathrm{S/m}$.\n\nTasks:\n1. Derive, from first principles, the expression for the cross-field conductivity $\\sigma_{xx}(\\omega,k)$ of an electron fluid with collisions, magnetization, and an isothermal pressure-gradient response along $x$ for wavenumber $k$. Clearly identify the cold-plasma limit and the warm correction structure.\n2. Using the derived model, compute the cold-plasma prediction $\\sigma_{xx}^{\\mathrm{cold}}$ (set $T_{e} \\to 0$) for the given parameters.\n3. Using $\\sigma_{xx}^{\\mathrm{meas}}$ and your model, determine the electron temperature $T_{e}$ that best explains the deviation between $\\sigma_{xx}^{\\mathrm{meas}}$ and $\\sigma_{xx}^{\\mathrm{cold}}$ under the isothermal warm correction. Express the final $T_{e}$ in electron-volts. Round your answer to three significant figures.\n\nExpress the final $T_{e}$ in $\\mathrm{eV}$.",
            "solution": "The problem asks for the derivation of a warm-plasma model for the cross-field conductivity $\\sigma_{xx}$, its validation against a cold-plasma prediction, and the inference of the electron temperature $T_e$ from a given measurement.\n\n### Step 1: Problem Validation\n\nThe problem is subjected to a rigorous validation process.\n\n**1. Extract Givens:**\n-   Electron number density: $n_{0} = 1.0 \\times 10^{18}\\ \\mathrm{m}^{-3}$\n-   Background magnetic field: $\\mathbf{B}_{0} = \\hat{\\mathbf{z}} B_{0}$, with $B_{0} = 0.080\\ \\mathrm{T}$\n-   Electric field perturbation: $\\mathbf{E}(x,t) = \\Re\\{ \\hat{\\mathbf{x}} E_{0} \\exp(i k x - i \\omega t) \\}$\n-   Electron-neutral collision frequency: $\\nu = 6.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$\n-   Driving frequency: $f = 4.0 \\times 10^{6}\\ \\mathrm{Hz}$, so $\\omega = 2 \\pi f$\n-   Wavenumber: $k = 1.20 \\times 10^{4}\\ \\mathrm{m}^{-1}$\n-   Fundamental constants: $e$, $m_{e}$, $k_{B}$\n-   Measured complex conductivity: $\\sigma_{xx}^{\\mathrm{meas}} = (2.258 \\times 10^{-3}) - i\\,(4.191 \\times 10^{-3})\\ \\mathrm{S/m}$\n-   Assumptions: Linearized electron fluid equations, singly ionized plasma, negligible ion motion, scalar isothermal pressure $p_{e} = n k_{B} T_{e}$.\n\n**2. Validate Using Extracted Givens:**\n-   **Scientifically Grounded:** The problem is firmly rooted in the standard fluid model of plasma physics, a cornerstone of the field. The concepts used (Drude model, cyclotron motion, pressure gradients) are fundamental.\n-   **Well-Posed:** The problem is clearly defined, with sufficient information provided to derive the model and compute the requested quantity. It leads to a unique, stable solution for $T_e$.\n-   **Objective:** The problem is stated using precise, unambiguous scientific language and quantitative data.\n-   **Consistency Check:** The problem states $|\\omega| \\ll \\omega_{pe}$. We can verify this.\n    $\\omega = 2\\pi(4.0 \\times 10^6\\ \\mathrm{s}^{-1}) \\approx 2.51 \\times 10^7\\ \\mathrm{rad/s}$.\n    The electron plasma frequency is $\\omega_{pe} = \\sqrt{n_0 e^2 / (\\epsilon_0 m_e)} \\approx \\sqrt{(10^{18})(1.6\\times 10^{-19})^2 / ((8.85\\times 10^{-12})(9.1\\times 10^{-31}))} \\approx 5.6 \\times 10^{10}\\ \\mathrm{rad/s}$.\n    The condition $2.51 \\times 10^7 \\ll 5.6 \\times 10^{10}$ is satisfied. All parameters are physically realistic for a laboratory plasma.\n\n**3. Verdict and Action:**\nThe problem statement is scientifically sound, self-contained, and well-posed. The validation is passed. We proceed to the solution.\n\n### Task 1: Derivation of the Warm-Plasma Conductivity $\\sigma_{xx}(\\omega, k)$\n\nWe start with the linearized momentum equation for the electron fluid:\n$$m_e n_0 \\frac{\\partial \\mathbf{v}_{e1}}{\\partial t} = -n_0 e (\\mathbf{E}_1 + \\mathbf{v}_{e1} \\times \\mathbf{B}_0) - \\nabla p_{e1} - m_e n_0 \\nu \\mathbf{v}_{e1}$$\nwhere the subscript '1' denotes first-order perturbed quantities. For a time-harmonic perturbation of the form $\\exp(i k x - i \\omega t)$, the differential operators become $\\frac{\\partial}{\\partial t} \\to -i\\omega$ and $\\nabla \\to i \\mathbf{k} = i k \\hat{\\mathbf{x}}$.\n\nThe momentum equation becomes:\n$$-i\\omega m_e n_0 \\mathbf{v}_{e1} = -n_0 e (\\mathbf{E}_1 + \\mathbf{v}_{e1} \\times \\mathbf{B}_0) - i k \\hat{\\mathbf{x}} p_{e1} - m_e n_0 \\nu \\mathbf{v}_{e1}$$\nDividing by $n_0$ and rearranging gives:\n$$m_e(\\nu - i\\omega)\\mathbf{v}_{e1} + e(\\mathbf{v}_{e1} \\times \\mathbf{B}_0) = -e\\mathbf{E}_1 - \\frac{i k \\hat{\\mathbf{x}} p_{e1}}{n_0}$$\nWith $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ and $\\mathbf{v}_{e1} = v_{x}\\hat{\\mathbf{x}} + v_{y}\\hat{\\mathbf{y}}$, the cross product is $e(\\mathbf{v}_{e1} \\times \\mathbf{B}_0) = eB_0(v_y \\hat{\\mathbf{x}} - v_x \\hat{\\mathbf{y}})$. We define the electron cyclotron frequency as $\\Omega_e = eB_0/m_e$. The component equations are:\n$$x: \\quad m_e(\\nu-i\\omega)v_x + m_e\\Omega_e v_y = -eE_x - \\frac{ik p_{e1}}{n_0}$$\n$$y: \\quad m_e(\\nu-i\\omega)v_y - m_e\\Omega_e v_x = 0$$\nThe pressure perturbation $p_{e1}$ is related to the density perturbation $n_{e1}$ by the isothermal assumption, $p_{e1} = n_{e1} k_B T_e$. The density perturbation is found from the linearized continuity equation:\n$$\\frac{\\partial n_{e1}}{\\partial t} + \\nabla \\cdot (n_0 \\mathbf{v}_{e1}) = 0 \\implies -i\\omega n_{e1} + i n_0 k v_x = 0$$\nThis gives $n_{e1} = \\frac{n_0 k}{\\omega}v_x$. The pressure gradient term is then:\n$$\\frac{ik p_{e1}}{n_0} = \\frac{ik}{n_0}(n_{e1} k_B T_e) = \\frac{ik}{n_0} \\left(\\frac{n_0 k v_x}{\\omega}\\right) k_B T_e = i \\frac{k^2 k_B T_e}{\\omega} v_x$$\nSubstituting this into the $x$-momentum equation:\n$$m_e(\\nu-i\\omega)v_x + m_e\\Omega_e v_y = -eE_x - i \\frac{k^2 k_B T_e}{\\omega} v_x$$\nFrom the $y$-momentum equation, we find $v_y = \\frac{\\Omega_e}{\\nu-i\\omega}v_x$. Substituting this into the modified $x$-momentum equation gives:\n$$v_x \\left[ m_e(\\nu-i\\omega) + \\frac{m_e \\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 k_B T_e}{\\omega} \\right] = -eE_x$$\nThe current density is $J_x = -n_0 e v_x$, and the conductivity is $\\sigma_{xx} = J_x/E_x$. Thus:\n$$\\sigma_{xx}(\\omega, k) = \\frac{n_0 e^2}{m_e(\\nu-i\\omega) + \\frac{m_e \\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 k_B T_e}{\\omega}}$$\nDefining the electron thermal velocity squared as $v_{th,e}^2 = k_B T_e / m_e$, we get the final form of the model:\n$$\\sigma_{xx}(\\omega, k) = \\frac{n_0 e^2/m_e}{(\\nu-i\\omega) + \\frac{\\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 v_{th,e}^2}{\\omega}}$$\n**Cold-Plasma Limit:** In the limit $T_e \\to 0$, we have $v_{th,e} \\to 0$, and the expression reduces to the cold, magnetized Drude response:\n$$\\sigma_{xx}^{\\mathrm{cold}} = \\frac{n_0 e^2/m_e}{(\\nu-i\\omega) + \\frac{\\Omega_e^2}{\\nu-i\\omega}} = \\frac{n_0 e^2}{m_e} \\frac{\\nu-i\\omega}{(\\nu-i\\omega)^2 + \\Omega_e^2}$$\n**Warm Correction:** The warm-plasma correction is the term $i \\frac{k^2 v_{th,e}^2}{\\omega}$ in the denominator, which arises from the electron pressure gradient.\n\n### Task 2: Cold-Plasma Prediction $\\sigma_{xx}^{\\mathrm{cold}}$\n\nWe calculate the required physical parameters:\n-   $\\omega = 2\\pi f = 2\\pi (4.0 \\times 10^6\\ \\mathrm{s}^{-1}) \\approx 2.5133 \\times 10^7\\ \\mathrm{rad/s}$\n-   $\\nu = 6.0 \\times 10^7\\ \\mathrm{s}^{-1}$\n-   $\\Omega_e = \\frac{eB_0}{m_e} = \\frac{(1.6022 \\times 10^{-19}\\ \\mathrm{C})(0.080\\ \\mathrm{T})}{9.1094 \\times 10^{-31}\\ \\mathrm{kg}} \\approx 1.4071 \\times 10^{10}\\ \\mathrm{rad/s}$\n\nSince $\\Omega_e \\gg \\omega, \\nu$, the denominator of $\\sigma_{xx}^{\\mathrm{cold}}$ can be approximated as $(\\nu-i\\omega)^2 + \\Omega_e^2 \\approx \\Omega_e^2$.\n$$\\sigma_{xx}^{\\mathrm{cold}} \\approx \\frac{n_0 e^2}{m_e} \\frac{\\nu-i\\omega}{\\Omega_e^2} = \\frac{n_0 e^2}{m_e} \\frac{\\nu-i\\omega}{(eB_0/m_e)^2} = \\frac{n_0 m_e}{B_0^2}(\\nu - i\\omega)$$\nCalculating the prefactor:\n$$\\frac{n_0 m_e}{B_0^2} = \\frac{(1.0 \\times 10^{18}\\ \\mathrm{m}^{-3})(9.1094 \\times 10^{-31}\\ \\mathrm{kg})}{(0.080\\ \\mathrm{T})^2} \\approx 1.4233 \\times 10^{-10}\\ \\mathrm{s^2/(\\Omega \\cdot m)}$$\nNow, we compute $\\sigma_{xx}^{\\mathrm{cold}}$:\n$$\\sigma_{xx}^{\\mathrm{cold}} \\approx (1.4233 \\times 10^{-10}) \\left( (6.0 \\times 10^7) - i(2.5133 \\times 10^7) \\right)\\ \\mathrm{S/m}$$\n$$\\sigma_{xx}^{\\mathrm{cold}} \\approx (8.540 \\times 10^{-3}) - i(3.578 \\times 10^{-3})\\ \\mathrm{S/m}$$\n\n### Task 3: Inferring Electron Temperature $T_e$\n\nWe start from the derived model for $\\sigma_{xx}$. Let's express its inverse:\n$$\\frac{1}{\\sigma_{xx}} = \\frac{m_e}{n_0 e^2} \\left( (\\nu-i\\omega) + \\frac{\\Omega_e^2}{\\nu-i\\omega} + i \\frac{k^2 k_B T_e}{m_e \\omega} \\right)$$\nThis can be written as:\n$$\\frac{1}{\\sigma_{xx}} = \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}} + i \\frac{m_e k^2 k_B T_e}{n_0 e^2 m_e \\omega} = \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}} + i \\frac{k^2 k_B T_e}{n_0 e^2 \\omega}$$\nWe can now solve for the thermal energy $\\Theta_e = k_B T_e$ by substituting $\\sigma_{xx} = \\sigma_{xx}^{\\mathrm{meas}}$:\n$$i \\frac{k^2 \\Theta_e}{n_0 e^2 \\omega} = \\frac{1}{\\sigma_{xx}^{\\mathrm{meas}}} - \\frac{1}{\\sigma_{xx}^{\\mathrm{cold}}} = \\frac{\\sigma_{xx}^{\\mathrm{cold}} - \\sigma_{xx}^{\\mathrm{meas}}}{\\sigma_{xx}^{\\mathrm{meas}} \\sigma_{xx}^{\\mathrm{cold}}}$$\n$$\\Theta_e = \\frac{n_0 e^2 \\omega}{i k^2} \\left( \\frac{\\sigma_{xx}^{\\mathrm{cold}} - \\sigma_{xx}^{\\mathrm{meas}}}{\\sigma_{xx}^{\\mathrm{meas}} \\sigma_{xx}^{\\mathrm{cold}}} \\right) = -i \\frac{n_0 e^2 \\omega}{k^2} \\left( \\frac{\\sigma_{xx}^{\\mathrm{cold}} - \\sigma_{xx}^{\\mathrm{meas}}}{\\sigma_{xx}^{\\mathrm{meas}} \\sigma_{xx}^{\\mathrm{cold}}} \\right)$$\nLet's compute the terms in the bracket:\n-   $\\Delta\\sigma = \\sigma_{xx}^{\\mathrm{cold}} - \\sigma_{xx}^{\\mathrm{meas}} = (8.540 - 2.258)\\times 10^{-3} - i(3.578 - 4.191)\\times 10^{-3} = (6.282 + i\\,0.613) \\times 10^{-3}\\ \\mathrm{S/m}$\n-   $\\sigma_{xx}^{\\mathrm{meas}} \\sigma_{xx}^{\\mathrm{cold}} = ((2.258 - i\\,4.191)\\times 10^{-3})((8.540 - i\\,3.578)\\times 10^{-3}) \\approx (4.288 - i\\,43.869) \\times 10^{-6}\\ (\\mathrm{S/m})^2$\nThe ratio is:\n$$\\frac{\\Delta\\sigma}{\\sigma_{xx}^{\\mathrm{meas}} \\sigma_{xx}^{\\mathrm{cold}}} = \\frac{6.282 + i\\,0.613}{4.288 - i\\,43.869} \\times 10^3 \\approx (0.0175 + i\\,143.17)\\ \\mathrm{m/S}$$\nThe prefactor is:\n$$C = \\frac{n_0 e^2 \\omega}{k^2} = \\frac{(1.0 \\times 10^{18})(1.6022 \\times 10^{-19})^2(2.5133 \\times 10^7)}{(1.20 \\times 10^4)^2} \\approx 4.481 \\times 10^{-21}\\ \\mathrm{J}$$\nNow, we find $\\Theta_e$:\n$$\\Theta_e = -i C \\left( \\frac{\\Delta\\sigma}{\\sigma_{xx}^{\\mathrm{meas}} \\sigma_{xx}^{\\mathrm{cold}}} \\right) \\approx -i (4.481 \\times 10^{-21}) (0.0175 + i\\,143.17)$$\n$$\\Theta_e \\approx (-i)^2 (4.481 \\times 10^{-21})(143.17) - i (4.481 \\times 10^{-21})(0.0175)$$\n$$\\Theta_e \\approx (6.414 \\times 10^{-19}) - i (7.842 \\times 10^{-23})\\ \\mathrm{J}$$\nThe thermal energy $k_B T_e$ must be a real quantity. The small imaginary part is attributable to experimental uncertainty or rounding in the provided data. We take the real part as the physical value.\n$$\\Theta_e = k_B T_e \\approx 6.414 \\times 10^{-19}\\ \\mathrm{J}$$\nTo express this energy in electron-volts (eV), we divide by the elementary charge $e$:\n$$T_e\\,[\\mathrm{eV}] = \\frac{\\Theta_e}{e} = \\frac{6.414 \\times 10^{-19}\\ \\mathrm{J}}{1.6022 \\times 10^{-19}\\ \\mathrm{J/eV}} \\approx 4.003\\ \\mathrm{eV}$$\nRounding to three significant figures, we get $T_e = 4.00\\ \\mathrm{eV}$.",
            "answer": "$$\\boxed{4.00}$$"
        },
        {
            "introduction": "Having established how temperature affects the local dielectric response, we now investigate the macroscopic consequences for wave propagation. This practice requires you to implement a Hamiltonian ray-tracing code, a standard tool for modeling wave heating and current drive in fusion devices. You will apply both cold and warm dielectric models to calculate the refractive index and trace the path of an electron cyclotron wave through an inhomogeneous magnetic field, directly visualizing how thermal corrections alter the predicted trajectory of wave energy .",
            "id": "4063062",
            "problem": "Consider a two-dimensional slab plasma model relevant to computational fusion science and engineering in which an electron cyclotron wave at fixed angular frequency $\\omega$ propagates in the plane perpendicular to a static magnetic field $\\mathbf{B}$. The magnetic field is oriented along the $\\hat{\\mathbf{z}}$ direction and varies only with the Cartesian coordinate $x$ as $B(x) = B_{0}\\left(1 + s\\, x\\right)$, where $B_{0}$ is the on-axis field and $s$ is a constant magnetic shear parameter with units of inverse meters. The electron number density $n_{e}$ is spatially uniform. The wave is launched from position $x = x_{0}$ with propagation direction characterized by an initial angle $\\alpha_{0}$ (measured in degrees) with respect to the $x$-axis, and is traced until it reaches $x = x_{1}$, with $x_{1}  x_{0}$.\n\nStarting from Maxwell’s equations in a magnetized plasma and the eikonal (geometric optics) ansatz, the wave dispersion can be written in terms of the cold-plasma dielectric tensor $\\boldsymbol{\\varepsilon}(\\omega, \\mathbf{B}, n_{e})$. Specialize this general relation to perpendicular propagation with respect to $\\mathbf{B}$ and identify the extraordinary mode (also known as the $X$-mode) refractive index $n(x)$ in terms of the standard Stix parameters constructed from the electron plasma frequency $\\omega_{pe}$ and the electron cyclotron frequency $\\omega_{ce}$. Treat the plasma as composed of electrons and a static ion background for which ion dynamical effects are negligible at the electron cyclotron wave frequency. For a warm correction, use an effective relativistic mass factor $\\gamma = 1 + \\tfrac{3}{2}\\,\\theta$, where $\\theta = k_{B} T_{e}/(m_{e} c^{2})$, $T_{e}$ is the electron temperature, $k_{B}$ is the Boltzmann constant, $m_{e}$ is the electron rest mass, and $c$ is the speed of light. Implement the warm correction by replacing $\\omega_{ce} \\to \\omega_{ce}/\\gamma$ and $\\omega_{pe}^{2} \\to \\omega_{pe}^{2}/\\gamma$.\n\nUse Hamiltonian ray tracing in an inhomogeneous but laterally invariant medium (invariance in the $y$ direction) to show that the $y$-component of the wave vector $k_{y}$ is an invariant of motion and that the ray trajectory $y(x)$ satisfies a first-order differential equation of the form\n$$\n\\frac{dy}{dx} = \\frac{k_{y}}{k_{x}(x)},\n$$\nwith $|\\mathbf{k}(x)| = \\tfrac{\\omega}{c}\\, n(x)$ and $k_{x}(x) = \\sqrt{|\\mathbf{k}(x)|^{2} - k_{y}^{2}}$. The invariant $k_{y}$ is fixed by the launch condition at $x = x_{0}$ through $k_{y} = |\\mathbf{k}(x_{0})| \\sin\\alpha_{0}$, where $\\alpha_{0}$ is converted to radians. Assume that the $X$-mode refractive index is an isotropic function within the plane perpendicular to $\\mathbf{B}$ for perpendicular propagation, so that $n(x)$ depends only on $x$ via $B(x)$ and $n_{e}$.\n\nYour task is to compute, for each of the following test cases, the difference in the lateral displacement between the warm-corrected and cold-plasma predictions at $x = x_{1}$:\n$$\n\\Delta y \\equiv y_{\\text{warm}}(x_{1}) - y_{\\text{cold}}(x_{1}).\n$$\nIntegrate the ray equation from $x_{0}$ to $x_{1}$ for both the cold and warm cases using a numerically stable method that handles smooth spatial variation of $n(x)$. If $n^{2}(x)$ becomes non-positive in the domain for either model, stop the integration before the singular point and use the last well-defined value, but the provided test cases are designed so that $n^{2}(x)  0$ over the interval.\n\nPhysical constants must be used in SI units. Express the final results $\\Delta y$ in meters, rounded to six decimal places. Angles must be treated in degrees for inputs and converted to radians internally for calculations.\n\nUse the following test suite, which sets $(B_{0}, s, n_{e}, f, T_{e}, x_{0}, x_{1}, \\alpha_{0})$ for each case, where $f$ is the frequency in hertz, $T_{e}$ is the electron temperature in electronvolts, and all lengths are in meters:\n\n- Case A (no magnetic shear, baseline comparison): $B_{0} = 5.0$ T, $s = 0.0$ m$^{-1}$, $n_{e} = 5.0\\times 10^{19}$ m$^{-3}$, $f = 170.0\\times 10^{9}$ Hz, $T_{e} = 10{,}000$ eV, $x_{0} = 0.0$ m, $x_{1} = 0.05$ m, $\\alpha_{0} = 30.0$ degrees.\n- Case B (moderate negative shear): $B_{0} = 5.0$ T, $s = -1.0$ m$^{-1}$, $n_{e} = 5.0\\times 10^{19}$ m$^{-3}$, $f = 170.0\\times 10^{9}$ Hz, $T_{e} = 10{,}000$ eV, $x_{0} = 0.0$ m, $x_{1} = 0.05$ m, $\\alpha_{0} = 30.0$ degrees.\n- Case C (stronger negative shear): $B_{0} = 5.0$ T, $s = -4.0$ m$^{-1}$, $n_{e} = 5.0\\times 10^{19}$ m$^{-3}$, $f = 170.0\\times 10^{9}$ Hz, $T_{e} = 10{,}000$ eV, $x_{0} = 0.0$ m, $x_{1} = 0.05$ m, $\\alpha_{0} = 30.0$ degrees.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\Delta y_{A},\\Delta y_{B},\\Delta y_{C}]$, where each entry is a floating-point value in meters rounded to six decimal places.",
            "solution": "The problem requires the calculation of the difference in lateral displacement, $\\Delta y$, between a warm and a cold plasma model for an electron cyclotron wave traversing a magnetized slab plasma. The solution involves deriving the wave's refractive index, setting up the ray tracing equations, and numerically integrating them.\n\nFirst, we establish the physical framework. The wave propagates in a two-dimensional slab geometry ($x,y$-plane) with a static magnetic field $\\mathbf{B}$ aligned with the $\\hat{\\mathbf{z}}$ direction. The field strength varies with position $x$ as $B(x) = B_{0}(1 + s\\,x)$. The electron number density $n_e$ is uniform. The wave frequency is $\\omega = 2\\pi f$.\n\nThe key to describing the wave propagation is the refractive index, $n(x)$, which is derived from the plasma's dielectric tensor, $\\boldsymbol{\\varepsilon}$. For an electron-ion plasma where ion motion is neglected (valid at high frequencies like those of electron cyclotron waves), and for propagation perpendicular to $\\mathbf{B}$, the dispersion relation separates into two modes: the Ordinary (O-mode) and the Extraordinary (X-mode). The problem specifies the X-mode.\n\nThe X-mode refractive index, $n_X$, is given by the formula:\n$$\nn_X^2 = \\frac{R L}{S}\n$$\nwhere $R$, $L$, and $S$ are Stix parameters. These are defined using the dimensionless quantities $X = \\omega_{pe}^2/\\omega^2$ and $Y(x) = \\omega_{ce}(x)/\\omega$. The electron plasma frequency, $\\omega_{pe}$, is constant as $n_e$ is uniform: $\\omega_{pe}^2 = \\frac{n_e e^2}{\\varepsilon_0 m_e}$. The electron cyclotron frequency, $\\omega_{ce}(x)$, depends on the local magnetic field: $\\omega_{ce}(x) = \\frac{|e| B(x)}{m_e}$. Here, $e$ is the elementary charge, $m_e$ is the electron rest mass, and $\\varepsilon_0$ is the vacuum permittivity.\nThe Stix parameters are:\n$$\nR(x) = 1 - \\frac{X}{1-Y(x)}, \\quad L(x) = 1 - \\frac{X}{1+Y(x)}, \\quad S(x) = \\frac{R(x)+L(x)}{2} = 1 - \\frac{X}{1-Y(x)^2}\n$$\nSubstituting these into the formula for $n_X^2$ yields an expression in terms of $X$ and $Y(x)$:\n$$\nn_X^2(x) = \\frac{(1-X)^2 - Y(x)^2}{1 - Y(x)^2 - X}\n$$\nThis expression constitutes our cold-plasma model, which we denote as $n_{\\text{cold}}^2(x)$.\n\nThe problem introduces a warm-plasma correction through an effective relativistic mass factor, $\\gamma$. This accounts for first-order thermal effects. The factor is given by $\\gamma = 1 + \\frac{3}{2}\\theta$, with $\\theta = \\frac{k_B T_e}{m_e c^2}$, where $T_e$ is the electron temperature, $k_B$ is the Boltzmann constant, and $c$ is the speed of light. Note that if $T_e$ is given in electronVolts (eV), the thermal energy is $k_B T_e \\equiv T_e[\\text{eV}] \\times e$. The warm-plasma model is implemented by replacing the electron rest mass $m_e$ with an effective mass $\\gamma m_e$. This modifies the characteristic frequencies as follows:\n$$\n\\omega_{ce} \\to \\omega_{ce,w} = \\frac{\\omega_{ce}}{\\gamma}, \\quad \\omega_{pe}^2 \\to \\omega_{pe, w}^2 = \\frac{\\omega_{pe}^2}{\\gamma}\n$$\nConsequently, the dimensionless parameters become $X_w = X/\\gamma$ and $Y_w(x) = Y(x)/\\gamma$. The warm-plasma refractive index, $n_{\\text{warm}}^2(x)$, is then:\n$$\nn_{\\text{warm}}^2(x) = \\frac{(1-X_w)^2 - Y_w(x)^2}{1 - Y_w(x)^2 - X_w}\n$$\nWith the refractive index models defined, we proceed to the ray tracing. The problem states that for a medium with invariance in the $y$-direction, the $y$-component of the wave vector, $k_y$, is a conserved quantity (an invariant of motion). This is a manifestation of Snell's law in a continuously varying medium. The initial value of $k_y$ is determined at the launch position $x=x_0$ with launch angle $\\alpha_0$:\n$$\nk_y = |\\mathbf{k}(x_0)| \\sin(\\alpha_{0,rad}) = \\frac{\\omega}{c} n(x_0) \\sin(\\alpha_{0,rad})\n$$\nwhere $\\alpha_{0,rad}$ is the launch angle in radians. Note that since $n_{\\text{cold}}(x_0) \\neq n_{\\text{warm}}(x_0)$, the conserved quantity $k_y$ will have a different value for each model: $k_{y, \\text{cold}} \\neq k_{y, \\text{warm}}$.\n\nThe ray trajectory $y(x)$ is determined by the differential equation:\n$$\n\\frac{dy}{dx} = \\frac{k_y}{k_x(x)}\n$$\nwhere $k_x(x)$ is the $x$-component of the wave vector. From the fundamental relation $|\\mathbf{k}(x)|^2 = k_x(x)^2 + k_y^2 = (\\frac{\\omega}{c} n(x))^2$, we can solve for $k_x(x)$:\n$$\nk_x(x) = \\sqrt{\\left(\\frac{\\omega}{c} n(x)\\right)^2 - k_y^2}\n$$\nThe ray must satisfy $k_x^2(x)  0$ to propagate. A point where $k_x(x) = 0$ is a turning point or reflection point. The problem statement guarantees that no such points are encountered in the integration interval $[x_0, x_1]$.\n\nThe total lateral displacement at $x=x_1$ is found by integrating the ray equation, assuming the ray starts at $y(x_0)=0$:\n$$\ny(x_1) = \\int_{x_0}^{x_1} \\frac{dy}{dx} dx = \\int_{x_0}^{x_1} \\frac{k_y}{\\sqrt{(\\frac{\\omega}{c} n(x))^2 - k_y^2}} dx\n$$\nThis integral is computed numerically for both the cold and warm models.\nFor the cold model:\n$$\ny_{\\text{cold}}(x_1) = \\int_{x_0}^{x_1} \\frac{k_{y, \\text{cold}}}{\\sqrt{(\\frac{\\omega}{c} n_{\\text{cold}}(x))^2 - k_{y, \\text{cold}}^2}} dx\n$$\nFor the warm model:\n$$\ny_{\\text{warm}}(x_1) = \\int_{x_0}^{x_1} \\frac{k_{y, \\text{warm}}}{\\sqrt{(\\frac{\\omega}{c} n_{\\text{warm}}(x))^2 - k_{y, \\text{warm}}^2}} dx\n$$\nThe final quantity of interest is the difference between these two displacements:\n$$\n\\Delta y = y_{\\text{warm}}(x_1) - y_{\\text{cold}}(x_1)\n$$\nThe calculation is performed for each test case using the provided parameters. For the special case where the magnetic shear $s=0$, the magnetic field is uniform, so the refractive index $n$ is constant throughout the medium. Consequently, the ray path is a straight line at the launch angle $\\alpha_0$. The lateral displacement $y(x_1) = (x_1 - x_0) \\tan(\\alpha_0)$ is identical for both models (even though $n_{\\text{cold}} \\neq n_{\\text{warm}}$), leading to $\\Delta y = 0$. This serves as a validation for our methodology. For $s \\neq 0$, the spatial variation of $n(x)$ necessitates numerical integration.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to solve the ray tracing problem for all test cases.\n    \"\"\"\n    \n    # Physical constants in SI units\n    C = 299792458.0  # Speed of light in m/s\n    M_E = 9.1093837015e-31  # Electron rest mass in kg\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in F/m\n\n    def calculate_n_squared(B, ne, omega, Te_eV=None):\n        \"\"\"\n        Calculates the square of the X-mode refractive index for a given set of\n        plasma parameters.\n        \n        Args:\n            B (float): Magnetic field strength in Tesla.\n            ne (float): Electron number density in m^-3.\n            omega (float): Wave angular frequency in rad/s.\n            Te_eV (float, optional): Electron temperature in eV. If provided,\n                                     a warm plasma correction is applied.\n                                     Defaults to None (cold plasma).\n        Returns:\n            float: The square of the refractive index, n^2.\n        \"\"\"\n        # Base plasma parameter (frequency squared)\n        omega_pe_sq = (ne * E_CHARGE**2) / (EPSILON_0 * M_E)\n        \n        # Base cyclotron frequency\n        omega_ce = (E_CHARGE * B) / M_E\n        \n        # Apply warm plasma correction if temperature is specified\n        if Te_eV is not None:\n            # Thermal energy in Joules\n            Te_J = Te_eV * E_CHARGE\n            # Relativistic parameter theta\n            theta = Te_J / (M_E * C**2)\n            # Effective relativistic mass factor gamma\n            gamma = 1.0 + 1.5 * theta\n            \n            # Apply correction to frequencies\n            omega_pe_sq /= gamma\n            omega_ce /= gamma\n            \n        # Standard Stix parameters\n        X = omega_pe_sq / omega**2\n        Y = omega_ce / omega\n        \n        # The problem cases are designed to avoid resonances/cutoffs where\n        # denominators are zero.\n        denominator = 1.0 - Y**2 - X\n        if abs(denominator)  1e-15:\n            # Return a large negative value to indicate a singularity\n            return -1e20\n\n        numerator = (1.0 - X)**2 - Y**2\n        \n        n_sq = numerator / denominator\n        \n        return n_sq\n\n    def solve_case(params):\n        \"\"\"\n        Solves for the lateral displacement difference for a single test case.\n        \"\"\"\n        B0, s, ne, f, Te_eV, x0, x1, alpha0_deg = params\n        \n        omega = 2.0 * np.pi * f\n        alpha0_rad = np.deg2rad(alpha0_deg)\n        \n        # --- Cold Plasma Calculation ---\n        def dydx_cold(x, k_y_cold_val):\n            B_x = B0 * (1.0 + s * x)\n            n_sq_x = calculate_n_squared(B_x, ne, omega, Te_eV=None)\n            \n            if n_sq_x = 0:\n                raise ValueError(f\"Cold plasma n^2 = 0 at x={x}\")\n                \n            kx_sq = (omega/C)**2 * n_sq_x - k_y_cold_val**2\n            \n            if kx_sq = 0:\n                raise ValueError(f\"Cold plasma turning point reached at x={x}\")\n            \n            return k_y_cold_val / np.sqrt(kx_sq)\n\n        B_at_x0 = B0 * (1.0 + s * x0)\n        n_sq_cold_x0 = calculate_n_squared(B_at_x0, ne, omega, Te_eV=None)\n        n_cold_x0 = np.sqrt(n_sq_cold_x0)\n        k_y_cold = (omega / C) * n_cold_x0 * np.sin(alpha0_rad)\n        \n        y_cold_x1, _ = integrate.quad(dydx_cold, x0, x1, args=(k_y_cold,))\n        \n        # --- Warm Plasma Calculation ---\n        def dydx_warm(x, k_y_warm_val):\n            B_x = B0 * (1.0 + s * x)\n            n_sq_x = calculate_n_squared(B_x, ne, omega, Te_eV=Te_eV)\n\n            if n_sq_x = 0:\n                raise ValueError(f\"Warm plasma n^2 = 0 at x={x}\")\n\n            kx_sq = (omega/C)**2 * n_sq_x - k_y_warm_val**2\n\n            if kx_sq = 0:\n                raise ValueError(f\"Warm plasma turning point reached at x={x}\")\n                \n            return k_y_warm_val / np.sqrt(kx_sq)\n\n        n_sq_warm_x0 = calculate_n_squared(B_at_x0, ne, omega, Te_eV=Te_eV)\n        n_warm_x0 = np.sqrt(n_sq_warm_x0)\n        k_y_warm = (omega / C) * n_warm_x0 * np.sin(alpha0_rad)\n        \n        y_warm_x1, _ = integrate.quad(dydx_warm, x0, x1, args=(k_y_warm,))\n        \n        # --- Final Result ---\n        delta_y = y_warm_x1 - y_cold_x1\n        return delta_y\n\n    # Test suite from the problem description\n    test_cases = [\n        # (B0, s, ne, f, Te, x0, x1, alpha0)\n        (5.0, 0.0, 5.0e19, 170.0e9, 10000.0, 0.0, 0.05, 30.0), # Case A\n        (5.0, -1.0, 5.0e19, 170.0e9, 10000.0, 0.0, 0.05, 30.0),# Case B\n        (5.0, -4.0, 5.0e19, 170.0e9, 10000.0, 0.0, 0.05, 30.0),# Case C\n    ]\n    \n    results = []\n    for case in test_cases:\n        delta_y = solve_case(case)\n        # Format to six decimal places\n        results.append(f\"{delta_y:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Finally, we delve into the numerical core of advanced kinetic theory, which underpins the most accurate warm-plasma models. This exercise focuses on the evaluation of the integrals that define the plasma susceptibility, paying close attention to the contribution of finite Larmor radius (FLR) effects encapsulated in the function $\\Gamma_n(a)$. By implementing and comparing different numerical quadrature schemes against an exact analytical solution, you will gain critical insight into the trade-offs between accuracy and computational efficiency when translating complex physical theories into robust simulation code .",
            "id": "4063091",
            "problem": "A warm magnetized plasma dielectric model requires sums of species susceptibilities over cyclotron harmonics, and the accuracy of these sums depends on the numerical evaluation of velocity-space averages that appear in the linear response derived from the Vlasov equation for a Maxwellian species. A central quantity in the warm response is the perpendicular velocity-space average of squared cylindrical Bessel functions weighted by the Maxwellian. For a species with thermal Larmor radius parameter $a = (k_\\perp \\rho)^2$, where $k_\\perp$ is the perpendicular wavenumber and $\\rho$ is the thermal Larmor radius defined by $\\rho = v_{\\mathrm{th}}/\\Omega$ with $v_{\\mathrm{th}}$ the thermal speed and $\\Omega$ the cyclotron frequency, the harmonic-resolved perpendicular average is defined by\n$$\n\\Gamma_n(a) \\equiv \\int_{0}^{\\infty} e^{-u}\\, J_n^2\\!\\big(\\sqrt{2 a\\, u}\\big)\\, du,\n$$\nwhere $J_n$ is the cylindrical Bessel function of the first kind of integer order $n$, and $u = v_\\perp^2 / v_{\\mathrm{th}}^2$ is the dimensionless perpendicular kinetic energy variable. The warm susceptibility tensor elements contain sums of the form $\\sum_{n=-\\infty}^{\\infty} \\Gamma_n(a)\\,(\\cdots)$ over the cyclotron harmonic index $n$, and accurate evaluation of $\\Gamma_n(a)$ across $n$ in the regime $k_\\perp \\rho \\sim 1$ is critical for validating warm dielectric models against measurements that probe finite Larmor radius effects.\n\nStarting from the definitions above and well-tested identities of special functions, it can be shown that the exact value of $\\Gamma_n(a)$ admits a closed-form expression in terms of the modified Bessel function of the first kind $I_n$. However, in computational practice one often evaluates $\\Gamma_n(a)$ numerically by quadrature, and must balance accuracy and performance.\n\nTask: Implement two distinct numerical quadrature schemes to evaluate $\\Gamma_n(a)$ for each integer $n \\in \\{-N,\\ldots,N\\}$ and then form the truncated warm susceptibility sum $S_N(a) = \\sum_{n=-N}^{N} \\Gamma_n(a)$. The two schemes you must compare are:\n- Gauss–Laguerre quadrature of order $M$, which targets integrals of the form $\\int_{0}^{\\infty} e^{-u} f(u)\\, du$ by evaluating $f(u)$ at $M$ specialized nodes with corresponding weights.\n- Composite Simpson’s rule on a finite interval $[0,U]$ with an even number of subintervals $K$, applied directly to the weighted integrand $e^{-u} J_n^2(\\sqrt{2 a u})$. For this scheme, you must choose a finite $U$ and treat the neglected tail $\\int_{U}^{\\infty} e^{-u} J_n^2(\\sqrt{2 a u})\\, du$ conservatively; note that $0 \\le J_n^2(\\cdot) \\le 1$ for real arguments, so the tail is bounded above by $e^{-U}$.\n\nUse as a reference baseline the exact $\\Gamma_n(a)$ implied by standard warm plasma theory and the fundamental definitions above, expressed in terms of known special functions. For each test case, compute:\n- The maximum absolute error across $n \\in \\{-N,\\ldots,N\\}$ for Gauss–Laguerre, defined as $\\max_{-N \\le n \\le N} |\\Gamma_n^{\\mathrm{GL}}(a) - \\Gamma_n^{\\mathrm{exact}}(a)|$.\n- The maximum absolute error across $n \\in \\{-N,\\ldots,N\\}$ for Simpson, defined similarly.\n- The total number of integrand evaluations performed by each scheme across all $n$. For Gauss–Laguerre, count each evaluation of $J_n^2(\\sqrt{2 a u})$ at a quadrature node as one integrand evaluation, and sum over all $n$. For Simpson, count each grid point evaluation of the weighted integrand $e^{-u} J_n^2(\\sqrt{2 a u})$ as one integrand evaluation, summed over all $n$.\n- The absolute error in the truncated susceptibility sum $S_N(a)$ for each method, defined as $|S_N^{\\mathrm{method}}(a) - S_N^{\\mathrm{exact}}(a)|$, where $S_N^{\\mathrm{exact}}(a) \\equiv \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{exact}}(a)$.\n\nAll quantities in this problem are dimensionless. Your program must compute the above four metrics for each test case and output them as floats or integers. Design your implementation so that the evaluation of special functions uses widely available, numerically stable routines.\n\nTest Suite:\n- Case 1 (happy path, finite Larmor radius): $a = 1$, $N = 10$, Gauss–Laguerre order $M = 32$, Simpson interval $[0,U]$ with $U = 20$ and $K = 2000$ subintervals.\n- Case 2 (cold-limit boundary): $a = 10^{-4}$, $N = 2$, $M = 16$, $U = 20$, $K = 1000$.\n- Case 3 (strong finite Larmor radius): $a = 5$, $N = 30$, $M = 48$, $U = 20$, $K = 4000$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, where each test case’s result is itself a list containing six entries in the following order: [max_error_GaussLaguerre, max_error_Simpson, evals_GaussLaguerre, evals_Simpson, sum_error_GaussLaguerre, sum_error_Simpson]. For example: [[eGL1,eSM1,evalGL1,evalSM1,sumErrGL1,sumErrSM1],[eGL2,eSM2,evalGL2,evalSM2,sumErrGL2,sumErrSM2],[eGL3,eSM3,evalGL3,evalSM3,sumErrGL3,sumErrSM3]].",
            "solution": "The linear response of a magnetized Maxwellian plasma can be derived from the Vlasov equation with a harmonic decomposition of the gyroangle. In this framework, the warm susceptibility tensor elements for a species involve sums over the cyclotron harmonic index $n$ of Bessel-function-weighted averages over the perpendicular velocity. For a Maxwellian perpendicular distribution and a dimensionless perpendicular kinetic energy variable $u = v_\\perp^2 / v_{\\mathrm{th}}^2$, the weighting factor becomes $e^{-u}$. The finite Larmor radius appears through the argument of the cylindrical Bessel function $J_n$, and, with the standard warm plasma notation, the parameter $a = (k_\\perp \\rho)^2$ controls the magnitude of finite Larmor radius effects, where $\\rho = v_{\\mathrm{th}}/\\Omega$ is the thermal Larmor radius. The harmonic-resolved perpendicular average can be written as\n$$\n\\Gamma_n(a) = \\int_{0}^{\\infty} e^{-u}\\, J_n^2\\!\\big(\\sqrt{2 a\\, u}\\big)\\, du,\n$$\nwhich is the finite Larmor radius factor that multiplies parallel-response functions in the susceptibility.\n\nA closed-form expression for $\\Gamma_n(a)$ follows from standard identities of special functions. Using the generating function of the modified Bessel function of the first kind $I_n(x)$ and the integral identity\n$$\n\\int_0^\\infty e^{-t}\\, J_n^2\\!\\big(2\\sqrt{x t}\\big)\\, dt = e^{-2x}\\, I_n(2x),\n$$\nand taking $x = a/2$, we obtain\n$$\n\\Gamma_n(a) = e^{-a}\\, I_n(a).\n$$\nThis is a well-tested result in hot magnetized plasma theory: the perpendicular Maxwellian average of the squared Bessel function with argument $\\sqrt{2 a u}$ reduces exactly to $e^{-a} I_n(a)$. From this expression, one immediately obtains the identity\n$$\n\\sum_{n=-\\infty}^{\\infty} \\Gamma_n(a) = e^{-a} \\sum_{n=-\\infty}^{\\infty} I_n(a) = e^{-a}\\, e^{a} = 1,\n$$\nwhere we used the known series identity $\\sum_{n=-\\infty}^{\\infty} I_n(a) = e^{a}$. This identity serves as a strong internal check on implementations and is frequently used in validating warm dielectric models against the cold limit, where $a \\to 0$ yields $\\Gamma_0(0) = 1$ and $\\Gamma_{n\\ne 0}(0) = 0$.\n\nWe now design numerical quadrature schemes to evaluate $\\Gamma_n(a)$ and compare their performance and accuracy.\n\nGauss–Laguerre quadrature:\n- The Gauss–Laguerre rule of order $M$ provides nodes $\\{u_i\\}_{i=1}^M$ and weights $\\{w_i\\}_{i=1}^M$ such that\n$$\n\\int_{0}^{\\infty} e^{-u} f(u)\\, du \\approx \\sum_{i=1}^{M} w_i\\, f(u_i).\n$$\n- For our integrand $f(u) = J_n^2(\\sqrt{2 a u})$, the quadrature approximation is\n$$\n\\Gamma_n^{\\mathrm{GL}}(a) = \\sum_{i=1}^{M} w_i\\, J_n^2\\!\\big(\\sqrt{2 a\\, u_i}\\big).\n$$\n- The number of integrand evaluations is $M$ per $n$, so across $n \\in \\{-N,\\ldots,N\\}$ it is $M (2N+1)$.\n\nComposite Simpson’s rule on $[0,U]$:\n- We choose a finite cutoff $U  0$ and apply Simpson’s rule with an even number $K$ of subintervals to the integral restricted to $[0,U]$:\n$$\n\\int_{0}^{U} e^{-u} J_n^2\\!\\big(\\sqrt{2 a u}\\big)\\, du \\approx \\frac{h}{3}\\left[g(u_0) + g(u_K) + 4 \\sum_{j=1,\\,\\text{odd}}^{K-1} g(u_j) + 2 \\sum_{j=2,\\,\\text{even}}^{K-2} g(u_j)\\right],\n$$\nwhere $h = U/K$ and $u_j = j h$, and $g(u) = e^{-u} J_n^2(\\sqrt{2 a u})$.\n- The neglected tail $\\int_{U}^{\\infty} e^{-u} J_n^2(\\sqrt{2 a u})\\, du$ is bounded above by $e^{-U}$ because $0 \\le J_n^2(\\cdot) \\le 1$ for real arguments, so choosing $U = 20$ makes the tail $\\le e^{-20} \\approx 2.06\\times 10^{-9}$, which is negligible for the tolerances used here.\n- The number of integrand evaluations is $(K+1)$ per $n$, so across $n$ it is $(K+1)(2N+1)$.\n\nReference baseline:\n- The exact value is\n$$\n\\Gamma_n^{\\mathrm{exact}}(a) = e^{-a} I_n(a),\n$$\nwhich we evaluate using a numerically stable special function routine for $I_n(a)$.\n- The exact truncated sum is\n$$\nS_N^{\\mathrm{exact}}(a) = \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{exact}}(a).\n$$\nWhile the infinite sum equals $1$, the truncated sum differs from $1$ by the tail beyond $|n|  N$ and serves as a fair baseline for comparing quadrature schemes using the same truncation.\n\nError metrics:\n- For each method, compute the maximum absolute error across $n$:\n$$\nE_{\\max}^{\\mathrm{GL}} = \\max_{-N \\le n \\le N} \\left| \\Gamma_n^{\\mathrm{GL}}(a) - \\Gamma_n^{\\mathrm{exact}}(a) \\right|,\n\\quad\nE_{\\max}^{\\mathrm{S}} = \\max_{-N \\le n \\le N} \\left| \\Gamma_n^{\\mathrm{S}}(a) - \\Gamma_n^{\\mathrm{exact}}(a) \\right|.\n$$\n- Compute the absolute error in the truncated sum for each method:\n$$\n\\Delta S^{\\mathrm{GL}} = \\left| \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{GL}}(a) - S_N^{\\mathrm{exact}}(a) \\right|,\n\\quad\n\\Delta S^{\\mathrm{S}} = \\left| \\sum_{n=-N}^{N} \\Gamma_n^{\\mathrm{S}}(a) - S_N^{\\mathrm{exact}}(a) \\right|.\n$$\n\nAlgorithmic steps:\n1. For each test case $(a, N, M, U, K)$, precompute the Gauss–Laguerre nodes and weights of order $M$.\n2. For each $n \\in \\{-N,\\ldots,N\\}$:\n   - Evaluate $\\Gamma_n^{\\mathrm{GL}}(a)$ via Gauss–Laguerre.\n   - Evaluate $\\Gamma_n^{\\mathrm{S}}(a)$ via composite Simpson on $[0,U]$.\n   - Evaluate $\\Gamma_n^{\\mathrm{exact}}(a) = e^{-a} I_n(a)$.\n3. Accumulate the maximum absolute errors across $n$ for each method and the truncated sums $S_N^{\\mathrm{GL}}(a)$, $S_N^{\\mathrm{S}}(a)$, and $S_N^{\\mathrm{exact}}(a)$.\n4. Compute the total number of integrand evaluations for each method: $M (2N+1)$ for Gauss–Laguerre and $(K+1)(2N+1)$ for Simpson.\n5. Report, for each test case, a list containing $[E_{\\max}^{\\mathrm{GL}}, E_{\\max}^{\\mathrm{S}}, M(2N+1), (K+1)(2N+1), \\Delta S^{\\mathrm{GL}}, \\Delta S^{\\mathrm{S}}]$.\n\nThis procedure directly reflects the underlying physics and mathematics of the warm dielectric: it isolates the perpendicular finite Larmor radius factor $\\Gamma_n(a)$, uses quadrature tailored to the Maxwellian weighting (Gauss–Laguerre) and a standard composite rule (Simpson) with a conservative tail bound, and validates against the exact expression derived from fundamental special function identities. The $k_\\perp \\rho \\sim 1$ regime is covered by the test case with $a=1$, and boundary and strong finite Larmor radius regimes are included to assess robustness and accuracy across conditions relevant for computational fusion science and engineering validation efforts.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.laguerre import laggauss\nfrom scipy.special import jv, iv\n\ndef gamma_n_exact(a: float, n: int) - float:\n    \"\"\"\n    Exact value of Gamma_n(a) = e^{-a} I_n(a) for integer n.\n    Uses modified Bessel function of the first kind iv.\n    \"\"\"\n    return float(np.exp(-a) * iv(abs(n), a))\n\ndef gamma_n_gauss_laguerre(a: float, n: int, M: int) - float:\n    \"\"\"\n    Gauss-Laguerre quadrature for Gamma_n(a) = ∫_0^∞ e^{-u} J_n^2(sqrt(2 a u)) du.\n    Order M Gauss-Laguerre provides nodes u_i and weights w_i such that:\n    ∫_0^∞ e^{-u} f(u) du ≈ ∑ w_i f(u_i)\n    \"\"\"\n    # nodes and weights for the Laguerre polynomials (with weighting e^{-u})\n    u_nodes, w_weights = laggauss(M)\n    # Evaluate the integrand f(u) = J_n^2(sqrt(2 a u)) at Laguerre nodes\n    # Note: jv supports non-negative and negative n; we use abs(n) since the square removes sign.\n    sqrt2a = np.sqrt(2.0 * a)\n    args = sqrt2a * np.sqrt(u_nodes)\n    jn_vals = jv(abs(n), args)\n    f_vals = jn_vals * jn_vals  # J_n^2\n    return float(np.dot(w_weights, f_vals))\n\ndef gamma_n_simpson(a: float, n: int, U: float, K: int) - float:\n    \"\"\"\n    Composite Simpson's rule on [0, U] with K even subintervals for:\n    ∫_0^U e^{-u} J_n^2(sqrt(2 a u)) du\n    The neglected tail beyond U is ≤ e^{-U}.\n    \"\"\"\n    assert K % 2 == 0, \"K must be even for Simpson's rule.\"\n    h = U / K\n    # grid points u_j = j h\n    u = np.linspace(0.0, U, K + 1)\n    sqrt2a = np.sqrt(2.0 * a)\n    args = sqrt2a * np.sqrt(u)\n    jn_vals = jv(abs(n), args)\n    g = np.exp(-u) * (jn_vals * jn_vals)\n    # Simpson weights\n    S = g[0] + g[-1] + 4.0 * np.sum(g[1:-1:2]) + 2.0 * np.sum(g[2:-1:2])\n    return float(h * S / 3.0)\n\ndef run_case(a: float, N: int, M: int, U: float, K: int):\n    \"\"\"\n    Run one test case:\n    Returns [max_error_GL, max_error_Simpson, evals_GL, evals_Simpson, sum_error_GL, sum_error_Simpson]\n    \"\"\"\n    # Evaluate across n from -N to N\n    ns = list(range(-N, N + 1))\n    gamma_exact = []\n    gamma_GL = []\n    gamma_S = []\n    max_err_GL = 0.0\n    max_err_S = 0.0\n\n    for n in ns:\n        g_exact = gamma_n_exact(a, n)\n        g_GL = gamma_n_gauss_laguerre(a, n, M)\n        g_S = gamma_n_simpson(a, n, U, K)\n\n        gamma_exact.append(g_exact)\n        gamma_GL.append(g_GL)\n        gamma_S.append(g_S)\n\n        err_GL = abs(g_GL - g_exact)\n        err_S = abs(g_S - g_exact)\n        if err_GL  max_err_GL:\n            max_err_GL = err_GL\n        if err_S  max_err_S:\n            max_err_S = err_S\n\n    # Truncated sums and their errors\n    S_exact = float(np.sum(gamma_exact))\n    S_GL = float(np.sum(gamma_GL))\n    S_S = float(np.sum(gamma_S))\n    sum_err_GL = abs(S_GL - S_exact)\n    sum_err_S = abs(S_S - S_exact)\n\n    # Integrand evaluation counts\n    evals_GL = M * (2 * N + 1)\n    evals_S = (K + 1) * (2 * N + 1)\n\n    return [max_err_GL, max_err_S, evals_GL, evals_S, sum_err_GL, sum_err_S]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (a, N, M, U, K)\n    test_cases = [\n        (1.0, 10, 32, 20.0, 2000),     # Case 1: k_perp rho ~ 1\n        (1.0e-4, 2, 16, 20.0, 1000),   # Case 2: cold limit boundary\n        (5.0, 30, 48, 20.0, 4000),     # Case 3: strong finite Larmor radius\n    ]\n\n    results = []\n    for a, N, M, U, K in test_cases:\n        result = run_case(a, N, M, U, K)\n        results.append(result)\n\n    # Final print statement in the exact required format: list of lists with no spaces.\n    print(\"[\" + \",\".join(str(r).replace(\" \", \"\") for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}