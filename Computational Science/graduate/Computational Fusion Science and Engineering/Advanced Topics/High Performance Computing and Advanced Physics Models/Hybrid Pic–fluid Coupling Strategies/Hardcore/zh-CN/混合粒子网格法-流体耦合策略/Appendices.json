{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的混合模拟代码之前，首先必须对所要解决的物理问题有深刻的理解。量纲分析是一种强大的物理工具，它能帮助我们估算混合模型中各个物理项的相对重要性。通过本练习 ，您将推导并计算决定霍尔效应、电子压力梯度和有限拉莫尔半径（FLR）效应等非理想项相对于理想磁流体动力学（MHD）项大小的关键无量纲参数，从而判断在何种等离子体条件下，这些动理学效应是不可忽略的。",
            "id": "3991706",
            "problem": "一个混合的“粒子-网格”（PIC）-流体模型将离子作动力学处理，而将电子视为电荷中性的流体。考虑在碰撞、准中性等离子体极限下的电子动量方程（该方程导出广义欧姆定律），以及包含可能的有限拉莫尔半径修正的离子动量方程。您的任务是构建一个量级分析，以确定在电子广义欧姆定律中，控制非理想项相对于理想磁流体动力学（MHD）项重要性的无量纲参数。仅使用以下基本出发点：无位移电流的安培定律、阿尔芬速度的定义、等离子体贝塔值的定义、离子惯性长度的定义，以及离子回旋半径和离子热速度的定义。\n\n假设量级的基准如下：\n- 在广义欧姆定律中，理想MHD项的量级由 $| \\boldsymbol{u}_i \\times \\boldsymbol{B} |$ 设定，其中 $|\\boldsymbol{u}_i| \\sim v_A$，而 $v_A = B / \\sqrt{\\mu_0 n m_i}$ 是阿尔芬速度。\n- 霍尔项的量级为 $|( \\boldsymbol{J} \\times \\boldsymbol{B} )/(e n)|$，其中根据安培定律和单一宏观长度尺度 $L$，有 $|\\boldsymbol{J}| \\sim B/(\\mu_0 L)$。\n- 电子压力梯度项的量级为 $|\\nabla p_e|/(e n)$，其中 $|\\nabla p_e| \\sim p_e/L$。使用 $p_e = f_e n k_B T$，其中 $f_e \\equiv T_e/(T_e+T_i)$ 且 $T \\equiv T_e + T_i$，并定义总等离子体贝塔值 $\\beta \\equiv 2 \\mu_0 n k_B T / B^2$。\n- 对离子动量方程的主要有限拉莫尔半径（FLR）修正（例如，回旋粘性应力）产生一个贡献，该贡献在小参数 $\\rho_i/L$ 上是高阶的，其中 $\\rho_i \\equiv v_{\\text{th}i}/\\Omega_{ci}$ 是离子回旋半径，$v_{\\text{th}i} \\equiv \\sqrt{2 k_B T_i / m_i}$ 是离子热速度，而 $\\Omega_{ci} \\equiv e B / m_i$ 是离子回旋频率。为此量纲分析之目的，将其相对于理想MHD对流尺度的量级取为 $\\mathcal{O}\\!\\left((\\rho_i/L)^2\\right)$。\n\n任务：\n1) 仅使用上述定义和 $\\mu_0 \\varepsilon_0 c^2 = 1$，推导霍尔项和电子压力梯度项与理想MHD项的无量纲比率，并用离子惯性长度 $d_i \\equiv \\sqrt{m_i/(\\mu_0 n e^2)}$、总贝塔值 $\\beta$ 以及电子温度分数 $f_e$ 来表示它们。证明霍尔比率可简化为 $d_i/L$ 的函数，而电子压力梯度比率可简化为 $\\beta$、$f_e$ 和 $d_i/L$ 的函数。将这些与FLR标度结合，写出复合的非理想项与理想项之比\n$$\nR_{\\text{total}} \\equiv R_{\\text{Hall}} + R_{p_e} + R_{\\text{FLR}}\n$$\n为关于 $d_i/L$、$\\beta$、$f_e$ 和 $\\rho_i/L$ 的闭合形式表达式。\n\n2) 对于具有代表紧凑型聚变装置边缘的以下参数的氘等离子体，数值计算 $R_{\\text{total}}$：\n- 磁场 $B = 3\\,\\mathrm{T}$，\n- 数密度 $n = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，\n- 离子温度 $T_i = 1.0\\,\\mathrm{keV}$，\n- 电子温度 $T_e = 1.0\\,\\mathrm{keV}$，\n- 宏观梯度尺度 $L = 0.10\\,\\mathrm{m}$，\n- 离子质量 $m_i = 2 m_p$，其中质子质量 $m_p = 1.6726219 \\times 10^{-27}\\,\\mathrm{kg}$，\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，\n- 真空磁导率 $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$，\n- 光速 $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$，\n- 真空介电常数 $\\varepsilon_0 = 1/(\\mu_0 c^2)$。\n\n采用 $f_e = 1/2$。使用 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$，将 $k_B T_e$ 和 $k_B T_i$ 以焦耳为单位。根据上述定义，明确计算中间量 $\\beta$、$d_i/L$ 和 $\\rho_i/L$，然后使用第(1)部分得到的表达式计算 $R_{\\text{total}}$。将您计算的 $R_{\\text{total}}$ 最终答案四舍五入至三位有效数字。最终答案是无量纲的；请勿在最终答案中包含单位。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n已知条件逐字从问题陈述中提取：\n- **模型**：混合“粒子-网格”（PIC）-流体模型（离子动力学，电子流体）。\n- **物理背景**：源于电子动量方程的广义欧姆定律，含有限拉莫尔半径（FLR）修正的离子动量方程。\n- **任务**：进行量级分析，以找到控制非理想项相对于理想磁流体动力学（MHD）项的无量纲参数。\n- **基本出发点**：无位移电流的安培定律，以及阿尔芬速度、等离子体贝塔值、离子惯性长度、离子回旋半径和离子热速度的定义。\n- **尺度假设**：\n  - 理想MHD项量级：$| \\boldsymbol{u}_i \\times \\boldsymbol{B} |$，其中 $|\\boldsymbol{u}_i| \\sim v_A$。\n  - 阿尔芬速度：$v_A = B / \\sqrt{\\mu_0 n m_i}$。\n  - 霍尔项量级：$|( \\boldsymbol{J} \\times \\boldsymbol{B} )/(e n)|$，其中 $|\\boldsymbol{J}| \\sim B/(\\mu_0 L)$。\n  - 电子压力梯度项量级：$|\\nabla p_e|/(e n)$，其中 $|\\nabla p_e| \\sim p_e/L$。\n  - 电子压力：$p_e = f_e n k_B T$。\n  - 电子温度分数：$f_e \\equiv T_e/(T_e+T_i)$。\n  - 总温度：$T \\equiv T_e + T_i$。\n  - 总等离子体贝塔值：$\\beta \\equiv 2 \\mu_0 n k_B T / B^2$。\n  - FLR修正相对量级：$R_{\\text{FLR}} \\sim \\mathcal{O}\\!\\left((\\rho_i/L)^2\\right)$。\n  - 离子回旋半径：$\\rho_i \\equiv v_{\\text{th}i}/\\Omega_{ci}$。\n  - 离子热速度：$v_{\\text{th}i} \\equiv \\sqrt{2 k_B T_i / m_i}$。\n  - 离子回旋频率：$\\Omega_{ci} \\equiv e B / m_i$。\n  - 离子惯性长度：$d_i \\equiv \\sqrt{m_i/(\\mu_0 n e^2)}$。\n- **任务1**：推导无量纲比率 $R_{\\text{Hall}}$ 和 $R_{p_e}$ 以及复合比率 $R_{\\text{total}} \\equiv R_{\\text{Hall}} + R_{p_e} + R_{\\text{FLR}}$。\n- **任务2**：对具有以下参数的氘等离子体计算 $R_{\\text{total}}$：\n  - $B = 3\\,\\mathrm{T}$\n  - $n = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n  - $T_i = 1.0\\,\\mathrm{keV}$\n  - $T_e = 1.0\\,\\mathrm{keV}$\n  - $L = 0.10\\,\\mathrm{m}$\n  - $m_i = 2 m_p$\n  - $m_p = 1.6726219 \\times 10^{-27}\\,\\mathrm{kg}$\n  - $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n  - $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n- **计算假设**：$f_e = 1/2$。使用 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$。\n- **最终答案要求**：将 $R_{\\text{total}}$ 的数值结果四舍五入至三位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行验证：\n- **科学依据**：该问题基于等离子体物理学的标准、成熟的原理，特别是扩展MHD理论，这对于理解聚变等离子体中的现象至关重要。所有定义和方程都是标准的。\n- **问题明确**：问题结构清晰。它要求先进行符号推导，然后使用一组完整的给定参数进行数值计算。这些任务会导出一个唯一且有意义的结果。\n- **客观性**：问题以精确、技术性的语言表述，不含任何主观性或偏见。\n- **完整性与一致性**：问题提供了完成所需任务的所有必要定义、尺度假设和数值。没有矛盾之处。假设 $f_e = 1/2$ 与给定的 $T_e=T_i=1.0\\,\\mathrm{keV}$ 一致。\n- **真实性**：物理参数是现实的，代表了现代紧凑型聚变装置的边缘区域。\n\n### 步骤 3：结论与行动\n问题被认定为有效。解法将按如下方式推导。\n\n### 第 1 部分：无量纲比率的推导\n\n目标是求出广义欧姆定律中非理想项与理想MHD项的比率。\n\n**理想MHD项量级 ($M_{\\text{ideal}}$)**\n理想MHD项的量级由 $| \\boldsymbol{u}_i \\times \\boldsymbol{B} |$ 的尺度给出。假设 $|\\boldsymbol{u}_i| \\sim v_A$，并假定 $\\boldsymbol{u}_i$ 不与 $\\boldsymbol{B}$ 平行，则量级可表示为：\n$$\nM_{\\text{ideal}} \\sim v_A B\n$$\n\n**霍尔项比率 ($R_{\\text{Hall}}$)**\n霍尔项的量级由 $|(\\boldsymbol{J} \\times \\boldsymbol{B}) / (e n)|$ 的尺度给出。使用安培定律对电流密度的标度关系 $|\\boldsymbol{J}| \\sim B/(\\mu_0 L)$，其量级为：\n$$\nM_{\\text{Hall}} \\sim \\frac{(B/(\\mu_0 L)) B}{e n} = \\frac{B^2}{\\mu_0 e n L}\n$$\n无量纲比率 $R_{\\text{Hall}}$ 是 $M_{\\text{Hall}}$ 与 $M_{\\text{ideal}}$ 之比：\n$$\nR_{\\text{Hall}} = \\frac{M_{\\text{Hall}}}{M_{\\text{ideal}}} \\sim \\frac{B^2/(\\mu_0 e n L)}{v_A B} = \\frac{B}{\\mu_0 e n L v_A}\n$$\n现在，我们代入阿尔芬速度的定义，$v_A = B / \\sqrt{\\mu_0 n m_i}$：\n$$\nR_{\\text{Hall}} \\sim \\frac{B}{\\mu_0 e n L (B/\\sqrt{\\mu_0 n m_i})} = \\frac{\\sqrt{\\mu_0 n m_i}}{\\mu_0 e n L} = \\frac{1}{eL} \\sqrt{\\frac{m_i}{\\mu_0 n}}\n$$\n我们注意到离子惯性长度的定义是 $d_i = \\sqrt{m_i/(\\mu_0 n e^2)}$。我们可以重写 $R_{\\text{Hall}}$ 的表达式以匹配此形式：\n$$\nR_{\\text{Hall}} \\sim \\frac{1}{L} \\sqrt{\\frac{m_i}{\\mu_0 n e^2}} = \\frac{d_i}{L}\n$$\n因此，霍尔项比率为 $R_{\\text{Hall}} = d_i/L$，这是所要求的关于 $d_i/L$ 的函数。\n\n**电子压力梯度比率 ($R_{p_e}$)**\n电子压力梯度项的量级由 $|\\nabla p_e|/(en)$ 的尺度给出。当 $|\\nabla p_e| \\sim p_e/L$ 时，其量级为：\n$$\nM_{p_e} \\sim \\frac{p_e}{e n L}\n$$\n使用给定的定义 $p_e = f_e n k_B T$，我们有：\n$$\nM_{p_e} \\sim \\frac{f_e n k_B T}{e n L} = \\frac{f_e k_B T}{e L}\n$$\n无量纲比率 $R_{p_e}$ 是 $M_{p_e}$ 与 $M_{\\text{ideal}}$ 之比：\n$$\nR_{p_e} = \\frac{M_{p_e}}{M_{\\text{ideal}}} \\sim \\frac{f_e k_B T / (e L)}{v_A B} = \\frac{f_e k_B T}{e L v_A B}\n$$\n为用所需变量表示此式，我们使用等离子体贝塔值的定义 $\\beta = 2 \\mu_0 n k_B T / B^2$，这给出 $k_B T = \\beta B^2 / (2 \\mu_0 n)$。将此代入 $R_{p_e}$ 的表达式中：\n$$\nR_{p_e} \\sim \\frac{f_e}{e L v_A B} \\left( \\frac{\\beta B^2}{2 \\mu_0 n} \\right) = \\frac{f_e \\beta B}{2 e L \\mu_0 n v_A}\n$$\n再次，我们代入 $v_A = B / \\sqrt{\\mu_0 n m_i}$：\n$$\nR_{p_e} \\sim \\frac{f_e \\beta B}{2 e L \\mu_0 n (B/\\sqrt{\\mu_0 n m_i})} = \\frac{f_e \\beta \\sqrt{\\mu_0 n m_i}}{2 e L \\mu_0 n} = \\frac{f_e \\beta}{2} \\left( \\frac{1}{eL} \\sqrt{\\frac{m_i}{\\mu_0 n}} \\right)\n$$\n和之前一样，括号中的项等价于 $d_i/L$。因此：\n$$\nR_{p_e} = \\frac{\\beta f_e}{2} \\frac{d_i}{L}\n$$\n此表达式是所要求的关于 $\\beta$、$f_e$ 和 $d_i/L$ 的函数。\n\n**有限拉莫尔半径比率 ($R_{\\text{FLR}}$)**\n问题陈述，主要的FLR修正相对于理想MHD尺度的量级为 $\\mathcal{O}\\!\\left((\\rho_i/L)^2\\right)$。因此，我们取：\n$$\nR_{\\text{FLR}} = \\left(\\frac{\\rho_i}{L}\\right)^2\n$$\n\n**复合比率 ($R_{\\text{total}}$)**\n非理想项与理想项的总比率是各项比率之和：\n$$\nR_{\\text{total}} = R_{\\text{Hall}} + R_{p_e} + R_{\\text{FLR}} = \\frac{d_i}{L} + \\frac{\\beta f_e}{2} \\frac{d_i}{L} + \\left(\\frac{\\rho_i}{L}\\right)^2\n$$\n此表达式可以因式分解，得到最终的闭合形式表达式：\n$$\nR_{\\text{total}} = \\frac{d_i}{L} \\left(1 + \\frac{\\beta f_e}{2}\\right) + \\left(\\frac{\\rho_i}{L}\\right)^2\n$$\n\n### 第 2 部分：数值计算\n\n我们现在使用提供的氘等离子体参数来计算 $R_{\\text{total}}$。\n- 离子质量：$m_i = 2 m_p = 2 \\times (1.6726219 \\times 10^{-27}\\,\\mathrm{kg}) = 3.3452438 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 温度：$T_e = 1.0\\,\\mathrm{keV}$ 和 $T_i = 1.0\\,\\mathrm{keV}$。\n- 以焦耳为单位的温度：$1\\,\\mathrm{keV} = 1000\\,\\mathrm{eV} = 1000 \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C})\\,\\mathrm{J} = 1.602176634 \\times 10^{-16}\\,\\mathrm{J}$。\n- $k_B T_e = k_B T_i = 1.602176634 \\times 10^{-16}\\,\\mathrm{J}$。\n- 总温度项：$k_B T = k_B(T_e + T_i) = 2 \\times (1.602176634 \\times 10^{-16}\\,\\mathrm{J}) = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}$。\n- 电子温度分数：$f_e = T_e/(T_e+T_i) = 1.0/(1.0+1.0) = 0.5$。\n\n我们计算中间的无量纲量：\n\n**总等离子体贝塔值 ($\\beta$)**：\n$$\n\\beta = \\frac{2 \\mu_0 n k_B T}{B^2} = \\frac{2 \\times (4\\pi \\times 10^{-7}\\,\\mathrm{H/m}) \\times (5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (3.20435... \\times 10^{-16}\\,\\mathrm{J})}{(3\\,\\mathrm{T})^2}\n$$\n$$\n\\beta = \\frac{4.026548... \\times 10^{-2}}{9} = 0.0044739...\n$$\n\n**比率 $d_i/L$**：\n首先，我们计算离子惯性长度 $d_i$：\n$$\nd_i = \\sqrt{\\frac{m_i}{\\mu_0 n e^2}} = \\sqrt{\\frac{3.3452438 \\times 10^{-27}\\,\\mathrm{kg}}{(4\\pi \\times 10^{-7}\\,\\mathrm{H/m}) \\times (5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2}}\n$$\n$$\nd_i = \\sqrt{\\frac{3.3452438 \\times 10^{-27}}{1.61280... \\times 10^{-24}}}\\,\\mathrm{m} = \\sqrt{0.002074...}\\,\\mathrm{m} = 0.045543... \\,\\mathrm{m}\n$$\n然后，我们求其与宏观尺度长度 $L = 0.10\\,\\mathrm{m}$ 的比率：\n$$\n\\frac{d_i}{L} = \\frac{0.045543... \\,\\mathrm{m}}{0.10\\,\\mathrm{m}} = 0.45543...\n$$\n\n**比率 $\\rho_i/L$**：\n首先，我们计算离子热速度 $v_{\\text{th}i}$：\n$$\nv_{\\text{th}i} = \\sqrt{\\frac{2 k_B T_i}{m_i}} = \\sqrt{\\frac{2 \\times (1.602176634 \\times 10^{-16}\\,\\mathrm{J})}{3.3452438 \\times 10^{-27}\\,\\mathrm{kg}}} = \\sqrt{9.5788... \\times 10^{10}}\\,\\mathrm{m/s} = 3.0950... \\times 10^5\\,\\mathrm{m/s}\n$$\n接下来，离子回旋频率 $\\Omega_{ci}$：\n$$\n\\Omega_{ci} = \\frac{e B}{m_i} = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (3\\,\\mathrm{T})}{3.3452438 \\times 10^{-27}\\,\\mathrm{kg}} = 1.4368... \\times 10^8\\,\\mathrm{rad/s}\n$$\n离子回旋半径 $\\rho_i$ 是它们的比值：\n$$\n\\rho_i = \\frac{v_{\\text{th}i}}{\\Omega_{ci}} = \\frac{3.0950... \\times 10^5\\,\\mathrm{m/s}}{1.4368... \\times 10^8\\,\\mathrm{rad/s}} = 0.002154... \\,\\mathrm{m}\n$$\n最后，我们求其与宏观尺度长度 $L$ 的比率：\n$$\n\\frac{\\rho_i}{L} = \\frac{0.002154... \\,\\mathrm{m}}{0.10\\,\\mathrm{m}} = 0.02154...\n$$\n\n**总比率 $R_{\\text{total}}$**：\n我们将计算出的值代入 $R_{\\text{total}}$ 的表达式中：\n$$\nR_{\\text{total}} = \\frac{d_i}{L} \\left(1 + \\frac{\\beta f_e}{2}\\right) + \\left(\\frac{\\rho_i}{L}\\right)^2\n$$\n$$\nR_{\\text{total}} = 0.45543... \\times \\left(1 + \\frac{0.0044739... \\times 0.5}{2}\\right) + (0.02154...)^2\n$$\n$$\nR_{\\text{total}} = 0.45543... \\times (1 + 0.001118...) + 0.0004640...\n$$\n$$\nR_{\\text{total}} = 0.45543... \\times (1.001118...) + 0.0004640...\n$$\n$$\nR_{\\text{total}} = 0.45594... + 0.0004640... = 0.456405...\n$$\n将最终结果四舍五入到三位有效数字，我们得到 $0.456$。对于这些参数，非理想效应的量级约为理想MHD项的 $45.6\\%$，其中霍尔效应是主要贡献。",
            "answer": "$$\\boxed{0.456}$$"
        },
        {
            "introduction": "数值算法的保真度是确保模拟结果物理真实性的基石，在混合PIC-流体模型中，精确满足电荷守恒定律对于算法的长期稳定性至关重要。一个微小的守恒律违背都可能导致非物理的能量增长，从而污染模拟结果。本练习  通过一个简化的思想实验，让您亲手计算当电荷不守恒时，系统将产生多少虚假的静电能量，从而直观地理解并量化这一核心数值问题的重要性。",
            "id": "3991671",
            "problem": "考虑一个长度为 $L$ 的一维周期性域，它代表了在计算聚变科学与工程中相关的混合粒子-流体（PIC-fluid）模型中的一个简化静电模式。在此类混合模型中，动力学离子与流体电子模型耦合，而稳定的演化需要严格执行离散电荷连续性方程。对电荷守恒的微小违背可能会给耦合过程引入不一致性，进而可能产生虚假的静电能量增长。\n\n从以下基本关系式出发：\n- 静电极限下（磁场旋度为零）的麦克斯韦方程组意味着安培更新 $\\partial_t E(x,t) = - J(x,t) / \\varepsilon_0$ 和高斯定律 $\\partial_x E(x,t) = \\rho(x,t)/\\varepsilon_0$，其中 $\\varepsilon_0$ 是真空介电常数。\n- 电荷连续性方程为 $\\partial_t \\rho(x,t) + \\partial_x J(x,t) = 0$。\n\n定义一个物理上一致的、具有空间波数 $k = 2\\pi m/L$ 和角频率 $\\omega$ 的时间依赖性的单模混合测试问题：\n- 物理电荷密度：$\\rho(x,t) = A \\cos(k x) \\sin(\\omega t)$，\n- 物理电流密度：$J(x,t) = -\\dfrac{A \\omega}{k} \\sin(k x) \\cos(\\omega t)$，\n这精确地满足 $\\partial_t \\rho + \\partial_x J = 0$。\n\n假设PIC-流体耦合沉积的电流略有误差，该误差被建模为一个分数乘法误差 $\\varepsilon$，使得\n- 沉积电流：$J_{\\mathrm{dep}}(x,t) = (1+\\varepsilon) J(x,t)$，\n这引入了对离散连续性方程的可控违背。\n\n使用静电极限下的安培更新，从初始条件 $E(x,0) = 0$ 来推进电场：\n- 沉积场演化：$\\partial_t E_{\\mathrm{dep}}(x,t) = - J_{\\mathrm{dep}}(x,t)/\\varepsilon_0$，\n并将其与通过高斯定律以及周期性边界条件和零空间平均值得到的物理上一致的场进行比较：\n- 物理场：$\\partial_x E_{\\mathrm{phys}}(x,t) = \\rho(x,t)/\\varepsilon_0$。\n\n定义静电能量\n- $W_{\\mathrm{dep}}(t) = \\displaystyle \\int_0^L \\dfrac{\\varepsilon_0}{2}\\, E_{\\mathrm{dep}}(x,t)^2 \\, dx$,\n- $W_{\\mathrm{phys}}(t) = \\displaystyle \\int_0^L \\dfrac{\\varepsilon_0}{2}\\, E_{\\mathrm{phys}}(x,t)^2 \\, dx$,\n以及由电荷守恒违背引起的虚假增长\n- $\\Delta W(t) = W_{\\mathrm{dep}}(t) - W_{\\mathrm{phys}}(t)$。\n\n任务：编写一个完整的、可运行的程序，用于计算在 $t_{\\mathrm{end}} = \\pi/(2\\omega)$（此时 $\\sin(\\omega t_{\\mathrm{end}}) = 1$，角度以弧度为单位）时，下面所列参数集对应的 $\\Delta W(t)$。使用 $\\varepsilon_0 = 8.854187817\\times 10^{-12}$ 法拉/米。所有最终能量值以焦耳表示。\n\n测试套件参数集，以元组 $(\\varepsilon, m, A, \\omega, L)$ 形式给出：\n1. $(0.0, 1, 1.0\\times 10^{-6}, 1.0\\times 10^{6}, 1.0)$，\n2. $(1.0\\times 10^{-3}, 1, 1.0\\times 10^{-6}, 1.0\\times 10^{6}, 1.0)$，\n3. $(5.0\\times 10^{-3}, 10, 1.0\\times 10^{-6}, 1.0\\times 10^{6}, 1.0)$，\n4. $(-2.0\\times 10^{-3}, 1, 1.0\\times 10^{-6}, 1.0\\times 10^{6}, 1.0)$，\n5. $(5.0\\times 10^{-3}, 1, 0.0, 1.0\\times 10^{6}, 1.0)$。\n\n你的程序应该生成单行输出，其中包含这五个测试用例的结果，结果为逗号分隔的列表，并用方括号括起来（例如，\"[result1,result2,result3,result4,result5]\"）。每个结果必须是一个浮点数，给出 $\\Delta W(t_{\\mathrm{end}})$ 的值，单位为焦耳。",
            "solution": "该问题要求计算在特定时间 $t_{\\mathrm{end}}$ 时，由于混合粒子-流体（PIC-fluid）模型中对电荷守恒的可控违背而产生的虚假静电能量增长 $\\Delta W(t)$。分析首先从推导电场及其相关能量的解析表达式开始。\n\n首先，物理电场 $E_{\\mathrm{phys}}(x,t)$ 由高斯定律 $\\partial_x E_{\\mathrm{phys}}(x,t) = \\rho(x,t)/\\varepsilon_0$ 确定。使用给定的物理电荷密度 $\\rho(x,t) = A \\cos(k x) \\sin(\\omega t)$，我们对 $x$ 进行积分：\n$$\nE_{\\mathrm{phys}}(x,t) = \\int \\frac{\\rho(x,t)}{\\varepsilon_0} \\, dx = \\int \\frac{A}{\\varepsilon_0} \\cos(k x) \\sin(\\omega t) \\, dx\n$$\n$$\nE_{\\mathrm{phys}}(x,t) = \\frac{A \\sin(\\omega t)}{\\varepsilon_0} \\int \\cos(k x) \\, dx = \\frac{A \\sin(\\omega t)}{k \\varepsilon_0} \\sin(k x) + C(t)\n$$\n问题指定了周期性边界条件和电场的零空间平均值。在长度为 $L$ 的域上，$\\sin(k x)$ 的空间平均值为零，其中 $k=2\\pi m/L$ 且 $m$ 是整数。\n$$\n\\frac{1}{L} \\int_0^L \\sin(k x) \\, dx = \\frac{1}{L} \\left[ -\\frac{1}{k} \\cos(k x) \\right]_0^L = -\\frac{1}{kL} (\\cos(2\\pi m) - \\cos(0)) = 0\n$$\n为了保持 $E_{\\mathrm{phys}}(x,t)$ 的空间平均值为零，积分常数 $C(t)$ 必须为零。因此，物理电场为：\n$$\nE_{\\mathrm{phys}}(x,t) = \\frac{A}{k \\varepsilon_0} \\sin(k x) \\sin(\\omega t)\n$$\n\n接下来，通过对安培更新 $\\partial_t E_{\\mathrm{dep}}(x,t) = - J_{\\mathrm{dep}}(x,t)/\\varepsilon_0$ 进行积分，并使用初始条件 $E_{\\mathrm{dep}}(x,0) = 0$，来求得沉积电场 $E_{\\mathrm{dep}}(x,t)$。沉积电流 $J_{\\mathrm{dep}}(x,t)$ 由 $(1+\\varepsilon)J(x,t)$ 给出，其中 $J(x,t) = -\\frac{A \\omega}{k} \\sin(k x) \\cos(\\omega t)$。\n$$\n\\partial_t E_{\\mathrm{dep}}(x,t) = - \\frac{(1+\\varepsilon)}{\\varepsilon_0} \\left( -\\frac{A \\omega}{k} \\sin(k x) \\cos(\\omega t) \\right) = (1+\\varepsilon) \\frac{A \\omega}{k \\varepsilon_0} \\sin(k x) \\cos(\\omega t)\n$$\n对 $t$ 积分：\n$$\nE_{\\mathrm{dep}}(x,t) = \\int (1+\\varepsilon) \\frac{A \\omega}{k \\varepsilon_0} \\sin(k x) \\cos(\\omega t) \\, dt = (1+\\varepsilon) \\frac{A}{k \\varepsilon_0} \\sin(k x) \\int \\omega \\cos(\\omega t) \\, dt\n$$\n$$\nE_{\\mathrm{dep}}(x,t) = (1+\\varepsilon) \\frac{A}{k \\varepsilon_0} \\sin(k x) \\sin(\\omega t) + C'(x)\n$$\n应用初始条件 $E_{\\mathrm{dep}}(x,0) = 0$：\n$$\nE_{\\mathrm{dep}}(x,0) = (1+\\varepsilon) \\frac{A}{k \\varepsilon_0} \\sin(k x) \\sin(0) + C'(x) = 0 + C'(x) = 0\n$$\n因此，积分常数 $C'(x)$ 为零，沉积场为：\n$$\nE_{\\mathrm{dep}}(x,t) = (1+\\varepsilon) \\frac{A}{k \\varepsilon_0} \\sin(k x) \\sin(\\omega t) = (1+\\varepsilon) E_{\\mathrm{phys}}(x,t)\n$$\n\n现在我们计算静电能量。物理能量 $W_{\\mathrm{phys}}(t)$ 为：\n$$\nW_{\\mathrm{phys}}(t) = \\int_0^L \\frac{\\varepsilon_0}{2} E_{\\mathrm{phys}}(x,t)^2 \\, dx = \\int_0^L \\frac{\\varepsilon_0}{2} \\left( \\frac{A}{k \\varepsilon_0} \\sin(k x) \\sin(\\omega t) \\right)^2 \\, dx\n$$\n$$\nW_{\\mathrm{phys}}(t) = \\frac{\\varepsilon_0}{2} \\frac{A^2 \\sin^2(\\omega t)}{k^2 \\varepsilon_0^2} \\int_0^L \\sin^2(k x) \\, dx = \\frac{A^2 \\sin^2(\\omega t)}{2 k^2 \\varepsilon_0} \\int_0^L \\sin^2(k x) \\, dx\n$$\n$\\sin^2(k x)$ 在一个周期上的积分为 $L/2$。由于 $k=2\\pi m/L$，区间 $[0,L]$ 恰好包含 $m$ 个周期，因此积分为 $\\int_0^L \\sin^2(k x) dx = L/2$。\n$$\nW_{\\mathrm{phys}}(t) = \\frac{A^2 \\sin^2(\\omega t)}{2 k^2 \\varepsilon_0} \\left( \\frac{L}{2} \\right) = \\frac{L A^2}{4 k^2 \\varepsilon_0} \\sin^2(\\omega t)\n$$\n沉积能量 $W_{\\mathrm{dep}}(t)$ 通过场与 $W_{\\mathrm{phys}}(t)$ 相关联：\n$$\nW_{\\mathrm{dep}}(t) = \\int_0^L \\frac{\\varepsilon_0}{2} E_{\\mathrm{dep}}(x,t)^2 \\, dx = \\int_0^L \\frac{\\varepsilon_0}{2} ((1+\\varepsilon)E_{\\mathrm{phys}}(x,t))^2 \\, dx\n$$\n$$\nW_{\\mathrm{dep}}(t) = (1+\\varepsilon)^2 \\int_0^L \\frac{\\varepsilon_0}{2} E_{\\mathrm{phys}}(x,t)^2 \\, dx = (1+\\varepsilon)^2 W_{\\mathrm{phys}}(t)\n$$\n虚假能量增长 $\\Delta W(t)$ 是这些能量之差：\n$$\n\\Delta W(t) = W_{\\mathrm{dep}}(t) - W_{\\mathrm{phys}}(t) = (1+\\varepsilon)^2 W_{\\mathrm{phys}}(t) - W_{\\mathrm{phys}}(t)\n$$\n$$\n\\Delta W(t) = \\left( (1+2\\varepsilon+\\varepsilon^2) - 1 \\right) W_{\\mathrm{phys}}(t) = (2\\varepsilon + \\varepsilon^2) W_{\\mathrm{phys}}(t)\n$$\n代入 $W_{\\mathrm{phys}}(t)$ 的表达式：\n$$\n\\Delta W(t) = (2\\varepsilon + \\varepsilon^2) \\frac{L A^2}{4 k^2 \\varepsilon_0} \\sin^2(\\omega t)\n$$\n任务是在 $t_{\\mathrm{end}} = \\pi/(2\\omega)$ 时计算这个量，此时 $\\sin(\\omega t_{\\mathrm{end}}) = \\sin(\\pi/2) = 1$。\n$$\n\\Delta W(t_{\\mathrm{end}}) = (2\\varepsilon + \\varepsilon^2) \\frac{L A^2}{4 k^2 \\varepsilon_0}\n$$\n最后，代入 $k = 2\\pi m/L$，我们得到用于计算的公式：\n$$\n\\Delta W(t_{\\mathrm{end}}) = (2\\varepsilon + \\varepsilon^2) \\frac{L A^2}{4 (2\\pi m/L)^2 \\varepsilon_0} = (2\\varepsilon + \\varepsilon^2) \\frac{L A^2}{4 (4\\pi^2 m^2/L^2) \\varepsilon_0}\n$$\n$$\n\\Delta W(t_{\\mathrm{end}}) = (2\\varepsilon + \\varepsilon^2) \\frac{L^3 A^2}{16 \\pi^2 m^2 \\varepsilon_0}\n$$\n这个最终表达式用于计算每个测试用例所需的值。请注意，如果 $A=0$ 或 $\\varepsilon=0$，$\\Delta W(t_{\\mathrm{end}})$ 正确地为零。对于 $m \\to \\infty$，虚假能量增长消失，这是符合预期的，因为对于给定的振幅，高 $k$ 模式包含的能量较少。角频率 $\\omega$ 没有出现在场峰值时刻能量的最终表达式中，因为它的作用只是设定时间尺度，而问题指定在固定相位 $\\omega t = \\pi/2$ 处进行评估。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the spurious electrostatic energy growth in a simplified 1D\n    hybrid PIC-fluid model due to a charge conservation violation.\n    \"\"\"\n    \n    # Define the physical constant\n    epsilon_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (epsilon, m, A, omega, L)\n    test_cases = [\n        (0.0, 1, 1.0e-6, 1.0e6, 1.0),\n        (1.0e-3, 1, 1.0e-6, 1.0e6, 1.0),\n        (5.0e-3, 10, 1.0e-6, 1.0e6, 1.0),\n        (-2.0e-3, 1, 1.0e-6, 1.0e6, 1.0),\n        (5.0e-3, 1, 0.0, 1.0e6, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        eps, m, A, omega, L = case\n        \n        # The analytical formula for the spurious energy growth at t_end is:\n        # Delta_W = (2*eps + eps^2) * (L^3 * A^2) / (16 * pi^2 * m^2 * epsilon_0)\n        #\n        # A_val = 0 or m = 0 would result in Delta_W = 0.\n        # The problem statement ensures m >= 1.\n        if A == 0.0 or m == 0:\n            delta_W = 0.0\n        else:\n            # Factor related to the fractional current error\n            eps_factor = 2 * eps + eps**2\n            \n            # Factor related to the physical parameters\n            phys_factor = (L**3 * A**2) / (16 * np.pi**2 * m**2 * epsilon_0)\n            \n            delta_W = eps_factor * phys_factor\n        \n        results.append(delta_W)\n\n    # Final print statement in the exact required format.\n    # The format specifier '.7e' ensures sufficient precision for all cases.\n    print(f\"[{','.join(f'{r:.7e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将理论与实践相结合是计算科学研究的关键环节，验证与确认（V&V）是评估数值模型正确性的核心步骤。本练习  是一个综合性的实践，要求您从基本物理方程出发，推导并实现一个简化混合模型的数值求解器，用以模拟一种重要的等离子体波——哨声波。通过将数值模拟得到的波色散关系与已知的解析理论解进行比较，您将完成一次从理论推导到代码实现、再到结果验证的完整科研实践。",
            "id": "3991711",
            "problem": "考虑一个长度为 $L$ 的一维周期性区域，其中有均匀的背景磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$、数密度为 $n_0$ 的冷电子流体，以及在混合粒子-流体（PIC）框架中被视为固定的准中性背景的离子。假设为低频电磁动力学，忽略位移电流，因此安培定律简化为 $\\mu_0 \\mathbf{J} = \\nabla \\times \\mathbf{B}$，法拉第定律为 $\\partial_t \\mathbf{B} = - \\nabla \\times \\mathbf{E}$。包含惯性的电子动量方程为 $m_e \\partial_t \\mathbf{v}_e = - e \\left( \\mathbf{E} + \\mathbf{v}_e \\times \\mathbf{B}_0 \\right)$，而在固定离子的准中性条件下，电流为 $\\mathbf{J} = - e n_0 \\mathbf{v}_e$。电子惯性趋肤深度为 $d_e = \\sqrt{ \\dfrac{m_e}{\\mu_0 n_0 e^2} }$，电子回旋频率为 $\\Omega_e = \\dfrac{e B_0}{m_e}$。对于沿 $\\hat{\\mathbf{x}}$ 方向的平行传播，包含电子惯性的线性哨声波色散关系为\n$$\n\\omega(k) \\;=\\; \\frac{k^2 d_e^2}{1 + k^2 d_e^2} \\, \\Omega_e,\n$$\n其中 $k$ 是标量波数。\n\n从上述基本定律出发，推导与冷电子、准中性、固定离子极限下的混合PIC-流体耦合相一致的横向磁场分量 $\\mathbf{B}_\\perp = (B_y, B_z)$ 的演化方程。然后，设计一个算法，在周期性区域中针对索引为 $m$ 的单个傅里叶模式，对此演化过程进行数值积分，并利用固定位置上 $B_y(t)$ 的时间序列，通过峰值检测和抛物线插值来估计周期，从而估算角频率 $\\omega$。将数值估算的 $\\omega$ 与理论值 $\\omega(k)$ 进行比较，并报告相对误差。\n\n你的程序必须：\n- 使用以下物理常数：电子电荷 $e$（单位：库仑），电子质量 $m_e$（单位：千克），真空磁导率 $\\mu_0$（单位：亨利/米），以及真空介电常数 $\\varepsilon_0$（单位：法拉/米）。所有内部计算的频率必须以弧度/秒为单位。\n- 通过使用从包含惯性的冷电子广义欧姆定律、安培定律（无位移电流）和法拉第定律推导出的线性算子，对 $B_y$ 和 $B_z$ 的傅里叶振幅进行演化，从而实现上述方程所蕴含的耦合方案。\n- 使用物理空间中的实值场 $B_y(x,0) = A \\cos(kx)$ 和 $B_z(x,0) = A \\sin(kx)$ 初始化一个波数为 $k = \\dfrac{2\\pi m}{L}$ 的单一圆偏振哨声波模式，其中 $A$ 是一个以特斯拉为单位的小振幅。\n- 通过检测局部最大值并应用抛物线插值来精确化峰值时间，从模拟的 $B_y(0,t)$ 时间序列中数值估算 $\\omega$。将周期 $T$ 计算为连续峰值时间之间的平均差值，并取 $\\omega_{\\text{num}} = \\dfrac{2\\pi}{T}$。\n- 根据给定的色散关系计算理论值 $\\omega_{\\text{th}}(k)$。\n- 对于每个测试用例，输出相对误差，形式为小数 $\\left| \\dfrac{\\omega_{\\text{num}} - \\omega_{\\text{th}}}{\\omega_{\\text{th}}} \\right|$。\n\n使用以下测试套件（所有量均采用国际单位制）：\n- 区域长度 $L = 0.05$ 米，网格点数 $N = 256$，电子密度 $n_0 = 5.0 \\times 10^{19}$ 米$^{-3}$，背景磁场 $B_0 = 0.02$ 特斯拉，扰动振幅 $A = 1.0 \\times 10^{-6}$ 特斯拉。\n- 测试的傅里叶模式索引：$m \\in \\{1, 11, 53\\}$，这些索引分别对应 $k d_e \\ll 1$、$k d_e \\sim 1$ 和 $k d_e \\gg 1$ 的情况。\n- 每种情况的时间步长选择必须确保足够的时间分辨率，使用一种启发式方法，目标是每个理论周期至少200个步长，但你必须通过选择一个能保持积分精度的固定或自适应步长来确保数值稳定性。程序必须内部计算并使用适当数量的步长，以覆盖每种情况下至少5个振荡周期。\n\n你的程序应生成单行输出，其中包含三个测试用例的相对误差，格式为方括号内以逗号分隔的列表，例如，“[err_case1,err_case2,err_case3]”。这些值必须是浮点数。不允许有其他输出。所有中间物理量（频率）必须以弧度/秒为单位进行计算，但只打印无量纲的相对误差。",
            "solution": "我们从具有固定离子和准中性的冷电子混合粒子-流体（PIC）设置开始。控制方程是法拉第定律 $\\partial_t \\mathbf{B} = - \\nabla \\times \\mathbf{E}$ 和无位移电流的安培定律 $\\mu_0 \\mathbf{J} = \\nabla \\times \\mathbf{B}$。电子动量方程为 $m_e \\partial_t \\mathbf{v}_e = - e \\left( \\mathbf{E} + \\mathbf{v}_e \\times \\mathbf{B}_0 \\right)$，在固定离子的准中性条件下，电流闭合关系为 $\\mathbf{J} = - e n_0 \\mathbf{v}_e$。求解电子动量方程，用 $\\mathbf{J}$ 表示 $\\mathbf{E}$，我们使用 $\\mathbf{v}_e = - \\dfrac{\\mathbf{J}}{e n_0}$ 得到\n$$\nm_e \\partial_t \\left( - \\frac{\\mathbf{J}}{e n_0} \\right) \\;=\\; - e \\left( \\mathbf{E} + \\left( - \\frac{\\mathbf{J}}{e n_0} \\right) \\times \\mathbf{B}_0 \\right),\n$$\n整理后得到\n$$\n\\mathbf{E} \\;=\\; \\frac{m_e}{e^2 n_0} \\, \\partial_t \\mathbf{J} \\;+\\; \\frac{1}{e n_0} \\, \\mathbf{J} \\times \\mathbf{B}_0.\n$$\n使用无位移电流的安培定律 $\\mathbf{J} = \\dfrac{1}{\\mu_0} \\nabla \\times \\mathbf{B}$，我们代入得到\n$$\n\\mathbf{E} \\;=\\; \\frac{m_e}{e^2 n_0 \\mu_0} \\, \\nabla \\times \\partial_t \\mathbf{B} \\;+\\; \\frac{1}{e n_0 \\mu_0} \\, \\left( \\nabla \\times \\mathbf{B} \\right) \\times \\mathbf{B}_0.\n$$\n定义电子趋肤深度 $d_e^2 = \\dfrac{m_e}{\\mu_0 n_0 e^2}$ 和因子 $\\beta = \\dfrac{1}{e n_0 \\mu_0}$，我们写出\n$$\n\\mathbf{E} \\;=\\; d_e^2 \\, \\nabla \\times \\partial_t \\mathbf{B} \\;+\\; \\beta \\, \\left( \\nabla \\times \\mathbf{B} \\right) \\times \\mathbf{B}_0.\n$$\n法拉第定律给出了磁场的演化：\n$$\n\\partial_t \\mathbf{B} \\;=\\; - \\nabla \\times \\mathbf{E} \\;=\\; - \\nabla \\times \\left( d_e^2 \\nabla \\times \\partial_t \\mathbf{B} \\right) \\;-\\; \\nabla \\times \\left( \\beta \\left( \\nabla \\times \\mathbf{B} \\right) \\times \\mathbf{B}_0 \\right).\n$$\n假设空间仅沿 $x$ 方向变化，且背景场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$ 是均匀的，横向分量 $\\mathbf{B}_\\perp = (B_y, B_z)$ 解耦。使用矢量恒等式 $\\nabla \\times \\nabla \\times \\mathbf{W} = \\nabla(\\nabla \\cdot \\mathbf{W}) - \\nabla^2 \\mathbf{W}$，并且在一维设定下 $\\nabla \\cdot \\mathbf{B}_\\perp = 0$，我们得到 $\\nabla \\times \\nabla \\times \\partial_t \\mathbf{B}_\\perp = - \\nabla^2 \\partial_t \\mathbf{B}_\\perp$。因此，\n$$\n\\partial_t \\mathbf{B}_\\perp \\;=\\; d_e^2 \\, \\nabla^2 \\partial_t \\mathbf{B}_\\perp \\;-\\; \\nabla \\times \\left( \\beta \\left( \\nabla \\times \\mathbf{B} \\right) \\times \\mathbf{B}_0 \\right).\n$$\n将惯性项移到左边，得到\n$$\n\\left( 1 - d_e^2 \\, \\nabla^2 \\right) \\partial_t \\mathbf{B}_\\perp \\;=\\; - \\nabla \\times \\left( \\beta \\left( \\nabla \\times \\mathbf{B} \\right) \\times \\mathbf{B}_0 \\right).\n$$\n对于 $x$ 方向的一维变化，写出分量形式，\n$$\n\\begin{aligned}\n\\left( 1 - d_e^2 \\, \\partial_x^2 \\right) \\, \\partial_t B_y = \\beta \\, B_0 \\, \\partial_x^2 B_z, \\\\\n\\left( 1 - d_e^2 \\, \\partial_x^2 \\right) \\, \\partial_t B_z = - \\beta \\, B_0 \\, \\partial_x^2 B_y.\n\\end{aligned}\n$$\n对于单个傅里叶模式 $B_\\perp \\propto e^{i(kx - \\omega t)}$，代入 $\\partial_x^2 \\mapsto -k^2$ 和 $\\partial_t \\mapsto - i \\omega$ 得到\n$$\n\\begin{aligned}\n\\left( 1 + d_e^2 k^2 \\right) \\, (- i \\omega) \\, B_y = - \\beta \\, B_0 \\, k^2 \\, B_z, \\\\\n\\left( 1 + d_e^2 k^2 \\right) \\, (- i \\omega) \\, B_z = \\beta \\, B_0 \\, k^2 \\, B_y.\n\\end{aligned}\n$$\n这表示在 $(B_y, B_z)$ 平面中以角频率旋转\n$$\n\\omega(k) \\;=\\; \\frac{\\beta B_0 k^2}{1 + d_e^2 k^2} \\;=\\; \\frac{k^2 d_e^2}{1 + d_e^2 k^2} \\, \\Omega_e,\n$$\n使用了 $\\beta B_0 = \\dfrac{B_0}{\\mu_0 e n_0} = \\dfrac{e B_0}{m_e} \\cdot \\dfrac{m_e}{\\mu_0 e^2 n_0} = \\Omega_e d_e^2$。\n\n算法设计：\n- 空间离散化：在 $[0, L)$ 上使用包含 $N$ 个点的周期性网格，并通过离散傅里葉变换表示场。离散波数为 $k_n = \\dfrac{2\\pi n}{L}$，$n \\in \\left\\{ - \\dfrac{N}{2}, \\dots, \\dfrac{N}{2}-1 \\right\\}$。\n- 模式初始化：选择单个模式索引 $m$，并用 $B_y(x,0) = A \\cos(k x)$ 和 $B_z(x,0) = A \\sin(k x)$ 初始化实空间场。在傅里叶空间中，这对应于在 $k = \\pm \\dfrac{2\\pi m}{L}$ 处的非零分量，其复振幅确保了场为实值。\n- 傅里叶空间中的时间演化：对于每个波数 $k$，耦合的线性常微分方程为\n$$\n\\frac{d}{dt} \\hat{B}_y(k,t) \\;=\\; - \\frac{\\beta B_0 k^2}{1 + d_e^2 k^2} \\, \\hat{B}_z(k,t), \\qquad\n\\frac{d}{dt} \\hat{B}_z(k,t) \\;=\\; \\frac{\\beta B_0 k^2}{1 + d_e^2 k^2} \\, \\hat{B}_y(k,t).\n$$\n由于动力学按波数解耦，我们使用四阶 Runge–Kutta 方法对这些线性方程进行积分，时间步长的选择要确保每个理论周期至少有200个步长，该理论周期基于 $\\omega_{\\text{th}} = \\dfrac{k^2 d_e^2}{1 + k^2 d_e^2} \\, \\Omega_e$ 计算。\n- 频率估算：通过对 $x=0$ 处的傅里叶振幅求和来记录时间序列 $B_y(0,t)$。通过比较相邻样本来识别局部最大值，并使用抛物线插值来精确化峰值时间。根据连续峰值时间的差值计算平均周期 $T$，并返回 $\\omega_{\\text{num}} = \\dfrac{2\\pi}{T}$。\n- 比较：根据哨声波色散关系计算 $\\omega_{\\text{th}}(k)$，并为每个测试用例计算相对误差 $\\left| \\dfrac{\\omega_{\\text{num}} - \\omega_{\\text{th}}}{\\omega_{\\text{th}}} \\right|$。所有频率都以弧度/秒为单位处理；报告的相对误差是无量纲的小数。\n\n测试套件和输出：\n- 使用 $L = 0.05$ 米, $N = 256$, $n_0 = 5.0 \\times 10^{19}$ 米$^{-3}$, $B_0 = 0.02$ 特斯拉, $A = 1.0 \\times 10^{-6}$ 特斯拉，以及 $m \\in \\{1, 11, 53\\}$。\n- 对于每个 $m$，模拟至少五个振荡周期，并保证足够的时间分辨率，然后打印一行包含三个相对误差的字符串，格式为方括号内以逗号分隔的列表，例如，“[0.0001,0.0002,0.0003]”。\n\n该方法基于基本原理：从麦克斯韦方程组和包含惯性的电子动量定律出发，我们推导出 $\\mathbf{B}_\\perp$ 的一致耦合演化方程，得到色散关系，并设计一个反映混合PIC-流体闭合关系的数值谱积分方案。通过峰值检测和抛物线精化的频率估算方法，为与解析色散关系进行比较提供了一个稳健的数值方法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\ne = 1.602176634e-19       # Coulomb\nm_e = 9.1093837015e-31    # kg\nmu0 = 4.0e-7 * np.pi      # H/m\neps0 = 1.0 / (mu0 * (299792458.0**2))  # F/m, not used directly but defined\n\ndef rk4_step(Bhat_y, Bhat_z, dt, factor):\n    \"\"\"\n    One Runge–Kutta 4 step for the linear system in Fourier space:\n        dBhat_y/dt = - factor * Bhat_z\n        dBhat_z/dt =   factor * Bhat_y\n    where factor is a real array dependent on k (shape (N,)).\n    \"\"\"\n    k1y = -factor * Bhat_z\n    k1z =  factor * Bhat_y\n\n    By2 = Bhat_y + 0.5 * dt * k1y\n    Bz2 = Bhat_z + 0.5 * dt * k1z\n    k2y = -factor * Bz2\n    k2z =  factor * By2\n\n    By3 = Bhat_y + 0.5 * dt * k2y\n    Bz3 = Bhat_z + 0.5 * dt * k2z\n    k3y = -factor * Bz3\n    k3z =  factor * By3\n\n    By4 = Bhat_y + dt * k3y\n    Bz4 = Bhat_z + dt * k3z\n    k4y = -factor * Bz4\n    k4z =  factor * By4\n\n    Bhat_y_next = Bhat_y + (dt / 6.0) * (k1y + 2.0 * k2y + 2.0 * k3y + k4y)\n    Bhat_z_next = Bhat_z + (dt / 6.0) * (k1z + 2.0 * k2z + 2.0 * k3z + k4z)\n    return Bhat_y_next, Bhat_z_next\n\ndef parabolic_peak_time(y_prev, y_peak, y_next, t_peak, dt):\n    \"\"\"\n    Estimate refined peak time using parabolic interpolation around a detected local maximum.\n    For samples at times t_peak - dt, t_peak, t_peak + dt with values y_prev, y_peak, y_next,\n    the vertex offset delta (in units of dt) is:\n        delta = 0.5 * (y_prev - y_next) / (y_prev - 2*y_peak + y_next)\n    The refined peak time is t_peak + delta*dt.\n    \"\"\"\n    denom = y_prev - 2.0 * y_peak + y_next\n    if abs(denom) < 1e-30:\n        return t_peak\n    delta = 0.5 * (y_prev - y_next) / denom\n    return t_peak + delta * dt\n\ndef estimate_frequency(times, signal):\n    \"\"\"\n    Estimate angular frequency from a time series using peak detection and parabolic interpolation.\n    Returns omega_num = 2*pi / T_avg, where T_avg is the average period between successive peaks.\n    \"\"\"\n    # Detect local maxima\n    peak_times = []\n    for i in range(1, len(signal) - 1):\n        if signal[i-1] < signal[i] and signal[i] > signal[i+1]:\n            t_refined = parabolic_peak_time(signal[i-1], signal[i], signal[i+1], times[i], times[1] - times[0])\n            peak_times.append(t_refined)\n\n    # Need at least two peaks to estimate period\n    if len(peak_times) < 2:\n        return np.nan\n\n    # Compute average period from successive peaks\n    periods = np.diff(peak_times)\n    T_avg = np.mean(periods)\n    omega_num = 2.0 * np.pi / T_avg\n    return omega_num\n\ndef simulate_case(L, N, n0, B0, A, m):\n    \"\"\"\n    Simulate one test case:\n    - Initialize a single circularly polarized Fourier mode with index m.\n    - Integrate using RK4 for several periods.\n    - Estimate frequency via peak detection on B_y(0,t).\n    - Return theoretical and numerical omega and the relative error.\n    \"\"\"\n    # Derived quantities\n    de2 = m_e / (mu0 * n0 * e**2)     # electron skin depth squared\n    de = np.sqrt(de2)\n    Omega_e = e * B0 / m_e            # electron cyclotron frequency\n\n    # Wavenumbers\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)  # array of k values\n    # Build factor for each k: beta*B0*k^2 / (1 + de^2*k^2), where beta = 1/(e n0 mu0)\n    beta = 1.0 / (e * n0 * mu0)\n    factor = beta * B0 * (k**2) / (1.0 + de2 * (k**2))  # shape (N,)\n\n    # Theoretical frequency for mode m\n    k_m = 2.0 * np.pi * m / L\n    omega_th = (k_m**2 * de2) / (1.0 + k_m**2 * de2) * Omega_e\n\n    # Time step heuristic: ~200 steps per theoretical period; cap dt to maintain accuracy\n    if omega_th == 0.0:\n        dt = 1e-10\n    else:\n        dt_target = (2.0 * np.pi) / (200.0 * omega_th)\n        dt = min(2e-11, dt_target)\n\n    # Number of steps: at least 5 periods\n    steps = int(max(1024, np.ceil(5.0 * (2.0 * np.pi) / (omega_th * dt)))) if omega_th > 0.0 else 2048\n\n    # Initialize Fourier amplitudes for a real-space field:\n    # B_y(x,0) = A cos(k_m x), B_z(x,0) = A sin(k_m x).\n    # In Fourier: cos -> (A/2 at +m and +A/2 at -m), sin -> (-i A/2 at +m, +i A/2 at -m).\n    Bhat_y = np.zeros(N, dtype=np.complex128)\n    Bhat_z = np.zeros(N, dtype=np.complex128)\n\n    # Positive and negative index for mode m\n    idx_pos = m % N\n    idx_neg = (-m) % N\n\n    Bhat_y[idx_pos] = A / 2.0\n    Bhat_y[idx_neg] = A / 2.0\n    Bhat_z[idx_pos] = -1j * A / 2.0\n    Bhat_z[idx_neg] =  1j * A / 2.0\n\n    # Time integration and recording B_y at x=0 (sum of Fourier amplitudes)\n    times = np.zeros(steps)\n    By_at_0 = np.zeros(steps)\n    t = 0.0\n    for i in range(steps):\n        # Record\n        times[i] = t\n        # B_y at x=0 is sum of Fourier components (since exp(i k x) with x=0 is 1)\n        By_at_0[i] = np.real(np.sum(Bhat_y))\n        # Step\n        Bhat_y, Bhat_z = rk4_step(Bhat_y, Bhat_z, dt, factor)\n        t += dt\n\n    # Estimate numerical frequency\n    omega_num = estimate_frequency(times, By_at_0)\n\n    # Relative error\n    rel_err = np.abs(omega_num - omega_th) / omega_th if (omega_th > 0.0 and np.isfinite(omega_num)) else np.nan\n    return omega_th, omega_num, rel_err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    L = 0.05     # meters\n    N = 256      # grid points\n    n0 = 5.0e19  # m^-3\n    B0 = 0.02    # tesla\n    A = 1.0e-6   # tesla\n\n    test_modes = [1, 11, 53]\n\n    results = []\n    for m in test_modes:\n        omega_th, omega_num, rel_err = simulate_case(L, N, n0, B0, A, m)\n        results.append(rel_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}