{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze the complex interaction between a magnetic perturbation and the plasma, we must first understand how to generate a specific perturbation using external coils. This first practice focuses on the fundamental engineering task of relating the controllable currents in a set of magnetic coils to the resulting vacuum magnetic field structure inside the tokamak. By applying Fourier analysis, you will learn to calculate the required coil current amplitude to produce a desired resonant harmonic, providing a crucial link between experimental design and theoretical models.",
            "id": "4040824",
            "problem": "A toroidally symmetric tokamak is equipped with a set of resonant magnetic perturbation (RMP) coils designed to produce a predominantly single toroidal harmonic. Consider a coil array of $N$ identical coils uniformly spaced at toroidal angles $\\varphi_k = \\frac{2\\pi k}{N}$ for $k = 0, 1, \\dots, N-1$. Each coil is driven to produce a pure toroidal harmonic $n$ by setting its current to\n$$\nI_k = I_0 \\cos\\!\\big(n \\varphi_k - \\varphi_0\\big),\n$$\nwhere $I_0$ is the common per-coil current amplitude and $\\varphi_0$ is the common phase.\n\nIn vacuum (no plasma response), the magnetic field satisfies Maxwell's equations $\\nabla \\times \\mathbf{B} = \\mathbf{0}$ and $\\nabla \\cdot \\mathbf{B} = 0$, and thus the magnetic field produced by currents is linearly superposable and the edge radial field harmonic can be expanded in a Fourier series in toroidal angle. The safety factor at $95\\%$ poloidal flux, denoted $q_{95}$, identifies the dominant resonant poloidal harmonic $m$ via $m/n \\approx q_{95}$, but for this problem the exact value of $m$ is not required. A calibration experiment has measured the vacuum transfer function at $q_{95}$ between the array’s toroidal-$n$ complex current amplitude and the edge radial magnetic field harmonic amplitude. The transfer function is defined as the complex ratio\n$$\nH \\equiv \\frac{\\delta b_r^{\\mathrm{vac}}(q_{95})}{I^{(n)}},\n$$\nwhere $I^{(n)}$ is the complex Fourier amplitude of the array’s $n$-th toroidal current component, and $\\delta b_r^{\\mathrm{vac}}(q_{95})$ is the complex amplitude of the edge radial field harmonic at $q_{95}$. For your device and phasing setup, the measured value is\n$$\nH = h \\exp(i \\alpha), \\quad h = 1.85 \\times 10^{-7} \\ \\mathrm{T/A}, \\quad \\alpha = 28^{\\circ},\n$$\nwith the phase angle $\\alpha$ given in degrees.\n\nYou are tasked with producing a target vacuum edge radial field harmonic amplitude at $q_{95}$ of\n$$\n\\delta b_r^{\\mathrm{vac}}(q_{95}) = B_{\\mathrm{tgt}} = 1.34 \\times 10^{-3} \\ \\mathrm{T},\n$$\nwith the field phase aligned to the resonant condition (i.e., a real, positive complex amplitude). Assume:\n- The magnetic field response is linear in the coil currents.\n- The measured transfer function $H$ applies to the array’s $n$-harmonic current amplitude $I^{(n)}$.\n- The array is operated at $n = 3$ with $N = 12$ coils.\n- Quasistatic operation (ignore inductive dynamics), and neglect passive structures.\n\nStarting from the vacuum magnetostatic equations and the toroidal Fourier decomposition of the coil current distribution, derive an expression for the required per-coil current amplitude $I_0$ that achieves the target $B_{\\mathrm{tgt}}$ and compute its numerical value for the given parameters. Round your answer to four significant figures. Express the final current in A.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- Number of coils: $N = 12$\n- Toroidal positions of coils: $\\varphi_k = \\frac{2\\pi k}{N}$ for $k = 0, 1, \\dots, N-1$\n- Current in the $k$-th coil: $I_k = I_0 \\cos(n \\varphi_k - \\varphi_0)$\n- Per-coil current amplitude: $I_0$\n- Common phase: $\\varphi_0$\n- Target toroidal harmonic: $n = 3$\n- Vacuum magnetic field equations: $\\nabla \\times \\mathbf{B} = \\mathbf{0}$, $\\nabla \\cdot \\mathbf{B} = 0$\n- Transfer function definition: $H \\equiv \\frac{\\delta b_r^{\\mathrm{vac}}(q_{95})}{I^{(n)}}$\n- Complex Fourier amplitude of current: $I^{(n)}$\n- Complex amplitude of vacuum edge radial field: $\\delta b_r^{\\mathrm{vac}}(q_{95})$\n- Measured transfer function: $H = h \\exp(i \\alpha)$\n- Magnitude of transfer function: $h = 1.85 \\times 10^{-7} \\ \\mathrm{T/A}$\n- Phase of transfer function: $\\alpha = 28^{\\circ}$\n- Target vacuum edge radial field amplitude: $B_{\\mathrm{tgt}} = 1.34 \\times 10^{-3} \\ \\mathrm{T}$\n- Phase of target field: Real and positive, meaning its complex representation is $B_{\\mathrm{tgt}} \\exp(i \\cdot 0)$.\n- Assumptions: Linear response, quasistatic operation, negligible passive structures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is set within the established framework of magnetohydrodynamics and plasma control in fusion devices. The concepts used—resonant magnetic perturbations, Fourier decomposition, safety factor, and transfer functions—are standard in computational fusion science. The physical and mathematical principles are sound. The provided numerical values for field strengths, coil numbers, and transfer function magnitude are physically realistic for a tokamak. The problem is well-defined, providing all necessary parameters and a clear objective. It is free from ambiguity, contradiction, and subjective content. The problem requires a standard application of discrete Fourier analysis and manipulation of complex numbers, representing a valid and non-trivial engineering calculation.\n\n### Step 3: Verdict and Action\nThe problem is determined to be **valid**. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to find the per-coil current amplitude $I_0$ required to produce a specified edge radial magnetic field harmonic amplitude $B_{\\mathrm{tgt}}$. The solution requires relating the discrete coil currents $I_k$ to the total complex Fourier amplitude of the current, $I^{(n)}$, and then using the provided transfer function $H$ to connect $I^{(n)}$ to the resulting magnetic field.\n\nFirst, we must determine the relationship between the per-coil current amplitude $I_0$ and the complex amplitude of the $n$-th toroidal harmonic of the current array, $I^{(n)}$. The total current distribution can be thought of as a set of discrete sources. The complex amplitude of the $n$-th harmonic is found by performing a discrete Fourier transform. A standard definition for the un-normalized complex amplitude of the $n$-th harmonic from a set of $N$ discrete sources is the coherent sum of the phasors from each source:\n$$\nI^{(n)} = \\sum_{k=0}^{N-1} I_k \\exp(-in\\varphi_k)\n$$\nThe current in each of the $N$ coils is given by $I_k = I_0 \\cos(n \\varphi_k - \\varphi_0)$. We use Euler's formula, $\\cos(x) = \\frac{\\exp(ix) + \\exp(-ix)}{2}$, to express $I_k$ in terms of complex exponentials:\n$$\nI_k = I_0 \\frac{\\exp\\big(i(n\\varphi_k - \\varphi_0)\\big) + \\exp\\big(-i(n\\varphi_k - \\varphi_0)\\big)}{2} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\exp(in\\varphi_k) + \\exp(i\\varphi_0) \\exp(-in\\varphi_k) \\right]\n$$\nSubstituting this into the expression for $I^{(n)}$:\n$$\nI^{(n)} = \\sum_{k=0}^{N-1} \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\exp(in\\varphi_k) + \\exp(i\\varphi_0) \\exp(-in\\varphi_k) \\right] \\exp(-in\\varphi_k)\n$$\nDistributing the $\\exp(-in\\varphi_k)$ term and separating the sum:\n$$\nI^{(n)} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\sum_{k=0}^{N-1} \\exp\\big(i(n-n)\\varphi_k\\big) + \\exp(i\\varphi_0) \\sum_{k=0}^{N-1} \\exp\\big(-i(n+n)\\varphi_k\\big) \\right]\n$$\n$$\nI^{(n)} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\sum_{k=0}^{N-1} \\exp(0) + \\exp(i\\varphi_0) \\sum_{k=0}^{N-1} \\exp(-i2n\\varphi_k) \\right]\n$$\nThe first sum is $\\sum_{k=0}^{N-1} 1 = N$. The second sum is a geometric series of the form $\\sum_{k=0}^{N-1} (r)^k$ with $r = \\exp(-i2n \\frac{2\\pi}{N})$. The sum of such a series is $N$ if $r=1$ (i.e., the exponent's argument is a multiple of $2\\pi i$), and $0$ otherwise. Here, $r=1$ if $2n/N$ is an integer.\nUsing the given values $n=3$ and $N=12$, we have $2n/N = 6/12 = 1/2$, which is not an integer. Therefore, the second sum is zero.\n$$\n\\sum_{k=0}^{N-1} \\exp(-i2n\\varphi_k) = \\sum_{k=0}^{N-1} \\exp\\left(-i \\frac{4\\pi n k}{N}\\right) = 0\n$$\nThus, the expression for $I^{(n)}$ simplifies to:\n$$\nI^{(n)} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\cdot N + \\exp(i\\varphi_0) \\cdot 0 \\right] = \\frac{N I_0}{2} \\exp(-i\\varphi_0)\n$$\nNow, we use the transfer function $H = \\frac{\\delta b_r^{\\mathrm{vac}}}{I^{(n)}}$ to relate the current to the magnetic field.\n$$\n\\delta b_r^{\\mathrm{vac}} = H \\cdot I^{(n)}\n$$\nSubstitute the complex forms of $H$ and $I^{(n)}$:\n$$\n\\delta b_r^{\\mathrm{vac}} = \\big(h \\exp(i\\alpha)\\big) \\cdot \\left(\\frac{N I_0}{2} \\exp(-i\\varphi_0)\\right) = \\frac{N h I_0}{2} \\exp\\big(i(\\alpha - \\varphi_0)\\big)\n$$\nThe problem requires the resulting field harmonic $\\delta b_r^{\\mathrm{vac}}$ to be a real, positive quantity equal to $B_{\\mathrm{tgt}}$. This imposes a condition on the phase of the complex expression.\n$$\n\\delta b_r^{\\mathrm{vac}} = B_{\\mathrm{tgt}}\n$$\nFor the right-hand side to be real and positive, its complex phase must be zero. This requires $\\exp\\big(i(\\alpha - \\varphi_0)\\big) = 1$, which implies $\\alpha - \\varphi_0 = 2\\pi j$ for some integer $j$. This fixes the necessary common phase of the coil currents to be $\\varphi_0 = \\alpha = 28^{\\circ}$ (or an equivalent angle).\nWith this phase condition satisfied, the relationship between the magnitudes is:\n$$\nB_{\\mathrm{tgt}} = \\frac{N h I_0}{2}\n$$\nWe can now solve for the per-coil current amplitude $I_0$:\n$$\nI_0 = \\frac{2 B_{\\mathrm{tgt}}}{N h}\n$$\nNow, we substitute the given numerical values:\n- $B_{\\mathrm{tgt}} = 1.34 \\times 10^{-3} \\ \\mathrm{T}$\n- $N = 12$\n- $h = 1.85 \\times 10^{-7} \\ \\mathrm{T/A}$\n$$\nI_0 = \\frac{2 \\times (1.34 \\times 10^{-3})}{12 \\times (1.85 \\times 10^{-7})} = \\frac{2.68 \\times 10^{-3}}{2.22 \\times 10^{-6}} \\ \\mathrm{A}\n$$\n$$\nI_0 = \\frac{2.68}{2.22} \\times 10^3 \\ \\mathrm{A} \\approx 1207.207207... \\ \\mathrm{A}\n$$\nThe problem requests the answer to be rounded to four significant figures.\n$$\nI_0 \\approx 1207 \\ \\mathrm{A}\n$$\nThe final answer is the numerical value for the current amplitude $I_0$ in Amperes.",
            "answer": "$$\n\\boxed{1207}\n$$"
        },
        {
            "introduction": "Once an external magnetic field is applied, the highly conductive, rotating plasma actively works to screen it out, preventing penetration. This exercise introduces a powerful and intuitive model where the resonant plasma layer is treated as an effective electrical circuit, providing insight into the physics of this screening process. Using this analogy, you will calculate the penetration threshold by analyzing the competition between the driving electromotive force of the RMP and the layer's impedance, which is determined by both plasma resistivity and rotation.",
            "id": "4040848",
            "problem": "A cylindrical tokamak equilibrium is considered near a single rational surface at radius $r_{s}$. An external single-helicity Resonant Magnetic Perturbation (RMP) is applied with toroidal mode number $n$. The perturbation is static in the laboratory frame, so its laboratory angular frequency is $\\omega_{\\text{RMP}}=0$. The plasma has a uniform toroidal rotation with angular frequency $\\omega_{E}$, producing a relative helical frequency $\\omega=n\\,\\omega_{E}$ for the driven response. Assume single-fluid Magnetohydrodynamics (MHD) and use the parallel component of the generalized Ohm’s law, integrated along the helical connection length $L_{\\parallel}$, together with Maxwell–Faraday to model the resonant layer as an effective single-turn circuit. In the frequency domain, the parallel electric field $E_{\\parallel}$ drives a screening current $I$ against a complex impedance $Z=R+i\\,\\omega L$, where $R=\\eta\\,L_{\\parallel}/A$ is the effective resistance of the layer ($\\eta$ is the Spitzer resistivity and $A$ is the cross-sectional area available for parallel current in the layer), and $L=g\\,\\mu_{0}\\,L_{\\parallel}$ is the effective self-inductance of the helical current path (with $g$ a dimensionless geometry factor and $\\mu_{0}$ the vacuum permeability). The applied line-integrated electromotive force (EMF) is $E_{\\parallel}L_{\\parallel}$.\n\nDefine the penetration threshold as the minimal applied parallel electric field amplitude $E_{\\parallel,\\text{th}}$ such that the screening current amplitude equals that required to cancel the vacuum resonant radial magnetic field of the RMP at the rational surface. Model the required shielding current by the geometric relation $I_{\\text{sh}}=(2\\pi r_{s}/\\mu_{0})\\,b_{r}^{\\text{vac}}$, where $b_{r}^{\\text{vac}}$ is the amplitude of the vacuum resonant radial field at $r_{s}$.\n\nGiven the following parameters:\n- $r_{s}=1.6\\,\\mathrm{m}$,\n- $L_{\\parallel}=25\\,\\mathrm{m}$,\n- $\\delta=0.015\\,\\mathrm{m}$, and take $A=2\\pi r_{s}\\,\\delta$,\n- $\\eta=1.2\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$,\n- $g=0.5$,\n- $\\mu_{0}=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$,\n- $n=3$,\n- $\\omega_{E}=3.0\\times 10^{4}\\,\\mathrm{s}^{-1}$,\n- $b_{r}^{\\text{vac}}=4.0\\times 10^{-4}\\,\\mathrm{T}$,\n\nStarting from the fundamental relations of Maxwell–Faraday, Ampère’s law, and the generalized Ohm’s law, derive an expression for $E_{\\parallel,\\text{th}}$ and then compute its numerical value. Express the final answer in $\\mathrm{V/m}$ and round your answer to $4$ significant figures.",
            "solution": "The problem asks for the derivation and calculation of the penetration threshold, defined as the minimal applied parallel electric field amplitude $E_{\\parallel,\\text{th}}$, for a Resonant Magnetic Perturbation (RMP) in a cylindrical tokamak. The physical system is modeled as an effective single-turn circuit, a standard approach for analyzing the plasma's screening response at a rational surface.\n\nThe derivation begins with the circuit analogy provided in the problem statement. In the frequency domain, the relationship between the line-integrated electromotive force (EMF), which acts as the voltage $V$, the resulting screening current $I$, and the complex impedance of the resonant layer $Z$, is given by Ohm's law:\n$$V = I Z$$\nThe EMF is the parallel electric field $E_{\\parallel}$ integrated along the helical connection length $L_{\\parallel}$, so $V = E_{\\parallel} L_{\\parallel}$. The impedance $Z$ is complex, comprising a resistive part $R$ and an inductive part $i\\omega L$, where $\\omega$ is the relative frequency of the perturbation in the plasma frame. Thus, the circuit equation is:\n$$E_{\\parallel} L_{\\parallel} = I (R + i\\omega L)$$\nTo relate the amplitudes of these complex quantities, we take the magnitude of both sides of the equation:\n$$|E_{\\parallel} L_{\\parallel}| = |I (R + i\\omega L)|$$\nSince $E_{\\parallel}$ is defined as the amplitude of the parallel electric field, we can write $|E_{\\parallel}| = E_{\\parallel}$. Similarly, $I$ represents the amplitude of the current, so $|I| = I$. The length $L_{\\parallel}$ is a positive real number. The magnitude of the complex impedance is $|Z| = |R + i\\omega L| = \\sqrt{R^2 + (\\omega L)^2}$. This leads to the relationship between the amplitudes:\n$$E_{\\parallel} L_{\\parallel} = I \\sqrt{R^2 + (\\omega L)^2}$$\nFrom this, we can express the amplitude of the screening current $I$ driven by a given applied electric field $E_{\\parallel}$:\n$$I = \\frac{E_{\\parallel} L_{\\parallel}}{\\sqrt{R^2 + (\\omega L)^2}}$$\nThe problem defines the penetration threshold condition as the point where the screening current amplitude $I$ becomes equal to the current amplitude required to completely shield the vacuum RMP field at the rational surface, denoted as $I_{\\text{sh}}$. At this threshold, $E_{\\parallel} = E_{\\parallel,\\text{th}}$ and $I = I_{\\text{sh}}$. Substituting these into the equation gives:\n$$I_{\\text{sh}} = \\frac{E_{\\parallel,\\text{th}} L_{\\parallel}}{\\sqrt{R^2 + (\\omega L)^2}}$$\nSolving for the threshold electric field amplitude $E_{\\parallel,\\text{th}}$ yields the final symbolic expression:\n$$E_{\\parallel,\\text{th}} = \\frac{I_{\\text{sh}}}{L_{\\parallel}} \\sqrt{R^2 + (\\omega L)^2}$$\nTo compute the numerical value, we first calculate the intermediate quantities using the provided parameters:\n$r_{s}=1.6\\,\\mathrm{m}$, $L_{\\parallel}=25\\,\\mathrm{m}$, $\\delta=0.015\\,\\mathrm{m}$, $\\eta=1.2\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $g=0.5$, $\\mu_{0}=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$, $n=3$, $\\omega_{E}=3.0\\times 10^{4}\\,\\mathrm{s}^{-1}$, and $b_{r}^{\\text{vac}}=4.0\\times 10^{-4}\\,\\mathrm{T}$.\n\nThe cross-sectional area $A$ for the parallel current is:\n$$A = 2\\pi r_{s} \\delta = 2\\pi (1.6) (0.015) = 0.048\\pi\\,\\mathrm{m}^2 \\approx 0.1508\\,\\mathrm{m}^2$$\nThe effective resistance $R$ of the layer is:\n$$R = \\frac{\\eta L_{\\parallel}}{A} = \\frac{(1.2\\times 10^{-6})(25)}{0.048\\pi} = \\frac{3 \\times 10^{-5}}{0.048\\pi} \\approx 1.989 \\times 10^{-4}\\,\\Omega$$\nThe relative angular frequency $\\omega$ of the RMP in the plasma frame is:\n$$\\omega = n \\omega_{E} = (3)(3.0\\times 10^{4}) = 9.0 \\times 10^{4}\\,\\mathrm{s}^{-1}$$\nThe effective self-inductance $L$ of the helical current is:\n$$L = g \\mu_{0} L_{\\parallel} = (0.5)(4\\pi\\times 10^{-7})(25) = 5\\pi \\times 10^{-6}\\,\\mathrm{H} \\approx 1.571 \\times 10^{-5}\\,\\mathrm{H}$$\nThe amplitude of the required shielding current $I_{\\text{sh}}$ is:\n$$I_{\\text{sh}} = \\frac{2\\pi r_{s}}{\\mu_{0}} b_{r}^{\\text{vac}} = \\frac{2\\pi (1.6)}{4\\pi\\times 10^{-7}} (4.0\\times 10^{-4}) = \\frac{0.8}{10^{-7}} (4.0\\times 10^{-4}) = 3200\\,\\mathrm{A}$$\nNow, we compute the two terms of the impedance magnitude:\nThe resistive term squared is $R^2 \\approx (1.989\\times 10^{-4})^2 \\approx 3.958 \\times 10^{-8}\\,\\Omega^2$.\nThe inductive reactance is $\\omega L = (9.0 \\times 10^{4})(5\\pi \\times 10^{-6}) = 0.45\\pi\\,\\Omega \\approx 1.414\\,\\Omega$.\nThe inductive term squared is $(\\omega L)^2 \\approx (1.414)^2 \\approx 1.999\\,\\Omega^2$.\nThe magnitude of the impedance is:\n$$|Z| = \\sqrt{R^2 + (\\omega L)^2} = \\sqrt{(1.989 \\times 10^{-4})^2 + (1.414)^2} \\approx \\sqrt{3.958 \\times 10^{-8} + 1.999} \\approx 1.414\\,\\Omega$$\nNotice that the inductive term dominates the impedance, as $(\\omega L)^2 \\gg R^2$.\n\nFinally, we substitute these values into the expression for $E_{\\parallel,\\text{th}}$:\n$$E_{\\parallel,\\text{th}} = \\frac{3200\\,\\mathrm{A}}{25\\,\\mathrm{m}} \\times (1.4137167\\,\\Omega) = 128 \\times 1.4137167\\,\\mathrm{V/m} \\approx 180.9557\\,\\mathrm{V/m}$$\nRounding the result to $4$ significant figures, as requested, gives $181.0\\,\\mathrm{V/m}$.",
            "answer": "$$\n\\boxed{181.0}\n$$"
        },
        {
            "introduction": "Successful penetration of a resonant magnetic perturbation exerts a significant electromagnetic torque on the plasma, leading to a change in its toroidal rotation. This final practice shifts our focus to the macroscopic, dynamic consequences of this interaction. By solving a time-dependent momentum balance equation, you will simulate the transient braking of the plasma rotation following a change in the RMP amplitude, allowing you to explore concepts like momentum confinement time and the new steady-state rotation.",
            "id": "4040873",
            "problem": "Consider a simplified single-fluid toroidal momentum balance for a magnetically confined plasma subject to Resonant Magnetic Perturbation (RMP) braking. The fundamental base is Newton's second law for rotation: the sum of applied torques equals the time rate of change of angular momentum. For a uniform toroidal rotation with angular velocity $\\,\\Omega(t)\\,$, an effective moment of inertia $\\,I\\,$, and a linear damping coefficient $\\,C\\,$ that models neoclassical toroidal viscosity and turbulent drag, the momentum equation for $\\,t \\ge 0\\,$ is\n$$\nI\\,\\frac{d\\Omega}{dt} + C\\,\\Omega = T_{\\text{bg}} + T_{\\text{RMP}}(t),\n$$\nwhere $\\,T_{\\text{bg}}\\,$ is a constant background torque and $\\,T_{\\text{RMP}}(t)\\,$ is the torque due to the Resonant Magnetic Perturbation. Assume the RMP torque is proportional to the square of a dimensionless amplitude $\\,A(t)\\,$ with a coupling coefficient $\\,\\beta\\,$, acting in a braking sense, such that\n$$\nT_{\\text{RMP}}(t) = -\\beta\\,A(t)^2.\n$$\nLet $\\,A(t)\\,$ undergo a step change at $\\,t=0\\,$ from a pre-step value $\\,A_0\\,$ to a post-step value $\\,A_1\\,$. The initial angular velocity at $\\,t=0^-\\,$, denoted $\\,\\Omega_0\\,$, is given for each case below. For $\\,t \\ge 0\\,$ the torque is constant and equal to $\\,T_{\\text{post}} = T_{\\text{bg}} - \\beta\\,A_1^2\\,$.\n\nYour task is to compute the transient change in angular velocity, defined as\n$$\n\\Delta\\Omega(t) \\equiv \\Omega(t) - \\Omega_0,\n$$\nat specified times $\\,t\\,$ for each test case. Express all angular velocities in radians per second (rad/s). Angles should be treated in radians. The time $\\,t\\,$ is in seconds ($\\,\\text{s}\\,$). The parameters $\\,I\\,$ have units of kilogram-square meters ($\\,\\text{kg}\\cdot\\text{m}^2\\,$), $\\,C\\,$ have units of newton-meter-seconds ($\\,\\text{N}\\cdot\\text{m}\\cdot\\text{s}\\,$), $\\,\\beta\\,$ and $\\,T_{\\text{bg}}\\,$ have units of newton-meters ($\\,\\text{N}\\cdot\\text{m}\\,$), and $\\,A_0\\,$ and $\\,A_1\\,$ are dimensionless.\n\nFor $\\,C>0\\,$, the solution for $\\,t \\ge 0\\,$ must be obtained from the linear ordinary differential equation above. For the boundary case $\\,C=0\\,$, use the limiting form of the momentum equation.\n\nDesign a program that, for each test case, computes $\\,\\Delta\\Omega(t)\\,$ as a float in rad/s and outputs all results aggregated into a single line as a comma-separated list enclosed in square brackets.\n\nUse the following test suite. Each test case is a tuple $\\,\\left(I,\\,C,\\,\\beta,\\,A_0,\\,A_1,\\,T_{\\text{bg}},\\,\\Omega_0,\\,t\\right)\\,$:\n\n- General case (step increase, moderate damping): $\\,(I=\\;4.0\\times 10^3,\\;C=\\;1.0\\times 10^4,\\;\\beta=\\;2.0\\times 10^3,\\;A_0=\\;0.5,\\;A_1=\\;1.0,\\;T_{\\text{bg}}=\\;1.2\\times 10^4,\\;\\Omega_0=\\;1.15,\\;t=\\;0.02)\\,$.\n- Boundary case (no damping): $\\,(I=\\;4.0\\times 10^3,\\;C=\\;0,\\;\\beta=\\;3.0\\times 10^3,\\;A_0=\\;0.8,\\;A_1=\\;1.2,\\;T_{\\text{bg}}=\\;1.0\\times 10^4,\\;\\Omega_0=\\;1.0,\\;t=\\;0.01)\\,$.\n- Fast response (large damping): $\\,(I=\\;4.0\\times 10^3,\\;C=\\;8.0\\times 10^4,\\;\\beta=\\;2.0\\times 10^3,\\;A_0=\\;0.8,\\;A_1=\\;1.3,\\;T_{\\text{bg}}=\\;1.2\\times 10^4,\\;\\Omega_0=\\;0.134,\\;t=\\;0.1)\\,$.\n- No change (zero step): $\\,(I=\\;3.0\\times 10^3,\\;C=\\;1.5\\times 10^4,\\;\\beta=\\;1.5\\times 10^3,\\;A_0=\\;0.6,\\;A_1=\\;0.6,\\;T_{\\text{bg}}=\\;9.0\\times 10^3,\\;\\Omega_0=\\;0.564,\\;t=\\;0.5)\\,$.\n- Step decrease (rotation increases): $\\,(I=\\;5.0\\times 10^3,\\;C=\\;2.0\\times 10^4,\\;\\beta=\\;1.0\\times 10^3,\\;A_0=\\;1.2,\\;A_1=\\;0.7,\\;T_{\\text{bg}}=\\;8.0\\times 10^3,\\;\\Omega_0=\\;0.328,\\;t=\\;0.05)\\,$.\n\nFinal output format requirement: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\,[\\text{result1},\\text{result2},\\text{result3}]\\,)$, where each result is the computed $\\,\\Delta\\Omega(t)\\,$ in rad/s for the corresponding test case, in the same order as listed above.",
            "solution": "The user wants me to solve a problem based on a simplified model of plasma rotation in a tokamak under the influence of Resonant Magnetic Perturbations (RMPs).\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equation**: The toroidal momentum balance for angular velocity $\\Omega(t)$ is given by the ordinary differential equation (ODE):\n$$I\\,\\frac{d\\Omega}{dt} + C\\,\\Omega = T_{\\text{bg}} + T_{\\text{RMP}}(t), \\quad \\text{for } t \\ge 0$$\n- **Parameters**:\n  - $I$: an effective moment of inertia ($\\text{kg}\\cdot\\text{m}^2$)\n  - $C$: a linear damping coefficient ($\\text{N}\\cdot\\text{m}\\cdot\\text{s}$)\n  - $T_{\\text{bg}}$: a constant background torque ($\\text{N}\\cdot\\text{m}$)\n- **RMP Torque**: The torque from the RMP is given by:\n$$T_{\\text{RMP}}(t) = -\\beta\\,A(t)^2$$\n  where $\\beta$ is a coupling coefficient ($\\text{N}\\cdot\\text{m}$) and $A(t)$ is a dimensionless amplitude.\n- **Problem Setup**: The RMP amplitude $A(t)$ undergoes a step change at $t=0$ from a pre-step value $A_0$ to a post-step value $A_1$.\n- **Post-Step Torque**: For $t \\ge 0$, the total torque is constant and given by:\n$$T_{\\text{post}} = T_{\\text{bg}} - \\beta\\,A_1^2$$\n- **Initial Condition**: The initial angular velocity at $t=0^-$ is $\\Omega_0$. By continuity of momentum, the initial condition for the ODE at $t=0$ is $\\Omega(0) = \\Omega_0$.\n- **Target Quantity**: The transient change in angular velocity, defined as $\\Delta\\Omega(t) \\equiv \\Omega(t) - \\Omega_0$.\n- **Special Case**: For $C=0$, the limiting form of the momentum equation should be used.\n- **Test Cases**:\n  1. $(I=4.0\\times 10^3, C=1.0\\times 10^4, \\beta=2.0\\times 10^3, A_0=0.5, A_1=1.0, T_{\\text{bg}}=1.2\\times 10^4, \\Omega_0=1.15, t=0.02)$\n  2. $(I=4.0\\times 10^3, C=0, \\beta=3.0\\times 10^3, A_0=0.8, A_1=1.2, T_{\\text{bg}}=1.0\\times 10^4, \\Omega_0=1.0, t=0.01)$\n  3. $(I=4.0\\times 10^3, C=8.0\\times 10^4, \\beta=2.0\\times 10^3, A_0=0.8, A_1=1.3, T_{\\text{bg}}=1.2\\times 10^4, \\Omega_0=0.134, t=0.1)$\n  4. $(I=3.0\\times 10^3, C=1.5\\times 10^4, \\beta=1.5\\times 10^3, A_0=0.6, A_1=0.6, T_{\\text{bg}}=9.0\\times 10^3, \\Omega_0=0.564, t=0.5)$\n  5. $(I=5.0\\times 10^3, C=2.0\\times 10^4, \\beta=1.0\\times 10^3, A_0=1.2, A_1=0.7, T_{\\text{bg}}=8.0\\times 10^3, \\Omega_0=0.328, t=0.05)$\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the specified criteria:\n- **Scientifically Grounded**: The model is a standard, albeit simplified, representation of toroidal momentum balance in a tokamak, based on Newton's second law for rotation. The concepts of RMP-induced torque, neoclassical viscosity, and turbulent drag are central to modern fusion plasma physics. The problem is scientifically sound.\n- **Well-Posed**: The problem is formulated as a first-order linear ordinary differential equation with a given initial condition. This constitutes a well-posed initial value problem, which admits a unique solution. The target quantity, $\\Delta\\Omega(t)$, is unambiguously defined.\n- **Objective**: All terms are defined with mathematical precision and all parameters are given specific values and units. The problem is stated objectively.\n- **Flaw Analysis**:\n  1. **Scientific/Factual Unsoundness**: None. The model and parameters are physically plausible.\n  2. **Non-Formalizable/Irrelevant**: The problem is directly formalizable and highly relevant to computational fusion science.\n  3. **Incomplete/Contradictory Setup**: The problem is self-contained. The initial conditions are consistent with the pre-step steady states, which adds physical realism, but the problem would be well-posed regardless. There are no contradictions.\n  4. **Unrealistic/Infeasible**: The physical units are consistent. $I(d\\Omega/dt)$, $C\\Omega$, and the torques all have units of $\\text{N}\\cdot\\text{m}$. The parameter values are realistic.\n  5. **Ill-Posed/Poorly Structured**: None. The problem is a standard initial value problem.\n  6. **Pseudo-Profound/Trivial**: The problem requires the correct application of a fundamental technique (solving a linear ODE) to a physically relevant scenario, including a special boundary case. It is neither trivial nor pseudo-profound.\n  7. **Outside Scientific Verifiability**: The calculations are deterministic and can be independently verified.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Solution Design\n\nThe problem requires solving the toroidal momentum balance equation, which is a first-order linear ordinary differential equation (ODE), for the angular velocity $\\Omega(t)$ for $t \\ge 0$. The equation is:\n$$ I\\,\\frac{d\\Omega}{dt} + C\\,\\Omega = T_{\\text{post}} $$\nwhere $T_{\\text{post}} = T_{\\text{bg}} - \\beta\\,A_1^2$ is the constant net torque applied for $t \\ge 0$. The initial condition is $\\Omega(0) = \\Omega_0$. We must solve for $\\Delta\\Omega(t) = \\Omega(t) - \\Omega_0$. The solution methodology depends on whether the damping coefficient $C$ is zero or non-zero.\n\n**Case 1: Damped Rotation ($C > 0$)**\n\nThe ODE can be written in the standard form:\n$$ \\frac{d\\Omega}{dt} + \\frac{C}{I}\\,\\Omega = \\frac{T_{\\text{post}}}{I} $$\nThis is a linear first-order non-homogeneous ODE with constant coefficients. The general solution is the sum of a homogeneous solution, $\\Omega_h(t)$, and a particular solution, $\\Omega_p(t)$.\n\nThe homogeneous equation is $\\frac{d\\Omega_h}{dt} + \\frac{C}{I}\\,\\Omega_h = 0$, which has the solution $\\Omega_h(t) = K e^{-(C/I)t}$, where $K$ is an integration constant.\n\nFor the particular solution, since the right-hand side is constant, we assume a constant solution $\\Omega_p(t) = \\Omega_{\\infty}$. Substituting this into the ODE yields:\n$$ 0 + \\frac{C}{I}\\,\\Omega_{\\infty} = \\frac{T_{\\text{post}}}{I} \\implies \\Omega_{\\infty} = \\frac{T_{\\text{post}}}{C} $$\nThis is the new steady-state angular velocity that the system will approach as $t \\to \\infty$.\n\nThe full solution is $\\Omega(t) = \\Omega_h(t) + \\Omega_p(t) = K e^{-(C/I)t} + \\Omega_{\\infty}$. We determine the constant $K$ using the initial condition $\\Omega(0) = \\Omega_0$:\n$$ \\Omega(0) = K e^0 + \\Omega_{\\infty} = K + \\Omega_{\\infty} = \\Omega_0 $$\n$$ K = \\Omega_0 - \\Omega_{\\infty} $$\nSubstituting $K$ back gives the specific solution for $\\Omega(t)$:\n$$ \\Omega(t) = (\\Omega_0 - \\Omega_{\\infty}) e^{-Ct/I} + \\Omega_{\\infty} $$\nThe desired quantity is $\\Delta\\Omega(t) = \\Omega(t) - \\Omega_0$.\n$$ \\Delta\\Omega(t) = (\\Omega_0 - \\Omega_{\\infty}) e^{-Ct/I} + \\Omega_{\\infty} - \\Omega_0 $$\n$$ \\Delta\\Omega(t) = (\\Omega_{\\infty} - \\Omega_0) (1 - e^{-Ct/I}) $$\nSubstituting the expression for $\\Omega_{\\infty}$:\n$$ \\Delta\\Omega(t) = \\left( \\frac{T_{\\text{bg}} - \\beta\\,A_1^2}{C} - \\Omega_0 \\right) \\left( 1 - e^{-Ct/I} \\right) $$\nThis equation describes an exponential relaxation from the initial state $\\Omega_0$ towards the new final steady state $\\Omega_{\\infty}$ with a characteristic time constant $\\tau = I/C$.\n\n**Case 2: Undamped Rotation ($C = 0$)**\n\nWhen $C=0$, the momentum equation simplifies to:\n$$ I\\,\\frac{d\\Omega}{dt} = T_{\\text{post}} $$\n$$ \\frac{d\\Omega}{dt} = \\frac{T_{\\text{post}}}{I} $$\nThis equation indicates a constant rate of change of angular velocity, as the damping term that would oppose the motion is absent. We can directly integrate with respect to time from $0$ to $t$:\n$$ \\int_{\\Omega(0)}^{\\Omega(t)} d\\Omega' = \\int_{0}^{t} \\frac{T_{\\text{post}}}{I} dt' $$\n$$ \\Omega(t) - \\Omega(0) = \\left( \\frac{T_{\\text{post}}}{I} \\right) t $$\nUsing the initial condition $\\Omega(0) = \\Omega_0$, we find the change in angular velocity:\n$$ \\Delta\\Omega(t) = \\Omega(t) - \\Omega_0 = \\frac{T_{\\text{post}}}{I} t $$\nSubstituting the expression for $T_{\\text{post}}$:\n$$ \\Delta\\Omega(t) = \\frac{(T_{\\text{bg}} - \\beta\\,A_1^2)t}{I} $$\nThis result is consistent with taking the limit of the $C > 0$ solution as $C \\to 0$, using the Taylor expansion $e^{-x} \\approx 1-x$ for small $x$.\n\n**Computational Algorithm**\n\nThe algorithm will iterate through each test case provided. For each case, it will:\n1.  Unpack the parameters $(I, C, \\beta, A_0, A_1, T_{\\text{bg}}, \\Omega_0, t)$.\n2.  Calculate the post-step torque $T_{\\text{post}} = T_{\\text{bg}} - \\beta A_1^2$.\n3.  Check if $C=0$.\n    - If true, compute $\\Delta\\Omega(t)$ using the formula for the undamped case.\n    - If false, compute $\\Delta\\Omega(t)$ using the formula for the damped case.\n4.  Store the computed floating-point value.\n5.  After processing all cases, format the results into a single comma-separated string enclosed in square brackets.\n\nThis approach provides a direct and efficient way to calculate the required quantities for all specified scenarios.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the transient change in angular velocity for a set of test cases\n    based on a simplified toroidal momentum balance model for a magnetically\n    confined plasma.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (I, C, beta, A0, A1, T_bg, Omega0, t)\n    test_cases = [\n        # General case (step increase, moderate damping)\n        (4.0e3, 1.0e4, 2.0e3, 0.5, 1.0, 1.2e4, 1.15, 0.02),\n        # Boundary case (no damping)\n        (4.0e3, 0, 3.0e3, 0.8, 1.2, 1.0e4, 1.0, 0.01),\n        # Fast response (large damping)\n        (4.0e3, 8.0e4, 2.0e3, 0.8, 1.3, 1.2e4, 0.134, 0.1),\n        # No change (zero step)\n        (3.0e3, 1.5e4, 1.5e3, 0.6, 0.6, 9.0e3, 0.564, 0.5),\n        # Step decrease (rotation increases)\n        (5.0e3, 2.0e4, 1.0e3, 1.2, 0.7, 8.0e3, 0.328, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        I, C, beta, A0, A1, T_bg, Omega0, t = case\n\n        # Calculate the constant torque for t >= 0\n        T_post = T_bg - beta * A1**2\n\n        # The change in angular velocity, delta_omega = Omega(t) - Omega0\n        delta_omega = 0.0\n\n        if C == 0:\n            # Case for C = 0 (undamped rotation)\n            # The momentum balance is I * d(Omega)/dt = T_post\n            # Integrating gives Omega(t) = Omega0 + (T_post / I) * t\n            # So, delta_omega = (T_post / I) * t\n            delta_omega = (T_post / I) * t\n        else:\n            # Case for C > 0 (damped rotation)\n            # The solution to I*d(Omega)/dt + C*Omega = T_post is\n            # Omega(t) = (Omega0 - Omega_inf) * exp(-t/tau) + Omega_inf\n            # where Omega_inf = T_post / C is the new steady-state velocity\n            # and tau = I / C is the time constant.\n            # delta_omega = Omega(t) - Omega0 = (Omega_inf - Omega0) * (1 - exp(-t/tau))\n            omega_inf = T_post / C\n            tau = I / C\n            delta_omega = (omega_inf - Omega0) * (1 - np.exp(-t / tau))\n\n        results.append(delta_omega)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}