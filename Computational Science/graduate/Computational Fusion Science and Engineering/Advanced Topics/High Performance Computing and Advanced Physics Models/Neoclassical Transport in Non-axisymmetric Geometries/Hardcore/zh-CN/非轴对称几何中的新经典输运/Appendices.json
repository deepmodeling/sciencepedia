{
    "hands_on_practices": [
        {
            "introduction": "在分析非轴对称装置中的输运现象之前，我们必须首先对粒子运动所在的复杂磁面进行精确的数学描述。这项实践从第一性原理出发，引导你直接从仿星器磁面的坐标映射中推导度规张量。掌握这项技能是至关重要的，因为度规张量定义了弯曲磁面上的距离和角度，是所有后续输运计算的几何基础 。",
            "id": "4018915",
            "problem": "考虑一个三维环形等离子体位形，它代表一个非轴对称的仿星器式磁通面。令 $\\psi$ 标记嵌套的环形磁通量面，并在一个固定的磁通量面 $\\psi=\\psi_0$ 上定义常数小半径 $r=r(\\psi_0)$。引入角向和环向计算角度 $(\\theta,\\zeta)$，并令几何（柱）坐标 $(R,\\phi,Z)$ 由以下坐标映射给出：\n$$\nR(\\psi_0,\\theta,\\zeta) \\equiv R_0 + r\\left[\\cos\\theta + \\varepsilon \\cos\\!\\left(m\\theta - n\\zeta\\right)\\right],\\qquad\n\\phi(\\psi_0,\\theta,\\zeta) \\equiv \\zeta,\\qquad\nZ(\\psi_0,\\theta,\\zeta) \\equiv \\kappa\\,r\\left[\\sin\\theta + \\varepsilon_Z \\sin\\!\\left(m\\theta - n\\zeta\\right)\\right],\n$$\n其中 $R_0>0$ 是大半径，$\\kappa>0$ 是拉伸率，$\\varepsilon,\\varepsilon_Z$ 是与模数 $m\\in\\mathbb{Z}^+$ 和 $n\\in\\mathbb{Z}^+$ 的螺旋扰动相关的形状振幅。通过以下方式将此曲面嵌入三维欧几里得空间中：\n$$\nx = R\\cos\\phi,\\qquad y = R\\sin\\phi,\\qquad z = Z,\n$$\n使得在固定的 $\\psi=\\psi_0$ 上，位置矢量为 $\\boldsymbol{r}(\\theta,\\zeta) = \\big(R(\\theta,\\zeta)\\cos\\zeta,\\;R(\\theta,\\zeta)\\sin\\zeta,\\;Z(\\theta,\\zeta)\\big)$。\n\n从欧几里得线元 $d\\ell^2 = dx^2 + dy^2 + dz^2$ 以及协变度规系数的定义 $g_{ij} = \\partial_i \\boldsymbol{r}\\cdot \\partial_j \\boldsymbol{r}$（其中 $i,j\\in\\{\\theta,\\zeta\\}$ 且 $\\psi=\\psi_0$ 固定）出发，推导此映射的度规系数 $g_{\\theta\\theta}$、$g_{\\zeta\\zeta}$ 和 $g_{\\theta\\zeta}$，过程中不使用任何预先制定的几何公式。然后计算曲面上的弧长元，\n$$\nd\\ell^2 \\;=\\; g_{\\theta\\theta}\\,d\\theta^2 \\;+\\; 2\\,g_{\\theta\\zeta}\\,d\\theta\\,d\\zeta \\;+\\; g_{\\zeta\\zeta}\\,d\\zeta^2,\n$$\n将其表示为 $(\\theta,\\zeta)$ 和参数 $(R_0,r,\\kappa,\\varepsilon,\\varepsilon_Z,m,n)$ 的显式闭合形式解析函数。将 $r$、$R_0$、$\\kappa$、$\\varepsilon$、$\\varepsilon_Z$、$m$ 和 $n$ 视为关于 $\\theta$ 和 $\\zeta$ 的常数。你的最终方框答案必须是仅用 $\\theta$ 和 $\\zeta$ 表示的 $d\\ell^2$ 的单一闭合形式解析表达式（表达式中可以定义任何辅助的相位组合）。不需要进行数值计算，也不需要四舍五入。三角函数参数以弧度表示。",
            "solution": "该问题是有效的。这是一个适定的、有科学依据的微分几何问题，应用于等离子体物理学，要求计算参数化曲面的度规张量。所有必要信息均已提供，任务是进行直接推导，而不依赖于任何预先制定的公式。\n\n目标是计算指定环形曲面上的弧长元 $d\\ell^2$。该曲面由坐标 $(\\theta, \\zeta)$ 参数化，其在三维欧几里得空间中的嵌入由位置矢量 $\\boldsymbol{r}(\\theta, \\zeta)$ 给出。弧长元由二次型 $d\\ell^2 = d\\boldsymbol{r} \\cdot d\\boldsymbol{r}$ 定义。\n\n位置矢量 $\\boldsymbol{r}$ 的全微分为\n$$d\\boldsymbol{r} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\theta} d\\theta + \\frac{\\partial \\boldsymbol{r}}{\\partial \\zeta} d\\zeta$$\n因此，弧长元的平方为\n$$d\\ell^2 = d\\boldsymbol{r} \\cdot d\\boldsymbol{r} = \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\theta} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\theta}\\right) d\\theta^2 + 2\\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\theta} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\zeta}\\right) d\\theta d\\zeta + \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\zeta} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\zeta}\\right) d\\zeta^2$$\n此表达式的形式为 $d\\ell^2 = g_{\\theta\\theta}\\,d\\theta^2 + 2 g_{\\theta\\zeta}\\,d\\theta d\\zeta + g_{\\zeta\\zeta}\\,d\\zeta^2$，其中协变度规系数定义为 $g_{ij} = \\partial_i \\boldsymbol{r} \\cdot \\partial_j \\boldsymbol{r}$。我们的任务是计算这些系数。\n\n首先，我们将位置矢量 $\\boldsymbol{r}$ 写成笛卡尔坐标 $(x,y,z)$。使用给定的变换 $x = R\\cos\\phi$、$y = R\\sin\\phi$、$z=Z$ 和 $\\phi=\\zeta$，我们有\n$$\\boldsymbol{r}(\\theta,\\zeta) = \\large( R(\\theta,\\zeta)\\cos\\zeta, \\;R(\\theta,\\zeta)\\sin\\zeta, \\;Z(\\theta,\\zeta) \\large)$$\n其中\n$$R(\\theta,\\zeta) = R_0 + r\\left[\\cos\\theta + \\varepsilon \\cos(m\\theta - n\\zeta)\\right]$$\n$$Z(\\theta,\\zeta) = \\kappa\\,r\\left[\\sin\\theta + \\varepsilon_Z \\sin(m\\theta - n\\zeta)\\right]$$\n为简化表示，令螺旋相位角为 $\\alpha(\\theta, \\zeta) = m\\theta - n\\zeta$。\n\n接下来，我们计算切矢量 $\\partial_\\theta \\boldsymbol{r} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\theta}$ 和 $\\partial_\\zeta \\boldsymbol{r} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\zeta}$。这需要 $R$ 和 $Z$ 的偏导数：\n$$\\frac{\\partial R}{\\partial \\theta} = r\\left[-\\sin\\theta - m\\,\\varepsilon \\sin(m\\theta - n\\zeta)\\right] = -r(\\sin\\theta + m\\varepsilon\\sin\\alpha)$$\n$$\\frac{\\partial R}{\\partial \\zeta} = r\\left[n\\,\\varepsilon \\sin(m\\theta - n\\zeta)\\right] = n r \\varepsilon \\sin\\alpha$$\n$$\\frac{\\partial Z}{\\partial \\theta} = \\kappa r\\left[\\cos\\theta + m\\,\\varepsilon_Z \\cos(m\\theta - n\\zeta)\\right] = \\kappa r(\\cos\\theta + m\\varepsilon_Z\\cos\\alpha)$$\n$$\\frac{\\partial Z}{\\partial \\zeta} = \\kappa r\\left[-n\\,\\varepsilon_Z \\cos(m\\theta - n\\zeta)\\right] = -n\\kappa r \\varepsilon_Z \\cos\\alpha$$\n\n使用乘积法则和链式法则，切矢量为：\n$$\\partial_\\theta \\boldsymbol{r} = \\left( \\frac{\\partial R}{\\partial \\theta} \\cos\\zeta, \\; \\frac{\\partial R}{\\partial \\theta} \\sin\\zeta, \\; \\frac{\\partial Z}{\\partial \\theta} \\right)$$\n$$\\partial_\\zeta \\boldsymbol{r} = \\left( \\frac{\\partial R}{\\partial \\zeta} \\cos\\zeta - R \\sin\\zeta, \\; \\frac{\\partial R}{\\partial \\zeta} \\sin\\zeta + R \\cos\\zeta, \\; \\frac{\\partial Z}{\\partial \\zeta} \\right)$$\n\n现在我们通过计算这些切矢量的点积来计算度规系数。\n对于 $g_{\\theta\\theta}$：\n$$g_{\\theta\\theta} = \\partial_\\theta \\boldsymbol{r} \\cdot \\partial_\\theta \\boldsymbol{r} = \\left(\\frac{\\partial R}{\\partial \\theta}\\right)^2 \\cos^2\\zeta + \\left(\\frac{\\partial R}{\\partial \\theta}\\right)^2 \\sin^2\\zeta + \\left(\\frac{\\partial Z}{\\partial \\theta}\\right)^2$$\n$$g_{\\theta\\theta} = \\left(\\frac{\\partial R}{\\partial \\theta}\\right)^2 + \\left(\\frac{\\partial Z}{\\partial \\theta}\\right)^2$$\n代入导数：\n$$g_{\\theta\\theta} = \\left[-r(\\sin\\theta + m\\varepsilon\\sin\\alpha)\\right]^2 + \\left[\\kappa r(\\cos\\theta + m\\varepsilon_Z\\cos\\alpha)\\right]^2$$\n$$g_{\\theta\\theta} = r^2(\\sin\\theta + m\\varepsilon\\sin\\alpha)^2 + \\kappa^2 r^2(\\cos\\theta + m\\varepsilon_Z\\cos\\alpha)^2$$\n\n对于 $g_{\\zeta\\zeta}$：\n$$g_{\\zeta\\zeta} = \\partial_\\zeta \\boldsymbol{r} \\cdot \\partial_\\zeta \\boldsymbol{r} = \\left(\\frac{\\partial R}{\\partial \\zeta} \\cos\\zeta - R \\sin\\zeta\\right)^2 + \\left(\\frac{\\partial R}{\\partial \\zeta} \\sin\\zeta + R \\cos\\zeta\\right)^2 + \\left(\\frac{\\partial Z}{\\partial \\zeta}\\right)^2$$\n展开前两项：\n$$(\\ldots) = \\left(\\frac{\\partial R}{\\partial \\zeta}\\right)^2\\cos^2\\zeta - 2R\\frac{\\partial R}{\\partial \\zeta}\\cos\\zeta\\sin\\zeta + R^2\\sin^2\\zeta + \\left(\\frac{\\partial R}{\\partial \\zeta}\\right)^2\\sin^2\\zeta + 2R\\frac{\\partial R}{\\partial \\zeta}\\sin\\zeta\\cos\\zeta + R^2\\cos^2\\zeta$$\n$$(\\ldots) = \\left(\\frac{\\partial R}{\\partial \\zeta}\\right)^2(\\cos^2\\zeta+\\sin^2\\zeta) + R^2(\\sin^2\\zeta+\\cos^2\\zeta) = \\left(\\frac{\\partial R}{\\partial \\zeta}\\right)^2 + R^2$$\n因此，\n$$g_{\\zeta\\zeta} = R^2 + \\left(\\frac{\\partial R}{\\partial \\zeta}\\right)^2 + \\left(\\frac{\\partial Z}{\\partial \\zeta}\\right)^2$$\n代入 $R$ 的表达式和导数：\n$$g_{\\zeta\\zeta} = \\left(R_0 + r(\\cos\\theta + \\varepsilon \\cos\\alpha)\\right)^2 + (n r \\varepsilon \\sin\\alpha)^2 + (-n\\kappa r \\varepsilon_Z \\cos\\alpha)^2$$\n$$g_{\\zeta\\zeta} = \\left(R_0 + r(\\cos\\theta + \\varepsilon \\cos\\alpha)\\right)^2 + n^2 r^2 \\varepsilon^2 \\sin^2\\alpha + n^2 \\kappa^2 r^2 \\varepsilon_Z^2 \\cos^2\\alpha$$\n\n对于交叉项 $g_{\\theta\\zeta}$：\n$$g_{\\theta\\zeta} = \\partial_\\theta \\boldsymbol{r} \\cdot \\partial_\\zeta \\boldsymbol{r} = \\left(\\frac{\\partial R}{\\partial \\theta} \\cos\\zeta\\right)\\left(\\frac{\\partial R}{\\partial \\zeta} \\cos\\zeta - R \\sin\\zeta\\right) + \\left(\\frac{\\partial R}{\\partial \\theta} \\sin\\zeta\\right)\\left(\\frac{\\partial R}{\\partial \\zeta} \\sin\\zeta + R \\cos\\zeta\\right) + \\frac{\\partial Z}{\\partial \\theta}\\frac{\\partial Z}{\\partial \\zeta}$$\n展开前两项：\n$$(\\ldots) = \\frac{\\partial R}{\\partial \\theta}\\frac{\\partial R}{\\partial \\zeta}\\cos^2\\zeta - R\\frac{\\partial R}{\\partial \\theta}\\cos\\zeta\\sin\\zeta + \\frac{\\partial R}{\\partial \\theta}\\frac{\\partial R}{\\partial \\zeta}\\sin^2\\zeta + R\\frac{\\partial R}{\\partial \\theta}\\sin\\zeta\\cos\\zeta = \\frac{\\partial R}{\\partial \\theta}\\frac{\\partial R}{\\partial \\zeta}(\\cos^2\\zeta+\\sin^2\\zeta) = \\frac{\\partial R}{\\partial \\theta}\\frac{\\partial R}{\\partial \\zeta}$$\n因此，\n$$g_{\\theta\\zeta} = \\frac{\\partial R}{\\partial \\theta}\\frac{\\partial R}{\\partial \\zeta} + \\frac{\\partial Z}{\\partial \\theta}\\frac{\\partial Z}{\\partial \\zeta}$$\n代入导数：\n$$g_{\\theta\\zeta} = \\left[-r(\\sin\\theta + m\\varepsilon\\sin\\alpha)\\right]\\left[n r \\varepsilon \\sin\\alpha\\right] + \\left[\\kappa r(\\cos\\theta + m\\varepsilon_Z\\cos\\alpha)\\right]\\left[-n\\kappa r \\varepsilon_Z \\cos\\alpha\\right]$$\n$$g_{\\theta\\zeta} = -n r^2 \\varepsilon\\sin\\alpha(\\sin\\theta + m\\varepsilon\\sin\\alpha) - n\\kappa^2 r^2 \\varepsilon_Z\\cos\\alpha(\\cos\\theta + m\\varepsilon_Z\\cos\\alpha)$$\n$$g_{\\theta\\zeta} = -n r^2 \\left[ \\varepsilon\\sin\\theta\\sin\\alpha + m\\varepsilon^2\\sin^2\\alpha + \\kappa^2\\varepsilon_Z\\cos\\theta\\cos\\alpha + \\kappa^2 m\\varepsilon_Z^2\\cos^2\\alpha \\right]$$\n\n最后，我们组合出弧长元 $d\\ell^2$ 的完整表达式：\n$$d\\ell^2 = g_{\\theta\\theta}\\,d\\theta^2 + 2\\,g_{\\theta\\zeta}\\,d\\theta\\,d\\zeta + g_{\\zeta\\zeta}\\,d\\zeta^2$$\n代入推导出的系数表达式即可得到最终结果。\n$$d\\ell^2 = \\left[ r^2(\\sin\\theta + m\\varepsilon\\sin\\alpha)^2 + \\kappa^2 r^2(\\cos\\theta + m\\varepsilon_Z\\cos\\alpha)^2 \\right] d\\theta^2$$\n$$- 2 n r^2 \\left[ \\varepsilon\\sin\\theta\\sin\\alpha + m\\varepsilon^2\\sin^2\\alpha + \\kappa^2\\varepsilon_Z\\cos\\theta\\cos\\alpha + \\kappa^2 m\\varepsilon_Z^2\\cos^2\\alpha \\right] d\\theta d\\zeta$$\n$$+ \\left[ (R_0 + r(\\cos\\theta + \\varepsilon\\cos\\alpha))^2 + n^2 r^2 \\varepsilon^2 \\sin^2\\alpha + n^2 \\kappa^2 r^2 \\varepsilon_Z^2 \\cos^2\\alpha \\right] d\\zeta^2$$\n其中 $\\alpha = m\\theta - n\\zeta$。这是曲面上弧长元平方的显式闭合形式解析表达式，是 $(\\theta, \\zeta)$ 和给定参数的函数。三角函数参数默认以弧度为单位。",
            "answer": "$$\n\\boxed{\n\\begin{aligned}\n\\text{令 } \\alpha = m\\theta - n\\zeta。\\text{ 则 } d\\ell^2 =  \\left[ r^2(\\sin\\theta + m\\varepsilon\\sin\\alpha)^2 + \\kappa^2 r^2(\\cos\\theta + m\\varepsilon_Z\\cos\\alpha)^2 \\right] d\\theta^2 \\\\\n - 2 n r^2 \\left[ \\varepsilon\\sin\\theta\\sin\\alpha + m\\varepsilon^2\\sin^2\\alpha + \\kappa^2\\varepsilon_Z\\cos\\theta\\cos\\alpha + \\kappa^2 m\\varepsilon_Z^2\\cos^2\\alpha \\right] d\\theta d\\zeta \\\\\n + \\left[ (R_0 + r(\\cos\\theta + \\varepsilon\\cos\\alpha))^2 + n^2 r^2 \\varepsilon^2 \\sin^2\\alpha + n^2 \\kappa^2 r^2 \\varepsilon_Z^2 \\cos^2\\alpha \\right] d\\zeta^2\n\\end{aligned}\n}\n$$"
        },
        {
            "introduction": "漂移动理学求解器通常计算的是单个能量（或称“单能”）下的输运系数，但要将理论预测与实验结果进行比较，我们必须得到在等离子体温度下的热平均系数。本实践将指导你完成这一关键步骤，通过对单能系数进行麦克斯韦速度分布的加权积分，来计算热平均输运系数。这是一项核心的计算技能，它将原始的模拟输出转化为具有直接物理意义的量 。",
            "id": "4018971",
            "problem": "要求您通过将单能结果与麦克斯韦权重进行卷积，并实现对速率的积分，来计算非轴对称几何中的热平均新经典输运系数。此任务的基础是麦克斯韦-玻尔兹曼分布和热平均的定义。考虑一个磁通面平均的单能类扩散输运系数 $K(v)$，它依赖于粒子速率 $v$，并包含了诸如碰撞限制输运、磁场波纹引起的类 $1/v$ 行为以及由非轴对称磁阱引起的共振特征等物理现象。对于质量为 $m$、温度为 $T$ 的粒子种类，$K(v)$ 的热平均定义为 $K(v)$ 对各向同性麦克斯韦速率分布的积分。\n\n使用以下经过充分检验的事实作为出发点：\n\n- 对于质量为 $m$、温度为 $T$ 的粒子（其中 $T$ 以电子伏特为单位，并转换为焦耳 $T_J = T \\, e$，其中 $e$ 是基本电荷），其各向同性麦克斯韦速率分布为\n$$\nf_v(v) = 4\\pi v^2 \\left( \\frac{m}{2\\pi T_J} \\right)^{3/2} \\exp\\!\\left(-\\frac{m v^2}{2 T_J}\\right),\n$$\n该分布是归一化的，因此\n$$\n\\int_{0}^{\\infty} f_v(v)\\, dv = 1.\n$$\n\n- $K(v)$ 的热平均为\n$$\n\\langle K \\rangle = \\int_{0}^{\\infty} K(v)\\, f_v(v)\\, dv.\n$$\n\n为了算法实现和可测试性，我们将单能系数设为由以下参数族给出\n$$\nK(v) = D_0 \\left[ a \\left(\\frac{v}{v_{\\mathrm{th}}}\\right)^p + b \\left(\\frac{v_{\\mathrm{th}}}{v+\\epsilon}\\right) + \\lambda \\exp\\!\\left( -\\frac{(v - \\eta v_{\\mathrm{th}})^2}{2\\sigma^2} \\right) \\right],\n$$\n其中 $v_{\\mathrm{th}} = \\sqrt{\\frac{2 T_J}{m}}$ 是热速率，$D_0$ 是一个以 $\\mathrm{m^2/s}$ 为单位的扩散标度，$a$、$p$、$b$、$\\lambda$、$\\eta$ 是无量纲参数，而 $\\epsilon$ 和 $\\sigma$ 的单位是 $\\mathrm{m/s}$。构建此形式是为了捕捉在非轴对称新经典输运中观察到的三种定性机制：通过 $a \\left(\\frac{v}{v_{\\mathrm{th}}}\\right)^p$ 实现的碰撞/平台标度，通过 $b \\left(\\frac{v_{\\mathrm{th}}}{v+\\epsilon}\\right)$ 实现的波纹/香蕉状类 $1/v$ 正则化行为，以及通过中心在 $v \\approx \\eta v_{\\mathrm{th}}$ 附近的高斯项实现的非轴对称共振峰。\n\n您的任务是：\n- 推导 $\\langle K \\rangle$ 积分的一种算法上方便的表示形式，并对其进行数值实现。\n- 为提供的测试套件计算 $\\langle K \\rangle$。\n- 将所有案例的最终答案以 $\\mathrm{m^2/s}$ 为单位表示为浮点数。\n\n此任务不需要角度单位，也没有百分比。所有物理量都应使用国际单位制（SI）处理。温度值以电子伏特为单位提供，必须使用基本电荷转换为焦耳。\n\n测试套件和参数：\n使用基本电荷 $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$（因此 $1\\ \\mathrm{eV} = e\\ \\mathrm{J}$）和原子质量单位 $\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$。对于每个案例，$m$ 是粒子种类质量，$T$ 是以电子伏特为单位的温度，其他参数定义了 $K(v)$。\n\n- 案例1（正常路径，氘离子）：\n  - $m = 3.343583719\\times 10^{-27}\\ \\mathrm{kg}$,\n  - $T = 1000\\ \\mathrm{eV}$,\n  - $D_0 = 0.5\\ \\mathrm{m^2/s}$,\n  - $a = 0.3$, $p = 1.0$, $b = 0.08$, $\\epsilon = 50.0\\ \\mathrm{m/s}$, $\\lambda = 0.15$, $\\eta = 0.8$, $\\sigma = 1.2\\times 10^{5}\\ \\mathrm{m/s}$。\n\n- 案例2（边界情况，极低温度）：\n  - $m = 3.343583719\\times 10^{-27}\\ \\mathrm{kg}$,\n  - $T = 1\\ \\mathrm{eV}$,\n  - $D_0 = 0.5\\ \\mathrm{m^2/s}$,\n  - $a = 0.2$, $p = 2.0$, $b = 0.3$, $\\epsilon = 1.0\\ \\mathrm{m/s}$, $\\lambda = 0.0$, $\\eta = 1.0$, $\\sigma = 1.0\\times 10^{5}\\ \\mathrm{m/s}$。\n\n- 案例3（电子，高温，共振主导）：\n  - $m = 9.10938356\\times 10^{-31}\\ \\mathrm{kg}$,\n  - $T = 10000\\ \\mathrm{eV}$,\n  - $D_0 = 0.05\\ \\mathrm{m^2/s}$,\n  - $a = 0.1$, $p = 0.0$, $b = 0.02$, $\\epsilon = 1.0\\times 10^{-3}\\ \\mathrm{m/s}$, $\\lambda = 0.05$, $\\eta = 1.5$, $\\sigma = 2.0\\times 10^{6}\\ \\mathrm{m/s}$。\n\n- 案例4（边缘情况，恒定系数，重杂质）：\n  - $m = 183.84\\times \\mathrm{amu}\\ \\mathrm{kg}$,\n  - $T = 50\\ \\mathrm{eV}$,\n  - $D_0 = 0.02\\ \\mathrm{m^2/s}$,\n  - $a = 1.0$, $p = 0.0$, $b = 0.0$, $\\epsilon = 0.0\\ \\mathrm{m/s}$, $\\lambda = 0.0$, $\\eta = 1.0$, $\\sigma = 1.0\\times 10^{5}\\ \\mathrm{m/s}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result_1,result_2,result_3,result_4]$）。每个条目是相应案例的热平均系数 $\\langle K \\rangle$，以 $\\mathrm{m^2/s}$ 为单位，表示为浮点数。",
            "solution": "该问题要求计算热平均新经典输运系数，记为 $\\langle K \\rangle$。这是通过将给定的单能输运系数 $K(v)$ 对所有粒子速率 $v$ 进行积分，并由麦克斯韦速率分布 $f_v(v)$ 加权来实现的。\n\n热平均的基本定义由以下积分给出：\n$$\n\\langle K \\rangle = \\int_{0}^{\\infty} K(v)\\, f_v(v)\\, dv\n$$\n问题为麦克斯韦分布和单能系数都提供了显式形式。\n对于质量为 $m$、温度为 $T$（单位为电子伏特，转换为焦耳 $T_J = T \\cdot e$）的粒子，其各向同性麦克斯韦速率分布为：\n$$\nf_v(v) = 4\\pi v^2 \\left( \\frac{m}{2\\pi T_J} \\right)^{3/2} \\exp\\!\\left(-\\frac{m v^2}{2 T_J}\\right)\n$$\n该分布是归一化的，使其在从 $0$ 到 $\\infty$ 的所有速率上的积分为 $1$。\n\n单能系数 $K(v)$ 是一个参数模型，旨在捕捉各种输运现象：\n$$\nK(v) = D_0 \\left[ a \\left(\\frac{v}{v_{\\mathrm{th}}}\\right)^p + b \\left(\\frac{v_{\\mathrm{th}}}{v+\\epsilon}\\right) + \\lambda \\exp\\!\\left( -\\frac{(v - \\eta v_{\\mathrm{th}})^2}{2\\sigma^2} \\right) \\right]\n$$\n其中 $v_{\\mathrm{th}} = \\sqrt{2 T_J / m}$ 是热速率。\n\n为了开发一个鲁棒且高效的算法，我们首先通过变量替换来简化积分。我们引入一个无量纲速率变量 $x = v/v_{\\mathrm{th}}$。这意味着 $v = x v_{\\mathrm{th}}$，微分元变为 $dv = v_{\\mathrm{th}} dx$。这种变量替换是有利的，因为它通过其特征热标度对速率进行归一化，使得被积函数的行为在不同温度和质量下更具普适性。\n\n在此变换下，麦克斯韦分布微分元 $f_v(v)dv$ 简化为无量纲形式，我们记为 $g(x)dx：\n$$\ng(x)dx = \\frac{4}{\\sqrt{\\pi}} x^2 e^{-x^2} dx\n$$\n函数 $g(x)$ 代表无量纲速率 $x$ 的概率分布，并且它也被归一化为1，即 $\\int_0^\\infty g(x) dx = 1$。\n\n单能系数 $K(v)$ 也被重新表达为 $x$ 的函数：\n$$\nK(v(x)) = D_0 \\left[ a x^p + \\frac{b v_{\\mathrm{th}}}{x v_{\\mathrm{th}} + \\epsilon} + \\lambda \\exp\\!\\left( -\\frac{v_{\\mathrm{th}}^2(x - \\eta)^2}{2\\sigma^2} \\right) \\right]\n$$\n结合这些结果，热平均 $\\langle K \\rangle$ 表示为对无量纲速率 $x$ 从 $0$ 到 $\\infty$ 的积分：\n$$\n\\langle K \\rangle = \\int_0^\\infty K(v(x)) g(x) dx\n$$\n被积函数 $I(x) = K(v(x)) g(x)$ 包含的项通常在解析上难以积分。然而，来自 $g(x)$ 的 $e^{-x^2}$ 因子确保了被积函数对于大的 $x$ 值会快速衰减，这使得积分是良态的，并且非常适合数值求积方法。\n\n因此，计算算法如下：\n1.  对于每个测试案例，我们首先计算中间物理量：以焦耳为单位的温度 $T_J = T \\cdot e$，以及相应的热速率 $v_{\\mathrm{th}} = \\sqrt{2T_J/m}$。\n2.  我们构建一个函数，对于给定的 $x$ 和特定测试案例的参数集，计算完整被积函数 $I(x) = K(v(x)) g(x)$ 的值。\n3.  我们使用一个高质量的数值求积程序，特别是来自 SciPy 库的 `scipy.integrate.quad`，来计算该函数在半无限区间 $[0, \\infty)$ 上的定积分。这个自适应程序能够处理被积函数的行为，包括由 $K(v)$ 中的高斯项所描述的潜在尖锐共振峰。\n\n在案例4中出现了一个特殊情况，其中 $p=0$，$b=0$ 且 $\\lambda=0$。此时，单能系数简化为一个常数，$K(v) = D_0 \\cdot a$。热平均则变为：\n$$\n\\langle K \\rangle = \\int_0^\\infty (D_0 \\cdot a) f_v(v) dv = D_0 \\cdot a \\int_0^\\infty f_v(v) dv = D_0 \\cdot a\n$$\n这是因为 $f_v(v)$ 的归一化特性。这个解析结果可作为对整体方法论的一个有价值的合理性检查，并可用于该特定案例的直接计算。实现的代码将处理这个特殊情况以提高效率和准确性，而对所有其他案例则使用数值积分。",
            "answer": "[0.26418873,0.25925395,0.00760072,0.02]"
        },
        {
            "introduction": "在非轴对称等离子体中，径向电场 $E_r$ 并非一个外部给定的参数，而是由双极性约束自洽地决定——即离子和电子的径向输运通量必须相等以维持宏观电中性。这项实践是局部新经典输运分析的终极步骤，你将学习如何构建一个稳健的数值求解器来寻找满足双极性条件的径向电场 $E_r$。这个自洽的电场值对于准确预测和理解仿星器中的整体输运水平至关重要 。",
            "id": "4018927",
            "problem": "考虑一个在布泽尔坐标系下参数化的非轴对称环形几何中的单个磁通面。假设一个漂移-动理学求解器（DKS）能为每个粒子种类提供新经典径向粒子输运响应系数，这些系数用以量化该粒子种类的径向粒子通量如何依赖于径向电场。对于粒子种类 $s \\in \\{\\text{离子}, \\text{电子}\\}$，其径向粒子通量作为径向电场 $E_r$ 的函数，模型如下：\n$$\n\\Gamma_s(E_r) = A_s + B_s E_r + C_s \\tanh\\!\\big( D_s\\, g\\, E_r \\big),\n$$\n其中 $A_s$、$B_s$、$C_s$ 和 $D_s$ 是从漂移-动理学求解器获得的常数系数，$g$ 是一个几何因子，用于缩放由非轴对称性引起的有效相空间进动频率（例如，与有效螺旋波纹和磁力线曲率相关）。假设离子和电子均为单电荷，因此双极性条件简化为\n$$\n\\Gamma_i(E_r) - \\Gamma_e(E_r) = 0.\n$$\n令 $f(E_r) \\equiv \\Gamma_i(E_r) - \\Gamma_e(E_r)$。您的任务是设计并实现一个迭代数值方案，使用带回溯的阻尼牛顿法以及松弛皮卡迭代作为备用方法，来求解 $f(E_r) = 0$ 以得到 $E_r$。您必须通过求解代表不同非轴对称几何和输运区的三组不同参数集，来展示其收敛特性。\n\n从基本的新经典输运原理出发：磁通面上的径向双极性和漂移-动理学响应系数。目标是设计并实现一个遵循这些原理且能收敛到 $f(E_r)$ 的具有物理意义的根的稳健求解器。\n\n实现要求：\n- 根据给定模型，解析地定义函数 $f(E_r)$ 及其导数 $f'(E_r)$。导数必须从所提供的 $\\Gamma_s(E_r)$ 依赖关系推导得出。\n- 实现一个带回溯的阻尼牛顿法，该方法尝试单调地减小 $|f(E_r)|$ 并包含对小 $|f'(E_r)|$ 值的保护措施。\n- 实现一个松弛皮卡迭代 $E_r^{(k+1)} = E_r^{(k)} - \\lambda f(E_r^{(k)})$，其中自适应松弛参数 $\\lambda$ 根据局部信息（例如，在可用时使用 $f'(E_r)$）进行选择，以确保在牛顿法遇到困难时能够收敛。\n- 对所有测试用例使用初始猜测值 $E_r^{(0)} = 0$。\n- 使用基于残差 $|f(E_r)|$ 的停止准则，具体为 $|f(E_r)|  \\varepsilon$（其中 $\\varepsilon = 10^{-9}$），并且每种方法的最大迭代次数为 $100$ 次。\n- 将最终计算出的径向电场以伏特/米（V/m）为单位表示，并四舍五入到三位有效数字。\n\n解析形式：\n- 使用上述模型，推导出\n$$\nf(E_r) = \\big(A_i - A_e\\big) + \\big(B_i - B_e\\big) E_r + C_i \\tanh\\!\\big( D_i g E_r \\big) - C_e \\tanh\\!\\big( D_e g E_r \\big),\n$$\n和\n$$\nf'(E_r) = \\big(B_i - B_e\\big) + C_i D_i g\\, \\operatorname{sech}^2\\!\\big( D_i g E_r \\big) - C_e D_e g\\, \\operatorname{sech}^2\\!\\big( D_e g E_r \\big).\n$$\n\n测试套件：\n提供并求解以下三个科学上合理的测试用例，每个用例由参数元组 $(A_i, B_i, C_i, D_i, A_e, B_e, C_e, D_e, g)$ 指定。\n\n- 用例 1（电子根区，典型波纹）：\n  - $A_i = 30.8$, $B_i = 10^{-3}$, $C_i = 0.5$, $D_i = 10^{-4}$,\n  - $A_e = 0.8$, $B_e = -10^{-3}$, $C_e = 0.4$, $D_e = 2 \\times 10^{-4}$,\n  - $g = 1.0$.\n- 用例 2（离子根区，减小波纹）：\n  - $A_i = 0.2$, $B_i = 10^{-3}$, $C_i = 0.5$, $D_i = 10^{-4}$,\n  - $A_e = 10.2$, $B_e = -10^{-3}$, $C_e = 0.4$, $D_e = 2 \\times 10^{-4}$,\n  - $g = 0.5$.\n- 用例 3（边缘情况，线性斜率几乎抵消且非线性更强，增强波纹）：\n  - $A_i = 0.45$, $B_i = 5.1 \\times 10^{-4}$, $C_i = 0.15$, $D_i = 5 \\times 10^{-5}$,\n  - $A_e = 0.15$, $B_e = 5.0 \\times 10^{-4}$, $C_e = 0.05$, $D_e = 10^{-4}$,\n  - $g = 2.0$.\n\n数值细节：\n- 在解析表达式中使用弧度作为双曲函数的单位，并遵循标准数学定义；无需进行角度单位转换。\n- 程序必须为每个用例计算根 $E_r$，将其转换为伏特/米（V/m），并四舍五入到三位有效数字。\n\n最终输出规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result1,result2,result3]$）。每个 $result$ 都必须是最终的 $E_r$ 值，单位为 V/m，四舍五入到三位有效数字，并表示为浮点数。",
            "solution": "所提出的问题是有效的。它在科学上基于磁约束等离子体中的新经典输运原理，特别是解决了非轴对称几何中双极径向电场的计算问题。该问题是适定的，提供了一个明确定义的非线性方程、三个不同物理区所需的所有参数，以及对稳健数值求解器的明确要求。所提供的函数及其导数的解析形式在数学上是正确的。整个设置是自洽的、客观的，并要求将标准的数值分析技术应用于一个具有物理意义的场景。\n\n问题的核心是找到双极性条件的根，该条件规定在稳态下，穿过磁通面的总电荷通量必须为零。对于由单电荷离子和电子组成的等离子体，此条件表示为 $\\Gamma_i(E_r) - \\Gamma_e(E_r) = 0$，其中 $\\Gamma_s$ 是粒子种类 $s$ 的径向粒子通量，$E_r$ 是径向电场。\n\n粒子种类的通量由以下函数建模：\n$$\n\\Gamma_s(E_r) = A_s + B_s E_r + C_s \\tanh(D_s g E_r)\n$$\n在这里，$A_s$ 代表扩散通量分量，$B_s E_r$ 代表非共振漂移相关输运，而双曲正切项 $C_s \\tanh(D_s g E_r)$ 则模拟了非轴对称装置（例如，超级香蕉-平台区）在低碰撞率区中，共振粒子输运的特征性非线性行为。常数系数 $A_s$、$B_s$、$C_s$ 和 $D_s$ 是通过计算密集型的漂移-动理学模拟确定的，$g$ 是与磁场结构相关的几何因子。\n\n我们的任务是求解非线性方程 $f(E_r) = 0$，其中 $f(E_r)$ 是净电荷通量：\n$$\nf(E_r) \\equiv \\Gamma_i(E_r) - \\Gamma_e(E_r) = (A_i - A_e) + (B_i - B_e) E_r + C_i \\tanh(D_i g E_r) - C_e \\tanh(D_e g E_r)\n$$\n为了使用牛顿-拉弗森方案，我们需要 $f(E_r)$ 相对于 $E_r$ 的解析导数。使用链式法则和恒等式 $\\frac{d}{dx}\\tanh(x) = \\operatorname{sech}^2(x)$，我们得到：\n$$\nf'(E_r) = \\frac{df}{dE_r} = (B_i - B_e) + C_i D_i g\\, \\operatorname{sech}^2(D_i g E_r) - C_e D_e g\\, \\operatorname{sech}^2(D_e g E_r)\n$$\n将使用一种混合迭代方法来寻求数值解，从初始猜测值 $E_r^{(0)} = 0$ 开始。\n\n主要求解器是带回溯线搜索的阻尼牛顿法。第 $k$ 次迭代的标准牛顿-拉弗森更新步骤为：\n$$\nE_r^{(k+1)} = E_r^{(k)} - \\frac{f(E_r^{(k)})}{f'(E_r^{(k)})}\n$$\n这个更新步骤可能过于激进，导致超调解或发散。为增强稳健性，引入一个阻尼因子 $\\alpha \\in (0, 1]$：\n$$\nE_r^{(k+1)} = E_r^{(k)} - \\alpha \\frac{f(E_r^{(k)})}{f'(E_r^{(k)})}\n$$\n回溯算法在每一步确定一个合适的 $\\alpha$ 值。它从 $\\alpha=1$（完整的牛顿步长）开始，并检查新的候选解 $E_r^{(k+1)}$ 是否减小了残差的绝对值，即 $|f(E_r^{(k+1)})|  |f(E_r^{(k)})|$。如果不满足此条件，则相继减小 $\\alpha$（例如，减半）并测试新的候选解，直到满足条件或 $\\alpha$ 低于最小阈值。\n\n如果导数 $f'(E_r)$ 为零或接近零，牛顿法可能会失败，这种情况可能发生在 $f(E_r)$ 的局部极值附近。这是新经典输运中的一个已知特征，其中可能存在多个根和局部极值。问题为此类情况指定了一个备用机制：松弛皮卡迭代。该迭代的形式如下：\n$$\nE_r^{(k+1)} = E_r^{(k)} - \\lambda_k f(E_r^{(k)})\n$$\n松弛参数 $\\lambda_k$ 是使用局部信息自适应选择的。一个将此方法与牛顿方案联系起来的有效选择是，通过使用导数来近似理想步长：$\\lambda_k \\approx 1/f'(E_r^{(k)})$。为处理 $f'(E_r^{(k)})$ 很小的情况，我们对该表达式进行正则化，例如，设置 $\\lambda_k = 1 / (\\text{sign}(f'(E_r^{(k)})) \\max(|f'(E_r^{(k)})|, \\delta))$，其中 $\\delta$ 是一个小的正常数。然而，为了在备用场景中保持简单和稳健，可以采用一个更简单的自适应方案，其中在局部斜率的指导下，沿残差值的相反方向迈出一个小的、正则化的步长。所选的实现将使用牛顿法作为其主要工具，仅在牛顿更新失败时（由于导数接近零或回溯线搜索失败）才采用次要的、更简单的步骤。\n\n对于每个测试用例，总体算法流程如下：\n1.  初始化 $k=0$，$E_r^{(0)} = 0$。\n2.  对于 $k$ 从 $0$ 到最大值 $100$：\n    a.  计算残差 $f_k = f(E_r^{(k)})$。\n    b.  检查收敛性：如果 $|f_k|  10^{-9}$，则终止并返回 $E_r^{(k)}$。\n    c.  计算导数 $f'_k = f'(E_r^{(k)})$。\n    d.  尝试一个阻尼牛顿步。如果成功（即 $|f'(E_r^{(k)})|$ 不太小且回溯法找到了一个减小残差的步长），则更新 $E_r^{(k+1)}$ 并继续下一次迭代。\n    e.  如果牛顿步失败，则执行一个松弛皮卡步来生成 $E_r^{(k+1)}$。这确保迭代能够取得进展。\n3.  如果达到最大迭代次数仍未收敛，则报告失败。\n4.  最终收敛的 $E_r$ 值四舍五入到三位有效数字。\n\n这种混合策略将在函数表现良好区域牛顿法的快速二次收敛性与在遇到数值困难时基于梯度方法的更谨慎、稳健的行为相结合，为指定问题提供了一个可靠的求解器。",
            "answer": "[-31500.0,9800.0,-7500.0]"
        }
    ]
}