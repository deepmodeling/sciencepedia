{
    "hands_on_practices": [
        {
            "introduction": "Anomalous resistivity often arises when the ordered motion of charge carriers, such as a current, becomes unstable to the growth of plasma waves. This first exercise focuses on deriving the fundamental condition that triggers this process for ion-acoustic turbulence, a key mechanism in plasmas where electrons are much hotter than ions ($T_e \\gg T_i$). By establishing the critical threshold relating electron drift speed to thermal motion, you will solidify your understanding of how macroscopic parameters can drive microscopic instability .",
            "id": "3951143",
            "problem": "A uniform, quasi-neutral deuterium plasma with singly charged ions is threaded by a uniform current density carried entirely by electrons drifting relative to stationary ions. Let the electron number density be $n_{e}$, the electron charge magnitude be $e$, and the current density magnitude be $|J|$. Define the electron drift speed as $v_{d} = |J|/(n_{e} e)$. The electron temperature is $T_{e}$ and the ion temperature is $T_{i}$, with $T_{e} \\gg T_{i}$. The electron thermal speed is defined as $v_{te} = \\sqrt{2 T_{e}/m_{e}}$, where $m_{e}$ is the electron mass, and temperatures are expressed in energy units so that $T_{e}$ and $T_{i}$ have the same units as energies.\n\nIn computational models of fusion plasmas, anomalous resistivity due to microinstabilities is often invoked when a streaming instability driven by $v_{d}$ is able to grow despite Landau damping and produce an effective electron scattering rate that competes with or exceeds the classical electron-ion collision frequency that underpins the Spitzer resistivity. Assume the following physically motivated and widely used criteria and approximations:\n\n- The onset of significant anomalous resistivity occurs when the electron drift exceeds the phase speed of the fastest growing electrostatic mode available under the stated conditions, so that wave growth and consequent wave-particle scattering can proceed on timescales shorter than classical electron-ion momentum exchange. Under $T_{e} \\gg T_{i}$ and singly charged ions, the dominant low-threshold electrostatic mode is the ion-acoustic wave, whose phase speed is well approximated by the ion-acoustic speed $c_{s}$.\n- For $T_{e} \\gg T_{i}$, the ion-acoustic speed satisfies $c_{s} \\approx \\sqrt{T_{e}/m_{i}}$, where $m_{i}$ is the ion mass and quasineutrality with Boltzmann electrons justifies this expression.\n- The electron thermal speed is $v_{te} = \\sqrt{2 T_{e}/m_{e}}$.\n\nStarting from these bases, derive a criterion written as a threshold on the dimensionless drift-to-thermal ratio $R \\equiv v_{d}/v_{te}$ for when anomalous resistivity becomes significant compared to Spitzer resistivity. Express your result as an order-of-magnitude threshold $R_{\\mathrm{th}}$ expressed entirely in terms of fundamental constants and the ion-to-electron mass ratio for deuterium.\n\nTake deuterium ions with $m_{i} = 2 m_{p}$, where $m_{p}/m_{e} = 1836$.\n\nProvide your final answer as the numerical value of $R_{\\mathrm{th}}$ rounded to two significant figures. The answer is dimensionless; do not include units.",
            "solution": "The problem asks for the derivation of a threshold for the dimensionless drift-to-thermal ratio, $R \\equiv v_{d}/v_{te}$, above which anomalous resistivity due to the ion-acoustic instability becomes significant.\n\nThe premises for the derivation are provided in the problem statement.\nThe electron drift speed is $v_{d}$.\nThe electron thermal speed is defined as $v_{te} = \\sqrt{2 T_{e}/m_{e}}$, where $T_{e}$ is the electron temperature in energy units and $m_{e}$ is the electron mass.\nThe condition for the onset of significant anomalous resistivity is that the electron drift speed $v_{d}$ exceeds the phase speed of the fastest growing electrostatic mode, which is the ion-acoustic wave.\nThe phase speed of the ion-acoustic wave is approximated by the ion-acoustic speed, $c_{s}$.\nFor the given condition of $T_{e} \\gg T_{i}$ (electron temperature much greater than ion temperature), the ion-acoustic speed is given by $c_{s} \\approx \\sqrt{T_{e}/m_{i}}$, where $m_{i}$ is the ion mass.\n\nThe threshold for instability, and thus for the onset of anomalous resistivity, is met when the electron drift speed is equal to the ion-acoustic speed. We denote the drift speed at this threshold as $(v_{d})_{\\mathrm{th}}$.\n$$\n(v_{d})_{\\mathrm{th}} = c_{s}\n$$\nThe problem asks for the threshold value of the ratio $R = v_{d}/v_{te}$. Let's define this threshold ratio as $R_{\\mathrm{th}}$.\n$$\nR_{\\mathrm{th}} = \\frac{(v_{d})_{\\mathrm{th}}}{v_{te}}\n$$\nSubstituting the threshold condition $(v_{d})_{\\mathrm{th}} = c_{s}$ into this definition, we get:\n$$\nR_{\\mathrm{th}} = \\frac{c_{s}}{v_{te}}\n$$\nNow, we substitute the given expressions for $c_{s}$ and $v_{te}$:\n$$\nc_{s} = \\sqrt{\\frac{T_{e}}{m_{i}}} \\quad \\text{and} \\quad v_{te} = \\sqrt{\\frac{2 T_{e}}{m_{e}}}\n$$\nPlugging these into the expression for $R_{\\mathrm{th}}$ yields:\n$$\nR_{\\mathrm{th}} = \\frac{\\sqrt{\\frac{T_{e}}{m_{i}}}}{\\sqrt{\\frac{2 T_{e}}{m_{e}}}}\n$$\nWe can combine the terms under a single square root:\n$$\nR_{\\mathrm{th}} = \\sqrt{\\left(\\frac{T_{e}}{m_{i}}\\right) \\left(\\frac{m_{e}}{2 T_{e}}\\right)}\n$$\nThe electron temperature $T_{e}$ cancels out from the numerator and denominator, which is expected as the final result should depend only on mass ratios and fundamental constants.\n$$\nR_{\\mathrm{th}} = \\sqrt{\\frac{m_{e}}{2 m_{i}}}\n$$\nThis is the general symbolic expression for the threshold ratio. The problem specifies a deuterium plasma. For deuterium, the ion mass $m_{i}$ is approximately equal to the mass of one proton and one neutron, which is roughly twice the proton mass, $m_{p}$. The problem provides this relation as $m_{i} = 2 m_{p}$.\nSubstituting this into our expression for $R_{\\mathrm{th}}$:\n$$\nR_{\\mathrm{th}} = \\sqrt{\\frac{m_{e}}{2(2 m_{p})}} = \\sqrt{\\frac{m_{e}}{4 m_{p}}}\n$$\nThis can be simplified to:\n$$\nR_{\\mathrm{th}} = \\frac{1}{\\sqrt{4}} \\sqrt{\\frac{m_{e}}{m_{p}}} = \\frac{1}{2} \\sqrt{\\frac{m_{e}}{m_{p}}}\n$$\nThe problem provides the proton-to-electron mass ratio:\n$$\n\\frac{m_{p}}{m_{e}} = 1836\n$$\nTherefore, the electron-to-proton mass ratio is the reciprocal:\n$$\n\\frac{m_{e}}{m_{p}} = \\frac{1}{1836}\n$$\nSubstituting this numerical value into our final symbolic expression for $R_{\\mathrm{th}}$:\n$$\nR_{\\mathrm{th}} = \\frac{1}{2} \\sqrt{\\frac{1}{1836}} = \\frac{1}{2 \\sqrt{1836}}\n$$\nWe now calculate the numerical value.\n$$\n\\sqrt{1836} \\approx 42.84857\n$$\nSo,\n$$\nR_{\\mathrm{th}} \\approx \\frac{1}{2 \\times 42.84857} = \\frac{1}{85.69714} \\approx 0.0116689\n$$\nThe problem asks for the final answer to be rounded to two significant figures. The first significant figure is the $1$ in the hundredths place. The second is the $1$ in the thousandths place. The third digit is a $6$, so we round up.\n$$\nR_{\\mathrm{th}} \\approx 0.012\n$$\nThis dimensionless value represents the threshold for the electron drift speed, normalized to the electron thermal speed, for the onset of significant anomalous resistivity in a deuterium plasma under the specified conditions.",
            "answer": "$$\n\\boxed{0.012}\n$$"
        },
        {
            "introduction": "Once an instability is triggered, it grows and saturates, leading to a new turbulent state with enhanced transport. This practice guides you through the process of creating a computational model to quantify the anomalous resistivity that arises from saturated ion-acoustic turbulence . You will implement a physically-motivated closure model, a common and powerful technique for translating complex nonlinear physics into a predictive algorithm for use in larger-scale simulations.",
            "id": "3951130",
            "problem": "Design a self-contained computational experiment to estimate the anomalous resistivity produced when a controlled parallel electron drift excites ion-acoustic turbulence in a quasi-neutral, unmagnetized, one-dimensional plasma. The goal is to quantify the anomalous resistivity by the diagnostic ratio $E_{\\parallel}/J_{\\parallel}$ under conditions where turbulence supplies an effective electron-ion momentum exchange. The experiment is based on fundamental two-fluid plasma physics and a quasi-linear mixing-length closure for turbulence saturation. The program must implement the following steps and assumptions, and produce numerical values in the specified unit.\n\nFundamental base and assumptions:\n- Begin with the parallel component of the electron momentum equation (one-dimensional, parallel to the drift) under the two-fluid model:\n$$m_e n_e \\left(\\frac{\\partial u_e}{\\partial t} + u_e \\frac{\\partial u_e}{\\partial x}\\right) = -n_e e E_{\\parallel} - \\frac{\\partial p_e}{\\partial x} - m_e n_e \\nu_m (u_e - u_i) - R_{\\text{turb}},$$\nwhere $m_e$ is the electron mass, $n_e$ is the electron number density, $u_e$ and $u_i$ are the parallel electron and ion fluid velocities, $e$ is the elementary charge, $E_{\\parallel}$ is the parallel electric field, $p_e$ is the electron pressure, $\\nu_m$ is a classical effective collision rate (which will be neglected here), and $R_{\\text{turb}}$ is the turbulent momentum exchange term.\n- Under steady, spatially uniform conditions appropriate for a homogeneous driven drift experiment, neglect electron inertia and pressure-gradient terms and set $\\nu_m \\approx 0$, yielding the generalized Ohm’s law dominated by turbulent drag:\n$$E_{\\parallel} \\approx \\frac{m_e}{e} \\nu_a (u_e - u_i),$$\nwhere $\\nu_a$ is the anomalous electron-ion momentum exchange frequency produced by ion-acoustic turbulence.\n- Use the definition of current density $J_{\\parallel} = n_e e (u_i - u_e)$ to obtain an experimentally measurable resistivity via\n$$\\eta_{\\mathrm{anom}} \\equiv \\frac{E_{\\parallel}}{J_{\\parallel}} = \\frac{m_e \\nu_a}{n_e e^2}.$$\n\nIon-acoustic turbulence excitation and closure:\n- For ion-acoustic waves with isothermal electrons and ions in the quasi-neutral regime ($k \\lambda_{De} \\ll 1$), the dispersion relation reduces to\n$$\\omega \\approx k c_s,$$\nwhere $k$ is the wavenumber, $\\omega$ is the angular frequency, $c_s$ is the ion-acoustic speed given by\n$$c_s = \\sqrt{\\frac{T_e + T_i}{m_i}},$$\nwith $T_e$ the electron temperature, $T_i$ the ion temperature (both in energy units), and $m_i$ the ion mass. Assume a controlled electron drift $u_d$ along the wavevector. Linear two-fluid analysis yields a current-driven instability when $u_d > c_s$ with a representative linear growth rate scaling\n$$\\gamma_{\\mathrm{lin}} \\approx k c_s \\left(\\frac{u_d}{c_s} - 1\\right) \\quad \\text{for} \\quad u_d > c_s,$$\nand $\\gamma_{\\mathrm{lin}} \\le 0$ otherwise (stable).\n- Adopt a quasi-linear mixing-length saturation closure in which the nonlinear decorrelation rate $\\gamma_{\\mathrm{nl}}$ is proportional to the dimensionless turbulent energy fraction. A commonly used well-tested scaling in fusion turbulence modeling is\n$$\\nu_a \\approx \\omega_{pe} \\frac{W}{n_e T_e},$$\nwhere $\\nu_a$ is the anomalous momentum exchange frequency, $\\omega_{pe} = \\sqrt{\\frac{n_e e^2}{\\varepsilon_0 m_e}}$ is the electron plasma frequency, $W$ is the ion-acoustic turbulent energy density, and $\\varepsilon_0$ is the vacuum permittivity. At steady state, balance linear growth with nonlinear decorrelation, which yields $\\gamma_{\\mathrm{lin}} \\approx \\nu_a$ up to an order-unity constant. For this experiment, set the closure constant to unity to reflect a conservative mixing-length estimate, so that\n$$\\nu_a = \\max\\left(0,\\, \\gamma_{\\mathrm{lin}}\\right).$$\n\nComputational model and diagnostics:\n- Select a representative wavenumber in the quasi-neutral regime using a fractional factor $\\alpha_k$ of the electron Debye length $\\lambda_{De}$:\n$$\\lambda_{De} = \\sqrt{\\frac{\\varepsilon_0 T_e}{n_e e^2}}, \\quad k = \\frac{\\alpha_k}{\\lambda_{De}}, \\quad \\text{with } \\alpha_k = 0.1.$$\n- Determine the ion-acoustic speed $c_s$ from $T_e$ and $T_i$ via the formula above.\n- Define the controlled electron drift via the dimensionless ratio $u_d/c_s$. Compute the linear growth rate\n$$\\gamma_{\\mathrm{lin}} = \\begin{cases}\nk c_s \\left(\\frac{u_d}{c_s} - 1\\right), & \\frac{u_d}{c_s} > 1,\\\\\n0, & \\frac{u_d}{c_s} \\le 1,\n\\end{cases}$$\nand set $\\nu_a = \\gamma_{\\mathrm{lin}}$.\n- Compute the anomalous resistivity\n$$\\eta_{\\mathrm{anom}} = \\frac{m_e \\nu_a}{n_e e^2}.$$\n- The diagnostic $E_{\\parallel}/J_{\\parallel}$ equals $\\eta_{\\mathrm{anom}}$ under the adopted assumptions, so reporting $\\eta_{\\mathrm{anom}}$ in $\\Omega \\cdot \\mathrm{m}$ provides the required measurement.\n\nUnits and constants:\n- Use International System of Units (SI) throughout. Electron and ion temperatures $T_e$ and $T_i$ are provided in electron-volts (eV) and must be converted to joules using $1\\,\\mathrm{eV} = e \\,\\mathrm{J}$ with $e$ the elementary charge. Express the final anomalous resistivity in $\\Omega \\cdot \\mathrm{m}$ as floats.\n- Use $e$, $m_e$, and $\\varepsilon_0$ as physical constants.\n\nTest suite:\nImplement the program to compute $\\eta_{\\mathrm{anom}}$ for the following five test cases, each specified by\n$$\\left(n_e,\\, T_e,\\, T_i,\\, m_i,\\, \\frac{u_d}{c_s}\\right),$$\nwhere $n_e$ is in $\\mathrm{m}^{-3}$, $T_e$ and $T_i$ are in $\\mathrm{eV}$, $m_i$ is in $\\mathrm{kg}$, and $u_d/c_s$ is dimensionless.\n- Case 1 (stable subcritical drift, hydrogen):\n  - $n_e = 1.0\\times 10^{19}$, $T_e = 100$, $T_i = 1$, $m_i = 1.6726219\\times 10^{-27}$, $u_d/c_s = 0.5$.\n- Case 2 (slightly supercritical drift, hydrogen):\n  - $n_e = 1.0\\times 10^{19}$, $T_e = 100$, $T_i = 1$, $m_i = 1.6726219\\times 10^{-27}$, $u_d/c_s = 1.1$.\n- Case 3 (supercritical drift, deuterium):\n  - $n_e = 5.0\\times 10^{18}$, $T_e = 50$, $T_i = 5$, $m_i = 3.3452438\\times 10^{-27}$, $u_d/c_s = 2.0$.\n- Case 4 (marginal drift, high density, hydrogen):\n  - $n_e = 1.0\\times 10^{20}$, $T_e = 200$, $T_i = 10$, $m_i = 1.6726219\\times 10^{-27}$, $u_d/c_s = 1.0$.\n- Case 5 (moderately supercritical drift, deuterium, comparable ion temperature):\n  - $n_e = 2.0\\times 10^{19}$, $T_e = 30$, $T_i = 30$, $m_i = 3.3452438\\times 10^{-27}$, $u_d/c_s = 1.5$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the five computed anomalous resistivities $\\eta_{\\mathrm{anom}}$ in $\\Omega \\cdot \\mathrm{m}$, formatted as a comma-separated list enclosed in square brackets, with each float in scientific notation with six significant digits (for example, $\\left[1.234567\\mathrm{e}{-4},2.345678\\mathrm{e}{-5},\\dots\\right]$).",
            "solution": "The objective is to estimate the anomalous resistivity $\\eta_{\\mathrm{anom}}$ generated by ion-acoustic turbulence driven by a controlled electron drift and to present it as the diagnostic ratio $E_{\\parallel}/J_{\\parallel}$. The construction proceeds from first principles to a computable closure.\n\n1. Foundational equations and reduction. Begin with the parallel electron momentum equation\n$$m_e n_e \\left(\\frac{\\partial u_e}{\\partial t} + u_e \\frac{\\partial u_e}{\\partial x}\\right) = -n_e e E_{\\parallel} - \\frac{\\partial p_e}{\\partial x} - m_e n_e \\nu_m (u_e - u_i) - R_{\\text{turb}}.$$\nIn a driven, homogeneous, steady experiment along the parallel direction, we neglect the electron inertia and pressure gradient ($\\partial / \\partial t \\to 0$, $\\partial / \\partial x \\to 0$), and classical collisions ($\\nu_m \\approx 0$) relative to turbulent scattering, yielding\n$$E_{\\parallel} \\approx \\frac{m_e}{e}\\, \\nu_a (u_e - u_i).$$\nUsing the definition of current $J_{\\parallel} = n_e e (u_i - u_e)$, we obtain the measurable anomalous resistivity\n$$\\eta_{\\mathrm{anom}} \\equiv \\frac{E_{\\parallel}}{J_{\\parallel}} = \\frac{m_e \\nu_a}{n_e e^2}.$$\nThis shows that the diagnostic ratio $E_{\\parallel}/J_{\\parallel}$ directly yields $\\eta_{\\mathrm{anom}}$ if $\\nu_a$ is known.\n\n2. Ion-acoustic wave physics and instability. For ion-acoustic waves, in the quasi-neutral, one-dimensional, isothermal-electron and isothermal-ion limit, the dispersion relation is\n$$\\omega \\approx k c_s, \\quad c_s = \\sqrt{\\frac{T_e + T_i}{m_i}}.$$\nA linear two-fluid analysis with a net electron drift $u_d$ along the propagation direction shows a current-driven instability if the drift exceeds the wave phase speed $c_s$. A representative linear growth rate near threshold scales as\n$$\\gamma_{\\mathrm{lin}} \\approx k c_s \\left(\\frac{u_d}{c_s} - 1\\right), \\quad \\text{for } \\frac{u_d}{c_s} > 1,$$\nand $\\gamma_{\\mathrm{lin}} \\le 0$ when $\\frac{u_d}{c_s} \\le 1$. This scaling captures the proportionality to wavenumber $k$, the characteristic frequency $k c_s$, and the supercriticality $\\left(\\frac{u_d}{c_s} - 1\\right)$.\n\n3. Turbulence saturation and anomalous scattering. To close the model, adopt a quasi-linear mixing-length saturation estimate: the nonlinear decorrelation rate $\\gamma_{\\mathrm{nl}}$ is proportional to the dimensionless turbulent energy fraction, giving an anomalous scattering frequency\n$$\\nu_a \\approx \\omega_{pe} \\frac{W}{n_e T_e}, \\quad \\omega_{pe} = \\sqrt{\\frac{n_e e^2}{\\varepsilon_0 m_e}}.$$\nAt steady state, set $\\gamma_{\\mathrm{lin}} \\approx \\gamma_{\\mathrm{nl}} \\approx \\nu_a$ up to an order-unity constant. For this computational experiment, set that constant to unity to reflect a conservative mixing-length closure, resulting in\n$$\\nu_a = \\max\\left(0,\\, \\gamma_{\\mathrm{lin}}\\right).$$\n\n4. Wavenumber selection. To remain in the quasi-neutral regime of ion-acoustic waves, choose a representative wavenumber scale as a small fraction of the inverse Debye length:\n$$\\lambda_{De} = \\sqrt{\\frac{\\varepsilon_0 T_e}{n_e e^2}}, \\quad k = \\frac{\\alpha_k}{\\lambda_{De}}, \\quad \\alpha_k = 0.1.$$\nThis sets $k \\lambda_{De} = \\alpha_k = 0.1 \\ll 1$.\n\n5. Algorithm to compute $\\eta_{\\mathrm{anom}}$:\n- Convert $T_e$ and $T_i$ from $\\mathrm{eV}$ to $\\mathrm{J}$ using $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$.\n- Compute $c_s = \\sqrt{\\frac{T_e + T_i}{m_i}}$.\n- Compute $\\lambda_{De} = \\sqrt{\\frac{\\varepsilon_0 T_e}{n_e e^2}}$ and set $k = \\frac{0.1}{\\lambda_{De}}$.\n- Given the dimensionless drift ratio $\\frac{u_d}{c_s}$, evaluate\n$$\\gamma_{\\mathrm{lin}} = \\begin{cases}\nk c_s \\left(\\frac{u_d}{c_s} - 1\\right), & \\frac{u_d}{c_s} > 1,\\\\\n0, & \\frac{u_d}{c_s} \\le 1.\n\\end{cases}$$\n- Set $\\nu_a = \\gamma_{\\mathrm{lin}}$.\n- Compute\n$$\\eta_{\\mathrm{anom}} = \\frac{m_e \\nu_a}{n_e e^2}.$$\n\n6. Edge cases and diagnostics:\n- If $\\frac{u_d}{c_s} \\le 1$, then $\\gamma_{\\mathrm{lin}} = 0$ and $\\eta_{\\mathrm{anom}} = 0$, reflecting a stable regime with no turbulence-driven resistivity in this closure.\n- The diagnostic ratio $E_{\\parallel}/J_{\\parallel}$ equals $\\eta_{\\mathrm{anom}}$ under the model assumptions, so reporting $\\eta_{\\mathrm{anom}}$ suffices to specify the measurement in $\\Omega \\cdot \\mathrm{m}$.\n\n7. Implementation details and output:\n- Use the specified five test cases. Compute a float for each $\\eta_{\\mathrm{anom}}$ in $\\Omega \\cdot \\mathrm{m}$.\n- Produce a single output line containing the five results formatted as a comma-separated list enclosed in square brackets, with each float in scientific notation with six significant digits.\n\nThis design integrates fundamental two-fluid plasma physics with a quasi-linear turbulence closure suitable for computational fusion science and engineering, yielding a reproducible diagnostic estimate of anomalous resistivity driven by electron-drift-induced ion-acoustic turbulence.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\ne_charge = 1.602176634e-19       # Coulomb\nm_e = 9.1093837015e-31           # kg\nepsilon_0 = 8.8541878128e-12     # F/m\nk_B = 1.380649e-23               # J/K, but we will use eV->J via e_charge directly\n\ndef eta_anom(n_e, T_e_eV, T_i_eV, m_i, ud_over_cs, alpha_k=0.1):\n    \"\"\"\n    Compute anomalous resistivity eta_anom (Ohm·m) for drift-driven ion-acoustic turbulence.\n    Parameters:\n        n_e        : electron number density [m^-3]\n        T_e_eV     : electron temperature [eV]\n        T_i_eV     : ion temperature [eV]\n        m_i        : ion mass [kg]\n        ud_over_cs : dimensionless ratio u_d / c_s\n        alpha_k    : dimensionless k*lambda_De (default 0.1)\n    Returns:\n        eta_anom   : anomalous resistivity [Ohm·m]\n    \"\"\"\n    # Convert temperatures from eV to Joules\n    T_e_J = T_e_eV * e_charge\n    T_i_J = T_i_eV * e_charge\n\n    # Ion-acoustic speed c_s (isothermal electrons and ions)\n    # c_s = sqrt((k_B T_e + k_B T_i)/m_i); with T in Joules already\n    c_s = np.sqrt((T_e_J + T_i_J) / m_i)\n\n    # Electron Debye length\n    lambda_De = np.sqrt(epsilon_0 * T_e_J / (n_e * e_charge**2))\n\n    # Representative wavenumber in quasi-neutral regime\n    k = alpha_k / lambda_De\n\n    # Linear growth rate for current-driven ion-acoustic instability\n    if ud_over_cs > 1.0:\n        gamma_lin = k * c_s * (ud_over_cs - 1.0)\n    else:\n        gamma_lin = 0.0\n\n    # Anomalous collision frequency via mixing-length closure (nu_a = gamma_lin)\n    nu_a = gamma_lin\n\n    # Anomalous resistivity eta_anom = m_e * nu_a / (n_e * e^2)\n    denom = n_e * e_charge**2\n    eta = (m_e * nu_a) / denom\n    return eta\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (n_e [m^-3], T_e [eV], T_i [eV], m_i [kg], u_d/c_s [dimensionless])\n    proton_mass = 1.6726219e-27\n    deuterium_mass = 3.3452438e-27\n\n    test_cases = [\n        (1.0e19, 100.0, 1.0,   proton_mass,    0.5),  # Case 1: subcritical drift (stable)\n        (1.0e19, 100.0, 1.0,   proton_mass,    1.1),  # Case 2: slightly supercritical\n        (5.0e18, 50.0,  5.0,   deuterium_mass, 2.0),  # Case 3: supercritical, deuterium\n        (1.0e20, 200.0, 10.0,  proton_mass,    1.0),  # Case 4: marginal drift\n        (2.0e19, 30.0,  30.0,  deuterium_mass, 1.5),  # Case 5: moderately supercritical, higher Ti\n    ]\n\n    results = []\n    for case in test_cases:\n        n_e, T_e_eV, T_i_eV, m_i, ud_over_cs = case\n        if m_i == 1.6726219e-27: # Ensure correct mass from problem\n            m_i = proton_mass\n        elif m_i == 3.3452438e-27:\n            m_i = deuterium_mass\n\n        eta = eta_anom(n_e, T_e_eV, T_i_eV, m_i, ud_over_cs)\n        results.append(eta)\n\n    # Format each result in scientific notation with six significant digits\n    formatted = \",\".join(f\"{val:.6e}\" for val in results)\n    # Final print statement in the exact required format.\n    print(f\"[{formatted}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In computational science, it is crucial to distinguish genuine physical phenomena from artifacts of the numerical methods used. This final exercise provides hands-on practice in this vital skill by designing a convergence study to separate physical anomalous resistivity from numerical dissipation . By analyzing how the measured resistivity changes with simulation parameters like grid resolution, you will learn a rigorous technique to validate simulation results and ensure your physical conclusions are robust.",
            "id": "3951176",
            "problem": "A computational fusion science and engineering study requires distinguishing physical anomalous resistivity from numerical dissipation in simulations of current-driven microinstabilities. Consider a simplified one-dimensional current channel aligned with the magnetic field where the parallel electric field is measured. Begin from the electron momentum equation and the generalized Ohm’s law, and design a numerical convergence study that separates the physical anomalous resistivity from numerical artifacts by varying grid resolution, particle number, and time step. Your program must implement and execute this study on the provided test suite and produce the specified output.\n\nUse the following fundamental base.\n\n- The electron momentum equation along the magnetic field direction is\n$$m_e n \\frac{d u_e}{dt} = -n e E_\\parallel - \\nabla_\\parallel p_e - m_e n \\nu_\\mathrm{eff} u_e,$$\nwhere $m_e$ is electron mass, $n$ is electron number density, $u_e$ is electron drift velocity parallel to the magnetic field, $e$ is the elementary charge, $E_\\parallel$ is the parallel electric field, $p_e$ is electron pressure, and $\\nu_\\mathrm{eff}$ is the effective collision frequency that may include microturbulence-induced scattering.\n\n- The generalized Ohm’s law along the magnetic field in a magnetized plasma reduces under appropriate ordering to\n$$E_\\parallel \\approx \\eta_\\mathrm{eff} j_\\parallel + \\frac{1}{n e} \\nabla_\\parallel p_e + \\text{inertial/finite-frequency terms},$$\nwhere $j_\\parallel$ is the parallel current density and $\\eta_\\mathrm{eff} = \\frac{m_e \\nu_\\mathrm{eff}}{n e^2}$ is the effective resistivity including anomalous contributions.\n\n- The observed effective resistivity, defined from measured fields and currents, is\n$$\\eta_\\mathrm{obs} = \\frac{E_\\parallel}{j_\\parallel}.$$\n\nTo separate the physical anomalous resistivity from numerical dissipation, you are to model how $\\eta_\\mathrm{obs}$ changes with three numerical controls in a Particle-In-Cell (PIC) Magnetohydrodynamics (MHD) style computation: grid spacing $\\Delta x$, time step $\\Delta t$, and number of simulation particles $N_p$. Empirically and by standard truncation analysis for second-order spatial discretization and first-order time integration with particle noise, leading-order numerical contributions scale as\n$$\\eta_\\mathrm{num}(\\Delta x, \\Delta t, N_p) \\sim \\alpha \\Delta x^2 + \\beta \\Delta t + \\gamma \\frac{1}{N_p},$$\nfor coefficients $\\alpha$, $\\beta$, $\\gamma$ that depend on the method. Assume that higher-order terms are negligible over the ranges considered. The physical anomalous resistivity $\\eta_\\mathrm{phys}$ is independent of $\\Delta x$, $\\Delta t$, and $N_p$ for sufficiently resolved simulations. Your goal is to estimate $\\eta_\\mathrm{phys}$ by extrapolating $\\eta_\\mathrm{obs}$ to the limit $\\Delta x \\to 0$, $\\Delta t \\to 0$, and $N_p \\to \\infty$.\n\nYour program must implement the following algorithmic tasks.\n\n1. For each group of experimental runs, compute $\\eta_\\mathrm{obs}$ from the provided data as $\\eta_\\mathrm{obs} = E_\\parallel / j_\\parallel$.\n\n2. Fit the linear model\n$$\\eta_\\mathrm{obs} \\approx \\eta_\\mathrm{phys} + \\alpha \\Delta x^2 + \\beta \\Delta t + \\gamma \\frac{1}{N_p}$$\nusing least squares across the runs in a group to estimate $\\eta_\\mathrm{phys}$ as the intercept.\n\n3. Demonstrate convergence by comparing the intercept estimated on a coarse subset of runs to the intercept estimated on a fine subset of runs. Use the coarse subset consisting of the first four runs and the fine subset consisting of the last four runs (indices counted from one). Define convergence to be achieved if the absolute difference between the two intercept estimates is less than a fixed tolerance $\\varepsilon$.\n\n4. Produce, for each group, a two-element result consisting of the estimated physical anomalous resistivity and a boolean indicating whether convergence is achieved.\n\nAll quantities are in dimensionless normalized units; no physical unit conversion is required.\n\nTest suite and data. Each experimental run provides $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel)$ in dimensionless normalized units. There are three groups (A, B, C) of six runs each, spanning a range of grid spacings, time steps, and particle counts. The current density level differs across groups to exercise cases with and without physical anomalous resistivity.\n\nGroup A (subcritical current; physical anomalous contribution expected to be negligible):\n- Run 1: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.2, 0.04, 500, 0.8, 0.0576)$\n- Run 2: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.04, 500, 0.8, 0.0456)$\n- Run 3: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 500, 0.8, 0.0328)$\n- Run 4: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 1000, 0.8, 0.0248)$\n- Run 5: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.02, 1000, 0.8, 0.0218)$\n- Run 6: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.01, 2000, 0.8, 0.0114)$\n\nGroup B (moderately supercritical current; physical anomalous contribution expected to be present):\n- Run 1: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.2, 0.04, 500, 1.4, 0.2128)$\n- Run 2: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.04, 500, 1.4, 0.1918)$\n- Run 3: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 500, 1.4, 0.1694)$\n- Run 4: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 1000, 1.4, 0.1554)$\n- Run 5: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.02, 1000, 1.4, 0.15015)$\n- Run 6: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.01, 2000, 1.4, 0.13195)$\n\nGroup C (strongly supercritical current; larger physical anomalous contribution expected):\n- Run 1: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.2, 0.04, 500, 2.0, 0.544)$\n- Run 2: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.04, 500, 2.0, 0.514)$\n- Run 3: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 500, 2.0, 0.482)$\n- Run 4: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 1000, 2.0, 0.462)$\n- Run 5: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.02, 1000, 2.0, 0.4545)$\n- Run 6: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.01, 2000, 2.0, 0.4285)$\n\nAnswer specification and final output format:\n- The tolerance for the convergence check is $\\varepsilon = 10^{-9}$ in dimensionless normalized units.\n- Your program should produce a single line of output containing the results for the three groups as a comma-separated list of three two-element lists in the form\n$$[\\,[\\eta_A, \\text{flag}_A],\\,[\\eta_B, \\text{flag}_B],\\,[\\eta_C, \\text{flag}_C]\\,],$$\nwhere $\\eta_A$, $\\eta_B$, and $\\eta_C$ are floating-point numbers representing the estimated physical anomalous resistivity for Groups A, B, and C, respectively, and $\\text{flag}_A$, $\\text{flag}_B$, and $\\text{flag}_C$ are booleans indicating whether convergence is achieved for each group. All outputs must be dimensionless numbers as provided, with booleans in the programming language’s standard literal format.",
            "solution": "The objective is to isolate the physical anomalous resistivity $\\eta_{\\mathrm{phys}}$ from numerical dissipation artifacts by performing a systematic convergence study. The methodology relies on a multivariable linear regression analysis based on the provided scaling model for numerical errors.\n\nFor each simulation run $i$ in a given group, we first compute the total observed resistivity $\\eta_{\\mathrm{obs},i}$ from the provided parallel electric field $E_{\\parallel,i}$ and parallel current density $j_{\\parallel,i}$:\n$$ \\eta_{\\mathrm{obs},i} = \\frac{E_{\\parallel,i}}{j_{\\parallel,i}} $$\nThe core assumption is that this observed value is the sum of the true physical resistivity $\\eta_{\\mathrm{phys}}$ (which is constant for a given physical scenario) and a numerical contribution $\\eta_{\\mathrm{num}}$ that depends on the simulation parameters: the grid spacing $\\Delta x_i$, the time step $\\Delta t_i$, and the number of particles $N_{p,i}$. The problem specifies the leading-order scaling of this numerical error:\n$$ \\eta_{\\mathrm{obs},i} \\approx \\eta_{\\mathrm{phys}} + \\alpha (\\Delta x_i)^2 + \\beta (\\Delta t_i) + \\gamma \\frac{1}{N_{p,i}} $$\nHere, $\\eta_{\\mathrm{phys}}$, $\\alpha$, $\\beta$, and $\\gamma$ are unknown coefficients to be determined. This equation represents a linear model where $\\eta_{\\mathrm{phys}}$ is the intercept, corresponding to the ideal limit where numerical errors vanish ($\\Delta x \\to 0$, $\\Delta t \\to 0$, and $N_p \\to \\infty$).\n\nTo find these coefficients for a group of $M$ runs, we can set up a system of linear equations in matrix form, $\\mathbf{y} \\approx \\mathbf{X}\\mathbf{c}$:\n- $\\mathbf{y}$ is the $M \\times 1$ column vector of observed resistivities, with elements $y_i = \\eta_{\\mathrm{obs},i}$.\n- $\\mathbf{X}$ is the $M \\times 4$ design matrix. The $i$-th row corresponds to the $i$-th run and is given by $[1, (\\Delta x_i)^2, \\Delta t_i, 1/N_{p,i}]$. The first column of ones corresponds to the intercept coefficient, $\\eta_{\\mathrm{phys}}$.\n- $\\mathbf{c}$ is the $4 \\times 1$ column vector of the unknown coefficients we wish to find: $\\mathbf{c} = [\\eta_{\\mathrm{phys}}, \\alpha, \\beta, \\gamma]^T$.\n\nThe best-fit solution for the coefficient vector $\\mathbf{c}$ is found using the method of ordinary least squares, which minimizes the sum of the squared differences between the observed $\\eta_{\\mathrm{obs},i}$ and the values predicted by the model. The solution is given by the normal equations:\n$$ \\mathbf{c} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y} $$\nThe first element of the resulting vector $\\mathbf{c}$ is our best estimate for the physical anomalous resistivity, $\\eta_{\\mathrm{phys}}$.\n\nThe full procedure for each group of runs (A, B, and C) is as follows:\n1.  **Estimate Physical Resistivity**: We construct the vector $\\mathbf{y}$ and matrix $\\mathbf{X}$ using all six runs in the group. We then solve for the coefficient vector $\\mathbf{c}_{\\mathrm{all}}$ using least squares. The first element, $(\\mathbf{c}_{\\mathrm{all}})_0$, is the primary estimate of $\\eta_{\\mathrm{phys}}$ for that group, which will be the final reported value.\n\n2.  **Assess Convergence**: To ensure the simulation results are in the asymptotic regime where our error model is valid, we perform a convergence test. We compute two separate estimates for $\\eta_{\\mathrm{phys}}$:\n    a.  **Coarse Estimate**: A least-squares fit is performed using only the first four runs (indices 1-4), which represent coarser simulation parameters. This yields an estimate $\\eta_{\\mathrm{phys, coarse}}$.\n    b.  **Fine Estimate**: A second fit is performed using only the last four runs (indices 3-6), representing finer simulation parameters. This yields an estimate $\\eta_{\\mathrm{phys, fine}}$.\n    \n    Convergence is considered achieved if these two estimates are consistent with each other within a given tolerance, $\\varepsilon = 10^{-9}$. That is, if:\n    $$ |\\eta_{\\mathrm{phys, coarse}} - \\eta_{\\mathrm{phys, fine}}|  \\varepsilon $$\n    A boolean flag is set to `True` if this condition is met and `False` otherwise.\n\n3.  **Report Results**: For each group, we report the primary estimate of $\\eta_{\\mathrm{phys}}$ obtained from all six runs and the boolean convergence flag. This process is repeated for all three data groups.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the anomalous resistivity problem by performing a convergence study\n    based on linear least squares fitting.\n    \"\"\"\n\n    # Test suite data: (Δx, Δt, Np, j_parallel, E_parallel) for each run.\n    test_suite = {\n        'A': [\n            (0.2, 0.04, 500, 0.8, 0.0576),\n            (0.1, 0.04, 500, 0.8, 0.0456),\n            (0.1, 0.02, 500, 0.8, 0.0328),\n            (0.1, 0.02, 1000, 0.8, 0.0248),\n            (0.05, 0.02, 1000, 0.8, 0.0218),\n            (0.05, 0.01, 2000, 0.8, 0.0114)\n        ],\n        'B': [\n            (0.2, 0.04, 500, 1.4, 0.2128),\n            (0.1, 0.04, 500, 1.4, 0.1918),\n            (0.1, 0.02, 500, 1.4, 0.1694),\n            (0.1, 0.02, 1000, 1.4, 0.1554),\n            (0.05, 0.02, 1000, 1.4, 0.15015),\n            (0.05, 0.01, 2000, 1.4, 0.13195)\n        ],\n        'C': [\n            (0.2, 0.04, 500, 2.0, 0.544),\n            (0.1, 0.04, 500, 2.0, 0.514),\n            (0.1, 0.02, 500, 2.0, 0.482),\n            (0.1, 0.02, 1000, 2.0, 0.462),\n            (0.05, 0.02, 1000, 2.0, 0.4545),\n            (0.05, 0.01, 2000, 2.0, 0.4285)\n        ]\n    }\n\n    convergence_tolerance = 1e-9\n    \n    final_results = []\n\n    def fit_resistivity(runs_data):\n        \"\"\"\n        Performs a least-squares fit to estimate physical resistivity.\n\n        Args:\n            runs_data: A list of tuples, where each tuple contains\n                       (Δx, Δt, Np, j_parallel, E_parallel).\n\n        Returns:\n            The estimated physical resistivity (the intercept term).\n        \"\"\"\n        num_runs = len(runs_data)\n        \n        # Design matrix X and observation vector y\n        X = np.zeros((num_runs, 4))\n        y = np.zeros(num_runs)\n\n        for i, run in enumerate(runs_data):\n            dx, dt, Np, j_para, E_para = run\n            \n            # Observed resistivity\n            eta_obs = E_para / j_para\n            y[i] = eta_obs\n            \n            # Populate the design matrix: [1, dx^2, dt, 1/Np]\n            X[i, 0] = 1.0  # Intercept term for eta_phys\n            X[i, 1] = dx**2\n            X[i, 2] = dt\n            X[i, 3] = 1.0 / Np\n\n        # Solve the linear system y = Xc for c using least squares.\n        # c = [eta_phys, alpha, beta, gamma]\n        coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        eta_phys_estimate = coeffs[0]\n        return eta_phys_estimate\n\n    # Process each group of experimental runs\n    for group_key in sorted(test_suite.keys()):\n        group_data = test_suite[group_key]\n        \n        # 1. Estimate eta_phys using all runs in the group for the final reported value.\n        eta_phys_all = fit_resistivity(group_data)\n\n        # 2. Define coarse and fine subsets for convergence check.\n        # Coarse subset: runs 1-4 (Python indices 0-3)\n        coarse_subset = group_data[0:4]\n        # Fine subset: runs 3-6 (Python indices 2-5)\n        fine_subset = group_data[2:6]\n\n        # 3. Estimate eta_phys for each subset.\n        eta_phys_coarse = fit_resistivity(coarse_subset)\n        eta_phys_fine = fit_resistivity(fine_subset)\n\n        # 4. Perform the convergence check.\n        is_converged = abs(eta_phys_coarse - eta_phys_fine)  convergence_tolerance\n        \n        # 5. Store the final result for the group.\n        final_results.append([eta_phys_all, is_converged])\n\n    # The final print must match the specified single-line format.\n    # The standard string representation of a list of lists in Python matches\n    # the structure specified in the problem description.\n    print(final_results)\n\nsolve()\n```"
        }
    ]
}