{
    "hands_on_practices": [
        {
            "introduction": "Before modeling anomalous resistivity, we must first understand the physical conditions under which it arises. This exercise guides you through the derivation of a critical threshold for the ion-acoustic instability, a primary mechanism for anomalous resistivity in plasmas where electrons are much hotter than ions ($T_e \\gg T_i$). By comparing the electron drift speed to the characteristic wave speed in the plasma, you will establish a fundamental, dimensionless criterion that computational models can use to determine when anomalous effects become significant .",
            "id": "3951143",
            "problem": "A uniform, quasi-neutral deuterium plasma with singly charged ions is threaded by a uniform current density carried entirely by electrons drifting relative to stationary ions. Let the electron number density be $n_{e}$, the electron charge magnitude be $e$, and the current density magnitude be $|J|$. Define the electron drift speed as $v_{d} = |J|/(n_{e} e)$. The electron temperature is $T_{e}$ and the ion temperature is $T_{i}$, with $T_{e} \\gg T_{i}$. The electron thermal speed is defined as $v_{te} = \\sqrt{2 T_{e}/m_{e}}$, where $m_{e}$ is the electron mass, and temperatures are expressed in energy units so that $T_{e}$ and $T_{i}$ have the same units as energies.\n\nIn computational models of fusion plasmas, anomalous resistivity due to microinstabilities is often invoked when a streaming instability driven by $v_{d}$ is able to grow despite Landau damping and produce an effective electron scattering rate that competes with or exceeds the classical electron-ion collision frequency that underpins the Spitzer resistivity. Assume the following physically motivated and widely used criteria and approximations:\n\n- The onset of significant anomalous resistivity occurs when the electron drift exceeds the phase speed of the fastest growing electrostatic mode available under the stated conditions, so that wave growth and consequent wave-particle scattering can proceed on timescales shorter than classical electron-ion momentum exchange. Under $T_{e} \\gg T_{i}$ and singly charged ions, the dominant low-threshold electrostatic mode is the ion-acoustic wave, whose phase speed is well approximated by the ion-acoustic speed $c_{s}$.\n- For $T_{e} \\gg T_{i}$, the ion-acoustic speed satisfies $c_{s} \\approx \\sqrt{T_{e}/m_{i}}$, where $m_{i}$ is the ion mass and quasineutrality with Boltzmann electrons justifies this expression.\n- The electron thermal speed is $v_{te} = \\sqrt{2 T_{e}/m_{e}}$.\n\nStarting from these bases, derive a criterion written as a threshold on the dimensionless drift-to-thermal ratio $R \\equiv v_{d}/v_{te}$ for when anomalous resistivity becomes significant compared to Spitzer resistivity. Express your result as an order-of-magnitude threshold $R_{\\mathrm{th}}$ expressed entirely in terms of fundamental constants and the ion-to-electron mass ratio for deuterium.\n\nTake deuterium ions with $m_{i} = 2 m_{p}$, where $m_{p}/m_{e} = 1836$.\n\nProvide your final answer as the numerical value of $R_{\\mathrm{th}}$ rounded to two significant figures. The answer is dimensionless; do not include units.",
            "solution": "The problem asks for the derivation of a threshold for the dimensionless drift-to-thermal ratio, $R \\equiv v_{d}/v_{te}$, above which anomalous resistivity due to the ion-acoustic instability becomes significant.\n\nThe premises for the derivation are provided in the problem statement.\nThe electron drift speed is $v_{d}$.\nThe electron thermal speed is defined as $v_{te} = \\sqrt{2 T_{e}/m_{e}}$, where $T_{e}$ is the electron temperature in energy units and $m_{e}$ is the electron mass.\nThe condition for the onset of significant anomalous resistivity is that the electron drift speed $v_{d}$ exceeds the phase speed of the fastest growing electrostatic mode, which is the ion-acoustic wave.\nThe phase speed of the ion-acoustic wave is approximated by the ion-acoustic speed, $c_{s}$.\nFor the given condition of $T_{e} \\gg T_{i}$ (electron temperature much greater than ion temperature), the ion-acoustic speed is given by $c_{s} \\approx \\sqrt{T_{e}/m_{i}}$, where $m_{i}$ is the ion mass.\n\nThe threshold for instability, and thus for the onset of anomalous resistivity, is met when the electron drift speed is equal to the ion-acoustic speed. We denote the drift speed at this threshold as $(v_{d})_{\\mathrm{th}}$.\n$$\n(v_{d})_{\\mathrm{th}} = c_{s}\n$$\nThe problem asks for the threshold value of the ratio $R = v_{d}/v_{te}$. Let's define this threshold ratio as $R_{\\mathrm{th}}$.\n$$\nR_{\\mathrm{th}} = \\frac{(v_{d})_{\\mathrm{th}}}{v_{te}}\n$$\nSubstituting the threshold condition $(v_{d})_{\\mathrm{th}} = c_{s}$ into this definition, we get:\n$$\nR_{\\mathrm{th}} = \\frac{c_{s}}{v_{te}}\n$$\nNow, we substitute the given expressions for $c_{s}$ and $v_{te}$:\n$$\nc_{s} = \\sqrt{\\frac{T_{e}}{m_{i}}} \\quad \\text{and} \\quad v_{te} = \\sqrt{\\frac{2 T_{e}}{m_{e}}}\n$$\nPlugging these into the expression for $R_{\\mathrm{th}}$ yields:\n$$\nR_{\\mathrm{th}} = \\frac{\\sqrt{\\frac{T_{e}}{m_{i}}}}{\\sqrt{\\frac{2 T_{e}}{m_{e}}}}\n$$\nWe can combine the terms under a single square root:\n$$\nR_{\\mathrm{th}} = \\sqrt{\\left(\\frac{T_{e}}{m_{i}}\\right) \\left(\\frac{m_{e}}{2 T_{e}}\\right)}\n$$\nThe electron temperature $T_{e}$ cancels out from the numerator and denominator, which is expected as the final result should depend only on mass ratios and fundamental constants.\n$$\nR_{\\mathrm{th}} = \\sqrt{\\frac{m_{e}}{2 m_{i}}}\n$$\nThis is the general symbolic expression for the threshold ratio. The problem specifies a deuterium plasma. For deuterium, the ion mass $m_{i}$ is approximately equal to the mass of one proton and one neutron, which is roughly twice the proton mass, $m_{p}$. The problem provides this relation as $m_{i} = 2 m_{p}$.\nSubstituting this into our expression for $R_{\\mathrm{th}}$:\n$$\nR_{\\mathrm{th}} = \\sqrt{\\frac{m_{e}}{2(2 m_{p})}} = \\sqrt{\\frac{m_{e}}{4 m_{p}}}\n$$\nThis can be simplified to:\n$$\nR_{\\mathrm{th}} = \\frac{1}{\\sqrt{4}} \\sqrt{\\frac{m_{e}}{m_{p}}} = \\frac{1}{2} \\sqrt{\\frac{m_{e}}{m_{p}}}\n$$\nThe problem provides the proton-to-electron mass ratio:\n$$\n\\frac{m_{p}}{m_{e}} = 1836\n$$\nTherefore, the electron-to-proton mass ratio is the reciprocal:\n$$\n\\frac{m_{e}}{m_{p}} = \\frac{1}{1836}\n$$\nSubstituting this numerical value into our final symbolic expression for $R_{\\mathrm{th}}$:\n$$\nR_{\\mathrm{th}} = \\frac{1}{2} \\sqrt{\\frac{1}{1836}} = \\frac{1}{2 \\sqrt{1836}}\n$$\nWe now calculate the numerical value.\n$$\n\\sqrt{1836} \\approx 42.84857\n$$\nSo,\n$$\nR_{\\mathrm{th}} \\approx \\frac{1}{2 \\times 42.84857} = \\frac{1}{85.69714} \\approx 0.0116689\n$$\nThe problem asks for the final answer to be rounded to two significant figures. The first significant figure is the $1$ in the hundredths place. The second is the $1$ in the thousandths place. The third digit is a $6$, so we round up.\n$$\nR_{\\mathrm{th}} \\approx 0.012\n$$\nThis dimensionless value represents the threshold for the electron drift speed, normalized to the electron thermal speed, for the onset of significant anomalous resistivity in a deuterium plasma under the specified conditions.",
            "answer": "$$\n\\boxed{0.012}\n$$"
        },
        {
            "introduction": "Once anomalous resistivity is active, a key task for physicists is to quantify its magnitude and test whether theoretical models of turbulence can account for it. This practice problem places you in a scenario analogous to analyzing data from a satellite crossing a magnetic reconnection region, a phenomenon where anomalous resistivity is thought to play a critical role in breaking magnetic field lines. Using a set of hypothetical but physically representative measurements, you will calculate the resistivity required to explain an observed parallel electric field and compare it against the prediction from an ion-acoustic turbulence model, a core task in both experimental data analysis and simulation validation .",
            "id": "3951185",
            "problem": "In a collisionless magnetic reconnection exhaust, measurements within the Electron Diffusion Region (EDR) show a localized parallel electric field $E_{\\parallel}$ co-located with a parallel current density $j_{\\parallel}$. Assume the parallel component of the generalized Ohm’s law reduces to $E_{\\parallel} \\approx \\eta_{\\mathrm{an}} j_{\\parallel}$, where $\\eta_{\\mathrm{an}}$ is an anomalous resistivity arising from wave–particle interactions. The anomalous resistivity is modeled by the effective electron collision frequency $\\nu_{\\mathrm{eff}}$ via the electron momentum balance, $\\eta_{\\mathrm{an}} = \\frac{m_e \\nu_{\\mathrm{eff}}}{n_e e^{2}}$, where $m_e$ is the electron mass, $n_e$ the electron number density, and $e$ the elementary charge.\n\nConsider two mechanisms:\n- A Buneman-type turbulence, for which you will infer the required $\\eta_{\\mathrm{an}}$ solely from the measured $E_{\\parallel}$ and $j_{\\parallel}$.\n- An ion-acoustic turbulence, for which you shall estimate the predicted $\\eta_{\\mathrm{an}}$ using a mixing-length closure $\\nu_{\\mathrm{IA}} \\approx k c_s \\left(\\frac{\\delta n}{n_e}\\right)^{2}$, where $k$ is the dominant parallel wavenumber of the ion-acoustic fluctuations, $c_s = \\sqrt{\\frac{k_B T_e}{m_i}}$ is the ion-acoustic speed, $k_B$ is the Boltzmann constant, $T_e$ is the electron temperature expressed in electron-volts (so that $k_B T_e$ should be converted to Joules using $e$), and $m_i$ is the ion mass.\n\nUse the following measured and known quantities:\n- $E_{\\parallel} = 0.05$ V/m,\n- $j_{\\parallel} = 0.02$ A/m$^{2}$,\n- $n_e = 1.0 \\times 10^{9}$ m$^{-3}$,\n- $T_e = 100$ eV,\n- $m_i = m_p$ (proton mass),\n- $k = 0.42$ m$^{-1}$,\n- $\\frac{\\delta n}{n_e} = 0.005$.\n\nConstants:\n- $e = 1.602176634 \\times 10^{-19}$ C,\n- $m_e = 9.1093837015 \\times 10^{-31}$ kg,\n- $m_p = 1.67262192369 \\times 10^{-27}$ kg.\n\nTasks:\n1. Using $E_{\\parallel} \\approx \\eta_{\\mathrm{an}} j_{\\parallel}$, compute the anomalous resistivity required for Buneman turbulence to match $E_{\\parallel}$.\n2. Using $\\nu_{\\mathrm{IA}} \\approx k c_s \\left(\\frac{\\delta n}{n_e}\\right)^{2}$ and $\\eta_{\\mathrm{an}} = \\frac{m_e \\nu_{\\mathrm{eff}}}{n_e e^{2}}$, compute the ion-acoustic predicted anomalous resistivity.\n3. Form the ratio $R = \\frac{\\eta_{\\mathrm{B,req}}}{\\eta_{\\mathrm{IA,pred}}}$, where $\\eta_{\\mathrm{B,req}}$ is the required Buneman anomalous resistivity and $\\eta_{\\mathrm{IA,pred}}$ is the ion-acoustic predicted anomalous resistivity.\n\nExpress the final answer as the single number $R$ (dimensionless). Round your final answer to three significant figures.",
            "solution": "The solution requires performing three calculations as specified in the problem statement.\n\n**1. Calculation of the required anomalous resistivity, $\\eta_{\\mathrm{B,req}}$**\nThis value is inferred directly from the simplified Ohm's law using the provided measurements of the parallel electric field $E_{\\parallel}$ and current density $j_{\\parallel}$. The resistivity required to explain the measurements, denoted $\\eta_{\\mathrm{B,req}}$, is:\n$$ \\eta_{\\mathrm{B,req}} = \\frac{E_{\\parallel}}{j_{\\parallel}} = \\frac{0.05 \\text{ V/m}}{0.02 \\text{ A/m}^2} = 2.5 \\text{ }\\Omega\\cdot\\text{m} $$\n\n**2. Calculation of the predicted ion-acoustic anomalous resistivity, $\\eta_{\\mathrm{IA,pred}}$**\nThis requires a multi-step calculation based on the ion-acoustic turbulence model.\n\nFirst, we calculate the ion-acoustic speed, $c_s$, using the given electron temperature $T_e = 100$ eV and ion mass $m_i = m_p$. The thermal energy in Joules is $k_B T_e = (100 \\text{ eV}) \\times e$.\n$$ c_s = \\sqrt{\\frac{k_B T_e}{m_i}} = \\sqrt{\\frac{100 \\times (1.602176634 \\times 10^{-19} \\text{ J})}{1.67262192369 \\times 10^{-27} \\text{ kg}}} \\approx 97871.6 \\text{ m/s} $$\nNext, we use $c_s$ to find the effective ion-acoustic collision frequency, $\\nu_{\\mathrm{IA}}$, from the mixing-length formula:\n$$ \\nu_{\\mathrm{IA}} = k c_s \\left(\\frac{\\delta n}{n_e}\\right)^{2} = (0.42 \\text{ m}^{-1}) \\times (97871.6 \\text{ m/s}) \\times (0.005)^2 \\approx 1.02765 \\text{ s}^{-1} $$\nFinally, we compute the resistivity from this effective collision frequency, setting $\\nu_{\\mathrm{eff}} = \\nu_{\\mathrm{IA}}$:\n$$ \\eta_{\\mathrm{IA,pred}} = \\frac{m_e \\nu_{\\mathrm{IA}}}{n_e e^2} = \\frac{(9.1093837015 \\times 10^{-31} \\text{ kg}) \\times (1.02765 \\text{ s}^{-1})}{(1.0 \\times 10^9 \\text{ m}^{-3}) \\times (1.602176634 \\times 10^{-19} \\text{ C})^2} \\approx 0.036471 \\text{ }\\Omega\\cdot\\text{m} $$\n\n**3. Calculation of the ratio $R$**\nThe final step is to compute the ratio of the required resistivity to the predicted resistivity:\n$$ R = \\frac{\\eta_{\\mathrm{B,req}}}{\\eta_{\\mathrm{IA,pred}}} = \\frac{2.5}{0.036471} \\approx 68.547 $$\nRounding to three significant figures, the final result is $68.5$. This ratio indicates that the resistivity required to explain the observed parallel electric field is significantly larger than what is predicted by the simple ion-acoustic turbulence model with the given parameters.",
            "answer": "$$\\boxed{68.5}$$"
        },
        {
            "introduction": "A central challenge in computational science is ensuring that phenomena observed in a simulation represent real physics, not artifacts of the numerical algorithm. Numerical dissipation can often mimic physical resistivity, leading to incorrect conclusions. This exercise provides a hands-on tutorial in a critical verification technique: the convergence study. By analyzing how a measured resistivity from a set of hypothetical simulation runs changes with grid spacing ($\\Delta x$), time step ($\\Delta t$), and particle count ($N_p$), you will learn how to perform a multivariable regression to extrapolate to the continuum limit, thereby isolating the true physical anomalous resistivity from numerical errors .",
            "id": "3951176",
            "problem": "A computational fusion science and engineering study requires distinguishing physical anomalous resistivity from numerical dissipation in simulations of current-driven microinstabilities. Consider a simplified one-dimensional current channel aligned with the magnetic field where the parallel electric field is measured. Begin from the electron momentum equation and the generalized Ohm’s law, and design a numerical convergence study that separates the physical anomalous resistivity from numerical artifacts by varying grid resolution, particle number, and time step. Your program must implement and execute this study on the provided test suite and produce the specified output.\n\nUse the following fundamental base.\n\n- The electron momentum equation along the magnetic field direction is\n$$m_e n \\frac{d u_e}{dt} = -n e E_\\parallel - \\nabla_\\parallel p_e - m_e n \\nu_\\mathrm{eff} u_e,$$\nwhere $m_e$ is electron mass, $n$ is electron number density, $u_e$ is electron drift velocity parallel to the magnetic field, $e$ is the elementary charge, $E_\\parallel$ is the parallel electric field, $p_e$ is electron pressure, and $\\nu_\\mathrm{eff}$ is the effective collision frequency that may include microturbulence-induced scattering.\n\n- The generalized Ohm’s law along the magnetic field in a magnetized plasma reduces under appropriate ordering to\n$$E_\\parallel \\approx \\eta_\\mathrm{eff} j_\\parallel + \\frac{1}{n e} \\nabla_\\parallel p_e + \\text{inertial/finite-frequency terms},$$\nwhere $j_\\parallel$ is the parallel current density and $\\eta_\\mathrm{eff} = \\frac{m_e \\nu_\\mathrm{eff}}{n e^2}$ is the effective resistivity including anomalous contributions.\n\n- The observed effective resistivity, defined from measured fields and currents, is\n$$\\eta_\\mathrm{obs} = \\frac{E_\\parallel}{j_\\parallel}.$$\n\nTo separate the physical anomalous resistivity from numerical dissipation, you are to model how $\\eta_\\mathrm{obs}$ changes with three numerical controls in a Particle-In-Cell (PIC) Magnetohydrodynamics (MHD) style computation: grid spacing $\\Delta x$, time step $\\Delta t$, and number of simulation particles $N_p$. Empirically and by standard truncation analysis for second-order spatial discretization and first-order time integration with particle noise, leading-order numerical contributions scale as\n$$\\eta_\\mathrm{num}(\\Delta x, \\Delta t, N_p) \\sim \\alpha \\Delta x^2 + \\beta \\Delta t + \\gamma \\frac{1}{N_p},$$\nfor coefficients $\\alpha$, $\\beta$, $\\gamma$ that depend on the method. Assume that higher-order terms are negligible over the ranges considered. The physical anomalous resistivity $\\eta_\\mathrm{phys}$ is independent of $\\Delta x$, $\\Delta t$, and $N_p$ for sufficiently resolved simulations. Your goal is to estimate $\\eta_\\mathrm{phys}$ by extrapolating $\\eta_\\mathrm{obs}$ to the limit $\\Delta x \\to 0$, $\\Delta t \\to 0$, and $N_p \\to \\infty$.\n\nYour program must implement the following algorithmic tasks.\n\n1. For each group of experimental runs, compute $\\eta_\\mathrm{obs}$ from the provided data as $\\eta_\\mathrm{obs} = E_\\parallel / j_\\parallel$.\n\n2. Fit the linear model\n$$\\eta_\\mathrm{obs} \\approx \\eta_\\mathrm{phys} + \\alpha \\Delta x^2 + \\beta \\Delta t + \\gamma \\frac{1}{N_p}$$\nusing least squares across the runs in a group to estimate $\\eta_\\mathrm{phys}$ as the intercept.\n\n3. Demonstrate convergence by comparing the intercept estimated on a coarse subset of runs to the intercept estimated on a fine subset of runs. Use the coarse subset consisting of the first four runs and the fine subset consisting of the last four runs (indices counted from one). Define convergence to be achieved if the absolute difference between the two intercept estimates is less than a fixed tolerance $\\varepsilon$.\n\n4. Produce, for each group, a two-element result consisting of the estimated physical anomalous resistivity and a boolean indicating whether convergence is achieved.\n\nAll quantities are in dimensionless normalized units; no physical unit conversion is required.\n\nTest suite and data. Each experimental run provides $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel)$ in dimensionless normalized units. There are three groups (A, B, C) of six runs each, spanning a range of grid spacings, time steps, and particle counts. The current density level differs across groups to exercise cases with and without physical anomalous resistivity.\n\nGroup A (subcritical current; physical anomalous contribution expected to be negligible):\n- Run 1: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.2, 0.04, 500, 0.8, 0.0576)$\n- Run 2: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.04, 500, 0.8, 0.0456)$\n- Run 3: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 500, 0.8, 0.0328)$\n- Run 4: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 1000, 0.8, 0.0248)$\n- Run 5: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.02, 1000, 0.8, 0.0218)$\n- Run 6: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.01, 2000, 0.8, 0.0114)$\n\nGroup B (moderately supercritical current; physical anomalous contribution expected to be present):\n- Run 1: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.2, 0.04, 500, 1.4, 0.2128)$\n- Run 2: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.04, 500, 1.4, 0.1918)$\n- Run 3: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 500, 1.4, 0.1694)$\n- Run 4: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 1000, 1.4, 0.1554)$\n- Run 5: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.02, 1000, 1.4, 0.15015)$\n- Run 6: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.01, 2000, 1.4, 0.13195)$\n\nGroup C (strongly supercritical current; larger physical anomalous contribution expected):\n- Run 1: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.2, 0.04, 500, 2.0, 0.544)$\n- Run 2: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.04, 500, 2.0, 0.514)$\n- Run 3: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 500, 2.0, 0.482)$\n- Run 4: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.1, 0.02, 1000, 2.0, 0.462)$\n- Run 5: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.02, 1000, 2.0, 0.4545)$\n- Run 6: $(\\Delta x, \\Delta t, N_p, j_\\parallel, E_\\parallel) = (0.05, 0.01, 2000, 2.0, 0.4285)$\n\nAnswer specification and final output format:\n- The tolerance for the convergence check is $\\varepsilon = 10^{-9}$ in dimensionless normalized units.\n- Your program should produce a single line of output containing the results for the three groups as a comma-separated list of three two-element lists in the form\n$$[\\,[\\eta_A, \\text{flag}_A],\\,[\\eta_B, \\text{flag}_B],\\,[\\eta_C, \\text{flag}_C]\\,],$$\nwhere $\\eta_A$, $\\eta_B$, and $\\eta_C$ are floating-point numbers representing the estimated physical anomalous resistivity for Groups A, B, and C, respectively, and $\\text{flag}_A$, $\\text{flag}_B$, and $\\text{flag}_C$ are booleans indicating whether convergence is achieved for each group. All outputs must be dimensionless numbers as provided, with booleans in the programming language’s standard literal format.",
            "solution": "The goal is to distinguish the physical anomalous resistivity $\\eta_\\mathrm{phys}$ from numerical artifacts $\\eta_\\mathrm{num}$ by performing a convergence study. The methodology hinges on a multivariable linear regression analysis.\n\nFor each experimental run $i$, we are given the numerical parameters $(\\Delta x_i, \\Delta t_i, N_{p,i})$ and the resulting physical observables $(j_{\\parallel,i}, E_{\\parallel,i})$. First, we calculate the observed resistivity for each run:\n$$ \\eta_{\\mathrm{obs},i} = \\frac{E_{\\parallel,i}}{j_{\\parallel,i}} $$\nThe core assumption is that the observed resistivity can be modeled as a linear combination of a constant physical term and terms that depend on the numerical parameters:\n$$ \\eta_{\\mathrm{obs},i} \\approx \\eta_\\mathrm{phys} + \\alpha (\\Delta x_i)^2 + \\beta (\\Delta t_i) + \\gamma \\frac{1}{N_{p,i}} $$\nThis constitutes a system of linear equations. For a group of $M$ runs, this can be written in matrix form as $\\mathbf{y} \\approx \\mathbf{X}\\mathbf{c}$, where:\n- $\\mathbf{y}$ is the $M \\times 1$ vector of observed resistivities, $y_i = \\eta_{\\mathrm{obs},i}$.\n- $\\mathbf{X}$ is the $M \\times 4$ design matrix. Its $i$-th row is $[1, (\\Delta x_i)^2, \\Delta t_i, 1/N_{p,i}]$. The first column of ones corresponds to the intercept term, $\\eta_\\mathrm{phys}$.\n- $\\mathbf{c}$ is the $4 \\times 1$ vector of unknown coefficients, $\\mathbf{c} = [\\eta_\\mathrm{phys}, \\alpha, \\beta, \\gamma]^T$.\n\nThe vector of coefficients $\\mathbf{c}$ can be found by solving this system using the method of least squares. The solution is given by the normal equations:\n$$ \\mathbf{c} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y} $$\nThe first element of the resulting vector $\\mathbf{c}$ is our estimate for the physical anomalous resistivity, $\\eta_\\mathrm{phys}$.\n\nThe procedure for each group of runs (A, B, C) is as follows:\n1.  **Primary Estimate of $\\eta_\\mathrm{phys}$**: Construct the vector $\\mathbf{y}$ and matrix $\\mathbf{X}$ using all $M=6$ runs in the group. Solve for the coefficient vector $\\mathbf{c}_{\\mathrm{all}}$ using least squares. The primary estimate for the physical resistivity is the first element, $\\eta_{\\mathrm{phys, all}} = (\\mathbf{c}_{\\mathrm{all}})_0$. This value will be reported.\n\n2.  **Convergence Analysis**: To verify that the numerical parameters are in the asymptotic regime where the assumed error scaling holds, a convergence check is performed.\n    a.  **Coarse-grid Estimate**: A fit is performed using only the first four runs (indices $1-4$), which are generally at a coarser resolution. This defines a $4 \\times 4$ system, which is solved to find the coefficient vector $\\mathbf{c}_{\\mathrm{coarse}}$ and its intercept $\\eta_{\\mathrm{phys, coarse}}$.\n    b.  **Fine-grid Estimate**: A second fit is performed using only the last four runs (indices $3-6$), which are at a finer resolution. This defines another $4 \\times 4$ system, yielding the coefficient vector $\\mathbf{c}_{\\mathrm{fine}}$ and its intercept $\\eta_{\\mathrm{phys, fine}}$.\n    c.  **Convergence Check**: Convergence is confirmed if the absolute difference between the coarse and fine estimates of the physical resistivity is below the specified tolerance $\\varepsilon = 10^{-9}$:\n    $$ |\\eta_{\\mathrm{phys, coarse}} - \\eta_{\\mathrm{phys, fine}}|  \\varepsilon $$\n    A boolean flag will be set to true if this condition is met, and false otherwise.\n\n3.  **Final Result**: For each group, the final output will be a two-element list containing the primary estimate $\\eta_{\\mathrm{phys, all}}$ and the boolean convergence flag. This process is repeated for all three data groups.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the anomalous resistivity problem by performing a convergence study\n    based on linear least squares fitting.\n    \"\"\"\n\n    # Test suite data: (Δx, Δt, Np, j_parallel, E_parallel) for each run.\n    test_suite = {\n        'A': [\n            (0.2, 0.04, 500, 0.8, 0.0576),\n            (0.1, 0.04, 500, 0.8, 0.0456),\n            (0.1, 0.02, 500, 0.8, 0.0328),\n            (0.1, 0.02, 1000, 0.8, 0.0248),\n            (0.05, 0.02, 1000, 0.8, 0.0218),\n            (0.05, 0.01, 2000, 0.8, 0.0114)\n        ],\n        'B': [\n            (0.2, 0.04, 500, 1.4, 0.2128),\n            (0.1, 0.04, 500, 1.4, 0.1918),\n            (0.1, 0.02, 500, 1.4, 0.1694),\n            (0.1, 0.02, 1000, 1.4, 0.1554),\n            (0.05, 0.02, 1000, 1.4, 0.15015),\n            (0.05, 0.01, 2000, 1.4, 0.13195)\n        ],\n        'C': [\n            (0.2, 0.04, 500, 2.0, 0.544),\n            (0.1, 0.04, 500, 2.0, 0.514),\n            (0.1, 0.02, 500, 2.0, 0.482),\n            (0.1, 0.02, 1000, 2.0, 0.462),\n            (0.05, 0.02, 1000, 2.0, 0.4545),\n            (0.05, 0.01, 2000, 2.0, 0.4285)\n        ]\n    }\n\n    convergence_tolerance = 1e-9\n    \n    final_results = []\n\n    def fit_resistivity(runs_data):\n        \"\"\"\n        Performs a least-squares fit to estimate physical resistivity.\n\n        Args:\n            runs_data: A list of tuples, where each tuple contains\n                       (Δx, Δt, Np, j_parallel, E_parallel).\n\n        Returns:\n            The estimated physical resistivity (the intercept term).\n        \"\"\"\n        num_runs = len(runs_data)\n        \n        # Design matrix X and observation vector y\n        X = np.zeros((num_runs, 4))\n        y = np.zeros(num_runs)\n\n        for i, run in enumerate(runs_data):\n            dx, dt, Np, j_para, E_para = run\n            \n            # Observed resistivity\n            eta_obs = E_para / j_para\n            y[i] = eta_obs\n            \n            # Populate the design matrix: [1, dx^2, dt, 1/Np]\n            X[i, 0] = 1.0  # Intercept term for eta_phys\n            X[i, 1] = dx**2\n            X[i, 2] = dt\n            X[i, 3] = 1.0 / Np\n\n        # Solve the linear system y = Xc for c using least squares.\n        # c = [eta_phys, alpha, beta, gamma]\n        coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        eta_phys_estimate = coeffs[0]\n        return eta_phys_estimate\n\n    # Process each group of experimental runs\n    for group_key in sorted(test_suite.keys()):\n        group_data = test_suite[group_key]\n        \n        # 1. Estimate eta_phys using all runs in the group for the final reported value.\n        eta_phys_all = fit_resistivity(group_data)\n\n        # 2. Define coarse and fine subsets for convergence check.\n        # Coarse subset: runs 1-4 (Python indices 0-3)\n        coarse_subset = group_data[0:4]\n        # Fine subset: runs 3-6 (Python indices 2-5)\n        fine_subset = group_data[2:6]\n\n        # 3. Estimate eta_phys for each subset.\n        eta_phys_coarse = fit_resistivity(coarse_subset)\n        eta_phys_fine = fit_resistivity(fine_subset)\n\n        # 4. Perform the convergence check.\n        is_converged = abs(eta_phys_coarse - eta_phys_fine)  convergence_tolerance\n        \n        # 5. Store the final result for the group.\n        final_results.append([eta_phys_all, is_converged])\n\n    # The final print must match the specified single-line format.\n    # The standard string representation of a list of lists in Python matches\n    # the structure specified in the problem description.\n    print(final_results)\n\nsolve()\n```"
        }
    ]
}