{
    "hands_on_practices": [
        {
            "introduction": "鱼骨模不稳定的特征频率并非任意，而是由共振高能粒子的运动决定的。这项练习旨在通过一个量级估算，将宏观的模式频率 $\\omega$ 与微观的粒子漂移进动频率 $\\omega_d$ 联系起来。通过这种方式，我们可以直观地理解作为该不稳定性核心的模-粒子共振机制 ()。",
            "id": "3981017",
            "problem": "考虑一个圆截面托卡马克，其大半径 $R_{0} = 3\\,\\mathrm{m}$，小半径 $a = 1\\,\\mathrm{m}$，轴上安全因子 $q_{0} = 0.95$。在模半径处，可以取反环径比为 $\\epsilon = r/R_{0} = 0.3$。能量为 $E_{h} = 80\\,\\mathrm{keV}$ 的高能捕获氘离子群体与 $n=1$, $m=1$ 内扭曲模（鱼骨不稳定性）发生共振相互作用。对于捕获离子，漂移进动频率与弹跳频率乘以反环径比的数量级相同，因此使用标度关系 $\\omega_{d} \\sim \\epsilon\\,\\omega_{b}$。为了得到与圆形几何一致的数量级估计，将弹跳角频率近似为特征极向漂移长度与高能离子速率之比，具体为 $\\omega_{b} \\sim v/(q_{0} R_{0})$，其中 $v$ 是从其动能通过能量与速率的标准力学关系得到的氘离子速率。取氘离子质量为 $m_{d}$，元电荷为 $e$，电子伏特 (eV) 的定义为 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$。利用这些基础和近似，通过设置 $\\omega \\approx \\omega_{d}$ 来估计鱼骨角频率。\n\n计算 $\\omega$ 的数值，并以弧度/秒为单位表示。将您的最终答案四舍五入到三位有效数字。",
            "solution": "用户希望根据一组为圆截面托卡马克提供的标度关系和参数来估计鱼骨不稳定性角频率 $\\omega$。\n\n首先，我将验证问题陈述。\n\n### 步骤1：提取已知条件\n-   大半径: $R_{0} = 3\\,\\mathrm{m}$\n-   小半径: $a = 1\\,\\mathrm{m}$\n-   轴上安全因子: $q_{0} = 0.95$\n-   模半径处的反环径比: $\\epsilon = r/R_{0} = 0.3$\n-   高能氘离子动能: $E_{h} = 80\\,\\mathrm{keV}$\n-   不稳定性模数: $n=1$, $m=1$ 内扭曲模\n-   漂移进动频率的标度关系: $\\omega_{d} \\sim \\epsilon\\,\\omega_{b}$\n-   弹跳角频率的近似: $\\omega_{b} \\sim v/(q_{0} R_{0})$\n-   氘离子速率关系: $v$ 是通过标准力学关系从 $E_{h}$ 获得的。\n-   常数和定义: 氘离子质量 $m_{d}$，元电荷 $e$，$1\\,\\mathrm{eV} = e\\,\\mathrm{J}$。\n-   鱼骨频率的条件: $\\omega \\approx \\omega_{d}$\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题很好地基于托卡马克等离子体中磁流体动力学（MHD）不稳定性的既定物理学，特别是与高能粒子的共振相互作用驱动的鱼骨不稳定性。所有概念，如安全因子、环径比、漂移进动频率和弹跳频率，都是聚变等离子体物理学中的标准概念。数值对于现代托卡马克是现实的。所提供的标度关系是数量级近似，通常用于教学环境或初步估计。\n-   **适定性**：问题是适定的。它提供了一套清晰的指令和一系列近似，从而得出一个唯一的数值答案。它包含足够的信息来执行计算。\n-   **客观性**：问题以精确、客观的语言陈述，没有任何主观或基于意见的内容。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的、适定的和客观的。它被认为是有效的。我将继续进行解答。\n\n目标是计算鱼骨角频率 $\\omega$ 的数值。问题提供了一系列近似来实现这一目标。\n\n鱼骨模频率被设定为约等于高能离子的漂移进动频率 $\\omega_{d}$：\n$$\n\\omega \\approx \\omega_{d}\n$$\n漂移进动频率 $\\omega_{d}$ 通过给定的与反环径比 $\\epsilon$ 的标度关系与弹跳频率 $\\omega_{b}$ 相关联：\n$$\n\\omega_{d} \\sim \\epsilon\\,\\omega_{b}\n$$\n弹跳角频率 $\\omega_{b}$ 使用氘离子的速率 $v$、轴上安全因子 $q_{0}$ 和大半径 $R_{0}$ 来近似：\n$$\n\\omega_{b} \\sim \\frac{v}{q_{0} R_{0}}\n$$\n结合这些关系，我们可以将鱼骨频率 $\\omega$ 表示为：\n$$\n\\omega \\approx \\epsilon \\left( \\frac{v}{q_{0} R_{0}} \\right) = \\frac{\\epsilon v}{q_{0} R_{0}}\n$$\n要使用这个公式，我们必须首先根据氘离子的动能 $E_{h}$ 确定其速率 $v$。动能和速率之间的非相对论关系是：\n$$\nE_{h} = \\frac{1}{2} m_{d} v^2\n$$\n其中 $m_{d}$ 是氘离子的质量。解出 $v$，我们得到：\n$$\nv = \\sqrt{\\frac{2 E_{h}}{m_{d}}}\n$$\n将这个 $v$ 的表达式代入我们的 $\\omega$ 方程，得到用于估计的最终公式：\n$$\n\\omega \\approx \\frac{\\epsilon}{q_{0} R_{0}} \\sqrt{\\frac{2 E_{h}}{m_{d}}}\n$$\n现在，我们将给定的数值代入这个表达式。参数如下：\n-   $\\epsilon = 0.3$\n-   $q_{0} = 0.95$\n-   $R_{0} = 3\\,\\mathrm{m}$\n-   $E_{h} = 80\\,\\mathrm{keV}$\n\n我们还需要国际单位制（SI）中的物理常数值：\n-   氘离子质量: $m_{d} \\approx 3.34358 \\times 10^{-27}\\,\\mathrm{kg}$\n-   元电荷: $e \\approx 1.60218 \\times 10^{-19}\\,\\mathrm{C}$\n\n动能必须从千电子伏特（$keV$）转换为焦耳（$J$）：\n$$\nE_{h} = 80\\,\\mathrm{keV} = 80 \\times 10^{3}\\,\\mathrm{eV} = (80 \\times 10^{3}) \\times (1.60218 \\times 10^{-19}\\,\\mathrm{J}) = 1.281744 \\times 10^{-14}\\,\\mathrm{J}\n$$\n首先，我们计算氘离子的速率 $v$：\n$$\nv = \\sqrt{\\frac{2 \\times (1.281744 \\times 10^{-14}\\,\\mathrm{J})}{3.34358 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx \\sqrt{7.6680 \\times 10^{12}\\,\\mathrm{m^2/s^2}} \\approx 2.7691 \\times 10^{6}\\,\\mathrm{m/s}\n$$\n现在，我们可以计算角频率 $\\omega$：\n$$\n\\omega \\approx \\frac{0.3}{0.95 \\times 3\\,\\mathrm{m}} \\times (2.7691 \\times 10^{6}\\,\\mathrm{m/s})\n$$\n$$\n\\omega \\approx \\frac{0.3}{2.85} \\times (2.7691 \\times 10^{6}\\,\\mathrm{s^{-1}}) \\approx 0.10526 \\times (2.7691 \\times 10^{6}\\,\\mathrm{s^{-1}})\n$$\n$$\n\\omega \\approx 2.9148 \\times 10^{5}\\,\\mathrm{rad/s}\n$$\n问题要求将答案四舍五入到三位有效数字。\n$$\n\\omega \\approx 2.91 \\times 10^{5}\\,\\mathrm{rad/s}\n$$\n这就是在给定近似条件下鱼骨不稳定性的估计角频率。",
            "answer": "$$\\boxed{2.91 \\times 10^5}$$"
        },
        {
            "introduction": "虽然鱼骨模具有特定的特征频率，但它只有在高能粒子布居足够大，能够克服背景等离子体的稳定效应时，才会变得不稳定。这项练习将应用能量原理 ($\\delta W = 0$) 来计算触发不稳定性所需的临界高能粒子压强 ($\\beta_h^{\\mathrm{crit}}$)。这是一个预测等离子体性能的关键概念，它展示了如何确定不稳定性的阈值 ()。",
            "id": "3980962",
            "problem": "一个大环径比的圆形托卡马克，其大半径 $R_0=3.0\\,\\mathrm{m}$，环向磁场 $B_0=3.0\\,\\mathrm{T}$，在小半径 $r_1=0.60\\,\\mathrm{m}$ 处有一个 $q=1$ 磁面。在理想磁流体力学（MHD）能量原理并附加简化漂移动理学快离子贡献的框架下，考虑 $m=n=1$ 内扭曲模（鱼骨模）的稳定性。总势能变分写为 $\\delta W=\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)$。理想MHD贡献，归一化到 $q=1$ 体积内的磁能，由下式给出：\n$$\n\\frac{\\delta W_{\\mathrm{MHD}}}{W_{B1}}=C_{\\mathrm{MHD}},\n$$\n其中 $C_{\\mathrm{MHD}}=1.5\\times 10^{-3}$ 且 $W_{B1}=\\frac{B_0^2}{2\\mu_0}V_1$，$\\mu_0$ 是真空磁导率，$V_1$ 是 $r_1$ 内部的体积（您可以将 $V_1$ 保留为隐式，因为它最终会消掉）。\n\n对于一个各向同性、单能的快离子群体，快离子动理学贡献的实部模型为：\n$$\n\\frac{\\Re\\,\\delta W_h(\\omega)}{W_{B1}} \\approx -\\,\\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h\n$$\n其中 $\\Lambda=1.5$ 包含了轨道平均和模结构因子，$\\omega$ 是模频率，取其等于快离子进动频率 $\\omega=\\omega_d=6.0\\times 10^{3}\\,\\mathrm{s}^{-1}$，而 $\\omega_{\\ast h}=2.0\\times 10^{3}\\,\\mathrm{s}^{-1}$ 是快离子抗磁频率。快离子贝塔值定义为\n$$\n\\beta_h=\\frac{2\\mu_0 p_h}{B_0^2},\n$$\n其中快离子压强 $p_h$ 从各向同性单能分布的理想气体关系式获得，\n$$\np_h=\\frac{2}{3}n_h E_h,\n$$\n其中 $n_h$ 是快离子数密度，$E_h$ 是每个快离子的平均动能。\n\n设快离子参数为 $n_h=3.0\\times 10^{18}\\,\\mathrm{m}^{-3}$ 和 $E_h=80\\,\\mathrm{keV}$。仅使用给定的定义和模型，确定满足临界稳定性条件 $\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)=0$ 的阈值快离子贝塔值 $\\beta_h^{\\mathrm{crit}}$。将 $\\beta_h^{\\mathrm{crit}}$ 的最终答案表示为无量纲小数，并四舍五入到四位有效数字。不要报告任何中间量。",
            "solution": "该问题要求确定在托卡马克中触发 $m=n=1$ 内扭曲模（鱼骨模）不稳定性的阈值快离子贝塔值 $\\beta_h^{\\mathrm{crit}}$。首先对问题陈述进行严格的验证。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n\n问题陈述中提供了以下量和关系：\n- 大半径: $R_0=3.0\\,\\mathrm{m}$\n- 轴上环向磁场: $B_0=3.0\\,\\mathrm{T}$\n- $q=1$ 有理面的小半径: $r_1=0.60\\,\\mathrm{m}$\n- 模数: $m=1$, $n=1$\n- 总势能变分: $\\delta W=\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)$\n- 归一化的理想MHD势能贡献: $\\frac{\\delta W_{\\mathrm{MHD}}}{W_{B1}}=C_{\\mathrm{MHD}}$\n- MHD贡献常数的数值: $C_{\\mathrm{MHD}}=1.5\\times 10^{-3}$\n- 归一化磁能: $W_{B1}=\\frac{B_0^2}{2\\mu_0}V_1$，其中 $\\mu_0$ 是真空磁导率，$V_1$ 是 $r_1$ 磁面内的体积。\n- 快离子动理学贡献实部的模型: $\\frac{\\Re\\,\\delta W_h(\\omega)}{W_{B1}} \\approx -\\,\\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h$\n- 轨道平均和模结构因子: $\\Lambda=1.5$\n- 模频率（等于快离子进动频率）: $\\omega=\\omega_d=6.0\\times 10^{3}\\,\\mathrm{s}^{-1}$\n- 快离子抗磁频率: $\\omega_{\\ast h}=2.0\\times 10^{3}\\,\\mathrm{s}^{-1}$\n- 快离子贝塔值的定义: $\\beta_h=\\frac{2\\mu_0 p_h}{B_0^2}$\n- 从理想气体关系式得到的快离子压强: $p_h=\\frac{2}{3}n_h E_h$\n- 快离子数密度: $n_h=3.0\\times 10^{18}\\,\\mathrm{m}^{-3}$\n- 每个快离子的平均动能: $E_h=80\\,\\mathrm{keV}$\n- 临界稳定性条件: $\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)=0$\n\n**步骤2：使用提取的给定条件进行验证**\n\n根据所需标准对问题进行评估：\n- **科学依据**：该问题使用等离子体物理学中的标准模型描述了鱼骨模不稳定性，该模型结合了理想MHD能量原理和高能粒子的漂移动理学处理。所描述的现象和使用的方程在聚变科学中是公认的。所有物理参数都在大型托卡马克的实际范围内。该问题是科学合理的。\n- **提法恰当**：该问题提供了一个明确的目标：找到满足临界稳定性条件的 $\\beta_h^{\\mathrm{crit}}$ 值。它为此提供了足够的方程组和参数。\n- **客观性**：该问题是用精确、定量和无偏见的语言陈述的。\n- **完整性和一致性**：该问题要求计算阈值贝塔值 $\\beta_h^{\\mathrm{crit}}$。临界稳定性方程可以使用所提供参数的一个子集（$C_{\\mathrm{MHD}}$、$\\Lambda$、$r_1$、$R_0$、$\\omega$、$\\omega_{\\ast h}$）来求解这个阈值。该问题还提供了用于计算等离子体中*实际*存在的快离子贝塔值的参数（$n_h$、$E_h$、$B_0$、$\\mu_0$）。这些参数对于确定*阈值*的问题是多余的。阈值是系统稳定性边界的一个属性，与等离子体的实际状态无关。这些额外信息的存在不会造成矛盾，也不会使问题无法解决；它仅仅要求解题者正确识别必要的信息。因此，该问题是自洽且一致的。\n\n**步骤3：结论与行动**\n\n该问题是**有效的**。它是科学合理的、提法恰当的、客观的。存在多余数据并不会使其无效。现在开始求解过程。\n\n### 求解推导\n\n分析从临界稳定性条件开始，该条件定义了不稳定性的阈值。在此阈值下，总势能变分 $\\delta W$ 为零。\n$$\n\\delta W = \\delta W_{\\mathrm{MHD}} + \\Re\\,\\delta W_h(\\omega) = 0\n$$\n问题提供了这两项相对于 $q=1$ 磁面内磁能 $W_{B1}$ 归一化的表达式。将稳定性条件除以 $W_{B1}$，使用归一化方程会很方便：\n$$\n\\frac{\\delta W_{\\mathrm{MHD}}}{W_{B1}} + \\frac{\\Re\\,\\delta W_h(\\omega)}{W_{B1}} = 0\n$$\n将这些项的给定模型代入：\n$$\nC_{\\mathrm{MHD}} - \\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h = 0\n$$\n问题要求的是满足此临界稳定性条件的阈值快离子贝塔值，记为 $\\beta_h^{\\mathrm{crit}}$。因此，我们对上述方程求解 $\\beta_h$，并将其标记为 $\\beta_h^{\\mathrm{crit}}$：\n$$\nC_{\\mathrm{MHD}} = \\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h^{\\mathrm{crit}}\n$$\n重新整理方程以分离出 $\\beta_h^{\\mathrm{crit}}$，得到阈值的解析表达式：\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{C_{\\mathrm{MHD}}}{\\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)}\n$$\n注意，该阈值的计算取决于MHD稳定性性质（$C_{\\mathrm{MHD}}$）、几何因子（$r_1/R_0$）、模-粒子相互作用物理（$\\Lambda$）以及特征频率（$\\omega$、$\\omega_{\\ast h}$）。它不依赖于问题中给定的特定快离子群体参数（$n_h$、$E_h$），这些参数是用来计算等离子体中*实际的* $\\beta_h$，而不是稳定性阈值。\n\n现在我们将提供的数值代入此表达式：\n- $C_{\\mathrm{MHD}} = 1.5 \\times 10^{-3}$\n- $\\Lambda = 1.5$\n- $r_1 = 0.60\\,\\mathrm{m}$\n- $R_0 = 3.0\\,\\mathrm{m}$\n- $\\omega_{\\ast h} = 2.0 \\times 10^{3}\\,\\mathrm{s}^{-1}$\n- $\\omega = 6.0 \\times 10^{3}\\,\\mathrm{s}^{-1}$\n\n首先，我们计算无量纲比率：\n$q=1$ 磁面的环径比为：\n$$\n\\frac{r_1}{R_0} = \\frac{0.60}{3.0} = 0.2\n$$\n抗磁频率与模频率之比为：\n$$\n\\frac{\\omega_{\\ast h}}{\\omega} = \\frac{2.0 \\times 10^{3}\\,\\mathrm{s}^{-1}}{6.0 \\times 10^{3}\\,\\mathrm{s}^{-1}} = \\frac{1}{3}\n$$\n现在，将这些值代入 $\\beta_h^{\\mathrm{crit}}$ 的表达式中：\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{1.5 \\times 0.2 \\times \\left(1-\\frac{1}{3}\\right)}\n$$\n简化分母中的表达式：\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{1.5 \\times 0.2 \\times \\frac{2}{3}}\n$$\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{1.5 \\times \\frac{1}{5} \\times \\frac{2}{3}} = \\frac{1.5 \\times 10^{-3}}{\\frac{3}{2} \\times \\frac{1}{5} \\times \\frac{2}{3}} = \\frac{1.5 \\times 10^{-3}}{\\frac{1}{5}}\n$$\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{0.2} = 7.5 \\times 10^{-3}\n$$\n以小数形式表示，该值为 $0.0075$。问题要求答案以无量纲小数表示，并四舍五入到四位有效数字。\n$$\n\\beta_h^{\\mathrm{crit}} = 0.007500\n$$",
            "answer": "$$\\boxed{0.007500}$$"
        },
        {
            "introduction": "等离子体的稳定性不是由单一参数决定的，而是依赖于等离子体压强、磁剪切和安全因子剖面等多种因素的复杂组合。最后的这项练习将从单点计算转向计算模拟方法。通过将稳定性模型编写成代码，我们可以在多维参数空间中高效地绘制出稳定区和不稳定区，这是计算聚变科学中的一项基本任务 ()。",
            "id": "3980960",
            "problem": "您的任务是利用能量原理，为托卡马克等离子体中的鱼骨不稳定性构建参数稳定性图。能量原理指出，势能变分（记为 $\\delta W$）可以分解为一个磁流体动力学 (MHD) 分量和一个动理学高能粒子分量。如果总能量变分为正，则内扭曲鱼骨模是稳定的；如果为零，则为临界稳定；如果为负，则为不稳定。目标是在 $(\\beta_h, s, q_0)$ 构成的三维参数空间中，计算一系列参数点上的总能量变分的符号。其中，$\\beta_h$ 是无量纲的高能粒子比压（高能粒子压强与磁压强之比），$s$ 是磁剪切（无量纲），$q_0$ 是轴上安全因子（无量纲）。\n\n从能量原理和核心定义出发：\n- 总势能变分为 $\\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re \\delta W_h(\\omega)$。\n- 磁流体动力学 (MHD) 表示等离子体的宏观响应，而高能粒子项源于与模式的共振相互作用。\n\n采用以下科学上合理、简化且无量纲的模型，这些模型能捕捉内扭曲鱼骨模的定性物理特征：\n1. MHD 贡献的模型为\n$$\n\\delta W_{\\text{MHD}}(s, q_0) = C_s s^2 - C_q (1 - q_0),\n$$\n其中 $C_s$ 为正的刚度系数，$C_q$ 为扭曲模驱动系数。此形式反映了剪切的稳定作用以及当 $q_0  1$ 时的不稳定性。\n\n2. 高能粒子实部贡献的模型为一个共振展宽驱动\n$$\n\\Re \\delta W_h(\\omega) = - \\frac{C_h \\, \\beta_h}{1 + \\left(\\frac{\\omega_d}{\\omega_c}\\right)^2},\n$$\n其中 $\\omega_d$ 是弹跳平均进动频率，近似为\n$$\n\\omega_d(s, q_0) = \\omega_0 \\frac{s}{q_0},\n$$\n而 $\\omega_c$ 是一个特征展宽频率，用于解释有限轨道宽度和分布效应。负号反映了高能粒子在接近共振时会驱动该模式。\n\n所有量均为归一化且无量纲的。在您的实现中使用以下固定常数：\n- $C_s = 0.8$，\n- $C_q = 1.0$，\n- $C_h = 3.0$，\n- $\\omega_0 = 1.0$，\n- $\\omega_c = 0.5$。\n\n根据 $\\delta W_{\\text{tot}}$ 的符号定义稳定性分类，并使用一个小的数值容差 $\\tau$ 来检测临界状态：\n- 如果 $\\delta W_{\\text{tot}}  \\tau$，分类为稳定，输出整数 $+1$。\n- 如果 $|\\delta W_{\\text{tot}}| \\le \\tau$，分类为临界稳定，输出整数 $0$。\n- 如果 $\\delta W_{\\text{tot}}  -\\tau$，分类为不稳定，输出整数 $-1$。\n\n使用 $\\tau = 10^{-6}$。\n\n您的程序必须为以下每个测试用例计算分类，这些用例以 $(\\beta_h, s, q_0)$ 三元组的形式表示：\n- 用例 1：$(0.005, 0.7, 1.05)$，\n- 用例 2：$(0.03, 0.1, 0.95)$，\n- 用例 3：$(0.03264, 0.3, 1.0)$，\n- 用例 4：$(0.0, 0.0, 0.98)$，\n- 用例 5：$(0.02, 0.05, 1.1)$，\n- 用例 6：$(0.05, 1.0, 0.99)$，\n- 用例 7：$(0.04, 0.2, 0.98)$。\n\n所有输入均按规定为无量纲；输出中不需要物理单位。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与测试用例的顺序相同（例如，$[1,-1,0,1]$）。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n\n从问题陈述中逐字提取以下数据和定义：\n\n*   **目标**：构建鱼骨不稳定性的参数稳定性图。\n*   **参数空间**：$(\\beta_h, s, q_0)$，其中 $\\beta_h$ 是无量纲高能粒子比压，$s$ 是磁剪切，$q_0$ 是轴上安全因子。\n*   **总势能变分**：$\\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re \\delta W_h(\\omega)$。\n*   **MHD 贡献模型**：\n    $$\n    \\delta W_{\\text{MHD}}(s, q_0) = C_s s^2 - C_q (1 - q_0)\n    $$\n*   **高能粒子贡献模型**：\n    $$\n    \\Re \\delta W_h(\\omega) = - \\frac{C_h \\, \\beta_h}{1 + \\left(\\frac{\\omega_d}{\\omega_c}\\right)^2}\n    $$\n*   **进动频率模型**：\n    $$\n    \\omega_d(s, q_0) = \\omega_0 \\frac{s}{q_0}\n    $$\n*   **固定常数**：\n    *   $C_s = 0.8$\n    *   $C_q = 1.0$\n    *   $C_h = 3.0$\n    *   $\\omega_0 = 1.0$\n    *   $\\omega_c = 0.5$\n*   **稳定性分类标准**：\n    *   稳定 ($+1$)：如果 $\\delta W_{\\text{tot}}  \\tau$\n    *   临界稳定 ($0$)：如果 $|\\delta W_{\\text{tot}}| \\le \\tau$\n    *   不稳定 ($-1$)：如果 $\\delta W_{\\text{tot}}  -\\tau$\n*   **数值容差**：$\\tau = 10^{-6}$。\n*   **测试用例 $(\\beta_h, s, q_0)$**：\n    *   用例 1：$(0.005, 0.7, 1.05)$\n    *   用例 2：$(0.03, 0.1, 0.95)$\n    *   用例 3：$(0.03264, 0.3, 1.0)$\n    *   用例 4：$(0.0, 0.0, 0.98)$\n    *   用例 5：$(0.02, 0.05, 1.1)$\n    *   用例 6：$(0.05, 1.0, 0.99)$\n    *   用例 7：$(0.04, 0.2, 0.98)$\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n根据提供的验证标准对问题进行评估。\n\n*   **有科学依据**：该问题基于等离子体稳定性的能量原理 ($\\delta W$)，这是磁流体动力学 (MHD) 的基石。MHD 和动理学能量贡献的模型虽然经过简化，但具有物理动机。$\\delta W_{\\text{MHD}} = C_s s^2 - C_q (1 - q_0)$ 项正确地表示了磁剪切 $s$ 的稳定效应（$s^2$ 项）以及当安全因子 $q_0$ 低于 1 时内扭曲模的不稳定驱动。动理学项 $\\Re \\delta W_h$ 正确地捕捉了来自高能粒子的共振驱动，该驱动与其压强 $\\beta_h$ 成正比，并依赖于特征粒子进动频率 $\\omega_d$ 与展宽频率 $\\omega_c$ 的比值。$\\omega_d$ 对 $s/q_0$ 的依赖关系也是一个标准近似。该问题在科学上是合理的，可作为计算等离子体物理学中一个有效的教学模型。\n*   **良态的**：所有必需的方程、常数和输入参数都已明确提供。符号 $\\Re \\delta W_h(\\omega)$ 可能暗示存在一个未知的模式频率 $\\omega$，但为该项提供的公式 $- \\frac{C_h \\, \\beta_h}{1 + (\\omega_d/\\omega_c)^2}$ 仅依赖于给定的输入参数 $(\\beta_h, s, q_0)$ 和常数。这是一个有效的简化，即在不显式求解 $\\omega$ 的完整色散关系的情况下检查系统的稳定性。因此，对于任何给定的输入三元组，都可以计算出 $\\delta W_{\\text{tot}}$ 的唯一值。该问题是自洽的，并且在数学上是无歧义的。\n*   **客观性**：该问题使用精确的数学语言和客观标准进行陈述，不含任何主观或基于观点的断言。\n*   **完整性与一致性**：该问题既非欠定也非过约束。所有必要信息均已提供，且不存在内部矛盾。\n*   **真实性**：测试用例的无量纲参数（例如，百分之几的 $\\beta_h$，$s \\sim O(0.1-1)$，$q_0 \\approx 1$）处于研究托卡马克中鱼骨不稳定性的物理现实范围内。\n\n该问题成功满足了有效科学问题的所有标准。\n\n#### 步骤 3：结论与行动\n\n问题陈述被判定为 **有效**。将提供一个解决方案。\n\n### 解决方案\n\n该解决方案涉及通过评估总势能变分 $\\delta W_{\\text{tot}}$ 的符号，来计算一组等离子体参数的稳定性分类。其基本原理是，如果任何小扰动都使其势能增加（即 $\\delta W_{\\text{tot}}  0$），则等离子体平衡是稳定的。\n\n总势能变分由流体 (MHD) 和高能粒子 (动理学) 的贡献之和给出：\n$$\n\\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re \\delta W_h\n$$\n问题为每一项提供了简化的无量纲模型，这些模型依赖于输入参数：高能粒子比压 $\\beta_h$、磁剪切 $s$ 和轴上安全因子 $q_0$。\n\n每个测试用例 $(\\beta_h, s, q_0)$ 的计算步骤如下：\n\n1.  **计算 MHD 能量贡献 $\\delta W_{\\text{MHD}}$**：\n    该项使用提供的公式和常数 ($C_s=0.8$, $C_q=1.0$) 计算：\n    $$\n    \\delta W_{\\text{MHD}}(s, q_0) = 0.8 \\cdot s^2 - 1.0 \\cdot (1 - q_0)\n    $$\n    对于高剪切 $s$ 和 $q_0  1$ 的情况，该项是起稳定作用的。对于 $q_0  1$ 的情况，该项是起不稳作用的，这也是理想内扭曲模不稳定的条件。\n\n2.  **计算高能粒子进动频率 $\\omega_d$**：\n    高能粒子的特征弹跳平均进动漂移频率被建模为剪切和安全因子的函数。使用提供的常数 ($\\omega_0=1.0$)：\n    $$\n    \\omega_d(s, q_0) = 1.0 \\cdot \\frac{s}{q_0} = \\frac{s}{q_0}\n    $$\n\n3.  **计算动理学能量贡献 $\\Re \\delta W_h$**：\n    该项表示模式与高能粒子之间的能量交换。该模型捕捉了这种相互作用的共振性质。使用提供的常数 ($C_h=3.0$, $\\omega_c=0.5$)：\n    $$\n    \\Re \\delta W_h(\\beta_h, \\omega_d) = - \\frac{3.0 \\cdot \\beta_h}{1 + \\left(\\frac{\\omega_d}{0.5}\\right)^2}\n    $$\n    该项始终为非正值，代表来自高能粒子的不稳定或中性贡献。当共振分母最小时（即当 $\\omega_d$ 很小时），驱动达到最大。\n\n4.  **计算总能量变分 $\\delta W_{\\text{tot}}$**：\n    将两项贡献相加：\n    $$\n    \\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re \\delta W_h\n    $$\n\n5.  **进行稳定性分类**：\n    最终分类通过将 $\\delta W_{\\text{tot}}$ 与数值容差 $\\tau = 10^{-6}$ 进行比较来确定：\n    *   如果 $\\delta W_{\\text{tot}}  10^{-6}$，模式是稳定的（输出：$+1$）。\n    *   如果 $|\\delta W_{\\text{tot}}| \\le 10^{-6}$，模式是临界稳定的（输出：$0$）。\n    *   如果 $\\delta W_{\\text{tot}}  -10^{-6}$，模式是不稳定的（输出：$-1$）。\n\n举个例子，让我们计算用例 2 的分类：$(\\beta_h, s, q_0) = (0.03, 0.1, 0.95)$。\n\n*   $\\delta W_{\\text{MHD}} = 0.8 \\cdot (0.1)^2 - 1.0 \\cdot (1 - 0.95) = 0.8 \\cdot 0.01 - 1.0 \\cdot 0.05 = 0.008 - 0.05 = -0.042$。\n*   $\\omega_d = \\frac{0.1}{0.95} \\approx 0.105263$。\n*   $\\Re \\delta W_h = - \\frac{3.0 \\cdot 0.03}{1 + \\left(\\frac{0.105263}{0.5}\\right)^2} = - \\frac{0.09}{1 + (0.210526)^2} \\approx - \\frac{0.09}{1.04432} \\approx -0.086180$。\n*   $\\delta W_{\\text{tot}} = -0.042 + (-0.086180) = -0.128180$。\n*   由于 $-0.128180  -10^{-6}$，分类为不稳定 ($-1$)。\n\n下面的实现中，此过程被系统地应用于所有提供的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stability classification for fishbone instability based on a simplified energy principle.\n    \"\"\"\n    \n    # Define the fixed constants from the problem statement.\n    C_s = 0.8\n    C_q = 1.0\n    C_h = 3.0\n    omega_0 = 1.0\n    omega_c = 0.5\n    tau = 1e-6\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (beta_h, s, q0)\n    test_cases = [\n        (0.005, 0.7, 1.05),  # Case 1\n        (0.03, 0.1, 0.95),    # Case 2\n        (0.03264, 0.3, 1.0),  # Case 3\n        (0.0, 0.0, 0.98),    # Case 4\n        (0.02, 0.05, 1.1),   # Case 5\n        (0.05, 1.0, 0.99),   # Case 6\n        (0.04, 0.2, 0.98),   # Case 7\n    ]\n\n    results = []\n    for case in test_cases:\n        beta_h, s, q0 = case\n        \n        # 1. Calculate the MHD energy contribution, delta_W_MHD.\n        delta_W_MHD = C_s * s**2 - C_q * (1.0 - q0)\n        \n        # 2. Calculate the energetic particle precession frequency, omega_d.\n        # Handle the case where q0 is zero to avoid division by zero, although not present in test cases.\n        if q0 == 0:\n            # Physically, s would likely be zero if q0 is zero at the magnetic axis, making omega_d zero.\n            # Or this regime is ill-defined. For numerical stability we will assume valid inputs where q0 > 0.\n            omega_d = np.inf if s != 0 else 0\n        else:\n            omega_d = omega_0 * s / q0\n            \n        # 3. Calculate the kinetic energy contribution, Re_delta_W_h.\n        resonant_denominator = 1.0 + (omega_d / omega_c)**2\n        Re_delta_W_h = - (C_h * beta_h) / resonant_denominator\n        \n        # 4. Calculate the total energy variation, delta_W_tot.\n        delta_W_tot = delta_W_MHD + Re_delta_W_h\n        \n        # 5. Classify stability based on the sign of delta_W_tot.\n        if delta_W_tot > tau:\n            classification = 1  # Stable\n        elif abs(delta_W_tot) = tau:\n            classification = 0  # Marginal\n        else:\n            classification = -1 # Unstable\n            \n        results.append(classification)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}