{
    "hands_on_practices": [
        {
            "introduction": "The fishbone instability is a resonant phenomenon, and its characteristic frequency is determined by the motion of the energetic particles that drive it. This first exercise provides a practical, order-of-magnitude estimation of the fishbone frequency, building a physical intuition for the timescales involved. By relating the mode frequency $\\omega$ to the energetic ion precession drift frequency $\\omega_d$, you will connect fundamental machine parameters to the dynamics of the instability.",
            "id": "3981017",
            "problem": "Consider a circular tokamak with major radius $R_{0} = 3\\,\\mathrm{m}$, minor radius $a = 1\\,\\mathrm{m}$, and on-axis safety factor $q_{0} = 0.95$. At the mode radius one may take the inverse aspect ratio to be $\\epsilon = r/R_{0} = 0.3$. A population of energetic trapped deuterons of energy $E_{h} = 80\\,\\mathrm{keV}$ interacts resonantly with the $n=1$, $m=1$ internal kink mode (the fishbone instability). For trapped ions, the drift-precession frequency is of the same order as the bounce frequency multiplied by the inverse aspect ratio, so use the scaling $\\omega_{d} \\sim \\epsilon\\,\\omega_{b}$. To form an order-of-magnitude estimate consistent with circular geometry, approximate the bounce angular frequency by the ratio of a characteristic poloidal excursion length to the energetic-ion speed, specifically $\\omega_{b} \\sim v/(q_{0} R_{0})$, where $v$ is the deuteron speed obtained from its kinetic energy via the standard mechanical relation between energy and speed. Take the deuteron mass as $m_{d}$ and the elementary charge as $e$, with the electron volt (eV) defined so that $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$. Using these foundations and approximations, estimate the fishbone angular frequency by setting $\\omega \\approx \\omega_{d}$.\n\nCompute the numerical value of $\\omega$ and express it in radians per second. Round your final answer to three significant figures.",
            "solution": "The user wants to estimate the fishbone instability angular frequency, $\\omega$, based on a set of provided scaling relations and parameters for a circular tokamak.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n-   Major radius: $R_{0} = 3\\,\\mathrm{m}$\n-   Minor radius: $a = 1\\,\\mathrm{m}$\n-   On-axis safety factor: $q_{0} = 0.95$\n-   Inverse aspect ratio at mode radius: $\\epsilon = r/R_{0} = 0.3$\n-   Energetic deuteron kinetic energy: $E_{h} = 80\\,\\mathrm{keV}$\n-   Instability mode numbers: $n=1$, $m=1$ internal kink mode\n-   Scaling for drift-precession frequency: $\\omega_{d} \\sim \\epsilon\\,\\omega_{b}$\n-   Approximation for bounce angular frequency: $\\omega_{b} \\sim v/(q_{0} R_{0})$\n-   Deuteron speed relationship: $v$ is obtained from $E_{h}$ via the standard mechanical relation.\n-   Constants and definitions: deuteron mass $m_{d}$, elementary charge $e$, $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$.\n-   Condition for fishbone frequency: $\\omega \\approx \\omega_{d}$\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is well-grounded in the established physics of magnetohydrodynamic (MHD) instabilities in tokamak plasmas, specifically the fishbone instability driven by resonant interaction with energetic particles. All concepts, such as safety factor, aspect ratio, drift-precession frequency, and bounce frequency, are standard in fusion plasma physics. The numerical values are realistic for a modern tokamak. The provided scaling relations are order-of-magnitude approximations commonly used in pedagogical contexts or for initial estimates.\n-   **Well-Posedness**: The problem is well-posed. It provides a clear set of instructions and a chain of approximations that lead to a unique numerical answer. It contains sufficient information to perform the calculation.\n-   **Objectivity**: The problem is stated in precise, objective language without any subjective or opinion-based content.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. I will proceed with the solution.\n\nThe goal is to compute the numerical value of the fishbone angular frequency, $\\omega$. The problem provides a sequence of approximations to achieve this.\n\nThe fishbone mode frequency is set to be approximately equal to the energetic ion drift-precession frequency, $\\omega_{d}$:\n$$\n\\omega \\approx \\omega_{d}\n$$\nThe drift-precession frequency, $\\omega_{d}$, is related to the bounce frequency, $\\omega_{b}$, through the given scaling with the inverse aspect ratio, $\\epsilon$:\n$$\n\\omega_{d} \\sim \\epsilon\\,\\omega_{b}\n$$\nThe bounce angular frequency, $\\omega_{b}$, is approximated using the deuteron's speed $v$, the on-axis safety factor $q_{0}$, and the major radius $R_{0}$:\n$$\n\\omega_{b} \\sim \\frac{v}{q_{0} R_{0}}\n$$\nCombining these relationships, we can express the fishbone frequency $\\omega$ as:\n$$\n\\omega \\approx \\epsilon \\left( \\frac{v}{q_{0} R_{0}} \\right) = \\frac{\\epsilon v}{q_{0} R_{0}}\n$$\nTo use this formula, we must first determine the speed, $v$, of the deuterons from their kinetic energy, $E_{h}$. The non-relativistic relationship between kinetic energy and speed is:\n$$\nE_{h} = \\frac{1}{2} m_{d} v^2\n$$\nwhere $m_{d}$ is the mass of a deuteron. Solving for $v$, we get:\n$$\nv = \\sqrt{\\frac{2 E_{h}}{m_{d}}}\n$$\nSubstituting this expression for $v$ into our equation for $\\omega$ yields the final formula for the estimate:\n$$\n\\omega \\approx \\frac{\\epsilon}{q_{0} R_{0}} \\sqrt{\\frac{2 E_{h}}{m_{d}}}\n$$\nNow, we substitute the given numerical values into this expression. The parameters are:\n-   $\\epsilon = 0.3$\n-   $q_{0} = 0.95$\n-   $R_{0} = 3\\,\\mathrm{m}$\n-   $E_{h} = 80\\,\\mathrm{keV}$\n\nWe also need the values of the physical constants in SI units:\n-   Deuteron mass: $m_{d} \\approx 3.34358 \\times 10^{-27}\\,\\mathrm{kg}$\n-   Elementary charge: $e \\approx 1.60218 \\times 10^{-19}\\,\\mathrm{C}$\n\nThe kinetic energy must be converted from kilo-electron-volts ($keV$) to Joules ($J$):\n$$\nE_{h} = 80\\,\\mathrm{keV} = 80 \\times 10^{3}\\,\\mathrm{eV} = (80 \\times 10^{3}) \\times (1.60218 \\times 10^{-19}\\,\\mathrm{J}) = 1.281744 \\times 10^{-14}\\,\\mathrm{J}\n$$\nFirst, let's calculate the deuteron speed $v$:\n$$\nv = \\sqrt{\\frac{2 \\times (1.281744 \\times 10^{-14}\\,\\mathrm{J})}{3.34358 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx \\sqrt{7.6680 \\times 10^{12}\\,\\mathrm{m^2/s^2}} \\approx 2.7691 \\times 10^{6}\\,\\mathrm{m/s}\n$$\nNow, we can compute the angular frequency $\\omega$:\n$$\n\\omega \\approx \\frac{0.3}{0.95 \\times 3\\,\\mathrm{m}} \\times (2.7691 \\times 10^{6}\\,\\mathrm{m/s})\n$$\n$$\n\\omega \\approx \\frac{0.3}{2.85} \\times (2.7691 \\times 10^{6}\\,\\mathrm{s^{-1}}) \\approx 0.10526 \\times (2.7691 \\times 10^{6}\\,\\mathrm{s^{-1}})\n$$\n$$\n\\omega \\approx 2.9148 \\times 10^{5}\\,\\mathrm{rad/s}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\omega \\approx 2.91 \\times 10^{5}\\,\\mathrm{rad/s}\n$$\nThis is the estimated angular frequency of the fishbone instability under the given approximations.",
            "answer": "$$\\boxed{2.91 \\times 10^5}$$"
        },
        {
            "introduction": "Beyond the frequency, the most critical question is whether the instability will grow. This is determined by a balance of stabilizing and destabilizing forces, mathematically captured by the energy principle, $\\delta W = 0$. This practice delves into the core of stability analysis by asking you to calculate the critical threshold for the energetic particle pressure, $\\beta_h^{\\mathrm{crit}}$. By solving the marginal stability condition, you will gain insight into how the competition between stabilizing MHD effects and the kinetic drive from fast ions determines the onset of the fishbone mode.",
            "id": "3980962",
            "problem": "A circular, large-aspect-ratio tokamak with major radius $R_0=3.0\\,\\mathrm{m}$ and toroidal magnetic field $B_0=3.0\\,\\mathrm{T}$ has a $q=1$ surface located at minor radius $r_1=0.60\\,\\mathrm{m}$. Consider the $m=n=1$ internal kink (fishbone) stability in the framework of the ideal magnetohydrodynamics (MHD) energy principle augmented by a reduced drift-kinetic fast-ion contribution. The total potential energy variation is written as $\\delta W=\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)$. The ideal MHD contribution, normalized to the magnetic energy inside the $q=1$ volume, is given by\n$$\n\\frac{\\delta W_{\\mathrm{MHD}}}{W_{B1}}=C_{\\mathrm{MHD}},\n$$\nwith $C_{\\mathrm{MHD}}=1.5\\times 10^{-3}$ and $W_{B1}=\\frac{B_0^2}{2\\mu_0}V_1$, where $\\mu_0$ is the vacuum permeability and $V_1$ is the volume inside $r_1$ (you may leave $V_1$ implicit since it will cancel).\n\nFor an isotropic, monoenergetic fast-ion population, model the real part of the fast-ion kinetic contribution as\n$$\n\\frac{\\Re\\,\\delta W_h(\\omega)}{W_{B1}} \\approx -\\,\\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h,\n$$\nwhere $\\Lambda=1.5$ encapsulates orbit averaging and mode-structure factors, $\\omega$ is the mode frequency taken equal to the fast-ion precession frequency $\\omega=\\omega_d=6.0\\times 10^{3}\\,\\mathrm{s}^{-1}$, and $\\omega_{\\ast h}=2.0\\times 10^{3}\\,\\mathrm{s}^{-1}$ is the fast-ion diamagnetic frequency. The fast-ion beta is defined by\n$$\n\\beta_h=\\frac{2\\mu_0 p_h}{B_0^2},\n$$\nwith fast-ion pressure $p_h$ obtained from the ideal-gas relation for an isotropic monoenergetic population,\n$$\np_h=\\frac{2}{3}n_h E_h,\n$$\nwhere $n_h$ is the fast-ion number density and $E_h$ is the average kinetic energy per fast ion.\n\nLet the fast-ion parameters be $n_h=3.0\\times 10^{18}\\,\\mathrm{m}^{-3}$ and $E_h=80\\,\\mathrm{keV}$. Using only the stated definitions and models, determine the threshold fast-ion beta $\\beta_h^{\\mathrm{crit}}$ at which the marginal stability condition $\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)=0$ is satisfied. Express the final answer for $\\beta_h^{\\mathrm{crit}}$ as a dimensionless decimal rounded to four significant figures. Do not report any intermediate quantities.",
            "solution": "The problem requires the determination of the threshold fast-ion beta, $\\beta_h^{\\mathrm{crit}}$, for the onset of an $m=n=1$ internal kink (fishbone) instability in a tokamak. A rigorous validation of the problem statement is performed first.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe following quantities and relations are provided in the problem statement:\n- Major radius: $R_0=3.0\\,\\mathrm{m}$\n- Toroidal magnetic field on-axis: $B_0=3.0\\,\\mathrm{T}$\n- Minor radius of the $q=1$ rational surface: $r_1=0.60\\,\\mathrm{m}$\n- Mode numbers: $m=1$, $n=1$\n- Total potential energy variation: $\\delta W=\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)$\n- Normalized ideal MHD potential energy contribution: $\\frac{\\delta W_{\\mathrm{MHD}}}{W_{B1}}=C_{\\mathrm{MHD}}$\n- Numerical value for the MHD contribution constant: $C_{\\mathrm{MHD}}=1.5\\times 10^{-3}$\n- Normalizing magnetic energy: $W_{B1}=\\frac{B_0^2}{2\\mu_0}V_1$, where $\\mu_0$ is the vacuum permeability and $V_1$ is the volume inside the $r_1$ surface.\n- Model for the real part of the fast-ion kinetic contribution: $\\frac{\\Re\\,\\delta W_h(\\omega)}{W_{B1}} \\approx -\\,\\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h$\n- Orbit-averaging and mode-structure factor: $\\Lambda=1.5$\n- Mode frequency (equal to fast-ion precession frequency): $\\omega=\\omega_d=6.0\\times 10^{3}\\,\\mathrm{s}^{-1}$\n- Fast-ion diamagnetic frequency: $\\omega_{\\ast h}=2.0\\times 10^{3}\\,\\mathrm{s}^{-1}$\n- Definition of fast-ion beta: $\\beta_h=\\frac{2\\mu_0 p_h}{B_0^2}$\n- Fast-ion pressure from ideal-gas relation: $p_h=\\frac{2}{3}n_h E_h$\n- Fast-ion number density: $n_h=3.0\\times 10^{18}\\,\\mathrm{m}^{-3}$\n- Average kinetic energy per fast ion: $E_h=80\\,\\mathrm{keV}$\n- Marginal stability condition: $\\delta W_{\\mathrm{MHD}}+\\Re\\,\\delta W_h(\\omega)=0$\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is assessed against the required criteria:\n- **Scientifically Grounded**: The problem describes the fishbone instability using a standard model in plasma physics, combining the ideal MHD energy principle with a drift-kinetic treatment of energetic particles. The phenomena and the equations used are well-established in fusion science. All physical parameters are within a realistic range for a large tokamak. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a clear objective: to find the value of $\\beta_h^{\\mathrm{crit}}$ that satisfies the marginal stability condition. It supplies a sufficient set of equations and parameters to achieve this.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language.\n- **Completeness and Consistency**: The problem asks for the calculation of the threshold beta, $\\beta_h^{\\mathrm{crit}}$. The equation for marginal stability can be solved for this threshold using a subset of the provided parameters ($C_{\\mathrm{MHD}}$, $\\Lambda$, $r_1$, $R_0$, $\\omega$, $\\omega_{\\ast h}$). The problem also provides parameters to calculate the *actual* fast-ion beta present in the plasma ($n_h$, $E_h$, $B_0$, $\\mu_0$). These parameters are extraneous to the question of determining the *threshold* value. A threshold is a property of the system's stability boundaries, independent of the actual state of the plasma. The presence of this extra information does not create a contradiction or make the problem unsolvable; it merely requires the solver to correctly identify the necessary information. The problem is therefore self-contained and consistent.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is scientifically sound, well-posed, and objective. The presence of extraneous data does not invalidate it. The solution process will now proceed.\n\n### Solution Derivation\n\nThe analysis begins with the marginal stability condition, which defines the threshold for the instability. At this threshold, the total potential energy variation $\\delta W$ is zero.\n$$\n\\delta W = \\delta W_{\\mathrm{MHD}} + \\Re\\,\\delta W_h(\\omega) = 0\n$$\nThe problem provides expressions for both terms normalized to the magnetic energy $W_{B1}$ contained within the $q=1$ surface. It is convenient to work with the normalized equation by dividing the stability condition by $W_{B1}$:\n$$\n\\frac{\\delta W_{\\mathrm{MHD}}}{W_{B1}} + \\frac{\\Re\\,\\delta W_h(\\omega)}{W_{B1}} = 0\n$$\nSubstituting the given models for these terms:\n$$\nC_{\\mathrm{MHD}} - \\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h = 0\n$$\nThe problem asks for the threshold fast-ion beta, denoted $\\beta_h^{\\mathrm{crit}}$, at which this marginal stability condition is met. We therefore solve the above equation for $\\beta_h$, which we label $\\beta_h^{\\mathrm{crit}}$:\n$$\nC_{\\mathrm{MHD}} = \\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)\\beta_h^{\\mathrm{crit}}\n$$\nRearranging the equation to isolate $\\beta_h^{\\mathrm{crit}}$ yields the analytical expression for the threshold:\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{C_{\\mathrm{MHD}}}{\\Lambda\\,\\frac{r_1}{R_0}\\left(1-\\frac{\\omega_{\\ast h}}{\\omega}\\right)}\n$$\nNote that the calculation of this threshold value depends on the MHD stability properties ($C_{\\mathrm{MHD}}$), geometric factors ($r_1/R_0$), mode-particle interaction physics ($\\Lambda$), and characteristic frequencies ($\\omega$, $\\omega_{\\ast h}$). It does not depend on the specific fast-ion population parameters ($n_h$, $E_h$) given in the problem, which would be used to calculate the *actual* $\\beta_h$ in the plasma, not the stability threshold.\n\nWe now substitute the numerical values provided into this expression:\n- $C_{\\mathrm{MHD}} = 1.5 \\times 10^{-3}$\n- $\\Lambda = 1.5$\n- $r_1 = 0.60\\,\\mathrm{m}$\n- $R_0 = 3.0\\,\\mathrm{m}$\n- $\\omega_{\\ast h} = 2.0 \\times 10^{3}\\,\\mathrm{s}^{-1}$\n- $\\omega = 6.0 \\times 10^{3}\\,\\mathrm{s}^{-1}$\n\nFirst, we calculate the dimensionless ratios:\nThe aspect ratio of the $q=1$ surface is:\n$$\n\\frac{r_1}{R_0} = \\frac{0.60}{3.0} = 0.2\n$$\nThe ratio of the diamagnetic frequency to the mode frequency is:\n$$\n\\frac{\\omega_{\\ast h}}{\\omega} = \\frac{2.0 \\times 10^{3}\\,\\mathrm{s}^{-1}}{6.0 \\times 10^{3}\\,\\mathrm{s}^{-1}} = \\frac{1}{3}\n$$\nNow, substitute these into the expression for $\\beta_h^{\\mathrm{crit}}$:\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{1.5 \\times 0.2 \\times \\left(1-\\frac{1}{3}\\right)}\n$$\nSimplify the expression in the denominator:\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{1.5 \\times 0.2 \\times \\frac{2}{3}}\n$$\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{1.5 \\times \\frac{1}{5} \\times \\frac{2}{3}} = \\frac{1.5 \\times 10^{-3}}{\\frac{3}{2} \\times \\frac{1}{5} \\times \\frac{2}{3}} = \\frac{1.5 \\times 10^{-3}}{\\frac{1}{5}}\n$$\n$$\n\\beta_h^{\\mathrm{crit}} = \\frac{1.5 \\times 10^{-3}}{0.2} = 7.5 \\times 10^{-3}\n$$\nAs a decimal, this is $0.0075$. The problem requests the answer as a dimensionless decimal rounded to four significant figures.\n$$\n\\beta_h^{\\mathrm{crit}} = 0.007500\n$$",
            "answer": "$$\\boxed{0.007500}$$"
        },
        {
            "introduction": "Analytical thresholds provide key insights, but real-world analysis often requires exploring a wide range of operating conditions, and computational models excel at this task. This final exercise bridges the gap between theory and practice by asking you to translate the energy principle into a computational model. By classifying different plasma scenarios based on the sign of the total potential energy variation $\\delta W_{\\text{tot}}$, you will construct a rudimentary stability map, a fundamental tool in both theoretical research and experimental planning.",
            "id": "3980960",
            "problem": "You are tasked with constructing a parametric stability map for the fishbone instability in a tokamak plasma using the energy principle. The energy principle states that the variation of the potential energy, denoted by $\\delta W$, can be decomposed into a Magnetohydrodynamics (MHD) component and a kinetic energetic particle component. The internal kink fishbone mode is stable if the total energy variation is positive, marginal if it is zero, and unstable if it is negative. The goal is to compute the sign of the total energy variation across a set of parameter points in the three-dimensional space of $(\\beta_h, s, q_0)$, where $\\beta_h$ is the dimensionless energetic particle beta (ratio of energetic particle pressure to magnetic pressure), $s$ is the magnetic shear (dimensionless), and $q_0$ is the on-axis safety factor (dimensionless).\n\nStart from the energy principle and core definitions:\n- The total potential energy variation is $\\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re\\,\\delta W_h(\\omega)$.\n- Magnetohydrodynamics (MHD) denotes the macroscopic plasma response, while the energetic particle term arises from resonant interaction with the mode.\n\nAdopt the following scientifically plausible, simplified, and dimensionless models that capture the qualitative physics of internal kink fishbones:\n1. The MHD contribution is modeled as\n$$\n\\delta W_{\\text{MHD}}(s, q_0) = C_s s^2 - C_q (1 - q_0),\n$$\nwith positive stiffness coefficient $C_s$ and kink-drive coefficient $C_q$. This form reflects stabilizing shear and destabilization when $q_0  1$.\n\n2. The energetic particle real contribution is modeled as a resonance-broadened drive\n$$\n\\Re\\,\\delta W_h(\\omega) = - \\frac{C_h \\, \\beta_h}{1 + \\left(\\frac{\\omega_d}{\\omega_c}\\right)^2},\n$$\nwhere $\\omega_d$ is the bounce-averaged precession frequency approximated as\n$$\n\\omega_d(s, q_0) = \\omega_0 \\frac{s}{q_0},\n$$\nand $\\omega_c$ is a characteristic broadening frequency accounting for finite orbit width and distribution effects. The negative sign reflects that the energetic particles drive the mode when near resonance.\n\nAll quantities are normalized and dimensionless. Use the following fixed constants in your implementation:\n- $C_s = 0.8$,\n- $C_q = 1.0$,\n- $C_h = 3.0$,\n- $\\omega_0 = 1.0$,\n- $\\omega_c = 0.5$.\n\nDefine the stability classification based on the sign of $\\delta W_{\\text{tot}}$ with a small numerical tolerance $\\tau$ to detect marginality:\n- If $\\delta W_{\\text{tot}}  \\tau$, classify as stable with output integer $+1$.\n- If $|\\delta W_{\\text{tot}}| \\le \\tau$, classify as marginal with output integer $0$.\n- If $\\delta W_{\\text{tot}}  -\\tau$, classify as unstable with output integer $-1$.\n\nUse $\\tau = 10^{-6}$.\n\nYour program must compute the classification for each of the following test cases, expressed as $(\\beta_h, s, q_0)$ triplets:\n- Case $1$: $(0.005, 0.7, 1.05)$,\n- Case $2$: $(0.03, 0.1, 0.95)$,\n- Case $3$: $(0.03264, 0.3, 1.0)$,\n- Case $4$: $(0.0, 0.0, 0.98)$,\n- Case $5$: $(0.02, 0.05, 1.1)$,\n- Case $6$: $(0.05, 1.0, 0.99)$,\n- Case $7$: $(0.04, 0.2, 0.98)$.\n\nAll inputs are dimensionless as specified; no physical units are required in the output. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases (e.g., $[1,-1,0,1]$).",
            "solution": "The problem statement is first validated against the specified criteria.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n\nThe following data and definitions are extracted verbatim from the problem statement:\n\n*   **Objective**: Construct a parametric stability map for the fishbone instability.\n*   **Parameter Space**: $(\\beta_h, s, q_0)$, where $\\beta_h$ is the dimensionless energetic particle beta, $s$ is the magnetic shear, and $q_0$ is the on-axis safety factor.\n*   **Total Potential Energy Variation**: $\\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re\\,\\delta W_h(\\omega)$.\n*   **MHD Contribution Model**:\n    $$\n    \\delta W_{\\text{MHD}}(s, q_0) = C_s s^2 - C_q (1 - q_0)\n    $$\n*   **Energetic Particle Contribution Model**:\n    $$\n    \\Re\\,\\delta W_h(\\omega) = - \\frac{C_h \\, \\beta_h}{1 + \\left(\\frac{\\omega_d}{\\omega_c}\\right)^2}\n    $$\n*   **Precession Frequency Model**:\n    $$\n    \\omega_d(s, q_0) = \\omega_0 \\frac{s}{q_0}\n    $$\n*   **Fixed Constants**:\n    *   $C_s = 0.8$\n    *   $C_q = 1.0$\n    *   $C_h = 3.0$\n    *   $\\omega_0 = 1.0$\n    *   $\\omega_c = 0.5$\n*   **Stability Classification Criteria**:\n    *   Stable ($+1$): if $\\delta W_{\\text{tot}}  \\tau$\n    *   Marginal ($0$): if $|\\delta W_{\\text{tot}}| \\le \\tau$\n    *   Unstable ($-1$): if $\\delta W_{\\text{tot}}  -\\tau$\n*   **Numerical Tolerance**: $\\tau = 10^{-6}$.\n*   **Test Cases $(\\beta_h, s, q_0)$**:\n    *   Case $1$: $(0.005, 0.7, 1.05)$\n    *   Case $2$: $(0.03, 0.1, 0.95)$\n    *   Case $3$: $(0.03264, 0.3, 1.0)$\n    *   Case $4$: $(0.0, 0.0, 0.98)$\n    *   Case $5$: $(0.02, 0.05, 1.1)$\n    *   Case $6$: $(0.05, 1.0, 0.99)$\n    *   Case $7$: $(0.04, 0.2, 0.98)$\n\n#### Step 2: Validate Using Extracted Givens\n\nThe problem is assessed based on the provided validation criteria.\n\n*   **Scientifically Grounded**: The problem is based on the energy principle ($\\delta W$) for plasma stability, a cornerstone of magnetohydrodynamics (MHD). The models for the MHD and kinetic energy contributions, while simplified, are physically motivated. The term $\\delta W_{\\text{MHD}} = C_s s^2 - C_q (1 - q_0)$ correctly represents the stabilizing effect of magnetic shear $s$ ($s^2$ term) and the destabilizing drive of the internal kink mode when the safety factor $q_0$ is below $1$. The kinetic term $\\Re\\,\\delta W_h$ correctly captures a resonant drive from energetic particles, proportional to their pressure $\\beta_h$ and dependent on the ratio of the characteristic particle precession frequency $\\omega_d$ to a broadening frequency $\\omega_c$. The dependence of $\\omega_d$ on $s/q_0$ is also a standard approximation. The problem is scientifically plausible and serves as a valid educational model in computational plasma physics.\n*   **Well-Posed**: All required equations, constants, and input parameters are explicitly provided. The notation $\\Re\\,\\delta W_h(\\omega)$ could suggest an unknown mode frequency $\\omega$, but the formula provided for this term, $- \\frac{C_h \\, \\beta_h}{1 + (\\omega_d/\\omega_c)^2}$, depends only on the given input parameters $(\\beta_h, s, q_0)$ and constants. This is a valid simplification where the system's stability is checked without explicitly solving the full dispersion relation for $\\omega$. Thus, for any given input triplet, a unique value for $\\delta W_{\\text{tot}}$ can be calculated. The problem is self-contained and mathematically unambiguous.\n*   **Objective**: The problem is stated using precise mathematical language and objective criteria, free of any subjective or opinion-based assertions.\n*   **Completeness and Consistency**: The problem is not underspecified or overconstrained. All necessary information is provided, and there are no internal contradictions.\n*   **Realism**: The dimensionless parameters for the test cases (e.g., $\\beta_h$ of a few percent, $s \\sim O(0.1-1)$, $q_0 \\approx 1$) are within physically realistic ranges for studying fishbone instabilities in tokamaks.\n\nThe problem successfully meets all criteria for a valid scientific problem.\n\n#### Step 3: Verdict and Action\n\nThe problem statement is declared **valid**. A solution will be provided.\n\n### Solution\n\nThe solution involves computing the stability classification for a set of plasma parameters by evaluating the sign of the total potential energy variation, $\\delta W_{\\text{tot}}$. The fundamental principle is that a plasma equilibrium is stable if any small perturbation increases its potential energy, i.e., $\\delta W_{\\text{tot}}  0$.\n\nThe total potential energy variation is given by the sum of the fluid (MHD) and energetic particle (kinetic) contributions:\n$$\n\\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re\\,\\delta W_h\n$$\nThe problem provides simplified, dimensionless models for each term that depend on the input parameters: the energetic particle beta $\\beta_h$, the magnetic shear $s$, and the on-axis safety factor $q_0$.\n\nThe computational procedure for each test case $(\\beta_h, s, q_0)$ is as follows:\n\n1.  **Calculate the MHD Energy Contribution, $\\delta W_{\\text{MHD}}$**:\n    This term is calculated using the provided formula and constants ($C_s=0.8$, $C_q=1.0$):\n    $$\n    \\delta W_{\\text{MHD}}(s, q_0) = 0.8 \\cdot s^2 - 1.0 \\cdot (1 - q_0)\n    $$\n    This term is stabilizing for high shear $s$ and for $q_0  1$. It is destabilizing for $q_0  1$, which is the condition for the ideal internal kink mode instability.\n\n2.  **Calculate the Energetic Particle Precession Frequency, $\\omega_d$**:\n    The characteristic bounce-averaged precession drift frequency of the energetic particles is modeled as a function of shear and safety factor. Using the provided constants ($\\omega_0=1.0$):\n    $$\n    \\omega_d(s, q_0) = 1.0 \\cdot \\frac{s}{q_0} = \\frac{s}{q_0}\n    $$\n\n3.  **Calculate the Kinetic Energy Contribution, $\\Re\\,\\delta W_h$**:\n    This term represents the energy exchange between the mode and the energetic particles. The model captures the resonant nature of this interaction. Using the provided constants ($C_h=3.0$, $\\omega_c=0.5$):\n    $$\n    \\Re\\,\\delta W_h(\\beta_h, \\omega_d) = - \\frac{3.0 \\cdot \\beta_h}{1 + \\left(\\frac{\\omega_d}{0.5}\\right)^2}\n    $$\n    This term is always non-positive, representing a destabilizing or neutral contribution from the energetic particles. The drive is maximal when the resonant denominator is minimal, i.e., when $\\omega_d$ is small.\n\n4.  **Calculate the Total Energy Variation, $\\delta W_{\\text{tot}}$**:\n    The two contributions are summed:\n    $$\n    \\delta W_{\\text{tot}} = \\delta W_{\\text{MHD}} + \\Re\\,\\delta W_h\n    $$\n\n5.  **Classify Stability**:\n    The final classification is determined by comparing $\\delta W_{\\text{tot}}$ to the numerical tolerance $\\tau = 10^{-6}$:\n    *   If $\\delta W_{\\text{tot}}  10^{-6}$, the mode is stable (output: $+1$).\n    *   If $|\\delta W_{\\text{tot}}| \\le 10^{-6}$, the mode is marginal (output: $0$).\n    *   If $\\delta W_{\\text{tot}}  -10^{-6}$, the mode is unstable (output: $-1$).\n\nAs an example, let us compute the classification for Case 2: $(\\beta_h, s, q_0) = (0.03, 0.1, 0.95)$.\n\n*   $\\delta W_{\\text{MHD}} = 0.8 \\cdot (0.1)^2 - 1.0 \\cdot (1 - 0.95) = 0.8 \\cdot 0.01 - 1.0 \\cdot 0.05 = 0.008 - 0.05 = -0.042$.\n*   $\\omega_d = \\frac{0.1}{0.95} \\approx 0.105263$.\n*   $\\Re\\,\\delta W_h = - \\frac{3.0 \\cdot 0.03}{1 + \\left(\\frac{0.105263}{0.5}\\right)^2} = - \\frac{0.09}{1 + (0.210526)^2} \\approx - \\frac{0.09}{1.04432} \\approx -0.086180$.\n*   $\\delta W_{\\text{tot}} = -0.042 + (-0.086180) = -0.128180$.\n*   Since $-0.128180  -10^{-6}$, the classification is unstable ($-1$).\n\nThis procedure is systematically applied to all provided test cases in the implementation below.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stability classification for fishbone instability based on a simplified energy principle.\n    \"\"\"\n    \n    # Define the fixed constants from the problem statement.\n    C_s = 0.8\n    C_q = 1.0\n    C_h = 3.0\n    omega_0 = 1.0\n    omega_c = 0.5\n    tau = 1e-6\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (beta_h, s, q0)\n    test_cases = [\n        (0.005, 0.7, 1.05),  # Case 1\n        (0.03, 0.1, 0.95),    # Case 2\n        (0.03264, 0.3, 1.0),  # Case 3\n        (0.0, 0.0, 0.98),    # Case 4\n        (0.02, 0.05, 1.1),   # Case 5\n        (0.05, 1.0, 0.99),   # Case 6\n        (0.04, 0.2, 0.98),   # Case 7\n    ]\n\n    results = []\n    for case in test_cases:\n        beta_h, s, q0 = case\n        \n        # 1. Calculate the MHD energy contribution, delta_W_MHD.\n        delta_W_MHD = C_s * s**2 - C_q * (1.0 - q0)\n        \n        # 2. Calculate the energetic particle precession frequency, omega_d.\n        # Handle the case where q0 is zero to avoid division by zero, although not present in test cases.\n        if q0 == 0:\n            # Physically, s would likely be zero if q0 is zero at the magnetic axis, making omega_d zero.\n            # Or this regime is ill-defined. For numerical stability we set it to a large number or zero.\n            # Based on the formula s/q0, for s0 this would diverge. We will assume valid inputs where q0  0.\n            omega_d = np.inf if s != 0 else 0\n        else:\n            omega_d = omega_0 * s / q0\n            \n        # 3. Calculate the kinetic energy contribution, Re_delta_W_h.\n        resonant_denominator = 1.0 + (omega_d / omega_c)**2\n        Re_delta_W_h = - (C_h * beta_h) / resonant_denominator\n        \n        # 4. Calculate the total energy variation, delta_W_tot.\n        delta_W_tot = delta_W_MHD + Re_delta_W_h\n        \n        # 5. Classify stability based on the sign of delta_W_tot.\n        if delta_W_tot  tau:\n            classification = 1  # Stable\n        elif abs(delta_W_tot) = tau:\n            classification = 0  # Marginal\n        else:\n            classification = -1 # Unstable\n            \n        results.append(classification)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}