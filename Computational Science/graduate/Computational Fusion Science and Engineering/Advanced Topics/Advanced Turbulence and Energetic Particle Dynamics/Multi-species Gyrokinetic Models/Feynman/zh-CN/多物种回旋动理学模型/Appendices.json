{
    "hands_on_practices": [
        {
            "introduction": "回旋平均是回旋动理学模型的基石，它通过数学方法捕捉了带电粒子因其快速的回旋运动而“平滑掉”小尺度电场的物理效应。本练习将从第一性原理出发，推导描述这一效应的关键数学函数——零阶贝塞尔函数 $J_0(k_{\\perp}\\rho_s)$。通过计算并解释不同参数下的函数值，我们将量化这一效应，并揭示为何电子和离子等不同粒子种类对同一等离子体波会产生截然不同的响应 。",
            "id": "4016812",
            "problem": "在由多组分回旋动理学模型描述的静电、无碰撞、均匀磁化等离子体中，组分与波矢大小为 $k_{\\perp}$ 的垂直涨落的耦合，由平面波在组分 $s$ 的半径为 $\\rho_{s}$ 的回旋轨道上的回旋平均所控制。从第一性原理出发，回旋平均是在固定的 $\\rho_{s}$ 和回旋相位角 $\\theta$ 的圆形轨道上，对 $\\exp(i \\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho})$ 进行的回旋相位平均，其中 $\\boldsymbol{\\rho}$ 是拉莫尔位移矢量。对于电荷数为 $Z_{s}$、电荷大小为 $e$、磁场大小为 $B$、质量为 $m_{s}$、温度为 $T_{s}$ 的组分 $s$，使用基本定义 $\\rho_{s} = v_{\\mathrm{th},s}/\\Omega_{s}$，$v_{\\mathrm{th},s} = \\sqrt{2 T_{s}/m_{s}}$ 和 $\\Omega_{s} = Z_{s} e B/m_{s}$。\n\n1) 通过其定义计算回旋相位平均 $\\langle \\exp(i \\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho}) \\rangle_{\\theta}$，推导出作为 $k_{\\perp}\\rho_{s}$ 函数的回旋平均因子的解析形式。\n\n2) 对于电荷数为 $Z_{i}=1$ 的单电荷离子组分，计算在代表性的离子尺度自变量 $k_{\\perp} \\rho_{i} = 0.1$、$0.5$ 和 $1.0$ 下的离子回旋平均因子的值。将每个值四舍五入到四位有效数字。\n\n3) 对于电荷数为 $Z_{e}=-1$ 的电子，在 $T_{e}=T_{i}$ 和离子组分为质子 ($m_{i}=m_{p}$) 的假设下，用 $m_{e}$ 和 $m_{i}$ 表示比率 $\\rho_{e}/\\rho_{i}$。利用这个结果，确定当 $k_{\\perp}\\rho_{e} = 1$ 时 $k_{\\perp}\\rho_{i}$ 的值。然后计算在 $k_{\\perp}\\rho_{e} = 1$ 和 $k_{\\perp}\\rho_{e} = 2$ 时的电子回旋平均因子，每个值都四舍五入到四位有效数字。\n\n4) 仅使用第 1)–3) 部分的结果和特殊函数的基本性质，简要解释在回旋动理学模型中，为何以及如何使电子在 $k_{\\perp}\\rho_{e} \\gtrsim 1$ 的尺度上与静电涨落解耦。作为你最终的定量陈述，提供当自变量 $x \\equiv k_{\\perp}\\rho_{s} \\to \\infty$ 很大时，回旋平均因子关于 $x$ 的主阶渐近表达式。你的最终答案必须是这个无单位的闭合形式解析表达式。",
            "solution": "问题陈述经评估是科学上合理、良定且客观的。它提出了一个计算聚变科学中的标准、自洽的问题，该问题基于回旋动理学的基本原理。所提供的定义和条件是一致且充分的，足以推导出唯一且有意义的解。因此，该问题是有效的，下面将给出完整解答。\n\n1) 回旋平均因子定义为，对于固定的拉莫尔半径 $\\rho_{s}$，平面波相位因子 $\\exp(i \\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho})$ 在拉莫尔位移矢量 $\\boldsymbol{\\rho}$ 所有可能朝向上的回旋相位平均。该平均是对回旋相位角 $\\theta$ 进行的。回旋平均记作 $\\langle \\exp(i \\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho}) \\rangle_{\\theta}$。\n\n让我们建立一个坐标系，其中均匀磁场 $\\boldsymbol{B}$ 沿 $\\hat{z}$ 轴方向。波矢 $\\boldsymbol{k}_{\\perp}$ 和拉莫尔位移矢量 $\\boldsymbol{\\rho}$ 位于垂直于 $\\boldsymbol{B}$ 的平面内，即 $xy$-平面。不失一般性，我们可以调整坐标系，使 $\\boldsymbol{k}_{\\perp}$ 指向 $\\hat{x}$ 轴方向，因此 $\\boldsymbol{k}_{\\perp} = k_{\\perp} \\hat{x}$，其中 $k_{\\perp} = |\\boldsymbol{k}_{\\perp}|$。\n\n拉莫尔位移矢量 $\\boldsymbol{\\rho}$ 在 $xy$-平面内描绘出一个圆形路径。它的位置可以描述为回旋相位角 $\\theta$ 和拉莫尔半径 $\\rho_{s}$ 的函数：\n$$ \\boldsymbol{\\rho} = \\rho_{s} (\\cos\\theta \\, \\hat{x} + \\sin\\theta \\, \\hat{y}) $$\n那么点积 $\\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho}$ 为：\n$$ \\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho} = (k_{\\perp} \\hat{x}) \\cdot (\\rho_{s} \\cos\\theta \\, \\hat{x} + \\rho_{s} \\sin\\theta \\, \\hat{y}) = k_{\\perp} \\rho_{s} \\cos\\theta $$\n回旋平均是对所有从 $0$ 到 $2\\pi$ 的回旋相位角 $\\theta$ 的积分，并用总角度 $2\\pi$ 进行归一化：\n$$ \\langle \\exp(i \\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho}) \\rangle_{\\theta} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\exp(i k_{\\perp} \\rho_{s} \\cos\\theta) \\, d\\theta $$\n该积分为零阶第一类贝塞尔函数 $J_{0}(x)$ 的标准积分表示。其一般积分表示为：\n$$ J_{n}(x) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\exp(i(x \\sin\\theta - n\\theta)) \\, d\\theta $$\n为了我们的目的，一个更方便的表示是从 Jacobi-Anger 展开式导出的：\n$$ \\exp(iz\\cos\\theta) = \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(z) \\exp(in\\theta) $$\n对两边关于 $\\theta$ 从 $0$ 到 $2\\pi$ 积分，并除以 $2\\pi$：\n$$ \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\exp(iz\\cos\\theta) \\, d\\theta = \\frac{1}{2\\pi} \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(z) \\int_{0}^{2\\pi} \\exp(in\\theta) \\, d\\theta $$\n右侧的积分在 $n=0$ 时为 $2\\pi$，否则为 $0$。因此，求和中只有 $n=0$ 的项存留下来：\n$$ \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\exp(iz\\cos\\theta) \\, d\\theta = \\frac{1}{2\\pi} (i^{0} J_{0}(z) \\cdot 2\\pi) = J_{0}(z) $$\n通过令 $z = k_{\\perp}\\rho_{s}$，我们发现回旋平均因子的解析形式为：\n$$ \\langle \\exp(i \\boldsymbol{k}_{\\perp} \\cdot \\boldsymbol{\\rho}) \\rangle_{\\theta} = J_{0}(k_{\\perp}\\rho_{s}) $$\n\n2) 我们被要求计算在 $k_{\\perp}\\rho_{i} = 0.1$、$0.5$ 和 $1.0$ 时离子回旋平均因子 $J_{0}(k_{\\perp}\\rho_{i})$ 的值。$J_{0}(x)$ 的级数展开为 $J_{0}(x) = \\sum_{k=0}^{\\infty} \\frac{(-1)^{k}}{(k!)^{2}} \\left(\\frac{x}{2}\\right)^{2k} = 1 - \\frac{x^{2}}{4} + \\frac{x^{4}}{64} - O(x^{6})$。使用该展开式或标准数值库，我们计算这些值并四舍五入到四位有效数字。\n\n对于 $k_{\\perp}\\rho_{i} = 0.1$：\n$$ J_{0}(0.1) \\approx 0.99750156 \\dots \\approx 0.9975 $$\n对于 $k_{\\perp}\\rho_{i} = 0.5$：\n$$ J_{0}(0.5) \\approx 0.93846980 \\dots \\approx 0.9385 $$\n对于 $k_{\\perp}\\rho_{i} = 1.0$：\n$$ J_{0}(1.0) \\approx 0.76519768 \\dots \\approx 0.7652 $$\n\n3) 给定一个电子-离子等离子体，其中 $Z_{i}=1$，$Z_{e}=-1$，$T_{e}=T_{i}$ 且 $m_{i}=m_{p}$。我们首先求比率 $\\rho_{e}/\\rho_{i}$。组分 $s$ 的拉莫尔半径由其热速度 $v_{\\mathrm{th},s} = \\sqrt{2 T_{s}/m_{s}}$ 和回旋频率 $\\Omega_{s} = Z_{s} e B/m_{s}$ 定义。由于半径必须是正值，我们使用回旋频率的绝对值：\n$$ \\rho_{s} = \\frac{v_{\\mathrm{th},s}}{|\\Omega_{s}|} = \\frac{\\sqrt{2 T_{s}/m_{s}}}{|Z_{s}| e B/m_{s}} = \\frac{m_{s}}{|Z_{s}| e B} \\sqrt{\\frac{2 T_{s}}{m_{s}}} = \\frac{\\sqrt{2 m_{s} T_{s}}}{|Z_{s}| e B} $$\n电子拉莫尔半径与离子拉莫尔半径的比率为：\n$$ \\frac{\\rho_{e}}{\\rho_{i}} = \\frac{\\sqrt{2 m_{e} T_{e}}/(|Z_{e}| e B)}{\\sqrt{2 m_{i} T_{i}}/(|Z_{i}| e B)} = \\frac{\\sqrt{m_{e}T_{e}}}{\\sqrt{m_{i}T_{i}}} \\frac{|Z_{i}|}{|Z_{e}|} $$\n使用给定条件 $T_{e}=T_{i}$、 $|Z_{i}|=1$ 和 $|Z_{e}|=|-1|=1$，表达式简化为：\n$$ \\frac{\\rho_{e}}{\\rho_{i}} = \\sqrt{\\frac{m_{e}}{m_{i}}} $$\n接下来，我们求当 $k_{\\perp}\\rho_{e} = 1$ 时 $k_{\\perp}\\rho_{i}$ 的值。从此条件，我们得到 $k_{\\perp} = 1/\\rho_{e}$。将此代入离子自变量的表达式中：\n$$ k_{\\perp}\\rho_{i} = \\left(\\frac{1}{\\rho_{e}}\\right)\\rho_{i} = \\frac{\\rho_{i}}{\\rho_{e}} = \\sqrt{\\frac{m_{i}}{m_{e}}} $$\n对于质子离子，$m_{i}=m_{p}$。质子与电子的质量比为 $m_{p}/m_{e} \\approx 1836.15$。其值为 $k_{\\perp}\\rho_{i} \\approx \\sqrt{1836.15} \\approx 42.85$。这代表了与电子尺度条件 $k_{\\perp}\\rho_{e} = 1$ 相对应的离子尺度波数。\n\n最后，我们计算当 $k_{\\perp}\\rho_{e} = 1$ 和 $k_{\\perp}\\rho_{e} = 2$ 时的电子回旋平均因子 $J_{0}(k_{\\perp}\\rho_{e})$。\n对于 $k_{\\perp}\\rho_{e} = 1.0$：\n$$ J_{0}(1.0) \\approx 0.76519768 \\dots \\approx 0.7652 $$\n对于 $k_{\\perp}\\rho_{e} = 2.0$：\n$$ J_{0}(2.0) \\approx 0.22389077 \\dots \\approx 0.2239 $$\n\n4) 回旋平均因子 $J_{0}(k_{\\perp}\\rho_{s})$ 量化了组分 $s$ 的粒子与具有垂直波矢 $k_{\\perp}$ 的静电势涨落耦合的强度。函数 $J_{0}(x)$ 在 $x=0$ 时达到最大值 $1$，并随着 $x$ 的增加以振荡方式衰减。$J_{0}(k_{\\perp}\\rho_{s})$ 的值接近 $1$ 意味着强耦合，而接近 $0$ 则意味着弱耦合，或称解耦。\n\n条件 $k_{\\perp}\\rho_{e} \\gtrsim 1$ 对应于其垂直波长 $\\lambda_{\\perp} = 2\\pi/k_{\\perp}$ 与电子拉莫尔半径 $\\rho_{e}$ 相当或更小的涨落。如第 3 部分所示，$J_{0}(k_{\\perp}\\rho_{e})$ 的值从 $1$ (对于 $k_{\\perp}\\rho_e \\ll 1$) 下降到 $k_{\\perp}\\rho_{e}=1$ 时的 $0.7652$，并进一步下降到 $k_{\\perp}\\rho_{e}=2$ 时的 $0.2239$。对于更大的自变量，该函数的振幅继续减小。从物理上看，当涨落波长远小于回旋半径时，粒子的圆形轨道会穿过波势的许多正相位和负相位。在轨道上平均后，势场的净效应变得非常小。这就是回旋动理学解耦的机制。电子由于其质量小，因而拉莫尔半径也小（在给定温度下），所以在比离子小得多的空间尺度（即更大的 $k_{\\perp}$）上与涨落解耦。\n\n零阶贝塞尔函数 $J_{0}(x)$ 在大自变量 $x \\to \\infty$ 时的主阶渐近表达式由下式给出：\n$$ J_{0}(x) \\sim \\sqrt{\\frac{2}{\\pi x}} \\cos\\left(x - \\frac{\\pi}{4}\\right) $$\n该表达式表明，回旋平均因子的振幅按 $x^{-1/2} = (k_{\\perp}\\rho_{s})^{-1/2}$ 衰减，证实了在大 $k_{\\perp}\\rho_s$ 时与涨落的耦合变得极小。这就完成了对解耦的解释。所要求的最终定量陈述是这个渐近表达式。",
            "answer": "$$ \\boxed{\\sqrt{\\frac{2}{\\pi x}} \\cos\\left(x - \\frac{\\pi}{4}\\right)} $$"
        },
        {
            "introduction": "在掌握了基本概念之后，本练习将探讨一个聚变等离子体中的实际问题：杂质对等离子体稳定性的影响。我们将使用一个简化的多物种回旋动理学模型，研究少量高 $Z$ 杂质离子如何显著改变电子的碰撞环境。通过这种分析，我们可以评估这对一种关键的能量损失机制——捕获电子模（Trapped Electron Mode, TEM）的稳定性产生的影响 。",
            "id": "4016868",
            "problem": "考虑一个低碰撞率的托卡马克等离子体，其由存在多种离子的情况下电子的线性静电回旋动理学（GK）方程描述。重点关注与捕获电子模（TEM）相关的捕获电子响应。假设存在电荷数为 $Z_{i} = 1$ 的单电荷主离子，以及电荷数为 $Z_{Z}$、分数浓度为 $f_{Z} \\equiv n_{Z}/n_{e} \\ll 1$ 的痕量、完全电离的高-$Z$ 杂质离子，其中 $n_{e}$ 是电子密度，$n_{Z}$ 是杂质密度。使用 $Z_{i}=1$ 的准中性条件来关联各粒子密度。在局域、弹跳平均极限下进行分析，并用有效速率为 $\\nu_{e}^{\\mathrm{eff}}$ 的 Krook 算子来模拟捕获电子上的螺距角散射碰撞。忽略电子-电子碰撞和任何有限拉莫尔半径修正，并采用排序 $|\\langle \\omega_{D e} \\rangle| \\ll |\\omega|$，其中 $\\langle \\omega_{D e} \\rangle$ 是弹跳平均的电子磁漂移频率，$\\omega$ 是复数模式频率。\n\n从采用上述碰撞模型和排序的线性化、弹跳平均的捕获电子回旋动理学方程出发，推导非绝热捕获电子密度响应振幅与复数分母 $[\\omega + i \\nu_{e}^{\\mathrm{eff}}]$ 的标度关系。利用经过充分检验的标度关系，即电子-离子螺距角散射频率与对所有离子种类 $a$ 的加权密度和 $\\sum_{a} n_{a} Z_{a}^{2}$ 成正比，展示高 $Z$ 杂质如何相对于仅含主离子的基准值 $\\nu_{0}$ 来改变 $\\nu_{e}^{\\mathrm{eff}}$。然后，对于以下参数：\n- $Z_{Z} = 74$,\n- $f_{Z} = 1.0 \\times 10^{-4}$,\n- $\\omega = \\omega_{r} + i \\gamma$ 其中 $\\omega_{r} = 1.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$ 且 $\\gamma = 5.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$,\n- 基准电子-离子碰撞率（仅含主离子）$\\nu_{0} = 1.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$，\n\n计算由于杂质引起的捕获电子非绝热密度响应振幅的乘性缩减因子\n$$F \\equiv \\frac{\\left| \\omega + i \\nu_{0} \\right|}{\\left| \\omega + i \\nu_{e}^{\\mathrm{eff}} \\right|}$$\n将 $F<1$ 解释为对捕获电子驱动的稳定化，将 $F>1$ 解释为非稳定化。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统**：低碰撞率的托卡马克等离子体。\n- **模型**：局限于弹跳平均的电子线性静电回旋动理学（GK）方程，与捕获电子模（TEM）相关。\n- **粒子种类**：\n    - 电子，密度为 $n_{e}$。\n    - 单电荷主离子，电荷数为 $Z_{i} = 1$，密度为 $n_{i}$。\n    - 痕量、完全电离的高 $Z$ 杂质，电荷数为 $Z_{Z}$，密度为 $n_{Z}$。\n- **定义和条件**：\n    - 杂质分数浓度：$f_{Z} \\equiv n_{Z}/n_{e} \\ll 1$。\n    - 准中性：总正电荷密度等于电子密度。\n    - 碰撞模型：捕获电子上的螺距角散射由有效速率为 $\\nu_{e}^{\\mathrm{eff}}$ 的 Krook 算子模拟。\n    - 忽略的效应：电子-电子碰撞，有限拉莫尔半径修正。\n    - 排序：$|\\langle \\omega_{D e} \\rangle| \\ll |\\omega|$，其中 $\\langle \\omega_{D e} \\rangle$ 是弹跳平均的电子磁漂移频率，$\\omega$ 是复数模式频率。\n- **标度律**：电子-离子螺距角散射频率与对所有离子种类 $a$ 的加权密度和 $\\sum_{a} n_{a} Z_{a}^{2}$ 成正比。\n- **参数**：\n    - $Z_{Z} = 74$。\n    - $f_{Z} = 1.0 \\times 10^{-4}$。\n    - $\\omega = \\omega_{r} + i \\gamma$ 其中 $\\omega_{r} = 1.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$ 且 $\\gamma = 5.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$。\n    - 基准电子-离子碰撞率（仅含主离子）：$\\nu_{0} = 1.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$。\n- **目标**：计算乘性缩减因子 $F \\equiv \\frac{\\left| \\omega + i \\nu_{0} \\right|}{\\left| \\omega + i \\nu_{e}^{\\mathrm{eff}} \\right|}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上植根于成熟的托卡马克微观不稳定性理论，特别是捕获电子模的回旋动理学描述。诸如 Krook 碰撞算子、捕获粒子的弹跳平均以及排序 $|\\langle \\omega_{D e} \\rangle| \\ll |\\omega|$ 等假设是该领域的标准简化方法。碰撞频率随 $\\sum n_{a} Z_{a}^{2}$ 的标度关系是等离子体输运理论的一个基本结果。使用准中性来关联各粒子密度是等离子体物理学的核心原则。所有参数对于现代托卡马克都是物理上现实的。问题提法得当，目标明确，信息充分，可以推导出唯一解。语言客观且无歧义。\n\n### 步骤 3：结论与行动\n问题有效。将提供解答。\n\n### 解答推导\n\n分析始于捕获电子分布函数的非绝热部分的线性化、弹跳平均的回旋动理学方程，记为 $\\delta g_{e}$。在其一般形式中，该方程平衡了模式频率、磁漂移和碰撞的效应与波-粒子共振驱动项。\n$$(\\omega - \\langle \\omega_{De} \\rangle + i C_{e}) \\delta g_{e} = (\\omega - \\omega_{*e}^{T}) \\frac{e \\langle \\phi \\rangle}{T_e} F_{M,e}$$\n此处，$\\omega$ 是复数模式频率，$\\langle \\omega_{De} \\rangle$ 是弹跳平均的磁漂移频率，$C_{e}$ 是碰撞算子，$\\omega_{*e}^{T}$ 是总的电子抗磁频率（包括密度和温度梯度），$\\langle \\phi \\rangle$ 是弹跳平均的静电势涨落，$e$ 是元电荷，$T_e$ 是电子温度，$F_{M,e}$ 是背景麦克斯韦分布。\n\n问题指定了用于螺距角散射的 Krook 模型，因此我们将算子 $C_{e}$ 替换为有效碰撞频率 $\\nu_{e}^{\\mathrm{eff}}$。此外，给定排序 $|\\langle \\omega_{De} \\rangle| \\ll |\\omega|$，这使我们能够忽略分母中的漂移频率项。$\\delta g_{e}$ 的方程简化为：\n$$(\\omega + i \\nu_{e}^{\\mathrm{eff}}) \\delta g_{e} \\approx (\\omega - \\omega_{*e}^{T}) \\frac{e \\langle \\phi \\rangle}{T_e} F_{M,e}$$\n解出 $\\delta g_{e}$：\n$$\\delta g_{e} \\approx \\frac{(\\omega - \\omega_{*e}^{T})}{\\omega + i \\nu_{e}^{\\mathrm{eff}}} \\frac{e \\langle \\phi \\rangle}{T_e} F_{M,e}$$\n捕获电子密度扰动的非绝热部分 $\\delta n_{e, \\mathrm{trap}}^{\\mathrm{na}}$，是通过在速度空间的捕获区域对 $\\delta g_{e}$ 进行积分得到的。该积分得到：\n$$\\delta n_{e, \\mathrm{trap}}^{\\mathrm{na}} = \\int_{\\mathrm{trap}} \\delta g_{e} \\, d^{3}v \\propto \\frac{1}{\\omega + i \\nu_{e}^{\\mathrm{eff}}}$$\n因此，该响应的振幅与此复数分数的模成正比：\n$$|\\delta n_{e, \\mathrm{trap}}^{\\mathrm{na}}| \\propto \\frac{1}{|\\omega + i \\nu_{e}^{\\mathrm{eff}}|}$$\n这证实了非绝热捕获电子密度响应的振幅与复数分母 $|\\omega + i \\nu_{e}^{\\mathrm{eff}}|$ 成反比。\n\n接下来，我们确定存在杂质时的有效碰撞频率 $\\nu_{e}^{\\mathrm{eff}}$。给定电子-离子碰撞频率与 $\\sum_{a} n_{a} Z_{a}^{2}$ 成正比，其中求和遍及所有离子种类 $a$。设比例常数为 $C$。\n$$\\nu_{e}^{\\mathrm{eff}} = C \\sum_{a} n_{a} Z_{a}^{2}$$\n在我们的情况中，离子种类是主离子 ($a=i$) 和杂质离子 ($a=Z$)\n$$\\nu_{e}^{\\mathrm{eff}} = C (n_{i} Z_{i}^{2} + n_{Z} Z_{Z}^{2})$$\n基准碰撞率 $\\nu_{0}$ 对应于仅含主离子的纯等离子体。在这种情况下，$n_{Z}=0$ 且准中性意味着 $n_{i} = n_{e}$。当 $Z_i=1$ 时，我们有：\n$$\\nu_{0} = C (n_{e} \\cdot 1^{2}) = C n_{e}$$\n这使我们能够确定常数 $C = \\nu_{0}/n_{e}$。\n\n现在，我们考虑含有杂质的等离子体。准中性条件是 $n_{e} = Z_{i} n_{i} + Z_{Z} n_{Z}$。给定 $Z_{i}=1$，这变为 $n_{e} = n_{i} + Z_{Z} n_{Z}$，由此得到主离子密度为 $n_{i} = n_{e} - Z_{Z} n_{Z}$。\n将此代入 $\\nu_{e}^{\\mathrm{eff}}$ 的表达式中：\n$$\\nu_{e}^{\\mathrm{eff}} = C ((n_{e} - Z_{Z} n_{Z}) Z_{i}^{2} + n_{Z} Z_{Z}^{2})$$\n使用 $Z_i=1$ 和定义 $f_{Z} = n_{Z}/n_{e}$ (因此 $n_{Z} = f_{Z} n_{e}$):\n$$\\nu_{e}^{\\mathrm{eff}} = C ((n_{e} - Z_{Z} f_{Z} n_{e}) \\cdot 1^{2} + f_{Z} n_{e} Z_{Z}^{2}) = C n_{e} (1 - Z_{Z} f_{Z} + f_{Z} Z_{Z}^{2})$$\n代入 $C = \\nu_{0}/n_{e}$：\n$$\\nu_{e}^{\\mathrm{eff}} = \\frac{\\nu_{0}}{n_{e}} n_{e} (1 - Z_{Z} f_{Z} + f_{Z} Z_{Z}^{2}) = \\nu_{0} (1 - Z_{Z} f_{Z} + f_{Z} Z_{Z}^{2})$$\n该表达式将含杂质等离子体中的有效碰撞率与基准率联系起来。括号中的项是有效电荷，$Z_{\\mathrm{eff}} = \\sum_a n_a Z_a^2 / n_e$。\n\n最后，我们使用给定的参数计算乘性缩减因子 $F$。首先，我们计算 $\\nu_{e}^{\\mathrm{eff}}$ 的数值：\n- $Z_{Z} = 74$\n- $f_{Z} = 1.0 \\times 10^{-4}$\n- $\\nu_{0} = 1.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$\n\n$$\\nu_{e}^{\\mathrm{eff}} = (1.0 \\times 10^{5}) \\left(1 - (74)(1.0 \\times 10^{-4}) + (1.0 \\times 10^{-4})(74)^{2}\\right)$$\n$$\\nu_{e}^{\\mathrm{eff}} = (1.0 \\times 10^{5}) (1 - 0.0074 + 0.5476) = (1.0 \\times 10^{5}) (1.5402) = 1.5402 \\times 10^{5}\\ \\mathrm{s}^{-1}$$\n高 $Z$ 杂质的存在显著增加了有效碰撞频率。\n\n现在我们计算因子 $F$：\n$$F = \\frac{\\left| \\omega + i \\nu_{0} \\right|}{\\left| \\omega + i \\nu_{e}^{\\mathrm{eff}} \\right|}$$\n给定 $\\omega = \\omega_{r} + i \\gamma = (1.0 \\times 10^{5}) + i (5.0 \\times 10^{4})\\ \\mathrm{s}^{-1}$：\n分子项是：\n$$\\omega + i \\nu_{0} = (1.0 \\times 10^{5} + i \\cdot 5.0 \\times 10^{4}) + i (1.0 \\times 10^{5}) = 1.0 \\times 10^{5} + i (1.5 \\times 10^{5})$$\n其模为：\n$$|\\omega + i \\nu_{0}| = \\sqrt{(1.0 \\times 10^{5})^{2} + (1.5 \\times 10^{5})^{2}} = (1.0 \\times 10^{5}) \\sqrt{1.0^{2} + 1.5^{2}} = (1.0 \\times 10^{5}) \\sqrt{1.0 + 2.25} = (1.0 \\times 10^{5}) \\sqrt{3.25}$$\n分母项是：\n$$\\omega + i \\nu_{e}^{\\mathrm{eff}} = (1.0 \\times 10^{5} + i \\cdot 5.0 \\times 10^{4}) + i (1.5402 \\times 10^{5}) = 1.0 \\times 10^{5} + i (2.0402 \\times 10^{5})$$\n其模为：\n$$|\\omega + i \\nu_{e}^{\\mathrm{eff}}| = \\sqrt{(1.0 \\times 10^{5})^{2} + (2.0402 \\times 10^{5})^{2}} = (1.0 \\times 10^{5}) \\sqrt{1.0^{2} + 2.0402^{2}}$$\n$$|\\omega + i \\nu_{e}^{\\mathrm{eff}}| = (1.0 \\times 10^{5}) \\sqrt{1.0 + 4.16241604} = (1.0 \\times 10^{5}) \\sqrt{5.16241604}$$\n因子 $F$ 是这两个模的比值：\n$$F = \\frac{(1.0 \\times 10^{5}) \\sqrt{3.25}}{(1.0 \\times 10^{5}) \\sqrt{5.16241604}} = \\sqrt{\\frac{3.25}{5.16241604}} \\approx \\sqrt{0.629550} \\approx 0.793442$$\n四舍五入到四位有效数字，我们得到 $F \\approx 0.7934$。由于 $F  1$，非绝热响应的振幅减小，这表明杂质对捕获电子模具有稳定作用。这是由于捕获电子的碰撞阻尼增强所致。",
            "answer": "$$\\boxed{0.7934}$$"
        },
        {
            "introduction": "最后的练习将重心从物理分析转向计算实践，解决构建回旋动理学模拟程序的一个基础性任务。在模拟不同粒子种类的动力学之前，我们必须首先精确描述它们相互作用的“舞台”：托卡马克装置中复杂的磁场几何。本练习要求为一种真实的平衡位形（Miller 平衡）计算其度规张量系数，这是构建任何现代回旋动理学代码的关键第一步 。",
            "id": "4016846",
            "problem": "要求您实现一个完整的、可运行的程序，用于计算描述 Miller 平衡的托卡马克等离子体的回旋动理学方程中出现的特定几何系数。在多组分回旋动理学模型中，这些系数对所有粒子种类都是相同的。您必须从基本的几何定义出发推导所需的表达式，然后为提供的测试套件计算这些值。所有量都必须以数学上精确的方式处理。\n\nMiller 平衡在柱坐标中指定了磁通面的形状，其大半径和垂直位置由下式给出\n$$\nR(r,\\theta) = R_0 + \\Delta(r) + r \\cos\\!\\big(\\theta + \\delta \\sin\\theta\\big), \\quad Z(r,\\theta) = \\kappa \\, r \\sin\\theta,\n$$\n其中 $R_0$ 是磁轴的大半径，$r$ 是小半径（一个磁通面标签），$\\theta$ 是几何极向角，$\\kappa$ 是延伸度，$\\delta$ 是三角形变，$\\Delta(r)$ 是 Shafranov 位移。在本问题中，将 Shafranov 位移建模为线性函数 $\\Delta(r) = \\Delta' \\, r$，其中 $\\Delta'$ 是一个常数参数，单位为 $1$（无量纲斜率，乘以 $r$ 后单位为米）。\n\n空间坐标为 $(r,\\theta,\\phi)$，其中 $\\phi$ 是环向角。笛卡尔坐标中的位置矢量为\n$$\n\\boldsymbol{x}(r,\\theta,\\phi) = \\big(R(r,\\theta)\\cos\\phi, \\; R(r,\\theta)\\sin\\phi, \\; Z(r,\\theta)\\big).\n$$\n根据曲线坐标中微分几何的基本定义，协变基矢为\n$$\n\\boldsymbol{e}_r = \\frac{\\partial \\boldsymbol{x}}{\\partial r}, \\quad \\boldsymbol{e}_\\theta = \\frac{\\partial \\boldsymbol{x}}{\\partial \\theta}, \\quad \\boldsymbol{e}_\\phi = \\frac{\\partial \\boldsymbol{x}}{\\partial \\phi},\n$$\n协变度规分量为 $g_{ij} = \\boldsymbol{e}_i \\cdot \\boldsymbol{e}_j$，其中 $i,j \\in \\{r,\\theta,\\phi\\}$。逆变度规分量定义为 $g^{ij} = \\nabla u^i \\cdot \\nabla u^j$，其中 $(u^1,u^2,u^3) \\equiv (r,\\theta,\\phi)$，$\\nabla u^i$ 是满足 $\\nabla u^i \\cdot \\boldsymbol{e}_j = \\delta^i{}_j$ 的对偶基。\n\n引入磁力线伸直坐标 $y \\equiv \\alpha = \\phi - q \\, \\theta$，其中 $q$ 是安全因子，在磁通管上视作常数。使用坐标集 $(x,y,\\theta)$，其中 $x \\equiv r$，$y \\equiv \\alpha$。您的任务是：\n\n- 使用上述定义，推导逆变度规分量 $g^{xx}$ 和 $g^{xy}$ 的表达式，定义为\n$$\ng^{xx} = \\nabla x \\cdot \\nabla x, \\quad g^{xy} = \\nabla x \\cdot \\nabla y,\n$$\n其中 $x=r$，$y=\\alpha$。请用协变度规分量 $g_{rr}$、$g_{r\\theta}$、$g_{\\theta\\theta}$ 和 $g_{\\phi\\phi}$ 表示 $g^{xx}$ 和 $g^{xy}$。\n\n- 使用与磁力线对齐的单位磁场方向 $\\hat{\\boldsymbol{b}}$ 的定义，以及在磁力线伸直坐标中磁力线局部遵循切矢 $\\boldsymbol{t} = \\boldsymbol{e}_\\theta + q \\, \\boldsymbol{e}_\\phi$ 的性质，推导并计算\n$$\n\\hat{\\boldsymbol{b}} \\cdot \\nabla \\theta.\n$$\n\n所有计算必须从上面提供的基本定义开始。不要使用任何未从这些定义推导出的简化公式。\n\n实现一个程序，对下面的测试套件中的每个测试用例，计算以下三个量：\n- $g^{xx}$，单位为 $\\mathrm{m}^{-2}$，\n- $g^{xy}$，单位为 $\\mathrm{m}^{-2}$，\n- $\\hat{\\boldsymbol{b}} \\cdot \\nabla \\theta$，单位为 $\\mathrm{m}^{-1}$。\n\n角度使用弧度。所有长度单位为米。将 $q$ 和 $\\Delta'$ 视为如上文所定义的无量纲常数（$\\Delta(r) = \\Delta' \\, r$ 的结果单位为米）。\n\n测试套件参数集 $(R_0, r, \\kappa, \\delta, \\Delta', q, \\theta)$:\n1. $(3.0, 0.3, 1.8, 0.33, 0.25, 1.7, \\pi/3)$,\n2. $(3.0, 0.3, 1.0, 0.0, 0.0, 2.0, \\pi/2)$,\n3. $(3.0, 0.1, 2.5, 0.2, 0.4, 4.0, \\pi)$,\n4. $(3.0, 0.4, 1.4, 0.4, 0.1, 1.1, 0.0)$.\n\n您的程序应生成单行输出，包含一个逗号分隔的列表，用方括号括起来，其中每个测试用例的结果是一个包含三个浮点数的列表，顺序为 $[g^{xx}, g^{xy}, \\hat{\\boldsymbol{b}} \\cdot \\nabla \\theta]$。例如，输出结构必须是\n$$\n\\big[ [g^{xx}_1, g^{xy}_1, \\hat{\\boldsymbol{b}} \\cdot \\nabla \\theta_1], \\; [g^{xx}_2, g^{xy}_2, \\hat{\\boldsymbol{b}} \\cdot \\nabla \\theta_2], \\; \\ldots \\big].\n$$",
            "solution": "经过严格的验证过程，用户提供的问题被评估为**有效**。所有前提在计算等离子体物理和微分几何领域内都是科学上合理、一致且定义明确的。该问题是适定的、客观的，并包含了唯一解所需的所有必要信息。\n\n任务是推导并计算用于描述 Miller 平衡的托卡马克等离子体的回旋动理学模型中的三个特定几何系数。推导将从微分几何的基本原理开始。\n\n### 1. 准备工作：Miller 平衡与坐标系\n\nMiller 平衡定义了磁通面在柱坐标 $(R, \\phi, Z)$ 中的形状。大半径 $R$ 和垂直位置 $Z$ 是磁通面标签 $r$（小半径）和极向角 $\\theta$ 的函数：\n$$\nR(r,\\theta) = R_0 + \\Delta(r) + r \\cos\\big(\\theta + \\delta \\sin\\theta\\big)\n$$\n$$\nZ(r,\\theta) = \\kappa \\, r \\sin\\theta\n$$\n将 Shafranov 位移建模为 $\\Delta(r) = \\Delta' r$，则 $R$ 的表达式变为：\n$$\nR(r,\\theta) = R_0 + \\Delta' r + r \\cos\\big(\\theta + \\delta \\sin\\theta\\big)\n$$\n为方便起见，我们定义 $\\Theta(\\theta) = \\theta + \\delta \\sin\\theta$。\n\n笛卡尔坐标 $(x_1, x_2, x_3)$ 中的位置矢量由 $\\boldsymbol{x}(r,\\theta,\\phi) = (R\\cos\\phi, R\\sin\\phi, Z)$ 给出。我们将计算曲线坐标系 $(u^1, u^2, u^3) = (r, \\theta, \\phi)$ 中的度规张量分量。\n\n### 2. 协变度规张量分量 $g_{ij}$ 的推导\n\n协变基矢 $\\boldsymbol{e}_i$ 由位置矢量 $\\boldsymbol{x}$ 对坐标 $r, \\theta, \\phi$ 的偏导数给出。\n$$\n\\boldsymbol{e}_r = \\frac{\\partial \\boldsymbol{x}}{\\partial r} = \\left(\\frac{\\partial R}{\\partial r}\\cos\\phi, \\frac{\\partial R}{\\partial r}\\sin\\phi, \\frac{\\partial Z}{\\partial r}\\right)\n$$\n$$\n\\boldsymbol{e}_\\theta = \\frac{\\partial \\boldsymbol{x}}{\\partial \\theta} = \\left(\\frac{\\partial R}{\\partial \\theta}\\cos\\phi, \\frac{\\partial R}{\\partial \\theta}\\sin\\phi, \\frac{\\partial Z}{\\partial \\theta}\\right)\n$$\n$$\n\\boldsymbol{e}_\\phi = \\frac{\\partial \\boldsymbol{x}}{\\partial \\phi} = (-R\\sin\\phi, R\\cos\\phi, 0)\n$$\n所需的 $R$ 和 $Z$ 的偏导数是：\n$$\n\\frac{\\partial R}{\\partial r} = \\Delta' + \\cos(\\Theta)\n$$\n$$\n\\frac{\\partial R}{\\partial \\theta} = -r\\sin(\\Theta) \\frac{\\partial\\Theta}{\\partial\\theta} = -r\\sin(\\Theta)(1 + \\delta \\cos\\theta)\n$$\n$$\n\\frac{\\partial Z}{\\partial r} = \\kappa \\sin\\theta\n$$\n$$\n\\frac{\\partial Z}{\\partial \\theta} = \\kappa r \\cos\\theta\n$$\n然后计算协变度规分量 $g_{ij} = \\boldsymbol{e}_i \\cdot \\boldsymbol{e}_j$：\n$$\ng_{rr} = \\boldsymbol{e}_r \\cdot \\boldsymbol{e}_r = \\left(\\frac{\\partial R}{\\partial r}\\right)^2 + \\left(\\frac{\\partial Z}{\\partial r}\\right)^2 = (\\Delta' + \\cos\\Theta)^2 + (\\kappa \\sin\\theta)^2\n$$\n$$\ng_{\\theta\\theta} = \\boldsymbol{e}_\\theta \\cdot \\boldsymbol{e}_\\theta = \\left(\\frac{\\partial R}{\\partial \\theta}\\right)^2 + \\left(\\frac{\\partial Z}{\\partial \\theta}\\right)^2 = \\left(-r\\sin\\Theta(1+\\delta\\cos\\theta)\\right)^2 + (\\kappa r \\cos\\theta)^2\n$$\n$$\ng_{\\phi\\phi} = \\boldsymbol{e}_\\phi \\cdot \\boldsymbol{e}_\\phi = R^2\\sin^2\\phi + R^2\\cos^2\\phi = R^2\n$$\n$$\ng_{r\\theta} = \\boldsymbol{e}_r \\cdot \\boldsymbol{e}_\\theta = \\frac{\\partial R}{\\partial r}\\frac{\\partial R}{\\partial \\theta} + \\frac{\\partial Z}{\\partial r}\\frac{\\partial Z}{\\partial \\theta} = -r(\\Delta' + \\cos\\Theta)\\sin\\Theta(1+\\delta\\cos\\theta) + r\\kappa^2\\sin\\theta\\cos\\theta\n$$\n由于轴对称性，几何形状不依赖于 $\\phi$，这导致 $\\boldsymbol{e}_r \\cdot \\boldsymbol{e}_{\\phi} = 0$ 和 $\\boldsymbol{e}_{\\theta} \\cdot \\boldsymbol{e}_{\\phi} = 0$。因此，$g_{r\\phi} = g_{\\theta\\phi} = 0$。这使得度规张量矩阵呈块对角形式：\n$$\n(g_{ij}) = \\begin{pmatrix} g_{rr}  g_{r\\theta}  0 \\\\ g_{r\\theta}  g_{\\theta\\theta}  0 \\\\ 0  0  g_{\\phi\\phi} \\end{pmatrix}\n$$\n\n### 3. 逆变系数 $g^{xx}$ 和 $g^{xy}$ 的推导\n\n问题要求计算 $g^{xx} = \\nabla x \\cdot \\nabla x$ 和 $g^{xy} = \\nabla x \\cdot \\nabla y$，其中坐标为 $x \\equiv r$ 和 $y \\equiv \\alpha = \\phi - q\\theta$。梯度 $\\nabla r, \\nabla \\theta, \\nabla \\phi$ 构成逆变（或对偶）基 $\\boldsymbol{e}^r, \\boldsymbol{e}^\\theta, \\boldsymbol{e}^\\phi$。这些基矢的点积定义了逆变度规分量 $g^{ij} = \\boldsymbol{e}^i \\cdot \\boldsymbol{e}^j = \\nabla u^i \\cdot \\nabla u^j$。\n\n因此，我们可以将所求量表示为：\n$$\ng^{xx} = \\nabla r \\cdot \\nabla r = g^{rr}\n$$\n$$\ng^{xy} = \\nabla r \\cdot \\nabla y = \\nabla r \\cdot (\\nabla\\phi - q\\nabla\\theta) = (\\nabla r \\cdot \\nabla\\phi) - q(\\nabla r \\cdot \\nabla\\theta) = g^{r\\phi} - q g^{r\\theta}\n$$\n逆变度规张量 $(g^{ij})$ 是协变度规张量 $(g_{ij})$ 的逆。鉴于 $(g_{ij})$ 的块对角结构，我们可以分别对块求逆。\n$$\n(g^{ij}) = \\begin{pmatrix} g^{rr}  g^{r\\theta}  0 \\\\ g^{r\\theta}  g^{\\theta\\theta}  0 \\\\ 0  0  g^{\\phi\\phi} \\end{pmatrix} = \\begin{pmatrix} \\frac{g_{\\theta\\theta}}{g_{rr}g_{\\theta\\theta}-g_{r\\theta}^2}  \\frac{-g_{r\\theta}}{g_{rr}g_{\\theta\\theta}-g_{r\\theta}^2}  0 \\\\ \\frac{-g_{r\\theta}}{g_{rr}g_{\\theta\\theta}-g_{r\\theta}^2}  \\frac{g_{rr}}{g_{rr}g_{\\theta\\theta}-g_{r\\theta}^2}  0 \\\\ 0  0  \\frac{1}{g_{\\phi\\phi}} \\end{pmatrix}\n$$\n由此，我们确定了必要的分量：$g^{rr}$、$g^{r\\theta}$ 和 $g^{r\\phi}=0$。设极向度规的行列式为 $\\mathcal{G} = g_{rr}g_{\\theta\\theta} - g_{r\\theta}^2$。\n\n将这些代入 $g^{xx}$ 和 $g^{xy}$ 的表达式中：\n$$\ng^{xx} = g^{rr} = \\frac{g_{\\theta\\theta}}{\\mathcal{G}}\n$$\n$$\ng^{xy} = g^{r\\phi} - q g^{r\\theta} = 0 - q \\left( \\frac{-g_{r\\theta}}{\\mathcal{G}} \\right) = \\frac{q g_{r\\theta}}{\\mathcal{G}}\n$$\n\n### 4. $\\hat{\\boldsymbol{b}} \\cdot \\nabla \\theta$ 的推导\n\n单位磁场矢量 $\\hat{\\boldsymbol{b}}$ 与局部磁力线对齐。在磁力线伸直坐标中，磁力线的切矢由矢量 $\\boldsymbol{t} = \\boldsymbol{e}_\\theta + q\\boldsymbol{e}_\\phi$ 给出。因此单位矢量为：\n$$\n\\hat{\\boldsymbol{b}} = \\frac{\\boldsymbol{t}}{|\\boldsymbol{t}|} = \\frac{\\boldsymbol{e}_\\theta + q\\boldsymbol{e}_\\phi}{\\sqrt{(\\boldsymbol{e}_\\theta + q\\boldsymbol{e}_\\phi) \\cdot (\\boldsymbol{e}_\\theta + q\\boldsymbol{e}_\\phi)}}\n$$\n$\\boldsymbol{t}$ 的模的平方是：\n$$\n|\\boldsymbol{t}|^2 = \\boldsymbol{e}_\\theta \\cdot \\boldsymbol{e}_\\theta + 2q(\\boldsymbol{e}_\\theta \\cdot \\boldsymbol{e}_\\phi) + q^2(\\boldsymbol{e}_\\phi \\cdot \\boldsymbol{e}_\\phi) = g_{\\theta\\theta} + 2qg_{\\theta\\phi} + q^2g_{\\phi\\phi}\n$$\n由于 $g_{\\theta\\phi}=0$，这简化为 $|\\boldsymbol{t}|^2 = g_{\\theta\\theta} + q^2g_{\\phi\\phi}$。\n\n需要计算的量是 $\\hat{\\boldsymbol{b}} \\cdot \\nabla\\theta$。回想 $\\nabla\\theta = \\boldsymbol{e}^\\theta$，我们有：\n$$\n\\hat{\\boldsymbol{b}} \\cdot \\nabla\\theta = \\frac{\\boldsymbol{e}_\\theta + q\\boldsymbol{e}_\\phi}{\\sqrt{g_{\\theta\\theta} + q^2g_{\\phi\\phi}}} \\cdot \\boldsymbol{e}^\\theta = \\frac{\\boldsymbol{e}_\\theta \\cdot \\boldsymbol{e}^\\theta + q(\\boldsymbol{e}_\\phi \\cdot \\boldsymbol{e}^\\theta)}{\\sqrt{g_{\\theta\\theta} + q^2g_{\\phi\\phi}}}\n$$\n根据对偶基的定义，$\\boldsymbol{e}_i \\cdot \\boldsymbol{e}^j = \\delta_i^j$。因此，$\\boldsymbol{e}_\\theta \\cdot \\boldsymbol{e}^\\theta = 1$ 且 $\\boldsymbol{e}_\\phi \\cdot \\boldsymbol{e}^\\theta = 0$。分子简化为 $1$。\n最终表达式为：\n$$\n\\hat{\\boldsymbol{b}} \\cdot \\nabla\\theta = \\frac{1}{\\sqrt{g_{\\theta\\theta} + q^2g_{\\phi\\phi}}} = \\frac{1}{\\sqrt{g_{\\theta\\theta} + q^2R^2}}\n$$\n\n### 5. 计算公式总结\n\n程序中实现了以下表达式：\n1.  中间角：$\\Theta = \\theta + \\delta \\sin\\theta$\n2.  大半径：$R = R_0 + \\Delta' r + r \\cos\\Theta$\n3.  偏导数：\n    -   $\\partial_r R = \\Delta' + \\cos\\Theta$\n    -   $\\partial_\\theta R = -r\\sin\\Theta(1 + \\delta \\cos\\theta)$\n    -   $\\partial_r Z = \\kappa \\sin\\theta$\n    -   $\\partial_\\theta Z = \\kappa r \\cos\\theta$\n4.  协变度规分量：\n    -   $g_{rr} = (\\partial_r R)^2 + (\\partial_r Z)^2$\n    -   $g_{\\theta\\theta} = (\\partial_\\theta R)^2 + (\\partial_\\theta Z)^2$\n    -   $g_{r\\theta} = (\\partial_r R)(\\partial_\\theta R) + (\\partial_r Z)(\\partial_\\theta Z)$\n    -   $g_{\\phi\\phi} = R^2$\n5.  极向度规行列式：$\\mathcal{G} = g_{rr}g_{\\theta\\theta} - g_{r\\theta}^2$\n6.  最终量：\n    -   $g^{xx} = g_{\\theta\\theta} / \\mathcal{G}$\n    -   $g^{xy} = q g_{r\\theta} / \\mathcal{G}$\n    -   $\\hat{\\boldsymbol{b}} \\cdot \\nabla \\theta = 1 / \\sqrt{g_{\\theta\\theta} + q^2 R^2}$\n这些公式用于为每个测试用例计算所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_geo_coeffs(params):\n    \"\"\"\n    Calculates geometric coefficients for a Miller equilibrium.\n\n    Args:\n        params (tuple): A tuple containing the equilibrium parameters:\n            (R0, r, kappa, delta, Delta_p, q, theta)\n            R0 (float): Major radius of the magnetic axis [m].\n            r (float): Minor radius of the flux surface [m].\n            kappa (float): Elongation.\n            delta (float): Triangularity.\n            Delta_p (float): Shafranov shift slope (Delta' = d(Delta)/dr).\n            q (float): Safety factor.\n            theta (float): Poloidal angle [rad].\n\n    Returns:\n        list: A list containing the three computed coefficients:\n              [g_xx, g_xy, b_dot_grad_theta]\n    \"\"\"\n    R0, r, kappa, delta, Delta_p, q, theta = params\n\n    # 1. Intermediate angle\n    Theta = theta + delta * np.sin(theta)\n    \n    cos_theta = np.cos(theta)\n    sin_theta = np.sin(theta)\n    cos_Theta = np.cos(Theta)\n    sin_Theta = np.sin(Theta)\n\n    # 2. Major radius\n    R = R0 + Delta_p * r + r * cos_Theta\n\n    # 3. Partial derivatives\n    dR_dr = Delta_p + cos_Theta\n    dR_dtheta = -r * sin_Theta * (1 + delta * cos_theta)\n    dZ_dr = kappa * sin_theta\n    dZ_dtheta = kappa * r * cos_theta\n\n    # 4. Covariant metric components\n    g_rr = dR_dr**2 + dZ_dr**2\n    g_thetatheta = dR_dtheta**2 + dZ_dtheta**2\n    g_rtheta = dR_dr * dR_dtheta + dZ_dr * dZ_dtheta\n    g_phiphi = R**2\n    \n    # 5. Poloidal metric determinant\n    poloidal_det_g = g_rr * g_thetatheta - g_rtheta**2\n\n    # 6. Final quantities\n    # g_xx = g^rr = g_thetatheta / (g_rr*g_thetatheta - g_rtheta^2)\n    g_xx = g_thetatheta / poloidal_det_g\n    \n    # g_xy = q * g_rtheta / (g_rr*g_thetatheta - g_rtheta^2)\n    g_xy = q * g_rtheta / poloidal_det_g\n\n    # b_dot_grad_theta = 1 / sqrt(g_thetatheta + q^2 * g_phiphi)\n    b_dot_grad_theta = 1.0 / np.sqrt(g_thetatheta + q**2 * g_phiphi)\n\n    return [g_xx, g_xy, b_dot_grad_theta]\n\ndef solve():\n    \"\"\"\n    Drives the calculation for the test suite and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Parameters are (R0, r, kappa, delta, Delta', q, theta)\n    test_cases = [\n        (3.0, 0.3, 1.8, 0.33, 0.25, 1.7, np.pi/3),\n        (3.0, 0.3, 1.0, 0.0, 0.0, 2.0, np.pi/2),\n        (3.0, 0.1, 2.5, 0.2, 0.4, 4.0, np.pi),\n        (3.0, 0.4, 1.4, 0.4, 0.1, 1.1, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_geo_coeffs(case)\n        results.append(result)\n\n    # The string representation of a Python list includes spaces after commas.\n    # The required format is [[item, item], [item, item]], which is what\n    # str(list_of_lists) produces, but the problem's skeleton code sample\n    # implies a format where the outer lists are joined by only a comma. We\n    # follow the skeleton code's format. E.g., `[[1, 2],[3, 4]]`\n    \n    # The str() of a list like [1.1, 2.2] is '[1.1, 2.2]'.\n    # map(str, results) will create an iterator of these string representations.\n    # ','.join() will join them with a comma.\n    # The outer f-string adds the final brackets.\n    output_string = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}