{
    "hands_on_practices": [
        {
            "introduction": "This exercise delves into the fundamental mechanism of tertiary instability by examining the modulational instability of a primary drift wave. Starting from the Charney–Hasegawa–Mima (CHM) equation, a canonical model for drift-wave turbulence, you will use a multiple-scales analysis to see how a nonlinear Schrödinger-type equation emerges. This practice  is crucial for understanding how the interaction between a large-amplitude drift wave and flow modulations can lead to the exponential growth of sidebands, which is the genesis of tertiary instability.",
            "id": "4052617",
            "problem": "Consider the Charney–Hasegawa–Mima (CHM) equation for electrostatic drift-wave dynamics in a magnetized plasma with adiabatic electrons, written in normalized form using the ion sound Larmor radius $\\rho_s$ for lengths and the ion acoustic time $\\rho_s/c_s$ for times:\n$$\n\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\phi - \\phi\\right) + \\left\\{\\phi, \\nabla^{2}\\phi\\right\\} + \\frac{\\partial \\phi}{\\partial y} = 0,\n$$\nwhere $\\phi$ is the normalized electrostatic potential, $\\nabla^{2}$ is the Laplacian in the plane perpendicular to the magnetic field, and $\\{f,g\\} \\equiv \\partial_x f\\,\\partial_y g - \\partial_y f\\,\\partial_x g$ is the canonical Poisson bracket associated with the $\\mathbf{E}\\times\\mathbf{B}$ (electric field cross magnetic field) drift nonlinearity. Linear drift waves with wavevector $\\boldsymbol{k}=(k_x,k_y)$ have frequency\n$$\n\\omega(\\boldsymbol{k}) = \\frac{k_y}{1 + k^{2}}, \\quad k^{2}\\equiv k_x^{2} + k_y^{2}.\n$$\nAssume a quasi-monochromatic pump drift wave with carrier wavevector $\\boldsymbol{k}_0=(k_x,k_y)$ and complex envelope amplitude $A(X,T)$ for slow radial modulation $X$ and slow time $T$, such that\n$$\n\\phi(x,y,t) \\approx \\Re\\left\\{A(X,T)\\,\\exp\\!\\left[i\\left(k_x x + k_y y - \\omega(\\boldsymbol{k}_0) t\\right)\\right]\\right\\},\n$$\nand the modulation is purely radial with zonal-flow wavenumber $q$ (i.e., modulation varies as $\\exp(i q x)$ and has $k_y=0$). Using a multiple-scales expansion to leading nontrivial order, the envelope dynamics reduces to a nonlinear Schrödinger–type equation\n$$\ni\\,\\frac{\\partial A}{\\partial T} + \\alpha\\,\\frac{\\partial^{2} A}{\\partial X^{2}} + \\beta\\,|A|^{2}A = 0,\n$$\nin a comoving frame at the group velocity, where $\\alpha$ is the dispersion curvature coefficient derived from the linear drift-wave dispersion and $\\beta$ is the cubic nonlinearity coefficient inherited from the $\\mathbf{E}\\times\\mathbf{B}$ advection. In this problem, adopt the canonical amplitude normalization in which $\\beta=1$.\n\nStarting from the CHM equation and the drift-wave dispersion relation, do the following:\n\n- Derive $\\alpha$ explicitly in terms of the pump wavevector components $(k_x,k_y)$ by calculating the second derivative of $\\omega(\\boldsymbol{k})$ with respect to $k_x$ at $\\boldsymbol{k}_0$ and taking the standard envelope-reduction factor.\n- Linearize the nonlinear Schrödinger equation about the plane-wave solution $A(X,T)=A_0\\,\\exp(i\\,|A_0|^{2} T)$, and derive the modulational instability growth rate $\\gamma(q)$ for a perturbation of the form $\\delta A \\propto \\exp(i q X + \\gamma T)$.\n- From your expression for $\\gamma(q)$, obtain the modulational instability condition that links the drift-wave amplitude $|A_0|$ and the zonal-flow wavenumber $q$ for tertiary sideband growth.\n- Compute the wavenumber $q_\\ast$ of the fastest-growing tertiary sideband (i.e., the modulation that maximizes $\\gamma(q)$) as a closed-form analytic expression in terms of $k_x$, $k_y$, and $|A_0|$.\n\nAssume the pump parameters satisfy the focusing condition required for modulational instability in this model. Express the final result for $q_\\ast$ in units of $\\rho_s^{-1}$. No numerical evaluation is required; provide the exact analytic expression. The final answer must be a single closed-form expression.",
            "solution": "The user wants me to solve a problem on the modulational instability of drift waves described by the Charney–Hasegawa–Mima (CHM) equation.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n- **Governing Equation (CHM):**\n  $$\n  \\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\phi - \\phi\\right) + \\left\\{\\phi, \\nabla^{2}\\phi\\right\\} + \\frac{\\partial \\phi}{\\partial y} = 0\n  $$\n- **Poisson Bracket:**\n  $$\n  \\{f,g\\} \\equiv \\partial_x f\\,\\partial_y g - \\partial_y f\\,\\partial_x g\n  $$\n- **Linear Dispersion Relation:**\n  $$\n  \\omega(\\boldsymbol{k}) = \\frac{k_y}{1 + k^{2}}, \\quad k^{2}\\equiv k_x^{2} + k_y^{2}\n  $$\n- **Wave Ansatz:**\n  $$\n  \\phi(x,y,t) \\approx \\Re\\left\\{A(X,T)\\,\\exp\\!\\left[i\\left(k_x x + k_y y - \\omega(\\boldsymbol{k}_0) t\\right)\\right]\\right\\}\n  $$\n- **Envelope Equation (NLS):**\n  $$\n  i\\,\\frac{\\partial A}{\\partial T} + \\alpha\\,\\frac{\\partial^{2} A}{\\partial X^{2}} + \\beta\\,|A|^{2}A = 0\n  $$\n- **Coefficients:**\n  - $\\alpha$: Dispersion curvature coefficient.\n  - $\\beta$: Cubic nonlinearity coefficient, with the canonical normalization $\\beta=1$.\n- **Modulation:** Purely radial with wavenumber $q$ (i.e., varies as $\\exp(i q x)$).\n- **Plane-wave solution:** $A(X,T)=A_0\\,\\exp(i\\,|A_0|^{2} T)$.\n- **Perturbation form:** $\\delta A \\propto \\exp(i q X + \\gamma T)$.\n- **Assumption:** The parameters satisfy the focusing condition for modulational instability.\n\n#### Step 2: Validate Using Extracted Givens\nThe problem presented is a standard exercise in the field of nonlinear plasma physics and fluid dynamics.\n- **Scientifically Grounded:** The Charney–Hasegawa–Mima equation is a canonical model for drift-wave turbulence in magnetized plasmas. The derivation of a Nonlinear Schrödinger (NLS) equation for a wave envelope via a multiple-scales expansion is a well-established and fundamental technique in nonlinear wave theory. The concept of modulational instability is a key feature of focusing NLS equations. All elements of the problem are rooted in established physical and mathematical principles.\n- **Well-Posed:** The problem is clearly defined with all necessary equations and definitions provided. The tasks are sequential and logically connected, leading to a unique, derivable analytic solution.\n- **Objective:** The language is precise, quantitative, and free of any subjective or ambiguous terminology.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, self-contained, and well-posed.\n\n#### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Derivation of the Solution\n\nThe problem requires a four-step derivation to find the wavenumber $q_\\ast$ of the fastest-growing tertiary sideband in the modulational instability of a drift wave.\n\n**1. Derivation of the Dispersion Coefficient $\\alpha$**\n\nThe coefficient $\\alpha$ in the NLS equation represents group velocity dispersion. For an envelope modulation in the $x$-direction (with slow coordinate $X$), $\\alpha$ is given by one-half of the second derivative of the linear frequency $\\omega(\\boldsymbol{k})$ with respect to $k_x$, evaluated at the pump wavevector $\\boldsymbol{k}_0=(k_x, k_y)$.\n$$\n\\alpha = \\frac{1}{2} \\frac{\\partial^2 \\omega}{\\partial k_x^2} \\bigg|_{\\boldsymbol{k}=\\boldsymbol{k}_0}\n$$\nThe linear dispersion relation is given as $\\omega(\\boldsymbol{k}) = k_y (1 + k_x^2 + k_y^2)^{-1}$. We compute the partial derivatives with respect to $k_x$.\n\nFirst derivative:\n$$\n\\frac{\\partial \\omega}{\\partial k_x} = k_y \\frac{\\partial}{\\partial k_x} (1 + k_x^2 + k_y^2)^{-1} = k_y \\left( -1 \\cdot (1 + k_x^2 + k_y^2)^{-2} \\cdot 2k_x \\right) = \\frac{-2 k_x k_y}{(1 + k_x^2 + k_y^2)^2}\n$$\n\nSecond derivative, using the quotient rule on the expression above:\n$$\n\\frac{\\partial^2 \\omega}{\\partial k_x^2} = -2k_y \\frac{\\partial}{\\partial k_x} \\left( \\frac{k_x}{(1 + k_x^2 + k_y^2)^2} \\right)\n$$\n$$\n\\frac{\\partial^2 \\omega}{\\partial k_x^2} = -2k_y \\left( \\frac{1 \\cdot (1 + k_x^2 + k_y^2)^2 - k_x \\cdot 2(1 + k_x^2 + k_y^2) \\cdot 2k_x}{(1 + k_x^2 + k_y^2)^4} \\right)\n$$\n$$\n\\frac{\\partial^2 \\omega}{\\partial k_x^2} = -2k_y \\left( \\frac{(1 + k_x^2 + k_y^2) - 4k_x^2}{(1 + k_x^2 + k_y^2)^3} \\right)\n$$\n$$\n\\frac{\\partial^2 \\omega}{\\partial k_x^2} = -2k_y \\left( \\frac{1 - 3k_x^2 + k_y^2}{(1 + k_x^2 + k_y^2)^3} \\right) = \\frac{2k_y (3k_x^2 - k_y^2 - 1)}{(1 + k_x^2 + k_y^2)^3}\n$$\nThe coefficient $\\alpha$ is thus:\n$$\n\\alpha = \\frac{1}{2} \\frac{\\partial^2 \\omega}{\\partial k_x^2} = \\frac{k_y (3k_x^2 - k_y^2 - 1)}{(1 + k_x^2 + k_y^2)^3}\n$$\n\n**2. Derivation of the Modulational Instability Growth Rate $\\gamma(q)$**\n\nThe NLS equation with $\\beta=1$ is $i\\,\\frac{\\partial A}{\\partial T} + \\alpha\\,\\frac{\\partial^{2} A}{\\partial X^{2}} + |A|^{2}A = 0$. We linearize this equation around the plane-wave solution $A_s(T) = A_0 \\exp(i |A_0|^2 T)$. Let the perturbed solution be $A(X,T) = (A_0 + \\delta A(X,T)) \\exp(i |A_0|^2 T)$. Substituting this into the NLS equation and retaining only terms linear in the perturbation $\\delta A$ gives the linearized equation for $\\delta A$. A simpler way is to transform into a frame rotating with the phase of the plane-wave solution. Let $A(X,T) = \\tilde{A}(X,T) \\exp(i |A_0|^2 T)$. The equation for $\\tilde{A}$ is:\n$$\ni \\left( \\frac{\\partial \\tilde{A}}{\\partial T} + i |A_0|^2 \\tilde{A} \\right) \\exp(i|A_0|^2 T) + \\alpha \\frac{\\partial^2 \\tilde{A}}{\\partial X^2} \\exp(i|A_0|^2 T) + |\\tilde{A}|^2 \\tilde{A} \\exp(i|A_0|^2 T) = 0\n$$\n$$\ni \\frac{\\partial \\tilde{A}}{\\partial T} - |A_0|^2 \\tilde{A} + \\alpha \\frac{\\partial^2 \\tilde{A}}{\\partial X^2} + |\\tilde{A}|^2 \\tilde{A} = 0\n$$\nNow, we write $\\tilde{A}(X,T) = A_0 + \\delta A(X,T)$ and linearize:\n$$\n|\\tilde{A}|^2 \\tilde{A} = |A_0 + \\delta A|^2 (A_0 + \\delta A) \\approx |A_0|^2 A_0 + 2|A_0|^2 \\delta A + A_0^2 \\delta A^*\n$$\nSubstituting this into the equation for $\\tilde{A}$ and canceling the zeroth-order terms $(-|A_0|^2 A_0 + |A_0|^2 A_0=0)$, we obtain the linear equation for the perturbation $\\delta A$:\n$$\ni \\frac{\\partial (\\delta A)}{\\partial T} + \\alpha \\frac{\\partial^2 (\\delta A)}{\\partial X^2} + |A_0|^2 \\delta A + A_0^2 \\delta A^* = 0\n$$\nWe seek solutions of the form $\\delta A(X,T) = a_1 e^{i q X + \\gamma T} + a_2 e^{-i q X + \\gamma T}$. However, the coupling term $A_0^2 \\delta A^*$ links the modes at $+q$ and $-q$. A more general ansatz is required:\n$$\n\\delta A(X,T) = (\\delta A_+ e^{i q X} + \\delta A_- e^{-i q X}) e^{\\gamma T}\n$$\nSubstituting this into the linearized equation yields two coupled algebraic equations for the amplitudes $\\delta A_+$ and $\\delta A_-^*$:\n$$\n(i \\gamma - \\alpha q^2 + |A_0|^2) \\delta A_+ + A_0^2 \\delta A_-^* = 0\n$$\n$$\n(i \\gamma - \\alpha q^2 + |A_0|^2) \\delta A_- + A_0^2 \\delta A_+^* = 0\n$$\nTaking the complex conjugate of the second equation and assuming a real growth rate $\\gamma$ gives:\n$$\n(-i \\gamma - \\alpha q^2 + |A_0|^2) \\delta A_-^* + (A_0^*)^2 \\delta A_+ = 0\n$$\nWe have a system of two linear equations for $\\delta A_+$ and $\\delta A_-^*$. For a non-trivial solution, the determinant of the coefficient matrix must be zero:\n$$\n\\det \\begin{pmatrix} i \\gamma - \\alpha q^2 + |A_0|^2 & A_0^2 \\\\ (A_0^*)^2 & -i \\gamma - \\alpha q^2 + |A_0|^2 \\end{pmatrix} = 0\n$$\n$$\n(i \\gamma - \\alpha q^2 + |A_0|^2)(-i \\gamma - \\alpha q^2 + |A_0|^2) - |A_0|^4 = 0\n$$\nLet $W = \\alpha q^2 - |A_0|^2$. The equation becomes $(i\\gamma - W)(-i\\gamma - W) - |A_0|^4 = 0$.\n$$\n\\gamma^2 + W^2 - |A_0|^4 = 0 \\implies \\gamma^2 = |A_0|^4 - W^2 = |A_0|^4 - (\\alpha q^2 - |A_0|^2)^2\n$$\n$$\n\\gamma^2 = (|A_0|^2 - (\\alpha q^2 - |A_0|^2))(|A_0|^2 + (\\alpha q^2 - |A_0|^2))\n$$\n$$\n\\gamma^2 = (2|A_0|^2 - \\alpha q^2)(\\alpha q^2)\n$$\nThe growth rate $\\gamma(q)$ is the positive square root of this expression:\n$$\n\\gamma(q) = \\sqrt{\\alpha q^2 (2|A_0|^2 - \\alpha q^2)}\n$$\n\n**3. Modulational Instability Condition**\n\nInstability occurs when the growth rate $\\gamma$ is real and positive, which requires $\\gamma^2 > 0$.\n$$\n\\alpha q^2 (2|A_0|^2 - \\alpha q^2) > 0\n$$\nThe problem states to assume the focusing condition, which for the NLS with $\\beta=1>0$ is $\\alpha > 0$. Since $q^2 > 0$, the term $\\alpha q^2$ is positive. The condition for instability thus becomes:\n$$\n2|A_0|^2 - \\alpha q^2 > 0 \\implies \\alpha q^2 < 2|A_0|^2\n$$\nThis inequality, `$\\alpha q^2 < 2|A_0|^2$`, together with the focusing condition $\\alpha > 0$, defines the range of unstable wavenumbers: $0 < q^2 < 2|A_0|^2 / \\alpha$.\n\n**4. Wavenumber of Fastest-Growing Mode, $q_\\ast$**\n\nTo find the wavenumber $q_\\ast$ that maximizes the growth rate $\\gamma(q)$, we can maximize its square, $\\gamma^2(q)$. Let $z = q^2$. We want to maximize the function $f(z) = \\alpha z (2|A_0|^2 - \\alpha z) = 2\\alpha|A_0|^2 z - \\alpha^2 z^2$ for $z > 0$. We find the critical point by setting the derivative with respect to $z$ to zero:\n$$\n\\frac{df}{dz} = 2\\alpha|A_0|^2 - 2\\alpha^2 z = 0\n$$\nSolving for $z$:\n$$\n2\\alpha^2 z = 2\\alpha|A_0|^2 \\implies z = \\frac{|A_0|^2}{\\alpha}\n$$\nThis corresponds to the squared wavenumber of the fastest-growing mode:\n$$\nq_\\ast^2 = \\frac{|A_0|^2}{\\alpha}\n$$\nThe second derivative is $d^2f/dz^2 = -2\\alpha^2 < 0$ (since $\\alpha$ is real and non-zero), confirming this is a maximum. The wavenumber $q_\\ast$ is the positive square root:\n$$\nq_\\ast = \\sqrt{\\frac{|A_0|^2}{\\alpha}} = \\frac{|A_0|}{\\sqrt{\\alpha}}\n$$\nSubstituting the expression for $\\alpha$ derived in the first step:\n$$\nq_\\ast = |A_0| \\left( \\frac{k_y (3k_x^2 - k_y^2 - 1)}{(1 + k_x^2 + k_y^2)^3} \\right)^{-1/2}\n$$\n$$\nq_\\ast = |A_0| \\sqrt{\\frac{(1 + k_x^2 + k_y^2)^3}{k_y (3k_x^2 - k_y^2 - 1)}}\n$$\nThis is the final closed-form expression for the wavenumber of the fastest-growing tertiary instability, which is already in the normalized units of $\\rho_s^{-1}$ as per the problem's setup.",
            "answer": "$$\n\\boxed{|A_0| \\sqrt{\\frac{(1 + k_x^2 + k_y^2)^3}{k_y (3k_x^2 - k_y^2 - 1)}}}\n$$"
        },
        {
            "introduction": "While instabilities provide the drive for turbulence, dissipative processes are essential for establishing a final saturated state. This problem focuses on the role of collisions in regulating tertiary modes. By employing a model Lorentz pitch-angle scattering operator, you will quantify how collisional processes dissipate the free energy associated with a growing mode . This hands-on calculation will allow you to derive a critical collisionality, providing a clear criterion for when damping is strong enough to suppress the tertiary instability entirely.",
            "id": "4052563",
            "problem": "Consider an electrostatic, magnetized plasma described by the nonlinear gyrokinetic equation for the non-adiabatic part of the distribution function $h(\\mathbf{R}, v, \\xi, t)$, where $\\mathbf{R}$ is the gyrocenter position, $v$ is the speed, and $\\xi = v_{\\parallel}/v$ is the pitch-angle cosine. Let the equilibrium distribution be a stationary Maxwellian $F_{0}(v)$, and define the gyrokinetic free energy as\n$$\nW(t) = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h(\\mathbf{R}, v, \\xi, t)|^{2}}{2\\,F_{0}(v)}.\n$$\nAssume that collisional effects enter through the model Lorentz pitch-angle scattering operator, a simplification of the Fokker–Planck (FP) collision operator that preserves self-adjointness in $\\xi$,\n$$\nC[h] = \\nu\\,\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial h}{\\partial \\xi}\\right],\n$$\nwith constant collision frequency $\\nu>0$. Near tertiary onset, consider a single-mode perturbation whose pitch-angle structure is dominated by a single Legendre polynomial $P_{\\ell}(\\xi)$ of degree $\\ell \\in \\mathbb{N}$, and whose spatial dependence is single Fourier mode in the radial direction,\n$$\nh(\\mathbf{R}, v, \\xi, t) = \\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x),\n$$\nwith $k_{x}$ a constant radial wavenumber and $\\hat{h}(v, t)$ a slowly varying amplitude. The tertiary drive is modeled by an effective linear growth rate $\\gamma_{t}>0$, arising from the interaction of pre-existing zonal flows with background gradients, so that the net linear contribution to the amplitude dynamics is $\\partial_{t}\\hat{h} = \\gamma_{t}\\,\\hat{h} + \\text{collisions} + \\text{nonlinear terms}$. Neglect all nonlinear terms and parallel streaming for the purpose of this calculation.\n\nStarting from the provided definitions and without invoking any shortcut formulas, do the following:\n\n1. Compute analytically the collisional contribution to the free-energy time derivative,\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h}{F_{0}}\\,C[h],\n$$\nfor the given model and mode structure. Express your result in terms of $\\nu$, $\\ell$, and the free energy $W$.\n\n2. From your result, infer the effective collisional damping rate of the mode amplitude and obtain a criterion that delineates suppression of tertiary growth by collisional damping. Derive the critical collisionality $\\nu_{c}$ such that tertiary growth is marginal, expressed in terms of $\\gamma_{t}$ and $\\ell$.\n\nProvide your final answer as a single closed-form analytic expression for $\\nu_{c}$. No numerical evaluation is required, and no rounding is necessary. Do not include units in the final expression.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\nThe givens are:\n1.  The gyrokinetic free energy: $W(t) = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h(\\mathbf{R}, v, \\xi, t)|^{2}}{2\\,F_{0}(v)}$.\n2.  The equilibrium distribution is a Maxwellian $F_{0}(v)$.\n3.  The collisional process is modeled by the Lorentz pitch-angle scattering operator: $C[h] = \\nu\\,\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial h}{\\partial \\xi}\\right]$, with $\\nu > 0$.\n4.  The perturbation has a single-mode structure: $h(\\mathbf{R}, v, \\xi, t) = \\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x)$, for a Legendre polynomial $P_{\\ell}(\\xi)$ of degree $\\ell \\in \\mathbb{N}$.\n5.  A tertiary instability provides an effective linear growth rate $\\gamma_{t} > 0$.\n6.  The linear dynamics of the mode amplitude are governed by growth and collisions. Nonlinear terms and parallel streaming are to be neglected.\n7.  The quantity to be calculated is specified as $\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h}{F_{0}}\\,C[h]$.\n\nThe problem is scientifically grounded in the established framework of gyrokinetic theory for magnetized plasmas, a core topic in computational fusion science. The concepts of free energy, collision operators, and linear stability analysis are standard. The problem is well-posed, providing all necessary definitions and constraints to arrive at a unique, meaningful answer. The language is objective and precise.\n\nThere is, however, a subtle ambiguity in the definition of the collisional free-energy dissipation rate. The quantity $W(t)$ is real, so its time derivative must also be real. The perturbation $h$ is given as a complex function. The operator $C$ is a real differential operator. The provided expression, $\\int \\frac{h}{F_{0}}C[h]\\,d^{3}\\mathbf{R}\\,d^{3}\\mathbf{v}$, would in general evaluate to a complex number. The physically correct expression for the rate of change of free energy due to a process $\\mathcal{L}[h]$ is $\\frac{d W}{d t} = \\int \\text{Re}\\left( \\frac{h^*}{F_0} \\mathcal{L}[h] \\right) d^3\\mathbf{R}\\,d^3\\mathbf{v}$. For the collisional process, this is $\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int \\text{Re}\\left( \\frac{h^*}{F_0} C[h] \\right) d^3\\mathbf{R}\\,d^3\\mathbf{v}$. Because the operator $C$ is self-adjoint with respect to the inner product on the space of functions of $\\xi$, the integral $\\int h^* C[h] d\\xi$ is purely real and negative, representing dissipation. Therefore, the expression in the problem statement is interpreted as a notational shorthand for the physically rigorous form, $\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h^{*}}{F_{0}}\\,C[h]$. With this necessary clarification, the problem is deemed valid and solvable.\n\n**1. Computation of the collisional contribution to the free-energy time derivative**\n\nWe begin with the corrected expression for the collisional dissipation rate:\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h^{*}(\\mathbf{R}, v, \\xi, t)}{F_{0}(v)}\\,C[h(\\mathbf{R}, v, \\xi, t)]\n$$\nThe collision operator $C$ acts only on the pitch-angle variable $\\xi$. The perturbation $h$ is given as $h = \\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x)$. We first evaluate the action of $C$ on $h$:\n$$\nC[h] = C[\\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x)] = \\hat{h}(v, t)\\,\\exp(i k_{x} x) \\cdot \\nu\\,\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial P_{\\ell}(\\xi)}{\\partial \\xi}\\right]\n$$\nThe Legendre polynomials $P_{\\ell}(\\xi)$ are eigenfunctions of the operator $\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial}{\\partial \\xi}\\right]$. They satisfy Legendre's differential equation:\n$$\n\\frac{d}{d\\xi}\\left[(1-\\xi^{2})\\frac{dP_{\\ell}(\\xi)}{d\\xi}\\right] + \\ell(\\ell+1)P_{\\ell}(\\xi) = 0\n$$\nFrom this, we identify the action of the differential part of the collision operator:\n$$\n\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial P_{\\ell}(\\xi)}{\\partial \\xi}\\right] = -\\ell(\\ell+1)P_{\\ell}(\\xi)\n$$\nSubstituting this result back into the expression for $C[h]$:\n$$\nC[h] = \\hat{h}(v, t)\\,\\exp(i k_{x} x) \\cdot \\nu [-\\ell(\\ell+1)P_{\\ell}(\\xi)] = -\\nu\\ell(\\ell+1) \\left[ \\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x) \\right]\n$$\nThis simplifies to:\n$$\nC[h] = -\\nu\\ell(\\ell+1)h\n$$\nThe specified perturbation is an eigenmode of the collision operator with eigenvalue $-\\nu\\ell(\\ell+1)$.\n\nNow, we substitute this simplified form of $C[h]$ into the integral for $\\left.\\frac{dW}{dt}\\right|_{\\text{coll}}$:\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h^{*}}{F_{0}}\\,[-\\nu\\ell(\\ell+1)h]\n$$\nThe constants $\\nu$, $\\ell$, and $\\ell+1$ can be factored out of the integral:\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = -\\nu\\ell(\\ell+1) \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h^{*}h}{F_{0}} = -\\nu\\ell(\\ell+1) \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h|^{2}}{F_{0}}\n$$\nWe relate this integral back to the definition of the free energy, $W(t) = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h|^{2}}{2\\,F_{0}}$.\nFrom this definition, we have $\\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h|^{2}}{F_{0}} = 2W(t)$.\nSubstituting this into our expression for the collisional dissipation rate gives the final result for the first part of the problem:\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = -\\nu\\ell(\\ell+1) [2W(t)] = -2\\nu\\ell(\\ell+1)W(t)\n$$\n\n**2. Derivation of the critical collisionality $\\nu_c$**\n\nThe problem states that the net linear contribution to the amplitude dynamics is $\\partial_{t}\\hat{h} = \\gamma_{t}\\,\\hat{h} + \\text{collisions} + \\dots$. Since the entire perturbation $h$ has the same time dependence as its amplitude $\\hat{h}$, we can write the linear evolution equation for $h$ as:\n$$\n\\frac{\\partial h}{\\partial t} = \\gamma_{t} h + C[h]\n$$\nWe have already determined that for the given mode structure, $C[h] = -\\nu\\ell(\\ell+1)h$. Substituting this into the evolution equation yields:\n$$\n\\frac{\\partial h}{\\partial t} = \\gamma_{t} h - \\nu\\ell(\\ell+1)h = \\left(\\gamma_{t} - \\nu\\ell(\\ell+1)\\right)h\n$$\nThe term $\\gamma_{t}$ represents the growth rate of the mode amplitude, while the term $\\nu\\ell(\\ell+1)$ represents the collisional damping rate of the mode amplitude. Let's denote the damping rate by $\\gamma_d = \\nu\\ell(\\ell+1)$.\n\nSuppression of the tertiary growth occurs when the net growth rate is less than or equal to zero. The case of marginal growth, which defines the boundary between growth and suppression, corresponds to the net growth rate being exactly zero:\n$$\n\\gamma_{\\text{net}} = \\gamma_{t} - \\gamma_{d} = 0\n$$\nThis condition occurs at a specific, critical value of the collision frequency, which we denote as $\\nu_c$. We set $\\nu = \\nu_c$ in the marginal stability condition:\n$$\n\\gamma_{t} - \\nu_{c}\\ell(\\ell+1) = 0\n$$\nSolving for the critical collisionality $\\nu_c$, we obtain:\n$$\n\\nu_{c} = \\frac{\\gamma_{t}}{\\ell(\\ell+1)}\n$$\nThis expression gives the minimum collision frequency required to exactly balance the tertiary growth rate for a mode with pitch-angle structure dominated by the Legendre polynomial of degree $\\ell$.\nThis result is consistent with our finding for the free energy evolution. The total time derivative of the free energy is $\\frac{dW}{dt} = \\left.\\frac{dW}{dt}\\right|_{\\text{drive}} + \\left.\\frac{dW}{dt}\\right|_{\\text{coll}}$. The drive term is $2\\gamma_t W$, and we found the collisional term to be $-2\\nu\\ell(\\ell+1)W$. Thus, $\\frac{dW}{dt} = 2(\\gamma_t - \\nu\\ell(\\ell+1))W$. Marginal stability ($dW/dt = 0$) once again leads to $\\gamma_t - \\nu_c\\ell(\\ell+1) = 0$.",
            "answer": "$$\n\\boxed{\\frac{\\gamma_t}{\\ell(\\ell+1)}}\n$$"
        },
        {
            "introduction": "The ultimate goal of studying micro-instabilities is to understand their impact on macroscopic plasma behavior. This computational exercise integrates the concepts of drive, regulation, and breakdown into a single dynamical system. You will implement a reduced \"predator-prey\" model where turbulence, zonal flows, and the pressure gradient interact nonlinearly, including a term for tertiary breakdown of the regulatory flows . By simulating this system, you will explore how the competition between these processes can lead to distinct confinement regimes, such as a steady quiescent state or a cycle of violent, repetitive bursts analogous to Edge-Localized Modes (ELMs).",
            "id": "4052609",
            "problem": "You are tasked with constructing and numerically integrating a reduced, dimensionless edge model for quiescent High-confinement mode (H-mode) and Edge-Localized Mode (ELM)-like bursts in a magnetically confined plasma, by combining drift-wave drive, zonal-flow shear, and tertiary breakdown effects. High-confinement mode (H-mode) and Edge-Localized Mode (ELM) must be treated as outcomes emerging from a set of dynamical equations built from first principles. Your program must classify each provided parameter set as either quiescent H-mode or ELM-like bursting and report auxiliary metrics. All variables and parameters in this problem are dimensionless.\n\nStarting base and physical principles to be used:\n- Drift-wave turbulence energy grows when the pressure-gradient drive exceeds dissipation. Let the drift-wave turbulence energy be denoted by $E(t)$ and the edge pressure-gradient drive be $G(t)$. The linear growth contribution scales with the gradient, and dissipation reduces energy.\n- Zonal flows are generated via Reynolds stress from turbulence and suppress turbulence through shearing. Let the zonal flow energy (or mean-squared shear amplitude) be denoted by $Z(t)$. The effective shearing rate is defined as $\\Omega_s(t) = k_s Z(t)$, where $k_s$ is a dimensionless wavenumber-squared factor for the zonal shear.\n- Tertiary instability represents the breakdown of strong zonal shear into small-scale turbulence when the shear exceeds a gradient-dependent threshold. Model the tertiary conversion rate as a nonnegative function $\\mathcal{T}(Z,G) = c_t \\max\\{0, \\Omega_s - \\kappa_t G\\}$, where $c_t$ is a conversion coefficient and $\\kappa_t$ sets the threshold dependence on the gradient.\n- Energy and gradient evolve according to conservation and transport: external heating increases the gradient drive, while turbulence and shear transport reduce it.\n\nConstruct the following closed, autonomous system consistent with the above principles:\n1. The drift-wave turbulence energy equation combines linear growth from $G$, shear suppression, nonlinear saturation, and tertiary conversion into turbulence:\n$$\n\\frac{dE}{dt} = \\left(\\alpha G - \\mu_E\\right) E - \\beta_Z \\Omega_s E - \\nu_E E^2 + \\eta_T \\,\\mathcal{T}(Z,G),\n$$\nwhere $\\alpha$, $\\mu_E$, $\\beta_Z$, and $\\nu_E$ are positive coefficients, and $\\eta_T$ transfers tertiary conversion into $E$.\n2. The zonal-flow energy equation is driven by turbulence, damped, and depleted by tertiary breakdown:\n$$\n\\frac{dZ}{dt} = \\chi_E E - \\mu_Z Z - \\mathcal{T}(Z,G),\n$$\nwhere $\\chi_E$ and $\\mu_Z$ are positive coefficients.\n3. The gradient drive equation includes external input $P_\\text{in}$ and turbulent/shear transport losses:\n$$\n\\frac{dG}{dt} = P_\\text{in} - \\lambda_E E G - \\lambda_Z Z G - \\mu_G G,\n$$\nwhere $P_\\text{in}$, $\\lambda_E$, $\\lambda_Z$, and $\\mu_G$ are positive coefficients.\n\nAll state variables must remain nonnegative. In numerical implementation, if any state temporarily becomes negative due to numerical error, use its nonnegative part in all right-hand side evaluations. Integrate forward in dimensionless time from initial conditions $E(0) = 0.05$, $Z(0) = 0.10$, $G(0) = 1.00$ up to final time $T_\\text{end} = 500$.\n\nClassification rules:\n- Define the quiescent thresholds $E_\\text{quiet} = 0.20$ and $Z_\\text{quiet} = 0.40$.\n- Define the burst threshold $E_\\text{burst} = 0.50$.\n- A case is classified as quiescent H-mode if the fraction of sampled times for which $E(t) < E_\\text{quiet}$ and $Z(t) > Z_\\text{quiet}$ simultaneously is at least $0.90$, and the number of identified bursts is $0$. Otherwise, it is classified as ELM-like bursting.\n- Identify a burst as any local maximum of $E(t)$ that exceeds $E_\\text{burst}$ and is preceded and followed by local minima less than $E_\\text{quiet}$. Report the number of bursts and the time of the first burst if any; if no burst occurs, report $-1.0$ for the first-burst time.\n\nNumerical requirements:\n- Use a robust ordinary differential equation solver with adaptive step control.\n- Sample the solution at $N_s = 5000$ evenly spaced time points over $[0, T_\\text{end}]$ for classification and burst detection.\n\nTest suite:\nImplement the model for the following five parameter sets. Each test case uses $E(0) = 0.05$, $Z(0) = 0.10$, $G(0) = 1.00$, $T_\\text{end} = 500$, and $N_s = 5000$. The parameter vectors are:\n- Case $\\#1$ (expected quiescent): $\\alpha = 1.40$, $\\mu_E = 0.30$, $\\beta_Z = 0.80$, $\\nu_E = 0.20$, $\\chi_E = 1.00$, $\\mu_Z = 0.25$, $k_s = 1.00$, $c_t = 0.40$, $\\kappa_t = 1.20$, $\\eta_T = 0.60$, $\\lambda_E = 0.50$, $\\lambda_Z = 0.30$, $\\mu_G = 0.40$, $P_\\text{in} = 0.60$.\n- Case $\\#2$ (expected bursting): $\\alpha = 1.80$, $\\mu_E = 0.25$, $\\beta_Z = 0.70$, $\\nu_E = 0.18$, $\\chi_E = 0.80$, $\\mu_Z = 0.15$, $k_s = 1.20$, $c_t = 1.00$, $\\kappa_t = 0.80$, $\\eta_T = 0.80$, $\\lambda_E = 0.60$, $\\lambda_Z = 0.35$, $\\mu_G = 0.45$, $P_\\text{in} = 1.00$.\n- Case $\\#3$ (near threshold): $\\alpha = 1.60$, $\\mu_E = 0.30$, $\\beta_Z = 0.75$, $\\nu_E = 0.20$, $\\chi_E = 0.90$, $\\mu_Z = 0.20$, $k_s = 1.00$, $c_t = 0.70$, $\\kappa_t = 1.00$, $\\eta_T = 0.70$, $\\lambda_E = 0.55$, $\\lambda_Z = 0.32$, $\\mu_G = 0.42$, $P_\\text{in} = 0.80$.\n- Case $\\#4$ (no tertiary breakdown): $\\alpha = 1.80$, $\\mu_E = 0.25$, $\\beta_Z = 0.70$, $\\nu_E = 0.18$, $\\chi_E = 0.80$, $\\mu_Z = 0.15$, $k_s = 1.20$, $c_t = 0.00$, $\\kappa_t = 0.80$, $\\eta_T = 0.80$, $\\lambda_E = 0.60$, $\\lambda_Z = 0.35$, $\\mu_G = 0.45$, $P_\\text{in} = 1.00$.\n- Case $\\#5$ (strong damping): $\\alpha = 1.20$, $\\mu_E = 0.60$, $\\beta_Z = 0.85$, $\\nu_E = 0.25$, $\\chi_E = 0.90$, $\\mu_Z = 0.40$, $k_s = 1.00$, $c_t = 0.60$, $\\kappa_t = 1.00$, $\\eta_T = 0.70$, $\\lambda_E = 0.50$, $\\lambda_Z = 0.30$, $\\mu_G = 0.50$, $P_\\text{in} = 0.70$.\n\nOutput specification:\nFor each test case, produce a three-element list $[b, n, t]$, where $b$ is a boolean indicating quiescent H-mode ($\\text{True}$) or ELM-like bursting ($\\text{False}$), $n$ is the integer number of identified bursts, and $t$ is the float time of the first burst (use $-1.0$ if no burst). Your program should produce a single line of output containing the results for all five cases as a comma-separated list enclosed in square brackets, for example, $[ [\\dots], [\\dots], [\\dots], [\\dots], [\\dots] ]$. Angles are not used. No physical units are used; all variables are dimensionless. The program must be completely self-contained and must not require any input.",
            "solution": "The user-provided problem is assessed for validity before attempting a solution.\n\n### Step 1: Extract Givens\n- **State Variables**: $E(t)$ (drift-wave turbulence energy), $Z(t)$ (zonal flow energy), $G(t)$ (edge pressure-gradient drive). All are dimensionless.\n- **System of ODEs**:\n$$\n\\frac{dE}{dt} = \\left(\\alpha G - \\mu_E\\right) E - \\beta_Z \\Omega_s E - \\nu_E E^2 + \\eta_T \\,\\mathcal{T}(Z,G)\n$$\n$$\n\\frac{dZ}{dt} = \\chi_E E - \\mu_Z Z - \\mathcal{T}(Z,G)\n$$\n$$\n\\frac{dG}{dt} = P_\\text{in} - \\lambda_E E G - \\lambda_Z Z G - \\mu_G G\n$$\n- **Auxiliary Definitions**:\n  - Effective shearing rate: $\\Omega_s(t) = k_s Z(t)$\n  - Tertiary conversion rate: $\\mathcal{T}(Z,G) = c_t \\max\\{0, \\Omega_s - \\kappa_t G\\}$\n- **Parameters**: $\\alpha, \\mu_E, \\beta_Z, \\nu_E, \\eta_T, \\chi_E, \\mu_Z, k_s, c_t, \\kappa_t, P_\\text{in}, \\lambda_E, \\lambda_Z, \\mu_G$. All are positive coefficients.\n- **Initial Conditions**: $E(0) = 0.05$, $Z(0) = 0.10$, $G(0) = 1.00$.\n- **Integration Interval**: $t \\in [0, T_\\text{end}]$, where $T_\\text{end} = 500$.\n- **Numerical Constraint**: State variables must remain nonnegative. If $E$, $Z$, or $G$ become negative, their nonnegative part, $\\max(0, \\cdot)$, must be used in the right-hand side evaluation.\n- **Sampling**: The solution is to be sampled at $N_s = 5000$ evenly spaced time points.\n- **Classification Rules**:\n  - Quiescent thresholds: $E_\\text{quiet} = 0.20$, $Z_\\text{quiet} = 0.40$.\n  - Burst threshold: $E_\\text{burst} = 0.50$.\n  - **Quiescent H-mode**: The fraction of sampled times where $E(t) < E_\\text{quiet}$ and $Z(t) > Z_\\text{quiet}$ is at least $0.90$, AND the number of identified bursts is $0$.\n  - **ELM-like bursting**: Any case not classified as quiescent H-mode.\n- **Burst Identification**: A burst is a local maximum of $E(t)$ that is greater than $E_\\text{burst}$ and is both preceded and followed by local minima that are less than $E_\\text{quiet}$.\n- **Output Metrics**: For each case, a list $[b, n, t]$ where $b$ is a boolean for quiescent mode, $n$ is the number of bursts, and $t$ is the time of the first burst (or $-1.0$ if none).\n- **Test Suite**: Five distinct sets of parameters are provided for simulation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The model is a system of predator-prey-resource equations, a well-established paradigm for modeling plasma turbulence ($E$, the predator), zonal flows ($Z$, the prey), and the pressure gradient ($G$, the resource). The inclusion of a tertiary instability mechanism for zonal flow breakdown is a legitimate and contemporary extension in fusion plasma theory used to explain phenomena like Edge-Localized Modes (ELMs). The model, while simplified (a \"0D\" model), is grounded in recognized physical principles of plasma transport and turbulence regulation.\n- **Well-Posed**: The problem specifies a complete initial value problem (IVP) for a system of first-order ordinary differential equations (ODEs). The right-hand side functions are continuous and locally Lipschitz, which guarantees the existence and uniqueness of a solution for a finite time interval. All required initial conditions, parameters, and time domains are provided. The problem is well-posed.\n- **Objective**: All definitions, rules for classification, and parameters are specified with mathematical precision. The problem statement is free of ambiguity, subjectivity, or opinion.\n- **Checklist Assessment**:\n    1.  *Scientific/Factual Unsoundness*: None. The model is a valid, albeit reduced, representation of phenomena studied in computational fusion science.\n    2.  *Non-Formalizable/Irrelevant*: None. The problem is explicitly mathematical and is directly relevant to the specified topic.\n    3.  *Incomplete/Contradictory Setup*: None. All necessary information is provided and is self-consistent.\n    4.  *Unrealistic/Infeasible*: None. The problem is dimensionless, and the numerical integration is computationally feasible.\n    5.  *Ill-Posed/Poorly Structured*: None. The problem is a standard IVP with clear post-processing instructions.\n    6.  *Pseudo-Profound/Trivial*: None. The nonlinear, coupled nature of the ODEs can lead to complex dynamics (e.g., fixed points, limit cycles, bursting), requiring numerical solution and analysis.\n    7.  *Outside Scientific Verifiability*: None. The numerical results can be independently reproduced and verified.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be constructed.\n\n### Solution Design\nThe solution involves two main stages: numerical integration of the provided system of ODEs and subsequent analysis of the resulting time series to classify the system's behavior.\n\n**1. Numerical Integration of the System of ODEs**\n\nThe core of the problem is to solve the initial value problem defined by the three coupled, nonlinear ordinary differential equations for the state vector $\\vec{y}(t) = [E(t), Z(t), G(t)]^T$. The system is given by $\\frac{d\\vec{y}}{dt} = \\vec{f}(t, \\vec{y}, \\vec{p})$, where $\\vec{p}$ is the vector of model parameters.\n\nThe function $\\vec{f}$ is implemented as follows:\nFirst, we define the state variables ensuring non-negativity, as required by the physical constraints of the model. Though the ODE solver should maintain positivity for a well-behaved physical system, numerical integration schemes can transiently produce small negative values. We enforce positivity at each step of the right-hand side evaluation: $E = \\max(0, y_0)$, $Z = \\max(0, y_1)$, $G = \\max(0, y_2)$.\n\nNext, we calculate the intermediate quantities:\n- The effective shearing rate: $\\Omega_s = k_s Z$.\n- The tertiary conversion rate: $\\mathcal{T}(Z,G) = c_t \\max\\{0, \\Omega_s - \\kappa_t G\\}$.\n\nFinally, we compute the time derivatives using these quantities and the system parameters:\n- $\\frac{dE}{dt} = (\\alpha G - \\mu_E) E - \\beta_Z \\Omega_s E - \\nu_E E^2 + \\eta_T \\mathcal{T}$\n- $\\frac{dZ}{dt} = \\chi_E E - \\mu_Z Z - \\mathcal{T}$\n- $\\frac{dG}{dt} = P_\\text{in} - \\lambda_E E G - \\lambda_Z Z G - \\mu_G G$\n\nThis system will be integrated using a robust adaptive step-size ODE solver. The `scipy.integrate.solve_ivp` function from the SciPy library is ideally suited for this task. We will integrate from $t=0$ to $T_\\text{end}=500$ with initial conditions $E(0)=0.05$, $Z(0)=0.10$, and $G(0)=1.00$. To facilitate the analysis, we will instruct the solver to output the solution at $N_s=5000$ uniformly spaced points in the integration interval.\n\n**2. Analysis of the Solution Time Series**\n\nAfter obtaining the discrete time series for $E(t)$, $Z(t)$, and $G(t)$, we perform the analysis as specified.\n\n**a. Burst Detection**\nA burst is a specific type of large-amplitude event in the turbulence energy $E(t)$. To identify bursts, we must first find all local maxima and minima in the time series $E(t)$. This can be done efficiently by finding points where the discrete derivative changes sign. A point $E_i$ at time $t_i$ is a local maximum if $E_{i-1} < E_i > E_{i+1}$, and a local minimum if $E_{i-1} > E_i < E_{i+1}$.\n\nWith the lists of maxima and minima indices, we proceed to validate each potential burst:\n1. Identify all local maxima where the energy $E(t_i)$ exceeds the burst threshold, $E(t_i) > E_\\text{burst} = 0.50$.\n2. For each such maximum, find the closest preceding local minimum and the closest following local minimum.\n3. A valid burst is confirmed if both the preceding and following minima are below the quiescent energy threshold, $E_\\text{min} < E_\\text{quiet} = 0.20$.\n4. The number of bursts $n$ is the total count of such validated events. The time of the first burst $t$ is the time corresponding to the first validated maximum. If no bursts are found, $n=0$ and $t=-1.0$.\n\n**b. Classification of Dynamics**\nThe system's behavior for a given parameter set is classified as either \"quiescent H-mode\" or \"ELM-like bursting\".\n1. A quiescent state at a given time $t$ is defined by the simultaneous conditions $E(t) < E_\\text{quiet} = 0.20$ and $Z(t) > Z_\\text{quiet} = 0.40$.\n2. We calculate the fraction of the $N_s=5000$ sampled time points that satisfy this quiescent condition.\n3. The case is classified as quiescent H-mode ($b=\\text{True}$) if this fraction is at least $0.90$ AND the number of bursts $n$ is exactly $0$.\n4. Otherwise, the case is classified as ELM-like bursting ($b=\\text{False}$).\n\nThis entire process, from integration to analysis, is repeated for each of the five parameter sets provided in the test suite. The final output is an aggregation of the $[b, n, t]$ triplets for each case, formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef model_rhs(t, y, params):\n    \"\"\"\n    Computes the right-hand side of the ODE system for the reduced plasma edge model.\n    y: state vector [E, Z, G]\n    params: dictionary of model parameters\n    \"\"\"\n    # Enforce non-negativity of state variables\n    E, Z, G = np.maximum(0, y)\n\n    # Unpack parameters\n    alpha = params['alpha']\n    mu_E = params['mu_E']\n    beta_Z = params['beta_Z']\n    nu_E = params['nu_E']\n    chi_E = params['chi_E']\n    mu_Z = params['mu_Z']\n    k_s = params['k_s']\n    c_t = params['c_t']\n    kappa_t = params['kappa_t']\n    eta_T = params['eta_T']\n    lambda_E = params['lambda_E']\n    lambda_Z = params['lambda_Z']\n    mu_G = params['mu_G']\n    P_in = params['P_in']\n\n    # Intermediate quantities\n    Omega_s = k_s * Z\n    T_val = c_t * max(0, Omega_s - kappa_t * G)\n\n    # ODEs\n    dE_dt = (alpha * G - mu_E) * E - beta_Z * Omega_s * E - nu_E * E**2 + eta_T * T_val\n    dZ_dt = chi_E * E - mu_Z * Z - T_val\n    dG_dt = P_in - lambda_E * E * G - lambda_Z * Z * G - mu_G * G\n\n    return [dE_dt, dZ_dt, dG_dt]\n\ndef analyze_solution(t_eval, solution, thresholds):\n    \"\"\"Analyzes the ODE solution to classify dynamics and detect bursts.\"\"\"\n    E_t, Z_t, G_t = solution\n\n    E_quiet = thresholds['E_quiet']\n    Z_quiet = thresholds['Z_quiet']\n    E_burst = thresholds['E_burst']\n\n    # --- Burst Detection ---\n    # Find local maxima and minima indices\n    maxima_indices = np.where((E_t[1:-1] > E_t[:-2]) & (E_t[1:-1] > E_t[2:]))[0] + 1\n    minima_indices = np.where((E_t[1:-1]  E_t[:-2])  (E_t[1:-1]  E_t[2:]))[0] + 1\n\n    potential_burst_indices = [idx for idx in maxima_indices if E_t[idx] > E_burst]\n    \n    burst_times = []\n    if minima_indices.size > 0:\n        for p_idx in potential_burst_indices:\n            preceding_mins = minima_indices[minima_indices  p_idx]\n            following_mins = minima_indices[minima_indices > p_idx]\n\n            if preceding_mins.size > 0 and following_mins.size > 0:\n                closest_prev_min_idx = preceding_mins[-1]\n                closest_fol_min_idx = following_mins[0]\n\n                if E_t[closest_prev_min_idx]  E_quiet and E_t[closest_fol_min_idx]  E_quiet:\n                    burst_times.append(t_eval[p_idx])\n\n    num_bursts = len(burst_times)\n    first_burst_time = burst_times[0] if num_bursts > 0 else -1.0\n\n    # --- Classification ---\n    is_quiescent_sample = (E_t  E_quiet)  (Z_t > Z_quiet)\n    quiescent_fraction = np.sum(is_quiescent_sample) / len(t_eval)\n\n    is_quiescent_mode = (quiescent_fraction >= 0.90) and (num_bursts == 0)\n\n    return [is_quiescent_mode, num_bursts, first_burst_time]\n\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'alpha': 1.40, 'mu_E': 0.30, 'beta_Z': 0.80, 'nu_E': 0.20, 'chi_E': 1.00, 'mu_Z': 0.25, 'k_s': 1.00, 'c_t': 0.40, 'kappa_t': 1.20, 'eta_T': 0.60, 'lambda_E': 0.50, 'lambda_Z': 0.30, 'mu_G': 0.40, 'P_in': 0.60},\n        {'alpha': 1.80, 'mu_E': 0.25, 'beta_Z': 0.70, 'nu_E': 0.18, 'chi_E': 0.80, 'mu_Z': 0.15, 'k_s': 1.20, 'c_t': 1.00, 'kappa_t': 0.80, 'eta_T': 0.80, 'lambda_E': 0.60, 'lambda_Z': 0.35, 'mu_G': 0.45, 'P_in': 1.00},\n        {'alpha': 1.60, 'mu_E': 0.30, 'beta_Z': 0.75, 'nu_E': 0.20, 'chi_E': 0.90, 'mu_Z': 0.20, 'k_s': 1.00, 'c_t': 0.70, 'kappa_t': 1.00, 'eta_T': 0.70, 'lambda_E': 0.55, 'lambda_Z': 0.32, 'mu_G': 0.42, 'P_in': 0.80},\n        {'alpha': 1.80, 'mu_E': 0.25, 'beta_Z': 0.70, 'nu_E': 0.18, 'chi_E': 0.80, 'mu_Z': 0.15, 'k_s': 1.20, 'c_t': 0.00, 'kappa_t': 0.80, 'eta_T': 0.80, 'lambda_E': 0.60, 'lambda_Z': 0.35, 'mu_G': 0.45, 'P_in': 1.00},\n        {'alpha': 1.20, 'mu_E': 0.60, 'beta_Z': 0.85, 'nu_E': 0.25, 'chi_E': 0.90, 'mu_Z': 0.40, 'k_s': 1.00, 'c_t': 0.60, 'kappa_t': 1.00, 'eta_T': 0.70, 'lambda_E': 0.50, 'lambda_Z': 0.30, 'mu_G': 0.50, 'P_in': 0.70}\n    ]\n\n    # Shared simulation parameters\n    y0 = [0.05, 0.10, 1.00]\n    T_end = 500\n    N_s = 5000\n    t_span = [0, T_end]\n    t_eval = np.linspace(t_span[0], t_span[1], N_s)\n\n    thresholds = {\n        'E_quiet': 0.20,\n        'Z_quiet': 0.40,\n        'E_burst': 0.50\n    }\n\n    results = []\n    for params in test_cases:\n        sol = solve_ivp(\n            model_rhs,\n            t_span,\n            y0,\n            args=(params,),\n            method='RK45',\n            t_eval=t_eval,\n            dense_output=True\n        )\n        \n        analysis_result = analyze_solution(sol.t, sol.y, thresholds)\n        results.append(analysis_result)\n\n    # Format output as a string representation of a list of lists.\n    # str([True, 0, -1.0]) -> '[True, 0, -1.0]'\n    formatted_results = [str(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}