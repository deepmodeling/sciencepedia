{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing tritium transport is to understand the equilibrium conditions at the interface between the gas and the solid material. This exercise guides you through the derivation of Sieverts' law from fundamental thermodynamic principles, establishing the crucial link between the external gas pressure and the concentration of tritium dissolved within the material. By applying this law, you will perform a practical calculation of tritium solubility, a foundational skill for setting up realistic boundary conditions in any diffusion model .",
            "id": "4058630",
            "problem": "A body-centered cubic (BCC) tungsten membrane is exposed to pure molecular tritium gas $\\mathrm{T_2}$ at total pressure $p = 100$ Pa and temperature $T = 800$ K. Assume dilute solution conditions so that dissolved tritium occupies interstitial sites independently, the gas behaves ideally, and the interface is at thermodynamic equilibrium. Starting from equality of chemical potentials for the dissociation reaction $\\mathrm{T_2(g)} \\rightleftharpoons 2\\,\\mathrm{T(s)}$ and the ideal mixing form for the solid solution, derive the dependence of the dissolved tritium number density $n_T$ in tungsten on the gas pressure $p$ and temperature $T$. The solubility factor is known to follow an Arrhenius form\n$$S(T) = S_0 \\exp\\!\\left(-\\frac{E_S}{k_B T}\\right),$$\nwith $S_0 = 2.0 \\times 10^{21}$ m$^{-3}$ Pa$^{-1/2}$ and $E_S = 1.30$ eV, where $k_B$ is the Boltzmann constant. Using these data, compute the dissolved tritium number density $n_T$ in units of m$^{-3}$ for the given $p$ and $T$. Use the exact values $k_B = 1.380649 \\times 10^{-23}$ J/K and $1$ eV $= 1.602176634 \\times 10^{-19}$ J. Round your final numerical answer to three significant figures and express it in m$^{-3}$.",
            "solution": "This problem requires a two-part solution. First, we must derive the relationship between the number density of dissolved tritium, $n_T$, the gas pressure, $p$, and the temperature, $T$, starting from fundamental thermodynamic principles. Second, we must use this relationship along with the provided data to compute a numerical value for $n_T$.\n\nThe system is at thermodynamic equilibrium, which means the chemical potentials of the species involved in the reaction are balanced. The reaction for the dissociation of molecular tritium gas and its absorption into the solid tungsten is given by:\n$$ \\mathrm{T_2(g)} \\rightleftharpoons 2\\,\\mathrm{T(s)} $$\nwhere $\\mathrm{T_2(g)}$ represents a tritium molecule in the gas phase and $\\mathrm{T(s)}$ represents a tritium atom dissolved in the solid phase (tungsten). The condition for chemical equilibrium for this reaction is:\n$$ \\mu_{\\mathrm{T_2, gas}} = 2 \\mu_{\\mathrm{T, solid}} $$\nwhere $\\mu_{\\mathrm{T_2, gas}}$ is the chemical potential of the molecular tritium in the gas phase and $\\mu_{\\mathrm{T, solid}}$ is the chemical potential of atomic tritium dissolved in the solid.\n\nThe chemical potential of the tritium gas, assuming it behaves as an ideal gas, can be written as:\n$$ \\mu_{\\mathrm{T_2, gas}}(T, p) = \\mu_{\\mathrm{T_2, gas}}^0(T) + k_B T \\ln\\left(\\frac{p}{p^0}\\right) $$\nwhere $\\mu_{\\mathrm{T_2, gas}}^0(T)$ is the standard chemical potential of the gas at temperature $T$ and a reference pressure $p^0$ (we can set $p^0 = 1$ Pa for convenience), and $k_B$ is the Boltzmann constant.\n\nThe chemical potential of the tritium atoms dissolved in the solid is determined by the enthalpy of placing an atom in an interstitial site and the entropy of arranging the atoms among the available sites. For a dilute solution, the chemical potential is given by:\n$$ \\mu_{\\mathrm{T, solid}}(T, n_T) = \\mu_{\\mathrm{T, solid}}^\\infty(T) + k_B T \\ln\\left(\\frac{n_T}{n_{sites}}\\right) $$\nwhere $\\mu_{\\mathrm{T, solid}}^\\infty(T)$ is the standard chemical potential at infinite dilution (including enthalpic and vibrational contributions), $n_T$ is the number density of dissolved tritium atoms, and $n_{sites}$ is the number density of available interstitial sites in the tungsten lattice. The term $\\ln(n_T/n_{sites})$ arises from the ideal entropy of mixing for a dilute solution ($n_T \\ll n_{sites}$).\n\nNow, we substitute these expressions into the equilibrium condition:\n$$ \\mu_{\\mathrm{T_2, gas}}^0(T) + k_B T \\ln(p) = 2 \\left[ \\mu_{\\mathrm{T, solid}}^\\infty(T) + k_B T \\ln\\left(\\frac{n_T}{n_{sites}}\\right) \\right] $$\nRearranging the terms to solve for $n_T$:\n$$ k_B T \\ln(p) - 2 k_B T \\ln\\left(\\frac{n_T}{n_{sites}}\\right) = 2 \\mu_{\\mathrm{T, solid}}^\\infty(T) - \\mu_{\\mathrm{T_2, gas}}^0(T) $$\n$$ \\ln(p) - \\ln\\left(\\left(\\frac{n_T}{n_{sites}}\\right)^2\\right) = \\frac{2 \\mu_{\\mathrm{T, solid}}^\\infty(T) - \\mu_{\\mathrm{T_2, gas}}^0(T)}{k_B T} $$\n$$ \\ln\\left(\\frac{p \\cdot n_{sites}^2}{n_T^2}\\right) = \\frac{\\Delta G_{sol}^0(T)}{k_B T} $$\nwhere $\\Delta G_{sol}^0(T) = 2 \\mu_{\\mathrm{T, solid}}^\\infty(T) - \\mu_{\\mathrm{T_2, gas}}^0(T)$ is the standard Gibbs free energy of solution per molecule of $\\mathrm{T_2}$.\nExponentiating both sides:\n$$ \\frac{p \\cdot n_{sites}^2}{n_T^2} = \\exp\\left(\\frac{\\Delta G_{sol}^0(T)}{k_B T}\\right) $$\nSolving for $n_T$:\n$$ n_T^2 = p \\cdot n_{sites}^2 \\cdot \\exp\\left(-\\frac{\\Delta G_{sol}^0(T)}{k_B T}\\right) $$\n$$ n_T = \\sqrt{p} \\left[ n_{sites} \\exp\\left(-\\frac{\\Delta G_{sol}^0(T)}{2 k_B T}\\right) \\right] $$\nThis derivation shows that the dissolved tritium number density $n_T$ is proportional to the square root of the gas pressure $p$, a relationship known as Sieverts' law. The term in the square brackets is a function of temperature only and is defined as the solubility, $S(T)$:\n$$ S(T) = n_{sites} \\exp\\left(-\\frac{\\Delta G_{sol}^0(T)}{2 k_B T}\\right) $$\nThus, we have derived the relationship $n_T = S(T)\\sqrt{p}$.\n\nThe problem provides an empirical Arrhenius form for the solubility:\n$$ S(T) = S_0 \\exp\\left(-\\frac{E_S}{k_B T}\\right) $$\nwhere $S_0$ is the pre-exponential factor and $E_S$ is the energy of solution. By comparing the derived form of $S(T)$ with the empirical one, we can relate $S_0$ and $E_S$ to the underlying thermodynamic quantities. Specifically, $E_S$ corresponds to half the standard enthalpy of solution per molecule of $\\mathrm{T_2}$.\n\nNow, we proceed to the numerical calculation.\nThe problem gives:\nGas pressure, $p = 100$ Pa.\nTemperature, $T = 800$ K.\nSolubility pre-factor, $S_0 = 2.0 \\times 10^{21}$ m$^{-3}$ Pa$^{-1/2}$.\nEnergy of solution, $E_S = 1.30$ eV.\nBoltzmann constant, $k_B = 1.380649 \\times 10^{-23}$ J/K.\nEnergy conversion, $1$ eV $= 1.602176634 \\times 10^{-19}$ J.\n\nThe final expression for the number density is:\n$$ n_T = S_0 \\exp\\left(-\\frac{E_S}{k_B T}\\right) \\sqrt{p} $$\n\nFirst, we calculate the dimensionless exponent $\\frac{E_S}{k_B T}$. We must use consistent units (SI units).\nConvert $E_S$ from eV to Joules:\n$$ E_S = 1.30 \\text{ eV} \\times \\frac{1.602176634 \\times 10^{-19} \\text{ J}}{1 \\text{ eV}} = 2.0828296242 \\times 10^{-19} \\text{ J} $$\nCalculate the thermal energy $k_B T$:\n$$ k_B T = (1.380649 \\times 10^{-23} \\text{ J/K}) \\times (800 \\text{ K}) = 1.1045192 \\times 10^{-20} \\text{ J} $$\nNow, calculate the exponent:\n$$ \\frac{E_S}{k_B T} = \\frac{2.0828296242 \\times 10^{-19} \\text{ J}}{1.1045192 \\times 10^{-20} \\text{ J}} \\approx 18.857683 $$\nNext, we calculate the solubility $S(T)$:\n$$ S(T) = (2.0 \\times 10^{21} \\text{ m}^{-3} \\text{Pa}^{-1/2}) \\times \\exp(-18.857683) $$\n$$ S(T) \\approx (2.0 \\times 10^{21}) \\times (6.46010 \\times 10^{-9}) \\text{ m}^{-3} \\text{Pa}^{-1/2} $$\n$$ S(T) \\approx 1.29202 \\times 10^{13} \\text{ m}^{-3} \\text{Pa}^{-1/2} $$\nFinally, we calculate the dissolved tritium number density $n_T$:\n$$ n_T = S(T) \\sqrt{p} = (1.29202 \\times 10^{13} \\text{ m}^{-3} \\text{Pa}^{-1/2}) \\times \\sqrt{100 \\text{ Pa}} $$\n$$ n_T = (1.29202 \\times 10^{13} \\text{ m}^{-3} \\text{Pa}^{-1/2}) \\times (10 \\text{ Pa}^{1/2}) $$\n$$ n_T \\approx 1.29202 \\times 10^{14} \\text{ m}^{-3} $$\nThe problem requires the answer to be rounded to three significant figures.\n$$ n_T \\approx 1.29 \\times 10^{14} \\text{ m}^{-3} $$",
            "answer": "$$ \\boxed{1.29 \\times 10^{14}} $$"
        },
        {
            "introduction": "Moving beyond static equilibrium, we now explore the dynamics of how tritium permeates through a material over time. This practice challenges you to solve the time-dependent diffusion equation for a planar slab, a classic problem in transport phenomena that models the 'breakthrough' of tritium. By deriving the transient flux as an analytical series, you will see how fundamental properties like diffusivity ($D$) and solubility ($S$) govern the evolution of the system from its initial state to the final steady-state permeation .",
            "id": "4058537",
            "problem": "A planar slab of thickness $L$ made of a body-centered cubic metal (e.g., tungsten alloy) is considered in one-dimensional diffusion along the coordinate $x \\in [0,L]$. The slab is initially free of tritium, so the hydrogenic concentration is $c(x,0)=0$ for all $x \\in (0,L)$. For times $t \\ge 0$, the upstream surface at $x=0$ is suddenly exposed to a tritium-containing gas at constant pressure $p_1$, while the downstream surface at $x=L$ is maintained at $p_2=0$. Assume isothermal conditions at a fixed temperature such that the tritium diffusivity $D$ and Sieverts’ constant $S$ are time-independent and spatially uniform in the bulk. At each surface, the interfacial equilibrium follows Sieverts’ law, namely $c_s = S \\sqrt{p}$, so that $c(0,t) = S \\sqrt{p_1}$ and $c(L,t) = 0$ for all $t \\ge 0$. There is no bulk trapping, no convection, and no reaction, and the transport is governed solely by diffusion.\n\nStarting from Fick’s second law and Fick’s first law, and using the method of eigenfunction expansion for the associated Partial Differential Equation (PDE) with the given initial and boundary conditions, derive a closed-form series expression for the transient downstream molar flux $J(t)$ at $x=L$, where $J(t) \\equiv -D \\, \\partial c/\\partial x\\vert_{x=L}$. Express your final answer as a single analytic expression in terms of $D$, $S$, $p_1$, $L$, and $t$. State $J(t)$ as an exact analytic series; do not provide any numerical approximation. Your final answer should represent the molar flux (with physical units of mol m$^{-2}$ s$^{-1}$), but you must provide the expression symbolically as requested.",
            "solution": "The problem statement has been validated and is deemed a well-posed, scientifically grounded problem in transport phenomena. It presents a classical one-dimensional diffusion scenario with specified initial and boundary conditions, which can be solved analytically.\n\nThe transport of tritium within the slab is governed by Fick's second law for one-dimensional diffusion:\n$$\n\\frac{\\partial c(x,t)}{\\partial t} = D \\frac{\\partial^2 c(x,t)}{\\partial x^2}\n$$\nwhere $c(x,t)$ is the tritium concentration at position $x$ and time $t$, and $D$ is the diffusion coefficient. The problem is defined on the domain $x \\in [0, L]$ and for time $t \\ge 0$.\n\nThe initial and boundary conditions are given as:\nInitial Condition (IC): $c(x,0) = 0$ for $x \\in (0,L)$.\nBoundary Conditions (BCs): For $t \\ge 0$,\n$c(0,t) = S \\sqrt{p_1}$, where $S$ is the Sieverts' constant and $p_1$ is the upstream gas pressure.\n$c(L,t) = 0$.\n\nThe boundary conditions are non-homogeneous. To solve this linear partial differential equation (PDE), we employ the principle of superposition. The solution $c(x,t)$ can be expressed as the sum of a steady-state solution, $c_{ss}(x)$, and a transient solution, $c_{tr}(x,t)$:\n$$\nc(x,t) = c_{ss}(x) + c_{tr}(x,t)\n$$\nThe steady-state solution $c_{ss}(x)$ is the long-time limit ($t \\to \\infty$) where the concentration profile no longer changes with time, i.e., $\\frac{\\partial c}{\\partial t} = 0$. The governing PDE for the steady state reduces to an ordinary differential equation:\n$$\n\\frac{d^2 c_{ss}}{dx^2} = 0\n$$\nThe general solution is a linear function of $x$: $c_{ss}(x) = Ax + B$. The constants $A$ and $B$ are determined by applying the boundary conditions, which the steady-state solution must also satisfy:\n$c_{ss}(0) = B = S \\sqrt{p_1}$\n$c_{ss}(L) = AL + B = 0 \\implies A = - \\frac{B}{L} = - \\frac{S \\sqrt{p_1}}{L}$\nThus, the steady-state concentration profile is:\n$$\nc_{ss}(x) = S \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)\n$$\nNow, we formulate the problem for the transient part, $c_{tr}(x,t)$. By substituting $c(x,t) = c_{ss}(x) + c_{tr}(x,t)$ into the original PDE and utilizing the fact that both $c(x,t)$ and $c_{ss}(x)$ satisfy the diffusion equation, we find that $c_{tr}(x,t)$ must also satisfy the homogeneous diffusion equation:\n$$\n\\frac{\\partial c_{tr}}{\\partial t} = D \\frac{\\partial^2 c_{tr}}{\\partial x^2}\n$$\nThe boundary conditions for $c_{tr}(x,t)$ become homogeneous:\n$c(0,t) = c_{ss}(0) + c_{tr}(0,t) = S \\sqrt{p_1} \\implies c_{tr}(0,t) = 0$\n$c(L,t) = c_{ss}(L) + c_{tr}(L,t) = 0 \\implies c_{tr}(L,t) = 0$\nThe initial condition for the transient component is found from the overall initial condition:\n$c(x,0) = c_{ss}(x) + c_{tr}(x,0) = 0 \\implies c_{tr}(x,0) = -c_{ss}(x) = -S \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)$\n\nThe problem for $c_{tr}(x,t)$ is a homogeneous PDE with homogeneous boundary conditions, which can be solved using the method of separation of variables (or eigenfunction expansion). We seek solutions of the form $c_{tr}(x,t) = X(x)T(t)$. Substituting this into the PDE yields:\n$$\n\\frac{1}{D} \\frac{T'(t)}{T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda^2\n$$\nwhere $-\\lambda^2$ is the separation constant. This gives two ODEs:\n$T'(t) + D \\lambda^2 T(t) = 0 \\implies T(t) = C \\exp(-D \\lambda^2 t)$\n$X''(x) + \\lambda^2 X(x) = 0 \\implies X(x) = C_1 \\sin(\\lambda x) + C_2 \\cos(\\lambda x)$\n\nApplying the homogeneous boundary conditions to $X(x)$:\n$X(0) = 0 \\implies C_2 = 0$\n$X(L) = 0 \\implies C_1 \\sin(\\lambda L) = 0$. For a non-trivial solution ($C_1 \\ne 0$), we require $\\sin(\\lambda L) = 0$, which means $\\lambda L = n \\pi$ for integer $n$.\nThe eigenvalues are $\\lambda_n = \\frac{n \\pi}{L}$ for $n = 1, 2, 3, \\dots$. The corresponding eigenfunctions are $X_n(x) = \\sin\\left(\\frac{n \\pi x}{L}\\right)$.\n\nThe general transient solution is a superposition of all possible solutions:\n$$\nc_{tr}(x,t) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-D \\left(\\frac{n \\pi}{L}\\right)^2 t\\right)\n$$\nThe coefficients $B_n$ are determined from the initial condition for $c_{tr}(x,t)$ using the orthogonality of sine functions. This is a Fourier sine series expansion of $c_{tr}(x,0)$:\n$$\nc_{tr}(x,0) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n \\pi x}{L}\\right) = -S \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)\n$$\nThe coefficient $B_n$ is calculated by the integral:\n$$\nB_n = \\frac{2}{L} \\int_0^L c_{tr}(x,0) \\sin\\left(\\frac{n \\pi x}{L}\\right) dx = \\frac{2}{L} \\int_0^L \\left[-S \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)\\right] \\sin\\left(\\frac{n \\pi x}{L}\\right) dx\n$$\n$$\nB_n = -\\frac{2S \\sqrt{p_1}}{L} \\left[ \\int_0^L \\sin\\left(\\frac{n \\pi x}{L}\\right) dx - \\frac{1}{L} \\int_0^L x \\sin\\left(\\frac{n \\pi x}{L}\\right) dx \\right]\n$$\nEvaluating the integrals:\n$\\int_0^L \\sin\\left(\\frac{n \\pi x}{L}\\right) dx = \\left[-\\frac{L}{n \\pi} \\cos\\left(\\frac{n \\pi x}{L}\\right)\\right]_0^L = -\\frac{L}{n \\pi}(\\cos(n\\pi) - 1) = \\frac{L}{n \\pi}(1 - (-1)^n)$\n$\\int_0^L x \\sin\\left(\\frac{n \\pi x}{L}\\right) dx = \\left[-\\frac{Lx}{n \\pi} \\cos\\left(\\frac{n \\pi x}{L}\\right) + \\left(\\frac{L}{n \\pi}\\right)^2 \\sin\\left(\\frac{n \\pi x}{L}\\right)\\right]_0^L = -\\frac{L^2}{n \\pi}\\cos(n\\pi) = -\\frac{L^2}{n \\pi}(-1)^n$\nSubstituting these results back into the expression for $B_n$:\n$$\nB_n = -\\frac{2S \\sqrt{p_1}}{L} \\left[ \\frac{L}{n \\pi}(1 - (-1)^n) - \\frac{1}{L}\\left(-\\frac{L^2}{n \\pi}(-1)^n\\right) \\right]\n$$\n$$\nB_n = -\\frac{2S \\sqrt{p_1}}{L} \\left[ \\frac{L}{n \\pi} - \\frac{L(-1)^n}{n \\pi} + \\frac{L(-1)^n}{n \\pi} \\right] = -\\frac{2S \\sqrt{p_1}}{L} \\left(\\frac{L}{n \\pi}\\right) = -\\frac{2S \\sqrt{p_1}}{n \\pi}\n$$\nThe complete solution for the concentration profile $c(x,t)$ is:\n$$\nc(x,t) = S \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right) - \\frac{2S \\sqrt{p_1}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\nThe problem asks for the downstream molar flux $J(t)$ at $x=L$. The flux is defined by Fick's first law: $J(t) = -D \\frac{\\partial c}{\\partial x}\\big|_{x=L}$.\nFirst, we find the concentration gradient $\\frac{\\partial c}{\\partial x}$:\n$$\n\\frac{\\partial c}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ S \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right) - \\frac{2S \\sqrt{p_1}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right]\n$$\n$$\n\\frac{\\partial c}{\\partial x} = -\\frac{S \\sqrt{p_1}}{L} - \\frac{2S \\sqrt{p_1}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\left(\\frac{n \\pi}{L}\\right) \\cos\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\n$$\n\\frac{\\partial c}{\\partial x} = -\\frac{S \\sqrt{p_1}}{L} - \\frac{2S \\sqrt{p_1}}{L} \\sum_{n=1}^{\\infty} \\cos\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\nNow, evaluate the gradient at the downstream surface, $x=L$:\n$$\n\\frac{\\partial c}{\\partial x}\\bigg|_{x=L} = -\\frac{S \\sqrt{p_1}}{L} - \\frac{2S \\sqrt{p_1}}{L} \\sum_{n=1}^{\\infty} \\cos(n \\pi) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\nSince $\\cos(n \\pi) = (-1)^n$, this becomes:\n$$\n\\frac{\\partial c}{\\partial x}\\bigg|_{x=L} = -\\frac{S \\sqrt{p_1}}{L} \\left[ 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right]\n$$\nFinally, the downstream flux $J(t)$ is:\n$$\nJ(t) = -D \\left( -\\frac{S \\sqrt{p_1}}{L} \\left[ 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right] \\right)\n$$\n$$\nJ(t) = \\frac{D S \\sqrt{p_1}}{L} \\left[ 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right]\n$$\nThis is the final closed-form series expression for the transient downstream flux.",
            "answer": "$$\n\\boxed{\\frac{D S \\sqrt{p_1}}{L} \\left( 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right)}\n$$"
        },
        {
            "introduction": "Theoretical models are only as good as the parameters they use. This final practice bridges the gap between theory and experiment by tasking you with a core activity in computational materials science: extracting material properties from experimental data. You will develop a computational estimator to perform a joint nonlinear regression on measured permeation flux and time-lag data, allowing you to determine the Arrhenius parameters for both diffusivity and solubility. This exercise not only reinforces the physical models but also introduces essential techniques for uncertainty quantification in parameter estimation .",
            "id": "4058637",
            "problem": "You are tasked with constructing a computational estimator for tritium permeation properties in engineering materials from combined transient and steady-state experiments, using fundamental transport principles. Tritium is modeled as a hydrogen isotope obeying dissociative adsorption equilibria at the surface. Your estimator must perform a joint nonlinear regression across multiple temperatures to infer the temperature dependence of the diffusion coefficient and solubility, expressed in Arrhenius form, and then propagate uncertainties to provide confidence intervals for both quantities at a specified reporting temperature.\n\nThe fundamental base for this task consists of: Fick’s first and second laws of diffusion, mass conservation in one spatial dimension, and the equilibrium relation between dissolved hydrogen concentration and gas pressure at the surface following Sieverts’ law. Specifically, the one-dimensional molar flux density is defined by $J = - D \\, \\partial c / \\partial x$, where $J$ is the molar flux density in $\\text{mol} \\, \\text{m}^{-2} \\, \\text{s}^{-1}$, $D$ is the diffusion coefficient in $\\text{m}^2 \\, \\text{s}^{-1}$, $c$ is the dissolved hydrogen atomic concentration in $\\text{mol} \\, \\text{m}^{-3}$, and $x$ is the spatial coordinate in $\\text{m}$. Sieverts’ law relates the equilibrium dissolved concentration to the gas pressure by $c = S \\, \\sqrt{p}$, where $p$ is the gas pressure in $\\text{Pa}$ and $S$ is the solubility in $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$. For a membrane of thickness $L$ with upstream pressure $p_{\\text{in}}$ and downstream pressure $p_{\\text{out}}$, steady-state permeation after transients have decayed yields a constant flux through the membrane driven by the boundary values of $c$ implied by Sieverts’ law and the constant gradient over $L$. The transient “time-lag” following a step change at the upstream boundary is defined as the intercept of the linear asymptote of the downstream breakthrough curve and is governed by Fickian diffusion in a slab of thickness $L$ under the same boundary conditions.\n\nAssume that the temperature dependence of the diffusion coefficient $D(T)$ and solubility $S(T)$ obey Arrhenius-type relations,\n$$\nD(T) = D_0 \\, \\exp\\!\\left(-\\frac{E_D}{R T}\\right), \\quad\nS(T) = S_0 \\, \\exp\\!\\left(-\\frac{E_S}{R T}\\right),\n$$\nwhere $D_0$ is the pre-exponential factor for diffusion in $\\text{m}^2 \\, \\text{s}^{-1}$, $E_D$ is the activation energy for diffusion in $\\text{J} \\, \\text{mol}^{-1}$, $S_0$ is the pre-exponential factor for solubility in $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$, $E_S$ is the activation energy for solubility in $\\text{J} \\, \\text{mol}^{-1}$, $T$ is the absolute temperature in $\\text{K}$, and $R$ is the universal gas constant in $\\text{J} \\, \\text{mol}^{-1} \\, \\text{K}^{-1}$.\n\nYour program must:\n- Formulate a joint weighted nonlinear least-squares regression over the Arrhenius parameters $\\theta = \\{\\ln D_0, E_D, \\ln S_0, E_S\\}$ using the provided multi-temperature measurements of both steady-state flux $J$ and transient time-lag $\\tau$. The weighting must use the measurement standard deviations provided for each datum to form residuals normalized by their uncertainties.\n- Use the one-dimensional Fickian slab model with Sieverts’ law at both surfaces to relate steady-state flux $J$ to $D(T)$, $S(T)$, $L$, $p_{\\text{in}}$, and $p_{\\text{out}}$, and to relate time-lag $\\tau$ to $D(T)$ and $L$.\n- Estimate the parameter covariance matrix from the regression Jacobian and residual variance under the standard asymptotic normal approximation for weighted least squares.\n- Propagate the parameter uncertainties to obtain $95\\%$ confidence intervals for $D(T^\\star)$ and $S(T^\\star)$ at a specified reporting temperature $T^\\star$ for each test case by first-order (delta method) linearization.\n\nScientific realism constraints:\n- All quantities must be handled in the International System of Units (SI). Diffusion coefficients must be reported in $\\text{m}^2 \\, \\text{s}^{-1}$. Solubilities must be reported in $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$. Temperatures must be in $\\text{K}$. Pressures must be in $\\text{Pa}$. Time-lags must be in $\\text{s}$. Membrane thicknesses must be in $\\text{m}$.\n\nTest suite and data specification:\nFor each test case, you are given arrays of temperatures $T_i$, upstream and downstream pressures $p_{\\text{in},i}$ and $p_{\\text{out},i}$, membrane thickness $L$, measured steady-state fluxes $J^{\\text{meas}}_i$ with their standard deviations $\\sigma_{J,i}$, and measured time-lags $\\tau^{\\text{meas}}_i$ with their standard deviations $\\sigma_{\\tau,i}$. The universal gas constant to be used is $R = 8.314 \\, \\text{J} \\, \\text{mol}^{-1} \\, \\text{K}^{-1}$.\n\n- Test Case $1$ (happy path, moderate pressures, mid-range temperatures):\n  - $T = [550, 650, 750]$\n  - $p_{\\text{in}} = [20000, 20000, 20000]$, $p_{\\text{out}} = [2000, 2000, 2000]$\n  - $L = 1.0 \\times 10^{-3}$\n  - $J^{\\text{meas}} = [8.95 \\times 10^{-7}, 2.51 \\times 10^{-6}, 5.95 \\times 10^{-6}]$\n  - $\\sigma_{J} = [4.48 \\times 10^{-8}, 1.26 \\times 10^{-7}, 2.98 \\times 10^{-7}]$ (representing $5$ percent relative uncertainty)\n  - $\\tau^{\\text{meas}} = [39.3, 17.5, 9.00]$\n  - $\\sigma_{\\tau} = [0.5, 0.5, 0.5]$\n  - Reporting temperature $T^\\star = 650$.\n\n- Test Case $2$ (edge case, small pressure differences, identifiability through time-lag):\n  - $T = [600, 700, 800]$\n  - $p_{\\text{in}} = [9500, 10000, 11000]$, $p_{\\text{out}} = [9000, 9500, 10000]$\n  - $L = 1.0 \\times 10^{-3}$\n  - $J^{\\text{meas}} = [4.51 \\times 10^{-8}, 9.95 \\times 10^{-8}, 4.07 \\times 10^{-7}]$\n  - $\\sigma_{J} = [4.51 \\times 10^{-9}, 9.95 \\times 10^{-9}, 4.07 \\times 10^{-8}]$ (representing $10$ percent relative uncertainty)\n  - $\\tau^{\\text{meas}} = [25.75, 12.06, 7.19]$\n  - $\\sigma_{\\tau} = [0.4, 0.4, 0.4]$\n  - Reporting temperature $T^\\star = 700$.\n\n- Test Case $3$ (boundary case, high temperatures, large driving force):\n  - $T = [800, 900, 1000]$\n  - $p_{\\text{in}} = [20000, 20000, 20000]$, $p_{\\text{out}} = [1000, 1000, 1000]$\n  - $L = 1.0 \\times 10^{-3}$\n  - $J^{\\text{meas}} = [8.80 \\times 10^{-6}, 1.59 \\times 10^{-5}, 2.37 \\times 10^{-5}]$\n  - $\\sigma_{J} = [2.64 \\times 10^{-7}, 4.77 \\times 10^{-7}, 7.11 \\times 10^{-7}]$ (representing $3$ percent relative uncertainty)\n  - $\\tau^{\\text{meas}} = [6.76, 4.85, 3.26]$\n  - $\\sigma_{\\tau} = [0.2, 0.2, 0.2]$\n  - Reporting temperature $T^\\star = 900$.\n\nAnswer specification:\n- For each test case, compute $D(T^\\star)$ and $S(T^\\star)$ along with their $95$ percent confidence intervals using the parameter covariance propagated by first-order linearization. Confidence intervals must be expressed as lower and upper bounds for each quantity.\n- Express $D$ in $\\text{m}^2 \\, \\text{s}^{-1}$ and $S$ in $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$. The final outputs must be numeric floats without unit strings, but they must correspond to the specified units.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is itself a list of six floats in the order $[D(T^\\star), S(T^\\star), D_{\\text{lo}}(T^\\star), D_{\\text{hi}}(T^\\star), S_{\\text{lo}}(T^\\star), S_{\\text{hi}}(T^\\star)]$. For example, the output format must be of the form $[[d_1,s_1,d_{1,\\text{lo}},d_{1,\\text{hi}},s_{1,\\text{lo}},s_{1,\\text{hi}}],[d_2,s_2,\\dots],[d_3,s_3,\\dots]]$.",
            "solution": "The problem requires the development of a computational method to estimate the diffusion coefficient $D$ and solubility $S$ of tritium in a material, along with their uncertainties, from a set of experimental measurements. The estimation is performed by jointly fitting data from steady-state permeation flux and transient time-lag experiments conducted at multiple temperatures. The temperature dependencies of $D$ and $S$ are modeled using Arrhenius relations.\n\n### 1. Physical and Mathematical Model\nThe transport of tritium through the material is described by a one-dimensional diffusion model.\n\n**Forward Model for Observables:**\nThe steady-state molar flux density $J$ through a membrane of thickness $L$ is governed by Fick's first law and Sieverts' law. At steady-state, the concentration profile $c(x)$ is linear. With boundary concentrations $c(0) = S\\sqrt{p_{\\text{in}}}$ and $c(L) = S\\sqrt{p_{\\text{out}}}$, the flux is:\n$$\nJ = -D \\frac{\\partial c}{\\partial x} = -D \\frac{S\\sqrt{p_{\\text{out}}} - S\\sqrt{p_{\\text{in}}}}{L} = \\frac{D(T)S(T)}{L}(\\sqrt{p_{\\text{in}}} - \\sqrt{p_{\\text{out}}})\n$$\nThe transient time-lag $\\tau$ for diffusion through a slab is related to the diffusion coefficient by the well-established formula:\n$$\n\\tau = \\frac{L^2}{6D(T)}\n$$\nThese two equations form the forward model, connecting the physical parameters $D$ and $S$ to the experimentally observable quantities $J$ and $\\tau$.\n\n**Arrhenius Temperature Dependence:**\nThe temperature dependence of $D(T)$ and $S(T)$ is described by the Arrhenius equations:\n$$\nD(T) = D_0 \\exp\\left(-\\frac{E_D}{RT}\\right) \\quad \\text{and} \\quad S(T) = S_0 \\exp\\left(-\\frac{E_S}{RT}\\right)\n$$\nwhere $D_0$ and $S_0$ are pre-exponential factors, $E_D$ and $E_S$ are activation energies, $R$ is the universal gas constant, and $T$ is the absolute temperature. For numerical stability and to linearize the pre-factors, we work with their natural logarithms. The parameter vector to be estimated is thus $\\vec{\\theta} = [\\ln D_0, E_D, \\ln S_0, E_S]^T$. In terms of $\\vec{\\theta}$, the properties are:\n$$\n\\ln D(T; \\vec{\\theta}) = \\theta_1 - \\frac{\\theta_2}{RT} \\quad \\implies \\quad D(T; \\vec{\\theta}) = \\exp\\left(\\theta_1 - \\frac{\\theta_2}{RT}\\right)\n$$\n$$\n\\ln S(T; \\vec{\\theta}) = \\theta_3 - \\frac{\\theta_4}{RT} \\quad \\implies \\quad S(T; \\vec{\\theta}) = \\exp\\left(\\theta_3 - \\frac{\\theta_4}{RT}\\right)\n$$\n\n### 2. Parameter Estimation via Weighted Nonlinear Least Squares (WNLS)\nWe are given a set of $N$ experimental conditions, each at a temperature $T_i$, providing measurements of flux $J^{\\text{meas}}_i$ and time-lag $\\tau^{\\text{meas}}_i$ with corresponding standard deviations $\\sigma_{J,i}$ and $\\sigma_{\\tau,i}$. The goal is to find the parameter vector $\\vec{\\theta}$ that best fits all $2N$ data points simultaneously.\n\nWe employ the WNLS method, which minimizes the sum of squared weighted residuals, $\\chi^2$. The residual for each measurement is the difference between the measured value and the model prediction, normalized by the measurement's standard deviation.\nLet the vector of all model predictions be $\\vec{y}_{\\text{model}}(\\vec{\\theta}) = [J_{\\text{model}}(T_1), \\dots, J_{\\text{model}}(T_N), \\tau_{\\text{model}}(T_1), \\dots, \\tau_{\\text{model}}(T_N)]^T$ and the measurement vector be $\\vec{y}_{\\text{meas}} = [J^{\\text{meas}}_1, \\dots, J^{\\text{meas}}_N, \\tau^{\\text{meas}}_1, \\dots, \\tau^{\\text{meas}}_N]^T$. The corresponding vector of standard deviations is $\\vec{\\sigma}$.\nThe vector of weighted residuals is $\\vec{r}(\\vec{\\theta})$, with components:\n$$\nr_i(\\vec{\\theta}) = \\frac{y_{\\text{meas},i} - y_{\\text{model},i}(\\vec{\\theta})}{\\sigma_i}\n$$\nThe objective is to find $\\vec{\\theta}_{\\text{opt}}$ that minimizes the cost function $\\chi^2(\\vec{\\theta})$:\n$$\n\\vec{\\theta}_{\\text{opt}} = \\arg\\min_{\\vec{\\theta}} \\chi^2(\\vec{\\theta}) = \\arg\\min_{\\vec{\\theta}} \\sum_{i=1}^{2N} r_i(\\vec{\\theta})^2 = \\arg\\min_{\\vec{\\theta}} \\|\\vec{r}(\\vec{\\theta})\\|_2^2\n$$\nThis is a nonlinear optimization problem, which can be solved numerically using an iterative algorithm such as Levenberg-Marquardt, implemented in `scipy.optimize.least_squares`.\n\n### 3. Uncertainty Quantification\nOnce the optimal parameter vector $\\vec{\\theta}_{\\text{opt}}$ is found, we must quantify its uncertainty and propagate it to the derived quantities $D(T^\\star)$ and $S(T^\\star)$ at a specified reporting temperature $T^\\star$.\n\n**Parameter Covariance Matrix:**\nAccording to the asymptotic theory of least squares, the covariance matrix of the estimated parameters, $\\text{Cov}(\\vec{\\theta})$, can be approximated from the Jacobian matrix of the weighted residuals. The Jacobian matrix $\\mathbf{J}$ has elements $J_{ij} = \\partial r_i / \\partial \\theta_j$. The covariance matrix is given by:\n$$\n\\text{Cov}(\\vec{\\theta}_{\\text{opt}}) \\approx s^2 (\\mathbf{J}^T \\mathbf{J})^{-1}\n$$\nwhere $\\mathbf{J}$ is evaluated at $\\vec{\\theta}_{\\text{opt}}$, and $s^2$ is the residual variance (or mean squared error), an estimator for the variance of the errors:\n$$\ns^2 = \\frac{\\chi^2_{\\text{min}}}{m-p} = \\frac{\\|\\vec{r}(\\vec{\\theta}_{\\text{opt}})\\|_2^2}{2N - 4}\n$$\nHere, $m=2N$ is the number of data points and $p=4$ is the number of parameters. The term $m-p$ represents the degrees of freedom of the fit.\n\n**Uncertainty Propagation using the Delta Method:**\nTo find the uncertainty in a function $f(\\vec{\\theta})$ of the parameters, we use a first-order Taylor expansion (the delta method). The variance of $f$ is approximated by:\n$$\n\\text{Var}(f(\\vec{\\theta})) \\approx (\\nabla f)^T \\text{Cov}(\\vec{\\theta}) (\\nabla f)\n$$\nwhere $\\nabla f$ is the gradient of $f$ with respect to $\\vec{\\theta}$, evaluated at $\\vec{\\theta}_{\\text{opt}}$.\n\nFor $D(T^\\star) = \\exp(\\theta_1 - \\theta_2 / (RT^\\star))$, the gradient is:\n$$\n\\nabla D(T^\\star) = \\left[ \\frac{\\partial D}{\\partial\\theta_1}, \\frac{\\partial D}{\\partial\\theta_2}, \\frac{\\partial D}{\\partial\\theta_3}, \\frac{\\partial D}{\\partial\\theta_4} \\right]^T = \\left[ D(T^\\star), -\\frac{D(T^\\star)}{RT^\\star}, 0, 0 \\right]^T\n$$\nFor $S(T^\\star) = \\exp(\\theta_3 - \\theta_4 / (RT^\\star))$, the gradient is:\n$$\n\\nabla S(T^\\star) = \\left[ \\frac{\\partial S}{\\partial\\theta_1}, \\frac{\\partial S}{\\partial\\theta_2}, \\frac{\\partial S}{\\partial\\theta_3}, \\frac{\\partial S}{\\partial\\theta_4} \\right]^T = \\left[ 0, 0, S(T^\\star), -\\frac{S(T^\\star)}{RT^\\star} \\right]^T\n$$\nThe standard deviations are then $\\sigma_D = \\sqrt{\\text{Var}(D(T^\\star))}$ and $\\sigma_S = \\sqrt{\\text{Var}(S(T^\\star))}$.\n\n**Confidence Intervals:**\nA $95\\%$ confidence interval for a quantity, say $D(T^\\star)$, is constructed assuming its estimator is approximately normally distributed. The interval is:\n$$\n[D_{\\text{lo}}(T^\\star), D_{\\text{hi}}(T^\\star)] = [D(T^\\star) - z_{\\alpha/2} \\sigma_D, D(T^\\star) + z_{\\alpha/2} \\sigma_D]\n$$\nwhere $z_{\\alpha/2}$ is the critical value from the standard normal distribution for a $95\\%$ confidence level (i.e., $\\alpha=0.05$). $z_{0.025} \\approx 1.95996$. A similar interval is constructed for $S(T^\\star)$.\n\nThis completes the theoretical framework for the estimation procedure. The implementation will follow these steps for each provided test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves for diffusion and solubility parameters from permeation data\n    and calculates confidence intervals at a reporting temperature.\n    \"\"\"\n    R = 8.314  # J / (mol * K)\n\n    test_cases = [\n        {\n            \"T\": np.array([550, 650, 750]),\n            \"p_in\": np.array([20000, 20000, 20000]),\n            \"p_out\": np.array([2000, 2000, 2000]),\n            \"L\": 1.0e-3,\n            \"J_meas\": np.array([8.95e-7, 2.51e-6, 5.95e-6]),\n            \"sigma_J\": np.array([4.48e-8, 1.26e-7, 2.98e-7]),\n            \"tau_meas\": np.array([39.3, 17.5, 9.00]),\n            \"sigma_tau\": np.array([0.5, 0.5, 0.5]),\n            \"T_star\": 650,\n            \"initial_theta\": [-13.7, 25000, -4.5, 7000]\n        },\n        {\n            \"T\": np.array([600, 700, 800]),\n            \"p_in\": np.array([9500, 10000, 11000]),\n            \"p_out\": np.array([9000, 9500, 10000]),\n            \"L\": 1.0e-3,\n            \"J_meas\": np.array([4.51e-8, 9.95e-8, 4.07e-7]),\n            \"sigma_J\": np.array([4.51e-9, 9.95e-9, 4.07e-8]),\n            \"tau_meas\": np.array([25.75, 12.06, 7.19]),\n            \"sigma_tau\": np.array([0.4, 0.4, 0.4]),\n            \"T_star\": 700,\n            \"initial_theta\": [-13.7, 25000, -4.9, 5500]\n        },\n        {\n            \"T\": np.array([800, 900, 1000]),\n            \"p_in\": np.array([20000, 20000, 20000]),\n            \"p_out\": np.array([1000, 1000, 1000]),\n            \"L\": 1.0e-3,\n            \"J_meas\": np.array([8.80e-6, 1.59e-5, 2.37e-5]),\n            \"sigma_J\": np.array([2.64e-7, 4.77e-7, 7.11e-7]),\n            \"tau_meas\": np.array([6.76, 4.85, 3.26]),\n            \"sigma_tau\": np.array([0.2, 0.2, 0.2]),\n            \"T_star\": 900,\n            \"initial_theta\": [-13.0, 30000, -4.0, 15000]\n        }\n    ]\n\n    all_results = []\n    z_score = norm.ppf(0.975)\n\n    for case in test_cases:\n        T = case[\"T\"]\n        p_in, p_out = case[\"p_in\"], case[\"p_out\"]\n        L, T_star = case[\"L\"], case[\"T_star\"]\n        J_meas, sigma_J = case[\"J_meas\"], case[\"sigma_J\"]\n        tau_meas, sigma_tau = case[\"tau_meas\"], case[\"sigma_tau\"]\n        \n        y_meas = np.concatenate([J_meas, tau_meas])\n        sigma_y = np.concatenate([sigma_J, sigma_tau])\n\n        def model(theta, T_vals, p_in_vals, p_out_vals, L_val):\n            ln_D0, E_D, ln_S0, E_S = theta\n            D_vals = np.exp(ln_D0 - E_D / (R * T_vals))\n            S_vals = np.exp(ln_S0 - E_S / (R * T_vals))\n            \n            J_model = (D_vals * S_vals / L_val) * (np.sqrt(p_in_vals) - np.sqrt(p_out_vals))\n            tau_model = L_val**2 / (6 * D_vals)\n            \n            return np.concatenate([J_model, tau_model])\n\n        def residuals(theta, T_vals, p_in_vals, p_out_vals, L_val, y_meas, sigma_y):\n            y_model = model(theta, T_vals, p_in_vals, p_out_vals, L_val)\n            return (y_meas - y_model) / sigma_y\n        \n        res = least_squares(\n            residuals,\n            case[\"initial_theta\"],\n            args=(T, p_in, p_out, L, y_meas, sigma_y),\n            jac='2-point'\n        )\n        theta_opt = res.x\n\n        # Parameter Covariance\n        jac = res.jac\n        chi2 = np.sum(res.fun**2)\n        m = len(y_meas)\n        p = len(theta_opt)\n        dof = m - p\n        \n        # Residual variance scaling\n        res_var = chi2 / dof if dof  0 else 1.0\n        cov_matrix = res_var * np.linalg.inv(jac.T @ jac)\n\n        # Propagate uncertainty to D(T*) and S(T*)\n        ln_D0_opt, E_D_opt, ln_S0_opt, E_S_opt = theta_opt\n        \n        # Calculate D(T*) and its variance\n        D_star = np.exp(ln_D0_opt - E_D_opt / (R * T_star))\n        grad_D = np.array([D_star, -D_star / (R * T_star), 0, 0])\n        var_D = grad_D.T @ cov_matrix @ grad_D\n        std_D = np.sqrt(var_D)\n        \n        D_lo = D_star - z_score * std_D\n        D_hi = D_star + z_score * std_D\n        \n        # Calculate S(T*) and its variance\n        S_star = np.exp(ln_S0_opt - E_S_opt / (R * T_star))\n        grad_S = np.array([0, 0, S_star, -S_star / (R * T_star)])\n        var_S = grad_S.T @ cov_matrix @ grad_S\n        std_S = np.sqrt(var_S)\n\n        S_lo = S_star - z_score * std_S\n        S_hi = S_star + z_score * std_S\n        \n        all_results.append([D_star, S_star, D_lo, D_hi, S_lo, S_hi])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}