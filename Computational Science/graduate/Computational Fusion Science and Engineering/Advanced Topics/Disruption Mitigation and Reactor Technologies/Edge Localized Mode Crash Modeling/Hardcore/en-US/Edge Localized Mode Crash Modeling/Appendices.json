{
    "hands_on_practices": [
        {
            "introduction": "The foundation of modern Edge Localized Mode (ELM) modeling lies in magnetohydrodynamic (MHD) stability theory, specifically the peeling-ballooning model. This model posits that ELMs are triggered when the steep pressure gradient and associated bootstrap current in the pedestal region exceed a critical threshold. This exercise provides a practical application of this concept, guiding you to assess a plasma's proximity to the peeling instability limit using a simplified model and experimentally relevant parameters . By connecting the abstract stability criterion to measurable quantities, you will gain insight into the physical drivers of ELMs.",
            "id": "3970152",
            "problem": "A large-aspect-ratio tokamak pedestal is modeled locally with a shifted hyperbolic tangent pressure profile, and the peeling component of the edge localized mode is assessed using ideal magnetohydrodynamics (MHD) in a sheared slab approximation. The pedestal pressure profile is\n$$\np(r) \\;=\\; p_{\\text{core}} \\;-\\; \\frac{\\Delta p}{2}\\,\\Big[1 \\;+\\; \\tanh\\!\\Big(\\frac{r - r_{0}}{w}\\Big)\\Big],\n$$\nwhere $r$ is the minor radius, $r_{0}$ is the location of the maximum pressure gradient, $\\Delta p$ is the pressure drop across the pedestal, and $w$ is the pedestal half-width. The neoclassical bootstrap current density $j_{\\parallel}$ is assumed locally proportional to the pressure gradient $dp/dr$ with an approximately constant coefficient over the narrow pedestal region, i.e.,\n$$\nj_{\\parallel}(r) \\;=\\; C_{\\text{bs}}\\,\\frac{dp}{dr}(r).\n$$\nYou are given the following measured and equilibrium parameters at a specific measurement radius $r = r_{m}$ near the pedestal:\n- Measured pressure gradient: $dp/dr|_{r_{m}} = -1.35 \\times 10^{6}$ $\\text{Pa}\\,\\text{m}^{-1}$.\n- Measured bootstrap current density: $j_{\\parallel}(r_{m}) = 2.43 \\times 10^{5}$ $\\text{A}\\,\\text{m}^{-2}$.\n- Pedestal pressure drop: $\\Delta p = 1.8 \\times 10^{4}$ $\\text{Pa}$.\n- Pedestal half-width: $w = 5.0 \\times 10^{-3}$ $\\text{m}$.\n- Edge safety factor: $q_{\\text{edge}} = 4.0$.\n- Edge magnetic shear (defined as $s \\equiv (r/q)\\,dq/dr$ and taken as a measured equilibrium parameter): $s_{\\text{edge}} = 1.2$.\n\nUsing only first-principles relations (force balance, Ampère’s law, and the ideal MHD energy principle in a sheared slab), define the normalized edge current gradient\n$$\n\\gamma \\;\\equiv\\; \\frac{w}{\\,j_{\\parallel}(r)}\\,\\frac{d j_{\\parallel}}{dr}(r)\n$$\nat the measurement location $r = r_{m}$, and compute the proximity to the peeling stability threshold as the dimensionless ratio\n$$\nP \\;\\equiv\\; \\frac{|\\gamma|}{\\,s_{\\text{edge}}\\,}.\n$$\nAdopt the ideal peeling-mode marginality condition in the sheared slab approximation that equates the current-gradient drive to the stabilizing field-line bending via magnetic shear, so that proximity can be assessed by $P$ as defined above. Round your final $P$ to four significant figures. Express the answer as a dimensionless number with no units.",
            "solution": "The user has provided a problem from the field of computational fusion science and engineering, requiring the calculation of a dimensionless parameter that quantifies the proximity to a peeling stability threshold in a tokamak plasma.\n\n### Step 1: Extract Givens\nThe problem provides the following data, definitions, and relationships:\n- Pedestal pressure profile: $p(r) = p_{\\text{core}} - \\frac{\\Delta p}{2} \\left[1 + \\tanh\\left(\\frac{r - r_{0}}{w}\\right)\\right]$\n- Bootstrap current density relation: $j_{\\parallel}(r) = C_{\\text{bs}}\\,\\frac{dp}{dr}(r)$, with $C_{\\text{bs}}$ being an approximately constant coefficient.\n- Measured pressure gradient at $r = r_{m}$: $\\left.\\frac{dp}{dr}\\right|_{r_{m}} = -1.35 \\times 10^{6} \\, \\text{Pa}\\,\\text{m}^{-1}$\n- Measured bootstrap current density at $r = r_{m}$: $j_{\\parallel}(r_{m}) = 2.43 \\times 10^{5} \\, \\text{A}\\,\\text{m}^{-2}$\n- Pedestal pressure drop: $\\Delta p = 1.8 \\times 10^{4} \\, \\text{Pa}$\n- Pedestal half-width: $w = 5.0 \\times 10^{-3} \\, \\text{m}$\n- Edge safety factor: $q_{\\text{edge}} = 4.0$\n- Edge magnetic shear: $s_{\\text{edge}} = 1.2$\n- Definition of normalized edge current gradient: $\\gamma \\equiv \\frac{w}{\\,j_{\\parallel}(r)\\,} \\frac{d j_{\\parallel}}{dr}(r)$\n- Definition of proximity to peeling stability threshold: $P \\equiv \\frac{|\\gamma|}{\\,s_{\\text{edge}}\\,}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the specified criteria.\n\n- **Scientifically Grounded**: The problem is well-grounded in ideal magnetohydrodynamics (MHD) as applied to tokamak stability. The use of a hyperbolic tangent profile for the pedestal, the relation between bootstrap current and the pressure gradient ($j_{\\text{bs}} \\propto \\nabla p$), and the concept of a peeling mode driven by edge current gradient and stabilized by magnetic shear are all standard elements in fusion plasma physics.\n- **Well-Posed**: The problem provides all necessary information to compute the final quantity $P$. Although the exact location of the measurement, $r_{m}$, relative to the center of the pedestal, $r_{0}$, is not given, this ambiguity is resolved by the use of the absolute value in the definition of the final quantity $P$. The problem is structured to lead to a unique solution. The presence of potentially superfluous data (e.g., $q_{\\text{edge}}$, $j_{\\parallel}(r_{m})$) does not invalidate the problem but rather tests the solver's ability to identify relevant parameters.\n- **Objective**: The problem is stated in precise, objective language without subjective or opinion-based content.\n- **Other Flaws**: The problem is free from contradictions, unrealistic data, or ill-posed structures. The units are consistent, and the given numerical values are physically plausible for a tokamak H-mode pedestal.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution\nThe objective is to compute the dimensionless proximity parameter $P$, defined as:\n$$\nP = \\frac{|\\gamma|}{s_{\\text{edge}}}\n$$\nThe edge magnetic shear $s_{\\text{edge}}$ is given. The central task is to determine the value of the normalized edge current gradient, $\\gamma$, at the measurement location $r = r_{m}$. The definition for $\\gamma$ is:\n$$\n\\gamma = \\frac{w}{j_{\\parallel}(r_{m})} \\left. \\frac{d j_{\\parallel}}{dr} \\right|_{r=r_{m}}\n$$\nWe are given the local relationship $j_{\\parallel}(r) = C_{\\text{bs}} \\frac{dp}{dr}(r)$, where the coefficient $C_{\\text{bs}}$ is assumed to be constant over the narrow pedestal region. Differentiating this expression with respect to the minor radius $r$ yields:\n$$\n\\frac{d j_{\\parallel}}{dr} = \\frac{d}{dr} \\left( C_{\\text{bs}} \\frac{dp}{dr} \\right) = C_{\\text{bs}} \\frac{d^2 p}{dr^2}\n$$\nThe constant $C_{\\text{bs}}$ can be expressed using the given values at $r = r_{m}$ as $C_{\\text{bs}} = \\frac{j_{\\parallel}(r_{m})}{\\left. \\frac{dp}{dr} \\right|_{r_{m}}}$. Substituting this into the expression for the current density gradient gives:\n$$\n\\left. \\frac{d j_{\\parallel}}{dr} \\right|_{r_{m}} = \\frac{j_{\\parallel}(r_{m})}{\\left. \\frac{dp}{dr} \\right|_{r_{m}}} \\left. \\frac{d^2 p}{dr^2} \\right|_{r_{m}}\n$$\nNow, we substitute this result into the definition of $\\gamma$:\n$$\n\\gamma = \\frac{w}{j_{\\parallel}(r_{m})} \\left( \\frac{j_{\\parallel}(r_{m})}{\\left. \\frac{dp}{dr} \\right|_{r_{m}}} \\left. \\frac{d^2 p}{dr^2} \\right|_{r_{m}} \\right) = w \\frac{\\left. \\frac{d^2 p}{dr^2} \\right|_{r_{m}}}{\\left. \\frac{dp}{dr} \\right|_{r_{m}}}\n$$\nThis simplified expression for $\\gamma$ depends only on the first and second derivatives of the pressure profile, evaluated at $r=r_{m}$, and the pedestal half-width $w$.\n\nNext, we compute the required derivatives from the given pressure profile, $p(r) = p_{\\text{core}} - \\frac{\\Delta p}{2} \\left[1 + \\tanh\\left(\\frac{r - r_{0}}{w}\\right)\\right]$. Let $u(r) = \\frac{r - r_{0}}{w}$. The first derivative with respect to $r$ is:\n$$\n\\frac{dp}{dr} = -\\frac{\\Delta p}{2} \\frac{d}{dr}\\left[\\tanh(u(r))\\right] = -\\frac{\\Delta p}{2} \\left[\\text{sech}^2(u(r)) \\cdot \\frac{du}{dr}\\right] = -\\frac{\\Delta p}{2w} \\text{sech}^2\\left(\\frac{r - r_{0}}{w}\\right)\n$$\nThe second derivative is:\n$$\n\\frac{d^2 p}{dr^2} = -\\frac{\\Delta p}{2w} \\frac{d}{dr}\\left[\\text{sech}^2(u(r))\\right] = -\\frac{\\Delta p}{2w} \\left[2\\,\\text{sech}(u(r)) \\cdot (-\\text{sech}(u(r))\\tanh(u(r))) \\cdot \\frac{du}{dr}\\right]\n$$\n$$\n\\frac{d^2 p}{dr^2} = -\\frac{\\Delta p}{2w} \\left[- \\frac{2}{w} \\text{sech}^2\\left(\\frac{r - r_{0}}{w}\\right) \\tanh\\left(\\frac{r - r_{0}}{w}\\right)\\right] = \\frac{\\Delta p}{w^2} \\text{sech}^2\\left(\\frac{r - r_{0}}{w}\\right) \\tanh\\left(\\frac{r - r_{0}}{w}\\right)\n$$\nNow, substitute these derivatives into the expression for $\\gamma$:\n$$\n\\gamma = w \\frac{\\frac{\\Delta p}{w^2} \\text{sech}^2\\left(\\frac{r - r_{0}}{w}\\right) \\tanh\\left(\\frac{r - r_{0}}{w}\\right)}{-\\frac{\\Delta p}{2w} \\text{sech}^2\\left(\\frac{r - r_{0}}{w}\\right)}\n$$\nThe terms $\\Delta p$ and $\\text{sech}^2(\\dots)$ cancel out. We are left with:\n$$\n\\gamma = w \\frac{\\frac{1}{w^2} \\tanh\\left(\\frac{r - r_{0}}{w}\\right)}{-\\frac{1}{2w}} = -2 \\tanh\\left(\\frac{r - r_{0}}{w}\\right)\n$$\nTo find the value of $\\gamma$ at $r=r_{m}$, we need to evaluate $\\tanh\\left(\\frac{r_m - r_{0}}{w}\\right)$. We can find this from the given value of the pressure gradient at $r_m$.\nFrom the expression for the first derivative:\n$$\n\\left. \\frac{dp}{dr} \\right|_{r_{m}} = -\\frac{\\Delta p}{2w} \\text{sech}^2\\left(\\frac{r_m - r_{0}}{w}\\right)\n$$\nSolving for $\\text{sech}^2\\left(\\frac{r_m - r_{0}}{w}\\right)$:\n$$\n\\text{sech}^2\\left(\\frac{r_m - r_{0}}{w}\\right) = - \\left. \\frac{dp}{dr} \\right|_{r_{m}} \\frac{2w}{\\Delta p}\n$$\nUsing the identity $\\tanh^2(x) + \\text{sech}^2(x) = 1$, we can write $|\\tanh(x)| = \\sqrt{1 - \\text{sech}^2(x)}$.\nTherefore, the magnitude of $\\gamma$ is:\n$$\n|\\gamma| = \\left|-2 \\tanh\\left(\\frac{r_m - r_{0}}{w}\\right)\\right| = 2 \\left|\\tanh\\left(\\frac{r_m - r_{0}}{w}\\right)\\right| = 2 \\sqrt{1 - \\text{sech}^2\\left(\\frac{r_m - r_{0}}{w}\\right)}\n$$\nSubstituting the expression for $\\text{sech}^2(\\dots)$:\n$$\n|\\gamma| = 2 \\sqrt{1 - \\left(- \\left. \\frac{dp}{dr} \\right|_{r_{m}} \\frac{2w}{\\Delta p}\\right)} = 2 \\sqrt{1 + \\frac{2w}{\\Delta p} \\left. \\frac{dp}{dr} \\right|_{r_{m}}}\n$$\nNow, we substitute the given numerical values:\n- $\\left.\\frac{dp}{dr}\\right|_{r_{m}} = -1.35 \\times 10^{6} \\, \\text{Pa}\\,\\text{m}^{-1}$\n- $w = 5.0 \\times 10^{-3} \\, \\text{m}$\n- $\\Delta p = 1.8 \\times 10^{4} \\, \\text{Pa}$\n\nFirst, calculate the term inside the square root:\n$$\n\\frac{2w}{\\Delta p} \\left. \\frac{dp}{dr} \\right|_{r_{m}} = \\frac{2 \\cdot (5.0 \\times 10^{-3})}{1.8 \\times 10^{4}} \\cdot (-1.35 \\times 10^{6}) = \\frac{1.0 \\times 10^{-2}}{1.8 \\times 10^{4}} \\cdot (-1.35 \\times 10^{6})\n$$\n$$\n= \\frac{-1.35 \\times 10^{4}}{1.8 \\times 10^{4}} = -\\frac{1.35}{1.8} = -0.75\n$$\nNow compute $|\\gamma|$:\n$$\n|\\gamma| = 2 \\sqrt{1 + (-0.75)} = 2 \\sqrt{0.25} = 2 \\cdot 0.5 = 1.0\n$$\nFinally, we compute the proximity parameter $P$:\n$$\nP = \\frac{|\\gamma|}{s_{\\text{edge}}} = \\frac{1.0}{1.2} = \\frac{10}{12} = \\frac{5}{6}\n$$\nAs a decimal, this is $0.833333...$. Rounding to four significant figures as requested gives $0.8333$.",
            "answer": "$$\n\\boxed{0.8333}\n$$"
        },
        {
            "introduction": "A defining challenge in simulating ELM crashes is the extreme numerical 'stiffness' of the governing equations, arising from the vast difference in timescales between dynamics along and across magnetic field lines. Parallel heat transport is exceptionally rapid, and modeling it with standard explicit time-integration schemes imposes an impractically severe restriction on the simulation timestep. This practice demonstrates this critical issue by having you derive the stability constraint for an explicit method and compare it to the timestep allowed by an implicit method, highlighting the necessity of advanced numerical techniques for efficient and accurate ELM modeling .",
            "id": "3970115",
            "problem": "Consider modeling the rapid temperature evolution along a magnetic field line during an Edge Localized Mode (ELM) crash in a tokamak pedestal using a reduced one-dimensional model for electron parallel heat transport. Let $s$ denote the arc length along the magnetic field line, and let $T(s,t)$ be the electron temperature. Assume that, over the time window of interest, the temperature dynamics along the field line are dominated by linear diffusion with a constant parallel thermal diffusivity $\\chi_{\\parallel}$, so that the governing equation is the heat equation\n$$\n\\frac{\\partial T}{\\partial t} \\;=\\; \\chi_{\\parallel}\\,\\frac{\\partial^{2}T}{\\partial s^{2}}\\,,\n$$\nposed on a parallel connection length $L_{\\parallel}$ with periodic boundary conditions. You wish to compare explicit and implicit time integration for the diffusive term during the crash.\n\nStarting from this partial differential equation and a standard second-order central finite-difference approximation in space on a uniform grid of $N$ nodes with spacing $\\Delta s \\equiv L_{\\parallel}/N$, and using a forward Euler explicit time integrator, use Fourier (von Neumann) analysis to derive the stability constraint on the timestep $\\Delta t$ in terms of $\\Delta s$ and $\\chi_{\\parallel}$. Then, evaluate the most restrictive explicit stable timestep $\\Delta t_{\\mathrm{exp}}^{\\max}$ for the following scientifically plausible pedestal-line parameters:\n- $L_{\\parallel} = 30\\,\\mathrm{m}$,\n- $N = 6000$,\n- $\\chi_{\\parallel} = 3.0 \\times 10^{8}\\,\\mathrm{m^{2}\\,s^{-1}}$.\n\nNow consider replacing the explicit integrator for the diffusion term with a fully implicit backward Euler integrator, which is unconditionally stable for the linear diffusion equation. Suppose that to resolve the global crash dynamics you target approximately $50$ time steps across a characteristic crash time $\\tau_{\\mathrm{crash}} = 0.5\\,\\mathrm{ms}$, so that the accuracy-motivated implicit timestep is $\\Delta t_{\\mathrm{imp}} = \\tau_{\\mathrm{crash}}/50$.\n\nDefine the improvement factor\n$$\nS \\;\\equiv\\; \\frac{\\Delta t_{\\mathrm{imp}}}{\\Delta t_{\\mathrm{exp}}^{\\max}}\\,.\n$$\n\nCompute $S$ for the parameters given above. Express your final numerical answer as a pure number without units and round to three significant figures. Use the International System of Units (SI) for all intermediate computations.",
            "solution": "The problem requires a two-part calculation. First, we must derive the stability constraint for a forward Euler explicit time integration scheme applied to the one-dimensional heat equation. Second, we must use this result to compute an \"improvement factor\" $S$, which compares the stability-limited explicit timestep to an accuracy-limited implicit timestep for a set of given physical parameters.\n\nThe governing partial differential equation for the electron temperature $T(s,t)$ is the heat equation:\n$$\n\\frac{\\partial T}{\\partial t} \\;=\\; \\chi_{\\parallel}\\,\\frac{\\partial^{2}T}{\\partial s^{2}}\n$$\nwhere $s$ is the arc length along the magnetic field line, $t$ is time, and $\\chi_{\\parallel}$ is the constant parallel thermal diffusivity.\n\nFirst, we discretize this equation. Let $T_j^n$ denote the temperature at spatial grid point $j$ and time level $n$, such that $s_j = j \\Delta s$ and $t_n = n \\Delta t$. We use a second-order central finite-difference for the spatial derivative and a forward Euler scheme for the time derivative.\n\nThe spatial derivative is approximated as:\n$$\n\\frac{\\partial^{2}T}{\\partial s^{2}}\\bigg|_{s_j} \\approx \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta s)^2}\n$$\nThe time derivative is approximated as:\n$$\n\\frac{\\partial T}{\\partial t}\\bigg|_{t_n} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\nSubstituting these into the heat equation yields the fully discretized scheme:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\chi_{\\parallel} \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta s)^2}\n$$\nRearranging for $T_j^{n+1}$, we get the update rule:\n$$\nT_j^{n+1} = T_j^n + \\frac{\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\nTo analyze the stability of this scheme, we perform a von Neumann stability analysis. We consider a single Fourier mode of the solution, $T_j^n = G(k)^n e^{ik s_j}$, where $k$ is the wavenumber and $G(k)$ is the amplification factor per timestep. Substituting this form into the update rule:\n$$\nG(k)^{n+1} e^{ikj\\Delta s} = G(k)^n e^{ikj\\Delta s} + \\frac{\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\left( G(k)^n e^{ik(j+1)\\Delta s} - 2G(k)^n e^{ikj\\Delta s} + G(k)^n e^{ik(j-1)\\Delta s} \\right)\n$$\nDividing by $G(k)^n e^{ikj\\Delta s}$ gives the expression for the amplification factor $G(k)$:\n$$\nG(k) = 1 + \\frac{\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\left( e^{ik\\Delta s} - 2 + e^{-ik\\Delta s} \\right)\n$$\nUsing the identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, this simplifies to:\n$$\nG(k) = 1 + \\frac{\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\left( 2\\cos(k\\Delta s) - 2 \\right) = 1 - \\frac{2\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\left( 1 - \\cos(k\\Delta s) \\right)\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we obtain:\n$$\nG(k) = 1 - \\frac{4\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\sin^2\\left(\\frac{k\\Delta s}{2}\\right)\n$$\nFor the scheme to be numerically stable, the magnitude of the amplification factor must be no greater than $1$ for all possible wavenumbers $k$, i.e., $|G(k)| \\le 1$. This implies $-1 \\le G(k) \\le 1$.\n\nThe condition $G(k) \\le 1$ becomes $1 - \\frac{4\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\sin^2\\left(\\frac{k\\Delta s}{2}\\right) \\le 1$, which simplifies to $-\\frac{4\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\sin^2\\left(\\frac{k\\Delta s}{2}\\right) \\le 0$. Since $\\chi_{\\parallel}$, $\\Delta t$, $(\\Delta s)^2$, and $\\sin^2(\\cdot)$ are all non-negative, this condition is always satisfied.\n\nThe condition $G(k) \\ge -1$ is the crucial one:\n$$\n1 - \\frac{4\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\sin^2\\left(\\frac{k\\Delta s}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge \\frac{4\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\sin^2\\left(\\frac{k\\Delta s}{2}\\right)\n$$\n$$\n\\frac{\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\le \\frac{1}{2\\sin^2\\left(\\frac{k\\Delta s}{2}\\right)}\n$$\nThis must hold for all $k$. The most restrictive condition occurs when the right-hand side is minimized, which corresponds to the denominator being maximized. The maximum value of $\\sin^2(\\cdot)$ is $1$, which occurs for the highest frequency mode the grid can resolve, $k\\Delta s = \\pi$. This yields the stability constraint:\n$$\n\\frac{\\chi_{\\parallel} \\Delta t}{(\\Delta s)^2} \\le \\frac{1}{2}\n$$\nThus, the timestep $\\Delta t$ is constrained by:\n$$\n\\Delta t \\le \\frac{(\\Delta s)^2}{2\\chi_{\\parallel}}\n$$\nThe most restrictive explicit stable timestep, $\\Delta t_{\\mathrm{exp}}^{\\max}$, is the maximum allowed value:\n$$\n\\Delta t_{\\mathrm{exp}}^{\\max} = \\frac{(\\Delta s)^2}{2\\chi_{\\parallel}}\n$$\nNow, we compute the numerical values. First, the grid spacing $\\Delta s$:\nGiven $L_{\\parallel} = 30\\,\\mathrm{m}$ and $N = 6000$.\n$$\n\\Delta s = \\frac{L_{\\parallel}}{N} = \\frac{30\\,\\mathrm{m}}{6000} = 0.005\\,\\mathrm{m} = 5 \\times 10^{-3}\\,\\mathrm{m}\n$$\nNext, we compute $\\Delta t_{\\mathrm{exp}}^{\\max}$ using $\\chi_{\\parallel} = 3.0 \\times 10^{8}\\,\\mathrm{m^{2}\\,s^{-1}}$:\n$$\n\\Delta t_{\\mathrm{exp}}^{\\max} = \\frac{(5 \\times 10^{-3}\\,\\mathrm{m})^2}{2 \\times (3.0 \\times 10^{8}\\,\\mathrm{m^{2}\\,s^{-1}})} = \\frac{25 \\times 10^{-6}\\,\\mathrm{m}^2}{6.0 \\times 10^{8}\\,\\mathrm{m^{2}\\,s^{-1}}}\n$$\n$$\n\\Delta t_{\\mathrm{exp}}^{\\max} = \\frac{25}{6.0} \\times 10^{-14}\\,\\mathrm{s} \\approx 4.1667 \\times 10^{-14}\\,\\mathrm{s}\n$$\nNext, we determine the implicit timestep $\\Delta t_{\\mathrm{imp}}$. This is set by accuracy requirements for resolving the crash dynamics over a characteristic time $\\tau_{\\mathrm{crash}} = 0.5\\,\\mathrm{ms}$ in approximately $50$ steps.\n$$\n\\tau_{\\mathrm{crash}} = 0.5\\,\\mathrm{ms} = 0.5 \\times 10^{-3}\\,\\mathrm{s} = 5 \\times 10^{-4}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\mathrm{imp}} = \\frac{\\tau_{\\mathrm{crash}}}{50} = \\frac{5 \\times 10^{-4}\\,\\mathrm{s}}{50} = 1 \\times 10^{-5}\\,\\mathrm{s}\n$$\nFinally, we compute the improvement factor $S$:\n$$\nS = \\frac{\\Delta t_{\\mathrm{imp}}}{\\Delta t_{\\mathrm{exp}}^{\\max}} = \\frac{1 \\times 10^{-5}\\,\\mathrm{s}}{\\frac{25}{6.0} \\times 10^{-14}\\,\\mathrm{s}} = \\frac{6.0}{25} \\times \\frac{10^{-5}}{10^{-14}} = 0.24 \\times 10^9 = 2.4 \\times 10^8\n$$\nThe problem specifies the answer should be rounded to three significant figures.\n$$\nS = 2.40 \\times 10^8\n$$\nThis very large number illustrates the extreme stiffness of the parallel heat diffusion problem in fusion plasmas and highlights the significant computational advantage of using implicit methods over explicit ones for such problems.",
            "answer": "$$ \\boxed{2.40 \\times 10^8} $$"
        },
        {
            "introduction": "Before simulation results can be trusted, the underlying code must be verified to ensure it correctly solves the intended mathematical equations. A fundamental verification technique is the grid convergence study, which confirms that the numerical error decreases at the expected rate as the simulation's spatial resolution is increased. This exercise provides hands-on experience with this essential process, tasking you with analyzing a set of hypothetical simulation results to determine the observed order of accuracy of the numerical method . Mastering this skill is crucial for building confidence in the predictions of any computational model.",
            "id": "3970125",
            "problem": "Consider modeling the linear growth rate of an Edge Localized Mode (ELM) instability in a magnetically confined plasma using discretizations that resolve the pedestal edge region. Let the continuum (grid-independent) growth rate be denoted by $\\gamma_\\infty$ with physical units $\\mathrm{s}^{-1}$. A sequence of numerical simulations provides approximate growth rates $\\gamma(\\Delta)$ at multiple grid spacings $\\Delta$ (in meters). For a consistent discretization, the leading-order grid-induced error is well-approximated by a power law of the form\n$$\nE(\\Delta) \\equiv \\lvert \\gamma(\\Delta) - \\gamma_\\infty \\rvert \\sim C \\Delta^p,\n$$\nwhere $C$ is a constant and $p$ is the observed order of accuracy. This scaling arises from truncation error in the discretized Magnetohydrodynamics (MHD) equations that govern linear ELM growth in the plasma edge, under standard smoothness assumptions on the solution and the numerical scheme.\n\nYour task is to write a program that, for each test case provided below, estimates the observed order $p$ by fitting the model $E(\\Delta) \\approx C \\Delta^p$ using an ordinary least squares regression in logarithmic variables. Specifically, use the transformation\n$$\n\\ln E(\\Delta) \\approx \\ln C + p \\ln \\Delta\n$$\nwith the natural logarithm, and determine $p$ as the fitted slope. Use all available points in each test case.\n\nPhysical units: All growth rates must be treated in $\\mathrm{s}^{-1}$ and all grid spacings in $\\mathrm{m}$. The final reported $p$ values are dimensionless.\n\nTest suite:\n- Case A (nominal second-order convergence, underprediction bias): $\\gamma_\\infty = 120000\\,\\mathrm{s}^{-1}$, grid spacings $\\Delta \\in \\{0.004, 0.002, 0.001, 0.0005\\}\\,\\mathrm{m}$, simulated growth rates $\\gamma(\\Delta) \\in \\{118720, 119680, 119920, 119980\\}\\,\\mathrm{s}^{-1}$.\n- Case B (nominal first-order convergence, overprediction bias): $\\gamma_\\infty = 95000\\,\\mathrm{s}^{-1}$, grid spacings $\\Delta \\in \\{0.003, 0.0015, 0.00075, 0.000375\\}\\,\\mathrm{m}$, simulated growth rates $\\gamma(\\Delta) \\in \\{95060, 95030, 95015, 95007.5\\}\\,\\mathrm{s}^{-1}$.\n- Case C (nominal third-order convergence with mild jitter, underprediction bias): $\\gamma_\\infty = 180000\\,\\mathrm{s}^{-1}$, grid spacings $\\Delta \\in \\{0.0025, 0.00125, 0.000625, 0.0003125\\}\\,\\mathrm{m}$, simulated growth rates $\\gamma(\\Delta) \\in \\{179764.6875, 179970.791015625, 179996.31958007812, 179999.5440673828\\}\\,\\mathrm{s}^{-1}$.\n\nRequirements:\n1. For each case, compute the error values $E(\\Delta) = \\lvert \\gamma(\\Delta) - \\gamma_\\infty \\rvert$.\n2. Fit the linear model in the variables $(x, y) = (\\ln \\Delta, \\ln E(\\Delta))$ using ordinary least squares to estimate $p$ as the slope.\n3. Round each estimated $p$ to three decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the three rounded $p$ values for Cases A, B, and C, in that order, as a comma-separated list enclosed in square brackets, for example, $[p_A,p_B,p_C]$. The numbers must be printed as decimal floats rounded to three decimal places with no additional text.",
            "solution": "The objective of this problem is to determine the observed order of accuracy, $p$, for a series of numerical simulations of an Edge Localized Mode (ELM) instability. This is a standard procedure in the verification and validation of scientific codes, where the convergence of a numerical solution to the continuum solution is assessed as the grid resolution is refined.\n\nThe theoretical basis for this analysis is the power-law relationship between the numerical error, $E(\\Delta)$, and the grid spacing, $\\Delta$. The error is defined as the absolute difference between the numerically computed growth rate, $\\gamma(\\Delta)$, and the grid-independent (continuum) growth rate, $\\gamma_\\infty$:\n$$\nE(\\Delta) = \\lvert \\gamma(\\Delta) - \\gamma_\\infty \\rvert\n$$\nFor a consistent numerical scheme of order $p$, this error is expected to scale as:\n$$\nE(\\Delta) \\approx C \\Delta^p\n$$\nwhere $C$ is a constant that depends on the magnitude of higher-order derivatives of the solution, and $p$ is the order of accuracy.\n\nTo estimate $p$ from the provided data, we linearize the model by taking the natural logarithm of both sides:\n$$\n\\ln(E(\\Delta)) \\approx \\ln(C) + p \\ln(\\Delta)\n$$\nThis equation has the form of a line, $y = b + mx$, where the variables are $y = \\ln(E(\\Delta))$ and $x = \\ln(\\Delta)$, the slope is $m = p$, and the y-intercept is $b = \\ln(C)$. We can therefore determine $p$ by performing an ordinary least squares (OLS) linear regression on the set of data points $(\\ln(\\Delta_i), \\ln(E_i))$ for each case. The slope $p$ is given by the formula:\n$$\np = \\frac{n \\sum_{i=1}^{n} (x_i y_i) - (\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n \\sum_{i=1}^{n} (x_i^2) - (\\sum_{i=1}^{n} x_i)^2}\n$$\nwhere $n$ is the number of data points, $x_i = \\ln(\\Delta_i)$, and $y_i = \\ln(E(\\Delta_i))$. The following analysis applies this procedure to each test case.\n\n**Case A Analysis**\nThe provided data for this case are:\n-   Continuum growth rate: $\\gamma_\\infty = 120000\\,\\mathrm{s}^{-1}$\n-   Grid spacings: $\\Delta = \\{0.004, 0.002, 0.001, 0.0005\\}\\,\\mathrm{m}$\n-   Simulated growth rates: $\\gamma(\\Delta) = \\{118720, 119680, 119920, 119980\\}\\,\\mathrm{s}^{-1}$\n\nFirst, we compute the error $E(\\Delta_i) = \\lvert \\gamma(\\Delta_i) - \\gamma_\\infty \\rvert$ for each data point:\n-   $E_1 = \\lvert 118720 - 120000 \\rvert = 1280$\n-   $E_2 = \\lvert 119680 - 120000 \\rvert = 320$\n-   $E_3 = \\lvert 119920 - 120000 \\rvert = 80$\n-   $E_4 = \\lvert 119980 - 120000 \\rvert = 20$\n\nNext, we compute the log-transformed variables $x_i = \\ln(\\Delta_i)$ and $y_i = \\ln(E_i)$:\n-   $x_1 = \\ln(0.004) \\approx -5.5215$\n-   $x_2 = \\ln(0.002) \\approx -6.2146$\n-   $x_3 = \\ln(0.001) \\approx -6.9078$\n-   $x_4 = \\ln(0.0005) \\approx -7.6009$\n-   $y_1 = \\ln(1280) \\approx 7.1546$\n-   $y_2 = \\ln(320) \\approx 5.7683$\n-   $y_3 = \\ln(80) \\approx 4.3820$\n-   $y_4 = \\ln(20) \\approx 2.9957$\n\nPerforming a linear regression on these $(x_i, y_i)$ pairs yields the slope $p_A$. The error reduces by a factor of $4$ each time the grid spacing is halved, which indicates a perfect second-order convergence. The calculation confirms this.\n$p_A = 2.0$\n\n**Case B Analysis**\nThe provided data for this case are:\n-   Continuum growth rate: $\\gamma_\\infty = 95000\\,\\mathrm{s}^{-1}$\n-   Grid spacings: $\\Delta = \\{0.003, 0.0015, 0.00075, 0.000375\\}\\,\\mathrm{m}$\n-   Simulated growth rates: $\\gamma(\\Delta) = \\{95060, 95030, 95015, 95007.5\\}\\,\\mathrm{s}^{-1}$\n\nFirst, we compute the error $E(\\Delta_i)$:\n-   $E_1 = \\lvert 95060 - 95000 \\rvert = 60$\n-   $E_2 = \\lvert 95030 - 95000 \\rvert = 30$\n-   $E_3 = \\lvert 95015 - 95000 \\rvert = 15$\n-   $E_4 = \\lvert 95007.5 - 95000 \\rvert = 7.5$\n\nNext, we compute the log-transformed variables $x_i = \\ln(\\Delta_i)$ and $y_i = \\ln(E_i)$:\n-   $x_1 = \\ln(0.003) \\approx -5.8091$\n-   $x_2 = \\ln(0.0015) \\approx -6.5023$\n-   $x_3 = \\ln(0.00075) \\approx -7.1954$\n-   $x_4 = \\ln(0.000375) \\approx -7.8886$\n-   $y_1 = \\ln(60) \\approx 4.0943$\n-   $y_2 = \\ln(30) \\approx 3.4012$\n-   $y_3 = \\ln(15) \\approx 2.7081$\n-   $y_4 = \\ln(7.5) \\approx 2.0149$\n\nPerforming the linear regression on these pairs yields the slope $p_B$. In this case, the error reduces by a factor of $2$ each time the grid spacing is halved, which points to a perfect first-order convergence.\n$p_B = 1.0$\n\n**Case C Analysis**\nThe provided data for this case are:\n-   Continuum growth rate: $\\gamma_\\infty = 180000\\,\\mathrm{s}^{-1}$\n-   Grid spacings: $\\Delta = \\{0.0025, 0.00125, 0.000625, 0.0003125\\}\\,\\mathrm{m}$\n-   Simulated growth rates: $\\gamma(\\Delta) = \\{179764.6875, 179970.791015625, 179996.31958007812, 179999.5440673828\\}\\,\\mathrm{s}^{-1}$\n\nFirst, we compute the error $E(\\Delta_i)$:\n-   $E_1 = \\lvert 179764.6875 - 180000 \\rvert = 235.3125$\n-   $E_2 = \\lvert 179970.791015625 - 180000 \\rvert = 29.208984375$\n-   $E_3 = \\lvert 179996.31958007812 - 180000 \\rvert = 3.680419921875$\n-   $E_4 = \\lvert 179999.5440673828 - 180000 \\rvert \\approx 0.4559326172$\n\nNext, we compute the log-transformed variables $x_i = \\ln(\\Delta_i)$ and $y_i = \\ln(E_i)$:\n-   $x_1 = \\ln(0.0025) \\approx -5.9915$\n-   $x_2 = \\ln(0.00125) \\approx -6.6846$\n-   $x_3 = \\ln(0.000625) \\approx -7.3778$\n-   $x_4 = \\ln(0.0003125) \\approx -8.0709$\n-   $y_1 = \\ln(235.3125) \\approx 5.4609$\n-   $y_2 = \\ln(29.20898) \\approx 3.3745$\n-   $y_3 = \\ln(3.68042) \\approx 1.3030$\n-   $y_4 = \\ln(0.45593) \\approx -0.7854$\n\nPerforming the linear regression on these pairs yields the slope $p_C$. The error reduction factor between successive refinements is close to $8 = 2^3$, suggesting a third-order scheme. The OLS fit provides a precise estimate.\n$p_C \\approx 3.00397556$\n\n**Summary of Results**\nThe calculated orders of accuracy for each case, rounded to three decimal places as required, are:\n-   Case A: $p_A = 2.000$\n-   Case B: $p_B = 1.000$\n-   Case C: $p_C = 3.004$\nThese results are consistent with the descriptions of nominal second-order, first-order, and third-order convergence, respectively.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the observed order of accuracy 'p' for numerical simulation data\n    by performing a linear regression on the log-transformed error data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"gamma_inf\": 120000.0,\n            \"delta\": np.array([0.004, 0.002, 0.001, 0.0005]),\n            \"gamma_delta\": np.array([118720, 119680, 119920, 119980])\n        },\n        {\n            \"name\": \"Case B\",\n            \"gamma_inf\": 95000.0,\n            \"delta\": np.array([0.003, 0.0015, 0.00075, 0.000375]),\n            \"gamma_delta\": np.array([95060, 95030, 95015, 95007.5])\n        },\n        {\n            \"name\": \"Case C\",\n            \"gamma_inf\": 180000.0,\n            \"delta\": np.array([0.0025, 0.00125, 0.000625, 0.0003125]),\n            \"gamma_delta\": np.array([179764.6875, 179970.791015625, 179996.31958007812, 179999.5440673828])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Step 1: Compute the error values E(Delta) = |gamma(Delta) - gamma_inf|.\n        error = np.abs(case[\"gamma_delta\"] - case[\"gamma_inf\"])\n\n        # Step 2: Transform variables for linear regression:\n        # x = log(Delta), y = log(E(Delta))\n        log_delta = np.log(case[\"delta\"])\n        log_error = np.log(error)\n\n        # Step 3: Fit the linear model y = p*x + log(C) using ordinary least squares.\n        # np.polyfit with degree 1 performs a linear regression and returns [slope, intercept].\n        # The slope 'p' is the observed order of accuracy.\n        p, _ = np.polyfit(log_delta, log_error, 1)\n        \n        # Format the result to three decimal places.\n        results.append(f\"{p:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}