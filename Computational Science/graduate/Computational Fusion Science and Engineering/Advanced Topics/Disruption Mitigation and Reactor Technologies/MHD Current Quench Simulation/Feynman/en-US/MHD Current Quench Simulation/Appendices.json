{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex magnetohydrodynamic (MHD) simulations, it is invaluable to understand the global energy dynamics of a current quench through a simplified model. This practice treats the entire tokamak plasma as a single inductive-resistive ($L-R$) circuit, a powerful first approximation. By solving this model, you will gain hands-on experience in calculating the fundamental quantities that define a disruption, such as the massive induced loop voltage and the total magnetic energy converted into dissipated heat .",
            "id": "4010591",
            "problem": "A large aspect-ratio tokamak plasma during a Magnetohydrodynamics (MHD) current quench can be modeled as a single axisymmetric circuit with constant self-inductance $L_p$ and a uniform scalar resistivity that yields a constant effective plasma resistance $R_p$. Assume there is no applied transformer drive during the quench, that eddy-current coupling to surrounding structures is negligible, and that geometric parameters are constant so the poloidal magnetic flux linked to the plasma is $\\Phi_p(t)=L_p I_p(t)$ for all times $t$. Define the toroidal loop voltage $V_\\mathrm{loop}(t)$ as the line integral of the toroidal electric field around a closed toroidal contour inside the plasma, so that the resistive Magnetohydrodynamics (MHD) closure gives $V_\\mathrm{loop}(t)=R_p I_p(t)$. Using Maxwell–Faraday’s law, the definition of inductance, and these modeling assumptions, derive the evolution of the plasma current $I_p(t)$ during the resistive decay and compute:\n- the explicit functional form of $V_\\mathrm{loop}(t)$ in volts, and\n- the total ohmic energy dissipated until the plasma current decays from its initial value $I_0$ at $t=0$ to $I_p=1\\,\\mathrm{MA}$, expressed in joules.\n\nUse the parameter values $L_p=1.0\\,\\mathrm{H}$, $R_p=0.01\\,\\Omega$, and $I_0=5\\,\\mathrm{MA}$. Do not assume any external sources or sinks of magnetic energy other than ohmic dissipation. The final ohmic energy should be reported in $\\mathrm{J}$, and the loop voltage should be reported in $\\mathrm{V}$. No rounding instruction is necessary unless required by your derivation; if you do round, use significant figures.",
            "solution": "The user wants me to solve the following problem:\nA large aspect-ratio tokamak plasma during a Magnetohydrodynamics (MHD) current quench can be modeled as a single axisymmetric circuit with constant self-inductance $L_p$ and a uniform scalar resistivity that yields a constant effective plasma resistance $R_p$. Assume there is no applied transformer drive during the quench, that eddy-current coupling to surrounding structures is negligible, and that geometric parameters are constant so the poloidal magnetic flux linked to the plasma is $\\Phi_p(t)=L_p I_p(t)$ for all times $t$. Define the toroidal loop voltage $V_\\mathrm{loop}(t)$ as the line integral of the toroidal electric field around a closed toroidal contour inside the plasma, so that the resistive Magnetohydrodynamics (MHD) closure gives $V_\\mathrm{loop}(t)=R_p I_p(t)$. Using Maxwell–Faraday’s law, the definition of inductance, and these modeling assumptions, derive the evolution of the plasma current $I_p(t)$ during the resistive decay and compute:\n- the explicit functional form of $V_\\mathrm{loop}(t)$ in volts, and\n- the total ohmic energy dissipated until the plasma current decays from its initial value $I_0$ at $t=0$ to $I_p=1\\,\\mathrm{MA}$, expressed in joules.\n\nUse the parameter values $L_p=1.0\\,\\mathrm{H}$, $R_p=0.01\\,\\Omega$, and $I_0=5\\,\\mathrm{MA}$. Do not assume any external sources or sinks of magnetic energy other than ohmic dissipation. The final ohmic energy should be reported in $\\mathrm{J}$, and the loop voltage should be reported in $\\mathrm{V}$. No rounding instruction is necessary unless required by your derivation; if you do round, use significant figures.\n\n### Step 1: Extract Givens\n-   Model: Single axisymmetric circuit for a tokamak plasma.\n-   Plasma self-inductance: $L_p$, constant.\n-   Plasma resistance: $R_p$, constant.\n-   External drive: None (no applied transformer drive).\n-   Eddy currents: Negligible.\n-   Geometric parameters: Constant.\n-   Poloidal magnetic flux: $\\Phi_p(t) = L_p I_p(t)$.\n-   Toroidal loop voltage (Ohm's Law): $V_\\mathrm{loop}(t) = R_p I_p(t)$.\n-   Governing law: Maxwell-Faraday's law.\n-   Initial condition: $I_p(0) = I_0$.\n-   Final condition for energy calculation: $I_p = 1\\,\\mathrm{MA}$.\n-   Parameter values:\n    -   $L_p = 1.0\\,\\mathrm{H}$\n    -   $R_p = 0.01\\,\\Omega$\n    -   $I_0 = 5\\,\\mathrm{MA} = 5 \\times 10^6\\,\\mathrm{A}$\n    -   Final current: $I_f = 1\\,\\mathrm{MA} = 1 \\times 10^6\\,\\mathrm{A}$\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem uses a simplified RL circuit model ($L_p$, $R_p$) to describe the resistive decay of current in a plasma. This is a standard, valid first-order approximation in plasma physics and magnetohydrodynamics for a current quench scenario without external drivers. The principles invoked—Maxwell-Faraday's law, Ohm's law, and the definition of inductance—are fundamental to electromagnetism. The given parameter values are physically plausible for a large tokamak.\n2.  **Well-Posed**: The problem is to solve a first-order linear ordinary differential equation with a given initial condition, which constitutes a well-posed initial value problem. It requests the calculation of specific, well-defined physical quantities ($V_\\mathrm{loop}(t)$ and dissipated energy) for which unique solutions exist.\n3.  **Objective**: The problem is stated using precise, objective, and standard scientific terminology.\n4.  **Incomplete or Contradictory Setup**: The problem is self-contained and internally consistent. All necessary parameters and assumptions (constant $L_p$ and $R_p$, no external voltage source) are provided. Faraday's law ($V_\\mathrm{loop} = -d\\Phi_p/dt$), Ohm's law ($V_\\mathrm{loop} = R_p I_p$), and the inductance definition ($\\Phi_p = L_p I_p$) combine consistently to form the governing differential equation.\n5.  **Unrealistic or Infeasible**: While the assumption of constant $R_p$ is a strong simplification (plasma resistivity is a strong function of temperature, which changes dramatically during a quench), it is a common and acceptable simplification for an analytical problem of this nature. It does not render the problem scientifically invalid, but rather defines the idealized physical system to be analyzed.\n\n### Step 3: Verdict and Action\nThe problem is scientifically valid, well-posed, and all necessary information is provided. I will proceed with the detailed solution.\n\nThe fundamental relationship governing the circuit is derived from Maxwell-Faraday's law, which states that the electromotive force (in this case, the toroidal loop voltage) induced in a closed loop is equal to the negative rate of change of the magnetic flux through the loop.\n$$V_\\mathrm{loop}(t) = -\\frac{d\\Phi_p(t)}{dt}$$\nThe problem provides two constitutive relations for the plasma:\n1.  The definition of poloidal flux in terms of the constant self-inductance $L_p$ and plasma current $I_p(t)$:\n    $$\\Phi_p(t) = L_p I_p(t)$$\n2.  The resistive MHD closure (Ohm's law for the plasma circuit):\n    $$V_\\mathrm{loop}(t) = R_p I_p(t)$$\nSubstituting these relations into Faraday's law yields the governing differential equation for the plasma current.\n$$R_p I_p(t) = -\\frac{d}{dt} [L_p I_p(t)]$$\nSince $L_p$ is assumed to be constant, we can write:\n$$R_p I_p(t) = -L_p \\frac{dI_p(t)}{dt}$$\nThis is a first-order, linear, homogeneous ordinary differential equation, which can be rearranged as:\n$$L_p \\frac{dI_p}{dt} + R_p I_p = 0$$\nTo solve for $I_p(t)$, we use the method of separation of variables:\n$$\\frac{dI_p}{I_p} = -\\frac{R_p}{L_p} dt$$\nIntegrating both sides from the initial time $t=0$ with current $I_p(0)=I_0$ to a generic time $t$ with current $I_p(t)$:\n$$\\int_{I_0}^{I_p(t)} \\frac{dI'_p}{I'_p} = -\\frac{R_p}{L_p} \\int_0^t dt'$$\n$$[\\ln|I'_p|]_{I_0}^{I_p(t)} = -\\frac{R_p}{L_p} [t']_0^t$$\n$$\\ln(I_p(t)) - \\ln(I_0) = -\\frac{R_p}{L_p} t$$\n$$\\ln\\left(\\frac{I_p(t)}{I_0}\\right) = -\\frac{R_p}{L_p} t$$\nExponentiating both sides gives the solution for the plasma current as a function of time:\n$$I_p(t) = I_0 \\exp\\left(-\\frac{R_p}{L_p} t\\right)$$\nThis describes an exponential decay of the plasma current with a characteristic resistive time constant $\\tau_p = L_p/R_p$.\n\nFirst, we compute the explicit functional form of the loop voltage, $V_\\mathrm{loop}(t)$. Using the provided Ohm's law relation, $V_\\mathrm{loop}(t) = R_p I_p(t)$, and substituting the derived expression for $I_p(t)$:\n$$V_\\mathrm{loop}(t) = R_p I_0 \\exp\\left(-\\frac{R_p}{L_p} t\\right)$$\nNow we substitute the given numerical values:\n$L_p = 1.0\\,\\mathrm{H}$\n$R_p = 0.01\\,\\Omega$\n$I_0 = 5\\,\\mathrm{MA} = 5 \\times 10^6\\,\\mathrm{A}$\n\nThe initial loop voltage at $t=0$ is $V_0 = R_p I_0$:\n$$V_0 = (0.01\\,\\Omega) \\times (5 \\times 10^6\\,\\mathrm{A}) = 50000\\,\\mathrm{V} = 5 \\times 10^4\\,\\mathrm{V}$$\nThe resistive time constant $\\tau_p$ is:\n$$\\tau_p = \\frac{L_p}{R_p} = \\frac{1.0\\,\\mathrm{H}}{0.01\\,\\Omega} = 100\\,\\mathrm{s}$$\nThus, the explicit functional form for the loop voltage in volts is:\n$$V_\\mathrm{loop}(t) = (5 \\times 10^4) \\exp\\left(-\\frac{t}{100}\\right)$$\n\nNext, we compute the total ohmic energy dissipated, $W_{ohmic}$, as the plasma current decays from its initial value $I_0 = 5\\,\\mathrm{MA}$ to a final value $I_f = 1\\,\\mathrm{MA}$.\nThe instantaneous ohmic power dissipated in the plasma is given by $P(t) = V_\\mathrm{loop}(t) I_p(t) = R_p (I_p(t))^2$. The total energy dissipated is the time integral of this power.\n$$W_{ohmic} = \\int_{t_i}^{t_f} P(t) dt$$\nHowever, a more direct approach utilizes the principle of energy conservation. Since there is no external power source, the energy dissipated as heat through the resistance must equal the decrease in the magnetic energy stored in the inductor. The magnetic energy stored in the inductor is given by $W_M = \\frac{1}{2}L_p I_p^2$.\nThe initial stored magnetic energy at $t=0$ when $I_p = I_0$ is:\n$$W_{M,i} = \\frac{1}{2} L_p I_0^2$$\nThe final stored magnetic energy when $I_p = I_f$ is:\n$$W_{M,f} = \\frac{1}{2} L_p I_f^2$$\nThe total ohmic energy dissipated during this decay is the change in stored energy:\n$$W_{ohmic} = W_{M,i} - W_{M,f} = \\frac{1}{2} L_p I_0^2 - \\frac{1}{2} L_p I_f^2 = \\frac{1}{2} L_p (I_0^2 - I_f^2)$$\nWe now substitute the numerical values:\n$L_p = 1.0\\,\\mathrm{H}$\n$I_0 = 5 \\times 10^6\\,\\mathrm{A}$\n$I_f = 1 \\times 10^6\\,\\mathrm{A}$\n$$W_{ohmic} = \\frac{1}{2} (1.0) \\left( (5 \\times 10^6)^2 - (1 \\times 10^6)^2 \\right)$$\n$$W_{ohmic} = \\frac{1}{2} \\left( 25 \\times 10^{12} - 1 \\times 10^{12} \\right)$$\n$$W_{ohmic} = \\frac{1}{2} \\left( 24 \\times 10^{12} \\right)$$\n$$W_{ohmic} = 12 \\times 10^{12}\\,\\mathrm{J}$$\nIn standard scientific notation, this is $1.2 \\times 10^{13}\\,\\mathrm{J}$.\n\nThe two computed quantities are:\n1. The functional form of the loop voltage: $V_\\mathrm{loop}(t) = (5 \\times 10^4) \\exp(-t/100)\\,\\mathrm{V}$.\n2. The total ohmic energy dissipated: $1.2 \\times 10^{13}\\,\\mathrm{J}$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} (5 \\times 10^4) \\exp\\left(-\\frac{t}{100}\\right) & 1.2 \\times 10^{13} \\end{pmatrix} } $$"
        },
        {
            "introduction": "While the zero-dimensional $L-R$ circuit model provides crucial insights, its validity is limited. This exercise challenges you to explore the breakdown of this simple model and to understand why and when a more sophisticated, spatially-resolved resistive MHD simulation is required. You will derive and apply a quantitative criterion based on the magnetic skin depth and the quench timescale, learning to distinguish regimes where the plasma responds globally from those dominated by strong spatial gradients and skin effects .",
            "id": "4010581",
            "problem": "In a tokamak-like cylindrical plasma column of minor radius $a$, a current quench is modeled either by a zero-dimensional inductive-resistive ($L\\!-\\!R$) circuit, $V_{\\mathrm{loop}} = L\\, dI/dt + R\\, I$, or by resistive magnetohydrodynamics (MHD), which evolves the poloidal flux $\\psi(r,t)$ and current density $J_{\\phi}(r,t)$ according to Faraday’s law, Ampère’s law, and Ohm’s law. Consider resistive MHD with the standard resistive Ohm’s law $E_{\\parallel} = \\eta_{\\mathrm{eff}} J_{\\parallel}$, where $\\eta_{\\mathrm{eff}}$ is an effective resistivity that may include turbulence-induced enhancements, and ignore flows. In a large-aspect-ratio cylinder, the poloidal flux satisfies a diffusion equation of the form\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\frac{\\eta_{\\mathrm{eff}}}{\\mu_0}\\,\\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\psi}{\\partial r}\\right)\\right),\n$$\nwhich implies a characteristic resistive diffusion time $\\tau_R \\sim \\mu_0 a^2/\\eta_{\\mathrm{eff}}$ for global profile evolution. During a current quench with characteristic decay time $\\tau_{\\mathrm{CQ}}$, the inductive electric field and the current profile may vary rapidly. Define a skin depth associated with the quench timescale by\n$$\n\\delta_{\\mathrm{CQ}} \\equiv \\sqrt{\\frac{\\eta_{\\mathrm{eff}}\\,\\tau_{\\mathrm{CQ}}}{\\mu_0}},\n$$\ninterpreted as the radial penetration depth of diffusive magnetic perturbations over time $\\tau_{\\mathrm{CQ}}$. Reconnection processes (e.g., tearing-mode induced topology changes) can further accelerate current redistribution when large gradients develop.\n\nFrom first principles, discuss when the $L\\!-\\!R$ circuit model is expected to fail because spatial current profile diffusion and reconnection dominate, and propose a quantitative criterion based on the ratio $a/\\delta_{\\mathrm{CQ}}$ that discriminates regimes where a zero-dimensional $L\\!-\\!R$ description is acceptable from those where multi-dimensional resistive MHD is required. Then, consider the following statements and select all that are correct:\n\nA. The $L\\!-\\!R$ model assumes spatially uniform electric field and current density across the minor radius and neglects profile diffusion and reconnection. It is therefore self-consistent only when $\\delta_{\\mathrm{CQ}} \\gtrsim a$, equivalently $a/\\delta_{\\mathrm{CQ}} \\ll 1$. When $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$, strong skin effects, steep current gradients, and possible reconnection events invalidate the $L\\!-\\!R$ assumptions, requiring resistive MHD.\n\nB. Because the circuit $L\\!-\\!R$ time is $L/R$, the correct skin depth for a current quench is $\\delta_{\\mathrm{CQ}} = \\sqrt{2\\eta_{\\mathrm{eff}}/(\\mu_0 \\omega)}$ with $\\omega \\equiv R/L$, and the $L\\!-\\!R$ model is valid when $a/\\delta_{\\mathrm{CQ}} \\gg 1$ (the skin effect confines current near the edge, so the interior behaves as an inductor).\n\nC. An equivalent non-dimensional criterion is $C \\equiv (a/\\delta_{\\mathrm{CQ}})^2 = \\tau_R/\\tau_{\\mathrm{CQ}}$. The $L\\!-\\!R$ model is asymptotically valid for $C \\ll 1$ (slow global changes relative to resistive diffusion), and breaks down for $C \\gtrsim \\mathcal{O}(1)$; in the latter regime, spatial diffusion and reconnection can dominate profile evolution on the quench timescale.\n\nD. For $a = 0.6\\,\\mathrm{m}$, $\\eta_{\\mathrm{eff}} = 4\\times 10^{-5}\\,\\Omega\\!\\cdot\\!\\mathrm{m}$, and $\\tau_{\\mathrm{CQ}} = 2\\,\\mathrm{ms}$, one finds $a/\\delta_{\\mathrm{CQ}} \\approx 0.42$, so the $L\\!-\\!R$ model remains acceptable during the quench.\n\nE. Even when $a/\\delta_{\\mathrm{CQ}} \\gg 1$, a zero-dimensional model with time-dependent $L(t)$ and $R(t)$ can fully capture skin-effect-driven current redistribution and reconnection by using volume-averaged parameters, so a multi-dimensional resistive MHD treatment is not necessary.\n\nSelect all that apply and justify your choice by deriving the $a/\\delta_{\\mathrm{CQ}}$ criterion from the governing equations and evaluating the numerical example in option D from first principles. Clearly explain how spatial diffusion and reconnection mechanisms violate the assumptions of the $L\\!-\\!R$ model and why the proposed criterion reflects that breakdown.",
            "solution": "The validity of the problem statement must first be assessed.\n\n### Step 1: Extract Givens\n- A tokamak-like cylindrical plasma column of minor radius $a$.\n- Model 1: Zero-dimensional inductive-resistive ($L\\!-\\!R$) circuit, $V_{\\mathrm{loop}} = L\\, dI/dt + R\\, I$.\n- Model 2: Resistive magnetohydrodynamics (MHD), evolving poloidal flux $\\psi(r,t)$ and current density $J_{\\phi}(r,t)$.\n- Ohm's law: $E_{\\parallel} = \\eta_{\\mathrm{eff}} J_{\\parallel}$, with effective resistivity $\\eta_{\\mathrm{eff}}$. Flows are ignored.\n- Poloidal flux diffusion equation in a large-aspect-ratio cylinder:\n$$ \\frac{\\partial \\psi}{\\partial t} = \\frac{\\eta_{\\mathrm{eff}}}{\\mu_0}\\,\\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\psi}{\\partial r}\\right)\\right) $$\n- Characteristic resistive diffusion time: $\\tau_R \\sim \\mu_0 a^2/\\eta_{\\mathrm{eff}}$.\n- Current quench characteristic decay time: $\\tau_{\\mathrm{CQ}}$.\n- Definition of skin depth for the quench timescale:\n$$ \\delta_{\\mathrm{CQ}} \\equiv \\sqrt{\\frac{\\eta_{\\mathrm{eff}}\\,\\tau_{\\mathrm{CQ}}}{\\mu_0}} $$\n- Mention of reconnection processes accelerating current redistribution.\n- The task is to determine the conditions under which the $L\\!-\\!R$ model fails, propose a criterion based on the ratio $a/\\delta_{\\mathrm{CQ}}$, and evaluate the given statements.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in computational fusion science. The comparison between a $0$D $L\\!-\\!R$ model and a $1$D resistive MHD model is a standard paradigm for understanding current profile dynamics in tokamaks. The flux diffusion equation, the definitions of resistive time, and skin depth are all standard in plasma physics and MHD.\n- **Well-Posed**: The problem is well-posed. It asks for the derivation of a physical criterion based on a comparison of model assumptions, which is a standard physics problem with a clear, unique conceptual answer.\n- **Objective**: The language is precise, technical, and free of subjective or ambiguous terminology.\n- **Conclusion**: The problem statement is free of scientific flaws, inconsistencies, or ambiguities. It is a valid problem in plasma physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be derived.\n\n### Derivation of the Criterion\n\nThe core of the problem is to establish the domain of validity for the $0$D $L\\!-\\!R$ circuit model, $V_{\\mathrm{loop}} = L\\, dI/dt + R\\, I$. This model describes the evolution of global quantities: the total plasma current $I(t)$, the total loop voltage $V_{\\mathrm{loop}}(t)$, a constant total inductance $L$, and a constant total resistance $R$. The use of single, constant scalar values for $L$ and $R$ implicitly assumes that the spatial distribution of the current density, $J(r,t)$, either remains constant in shape or is uniform across the plasma cross-section.\n\nIn contrast, the resistive MHD model describes the spatio-temporal evolution of the fields. The provided parabolic partial differential equation for the poloidal flux $\\psi$,\n$$ \\frac{\\partial \\psi}{\\partial t} = D_{\\eta} \\nabla^2 \\psi $$\n(where $D_{\\eta} = \\eta_{\\mathrm{eff}}/\\mu_0$ is the magnetic diffusivity and $\\nabla^2$ is the cylindrical Laplacian operator acting on $\\psi$), is a diffusion equation. This equation governs how changes in the magnetic field and current profile diffuse through the resistive plasma.\n\nThe fundamental question is: on what timescale does the current profile evolve? A current quench is characterized by a global decay time $\\tau_{\\mathrm{CQ}}$. Any change in boundary conditions (e.g., a drop in edge voltage) will propagate into the plasma via diffusion. The characteristic time for this diffusion to cross the entire plasma minor radius $a$ is the resistive time, $\\tau_R \\sim a^2/D_{\\eta} = \\mu_0 a^2/\\eta_{\\mathrm{eff}}$. The characteristic distance a diffusive perturbation penetrates in a time $\\tau_{\\mathrm{CQ}}$ is the skin depth, $\\delta_{\\mathrm{CQ}}$. We can derive this from dimensional analysis of the diffusion equation: $[\\partial/\\partial t] \\sim 1/\\tau_{\\mathrm{CQ}}$ and $[\\nabla^2] \\sim 1/\\delta_{\\mathrm{CQ}}^2$. This gives $1/\\tau_{\\mathrm{CQ}} \\sim D_{\\eta}/\\delta_{\\mathrm{CQ}}^2$, leading to $\\delta_{\\mathrm{CQ}}^2 \\sim D_{\\eta} \\tau_{\\mathrm{CQ}} = \\eta_{\\mathrm{eff}}\\tau_{\\mathrm{CQ}}/\\mu_0$, which matches the given definition.\n\nThe $L\\!-\\!R$ model is valid if the plasma responds globally and homogeneously to the quench. This requires that information about the perturbation has time to diffuse across the entire plasma column within the quench timescale. In other words, the penetration depth $\\delta_{\\mathrm{CQ}}$ must be large compared to the system size $a$.\n- **Validity Condition:** $\\delta_{\\mathrm{CQ}} \\gtrsim a$. This means the plasma is \"transparent\" to the diffusive process on the timescale of the quench. The current profile can adjust globally, maintaining a broad shape, which is consistent with the assumptions of a $0$D model. This condition is equivalent to $a/\\delta_{\\mathrm{CQ}} \\lesssim 1$.\n\nThe $L\\!-\\!R$ model fails when spatial effects become dominant. This occurs when the quench is so rapid that the current profile does not have time to equilibrate across the radius.\n- **Breakdown Condition:** $\\delta_{\\mathrm{CQ}} \\ll a$. In this limit, the current change is confined to a thin \"skin\" layer of thickness $\\delta_{\\mathrm{CQ}}$ at the plasma edge. The core of the plasma is shielded from the rapid changes. This leads to a highly non-uniform current profile with large gradients. These large gradients can trigger MHD instabilities like tearing modes, which cause magnetic reconnection and further accelerate the current redistribution in a complex, multi-dimensional way. The simple $L\\!-\\!R$ model, and even the simple $1$D diffusion model, cannot capture this. The breakdown regime begins when $\\delta_{\\mathrm{CQ}}$ becomes comparable to or smaller than $a$, i.e., $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$.\n\nThis criterion can be expressed using the ratio of timescales, defined as $C \\equiv (a/\\delta_{\\mathrm{CQ}})^2$.\n$$ C = \\frac{a^2}{\\delta_{\\mathrm{CQ}}^2} = \\frac{a^2}{(\\eta_{\\mathrm{eff}}\\tau_{\\mathrm{CQ}}/\\mu_0)} = \\frac{\\mu_0 a^2}{\\eta_{\\mathrm{eff}}} \\frac{1}{\\tau_{\\mathrm{CQ}}} = \\frac{\\tau_R}{\\tau_{\\mathrm{CQ}}} $$\nThe $L\\!-\\!R$ model is valid when $a/\\delta_{\\mathrm{CQ}} \\lesssim 1$, which is equivalent to $C \\lesssim 1$, or $\\tau_{\\mathrm{CQ}} \\gtrsim \\tau_R$. This means the quench is slow compared to the resistive diffusion time.\nThe model breaks down when $a/\\delta_{\\mathrm{CQ}} \\gtrsim 1$, which is equivalent to $C \\gtrsim 1$, or $\\tau_{\\mathrm{CQ}} \\lesssim \\tau_R$. This means the quench is fast compared to the resistive diffusion time.\n\n### Evaluation of Options\n\n**A. The $L\\!-\\!R$ model assumes spatially uniform electric field and current density across the minor radius and neglects profile diffusion and reconnection. It is therefore self-consistent only when $\\delta_{\\mathrm{CQ}} \\gtrsim a$, equivalently $a/\\delta_{\\mathrm{CQ}} \\ll 1$. When $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$, strong skin effects, steep current gradients, and possible reconnection events invalidate the $L\\!-\\!R$ assumptions, requiring resistive MHD.**\nThis statement accurately summarizes the physical basis of the $L\\!-\\!R$ model and its limitations. It correctly identifies that the model neglects spatial effects. It correctly states the validity condition as $\\delta_{\\mathrm{CQ}} \\gtrsim a$, with the asymptotic limit being $a/\\delta_{\\mathrm{CQ}} \\ll 1$. It also correctly identifies the breakdown condition $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$ and the associated physical phenomena (skin effect, gradients, reconnection) that necessitate a more sophisticated MHD model.\n**Verdict: Correct.**\n\n**B. Because the circuit $L\\!-\\!R$ time is $L/R$, the correct skin depth for a current quench is $\\delta_{\\mathrm{CQ}} = \\sqrt{2\\eta_{\\mathrm{eff}}/(\\mu_0 \\omega)}$ with $\\omega \\equiv R/L$, and the $L\\!-\\!R$ model is valid when $a/\\delta_{\\mathrm{CQ}} \\gg 1$ (the skin effect confines current near the edge, so the interior behaves as an inductor).**\nThis statement contains multiple errors. First, the skin depth formula $\\delta = \\sqrt{2\\eta/(\\mu \\omega)}$ is for steady-state sinusoidal AC fields of frequency $\\omega$, not for a transient decay process characterized by a time constant $\\tau_{\\mathrm{CQ}}$. The appropriate definition for a diffusive transient is the one given in the problem, $\\delta_{\\mathrm{CQ}} = \\sqrt{\\eta_{\\mathrm{eff}}\\tau_{\\mathrm{CQ}}/\\mu_0}$. Second, and more critically, the condition for validity is stated as $a/\\delta_{\\mathrm{CQ}} \\gg 1$. This is the opposite of the correct condition. $a/\\delta_{\\mathrm{CQ}} \\gg 1$ signifies a very strong skin effect, where the $0$D model is guaranteed to fail. The reasoning provided is also flawed; if current is confined to the edge, the system's behavior is fundamentally different from that of a simple inductor with fixed $L$.\n**Verdict: Incorrect.**\n\n**C. An equivalent non-dimensional criterion is $C \\equiv (a/\\delta_{\\mathrm{CQ}})^2 = \\tau_R/\\tau_{\\mathrm{CQ}}$. The $L\\!-\\!R$ model is asymptotically valid for $C \\ll 1$ (slow global changes relative to resistive diffusion), and breaks down for $C \\gtrsim \\mathcal{O}(1)$; in the latter regime, spatial diffusion and reconnection can dominate profile evolution on the quench timescale.**\nThis statement correctly derives the relationship between the parameter $C$, the ratio $a/\\delta_{\\mathrm{CQ}}$, and the ratio of timescales $\\tau_R/\\tau_{\\mathrm{CQ}}$. As shown in our derivation, $C = (a/\\delta_{\\mathrm{CQ}})^2 = \\tau_R/\\tau_{\\mathrm{CQ}}$. The condition for the validity of the $L\\!-\\!R$ model, $a/\\delta_{\\mathrm{CQ}} \\lesssim 1$, is equivalent to $C \\lesssim 1$. The asymptotic validity for $C \\ll 1$ ($\\tau_{\\mathrm{CQ}} \\gg \\tau_R$) and the breakdown for $C \\gtrsim 1$ ($\\tau_{\\mathrm{CQ}} \\lesssim \\tau_R$) are correctly stated and physically interpreted.\n**Verdict: Correct.**\n\n**D. For $a = 0.6\\,\\mathrm{m}$, $\\eta_{\\mathrm{eff}} = 4\\times 10^{-5}\\,\\Omega\\!\\cdot\\!\\mathrm{m}$, and $\\tau_{\\mathrm{CQ}} = 2\\,\\mathrm{ms}$, one finds $a/\\delta_{\\mathrm{CQ}} \\approx 0.42$, so the $L\\!-\\!R$ model remains acceptable during the quench.**\nWe must verify the calculation using first principles and the vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\nThe given values are $a = 0.6\\,\\mathrm{m}$, $\\eta_{\\mathrm{eff}} = 4\\times 10^{-5}\\,\\Omega \\cdot \\mathrm{m}$, and $\\tau_{\\mathrm{CQ}} = 2 \\times 10^{-3}\\,\\mathrm{s}$.\nFirst, calculate the square of the skin depth:\n$$ \\delta_{\\mathrm{CQ}}^2 = \\frac{\\eta_{\\mathrm{eff}}\\,\\tau_{\\mathrm{CQ}}}{\\mu_0} = \\frac{(4 \\times 10^{-5}\\,\\Omega \\cdot \\mathrm{m})(2 \\times 10^{-3}\\,\\mathrm{s})}{4\\pi \\times 10^{-7}\\,\\mathrm{H/m}} = \\frac{8 \\times 10^{-8}}{4\\pi \\times 10^{-7}}\\,\\mathrm{m}^2 = \\frac{2}{10\\pi}\\,\\mathrm{m}^2 = \\frac{1}{5\\pi}\\,\\mathrm{m}^2 $$\n$$ \\delta_{\\mathrm{CQ}}^2 \\approx \\frac{1}{5 \\times 3.14159} \\approx 0.06366\\,\\mathrm{m}^2 $$\nThe skin depth is:\n$$ \\delta_{\\mathrm{CQ}} = \\sqrt{\\frac{1}{5\\pi}}\\,\\mathrm{m} \\approx 0.2523\\,\\mathrm{m} $$\nNow, we calculate the required ratio:\n$$ \\frac{a}{\\delta_{\\mathrm{CQ}}} = \\frac{0.6\\,\\mathrm{m}}{0.2523\\,\\mathrm{m}} \\approx 2.378 $$\nThe calculated value is $a/\\delta_{\\mathrm{CQ}} \\approx 2.38$, which is significantly different from the value of $0.42$ given in the option. It appears the option has calculated the reciprocal, $\\delta_{\\mathrm{CQ}}/a \\approx 0.2523 / 0.6 \\approx 0.4205$. Since the correct ratio is $a/\\delta_{\\mathrm{CQ}} \\approx 2.38 \\gtrsim \\mathcal{O}(1)$, the condition for the $L\\!-\\!R$ model to be valid ($a/\\delta_{\\mathrm{CQ}} \\lesssim 1$) is not met. Thus, the conclusion that the model \"remains acceptable\" is also incorrect based on these parameters.\n**Verdict: Incorrect.**\n\n**E. Even when $a/\\delta_{\\mathrm{CQ}} \\gg 1$, a zero-dimensional model with time-dependent $L(t)$ and $R(t)$ can fully capture skin-effect-driven current redistribution and reconnection by using volume-averaged parameters, so a multi-dimensional resistive MHD treatment is not necessary.**\nThis statement is fundamentally false. The regime $a/\\delta_{\\mathrm{CQ}} \\gg 1$ is where spatial effects are maximally important. While one can define time-dependent global parameters $L(t)$ and $R(t)$ by integrating over a known, evolving current profile (obtained from an MHD simulation), a $0$D model cannot predictively compute those profiles. The $0$D model lacks the spatial degrees of freedom to describe phenomena like current redistribution. Furthermore, magnetic reconnection is an inherently topological and multi-dimensional process involving localized structures (current sheets) that cannot be described, let alone \"fully captured\", by volume-averaged scalar quantities. A multi-dimensional MHD treatment is precisely what is required in this regime.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{\\text{AC}}$$"
        },
        {
            "introduction": "Having established the need for sophisticated numerical simulations, we must ensure our computational tools are correct. This hands-on coding exercise introduces the Method of Manufactured Solutions (MMS), a rigorous and essential technique for verifying that a simulation code accurately solves its governing partial differential equations. You will apply this method to a coupled system representing magnetic flux diffusion and electron heat transport, two core physical processes in a current quench, thereby developing a fundamental skill for any computational scientist .",
            "id": "4010610",
            "problem": "You are asked to construct a method of manufactured solutions for a one-dimensional, radius-only, axisymmetric current quench module in resistive magnetohydrodynamics (MHD) and electron heat transport, and to produce a program that evaluates the manufactured source terms needed to verify code correctness, including the terms consistent with boundary conditions. Assume a nondimensionalized formulation in a unit-radius cylinder, so that all dependent variables and parameters are dimensionless and no physical units are used.\n\nStarting from first principles, use the following foundational statements drawn from electromagnetism and transport theory:\n\n- Faraday’s law: $\\nabla \\times \\mathbf{E} = - \\partial \\mathbf{B} / \\partial t$.\n- Ampère’s law (quasistatic, nondimensionalized): $\\mathbf{J} = \\nabla \\times \\mathbf{B}$.\n- Ohm’s law (nondimensionalized, zero flow): $\\mathbf{E} = \\eta \\mathbf{J}$.\n- Fourier’s law for heat conduction: $\\mathbf{q} = - \\chi \\nabla T_e$.\n- Energy balance for electrons (nondimensionalized): $C_e \\partial T_e / \\partial t + \\nabla \\cdot \\mathbf{q} = Q_{\\text{ohm}} - \\nu \\left( T_e - T_b \\right) + C_e S_T$, with $Q_{\\text{ohm}} = \\eta \\lVert \\mathbf{J} \\rVert^2$ and $C_e$ a constant volumetric heat capacity that has been scaled to $C_e = 1$ by nondimensionalization.\n\nConsider axisymmetry and a scalar poloidal flux-like potential $\\psi(r,t)$ depending only on radius $r \\in (0,1)$ and time $t \\ge 0$, with current density defined by\n$$\nJ(r,t) = - \\left[ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial \\psi}{\\partial r} \\right) \\right].\n$$\nAssume the magnetic diffusion equation takes the form\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\, \\eta(r,t) \\, \\frac{\\partial \\psi}{\\partial r} \\right) + S_{\\psi}(r,t),\n$$\nwith resistivity given by a Spitzer-like law $\\eta(r,t) = \\eta_0 \\, T_e(r,t)^{-3/2}$ and constant $\\eta_0 > 0$.\n\nConsider the electron temperature evolution\n$$\n\\frac{\\partial T_e}{\\partial t} = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\, \\chi \\, \\frac{\\partial T_e}{\\partial r} \\right) + \\eta(r,t) \\, \\left[J(r,t)\\right]^2 - \\nu \\left( T_e - T_b \\right) + S_T(r,t),\n$$\nwith constant thermal diffusivity $\\chi \\ge 0$, constant energy loss coefficient $\\nu \\ge 0$, and constant background temperature $T_b$.\n\nImpose regularity at the magnetic axis:\n$$\n\\left. \\frac{\\partial \\psi}{\\partial r} \\right|_{r=0} = 0, \\qquad \\left. \\frac{\\partial T_e}{\\partial r} \\right|_{r=0} = 0,\n$$\nand Robin-type boundary conditions at the edge $r=1$,\n$$\n\\alpha_{\\psi} \\, \\psi(1,t) + \\beta_{\\psi} \\, \\left. \\frac{\\partial \\psi}{\\partial r} \\right|_{r=1} = g_{\\psi}(t),\n$$\n$$\n- \\chi \\, \\left. \\frac{\\partial T_e}{\\partial r} \\right|_{r=1} = h \\, \\left( T_e(1,t) - T_w \\right),\n$$\nwith constants $\\alpha_{\\psi} \\ge 0$, $\\beta_{\\psi} \\ge 0$, $h \\ge 0$, and wall temperature $T_w$.\n\nManufacture smooth, analytic fields\n$$\n\\psi(r,t) = c_0 + c_1 \\, r^2 \\cos(\\omega t) + c_2 \\, r^4 \\sin(\\omega t),\n$$\n$$\nT_e(r,t) = T_b + d_1 \\, \\cos\\!\\left(\\frac{\\pi r}{2}\\right) e^{-\\sigma t} + d_2 \\, r^2 \\, t,\n$$\nwith constants $c_0, c_1, c_2, \\omega, T_b, d_1, d_2, \\sigma$ chosen so that $T_e(r,t) > 0$ for the parameter sets below. For these manufactured fields, derive the source terms $S_{\\psi}(r,t)$ and $S_T(r,t)$ that make the above partial differential equations hold identically in $r \\in (0,1)$, $t \\ge 0$. Also derive the boundary data functions $g_{\\psi}(t)$ and the boundary residual $q_T(t)$ defined by\n$$\ng_{\\psi}(t) = \\alpha_{\\psi} \\, \\psi(1,t) + \\beta_{\\psi} \\, \\left. \\frac{\\partial \\psi}{\\partial r} \\right|_{r=1},\n$$\n$$\nq_T(t) = - \\chi \\, \\left. \\frac{\\partial T_e}{\\partial r} \\right|_{r=1} - h \\, \\left( T_e(1,t) - T_w \\right),\n$$\nwhich must be zero in a correct implementation of the boundary conditions when the manufactured solution is imposed.\n\nYour program must evaluate $S_{\\psi}(r,t)$, $S_T(r,t)$, $g_{\\psi}(t)$, and $q_T(t)$ for the following three test parameter sets and points. All quantities are nondimensional. For each case, evaluate at the specified point $(r,t)$:\n\n- Case A (interior, mixed dynamics):\n  - Parameters: $\\eta_0 = 0.1$, $\\chi = 0.2$, $\\nu = 0.05$, $\\alpha_{\\psi} = 0.3$, $\\beta_{\\psi} = 1.0$, $h = 0.4$, $T_w = 0.9$.\n  - Manufactured constants: $c_0 = 0.2$, $c_1 = 0.1$, $c_2 = 0.05$, $\\omega = 1.2$, $T_b = 1.0$, $d_1 = 0.3$, $\\sigma = 0.7$, $d_2 = 0.2$.\n  - Evaluation point: $(r,t) = (0.6, 0.75)$.\n\n- Case B (edge, strong conduction, Neumann-like magnetic boundary):\n  - Parameters: $\\eta_0 = 0.05$, $\\chi = 1.0$, $\\nu = 0.2$, $\\alpha_{\\psi} = 0.0$, $\\beta_{\\psi} = 1.0$, $h = 1.5$, $T_w = 0.7$.\n  - Manufactured constants: $c_0 = 0.0$, $c_1 = -0.2$, $c_2 = 0.1$, $\\omega = 0.5$, $T_b = 0.8$, $d_1 = 0.1$, $\\sigma = 0.3$, $d_2 = 0.0$.\n  - Evaluation point: $(r,t) = (1.0, 0.5)$.\n\n- Case C (near-axis, adiabatic wall, Dirichlet magnetic boundary):\n  - Parameters: $\\eta_0 = 0.2$, $\\chi = 0.05$, $\\nu = 0.0$, $\\alpha_{\\psi} = 1.0$, $\\beta_{\\psi} = 0.0$, $h = 0.0$, $T_w = 1.2$.\n  - Manufactured constants: $c_0 = 1.0$, $c_1 = 0.0$, $c_2 = 0.2$, $\\omega = 2.0$, $T_b = 1.5$, $d_1 = -0.2$, $\\sigma = 1.0$, $d_2 = 0.1$.\n  - Evaluation point: $(r,t) = (0.001, 0.1)$.\n\nYour task is to:\n\n- Derive expressions for $S_{\\psi}(r,t)$ and $S_T(r,t)$ using the above definitions and manufactured fields, starting only from the listed fundamental statements and definitions.\n- Derive expressions for $g_{\\psi}(t)$ and $q_T(t)$ as functions consistent with the manufactured fields at $r=1$.\n- Implement a program that computes, for each case, the quadruple $\\left[S_{\\psi}(r,t), S_T(r,t), g_{\\psi}(t), q_T(t)\\right]$ at the specified $(r,t)$.\n- The final output format must be a single line containing a comma-separated list of all results in order of the cases, flattened as $\\left[ S_{\\psi}^{A}, S_T^{A}, g_{\\psi}^{A}, q_T^{A}, S_{\\psi}^{B}, S_T^{B}, g_{\\psi}^{B}, q_T^{B}, S_{\\psi}^{C}, S_T^{C}, g_{\\psi}^{C}, q_T^{C} \\right]$, enclosed in square brackets, for example, $\\left[0.1,0.2,0.3,0.4, \\ldots \\right]$.\n\nAll computations are nondimensional; do not attach any physical units to the output numbers. Your program must not require any input and must hard-code the test suite above. The output must exactly match the specified single-line bracketed format.",
            "solution": "The user has provided a problem requiring the application of the Method of Manufactured Solutions (MMS) to a system of coupled partial differential equations (PDEs) describing resistive magnetohydrodynamics (MHD) and electron heat transport in a one-dimensional cylindrical geometry. The task is to derive and compute the necessary source and boundary terms that make a set of prescribed analytic functions exact solutions to the governing equations.\n\nThe problem is determined to be **valid** as it is scientifically grounded in established plasma physics models, mathematically well-posed, and all necessary information is provided. The use of MMS is a standard technique for the verification of numerical simulation codes. The derivation and computation are a straightforward, albeit detail-oriented, application of calculus.\n\nThe governing equations for the poloidal flux-like potential $\\psi(r,t)$ and the electron temperature $T_e(r,t)$ are given:\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\, \\eta(r,t) \\, \\frac{\\partial \\psi}{\\partial r} \\right) + S_{\\psi}(r,t) \\quad (\\text{Eq. } 1)\n$$\n$$\n\\frac{\\partial T_e}{\\partial t} = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\, \\chi \\, \\frac{\\partial T_e}{\\partial r} \\right) + \\eta(r,t) \\, \\left[J(r,t)\\right]^2 - \\nu \\left( T_e - T_b \\right) + S_T(r,t) \\quad (\\text{Eq. } 2)\n$$\nThe source terms $S_\\psi(r,t)$ and $S_T(r,t)$ are the quantities we must find. By rearranging the equations, we can express the sources in terms of the manufactured fields and their derivatives:\n$$\nS_{\\psi}(r,t) = \\frac{\\partial \\psi}{\\partial t} - \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\, \\eta(r,t) \\, \\frac{\\partial \\psi}{\\partial r} \\right) \\quad (\\text{Eq. } 3)\n$$\n$$\nS_T(r,t) = \\frac{\\partial T_e}{\\partial t} - \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\, \\chi \\, \\frac{\\partial T_e}{\\partial r} \\right) - \\eta(r,t) \\, \\left[J(r,t)\\right]^2 + \\nu \\left( T_e(r,t) - T_b \\right) \\quad (\\text{Eq. } 4)\n$$\nThe problem also defines the auxiliary quantities:\n$$\n\\eta(r,t) = \\eta_0 \\, T_e(r,t)^{-3/2} \\quad (\\text{Eq. } 5)\n$$\n$$\nJ(r,t) = - \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial \\psi}{\\partial r} \\right) \\quad (\\text{Eq. } 6)\n$$\nThe manufactured solutions are given as:\n$$\n\\psi(r,t) = c_0 + c_1 \\, r^2 \\cos(\\omega t) + c_2 \\, r^4 \\sin(\\omega t) \\quad (\\text{Eq. } 7)\n$$\n$$\nT_e(r,t) = T_b + d_1 \\, \\cos\\!\\left(\\frac{\\pi r}{2}\\right) e^{-\\sigma t} + d_2 \\, r^2 \\, t \\quad (\\text{Eq. } 8)\n$$\nWe proceed by calculating each term in the source equations.\n\n**Step 1: Calculate Derivatives of Manufactured Fields**\n\nFor $\\psi(r,t)$:\n$$\n\\frac{\\partial \\psi}{\\partial t} = -c_1 \\omega r^2 \\sin(\\omega t) + c_2 \\omega r^4 \\cos(\\omega t)\n$$\n$$\n\\frac{\\partial \\psi}{\\partial r} = 2 c_1 r \\cos(\\omega t) + 4 c_2 r^3 \\sin(\\omega t)\n$$\nFor $T_e(r,t)$:\n$$\n\\frac{\\partial T_e}{\\partial t} = -d_1 \\sigma \\cos\\left(\\frac{\\pi r}{2}\\right) e^{-\\sigma t} + d_2 r^2\n$$\n$$\n\\frac{\\partial T_e}{\\partial r} = -d_1 \\frac{\\pi}{2} \\sin\\left(\\frac{\\pi r}{2}\\right) e^{-\\sigma t} + 2 d_2 r t\n$$\n\n**Step 2: Calculate Auxiliary Terms $J$, $\\eta$, and Diffusion Terms**\n\nFirst, we compute the current density $J(r,t)$ using its definition in Eq. 6:\n$$\nr \\frac{\\partial \\psi}{\\partial r} = 2 c_1 r^2 \\cos(\\omega t) + 4 c_2 r^4 \\sin(\\omega t)\n$$\n$$\n\\frac{\\partial}{\\partial r}\\left( r \\frac{\\partial \\psi}{\\partial r} \\right) = 4 c_1 r \\cos(\\omega t) + 16 c_2 r^3 \\sin(\\omega t)\n$$\n$$\nJ(r,t) = - \\frac{1}{r} \\left( 4 c_1 r \\cos(\\omega t) + 16 c_2 r^3 \\sin(\\omega t) \\right) = - \\left( 4 c_1 \\cos(\\omega t) + 16 c_2 r^2 \\sin(\\omega t) \\right)\n$$\nThe resistivity $\\eta(r,t)$ is directly computed from $T_e(r,t)$ using Eq. 5.\n\nThe diffusion term for $\\psi$ in Eq. 3 is $\\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\eta \\frac{\\partial \\psi}{\\partial r} \\right)$. Using the product rule:\n$$\n\\frac{1}{r} \\left[ \\left(\\frac{\\partial \\eta}{\\partial r}\\right) \\left(r \\frac{\\partial \\psi}{\\partial r}\\right) + \\eta \\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial \\psi}{\\partial r}\\right) \\right] = \\frac{\\partial \\eta}{\\partial r} \\frac{\\partial \\psi}{\\partial r} + \\eta \\frac{1}{r} \\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial \\psi}{\\partial r}\\right) = \\frac{\\partial \\eta}{\\partial r} \\frac{\\partial \\psi}{\\partial r} - \\eta J\n$$\nwhere $\\frac{\\partial \\eta}{\\partial r} = -\\frac{3}{2} \\eta_0 T_e^{-5/2} \\frac{\\partial T_e}{\\partial r}$.\n\nThe diffusion term for $T_e$ in Eq. 4 is $\\frac{\\chi}{r} \\frac{\\partial}{\\partial r} \\left(r \\frac{\\partial T_e}{\\partial r}\\right)$, which is $\\chi \\nabla^2 T_e$ for a function of $r$ only.\n$$\n\\nabla^2 T_e = \\frac{\\partial^2 T_e}{\\partial r^2} + \\frac{1}{r}\\frac{\\partial T_e}{\\partial r}\n$$\n$$\n\\frac{\\partial^2 T_e}{\\partial r^2} = -d_1 \\left(\\frac{\\pi}{2}\\right)^2 \\cos\\left(\\frac{\\pi r}{2}\\right) e^{-\\sigma t} + 2 d_2 t\n$$\n$$\n\\nabla^2 T_e = \\left( -d_1 \\left(\\frac{\\pi}{2}\\right)^2 \\cos\\left(\\frac{\\pi r}{2}\\right) - d_1 \\frac{\\pi}{2r} \\sin\\left(\\frac{\\pi r}{2}\\right) \\right) e^{-\\sigma t} + 4 d_2 t\n$$\nThe term $\\frac{\\sin(\\pi r/2)}{r}$ is handled carefully for $r \\to 0$ to avoid division by zero, e.g., using a Taylor series or a sinc function.\n\n**Step 3: Assemble the Source Terms $S_\\psi$ and $S_T$**\nBy substituting the derived expressions into Eq. 3 and Eq. 4, we obtain the final expressions for the source terms.\n$$\nS_{\\psi}(r,t) = \\left( -c_1 \\omega r^2 \\sin(\\omega t) + c_2 \\omega r^4 \\cos(\\omega t) \\right) - \\left( \\frac{\\partial \\eta}{\\partial r} \\frac{\\partial \\psi}{\\partial r} - \\eta(r,t) J(r,t) \\right)\n$$\n$$\nS_T(r,t) = \\left( -d_1 \\sigma \\cos\\left(\\frac{\\pi r}{2}\\right) e^{-\\sigma t} + d_2 r^2 \\right) - \\chi \\nabla^2 T_e - \\eta(r,t) J(r,t)^2 + \\nu \\left( d_1 \\cos\\left(\\frac{\\pi r}{2}\\right) e^{-\\sigma t} + d_2 r^2 t \\right)\n$$\n\n**Step 4: Derive Boundary Terms $g_\\psi(t)$ and $q_T(t)$**\nThe boundary terms are evaluated at $r=1$.\n\nThe function $g_{\\psi}(t)$ is defined to satisfy the Robin boundary condition for $\\psi$:\n$$\ng_{\\psi}(t) = \\alpha_{\\psi} \\, \\psi(1,t) + \\beta_{\\psi} \\, \\left. \\frac{\\partial \\psi}{\\partial r} \\right|_{r=1}\n$$\n$$\n\\psi(1,t) = c_0 + c_1 \\cos(\\omega t) + c_2 \\sin(\\omega t)\n$$\n$$\n\\left. \\frac{\\partial \\psi}{\\partial r} \\right|_{r=1} = 2 c_1 \\cos(\\omega t) + 4 c_2 \\sin(\\omega t)\n$$\n$$\ng_{\\psi}(t) = \\alpha_{\\psi} \\left(c_0 + c_1 \\cos(\\omega t) + c_2 \\sin(\\omega t)\\right) + \\beta_{\\psi} \\left(2 c_1 \\cos(\\omega t) + 4 c_2 \\sin(\\omega t)\\right)\n$$\n$$\ng_{\\psi}(t) = \\alpha_{\\psi} c_0 + c_1(\\alpha_{\\psi} + 2\\beta_{\\psi})\\cos(\\omega t) + c_2(\\alpha_{\\psi} + 4\\beta_{\\psi})\\sin(\\omega t)\n$$\n\nThe boundary residual $q_T(t)$ is defined as the mismatch in the $T_e$ boundary condition when the manufactured solution is imposed.\n$$\nq_T(t) = - \\chi \\, \\left. \\frac{\\partial T_e}{\\partial r} \\right|_{r=1} - h \\, \\left( T_e(1,t) - T_w \\right)\n$$\nAt $r=1$, we use $\\cos(\\pi/2)=0$ and $\\sin(\\pi/2)=1$:\n$$\nT_e(1,t) = T_b + d_2 t\n$$\n$$\n\\left. \\frac{\\partial T_e}{\\partial r} \\right|_{r=1} = -d_1 \\frac{\\pi}{2} e^{-\\sigma t} + 2 d_2 t\n$$\n$$\nq_T(t) = - \\chi \\left( -d_1 \\frac{\\pi}{2} e^{-\\sigma t} + 2 d_2 t \\right) - h \\left( (T_b + d_2 t) - T_w \\right)\n$$\n$$\nq_T(t) = \\chi d_1 \\frac{\\pi}{2} e^{-\\sigma t} - (2\\chi+h)d_2 t - h(T_b-T_w)\n$$\nThese final expressions are implemented in the provided Python code to compute the required values for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes manufactured source and boundary terms for a 1D MHD current quench problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"params\": {\"eta0\": 0.1, \"chi\": 0.2, \"nu\": 0.05, \"alpha_psi\": 0.3, \"beta_psi\": 1.0, \"h\": 0.4, \"Tw\": 0.9},\n            \"mms\": {\"c0\": 0.2, \"c1\": 0.1, \"c2\": 0.05, \"w\": 1.2, \"Tb\": 1.0, \"d1\": 0.3, \"sig\": 0.7, \"d2\": 0.2},\n            \"eval_point\": {\"r\": 0.6, \"t\": 0.75}\n        },\n        {\n            \"params\": {\"eta0\": 0.05, \"chi\": 1.0, \"nu\": 0.2, \"alpha_psi\": 0.0, \"beta_psi\": 1.0, \"h\": 1.5, \"Tw\": 0.7},\n            \"mms\": {\"c0\": 0.0, \"c1\": -0.2, \"c2\": 0.1, \"w\": 0.5, \"Tb\": 0.8, \"d1\": 0.1, \"sig\": 0.3, \"d2\": 0.0},\n            \"eval_point\": {\"r\": 1.0, \"t\": 0.5}\n        },\n        {\n            \"params\": {\"eta0\": 0.2, \"chi\": 0.05, \"nu\": 0.0, \"alpha_psi\": 1.0, \"beta_psi\": 0.0, \"h\": 0.0, \"Tw\": 1.2},\n            \"mms\": {\"c0\": 1.0, \"c1\": 0.0, \"c2\": 0.2, \"w\": 2.0, \"Tb\": 1.5, \"d1\": -0.2, \"sig\": 1.0, \"d2\": 0.1},\n            \"eval_point\": {\"r\": 0.001, \"t\": 0.1}\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Unpack parameters for readability\n        p = case[\"params\"]\n        eta0, chi, nu, alpha_psi, beta_psi, h, Tw = p[\"eta0\"], p[\"chi\"], p[\"nu\"], p[\"alpha_psi\"], p[\"beta_psi\"], p[\"h\"], p[\"Tw\"]\n        \n        m = case[\"mms\"]\n        c0, c1, c2, w, Tb, d1, sig, d2 = m[\"c0\"], m[\"c1\"], m[\"c2\"], m[\"w\"], m[\"Tb\"], m[\"d1\"], m[\"sig\"], m[\"d2\"]\n        \n        e = case[\"eval_point\"]\n        r, t = e[\"r\"], e[\"t\"]\n\n        # Pre-calculate common trigonometric, exponential, and constant terms\n        pi = np.pi\n        wt = w * t\n        ct = np.cos(wt)\n        st = np.sin(wt)\n        exprt = np.exp(-sig * t)\n        \n        # Terms dependent on r\n        r2 = r * r\n        r3 = r2 * r\n        r4 = r2 * r2\n        pir_2 = pi * r / 2.0\n        cpr2 = np.cos(pir_2)\n        spr2 = np.sin(pir_2)\n\n        # Calculate Te and its derivatives\n        Te = Tb + d1 * cpr2 * exprt + d2 * r2 * t\n        dte_dt = -d1 * sig * cpr2 * exprt + d2 * r2\n        dte_dr = -d1 * (pi / 2.0) * spr2 * exprt + 2.0 * d2 * r * t\n\n        # Laplacian of Te: nabla2_Te = d2Te/dr2 + (1/r)*dTe/dr\n        # Use np.sinc(x) = sin(pi*x)/(pi*x) for the (sin(z)/z)-like term to handle r->0\n        # (1/r)*sin(pi*r/2) is written as (pi/2) * sinc(r/2.0)\n        # So the term from (1/r)*dTe/dr is -d1*(pi/2)*(1/r)*sin(pi*r/2)*exprt = -d1*(pi/2)^2*sinc(r/2.0)*exprt\n        d2te_dr2 = -d1 * (pi/2.0)**2 * cpr2 * exprt + 2.0 * d2 * t\n        if r == 0:\n            nabla2_Te = 2 * d2te_dr2  # Using L'Hopital's rule for (1/r)dTe/dr as r->0\n            nabla2_Te = d1 * (-(pi / 2.0)**2) * exprt * 2 + 4.0 * d2 * t # simplified\n        else:\n            nabla2_Te = d2te_dr2 + (1.0/r) * dte_dr\n        \n        # Calculate psi derivatives\n        dpsi_dt = -c1 * w * r2 * st + c2 * w * r4 * ct\n        dpsi_dr = 2.0 * c1 * r * ct + 4.0 * c2 * r3 * st\n\n        # Calculate auxiliary fields eta and J\n        if Te <= 0: # Ensure physical validity\n            raise ValueError(f\"T_e must be positive, but got {Te} at (r,t)=({r},{t})\")\n        eta = eta0 * Te**(-1.5)\n        deta_dr = -1.5 * eta0 * Te**(-2.5) * dte_dr\n        J = -(4.0 * c1 * ct + 16.0 * c2 * r2 * st)\n\n        # Calculate S_psi = dpsi_dt - Div(eta * Grad(psi))\n        # Div(eta*Grad(psi)) = deta_dr * dpsi_dr - eta * J\n        term_psi_div = deta_dr * dpsi_dr - eta * J\n        S_psi = dpsi_dt - term_psi_div\n\n        # Calculate S_T = dTe_dt - chi*nabla2_Te - eta*J^2 + nu*(Te - Tb)\n        Te_minus_Tb = d1 * cpr2 * exprt + d2 * r2 * t\n        S_T = dte_dt - chi * nabla2_Te - eta * J**2 + nu * Te_minus_Tb\n        \n        # Calculate g_psi(t) at r=1\n        psi_r1 = c0 + c1 * ct + c2 * st\n        dpsi_dr_r1 = 2.0 * c1 * ct + 4.0 * c2 * st\n        g_psi = alpha_psi * psi_r1 + beta_psi * dpsi_dr_r1\n\n        # Calculate q_T(t) at r=1\n        # At r=1, cos(pi/2)=0, sin(pi/2)=1\n        Te_r1 = Tb + d2 * t\n        dte_dr_r1 = -d1 * (pi / 2.0) * exprt + 2.0 * d2 * t\n        q_T = -chi * dte_dr_r1 - h * (Te_r1 - Tw)\n\n        all_results.extend([S_psi, S_T, g_psi, q_T])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}