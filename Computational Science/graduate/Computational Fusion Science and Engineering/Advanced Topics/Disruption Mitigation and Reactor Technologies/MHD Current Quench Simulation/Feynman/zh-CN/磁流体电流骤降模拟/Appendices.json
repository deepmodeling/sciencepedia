{
    "hands_on_practices": [
        {
            "introduction": "在模拟复杂的物理现象时，一个有效的起点是建立一个简化的“零维”模型，以捕捉其核心动力学。本练习将托卡马克中的电流淬灭过程简化为一个基本的 $L-R$ 电路。通过这种方式，我们可以解析地推导出电流的指数衰减和磁能向欧姆热的转化，为更复杂的模拟提供一个基础物理图像和定量基准 。",
            "id": "4010591",
            "problem": "在磁流体动力学（MHD）电流猝灭期间，一个大环径比托卡马克等离子体可以被建模为一个具有恒定自感 $L_p$ 和产生恒定有效等离子体电阻 $R_p$ 的均匀标量电阻率的单个轴对称电路。假设在猝灭期间没有施加变压器驱动，与周围结构的涡流耦合可以忽略不计，并且几何参数是恒定的，因此在所有时间 $t$ 内与等离子体耦合的极向磁通量为 $\\Phi_p(t)=L_p I_p(t)$。将环向回路电压 $V_\\mathrm{loop}(t)$ 定义为等离子体内部沿闭合环向轮廓的环向电场的线积分，因此电阻性磁流体动力学（MHD）闭合关系给出 $V_\\mathrm{loop}(t)=R_p I_p(t)$。利用麦克斯韦-法拉第定律、电感的定义以及这些模型假设，推导在电阻性衰减期间等离子体电流 $I_p(t)$ 的演化，并计算：\n- $V_\\mathrm{loop}(t)$ 的显式函数形式，单位为伏特，以及\n- 当等离子体电流从 $t=0$ 时的初始值 $I_0$ 衰减到 $I_p=1\\,\\mathrm{MA}$ 时，总欧姆耗散能量，以焦耳表示。\n\n使用参数值 $L_p=1.0\\,\\mathrm{H}$，$R_p=0.01\\,\\Omega$ 和 $I_0=5\\,\\mathrm{MA}$。除欧姆耗散外，不假设任何外部磁能源或汇。最终的欧姆能量应以 $\\mathrm{J}$ 报告，回路电压应以 $\\mathrm{V}$ 报告。除非推导需要，否则不必进行四舍五入；如果确实需要四舍五入，请使用有效数字。",
            "solution": "用户希望我解决以下问题：\n在磁流体动力学（MHD）电流猝灭期间，一个大环径比托卡马克等离子体可以被建模为一个具有恒定自感 $L_p$ 和产生恒定有效等离子体电阻 $R_p$ 的均匀标量电阻率的单个轴对称电路。假设在猝灭期间没有施加变压器驱动，与周围结构的涡流耦合可以忽略不计，并且几何参数是恒定的，因此在所有时间 $t$ 内与等离子体耦合的极向磁通量为 $\\Phi_p(t)=L_p I_p(t)$。将环向回路电压 $V_\\mathrm{loop}(t)$ 定义为等离子体内部沿闭合环向轮廓的环向电场的线积分，因此电阻性磁流体动力学（MHD）闭合关系给出 $V_\\mathrm{loop}(t)=R_p I_p(t)$。利用麦克斯韦-法拉第定律、电感的定义以及这些模型假设，推导在电阻性衰减期间等离子体电流 $I_p(t)$ 的演化，并计算：\n- $V_\\mathrm{loop}(t)$ 的显式函数形式，单位为伏特，以及\n- 当等离子体电流从 $t=0$ 时的初始值 $I_0$ 衰减到 $I_p=1\\,\\mathrm{MA}$ 时，总欧姆耗散能量，以焦耳表示。\n\n使用参数值 $L_p=1.0\\,\\mathrm{H}$，$R_p=0.01\\,\\Omega$ 和 $I_0=5\\,\\mathrm{MA}$。除欧姆耗散外，不假设任何外部磁能源或汇。最终的欧姆能量应以 $\\mathrm{J}$ 报告，回路电压应以 $\\mathrm{V}$ 报告。除非推导需要，否则不必进行四舍五入；如果确实需要四舍五入，请使用有效数字。\n\n### 第1步：提取已知条件\n-   模型：托卡马克等离子体的单个轴对称电路。\n-   等离子体自感：$L_p$，恒定。\n-   等离子体电阻：$R_p$，恒定。\n-   外部驱动：无（无外加变压器驱动）。\n-   涡流：可忽略。\n-   几何参数：恒定。\n-   极向磁通量：$\\Phi_p(t) = L_p I_p(t)$。\n-   环向回路电压（欧姆定律）：$V_\\mathrm{loop}(t) = R_p I_p(t)$。\n-   控制定律：麦克斯韦-法拉第定律。\n-   初始条件：$I_p(0) = I_0$。\n-   能量计算的最终条件：$I_p = 1\\,\\mathrm{MA}$。\n-   参数值：\n    -   $L_p = 1.0\\,\\mathrm{H}$\n    -   $R_p = 0.01\\,\\Omega$\n    -   $I_0 = 5\\,\\mathrm{MA} = 5 \\times 10^6\\,\\mathrm{A}$\n    -   最终电流：$I_f = 1\\,\\mathrm{MA} = 1 \\times 10^6\\,\\mathrm{A}$\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题使用简化的 RL 电路模型（$L_p$，$R_p$）来描述等离子体中电流的电阻性衰减。在等离子体物理和磁流体动力学中，对于没有外部驱动的电流猝灭情况，这是一种标准、有效的一阶近似。所引用的原理——麦克斯韦-法拉第定律、欧姆定律和电感的定义——是电磁学的基础。给定的参数值对于大型托卡马克是物理上合理的。\n2.  **良态问题**：该问题是求解一个具有给定初始条件的一阶线性常微分方程，这构成了一个良态的初值问题。它要求计算特定的、定义明确的物理量（$V_\\mathrm{loop}(t)$ 和耗散能量），这些量存在唯一解。\n3.  **客观性**：问题陈述使用了精确、客观和标准的科学术语。\n4.  **不完整或矛盾的设置**：问题是自洽且内部一致的。所有必要的参数和假设（恒定的 $L_p$ 和 $R_p$，无外部电压源）都已提供。法拉第定律 ($V_\\mathrm{loop} = -d\\Phi_p/dt$)、欧姆定律 ($V_\\mathrm{loop} = R_p I_p$) 和电感定义 ($\\Phi_p = L_p I_p$) 一致地结合起来，构成了控制微分方程。\n5.  **不切实际或不可行**：虽然恒定 $R_p$ 的假设是一个很强的简化（等离子体电阻率是温度的强函数，在猝灭期间温度会急剧变化），但对于这种性质的解析问题来说，这是一个常见且可接受的简化。它不会使问题在科学上无效，而是定义了要分析的理想化物理系统。\n\n### 第3步：结论与行动\n该问题在科学上是有效的，是良态的，并且提供了所有必要的信息。我将继续进行详细的求解。\n\n控制该电路的基本关系源于麦克斯韦-法拉第定律，该定律指出，在闭合回路中感应出的电动势（在此情况下为环向回路电压）等于穿过该回路的磁通量的负变化率。\n$$V_\\mathrm{loop}(t) = -\\frac{d\\Phi_p(t)}{dt}$$\n问题为等离子体提供了两个本构关系：\n1.  根据恒定自感 $L_p$ 和等离子体电流 $I_p(t)$ 定义的极向磁通量：\n    $$\\Phi_p(t) = L_p I_p(t)$$\n2.  电阻性 MHD 闭合关系（等离子体电路的欧姆定律）：\n    $$V_\\mathrm{loop}(t) = R_p I_p(t)$$\n将这些关系代入法拉第定律，得到等离子体电流的控制微分方程。\n$$R_p I_p(t) = -\\frac{d}{dt} [L_p I_p(t)]$$\n由于假设 $L_p$ 是恒定的，我们可以写出：\n$$R_p I_p(t) = -L_p \\frac{dI_p(t)}{dt}$$\n这是一个一阶、线性、齐次常微分方程，可以重新排列为：\n$$L_p \\frac{dI_p}{dt} + R_p I_p = 0$$\n为了求解 $I_p(t)$，我们使用分离变量法：\n$$\\frac{dI_p}{I_p} = -\\frac{R_p}{L_p} dt$$\n对两边进行积分，从初始时间 $t=0$ 时的电流 $I_p(0)=I_0$ 到任意时间 $t$ 时的电流 $I_p(t)$：\n$$\\int_{I_0}^{I_p(t)} \\frac{dI'_p}{I'_p} = -\\frac{R_p}{L_p} \\int_0^t dt'$$\n$$[\\ln|I'_p|]_{I_0}^{I_p(t)} = -\\frac{R_p}{L_p} [t']_0^t$$\n$$\\ln(I_p(t)) - \\ln(I_0) = -\\frac{R_p}{L_p} t$$\n$$\\ln\\left(\\frac{I_p(t)}{I_0}\\right) = -\\frac{R_p}{L_p} t$$\n对两边取指数，得到等离子体电流随时间变化的解：\n$$I_p(t) = I_0 \\exp\\left(-\\frac{R_p}{L_p} t\\right)$$\n这描述了等离子体电流的指数衰减，其特征电阻时间常数为 $\\tau_p = L_p/R_p$。\n\n首先，我们计算回路电压 $V_\\mathrm{loop}(t)$ 的显式函数形式。使用给定的欧姆定律关系 $V_\\mathrm{loop}(t) = R_p I_p(t)$，并代入推导出的 $I_p(t)$ 表达式：\n$$V_\\mathrm{loop}(t) = R_p I_0 \\exp\\left(-\\frac{R_p}{L_p} t\\right)$$\n现在我们代入给定的数值：\n$L_p = 1.0\\,\\mathrm{H}$\n$R_p = 0.01\\,\\Omega$\n$I_0 = 5\\,\\mathrm{MA} = 5 \\times 10^6\\,\\mathrm{A}$\n\n在 $t=0$ 时的初始回路电压为 $V_0 = R_p I_0$：\n$$V_0 = (0.01\\,\\Omega) \\times (5 \\times 10^6\\,\\mathrm{A}) = 50000\\,\\mathrm{V} = 5 \\times 10^4\\,\\mathrm{V}$$\n电阻时间常数 $\\tau_p$ 为：\n$$\\tau_p = \\frac{L_p}{R_p} = \\frac{1.0\\,\\mathrm{H}}{0.01\\,\\Omega} = 100\\,\\mathrm{s}$$\n因此，以伏特为单位的回路电压的显式函数形式为：\n$$V_\\mathrm{loop}(t) = (5 \\times 10^4) \\exp\\left(-\\frac{t}{100}\\right)$$\n\n接下来，我们计算当等离子体电流从初始值 $I_0 = 5\\,\\mathrm{MA}$ 衰减到最终值 $I_f = 1\\,\\mathrm{MA}$ 时，耗散的总欧姆能量 $W_{ohmic}$。\n等离子体中瞬时欧姆耗散功率由 $P(t) = V_\\mathrm{loop}(t) I_p(t) = R_p (I_p(t))^2$ 给出。总耗散能量是该功率的时间积分。\n$$W_{ohmic} = \\int_{t_i}^{t_f} P(t) dt$$\n然而，一个更直接的方法是利用能量守恒原理。由于没有外部电源，通过电阻以热量形式耗散的能量必须等于电感器中存储的磁能的减少量。存储在电感器中的磁能由 $W_M = \\frac{1}{2}L_p I_p^2$ 给出。\n在 $t=0$ 时，$I_p = I_0$ 时的初始存储磁能为：\n$$W_{M,i} = \\frac{1}{2} L_p I_0^2$$\n当 $I_p = I_f$ 时的最终存储磁能为：\n$$W_{M,f} = \\frac{1}{2} L_p I_f^2$$\n在此衰减过程中耗散的总欧姆能量是存储能量的变化量：\n$$W_{ohmic} = W_{M,i} - W_{M,f} = \\frac{1}{2} L_p I_0^2 - \\frac{1}{2} L_p I_f^2 = \\frac{1}{2} L_p (I_0^2 - I_f^2)$$\n我们现在代入数值：\n$L_p = 1.0\\,\\mathrm{H}$\n$I_0 = 5 \\times 10^6\\,\\mathrm{A}$\n$I_f = 1 \\times 10^6\\,\\mathrm{A}$\n$$W_{ohmic} = \\frac{1}{2} (1.0) \\left( (5 \\times 10^6)^2 - (1 \\times 10^6)^2 \\right)$$\n$$W_{ohmic} = \\frac{1}{2} \\left( 25 \\times 10^{12} - 1 \\times 10^{12} \\right)$$\n$$W_{ohmic} = \\frac{1}{2} \\left( 24 \\times 10^{12} \\right)$$\n$$W_{ohmic} = 12 \\times 10^{12}\\,\\mathrm{J}$$\n用标准科学记数法表示，这是 $1.2 \\times 10^{13}\\,\\mathrm{J}$。\n\n计算出的两个量是：\n1. 回路电压的函数形式：$V_\\mathrm{loop}(t) = (5 \\times 10^4) \\exp(-t/100)\\,\\mathrm{V}$。\n2. 总欧姆耗散能量：$1.2 \\times 10^{13}\\,\\mathrm{J}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} (5 \\times 10^4) \\exp\\left(-\\frac{t}{100}\\right)  1.2 \\times 10^{13} \\end{pmatrix} } $$"
        },
        {
            "introduction": "虽然零维模型为了解全局行为提供了便利，但它忽略了关键的空间效应，因此其有效性是有限的。本练习挑战我们批判性地思考 $L-R$ 模型的假设，并推导出一个区分其适用范围的定量判据 。通过引入磁扩散时间和趋肤深度的概念，我们将理解为何以及何时必须采用能描述电流剖面演化的多维磁流体动力学（MHD）模拟。",
            "id": "4010581",
            "problem": "在一个小半径为 $a$ 的类托卡马克圆柱形等离子体柱中，电流猝灭可以通过零维电感-电阻 ($L\\!-\\!R$) 电路（$V_{\\mathrm{loop}} = L\\, dI/dt + R\\, I$）或电阻磁流体动力学 (MHD) 进行建模。电阻磁流体动力学根据法拉第定律、安培定律和欧姆定律来演化极向磁通 $\\psi(r,t)$ 和电流密度 $J_{\\phi}(r,t)$。考虑使用标准电阻欧姆定律 $E_{\\parallel} = \\eta_{\\mathrm{eff}} J_{\\parallel}$ 的电阻 MHD，其中 $\\eta_{\\mathrm{eff}}$ 是一个有效电阻率，可能包含湍流引起的增强，并忽略流动。在大环径比圆柱体中，极向磁通满足以下形式的扩散方程：\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\frac{\\eta_{\\mathrm{eff}}}{\\mu_0}\\,\\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\psi}{\\partial r}\\right)\\right),\n$$\n这意味着对于全局剖面演化，存在一个特征电阻扩散时间 $\\tau_R \\sim \\mu_0 a^2/\\eta_{\\mathrm{eff}}$。在特征衰减时间为 $\\tau_{\\mathrm{CQ}}$ 的电流猝灭期间，感应电场和电流剖面可能会迅速变化。定义与猝灭时间尺度相关的趋肤深度为\n$$\n\\delta_{\\mathrm{CQ}} \\equiv \\sqrt{\\frac{\\eta_{\\mathrm{eff}}\\,\\tau_{\\mathrm{CQ}}}{\\mu_0}},\n$$\n其被解释为扩散性磁扰动在时间 $\\tau_{\\mathrm{CQ}}$ 内的径向穿透深度。当出现大梯度时，重联过程（例如，撕裂模引起的拓扑变化）可以进一步加速电流的重新分布。\n\n从第一性原理出发，讨论在何种情况下，$L\\!-\\!R$ 电路模型会因为空间电流剖面扩散和重联占主导地位而失效，并基于比值 $a/\\delta_{\\mathrm{CQ}}$ 提出了一个定量判据，用以区分零维 $L\\!-\\!R$ 描述可接受的区域和为需要多维电阻 MHD 的区域。然后，考虑以下陈述并选择所有正确的选项：\n\nA. $L\\!-\\!R$ 模型假设电场和电流密度在小半径上空间均匀，并忽略了剖面扩散和重联。因此，只有当 $\\delta_{\\mathrm{CQ}} \\gtrsim a$（等效于 $a/\\delta_{\\mathrm{CQ}} \\ll 1$）时，它才是自洽的。当 $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$ 时，强烈的趋肤效应、陡峭的电流梯度和可能的重联事件会使 $L\\!-\\!R$ 模型的假设失效，从而需要使用电阻磁流体动力学模型。\n\nB. 因为电路的 $L\\!-\\!R$ 时间是 $L/R$，所以电流猝灭的正确趋肤深度是 $\\delta_{\\mathrm{CQ}} = \\sqrt{2\\eta_{\\mathrm{eff}}/(\\mu_0 \\omega)}$，其中 $\\omega \\equiv R/L$，并且当 $a/\\delta_{\\mathrm{CQ}} \\gg 1$ 时 $L\\!-\\!R$ 模型有效（趋肤效应将电流限制在边缘附近，因此内部表现得像一个电感）。\n\nC. 一个等效的无量纲判据是 $C \\equiv (a/\\delta_{\\mathrm{CQ}})^2 = \\tau_R/\\tau_{\\mathrm{CQ}}$。$L\\!-\\!R$ 模型在 $C \\ll 1$ 时（相对于电阻扩散，全局变化缓慢）渐近有效，而在 $C \\gtrsim \\mathcal{O}(1)$ 时失效；在后一种情况下，空间扩散和重联可以在猝灭时间尺度上主导剖面演化。\n\nD. 对于 $a = 0.6\\,\\mathrm{m}$，$\\eta_{\\mathrm{eff}} = 4\\times 10^{-5}\\,\\Omega\\!\\cdot\\!\\mathrm{m}$ 和 $\\tau_{\\mathrm{CQ}} = 2\\,\\mathrm{ms}$，可以计算出 $a/\\delta_{\\mathrm{CQ}} \\approx 0.42$，因此 $L\\!-\\!R$ 模型在猝灭期间仍然是可接受的。\n\nE. 即使当 $a/\\delta_{\\mathrm{CQ}} \\gg 1$ 时，一个具有随时间变化的 $L(t)$ 和 $R(t)$ 的零维模型也可以通过使用体积平均参数来完全捕捉由趋肤效应驱动的电流重新分布和重联，因此没有必要进行多维电阻磁流体动力学处理。\n\n选择所有适用的选项，并通过从控制方程推导 $a/\\delta_{\\mathrm{CQ}}$ 判据以及从第一性原理评估选项 D 中的数值示例来证明你的选择。清楚地解释空间扩散和重联机制如何违反 $L\\!-\\!R$ 模型的假设，以及为什么所提出的判据反映了这种失效。",
            "solution": "首先必须评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 一个小半径为 $a$ 的类托卡马克圆柱形等离子体柱。\n- 模型1：零维电感-电阻 ($L\\!-\\!R$) 电路，$V_{\\mathrm{loop}} = L\\, dI/dt + R\\, I$。\n- 模型2：电阻磁流体动力学 (MHD)，演化极向磁通 $\\psi(r,t)$ 和电流密度 $J_{\\phi}(r,t)$。\n- 欧姆定律：$E_{\\parallel} = \\eta_{\\mathrm{eff}} J_{\\parallel}$，其中有效电阻率为 $\\eta_{\\mathrm{eff}}$。忽略流动。\n- 在大环径比圆柱体中的极向磁通扩散方程：\n$$ \\frac{\\partial \\psi}{\\partial t} = \\frac{\\eta_{\\mathrm{eff}}}{\\mu_0}\\,\\left(\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\psi}{\\partial r}\\right)\\right) $$\n- 特征电阻扩散时间：$\\tau_R \\sim \\mu_0 a^2/\\eta_{\\mathrm{eff}}$。\n- 电流猝灭特征衰减时间：$\\tau_{\\mathrm{CQ}}$。\n- 猝灭时间尺度的趋肤深度定义：\n$$ \\delta_{\\mathrm{CQ}} \\equiv \\sqrt{\\frac{\\eta_{\\mathrm{eff}}\\,\\tau_{\\mathrm{CQ}}}{\\mu_0}} $$\n- 提及重联过程加速电流重新分布。\n- 任务是确定 $L\\!-\\!R$ 模型失效的条件，基于比值 $a/\\delta_{\\mathrm{CQ}}$ 提出一个判据，并评估给定的陈述。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题在计算聚变科学中有充分的依据。0D $L\\!-\\!R$ 模型与 1D 电阻 MHD 模型的比较是理解托卡马克中电流剖面动力学的标准范式。磁通扩散方程、电阻时间和趋肤深度的定义都是等离子体物理和 MHD 中的标准内容。\n- **良态问题**：该问题是良态的。它要求基于模型假设的比较来推导一个物理判据，这是一个标准的物理问题，具有清晰、独特概念性的答案。\n- **客观性**：语言精确、专业，没有主观或含糊的术语。\n- **结论**：问题陈述没有科学缺陷、不一致或模糊之处。这是一个有效的等离子体物理问题。\n\n### 步骤 3：结论与行动\n问题是有效的。将推导完整的解答。\n\n### 判据的推导\n\n问题的核心是为 0D $L\\!-\\!R$ 电路模型 $V_{\\mathrm{loop}} = L\\, dI/dt + R\\, I$ 建立有效性范围。该模型描述了全局量的演化：总等离子体电流 $I(t)$、总环路电压 $V_{\\mathrm{loop}}(t)$、一个恒定的总电感 $L$ 和一个恒定的总电阻 $R$。使用单一、恒定的标量值 $L$ 和 $R$ 隐含地假设电流密度 $J(r,t)$ 的空间分布要么形状保持不变，要么在等离子体截面上是均匀的。\n\n相比之下，电阻 MHD 模型描述了场的时空演化。所给出的关于极向磁通 $\\psi$ 的抛物线型偏微分方程，\n$$ \\frac{\\partial \\psi}{\\partial t} = D_{\\eta} \\nabla^2 \\psi $$\n（其中 $D_{\\eta} = \\eta_{\\mathrm{eff}}/\\mu_0$ 是磁扩散系数，$\\nabla^2$ 是作用于 $\\psi$ 的圆柱拉普拉斯算子），是一个扩散方程。该方程控制着磁场和电流剖面的变化如何通过电阻性等离子体进行扩散。\n\n基本问题是：电流剖面在什么时间尺度上演化？电流猝灭的特征是全局衰减时间 $\\tau_{\\mathrm{CQ}}$。边界条件的任何变化（例如，边缘电压下降）将通过扩散传播到等离子体内部。这种扩散穿过整个等离子体小半径 $a$ 的特征时间是电阻时间，$\\tau_R \\sim a^2/D_{\\eta} = \\mu_0 a^2/\\eta_{\\mathrm{eff}}$。在时间 $\\tau_{\\mathrm{CQ}}$ 内，扩散扰动穿透的特征距离是趋肤深度 $\\delta_{\\mathrm{CQ}}$。我们可以从扩散方程的量纲分析中推导出这一点：$[\\partial/\\partial t] \\sim 1/\\tau_{\\mathrm{CQ}}$ 且 $[\\nabla^2] \\sim 1/\\delta_{\\mathrm{CQ}}^2$。这得出 $1/\\tau_{\\mathrm{CQ}} \\sim D_{\\eta}/\\delta_{\\mathrm{CQ}}^2$，从而得到 $\\delta_{\\mathrm{CQ}}^2 \\sim D_{\\eta} \\tau_{\\mathrm{CQ}} = \\eta_{\\mathrm{eff}}\\tau_{\\mathrm{CQ}}/\\mu_0$，这与给定的定义相符。\n\n如果等离子体对猝灭作出全局且均匀的响应，则 $L\\!-\\!R$ 模型有效。这要求关于扰动的信息有时间在猝灭时间尺度内扩散到整个等离子体柱。换句话说，穿透深度 $\\delta_{\\mathrm{CQ}}$ 必须远大于系统尺寸 $a$。\n- **有效性条件：** $\\delta_{\\mathrm{CQ}} \\gtrsim a$。这意味着在猝灭的时间尺度上，等离子体对扩散过程是“透明的”。电流剖面可以全局调整，保持一个宽泛的形状，这与 0D 模型的假设是一致的。该条件等效于 $a/\\delta_{\\mathrm{CQ}} \\lesssim 1$。\n\n当空间效应占主导地位时，$L\\!-\\!R$ 模型失效。这种情况发生在猝灭非常迅速，以至于电流剖面没有时间在整个半径上达到平衡。\n- **失效条件：** $\\delta_{\\mathrm{CQ}} \\ll a$。在此极限下，电流变化被限制在等离子体边缘一个厚度为 $\\delta_{\\mathrm{CQ}}$ 的薄“趋肤”层内。等离子体核心被屏蔽，免受快速变化的影响。这导致了一个高度非均匀的电流剖面和大的梯度。这些大梯度可以触发像撕裂模这样的 MHD 不稳定性，从而引起磁重联，并以一种复杂、多维的方式进一步加速电流的重新分布。简单的 $L\\!-\\!R$ 模型，甚至简单的 1D 扩散模型，都无法捕捉到这一点。当 $\\delta_{\\mathrm{CQ}}$ 变得与 $a$ 相当或更小时，即 $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$ 时，失效区域开始。\n\n这个判据可以用时间尺度的比值来表示，定义为 $C \\equiv (a/\\delta_{\\mathrm{CQ}})^2$。\n$$ C = \\frac{a^2}{\\delta_{\\mathrm{CQ}}^2} = \\frac{a^2}{(\\eta_{\\mathrm{eff}}\\tau_{\\mathrm{CQ}}/\\mu_0)} = \\frac{\\mu_0 a^2}{\\eta_{\\mathrm{eff}}} \\frac{1}{\\tau_{\\mathrm{CQ}}} = \\frac{\\tau_R}{\\tau_{\\mathrm{CQ}}} $$\n$L\\!-\\!R$ 模型在 $a/\\delta_{\\mathrm{CQ}} \\lesssim 1$ 时有效，这等效于 $C \\lesssim 1$，或 $\\tau_{\\mathrm{CQ}} \\gtrsim \\tau_R$。这意味着与电阻扩散时间相比，猝灭是缓慢的。\n当 $a/\\delta_{\\mathrm{CQ}} \\gtrsim 1$ 时，模型失效，这等效于 $C \\gtrsim 1$，或 $\\tau_{\\mathrm{CQ}} \\lesssim \\tau_R$。这意味着与电阻扩散时间相比，猝灭是快速的。\n\n### 评估选项\n\n**A. $L\\!-\\!R$ 模型假设电场和电流密度在小半径上空间均匀，并忽略了剖面扩散和重联。因此，只有当 $\\delta_{\\mathrm{CQ}} \\gtrsim a$（等效于 $a/\\delta_{\\mathrm{CQ}} \\ll 1$）时，它才是自洽的。当 $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$ 时，强烈的趋肤效应、陡峭的电流梯度和可能的重联事件会使 $L\\!-\\!R$ 模型的假设失效，从而需要使用电阻磁流体动力学模型。**\n该陈述准确地总结了 $L\\!-\\!R$ 模型的物理基础及其局限性。它正确地指出了该模型忽略了空间效应。它正确地陈述了有效性条件为 $\\delta_{\\mathrm{CQ}} \\gtrsim a$，其渐近极限为 $a/\\delta_{\\mathrm{CQ}} \\ll 1$。它还正确地指出了失效条件 $a/\\delta_{\\mathrm{CQ}} \\gtrsim \\mathcal{O}(1)$ 以及相关的物理现象（趋肤效应、梯度、重联），这些现象使得必须使用更复杂的 MHD 模型。\n**结论：正确。**\n\n**B. 因为电路的 $L\\!-\\!R$ 时间是 $L/R$，所以电流猝灭的正确趋肤深度是 $\\delta_{\\mathrm{CQ}} = \\sqrt{2\\eta_{\\mathrm{eff}}/(\\mu_0 \\omega)}$，其中 $\\omega \\equiv R/L$，并且当 $a/\\delta_{\\mathrm{CQ}} \\gg 1$ 时 $L\\!-\\!R$ 模型有效（趋肤效应将电流限制在边缘附近，因此内部表现得像一个电感）。**\n该陈述包含多个错误。首先，趋肤深度公式 $\\delta = \\sqrt{2\\eta/(\\mu \\omega)}$ 适用于频率为 $\\omega$ 的稳态正弦交流场，而不是由时间常数 $\\tau_{\\mathrm{CQ}}$ 表征的瞬态衰减过程。适用于扩散瞬态的定义是问题中给出的 $\\delta_{\\mathrm{CQ}} = \\sqrt{\\eta_{\\mathrm{eff}}\\tau_{\\mathrm{CQ}}/\\mu_0}$。其次，更关键的是，其有效性条件被陈述为 $a/\\delta_{\\mathrm{CQ}} \\gg 1$。这与正确的条件相反。$a/\\delta_{\\mathrm{CQ}} \\gg 1$ 意味着非常强的趋肤效应，此时 0D 模型必然会失效。所提供的推理也是有缺陷的；如果电流被限制在边缘，系统的行为与具有固定 $L$ 的简单电感的行为有根本的不同。\n**结论：不正确。**\n\n**C. 一个等效的无量纲判据是 $C \\equiv (a/\\delta_{\\mathrm{CQ}})^2 = \\tau_R/\\tau_{\\mathrm{CQ}}$。$L\\!-\\!R$ 模型在 $C \\ll 1$ 时（相对于电阻扩散，全局变化缓慢）渐近有效，而在 $C \\gtrsim \\mathcal{O}(1)$ 时失效；在后一种情况下，空间扩散和重联可以在猝灭时间尺度上主导剖面演化。**\n该陈述正确地推导了参数 $C$、比值 $a/\\delta_{\\mathrm{CQ}}$ 和时间尺度比 $\\tau_R/\\tau_{\\mathrm{CQ}}$ 之间的关系。如我们的推导所示，$C = (a/\\delta_{\\mathrm{CQ}})^2 = \\tau_R/\\tau_{\\mathrm{CQ}}$。$L\\!-\\!R$ 模型的有效性条件 $a/\\delta_{\\mathrm{CQ}} \\lesssim 1$ 等效于 $C \\lesssim 1$。对于 $C \\ll 1$ ($\\tau_{\\mathrm{CQ}} \\gg \\tau_R$) 时的渐近有效性和对于 $C \\gtrsim 1$ ($\\tau_{\\mathrm{CQ}} \\lesssim \\tau_R$) 时的失效，其陈述和物理解释都是正确的。\n**结论：正确。**\n\n**D. 对于 $a = 0.6\\,\\mathrm{m}$，$\\eta_{\\mathrm{eff}} = 4\\times 10^{-5}\\,\\Omega\\!\\cdot\\!\\mathrm{m}$ 和 $\\tau_{\\mathrm{CQ}} = 2\\,\\mathrm{ms}$，可以计算出 $a/\\delta_{\\mathrm{CQ}} \\approx 0.42$，因此 $L\\!-\\!R$ 模型在猝灭期间仍然是可接受的。**\n我们必须使用第一性原理和真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$ 来验证计算。\n给定的值为 $a = 0.6\\,\\mathrm{m}$，$\\eta_{\\mathrm{eff}} = 4\\times 10^{-5}\\,\\Omega \\cdot \\mathrm{m}$，以及 $\\tau_{\\mathrm{CQ}} = 2 \\times 10^{-3}\\,\\mathrm{s}$。\n首先，计算趋肤深度的平方：\n$$ \\delta_{\\mathrm{CQ}}^2 = \\frac{\\eta_{\\mathrm{eff}}\\,\\tau_{\\mathrm{CQ}}}{\\mu_0} = \\frac{(4 \\times 10^{-5}\\,\\Omega \\cdot \\mathrm{m})(2 \\times 10^{-3}\\,\\mathrm{s})}{4\\pi \\times 10^{-7}\\,\\mathrm{H/m}} = \\frac{8 \\times 10^{-8}}{4\\pi \\times 10^{-7}}\\,\\mathrm{m}^2 = \\frac{2}{10\\pi}\\,\\mathrm{m}^2 = \\frac{1}{5\\pi}\\,\\mathrm{m}^2 $$\n$$ \\delta_{\\mathrm{CQ}}^2 \\approx \\frac{1}{5 \\times 3.14159} \\approx 0.06366\\,\\mathrm{m}^2 $$\n趋肤深度为：\n$$ \\delta_{\\mathrm{CQ}} = \\sqrt{\\frac{1}{5\\pi}}\\,\\mathrm{m} \\approx 0.2523\\,\\mathrm{m} $$\n现在，我们计算所需比值：\n$$ \\frac{a}{\\delta_{\\mathrm{CQ}}} = \\frac{0.6\\,\\mathrm{m}}{0.2523\\,\\mathrm{m}} \\approx 2.378 $$\n计算值为 $a/\\delta_{\\mathrm{CQ}} \\approx 2.38$，与选项中给出的 0.42 值有显著差异。选项似乎计算了倒数，$\\delta_{\\mathrm{CQ}}/a \\approx 0.2523 / 0.6 \\approx 0.4205$。由于正确的比值是 $a/\\delta_{\\mathrm{CQ}} \\approx 2.38 \\gtrsim \\mathcal{O}(1)$，因此 $L\\!-\\!R$ 模型有效的条件 ($a/\\delta_{\\mathrm{CQ}} \\lesssim 1$) 并未满足。因此，基于这些参数，“模型仍然可接受”的结论也是不正确的。\n**结论：不正确。**\n\n**E. 即使当 $a/\\delta_{\\mathrm{CQ}} \\gg 1$ 时，一个具有随时间变化的 $L(t)$ 和 $R(t)$ 的零维模型也可以通过使用体积平均参数来完全捕捉由趋肤效应驱动的电流重新分布和重联，因此没有必要进行多维电阻磁流体动力学处理。**\n这个陈述根本上是错误的。$a/\\delta_{\\mathrm{CQ}} \\gg 1$ 的区域正是空间效应最为重要的区域。虽然可以通过对一个已知的、演化中的电流剖面（从 MHD 模拟中获得）进行积分来定义随时间变化的全局参数 $L(t)$ 和 $R(t)$，但 0D 模型无法预测性地计算这些剖面。0D 模型缺乏描述诸如电流重新分布等现象所需的空间自由度。此外，磁重联本质上是一个涉及局部结构（电流片）的拓扑和多维过程，无法被体积平均的标量所描述，更不用说“完全捕捉”了。在这种情况下，恰恰需要的是多维 MHD 处理。\n**结论：不正确。**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "在认识到空间分辨模型的重要性之后，下一步便是着手构建并验证它。本练习将引导你为一维磁扩散方程——任何电阻性 MHD 代码的核心组成部分——实现一个数值解 。关键任务是验证你的模拟是否严格遵守了能量守恒这一个基本物理定律，这是确保计算结果物理真实性的基石。",
            "id": "4010595",
            "problem": "考虑在磁流体动力学（MHD）中电流猝灭期间的阻性弛豫，其模型为长度为 $L$ 的一维周期性平板。假设电阻率 $\\eta$ 是空间均匀的标量，且流体速度为零。从基本电磁定律出发，即法拉第定律 $\\partial \\mathbf{B}/\\partial t = -\\nabla \\times \\mathbf{E}$、无位移电流的安培定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$ 和阻性欧姆定律 $\\mathbf{E} = \\eta \\mathbf{J}$，推导在此几何结构中单个非零磁场分量 $B_z(x,t)$ 的主控演化方程。该区域是周期性的，因此所有场在 $[0,L]$ 上满足周期性边界条件。\n\n定义磁能为 $W(t) = \\int_0^L \\frac{B_z(x,t)^2}{2\\mu_0} \\, dx$，瞬时体积欧姆加热密度为 $q(x,t) = \\eta J_y(x,t)^2$，其中 $J_y$ 是通过安培定律与此平板中的 $B_z$ 相关联的电流密度分量。总欧姆加热率为 $Q(t) = \\int_0^L q(x,t) \\, dx$，其在 $[0,T]$ 上的时间积分为 $\\int_0^T Q(t)\\, dt$。\n\n实现一个数值稳定的格式来演化 $B_z(x,t)$，该格式应遵循周期性几何。使用具有 $N$ 个点的均匀网格，空间步长 $\\Delta x = L/N$，时间步长 $\\Delta t$，总时间 $T$ 选择为 $\\Delta t$ 的整数倍。将磁场初始化为 $B_z(x,0) = B_0 \\sin(2\\pi n x/L)$，其中 $n$ 为整数模数；$n=0$ 的特殊情况对应于空间均匀的初始场。\n\n计算在时间 $t=0$ 和 $t=T$ 时的离散磁能，并使用时间上二阶精确的复合梯形法则计算在 $[0,T]$ 上的离散欧姆加热的时间积分。将剩余能量平衡误差量化为\n$$\n\\varepsilon = \\frac{\\left| \\big(W(T) - W(0)\\big) + \\int_0^T Q(t)\\, dt \\right|}{W(0)}.\n$$\n此残差 $\\varepsilon$ 是无量纲的。数值验证 $\\varepsilon$ 如何依赖于网格分辨率 $N$ 和时间步长 $\\Delta t$。\n\n使用的物理和数值单位：\n- 区域长度 $L$ 以米为单位，电阻率 $\\eta$ 以欧姆-米为单位，磁导率 $\\mu_0$ 以亨利/米为单位，时间 $t$ 以秒为单位，磁场 $B_z$ 以特斯拉为单位。\n- 在三角函数中，任何隐式的角量使用弧度。\n- 报告的残差 $\\varepsilon$ 是无单位的；请用十进制数表示。\n\n您的程序必须使用与主控方程和周期性边界条件一致的方法来实现所述的数值演化，并为以下每个测试用例计算 $\\varepsilon$。使用常数 $\\mu_0 = 4\\pi \\times 10^{-7}$，$L = 1$，$\\eta = 10^{-6}$，$B_0 = 1$。对于所有非均匀情况，使用 $n=2$；对于均匀情况，使用 $n=0$。\n\n测试组（每个用例是一个元组 $(N,\\Delta t,T,n)$）：\n- 用例 A（通用精度测试）：$(64, 5\\times 10^{-4}, 5\\times 10^{-2}, 2)$\n- 用例 B（较粗网格）：$(32, 5\\times 10^{-4}, 5\\times 10^{-2}, 2)$\n- 用例 C（较细网格和更小时间步长）：$(128, 2.5\\times 10^{-4}, 5\\times 10^{-2}, 2)$\n- 用例 D（大时间步长，相同网格）：$(64, 5\\times 10^{-3}, 5\\times 10^{-2}, 2)$\n- 用例 E（均匀场边界情况）：$(64, 10^{-3}, 10^{-2}, 0)$\n\n您的程序应生成单行输出，其中包含用例 A 到 E 的残差 $\\varepsilon$，按顺序排列，形式为用方括号括起的逗号分隔列表（例如，“[$\\varepsilon_A,\\varepsilon_B,\\varepsilon_C,\\varepsilon_D,\\varepsilon_E$]”）。最终值必须是十进制数（无百分号），并且由于它们是无单位的，不应附加任何物理单位。",
            "solution": "用户提供了一个关于阻性磁场弛豫的计算磁流体动力学（MHD）领域的问题。我将首先验证问题陈述，如果有效，则提供完整的解决方案。\n\n### 步骤1：提取给定条件\n\n- **主控物理学**：\n    - 法拉第定律：$\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}$\n    - 安培定律（准静态）：$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$\n    - 欧姆定律：$\\mathbf{E} = \\eta \\mathbf{J}$\n- **几何与场**：\n    - 长度为 $L$ 的一维周期性平板。\n    - 磁场：$\\mathbf{B} = B_z(x,t) \\hat{k}$\n    - 流体速度为零。\n    - 空间均匀的标量电阻率 $\\eta$。\n- **边界条件**：在区域 $[0,L]$ 上周期性。\n- **初始条件**：\n    - $B_z(x,0) = B_0 \\sin(2\\pi n x/L)$，其中 $n$ 为整数模数。\n    - 对于 $n=0$，明确指出场是空间均匀的。结合使用 $B_0$ 作为振幅，这意味着 $B_z(x,0) = B_0$。\n- **能量与加热定义**：\n    - 磁能：$W(t) = \\int_0^L \\frac{B_z(x,t)^2}{2\\mu_0} \\, dx$\n    - 体积欧姆加热：$q(x,t) = \\eta J_y(x,t)^2$\n    - 总欧姆加热率：$Q(t) = \\int_0^L q(x,t) \\, dx$\n- **误差度量**：\n    - 剩余能量平衡误差：$\\varepsilon = \\frac{\\left| \\big(W(T) - W(0)\\big) + \\int_0^T Q(t)\\, dt \\right|}{W(0)}$\n- **常数与参数**：\n    - $\\mu_0 = 4\\pi \\times 10^{-7}$ H/m\n    - $L = 1$ m\n    - $\\eta = 10^{-6}$ $\\Omega \\cdot$m\n    - $B_0 = 1$ T\n- **数值设置**：\n    - 具有 $N$ 个点的均匀网格，空间步长 $\\Delta x = L/N$。\n    - 时间步长 $\\Delta t$，总时间 $T$。\n- **测试用例 $(N, \\Delta t, T, n)$**：\n    - A: $(64, 5 \\times 10^{-4}, 5 \\times 10^{-2}, 2)$\n    - B: $(32, 5 \\times 10^{-4}, 5 \\times 10^{-2}, 2)$\n    - C: $(128, 2.5 \\times 10^{-4}, 5 \\times 10^{-2}, 2)$\n    - D: $(64, 5 \\times 10^{-3}, 5 \\times 10^{-2}, 2)$\n    - E: $(64, 10^{-3}, 10^{-2}, 0)$\n\n### 步骤2：使用提取的给定条件进行验证\n\n1.  **科学基础**：该问题基于阻性MHD的基本方程，这是等离子体物理学的基石。由电阻率引起的磁场扩散场景是一个规范且科学上合理的问题。\n2.  **良态性与一致性**：\n    - **主控方程推导**：我们组合给定的定律。将欧姆定律代入法拉第定律：$\\frac{\\partial \\mathbf{B}}{\\partial t} = - \\nabla \\times (\\eta \\mathbf{J})$。由于 $\\eta$ 是一个均匀标量，$\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\eta \\nabla \\times \\mathbf{J}$。代入安培定律 $\\mathbf{J} = \\frac{1}{\\mu_0}\\nabla \\times \\mathbf{B}$：$\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\frac{\\eta}{\\mu_0} \\nabla \\times (\\nabla \\times \\mathbf{B})$。使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B}$ 和无散条件 $\\nabla \\cdot \\mathbf{B} = 0$，这简化为磁扩散方程：$\\frac{\\partial \\mathbf{B}}{\\partial t} = \\frac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B}$。对于场 $\\mathbf{B} = B_z(x,t) \\hat{k}$，这变成标量偏微分方程：\n    $$\n    \\frac{\\partial B_z}{\\partial t} = \\mathcal{D} \\frac{\\partial^2 B_z}{\\partial x^2}, \\quad \\text{其中 } \\mathcal{D} = \\frac{\\eta}{\\mu_0}.\n    $$\n    这是一个良态的抛物线型偏微分方程，给定的初始和周期性边界条件对其是合适的。\n    - **能量守恒**：让我们验证能量与加热之间的关系。磁能的变化率是 $\\frac{dW}{dt} = \\int_0^L \\frac{1}{\\mu_0} B_z \\frac{\\partial B_z}{\\partial t} dx$。代入偏微分方程：$\\frac{dW}{dt} = \\frac{\\mathcal{D}}{\\mu_0} \\int_0^L B_z \\frac{\\partial^2 B_z}{\\partial x^2} dx$。使用分部积分法和周期性（边界项抵消），我们得到 $\\frac{dW}{dt} = -\\frac{\\mathcal{D}}{\\mu_0} \\int_0^L \\left(\\frac{\\partial B_z}{\\partial x}\\right)^2 dx$。现在，对于加热率 $Q(t) = \\int_0^L \\eta J_y^2 dx$。根据安培定律，$\\mu_0 J_y = (\\nabla \\times \\mathbf{B})_y = -\\frac{\\partial B_z}{\\partial x}$。因此，$J_y = -\\frac{1}{\\mu_0} \\frac{\\partial B_z}{\\partial x}$。将其代入 $Q(t)$ 得 $Q(t) = \\int_0^L \\eta \\left(-\\frac{1}{\\mu_0} \\frac{\\partial B_z}{\\partial x}\\right)^2 dx = \\frac{\\eta}{\\mu_0^2} \\int_0^L \\left(\\frac{\\partial B_z}{\\partial x}\\right)^2 dx = \\frac{\\mathcal{D}}{\\mu_0} \\int_0^L \\left(\\frac{\\partial B_z}{\\partial x}\\right)^2 dx$。比较这两个结果，我们发现 $\\frac{dW}{dt} = -Q(t)$。在 $[0,T]$ 上积分得到 $W(T) - W(0) = -\\int_0^T Q(t) dt$，或 $W(T) - W(0) + \\int_0^T Q(t) dt = 0$。误差度量 $\\varepsilon$ 是对此守恒定律满足程度的数值度量。\n    - **n=0的特殊情况**：对于 $n=0$，均匀初始场 $B_z(x,0)=B_0$ 导致 $\\frac{\\partial^2 B_z}{\\partial x^2}=0$。偏微分方程规定 $\\frac{\\partial B_z}{\\partial t}=0$，因此场保持均匀和恒定。因此，$J_y=0$，$Q(t)=0$，$W(t)=W(0)$。能量平衡残差的精确值为零。分母 $W(0) = \\frac{B_0^2 L}{2\\mu_0}$ 非零，所以问题是良定义的。\n3.  **客观性与完整性**：问题以精确的数学术语陈述，并提供了所有必要的参数。它是客观和自包含的。对“数值稳定格式”的要求是此类问题的标准部分，指导算法的选择，因为对于给定的某些测试用例，显式的前向欧拉格式会不稳定。\n\n### 步骤3：结论与行动\n\n问题陈述在科学上是合理的，数学上是一致的，并且是良态的。它构成了计算物理学中的一个标准练习。\n**结论**：有效。\n**行动**：着手开发解决方案。\n\n---\n\n### 解的推导与数值格式\n\n主控方程是一维磁扩散方程：\n$$\n\\frac{\\partial B_z}{\\partial t} = \\mathcal{D} \\frac{\\partial^2 B_z}{\\partial x^2}\n$$\n其中 $\\mathcal{D} = \\eta/\\mu_0$。这是一个类似于热方程的抛物线型偏微分方程。我们将在均匀网格 $x_i = i \\Delta x$（$i=0, 1, \\dots, N-1$，其中 $\\Delta x = L/N$）上进行数值求解。在网格点 $x_i$ 和时间 $t_k = k \\Delta t$ 处的场记为 $B_i^k$。\n\n**数值方法：Crank-Nicolson**\n为确保给定参数范围（特别是用例D中的大时间步长）的数值稳定性，我们采用Crank-Nicolson方法，这是一种以其无条件稳定性和在空间和时间上均具有二阶精度而闻名的隐式格式。\n\nPDE的Crank-Nicolson离散化是：\n$$\n\\frac{B_i^{k+1} - B_i^k}{\\Delta t} = \\frac{\\mathcal{D}}{2} \\left( \\left.\\frac{\\partial^2 B_z}{\\partial x^2}\\right|_i^{k+1} + \\left.\\frac{\\partial^2 B_z}{\\partial x^2}\\right|_i^k \\right)\n$$\n我们对空间导数使用二阶中心差分，同时遵守周期性边界条件：\n$$\n\\left.\\frac{\\partial^2 B_z}{\\partial x^2}\\right|_i \\approx \\frac{B_{i-1} - 2B_i + B_{i+1}}{\\Delta x^2}\n$$\n其中索引对 $N$ 取模（例如，$B_{-1} = B_{N-1}$）。\n\n代入有限差分并重新整理各项以求解未知状态 $B^{k+1}$：\n$$\nB_i^{k+1} - \\frac{\\mathcal{D} \\Delta t}{2 \\Delta x^2} (B_{i-1}^{k+1} - 2B_i^{k+1} + B_{i+1}^{k+1}) = B_i^k + \\frac{\\mathcal{D} \\Delta t}{2 \\Delta x^2} (B_{i-1}^k - 2B_i^k + B_{i+1}^k)\n$$\n令 $\\alpha = \\frac{\\mathcal{D} \\Delta t}{\\Delta x^2}$。方程变为：\n$$\n-\\frac{\\alpha}{2} B_{i-1}^{k+1} + (1+\\alpha) B_i^{k+1} - \\frac{\\alpha}{2} B_{i+1}^{k+1} = \\frac{\\alpha}{2} B_{i-1}^k + (1-\\alpha) B_i^k + \\frac{\\alpha}{2} B_{i+1}^k\n$$\n这代表了关于未知场值向量 $\\mathbf{B}^{k+1} = [B_0^{k+1}, \\dots, B_{N-1}^{k+1}]^T$ 的一个线性方程组。该系统可以写成矩阵形式：\n$$\n\\mathbf{A} \\mathbf{B}^{k+1} = \\mathbf{R} \\mathbf{B}^k\n$$\n其中 $\\mathbf{A}$ 和 $\\mathbf{R}$ 是 $N \\times N$ 矩阵。由于周期性边界条件，这些是循环矩阵。矩阵 $\\mathbf{A}$ 的对角线元素为 $(1+\\alpha)$，次对角线元素为 $-\\alpha/2$，元素 $A_{0,N-1}$ 和 $A_{N-1,0}$ 也等于 $-\\alpha/2$。矩阵 $\\mathbf{R}$ 类似，对角线元素为 $(1-\\alpha)$，次对角线元素为 $\\alpha/2$。在每个时间步，我们求解这个线性系统以得到 $\\mathbf{B}^{k+1}$。\n\n**诊断量的计算**\n\n所需的物理量由离散场值计算得出。所有空间积分均使用复合梯形法则近似，对于均匀周期性网格，这简化为求和后乘以 $\\Delta x$。\n\n-   **磁能 $W(t_k)$**：\n    $$\n    W(t_k) \\approx \\Delta x \\sum_{i=0}^{N-1} \\frac{(B_i^k)^2}{2\\mu_0}\n    $$\n-   **欧姆加热率 $Q(t_k)$**：首先，我们需要电流密度 $J_y = -\\frac{1}{\\mu_0} \\frac{\\partial B_z}{\\partial x}$。我们对此一阶导数使用二阶中心差分：\n    $$\n    J_{y,i}^k \\approx -\\frac{1}{\\mu_0} \\frac{B_{i+1}^k - B_{i-1}^k}{2 \\Delta x}\n    $$\n    同样，索引对 $N$ 取模。总加热率则为：\n    $$\n    Q(t_k) \\approx \\Delta x \\sum_{i=0}^{N-1} \\eta (J_{y,i}^k)^2\n    $$\n-   **时间积分的欧姆加热**：问题指定对 $Q(t)$ 的时间积分使用二阶复合梯形法则。如果我们存储 $k=0, \\dots, M$（其中 $M=T/\\Delta t$）的 $Q^k = Q(t_k)$ 值：\n    $$\n    \\int_0^T Q(t) dt \\approx \\Delta t \\left( \\frac{Q^0 + Q^M}{2} + \\sum_{k=1}^{M-1} Q^k \\right)\n    $$\n-   **残差误差 $\\varepsilon$**：使用离散量 $W^0=W(0)$、$W^M=W(T)$ 以及积分后的加热量，根据问题中的定义计算最终的误差度量。\n\n实现将遍历指定的测试用例，为每个用例执行时间演化并计算相应的 $\\varepsilon$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef run_simulation(N, dt, T, n, L, eta, mu_0, B0):\n    \"\"\"\n    Runs a single simulation case for the 1D resistive MHD problem.\n    \"\"\"\n    # Grid setup\n    dx = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Physical and numerical constants\n    D = eta / mu_0\n    alpha = D * dt / dx**2\n    num_steps = int(round(T / dt))\n    \n    # Initial condition\n    if n == 0:\n        B = B0 * np.ones(N)\n    else:\n        B = B0 * np.sin(2 * np.pi * n * x / L)\n\n    # --- Helper functions for diagnostics\n    def calculate_W(B_field):\n        \"\"\"Calculates magnetic energy W.\"\"\"\n        # Composite trapezoidal rule for periodic function (sum * dx)\n        return np.sum(B_field**2 / (2 * mu_0)) * dx\n\n    def calculate_Q(B_field):\n        \"\"\"Calculates total ohmic heating rate Q.\"\"\"\n        # Second-order central difference for dB/dx with periodic BCs\n        J_y = -(np.roll(B_field, -1) - np.roll(B_field, 1)) / (2 * dx) / mu_0\n        q = eta * J_y**2\n        # Composite trapezoidal rule for periodic function (sum * dx)\n        return np.sum(q) * dx\n\n    # --- Initial state diagnostics\n    W0 = calculate_W(B)\n    \n    # If W0 is zero, the relative error is undefined. This should not\n    # occur for the given test cases.\n    if W0 == 0:\n        return np.nan\n\n    # --- Crank-Nicolson time evolution setup\n    # The scheme is A * B_next = R * B_current\n    # A is the matrix for the implicit part, R for the explicit part.\n    \n    # Construct matrix A for the LHS\n    A = np.zeros((N, N))\n    A_diag = 1 + alpha\n    A_offdiag = -alpha / 2\n    for i in range(N):\n        A[i, i] = A_diag\n        A[i, (i - 1 + N) % N] = A_offdiag\n        A[i, (i + 1) % N] = A_offdiag\n\n    # Construct matrix R for the RHS\n    R = np.zeros((N, N))\n    R_diag = 1 - alpha\n    R_offdiag = alpha / 2\n    for i in range(N):\n        R[i, i] = R_diag\n        R[i, (i - 1 + N) % N] = R_offdiag\n        R[i, (i + 1) % N] = R_offdiag\n\n    # --- Time loop\n    B_current = B.copy()\n    Q_history = np.zeros(num_steps + 1)\n    Q_history[0] = calculate_Q(B_current)\n\n    for k in range(num_steps):\n        rhs_vector = R @ B_current\n        B_next = linalg.solve(A, rhs_vector, assume_a='sym')\n        B_current = B_next\n        Q_history[k + 1] = calculate_Q(B_current)\n\n    # --- Final state diagnostics\n    WT = calculate_W(B_current)\n\n    # Time-integrated Ohmic heating (composite trapezoidal rule over time)\n    time_points = np.linspace(0, T, num_steps + 1)\n    integrated_Q = np.trapz(Q_history, time_points)\n    \n    # --- Calculate residual energy balance error\n    energy_change = WT - W0\n    residual_numerator = abs(energy_change + integrated_Q)\n    epsilon = residual_numerator / W0\n    \n    return epsilon\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define physical constants\n    MU_0 = 4 * np.pi * 1e-7\n    L = 1.0\n    ETA = 1e-6\n    B0 = 1.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, dt, T, n)\n        (64, 5e-4, 5e-2, 2),  # Case A\n        (32, 5e-4, 5e-2, 2),  # Case B\n        (128, 2.5e-4, 5e-2, 2),  # Case C\n        (64, 5e-3, 5e-2, 2),  # Case D\n        (64, 1e-3, 1e-2, 0),   # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        N, dt, T, n = case\n        result = run_simulation(N, dt, T, n, L, ETA, MU_0, B0)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}