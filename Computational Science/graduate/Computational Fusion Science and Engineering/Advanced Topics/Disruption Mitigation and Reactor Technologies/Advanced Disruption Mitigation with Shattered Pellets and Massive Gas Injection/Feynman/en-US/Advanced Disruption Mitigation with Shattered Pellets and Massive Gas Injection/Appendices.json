{
    "hands_on_practices": [
        {
            "introduction": "The primary goal of disruption mitigation is to rapidly dissipate the plasma's thermal and magnetic energy in a controlled manner through impurity radiation. This first practice delves into the fundamental atomic physics behind this process, asking you to calculate the total radiative power from a collection of impurity clouds produced by shattered pellets . By applying a simplified collisional-radiative model, you will gain a quantitative understanding of how electron temperature, impurity density, and atomic properties govern the effectiveness of radiative cooling.",
            "id": "3947737",
            "problem": "In the context of disruption mitigation in magnetic confinement fusion by Shattered Pellet Injection (SPI) and Massive Gas Injection (MGI), consider a single ablation cloud produced by one shard of an argon pellet traveling through the edge plasma. Assume the following simplified, optically thin, collisional model consistent with a coronal approximation for line radiation in a partially ionized, low-temperature cloud:\n\n- Electrons are Maxwellian at a uniform electron temperature $T_{e}$ (measured in electronvolts), with $T_{e}$ approximately constant within the cloud.\n- The argon impurity density inside the cloud is uniform and equal to $n_{Z}$.\n- A fixed ionization fraction $x_{i}$ of the argon is singly ionized, and a fraction $f_{\\ell}=1-x_{i}$ remains neutral in the ground state. The dominant radiative loss is a single, strong, optically thin line emitted following electron-impact excitation from the neutral ground state at photon energy $E_{0}$ (in electronvolts).\n- The effective collisional excitation rate coefficient for this line is modeled by\n$$ \\langle \\sigma v \\rangle = C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e}) $$\nwhere $C_{0}$ is a constant with units $\\mathrm{m^{3}\\,s^{-1}\\,eV^{1/2}}$ and $T_{e}$ is in electronvolts.\n- The local electron density in the cloud is $n_{e}=n_{e0}+x_{i}\\,n_{Z}$, where $n_{e0}$ is the background electron density.\n- Each electron-impact excitation produces one photon of energy $E_{0}$ that escapes (optically thin). To convert electronvolts to joules, use the elementary charge $q_{e}$.\n\nUsing only kinetic theory for Maxwellian electrons, ideal-gas notions, and optically thin line-radiation balance, derive the volumetric radiative power density $p_{\\mathrm{rad}}(T_{e},n_{Z})$ from the ablation cloud in terms of $T_{e}$ and $n_{Z}$. Then, assuming a spherical cloud of radius $R_{c}$ for each shard with uniform $T_{e}$ and $n_{Z}$, compute the total global radiated power $P_{\\mathrm{rad,global}}$ for $N$ identical, non-overlapping shards by summing over the shards.\n\nUse the following scientifically plausible parameters appropriate to an argon SPI shard interacting with a low-temperature edge plasma:\n- $E_{0}=15.0\\,\\mathrm{eV}$,\n- $C_{0}=1.5\\times 10^{-14}\\,\\mathrm{m^{3}\\,s^{-1}\\,eV^{1/2}}$,\n- $T_{e}=10.0\\,\\mathrm{eV}$,\n- $n_{Z}=5.0\\times 10^{20}\\,\\mathrm{m^{-3}}$,\n- $x_{i}=0.10$ so that $f_{\\ell}=0.90$,\n- $n_{e0}=3.0\\times 10^{19}\\,\\mathrm{m^{-3}}$,\n- $R_{c}=0.060\\,\\mathrm{m}$,\n- $N=200$ shards,\n- $q_{e}=1.602176634\\times 10^{-19}\\,\\mathrm{C}$.\n\nInstructions:\n1. Derive an analytic expression for $p_{\\mathrm{rad}}(T_{e},n_{Z})$ using the above model and assumptions.\n2. Evaluate the expression numerically with the given parameters to obtain the single-shard radiated power $P_{\\mathrm{shard}}$ and then compute $P_{\\mathrm{rad,global}}=N\\,P_{\\mathrm{shard}}$.\n3. Express the final global radiated power in megawatts and round your answer to three significant figures. Do not include the unit in your final boxed answer.",
            "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded within the context of a simplified but plausible physical model, is well-posed with all necessary information provided, and is expressed in objective, formal language. The model for collisional line radiation is standard for pedagogical problems in plasma physics, and the parameters are representative of conditions in the plasma edge during a shattered pellet injection event. We may therefore proceed with the solution.\n\nThe primary task is to derive the volumetric radiative power density, $p_{\\mathrm{rad}}$, and from it, the total radiated power from all pellet shards.\n\nFirst, we establish the rate of electron-impact excitation events per unit volume, $R_{\\mathrm{ex}}$. This rate is the product of the density of the target species, the density of the projectile species, and the reaction rate coefficient.\nIn this model, the target species are the neutral argon atoms in the ground state. Their number density, $n_{\\text{neutral}}$, is given by the total argon density $n_{Z}$ multiplied by the neutral fraction, $f_{\\ell}$.\n$$n_{\\text{neutral}} = f_{\\ell} n_{Z} = (1 - x_{i}) n_{Z}$$\nThe projectile species are the electrons, with a number density of $n_{e}$.\nThe rate coefficient for the excitation process is given as $\\langle \\sigma v \\rangle = C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e})$.\nThus, the volumetric rate of excitations is:\n$$R_{\\mathrm{ex}} = n_{e} \\cdot n_{\\text{neutral}} \\cdot \\langle \\sigma v \\rangle = n_{e} (1 - x_{i}) n_{Z} C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e})$$\n\nThe problem states that the ablation cloud is optically thin for the considered line radiation. This assumption implies that every excitation event is followed by the emission of a photon, and every such photon escapes the cloud without being re-absorbed. Each photon carries an energy of $E_{0}$, measured in electronvolts. To find the power density in SI units (Watts per cubic meter), this energy must be converted to Joules by multiplying by the elementary charge, $q_{e}$.\nThe energy radiated per event is $E_{\\mathrm{photon}} = E_{0} q_{e}$.\nThe volumetric radiative power density, $p_{\\mathrm{rad}}$, is the product of the excitation rate per unit volume and the energy radiated per event:\n$$p_{\\mathrm{rad}} = R_{\\mathrm{ex}} \\cdot E_{\\mathrm{photon}} = \\left( n_{e} (1 - x_{i}) n_{Z} C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e}) \\right) (E_{0} q_{e})$$\nThe problem also specifies the local electron density as $n_{e} = n_{e0} + x_{i} n_{Z}$. Substituting this expression for $n_{e}$ into the equation for $p_{\\mathrm{rad}}$ yields the complete analytical expression for the volumetric radiative power density in terms of the given parameters:\n$$p_{\\mathrm{rad}}(T_{e}, n_{Z}) = q_{e} E_{0} C_{0} (1 - x_{i}) n_{Z} (n_{e0} + x_{i} n_{Z}) T_{e}^{-1/2} \\exp\\left(-\\frac{E_{0}}{T_{e}}\\right)$$\n\nNext, we calculate the total power radiated by a single spherical shard cloud, $P_{\\mathrm{shard}}$. The cloud is assumed to be a uniform sphere of radius $R_{c}$. Its volume, $V_{c}$, is given by the formula for the volume of a sphere:\n$$V_{c} = \\frac{4}{3}\\pi R_{c}^{3}$$\nThe total power radiated by one shard is the uniform volumetric power density multiplied by the cloud volume:\n$$P_{\\mathrm{shard}} = p_{\\mathrm{rad}} \\cdot V_{c} = \\frac{4}{3}\\pi R_{c}^{3} \\cdot p_{\\mathrm{rad}}$$\nFinally, the total global radiated power, $P_{\\mathrm{rad,global}}$, from $N$ identical, non-overlapping shards is simply $N$ times the power from a single shard:\n$$P_{\\mathrm{rad,global}} = N \\cdot P_{\\mathrm{shard}} = N \\frac{4}{3}\\pi R_{c}^{3} q_{e} E_{0} C_{0} (1 - x_{i}) n_{Z} (n_{e0} + x_{i} n_{Z}) T_{e}^{-1/2} \\exp\\left(-\\frac{E_{0}}{T_{e}}\\right)$$\n\nNow, we will substitute the given numerical values to find the final answer.\nThe parameters are:\n$E_{0} = 15.0\\,\\mathrm{eV}$\n$C_{0} = 1.5 \\times 10^{-14}\\,\\mathrm{m^{3}\\,s^{-1}\\,eV^{1/2}}$\n$T_{e} = 10.0\\,\\mathrm{eV}$\n$n_{Z} = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$\n$x_{i} = 0.10$\n$n_{e0} = 3.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n$R_{c} = 0.060\\,\\mathrm{m}$\n$N = 200$\n$q_{e} = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n\nFirst, we calculate the intermediate quantities.\nThe neutral fraction is $f_{\\ell} = 1 - x_{i} = 1 - 0.10 = 0.90$.\nThe electron density inside the cloud is:\n$$n_{e} = n_{e0} + x_{i} n_{Z} = (3.0 \\times 10^{19}) + (0.10)(5.0 \\times 10^{20}) = 3.0 \\times 10^{19} + 5.0 \\times 10^{19} = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$$\nThe thermal factor in the rate coefficient is:\n$$T_{e}^{-1/2} \\exp\\left(-\\frac{E_{0}}{T_{e}}\\right) = (10.0)^{-1/2} \\exp\\left(-\\frac{15.0}{10.0}\\right) = (10.0)^{-0.5} \\exp(-1.5)$$\nThe volume of a single shard cloud is:\n$$V_{c} = \\frac{4}{3}\\pi (0.060)^{3} = \\frac{4}{3}\\pi (2.16 \\times 10^{-4})\\,\\mathrm{m^{3}} \\approx 9.0478 \\times 10^{-4}\\,\\mathrm{m^{3}}$$\nNow, we calculate the volumetric power density $p_{\\mathrm{rad}}$:\n$$p_{\\mathrm{rad}} = (1.602176634 \\times 10^{-19}) \\cdot (15.0) \\cdot (1.5 \\times 10^{-14}) \\cdot (0.90) \\cdot (5.0 \\times 10^{20}) \\cdot (8.0 \\times 10^{19}) \\cdot (10.0)^{-0.5} \\exp(-1.5)$$\n$$p_{\\mathrm{rad}} \\approx (1.2977 \\times 10^{8}) \\cdot (10.0)^{-0.5} \\exp(-1.5) \\approx 9.1565 \\times 10^{7}\\,\\mathrm{W\\,m^{-3}}$$\nThe power from a single shard is:\n$$P_{\\mathrm{shard}} = p_{\\mathrm{rad}} \\cdot V_{c} \\approx (9.1565 \\times 10^{7}) \\cdot (9.0478 \\times 10^{-4}) \\approx 8.2846 \\times 10^{4}\\,\\mathrm{W}$$\nThe total global radiated power is:\n$$P_{\\mathrm{rad,global}} = N \\cdot P_{\\mathrm{shard}} = 200 \\cdot (8.2846 \\times 10^{4}) \\approx 1.6569 \\times 10^{7}\\,\\mathrm{W}$$\nThe problem requires the answer in megawatts ($1\\,\\mathrm{MW} = 10^{6}\\,\\mathrm{W}$).\n$$P_{\\mathrm{rad,global}} \\approx 16.569\\,\\mathrm{MW}$$\nRounding the result to three significant figures, we get $16.6\\,\\mathrm{MW}$.",
            "answer": "$$\\boxed{16.6}$$"
        },
        {
            "introduction": "Once the plasma's thermal energy is radiated away, the now cold and impurity-rich plasma becomes highly resistive, leading to a rapid decay of the plasma current known as the current quench. This exercise explores the direct consequences of impurity injection on the plasma's electrical properties . You will derive how the assimilated impurities increase the effective ionic charge, $Z_{\\mathrm{eff}}$, and in turn, the Spitzer resistivity, allowing you to calculate the resulting current quench rate using a simple L/R circuit model for the tokamak.",
            "id": "3947715",
            "problem": "A large-aspect-ratio tokamak plasma is approximated as a uniform, circular current channel of minor radius $a$ and major radius $R_0$, forming a toroidal conductor of length $l = 2 \\pi R_0$ and cross-sectional area $A = \\pi a^2$. Immediately after a Massive Gas Injection (MGI) disruption mitigation pulse with argon, the current quench is assumed to be governed by a simple resistive circuit model with inductance $L$ and plasma resistance $R = \\eta \\, l/A$, where $\\eta$ is the scalar plasma resistivity. The loop voltage from external coils is neglected during the initial quench, so that $L \\, dI/dt + R I = 0$ holds at $t = 0^{+}$. Use the following fundamental bases and well-tested formulas:\n- Definition of effective ion charge: $Z_{\\mathrm{eff}} = \\left(\\sum_s n_s Z_s^2\\right) / n_e$, with $n_e = \\sum_s n_s Z_s$ and the sum taken over all ion species $s$.\n- Spitzer resistivity for a fully ionized plasma with Coulomb collisions: $\\eta \\approx C_\\eta \\frac{Z_{\\mathrm{eff}} \\ln\\Lambda}{T_e^{3/2}}$, where $T_e$ is in electronvolts and the constant $C_\\eta \\approx 5.2 \\times 10^{-5} \\, \\Omega \\cdot \\mathrm{m} \\cdot \\mathrm{eV}^{3/2}$.\n- Ohmic relation for a uniform conductor: $R = \\eta \\, l/A$.\n\nConsider the following scenario and parameters, all uniform in space over the current channel volume $V = 2 \\pi^2 R_0 a^2$.\n\n- Geometry: $R_0 = 3\\,\\mathrm{m}$ and $a = 1\\,\\mathrm{m}$.\n- Initial plasma state before the quench: deuterium-dominated plasma with $n_{e0} = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $Z_{\\mathrm{eff},0} = 1.20$, and electron temperature $T_{e0} = 2.0\\,\\mathrm{keV}$.\n- Current: $I_0 = 10\\,\\mathrm{MA}$ at $t = 0^{-}$.\n- Coulomb logarithm: $\\ln \\Lambda = 15$ (assume constant across the event).\n- Inductance: $L = 50\\,\\mu\\mathrm{H}$ (total effective circuit inductance).\n- MGI species and inventory: argon of atomic mass number $A_{\\mathrm{imp}} = 40$, injected mass $m_{\\mathrm{gas}} = 50\\,\\mathrm{mg}$, assimilation fraction $f = 0.50$ (fraction of injected atoms that are ionized and mixed into the current channel).\n- Post-MGI electron temperature at $t = 0^{+}$: $T_{e1} = 10\\,\\mathrm{eV}$ (assume spatially uniform).\n- Post-MGI average argon charge state at $t = 0^{+}$: $\\bar{Z}_{\\mathrm{imp}} = 2$ (assume a time-averaged effective charge state during the initial current quench).\n- Fundamental constants: proton atomic mass unit $m_u = 1.6605 \\times 10^{-27}\\,\\mathrm{kg}$, elementary charge $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$, electron mass $m_e = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$, vacuum permittivity $\\varepsilon_0 = 8.854 \\times 10^{-12}\\,\\mathrm{F/m}$, and Boltzmann constant $k_B = 1.381 \\times 10^{-23}\\,\\mathrm{J/K}$.\n\nTasks:\n1) Starting from the definition of $Z_{\\mathrm{eff}}$, derive an explicit expression for the post-MGI effective charge $Z_{\\mathrm{eff},1}$ in terms of $Z_{\\mathrm{eff},0}$, $n_{e0}$, the assimilated impurity density $n_{\\mathrm{imp}}$, and $\\bar{Z}_{\\mathrm{imp}}$. Express your result without invoking any shortcut formulas beyond the given definition.\n2) Using the provided Spitzer resistivity expression, show how the MGI-induced density rise modifies $\\eta$ only through $Z_{\\mathrm{eff}}$ (for fixed $T_e$ and $\\ln \\Lambda$).\n3) Compute the assimilated argon ion density $n_{\\mathrm{imp}}$ from the given $m_{\\mathrm{gas}}$, $A_{\\mathrm{imp}}$, $f$, and the channel volume $V = 2 \\pi^2 R_0 a^2$. Then evaluate $Z_{\\mathrm{eff},1}$, the post-MGI resistivity $\\eta_1$ at $T_{e1}$, and the corresponding plasma resistance $R_1$.\n4) Using $L \\, dI/dt + R I = 0$, evaluate the signed initial current decay rate $dI/dt \\big|_{t=0^{+}}$ with $I(0^{+}) = I_0$ and $R = R_1$.\n\nExpress your final numerical answer for $dI/dt \\big|_{t=0^{+}}$ in $\\mathrm{MA/s}$ and round to three significant figures.",
            "solution": "### Solution\nThe solution proceeds by addressing each of the four tasks in order.\n\n**Task 1: Derivation of the post-MGI effective charge $Z_{\\mathrm{eff},1}$**\n\nThe definition of the effective ion charge $Z_{\\mathrm{eff}}$ is given as $Z_{\\mathrm{eff}} = \\frac{\\sum_s n_s Z_s^2}{n_e}$, where $n_e = \\sum_s n_s Z_s$. The sum is over all ion species $s$.\n\nInitially (state 0), the plasma consists of the background ions. The initial state is characterized by:\n$$n_{e0} = \\sum_{s \\in s_0} n_{s0} Z_s$$\n$$\\sum_{s \\in s_0} n_{s0} Z_s^2 = n_{e0} Z_{\\mathrm{eff},0}$$\nAfter the Massive Gas Injection (MGI), argon ions with density $n_{\\mathrm{imp}}$ and average charge state $\\bar{Z}_{\\mathrm{imp}}$ are added. The new electron density, $n_{e1}$, is:\n$$n_{e1} = n_{e0} + n_{\\mathrm{imp}} \\bar{Z}_{\\mathrm{imp}}$$\nThe new sum of $n_s Z_s^2$ is:\n$$\\sum_s n_{s1} Z_s^2 = n_{e0} Z_{\\mathrm{eff},0} + n_{\\mathrm{imp}} \\bar{Z}_{\\mathrm{imp}}^2$$\nTherefore, the post-MGI effective charge, $Z_{\\mathrm{eff},1}$, is:\n$$Z_{\\mathrm{eff},1} = \\frac{\\sum_s n_{s1} Z_s^2}{n_{e1}} = \\frac{n_{e0} Z_{\\mathrm{eff},0} + n_{\\mathrm{imp}} \\bar{Z}_{\\mathrm{imp}}^2}{n_{e0} + n_{\\mathrm{imp}} \\bar{Z}_{\\mathrm{imp}}}$$\n\n**Task 2: Expression for resistivity $\\eta$**\n\nWe use the simplified Spitzer resistivity model:\n$$\\eta(T_e,Z_{\\mathrm{eff}}) = C_\\eta\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_e^{3/2}}$$\nFor a fixed electron temperature $T_e$ and Coulomb logarithm $\\ln \\Lambda$, the resistivity $\\eta$ is directly proportional to $Z_{\\mathrm{eff}}$. The plasma density does not appear explicitly in this formula, so the density rise modifies $\\eta$ only indirectly through its effect on $Z_{\\mathrm{eff}}$.\n\n**Task 3: Numerical evaluation of post-MGI plasma parameters**\n\nFirst, we compute the assimilated argon ion density, $n_{\\mathrm{imp}}$.\nThe plasma volume is $V = 2 \\pi^2 R_0 a^2 = 2 \\pi^2 (3\\,\\mathrm{m})(1\\,\\mathrm{m})^2 = 6 \\pi^2 \\approx 59.218\\,\\mathrm{m}^3$.\nThe number of assimilated argon ions is $N_{\\mathrm{imp}} = \\frac{f \\cdot m_{\\mathrm{gas}}}{A_{\\mathrm{imp}} m_u}$.\n$$n_{\\mathrm{imp}} = \\frac{N_{\\mathrm{imp}}}{V} = \\frac{f m_{\\mathrm{gas}}}{A_{\\mathrm{imp}} m_u V} = \\frac{0.50 \\cdot (50 \\times 10^{-6}\\,\\mathrm{kg})}{40 \\cdot (1.6605 \\times 10^{-27}\\,\\mathrm{kg}) \\cdot (59.218\\,\\mathrm{m}^3)} \\approx 6.356 \\times 10^{18}\\,\\mathrm{m}^{-3}$$\n\nNext, we evaluate $Z_{\\mathrm{eff},1}$:\n$$Z_{\\mathrm{eff},1} = \\frac{(5.0 \\times 10^{19}\\,\\mathrm{m}^{-3})(1.20) + (6.356 \\times 10^{18}\\,\\mathrm{m}^{-3})(2^2)}{(5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) + (6.356 \\times 10^{18}\\,\\mathrm{m}^{-3})(2)} = \\frac{6.0 \\times 10^{19} + 2.542 \\times 10^{19}}{5.0 \\times 10^{19} + 1.271 \\times 10^{19}} \\approx 1.362$$\n\nNow, we compute the post-MGI resistivity, $\\eta_1$, at $T_{e1} = 10\\,\\mathrm{eV}$:\n$$\\eta_1 = (5.2 \\times 10^{-5}) \\frac{1.362 \\cdot 15}{(10)^{3/2}} \\approx 3.360 \\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m}$$\n\nFinally, we compute the plasma resistance, $R_1$:\n$$R_1 = \\eta_1 \\frac{l}{A} = \\eta_1 \\frac{2 \\pi R_0}{\\pi a^2} = (3.360 \\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m}) \\frac{2 \\cdot 3\\,\\mathrm{m}}{(1\\,\\mathrm{m})^2} \\approx 2.016 \\times 10^{-4}\\,\\Omega$$\n\n**Task 4: Evaluation of the initial current decay rate**\n\nThe circuit equation is $L \\, dI/dt + R_1 I_0 = 0$.\n$$\\frac{dI}{dt}\\bigg|_{t=0^{+}} = -\\frac{R_1 I_0}{L} = -\\frac{(2.016 \\times 10^{-4}\\,\\Omega) (10 \\times 10^6\\,\\mathrm{A})}{50 \\times 10^{-6}\\,\\mathrm{H}}$$\n$$\\frac{dI}{dt}\\bigg|_{t=0^{+}} = -4.032 \\times 10^7 \\,\\mathrm{A/s} = -40.32 \\,\\mathrm{MA/s}$$\nRounding to three significant figures gives $-40.3\\,\\mathrm{MA/s}$.",
            "answer": "$$\\boxed{-40.3}$$"
        },
        {
            "introduction": "A rapid current quench, while necessary, carries a significant risk: the large inductive electric field, $E_{\\parallel}$, can accelerate a population of electrons to relativistic energies, forming a potentially damaging runaway electron beam. The key to preventing this is to increase plasma collisionality so that drag forces overwhelm acceleration. This final practice tasks you with modeling the critical ratio of the accelerating field to the Connor–Hastie critical field, $E_{\\parallel}/E_c$, which determines runaway formation . By simulating the evolution of plasma parameters during a mitigated disruption, you will investigate the conditions under which massive impurity injection successfully suppresses runaway generation.",
            "id": "3947754",
            "problem": "You are asked to construct, analyze, and implement a zero-dimensional (0D) model to quantify the parallel electric field to Connor–Hastie critical field ratio during a current quench driven by impurity assimilation from Massive Gas Injection (MGI) or Shattered Pellet Injection (SPI). Use the following principled bases: Faraday’s law for a toroidal circuit, resistive magnetohydrodynamics relations, and the Connor–Hastie critical field. The objective is to compute the time evolution of the dimensionless ratio $E_\\parallel/E_c$ and determine whether impurity-induced collisionality drives the system into the collisional regime $E_\\parallel/E_c < 1$ during the quench.\n\nModel assumptions and definitions to be used:\n- Treat the plasma as a single toroidal circuit of self-inductance $L$ carrying current $I(t)$ around a loop of length $l = 2\\pi R_0$, where $R_0$ is the major radius, and with an effective current-carrying cross-sectional area $A = \\pi a^2$, where $a$ is the minor radius.\n- The loop voltage is $V = L\\,dI/dt$, and the spatially averaged parallel electric field is $E_\\parallel = V/l$.\n- The resistive Ohm’s law is $E_\\parallel = \\eta(T_e,Z_{\\mathrm{eff}})\\,I/A$, where the Spitzer resistivity is modeled as\n$$\n\\eta(T_e,Z_{\\mathrm{eff}}) = C_\\eta\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_e^{3/2}},\n$$\nwith $T_e$ in electronvolts and $C_\\eta = 5.2\\times 10^{-5}\\ \\mathrm{\\Omega\\cdot m\\cdot eV^{3/2}}$ a commonly used constant for fully ionized plasmas.\n- The Connor–Hastie critical field is\n$$\nE_c(n_e,\\ln\\Lambda)=\\frac{n_e\\,e^3\\,\\ln\\Lambda}{4\\pi\\,\\varepsilon_0^2\\,m_e\\,c^2},\n$$\nwhere $n_e$ is the electron number density (in $\\mathrm{m^{-3}}$), $e$ is the elementary charge, $\\varepsilon_0$ is the vacuum permittivity, $m_e$ is the electron mass, $c$ is the speed of light, and $\\ln\\Lambda$ is the Coulomb logarithm.\n\nDynamics and parametrizations:\n- The plasma current obeys the circuit equation:\n$$\n\\frac{dI}{dt} = -\\frac{R_p(t)}{L}\\,I(t),\\qquad R_p(t) = \\frac{\\eta(T_e(t),Z_{\\mathrm{eff}}(t))\\,l}{A}.\n$$\n- Represent impurity-driven cooling and ionization by the following time-dependent functions (starting at $t=0$):\n$$\nT_e(t) = T_{e0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_T}\\right),\\quad Z_{\\mathrm{eff}}(t) = Z_0 + \\Delta Z\\left(1 - e^{-t/\\tau_Z}\\right),\\quad n_e(t) = n_{e0} + \\Delta n\\left(1 - e^{-t/\\tau_n}\\right).\n$$\nThese capture strong radiative cooling and rapid density rise due to impurity assimilation during MGI/SPI, as well as an increase in effective charge state.\n\nComputational target:\n- Numerically integrate the above 0D model over a fixed window $t\\in[0,t_{\\mathrm{end}}]$ with a uniform time step $\\Delta t$, compute $E_\\parallel(t)=\\eta(T_e(t),Z_{\\mathrm{eff}}(t))\\,I(t)/A$, compute $E_c(t)$, and form the ratio $r(t)=E_\\parallel(t)/E_c(t)$.\n- For each test case, report two quantities:\n  1. The maximum value of $r(t)$ over the modeled window, as a float rounded to three decimals.\n  2. A binary indicator (integer $0$ or $1$) answering whether collisional suppression is achieved after a short transient: define $t_{\\mathrm{check}}$ as the start of the evaluation window and return $1$ if $r(t)\\le 1$ for all $t\\in[t_{\\mathrm{check}},t_{\\mathrm{end}}]$, else return $0$.\n\nRequired units and numerical specifications:\n- Use International System of Units (SI) for all physical quantities except $T_e$, which must be in electronvolts when used in the resistivity formula.\n- All distances in meters, time in seconds, current in amperes, resistivity in $\\mathrm{\\Omega\\cdot m}$, and electric field in $\\mathrm{V/m}$.\n- Use $t_{\\mathrm{end}} = 0.02$ (seconds), $\\Delta t = 1.0\\times 10^{-5}$ (seconds), and $t_{\\mathrm{check}} = 0.002$ (seconds). When evaluating the resistivity, enforce a floor $T_e(t)\\ge 1$ (electronvolts) to avoid divergence as $T_e\\to 0$.\n\nTest suite:\nProvide results for the following three parameter sets, designed to probe distinct regimes:\n\n- Case A (strong assimilation and cooling; expected collisional regime):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 1.0\\times 10^{-3}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 10.0$, $\\tau_Z = 1.5\\times 10^{-3}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 5.0\\times 10^{20}$, $\\tau_n = 1.0\\times 10^{-3}$,\n  - $\\ln\\Lambda = 15.0$.\n\n- Case B (weak assimilation; likely runaway-favorable):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 3.0\\times 10^{-3}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 3.0$, $\\tau_Z = 3.0\\times 10^{-3}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 5.0\\times 10^{19}$, $\\tau_n = 3.0\\times 10^{-3}$,\n  - $\\ln\\Lambda = 15.0$.\n\n- Case C (very strong assimilation and ultra-fast cooling; robust suppression):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 5.0\\times 10^{-4}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 20.0$, $\\tau_Z = 8.0\\times 10^{-4}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 1.0\\times 10^{21}$, $\\tau_n = 6.0\\times 10^{-4}$,\n  - $\\ln\\Lambda = 15.0$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by test case and flattened such that for Case A the pair appears first, then Case B, then Case C. The list must contain six entries: `[r_max^(A),flag^(A),r_max^(B),flag^(B),r_max^(C),flag^(C)]`, where each $r_{\\max}$ is rounded to three decimals and each flag is the integer $1$ or $0$ as defined above.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and self-contained. The task is to construct and solve a zero-dimensional ($0$D) model for the evolution of plasma current and key parameters during a tokamak disruption mitigated by impurity injection. The solution will proceed by numerically integrating the governing equations.\n\nThe core of the model is the circuit equation for the total plasma current, $I(t)$, where the plasma is treated as a single toroidal inductor with self-inductance $L$ and resistance $R_p(t)$. From Faraday's law, the evolution of the current is described by the first-order ordinary differential equation:\n$$\n\\frac{dI(t)}{dt} = -\\frac{R_p(t)}{L}I(t)\n$$\nwith an initial condition $I(t=0) = I_0$. The plasma resistance $R_p(t)$ is time-dependent due to the rapid evolution of plasma parameters during the disruption. For a torus of major radius $R_0$ and minor radius $a$, the resistance is given by:\n$$\nR_p(t) = \\frac{\\eta(t)l}{A}\n$$\nwhere $l = 2\\pi R_0$ is the toroidal circumference and $A = \\pi a^2$ is the current-carrying cross-sectional area. The plasma resistivity, $\\eta(t)$, is described by the Spitzer model, which is a function of the electron temperature $T_e(t)$ and the effective ionic charge $Z_{\\mathrm{eff}}(t)$:\n$$\n\\eta(T_e(t), Z_{\\mathrm{eff}}(t)) = C_\\eta\\,\\frac{Z_{\\mathrm{eff}}(t)\\,\\ln\\Lambda}{T_e(t)^{3/2}}\n$$\nHere, $C_\\eta = 5.2\\times 10^{-5}\\ \\mathrm{\\Omega\\cdot m\\cdot eV^{3/2}}$ is a constant, and $T_e$ must be in units of electronvolts. The dynamics of the disruption are modeled through prescribed functions for the evolution of temperature, effective charge, and electron density, capturing the effects of impurity-driven cooling and ionization:\n$$\nT_e(t) = T_{e0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_T}\\right)\n$$\n$$\nZ_{\\mathrm{eff}}(t) = Z_0 + \\Delta Z\\left(1 - e^{-t/\\tau_Z}\\right)\n$$\n$$\nn_e(t) = n_{e0} + \\Delta n\\left(1 - e^{-t/\\tau_n}\\right)\n$$\nThe primary quantity of interest is the ratio of the parallel electric field, $E_\\parallel(t)$, to the Connor-Hastie critical field, $E_c(t)$. The parallel electric field is driven by the plasma's resistivity and is calculated using Ohm's law:\n$$\nE_\\parallel(t) = \\eta(t)\\frac{I(t)}{A}\n$$\nThe Connor-Hastie critical field is the threshold above which electrons are continually accelerated, becoming \"runaway\" electrons. It depends on the electron density $n_e(t)$ and the Coulomb logarithm $\\ln\\Lambda$:\n$$\nE_c(t)=\\frac{n_e(t)\\,e^3\\,\\ln\\Lambda}{4\\pi\\,\\varepsilon_0^2\\,m_e\\,c^2}\n$$\nwhere $e$, $\\varepsilon_0$, $m_e$, and $c$ are fundamental physical constants. We are tasked with computing the ratio $r(t) = E_\\parallel(t)/E_c(t)$.\n\nTo solve the system, we employ a numerical approach. The ODE for the current $I(t)$ is solved using the forward Euler method, consistent with the problem's specification of a fixed time step $\\Delta t$. Discretizing time as $t_k = k\\Delta t$, the current at step $k+1$ is updated from step $k$ as:\n$$\nI_{k+1} = I_k + \\Delta t \\left(-\\frac{R_p(t_k)}{L}I_k\\right) = I_k \\left(1 - \\frac{R_p(t_k)\\Delta t}{L}\\right)\n$$\nThe algorithm proceeds as follows:\nFirst, we establish the time grid from $t=0$ to $t=t_{\\mathrm{end}}$ with spacing $\\Delta t=1.0\\times 10^{-5}\\ \\mathrm{s}$. All time-dependent parameters ($T_e, Z_{\\mathrm{eff}}, n_e, \\eta, R_p$) are evaluated at each point on this grid, forming arrays of values. The required temperature floor of $T_e \\ge 1\\ \\mathrm{eV}$ is enforced.\nSecond, the current $I(t)$ is calculated iteratively. Starting with $I_0$, the forward Euler scheme is applied step-by-step to find the current at all subsequent time points. This part of the calculation is inherently sequential.\nThird, once the time series for $I(t)$ is known, the arrays for the parallel electric field $E_\\parallel(t_k)$ and the critical field $E_c(t_k)$ are computed.\nFinally, the ratio $r(t_k) = E_\\parallel(t_k)/E_c(t_k)$ is calculated for all time points. From this final array, two metrics are extracted for each test case:\n1. The maximum value of the ratio, $r_{\\max} = \\max_k \\{r(t_k)\\}$, over the entire simulation window $t \\in [0, t_{\\mathrm{end}}]$.\n2. A binary flag indicating whether collisional runaway electron suppression is achieved. This flag is set to $1$ if $r(t_k) \\le 1$ for all time points $t_k \\ge t_{\\mathrm{check}} = 0.002\\ \\mathrm{s}$, and $0$ otherwise.\n\nThe implementation is carried out in Python, leveraging the `numpy` library for efficient vectorized computations where possible (e.g., evaluating the analytical functions for plasma parameters). The physical constants are taken from standard sources in SI units. The procedure is repeated for each of the three parameter sets provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 0D model for current quench dynamics and evaluates the\n    E/Ec ratio for three different test cases.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_E = 9.10938356e-31       # Electron mass in kg\n    EPS0 = 8.854187817e-12      # Vacuum permittivity in F/m\n    C_LIGHT = 299792458         # Speed of light in m/s\n    PI = np.pi\n\n    # Model-specific constant\n    C_ETA = 5.2e-5  # Resistivity constant in Omega*m*eV^(3/2)\n\n    def run_simulation(params):\n        \"\"\"\n        Runs the simulation for a single set of parameters.\n        \"\"\"\n        # Unpack parameters\n        R0, a, L, I0 = params['geo']\n        Te0, tau_T = params['Te']\n        Z0, dZ, tau_Z = params['Zeff']\n        ne0, dn, tau_n = params['ne']\n        ln_Lambda = params['lnL']\n\n        # Numerical specifications from the problem\n        t_end = 0.02\n        dt = 1.0e-5\n        t_check = 0.002\n        Te_floor = 1.0\n\n        # Derived geometric parameters\n        l = 2 * PI * R0  # Toroidal circumference\n        A = PI * a**2    # Cross-sectional area\n\n        # Create time array\n        t_array = np.arange(0, t_end + dt, dt)\n        n_steps = len(t_array)\n\n        # Calculate time-dependent plasma parameters in a vectorized manner\n        Te_array = Te0 * np.exp(-t_array / tau_T)\n        Te_array = np.maximum(Te_array, Te_floor)  # Apply temperature floor\n\n        Zeff_array = Z0 + dZ * (1 - np.exp(-t_array / tau_Z))\n        ne_array = ne0 + dn * (1 - np.exp(-t_array / tau_n))\n\n        # Calculate time-dependent Spitzer resistivity and plasma resistance\n        eta_array = C_ETA * Zeff_array * ln_Lambda / (Te_array**1.5)\n        Rp_array = eta_array * l / A\n\n        # Solve for current I(t) using the forward Euler method\n        I_array = np.zeros(n_steps)\n        I_array[0] = I0\n        for k in range(n_steps - 1):\n            I_array[k+1] = I_array[k] * (1 - Rp_array[k] * dt / L)\n\n        # Calculate the parallel electric field from Ohm's law\n        E_parallel_array = eta_array * I_array / A\n        \n        # Calculate the Connor-Hastie critical field\n        Ec_const = (E_CHARGE**3) / (4 * PI * EPS0**2 * M_E * C_LIGHT**2)\n        Ec_array = Ec_const * ne_array * ln_Lambda\n\n        # Calculate the ratio r(t) = E_parallel / E_c\n        r_array = E_parallel_array / Ec_array\n\n        # Compute the two required output quantities\n        # 1. Maximum value of r(t) over the full time window\n        r_max = np.max(r_array)\n\n        # 2. Collisional suppression flag for t >= t_check\n        check_idx = np.searchsorted(t_array, t_check)\n        is_suppressed = np.all(r_array[check_idx:] <= 1.0)\n        flag = 1 if is_suppressed else 0\n        \n        return round(r_max, 3), flag\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: strong assimilation and cooling\n        {\n            'geo': (3.0, 1.0, 1.0e-6, 5.0e6), 'Te': (3.0e3, 1.0e-3),\n            'Zeff': (2.0, 10.0, 1.5e-3), 'ne': (7.0e19, 5.0e20, 1.0e-3),\n            'lnL': 15.0\n        },\n        # Case B: weak assimilation\n        {\n            'geo': (3.0, 1.0, 1.0e-6, 5.0e6), 'Te': (3.0e3, 3.0e-3),\n            'Zeff': (2.0, 3.0, 3.0e-3), 'ne': (7.0e19, 5.0e19, 3.0e-3),\n            'lnL': 15.0\n        },\n        # Case C: very strong assimilation and ultra-fast cooling\n        {\n            'geo': (3.0, 1.0, 1.0e-6, 5.0e6), 'Te': (3.0e3, 5.0e-4),\n            'Zeff': (2.0, 20.0, 8.0e-4), 'ne': (7.0e19, 1.0e21, 6.0e-4),\n            'lnL': 15.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        r_max_val, flag_val = run_simulation(case)\n        results.extend([r_max_val, flag_val])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}