{
    "hands_on_practices": [
        {
            "introduction": "先进的破裂缓解技术，如碎屑注入（SPI）和大规模气体注入（MGI），其有效性关键在于注入的杂质能够快速辐射掉等离子体的热能。本练习提供了一个基础性的动手计算，旨在基于一个简化但物理上深刻的碰撞辐射模型，来估算这种辐射功率。通过解决这个问题 ，您将掌握控制冷却效率的关键参数，例如电子温度 $T_e$ 和杂质密度 $n_Z$。",
            "id": "3947737",
            "problem": "在磁约束聚变中通过碎屑丸注入（Shattered Pellet Injection, SPI）和大量气体注入（Massive Gas Injection, MGI）进行破裂缓解的背景下，考虑一个由单个氩丸碎片穿过边界等离子体时产生的烧蚀云。假设以下简化的、光学薄的、碰撞模型，该模型与部分电离、低温云团中线辐射的日冕近似一致：\n\n- 电子呈Maxwellian分布，具有均匀的电子温度 $T_{e}$（以电子伏特为单位），且 $T_{e}$ 在云团内部近似恒定。\n- 云团内部的氩杂质密度是均匀的，等于 $n_{Z}$。\n- 固定电离分数 $x_{i}$ 的氩是单次电离的，而分数 $f_{\\ell}=1-x_{i}$ 的氩保持在中性基态。主要的辐射损失是来自中性基态经电子碰撞激发后发射的单个强光学薄谱线，其光子能量为 $E_{0}$（以电子伏特为单位）。\n- 这条谱线的有效碰撞激发速率系数由 $\\langle \\sigma v \\rangle = C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e})$ 建模，其中 $C_{0}$ 是一个常数，单位为 $\\mathrm{m^{3}\\,s^{-1}\\,eV^{1/2}}$，$T_{e}$ 以电子伏特为单位。\n- 云团中的局部电子密度为 $n_{e}=n_{e0}+x_{i}\\,n_{Z}$，其中 $n_{e0}$ 是背景电子密度。\n- 每次电子碰撞激发产生一个能量为 $E_{0}$ 的光子，该光子会逃逸（光学薄）。要将电子伏特转换为焦耳，请使用元电荷 $q_{e}$。\n\n仅使用Maxwellian电子的动理论、理想气体概念以及光学薄线辐射平衡，推导烧蚀云的体辐射功率密度 $p_{\\mathrm{rad}}(T_{e},n_{Z})$，用 $T_{e}$ 和 $n_{Z}$ 表示。然后，假设每个碎片形成一个半径为 $R_{c}$ 的球形云团，其内部具有均匀的 $T_{e}$ 和 $n_{Z}$，通过对所有碎片求和，计算 $N$ 个相同且不重叠的碎片的全局总辐射功率 $P_{\\mathrm{rad,global}}$。\n\n使用以下适用于氩SPI碎片与低温边界等离子体相互作用的、科学上合理的参数：\n- $E_{0}=15.0\\,\\mathrm{eV}$，\n- $C_{0}=1.5\\times 10^{-14}\\,\\mathrm{m^{3}\\,s^{-1}\\,eV^{1/2}}$，\n- $T_{e}=10.0\\,\\mathrm{eV}$，\n- $n_{Z}=5.0\\times 10^{20}\\,\\mathrm{m^{-3}}$，\n- $x_{i}=0.10$ 因此 $f_{\\ell}=0.90$，\n- $n_{e0}=3.0\\times 10^{19}\\,\\mathrm{m^{-3}}$，\n- $R_{c}=0.060\\,\\mathrm{m}$，\n- $N=200$ 个碎片，\n- $q_{e}=1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n\n说明：\n1. 使用上述模型和假设，推导 $p_{\\mathrm{rad}}(T_{e},n_{Z})$ 的解析表达式。\n2. 使用给定参数对表达式进行数值计算，以获得单个碎片的辐射功率 $P_{\\mathrm{shard}}$，然后计算 $P_{\\mathrm{rad,global}}=N\\,P_{\\mathrm{shard}}$。\n3. 以兆瓦为单位表示最终的全局辐射功率，并将答案四舍五入到三位有效数字。最终方框内的答案不要包含单位。",
            "solution": "该问题陈述已经过严格评估，并被确定为有效。它在一个简化但合理的物理模型背景下具有科学依据，提法恰当，并提供了所有必要信息，且以客观、正式的语言表述。用于碰撞线辐射的模型是等离子体物理教学问题中的标准模型，并且所给参数代表了碎屑丸注入事件期间等离子体边界的典型条件。因此，我们可以着手求解。\n\n主要任务是推导体辐射功率密度 $p_{\\mathrm{rad}}$，并由此计算出所有丸碎片的总辐射功率。\n\n首先，我们确定单位体积内的电子碰撞激发事件率 $R_{\\mathrm{ex}}$。该率是靶粒子密度、轰击粒子密度和反应速率系数的乘积。\n在此模型中，靶粒子是处于基态的中性氩原子。它们的数密度 $n_{\\text{neutral}}$ 由总氩密度 $n_{Z}$ 乘以中性分数 $f_{\\ell}$ 给出。\n$$n_{\\text{neutral}} = f_{\\ell} n_{Z} = (1 - x_{i}) n_{Z}$$\n轰击粒子是电子，其数密度为 $n_{e}$。\n激发过程的速率系数为 $\\langle \\sigma v \\rangle = C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e})$。\n因此，体激发率为：\n$$R_{\\mathrm{ex}} = n_{e} \\cdot n_{\\text{neutral}} \\cdot \\langle \\sigma v \\rangle = n_{e} (1 - x_{i}) n_{Z} C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e})$$\n\n问题陈述指出，对于所考虑的线辐射，烧蚀云是光学薄的。这个假设意味着每次激发事件后都会发射一个光子，并且每个这样的光子都会逃离云团而不会被重吸收。每个光子携带的能量为 $E_{0}$，以电子伏特为单位。为了以国际单位制（瓦特/立方米）计算功率密度，必须通过乘以元电荷 $q_{e}$ 将此能量转换为焦耳。\n每次事件辐射的能量是 $E_{\\mathrm{photon}} = E_{0} q_{e}$。\n体辐射功率密度 $p_{\\mathrm{rad}}$ 是单位体积内的激发率与每次事件辐射能量的乘积：\n$$p_{\\mathrm{rad}} = R_{\\mathrm{ex}} \\cdot E_{\\mathrm{photon}} = \\left( n_{e} (1 - x_{i}) n_{Z} C_{0}\\,T_{e}^{-1/2}\\exp(-E_{0}/T_{e}) \\right) (E_{0} q_{e})$$\n问题还规定了局部电子密度为 $n_{e} = n_{e0} + x_{i} n_{Z}$。将此 $n_{e}$ 的表达式代入 $p_{\\mathrm{rad}}$ 的方程，得到体辐射功率密度关于给定参数的完整解析表达式：\n$$p_{\\mathrm{rad}}(T_{e}, n_{Z}) = q_{e} E_{0} C_{0} (1 - x_{i}) n_{Z} (n_{e0} + x_{i} n_{Z}) T_{e}^{-1/2} \\exp\\left(-\\frac{E_{0}}{T_{e}}\\right)$$\n\n接下来，我们计算单个球形碎片云辐射的总功率 $P_{\\mathrm{shard}}$。该云团被假定为半径为 $R_{c}$ 的均匀球体。其体积 $V_{c}$ 由球体体积公式给出：\n$$V_{c} = \\frac{4}{3}\\pi R_{c}^{3}$$\n单个碎片辐射的总功率是均匀的体功率密度乘以云团体积：\n$$P_{\\mathrm{shard}} = p_{\\mathrm{rad}} \\cdot V_{c} = \\frac{4}{3}\\pi R_{c}^{3} \\cdot p_{\\mathrm{rad}}$$\n最后，来自 $N$ 个相同且不重叠的碎片的全局总辐射功率 $P_{\\mathrm{rad,global}}$ 就是单个碎片功率的 $N$ 倍：\n$$P_{\\mathrm{rad,global}} = N \\cdot P_{\\mathrm{shard}} = N \\frac{4}{3}\\pi R_{c}^{3} q_{e} E_{0} C_{0} (1 - x_{i}) n_{Z} (n_{e0} + x_{i} n_{Z}) T_{e}^{-1/2} \\exp\\left(-\\frac{E_{0}}{T_{e}}\\right)$$\n\n现在，我们将代入给定的数值以求得最终答案。\n参数如下：\n$E_{0} = 15.0\\,\\mathrm{eV}$\n$C_{0} = 1.5 \\times 10^{-14}\\,\\mathrm{m^{3}\\,s^{-1}\\,eV^{1/2}}$\n$T_{e} = 10.0\\,\\mathrm{eV}$\n$n_{Z} = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$\n$x_{i} = 0.10$\n$n_{e0} = 3.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n$R_{c} = 0.060\\,\\mathrm{m}$\n$N = 200$\n$q_{e} = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n\n首先，我们计算中间量。\n中性分数为 $f_{\\ell} = 1 - x_{i} = 1 - 0.10 = 0.90$。\n云团内部的电子密度为：\n$$n_{e} = n_{e0} + x_{i} n_{Z} = (3.0 \\times 10^{19}) + (0.10)(5.0 \\times 10^{20}) = 3.0 \\times 10^{19} + 5.0 \\times 10^{19} = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$$\n速率系数中的温度因子为：\n$$T_{e}^{-1/2} \\exp\\left(-\\frac{E_{0}}{T_{e}}\\right) = (10.0)^{-1/2} \\exp\\left(-\\frac{15.0}{10.0}\\right) = (10.0)^{-0.5} \\exp(-1.5)$$\n单个碎片云团的体积为：\n$$V_{c} = \\frac{4}{3}\\pi (0.060)^{3} = \\frac{4}{3}\\pi (2.16 \\times 10^{-4})\\,\\mathrm{m^{3}} \\approx 9.0478 \\times 10^{-4}\\,\\mathrm{m^{3}}$$\n现在，我们计算体功率密度 $p_{\\mathrm{rad}}$：\n$$p_{\\mathrm{rad}} = (1.602176634 \\times 10^{-19}) \\cdot (15.0) \\cdot (1.5 \\times 10^{-14}) \\cdot (0.90) \\cdot (5.0 \\times 10^{20}) \\cdot (8.0 \\times 10^{19}) \\cdot (10.0)^{-0.5} \\exp(-1.5)$$\n$$p_{\\mathrm{rad}} \\approx (1.2977 \\times 10^{8}) \\cdot (10.0)^{-0.5} \\exp(-1.5) \\approx 9.1565 \\times 10^{7}\\,\\mathrm{W\\,m^{-3}}$$\n单个碎片的功率为：\n$$P_{\\mathrm{shard}} = p_{\\mathrm{rad}} \\cdot V_{c} \\approx (9.1565 \\times 10^{7}) \\cdot (9.0478 \\times 10^{-4}) \\approx 8.2846 \\times 10^{4}\\,\\mathrm{W}$$\n全局总辐射功率为：\n$$P_{\\mathrm{rad,global}} = N \\cdot P_{\\mathrm{shard}} = 200 \\cdot (8.2846 \\times 10^{4}) \\approx 1.6569 \\times 10^{7}\\,\\mathrm{W}$$\n问题要求答案以兆瓦（$1\\,\\mathrm{MW} = 10^{6}\\,\\mathrm{W}$）为单位。\n$$P_{\\mathrm{rad,global}} \\approx 16.569\\,\\mathrm{MW}$$\n将结果四舍五入到三位有效数字，我们得到 $16.6\\,\\mathrm{MW}$。",
            "answer": "$$\\boxed{16.6}$$"
        },
        {
            "introduction": "在辐射冷却概念的基础上，本实践从静态计算转向动态模拟。我们将构建一个零维（0D）模型来追踪杂质密度 $n_Z(t)$ 和电子温度 $T_e(t)$ 的耦合演化，从而观察可能导致快速热淬灭（即“辐射崩溃”）的非线性反馈过程。这个练习  对于理解缓解破裂过程中的时间动态至关重要。",
            "id": "3947742",
            "problem": "您的任务是构建一个零维（0D）模型，用于模拟在高级破裂缓解（例如碎屑丸注入（SPI）或大量气体注入（MGI））过程中，经历杂质注入的托卡马克等离子体中电子温度的时间演化。该0D模型假设空间均匀，并遵循每个粒子的电子能量平衡，温度以电子伏特表示。其基本出发点是电子能量平衡定律，\n$$\n\\frac{d}{dt}\\left(\\frac{3}{2} n_e k_B T_e\\right) = - P_{\\mathrm{rad}}(t),\n$$\n其中 $n_e$ 是电子数密度，$k_B$ 是玻尔兹曼常数，$T_e$ 是电子温度，$P_{\\mathrm{rad}}(t)$ 是由杂质引起的体辐射功率密度。将两边同时除以 $n_e k_B$ 并将温度用电子伏特表示，引入了从焦耳到电子伏特的转换常数。使用 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$，其中 $e$ 是元电荷，$T_e(t)$ 以电子伏特为单位的演化方程为\n$$\n\\frac{d T_e}{dt} = -\\frac{2}{3} \\frac{P_{\\mathrm{rad}}(t)}{n_e} \\frac{1}{e}.\n$$\n辐射功率密度模型为\n$$\nP_{\\mathrm{rad}}(t) = n_e \\, n_Z(t) \\, \\Lambda_Z\\!\\left(T_e(t)\\right),\n$$\n其中 $n_Z(t)$ 是杂质数密度，$\\Lambda_Z(T_e)$ 是杂质冷却系数。杂质密度在一个源-损失模型下演化，该模型捕捉了SPI/MGI沉积和注入后输运损失的物理过程：\n$$\n\\frac{d n_Z}{dt} = S_0 \\exp\\!\\left(-\\frac{(t-t_0)^2}{2 \\tau_{\\mathrm{inj}}^2}\\right) - \\frac{n_Z}{\\tau_{\\mathrm{loss}}},\n$$\n其中 $S_0$ 代表源强度峰值，$t_0$ 是注入中心时刻，$\\tau_{\\mathrm{inj}}$ 是注入脉冲的特征持续时间，$\\tau_{\\mathrm{loss}}$ 是杂质损失时间。杂质冷却系数被建模为一个具有物理动机的组合，包括线辐射（在几十电子伏特附近达到峰值）和在更高温度下的轫致辐射：\n$$\n\\Lambda_Z(T_e) = \\Lambda_{\\mathrm{line}}(T_e) + \\Lambda_{\\mathrm{brem}}(T_e),\n$$\n其中\n$$\n\\Lambda_{\\mathrm{line}}(T_e) = \\Lambda_{\\mathrm{peak}} \\exp\\!\\left(-\\frac{\\left[\\ln\\!\\left(\\frac{T_e}{T_{\\mathrm{peak}}}\\right)\\right]^2}{2 \\sigma^2}\\right),\n\\qquad\n\\Lambda_{\\mathrm{brem}}(T_e) = C_{\\mathrm{brem}} \\, Z_{\\mathrm{eff}} \\, \\sqrt{T_e},\n$$\n这里 $\\Lambda_{\\mathrm{peak}}$ 设置线辐射强度的峰值，$T_{\\mathrm{peak}}$ 设置线辐射达到峰值时的温度，$\\sigma$ 设置峰在对数温度坐标下的宽度，$C_{\\mathrm{brem}}$ 是轫致辐射系数，$Z_{\\mathrm{eff}}$ 是一个有效电荷参数，代表杂质离子电荷态对轫致辐射的影响。所有温度 $T_e$ 的单位都是电子伏特，数密度的单位是 $\\mathrm{m}^{-3}$，时间的单位是秒，功率密度的单位是 $\\mathrm{W/m^3}$。电子温度必须以电子伏特（eV）计算，并根据上述模型演化。\n\n当电子温度 $T_e(t)$ 低于指定的下限 $T_{\\mathrm{floor}}$（单位为电子伏特）时，即认为发生辐射坍缩。目标是为 $T_e(t)$ 和 $n_Z(t)$ 的耦合系统实现一个计算求解器，确定在指定的最大模拟时间内是否发生辐射坍缩，如果发生，则报告坍缩时间。\n\n使用固定的时间步长对模型进行数值实现，并评估以下四个测试案例。对于每个测试案例，从 $T_e(0)=T_{e0}$ 和 $n_Z(0)=0$ 开始，使用均匀的时间步长 $\\Delta t$ 进行时间积分。当 $T_e(t) \\le T_{\\mathrm{floor}}$ 时检测到坍缩。如果在最大时间 $t_{\\max}$ 内未发生坍缩，则报告坍缩时间为 $-1.0$。在所有案例中均使用以下常数：\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}$，\n- $\\Lambda_{\\mathrm{peak}} = 3.0 \\times 10^{-32}\\,\\mathrm{W\\,m^3}$，\n- $T_{\\mathrm{peak}} = 50\\,\\mathrm{eV}$，\n- $\\sigma = 0.7$ (无量纲)，\n- $C_{\\mathrm{brem}} = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m^3\\,eV^{-1/2}}$。\n\n测试套件（所有单位都已明确指出；不使用角度）：\n1. 强注入（正常路径）：\n   - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，\n   - $T_{e0} = 2000\\,\\mathrm{eV}$，\n   - $Z_{\\mathrm{eff}} = 18$，\n   - $S_0 = 5.0 \\times 10^{22}\\,\\mathrm{m^{-3}\\,s^{-1}}$，\n   - $t_0 = 0.010\\,\\mathrm{s}$，\n   - $\\tau_{\\mathrm{inj}} = 0.005\\,\\mathrm{s}$，\n   - $\\tau_{\\mathrm{loss}} = 0.020\\,\\mathrm{s}$，\n   - $T_{\\mathrm{floor}} = 5\\,\\mathrm{eV}$，\n   - $t_{\\max} = 0.100\\,\\mathrm{s}$，\n   - $\\Delta t = 1.0 \\times 10^{-5}\\,\\mathrm{s}$。\n2. 无注入（边界情况）：\n   - 与案例1相同，除了 $S_0 = 0$。\n3. 弱注入（近边界情况）：\n   - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，\n   - $T_{e0} = 2000\\,\\mathrm{eV}$，\n   - $Z_{\\mathrm{eff}} = 18$，\n   - $S_0 = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}\\,s^{-1}}$，\n   - $t_0 = 0.010\\,\\mathrm{s}$，\n   - $\\tau_{\\mathrm{inj}} = 0.003\\,\\mathrm{s}$，\n   - $\\tau_{\\mathrm{loss}} = 0.030\\,\\mathrm{s}$，\n   - $T_{\\mathrm{floor}} = 5\\,\\mathrm{eV}$，\n   - $t_{\\max} = 0.100\\,\\mathrm{s}$，\n   - $\\Delta t = 1.0 \\times 10^{-5}\\,\\mathrm{s}$。\n4. 快速杂质损失（边缘情况）：\n   - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，\n   - $T_{e0} = 2000\\,\\mathrm{eV}$，\n   - $Z_{\\mathrm{eff}} = 18$，\n   - $S_0 = 5.0 \\times 10^{21}\\,\\mathrm{m^{-3}\\,s^{-1}}$，\n   - $t_0 = 0.010\\,\\mathrm{s}$，\n   - $\\tau_{\\mathrm{inj}} = 0.005\\,\\mathrm{s}$，\n   - $\\tau_{\\mathrm{loss}} = 5.0 \\times 10^{-4}\\,\\mathrm{s}$，\n   - $T_{\\mathrm{floor}} = 5\\,\\mathrm{eV}$，\n   - $t_{\\max} = 0.100\\,\\mathrm{s}$，\n   - $\\Delta t = 1.0 \\times 10^{-5}\\,\\mathrm{s}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果必须是一个双元素列表 $[b, t]$，其中 $b$ 是一个布尔值，指示是否发生辐射坍缩，$t$ 是以秒为单位的浮点数坍缩时间；如果未发生坍缩，$t$ 必须为 $-1.0$。例如，输出格式必须与以下完全相同：\n$$\n\\text{[}[b_1, t_1],[b_2, t_2],[b_3, t_3],[b_4, t_4]\\text{]}.\n$$\n输出中的所有时间都必须以秒表示，并四舍五入到六位小数（使用标准的浮点数四舍五入）。",
            "solution": "用户提供了一个问题，要求构建一个零维（0D）计算模型，以模拟在破裂缓解事件中托卡马克等离子体内电子温度 $T_e(t)$ 和杂质数密度 $n_Z(t)$ 的时间演化。任务是求解控制性的耦合常微分方程组（ODEs），确定是否发生“辐射坍缩”，并报告坍缩时间。\n\n首先，确认问题的有效性。它在科学上基于等离子体物理学原理，构成了一个定义明确的初值问题，并提供了所有必要的参数、方程和初始条件。语言是客观的，参数对于所模拟的场景在物理上是合理的。因此，可以制定一个解决方案。\n\n问题的核心是求解以下包含两个耦合一阶常微分方程的系统：\n$$\n\\frac{d n_Z}{dt} = S_0 \\exp\\!\\left(-\\frac{(t-t_0)^2}{2 \\tau_{\\mathrm{inj}}^2}\\right) - \\frac{n_Z}{\\tau_{\\mathrm{loss}}}\n$$\n$$\n\\frac{d T_e}{dt} = -\\frac{2}{3e} n_Z(t) \\, \\Lambda_Z\\!\\left(T_e(t)\\right)\n$$\n变量和函数如下：\n- $t$: 时间，单位为秒 ($s$)。\n- $n_Z(t)$: 杂质数密度，单位为 $m^{-3}$。\n- $T_e(t)$: 电子温度，单位为电子伏特 ($eV$)。\n- $S_0, t_0, \\tau_{\\mathrm{inj}}, \\tau_{\\mathrm{loss}}$: 定义杂质注入源和损失的参数。\n- $e$: 元电荷, $1.602176634 \\times 10^{-19} \\, J/eV$。\n- $\\Lambda_Z(T_e)$: 总杂质冷却系数，单位为 $W m^3$，是线辐射和轫致辐射分量的总和。\n\n冷却系数 $\\Lambda_Z(T_e)$ 由下式给出：\n$$\n\\Lambda_Z(T_e) = \\Lambda_{\\mathrm{line}}(T_e) + \\Lambda_{\\mathrm{brem}}(T_e)\n$$\n其中，在较低温度下占主导地位的线辐射项由一个对数正态函数建模：\n$$\n\\Lambda_{\\mathrm{line}}(T_e) = \\Lambda_{\\mathrm{peak}} \\exp\\!\\left(-\\frac{\\left[\\ln\\!\\left(\\frac{T_e}{T_{\\mathrm{peak}}}\\right)\\right]^2}{2 \\sigma^2}\\right)\n$$\n而在较高温度下变得更显著的轫致辐射项被建模为：\n$$\n\\Lambda_{\\mathrm{brem}}(T_e) = C_{\\mathrm{brem}} \\, Z_{\\mathrm{eff}} \\, \\sqrt{T_e}\n$$\n参数 $\\Lambda_{\\mathrm{peak}}$、$T_{\\mathrm{peak}}$、$\\sigma$、$C_{\\mathrm{brem}}$ 和 $Z_{\\mathrm{eff}}$ 是表征特定杂质辐射特性的给定常数。请注意，电子密度 $n_e$ 在最终的 $\\frac{dT_e}{dt}$ 方程中被消去，但在问题陈述中与其他参数一起使用，以提供完整的物理背景。\n\n问题指定使用固定的时间步长 $\\Delta t$ 进行数值求解，初始条件为 $T_e(0) = T_{e0}$ 和 $n_Z(0) = 0$。实现此目的最直接的方法是前向欧拉法。对于形式为 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(t, \\mathbf{y})$ 的常微分方程组，其中 $\\mathbf{y} = [n_Z, T_e]^T$，在时间 $t_{i+1} = t_i + \\Delta t$ 的状态可以从时间 $t_i$ 的状态近似得出：\n$$\n\\mathbf{y}_{i+1} = \\mathbf{y}_i + \\Delta t \\, \\mathbf{F}(t_i, \\mathbf{y}_i)\n$$\n将此方法应用于我们的特定系统，每个时间步的更新规则为：\n$$\nn_{Z, i+1} = n_{Z, i} + \\Delta t \\left[ S_0 \\exp\\!\\left(-\\frac{(t_i-t_0)^2}{2 \\tau_{\\mathrm{inj}}^2}\\right) - \\frac{n_{Z, i}}{\\tau_{\\mathrm{loss}}} \\right]\n$$\n$$\nT_{e, i+1} = T_{e, i} - \\Delta t \\left[ \\frac{2}{3e} n_{Z, i} \\, \\Lambda_Z(T_{e, i}) \\right]\n$$\n其中 $t_i = i \\cdot \\Delta t$，$n_{Z,i} = n_Z(t_i)$，以及 $T_{e,i} = T_e(t_i)$。\n\n对于每个测试案例，算法按以下步骤进行：\n1. 在时间 $t=0$ 初始化状态变量：$t_0 = 0$，$T_{e,0} = T_{e0}$（来自特定测试案例），以及 $n_{Z,0}=0$。\n2. 确定总模拟步数，$N = \\text{int}(t_{\\max}/\\Delta t)$。\n3. 从 $i=0$ 迭代到 $N-1$。在每次迭代中，代表时间向前迈出一步：\n    a. 设当前时间为 $t_i = i \\cdot \\Delta t$。\n    b. 检查坍缩条件：如果 $T_{e,i} \\le T_{\\mathrm{floor}}$，则此案例的模拟终止。认为发生了坍缩，并将坍缩时间记录为 $t_i$。\n    c. 如果没有发生坍缩，则使用 $t_i$、$n_{Z,i}$ 和 $T_{e,i}$ 的值计算导数 $\\frac{dn_Z}{dt}$ 和 $\\frac{dT_e}{dt}$。\n    d. 使用上述前向欧拉公式将状态变量更新为 $n_{Z,i+1}$ 和 $T_{e,i+1}$。\n4. 如果循环完成而未满足坍缩条件，则意味着在整个持续时间 $t_{\\max}$ 内温度保持在 $T_{\\mathrm{floor}}$ 以上。在这种情况下，没有发生坍缩，坍缩时间报告为 $-1.0$。\n5. 每个案例的最终结果是一对 $[b, t]$，其中 $b$ 是一个布尔值（`True`表示坍缩，`False`表示未坍缩），$t$ 是四舍五入到六位小数的坍缩时间（或 $-1.0$）。\n\n此过程应用于所有四个指定的测试案例，这些案例旨在探测不同的物理区域：一个标准成功的热淬熄（案例1），一个没有杂质注入的基准线（案例2），一个注入较弱可能不足以导致坍缩的场景（案例3），以及一个快速杂质输运损失抵消冷却效应的案例（案例4）。",
            "answer": "[[true, 0.021570], [false, -1.0], [false, -1.0], [false, -1.0]]"
        },
        {
            "introduction": "破裂缓解的最终挑战是在不产生高能逃逸电子束的情况下控制电流淬灭。本实践  聚焦于这一关键问题，通过建模感应电场 $E_\\parallel$ 与逃逸临界电场 $E_c$ 的比值来评估风险。通过在不同的杂质注入情景下模拟这一比值，我们可以探索如何维持等离子体的高碰撞性以有效抑制逃逸电子的产生。",
            "id": "3947754",
            "problem": "您需要构建、分析并实现一个零维（0D）模型，用以量化由大量气体注入（MGI）或碎裂弹丸注入（SPI）引起的杂质同化所驱动的电流猝灭过程中，平行电场与 Connor–Hastie 临界场的比值。请使用以下基本原理：环形电路的法拉第定律、电阻磁流体动力学关系以及 Connor–Hastie 临界场。目标是计算无量纲比值 $E/E_c$ 的时间演化，并确定杂质引起的碰撞性是否在猝灭期间将系统驱动至碰撞区 $E/E_c  1$。\n\n使用的模型假设和定义：\n- 将等离子体视为一个自感为 $L$ 的单一环形电路，电流 $I(t)$ 沿长度为 $l = 2\\pi R_0$（其中 $R_0$ 为大半径）的环路流动，其有效载流截面积为 $A = \\pi a^2$（其中 $a$ 为小半径）。\n- 环路电压为 $V = L\\,dI/dt$，空间平均的平行电场为 $E_\\parallel = V/l$。\n- 电阻欧姆定律为 $E_\\parallel = \\eta(T_e,Z_{\\mathrm{eff}})\\,I/A$，其中 Spitzer 电阻率模型如下\n$$\n\\eta(T_e,Z_{\\mathrm{eff}}) = C_\\eta\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_e^{3/2}},\n$$\n其中 $T_e$ 的单位为电子伏特，$C_\\eta = 5.2\\times 10^{-5}\\ \\mathrm{\\Omega\\cdot m\\cdot eV^{3/2}}$ 是完全电离等离子体中常用的常数。\n- Connor–Hastie 临界场为\n$$\nE_c(n_e,\\ln\\Lambda)=\\frac{n_e\\,e^3\\,\\ln\\Lambda}{4\\pi\\,\\varepsilon_0^2\\,m_e\\,c^2},\n$$\n其中 $n_e$ 是电子数密度（单位为 $\\mathrm{m^{-3}}$），$e$ 是基本电荷，$\\varepsilon_0$ 是真空介电常数，$m_e$ 是电子质量，$c$ 是光速，$\\ln\\Lambda$ 是库仑对数。\n\n动力学和参数化：\n- 等离子体电流遵循电路方程：\n$$\n\\frac{dI}{dt} = -\\frac{R_p(t)}{L}\\,I(t),\\qquad R_p(t) = \\frac{\\eta(T_e(t),Z_{\\mathrm{eff}}(t))\\,l}{A}.\n$$\n- 使用以下随时间变化的函数（从 $t=0$ 开始）来表示杂质驱动的冷却和电离：\n$$\nT_e(t) = T_{e0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_T}\\right),\\quad Z_{\\mathrm{eff}}(t) = Z_0 + \\Delta Z\\left(1 - e^{-t/\\tau_Z}\\right),\\quad n_e(t) = n_{e0} + \\Delta n\\left(1 - e^{-t/\\tau_n}\\right).\n$$\n这些函数捕捉了 MGI/SPI 过程中由杂质同化引起的强辐射冷却和密度快速上升，以及有效电荷态的增加。\n\n计算目标：\n- 在固定时间窗口 $t\\in[0,t_{\\mathrm{end}}]$ 内，使用均匀时间步长 $\\Delta t$ 对上述 0D 模型进行数值积分，计算 $E_\\parallel(t)=\\eta(T_e(t),Z_{\\mathrm{eff}}(t))\\,I(t)/A$ 和 $E_c(t)$，并构成比值 $r(t)=E_\\parallel(t)/E_c(t)$。\n- 对每个测试案例，报告两个量：\n  1. 在模拟窗口内 $r(t)$ 的最大值，以浮点数表示，四舍五入到三位小数。\n  2. 一个二进制指示符（整数 $0$ 或 $1$），回答在短暂的瞬态过程后是否实现了碰撞抑制：定义评估窗口的起始时间为 $t_{\\mathrm{check}}$，如果对于所有 $t\\in[t_{\\mathrm{check}},t_{\\mathrm{end}}]$ 都有 $r(t)\\le 1$，则返回 $1$，否则返回 $0$。\n\n要求的单位和数值规范：\n- 除 $T_e$ 外，所有物理量均使用国际单位制（SI）。在电阻率公式中，$T_e$ 必须以电子伏特为单位。\n- 所有距离单位为米，时间单位为秒，电流单位为安培，电阻率单位为 $\\mathrm{\\Omega\\cdot m}$，电场单位为 $\\mathrm{V/m}$。\n- 使用 $t_{\\mathrm{end}} = 0.02$ (秒)，$\\Delta t = 1.0\\times 10^{-5}$ (秒)，以及 $t_{\\mathrm{check}} = 0.002$ (秒)。在计算电阻率时，强制设置温度下限 $T_e(t)\\ge 1$ (电子伏特) 以避免 $T_e\\to 0$ 时出现发散。\n\n测试套件：\n提供以下三组参数集的结果，这些参数集旨在探究不同的物理机制区：\n\n- 案例 A (强同化和强冷却；预期为碰撞区):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 1.0\\times 10^{-3}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 10.0$, $\\tau_Z = 1.5\\times 10^{-3}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 5.0\\times 10^{20}$, $\\tau_n = 1.0\\times 10^{-3}$,\n  - $\\ln\\Lambda = 15.0$.\n\n- 案例 B (弱同化；可能有利于逃逸电子产生):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 3.0\\times 10^{-3}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 3.0$, $\\tau_Z = 3.0\\times 10^{-3}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 5.0\\times 10^{19}$, $\\tau_n = 3.0\\times 10^{-3}$,\n  - $\\ln\\Lambda = 15.0$.\n\n- 案例 C (极强同化和超快冷却；强抑制):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 5.0\\times 10^{-4}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 20.0$, $\\tau_Z = 8.0\\times 10^{-4}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 1.0\\times 10^{21}$, $\\tau_n = 6.0\\times 10^{-4}$,\n  - $\\ln\\Lambda = 15.0$.\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。结果按测试案例排序并扁平化，即先是案例 A 的数据对，然后是案例 B，最后是案例 C。该列表必须包含六个条目：$[r_{\\max}^{(A)},\\mathrm{flag}^{(A)},r_{\\max}^{(B)},\\mathrm{flag}^{(B)},r_{\\max}^{(C)},\\mathrm{flag}^{(C)}]$，其中每个 $r_{\\max}$ 四舍五入到三位小数，每个 flag 是如上定义的整数 $1$ 或 $0$。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、良构且自洽的。任务是构建并求解一个零维（$0$D）模型，用于描述通过杂质注入缓解的托卡马克破裂过程中等离子体电流和关键参数的演化。解决方案将通过对控制方程进行数值积分来推进。\n\n该模型的核心是总等离子体电流 $I(t)$ 的电路方程，其中等离子体被视为一个自感为 $L$、电阻为 $R_p(t)$ 的单一环形电感。根据法拉第定律，电流的演化由以下一阶常微分方程描述：\n$$\n\\frac{dI(t)}{dt} = -\\frac{R_p(t)}{L}I(t)\n$$\n初始条件为 $I(t=0) = I_0$。由于破裂期间等离子体参数的快速演化，等离子体电阻 $R_p(t)$ 是随时间变化的。对于一个大半径为 $R_0$、小半径为 $a$ 的环体，其电阻由下式给出：\n$$\nR_p(t) = \\frac{\\eta(t)l}{A}\n$$\n其中 $l = 2\\pi R_0$ 是环向周长，$A = \\pi a^2$ 是载流截面积。等离子体电阻率 $\\eta(t)$ 由 Spitzer 模型描述，它是电子温度 $T_e(t)$ 和有效离子电荷 $Z_{\\mathrm{eff}}(t)$ 的函数：\n$$\n\\eta(T_e(t), Z_{\\mathrm{eff}}(t)) = C_\\eta\\,\\frac{Z_{\\mathrm{eff}}(t)\\,\\ln\\Lambda}{T_e(t)^{3/2}}\n$$\n此处，$C_\\eta = 5.2\\times 10^{-5}\\ \\mathrm{\\Omega\\cdot m\\cdot eV^{3/2}}$ 是一个常数，$T_e$ 的单位必须是电子伏特。破裂的动力学通过给定的关于温度、有效电荷和电子密度演化的函数来建模，这些函数捕捉了杂质驱动的冷却和电离效应：\n$$\nT_e(t) = T_{e0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_T}\\right)\n$$\n$$\nZ_{\\mathrm{eff}}(t) = Z_0 + \\Delta Z\\left(1 - e^{-t/\\tau_Z}\\right)\n$$\n$$\nn_e(t) = n_{e0} + \\Delta n\\left(1 - e^{-t/\\tau_n}\\right)\n$$\n主要关注的量是平行电场 $E_\\parallel(t)$ 与 Connor-Hastie 临界场 $E_c(t)$ 的比值。平行电场由等离子体电阻率驱动，并使用欧姆定律计算：\n$$\nE_\\parallel(t) = \\eta(t)\\frac{I(t)}{A}\n$$\nConnor-Hastie 临界场是一个阈值，超过该阈值的电子会被持续加速，成为“逃逸”电子。它取决于电子密度 $n_e(t)$ 和库仑对数 $\\ln\\Lambda$：\n$$\nE_c(t)=\\frac{n_e(t)\\,e^3\\,\\ln\\Lambda}{4\\pi\\,\\varepsilon_0^2\\,m_e\\,c^2}\n$$\n其中 $e$、$\\varepsilon_0$、$m_e$ 和 $c$ 是基本物理常数。我们的任务是计算比值 $r(t) = E_\\parallel(t)/E_c(t)$。\n\n为了求解该系统，我们采用数值方法。根据问题指定的固定时间步长 $\\Delta t$，我们使用前向欧拉法求解电流 $I(t)$ 的常微分方程。将时间离散化为 $t_k = k\\Delta t$，则第 $k+1$ 步的电流由第 $k$ 步更新如下：\n$$\nI_{k+1} = I_k + \\Delta t \\left(-\\frac{R_p(t_k)}{L}I_k\\right) = I_k \\left(1 - \\frac{R_p(t_k)\\Delta t}{L}\\right)\n$$\n算法流程如下：首先，我们建立一个从 $t=0$ 到 $t=t_{\\mathrm{end}}$ 的时间网格，步长为 $\\Delta t=1.0\\times 10^{-5}\\ \\mathrm{s}$。所有随时间变化的参数（$T_e, Z_{\\mathrm{eff}}, n_e, \\eta, R_p$）都在该网格的每个点上进行评估，形成数值数组。强制执行所要求的温度下限 $T_e \\ge 1\\ \\mathrm{eV}$。其次，迭代计算电流 $I(t)$。从 $I_0$ 开始，逐步应用前向欧拉方案来计算所有后续时间点的电流。这部分的计算本质上是顺序的。第三，一旦知道了 $I(t)$ 的时间序列，就计算平行电场 $E_\\parallel(t_k)$ 和临界场 $E_c(t_k)$ 的数组。最后，计算所有时间点的比值 $r(t_k) = E_\\parallel(t_k)/E_c(t_k)$。从这个最终的数组中，为每个测试案例提取两个度量指标：\n1. 在整个模拟窗口 $t \\in [0, t_{\\mathrm{end}}]$ 内，该比值的最大值 $r_{\\max} = \\max_k \\{r(t_k)\\}$。\n2. 一个二进制标志，指示是否实现了碰撞性逃逸电子抑制。如果对于所有时间点 $t_k \\ge t_{\\mathrm{check}} = 0.002\\ \\mathrm{s}$ 都有 $r(t_k) \\le 1$，则该标志设为 $1$，否则为 $0$。\n\n该实现用 Python 完成，利用 `numpy` 库在可能的情况下（例如，评估等离子体参数的解析函数）进行高效的矢量化计算。物理常数取自 SI 单位制的标准来源。对所提供的三组参数集中的每一组都重复此过程。",
            "answer": "[2.955,1,10.966,0,0.835,1]"
        }
    ]
}