{
    "hands_on_practices": [
        {
            "introduction": "To grasp the fundamental dynamics of a Vertical Displacement Event, we can construct a simplified yet powerful model. This practice involves analyzing a system of coupled differential equations that represent the plasma's vertical motion as a mechanical oscillator, driven by electromagnetic forces from the plasma and external control coils. By solving this system analytically , you will learn to identify the system's poles and interpret their physical meaning, directly linking mathematical stability criteria to the conditions that determine whether a vertical displacement is stabilized or grows into a full-blown VDE.",
            "id": "4062212",
            "problem": "Consider a simplified, self-consistent model of a tokamak Vertical Displacement Event (VDE) in which the plasma column vertical displacement $Z_c(t)$ is coupled to the plasma current $I_p(t)$ and an actively driven vertical control coil with current $I_c(t)$. The model combines Newton’s second law with linear circuit equations based on Kirchhoff’s voltage law and linear inductive coupling. Assume small vertical excursions and linear response.\n\nThe vertical dynamics of the plasma column are modeled as a damped oscillator driven by electromagnetic forces from the plasma and control coil currents:\n$$\nm\\,\\frac{d^{2} Z_c}{dt^{2}} + \\gamma\\,\\frac{d Z_c}{dt} + k\\,Z_c = K_p\\,I_p + K_c\\,I_c,\n$$\nwhere $m$ is the effective mass of the column in the vertical direction, $\\gamma$ is the effective linear damping coefficient, $k$ is the effective vertical stiffness (restoring coefficient), and $K_p$ and $K_c$ are linearized vertical force coefficients per unit current for the plasma and control coil respectively.\n\nThe control coil circuit is driven by a step change in control voltage applied at $t=0$:\n$$\nL_c\\,\\frac{d I_c}{dt} + R_c\\,I_c = V_0\\,u(t),\n$$\nwhere $L_c$ is the control coil inductance, $R_c$ is its resistance, $V_0$ is a constant, and $u(t)$ is the Heaviside step function.\n\nThe plasma current circuit evolves resistively and is inductively coupled to the control coil:\n$$\nL_p\\,\\frac{d I_p}{dt} + R_p\\,I_p + M\\,\\frac{d I_c}{dt} = 0,\n$$\nwhere $L_p$ and $R_p$ are the effective plasma self-inductance and resistance, and $M$ is the mutual inductance between the plasma circuit and the control coil.\n\nInitial conditions at $t=0^{+}$ are\n$$\nI_c(0)=0,\\quad I_p(0)=0,\\quad Z_c(0)=Z_0\\neq 0,\\quad \\frac{d Z_c}{dt}(0)=0.\n$$\n\nTasks:\n- Using Laplace transforms, derive expressions for $I_p(t)$ and $Z_c(t)$ in terms of the parameters $m$, $\\gamma$, $k$, $K_p$, $K_c$, $L_c$, $R_c$, $L_p$, $R_p$, $M$, $V_0$, and $Z_0$. Clearly identify the pole locations of the resulting transfer functions and interpret their physical meaning in the context of vertical displacement event modeling.\n- Finally, determine the asymptotic steady-state vertical displacement $Z_{\\infty} = \\lim_{t\\to\\infty} Z_c(t)$ as a single closed-form analytic expression. Express the final answer in meters.\n\nNo numerical evaluation is required. If any approximation is introduced, justify it from first principles and state its regime of validity. Do not use shortcut formulas beyond the stated governing laws and definitions. The final answer must be a single closed-form analytic expression for $Z_{\\infty}$.",
            "solution": "The problem presents a coupled system of linear ordinary differential equations (ODEs) with constant coefficients, intended to be a simplified model of a vertical displacement event (VDE) in a tokamak. The provided equations and initial conditions constitute a mathematically well-posed initial value problem. While some of the physical assumptions, such as the initial condition of zero plasma current, represent a significant idealization of a real tokamak VDE, the problem is internally consistent and solvable using standard mathematical techniques. I will proceed with the solution as requested.\n\nThe governing equations are:\n1.  Vertical dynamics: $m\\,\\frac{d^{2} Z_c}{dt^{2}} + \\gamma\\,\\frac{d Z_c}{dt} + k\\,Z_c = K_p\\,I_p + K_c\\,I_c$\n2.  Control coil circuit: $L_c\\,\\frac{d I_c}{dt} + R_c\\,I_c = V_0\\,u(t)$\n3.  Plasma circuit: $L_p\\,\\frac{d I_p}{dt} + R_p\\,I_p + M\\,\\frac{d I_c}{dt} = 0$\n\nThe initial conditions at $t=0^{+}$ are $I_c(0)=0$, $I_p(0)=0$, $Z_c(0)=Z_0$, and $\\frac{d Z_c}{dt}(0)=0$.\n\nWe will use the Laplace transform to solve this system. Let $\\hat{Z}_c(s) = \\mathcal{L}\\{Z_c(t)\\}$, $\\hat{I}_p(s) = \\mathcal{L}\\{I_p(t)\\}$, and $\\hat{I}_c(s) = \\mathcal{L}\\{I_c(t)\\}$. The Laplace transform of a derivative is given by $\\mathcal{L}\\{f'(t)\\} = s\\hat{f}(s) - f(0)$ and $\\mathcal{L}\\{f''(t)\\} = s^2\\hat{f}(s) - sf(0) - f'(0)$. The transform of the Heaviside step function is $\\mathcal{L}\\{u(t)\\} = 1/s$.\n\nApplying the Laplace transform to each equation:\n\n1.  **Control Coil Circuit Equation:**\n    $L_c(s\\hat{I}_c(s) - I_c(0)) + R_c\\hat{I}_c(s) = V_0/s$\n    With $I_c(0) = 0$, we get:\n    $(L_c s + R_c)\\hat{I}_c(s) = \\frac{V_0}{s}$\n    $$ \\hat{I}_c(s) = \\frac{V_0}{s(L_c s + R_c)} $$\n\n2.  **Plasma Circuit Equation:**\n    $L_p(s\\hat{I}_p(s) - I_p(0)) + R_p\\hat{I}_p(s) + M(s\\hat{I}_c(s) - I_c(0)) = 0$\n    With $I_p(0) = 0$ and $I_c(0) = 0$:\n    $(L_p s + R_p)\\hat{I}_p(s) = -M s \\hat{I}_c(s)$\n    $$ \\hat{I}_p(s) = -\\frac{M s}{L_p s + R_p} \\hat{I}_c(s) $$\n    Substituting the expression for $\\hat{I}_c(s)$:\n    $$ \\hat{I}_p(s) = -\\frac{M s}{L_p s + R_p} \\frac{V_0}{s(L_c s + R_c)} = -\\frac{M V_0}{(L_p s + R_p)(L_c s + R_c)} $$\n\n3.  **Vertical Dynamics Equation:**\n    $m(s^2\\hat{Z}_c(s) - sZ_c(0) - \\frac{dZ_c}{dt}(0)) + \\gamma(s\\hat{Z}_c(s) - Z_c(0)) + k\\hat{Z}_c(s) = K_p\\hat{I}_p(s) + K_c\\hat{I}_c(s)$\n    With $Z_c(0)=Z_0$ and $\\frac{dZ_c}{dt}(0)=0$:\n    $(ms^2 + \\gamma s + k)\\hat{Z}_c(s) - msZ_0 - \\gamma Z_0 = K_p\\hat{I}_p(s) + K_c\\hat{I}_c(s)$\n    Solving for $\\hat{Z}_c(s)$:\n    $$ \\hat{Z}_c(s) = \\frac{(ms + \\gamma)Z_0}{ms^2 + \\gamma s + k} + \\frac{K_p\\hat{I}_p(s) + K_c\\hat{I}_c(s)}{ms^2 + \\gamma s + k} $$\n    Substituting the expressions for $\\hat{I}_p(s)$ and $\\hat{I}_c(s)$:\n    $$ \\hat{Z}_c(s) = \\frac{(ms + \\gamma)Z_0}{ms^2 + \\gamma s + k} + \\frac{1}{ms^2 + \\gamma s + k} \\left( K_p \\frac{-M V_0}{(L_p s + R_p)(L_c s + R_c)} + K_c \\frac{V_0}{s(L_c s + R_c)} \\right) $$\n    Combining the terms over a common denominator:\n    $$ \\hat{Z}_c(s) = \\frac{(ms + \\gamma)Z_0}{ms^2 + \\gamma s + k} + \\frac{V_0 \\left( -K_p M s + K_c (L_p s + R_p) \\right)}{s(ms^2 + \\gamma s + k)(L_p s + R_p)(L_c s + R_c)} $$\n    $$ \\hat{Z}_c(s) = \\frac{(ms + \\gamma)Z_0}{ms^2 + \\gamma s + k} + \\frac{V_0 \\left( (K_c L_p - K_p M)s + K_c R_p \\right)}{s(ms^2 + \\gamma s + k)(L_p s + R_p)(L_c s + R_c)} $$\nThis is the complete expression for the Laplace transform of the vertical displacement $Z_c(t)$.\n\n**Task 1: Expressions for $I_p(t)$ and $Z_c(t)$**\n\nTo find $I_p(t)$, we perform the inverse Laplace transform on $\\hat{I}_p(s)$.\n$$ \\hat{I}_p(s) = -\\frac{M V_0}{L_p L_c (s + R_p/L_p)(s + R_c/L_c)} $$\nUsing partial fraction expansion, assuming $L_p/R_p \\neq L_c/R_c$:\n$$ \\hat{I}_p(s) = -\\frac{M V_0}{L_p R_c - L_c R_p} \\left( \\frac{1}{s + R_p/L_p} - \\frac{1}{s + R_c/L_c} \\right) $$\nThe inverse Laplace transform for $t \\ge 0$ is:\n$$ I_p(t) = -\\frac{M V_0}{L_p R_c - L_c R_p} \\left( \\exp\\left(-\\frac{R_p}{L_p}t\\right) - \\exp\\left(-\\frac{R_c}{L_c}t\\right) \\right) $$\n\nThe expression for $Z_c(t)$ is the inverse Laplace transform of $\\hat{Z}_c(s)$. A full analytic expression for $Z_c(t)$ requires a partial fraction expansion of $\\hat{Z}_c(s)$, which is algebraically cumbersome as it involves the five poles of the system. The behavior of $Z_c(t)$ is a superposition of modes corresponding to these poles, excited by the initial condition $Z_0$ and the driving voltage $V_0$.\n\n**Task 2: Pole Locations and Physical Interpretation**\n\nThe poles of the system are the roots of the denominator of the total response function $\\hat{Z}_c(s)$. These poles dictate the transient behavior and stability of the system. The characteristic polynomial is $D(s) = s(ms^2 + \\gamma s + k)(L_p s + R_p)(L_c s + R_c)$. The poles are:\n1.  $s_1 = 0$: This pole originates from the step-function voltage input $V_0 u(t)$. It governs the asymptotic steady-state response of the system.\n2.  $s_2 = -R_c/L_c$: This is a real pole corresponding to the $L/R$ time of the control coil circuit, $\\tau_c = L_c/R_c$. It represents the natural exponential decay rate of transient currents in this coil.\n3.  $s_3 = -R_p/L_p$: This is a real pole corresponding to the $L/R$ time of the plasma circuit, $\\tau_p = L_p/R_p$. It represents the resistive decay time of the plasma current.\n4.  $s_{4,5} = \\frac{-\\gamma \\pm \\sqrt{\\gamma^2 - 4mk}}{2m}$: These poles arise from the mechanical dynamics of the plasma column. Their nature depends on the parameters $m$, $\\gamma$, and $k$.\n    *   If $k0$ and $\\gamma0$ (assuming $m0$), the plasma position is passively stable and damped. The poles have negative real parts, representing a stable equilibrium. The motion will be either overdamped (two real, negative poles if $\\gamma^2  4mk$) or underdamped (a complex conjugate pair if $\\gamma^2  4mk$), corresponding to exponential decay or damped oscillations towards equilibrium.\n    *   If $k0$, the plasma position is passively unstable. The term $k Z_c$ represents a force that pushes the plasma further from equilibrium. In this case, at least one of these two poles will have a positive real part, e.g., for $\\gamma \\ge 0$, $\\sqrt{\\gamma^2-4mk}  \\gamma$, so $-\\gamma + \\sqrt{\\gamma^2-4mk}  0$. This positive real pole corresponds to an exponential growth of the displacement, which is the defining characteristic of a VDE.\n\n**Task 3: Asymptotic Steady-State Vertical Displacement $Z_{\\infty}$**\n\nTo find the final steady-state displacement $Z_{\\infty} = \\lim_{t\\to\\infty} Z_c(t)$, we can use the Final Value Theorem (FVT) of the Laplace transform, which states $Z_{\\infty} = \\lim_{s\\to 0} s \\hat{Z}_c(s)$.\n\nThe FVT is applicable only if the system is stable, meaning all poles of $s\\hat{Z}_c(s)$ lie in the left half of the complex plane. This requires the poles $s_2$, $s_3$, $s_4$, and $s_5$ to have negative real parts. This implies physical parameters $L_c, R_c, L_p, R_p, m, \\gamma$ must be positive, and critically, the stiffness $k$ must also be positive ($k0$). Under these stability conditions, the system will settle to a finite steady state.\n\nApplying the FVT:\n$$ Z_{\\infty} = \\lim_{s\\to 0} s \\left( \\frac{(ms + \\gamma)Z_0}{ms^2 + \\gamma s + k} + \\frac{V_0 \\left( (K_c L_p - K_p M)s + K_c R_p \\right)}{s(ms^2 + \\gamma s + k)(L_p s + R_p)(L_c s + R_c)} \\right) $$\nWe evaluate the limit of each term separately:\n$$ \\lim_{s\\to 0} s \\frac{(ms + \\gamma)Z_0}{ms^2 + \\gamma s + k} = \\frac{0 \\cdot (\\gamma Z_0)}{k} = 0 $$\nThis term, corresponding to the initial conditions, decays to zero in a stable system.\n$$ \\lim_{s\\to 0} s \\frac{V_0 \\left( (K_c L_p - K_p M)s + K_c R_p \\right)}{s(ms^2 + \\gamma s + k)(L_p s + R_p)(L_c s + R_c)} = \\lim_{s\\to 0} \\frac{V_0 \\left( (K_c L_p - K_p M)s + K_c R_p \\right)}{(ms^2 + \\gamma s + k)(L_p s + R_p)(L_c s + R_c)} $$\nSubstituting $s=0$ into the expression:\n$$ Z_{\\infty} = \\frac{V_0 (0 + K_c R_p)}{(0 + 0 + k)(0 + R_p)(0 + R_c)} = \\frac{V_0 K_c R_p}{k R_p R_c} = \\frac{K_c V_0}{k R_c} $$\nThis result can be verified by analyzing the steady state ($d/dt \\to 0$) of the original ODEs. At $t \\to \\infty$, $I_c(\\infty) = V_0/R_c$ and $I_p(\\infty) = 0$ (since the inductive drive from $I_c$ ceases). The force balance becomes $k Z_c(\\infty) = K_c I_c(\\infty)$, yielding the same result.\n\nThe final request to express the answer in meters is satisfied if the parameters are given in SI units. A dimensional analysis confirms that the expression for $Z_{\\infty}$ has units of length: $[Z_{\\infty}] = [K_c][V_0]/([k][R_c]) = (\\text{N} \\cdot \\text{A}^{-1}) \\cdot \\text{V} / ((\\text{N} \\cdot \\text{m}^{-1}) \\cdot \\Omega) = (\\text{V} \\cdot \\text{A}^{-1} \\cdot \\text{m}) / \\Omega = (\\Omega \\cdot \\text{m}) / \\Omega = \\text{m}$.",
            "answer": "$$\\boxed{\\frac{K_c V_0}{k R_c}}$$"
        },
        {
            "introduction": "Sophisticated VDE modeling often relies on magnetohydrodynamic (MHD) equilibrium solvers, which can be broadly categorized as fixed-boundary or free-boundary. This exercise  illuminates the critical difference between these approaches by focusing on how they handle the plasma's vertical position. You will derive the plasma's vertical displacement in response to control coil currents within a free-boundary framework, applying the fundamental principle of Lorentz force balance to a realistic tokamak scenario and gaining insight into why this degree of freedom is treated differently in fixed-boundary codes.",
            "id": "4062231",
            "problem": "Consider an axisymmetric tokamak plasma undergoing small vertical excursions relevant to Vertical Displacement Events (VDEs). The equilibrium is governed by the magnetohydrodynamic (MHD) balance and the axisymmetric Grad–Shafranov equation, with the external poloidal flux boundary condition $\\psi|_{\\Gamma}=\\psi_{\\mathrm{coil}}(t)$ imposed on the computational boundary $\\Gamma$. Two classes of solutions are commonly used: fixed-boundary, where $\\Gamma$ is a prescribed curve in real space, and free-boundary, where $\\Gamma$ is determined self-consistently with currents in both the plasma and external coils.\n\nAssume a circular cross-section plasma of major radius $R_{0}$ and minor radius small enough that rigid vertical shifts $Z$ of the plasma column are a good approximation for the $n=0$ vertical mode. The plasma carries a total toroidal current $I_{p}$ concentrated within the plasma cross-section. An external, up-down antisymmetric poloidal field coil pair supplies a time-dependent current $I_{c}(t)$ which, in the neighborhood of the magnetic axis at $(R_{0},Z)$, produces a radial magnetic field that is well approximated by the linearization\n$$\nB_{R}(R_{0},Z;t)\\approx \\beta\\, I_{c}(t)+\\kappa\\, Z,\n$$\nwhere $\\beta=\\partial B_{R}/\\partial I_{c}$ and $\\kappa=\\partial B_{R}/\\partial Z$ are evaluated at $(R_{0},Z=0)$ for the nominal equilibrium. The plasma shaping and internal profiles provide an effective vertical stiffness $K_{v}$, such that small vertical displacements $Z$ produce a restoring vertical force $-K_{v}\\, Z$. You may treat $K_{v}$ as a lumped parameter derived from the ideal MHD energy principle for the $n=0$ mode.\n\nUsing first principles (the Lorentz force density $\\mathbf{f}=\\mathbf{j}\\times\\mathbf{B}$ and axisymmetric geometry), derive the linearized relation between a small coil-current perturbation $\\delta I_{c}$ and the resulting plasma vertical displacement $\\delta Z$ in the free-boundary case, by enforcing net vertical force balance between plasma internal restoring forces and the external magnetic force from $B_{R}$. Explain why, under the fixed-boundary Grad–Shafranov solution with the Dirichlet boundary condition $\\psi|_{\\Gamma}=\\psi_{\\mathrm{coil}}(t)$ on a geometrically fixed $\\Gamma$, the vertical position is not changed by $\\delta I_{c}$.\n\nEvaluate your free-boundary expression numerically for the following parameters and report the displacement corresponding to $\\Delta I_{c}=1\\,\\mathrm{kA}$:\n- Major radius $R_{0}=3\\,\\mathrm{m}$,\n- Plasma current $I_{p}=10\\,\\mathrm{MA}$,\n- Radial-field coil sensitivity $\\beta=0.4\\,\\mathrm{mT}/\\mathrm{kA}$,\n- Local vertical gradient of the coil-generated radial field $\\kappa=-1.5\\,\\mathrm{mT}/\\mathrm{m}$,\n- Effective vertical stiffness $K_{v}=8\\,\\mathrm{MN}/\\mathrm{m}$.\n\nSelect the option that correctly characterizes both the fixed-boundary versus free-boundary response and gives the correct numerical free-boundary displacement for $\\Delta I_{c}=1\\,\\mathrm{kA}$.\n\nA. In free-boundary modeling, $\\delta Z$ is linearly proportional to $\\delta I_{c}$ with sensitivity enhanced or reduced by the local vertical gradient $\\kappa$; the fixed-boundary solution keeps $\\delta Z=0$ by construction. For the given parameters, the free-boundary displacement is approximately $+9.1\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.\n\nB. Both fixed-boundary and free-boundary solutions yield the same nonzero vertical displacement because the Dirichlet boundary condition enforces $\\psi|_{\\Gamma}=\\psi_{\\mathrm{coil}}(t)$, which directly sets $\\delta Z$. For the given parameters, the displacement is approximately $+9.4\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.\n\nC. In free-boundary modeling, the vertical displacement sensitivity does not include the toroidal circumference factor, so the response is much smaller; fixed-boundary also permits nonzero $\\delta Z$ if $\\psi_{\\mathrm{coil}}(t)$ changes. For the given parameters, the displacement is approximately $+1.45\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.\n\nD. The free-boundary equilibrium is unstable under the given parameters because the denominator of the sensitivity is negative, so any $\\delta I_{c}$ causes runaway $\\delta Z$; fixed-boundary prevents the instability and gives a finite nonzero $\\delta Z$. For the given parameters, the displacement is approximately $-50\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.",
            "solution": "The problem statement is evaluated as scientifically sound, well-posed, objective, and self-contained. The provided physical model is a standard, albeit simplified, representation used in computational fusion science for analyzing plasma vertical stability. All parameters are defined and have physically realistic values and consistent units. No invalidating flaws are identified. We may therefore proceed with the derivation and analysis.\n\nThe problem asks for two main derivations: the response of the plasma vertical position $\\delta Z$ to a coil current perturbation $\\delta I_c$ in a free-boundary model, and an explanation for the behavior in a fixed-boundary model. This is followed by a numerical evaluation for the free-boundary case.\n\n**Part 1: Free-Boundary Model Derivation**\n\nIn the free-boundary case, the plasma's vertical position $Z$ is a dynamic variable determined by the net vertical force balance. The problem models the plasma as a rigid toroidal current loop. The total vertical force $F_{Z, \\text{total}}$ acting on this loop has two components:\n1.  The internal restoring force, $F_{\\text{restore}}$, which arises from the interaction of the plasma current with the magnetic field generated by shaping coils (not the control coils considered here) and the vacuum vessel wall currents (if any). This is given as a linearized restoring force $-K_v Z$, where $K_v  0$ denotes a stabilizing effect.\n2.  The external force, $F_{\\text{ext}}$, due to the interaction of the total toroidal plasma current $I_p$ with the externally applied radial magnetic field $B_R$.\n\nThe Lorentz force, $\\mathbf{F} = \\int (\\mathbf{I} \\, d\\mathbf{l}) \\times \\mathbf{B}$, gives the total force on a current loop. For a toroidal current $I_p$ (in the $\\hat{\\phi}$ direction) in a magnetic field $\\mathbf{B} = B_R \\hat{R} + B_Z \\hat{Z}$, the force element is $d\\mathbf{F} = I_p (R \\, d\\phi \\, \\hat{\\phi}) \\times (B_R \\hat{R} + B_Z \\hat{Z})$. Using a cylindrical coordinate system $(R, \\phi, Z)$ where $\\hat{\\phi} \\times \\hat{R} = \\hat{Z}$, the vertical component of the force element is $dF_Z = I_p R B_R d\\phi$. Assuming axisymmetry ($n=0$ mode), $B_R$ is constant along the toroidal path. Integrating over the full torus of major radius $R_0$ gives the total external vertical force:\n$$F_{\\text{ext}} = \\int_0^{2\\pi} I_p R_0 B_R d\\phi = 2\\pi R_0 I_p B_R$$\n\nThe total vertical force on the plasma is the sum of the restoring and external forces:\n$$F_{Z, \\text{total}}(Z, I_c) = F_{\\text{restore}} + F_{\\text{ext}} = -K_v Z + 2\\pi R_0 I_p B_R(Z, I_c)$$\nThe problem provides the linearized expression for the control field near the midplane ($Z=0$):\n$$B_R(R_0, Z; t) \\approx \\beta I_c(t) + \\kappa Z$$\nSubstituting this into the force equation yields:\n$$F_{Z, \\text{total}}(Z, I_c) = -K_v Z + 2\\pi R_0 I_p (\\beta I_c + \\kappa Z)$$\nFor the plasma to be in a static equilibrium, this total force must be zero: $F_{Z, \\text{total}} = 0$.\n$$-K_v Z + 2\\pi R_0 I_p \\beta I_c + 2\\pi R_0 I_p \\kappa Z = 0$$\nTo find the relationship between a small perturbation in coil current, $\\delta I_c$, and the resulting change in equilibrium vertical position, $\\delta Z$, we consider perturbations around an initial equilibrium $(Z_0, I_{c0})$. The change in force must be zero to reach a new equilibrium: $\\delta F_{Z, \\text{total}} = 0$.\n$$\\frac{\\partial F_{Z, \\text{total}}}{\\partial Z} \\delta Z + \\frac{\\partial F_{Z, \\text{total}}}{\\partial I_c} \\delta I_c = 0$$\nCalculating the partial derivatives from the total force expression:\n$$\\frac{\\partial F_{Z, \\text{total}}}{\\partial Z} = -K_v + 2\\pi R_0 I_p \\kappa$$\n$$\\frac{\\partial F_{Z, \\text{total}}}{\\partial I_c} = 2\\pi R_0 I_p \\beta$$\nSubstituting these into the linearized force balance equation:\n$$(-K_v + 2\\pi R_0 I_p \\kappa) \\delta Z + (2\\pi R_0 I_p \\beta) \\delta I_c = 0$$\nSolving for the displacement $\\delta Z$ as a function of the current perturbation $\\delta I_c$:\n$$\\delta Z = \\frac{-2\\pi R_0 I_p \\beta}{-K_v + 2\\pi R_0 I_p \\kappa} \\delta I_c = \\left( \\frac{2\\pi R_0 I_p \\beta}{K_v - 2\\pi R_0 I_p \\kappa} \\right) \\delta I_c$$\nThis equation shows that the displacement $\\delta Z$ is linearly proportional to the current change $\\delta I_c$. The term in the denominator, $K_v - 2\\pi R_0 I_p \\kappa$, represents the total vertical stiffness of the system. For vertical stability, this stiffness must be positive: $K_v - 2\\pi R_0 I_p \\kappa  0$. The term $-2\\pi R_0 I_p \\kappa$ is the contribution to stiffness from the external field's spatial variation; a negative $\\kappa$ (where the field lines curve inward, \"barrel shape\") is stabilizing.\n\n**Part 2: Fixed-Boundary Model Explanation**\n\nIn a fixed-boundary Grad-Shafranov solution, the computational domain is bounded by a curve $\\Gamma$ that is fixed in space coordinates $(R, Z)$. The solver finds the poloidal flux function $\\psi(R, Z)$ that satisfies the MHD equilibrium equation inside $\\Gamma$ subject to a Dirichlet boundary condition, $\\psi|_{\\Gamma} = \\psi_{\\mathrm{coil}}(t)$. The plasma itself is contained within the last closed flux surface (LCFS), which must lie inside or on $\\Gamma$.\n\nIn this framework, the plasma does not exist as an independent rigid body that can be displaced. Its shape and position are emergent properties of the solution $\\psi(R, Z)$ within the fixed grid. A rigid vertical displacement of the entire plasma current distribution, by an amount $\\delta Z$, is not a degree of freedom in the model. If the boundary $\\Gamma$ is held fixed, the plasma is, by construction, confined within it. Therefore, a change in the coil currents $\\delta I_c$ changes the boundary condition $\\psi_{\\mathrm{coil}}(t)$, which will modify the internal flux distribution and may cause a small shift in the magnetic axis or a change in the plasma shape, but a rigid displacement of the entire plasma column is precluded by the fixed computational boundary. Thus, within the context of the rigid displacement mode $Z$ discussed in this problem, the fixed-boundary solution constrains $\\delta Z = 0$ by construction.\n\n**Part 3: Numerical Evaluation**\n\nWe now calculate the numerical value of the free-boundary displacement $\\delta Z$ for a perturbation $\\Delta I_c = 1\\,\\mathrm{kA}$. The parameters are:\n-   $R_0 = 3\\,\\mathrm{m}$\n-   $I_p = 10\\,\\mathrm{MA} = 10 \\times 10^6\\,\\mathrm{A} = 10^7\\,\\mathrm{A}$\n-   $\\Delta I_c = \\delta I_c = 1\\,\\mathrm{kA} = 10^3\\,\\mathrm{A}$\n-   $\\beta = 0.4\\,\\mathrm{mT}/\\mathrm{kA} = 0.4 \\times 10^{-3}\\,\\mathrm{T} / 10^3\\,\\mathrm{A} = 4 \\times 10^{-7}\\,\\mathrm{T}/\\mathrm{A}$\n-   $\\kappa = -1.5\\,\\mathrm{mT}/\\mathrm{m} = -1.5 \\times 10^{-3}\\,\\mathrm{T}/\\mathrm{m}$\n-   $K_v = 8\\,\\mathrm{MN}/\\mathrm{m} = 8 \\times 10^6\\,\\mathrm{N}/\\mathrm{m}$\n\nFirst, calculate the numerator of the sensitivity term, $N = 2\\pi R_0 I_p \\beta$:\n$$N = 2\\pi (3\\,\\mathrm{m}) (10^7\\,\\mathrm{A}) (4 \\times 10^{-7}\\,\\mathrm{T}/\\mathrm{A}) = 24\\pi\\,\\mathrm{N}/\\mathrm{A} \\approx 75.398\\,\\mathrm{N}/\\mathrm{A}$$\nNext, calculate the denominator, $D = K_v - 2\\pi R_0 I_p \\kappa$:\nThe second term is $2\\pi R_0 I_p \\kappa = 2\\pi (3\\,\\mathrm{m})(10^7\\,\\mathrm{A})(-1.5 \\times 10^{-3}\\,\\mathrm{T}/\\mathrm{m}) = -9\\pi \\times 10^4\\,\\mathrm{N}/\\mathrm{m} \\approx -2.827 \\times 10^5\\,\\mathrm{N}/\\mathrm{m}$.\n$$D = (8 \\times 10^6\\,\\mathrm{N}/\\mathrm{m}) - (-2.827 \\times 10^5\\,\\mathrm{N}/\\mathrm{m}) = (8 \\times 10^6 + 0.2827 \\times 10^6)\\,\\mathrm{N}/\\mathrm{m} = 8.2827 \\times 10^6\\,\\mathrm{N}/\\mathrm{m}$$\nSince the denominator is positive, the equilibrium is stable as asserted by the problem's implicit assumptions. The sensitivity is:\n$$\\frac{\\delta Z}{\\delta I_c} = \\frac{N}{D} = \\frac{75.398\\,\\mathrm{N}/\\mathrm{A}}{8.2827 \\times 10^6\\,\\mathrm{N}/\\mathrm{m}} \\approx 9.103 \\times 10^{-6}\\,\\mathrm{m}/\\mathrm{A}$$\nFinally, calculate the displacement for $\\delta I_c = 10^3\\,\\mathrm{A}$:\n$$\\delta Z = (9.103 \\times 10^{-6}\\,\\mathrm{m}/\\mathrm{A}) \\times (10^3\\,\\mathrm{A}) = 9.103 \\times 10^{-3}\\,\\mathrm{m} = +9.103\\,\\mathrm{mm}$$\nThe displacement for a $1\\,\\mathrm{kA}$ change in coil current is approximately $+9.1\\,\\mathrm{mm}$.\n\n**Option-by-Option Analysis**\n\n**A. In free-boundary modeling, $\\delta Z$ is linearly proportional to $\\delta I_{c}$ with sensitivity enhanced or reduced by the local vertical gradient $\\kappa$; the fixed-boundary solution keeps $\\delta Z=0$ by construction. For the given parameters, the free-boundary displacement is approximately $+9.1\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.**\n-   The qualitative description of the free-boundary model matches our derived relation $\\delta Z \\propto \\delta I_c$, and the sensitivity $\\frac{2\\pi R_0 I_p \\beta}{K_v - 2\\pi R_0 I_p \\kappa}$ explicitly depends on $\\kappa$.\n-   The description of the fixed-boundary case ($\\delta Z = 0$ by construction) is correct for a rigid displacement mode.\n-   The numerical value of $+9.1\\,\\mathrm{mm}$ precisely matches our calculation.\n-   Verdict: **Correct**.\n\n**B. Both fixed-boundary and free-boundary solutions yield the same nonzero vertical displacement because the Dirichlet boundary condition enforces $\\psi|_{\\Gamma}=\\psi_{\\mathrm{coil}}(t)$, which directly sets $\\delta Z$. For the given parameters, the displacement is approximately $+9.4\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.**\n-   The claim that fixed- and free-boundary solutions yield the same displacement is fundamentally incorrect; it negates the primary distinction between the two modeling approaches.\n-   The numerical value of $+9.4\\,\\mathrm{mm}$ is incorrect. It appears to be derived by neglecting the external field stiffness term: $\\delta Z \\approx (2\\pi R_0 I_p \\beta / K_v) \\delta I_c = (75.398 / (8 \\times 10^6)) \\times 10^3 \\approx 9.42\\,\\mathrm{mm}$. This is physically incomplete.\n-   Verdict: **Incorrect**.\n\n**C. In free-boundary modeling, the vertical displacement sensitivity does not include the toroidal circumference factor, so the response is much smaller; fixed-boundary also permits nonzero $\\delta Z$ if $\\psi_{\\mathrm{coil}}(t)$ changes. For the given parameters, the displacement is approximately $+1.45\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.**\n-   The claim that the toroidal circumference factor $2\\pi R_0$ is excluded is physically incorrect. The Lorentz force acts on the entire length of the current loop.\n-   The numerical value of $+1.45\\,\\mathrm{mm}$ is incorrect. It is obtained by incorrectly dividing our result of $9.1\\,\\mathrm{mm}$ by $2\\pi$, which corresponds to the erroneous omission of this factor in the numerator of the sensitivity.\n-   The claim that fixed-boundary permits nonzero $\\delta Z$ (for a rigid shift) is inconsistent with the model definition.\n-   Verdict: **Incorrect**.\n\n**D. The free-boundary equilibrium is unstable under the given parameters because the denominator of the sensitivity is negative, so any $\\delta I_{c}$ causes runaway $\\delta Z$; fixed-boundary prevents the instability and gives a finite nonzero $\\delta Z$. For the given parameters, the displacement is approximately $-50\\,\\mathrm{mm}$ per $\\Delta I_{c}=1\\,\\mathrm{kA}$.**\n-   The claim of instability is false. We calculated the denominator (total stiffness) to be $D \\approx +8.28 \\times 10^6\\,\\mathrm{N}/\\mathrm{m}$, which is positive, indicating a stable equilibrium.\n-   The numerical value is incorrect and its sign and magnitude are inconsistent with a stable response.\n-   The claim that fixed-boundary gives a finite non-zero displacement is, again, incorrect in this context.\n-   Verdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The accuracy of any VDE simulation rests upon the correct implementation of its electromagnetic core. This final practice shifts the focus from using a model to ensuring its fundamental correctness—a cornerstone of computational science known as verification. In this exercise , you will develop a test suite using analytic solutions for the inductance of filamentary conductors to verify that your numerical implementation respects fundamental physical laws, including matrix symmetry, energy conservation, and reciprocity.",
            "id": "4062249",
            "problem": "You are asked to design and implement a self-contained verification program for Vertical Displacement Event (VDE) modeling in computational fusion science and engineering. The program must use an analytic thin-filament representation of coaxial circular conductors to validate three core electromagnetic properties: symmetry of the mutual inductance matrix, energy conservation for magnetostatic coupling, and reciprocity. The physical context is a simplified scenario where a plasma current ring and surrounding conducting structures are represented by infinitesimally thin circular filaments aligned with a common axis, and the vertical displacement is modeled as an axial separation between filament centers. All quantities must be treated in the International System of Units (SI): radii and displacements in meters and currents in amperes.\n\nThe fundamental base to be used in the derivation and implementation includes:\n- Maxwell’s equations in magnetostatics and the Biot–Savart law for magnetic fields produced by steady currents.\n- The Neumann formula for mutual inductance between filaments, expressed as a double line integral of the inverse distance between differential elements, which under coaxial circular symmetry reduces to expressions involving complete elliptic integrals.\n- The definition of flux linkage and inductance: for a set of filamentary circuits with current vector $\\mathbf{I}$ and inductance matrix $\\mathbf{L}$, the flux linkage vector $\\boldsymbol{\\Phi}$ satisfies $\\boldsymbol{\\Phi} = \\mathbf{L}\\,\\mathbf{I}$ and the magnetic energy satisfies $W = \\tfrac{1}{2}\\,\\mathbf{I}^{\\mathsf{T}} \\mathbf{L}\\,\\mathbf{I}$.\n- Reciprocity in linear magnetostatics, which requires that the mutual inductance between any two filaments is symmetric when indices are swapped, consistent with the equality of flux linkages cross-induced by the same current pair.\n\nYour program must:\n1. Implement analytic mutual inductance between two coaxial circular thin filaments of radii $a$ and $b$ with vertical separation $z$ using the closed-form expression in terms of complete elliptic integrals, derived from the Neumann formula. You must not perform any numerical line integration. You must ensure numerical robustness across the provided test cases.\n2. Implement an analytic self-inductance for a thin circular filament of radius $a$ and wire radius $r_{\\mathrm{w}}$ using a well-tested closed-form approximation, treating $r_{\\mathrm{w}} \\ll a$.\n3. Assemble an inductance matrix $\\mathbf{L}$ for a set of coaxial filaments positioned at axial locations $z_i$ with radii $a_i$, where diagonal entries are self-inductances and off-diagonal entries are mutual inductances computed from pairwise separations $|z_i - z_j|$.\n4. Verify the three properties as explicit numerical tests over the following test suite, producing boolean results with a strict tolerance of $10^{-10}$ on equalities:\n   - Test $\\mathrm{T1}$ (mutual inductance symmetry, happy path): Two coaxial filaments with $a_1 = 0.5\\,\\mathrm{m}$, $a_2 = 0.3\\,\\mathrm{m}$, $z = 0.2\\,\\mathrm{m}$, $r_{\\mathrm{w},1} = r_{\\mathrm{w},2} = 10^{-3}\\,\\mathrm{m}$. Compute $M_{12}$ and $M_{21}$ and return whether $|M_{12} - M_{21}|$ is less than $10^{-10}$.\n   - Test $\\mathrm{T2}$ (mutual inductance symmetry, near coplanar boundary): Same radii as $\\mathrm{T1}$ with $z = 10^{-4}\\,\\mathrm{m}$ and $r_{\\mathrm{w},1} = r_{\\mathrm{w},2} = 10^{-3}\\,\\mathrm{m}$. Return whether $|M_{12} - M_{21}|$ is less than $10^{-10}$.\n   - Test $\\mathrm{T3}$ (reciprocity at large separation): Same radii as $\\mathrm{T1}$ with $z = 5.0\\,\\mathrm{m}$, currents $I_1 = 7.0\\,\\mathrm{A}$ and $I_2 = -2.0\\,\\mathrm{A}$. Compute flux linkages $\\Phi_1$ due to $I_2$ and $\\Phi_2$ due to $I_1$ using the same mutual inductance, and return whether $|\\Phi_1/I_2 - \\Phi_2/I_1|$ is less than $10^{-10}$.\n   - Test $\\mathrm{T4}$ (matrix symmetry for three-filament VDE geometry): Three filaments modeling plasma and two wall rings with $(a_0, z_0) = (0.5\\,\\mathrm{m}, 0.0\\,\\mathrm{m})$, $(a_1, z_1) = (0.6\\,\\mathrm{m}, 0.4\\,\\mathrm{m})$, $(a_2, z_2) = (0.6\\,\\mathrm{m}, -0.4\\,\\mathrm{m})$, and $r_{\\mathrm{w},i} = 10^{-3}\\,\\mathrm{m}$ for all $i$. Assemble $\\mathbf{L}$ and return whether $\\mathbf{L}$ is symmetric to within the given tolerance.\n   - Test $\\mathrm{T5}$ (energy conservation consistency): Using the $\\mathbf{L}$ from $\\mathrm{T4}$ and current vector $\\mathbf{I} = [10.0\\,\\mathrm{A}, -5.0\\,\\mathrm{A}, 3.0\\,\\mathrm{A}]^{\\mathsf{T}}$, compute $W_1 = \\tfrac{1}{2}\\,\\mathbf{I}^{\\mathsf{T}} \\mathbf{L}\\,\\mathbf{I}$ and $W_2 = \\tfrac{1}{2}\\,\\sum_i I_i \\Phi_i$ with $\\boldsymbol{\\Phi} = \\mathbf{L}\\,\\mathbf{I}$, and return whether $|W_1 - W_2|$ is less than $10^{-10}$.\n   - Test $\\mathrm{T6}$ (monotonic decay of mutual inductance with vertical displacement): Two filaments with $a_1 = 0.6\\,\\mathrm{m}$, $a_2 = 0.4\\,\\mathrm{m}$ and $z \\in \\{0.0\\,\\mathrm{m}, 0.1\\,\\mathrm{m}, 0.5\\,\\mathrm{m}, 1.0\\,\\mathrm{m}\\}$. Compute $M(z)$ for each $z$ and return whether $M(0.0)  M(0.1)  M(0.5)  M(1.0)$ holds strictly.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result_T1,result_T2,result_T3,result_T4,result_T5,result_T6]\") where each entry is a boolean value \"True\" or \"False\". No additional text should be printed.",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, and complete. It is grounded in the principles of magnetostatics and presents a series of verifiable, objective numerical tests for a computational model. All provided data and constraints are consistent and physically realistic within the specified context of VDE modeling in fusion engineering. We may therefore proceed with a formal solution.\n\nThe core of this problem is to verify fundamental electromagnetic properties using analytic models for the inductance of circular, coaxial, thin-filament conductors. We will first establish the necessary analytic formulas for self and mutual inductance, then construct the required verification tests. All quantities are in SI units.\n\nThe vacuum permeability constant is given by $\\mu_0 = 4\\pi \\times 10^{-7} \\, \\mathrm{H}/\\mathrm{m}$.\n\n**1. Mutual Inductance of Coaxial Circular Filaments**\n\nThe mutual inductance $M$ between two coaxial circular filaments of radii $a$ and $b$, with an axial separation of $z$, can be derived from the Neumann formula. This double line integral reduces to a closed-form expression involving complete elliptic integrals of the first kind, $K(m)$, and second kind, $E(m)$. A numerically robust form of this expression is:\n$$ M(a, b, z) = \\mu_0 \\sqrt{(a+b)^2 + z^2} \\left[ \\left(1 - \\frac{m}{2}\\right) K(m) - E(m) \\right] $$\nwhere $m$ is the square of the elliptic modulus, defined as:\n$$ m = \\frac{4ab}{(a+b)^2 + z^2} $$\nThe argument $m$ is dimensionless and satisfies $0 \\le m \\le 1$. The elliptic integrals are scipy functions `scipy.special.ellipk(m)` and `scipy.special.ellipe(m)`. This formula for $M(a, b, z)$ is inherently symmetric with respect to the interchange of radii $a$ and $b$, a property that underpins the principle of reciprocity.\n\n**2. Self-Inductance of a Circular Filament**\n\nThe self-inductance $L$ of a single circular filament of major radius $a$ and wire radius $r_{\\mathrm{w}}$ is calculated using a standard approximation valid for a thin wire ($r_{\\mathrm{w}} \\ll a$). This formula accounts for the magnetic flux generated by the loop's own current and linked back to it. A commonly used expression is:\n$$ L(a, r_{\\mathrm{w}}) = \\mu_0 a \\left( \\ln\\left(\\frac{8a}{r_{\\mathrm{w}}}\\right) - 2 \\right) $$\nThis expression is derived by integrating the magnetic field over the loop's area, with the $-2$ term arising from assumptions about the current distribution within the conductor (specifically, the skin-effect limit).\n\n**3. Assembling the Inductance Matrix**\n\nFor a system of $N$ coaxial filaments, the electromagnetic coupling is described by an $N \\times N$ inductance matrix $\\mathbf{L}$. The elements of this matrix, $L_{ij}$, are defined as:\n- **Diagonal elements ($i=j$):** The self-inductance of the $i$-th filament, $L_{ii} = L(a_i, r_{\\mathrm{w},i})$.\n- **Off-diagonal elements ($i \\neq j$):** The mutual inductance between the $i$-th and $j$-th filaments, $L_{ij} = M(a_i, a_j, |z_i - z_j|)$.\n\nThe magnetic flux linkage vector $\\boldsymbol{\\Phi}$ and the total magnetic energy $W$ of the system are then given by:\n$$ \\boldsymbol{\\Phi} = \\mathbf{L}\\,\\mathbf{I} $$\n$$ W = \\tfrac{1}{2}\\,\\mathbf{I}^{\\mathsf{T}} \\mathbf{L}\\,\\mathbf{I} $$\nwhere $\\mathbf{I}$ is the vector of currents in the filaments.\n\n**4. Implementation of Verification Tests**\n\nThe program will implement the six specified tests using these formulas.\n\n- **Tests T1 and T2 (Mutual Inductance Symmetry):** These tests verify that the implemented mutual inductance function $M(a,b,z)$ is numerically symmetric. We compute $M_{12} = M(a_1, a_2, z)$ and $M_{21} = M(a_2, a_1, z)$ and check if $|M_{12} - M_{21}|  10^{-10}$. Since the formula is structurally symmetric, this test should pass, confirming the implementation's correctness, even for the near-coplanar case in T2.\n\n- **Test T3 (Reciprocity):** This test frames symmetry in terms of reciprocity of flux linkage. The flux through loop 1 due to current $I_2$ is $\\Phi_1 = M_{12}I_2$. The flux through loop 2 due to current $I_1$ is $\\Phi_2 = M_{21}I_1$. The test requires checking $|\\Phi_1/I_2 - \\Phi_2/I_1|  10^{-10}$, which mathematically simplifies to $|M_{12} - M_{21}|  10^{-10}$, identical to the T1/T2 check.\n\n- **Test T4 (Matrix Symmetry):** This test generalizes the symmetry check to a $3 \\times 3$ system. The inductance matrix $\\mathbf{L}$ is constructed for the three-filament geometry. The test verifies that $\\mathbf{L}$ is symmetric, i.e., $L_{ij} = L_{ji}$ for all $i, j$. This is done by checking if the matrix equals its transpose, $\\mathbf{L} = \\mathbf{L}^{\\mathsf{T}}$, within the specified tolerance.\n\n- **Test T5 (Energy Conservation Consistency):** This test verifies the numerical self-consistency of the energy calculation. It compares two mathematically identical formulations for magnetic energy: $W_1 = \\tfrac{1}{2}\\,\\mathbf{I}^{\\mathsf{T}} \\mathbf{L}\\,\\mathbf{I}$ and $W_2 = \\tfrac{1}{2}\\,\\sum_i I_i \\Phi_i$ with $\\boldsymbol{\\Phi} = \\mathbf{L}\\,\\mathbf{I}$, both representing the same quantity. Any deviation would indicate a flaw in the numerical library's implementation of matrix-vector or matrix-form operations, which is highly unlikely. The test checks if $|W_1 - W_2|  10^{-10}$.\n\n- **Test T6 (Monotonic Decay):** This test verifies a key physical characteristic: that the magnetic coupling between two loops weakens with increasing separation. We compute the mutual inductance $M(z)$ for a series of increasing axial separations $z$ and verify that the values are strictly decreasing. This confirms the physical plausibility of the model's output.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import ellipk, ellipe\nfrom scipy.constants import mu_0\n\n# A meticulous and exacting professor in the STEM fields would demand\n# a clear, well-structured, and verified implementation. This script\n# adheres to that standard.\n\ndef mutual_inductance(a, b, z):\n    \"\"\"\n    Computes the mutual inductance between two coaxial circular filaments.\n\n    The formula is derived from the Neumann formula and is expressed using\n    complete elliptic integrals of the first and second kind.\n\n    Args:\n        a (float): Radius of the first filament in meters.\n        b (float): Radius of the second filament in meters.\n        z (float): Axial separation between the filaments in meters.\n\n    Returns:\n        float: The mutual inductance in Henrys (H).\n    \"\"\"\n    # Ensure all inputs are floats for precision\n    a, b, z = float(a), float(b), float(z)\n\n    # Avoid division by zero if a=b=0, though problem constraints prevent this.\n    if a == 0.0 or b == 0.0:\n        return 0.0\n\n    # Square of the elliptic modulus\n    m_numerator = 4 * a * b\n    m_denominator = (a + b)**2 + z**2\n    m = m_numerator / m_denominator\n\n    # A numerically stable formulation of the mutual inductance:\n    # M = mu_0 * sqrt((a+b)^2 + z^2) * ((1 - m/2)*K(m) - E(m))\n    # This avoids division by sqrt(m), which could be problematic if a or b is zero.\n    \n    # Elliptic integrals K(m) and E(m)\n    K_m = ellipk(m)\n    E_m = ellipe(m)\n    \n    prefactor = mu_0 * np.sqrt(m_denominator)\n    integral_term = (1 - m / 2) * K_m - E_m\n    \n    return prefactor * integral_term\n\ndef self_inductance(a, r_w):\n    \"\"\"\n    Computes the self-inductance of a thin circular filament.\n\n    Args:\n        a (float): Major radius of the filament in meters.\n        r_w (float): Minor (wire) radius of the filament in meters.\n\n    Returns:\n        float: The self-inductance in Henrys (H).\n    \"\"\"\n    if a = 0 or r_w = 0 or r_w = a:\n        raise ValueError(\"Radii must be positive and r_w  a.\")\n    \n    # Standard approximation for a thin circular loop\n    return mu_0 * a * (np.log(8 * a / r_w) - 2)\n\ndef solve():\n    \"\"\"\n    Main function to execute the verification tests for VDE modeling.\n    \"\"\"\n    TOL = 1e-10\n    results = []\n\n    # Test T1: Mutual inductance symmetry, happy path\n    a1, a2, z1 = 0.5, 0.3, 0.2\n    M12 = mutual_inductance(a1, a2, z1)\n    M21 = mutual_inductance(a2, a1, z1)\n    results.append(np.abs(M12 - M21)  TOL)\n\n    # Test T2: Mutual inductance symmetry, near coplanar boundary\n    a1_t2, a2_t2, z2 = 0.5, 0.3, 1e-4\n    M12_t2 = mutual_inductance(a1_t2, a2_t2, z2)\n    M21_t2 = mutual_inductance(a2_t2, a1_t2, z2)\n    results.append(np.abs(M12_t2 - M21_t2)  TOL)\n\n    # Test T3: Reciprocity at large separation\n    a1_t3, a2_t3, z3 = 0.5, 0.3, 5.0\n    I1_t3, I2_t3 = 7.0, -2.0\n    # The test |Phi1/I2 - Phi2/I1|  TOL is equivalent to |M12 - M21|  TOL\n    M12_t3 = mutual_inductance(a1_t3, a2_t3, z3)\n    M21_t3 = mutual_inductance(a2_t3, a1_t3, z3)\n    results.append(np.abs(M12_t3 - M21_t3)  TOL)\n\n    # Test T4: Matrix symmetry for three-filament VDE geometry\n    filaments = [\n        {'a': 0.5, 'z': 0.0, 'r_w': 1e-3},  # filament 0 (plasma)\n        {'a': 0.6, 'z': 0.4, 'r_w': 1e-3},  # filament 1 (upper wall)\n        {'a': 0.6, 'z': -0.4, 'r_w': 1e-3}  # filament 2 (lower wall)\n    ]\n    N = len(filaments)\n    L = np.zeros((N, N))\n    for i in range(N):\n        for j in range(N):\n            if i == j:\n                L[i, j] = self_inductance(filaments[i]['a'], filaments[i]['r_w'])\n            else:\n                z_sep = np.abs(filaments[i]['z'] - filaments[j]['z'])\n                L[i, j] = mutual_inductance(filaments[i]['a'], filaments[j]['a'], z_sep)\n    # Check if L is symmetric within the given absolute tolerance\n    is_symmetric = np.allclose(L, L.T, atol=TOL, rtol=0)\n    results.append(is_symmetric)\n\n    # Test T5: Energy conservation consistency\n    I_t5 = np.array([10.0, -5.0, 3.0])\n    # W1 = 0.5 * I^T * L * I\n    W1 = 0.5 * I_t5.T @ L @ I_t5\n    # W2 = 0.5 * sum(I_i * Phi_i) where Phi = L * I\n    Phi_t5 = L @ I_t5\n    W2 = 0.5 * np.dot(I_t5, Phi_t5)\n    results.append(np.abs(W1 - W2)  TOL)\n\n    # Test T6: Monotonic decay of mutual inductance with vertical displacement\n    a1_t6, a2_t6 = 0.6, 0.4\n    z_values = [0.0, 0.1, 0.5, 1.0]\n    M_values = [mutual_inductance(a1_t6, a2_t6, z) for z in z_values]\n    is_monotonic = (M_values[0]  M_values[1] and\n                    M_values[1]  M_values[2] and\n                    M_values[2]  M_values[3])\n    results.append(is_monotonic)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}