{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of neutron diagnostics is the direct relationship between the plasma's thermonuclear state and the rate of neutron production. This first exercise guides you through the fundamental calculation of converting core plasma parameters—such as ion density and temperature—into the total neutron source strength and the resulting flux at a detector. Mastering this calculation is essential for interpreting neutron yield measurements and assessing a fusion device's performance. ",
            "id": "4020148",
            "problem": "A spatially uniform deuterium–tritium (DT) plasma has deuterium ion density $n_{D} = 5 \\times 10^{19}\\ \\mathrm{m^{-3}}$ and tritium ion density $n_{T} = 5 \\times 10^{19}\\ \\mathrm{m^{-3}}$. The ions are Maxwellian at ion temperature $T_{i} = 10\\ \\mathrm{keV}$. The plasma occupies volume $V = 100\\ \\mathrm{m^{3}}$. At this temperature, the thermally averaged DT fusion reactivity is $\\langle \\sigma v \\rangle_{\\mathrm{DT}} = 1.1 \\times 10^{-22}\\ \\mathrm{m^{3}\\ s^{-1}}$. Assume that each DT fusion reaction produces exactly one neutron and that neutron emission is isotropic. A small-area neutron detector is located in vacuum at distance $r = 10\\ \\mathrm{m}$ from the plasma center with full $4\\pi$ steradian exposure, and material attenuation between the plasma and detector is negligible.\n\nStarting from the microscopic definition of binary reaction rate density for two distinct Maxwellian ion species and the geometric conservation of particle number over spherical surfaces for an isotropic point source, derive expressions for:\n- the total DT neutron emission rate from the plasma, and\n- the neutron flux incident on the detector.\n\nThen evaluate these expressions using the given values. Round your numerical answers to three significant figures. Express the total emission rate in $\\mathrm{s^{-1}}$ and the flux in $\\mathrm{m^{-2}\\ s^{-1}}$. The final answer must be a calculation.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- Deuterium ion density: $n_{D} = 5 \\times 10^{19}\\ \\mathrm{m^{-3}}$\n- Tritium ion density: $n_{T} = 5 \\times 10^{19}\\ \\mathrm{m^{-3}}$\n- Ion temperature: $T_{i} = 10\\ \\mathrm{keV}$\n- Plasma volume: $V = 100\\ \\mathrm{m^{3}}$\n- Thermally averaged DT fusion reactivity: $\\langle \\sigma v \\rangle_{\\mathrm{DT}} = 1.1 \\times 10^{-22}\\ \\mathrm{m^{3}\\ s^{-1}}$\n- Assumption: One neutron is produced per DT fusion reaction.\n- Assumption: Neutron emission is isotropic.\n- Detector distance from plasma center: $r = 10\\ \\mathrm{m}$\n- Assumption: The plasma is spatially uniform.\n- Assumption: The detector is a small-area detector.\n- Assumption: Material attenuation is negligible.\n- The task is to derive expressions for the total DT neutron emission rate and the neutron flux at the detector, and then evaluate them.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a standard calculation in fusion plasma physics. The reaction D+T $\\rightarrow$ He-4 + n is the principal fusion reaction in magnetic confinement fusion. The given plasma parameters ($n_D$, $n_T$, $T_i$) and the corresponding reactivity $\\langle \\sigma v \\rangle_{\\mathrm{DT}}$ are physically realistic values for a fusion-grade plasma. The concepts of reaction rate, total yield, and particle flux are fundamental in physics. The problem is scientifically sound.\n- **Well-Posed:** The problem provides all necessary data and assumptions (uniform plasma, isotropic emission, point-source approximation for flux calculation) to derive the requested quantities and compute unique numerical values.\n- **Objective:** The problem is stated using precise, quantitative, and unbiased language.\n- **Incomplete or Contradictory Setup:** The problem is self-contained and free of contradictions. The assumption that the plasma can be treated as a point source for a detector at $r=10\\ \\mathrm{m}$ is a common and acceptable simplification in this context, as the characteristic dimension of a $100\\ \\mathrm{m^3}$ plasma is smaller than the detector distance.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will proceed.\n\n### Derivation and Calculation\n\nThe problem requires the derivation of two quantities: the total DT neutron emission rate from the plasma, and the neutron flux incident on the detector.\n\n**1. Total DT Neutron Emission Rate ($Y_n$)**\n\nThe derivation starts from the microscopic definition of the binary reaction rate density, $R$, for two distinct reacting Maxwellian ion species, deuterium (D) and tritium (T). The reaction rate density is the number of reactions per unit volume per unit time. For distinct species, this is given by the product of their number densities and their thermally averaged fusion reactivity:\n$$R = n_{D} n_{T} \\langle \\sigma v \\rangle_{\\mathrm{DT}}$$\nThe problem states that the plasma is spatially uniform. This implies that the densities $n_{D}$ and $n_{T}$, as well as the ion temperature $T_i$ (which determines $\\langle \\sigma v \\rangle_{\\mathrm{DT}}$), are constant throughout the plasma volume $V$.\n\nThe total fusion reaction rate, $Y_{\\mathrm{fus}}$, is obtained by integrating the reaction rate density $R$ over the entire plasma volume $V$:\n$$Y_{\\mathrm{fus}} = \\int_{V} R \\, dV$$\nSince $R$ is constant throughout the volume, the integral simplifies to the product of the reaction rate density and the total volume:\n$$Y_{\\mathrm{fus}} = R \\cdot V = n_{D} n_{T} \\langle \\sigma v \\rangle_{\\mathrm{DT}} V$$\nThe problem states that each DT fusion reaction produces exactly one neutron. Therefore, the total neutron emission rate, $Y_n$, is equal to the total fusion reaction rate, $Y_{\\mathrm{fus}}$.\n$$Y_n = n_{D} n_{T} \\langle \\sigma v \\rangle_{\\mathrm{DT}} V$$\nThis is the first required expression.\n\nNow, we evaluate this expression using the given values:\n$n_{D} = 5 \\times 10^{19}\\ \\mathrm{m^{-3}}$\n$n_{T} = 5 \\times 10^{19}\\ \\mathrm{m^{-3}}$\n$\\langle \\sigma v \\rangle_{\\mathrm{DT}} = 1.1 \\times 10^{-22}\\ \\mathrm{m^{3}\\ s^{-1}}$\n$V = 100\\ \\mathrm{m^{3}}$\n\nSubstituting these values into the expression for $Y_n$:\n$$Y_n = (5 \\times 10^{19}\\ \\mathrm{m^{-3}}) \\times (5 \\times 10^{19}\\ \\mathrm{m^{-3}}) \\times (1.1 \\times 10^{-22}\\ \\mathrm{m^{3}\\ s^{-1}}) \\times (100\\ \\mathrm{m^{3}})$$\n$$Y_n = (25 \\times 10^{38}) \\times (1.1 \\times 10^{-22}) \\times 10^{2}\\ \\mathrm{s^{-1}}$$\n$$Y_n = 27.5 \\times 10^{38 - 22 + 2}\\ \\mathrm{s^{-1}}$$\n$$Y_n = 27.5 \\times 10^{18}\\ \\mathrm{s^{-1}}$$\n$$Y_n = 2.75 \\times 10^{19}\\ \\mathrm{s^{-1}}$$\n\n**2. Neutron Flux at the Detector ($\\phi_n$)**\n\nThe derivation for the neutron flux, $\\phi_n$, starts from the geometric conservation of particle number for an isotropic point source. The problem states that neutron emission is isotropic, and the detector is located at a distance $r$ from the plasma center, which allows us to model the entire plasma volume as a point source of neutrons.\n\nThe total number of neutrons emitted per second, $Y_n$, spreads out uniformly in all directions. At a distance $r$ from the source, these neutrons are distributed over the surface of a sphere of radius $r$. The surface area of this sphere is $A = 4 \\pi r^2$.\n\nThe neutron flux, $\\phi_n$, is defined as the number of neutrons passing through a unit area per unit time. Assuming no attenuation (as stated in the problem), the flux at distance $r$ is the total emission rate divided by the surface area of the sphere:\n$$\\phi_n = \\frac{Y_n}{A} = \\frac{Y_n}{4 \\pi r^2}$$\nThis is the second required expression. By substituting the expression for $Y_n$, we can write the flux in terms of the primary plasma parameters:\n$$\\phi_n = \\frac{n_{D} n_{T} \\langle \\sigma v \\rangle_{\\mathrm{DT}} V}{4 \\pi r^2}$$\n\nNow, we evaluate this expression using the calculated value for $Y_n$ and the given distance $r = 10\\ \\mathrm{m}$:\n$$Y_n = 2.75 \\times 10^{19}\\ \\mathrm{s^{-1}}$$\n$$r = 10\\ \\mathrm{m}$$\nSubstituting these values into the expression for $\\phi_n$:\n$$\\phi_n = \\frac{2.75 \\times 10^{19}\\ \\mathrm{s^{-1}}}{4 \\pi (10\\ \\mathrm{m})^2}$$\n$$\\phi_n = \\frac{2.75 \\times 10^{19}}{4 \\pi (100)}\\ \\mathrm{m^{-2}\\ s^{-1}}$$\n$$\\phi_n = \\frac{2.75 \\times 10^{19}}{400 \\pi}\\ \\mathrm{m^{-2}\\ s^{-1}}$$\n$$\\phi_n = \\frac{2.75}{4\\pi} \\times 10^{17}\\ \\mathrm{m^{-2}\\ s^{-1}}$$\nCalculating the numerical value:\n$$\\phi_n \\approx 0.218840... \\times 10^{17}\\ \\mathrm{m^{-2}\\ s^{-1}}$$\n$$\\phi_n \\approx 2.18840... \\times 10^{16}\\ \\mathrm{m^{-2}\\ s^{-1}}$$\nRounding to three significant figures, as required by the problem:\n$$\\phi_n \\approx 2.19 \\times 10^{16}\\ \\mathrm{m^{-2}\\ s^{-1}}$$\nThe two final numerical answers are the total emission rate, $Y_n = 2.75 \\times 10^{19}\\ \\mathrm{s^{-1}}$, and the neutron flux at the detector, $\\phi_n = 2.19 \\times 10^{16}\\ \\mathrm{m^{-2}\\ s^{-1}}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 2.75 \\times 10^{19} & 2.19 \\times 10^{16} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once produced, neutrons travel from the plasma to detectors, interacting with all intervening materials, including vacuum vessel walls, blankets, and the diagnostic components themselves. This practice explores the fundamental physics of neutron transport, using the Beer-Lambert law to quantify the probability of a neutron traversing a material slab without interaction. Understanding this attenuation and scattering process is crucial for designing effective shielding, calculating detector response, and interpreting measured signals correctly. ",
            "id": "4020150",
            "problem": "A monoenergetic, monodirectional beam of deuterium–tritium (DT) fusion neutrons at energy $E_{n} = 14\\ \\mathrm{MeV}$ is incident normally on a homogeneous, plane-parallel slab of polyethylene of thickness $L = 20\\ \\mathrm{cm}$. The material is at room temperature and the macroscopic total cross section at $14\\ \\mathrm{MeV}$ is constant and equal to $\\Sigma_{t} = 0.25\\ \\mathrm{cm^{-1}}$. Assume there are no internal sources, absorption is negligible relative to elastic scattering at this energy, and collisions along a straight path are independent.\n\nStarting from the definition of the macroscopic total cross section and the conservation of particle number along a straight-line trajectory through a homogeneous medium, derive the expression for the fraction of the incident neutrons that emerge from the slab without any interaction. Using a statistical interpretation of collisions as a spatial Poisson process, derive the expression for the fraction of incident neutrons that undergo at least one scatter within the slab. Then evaluate both quantities for the given parameters.\n\nExpress both the transmission (uncollided fraction) and the fraction undergoing at least one scatter as dimensionless numbers, and round your numerical results to four significant figures.",
            "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded in the principles of neutron transport theory, well-posed with sufficient and consistent data, and expressed in objective, formal language. There are no contradictions, ambiguities, or factual unsoundness. We may therefore proceed with a rigorous solution.\n\nThe problem asks for two derivations and subsequent numerical evaluations related to the transport of a neutron beam through a material slab. The first part involves deriving the uncollided fraction from first principles of particle conservation, and the second involves deriving the fraction of neutrons that scatter at least once using a statistical interpretation.\n\n**Part 1: Derivation of the Uncollided Fraction (Transmission)**\n\nLet $I(\\vec{r}, E, \\vec{\\Omega})$ represent the angular neutron flux, defined as the number of neutrons with energy $E$ at position $\\vec{r}$ traveling in direction $\\vec{\\Omega}$ per unit area per unit time per unit energy per unit solid angle. For a monoenergetic, monodirectional beam incident normally on a plane-parallel slab, we can simplify the problem by considering only the spatial coordinate along the direction of incidence, say $x$, which is perpendicular to the slab face. The intensity of the uncollided beam at a depth $x$ can be denoted by $I(x)$.\n\nThe fundamental definition of the macroscopic total cross section, $\\Sigma_t$, is that it represents the probability of any type of interaction per unit path length for a neutron. Consider a thin differential slice of the material of thickness $dx$ at a depth $x$. The number of neutrons from the uncollided beam that interact within this slice is proportional to the number of incident neutrons on the slice, $I(x)$, and the thickness of the slice, $dx$. The constant of proportionality is $\\Sigma_t$.\n\nThe change in the beam intensity, $dI(x)$, due to neutrons being removed by interactions (scattering or absorption) in the slice $dx$ is given by:\n$$dI(x) = -I(x) \\Sigma_t dx$$\nThe negative sign indicates that the intensity of the uncollided beam decreases as it penetrates deeper into the material. This equation is a statement of the conservation of particles for the uncollided component of the flux. Rearranging this expression, we obtain a first-order linear ordinary differential equation:\n$$\\frac{dI(x)}{I(x)} = -\\Sigma_t dx$$\nWe solve this equation by integrating over the thickness of the slab. Let the incident intensity at the front face of the slab ($x=0$) be $I_0$. We integrate from the front face at $x=0$ to an arbitrary depth $x$:\n$$\\int_{I(0)}^{I(x)} \\frac{dI'}{I'} = \\int_{0}^{x} -\\Sigma_t dx'$$\nSince the medium is homogeneous, $\\Sigma_t$ is constant with respect to position. The integration yields:\n$$\\ln[I(x)] - \\ln[I(0)] = -\\Sigma_t x$$\n$$\\ln\\left(\\frac{I(x)}{I(0)}\\right) = -\\Sigma_t x$$\nExponentiating both sides gives the well-known Beer-Lambert law for particle attenuation:\n$$I(x) = I(0) \\exp(-\\Sigma_t x)$$\nThe fraction of the incident neutrons that emerge from the slab of total thickness $L$ without any interaction is the transmission, $T$. This is the ratio of the emergent intensity at $x=L$ to the incident intensity at $x=0$:\n$$T = \\frac{I(L)}{I(0)} = \\frac{I(0) \\exp(-\\Sigma_t L)}{I(0)}$$\n$$T = \\exp(-\\Sigma_t L)$$\nThe quantity $\\Sigma_t L$ is a dimensionless value known as the optical thickness of the medium.\n\n**Part 2: Derivation from a Statistical (Poisson Process) Perspective**\n\nThe problem states that collisions along a straight path are independent events. This is a key characteristic of a Poisson process. We can model the number of collisions a neutron undergoes while traversing a certain path length as a random variable following a Poisson distribution.\n\nLet $\\lambda$ be the average rate of events (collisions) per unit path length. By definition, this rate is the macroscopic total cross section, $\\Sigma_t$. The mean number of collisions expected over a path length $L$ is $\\mu = \\lambda L = \\Sigma_t L$.\n\nThe probability of a neutron undergoing exactly $k$ collisions in traversing a path of length $L$ is given by the Poisson probability mass function:\n$$P(k; \\mu) = \\frac{\\mu^k e^{-\\mu}}{k!} = \\frac{(\\Sigma_t L)^k \\exp(-\\Sigma_t L)}{k!}$$\nThe fraction of incident neutrons that undergo at least one scatter within the slab corresponds to the probability of having one or more collisions, i.e., $P(k \\ge 1)$. It is simpler to calculate this as the complement of the probability of having zero collisions, $P(k=0)$.\nFirst, let us find the probability of zero collisions, which corresponds to the uncollided fraction derived previously:\n$$P(k=0) = \\frac{(\\Sigma_t L)^0 \\exp(-\\Sigma_t L)}{0!} = \\frac{1 \\cdot \\exp(-\\Sigma_t L)}{1} = \\exp(-\\Sigma_t L)$$\nThis result for the uncollided fraction is identical to the one derived from the particle conservation equation, demonstrating the consistency between the deterministic and stochastic models.\n\nThe fraction of neutrons that undergo at least one scatter, which we denote as $P_{\\text{scatter}}$, is:\n$$P_{\\text{scatter}} = P(k \\ge 1) = \\sum_{k=1}^{\\infty} P(k; \\mu) = 1 - P(k=0)$$\nSubstituting the expression for $P(k=0)$:\n$$P_{\\text{scatter}} = 1 - \\exp(-\\Sigma_t L)$$\nThis is the desired expression for the fraction of neutrons undergoing at least one interaction.\n\n**Part 3: Numerical Evaluation**\n\nWe are given the following parameters:\n- Slab thickness: $L = 20\\ \\mathrm{cm}$\n- Macroscopic total cross section: $\\Sigma_{t} = 0.25\\ \\mathrm{cm^{-1}}$\n\nFirst, we calculate the dimensionless optical thickness, $\\tau = \\Sigma_t L$:\n$$\\tau = (0.25\\ \\mathrm{cm^{-1}}) \\times (20\\ \\mathrm{cm}) = 5$$\nNow we can evaluate the two requested quantities.\n\nThe transmission (uncollided fraction), $T$, is:\n$$T = \\exp(-\\tau) = \\exp(-5)$$\n$$T \\approx 0.00673794699...$$\nRounding to four significant figures, we get:\n$$T \\approx 0.006738$$\n\nThe fraction undergoing at least one scatter, $P_{\\text{scatter}}$, is:\n$$P_{\\text{scatter}} = 1 - T = 1 - \\exp(-5)$$\n$$P_{\\text{scatter}} \\approx 1 - 0.00673794699... = 0.993262053...$$\nRounding to four significant figures, we get:\n$$P_{\\text{scatter}} \\approx 0.9933$$\n\nThe requested quantities are the transmission (uncollided fraction) and the fraction undergoing at least one scatter, evaluated for the given parameters. The final results are approximately $0.006738$ and $0.9933$, respectively.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.006738 & 0.9933\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In advanced diagnostic systems like neutron cameras, the instrument's own components can become a source of measurement error through neutron scattering. This computational exercise delves into the practical consequences of such effects, tasking you with modeling the systematic bias introduced by collimator scattering in a tomographic reconstruction of the plasma's neutron emissivity profile. By quantifying this bias for different materials, you will gain insight into the intricate process of validating diagnostic data and correcting for instrumental artifacts. ",
            "id": "4020156",
            "problem": "A neutron camera (NC) is modeled as a set of $N$ parallel lines of sight intersecting a circular, axisymmetric fusion plasma of radius $R$. The plasma neutron emissivity is $e(r)$ with $r \\in [0,R]$. The NC reconstructs a discretized emissivity profile by partitioning the plasma cross-section into $K$ concentric annuli (shells), each of constant emissivity $x_k$ for shell index $k \\in \\{1,\\dots,K\\}$, where shell $k$ spans radii $[r_{k-1},r_k]$ with $r_k = kR/K$ and $r_0 = 0$. The line-integrated signal along sightline $i$ at impact parameter $b_i$ is the path-length-weighted sum of the shell emissivities, $L_i = \\sum_{k=1}^{K} A_{ik} x_k$, where $A_{ik}$ is the chord length through shell $k$ for the chord with $b_i$. The chord length through a shell is defined by geometry: for $b_i < r_{k-1}$, $A_{ik} = 2\\big(\\sqrt{r_k^2 - b_i^2} - \\sqrt{r_{k-1}^2 - b_i^2}\\big)$, for $r_{k-1} \\le b_i < r_k$, $A_{ik} = 2\\sqrt{r_k^2 - b_i^2}$, and for $b_i \\ge r_k$, $A_{ik} = 0$. The measured counts along sightline $i$, $M_i$, are the sum of the direct line-integrated signal $L_i$ and an additive contamination term $S_i$ due to scattered neutrons generated in the collimator walls. Assume the scattering produces an isotropic background that contributes the same additive offset to each sightline, modeled as $S_i = c \\sum_{j=1}^{N} L_j$, where $c$ is a dimensionless contamination fraction determined by collimator properties.\n\nThe contamination fraction $c$ is estimated using single-scatter physics in the collimator material. Let the collimator wall thickness be $\\ell$ (in $\\mathrm{cm}$), the number density be $N$ (in $\\mathrm{cm}^{-3}$), the microscopic scattering cross-section be $\\sigma_s$ (in barns), and the microscopic absorption cross-section be $\\sigma_a$ (in barns). Define the macroscopic total cross-section $\\Sigma_t = N (\\sigma_s + \\sigma_a) \\times 10^{-24}$ (in $\\mathrm{cm}^{-1}$) and the single-scatter albedo $\\omega = \\frac{\\Sigma_s}{\\Sigma_t}$ with $\\Sigma_s = N\\sigma_s \\times 10^{-24}$. The probability that a neutron undergoes at least one interaction traversing the collimator thickness is $P = 1 - e^{-\\Sigma_t \\ell}$. If a fraction $f_{\\mathrm{acc}}$ of scattered neutrons reach the detector acceptance, the contamination fraction is $c = f_{\\mathrm{acc}} \\omega P$. When the reconstruction neglects scattering and solves $A x \\approx M$ using Least Squares (LS), the inferred profile $x^\\star$ is biased relative to the true $x$.\n\nStarting from the above geometric definitions and Beer–Lambert attenuation for the collimator, derive how neglecting scattered neutrons introduces bias in the LS-reconstructed emissivity and compute the magnitude of this bias as the relative root-mean-square error (RMSE), defined as $\\mathrm{RMSE} = \\frac{\\sqrt{\\frac{1}{K}\\sum_{k=1}^{K} (x^\\star_k - x_k)^2}}{\\sqrt{\\frac{1}{K}\\sum_{k=1}^{K} x_k^2}}$ (dimensionless).\n\nUse the following axisymmetric emissivity model and camera geometry in all test cases:\n- Plasma radius $R = 50$ (in $\\mathrm{cm}$).\n- Number of sightlines $N = 12$ and number of shells $K = 12$.\n- Impact parameters $b_i = R \\frac{i - 0.5}{N}$ for $i \\in \\{1,\\dots,12\\}$ (in $\\mathrm{cm}$).\n- Emissivity $e(r) = e_0 \\exp\\!\\big(-(r/\\alpha)^2\\big)$ with $e_0 = 1$ (in arbitrary units) and $\\alpha = 20$ (in $\\mathrm{cm}$). The shell emissivity $x_k$ equals $e(r_k^\\mathrm{mid})$ with $r_k^\\mathrm{mid} = \\frac{r_{k-1} + r_k}{2}$.\n\nEstimate $c$ for each material using the specified microscopic cross-sections, densities, and thicknesses, and then compute the RMSE between the reconstructed $x^\\star$ that ignores scattering and the true $x$.\n\nProvide a test suite with four cases that each specify material parameters and acceptance:\n1. Polyethylene collimator (chemical formula $\\mathrm{CH}_2$) with thickness $\\ell = 10$ (in $\\mathrm{cm}$), density $\\rho = 0.93$ (in $\\mathrm{g/cm^3}$), molecular mass $M = 14.0$ (in $\\mathrm{g/mol}$), microscopic scattering cross-sections $\\sigma_{s,\\mathrm{H}} = 3.5$ and $\\sigma_{s,\\mathrm{C}} = 1.0$ (in barns), microscopic absorption cross-sections $\\sigma_{a,\\mathrm{H}} = 0.002$ and $\\sigma_{a,\\mathrm{C}} = 0.003$ (in barns), and $f_{\\mathrm{acc}} = 0.002$. Treat $\\mathrm{CH}_2$ as molecules with number density $N_{\\mathrm{mol}} = \\frac{\\rho}{M} N_A$ where $N_A = 6.022\\times 10^{23}$ (in $\\mathrm{mol^{-1}}$), and use $\\sigma_{s,\\mathrm{mol}} = 2\\sigma_{s,\\mathrm{H}} + \\sigma_{s,\\mathrm{C}}$ and $\\sigma_{a,\\mathrm{mol}} = 2\\sigma_{a,\\mathrm{H}} + \\sigma_{a,\\mathrm{C}}$ to compute $\\Sigma_s$ and $\\Sigma_t$.\n2. Tungsten collimator with thickness $\\ell = 15$ (in $\\mathrm{cm}$), density $\\rho = 19.3$ (in $\\mathrm{g/cm^3}$), atomic mass $M = 183.84$ (in $\\mathrm{g/mol}$), microscopic scattering and absorption cross-sections $\\sigma_{s,\\mathrm{W}} = 2.0$ and $\\sigma_{a,\\mathrm{W}} = 0.5$ (in barns), and $f_{\\mathrm{acc}} = 0.0005$. Use $N = \\frac{\\rho}{M} N_A$.\n3. Lead collimator with thickness $\\ell = 10$ (in $\\mathrm{cm}$), density $\\rho = 11.34$ (in $\\mathrm{g/cm^3}$), atomic mass $M = 207.2$ (in $\\mathrm{g/mol}$), microscopic scattering and absorption cross-sections $\\sigma_{s,\\mathrm{Pb}} = 1.5$ and $\\sigma_{a,\\mathrm{Pb}} = 0.3$ (in barns), and $f_{\\mathrm{acc}} = 0.0006$. Use $N = \\frac{\\rho}{M} N_A$.\n4. Zero-scattering boundary case with the same tungsten properties as case $2$ but with $f_{\\mathrm{acc}} = 0.0$, implying $c = 0$.\n\nFor each case, compute the RMSE as defined above. Your program should produce a single line of output containing the RMSE results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$). All outputs must be dimensionless floats.",
            "solution": "The user's request is to analyze the bias introduced in a neutron emissivity reconstruction due to unaccounted-for neutron scattering in the collimator. The analysis requires deriving the mathematical form of the bias and then computing its magnitude for several test cases using a specified numerical model.\n\nThe problem is scientifically and mathematically well-posed, providing all necessary physical and geometric parameters, as well as the mathematical framework for the reconstruction and the scattering model. It is a valid problem grounded in the principles of radiation transport, linear algebra, and numerical methods as applied to fusion plasma diagnostics.\n\nThe solution proceeds in several steps:\n1.  Define the matrix-vector representation of the physical model.\n2.  Derive the expression for the biased emissivity reconstruction.\n3.  Establish the computational algorithm to calculate the true and reconstructed profiles.\n4.  Compute the contamination fraction $c$ for each specified material.\n5.  Numerically compute the relative root-mean-square error (RMSE) for each case.\n\n**1. Theoretical Framework and Bias Derivation**\n\nThe line-integrated neutron signal $L_i$ along a sightline $i$ with impact parameter $b_i$ is a linear combination of the constant emissivities $x_k$ of the concentric plasma shells. This can be expressed as a matrix-vector equation:\n$$\n\\mathbf{L} = \\mathbf{A} \\mathbf{x}\n$$\nHere, $\\mathbf{L}$ is an $N \\times 1$ vector of line-integrated signals, where $N$ is the number of sightlines. $\\mathbf{x}$ is a $K \\times 1$ vector of the unknown shell emissivities, where $K$ is the number of shells. $\\mathbf{A}$ is the $N \\times K$ geometry matrix, where the element $A_{ik}$ represents the chord length of sightline $i$ through shell $k$. The problem provides the formulas for $A_{ik}$:\n$$\nA_{ik} = \n\\begin{cases} \n2\\left(\\sqrt{r_k^2 - b_i^2} - \\sqrt{r_{k-1}^2 - b_i^2}\\right) & \\text{for } b_i < r_{k-1} \\\\\n2\\sqrt{r_k^2 - b_i^2} & \\text{for } r_{k-1} \\le b_i < r_k \\\\\n0 & \\text{for } b_i \\ge r_k \n\\end{cases}\n$$\nwhere $r_k$ is the outer radius of shell $k$ and $b_i$ is the impact parameter of sightline $i$.\n\nThe measured signal $\\mathbf{M}$ is contaminated by scattered neutrons. The scattering contribution $S_i$ is modeled as a uniform offset proportional to the total neutron flux incident on the collimator assembly, $\\sum_{j=1}^{N} L_j$.\n$$\nM_i = L_i + S_i = L_i + c \\sum_{j=1}^{N} L_j\n$$\nwhere $c$ is the contamination fraction. In vector form, this is:\n$$\n\\mathbf{M} = \\mathbf{L} + c (\\mathbf{1}^T \\mathbf{L}) \\mathbf{1}\n$$\nwhere $\\mathbf{1}$ is an $N \\times 1$ vector of ones and $\\mathbf{1}^T$ is its transpose. Substituting $\\mathbf{L} = \\mathbf{A}\\mathbf{x}$, we get the full forward model for the measured signal:\n$$\n\\mathbf{M} = \\mathbf{A}\\mathbf{x} + c (\\mathbf{1}^T \\mathbf{A}\\mathbf{x}) \\mathbf{1}\n$$\nThe reconstruction algorithm, however, neglects scattering and assumes the simpler model $\\mathbf{M} \\approx \\mathbf{A}\\mathbf{x}^\\star$. The reconstructed emissivity profile $\\mathbf{x}^\\star$ is found by solving this system using the method of least squares, which minimizes the squared Euclidean norm $\\|\\mathbf{A}\\mathbf{x}^\\star - \\mathbf{M}\\|_2^2$. The solution is given by:\n$$\n\\mathbf{x}^\\star = (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{M}\n$$\nTo find the bias, we substitute the true expression for $\\mathbf{M}$ into the equation for $\\mathbf{x}^\\star$:\n$$\n\\mathbf{x}^\\star = (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\left[ \\mathbf{A}\\mathbf{x} + c (\\mathbf{1}^T \\mathbf{A}\\mathbf{x}) \\mathbf{1} \\right]\n$$\n$$\n\\mathbf{x}^\\star = (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{A}\\mathbf{x} + (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T c (\\mathbf{1}^T \\mathbf{A}\\mathbf{x}) \\mathbf{1}\n$$\nSince $\\mathbf{A}^T \\mathbf{A}$ is invertible (for a well-posed tomography problem, which is the case here as $N=K=12$ and the sightlines are distinct), $(\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{A} = \\mathbf{I}$, the identity matrix. The term $(\\mathbf{1}^T \\mathbf{A}\\mathbf{x})$ is a scalar representing the total signal.\n$$\n\\mathbf{x}^\\star = \\mathbf{x} + c (\\mathbf{1}^T \\mathbf{A}\\mathbf{x}) \\left[ (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{1} \\right]\n$$\nThe bias, defined as the difference $\\Delta \\mathbf{x} = \\mathbf{x}^\\star - \\mathbf{x}$, is therefore:\n$$\n\\Delta \\mathbf{x} = c (\\mathbf{1}^T \\mathbf{A}\\mathbf{x}) \\left[ (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{1} \\right]\n$$\nThis expression shows that the error in the reconstructed profile is a vector whose magnitude is proportional to the contamination fraction $c$ and the total true signal, and whose shape is determined by the geometry of the measurement system via the term $(\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{1}$.\n\n**2. Computational Algorithm**\n\nThe numerical implementation will proceed as follows:\n1.  **Set Constants and Geometry**: Define plasma radius $R=50\\,\\mathrm{cm}$, number of sightlines $N=12$, and number of shells $K=12$. Calculate shell radii $r_k = kR/K$ for $k \\in \\{1,\\dots,K\\}$ (with $r_0=0$) and impact parameters $b_i = R (i - 0.5)/N$ for $i \\in \\{1,\\dots,N\\}$.\n2.  **Construct True Emissivity Profile $\\mathbf{x}$**: For each shell $k$, calculate the midpoint radius $r_k^\\mathrm{mid} = (r_{k-1} + r_k)/2$. The emissivity for that shell is $x_k = e(r_k^\\mathrm{mid}) = e_0 \\exp(-(r_k^\\mathrm{mid}/\\alpha)^2)$ with $e_0=1$ and $\\alpha=20\\,\\mathrm{cm}$. This forms the vector $\\mathbf{x}$.\n3.  **Construct Geometry Matrix $\\mathbf{A}$**: Populate the $N \\times K$ matrix $\\mathbf{A}$ with elements $A_{ik}$ using the provided geometric formulas.\n4.  **Process Test Cases**: For each of the four cases:\n    a.  **Calculate Contamination Fraction $c$**:\n        The value of $c = f_{\\mathrm{acc}} \\omega P$ is determined by material properties.\n        - The macroscopic cross-sections are $\\Sigma_s = N \\sigma_s \\times 10^{-24}\\,\\mathrm{cm}^{-1}$ and $\\Sigma_t = N (\\sigma_s + \\sigma_a) \\times 10^{-24}\\,\\mathrm{cm}^{-1}$, where $N$ is the number density in $\\mathrm{cm}^{-3}$ and $\\sigma$ values are in barns ($1\\,\\mathrm{barn} = 10^{-24}\\,\\mathrm{cm}^2$).\n        - The single-scatter albedo is $\\omega = \\Sigma_s / \\Sigma_t$.\n        - The interaction probability is $P = 1 - e^{-\\Sigma_t \\ell}$, where $\\ell$ is the collimator thickness in $\\mathrm{cm}$.\n        - The number density $N$ is calculated from the mass density $\\rho$, molar mass $M$, and Avogadro's number $N_A = 6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1}$ using $N = (\\rho/M) N_A$. For polyethylene ($\\mathrm{CH}_2$), this gives the molecular number density, and the microscopic cross-sections are summed per molecule: $\\sigma_{s,\\mathrm{mol}} = 2\\sigma_{s,\\mathrm{H}} + \\sigma_{s,\\mathrm{C}}$ and $\\sigma_{a,\\mathrm{mol}} = 2\\sigma_{a,\\mathrm{H}} + \\sigma_{a,\\mathrm{C}}$.\n    b.  **Calculate Measured Signal $\\mathbf{M}$**:\n        - First, compute the true line-integrated signals: $\\mathbf{L} = \\mathbf{A}\\mathbf{x}$.\n        - Then, compute the total signal: $L_{\\mathrm{tot}} = \\sum_{j=1}^{N} L_j$.\n        - Finally, construct the contaminated measurement vector: $M_i = L_i + c L_{\\mathrm{tot}}$.\n    c.  **Reconstruct Biased Profile $\\mathbf{x}^\\star$**: Solve the least-squares problem $\\mathbf{A}\\mathbf{x}^\\star \\approx \\mathbf{M}$ for $\\mathbf{x}^\\star$.\n    d.  **Compute RMSE**: Calculate the relative root-mean-square error using the formula:\n        $$\n        \\mathrm{RMSE} = \\frac{\\sqrt{\\frac{1}{K}\\sum_{k=1}^{K} (x^\\star_k - x_k)^2}}{\\sqrt{\\frac{1}{K}\\sum_{k=1}^{K} x_k^2}}\n        $$\n        Note that the $\\sqrt{1/K}$ term appears in both the numerator and denominator and can be canceled, simplifying the calculation to the ratio of the Euclidean norms of the error vector and the true vector: $\\mathrm{RMSE} = \\|\\mathbf{x}^\\star - \\mathbf{x}\\|_2 / \\|\\mathbf{x}\\|_2$.\n\nFor the final, fourth case, $f_{\\mathrm{acc}}=0.0$, which implies $c=0.0$. In this scenario, $\\mathbf{M}=\\mathbf{L}=\\mathbf{A}\\mathbf{x}$. The least-squares solution will be $\\mathbf{x}^\\star = (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T (\\mathbf{A}\\mathbf{x}) = \\mathbf{x}$. Therefore, the bias $\\mathbf{x}^\\star - \\mathbf{x}$ is zero, and the RMSE must be exactly $0.0$. This provides a valuable sanity check for the correctness of the overall implementation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neutron emissivity reconstruction problem, accounting for scattering bias.\n    The methodology follows these steps:\n    1. Define shared physical and geometric parameters.\n    2. Construct the true emissivity profile vector 'x'.\n    3. Construct the geometry matrix 'A' based on chord lengths.\n    4. For each test case:\n       a. Calculate the contamination fraction 'c' from material properties.\n       b. Simulate the 'measured' signal 'M' including the scattering term.\n       c. Reconstruct the biased emissivity profile 'x_star' using least squares.\n       d. Compute the Relative Root-Mean-Square Error (RMSE) between 'x' and 'x_star'.\n    5. Print the list of RMSE values.\n    \"\"\"\n\n    # --- Step 1: Define shared parameters ---\n    R = 50.0  # Plasma radius in cm\n    N = 12    # Number of sightlines\n    K = 12    # Number of emissivity shells\n    e0 = 1.0  # Peak emissivity (arbitrary units)\n    alpha = 20.0  # Emissivity profile scale length in cm\n    NA = 6.022e23 # Avogadro's number in mol^-1\n\n    # Define geometry: shell radii and sightline impact parameters\n    # Shell radii r_k for k from 0 to K\n    r_radii = np.linspace(0, R, K + 1)\n    \n    # Impact parameters b_i for i from 1 to N\n    b_impacts = R * (np.arange(1, N + 1) - 0.5) / N\n\n    # --- Step 2: Construct the true emissivity profile vector 'x' ---\n    # Shell indices k from 1 to K (0 to K-1 in Python)\n    shell_indices = np.arange(K)\n    r_k_minus_1 = r_radii[shell_indices]\n    r_k = r_radii[shell_indices + 1]\n    \n    # Midpoint radius for each shell\n    r_mid = (r_k_minus_1 + r_k) / 2.0\n    \n    # True emissivity vector x (K x 1)\n    x_true = e0 * np.exp(-(r_mid / alpha)**2)\n\n    # --- Step 3: Construct the geometry matrix 'A' ---\n    # A is an N x K matrix\n    A = np.zeros((N, K))\n    for i in range(N):  # Loop over sightlines\n        bi = b_impacts[i]\n        for k in range(K):  # Loop over shells\n            rk_minus_1 = r_radii[k]\n            rk = r_radii[k+1]\n            \n            # Use a small epsilon to handle floating point comparisons at boundaries\n            epsilon = 1e-9\n\n            if bi >= rk - epsilon:\n                A[i, k] = 0.0\n            elif bi  rk_minus_1:\n                # Chord passes through the shell without grazing the inner boundary\n                term1 = np.sqrt(rk**2 - bi**2)\n                term2 = np.sqrt(rk_minus_1**2 - bi**2)\n                A[i, k] = 2.0 * (term1 - term2)\n            else: # rk_minus_1 = bi  rk\n                # Chord starts inside the shell\n                A[i, k] = 2.0 * np.sqrt(rk**2 - bi**2)\n\n    # --- Step 4: Process each test case ---\n    test_cases = [\n        # Case 1: Polyethylene\n        {\n            'name': 'Polyethylene', 'ell': 10.0, 'rho': 0.93, 'M': 14.0,\n            'sigma_s': 2 * 3.5 + 1.0, 'sigma_a': 2 * 0.002 + 0.003,\n            'f_acc': 0.002, 'is_molecular': True\n        },\n        # Case 2: Tungsten\n        {\n            'name': 'Tungsten', 'ell': 15.0, 'rho': 19.3, 'M': 183.84,\n            'sigma_s': 2.0, 'sigma_a': 0.5, 'f_acc': 0.0005, 'is_molecular': False\n        },\n        # Case 3: Lead\n        {\n            'name': 'Lead', 'ell': 10.0, 'rho': 11.34, 'M': 207.2,\n            'sigma_s': 1.5, 'sigma_a': 0.3, 'f_acc': 0.0006, 'is_molecular': False\n        },\n        # Case 4: Zero-scattering Tungsten\n        {\n            'name': 'Tungsten (Zero-scatter)', 'ell': 15.0, 'rho': 19.3, 'M': 183.84,\n            'sigma_s': 2.0, 'sigma_a': 0.5, 'f_acc': 0.0, 'is_molecular': False\n        }\n    ]\n\n    rmse_results = []\n\n    # Calculate true line-integrated signals L = A * x\n    L_true = A @ x_true\n\n    for case in test_cases:\n        # --- 4a. Calculate contamination fraction 'c' ---\n        if case['f_acc'] == 0.0:\n            c = 0.0\n        else:\n            # Number density (atoms or molecules per cm^3)\n            num_density = (case['rho'] / case['M']) * NA\n            \n            # Macroscopic cross-sections (cm^-1)\n            sigma_s_barns = case['sigma_s']\n            sigma_a_barns = case['sigma_a']\n            \n            Sigma_s = num_density * sigma_s_barns * 1e-24\n            Sigma_t = num_density * (sigma_s_barns + sigma_a_barns) * 1e-24\n\n            # Single-scatter albedo (dimensionless)\n            omega = Sigma_s / Sigma_t if Sigma_t > 0 else 0.0\n\n            # Interaction probability (dimensionless)\n            ell = case['ell']\n            P = 1.0 - np.exp(-Sigma_t * ell)\n\n            # Contamination fraction (dimensionless)\n            c = case['f_acc'] * omega * P\n\n        # --- 4b. Calculate measured signal 'M' ---\n        L_total = np.sum(L_true)\n        # Note: (c * L_total) is a scalar added to each element of L_true\n        M_measured = L_true + c * L_total\n\n        # --- 4c. Reconstruct biased profile 'x_star' ---\n        # Solve the least squares problem A*x_star = M_measured\n        x_star, _, _, _ = np.linalg.lstsq(A, M_measured, rcond=None)\n        \n        # --- 4d. Compute RMSE ---\n        # Numerator: sqrt(mean((x_star - x_true)^2))\n        # Denominator: sqrt(mean(x_true^2))\n        # This is equivalent to norm(x_star - x_true) / norm(x_true)\n        \n        norm_diff = np.linalg.norm(x_star - x_true)\n        norm_true = np.linalg.norm(x_true)\n        \n        # Guard against division by zero, although norm_true > 0 here.\n        rmse = norm_diff / norm_true if norm_true > 0 else 0.0\n        \n        rmse_results.append(rmse)\n\n    # --- Step 5: Final Output ---\n    # Format the results as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, rmse_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}