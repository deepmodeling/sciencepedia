{
    "hands_on_practices": [
        {
            "introduction": "点缺陷是理解聚变环境中材料演化的基础。本练习将第一性原理计算得到的原子级能量参数（如形成能和迁移能）与宏观尺度上的可观测量（如缺陷浓度和扩散系数）联系起来，这是构建多尺度模型至关重要的第一步。通过这个计算，您将掌握如何量化材料在高温下的基本热力学和动力学特性。",
            "id": "4017104",
            "problem": "一个温度为 $T = 1200\\ \\mathrm{K}$ 的体心立方（BCC）结构单原子钨晶体中，含有热激活的点缺陷：空位和自填隙原子（SIA）。假设为无相互作用的稀疏缺陷气体，并忽略形成熵。第一性原理计算提供了钨中性缺陷的以下能量学数据：空位形成能 $E_f^{\\mathrm{vac}} = 3.2\\ \\mathrm{eV}$，空位迁移势垒 $E_m^{\\mathrm{vac}} = 1.7\\ \\mathrm{eV}$，自填隙原子形成能 $E_f^{\\mathrm{SIA}} = 10.5\\ \\mathrm{eV}$，以及自填隙原子迁移势垒 $E_m^{\\mathrm{SIA}} = 0.02\\ \\mathrm{eV}$。在 $T = 1200\\ \\mathrm{K}$ 时，钨的晶格常数为 $a_0 = 3.18 \\times 10^{-10}\\ \\mathrm{m}$。将缺陷运动视为 BCC 网络上的无记忆连续时间随机行走：缺陷在由主晶格的最近邻矢量分隔的等效位置之间跳跃，有 $z = 8$ 个等效跳跃方向。假设使用谐波过渡态理论（TST），两种缺陷的方向分辨尝试频率均为 $\\nu_0 = 1.0 \\times 10^{13}\\ \\mathrm{s}^{-1}$。使用玻尔兹曼常数 $k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$。\n\n从平衡占据数的正则系综和激活跳跃的过渡态理论出发，计算在 $T = 1200\\ \\mathrm{K}$ 时的以下物理量：\n- 空位 $c_{\\mathrm{vac}}$ 和自填隙原子 $c_{\\mathrm{SIA}}$ 的平衡位点分数（无量纲）。\n- 缺陷扩散系数 $D_{\\mathrm{vac}}$ 和 $D_{\\mathrm{SIA}}$（单位为 $\\mathrm{m}^2\\ \\mathrm{s}^{-1}$），将每种缺陷视为 BCC 网络上的无偏三维随机行走者。\n\n将您的最终结果按 $\\left(c_{\\mathrm{vac}},\\ c_{\\mathrm{SIA}},\\ D_{\\mathrm{vac}},\\ D_{\\mathrm{SIA}}\\right)$ 的顺序以单行形式报告。将两种浓度表示为位点分数（无量纲），两种扩散系数以 $\\mathrm{m}^2\\ \\mathrm{s}^{-1}$ 为单位。将所有四个量四舍五入到四位有效数字。",
            "solution": "问题陈述经核实具有科学依据，问题明确且客观。它提供了计算所需量所需的所有必要参数和清晰的理论框架（平衡态的正则系综，动力学的过渡态理论）。该问题是固态物理和材料科学中的一个标准练习。我们开始解题。\n\n问题要求计算四个量：空位（$c_{\\mathrm{vac}}$）和自填隙原子（$c_{\\mathrm{SIA}}$）的平衡位点分数，以及它们各自的扩散系数（$D_{\\mathrm{vac}}$ 和 $D_{\\mathrm{SIA}}$）。\n\n首先，我们确定平衡位点分数。在无相互作用的稀疏缺陷气体极限下，缺陷的平衡位点分数 $c$ 由其形成自由能 $\\Delta G_f = E_f - T S_f$ 决定。浓度由 $c=g \\exp(-\\Delta G_f / (k_B T))$ 给出，其中 $g$ 是构型多重性因子，$E_f$ 是形成能，$S_f$ 是形成熵，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。问题指明要忽略形成熵（$S_f=0$），所以 $\\Delta G_f = E_f$。对于晶格上的空位，多重性因子 $g$ 为 $1$。对于自填隙原子，尽管每个晶格原子可能存在多个等效的填隙位置，从而产生一个多重性因子，但在明确忽略形成熵的情况下，通常将 $g$ 设为 $1$，因为这种构型熵通常被认为是总形成熵的一部分。因此，位点分数由简化的阿伦尼乌斯型表达式给出：\n$$c_{\\mathrm{vac}} = \\exp\\left(-\\frac{E_f^{\\mathrm{vac}}}{k_B T}\\right)$$\n$$c_{\\mathrm{SIA}} = \\exp\\left(-\\frac{E_f^{\\mathrm{SIA}}}{k_B T}\\right)$$\n给定温度 $T = 1200\\ \\mathrm{K}$ 和玻尔兹曼常数 $k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$。热能为：\n$$k_B T = (8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}) \\times (1200\\ \\mathrm{K}) \\approx 0.103408\\ \\mathrm{eV}$$\n使用给定的形成能 $E_f^{\\mathrm{vac}} = 3.2\\ \\mathrm{eV}$ 和 $E_f^{\\mathrm{SIA}} = 10.5\\ \\mathrm{eV}$：\n$$c_{\\mathrm{vac}} = \\exp\\left(-\\frac{3.2\\ \\mathrm{eV}}{0.103408\\ \\mathrm{eV}}\\right) \\approx \\exp(-30.945) \\approx 3.6358 \\times 10^{-14}$$\n$$c_{\\mathrm{SIA}} = \\exp\\left(-\\frac{10.5\\ \\mathrm{eV}}{0.103408\\ \\mathrm{eV}}\\right) \\approx \\exp(-101.540) \\approx 8.8996 \\times 10^{-45}$$\n\n其次，我们确定缺陷扩散系数。对于晶格上的无偏三维随机行走，扩散系数 $D$ 由下式给出：\n$$D = \\frac{1}{6} \\Gamma_{\\text{total}} l^2$$\n其中 $\\Gamma_{\\text{total}}$ 是从一个位置的总跳跃率，$l$ 是跳跃距离。对于缺陷本身（空位或填隙原子）的扩散，随机行走是不相关的，因此相关因子 $f=1$。\n总跳跃率是 $\\Gamma_{\\text{total}} = z \\Gamma_{\\text{jump}}$，其中 $z$ 是可用的跳跃方向数，$\\Gamma_{\\text{jump}}$ 是单次跳跃的速率。对于 BCC 晶格，最近邻跳跃有 $z=8$。\n单次跳跃速率 $\\Gamma_{\\text{jump}}$ 由谐波过渡态理论给出：\n$$\\Gamma_{\\text{jump}} = \\nu_0 \\exp\\left(-\\frac{E_m}{k_B T}\\right)$$\n其中 $\\nu_0$ 是方向分辨的尝试频率，$E_m$ 是迁移能垒。\n对于晶格常数为 $a_0$ 的 BCC 晶格，最近邻跳跃的距离 $l$ 是体对角线的一半：\n$$l = \\frac{\\sqrt{3}}{2} a_0$$\n将这些表达式代入扩散系数的公式中：\n$$D = \\frac{1}{6} (z \\Gamma_{\\text{jump}}) l^2 = \\frac{1}{6} \\left(8 \\left[ \\nu_0 \\exp\\left(-\\frac{E_m}{k_B T}\\right) \\right] \\right) \\left(\\frac{\\sqrt{3}}{2} a_0\\right)^2$$\n$$D = \\frac{8}{6} \\nu_0 \\exp\\left(-\\frac{E_m}{k_B T}\\right) \\frac{3}{4} a_0^2 = \\frac{24}{24} \\nu_0 a_0^2 \\exp\\left(-\\frac{E_m}{k_B T}\\right) = \\nu_0 a_0^2 \\exp\\left(-\\frac{E_m}{k_B T}\\right)$$\n这个简化结果是针对 BCC 晶格参数的。我们将此公式用于空位和自填隙原子，并使用它们各自的迁移能。指前因子为：\n$$\\nu_0 a_0^2 = (1.0 \\times 10^{13}\\ \\mathrm{s}^{-1}) \\times (3.18 \\times 10^{-10}\\ \\mathrm{m})^2 = 1.01124 \\times 10^{-6}\\ \\mathrm{m}^2/\\mathrm{s}$$\n对于空位，其 $E_m^{\\mathrm{vac}} = 1.7\\ \\mathrm{eV}$：\n$$D_{\\mathrm{vac}} = (1.01124 \\times 10^{-6}\\ \\mathrm{m}^2/\\mathrm{s}) \\times \\exp\\left(-\\frac{1.7\\ \\mathrm{eV}}{0.103408\\ \\mathrm{eV}}\\right) \\approx (1.01124 \\times 10^{-6}) \\times \\exp(-16.439) \\approx 7.3353 \\times 10^{-14}\\ \\mathrm{m}^2/\\mathrm{s}$$\n对于自填隙原子，其 $E_m^{\\mathrm{SIA}} = 0.02\\ \\mathrm{eV}$：\n$$D_{\\mathrm{SIA}} = (1.01124 \\times 10^{-6}\\ \\mathrm{m}^2/\\mathrm{s}) \\times \\exp\\left(-\\frac{0.02\\ \\mathrm{eV}}{0.103408\\ \\mathrm{eV}}\\right) \\approx (1.01124 \\times 10^{-6}) \\times \\exp(-0.1934) \\approx 8.3347 \\times 10^{-7}\\ \\mathrm{m}^2/\\mathrm{s}$$\n\n按要求将最终结果四舍五入到四位有效数字：\n$c_{\\mathrm{vac}} = 3.636 \\times 10^{-14}$\n$c_{\\mathrm{SIA}} = 8.900 \\times 10^{-45}$\n$D_{\\mathrm{vac}} = 7.335 \\times 10^{-14}\\ \\mathrm{m}^2/\\mathrm{s}$\n$D_{\\mathrm{SIA}} = 8.335 \\times 10^{-7}\\ \\mathrm{m}^2/\\mathrm{s}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.636 \\times 10^{-14} & 8.900 \\times 10^{-45} & 7.335 \\times 10^{-14} & 8.335 \\times 10^{-7}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "分子动力学（MD）模拟如同一个“计算显微镜”，让我们能实时观察高能粒子如何在材料内部引发原子位移级联。然而，一个可靠的模拟结果高度依赖于正确的“实验设置”。本练习挑战您设计一个稳健的虚拟实验，通过合理选择边界条件、温控方式和系统尺寸，来精确捕捉一个 $10\\,\\mathrm{keV}$ 能量的级联事件，同时避免非物理的计算假象。",
            "id": "4017089",
            "problem": "一个能量为 $10\\,\\mathrm{keV}$ 的初级离位原子 (PKA) 在钨中引发了一个位移级联，该过程将通过分子动力学 (MD) 进行模拟。目标是选择一种能够最小化有限尺寸效应的模拟设置，同时捕捉弹道阶段和热峰阶段，并为计算聚变材料建模中的后续多尺度耦合提供可靠的缺陷统计。假设钨的属性和建模输入如下：密度 $\\rho = 19.25\\ \\mathrm{g/cm^3}$，原子质量 $M = 183.84\\ \\mathrm{g/mol}$，熔化温度 $T_m = 3695\\ \\mathrm{K}$，初始温度 $T_0 = 300\\ \\mathrm{K}$，熔化潜热 $L_f = 35\\ \\mathrm{kJ/mol}$，玻尔兹曼常数 $k_B = 8.617\\times 10^{-5}\\ \\mathrm{eV/K}$，纵向声速 $c_s = 5200\\ \\mathrm{m/s}$，以及在级联过程中沉积到原子子系统中的 PKA 能量分数 $f=0.7$。PKA 是通过沿某个晶体学方向赋予单个原子 $10\\,\\mathrm{keV}$ 的动能而产生的。力场是为钨参数化的嵌入原子方法 (EAM) 势，如果需要，可以通过对足够快的原子施加速度比例阻尼来模拟电子阻止效应。\n\n从第一性原理出发，该设置必须确保应力波和热量被吸收而无虚假反射，弹道阶段不被人为阻尼，并且级联不与其周期性镜像相互作用。它还必须通过适当的淬火方案，产生一个明确的级联后缺陷统计。在所述假设下，哪个选项最能满足这些要求？\n\nA. 盒子长度 $L=12\\ \\mathrm{nm}$，所有方向均为周期性边界条件，在所有时间对所有原子应用一个全局 Nose–Hoover 温控器（温度 $T=300\\ \\mathrm{K}$），PKA 在随机位置插入，并在 $t=1\\ \\mathrm{ps}$ 时执行最速下降法淬火至 $0\\ \\mathrm{K}$。\n\nB. 盒子长度 $L=40\\ \\mathrm{nm}$，所有方向均为周期性边界条件；在弹道和热峰阶段，以 PKA 为中心设置一个半径为 $r_{\\mathrm{core}}=12\\ \\mathrm{nm}$ 的内部微正则系综（恒定原子数、体积和能量，NVE）区域；周围是一个厚度为 $6\\ \\mathrm{nm}$ 的 Langevin 温控器环，维持在 $T=300\\ \\mathrm{K}$，阻尼率为 $\\gamma=1\\ \\mathrm{ps^{-1}}$，用于吸收应力波并充当热沉；电子阻止效应通过对速度 $v>40{,}000\\ \\mathrm{m/s}$ 的原子施加速度比例阻尼来实现；在 NVE 中演化 $t_b=5\\ \\mathrm{ps}$，然后在 $T=300\\ \\mathrm{K}$ 下进行 $100\\ \\mathrm{ps}$ 的正则系综 ($NVT$) 退火，最后通过共轭梯度能量最小化到 $0\\ \\mathrm{K}$ 进行最终的缺陷识别。\n\nC. 盒子长度 $L=20\\ \\mathrm{nm}$，采用固定 (Dirichlet) 边界条件，无温控器；PKA 在距离边界 $2\\ \\mathrm{nm}$ 的位置引发；在 NVE 中演化 $t=50\\ \\mathrm{ps}$，之后不进行任何淬火直接统计缺陷。\n\nD. 盒子长度 $L=80\\ \\mathrm{nm}$，采用周期性边界；在弹道阶段对所有原子应用一个弛豫时间为 $\\tau_T=0.05\\ \\mathrm{ps}$ 的全局 Nose–Hoover 温控器，然后瞬时将温度降至 $0\\ \\mathrm{K}$；没有局域吸收层；PKA 在盒子中心引发。\n\nE. 盒子长度 $L=30\\ \\mathrm{nm}$，采用周期性边界；一个半径为 $r_{\\mathrm{core}}=8\\ \\mathrm{nm}$ 的内部 NVE 核心和一个厚度为 $3\\ \\mathrm{nm}$ 的外部 Langevin 环，温度为 $T=300\\ \\mathrm{K}$，强阻尼率为 $\\gamma=10\\ \\mathrm{ps^{-1}}$；弹道演化 $t_b=2\\ \\mathrm{ps}$，然后进行 NVT 退火和能量最小化。\n\n选择最佳选项。通过基本定律和经过检验的事实（能量守恒、熔化热力学、声传播以及温控器和边界条件的动力学系统考虑）进行推理，证明您的选择，并解释该选择如何避免钨中 $10\\,\\mathrm{keV}$ PKA 产生的有限尺寸效应。",
            "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取给定条件\n\n问题陈述中提供了以下数据和条件：\n-   初级离位原子 (PKA) 能量：$E_{PKA} = 10\\ \\mathrm{keV}$\n-   材料：钨 (W)\n-   密度：$\\rho = 19.25\\ \\mathrm{g/cm^3}$\n-   原子质量：$M = 183.84\\ \\mathrm{g/mol}$\n-   熔化温度：$T_m = 3695\\ \\mathrm{K}$\n-   初始温度：$T_0 = 300\\ \\mathrm{K}$\n-   熔化潜热：$L_f = 35\\ \\mathrm{kJ/mol}$\n-   玻尔兹曼常数：$k_B = 8.617\\times 10^{-5}\\ \\mathrm{eV/K}$\n-   纵向声速：$c_s = 5200\\ \\mathrm{m/s}$\n-   沉积到原子子系统中的 PKA 能量分数：$f=0.7$\n-   力场：为钨参数化的嵌入原子方法 (EAM) 势。\n-   模拟要求：\n    1.  最小化有限尺寸效应。\n    2.  捕捉弹道和热峰阶段。\n    3.  产生可靠的缺陷统计。\n    4.  吸收应力波和热量而无虚假反射。\n    5.  避免对弹道阶段的人为阻尼。\n    6.  级联不能与其周期性镜像相互作用。\n    7.  通过适当的淬火方案产生明确的级联后缺陷统计。\n\n### 步骤 2：使用提取的给定条件进行验证\n\n该问题具有科学依据。它描述了材料辐射损伤领域的一个标准计算实验，这是计算聚变科学中的一个关键课题。提供的钨的物理量在事实上是可靠的，并且在公认的范围内。理论概念——位移级联、热峰、电子阻止、分子动力学系综（$NVE$，$NVT$）、温控器（Nose-Hoover，Langevin）和边界条件（周期性、固定）——都是凝聚态物理和计算材料科学中的基本和标准概念。\n\n这个问题提得很好。它要求从一系列选项中选出最佳的模拟设置，并根据一套明确的、有物理动机的标准进行评判。这些标准是自洽的，并代表了此类模拟的既定最佳实践。该问题是客观的，没有歧义或主观性语言。它包含足够的信息，可以根据第一性原理对选项进行严格评估。未发现清单中的任何缺陷。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效**的。将通过分析事件的物理尺度，并根据既定的最佳实践评估每个选项来推导出解决方案。\n\n### 物理尺度和模拟要求的推导\n\n首先，我们确定位移级联的关键物理尺度，以确定必要的模拟参数。\n\n1.  **能量沉积和级联尺寸**：PKA 的能量为 $E_{PKA} = 10\\ \\mathrm{keV}$。其中一部分（$f=0.7$）沉积到核运动中，产生级联。驱动原子位移的能量是 $E_{nuc} = f \\times E_{PKA} = 0.7 \\times 10\\ \\mathrm{keV} = 7\\ \\mathrm{keV}$。剩余的 $3\\ \\mathrm{keV}$ 因电子激发（电子阻止）而损失。\n\n    我们可以估算热峰熔融核心的尺寸。将一个原子从 $T_0 = 300\\ \\mathrm{K}$ 加热到 $T_m = 3695\\ \\mathrm{K}$ 并使其熔化所需的能量是 $E_{melt/atom} = C_p(T_m - T_0) + L_f$。使用杜隆-珀蒂近似估算摩尔热容 $C_p \\approx 3R$，每个原子的比热约为 $3k_B$。\n    $$ \\Delta E_{heat} = 3 k_B (T_m - T_0) = 3(8.617\\times 10^{-5}\\ \\mathrm{eV/K})(3695 - 300)\\ \\mathrm{K} \\approx 0.877\\ \\mathrm{eV/atom} $$\n    每个原子的熔化潜热为 $L_f = (35\\ \\mathrm{kJ/mol}) / N_{Av} \\approx 0.363\\ \\mathrm{eV/atom}$。\n    总能量为 $E_{atom} \\approx 0.877 + 0.363 = 1.24\\ \\mathrm{eV/atom}$。\n    熔化的原子数约为 $N_{melt} \\approx E_{nuc} / E_{atom} = 7000\\ \\mathrm{eV} / 1.24\\ \\mathrm{eV/atom} \\approx 5645$ 个原子。\n    钨的数密度为 $n = \\rho N_{Av} / M \\approx 6.30 \\times 10^{22}\\ \\mathrm{cm^{-3}} = 63.0\\ \\mathrm{nm^{-3}}$。\n    熔融核心的体积为 $V_{melt} = N_{melt} / n \\approx 5645 / 63.0 \\ \\mathrm{nm^3} \\approx 89.6\\ \\mathrm{nm^3}$。\n    等效球形核心的半径为 $r_{melt} = (3V_{melt} / 4\\pi)^{1/3} \\approx 2.8\\ \\mathrm{nm}$。\n    实际的级联不是一个均匀熔化的球体；它是高度分支的，并且显著原子运动的区域比这个熔融核心要大。一个常见的经验法则是，级联的空间范围约为每 keV 几纳米，因此对于 $10\\ \\mathrm{keV}$ 的事件，动态区域的半径可能延伸到 $5-10\\ \\mathrm{nm}$。因此，未受扰动的（$NVE$）模拟区域的半径必须大于此值，而总的盒子尺寸必须更大。\n\n2.  **时间尺度和边界条件**：\n    -   **弹道阶段**极短（$<1\\ \\mathrm{ps}$），在此阶段原子通过高能碰撞而离位。\n    -   接着是**热峰阶段**，动能被热化成一个热的、无序的区域，该区域在几皮秒（$5-10\\ \\mathrm{ps}$）内冷却。\n    -   **声波**（冲击波）以声速 $c_s = 5200\\ \\mathrm{m/s}$ 从级联中传播出去。一个关键的有限尺寸效应是压力波从边界反射回来，并在级联核心仍在演化时返回到核心。波穿过长度为 $L$ 的盒子并与其周期性镜像相互作用的时间是 $t_{recur} = L / c_s$。为避免在热峰冷却期间（$t_{cool} \\approx 10\\ \\mathrm{ps}$）发生干扰，我们需要 $L > c_s t_{cool} \\approx (5200\\ \\mathrm{m/s})(10\\ \\mathrm{ps}) = 52\\ \\mathrm{nm}$。这样大小的盒子计算成本很高。\n    -   解决方案是使用“无反射”或“吸收”边界条件。这通常通过将模拟单元的外部原子耦合到一个能够阻尼入射波的温控器来实现，该温控器同时充当热量和机械能的吸收器（热沉和能沉）。**Langevin 温控器**是实现此目的的理想选择。包含级联的内部核心使用微正则（$NVE$）系综进行演化，以保持其自然动力学，而其外部则被一个温控层包围。\n    -   对所有原子应用**全局温控器**（如 Nose-Hoover）在物理上是不正确的，因为它会人为地从非平衡的级联中抽走能量，过早地淬灭热峰并抑制损伤的产生。\n    -   **固定边界**是灾难性的，因为它们对声波来说是完美的反射器。\n\n3.  **缺陷退火和识别**：在热峰淬灭（$> 10\\ \\mathrm{ps}$）后，会残留一定数量的缺陷。其中许多是不稳定的，并将在几十到几百皮秒内复合。为了获得可靠的长期缺陷统计，系统应在目标温度（$T_0=300\\ \\mathrm{K}$）下演化足够长的时间（例如 $50-100\\ \\mathrm{ps}$），以允许这种短期结构弛豫。最后，必须将系统淬火至 $0\\ \\mathrm{K}$（例如，通过能量最小化），以消除热振动，从而可以明确地计数稳定缺陷。\n\n### 选项评估\n\n**A. 盒子长度 $L=12\\ \\mathrm{nm}$，所有方向均为周期性边界条件，在所有时间对所有原子应用一个全局 Nose–Hoover 温控器（温度 $T=300\\ \\mathrm{K}$），PKA 在随机位置插入，并在 $t=1\\ \\mathrm{ps}$ 时执行最速下降法淬火至 $0\\ \\mathrm{K}$。**\n-   **盒子尺寸**：$L=12\\ \\mathrm{nm}$ 太小了。盒子半长（$6\\ \\mathrm{nm}$）与预期的级联半径相当或更小。级联将与其周期性镜像相互作用。\n-   **温控器**：全局 Nose-Hoover 温控器是不正确的。它会人为地淬灭热峰。\n-   **淬火时间**：在 $t_q=1\\ \\mathrm{ps}$ 时淬火为时过早。此时热峰仍处于峰值。这将严重高估最终的缺陷数量。\n**结论**：不正确。此设置违反了级联模拟的多个基本原则。\n\n**B. 盒子长度 $L=40\\ \\mathrm{nm}$，所有方向均为周期性边界条件；在弹道和热峰阶段，以 PKA 为中心设置一个半径为 $r_{\\mathrm{core}}=12\\ \\mathrm{nm}$ 的内部微正则系综（恒定原子数、体积和能量，NVE）区域；周围是一个厚度为 $6\\ \\mathrm{nm}$ 的 Langevin 温控器环，维持在 $T=300\\ \\mathrm{K}$，阻尼率为 $\\gamma=1\\ \\mathrm{ps^{-1}}$，用于吸收应力波并充当热沉；电子阻止效应通过对速度 $v>40{,}000\\ \\mathrm{m/s}$ 的原子施加速度比例阻尼来实现；在 NVE 中演化 $t_b=5\\ \\mathrm{ps}$，然后在 $T=300\\ \\mathrm{K}$ 下进行 $100\\ \\mathrm{ps}$ 的正则系综 ($NVT$) 退火，最后通过共轭梯度能量最小化到 $0\\ \\mathrm{K}$ 进行最终的缺陷识别。**\n-   **盒子尺寸**：$L=40\\ \\mathrm{nm}$ 是一个宽裕且合适的尺寸。\n-   **温控器/边界条件**：核-壳方法（$NVE$ 核心，Langevin 壳层）是创建无反射边界的最新技术。$NVE$ 核心半径 $r_{core}=12\\ \\mathrm{nm}$ 足够大，可以容纳级联。Langevin 层可作为有效的热量和压力吸收器。\n-   **电子阻止**：对高速原子包含速度比例阻尼在物理上是正确的，并且对于 keV 范围的级联是必要的。\n-   **方案**：时间演化方案非常出色。$t_b=5\\ \\mathrm{ps}$ 足以捕捉主要的级联动力学。随后的 $100\\ \\mathrm{ps}$ $NVT$ 退火允许短期缺陷复合，而最终的共轭梯度最小化提供了稳定、可分析的 $0\\ \\mathrm{K}$ 结构。\n**结论**：正确。此选项代表了模拟位移级联的最佳实践方法。\n\n**C. 盒子长度 $L=20\\ \\mathrm{nm}$，采用固定 (Dirichlet) 边界条件，无温控器；PKA 在距离边界 $2\\ \\mathrm{nm}$ 的位置引发；在 NVE 中演化 $t=50\\ \\mathrm{ps}$，之后不进行任何淬火直接统计缺陷。**\n-   **盒子尺寸和 PKA 位置**：$L=20\\ \\mathrm{nm}$ 很小，并且在离边界仅 $2\\ \\mathrm{nm}$ 处引发 PKA 是一个严重错误，这保证了会立即产生严重的边界效应。\n-   **边界条件**：固定边界是最差的选择，因为它们会导致应力波的完美反射。\n-   **方案**：在 $t=50\\ \\mathrm{ps}$ 时不进行最终淬火至 $0\\ \\mathrm{K}$ 就统计缺陷是不可靠的，因为热振动会掩盖真实的缺陷构型。\n**结论**：不正确。此设置几乎在所有方面都有缺陷。\n\n**D. 盒子长度 $L=80\\ \\mathrm{nm}$，采用周期性边界；在弹道阶段对所有原子应用一个弛豫时间为 $\\tau_T=0.05\\ \\mathrm{ps}$ 的全局 Nose–Hoover 温控器，然后瞬时将温度降至 $0\\ \\mathrm{K}$；没有局域吸收层；PKA 在盒子中心引发。**\n-   **盒子尺寸**：$L=80\\ \\mathrm{nm}$ 的大尺寸很好，有助于减轻周期性边界条件 (PBC) 效应。\n-   **温控器**：在弹道阶段使用全局 Nose-Hoover 温控器是一个致命缺陷。极快的弛豫时间 $\\tau_T=0.05\\ \\mathrm{ps}$ 会极度地从级联中抽走能量，破坏模拟的物理真实性。\n-   **方案**：缺少局域吸收层是一个缺陷，完全依赖于大盒子尺寸。整个方案因不正确的温控方式而无效。\n**结论**：不正确。温控方案在物理上是错误的。\n\n**E. 盒子长度 $L=30\\ \\mathrm{nm}$，采用周期性边界；一个半径为 $r_{\\mathrm{core}}=8\\ \\mathrm{nm}$ 的内部 NVE 核心和一个厚度为 $3\\ \\mathrm{nm}$ 的外部 Langevin 环，温度为 $T=300\\ \\mathrm{K}$，强阻尼率为 $\\gamma=10\\ \\mathrm{ps^{-1}}$；弹道演化 $t_b=2\\ \\mathrm{ps}$，然后进行 NVT 退火和能量最小化。**\n-   **温控器/边界条件**：核-壳方法是正确的。然而，对于像 W 这样的重元素中的 $10\\ \\mathrm{keV}$ 级联来说，$NVE$ 核心半径 $r_{core}=8\\ \\mathrm{nm}$ 偏小，如果级联到达温控层，则存在人为阻尼的风险。\n-   **Langevin 阻尼**：阻尼率 $\\gamma=10\\ \\mathrm{ps^{-1}}$ 非常高。虽然意在吸收，但过强的阻尼本身会在 $NVE$ 和 Langevin 区域之间的界面引起反射。\n-   **方案**：仅 $t_b=2\\ \\mathrm{ps}$ 的弹道演化时间很短。虽然主要的弹道阶段更快，但在任何退火方案开始之前，允许更多时间（如 B 选项中的 $5\\ \\mathrm{ps}$）来捕捉能量完全传递到晶格的过程会更安全。\n**结论**：不正确。虽然它使用了正确的方法，但所选参数不如选项 B 优化，风险也更大。核心可能太小，阻尼过于激进。选项 B 是一个更安全、更稳健的设置。\n\n### 结论\n\n选项 B 为模拟提供了物理上最合理、方法上最稳健的设置。它使用了足够大的盒子，正确地实现了最先进的吸收边界条件，包含了一个必要的电子阻止模型，并遵循了一个完善的热退火和最终缺陷识别方案。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在模拟了皮秒级的级联事件后，我们需要在更长的时间和更大的空间尺度上追踪数百万个缺陷的演化，例如它们如何聚集成气泡或空洞。相场法是解决这类介观尺度问题的强大连续介质模型。本练习深入探讨了相场模型的核心——偏微分方程的数值求解，通过比较谱方法和有限元方法的优劣，揭示了在计算成本与求解精度之间进行权衡的艺术。",
            "id": "4017073",
            "problem": "考虑一个用于描述钨中空位泡动力学的三维相场模型，该模型被构建为周期性立方体上二次自由能泛函的梯度流。令标量场 $c(\\mathbf{x},t)$ 为无量纲量，代表局部空位序参量。自由能由下式给出\n$$\nF[c] = \\int_{\\Omega} \\left( \\frac{\\kappa}{2} \\|\\nabla c\\|^2 + \\frac{\\alpha}{2} c^2 \\right) \\, dV,\n$$\n其中 $\\Omega = [0,L]^3$，$\\kappa > 0$ 是梯度能量系数，$\\alpha > 0$ 是体罚项。具有恒定迁移率 $M>0$ 的 Cahn–Hilliard (CH) 方程为\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu, \\quad \\mu = \\frac{\\delta F}{\\delta c} = -\\kappa \\nabla^2 c + \\alpha c,\n$$\n由此可得线性化演化方程\n$$\n\\frac{\\partial c}{\\partial t} = M \\left( \\alpha \\nabla^2 c - \\kappa \\nabla^4 c \\right).\n$$\n假设在 $\\Omega$ 上采用周期性边界条件。对于一个波矢为 $\\mathbf{k} = (k_x,k_y,k_z)$、大小为 $q^2 = \\left(\\frac{2\\pi}{L}\\right)^2 (k_x^2 + k_y^2 + k_z^2)$ 的傅里叶模，谱解法将模振幅推进为\n$$\n\\hat{c}_{\\mathbf{k}}(t) = \\hat{c}_{\\mathbf{k}}(0) \\exp\\left( - M \\left( \\alpha q^2 + \\kappa q^4 \\right) t \\right).\n$$\n在具有线性六面体有限元的均匀周期性网格上，离散拉普拉斯算子可以通过以下形式的广义特征值问题来表示\n$$\nK \\mathbf{v} = \\lambda M_m \\mathbf{v},\n$$\n其中 $K$ 是刚度矩阵，$M_m$ 是质量矩阵。对于一个具有 $N$ 个节点和间距 $h = L/N$ 的一维均匀周期性网格，傅里叶模是广义特征向量，一维特征值为\n$$\n\\lambda_{1\\mathrm{D}}(\\theta) = \\frac{ \\frac{2}{h} (1 - \\cos \\theta) }{ h \\left( \\frac{2}{3} + \\frac{1}{3} \\cos \\theta \\right) } = \\frac{4 \\sin^2(\\theta/2)}{h^2 \\left( 1 - \\frac{2}{3} \\sin^2(\\theta/2) \\right)},\n$$\n其中 $\\theta = \\frac{2\\pi m}{N}$，m 为整数模索引。在三维空间中，根据张量积结构，广义特征值相加，\n$$\n\\lambda_{3\\mathrm{D}}(\\theta_x,\\theta_y,\\theta_z) = \\lambda_{1\\mathrm{D}}(\\theta_x) + \\lambda_{1\\mathrm{D}}(\\theta_y) + \\lambda_{1\\mathrm{D}}(\\theta_z).\n$$\n因此，离散傅里叶模的有限元模态演化为\n$$\n\\hat{c}_{\\mathbf{m}}(t) = \\hat{c}_{\\mathbf{m}}(0) \\exp\\left( - M \\left( \\alpha \\lambda_{3\\mathrm{D}} + \\kappa \\lambda_{3\\mathrm{D}}^2 \\right) t \\right).\n$$\n\n您的任务是在 $N^3$ 个点的粗网格上实现谱方法和有限元模态求解器，将其精度与高分辨率谱参考解进行比较，并评估计算成本与精度的权衡。使用无量纲参数 $M = 1$、$\\alpha = 1$、$\\kappa = 1$，并设置区域大小 $L = 1$。将以 $\\mathbf{x}_0 = (L/2, L/2, L/2)$ 为中心的初始气泡场定义为\n$$\nc(\\mathbf{x},0) = \\frac{1}{2} \\left( 1 - \\tanh\\left( \\frac{r(\\mathbf{x}) - R}{w} \\right) \\right), \\quad r(\\mathbf{x}) = \\left\\| \\mathbf{x} - \\mathbf{x}_0 \\right\\|,\n$$\n其中气泡半径 $R$ 和界面宽度 $w$ 均选择为 $L$ 的一部分。设最终时间为 $T$（无量纲）。在 $N_{\\mathrm{ref}}^3$ 网格上构建一个高分辨率谱参考解，其中 $N_{\\mathrm{ref}} = 64$ 并使用相同的 $M$、$\\alpha$、$\\kappa$、$L$、$R$、$w$ 和 $T$。通过将参考解限制在粗网格点上（假设 $N$ 能整除 $N_{\\mathrm{ref}}$，从而使点完全对齐），来比较粗网格解。计算每个求解器的均方根误差如下\n$$\nE = \\left( \\frac{1}{N^3} \\sum_{i=1}^{N^3} \\left( c_{\\mathrm{coarse}}(\\mathbf{x}_i,T) - c_{\\mathrm{ref}}(\\mathbf{x}_i,T) \\right)^2 \\right)^{1/2},\n$$\n该值为无量纲。\n\n使用以下代理估算粗网格上每个时间步的计算成本：\n- 谱方法成本代理：\n$$\nC_{\\mathrm{spec}} = 5 \\, N^3 \\log_2 N,\n$$\n以反映具有代表性常数因子的三维快速傅里叶变换的复杂度。\n- 有限元方法成本代理：\n$$\nC_{\\mathrm{fem}} = 14 \\, N^3,\n$$\n以反映在三维空间中对拉普拉斯算子两次应用七点模板的成本。\n\n将每个求解器的权衡指标定义为单位成本的误差，\n$$\n\\Theta_{\\mathrm{spec}} = \\frac{E_{\\mathrm{spec}}}{C_{\\mathrm{spec}}}, \\quad \\Theta_{\\mathrm{fem}} = \\frac{E_{\\mathrm{fem}}}{C_{\\mathrm{fem}}}.\n$$\n\n实现以下测试套件，每个测试用例由 $(N, R/L, w/L, T)$ 指定：\n- 案例 1: $(N, R/L, w/L, T) = (8, 0.25, 0.03, 0.1)$。\n- 案例 2: $(N, R/L, w/L, T) = (16, 0.25, 0.02, 0.1)$。\n- 案例 3: $(N, R/L, w/L, T) = (32, 0.25, 0.015, 0.1)$。\n- 边界案例 4: $(N, R/L, w/L, T) = (8, 0.25, 0.01, 0.1)$。\n\n对于每个案例，计算谱求解器误差 $E_{\\mathrm{spec}}$、其成本代理 $C_{\\mathrm{spec}}$、有限元求解器误差 $E_{\\mathrm{fem}}$、其成本代理 $C_{\\mathrm{fem}}$，以及权衡指标 $\\Theta_{\\mathrm{spec}}$ 和 $\\Theta_{\\mathrm{fem}}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是按 $[E_{\\mathrm{spec}}, C_{\\mathrm{spec}}, E_{\\mathrm{fem}}, C_{\\mathrm{fem}}, \\Theta_{\\mathrm{spec}}, \\Theta_{\\mathrm{fem}}]$ 固定顺序列出的六个浮点数列表。例如：$[[e_1,c_1,e_2,c_2,t_1,t_2],[...],...]$。所有量均为无量纲，并应作为原始浮点数打印。",
            "solution": "该任务是在周期性域 $\\Omega = [0,L]^3$ 上实现并比较两种用于求解线性化三维 Cahn–Hilliard 方程的数值方法。这两种方法分别是谱方法和有限元 (FE) 方法，两者都在傅里叶空间中进行构建。比较基于准确性（通过与高分辨率谱参考解进行评估）和计算成本（为其提供了代理估算）。\n\n空位序参量 $c(\\mathbf{x}, t)$ 的控制偏微分方程 (PDE) 为\n$$\n\\frac{\\partial c}{\\partial t} = M \\left( \\alpha \\nabla^2 c - \\kappa \\nabla^4 c \\right).\n$$\n这是一个具有常系数的线性偏微分方程。对于周期性域，自然的基函数是复指数函数，即傅里叶模。解可以表示为傅里叶级数 $c(\\mathbf{x},t) = \\sum_{\\mathbf{k}} \\hat{c}_{\\mathbf{k}}(t) e^{i \\mathbf{q} \\cdot \\mathbf{x}}$，其中 $\\mathbf{q}$ 是对应于整数模索引向量 $\\mathbf{k}$ 的波矢。将此代入偏微分方程，连续空间导数算子 $\\nabla^2$ 和 $\\nabla^4$ 变为与其各自特征值 $(i\\mathbf{q})^2 = -q^2$ 和 $(-q^2)^2 = q^4$ 的代数乘法。这将偏微分方程转换为针对每个傅里叶模振幅 $\\hat{c}_{\\mathbf{k}}(t)$ 的一组独立的常微分方程 (ODE)：\n$$\n\\frac{d\\hat{c}_{\\mathbf{k}}}{dt} = -M(\\alpha q^2 + \\kappa q^4) \\hat{c}_{\\mathbf{k}}.\n$$\n该常微分方程的解是一个指数衰减：\n$$\n\\hat{c}_{\\mathbf{k}}(t) = \\hat{c}_{\\mathbf{k}}(0) \\exp\\left( -M(\\alpha q^2 + \\kappa q^4)t \\right).\n$$\n\n两种方法的数值实现核心都基于这一原理。其步骤如下：\n1.  在 $N^3$ 个点的均匀网格上离散化初始条件 $c(\\mathbf{x}, 0)$。\n2.  使用快速傅里叶变换 (FFT) 计算初始条件的离散傅里叶系数 $\\hat{c}_{\\mathbf{k}}(0)$。\n3.  对每个模 $\\mathbf{k}$，使用适当的指数衰减公式计算时间演化后的系数 $\\hat{c}_{\\mathbf{k}}(T)$。\n4.  通过对演化后的系数数组 $\\hat{c}_{\\mathbf{k}}(T)$ 应用逆 FFT，计算网格点上的实空间解 $c(\\mathbf{x}, T)$。\n\n这两种方法仅在第 3 步有所不同，具体在于拉普拉斯算子及其特征值的离散表示。\n\n初始气泡场由 $c(\\mathbf{x},0) = \\frac{1}{2} \\left( 1 - \\tanh\\left( \\frac{r(\\mathbf{x}) - R}{w} \\right) \\right)$ 定义，其中 $r(\\mathbf{x}) = \\|\\mathbf{x} - \\mathbf{x}_0\\|$ 是距区域中心 $\\mathbf{x}_0 = (L/2, L/2, L/2)$ 的距离。我们使用无量纲参数 $M=1$、$\\alpha=1$、$\\kappa=1$ 和区域大小 $L=1$。\n\n**参考解**\n首先在每个维度有 $N_{\\mathrm{ref}}=64$ 个点的精细网格上计算一个高分辨率参考解。该解使用谱方法，这种方法对于周期域上的光滑问题被认为是高度准确的。计算此网格的离散波数，并应用精确的谱演化公式。得到的实空间解 $c_{\\mathrm{ref}}(\\mathbf{x}_i, T)$ 作为基准真相。\n\n**谱求解器（粗网格）**\n该求解器在 $N^3$ 个点的较粗网格上运行。它遵循与参考求解器完全相同的逻辑。\n1.  在 $N^3$ 网格上评估初始条件。\n2.  计算 3D FFT 以获得 $\\hat{c}_{\\mathbf{k}}(0)$。\n3.  构建一个波数平方 $q^2 = q_x^2 + q_y^2 + q_z^2$ 的三维网格。波数分量为 $q_i = 2\\pi f_i$，其中 $f_i$ 是对于间距为 $h=L/N$ 的 $N$ 点网格，从类似 `numpy.fft.fftfreq(N, d=h)` 的函数中获得的离散频率。\n4.  计算演化后的傅里叶系数：$\\hat{c}_{\\mathbf{k}}(T) = \\hat{c}_{\\mathbf{k}}(0) \\exp\\left( - (\\alpha q^2 + \\kappa q^4) T \\right)$。使用参数 $M=1$。\n5.  逆 3D FFT 得到解 $c_{\\mathrm{spec}}(\\mathbf{x}_i, T)$。此方法的主要误差来源是混叠，当离散网格过粗而无法表示初始条件的高频内容时会发生混叠。\n\n**有限元求解器（粗网格）**\n该求解器使用从线性有限元导出的离散版本来近似连续拉普拉斯算子。这种离散化的效果由其特征值捕获。我们使用广义特征值 $\\lambda_{3\\mathrm{D}}$ 来代替连续特征值 $q^2$。对于一个具有 $N$ 个节点和间距 $h=L/N$ 的一维网格，模 $m$ 的特征值为\n$$\n\\lambda_{1\\mathrm{D}}(m) = \\frac{4 \\sin^2(\\pi m/N)}{h^2 \\left( 1 - \\frac{2}{3} \\sin^2(\\pi m/N) \\right)},\n$$\n其中 $m$ 是整数模索引。在三维中，由于网格和基函数的张量积性质，特征值是可加的：$\\lambda_{3\\mathrm{D}}(m_x, m_y, m_z) = \\lambda_{1\\mathrm{D}}(m_x) + \\lambda_{1\\mathrm{D}}(m_y) + \\lambda_{1\\mathrm{D}}(m_z)$。这些特征值 $\\lambda_{3\\mathrm{D}}$ 是对 $q^2$ 的有限元近似。算法如下：\n1.  步骤 1 和 2 与谱方法相同（在 $N^3$ 网格上评估初始条件，进行 FFT）。\n2.  构建一个 FE 特征值 $\\lambda_{3\\mathrm{D}}$ 的三维网格。\n3.  使用这些特征值计算演化后的傅里叶系数：$\\hat{c}_{\\mathbf{m}}(T) = \\hat{c}_{\\mathbf{m}}(0) \\exp\\left( - (\\alpha \\lambda_{3\\mathrm{D}} + \\kappa \\lambda_{3\\mathrm{D}}^2) T \\right)$。\n4.  逆 3D FFT 得到解 $c_{\\mathrm{fem}}(\\mathbf{x}_i, T)$。此方法既会产生来自初始条件的混叠误差，也会产生来自算子近似的离散化误差（$\\lambda_{3\\mathrm{D}} \\neq q^2$）。\n\n**分析与比较**\n对于每个由 $(N, R/L, w/L, T)$ 指定的测试用例，我们计算解 $c_{\\mathrm{spec}}$ 和 $c_{\\mathrm{fem}}$。它们的准确性通过与参考解的均方根误差 (RMSE) 来衡量，参考解会下采样到粗网格点以便进行比较：\n$$\nE = \\left( \\frac{1}{N^3} \\sum_{i=1}^{N^3} \\left( c_{\\mathrm{coarse}}(\\mathbf{x}_i,T) - c_{\\mathrm{ref}}(\\mathbf{x}_i,T) \\right)^2 \\right)^{1/2}.\n$$\n计算计算成本代理 $C_{\\mathrm{spec}} = 5 N^3 \\log_2 N$ 和 $C_{\\mathrm{fem}} = 14 N^3$，以及权衡指标 $\\Theta_{\\mathrm{spec}} = E_{\\mathrm{spec}}/C_{\\mathrm{spec}}$ 和 $\\Theta_{\\mathrm{fem}} = E_{\\mathrm{fem}}/C_{\\mathrm{fem}}$，其中较低的 $\\Theta$ 表示更高的效率。最终程序会遍历所提供的测试用例，并报告每个用例的这六个量。",
            "answer": "[[0.0003714041071473919,7680.0,0.00936720499692383,7168.0,4.835990978481665e-08,1.3068363715104423e-06],[0.00010991959325902095,98304.0,0.0019623661578498967,57344.0,1.1181585802209935e-09,3.422238381831838e-08],[2.460830602058316e-05,983040.0,0.0004510007873634047,458752.0,2.503254921932338e-11,9.830983103289053e-10],[0.02220970617307044,7680.0,0.02534579120761358,7168.0,0.002891888824618547,0.003535941021427118]]"
        }
    ]
}