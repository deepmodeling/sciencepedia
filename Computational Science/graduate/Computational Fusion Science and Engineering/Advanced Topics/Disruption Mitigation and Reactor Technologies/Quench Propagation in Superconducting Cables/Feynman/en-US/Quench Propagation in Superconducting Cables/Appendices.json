{
    "hands_on_practices": [
        {
            "introduction": "The stability of a superconducting cable against thermal runaway is critically dependent on the properties of its non-superconducting stabilizer, typically copper. This first practice explores the intimate connection between the electrical and thermal transport properties of copper at cryogenic temperatures through the Wiedemann–Franz law . By estimating the thermal conductivity from the readily measurable Residual Resistivity Ratio (RRR), you will gain insight into how material purity directly impacts the conductor's ability to manage heat, a key factor in determining the quench propagation velocity.",
            "id": "4035614",
            "problem": "A Cable-in-Conduit Conductor used in a tokamak central solenoid is stabilized with copper of residual resistivity ratio (RRR) $R$ defined by $R=\\rho(T_{\\mathrm{ref}})/\\rho_{0}$, where $\\rho(T_{\\mathrm{ref}})$ is the electrical resistivity at the reference temperature $T_{\\mathrm{ref}}$ and $\\rho_{0}$ is the residual resistivity in the limit of low temperature where phonon scattering is negligible. At cryogenic temperature $T=4.2\\,\\mathrm{K}$, assume that the copper resistivity is dominated by impurity and defect scattering, so that $\\rho(4.2\\,\\mathrm{K})\\approx \\rho_{0}$. Using the Wiedemann–Franz law $k(T)\\approx L_{0}\\,T/\\rho(T)$ with $L_{0}=\\pi^{2}k_{B}^{2}/3e^{2}$, estimate the thermal conductivity $k$ of the copper stabilizer at $T=4.2\\,\\mathrm{K}$ for $R=100$ when the room-temperature resistivity of oxygen-free high-conductivity copper at $T_{\\mathrm{ref}}=293\\,\\mathrm{K}$ is $\\rho(293\\,\\mathrm{K})=1.68\\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$. Treat $L_{0}$ as given by the ideal free-electron value with the Boltzmann constant $k_{B}$ and elementary charge $e$. Then, briefly justify the sign of the change in the normal zone propagation velocity (NZPV) when $R$ is increased, based solely on the scaling of $k$.\n\nRound your numerical estimate of $k$ to three significant figures and express it in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$. The final answer must be a single real-valued number.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective. The problem statement provides a clear task based on established principles of solid-state physics and superconductivity engineering. All necessary data are provided, the values are physically realistic, and the approximations invoked are standard in the field. The problem is therefore deemed valid.\n\nThe primary objective is to estimate the thermal conductivity, $k$, of a copper stabilizer at a temperature of $T=4.2\\,\\mathrm{K}$. The Wiedemann–Franz law provides the relationship between thermal conductivity $k(T)$, electrical resistivity $\\rho(T)$, and absolute temperature $T$:\n$$k(T) = \\frac{L_{0}T}{\\rho(T)}$$\nHere, $L_{0}$ is the Lorentz number, given by the ideal free-electron model as $L_{0} = \\frac{\\pi^{2}k_{B}^{2}}{3e^{2}}$, where $k_{B}$ is the Boltzmann constant and $e$ is the elementary charge. The numerical value of the Lorentz number is approximately $L_{0} \\approx 2.44 \\times 10^{-8}\\,\\mathrm{W}\\cdot\\Omega\\cdot\\mathrm{K}^{-2}$.\n\nTo calculate $k$ at $T=4.2\\,\\mathrm{K}$, we first need to determine the electrical resistivity $\\rho(T)$ at this temperature. The problem states that at this cryogenic temperature, the resistivity is dominated by impurity and defect scattering, allowing the approximation $\\rho(4.2\\,\\mathrm{K}) \\approx \\rho_{0}$, where $\\rho_{0}$ is the residual resistivity.\n\nThe residual resistivity $\\rho_{0}$ can be determined using the given Residual Resistivity Ratio (RRR), $R$. The RRR is defined as the ratio of the resistivity at a reference temperature, $T_{\\mathrm{ref}}$, to the residual resistivity:\n$$R = \\frac{\\rho(T_{\\mathrm{ref}})}{\\rho_{0}}$$\nThe problem provides $R=100$, $T_{\\mathrm{ref}}=293\\,\\mathrm{K}$, and the resistivity of copper at this reference temperature, $\\rho(293\\,\\mathrm{K}) = 1.68 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$. We can rearrange the definition of $R$ to solve for $\\rho_{0}$:\n$$\\rho_{0} = \\frac{\\rho(T_{\\mathrm{ref}})}{R}$$\nSubstituting the given values:\n$$\\rho_{0} = \\frac{1.68 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}}{100} = 1.68 \\times 10^{-10}\\,\\Omega\\cdot\\mathrm{m}$$\nThis is the value we will use for the resistivity at $T=4.2\\,\\mathrm{K}$:\n$$\\rho(4.2\\,\\mathrm{K}) \\approx \\rho_{0} = 1.68 \\times 10^{-10}\\,\\Omega\\cdot\\mathrm{m}$$\nNow we have all the necessary components to calculate the thermal conductivity $k$ at $T=4.2\\,\\mathrm{K}$ using the Wiedemann-Franz law:\n$$k(4.2\\,\\mathrm{K}) = \\frac{L_{0}T}{\\rho(4.2\\,\\mathrm{K})}$$\nSubstituting the numerical values:\n$$k(4.2\\,\\mathrm{K}) \\approx \\frac{(2.44 \\times 10^{-8}\\,\\mathrm{W}\\cdot\\Omega\\cdot\\mathrm{K}^{-2}) \\times (4.2\\,\\mathrm{K})}{1.68 \\times 10^{-10}\\,\\Omega\\cdot\\mathrm{m}}$$\n$$k(4.2\\,\\mathrm{K}) \\approx \\frac{1.0248 \\times 10^{-7}\\,\\mathrm{W}\\cdot\\Omega\\cdot\\mathrm{K}^{-1}}{1.68 \\times 10^{-10}\\,\\Omega\\cdot\\mathrm{m}}$$\n$$k(4.2\\,\\mathrm{K}) \\approx 609.99... \\,\\mathrm{W}\\cdot\\mathrm{m}^{-1}\\cdot\\mathrm{K}^{-1}$$\nRounding the result to three significant figures, we get:\n$$k \\approx 610\\,\\mathrm{W}\\cdot\\mathrm{m}^{-1}\\cdot\\mathrm{K}^{-1}$$\nUsing a more precise value for the Lorentz number, $L_0 = \\frac{\\pi^2}{3}(\\frac{k_B}{e})^2 \\approx 2.4432 \\times 10^{-8}\\,\\mathrm{W}\\cdot\\Omega\\cdot\\mathrm{K}^{-2}$, gives:\n$$k(4.2\\,\\mathrm{K}) \\approx \\frac{(2.4432 \\times 10^{-8}\\,\\mathrm{W}\\cdot\\Omega\\cdot\\mathrm{K}^{-2}) \\times (4.2\\,\\mathrm{K})}{1.68 \\times 10^{-10}\\,\\Omega\\cdot\\mathrm{m}} \\approx 610.8\\,\\mathrm{W}\\cdot\\mathrm{m}^{-1}\\cdot\\mathrm{K}^{-1}$$\nRounding this to three significant figures gives $k \\approx 611\\,\\mathrm{W}\\cdot\\mathrm{m}^{-1}\\cdot\\mathrm{K}^{-1}$. This latter value is more precise.\n\nThe second part of the problem asks to justify the sign of the change in the Normal Zone Propagation Velocity (NZPV) when the RRR, $R$, is increased, based only on the scaling of $k$.\nFirst, we establish the relationship between thermal conductivity $k$ and RRR $R$. From the derivations above, we have:\n$$k(T) = \\frac{L_{0} T}{\\rho_{0}} \\quad \\text{and} \\quad \\rho_{0} = \\frac{\\rho(T_{\\mathrm{ref}})}{R}$$\nSubstituting the expression for $\\rho_0$ into the equation for $k(T)$:\n$$k(T) = \\frac{L_{0} T R}{\\rho(T_{\\mathrm{ref}})}$$\nSince $L_{0}$, $T$, and $\\rho(T_{\\mathrm{ref}})$ are constants in this context, the thermal conductivity at low temperatures is directly proportional to the RRR: $k \\propto R$. An increase in $R$ implies a purer copper, which has lower residual resistivity and thus higher thermal conductivity.\n\nSecond, we consider the relationship between NZPV and thermal conductivity $k$. A quench, or the transition from a superconducting to a normal-conducting state, propagates along a conductor via heat diffusion. The NZPV is the speed of this propagating thermal front. The process is governed by a heat diffusion equation. In simplified one-dimensional models, the propagation velocity $v_{q}$ is found to be an increasing function of the thermal conductivity. A common scaling relationship derived from analyzing the heat balance equation is $v_{q} \\propto \\sqrt{k}$.\n\nCombining these two relationships, an increase in the RRR ($R$) leads to a proportional increase in the thermal conductivity ($k$), which in turn causes an increase in the NZPV. Therefore, the sign of the change in NZPV is positive when $R$ is increased.",
            "answer": "$$\n\\boxed{611}\n$$"
        },
        {
            "introduction": "Effective computational modeling often hinges on identifying appropriate simplifications without sacrificing physical accuracy. This exercise focuses on a fundamental question in transient heat transfer: are internal temperature gradients within a conductor strand significant compared to the temperature drop at its surface ? By calculating the Biot number, a dimensionless group representing the ratio of internal to external thermal resistances, you will learn to justify the use of the lumped thermal capacitance model, a powerful simplification in many quench analysis codes.",
            "id": "4035655",
            "problem": "A single strand within a Cable-in-Conduit Conductor (CICC) for a tokamak magnet experiences an incipient quench, during which a small region transitions to the normal state and begins to heat. Consider the early-time radial thermal response of the strand, when axial heat transport and helium hydrodynamics are negligible compared to radial diffusion and interfacial heat transfer to the surrounding forced-flow helium bath. Assume the strand can be treated as a homogeneous medium with constant properties over the short timescale of interest, and that the helium temperature far from the strand remains uniform.\n\nStarting from the transient energy conservation law for a solid, the constitutive relation for heat conduction, and a convective boundary condition at the strand–helium interface, non-dimensionalize the radial heat conduction problem using a characteristic length $L$ and identify the dimensionless group that quantifies the ratio of interfacial (external) thermal resistance to internal conduction resistance at the boundary. This group, when evaluated for the given parameters, is traditionally used to assess the validity of the lumped thermal capacitance approximation.\n\nUse the following data representative of initial quench conditions in a CICC strand at cryogenic temperature:\n- Effective radial thermal conductivity of the composite strand: $k = 600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n- Effective convective heat transfer coefficient to the surrounding helium: $h = 7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$.\n- Characteristic length of the strand (based on geometry and surface exposure): $L = 2.0 \\times 10^{-4} \\,\\mathrm{m}$.\n\nCompute the value of the identified dimensionless group for the strand with the given $L$, and, based on its magnitude, argue whether a lumped thermal capacitance model is justified for initial quench analyses in Cable-in-Conduit Conductors (CICCs).\n\nReport the numerical value of the dimensionless group as a pure number (no units), rounded to three significant figures. In your reasoning, clearly state any additional assumptions you invoke and justify the applicability of the lumped capacitance model on the basis of first principles without invoking any shortcut formulas not derived from the governing equations.",
            "solution": "The problem requires the non-dimensionalization of the radial heat conduction equation for a superconducting strand to identify the dimensionless group governing the boundary condition, calculation of its value, and an assessment of the lumped thermal capacitance model's applicability.\n\nThe analysis begins with the fundamental principles of transient heat transfer. The conservation of energy within a solid with constant properties and no internal heat generation is described by the heat diffusion equation. For simplicity, we consider a one-dimensional Cartesian coordinate system, where $x$ represents the spatial variable along the characteristic length $L$. The temperature field is denoted by $T(x, t)$. The governing equation is:\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} $$\nwhere $\\rho$ is the density, $c_p$ is the specific heat capacity, and $k$ is the thermal conductivity of the strand material. This can be rewritten using the thermal diffusivity, $\\alpha = k/(\\rho c_p)$, as:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n\nAt the boundary of the strand (which we can place at $x=L$ without loss of generality), heat is transferred to the surrounding helium bath via convection. The helium bath is assumed to be at a constant, uniform temperature $T_\\infty$. The boundary condition equates the conductive heat flux from the solid to the convective heat flux into the fluid:\n$$ -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L} = h (T(L,t) - T_\\infty) $$\nHere, $h$ is the convective heat transfer coefficient.\n\nTo non-dimensionalize the problem, we introduce dimensionless variables. Let $T_i$ be a reference initial temperature of the strand.\nA dimensionless temperature $\\theta$ is defined as:\n$$ \\theta = \\frac{T - T_\\infty}{T_i - T_\\infty} $$\nA dimensionless spatial coordinate $X$ is defined using the characteristic length $L$:\n$$ X = \\frac{x}{L} $$\nWe will now transform the boundary condition using these new variables. The derivatives transform as:\n$$ \\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial X} \\frac{dX}{dx} = \\frac{1}{L} \\frac{\\partial}{\\partial X} $$\nSubstituting the transformations into the boundary condition equation:\n$$ -k \\left( \\frac{1}{L} \\frac{\\partial}{\\partial X} \\left[ \\theta(T_i - T_\\infty) + T_\\infty \\right] \\right)_{X=1} = h \\left( \\left[ \\theta(T_i - T_\\infty) + T_\\infty \\right] - T_\\infty \\right)_{X=1} $$\nSince $T_i$ and $T_\\infty$ are constants, this simplifies to:\n$$ -k \\frac{T_i - T_\\infty}{L} \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = h \\left( \\theta(1,t) (T_i - T_\\infty) \\right) $$\nAssuming $T_i \\neq T_\\infty$, we can cancel the term $(T_i - T_\\infty)$ from both sides:\n$$ -\\frac{k}{L} \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = h \\, \\theta(1,t) $$\nRearranging to group the physical parameters yields the dimensionless form of the boundary condition:\n$$ \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = - \\left( \\frac{hL}{k} \\right) \\theta(1,t) $$\nThe dimensionless group that naturally arises from this process is $\\frac{hL}{k}$. This is known as the Biot number, symbolized as $Bi$.\n$$ Bi = \\frac{hL}{k} $$\n\nThe problem statement asks to identify the group quantifying the \"ratio of interfacial (external) thermal resistance to internal conduction resistance\". Let us analyze the physical meaning of the Biot number. The internal conduction resistance, $R_{cond}$, over a characteristic length $L$ and for a cross-sectional area $A$ can be characterized as $R_{cond} \\sim \\frac{L}{kA}$. The external convection resistance, $R_{conv}$, at the surface is $R_{conv} = \\frac{1}{hA}$. The ratio of these two resistances is:\n$$ \\frac{R_{cond}}{R_{conv}} = \\frac{L/kA}{1/hA} = \\frac{hL}{k} = Bi $$\nThus, the Biot number represents the ratio of the internal resistance to heat conduction to the external resistance to heat convection. The problem's phrasing asks for the reciprocal of this, $R_{conv}/R_{cond}$. However, the Biot number is the conventional and fundamental parameter that governs the thermal response in this context, and its value is the basis for assessing the lumped capacitance approximation. We identify the Biot number, $Bi = \\frac{hL}{k}$, as the relevant dimensionless group.\n\nThe lumped thermal capacitance approximation assumes that the temperature within the body is spatially uniform, i.e., $T(x,t) \\approx T(t)$. This assumption is valid when the internal resistance to heat transfer is negligible compared to the external resistance. In terms of the Biot number, this condition is expressed as $Bi \\ll 1$. A commonly accepted engineering criterion for the validity of this approximation is $Bi  0.1$. If this condition holds, the temperature gradients within the solid are minimal, and the entire body can be treated as a single lump at a uniform temperature.\n\nWe now compute the value of the Biot number for the given parameters:\n- Effective radial thermal conductivity, $k = 600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n- Effective convective heat transfer coefficient, $h = 7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$\n- Characteristic length, $L = 2.0 \\times 10^{-4} \\,\\mathrm{m}$\n\n$$ Bi = \\frac{hL}{k} = \\frac{(7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}) \\times (2.0 \\times 10^{-4} \\,\\mathrm{m})}{600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}} $$\n$$ Bi = \\frac{1.5}{600} = \\frac{1.5}{6 \\times 10^2} = 0.25 \\times 10^{-2} = 0.0025 $$\nThe value of the dimensionless group is $0.0025$.\n\nTo report the value to three significant figures, we write it as $2.50 \\times 10^{-3}$.\n\nBased on this value, we can assess the applicability of the lumped capacitance model. The calculated Biot number is $Bi = 0.0025$. This value is significantly smaller than the threshold of $0.1$.\n$$ 0.0025 \\ll 0.1 $$\nThis indicates that the internal conduction resistance ($L/k$) is much smaller than the external convection resistance ($1/h$). Specifically, the ratio is $1:400$. Therefore, heat conducted to the surface of the strand is removed by convection far more slowly than it is supplied from the interior. This results in very small temperature gradients within the strand. The assumption of a spatially uniform temperature profile is well-justified. Consequently, a lumped thermal capacitance model is an appropriate and accurate simplification for analyzing the early-time thermal response of the given CICC strand during a quench.",
            "answer": "$$\\boxed{2.50 \\times 10^{-3}}$$"
        },
        {
            "introduction": "We now progress from static analysis to a full dynamic simulation of quench propagation, the capstone of our hands-on practices. This problem challenges you to implement a numerical solution for the non-linear heat equation governing the evolution of a normal zone, using an operator splitting scheme to decouple the stiff diffusion and source terms . Successfully building and verifying this 1D model will provide you with a foundational tool for quench analysis and a deep appreciation for the interplay between heat conduction, non-linear material properties, and numerical stability.",
            "id": "4035613",
            "problem": "Consider a one-dimensional superconducting cable segment modeled on the spatial domain $x \\in [0,L]$ with Dirichlet boundary conditions $T(0,t)=T_b$ and $T(L,t)=T_b$. The thermal field $T(x,t)$ evolves due to conduction and Joule heating generated by an electric field $E(J,T)$ with a specified transport current density $J$. The model is based on energy conservation and Fourier heat conduction, yielding the Partial Differential Equation (PDE)\n$$\nC \\,\\frac{\\partial T}{\\partial t} \\;=\\; k \\,\\frac{\\partial^2 T}{\\partial x^2} \\;+\\; q(J,T),\n$$\nwhere $C$ is the volumetric heat capacity, $k$ is the thermal conductivity, and $q(J,T)$ is the volumetric Joule heating defined by $q(J,T) = E(J,T)\\,J$. All physical quantities and units must be handled consistently: temperature in kelvin (K), length in meters (m), time in seconds (s), electric field in volts per meter (V/m), and current density in amperes per square meter (A/m$^2$). The cable length is $L$, and the bath temperature is $T_b$.\n\nThe electrical constitutive relation $E(J,T)$ captures the transition from superconducting to normal behavior. Define the critical current density $J_c(T)$ by\n$$\nJ_c(T) \\;=\\; J_{c0} \\,\\max\\!\\left(0, 1 - \\frac{T}{T_c}\\right),\n$$\nwhere $J_{c0}$ is the zero-temperature critical current density and $T_c$ is the critical temperature. For $T  T_c$, adopt a power-law electric field\n$$\nE_{\\mathrm{sc}}(J,T) \\;=\\; E_c \\,\\left(\\frac{J}{\\max(J_c(T),\\epsilon)}\\right)^n,\n$$\nwith critical electric field $E_c$, power-law index $n$, and a small safeguard $\\epsilon0$ in A/m$^2$. For $T \\ge T_c$, use an effective normal-state resistivity $\\rho_{\\mathrm{eff}}(T)$ such that\n$$\nE_{\\mathrm{n}}(J,T) \\;=\\; \\rho_{\\mathrm{eff}}(T)\\,J, \\qquad \\rho_{\\mathrm{eff}}(T) \\;=\\; \\rho_0 \\left(1 + \\beta\\,\\max\\!\\big(T - T_b, 0\\big)\\right),\n$$\nwith $\\rho_0$ in $\\Omega\\cdot\\mathrm{m}$ and $\\beta$ in $\\mathrm{K}^{-1}$. To avoid unphysical divergence near $T\\approx T_c$, let\n$$\nE(J,T) \\;=\\; \\begin{cases}\n\\min\\!\\big(E_{\\mathrm{sc}}(J,T), \\rho_{\\mathrm{eff}}(T)\\,J\\big),  T  T_c, \\\\\n\\rho_{\\mathrm{eff}}(T)\\,J,  T \\ge T_c.\n\\end{cases}\n$$\n\nImplement a Lie operator splitting scheme that alternates updates of the thermal field $T$ and the electric field $E(J,T)$ at each time step $\\Delta t$ by splitting the evolution into two operators:\n- Thermal diffusion operator $A$: solve $C\\,\\partial_t T = k\\,\\partial_{xx} T$ over a time interval $\\Delta t$ with Dirichlet boundaries.\n- Source heating operator $B$: solve $\\partial_t T = q(J,T)/C$ over a time interval $\\Delta t$ pointwise in space.\n\nThe Lie splitting step from $T^n$ to $T^{n+1}$ is\n$$\nT^{n+1/2} \\;=\\; \\Phi_A(\\Delta t)\\,T^n, \\qquad T^{n+1} \\;=\\; \\Phi_B(\\Delta t)\\,T^{n+1/2},\n$$\nwhere $\\Phi_A$ and $\\Phi_B$ are the solution operators of $A$ and $B$, respectively. Use an implicit finite difference method for $\\Phi_A$ with time step $\\Delta t$ and spatial mesh spacing $\\Delta x = L/(N_x-1)$ on a uniform grid $x_i=i\\,\\Delta x$, $i=0,\\dots,N_x-1$. Specifically, use the backward Euler discretization for diffusion at interior nodes $i=1,\\dots,N_x-2$:\n$$\nT^{n+1/2}_i - r \\left(T^{n+1/2}_{i+1} - 2\\,T^{n+1/2}_i + T^{n+1/2}_{i-1}\\right) \\;=\\; T^n_i, \\qquad r = \\frac{k\\,\\Delta t}{C\\,\\Delta x^2},\n$$\nwith $T^{n+1/2}_0 = T_b$ and $T^{n+1/2}_{N_x-1} = T_b$. For $\\Phi_B$, integrate $\\partial_t T = q(J,T)/C$ using a second-order explicit method (for example, the Heun method) at each interior node while enforcing $T(0,t)=T_b$ and $T(L,t)=T_b$ after the source update.\n\nInitial condition: a localized hot spot superimposed on the bath,\n$$\nT(x,0) \\;=\\; T_b + \\Delta T \\,\\exp\\!\\left(-\\frac{(x - L/2)^2}{2\\,\\sigma^2}\\right).\n$$\n\nYour implementation must compute the numerical solution up to final time $T_{\\mathrm{end}}$ for specified parameters and time steps, and assess splitting convergence by comparing solutions at different $\\Delta t$ values to a reference solution obtained with a much smaller time step $\\Delta t_{\\mathrm{ref}}$. Use the spatial root-mean-square error\n$$\n\\mathrm{RMS} \\;=\\; \\left(\\frac{1}{N_x}\\sum_{i=0}^{N_x-1}\\left(T_i^{\\mathrm{coarse}} - T_i^{\\mathrm{ref}}\\right)^2\\right)^{1/2}\n$$\nexpressed in kelvin (K). Estimate observed convergence orders $p$ using consecutive error pairs and the time step ratio $r_t$ via\n$$\np \\;=\\; \\frac{\\log\\!\\left(\\mathrm{RMS}_{1}/\\mathrm{RMS}_{2}\\right)}{\\log\\!\\left(r_t\\right)}.\n$$\n\nJustify the splitting error and convergence criteria theoretically in your solution: start from the definition of operators $A$ and $B$, discuss the Baker–Campbell–Hausdorff expansion and the commutator $[A,B]$, and derive the local and global error orders for Lie splitting.\n\nPhysical and numerical parameters for all test cases:\n- Cable length $L = 0.1\\,\\mathrm{m}$, bath temperature $T_b = 4.2\\,\\mathrm{K}$.\n- Thermal conductivity $k = 50\\,\\mathrm{W/(m\\cdot K)}$, volumetric heat capacity $C = 3.0\\times 10^6\\,\\mathrm{J/(m^3\\cdot K)}$.\n- Electrical parameters: $T_c = 9.2\\,\\mathrm{K}$, $J_{c0} = 3.0\\times 10^8\\,\\mathrm{A/m^2}$, $E_c = 1.0\\times 10^{-4}\\,\\mathrm{V/m}$, $n = 15$, $\\epsilon = 10^{-3}\\,\\mathrm{A/m^2}$, $\\rho_0 = 1.0\\times 10^{-9}\\,\\Omega\\cdot\\mathrm{m}$, $\\beta = 5.0\\times 10^{-3}\\,\\mathrm{K^{-1}}$.\n- Spatial grid size $N_x = 81$.\n- Initial hot spot: $\\Delta T = 20.0\\,\\mathrm{K}$, $\\sigma = 0.004\\,\\mathrm{m}$.\n- Final time $T_{\\mathrm{end}} = 2.0\\times 10^{-4}\\,\\mathrm{s}$.\n- Reference time step $\\Delta t_{\\mathrm{ref}} = 2.5\\times 10^{-6}\\,\\mathrm{s}$.\n- Coarse time steps to test: $\\Delta t \\in \\{4.0\\times 10^{-5},\\, 2.0\\times 10^{-5},\\, 1.0\\times 10^{-5}\\}\\,\\mathrm{s}$ with ratio $r_t = 2$ between consecutive values.\n\nTest suite:\n- Case $1$ (typical current): $J = 1.0\\times 10^8\\,\\mathrm{A/m^2}$.\n- Case $2$ (no source edge case): $J = 0.0\\,\\mathrm{A/m^2}$.\n- Case $3$ (stiff source regime): $J = 4.0\\times 10^8\\,\\mathrm{A/m^2}$.\n\nFor each case, compute the spatial root-mean-square errors at $T_{\\mathrm{end}}$ for the three coarse time steps compared to the reference, denoted $\\mathrm{RMS}_{\\Delta t_1}$, $\\mathrm{RMS}_{\\Delta t_2}$, $\\mathrm{RMS}_{\\Delta t_3}$, and the observed orders $p_{12}$ and $p_{23}$ computed from consecutive pairs with $r_t=2$. All errors must be expressed in kelvin (K), and the orders are dimensionless.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\big[ \\mathrm{RMS}^{(1)}_{\\Delta t_1}, \\mathrm{RMS}^{(1)}_{\\Delta t_2}, \\mathrm{RMS}^{(1)}_{\\Delta t_3}, p^{(1)}_{12}, p^{(1)}_{23}, \\mathrm{RMS}^{(2)}_{\\Delta t_1}, \\mathrm{RMS}^{(2)}_{\\Delta t_2}, \\mathrm{RMS}^{(2)}_{\\Delta t_3}, p^{(2)}_{12}, p^{(2)}_{23}, \\mathrm{RMS}^{(3)}_{\\Delta t_1}, \\mathrm{RMS}^{(3)}_{\\Delta t_2}, \\mathrm{RMS}^{(3)}_{\\Delta t_3}, p^{(3)}_{12}, p^{(3)}_{23} \\big],\n$$\nwhere the superscript $(c)$ denotes Case $c \\in \\{1,2,3\\}$. The numerical values must be printed as plain decimal floats, with errors in kelvin (K) and observed orders dimensionless.",
            "solution": "The problem requires the implementation and validation of a numerical scheme to solve a one-dimensional, non-linear partial differential equation (PDE) modeling thermal evolution in a superconducting cable. The validation must be performed by analyzing the convergence of the numerical solution.\n\n### **Problem Formulation**\nThe evolution of the temperature field $T(x,t)$ in a superconducting cable of length $L$ is governed by the heat diffusion equation with a non-linear source term:\n$$\nC \\,\\frac{\\partial T}{\\partial t} \\;=\\; k \\,\\frac{\\partial^2 T}{\\partial x^2} \\;+\\; q(J,T) \\quad \\text{for } x \\in (0, L), t  0\n$$\nwhere $C$ is the volumetric heat capacity, $k$ is the thermal conductivity, and $q(J,T) = E(J,T)J$ is the volumetric Joule heating. The transport current density is $J$. The cable is subject to Dirichlet boundary conditions $T(0,t) = T(L,t) = T_b$, where $T_b$ is the constant bath temperature.\n\nThe electric field $E(J,T)$ is defined by a piecewise model that captures the superconducting-to-normal transition:\n$$\nE(J,T) \\;=\\; \\begin{cases}\n\\min\\!\\big(E_{\\mathrm{sc}}(J,T), \\rho_{\\mathrm{eff}}(T)\\,J\\big),  T  T_c, \\\\\n\\rho_{\\mathrm{eff}}(T)\\,J,  T \\ge T_c,\n\\end{cases}\n$$\nwhere $T_c$ is the critical temperature. The terms are:\n- Critical current density: $J_c(T) = J_{c0} \\,\\max(0, 1 - T/T_c)$\n- Superconducting E-field (power-law): $E_{\\mathrm{sc}}(J,T) = E_c \\left(J/\\max(J_c(T),\\epsilon)\\right)^n$\n- Effective normal-state resistivity: $\\rho_{\\mathrm{eff}}(T) = \\rho_0 (1 + \\beta\\,\\max(T - T_b, 0))$\n\nThe initial condition is a Gaussian hot spot: $T(x,0) = T_b + \\Delta T \\,\\exp\\!\\left(-(x - L/2)^2/(2\\,\\sigma^2)\\right)$.\n\n### **Numerical Method: Lie Operator Splitting**\n\nThe PDE can be written in the abstract form $\\partial_t T = \\mathcal{A}(T) + \\mathcal{B}(T)$, where:\n- $\\mathcal{A}(T) = \\alpha_T \\frac{\\partial^2 T}{\\partial x^2}$ is the linear thermal diffusion operator, with thermal diffusivity $\\alpha_T = k/C$.\n- $\\mathcal{B}(T) = \\frac{q(J,T)}{C}$ is the non-linear heat source operator.\n\nThe Lie splitting scheme approximates the evolution over a time step $\\Delta t$ by solving the two sub-problems sequentially:\n$$\nT^{n+1} = \\Phi_B(\\Delta t) \\Phi_A(\\Delta t) T^n\n$$\nwhere $\\Phi_A$ and $\\Phi_B$ are the solution operators for $\\partial_t T = \\mathcal{A}(T)$ and $\\partial_t T = \\mathcal{B}(T)$, respectively.\n\n**Theoretical Error Analysis:**\nThe formal solution to $\\partial_t T = (\\mathcal{A} + \\mathcal{B})T$ over a time step $\\Delta t$ is given by $T(t+\\Delta t) = e^{(\\mathcal{A}+\\mathcal{B})\\Delta t} T(t)$. The Lie splitting scheme approximates this as $e^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t}T(t)$. The error of this approximation can be analyzed using the Baker–Campbell–Hausdorff (BCH) formula, which for non-commuting operators states:\n$$\ne^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t} = e^{(\\mathcal{A}+\\mathcal{B})\\Delta t + \\frac{1}{2}[\\mathcal{B},\\mathcal{A}]\\Delta t^2 + O(\\Delta t^3)}\n$$\nwhere $[\\mathcal{B},\\mathcal{A}] = \\mathcal{B}\\mathcal{A} - \\mathcal{A}\\mathcal{B}$ is the commutator of the operators. The local truncation error of the splitting is the difference between the exact and approximate propagators:\n$$\ne^{(\\mathcal{A}+\\mathcal{B})\\Delta t} - e^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t} \\approx -\\frac{1}{2}[\\mathcal{B},\\mathcal{A}]\\Delta t^2.\n$$\nThe local error is of order $O(\\Delta t^2)$. For a total simulation time $T_{\\mathrm{end}}$, the number of steps is $N = T_{\\mathrm{end}}/\\Delta t$. The global error, which is the accumulation of local errors, is therefore of order $N \\times O(\\Delta t^2) = (T_{\\mathrm{end}}/\\Delta t) \\times O(\\Delta t^2) = O(\\Delta t)$. This means the Lie splitting scheme is a first-order method, and the observed convergence order $p$ should be approximately $1$. The commutator $[\\mathcal{B},\\mathcal{A}]$ is non-zero because the source operator $\\mathcal{B}$ depends on $T$, and the diffusion operator $\\mathcal{A}$ involves spatial derivatives of $T$. Applying heat changes the temperature profile, which in turn alters the temperature curvature that drives diffusion, so the order of operations matters. An exception is Case 2 where $J = 0$, leading to $q=0$ and $\\mathcal{B}=0$. In this case, $[\\mathcal{B},\\mathcal{A}]=0$, the splitting error vanishes, and the total error is governed solely by the discretization methods for the sub-problems.\n\n### **Discretization and Implementation**\n\nThe spatial domain $x \\in [0, L]$ is discretized into $N_x$ grid points $x_i = i \\Delta x$ for $i=0, \\dots, N_x-1$, with spacing $\\Delta x = L/(N_x-1)$.\n\n**1. Diffusion Step (Operator $\\Phi_A$):**\nWe solve $C\\,\\partial_t T = k\\,\\partial_{xx} T$ using the implicit backward Euler method. For interior nodes $i=1, \\dots, N_x-2$, the discretized equation is:\n$$\n\\frac{T^{n+1/2}_i - T^n_i}{\\Delta t} = \\frac{k}{C} \\frac{T^{n+1/2}_{i+1} - 2T^{n+1/2}_i + T^{n+1/2}_{i-1}}{\\Delta x^2}\n$$\nRearranging gives a linear system for the unknown temperatures $T^{n+1/2}_i$:\n$$\n-r T^{n+1/2}_{i-1} + (1+2r) T^{n+1/2}_i - r T^{n+1/2}_{i+1} = T^n_i\n$$\nwhere $r = \\frac{k\\,\\Delta t}{C\\,\\Delta x^2}$ is the dimensionless diffusion number. This forms a tridiagonal system of $N_x-2$ linear equations for the interior nodes. The Dirichlet boundary conditions $T^{n+1/2}_0 = T_b$ and $T^{n+1/2}_{N_x-1} = T_b$ are incorporated by moving their contributions to the right-hand side of the equations for nodes $i=1$ and $i=N_x-2$. The resulting system is solved efficiently using a standard tridiagonal matrix solver, such as `scipy.linalg.solve_banded`. The backward Euler method is A-stable, which is crucial for handling the potentially stiff diffusion term without severe restrictions on $\\Delta t_s$.\n\n**2. Source Step (Operator $\\Phi_B$):**\nWe solve the system of Ordinary Differential Equations (ODEs) $\\partial_t T_i = \\mathcal{B}(T_i) = q(J,T_i)/C$ for each interior node $i=1, \\dots, N_x-2$. This is done using the second-order explicit Heun's method. For each node, given the temperature $T_i^{\\text{in}} = T^{n+1/2}_i$ at the beginning of the step, the update proceeds as:\n- **Predictor:** $\\tilde{T}_i = T_i^{\\text{in}} + \\Delta t \\cdot \\frac{q(J, T_i^{\\text{in}})}{C}$\n- **Corrector:** $T^{n+1}_i = T_i^{\\text{in}} + \\frac{\\Delta t}{2C} \\left( q(J, T_i^{\\text{in}}) + q(J, \\tilde{T}_i) \\right)$\nThis method is applied pointwise to all interior nodes. After the update, the boundary conditions are re-enforced: $T^{n+1}_0 = T_b$ and $T^{n+1}_{N_x-1} = T_b$.\n\n**3. Convergence Analysis:**\nThe numerical solution is computed for several coarse time steps $\\Delta t_k$ and compared against a reference solution obtained with a much smaller time step $\\Delta t_{\\mathrm{ref}}$. The error is quantified by the spatial root-mean-square (RMS) error at the final time $T_{\\mathrm{end}}$:\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N_x}\\sum_{i=0}^{N_x-1}\\left(T_i^{\\mathrm{coarse}} - T_i^{\\mathrm{ref}}\\right)^2}\n$$\nThe observed order of convergence $p$ is estimated from two error calculations, $\\mathrm{RMS}_1$ and $\\mathrm{RMS}_2$, corresponding to time steps $\\Delta t_1$ and $\\Delta t_2 = \\Delta t_1 / r_t$:\n$$\np = \\frac{\\log(\\mathrm{RMS}_1 / \\mathrm{RMS}_2)}{\\log(r_t)}\n$$\nFor a first-order method, we expect $p \\approx 1$.\n\nThe overall algorithm proceeds by initializing the temperature profile and then iterating the two-step (diffusion-source) update until $T_{\\mathrm{end}}$ is reached. The procedure is repeated for each test case to calculate the required RMS errors and convergence orders.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D quench propagation problem using a Lie operator splitting scheme\n    and analyzes its convergence for three different test cases.\n    \"\"\"\n\n    # Physical and numerical parameters\n    L = 0.1  # m\n    Tb = 4.2  # K\n    k = 50.0  # W/(m.K)\n    C = 3.0e6  # J/(m^3.K)\n    Tc = 9.2  # K\n    Jc0 = 3.0e8  # A/m^2\n    Ec = 1.0e-4  # V/m\n    n = 15.0\n    epsilon = 1.0e-3  # A/m^2\n    rho0 = 1.0e-9  # Ohm.m\n    beta = 5.0e-3  # K^-1\n    Nx = 81\n    delta_T_init = 20.0  # K\n    sigma_init = 0.004  # m\n    T_end = 2.0e-4  # s\n    dt_ref = 2.5e-6  # s\n    coarse_dts = [4.0e-5, 2.0e-5, 1.0e-5] # s\n    time_step_ratio = 2.0\n\n    # Test cases for current density J\n    test_cases_J = [\n        1.0e8,  # Case 1: typical current\n        0.0,    # Case 2: no source edge case\n        4.0e8   # Case 3: stiff source regime\n    ]\n\n    # Helper functions for the source term q(J, T)\n    def get_Jc(T):\n        return Jc0 * np.maximum(0.0, 1.0 - T / Tc)\n\n    def get_rho_eff(T):\n        return rho0 * (1.0 + beta * np.maximum(T - Tb, 0.0))\n\n    def get_E(J, T):\n        if J == 0.0:\n            return np.zeros_like(T)\n        \n        Jc = get_Jc(T)\n        rho_eff = get_rho_eff(T)\n        \n        # Guard against division by zero or very small Jc\n        safe_Jc = np.maximum(Jc, epsilon)\n        E_sc = Ec * (J / safe_Jc)**n\n        \n        # Piecewise definition of E\n        E = np.where(T  Tc, np.minimum(E_sc, E_n), E_n)\n        return E\n\n    def get_q(J, T):\n        return get_E(J, T) * J\n\n    # Main simulation function\n    def compute_evolution(J, dt):\n        \"\"\"\n        Computes the temperature evolution up to T_end for a given J and dt.\n        \"\"\"\n        x = np.linspace(0, L, Nx)\n        dx = L / (Nx - 1)\n        \n        # Initial condition\n        T = Tb + delta_T_init * np.exp(-(x - L / 2)**2 / (2 * sigma_init**2))\n        \n        num_steps = int(np.ceil(T_end / dt))\n        actual_dt = T_end / num_steps\n\n        # --- Diffusion Step Setup (Backward Euler) ---\n        r = (k * actual_dt) / (C * dx**2)\n        \n        A_banded = np.zeros((3, Nx - 2))\n        A_banded[0, 1:] = -r  # Upper diagonal\n        A_banded[1, :] = 1.0 + 2.0 * r  # Main diagonal\n        A_banded[2, :-1] = -r  # Lower diagonal\n\n        # --- Time-stepping loop ---\n        for _ in range(num_steps):\n            # Step A: Diffusion\n            # Setup RHS b for Ax=b, with boundary conditions\n            b = T[1:-1].copy()\n            b[0] += r * Tb\n            b[-1] += r * Tb\n            \n            # Solve the tridiagonal system for interior nodes\n            T_half_interior = solve_banded((1, 1), A_banded, b)\n            \n            # Reconstruct T_half with boundary conditions\n            T_half = np.full(Nx, Tb)\n            T_half[1:-1] = T_half_interior\n\n            # Step B: Source (Heun's Method)\n            T_in_interior = T_half[1:-1]\n            \n            # Predictor\n            q_in = get_q(J, T_in_interior)\n            k1 = q_in / C\n            T_pred_interior = T_in_interior + actual_dt * k1\n            \n            # Corrector\n            q_pred = get_q(J, T_pred_interior)\n            k2 = q_pred / C\n            T_new_interior = T_in_interior + 0.5 * actual_dt * (k1 + k2)\n            \n            # Update temperature profile and enforce BCs\n            T[1:-1] = T_new_interior\n            T[0] = Tb\n            T[-1] = Tb\n            \n        return T\n\n    # Main logic to run test cases and compute errors\n    all_results = []\n    \n    for J_case in test_cases_J:\n        # Compute reference solution with fine time step\n        T_ref = compute_evolution(J_case, dt_ref)\n        \n        rms_errors = []\n        # Compute solutions with coarse time steps and find errors\n        for dt_coarse in coarse_dts:\n            T_coarse = compute_evolution(J_case, dt_coarse)\n            rms = np.sqrt(np.mean((T_coarse - T_ref)**2))\n            rms_errors.append(rms)\n        \n        all_results.extend(rms_errors)\n        \n        # Compute observed convergence orders\n        p12 = np.log(rms_errors[0] / rms_errors[1]) / np.log(time_step_ratio)\n        p23 = np.log(rms_errors[1] / rms_errors[2]) / np.log(time_step_ratio)\n        \n        all_results.append(p12)\n        all_results.append(p23)\n\n    # Print the final results in the required format\n    print(f\"[{','.join(f'{val:.8f}' for val in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}