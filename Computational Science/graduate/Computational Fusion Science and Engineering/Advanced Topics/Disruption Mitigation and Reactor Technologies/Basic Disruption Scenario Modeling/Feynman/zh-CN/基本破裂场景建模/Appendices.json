{
    "hands_on_practices": [
        {
            "introduction": "安全因子 $q(a)$ 是决定托卡马克等离子体稳定性的关键参数。在破裂期间，等离子体电流会迅速变化，从而改变磁场位形。本练习将通过第一性原理推导等离子体电流与边缘安全因子之间的关系，让你获得动手实践的经验。通过计算电流下降过程中的 $q(a)$ 变化，你将更深入地理解破裂如何改变等离子体的基本磁流体动力学（MHD）稳定性边界。",
            "id": "3953740",
            "problem": "一个大环径比、圆形截面的托卡马克，其大半径为 $R$，小半径为 $a$，在环向磁场 $B_{t}$ 和等离子体电流 $I_{p}$ 下运行。在一次快速热猝发期间，等离子体电流在远小于电阻扩散时间的时间尺度上减小，因此可以认为电流分布的形状保持不变，而其幅值减小。假设在所关心的时间尺度内，环向磁场 $B_{t}$ 保持恒定，并且边缘处的Shafranov位移足够小，可以忽略其对安全因子的影响。将等离子体视为轴对称，并使用真空磁导率 $\\mu_{0}$。\n\n从安全因子的基本定义和麦克斯韦-安培定律出发，对于具有均匀边缘电流密度的圆形等离子体，推导边缘安全因子 $q(a)$ 关于 $a$、$R$、$B_{t}$ 和 $I_{p}$ 的表达式。然后，对于具体参数 $a = 0.85\\,\\text{m}$，$R = 2.6\\,\\text{m}$，$B_{t} = 4.2\\,\\text{T}$，以及初始等离子体电流 $I_{p0} = 2.0\\,\\text{MA}$ 在猝发期间减少了 $35\\%$ 的情况，计算电流减小后更新的边缘安全因子 $q(a)$。利用你的结果，说明在这次电流下降过程中是否可能达到条件 $q(a)  2$，并根据推导出的表达式所隐含的变化方向，简要地证明你的预测。\n\n将 $q(a)$ 的最终数值表示为无量纲数，并四舍五入至四位有效数字。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、提法得当、客观且完整。\n\n### 步骤1：提取已知条件\n- 大半径：$R$\n- 小半径：$a$\n- 环向磁场：$B_{t}$\n- 等离子体电流：$I_{p}$\n- 真空磁导率：$\\mu_{0}$\n- 假设：大环径比、圆形截面托卡马克；快速热猝发（电流衰减时间尺度远小于电阻扩散时间）；电流分布形状固定；$B_{t}$ 恒定；边缘等离子体处的Shafranov位移可忽略不计。\n- 具体参数：$a = 0.85\\,\\text{m}$，$R = 2.6\\,\\text{m}$，$B_{t} = 4.2\\,\\text{T}$。\n- 初始等离子体电流：$I_{p0} = 2.0\\,\\text{MA}$。\n- 电流减少量：$35\\%$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题使用了等离子体物理学和磁流体动力学（MHD）的基本原理，包括安全因子的定义和麦克斯韦-安培定律。所描述的情景，即热猝发导致电流下降，是托卡马克破裂物理学的标准要素。给定的参数对于中型托卡马克是物理上现实的。该问题在科学上是合理的。\n- **提法得当：** 提供了所有必要的信息和简化假设（大环径比、圆形截面），以推导唯一的解析表达式并计算一个确定的数值答案。\n- **客观性：** 问题陈述使用了聚变科学中精确、标准的术语，没有主观或模棱两可的语言。\n\n### 步骤3：结论与行动\n该问题是一致的、提法得当且有科学依据的，因此是有效的。将提供完整解答。\n\n### 解答推导\n安全因子 $q$ 是衡量环形约束装置中磁力线螺距的物理量。对于大环径比（$R/a \\gg 1$）、圆形截面的托卡马克，在小半径 $r$ 处的安全因子由以下表达式给出：\n$$ q(r) = \\frac{r B_{t}}{R B_{p}(r)} $$\n其中 $B_{t}$ 是环向磁场（在等离子体截面上近似恒定），$B_{p}(r)$ 是小半径 $r$ 处的极向磁场。我们需要求解边缘安全因子 $q(a)$，因此我们在 $r=a$ 处计算该表达式：\n$$ q(a) = \\frac{a B_{t}}{R B_{p}(a)} $$\n为了求出等离子体边缘的极向磁场 $B_{p}(a)$，我们使用积分形式的麦克斯韦-安培定律：\n$$ \\oint_{C} \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_{0} I_{enc} $$\n我们选择积分路径 $C$ 为极向平面内一个以磁轴为中心、半径为 $a$ 的圆形回路。由于假定的轴对称性，极向磁场的大小 $B_{p}(a)$ 在此路径上是恒定的。路径长度是该圆的周长，$2\\pi a$。该路径所包围的总电流 $I_{enc}$ 就是总等离子体电流 $I_{p}$。因此，安培定律变为：\n$$ B_{p}(a) (2 \\pi a) = \\mu_{0} I_{p} $$\n求解 $B_{p}(a)$ 可得：\n$$ B_{p}(a) = \\frac{\\mu_{0} I_{p}}{2 \\pi a} $$\n现在，我们将 $B_{p}(a)$ 的这个表达式代回到 $q(a)$ 的公式中：\n$$ q(a) = \\frac{a B_{t}}{R \\left( \\frac{\\mu_{0} I_{p}}{2 \\pi a} \\right)} $$\n化简该表达式，得到边缘安全因子所需的关系式：\n$$ q(a) = \\frac{2 \\pi a^{2} B_{t}}{\\mu_{0} R I_{p}} $$\n该表达式表明，对于固定的几何参数（$a$，$R$）和环向磁场（$B_t$），边缘安全因子 $q(a)$ 与等离子体电流 $I_{p}$ 成反比，即 $q(a) \\propto I_{p}^{-1}$。\n\n接下来，我们计算 $q(a)$ 的更新后数值。初始等离子体电流为 $I_{p0} = 2.0\\,\\text{MA} = 2.0 \\times 10^{6}\\,\\text{A}$。在猝发期间，该电流减少了 $35\\%$。因此，新的等离子体电流 $I_{p, \\text{new}}$ 是初始电流的 $65\\%$：\n$$ I_{p, \\text{new}} = (1 - 0.35) I_{p0} = 0.65 \\times (2.0 \\times 10^{6}\\,\\text{A}) = 1.3 \\times 10^{6}\\,\\text{A} $$\n现在我们可以将给定的数值代入推导出的 $q(a)$ 公式中：\n- $a = 0.85\\,\\text{m}$\n- $R = 2.6\\,\\text{m}$\n- $B_{t} = 4.2\\,\\text{T}$\n- $I_{p} = I_{p, \\text{new}} = 1.3 \\times 10^{6}\\,\\text{A}$\n- $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\text{T}\\cdot\\text{m/A}$\n\n$$ q(a) = \\frac{2 \\pi (0.85)^{2} (4.2)}{(4\\pi \\times 10^{-7}) (2.6) (1.3 \\times 10^{6})} $$\n分子中的 $2\\pi$ 与分母中的 $4\\pi$ 相消，在分母中留下一个因子 $2$：\n$$ q(a) = \\frac{(0.85)^{2} (4.2)}{2 \\times 10^{-7} \\times (2.6) \\times (1.3 \\times 10^{6})} $$\n$$ q(a) = \\frac{(0.7225) (4.2)}{2 \\times 2.6 \\times 1.3 \\times 10^{-1}} = \\frac{3.0345}{0.676} \\approx 4.488905... $$\n四舍五入到四位有效数字，更新后的边缘安全因子为 $4.489$。\n\n最后，我们必须评估是否能达到条件 $q(a)  2$。首先，我们计算与初始电流 $I_{p0} = 2.0 \\times 10^{6}\\,\\text{A}$ 对应的初始安全因子 $q_{0}(a)$：\n$$ q_{0}(a) = \\frac{2 \\pi (0.85)^{2} (4.2)}{(4\\pi \\times 10^{-7}) (2.6) (2.0 \\times 10^{6})} = \\frac{3.0345}{1.04} \\approx 2.9177... > 2 $$\n初始安全因子约为 $2.918$，已经大于 $2$。根据推导出的表达式 $q(a) \\propto I_{p}^{-1}$，等离子体电流 $I_{p}$ 的*减少*会导致边缘安全因子 $q(a)$ 的*增加*。由于电流从 $2.0\\,\\text{MA}$ 下降到 $1.3\\,\\text{MA}$， $q(a)$ 的值将从其初始值约 $2.918$ 增加到最终值约 $4.489$。在这次电流下降过程中的任何时刻，安全因子都不会减小。因此，条件 $q(a)  2$ 无法达到；等离子体状态会离这个阈值越来越远。",
            "answer": "$$\n\\boxed{4.489}\n$$"
        },
        {
            "introduction": "托卡马克破裂最严重的后果之一，是在热淬灭期间沉积在面向等离子体部件上的巨大热通量。破裂建模的一个主要任务就是为工程设计估算这些热负荷的大小。这个实践问题挑战你将能量守恒原理应用于一个简化的“平顶”模型，这是一种进行保守工程估算的常用方法。你将学习如何把诊断数据转化为峰值热通量值，这是一项评估偏滤器和第一壁材料生存能力的关键技能。",
            "id": "3953735",
            "problem": "一台大型偏滤器托卡马克在一次大破裂期间经历了一次热淬灭。在淬灭之前，等离子体储存的热能为 $W_{\\mathrm{th}} = 3.0~\\mathrm{MJ}$。在淬灭期间，诊断表明该热能的一部分（比例为 $\\chi = 0.60$）以热量的形式迅速输运到外偏滤器打击区。快速红外（IR）热成像显示，打击板上的热量沉积空间足迹可近似为一个椭圆斑点，其 $1/\\exp(2)$ 强度半径分别为 $a = 0.25~\\mathrm{m}$ 和 $b = 0.12~\\mathrm{m}$。热脉冲的时间分布近似为高斯分布，其半高全宽（FWHM）持续时间为 $\\tau_{\\mathrm{FWHM}} = 2.5~\\mathrm{ms}$。\n\n假设一个基本的大破裂情景模型，其中：\n- 沉积的热量 $\\Delta W$ 由沉积比例和淬灭前热能的乘积给出。\n- 为了进行保守的工程估算，时空热脉冲被替换为一个平顶（矩形）脉冲，其在等于椭圆面积的足迹面积上和等于 FWHM 的持续时间内具有均匀的热通量。\n- 峰值表面热通量由该等效平顶脉冲的平均通量近似。\n\n从能量守恒和热通量作为单位面积能量传输速率的定义出发，推导峰值表面热通量的表达式，该表达式用 $\\Delta W$、有效沉积面积和有效脉冲持续时间表示。然后根据上述参数计算其值。将最终热通量以 $\\mathrm{GW}\\,\\mathrm{m}^{-2}$ 为单位表示，并将答案四舍五入到三位有效数字。明确说明您使用的任何额外简化假设，并确保推导中的所有步骤都基于第一性原理，除了基本定义外，不引用专门的大破裂热通量公式。",
            "solution": "首先验证问题，以确保其科学上合理、内容独立且提法恰当。\n\n**步骤1：提取已知条件**\n- 淬灭前等离子体热能：$W_{\\mathrm{th}} = 3.0~\\mathrm{MJ}$\n- 沉积的热能比例：$\\chi = 0.60$\n- 具有 $1/\\exp(2)$ 强度半径的椭圆形热量沉积足迹：$a = 0.25~\\mathrm{m}$ 和 $b = 0.12~\\mathrm{m}$\n- 热脉冲时间上的半高全宽（FWHM）持续时间：$\\tau_{\\mathrm{FWHM}} = 2.5~\\mathrm{ms}$\n- 建模假设1：总沉积热量为 $\\Delta W = \\chi W_{\\mathrm{th}}$。\n- 建模假设2：时空热脉冲近似为平顶（矩形）脉冲。\n- 建模假设3：平顶脉冲的有效足迹面积是椭圆的面积，$A_{\\mathrm{eff}} = \\pi a b$。\n- 建模假设4：平顶脉冲的有效持续时间是其半高全宽，$\\tau_{\\mathrm{eff}} = \\tau_{\\mathrm{FWHM}}$。\n- 建模假设5：峰值表面热通量 $q_{\\mathrm{peak}}$ 是等效平顶脉冲的均匀通量。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了托卡马克中的一次大破裂，这是聚变能研究中的一个关键问题。参数（$W_{\\mathrm{th}}$, $\\tau_{\\mathrm{FWHM}}$, $a$, $b$）对于大型聚变实验来说在物理上是现实的。该问题提法恰当，提供了一套清晰的简化假设（平顶模型），使得问题可以用给定的数据求解。所有术语都得到了客观和精确的定义。该问题不违反任何基本原理，不是不完整或矛盾的，并且与其所述的计算聚变科学领域直接相关。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将推导解答。\n\n**峰值表面热通量的推导**\n\n分析从热通量的基本定义开始。热通量，用 $q$ 表示，定义为单位面积（$dA$）的能量传输速率（$dE/dt$）。通常，它是位置 $\\mathbf{x}$ 和时间 $t$ 的函数。\n$$q(\\mathbf{x}, t) = \\frac{d^3 E}{dA \\, dt}$$\n在所有时间内沉积到表面 $S$ 上的总能量 $\\Delta W$ 是热通量对面积和时间的积分：\n$$\\Delta W = \\int_0^\\infty \\int_S q(\\mathbf{x}, t) \\, dA \\, dt$$\n问题要求我们使用简化的“平顶”模型。该模型将实际随时间和空间变化的热通量 $q(\\mathbf{x}, t)$ 替换为一个在有效面积 $A_{\\mathrm{eff}}$ 上和有效持续时间 $\\tau_{\\mathrm{eff}}$ 内恒定、均匀的热通量，我们称之为 $q_{\\mathrm{peak}}$。\n因此，平顶近似为：\n$$\nq(\\mathbf{x}, t) \\approx \n\\begin{cases} \nq_{\\mathrm{peak}}  \\text{若 } 0 \\le t \\le \\tau_{\\mathrm{eff}} \\text{ 且 } \\mathbf{x} \\text{ 在面积为 } A_{\\mathrm{eff}} \\text{ 的表面上} \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n将此近似代入能量积分，我们应用能量守恒原理，该原理指出总沉积能量 $\\Delta W$ 在模型中必须守恒。\n$$\\Delta W = \\int_0^{\\tau_{\\mathrm{eff}}} \\int_{A_{\\mathrm{eff}}} q_{\\mathrm{peak}} \\, dA \\, dt$$\n由于根据模型定义，$q_{\\mathrm{peak}}$ 是常数，因此可以将其移到积分之外：\n$$\\Delta W = q_{\\mathrm{peak}} \\int_0^{\\tau_{\\mathrm{eff}}} \\left( \\int_{A_{\\mathrm{eff}}} dA \\right) dt$$\n对面积 $A_{\\mathrm{eff}}$ 的积分就是面积本身，$\\int_{A_{\\mathrm{eff}}} dA = A_{\\mathrm{eff}}$。对时间的积分是一个简单的定积分，$\\int_0^{\\tau_{\\mathrm{eff}}} dt = \\tau_{\\mathrm{eff}}$。\n将这些结果代回，我们得到平顶模型的能量平衡方程：\n$$\\Delta W = q_{\\mathrm{peak}} A_{\\mathrm{eff}} \\tau_{\\mathrm{eff}}$$\n该方程表明，总沉积能量等于峰值（且恒定）热通量、其作用面积以及其持续时间的乘积。这是将能量守恒应用于简化模型的直接结果。\n\n为了求得峰值热通量，我们重新整理这个表达式：\n$$q_{\\mathrm{peak}} = \\frac{\\Delta W}{A_{\\mathrm{eff}} \\tau_{\\mathrm{eff}}}$$\n这就是基于所提供的平顶模型得到的峰值表面热通量的解析表达式。\n\n**峰值热通量的计算**\n\n现在我们使用给定的参数来计算此表达式中的各项。\n\n1.  **总沉积能量 ($\\Delta W$)**：\n    问题指出，初始热能 $W_{\\mathrm{th}}$ 的一部分（比例为 $\\chi$）被沉积。\n    $$W_{\\mathrm{th}} = 3.0~\\mathrm{MJ} = 3.0 \\times 10^6~\\mathrm{J}$$\n    $$\\chi = 0.60$$\n    $$\\Delta W = \\chi W_{\\mathrm{th}} = (0.60)(3.0 \\times 10^6~\\mathrm{J}) = 1.8 \\times 10^6~\\mathrm{J}$$\n\n2.  **有效沉积面积 ($A_{\\mathrm{eff}}$)**：\n    模型指定有效面积为半轴为 $a$ 和 $b$ 的椭圆面积。\n    $$a = 0.25~\\mathrm{m}$$\n    $$b = 0.12~\\mathrm{m}$$\n    椭圆的面积由 $A = \\pi ab$ 给出。\n    $$A_{\\mathrm{eff}} = \\pi a b = \\pi (0.25~\\mathrm{m})(0.12~\\mathrm{m}) = 0.030 \\pi~\\mathrm{m}^2$$\n\n3.  **有效脉冲持续时间 ($\\tau_{\\mathrm{eff}}$)**：\n    模型指定有效持续时间等于时间脉冲的半高全宽。\n    $$\\tau_{\\mathrm{FWHM}} = 2.5~\\mathrm{ms} = 2.5 \\times 10^{-3}~\\mathrm{s}$$\n    $$\\tau_{\\mathrm{eff}} = \\tau_{\\mathrm{FWHM}} = 2.5 \\times 10^{-3}~\\mathrm{s}$$\n\n现在，我们将这些值代入推导出的 $q_{\\mathrm{peak}}$ 表达式中：\n$$q_{\\mathrm{peak}} = \\frac{1.8 \\times 10^6~\\mathrm{J}}{(0.030 \\pi~\\mathrm{m}^2)(2.5 \\times 10^{-3}~\\mathrm{s})}$$\n我们可以先简化分母：\n$$(0.030)(2.5 \\times 10^{-3}) = 0.075 \\times 10^{-3} = 7.5 \\times 10^{-5}$$\n所以，\n$$q_{\\mathrm{peak}} = \\frac{1.8 \\times 10^6}{7.5 \\pi \\times 10^{-5}}~\\frac{\\mathrm{J}}{\\mathrm{m}^2 \\cdot \\mathrm{s}}$$\n单位 $\\mathrm{J/s}$ 是瓦特（$\\mathrm{W}$），所以热通量的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n$$q_{\\mathrm{peak}} = \\frac{1.8}{7.5 \\pi} \\times 10^{11}~\\mathrm{W}\\,\\mathrm{m}^{-2} = \\frac{180}{7.5 \\pi} \\times 10^9~\\mathrm{W}\\,\\mathrm{m}^{-2}$$\n由于 $180 / 7.5 = 24$，我们有：\n$$q_{\\mathrm{peak}} = \\frac{24}{\\pi} \\times 10^9~\\mathrm{W}\\,\\mathrm{m}^{-2}$$\n问题要求结果以吉瓦每平方米（$\\mathrm{GW}\\,\\mathrm{m}^{-2}$）为单位。由于 $1~\\mathrm{GW} = 10^9~\\mathrm{W}$，表达式变为：\n$$q_{\\mathrm{peak}} = \\frac{24}{\\pi}~\\mathrm{GW}\\,\\mathrm{m}^{-2}$$\n现在，我们计算数值并四舍五入到三位有效数字：\n$$q_{\\mathrm{peak}} \\approx \\frac{24}{3.14159...} \\approx 7.639437...~\\mathrm{GW}\\,\\mathrm{m}^{-2}$$\n四舍五入到三位有效数字得到：\n$$q_{\\mathrm{peak}} \\approx 7.64~\\mathrm{GW}\\,\\mathrm{m}^{-2}$$\n\n**使用的额外简化假设**\n该解答依赖于问题中“平顶”模型明确说明的简化假设。除此之外，我们隐式假设：\n1.  所有沉积能量 $\\Delta W$ 都表现为表面热负荷。在此能量平衡中不考虑其他能量损失或转换机制（例如，从偏滤器表面立即发生的再辐射、溅射粒子的动能）。\n2.  就本次计算而言，诊断测量值（$\\chi$、FWHM、$a$、$b$）是精确的。\n3.  按照指示，使用 $A_{\\mathrm{eff}} = \\pi ab$ 和 $\\tau_{\\mathrm{eff}} = \\tau_{\\mathrm{FWHM}}$ 是保守的工程近似。更详细的将高斯分布关联到等效平顶分布的模型会得出略有不同的有效面积和持续时间，但问题陈述强制要求使用这种更简单的选择。",
            "answer": "$$\\boxed{7.64}$$"
        },
        {
            "introduction": "在热淬灭之后，巨大的等离子体电流的快速衰减（即电流淬灭）会在周围的导电结构（如真空室）中感应出巨大的电动势和电流。这些效应对于结构工程和控制系统设计至关重要。本练习将指导你建立一个双回路电路模型，以捕捉等离子体-容器感应耦合的基本动态过程。通过实施和求解该模型，你将量化容器特性如何影响等离子体电流衰减和产生的环路电压，从而深入了解破裂过程中的复杂电磁暂态。",
            "id": "3953731",
            "problem": "考虑一个简化的托卡马克电流猝灭双环路模型，该模型由一个等离子体环路和一个通过磁耦合的导电真空室环路组成。目标是从基本电磁定律出发，推导出一个计算模型，以量化真空室电感和互耦合在电流猝灭期间如何改变环路电压 $V_{loop}(t)$ 的时间演化。将等离子体和真空室视为两个单匝电路，其自感分别为 $L_p$ 和 $L_v$，电阻分别为 $R_p$ 和 $R_v$，互感为 $M$，且满足 $M^2  L_p L_v$ 以确保电感矩阵是正定的。假设猝灭发生后没有外部施加的电动势。模型必须从麦克斯韦-法拉第定律推导，然后进行计算实现。\n\n您必须执行以下步骤，然后在程序中实现它们：\n\n1. 起点（麦克斯韦-法拉第定律和磁链定义）：\n   - 使用麦克斯韦-法拉第定律 $\\oint \\mathbf{E} \\cdot d\\boldsymbol{\\ell} = - \\frac{d\\Phi}{dt}$，并定义等离子体磁链 $\\Phi_p(t) = L_p I_p(t) + M I_v(t)$ 和真空室磁链 $\\Phi_v(t) = L_v I_v(t) + M I_p(t)$，其中 $I_p(t)$ 和 $I_v(t)$ 分别是等离子体电流和真空室电流。用 $R_p I_p(t)$ 和 $R_v I_v(t)$ 模拟电阻电压降。\n   - 在猝灭后没有外部施加电动势的假设下（变压器初级线圈保持恒定，从而使外部施加的环向电场为零），写出两个独立的环路电压平衡方程：$R_p I_p(t) + \\frac{d\\Phi_p}{dt} = 0$ 和 $R_v I_v(t) + \\frac{d\\Phi_v}{dt} = 0$。\n\n2. 推导耦合常微分方程（ODE）系统：\n   - 从平衡方程推导出耦合线性系统\n     $$L_p \\frac{dI_p}{dt} + M \\frac{dI_v}{dt} = - R_p I_p,$$\n     $$M \\frac{dI_p}{dt} + L_v \\frac{dI_v}{dt} = - R_v I_v.$$\n   - 使用电感矩阵 $\\mathbf{L} = \\begin{bmatrix} L_p  M \\\\ M  L_v \\end{bmatrix}$ 和电阻矩阵 $\\mathbf{R} = \\begin{bmatrix} R_p  0 \\\\ 0  R_v \\end{bmatrix}$ 将其写成矩阵形式：\n     $$\\mathbf{L} \\frac{d}{dt}\\begin{bmatrix} I_p \\\\ I_v \\end{bmatrix} = - \\mathbf{R} \\begin{bmatrix} I_p \\\\ I_v \\end{bmatrix}, \\quad \\text{所以} \\quad \\frac{d}{dt}\\begin{bmatrix} I_p \\\\ I_v \\end{bmatrix} = - \\mathbf{A} \\begin{bmatrix} I_p \\\\ I_v \\end{bmatrix}, \\quad \\mathbf{A} = \\mathbf{L}^{-1} \\mathbf{R}.$$\n\n3. 表达环路电压及其对耦合的依赖性：\n   - 将环路电压定义为等离子体磁链的负时间导数，\n     $$V_{loop}(t) = - \\frac{d\\Phi_p}{dt} = - \\left( L_p \\frac{dI_p}{dt} + M \\frac{dI_v}{dt} \\right).$$\n   - 使用等离子体环路平衡方程 $R_p I_p + \\frac{d\\Phi_p}{dt} = 0$，证明\n     $$V_{loop}(t) = R_p I_p(t).$$\n     因此，互感耦合和真空室电感没有显式出现在 $V_{loop}(t)$ 中，但它们通过耦合动力学改变了 $I_p(t)$ 的时间演化，从而间接改变了 $V_{loop}(t)$。\n\n4. 算法说明：\n   - 使用矩阵指数求解具有初始条件 $\\begin{bmatrix} I_p(0) \\\\ I_v(0) \\end{bmatrix} = \\begin{bmatrix} I_0 \\\\ 0 \\end{bmatrix}$ 的线性ODE系统：\n     $$\\begin{bmatrix} I_p(t) \\\\ I_v(t) \\end{bmatrix} = e^{-\\mathbf{A} t} \\begin{bmatrix} I_0 \\\\ 0 \\end{bmatrix}.$$\n   - 在指定的评估时间点计算 $V_{loop}(t) = R_p I_p(t)$。\n   - 计算由 $V_{loop}(t_{1/2}) = \\frac{1}{2} V_{loop}(0)$ 定义的半电压时间 $t_{1/2}$，即 $I_p(t_{1/2}) = \\frac{1}{2} I_0$。通过对 $I_p(t)$ 进行稳健的单调二分法搜索，以数值方式找到 $t_{1/2}$。\n\n5. 单位和数值：\n   - 所有电感单位必须是亨利（$\\mathrm{H}$），所有电阻单位是欧姆（$\\Omega$），所有电流单位是安培（$\\mathrm{A}$），时间单位是秒（$\\mathrm{s}$），$V_{loop}$ 单位是伏特（$\\mathrm{V}$）。以这些单位将最终数值答案表示为十进制浮点数。\n\n6. 测试套件：\n   - 实现以下四组参数集，并报告三个评估时间点的环路电压以及半电压时间。对于每种情况，使用 $I_0 = 5.0 \\times 10^6 \\, \\mathrm{A}$ 和评估时间 $t = 0.0 \\, \\mathrm{s}$、$t = 0.02 \\, \\mathrm{s}$ 和 $t = 0.05 \\, \\mathrm{s}$。\n     - 情况1（基线耦合）：$L_p = 1.2 \\times 10^{-6} \\, \\mathrm{H}$, $R_p = 1.2 \\times 10^{-5} \\, \\Omega$, $L_v = 8.0 \\times 10^{-6} \\, \\mathrm{H}$, $R_v = 2.0 \\times 10^{-4} \\, \\Omega$, $M = 2.5 \\times 10^{-6} \\, \\mathrm{H}$。\n     - 情况2（无耦合边界）：$L_p = 1.2 \\times 10^{-6} \\, \\mathrm{H}$, $R_p = 1.2 \\times 10^{-5} \\, \\Omega$, $L_v = 8.0 \\times 10^{-6} \\, \\mathrm{H}$, $R_v = 2.0 \\times 10^{-4} \\, \\Omega$, $M = 0.0 \\, \\mathrm{H}$。\n     - 情况3（高导电性真空室）：$L_p = 1.2 \\times 10^{-6} \\, \\mathrm{H}$, $R_p = 1.2 \\times 10^{-5} \\, \\Omega$, $L_v = 8.0 \\times 10^{-6} \\, \\mathrm{H}$, $R_v = 2.0 \\times 10^{-6} \\, \\Omega$, $M = 2.5 \\times 10^{-6} \\, \\mathrm{H}$。\n     - 情况4（接近能量正定界的强互感耦合）：$L_p = 1.2 \\times 10^{-6} \\, \\mathrm{H}$, $R_p = 1.2 \\times 10^{-5} \\, \\Omega$, $L_v = 8.0 \\times 10^{-6} \\, \\mathrm{H}$, $R_v = 2.0 \\times 10^{-4} \\, \\Omega$, $M = 2.95 \\times 10^{-6} \\, \\mathrm{H}$。\n   - 验证每种情况下 $M^2  L_p L_v$。使用初始条件 $I_p(0) = I_0$ 和 $I_v(0) = 0$。\n\n7. 要求的最终输出格式：\n   - 您的程序应生成单行输出，其中包含四个情况的结果，格式为方括号内由逗号分隔的列表。每种情况的结果必须是包含四个十进制浮点数的列表，顺序为 $[V_{loop}(0.0 \\, \\mathrm{s}), V_{loop}(0.02 \\, \\mathrm{s}), V_{loop}(0.05 \\, \\mathrm{s}), t_{1/2}]$，其中 $V_{loop}$ 的单位为伏特，$t_{1/2}$ 的单位为秒。例如，输出必须如下所示\n     $$[ [v_{10}, v_{12}, v_{15}, t_{1/2,1}], [v_{20}, v_{22}, v_{25}, t_{1/2,2}], [v_{30}, v_{32}, v_{35}, t_{1/2,3}], [v_{40}, v_{42}, v_{45}, t_{1/2,4}] ].$$\n   - 程序必须只打印这一行，不打印任何其他内容。",
            "solution": "该问题是有效的。它在科学上基于电磁学和电路理论的原理，特别是应用于托卡马克破裂的标准简化模型。该问题是适定的，提供了一个具有指定初始条件和所有测试用例的完整参数集的线性常微分方程系统。条件 $M^2  L_p L_v$ 确保了电感矩阵是正定且可逆的，从而保证了唯一且稳定的解。所有术语都得到了明确的定义。\n\n推导和计算实现过程如下。\n\n物理系统由两个磁耦合电路组成：等离子体电流环路（下标 $p$）和真空室电流环路（下标 $v$）。在电流猝灭发生后没有外部施加电动势的条件下，每个环路中的电压平衡由 Kirchhoff 第二定律决定，该定律是麦克斯韦-法拉第感应定律的应用。每个闭合环路中的电阻电压降和感应电动势（EMF）之和必须为零。\n\n电路方程如下：\n$$R_p I_p(t) + \\frac{d\\Phi_p}{dt} = 0$$\n$$R_v I_v(t) + \\frac{d\\Phi_v}{dt} = 0$$\n其中 $R_p$ 和 $R_v$ 是等离子体和真空室的电阻，$I_p(t)$ 和 $I_v(t)$ 是各自的电流。项 $\\Phi_p(t)$ 和 $\\Phi_v(t)$ 分别表示与等离子体和真空室环路链接的总磁通量。它们由线性本构关系定义：\n$$\\Phi_p(t) = L_p I_p(t) + M I_v(t)$$\n$$\\Phi_v(t) = L_v I_v(t) + M I_p(t)$$\n此处，$L_p$ 和 $L_v$ 是自感，$M$ 是两个环路之间的互感。\n\n为了推导控制常微分方程（ODE）系统，我们首先计算磁链的时间导数：\n$$\\frac{d\\Phi_p}{dt} = L_p \\frac{dI_p}{dt} + M \\frac{dI_v}{dt}$$\n$$\\frac{d\\Phi_v}{dt} = L_v \\frac{dI_v}{dt} + M \\frac{dI_p}{dt}$$\n将这些表达式代回电压平衡方程，得到耦合系统：\n$$R_p I_p(t) + L_p \\frac{dI_p}{dt} + M \\frac{dI_v}{dt} = 0$$\n$$R_v I_v(t) + M \\frac{dI_p}{dt} + L_v \\frac{dI_v}{dt} = 0$$\n重新整理这些方程以分离导数项，我们得到问题陈述中指定的系统：\n$$L_p \\frac{dI_p}{dt} + M \\frac{dI_v}{dt} = -R_p I_p(t)$$\n$$M \\frac{dI_p}{dt} + L_v \\frac{dI_v}{dt} = -R_v I_v(t)$$\n这个系统可以优雅地用矩阵形式表示。令电流的状态向量为 $\\vec{I}(t) = \\begin{bmatrix} I_p(t) \\\\ I_v(t) \\end{bmatrix}$。系统变为：\n$$\\begin{bmatrix} L_p  M \\\\ M  L_v \\end{bmatrix} \\frac{d}{dt}\\begin{bmatrix} I_p \\\\ I_v \\end{bmatrix} = - \\begin{bmatrix} R_p  0 \\\\ 0  R_v \\end{bmatrix} \\begin{bmatrix} I_p \\\\ I_v \\end{bmatrix}$$\n这可以简写为 $\\mathbf{L} \\frac{d\\vec{I}}{dt} = -\\mathbf{R}\\vec{I}$，其中 $\\mathbf{L}$ 是对称的电感矩阵，$\\mathbf{R}$ 是对角的电阻矩阵。物理要求是，对于任何非零电流向量 $\\vec{I}$，储存的磁能 $\\frac{1}{2}\\vec{I}^T \\mathbf{L} \\vec{I}$ 必须为正，这意味着 $\\mathbf{L}$ 必须是正定矩阵。对于一个 $2 \\times 2$ 的对称矩阵，此条件等价于 $L_p  0$ 和 $\\det(\\mathbf{L}) = L_p L_v - M^2  0$。问题正确地将其指定为 $M^2  L_p L_v$。这也确保了 $\\mathbf{L}$ 是可逆的。\n\n从左侧乘以逆矩阵 $\\mathbf{L}^{-1}$，我们得到一阶线性ODE系统的标准形式：\n$$\\frac{d\\vec{I}}{dt} = -(\\mathbf{L}^{-1}\\mathbf{R})\\vec{I}$$\n定义系统矩阵 $\\mathbf{A} = \\mathbf{L}^{-1}\\mathbf{R}$，最终形式为：\n$$\\frac{d\\vec{I}}{dt} = -\\mathbf{A}\\vec{I}$$\n这个初值问题在初始条件为 $\\vec{I}(0) = \\vec{I}_0$ 时的解由矩阵指数给出：\n$$\\vec{I}(t) = e^{-\\mathbf{A}t} \\vec{I}_0$$\n\n环向环路电压 $V_{loop}(t)$ 是在等离子体环路周围感应出的电动势，定义为等离子体磁链的负变化率：$V_{loop}(t) = -\\frac{d\\Phi_p}{dt}$。从第一个环路平衡方程 $R_p I_p(t) + \\frac{d\\Phi_p}{dt} = 0$ 可以立即得出：\n$$V_{loop}(t) = R_p I_p(t)$$\n这表明环路电压与等离子体电流成正比。然而，$I_p(t)$ 的演化是由完整的耦合系统决定的，这意味着真空室的属性（$L_v$，$R_v$）和互耦合（$M$）间接控制着 $V_{loop}(t)$ 的时间演化。\n\n对于计算任务，我们给定的初始条件是 $I_p(0) = I_0$ 和 $I_v(0) = 0$，所以 $\\vec{I}_0 = \\begin{bmatrix} I_0 \\\\ 0 \\end{bmatrix}$。算法如下：\n1. 对于一组给定的参数 $\\{L_p, R_p, L_v, R_v, M\\}$，构建矩阵 $\\mathbf{L} = \\begin{bmatrix} L_p  M \\\\ M  L_v \\end{bmatrix}$ 和 $\\mathbf{R} = \\begin{bmatrix} R_p  0 \\\\ 0  R_v \\end{bmatrix}$。\n2. 计算系统矩阵 $\\mathbf{A} = \\mathbf{L}^{-1}\\mathbf{R}$。\n3. 对于每个指定的评估时间 $t$，计算矩阵指数 $e^{-\\mathbf{A}t}$，然后求出电流向量 $\\vec{I}(t) = e^{-\\mathbf{A}t} \\vec{I}_0$。\n4. 提取等离子体电流 $I_p(t)$，即 $\\vec{I}(t)$ 的第一个分量。\n5. 计算环路电压 $V_{loop}(t) = R_p I_p(t)$。\n\n为了找到半电压时间 $t_{1/2}$，我们必须求解 $V_{loop}(t_{1/2}) = \\frac{1}{2} V_{loop}(0)$。给定 $V_{loop}(t) = R_p I_p(t)$ 和 $I_p(0) = I_0$，这个条件简化为求解 $R_p I_p(t_{1/2}) = \\frac{1}{2} R_p I_0$，即 $I_p(t_{1/2}) = \\frac{1}{2}I_0$。我们寻求函数 $f(t) = I_p(t) - \\frac{1}{2}I_0$ 的根。由于系统是耗散的，电流随时间衰减，并且对于 $t  0$，$I_p(t)$ 是一个单调递减函数。这保证了 $t_{1/2}$ 存在唯一解，并且二分法是找到它的一个合适且稳健的数值技术。搜索区间可以初始化为 $[0, t_{high}]$，其中 $f(0) = I_0/2  0$ 且选择的 $t_{high}$ 使得 $f(t_{high})  0$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the tokamak current quench model for the given test cases.\n    \"\"\"\n\n    def calculate_quench_dynamics(params):\n        \"\"\"\n        Calculates loop voltages and half-voltage time for one set of parameters.\n\n        Args:\n            params (dict): A dictionary containing the physical parameters for the model.\n                'Lp', 'Rp', 'Lv', 'Rv', 'M': Inductances (H) and resistances (Ohm).\n                'I0': Initial plasma current (A).\n                'times': List of times (s) to evaluate V_loop.\n\n        Returns:\n            list: A list containing [V_loop(t1), V_loop(t2), V_loop(t3), t_half].\n        \"\"\"\n        Lp, Rp, Lv, Rv, M = params['Lp'], params['Rp'], params['Lv'], params['Rv'], params['M']\n        I0, eval_times = params['I0'], params['times']\n\n        # Verify positive-definiteness of the inductance matrix\n        if not M**2  Lp * Lv:\n            raise ValueError(\"Inductance matrix is not positive definite: M^2 >= Lp * Lv\")\n\n        # Construct matrices L, R, and A\n        L_matrix = np.array([[Lp, M], [M, Lv]])\n        R_matrix = np.array([[Rp, 0], [0, Rv]])\n        \n        try:\n            L_inv = np.linalg.inv(L_matrix)\n        except np.linalg.LinAlgError:\n            raise ValueError(\"Inductance matrix L is singular.\")\n            \n        A_matrix = L_inv @ R_matrix\n        I0_vec = np.array([I0, 0.0])\n\n        def get_Ip(t):\n            \"\"\"Computes plasma current Ip at time t.\"\"\"\n            if t == 0:\n                return I0\n            I_vec_t = expm(-A_matrix * t) @ I0_vec\n            return I_vec_t[0]\n\n        # Calculate loop voltage at specified evaluation times\n        v_loop_results = [Rp * get_Ip(t) for t in eval_times]\n\n        # Bisection search for half-voltage time t_1/2\n        # We need to find t such that Ip(t) - I0/2 = 0\n        f_bisection = lambda t: get_Ip(t) - I0 / 2.0\n\n        low = 0.0\n        high = 0.1  # Initial guess for the upper bound of the search interval\n        \n        # Ensure the upper bound is high enough for f(high) to be negative\n        while f_bisection(high) > 0:\n            high *= 2.0\n            if high > 100.0:  # Safety break to prevent infinite loops for very slow decays\n                raise RuntimeError(\"Bisection search for t_1/2 failed to find an upper bound.\")\n\n        tolerance = 1e-9\n        max_iterations = 100\n        for _ in range(max_iterations):\n            mid = (low + high) / 2.0\n            if high - low  tolerance:\n                break\n            \n            f_mid = f_bisection(mid)\n            if f_mid == 0:\n                break\n            elif f_bisection(low) * f_mid  0:\n                high = mid\n            else:\n                low = mid\n        \n        t_half = (low + high) / 2.0\n\n        return v_loop_results + [t_half]\n\n    # Test suite parameters\n    I0_val = 5.0e6\n    eval_times_val = [0.0, 0.02, 0.05]\n    \n    test_cases_params = [\n        # Case 1: Baseline coupling\n        {'Lp': 1.2e-6, 'Rp': 1.2e-5, 'Lv': 8.0e-6, 'Rv': 2.0e-4, 'M': 2.5e-6, 'I0': I0_val, 'times': eval_times_val},\n        # Case 2: No coupling\n        {'Lp': 1.2e-6, 'Rp': 1.2e-5, 'Lv': 8.0e-6, 'Rv': 2.0e-4, 'M': 0.0, 'I0': I0_val, 'times': eval_times_val},\n        # Case 3: Highly conducting vessel\n        {'Lp': 1.2e-6, 'Rp': 1.2e-5, 'Lv': 8.0e-6, 'Rv': 2.0e-6, 'M': 2.5e-6, 'I0': I0_val, 'times': eval_times_val},\n        # Case 4: Strong mutual coupling\n        {'Lp': 1.2e-6, 'Rp': 1.2e-5, 'Lv': 8.0e-6, 'Rv': 2.0e-4, 'M': 2.95e-6, 'I0': I0_val, 'times': eval_times_val},\n    ]\n\n    all_results = []\n    for params in test_cases_params:\n        result = calculate_quench_dynamics(params)\n        all_results.append(result)\n\n    # Print the final result in the specified list-of-lists format\n    print(str(all_results).replace(\"'\", \"\"))\n\nsolve()\n```"
        }
    ]
}