{
    "hands_on_practices": [
        {
            "introduction": "在任何活化与衰变热的分析中，首要任务是确定放射性核素的生成速率。这个练习将引导你从第一性原理出发，推导并计算初始活化率密度。通过这个实践，你将掌握如何运用中子通量、微观截面和原子核密度等基本物理量，来量化中子辐照下材料中发生的核反应，这是后续更复杂动力学建模的基础。",
            "id": "3946321",
            "problem": "聚变反应堆包层中的一种均匀、各向同性的结构材料，初始时不含活化产物，并暴露于稳态快中子场中。中子通量定义为单位时间内穿过单位面积的中子数，其测量值为 $\\phi = 1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$。一个主要单活化通道的目标核素具有均匀的原子数密度，为 $N = 8.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$。该主要活化反应的有效微观截面，在快中子能谱上平均后为 $\\sigma = 0.5\\,\\mathrm{b}$，其中 $\\mathrm{b}$ 表示单位靶恩。\n\n请使用适用于材料活化和衰变热建模的第一性原理——特别是粒子通量和微观截面的定义，以及它们与单位路径长度上反应概率的关系——推导该主要反应的单位体积活化产物初始生成率（初始活化速率密度）的表达式。然后，使用所提供的数据计算其数值。\n\n请将最终的单位体积活化速率以 $\\mathrm{reactions\\,cm^{-3}\\,s^{-1}}$ 为单位表示，并将答案四舍五入至三位有效数字。",
            "solution": "问题要求推导并计算在稳态中子场作用下，材料中单位体积活化产物的初始生成率。这个量等同于指定活化通道的初始反应速率密度。推导将基于所提供物理量的基本定义。\n\n关键的物理量如下：\n1.  **中子通量 ($\\phi$)**: 定义为单位时间内，垂直于中子运动方向通过单位面积的中子数。其单位通常为 $\\mathrm{n\\,cm^{-2}\\,s^{-1}}$。给定值为 $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$。注意，表示中子的‘n’是一个描述符，在量纲分析中不是一个正式单位。\n\n2.  **目标原子数密度 ($N$)**: 这是材料单位体积内的目标原子核数量。其单位为 $\\mathrm{cm^{-3}}$。给定值为 $N = 8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}$。\n\n3.  **微观截面 ($\\sigma$)**: 这个量代表单个原子核对于某一特定类型的反应，向入射中子所呈现的有效靶面积。它的单位是面积单位，通常用靶恩（$\\mathrm{b}$）表示，其中 $1\\,\\mathrm{b} = 10^{-24}\\,\\mathrm{cm^2}$。它本质上是衡量反应发生概率的一个指标。给定值为 $\\sigma = 0.5\\,\\mathrm{b}$。\n\n为了推导反应速率密度，我们考虑一个薄的、均匀的材料切片，其表面积为 $A$，无限薄的厚度为 $dx$。该切片的体积为 $dV = A \\cdot dx$。\n\n此体积切片内的目标原子核总数由原子数密度和体积的乘积给出：\n$$ \\text{Number of target nuclei} = N \\cdot dV = N A \\, dx $$\n\n每个原子核为活化反应提供一个有效面积 $\\sigma$。假设该薄片足够薄，以至于原子核之间不会相互“遮蔽”，那么该切片中所有原子核为反应提供的总有效面积为：\n$$ \\text{Total effective area} = (N A \\, dx) \\cdot \\sigma $$\n\n中子通量 $\\phi$ 表示单位时间内撞击单位面积的中子数。因此，单位时间内撞击我们切片面积 $A$ 的中子总数为 $\\phi A$。\n\n体积切片 $dV$ 内的反应速率是单位时间内总入射中子数与被原子核有效靶面积“覆盖”的面积分数之乘积。这个面积分数为总有效面积与总面积 $A$ 的比值：\n$$ \\text{Fractional area} = \\frac{(N A \\, dx) \\sigma}{A} = N \\sigma \\, dx $$\n这个量，$N \\sigma \\, dx$，是中子穿过厚度 $dx$ 时发生反应的概率。\n\n因此，体积 $dV$ 内的反应速率（反应次数/秒）为：\n$$ \\text{Reaction rate in } dV = (\\text{neutrons per second on } A) \\times (\\text{reaction probability per neutron}) $$\n$$ \\text{Reaction rate in } dV = (\\phi A) \\times (N \\sigma \\, dx) $$\n\n反应速率密度，我们用 $R$ 表示，定义为单位体积的反应速率。为求得此值，我们将无限小体积内的反应速率除以体积 $dV$：\n$$ R = \\frac{\\text{Reaction rate in } dV}{dV} = \\frac{\\phi A N \\sigma \\, dx}{A \\, dx} = \\phi N \\sigma $$\n\n这个表达式 $R = \\phi N \\sigma$ 给出了单位时间单位体积内的活化反应速率。乘积 $\\Sigma = N\\sigma$ 通常被称为宏观截面，表示中子在单位路径长度上发生反应的概率。因此，$R = \\phi \\Sigma$。\n\n问题指明材料初始时不含活化产物。在一般情况下，如果活化产物（其数密度为 $N_p$，衰变常数为 $\\lambda_p$）也在衰变，则产物浓度的净变化率由适用于此简单链的 Bateman 方程给出：\n$$ \\frac{dN_p(t)}{dt} = (\\text{Formation Rate}) - (\\text{Decay Rate}) = \\phi N \\sigma - \\lambda_p N_p(t) $$\n初始生成率，即在时间 $t=0$ 时的生成率，可以通过使用初始条件 $N_p(0) = 0$ 对该表达式求值得到。\n$$ \\left. \\frac{dN_p}{dt} \\right|_{t=0} = \\phi N \\sigma - \\lambda_p N_p(0) = \\phi N \\sigma - 0 = \\phi N \\sigma $$\n因此，初始活化速率密度恰好就是反应速率密度 $R = \\phi N \\sigma$。\n\n现在，我们使用所提供的数据计算其数值：\n已知：\n- 中子通量，$\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$\n- 目标原子数密度，$N = 8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}$\n- 微观截面，$\\sigma = 0.5\\,\\mathrm{b}$\n\n首先，我们必须将截面单位从靶恩转换为 $\\mathrm{cm}^2$：\n$$ \\sigma = 0.5\\,\\mathrm{b} \\times \\frac{10^{-24}\\,\\mathrm{cm^2}}{1\\,\\mathrm{b}} = 0.5 \\times 10^{-24}\\,\\mathrm{cm^2} $$\n\n现在，将这些值代入推导出的反应速率密度 $R$ 的公式中：\n$$ R = \\phi N \\sigma $$\n$$ R = (1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}) \\times (0.5 \\times 10^{-24}\\,\\mathrm{cm^2}) $$\n\n我们先计算数值部分：\n$$ 1.0 \\times 8.0 \\times 0.5 = 4.0 $$\n接下来，我们计算 $10$ 的幂：\n$$ 10^{14} \\times 10^{22} \\times 10^{-24} = 10^{14+22-24} = 10^{12} $$\n\n合并这些结果：\n$$ R = 4.0 \\times 10^{12} $$\n\n现在，我们来验证单位：\n$$ (\\mathrm{cm^{-2}\\,s^{-1}}) \\times (\\mathrm{cm^{-3}}) \\times (\\mathrm{cm^2}) = \\mathrm{cm}^{-2-3+2}\\,\\mathrm{s^{-1}} = \\mathrm{cm^{-3}\\,s^{-1}} $$\n得到的单位是 $\\mathrm{cm^{-3}\\,s^{-1}}$，这对应于所要求的单位体积每单位时间的反应次数。\n\n问题要求答案保留三位有效数字。计算值为 $4.0 \\times 10^{12}$。为了用三位有效数字表示，我们写作 $4.00 \\times 10^{12}$。\n\n因此，初始活化速率密度为 $4.00 \\times 10^{12}\\,\\mathrm{reactions\\,cm^{-3}\\,s^{-1}}$。",
            "answer": "$$\\boxed{4.00 \\times 10^{12}}$$"
        },
        {
            "introduction": "真实世界的聚变反应堆运行包含辐照和停堆冷却等多个阶段。本练习将一个完整的辐照-冷却循环集成为一个综合问题，要求你计算停堆瞬间及冷却一段时间后的衰变热功率。这个实践不仅巩固了活化产物随时间累积和衰减的动力学知识，还让你直接面对聚变堆安全与维护中一个核心的工程参数。",
            "id": "3946336",
            "problem": "将一个质量为 $m=1.00\\,\\mathrm{kg}$ 的单一同位素钨样品放置在聚变相关的中子环境中，该环境具有恒定的中子通量 $\\phi=1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$，辐照时间为 $t_{\\mathrm{irr}}=1.0\\times 10^{5}\\,\\mathrm{s}$。$(n,2n)$ 反应的有效微观截面为 $\\sigma=0.20\\,\\mathrm{b}$，其中 $1\\,\\mathrm{b}=10^{-24}\\,\\mathrm{cm^{2}}$。该反应产生单一的主要活化产物，其通过单一通道衰变，衰变常数为 $\\lambda=1.0\\times 10^{-6}\\,\\mathrm{s^{-1}}$。每次衰变在材料中局部沉积的平均能量为 $E_{\\mathrm{dep}}=2.0\\,\\mathrm{MeV}$。假设如下：\n- 辐照期间，中子通量在样品上空间和时间上是均匀的。\n- 靶钨原子数保持有效恒定（在所考虑的时间尺度上，燃耗和嬗变损耗可忽略不计）。\n- 有效截面 $\\sigma$ 和衰变参数是与时间无关的。\n- 所有衰变能量 $E_{\\mathrm{dep}}$ 都在局部沉积（无逃逸）。\n- 只有单一的活化产物对衰变热有贡献。\n\n使用阿伏伽德罗常数 $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$，钨的摩尔质量 $M_{\\mathrm{W}}=183.84\\,\\mathrm{g\\,mol^{-1}}$，以及能量转换关系 $1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$。\n\n从活化与衰变动力学的第一性原理出发，计算停堆时（辐照结束后 $t=0^{+}$）的瞬时衰变热功率，以及冷却时间 $t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$ 后的衰变热功率。两个答案均以 $\\mathrm{W}$ 为单位表示，并四舍五入至三位有效数字。按所述顺序以数对形式提供这两个答案。",
            "solution": "问题要求计算钨样品在两个不同时间的衰变热功率：辐照停止后立即和经过指定冷却期后。我们必须首先验证问题陈述的有效性。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 材料：单一同位素钨\n- 质量：$m=1.00\\,\\mathrm{kg}$\n- 中子通量：$\\phi=1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$\n- 辐照时间：$t_{\\mathrm{irr}}=1.0\\times 10^{5}\\,\\mathrm{s}$\n- 反应：$(n,2n)$\n- 微观截面：$\\sigma=0.20\\,\\mathrm{b}$\n- 靶（b）的定义：$1\\,\\mathrm{b}=10^{-24}\\,\\mathrm{cm^{2}}$\n- 衰变常数：$\\lambda=1.0\\times 10^{-6}\\,\\mathrm{s^{-1}}$\n- 每次衰变沉积的平均能量：$E_{\\mathrm{dep}}=2.0\\,\\mathrm{MeV}$\n- 阿伏伽德罗常数：$N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$\n- 钨的摩尔质量：$M_{\\mathrm{W}}=183.84\\,\\mathrm{g\\,mol^{-1}}$\n- 能量转换：$1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$\n- 假设：通量均匀，燃耗可忽略，参数与时间无关，能量局部沉积，单一主要活化产物。\n- 待计算量：停堆时 ($t=0^{+}$) 和冷却时间 $t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$ 后的衰变热功率。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了与聚变工程相关的标准核活化和衰变过程。所提供的参数，如中子通量、截面和衰变常数，在此背景下是物理上合理的。这是一个适定问题，提供了所有必要的数据和明确的简化假设（例如，可忽略的燃耗、单一同位素靶），使其具有唯一解。语言客观而精确。该问题不违反任何基本原理，不基于错误的前提，并且完全属于指定的科学领域。它是完整的、一致的且可解的。\n\n**第3步：结论与行动**\n问题有效。我们开始求解。\n\n### 求解推导\n\n任意时刻 $t$ 的衰变热功率 $P(t)$ 是样品活度 $A(t)$ 与每次衰变沉积能量 $E_{\\mathrm{dep}}$ 的乘积。活度定义为 $A(t) = \\lambda N(t)$，其中 $N(t)$ 是时刻 $t$ 的放射性核数量，$\\lambda$ 是衰变常数。\n$$\nP(t) = A(t)E_{\\mathrm{dep}} = \\lambda N(t) E_{\\mathrm{dep}}\n$$\n为了求得衰变热，我们必须首先确定活化核的数量 $N(t)$。\n\n**1. 辐照期间的活化**\n在从 $t=0$ 到 $t=t_{\\mathrm{irr}}$ 的辐照期间，活化核的数量 $N(t)$ 因产生和衰变而变化。其变化率由以下一阶线性常微分方程给出：\n$$\n\\frac{dN(t)}{dt} = R_{\\mathrm{prod}} - \\lambda N(t)\n$$\n其中 $R_{\\mathrm{prod}}$ 是活化物种的恒定产生率，$\\lambda N(t)$ 是衰变率。产生率是靶钨原子总数 $N_T$、$(n,2n)$ 反应的微观截面 $\\sigma$ 和中子通量 $\\phi$ 的乘积。\n$$\nR_{\\mathrm{prod}} = N_T\\sigma\\phi\n$$\n靶原子数 $N_T$ 由样品质量 $m$、摩尔质量 $M_W$ 和阿伏伽德罗常数 $N_A$ 计算得出。\n$$\nN_T = \\frac{m}{M_W}N_A\n$$\n活化过程的微分方程为：\n$$\n\\frac{dN(t)}{dt} + \\lambda N(t) = N_T\\sigma\\phi\n$$\n在初始条件 $N(0)=0$（辐照前没有活化核）下，该方程的解为：\n$$\nN(t) = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t)\\right)\n$$\n在辐照期末，即 $t=t_{\\mathrm{irr}}$ 时，活化核的数量（我们记为 $N_{\\mathrm{shut}}$）为：\n$$\nN_{\\mathrm{shut}} = N(t_{\\mathrm{irr}}) = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\n$$\n\n**2. 冷却期间的衰变**\n在 $t=t_{\\mathrm{irr}}$ 时辐照停止后，产生项 $R_{\\mathrm{prod}}$ 变为零。设 $t'$ 为冷却时间，其中 $t'=0$ 对应于停堆时刻。冷却期间活化核的数量 $N(t')$遵循纯放射性衰变规律：\n$$\n\\frac{dN(t')}{dt'} = -\\lambda N(t')\n$$\n此阶段的初始条件为 $N(t'=0) = N_{\\mathrm{shut}}$。解为：\n$$\nN(t') = N_{\\mathrm{shut}}\\exp(-\\lambda t') = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\\exp(-\\lambda t')\n$$\n\n**3. 衰变热功率计算**\n在冷却时间 $t' = t_{\\mathrm{cool}}$ 时的衰变热功率由下式给出：\n$$\nP(t_{\\mathrm{cool}}) = \\lambda N(t_{\\mathrm{cool}}) E_{\\mathrm{dep}} = N_T\\sigma\\phi E_{\\mathrm{dep}} \\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\\exp(-\\lambda t_{\\mathrm{cool}})\n$$\n\n**4. 数值计算**\n首先，我们将所有给定值转换为一组一致的单位（在适用的情况下使用国际单位制 SI）。\n- $m = 1.00\\,\\mathrm{kg} = 1000\\,\\mathrm{g}$\n- $\\sigma = 0.20\\,\\mathrm{b} = 0.20 \\times 10^{-24}\\,\\mathrm{cm^2} = 2.0 \\times 10^{-25}\\,\\mathrm{cm^2}$\n- $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$\n- $E_{\\mathrm{dep}} = 2.0\\,\\mathrm{MeV} = 2.0 \\times 10^6\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-13}\\,\\mathrm{J}$\n\n靶钨原子的数量为：\n$$\nN_T = \\frac{1000\\,\\mathrm{g}}{183.84\\,\\mathrm{g\\,mol^{-1}}} \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}) \\approx 3.2758 \\times 10^{24}\\,\\text{atoms}\n$$\n饱和时（$t_{\\mathrm{irr}} \\to \\infty$）的总衰变热产生率是系数 $P_{\\mathrm{sat}} = N_T\\sigma\\phi E_{\\mathrm{dep}}$：\n$$\nP_{\\mathrm{sat}} = (3.2758 \\times 10^{24}) \\times (2.0 \\times 10^{-25}\\,\\mathrm{cm^{2}}) \\times (1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (3.20435... \\times 10^{-13}\\,\\mathrm{J}) \\approx 20.993\\,\\mathrm{W}\n$$\n指数部分的参数为：\n- $\\lambda t_{\\mathrm{irr}} = (1.0 \\times 10^{-6}\\,\\mathrm{s^{-1}}) \\times (1.0 \\times 10^{5}\\,\\mathrm{s}) = 0.1$\n- $\\lambda t_{\\mathrm{cool}} = (1.0 \\times 10^{-6}\\,\\mathrm{s^{-1}}) \\times (1.0 \\times 10^{6}\\,\\mathrm{s}) = 1.0$\n\n**停堆时的功率 ($t_{\\mathrm{cool}}=0$)**\n停堆时的衰变热功率 $P_{\\mathrm{shut}}$，通过设置 $t_{\\mathrm{cool}}=0$（因此 $\\exp(-\\lambda t_{\\mathrm{cool}})=1$）得到。\n$$\nP_{\\mathrm{shut}} = P_{\\mathrm{sat}} \\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right) = 20.993\\,\\mathrm{W} \\times \\left(1 - \\exp(-0.1)\\right)\n$$\n$$\nP_{\\mathrm{shut}} \\approx 20.993 \\times (1 - 0.904837) = 20.993 \\times 0.095163 \\approx 1.9978\\,\\mathrm{W}\n$$\n四舍五入至三位有效数字， $P_{\\mathrm{shut}} = 2.00\\,\\mathrm{W}$。\n\n**冷却后的功率 ($t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$)**\n经过冷却时间后的衰变热功率 $P_{\\mathrm{cool}}$ 为：\n$$\nP_{\\mathrm{cool}} = P_{\\mathrm{shut}} \\exp(-\\lambda t_{\\mathrm{cool}}) = 1.9978\\,\\mathrm{W} \\times \\exp(-1.0)\n$$\n$$\nP_{\\mathrm{cool}} \\approx 1.9978 \\times 0.367879 \\approx 0.7350\\,\\mathrm{W}\n$$\n四舍五入至三位有效数字， $P_{\\mathrm{cool}} = 0.735\\,\\mathrm{W}$。\n两个所求值分别是停堆时和经过指定冷却时间后的衰变热。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.00 & 0.735 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然解析解为我们提供了深刻的物理洞见，但处理包含数百种核素和复杂辐照历史的实际问题时，必须依赖数值求解器。本练习旨在弥合理论与计算实践之间的鸿沟，指导你构建一个验证测试，用以评估一个数值积分方案的准确性。通过将数值解与精确的Bateman解析解进行比较，你将学会验证与确认（V&V）的基本技术，这是任何严谨的计算建模工作的基石。",
            "id": "3946331",
            "problem": "考虑暴露于中子辐照及随后冷却的材料中核素存量的时间演化。其控制方程为源自第一性原理的线性常微分方程（ODE）：放射性衰变和恒定速率活化。令 $N_i(t)$ 表示在时间 $t$ 时核素 $i$ 的原子数量，令 $\\lambda_i$ 为其衰变常数，定义为 $\\lambda_i = \\ln(2)/T_{1/2,i}$，其中 $T_{1/2,i}$ 是以秒为单位表示的半衰期。核素 $i$ 的放射性活度 $A_i(t)$ 为 $A_i(t) = \\lambda_i N_i(t)$。以瓦特为单位的衰变热功率 $P(t)$ 计算公式为 $P(t) = \\sum_i \\lambda_i N_i(t) Q_i^{\\mathrm{J}}$，其中 $Q_i^{\\mathrm{J}}$ 是以焦耳为单位表示的每次衰变释放的平均能量，由指定的平均衰变能 $Q_i^{\\mathrm{MeV}}$（兆电子伏特）通过 $Q_i^{\\mathrm{J}} = Q_i^{\\mathrm{MeV}} \\times 10^{6} \\times 1.602176634 \\times 10^{-19}$ 得到。假设辐照期间中子通量和截面恒定，因此进入母核素的活化源项是恒定的。\n\n模型构建的基本依据是：\n- 单个核素的放射性衰变：$dN/dt = -\\lambda N$。\n- 从核素 $A$ 到核素 $B$ 的放射性衰变链：$dN_A/dt = -\\lambda_A N_A$, $dN_B/dt = \\lambda_A N_A - \\lambda_B N_B$。\n- 辐照期间供给核素 $A$ 的恒定速率活化源 $S_A$：$dN_A/dt = S_A - \\lambda_A N_A$，其中 $S_A = \\sigma \\phi N_T$，$\\sigma$ 是微观截面，$\\phi$ 是中子通量，$N_T$ 是靶原子数量。冷却阶段设置 $S_A = 0$。\n\n使用这些基本原理，为一个选定的一阶隐式时间积分格式构建一个验证测试。目标是针对三个情景，与已知的 Bateman 精确解进行对比，以评估收敛性。通过将后向欧拉法应用于具有常数矩阵 $\\mathbf{A}$ 和分段常数向量 $\\mathbf{s}$ 的线性系统 $d\\mathbf{N}/dt = \\mathbf{A}\\mathbf{N} + \\mathbf{s}$ 来定义数值格式。从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的后向欧拉更新为 $(\\mathbf{I} - \\Delta t \\,\\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n + \\Delta t \\,\\mathbf{s}$，其中 $\\mathbf{I}$ 是单位矩阵。使用能够精确划分每个情景区间的均匀时间步长 $\\Delta t$。\n\n对于下述每个情景，在指定的最终时间计算：(i) 每个建模核素的存量和 (ii) 总衰变热功率。对于每个量，通过比较在三个递减的时间步长 $\\Delta t_1 > \\Delta t_2 > \\Delta t_3$ 下，数值结果与 Bateman 精确解之间的相对误差，来估算观测到的精度阶。将量 $X$ 在时间步长 $\\Delta t$ 下的相对误差定义为 $e(\\Delta t) = |X_{\\mathrm{num}} - X_{\\mathrm{exact}}| / \\max(|X_{\\mathrm{exact}}|, \\epsilon)$，其中 $\\epsilon = 10^{-30}$，并通过对两个局部阶数 $p_{12} = \\ln\\left(e(\\Delta t_1)/e(\\Delta t_2)\\right)/\\ln\\left(\\Delta t_1/\\Delta t_2\\right)$ 和 $p_{23} = \\ln\\left(e(\\Delta t_2)/e(\\Delta t_3)\\right)/\\ln\\left(\\Delta t_2/\\Delta t_3\\right)$ 求平均来估算阶数 $p$。\n\n情景和参数（除非另有说明，所有数值均采用国际单位制（SI））：\n\n- 情景1（纯衰变，单个核素）：\n  - 初始条件：$N_0 = 10^{20}$ 原子。\n  - 半衰期：$T_{1/2} = 1$ 秒，所以 $\\lambda = \\ln(2)/1$。\n  - 平均衰变能：$Q^{\\mathrm{MeV}} = 0.5$。\n  - 最终时间：$t_{\\mathrm{f}} = 10$ 秒。\n  - 时间步长：$\\Delta t_1 = 1.0$ 秒, $\\Delta t_2 = 0.5$ 秒, $\\Delta t_3 = 0.25$ 秒。\n\n- 情景2（无源双核素衰变链）：\n  - 初始条件：$N_A(0) = 10^{19}$ 原子, $N_B(0) = 0$ 原子。\n  - 半衰期：$T_{1/2,A} = 5$ 秒, $T_{1/2,B} = 20$ 秒，所以 $\\lambda_A = \\ln(2)/5$, $\\lambda_B = \\ln(2)/20$。\n  - 平均衰变能：$Q_A^{\\mathrm{MeV}} = 0.3$, $Q_B^{\\mathrm{MeV}} = 0.8$。\n  - 最终时间：$t_{\\mathrm{f}} = 50$ 秒。\n  - 时间步长：$\\Delta t_1 = 2.0$ 秒, $\\Delta t_2 = 1.0$ 秒, $\\Delta t_3 = 0.5$ 秒。\n\n- 情景3（辐照与冷却，活化源供给母核素 $A$，双核素链 $A \\rightarrow B \\rightarrow$ 稳定核素）：\n  - 初始条件：$N_A(0) = 0$ 原子, $N_B(0) = 0$ 原子。\n  - 活化源：$S_A = \\sigma \\phi N_T$，其中 $\\sigma = 10^{-24}$ 平方厘米（1靶恩），$\\phi = 10^{14}$ 中子/平方厘米·秒，$N_T = 10^{22}$ 原子，所以辐照期间 $S_A = 10^{12}$ 原子/秒，冷却期间 $S_A = 0$。\n  - 半衰期：$T_{1/2,A} = 50$ 秒, $T_{1/2,B} = 200$ 秒，所以 $\\lambda_A = \\ln(2)/50$, $\\lambda_B = \\ln(2)/200$。\n  - 平均衰变能：$Q_A^{\\mathrm{MeV}} = 0.4$, $Q_B^{\\mathrm{MeV}} = 1.2$。\n  - 辐照时间：$t_{\\mathrm{irr}} = 100$ 秒，然后冷却至最终时间 $t_{\\mathrm{f}} = 300$ 秒。\n  - 时间步长：$\\Delta t_1 = 5.0$ 秒, $\\Delta t_2 = 2.5$ 秒, $\\Delta t_3 = 1.25$ 秒。\n\n程序要求：\n- 实现用于具有指定分段常数 $\\mathbf{s}$ 的线性系统 $d\\mathbf{N}/dt = \\mathbf{A}\\mathbf{N} + \\mathbf{s}$ 的后向欧拉格式。\n- 对于每个情景，计算所需时间点的精确解（Bateman 解），以供比较。\n- 计算以下每个量的观测精度阶 $p$：\n  - 情景1：最终存量 $N(t_{\\mathrm{f}})$ 和最终衰变热功率 $P(t_{\\mathrm{f}})$。\n  - 情景2：最终存量 $N_A(t_{\\mathrm{f}})$, $N_B(t_{\\mathrm{f}})$ 和最终总衰变热功率 $P(t_{\\mathrm{f}})$。\n  - 情景3：最终存量 $N_A(t_{\\mathrm{f}})$, $N_B(t_{\\mathrm{f}})$ 和最终总衰变热功率 $P(t_{\\mathrm{f}})$。\n- 您的程序应生成单行输出，其中包含结果，形式为方括号括起来的逗号分隔列表，并严格按照以下顺序：$[p_{1,N}, p_{1,P}, p_{2,N_A}, p_{2,N_B}, p_{2,P}, p_{3,N_A}, p_{3,N_B}, p_{3,P}]$。所有条目必须是 Python 浮点数值。\n- 衰变热功率根据构造以瓦特为单位计算，但只需打印无量纲的观测阶数 $p$。\n\n不允许任何外部输入。问题必须完全在程序内部解决。确保参数的科学真实性和自洽性。用于获得精确解和数值格式的数学推导必须遵循上述基本依据，而不能依赖于问题陈述中直接提供的快捷公式。",
            "solution": "该问题要求验证用于求解控制核素活化和衰变的常微分方程（ODE）的一阶隐式时间积分格式，即后向欧拉法。验证是通过将数值结果与三个不同情景的已知精确解析解进行比较来执行的。此验证的主要指标是观测到的精度阶，对于一阶方法，该值预期接近于 $1$。\n\n一组核素的原子数量的时间演化由向量 $\\mathbf{N}(t)$ 表示，并由一个具有常系数的线性一阶常微分方程组描述：\n$$\n\\frac{d\\mathbf{N}(t)}{dt} = \\mathbf{A}\\mathbf{N}(t) + \\mathbf{s}\n$$\n此处，$\\mathbf{N}(t)$ 是核素存量向量 $[N_1(t), N_2(t), \\dots]^T$。矩阵 $\\mathbf{A}$ 包含衰变常数（$\\lambda_i$）和分支比，代表嬗变和衰变率。向量 $\\mathbf{s}$ 代表恒定的外部源，例如来自中子诱发活化反应的源。\n\n后向欧拉法在时间上将此 ODE 系统离散化。给定时间步长 $\\Delta t$，时间 $t_{n+1} = t_n + \\Delta t$ 的状态通过在新的时间点 $t_{n+1}$ 计算导数，从时间 $t_n$ 的状态近似得出：\n$$\n\\frac{\\mathbf{N}_{n+1} - \\mathbf{N}_n}{\\Delta t} = \\mathbf{A}\\mathbf{N}_{n+1} + \\mathbf{s}\n$$\n重排此方程得到更新法则，这需要求解一个关于 $\\mathbf{N}_{n+1}$ 的线性系统：\n$$\n(\\mathbf{I} - \\Delta t \\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n + \\Delta t \\mathbf{s}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。在每个时间步求解此系统以推进解。\n\n以瓦特为单位的总衰变热功率 $P(t)$ 是根据核素存量 $N_i(t)$ 及其各自的放射性活度 $A_i(t) = \\lambda_i N_i(t)$ 计算的：\n$$\nP(t) = \\sum_i A_i(t) Q_i^{\\mathrm{J}} = \\sum_i \\lambda_i N_i(t) Q_i^{\\mathrm{J}}\n$$\n其中 $Q_i^{\\mathrm{J}}$ 是以焦耳为单位的每次衰变的平均能量，使用转换因子 $1 \\text{ MeV} = 10^6 \\times 1.602176634 \\times 10^{-19} \\text{ J}$ 从给定的兆电子伏特（$Q_i^{\\mathrm{MeV}}$）能量转换而来。衰变常数 $\\lambda_i$ 与半衰期 $T_{1/2,i}$ 的关系为 $\\lambda_i = \\ln(2) / T_{1/2,i}$。\n\n为评估准确性，我们使用相对误差 $e(\\Delta t)$ 来比较数值解（$X_{\\mathrm{num}}$）与精确解（$X_{\\mathrm{exact}}$）：\n$$\ne(\\Delta t) = \\frac{|X_{\\mathrm{num}} - X_{\\mathrm{exact}}|}{\\max(|X_{\\mathrm{exact}}|, \\epsilon)}\n$$\n其中 $\\epsilon = 10^{-30}$ 是一个小的下限值，以防止除以零。观测精度阶 $p$ 是从三个时间步长 $\\Delta t_1 > \\Delta t_2 > \\Delta t_3$（步长每次减半，即 $\\Delta t_1 = 2\\Delta t_2 = 4\\Delta t_3$）的结果中估算出来的。它是两个局部阶估计的平均值：\n$$\np = \\frac{1}{2} \\left( p_{12} + p_{23} \\right) \\quad \\text{其中} \\quad p_{12} = \\frac{\\ln(e(\\Delta t_1)/e(\\Delta t_2))}{\\ln(\\Delta t_1/\\Delta t_2)}, \\quad p_{23} = \\frac{\\ln(e(\\Delta t_2)/e(\\Delta t_3))}{\\ln(\\Delta t_2/\\Delta t_3)}\n$$\n\n下面我们详细说明每个情景的具体公式。\n\n### 情景1：单个核素的纯衰变\n该情景模拟了无源情况下单个核素的衰变。\n- **控制方程**：$dN/dt = -\\lambda N$，初始条件为 $N(0) = N_0 = 10^{20}$ 原子。\n- **系统矩阵**：$\\mathbf{N} = [N]$, $\\mathbf{A} = [-\\lambda]$, $\\mathbf{s} = [0]$。\n- **精确解**：解是一个指数衰变：\n$$\nN(t) = N_0 e^{-\\lambda t}\n$$\n- **数值实现**：后向欧拉更新为 $N_{n+1} = N_n / (1 + \\lambda \\Delta t)$。\n- **参数**：$\\lambda = \\ln(2)/1.0 \\text{ s}^{-1}$, $t_f = 10$ s。\n\n### 情景2：双核素衰变链\n该情景模拟了无外部源的衰变链 $A \\rightarrow B \\rightarrow \\text{稳定核素}$。\n- **控制方程**：\n$$\n\\frac{dN_A}{dt} = -\\lambda_A N_A\n$$\n$$\n\\frac{dN_B}{dt} = \\lambda_A N_A - \\lambda_B N_B\n$$\n- **系统矩阵**：$\\mathbf{N} = [N_A, N_B]^T$, $\\mathbf{s} = [0, 0]^T$ 以及 $\\mathbf{A} = \\begin{pmatrix} -\\lambda_A & 0 \\\\ \\lambda_A & -\\lambda_B \\end{pmatrix}$。\n- **精确解 (Bateman 方程)**：对于初始条件 $N_A(0)$ 和 $N_B(0)=0$，且假设 $\\lambda_A \\neq \\lambda_B$：\n$$\nN_A(t) = N_A(0) e^{-\\lambda_A t}\n$$\n$$\nN_B(t) = \\frac{\\lambda_A N_A(0)}{\\lambda_B - \\lambda_A} (e^{-\\lambda_A t} - e^{-\\lambda_B t})\n$$\n- **数值实现**：求解系统 $(\\mathbf{I} - \\Delta t \\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n$。由于该矩阵是下三角矩阵，可以通过向前代入法高效求解。\n- **参数**：$N_A(0) = 10^{19}$, $N_B(0)=0$, $\\lambda_A = \\ln(2)/5 \\text{ s}^{-1}$, $\\lambda_B = \\ln(2)/20 \\text{ s}^{-1}$, $t_f = 50$ s。\n\n### 情景3：辐照与冷却\n该情景涉及活化产生核素 $A$，然后衰变为 $B$ ($A \\rightarrow B \\rightarrow \\text{稳定核素}$），过程分为两个阶段：一个有恒定源的辐照期，之后是一个无源的冷却期。\n- **控制方程（辐照，$0 \\le t \\le t_{irr}$）**：\n$$\n\\frac{dN_A}{dt} = S_A - \\lambda_A N_A\n$$\n$$\n\\frac{dN_B}{dt} = \\lambda_A N_A - \\lambda_B N_B\n$$\n此处，$\\mathbf{s} = [S_A, 0]^T$，其中 $S_A = 10^{12} \\text{ atoms/s}$。对于冷却阶段（$t > t_{irr}$），$S_A=0$，方程与情景2相同。\n- **精确解**：\n  1.  **辐照阶段（$0 \\le t \\le t_{irr}$）**：对于初始条件 $N_A(0)=0, N_B(0)=0$ 且 $\\lambda_A \\neq \\lambda_B$：\n      $$\n      N_A(t) = \\frac{S_A}{\\lambda_A}(1 - e^{-\\lambda_A t})\n      $$\n      $$\n      N_B(t) = S_A \\left( \\frac{1-e^{-\\lambda_B t}}{\\lambda_B} - \\frac{e^{-\\lambda_A t}-e^{-\\lambda_B t}}{\\lambda_B - \\lambda_A} \\right)\n      $$\n      我们首先计算辐照结束时的存量 $N_A(t_{irr})$ 和 $N_B(t_{irr})$。\n  2.  **冷却阶段（$t' = t - t_{irr}$，对于 $0 < t' \\le t_f - t_{irr}$）**：这些存量作为冷却阶段的初始条件，该阶段是一个纯衰变问题。\n      $$\n      N_A(t) = N_A(t_{irr}) e^{-\\lambda_A (t - t_{irr})}\n      $$\n      $$\n      N_B(t) = \\frac{\\lambda_A N_A(t_{irr})}{\\lambda_B - \\lambda_A} (e^{-\\lambda_A (t-t_{irr})} - e^{-\\lambda_B (t-t_{irr})}) + N_B(t_{irr}) e^{-\\lambda_B (t-t_{irr})}\n      $$\n- **数值实现**：模拟分两个阶段运行。首先，求解器在源项为 $\\mathbf{s} = [S_A, 0]^T$ 的情况下迭代 $t_{irr}/\\Delta t$ 步。然后，使用得到的存量作为初始状态，在源项设置为零（$\\mathbf{s} = [0, 0]^T$）的情况下，再继续迭代 $(t_f - t_{irr})/\\Delta t$ 步。\n- **参数**：$N_A(0)=0, N_B(0)=0$, $S_A=10^{12} \\text{ atoms/s}$, $\\lambda_A=\\ln(2)/50 \\text{ s}^{-1}$, $\\lambda_B=\\ln(2)/200 \\text{ s}^{-1}$, $t_{irr}=100$ s, $t_f=300$ s。\n\n代码实现了这些解析解和通用的后向欧拉求解器。对于每个情景，它使用两种方法针对三个不同的时间步长，计算最终时间的核素存量和衰变热。然后它计算相对误差，并最终估算每个所需量的精度阶。正如后向欧拉法所预期的，观测到的阶数应约等于 $1.0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Global constants\nLOG2 = np.log(2)\nEV_TO_J = 1.602176634e-19\nMEV_TO_J = EV_TO_J * 1e6\nEPSILON = 1e-30 # For relative error calculation\n\ndef run_numerical_solver(N0, A_matrix, s_vector, t_final, dt):\n    \"\"\"\n    Solves dN/dt = A*N + s using the Backward Euler method.\n    \"\"\"\n    if dt == 0 or t_final == 0:\n        return np.copy(N0)\n    num_steps = round(t_final / dt)\n    N = np.copy(N0)\n    I = np.identity(len(N0))\n    \n    M = I - dt * A_matrix\n    \n    for _ in range(num_steps):\n        b = N + dt * s_vector\n        N = np.linalg.solve(M, b)\n        \n    return N\n\ndef get_rel_error(num_val, exact_val):\n    \"\"\"Calculates relative error.\"\"\"\n    return np.abs(num_val - exact_val) / np.max([np.abs(exact_val), EPSILON])\n\ndef calculate_order(errors, dts):\n    \"\"\"Calculates the observed order of accuracy.\"\"\"\n    dt_ratio12 = dts[0] / dts[1]\n    dt_ratio23 = dts[1] / dts[2]\n    \n    # Handle cases where error is near zero, which may give unstable p\n    if errors[0]  EPSILON or errors[1]  EPSILON:\n        p12 = 0.0 # Cannot determine order, assume it's not converging as expected\n    else:\n        p12 = np.log(errors[0] / errors[1]) / np.log(dt_ratio12)\n    \n    if errors[1]  EPSILON or errors[2]  EPSILON:\n        p23 = 0.0\n    else:\n        p23 = np.log(errors[1] / errors[2]) / np.log(dt_ratio23)\n\n    return (p12 + p23) / 2.0\n\ndef scenario_1():\n    \"\"\"Handler for Scenario 1: Pure Decay.\"\"\"\n    N0_val = 1e20\n    T_half = 1.0\n    Q_MeV = 0.5\n    t_f = 10.0\n    dts = [1.0, 0.5, 0.25]\n    \n    lam = LOG2 / T_half\n    Q_J = Q_MeV * MEV_TO_J\n    \n    # Analytical solution\n    N_exact = N0_val * np.exp(-lam * t_f)\n    P_exact = lam * N_exact * Q_J\n    \n    errors_N = []\n    errors_P = []\n    \n    # System definition\n    N0 = np.array([N0_val])\n    A = np.array([[-lam]])\n    s = np.array([0.0])\n    \n    for dt in dts:\n        N_final_num = run_numerical_solver(N0, A, s, t_f, dt)\n        N_num = N_final_num[0]\n        P_num = lam * N_num * Q_J\n        \n        errors_N.append(get_rel_error(N_num, N_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_N = calculate_order(errors_N, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_N, p_P]\n\ndef scenario_2():\n    \"\"\"Handler for Scenario 2: Two-Nuclide Decay Chain.\"\"\"\n    NA0_val = 1e19\n    NB0_val = 0.0\n    T_half_A = 5.0\n    T_half_B = 20.0\n    Q_A_MeV = 0.3\n    Q_B_MeV = 0.8\n    t_f = 50.0\n    dts = [2.0, 1.0, 0.5]\n    \n    lam_A = LOG2 / T_half_A\n    lam_B = LOG2 / T_half_B\n    Q_A_J = Q_A_MeV * MEV_TO_J\n    Q_B_J = Q_B_MeV * MEV_TO_J\n    \n    # Analytical solution\n    NA_exact = NA0_val * np.exp(-lam_A * t_f)\n    if np.abs(lam_A - lam_B)  EPSILON:\n        NB_exact = lam_A * NA0_val * t_f * np.exp(-lam_A * t_f)\n    else:\n        term1 = lam_A / (lam_B - lam_A) * NA0_val\n        term2 = np.exp(-lam_A * t_f) - np.exp(-lam_B * t_f)\n        NB_exact = term1 * term2\n    P_exact = lam_A * NA_exact * Q_A_J + lam_B * NB_exact * Q_B_J\n    \n    errors_NA = []\n    errors_NB = []\n    errors_P = []\n\n    # System definition\n    N0 = np.array([NA0_val, NB0_val])\n    A = np.array([[-lam_A, 0.0], [lam_A, -lam_B]])\n    s = np.array([0.0, 0.0])\n    \n    for dt in dts:\n        N_final_num = run_numerical_solver(N0, A, s, t_f, dt)\n        NA_num, NB_num = N_final_num\n        P_num = lam_A * NA_num * Q_A_J + lam_B * NB_num * Q_B_J\n        \n        errors_NA.append(get_rel_error(NA_num, NA_exact))\n        errors_NB.append(get_rel_error(NB_num, NB_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_NA = calculate_order(errors_NA, dts)\n    p_NB = calculate_order(errors_NB, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_NA, p_NB, p_P]\n\ndef scenario_3():\n    \"\"\"Handler for Scenario 3: Irradiation and Cooling.\"\"\"\n    S_A = 1e12\n    T_half_A, T_half_B = 50.0, 200.0\n    Q_A_MeV, Q_B_MeV = 0.4, 1.2\n    t_irr, t_f = 100.0, 300.0\n    dts = [5.0, 2.5, 1.25]\n    \n    t_cool = t_f - t_irr\n    lam_A = LOG2 / T_half_A\n    lam_B = LOG2 / T_half_B\n    Q_A_J = Q_A_MeV * MEV_TO_J\n    Q_B_J = Q_B_MeV * MEV_TO_J\n\n    # Analytical solution\n    # Phase 1: Irradiation\n    NA_irr = (S_A / lam_A) * (1 - np.exp(-lam_A * t_irr))\n    if np.abs(lam_A - lam_B)  EPSILON:\n        # Not applicable here, but for completeness\n        NB_irr = S_A * (1 - (1 + lam_A * t_irr)*np.exp(-lam_A * t_irr)) / lam_A\n    else:    \n        term1_NB = S_A * (1 - np.exp(-lam_B * t_irr)) / lam_B\n        term2_NB = S_A * (np.exp(-lam_A * t_irr) - np.exp(-lam_B * t_irr)) / (lam_B - lam_A)\n        NB_irr = term1_NB - term2_NB\n\n    # Phase 2: Cooling\n    NA_exact = NA_irr * np.exp(-lam_A * t_cool)\n    if np.abs(lam_A - lam_B)  EPSILON:\n        # Not applicable here\n        NB_exact = (NB_irr + lam_A * NA_irr * t_cool) * np.exp(-lam_A * t_cool)\n    else:\n        term1 = lam_A / (lam_B - lam_A) * NA_irr\n        term2 = np.exp(-lam_A * t_cool) - np.exp(-lam_B * t_cool)\n        NB_exact = term1 * term2 + NB_irr * np.exp(-lam_B * t_cool)\n    \n    P_exact = lam_A * NA_exact * Q_A_J + lam_B * NB_exact * Q_B_J\n\n    errors_NA, errors_NB, errors_P = [], [], []\n\n    # System definition (A matrix is constant)\n    N0 = np.array([0.0, 0.0])\n    A = np.array([[-lam_A, 0.0], [lam_A, -lam_B]])\n    s_irr = np.array([S_A, 0.0])\n    s_cool = np.array([0.0, 0.0])\n\n    for dt in dts:\n        # Numerical solution\n        N_at_irr_end = run_numerical_solver(N0, A, s_irr, t_irr, dt)\n        N_final_num = run_numerical_solver(N_at_irr_end, A, s_cool, t_cool, dt)\n        NA_num, NB_num = N_final_num\n        P_num = lam_A * NA_num * Q_A_J + lam_B * NB_num * Q_B_J\n\n        errors_NA.append(get_rel_error(NA_num, NA_exact))\n        errors_NB.append(get_rel_error(NB_num, NB_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_NA = calculate_order(errors_NA, dts)\n    p_NB = calculate_order(errors_NB, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_NA, p_NB, p_P]\n\ndef solve():\n    \"\"\"\n    Main function to run all scenarios and print the results.\n    \"\"\"\n    results_s1 = scenario_1()\n    results_s2 = scenario_2()\n    results_s3 = scenario_3()\n    \n    all_results = results_s1 + results_s2 + results_s3\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}