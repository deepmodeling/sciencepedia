{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的涡流模型之前，首要任务是理解其核心近似的适用范围。本实践旨在量化磁准静态（MQS）近似——即忽略位移电流——所引入的误差。通过直接比较传导电流和位移电流的贡献，你将学会判断在何种频率和材料参数下MQS模型是有效的，这是所有涡流建模工作的基石。",
            "id": "3969899",
            "problem": "在一个磁约束聚变装置中，靠近不锈钢真空室的环向场线圈由一个角频率为 $\\omega$ 的短时、近单色脉冲驱动。在涡流计算建模中，通常会采用磁准静态 (MQS) 近似，该近似忽略了位移电流。为了评估这种近似在高频下的有效性，考虑在均匀、各向同性、非磁性 ($\\mu \\approx \\mu_0$) 的真空室壁内的一个小控制体，其中感应电场可局部视为均匀且时谐的。该材料的电导率为 $\\sigma$，介电常数为 $\\epsilon$，电场由相量 $\\tilde{\\mathbf{E}}$ 表示，其对应的实数场为 $\\mathbf{E}(\\mathbf{r},t) = \\Re\\{\\tilde{\\mathbf{E}}(\\mathbf{r}) \\exp(i \\omega t)\\}$。\n\n仅从安培-麦克斯韦定律 $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\partial \\mathbf{D} / \\partial t$、线性本构关系 $\\mathbf{J} = \\sigma \\mathbf{E}$ 和 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 以及时谐场的相量表示法出发，推导在忽略位移电流 $\\partial \\mathbf{D} / \\partial t$（即使用 MQS 近似）时，源项 $\\nabla \\times \\mathbf{H}$ 中产生的相对幅值误差 $\\delta$ 的表达式。然后，使用以下代表 $316\\mathrm{L}$ 不锈钢真空室在高频线圈瞬态作用下的参数，计算 $\\delta$ 的值：\n- $\\epsilon = 8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}$,\n- $\\sigma = 1.40 \\times 10^{6}\\,\\mathrm{S/m}$,\n- $\\omega = 2\\pi \\times 50 \\times 10^{6}\\,\\mathrm{rad/s}$。\n\n将最终误差表示为无量纲小数，并将答案四舍五入到四位有效数字。",
            "solution": "本题要求推导当应用磁准静态 (MQS) 近似时，安培-麦克斯韦定律源项中的相对幅值误差 $\\delta$。这种近似涉及忽略位移电流。分析将在频域中进行，使用时谐场的相量表示法。\n\n时域中的安培-麦克斯韦定律由下式给出：\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n其中 $\\mathbf{H}$ 是磁场强度，$\\mathbf{J}$ 是传导电流密度，$\\mathbf{D}$ 是电位移场。\n\n对于角频率为 $\\omega$ 的时谐场，任何场量 $\\mathbf{F}(\\mathbf{r}, t)$ 都可以用其复数相量 $\\tilde{\\mathbf{F}}(\\mathbf{r})$ 表示，使得 $\\mathbf{F}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{F}}(\\mathbf{r}) \\exp(i \\omega t)\\}$。在相量域中，时间导数算子 $\\partial/\\partial t$ 对应于乘以 $i\\omega$。将此变换应用于安培-麦克斯韦定律，得到其相量形式：\n$$\n\\nabla \\times \\tilde{\\mathbf{H}} = \\tilde{\\mathbf{J}} + i\\omega\\tilde{\\mathbf{D}}\n$$\n\n题目给出了均匀、各向同性材料的线性本构关系：\n$$\n\\mathbf{J} = \\sigma \\mathbf{E}\n$$\n$$\n\\mathbf{D} = \\epsilon \\mathbf{E}\n$$\n其中 $\\sigma$ 是电导率，$\\epsilon$ 是介电常数。在相量域中，这些关系为：\n$$\n\\tilde{\\mathbf{J}} = \\sigma \\tilde{\\mathbf{E}}\n$$\n$$\n\\tilde{\\mathbf{D}} = \\epsilon \\tilde{\\mathbf{E}}\n$$\n\n将相量本构关系代入安培-麦克斯韦定律的相量形式，得到：\n$$\n\\nabla \\times \\tilde{\\mathbf{H}} = \\sigma \\tilde{\\mathbf{E}} + i\\omega(\\epsilon \\tilde{\\mathbf{E}})\n$$\n提出电场相量 $\\tilde{\\mathbf{E}}$ 因子，得到：\n$$\n\\nabla \\times \\tilde{\\mathbf{H}} = (\\sigma + i\\omega\\epsilon) \\tilde{\\mathbf{E}}\n$$\n右侧的项是总电流密度的相量 $\\tilde{\\mathbf{J}}_{\\text{total}}$。它是传导电流密度相量 $\\tilde{\\mathbf{J}}_{c} = \\sigma \\tilde{\\mathbf{E}}$ 和位移电流密度相量 $\\tilde{\\mathbf{J}}_{d} = i\\omega\\epsilon \\tilde{\\mathbf{E}}$ 的和。\n\nMQS 近似在于忽略位移电流 $\\partial \\mathbf{D} / \\partial t$，这等同于忽略其相量 $\\tilde{\\mathbf{J}}_{d}$。\n令 $\\tilde{\\mathbf{S}}_{\\text{true}}$ 为真实源项相量，$\\tilde{\\mathbf{S}}_{\\text{MQS}}$ 为近似源项相量。\n$$\n\\tilde{\\mathbf{S}}_{\\text{true}} = \\nabla \\times \\tilde{\\mathbf{H}} = (\\sigma + i\\omega\\epsilon) \\tilde{\\mathbf{E}}\n$$\n$$\n\\tilde{\\mathbf{S}}_{\\text{MQS}} = \\sigma \\tilde{\\mathbf{E}}\n$$\n此近似所产生的误差是真实源项和近似源项之间的差值，这恰好就是被忽略的位移电流密度相量：\n$$\n\\tilde{\\mathbf{S}}_{\\text{err}} = \\tilde{\\mathbf{S}}_{\\text{true}} - \\tilde{\\mathbf{S}}_{\\text{MQS}} = i\\omega\\epsilon \\tilde{\\mathbf{E}}\n$$\n相对幅值误差 $\\delta$ 定义为误差相量的幅值与真实源项相量的幅值之比：\n$$\n\\delta = \\frac{|\\tilde{\\mathbf{S}}_{\\text{err}}|}{|\\tilde{\\mathbf{S}}_{\\text{true}}|}\n$$\n相量的幅值计算如下：\n$$\n|\\tilde{\\mathbf{S}}_{\\text{err}}| = |i\\omega\\epsilon \\tilde{\\mathbf{E}}| = |i||\\omega||\\epsilon||\\tilde{\\mathbf{E}}| = \\omega\\epsilon|\\tilde{\\mathbf{E}}|\n$$\n因为 $\\omega$ 和 $\\epsilon$ 是正实数常数。\n$$\n|\\tilde{\\mathbf{S}}_{\\text{true}}| = |(\\sigma + i\\omega\\epsilon)\\tilde{\\mathbf{E}}| = |\\sigma + i\\omega\\epsilon||\\tilde{\\mathbf{E}}|\n$$\n复数 $\\sigma + i\\omega\\epsilon$ 的幅值为 $\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}$。因此：\n$$\n|\\tilde{\\mathbf{S}}_{\\text{true}}| = \\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}|\\tilde{\\mathbf{E}}|\n$$\n将这些幅值代入 $\\delta$ 的表达式：\n$$\n\\delta = \\frac{\\omega\\epsilon|\\tilde{\\mathbf{E}}|}{\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}|\\tilde{\\mathbf{E}}|}\n$$\n项 $|\\tilde{\\mathbf{E}}|$ 被消去，得到相对幅值误差的最终表达式：\n$$\n\\delta = \\frac{\\omega\\epsilon}{\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}}\n$$\n现在，我们使用给定的参数计算 $\\delta$：\n- $\\epsilon = 8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}$\n- $\\sigma = 1.40 \\times 10^{6}\\,\\mathrm{S/m}$\n- $\\omega = 2\\pi \\times 50 \\times 10^{6}\\,\\mathrm{rad/s} = 10^8\\pi\\,\\mathrm{rad/s}$\n\n首先，我们计算乘积 $\\omega\\epsilon$：\n$$\n\\omega\\epsilon = (10^8\\pi\\,\\mathrm{rad/s}) \\times (8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}) \\approx 2.78159 \\times 10^{-3}\\,\\mathrm{S/m}\n$$\n接下来，我们比较 $\\sigma$ 和 $\\omega\\epsilon$ 的量级：\n$$\n\\sigma = 1.40 \\times 10^{6}\\,\\mathrm{S/m}\n$$\n$$\n\\omega\\epsilon \\approx 2.78159 \\times 10^{-3}\\,\\mathrm{S/m}\n$$\n很明显 $\\omega\\epsilon \\ll \\sigma$。这意味着在 $\\delta$ 表达式的分母中，$(\\omega\\epsilon)^2$ 项与 $\\sigma^2$ 相比可以忽略不计：\n$$\n(\\omega\\epsilon)^2 \\approx (2.78159 \\times 10^{-3})^2 \\approx 7.737 \\times 10^{-6}\\,(\\mathrm{S/m})^2\n$$\n$$\n\\sigma^2 = (1.40 \\times 10^{6})^2 = 1.96 \\times 10^{12}\\,(\\mathrm{S/m})^2\n$$\n因此，$\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2} \\approx \\sqrt{\\sigma^2} = \\sigma$。\n$\\delta$ 的表达式可以精确地近似为：\n$$\n\\delta \\approx \\frac{\\omega\\epsilon}{\\sigma}\n$$\n代入数值：\n$$\n\\delta \\approx \\frac{2.78159 \\times 10^{-3}\\,\\mathrm{S/m}}{1.40 \\times 10^{6}\\,\\mathrm{S/m}} \\approx 1.98685 \\times 10^{-9}\n$$\n题目要求将最终答案四舍五入到四位有效数字。\n$$\n\\delta \\approx 1.987 \\times 10^{-9}\n$$\n这个极小的 $\\delta$ 值证实了，对于给定的材料和频率，MQS 近似是高度有效的，因为被忽略的位移电流的幅值比传导电流的幅值小好几个数量级，因此也远小于总电流的幅值。",
            "answer": "$$\n\\boxed{1.987 \\times 10^{-9}}\n$$"
        },
        {
            "introduction": "在确立了MQS近似的适用性之后，下一步是解析求解一个基本问题，以建立对涡流物理的直观理解。本实践将引导你处理无限长导电圆柱体在轴向磁场中的经典案例，练习求解磁扩散方程和施加边界条件。更重要的是，它将通过计算电磁转矩，让你深刻体会对称性论证如何能够简化复杂的物理问题。",
            "id": "3969840",
            "problem": "一个半径为 $a$、电导率为 $\\sigma$、磁导率为 $\\mu$ 的无限长、实心、均匀的导电圆柱体置于真空（磁导率为 $\\mu_0$）中。圆柱体的轴与 $z$ 轴对齐。在周围的真空中施加一个空间均匀、随时间谐波变化的轴向磁通量密度 $\\mathbf{B}_{\\text{ext}}(t)=\\Re\\{B_0 \\exp(i \\omega t)\\}\\,\\hat{\\mathbf{z}}$，其中 $B_0$ 是一个复振幅常数，$\\omega>0$ 是角频率。假设金属内部处于磁准静态状态，因此 $\\sigma \\gg \\omega \\epsilon_0$，导体中的位移电流可以忽略不计。对所有场使用相量表示法，其时间依赖性为 $\\exp(i \\omega t)$。\n\n从基本的 Maxwell 方程、Ohm 定律以及金属内部的本构关系 $\\mathbf{B}=\\mu \\mathbf{H}$ 和真空中的本构关系 $\\mathbf{B}=\\mu_0 \\mathbf{H}$ 出发，完成以下任务：\n\n1. 在轴对称和 $z$ 不变的假设下，推导导体内部磁通量密度轴向分量 $B_z(r)$ 的控制偏微分方程，并证明该方程可简化为接受 Bessel 函数解的圆柱形式。清晰地陈述你所求解的微分方程以及在 $r=0$ 和 $r=a$ 处施加的边界条件，并用 Bessel 函数、材料参数和 $B_0$ 表示导体内部 $B_z(r)$ 的闭合形式解。\n\n2. 利用推导出的 $B_z(r)$，通过应用 Faraday 定律和 Ohm 定律，确定导体内部相应的角向电场 $E_{\\phi}(r)$ 和角向电流密度 $J_{\\phi}(r)$ 的相量形式。\n\n3. 使用 Lorentz 力密度 $\\mathbf{f}=\\mathbf{J}\\times \\mathbf{B}$，计算由感应电流产生的、绕圆柱轴的单位长度净电磁转矩。陈述你使用的任何对称性论据。以 $\\mathrm{N \\cdot m \\, m^{-1}}$ 为单位表示最终的单位长度转矩。你的最终答案必须是单个实数值或单个闭合形式的解析表达式。如果你发现不需要四舍五入，请给出精确值；否则，将你的答案四舍五入到四位有效数字。",
            "solution": "该问题分为三个部分：求解导体内部的磁场，求解电场和电流密度，以及计算净转矩。\n\n**第 1 部分：$B_z(r)$ 的控制方程和解**\n\n在磁准静态近似下，我们从法拉第定律 $\\nabla \\times \\mathbf{E} = -i\\omega\\mathbf{B}$ 和安培定律 $\\nabla \\times \\mathbf{H} = \\mathbf{J}$ 开始。结合本构关系 $\\mathbf{B} = \\mu\\mathbf{H}$ 和欧姆定律 $\\mathbf{J} = \\sigma\\mathbf{E}$，我们可以推导出磁场的控制方程。对安培定律取旋度，并代入其他关系式：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{H}) = \\nabla \\times \\mathbf{J} = \\sigma (\\nabla \\times \\mathbf{E}) = \\sigma (-i\\omega\\mathbf{B}) = -i\\omega\\mu\\sigma\\mathbf{H} $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{H}) = \\nabla(\\nabla \\cdot \\mathbf{H}) - \\nabla^2 \\mathbf{H}$，并注意到 $\\nabla \\cdot \\mathbf{B} = 0 \\implies \\nabla \\cdot \\mathbf{H} = 0$，我们得到矢量亥姆霍兹方程：\n$$ \\nabla^2 \\mathbf{H} + i\\omega\\mu\\sigma\\mathbf{H} = 0 $$\n由于施加的场是轴向的并且系统具有轴对称性，我们寻找形式为 $\\mathbf{H}(r) = H_z(r)\\hat{\\mathbf{z}}$ 的解。在圆柱坐标系中，上述方程简化为 $H_z(r)$ 的标量方程：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dH_z}{dr}\\right) + k^2 H_z = 0 $$\n其中波数 $k = \\sqrt{i\\omega\\mu\\sigma} = (1+i)\\sqrt{\\omega\\mu\\sigma/2}$。这是零阶贝塞尔方程。其通解为 $H_z(r) = C_1 J_0(kr) + C_2 Y_0(kr)$。\n\n边界条件如下：\n1.  在 $r=0$ 处，场必须是有限的。由于第二类贝塞尔函数 $Y_0(kr)$ 在 $r \\to 0$ 时发散，我们必须设 $C_2 = 0$。因此解的形式为 $H_z(r) = C_1 J_0(kr)$。\n2.  在 $r=a$ 处，磁场强度的切向分量 $H_z$ 必须连续。在圆柱体外部 ($r>a$)，即真空中，总场是均匀的施加场，因此 $\\mathbf{H}_{\\text{ext}} = (B_0/\\mu_0)\\hat{\\mathbf{z}}$。因此，$H_z(a) = B_0/\\mu_0$。\n将此条件应用于解，我们得到 $C_1 J_0(ka) = B_0/\\mu_0$，这给出了 $C_1 = \\frac{B_0}{\\mu_0 J_0(ka)}$。\n因此，导体内部的磁场强度为 $H_z(r) = \\frac{B_0}{\\mu_0} \\frac{J_0(kr)}{J_0(ka)}$。相应的磁通量密度为：\n$$ B_z(r) = \\mu H_z(r) = \\frac{\\mu B_0}{\\mu_0} \\frac{J_0(kr)}{J_0(ka)} $$\n\n**第 2 部分：$E_{\\phi}(r)$ 和 $J_{\\phi}(r)$**\n\n我们可以从安培定律 $\\mathbf{J} = \\nabla \\times \\mathbf{H}$ 找到感应电流密度。对于 $\\mathbf{H} = H_z(r)\\hat{\\mathbf{z}}$，其旋度为：\n$$ \\nabla \\times \\mathbf{H} = -\\frac{dH_z}{dr}\\hat{\\mathbf{\\phi}} $$\n因此，电流密度为 $\\mathbf{J}(r) = J_{\\phi}(r)\\hat{\\mathbf{\\phi}}$。使用 $H_z(r)$ 的解和贝塞尔函数的导数关系 $\\frac{d}{dx}J_0(x) = -J_1(x)$：\n$$ J_{\\phi}(r) = -\\frac{dH_z}{dr} = -C_1 \\frac{d}{dr}J_0(kr) = -C_1 \\cdot (-k J_1(kr)) = C_1 k J_1(kr) $$\n代入 $C_1$：\n$$ J_{\\phi}(r) = \\frac{k B_0}{\\mu_0 J_0(ka)} J_1(kr) $$\n相应的角向电场由欧姆定律 $J_{\\phi} = \\sigma E_{\\phi}$ 给出：\n$$ E_{\\phi}(r) = \\frac{J_{\\phi}(r)}{\\sigma} = \\frac{k B_0}{\\mu_0 \\sigma J_0(ka)} J_1(kr) $$\n\n**第 3 部分：净电磁转矩**\n\n洛伦兹力密度由 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$ 给出。在我们的问题中，电流密度只有角向分量 $\\mathbf{J} = J_{\\phi}(r)\\hat{\\mathbf{\\phi}}$，而磁通量密度只有轴向分量 $\\mathbf{B} = B_z(r)\\hat{\\mathbf{z}}$。力密度为：\n$$ \\mathbf{f}(r) = J_{\\phi}(r)\\hat{\\mathbf{\\phi}} \\times B_z(r)\\hat{\\mathbf{z}} = J_{\\phi}(r) B_z(r) (\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}}) $$\n使用单位矢量的叉积关系 $\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}} = \\hat{\\mathbf{r}}$，我们发现力密度完全是径向的：\n$$ \\mathbf{f}(r) = J_{\\phi}(r) B_z(r) \\hat{\\mathbf{r}} $$\n绕圆柱轴（$z$ 轴）的转矩密度为 $\\boldsymbol{\\tau} = \\mathbf{r} \\times \\mathbf{f}$。其中，位置矢量为 $\\mathbf{r} = r\\hat{\\mathbf{r}}$。\n$$ \\boldsymbol{\\tau}(r) = (r\\hat{\\mathbf{r}}) \\times (f_r(r) \\hat{\\mathbf{r}}) = \\mathbf{0} $$\n因为两个平行矢量（$\\mathbf{r}$ 和 $\\mathbf{f}$）的叉积为零。\n由于转矩密度在导体内部处处为零，其在整个圆柱体横截面上的积分——即单位长度的净转矩——也必然为零。\n\n**对称性论据**：该结果源于系统的轴对称性。物理系统（均匀圆柱体）和外部激励（均匀轴向磁场）都关于 $z$ 轴旋转对称。这意味着不存在任何可以产生绕 $z$ 轴转矩的优选角向。如果存在非零转矩，它将指向 $\\hat{\\mathbf{z}}$ 或 $-\\hat{\\mathbf{z}}$ 方向，这将破坏系统的旋转不变性。因此，基于对称性原理，净转矩必须为零。",
            "answer": "$$ \\boxed{0} $$"
        },
        {
            "introduction": "现实世界中的大多数涡流问题都缺乏解析解，因此数值方法是不可或缺的工具。本实践将一个复杂的几何结构简化为集总参数电路模型（一个常微分方程），并要求你实现和比较两种常见的时间积分格式：后向欧拉法和Crank-Nicolson格式。通过这个练习，你将亲手评估不同数值方法的精度，这是计算科学家必须具备的一项关键技能。",
            "id": "3969857",
            "problem": "在聚变装置中，一个薄的导电环形壁可以近似为一个自感为 $L$、电阻为 $R$ 的单匝回路。在类破裂瞬态过程中，等离子体电流可以建模为 $I_{p}(t) = I_{0}\\,\\exp(-t/\\tau_{p})$（对于 $t \\ge 0$），其中 $I_{0}$ 是初始等离子体电流，$\\tau_{p}$ 是等离子体电流衰减时间。壁回路通过互感 $M$ 与等离子体磁耦合，因此链接壁的外部磁通量为 $\\Phi_{\\text{ext}}(t) = M I_{p}(t)$。从基本的麦克斯韦-法拉第定律 $\\oint \\mathbf{E}\\cdot d\\mathbf{l} = -\\,d\\Phi/dt$、集总电阻的欧姆定律 $v_{R} = R i$ 以及电感关系 $v_{L} = L\\,di/dt$ 出发，壁电流 $i(t)$ 的回路方程为\n$$\nL\\,\\frac{di}{dt} + R\\,i(t) \\;=\\; -\\,\\frac{d\\Phi_{\\text{ext}}}{dt} \\;=\\; -\\,M\\,\\frac{dI_{p}}{dt}.\n$$\n对于指数形式的等离子体电流，定义 $\\alpha = R/L$ 和 $\\gamma = M I_{0}/(L \\tau_{p})$。那么，该初值问题可以写成\n$$\n\\frac{di}{dt} \\;=\\; -\\,\\alpha\\,i(t) \\;+\\; \\gamma\\,e^{-t/\\tau_{p}}, \\qquad i(0)=0.\n$$\n$i(t)$ 的精确解为\n$$\ni(t) \\;=\\; \\frac{M I_{0}}{L}\\,\\frac{1/\\tau_{p}}{\\alpha - 1/\\tau_{p}}\\left(e^{-t/\\tau_{p}} - e^{-\\alpha t}\\right),\n$$\n在 $\\alpha \\neq 1/\\tau_{p}$ 时有效。电流峰值大小出现的时间（对于 $t\\ge 0$）为\n$$\nt_{\\text{peak}} \\;=\\; \\frac{1}{\\alpha - 1/\\tau_{p}}\\,\\ln\\!\\big(\\alpha\\,\\tau_{p}\\big),\n$$\n相应的精确峰值壁电流大小为 $|i(t_{\\text{peak}})|$。\n\n您将使用两种时间积分方案，并采用相同的 时间步长 $\\Delta t$ 对同一个常微分方程进行数值积分：\n- 后向欧拉法 (BE)：由 $i^{n+1} = i^{n} + \\Delta t\\, f(t^{n+1}, i^{n+1})$ 定义的单步隐式格式，其中 $f(t,i) = -\\alpha i + \\gamma e^{-t/\\tau_{p}}$。\n- 克兰克-尼科尔森法 (CN)：由 $i^{n+1} = i^{n} + \\frac{\\Delta t}{2}\\left[f(t^{n}, i^{n}) + f(t^{n+1}, i^{n+1})\\right]$ 定义的梯形隐式格式。\n\n对于这两种方案，在 $t^{0}=0$ 时使用 $i^{0}=0$，以固定的 $\\Delta t$ 推进到 $T_{\\text{end}} = 10\\,\\max(\\tau_{p}, L/R)$，并计算离散峰值大小 $\\max_{n} |i^{n}|$。将一种方法的相对峰值电流误差定义为\n$$\n\\varepsilon \\;=\\; \\frac{\\left|\\max_{n}|i^{n}| - |i(t_{\\text{peak}})|\\right|}{|i(t_{\\text{peak}})|}.\n$$\n您的任务是针对下方的每个测试用例，量化误差之比\n$$\n\\rho \\;=\\; \\frac{\\varepsilon_{\\text{CN}}}{\\varepsilon_{\\text{BE}}},\n$$\n其中克兰克-尼科尔森法 (CN) 和后向欧拉法 (BE) 使用相同的 时间步长。所有物理参数必须采用国际单位制 (SI)：$L$ 单位为亨利，$R$ 单位为欧姆，$M$ 单位为亨利，$I_{0}$ 单位为安培，$\\tau_{p}$ 单位为秒，$\\Delta t$ 单位为秒。输出 $\\rho$ 是无量纲的。\n\n实现一个程序，针对每个测试用例，计算 $\\rho$ 值，并确保至少有 6 位正确的小数位数，然后将所有结果按测试用例的顺序，以逗号分隔的列表形式打印在单行中，并用方括号括起来。\n\n测试套件（每个元组为 $(L,\\;R,\\;M,\\;I_{0},\\;\\tau_{p},\\;\\Delta t)$）：\n- 案例 A（平衡的时间尺度，中等步长）：$(1.0\\times 10^{-3}, 2.0\\times 10^{-1}, 5.0\\times 10^{-6}, 1.0\\times 10^{6}, 1.0\\times 10^{-2}, 2.0\\times 10^{-3})$。\n- 案例 B（等离子体快速衰减，粗略步长）：$(1.0\\times 10^{-3}, 2.0\\times 10^{-1}, 5.0\\times 10^{-6}, 1.0\\times 10^{6}, 5.0\\times 10^{-4}, 5.0\\times 10^{-4})$。\n- 案例 C（慢壁，中等速度等离子体，中等步长）：$(2.0\\times 10^{-3}, 5.0\\times 10^{-2}, 1.0\\times 10^{-5}, 5.0\\times 10^{5}, 2.0\\times 10^{-2}, 5.0\\times 10^{-3})$。\n- 案例 D（快壁，中等快速等离子体，粗略步长）：$(5.0\\times 10^{-4}, 5.0\\times 10^{-1}, 2.0\\times 10^{-6}, 2.0\\times 10^{6}, 2.0\\times 10^{-3}, 1.0\\times 10^{-3})$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表，用方括号括起来，顺序为 [案例 A, 案例 B, 案例 C, 案例 D]，例如：\"[0.12345678,0.23456789,0.34567890,0.45678901]\"。",
            "solution": "问题陈述已经过仔细审查，并被确定为**有效**。它在科学上基于电磁学和电路理论的原理，提出了一个源自聚变工程中标准物理模型的适定初值问题。所有参数、方程和目标都得到了清晰且一致的定义，从而能够得到唯一且可验证的解。\n\n目标是对于给定的描述涡流动力学的常微分方程 (ODE)，计算克兰克-尼科尔森 (CN) 和后向欧拉 (BE) 数值方案之间的相对误差之比 $\\rho = \\varepsilon_{\\text{CN}}/\\varepsilon_{\\text{BE}}$。每种方案的相对误差 $\\varepsilon$ 是相对于精确解析解的峰值大小来定义的。\n\n控制性常微分方程为：\n$$\n\\frac{di}{dt} = f(t, i) = -\\alpha i(t) + \\gamma e^{-t/\\tau_p}, \\quad i(0) = 0\n$$\n其中 $\\alpha = R/L$ 且 $\\gamma = M I_0 / (L \\tau_p)$。\n\n首先，我们必须从 BE 和 CN 方案的隐式定义中推导出 $i^{n+1}$ 的显式单步更新公式。令 $t^n = n\\Delta t$。\n\n**后向欧拉 (BE) 方案**\nBE 方案定义为：\n$$\ni^{n+1} = i^n + \\Delta t f(t^{n+1}, i^{n+1})\n$$\n代入函数 $f(t,i)$：\n$$\ni^{n+1} = i^n + \\Delta t \\left( -\\alpha i^{n+1} + \\gamma e^{-t^{n+1}/\\tau_p} \\right)\n$$\n由于该常微分方程是线性的，我们可以通过代数方法求解 $i^{n+1}$：\n$$\ni^{n+1} + \\alpha \\Delta t i^{n+1} = i^n + \\gamma \\Delta t e^{-t^{n+1}/\\tau_p}\n$$\n$$\ni^{n+1}(1 + \\alpha \\Delta t) = i^n + \\gamma \\Delta t e^{-t^{n+1}/\\tau_p}\n$$\n这得到了 BE 方案的显式更新规则：\n$$\ni_{\\text{BE}}^{n+1} = \\frac{i^n + \\gamma \\Delta t \\exp(-t^{n+1}/\\tau_p)}{1 + \\alpha \\Delta t}\n$$\n\n**克兰克-尼科尔森 (CN) 方案**\nCN 方案定义为：\n$$\ni^{n+1} = i^n + \\frac{\\Delta t}{2} \\left[ f(t^n, i^n) + f(t^{n+1}, i^{n+1}) \\right]\n$$\n代入函数 $f(t,i)$：\n$$\ni^{n+1} = i^n + \\frac{\\Delta t}{2} \\left[ (-\\alpha i^n + \\gamma e^{-t^n/\\tau_p}) + (-\\alpha i^{n+1} + \\gamma e^{-t^{n+1}/\\tau_p}) \\right]\n$$\n同样，我们重新整理以求解 $i^{n+1}$：\n$$\ni^{n+1} = i^n - \\frac{\\alpha \\Delta t}{2} i^n - \\frac{\\alpha \\Delta t}{2} i^{n+1} + \\frac{\\gamma \\Delta t}{2} \\left( e^{-t^n/\\tau_p} + e^{-t^{n+1}/\\tau_p} \\right)\n$$\n$$\ni^{n+1} \\left( 1 + \\frac{\\alpha \\Delta t}{2} \\right) = i^n \\left( 1 - \\frac{\\alpha \\Delta t}{2} \\right) + \\frac{\\gamma \\Delta t}{2} \\left( e^{-t^n/\\tau_p} + e^{-t^{n+1}/\\tau_p} \\right)\n$$\n这得到了 CN 方案的显式更新规则：\n$$\ni_{\\text{CN}}^{n+1} = \\frac{i^n \\left( 1 - \\frac{\\alpha \\Delta t}{2} \\right) + \\frac{\\gamma \\Delta t}{2} \\left( \\exp(-t^n/\\tau_p) + \\exp(-t^{n+1}/\\tau_p) \\right)}{1 + \\frac{\\alpha \\Delta t}{2}}\n$$\n\n**计算算法**\n对于由元组 $(L, R, M, I_0, \\tau_p, \\Delta t)$ 指定的每个测试用例，步骤如下：\n\n1.  **参数计算**：计算派生的常数：\n    -   壁时间常数：$\\tau_w = L/R$。\n    -   归一化衰减率：$\\alpha = 1/\\tau_w = R/L$。\n    -   归一化驱动振幅：$\\gamma = M I_0 / (L \\tau_p)$。\n    -   模拟结束时间：$T_{\\text{end}} = 10 \\max(\\tau_p, \\tau_w)$。\n\n2.  **精确峰值电流**：计算精确峰值壁电流的大小 $|i(t_{\\text{peak}})|$。\n    -   峰值电流时间：$t_{\\text{peak}} = \\frac{1}{\\alpha - 1/\\tau_p} \\ln(\\alpha \\tau_p)$。\n    -   精确解为 $i(t) = \\frac{M I_0}{L} \\frac{1/\\tau_p}{\\alpha - 1/\\tau_p} (e^{-t/\\tau_p} - e^{-\\alpha t})$。\n    -   精确峰值电流大小为 $i_{\\text{peak, exact}} = |i(t_{\\text{peak}})|$。对于给定的参数，$i(t) \\ge 0$ 对于 $t \\ge 0$，因此绝对值是多余的。\n\n3.  **数值积分**：\n    -   确定时间步数，$N = \\lfloor T_{\\text{end}} / \\Delta t \\rfloor$。\n    -   创建时间网格 $t^n = n \\Delta t$，其中 $n = 0, 1, \\dots, N$。\n    -   初始化大小为 $N+1$ 的电流数组 $i_{\\text{BE}}$ 和 $i_{\\text{CN}}$，初始条件为 $i^0 = 0$。\n    -   从 $n = 0$ 到 $N-1$ 进行迭代，使用各自的更新公式填充数组 $i_{\\text{BE}}^{n+1}$ 和 $i_{\\text{CN}}^{n+1}$。\n\n4.  **误差与比率计算**：\n    -   找出每种方案的离散峰值电流大小：$i_{\\text{peak, BE}} = \\max_{n} |i_{\\text{BE}}^n|$ 和 $i_{\\text{peak, CN}} = \\max_{n} |i_{\\text{CN}}^n|$。\n    -   计算相对误差：\n    $$ \\varepsilon_{\\text{BE}} = \\frac{|i_{\\text{peak, BE}} - i_{\\text{peak, exact}}|}{|i_{\\text{peak, exact}}|} $$\n    $$ \\varepsilon_{\\text{CN}} = \\frac{|i_{\\text{peak, CN}} - i_{\\text{peak, exact}}|}{|i_{\\text{peak, exact}}|} $$\n    -   最后，计算所需比率：\n    $$ \\rho = \\frac{\\varepsilon_{\\text{CN}}}{\\varepsilon_{\\text{BE}}} $$\n\n此过程将对四个测试用例中的每一个实施。已知的理论收敛阶对于 BE 是一阶 $O(\\Delta t)$，对于 CN 是二阶 $O(\\Delta t^2)$。因此，误差比 $\\rho$ 预计将远小于 $1$，并且应大致与 $\\Delta t$ 成比例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_error_ratio(L, R, M, I0, tau_p, dt):\n    \"\"\"\n    Computes the ratio of relative peak-current errors between the\n    Crank-Nicolson and Backward Euler schemes for a single test case.\n\n    Args:\n        L (float): Self-inductance (H)\n        R (float): Resistance (Ohm)\n        M (float): Mutual inductance (H)\n        I0 (float): Initial plasma current (A)\n        tau_p (float): Plasma current decay time (s)\n        dt (float): Time step (s)\n\n    Returns:\n        float: The ratio of errors, rho = eps_CN / eps_BE.\n    \"\"\"\n\n    # 1. Parameter Calculation\n    alpha = R / L\n    tau_w = L / R\n    gamma = M * I0 / (L * tau_p)\n    T_end = 10.0 * max(tau_p, tau_w)\n\n    # 2. Exact Peak Current Calculation\n    if np.isclose(alpha * tau_p, 1.0):\n        # This case is excluded by the problem statement validation.\n        raise ValueError(\"The special case alpha * tau_p = 1 is not handled.\")\n\n    t_peak = (1.0 / (alpha - 1.0 / tau_p)) * np.log(alpha * tau_p)\n    \n    prefactor = (M * I0 / L) * (1.0 / tau_p) / (alpha - 1.0 / tau_p)\n    \n    i_peak_exact = prefactor * (np.exp(-t_peak / tau_p) - np.exp(-alpha * t_peak))\n\n    # 3. Numerical Integration\n    num_steps = int(np.ceil(T_end / dt))\n    t = np.linspace(0, num_steps * dt, num_steps + 1)\n    \n    i_be = np.zeros(num_steps + 1)\n    i_cn = np.zeros(num_steps + 1)\n    i_be[0] = 0.0\n    i_cn[0] = 0.0\n\n    # Pre-compute constants for the loop\n    # Backward Euler\n    be_denom = 1.0 + alpha * dt\n    be_num_term2_factor = gamma * dt\n    # Crank-Nicolson\n    cn_denom = 1.0 + alpha * dt / 2.0\n    cn_num_term1_factor = 1.0 - alpha * dt / 2.0\n    cn_num_term2_factor = gamma * dt / 2.0\n\n    # Time-stepping loop\n    for n in range(num_steps):\n        t_n = t[n]\n        t_n1 = t[n+1]\n        \n        # Forcing term evaluations\n        exp_n = np.exp(-t_n / tau_p)\n        exp_n1 = np.exp(-t_n1 / tau_p)\n\n        # Backward Euler update\n        i_be[n+1] = (i_be[n] + be_num_term2_factor * exp_n1) / be_denom\n\n        # Crank-Nicolson update\n        cn_num_term1 = i_cn[n] * cn_num_term1_factor\n        cn_num_term2 = cn_num_term2_factor * (exp_n + exp_n1)\n        i_cn[n+1] = (cn_num_term1 + cn_num_term2) / cn_denom\n        \n    # 4. Error and Ratio Calculation\n    i_peak_be = np.max(np.abs(i_be))\n    i_peak_cn = np.max(np.abs(i_cn))\n\n    eps_be = np.abs(i_peak_be - i_peak_exact) / np.abs(i_peak_exact)\n    eps_cn = np.abs(i_peak_cn - i_peak_exact) / np.abs(i_peak_exact)\n\n    if np.isclose(eps_be, 0.0):\n        if np.isclose(eps_cn, 0.0):\n            return 1.0\n        else:\n            return np.inf\n\n    rho = eps_cn / eps_be\n    return rho\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, R, M, I0, tau_p, dt)\n        (1.0e-3, 2.0e-1, 5.0e-6, 1.0e6, 1.0e-2, 2.0e-3), # Case A\n        (1.0e-3, 2.0e-1, 5.0e-6, 1.0e6, 5.0e-4, 5.0e-4), # Case B\n        (2.0e-3, 5.0e-2, 1.0e-5, 5.0e5, 2.0e-2, 5.0e-3), # Case C\n        (5.0e-4, 5.0e-1, 2.0e-6, 2.0e6, 2.0e-3, 1.0e-3), # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_error_ratio(*case)\n        results.append(f\"{result:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}