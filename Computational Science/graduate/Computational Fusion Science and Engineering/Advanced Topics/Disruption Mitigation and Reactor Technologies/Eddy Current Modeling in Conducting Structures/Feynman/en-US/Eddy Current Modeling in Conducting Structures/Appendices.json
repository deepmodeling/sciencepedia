{
    "hands_on_practices": [
        {
            "introduction": "The magnetoquasistatic (MQS) approximation is the foundation of most eddy current modeling, simplifying Maxwell's equations by neglecting displacement current. This practice provides a quantitative method to justify this crucial assumption by directly comparing the magnitude of the displacement current density, $i\\omega\\epsilon\\tilde{\\mathbf{E}}$, to the conduction current density, $\\sigma\\tilde{\\mathbf{E}}$. By working through this exercise , you will develop the essential skill of evaluating the domain of validity for the physical models you employ.",
            "id": "3969899",
            "problem": "A toroidal field coil near a stainless-steel vacuum vessel in a magnetic confinement fusion device is driven with a short-duration, nearly monochromatic burst at angular frequency $\\omega$. In computational eddy current modeling, it is common to invoke the magnetoquasistatic (MQS) approximation, which neglects displacement current. To assess the validity of this approximation at high frequency, consider a small control volume within the homogeneous, isotropic, nonmagnetic ($\\mu \\approx \\mu_0$) vessel wall where the induced electric field can be treated locally as uniform and time-harmonic. The material has electrical conductivity $\\sigma$ and permittivity $\\epsilon$, and the electric field is represented by a phasor $\\tilde{\\mathbf{E}}$ associated with the real field $\\mathbf{E}(\\mathbf{r},t) = \\Re\\{\\tilde{\\mathbf{E}}(\\mathbf{r}) \\exp(i \\omega t)\\}$.\n\nStarting only from the Ampère–Maxwell law $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\partial \\mathbf{D} / \\partial t$, the linear constitutive relations $\\mathbf{J} = \\sigma \\mathbf{E}$ and $\\mathbf{D} = \\epsilon \\mathbf{E}$, and the phasor representation for time-harmonic fields, derive an expression for the fractional magnitude error $\\delta$ in the source term $\\nabla \\times \\mathbf{H}$ that is incurred when the displacement current $\\partial \\mathbf{D} / \\partial t$ is neglected (i.e., when using the MQS approximation). Then, evaluate $\\delta$ for the following parameters representative of a $316\\mathrm{L}$ stainless-steel vacuum vessel subjected to a high-frequency coil transient:\n- $\\epsilon = 8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}$,\n- $\\sigma = 1.40 \\times 10^{6}\\,\\mathrm{S/m}$,\n- $\\omega = 2\\pi \\times 50 \\times 10^{6}\\,\\mathrm{rad/s}$.\n\nExpress the final error as a dimensionless decimal, and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the fractional magnitude error, $\\delta$, in the source term of the Ampère–Maxwell law when the magnetoquasistatic (MQS) approximation is applied. This approximation involves neglecting the displacement current. The analysis will be performed in the frequency domain using phasor representation for time-harmonic fields.\n\nThe Ampère–Maxwell law in the time domain is given by:\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\nwhere $\\mathbf{H}$ is the magnetic field intensity, $\\mathbf{J}$ is the conduction current density, and $\\mathbf{D}$ is the electric displacement field.\n\nFor a time-harmonic field with angular frequency $\\omega$, any field quantity $\\mathbf{F}(\\mathbf{r}, t)$ can be represented by its complex phasor $\\tilde{\\mathbf{F}}(\\mathbf{r})$ such that $\\mathbf{F}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{F}}(\\mathbf{r}) \\exp(i \\omega t)\\}$. In the phasor domain, the time derivative operator $\\partial/\\partial t$ corresponds to multiplication by $i\\omega$. Applying this transformation to the Ampère–Maxwell law yields its phasor form:\n$$\n\\nabla \\times \\tilde{\\mathbf{H}} = \\tilde{\\mathbf{J}} + i\\omega\\tilde{\\mathbf{D}}\n$$\n\nThe problem provides the linear constitutive relations for a homogeneous, isotropic material:\n$$\n\\mathbf{J} = \\sigma \\mathbf{E}\n$$\n$$\n\\mathbf{D} = \\epsilon \\mathbf{E}\n$$\nwhere $\\sigma$ is the electrical conductivity and $\\epsilon$ is the permittivity. In the phasor domain, these relations are:\n$$\n\\tilde{\\mathbf{J}} = \\sigma \\tilde{\\mathbf{E}}\n$$\n$$\n\\tilde{\\mathbf{D}} = \\epsilon \\tilde{\\mathbf{E}}\n$$\n\nSubstituting the phasor constitutive relations into the phasor form of the Ampère–Maxwell law gives:\n$$\n\\nabla \\times \\tilde{\\mathbf{H}} = \\sigma \\tilde{\\mathbf{E}} + i\\omega(\\epsilon \\tilde{\\mathbf{E}})\n$$\nFactoring out the electric field phasor $\\tilde{\\mathbf{E}}$ yields:\n$$\n\\nabla \\times \\tilde{\\mathbf{H}} = (\\sigma + i\\omega\\epsilon) \\tilde{\\mathbf{E}}\n$$\nThe term on the right-hand side is the phasor of the total current density, $\\tilde{\\mathbf{J}}_{\\text{total}}$. It is the sum of the conduction current density phasor, $\\tilde{\\mathbf{J}}_{c} = \\sigma \\tilde{\\mathbf{E}}$, and the displacement current density phasor, $\\tilde{\\mathbf{J}}_{d} = i\\omega\\epsilon \\tilde{\\mathbf{E}}$.\n\nThe MQS approximation consists of neglecting the displacement current, $\\partial \\mathbf{D} / \\partial t$, which is equivalent to neglecting its phasor, $\\tilde{\\mathbf{J}}_{d}$.\nLet $\\tilde{\\mathbf{S}}_{\\text{true}}$ be the true source term phasor and $\\tilde{\\mathbf{S}}_{\\text{MQS}}$ be the approximated source term phasor.\n$$\n\\tilde{\\mathbf{S}}_{\\text{true}} = \\nabla \\times \\tilde{\\mathbf{H}} = (\\sigma + i\\omega\\epsilon) \\tilde{\\mathbf{E}}\n$$\n$$\n\\tilde{\\mathbf{S}}_{\\text{MQS}} = \\sigma \\tilde{\\mathbf{E}}\n$$\nThe error incurred by this approximation is the difference between the true and approximated source terms, which is precisely the neglected displacement current density phasor:\n$$\n\\tilde{\\mathbf{S}}_{\\text{err}} = \\tilde{\\mathbf{S}}_{\\text{true}} - \\tilde{\\mathbf{S}}_{\\text{MQS}} = i\\omega\\epsilon \\tilde{\\mathbf{E}}\n$$\nThe fractional magnitude error, $\\delta$, is defined as the ratio of the magnitude of the error phasor to the magnitude of the true source term phasor:\n$$\n\\delta = \\frac{|\\tilde{\\mathbf{S}}_{\\text{err}}|}{|\\tilde{\\mathbf{S}}_{\\text{true}}|}\n$$\nThe magnitudes of the phasors are calculated as follows:\n$$\n|\\tilde{\\mathbf{S}}_{\\text{err}}| = |i\\omega\\epsilon \\tilde{\\mathbf{E}}| = |i||\\omega||\\epsilon||\\tilde{\\mathbf{E}}| = \\omega\\epsilon|\\tilde{\\mathbf{E}}|\n$$\nsince $\\omega$ and $\\epsilon$ are positive real constants.\n$$\n|\\tilde{\\mathbf{S}}_{\\text{true}}| = |(\\sigma + i\\omega\\epsilon)\\tilde{\\mathbf{E}}| = |\\sigma + i\\omega\\epsilon||\\tilde{\\mathbf{E}}|\n$$\nThe magnitude of the complex number $\\sigma + i\\omega\\epsilon$ is $\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}$. Therefore:\n$$\n|\\tilde{\\mathbf{S}}_{\\text{true}}| = \\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}|\\tilde{\\mathbf{E}}|\n$$\nSubstituting these magnitudes into the expression for $\\delta$:\n$$\n\\delta = \\frac{\\omega\\epsilon|\\tilde{\\mathbf{E}}|}{\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}|\\tilde{\\mathbf{E}}|}\n$$\nThe term $|\\tilde{\\mathbf{E}}|$ cancels, yielding the final expression for the fractional magnitude error:\n$$\n\\delta = \\frac{\\omega\\epsilon}{\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2}}\n$$\nNow, we evaluate $\\delta$ using the given parameters:\n- $\\epsilon = 8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}$\n- $\\sigma = 1.40 \\times 10^{6}\\,\\mathrm{S/m}$\n- $\\omega = 2\\pi \\times 50 \\times 10^{6}\\,\\mathrm{rad/s} = 10^8\\pi\\,\\mathrm{rad/s}$\n\nFirst, we compute the product $\\omega\\epsilon$:\n$$\n\\omega\\epsilon = (10^8\\pi\\,\\mathrm{rad/s}) \\times (8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}) \\approx 2.78159 \\times 10^{-3}\\,\\mathrm{S/m}\n$$\nNext, we compare the magnitudes of $\\sigma$ and $\\omega\\epsilon$:\n$$\n\\sigma = 1.40 \\times 10^{6}\\,\\mathrm{S/m}\n$$\n$$\n\\omega\\epsilon \\approx 2.78159 \\times 10^{-3}\\,\\mathrm{S/m}\n$$\nIt is clear that $\\omega\\epsilon \\ll \\sigma$. This implies that the term $(\\omega\\epsilon)^2$ in the denominator of the expression for $\\delta$ will be negligible compared to $\\sigma^2$:\n$$\n(\\omega\\epsilon)^2 \\approx (2.78159 \\times 10^{-3})^2 \\approx 7.737 \\times 10^{-6}\\,(\\mathrm{S/m})^2\n$$\n$$\n\\sigma^2 = (1.40 \\times 10^{6})^2 = 1.96 \\times 10^{12}\\,(\\mathrm{S/m})^2\n$$\nThus, $\\sqrt{\\sigma^2 + (\\omega\\epsilon)^2} \\approx \\sqrt{\\sigma^2} = \\sigma$.\nThe expression for $\\delta$ can be accurately approximated by:\n$$\n\\delta \\approx \\frac{\\omega\\epsilon}{\\sigma}\n$$\nSubstituting the values:\n$$\n\\delta \\approx \\frac{2.78159 \\times 10^{-3}\\,\\mathrm{S/m}}{1.40 \\times 10^{6}\\,\\mathrm{S/m}} \\approx 1.98685 \\times 10^{-9}\n$$\nThe problem requires rounding the final answer to four significant figures.\n$$\n\\delta \\approx 1.987 \\times 10^{-9}\n$$\nThis extremely small value for $\\delta$ confirms that the MQS approximation is highly valid for the given material and frequency, as the magnitude of the neglected displacement current is many orders of magnitude smaller than the magnitude of the conduction current, and consequently also much smaller than the magnitude of the total current.",
            "answer": "$$\n\\boxed{1.987 \\times 10^{-9}}\n$$"
        },
        {
            "introduction": "With the MQS framework established, a vital step is to solve the governing equations for a canonical geometry to build intuition about field and current behavior. This exercise  involves deriving the analytical solution for the magnetic field inside a conducting cylinder subjected to an external time-harmonic field, which requires solving a Bessel differential equation and applying the correct physical boundary conditions. The practice culminates in calculating the net torque, a task that reveals the profound constraints imposed by symmetry on electromagnetic forces and provides insight that transcends simple formula application.",
            "id": "3969840",
            "problem": "An infinitely long, solid, homogeneous conducting cylinder of radius $a$ with electrical conductivity $\\sigma$ and magnetic permeability $\\mu$ is embedded in vacuum (permeability $\\mu_0$). The cylinder axis is aligned with the $z$-axis. A spatially uniform, time-harmonic axial magnetic flux density is imposed in the surrounding vacuum, $\\mathbf{B}_{\\text{ext}}(t)=\\Re\\{B_0 \\exp(i \\omega t)\\}\\,\\hat{\\mathbf{z}}$, where $B_0$ is a constant complex amplitude and $\\omega>0$ is the angular frequency. Assume the magnetoquasistatic regime inside the metal, so that $\\sigma \\gg \\omega \\epsilon_0$ and displacement current can be neglected in the conductor. Use phasor notation with time dependence $\\exp(i \\omega t)$ for all fields.\n\nStarting from the fundamental Maxwell equations, Ohm’s law, and the constitutive relation $\\mathbf{B}=\\mu \\mathbf{H}$ inside the metal, and $\\mathbf{B}=\\mu_0 \\mathbf{H}$ in vacuum, do the following:\n\n1. Derive the governing partial differential equation for the axial component $B_z(r)$ of the magnetic flux density inside the conductor under the assumptions of axial symmetry and $z$-invariance, and show that the equation reduces to a cylindrical form that admits Bessel-function solutions. State clearly the differential equation you solve and the boundary conditions you impose at $r=0$ and $r=a$, and obtain the closed-form solution for $B_z(r)$ inside the conductor in terms of Bessel functions, the material parameters, and $B_0$.\n\n2. Using the derived $B_z(r)$, determine the corresponding azimuthal electric field $E_{\\phi}(r)$ and the azimuthal current density $J_{\\phi}(r)$ inside the conductor in phasor form by applying Faraday’s law and Ohm’s law.\n\n3. Using the Lorentz force density $\\mathbf{f}=\\mathbf{J}\\times \\mathbf{B}$, compute the net electromagnetic torque about the cylinder axis per unit length due to the induced currents. State any symmetry arguments you use. Express the final torque per unit length in $\\mathrm{N \\cdot m \\, m^{-1}}$. Your final answer must be a single real-valued number or a single closed-form analytic expression. If you find that no rounding is required, give the exact value; otherwise, round your answer to four significant figures.",
            "solution": "This problem involves determining the electromagnetic fields and torque on a conducting cylinder in an oscillating axial magnetic field.\n\n**Part 1: Derivation of the Governing PDE and Solution for $B_z(r)$**\n\nIn the magnetoquasistatic (MQS) regime within the conductor, Maxwell's equations in phasor form are:\n1.  Faraday's Law: $\\nabla \\times \\mathbf{E} = -i\\omega\\mathbf{B}$\n2.  Ampère's Law (MQS): $\\nabla \\times \\mathbf{H} = \\mathbf{J}$\n\nThe constitutive relations are $\\mathbf{B} = \\mu \\mathbf{H}$ and Ohm's law is $\\mathbf{J} = \\sigma \\mathbf{E}$. Combining these, Ampère's law becomes $\\nabla \\times \\mathbf{B} = \\mu \\sigma \\mathbf{E}$.\n\nTo obtain a single equation for $\\mathbf{B}$, we take the curl of the latter equation:\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\mu\\sigma(\\nabla \\times \\mathbf{E})\n$$\nUsing the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2\\mathbf{B}$ and Faraday's Law, along with $\\nabla \\cdot \\mathbf{B} = 0$, we get:\n$$\n-\\nabla^2\\mathbf{B} = \\mu\\sigma(-i\\omega\\mathbf{B}) \\implies \\nabla^2\\mathbf{B} = i\\omega\\mu\\sigma\\mathbf{B}\n$$\nDue to the axial symmetry and the external field being purely axial, the magnetic field inside the cylinder will also be purely axial and only a function of the radial coordinate, $\\mathbf{B}(r) = B_z(r)\\hat{\\mathbf{z}}$. The vector Laplacian simplifies to the scalar Laplacian on the axial component:\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{dB_z}{dr}\\right) = i\\omega\\mu\\sigma B_z(r)\n$$\nThis is the governing PDE. Let's define $k^2 = -i\\omega\\mu\\sigma$. The equation becomes:\n$$\nr^2 \\frac{d^2 B_z}{dr^2} + r \\frac{dB_z}{dr} + (kr)^2 B_z = 0\n$$\nThis is Bessel's differential equation of order zero. Its general solution is $B_z(r) = C_1 J_0(kr) + C_2 Y_0(kr)$.\n\nThe boundary conditions are:\n1.  **Finiteness at $r=0$**: The magnetic field must remain finite at the cylinder's axis. Since the Bessel function of the second kind, $Y_0(kr)$, diverges as $r \\to 0$, we must have $C_2=0$.\n2.  **Continuity at $r=a$**: The tangential component of the magnetic intensity, $H_z$, must be continuous across the boundary at $r=a$, as there are no surface currents. Outside the cylinder (in vacuum), the total field is the imposed uniform field, $\\mathbf{B}_{\\text{ext}} = B_0\\hat{\\mathbf{z}}$, so $\\mathbf{H}_{\\text{ext}} = (B_0/\\mu_0)\\hat{\\mathbf{z}}$. Thus, $H_z(a^-) = H_z(a^+)$ implies $B_z(a)/\\mu = B_0/\\mu_0$, or $B_z(a) = B_0 (\\mu/\\mu_0)$.\n\nApplying the boundary conditions:\nFrom $C_2=0$, the solution is $B_z(r) = C_1 J_0(kr)$.\nFrom the condition at $r=a$, $C_1 J_0(ka) = B_0 (\\mu/\\mu_0)$, which gives $C_1 = \\frac{B_0 (\\mu/\\mu_0)}{J_0(ka)}$.\n\nThe final solution for the magnetic flux density inside the conductor is:\n$$\nB_z(r) = B_0 \\frac{\\mu}{\\mu_0} \\frac{J_0(kr)}{J_0(ka)}, \\quad \\text{where } k = \\sqrt{-i\\omega\\mu\\sigma} = \\frac{1-i}{\\delta}, \\text{ with } \\delta=\\sqrt{\\frac{2}{\\omega\\mu\\sigma}}.\n$$\n\n**Part 2: Azimuthal Electric Field and Current Density**\n\nThe azimuthal electric field $E_{\\phi}(r)$ can be found from Ampère's Law, $\\nabla \\times \\mathbf{B} = \\mu \\sigma \\mathbf{E}$. For $\\mathbf{B} = B_z(r)\\hat{\\mathbf{z}}$, the curl in cylindrical coordinates is $\\nabla \\times \\mathbf{B} = -\\frac{dB_z}{dr}\\hat{\\mathbf{\\phi}}$.\nThus, $\\mu \\sigma E_{\\phi}(r) = -\\frac{dB_z}{dr}$.\nUsing the derivative identity $\\frac{d}{dx}J_0(x) = -J_1(x)$, we have $\\frac{d}{dr}J_0(kr) = -k J_1(kr)$.\n$$\n\\frac{dB_z}{dr} = B_0 \\frac{\\mu}{\\mu_0 J_0(ka)} \\frac{d}{dr}(J_0(kr)) = -k B_0 \\frac{\\mu}{\\mu_0 J_0(ka)} J_1(kr)\n$$\nSubstituting this into the expression for $E_{\\phi}$:\n$$\nE_{\\phi}(r) = -\\frac{1}{\\mu\\sigma}\\left(-k B_0 \\frac{\\mu}{\\mu_0 J_0(ka)} J_1(kr)\\right) = \\frac{k B_0}{\\mu_0 \\sigma J_0(ka)} J_1(kr)\n$$\nThe azimuthal current density is given by Ohm's Law, $J_{\\phi}(r) = \\sigma E_{\\phi}(r)$:\n$$\nJ_{\\phi}(r) = \\frac{k B_0}{\\mu_0 J_0(ka)} J_1(kr)\n$$\n\n**Part 3: Net Electromagnetic Torque**\n\nThe Lorentz force density is given by $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$. This is the force per unit volume.\nThe torque density about the $z$-axis is $\\boldsymbol{\\tau} = \\mathbf{r} \\times \\mathbf{f}$.\nThe net torque per unit length is $\\frac{d\\mathbf{T}}{dz} = \\int_{0}^{a} \\int_{0}^{2\\pi} (\\mathbf{r} \\times \\mathbf{f}) r\\,d\\phi\\,dr$.\n\nLet's evaluate the force density $\\mathbf{f}$ using the derived fields (either the instantaneous real fields or the complex phasors for time-averaged force).\nThe current density is purely azimuthal: $\\mathbf{J} = J_{\\phi}(r)\\hat{\\mathbf{\\phi}}$.\nThe magnetic flux density is purely axial: $\\mathbf{B} = B_z(r)\\hat{\\mathbf{z}}$.\nThe cross product is:\n$$\n\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B} = \\left(J_{\\phi}(r)\\hat{\\mathbf{\\phi}}\\right) \\times \\left(B_z(r)\\hat{\\mathbf{z}}\\right) = J_{\\phi}(r)B_z(r) (\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}})\n$$\nUsing the cross product rule for cylindrical unit vectors, $\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}} = \\hat{\\mathbf{r}}$.\n$$\n\\mathbf{f} = J_{\\phi}(r)B_z(r) \\hat{\\mathbf{r}}\n$$\nThe force density is purely radial. This is the well-known pinch force.\n\nNow, we compute the torque density, $\\boldsymbol{\\tau}$. The position vector from the axis of rotation (the $z$-axis) is $\\mathbf{r} = r\\hat{\\mathbf{r}}$.\n$$\n\\boldsymbol{\\tau} = \\mathbf{r} \\times \\mathbf{f} = (r\\hat{\\mathbf{r}}) \\times (f_r(r)\\hat{\\mathbf{r}})\n$$\nwhere $f_r(r) = J_{\\phi}(r)B_z(r)$. Since the cross product of any vector with a parallel vector is zero,\n$$\n\\boldsymbol{\\tau} = \\mathbf{0}\n$$\nThe torque density is zero everywhere within the conductor. Therefore, the net torque per unit length, which is the integral of the torque density over the cross-sectional area, is also zero.\n\nThis result stems directly from the axial symmetry of the problem. An axially symmetric system subjected to a purely axial magnetic field cannot experience a torque about the axis of symmetry. The problem lacks any non-axial vector component that could produce an azimuthal force component required for torque. The force is entirely radial.",
            "answer": "$$ \\boxed{0} $$"
        },
        {
            "introduction": "While analytical solutions are invaluable for understanding fundamental physics, real-world engineering challenges, such as modeling eddy currents during a plasma disruption, necessitate numerical methods. This practice  shifts the focus to the practical implementation of numerical integrators for a time-dependent circuit model of a fusion device's conducting wall. By implementing and comparing the first-order backward Euler scheme with the second-order Crank-Nicolson scheme, you will gain hands-on experience with the critical concepts of numerical accuracy and convergence rates, illustrating the trade-offs inherent in selecting a computational method for transient simulations.",
            "id": "3969857",
            "problem": "A thin conducting toroidal wall in a fusion device can be approximated as a single-turn loop with self-inductance $L$ and resistance $R$. During a disruption-like transient, the plasma current can be modeled as $I_{p}(t) = I_{0}\\,\\exp(-t/\\tau_{p})$ for $t \\ge 0$, where $I_{0}$ is the initial plasma current and $\\tau_{p}$ is the plasma current decay time. The wall loop is magnetically coupled to the plasma by a mutual inductance $M$ so that the external flux linking the wall is $\\Phi_{\\text{ext}}(t) = M I_{p}(t)$. Starting from the fundamental Maxwell–Faraday law $\\oint \\mathbf{E}\\cdot d\\mathbf{l} = -\\,d\\Phi/dt$, Ohm’s law for a lumped resistor $v_{R} = R i$, and the inductive relation $v_{L} = L\\,di/dt$, the loop equation for the wall current $i(t)$ is\n$$\nL\\,\\frac{di}{dt} + R\\,i(t) \\;=\\; -\\,\\frac{d\\Phi_{\\text{ext}}}{dt} \\;=\\; -\\,M\\,\\frac{dI_{p}}{dt}.\n$$\nFor the exponential plasma current, define $\\alpha = R/L$ and $\\gamma = M I_{0}/(L \\tau_{p})$. Then the initial value problem can be written as\n$$\n\\frac{di}{dt} \\;=\\; -\\,\\alpha\\,i(t) \\;+\\; \\gamma\\,e^{-t/\\tau_{p}}, \\qquad i(0)=0.\n$$\nThe exact solution for $i(t)$ is\n$$\ni(t) \\;=\\; \\frac{M I_{0}}{L}\\,\\frac{1/\\tau_{p}}{\\alpha - 1/\\tau_{p}}\\left(e^{-t/\\tau_{p}} - e^{-\\alpha t}\\right),\n$$\nvalid for $\\alpha \\neq 1/\\tau_{p}$. The time of the peak current magnitude (for $t\\ge 0$) occurs at\n$$\nt_{\\text{peak}} \\;=\\; \\frac{1}{\\alpha - 1/\\tau_{p}}\\,\\ln\\!\\big(\\alpha\\,\\tau_{p}\\big),\n$$\nand the corresponding exact peak wall current magnitude is $|i(t_{\\text{peak}})|$.\n\nYou will numerically integrate the same ordinary differential equation with two time-integration schemes using identical time steps $\\Delta t$:\n- Backward Euler (BE): the one-step implicit scheme defined by $i^{n+1} = i^{n} + \\Delta t\\, f(t^{n+1}, i^{n+1})$ for $f(t,i) = -\\alpha i + \\gamma e^{-t/\\tau_{p}}$.\n- Crank–Nicolson (CN): the trapezoidal implicit scheme defined by $i^{n+1} = i^{n} + \\frac{\\Delta t}{2}\\left[f(t^{n}, i^{n}) + f(t^{n+1}, i^{n+1})\\right]$.\n\nFor both schemes, use $i^{0}=0$ at $t^{0}=0$, advance with fixed $\\Delta t$ up to $T_{\\text{end}} = 10\\,\\max(\\tau_{p}, L/R)$, and compute the discrete peak magnitude $\\max_{n} |i^{n}|$. Define the relative peak-current error for a method as\n$$\n\\varepsilon \\;=\\; \\frac{\\left|\\max_{n}|i^{n}| - |i(t_{\\text{peak}})|\\right|}{|i(t_{\\text{peak}})|}.\n$$\nYour task is to quantify, for each test case below, the ratio of errors\n$$\n\\rho \\;=\\; \\frac{\\varepsilon_{\\text{CN}}}{\\varepsilon_{\\text{BE}}},\n$$\nwhen Crank–Nicolson (CN) and backward Euler (BE) use identical time steps. All physical parameters must be in International System of Units (SI): $L$ in henries, $R$ in ohms, $M$ in henries, $I_{0}$ in amperes, $\\tau_{p}$ in seconds, and $\\Delta t$ in seconds. The output $\\rho$ is dimensionless.\n\nImplement a program that, for each test case, computes $\\rho$ to at least $6$ correct decimal digits and prints all results on a single line as a comma-separated list enclosed in square brackets, in the order of the test cases.\n\nTest suite (each tuple is $(L,\\;R,\\;M,\\;I_{0},\\;\\tau_{p},\\;\\Delta t)$):\n- Case A (balanced timescales, moderate step): ($1.0\\times 10^{-3}$,\\; $2.0\\times 10^{-1}$,\\; $5.0\\times 10^{-6}$,\\; $1.0\\times 10^{6}$,\\; $1.0\\times 10^{-2}$,\\; $2.0\\times 10^{-3}$).\n- Case B (fast plasma decay, coarse step): ($1.0\\times 10^{-3}$,\\; $2.0\\times 10^{-1}$,\\; $5.0\\times 10^{-6}$,\\; $1.0\\times 10^{6}$,\\; $5.0\\times 10^{-4}$,\\; $5.0\\times 10^{-4}$).\n- Case C (slow wall, intermediate plasma, moderate step): ($2.0\\times 10^{-3}$,\\; $5.0\\times 10^{-2}$,\\; $1.0\\times 10^{-5}$,\\; $5.0\\times 10^{5}$,\\; $2.0\\times 10^{-2}$,\\; $5.0\\times 10^{-3}$).\n- Case D (fast wall, moderately fast plasma, coarse step): ($5.0\\times 10^{-4}$,\\; $5.0\\times 10^{-1}$,\\; $2.0\\times 10^{-6}$,\\; $2.0\\times 10^{6}$,\\; $2.0\\times 10^{-3}$,\\; $1.0\\times 10^{-3}$).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of [Case A, Case B, Case C, Case D], for example: \"[0.12345678,0.23456789,0.34567890,0.45678901]\".",
            "solution": "The problem statement has been meticulously reviewed and is determined to be **valid**. It is scientifically grounded in the principles of electromagnetism and circuit theory, presenting a well-posed initial value problem derived from a standard physical model in fusion engineering. All parameters, equations, and objectives are clearly and consistently defined, allowing for a unique and verifiable solution.\n\nThe objective is to compute the ratio of relative errors, $\\rho = \\varepsilon_{\\text{CN}}/\\varepsilon_{\\text{BE}}$, between the Crank–Nicolson (CN) and backward Euler (BE) numerical schemes for a given ordinary differential equation (ODE) describing eddy current dynamics. The relative error $\\varepsilon$ for each scheme is defined with respect to the peak magnitude of the exact analytical solution.\n\nThe governing ODE is:\n$$\n\\frac{di}{dt} = f(t, i) = -\\alpha i(t) + \\gamma e^{-t/\\tau_p}, \\quad i(0) = 0\n$$\nwhere $\\alpha = R/L$ and $\\gamma = M I_0 / (L \\tau_p)$.\n\nFirst, we must derive the explicit one-step update formulas for $i^{n+1}$ from the implicit definitions of the BE and CN schemes. Let $t^n = n\\Delta t$.\n\n**Backward Euler (BE) Scheme**\nThe BE scheme is defined as:\n$$\ni^{n+1} = i^n + \\Delta t f(t^{n+1}, i^{n+1})\n$$\nSubstituting the function $f(t,i)$:\n$$\ni^{n+1} = i^n + \\Delta t \\left( -\\alpha i^{n+1} + \\gamma e^{-t^{n+1}/\\tau_p} \\right)\n$$\nSince the ODE is linear, we can algebraically solve for $i^{n+1}$:\n$$\ni^{n+1} + \\alpha \\Delta t i^{n+1} = i^n + \\gamma \\Delta t e^{-t^{n+1}/\\tau_p}\n$$\n$$\ni^{n+1}(1 + \\alpha \\Delta t) = i^n + \\gamma \\Delta t e^{-t^{n+1}/\\tau_p}\n$$\nThis yields the explicit update rule for the BE scheme:\n$$\ni_{\\text{BE}}^{n+1} = \\frac{i^n + \\gamma \\Delta t \\exp(-t^{n+1}/\\tau_p)}{1 + \\alpha \\Delta t}\n$$\n\n**Crank–Nicolson (CN) Scheme**\nThe CN scheme is defined as:\n$$\ni^{n+1} = i^n + \\frac{\\Delta t}{2} \\left[ f(t^n, i^n) + f(t^{n+1}, i^{n+1}) \\right]\n$$\nSubstituting the function $f(t,i)$:\n$$\ni^{n+1} = i^n + \\frac{\\Delta t}{2} \\left[ (-\\alpha i^n + \\gamma e^{-t^n/\\tau_p}) + (-\\alpha i^{n+1} + \\gamma e^{-t^{n+1}/\\tau_p}) \\right]\n$$\nAgain, we rearrange to solve for $i^{n+1}$:\n$$\ni^{n+1} = i^n - \\frac{\\alpha \\Delta t}{2} i^n - \\frac{\\alpha \\Delta t}{2} i^{n+1} + \\frac{\\gamma \\Delta t}{2} \\left( e^{-t^n/\\tau_p} + e^{-t^{n+1}/\\tau_p} \\right)\n$$\n$$\ni^{n+1} \\left( 1 + \\frac{\\alpha \\Delta t}{2} \\right) = i^n \\left( 1 - \\frac{\\alpha \\Delta t}{2} \\right) + \\frac{\\gamma \\Delta t}{2} \\left( e^{-t^n/\\tau_p} + e^{-t^{n+1}/\\tau_p} \\right)\n$$\nThis yields the explicit update rule for the CN scheme:\n$$\ni_{\\text{CN}}^{n+1} = \\frac{i^n \\left( 1 - \\frac{\\alpha \\Delta t}{2} \\right) + \\frac{\\gamma \\Delta t}{2} \\left( \\exp(-t^n/\\tau_p) + \\exp(-t^{n+1}/\\tau_p) \\right)}{1 + \\frac{\\alpha \\Delta t}{2}}\n$$\n\n**Computational Algorithm**\nFor each test case, specified by the tuple $(L, R, M, I_0, \\tau_p, \\Delta t)$, the procedure is as follows:\n\n1.  **Parameter Calculation**: Compute the derived constants:\n    -   Wall time constant: $\\tau_w = L/R$.\n    -   Normalized decay rate: $\\alpha = 1/\\tau_w = R/L$.\n    -   Normalized forcing amplitude: $\\gamma = M I_0 / (L \\tau_p)$.\n    -   Simulation end time: $T_{\\text{end}} = 10 \\max(\\tau_p, \\tau_w)$.\n\n2.  **Exact Peak Current**: Calculate the magnitude of the exact peak wall current, $|i(t_{\\text{peak}})|$.\n    -   Time of peak current: $t_{\\text{peak}} = \\frac{1}{\\alpha - 1/\\tau_p} \\ln(\\alpha \\tau_p)$.\n    -   The exact solution is $i(t) = \\frac{M I_0}{L} \\frac{1/\\tau_p}{\\alpha - 1/\\tau_p} (e^{-t/\\tau_p} - e^{-\\alpha t})$.\n    -   The exact peak current magnitude is $i_{\\text{peak, exact}} = |i(t_{\\text{peak}})|$. For the given parameters, $i(t) \\ge 0$ for $t \\ge 0$, so the absolute value is redundant.\n\n3.  **Numerical Integration**:\n    -   Determine the number of time steps, $N = \\lfloor T_{\\text{end}} / \\Delta t \\rfloor$.\n    -   Create a time grid $t^n = n \\Delta t$ for $n = 0, 1, \\dots, N$.\n    -   Initialize current arrays $i_{\\text{BE}}$ and $i_{\\text{CN}}$ of size $N+1$ with the initial condition $i^0 = 0$.\n    -   Iterate from $n = 0$ to $N-1$ to populate the arrays using the respective update formulas for $i_{\\text{BE}}^{n+1}$ and $i_{\\text{CN}}^{n+1}$.\n\n4.  **Error and Ratio Calculation**:\n    -   Find the discrete peak current magnitude for each scheme: $i_{\\text{peak, BE}} = \\max_{n} |i_{\\text{BE}}^n|$ and $i_{\\text{peak, CN}} = \\max_{n} |i_{\\text{CN}}^n|$.\n    -   Compute the relative errors:\n    $$ \\varepsilon_{\\text{BE}} = \\frac{|i_{\\text{peak, BE}} - i_{\\text{peak, exact}}|}{|i_{\\text{peak, exact}}|} $$\n    $$ \\varepsilon_{\\text{CN}} = \\frac{|i_{\\text{peak, CN}} - i_{\\text{peak, exact}}|}{|i_{\\text{peak, exact}}|} $$\n    -   Finally, compute the desired ratio:\n    $$ \\rho = \\frac{\\varepsilon_{\\text{CN}}}{\\varepsilon_{\\text{BE}}} $$\n\nThis procedure will be implemented for each of the four test cases. The known theoretical convergence rates are first-order, $O(\\Delta t)$, for BE and second-order, $O(\\Delta t^2)$, for CN. Consequently, the error ratio $\\rho$ is expected to be substantially smaller than $1$ and should scale approximately with $\\Delta t$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_error_ratio(L, R, M, I0, tau_p, dt):\n    \"\"\"\n    Computes the ratio of relative peak-current errors between the\n    Crank-Nicolson and Backward Euler schemes for a single test case.\n\n    Args:\n        L (float): Self-inductance (H)\n        R (float): Resistance (Ohm)\n        M (float): Mutual inductance (H)\n        I0 (float): Initial plasma current (A)\n        tau_p (float): Plasma current decay time (s)\n        dt (float): Time step (s)\n\n    Returns:\n        float: The ratio of errors, rho = eps_CN / eps_BE.\n    \"\"\"\n\n    # 1. Parameter Calculation\n    alpha = R / L\n    tau_w = L / R\n    gamma = M * I0 / (L * tau_p)\n    T_end = 10.0 * max(tau_p, tau_w)\n\n    # 2. Exact Peak Current Calculation\n    if np.isclose(alpha * tau_p, 1.0):\n        # This case is excluded by the problem statement validation.\n        raise ValueError(\"The special case alpha * tau_p = 1 is not handled.\")\n\n    t_peak = (1.0 / (alpha - 1.0 / tau_p)) * np.log(alpha * tau_p)\n    \n    prefactor = (M * I0 / L) * (1.0 / tau_p) / (alpha - 1.0 / tau_p)\n    \n    i_peak_exact = prefactor * (np.exp(-t_peak / tau_p) - np.exp(-alpha * t_peak))\n\n    # 3. Numerical Integration\n    num_steps = int(T_end / dt)\n    t = np.linspace(0, num_steps * dt, num_steps + 1)\n    \n    i_be = np.zeros(num_steps + 1)\n    i_cn = np.zeros(num_steps + 1)\n    i_be[0] = 0.0\n    i_cn[0] = 0.0\n\n    # Pre-compute constants for the loop\n    # Backward Euler\n    be_denom = 1.0 + alpha * dt\n    be_num_term2_factor = gamma * dt\n    # Crank-Nicolson\n    cn_denom = 1.0 + alpha * dt / 2.0\n    cn_num_term1_factor = 1.0 - alpha * dt / 2.0\n    cn_num_term2_factor = gamma * dt / 2.0\n\n    # Time-stepping loop\n    for n in range(num_steps):\n        t_n = t[n]\n        t_n1 = t[n+1]\n        \n        # Forcing term evaluations\n        exp_n = np.exp(-t_n / tau_p)\n        exp_n1 = np.exp(-t_n1 / tau_p)\n\n        # Backward Euler update\n        i_be[n+1] = (i_be[n] + be_num_term2_factor * exp_n1) / be_denom\n\n        # Crank-Nicolson update\n        cn_num_term1 = i_cn[n] * cn_num_term1_factor\n        cn_num_term2 = cn_num_term2_factor * (exp_n + exp_n1)\n        i_cn[n+1] = (cn_num_term1 + cn_num_term2) / cn_denom\n        \n    # 4. Error and Ratio Calculation\n    i_peak_be = np.max(np.abs(i_be))\n    i_peak_cn = np.max(np.abs(i_cn))\n\n    eps_be = np.abs(i_peak_be - i_peak_exact) / np.abs(i_peak_exact)\n    eps_cn = np.abs(i_peak_cn - i_peak_exact) / np.abs(i_peak_exact)\n\n    if np.isclose(eps_be, 0.0):\n        if np.isclose(eps_cn, 0.0):\n            return 1.0  # Or 0.0, but this indicates both are exact\n        else:\n            return np.inf\n\n    rho = eps_cn / eps_be\n    return rho\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, R, M, I0, tau_p, dt)\n        (1.0e-3, 2.0e-1, 5.0e-6, 1.0e6, 1.0e-2, 2.0e-3), # Case A\n        (1.0e-3, 2.0e-1, 5.0e-6, 1.0e6, 5.0e-4, 5.0e-4), # Case B\n        (2.0e-3, 5.0e-2, 1.0e-5, 5.0e5, 2.0e-2, 5.0e-3), # Case C\n        (5.0e-4, 5.0e-1, 2.0e-6, 2.0e6, 2.0e-3, 1.0e-3), # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_error_ratio(*case)\n        results.append(f\"{result:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}