{
    "hands_on_practices": [
        {
            "introduction": "To build a strong foundation, we begin with a classic analytical problem: determining the eddy currents induced in a solid conducting cylinder by a uniform axial magnetic field. This exercise will sharpen your skills in applying Maxwell's equations in the magnetoquasistatic regime, solving the resulting Bessel differential equation, and correctly imposing physical boundary conditions. Furthermore, the question regarding the net torque will challenge you to connect your mathematical solution to fundamental physical principles of symmetry, providing a deeper insight into the nature of electromagnetic forces .",
            "id": "3969840",
            "problem": "An infinitely long, solid, homogeneous conducting cylinder of radius $a$ with electrical conductivity $\\sigma$ and magnetic permeability $\\mu$ is embedded in vacuum (permeability $\\mu_0$). The cylinder axis is aligned with the $z$-axis. A spatially uniform, time-harmonic axial magnetic flux density is imposed in the surrounding vacuum, $\\mathbf{B}_{\\text{ext}}(t)=\\Re\\{B_0 \\exp(i \\omega t)\\}\\,\\hat{\\mathbf{z}}$, where $B_0$ is a constant complex amplitude and $\\omega>0$ is the angular frequency. Assume the magnetoquasistatic regime inside the metal, so that $\\sigma \\gg \\omega \\epsilon_0$ and displacement current can be neglected in the conductor. Use phasor notation with time dependence $\\exp(i \\omega t)$ for all fields.\n\nStarting from the fundamental Maxwell equations, Ohm’s law, and the constitutive relation $\\mathbf{B}=\\mu \\mathbf{H}$ inside the metal, and $\\mathbf{B}=\\mu_0 \\mathbf{H}$ in vacuum, do the following:\n\n1. Derive the governing partial differential equation for the axial component $B_z(r)$ of the magnetic flux density inside the conductor under the assumptions of axial symmetry and $z$-invariance, and show that the equation reduces to a cylindrical form that admits Bessel-function solutions. State clearly the differential equation you solve and the boundary conditions you impose at $r=0$ and $r=a$, and obtain the closed-form solution for $B_z(r)$ inside the conductor in terms of Bessel functions, the material parameters, and $B_0$.\n\n2. Using the derived $B_z(r)$, determine the corresponding azimuthal electric field $E_{\\phi}(r)$ and the azimuthal current density $J_{\\phi}(r)$ inside the conductor in phasor form by applying Faraday’s law and Ohm’s law.\n\n3. Using the Lorentz force density $\\mathbf{f}=\\mathbf{J}\\times \\mathbf{B}$, compute the net electromagnetic torque about the cylinder axis per unit length due to the induced currents. State any symmetry arguments you use. Express the final torque per unit length in $\\mathrm{N \\cdot m \\, m^{-1}}$. Your final answer must be a single real-valued number or a single closed-form analytic expression. If you find that no rounding is required, give the exact value; otherwise, round your answer to four significant figures.",
            "solution": "The user wants me to solve a problem in electromagnetism, specifically concerning eddy currents in a conducting cylinder.\n\nHere's my plan:\n\n1.  **Validate the Problem Statement:**\n    *   **Step 1: Extract Givens.** I'll list all the provided parameters and conditions verbatim.\n        *   Geometry: Infinitely long, solid, homogeneous conducting cylinder, radius $a$, axis on $z$-axis.\n        *   Material properties (conductor): conductivity $\\sigma$, permeability $\\mu$.\n        *   Surrounding medium: Vacuum, permeability $\\mu_0$.\n        *   External field: Spatially uniform, time-harmonic axial magnetic flux density in vacuum, $\\mathbf{B}_{\\text{ext}}(t)=\\Re\\{B_0 \\exp(i \\omega t)\\}\\,\\hat{\\mathbf{z}}$, with $B_0$ a constant complex amplitude and $\\omega > 0$.\n        *   Approximation: Magnetoquasistatic (MQS) regime in conductor ($\\sigma \\gg \\omega \\epsilon_0$), displacement current neglected.\n        *   Notation: Phasor notation, time dependence $\\exp(i \\omega t)$.\n        *   Fundamental laws: Maxwell's equations, Ohm's law ($\\mathbf{J} = \\sigma \\mathbf{E}$), constitutive relations ($\\mathbf{B}=\\mu \\mathbf{H}$ in metal, $\\mathbf{B}=\\mu_0 \\mathbf{H}$ in vacuum).\n        *   Symmetry: Axial symmetry, $z$-invariance.\n        *   Tasks:\n            1.  Derive the PDE for $B_z(r)$ inside the conductor, state the equation and boundary conditions, and find the solution in terms of Bessel functions.\n            2.  Find the corresponding $E_{\\phi}(r)$ and $J_{\\phi}(r)$.\n            3.  Compute the net electromagnetic torque per unit length.\n\n    *   **Step 2: Validate.**\n        *   **Scientifically Grounded:** Yes, this is a classic problem in electromagnetism (eddy currents). The MQS approximation is standard and well-defined. The setup is physically realistic.\n        *   **Well-Posed:** Yes, it's a boundary value problem. The geometry and sources are defined, and the requested quantities can be derived from the setup.\n        *   **Objective:** Yes, the language is precise and technical. No subjective elements.\n        *   **Non-Formalizable/Irrelevant:** No, this is a formal physics problem directly relevant to the specified field of computational fusion science (eddy currents in conducting structures are a major concern in tokamaks, for example).\n        *   **Incomplete/Contradictory:** The setup seems complete. It provides the geometry, material properties, external source, and the necessary physical laws. The boundary conditions will need to be derived, which is part of the problem.\n        *   **Unrealistic/Infeasible:** No, the setup is physically plausible.\n        *   **Ill-Posed/Poorly Structured:** No, the problem asks for a unique solution to a well-defined PDE with physical boundary conditions.\n        *   **Pseudo-Profound/Trivial:** No, this is a standard-but-non-trivial problem involving Bessel functions and vector calculus. The final part about torque seems interesting.\n        *   **Outside Scientific Verifiability:** No, all steps are mathematically and physically verifiable.\n\n    *   **Step 3: Verdict.** The problem is **VALID**. I will proceed with the solution.\n\n2.  **Solve the Problem:**\n\n    *   **Part 1: PDE for $B_z(r)$**\n        *   Start with Maxwell's equations in phasor form (in the conductor):\n            *   $\\nabla \\cdot \\mathbf{B} = 0$\n            *   $\\nabla \\times \\mathbf{E} = -i \\omega \\mathbf{B}$ (Faraday's Law)\n            *   $\\nabla \\cdot \\mathbf{E} = 0$ (from $\\nabla \\cdot \\mathbf{J} = 0$ and $\\mathbf{J}=\\sigma \\mathbf{E}$)\n            *   $\\nabla \\times \\mathbf{B} = \\mu \\mathbf{J}$ (Ampere's Law, neglecting displacement current $\\mathbf{J}_D = i \\omega \\epsilon \\mathbf{E}$).\n        *   Combine the equations:\n            *   Take the curl of Ampere's Law: $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\mu (\\nabla \\times \\mathbf{J})$.\n            *   Use Ohm's Law: $\\nabla \\times \\mathbf{J} = \\sigma (\\nabla \\times \\mathbf{E})$.\n            *   Use Faraday's Law: $\\nabla \\times \\mathbf{E} = -i \\omega \\mathbf{B}$.\n            *   Substitute back: $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\mu \\sigma (-i \\omega \\mathbf{B}) = -i \\omega \\mu \\sigma \\mathbf{B}$.\n            *   Use vector identity: $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla (\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B}$.\n            *   Since $\\nabla \\cdot \\mathbf{B} = 0$, this simplifies to $-\\nabla^2 \\mathbf{B} = -i \\omega \\mu \\sigma \\mathbf{B}$, or $\\nabla^2 \\mathbf{B} = i \\omega \\mu \\sigma \\mathbf{B}$.\n        *   Apply symmetry:\n            *   The problem is axially symmetric, so fields depend only on $r$.\n            *   The external field is $\\mathbf{B}_{\\text{ext}} = B_z^{\\text{ext}} \\hat{\\mathbf{z}}$. By symmetry, the induced fields will also have this structure. The induced currents must be azimuthal ($\\phi$-directed) to produce a modifying $B_z$. An azimuthal current $J_\\phi$ implies an azimuthal electric field $E_\\phi$. From Faraday's law, $\\nabla \\times \\mathbf{E} = (\\frac{1}{r}\\frac{\\partial}{\\partial r}(r E_\\phi)) \\hat{\\mathbf{z}}$. For this to equal $-i\\omega B_z \\hat{\\mathbf{z}}$, $B_z$ must depend on $r$.\n            *   So, we are looking for a solution of the form $\\mathbf{B}(r) = B_z(r) \\hat{\\mathbf{z}}$.\n        *   Write the vector Laplacian in cylindrical coordinates for $\\mathbf{B} = B_z(r) \\hat{\\mathbf{z}}$:\n            *   $\\nabla^2 \\mathbf{B} = (\\nabla^2 B_z) \\hat{\\mathbf{z}}$.\n            *   $\\nabla^2 B_z = \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{d B_z}{dr} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 B_z}{\\partial \\phi^2} + \\frac{\\partial^2 B_z}{\\partial z^2}$.\n            *   Due to axial symmetry ($\\partial/\\partial\\phi=0$) and $z$-invariance ($\\partial/\\partial z=0$), this simplifies to $\\nabla^2 B_z = \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{d B_z}{dr} \\right)$.\n        *   The PDE for $B_z(r)$ is: $\\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{d B_z}{dr} \\right) = i \\omega \\mu \\sigma B_z$.\n        *   Let's define $k^2 = -i \\omega \\mu \\sigma$. The equation is $\\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{d B_z}{dr} \\right) + k^2 B_z = 0$.\n        *   This is Bessel's differential equation of order zero. Expanding it: $r^2 \\frac{d^2 B_z}{dr^2} + r \\frac{d B_z}{dr} + (kr)^2 B_z = 0$.\n        *   The general solution is $B_z(r) = C_1 J_0(kr) + C_2 Y_0(kr)$, where $J_0$ and $Y_0$ are Bessel functions of the first and second kind, of order zero.\n        *   Boundary Conditions:\n            1.  **At $r=0$**: The field must be finite. Since $Y_0(kr) \\to -\\infty$ as $r \\to 0$, we must have $C_2 = 0$. So, the solution is of the form $B_z(r) = C_1 J_0(kr)$.\n            2.  **At $r=a$**: The tangential component of the magnetic field $\\mathbf{H}$ must be continuous across the boundary. The problem statement refers to an *imposed* external field $\\mathbf{B}_{\\text{ext}} = B_0 \\hat{\\mathbf{z}}$ in the vacuum. This is a bit subtle. Does this mean the total field in vacuum is just $B_0 \\hat{\\mathbf{z}}$? Or is this the field that would exist *without* the cylinder? Let's assume it is the latter. The total field in the vacuum ($r>a$) will be the sum of the imposed field and the field produced by the eddy currents in the cylinder.\n                *   Total field in vacuum $(r>a)$: $\\mathbf{B}_{\\text{vac}}(r) = \\mathbf{B}_{\\text{ext}} + \\mathbf{B}_{\\text{ind}}$. The induced field $\\mathbf{B}_{\\text{ind}}$ is generated by the current $J_\\phi$ in the cylinder. Since the cylinder is infinitely long, outside the cylinder, Ampere's law in integral form for a loop at $r>a$ gives $\\oint \\mathbf{B}_{\\text{ind}} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}} = \\mu_0 \\int_0^a J_\\phi(r) (2\\pi r) dr \\times (\\text{length})$. This is for the static case. In our time-varying case, for $r>a$, the field $B_z$ satisfies $\\nabla^2 B_z = 0$ (in vacuum, $\\sigma=0$). The solution that is well-behaved at $r \\to \\infty$ is a constant. So $B_{z, \\text{vac}}$ is constant for $r>a$.\n                *   This means the total axial field in the vacuum is spatially uniform. Let's call its amplitude $B_{\\text{total, vac}}$.\n                *   Let's re-read the problem: \"A spatially uniform, time-harmonic axial magnetic flux density is imposed in the surrounding vacuum, $\\mathbf{B}_{\\text{ext}}(t)=\\Re\\{B_0 \\exp(i \\omega t)\\}\\,\\hat{\\mathbf{z}}$\". This phrasing is a bit ambiguous. A common interpretation in such problems is that the total field far from the cylinder asymptotes to this value. Given the $z$-invariance and cylindrical symmetry, the field generated by the currents must decay to zero as $r \\to \\infty$. So the total field at $r \\to \\infty$ is just the imposed field. Since $\\nabla^2 B_z = 0$ in vacuum for $r > a$, and the solution must be constant, the total field for all $r>a$ must be this constant value. Therefore, the total field just outside the cylinder is $B_0 \\hat{\\mathbf{z}}$.\n                *   So, the boundary condition at $r=a$ is the continuity of the total **axial** magnetic field $B_z$.\n                    *   $B_z(r=a^-) = B_z(r=a^+)$.\n                    *   $B_z(r=a^+) = B_0$.\n                    *   So, $B_z(r=a) = B_0$.\n                *   Wait, is it $B_z$ or $H_z$ that is continuous? $B_z$ is the normal component of $\\mathbf{B}$ to the surfaces $z=\\text{const}$, but it's the tangential component to surfaces $r=\\text{const}$. $H_z$ is the tangential component of $\\mathbf{H}$ to surfaces $r=\\text{const}$. The boundary condition is on the tangential components of $\\mathbf{H}$: $\\mathbf{\\hat{n}} \\times (\\mathbf{H}_2 - \\mathbf{H}_1) = \\mathbf{K}_s$, where $\\mathbf{K}_s$ is the surface current density. Here, $\\mathbf{\\hat{n}} = \\mathbf{\\hat{r}}$. $\\mathbf{H}_{in} = H_z(r) \\mathbf{\\hat{z}}$ and $\\mathbf{H}_{out} = H_z^{\\text{vac}} \\mathbf{\\hat{z}}$. So $\\mathbf{\\hat{r}} \\times (H_z^{\\text{vac}} \\mathbf{\\hat{z}} - H_z(a) \\mathbf{\\hat{z}}) = (H_z^{\\text{vac}} - H_z(a))\\mathbf{\\hat{\\phi}}$. Since there are no surface currents ($J_\\phi$ is a volume current), $\\mathbf{K}_s=0$. So $H_z(a) = H_z^{\\text{vac}}$.\n                *   Then $B_z(a)/\\mu = B_z^{\\text{vac}}/\\mu_0$.\n                *   As argued before, the total field in the vacuum is uniform, so $\\mathbf{B}_{\\text{vac}} = B_0 \\hat{\\mathbf{z}}$.\n                *   The boundary condition is $B_z(r=a)/\\mu = B_0/\\mu_0$.\n                *   So, $C_1 J_0(ka) = \\mu B_0 / \\mu_0$. This determines $C_1$.\n                *   $C_1 = \\frac{\\mu B_0}{\\mu_0 J_0(ka)}$.\n                *   The solution for $B_z(r)$ inside the conductor is $B_z(r) = \\frac{\\mu B_0}{\\mu_0} \\frac{J_0(kr)}{J_0(ka)}$.\n        *   Let's double-check the constant $k$. We set $k^2 = -i \\omega \\mu \\sigma$.\n            *   $k = \\sqrt{-i} \\sqrt{\\omega \\mu \\sigma} = \\frac{1-i}{\\sqrt{2}} \\sqrt{\\omega \\mu \\sigma}$.\n            *   Let's define the skin depth $\\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}}$, so $k = \\frac{1-i}{\\delta}$.\n            *   This is a standard definition. So, $B_z(r) = \\frac{\\mu B_0}{\\mu_0} \\frac{J_0\\left(\\frac{1-i}{\\delta}r\\right)}{J_0\\left(\\frac{1-i}{\\delta}a\\right)}$. Looks correct.\n\n    *   **Part 2: Find $E_\\phi(r)$ and $J_\\phi(r)$**\n        *   Use Faraday's Law: $\\nabla \\times \\mathbf{E} = -i \\omega \\mathbf{B}$.\n        *   Assume $\\mathbf{E} = E_\\phi(r) \\hat{\\mathbf{\\phi}}$.\n        *   In cylindrical coordinates, $\\nabla \\times \\mathbf{E} = \\frac{1}{r} \\frac{d}{dr}(r E_\\phi) \\hat{\\mathbf{z}}$.\n        *   So, $\\frac{1}{r} \\frac{d}{dr}(r E_\\phi) = -i \\omega B_z(r)$.\n        *   Integrate with respect to $r$: $r E_\\phi(r) = -i \\omega \\int_0^r r' B_z(r') dr' + C$.\n        *   The constant $C$ must be 0, otherwise $E_\\phi(r) \\sim C/r$ as $r \\to 0$, which would imply an infinite line charge on the axis via $\\nabla \\cdot \\mathbf{E}$, which is not physically present. So, $E_\\phi(r) = -\\frac{i \\omega}{r} \\int_0^r r' B_z(r') dr'$.\n        *   We need to integrate $r' J_0(kr')$. Let's use the identity for Bessel functions: $\\frac{d}{dx} [x^n J_n(x)] = x^n J_{n-1}(x)$. For $n=1$, this is $\\frac{d}{dx} [x J_1(x)] = x J_0(x)$.\n        *   So, $\\int x J_0(x) dx = x J_1(x)$.\n        *   Let $x = kr'$. Then $dx = k dr'$ and $dr' = dx/k$.\n        *   $\\int_0^r r' J_0(kr') dr' = \\int_0^{kr} \\frac{x}{k} J_0(x) \\frac{dx}{k} = \\frac{1}{k^2} \\int_0^{kr} x J_0(x) dx = \\frac{1}{k^2} [x J_1(x)]_0^{kr} = \\frac{1}{k^2} (kr J_1(kr))$.\n        *   So, $\\int_0^r r' J_0(kr') dr' = \\frac{r}{k} J_1(kr)$.\n        *   Now substitute this into the expression for $E_\\phi$.\n        *   $B_z(r') = C_1 J_0(kr')$, with $C_1 = \\frac{\\mu B_0}{\\mu_0 J_0(ka)}$.\n        *   $\\int_0^r r' B_z(r') dr' = C_1 \\int_0^r r' J_0(kr') dr' = C_1 \\frac{r}{k} J_1(kr)$.\n        *   $E_\\phi(r) = -\\frac{i \\omega}{r} \\left( C_1 \\frac{r}{k} J_1(kr) \\right) = -C_1 \\frac{i \\omega}{k} J_1(kr)$.\n        *   Substitute $k^2 = -i\\omega\\mu\\sigma \\implies i\\omega = -k^2/(\\mu\\sigma)$.\n        *   $E_\\phi(r) = -C_1 \\frac{-k^2/\\mu\\sigma}{k} J_1(kr) = C_1 \\frac{k}{\\mu\\sigma} J_1(kr)$.\n        *   Substitute $C_1$: $E_\\phi(r) = \\left( \\frac{\\mu B_0}{\\mu_0 J_0(ka)} \\right) \\frac{k}{\\mu\\sigma} J_1(kr) = \\frac{k B_0}{\\mu_0 \\sigma J_0(ka)} J_1(kr)$.\n        *   Let's check this. Alternative way:\n            *   From our initial PDE derivation, we had $\\nabla^2 B_z = i \\omega \\mu \\sigma B_z$.\n            *   Also from Ampere-Maxwell, $\\nabla \\times \\mathbf{B} = \\mu \\mathbf{J} = \\mu \\sigma \\mathbf{E}$.\n            *   With $\\mathbf{B} = B_z(r) \\hat{\\mathbf{z}}$, $\\nabla \\times \\mathbf{B} = (\\frac{1}{r}\\frac{\\partial B_z}{\\partial \\phi} - \\frac{\\partial B_\\phi}{\\partial z})\\hat{\\mathbf{r}} + (\\frac{\\partial B_r}{\\partial z} - \\frac{\\partial B_z}{\\partial r})\\hat{\\mathbf{\\phi}} + ... = -\\frac{dB_z}{dr} \\hat{\\mathbf{\\phi}}$.\n            *   So, $\\mu \\sigma E_\\phi(r) = -\\frac{dB_z}{dr}$.\n            *   $E_\\phi(r) = -\\frac{1}{\\mu \\sigma} \\frac{d}{dr} B_z(r)$.\n            *   $B_z(r) = C_1 J_0(kr)$.\n            *   We need the derivative of $J_0(x)$, which is $-J_1(x)$.\n            *   $\\frac{d}{dr} J_0(kr) = J_0'(kr) \\cdot k = -k J_1(kr)$.\n            *   So, $\\frac{d B_z}{dr} = -C_1 k J_1(kr)$.\n            *   $E_\\phi(r) = -\\frac{1}{\\mu \\sigma} (-C_1 k J_1(kr)) = \\frac{C_1 k}{\\mu \\sigma} J_1(kr)$.\n            *   This matches my previous result. Good.\n        *   So, $E_\\phi(r) = \\frac{\\mu B_0}{\\mu_0 J_0(ka)} \\frac{k}{\\mu\\sigma} J_1(kr) = \\frac{k B_0}{\\mu_0 \\sigma J_0(ka)} J_1(kr)$.\n        *   Now, for the current density $J_\\phi(r)$.\n        *   $J_\\phi(r) = \\sigma E_\\phi(r)$.\n        *   $J_\\phi(r) = \\sigma \\left( \\frac{k B_0}{\\mu_0 \\sigma J_0(ka)} J_1(kr) \\right) = \\frac{k B_0}{\\mu_0 J_0(ka)} J_1(kr)$.\n        *   Let's check the units. $k$ has units of $1/m$. $B_0$ is in Tesla. $\\mu_0$ is $T \\cdot m / A$. So $k B_0 / \\mu_0$ has units of $(1/m) \\cdot T / (T \\cdot m / A) = A/m^2$. This is correct for current density.\n        *   The results for Part 2 are:\n            *   $E_\\phi(r) = \\frac{k B_0}{\\mu_0 \\sigma J_0(ka)} J_1(kr)$\n            *   $J_\\phi(r) = \\frac{k B_0}{\\mu_0 J_0(ka)} J_1(kr)$\n            *   where $k = \\sqrt{-i \\omega \\mu \\sigma} = \\frac{1-i}{\\delta}$.\n\n    *   **Part 3: Net Torque**\n        *   The time-dependent fields are real quantities:\n            *   $\\mathbf{J}(r,t) = \\Re\\{ J_\\phi(r) e^{i\\omega t} \\hat{\\mathbf{\\phi}} \\}$\n            *   $\\mathbf{B}(r,t) = \\Re\\{ B_z(r) e^{i\\omega t} \\hat{\\mathbf{z}} \\}$\n        *   The Lorentz force density is $\\mathbf{f}(r, t) = \\mathbf{J}(r, t) \\times \\mathbf{B}(r, t)$.\n        *   $\\mathbf{f}(r,t) = \\Re\\{J_\\phi(r) e^{i\\omega t} \\hat{\\mathbf{\\phi}}\\} \\times \\Re\\{B_z(r) e^{i\\omega t} \\hat{\\mathbf{z}}\\}$.\n        *   $\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}} = \\hat{\\mathbf{r}}$. So the force is radial.\n        *   The torque density about the $z$-axis is $\\boldsymbol{\\tau}(r,t) = \\mathbf{r} \\times \\mathbf{f}(r, t)$.\n        *   The position vector is $\\mathbf{r} = r \\hat{\\mathbf{r}}$.\n        *   $\\boldsymbol{\\tau}(r,t) = (r \\hat{\\mathbf{r}}) \\times (f_r(r,t) \\hat{\\mathbf{r}}) = \\mathbf{0}$.\n        *   Let me re-read the question. \"compute the net electromagnetic torque about the cylinder axis per unit length\".\n        *   Something is wrong in my logic. Let's re-examine the force.\n        *   $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B} = (J_\\phi \\hat{\\mathbf{\\phi}}) \\times (B_r \\hat{\\mathbf{r}} + B_\\phi \\hat{\\mathbf{\\phi}} + B_z \\hat{\\mathbf{z}})$.\n        *   From my derivation, $\\mathbf{B}$ is purely axial, $\\mathbf{B} = B_z(r) \\hat{\\mathbf{z}}$.\n        *   $\\mathbf{J}$ is purely azimuthal, $\\mathbf{J} = J_\\phi(r) \\hat{\\mathbf{\\phi}}$.\n        *   So $\\mathbf{f} = J_\\phi \\hat{\\mathbf{\\phi}} \\times B_z \\hat{\\mathbf{z}} = J_\\phi B_z (\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}}) = J_\\phi B_z \\hat{\\mathbf{r}}$.\n        *   The force density is indeed purely radial. $\\mathbf{f} = f_r(r,t) \\hat{\\mathbf{r}}$.\n        *   The torque density is $\\boldsymbol{\\tau} = \\mathbf{r} \\times \\mathbf{f} = (r \\hat{\\mathbf{r}}) \\times (f_r \\hat{\\mathbf{r}}) = \\mathbf{0}$.\n        *   The total torque is the integral of the torque density over the volume: $\\mathbf{T} = \\int_V (\\mathbf{r} \\times \\mathbf{f}) dV$. Since the integrand is zero, the total torque is zero.\n        *   This seems too simple and suspicious. Let me rethink the problem. Is there any component of a field I missed?\n        *   The imposed field is $\\mathbf{B}_{\\text{ext}} = B_0 \\hat{\\mathbf{z}}$. The symmetry argument seems solid: the source is symmetric, so the response should be. A purely axial $\\mathbf{B}$ field and a purely azimuthal $\\mathbf{J}$ field. Could $B_0$ be a vector in the $x-y$ plane? No, it's explicitly $\\hat{\\mathbf{z}}$.\n        *   Could $B_0$ be a complex number? Yes, \"constant complex amplitude\". This doesn't change the vector directions.\n        *   What if the cylinder is rotating? The problem doesn't state that.\n        *   What if the imposed field is rotating? The problem says $\\mathbf{B}_{\\text{ext}}(t)=\\Re\\{B_0 \\exp(i \\omega t)\\}\\,\\hat{\\mathbf{z}}$. This is an oscillating field, not a rotating one. A rotating field would be something like $\\mathbf{B}_{\\text{ext}} = B_0(\\cos(\\omega t)\\hat{\\mathbf{x}} + \\sin(\\omega t)\\hat{\\mathbf{y}})$.\n        *   Let's go back to the torque calculation. Often we are interested in the time-averaged torque.\n        *   The time-averaged force density is $\\langle \\mathbf{f} \\rangle = \\langle \\mathbf{J}(t) \\times \\mathbf{B}(t) \\rangle$.\n        *   Using phasors, for two quantities $A(t) = \\Re\\{ \\mathcal{A} e^{i\\omega t} \\}$ and $B(t) = \\Re\\{ \\mathcal{B} e^{i\\omega t} \\}$, the time average of their product is $\\langle A(t)B(t) \\rangle = \\frac{1}{2} \\Re\\{ \\mathcal{A} \\mathcal{B}^* \\}$.\n        *   The time-averaged force density is $\\langle \\mathbf{f} \\rangle = \\frac{1}{2} \\Re\\{ \\mathbf{J}_{\\text{phasor}} \\times \\mathbf{B}_{\\text{phasor}}^* \\}$.\n        *   $\\mathbf{J}_{\\text{phasor}} = J_\\phi(r) \\hat{\\mathbf{\\phi}}$.\n        *   $\\mathbf{B}_{\\text{phasor}}^* = (B_z(r) \\hat{\\mathbf{z}})^* = B_z^*(r) \\hat{\\mathbf{z}}$.\n        *   $\\langle \\mathbf{f} \\rangle = \\frac{1}{2} \\Re\\{ J_\\phi(r) \\hat{\\mathbf{\\phi}} \\times B_z^*(r) \\hat{\\mathbf{z}} \\} = \\frac{1}{2} \\Re\\{ J_\\phi(r) B_z^*(r) \\} \\hat{\\mathbf{r}}$.\n        *   The time-averaged force is still purely radial.\n        *   The time-averaged torque density is $\\langle \\boldsymbol{\\tau} \\rangle = \\mathbf{r} \\times \\langle \\mathbf{f} \\rangle = (r \\hat{\\mathbf{r}}) \\times (\\langle f_r \\rangle \\hat{\\mathbf{r}}) = \\mathbf{0}$.\n        *   The net time-averaged torque is $\\mathbf{T} = \\int_V \\langle \\boldsymbol{\\tau} \\rangle dV = \\mathbf{0}$.\n\n        *   This is a strong result. Is it possible the question is a trick question and the answer is zero?\n        *   \"Using the Lorentz force density ... compute the net electromagnetic torque about the cylinder axis per unit length... State any symmetry arguments you use.\"\n        *   The problem asks for \"the\" net torque, not the time-averaged torque. But the instantaneous torque density is zero.\n        *   This seems highly suspicious. Let me reconsider the setup. Maybe my field assumptions are wrong.\n        *   The problem is axially symmetric and $z$-invariant. The source is $B_z$ field.\n        *   $J_\\phi$ is induced. This $J_\\phi$ induces a $B_z$ field.\n        *   Is there any other component?\n        *   A $J_z$ current would produce a $B_\\phi$ field. What would drive a $J_z$? An $E_z$ field. $\\nabla \\times \\mathbf{H} = \\mathbf{J}$. If we had an $H_r$ or $H_\\phi$ that depended on $z$ or $\\phi$, it could make a $J_z$. But we have $z$-invariance and axial symmetry.\n        *   What about Faraday's law? $\\nabla \\times \\mathbf{E} = -i\\omega \\mathbf{B}$. If $\\mathbf{B}$ has an $r$ or $\\phi$ component, we could get an $E_z$.\n        *   So, does $\\mathbf{B}$ have non-axial components?\n        *   $\\nabla \\cdot \\mathbf{B} = 0$. In cylindrical coordinates, for fields with only $r$ dependence, $\\frac{1}{r}\\frac{d}{dr}(r B_r) = 0$. This implies $r B_r = \\text{const}$. For the field to be finite at $r=0$, the constant must be zero. So $B_r=0$.\n        *   What about $B_\\phi$? This would be produced by a $J_z$. What would produce a $J_z$? An $E_z$. An $E_z$ can be produced by a time-varying $B_\\phi$. A chicken-and-egg problem. But my source is purely $B_z$. There's no source to seed a $B_\\phi$ or $E_z$ field.\n        *   So the field structure $\\mathbf{B} = B_z(r)\\hat{\\mathbf{z}}$, $\\mathbf{E} = E_\\phi(r)\\hat{\\mathbf{\\phi}}$, $\\mathbf{J} = J_\\phi(r)\\hat{\\mathbf{\\phi}}$ seems absolutely correct based on the symmetry and the source.\n        *   And if that structure is correct, the Lorentz force density $\\mathbf{J} \\times \\mathbf{B}$ is purely radial.\n        *   And if the force is purely radial, the torque $\\mathbf{r} \\times \\mathbf{f}$ is identically zero.\n\n        *   Let's check the problem statement again.\n            *   \"infinitely long, solid, homogeneous conducting cylinder\"\n            *   \"axis is aligned with the z-axis\"\n            *   \"spatially uniform, ... axial magnetic flux density\"\n            *   No, everything is perfectly axisymmetric.\n        *   An axial magnetic field and induced circumferential currents produce a radial force (pinching force). This is the basis of the pinch effect. It does not produce a torque.\n        *   For a torque to be produced, you need a force component in the $\\phi$ direction.\n        *   $F_\\phi = (\\mathbf{J} \\times \\mathbf{B})_\\phi = J_z B_r - J_r B_z$.\n        *   As argued, $J_z=0$ and $J_r=0$ (since $E_z=0, E_r=0$).\n        *   So $F_\\phi = 0$. No azimuthal force, no torque.\n\n        *   This is a fundamental result of the symmetry.\n        *   An axial B field + an axisymmetric object CANNOT produce a torque about the axis of symmetry. The torque vector must be a pseudovector. The B field is a pseudovector pointing along z. The geometry is described by a scalar radius $r$. There is no other vector or pseudovector in the problem to cross with $\\mathbf{B}$ to produce a torque in the z-direction. $\\mathbf{T}$ must be proportional to some combination of the input variables. The only pseudovector is $\\mathbf{B}_{ext}$. You cannot construct $\\mathbf{T} \\propto \\hat{\\mathbf{z}}$ from $\\mathbf{B}_{ext} \\propto \\hat{\\mathbf{z}}$ in an axisymmetric system. You would need another vector in the x-y plane.\n        *   For example, if the conductivity $\\sigma$ was a tensor, e.g. with off-diagonal terms, $\\mathbf{J} = \\mathbf{\\sigma} \\mathbf{E}$. Then $E_\\phi$ could generate $J_r$ or $J_z$. If $J_r$ is generated, then $F_\\phi = -J_r B_z$ is non-zero, and there is a torque. But the problem states \"homogeneous conducting cylinder\", which implies scalar $\\sigma$.\n        *   What if the imposed field was not uniform? e.g. $\\mathbf{B}_{\\text{ext}} = B_0(x/L) \\hat{\\mathbf{z}}$. This breaks the axial symmetry. The fields would then depend on $\\phi$. Then you could get a torque. But the problem says \"spatially uniform\".\n        *   What if the cylinder axis was not the z-axis? e.g. shifted by $x_0$. $\\mathbf{B}_{ext} = B_0 \\hat{\\mathbf{z}}$ is still uniform. The geometry is no longer axisymmetric with respect to the coordinate system origin, but it is still axisymmetric with respect to its own axis. The physics should be calculated in the cylinder's own coordinate system. In that system, the problem is identical to the one I solved. The force density is radial. The total force on the cylinder is $\\int \\mathbf{f} dV$. Since $\\mathbf{f}$ is radial and axisymmetric, the total force is zero. The torque about its own axis is zero. The torque about the z-axis would be $\\int (\\mathbf{r}_{lab} \\times \\mathbf{f}) dV$. $\\mathbf{r}_{lab} = \\mathbf{r}_{cyl} + \\mathbf{x}_0$. $\\mathbf{T} = \\int ((\\mathbf{r}_{cyl} + \\mathbf{x}_0) \\times \\mathbf{f}) dV = \\int (\\mathbf{r}_{cyl} \\times \\mathbf{f}) dV + \\mathbf{x}_0 \\times \\int \\mathbf{f} dV$. The first term is a torque about the cylinder axis, which is zero. The second term is a torque due to the net force. The net force $\\int \\mathbf{f} dV = \\int f_r \\hat{\\mathbf{r}} dV = \\int (f_r \\cos\\phi \\hat{\\mathbf{x}} + f_r \\sin\\phi \\hat{\\mathbf{y}}) r dr d\\phi dz$. Since $f_r$ is independent of $\\phi$, the integrals of $\\cos\\phi$ and $\\sin\\phi$ from $0$ to $2\\pi$ are zero. So the net force is zero. The total torque is zero.\n        *   The conclusion seems inescapable: the torque is zero.\n        *   Why would a professor ask this?\n            1.  To test if the student correctly applies a symmetry argument.\n            2.  As a trick question.\n            3.  I have missed something fundamental.\n\n        *   Let's reconsider the B-field in the conductor. Could it have a $\\phi$ component?\n            *   Let's say $\\mathbf{B} = B_\\phi(r) \\hat{\\mathbf{\\phi}} + B_z(r) \\hat{\\mathbf{z}}$.\n            *   $\\nabla \\times \\mathbf{B} = \\mu \\sigma \\mathbf{E}$.\n            *   $(\\nabla \\times \\mathbf{B})_r = -\\frac{d B_z}{d\\phi} = 0 \\implies E_r=0$. Correct.\n            *   $(\\nabla \\times \\mathbf{B})_\\phi = \\frac{d B_r}{dz} - \\frac{d B_z}{dr}$. With z-invariance and $B_r=0$, this is $-\\frac{dB_z}{dr}$. So $E_\\phi = -\\frac{1}{\\mu \\sigma} \\frac{dB_z}{dr}$. This is what I used.\n            *   $(\\nabla \\times \\mathbf{B})_z = \\frac{1}{r}\\frac{d}{dr}(r B_\\phi) \\implies E_z = \\frac{1}{\\mu\\sigma r} \\frac{d}{dr}(r B_\\phi)$.\n            *   Now Faraday's Law: $\\nabla \\times \\mathbf{E} = -i\\omega \\mathbf{B}$.\n            *   $(\\nabla \\times \\mathbf{E})_\\phi = \\frac{d E_r}{dz} - \\frac{d E_z}{dr} = -\\frac{d E_z}{dr} = -i\\omega B_\\phi$.\n            *   So $-\\frac{d}{dr}\\left(\\frac{1}{\\mu\\sigma r} \\frac{d}{dr}(r B_\\phi)\\right) = -i\\omega B_\\phi$.\n            *   This is a differential equation for $B_\\phi$. If we assume $B_\\phi=0$, it is trivially satisfied. Does it *have* to be zero?\n            *   The boundary conditions for $B_\\phi$ would be continuity of $H_\\phi$ at $r=a$. Outside, is there a $B_\\phi$? An external $B_z$ cannot create a $B_\\phi$ in vacuum. So $B_{\\phi, vac}=0$. The source of $B_\\phi$ would be a $J_z$ current. In the cylinder, $J_z = \\sigma E_z$. So, if we have $E_z \\neq 0$, we have $J_z \\neq 0$, we have $B_\\phi \\neq 0$, and we have a non-trivial equation for $B_\\phi$.\n            *   What drives $E_z$? $(\\nabla \\times \\mathbf{E})_z = -i\\omega B_z$. And $(\\nabla \\times \\mathbf{E})_z = \\frac{1}{r}\\frac{d}{dr}(r E_\\phi)$. So this part of Faraday's law determines $E_\\phi$ from $B_z$.\n            *   Is there any other source for $E_z$? No. A time-varying $B_\\phi$ could create it, but a time-varying $B_z$ cannot.\n            *   The system of equations decouples. The $(B_z, E_\\phi, J_\\phi)$ system is driven by the external $B_z$. The $(B_\\phi, E_z, J_z)$ system is not driven by anything. It only has the trivial solution $B_\\phi=E_z=J_z=0$.\n            *   The conclusion is robust. The symmetry argument is correct.\n\n        *   So, the torque is zero. The problem could be a test of this understanding.\n        *   Final Answer should be 0.\n        *   Let me write down the steps for the solution.\n            1.  Start as before, deriving the equations for $B_z$, $E_\\phi$, and $J_\\phi$. This is required by parts 1 and 2 of the question.\n            2.  For part 3, write down the Lorentz force density $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$.\n            3.  Substitute the derived field forms: $\\mathbf{J} = J_\\phi(r,t) \\hat{\\mathbf{\\phi}}$ and $\\mathbf{B} = B_z(r,t) \\hat{\\mathbf{z}}$.\n            4.  Calculate the cross product: $\\mathbf{f} = J_\\phi(r,t) B_z(r,t) (\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}}) = J_\\phi(r,t) B_z(r,t) \\hat{\\mathbf{r}}$.\n            5.  State that the force density is purely radial.\n            6.  Define the torque density as $\\boldsymbol{\\tau} = \\mathbf{r} \\times \\mathbf{f}$.\n            7.  Substitute the forms of $\\mathbf{r}$ and $\\mathbf{f}$: $\\boldsymbol{\\tau} = (r \\hat{\\mathbf{r}}) \\times (f_r(r,t) \\hat{\\mathbf{r}})$.\n            8.  Calculate the cross product: $\\boldsymbol{\\tau} = \\mathbf{0}$, since the cross product of two parallel vectors is zero.\n            9.  The net torque per unit length, $\\frac{d\\mathbf{T}}{dz} = \\int_0^{2\\pi} \\int_0^a \\boldsymbol{\\tau} \\,r \\, dr \\, d\\phi$, is the integral of zero, which is zero.\n            10. Conclude with a statement about the symmetry of the problem being the underlying reason. An axially symmetric system subjected to an axial field cannot experience a torque around that axis.\n\n        *   This seems to be a complete and correct line of reasoning. The problem asks for the derivation of the fields, so I must provide them, even if they lead to a zero torque. The work is not wasted.\n\nLet's quickly review the steps for the solution write-up.\n\n**Part 1: PDE and Solution for $B_z(r)$**\n*   Maxwell's equations in MQS regime: $\\nabla \\times \\mathbf{H} = \\mathbf{J}$ and $\\nabla \\times \\mathbf{E} = -i\\omega\\mathbf{B}$.\n*   Constitutive relations: $\\mathbf{B} = \\mu \\mathbf{H}$, $\\mathbf{J} = \\sigma \\mathbf{E}$.\n*   Combine them to get vector Helmholtz equation: $\\nabla^2 \\mathbf{B} = i\\omega\\mu\\sigma \\mathbf{B}$.\n*   Apply symmetry: $\\mathbf{B} = B_z(r)\\hat{\\mathbf{z}}$. The equation becomes $\\frac{1}{r}\\frac{d}{dr}(r\\frac{dB_z}{dr}) = i\\omega\\mu\\sigma B_z$.\n*   Define $k^2 = -i\\omega\\mu\\sigma$. Equation is Bessel's equation: $\\frac{d^2 B_z}{dr^2} + \\frac{1}{r}\\frac{dB_z}{dr} + k^2 B_z = 0$.\n*   General solution: $B_z(r) = C_1 J_0(kr) + C_2 Y_0(kr)$.\n*   Boundary condition at $r=0$: Finiteness requires $C_2=0$.\n*   Boundary condition at $r=a$: Continuity of tangential $H_z$. $H_z(a) = H_{z,vac}$. In vacuum, $\\mathbf{B}_{vac} = B_0 \\hat{\\mathbf{z}}$, so $H_{z,vac} = B_0/\\mu_0$. Inside, $H_z(a) = B_z(a)/\\mu$.\n*   So, $B_z(a)/\\mu = B_0/\\mu_0 \\implies B_z(a) = \\mu B_0/\\mu_0$.\n*   $C_1 J_0(ka) = \\mu B_0/\\mu_0 \\implies C_1 = \\frac{\\mu B_0}{\\mu_0 J_0(ka)}$.\n*   Final solution for $B_z(r)$: $B_z(r) = \\frac{\\mu B_0}{\\mu_0} \\frac{J_0(kr)}{J_0(ka)}$.\n\n**Part 2: $E_\\phi(r)$ and $J_\\phi(r)$**\n*   From Ampere's Law: $\\nabla \\times \\mathbf{B} = \\mu \\mathbf{J}$. With $\\mathbf{B} = B_z(r)\\hat{\\mathbf{z}}$, we get $\\mu \\mathbf{J} = -\\frac{dB_z}{dr}\\hat{\\mathbf{\\phi}}$.\n*   $\\mathbf{J} = J_\\phi(r)\\hat{\\mathbf{\\phi}} = -\\frac{1}{\\mu} \\frac{d}{dr} \\left( \\frac{\\mu B_0}{\\mu_0} \\frac{J_0(kr)}{J_0(ka)} \\right) \\hat{\\mathbf{\\phi}}$.\n*   Derivative: $\\frac{d}{dr} J_0(kr) = -k J_1(kr)$.\n*   $J_\\phi(r) = -\\frac{B_0}{\\mu_0 J_0(ka)} (-k J_1(kr)) = \\frac{k B_0}{\\mu_0 J_0(ka)} J_1(kr)$.\n*   From Ohm's Law, $\\mathbf{E} = \\mathbf{J}/\\sigma$.\n*   $E_\\phi(r) = \\frac{J_\\phi(r)}{\\sigma} = \\frac{k B_0}{\\mu_0 \\sigma J_0(ka)} J_1(kr)$.\n*   These expressions are complete.\n\n**Part 3: Torque**\n*   Lorentz force density: $\\mathbf{f} = \\Re\\{\\mathbf{J} e^{i\\omega t}\\} \\times \\Re\\{\\mathbf{B} e^{i\\omega t}\\}$.\n*   $\\mathbf{J}$ is in the $\\hat{\\mathbf{\\phi}}$ direction. $\\mathbf{B}$ is in the $\\hat{\\mathbf{z}}$ direction.\n*   $\\mathbf{f}$ is in the $\\hat{\\mathbf{\\phi}} \\times \\hat{\\mathbf{z}} = \\hat{\\mathbf{r}}$ direction. It is a purely radial force density.\n*   Torque density: $\\boldsymbol{\\tau} = \\mathbf{r} \\times \\mathbf{f} = (r \\hat{\\mathbf{r}}) \\times (f_r \\hat{\\mathbf{r}}) = \\mathbf{0}$.\n*   The net torque per unit length is the integral of the torque density over the cross-section, which is $\\mathbf{0}$.\n*   The argument is clean and relies only on the vector directions of the fields, which are direct consequences of the problem's symmetry.\n\nThe solution is solid. I will proceed to write it. I need to be careful with LaTeX formatting for every single mathematical symbol.",
            "answer": "$$ \\boxed{0} $$"
        },
        {
            "introduction": "While analytical solutions are invaluable, most real-world engineering problems require numerical methods, especially for transient events. This practice transitions from analytical derivation to numerical time integration by modeling a fusion device's conducting wall as a lumped-parameter circuit during a plasma disruption. You will implement and compare two fundamental implicit schemes, Backward Euler and Crank-Nicolson, to solve the governing ordinary differential equation, providing hands-on experience in evaluating the accuracy and convergence properties of numerical algorithms .",
            "id": "3969857",
            "problem": "A thin conducting toroidal wall in a fusion device can be approximated as a single-turn loop with self-inductance $L$ and resistance $R$. During a disruption-like transient, the plasma current can be modeled as $I_{p}(t) = I_{0}\\,\\exp(-t/\\tau_{p})$ for $t \\ge 0$, where $I_{0}$ is the initial plasma current and $\\tau_{p}$ is the plasma current decay time. The wall loop is magnetically coupled to the plasma by a mutual inductance $M$ so that the external flux linking the wall is $\\Phi_{\\text{ext}}(t) = M I_{p}(t)$. Starting from the fundamental Maxwell–Faraday law $\\oint \\mathbf{E}\\cdot d\\mathbf{l} = -\\,d\\Phi/dt$, Ohm’s law for a lumped resistor $v_{R} = R i$, and the inductive relation $v_{L} = L\\,di/dt$, the loop equation for the wall current $i(t)$ is\n$$\nL\\,\\frac{di}{dt} + R\\,i(t) \\;=\\; -\\,\\frac{d\\Phi_{\\text{ext}}}{dt} \\;=\\; -\\,M\\,\\frac{dI_{p}}{dt}.\n$$\nFor the exponential plasma current, define $\\alpha = R/L$ and $\\gamma = M I_{0}/(L \\tau_{p})$. Then the initial value problem can be written as\n$$\n\\frac{di}{dt} \\;=\\; -\\,\\alpha\\,i(t) \\;+\\; \\gamma\\,e^{-t/\\tau_{p}}, \\qquad i(0)=0.\n$$\nThe exact solution for $i(t)$ is\n$$\ni(t) \\;=\\; \\frac{M I_{0}}{L}\\,\\frac{1/\\tau_{p}}{\\alpha - 1/\\tau_{p}}\\left(e^{-t/\\tau_{p}} - e^{-\\alpha t}\\right),\n$$\nvalid for $\\alpha \\neq 1/\\tau_{p}$. The time of the peak current magnitude (for $t\\ge 0$) occurs at\n$$\nt_{\\text{peak}} \\;=\\; \\frac{1}{\\alpha - 1/\\tau_{p}}\\,\\ln\\!\\big(\\alpha\\,\\tau_{p}\\big),\n$$\nand the corresponding exact peak wall current magnitude is $|i(t_{\\text{peak}})|$.\n\nYou will numerically integrate the same ordinary differential equation with two time-integration schemes using identical time steps $\\Delta t$:\n- Backward Euler (BE): the one-step implicit scheme defined by $i^{n+1} = i^{n} + \\Delta t\\, f(t^{n+1}, i^{n+1})$ for $f(t,i) = -\\alpha i + \\gamma e^{-t/\\tau_{p}}$.\n- Crank–Nicolson (CN): the trapezoidal implicit scheme defined by $i^{n+1} = i^{n} + \\frac{\\Delta t}{2}\\left[f(t^{n}, i^{n}) + f(t^{n+1}, i^{n+1})\\right]$.\n\nFor both schemes, use $i^{0}=0$ at $t^{0}=0$, advance with fixed $\\Delta t$ up to $T_{\\text{end}} = 10\\,\\max(\\tau_{p}, L/R)$, and compute the discrete peak magnitude $\\max_{n} |i^{n}|$. Define the relative peak-current error for a method as\n$$\n\\varepsilon \\;=\\; \\frac{\\left|\\max_{n}|i^{n}| - |i(t_{\\text{peak}})|\\right|}{|i(t_{\\text{peak}})|}.\n$$\nYour task is to quantify, for each test case below, the ratio of errors\n$$\n\\rho \\;=\\; \\frac{\\varepsilon_{\\text{CN}}}{\\varepsilon_{\\text{BE}}},\n$$\nwhen Crank–Nicolson (CN) and backward Euler (BE) use identical time steps. All physical parameters must be in International System of Units (SI): $L$ in henries, $R$ in ohms, $M$ in henries, $I_{0}$ in amperes, $\\tau_{p}$ in seconds, and $\\Delta t$ in seconds. The output $\\rho$ is dimensionless.\n\nImplement a program that, for each test case, computes $\\rho$ to at least $6$ correct decimal digits and prints all results on a single line as a comma-separated list enclosed in square brackets, in the order of the test cases.\n\nTest suite (each tuple is $(L,\\;R,\\;M,\\;I_{0},\\;\\tau_{p},\\;\\Delta t)$):\n- Case A (balanced timescales, moderate step): ($1.0\\times 10^{-3}$, $2.0\\times 10^{-1}$, $5.0\\times 10^{-6}$, $1.0\\times 10^{6}$, $1.0\\times 10^{-2}$, $2.0\\times 10^{-3}$).\n- Case B (fast plasma decay, coarse step): ($1.0\\times 10^{-3}$, $2.0\\times 10^{-1}$, $5.0\\times 10^{-6}$, $1.0\\times 10^{6}$, $5.0\\times 10^{-4}$, $5.0\\times 10^{-4}$).\n- Case C (slow wall, intermediate plasma, moderate step): ($2.0\\times 10^{-3}$, $5.0\\times 10^{-2}$, $1.0\\times 10^{-5}$, $5.0\\times 10^{5}$, $2.0\\times 10^{-2}$, $5.0\\times 10^{-3}$).\n- Case D (fast wall, moderately fast plasma, coarse step): ($5.0\\times 10^{-4}$, $5.0\\times 10^{-1}$, $2.0\\times 10^{-6}$, $2.0\\times 10^{6}$, $2.0\\times 10^{-3}$, $1.0\\times 10^{-3}$).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Case A, Case B, Case C, Case D], for example: \"[0.12345678,0.23456789,0.34567890,0.45678901]\".",
            "solution": "The problem statement has been meticulously reviewed and is determined to be **valid**. It is scientifically grounded in the principles of electromagnetism and circuit theory, presenting a well-posed initial value problem derived from a standard physical model in fusion engineering. All parameters, equations, and objectives are clearly and consistently defined, allowing for a unique and verifiable solution.\n\nThe objective is to compute the ratio of relative errors, $\\rho = \\varepsilon_{\\text{CN}}/\\varepsilon_{\\text{BE}}$, between the Crank–Nicolson (CN) and backward Euler (BE) numerical schemes for a given ordinary differential equation (ODE) describing eddy current dynamics. The relative error $\\varepsilon$ for each scheme is defined with respect to the peak magnitude of the exact analytical solution.\n\nThe governing ODE is:\n$$\n\\frac{di}{dt} = f(t, i) = -\\alpha i(t) + \\gamma e^{-t/\\tau_p}, \\quad i(0) = 0\n$$\nwhere $\\alpha = R/L$ and $\\gamma = M I_0 / (L \\tau_p)$.\n\nFirst, we must derive the explicit one-step update formulas for $i^{n+1}$ from the implicit definitions of the BE and CN schemes. Let $t^n = n\\Delta t$.\n\n**Backward Euler (BE) Scheme**\nThe BE scheme is defined as:\n$$\ni^{n+1} = i^n + \\Delta t f(t^{n+1}, i^{n+1})\n$$\nSubstituting the function $f(t,i)$:\n$$\ni^{n+1} = i^n + \\Delta t \\left( -\\alpha i^{n+1} + \\gamma e^{-t^{n+1}/\\tau_p} \\right)\n$$\nSince the ODE is linear, we can algebraically solve for $i^{n+1}$:\n$$\ni^{n+1} + \\alpha \\Delta t i^{n+1} = i^n + \\gamma \\Delta t e^{-t^{n+1}/\\tau_p}\n$$\n$$\ni^{n+1}(1 + \\alpha \\Delta t) = i^n + \\gamma \\Delta t e^{-t^{n+1}/\\tau_p}\n$$\nThis yields the explicit update rule for the BE scheme:\n$$\ni_{\\text{BE}}^{n+1} = \\frac{i^n + \\gamma \\Delta t \\exp(-t^{n+1}/\\tau_p)}{1 + \\alpha \\Delta t}\n$$\n\n**Crank–Nicolson (CN) Scheme**\nThe CN scheme is defined as:\n$$\ni^{n+1} = i^n + \\frac{\\Delta t}{2} \\left[ f(t^n, i^n) + f(t^{n+1}, i^{n+1}) \\right]\n$$\nSubstituting the function $f(t,i)$:\n$$\ni^{n+1} = i^n + \\frac{\\Delta t}{2} \\left[ (-\\alpha i^n + \\gamma e^{-t^n/\\tau_p}) + (-\\alpha i^{n+1} + \\gamma e^{-t^{n+1}/\\tau_p}) \\right]\n$$\nAgain, we rearrange to solve for $i^{n+1}$:\n$$\ni^{n+1} = i^n - \\frac{\\alpha \\Delta t}{2} i^n - \\frac{\\alpha \\Delta t}{2} i^{n+1} + \\frac{\\gamma \\Delta t}{2} \\left( e^{-t^n/\\tau_p} + e^{-t^{n+1}/\\tau_p} \\right)\n$$\n$$\ni^{n+1} \\left( 1 + \\frac{\\alpha \\Delta t}{2} \\right) = i^n \\left( 1 - \\frac{\\alpha \\Delta t}{2} \\right) + \\frac{\\gamma \\Delta t}{2} \\left( e^{-t^n/\\tau_p} + e^{-t^{n+1}/\\tau_p} \\right)\n$$\nThis yields the explicit update rule for the CN scheme:\n$$\ni_{\\text{CN}}^{n+1} = \\frac{i^n \\left( 1 - \\frac{\\alpha \\Delta t}{2} \\right) + \\frac{\\gamma \\Delta t}{2} \\left( \\exp(-t^n/\\tau_p) + \\exp(-t^{n+1}/\\tau_p) \\right)}{1 + \\frac{\\alpha \\Delta t}{2}}\n$$\n\n**Computational Algorithm**\nFor each test case, specified by the tuple $(L, R, M, I_0, \\tau_p, \\Delta t)$, the procedure is as follows:\n\n1.  **Parameter Calculation**: Compute the derived constants:\n    -   Wall time constant: $\\tau_w = L/R$.\n    -   Normalized decay rate: $\\alpha = 1/\\tau_w = R/L$.\n    -   Normalized forcing amplitude: $\\gamma = M I_0 / (L \\tau_p)$.\n    -   Simulation end time: $T_{\\text{end}} = 10 \\max(\\tau_p, \\tau_w)$.\n\n2.  **Exact Peak Current**: Calculate the magnitude of the exact peak wall current, $|i(t_{\\text{peak}})|$.\n    -   Time of peak current: $t_{\\text{peak}} = \\frac{1}{\\alpha - 1/\\tau_p} \\ln(\\alpha \\tau_p)$.\n    -   The exact solution is $i(t) = \\frac{M I_0}{L} \\frac{1/\\tau_p}{\\alpha - 1/\\tau_p} (e^{-t/\\tau_p} - e^{-\\alpha t})$.\n    -   The exact peak current magnitude is $i_{\\text{peak, exact}} = |i(t_{\\text{peak}})|$. For the given parameters, $i(t) \\ge 0$ for $t \\ge 0$, so the absolute value is redundant.\n\n3.  **Numerical Integration**:\n    -   Determine the number of time steps, $N = \\lfloor T_{\\text{end}} / \\Delta t \\rfloor$.\n    -   Create a time grid $t^n = n \\Delta t$ for $n = 0, 1, \\dots, N$.\n    -   Initialize current arrays $i_{\\text{BE}}$ and $i_{\\text{CN}}$ of size $N+1$ with the initial condition $i^0 = 0$.\n    -   Iterate from $n = 0$ to $N-1$ to populate the arrays using the respective update formulas for $i_{\\text{BE}}^{n+1}$ and $i_{\\text{CN}}^{n+1}$.\n\n4.  **Error and Ratio Calculation**:\n    -   Find the discrete peak current magnitude for each scheme: $i_{\\text{peak, BE}} = \\max_{n} |i_{\\text{BE}}^n|$ and $i_{\\text{peak, CN}} = \\max_{n} |i_{\\text{CN}}^n|$.\n    -   Compute the relative errors:\n    $$ \\varepsilon_{\\text{BE}} = \\frac{|i_{\\text{peak, BE}} - i_{\\text{peak, exact}}|}{|i_{\\text{peak, exact}}|} $$\n    $$ \\varepsilon_{\\text{CN}} = \\frac{|i_{\\text{peak, CN}} - i_{\\text{peak, exact}}|}{|i_{\\text{peak, exact}}|} $$\n    -   Finally, compute the desired ratio:\n    $$ \\rho = \\frac{\\varepsilon_{\\text{CN}}}{\\varepsilon_{\\text{BE}}} $$\n\nThis procedure will be implemented for each of the four test cases. The known theoretical convergence rates are first-order, $O(\\Delta t)$, for BE and second-order, $O(\\Delta t^2)$, for CN. Consequently, the error ratio $\\rho$ is expected to be substantially smaller than $1$ and should scale approximately with $\\Delta t$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_error_ratio(L, R, M, I0, tau_p, dt):\n    \"\"\"\n    Computes the ratio of relative peak-current errors between the\n    Crank-Nicolson and Backward Euler schemes for a single test case.\n\n    Args:\n        L (float): Self-inductance (H)\n        R (float): Resistance (Ohm)\n        M (float): Mutual inductance (H)\n        I0 (float): Initial plasma current (A)\n        tau_p (float): Plasma current decay time (s)\n        dt (float): Time step (s)\n\n    Returns:\n        float: The ratio of errors, rho = eps_CN / eps_BE.\n    \"\"\"\n\n    # 1. Parameter Calculation\n    alpha = R / L\n    tau_w = L / R\n    gamma = M * I0 / (L * tau_p)\n    T_end = 10.0 * max(tau_p, tau_w)\n\n    # 2. Exact Peak Current Calculation\n    if np.isclose(alpha * tau_p, 1.0):\n        # This case is excluded by the problem statement validation.\n        raise ValueError(\"The special case alpha * tau_p = 1 is not handled.\")\n\n    t_peak = (1.0 / (alpha - 1.0 / tau_p)) * np.log(alpha * tau_p)\n    \n    prefactor = (M * I0 / L) * (1.0 / tau_p) / (alpha - 1.0 / tau_p)\n    \n    i_peak_exact = prefactor * (np.exp(-t_peak / tau_p) - np.exp(-alpha * t_peak))\n\n    # 3. Numerical Integration\n    num_steps = int(T_end / dt)\n    t = np.linspace(0, num_steps * dt, num_steps + 1)\n    \n    i_be = np.zeros(num_steps + 1)\n    i_cn = np.zeros(num_steps + 1)\n    i_be[0] = 0.0\n    i_cn[0] = 0.0\n\n    # Pre-compute constants for the loop\n    # Backward Euler\n    be_denom = 1.0 + alpha * dt\n    be_num_term2_factor = gamma * dt\n    # Crank-Nicolson\n    cn_denom = 1.0 + alpha * dt / 2.0\n    cn_num_term1_factor = 1.0 - alpha * dt / 2.0\n    cn_num_term2_factor = gamma * dt / 2.0\n\n    # Time-stepping loop\n    for n in range(num_steps):\n        t_n = t[n]\n        t_n1 = t[n+1]\n        \n        # Forcing term evaluations\n        exp_n = np.exp(-t_n / tau_p)\n        exp_n1 = np.exp(-t_n1 / tau_p)\n\n        # Backward Euler update\n        i_be[n+1] = (i_be[n] + be_num_term2_factor * exp_n1) / be_denom\n\n        # Crank-Nicolson update\n        cn_num_term1 = i_cn[n] * cn_num_term1_factor\n        cn_num_term2 = cn_num_term2_factor * (exp_n + exp_n1)\n        i_cn[n+1] = (cn_num_term1 + cn_num_term2) / cn_denom\n        \n    # 4. Error and Ratio Calculation\n    i_peak_be = np.max(np.abs(i_be))\n    i_peak_cn = np.max(np.abs(i_cn))\n\n    eps_be = np.abs(i_peak_be - i_peak_exact) / np.abs(i_peak_exact)\n    eps_cn = np.abs(i_peak_cn - i_peak_exact) / np.abs(i_peak_exact)\n\n    if np.isclose(eps_be, 0.0):\n        if np.isclose(eps_cn, 0.0):\n            return 1.0  # Or 0.0, but this indicates both are exact\n        else:\n            return np.inf\n\n    rho = eps_cn / eps_be\n    return rho\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, R, M, I0, tau_p, dt)\n        (1.0e-3, 2.0e-1, 5.0e-6, 1.0e6, 1.0e-2, 2.0e-3), # Case A\n        (1.0e-3, 2.0e-1, 5.0e-6, 1.0e6, 5.0e-4, 5.0e-4), # Case B\n        (2.0e-3, 5.0e-2, 1.0e-5, 5.0e5, 2.0e-2, 5.0e-3), # Case C\n        (5.0e-4, 5.0e-1, 2.0e-6, 2.0e6, 2.0e-3, 1.0e-3), # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_error_ratio(*case)\n        results.append(f\"{result:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Accurate spatial discretization is as critical as stable time integration, particularly when modeling components with complex geometries. This advanced exercise explores the impact of geometric singularities, such as re-entrant corners, on the accuracy of numerical solutions. By performing a computational $h$-refinement study for a problem with a known analytical solution, you will numerically estimate the convergence rate of a standard interpolation method and see firsthand how solution regularity limits numerical accuracy, a vital concept for reliable engineering simulations .",
            "id": "3969843",
            "problem": "Consider a two-dimensional conducting wedge of opening angle $\\alpha$ in polar coordinates $(r,\\theta)$ with $r \\in [0,R]$ and $\\theta \\in [0,\\alpha]$. Assume harmonic excitation with angular frequency $\\omega$, constant magnetic permeability $\\mu$, and electrical conductivity $\\sigma$, and adopt the Transverse Electric (TE) polarization where the out-of-plane magnetic vector potential $A_z(r,\\theta)$ (hereafter denoted by $A$) governs the eddy current response under the magneto-quasistatic approximation. Starting from Maxwell’s equations and Ohm’s law, one arrives at a scalar diffusion equation for the complex-valued harmonic amplitude $A$ in the conducting region. For constant material properties and negligible displacement current, the governing equation reduces to a homogeneous modified Helmholtz equation of the form\n$$\n\\nabla^2 A - k^2 A = 0,\n$$\nwhere $k^2 = i\\,\\omega\\,\\mu\\,\\sigma$, and Dirichlet boundary conditions $A(r,0)=0$, $A(r,\\alpha)=0$. On the outer boundary $r=R$, prescribe Dirichlet data consistent with a separable solution.\n\nUse the known separable solution family in a wedge, with the angular factor $\\sin(\\lambda \\theta)$ for $\\lambda = \\pi/\\alpha$, and the radial factor given by the modified Bessel function of the first kind $I_\\lambda$, to define the exact solution\n$$\nA_{\\text{exact}}(r,\\theta) = I_{\\lambda}\\!\\big(k\\,r\\big)\\,\\sin(\\lambda\\,\\theta),\n$$\nwhich is regular at $r=0$ for $\\lambda>0$ and exhibits a corner singularity in its gradient for $\\alpha>\\pi$ (equivalently $\\lambda<1$). Define the derived current density amplitude $J_z$ (hereafter denoted by $J$) by the TE relation\n$$\nJ = -i\\,\\omega\\,\\sigma\\,A,\n$$\nunder the Coulomb gauge with negligible scalar potential.\n\nPerform an $h$-refinement study by approximating $A_{\\text{exact}}$ with a piecewise bilinear interpolant on a uniform tensor-product polar grid in $(r,\\theta)$, with $N_r$ intervals in $r$ and $N_\\theta$ intervals in $\\theta$. For each mesh, define the characteristic mesh size\n$$\nh = \\max\\left(\\Delta r,\\, R\\,\\Delta\\theta\\right) = \\max\\left(\\frac{R}{N_r},\\, \\frac{R\\,\\alpha}{N_\\theta}\\right).\n$$\nCompute the $L^2$ norm of the interpolation error for $A$ and for $J$ over the wedge domain with respect to the polar-area measure:\n$$\n\\|e_A\\|_{L^2(\\Omega)} = \\left(\\int_{0}^{R}\\int_{0}^{\\alpha} \\left|A_{\\text{exact}}(r,\\theta) - A_{\\text{interp}}(r,\\theta)\\right|^2\\, r\\, d\\theta\\, dr\\right)^{1/2},\n$$\n$$\n\\|e_J\\|_{L^2(\\Omega)} = \\left(\\int_{0}^{R}\\int_{0}^{\\alpha} \\left|J_{\\text{exact}}(r,\\theta) - J_{\\text{interp}}(r,\\theta)\\right|^2\\, r\\, d\\theta\\, dr\\right)^{1/2}.\n$$\nEstimate the convergence rates $p_A$ and $p_J$ defined by the slope of $\\log\\|e\\|$ versus $\\log h$ using at least three successive refinements, where $\\|e\\|$ is the $L^2$ norm of the error for $A$ and for $J$, respectively. Use product Gauss–Legendre quadrature with three points per direction on each cell to approximate the integrals.\n\nAdopt the following physically plausible parameters:\n- $R = 1$ (meters),\n- $\\mu = 4\\pi\\times 10^{-7}$ (Henries per meter),\n- $\\sigma = 10^{6}$ (Siemens per meter),\n- $\\omega = 10^{3}$ (radians per second).\n\nUse three refinement levels $N \\in \\{16,32,64\\}$ with $N_r = N_\\theta = N$.\n\nProvide a test suite consisting of three wedge angles to probe different regularity regimes:\n- Test $1$: $\\alpha = \\frac{\\pi}{2}$ (a smooth corner, no reentrant behavior),\n- Test $2$: $\\alpha = \\frac{3\\pi}{2}$ (a reentrant corner with $\\lambda = \\frac{2}{3}$),\n- Test $3$: $\\alpha = 1.9\\pi$ (a more severe reentrant corner).\n\nFor each test case, estimate $p_A$ and $p_J$ using a linear regression of $\\log\\|e\\|$ versus $\\log h$ over the three refinements. Since $p_A$ and $p_J$ are dimensionless exponents, express the final outputs as decimal floats without units.\n\nYour program should produce a single line of output containing the six estimated rates for the three tests in order, as a comma-separated list enclosed in square brackets, specifically\n$$\n\\left[p_A^{(1)},\\,p_J^{(1)},\\,p_A^{(2)},\\,p_J^{(2)},\\,p_A^{(3)},\\,p_J^{(3)}\\right].\n$$",
            "solution": "The user has provided a scientifically valid and well-posed problem in computational electromagnetics. The task is to perform a numerical $h$-refinement study to estimate the convergence rates of a piecewise bilinear interpolation scheme for a specific analytical solution to the magnetic vector potential diffusion equation in a wedge-shaped domain.\n\nThe problem is grounded in the magneto-quasistatic (MQS) approximation of Maxwell's equations, which is appropriate for low-frequency electromagnetic phenomena in good conductors where displacement currents are negligible. For a time-harmonic excitation with angular frequency $\\omega$ and Transverse Electric (TE) polarization, the out-of-plane component of the magnetic vector potential, $A_z$ (denoted as $A$), in a homogeneous medium with magnetic permeability $\\mu$ and electrical conductivity $\\sigma$, is governed by the modified Helmholtz equation:\n$$\n\\nabla^2 A - k^2 A = 0\n$$\nwhere $k^2 = i\\,\\omega\\,\\mu\\,\\sigma$ and $i = \\sqrt{-1}$. The complex constant $k$ has a magnitude related to the electromagnetic skin depth, $\\delta = \\sqrt{2/(\\omega\\mu\\sigma)}$.\n\nThe domain is a two-dimensional wedge in polar coordinates $(r,\\theta)$ defined by $r \\in [0,R]$ and $\\theta \\in [0,\\alpha]$. The problem specifies homogeneous Dirichlet boundary conditions, $A(r,0)=0$ and $A(r,\\alpha)=0$. A standard technique for solving such a partial differential equation is separation of variables, $A(r,\\theta) = f(r)g(\\theta)$. The boundary conditions on $\\theta$ lead to an angular solution of the form $g(\\theta) = \\sin(\\lambda\\theta)$ with $\\lambda = n\\pi/\\alpha$. The problem considers the fundamental mode, $n=1$, so $\\lambda = \\pi/\\alpha$. The radial function $f(r)$ must then satisfy a modified Bessel's equation. The solution that remains regular at the origin $r=0$ is the modified Bessel function of the first kind of order $\\lambda$, denoted $I_\\lambda$. This leads to the exact analytical solution:\n$$\nA_{\\text{exact}}(r,\\theta) = I_{\\lambda}\\!\\big(k\\,r\\big)\\,\\sin(\\lambda\\,\\theta)\n$$\nThe regularity of this solution is determined by the exponent $\\lambda$. Near the origin ($r \\to 0$), the behavior is $A_{\\text{exact}}(r,\\theta) \\sim r^\\lambda \\sin(\\lambda\\theta)$. The gradient of the solution, $\\nabla A_{\\text{exact}}$, behaves like $r^{\\lambda-1}$. If the wedge angle $\\alpha > \\pi$, then $\\lambda < 1$, and the gradient becomes singular at the corner $r=0$. This is a well-known phenomenon in elliptic PDEs on non-convex domains. The severity of the singularity increases as $\\alpha$ increases towards $2\\pi$ (and $\\lambda$ decreases towards $1/2$). The three test cases, $\\alpha=\\pi/2$, $\\alpha=3\\pi/2$, and $\\alpha=1.9\\pi$, correspond to $\\lambda=2$ (smooth solution), $\\lambda=2/3$ (singular gradient), and $\\lambda=1/1.9 \\approx 0.526$ (more singular gradient), respectively.\n\nThe current density $J_z$ (denoted $J$) is given by $J = -i\\,\\omega\\,\\sigma\\,A$. Since $J$ is a constant multiple of $A$, it possesses the same spatial regularity and its interpolation error is expected to converge at the same rate. Thus, we theoretically expect $p_A = p_J$.\n\nThe core of the task is to perform a numerical convergence study. The exact solution $A_{\\text{exact}}$ is approximated by a piecewise bilinear interpolant, $A_{\\text{interp}}$, on a uniform tensor-product grid in the $(r,\\theta)$ plane. The convergence of this interpolation is measured by the $L^2$ norm of the error, $\\|e_A\\|_{L^2(\\Omega)}$ and $\\|e_J\\|_{L^2(\\Omega)}$, where the integration is performed over the wedge domain $\\Omega$ with the area element $r\\,dr\\,d\\theta$. According to interpolation theory, for a function $u$ with Sobolev regularity $u \\in H^s(\\Omega)$, the $L^2$ error of its piecewise bilinear interpolant $I_h u$ scales as $\\|u - I_h u\\|_{L^2(\\Omega)} \\propto h^{\\min(2, s)}$, where $h$ is the mesh size. The regularity $s$ of the function $A_{\\text{exact}} \\sim r^\\lambda$ is limited by the corner singularity and can be shown to be $s < \\lambda+1$. Therefore, the expected convergence rate is $p = \\min(2, \\lambda+1)$.\n- For Test 1 ($\\alpha=\\pi/2, \\lambda=2$): Expected rate $p = \\min(2, 2+1) = 2$.\n- For Test 2 ($\\alpha=3\\pi/2, \\lambda=2/3$): Expected rate $p = \\min(2, 2/3+1) = 5/3 \\approx 1.667$.\n- For Test 3 ($\\alpha=1.9\\pi, \\lambda=1/1.9 \\approx 0.526$): Expected rate $p = \\min(2, 1/1.9+1) \\approx 1.526$.\n\nThe algorithm to estimate these rates is as follows:\n1.  For each test case $\\alpha \\in \\{\\pi/2, 3\\pi/2, 1.9\\pi\\}$:\n2.  For each refinement level $N \\in \\{16, 32, 64\\}$, set $N_r=N_\\theta=N$ and define the grid.\n3.  Calculate the characteristic mesh size $h = \\max(R/N_r, R\\alpha/N_\\theta)$.\n4.  Subdivide the domain into $N_r \\times N_\\theta$ cells. For each cell $[r_i, r_{i+1}] \\times [\\theta_j, \\theta_{j+1}]$:\n    a. Define the bilinear interpolant $A_{\\text{interp}}$ based on the four corner values of $A_{\\text{exact}}$.\n    b. Numerically compute the integral of the squared error $|A_{\\text{exact}} - A_{\\text{interp}}|^2$ over the cell using a $3 \\times 3$ product Gauss-Legendre quadrature rule, correctly including the Jacobian factor $r$ for polar coordinates.\n5.  Sum the contributions from all cells to obtain the total squared $L^2$ error for $A$, and take the square root to find $\\|e_A\\|_{L^2}$. The error for $J$ is then $\\|e_J\\|_{L^2} = \\omega\\sigma\\|e_A\\|_{L^2}$.\n6.  Collect the pairs $(\\log h, \\log \\|e_A\\|)$ and $(\\log h, \\log \\|e_J\\|)$ for the three refinement levels.\n7.  Perform a linear regression (least-squares fit) on these log-log data points. The slope of the resulting line is the estimated convergence rate, $p_A$ or $p_J$.\n8.  Collect the six rates and format the output as specified.\n\nThis procedure rigorously implements the specified numerical experiment to verify the impact of geometric singularities on the convergence of a standard interpolation method.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import iv\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Performs an h-refinement study for bilinear interpolation error of\n    the magnetic vector potential in a conducting wedge.\n    \"\"\"\n\n    # Define physical parameters\n    R = 1.0  # meters\n    mu = 4.0 * np.pi * 1e-7  # Henries per meter\n    sigma = 1.0e6  # Siemens per meter\n    omega = 1.0e3  # radians per second\n\n    # Derived physical constant k\n    k_sq = 1j * omega * mu * sigma\n    k = np.sqrt(k_sq)\n\n    # Gauss-Legendre quadrature setup (3 points on [0,1])\n    n_gauss = 3\n    # Get standard points and weights on [-1, 1]\n    gp_11, gw_11 = leggauss(n_gauss)\n    # Map to [0, 1] for local cell coordinates\n    gp_01 = 0.5 * (gp_11 + 1.0)\n    gw_01 = 0.5 * gw_11\n\n    # Define test cases and refinement levels\n    test_cases = [np.pi / 2.0, 3.0 * np.pi / 2.0, 1.9 * np.pi]\n    refinement_levels = [16, 32, 64]\n\n    all_rates = []\n\n    for alpha in test_cases:\n        # Calculate lambda for the current wedge angle\n        lam = np.pi / alpha\n\n        # Define the exact solution A(r, theta)\n        def A_exact(r, theta):\n            # The complex argument to iv is handled by scipy\n            # For r=0, A is 0 because iv(lam, 0) = 0 for lam > 0, which is true here.\n            # Scipy's iv handles scalar and array inputs correctly.\n            return iv(lam, k * r) * np.sin(lam * theta)\n\n        log_h_vals = []\n        log_err_A_vals = []\n        log_err_J_vals = []\n\n        for N in refinement_levels:\n            Nr, Ntheta = N, N\n            dr = R / Nr\n            dtheta = alpha / Ntheta\n            h = max(dr, R * dtheta)\n            log_h_vals.append(np.log(h))\n\n            # Grid nodes\n            r_nodes = np.linspace(0, R, Nr + 1)\n            theta_nodes = np.linspace(0, alpha, Ntheta + 1)\n\n            total_error_A_sq = 0.0\n\n            # Loop over all cells in the grid\n            for i in range(Nr):\n                for j in range(Ntheta):\n                    # Current cell boundaries\n                    r_i, r_i1 = r_nodes[i], r_nodes[i+1]\n                    th_j, th_j1 = theta_nodes[j], theta_nodes[j+1]\n\n                    # Exact solution at cell corners for bilinear interpolation\n                    A_vals_at_corners = A_exact(\n                        np.array([[r_i, r_i1], [r_i, r_i1]]),\n                        np.array([[th_j, th_j], [th_j1, th_j1]])\n                    )\n                    A00, A10 = A_vals_at_corners[0, 0], A_vals_at_corners[0, 1]\n                    A01, A11 = A_vals_at_corners[1, 0], A_vals_at_corners[1, 1]\n                    \n                    cell_error_sq = 0.0\n                    \n                    # Apply 3x3 product Gauss quadrature over the cell\n                    for m in range(n_gauss):\n                        xi_m = gp_01[m]\n                        w_xi = gw_01[m]\n                        r_at_gp = r_i + xi_m * dr\n                        \n                        for n in range(n_gauss):\n                            eta_n = gp_01[n]\n                            w_eta = gw_01[n]\n                            theta_at_gp = th_j + eta_n * dtheta\n                            \n                            # Bilinear interpolation at the quadrature point\n                            A_interp = (A00 * (1 - xi_m) * (1 - eta_n) +\n                                        A10 * xi_m * (1 - eta_n) +\n                                        A01 * (1 - xi_m) * eta_n +\n                                        A11 * xi_m * eta_n)\n                            \n                            # Exact value at the quadrature point\n                            A_ex = A_exact(r_at_gp, theta_at_gp)\n                            \n                            # Integrand for L2 error norm, including area element 'r'\n                            integrand = np.abs(A_ex - A_interp)**2 * r_at_gp\n                            \n                            cell_error_sq += w_xi * w_eta * integrand\n                    \n                    # Add cell's contribution to total error (with dV = dr * dtheta)\n                    total_error_A_sq += cell_error_sq * dr * dtheta\n\n            # Calculate L2 error norms for this refinement level\n            err_A = np.sqrt(total_error_A_sq)\n            err_J = omega * sigma * err_A\n            \n            log_err_A_vals.append(np.log(err_A))\n            log_err_J_vals.append(np.log(err_J))\n        \n        # Estimate convergence rates using linear regression on log-log data\n        p_A, _ = np.polyfit(log_h_vals, log_err_A_vals, 1)\n        p_J, _ = np.polyfit(log_h_vals, log_err_J_vals, 1)\n\n        all_rates.extend([p_A, p_J])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{rate:.10f}' for rate in all_rates)}]\")\n\n\nsolve()\n```"
        }
    ]
}