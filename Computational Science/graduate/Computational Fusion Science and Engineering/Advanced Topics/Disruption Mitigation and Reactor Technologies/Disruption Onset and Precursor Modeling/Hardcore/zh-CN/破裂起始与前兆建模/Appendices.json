{
    "hands_on_practices": [
        {
            "introduction": "在等离子体物理中，理解各种物理过程的时间尺度至关重要。电阻扩散时间是一个基本的参考基准，它描述了等离子体电流分布在没有剧烈不稳定性的情况下的自然演化速率。本练习将引导你从第一性原理（麦克斯韦方程组和欧姆定律）出发，推导这个关键的时间尺度。通过这个实践，你将巩固对等离子体电阻如何主导电流轮廓弛豫的理解，并为区分托卡马克破裂中的快、慢电流淬灭过程建立一个重要的物理判据。",
            "id": "3967853",
            "problem": "在计算聚变科学与工程中的破裂起始和前兆建模背景下，考虑一个大环径比、圆形截面、小半径为 $a$ 的托卡马克等离子体中环向电流剖面的电阻弛豫。在电阻磁流体力学（RMHD）框架内进行分析，从单流体磁流体力学（MHD）的欧姆定律和 Maxwell 方程组出发。假设在电流猝灭阶段电阻率 $\\eta$ 是均匀的标量，并忽略流动效应（即，设 $\\mathbf{v} \\approx \\mathbf{0}$）。使用 Faraday 定律和 Ampère 定律，并忽略位移电流，推导磁场和电流剖面弛豫的特征电阻扩散时间尺度，用 $a$、$\\eta$ 和真空磁导率 $\\mu_{0}$ 表示。然后，给定 $a = 0.6\\,\\mathrm{m}$ 和 $\\eta = 5 \\times 10^{-5}\\,\\Omega\\,\\mathrm{m}$，使用 $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H}\\,\\mathrm{m}^{-1}$ 计算此时间尺度。从概念上解释此时间尺度如何为区分托卡马克破裂中的快、慢电流猝灭提供一个判据。将最终数值答案四舍五入至四位有效数字。以秒为单位表示该时间尺度。",
            "solution": "问题是在一个简化的托卡马克模型中推导特征电阻扩散时间尺度，然后根据给定参数计算其值。这个时间尺度对于理解等离子体破裂中电流猝灭阶段的动力学至关重要。\n\n首先，确认问题陈述的有效性。该问题在科学上基于电阻磁流体力学（RMHD），这是等离子体物理学中的一个标准模型。这是一个适定问题，提供了所有必要的物理假设和数据（$\\mathbf{v} \\approx \\mathbf{0}$、均匀标量电阻率 $\\eta$、可忽略的位移电流），以推导出一个唯一的、有意义的时间尺度。所给出的数值对于托卡马克等离子体在破裂期间是物理上合理的。该问题是自洽的、客观的，并且与指定的破裂建模主题直接相关。因此，我们开始求解。\n\n推导从 RMHD 的基本方程开始。单流体 MHD 欧姆定律由下式给出：\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}\n$$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{v}$ 是流体速度，$\\mathbf{B}$ 是磁场，$\\eta$ 是等离子体电阻率，$\\mathbf{J}$ 是电流密度。\n\n问题要求忽略流动效应，因此我们设 $\\mathbf{v} = \\mathbf{0}$。欧姆定律简化为：\n$$\n\\mathbf{E} = \\eta \\mathbf{J}\n$$\n接下来，我们使用 Maxwell 方程组中的 Faraday 感应定律：\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n将简化的欧姆定律代入 Faraday 定律，我们得到：\n$$\n\\nabla \\times (\\eta \\mathbf{J}) = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n问题假设电阻率 $\\eta$ 是一个均匀的标量，可以从旋度算子中提出：\n$$\n\\eta (\\nabla \\times \\mathbf{J}) = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n为了将电流密度 $\\mathbf{J}$ 与磁场 $\\mathbf{B}$ 联系起来，我们使用 Ampère 定律，并假设位移电流（$\\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$）可以忽略，这对于 RMHD 特有的低频现象是一个极好的近似。\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}\n$$\n其中 $\\mu_0$ 是真空磁导率。我们可以将 $\\mathbf{J}$ 表示为 $\\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}$。将其代入我们的演化方程中得到：\n$$\n\\eta \\left( \\nabla \\times \\left( \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B} \\right) \\right) = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n由于 $\\mu_0$ 是一个常数，我们可以写成：\n$$\n\\frac{\\eta}{\\mu_0} \\nabla \\times (\\nabla \\times \\mathbf{B}) = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n现在我们使用矢量微积分恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$。将其应用于 $\\mathbf{B}$：\n$$\n\\frac{\\eta}{\\mu_0} \\left( \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B} \\right) = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n从 Maxwell 方程组的另一个方程可知，磁场是无散的，即 $\\nabla \\cdot \\mathbf{B} = 0$。因此方程简化为：\n$$\n\\frac{\\eta}{\\mu_0} (-\\nabla^2 \\mathbf{B}) = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n整理后得到磁扩散方程：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\frac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B}\n$$\n这是一个标准形式为 $\\frac{\\partial f}{\\partial t} = D \\nabla^2 f$ 的扩散方程，其中 $D = \\frac{\\eta}{\\mu_0}$ 是磁扩散系数。根据量纲分析，一个扩散过程在特征长度尺度 $L$ 上发生的特征时间 $\\tau$ 由 $\\tau \\sim \\frac{L^2}{D}$ 给出。在我们的情况中，等离子体的特征长度尺度是其小半径 $a$。因此，特征电阻扩散时间尺度（记为 $\\tau_R$）是：\n$$\n\\tau_R = \\frac{a^2}{D} = \\frac{\\mu_0 a^2}{\\eta}\n$$\n这个时间尺度控制着等离子体内部磁场以及由其延伸的电流的弛豫。\n\n接下来，我们使用所提供的数据计算 $\\tau_R$ 的数值：\n- 小半径 $a = 0.6\\,\\mathrm{m}$\n- 电阻率 $\\eta = 5 \\times 10^{-5}\\,\\Omega\\,\\mathrm{m}$\n- 真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H}\\,\\mathrm{m}^{-1}$\n\n将这些值代入推导出的公式：\n$$\n\\tau_R = \\frac{(4\\pi \\times 10^{-7}\\,\\mathrm{H}\\,\\mathrm{m}^{-1}) \\times (0.6\\,\\mathrm{m})^2}{5 \\times 10^{-5}\\,\\Omega\\,\\mathrm{m}}\n$$\n$$\n\\tau_R = \\frac{4\\pi \\times 10^{-7} \\times 0.36}{5 \\times 10^{-5}}\\,\\mathrm{s}\n$$\n$$\n\\tau_R = \\frac{1.44\\pi}{5} \\times 10^{-2}\\,\\mathrm{s}\n$$\n$$\n\\tau_R \\approx 0.288 \\times 3.14159265... \\times 10^{-2}\\,\\mathrm{s} \\approx 0.904778...\\times 10^{-2}\\,\\mathrm{s}\n$$\n$$\n\\tau_R \\approx 0.00904778...\\,\\mathrm{s}\n$$\n四舍五入到四位有效数字，时间尺度为 $0.009048\\,\\mathrm{s}$。\n\n最后，我们解释这个时间尺度的概念意义。托卡马克破裂中的电流猝灭（CQ）是等离子体电流迅速衰减的过程。电阻扩散时间尺度 $\\tau_R$ 代表了如果电流衰减仅由等离子体电阻率决定时，该过程发生的“自然”时间尺度。\n它作为一个关键基准，用于对电流猝灭的严重性进行分类：\n- **慢电流猝灭**：如果观测到的电流猝灭持续时间 $\\Delta t_{CQ}$ 与电阻时间尺度相当或更长（$\\Delta t_{CQ} \\gtrsim \\tau_R$），则该事件被认为是慢猝灭。在这种情况下，电流剖面的弛豫受限于电阻扩散，等离子体可以通过一系列准平衡态演化。虽然这仍然是不希望发生的情况，但其剧烈程度较低。\n- **快电流猝灭**：如果观测到的持续时间远短于电阻时间尺度（$\\Delta t_{CQ} \\ll \\tau_R$），则该事件是快猝灭。这意味着一个比经典电阻扩散快得多的过程主导了电流衰减。这通常是由于大规模 MHD 不稳定性的快速发展，导致磁力线随机化以及热能和载流电子向容器壁的快速损失。这些快猝灭会在托卡马克结构上引起大得多的电磁力，危险性也显著更高。\n\n因此，将测量的 $\\Delta t_{CQ}$ 与计算的 $\\tau_R$ 进行比较，是理解破裂事件的内在物理机制和严重性的一个主要诊断方法。",
            "answer": "$$\n\\boxed{0.009048}\n$$"
        },
        {
            "introduction": "在建立了缓慢的电阻扩散时间尺度之后，我们现在将探讨能够以快得多的速率发展的物理机制。本练习聚焦于撕裂模——一种引发破裂的主要不稳定性——通过计算其稳定性参数 $Δ'$ 。通过求解一个经典等离子体平衡位形的控制方程，你将获得评估等离子体稳定性的实践经验，并理解为何特定的位形倾向于形成磁岛，这种结构正是完全破裂的前兆。",
            "id": "3967937",
            "problem": "考虑托卡马克等离子体中有理面上用于破裂前兆建模的局域平板近似。平衡磁场取为$\\mathbf{B}_{0}(x) = B_{y}(x)\\,\\hat{\\mathbf{y}}$，其中$B_{y}(x) = B_{0}\\,\\tanh(x/L)$，$L$是电流片半宽度，$B_{0}$是一个常数。磁通的撕裂模扰动由一个磁通函数$\\psi(x)$表示，使得扰动磁场为$\\delta \\mathbf{B} = \\hat{\\mathbf{z}} \\times \\nabla \\psi$，扰动在可忽略方向$y$上以$\\exp(i k_{y} y)$的形式变化。\n\n在理想外部区域，标量磁通函数$\\psi(x)$服从经过充分检验的、适用于平板理想磁流体力学（MHD）的Newcomb方程：\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - k_{y}^{2}\\,\\psi - \\frac{B_{y}''(x)}{B_{y}(x)}\\,\\psi = 0,\n$$\n在$x \\neq 0$时有效。施加外部边界条件，要求在电流片两侧，当$|x| \\to \\infty$时$\\psi(x)$衰减。定义经典撕裂模不稳定性参数\n$$\n\\Delta' \\equiv \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)},\n$$\n其中撇号表示对$x$的微分，并采用跨越内部电阻层的常数-$\\psi$近似。\n\n对于给定的平衡剖面$B_{y}(x) = B_{0}\\,\\tanh(x/L)$，通过在$x>0$和$x0$上分别求解外部区域方程，根据常数-$\\psi$近似的要求在$x=0$处匹配解，并应用无穷远处的衰减条件，计算$\\Delta'$。将你的最终结果表示为以$k_{y}$和$L$为变量的闭合形式解析表达式。\n\n然后，使用你的表达式，在长波极限$k_{y} L \\ll 1$下估算$\\Delta'$的符号及其随$k_{y} L$变化的标度关系，并简要说明其对电阻性撕裂模初发时磁岛增长的影响。不需要进行数值取整；将$\\Delta'$的解析表达式作为你的最终答案。",
            "solution": "在尝试求解之前，先评估问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- **平衡磁场：** $\\mathbf{B}_{0}(x) = B_{y}(x)\\,\\hat{\\mathbf{y}}$，其中$B_{y}(x) = B_{0}\\,\\tanh(x/L)$。\n- **常数：** $L$是电流片半宽度；$B_{0}$是恒定磁场振幅。\n- **扰动：** 扰动磁场为$\\delta \\mathbf{B} = \\hat{\\mathbf{z}} \\times \\nabla \\psi$，扰动以$\\exp(i k_{y} y)$的形式变化。\n- **控制方程：** 磁通函数$\\psi(x)$在外部区域（$x \\neq 0$）服从理想MHD Newcomb方程：\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - k_{y}^{2}\\,\\psi - \\frac{B_{y}''(x)}{B_{y}(x)}\\,\\psi = 0\n$$\n- **边界条件：** 当$|x| \\to \\infty$时，$\\psi(x) \\to 0$。\n- **近似：** 使用常数-$\\psi$近似，意味着$\\psi(x)$在$x=0$处的内层是连续的。\n- **定义：** 撕裂模不稳定性参数定义为：\n$$\n\\Delta' \\equiv \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)}\n$$\n- **目标：** 计算$\\Delta'$作为$k_y$和$L$的函数，并分析长波极限。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是针对Harris片平衡（$B_y \\propto \\tanh(x/L)$）的平板几何中撕裂模不稳定性的经典表述。所有要素——平衡、控制方程（平板形式的Newcomb方程）、常数-$\\psi$近似以及$\\Delta'$的定义——都是电阻性磁流体力学和破裂建模的基石。该问题在科学上和事实上都是合理的。\n- **适定性：** 该问题提供了一个二阶线性常微分方程，具有明确的无穷远处边界条件和原点处的匹配条件。这种结构保证了解在归一化常数内的唯一性，这对于归一化量$\\Delta'$来说是足够的。该问题是适定的。\n- **客观性：** 问题以精确、形式化的数学和物理语言陈述，没有歧义或主观论断。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学依据、适定、客观且完整。将推导其解。\n\n第一步是为给定的平衡剖面$B_{y}(x) = B_{0}\\,\\tanh(x/L)$计算项$\\frac{B_{y}''(x)}{B_{y}(x)}$。令$\\xi = x/L$。\n关于$x$的一阶导数是：\n$$\nB_{y}'(x) = \\frac{d}{dx} \\left( B_{0} \\tanh\\left(\\frac{x}{L}\\right) \\right) = \\frac{B_{0}}{L} \\text{sech}^{2}\\left(\\frac{x}{L}\\right)\n$$\n二阶导数是：\n$$\nB_{y}''(x) = \\frac{d}{dx} \\left( \\frac{B_{0}}{L} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\right) = \\frac{B_{0}}{L} \\left( 2\\,\\text{sech}\\left(\\frac{x}{L}\\right) \\cdot \\left(-\\text{sech}\\left(\\frac{x}{L}\\right)\\tanh\\left(\\frac{x}{L}\\right)\\right) \\cdot \\frac{1}{L} \\right) = -\\frac{2B_{0}}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\tanh\\left(\\frac{x}{L}\\right)\n$$\n该比值为：\n$$\n\\frac{B_{y}''(x)}{B_{y}(x)} = \\frac{-\\frac{2B_{0}}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\tanh\\left(\\frac{x}{L}\\right)}{B_{0} \\tanh\\left(\\frac{x}{L}\\right)} = -\\frac{2}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right)\n$$\n此表达式在$x \\neq 0$时有效。将其代入Newcomb方程得到：\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - k_{y}^{2}\\,\\psi - \\left(-\\frac{2}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right)\\right)\\,\\psi = 0\n$$\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - \\left( k_{y}^{2} - \\frac{2}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\right)\\,\\psi = 0\n$$\n这是一个具有Pöschl-Teller势的类薛定谔方程。该方程的独立解是已知的。我们需要构造一个满足边界条件$\\psi(x) \\to 0$当$|x| \\to \\infty$的解。这需要在区域$x>0$和$x0$上为基本解选择不同的线性组合。\n\n当$x \\to \\infty$时衰减的解由下式给出：\n$$\n\\psi_{1}(x) = \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(-k_{y}x)\n$$\n当$x \\to -\\infty$时衰减的解由下式给出：\n$$\n\\psi_{2}(x) = \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(k_{y}x)\n$$\n我们分段构造全局解，其中$C$为任意常数：\n$$\n\\psi(x) = \\begin{cases} C \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(-k_{y}x)  \\text{当 } x > 0 \\\\ C \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(k_{y}x)  \\text{当 } x  0 \\end{cases}\n$$\n常数-$\\psi$近似意味着$\\psi(x)$在$x=0$处是连续的。\n对于$x \\to 0^{+}$，$\\psi(0^{+}) = C (\\tanh(0) + k_{y}L) \\exp(0) = C k_{y}L$。\n对于$x \\to 0^{-}$，$\\psi(0^{-}) = C (-\\tanh(0) + k_{y}L) \\exp(0) = C k_{y}L$。\n选择这样的解满足了连续性。我们确定$\\psi(0) = C k_{y}L$，这意味着当$k_{y}L \\neq 0$时，$C = \\frac{\\psi(0)}{k_{y}L}$。\n\n接下来，我们计算导数$\\psi'(0^{+})$和$\\psi'(0^{-})$。\n对于$x>0$：\n$$\n\\psi'(x) = C \\frac{d}{dx} \\left[ \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(-k_{y}x) \\right]\n$$\n$$\n\\psi'(x) = C \\left[ \\left(\\frac{1}{L}\\text{sech}^{2}\\left(\\frac{x}{L}\\right)\\right)\\exp(-k_{y}x) + \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right)(-k_{y})\\exp(-k_{y}x) \\right]\n$$\n在$x \\to 0^{+}$时求值：\n$$\n\\psi'(0^{+}) = C \\left[ \\frac{1}{L}\\text{sech}^{2}(0) - k_{y}(\\tanh(0) + k_{y}L) \\right] = C \\left( \\frac{1}{L} - k_{y}^{2}L \\right)\n$$\n代入$C=\\frac{\\psi(0)}{k_{y}L}$：\n$$\n\\psi'(0^{+}) = \\frac{\\psi(0)}{k_{y}L} \\left( \\frac{1}{L} - k_{y}^{2}L \\right) = \\psi(0) \\left( \\frac{1}{k_{y}L^{2}} - k_{y} \\right)\n$$\n对于$x0$：\n$$\n\\psi'(x) = C \\frac{d}{dx} \\left[ \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(k_{y}x) \\right]\n$$\n$$\n\\psi'(x) = C \\left[ \\left(-\\frac{1}{L}\\text{sech}^{2}\\left(\\frac{x}{L}\\right)\\right)\\exp(k_{y}x) + \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right)(k_{y})\\exp(k_{y}x) \\right]\n$$\n在$x \\to 0^{-}$时求值：\n$$\n\\psi'(0^{-}) = C \\left[ -\\frac{1}{L}\\text{sech}^{2}(0) + k_{y}(-\\tanh(0) + k_{y}L) \\right] = C \\left( -\\frac{1}{L} + k_{y}^{2}L \\right)\n$$\n代入$C=\\frac{\\psi(0)}{k_{y}L}$：\n$$\n\\psi'(0^{-}) = \\frac{\\psi(0)}{k_{y}L} \\left( -\\frac{1}{L} + k_{y}^{2}L \\right) = \\psi(0) \\left( -\\frac{1}{k_{y}L^{2}} + k_y \\right)\n$$\n现在，我们使用其定义计算$\\Delta'$：\n$$\n\\Delta' = \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)} = \\frac{\\psi(0) \\left( \\frac{1}{k_{y}L^{2}} - k_{y} \\right) - \\psi(0) \\left( -\\frac{1}{k_{y}L^{2}} + k_y \\right)}{\\psi(0)}\n$$\n$$\n\\Delta' = \\left( \\frac{1}{k_{y}L^{2}} - k_{y} \\right) - \\left( -\\frac{1}{k_{y}L^{2}} + k_y \\right) = \\frac{1}{k_{y}L^{2}} - k_{y} + \\frac{1}{k_{y}L^{2}} - k_y\n$$\n$$\n\\Delta' = \\frac{2}{k_{y}L^{2}} - 2k_{y}\n$$\n这就是$\\Delta'$的闭合形式解析表达式。\n\n为了在长波极限下进行分析，我们考虑$k_{y}L \\ll 1$。令$\\alpha = k_{y}L$。则表达式可以写为$\\Delta' = \\frac{2}{L\\alpha} - \\frac{2\\alpha}{L} = \\frac{2}{L}\\left(\\frac{1}{\\alpha} - \\alpha\\right)$。\n当$\\alpha \\ll 1$时，$1/\\alpha$项远大于$\\alpha$。\n因此，$\\Delta' \\approx \\frac{2}{k_{y}L^2}$。\n在此极限下，$\\Delta'$是正的，并且其标度关系为$(k_y L)^{-1}$。\n这对磁岛增长的影响是，$\\Delta'$为正值表示等离子体位形对撕裂模不稳定。有自由磁能可通过磁重联释放。在电阻性MHD的线性阶段，这种不稳定性导致撕裂模扰动的指数增长，并在线性演化后在有理面$x=0$处形成磁岛链。因此，对于长波扰动，Harris片平衡对撕裂模是强不稳定的。",
            "answer": "$$\n\\boxed{\\frac{2}{k_{y}L^{2}} - 2k_{y}}\n$$"
        },
        {
            "introduction": "在对不稳定性的物理机制有了深入理解的基础上，最后的这项实践将理论与应用联系起来，解决了前兆探测这一实际挑战。本练习要求你设计一种信号处理算法，用以从背景噪声和其他干扰信号中区分出相干的锁模前兆。这项计算实践旨在培养你在时间-频率分析和统计检测方面的关键技能，这些技能对于构建破裂预测模型和控制系统至关重要。",
            "id": "3967823",
            "problem": "给定两个来自环形装置的极向磁拾取线圈信号的合成时间序列。目标是使用时频滤波器和相干性度量，从宽带湍流中分离出 $n=1$ 锁模前兆，并为测试套件中的每个案例生成决策。该场景的动机是计算聚变科学与工程中的破裂起始和前兆建模，其中锁模表现为跨极向传感器的低频、相位一致的振荡，而宽带湍流则在频谱上分布广泛，并表现出较弱的跨传感器相干性。\n\n从基本定义开始，考虑离散时间信号 $x[k]$ 使用窗函数 $w[\\cdot]$ 的短时傅里叶变换 (STFT)：\n$$\nX(t_m,f_\\ell) = \\sum_{k=0}^{N-1} x[k]\\,w[k - t_m]\\,e^{-i 2\\pi f_\\ell k / f_s},\n$$\n其中 $t_m$ 是窗中心索引，$f_\\ell$ 是离散频率箱，$N$ 是信号长度，$f_s$ 是采样频率，单位为 $\\mathrm{Hz}$。对于两个通道 $x_1[k]$ 和 $x_2[k]$，它们在 $(t_m,f_\\ell)$ 处的时频自谱密度和互谱密度定义为\n$$\nP_{11}(t_m,f_\\ell) = |X_1(t_m,f_\\ell)|^2,\\quad\nP_{22}(t_m,f_\\ell) = |X_2(t_m,f_\\ell)|^2,\\quad\nP_{12}(t_m,f_\\ell) = X_1(t_m,f_\\ell)\\,X_2^*(t_m,f_\\ell).\n$$\n时频形式的幅度平方相干性 (MSC) 为\n$$\nC(t_m,f_\\ell) = \\frac{|P_{12}(t_m,f_\\ell)|^2}{P_{11}(t_m,f_\\ell)\\,P_{22}(t_m,f_\\ell) + \\epsilon},\n$$\n其中 $\\epsilon>0$ 以避免除以零。相位差估计为 $\\phi_{\\mathrm{meas}}(t_m,f_\\ell)=\\arg(P_{12}(t_m,f_\\ell))$。对于以弧度为单位的角度 $\\Delta\\theta$ 分隔的极向传感器，$n=1$ 模意味着期望相位差为 $\\phi_{\\mathrm{exp}} = n\\,\\Delta\\theta$。在时频带 $\\mathcal{B}$ 内的相位锁定值 (PLV) 为\n$$\n\\mathrm{PLV}(t_m)=\\left|\\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} e^{i\\left(\\phi_{\\mathrm{meas}}(t_m,f_\\ell)-\\phi_{\\mathrm{exp}}\\right)}\\right|.\n$$\n\n你的任务是设计一个算法，给定两个通道和候选锁模的目标频率 $f_0$，执行以下步骤：\n\n- 为两个通道计算短时傅里叶变换 (STFT)，并围绕 $f_0$ 识别一个窄带 $\\mathcal{B}=\\{f_\\ell: |f_\\ell-f_0|\\le \\Delta f\\}$，其中 $\\Delta f$ 是以 $\\mathrm{Hz}$ 为单位的预设半宽。\n- 形成一个随时间变化的窄带能量比，该比率量化了信号能量在 $\\mathcal{B}$ 内相对于更宽的分析频带 $\\mathcal{A}$ 的集中程度：\n$$\nR(t_m) = \\frac{\\sum_{f_\\ell\\in \\mathcal{B}} \\left(P_{11}(t_m,f_\\ell)+P_{22}(t_m,f_\\ell)\\right)}{\\sum_{f_\\ell\\in \\mathcal{A}} \\left(P_{11}(t_m,f_\\ell)+P_{22}(t_m,f_\\ell)\\right)}.\n$$\n- 计算随时间变化的频带平均幅度平方相干性：\n$$\n\\overline{C}(t_m) = \\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} C(t_m,f_\\ell).\n$$\n- 使用期望相位 $\\phi_{\\mathrm{exp}} = n\\,\\Delta\\theta$（其中 $n=1$）计算相位锁定值 $\\mathrm{PLV}(t_m)$。\n- 将这些度量组合成一个复合检测统计量\n$$\nD(t_m) = R(t_m)^\\alpha\\,\\overline{C}(t_m)^\\beta\\,\\mathrm{PLV}(t_m)^\\gamma,\n$$\n其中指数 $\\alpha$、$\\beta$、$\\gamma$ 被选为正常数，决策阈值为 $\\tau0$。如果 $\\max_m D(t_m)  \\tau$，则认为存在锁模前兆。\n\n单位和数值约定：\n- 采样频率 $f_s$ 的单位为 $\\mathrm{Hz}$，时间单位为 $\\mathrm{s}$，角度单位为 $\\mathrm{radians}$，STFT 频率轴的单位为 $\\mathrm{Hz}$。\n- 以布尔值或浮点数形式表示任何数值输出，不带单位注释。\n- 角度必须以弧度解释。\n\n用于测试的合成数据生成：\n- 每个通道是三个分量的总和：频率为 $f_0$、幅度为 $A_{\\mathrm{LM}}$ 的 $n=1$ 锁模正弦波；瞬时频率从 $f_{\\mathrm{ch,start}}$ 扫到 $f_{\\mathrm{ch,end}}$、幅度为 $A_{\\mathrm{CH}}$ 的线性啁啾信号；以及通过将白噪声通过一个幅度为 $A_{\\mathrm{TB}}$、截止频率为 $f_{\\mathrm{lp}}$ 的低通滤波器生成的带限湍流。\n- 通道 $x_1(t)$ 对锁模使用 $0$ 相位。通道 $x_2(t)$ 使用相位 $\\phi_{\\mathrm{LM}}$，除非另有说明，该相位等于 $\\phi_{\\mathrm{exp}}$。啁啾和湍流分量在通道间可能具有独立的随机相位。\n\n测试套件规范：\n使用以下四个案例，每个案例由元组 $(f_s, T, f_0, \\Delta f, \\Delta\\theta, A_{\\mathrm{LM}}, A_{\\mathrm{CH}}, f_{\\mathrm{ch,start}}, f_{\\mathrm{ch,end}}, A_{\\mathrm{TB}}, f_{\\mathrm{lp}}, \\alpha, \\beta, \\gamma, \\tau, \\text{phase\\_mismatch})$ 定义，其中所有符号的定义如上所述，$T$ 是记录时长（单位为 $\\mathrm{s}$），$\\text{phase\\_mismatch}$ 是一个以弧度为单位的附加相位偏移，仅应用于 $x_2$ 的锁模分量：\n\n- 案例 1 (理想情况): $(1000, 8, 5, 1, \\pi/3, 1.0, 0.4, 2, 12, 0.3, 60, 1, 1, 1, 0.15, 0.0)$\n- 案例 2 (无锁模): $(1000, 8, 5, 1, \\pi/3, 0.0, 0.4, 2, 12, 0.4, 60, 1, 1, 1, 0.15, 0.0)$\n- 案例 3 (接近阈值且有重叠): $(1000, 8, 5, 1, \\pi/3, 0.25, 0.3, 4, 10, 0.5, 60, 1, 1, 1, 0.10, 0.0)$\n- 案例 4 (强窄带但相位错误): $(1000, 8, 5, 1, \\pi/3, 1.0, 0.3, 6, 14, 0.3, 60, 1, 1, 1, 0.15, 1.2)$\n\n你的程序必须：\n- 使用上述参数为每个案例生成合成信号。\n- 按照规定计算检测统计量 $D(t_m)$，并通过将 $\\max_m D(t_m)$ 与 $\\tau$ 进行比较，来决定每个案例中是否存在锁模前兆。\n- 生成一行输出，其中包含四个案例的检测结果，格式为方括号括起来的逗号分隔列表，例如 $[{\\text{True}},{\\text{False}},{\\text{True}},{\\text{False}}]$。\n\n你的方法必须普遍适用，并以纯数学术语构建，仅依赖于所提供的定义和科学上合理的推理。不允许使用外部数据或用户输入；所有信号必须在内部生成。确保设计涵盖重叠频带，并评估能量集中度和跨通道相位相干结构，以区分锁模和湍流。",
            "solution": "该问题要求设计并实现一个算法，用于在来自环形聚变装置的合成磁强计信号中检测 $n=1$ 锁模前兆。解决方案涉及使用时频分析，将相干的窄带模式信号从宽带湍流和其他非平稳信号中分离出来。该问题定义明确，具有等离子体物理和信号处理的科学基础，并提供了一套清晰的测试案例以供验证。一些实现细节，如短时傅里叶变换（STFT）的窗函数参数，未被指定；因此，将做出并记录标准且合理的选择。\n\n该方法分三个阶段进行：首先，根据问题规范生成合成的双通道时间序列数据；其次，应用时频分析来计算几个有区分度的特征；第三，将这些特征组合成单个检测统计量，以做出最终决策。\n\n**1. 合成信号生成**\n\n对于每个测试案例，都会合成两个时间序列信号 $x_1[k]$ 和 $x_2[k]$。总样本数为 $N = f_s T$，其中 $f_s$ 是采样频率，$T$ 是持续时间。离散时间点为 $t_k = k/f_s$，其中 $k = 0, 1, \\dots, N-1$。每个信号是三个分量的线性叠加：锁模、线性啁啾信号和带限湍流。\n\n- **锁模 (LM)：** 这是一个目标频率为 $f_0$、幅度为 $A_{\\mathrm{LM}}$ 的正弦信号。两个通道之间的相位关系至关重要。对于通道 1，信号为 $s_{\\mathrm{LM},1}(t) = A_{\\mathrm{LM}} \\sin(2\\pi f_0 t)$。对于通道 2，信号为 $s_{\\mathrm{LM},2}(t) = A_{\\mathrm{LM}} \\sin(2\\pi f_0 t + \\phi_{\\mathrm{LM}})$，其中相位 $\\phi_{\\mathrm{LM}} = \\phi_{\\mathrm{exp}} + \\phi_{\\mathrm{mismatch}}$。$n=1$ 模的期望相位差为 $\\phi_{\\mathrm{exp}} = n \\Delta\\theta = 1 \\cdot \\Delta\\theta$。\n- **线性啁啾信号 (CH)：** 该分量模拟另一个非平稳信号。它是一个幅度为 $A_{\\mathrm{CH}}$ 的正弦波，其频率在持续时间 $T$ 内从 $f_{\\mathrm{ch,start}}$ 线性变化到 $f_{\\mathrm{ch,end}}$。在每个通道上为啁啾信号分配独立的随机初始相位，以模拟传感器之间非锁相的过程。\n- **湍流 (TB)：** 该分量模拟等离子体湍流背景。它通过创建两个独立的高斯白噪声信号，然后将它们通过数字低通滤波器来生成。在本实现中，使用一个截止频率为 $f_{\\mathrm{lp}}$ 的 $4$ 阶巴特沃斯滤波器。然后对得到的滤波信号进行缩放，使其标准差为 $A_{\\mathrm{TB}}$。\n\n为保证可复现性，在每对信号合成之前，都会为随机数生成器设定种子。\n\n**2. 时频分析与特征提取**\n\n分析的核心在于短时傅里叶变换（STFT），它将一维时间序列信号 $x_1[k]$ 和 $x_2[k]$ 映射到二维时频表示 $X_1(t_m, f_\\ell)$ 和 $X_2(t_m, f_\\ell)$。\n\n- **STFT 实现：** 我们使用汉宁窗（Hann window），这是减少频谱泄漏的标准选择。窗长度 `nperseg` 设置为 $1024$ 个样本，重叠 `noverlap` 设置为 $512$ 个样本（$50\\%$）。对于 $f_s=1000$ Hz 的采样频率，这个 $1.024$ 秒的窗长度提供了约 $f_s/\\text{nperseg} \\approx 0.977$ Hz 的频率分辨率。该分辨率足以使用多个频率箱来分辨模式频率 $f_0=5$ Hz 周围半宽为 $\\Delta f=1$ Hz 的窄带 $\\mathcal{B}$，这对于有意义的频带平均是必要的。\n\n从 STFT 输出中，我们计算自谱密度 $P_{11}(t_m, f_\\ell) = |X_1(t_m, f_\\ell)|^2$ 和 $P_{22}(t_m, f_\\ell) = |X_2(t_m, f_\\ell)|^2$，以及互谱密度 $P_{12}(t_m, f_\\ell) = X_1(t_m, f_\\ell) X_2^*(t_m, f_\\ell)$。\n\n然后为每个时间步 $t_m$ 提取三个关键特征：\n\n- **窄带能量比 $R(t_m)$：** 这个度量定义为 $R(t_m) = \\frac{\\sum_{f_\\ell\\in \\mathcal{B}} (P_{11}+P_{22})}{\\sum_{f_\\ell\\in \\mathcal{A}} (P_{11}+P_{22})}$，量化了信号功率在目标频带 $\\mathcal{B} = \\{f_\\ell: |f_\\ell - f_0| \\le \\Delta f\\}$ 内的集中程度。宽分析频带 $\\mathcal{A}$ 被取为 STFT 提供的整个正频率范围。$R(t_m)$ 的高值表明存在一个强的窄带信号分量。\n\n- **频带平均幅度平方相干性 $\\overline{C}(t_m)$：** 相干性衡量两个信号作为频率函数的线性相关性。幅度平方相干性为 $C(t_m, f_\\ell) = \\frac{|P_{12}(t_m, f_\\ell)|^2}{P_{11}(t_m, f_\\ell) P_{22}(t_m, f_\\ell) + \\epsilon}$。我们计算在频带 $\\mathcal{B}$ 上的平均相干性 $\\overline{C}(t_m) = \\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} C(t_m,f_\\ell)$。接近 $1$ 的值表示两个通道在目标频带内存在强而一致的线性关系，这是相干模式的特征。使用一个小的正则化项 $\\epsilon=10^{-15}$ 以保证数值稳定性。\n\n- **相位锁定值 $\\mathrm{PLV}(t_m)$：** 这是最具有特定性的度量。它验证通道间的相位差是否与 $n=1$ 模的理论期望值相符。其计算公式为 $\\mathrm{PLV}(t_m)=\\left|\\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} e^{i\\left(\\phi_{\\mathrm{meas}}(t_m,f_\\ell)-\\phi_{\\mathrm{exp}}\\right)}\\right|$，其中 $\\phi_{\\mathrm{meas}} = \\arg(P_{12})$ 是测得的相位差，$\\phi_{\\mathrm{exp}} = \\Delta\\theta$。接近 $1$ 的 PLV 表示测得的相位差在整个频带 $\\mathcal{B}$ 内始终接近期望相位差，这强烈支持了存在 $n=1$ 模的假设。即使相干性很高，低的 PLV 也可能意味着是不同的模式结构，或是一个相位关系错误的相干伪影。\n\n**3. 复合统计量与决策**\n\n这三个度量被组合成一个单一的复合检测统计量 $D(t_m) = R(t_m)^\\alpha \\overline{C}(t_m)^\\beta \\mathrm{PLV}(t_m)^\\gamma$。这种乘法形式确保了高的检测值需要同时满足所有三个条件：集中的能量（高 $R$）、强的通道间相干性（高 $\\overline{C}$）和正确的相位结构（高 PLV）。这提供了鲁棒性，因为一个仅仅是窄带但不相干（例如，噪声被滤波到窄带中）或相干但相位关系错误的信号，将导致 $D(t_m)$ 的值很低。\n\n对于每个测试案例的最终决策，是通过将整个时间窗内的检测统计量的最大值与预设的阈值 $\\tau$ 进行比较来做出的。如果 $\\max_m D(t_m) > \\tau$，则宣布存在锁模前兆。此过程将应用于问题陈述中指定的四个测试案例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Main function to run the locked mode detection algorithm on the test suite.\n    \"\"\"\n    # Test suite specification:\n    # (fs, T, f0, df, dtheta, A_LM, A_CH, f_ch_start, f_ch_end, A_TB, f_lp, \n    #  alpha, beta, gamma, tau, phase_mismatch)\n    test_cases = [\n        (1000, 8, 5, 1, np.pi/3, 1.0, 0.4, 2, 12, 0.3, 60, 1, 1, 1, 0.15, 0.0),\n        (1000, 8, 5, 1, np.pi/3, 0.0, 0.4, 2, 12, 0.4, 60, 1, 1, 1, 0.15, 0.0),\n        (1000, 8, 5, 1, np.pi/3, 0.25, 0.3, 4, 10, 0.5, 60, 1, 1, 1, 0.10, 0.0),\n        (1000, 8, 5, 1, np.pi/3, 1.0, 0.3, 6, 14, 0.3, 60, 1, 1, 1, 0.15, 1.2)\n    ]\n\n    results = []\n    \n    # STFT parameters (chosen for good frequency resolution around f0)\n    NPERSEG = 1024\n    NOVERLAP = NPERSEG // 2\n    EPSILON = 1e-15 # Regularization for division\n\n    for i, case in enumerate(test_cases):\n        # Unpack parameters\n        (fs, T, f0, df, dtheta, A_LM, A_CH, f_ch_start, f_ch_end, A_TB, f_lp, \n         alpha, beta, gamma, tau, phase_mismatch) = case\n\n        # Seed random generator for reproducibility for each case\n        np.random.seed(i)\n\n        # 1. Generate Synthetic Signals\n        N = int(fs * T)\n        t = np.arange(N) / fs\n\n        # Locked Mode component\n        phi_exp = 1.0 * dtheta\n        s_lm1 = A_LM * np.sin(2 * np.pi * f0 * t)\n        s_lm2 = A_LM * np.sin(2 * np.pi * f0 * t + phi_exp + phase_mismatch)\n\n        # Chirp component\n        s_ch1 = A_CH * signal.chirp(t, f_ch_start, t[-1], f_ch_end, method='linear', \n                                    phi=np.random.rand() * 360)\n        s_ch2 = A_CH * signal.chirp(t, f_ch_start, t[-1], f_ch_end, method='linear',\n                                    phi=np.random.rand() * 360)\n\n        # Turbulence component\n        sos = signal.butter(4, f_lp, 'low', fs=fs, output='sos')\n        noise1 = np.random.randn(N)\n        noise2 = np.random.randn(N)\n        s_tb1_unscaled = signal.sosfilt(sos, noise1)\n        s_tb2_unscaled = signal.sosfilt(sos, noise2)\n        s_tb1 = A_TB * (s_tb1_unscaled / np.std(s_tb1_unscaled))\n        s_tb2 = A_TB * (s_tb2_unscaled / np.std(s_tb2_unscaled))\n        \n        # Combine components\n        x1 = s_lm1 + s_ch1 + s_tb1\n        x2 = s_lm2 + s_ch2 + s_tb2\n\n        # 2. Time-Frequency Analysis\n        f_stft, t_stft, X1 = signal.stft(x1, fs=fs, window='hann', nperseg=NPERSEG, noverlap=NOVERLAP)\n        _, _, X2 = signal.stft(x2, fs=fs, window='hann', nperseg=NPERSEG, noverlap=NOVERLAP)\n        \n        # Auto- and Cross-Spectral Densities\n        P11 = np.abs(X1)**2\n        P22 = np.abs(X2)**2\n        P12 = X1 * np.conj(X2)\n\n        # Identify frequency bands\n        band_B_indices = np.where(np.abs(f_stft - f0) = df)[0]\n        # Broad band A is the full STFT frequency range\n\n        # 3. Compute Detection Metrics\n        # Energy Ratio R(t_m)\n        num_R = np.sum(P11[band_B_indices, :] + P22[band_B_indices, :], axis=0)\n        den_R = np.sum(P11 + P22, axis=0)\n        R = num_R / (den_R + EPSILON)\n\n        # Band-Averaged Coherence C_bar(t_m)\n        C = (np.abs(P12)**2) / (P11 * P22 + EPSILON)\n        C_bar = np.mean(C[band_B_indices, :], axis=0)\n\n        # Phase-Locking Value PLV(t_m)\n        phi_meas = np.angle(P12)\n        phase_diff_term = np.exp(1j * (phi_meas - phi_exp))\n        PLV = np.abs(np.mean(phase_diff_term[band_B_indices, :], axis=0))\n\n        # 4. Composite Statistic and Decision\n        D = (R**alpha) * (C_bar**beta) * (PLV**gamma)\n        \n        is_precursor_detected = np.max(D) > tau\n        results.append(str(is_precursor_detected))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results).replace('True', 'True').replace('False', 'False')}]\")\n\nsolve()\n```"
        }
    ]
}