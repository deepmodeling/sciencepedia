{
    "hands_on_practices": [
        {
            "introduction": "Predicting the large toroidal electric field induced during a tokamak disruption is the first step in any runaway electron analysis. This field arises from the rapid collapse of the plasma current, a process that can be effectively captured by modeling the plasma and the surrounding conductive vessel as inductively coupled circuits. This hands-on practice  will guide you through implementing this model to calculate the peak electric field, providing a quantitative measure of the primary threat that drives runaway generation.",
            "id": "4042701",
            "problem": "Consider a tokamak plasma undergoing a prescribed current quench and its electromagnetic coupling to the surrounding conducting vessel. To assess runaway electron mitigation strategies, the goal is to compute the peak toroidal electric field that appears during the quench, because sufficiently large toroidal electric fields can accelerate electrons into the runaway regime. Model the plasma and vessel as two coupled single-turn circuits with self-inductances, mutual inductance, and resistances. Use the International System of Units (SI) and express the final toroidal electric field in volts per meter (V/m).\n\nStart from the following principles and definitions:\n\n- Faraday's law of electromagnetic induction: the loop voltage is related to the time rate of change of the linked magnetic flux. For a circuit with self and mutual inductances, this gives a voltage term proportional to the time derivatives of the currents.\n- Ohm's law: the resistive voltage drop in a circuit element with resistance $R$ and current $I$ is $RI$.\n- Kirchhoff's voltage law: the sum of voltage drops around a closed loop equals the applied loop voltage.\n- Mutual inductance for two coupled circuits: the flux linkage in each circuit includes a mutual term proportional to the current in the other circuit.\n\nAssume:\n- Plasma current $I_p(t)$ is prescribed by a current quench waveform and given by the exponential decay $I_p(t) = I_0 e^{-t/\\tau}$ for $t \\geq 0$, where $I_0$ is the pre-quench plasma current and $\\tau$ is the quench time constant. The derivative is $dI_p/dt = -(I_0/\\tau)e^{-t/\\tau}$.\n- The plasma loop voltage is the sum of inductive and resistive terms linked to the plasma circuit and the vessel circuit via the mutual inductance. Denote the plasma inductance by $L_p$, the vessel inductance by $L_v$, the plasma resistance by $R_p$, the vessel resistance by $R_v$, and the mutual inductance by $M$.\n- The vessel is a passive circuit with no applied source, responding to induced electromotive force. Its current $I_v(t)$ obeys an Ordinary Differential Equation (ODE) arising from Kirchhoff's voltage law and mutual inductive coupling.\n\nFrom these principles, the plasma loop voltage $V_p(t)$ is given by the inductive and resistive response:\n$$\nV_p(t) = L_p \\frac{dI_p}{dt} + R_p I_p(t) + M \\frac{dI_v}{dt}.\n$$\nThe vessel current obeys:\n$$\nL_v \\frac{dI_v}{dt} + R_v I_v(t) + M \\frac{dI_p}{dt} = 0,\n$$\nwith the initial condition $I_v(0) = 0$.\n\nThe toroidal electric field $E(t)$ is related to the loop voltage by the major radius $R_0$:\n$$\nE(t) = \\frac{V_p(t)}{2\\pi R_0}.\n$$\n\nYour task is to write a complete program that:\n- Solves for $I_v(t)$ given the prescribed $I_p(t)$, using the ODE for the vessel circuit.\n- Computes $V_p(t)$ using the expression above.\n- Computes $E(t)$ and returns the peak value $\\max_{t \\in [0, T_{\\mathrm{end}}]} E(t)$ over a specified simulation interval $[0,T_{\\mathrm{end}}]$.\n\nSpecial case handling:\n- Define $\\alpha = R_v/L_v$ and $\\beta = (M/L_v)(I_0/\\tau)$. For the generic case $1/\\tau \\neq \\alpha$, the solution for $I_v(t)$ can be obtained analytically as:\n$$\nI_v(t) = A\\left(e^{-t/\\tau} - e^{-\\alpha t}\\right), \\quad \\text{with} \\quad A = \\frac{M I_0}{R_v \\tau - L_v},\n$$\nwhich satisfies $I_v(0)=0$.\n- In the resonance case $1/\\tau = \\alpha$ (that is, $R_v \\tau = L_v$), the particular solution changes and the vessel current is:\n$$\nI_v(t) = \\beta\\, t\\, e^{-\\alpha t},\n$$\nwhich also satisfies $I_v(0)=0$.\n\nIn all cases, compute $dI_v/dt$ consistently from the chosen expression for $I_v(t)$, then compute $V_p(t)$ and $E(t)$, and finally report the peak value of $E(t)$ in $\\mathrm{V/m}$.\n\nTest suite:\nUse the following parameter sets (each test case is a tuple of $(I_0, \\tau, L_p, R_p, L_v, R_v, M, R_0, T_{\\mathrm{end}})$), where all quantities are in SI units:\n- Case $1$ (typical coupling, \"happy path\"):\n  - $I_0 = 1.25\\times 10^{6}$, $\\tau = 4.0\\times 10^{-3}$, $L_p = 2.0\\times 10^{-6}$, $R_p = 1.2\\times 10^{-3}$, $L_v = 6.0\\times 10^{-6}$, $R_v = 4.0\\times 10^{-3}$, $M = 2.5\\times 10^{-6}$, $R_0 = 3.2$, $T_{\\mathrm{end}} = 3.0\\times 10^{-2}$.\n- Case $2$ (no coupling, edge case $M=0$):\n  - $I_0 = 1.25\\times 10^{6}$, $\\tau = 4.0\\times 10^{-3}$, $L_p = 2.0\\times 10^{-6}$, $R_p = 1.2\\times 10^{-3}$, $L_v = 6.0\\times 10^{-6}$, $R_v = 4.0\\times 10^{-3}$, $M = 0.0$, $R_0 = 3.2$, $T_{\\mathrm{end}} = 3.0\\times 10^{-2}$.\n- Case $3$ (fast quench, small $\\tau$):\n  - $I_0 = 1.25\\times 10^{6}$, $\\tau = 5.0\\times 10^{-4}$, $L_p = 2.0\\times 10^{-6}$, $R_p = 1.2\\times 10^{-3}$, $L_v = 6.0\\times 10^{-6}$, $R_v = 4.0\\times 10^{-3}$, $M = 2.5\\times 10^{-6}$, $R_0 = 3.2$, $T_{\\mathrm{end}} = 5.0\\times 10^{-3}$.\n- Case $4$ (resonant coupling, boundary condition $R_v \\tau = L_v$):\n  - $I_0 = 8.0\\times 10^{5}$, $\\tau = 1.0\\times 10^{-3}$, $L_p = 1.0\\times 10^{-6}$, $R_p = 1.0\\times 10^{-3}$, $L_v = 5.0\\times 10^{-6}$, $R_v = 5.0\\times 10^{-3}$, $M = 1.5\\times 10^{-6}$, $R_0 = 3.0$, $T_{\\mathrm{end}} = 1.0\\times 10^{-2}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the peak toroidal electric field in $\\mathrm{V/m}$ for the corresponding test case (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$). Each result must be a floating-point number.",
            "solution": "The user-provided problem has been analyzed and validated. All givens, definitions, and constraints are self-contained, scientifically grounded in the principles of electromagnetism and circuit theory, and form a well-posed problem. No inconsistencies, ambiguities, or factual errors were detected. Therefore, the problem is deemed valid and a full solution is provided below.\n\nThe problem requires the calculation of the peak toroidal electric field, $E(t)$, in a tokamak during a plasma current quench. This is a critical parameter for assessing the potential for runaway electron generation. The physical system is modeled as two inductively coupled circuits: the plasma (circuit $p$) and the surrounding vacuum vessel (circuit $v$).\n\nThe analysis is based on fundamental principles of electromagnetism:\n1.  **Faraday's Law of Induction and Kirchhoff's Voltage Law**: The sum of voltages around a closed loop is zero. For the plasma and vessel circuits, this leads to a system of coupled ordinary differential equations (ODEs).\n2.  **Ohm's Law**: The resistive voltage drop across a component is $V = RI$.\n\nThe plasma circuit's loop voltage, $V_p(t)$, which drives the toroidal electric field, is given by the sum of its self-inductive response, its resistive drop, and the voltage mutually induced by the changing current in the vessel:\n$$\nV_p(t) = L_p \\frac{dI_p}{dt} + R_p I_p(t) + M \\frac{dI_v}{dt}\n$$\nHere, $L_p$ and $R_p$ are the plasma inductance and resistance, $I_p(t)$ is the plasma current, $M$ is the mutual inductance between the plasma and the vessel, and $I_v(t)$ is the vessel current.\n\nThe vessel is a passive circuit, so the sum of voltages around its loop is zero. This gives the governing ODE for the vessel current, $I_v(t)$:\n$$\nL_v \\frac{dI_v}{dt} + R_v I_v(t) + M \\frac{dI_p}{dt} = 0\n$$\nwhere $L_v$ and $R_v$ are the vessel inductance and resistance. The initial condition is $I_v(0) = 0$, as no current flows in the vessel before the quench begins at $t=0$.\n\nThe plasma current quench is prescribed as an exponential decay:\n$$\nI_p(t) = I_0 e^{-t/\\tau} \\quad \\text{for } t \\geq 0\n$$\nwhere $I_0$ is the pre-quench current and $\\tau$ is the characteristic quench time. The time derivative is:\n$$\n\\frac{dI_p}{dt} = -\\frac{I_0}{\\tau} e^{-t/\\tau}\n$$\n\nSubstituting the expression for $dI_p/dt$ into the vessel's ODE gives a first-order linear non-homogeneous ODE for $I_v(t)$:\n$$\nL_v \\frac{dI_v}{dt} + R_v I_v(t) = \\frac{M I_0}{\\tau} e^{-t/\\tau}\n$$\nThis ODE can be solved analytically. The solution depends on the relationship between the plasma current decay rate, $1/\\tau$, and the vessel's intrinsic L/R time constant, $\\alpha = R_v/L_v$. Two distinct cases arise, as specified in the problem statement.\n\n**Case 1: Non-resonant Coupling ($1/\\tau \\neq \\alpha$)**\nWhen the driving frequency does not match the natural frequency of the vessel circuit, the solution for the vessel current, satisfying $I_v(0)=0$, is:\n$$\nI_v(t) = A\\left(e^{-t/\\tau} - e^{-\\alpha t}\\right), \\quad \\text{with} \\quad A = \\frac{M I_0}{R_v \\tau - L_v}\n$$\nThe required time derivative is found by differentiation:\n$$\n\\frac{dI_v}{dt} = A\\left(-\\frac{1}{\\tau} e^{-t/\\tau} + \\alpha e^{-\\alpha t}\\right)\n$$\n\n**Case 2: Resonant Coupling ($1/\\tau = \\alpha$)**\nIn the special case where $R_v \\tau = L_v$, the form of the particular solution changes. The solution for the vessel current, satisfying $I_v(0)=0$, is:\n$$\nI_v(t) = \\beta t e^{-\\alpha t}, \\quad \\text{with} \\quad \\beta = \\frac{M}{L_v}\\frac{I_0}{\\tau}\n$$\nUsing the product rule, the time derivative is:\n$$\n\\frac{dI_v}{dt} = \\beta (e^{-\\alpha t} - \\alpha t e^{-\\alpha t}) = \\beta e^{-\\alpha t}(1 - \\alpha t)\n$$\n\nOnce the expression for $dI_v/dt$ is determined for the appropriate case, all terms in the equation for $V_p(t)$ are known functions of time. The toroidal electric field is then directly proportional to the loop voltage:\n$$\nE(t) = \\frac{V_p(t)}{2\\pi R_0}\n$$\nwhere $R_0$ is the tokamak's major radius.\n\nTo find the peak electric field, $\\max_{t \\in [0, T_{\\mathrm{end}}]} E(t)$, an algorithmic approach is used:\n1.  A discrete time grid is generated over the interval $[0, T_{\\mathrm{end}}]$. A high-resolution grid is chosen to ensure the peak is captured accurately.\n2.  For each test case, the condition $R_v \\tau = L_v$ is checked to determine if the system is resonant. A floating-point-safe comparison is employed.\n3.  The corresponding analytical expression for $dI_v/dt$ is selected and evaluated at each point on the time grid.\n4.  The functions $I_p(t)$ and $dI_p/dt$ are also evaluated on the time grid.\n5.  All components are combined to compute the loop voltage $V_p(t)$ and subsequently the toroidal electric field $E(t)$ at each time point.\n6.  The maximum value of the resulting array for $E(t)$ is identified. This value represents the peak toroidal electric field.\n\nThis procedure is implemented for each of the provided test cases. `NumPy` is used for efficient, vectorized calculations over the time grid.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_peak_E(I0: float, tau: float, Lp: float, Rp: float, \n                     Lv: float, Rv: float, M: float, R0: float, Tend: float) - float:\n    \"\"\"\n    Solves for the peak toroidal electric field during a plasma current quench.\n\n    Args:\n        I0 (float): Pre-quench plasma current in Amperes.\n        tau (float): Current quench time constant in seconds.\n        Lp (float): Plasma self-inductance in Henrys.\n        Rp (float): Plasma resistance in Ohms.\n        Lv (float): Vessel self-inductance in Henrys.\n        Rv (float): Vessel resistance in Ohms.\n        M (float): Mutual inductance in Henrys.\n        R0 (float): Major radius in meters.\n        Tend (float): Simulation end time in seconds.\n\n    Returns:\n        float: The peak toroidal electric field in Volts/meter.\n    \"\"\"\n    # Create a fine time grid for the simulation interval\n    num_points = 20000  # High resolution to capture the peak accurately\n    t = np.linspace(0, Tend, num_points)\n\n    # Calculate plasma current and its time derivative over the time grid\n    I_p = I0 * np.exp(-t / tau)\n    dIp_dt = -(I0 / tau) * np.exp(-t / tau)\n\n    # Determine the vessel current response based on the coupling case\n    # Check for the resonant case: R_v * tau = L_v\n    if np.isclose(Rv * tau, Lv):\n        # Resonant case\n        alpha = Rv / Lv\n        beta = (M / Lv) * (I0 / tau)\n        # Vessel current derivative from d/dt(beta * t * exp(-alpha*t))\n        dIv_dt = beta * np.exp(-alpha * t) * (1 - alpha * t)\n    else:\n        # Non-resonant case\n        alpha = Rv / Lv\n        A = (M * I0) / (Rv * tau - Lv)\n        # Vessel current derivative from d/dt(A * (exp(-t/tau) - exp(-alpha*t)))\n        dIv_dt = A * (-np.exp(-t / tau) / tau + alpha * np.exp(-alpha * t))\n\n    # Calculate the total plasma loop voltage Vp(t)\n    # Vp(t) = L_p * dI_p/dt + R_p * I_p(t) + M * dI_v/dt\n    Vp = Lp * dIp_dt + Rp * I_p + M * dIv_dt\n\n    # Calculate the toroidal electric field E(t)\n    # E(t) = Vp(t) / (2 * pi * R0)\n    E_t = Vp / (2 * np.pi * R0)\n\n    # Find and return the peak value of the electric field\n    peak_E = np.max(E_t)\n    return peak_E\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple: (I0, tau, Lp, Rp, Lv, Rv, M, R0, Tend)\n    test_cases = [\n        # Case 1 (typical coupling, \"happy path\")\n        (1.25e6, 4.0e-3, 2.0e-6, 1.2e-3, 6.0e-6, 4.0e-3, 2.5e-6, 3.2, 3.0e-2),\n        # Case 2 (no coupling, edge case M=0)\n        (1.25e6, 4.0e-3, 2.0e-6, 1.2e-3, 6.0e-6, 4.0e-3, 0.0, 3.2, 3.0e-2),\n        # Case 3 (fast quench, small tau)\n        (1.25e6, 5.0e-4, 2.0e-6, 1.2e-3, 6.0e-6, 4.0e-3, 2.5e-6, 3.2, 5.0e-3),\n        # Case 4 (resonant coupling, boundary condition R_v * tau = L_v)\n        (8.0e5, 1.0e-3, 1.0e-6, 1.0e-3, 5.0e-6, 5.0e-3, 1.5e-6, 3.0, 1.0e-2),\n    ]\n\n    results = []\n    for case in test_cases:\n        peak_E_field = calculate_peak_E(*case)\n        results.append(peak_E_field)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Once a sufficiently large electric field is present, a small initial seed of runaway electrons can trigger an avalanche of secondary runaways, leading to exponential growth in the runaway current. This process, where energetic electrons knock thermal electrons into the runaway velocity range, is the primary mechanism for generating dangerous, multi-mega-ampere runaway beams in large tokamaks. In this exercise , you will use first principles to derive an analytical expression for the time it takes the avalanche to reach a critical current, building crucial intuition about the timescale of the threat and its dependence on the ratio of the accelerating field $E$ to the critical field $E_c$.",
            "id": "4042645",
            "problem": "Consider a post-thermal-quench phase in a large-aspect-ratio tokamak plasma in which a spatially uniform toroidal electric field of magnitude $E$ is sustained and approximately constant in time over a flux-tube cross-section of area $A$. A seed population of runaway electrons (REs) of density $n_{re,0}$ is present immediately after the thermal quench. Assume that avalanche multiplication by large-angle Coulomb (Møller) knock-on collisions dominates the production of new runaway electrons and that the REs rapidly become highly relativistic so that their parallel speed can be approximated as $v_{\\parallel} \\approx c$, where $c$ is the speed of light in vacuum.\n\nUse the following well-tested definitions as the fundamental base:\n- The Connor–Hastie critical electric field $E_c$ defined by\n$$\nE_c \\equiv \\frac{n_e e^{3} \\ln\\Lambda}{4 \\pi \\epsilon_0^{2} m_e c^{2}},\n$$\nwhere $n_e$ is the background electron density, $e$ is the elementary charge, $\\ln\\Lambda$ is the Coulomb logarithm, $\\epsilon_0$ is the vacuum permittivity, and $m_e$ is the electron mass.\n- The relativistic electron–electron collision time\n$$\n\\tau_r \\equiv \\frac{4 \\pi \\epsilon_0^{2} m_e^{2} c^{3}}{n_e e^{4} \\ln\\Lambda}.\n$$\n\nStarting from particle-number balance for the runaway electron population and basic kinetic considerations of large-angle collision production, argue from first principles that, for a fixed supercritical field ratio $E/E_c  1$, the avalanche source induces exponential growth of the runaway density $n_{re}(t)$ with a constant growth rate that scales with $(E/E_c - 1)$ and is set by the timescale $\\tau_r$ up to an order-unity factor. For an analytical estimate, neglect order-unity prefactors associated with detailed pitch-angle and effective charge dependences, and model the growth rate as directly proportional to $(E/E_c - 1)/\\tau_r$.\n\nAssuming the total runaway current is well approximated by $I_{re}(t) = e\\, A\\, c\\, n_{re}(t)$, determine an analytic expression for the time $t_{\\ast}$ required for the runaway current to reach a specified target value $I_{\\ast}$, in terms of $E/E_c$, $\\tau_r$, $I_{\\ast}$, $A$, $e$, $c$, and $n_{re,0}$. Express your final formula for the time in seconds if all inputs are provided in the International System of Units (SI). Your final answer must be a single closed-form expression. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of an expression for the time $t_{\\ast}$ needed for an avalanching runaway electron population to reach a target current $I_{\\ast}$. The problem statement is scientifically sound, well-posed, and contains sufficient information for a unique solution under the specified simplifying assumptions.\n\nThe fundamental principle governing the evolution of the runaway electron (RE) population is particle conservation. The rate of change of the runaway electron density, $n_{re}$, is determined by the balance of source and loss mechanisms. The problem specifies that an initial seed population with density $n_{re,0}$ exists at time $t=0$ and that the dominant production mechanism is avalanche multiplication. We neglect any loss terms for this estimate. The avalanche source term, $S_{ava}$, is proportional to the number of existing runaway electrons that create secondary runaways through large-angle collisions. Therefore, the particle balance equation can be written as a first-order rate equation:\n$$\n\\frac{d n_{re}(t)}{dt} = S_{ava} = \\gamma n_{re}(t)\n$$\nwhere $\\gamma$ is the avalanche growth rate.\n\nThe next step is to establish the form of the growth rate $\\gamma$. The problem asks for an argument from first principles. The existence of runaway electrons is contingent on the toroidal electric field $E$ being strong enough to overcome the collisional drag force. The Connor–Hastie critical field $E_c$ represents the threshold at which the energy gain from the field for a relativistic electron exactly balances the energy loss due to collisions. For a supercritical field, $E  E_c$, an electron experiences a net acceleration. The rate of energy gain is proportional to the magnitude of the \"supercritical\" field, $E - E_c$. The avalanche process, where a high-energy electron knocks a thermal electron into the runaway energy range, has a rate that depends on this net energy gain. The characteristic time scale for this collisional process for relativistic electrons is the relativistic collision time, $\\tau_r$. Consequently, the growth rate $\\gamma$ must be proportional to the dimensionless field ratio $(E-E_c)/E_c$ and inversely proportional to the collision time $\\tau_r$. The problem directs us to model the growth rate by taking the constant of proportionality to be unity:\n$$\n\\gamma = \\frac{\\frac{E}{E_c} - 1}{\\tau_r}\n$$\nGiven that $E/E_c  1$, the growth rate $\\gamma$ is a positive constant, leading to exponential growth.\n\nWe now solve the differential equation for $n_{re}(t)$:\n$$\n\\frac{d n_{re}}{dt} = \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) n_{re}\n$$\nThis is a separable first-order linear ordinary differential equation. We integrate it from the initial condition $(t=0, n_{re}=n_{re,0})$ to a later state $(t, n_{re}(t))$:\n$$\n\\int_{n_{re,0}}^{n_{re}(t)} \\frac{d n'_{re}}{n'_{re}} = \\int_{0}^{t} \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) dt'\n$$\nSince the terms in the parenthesis on the right-hand side are constant with respect to time, the integration yields:\n$$\n\\ln(n_{re}(t)) - \\ln(n_{re,0}) = \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) t\n$$\n$$\n\\ln\\left(\\frac{n_{re}(t)}{n_{re,0}}\\right) = \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) t\n$$\nSolving for $n_{re}(t)$ by exponentiating both sides gives the time evolution of the runaway electron density:\n$$\nn_{re}(t) = n_{re,0} \\exp\\left( \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) t \\right)\n$$\n\nThe problem provides an expression for the total runaway current, $I_{re}(t)$, assuming the runaways are highly relativistic ($v_{\\parallel} \\approx c$):\n$$\nI_{re}(t) = e A c n_{re}(t)\n$$\nwhere $e$ is the elementary charge, $A$ is the cross-sectional area of the flux-tube, and $c$ is the speed of light. Substituting our expression for $n_{re}(t)$:\n$$\nI_{re}(t) = e A c n_{re,0} \\exp\\left( \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) t \\right)\n$$\n\nFinally, we determine the time $t_{\\ast}$ at which the runaway current reaches a specified target value $I_{\\ast}$. We set $I_{re}(t_{\\ast}) = I_{\\ast}$:\n$$\nI_{\\ast} = e A c n_{re,0} \\exp\\left( \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) t_{\\ast} \\right)\n$$\nTo solve for $t_{\\ast}$, we first isolate the exponential term:\n$$\n\\frac{I_{\\ast}}{e A c n_{re,0}} = \\exp\\left( \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) t_{\\ast} \\right)\n$$\nTaking the natural logarithm of both sides:\n$$\n\\ln\\left( \\frac{I_{\\ast}}{e A c n_{re,0}} \\right) = \\left( \\frac{E/E_c - 1}{\\tau_r} \\right) t_{\\ast}\n$$\nIsolating $t_{\\ast}$ yields the final expression:\n$$\nt_{\\ast} = \\frac{\\tau_r}{\\frac{E}{E_c} - 1} \\ln\\left( \\frac{I_{\\ast}}{e A c n_{re,0}} \\right)\n$$\nThis expression provides the time required for the runaway current to grow from its initial value, determined by the seed density $n_{re,0}$, to the target value $I_{\\ast}$, driven by an avalanche with a growth rate determined by the supercritical electric field ratio $E/E_c$ and the relativistic collision time $\\tau_r$. The expression is dimensionally correct, as $\\tau_r$ has units of time, and all other factors are dimensionless.",
            "answer": "$$\n\\boxed{\\frac{\\tau_r}{\\frac{E}{E_c} - 1} \\ln\\left(\\frac{I_{\\ast}}{e A c n_{re,0}}\\right)}\n$$"
        },
        {
            "introduction": "A leading strategy for mitigating runaway electron avalanches is to inject high-$Z$ impurities, which drastically increases the collisional drag on the electron population and raises the critical electric field $E_c$. This exercise  delves into the subtle physics of this process by asking you to model how the collisional drag depends on the runaway's energy, accounting for the \"unscreening\" of bound impurity electrons. Implementing this energy-dependent critical field $E_c(\\gamma)$ provides a more accurate, quantitative tool for evaluating the efficacy of impurity-based mitigation strategies.",
            "id": "4042672",
            "problem": "Develop an algorithmic model to quantify how partial ionization of high-$Z$ impurities modifies the relativistic critical electric field for runaway electron suppression by including energy-dependent screening of bound electrons in the collisional drag. Begin from a fundamental energy balance and construct a computationally tractable formula that is testable against a provided suite of cases.\n\nFundamental base: Consider a highly relativistic electron of charge $e$, mass $m_e$, speed $v \\approx c$, and Lorentz factor $\\gamma$. The instantaneous energy evolves as $d(\\gamma m_e c^2)/dt = e E v - P_{\\mathrm{coll}}(\\gamma)$, where $E$ is the electric field and $P_{\\mathrm{coll}}(\\gamma)$ is the collisional power loss. The relativistic critical electric field $E_c$ is defined by the condition $e E_c c = P_{\\mathrm{coll}}(\\gamma)$ in the limit of $v \\approx c$. In a fully ionized plasma without bound-electron effects and at high energy, the standard Connor-Hastie form for the baseline critical field is\n$$\nE_c^{(0)} = \\frac{n_e e^3 \\ln \\Lambda}{4 \\pi \\epsilon_0^2 m_e c^2},\n$$\nwhere $n_e$ is the free-electron density, $\\epsilon_0$ is the vacuum permittivity, and $\\ln \\Lambda$ is the Coulomb logarithm, treated here as a constant in the cold-plasma approximation.\n\nModeling bound-electron screening: When high-$Z$ impurities are partially ionized, a fraction of their bound electrons can contribute to collisional drag, depending on the runaway electron energy. Let there be impurity species indexed by $j$ with number density $n_j$ and $N_b^{(j)}$ bound electrons per ion. Define an energy-dependent unscreening fraction for species $j$, $S_j(\\gamma) \\in [0,1]$, satisfying $S_j(\\gamma) \\rightarrow 0$ for low energy (fully screened) and $S_j(\\gamma) \\rightarrow 1$ for very high energy (unscreened). A minimal, physically motivated parametric form based on momentum-transfer scaling is\n$$\nS_j(\\gamma) = \\frac{(\\gamma/\\gamma_{s,j})^q}{1 + (\\gamma/\\gamma_{s,j})^q},\n$$\nwhere $q$ is a positive real number controlling the sharpness of the transition and $\\gamma_{s,j}$ is a characteristic Lorentz factor for the onset of unscreening in species $j$ that encodes its bound-electron structure (for example, via an effective screening length or mean excitation energy). In this model, the effective electron number density that contributes to collisional drag at Lorentz factor $\\gamma$ is\n$$\nn_{\\mathrm{eff}}(\\gamma) = n_e + \\sum_j n_j N_b^{(j)} S_j(\\gamma).\n$$\nAssuming that the collisional power loss scales linearly with the accessible electron density, the modified critical electric field is then\n$$\nE_c(\\gamma) = \\frac{n_{\\mathrm{eff}}(\\gamma)}{n_e} E_c^{(0)} = \\left[1 + \\sum_j \\frac{n_j}{n_e} N_b^{(j)} S_j(\\gamma)\\right] \\frac{n_e e^3 \\ln \\Lambda}{4 \\pi \\epsilon_0^2 m_e c^2}.\n$$\n\nTask: Implement a program that, for a given set of plasma and impurity parameters, computes $E_c(\\gamma)$ using the above model. Use the physical constants $e$, $m_e$, $c$, and $\\epsilon_0$ in International System of Units (SI). All electric fields must be expressed in $\\mathrm{V/m}$, and all densities in $\\mathrm{m}^{-3}$. Angles do not appear in this task. The program should produce results rounded to six decimal places.\n\nTest suite: Evaluate $E_c(\\gamma)$ for the following five cases, each specified by $(n_e, \\ln \\Lambda, \\gamma, q, \\{(n_j, N_b^{(j)}, \\gamma_{s,j})\\}_j)$:\n\n- Case $1$ (baseline, no impurities): $n_e = 4.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $\\ln \\Lambda = 15.0$, $\\gamma = 20.0$, $q = 2$, no impurity species (empty set).\n- Case $2$ (partially ionized tungsten at low energy): $n_e = 4.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $\\ln \\Lambda = 15.0$, $\\gamma = 3.0$, $q = 2$, one species with $n_1 = 5.0 \\times 10^{17}\\ \\mathrm{m}^{-3}$, $N_b^{(1)} = 44$ (representing $44$ bound electrons per tungsten ion), and $\\gamma_{s,1} = 10.0$.\n- Case $3$ (partially ionized tungsten at high energy): identical to Case $2$ except $\\gamma = 50.0$.\n- Case $4$ (multiple impurities at intermediate energy): $n_e = 6.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $\\ln \\Lambda = 16.0$, $\\gamma = 12.0$, $q = 2$, two species: species $1$ with $n_1 = 1.2 \\times 10^{18}\\ \\mathrm{m}^{-3}$, $N_b^{(1)} = 10$, $\\gamma_{s,1} = 8.0$, and species $2$ with $n_2 = 8.0 \\times 10^{17}\\ \\mathrm{m}^{-3}$, $N_b^{(2)} = 2$, $\\gamma_{s,2} = 5.0$.\n- Case $5$ (fully ionized impurity, boundary check): $n_e = 4.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $\\ln \\Lambda = 15.0$, $\\gamma = 1000000.0$, $q = 2$, one species with $n_1 = 1.0 \\times 10^{18}\\ \\mathrm{m}^{-3}$, $N_b^{(1)} = 0$ (no bound electrons), and $\\gamma_{s,1} = 10.0$.\n\nAnswer specification and final output format: For each case, compute a single floating-point number equal to $E_c(\\gamma)$ in $\\mathrm{V/m}$, rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[E_1,E_2,E_3,E_4,E_5]$). No other output is permitted.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of plasma physics and runaway electron dynamics, specifically within the context of computational fusion science. The problem is well-posed, providing a complete and consistent set of equations, parameters, and test cases that allow for the construction of a unique and verifiable solution. The language is objective and precise, with all terms clearly defined. Therefore, a reasoned solution will be provided.\n\nThe objective is to compute the modified critical electric field, $E_c(\\gamma)$, which accounts for the energy-dependent collisional drag from bound electrons of partially ionized impurities. The calculation proceeds by implementing the model described in the problem statement.\n\nThe foundation of the model is the Connor-Hastie critical electric field, $E_c^{(0)}$, for a fully ionized plasma. This represents the baseline electric field required to balance the collisional drag on a highly relativistic electron, preventing it from \"running away\" to higher energies. It is given by:\n$$\nE_c^{(0)} = \\frac{n_e e^3 \\ln \\Lambda}{4 \\pi \\epsilon_0^2 m_e c^2}\n$$\nHere, $n_e$ is the free-electron density, $\\ln \\Lambda$ is the Coulomb logarithm, $e$ is the elementary charge, $m_e$ is the electron rest mass, $c$ is the speed of light in vacuum, and $\\epsilon_0$ is the vacuum permittivity.\n\nTo simplify the computation, we can group the physical constants into a single factor, $K$:\n$$\nK = \\frac{e^3}{4 \\pi \\epsilon_0^2 m_e c^2}\n$$\nUsing the standard SI values for the physical constants:\n- $e \\approx 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n- $\\epsilon_0 \\approx 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n- $m_e \\approx 9.1093837015 \\times 10^{-31}\\ \\mathrm{kg}$\n- $c = 299792458\\ \\mathrm{m/s}$\n\nThe value of this constant is approximately $K \\approx 5.090333 \\times 10^{-23}\\ \\mathrm{V \\cdot m^2}$. The baseline critical field can then be expressed as $E_c^{(0)} = K n_e \\ln \\Lambda$.\n\nThe core of the new model is the introduction of an effective electron density, $n_{\\mathrm{eff}}(\\gamma)$, that a runaway electron at Lorentz factor $\\gamma$ interacts with. This density includes not only the free electrons $n_e$ but also a fraction of the bound electrons from impurity ions. This fraction is determined by the energy-dependent unscreening function, $S_j(\\gamma)$, for each impurity species $j$:\n$$\nS_j(\\gamma) = \\frac{(\\gamma/\\gamma_{s,j})^q}{1 + (\\gamma/\\gamma_{s,j})^q}\n$$\nwhere $\\gamma_{s,j}$ is the characteristic Lorentz factor for the onset of unscreening for species $j$, and $q$ determines the sharpness of this transition. This function correctly captures the physical limits: for low-energy electrons ($\\gamma \\ll \\gamma_{s,j}$), $S_j(\\gamma) \\to 0$, and the bound electrons are fully screened. For high-energy electrons ($\\gamma \\gg \\gamma_{s,j}$), $S_j(\\gamma) \\to 1$, and the bound electrons are unscreened, contributing fully to the collisional drag.\n\nThe effective electron density is the sum of contributions from free electrons and all impurity species:\n$$\nn_{\\mathrm{eff}}(\\gamma) = n_e + \\sum_j n_j N_b^{(j)} S_j(\\gamma)\n$$\nwhere $n_j$ is the number density of impurity species $j$ and $N_b^{(j)}$ is the number of bound electrons per ion of that species.\n\nThe modified critical electric field, $E_c(\\gamma)$, is assumed to scale linearly with this effective electron density. Therefore, it is related to the baseline field by the ratio $n_{\\mathrm{eff}}(\\gamma)/n_e$:\n$$\nE_c(\\gamma) = \\frac{n_{\\mathrm{eff}}(\\gamma)}{n_e} E_c^{(0)} = \\left[1 + \\frac{1}{n_e}\\sum_j n_j N_b^{(j)} S_j(\\gamma)\\right] E_c^{(0)}\n$$\nThis is the final expression to be implemented. The algorithmic procedure is as follows:\n1.  For a given test case, identify the parameters: $n_e$, $\\ln \\Lambda$, $\\gamma$, $q$, and the set of impurity data $\\{(n_j, N_b^{(j)}, \\gamma_{s,j})\\}_j$.\n2.  Calculate the baseline critical field $E_c^{(0)} = K n_e \\ln \\Lambda$.\n3.  Initialize a sum for the impurity contribution, $\\Sigma = 0$.\n4.  For each impurity species $j$ in the provided set:\n    a. Calculate the unscreening fraction $S_j(\\gamma)$ using its specific parameters $\\gamma_{s,j}$ and the global parameters $\\gamma$ and $q$.\n    b. Calculate the species' contribution to the sum: $\\frac{n_j}{n_e} N_b^{(j)} S_j(\\gamma)$.\n    c. Add this contribution to the total sum $\\Sigma$.\n5.  Calculate the final modified critical field $E_c(\\gamma) = (1 + \\Sigma) E_c^{(0)}$.\n6.  Round the result to six decimal places as specified.\n\nThis procedure will be applied to each of the five test cases provided. For cases with no impurities, the sum $\\Sigma$ is zero, and the result simplifies to $E_c(\\gamma) = E_c^{(0)}$. For the special case where an impurity species has no bound electrons ($N_b^{(j)}=0$), its contribution to the sum is also zero, regardless of other parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the modified critical electric field for runaway electrons,\n    including effects from partially ionized impurities.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in F/m\n    M_E = 9.1093837015e-31      # Electron rest mass in kg\n    C_LIGHT = 299792458         # Speed of light in m/s\n\n    # Pre-calculate the constant factor K for E_c^(0)\n    K_CONST = (E_CHARGE**3) / (4 * np.pi * EPSILON_0**2 * M_E * C_LIGHT**2)\n\n    def calculate_Ec(n_e, ln_Lambda, gamma, q, impurities):\n        \"\"\"\n        Computes the modified critical electric field E_c(gamma).\n\n        Args:\n            n_e (float): Free electron density in m^-3.\n            ln_Lambda (float): Coulomb logarithm.\n            gamma (float): Lorentz factor of the runaway electron.\n            q (float): Sharpness parameter for the unscreening function.\n            impurities (list of tuples): A list where each tuple contains\n                                        (n_j, N_b, gamma_s) for an impurity species.\n                                        n_j: impurity density in m^-3\n                                        N_b: number of bound electrons\n                                        gamma_s: characteristic Lorentz factor for unscreening\n\n        Returns:\n            float: The modified critical electric field in V/m, rounded to 6 decimal places.\n        \"\"\"\n        # Step 1: Calculate the baseline Connor-Hastie critical field E_c^(0)\n        Ec0 = K_CONST * n_e * ln_Lambda\n\n        # Step 2: Calculate the impurity contribution sum\n        impurity_sum = 0.0\n        if impurities: # Handle cases with no impurities\n            for n_j, N_b, gamma_s in impurities:\n                # If there are no bound electrons, this term is zero\n                if N_b == 0:\n                    continue\n                \n                # Calculate the energy-dependent unscreening fraction S_j(gamma)\n                gamma_ratio_q = (gamma / gamma_s)**q\n                S_j = gamma_ratio_q / (1.0 + gamma_ratio_q)\n                \n                # Add the contribution of this species to the sum\n                impurity_sum += (n_j / n_e) * N_b * S_j\n\n        # Step 3: Calculate the final modified critical field E_c(gamma)\n        Ec_gamma = (1.0 + impurity_sum) * Ec0\n        \n        # Step 4: Round to the specified number of decimal places\n        return round(Ec_gamma, 6)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: baseline, no impurities\n        (4.0e19, 15.0, 20.0, 2, []),\n        # Case 2: partially ionized tungsten at low energy\n        (4.0e19, 15.0, 3.0, 2, [(5.0e17, 44, 10.0)]),\n        # Case 3: partially ionized tungsten at high energy\n        (4.0e19, 15.0, 50.0, 2, [(5.0e17, 44, 10.0)]),\n        # Case 4: multiple impurities at intermediate energy\n        (6.0e19, 16.0, 12.0, 2, [(1.2e18, 10, 8.0), (8.0e17, 2, 5.0)]),\n        # Case 5: fully ionized impurity, boundary check\n        (4.0e19, 15.0, 1000000.0, 2, [(1.0e18, 0, 10.0)]),\n    ]\n\n    results = []\n    for case in test_cases:\n        n_e, ln_Lambda, gamma, q, impurities = case\n        result = calculate_Ec(n_e, ln_Lambda, gamma, q, impurities)\n        results.append(f\"{result:.6f}\") # Ensure trailing zeros are included\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}