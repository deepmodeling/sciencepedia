{
    "hands_on_practices": [
        {
            "introduction": "我们首先从聚变等离子体中最核心的能量来源——阿尔法粒子加热——开始。这项实践旨在建立微观聚变反应率与宏观加热功率之间的直接联系。掌握这项计算是进行任何形式的聚变反应堆功率平衡分析的基础，它能够将等离子体物理参数转化为关键的工程设计指标。",
            "id": "4031907",
            "problem": "一个磁约束的氘-氚（D-T）等离子体在准稳态条件下运行，其电子密度为 $n_{e}=8\\times 10^{19}\\,\\text{m}^{-3}$，电子温度为 $T_{e}=10\\,\\text{keV}$。测得的聚变反应速率密度为 $R_{f}=1.0\\times 10^{20}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$。每次 D-T 聚变事件产生一个动能为 $E_{\\alpha}=3.5\\,\\text{MeV}$ 的 alpha 粒子和一个动能为 $14.1\\,\\text{MeV}$ 的中子。假设 alpha 粒子的能量被局域地沉积在等离子体中（能量沉积份额 $f_{\\alpha}=1$）。该等离子体位于一个托卡马克装置中，其小半径为 $a=0.30\\,\\text{m}$，大半径为 $R=1.50\\,\\text{m}$ 的圆形截面，因此等离子体体积为一个圆环体。\n\n从能量守恒的第一性原理和反应速率密度的定义出发，推导 (i) 总 alpha 加热功率 $P_{\\alpha}$ 和 (ii) 体 alpha 加热功率密度的表达式。然后对两者进行数值计算。\n\n使用元电荷 $q_{e}$ 将电子伏特与焦耳关联起来，关系为 $1\\,\\text{eV}=q_{e}\\,\\text{J}$，并取 $q_{e}=1.602176634\\times 10^{-19}\\,\\text{C}$。将 $P_{\\alpha}$ 以兆瓦表示，体 alpha 加热功率密度以兆瓦每立方米表示。将最终数值结果四舍五入至三位有效数字。将你的答案以行矩阵的形式报告，其中第一个条目等于以兆瓦为单位的 $P_{\\alpha}$，第二个条目等于以兆瓦每立方米为单位的体 alpha 加热功率密度。",
            "solution": "该问题经验证具有科学依据、提法明确且客观。计算所需的所有必要数据均已提供，且其背景与聚变等离子体物理学原理一致。该问题未表现出验证标准中列出的任何缺陷。\n\n推导从反应速率和功率的基本定义出发。\n\n体 alpha 加热功率密度，我们记作 $p_{\\alpha}$，是指单位时间内单位体积内由 alpha 粒子沉积到等离子体中的能量。它被定义为单位时间内单位体积的聚变反应次数（聚变反应速率密度，$R_{f}$）、每次反应产生的 alpha 粒子的动能（$E_{\\alpha}$）以及这部分能量局域沉积在等离子体中的份额（$f_{\\alpha}$）的乘积。\n\n因此，体 alpha 加热功率密度的表达式为：\n$$\np_{\\alpha} = f_{\\alpha} R_{f} E_{\\alpha}\n$$\n\n问题提供了以下数值：\n- 聚变反应速率密度，$R_{f} = 1.0 \\times 10^{20} \\, \\text{m}^{-3} \\, \\text{s}^{-1}$\n- Alpha 粒子能量，$E_{\\alpha} = 3.5 \\, \\text{MeV}$\n- Alpha 粒子能量沉积份额，$f_{\\alpha} = 1$\n\n为了以国际单位制（瓦特每立方米）计算 $p_{\\alpha}$，能量 $E_{\\alpha}$ 必须从兆电子伏特（$MeV$）转换为焦耳（$J$）。使用给定的转换因子 $1 \\, \\text{eV} = q_{e} \\, \\text{J}$，其中元电荷为 $q_{e} = 1.602176634 \\times 10^{-19} \\, \\text{C}$：\n$$\nE_{\\alpha} = 3.5 \\, \\text{MeV} = 3.5 \\times 10^{6} \\, \\text{eV} = (3.5 \\times 10^{6}) \\times (1.602176634 \\times 10^{-19} \\, \\text{J})\n$$\n$$\nE_{\\alpha} = 5.607618219 \\times 10^{-13} \\, \\text{J}\n$$\n现在，我们可以计算 $p_{\\alpha}$ 的值：\n$$\np_{\\alpha} = (1) \\times (1.0 \\times 10^{20} \\, \\text{m}^{-3} \\, \\text{s}^{-1}) \\times (5.607618219 \\times 10^{-13} \\, \\text{J})\n$$\n$$\np_{\\alpha} = 5.607618219 \\times 10^{7} \\, \\text{J} \\, \\text{m}^{-3} \\, \\text{s}^{-1}\n$$\n由于 $1 \\, \\text{瓦特} \\, (W) = 1 \\, \\text{焦耳每秒} \\, (J/s)$，我们有：\n$$\np_{\\alpha} = 5.607618219 \\times 10^{7} \\, \\text{W} \\, \\text{m}^{-3}\n$$\n问题要求答案以兆瓦每立方米（$MW/m^3$）为单位，其中 $1 \\, \\text{MW} = 10^{6} \\, \\text{W}$：\n$$\np_{\\alpha} = \\frac{5.607618219 \\times 10^{7}}{10^{6}} \\, \\text{MW} \\, \\text{m}^{-3} = 56.07618219 \\, \\text{MW} \\, \\text{m}^{-3}\n$$\n四舍五入到三位有效数字，我们得到：\n$$\np_{\\alpha} \\approx 56.1 \\, \\text{MW} \\, \\text{m}^{-3}\n$$\n这是第 (ii) 部分的答案。\n\n接下来，我们推导总 alpha 加热功率 $P_{\\alpha}$。这是体功率密度在整个等离子体体积 $V_{p}$ 上的积分。假设聚变反应速率密度 $R_{f}$ 在整个等离子体中是均匀的，正如问题陈述给出的单一值所暗示的那样，那么体功率密度 $p_{\\alpha}$ 也是均匀的。\n$$\nP_{\\alpha} = \\int_{V_p} p_{\\alpha} \\, dV = p_{\\alpha} \\int_{V_p} dV = p_{\\alpha} V_{p}\n$$\n等离子体体积为一个圆环体，其大半径为 $R = 1.50 \\, \\text{m}$，小半径为 $a = 0.30 \\, \\text{m}$。圆环体的体积由截面面积（$\\pi a^2$）与截面质心所循路径的长度（$2 \\pi R$）的乘积给出。\n$$\nV_{p} = (2\\pi R)(\\pi a^2) = 2\\pi^2 R a^2\n$$\n代入给定的半径值：\n$$\nV_{p} = 2\\pi^2 (1.50 \\, \\text{m}) (0.30 \\, \\text{m})^2 = 2\\pi^2 (1.50) (0.09) \\, \\text{m}^3 = 0.27\\pi^2 \\, \\text{m}^3\n$$\n$$\nV_{p} \\approx 2.66473339 \\, \\text{m}^3\n$$\n现在我们可以使用未四舍五入的 $p_{\\alpha}$ 值来计算总功率 $P_{\\alpha}$：\n$$\nP_{\\alpha} = (5.607618219 \\times 10^{7} \\, \\text{W} \\, \\text{m}^{-3}) \\times (0.27\\pi^2 \\, \\text{m}^3)\n$$\n$$\nP_{\\alpha} \\approx 149430386 \\, \\text{W} \\approx 1.4943 \\times 10^{8} \\, \\text{W}\n$$\n转换为兆瓦（$MW$）：\n$$\nP_{\\alpha} = \\frac{1.4943 \\times 10^{8}}{10^{6}} \\, \\text{MW} = 149.43 \\, \\text{MW}\n$$\n四舍五入到三位有效数字：\n$$\nP_{\\alpha} \\approx 149 \\, \\text{MW}\n$$\n这是第 (i) 部分的答案。\n\n问题要求将结果以行矩阵的形式报告，其中第一个条目是以兆瓦为单位的 $P_{\\alpha}$，第二个条目是以兆瓦每立方米为单位的体功率密度。\n最终的数值结果是 $P_{\\alpha} = 149 \\, \\text{MW}$ 和 $p_{\\alpha} = 56.1 \\, \\text{MW} \\, \\text{m}^{-3}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n149   56.1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在计算了主要的内部热源之后，下一个实践将其置于等离子体总能量收支的宏观框架中。我们将应用零维（0D）全局能量平衡方程，来判断在给定时刻等离子体的总储能是在增加还是减少。这个练习引入了至关重要的能量约束时间 $\\tau_E$ 的概念，并清晰地展示了各种加热和损失机制之间的动态相互作用。",
            "id": "4031964",
            "problem": "托卡马克中的磁约束等离子体通过一个零维全局能量平衡模型进行建模。设等离子体中存储的总热能为 $W(t)$，定义为 $W(t) = \\int \\frac{3}{2} p(\\mathbf{r},t)\\, dV$，其中 $p$ 是等离子体压力，$V$ 是等离子体体积。$W(t)$ 的变化率由能量守恒决定：外部和内部加热源增加能量，而能量损失则减少能量。主要的加热源是聚变产生的氦所带来的阿尔法粒子加热 $P_{\\alpha}$、来自等离子体电流的欧姆加热 $P_{\\text{ohm}}$，以及外部施加的辅助加热 $P_{\\text{aux}}$。辐射损失 $P_{\\text{rad}}$ 通过电磁辐射带走能量。剩余的输运损失（例如，跨磁场的传导和对流）由能量约束时间 $\\tau_E$ 来表征，其定义使得输运损失功率 $P_{\\text{trans}}$ 满足 $P_{\\text{trans}} = W/\\tau_E$。假设辐射损失不包含在 $P_{\\text{trans}}$ 中。\n\n给定 $P_{\\alpha} = 8\\,\\mathrm{MW}$、$P_{\\text{ohm}} = 2\\,\\mathrm{MW}$、$P_{\\text{aux}} = 20\\,\\mathrm{MW}$、$P_{\\text{rad}} = 5\\,\\mathrm{MW}$、$\\tau_E = 0.5\\,\\mathrm{s}$，以及在关心时刻的总热能 $W = 15\\,\\mathrm{MJ}$，使用全局能量守恒原理计算瞬时变化率 $\\frac{dW}{dt}$。将您的最终数值结果以兆瓦（MW）为单位表示，并四舍五入到三位有效数字。此外，根据 $\\frac{dW}{dt}$ 的符号，说明该时刻等离子体是处于能量积累状态还是能量耗散状态。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 步骤 1：提取给定条件\n问题陈述中逐字给出的条件如下：\n-   总热能：$W(t) = \\int \\frac{3}{2} p(\\mathbf{r},t)\\, dV$\n-   阿尔法粒子加热：$P_{\\alpha} = 8\\,\\mathrm{MW}$\n-   欧姆加热：$P_{\\text{ohm}} = 2\\,\\mathrm{MW}$\n-   辅助加热：$P_{\\text{aux}} = 20\\,\\mathrm{MW}$\n-   辐射损失：$P_{\\text{rad}} = 5\\,\\mathrm{MW}$\n-   能量约束时间：$\\tau_E = 0.5\\,\\mathrm{s}$\n-   在关心时刻的总热能：$W = 15\\,\\mathrm{MJ}$\n-   输运损失功率定义：$P_{\\text{trans}} = W/\\tau_E$\n-   能量平衡模型包括加热 ($P_{\\alpha}$, $P_{\\text{ohm}}$, $P_{\\text{aux}}$) 和损失 ($P_{\\text{rad}}$, $P_{\\text{trans}}$)。\n\n### 步骤 2：使用提取的给定条件进行验证\n对问题的有效性进行评估。\n-   **科学依据：** 该问题描述了托卡马克等离子体的零维（0D）全局能量平衡模型。这是聚变等离子体物理学中用于分析总功率平衡的一个标准和基础模型。控制方程和所有指定项（$P_{\\alpha}$、$P_{\\text{ohm}}$、$P_{\\text{aux}}$、$P_{\\text{rad}}$ 和 $P_{\\text{trans}} = W/\\tau_E$）都是公认的概念。该模型在科学上是合理的。\n-   **良态问题：** 该问题为总能量 $W$ 的时间演化提供了一个清晰的常微分方程，并提供了在特定时刻计算导数 $\\frac{dW}{dt}$ 所需的所有必要参数数值。该导数存在唯一解。\n-   **客观性：** 问题以精确、技术性的语言陈述，没有歧义或主观论断。\n-   **不完整或矛盾的设置：** 问题是自洽的。所有必要数据均已提供。没有矛盾之处。\n-   **不切实际或不可行：** 给定的储能（$W=15\\,\\mathrm{MJ}$）、约束时间（$\\tau_E=0.5\\,\\mathrm{s}$）和加热/损失功率（数个 MW）的数值在物理上是合理的，并且与大型现代托卡马克实验中观测到的值一致。单位需要进行简单的、一致的转换：$1\\,\\mathrm{J/s} = 1\\,\\mathrm{W}$，因此 $1\\,\\mathrm{MJ/s} = 1\\,\\mathrm{MW}$。输运功率的计算 $P_{\\text{trans}} = W/\\tau_E = 15\\,\\mathrm{MJ} / 0.5\\,\\mathrm{s} = 30\\,\\mathrm{MW}$ 在量纲上是正确的。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、良态的，并且所有提供的数据都是一致且物理上现实的。该问题是 **有效的**。将提供解答。\n\n全局能量守恒原理指出，总存储热能 $W$ 的变化率等于总输入加热功率减去等离子体的总损失功率。这可以写成以下微分方程：\n$$\n\\frac{dW}{dt} = P_{\\text{heat, total}} - P_{\\text{loss, total}}\n$$\n总加热功率 $P_{\\text{heat, total}}$ 是所有加热源的总和：\n$$\nP_{\\text{heat, total}} = P_{\\alpha} + P_{\\text{ohm}} + P_{\\text{aux}}\n$$\n总功率损失 $P_{\\text{loss, total}}$ 是辐射损失和输运损失的总和：\n$$\nP_{\\text{loss, total}} = P_{\\text{rad}} + P_{\\text{trans}}\n$$\n结合这些项，完整的能量平衡方程是：\n$$\n\\frac{dW}{dt} = P_{\\alpha} + P_{\\text{ohm}} + P_{\\text{aux}} - P_{\\text{rad}} - P_{\\text{trans}}\n$$\n问题将输运损失功率定义为 $P_{\\text{trans}} = W/\\tau_E$。将其代入平衡方程得到：\n$$\n\\frac{dW}{dt} = P_{\\alpha} + P_{\\text{ohm}} + P_{\\text{aux}} - P_{\\text{rad}} - \\frac{W}{\\tau_E}\n$$\n我们被要求使用特定时刻提供的数值来计算瞬时变化率 $\\frac{dW}{dt}$。给定的值为：\n$P_{\\alpha} = 8\\,\\mathrm{MW}$\n$P_{\\text{ohm}} = 2\\,\\mathrm{MW}$\n$P_{\\text{aux}} = 20\\,\\mathrm{MW}$\n$P_{\\text{rad}} = 5\\,\\mathrm{MW}$\n$W = 15\\,\\mathrm{MJ}$\n$\\tau_E = 0.5\\,\\mathrm{s}$\n\n首先，我们必须确保所有项的单位一致，特别是兆瓦（MW）。所有功率项都已经是MW。输运损失项 $\\frac{W}{\\tau_E}$ 必须计算并转换为MW。\n$$\nP_{\\text{trans}} = \\frac{W}{\\tau_E} = \\frac{15\\,\\mathrm{MJ}}{0.5\\,\\mathrm{s}} = \\frac{15 \\times 10^6\\,\\mathrm{J}}{0.5\\,\\mathrm{s}} = 30 \\times 10^6\\,\\frac{\\mathrm{J}}{\\mathrm{s}} = 30 \\times 10^6\\,\\mathrm{W} = 30\\,\\mathrm{MW}\n$$\n现在，将所有功率值代入能量平衡方程：\n$$\n\\frac{dW}{dt} = (8\\,\\mathrm{MW}) + (2\\,\\mathrm{MW}) + (20\\,\\mathrm{MW}) - (5\\,\\mathrm{MW}) - (30\\,\\mathrm{MW})\n$$\n将加热功率相加：\n$$\nP_{\\text{heat, total}} = 8 + 2 + 20 = 30\\,\\mathrm{MW}\n$$\n将损失功率相加：\n$$\nP_{\\text{loss, total}} = 5 + 30 = 35\\,\\mathrm{MW}\n$$\n因此，存储能量的变化率为：\n$$\n\\frac{dW}{dt} = 30\\,\\mathrm{MW} - 35\\,\\mathrm{MW} = -5\\,\\mathrm{MW}\n$$\n问题要求答案四舍五入到三位有效数字。整数结果 $-5$ 表示为 $-5.00$ 以表明此精度。\n$$\n\\frac{dW}{dt} = -5.00\\,\\mathrm{MW}\n$$\n$\\frac{dW}{dt}$ 的符号表示等离子体能量含量的状态。\n- 如果 $\\frac{dW}{dt} > 0$，则存储的能量在增加，这对应于能量积累。\n- 如果 $\\frac{dW}{dt}  0$，则存储的能量在减少，这对应于能量耗散。\n- 如果 $\\frac{dW}{dt} = 0$，则等离子体处于稳态。\n\n由于 $\\frac{dW}{dt} = -5.00\\,\\mathrm{MW}$ 为负值，等离子体在该时刻损失能量的速度快于被加热的速度。因此，等离子体处于 **能量耗散** 状态。",
            "answer": "$$ \\boxed{-5.00} $$"
        },
        {
            "introduction": "最后的实践将我们从理论计算带入计算科学的核心领域。我们将为前一个练习中探讨的动态能量平衡方程开发并验证一个数值求解器。通过将数值解与一个简化模型的精确解析解进行比较，这项实践旨在训练代码验证这一基本技能，以确保我们的计算模型既准确又可靠，这是计算聚变科学研究的基石。",
            "id": "4031972",
            "problem": "考虑一个聚变等离子体的零维（0D）能量平衡模型，其中总储存热能 $W(t)$ 在恒定的外部和自加热源以及线性损耗下，根据能量守恒定律演化。其控制常微分方程（ODE）为 $dW/dt = P_0 - \\alpha W$，初始条件为 $W(0) = W_0$，其中 $P_0$ 是以瓦特为单位的恒定净加热功率，$\\alpha$ 是以秒的倒数为单位的恒定线性损耗系数， $t$ 是以秒为单位的时间， $W$ 是以焦耳为单位的能量。从能量守恒的定义和一阶线性常微分方程的性质出发，推导出 $W(t)$ 作为 $t$、$P_0$、$\\alpha$ 和 $W_0$ 函数的解析解，过程中不得使用任何预先记忆的快捷公式。然后，构建一个基准测试，将此解析解与在均匀时间网格上使用四阶 Runge-Kutta (RK4) 方法执行的数值积分结果进行比较。对于每个测试用例，计算在离散时间网格（包括端点）上解析解与数值解之间的最大绝对偏差。所有偏差均以焦耳表示，并四舍五入到六位小数。使用以下测试套件，其涵盖了具有科学合理参数的典型、边界和刚性区域：\n\n- 测试用例 $1$：$P_0 = 5.0 \\times 10^{7}$ $\\mathrm{W}$，$\\alpha = 2.0$ $\\mathrm{s}^{-1}$，$W_0 = 2.0 \\times 10^{6}$ $\\mathrm{J}$，$T = 1.0$ $\\mathrm{s}$，$\\Delta t = 1.0 \\times 10^{-3}$ $\\mathrm{s}$。\n- 测试用例 $2$：$P_0 = 1.0 \\times 10^{6}$ $\\mathrm{W}$，$\\alpha = 0.0$ $\\mathrm{s}^{-1}$，$W_0 = 5.0 \\times 10^{5}$ $\\mathrm{J}$，$T = 1.0$ $\\mathrm{s}$，$\\Delta t = 1.0 \\times 10^{-3}$ $\\mathrm{s}$。\n- 测试用例 $3$：$P_0 = 0.0$ $\\mathrm{W}$，$\\alpha = 1.0$ $\\mathrm{s}^{-1}$，$W_0 = 5.0 \\times 10^{6}$ $\\mathrm{J}$，$T = 2.0$ $\\mathrm{s}$，$\\Delta t = 1.0 \\times 10^{-3}$ $\\mathrm{s}$。\n- 测试用例 $4$：$P_0 = 1.0 \\times 10^{6}$ $\\mathrm{W}$，$\\alpha = 1.0 \\times 10^{2}$ $\\mathrm{s}^{-1}$，$W_0 = 0.0$ $\\mathrm{J}$，$T = 2.0 \\times 10^{-1}$ $\\mathrm{s}$，$\\Delta t = 1.0 \\times 10^{-4}$ $\\mathrm{s}$。\n- 测试用例 $5$：$P_0 = 2.0 \\times 10^{7}$ $\\mathrm{W}$，$\\alpha = 5.0$ $\\mathrm{s}^{-1}$，$W_0 = 8.0 \\times 10^{6}$ $\\mathrm{J}$，$T = 1.0$ $\\mathrm{s}$，$\\Delta t = 2.0 \\times 10^{-3}$ $\\mathrm{s}$。\n\n您的程序必须：\n- 实现从第一性原理推导出的解析解。\n- 在步长为 $\\Delta t$ 的均匀网格上，使用四阶 Runge-Kutta 方法实现数值解。\n- 对于每个测试用例，计算解析 $W(t)$ 值和数值 $W(t)$ 值在网格上的最大绝对偏差 $E_{\\max}$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目都是以焦耳为单位的四舍五入后的偏差（例如，$[0.000001,0.000002,0.000003,0.000004,0.000005]$）。\n\n所有物理量必须使用其指定单位处理：能量单位为焦耳，功率单位为瓦特，时间单位为秒。不涉及角度。测试套件的最终输出必须是浮点数，单位为焦耳，四舍五入到六位小数，并按指定格式聚合为单个列表。",
            "solution": "该问题要求推导零维等离子体能量平衡模型的解析解，然后通过与四阶 Runge-Kutta (RK4) 方法的实现进行数值基准比较。\n\n**1. 问题陈述验证**\n\n*   **第 1 步：提取的已知条件**\n    *   控制常微分方程：$dW/dt = P_0 - \\alpha W$。\n    *   初始条件：$W(0) = W_0$。\n    *   变量和常量：\n        *   $W(t)$: 总储存热能，单位为焦耳 (J)。\n        *   $t$: 时间，单位为秒 (s)。\n        *   $P_0$: 恒定净加热功率，单位为瓦特 (W)。\n        *   $\\alpha$: 恒定线性损耗系数，单位为秒的倒数 ($\\mathrm{s}^{-1}$)。\n        *   $W_0$: $t=0$ 时的初始储存能量，单位为焦耳 (J)。\n    *   任务：从第一性原理推导 $W(t)$ 的解析解。\n    *   任务：实现一个四阶 Runge-Kutta (RK4) 数值积分器。\n    *   任务：对于每个测试用例，计算在从 $t=0$ 到 $t=T$、步长为 $\\Delta t$ 的均匀时间网格上，|$W_{\\text{analytic}}(t) - W_{\\text{numeric}}(t)$| 的最大绝对偏差 $E_{\\max}$。\n    *   测试套件：\n        1.  $P_0 = 5.0 \\times 10^{7}$ W, $\\alpha = 2.0$ $\\mathrm{s}^{-1}$, $W_0 = 2.0 \\times 10^{6}$ J, $T = 1.0$ s, $\\Delta t = 1.0 \\times 10^{-3}$ s.\n        2.  $P_0 = 1.0 \\times 10^{6}$ W, $\\alpha = 0.0$ $\\mathrm{s}^{-1}$, $W_0 = 5.0 \\times 10^{5}$ J, $T = 1.0$ s, $\\Delta t = 1.0 \\times 10^{-3}$ s.\n        3.  $P_0 = 0.0$ W, $\\alpha = 1.0$ $\\mathrm{s}^{-1}$, $W_0 = 5.0 \\times 10^{6}$ J, $T = 2.0$ s, $\\Delta t = 1.0 \\times 10^{-3}$ s.\n        4.  $P_0 = 1.0 \\times 10^{6}$ W, $\\alpha = 1.0 \\times 10^{2}$ $\\mathrm{s}^{-1}$, $W_0 = 0.0$ J, $T = 0.2$ s, $\\Delta t = 1.0 \\times 10^{-4}$ s.\n        5.  $P_0 = 2.0 \\times 10^{7}$ W, $\\alpha = 5.0$ $\\mathrm{s}^{-1}$, $W_0 = 8.0 \\times 10^{6}$ J, $T = 1.0$ s, $\\Delta t = 2.0 \\times 10^{-3}$ s.\n    *   输出：一个包含四舍五入后偏差（单位为焦耳）的单行列表。\n\n*   **第 2 步：已知条件的验证**\n    *   **科学依据：** 该问题描述了一个简化的（0D）能量平衡方程，这是等离子体物理和许多其他领域的标准基础模型。方程 $dW/dt = \\text{源} - \\text{损耗}$ 是能量守恒的直接应用。线性损耗项 $-\\alpha W$ 是能量输运的常见近似。该问题在科学上是合理的。\n    *   **良态性：** 该问题是一个带指定初始条件的一阶线性常微分方程。解的存在性和唯一性由 Picard-Lindelöf 定理保证，因为右侧项 $f(t,W) = P_0 - \\alpha W$ 是连续的，并且关于 $W$ 是 Lipschitz 连续的。\n    *   **客观性：** 该问题使用精确的数学和物理术语陈述。所有参数都有定量定义。任务是客观且可计算的。\n    *   **完整性：** 每个测试用例都提供了所有必要的参数（$P_0, \\alpha, W_0$）、积分域（从 $0$ 到 $T$）以及数值步长（$\\Delta t$）。该问题是自洽的。\n    *   **无其他缺陷**（例如不切实际、病态、过于简单等）。测试用例在物理上是合理的，并涵盖了有趣的区域（例如，无损耗、无加热、刚性系统）。\n\n*   **第 3 步：结论**\n    *   该问题有效。\n\n**2. 解析解的推导**\n\n控制常微分方程是一个一阶线性非齐次常微分方程：\n$$\n\\frac{dW}{dt} = P_0 - \\alpha W\n$$\n我们可以将其重写为标准形式：\n$$\n\\frac{dW}{dt} + \\alpha W(t) = P_0\n$$\n为了求解该方程，我们使用积分因子法。我们寻找一个函数 $\\mu(t)$，使得方程乘以该函数后，左边成为一个乘积的导数。对于形如 $y' + p(t)y = q(t)$ 的方程，积分因子为 $\\mu(t) = e^{\\int p(t) dt}$。在我们的例子中，$p(t) = \\alpha$，所以积分因子是：\n$$\n\\mu(t) = e^{\\int \\alpha dt} = e^{\\alpha t}\n$$\n将标准形式的常微分方程乘以 $\\mu(t)$：\n$$\ne^{\\alpha t} \\frac{dW}{dt} + \\alpha e^{\\alpha t} W(t) = P_0 e^{\\alpha t}\n$$\n根据构造，现在左边是微分的乘法法则应用于 $W(t) e^{\\alpha t}$ 的结果：\n$$\n\\frac{d}{dt} \\left( W(t) e^{\\alpha t} \\right) = P_0 e^{\\alpha t}\n$$\n现在我们对两边关于时间 $t$ 进行积分。这需要对 $\\alpha$ 的两种不同情况进行分析。\n\n情况 1：$\\alpha \\neq 0$\n$$\n\\int \\frac{d}{dt} \\left( W(t) e^{\\alpha t} \\right) dt = \\int P_0 e^{\\alpha t} dt\n$$\n$$\nW(t) e^{\\alpha t} = \\frac{P_0}{\\alpha} e^{\\alpha t} + C\n$$\n其中 $C$ 是积分常数。为了求出 $W(t)$，我们乘以 $e^{-\\alpha t}$：\n$$\nW(t) = \\frac{P_0}{\\alpha} + C e^{-\\alpha t}\n$$\n我们应用初始条件 $W(0) = W_0$ 来确定 $C$：\n$$\nW_0 = W(0) = \\frac{P_0}{\\alpha} + C e^{0} = \\frac{P_0}{\\alpha} + C\n$$\n这得到 $C = W_0 - \\frac{P_0}{\\alpha}$。将其代回通解，得到 $\\alpha \\neq 0$ 时的最终解析解：\n$$\nW(t) = \\frac{P_0}{\\alpha} + \\left( W_0 - \\frac{P_0}{\\alpha} \\right) e^{-\\alpha t}\n$$\n\n情况 2：$\\alpha = 0$\n如果 $\\alpha = 0$，原始常微分方程简化为：\n$$\n\\frac{dW}{dt} = P_0\n$$\n这可以通过直接积分求解：\n$$\n\\int dW = \\int P_0 dt\n$$\n$$\nW(t) = P_0 t + C'\n$$\n其中 $C'$ 是积分常数。应用初始条件 $W(0) = W_0$：\n$$\nW_0 = W(0) = P_0(0) + C' \\implies C' = W_0\n$$\n因此，$\\alpha = 0$ 时的解析解是：\n$$\nW(t) = W_0 + P_0 t\n$$\n\n**3. 数值解：四阶 Runge-Kutta (RK4) 方法**\n\n该常微分方程的形式为 $dW/dt = f(t, W)$，其中 $f(t, W) = P_0 - \\alpha W$。我们定义一个均匀时间网格 $t_n = n \\Delta t$，其中 $n=0, 1, 2, ...$，$\\Delta t$ 是恒定的时间步长。RK4 方法通过以下方式从时间 $t_n$ 的解 $W_n$ 迭代计算时间 $t_{n+1}$ 的数值解 $W_{n+1}$：\n$$\nW_{n+1} = W_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\n中间量 $k_i$ 由下式给出：\n$$\nk_1 = \\Delta t \\cdot f(t_n, W_n) = \\Delta t (P_0 - \\alpha W_n)\n$$\n$$\nk_2 = \\Delta t \\cdot f(t_n + \\Delta t/2, W_n + k_1/2) = \\Delta t (P_0 - \\alpha(W_n + k_1/2))\n$$\n$$\nk_3 = \\Delta t \\cdot f(t_n + \\Delta t/2, W_n + k_2/2) = \\Delta t (P_0 - \\alpha(W_n + k_2/2))\n$$\n$$\nk_4 = \\Delta t \\cdot f(t_n + \\Delta t, W_n + k_3) = \\Delta t (P_0 - \\alpha(W_n + k_3))\n$$\n从 $t_0=0$ 时的 $W_0$ 开始，该方案被迭代应用，以生成直到最终时间 $T$ 的整个时间网格上的数值解。\n\n**4. 基准测试程序**\n\n对于每个测试用例，算法按以下步骤进行：\n1.  建立一个从 $t=0$ 到 $t=T$、步长为 $\\Delta t$ 的均匀时间网格 $t_{\\text{grid}}$。步数为 $N = T/\\Delta t$。\n2.  使用上面推导的适当公式，在 $t_{\\text{grid}}$ 上的每个点计算解析解 $W_{\\text{analytic}}$。\n3.  通过用 $W_0$ 初始化并迭代 RK4 方案 $N$ 次来计算数值解 $W_{\\text{numeric}}$。\n4.  在每个网格点上计算两个解之间的绝对偏差：$E(t) = |W_{\\text{analytic}}(t) - W_{\\text{numeric}}(t)|$。\n5.  找出整个网格上该偏差的最大值 $E_{\\max} = \\max(E(t))$，并将其作为该测试用例的结果报告，四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 0D plasma energy balance problem, comparing analytic and RK4 solutions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (P_0, alpha, W_0, T, dt)\n        (5.0e7, 2.0, 2.0e6, 1.0, 1.0e-3),\n        (1.0e6, 0.0, 5.0e5, 1.0, 1.0e-3),\n        (0.0, 1.0, 5.0e6, 2.0, 1.0e-3),\n        (1.0e6, 1.0e2, 0.0, 2.0e-1, 1.0e-4),\n        (2.0e7, 5.0, 8.0e6, 1.0, 2.0e-3),\n    ]\n\n    results = []\n\n    def analytic_solution(t, P0, alpha, W0):\n        \"\"\"Computes the analytic solution for W(t).\"\"\"\n        if alpha == 0.0:\n            return W0 + P0 * t\n        else:\n            w_inf = P0 / alpha\n            return w_inf + (W0 - w_inf) * np.exp(-alpha * t)\n\n    def rk4_solver(P0, alpha, W0, T, dt):\n        \"\"\"\n        Solves dW/dt = P0 - alpha*W using the RK4 method.\n        Returns the time grid and the numerical solution W(t).\n        \"\"\"\n        # To handle potential floating point inaccuracies in T/dt\n        num_steps = int(round(T / dt))\n        t_grid = np.linspace(0, T, num_steps + 1)\n        \n        w_numeric = np.zeros(num_steps + 1)\n        w_numeric[0] = W0\n\n        def f(w_val):\n            # The ODE function dW/dt = f(t, W) is independent of t.\n            return P0 - alpha * w_val\n\n        for i in range(num_steps):\n            w_i = w_numeric[i]\n            \n            k1 = dt * f(w_i)\n            k2 = dt * f(w_i + 0.5 * k1)\n            k3 = dt * f(w_i + 0.5 * k2)\n            k4 = dt * f(w_i + k3)\n            \n            w_numeric[i + 1] = w_i + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n            \n        return t_grid, w_numeric\n\n    for case in test_cases:\n        P0, alpha, W0, T, dt = case\n\n        # Generate the numerical solution and its corresponding time grid\n        t_grid, w_numeric_solution = rk4_solver(P0, alpha, W0, T, dt)\n        \n        # Calculate the analytic solution on the same time grid\n        w_analytic_solution = analytic_solution(t_grid, P0, alpha, W0)\n        \n        # Compute the maximum absolute deviation\n        max_deviation = np.max(np.abs(w_analytic_solution - w_numeric_solution))\n        \n        # Round the result to six decimal places and append\n        results.append(round(max_deviation, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}