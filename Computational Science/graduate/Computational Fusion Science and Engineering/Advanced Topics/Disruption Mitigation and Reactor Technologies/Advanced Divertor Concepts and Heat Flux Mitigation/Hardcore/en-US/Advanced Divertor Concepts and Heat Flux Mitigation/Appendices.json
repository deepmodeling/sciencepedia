{
    "hands_on_practices": [
        {
            "introduction": "A key parameter in determining the peak heat flux to a divertor is the scrape-off layer (SOL) heat-flux width, $\\lambda_q$. This exercise explores the widely-used Eich empirical scaling, which connects $\\lambda_q$ to the poloidal magnetic field at the plasma edge, $B_p$. By calibrating this scaling law from baseline machine data and first-principles physics, you will gain hands-on experience in predicting divertor conditions and assessing their sensitivity to global plasma parameters like current and safety factor .",
            "id": "3948048",
            "problem": "A medium-size tokamak operates in an attached divertor regime where the divertor target heat-flux profile is well described by an exponential fall-off mapped to the outboard midplane scrape-off layer (SOL) width. Following the Eich scaling, the SOL heat-flux width scales inversely with the edge poloidal magnetic field, so that $\\lambda_q = \\alpha/B_p$, where $\\alpha$ is a device-independent calibration constant to be determined from a baseline case. Assume a large-aspect-ratio, circular plasma so that the edge poloidal magnetic field and the edge safety factor are related by standard definitions. Starting from Ampère’s law and the definition of the safety factor, express $B_p$ at the last closed flux surface in terms of either the plasma current $I_p$ and minor radius $a$, or equivalently in terms of the toroidal magnetic field $B_t$, major radius $R$, minor radius $a$, and the edge safety factor $q_{95}$. Use these relations to eliminate $B_p$ in $\\lambda_q=\\alpha/B_p$ and obtain a calibrated analytic expression for $\\lambda_q(R, a, B_t, q_{95})$.\n\nCalibration baseline: device parameters $R_0 = 1.65\\,\\text{m}$, $a_0 = 0.50\\,\\text{m}$, $B_{t0} = 2.10\\,\\text{T}$, $I_{p0} = 0.53\\,\\text{MA}$. In this baseline, the Eich midplane width is measured to be $\\lambda_{q0} = 6.0\\,\\text{mm}$ in the same operating regime (assume the standard flux expansion corrections have been applied so that $\\lambda_{q0}$ is the outboard midplane equivalent). Take the vacuum permeability as $\\mu_0$ and assume large-aspect-ratio, circular cross-section approximations are valid.\n\nTasks:\n1) Using first principles, relate $B_p$ at the edge to $I_p$ and $a$, and also to $R$, $a$, $B_t$, and $q_{95}$. From these relations, compute the calibration constant $\\alpha$ from the baseline.\n2) Eliminate $B_p$ and derive the calibrated analytic expression $\\lambda_q(R, a, B_t, q_{95})$ implied by Eich scaling and your calibration for $\\alpha$. Your final boxed answer must be this analytic expression, expressed in SI units with $R$ and $a$ in meters and $B_t$ in tesla, returning $\\lambda_q$ in meters.\n3) For a distinct target machine with $R=3.00\\,\\text{m}$, $a=0.90\\,\\text{m}$, $B_t=5.30\\,\\text{T}$, and $q_{95}=3.50$, compute the numerical value of $\\lambda_q$ in millimeters, and round your result to four significant figures.\n4) At fixed geometry $(R,a)$ and $B_t$, assess the local logarithmic sensitivity of $\\lambda_q$ to $I_p$ and to $q_{95}$, defined as $S_{x} \\equiv \\partial \\ln \\lambda_q/\\partial \\ln x$, and comment on any interdependence between $I_p$ and $q_{95}$ within the large-aspect-ratio, circular approximation.\n\nImportant:\n- Use only first-principles starting points (Ampère’s law and the definition of the safety factor) and well-tested facts.\n- Report the requested numerical value in millimeters and round to four significant figures.\n- Provide your final boxed answer as the single calibrated analytic expression for $\\lambda_q(R, a, B_t, q_{95})$ in SI units, as specified in item 2). Do not include units inside the box.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in established tokamak physics, well-posed with sufficient data for a unique solution, and expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe solution is structured to address the four tasks presented in the problem statement in sequential order.\n\n**1) Derivation of Poloidal Magnetic Field Relations and Calibration of $\\alpha$**\n\nFirst, we relate the edge poloidal magnetic field, $B_p$, to the plasma current $I_p$ and the minor radius $a$. We start from the integral form of Ampère's law:\n$$\n\\oint_{\\mathcal{C}} \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}}\n$$\nwhere $\\mu_0$ is the permeability of free space and $I_{\\text{enc}}$ is the current enclosed by the loop $\\mathcal{C}$. For a large-aspect-ratio, circular tokamak plasma, we can approximate the last closed flux surface as a circle of radius $a$. We choose this circle as our integration path $\\mathcal{C}$. The magnetic field component tangent to this path is the poloidal field $B_p$. By symmetry in this approximation, $B_p$ is constant along the path. The total enclosed current is the plasma current, $I_p$. Thus, Ampère's law simplifies to:\n$$\nB_p \\oint_{\\mathcal{C}} dl = B_p (2 \\pi a) = \\mu_0 I_p\n$$\nSolving for $B_p$ at the plasma edge (minor radius $r=a$) yields our first relation:\n$$\nB_p = \\frac{\\mu_0 I_p}{2 \\pi a}\n$$\n\nNext, we relate $B_p$ to the toroidal magnetic field $B_t$, the major radius $R$, the minor radius $a$, and the edge safety factor $q_{95}$. The safety factor $q$ is defined as the number of toroidal turns a magnetic field line makes for one poloidal turn. For a large-aspect-ratio, circular plasma, this can be approximated as the ratio of the connection lengths in the toroidal and poloidal directions:\n$$\nq \\approx \\frac{L_\\phi}{L_\\theta} = \\frac{2 \\pi R}{2 \\pi r} \\frac{B_t}{B_p} = \\frac{r B_t}{R B_p}\n$$\nwhere $r$ is the minor radial coordinate. At the edge of the plasma, $r=a$, and the safety factor is denoted $q_{95}$ (or $q_a$ in this simplified model).\n$$\nq_{95} \\approx \\frac{a B_t}{R B_p}\n$$\nSolving for $B_p$ gives the second relation:\n$$\nB_p = \\frac{a B_t}{R q_{95}}\n$$\nThese two expressions for $B_p$ are physically consistent; equating them yields the standard large-aspect-ratio formula relating $q_{95}$ and $I_p$: $q_{95} \\approx \\frac{2 \\pi a^2 B_t}{\\mu_0 R I_p}$.\n\nNow, we calibrate the constant $\\alpha$ from the Eich scaling law, $\\lambda_q = \\alpha/B_p$. Using the baseline case parameters, we have $\\alpha = \\lambda_{q0} B_{p0}$. We will calculate $B_{p0}$ using the first relation, as $I_{p0}$ is provided.\nThe baseline parameters in SI units are:\n$I_{p0} = 0.53\\,\\text{MA} = 5.3 \\times 10^5\\,\\text{A}$\n$a_0 = 0.50\\,\\text{m}$\n$\\lambda_{q0} = 6.0\\,\\text{mm} = 6.0 \\times 10^{-3}\\,\\text{m}$\nAnd the value of $\\mu_0$ is $4\\pi \\times 10^{-7}\\,\\text{T}\\cdot\\text{m/A}$.\n\nFirst, we calculate the edge poloidal field for the baseline case:\n$$\nB_{p0} = \\frac{\\mu_0 I_{p0}}{2 \\pi a_0} = \\frac{(4\\pi \\times 10^{-7}\\,\\text{T}\\cdot\\text{m/A}) (5.3 \\times 10^5\\,\\text{A})}{2 \\pi (0.50\\,\\text{m})} = \\frac{2 \\times 10^{-7} \\times 5.3 \\times 10^5}{0.50}\\,\\text{T} = 0.212\\,\\text{T}\n$$\nNow, we can compute the device-independent calibration constant $\\alpha$:\n$$\n\\alpha = \\lambda_{q0} B_{p0} = (6.0 \\times 10^{-3}\\,\\text{m}) (0.212\\,\\text{T}) = 1.272 \\times 10^{-3}\\,\\text{m}\\cdot\\text{T}\n$$\n\n**2) Derivation of the Calibrated Analytic Expression for $\\lambda_q$**\n\nThe goal is to find an expression for $\\lambda_q$ in terms of $R$, $a$, $B_t$, and $q_{95}$. We start with the Eich scaling law, $\\lambda_q = \\alpha/B_p$, and substitute the expression for $B_p$ in terms of $q_{95}$:\n$$\n\\lambda_q = \\frac{\\alpha}{B_p} = \\frac{\\alpha}{\\left(\\frac{a B_t}{R q_{95}}\\right)} = \\alpha \\frac{R q_{95}}{a B_t}\n$$\nNow, we substitute the calibrated numerical value for $\\alpha$:\n$$\n\\lambda_q(R, a, B_t, q_{95}) = \\frac{(1.272 \\times 10^{-3}\\,\\text{m}\\cdot\\text{T}) R q_{95}}{a B_t}\n$$\nThis is the calibrated analytic expression. When provided with $R$ and $a$ in meters and $B_t$ in tesla, this formula returns $\\lambda_q$ in meters. This is the expression required for the final answer.\n\n**3) Numerical Calculation for the Target Machine**\n\nWe now use the derived formula to calculate $\\lambda_q$ for the target machine with the following parameters:\n$R = 3.00\\,\\text{m}$\n$a = 0.90\\,\\text{m}$\n$B_t = 5.30\\,\\text{T}$\n$q_{95} = 3.50$\n\nSubstituting these values into our expression:\n$$\n\\lambda_q = \\frac{(1.272 \\times 10^{-3}) (3.00) (3.50)}{(0.90) (5.30)} \\,\\text{m}\n$$\n$$\n\\lambda_q = \\frac{0.013356}{4.77} \\,\\text{m} \\approx 2.80008 \\times 10^{-3}\\,\\text{m}\n$$\nThe problem requests the answer in millimeters, rounded to four significant figures.\n$$\n\\lambda_q \\approx 2.800\\,\\text{mm}\n$$\n\n**4) Logarithmic Sensitivity Analysis**\n\nThe logarithmic sensitivity of $\\lambda_q$ to a parameter $x$ is defined as $S_x \\equiv \\frac{\\partial \\ln \\lambda_q}{\\partial \\ln x}$.\n\nFirst, we find the sensitivity to plasma current, $S_{I_p}$. We must express $\\lambda_q$ in terms of $I_p$. Using $\\lambda_q = \\alpha/B_p$ and $B_p = \\frac{\\mu_0 I_p}{2 \\pi a}$:\n$$\n\\lambda_q = \\frac{\\alpha}{\\frac{\\mu_0 I_p}{2 \\pi a}} = \\frac{2 \\pi a \\alpha}{\\mu_0} I_p^{-1}\n$$\nTaking the natural logarithm:\n$$\n\\ln(\\lambda_q) = \\ln\\left(\\frac{2 \\pi a \\alpha}{\\mu_0}\\right) - \\ln(I_p)\n$$\nThe sensitivity is the derivative with respect to $\\ln(I_p)$:\n$$\nS_{I_p} = \\frac{\\partial \\ln(\\lambda_q)}{\\partial \\ln(I_p)} = -1\n$$\nThis indicates that the SOL heat-flux width is inversely proportional to the plasma current.\n\nNext, we find the sensitivity to the edge safety factor, $S_{q_{95}}$. We use the expression derived in Task 2:\n$$\n\\lambda_q = \\left(\\frac{\\alpha R}{a B_t}\\right) q_{95}\n$$\nTaking the natural logarithm:\n$$\n\\ln(\\lambda_q) = \\ln\\left(\\frac{\\alpha R}{a B_t}\\right) + \\ln(q_{95})\n$$\nThe sensitivity is the derivative with respect to $\\ln(q_{95})$:\n$$\nS_{q_{95}} = \\frac{\\partial \\ln(\\lambda_q)}{\\partial \\ln(q_{95})} = 1\n$$\nThis indicates that the SOL heat-flux width is directly proportional to the edge safety factor.\n\nRegarding the interdependence between $I_p$ and $q_{95}$: as established in Task 1, for a given device geometry ($R, a$) and toroidal field ($B_t$), these two parameters are not independent. They are related by $q_{95} \\propto 1/I_p$. This means that increasing the plasma current directly causes a decrease in the edge safety factor. The sensitivities $S_{I_p} = -1$ and $S_{q_{95}} = 1$ are perfectly consistent with this physical constraint. The apparent dependencies on $I_p$ and $q_{95}$ are two different perspectives on the same underlying physical relationship, which is ultimately tied to the strength of the poloidal magnetic field $B_p$.",
            "answer": "$$\n\\boxed{\\frac{1.272 \\times 10^{-3} R q_{95}}{a B_t}}\n$$"
        },
        {
            "introduction": "While empirical scalings are useful, a deeper understanding of the SOL width requires physics-based transport models. This practice guides you through constructing a simplified 1D model that captures the essential competition between cross-field diffusion and parallel losses to the divertor, which is the core physics simulated in complex codes like SOLPS. By performing a sensitivity study on the transport coefficients $D$ and $\\chi$, you will develop a mechanistic intuition for how they govern the SOL profiles and the resulting heat-flux width .",
            "id": "3948076",
            "problem": "A one-dimensional cross-field model of the Scrape-Off Layer (SOL) in a diverted tokamak is used to construct a sensitivity study for the cross-field transport coefficients. The SOL connects the confined plasma to the divertor target along magnetic field lines, with parallel losses represented by characteristic times. In computational edge plasma modeling, such as with the Scrape-Off Layer Plasma Simulation (SOLPS), and related codes like Unstructured Edge Plasma Solver (UEDGE) and EDGE2D, cross-field particle diffusivity and thermal diffusivity are frequently parameterized as constant coefficients under steady-state conditions. In this problem, you will derive and implement a minimal, scientifically sound surrogate of a baseline SOLPS case and quantify the sensitivity of the heat-flux width and target-normal heat flux to variations in cross-field transport.\n\nModel assumptions and governing equations:\n- Let $x \\ge 0$ denote the cross-field coordinate measured radially outward from the separatrix at the divertor target plane (mapped coordinate).\n- The particle density $n(x)$ obeys steady-state Fickian diffusion with a parallel loss sink,\n$$D \\frac{d^2 n}{dx^2} - \\frac{n}{\\tau_p} = 0,$$\nwith boundary condition $n(0) = n_{\\mathrm{sep}}$ and $n(\\infty) \\to 0$, so\n$$n(x) = n_{\\mathrm{sep}} \\exp\\left(-\\frac{x}{\\lambda_n}\\right), \\quad \\lambda_n = \\sqrt{D \\tau_p}.$$\n- The electron temperature $T(x)$ obeys steady-state thermal diffusion with a parallel energy loss sink,\n$$\\chi \\frac{d^2 T}{dx^2} - \\frac{T}{\\tau_E} = 0,$$\nwith boundary condition $T(0) = T_{\\mathrm{sep}}$ and $T(\\infty) \\to 0$, so\n$$T(x) = T_{\\mathrm{sep}} \\exp\\left(-\\frac{x}{\\lambda_T}\\right), \\quad \\lambda_T = \\sqrt{\\chi \\tau_E}.$$\n- The parallel loss times are modeled by isothermal sound-speed limited loss along the field line of length $L_{\\parallel}$,\n$$\\tau_p = \\frac{L_{\\parallel}}{c_s}, \\quad \\tau_E = \\alpha_E \\frac{L_{\\parallel}}{c_s},$$\nwhere $c_s$ is the sound speed and $\\alpha_E$ is a dimensionless energy-loss factor. For a deuterium plasma with electron temperature $T_{\\mathrm{sep}}$ in electronvolts (eV),\n$$c_s = \\sqrt{\\frac{e\\, T_{\\mathrm{sep}}}{m_i}},$$\nwith $e$ the elementary charge and $m_i$ the deuterium ion mass.\n- The target-normal heat flux due to cross-field transport is modeled by\n$$q_{\\perp}(x) = - n(x)\\, \\left(\\frac{3}{2} e\\right)\\, \\chi \\frac{d T}{dx},$$\nwhich at the separatrix-mapped location ($x=0$) gives the amplitude\n$$q_{\\perp,0} = \\left(\\frac{3}{2} e\\right)\\, \\chi\\, \\frac{n_{\\mathrm{sep}}\\, T_{\\mathrm{sep}}}{\\lambda_T}.$$\n- The heat flux profile is the product of exponentials from $n(x)$ and $T(x)$, yielding an effective e-folding width\n$$\\lambda_{\\mathrm{eff}} = \\left(\\frac{1}{\\lambda_T} + \\frac{1}{\\lambda_n}\\right)^{-1}.$$\nAccounting for magnetic flux expansion between the upstream midplane and the divertor target, the target heat-flux width is\n$$\\lambda_q = f_x\\, \\lambda_{\\mathrm{eff}},$$\nwhere $f_x$ is the flux expansion factor.\n\nFundamental constants and baseline parameters:\n- Elementary charge $e = 1.602\\times 10^{-19}\\,\\mathrm{C}$.\n- Deuterium ion mass $m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg}$.\n- Baseline upstream separatrix density $n_{\\mathrm{sep}} = 2.5\\times 10^{20}\\,\\mathrm{m}^{-3}$.\n- Baseline upstream separatrix electron temperature $T_{\\mathrm{sep}} = 150\\,\\mathrm{eV}$.\n- Parallel connection length $L_{\\parallel} = 25\\,\\mathrm{m}$.\n- Energy-loss factor $\\alpha_E = 0.7$ (dimensionless).\n- Flux expansion factor $f_x = 5$ (dimensionless).\n\nTask:\n1. Starting from the above fundamental laws and definitions, derive expressions for $\\lambda_n$, $\\lambda_T$, $\\lambda_{\\mathrm{eff}}$, $\\lambda_q$, and $q_{\\perp,0}$ as functions of the cross-field particle diffusivity $D$ and thermal diffusivity $\\chi$.\n2. Implement a program that computes, for each test case in the test suite below, the pair $(\\lambda_q, q_{\\perp,0})$ using the baseline parameters and constants. Express $\\lambda_q$ in meters and $q_{\\perp,0}$ in $\\mathrm{MW}/\\mathrm{m}^2$. Also compute the ratios $\\lambda_q/\\lambda_{q,\\mathrm{baseline}}$ and $q_{\\perp,0}/q_{\\perp,0,\\mathrm{baseline}}$ relative to the baseline test case.\n3. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a four-element list $[\\lambda_q, q_{\\perp,0}, \\lambda_q/\\lambda_{q,\\mathrm{baseline}}, q_{\\perp,0}/q_{\\perp,0,\\mathrm{baseline}}]$ in that order.\n\nAngle units are not involved. Physical units must be precisely handled as specified above.\n\nTest suite (each case provides $(D,\\chi)$ in $\\mathrm{m}^2/\\mathrm{s}$):\n- Case A (baseline): $D = 0.3$, $\\chi = 1.5$.\n- Case B (low diffusivities): $D = 0.1$, $\\chi = 0.8$.\n- Case C (high diffusivities): $D = 1.0$, $\\chi = 2.5$.\n- Case D (higher particle diffusivity and moderate thermal diffusivity): $D = 0.6$, $\\chi = 1.0$.\n- Case E (very low particle diffusivity and high thermal diffusivity): $D = 0.05$, $\\chi = 3.0$.\n\nAnswer specification:\n- For each test case, output the list $[\\lambda_q, q_{\\perp,0}, \\lambda_q/\\lambda_{q,\\mathrm{baseline}}, q_{\\perp,0}/q_{\\perp,0,\\mathrm{baseline}}]$ where $\\lambda_q$ is in meters, $q_{\\perp,0}$ is in $\\mathrm{MW}/\\mathrm{m}^2$, and the ratios are dimensionless decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],\\dots]$.",
            "solution": "The problem provides a one-dimensional, steady-state model for particle and heat transport in the Scrape-Off Layer (SOL) of a tokamak. The objective is to derive expressions for key SOL parameters and then compute their values for a set of cross-field transport coefficients, quantifying the sensitivity of the heat-flux width and peak heat flux to these coefficients.\n\nFirst, we establish the constant parameters and intermediate quantities that are a function of the baseline plasma conditions and do not change between test cases.\n\nThe fundamental constants and baseline parameters are:\n- Elementary charge: $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n- Deuterium ion mass: $m_i = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$\n- Separatrix density: $n_{\\mathrm{sep}} = 2.5 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n- Separatrix electron temperature: $T_{\\mathrm{sep}} = 150\\,\\mathrm{eV}$\n- Parallel connection length: $L_{\\parallel} = 25\\,\\mathrm{m}$\n- Energy-loss factor: $\\alpha_E = 0.7$\n- Flux expansion factor: $f_x = 5$\n\nThe parallel loss times, $\\tau_p$ and $\\tau_E$, depend on the isothermal sound speed $c_s$. In plasma physics, when temperature is given in electronvolts (eV), it represents an energy scale. The corresponding energy in Joules is obtained by multiplying by the elementary charge $e$. The formula for the sound speed, $c_s = \\sqrt{e T_{\\mathrm{sep}} / m_i}$, correctly uses this convention, where $T_{\\mathrm{sep}}$ is numerically equal to the value in eV (i.e., $150$) and the product $e T_{\\mathrm{sep}}$ represents the thermal energy in Joules.\n\nThe sound speed $c_s$ is calculated as:\n$$c_s = \\sqrt{\\frac{e T_{\\mathrm{sep}}}{m_i}} = \\sqrt{\\frac{(1.602 \\times 10^{-19}\\,\\mathrm{C}) \\times (150\\,\\mathrm{V})}{3.345 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx 84757.63\\,\\mathrm{m/s}$$\nNote that the unit of $T_{\\mathrm{sep}}$ in this calculation is effectively Volts to yield an energy $eT_{\\mathrm{sep}}$ in Joules.\n\nUsing this value for $c_s$, the characteristic parallel loss times for particles ($\\tau_p$) and energy ($\\tau_E$) are:\n$$\\tau_p = \\frac{L_{\\parallel}}{c_s} = \\frac{25\\,\\mathrm{m}}{84757.63\\,\\mathrm{m/s}} \\approx 2.9496 \\times 10^{-4}\\,\\mathrm{s}$$\n$$\\tau_E = \\alpha_E \\frac{L_{\\parallel}}{c_s} = \\alpha_E \\tau_p = 0.7 \\times (2.9496 \\times 10^{-4}\\,\\mathrm{s}) \\approx 2.0647 \\times 10^{-4}\\,\\mathrm{s}$$\nThese values are constant for all test cases.\n\nNow, we derive the expressions for the requested quantities as functions of the particle diffusivity $D$ and thermal diffusivity $\\chi$.\n\n1.  **Decay lengths $\\lambda_n$ and $\\lambda_T$**:\n    The e-folding lengths for density and temperature are given by the model:\n    $$\\lambda_n = \\sqrt{D \\tau_p}$$\n    $$\\lambda_T = \\sqrt{\\chi \\tau_E}$$\n    Since $\\tau_p$ and $\\tau_E$ are constants, we find the scaling relationships $\\lambda_n \\propto \\sqrt{D}$ and $\\lambda_T \\propto \\sqrt{\\chi}$.\n\n2.  **Effective and target heat-flux widths $\\lambda_{\\mathrm{eff}}$ and $\\lambda_q$**:\n    The heat flux profile is proportional to the product of the density and temperature profiles, $n(x)T(x) \\propto \\exp(-x/\\lambda_n)\\exp(-x/\\lambda_T) = \\exp(-x(1/\\lambda_n+1/\\lambda_T))$. The effective decay length $\\lambda_{\\mathrm{eff}}$ is therefore the harmonic sum of the individual decay lengths:\n    $$\\lambda_{\\mathrm{eff}} = \\left(\\frac{1}{\\lambda_n} + \\frac{1}{\\lambda_T}\\right)^{-1} = \\frac{\\lambda_n \\lambda_T}{\\lambda_n + \\lambda_T}$$\n    Substituting the expressions for $\\lambda_n$ and $\\lambda_T$:\n    $$\\lambda_{\\mathrm{eff}} = \\frac{\\sqrt{D \\tau_p} \\sqrt{\\chi \\tau_E}}{\\sqrt{D \\tau_p} + \\sqrt{\\chi \\tau_E}}$$\n    The target heat flux width $\\lambda_q$ accounts for magnetic flux expansion from the upstream midplane to the target:\n    $$\\lambda_q = f_x \\lambda_{\\mathrm{eff}} = f_x \\frac{\\sqrt{D \\tau_p \\chi \\tau_E}}{\\sqrt{D \\tau_p} + \\sqrt{\\chi \\tau_E}}$$\n\n3.  **Peak cross-field heat flux $q_{\\perp,0}$**:\n    The cross-field heat flux at the separatrix ($x=0$) is defined as:\n    $$q_{\\perp,0} = \\left(\\frac{3}{2} e\\right)\\, \\chi\\, \\frac{n_{\\mathrm{sep}}\\, T_{\\mathrm{sep}}}{\\lambda_T}$$\n    In this expression, consistency of units requires $T$ to be in Volts, as established previously. Thus, we use $T_{\\mathrm{sep}} = 150\\,\\mathrm{V}$.\n    To find the dependence on $\\chi$, we substitute the expression for $\\lambda_T$:\n    $$q_{\\perp,0} = \\left(\\frac{3}{2} e n_{\\mathrm{sep}} T_{\\mathrm{sep}}\\right) \\frac{\\chi}{\\sqrt{\\chi \\tau_E}} = \\left(\\frac{3}{2} \\frac{e n_{\\mathrm{sep}} T_{\\mathrm{sep}}}{\\sqrt{\\tau_E}}\\right) \\sqrt{\\chi}$$\n    Since all terms in the parenthesis are constant, the peak cross-field heat flux scales as $q_{\\perp,0} \\propto \\sqrt{\\chi}$ and is independent of the particle diffusivity $D$.\n\nThe computational procedure is as follows:\nFirst, the baseline case (Case A: $D=0.3\\,\\mathrm{m}^2/\\mathrm{s}$, $\\chi=1.5\\,\\mathrm{m}^2/\\mathrm{s}$) is computed to establish the reference values $\\lambda_{q,\\mathrm{baseline}}$ and $q_{\\perp,0,\\mathrm{baseline}}$. For this case, the ratios are by definition $1.0$.\nThen, for each subsequent test case, the quantities $\\lambda_q$ and $q_{\\perp,0}$ are calculated using the derived formulas. The result for $q_{\\perp,0}$ is converted from $\\mathrm{W/m^2}$ to $\\mathrm{MW/m^2}$ by dividing by $10^6$. Finally, the ratios of these values to their respective baseline values are computed. The final output is a list containing the results for each case. Each case's result is a list of four values: $[\\lambda_q, q_{\\perp,0}, \\lambda_q/\\lambda_{q,\\mathrm{baseline}}, q_{\\perp,0}/q_{\\perp,0,\\mathrm{baseline}}]$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes SOL parameters based on a 1D cross-field transport model and\n    quantifies sensitivity to transport coefficients D and chi.\n    \"\"\"\n    # Fundamental constants and baseline parameters\n    e = 1.602e-19  # Elementary charge in Coulombs\n    m_i = 3.345e-27 # Deuterium ion mass in kg\n    n_sep = 2.5e20  # Separatrix density in m^-3\n    T_sep = 150.0   # Separatrix temperature in eV (used as V in formulas)\n    L_parallel = 25.0 # Parallel connection length in m\n    alpha_E = 0.7   # Energy-loss factor (dimensionless)\n    f_x = 5.0       # Flux expansion factor (dimensionless)\n\n    # Test suite: (D, chi) in m^2/s\n    test_cases = [\n        (0.3, 1.5),   # Case A (baseline)\n        (0.1, 0.8),   # Case B\n        (1.0, 2.5),   # Case C\n        (0.6, 1.0),   # Case D\n        (0.05, 3.0),  # Case E\n    ]\n\n    # Pre-calculate constant intermediate values\n    # Sound speed (T_sep is in V for energy in J)\n    c_s = np.sqrt(e * T_sep / m_i)\n    \n    # Parallel loss times\n    tau_p = L_parallel / c_s\n    tau_E = alpha_E * tau_p\n\n    results = []\n    lambda_q_baseline = None\n    q_perp_0_baseline = None\n\n    for i, (D, chi) in enumerate(test_cases):\n        # 1. Calculate decay lengths lambda_n and lambda_T\n        lambda_n = np.sqrt(D * tau_p)\n        lambda_T = np.sqrt(chi * tau_E)\n\n        # 2. Calculate effective and target heat-flux widths\n        lambda_eff = (lambda_n * lambda_T) / (lambda_n + lambda_T)\n        lambda_q = f_x * lambda_eff  # in meters\n\n        # 3. Calculate peak cross-field heat flux\n        # The formula uses T in Volts, numerically same as eV value.\n        # Result is in W/m^2.\n        q_perp_0_W_m2 = (1.5 * e) * chi * (n_sep * T_sep) / lambda_T\n        q_perp_0 = q_perp_0_W_m2 / 1e6  # Convert to MW/m^2\n\n        # 4. Store baseline values and compute ratios\n        if i == 0:  # Baseline case\n            lambda_q_baseline = lambda_q\n            q_perp_0_baseline = q_perp_0\n            lambda_q_ratio = 1.0\n            q_perp_0_ratio = 1.0\n        else:\n            lambda_q_ratio = lambda_q / lambda_q_baseline\n            q_perp_0_ratio = q_perp_0 / q_perp_0_baseline\n        \n        # Append results for the current case\n        results.append([lambda_q, q_perp_0, lambda_q_ratio, q_perp_0_ratio])\n        \n    # Format the output as specified: a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "To prevent divertor target damage, a significant fraction of the power entering the SOL must be dissipated before it reaches the material surface. This exercise focuses on the primary method for achieving this: impurity radiation, a process where seeded impurities radiate energy away as light. You will construct a simplified collisional-radiative model to compute the radiation from nitrogen or neon impurities, allowing you to determine the optimal plasma temperature range for maximizing heat dissipation in the divertor .",
            "id": "3948108",
            "problem": "Consider an optically thin divertor plasma with electron temperature $T_e$ and electron density $n_e$, seeded with a low atomic number impurity species. You are asked to construct a simplified Collisional-Radiative (CR) model for a neutral impurity that captures line radiation from a small set of representative transitions and includes ionization-recombination balance for the neutral fraction. The objective is to compute the total line radiation power per unit volume $P_{\\rm rad}(T_e)$ and determine the electron temperature range that maximizes radiation for given plasma and impurity parameters. The model must be based on first principles and well-tested formulas, and the result must be computed numerically over a specified domain.\n\nFundamental basis and assumptions:\n- Electrons follow a Maxwellian distribution at temperature $T_e$.\n- The plasma is optically thin, so photons escape without reabsorption.\n- Excitation and de-excitation are dominated by electron-impact and spontaneous emission.\n- The ground state dominates the neutral population, and metastable densities are neglected for the excitation source term.\n- The neutral fraction of the impurity is governed by steady-state ionization-recombination balance between the neutral and singly ionized charge states.\n\nModel ingredients and formulas:\n- Let the total impurity density be $n_Z$. The neutral fraction $f_0(T_e)$ is determined from steady-state balance between electron-impact ionization and radiative recombination:\n$$\nS_{\\rm ion}(T_e) \\, n_0 = \\alpha_{\\rm rec}(T_e) \\, n_{+}, \\quad n_0 + n_{+} = n_Z \\Rightarrow f_0(T_e) = \\frac{\\alpha_{\\rm rec}(T_e)}{\\alpha_{\\rm rec}(T_e) + S_{\\rm ion}(T_e)}.\n$$\n- Use the following well-tested functional forms for rate coefficients (SI units of ${\\rm m^3/s}$), where $T_e$ is in ${\\rm K}$:\n$$\nS_{\\rm ion}(T_e) = S_0 \\left(\\frac{T_e}{10^4\\,{\\rm K}}\\right)^{1/2} \\exp\\left(-\\frac{E_{\\rm ion}}{{k_B} T_e}\\right), \\quad\n\\alpha_{\\rm rec}(T_e) = \\alpha_0 \\left(\\frac{T_e}{10^4\\,{\\rm K}}\\right)^{-3/2}.\n$$\n- For each spectral line $u \\rightarrow g$ (upper $u$ to ground $g$), with transition energy $E_{ug}$ (in ${\\rm eV}$), Einstein spontaneous emission rate $A_{ug}$ (in ${\\rm s^{-1}}$), statistical weights $g_u$ and $g_g$, and effective collision strength ${\\Upsilon}$, the Maxwellian-averaged collisional rate coefficients (SI units ${\\rm m^3/s}$) are given by:\n$$\nq_{\\rm exc}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_g \\sqrt{T_e}} \\exp\\left(-\\frac{E_{ug}}{{k_B} T_e}\\right), \\quad\nq_{\\rm de}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_u \\sqrt{T_e}},\n$$\nwhere $C_{\\Omega} = 8.629\\times 10^{-12}\\,{\\rm m^3\\,s^{-1}\\,K^{1/2}}$ and ${k_B}$ is the Boltzmann constant. These are standard Maxwellian rate coefficient forms expressed via effective collision strengths.\n- In steady-state for a two-level system driven by electron-impact excitation from the ground, the excited state density is:\n$$\nn_u(T_e) = \\frac{n_g \\, n_e \\, q_{\\rm exc}(T_e)}{A_{ug} + n_e \\, q_{\\rm de}(T_e)},\n$$\nwith $n_g \\approx n_Z f_0(T_e)$.\n- The line emissivity (power per volume) for that transition is:\n$$\np_{ug}(T_e) = n_u(T_e) \\, A_{ug} \\, E_{ug} \\, e,\n$$\nwhere $e = 1.602176634\\times 10^{-19}\\,{\\rm J/eV}$ is the elementary charge to convert ${\\rm eV}$ to ${\\rm J}$.\n- The total line radiation power density is the sum over all included transitions:\n$$\nP_{\\rm rad}(T_e) = \\sum_{\\text{lines}} p_{ug}(T_e).\n$$\n\nAtomic data to be used (representative, scientifically plausible constants):\n- Nitrogen (symbol: N): ionization potential $E_{\\rm ion} = 14.53\\,{\\rm eV}$, ionization prefactor $S_0 = 5.0\\times 10^{-15}\\,{\\rm m^3/s}$, radiative recombination prefactor $\\alpha_0 = 1.5\\times 10^{-13}\\,{\\rm m^3/s}$. Lines:\n  1. $E_{ug} = 10.0\\,{\\rm eV}$, $A_{ug} = 5.0\\times 10^{7}\\,{\\rm s^{-1}}$, $g_g = 4$, $g_u = 6$, $\\Upsilon = 0.50$.\n  2. $E_{ug} = 7.5\\,{\\rm eV}$, $A_{ug} = 2.0\\times 10^{4}\\,{\\rm s^{-1}}$, $g_g = 3$, $g_u = 5$, $\\Upsilon = 0.30$.\n  3. $E_{ug} = 11.6\\,{\\rm eV}$, $A_{ug} = 1.0\\times 10^{8}\\,{\\rm s^{-1}}$, $g_g = 4$, $g_u = 4$, $\\Upsilon = 0.40$.\n- Neon (symbol: Ne): ionization potential $E_{\\rm ion} = 21.56\\,{\\rm eV}$, ionization prefactor $S_0 = 3.0\\times 10^{-15}\\,{\\rm m^3/s}$, radiative recombination prefactor $\\alpha_0 = 2.0\\times 10^{-13}\\,{\\rm m^3/s}$. Lines:\n  1. $E_{ug} = 16.0\\,{\\rm eV}$, $A_{ug} = 3.0\\times 10^{7}\\,{\\rm s^{-1}}$, $g_g = 5$, $g_u = 7$, $\\Upsilon = 0.70$.\n  2. $E_{ug} = 14.0\\,{\\rm eV}$, $A_{ug} = 5.0\\times 10^{3}\\,{\\rm s^{-1}}$, $g_g = 3$, $g_u = 3$, $\\Upsilon = 0.50$.\n  3. $E_{ug} = 18.5\\,{\\rm eV}$, $A_{ug} = 1.0\\times 10^{8}\\,{\\rm s^{-1}}$, $g_g = 5$, $g_u = 5$, $\\Upsilon = 0.60$.\n\nNumerical domain and output:\n- Evaluate $P_{\\rm rad}(T_e)$ over $T_e$ in ${\\rm eV}$ from $0.5\\,{\\rm eV}$ to $100.0\\,{\\rm eV}$ on a uniform grid with resolution $\\Delta T_e = 0.05\\,{\\rm eV}$. Internally convert to ${\\rm K}$ via ${k_B}$ in ${\\rm eV/K}$, i.e., use $k_B = 8.617333262\\times 10^{-5}\\,{\\rm eV/K}$.\n- For each test case, determine the contiguous temperature range $[T_{\\rm low}, T_{\\rm high}]$ (in ${\\rm eV}$) where $P_{\\rm rad}(T_e)$ is at least $0.95$ times its maximum value $P_{\\rm rad}^{\\rm max}$ on the grid. If there are multiple disjoint regions above the threshold, report the minimal $T_{\\rm low}$ and maximal $T_{\\rm high}$ covering all such regions. If no point meets the threshold, report $[T_{\\rm opt}, T_{\\rm opt}]$, where $T_{\\rm opt}$ is the temperature at which $P_{\\rm rad}$ attains its maximum.\n- All results must be expressed in ${\\rm eV}$ and rounded to three decimal places.\n- Your program must compute the required ranges for the following test suite and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list $[T_{\\rm low}, T_{\\rm high}]$:\n  1. Species $=$ \"N\", $n_e = 2.0\\times 10^{20}\\,{\\rm m^{-3}}$, $n_Z = 1.0\\times 10^{18}\\,{\\rm m^{-3}}$.\n  2. Species $=$ \"Ne\", $n_e = 2.0\\times 10^{20}\\,{\\rm m^{-3}}$, $n_Z = 1.0\\times 10^{18}\\,{\\rm m^{-3}}$.\n  3. Species $=$ \"N\", $n_e = 1.0\\times 10^{19}\\,{\\rm m^{-3}}$, $n_Z = 1.0\\times 10^{17}\\,{\\rm m^{-3}}$.\n  4. Species $=$ \"Ne\", $n_e = 5.0\\times 10^{21}\\,{\\rm m^{-3}}$, $n_Z = 1.0\\times 10^{19}\\,{\\rm m^{-3}}$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case reported as a two-element list $[T_{\\rm low}, T_{\\rm high}]$ in ${\\rm eV}$, each value rounded to three decimals. For example: $[[1.250,2.500],[3.100,3.500]]$ (this is an illustrative example only).",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of atomic and plasma physics, specifically using a standard Collisional-Radiative (CR) model for impurity radiation. The problem is well-posed, with all necessary physical constants, functional forms for rate coefficients, and atomic data provided. The language is objective and precise, and the numerical task is clearly defined. There are no internal contradictions, factual errors, or ambiguities. The parameters given are physically plausible for the context of fusion plasma divertors. Therefore, a reasoned solution will be provided.\n\nThe objective is to compute the total line radiation power density, $P_{\\rm rad}(T_e)$, for a given impurity species in a plasma as a function of electron temperature $T_e$, and to find the temperature range where this radiation is maximized.\n\nThe core of the model is a set of coupled, steady-state rate equations. We will solve these algebraically and then evaluate the resulting expressions numerically.\n\nFirst, let us define the fundamental physical constants used in the model, ensuring all calculations are performed in a consistent set of units (SI).\n- Boltzmann constant: $k_B \\approx 8.617333262 \\times 10^{-5} \\, \\text{eV/K}$. This constant facilitates conversion between energy units (electron-volts, $\\text{eV}$) and temperature (Kelvin, $\\text{K}$). The temperature in Kelvin, $T_{e,K}$, is related to the temperature in electron-volts, $T_{e,eV}$, by $T_{e,K} = T_{e,eV} / k_B$.\n- Elementary charge: $e \\approx 1.602176634 \\times 10^{-19} \\, \\text{J/eV}$. This is used to convert energy from $\\text{eV}$ to Joules ($\\text{J}$).\n- Rate coefficient constant: $C_{\\Omega} = 8.629 \\times 10^{-12} \\, \\text{m}^3\\,\\text{s}^{-1}\\,\\text{K}^{1/2}$.\n\nThe model consists of several components:\n\n1.  **Ionization-Recombination Balance:**\n    The neutral fraction of the impurity, $f_0(T_e)$, is determined by the balance between electron-impact ionization of neutral atoms (density $n_0$) and radiative recombination of singly-ionized ions (density $n_+$). The steady-state condition is:\n    $$\n    n_e n_0 S_{\\rm ion}(T_e) = n_e n_{+} \\alpha_{\\rm rec}(T_e)\n    $$\n    where $n_e$ is the electron density, $S_{\\rm ion}(T_e)$ is the ionization rate coefficient, and $\\alpha_{\\rm rec}(T_e)$ is the radiative recombination rate coefficient. With the total impurity density $n_Z = n_0 + n_{+}$, we solve for the neutral fraction $f_0(T_e) = n_0/n_Z$:\n    $$\n    f_0(T_e) = \\frac{\\alpha_{\\rm rec}(T_e)}{\\alpha_{\\rm rec}(T_e) + S_{\\rm ion}(T_e)}\n    $$\n    The rate coefficients are given as functions of $T_e$ in Kelvin:\n    $$\n    S_{\\rm ion}(T_e) = S_0 \\left(\\frac{T_e}{10^4\\,\\text{K}}\\right)^{1/2} \\exp\\left(-\\frac{E_{\\rm ion}}{k_B T_e}\\right)\n    $$\n    $$\n    \\alpha_{\\rm rec}(T_e) = \\alpha_0 \\left(\\frac{T_e}{10^4\\,\\text{K}}\\right)^{-3/2}\n    $$\n    Here, $S_0$ and $\\alpha_0$ are prefactors, and $E_{\\rm ion}$ is the ionization potential of the neutral impurity. The argument of the exponential, $E_{\\rm ion} / (k_B T_e)$, is dimensionless and can be directly calculated as $E_{\\rm ion, eV} / T_{e, eV}$.\n\n2.  **Excitation-De-excitation Balance:**\n    For each spectral line, corresponding to a transition from an upper state $u$ to the ground state $g$, we assume a simplified two-level atom model. The population of the upper state is determined by a balance between electron-impact excitation from the ground state and de-population via spontaneous emission and electron-impact de-excitation. The steady-state rate equation for the upper state density $n_u$ is:\n    $$\n    n_e n_g q_{\\rm exc}(T_e) = n_u A_{ug} + n_e n_u q_{\\rm de}(T_e)\n    $$\n    Here, $n_g$ is the ground state density, $q_{\\rm exc}(T_e)$ is the excitation rate coefficient, $A_{ug}$ is the Einstein coefficient for spontaneous emission, and $q_{\\rm de}(T_e)$ is the de-excitation rate coefficient.\n    Solving for $n_u$, we obtain:\n    $$\n    n_u(T_e) = \\frac{n_g n_e q_{\\rm exc}(T_e)}{A_{ug} + n_e q_{\\rm de}(T_e)}\n    $$\n    We make the simplifying assumption that the ground state population is approximately the total neutral population, i.e., $n_g \\approx n_0 = n_Z f_0(T_e)$.\n    The Maxwellian-averaged collisional rate coefficients are given by:\n    $$\n    q_{\\rm exc}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_g \\sqrt{T_e}} \\exp\\left(-\\frac{E_{ug}}{k_B T_e}\\right)\n    $$\n    $$\n    q_{\\rm de}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_u \\sqrt{T_e}}\n    $$\n    where $E_{ug}$ is the transition energy, $\\Upsilon$ is the effective collision strength, and $g_g, g_u$ are the statistical weights of the ground and upper states, respectively. The temperature $T_e$ in these formulae is in Kelvin.\n\n3.  **Line Radiation Power:**\n    The power radiated per unit volume (emissivity) for a single transition $u \\rightarrow g$ is the rate of spontaneous emissions per unit volume multiplied by the energy of each emitted photon:\n    $$\n    p_{ug}(T_e) = n_u(T_e) A_{ug} E_{ug, eV} e\n    $$\n    The factor $e$ converts the transition energy $E_{ug}$ from $\\text{eV}$ to Joules, so that the emissivity is in $\\text{W}/\\text{m}^3$.\n\n4.  **Total Radiation Power:**\n    The total line radiation power density, $P_{\\rm rad}(T_e)$, is the sum of the emissivities over all considered spectral lines for the impurity species:\n    $$\n    P_{\\rm rad}(T_e) = \\sum_{\\text{lines}} p_{ug}(T_e)\n    $$\n\nThe numerical procedure is as follows:\nFirst, we establish a uniform grid of electron temperatures in $\\text{eV}$, from $T_{e, \\text{min}} = 0.5\\,\\text{eV}$ to $T_{e, \\text{max}} = 100.0\\,\\text{eV}$ with a resolution of $\\Delta T_e = 0.05\\,\\text{eV}$. For each point $T_{e,eV}$ in this grid, we perform the following calculations for each test case specified:\n\n1.  Select the atomic data (for Nitrogen 'N' or Neon 'Ne') and plasma parameters ($n_e, n_Z$) for the current test case.\n2.  Convert the temperature grid from $\\text{eV}$ to Kelvin: $\\mathbf{T}_{e,K} = \\mathbf{T}_{e,eV} / k_B$.\n3.  Calculate the temperature-dependent rate coefficients $S_{\\rm ion}(\\mathbf{T}_{e,K})$ and $\\alpha_{\\rm rec}(\\mathbf{T}_{e,K})$ as arrays over the temperature grid.\n4.  Compute the neutral fraction array $\\mathbf{f}_0 = \\mathbf{\\alpha}_{\\rm rec} / (\\mathbf{\\alpha}_{\\rm rec} + \\mathbf{S}_{\\rm ion})$.\n5.  Initialize the total radiation power array $\\mathbf{P}_{\\rm rad}$ to zeros.\n6.  For each spectral line of the selected species:\n    a. Calculate the excitation and de-excitation rate coefficient arrays, $\\mathbf{q}_{\\rm exc}$ and $\\mathbf{q}_{\\rm de}$.\n    b. Calculate the upper state density array $\\mathbf{n}_u = (n_Z \\mathbf{f}_0) n_e \\mathbf{q}_{\\rm exc} / (A_{ug} + n_e \\mathbf{q}_{\\rm de})$.\n    c. Calculate the line emissivity array $\\mathbf{p}_{ug} = \\mathbf{n}_u A_{ug} E_{ug, eV} e$.\n    d. Add this contribution to the total: $\\mathbf{P}_{\\rm rad} = \\mathbf{P}_{\\rm rad} + \\mathbf{p}_{ug}$.\n7.  Once $\\mathbf{P}_{\\rm rad}$ is fully computed, find its maximum value, $P_{\\rm rad}^{\\rm max} = \\max(\\mathbf{P}_{\\rm rad})$.\n8.  Identify all temperatures $T_e$ on the grid where $P_{\\rm rad}(T_e) \\geq 0.95 \\times P_{\\rm rad}^{\\rm max}$.\n9.  If this set of temperatures is empty, find the temperature $T_{\\rm opt}$ at which $P_{\\rm rad}$ is maximum and set the result to $[T_{\\rm opt}, T_{\\rm opt}]$.\n10. Otherwise, determine the minimum ($T_{\\rm low}$) and maximum ($T_{\\rm high}$) temperatures in this set.\n11. The final result for the test case is $[T_{\\rm low}, T_{\\rm high}]$, with values rounded to three decimal places.\n\nThis procedure is repeated for all four test cases, and the results are aggregated into the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the temperature range for maximum impurity radiation based on a\n    simplified Collisional-Radiative model.\n    \"\"\"\n\n    # --- Physical Constants ---\n    # Boltzmann constant in eV/K\n    K_B_EV_K = 8.617333262e-5\n    # Elementary charge in J/eV\n    ELEM_CHARGE = 1.602176634e-19\n    # Rate coefficient constant in m^3 s^-1 K^0.5\n    C_OMEGA = 8.629e-12\n\n    # --- Atomic Data ---\n    atomic_data = {\n        \"N\": {\n            \"E_ion\": 14.53,  # eV\n            \"S0\": 5.0e-15,   # m^3/s\n            \"alpha0\": 1.5e-13, # m^3/s\n            \"lines\": [\n                # E_ug (eV), A_ug (s^-1), g_g, g_u, Upsilon\n                (10.0, 5.0e7, 4, 6, 0.50),\n                (7.5, 2.0e4, 3, 5, 0.30),\n                (11.6, 1.0e8, 4, 4, 0.40),\n            ],\n        },\n        \"Ne\": {\n            \"E_ion\": 21.56,  # eV\n            \"S0\": 3.0e-15,   # m^3/s\n            \"alpha0\": 2.0e-13, # m^3/s\n            \"lines\": [\n                # E_ug (eV), A_ug (s^-1), g_g, g_u, Upsilon\n                (16.0, 3.0e7, 5, 7, 0.70),\n                (14.0, 5.0e3, 3, 3, 0.50),\n                (18.5, 1.0e8, 5, 5, 0.60),\n            ],\n        },\n    }\n\n    # --- Numerical Grid ---\n    te_ev_grid = np.arange(0.5, 100.0 + 0.05, 0.05)\n    # Ensure precision for endpoint\n    te_ev_grid = np.linspace(0.5, 100.0, int((100.0 - 0.5) / 0.05) + 1)\n    te_k_grid = te_ev_grid / K_B_EV_K\n\n    # --- Test Cases ---\n    test_cases = [\n        # Species, n_e (m^-3), n_Z (m^-3)\n        (\"N\", 2.0e20, 1.0e18),\n        (\"Ne\", 2.0e20, 1.0e18),\n        (\"N\", 1.0e19, 1.0e17),\n        (\"Ne\", 5.0e21, 1.0e19),\n    ]\n\n    all_results = []\n    \n    for species, n_e, n_z in test_cases:\n        data = atomic_data[species]\n        \n        # --- 1. Ionization-Recombination Balance ---\n        # Ionization rate coefficient\n        s_ion = data[\"S0\"] * np.sqrt(te_k_grid / 1e4) * np.exp(-data[\"E_ion\"] / te_ev_grid)\n        # Recombination rate coefficient\n        alpha_rec = data[\"alpha0\"] * (te_k_grid / 1e4)**(-1.5)\n        # Neutral fraction\n        f0 = alpha_rec / (alpha_rec + s_ion)\n        # Neutral ground state density\n        n_g = n_z * f0\n\n        # --- 2. Calculate Total Radiation Power ---\n        p_rad_total = np.zeros_like(te_ev_grid)\n\n        for line in data[\"lines\"]:\n            e_ug, a_ug, g_g, g_u, upsilon = line\n\n            # Excitation rate coefficient\n            q_exc = C_OMEGA * (upsilon / (g_g * np.sqrt(te_k_grid))) * np.exp(-e_ug / te_ev_grid)\n            # De-excitation rate coefficient\n            q_de = C_OMEGA * (upsilon / (g_u * np.sqrt(te_k_grid)))\n\n            # Excited state density\n            denominator = a_ug + n_e * q_de\n            n_u = (n_g * n_e * q_exc) / denominator\n            \n            # Line emissivity (power per volume)\n            p_ug = n_u * a_ug * e_ug * ELEM_CHARGE\n            \n            p_rad_total += p_ug\n\n        # --- 3. Determine Temperature Range for Max Radiation ---\n        p_rad_max = np.max(p_rad_total)\n        \n        if p_rad_max == 0:\n            # Handle case where radiation is zero everywhere\n            t_opt = te_ev_grid[np.argmax(p_rad_total)]\n            all_results.append([round(t_opt, 3), round(t_opt, 3)])\n            continue\n            \n        threshold = 0.95 * p_rad_max\n        \n        # Find indices where radiation is above the threshold\n        indices_above_threshold = np.where(p_rad_total >= threshold)[0]\n\n        if indices_above_threshold.size == 0:\n            # If no points meet the threshold, find the single optimal temperature\n            t_opt_idx = np.argmax(p_rad_total)\n            t_opt = te_ev_grid[t_opt_idx]\n            result_range = [round(t_opt, 3), round(t_opt, 3)]\n        else:\n            # Find the min and max temperatures covering all regions above threshold\n            t_low_idx = indices_above_threshold[0]\n            t_high_idx = indices_above_threshold[-1]\n            t_low = te_ev_grid[t_low_idx]\n            t_high = te_ev_grid[t_high_idx]\n            result_range = [round(t_low, 3), round(t_high, 3)]\n        \n        all_results.append(result_range)\n\n    # --- Final Output Formatting ---\n    # Construct the final string as required\n    output_str = \"[\" + \",\".join([f\"[{r[0]:.3f},{r[1]:.3f}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}