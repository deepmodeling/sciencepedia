{
    "hands_on_practices": [
        {
            "introduction": "Halo电流分析的一项基本技能是能够根据给定的电流密度和磁场分布，计算出作用在托卡马克部件上的电磁力。本练习将引导你应用洛伦兹力定律 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$，在一个简化的、但具有代表性的托卡马克几何结构上进行实践。通过对力密度进行体积分，这项实践旨在锻炼你将物理定律和几何描述转化为具体、定量的力学载荷估算的能力 。",
            "id": "3990400",
            "problem": "考虑一个具有圆形极向截面的轴对称托卡马克真空室，其小半径为 $a$，中心位于大半径 $R_0$ 处。设极向角 $\\theta$ 用于参数化该圆形截面，使得真空室中面上的一个点具有柱坐标 $R(\\theta)=R_0+a\\cos\\theta$ 和 $Z(\\theta)=a\\sin\\theta$，其中 $\\theta=0$ 位于外侧中平面，并在极向平面内向上增加。环向磁场的大小随大半径 $R$ 变化，关系式为 $B_{\\phi}(R)=B_0\\,\\frac{R_0}{R}$，这与轴对称环向场线圈产生的磁场相符。在一次破裂过程中，一股极向晕电流密度在真空室壁内流动。在一个跨度为 $\\Delta\\phi$（以弧度为单位）的给定环向扇区内，体积极向电流密度在壁厚 $t$ 上是均匀的，随极向角的变化关系为 $J_{\\theta}(\\theta)=J_0\\left(1+\\beta\\cos\\theta\\right)$（对于 $0\\leq\\theta\\leq\\frac{\\pi}{2}$），并且在该象限之外可以忽略不计。\n\n假设以下参数是恒定且已知的：$R_0=3.5\\,\\mathrm{m}$，$a=1.2\\,\\mathrm{m}$，$t=0.06\\,\\mathrm{m}$，$\\Delta\\phi=0.40\\,\\mathrm{rad}$，$B_0=4.5\\,\\mathrm{T}$，$J_0=1.3\\times 10^{6}\\,\\mathrm{A/m^2}$，以及 $\\beta=0.6$。假定该扇区内的真空室壁在环向上具有均匀的性质，并忽略除指定外的任何几何效应。\n\n从 Lorentz 力密度定律 $\\mathbf{f}=\\mathbf{J}\\times\\mathbf{B}$ 和标准的柱坐标基矢关系出发，推导局域力密度的垂直分量作为 $\\theta$ 的函数。然后，将该垂直力密度在极向象限 $0\\leq\\theta\\leq\\frac{\\pi}{2}$ 和给定环向扇区的壁体积上积分，以获得该扇区上的净垂直载荷 $F_Z$。取向上（$Z$ 增加的方向）为净垂直载荷的正方向。用兆牛顿（MN）表示 $F_Z$ 的最终数值答案，并将答案四舍五入到四位有效数字。所有角度必须以弧度处理。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**步骤1：提取已知条件**\n-   真空室大半径: $R_0=3.5\\,\\mathrm{m}$\n-   真空室截面小半径: $a=1.2\\,\\mathrm{m}$\n-   壁厚: $t=0.06\\,\\mathrm{m}$\n-   环向扇区跨度: $\\Delta\\phi=0.40\\,\\mathrm{rad}$\n-   在 $R=R_0$ 处的环向磁场: $B_0=4.5\\,\\mathrm{T}$\n-   极向电流密度常数: $J_0=1.3\\times 10^{6}\\,\\mathrm{A/m^2}$\n-   极向电流密度参数: $\\beta=0.6$\n-   真空室中面参数化: $R(\\theta)=R_0+a\\cos\\theta$, $Z(\\theta)=a\\sin\\theta$ for $0\\leq\\theta\\leq\\frac{\\pi}{2}$\n-   环向磁场依赖关系: $B_{\\phi}(R)=B_0\\,\\frac{R_0}{R}$\n-   极向晕电流密度依赖关系: $J_{\\theta}(\\theta)=J_0\\left(1+\\beta\\cos\\theta\\right)$ for $0\\leq\\theta\\leq\\frac{\\pi}{2}$\n-   控制定律：Lorentz 力密度 $\\mathbf{f}=\\mathbf{J}\\times\\mathbf{B}$\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：**该问题基于电磁学的基本原理（Lorentz 力）和一个关于托卡马克等离子体破裂期间晕电流的标准（尽管简化了）模型。其几何形状和指定的场/电流分布与磁约束聚变等离子体的物理学相符。参数值在当代托卡马克的实际范围内。\n-   **适定性：**该问题提供了一整套参数，并对所有物理量及其空间依赖性给出了清晰的定义。目标被明确陈述（计算净垂直力 $F_Z$），并且求解路径可以从给定信息中推导出来。问题是自洽且无歧义的。\n-   **客观性：**该问题使用精确、定量和无偏见的语言进行陈述。它是一个正式的物理和工程计算问题，不含任何主观内容。\n\n**步骤3：结论和行动**\n该问题是有效的。将提供完整的解答。\n\n**推导与求解**\n\n托卡马克真空室指定扇区上的净垂直载荷 $F_Z$ 是 Lorentz 力密度的垂直分量 $f_Z$ 在该扇区体积上的积分。Lorentz 力密度由 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$ 给出。\n\n首先，我们在标准柱坐标系 $(\\hat{R}, \\hat{\\phi}, \\hat{Z})$ 中表示磁场和电流密度矢量。\n\n磁场是纯环向的：\n$$ \\mathbf{B} = B_\\phi(R) \\hat{\\phi} $$\n磁场大小随大半径 $R$ 变化，关系为 $B_\\phi(R) = B_0 \\frac{R_0}{R}$。在真空室壁上，一个点由极向角 $\\theta$ 参数化，其大半径为 $R(\\theta) = R_0 + a\\cos\\theta$。因此，真空室中面上的磁场是 $\\theta$ 的函数：\n$$ \\mathbf{B}(\\theta) = B_0 \\frac{R_0}{R_0 + a\\cos\\theta} \\hat{\\phi} $$\n\n晕电流沿极向流动，因此电流密度矢量为 $\\mathbf{J} = J_\\theta(\\theta) \\hat{\\theta}$，其中 $\\hat{\\theta}$ 是极向单位矢量。真空室中面上一点的位置矢量为 $\\mathbf{r}(\\theta) = R(\\theta)\\hat{R} + Z(\\theta)\\hat{Z} = (R_0 + a\\cos\\theta)\\hat{R} + (a\\sin\\theta)\\hat{Z}$。沿极向的切向矢量通过对 $\\mathbf{r}(\\theta)$ 关于 $\\theta$ 求导得到：\n$$ \\frac{d\\mathbf{r}}{d\\theta} = \\frac{d}{d\\theta}(R_0 + a\\cos\\theta)\\hat{R} + \\frac{d}{d\\theta}(a\\sin\\theta)\\hat{Z} = -a\\sin\\theta \\hat{R} + a\\cos\\theta \\hat{Z} $$\n该切向矢量的大小为 $|\\frac{d\\mathbf{r}}{d\\theta}| = \\sqrt{(-a\\sin\\theta)^2 + (a\\cos\\theta)^2} = a$。因此，极向单位矢量 $\\hat{\\theta}$ 为：\n$$ \\hat{\\theta} = \\frac{1}{a}\\frac{d\\mathbf{r}}{d\\theta} = -\\sin\\theta \\hat{R} + \\cos\\theta \\hat{Z} $$\n于是电流密度矢量为：\n$$ \\mathbf{J}(\\theta) = J_\\theta(\\theta) \\hat{\\theta} = J_0(1+\\beta\\cos\\theta)(-\\sin\\theta \\hat{R} + \\cos\\theta \\hat{Z}) $$\n\n现在，我们计算 Lorentz 力密度 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$：\n$$ \\mathbf{f} = J_0(1+\\beta\\cos\\theta)(-\\sin\\theta \\hat{R} + \\cos\\theta \\hat{Z}) \\times \\left(B_0 \\frac{R_0}{R_0 + a\\cos\\theta}\\right) \\hat{\\phi} $$\n使用柱坐标单位矢量的叉乘关系 $\\hat{R} \\times \\hat{\\phi} = \\hat{Z}$ 和 $\\hat{Z} \\times \\hat{\\phi} = -\\hat{R}$，我们得到：\n$$ \\mathbf{f}(\\theta) = J_0(1+\\beta\\cos\\theta) \\left(B_0 \\frac{R_0}{R_0 + a\\cos\\theta}\\right) [-\\sin\\theta(\\hat{R} \\times \\hat{\\phi}) + \\cos\\theta(\\hat{Z} \\times \\hat{\\phi})] $$\n$$ \\mathbf{f}(\\theta) = J_0(1+\\beta\\cos\\theta) \\left(B_0 \\frac{R_0}{R_0 + a\\cos\\theta}\\right) [-\\sin\\theta\\hat{Z} - \\cos\\theta\\hat{R}] $$\n$$ \\mathbf{f}(\\theta) = -J_0 B_0 R_0 \\frac{1+\\beta\\cos\\theta}{R_0 + a\\cos\\theta} (\\cos\\theta \\hat{R} + \\sin\\theta \\hat{Z}) $$\n\n局域力密度的垂直分量 $f_Z$ 是 $\\mathbf{f}$ 的 $\\hat{Z}$ 分量：\n$$ f_Z(\\theta) = \\mathbf{f}(\\theta) \\cdot \\hat{Z} = -J_0 B_0 R_0 \\frac{(1+\\beta\\cos\\theta)\\sin\\theta}{R_0 + a\\cos\\theta} $$\n这个表达式表示了垂直力密度作为 $\\theta$ 的函数，符合题目要求。\n\n为了求得总垂直力 $F_Z$，我们必须将 $f_Z$ 在指定的壁扇区的体积上积分。真空室壁的体积微元由 $dV = R \\, dR \\, d\\phi \\, dZ$ 给出。一个更方便的壁体积参数化使用坐标 $(r, \\theta, \\phi)$，其中 $r$ 是壁内的小半径坐标，范围从 $a - t/2$ 到 $a + t/2$。体积微元为 $dV = (R_0 + r\\cos\\theta) r \\, dr \\, d\\theta \\, d\\phi$。力密度依赖于大半径 $R = R_0 + r\\cos\\theta$。\n总力 $F_Z$ 是：\n$$ F_Z = \\iiint_V f_Z \\, dV = \\int_0^{\\Delta\\phi} \\int_0^{\\pi/2} \\int_{a-t/2}^{a+t/2} f_Z(r, \\theta) (R_0 + r\\cos\\theta) r \\, dr \\, d\\theta \\, d\\phi $$\n壁内径向位置 $r$ 处的垂直力密度为：\n$$ f_Z(r,\\theta) = -J_0 B_0 R_0 \\frac{(1+\\beta\\cos\\theta)\\sin\\theta}{R_0 + r\\cos\\theta} $$\n将此代入 $F_Z$ 的积分中：\n$$ F_Z = \\int_0^{\\Delta\\phi} \\int_0^{\\pi/2} \\int_{a-t/2}^{a+t/2} \\left(-J_0 B_0 R_0 \\frac{(1+\\beta\\cos\\theta)\\sin\\theta}{R_0 + r\\cos\\theta}\\right) (R_0 + r\\cos\\theta) r \\, dr \\, d\\theta \\, d\\phi $$\n项 $(R_0 + r\\cos\\theta)$ 被消去，显著简化了被积函数：\n$$ F_Z = \\int_0^{\\Delta\\phi} \\int_0^{\\pi/2} \\int_{a-t/2}^{a+t/2} -J_0 B_0 R_0 (1+\\beta\\cos\\theta)\\sin\\theta \\cdot r \\, dr \\, d\\theta \\, d\\phi $$\n被积函数是可分离的。我们一步一步地进行积分。\n对 $\\phi$ 从 $0$ 到 $\\Delta\\phi$ 的积分得出 $\\Delta\\phi$。\n对 $r$ 从 $a-t/2$ 到 $a+t/2$ 的积分得出：\n$$ \\int_{a-t/2}^{a+t/2} r \\, dr = \\left[\\frac{r^2}{2}\\right]_{a-t/2}^{a+t/2} = \\frac{1}{2}((a+t/2)^2 - (a-t/2)^2) = \\frac{1}{2}(2at) = at $$\n$F_Z$ 的表达式变为：\n$$ F_Z = -J_0 B_0 R_0 \\, (at) \\, \\Delta\\phi \\int_0^{\\pi/2} (1+\\beta\\cos\\theta)\\sin\\theta \\, d\\theta $$\n现在我们计算关于 $\\theta$ 的积分：\n$$ \\int_0^{\\pi/2} (1+\\beta\\cos\\theta)\\sin\\theta \\, d\\theta = \\int_0^{\\pi/2} \\sin\\theta \\, d\\theta + \\beta\\int_0^{\\pi/2} \\sin\\theta\\cos\\theta \\, d\\theta $$\n$$ = [-\\cos\\theta]_0^{\\pi/2} + \\beta \\left[\\frac{\\sin^2\\theta}{2}\\right]_0^{\\pi/2} $$\n$$ = (-\\cos(\\pi/2) - (-\\cos(0))) + \\beta \\left(\\frac{\\sin^2(\\pi/2)}{2} - \\frac{\\sin^2(0)}{2}\\right) $$\n$$ = (0 - (-1)) + \\beta \\left(\\frac{1^2}{2} - 0\\right) = 1 + \\frac{\\beta}{2} $$\n将此结果代回 $F_Z$ 的表达式中：\n$$ F_Z = -J_0 B_0 R_0 a t \\Delta\\phi \\left(1 + \\frac{\\beta}{2}\\right) $$\n现在，我们代入给定的数值：\n$J_0=1.3\\times 10^{6}\\,\\mathrm{A/m^2}$, $B_0=4.5\\,\\mathrm{T}$, $R_0=3.5\\,\\mathrm{m}$, $a=1.2\\,\\mathrm{m}$, $t=0.06\\,\\mathrm{m}$, $\\Delta\\phi=0.40\\,\\mathrm{rad}$, $\\beta=0.6$.\n$$ F_Z = -(1.3 \\times 10^6) \\times (4.5) \\times (3.5) \\times (1.2) \\times (0.06) \\times (0.40) \\times \\left(1 + \\frac{0.6}{2}\\right) $$\n$$ F_Z = -(1.3 \\times 10^6) \\times (4.5) \\times (3.5) \\times (1.2) \\times (0.06) \\times (0.40) \\times (1.3) $$\n计算数值的乘积：\n$$ F_Z = - (1.3 \\times 1.3) \\times (4.5 \\times 3.5) \\times (1.2 \\times 0.06 \\times 0.40) \\times 10^6 $$\n$$ F_Z = - (1.69) \\times (15.75) \\times (0.0288) \\times 10^6 $$\n$$ F_Z = - 0.766584 \\times 10^6 \\, \\mathrm{N} $$\n力以牛顿（N）为单位。题目要求答案以兆牛顿（MN）为单位，其中 $1\\,\\mathrm{MN} = 10^6\\,\\mathrm{N}$。\n$$ F_Z = -0.766584 \\, \\mathrm{MN} $$\n将结果四舍五入到四位有效数字：\n$$ F_Z \\approx -0.7666 \\, \\mathrm{MN} $$\n负号表示该扇区上的净垂直力方向向下。",
            "answer": "$$\n\\boxed{-0.7666}\n$$"
        },
        {
            "introduction": "在托卡马克破裂过程中，Halo电流通常是非轴对称的，其在环向上的位置也不是固定的，而是会发生旋转。本练习探讨了控制这种旋转的动力学机制，这对于预测电磁力的作用位置至关重要 。你将为等离子体中一种关键的螺旋不稳定性（$n=1$ 模）的相位角建立并求解一个运动方程，从而深入理解外部磁场（如共振磁扰动，RMP）如何影响甚至“锁定”这些破坏性力。",
            "id": "3990366",
            "problem": "在托卡马克中，经历破裂的环形磁约束等离子体会形成一个锁定的 $n=1$ 磁流体动力学模，其环向相位 $\\phi_1(t)$ 控制着晕电流分布的极向不对称性，从而决定了作用在真空室上的净侧向晕电流力的方向。该 $n=1$ 模的旋转受来自电阻壁的力矩和外加的共振磁扰动（RMP）的力矩控制。从牛顿转动第二定律（即总力矩等于有效转动惯量乘以角加速度）出发，推导在存在壁阻力矩 $T_w$ 和外部 RMP 力矩 $T_{\\mathrm{RMP}}$ 的情况下，相位 $\\phi_1(t)$ 的运动控制方程。将壁阻力建模为线性粘性阻尼 $T_w=-\\Gamma_w\\,\\dot{\\phi}_1$，其中壁阻力系数 $\\Gamma_w > 0$ 为常数；将 RMP 力矩建模为源于一个与相位相关的磁相互作用能 $U(\\phi_1)=-T_0\\cos(\\phi_1-\\phi_{\\mathrm{RMP}})$，其中 $T_0 > 0$ 是一个恒定的力矩标度，$\\phi_{\\mathrm{RMP}}$ 是固定的 RMP 相位。假设系统处于适用于热猝灭后动力学的过阻尼状态，在该状态下，有效转动惯量 $I_{\\mathrm{eff}}$ 与壁阻力相比可以忽略不计。取初始相位为 $\\phi_1(0)=\\phi_0$，并忽略所有其他力矩和噪声。在这些假设下，用 $t$、$\\phi_{\\mathrm{RMP}}$、$\\Gamma_w$、$T_0$ 和 $\\phi_0$ 求解 $\\phi_1(t)$ 随时间演化的闭合形式解。所有角度均以弧度表示。最终答案必须是 $\\phi_1(t)$ 的单个闭合形式解析表达式。",
            "solution": "用户要求我验证并解决一个关于托卡马克等离子体中磁流体动力学（MHD）模旋转动力学的物理问题。\n\n### 第一步：提取已知条件\n- **控制定律：** 牛顿转动第二定律：总力矩等于有效转动惯量乘以角加速度，即 $I_{\\mathrm{eff}} \\ddot{\\phi}_1 = \\sum T$。\n- **关注变量：** $n=1$ 模的环向相位 $\\phi_1(t)$。\n- **力矩：**\n    - 壁阻力矩：$T_w = -\\Gamma_w \\dot{\\phi}_1$。\n    - 共振磁扰动（RMP）力矩 $T_{\\mathrm{RMP}}$，由势能导出。\n- **RMP 的势能：** $U(\\phi_1) = -T_0 \\cos(\\phi_1 - \\phi_{\\mathrm{RMP}})$。\n- **常数和参数：**\n    - 有效转动惯量：$I_{\\mathrm{eff}}$。\n    - 壁阻力系数：$\\Gamma_w > 0$。\n    - RMP 力矩标度：$T_0 > 0$。\n    - 固定的 RMP 相位：$\\phi_{\\mathrm{RMP}}$。\n- **假设和条件：**\n    - 系统处于过阻尼状态，因此有效转动惯量 $I_{\\mathrm{eff}}$ 可以忽略不计。\n    - 所有其他力矩和噪声都被忽略。\n    - 初始条件：$\\phi_1(0) = \\phi_0$。\n- **目标：** 求出 $\\phi_1(t)$ 随时间演化的闭合形式表达式。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行评估。\n\n- **科学依据：** 该问题设置在托卡马克等离子体物理学的背景下，这是物理学和工程学中一个成熟的子领域。破裂、MHD模（特别是 $n=1$ 模）、晕电流、电阻壁力矩和共振磁扰动（RMP）等概念是该领域的标准和基本概念。将壁力矩建模为线性粘性阻力，以及将 RMP 力矩建模为源于磁势能，都是标准的、有物理动机的近似方法。过阻尼假设 ($I_{\\mathrm{eff}} \\approx 0$) 对于破裂的热猝灭后阶段是现实的，在该阶段等离子体质量和惯性会急剧下降。该问题在科学上是合理的。\n\n- **适定性：** 该问题是一个定义明确的一阶常微分方程初值问题。所有必要的函数、参数（$\\Gamma_w, T_0, \\phi_{\\mathrm{RMP}}$）和初始条件（$\\phi_0$）都已给出。这种结构保证了唯一解的存在。\n\n- **客观性：** 问题陈述使用了精确、无歧义的技术语言，不含主观或基于观点的内容。\n\n基于此评估，该问题没有违反任何无效标准。它在科学上是合理的、适定的和客观的。\n\n### 第三步：结论与行动\n问题有效。将推导解答。\n\n### 解的推导\n\n起点是应用于相角 $\\phi_1(t)$ 的牛顿转动第二定律：\n$$I_{\\mathrm{eff}} \\frac{d^2\\phi_1}{dt^2} = \\sum T = T_w + T_{\\mathrm{RMP}}$$\n壁阻力矩以线性阻尼项的形式给出：\n$$T_w = -\\Gamma_w \\frac{d\\phi_1}{dt}$$\nRMP 力矩由磁势能 $U(\\phi_1) = -T_0 \\cos(\\phi_1 - \\phi_{\\mathrm{RMP}})$ 导出。力矩是势能的负梯度（在此情况下，是关于角度的负偏导数）：\n$$T_{\\mathrm{RMP}} = -\\frac{\\partial U}{\\partial \\phi_1} = -\\frac{\\partial}{\\partial \\phi_1} \\left[-T_0 \\cos(\\phi_1 - \\phi_{\\mathrm{RMP}})\\right] = T_0 \\frac{\\partial}{\\partial \\phi_1} \\left[\\cos(\\phi_1 - \\phi_{\\mathrm{RMP}})\\right]$$\n$$T_{\\mathrm{RMP}} = -T_0 \\sin(\\phi_1 - \\phi_{\\mathrm{RMP}})$$\n将力矩代入运动方程得到：\n$$I_{\\mathrm{eff}} \\frac{d^2\\phi_1}{dt^2} = -\\Gamma_w \\frac{d\\phi_1}{dt} - T_0 \\sin(\\phi_1 - \\phi_{\\mathrm{RMP}})$$\n问题指定了一个过阻尼状态，其中有效转动惯量 $I_{\\mathrm{eff}}$ 可以忽略不计。设 $I_{\\mathrm{eff}} = 0$ 将方程简化为一阶常微分方程（ODE）：\n$$0 = -\\Gamma_w \\frac{d\\phi_1}{dt} - T_0 \\sin(\\phi_1 - \\phi_{\\mathrm{RMP}})$$\n整理此方程，我们得到：\n$$\\Gamma_w \\frac{d\\phi_1}{dt} = -T_0 \\sin(\\phi_1 - \\phi_{\\mathrm{RMP}})$$\n为了求解这个 ODE，我们可以使用分离变量法。我们引入一个新变量 $\\theta(t) = \\phi_1(t) - \\phi_{\\mathrm{RMP}}$。其时间导数为 $\\frac{d\\theta}{dt} = \\frac{d\\phi_1}{dt}$。方程变为：\n$$\\Gamma_w \\frac{d\\theta}{dt} = -T_0 \\sin(\\theta)$$\n分离变量 $\\theta$ 和 $t$：\n$$\\frac{d\\theta}{\\sin(\\theta)} = -\\frac{T_0}{\\Gamma_w} dt$$\n现在我们对等式两边进行积分。$\\csc(\\theta) = \\frac{1}{\\sin(\\theta)}$ 的积分是 $\\ln|\\tan(\\frac{\\theta}{2})|$。\n$$\\int \\frac{d\\theta}{\\sin(\\theta)} = \\int -\\frac{T_0}{\\Gamma_w} dt$$\n$$\\ln\\left|\\tan\\left(\\frac{\\theta(t)}{2}\\right)\\right| = -\\frac{T_0}{\\Gamma_w} t + C$$\n其中 $C$ 是积分常数。我们使用初始条件 $\\phi_1(0) = \\phi_0$ 来确定 $C$。这意味着 $\\theta(0) = \\phi_1(0) - \\phi_{\\mathrm{RMP}} = \\phi_0 - \\phi_{\\mathrm{RMP}}$。代入 $t=0$：\n$$\\ln\\left|\\tan\\left(\\frac{\\theta(0)}{2}\\right)\\right| = C$$\n$$C = \\ln\\left|\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right)\\right|$$\n现在，将 $C$ 的表达式代回积分后的方程：\n$$\\ln\\left|\\tan\\left(\\frac{\\theta(t)}{2}\\right)\\right| = -\\frac{T_0}{\\Gamma_w} t + \\ln\\left|\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right)\\right|$$\n$$\\ln\\left|\\tan\\left(\\frac{\\theta(t)}{2}\\right)\\right| - \\ln\\left|\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right)\\right| = -\\frac{T_0}{\\Gamma_w} t$$\n利用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\\ln\\left|\\frac{\\tan\\left(\\frac{\\theta(t)}{2}\\right)}{\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right)}\\right| = -\\frac{T_0}{\\Gamma_w} t$$\n对两边取指数得到：\n$$\\left|\\frac{\\tan\\left(\\frac{\\theta(t)}{2}\\right)}{\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right)}\\right| = \\exp\\left(-\\frac{T_0}{\\Gamma_w} t\\right)$$\n假设模相位 $\\phi_1(t)$ 平滑地向稳定平衡点 $\\phi_{\\mathrm{RMP}}$ 演化，而不会穿过不稳定平衡点 $\\phi_{\\mathrm{RMP}} \\pm \\pi$，那么 $\\tan(\\theta/2)$ 的符号不会改变。因此我们可以去掉绝对值符号。\n$$\\tan\\left(\\frac{\\theta(t)}{2}\\right) = \\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right) \\exp\\left(-\\frac{T_0}{\\Gamma_w} t\\right)$$\n为了解出 $\\theta(t)$，我们对两边取反正切并乘以 2：\n$$\\frac{\\theta(t)}{2} = \\arctan\\left[\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right) \\exp\\left(-\\frac{T_0}{\\Gamma_w} t\\right)\\right]$$\n$$\\theta(t) = 2 \\arctan\\left[\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right) \\exp\\left(-\\frac{T_0}{\\Gamma_w} t\\right)\\right]$$\n最后，我们代回 $\\theta(t) = \\phi_1(t) - \\phi_{\\mathrm{RMP}}$ 来求得 $\\phi_1(t)$ 的表达式：\n$$\\phi_1(t) - \\phi_{\\mathrm{RMP}} = 2 \\arctan\\left[\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right) \\exp\\left(-\\frac{T_0}{\\Gamma_w} t\\right)\\right]$$\n分离出 $\\phi_1(t)$ 得到最终解：\n$$\\phi_1(t) = \\phi_{\\mathrm{RMP}} + 2 \\arctan\\left[\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right) \\exp\\left(-\\frac{T_0}{\\Gamma_w} t\\right)\\right]$$\n该表达式给出了模相位 $\\phi_1(t)$ 随时间演化的解，它由初始相位 $\\phi_0$ 和系统参数 $\\phi_{\\mathrm{RMP}}$、$T_0$ 及 $\\Gamma_w$ 表示。",
            "answer": "$$\\boxed{\\phi_{\\mathrm{RMP}} + 2 \\arctan\\left(\\tan\\left(\\frac{\\phi_0 - \\phi_{\\mathrm{RMP}}}{2}\\right) \\exp\\left(-\\frac{T_0 t}{\\Gamma_w}\\right)\\right)}$$"
        },
        {
            "introduction": "真实的工程分析往往涉及多物理场耦合的复杂性。本练习作为一个高级的、总结性的实践，旨在反映这一特点 。在破裂期间，Halo电流产生的焦耳热会显著改变壁材料的电阻率，而电阻率的变化又会反过来影响电流的大小和分布。本练习将指导你设计一个耦合了电磁学和热力学效应的数值求解器，展示在计算模型中捕捉关键物理反馈回路的实用方法。",
            "id": "3990376",
            "problem": "您的任务是设计并实现一个热-电磁耦合求解器，用于在一个代表磁约束聚变装置中导电壁段的简化集总参数模型中估算晕电流力。目标是通过在破裂瞬态期间更新随温度变化的电阻率和随温度变化的有效湿润长度，并在每个时间步内进行迭代，直到晕电流和力收敛，从而展示如何耦合热模拟与电磁模拟。\n\n从以下基本原理开始：\n- 材料形式的欧姆定律：$ \\mathbf{J} = \\sigma(T) \\mathbf{E} $，其中 $ \\sigma(T) = 1/\\rho(T) $。\n- 嵌入电路模型的法拉第定律：采用单回路表示法，电动势驱动电流通过一个电阻-电感回路，该回路具有随温度变化的电阻 $ R(T) $ 和一个恒定的回路电感 $ L_{\\mathrm{loop}} $，假设其主要由几何结构决定，并且在短暂的瞬态过程中对温度的依赖性很弱。\n- 壁段的集总能量平衡：内能的变化率等于焦耳热的输入功率减去对冷却剂的热损失。\n\n需要实现的模型细节：\n1. 晕电流电路方程。设 $ I_{\\mathrm{halo}}(t) $ 为晕电流，$ V_{\\mathrm{drive}}(t) $ 为等离子体感应电动势，$ R(T) $ 为回路电阻，$ L_{\\mathrm{loop}} $ 为回路电感。回路方程为\n$$ V_{\\mathrm{drive}}(t) = R(T(t)) \\, I_{\\mathrm{halo}}(t) + L_{\\mathrm{loop}} \\, \\frac{d I_{\\mathrm{halo}}}{dt}(t). $$\n电阻为 $ R(T) = \\rho(T) \\, \\ell / A $，其中 $ \\ell $ 是路径长度（m），$ A $ 是有效横截面积（m$^2$），$ \\rho(T) $ 是随温度变化的电阻率（Ω·m）。使用线性温度依赖关系\n$$ \\rho(T) = \\rho_{\\mathrm{ref}} \\left[ 1 + \\alpha_r \\, (T - T_{\\mathrm{ref}}) \\right], $$\n其中 $ \\rho_{\\mathrm{ref}} $ 是在 $ T_{\\mathrm{ref}} $ 时的电阻率，斜率 $ \\alpha_r $ (1/K)。\n\n2. 热演化。设 $ T(t) $ 为壁段温度，$ C $ 为集总热容（J/K），$ H $ 为对冷却剂的热损失系数（W/K），$ T_{\\mathrm{cool}} $ 为冷却剂温度（K）。能量平衡方程为\n$$ C \\, \\frac{dT}{dt}(t) = I_{\\mathrm{halo}}(t)^2 \\, R(T(t)) - H \\, \\left( T(t) - T_{\\mathrm{cool}} \\right). $$\n\n3. 力估算。设 $ B_t $ 为环向磁场（T）。由晕电流与环向磁场相互作用在壁段上产生的净洛伦兹力的大小近似为\n$$ F(t) = I_{\\mathrm{halo}}(t) \\, B_t \\, L_w(T(t)), $$\n其中 $ L_w(T) $ 是随温度变化的有效湿润极向长度（m）。将 $ L_w(T) $ 建模为\n$$ L_w(T) = L_{w0} \\, \\min \\left( 1 + \\xi \\, \\frac{T - T_{\\mathrm{ref}}}{\\Delta T_{\\mathrm{scale}}}, \\, f_{\\max} \\right), $$\n其中 $ L_{w0} $ (m) 是基准湿润长度，$ \\xi $ 是无量纲灵敏度，$ \\Delta T_{\\mathrm{scale}} $ (K) 是一个标度温度，$ f_{\\max} $ 是饱和因子。\n\n4. 外部驱动。使用指数衰减的电动势\n$$ V_{\\mathrm{drive}}(t) = V_0 \\, e^{-t / \\tau_V}, $$\n其中 $ V_0 $ (V) 和 $ \\tau_V $ (s)。\n\n数值方案要求：\n- 使用均匀的时间步长 $ \\Delta t $ 将时间从 $ t = 0 $ 离散化到 $ t = t_{\\mathrm{end}} $。\n- 在每个时间步内，使用后向欧拉（隐式）方法更新 $ I_{\\mathrm{halo}} $ 和 $ T $，以提高由电感和焦耳热项引起的刚性问题的稳定性。由于 $ R(T) $ 和 $ L_w(T) $ 依赖于 $ T $，因此在每个时间步中采用不动点迭代：\n  - 使用上一步的 $ I $ 和 $ T $ 进行初始化。\n  - 迭代更新 $ R(T) $ 和 $ L_w(T) $，从隐式回路方程中求解 $ I $，然后从隐式能量平衡方程中求解 $ T $，再重新计算 $ F = I \\, B_t \\, L_w(T) $。\n  - 持续迭代，直到 $ I $ 和 $ F $ 均满足以下收敛准则\n    $$ \\max \\left( \\frac{|I^{(k)} - I^{(k-1)}|}{\\max(1, |I^{(k)}|)}, \\, \\frac{|F^{(k)} - F^{(k-1)}|}{\\max(1, |F^{(k)}|)} \\right)  \\varepsilon, $$\n    其中 $ \\varepsilon $ 为预设的容差。\n- 强制施加物理边界：电阻率必须保持非负；如果线性定律得出 $ \\rho(T)  0 $，则将其限制在一个小的正数下限值（例如 $ 0.1 \\, \\rho_{\\mathrm{ref}} $）。\n\n输出与单位：\n- 对于每个测试案例，计算整个瞬态过程中的：\n  - 峰值晕电流 $ \\max_t I_{\\mathrm{halo}}(t) $，单位为安培（A）。\n  - 峰值力 $ \\max_t F(t) $，单位为牛顿（N）。\n- 将每个结果报告为四舍五入到三位小数的浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，各项按 $[I_{\\max,1},F_{\\max,1},I_{\\max,2},F_{\\max,2},\\dots]$ 顺序排列。\n\n测试套件：\n使用以下四个案例来测试不同工况。除非另有说明，否则使用共享参数：\n- 共享的几何和材料参数：\n  - $ \\ell = 10 \\, \\mathrm{m} $，$ A = 2.0 \\times 10^{-3} \\, \\mathrm{m}^2 $。\n  - $ \\rho_{\\mathrm{ref}} = 1.0 \\times 10^{-6} \\, \\Omega \\cdot \\mathrm{m} $，$ T_{\\mathrm{ref}} = 300 \\, \\mathrm{K} $，$ \\alpha_r = 3.0 \\times 10^{-3} \\, \\mathrm{K}^{-1} $。\n  - $ L_{\\mathrm{loop}} = 2.0 \\times 10^{-2} \\, \\mathrm{H} $。\n  - $ L_{w0} = 8.0 \\, \\mathrm{m} $，$ \\xi = 0.5 $，$ \\Delta T_{\\mathrm{scale}} = 200 \\, \\mathrm{K} $，$ f_{\\max} = 2.0 $。\n  - $ T_{\\mathrm{cool}} = 300 \\, \\mathrm{K} $，初始条件 $ I_{\\mathrm{halo}}(0) = 0 \\, \\mathrm{A} $，$ T(0) = 300 \\, \\mathrm{K} $。\n  - 时间离散化：$ \\Delta t = 1.0 \\times 10^{-4} \\, \\mathrm{s} $，$ t_{\\mathrm{end}} = 3.0 \\times 10^{-2} \\, \\mathrm{s} $，收敛容差 $ \\varepsilon = 10^{-6} $，最大内部迭代次数 $ 100 $。\n\n- 案例1（基准冷却，中等驱动）：\n  - $ V_0 = 1.0 \\times 10^{4} \\, \\mathrm{V} $，$ \\tau_V = 1.0 \\times 10^{-2} \\, \\mathrm{s} $，$ B_t = 5.0 \\, \\mathrm{T} $，$ C = 1.0 \\times 10^{3} \\, \\mathrm{J/K} $，$ H = 1.0 \\times 10^{3} \\, \\mathrm{W/K} $。\n\n- 案例2（更强驱动，较弱冷却）：\n  - $ V_0 = 1.2 \\times 10^{4} \\, \\mathrm{V} $，$ \\tau_V = 8.0 \\times 10^{-3} \\, \\mathrm{s} $，$ B_t = 5.0 \\, \\mathrm{T} $，$ C = 1.0 \\times 10^{3} \\, \\mathrm{J/K} $，$ H = 2.0 \\times 10^{2} \\, \\mathrm{W/K} $。\n\n- 案例3（中等驱动，零冷却边界）：\n  - $ V_0 = 8.0 \\times 10^{3} \\, \\mathrm{V} $，$ \\tau_V = 2.0 \\times 10^{-2} \\, \\mathrm{s} $，$ B_t = 5.0 \\, \\mathrm{T} $，$ C = 1.0 \\times 10^{3} \\, \\mathrm{J/K} $，$ H = 0.0 \\, \\mathrm{W/K} $。\n\n- 案例4（基准驱动，低磁场边缘案例）：\n  - $ V_0 = 1.0 \\times 10^{4} \\, \\mathrm{V} $，$ \\tau_V = 1.0 \\times 10^{-2} \\, \\mathrm{s} $，$ B_t = 5.0 \\times 10^{-1} \\, \\mathrm{T} $，$ C = 1.0 \\times 10^{3} \\, \\mathrm{J/K} $，$ H = 1.0 \\times 10^{3} \\, \\mathrm{W/K} $。\n\n您的实现必须：\n- 使用后向欧拉法更新 $ I_{\\mathrm{halo}} $ 和 $ T $，并通过不动点迭代更新 $ \\rho(T) $、$ R(T) $ 和 $ L_w(T) $，直到满足所述的收敛准则。\n- 对于每个案例，计算并记录 $ \\max_t I_{\\mathrm{halo}}(t) $（单位A）和 $ \\max_t F(t) $（单位N），均四舍五入到三位小数。\n- 生成单行输出，其中包含如上所述的列表 $[I_{\\max,1},F_{\\max,1},I_{\\max,2},F_{\\max,2},I_{\\max,3},F_{\\max,3},I_{\\max,4},F_{\\max,4}]$。",
            "solution": "所呈现的问题是一个良态的计算物理问题，其核心是在一个简化的聚变装置部件模型中估算晕电流力。其科学基础是电磁学和传热学的基本原理，并且为获得唯一的数值解提供了所有必要的参数和条件。因此，该问题被认为是有效的。\n\n问题的核心在于求解一个包含两个耦合非线性常微分方程（ODEs）的系统。第一个方程描述了RL电路中晕电流 $I_{\\mathrm{halo}}(t)$ 的演化，第二个方程描述了部件温度 $T(t)$ 的热演化。耦合的产生是因为电路的电阻 $R(T)$ 依赖于温度，而热方程中的焦耳热项 $I_{\\mathrm{halo}}^2 R(T)$ 同时依赖于电流和温度。在力的计算 $F(t)$ 中存在次级耦合，其中有效长度 $L_w(T)$ 也依赖于温度。\n\n控制方程如下：\n1.  **电路方程（源于法拉第定律）：**\n    $$ L_{\\mathrm{loop}} \\, \\frac{d I_{\\mathrm{halo}}}{dt}(t) + R(T(t)) \\, I_{\\mathrm{halo}}(t) = V_{\\mathrm{drive}}(t) $$\n2.  **热方程（源于能量守恒）：**\n    $$ C \\, \\frac{dT}{dt}(t) = I_{\\mathrm{halo}}(t)^2 \\, R(T(t)) - H \\, \\left( T(t) - T_{\\mathrm{cool}} \\right) $$\n\n问题指定使用后向欧拉法进行时间离散化，这是一种一阶隐式数值格式，适用于在此类耦合系统中经常遇到的刚性常微分方程。对于时间步长 $\\Delta t$，我们在时间 $t_{n+1} = t_n + \\Delta t$ 处近似导数，即 $\\frac{dy}{dt} \\approx \\frac{y_{n+1} - y_n}{\\Delta t}$。将此方法应用于我们的系统，会得到一组关于未知状态 $(I_{n+1}, T_{n+1})$ 的耦合代数方程组，该方程组用前一步的已知状态 $(I_n, T_n)$ 来表示。\n\n离散化的电路方程为：\n$$ L_{\\mathrm{loop}} \\frac{I_{n+1} - I_n}{\\Delta t} + R(T_{n+1}) I_{n+1} = V_{\\mathrm{drive}}(t_{n+1}) $$\n整理以求解 $I_{n+1}$，我们得到：\n$$ I_{n+1} = \\frac{V_{\\mathrm{drive}}(t_{n+1}) + \\frac{L_{\\mathrm{loop}}}{\\Delta t} I_n}{R(T_{n+1}) + \\frac{L_{\\mathrm{loop}}}{\\Delta t}} $$\n该方程表明 $I_{n+1}$ 通过电阻项 $R(T_{n+1})$ 依赖于 $T_{n+1}$。\n\n离散化的热方程为：\n$$ C \\frac{T_{n+1} - T_n}{\\Delta t} = I_{n+1}^2 R(T_{n+1}) - H(T_{n+1} - T_{\\mathrm{cool}}) $$\n由于项 $I_{n+1}^2 R(T_{n+1})$ 的存在，该方程对于 $T_{n+1}$ 是非线性的。给定电阻率的线性模型 $\\rho(T) = \\rho_{\\mathrm{ref}} [ 1 + \\alpha_r (T - T_{\\mathrm{ref}}) ]$，电阻也与温度呈线性关系：$R(T) = R_{\\mathrm{ref}} [ 1 + \\alpha_r (T - T_{\\mathrm{ref}}) ]$，其中 $R_{\\mathrm{ref}} = \\rho_{\\mathrm{ref}} \\ell / A$。将此关系代入热方程并重新整理以求解 $T_{n+1}$ 可得：\n$$ T_{n+1} \\left( \\frac{C}{\\Delta t} + H - I_{n+1}^2 R_{\\mathrm{ref}} \\alpha_r \\right) = \\frac{C}{\\Delta t} T_n + H T_{\\mathrm{cool}} + I_{n+1}^2 R_{\\mathrm{ref}}(1 - \\alpha_r T_{\\mathrm{ref}}) $$\n$$ T_{n+1} = \\frac{\\frac{C}{\\Delta t} T_n + H T_{\\mathrm{cool}} + I_{n+1}^2 R_{\\mathrm{ref}}(1 - \\alpha_r T_{\\mathrm{ref}})}{\\frac{C}{\\Delta t} + H - I_{n+1}^2 R_{\\mathrm{ref}} \\alpha_r} $$\n如果 $I_{n+1}$ 已知，该表达式允许直接计算 $T_{n+1}$。\n\n为了在每个时间步求解这个耦合非线性系统，我们采用指定的不动点迭代格式。对于从 $t_n$ 到 $t_{n+1}$ 的每个时间步，我们执行以下由 $k$ 索引的迭代过程：\n\n1.  **初始化 ($k=0$)：** 以新状态的猜测值开始，通常采用前一时间步的状态：$I_{n+1}^{(0)} = I_n$，$T_{n+1}^{(0)} = T_n$。计算相应的力 $F_{n+1}^{(0)}$。\n\n2.  **迭代 ($k \\ge 1$)：**\n    a.  **求解电流：** 使用上一次迭代的温度 $T_{n+1}^{(k-1)}$ 计算更新后的电流 $I_{n+1}^{(k)}$。这首先需要计算 $R^{(k-1)} = R(T_{n+1}^{(k-1)})$。\n        $$ I_{n+1}^{(k)} = \\frac{V_{\\mathrm{drive}}(t_{n+1}) + \\frac{L_{\\mathrm{loop}}}{\\Delta t} I_n}{R^{(k-1)} + \\frac{L_{\\mathrm{loop}}}{\\Delta t}} $$\n    b.  **求解温度：** 使用新计算出的电流 $I_{n+1}^{(k)}$，求解隐式热方程以获得更新后的温度 $T_{n+1}^{(k)}$。\n        $$ T_{n+1}^{(k)} = \\frac{\\frac{C}{\\Delta t} T_n + H T_{\\mathrm{cool}} + (I_{n+1}^{(k)})^2 R_{\\mathrm{ref}}(1 - \\alpha_r T_{\\mathrm{ref}})}{\\frac{C}{\\Delta t} + H - (I_{n+1}^{(k)})^2 R_{\\mathrm{ref}} \\alpha_r} $$\n    c.  **重新计算力：** 使用电流和温度的最新迭代值更新力的估算。这需要计算 $L_w^{(k)} = L_w(T_{n+1}^{(k)})$。\n        $$ F_{n+1}^{(k)} = I_{n+1}^{(k)} B_t L_w^{(k)} $$\n    d.  **检查收敛性：** 迭代持续进行，直到连续两次迭代中电流和力的相对变化量都小于指定的容差 $\\varepsilon$。\n        $$ \\max \\left( \\frac{|I_{n+1}^{(k)} - I_{n+1}^{(k-1)}|}{\\max(1, |I_{n+1}^{(k)}|)}, \\, \\frac{|F_{n+1}^{(k)} - F_{n+1}^{(k-1)}|}{\\max(1, |F_{n+1}^{(k)}|)} \\right)   \\varepsilon $$\n\n3.  **推进：** 一旦内部迭代收敛（或达到最大迭代次数），最终的迭代值 $I_{n+1}^{(k)}$、$T_{n+1}^{(k)}$ 和 $F_{n+1}^{(k)}$ 被接受为时间步 $t_{n+1}$ 的解。然后模拟进入下一个时间步。\n\n对每个测试案例都实施此数值程序。在整个模拟时间内记录 $I_{\\mathrm{halo}}(t)$ 和 $F(t)$ 的峰值。用于计算电阻率 $\\rho(T)$（带非负下限）和湿润长度 $L_w(T)$（带饱和因子）的辅助函数按照问题陈述中的定义来实现。最终输出格式化为这些峰值的单个列表，四舍五入到三位小数。",
            "answer": "[143360.298,6451213.355,173693.076,9294528.219,126868.966,6177114.773,143360.298,645121.336]"
        }
    ]
}