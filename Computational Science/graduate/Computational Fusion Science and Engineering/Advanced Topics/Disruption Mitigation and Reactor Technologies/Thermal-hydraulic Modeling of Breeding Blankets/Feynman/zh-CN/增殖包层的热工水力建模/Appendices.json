{
    "hands_on_practices": [
        {
            "introduction": "为了有效地模拟液态金属增殖包层，我们必须首先确定其中起主导作用的物理力 。本练习利用量级分析法来比较电磁洛伦兹力与粘性力的大小。这项基础实践揭示了为何磁流体动力学（MHD）效应在此类系统中至关重要，并引出了控制该流动状态的关键无量纲数。",
            "id": "4055249",
            "problem": "考虑一个托卡马克中双冷铅锂增殖包层的一段直矩形管道。该管道承载着均匀的共晶铅锂（PbLi）平均流，其特征体速度为 $U$，水力长度尺度为 $L$，电导率为 $\\sigma$，密度为 $\\rho$，运动粘度为 $\\nu$。由环向场线圈施加的大小为 $B$ 的均匀磁场，其方向近似垂直于平均流方向。假设适用于液态金属磁流体动力学（MHD）的低磁雷诺数（准静态）极限，因此流体引起的磁感应可以忽略不计，外加磁场不受流体扰动。\n\n从以下公式出发：\n- 运动导体的欧姆定律 $\\mathbf{J}=\\sigma\\left(\\mathbf{E}+\\mathbf{U}\\times\\mathbf{B}\\right)$，以及准静态极限下的无散电流约束 $\\nabla\\cdot\\mathbf{J}=0$，和\n- 包含洛伦兹力密度（单位体积）的不可压缩动量平衡方程 $\\rho\\left(\\partial\\mathbf{U}/\\partial t+\\mathbf{U}\\cdot\\nabla\\mathbf{U}\\right)=-\\nabla p+\\mu\\nabla^{2}\\mathbf{U}+\\mathbf{J}\\times\\mathbf{B}$，其中动力粘度为 $\\mu=\\rho\\nu$，\n\n进行标度分析，以估计洛伦兹力密度大小的量级 $f_{L}\\sim\\|\\mathbf{J}\\times\\mathbf{B}\\|$ 和粘性力密度大小的量级 $f_{\\nu}\\sim\\|\\mu\\nabla^{2}\\mathbf{U}\\|$。用这些量级构建无量纲比率 $R=f_{L}/f_{\\nu}$，该比率表示电磁阻尼相对于粘性扩散的主导地位，从而反映MHD对湍流的抑制程度。\n\n使用以下包层相关工况的代表性PbLi和流动参数：\n- 电导率 $\\sigma=8.0\\times 10^{5}$ S/m，\n- 密度 $\\rho=9.4\\times 10^{3}$ kg/m$^{3}$，\n- 运动粘度 $\\nu=1.5\\times 10^{-7}$ m$^{2}$/s，\n- 磁场大小 $B=5.0$ T，\n- 平均速度 $U=0.20$ m/s，\n- 特征长度 $L=0.050$ m。\n\n计算 $R$ 并将答案四舍五入至三位有效数字。最终结果以无量纲数表示（无单位）。",
            "solution": "所述问题具有科学依据，提法明确，并包含了解决该问题所需的所有信息。这是磁流体动力学（MHD）标度分析中的一个标准练习，与计算聚变科学领域相关。因此，该问题是有效的。我们着手进行求解。\n\n目标是求出无量纲比率 $R = f_{L}/f_{\\nu}$，其中 $f_{L}$ 是洛伦兹力密度的大小，$f_{\\nu}$ 是粘性力密度的大小。这需要对控制方程中的相关项进行标度分析。\n\n首先，我们估计洛伦兹力密度的标度 $f_{L} \\sim \\|\\mathbf{J}\\times\\mathbf{B}\\|$。其大小的标度为 $f_{L} \\sim J B$，其中 $J$ 是电流密度 $\\mathbf{J}$ 的特征大小，$B$ 是外加磁场的大小。为了找到 $J$ 的标度，我们结合准静态无散电流密度约束 $\\nabla\\cdot\\mathbf{J}=0$，分析运动导体的欧姆定律 $\\mathbf{J}=\\sigma\\left(\\mathbf{E}+\\mathbf{U}\\times\\mathbf{B}\\right)$。\n\n在准静态极限下，电场是无旋的（$\\nabla\\times\\mathbf{E}=0$），可以表示为一个标量电势 $\\phi$ 的梯度，即 $\\mathbf{E}=-\\nabla\\phi$。将此代入欧姆定律，得到 $\\mathbf{J}=\\sigma\\left(-\\nabla\\phi+\\mathbf{U}\\times\\mathbf{B}\\right)$。\n\n应用散度算子并利用 $\\nabla\\cdot\\mathbf{J}=0$，我们得到：\n$$\n\\nabla\\cdot\\left[\\sigma\\left(-\\nabla\\phi+\\mathbf{U}\\times\\mathbf{B}\\right)\\right] = 0\n$$\n假设电导率 $\\sigma$ 是均匀的，可以将其从散度算子中提出：\n$$\n-\\nabla\\cdot(\\nabla\\phi) + \\nabla\\cdot(\\mathbf{U}\\times\\mathbf{B}) = 0\n$$\n这就得到了一个关于电势的泊松方程：\n$$\n\\nabla^{2}\\phi = \\nabla\\cdot(\\mathbf{U}\\times\\mathbf{B})\n$$\n我们现在对此方程进行标度分析。空间变化的特征长度尺度为 $L$，所以拉普拉斯算子的标度为 $\\nabla^{2} \\sim 1/L^{2}$，散度算子的标度为 $\\nabla\\cdot \\sim 1/L$。特征速度为 $U$，磁场大小为 $B$。\n该方程的标度关系变为：\n$$\n\\frac{\\phi}{L^{2}} \\sim \\frac{UB}{L}\n$$\n由此，我们可以推导出电势的特征标度：\n$$\n\\phi \\sim UBL\n$$\n电场的特征大小则为 $E \\sim |\\nabla\\phi| \\sim \\phi/L$：\n$$\nE \\sim \\frac{UBL}{L} = UB\n$$\n欧姆定律中的项 $\\mathbf{U}\\times\\mathbf{B}$ 的大小标度为 $UB\\sin\\theta$，其中 $\\theta$ 是 $\\mathbf{U}$ 和 $\\mathbf{B}$ 之间的夹角。由于问题陈述磁场近似垂直于流体，$\\sin\\theta \\approx 1$，因此该项的标度也为 $UB$。由于欧姆定律括号中的两项 $\\mathbf{E}$ 和 $\\mathbf{U}\\times\\mathbf{B}$ 的标度均为 $UB$，所以最终的电流密度大小 $J$ 的标度必须为：\n$$\nJ \\sim \\sigma(E + UB) \\sim \\sigma(UB)\n$$\n现在，我们可以得到洛伦兹力密度的标度，$f_{L} \\sim J B$：\n$$\nf_{L} \\sim (\\sigma U B) B = \\sigma U B^{2}\n$$\n接下来，我们估计粘性力密度的标度，$f_{\\nu} \\sim \\|\\mu\\nabla^{2}\\mathbf{U}\\|$。这里，$\\mu$ 是动力粘度，$\\mathbf{U}$ 是速度场，$\\nabla^2$ 是拉普拉斯算子。使用速度的特征标度 $U$ 和长度的特征标度 $L$，速度的二阶空间导数标度为 $U/L^2$。因此，粘性力密度的标度为：\n$$\nf_{\\nu} \\sim \\mu \\frac{U}{L^{2}}\n$$\n问题给出了运动粘度 $\\nu$ 和密度 $\\rho$。动力粘度通过 $\\mu=\\rho\\nu$ 相关联。代入此关系，我们得到：\n$$\nf_{\\nu} \\sim \\rho\\nu \\frac{U}{L^{2}}\n$$\n现在我们可以构建无量纲比率 $R$：\n$$\nR = \\frac{f_{L}}{f_{\\nu}} \\sim \\frac{\\sigma U B^{2}}{\\rho\\nu U / L^{2}}\n$$\n特征速度 $U$ 被消去，得到 $R$ 的最终符号表达式：\n$$\nR = \\frac{\\sigma B^{2} L^{2}}{\\rho\\nu}\n$$\n这个无量纲量被称为哈特曼数（Hartmann number）的平方，$R = Ha^{2}$。它代表电磁力与粘性力之比。\n\n最后，我们代入给定的数值来计算 $R$：\n- $\\sigma = 8.0 \\times 10^{5}$ S/m\n- $B = 5.0$ T\n- $L = 0.050$ m\n- $\\rho = 9.4 \\times 10^{3}$ kg/m$^{3}$\n- $\\nu = 1.5 \\times 10^{-7}$ m$^{2}$/s\n\n$$\nR = \\frac{(8.0 \\times 10^{5}) \\cdot (5.0)^{2} \\cdot (0.050)^{2}}{(9.4 \\times 10^{3}) \\cdot (1.5 \\times 10^{-7})}\n$$\n$$\nR = \\frac{(8.0 \\times 10^{5}) \\cdot (25.0) \\cdot (2.5 \\times 10^{-3})}{1.41 \\times 10^{-3}}\n$$\n$$\nR = \\frac{5.0 \\times 10^{4}}{1.41 \\times 10^{-3}}\n$$\n$$\nR \\approx 3.546099 \\times 10^{7}\n$$\n按要求四舍五入到三位有效数字：\n$$\nR \\approx 3.55 \\times 10^{7}\n$$\n$R$ 的巨大数值表明电磁力远大于粘性力，这是托卡马克强磁场中液态金属流动的典型特征，并导致显著的湍流抑制。",
            "answer": "$$\\boxed{3.55 \\times 10^{7}}$$"
        },
        {
            "introduction": "在确定了磁流体动力学（MHD）力的主导地位之后，我们现在将探讨其对速度分布的具体影响 。本练习要求推导经典哈特曼（Hartmann）流的速度剖面。解决这个问题能让我们从解析层面具体地理解磁场如何使核心区的速度分布变得平坦，并在壁面附近形成薄的、高剪切的边界层——这是决定压降和传热特性的关键特征。",
            "id": "4055259",
            "problem": "一种代表增殖包层（共晶铅锂）的液态金属冷却剂稳定地流过一个长矩形管道段。该管道在 $z$ 方向上的高度为 $2a$，在 $y$ 方向上的宽度非常大（因此侧壁效应可以忽略不计）。流动由均匀的轴向压力梯度 $\\partial p/\\partial x$ 驱动，并受到聚变装置产生的沿 $z$ 方向、大小为 $B$ 的均匀横向磁场的作用。假设磁流体动力学（MHD）的准静态极限、不可压缩层流、充分发展条件，以及在 $z=\\pm a$ 处带有无滑移条件的电绝缘 Hartmann 壁。流体的密度为 $\\rho$，运动粘度为 $\\nu$，电导率为 $\\sigma$。Hartmann 数定义为 $Ha = B a \\sqrt{\\sigma/(\\rho\\nu)}$。仅使用带有洛伦兹体力的基本动量方程和移动导体的欧姆定律，推导轴向速度场 $u(z)$，然后计算由核心区与 Hartmann 边界层所承载的体积流量分数。其中，核心区定义为中心区域 $|z| \\le a - \\delta_H$，Hartmann 边界层是邻近每个 Hartmann 壁的两个厚度为 $\\delta_H$ 的区域，且 $\\delta_H = a/Ha$。在 $Ha=100$ 时计算您最终的分数。将这两个比例表示为一个行向量 $(\\text{核心区}, \\text{边界层})$，形式为无量纲小数。将您的答案四舍五入到六位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 流体：液态金属冷却剂（共晶铅锂）。\n- 流动条件：稳态、不可压缩、层流、充分发展。\n- 管道几何形状：矩形，在 $z$ 方向高度为 $2a$，在 $y$ 方向宽度非常大（侧壁效应可忽略）。\n- 壁面：在 $z=\\pm a$ 处的电绝缘 Hartmann 壁，带有无滑移条件。\n- 驱动力：均匀的轴向压力梯度 $\\partial p/\\partial x$。\n- 外部场：在 $z$ 方向的大小为 $B$ 的均匀横向磁场 $\\mathbf{B}$。\n- 控制物理学：磁流体动力学（MHD）的准静态极限。\n- 流体性质：密度 $\\rho$，运动粘度 $\\nu$，电导率 $\\sigma$。\n- 定义：Hartmann 数 $Ha = B a \\sqrt{\\sigma/(\\rho\\nu)}$。\n- 任务：从基本方程推导轴向速度 $u(z)$。计算核心区（$|z| \\le a - \\delta_H$）和 Hartmann 边界层（厚度 $\\delta_H = a/Ha$）的体积流量分数。在 $Ha=100$ 时计算分数，并四舍五入到六位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据充分**：该问题描述了 Hartmann 流动，这是 MHD 中的一个典型问题，其理论成熟，并基于流体动力学和电磁学的基本原理。准静态近似是磁雷诺数较小的液态金属流动的标准处理方法。该设置对于聚变包层概念是物理上现实的。\n- **适定的**：该问题提供了所有必要的信息（控制方程、几何形状、边界条件、流体性质），以推导速度剖面和后续流量分数的唯一解。\n- **客观的**：语言精确且定量。所有术语都是 MHD 领域的标准术语。\n\n### 第 3 步：结论与行动\n该问题是有效的，因为它是科学合理的、适定的和客观的。它代表了计算聚变科学与工程中的一个标准推导。将提供解答。\n\n### 速度剖面的推导\n流动由稳态、不可压缩流体的动量方程控制，其中包括洛伦兹力和欧姆定律。动量方程（Navier-Stokes）为：\n$$\n\\rho (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{J} \\times \\mathbf{B}\n$$\n其中 $\\mathbf{u}$ 是速度矢量，$p$ 是压力，$\\mu = \\rho\\nu$ 是动力粘度，$\\mathbf{J}$ 是电流密度。\n\n流动是稳态的（$\\partial/\\partial t = 0$）和充分发展的，这意味着速度剖面与轴向坐标 $x$ 无关。根据几何形状，速度仅在 $x$ 方向上，并且仅随 $z$ 变化：$\\mathbf{u} = u(z) \\mathbf{\\hat{x}}$。不可压缩性条件 $\\nabla \\cdot \\mathbf{u} = 0$ 因 $\\partial u/\\partial x = 0$ 而自动满足。对流加速度项 $(\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = (u(z)\\partial/\\partial x) (u(z)\\mathbf{\\hat{x}}) = 0$。侧壁效应可以忽略，因此我们假设对于所有物理量 $\\partial/\\partial y = 0$。\n\n动量方程简化。对于 $x$ 分量：\n$$\n0 = -\\frac{\\partial p}{\\partial x} + \\mu \\frac{d^2 u}{d z^2} + (\\mathbf{J} \\times \\mathbf{B})_x\n$$\n压力梯度 $\\partial p/\\partial x$ 被给定为一个均匀常数。我们定义 $G = -\\partial p/\\partial x$。\n\n为了求出洛伦兹力 $\\mathbf{J} \\times \\mathbf{B}$，我们首先需要从准静态极限下的欧姆定律得到电流密度 $\\mathbf{J}$：\n$$\n\\mathbf{J} = \\sigma (\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B})\n$$\n磁场为 $\\mathbf{B} = B \\mathbf{\\hat{z}}$。动生电动势为 $\\mathbf{u} \\times \\mathbf{B} = (u(z)\\mathbf{\\hat{x}}) \\times (B\\mathbf{\\hat{z}}) = -u(z) B \\mathbf{\\hat{y}}$。\n\n对于电场 $\\mathbf{E}$，我们使用麦克斯韦方程组。根据稳态下的法拉第定律，$\\nabla \\times \\mathbf{E} = 0$，这意味着对于某个电势 $\\phi$，有 $\\mathbf{E} = -\\nabla \\phi$。根据电荷守恒，$\\nabla \\cdot \\mathbf{J} = 0$。将欧姆定律代入此式得到 $\\sigma \\nabla \\cdot (\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B}) = 0$，这导致 $\\nabla^2\\phi = \\nabla \\cdot (\\mathbf{u} \\times \\mathbf{B})$。\n$$\n\\nabla \\cdot (\\mathbf{u} \\times \\mathbf{B}) = \\frac{\\partial}{\\partial y}(-u(z)B) = 0\n$$\n所以，我们必须求解电势的拉普拉斯方程 $\\nabla^2 \\phi = 0$。由于 $\\partial/\\partial x = \\partial/\\partial y = 0$，该方程变为 $d^2\\phi/dz^2 = 0$，所以 $\\phi(z) = C_1 z + C_2$。在 $z=\\pm a$ 处的壁是电绝缘的，这意味着电流的法向分量 $J_z$ 在壁面处必须为零。\n$$\nJ_z = \\sigma (E_z + (\\mathbf{u} \\times \\mathbf{B})_z) = \\sigma E_z = -\\sigma \\frac{d\\phi}{dz} = -\\sigma C_1\n$$\n条件 $J_z(\\pm a)=0$ 要求 $C_1=0$。这意味着 $\\phi$ 是一个常数，因此电场 $\\mathbf{E} = -\\nabla \\phi = 0$。这个条件对应于横向（$y$ 方向）的开路，这对于无限宽的管道是合适的。\n\n当 $\\mathbf{E}=0$ 时，欧姆定律简化为 $\\mathbf{J} = \\sigma (\\mathbf{u} \\times \\mathbf{B}) = -\\sigma u(z) B \\mathbf{\\hat{y}}$。于是洛伦兹力为：\n$$\n\\mathbf{J} \\times \\mathbf{B} = (-\\sigma u(z) B \\mathbf{\\hat{y}}) \\times (B\\mathbf{\\hat{z}}) = -\\sigma B^2 u(z) \\mathbf{\\hat{x}}\n$$\n将此代入 $x$ 方向动量方程：\n$$\n0 = G + \\mu \\frac{d^2 u}{d z^2} - \\sigma B^2 u(z)\n$$\n重新整理得到 $u(z)$ 的控制常微分方程：\n$$\n\\frac{d^2 u}{d z^2} - \\frac{\\sigma B^2}{\\mu} u(z) = -\\frac{G}{\\mu}\n$$\n使用定义 $\\mu = \\rho\\nu$ 和 Hartmann 数 $Ha = B a \\sqrt{\\sigma/(\\rho\\nu)} = B a \\sqrt{\\sigma/\\mu}$，我们可以将系数写为 $\\frac{\\sigma B^2}{\\mu} = \\frac{Ha^2}{a^2}$。常微分方程（ODE）变为：\n$$\n\\frac{d^2 u}{d z^2} - \\frac{Ha^2}{a^2} u(z) = -\\frac{G}{\\mu}\n$$\n通解是齐次解 $u_h$ 和特解 $u_p$ 的和。齐次方程是 $u_h'' - (Ha/a)^2 u_h = 0$，其解为 $u_h(z) = C_1 \\cosh(Ha \\cdot z/a) + C_2 \\sinh(Ha \\cdot z/a)$。特解是一个常数，$u_p = (G/\\mu) / (Ha^2/a^2) = Ga^2/(\\mu Ha^2) = G/(\\sigma B^2)$。\n完整解为 $u(z) = C_1 \\cosh(Ha \\cdot z/a) + C_2 \\sinh(Ha \\cdot z/a) + G/(\\sigma B^2)$。\n边界条件是壁面处的无滑移条件：$u(a)=0$ 和 $u(-a)=0$。流动关于 $z=0$ 对称，所以 $u(z)=u(-z)$，这要求 $C_2=0$。应用 $u(a)=0$：\n$$\n0 = C_1 \\cosh(Ha) + \\frac{G}{\\sigma B^2} \\implies C_1 = -\\frac{G}{\\sigma B^2 \\cosh(Ha)}\n$$\n代入 $C_1$ 得到最终的速度剖面：\n$$\nu(z) = \\frac{G}{\\sigma B^2} \\left(1 - \\frac{\\cosh(Ha \\cdot z/a)}{\\cosh(Ha)}\\right)\n$$\n\n### 体积流量分数的计算\n单位宽度的总体积流量 $Q_{tot}$ 是 $u(z)$ 从 $z=-a$ 到 $z=a$ 的积分：\n$$\nQ_{tot} = \\int_{-a}^{a} u(z) dz = \\frac{G}{\\sigma B^2} \\int_{-a}^{a} \\left(1 - \\frac{\\cosh(Ha \\cdot z/a)}{\\cosh(Ha)}\\right) dz\n$$\n$$\nQ_{tot} = \\frac{G}{\\sigma B^2} \\left[ z - \\frac{a}{Ha \\cosh(Ha)} \\sinh\\left(\\frac{Ha \\cdot z}{a}\\right) \\right]_{-a}^{a} = \\frac{G}{\\sigma B^2} \\left( 2a - \\frac{2a}{Ha} \\frac{\\sinh(Ha)}{\\cosh(Ha)} \\right)\n$$\n$$\nQ_{tot} = \\frac{2aG}{\\sigma B^2} \\left( 1 - \\frac{\\tanh(Ha)}{Ha} \\right)\n$$\n核心区由 $|z| \\le a - \\delta_H = a(1-1/Ha)$ 定义。核心区的体积流量 $Q_{core}$ 为：\n$$\nQ_{core} = \\int_{-a(1-1/Ha)}^{a(1-1/Ha)} u(z) dz = 2 \\int_{0}^{a(1-1/Ha)} u(z) dz\n$$\n$$\nQ_{core} = 2 \\frac{G}{\\sigma B^2} \\left[ z - \\frac{a}{Ha \\cosh(Ha)} \\sinh\\left(\\frac{Ha \\cdot z}{a}\\right) \\right]_{0}^{a(1-1/Ha)}\n$$\n$$\nQ_{core} = \\frac{2G}{\\sigma B^2} \\left( a\\left(1-\\frac{1}{Ha}\\right) - \\frac{a}{Ha \\cosh(Ha)} \\sinh\\left(Ha\\left(1-\\frac{1}{Ha}\\right)\\right) \\right)\n$$\n$$\nQ_{core} = \\frac{2aG}{\\sigma B^2} \\left( 1 - \\frac{1}{Ha} - \\frac{\\sinh(Ha - 1)}{Ha \\cosh(Ha)} \\right)\n$$\n核心区的流量分数 $f_{core}$ 是 $Q_{core}/Q_{tot}$ 的比率：\n$$\nf_{core} = \\frac{1 - \\frac{1}{Ha} - \\frac{\\sinh(Ha-1)}{Ha \\cosh(Ha)}}{1 - \\frac{\\tanh(Ha)}{Ha}} = \\frac{Ha - 1 - \\frac{\\sinh(Ha-1)}{\\cosh(Ha)}}{Ha - \\tanh(Ha)}\n$$\nHartmann 边界层中的流量分数 $f_{BL}$ 简单地为 $1 - f_{core}$。\n\n### 在 $Ha=100$ 时的计算\n我们现在计算 $Ha=100$ 时的分数。\n$$\nf_{core} = \\frac{100 - 1 - \\frac{\\sinh(99)}{\\cosh(100)}}{100 - \\tanh(100)}\n$$\n对于 $Ha=100$，$\\tanh(100)$ 极度接近于 $1$，并且双曲函数非常大。使用高精度计算：\n$\\tanh(100) \\approx 1.0$\n$\\cosh(100) \\approx 1.3444... \\times 10^{43}$\n$\\sinh(99) \\approx 4.9458... \\times 10^{42}$\n分数 $\\sinh(99)/\\cosh(100) \\approx e^{-1} \\approx 0.367879$。\n我们计算这些值：\n$$\nf_{core} = \\frac{99 - \\frac{\\sinh(99)}{\\cosh(100)}}{100 - \\tanh(100)} \\approx 0.996284046\n$$\n$$\nf_{BL} = 1 - f_{core} \\approx 1 - 0.996284046 = 0.003715954\n$$\n将这两个值四舍五入到六位有效数字，得到：\n$f_{core} \\approx 0.996284$\n$f_{BL} \\approx 0.00371595$\n结果应表示为行向量 $(\\text{核心区}, \\text{边界层})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.996284 & 0.00371595 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然解析解能提供深刻的物理洞察，但实际的工程问题往往依赖于计算建模 。这最后一个练习直面模拟高哈特曼（Hartmann）数流动的实际挑战。通过分析捕捉薄边界层所需的网格分辨率和数值时间步长的稳定性约束，本练习将物理理论与构建有效、精确的计算模型所需满足的条件直接联系起来。",
            "id": "4055210",
            "problem": "一个宽度为 $W$、高度为 $H$ 的二维矩形管道，在沿 $y$ 轴方向、大小为 $B$ 的均匀磁场作用下，输运着增殖包层中的不可压缩导电液态金属。流动主要沿 $x$ 轴方向，特征流向速度为 $U$。流体性质包括质量密度 $\\rho$、运动粘度 $\\nu$ 和电导率 $\\sigma$。流动处于低磁雷诺数区，因此准静态磁流体力学（MHD）假设适用。在此假设下，控制方程为质量守恒、动量守恒和运动介质的欧姆定律。具体而言，质量守恒方程为 $\\nabla \\cdot \\mathbf{u} = 0$，动量守恒方程为 $\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u} \\right) = -\\nabla p + \\rho \\nu \\nabla^2 \\mathbf{u} + \\sigma \\left( -\\nabla \\phi + \\mathbf{u} \\times \\mathbf{B} \\right) \\times \\mathbf{B}$，欧姆定律为 $\\mathbf{J} = \\sigma \\left( -\\nabla \\phi + \\mathbf{u} \\times \\mathbf{B} \\right)$，其中电势 $\\phi$ 由 $\\nabla \\cdot \\mathbf{J} = 0$ 确定。\n\n在这种管道流中，法向与磁场方向一致的壁面附近会形成薄的哈特曼层。哈特曼数 $\\mathrm{Ha}$ 定义为 $\\mathrm{Ha} = B H \\sqrt{\\frac{\\sigma}{\\rho \\nu}}$，哈特曼层厚度与 $\\delta_H \\sim \\frac{H}{\\mathrm{Ha}}$ 成比例，该关系通过平衡边界层内的粘性扩散和洛伦兹力得到。\n\n您的任务是为二维横截面建立一个能够解析 $y=0$ 和 $y=H$ 壁面附近哈特曼层的数值有限差分格式。为确保足够的分辨率，要求哈特曼层厚度 $\\delta_H$ 内至少有 $m$ 个网格点。对于 $y$ 方向的均匀网格，近壁面间距为 $\\Delta y_{\\mathrm{uni}} = \\frac{H}{N_y-1}$。对于非均匀、壁面加密网格，使用双曲正切映射将网格点放置在 $y_j = \\frac{H}{2}\\left(1 + \\frac{\\tanh\\left(\\beta \\xi_j\\right)}{\\tanh \\beta}\\right)$，其中 $\\xi_j = -1 + \\frac{2 j}{N_y-1}$，$j=0,1,\\dots,N_y-1$，且 $\\beta>0$ 控制加密程度。拉伸网格的最小近壁面间距为 $\\Delta y_{\\min} = \\min_j \\left(y_{j+1} - y_j\\right)$。\n\n假设采用标准的显式时间积分，其中扩散项使用中心差分，平流项使用一阶迎风格式。根据冯·诺依曼稳定性分析，施加以下稳定性约束：\n\n- 二维粘性扩散稳定性：\n$$\\Delta t \\le \\frac{1}{2 \\nu} \\cdot \\frac{1}{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y_{\\min}^2}},$$\n其中 $\\Delta x = \\frac{W}{N_x-1}$，$\\Delta y_{\\min}$ 是 $y$ 方向的最小网格间距。\n\n- 基于流向平流的 Courant–Friedrichs–Lewy (CFL) 条件：\n$$\\Delta t \\le \\frac{\\Delta x}{|U|},$$\n此处假设在充分发展的横截面中，横向平流可以忽略不计，且 $U$ 是特征流向速度。\n\n- 洛伦兹力引起的线性阻尼的显式稳定性，该阻尼被建模为一个有效线性汇项，其系数为 $\\alpha = \\frac{\\sigma B^2}{\\rho}$：\n$$\\Delta t \\le \\frac{2}{\\alpha} = \\frac{2 \\rho}{\\sigma B^2}.$$\n\n将最大稳定时间步长定义为 $\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{Lorentz}}\\right)$。\n\n编写一个完整的、可运行的程序，对下方的每个测试用例执行以下计算：\n\n1. 计算哈特曼数 $\\mathrm{Ha}$ 和哈特曼层厚度 $\\delta_H$。\n2. 给定 $y$ 方向的点数预算 $N_y$，判断哈特曼层是否被以下网格解析：\n   - 均匀网格：$\\Delta y_{\\mathrm{uni}} \\le \\delta_H/m$，\n   - 使用 tanh 映射的拉伸网格：$\\Delta y_{\\min} \\le \\delta_H/m$。\n3. 计算解析哈特曼层所需的最小 $N_y$：\n   - 均匀网格：满足 $\\frac{H}{N_y-1} \\le \\frac{\\delta_H}{m}$ 的最小整数 $N_y \\ge 3$，\n   - 拉伸网格（对于给定的 $\\beta$）：使 tanh 映射网格满足 $\\Delta y_{\\min} \\le \\frac{\\delta_H}{m}$ 的最小整数 $N_y \\ge 3$。\n4. 使用给定的 $N_x$ 和 $N_y$ 预算，分别计算均匀网格和拉伸网格的 $\\Delta t_{\\max}$。\n\n所有时间步长的值都以秒为单位表示。对于每个测试用例，返回一个包含八个条目的列表：\n- $[\\mathrm{Ha}, \\delta_H, N_{y,\\mathrm{req}}^{\\mathrm{uni}}, N_{y,\\mathrm{req}}^{\\mathrm{str}}, \\mathrm{resolved}_{\\mathrm{uni}}, \\mathrm{resolved}_{\\mathrm{str}}, \\Delta t_{\\max}^{\\mathrm{uni}}, \\Delta t_{\\max}^{\\mathrm{str}}]$,\n其中 $\\mathrm{resolved}_{\\mathrm{uni}}$ 和 $\\mathrm{resolved}_{\\mathrm{str}}$ 是布尔值，表示在给定的 $N_y$ 预算下是否达到分辨率要求。\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由逗号分隔的八元素列表组成的列表，并用方括号括起来（例如，\"[[...],[...],[...]]\"）。\n\n使用以下具有科学真实参数的测试套件。所有量均采用国际单位制（SI units）。确保所有适用的输出均以秒为单位。\n\n- 测试用例 1（强磁场下的典型聚变包层流）：\n  - $W = 0.20$, $H = 0.10$, $\\rho = 9300$, $\\nu = 6.0\\times 10^{-7}$, $\\sigma = 1.0\\times 10^{6}$, $B = 5.0$, $U = 0.10$, $N_x = 64$, $N_y = 300$, $m = 10$, $\\beta = 3.0$。\n- 测试用例 2（非常强的磁场，更薄的哈特曼层）：\n  - $W = 0.20$, $H = 0.10$, $\\rho = 9300$, $\\nu = 6.0\\times 10^{-7}$, $\\sigma = 1.0\\times 10^{6}$, $B = 10.0$, $U = 0.10$, $N_x = 64$, $N_y = 600$, $m = 12$, $\\beta = 3.5$。\n- 测试用例 3（较弱的磁场，较厚的哈特曼层）：\n  - $W = 0.20$, $H = 0.10$, $\\rho = 9300$, $\\nu = 6.0\\times 10^{-7}$, $\\sigma = 1.0\\times 10^{6}$, $B = 0.5$, $U = 0.05$, $N_x = 64$, $N_y = 64$, $m = 8$, $\\beta = 2.0$。\n\n所有布尔值应以其编程语言原生的字面量形式打印。所有整数和浮点数应以数值形式打印。单行输出必须按所述方式汇总三个测试用例的结果。",
            "solution": "用户提供了一个在计算磁流体力学（MHD）领域中与聚变反应堆包层设计相关的明确问题。任务是为一个在强磁场下矩形管道中液态金属流动的有限差分模拟计算关键的数值参数。这些参数包括哈特曼数（$\\mathrm{Ha}$）、哈特曼边界层的厚度（$\\delta_H$）、解析这些层所需的网格点数（$N_y$），以及显式时间积分方案的最大稳定时间步长（$\\Delta t_{\\max}$）。计算需要对均匀网格和壁面加密（拉伸）网格两种情况分别进行。\n\n该问题在科学和数学上是合理的，提供了所有必要的物理参数、控制方程和数值公式。验证过程证实了其完整性、一致性和客观性。因此，我们可以着手进行系统的、基于原理的求解。\n\n求解过程结构如下：\n1.  计算特征无量纲数（$\\mathrm{Ha}$）及相关的边界层厚度（$\\delta_H$）。\n2.  确定网格分辨率要求并评估给定的网格预算。这涉及到为均匀网格和拉伸网格计算最小网格间距。\n3.  计算满足两种网格类型分辨率标准所需的最小网格点数（$N_y$）。\n4.  评估由粘性扩散、平流（CFL 条件）和洛伦兹力阻尼项引起的对显式时间步长的稳定性约束。\n\n**1. 物理和数值参数**\n\n流动状态由哈特曼数 $\\mathrm{Ha}$ 表征，它代表电磁力与粘性力之比。其定义为：\n$$\n\\mathrm{Ha} = B H \\sqrt{\\frac{\\sigma}{\\rho \\nu}}\n$$\n其中 $B$ 是磁场强度，$H$ 是管道高度，$\\sigma$ 是电导率，$\\rho$ 是质量密度，$\\nu$ 是运动粘度。\n\n在这种流动中，垂直于磁场的壁面（即位于 $y=0$ 和 $y=H$ 的“哈特曼壁”）上会形成称为哈特曼层的薄边界层。这些层的厚度 $\\delta_H$ 与哈特曼数成反比：\n$$\n\\delta_H = \\frac{H}{\\mathrm{Ha}}\n$$\n为了数值上解析这些薄层，近壁面的网格间距必须足够小。问题指定了在一个层厚度内至少有 $m$ 个网格点的要求，这转化为最大允许的近壁面网格间距为 $\\Delta y_{\\text{target}} = \\delta_H / m$。\n\n**2. 网格分辨率和要求**\n\n我们分析 $y$ 方向上的两种网格类型。\n\n**均匀网格：**\n对于具有 $N_y$ 个点的均匀网格，间距是恒定的：\n$$\n\\Delta y_{\\mathrm{uni}} = \\frac{H}{N_y-1}\n$$\n如果 $\\Delta y_{\\mathrm{uni}} \\le \\delta_H/m$，则满足分辨率要求。所需的最小点数 $N_{y,\\mathrm{req}}^{\\mathrm{uni}}$ 通过解关于 $N_y$ 的这个不等式得到：\n$$\n\\frac{H}{N_y-1} \\le \\frac{H / \\mathrm{Ha}}{m} \\implies N_y-1 \\ge m \\cdot \\mathrm{Ha} \\implies N_y \\ge m \\cdot \\mathrm{Ha} + 1\n$$\n由于 $N_y$ 必须是整数且至少为 3，所需的点数为 $N_{y,\\mathrm{req}}^{\\mathrm{uni}} = \\max(3, \\lceil m \\cdot \\mathrm{Ha} + 1 \\rceil)$。\n\n**拉伸网格：**\n使用双曲正切映射来在壁面附近加密点。网格点 $y_j$ 由以下公式给出：\n$$\ny_j = \\frac{H}{2}\\left(1 + \\frac{\\tanh(\\beta \\xi_j)}{\\tanh \\beta}\\right) \\quad \\text{with} \\quad \\xi_j = -1 + \\frac{2j}{N_y-1} \\quad \\text{for } j=0, \\dots, N_y-1\n$$\n网格间距在壁面处（$\\xi = \\pm 1$）最密，在中心处（$\\xi = 0$）最疏。最小间距 $\\Delta y_{\\min}$ 出现在第一个区间，$\\Delta y_{\\min} = y_1 - y_0$。由于 $y_0 = 0$，我们有：\n$$\n\\Delta y_{\\min} = y_1 = \\frac{H}{2}\\left(1 + \\frac{\\tanh\\left(\\beta \\left(-1 + \\frac{2}{N_y-1}\\right)\\right)}{\\tanh \\beta}\\right)\n$$\n如果这个 $\\Delta y_{\\min} \\le \\delta_H/m$，则满足分辨率要求。\n为了找到所需的点数 $N_{y,\\mathrm{req}}^{\\mathrm{str}}$，我们必须找到满足这个非线性不等式的最小整数 $N_y \\ge 3$。最可靠的方法是使用数值搜索，从 $N_y=3$ 开始并递增，直到满足条件。\n\n**3. 显式时间步长稳定性**\n\n显式格式的最大稳定时间步长 $\\Delta t_{\\max}$ 受三个物理过程的限制：\n\n- **平流 (CFL) 约束：** 限制信息在单个时间步长内可以传播的距离。\n$$\n\\Delta t_{\\mathrm{adv}} \\le \\frac{\\Delta x}{|U|} \\quad \\text{where} \\quad \\Delta x = \\frac{W}{N_x-1}\n$$\n- **洛伦兹力阻尼约束：** 强磁场会引入一个刚性阻尼项 $\\sigma B^2 / \\rho$。\n$$\n\\Delta t_{\\mathrm{Lorentz}} \\le \\frac{2\\rho}{\\sigma B^2}\n$$\n- **粘性扩散约束：** 根据最细的网格间距限制时间步长。\n$$\n\\Delta t_{\\mathrm{diff}} \\le \\frac{1}{2\\nu \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y_{\\min}^2}\\right)}\n$$\n项 $\\Delta y_{\\min}$ 代表 $y$ 方向上的最小网格间距，对于均匀网格是 $\\Delta y_{\\mathrm{uni}}$，对于拉伸网格是计算出的 $\\Delta y_{\\min}$。\n\n总体最大稳定时间步长是这三个限制中的最小值：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{Lorentz}})\n$$\n该计算是针对均匀网格和拉伸网格进行的，使用*给定*的点数预算 $N_y$ 来分别求得 $\\Delta t_{\\max}^{\\mathrm{uni}}$ 和 $\\Delta t_{\\max}^{\\mathrm{str}}$。\n\n以下程序实现了这一逻辑，用于计算每个测试用例的八个所需量。\n```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # W, H, rho, nu, sigma, B, U, Nx, Ny, m, beta\n        (0.20, 0.10, 9300, 6.0e-7, 1.0e6, 5.0, 0.10, 64, 300, 10, 3.0),\n        (0.20, 0.10, 9300, 6.0e-7, 1.0e6, 10.0, 0.10, 64, 600, 12, 3.5),\n        (0.20, 0.10, 9300, 6.0e-7, 1.0e6, 0.5, 0.05, 64, 64, 8, 2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_parameters(case)\n        results.append(result)\n\n    inner_strings = []\n    for res_list in results:\n        item_strings = [str(item) for item in res_list]\n        inner_strings.append(f\"[{','.join(item_strings)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\ndef get_delta_y_min_stretched(Ny, H, beta):\n    \"\"\"\n    Calculates the minimum wall-normal grid spacing for a tanh-stretched grid.\n    \"\"\"\n    if Ny  2:\n        return float('inf')\n    \n    xi_1 = -1.0 + 2.0 / (Ny - 1)\n    y_1 = (H / 2.0) * (1.0 + np.tanh(beta * xi_1) / np.tanh(beta))\n    return y_1\n\ndef compute_parameters(params):\n    \"\"\"\n    Computes the eight required quantities for a single test case.\n    \"\"\"\n    W, H, rho, nu, sigma, B, U, Nx, Ny, m, beta = params\n\n    Ha = B * H * np.sqrt(sigma / (rho * nu))\n    delta_H = H / Ha\n    \n    target_dy = delta_H / m\n\n    # Uniform grid resolution check\n    delta_y_uni_given = H / (Ny - 1)\n    resolved_uni = delta_y_uni_given = target_dy\n\n    # Stretched grid resolution check\n    delta_y_min_str_given = get_delta_y_min_stretched(Ny, H, beta)\n    resolved_str = delta_y_min_str_given = target_dy\n\n    # Required Ny for uniform grid\n    Ny_req_uni_float = m * Ha + 1\n    Ny_req_uni = max(3, int(np.ceil(Ny_req_uni_float)))\n\n    # Required Ny for stretched grid (via numerical search)\n    _Ny = 3\n    while get_delta_y_min_stretched(_Ny, H, beta) > target_dy:\n        _Ny += 1\n    Ny_req_str = _Ny\n\n    # Compute maximum stable time step for the given Nx and Ny.\n    dx = W / (Nx - 1)\n    dt_adv = dx / abs(U)\n    \n    if B == 0:\n        dt_lorentz = float('inf')\n    else:\n        dt_lorentz = (2.0 * rho) / (sigma * B**2)\n\n    # Time step for uniform grid\n    dy_min_uni = delta_y_uni_given\n    dt_diff_uni = 1.0 / (2.0 * nu * (1.0/dx**2 + 1.0/dy_min_uni**2))\n    dt_max_uni = min(dt_diff_uni, dt_adv, dt_lorentz)\n\n    # Time step for stretched grid\n    dy_min_str = delta_y_min_str_given\n    dt_diff_str = 1.0 / (2.0 * nu * (1.0/dx**2 + 1.0/dy_min_str**2))\n    dt_max_str = min(dt_diff_str, dt_adv, dt_lorentz)\n\n    return [Ha, delta_H, Ny_req_uni, Ny_req_str, resolved_uni, resolved_str, dt_max_uni, dt_max_str]\n```",
            "answer": "[[6692.730302839955,1.494165181755104e-05,66929,219,False,False,0.000744,0.000744],[13385.46060567991,7.47079083204961e-06,160627,497,False,True,0.000186,0.000186],[669.2730302839955,0.0001494165181755104,5355,107,False,False,0.06349206349206349,0.05773177813411079]]"
        }
    ]
}