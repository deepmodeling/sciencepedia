{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你进入聚变包层环境下磁流体动力学（MHD）的基本物理学。通过进行标度分析，你将比较洛伦兹力与粘性力的大小，从而清晰地理解为什么磁场会如此显著地改变液态金属的流动并抑制湍流。这项技能对于进行量级估算和在深入复杂模拟前理解主导物理效应至关重要。",
            "id": "4055249",
            "problem": "考虑一个 tokamak 中的双冷铅锂增殖毯的直矩形管道段。该管道承载着均匀的共晶铅锂（PbLi）平均流，其特征体速度为 $U$，水力长度尺度为 $L$，电导率为 $\\sigma$，密度为 $\\rho$，运动粘度为 $\\nu$。由环向场线圈施加的强度为 $B$ 的均匀磁场，其方向近似垂直于平均流向。假设适用于液态金属磁流体动力学（MHD）的低磁雷诺数（准静态）极限，因此流体引起的磁感应可以忽略不计，施加的磁场不受流体扰动。\n\n从以下公式出发：\n- 运动导体中的欧姆定律 $\\mathbf{J}=\\sigma\\left(\\mathbf{E}+\\mathbf{U}\\times\\mathbf{B}\\right)$，以及准静态极限下的无散电流约束 $\\nabla\\cdot\\mathbf{J}=0$，和\n- 包含洛伦兹力密度（单位体积）的不可压缩动量平衡方程 $\\rho\\left(\\partial\\mathbf{U}/\\partial t+\\mathbf{U}\\cdot\\nabla\\mathbf{U}\\right)=-\\nabla p+\\mu\\nabla^{2}\\mathbf{U}+\\mathbf{J}\\times\\mathbf{B}$，其中动力粘度为 $\\mu=\\rho\\nu$，\n\n进行尺度分析，估算洛伦兹力密度大小 $f_{L}\\sim\\|\\mathbf{J}\\times\\mathbf{B}\\|$ 和粘性力密度大小 $f_{\\nu}\\sim\\|\\mu\\nabla^{2}\\mathbf{U}\\|$ 的数量级。使用这些量构建无量纲比值 $R=f_{L}/f_{\\nu}$，该比值表明电磁阻尼相对于粘性扩散的主导地位，从而反映磁流体动力学对湍流的抑制程度。\n\n使用以下适用于增殖毯相关操作条件的代表性铅锂（PbLi）和流动参数：\n- 电导率 $\\sigma=8.0\\times 10^{5}$ S/m,\n- 密度 $\\rho=9.4\\times 10^{3}$ kg/m$^{3}$,\n- 运动粘度 $\\nu=1.5\\times 10^{-7}$ m$^{2}$/s,\n- 磁场强度 $B=5.0$ T,\n- 平均速度 $U=0.20$ m/s,\n- 特征长度 $L=0.050$ m.\n\n计算 $R$ 值，并将答案四舍五入至三位有效数字。最终结果以无量纲数表示（无单位）。",
            "solution": "所述问题具有科学依据，提法明确，并包含了解决问题所需的所有信息。这是磁流体动力学（MHD）尺度分析中的一个标准练习，与计算聚变科学领域相关。因此，该问题是有效的。我们开始求解。\n\n目标是求无量纲比值 $R = f_{L}/f_{\\nu}$，其中 $f_{L}$ 是洛伦兹力密度的大小，$f_{\\nu}$ 是粘性力密度的大小。这需要对控制方程中的相关项进行尺度分析。\n\n首先，我们估算洛伦兹力密度的尺度，$f_{L} \\sim \\|\\mathbf{J}\\times\\mathbf{B}\\|$。其大小尺度为 $f_{L} \\sim J B$，其中 $J$ 是电流密度 $\\mathbf{J}$ 的特征大小，$B$ 是施加磁场的强度。为了找到 $J$ 的尺度，我们结合准静态无散电流密度约束 $\\nabla\\cdot\\mathbf{J}=0$，分析运动导体中的欧姆定律 $\\mathbf{J}=\\sigma\\left(\\mathbf{E}+\\mathbf{U}\\times\\mathbf{B}\\right)$。\n\n在准静态极限下，电场是无旋的（$\\nabla\\times\\mathbf{E}=0$），可以表示为一个标量电势 $\\phi$ 的梯度，即 $\\mathbf{E}=-\\nabla\\phi$。将其代入欧姆定律，得到 $\\mathbf{J}=\\sigma\\left(-\\nabla\\phi+\\mathbf{U}\\times\\mathbf{B}\\right)$。\n\n应用散度算子并使用 $\\nabla\\cdot\\mathbf{J}=0$，我们得到：\n$$\n\\nabla\\cdot\\left[\\sigma\\left(-\\nabla\\phi+\\mathbf{U}\\times\\mathbf{B}\\right)\\right] = 0\n$$\n假设电导率 $\\sigma$ 是均匀的，可以将其从散度算子中提出：\n$$\n-\\nabla\\cdot(\\nabla\\phi) + \\nabla\\cdot(\\mathbf{U}\\times\\mathbf{B}) = 0\n$$\n这得到了一个关于电势的泊松方程：\n$$\n\\nabla^{2}\\phi = \\nabla\\cdot(\\mathbf{U}\\times\\mathbf{B})\n$$\n我们现在对此方程进行尺度分析。空间变化的特征长度尺度是 $L$，所以拉普拉斯算子的尺度为 $\\nabla^{2} \\sim 1/L^{2}$，散度算子的尺度为 $\\nabla\\cdot \\sim 1/L$。特征速度是 $U$，磁场强度是 $B$。\n方程的尺度关系变为：\n$$\n\\frac{\\phi}{L^{2}} \\sim \\frac{UB}{L}\n$$\n由此，我们可以推导出电势的特征尺度：\n$$\n\\phi \\sim UBL\n$$\n电场的特征大小则为 $E \\sim |\\nabla\\phi| \\sim \\phi/L$：\n$$\nE \\sim \\frac{UBL}{L} = UB\n$$\n欧姆定律中的 $\\mathbf{U}\\times\\mathbf{B}$ 项的大小尺度为 $UB\\sin\\theta$，其中 $\\theta$ 是 $\\mathbf{U}$ 和 $\\mathbf{B}$ 之间的夹角。由于问题陈述磁场近似垂直于流体，$\\sin\\theta \\approx 1$，因此该项的尺度也为 $UB$。由于欧姆定律括号中的两项 $\\mathbf{E}$ 和 $\\mathbf{U}\\times\\mathbf{B}$ 的尺度都为 $UB$，因此得到的电流密度大小 $J$ 的尺度必须为：\n$$\nJ \\sim \\sigma(E + UB) \\sim \\sigma(UB)\n$$\n现在，我们可以得到洛伦兹力密度的尺度，$f_{L} \\sim J B$：\n$$\nf_{L} \\sim (\\sigma U B) B = \\sigma U B^{2}\n$$\n接下来，我们估算粘性力密度的尺度，$f_{\\nu} \\sim \\|\\mu\\nabla^{2}\\mathbf{U}\\|$。这里，$\\mu$ 是动力粘度，$\\mathbf{U}$ 是速度场，$\\nabla^2$ 是拉普拉斯算子。使用速度的特征尺度 $U$ 和长度的特征尺度 $L$，速度的二阶空间导数尺度为 $U/L^2$。因此，粘性力密度的尺度为：\n$$\nf_{\\nu} \\sim \\mu \\frac{U}{L^{2}}\n$$\n问题给出了运动粘度 $\\nu$ 和密度 $\\rho$。动力粘度通过 $\\mu=\\rho\\nu$ 相关联。代入此关系，我们得到：\n$$\nf_{\\nu} \\sim \\rho\\nu \\frac{U}{L^{2}}\n$$\n现在我们可以构建无量纲比值 $R$：\n$$\nR = \\frac{f_{L}}{f_{\\nu}} \\sim \\frac{\\sigma U B^{2}}{\\rho\\nu U / L^{2}}\n$$\n特征速度 $U$ 被约去，得到 $R$ 的最终符号表达式：\n$$\nR = \\frac{\\sigma B^{2} L^{2}}{\\rho\\nu}\n$$\n这个无量纲量被称为哈特曼数的平方，$R = Ha^{2}$。它代表电磁力与粘性力之比。\n\n最后，我们代入给定的数值来计算 $R$：\n- $\\sigma = 8.0 \\times 10^{5}$ S/m\n- $B = 5.0$ T\n- $L = 0.050$ m\n- $\\rho = 9.4 \\times 10^{3}$ kg/m$^{3}$\n- $\\nu = 1.5 \\times 10^{-7}$ m$^{2}$/s\n\n$$\nR = \\frac{(8.0 \\times 10^{5}) \\cdot (5.0)^{2} \\cdot (0.050)^{2}}{(9.4 \\times 10^{3}) \\cdot (1.5 \\times 10^{-7})}\n$$\n$$\nR = \\frac{(8.0 \\times 10^{5}) \\cdot (25.0) \\cdot (2.5 \\times 10^{-3})}{1.41 \\times 10^{-3}}\n$$\n$$\nR = \\frac{5.0 \\times 10^{4}}{1.41 \\times 10^{-3}}\n$$\n$$\nR \\approx 3.546099 \\times 10^{7}\n$$\n按要求四舍五入到三位有效数字：\n$$\nR \\approx 3.55 \\times 10^{7}\n$$\n$R$ 的巨大数值表明，电磁力远大于粘性力，这对于 tokamak 强磁场中的液态金属流动是典型特征，并导致显著的湍流抑制。",
            "answer": "$$\\boxed{3.55 \\times 10^{7}}$$"
        },
        {
            "introduction": "在标度分析所带来的洞察基础上，本实践将深入推导一个经典的MHD问题——哈特曼流的精确解析解。你将求解动量方程以获得横向磁场下管道内的速度分布，从而揭示其特有的平坦核心区和薄边界层结构。此练习有助于巩固对MHD流动结构的理解，并提供了一个常用于验证数值计算程序的基准解。",
            "id": "4055259",
            "problem": "一种代表增殖包层的液态金属冷却剂（共晶铅锂）稳定地流过一个长矩形管道段。该管道在 $z$ 方向上的高度为 $2a$，在 $y$ 方向上的宽度非常大（因此可以忽略侧壁效应）。流动由均匀的轴向压力梯度 $\\partial p/\\partial x$ 驱动，并受到聚变装置产生的沿 $z$ 方向大小为 $B$ 的均匀横向磁场的作用。假设流动处于磁流体动力学（MHD）的准静态极限下，为不可压缩层流、充分发展状态，并在 $z=\\pm a$ 处有无滑移的电绝缘 Hartmann 壁。流体的密度为 $\\rho$，运动粘度为 $\\nu$，电导率为 $\\sigma$。Hartmann 数定义为 $Ha = B a \\sqrt{\\sigma/(\\rho \\nu)}$。\n\n仅使用包含洛伦兹体积力的基本动量方程和移动导体的欧姆定律，推导轴向速度场 $u(z)$，然后计算核心区与 Hartmann 边界层所承载的体积流量分数。其中，核心区定义为中心区域 $|z| \\le a - \\delta_H$，Hartmann 边界层是紧邻每个 Hartmann 壁的两个厚度为 $\\delta_H$ 的区域，且 $\\delta_H = a/Ha$。在 $Ha=100$ 时评估你最终的分数。将这两个比例表示为一个行向量 $(\\text{核心区}, \\text{边界层})$，形式为无量纲小数。将你的答案四舍五入至六位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 流体：液态金属冷却剂（共晶铅锂）。\n- 流动条件：稳定、不可压缩、层流、充分发展。\n- 管道几何形状：矩形，在 $z$ 方向高度为 $2a$，在 $y$ 方向宽度非常大（侧壁效应可忽略）。\n- 壁面：在 $z=\\pm a$ 处的电绝缘 Hartmann 壁，满足无滑移条件。\n- 驱动力：均匀的轴向压力梯度 $\\partial p/\\partial x$。\n- 外部场：沿 $z$ 方向大小为 $B$ 的均匀横向磁场 $\\mathbf{B}$。\n- 控制物理学：磁流体动力学（MHD）的准静态极限。\n- 流体性质：密度 $\\rho$，运动粘度 $\\nu$，电导率 $\\sigma$。\n- 定义：Hartmann 数 $Ha = B a \\sqrt{\\sigma/(\\rho\\nu)}$。\n- 任务：从基本方程推导轴向速度 $u(z)$。计算核心区（$|z| \\le a - \\delta_H$）和 Hartmann 边界层（厚度 $\\delta_H = a/Ha$）的体积流量分数。在 $Ha=100$ 时评估分数，并四舍五入至六位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了 Hartmann 流动，这是磁流体动力学中的一个典型问题，它已经非常成熟，并基于流体动力学和电磁学的基本原理。准静态近似是磁雷诺数很小的液态金属流动的标准做法。该设置对于聚变包层概念是物理上现实的。\n- **适定性**：该问题提供了推导速度剖面和后续流量分数的唯一解所需的所有必要信息（控制方程、几何形状、边界条件、流体性质）。\n- **客观性**：语言精确且量化。所有术语在磁流体动力学领域都是标准术语。\n\n### 第 3 步：结论与行动\n该问题是有效的，因为它科学上合理、适定且客观。它代表了计算聚变科学与工程中的一个标准推导。将提供一个解。\n\n### 速度剖面推导\n流动由稳定、不可压缩流体的动量方程（包括洛伦兹力）和欧姆定律控制。动量方程（Navier-Stokes 方程）为：\n$$\n\\rho (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{J} \\times \\mathbf{B}\n$$\n其中 $\\mathbf{u}$ 是速度矢量，$p$ 是压力，$\\mu = \\rho\\nu$ 是动力粘度，$\\mathbf{J}$ 是电流密度。\n\n流动是稳态的（$\\partial/\\partial t = 0$）且充分发展的，这意味着速度剖面不依赖于轴向坐标 $x$。根据几何形状，速度仅在 $x$ 方向，并且仅随 $z$ 变化：$\\mathbf{u} = u(z) \\mathbf{\\hat{x}}$。不可压缩性条件 $\\nabla \\cdot \\mathbf{u} = 0$ 因 $\\partial u/\\partial x = 0$ 而自动满足。对流加速度项 $(\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = (u(z)\\partial/\\partial x) (u(z)\\mathbf{\\hat{x}}) = 0$。侧壁效应可忽略，因此我们假设所有物理量对 $y$ 的偏导数均为零 $\\partial/\\partial y = 0$。\n\n动量方程简化。对于 $x$ 分量：\n$$\n0 = -\\frac{\\partial p}{\\partial x} + \\mu \\frac{d^2 u}{d z^2} + (\\mathbf{J} \\times \\mathbf{B})_x\n$$\n压力梯度 $\\partial p/\\partial x$ 是一个给定的均匀常数。我们定义 $G = -\\partial p/\\partial x$。\n\n为了求出洛伦兹力 $\\mathbf{J} \\times \\mathbf{B}$，我们首先需要从准静态极限下的欧姆定律得到电流密度 $\\mathbf{J}$：\n$$\n\\mathbf{J} = \\sigma (\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B})\n$$\n磁场为 $\\mathbf{B} = B \\mathbf{\\hat{z}}$。动生电动势为 $\\mathbf{u} \\times \\mathbf{B} = (u(z)\\mathbf{\\hat{x}}) \\times (B\\mathbf{\\hat{z}}) = -u(z) B \\mathbf{\\hat{y}}$。\n\n对于电场 $\\mathbf{E}$，我们使用麦克斯韦方程组。根据稳态下的法拉第定律，$\\nabla \\times \\mathbf{E} = 0$，这意味着对于某个电势 $\\phi$，有 $\\mathbf{E} = -\\nabla \\phi$。根据电荷守恒，$\\nabla \\cdot \\mathbf{J} = 0$。将欧姆定律代入此式，得到 $\\sigma \\nabla \\cdot (\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B}) = 0$，这导致 $\\nabla^2\\phi = \\nabla \\cdot (\\mathbf{u} \\times \\mathbf{B})$。\n$$\n\\nabla \\cdot (\\mathbf{u} \\times \\mathbf{B}) = \\frac{\\partial}{\\partial y}(-u(z)B) = 0\n$$\n因此，我们必须求解电势的拉普拉斯方程 $\\nabla^2 \\phi = 0$。由于 $\\partial/\\partial x = \\partial/\\partial y = 0$，该方程变为 $d^2\\phi/dz^2 = 0$，所以 $\\phi(z) = C_1 z + C_2$。在 $z=\\pm a$ 处的壁面是电绝缘的，这意味着电流的法向分量 $J_z$ 在壁面必须为零。\n$$\nJ_z = \\sigma (E_z + (\\mathbf{u} \\times \\mathbf{B})_z) = \\sigma E_z = -\\sigma \\frac{d\\phi}{dz} = -\\sigma C_1\n$$\n条件 $J_z(\\pm a)=0$ 要求 $C_1=0$。这意味着 $\\phi$ 是一个常数，因此电场 $\\mathbf{E} = -\\nabla \\phi = 0$。这个条件对应于横向（$y$ 方向）的开路，这对于无限宽的管道是合适的。\n\n当 $\\mathbf{E}=0$ 时，欧姆定律简化为 $\\mathbf{J} = \\sigma (\\mathbf{u} \\times \\mathbf{B}) = -\\sigma u(z) B \\mathbf{\\hat{y}}$。于是洛伦兹力为：\n$$\n\\mathbf{J} \\times \\mathbf{B} = (-\\sigma u(z) B \\mathbf{\\hat{y}}) \\times (B\\mathbf{\\hat{z}}) = -\\sigma B^2 u(z) \\mathbf{\\hat{x}}\n$$\n将此代入 $x$ 方向的动量方程：\n$$\n0 = G + \\mu \\frac{d^2 u}{d z^2} - \\sigma B^2 u(z)\n$$\n重新整理得到 $u(z)$ 的控制常微分方程：\n$$\n\\frac{d^2 u}{d z^2} - \\frac{\\sigma B^2}{\\mu} u(z) = -\\frac{G}{\\mu}\n$$\n使用定义 $\\mu = \\rho\\nu$ 和 Hartmann 数 $Ha = B a \\sqrt{\\sigma/(\\rho\\nu)} = B a \\sqrt{\\sigma/\\mu}$，我们可以将系数写为 $\\frac{\\sigma B^2}{\\mu} = \\frac{Ha^2}{a^2}$。常微分方程变为：\n$$\n\\frac{d^2 u}{d z^2} - \\frac{Ha^2}{a^2} u(z) = -\\frac{G}{\\mu}\n$$\n通解是齐次解 $u_h$ 和特解 $u_p$ 的和。齐次方程是 $u_h'' - (Ha/a)^2 u_h = 0$，其解为 $u_h(z) = C_1 \\cosh(Ha \\cdot z/a) + C_2 \\sinh(Ha \\cdot z/a)$。特解是一个常数，$u_p = (G/\\mu) / (Ha^2/a^2) = Ga^2/(\\mu Ha^2) = G/(\\sigma B^2)$。\n完整解为 $u(z) = C_1 \\cosh(Ha \\cdot z/a) + C_2 \\sinh(Ha \\cdot z/a) + G/(\\sigma B^2)$。\n边界条件是壁面无滑移：$u(a)=0$ 和 $u(-a)=0$。流动关于 $z=0$ 对称，因此 $u(z)=u(-z)$，这要求 $C_2=0$。应用 $u(a)=0$：\n$$\n0 = C_1 \\cosh(Ha) + \\frac{G}{\\sigma B^2} \\implies C_1 = -\\frac{G}{\\sigma B^2 \\cosh(Ha)}\n$$\n代入 $C_1$ 得到最终的速度剖面：\n$$\nu(z) = \\frac{G}{\\sigma B^2} \\left(1 - \\frac{\\cosh(Ha \\cdot z/a)}{\\cosh(Ha)}\\right)\n$$\n\n### 体积流量分数的计算\n单位宽度的总体积流量 $Q_{tot}$ 是 $u(z)$ 从 $z=-a$ 到 $z=a$ 的积分：\n$$\nQ_{tot} = \\int_{-a}^{a} u(z) dz = \\frac{G}{\\sigma B^2} \\int_{-a}^{a} \\left(1 - \\frac{\\cosh(Ha \\cdot z/a)}{\\cosh(Ha)}\\right) dz\n$$\n$$\nQ_{tot} = \\frac{G}{\\sigma B^2} \\left[ z - \\frac{a}{Ha \\cosh(Ha)} \\sinh\\left(\\frac{Ha \\cdot z}{a}\\right) \\right]_{-a}^{a} = \\frac{G}{\\sigma B^2} \\left( 2a - \\frac{2a}{Ha} \\frac{\\sinh(Ha)}{\\cosh(Ha)} \\right)\n$$\n$$\nQ_{tot} = \\frac{2aG}{\\sigma B^2} \\left( 1 - \\frac{\\tanh(Ha)}{Ha} \\right)\n$$\n核心区由 $|z| \\le a - \\delta_H = a(1-1/Ha)$ 定义。核心区的体积流量 $Q_{core}$ 为：\n$$\nQ_{core} = \\int_{-a(1-1/Ha)}^{a(1-1/Ha)} u(z) dz = 2 \\int_{0}^{a(1-1/Ha)} u(z) dz\n$$\n$$\nQ_{core} = 2 \\frac{G}{\\sigma B^2} \\left[ z - \\frac{a}{Ha \\cosh(Ha)} \\sinh\\left(\\frac{Ha \\cdot z}{a}\\right) \\right]_{0}^{a(1-1/Ha)}\n$$\n$$\nQ_{core} = \\frac{2G}{\\sigma B^2} \\left( a\\left(1-\\frac{1}{Ha}\\right) - \\frac{a}{Ha \\cosh(Ha)} \\sinh\\left(Ha\\left(1-\\frac{1}{Ha}\\right)\\right) \\right)\n$$\n$$\nQ_{core} = \\frac{2aG}{\\sigma B^2} \\left( 1 - \\frac{1}{Ha} - \\frac{\\sinh(Ha - 1)}{Ha \\cosh(Ha)} \\right)\n$$\n核心区的流量分数 $f_{core}$ 是 $Q_{core}/Q_{tot}$ 的比值：\n$$\nf_{core} = \\frac{1 - \\frac{1}{Ha} - \\frac{\\sinh(Ha-1)}{Ha \\cosh(Ha)}}{1 - \\frac{\\tanh(Ha)}{Ha}} = \\frac{Ha - 1 - \\frac{\\sinh(Ha-1)}{\\cosh(Ha)}}{Ha - \\tanh(Ha)}\n$$\nHartmann 边界层中的流量分数 $f_{BL}$ 就是 $1 - f_{core}$。\n\n### 在 $Ha=100$ 时的评估\n我们现在评估 $Ha=100$ 时的分数。\n$$\nf_{core} = \\frac{100 - 1 - \\frac{\\sinh(99)}{\\cosh(100)}}{100 - \\tanh(100)}\n$$\n对于 $Ha=100$，$\\tanh(100)$ 极度接近 1，双曲函数的值非常大。使用高精度计算：\n$\\tanh(100) \\approx 1.0$\n$\\cosh(100) \\approx 1.3444... \\times 10^{43}$\n$\\sinh(99) \\approx 4.9458... \\times 10^{42}$\n分数 $\\sinh(99)/\\cosh(100) \\approx e^{-1} \\approx 0.367879$。\n我们计算这些值：\n$$\nf_{core} \\approx 0.996284046\n$$\n$$\nf_{BL} = 1 - f_{core} \\approx 1 - 0.996284046 = 0.003715954\n$$\n将这两个值四舍五入到六位有效数字，得到：\n$f_{core} \\approx 0.996284$\n$f_{BL} \\approx 0.00371595$\n结果应表示为行向量 $(\\text{核心区}, \\text{边界层})$。",
            "answer": "$$\n\\boxed{(0.996284, 0.00371595)}\n$$"
        },
        {
            "introduction": "最后的这项实践将在解析理论与计算实践之间架起一座桥梁，这是计算科学家的核心技能。你将应对为MHD管道流建立数值模拟的实际挑战，重点关注捕捉薄哈特曼层所需的网格分辨率，以及显式数值格式对时间步长的稳定性约束。此练习展示了像哈特曼数这样的理论参数如何直接指导计算模型的设计和可行性分析。",
            "id": "4055210",
            "problem": "一个宽度为 $W$、高度为 $H$ 的二维矩形管道，在沿 $y$ 轴方向、大小为 $B$ 的均匀磁场作用下，承载着增殖包层中的不可压缩导电液态金属。流动主要沿 $x$ 轴方向，特征流向速度为 $U$。流体性质为质量密度 $\\rho$、运动粘度 $\\nu$ 和电导率 $\\sigma$。该流动处于低磁雷诺数区，因此准静态磁流体动力学 (MHD) 假设适用。在此假设下，控制方程为质量守恒、动量守恒和运动介质的欧姆定律。具体来说，质量守恒方程为 $\\nabla \\cdot \\mathbf{u} = 0$，动量守恒方程为 $\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u} \\right) = -\\nabla p + \\rho \\nu \\nabla^2 \\mathbf{u} + \\sigma \\left( -\\nabla \\phi + \\mathbf{u} \\times \\mathbf{B} \\right) \\times \\mathbf{B}$，欧姆定律为 $\\mathbf{J} = \\sigma \\left( -\\nabla \\phi + \\mathbf{u} \\times \\mathbf{B} \\right)$，其中电势 $\\phi$ 由 $\\nabla \\cdot \\mathbf{J} = 0$ 确定。\n\n在这种管道流中，薄的 Hartmann 层在壁面附近形成，这些壁面的法线与磁场方向一致。Hartmann 数 $\\mathrm{Ha}$ 定义为 $\\mathrm{Ha} = B H \\sqrt{\\frac{\\sigma}{\\rho \\nu}}$，Hartmann 层厚度的尺度为 $\\delta_H \\sim \\frac{H}{\\mathrm{Ha}}$，这是通过平衡边界层内的粘性扩散和洛伦兹力得到的。\n\n您的任务是为二维横截面建立一个能够解析近 $y=0$ 和 $y=H$ 壁面的 Hartmann 层的数值有限差分格式。为确保足够的解析度，要求在 Hartmann 层厚度 $\\delta_H$ 内至少有 $m$ 个网格点。对于 $y$ 方向的均匀网格，近壁间距为 $\\Delta y_{\\mathrm{uni}} = \\frac{H}{N_y-1}$。对于非均匀、壁面加密的网格，使用双曲正切映射将网格点放置在 $y_j = \\frac{H}{2}\\left(1 + \\frac{\\tanh\\left(\\beta \\xi_j\\right)}{\\tanh \\beta}\\right)$，其中 $\\xi_j = -1 + \\frac{2 j}{N_y-1}$（$j=0,1,\\dots,N_y-1$），并且 $\\beta>0$ 控制加密程度。拉伸网格的最小近壁间距为 $\\Delta y_{\\min} = \\min_j \\left(y_{j+1} - y_j\\right)$。\n\n假设采用标准的显式时间积分，扩散项采用中心差分，对流项采用一阶迎风格式。根据 von Neumann 稳定性分析，施加以下稳定性约束：\n\n- 二维粘性扩散稳定性：\n$$\\Delta t \\le \\frac{1}{2 \\nu} \\cdot \\frac{1}{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y_{\\min}^2}},$$\n其中 $\\Delta x = \\frac{W}{N_x-1}$，$\\Delta y_{\\min}$ 是 $y$ 方向的最小网格间距。\n\n- 基于流向对流的 Courant–Friedrichs–Lewy (CFL) 条件：\n$$\\Delta t \\le \\frac{\\Delta x}{|U|},$$\n需要理解的是，在充分发展的横截面中横向对流可以忽略，且 $U$ 是特征流向速度。\n\n- 洛伦兹力引起的线性阻尼的显式稳定性，该阻尼被建模为系数为 $\\alpha = \\frac{\\sigma B^2}{\\rho}$ 的等效线性汇项：\n$$\\Delta t \\le \\frac{2}{\\alpha} = \\frac{2 \\rho}{\\sigma B^2}.$$\n\n将最大稳定时间步长定义为 $\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{Lorentz}}\\right)$。\n\n编写一个完整的、可运行的程序，对下面的每个测试用例执行以下计算：\n\n1. 计算 Hartmann 数 $\\mathrm{Ha}$ 和 Hartmann 层厚度 $\\delta_H$。\n2. 给定 $y$ 方向的点数预算 $N_y$，判断 Hartmann 层是否被以下网格解析：\n   - 均匀网格：$\\Delta y_{\\mathrm{uni}} \\le \\delta_H/m$，\n   - 使用 tanh 映射的拉伸网格：$\\Delta y_{\\min} \\le \\delta_H/m$。\n3. 计算解析 Hartmann 层所需的最小 $N_y$：\n   - 均匀网格：满足 $\\frac{H}{N_y-1} \\le \\frac{\\delta_H}{m}$ 的最小整数 $N_y \\ge 3$，\n   - 拉伸网格（对于给定的 $\\beta$）：使 tanh 映射网格满足 $\\Delta y_{\\min} \\le \\frac{\\delta_H}{m}$ 的最小整数 $N_y \\ge 3$。\n4. 使用给定的 $N_x$ 和 $N_y$ 预算，分别为均匀网格和拉伸网格计算 $\\Delta t_{\\max}$。\n\n所有时间步长值以秒为单位表示。每个测试用例返回一个包含八个条目的列表：\n- $[\\mathrm{Ha}, \\delta_H, N_{y,\\mathrm{req}}^{\\mathrm{uni}}, N_{y,\\mathrm{req}}^{\\mathrm{str}}, \\mathrm{resolved}_{\\mathrm{uni}}, \\mathrm{resolved}_{\\mathrm{str}}, \\Delta t_{\\max}^{\\mathrm{uni}}, \\Delta t_{\\max}^{\\mathrm{str}}]$,\n其中 $\\mathrm{resolved}_{\\mathrm{uni}}$ 和 $\\mathrm{resolved}_{\\mathrm{str}}$ 是表示在给定 $N_y$ 预算下是否达到解析度的布尔值。\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为以逗号分隔的八元素列表组成的列表，并用方括号括起来（例如：\"[[...],[...],[...]]\"）。\n\n使用以下具有科学真实性参数的测试套件。所有量均采用国际单位制（SI units）。确保所有输出（如适用）以秒为单位。\n\n- 测试用例 1 (强磁场下典型的聚变包层流动):\n  - $W = 0.20$, $H = 0.10$, $\\rho = 9300$, $\\nu = 6.0\\times 10^{-7}$, $\\sigma = 1.0\\times 10^{6}$, $B = 5.0$, $U = 0.10$, $N_x = 64$, $N_y = 300$, $m = 10$, $\\beta = 3.0$。\n- 测试用例 2 (非常强的磁场，更紧凑的 Hartmann 层):\n  - $W = 0.20$, $H = 0.10$, $\\rho = 9300$, $\\nu = 6.0\\times 10^{-7}$, $\\sigma = 1.0\\times 10^{6}$, $B = 10.0$, $U = 0.10$, $N_x = 64$, $N_y = 600$, $m = 12$, $\\beta = 3.5$。\n- 测试用例 3 (较弱的磁场，较厚的 Hartmann 层):\n  - $W = 0.20$, $H = 0.10$, $\\rho = 9300$, $\\nu = 6.0\\times 10^{-7}$, $\\sigma = 1.0\\times 10^{6}$, $B = 0.5$, $U = 0.05$, $N_x = 64$, $N_y = 64$, $m = 8$, $\\beta = 2.0$。\n\n所有布尔值应以其编程语言原生的字面量打印。所有整数和浮点数应以数值形式打印。单行输出必须按所述方式汇总三个测试用例的结果。",
            "solution": "用户提供了一个在计算磁流体动力学（MHD）领域内与聚变反应堆增殖包层设计相关的明确问题。任务是为强磁场下矩形管道中液态金属流动的有限差分模拟计算关键的数值参数。这些参数包括 Hartmann 数（$\\mathrm{Ha}$）、Hartmann 边界层的厚度（$\\delta_H$）、解析这些层所需的网格点数（$N_y$），以及显式时间积分方案的最大稳定时间步长（$\\Delta t_{\\max}$）。计算需要分别针对均匀网格和壁面加密（拉伸）网格进行。\n\n该问题在科学上和数学上是合理的，提供了所有必需的物理参数、控制方程和数值公式。验证过程证实了其完整性、一致性和客观性。因此，我们可以着手进行系统性的、基于原理的求解。\n\n解决方案的结构如下：\n1.  计算特征无量纲数（$\\mathrm{Ha}$）及相关的边界层厚度（$\\delta_H$）。\n2.  确定网格解析度要求并评估给定的网格预算。这涉及计算均匀网格和拉伸网格的最小网格间距。\n3.  计算满足两种网格类型解析度标准所需的最小网格点数（$N_y$）。\n4.  评估由粘性扩散、对流（CFL 条件）和洛伦兹力阻尼项引起的显式时间步长稳定性约束。\n\n**1. 物理和数值参数**\n\n流动状态由 Hartmann 数 $\\mathrm{Ha}$ 表征，它代表电磁力与粘性力之比。其定义为：\n$$\n\\mathrm{Ha} = B H \\sqrt{\\frac{\\sigma}{\\rho \\nu}}\n$$\n其中 $B$ 是磁场强度，$H$ 是管道高度，$\\sigma$ 是电导率，$\\rho$ 是质量密度，$\\nu$ 是运动粘度。\n\n在此流动中，被称为 Hartmann 层的薄边界层在垂直于磁场的壁面（位于 $y=0$ 和 $y=H$ 的“Hartmann 壁”）上形成。这些层的厚度 $\\delta_H$ 与 Hartmann 数成反比：\n$$\n\\delta_H = \\frac{H}{\\mathrm{Ha}}\n$$\n为了数值上解析这些薄层，近壁处的网格间距必须足够小。问题规定在一个层厚度内至少需要 $m$ 个网格点，这转化为最大允许的近壁网格间距为 $\\Delta y_{\\text{target}} = \\delta_H / m$。\n\n**2. 网格解析度与要求**\n\n我们分析 $y$ 方向的两种网格类型。\n\n**均匀网格：**\n对于具有 $N_y$ 个点的均匀网格，间距是恒定的：\n$$\n\\Delta y_{\\mathrm{uni}} = \\frac{H}{N_y-1}\n$$\n如果 $\\Delta y_{\\mathrm{uni}} \\le \\delta_H/m$，则满足解析度要求。所需的最小点数 $N_{y,\\mathrm{req}}^{\\mathrm{uni}}$ 通过解关于 $N_y$ 的不等式得到：\n$$\n\\frac{H}{N_y-1} \\le \\frac{H / \\mathrm{Ha}}{m} \\implies N_y-1 \\ge m \\cdot \\mathrm{Ha} \\implies N_y \\ge m \\cdot \\mathrm{Ha} + 1\n$$\n由于 $N_y$ 必须是整数且至少为 3，所需的点数为 $N_{y,\\mathrm{req}}^{\\mathrm{uni}} = \\max(3, \\lceil m \\cdot \\mathrm{Ha} + 1 \\rceil)$。\n\n**拉伸网格：**\n使用双曲正切映射将点聚集在壁面附近。网格点 $y_j$ 由下式给出：\n$$\ny_j = \\frac{H}{2}\\left(1 + \\frac{\\tanh(\\beta \\xi_j)}{\\tanh \\beta}\\right) \\quad \\text{其中} \\quad \\xi_j = -1 + \\frac{2j}{N_y-1} \\quad \\text{对于 } j=0, \\dots, N_y-1\n$$\n网格间距在壁面处（$\\xi = \\pm 1$）最密，在中心处（$\\xi = 0$）最疏。最小间距 $\\Delta y_{\\min}$ 出现在第一个区间，$\\Delta y_{\\min} = y_1 - y_0$。由于 $y_0 = 0$，我们有：\n$$\n\\Delta y_{\\min} = y_1 = \\frac{H}{2}\\left(1 + \\frac{\\tanh\\left(\\beta \\left(-1 + \\frac{2}{N_y-1}\\right)\\right)}{\\tanh \\beta}\\right)\n$$\n如果此 $\\Delta y_{\\min} \\le \\delta_H/m$，则满足解析度要求。\n为找到所需的点数 $N_{y,\\mathrm{req}}^{\\mathrm{str}}$，我们必须找到满足此非线性不等式的最小整数 $N_y \\ge 3$。最可靠的方法是使用数值搜索，从 $N_y=3$ 开始，不断递增直到满足条件。\n\n**3. 显式时间步长稳定性**\n\n显式格式的最大稳定时间步长 $\\Delta t_{\\max}$ 受三个物理过程的限制：\n\n- **对流（CFL）约束：** 限制信息在单个时间步长内可以传播的距离。\n$$\n\\Delta t_{\\mathrm{adv}} \\le \\frac{\\Delta x}{|U|} \\quad \\text{其中} \\quad \\Delta x = \\frac{W}{N_x-1}\n$$\n- **洛伦兹力阻尼约束：** 强磁场会引入一个刚性阻尼项 $\\sigma B^2 / \\rho$。\n$$\n\\Delta t_{\\mathrm{Lorentz}} \\le \\frac{2\\rho}{\\sigma B^2}\n$$\n- **粘性扩散约束：** 根据最细的网格间距限制时间步长。\n$$\n\\Delta t_{\\mathrm{diff}} \\le \\frac{1}{2\\nu \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y_{\\min}^2}\\right)}\n$$\n项 $\\Delta y_{\\min}$ 代表 $y$ 方向上的最小网格间距，对于均匀网格是 $\\Delta y_{\\mathrm{uni}}$，对于拉伸网格是计算出的 $\\Delta y_{\\min}$。\n\n总的最大稳定时间步长是这三个限制中的最小值：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{Lorentz}})\n$$\n此计算是使用*给定*的点数预算 $N_y$ 对均匀网格和拉伸网格分别进行的，以求得 $\\Delta t_{\\max}^{\\mathrm{uni}}$ 和 $\\Delta t_{\\max}^{\\mathrm{str}}$。\n\n下面的程序实现了这一逻辑，以计算每个测试用例所需的八个量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # W, H, rho, nu, sigma, B, U, Nx, Ny, m, beta\n        (0.20, 0.10, 9300, 6.0e-7, 1.0e6, 5.0, 0.10, 64, 300, 10, 3.0),\n        (0.20, 0.10, 9300, 6.0e-7, 1.0e6, 10.0, 0.10, 64, 600, 12, 3.5),\n        (0.20, 0.10, 9300, 6.0e-7, 1.0e6, 0.5, 0.05, 64, 64, 8, 2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_parameters(case)\n        results.append(result)\n\n    # Format the final output string to match the problem specification exactly.\n    # E.g.: \"[[val1,val2,...],[val1,val2,...]]\"\n    inner_strings = []\n    for res_list in results:\n        # str() correctly formats numbers and booleans as required language literals.\n        item_strings = [str(item) for item in res_list]\n        inner_strings.append(f\"[{','.join(item_strings)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\ndef get_delta_y_min_stretched(Ny, H, beta):\n    \"\"\"\n    Calculates the minimum wall-normal grid spacing for a tanh-stretched grid.\n    \"\"\"\n    if Ny  2:\n        return float('inf')\n    \n    # Grid points are defined by y_j(xi_j), where xi_j = -1 + 2*j/(Ny-1).\n    # The minimum spacing is y_1 - y_0.\n    # At j=0, xi_0 = -1, y_0 = H/2 * (1 + tanh(-beta)/tanh(beta)) = 0.\n    # At j=1, xi_1 = -1 + 2/(Ny-1).\n    xi_1 = -1.0 + 2.0 / (Ny - 1)\n    \n    # The formula is y_1 = H/2 * (1 + tanh(beta * xi_1) / tanh(beta)).\n    # This also corresponds to the minimum spacing since y_0 = 0.\n    y_1 = (H / 2.0) * (1.0 + np.tanh(beta * xi_1) / np.tanh(beta))\n    return y_1\n\ndef compute_parameters(params):\n    \"\"\"\n    Computes the eight required quantities for a single test case.\n    \"\"\"\n    W, H, rho, nu, sigma, B, U, Nx, Ny, m, beta = params\n\n    # 1. Compute Hartmann number (Ha) and Hartmann layer thickness (delta_H).\n    Ha = B * H * np.sqrt(sigma / (rho * nu))\n    delta_H = H / Ha\n    \n    target_dy = delta_H / m\n\n    # 2. Check resolution for the given Ny budget.\n    # Uniform grid resolution check\n    delta_y_uni_given = H / (Ny - 1)\n    resolved_uni = delta_y_uni_given = target_dy\n\n    # Stretched grid resolution check\n    delta_y_min_str_given = get_delta_y_min_stretched(Ny, H, beta)\n    resolved_str = delta_y_min_str_given = target_dy\n\n    # 3. Compute minimal Ny required for resolution.\n    # Required Ny for uniform grid\n    Ny_req_uni_float = m * Ha + 1\n    Ny_req_uni = max(3, int(np.ceil(Ny_req_uni_float)))\n\n    # Required Ny for stretched grid (via numerical search)\n    _Ny = 3\n    while get_delta_y_min_stretched(_Ny, H, beta) > target_dy:\n        _Ny += 1\n    Ny_req_str = _Ny\n\n    # 4. Compute maximum stable time step for the given Nx and Ny.\n    dx = W / (Nx - 1)\n    dt_adv = dx / abs(U)\n    \n    # Handle the case of no magnetic field to avoid division by zero.\n    if B == 0:\n        dt_lorentz = float('inf')\n    else:\n        dt_lorentz = (2.0 * rho) / (sigma * B**2)\n\n    # Time step for uniform grid\n    dy_min_uni = delta_y_uni_given\n    dt_diff_uni = 1.0 / (2.0 * nu * (1.0/dx**2 + 1.0/dy_min_uni**2))\n    dt_max_uni = min(dt_diff_uni, dt_adv, dt_lorentz)\n\n    # Time step for stretched grid\n    dy_min_str = delta_y_min_str_given\n    dt_diff_str = 1.0 / (2.0 * nu * (1.0/dx**2 + 1.0/dy_min_str**2))\n    dt_max_str = min(dt_diff_str, dt_adv, dt_lorentz)\n\n    return [Ha, delta_H, Ny_req_uni, Ny_req_str, resolved_uni, resolved_str, dt_max_uni, dt_max_str]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}