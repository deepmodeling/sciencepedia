## 引言
[中子输运方程](@entry_id:1128709)是核科学与工程领域的基石，它精确地描述了中子在介质中的迁移、散射和吸收行为。无论是在设计未来[聚变能](@entry_id:138601)源系统的包层，还是在确保现有裂变反应堆的安全运行，精确求解该方程都是不可或缺的核心任务。然而，由于其在相空间（位置、能量、角度）上的复杂性，中子输运方程极少有解析解，这便构成了理论与实践之间的关键鸿沟：我们必须依赖强大而可靠的数值方法来揭示中子场的秘密。本文旨在系统地介绍求解[中子输运方程](@entry_id:1128709)的主流理论与方法，填补这一知识空白。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。首先，在“原理与机制”一章中，我们将深入剖析中子输运方程的物理内涵，并详细阐述两种主要的数值求解策略——确定论的[离散纵标法](@entry_id:1123828)和[统计模拟](@entry_id:169458)的蒙特卡洛法。随后，在“应用与交叉学科联系”一章中，我们将展示这些理论和方法如何应用于解决聚变堆与裂变堆设计中的关键问题，例如[氚增殖比](@entry_id:756178)计算、燃料燃耗模拟和诊断数据解读。最后，“动手实践”部分将提供具体的编程练习，帮助读者将理论知识转化为实际的计算能力。让我们从理解[输运现象](@entry_id:147655)的基本原理开始。

## 原理与机制

本章深入探讨中子输运理论的核心原理和求解[中子输运方程](@entry_id:1128709)的关键机制。我们将从描述中子场的物理量开始，构建玻尔兹曼[中子输运方程](@entry_id:1128709)，并详细阐述方程中各个项的物理意义。随后，我们将探讨求解该方程所需的边界条件和材料特性（[截面](@entry_id:154995)）。最后，我们将介绍两种主流的数值求解方法——确定论方法（[离散纵标法](@entry_id:1123828)）和[统计模拟](@entry_id:169458)方法（蒙特卡洛法），并讨论它们各自的特点、挑战以及一些高级应用，如伴随方法。

### 输运理论的基本物理量

为了精确描述中子在介质中的行为，我们必须引入一套描述其在相空间（位置、方向、能量）中分布和运动的物理量。相空间是理解[输运现象](@entry_id:147655)的基础。

中子场的基本描述始于**角中子[数密度](@entry_id:895657)** $n(\vec{r},\vec{\Omega},E)$，它表示在位置 $\vec{r}$ 附近、能量 $E$ 附近、沿方向 $\vec{\Omega}$ 附近的单位体积、单位立体角、单位能量内的中子数目。其单位通常为 $\mathrm{n}\cdot\mathrm{cm}^{-3}\cdot\mathrm{sr}^{-1}\cdot\mathrm{eV}^{-1}$。然而，[数密度](@entry_id:895657)本身并不直接反映中子的运动。为了描述中子的流动，我们引入了**角通量密度**（或简称**角通量**） $\psi(\vec{r},\vec{\Omega},E)$。

角通量 $\psi$ 定义为角中子[数密度](@entry_id:895657) $n$ 与中子速率 $v(E)$ 的乘积：
$$
\psi(\vec{r},\vec{\Omega},E) = v(E) \, n(\vec{r},\vec{\Omega},E)
$$
角通量的物理意义是：在位置 $\vec{r}$ 处，单位时间内穿过一个垂直于方向 $\vec{\Omega}$ 的单位面积、能量在 $E$ 附近、运动方向在 $\vec{\Omega}$ 附近的单位[立体角](@entry_id:154756)内的中子数目。因此，它的单位是 $\mathrm{n}\cdot\mathrm{cm}^{-2}\cdot\mathrm{s}^{-1}\cdot\mathrm{sr}^{-1}\cdot\mathrm{eV}^{-1}$。角通量是[中子输运](@entry_id:159564)理论中的核心待求量，因为它直接关系到核反应率。

从角通量可以导出两个重要的积分量 ：

1.  **标通量密度**（或简称**标通量**） $\phi(\vec{r},E)$，定义为角通量对所有方向的积分：
    $$
    \phi(\vec{r},E) = \int_{4\pi} \psi(\vec{r},\vec{\Omega},E) \, d\Omega
    $$
    标通量的单位是 $\mathrm{n}\cdot\mathrm{cm}^{-2}\cdot\mathrm{s}^{-1}\cdot\mathrm{eV}^{-1}$。它代表在位置 $\vec{r}$ 处，单位时间内穿过一个任意朝向的单位面积球体的总中子数。一个等价且非常有用的解释是，标通量是在 $\vec{r}$ 处的单位体积内，所有能量为 $E$ 的中子在单位时间内走过的总路程长度。这个解释使得标通量与反应率的联系非常直观：反应率密度（单位体积、单位时间内的反应次数）等于[宏观截面](@entry_id:1127564) $\Sigma$ 与标通量 $\phi$ 的乘积。

2.  **[中子流](@entry_id:1128689)密度** $\vec{J}(\vec{r},E)$，定义为角通量的第一角度矩：
    $$
    \vec{J}(\vec{r},E) = \int_{4\pi} \vec{\Omega} \, \psi(\vec{r},\vec{\Omega},E) \, d\Omega
    $$
    [中子流](@entry_id:1128689)密度的单位与标通量相同，即 $\mathrm{n}\cdot\mathrm{cm}^{-2}\cdot\mathrm{s}^{-1}\cdot\mathrm{eV}^{-1}$。它是一个矢量，表示在位置 $\vec{r}$ 和能量 $E$ 处，中子穿过单位面积的净流动速率。$\vec{J}$ 的方向代表了中子净迁移的方向，其大小则表示净流动的强度。

### [稳态](@entry_id:139253)玻尔兹曼[中子输运方程](@entry_id:1128709)

[中子输运方程](@entry_id:1128709)是基于相空间中子数守恒的原理建立的。对于一个[稳态](@entry_id:139253)系统，在相空间的任意一个微元 $d\vec{r}\,d\vec{\Omega}\,dE$ 内，中子数增加的速率必须等于中子数减少的速率。这个平衡关系构成了玻尔兹曼输运方程  。

[稳态](@entry_id:139253)、连续能量的中子输运方程的一般形式如下：
$$
\vec{\Omega} \cdot \nabla \psi(\vec{r},\vec{\Omega},E) + \Sigma_t(\vec{r},E)\,\psi(\vec{r},\vec{\Omega},E) = S_s(\vec{r},\vec{\Omega},E) + S_f(\vec{r},\vec{\Omega},E) + Q(\vec{r},\vec{\Omega},E)
$$
方程的每一项都代表一种物理过程，其单位均为[中子产生](@entry_id:1128705)的速率密度，即 $\mathrm{n}\cdot\mathrm{cm}^{-3}\cdot\mathrm{s}^{-1}\cdot\mathrm{sr}^{-1}\cdot\mathrm{eV}^{-1}$。

#### 方程左侧：损失项

方程的左侧描述了中子从相空间微元 $(\vec{r},\vec{\Omega},E)$ 中消失的过程。

1.  **流泄漏项 (Streaming/Leakage Term)**: $\vec{\Omega} \cdot \nabla \psi(\vec{r},\vec{\Omega},E)$
    该项描述了中子由于自身的运动而流出空间微元 $d\vec{r}$ 的净速率。它是一个空间散度项，代表了角通量沿运动方向 $\vec{\Omega}$ 的空间变化率。

2.  **碰撞移除项 (Collision Removal Term)**: $\Sigma_t(\vec{r},E)\,\psi(\vec{r},\vec{\Omega},E)$
    该项描述了中子在 $d\vec{r}$ 内与介质原子核发生任何类型碰撞（吸收或散射）而从状态 $(\vec{\Omega},E)$ 中被移除的速率。**宏观总截面** $\Sigma_t(\vec{r},E)$（单位: $\mathrm{cm}^{-1}$）是中子在单位路程上发生碰撞的概率。因此，该项是总碰撞概率与角通量的乘积。

#### 方程右侧：源项

方程的右侧描述了中子进入相空间微元 $(\vec{r},\vec{\Omega},E)$ 的过程。

1.  **散射源项 (Scattering Source Term)**: $S_s(\vec{r},\vec{\Omega},E)$
    该项表示从所有其他能量 $E'$ 和方向 $\vec{\Omega}'$ 散射到当前状态 $(\vec{\Omega},E)$ 的中子速率。它通过对所有入射状态的角通量进行积分来计算：
    $$
    S_s(\vec{r},\vec{\Omega},E) = \int_0^\infty dE'\, \int_{4\pi} d\vec{\Omega}'\; \Sigma_s(\vec{r}, E' \to E, \vec{\Omega}'\cdot\vec{\Omega})\, \psi(\vec{r},\vec{\Omega}',E')
    $$
    这里的 **双[微分](@entry_id:158422)宏观[散射截面](@entry_id:140322)** $\Sigma_s(\vec{r}, E' \to E, \vec{\Omega}'\cdot\vec{\Omega})$ 是一个关键的物理量，称为**散射核**。它描述了中子从初态 $(E', \vec{\Omega}')$ 散射到末态 $(E, \vec{\Omega})$ 的[概率密度](@entry_id:175496)，单位为 $\mathrm{cm}^{-1}\cdot\mathrm{eV}^{-1}\cdot\mathrm{sr}^{-1}$。

2.  **裂变源项 (Fission Source Term)**: $S_f(\vec{r},\vec{\Omega},E)$
    该项描述了由核裂变产生并进入状态 $(\vec{\Omega},E)$ 的中子。在大多数情况下，裂变中子的出射被认为是各向同性的，并且具有特定的能量谱 $\chi(E)$。裂变是由来自所有方向的中子引起的，因此它依赖于标通量 $\phi$：
    $$
    S_f(\vec{r},\vec{\Omega},E) = \frac{\chi(E)}{4\pi}\,\int_0^\infty dE'\, \nu\Sigma_f(\vec{r},E')\, \phi(\vec{r},E')
    $$
    这里，$\nu\Sigma_f(\vec{r},E')$ 是**中子产生[截面](@entry_id:154995)**（每次裂变产生的平均中子数 $\nu$ 乘以宏观裂变[截面](@entry_id:154995) $\Sigma_f$），$\chi(E)$ 是归一化的**裂变[能谱](@entry_id:181780)**（$\int_0^\infty \chi(E)dE=1$，单位为 $\mathrm{eV}^{-1}$），而 $1/(4\pi)$ 因子则代表了各向同性发射。

3.  **外源项 (External Source Term)**: $Q(\vec{r},\vec{\Omega},E)$
    该项代表独立于中子场本身的其他中子源，例如聚变反应（如[D-T反应](@entry_id:748154)产生的[14.1 MeV中子](@entry_id:746143)）、[放射性同位素](@entry_id:175700)源或加速器源。

### 介质的相互作用特性：宏观与微观[截面](@entry_id:154995)

[输运方程](@entry_id:174281)中的系数 $\Sigma_t, \Sigma_s, \Sigma_f$ 描述了中子与介质的相互作用，它们是宏观截面，其数值取决于材料的组成和中子的能量。这些宏观量源于更基本的**微观[截面](@entry_id:154995)** $\sigma$ 。

微观[截面](@entry_id:154995) $\sigma$（单位：barns, $1\,\mathrm{barn} = 10^{-24}\,\mathrm{cm}^2$）是单个原子核与入射中子发生特定类型相互作用的[有效面积](@entry_id:197911)。宏观截面 $\Sigma$ 是微观[截面](@entry_id:154995)与该核素的**[原子数](@entry_id:746561)密度** $N$ (单位: $\mathrm{cm}^{-3}$) 的乘积：
$$
\Sigma_x(E) = N \sigma_x(E)
$$
对于包含多种核素（例如，$A$ 和 $B$）的[均匀混合物](@entry_id:146483)，宏观截面是各组分贡献的加和：
$$
\Sigma_x(E') = N_A \sigma_{x,A}(E') + N_B \sigma_{x,B}(E')
$$
总截面同样可以分解为散射和吸收两部分：$\Sigma_t(E) = \Sigma_s(E) + \Sigma_a(E)$。

散射核 $\Sigma_s(\vec{r}, E' \to E, \mu)$ 的构建也遵循类似的原则。它是由构成材料的每种核素 $i$ 的双[微分](@entry_id:158422)微观[散射截面](@entry_id:140322) $d^2\sigma_{s,i}/(dE d\Omega)$ 加权求和得到的：
$$
\Sigma_s(E' \to E, \mu) = \sum_{i} N_i \frac{d^2\sigma_{s,i}(E' \to E, \Omega)}{dE\,d\Omega}
$$
在实践中，[核数据库](@entry_id:1128922)（如ENDF）通常提供[总散射截面](@entry_id:168963) $\sigma_{s,i}(E')$ 和归一化的能量-角度分布 $p_i(E' \to E, \mu)$，使得：
$$
\Sigma_s(E' \to E, \mu) = \sum_{i} N_i \sigma_{s,i}(E') p_i(E' \to E, \mu)
$$
对散射核在所有出射能量和角度上积分，可以恢复总的宏观[散射截面](@entry_id:140322) $\Sigma_s(E') = \int dE \int d\Omega\, \Sigma_s(E' \to E, \mu)$。

### 边界条件

为了在有限区域 $V$ 内[求解输运方程](@entry_id:1131949)，必须在区域的边界 $\partial V$ 上规定适当的条件。[输运方程](@entry_id:174281)是[一阶偏微分方程](@entry_id:178306)，因此边界条件只需施加在**入射方向**上。对于边界上任意一点 $\vec{r}_b$，其外法线向量为 $\vec{n}_b$，入射方向 $\vec{\Omega}$ 满足 $\vec{\Omega}\cdot\vec{n}_b  0$。常见的边界条件包括 ：

*   **[真空边界条件](@entry_id:1133678)**: 假设边界外没有中子源，因此没有中子进入该区域。这是最简单的边界条件：
    $$
    \psi(\vec{r}_b,\vec{\Omega},E) = 0, \quad \text{for } \vec{\Omega}\cdot\vec{n}_b  0
    $$

*   **镜[反射边界条件](@entry_id:1130780)**: 中子像光一样在边界上发生镜面反射。[入射角](@entry_id:192705)等于反射角。如果一个中子以方向 $\vec{\Omega}' = \vec{\Omega} - 2(\vec{\Omega}\cdot\vec{n}_b)\vec{n}_b$ 离开边界，它会以方向 $\vec{\Omega}$ 返回：
    $$
    \psi(\vec{r}_b,\vec{\Omega},E) = \psi(\vec{r}_b, \vec{\Omega} - 2(\vec{\Omega}\cdot\vec{n}_b)\vec{n}_b, E), \quad \text{for } \vec{\Omega}\cdot\vec{n}_b  0
    $$

*   **白边界条件（漫反射）**: 离开边界的中子被完[全反射](@entry_id:179014)回区域内，但其[出射角](@entry_id:264341)通量遵循朗伯分布（在半球内各向同性）。这要求入射的总流等于出射的总流。入射角通量与方向无关，其值由出射[中子流](@entry_id:1128689)决定：
    $$
    \psi(\vec{r}_b,\vec{\Omega},E) = \frac{1}{\pi}\int_{(\vec{\Omega}'\cdot\vec{n}_b)0} \psi(\vec{r}_b,\vec{\Omega}',E)\,(\vec{\Omega}'\cdot\vec{n}_b)\,d\vec{\Omega}', \quad \text{for } \vec{\Omega}\cdot\vec{n}_b  0
    $$

*   **[周期性边界条件](@entry_id:753346)**: 用于模拟无限重复的几何结构。离开一个边界的中子会以相同的方向和能量从与之配对的另一个边界进入。若点 $\vec{r}_b$ 与 $\vec{r}_b'$ 配对，且 $\vec{n}_{b'} = -\vec{n}_b$，则：
    $$
    \psi(\vec{r}_b,\vec{\Omega},E) = \psi(\vec{r}_b',\vec{\Omega},E), \quad \text{for } \vec{\Omega}\cdot\vec{n}_b  0
    $$

*   **[反照率边界条件](@entry_id:1120916)**: 这是漫反射的推广，只有一部分（由能量相关的[反照率](@entry_id:188373)系数 $a(E) \in [0,1]$ 决定）出射中子流被[漫反射](@entry_id:173213)回来：
    $$
    \psi(\vec{r}_b,\vec{\Omega},E) = \frac{a(E)}{\pi}\int_{(\vec{\Omega}'\cdot\vec{n}_b)0} \psi(\vec{r}_b,\vec{\Omega}',E)\,(\vec{\Omega}'\cdot\vec{n}_b)\,d\vec{\Omega}', \quad \text{for } \vec{\Omega}\cdot\vec{n}_b  0
    $$

### 解的数学特征：[固定源问题](@entry_id:1125046)与本征值问题

[输运方程](@entry_id:174281)的数学性质很大程度上取决于是否存在裂变项 $S_f$ 。这导致了两种截然不同的问题类型。

1.  **[固定源问题](@entry_id:1125046)**: 在典型的聚变系统中，例如聚变堆的包层，主要的中子源是D-T等离子体产生的聚变中子，这是一个外源 $Q$。包层材料（如锂）通常不发生裂变，因此 $\nu\Sigma_f = 0$。此时，[稳态](@entry_id:139253)[输运方程](@entry_id:174281)是一个**线性非[齐次方程](@entry_id:163650)**：
    $$
    L\psi = q
    $$
    其中 $L$ 是包含流泄漏、碰撞和散射的净输运算子。对于给定的源 $q$ 和适当的边界条件，该方程通常有**唯一解** $\psi = L^{-1}q$。解的幅度与外源强度成正比。在时间相关的分析中，如果没有外源，任何初始的中子布居都会由于吸收和泄漏而衰减。

2.  **[本征值问题](@entry_id:142153)**: 在裂变反应堆堆芯中，中子场主要由链式裂变反应维持，外源通常可以忽略 ($q=0$)。裂变源项 $S_f$ 本身依赖于待求的通量 $\psi$，使得方程变为**[齐次方程](@entry_id:163650)**。为了寻找一个能够自我维持的[稳态解](@entry_id:200351)，问题被构建为一个**广义[本征值问题](@entry_id:142153)**：
    $$
    L\psi = \frac{1}{k} F\psi
    $$
    这里 $F$ 是裂变算子。非[平凡解](@entry_id:155162)（$\psi \neq 0$）仅在特定的本征值 $k$ 处存在。其中，物理意义最大的是主本征值，记为**有效增殖因子** $k_{\text{eff}}$。只有当 $k_{\text{eff}}=1$ 时（即[中子产生](@entry_id:1128705)率恰好等于损失率），系统才能达到**临界**状态，维持一个[稳态](@entry_id:139253)的链式反应。此时的解（基波通量模式）在归一化意义下是唯一的，其绝对幅度由反应堆功率决定。在时间相关的分析中，如果 $k_{\text{eff}}  1$（超临界），中子布居将呈[指数增长](@entry_id:141869)。

### 数值求解策略

由于其复杂性，[中子输运方程](@entry_id:1128709)除在极少数高度简化的情形下，通常无法获得解析解，必须依赖数值方法。主要有两大类方法：确定论方法和[统计模拟](@entry_id:169458)方法。

#### 确定论方法：离散纵标法 ($S_N$)

离散纵标法（Discrete Ordinates Method, $S_N$）通过对相空间进行离散化来[求解输运方程](@entry_id:1131949)。

##### 角度离散化

$S_N$ 方法的核心思想是用一个有限的、离散的方向集合 $\{\vec{\Omega}_m, w_m\}_{m=1}^M$ 来代替连续的角度变量 $\vec{\Omega}$。这里，$\vec{\Omega}_m$ 是离散的方向（纵标），$w_m$ 是相应的[求积权重](@entry_id:753910)。角通量 $\psi(\vec{r}, \vec{\Omega}, E)$ 被一组方向通量 $\psi_m(\vec{r}, E)$ 所取代。角度积分则被[求积公式](@entry_id:753909)近似，例如散射源项中的积分变为求和 ：
$$
\int_{4\pi} f(\vec{\Omega}') d\vec{\Omega}' \approx \sum_{m'=1}^M w_{m'} f(\vec{\Omega}_{m'})
$$
将此应用于包含[各向异性散射](@entry_id:148372)的[稳态](@entry_id:139253)多群[输运方程](@entry_id:174281)，对每个离散方向 $\vec{\Omega}_m$ 和每个能群 $g$，我们得到一组耦合的半离散方程：
$$
\vec{\Omega}_m \cdot \nabla \psi_{g,m}(\vec{r}) + \Sigma_{t,g}(\vec{r})\psi_{g,m}(\vec{r}) = \sum_{g'=1}^{G} \sum_{l=0}^{L} \frac{2l+1}{4\pi}\Sigma_{s,g'\to g,l}(\vec{r}) \sum_{m'=1}^{M} w_{m'}P_l(\vec{\Omega}_m\cdot\vec{\Omega}_{m'})\psi_{g',m'}(\vec{r}) + Q_{g,m}(\vec{r})
$$
这组方程在空间上仍然是连续的，但角度上已经是离散的。

##### [空间离散化](@entry_id:172158)与正性问题

接下来，需要对半离散方程进行空间离散化。常用的方法包括有限差分、有限元或[有限体积法](@entry_id:141374)。一个关键的性质是**正性**（positivity），即在物理上，角通量作为粒子密度的度量，必须是非负的。然而，并非所有空间离散格式都能保证这一点。

以一维平板几何为例，考虑两种简单格式：**[阶跃特征线法](@entry_id:1132385) (Step-Characteristics, SC)** 和**[菱形差分法](@entry_id:1123658) (Diamond-Difference, DD)** 。
*   **SC方法** 在每个空间网格内假设源和[截面](@entry_id:154995)为常数，并解析地求解特征线方程。其出射通量 $\psi_{i+1/2}$ 的表达式为：
    $$
    \psi_{i+1/2} = \psi_{i-1/2}\,e^{-\tau} + \frac{Q}{\Sigma_t}(1 - e^{-\tau})
    $$
    其中 $\tau = \Sigma_t \Delta x / |\mu|$ 是网格的光学厚度。由于指数项 $e^{-\tau}$ 和 $(1-e^{-\tau})$ 始终非负，SC方法是**无条件正性保持**的。
*   **DD方法** 假定网格内的平均通量是网格两端通量的平均值。其出射通量表达式为：
    $$
    \psi_{i+1/2} = \frac{2 - \tau}{2 + \tau} \psi_{i-1/2} + \frac{Q}{\frac{\mu}{\Delta x} + \frac{\Sigma_t}{2}}
    $$
    当网格[光学厚度](@entry_id:150612) $\tau  2$ 时，传输因子 $(2-\tau)/(2+\tau)$ 会变为负值。这可能导致即使入射通量和源都是正的，出射通量却计算为负值，这在物理上是荒谬的。因此，DD方法不是无条件正性保持的，在处理光学厚区时需要修正（所谓的“fixup”）。

##### $S_N$ 方法的挑战：射线效应

$S_N$ 方法的一个固有缺陷是**射线效应**（ray effect）。由于角度被离散化，中子只能沿着有限的几个方向传播。在散射较弱的介质中，对于一个局域化的源，中子流会明显地集中在这几个离散方向上，而在这些方向之间出现非物理的通量洼地。

例如，考虑一个在真空中发射的准直中子束，其真实路径是一条直线。在 $S_N$ 模拟中，该中子束的能量会被分配到最接近真实方向的那个离散方向 $\vec{\Omega}_m$ 上进行传播。如果真实方向 $\theta_0$ 与 $\vec{\Omega}_m$ 之间存在一个小的**角度偏差** $\varepsilon$，那么在距离源 $L$ 处，数值解的束流中心将会产生一个 $d = L \sin\varepsilon$ 的**横向偏移**。如果这个偏移大于探测器的半径 $a$，即使探测器在真实路径上，[数值模拟](@entry_id:146043)也会报告“未探测到”。

为了确保数值解的可靠性，必须保证在给定的探测器尺寸 $(a)$ 和距离 $(L)$下，角度离散足够精细。这要求最坏情况下的角度偏差（即 $\varepsilon_{\max} = \pi/N$）小于探测器的**接收半角** $\alpha = \arcsin(\min\{1, a/L\})$。由此可得，为避免射线效应导致的误判，所需的最小离散方向数 $N_{\min}$ 为：
$$
N_{\min} = \left\lceil \frac{\pi}{\alpha(L,a)} \right\rceil
$$
这为选择合适的[角度求积](@entry_id:1121013)组提供了定量指导。

#### [统计模拟](@entry_id:169458)方法：[蒙特卡洛](@entry_id:144354)法 (MC)

蒙特卡洛法是求解输运方程的另一种强大工具，它不直接求解方程，而是通过模拟大量单个中子的生命史来统计推断宏观物理量。一个**模拟 (analog) [蒙特卡洛](@entry_id:144354)**模拟直接复现了中子与原子核相互作用的[随机过程](@entry_id:268487) 。

一个中子的典型生命史如下：
1.  **源粒子抽样**: 根据源的分布（位置、方向、能量）生成一个初始中子。
2.  **自由程抽样**: 中子在两次碰撞之间会沿直线飞行一段距离，即自由程 $s$。在均匀介质中，自由程服从[指数分布](@entry_id:273894)，其概率密度为 $p(s) = \Sigma_t e^{-\Sigma_t s}$。可以通过[逆变换采样法](@entry_id:142402)得到：
    $$
    s = -\frac{\ln \xi}{\Sigma_t}
    $$
    其中 $\xi$ 是一个 $(0,1)$ 上的均匀分布随机数。中子的位置更新为 $\vec{r}_{\text{new}} = \vec{r}_{\text{old}} + s \vec{\Omega}$。
3.  **[碰撞物理](@entry_id:164923)**: 到达碰撞点后，需要判断碰撞的类型。中子被散射的概率是 $P_s = \Sigma_s / \Sigma_t$，被吸收的概率是 $P_a = \Sigma_a / \Sigma_t$。通过与另一个随机数比较，决定此次碰撞是散射还是吸收。
    *   如果**吸收**，该中子的历史结束。
    *   如果**散射**，则需要根据散射核 $p(E' \to E, \mu)$ 抽样新的能量和方向。例如，对于各向同性散射，新的方向 $\vec{\Omega}'$ 在 $4\pi$ 立体角上均匀分布。
4.  **重复**: 如果中子发生散射，则返回第2步，继续追踪其下一段自由程。如果中子逃离系统边界，其历史也告结束。
5.  **统计与计数 (Tallying)**: 在追踪中子历史的过程中，需要记录其对我们关心的物理量（如通量）的贡献。一种常用的方法是**径迹长度计数器 (track-length estimator)**。标通量在物理上是单位体积内的总径迹长度。因此，一个区域内的平均标通量可以通过计算所有穿过该区域的中子径迹总长度，再除以该区域的体积来估计。类似地，角通量可以通过只统计特定方向的径迹长度来估计。

通过模拟足够多的中子历史并对计数结果进行平均，就可以得到具有[统计不确定性](@entry_id:267672)的宏观物理量的估计值。MC方法的优点是能够处理任意复杂的几何和物理过程，且不受射线效应困扰。其主要缺点是计算成本高，且结果总带有统计误差。

### 高级主题：[伴随输运方程](@entry_id:1120823)

在许多应用中，我们关心的不是整个相空间中的通量分布，而是一个特定的积分量，例如某个局部区域的反应率或探测器响应 $R_x$。直接计算 $\psi$ 然后再积分得到 $R_x$ 可能效率很低。**[伴随输运理论](@entry_id:1120824)**提供了一种更高效的途径 。

该理论引入了一个**伴随通量** $\psi^\dagger$，它满足**[伴随输运方程](@entry_id:1120823)**。伴随通量 $\psi^\dagger(\vec{r},\vec{\Omega},E)$ 在物理上可以解释为“重要性函数”：一个在 $(\vec{r},\vec{\Omega},E)$ 处的中子对我们所关心的响应 $R_x$ 的贡献大小。

伴随方程的形式可以通过对原输运算子 $L$ 取伴随 $L^\dagger$ 得到。对于标准的输运算子，其[伴随算子](@entry_id:140236) $L^\dagger$ 的主要特征是：
*   流泄漏项的符号反转：$-\vec{\Omega} \cdot \nabla \psi^\dagger$。这意味着伴随粒子沿着与真实粒子相反的方向“飞行”。
*   散射核的能量变量[转置](@entry_id:142115)：伴随粒子从能量 $E$ 散射到 $E'$ 的概率，等于真实粒子从 $E'$ 散射到 $E$ 的概率。
*   [总截面](@entry_id:151809)项保持不变。

伴随方程的形式为 $L^\dagger \psi^\dagger = q^\dagger$，其中**伴随源** $q^\dagger$ 由所求的响应函数确定。例如，如果要计算一个体积为 $V_D$ 的探测器内的总反应率 $R_x = \int_{V_D} d^3r \int dE\, \Sigma_x(\vec{r},E) \phi(\vec{r},E)$，则对应的伴随源为 $q^\dagger(\vec{r},E) = \Sigma_x(\vec{r},E) \chi_D(\vec{r})$，其中 $\chi_D$ 是 $V_D$ 的[特征函数](@entry_id:186820)。

伴随边界条件也与原边界条件相对应。例如，原问题的真空边界（入射通量为零）对应于伴随问题的出射伴随通量为零。

一旦求得伴随通量 $\psi^\dagger$，就可以通过以下积分快速计算任何外源 $q$ 引起的响应 $R_x$：
$$
R_x = \langle \psi^\dagger, q \rangle = \int d^3r \int dE \int d\Omega \, \psi^\dagger(\vec{r},\vec{\Omega},E) q(\vec{r},\vec{\Omega},E)
$$
这种方法的巨大优势在于，只需进行一次（通常计算成本较高的）伴随方程求解，就可以评估任意多个不同源分布对同一探测器响应的贡献，这在源项研究和屏蔽优化等问题中极为有用。