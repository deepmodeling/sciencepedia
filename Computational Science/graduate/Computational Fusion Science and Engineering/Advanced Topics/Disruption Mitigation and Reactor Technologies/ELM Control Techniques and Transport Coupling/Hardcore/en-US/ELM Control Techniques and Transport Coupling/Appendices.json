{
    "hands_on_practices": [
        {
            "introduction": "The primary motivation for controlling Edge Localized Modes (ELMs) is the immense and potentially damaging heat flux they deposit on plasma-facing components. This first exercise provides a direct, first-principles calculation to quantify this threat, connecting the energy lost from the plasma during an ELM to the transient power load on the divertor. By performing this calculation , you will gain a concrete appreciation for the engineering challenges ELMs pose and why their mitigation is a critical area of fusion research.",
            "id": "3972241",
            "problem": "A tokamak plasma in High-confinement mode experiences an Edge Localized Mode (ELM), leading to a prompt energy release to the divertor. Assume the ELM energy loss is $\\Delta W$ and that the energy is deposited over a wetted divertor area $A_{\\mathrm{wetted}}$ in a characteristic deposition time $\\Delta t$. The edge transport is coupled to applied resonant magnetic perturbations (RMPs), which broaden the wetted area by enhancing cross-field transport and strike-line splitting. A nonlinear magnetohydrodynamics simulation, coupled to scrape-off-layer transport, predicts $A_{\\mathrm{wetted}}$ for the present discharge phase. Using only conservation of energy and the definitions of heat flux, model the transient heat flux during the ELM as approximately uniform in time over the interval $\\Delta t$ and approximately uniform in space over the area $A_{\\mathrm{wetted}}$ (a top-hat approximation).\n\nGiven the following scenario:\n- ELM energy loss $\\Delta W = 2.4\\times 10^{5}\\ \\mathrm{J}$,\n- Deposition time $\\Delta t = 8.0\\times 10^{-4}\\ \\mathrm{s}$,\n- Wetted area $A_{\\mathrm{wetted}} = 0.60\\ \\mathrm{m}^{2}$,\n- An engineering transient heat flux design limit for the divertor material (tungsten) for millisecond-scale loads $q_{\\lim} = 6.0\\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$,\n\nderive from first principles an expression for the divertor peak heat flux $q_{\\mathrm{peak}}$ under the top-hat approximation. Then, quantify the exceedance factor $f \\equiv q_{\\mathrm{peak}}/q_{\\lim}$.\n\nReport only the exceedance factor $f$ as your final answer. Round your answer to three significant figures. The final answer is dimensionless (no units).",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The scenario described is a standard problem in fusion reactor engineering, concerning the management of transient heat loads on plasma-facing components. We may therefore proceed directly to the derivation and calculation.\n\nThe task is to derive an expression for the peak heat flux, $q_{\\mathrm{peak}}$, on the divertor during an Edge Localized Mode (ELM) event and then to compute its ratio to a given engineering limit. The derivation begins from first principles: the definitions of power and heat flux, constrained by the top-hat approximation.\n\nPower, $P$, is defined as the rate of energy transfer, $P = \\frac{dE}{dt}$. The problem states that the total energy loss during the ELM is $\\Delta W$, and this energy is deposited over a characteristic time $\\Delta t$. The \"top-hat\" approximation posits that this energy deposition occurs at a constant rate. Therefore, the power delivered to the divertor during the ELM is constant and can be expressed as:\n$$\nP = \\frac{\\Delta W}{\\Delta t}\n$$\n\nHeat flux, $q$, is defined as power per unit area, $q = \\frac{P}{A}$. The top-hat approximation further posits that this power is deposited uniformly over a wetted area $A_{\\mathrm{wetted}}$. Under this assumption, the heat flux is constant across this area. This constant heat flux is the peak heat flux, $q_{\\mathrm{peak}}$.\n$$\nq_{\\mathrm{peak}} = \\frac{P}{A_{\\mathrm{wetted}}}\n$$\n\nBy substituting the expression for power $P$ into the equation for heat flux, we derive the desired expression for the peak heat flux from first principles:\n$$\nq_{\\mathrm{peak}} = \\frac{\\left(\\frac{\\Delta W}{\\Delta t}\\right)}{A_{\\mathrm{wetted}}} = \\frac{\\Delta W}{A_{\\mathrm{wetted}} \\Delta t}\n$$\n\nNow, we substitute the provided numerical values into this expression to find the magnitude of the peak heat flux. The given values are:\n- ELM energy loss: $\\Delta W = 2.4 \\times 10^{5}\\ \\mathrm{J}$\n- Deposition time: $\\Delta t = 8.0 \\times 10^{-4}\\ \\mathrm{s}$\n- Wetted area: $A_{\\mathrm{wetted}} = 0.60\\ \\mathrm{m}^{2}$\n\nSubstituting these values:\n$$\nq_{\\mathrm{peak}} = \\frac{2.4 \\times 10^{5}\\ \\mathrm{J}}{(0.60\\ \\mathrm{m}^{2})(8.0 \\times 10^{-4}\\ \\mathrm{s})}\n$$\n$$\nq_{\\mathrm{peak}} = \\frac{2.4 \\times 10^{5}}{0.48 \\times 10^{-3}}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\n$$\n$$\nq_{\\mathrm{peak}} = \\frac{2.4}{0.48} \\times 10^{5 - (-3)}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\n$$\n$$\nq_{\\mathrm{peak}} = 5.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\n$$\n\nThe final step is to calculate the exceedance factor, $f$, which is defined as the ratio of the peak heat flux to the engineering design limit, $q_{\\lim}$.\n$$\nf \\equiv \\frac{q_{\\mathrm{peak}}}{q_{\\lim}}\n$$\nThe engineering limit is given as $q_{\\lim} = 6.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$.\nSubstituting the calculated value for $q_{\\mathrm{peak}}$ and the given value for $q_{\\lim}$:\n$$\nf = \\frac{5.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}}{6.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}} = \\frac{5.0}{6.0}\n$$\n$$\nf \\approx 0.8333...\n$$\nThe problem requires the answer to be rounded to three significant figures. Therefore, the exceedance factor $f$ is $0.833$. This result indicates that the peak heat flux is approximately $83.3\\%$ of the divertor's transient design limit.",
            "answer": "$$\n\\boxed{0.833}\n$$"
        },
        {
            "introduction": "Having established the danger of ELMs, we now turn to a primary control method: the application of external Resonant Magnetic Perturbations (RMPs). This exercise  explores the fundamental principle of linear superposition to determine the actual magnetic perturbation spectrum at the plasma edge, accounting for both the deliberately applied RMP coils and the unavoidable intrinsic error fields. This practice is crucial for understanding how to engineer a precise magnetic field structure required for effective ELM control.",
            "id": "3972177",
            "problem": "A large-aspect-ratio, circular-cross-section tokamak is operated with Resonant Magnetic Perturbation (RMP) coils for Edge Localized Mode (ELM) control. The magnetic field is magnetostatic on the time scales of interest, so the governing equations are $\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$ and $\\nabla \\cdot \\mathbf{B} = 0$, implying linear superposition of magnetic fields from independent current sources. The normal component of the perturbed magnetic field at the plasma edge, normalized to the equilibrium toroidal field, is expanded in a double Fourier series over the poloidal angle $\\theta$ and the toroidal angle $\\phi$ as\n$$\nb_{n}(\\theta,\\phi) = \\sum_{m,n} b_{mn} \\exp\\!\\big(i[m\\theta - n\\phi]\\big),\n$$\nwhere $b_{mn}$ is the complex Fourier coefficient of the $(m,n)$ harmonic, and rational surfaces satisfy $q(r_{s}) = m/n$. By definition,\n$$\nb_{mn} = \\frac{1}{(2\\pi)^{2}} \\int_{0}^{2\\pi}\\!\\!\\int_{0}^{2\\pi} b_{n}(\\theta,\\phi) \\exp\\!\\big(-i[m\\theta - n\\phi]\\big)\\, d\\theta\\, d\\phi.\n$$\nDue to linearity, the vacuum spectrum $b^{\\mathrm{vac}}_{mn}$ is the sum of the intended RMP-coil spectrum $b^{\\mathrm{coil}}_{mn}$ and the intrinsic error-field spectrum $b^{\\mathrm{err}}_{mn}$, each a complex coefficient:\n$$\nb^{\\mathrm{vac}}_{mn} = b^{\\mathrm{coil}}_{mn} + b^{\\mathrm{err}}_{mn}.\n$$\nTransport–response coupling in the resistive plasma edge modifies the vacuum spectrum through a linear response operator that, for each $(m,n)$, is approximated here by a scalar complex factor $r_{mn} = S_{mn}\\exp(i\\theta_{mn})$ with magnitude $S_{mn}\\in(0,1)$ and phase $\\theta_{mn}$ coming from the coupled magnetohydrodynamic–transport calculation. The spectrum at the rational surface is then\n$$\nb^{\\mathrm{net}}_{mn}(r_{s}) = r_{mn}\\, b^{\\mathrm{vac}}_{mn}.\n$$\nConsider two critical rational surfaces: $(m,n)=(12,3)$ and $(m,n)=(16,4)$. The intended RMP spectrum and the intrinsic error-field spectrum (both normalized to the equilibrium toroidal field and expressed as complex phasors with amplitudes and phases) are:\n- For $(m,n)=(12,3)$: $b^{\\mathrm{coil}}_{12,3} = 3.5\\times 10^{-3}\\, \\exp(i\\,0)$, and $b^{\\mathrm{err}}_{12,3} = 1.0\\times 10^{-3}\\, \\exp\\!\\big(i\\,\\frac{\\pi}{3}\\big)$.\n- For $(m,n)=(16,4)$: $b^{\\mathrm{coil}}_{16,4} = 2.8\\times 10^{-3}\\, \\exp\\!\\big(i\\,\\frac{\\pi}{4}\\big)$, and $b^{\\mathrm{err}}_{16,4} = 0.7\\times 10^{-3}\\, \\exp\\!\\big(i\\,\\big(-\\frac{\\pi}{6}\\big)\\big)$.\n\nThe transport–response coupling factors derived from a linear resistive layer model with edge cross-field transport are:\n- $r_{12,3} = S_{12,3}\\exp(i\\theta_{12,3})$ with $S_{12,3} = 0.7$ and $\\theta_{12,3} = \\frac{\\pi}{8}$,\n- $r_{16,4} = S_{16,4}\\exp(i\\theta_{16,4})$ with $S_{16,4} = 0.6$ and $\\theta_{16,4} = -\\frac{\\pi}{10}$.\n\nStarting from the magnetostatic equations and the Fourier definition above, derive how the intrinsic error fields modify the intended RMP spectrum through linear superposition, and then compute the magnitudes $\\big|b^{\\mathrm{net}}_{mn}(r_{s})\\big|$ at the two rational surfaces $(12,3)$ and $(16,4)$. Treat all phases in radians. Express the final answers as a dimensionless row matrix $\\begin{pmatrix} \\big|b^{\\mathrm{net}}_{12,3}\\big| & \\big|b^{\\mathrm{net}}_{16,4}\\big| \\end{pmatrix}$, normalized to the equilibrium toroidal field, and round your results to four significant figures.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of magnetostatics and plasma physics, specifically concerning the application of Resonant Magnetic Perturbations (RMPs) in tokamaks for Edge Localized Mode (ELM) control. The problem is well-posed, objective, self-contained, and provides all necessary data for a unique solution. The physical model, while simplified, is a standard representation used in the field. Therefore, we proceed to the solution.\n\nThe problem asks for a derivation of how intrinsic error fields modify the intended RMP spectrum and for the computation of the magnitudes of the net perturbed magnetic field, $\\big|b^{\\mathrm{net}}_{mn}\\big|$, at two specified rational surfaces.\n\nThe governing equations for the magnetic field on the relevant timescales are given as magnetostatic:\n$$\n\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\nThese are linear partial differential equations for the magnetic field $\\mathbf{B}$ given a current density distribution $\\mathbf{J}$. The principle of linear superposition states that for a linear system, the total response to a sum of stimuli is the sum of the responses to each individual stimulus. In this context, the total magnetic field is the vector sum of fields generated by independent current sources. The problem considers two sources for the vacuum perturbation field: the external RMP coils and intrinsic error fields arising from small imperfections in the main magnet system.\n\nThe Fourier transform, used to decompose the field into harmonics $b_{mn}$, is a linear operation. Consequently, the Fourier coefficient of the sum of two fields is the sum of their individual Fourier coefficients. This directly leads to the relation for the vacuum spectrum, where the total vacuum perturbation coefficient $b^{\\mathrm{vac}}_{mn}$ is the linear sum of the coefficient from the RMP coils, $b^{\\mathrm{coil}}_{mn}$, and the coefficient from the intrinsic error field, $b^{\\mathrm{err}}_{mn}$:\n$$\nb^{\\mathrm{vac}}_{mn} = b^{\\mathrm{coil}}_{mn} + b^{\\mathrm{err}}_{mn}\n$$\nThis equation formally describes how the intrinsic error field modifies the intended RMP spectrum through linear superposition.\n\nThe plasma itself responds to this vacuum perturbation. The problem provides a linear response model where the net field at a rational surface, $b^{\\mathrm{net}}_{mn}(r_{s})$, is related to the vacuum field by a complex scalar factor $r_{mn}$:\n$$\nb^{\\mathrm{net}}_{mn}(r_{s}) = r_{mn} \\, b^{\\mathrm{vac}}_{mn}\n$$\nThe factor $r_{mn}$ accounts for both screening (or amplification) through its magnitude $S_{mn} = |r_{mn}|$ and a phase shift through its argument $\\theta_{mn}$.\n\nOur objective is to calculate the magnitude of the net field, $\\big|b^{\\mathrm{net}}_{mn}\\big|$. Using the multiplicative property of magnitudes of complex numbers:\n$$\n\\big|b^{\\mathrm{net}}_{mn}\\big| = |r_{mn} \\cdot b^{\\mathrm{vac}}_{mn}| = |r_{mn}| \\cdot |b^{\\mathrm{vac}}_{mn}| = S_{mn} \\cdot |b^{\\mathrm{coil}}_{mn} + b^{\\mathrm{err}}_{mn}|\n$$\nTo find the magnitude of the sum of two complex numbers given in polar form, $z_1 = A\\exp(i\\alpha)$ and $z_2 = B\\exp(i\\beta)$, we can use a formulation equivalent to the law of cosines for vector addition:\n$$\n|z_1 + z_2| = \\sqrt{A^2 + B^2 + 2AB\\cos(\\alpha - \\beta)}\n$$\nWe apply this formula to each of the two specified harmonics.\n\n**Calculation for $(m,n)=(12,3)$**\n\nThe given data are:\n- $b^{\\mathrm{coil}}_{12,3} = 3.5\\times 10^{-3}\\, \\exp(i\\,0)$\n- $b^{\\mathrm{err}}_{12,3} = 1.0\\times 10^{-3}\\, \\exp\\big(i\\,\\frac{\\pi}{3}\\big)$\n- $S_{12,3} = 0.7$\n\nWe identify the terms for our magnitude formula:\n$A = 3.5\\times 10^{-3}$, $B = 1.0\\times 10^{-3}$, $\\alpha = 0$, and $\\beta = \\frac{\\pi}{3}$.\nThe phase difference is $\\alpha - \\beta = 0 - \\frac{\\pi}{3} = -\\frac{\\pi}{3}$.\n\nFirst, we calculate the magnitude of the vacuum field spectrum, $|b^{\\mathrm{vac}}_{12,3}|$:\n$$\n|b^{\\mathrm{vac}}_{12,3}|^2 = (3.5\\times 10^{-3})^2 + (1.0\\times 10^{-3})^2 + 2(3.5\\times 10^{-3})(1.0\\times 10^{-3})\\cos\\left(-\\frac{\\pi}{3}\\right)\n$$\nSince $\\cos(-x) = \\cos(x)$ and $\\cos(\\frac{\\pi}{3})=\\frac{1}{2}$:\n$$\n|b^{\\mathrm{vac}}_{12,3}|^2 = (12.25\\times 10^{-6}) + (1.0\\times 10^{-6}) + (7.0\\times 10^{-6})\\left(\\frac{1}{2}\\right)\n$$\n$$\n|b^{\\mathrm{vac}}_{12,3}|^2 = (12.25 + 1.0 + 3.5) \\times 10^{-6} = 16.75 \\times 10^{-6}\n$$\n$$\n|b^{\\mathrm{vac}}_{12,3}| = \\sqrt{16.75} \\times 10^{-3} \\approx 4.092676 \\times 10^{-3}\n$$\nNow, we compute the magnitude of the net field, including the plasma response:\n$$\n\\big|b^{\\mathrm{net}}_{12,3}\\big| = S_{12,3} \\cdot |b^{\\mathrm{vac}}_{12,3}| = 0.7 \\times (4.092676 \\times 10^{-3}) \\approx 2.864873 \\times 10^{-3}\n$$\n\n**Calculation for $(m,n)=(16,4)$**\n\nThe given data are:\n- $b^{\\mathrm{coil}}_{16,4} = 2.8\\times 10^{-3}\\, \\exp\\big(i\\,\\frac{\\pi}{4}\\big)$\n- $b^{\\mathrm{err}}_{16,4} = 0.7\\times 10^{-3}\\, \\exp\\big(i\\,(-\\frac{\\pi}{6})\\big)$\n- $S_{16,4} = 0.6$\n\nWe identify the terms:\n$A = 2.8\\times 10^{-3}$, $B = 0.7\\times 10^{-3}$, $\\alpha = \\frac{\\pi}{4}$, and $\\beta = -\\frac{\\pi}{6}$.\nThe phase difference is $\\alpha - \\beta = \\frac{\\pi}{4} - (-\\frac{\\pi}{6}) = \\frac{3\\pi}{12} + \\frac{2\\pi}{12} = \\frac{5\\pi}{12}$.\n\nFirst, we calculate the magnitude of the vacuum field spectrum, $|b^{\\mathrm{vac}}_{16,4}|$:\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 = (2.8\\times 10^{-3})^2 + (0.7\\times 10^{-3})^2 + 2(2.8\\times 10^{-3})(0.7\\times 10^{-3})\\cos\\left(\\frac{5\\pi}{12}\\right)\n$$\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 = (7.84\\times 10^{-6}) + (0.49\\times 10^{-6}) + (3.92\\times 10^{-6})\\cos\\left(\\frac{5\\pi}{12}\\right)\n$$\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 = \\left(8.33 + 3.92 \\cos\\left(\\frac{5\\pi}{12}\\right)\\right) \\times 10^{-6}\n$$\nThe value of $\\cos\\left(\\frac{5\\pi}{12}\\right)$ is $\\frac{\\sqrt{6}-\\sqrt{2}}{4} \\approx 0.258819$.\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 \\approx (8.33 + 3.92 \\times 0.258819) \\times 10^{-6} \\approx (8.33 + 1.014543) \\times 10^{-6} \\approx 9.344543 \\times 10^{-6}\n$$\n$$\n|b^{\\mathrm{vac}}_{16,4}| = \\sqrt{9.344543} \\times 10^{-3} \\approx 3.056884 \\times 10^{-3}\n$$\nNow, we compute the magnitude of the net field:\n$$\n\\big|b^{\\mathrm{net}}_{16,4}\\big| = S_{16,4} \\cdot |b^{\\mathrm{vac}}_{16,4}| = 0.6 \\times (3.056884 \\times 10^{-3}) \\approx 1.834130 \\times 10^{-3}\n$$\n\n**Final Results**\n\nThe problem requires the results to be rounded to four significant figures and presented as a row matrix.\nFor $(m,n)=(12,3)$: $\\big|b^{\\mathrm{net}}_{12,3}\\big| \\approx 2.864873 \\times 10^{-3} \\to 2.865 \\times 10^{-3}$.\nFor $(m,n)=(16,4)$: $\\big|b^{\\mathrm{net}}_{16,4}\\big| \\approx 1.834130 \\times 10^{-3} \\to 1.834 \\times 10^{-3}$.\n\nThe final answer is the row matrix $\\begin{pmatrix} \\big|b^{\\mathrm{net}}_{12,3}\\big| & \\big|b^{\\mathrm{net}}_{16,4}\\big| \\end{pmatrix}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.865 \\times 10^{-3} & 1.834 \\times 10^{-3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice connects the applied RMP field to its physical effect on plasma transport, which is the core of ELM control. Based on the foundational Rutherford model for tearing modes, you will calculate the size of the magnetic island that forms at a rational surface and then quantify its impact on the local pressure profile . This exercise provides a hands-on demonstration of transport coupling, the mechanism by which externally applied fields are thought to modify edge transport and suppress ELMs.",
            "id": "3972226",
            "problem": "A tokamak Edge Localized Mode (ELM) control system frequently employs Resonant Magnetic Perturbations (RMPs) to influence transport near rational surfaces where magnetic islands can form. In the nonlinear resistive regime, the magnetic island half-width evolves according to resistive magnetohydrodynamics (MHD) and couples to local heat transport leading to pressure gradient flattening inside the island. Build a program that, for specified physically plausible parameters, computes the saturated island width and assesses the local pressure flattening due to parallel heat conduction along island flux surfaces.\n\nStarting point and assumptions:\n- Use resistive magnetohydrodynamics (MHD) with Ohm’s law $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J} $ and the magnetic induction equation $ \\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B} - \\eta \\mathbf{J}) $. Identify the magnetic diffusivity $ D_m \\equiv \\eta / \\mu_0 $, where $ \\mu_0 $ is the vacuum permeability. \n- In the nonlinear Rutherford regime, the tearing mode growth is governed by the stability index $ \\Delta' $ (outer-region matching parameter), and the evolution of the island half-width $ w $ is driven by resistivity and any externally applied resonant magnetic field. Assume an effective linear damping rate $ \\beta $ encapsulating polarization current, curvature stabilization, and sheared $ \\mathbf{E}\\times\\mathbf{B} $ flow effects.\n- Model the external RMP drive as producing an Alfvénic response with characteristic speed $ v_A $, scaled by a small dimensionless coupling coefficient $ \\epsilon $ and the resonant harmonic amplitude $ b_{mn} $.\n- For heat transport inside the island, consider the steady anisotropic diffusion model along and across field lines with parallel and perpendicular thermal diffusivities $ \\chi_{\\parallel} $ and $ \\chi_{\\perp} $ respectively, and a magnetic shear length $ L_s $. Use a rational-surface-localized scaling argument for parallel flattening in a helical island to construct a dimensionless parameter that quantifies the degree of pressure flattening.\n\nTask:\n- From the above fundamental laws and definitions, derive a saturated width $ w_{\\text{sat}} $ based on a steady-state balance between resistive growth, external RMP drive, and effective damping. Then, derive a dimensionless flattening factor $ f_{\\text{flat}} $ that expresses the ratio of the local pressure gradient inside the island to the background pressure gradient, under anisotropic transport dominated by parallel conduction. \n- Implement these derivations as a deterministic computation in code that takes the parameters below and outputs, for each case, the pair $ [w_{\\text{sat}}, f_{\\text{flat}}] $.\n\nDefinitions and units:\n- Vacuum permeability $ \\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m} $.\n- Resistivity $ \\eta $ in $ \\Omega\\cdot\\mathrm{m} $.\n- Stability index $ \\Delta' $ in $ \\mathrm{m}^{-1} $.\n- Damping rate $ \\beta $ in $ \\mathrm{s}^{-1} $.\n- Resonant field amplitude $ b_{mn} $ is dimensionless (normalized to the local equilibrium field).\n- Magnetic field magnitude $ B $ in $ \\mathrm{T} $.\n- Ion number density $ n_i $ in $ \\mathrm{m}^{-3} $, ion mass $ m_i $ in $ \\mathrm{kg} $; mass density $ \\rho = n_i m_i $ in $ \\mathrm{kg/m^3} $.\n- Alfvén speed $ v_A = B / \\sqrt{\\mu_0 \\rho} $ in $ \\mathrm{m/s} $.\n- RMP coupling coefficient $ \\epsilon $ is dimensionless.\n- Magnetic shear length $ L_s $ in $ \\mathrm{m} $.\n- Thermal diffusivities $ \\chi_{\\parallel} $ and $ \\chi_{\\perp} $ in $ \\mathrm{m^2/s} $.\n\nOutput specification:\n- Express the saturated island width $ w_{\\text{sat}} $ in $ \\mathrm{m} $ and the flattening factor $ f_{\\text{flat}} $ as a decimal (unitless fraction).\n- For each test case, round both numbers to six significant figures.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the two-number list $ [w_{\\text{sat}}, f_{\\text{flat}}] $ for a case (e.g., $ [[w_1,f_1],[w_2,f_2],\\dots] $).\n\nTest suite:\nUse the following parameter sets. Each case is specified as $ (\\eta, \\Delta', \\beta, b_{mn}, B, n_i, m_i, \\epsilon, L_s, \\chi_{\\parallel}, \\chi_{\\perp}) $ with all values in their respective units.\n\n1. Happy path:\n   $ \\eta = 1\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 2\\,\\mathrm{m}^{-1},\\quad \\beta = 5\\times 10^{4}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 1\\times 10^{-4}, $\n   $ B = 2\\,\\mathrm{T},\\quad n_i = 1\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 1\\times 10^{-6}, $\n   $ L_s = 0.5\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{8}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 1.0\\,\\mathrm{m^2/s}. $\n\n2. Low resistivity, moderate RMP:\n   $ \\eta = 1\\times 10^{-7}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 3\\,\\mathrm{m}^{-1},\\quad \\beta = 1\\times 10^{5}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 5\\times 10^{-4}, $\n   $ B = 2.5\\,\\mathrm{T},\\quad n_i = 8\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 8\\times 10^{-7}, $\n   $ L_s = 0.4\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 5\\times 10^{8}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 0.5\\,\\mathrm{m^2/s}. $\n\n3. Higher resistivity and strong RMP but large damping:\n   $ \\eta = 5\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 1\\,\\mathrm{m}^{-1},\\quad \\beta = 2\\times 10^{5}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 2\\times 10^{-3}, $\n   $ B = 1.8\\,\\mathrm{T},\\quad n_i = 1\\times 10^{20}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 1\\times 10^{-6}, $\n   $ L_s = 0.6\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{8}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 1.0\\,\\mathrm{m^2/s}. $\n\n4. Near marginal stability (small $ \\Delta' $), weak RMP, moderate damping:\n   $ \\eta = 2\\times 10^{-7}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 0.1\\,\\mathrm{m}^{-1},\\quad \\beta = 4\\times 10^{4}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 1\\times 10^{-5}, $\n   $ B = 2.0\\,\\mathrm{T},\\quad n_i = 5\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 3\\times 10^{-6}, $\n   $ L_s = 0.3\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{9}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 1.5\\,\\mathrm{m^2/s}. $\n\n5. Strong tearing drive, weak damping, extreme anisotropy:\n   $ \\eta = 1\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 5\\,\\mathrm{m}^{-1},\\quad \\beta = 1\\times 10^{4}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 1\\times 10^{-3}, $\n   $ B = 3.0\\,\\mathrm{T},\\quad n_i = 2\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 5\\times 10^{-7}, $\n   $ L_s = 0.4\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{9}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 0.2\\,\\mathrm{m^2/s}. $",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in established principles of resistive magnetohydrodynamics and plasma transport theory, specifically the Rutherford model for tearing mode evolution and the concept of pressure profile flattening within magnetic islands. The problem is well-posed, providing sufficient information to derive the required quantities and a set of physically plausible parameters for computation. It is an objective, formalizable problem directly relevant to computational fusion science.\n\nThe solution proceeds by first deriving the analytical expressions for the saturated island width, $w_{\\text{sat}}$, and the pressure flattening factor, $f_{\\text{flat}}$, and then implementing these formulas to compute the results for the given test cases.\n\n**1. Derivation of the Saturated Island Width ($w_{\\text{sat}}$)**\n\nThe evolution of the magnetic island half-width, $w$, is described by a generalized Rutherford equation, which models the balance of competing physical effects at the resonant magnetic surface. The problem specifies three primary contributions to the rate of change of the island width, $\\frac{dw}{dt}$: a resistive growth term, an external drive from Resonant Magnetic Perturbations (RMPs), and an effective damping term. We can write the evolution equation as:\n$$\n\\frac{dw}{dt} = (\\text{Tearing Drive}) + (\\text{RMP Drive}) - (\\text{Damping})\n$$\nWe model each term based on the provided physical description:\n\n- **Tearing Drive**: The intrinsic growth of a tearing mode in the nonlinear Rutherford regime is driven by the free energy in the magnetic field, quantified by the stability index $\\Delta'$. The growth rate is proportional to the magnetic diffusivity, $D_m = \\eta / \\mu_0$, where $\\eta$ is the plasma resistivity and $\\mu_0$ is the vacuum permeability. This drive term is given by:\n  $$ (\\text{Tearing Drive}) = k_R \\frac{\\eta}{\\mu_0} \\Delta' $$\n  where $k_R$ is a numerical coefficient of order unity. As is common in such models where this coefficient is not explicitly given, we assume $k_R=1$. This yields a drive term of $\\frac{\\eta \\Delta'}{\\mu_0}$.\n\n- **Damping**: The problem states there is an effective linear damping rate $\\beta$ (in units of $s^{-1}$) that encapsulates stabilizing effects such as those from polarization currents, field line curvature, and sheared $\\mathbf{E}\\times\\mathbf{B}$ flows. A linear damping rate implies a damping term proportional to the island width itself. To ensure dimensional consistency (the term must have units of velocity, $\\mathrm{m/s}$), this term is modeled as:\n  $$ (\\text{Damping}) = \\beta w $$\n\n- **RMP Drive**: The external RMP is described as producing an Alfvénic response. The drive term is scaled by the Alfvén speed $v_A$, a dimensionless coupling coefficient $\\epsilon$, and the dimensionless resonant harmonic amplitude $b_{mn}$. The Alfvén speed is defined as $v_A = B / \\sqrt{\\mu_0 \\rho}$, where $B$ is the magnetic field strength and $\\rho = n_i m_i$ is the ion mass density. A dimensionally consistent formulation for this drive term as a constant growth velocity is:\n  $$ (\\text{RMP Drive}) = \\epsilon v_A b_{mn} $$\n  This assumes a direct, constant-rate drive from the external perturbation.\n\nCombining these terms, the full island evolution equation becomes:\n$$\n\\frac{dw}{dt} = \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn} - \\beta w\n$$\nSaturation occurs when the island width ceases to change, i.e., $\\frac{dw}{dt} = 0$. We can solve for the saturated island half-width, $w_{\\text{sat}}$:\n$$\n0 = \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn} - \\beta w_{\\text{sat}}\n$$\n$$\n\\beta w_{\\text{sat}} = \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn}\n$$\nThis gives the final expression for the saturated island width:\n$$\nw_{\\text{sat}} = \\frac{1}{\\beta} \\left( \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn} \\right)\n$$\nSince an island width must be a non-negative quantity, if the net drive is negative (i.e., damping and intrinsic stability overcome the RMP drive), no island forms and $w_{\\text{sat}}=0$. However, for all provided test cases, $\\Delta' > 0$, ensuring $w_{\\text{sat}} > 0$.\n\n**2. Derivation of the Pressure Flattening Factor ($f_{\\text{flat}}$)**\n\nThe formation of a magnetic island drastically alters the local magnetic topology. Heat and particles can travel very rapidly along magnetic field lines compared to their slow diffusion across them. This transport anisotropy is characterized by $\\chi_{\\parallel} \\gg \\chi_{\\perp}$. Inside an island, the helical field lines connect regions that were previously separated radially, creating a \"short circuit\" for parallel transport. This leads to the equilibration of temperature (and thus pressure, assuming $p \\propto nT$ and a relatively flat density profile across the small island) on each internal flux surface. As a result, the average radial pressure gradient across the island, $(\\nabla p)_{\\text{island}}$, is significantly reduced compared to the background gradient, $(\\nabla p)_{\\text{background}}$.\n\nThe dimensionless flattening factor, $f_{\\text{flat}}$, is defined as the ratio of these gradients:\n$$\nf_{\\text{flat}} = \\frac{(\\nabla p)_{\\text{island}}}{(\\nabla p)_{\\text{background}}}\n$$\nWe can estimate this factor by considering the conservation of heat flux. The radial heat flux is given by $q_r = -\\chi_{\\text{eff}} (\\nabla T)_r$. In steady state, the average flux passing through the island region must be the same as the background flux. Thus, $\\chi_{\\text{eff}} (\\nabla T)_{\\text{island}} \\approx \\chi_{\\perp} (\\nabla T)_{\\text{background}}$. The flattening factor is then $f_{\\text{flat}} \\approx \\chi_{\\perp} / \\chi_{\\text{eff}}$.\n\nThe effective perpendicular diffusivity, $\\chi_{\\text{eff}}$, is the sum of the intrinsic collisional diffusivity $\\chi_{\\perp}$ and an enhancement, $\\Delta\\chi$, due to transport along the perturbed magnetic field lines: $\\chi_{\\text{eff}} = \\chi_{\\perp} + \\Delta\\chi$. This enhancement can be estimated from kinetic or fluid models. A widely used scaling argument, based on the geometry of a sheared magnetic field, relates $\\Delta\\chi$ to the parallel diffusivity $\\chi_{\\parallel}$ and the characteristic pitch of the perturbed field lines, which scales as $w/L_s$:\n$$\n\\Delta\\chi \\sim \\chi_{\\parallel} \\left( \\frac{w}{L_s} \\right)^2\n$$\nHere, $L_s$ is the magnetic shear length. Substituting this into the expression for $\\chi_{\\text{eff}}$ yields:\n$$\n\\chi_{\\text{eff}} \\approx \\chi_{\\perp} + \\chi_{\\parallel} \\left( \\frac{w}{L_s} \\right)^2\n$$\nThe flattening factor, evaluated at the saturated island width $w_{\\text{sat}}$, becomes:\n$$\nf_{\\text{flat}} = \\frac{\\chi_{\\perp}}{\\chi_{\\perp} + \\chi_{\\parallel} \\left(\\frac{w_{\\text{sat}}}{L_s}\\right)^2} = \\frac{1}{1 + \\frac{\\chi_{\\parallel}}{\\chi_{\\perp}} \\left(\\frac{w_{\\text{sat}}}{L_s}\\right)^2}\n$$\nThis expression quantifies the degree of pressure profile flattening as a function of the transport anisotropy ratio $\\chi_{\\parallel}/\\chi_{\\perp}$ and the normalized saturated island size $w_{\\text{sat}}/L_s$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the saturated island width and pressure flattening factor\n    in a tokamak edge plasma under the influence of Resonant Magnetic Perturbations.\n    \"\"\"\n\n    # Define physical constant\n    MU_0 = 4 * np.pi * 1e-7  # Vacuum permeability in H/m\n\n    # Test suite from the problem statement\n    # Each case: (eta, delta_prime, beta, b_mn, B, n_i, m_i, epsilon, L_s, chi_parallel, chi_perp)\n    test_cases = [\n        # 1. Happy path\n        (1e-6, 2.0, 5e4, 1e-4, 2.0, 1e19, 3.345e-27, 1e-6, 0.5, 1e8, 1.0),\n        # 2. Low resistivity, moderate RMP\n        (1e-7, 3.0, 1e5, 5e-4, 2.5, 8e19, 3.345e-27, 8e-7, 0.4, 5e8, 0.5),\n        # 3. Higher resistivity and strong RMP but large damping\n        (5e-6, 1.0, 2e5, 2e-3, 1.8, 1e20, 3.345e-27, 1e-6, 0.6, 1e8, 1.0),\n        # 4. Near marginal stability, weak RMP, moderate damping\n        (2e-7, 0.1, 4e4, 1e-5, 2.0, 5e19, 3.345e-27, 3e-6, 0.3, 1e9, 1.5),\n        # 5. Strong tearing drive, weak damping, extreme anisotropy\n        (1e-6, 5.0, 1e4, 1e-3, 3.0, 2e19, 3.345e-27, 5e-7, 0.4, 1e9, 0.2),\n    ]\n\n    results = []\n\n    def round_to_sig_figs(x, sig_figs):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        if not np.isfinite(x):\n            return x\n        return round(x, sig_figs - int(np.floor(np.log10(abs(x)))) - 1)\n\n    for case in test_cases:\n        # Unpack parameters for clarity\n        eta, delta_prime, beta, b_mn, B, n_i, m_i, epsilon, L_s, chi_parallel, chi_perp = case\n\n        # --- Step 1: Calculate Saturated Island Width (w_sat) ---\n\n        # Mass density (rho = n_i * m_i)\n        rho = n_i * m_i\n\n        # Alfvén speed (v_A = B / sqrt(mu_0 * rho))\n        v_A = B / np.sqrt(MU_0 * rho)\n\n        # Rutherford tearing drive term (m/s)\n        tearing_drive = (eta * delta_prime) / MU_0\n\n        # RMP drive term (m/s)\n        rmp_drive = epsilon * v_A * b_mn\n\n        # Calculate saturated island half-width (w_sat) in meters\n        # w_sat = (1/beta) * (tearing_drive + rmp_drive)\n        # Island width must be non-negative.\n        w_sat = max(0.0, (tearing_drive + rmp_drive) / beta)\n\n        # --- Step 2: Calculate Pressure Flattening Factor (f_flat) ---\n\n        # Avoid division by zero if chi_perp or L_s is zero\n        if chi_perp == 0 or L_s == 0:\n             # If no perpendicular transport, flattening is total (f_flat=0)\n             # If L_s is zero, the model breaks down, but island term dominates\n            f_flat = 0.0\n        else:\n            # Transport anisotropy ratio\n            anisotropy_ratio = chi_parallel / chi_perp\n            \n            # Normalized island width squared\n            norm_w_sq = (w_sat / L_s)**2\n            \n            # Dimensionless flattening factor\n            # f_flat = 1 / (1 + (chi_par/chi_perp) * (w_sat/L_s)^2)\n            f_flat = 1.0 / (1.0 + anisotropy_ratio * norm_w_sq)\n\n        # --- Step 3: Round results to six significant figures ---\n        w_sat_rounded = round_to_sig_figs(w_sat, 6)\n        f_flat_rounded = round_to_sig_figs(f_flat, 6)\n        \n        results.append([w_sat_rounded, f_flat_rounded])\n    \n    # Final print statement in the exact required format.\n    print(f\"[[{w_sat_rounded_1},{f_flat_rounded_1}],[{w_sat_rounded_2},{f_flat_rounded_2}],[{w_sat_rounded_3},{f_flat_rounded_3}],[{w_sat_rounded_4},{f_flat_rounded_4}],[{w_sat_rounded_5},{f_flat_rounded_5}]]\".replace(\"'\", \"\")\n          .replace(\"e-05\", \"e-05\")\n          .replace(\"e-06\", \"e-06\")\n          .replace(\"e-04\", \"e-04\"))\n    \n    # Manually formatting the string to avoid any scientific notation issues across platforms\n    # and to ensure the output matches expected formatting.\n    output_str = \"[\"\n    for i, res in enumerate(results):\n        w = \"{:.6g}\".format(res[0])\n        f = \"{:.6g}\".format(res[1])\n        output_str += f\"[{w},{f}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}