{
    "hands_on_practices": [
        {
            "introduction": "理解边缘局域模（ELM）控制必要性的第一步，是量化其带来的工程挑战。本练习将引导您完成一个基础的、基于第一性原理的计算，用以估算大型ELM在偏滤器靶板上产生的巨大瞬态热通量。通过将计算结果与材料的工程极限直接比较，您将能深刻体会到ELM控制技术所要解决问题的严峻性。",
            "id": "3972241",
            "problem": "一个处于高约束模式的托卡马克等离子体经历了一次边界局域模 (ELM)，导致能量迅速释放到偏滤器。假设 ELM 的能量损失为 $\\Delta W$，并且这些能量在特征沉积时间 $\\Delta t$ 内沉积在湿润的偏滤器面积 $A_{\\mathrm{wetted}}$ 上。边界输运与外加的共振磁扰动 (RMP) 相耦合，RMP 通过增强跨场输运和打击点分裂来扩大湿润面积。一个与刮削层输运耦合的非线性磁流体力学模拟，预测了当前放电阶段的 $A_{\\mathrm{wetted}}$。仅使用能量守恒和热通量的定义，将 ELM 期间的瞬态热通量建模为在时间间隔 $\\Delta t$ 内近似均匀，在面积 $A_{\\mathrm{wetted}}$ 上近似均匀（平顶近似）。\n\n给定以下情景：\n- ELM 能量损失 $\\Delta W = 2.4\\times 10^{5}\\ \\mathrm{J}$，\n- 沉积时间 $\\Delta t = 8.0\\times 10^{-4}\\ \\mathrm{s}$，\n- 湿润面积 $A_{\\mathrm{wetted}} = 0.60\\ \\mathrm{m}^{2}$，\n- 偏滤器材料（钨）对于毫秒级负载的工程瞬态热通量设计极限 $q_{\\lim} = 6.0\\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$，\n\n根据第一性原理，推导在平顶近似下偏滤器峰值热通量 $q_{\\mathrm{peak}}$ 的表达式。然后，量化超出因子 $f \\equiv q_{\\mathrm{peak}}/q_{\\lim}$。\n\n仅报告超出因子 $f$ 作为最终答案。将答案四舍五入到三位有效数字。最终答案是无量纲的（没有单位）。",
            "solution": "所述问题具有科学依据，提法明确，并包含了获得唯一解所需的所有信息。所描述的情景是聚变反应堆工程中的一个标准问题，涉及面向等离子体部件上瞬态热负荷的管理。因此，我们可以直接进行推导和计算。\n\n任务是推导在边界局域模 (ELM) 事件期间偏滤器上的峰值热通量 $q_{\\mathrm{peak}}$ 的表达式，然后计算其与给定工程极限的比值。推导从第一性原理开始：功率和热通量的定义，并受平顶近似的约束。\n\n功率 $P$ 定义为能量传输的速率，即 $P = \\frac{dE}{dt}$。问题陈述，ELM 期间的总能量损失为 $\\Delta W$，且该能量在特征时间 $\\Delta t$ 内沉积。“平顶”近似假定此能量沉积以恒定速率发生。因此，在 ELM 期间传递到偏滤器的功率是恒定的，可以表示为：\n$$\nP = \\frac{\\Delta W}{\\Delta t}\n$$\n\n热通量 $q$ 定义为单位面积的功率，即 $q = \\frac{P}{A}$。平顶近似进一步假定此功率均匀沉积在湿润面积 $A_{\\mathrm{wetted}}$ 上。在此假设下，该区域的热通量是恒定的。这个恒定的热通量就是峰值热通量 $q_{\\mathrm{peak}}$。\n$$\nq_{\\mathrm{peak}} = \\frac{P}{A_{\\mathrm{wetted}}}\n$$\n\n通过将功率 $P$ 的表达式代入热通量方程，我们从第一性原理推导出所需的峰值热通量表达式：\n$$\nq_{\\mathrm{peak}} = \\frac{\\left(\\frac{\\Delta W}{\\Delta t}\\right)}{A_{\\mathrm{wetted}}} = \\frac{\\Delta W}{A_{\\mathrm{wetted}} \\Delta t}\n$$\n\n现在，我们将提供的数值代入此表达式，以求出峰值热通量的大小。给定值为：\n- ELM 能量损失：$\\Delta W = 2.4 \\times 10^{5}\\ \\mathrm{J}$\n- 沉积时间：$\\Delta t = 8.0 \\times 10^{-4}\\ \\mathrm{s}$\n- 湿润面积：$A_{\\mathrm{wetted}} = 0.60\\ \\mathrm{m}^{2}$\n\n代入这些值：\n$$\nq_{\\mathrm{peak}} = \\frac{2.4 \\times 10^{5}\\ \\mathrm{J}}{(0.60\\ \\mathrm{m}^{2})(8.0 \\times 10^{-4}\\ \\mathrm{s})}\n$$\n$$\nq_{\\mathrm{peak}} = \\frac{2.4 \\times 10^{5}}{0.48 \\times 10^{-3}}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\n$$\n$$\nq_{\\mathrm{peak}} = \\frac{2.4}{0.48} \\times 10^{5 - (-3)}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\n$$\n$$\nq_{\\mathrm{peak}} = 5.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\n$$\n\n最后一步是计算超出因子 $f$，其定义为峰值热通量与工程设计极限 $q_{\\lim}$ 的比值。\n$$\nf \\equiv \\frac{q_{\\mathrm{peak}}}{q_{\\lim}}\n$$\n给定的工程极限为 $q_{\\lim} = 6.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$。\n代入计算出的 $q_{\\mathrm{peak}}$ 值和给定的 $q_{\\lim}$ 值：\n$$\nf = \\frac{5.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}}{6.0 \\times 10^{8}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}} = \\frac{5.0}{6.0}\n$$\n$$\nf \\approx 0.8333...\n$$\n问题要求将答案四舍五入到三位有效数字。因此，超出因子 $f$ 为 $0.833$。该结果表明，峰值热通量约为偏滤器瞬态设计极限的 $83.3\\%$。",
            "answer": "$$\n\\boxed{0.833}\n$$"
        },
        {
            "introduction": "共振磁扰动（RMP）是控制ELM的主要工具，但施加精确的“正确”磁场并非易事。本练习将深入探讨RMP应用的磁学细节，演示外部线圈产生的目标磁场如何与设备固有的误差场进行线性叠加。您将学习如何将这些场作为复傅里叶分量进行处理，并理解等离子体响应如何进一步改变最终作用于关键有理磁面上的净扰动场。",
            "id": "3972177",
            "problem": "一个大环径比、圆形截面的托卡马克装置，使用共振磁扰动（RMP）线圈来控制边界局域模（ELM）。在所关心的时间尺度上，磁场是准静态的，因此其控制方程为 $\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$，这意味着来自独立电流源的磁场可以线性叠加。在等离子体边界处，相对于平衡环向场归一化的扰动磁场的法向分量，可以按极向角 $\\theta$ 和环向角 $\\phi$ 展开为双傅里叶级数：\n$$\nb_{n}(\\theta,\\phi) = \\sum_{m,n} b_{mn} \\exp\\!\\big(i[m\\theta - n\\phi]\\big),\n$$\n其中 $b_{mn}$ 是 $(m,n)$ 谐波的复傅里叶系数，有理面满足 $q(r_{s}) = m/n$。根据定义，\n$$\nb_{mn} = \\frac{1}{(2\\pi)^{2}} \\int_{0}^{2\\pi}\\!\\!\\int_{0}^{2\\pi} b_{n}(\\theta,\\phi) \\exp\\!\\big(-i[m\\theta - n\\phi]\\big)\\, d\\theta\\, d\\phi.\n$$\n由于线性，真空谱 $b^{\\mathrm{vac}}_{mn}$ 是预期的 RMP 线圈谱 $b^{\\mathrm{coil}}_{mn}$ 和内禀误差场谱 $b^{\\mathrm{err}}_{mn}$ 的和，每一项都是一个复系数：\n$$\nb^{\\mathrm{vac}}_{mn} = b^{\\mathrm{coil}}_{mn} + b^{\\mathrm{err}}_{mn}.\n$$\n在电阻性等离子体边界中的输运-响应耦合通过一个线性响应算子来修正真空谱，对于每个 $(m,n)$，该算子在此近似为一个标量复因子 $r_{mn} = S_{mn}\\exp(i\\theta_{mn})$，其幅值 $S_{mn}\\in(0,1)$ 和相位 $\\theta_{mn}$ 来自耦合的磁流体动力学-输运计算。因此，有理面上的谱为\n$$\nb^{\\mathrm{net}}_{mn}(r_{s}) = r_{mn}\\, b^{\\mathrm{vac}}_{mn}.\n$$\n考虑两个关键有理面：$(m,n)=(12,3)$ 和 $(m,n)=(16,4)$。预期的 RMP 谱和内禀误差场谱（均已对平衡环向场归一化，并表示为具有幅值和相位的复相量）如下：\n- 对于 $(m,n)=(12,3)$：$b^{\\mathrm{coil}}_{12,3} = 3.5\\times 10^{-3}\\, \\exp(i\\,0)$，以及 $b^{\\mathrm{err}}_{12,3} = 1.0\\times 10^{-3}\\, \\exp\\!\\big(i\\,\\frac{\\pi}{3}\\big)$。\n- 对于 $(m,n)=(16,4)$：$b^{\\mathrm{coil}}_{16,4} = 2.8\\times 10^{-3}\\, \\exp\\!\\big(i\\,\\frac{\\pi}{4}\\big)$，以及 $b^{\\mathrm{err}}_{16,4} = 0.7\\times 10^{-3}\\, \\exp\\!\\big(i\\,\\big(-\\frac{\\pi}{6}\\big)\\big)$。\n\n从包含边界跨场输运的线性电阻层模型导出的输运-响应耦合因子为：\n- $r_{12,3} = S_{12,3}\\exp(i\\theta_{12,3})$，其中 $S_{12,3} = 0.7$ 且 $\\theta_{12,3} = \\frac{\\pi}{8}$，\n- $r_{16,4} = S_{16,4}\\exp(i\\theta_{16,4})$，其中 $S_{16,4} = 0.6$ 且 $\\theta_{16,4} = -\\frac{\\pi}{10}$。\n\n从上述准静态磁场方程和傅里叶定义出发，推导内禀误差场如何通过线性叠加来修正预期的 RMP 谱，然后计算在两个有理面 $(12,3)$ 和 $(16,4)$ 上的幅值 $\\big|b^{\\mathrm{net}}_{mn}(r_{s})\\big|$。所有相位均以弧度为单位。将最终答案表示为一个无量纲行矩阵 $\\begin{pmatrix} \\big|b^{\\mathrm{net}}_{12,3}\\big|  \\big|b^{\\mathrm{net}}_{16,4}\\big| \\end{pmatrix}$，该矩阵已对平衡环向场归一化，并将结果四舍五入到四位有效数字。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于静磁学和等离子体物理学的原理，特别是关于在托卡马克中应用共振磁扰动（RMP）来控制边界局域模（ELM）。该问题设定良好、客观、自洽，并为获得唯一解提供了所有必要的数据。所用的物理模型虽然经过简化，却是该领域的标准表示方法。因此，我们开始求解。\n\n问题要求推导内禀误差场如何修正预期的 RMP 谱，并计算在两个指定的有理面上净扰动磁场的幅值 $\\big|b^{\\mathrm{net}}_{mn}\\big|$。\n\n在相关时间尺度上，磁场的控制方程为准静态磁场方程：\n$$\n\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\n这些是给定电流密度分布 $\\mathbf{J}$ 后，关于磁场 $\\mathbf{B}$ 的线性偏微分方程。线性叠加原理指出，对于线性系统，对多个激励之和的总响应等于对每个单独激励的响应之和。在此背景下，总磁场是由独立电流源产生的场的矢量和。问题考虑了真空扰动场的两个来源：外部 RMP 线圈和由主磁体系统微小缺陷引起的内禀误差场。\n\n用于将场分解为谐波 $b_{mn}$ 的傅里叶变换是一种线性运算。因此，两个场之和的傅里叶系数是它们各自傅里叶系数的和。这直接导出了真空谱的关系式，其中总真空扰动系数 $b^{\\mathrm{vac}}_{mn}$ 是来自 RMP 线圈的系数 $b^{\\mathrm{coil}}_{mn}$ 和来自内禀误差场的系数 $b^{\\mathrm{err}}_{mn}$ 的线性和：\n$$\nb^{\\mathrm{vac}}_{mn} = b^{\\mathrm{coil}}_{mn} + b^{\\mathrm{err}}_{mn}\n$$\n该方程正式描述了内禀误差场如何通过线性叠加来修正预期的 RMP 谱。\n\n等离子体本身会对这种真空扰动做出响应。问题提供了一个线性响应模型，其中有理面上的净场 $b^{\\mathrm{net}}_{mn}(r_{s})$ 通过一个复标量因子 $r_{mn}$ 与真空场相关联：\n$$\nb^{\\mathrm{net}}_{mn}(r_{s}) = r_{mn} \\, b^{\\mathrm{vac}}_{mn}\n$$\n因子 $r_{mn}$ 通过其幅值 $S_{mn} = |r_{mn}|$ 描述了屏蔽（或放大）效应，并通过其幅角 $\\theta_{mn}$ 描述了相移。\n\n我们的目标是计算净场的幅值 $\\big|b^{\\mathrm{net}}_{mn}\\big|$。利用复数幅值的乘法性质：\n$$\n\\big|b^{\\mathrm{net}}_{mn}\\big| = |r_{mn} \\cdot b^{\\mathrm{vac}}_{mn}| = |r_{mn}| \\cdot |b^{\\mathrm{vac}}_{mn}| = S_{mn} \\cdot |b^{\\mathrm{coil}}_{mn} + b^{\\mathrm{err}}_{mn}|\n$$\n为了求出以极坐标形式给出的两个复数 $z_1 = A\\exp(i\\alpha)$ 和 $z_2 = B\\exp(i\\beta)$ 之和的幅值，我们可以使用一个等效于矢量加法余弦定理的公式：\n$$\n|z_1 + z_2| = \\sqrt{A^2 + B^2 + 2AB\\cos(\\alpha - \\beta)}\n$$\n我们将此公式应用于两个指定的谐波。\n\n**对 $(m,n)=(12,3)$ 的计算**\n\n给定数据为：\n- $b^{\\mathrm{coil}}_{12,3} = 3.5\\times 10^{-3}\\, \\exp(i\\,0)$\n- $b^{\\mathrm{err}}_{12,3} = 1.0\\times 10^{-3}\\, \\exp\\big(i\\,\\frac{\\pi}{3}\\big)$\n- $S_{12,3} = 0.7$\n\n我们确定幅值公式中的各项：\n$A = 3.5\\times 10^{-3}$，$B = 1.0\\times 10^{-3}$，$\\alpha = 0$，以及 $\\beta = \\frac{\\pi}{3}$。\n相位差为 $\\alpha - \\beta = 0 - \\frac{\\pi}{3} = -\\frac{\\pi}{3}$。\n\n首先，我们计算真空场谱的幅值 $|b^{\\mathrm{vac}}_{12,3}|$：\n$$\n|b^{\\mathrm{vac}}_{12,3}|^2 = (3.5\\times 10^{-3})^2 + (1.0\\times 10^{-3})^2 + 2(3.5\\times 10^{-3})(1.0\\times 10^{-3})\\cos\\left(-\\frac{\\pi}{3}\\right)\n$$\n由于 $\\cos(-x) = \\cos(x)$ 且 $\\cos(\\frac{\\pi}{3})=\\frac{1}{2}$：\n$$\n|b^{\\mathrm{vac}}_{12,3}|^2 = (12.25\\times 10^{-6}) + (1.0\\times 10^{-6}) + (7.0\\times 10^{-6})\\left(\\frac{1}{2}\\right)\n$$\n$$\n|b^{\\mathrm{vac}}_{12,3}|^2 = (12.25 + 1.0 + 3.5) \\times 10^{-6} = 16.75 \\times 10^{-6}\n$$\n$$\n|b^{\\mathrm{vac}}_{12,3}| = \\sqrt{16.75} \\times 10^{-3} \\approx 4.092676 \\times 10^{-3}\n$$\n现在，我们计算包含等离子体响应的净场的幅值：\n$$\n\\big|b^{\\mathrm{net}}_{12,3}\\big| = S_{12,3} \\cdot |b^{\\mathrm{vac}}_{12,3}| = 0.7 \\times (4.092676 \\times 10^{-3}) \\approx 2.864873 \\times 10^{-3}\n$$\n\n**对 $(m,n)=(16,4)$ 的计算**\n\n给定数据为：\n- $b^{\\mathrm{coil}}_{16,4} = 2.8\\times 10^{-3}\\, \\exp\\big(i\\,\\frac{\\pi}{4}\\big)$\n- $b^{\\mathrm{err}}_{16,4} = 0.7\\times 10^{-3}\\, \\exp\\big(i\\,(-\\frac{\\pi}{6})\\big)$\n- $S_{16,4} = 0.6$\n\n我们确定各项：\n$A = 2.8\\times 10^{-3}$，$B = 0.7\\times 10^{-3}$，$\\alpha = \\frac{\\pi}{4}$，以及 $\\beta = -\\frac{\\pi}{6}$。\n相位差为 $\\alpha - \\beta = \\frac{\\pi}{4} - (-\\frac{\\pi}{6}) = \\frac{3\\pi}{12} + \\frac{2\\pi}{12} = \\frac{5\\pi}{12}$。\n\n首先，我们计算真空场谱的幅值 $|b^{\\mathrm{vac}}_{16,4}|$：\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 = (2.8\\times 10^{-3})^2 + (0.7\\times 10^{-3})^2 + 2(2.8\\times 10^{-3})(0.7\\times 10^{-3})\\cos\\left(\\frac{5\\pi}{12}\\right)\n$$\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 = (7.84\\times 10^{-6}) + (0.49\\times 10^{-6}) + (3.92\\times 10^{-6})\\cos\\left(\\frac{5\\pi}{12}\\right)\n$$\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 = \\left(8.33 + 3.92 \\cos\\left(\\frac{5\\pi}{12}\\right)\\right) \\times 10^{-6}\n$$\n$\\cos\\left(\\frac{5\\pi}{12}\\right)$ 的值为 $\\frac{\\sqrt{6}-\\sqrt{2}}{4} \\approx 0.258819$。\n$$\n|b^{\\mathrm{vac}}_{16,4}|^2 \\approx (8.33 + 3.92 \\times 0.258819) \\times 10^{-6} \\approx (8.33 + 1.014543) \\times 10^{-6} \\approx 9.344543 \\times 10^{-6}\n$$\n$$\n|b^{\\mathrm{vac}}_{16,4}| = \\sqrt{9.344543} \\times 10^{-3} \\approx 3.056884 \\times 10^{-3}\n$$\n现在，我们计算净场的幅值：\n$$\n\\big|b^{\\mathrm{net}}_{16,4}\\big| = S_{16,4} \\cdot |b^{\\mathrm{vac}}_{16,4}| = 0.6 \\times (3.056884 \\times 10^{-3}) \\approx 1.834130 \\times 10^{-3}\n$$\n\n**最终结果**\n\n问题要求将结果四舍五入到四位有效数字，并以行矩阵的形式呈现。\n对于 $(m,n)=(12,3)$：$\\big|b^{\\mathrm{net}}_{12,3}\\big| \\approx 2.864873 \\times 10^{-3} \\to 2.865 \\times 10^{-3}$。\n对于 $(m,n)=(16,4)$：$\\big|b^{\\mathrm{net}}_{16,4}\\big| \\approx 1.834130 \\times 10^{-3} \\to 1.834 \\times 10^{-3}$。\n\n最终答案是行矩阵 $\\begin{pmatrix} \\big|b^{\\mathrm{net}}_{12,3}\\big|  \\big|b^{\\mathrm{net}}_{16,4}\\big| \\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.865 \\times 10^{-3}  1.834 \\times 10^{-3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "解开谜题的最后一步是理解RMP究竟*如何*影响等离子体以控制ELM。本计算练习将指导您使用卢瑟福方程，基于净磁扰动来模拟磁岛的形成过程。接着，您将把最终的磁岛宽度与其主要的输运效应联系起来——即由于沿磁力线的快速热传导导致的局部压力分布平坦化，这是实现ELM抑制的关键物理机制。",
            "id": "3972226",
            "problem": "托卡马克边界局域模（ELM）控制系统通常采用共振磁扰动（RMP）来影响有理磁面附近的输运，这些有理磁面处可以形成磁岛。在非线性电阻性区域，磁岛半宽度的演化遵循电阻性磁流体力学（MHD）规律，并与局域热输运耦合，导致磁岛内部的压强梯度平坦化。构建一个程序，该程序针对指定的物理上合理的参数，计算饱和磁岛宽度，并评估因沿磁岛磁通面的平行热传导而引起的局域压强平坦化程度。\n\n出发点和假设：\n- 使用电阻性磁流体力学（MHD），包括欧姆定律 $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J} $ 和磁感应方程 $ \\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B} - \\eta \\mathbf{J}) $。确定磁扩散系数 $ D_m \\equiv \\eta / \\mu_0 $，其中 $ \\mu_0 $ 是真空磁导率。\n- 在非线性Rutherford区域，撕裂模的增长由稳定性指数 $ \\Delta' $（外部区域匹配参数）控制，磁岛半宽度 $ w $ 的演化由电阻率和任何外部施加的共振磁场驱动。假设一个有效的线性阻尼率 $ \\beta $，该阻尼率包含了极化电流、曲率稳定化和剪切 $ \\mathbf{E}\\times\\mathbf{B} $ 流效应。\n- 将外部RMP驱动建模为产生一个Alfvén响应，其特征速度为 $ v_A $，并由一个小的无量纲耦合系数 $ \\epsilon $ 和共振谐波振幅 $ b_{mn} $ 进行缩放。\n- 对于磁岛内部的热输运，考虑沿磁力线和垂直于磁力线的稳态各向异性扩散模型，其平行和垂直热扩散系数分别为 $ \\chi_{\\parallel} $ 和 $ \\chi_{\\perp} $，磁剪切长度为 $ L_s $。使用针对螺旋磁岛中平行平坦化的有理磁面局域化标度论证，构建一个无量纲参数来量化压强平坦化的程度。\n\n任务：\n- 根据上述基本定律和定义，基于电阻性增长、外部RMP驱动和有效阻尼之间的稳态平衡，推导出饱和宽度 $ w_{\\text{sat}} $。然后，在由平行传导主导的各向异性输运条件下，推导出一个无量纲平坦化因子 $ f_{\\text{flat}} $，该因子表示磁岛内部的局域压强梯度与背景压强梯度之比。\n- 将这些推导实现为代码中的确定性计算，该代码接收以下参数，并为每种情况输出数对 $ [w_{\\text{sat}}, f_{\\text{flat}}] $。\n\n定义和单位：\n- 真空磁导率 $ \\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m} $。\n- 电阻率 $ \\eta $ 单位为 $ \\Omega\\cdot\\mathrm{m} $。\n- 稳定性指数 $ \\Delta' $ 单位为 $ \\mathrm{m}^{-1} $。\n- 阻尼率 $ \\beta $ 单位为 $ \\mathrm{s}^{-1} $。\n- 共振磁场振幅 $ b_{mn} $ 是无量纲的（归一化到局域平衡场）。\n- 磁场强度 $ B $ 单位为 $ \\mathrm{T} $。\n- 离子数密度 $ n_i $ 单位为 $ \\mathrm{m}^{-3} $，离子质量 $ m_i $ 单位为 $ \\mathrm{kg} $；质量密度 $ \\rho = n_i m_i $ 单位为 $ \\mathrm{kg/m^3} $。\n- Alfvén速度 $ v_A = B / \\sqrt{\\mu_0 \\rho} $ 单位为 $ \\mathrm{m/s} $。\n- RMP耦合系数 $ \\epsilon $ 是无量纲的。\n- 磁剪切长度 $ L_s $ 单位为 $ \\mathrm{m} $。\n- 热扩散系数 $ \\chi_{\\parallel} $ 和 $ \\chi_{\\perp} $ 单位为 $ \\mathrm{m^2/s} $。\n\n输出规格：\n- 将饱和磁岛宽度 $ w_{\\text{sat}} $ 以 $ \\mathrm{m} $ 为单位表示，将平坦化因子 $ f_{\\text{flat}} $ 表示为小数（无单位分数）。\n- 对于每个测试用例，将两个数字都四舍五入到六位有效数字。\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个元素是对应一个案例的由两个数字组成的列表 $ [w_{\\text{sat}}, f_{\\text{flat}}] $ （例如，$ [[w_1,f_1],[w_2,f_2],\\dots] $）。\n\n测试套件：\n使用以下参数集。每个案例指定为 $ (\\eta, \\Delta', \\beta, b_{mn}, B, n_i, m_i, \\epsilon, L_s, \\chi_{\\parallel}, \\chi_{\\perp}) $，所有值都使用各自的单位。\n\n1. 正常情况：\n   $ \\eta = 1\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 2\\,\\mathrm{m}^{-1},\\quad \\beta = 5\\times 10^{4}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 1\\times 10^{-4}, $\n   $ B = 2\\,\\mathrm{T},\\quad n_i = 1\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 1\\times 10^{-6}, $\n   $ L_s = 0.5\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{8}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 1.0\\,\\mathrm{m^2/s}. $\n\n2. 低电阻率，中等RMP：\n   $ \\eta = 1\\times 10^{-7}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 3\\,\\mathrm{m}^{-1},\\quad \\beta = 1\\times 10^{5}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 5\\times 10^{-4}, $\n   $ B = 2.5\\,\\mathrm{T},\\quad n_i = 8\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 8\\times 10^{-7}, $\n   $ L_s = 0.4\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 5\\times 10^{8}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 0.5\\,\\mathrm{m^2/s}. $\n\n3. 较高电阻率和强RMP，但阻尼较大：\n   $ \\eta = 5\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 1\\,\\mathrm{m}^{-1},\\quad \\beta = 2\\times 10^{5}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 2\\times 10^{-3}, $\n   $ B = 1.8\\,\\mathrm{T},\\quad n_i = 1\\times 10^{20}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 1\\times 10^{-6}, $\n   $ L_s = 0.6\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{8}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 1.0\\,\\mathrm{m^2/s}. $\n\n4. 接近边缘稳定（$ \\Delta' $较小），弱RMP，中等阻尼：\n   $ \\eta = 2\\times 10^{-7}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 0.1\\,\\mathrm{m}^{-1},\\quad \\beta = 4\\times 10^{4}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 1\\times 10^{-5}, $\n   $ B = 2.0\\,\\mathrm{T},\\quad n_i = 5\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 3\\times 10^{-6}, $\n   $ L_s = 0.3\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{9}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 1.5\\,\\mathrm{m^2/s}. $\n\n5. 强撕裂驱动，弱阻尼，极端各向异性：\n   $ \\eta = 1\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m},\\quad \\Delta' = 5\\,\\mathrm{m}^{-1},\\quad \\beta = 1\\times 10^{4}\\,\\mathrm{s}^{-1},\\quad b_{mn} = 1\\times 10^{-3}, $\n   $ B = 3.0\\,\\mathrm{T},\\quad n_i = 2\\times 10^{19}\\,\\mathrm{m}^{-3},\\quad m_i = 3.345\\times 10^{-27}\\,\\mathrm{kg},\\quad \\epsilon = 5\\times 10^{-7}, $\n   $ L_s = 0.4\\,\\mathrm{m},\\quad \\chi_{\\parallel} = 1\\times 10^{9}\\,\\mathrm{m^2/s},\\quad \\chi_{\\perp} = 0.2\\,\\mathrm{m^2/s}. $",
            "solution": "此问题经评估是有效的。其科学基础建立在电阻性磁流体力学和等离子体输运理论的既定原理之上，特别是关于撕裂模演化的Rutherford模型和磁岛内部压强剖面平坦化的概念。该问题提法恰当，为推导所需量和进行计算提供了一套物理上合理的参数。这是一个与计算聚变科学直接相关的客观、可形式化的问题。\n\n求解过程首先推导饱和磁岛宽度 $w_{\\text{sat}}$ 和压强平坦化因子 $f_{\\text{flat}}$ 的解析表达式，然后实现这些公式以计算给定测试用例的结果。\n\n**1. 饱和磁岛宽度（$w_{\\text{sat}}$）的推导**\n\n磁岛半宽度 $w$ 的演化由一个广义Rutherford方程描述，该方程模拟了共振磁面上各种相互竞争的物理效应之间的平衡。问题指定了对磁岛宽度变化率 $\\frac{dw}{dt}$ 的三个主要贡献：一个电阻性增长项，一个来自共振磁扰动（RMP）的外部驱动项，以及一个有效阻尼项。我们可以将演化方程写为：\n$$\n\\frac{dw}{dt} = (\\text{撕裂驱动}) + (\\text{RMP驱动}) - (\\text{阻尼})\n$$\n我们根据所提供的物理描述对每一项进行建模：\n\n- **撕裂驱动**：在非线性Rutherford区域中，撕裂模的内禀增长是由磁场中的自由能驱动的，该自由能由稳定性指数 $\\Delta'$ 量化。增长率与磁扩散系数 $D_m = \\eta / \\mu_0$ 成正比，其中 $\\eta$ 是等离子体电阻率，$\\mu_0$ 是真空磁导率。该驱动项由下式给出：\n  $$ (\\text{撕裂驱动}) = k_R \\frac{\\eta}{\\mu_0} \\Delta' $$\n  其中 $k_R$ 是一个量级为1的数值系数。在此类模型中，当该系数未明确给出时，通常假设 $k_R=1$。这得到的驱动项为 $\\frac{\\eta \\Delta'}{\\mu_0}$。\n\n- **阻尼**：问题指出存在一个有效线性阻尼率 $\\beta$（单位为 $s^{-1}$），它包含了诸如极化电流、磁力线曲率和剪切 $\\mathbf{E}\\times\\mathbf{B}$ 流等稳定化效应。线性阻尼率意味着阻尼项与磁岛宽度本身成正比。为确保量纲一致性（该项的单位必须是速度单位 $\\mathrm{m/s}$），此项被建模为：\n  $$ (\\text{阻尼}) = \\beta w $$\n\n- **RMP驱动**：外部RMP被描述为产生一个Alfvén响应。该驱动项由Alfvén速度 $v_A$、无量纲耦合系数 $\\epsilon$ 和无量纲共振谐波振幅 $b_{mn}$ 进行缩放。Alfvén速度定义为 $v_A = B / \\sqrt{\\mu_0 \\rho}$，其中 $B$ 是磁场强度，$\\rho = n_i m_i$ 是离子质量密度。此驱动项作为一个恒定增长速度的量纲一致的公式为：\n  $$ (\\text{RMP驱动}) = \\epsilon v_A b_{mn} $$\n  这假设了来自外部扰动的直接、恒定速率的驱动。\n\n结合这些项，完整的磁岛演化方程变为：\n$$\n\\frac{dw}{dt} = \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn} - \\beta w\n$$\n当磁岛宽度停止变化时，即 $\\frac{dw}{dt} = 0$，达到饱和。我们可以解出饱和磁岛半宽度 $w_{\\text{sat}}$：\n$$\n0 = \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn} - \\beta w_{\\text{sat}}\n$$\n$$\n\\beta w_{\\text{sat}} = \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn}\n$$\n这给出了饱和磁岛宽度的最终表达式：\n$$\nw_{\\text{sat}} = \\frac{1}{\\beta} \\left( \\frac{\\eta \\Delta'}{\\mu_0} + \\epsilon v_A b_{mn} \\right)\n$$\n由于磁岛宽度必须为非负量，如果净驱动为负（即阻尼和内禀稳定性克服了RMP驱动），则不会形成磁岛，且 $w_{\\text{sat}}=0$。然而，对于所有给定的测试用例，$\\Delta' > 0$，确保了 $w_{\\text{sat}} > 0$。\n\n**2. 压强平坦化因子（$f_{\\text{flat}}$）的推导**\n\n磁岛的形成极大地改变了局域磁拓扑结构。与缓慢的跨磁力线扩散相比，热量和粒子可以非常迅速地沿磁力线传播。这种输运各向异性的特征是 $\\chi_{\\parallel} \\gg \\chi_{\\perp}$。在磁岛内部，螺旋磁力线将先前在径向上分离的区域连接起来，为平行输运创造了一条“短路”。这导致每个内部磁通面上的温度（以及压强，假设在小磁岛上 $p \\propto nT$ 且密度剖面相对平坦）达到平衡。结果，跨越磁岛的平均径向压强梯度 $(\\nabla p)_{\\text{island}}$ 与背景梯度 $(\\nabla p)_{\\text{background}}$ 相比显著减小。\n\n无量纲平坦化因子 $f_{\\text{flat}}$ 定义为这些梯度的比值：\n$$\nf_{\\text{flat}} = \\frac{(\\nabla p)_{\\text{island}}}{(\\nabla p)_{\\text{background}}}\n$$\n我们可以通过考虑热通量守恒来估计这个因子。径向热通量由 $q_r = -\\chi_{\\text{eff}} (\\nabla T)_r$ 给出。在稳态下，通过磁岛区域的平均通量必须与背景通量相同。因此，$\\chi_{\\text{eff}} (\\nabla T)_{\\text{island}} \\approx \\chi_{\\perp} (\\nabla T)_{\\text{background}}$。平坦化因子则为 $f_{\\text{flat}} \\approx \\chi_{\\perp} / \\chi_{\\text{eff}}$。\n\n有效垂直扩散系数 $\\chi_{\\text{eff}}$ 是内禀碰撞扩散系数 $\\chi_{\\perp}$ 和由于沿扰动磁力线输运引起的增强项 $\\Delta\\chi$ 的总和：$\\chi_{\\text{eff}} = \\chi_{\\perp} + \\Delta\\chi$。这个增强项可以从动理学或流体模型中估算。一个广泛使用的、基于剪切磁场几何的标度论证将 $\\Delta\\chi$ 与平行扩散系数 $\\chi_{\\parallel}$ 以及扰动磁力线的特征螺距联系起来，其标度为 $w/L_s$：\n$$\n\\Delta\\chi \\sim \\chi_{\\parallel} \\left( \\frac{w}{L_s} \\right)^2\n$$\n此处，$L_s$ 是磁剪切长度。将此代入 $\\chi_{\\text{eff}}$ 的表达式中，可得：\n$$\n\\chi_{\\text{eff}} \\approx \\chi_{\\perp} + \\chi_{\\parallel} \\left( \\frac{w}{L_s} \\right)^2\n$$\n在饱和磁岛宽度 $w_{\\text{sat}}$ 处取值的平坦化因子变为：\n$$\nf_{\\text{flat}} = \\frac{\\chi_{\\perp}}{\\chi_{\\perp} + \\chi_{\\parallel} \\left(\\frac{w_{\\text{sat}}}{L_s}\\right)^2} = \\frac{1}{1 + \\frac{\\chi_{\\parallel}}{\\chi_{\\perp}} \\left(\\frac{w_{\\text{sat}}}{L_s}\\right)^2}\n$$\n该表达式将压强剖面平坦化的程度量化为输运各向异性比 $\\chi_{\\parallel}/\\chi_{\\perp}$ 和归一化的饱和磁岛尺寸 $w_{\\text{sat}}/L_s$ 的函数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the saturated island width and pressure flattening factor\n    in a tokamak edge plasma under the influence of Resonant Magnetic Perturbations.\n    \"\"\"\n\n    # Define physical constant\n    MU_0 = 4 * np.pi * 1e-7  # Vacuum permeability in H/m\n\n    # Test suite from the problem statement\n    # Each case: (eta, delta_prime, beta, b_mn, B, n_i, m_i, epsilon, L_s, chi_parallel, chi_perp)\n    test_cases = [\n        # 1. Normal case\n        (1e-6, 2.0, 5e4, 1e-4, 2.0, 1e19, 3.345e-27, 1e-6, 0.5, 1e8, 1.0),\n        # 2. Low resistivity, moderate RMP\n        (1e-7, 3.0, 1e5, 5e-4, 2.5, 8e19, 3.345e-27, 8e-7, 0.4, 5e8, 0.5),\n        # 3. Higher resistivity and strong RMP, but large damping\n        (5e-6, 1.0, 2e5, 2e-3, 1.8, 1e20, 3.345e-27, 1e-6, 0.6, 1e8, 1.0),\n        # 4. Near marginal stability, weak RMP, moderate damping\n        (2e-7, 0.1, 4e4, 1e-5, 2.0, 5e19, 3.345e-27, 3e-6, 0.3, 1e9, 1.5),\n        # 5. Strong tearing drive, weak damping, extreme anisotropy\n        (1e-6, 5.0, 1e4, 1e-3, 3.0, 2e19, 3.345e-27, 5e-7, 0.4, 1e9, 0.2),\n    ]\n\n    results = []\n\n    def round_to_sig_figs(x, sig_figs):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        return round(x, sig_figs - int(np.floor(np.log10(abs(x)))) - 1)\n\n    for case in test_cases:\n        # Unpack parameters for clarity\n        eta, delta_prime, beta, b_mn, B, n_i, m_i, epsilon, L_s, chi_parallel, chi_perp = case\n\n        # --- Step 1: Calculate Saturated Island Width (w_sat) ---\n\n        # Mass density (rho = n_i * m_i)\n        rho = n_i * m_i\n\n        # Alfvén speed (v_A = B / sqrt(mu_0 * rho))\n        v_A = B / np.sqrt(MU_0 * rho)\n\n        # Rutherford tearing drive term (m/s)\n        tearing_drive = (eta * delta_prime) / MU_0\n\n        # RMP drive term (m/s)\n        rmp_drive = epsilon * v_A * b_mn\n\n        # Calculate saturated island half-width (w_sat) in meters\n        # w_sat = (1/beta) * (tearing_drive + rmp_drive)\n        # Island width must be non-negative.\n        w_sat = max(0.0, (tearing_drive + rmp_drive) / beta)\n\n        # --- Step 2: Calculate Pressure Flattening Factor (f_flat) ---\n\n        # Avoid division by zero if chi_perp or L_s is zero\n        if chi_perp == 0 or L_s == 0:\n             # If no perpendicular transport, flattening is total (f_flat=0)\n             # If L_s is zero, the model breaks down, but island term dominates\n            f_flat = 0.0\n        else:\n            # Transport anisotropy ratio\n            anisotropy_ratio = chi_parallel / chi_perp\n            \n            # Normalized island width squared\n            norm_w_sq = (w_sat / L_s)**2\n            \n            # Dimensionless flattening factor\n            # f_flat = 1 / (1 + (chi_par/chi_perp) * (w_sat/L_s)^2)\n            f_flat = 1.0 / (1.0 + anisotropy_ratio * norm_w_sq)\n\n        # --- Step 3: Round results to six significant figures ---\n        w_sat_rounded = round_to_sig_figs(w_sat, 6)\n        f_flat_rounded = round_to_sig_figs(f_flat, 6)\n        \n        results.append([w_sat_rounded, f_flat_rounded])\n    \n    # Final print statement in the exact required format.\n    print(f\"[[{results[0][0]}, {results[0][1]}],[{results[1][0]}, {results[1][1]}],[{results[2][0]}, {results[2][1]}],[{results[3][0]}, {results[3][1]}],[{results[4][0]}, {results[4][1]}]]\")\n\nsolve()\n```"
        }
    ]
}