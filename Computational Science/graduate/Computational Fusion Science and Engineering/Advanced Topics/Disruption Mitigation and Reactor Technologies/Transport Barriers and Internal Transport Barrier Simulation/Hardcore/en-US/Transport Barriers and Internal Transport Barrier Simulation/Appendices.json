{
    "hands_on_practices": [
        {
            "introduction": "This first practice bridges experimental actuators with fundamental theory by exploring how Neutral Beam Injection (NBI) can drive the formation of an Internal Transport Barrier (ITB). You will derive the threshold torque required to generate a critical $E \\times B$ shearing rate, $\\gamma_E$, sufficient to suppress turbulence. This exercise solidifies the core mechanism of shear-suppressed transport and provides a tangible estimate of the power needed to create an ITB. ",
            "id": "4056882",
            "problem": "In a magnetically confined plasma, internal transport barriers are observed when the electric cross magnetic field (E×B) shearing rate suppresses microturbulent eddies. Consider a simplified cylindrical tokamak model in which neutral beam injection (NBI) drives toroidal rotation that modifies the radial electric field. Assume the following physical model and parameters:\n\n- Magnetic field is dominated by a uniform toroidal component $B_{\\phi}$ with a uniform poloidal component $B_{\\theta}$.\n- The radial electric field $E_{r}$ follows the steady-state ion radial force balance with negligible ion pressure gradient and negligible poloidal flow, so that $E_{r}(r) \\approx V_{\\phi}(r)\\,B_{\\theta}$, where $V_{\\phi}(r)$ is the toroidal flow speed.\n- The local E×B velocity is $v_{E}(r) = E_{r}(r)/B_{\\phi}$, and the E×B shearing rate is defined as $\\gamma_{E}(r) = \\left|\\frac{d v_{E}}{d r}\\right|$.\n- The barrier forms when $\\gamma_{E}$ equals a prescribed linear microinstability growth rate $\\gamma_{c}$, i.e., $\\gamma_{E} = \\gamma_{c}$.\n- In a steady state, a one-dimensional toroidal momentum balance holds in the shear layer of radial width $\\Delta r$, with a momentum source density $S_{\\phi}$ due to NBI torque balancing viscous diffusion of toroidal momentum: $S_{\\phi} \\approx \\rho\\,\\nu_{\\phi}\\,\\frac{d^{2} V_{\\phi}}{d r^{2}}$, where $\\rho = m_{i}\\,n_{i}$ is the ion mass density, $m_{i}$ is the ion mass, $n_{i}$ is the ion number density, and $\\nu_{\\phi}$ is the effective toroidal momentum diffusivity. Use the scale approximation $\\frac{d^{2} V_{\\phi}}{d r^{2}} \\sim \\frac{V_{\\phi}}{\\Delta r^{2}}$ and $\\frac{d V_{\\phi}}{d r} \\sim \\frac{V_{\\phi}}{\\Delta r}$.\n\nGiven the following parameters:\n- $B_{\\phi} = 2.5\\ \\mathrm{T}$,\n- $B_{\\theta} = 0.25\\ \\mathrm{T}$,\n- $\\Delta r = 0.020\\ \\mathrm{m}$,\n- $n_{i} = 7.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$,\n- deuterium ion mass $m_{i} = 3.344 \\times 10^{-27}\\ \\mathrm{kg}$,\n- $\\nu_{\\phi} = 1.2\\ \\mathrm{m}^{2}\\mathrm{s}^{-1}$,\n- $\\gamma_{c} = 8.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$,\n\nderive from first principles an expression for the threshold NBI momentum source density $S_{\\phi}^{\\mathrm{th}}$ required to achieve $\\gamma_{E} = \\gamma_{c}$ in this model, and then compute its numerical value. Express your final answer as a torque density in $\\mathrm{N}\\ \\mathrm{m}^{-3}$ and round to three significant figures.",
            "solution": "The problem statement is valid. The model presented is a simplified but physically self-consistent representation of the mechanism for internal transport barrier formation driven by E×B shear. All necessary parameters and relationships are provided.\n\nThe derivation for the threshold NBI momentum source density, $S_{\\phi}^{\\mathrm{th}}$, proceeds as follows.\n\nFirst, we express the E×B shearing rate, $\\gamma_{E}$, in terms of the toroidal flow speed, $V_{\\phi}(r)$. The E×B velocity, $v_{E}$, is given by:\n$$v_{E}(r) = \\frac{E_{r}(r)}{B_{\\phi}}$$\nThe model provides a simplified radial force balance equation to determine the radial electric field, $E_{r}(r)$:\n$$E_{r}(r) \\approx V_{\\phi}(r)B_{\\theta}$$\nSubstituting the expression for $E_{r}(r)$ into the equation for $v_{E}(r)$, we get:\n$$v_{E}(r) \\approx \\frac{V_{\\phi}(r)B_{\\theta}}{B_{\\phi}}$$\nThe E×B shearing rate, $\\gamma_{E}$, is defined as the magnitude of the radial derivative of $v_{E}(r)$:\n$$\\gamma_{E}(r) = \\left|\\frac{d v_{E}}{d r}\\right|$$\nSince $B_{\\phi}$ and $B_{\\theta}$ are given as uniform, they are treated as constants with respect to the radial coordinate $r$:\n$$\\gamma_{E}(r) = \\left|\\frac{d}{dr}\\left(\\frac{V_{\\phi}(r)B_{\\theta}}{B_{\\phi}}\\right)\\right| = \\frac{B_{\\theta}}{B_{\\phi}}\\left|\\frac{d V_{\\phi}}{d r}\\right|$$\nThe problem specifies using the scale approximation $\\frac{d V_{\\phi}}{d r} \\sim \\frac{V_{\\phi}}{\\Delta r}$ over the shear layer width $\\Delta r$. Applying this, we obtain a scaling relation for $\\gamma_{E}$:\n$$\\gamma_{E} \\sim \\frac{B_{\\theta}}{B_{\\phi}}\\frac{V_{\\phi}}{\\Delta r}$$\n\nAn internal transport barrier is formed when the E×B shearing rate reaches the critical microinstability growth rate, $\\gamma_{c}$. This condition, $\\gamma_{E} = \\gamma_{c}$, defines the threshold toroidal flow speed, $V_{\\phi}^{\\mathrm{th}}$, required for barrier formation.\n$$\\frac{B_{\\theta}}{B_{\\phi}}\\frac{V_{\\phi}^{\\mathrm{th}}}{\\Delta r} = \\gamma_{c}$$\nSolving for $V_{\\phi}^{\\mathrm{th}}$ yields:\n$$V_{\\phi}^{\\mathrm{th}} = \\gamma_{c} \\Delta r \\frac{B_{\\phi}}{B_{\\theta}}$$\n\nNext, we relate the toroidal flow, $V_{\\phi}$, to the momentum source density, $S_{\\phi}$, using the provided toroidal momentum balance equation in a steady state:\n$$S_{\\phi} \\approx \\rho \\nu_{\\phi} \\frac{d^{2} V_{\\phi}}{d r^{2}}$$\nwhere $\\rho = m_{i}n_{i}$ is the ion mass density. We use the scale approximation for the second derivative, $\\frac{d^{2} V_{\\phi}}{d r^{2}} \\sim \\frac{V_{\\phi}}{\\Delta r^{2}}$. The momentum balance equation then becomes:\n$$S_{\\phi} \\sim \\rho \\nu_{\\phi} \\frac{V_{\\phi}}{\\Delta r^{2}}$$\n\nThe threshold momentum source density, $S_{\\phi}^{\\mathrm{th}}$, is the source required to sustain the threshold velocity, $V_{\\phi}^{\\mathrm{th}}$. We find $S_{\\phi}^{\\mathrm{th}}$ by substituting the expression for $V_{\\phi}^{\\mathrm{th}}$ into the scaling relation for $S_{\\phi}$:\n$$S_{\\phi}^{\\mathrm{th}} \\sim \\rho \\nu_{\\phi} \\frac{V_{\\phi}^{\\mathrm{th}}}{\\Delta r^{2}} = \\rho \\nu_{\\phi} \\frac{1}{\\Delta r^{2}} \\left(\\gamma_{c} \\Delta r \\frac{B_{\\phi}}{B_{\\theta}}\\right)$$\nSimplifying this expression gives the final symbolic formula for the threshold momentum source density:\n$$S_{\\phi}^{\\mathrm{th}} = \\frac{\\rho \\nu_{\\phi} \\gamma_{c} B_{\\phi}}{B_{\\theta} \\Delta r}$$\n\nNow, we compute the numerical value of $S_{\\phi}^{\\mathrm{th}}$ using the given parameters. First, we calculate the ion mass density $\\rho$:\n$$\\rho = m_{i} n_{i} = (3.344 \\times 10^{-27}\\ \\mathrm{kg}) \\times (7.5 \\times 10^{19}\\ \\mathrm{m}^{-3}) = 2.508 \\times 10^{-7}\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$$\nSubstituting all numerical values into the expression for $S_{\\phi}^{\\mathrm{th}}$:\n$$B_{\\phi} = 2.5\\ \\mathrm{T}$$\n$$B_{\\theta} = 0.25\\ \\mathrm{T}$$\n$$\\Delta r = 0.020\\ \\mathrm{m}$$\n$$\\nu_{\\phi} = 1.2\\ \\mathrm{m}^{2}\\mathrm{s}^{-1}$$\n$$\\gamma_{c} = 8.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$$\n$$S_{\\phi}^{\\mathrm{th}} = \\frac{(2.508 \\times 10^{-7}\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}) (1.2\\ \\mathrm{m}^{2}\\mathrm{s}^{-1}) (8.0 \\times 10^{4}\\ \\mathrm{s}^{-1}) (2.5\\ \\mathrm{T})}{(0.25\\ \\mathrm{T}) (0.020\\ \\mathrm{m})}$$\nThe units are $(\\mathrm{kg}\\ \\mathrm{m}^{-3}) (\\mathrm{m}^{2}\\mathrm{s}^{-1}) (\\mathrm{s}^{-1}) (\\mathrm{T}) / (\\mathrm{T}\\ \\mathrm{m}) = \\mathrm{kg}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-2}$, which corresponds to $\\mathrm{N}\\ \\mathrm{m}^{-3}$. The term \"torque density\" in the prompt, with specified units of $\\mathrm{N}\\ \\mathrm{m}^{-3}$, refers to this force density.\n$$S_{\\phi}^{\\mathrm{th}} = \\frac{6.0192 \\times 10^{-2}}{0.005} \\ \\mathrm{N}\\ \\mathrm{m}^{-3}$$\n$$S_{\\phi}^{\\mathrm{th}} = 12.0384\\ \\mathrm{N}\\ \\mathrm{m}^{-3}$$\nRounding the result to three significant figures, as requested, gives:\n$$S_{\\phi}^{\\mathrm{th}} \\approx 12.0\\ \\mathrm{N}\\ \\mathrm{m}^{-3}$$",
            "answer": "$$ \\boxed{12.0} $$"
        },
        {
            "introduction": "Moving from a single calculation to a predictive model, this exercise guides you through implementing a simplified quasilinear transport closure. You will compute ion and electron thermal diffusivities, $\\chi_i$ and $\\chi_e$, based on competing drives from microinstabilities and suppression from $E \\times B$ shear. This practice is key to understanding how reduced transport models are constructed and used to explore the parameter space for achieving high-confinement regimes. ",
            "id": "4056830",
            "problem": "Consider a reduced quasilinear transport closure to estimate the ion and electron thermal diffusivities in a tokamak plasma with an Internal Transport Barrier (ITB). The objective is to compute the gyro-Bohm normalized ion and electron thermal diffusivities, denoted by $ \\chi_i $ and $ \\chi_e $, using a simplified quasilinear mixing-length model with shear suppression, given dimensionless inputs $ R/L_T $, $ R/L_n $, $ \\hat{s} $, and $ \\gamma_E $. The task also requires identifying regimes where transport barriers form based on a quantitative criterion.\n\nYour program must implement the following modeling assumptions, derived from first principles and widely used reduced physics closures:\n\n1. Fundamental base and normalization:\n   - The quasilinear diffusivity is estimated by a mixing-length closure, where the decorrelation time is the inverse of an effective growth rate and the radial correlation length is set by the inverse of a characteristic perpendicular wavenumber. This implies a scaling $ \\chi \\sim \\tau_c^{-1} \\ell_c^2 $, where $ \\tau_c $ is a correlation time and $ \\ell_c $ is a correlation length.\n   - Normalize transport in gyro-Bohm units so that the output $ \\chi_i $ and $ \\chi_e $ are dimensionless.\n   - Assume a fixed binormal wavenumber $ k_y \\rho_s = 0.3 $, where $ \\rho_s $ is the ion sound gyroradius. Use this value to set the characteristic diamagnetic frequency scale and perpendicular wavenumber scale.\n   - Model the effective perpendicular wavenumber using magnetic shear dependence as $ k_\\perp \\rho_s = k_y \\rho_s \\sqrt{1 + \\hat{s}^2} $.\n\n2. Linear drive and thresholds:\n   - Two microinstability branches are considered: the Ion Temperature Gradient (ITG) mode and the Trapped Electron Mode (TEM).\n   - The ITG mode is driven by $ R/L_T $ exceeding a shear-dependent critical gradient. The TEM is driven by $ R/L_n $ exceeding a shear-dependent critical gradient. Assume the following thresholds:\n     - $ (R/L_T)_{\\mathrm{crit}}(\\hat{s}) = 2.0 + 1.0 \\, \\hat{s} $,\n     - $ (R/L_n)_{\\mathrm{crit}}(\\hat{s}) = 1.0 + 0.5 \\, \\hat{s} $.\n   - Let the characteristic diamagnetic frequency scale be set by $ \\omega_* = k_y \\rho_s $ in the adopted normalization.\n\n3. Effective linear growth rates and shear suppression:\n   - The unsheared linear growth rates of the ITG and TEM branches are proportional to the amount by which the corresponding gradients exceed thresholds:\n     - $ \\gamma_{\\mathrm{ITG,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_T) - (R/L_T)_{\\mathrm{crit}}(\\hat{s}) \\} $,\n     - $ \\gamma_{\\mathrm{TEM,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_n) - (R/L_n)_{\\mathrm{crit}}(\\hat{s}) \\} $.\n   - The ExB (Electric field crossed with magnetic field) shearing rate $ \\gamma_E $ reduces effective growth by linear decorrelation:\n     - $ \\gamma_{\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{\\mathrm{lin}} - \\gamma_E \\} $.\n\n4. Species-resolved diffusivities and cross-coupling:\n   - For ions, associate transport with the ITG branch:\n     - $ \\gamma_{i,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{\\mathrm{ITG,lin}} - \\gamma_E \\} $.\n   - For electrons, allow contributions from both branches with a fixed cross-coupling fraction $ \\alpha = 0.3 $ from the ITG branch:\n     - $ \\gamma_{e,\\mathrm{lin}} = \\max\\{ \\gamma_{\\mathrm{TEM,lin}}, \\, \\alpha \\, \\gamma_{\\mathrm{ITG,lin}} \\} $,\n     - $ \\gamma_{e,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{e,\\mathrm{lin}} - \\gamma_E \\} $.\n\n5. Mixing-length closure:\n   - Adopt a mixing-length prefactor $ C_{\\mathrm{mix}} = 0.5 $ and use the perpendicular wavenumber model above. Compute species-resolved diffusivities as\n     - $ \\chi_i = C_{\\mathrm{mix}} \\, \\gamma_{i,\\mathrm{eff}} / (k_\\perp \\rho_s)^2 $,\n     - $ \\chi_e = C_{\\mathrm{mix}} \\, \\gamma_{e,\\mathrm{eff}} / (k_\\perp \\rho_s)^2 $.\n\n6. Barrier identification criterion:\n   - Define that a transport barrier forms if both $ \\chi_i $ and $ \\chi_e $ are strictly less than $ \\chi_{\\mathrm{bar}} = 0.05 $ (dimensionless, in gyro-Bohm units). Return a barrier flag equal to $ 1 $ when a barrier forms and $ 0 $ otherwise.\n\n7. Numerical values and units:\n   - All inputs are dimensionless. The outputs $ \\chi_i $ and $ \\chi_e $ must be reported in gyro-Bohm normalized units (dimensionless).\n   - In the final output, round $ \\chi_i $ and $ \\chi_e $ to six decimal places.\n\n8. Test suite:\n   - Your program must evaluate the following ordered test cases, each specified as $ [ R/L_T, R/L_n, \\hat{s}, \\gamma_E ] $:\n     - $ [ 8.0, \\, 2.5, \\, 0.5, \\, 1.8 ] $\n     - $ [ 6.0, \\, 2.0, \\, 0.2, \\, 0.1 ] $\n     - $ [ 2.6, \\, 1.2, \\, 0.5, \\, 0.05 ] $\n     - $ [ 4.0, \\, 1.5, \\, 2.0, \\, 0.3 ] $\n     - $ [ 3.0, \\, 3.0, \\, 0.3, \\, 0.2 ] $\n\n9. Final output format:\n   - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and must itself be a list of the form $ [ \\chi_i, \\chi_e, b ] $, where $ b $ is the integer barrier flag. For example:\n   - $ [ [\\chi_{i,1}, \\chi_{e,1}, b_1], [\\chi_{i,2}, \\chi_{e,2}, b_2], \\dots ] $.\n\nYour task: Implement the complete program that computes $ \\chi_i $, $ \\chi_e $, and the barrier flag for each test case as specified, using the modeling assumptions above, and prints the final aggregated results line exactly in the format described. No input should be read from the user. All constants and modeling choices must be implemented exactly as stated.",
            "solution": "The problem presents a valid, well-posed computational task grounded in the principles of plasma physics and fusion science. It requires the implementation of a reduced quasilinear transport model to calculate ion and electron thermal diffusivities in a tokamak plasma. The model captures essential physics, including instability drives from temperature and density gradients, critical gradient thresholds, magnetic shear effects, and transport suppression by $E \\times B$ velocity shear. The problem is self-contained, with all necessary equations, constants, and input parameters specified. We will proceed with a step-by-step solution based on these specified principles.\n\nThe core of the problem is to compute the gyro-Bohm normalized ion thermal diffusivity, $\\chi_i$, and electron thermal diffusivity, $\\chi_e$, along with a transport barrier flag, $b$, for a given set of dimensionless plasma parameters: the normalized temperature gradient $R/L_T$, the normalized density gradient $R/L_n$, the magnetic shear $\\hat{s}$, and the normalized $E \\times B$ shearing rate $\\gamma_E$.\n\nThe algorithmic process directly follows the physics model outlined:\n\n1.  **Fundamental Constants and Scales**: The model is built upon several fixed parameters.\n    -   A characteristic binormal wavenumber $k_y \\rho_s = 0.3$ is assumed, where $\\rho_s$ is the ion sound gyroradius. This value sets the scale for the diamagnetic frequency, which we denote as $\\omega_* = k_y \\rho_s = 0.3$ in our normalized units.\n    -   The mixing-length prefactor is $C_{\\mathrm{mix}} = 0.5$.\n    -   The cross-coupling fraction of ITG-driven transport into the electron channel is $\\alpha = 0.3$.\n    -   The transport barrier is defined by a diffusivity threshold $\\chi_{\\mathrm{bar}} = 0.05$.\n\n2.  **Magnetic Geometry Effects**: The turbulent transport is influenced by the magnetic field geometry, specifically the magnetic shear, $\\hat{s}$.\n    -   The effective perpendicular wavenumber, $k_\\perp$, is modeled as being enhanced by magnetic shear. Its squared normalized value, which appears in the denominator of the diffusivity, is calculated as:\n        $$ (k_\\perp \\rho_s)^2 = (k_y \\rho_s)^2 (1 + \\hat{s}^2) = (0.3)^2 (1 + \\hat{s}^2) $$\n    -   Magnetic shear also stabilizes microinstabilities by modifying their mode structure, which is captured by raising the critical gradients required to drive them. The critical gradients for the Ion Temperature Gradient (ITG) and Trapped Electron Mode (TEM) instabilities are given by:\n        $$ (R/L_T)_{\\mathrm{crit}}(\\hat{s}) = 2.0 + 1.0 \\, \\hat{s} $$\n        $$ (R/L_n)_{\\mathrm{crit}}(\\hat{s}) = 1.0 + 0.5 \\, \\hat{s} $$\n\n3.  **Linear Growth Rate Calculation**: The primary drive for the turbulence is the extent to which the plasma gradients exceed their respective critical thresholds.\n    -   The linear growth rate of the ITG mode, $\\gamma_{\\mathrm{ITG,lin}}$, is proportional to the \"excess\" temperature gradient:\n        $$ \\gamma_{\\mathrm{ITG,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_T) - (R/L_T)_{\\mathrm{crit}}(\\hat{s}) \\} $$\n    -   Similarly, the linear growth rate of the TEM, $\\gamma_{\\mathrm{TEM,lin}}$, is driven by the density gradient:\n        $$ \\gamma_{\\mathrm{TEM,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_n) - (R/L_n)_{\\mathrm{crit}}(\\hat{s}) \\} $$\n    The $\\max\\{0, \\dots\\}$ function enforces the threshold condition, ensuring that the growth rate is zero if the gradient is below the critical value.\n\n4.  **$E \\times B$ Shear Suppression and Species-Resolved Transport**: The $E \\times B$ shearing rate, $\\gamma_E$, provides a crucial transport suppression mechanism by decorrelating the turbulent eddies. This effect is modeled as a direct reduction of the linear growth rates. The transport is then resolved for ions and electrons.\n    -   **Ion Channel**: Ion transport is assumed to be driven solely by the ITG mode. The effective growth rate for the ion channel, $\\gamma_{i,\\mathrm{eff}}$, is the ITG linear growth rate reduced by the $E \\times B$ shear:\n        $$ \\gamma_{i,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{\\mathrm{ITG,lin}} - \\gamma_E \\} $$\n    -   **Electron Channel**: Electron transport is driven by the stronger of the TEM mode and a fraction $\\alpha$ of the ITG mode drive. This composite linear drive, $\\gamma_{e,\\mathrm{lin}}$, is then also suppressed by the $E \\times B$ shear:\n        $$ \\gamma_{e,\\mathrm{lin}} = \\max\\{ \\gamma_{\\mathrm{TEM,lin}}, \\, \\alpha \\, \\gamma_{\\mathrm{ITG,lin}} \\} $$\n        $$ \\gamma_{e,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{e,\\mathrm{lin}} - \\gamma_E \\} $$\n\n5.  **Quasilinear Mixing-Length Diffusivity**: The final step is to apply the mixing-length closure, which relates the diffusivity $\\chi$ to the effective growth rate $\\gamma_{\\mathrm{eff}}$ and the perpendicular correlation length, proxied by $1/k_\\perp$. This is the standard $\\chi \\sim \\gamma/k^2$ scaling.\n    -   The ion thermal diffusivity $\\chi_i$ is:\n        $$ \\chi_i = C_{\\mathrm{mix}} \\frac{\\gamma_{i,\\mathrm{eff}}}{(k_\\perp \\rho_s)^2} $$\n    -   The electron thermal diffusivity $\\chi_e$ is:\n        $$ \\chi_e = C_{\\mathrm{mix}} \\frac{\\gamma_{e,\\mathrm{eff}}}{(k_\\perp \\rho_s)^2} $$\n\n6.  **Transport Barrier Identification**: An Internal Transport Barrier (ITB) is a region of significantly reduced transport. A quantitative criterion is used to identify its formation.\n    -   A barrier is considered formed if both ion and electron diffusivities fall strictly below the threshold $\\chi_{\\mathrm{bar}} = 0.05$.\n    -   The barrier flag $b$ is set to $1$ if $(\\chi_i  \\chi_{\\mathrm{bar}}) \\land (\\chi_e  \\chi_{\\mathrm{bar}})$, and $0$ otherwise.\n\nThis sequence of calculations is implemented for each of the provided test cases. The resulting values for $\\chi_i$ and $\\chi_e$ are rounded to six decimal places as specified for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reduced quasilinear transport model for a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is in the format: [R/L_T, R/L_n, s_hat, gamma_E]\n    test_cases = [\n        [8.0, 2.5, 0.5, 1.8],\n        [6.0, 2.0, 0.2, 0.1],\n        [2.6, 1.2, 0.5, 0.05],\n        [4.0, 1.5, 2.0, 0.3],\n        [3.0, 3.0, 0.3, 0.2]\n    ]\n\n    # --- Model Constants ---\n    # These values are fixed as per the problem description.\n    _ky_rhos = 0.3      # Normalized binormal wavenumber and diamagnetic frequency scale (omega_*)\n    _alpha = 0.3        # Cross-coupling fraction from ITG to electron channel\n    _C_mix = 0.5        # Mixing-length prefactor\n    _chi_bar = 0.05     # Diffusivity threshold for barrier identification\n\n    def calculate_diffusivities(params):\n        \"\"\"\n        Calculates chi_i, chi_e, and the barrier flag for a single parameter set.\n\n        Args:\n            params (list): A list of four floats [R/L_T, R/L_n, s_hat, gamma_E].\n\n        Returns:\n            tuple: A tuple containing (chi_i, chi_e, b) where chi_i and chi_e are\n                   unrounded floats and b is the integer barrier flag.\n        \"\"\"\n        RLT, RLn, s_hat, gamma_E = params\n\n        # 1. Calculate shear-dependent quantities\n        # Effective perpendicular wavenumber squared\n        k_perp_rhos_sq = (_ky_rhos**2) * (1 + s_hat**2)\n        # Critical gradients\n        RLT_crit = 2.0 + 1.0 * s_hat\n        RLn_crit = 1.0 + 0.5 * s_hat\n\n        # 2. Calculate unsheared linear growth rates\n        gamma_ITG_lin = _ky_rhos * max(0.0, RLT - RLT_crit)\n        gamma_TEM_lin = _ky_rhos * max(0.0, RLn - RLn_crit)\n\n        # 3. Calculate species-resolved effective growth rates with ExB shear suppression\n        # Ion channel (driven by ITG)\n        gamma_i_eff = max(0.0, gamma_ITG_lin - gamma_E)\n        \n        # Electron channel (driven by max of TEM and a fraction of ITG)\n        gamma_e_lin = max(gamma_TEM_lin, _alpha * gamma_ITG_lin)\n        gamma_e_eff = max(0.0, gamma_e_lin - gamma_E)\n\n        # 4. Calculate diffusivities using the mixing-length formula\n        # The denominator k_perp_rhos_sq is always  0 since ky_rhos  0.\n        chi_i = _C_mix * gamma_i_eff / k_perp_rhos_sq\n        chi_e = _C_mix * gamma_e_eff / k_perp_rhos_sq\n\n        # 5. Identify transport barrier formation\n        # The criterion is strictly less than chi_bar for both species.\n        barrier_flag = 1 if (chi_i  _chi_bar and chi_e  _chi_bar) else 0\n\n        return chi_i, chi_e, barrier_flag\n\n    # Process all test cases and format for output\n    results_for_print = []\n    for case in test_cases:\n        # Calculate the raw diffusivity values and the barrier flag\n        chi_i_raw, chi_e_raw, b = calculate_diffusivities(case)\n\n        # Format the diffusivity values to six decimal places as required.\n        # This formatting handles rounding correctly.\n        chi_i_str = f\"{chi_i_raw:.6f}\"\n        chi_e_str = f\"{chi_e_raw:.6f}\"\n        \n        # Create the string representation for a single case's result list\n        results_for_print.append(f\"[{chi_i_str},{chi_e_str},{b}]\")\n\n    # Final print statement in the exact required format.\n    # The output is a string representing a list of lists.\n    print(f\"[{','.join(results_for_print)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This advanced practice delves into the self-consistent nature of transport barriers by solving a nonlinear diffusion equation where the transport coefficient itself is a function of the resulting temperature profile. You will implement a numerical solver and then perform a sensitivity analysis to identify which physical parameters, such as heating power or magnetic shear, are most effective at controlling barrier strength. This exercise mimics a real-world research task in computational fusion science, connecting model parameters to control effectiveness. ",
            "id": "4056917",
            "problem": "You are to implement a self-contained numerical study of internal transport barrier formation using a one-dimensional, flux-surface-averaged transport model for a toroidal plasma. The task is to compute a scalar barrier strength index from steady-state solutions of a nonlinear diffusion equation, and then perform a local sensitivity analysis of that index with respect to three input parameters: heat source amplitude, safety-factor profile shape parameter, and collisionality. Your program must identify which parameter is locally most influential for each specified case by a consistent, quantitative sensitivity metric, and produce the requested output.\n\nThe physical foundation is the radially one-dimensional, flux-surface-averaged, steady-state energy balance along the minor radius $r \\in [0,1]$ (normalized to the edge). The balance equates the divergence of the heat flux to the external heating source. In the absence of convection and with isotropic perpendicular transport, the steady-state equation is\n$$\n\\frac{d}{dr}\\left(\\chi_{\\mathrm{eff}}(r)\\,\\frac{dT}{dr}\\right) + S(r) = 0,\n$$\nwith temperature $T(r)$ normalized to an arbitrary scale, where the effective diffusivity $\\chi_{\\mathrm{eff}}(r)$ models turbulence suppression by $\\mathbf{E}\\times \\mathbf{B}$ shear and includes an irreducible residual transport floor. The boundary conditions are symmetry at the magnetic axis and fixed edge temperature:\n$$\n\\left.\\frac{dT}{dr}\\right|_{r=0} = 0,\\quad T(r=1) = 0.\n$$\n\nThe model components are defined as follows, using dimensionless quantities:\n\n- The heat source is prescribed as a centrally peaked Gaussian\n$$\nS(r) = S_0 \\exp\\!\\left(-\\frac{r^2}{w^2}\\right),\n$$\nwith source amplitude $S_0$ and width $w$. Use $w = 0.25$.\n\n- The safety-factor profile is parameterized by\n$$\nq(r) = q_0 + \\alpha r^2,\n$$\nwith $q_0 = 1.0$ and shape parameter $\\alpha \\ge 0$. The local magnetic shear is modeled as\n$$\n\\hat{s}(r) = \\frac{r}{q(r)}\\frac{dq}{dr} = \\frac{2 \\alpha r^2}{q(r)}.\n$$\n\n- The linear growth rate of ion temperature gradient (ITG)-like turbulence is parameterized as\n$$\n\\gamma_{\\mathrm{lin}}(r) = \\gamma_0 \\,\\frac{1 + b_s \\hat{s}(r)^2}{1 + \\nu_*},\n$$\nwhere $\\gamma_0$, $b_s$, and the dimensionless collisionality $\\nu_*$ are constants or inputs as specified below.\n\n- The $\\mathbf{E}\\times \\mathbf{B}$ shearing rate is modeled in terms of the local temperature gradient magnitude:\n$$\n\\gamma_E(r) = C_E \\left|\\frac{dT}{dr}\\right|.\n$$\n\n- The effective diffusivity is given by a Biglari–Diamond–Terry-type suppression form with a residual floor:\n$$\n\\chi_{\\mathrm{eff}}(r) = \\chi_{\\min} + \\frac{\\chi_0}{1 + \\left(\\dfrac{\\gamma_E(r)}{\\gamma_{\\mathrm{lin}}(r)}\\right)^2},\n$$\nwith constants $\\chi_0$ and $\\chi_{\\min}$ and the ratio regularized in computation to avoid division by zero.\n\nThe barrier strength index for a converged solution is taken to be the maximum suppression ratio\n$$\nB = \\max_{r \\in [0,1]}\\left(\\frac{\\gamma_E(r)}{\\gamma_{\\mathrm{lin}}(r)}\\right).\n$$\nThis dimensionless scalar is larger when shear suppression dominates linear drive locally.\n\nYou must compute a local, dimensionless sensitivity of $B$ to each input parameter $p \\in \\{S_0, \\alpha, \\nu_*\\}$ via centered finite differences. For a given baseline parameter triplet, define\n$$\n\\left.\\frac{\\partial B}{\\partial p}\\right|_{\\mathrm{FD}} \\approx \\frac{B(p + \\Delta p) - B(p - \\Delta p)}{2 \\Delta p},\n$$\nwith a relative step $\\Delta p = \\eta \\max(p, \\epsilon_p)$, using $\\eta = 0.05$ and $\\epsilon_p = 10^{-6}$. Define the local, normalized absolute sensitivity for parameter $p$ as\n$$\n\\mathcal{S}_p = \\left|\\frac{p}{\\max(B,\\epsilon_B)} \\frac{\\partial B}{\\partial p}\\right|,\n$$\nwith $\\epsilon_B = 10^{-8}$. For each case, you must report the index of the parameter with the largest $\\mathcal{S}_p$ as an integer according to the mapping\n$$\n0 \\mapsto S_0,\\quad 1 \\mapsto \\alpha,\\quad 2 \\mapsto \\nu_*.\n$$\n\nAlgorithmic and numerical requirements:\n\n- Discretize $r \\in [0,1]$ uniformly with at least $N=128$ points, and solve the nonlinear boundary value problem by fixed-point iteration: starting from an initial guess for $T(r)$, evaluate $\\chi_{\\mathrm{eff}}(r)$, then solve the resulting linear variable-coefficient diffusion equation for an updated $T(r)$, under-relax, and iterate until convergence. Use the boundary conditions specified above. A standard second-order finite-volume or finite-difference method with a tridiagonal linear system is acceptable.\n\n- Use parameters $\\chi_0 = 1.0$, $\\chi_{\\min} = 0.05$, $\\gamma_0 = 0.30$, $b_s = 2.0$, $C_E = 2.0$, $q_0 = 1.0$, $w = 0.25$.\n\n- Use an under-relaxation factor of $\\omega = 0.5$, a nonlinear iteration tolerance of $\\delta_T = 10^{-6}$ in the maximum norm, and a maximum of $500$ iterations.\n\n- All quantities are dimensionless; there is no unit conversion required. The final results are integers as defined by the sensitivity metric and mapping above, with no physical units.\n\nTest suite:\n\nFor each of the following five baseline parameter sets $(S_0, \\alpha, \\nu_*)$, compute the most influential factor index as defined above.\n\n1. Case A (baseline, moderate drive and shear, low collisionality): $(S_0, \\alpha, \\nu_*) = (5.0, 1.0, 0.2)$.\n2. Case B (stronger core heating): $(S_0, \\alpha, \\nu_*) = (8.0, 1.0, 0.2)$.\n3. Case C (stronger magnetic shear shaping): $(S_0, \\alpha, \\nu_*) = (5.0, 3.0, 0.2)$.\n4. Case D (higher collisionality): $(S_0, \\alpha, \\nu_*) = (5.0, 1.0, 1.5)$.\n5. Case E (weak heating, weak shear, very low collisionality): $(S_0, \\alpha, \\nu_*) = (2.0, 0.5, 0.05)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite above. Each entry must be the integer index of the most influential parameter for that case, as per the mapping $0 \\mapsto S_0$, $1 \\mapsto \\alpha$, $2 \\mapsto \\nu_*$. For example, a valid output format is\n$$\n[\\;i_A,\\,i_B,\\,i_C,\\,i_D,\\,i_E\\;],\n$$\nwhere each $i_\\bullet$ is an integer in $\\{0,1,2\\}$.",
            "solution": "The user-provided problem is a well-posed numerical task in computational plasma physics, specifically modeling the formation of an internal transport barrier (ITB). The problem is scientifically grounded, using a standard simplified one-dimensional transport model. All required equations, constants, and numerical procedures are specified in a self-contained and consistent manner. Therefore, the problem is deemed valid and a solution is provided below.\n\nThe core of the problem is to solve a nonlinear boundary value problem (BVP) for the steady-state temperature profile $T(r)$ and then to perform a local sensitivity analysis on a derived quantity, the barrier strength index $B$. The solution is structured into three main parts: (1) a numerical solver for the nonlinear BVP, (2) calculation of the barrier strength index $B$ from the converged temperature profile, and (3) a sensitivity analysis of $B$ with respect to the input parameters $S_0$, $\\alpha$, and $\\nu_*$.\n\n**1. Numerical Solution of the Nonlinear Boundary Value Problem**\n\nThe governing equation is a one-dimensional, steady-state reaction-diffusion equation:\n$$\n\\frac{d}{dr}\\left(\\chi_{\\mathrm{eff}}(r, |dT/dr|)\\,\\frac{dT}{dr}\\right) + S(r) = 0, \\quad r \\in [0,1]\n$$\nwith boundary conditions $dT/dr|_{r=0} = 0$ and $T(1) = 0$. The nonlinearity arises because the effective diffusivity $\\chi_{\\text{eff}}$ depends on the temperature gradient magnitude $|dT/dr|$.\n\nThis nonlinear BVP is solved using a fixed-point iteration scheme on a uniform, vertex-centered grid. The radial domain $r \\in [0,1]$ is discretized into $N$ segments, yielding $N+1$ grid points $r_i = i \\cdot h$ for $i=0, 1, \\dots, N$, where $h=1/N$ is the grid spacing. The temperature at these points is denoted by $T_i = T(r_i)$.\n\nThe iterative procedure is as follows:\n1.  Initialize the temperature profile, e.g., $T^{(0)}(r) = 0$.\n2.  For each iteration $k=0, 1, 2, \\dots$:\n    a.  Given the current temperature profile $T^{(k)}(r)$, compute the temperature gradient $|dT/dr|^{(k)}$. A a second-order centered difference is used for interior points, while the boundary conditions dictate the gradient at the endpoints.\n    b.  Calculate all gradient-dependent quantities, including the $\\mathbf{E}\\times\\mathbf{B}$ shearing rate $\\gamma_E^{(k)}(r) = C_E |dT/dr|^{(k)}$.\n    c.  Evaluate the effective diffusivity profile $\\chi_{\\mathrm{eff}}^{(k)}(r)$ using the given formula, based on values from the $k$-th iteration. The quantities $q(r)$, $\\hat{s}(r)$, and $\\gamma_{\\mathrm{lin}}(r)$ are independent of temperature and are computed once.\n    d.  Solve the now *linear* variable-coefficient BVP for a temporary new profile $\\tilde{T}(r)$:\n        $$\n        \\frac{d}{dr}\\left(\\chi_{\\mathrm{eff}}^{(k)}(r) \\frac{d\\tilde{T}}{dr}\\right) + S(r) = 0.\n        $$\n        This equation is discretized using a second-order finite-difference scheme, resulting in a tridiagonal system of linear algebraic equations for the unknown temperatures $\\tilde{T}_i$ at the interior grid points. The boundary conditions are incorporated as follows:\n        -   At $r=1$, the Dirichlet condition $T_N=0$ is set directly.\n        -   At $r=0$, the Neumann condition $dT/dr|_0=0$ is implemented using a ghost point such that $T_{-1}=T_1$, which simplifies the finite-difference equation at $i=0$.\n        The resulting $N \\times N$ tridiagonal system for the unknowns $\\tilde{T}_0, \\dots, \\tilde{T}_{N-1}$ is efficiently solved using `scipy.linalg.solve_banded`.\n    e.  Update the temperature profile using under-relaxation with a factor $\\omega$:\n        $$\n        T^{(k+1)} = (1-\\omega) T^{(k)} + \\omega \\tilde{T}.\n        $$\n    f.  The iteration continues until the maximum-norm difference between successive temperature profiles falls below a specified tolerance, $\\|T^{(k+1)} - T^{(k)}\\|_\\infty  \\delta_T$, or a maximum number of iterations is reached.\n\n**2. Calculation of the Barrier Strength Index ($B$)**\n\nOnce the iterative solver has converged to a steady-state solution $T(r)$, the barrier strength index $B$ is computed.\n1.  The final temperature gradient $|dT/dr|$ is calculated from the converged profile $T(r)$.\n2.  The final $\\mathbf{E}\\times\\mathbf{B}$ shearing rate profile $\\gamma_E(r)$ is determined.\n3.  The suppression ratio $\\gamma_E(r) / \\gamma_{\\mathrm{lin}}(r)$ is computed across the radial domain.\n4.  The barrier strength index $B$ is the maximum value of this ratio:\n    $$\n    B = \\max_{r \\in [0,1]}\\left(\\frac{\\gamma_E(r)}{\\gamma_{\\mathrm{lin}}(r)}\\right).\n    $$\n\n**3. Sensitivity Analysis**\n\nThe final step is to determine which input parameter $p \\in \\{S_0, \\alpha, \\nu_*\\}$ has the most significant local influence on the barrier strength $B$. This is quantified using a normalized absolute sensitivity metric.\n1.  For each parameter $p$, its partial derivative is approximated using a centered finite-difference formula:\n    $$\n    \\frac{\\partial B}{\\partial p} \\approx \\frac{B(p + \\Delta p) - B(p - \\Delta p)}{2 \\Delta p},\n    $$\n    where $B(p \\pm \\Delta p)$ are the barrier indices computed by re-running the entire BVP solver with the parameter $p$ perturbed by a small amount $\\Delta p$. The step size is determined by $\\Delta p = \\eta \\max(p, \\epsilon_p)$, ensuring a stable relative perturbation.\n2.  The dimensionless, normalized absolute sensitivity $\\mathcal{S}_p$ is then calculated for each parameter:\n    $$\n    \\mathcal{S}_p = \\left|\\frac{p}{\\max(B,\\epsilon_B)} \\frac{\\partial B}{\\partial p}\\right|,\n    $$\n    where $B$ is the value at the unperturbed, baseline parameter set.\n3.  For each test case, the sensitivities $\\mathcal{S}_{S_0}$, $\\mathcal{S}_{\\alpha}$, and $\\mathcal{S}_{\\nu_*}$ are compared. The index ($0$ for $S_0$, $1$ for $\\alpha$, $2$ for $\\nu_*$) corresponding to the largest $\\mathcal{S}_p$ is reported as the result.\n\nThis entire procedure is implemented in the provided Python code, which systematically evaluates each test case and formats the final results as requested.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\n# This script is self-contained and requires no external files or user input.\n# All constants and parameters are defined within the solve() function.\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the final result.\n    \"\"\"\n\n    # --- Global physical and numerical parameters from the problem statement ---\n    # Physical constants\n    CHI_0 = 1.0\n    CHI_MIN = 0.05\n    GAMMA_0 = 0.30\n    B_S = 2.0\n    C_E = 2.0\n    Q_0 = 1.0\n    W = 0.25\n\n    # Numerical parameters\n    N = 256  # Number of grid segments (N+1 points), satisfying N = 128\n    OMEGA = 0.5  # Under-relaxation factor\n    DELTA_T = 1e-6  # Convergence tolerance\n    MAX_ITER = 500  # Maximum number of nonlinear iterations\n\n    # Sensitivity analysis parameters\n    ETA = 0.05\n    EPS_P = 1e-6\n    EPS_B = 1e-8\n    \n    # --- Test suite from the problem statement ---\n    test_cases = [\n        (5.0, 1.0, 0.2),    # Case A\n        (8.0, 1.0, 0.2),    # Case B\n        (5.0, 3.0, 0.2),    # Case C\n        (5.0, 1.0, 1.5),    # Case D\n        (2.0, 0.5, 0.05),   # Case E\n    ]\n    \n    # --- Helper function to solve the BVP for a given parameter set ---\n    def solve_bvp(S0, alpha, nu_star):\n        \"\"\"\n        Solves the nonlinear BVP for the temperature profile and returns the barrier strength B.\n        \"\"\"\n        # Grid setup\n        r = np.linspace(0, 1, N + 1)\n        h = 1.0 / N\n\n        # Profiles that do not depend on temperature T\n        S_profile = S0 * np.exp(-r**2 / W**2)\n        q_profile = Q_0 + alpha * r**2\n        s_hat_profile = (2 * alpha * r**2) / q_profile\n        gamma_lin_profile = GAMMA_0 * (1 + B_S * s_hat_profile**2) / (1 + nu_star)\n        \n        # Regularization to prevent division by zero, although gamma_lin  0 for this model\n        gamma_lin_reg = np.maximum(gamma_lin_profile, 1e-12)\n\n        # Fixed-point iteration\n        # T_full includes the boundary point T(1)=0. We solve for T_sol = T[0...N-1].\n        T_sol = np.zeros(N)\n        \n        for _ in range(MAX_ITER):\n            T_sol_old = T_sol.copy()\n            T_full_old = np.append(T_sol_old, 0.0)\n\n            # Calculate T-dependent quantities from the previous iteration\n            dTdr = np.zeros(N + 1)\n            dTdr[1:-1] = (T_full_old[2:] - T_full_old[:-2]) / (2 * h) # Centered difference\n            dTdr[0] = 0.0  # Boundary condition\n            dTdr[-1] = (T_full_old[-1] - T_full_old[-2]) / h  # Backward difference\n\n            gamma_E = C_E * np.abs(dTdr)\n            suppression_ratio = gamma_E / gamma_lin_reg\n            chi_eff = CHI_MIN + CHI_0 / (1 + suppression_ratio**2)\n            chi_half = 0.5 * (chi_eff[:-1] + chi_eff[1:]) # Averaged at cell interfaces\n\n            # Set up the tridiagonal linear system A*T_tilde = b\n            A_band = np.zeros((3, N))\n            b = np.zeros(N)\n\n            # Equation for i=0 (center, r=0)\n            A_band[1, 0] = -2.0 * chi_half[0] / h**2\n            A_band[0, 1] = 2.0 * chi_half[0] / h**2\n            \n            # Equations for i=1 to N-2 (interior)\n            A_band[1, 1:-1] = -(chi_half[:-2] + chi_half[1:-1]) / h**2\n            A_band[2, :-2] = chi_half[:-2] / h**2\n            A_band[0, 2:] = chi_half[1:-1] / h**2\n            \n            # Equation for i=N-1 (near edge)\n            A_band[1, -1] = -(chi_half[-2] + chi_half[-1]) / h**2\n            A_band[2, -2] = chi_half[-2] / h**2\n            \n            # RHS vector\n            b[:] = -S_profile[:-1]\n\n            # Solve the linear system for the temporary profile\n            T_tilde = solve_banded((1, 1), A_band, b)\n\n            # Apply under-relaxation\n            T_sol = (1 - OMEGA) * T_sol_old + OMEGA * T_tilde\n\n            # Check for convergence\n            if np.max(np.abs(T_sol - T_sol_old))  DELTA_T:\n                break\n        \n        # After convergence, calculate the barrier strength B\n        T_full_final = np.append(T_sol, 0.0)\n        dTdr_final = np.zeros(N + 1)\n        dTdr_final[1:-1] = (T_full_final[2:] - T_full_final[:-2]) / (2 * h)\n        dTdr_final[0] = 0.0\n        dTdr_final[-1] = (T_full_final[-1] - T_full_final[-2]) / h\n        \n        gamma_E_final = C_E * np.abs(dTdr_final)\n        final_suppression_ratio = gamma_E_final / gamma_lin_reg\n        B = np.max(final_suppression_ratio)\n        \n        return B\n\n    # --- Helper function for sensitivity analysis ---\n    def calculate_sensitivities_and_max_idx(case):\n        \"\"\"\n        Performs sensitivity analysis for a given test case and returns the index\n        of the most influential parameter.\n        \"\"\"\n        params = list(case)\n        \n        # Calculate baseline barrier strength\n        B_base = solve_bvp(*params)\n        \n        sensitivities = []\n        for i in range(len(params)):\n            p_base = params[i]\n            \n            # Calculate perturbation step\n            dp = ETA * max(p_base, EPS_P)\n            \n            # Plus perturbation\n            params_plus = params.copy()\n            params_plus[i] += dp\n            B_plus = solve_bvp(*params_plus)\n            \n            # Minus perturbation\n            params_minus = params.copy()\n            params_minus[i] -= dp\n            B_minus = solve_bvp(*params_minus)\n            \n            # Centered finite difference derivative\n            dB_dp = (B_plus - B_minus) / (2 * dp)\n            \n            # Normalized absolute sensitivity\n            S_p = np.abs((p_base / max(B_base, EPS_B)) * dB_dp)\n            sensitivities.append(S_p)\n            \n        return np.argmax(sensitivities)\n\n    # --- Main execution loop ---\n    results = []\n    for case in test_cases:\n        most_influential_idx = calculate_sensitivities_and_max_idx(case)\n        results.append(most_influential_idx)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}