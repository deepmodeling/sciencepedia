{
    "hands_on_practices": [
        {
            "introduction": "维持聚变等离子体的高性能约束是反应堆设计的核心。磁流体动力学（MHD）不稳定性（如撕裂模）会形成被称为“磁岛”的结构，破坏磁约束并降低等离子体性能。本实践引导您使用修正的卢瑟福方程（Rutherford equation），通过量化各种驱动和稳定项来计算饱和磁岛的宽度，从而深入理解决定磁岛最终尺寸的物理机制。",
            "id": "3955705",
            "problem": "一个燃烧等离子体托卡马克在某个参数区域内运行，其中有理面半径 $r_s$ 处的单螺旋性撕裂不稳定性与一个真空振幅为 $b_r$ 的外部施加的共振磁扰相互作用。在电阻磁流体力学 (MHD) 和常数$\\psi$近似的框架下，考虑一个 $m/n$ 磁岛，其半宽度 $w$ 的非线性演化受以下因素影响：撕裂指数 $\\Delta'$，一个由无量纲系数 $K_{\\text{pol}}$ 表征的新经典极化电流稳定效应，以及一个对外场的力矩耦合相位响应，该响应在等离子体旋转时会减弱。假设以下物理基础：\n\n- 感应方程源于欧姆定律 $ \\mathbf{E} + \\mathbf{v}\\times \\mathbf{B} = \\eta \\mathbf{J}$，其中 $\\eta$ 是电阻率，$\\mu_0$ 是磁导率。\n- 经典的Rutherford标度和常数$\\psi$匹配给出了磁岛宽度 $w(t)$ 的非线性演化，其与电阻扩散率 $D_{\\eta} = \\eta/\\mu_0$ 乘以一个包含撕裂稳定指数 $\\Delta'$ 和随 $w$ 的负幂次标度的非线性项的表达式成正比。\n- 新经典极化电流效应在非线性驱动项中产生一个稳定项，其标度关系为 $-K_{\\text{pol}}/w$。\n- 外部施加的共振场产生一个额外的驱动项，在常数$\\psi$匹配下，该项在非线性驱动项中的标度关系为 $+\\alpha (r_s/B_{\\theta}) (b_r \\cos\\phi)/w^2$。其中，$B_{\\theta}$ 是 $r_s$ 处的平衡极向磁场，$\\phi$ 是磁岛与外场之间的相位差，$\\alpha$ 是一个由真空共振扰动的标准内外区匹配积分决定的几何/匹配常数。\n- 一个简单的线性力矩-相位模型给出 $\\tan\\phi = \\omega/\\omega_c$，其中 $\\omega$ 是有理面处的等离子体旋转频率，$\\omega_c$ 是特征电磁锁定率。因此，$\\cos\\phi = 1/\\sqrt{1+(\\omega/\\omega_c)^2}$。\n\n在这些假设下，稳态饱和磁岛宽度 $w_{\\text{sat}}$ 可通过将非线性驱动项设为零并求解 $w$ 得到。使用指定的参数：\n- $r_s = 1.00\\,\\text{m}$,\n- $B_{\\theta} = 0.50\\,\\text{T}$,\n- $\\Delta' = 0.80\\,\\text{m}^{-1}$,\n- $K_{\\text{pol}} = 0.050$,\n- $b_r = 1.00\\times 10^{-4}\\,\\text{T}$,\n- $\\omega = 300\\,\\text{rad}\\,\\text{s}^{-1}$,\n- $\\omega_c = 600\\,\\text{rad}\\,\\text{s}^{-1}$,\n\n并取标准常数$\\psi$真空共振匹配常数为 $\\alpha = 8/\\pi$。从第一性原理推导稳态条件，并计算包含旋转效应（通过 $\\cos\\phi$）的 $w_{\\text{sat}}$。最终答案以米为单位，并四舍五入到四位有效数字。在你的推理过程中，评估旋转制动（即 $\\omega$ 减小至零）如何影响饱和磁岛宽度，但只报告包含给定非零 $\\omega$ 的值。",
            "solution": "用户请求解答一个关于磁流体力学（MHD）稳定性的问题，具体涉及托卡马克中撕裂模磁岛的饱和宽度。在给出解答之前，必须对问题陈述进行严格验证。\n\n### 第1步：提取已知条件\n\n-   **模型:** 电阻MHD， $m/n$ 撕裂不稳定的常数$\\psi$近似。\n-   **有理面半径:** $r_s = 1.00\\,\\text{m}$\n-   **平衡极向磁场:** $B_{\\theta} = 0.50\\,\\text{T}$\n-   **撕裂稳定指数:** $\\Delta' = 0.80\\,\\text{m}^{-1}$\n-   **新经典极化系数:** $K_{\\text{pol}} = 0.050$ (无量纲)\n-   **真空共振磁扰振幅:** $b_r = 1.00\\times 10^{-4}\\,\\text{T}$\n-   **等离子体旋转频率:** $\\omega = 300\\,\\text{rad}\\,\\text{s}^{-1}$\n-   **特征锁定率:** $\\omega_c = 600\\,\\text{rad}\\,\\text{s}^{-1}$\n-   **几何/匹配常数:** $\\alpha = 8/\\pi$\n-   **磁岛宽度演化物理:** 磁岛半宽度 $w(t)$ 的非线性演化由一个包含以下项的驱动表达式确定：\n    1.  经典撕裂驱动 $\\Delta'$。\n    2.  标度关系为 $-K_{\\text{pol}}/w$ 的新经典极化电流稳定项。\n    3.  标度关系为 $+\\alpha (r_s/B_{\\theta}) (b_r \\cos\\phi)/w^2$ 的外场驱动项。\n-   **相位关系:** 磁岛与外场之间的相位差 $\\phi$ 由 $\\tan\\phi = \\omega/\\omega_c$ 给出，这意味着 $\\cos\\phi = 1/\\sqrt{1+(\\omega/\\omega_c)^2}$。\n-   **目标:** 计算稳态饱和磁岛宽度 $w_{\\text{sat}}$，单位为米，结果四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n\n根据指定标准对问题进行验证。\n\n-   **科学依据:** 该问题基于修正的Rutherford方程，这是聚变等离子体中非线性撕裂模理论的基石。代表经典撕裂指数（$\\Delta'$）、新经典极化电流和外部共振磁扰的各项是该模型的标准组成部分。该物理框架在等离子体物理和MHD中已得到充分确立。问题是科学上合理的。\n-   **良定性:** 问题要求解一个由稳态条件产生的特定代数方程。所有参数和函数形式都已给出，从而构成一个定义明确的数学问题，并期望得到一个具有物理意义的解。\n-   **客观性:** 问题以精确、定量和无偏见的专业技术语言陈述。\n-   **完整性和一致性:** 提供了求解饱和磁岛宽度的所有必要参数。对控制方程中各项的单位进行了一致性检查。\n    -   $\\Delta'$ 的单位是 $\\text{m}^{-1}$。\n    -   $-K_{\\text{pol}}/w$ 的单位是 $\\text{m}^{-1}$，因为 $K_{\\text{pol}}$ 是无量纲的。\n    -   外场项的单位是 $\\frac{[\\text{m}]}{[\\text{T}]} \\frac{[\\text{T}]}{[\\text{m}]^2} = \\text{m}^{-1}$。\n    所有项的量纲一致。问题是完整且自洽的。\n-   **真实性和可行性:** 给出的磁场、尺寸、频率和稳定性参数的数值对于常规托卡马克是物理上合理的。\n-   **结构和清晰度:** 问题结构清晰，定义了物理模型，提供了所有参数，并陈述了明确的目标。各项的定义明确无歧义。\n\n### 第3步：结论与行动\n\n问题是**有效的**，因为它是科学上合理、良定、完整且一致的。我现在将开始推导解答。\n\n### 解答推导\n\n磁岛半宽度 $w$ 的演化由修正的Rutherford方程控制。根据问题陈述，磁岛增长的净驱动力与一个表达式 $\\mathcal{D}(w)$ 成正比，该表达式是经典撕裂驱动、新经典效应和外部磁扰贡献的总和。稳态饱和磁岛（$dw/dt = 0$）对应于该净驱动力为零的条件。\n\n驱动表达式 $\\mathcal{D}(w)$ 为：\n$$\n\\mathcal{D}(w) = \\Delta' - \\frac{K_{\\text{pol}}}{w} + \\alpha \\frac{r_s}{B_{\\theta}} \\frac{b_r \\cos\\phi}{w^2}\n$$\n对于宽度为 $w_{\\text{sat}}$ 的稳态饱和磁岛，必须有 $\\mathcal{D}(w_{\\text{sat}}) = 0$：\n$$\n\\Delta' - \\frac{K_{\\text{pol}}}{w_{\\text{sat}}} + \\alpha \\frac{r_s}{B_{\\theta}} \\frac{b_r \\cos\\phi}{w_{\\text{sat}}^2} = 0\n$$\n为求解 $w_{\\text{sat}}$，我们可以乘以 $w_{\\text{sat}}^2$ 得到一个关于 $w_{\\text{sat}}$ 的二次方程：\n$$\n\\Delta' w_{\\text{sat}}^2 - K_{\\text{pol}} w_{\\text{sat}} + \\alpha \\frac{r_s b_r}{B_{\\theta}} \\cos\\phi = 0\n$$\n这是一个形式为 $Aw^2 + Bw + C = 0$ 的标准二次方程，其系数为：\n-   $A = \\Delta'$\n-   $B = -K_{\\text{pol}}$\n-   $C = \\alpha \\frac{r_s b_r}{B_{\\theta}} \\cos\\phi$\n\n首先，我们使用给定的等离子体旋转参数计算 $\\cos\\phi$ 项：\n$$\n\\frac{\\omega}{\\omega_c} = \\frac{300\\,\\text{rad}\\,\\text{s}^{-1}}{600\\,\\text{rad}\\,\\text{s}^{-1}} = 0.5\n$$\n$$\n\\cos\\phi = \\frac{1}{\\sqrt{1 + (\\omega/\\omega_c)^2}} = \\frac{1}{\\sqrt{1 + (0.5)^2}} = \\frac{1}{\\sqrt{1.25}} = \\frac{1}{\\sqrt{5/4}} = \\frac{2}{\\sqrt{5}}\n$$\n接下来，我们将给定的参数值代入系数 $A$、$B$ 和 $C$：\n-   $A = \\Delta' = 0.80\\,\\text{m}^{-1}$\n-   $B = -K_{\\text{pol}} = -0.050$\n-   $C = \\left(\\frac{8}{\\pi}\\right) \\frac{(1.00\\,\\text{m}) (1.00 \\times 10^{-4}\\,\\text{T})}{0.50\\,\\text{T}} \\left(\\frac{2}{\\sqrt{5}}\\right) = \\frac{1.6 \\times 10^{-3}}{\\pi \\sqrt{1.25}}\\,\\text{m} \\approx 4.5553 \\times 10^{-4}\\,\\text{m}$\n\n关于 $w_{\\text{sat}}$ 的二次方程是：\n$$\n(0.80) w_{\\text{sat}}^2 - (0.050) w_{\\text{sat}} + (4.5553 \\times 10^{-4}) = 0\n$$\n解由二次方程求根公式给出，$w_{\\text{sat}} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$：\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{(-0.050)^2 - 4(0.80)(4.5553 \\times 10^{-4})}}{2(0.80)}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{2.5 \\times 10^{-3} - 1.4577 \\times 10^{-3}}}{1.6}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{1.0423 \\times 10^{-3}}}{1.6}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm 0.03228}{1.6}\n$$\n这产生了两个正实根：\n-   $w_1 = \\frac{0.050 + 0.03228}{1.6} = \\frac{0.08228}{1.6} \\approx 0.0514\\,\\text{m}$\n-   $w_2 = \\frac{0.050 - 0.03228}{1.6} = \\frac{0.01772}{1.6} \\approx 0.0111\\,\\text{m}$\n\n为了确定哪个根对应于稳定的饱和态，我们分析其稳定性。磁岛演化由 $dw/dt \\propto \\mathcal{D}(w)$ 描述。如果一个状态 $w_{\\text{sat}}$ 在受到微小扰动后能恢复到 $w_{\\text{sat}}$，那么该状态是稳定的。这要求在 $w_{\\text{sat}}$ 处计算的导数 $\\mathcal{D}'(w)$ 为负。\n函数 $\\mathcal{D}(w) = \\Delta' - K_{\\text{pol}}/w + C/w^2$（其中 $C$ 是第三项的常数部分）的行为如下：\n-   当 $w \\to 0^+$ 时，$\\mathcal{D}(w) \\to +\\infty$。\n-   当 $w \\to \\infty$ 时，$\\mathcal{D}(w) \\to \\Delta' > 0$。\n由于函数 $\\mathcal{D}(w)$ 在 $w$ 非常小和非常大时均为正，并且我们有两个根，因此它在两根之间必定为负。设 $w_2  w_1$。\n-   对于 $w \\in (0, w_2)$，$\\mathcal{D}(w) > 0$，所以 $dw/dt > 0$。磁岛向 $w_2$ 增长。\n-   对于 $w \\in (w_2, w_1)$，$\\mathcal{D}(w)  0$，所以 $dw/dt  0$。磁岛向 $w_2$ 收缩。\n-   对于 $w > w_1$，$\\mathcal{D}(w) > 0$，所以 $dw/dt > 0$。磁岛从 $w_1$ 开始增长。\n此分析表明，较小的根 $w_2$ 是稳定的饱和态，而较大的根 $w_1$ 是不稳定的阈值。因此，物理上观测到的饱和磁岛宽度是 $w_2$。\n\n现在，我们按要求评估旋转制动的效果。旋转制动对应于 $\\omega \\to 0$。在此极限下，$\\omega/\\omega_c \\to 0$ 且 $\\cos\\phi \\to 1$。一个更大的 $\\cos\\phi$ 会增加二次方程中的系数 $C$。二次函数 $\\Delta' w^2 - K_{\\text{pol}} w + C$ 垂直向上平移。这导致其两个根向抛物线的顶点 $w_v = K_{\\text{pol}}/(2\\Delta')$ 靠近。较小的根 $w_2$ 增加，较大的根 $w_1$ 减小。因此，制动等离子体旋转会增加稳定的饱和磁岛宽度。这在物理上是一致的，因为更强的外场驱动（更大的 $\\cos\\phi$）应导致更大的磁岛。\n\n问题要求计算在给定非零旋转下的 $w_{\\text{sat}}$ 数值。这是稳定根 $w_2$。使用更高精度进行计算：\n$A = 0.8$\n$B = -0.05$\n$C = \\frac{1.6 \\times 10^{-3}}{\\pi \\sqrt{1.25}} \\approx 4.5553175 \\times 10^{-4}$\n$w_2 = \\frac{-B - \\sqrt{B^2 - 4AC}}{2A} = \\frac{0.05 - \\sqrt{0.0025 - 4(0.8)(4.5553175 \\times 10^{-4})}}{1.6}$\n$w_2 = \\frac{0.05 - \\sqrt{0.0010422984}}{1.6} = \\frac{0.05 - 0.032284646}{1.6} = \\frac{0.017715354}{1.6} \\approx 0.011072096\\,\\text{m}$\n\n将结果四舍五入到四位有效数字得到 $0.01107\\,\\text{m}$。",
            "answer": "$$\\boxed{0.01107}$$"
        },
        {
            "introduction": "托卡马克反应堆在运行过程中可能发生等离子体破裂，这是一种快速的约束丧失事件。在破裂期间，部分等离子体电流会转移到真空室壁上，形成所谓的“晕电流”。这些电流与强磁场相互作用，产生巨大的电磁力，对装置的结构完整性构成严重威胁。本练习将通过一个简化的模型，实际计算晕电流在破裂过程中施加在真空室上的洛伦兹力，这是评估反应堆机械设计的关键一步。",
            "id": "3955700",
            "problem": "考虑一个下一代燃烧等离子体托卡马克真空室段，在电流猝灭期间承受晕电流负载。假设这是一个圆形截面的托卡马克，其大半径为 $R_0=7.0\\ \\mathrm{m}$，小半径为 $a=2.3\\ \\mathrm{m}$，因此外侧中平面的接触半径为 $R_{\\mathrm{out}}=R_0+a$。在猝灭过程中我们关心的时刻，剩余等离子体电流为 $I_{\\mathrm{res}}=12.0\\times 10^{6}\\ \\mathrm{A}$。该真空室段是位于外侧中平面的一个环带，其垂直高度为 $h=1.0\\ \\mathrm{m}$，壁厚为 $t=0.050\\ \\mathrm{m}$，环向范围为 $\\Delta\\phi=100^{\\circ}$。在计算力时，所有角度积分均使用弧度制。对该环带上的净径向力有贡献的唯一磁场是极向磁场 $B_{\\theta}(R)$。对于圆形轴对称环环，该磁场可由安培定律（Ampère’s law）近似为 $B_{\\theta}(R)=\\mu_{0} I/(2\\pi R)$，其中自由空间磁导率为 $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N/A^{2}}$，且 $I=I_{\\mathrm{res}}$。\n\n假设该环带内真空室壁中的环向晕电流密度由于 $n=1$ 不对称性而在空间上不均匀，并建模为\n$$\nJ_{\\phi}(\\phi)=J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right],\n$$\n在壁厚和垂直高度上是均匀的，其中 $J_{0}=1.80\\times 10^{7}\\ \\mathrm{A/m^{2}}$，$\\varepsilon=0.30$，$\\phi$ 是在环带内从 $\\phi=0$ 到 $\\phi=\\Delta\\phi$ 测量的环向角。\n\n使用洛伦兹力密度 $\\mathbf{f}=\\mathbf{J}\\times \\mathbf{B}$，并忽略对环带不产生净径向力的贡献，通过对环带体积积分 $J_{\\phi}\\times B_{\\theta}$ 来计算环带上的净向外径向力 $F_{R}$。然后，通过计算安全裕度\n$$\nm=\\frac{F_{R}}{F_{\\mathrm{limit}}}.\n$$\n将结果与该段的许用结构极限 $F_{\\mathrm{limit}}=6.0\\times 10^{6}\\ \\mathrm{N}$ 进行比较。\n将 $m$ 的最终答案表示为无单位小数，并四舍五入到四位有效数字。在积分中使用弧度表示 $\\Delta\\phi$，并用牛顿表示任何中间力。",
            "solution": "该问题提法明确，具有科学依据，并包含了计算唯一解所需的所有信息。所用的物理模型基于洛伦兹力和安培定律，是聚变科学中此类工程分析的标准模型。所有给定参数对于下一代托卡马克都是物理上合理的。因此，该问题是有效的，解法如下。\n\n作用在真空室环带上的净向外径向力 $F_R$ 是通过对环带体积 $V$ 积分洛伦兹力密度 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$ 来确定的。问题指定了环向晕电流密度 $\\mathbf{J} = J_{\\phi}(\\phi)\\hat{\\phi}$ 和极向磁场 $\\mathbf{B} = B_{\\theta}(R)\\hat{\\theta}$。在标准柱坐标系 $(R, \\phi, Z)$ 中，环向是 $\\hat{\\phi}$ 方向。在外侧中平面，极向 $\\hat{\\theta}$ 对应于负的垂直方向，即 $-\\hat{Z}$。\n\n因此，洛伦兹力密度矢量为：\n$$ \\mathbf{f} = J_{\\phi}(\\phi)\\hat{\\phi} \\times B_{\\theta}(R)(-\\hat{Z}) = -J_{\\phi}(\\phi)B_{\\theta}(R)(\\hat{\\phi} \\times \\hat{Z}) $$\n根据柱坐标系的右手定则，$\\hat{\\phi} \\times \\hat{Z} = -\\hat{R}$，其中 $\\hat{R}$ 是向外径向的单位矢量。\n$$ \\mathbf{f} = -J_{\\phi}(\\phi)B_{\\theta}(R)(-\\hat{R}) = J_{\\phi}(\\phi)B_{\\theta}(R)\\hat{R} $$\n该力方向为径向向外，其大小为 $f_{R} = J_{\\phi}(\\phi)B_{\\theta}(R)$。总径向力 $F_{R}$ 是该力密度的体积分。在柱坐标系中，体积元为 $dV = R \\, dR \\, d\\phi \\, dZ$。\n\n总径向力由以下积分给出：\n$$ F_{R} = \\iiint_{V} f_{R} \\, dV = \\iiint_{V} J_{\\phi}(\\phi)B_{\\theta}(R) \\, R \\, dR \\, d\\phi \\, dZ $$\n问题提供了电流密度和磁场的表达式：\n$$ J_{\\phi}(\\phi) = J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right] $$\n$$ B_{\\theta}(R) = \\frac{\\mu_{0} I_{\\mathrm{res}}}{2\\pi R} $$\n将这些代入 $F_R$ 的积分中：\n$$ F_{R} = \\iiint_{V} J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right] \\left(\\frac{\\mu_{0} I_{\\mathrm{res}}}{2\\pi R}\\right) R \\, dR \\, d\\phi \\, dZ $$\n一个关键的简化是体积元中的因子 $R$ 与 $B_{\\theta}(R)$ 表达式中的 $1/R$ 依赖项相消：\n$$ F_{R} = \\iiint_{V} \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0}}{2\\pi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, dR \\, d\\phi \\, dZ $$\n现在被积函数与 $R$ 和 $Z$ 无关。积分是在真空室环带的体积上进行的，该环带的环向范围为 $\\Delta\\phi$，垂直高度为 $h$，壁厚为 $t$。积分限为 $\\phi$ 从 $0$ 到 $\\Delta\\phi$，$Z$ 从 $-h/2$ 到 $h/2$（假设环带以中平面为中心），以及 $R$ 穿过壁厚。对 $Z$ 和 $R$ 的定积分变为：\n$$ \\int_{-h/2}^{h/2} dZ = h $$\n$$ \\int_{R_{\\mathrm{in}}}^{R_{\\mathrm{out}}} dR = t $$\n力的积分简化为对环向角 $\\phi$ 的积分：\n$$ F_{R} = \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} \\int_{0}^{\\Delta\\phi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, d\\phi $$\n现在，我们对 $\\phi$ 进行积分：\n$$ \\int_{0}^{\\Delta\\phi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, d\\phi = \\left[\\phi + \\varepsilon\\sin(\\phi)\\right]_{0}^{\\Delta\\phi} = \\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi) $$\n因此，总径向力的解析表达式为：\n$$ F_{R} = \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} \\left(\\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi)\\right) $$\n给定值为：\n- $\\mu_{0} = 4\\pi \\times 10^{-7}\\ \\mathrm{N/A^{2}}$\n- $I_{\\mathrm{res}} = 12.0 \\times 10^{6}\\ \\mathrm{A}$\n- $J_{0} = 1.80 \\times 10^{7}\\ \\mathrm{A/m^{2}}$\n- $h = 1.0\\ \\mathrm{m}$\n- $t = 0.050\\ \\mathrm{m}$\n- $\\varepsilon = 0.30$\n- $\\Delta\\phi = 100^{\\circ}$，必须转换为弧度：$\\Delta\\phi = 100^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} = \\frac{5\\pi}{9}\\ \\mathrm{rad}$。\n\n首先，我们计算积分前的因子：\n$$ \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} = \\frac{(4\\pi \\times 10^{-7}) (12.0 \\times 10^{6}) (1.80 \\times 10^{7}) (1.0) (0.050)}{2\\pi} $$\n$$ = (2 \\times 10^{-7}) (12.0 \\times 10^{6}) (1.80 \\times 10^{7}) (1.0) (0.050) $$\n$$ = (2.4) (1.80 \\times 10^{7}) (0.050) = (2.4) (0.09 \\times 10^{7}) = 0.216 \\times 10^{7} = 2.16 \\times 10^{6}\\ \\mathrm{N} $$\n接下来，我们计算角度项的值：\n$$ \\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi) = \\frac{5\\pi}{9} + 0.30 \\sin\\left(\\frac{5\\pi}{9}\\right) $$\n使用计算器，$\\frac{5\\pi}{9} \\approx 1.745329$ 且 $\\sin\\left(\\frac{5\\pi}{9}\\right) \\approx 0.984808$。\n$$ 1.745329 + 0.30 \\times 0.984808 = 1.745329 + 0.295442 = 2.040771 $$\n现在，我们计算总力 $F_{R}$：\n$$ F_{R} = (2.16 \\times 10^{6}\\ \\mathrm{N}) \\times 2.040771 \\approx 4.408066 \\times 10^{6}\\ \\mathrm{N} $$\n最后一步是通过将此力与许用结构极限 $F_{\\mathrm{limit}} = 6.0 \\times 10^{6}\\ \\mathrm{N}$ 进行比较，来计算安全裕度 $m$。\n$$ m = \\frac{F_{R}}{F_{\\mathrm{limit}}} = \\frac{4.408066 \\times 10^{6}\\ \\mathrm{N}}{6.0 \\times 10^{6}\\ \\mathrm{N}} \\approx 0.7346777 $$\n按要求将结果四舍五入到四位有效数字，得到：\n$$ m \\approx 0.7347 $$",
            "answer": "$$\\boxed{0.7347}$$"
        },
        {
            "introduction": "成功处理从核心等离子体排出的巨大热负荷是实现聚变能源的关键挑战。像边界局域模（ELMs）这样的瞬态事件会在毫秒级的时间尺度上将兆焦耳级的能量沉积到偏滤器靶板上，可能导致材料熔化和侵蚀。本实践将引导您从一维热传导方程出发，推导并计算钨偏滤器表面在经受ELM热脉冲时所能承受的最大能量密度，而不超过其熔点。",
            "id": "3955737",
            "problem": "你的任务是使用半无限大固体中的一维瞬态热传导模型，确定钨偏滤器表面在不达到其熔化温度的情况下，所能承受的 Edge Localized Mode (ELM) 热脉冲的最大入射能量密度。从第一性原理出发，根据下述热方程和边界条件推导所有必要的表达式，不假设任何已知的闭式热响应解。然后通过算法实现所得表达式，以计算所要求的输出。\n\n假设与物理模型：\n- 固体为钨，占据半空间 $x \\ge 0$，初始时在所有 $x \\ge 0$ 处均处于均匀温度 $T(x,0) = T_{0}$。\n- 控制方程为一维热方程 $\\,\\partial T/\\partial t = \\alpha \\,\\partial^{2}T/\\partial x^{2}\\,$，其中热物理性质为常数。\n- 热扩散率为 $\\alpha = k/(\\rho c_{p})$，其中 $k$ 是热导率，$\\rho$ 是质量密度，$c_{p}$ 是定压比热容。\n- $x=0$ 处的表面受到一个空间上均匀、时间上恒定、持续时间为 $\\tau$ 的热通量脉冲作用：对于 $0 \\le t \\le \\tau$，边界条件为 $-k\\,(\\partial T/\\partial x)|_{x=0} = q_{0}$；对于 $t  \\tau$，边界条件为 $-k\\,(\\partial T/\\partial x)|_{x=0} = 0$。脉冲的能量密度（表面热通量的时间积分）为 $E = q_{0}\\,\\tau$。\n- 忽略任何辐射损失、蒸发或相变；唯一的约束是在脉冲期间及其后，使表面温度保持在熔化温度以下。\n\n目标：\n- 对于每个指定的测试用例，在给定初始均匀温度 $T_{0}$ 和脉冲持续时间 $\\tau$ 的情况下，计算最大允许 ELM 能量密度 $E_{\\max}$，使得 $x=0$ 处的表面温度在任何时候都不会超过钨的熔化温度 $T_{m}$。\n- 将 $E_{\\max}$ 以兆焦耳每平方米（MJ/m$^{2}$）为单位表示，并四舍五入到六位小数。\n\n钨的材料属性（所有测试用例中均为常数）：\n- 热导率 $k = $ $174$ W/(m·K)\n- 密度 $\\rho = $ $19250$ kg/m$^{3}$\n- 比热容 $c_{p} = $ $134$ J/(kg·K)\n- 熔化温度 $T_{m} = $ $3695$ K\n\n推导必须使用的基本原理：\n- 在半无限域 $x \\ge 0$ 上的一维热方程 $\\,\\partial T/\\partial t = \\alpha \\,\\partial^{2}T/\\partial x^{2}\\,$，及其所述的代表所施加表面热通量的诺伊曼（Neumann）边界条件。\n- 用于线性系统的时间叠加原理以及用于构造有限持续时间脉冲的因果律。\n\n测试套件：\n- 用例 A (正常路径)：$T_{0} = $ $1200$ K, $\\tau = $ $1.0 \\times 10^{-3}$ s。\n- 用例 B (更短脉冲，更冷壁面)：$T_{0} = $ $300$ K, $\\tau = $ $5.0 \\times 10^{-4}$ s。\n- 用例 C (接近熔化的初始壁面)：$T_{0} = $ $3600$ K, $\\tau = $ $1.0 \\times 10^{-3}$ s。\n- 用例 D (熔化边界条件)：$T_{0} = T_{m}$, $\\tau = $ $2.0 \\times 10^{-3}$ s。\n\n输出规格：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，顺序为 [用例 A, 用例 B, 用例 C, 用例 D]。每个列表元素是一个浮点数，等于以 MJ/m$^{2}$ 为单位的 $E_{\\max}$ 值，并四舍五入到六位小数。例如，输出可能看起来像 “[$x_{A}$,$x_{B}$,$x_{C}$,$x_{D}$]”，其中每个 $x$ 都四舍五入到六位小数。",
            "solution": "用户希望我解决一个一维瞬态热传导问题，以确定钨表面的最大允许能量密度。解决方案必须从第一性原理推导。\n\n**1. 问题公式化**\n\n物理系统被建模为一个半无限大固体 ($x \\ge 0$)，初始温度均匀为 $T_0$。温度演化 $T(x,t)$ 由一维热方程控制：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $\\alpha = k/(\\rho c_p)$ 是热扩散率，$k$ 是热导率，$\\rho$ 是密度，$c_p$ 是比热容。\n\n初始条件为：\n$$\nT(x,0) = T_0 \\quad \\text{for } x \\ge 0\n$$\n\n在表面 $x=0$ 处施加一个热通量脉冲。边界条件由一个诺伊曼（Neumann）条件描述：\n$$\n-k \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} = q(t)\n$$\n其中热通量 $q(t)$ 是一个持续时间为 $\\tau$、幅度为 $q_0$ 的方波脉冲：\n$$\nq(t) = \\begin{cases}\nq_0  \\text{if } 0 \\le t \\le \\tau \\\\\n0  \\text{if } t  \\tau\n\\end{cases}\n$$\n远离表面处，温度保持其初始值：\n$$\n\\lim_{x \\to \\infty} T(x,t) = T_0\n$$\n为简化问题，我们将超出初始温度的温升定义为 $\\theta(x,t) = T(x,t) - T_0$。关于 $\\theta$ 的问题是：\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2}\n$$\n其初始和边界条件为：\n$$\n\\theta(x,0) = 0\n$$\n$$\n-k \\frac{\\partial \\theta}{\\partial x}\\bigg|_{x=0} = q(t)\n$$\n$$\n\\lim_{x \\to \\infty} \\theta(x,t) = 0\n$$\n\n**2. 使用拉普拉斯变换求解阶跃热通量问题**\n\n我们首先求解在所有时间 $t \\ge 0$ 上施加恒定热通量 $q_0$（一个亥维赛（Heaviside）阶跃函数，$q(t) = q_0 H(t)$）的问题。我们对时间应用拉普拉斯变换，$\\bar{\\theta}(x,s) = \\mathcal{L}\\{\\theta(x,t)\\}$。变换后的偏微分方程（PDE）变为关于 $x$ 的常微分方程（ODE）：\n$$\ns\\bar{\\theta}(x,s) - \\theta(x,0) = \\alpha \\frac{d^2 \\bar{\\theta}(x,s)}{dx^2}\n$$\n使用初始条件 $\\theta(x,0)=0$，我们得到：\n$$\n\\frac{d^2 \\bar{\\theta}}{dx^2} - \\frac{s}{\\alpha} \\bar{\\theta} = 0\n$$\n该常微分方程的通解为：\n$$\n\\bar{\\theta}(x,s) = A(s)e^{\\sqrt{s/\\alpha}x} + B(s)e^{-\\sqrt{s/\\alpha}x}\n$$\n无穷远处的边界条件 $\\lim_{x \\to \\infty} \\theta(x,t) = 0$ 意味着 $\\lim_{x \\to \\infty} \\bar{\\theta}(x,s) = 0$。这要求 $A(s)=0$ 以确保解保持有界。因此：\n$$\n\\bar{\\theta}(x,s) = B(s)e^{-\\sqrt{s/\\alpha}x}\n$$\n表面的边界条件变为：\n$$\n\\mathcal{L}\\left\\{-k\\frac{\\partial \\theta}{\\partial x}\\bigg|_{x=0}\\right\\} = \\mathcal{L}\\{q_0 H(t)\\} \\implies -k\\frac{d\\bar{\\theta}}{dx}\\bigg|_{x=0} = \\frac{q_0}{s}\n$$\n我们求 $\\bar{\\theta}(x,s)$ 关于 $x$ 的导数：\n$$\n\\frac{d\\bar{\\theta}}{dx} = -B(s) \\sqrt{\\frac{s}{\\alpha}} e^{-\\sqrt{s/\\alpha}x}\n$$\n在 $x=0$ 处求值：\n$$\n\\frac{d\\bar{\\theta}}{dx}\\bigg|_{x=0} = -B(s) \\sqrt{\\frac{s}{\\alpha}}\n$$\n将此代入变换后的边界条件：\n$$\n-k \\left(-B(s) \\sqrt{\\frac{s}{\\alpha}}\\right) = \\frac{q_0}{s} \\implies B(s) = \\frac{q_0}{k\\sqrt{s/\\alpha}s} = \\frac{q_0\\sqrt{\\alpha}}{k} s^{-3/2}\n$$\n通过设 $x=0$，可以找到拉普拉斯域中表面温升的解：\n$$\n\\bar{\\theta}(0,s) = B(s) = \\frac{q_0\\sqrt{\\alpha}}{k} s^{-3/2}\n$$\n为求得时域中的解，我们进行拉普拉斯逆变换。使用已知的变换对 $\\mathcal{L}^{-1}\\{s^{-a}\\} = \\frac{t^{a-1}}{\\Gamma(a)}$，其中 $a=3/2$ 且 $\\Gamma(3/2)=\\frac{1}{2}\\sqrt{\\pi}$：\n$$\n\\theta_{\\text{step}}(0,t) = \\mathcal{L}^{-1}\\{\\bar{\\theta}(0,s)\\} = \\frac{q_0\\sqrt{\\alpha}}{k} \\frac{t^{1/2}}{\\Gamma(3/2)} = \\frac{q_0\\sqrt{\\alpha}}{k} \\frac{\\sqrt{t}}{\\sqrt{\\pi}/2} = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\n这是从 $t=0$ 开始的连续恒定热通量 $q_0$ 引起的表面温升。\n\n**3. 使用叠加法求解脉冲热通量问题**\n\n热通量脉冲 $q(t)$ 可以表示为两个阶跃函数的叠加：一个从 $t=0$ 开始、幅度为 $q_0$ 的正阶跃，和一个从 $t=\\tau$ 开始、幅度为 $-q_0$ 的负阶跃。\n$$\nq(t) = q_0 H(t) - q_0 H(t-\\tau)\n$$\n由于热方程的线性特性，表面的总温升 $\\theta(0,t)$ 是对这两个阶跃函数响应的总和。令 $\\Delta T_{surf}(t) = \\theta(0,t)$。\n\n对于 $0 \\le t \\le \\tau$：只有第一个阶跃函数起作用。\n$$\n\\Delta T_{surf}(t) = \\theta_{\\text{step}}(0,t) = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\n对于 $t  \\tau$：两个阶跃函数都起作用。对第二个阶跃的响应延迟了 $\\tau$。\n$$\n\\Delta T_{surf}(t) = \\theta_{\\text{step}}(0,t) - \\theta_{\\text{step}}(0, t-\\tau) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\left( \\sqrt{t} - \\sqrt{t-\\tau} \\right)\n$$\n\n**4. 寻找最大表面温度**\n\n我们需要找到在所有 $t \\ge 0$ 时表面温度 $T(0,t) = T_0 + \\Delta T_{surf}(t)$ 的最大值。这等价于寻找 $\\Delta T_{surf}(t)$ 的最大值。\n\n- 对于 $0 \\le t \\le \\tau$，$\\Delta T_{surf}(t)$ 与 $\\sqrt{t}$ 成正比，它是一个单调递增函数。在此区间内的最大值出现在端点 $t=\\tau$ 处。\n- 对于 $t  \\tau$，我们考察 $\\Delta T_{surf}(t)$ 的导数：\n$$\n\\frac{d}{dt} \\Delta T_{surf}(t) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\frac{d}{dt} \\left(\\sqrt{t} - \\sqrt{t-\\tau}\\right) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\left(\\frac{1}{2\\sqrt{t}} - \\frac{1}{2\\sqrt{t-\\tau}}\\right)\n$$\n由于 $t  t-\\tau  0$，我们有 $\\sqrt{t}  \\sqrt{t-\\tau}$，这意味着 $\\frac{1}{\\sqrt{t}}  \\frac{1}{\\sqrt{t-\\tau}}$。因此，对于所有 $t  \\tau$，导数都是负的。这意味着对于 $t  \\tau$，$\\Delta T_{surf}(t)$ 是单调递减的。\n\n最大表面温升发生在热脉冲结束的瞬间，即在 $t=\\tau$ 时。\n$$\n\\Delta T_{max, surf} = \\Delta T_{surf}(\\tau) = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}}\n$$\n最大表面温度为：\n$$\nT_{max, surf} = T_0 + \\Delta T_{max, surf} = T_0 + \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}}\n$$\n\n**5. 最大能量密度（$E_{max}$）的推导**\n\n问题要求最大表面温度不超过熔化温度 $T_m$。\n$$\nT_{max, surf} \\le T_m \\implies T_0 + \\frac{2q_{0,max}}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}} = T_m\n$$\n我们求解最大允许热通量 $q_{0,max}$：\n$$\nq_{0,max} = (T_m - T_0) \\frac{k\\sqrt{\\pi}}{2\\sqrt{\\alpha \\tau}}\n$$\n脉冲的总能量密度为 $E = q_0\\tau$。因此，最大允许能量密度 $E_{max}$ 为：\n$$\nE_{max} = q_{0,max} \\tau = (T_m - T_0) \\frac{k\\sqrt{\\pi}}{2\\sqrt{\\alpha \\tau}} \\tau = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2\\sqrt{\\alpha}}\n$$\n代入热扩散率的定义 $\\alpha = k/(\\rho c_p)$：\n$$\nE_{max} = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2\\sqrt{k/(\\rho c_p)}} = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2} \\frac{\\sqrt{\\rho c_p}}{\\sqrt{k}}\n$$\n简化后得到最终表达式：\n$$\nE_{max} = \\frac{\\sqrt{\\pi}}{2} (T_m - T_0) \\sqrt{k \\rho c_p \\tau}\n$$\n该公式将用于计算给定测试用例的结果。结果的单位是 J/m$^2$。要转换为 MJ/m$^2$，需除以 $10^6$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum allowable energy density for an ELM heat pulse on a\n    tungsten divertor without exceeding its melting temperature, based on a\n    1D transient heat conduction model in a semi-infinite solid.\n    \"\"\"\n\n    # Material properties of tungsten (W)\n    k = 174.0       # Thermal conductivity in W/(m·K)\n    rho = 19250.0   # Density in kg/m^3\n    cp = 134.0      # Specific heat capacity in J/(kg·K)\n    Tm = 3695.0     # Melting temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T0, tau)\n    # T0 is the initial temperature in K\n    # tau is the pulse duration in s\n    test_cases = [\n        (1200.0, 1.0e-3),  # Case A\n        (300.0, 5.0e-4),   # Case B\n        (3600.0, 1.0e-3),  # Case C\n        (Tm, 2.0e-3),      # Case D\n    ]\n\n    results = []\n    \n    # Pre-calculate the material property group for efficiency\n    # This term represents the square of the thermal effusivity\n    k_rho_cp = k * rho * cp\n\n    for T0, tau in test_cases:\n        # The derived formula for the maximum allowable energy density (E_max) is:\n        # E_max = (sqrt(pi)/2) * (Tm - T0) * sqrt(k * rho * cp * tau)\n        # The result of this formula is in J/m^2.\n\n        delta_T = Tm - T0\n        \n        # Handle the case where initial temperature is already at or above melting\n        if delta_T = 0:\n            E_max_joules = 0.0\n        else:\n            E_max_joules = (np.sqrt(np.pi) / 2.0) * delta_T * np.sqrt(k_rho_cp * tau)\n\n        # Convert the result from J/m^2 to MJ/m^2\n        E_max_megajoules = E_max_joules / 1.0e6\n        \n        # Round to six decimal places as specified\n        results.append(round(E_max_megajoules, 6))\n\n    # Format the results into the required string output\n    output_string = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}