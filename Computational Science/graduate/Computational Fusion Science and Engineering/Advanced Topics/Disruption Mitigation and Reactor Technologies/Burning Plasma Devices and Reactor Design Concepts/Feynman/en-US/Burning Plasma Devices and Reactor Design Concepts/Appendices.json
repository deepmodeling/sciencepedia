{
    "hands_on_practices": [
        {
            "introduction": "Sustaining a burning plasma requires maintaining the integrity of the magnetic field that confines the hot fuel. This exercise delves into the physics of tearing modes, a key magnetohydrodynamic (MHD) instability that can tear and reconnect magnetic field lines, creating 'magnetic islands' that degrade confinement. By working through the modified Rutherford equation, you will calculate the saturated size of a magnetic island under the influence of both intrinsic plasma effects and external control fields, providing a foundational skill for designing stable operating scenarios .",
            "id": "3955705",
            "problem": "A burning-plasma tokamak operates in a parameter regime where a single-helicity tearing instability at the rational surface radius $r_s$ interacts with an externally applied resonant magnetic perturbation of vacuum amplitude $b_r$. Working within resistive Magnetohydrodynamics (MHD) and the constant-$\\psi$ approximation, consider an $m/n$ island whose half-width $w$ evolves nonlinearly due to the tearing index $\\Delta'$, a neoclassical polarization-current stabilization characterized by a dimensionless coefficient $K_{\\text{pol}}$, and a torque-coupled phase response to the external field that is reduced when the plasma rotates. Assume the following physics base:\n\n- The induction equation follows from Ohm’s law, $ \\mathbf{E} + \\mathbf{v}\\times \\mathbf{B} = \\eta \\mathbf{J}$, with resistivity $\\eta$, and magnetic permeability $\\mu_0$.\n- The classical Rutherford ordering and constant-$\\psi$ matching yields a nonlinear evolution of the island width $w(t)$ proportional to the resistive diffusivity $D_{\\eta} = \\eta/\\mu_0$ times a bracket containing the tearing stability index $\\Delta'$ plus nonlinear terms that scale as inverse powers of $w$.\n- The neoclassical polarization-current effect produces a stabilizing term that scales as $-K_{\\text{pol}}/w$ in the nonlinear drive bracket.\n- The externally applied resonant field produces an additional drive that, within constant-$\\psi$ matching, scales as $+\\alpha (r_s/B_{\\theta}) (b_r \\cos\\phi)/w^2$ in the nonlinear drive bracket, where $B_{\\theta}$ is the equilibrium poloidal magnetic field at $r_s$, $\\phi$ is the phase difference between the island and the external field, and $\\alpha$ is a geometry/matching constant, determined by the standard inner-outer matching integral for a vacuum resonant perturbation.\n- A simple linear torque-phase model gives $\\tan\\phi = \\omega/\\omega_c$, where $\\omega$ is the plasma rotation frequency at the rational surface and $\\omega_c$ is a characteristic electromagnetic locking rate. Hence, $\\cos\\phi = 1/\\sqrt{1+(\\omega/\\omega_c)^2}$.\n\nUnder these assumptions, the steady-state saturated island width $w_{\\text{sat}}$ is obtained from setting the nonlinear drive bracket to zero and solving for $w$. Use the specified parameters:\n- $r_s = 1.00\\,\\text{m}$,\n- $B_{\\theta} = 0.50\\,\\text{T}$,\n- $\\Delta' = 0.80\\,\\text{m}^{-1}$,\n- $K_{\\text{pol}} = 0.050$,\n- $b_r = 1.00\\times 10^{-4}\\,\\text{T}$,\n- $\\omega = 300\\,\\text{rad}\\,\\text{s}^{-1}$,\n- $\\omega_c = 600\\,\\text{rad}\\,\\text{s}^{-1}$,\n\nand take the standard constant-$\\psi$ vacuum-resonant matching constant to be $\\alpha = 8/\\pi$. Derive the steady-state condition from first principles and compute $w_{\\text{sat}}$ including rotation (via $\\cos\\phi$). Express your final answer in meters and round your result to four significant figures. In your reasoning, assess how rotation braking (i.e., decreasing $\\omega$ toward zero) affects the saturated island width, but report only the value including the given nonzero $\\omega$.",
            "solution": "The user has requested a solution to a problem in magnetohydrodynamic (MHD) stability, specifically concerning the saturated width of a tearing mode island in a tokamak. The solution must be preceded by a strict validation of the problem statement.\n\n### Step 1: Extract Givens\n\n-   **Model:** Resistive MHD, constant-$\\psi$ approximation for an $m/n$ tearing instability.\n-   **Rational Surface Radius:** $r_s = 1.00\\,\\text{m}$\n-   **Equilibrium Poloidal Magnetic Field:** $B_{\\theta} = 0.50\\,\\text{T}$\n-   **Tearing Stability Index:** $\\Delta' = 0.80\\,\\text{m}^{-1}$\n-   **Neoclassical Polarization Coefficient:** $K_{\\text{pol}} = 0.050$ (dimensionless)\n-   **Vacuum Resonant Magnetic Perturbation Amplitude:** $b_r = 1.00\\times 10^{-4}\\,\\text{T}$\n-   **Plasma Rotation Frequency:** $\\omega = 300\\,\\text{rad}\\,\\text{s}^{-1}$\n-   **Characteristic Locking Rate:** $\\omega_c = 600\\,\\text{rad}\\,\\text{s}^{-1}$\n-   **Geometry/Matching Constant:** $\\alpha = 8/\\pi$\n-   **Island Width Evolution Physics:** The nonlinear evolution of the island half-width $w(t)$ is determined by a drive bracket containing:\n    1.  A classical tearing drive $\\Delta'$.\n    2.  A neoclassical polarization current stabilizing term scaling as $-K_{\\text{pol}}/w$.\n    3.  An external field drive term scaling as $+\\alpha (r_s/B_{\\theta}) (b_r \\cos\\phi)/w^2$.\n-   **Phase Relation:** The phase difference $\\phi$ between the island and the external field is given by $\\tan\\phi = \\omega/\\omega_c$, which implies $\\cos\\phi = 1/\\sqrt{1+(\\omega/\\omega_c)^2}$.\n-   **Objective:** Compute the steady-state saturated island width $w_{\\text{sat}}$ in meters, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is subjected to validation against the specified criteria.\n\n-   **Scientific Grounding:** The problem is based on the modified Rutherford equation, a cornerstone of nonlinear tearing mode theory in fusion plasmas. The terms representing the classical tearing index ($\\Delta'$), neoclassical polarization currents, and external resonant magnetic perturbations are standard components of this model. The physical framework is well-established within plasma physics and MHD. The problem is scientifically sound.\n-   **Well-Posedness:** The problem asks for the solution of a specific algebraic equation that results from the steady-state condition. All parameters and functional forms are provided, leading to a well-defined mathematical problem with an expectation of a physically meaningful solution.\n-   **Objectivity:** The problem is stated in precise, quantitative, and unbiased technical language.\n-   **Completeness and Consistency:** All necessary parameters are provided to solve for the saturated island width. The units of the terms in the governing equation are checked for consistency.\n    -   $\\Delta'$ has units of $\\text{m}^{-1}$.\n    -   $-K_{\\text{pol}}/w$ has units of $\\text{m}^{-1}$ since $K_{\\text{pol}}$ is dimensionless.\n    -   The external field term has units $\\frac{[\\text{m}]}{[\\text{T}]} \\frac{[\\text{T}]}{[\\text{m}]^2} = \\text{m}^{-1}$.\n    All terms are dimensionally consistent. The problem is complete and self-consistent.\n-   **Realism and Feasibility:** The given numerical values for magnetic fields, dimensions, frequencies, and stability parameters are physically plausible for a conventional tokamak.\n-   **Structure and Clarity:** The problem is clearly structured, defining the physical model, providing all parameters, and stating a clear objective. The terms are defined unambiguously.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid** as it is scientifically grounded, well-posed, complete, and consistent. I will now proceed to derive the solution.\n\n### Derivation of the Solution\n\nThe evolution of the magnetic island half-width $w$ is governed by the modified Rutherford equation. Based on the problem statement, the net drive for the island growth is proportional to a bracket $\\mathcal{D}(w)$ which sums the contributions from the classical tearing drive, neoclassical effects, and the external magnetic perturbation. A steady-state saturated island, where $dw/dt = 0$, corresponds to the condition where this net drive is zero.\n\nThe drive bracket $\\mathcal{D}(w)$ is given by:\n$$\n\\mathcal{D}(w) = \\Delta' - \\frac{K_{\\text{pol}}}{w} + \\alpha \\frac{r_s}{B_{\\theta}} \\frac{b_r \\cos\\phi}{w^2}\n$$\nFor a steady-state saturated island of width $w_{\\text{sat}}$, we must have $\\mathcal{D}(w_{\\text{sat}}) = 0$:\n$$\n\\Delta' - \\frac{K_{\\text{pol}}}{w_{\\text{sat}}} + \\alpha \\frac{r_s}{B_{\\theta}} \\frac{b_r \\cos\\phi}{w_{\\text{sat}}^2} = 0\n$$\nTo solve for $w_{\\text{sat}}$, we can multiply by $w_{\\text{sat}}^2$ to obtain a quadratic equation in $w_{\\text{sat}}$:\n$$\n\\Delta' w_{\\text{sat}}^2 - K_{\\text{pol}} w_{\\text{sat}} + \\alpha \\frac{r_s b_r}{B_{\\theta}} \\cos\\phi = 0\n$$\nThis is a standard quadratic equation of the form $Aw^2 + Bw + C = 0$, with coefficients:\n-   $A = \\Delta'$\n-   $B = -K_{\\text{pol}}$\n-   $C = \\alpha \\frac{r_s b_r}{B_{\\theta}} \\cos\\phi$\n\nFirst, we calculate the term $\\cos\\phi$ using the given plasma rotation parameters:\n$$\n\\frac{\\omega}{\\omega_c} = \\frac{300\\,\\text{rad}\\,\\text{s}^{-1}}{600\\,\\text{rad}\\,\\text{s}^{-1}} = 0.5\n$$\n$$\n\\cos\\phi = \\frac{1}{\\sqrt{1 + (\\omega/\\omega_c)^2}} = \\frac{1}{\\sqrt{1 + (0.5)^2}} = \\frac{1}{\\sqrt{1.25}} = \\frac{1}{\\sqrt{5/4}} = \\frac{2}{\\sqrt{5}}\n$$\nNext, we substitute the given parameter values into the coefficients $A$, $B$, and $C$:\n-   $A = \\Delta' = 0.80\\,\\text{m}^{-1}$\n-   $B = -K_{\\text{pol}} = -0.050$\n-   $C = \\left(\\frac{8}{\\pi}\\right) \\frac{(1.00\\,\\text{m}) (1.00 \\times 10^{-4}\\,\\text{T})}{0.50\\,\\text{T}} \\left(\\frac{2}{\\sqrt{5}}\\right) = \\frac{1.6 \\times 10^{-3}}{\\pi \\sqrt{1.25}}\\,\\text{m} \\approx 4.5553 \\times 10^{-4}\\,\\text{m}$\n\nThe quadratic equation for $w_{\\text{sat}}$ is:\n$$\n(0.80) w_{\\text{sat}}^2 - (0.050) w_{\\text{sat}} + (4.5553 \\times 10^{-4}) = 0\n$$\nThe solutions are given by the quadratic formula, $w_{\\text{sat}} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$:\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{(-0.050)^2 - 4(0.80)(4.5553 \\times 10^{-4})}}{2(0.80)}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{2.5 \\times 10^{-3} - 1.4577 \\times 10^{-3}}}{1.6}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{1.0423 \\times 10^{-3}}}{1.6}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm 0.03228}{1.6}\n$$\nThis yields two positive real roots:\n-   $w_1 = \\frac{0.050 + 0.03228}{1.6} = \\frac{0.08228}{1.6} \\approx 0.0514\\,\\text{m}$\n-   $w_2 = \\frac{0.050 - 0.03228}{1.6} = \\frac{0.01772}{1.6} \\approx 0.0111\\,\\text{m}$\n\nTo determine which root corresponds to the stable saturated state, we analyze the stability. The island evolution is described by $dw/dt \\propto \\mathcal{D}(w)$. A state $w_{\\text{sat}}$ is stable if a small perturbation away from it returns it to $w_{\\text{sat}}$. This requires the derivative $\\mathcal{D}'(w)$ evaluated at $w_{\\text{sat}}$ to be negative.\nThe function $\\mathcal{D}(w) = \\Delta' - K_{\\text{pol}}/w + C/w^2$ (where $C$ is the constant part of the third term) behaves as follows:\n-   As $w \\to 0^+$, $\\mathcal{D}(w) \\to +\\infty$.\n-   As $w \\to \\infty$, $\\mathcal{D}(w) \\to \\Delta'  0$.\nSince the function $\\mathcal{D}(w)$ is positive for very small and very large $w$, and we have two roots, it must be negative between the roots. Let $w_2  w_1$.\n-   For $w \\in (0, w_2)$, $\\mathcal{D}(w)  0$, so $dw/dt  0$. An island grows towards $w_2$.\n-   For $w \\in (w_2, w_1)$, $\\mathcal{D}(w)  0$, so $dw/dt  0$. An island shrinks towards $w_2$.\n-   For $w  w_1$, $\\mathcal{D}(w)  0$, so $dw/dt  0$. An island grows away from $w_1$.\nThis analysis shows that the smaller root, $w_2$, is the stable saturated state, while the larger root, $w_1$, is an unstable threshold. The physically observed saturated island width is therefore $w_2$.\n\nNow, we assess the effect of rotation braking, as requested. Rotation braking corresponds to $\\omega \\to 0$. In this limit, $\\omega/\\omega_c \\to 0$ and $\\cos\\phi \\to 1$. A larger $\\cos\\phi$ increases the coefficient $C$ in the quadratic equation. The quadratic function $\\Delta' w^2 - K_{\\text{pol}} w + C$ shifts vertically upwards. This causes its two roots to move closer to the vertex of the parabola, which is located at $w_v = K_{\\text{pol}}/(2\\Delta')$. The smaller root $w_2$ increases and the larger root $w_1$ decreases. Thus, braking the plasma rotation increases the stable saturated island width. This is physically consistent, as a stronger external field drive (larger $\\cos\\phi$) should result in a larger island.\n\nThe problem asks for the numerical value of $w_{\\text{sat}}$ for the given non-zero rotation. This is the stable root $w_2$. Using higher precision for the calculation:\n$A = 0.8$\n$B = -0.05$\n$C = \\frac{1.6 \\times 10^{-3}}{\\pi \\sqrt{1.25}} \\approx 4.5553175 \\times 10^{-4}$\n$w_2 = \\frac{-B - \\sqrt{B^2 - 4AC}}{2A} = \\frac{0.05 - \\sqrt{0.0025 - 4(0.8)(4.5553175 \\times 10^{-4})}}{1.6}$\n$w_2 = \\frac{0.05 - \\sqrt{0.0010422984}}{1.6} = \\frac{0.05 - 0.032284646}{1.6} = \\frac{0.017715354}{1.6} \\approx 0.011072096\\,\\text{m}$\n\nRounding the result to four significant figures gives $0.01107\\,\\text{m}$.",
            "answer": "$$\\boxed{0.01107}$$"
        },
        {
            "introduction": "A fusion reactor must continuously exhaust power levels comparable to a small power plant onto components just meters away from the 100-million-degree core. This exercise  tackles this immense challenge by modeling the thermal response of a tungsten divertor—the primary plasma-facing component—to an intense heat pulse from an Edge Localized Mode (ELM). Deriving the surface temperature evolution from the fundamental heat equation will allow you to determine the maximum survivable heat load, a critical design parameter that dictates the operational limits of the machine.",
            "id": "3955737",
            "problem": "You are tasked with determining the maximum incident energy density of an Edge Localized Mode (ELM) heat pulse that a tungsten divertor surface can withstand without reaching its melting temperature, using one-dimensional transient heat conduction in a semi-infinite solid. Start from first principles and derive all necessary expressions from the heat equation and the boundary conditions described below, without assuming any pre-known closed-form thermal response. Then implement the resulting expression algorithmically to compute the requested outputs.\n\nAssumptions and physical model:\n- The solid is tungsten occupying the half-space $x \\ge 0$, initially at a uniform temperature $T(x,0) = T_{0}$ for all $x \\ge 0$.\n- The governing equation is the one-dimensional heat equation $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$ with constant thermophysical properties.\n- The thermal diffusivity is $\\alpha = k/(\\rho c_{p})$, where $k$ is thermal conductivity, $\\rho$ is mass density, and $c_{p}$ is specific heat capacity at constant pressure.\n- The surface at $x=0$ is subjected to a uniform-in-space, constant-in-time heat flux pulse of duration $\\tau$: for $0 \\le t \\le \\tau$, the boundary condition is $-k \\frac{\\partial T}{\\partial x}\\big|_{x=0} = q_{0}$, and for $t  \\tau$ it is $-k \\frac{\\partial T}{\\partial x}\\big|_{x=0} = 0$. The energy density (time-integrated surface heat flux) of the pulse is $E = q_{0}\\,\\tau$.\n- Ignore any radiative losses, evaporation, or phase change; the constraint is solely to keep the surface temperature below the melting temperature for the duration of and after the pulse.\n\nObjective:\n- For each specified test case, compute the maximum allowable ELM energy density $E_{\\max}$ such that the surface temperature at $x=0$ does not exceed the tungsten melting temperature $T_{m}$ at any time, given an initial uniform temperature $T_{0}$ and pulse duration $\\tau$.\n- Express $E_{\\max}$ in megajoules per square meter (MJ/m$^{2}$), rounded to six decimal places.\n\nMaterial properties of tungsten (constant for all test cases):\n- Thermal conductivity $k = $ $174$ W/(m·K)\n- Density $\\rho = $ $19250$ kg/m$^{3}$\n- Specific heat capacity $c_{p} = $ $134$ J/(kg·K)\n- Melting temperature $T_{m} = $ $3695$ K\n\nFundamental base you must use for derivation:\n- The one-dimensional heat equation $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$ on a semi-infinite domain $x \\ge 0$ with the stated Neumann boundary condition representing the applied surface heat flux.\n- Superposition in time for linear systems and causality for constructing finite-duration pulses.\n\nTest suite:\n- Case A (happy path): $T_{0} = $ $1200$ K, $\\tau = $ $1.0 \\times 10^{-3}$ s.\n- Case B (shorter pulse, colder wall): $T_{0} = $ $300$ K, $\\tau = $ $5.0 \\times 10^{-4}$ s.\n- Case C (near-melting initial wall): $T_{0} = $ $3600$ K, $\\tau = $ $1.0 \\times 10^{-3}$ s.\n- Case D (boundary condition at melt): $T_{0} = T_{m}$, $\\tau = $ $2.0 \\times 10^{-3}$ s.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order [Case A, Case B, Case C, Case D]. Each list element is a float equal to $E_{\\max}$ in MJ/m$^{2}$ rounded to six decimal places. For example, an output could look like \"[$x_{A}$,$x_{B}$,$x_{C}$,$x_{D}$]\" where each $x$ is rounded to six decimal places.",
            "solution": "The user wants me to solve a one-dimensional transient heat conduction problem to determine the maximum allowable energy density on a tungsten surface. The solution must be derived from first principles.\n\n**1. Problem Formulation**\n\nThe physical system is modeled as a semi-infinite solid ($x \\ge 0$) initially at a uniform temperature $T_0$. The temperature evolution $T(x,t)$ is governed by the one-dimensional heat equation:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nwhere $\\alpha = k/(\\rho c_p)$ is the thermal diffusivity, with $k$ being the thermal conductivity, $\\rho$ the density, and $c_p$ the specific heat capacity.\n\nThe initial condition is:\n$$\nT(x,0) = T_0 \\quad \\text{for } x \\ge 0\n$$\n\nA heat flux pulse is applied at the surface $x=0$. The boundary condition is described by a Neumann condition:\n$$\n-k \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} = q(t)\n$$\nwhere the heat flux $q(t)$ is a square pulse of duration $\\tau$ and magnitude $q_0$:\n$$\nq(t) = \\begin{cases}\nq_0  \\text{if } 0 \\le t \\le \\tau \\\\\n0  \\text{if } t  \\tau\n\\end{cases}\n$$\nFar from the surface, the temperature remains at its initial value:\n$$\n\\lim_{x \\to \\infty} T(x,t) = T_0\n$$\nTo simplify the problem, we define the temperature rise above the initial temperature as $\\theta(x,t) = T(x,t) - T_0$. The problem for $\\theta$ is:\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2}\n$$\nwith initial and boundary conditions:\n$$\n\\theta(x,0) = 0\n$$\n$$\n-k \\frac{\\partial \\theta}{\\partial x}\\bigg|_{x=0} = q(t)\n$$\n$$\n\\lim_{x \\to \\infty} \\theta(x,t) = 0\n$$\n\n**2. Solution for a Step Heat Flux using Laplace Transforms**\n\nWe first solve the problem for a constant heat flux $q_0$ applied for all time $t \\ge 0$ (a Heaviside step function, $q(t) = q_0 H(t)$). We apply the Laplace transform with respect to time, $\\bar{\\theta}(x,s) = \\mathcal{L}\\{\\theta(x,t)\\}$. The transformed PDE becomes an ordinary differential equation (ODE) in $x$:\n$$\ns\\bar{\\theta}(x,s) - \\theta(x,0) = \\alpha \\frac{d^2 \\bar{\\theta}(x,s)}{dx^2}\n$$\nUsing the initial condition $\\theta(x,0)=0$, we get:\n$$\n\\frac{d^2 \\bar{\\theta}}{dx^2} - \\frac{s}{\\alpha} \\bar{\\theta} = 0\n$$\nThe general solution to this ODE is:\n$$\n\\bar{\\theta}(x,s) = A(s)e^{\\sqrt{s/\\alpha}x} + B(s)e^{-\\sqrt{s/\\alpha}x}\n$$\nThe boundary condition at infinity, $\\lim_{x \\to \\infty} \\theta(x,t) = 0$, implies $\\lim_{x \\to \\infty} \\bar{\\theta}(x,s) = 0$. This requires $A(s)=0$ to ensure the solution remains bounded. Thus:\n$$\n\\bar{\\theta}(x,s) = B(s)e^{-\\sqrt{s/\\alpha}x}\n$$\nThe boundary condition at the surface becomes:\n$$\n\\mathcal{L}\\left\\{-k\\frac{\\partial \\theta}{\\partial x}\\bigg|_{x=0}\\right\\} = \\mathcal{L}\\{q_0 H(t)\\} \\implies -k\\frac{d\\bar{\\theta}}{dx}\\bigg|_{x=0} = \\frac{q_0}{s}\n$$\nWe find the derivative of $\\bar{\\theta}(x,s)$ with respect to $x$:\n$$\n\\frac{d\\bar{\\theta}}{dx} = -B(s) \\sqrt{\\frac{s}{\\alpha}} e^{-\\sqrt{s/\\alpha}x}\n$$\nEvaluating at $x=0$:\n$$\n\\frac{d\\bar{\\theta}}{dx}\\bigg|_{x=0} = -B(s) \\sqrt{\\frac{s}{\\alpha}}\n$$\nSubstituting this into the transformed boundary condition:\n$$\n-k \\left(-B(s) \\sqrt{\\frac{s}{\\alpha}}\\right) = \\frac{q_0}{s} \\implies B(s) = \\frac{q_0}{k\\sqrt{s/\\alpha}s} = \\frac{q_0\\sqrt{\\alpha}}{k} s^{-3/2}\n$$\nThe solution for the surface temperature rise in the Laplace domain is found by setting $x=0$:\n$$\n\\bar{\\theta}(0,s) = B(s) = \\frac{q_0\\sqrt{\\alpha}}{k} s^{-3/2}\n$$\nTo find the solution in the time domain, we take the inverse Laplace transform. Using the known transform pair $\\mathcal{L}^{-1}\\{s^{-a}\\} = \\frac{t^{a-1}}{\\Gamma(a)}$, with $a=3/2$ and $\\Gamma(3/2)=\\frac{1}{2}\\sqrt{\\pi}$:\n$$\n\\theta_{\\text{step}}(0,t) = \\mathcal{L}^{-1}\\{\\bar{\\theta}(0,s)\\} = \\frac{q_0\\sqrt{\\alpha}}{k} \\frac{t^{1/2}}{\\Gamma(3/2)} = \\frac{q_0\\sqrt{\\alpha}}{k} \\frac{\\sqrt{t}}{\\sqrt{\\pi}/2} = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\nThis is the surface temperature rise for a continuous, constant heat flux $q_0$ starting at $t=0$.\n\n**3. Solution for a Pulsed Heat Flux using Superposition**\n\nThe heat flux pulse $q(t)$ can be represented as the superposition of two step functions: a positive step of magnitude $q_0$ starting at $t=0$, and a negative step of magnitude $-q_0$ starting at $t=\\tau$.\n$$\nq(t) = q_0 H(t) - q_0 H(t-\\tau)\n$$\nDue to the linearity of the heat equation, the total temperature rise at the surface, $\\theta(0,t)$, is the sum of the responses to these two step functions. Let $\\Delta T_{surf}(t) = \\theta(0,t)$.\n\nFor $0 \\le t \\le \\tau$: Only the first step function contributes.\n$$\n\\Delta T_{surf}(t) = \\theta_{\\text{step}}(0,t) = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\nFor $t  \\tau$: Both step functions contribute. The response to the second step is delayed by $\\tau$.\n$$\n\\Delta T_{surf}(t) = \\theta_{\\text{step}}(0,t) - \\theta_{\\text{step}}(0, t-\\tau) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\left( \\sqrt{t} - \\sqrt{t-\\tau} \\right)\n$$\n\n**4. Finding the Maximum Surface Temperature**\n\nWe need to find the maximum value of the surface temperature, $T(0,t) = T_0 + \\Delta T_{surf}(t)$, for all $t \\ge 0$. This is equivalent to finding the maximum of $\\Delta T_{surf}(t)$.\n\n- For $0 \\le t \\le \\tau$, $\\Delta T_{surf}(t)$ is proportional to $\\sqrt{t}$, which is a monotonically increasing function. Its maximum value in this interval occurs at the endpoint, $t=\\tau$.\n- For $t  \\tau$, we examine the derivative of $\\Delta T_{surf}(t)$:\n$$\n\\frac{d}{dt} \\Delta T_{surf}(t) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\frac{d}{dt} \\left(\\sqrt{t} - \\sqrt{t-\\tau}\\right) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\left(\\frac{1}{2\\sqrt{t}} - \\frac{1}{2\\sqrt{t-\\tau}}\\right)\n$$\nSince $t  t-\\tau  0$, we have $\\sqrt{t}  \\sqrt{t-\\tau}$, which implies $\\frac{1}{\\sqrt{t}}  \\frac{1}{\\sqrt{t-\\tau}}$. Therefore, the derivative is negative for all $t  \\tau$. This means $\\Delta T_{surf}(t)$ is monotonically decreasing for $t  \\tau$.\n\nThe maximum surface temperature rise occurs at the instant the heat pulse ends, i.e., at $t=\\tau$.\n$$\n\\Delta T_{max, surf} = \\Delta T_{surf}(\\tau) = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}}\n$$\nThe maximum surface temperature is:\n$$\nT_{max, surf} = T_0 + \\Delta T_{max, surf} = T_0 + \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}}\n$$\n\n**5. Derivation of Maximum Energy Density ($E_{max}$)**\n\nThe problem requires that the maximum surface temperature does not exceed the melting temperature, $T_m$.\n$$\nT_{max, surf} \\le T_m \\implies T_0 + \\frac{2q_{0,max}}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}} = T_m\n$$\nWe solve for the maximum allowable heat flux, $q_{0,max}$:\n$$\nq_{0,max} = (T_m - T_0) \\frac{k\\sqrt{\\pi}}{2\\sqrt{\\alpha \\tau}}\n$$\nThe total energy density of the pulse is $E = q_0\\tau$. The maximum allowable energy density, $E_{max}$, is therefore:\n$$\nE_{max} = q_{0,max} \\tau = (T_m - T_0) \\frac{k\\sqrt{\\pi}}{2\\sqrt{\\alpha \\tau}} \\tau = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2\\sqrt{\\alpha}}\n$$\nSubstituting the definition of thermal diffusivity, $\\alpha = k/(\\rho c_p)$:\n$$\nE_{max} = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2\\sqrt{k/(\\rho c_p)}} = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2} \\frac{\\sqrt{\\rho c_p}}{\\sqrt{k}}\n$$\nThis simplifies to the final expression:\n$$\nE_{max} = \\frac{\\sqrt{\\pi}}{2} (T_m - T_0) \\sqrt{k \\rho c_p \\tau}\n$$\nThis formula will be used to compute the results for the given test cases. The result is in J/m$^2$. To convert to MJ/m$^2$, we divide by $10^6$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum allowable energy density for an ELM heat pulse on a\n    tungsten divertor without exceeding its melting temperature, based on a\n    1D transient heat conduction model in a semi-infinite solid.\n    \"\"\"\n\n    # Material properties of tungsten (W)\n    k = 174.0       # Thermal conductivity in W/(m·K)\n    rho = 19250.0   # Density in kg/m^3\n    cp = 134.0      # Specific heat capacity in J/(kg·K)\n    Tm = 3695.0     # Melting temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T0, tau)\n    # T0 is the initial temperature in K\n    # tau is the pulse duration in s\n    test_cases = [\n        (1200.0, 1.0e-3),  # Case A\n        (300.0, 5.0e-4),   # Case B\n        (3600.0, 1.0e-3),  # Case C\n        (Tm, 2.0e-3),      # Case D\n    ]\n\n    results = []\n    \n    # Pre-calculate the material property group for efficiency\n    # This term represents the square of the thermal effusivity\n    k_rho_cp = k * rho * cp\n\n    for T0, tau in test_cases:\n        # The derived formula for the maximum allowable energy density (E_max) is:\n        # E_max = (sqrt(pi)/2) * (Tm - T0) * sqrt(k * rho * cp * tau)\n        # The result of this formula is in J/m^2.\n\n        delta_T = Tm - T0\n        \n        # Handle the case where initial temperature is already at or above melting\n        if delta_T = 0:\n            E_max_joules = 0.0\n        else:\n            E_max_joules = (np.sqrt(np.pi) / 2.0) * delta_T * np.sqrt(k_rho_cp * tau)\n\n        # Convert the result from J/m^2 to MJ/m^2\n        E_max_megajoules = E_max_joules / 1.0e6\n        \n        # Round to six decimal places as specified\n        results.append(round(E_max_megajoules, 6))\n\n    # Format the results into the required string output\n    output_string = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Designing a robust fusion reactor involves preparing for off-normal events as much as for steady-state operation. This practice explores the structural consequences of a major plasma disruption, where the loss of confinement can induce enormous electromechanical forces on the surrounding vacuum vessel. You will apply the fundamental Lorentz force law to calculate the stress from 'halo currents' that flow between the terminating plasma and the vessel wall, a crucial analysis for ensuring the structural integrity and safety of the device .",
            "id": "3955700",
            "problem": "Consider a next-generation burning-plasma tokamak vacuum vessel segment subject to halo current loading during a current quench. Assume a circular cross-section tokamak with major radius $R_0=7.0\\ \\mathrm{m}$ and minor radius $a=2.3\\ \\mathrm{m}$, so that the outboard midplane contact radius is $R_{\\mathrm{out}}=R_0+a$. At the instant of interest during the quench, the residual plasma current is $I_{\\mathrm{res}}=12.0\\times 10^{6}\\ \\mathrm{A}$. The vessel segment is an outboard midplane band of vertical height $h=1.0\\ \\mathrm{m}$, wall thickness $t=0.050\\ \\mathrm{m}$, and toroidal extent $\\Delta\\phi=100^{\\circ}$. For force calculation, use radians for all angular integrals. The only magnetic field contribution relevant to the net radial force on this band is the poloidal magnetic field $B_{\\theta}(R)$, which for a circular, axisymmetric torus may be approximated by Ampère’s law as $B_{\\theta}(R)=\\mu_{0} I/(2\\pi R)$, with permeability of free space $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N/A^{2}}$ and $I=I_{\\mathrm{res}}$.\n\nAssume the toroidally directed halo current density within the vessel wall in this band is spatially nonuniform due to an $n=1$ asymmetry and is modeled as\n$$\nJ_{\\phi}(\\phi)=J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right],\n$$\nuniform across the wall thickness and the vertical height, where $J_{0}=1.80\\times 10^{7}\\ \\mathrm{A/m^{2}}$, $\\varepsilon=0.30$, and $\\phi$ is the toroidal angle measured within the band from $\\phi=0$ to $\\phi=\\Delta\\phi$.\n\nUsing the Lorentz force density $\\mathbf{f}=\\mathbf{J}\\times \\mathbf{B}$ and neglecting contributions that do not produce a net radial force on the band, compute the net outward radial force $F_{R}$ on the vessel band by integrating $J_{\\phi}\\times B_{\\theta}$ over the band volume. Then, compare the result to the allowable structural limit for this segment, $F_{\\mathrm{limit}}=6.0\\times 10^{6}\\ \\mathrm{N}$, by forming the safety margin\n$$\nm=\\frac{F_{R}}{F_{\\mathrm{limit}}}.\n$$\nExpress your final answer for $m$ as a unitless decimal rounded to four significant figures. Use radians for $\\Delta\\phi$ in the integration and express any intermediate forces in newtons.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information to compute a unique solution. The physical model, based on the Lorentz force and Ampère's law, is standard for this type of engineering analysis in fusion science. All given parameters are physically plausible for a next-generation tokamak. Therefore, the problem is valid, and a solution is derived as follows.\n\nThe net outward radial force $F_{R}$ on the vessel band is determined by integrating the Lorentz force density, $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$, over the volume $V$ of the band. The problem specifies a toroidally directed halo current density $\\mathbf{J} = J_{\\phi}(\\phi)\\hat{\\phi}$ and a poloidal magnetic field $\\mathbf{B} = B_{\\theta}(R)\\hat{\\theta}$. In a standard cylindrical coordinate system $(R, \\phi, Z)$, the toroidal direction is $\\hat{\\phi}$. At the outboard midplane, the poloidal direction $\\hat{\\theta}$ corresponds to the negative vertical direction, $-\\hat{Z}$.\n\nThe Lorentz force density vector is therefore:\n$$ \\mathbf{f} = J_{\\phi}(\\phi)\\hat{\\phi} \\times B_{\\theta}(R)(-\\hat{Z}) = -J_{\\phi}(\\phi)B_{\\theta}(R)(\\hat{\\phi} \\times \\hat{Z}) $$\nUsing the right-hand rule for cylindrical coordinates, $\\hat{\\phi} \\times \\hat{Z} = -\\hat{R}$, where $\\hat{R}$ is the unit vector in the outward radial direction.\n$$ \\mathbf{f} = -J_{\\phi}(\\phi)B_{\\theta}(R)(-\\hat{R}) = J_{\\phi}(\\phi)B_{\\theta}(R)\\hat{R} $$\nThe force is directed radially outward, and its magnitude is $f_{R} = J_{\\phi}(\\phi)B_{\\theta}(R)$. The total radial force $F_{R}$ is the volume integral of this force density. The volume element in cylindrical coordinates is $dV = R \\, dR \\, d\\phi \\, dZ$.\n\nThe total radial force is given by the integral:\n$$ F_{R} = \\iiint_{V} f_{R} \\, dV = \\iiint_{V} J_{\\phi}(\\phi)B_{\\theta}(R) \\, R \\, dR \\, d\\phi \\, dZ $$\nThe problem provides the expressions for the current density and magnetic field:\n$$ J_{\\phi}(\\phi) = J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right] $$\n$$ B_{\\theta}(R) = \\frac{\\mu_{0} I_{\\mathrm{res}}}{2\\pi R} $$\nSubstituting these into the integral for $F_R$:\n$$ F_{R} = \\iiint_{V} J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right] \\left(\\frac{\\mu_{0} I_{\\mathrm{res}}}{2\\pi R}\\right) R \\, dR \\, d\\phi \\, dZ $$\nA key simplification occurs as the factor of $R$ in the volume element cancels with the $1/R$ dependence in the expression for $B_{\\theta}(R)$:\n$$ F_{R} = \\iiint_{V} \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0}}{2\\pi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, dR \\, d\\phi \\, dZ $$\nThe integrand is now independent of $R$ and $Z$. The integration is over the volume of the vessel band, which has a toroidal extent of $\\Delta\\phi$, a vertical height of $h$, and a wall thickness of $t$. The limits of integration are from $\\phi=0$ to $\\phi=\\Delta\\phi$, $Z=-h/2$ to $Z=h/2$ (assuming the band is centered on the midplane), and $R$ across the wall thickness. The definite integrals over $Z$ and $R$ become:\n$$ \\int_{-h/2}^{h/2} dZ = h $$\n$$ \\int_{R_{\\mathrm{in}}}^{R_{\\mathrm{out}}} dR = t $$\nThe force integral simplifies to an integral over the toroidal angle $\\phi$:\n$$ F_{R} = \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} \\int_{0}^{\\Delta\\phi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, d\\phi $$\nNow, we perform the integration with respect to $\\phi$:\n$$ \\int_{0}^{\\Delta\\phi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, d\\phi = \\left[\\phi + \\varepsilon\\sin(\\phi)\\right]_{0}^{\\Delta\\phi} = \\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi) $$\nThus, the analytical expression for the total radial force is:\n$$ F_{R} = \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} \\left(\\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi)\\right) $$\nThe given values are:\n- $\\mu_{0} = 4\\pi \\times 10^{-7}\\ \\mathrm{N/A^{2}}$\n- $I_{\\mathrm{res}} = 12.0 \\times 10^{6}\\ \\mathrm{A}$\n- $J_{0} = 1.80 \\times 10^{7}\\ \\mathrm{A/m^{2}}$\n- $h = 1.0\\ \\mathrm{m}$\n- $t = 0.050\\ \\mathrm{m}$\n- $\\varepsilon = 0.30$\n- $\\Delta\\phi = 100^{\\circ}$, which must be converted to radians: $\\Delta\\phi = 100^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} = \\frac{5\\pi}{9}\\ \\mathrm{rad}$.\n\nFirst, we calculate the pre-integral factor:\n$$ \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} = \\frac{(4\\pi \\times 10^{-7}) (12.0 \\times 10^{6}) (1.80 \\times 10^{7}) (1.0) (0.050)}{2\\pi} $$\n$$ = (2 \\times 10^{-7}) (12.0 \\times 10^{6}) (1.80 \\times 10^{7}) (1.0) (0.050) $$\n$$ = (2.4) (1.80 \\times 10^{7}) (0.050) = (2.4) (0.09 \\times 10^{7}) = 0.216 \\times 10^{7} = 2.16 \\times 10^{6}\\ \\mathrm{N} $$\nNext, we calculate the value of the angular term:\n$$ \\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi) = \\frac{5\\pi}{9} + 0.30 \\sin\\left(\\frac{5\\pi}{9}\\right) $$\nUsing a calculator, $\\frac{5\\pi}{9} \\approx 1.745329$ and $\\sin\\left(\\frac{5\\pi}{9}\\right) \\approx 0.984808$.\n$$ 1.745329 + 0.30 \\times 0.984808 = 1.745329 + 0.295442 = 2.040771 $$\nNow, we compute the total force $F_{R}$:\n$$ F_{R} = (2.16 \\times 10^{6}\\ \\mathrm{N}) \\times 2.040771 \\approx 4.408066 \\times 10^{6}\\ \\mathrm{N} $$\nThe final step is to compute the safety margin $m$ by comparing this force to the allowable structural limit, $F_{\\mathrm{limit}} = 6.0 \\times 10^{6}\\ \\mathrm{N}$.\n$$ m = \\frac{F_{R}}{F_{\\mathrm{limit}}} = \\frac{4.408066 \\times 10^{6}\\ \\mathrm{N}}{6.0 \\times 10^{6}\\ \\mathrm{N}} \\approx 0.7346777 $$\nRounding the result to four significant figures as required gives:\n$$ m \\approx 0.7347 $$",
            "answer": "$$\\boxed{0.7347}$$"
        }
    ]
}