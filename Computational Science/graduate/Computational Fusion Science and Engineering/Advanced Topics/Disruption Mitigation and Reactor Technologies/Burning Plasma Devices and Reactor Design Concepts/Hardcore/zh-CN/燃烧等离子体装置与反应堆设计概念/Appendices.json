{
    "hands_on_practices": [
        {
            "introduction": "维持等离子体的宏观稳定性是实现聚变燃烧的首要条件。撕裂模是一种主要的磁流体力学（MHD）不稳定性，它会在等离子体中形成“磁岛”结构，从而破坏磁约束并降低能量约束性能。本练习将深入探讨修正的卢瑟福方程（modified Rutherford equation），这是一个用于预测这些磁岛最终饱和宽度的关键模型。通过求解该方程，我们将量化撕裂模的自然不稳定性驱动、新经典效应等物理机制的稳定作用以及外部共振磁扰场的主动控制作用之间的平衡，理解这种平衡对于设计燃烧等离子体中的MHD控制策略至关重要。",
            "id": "3955705",
            "problem": "一个燃烧等离子体托卡马克在某一参数区域内运行，其中有理面半径 $r_s$ 处的单螺旋撕裂不稳定性与真空振幅为 $b_r$ 的外部施加共振磁扰动相互作用。在电阻磁流体力学 (MHD) 和常数-$\\psi$近似的框架下，考虑一个 $m/n$ 磁岛，其半宽度 $w$ 的非线性演化由撕裂指数 $\\Delta'$、由无量纲系数 $K_{\\text{pol}}$ 表征的新经典极化电流稳定效应，以及当等离子体旋转时减弱的、对外场的力矩耦合相位响应共同决定。假设以下物理基础：\n\n- 感应方程源于欧姆定律 $ \\mathbf{E} + \\mathbf{v}\\times \\mathbf{B} = \\eta \\mathbf{J}$，其中 $\\eta$ 为电阻率，$\\mu_0$ 为磁导率。\n- 经典的Rutherford标度和常数-$\\psi$匹配给出了磁岛宽度 $w(t)$ 的非线性演化，其与电阻扩散率 $D_{\\eta} = \\eta/\\mu_0$ 乘以一个包含撕裂稳定指数 $\\Delta'$ 以及与 $w$ 的负幂成标度关系的非线性项的括号项成正比。\n- 新经典极化电流效应在非线性驱动括号项中产生一个与 $-K_{\\text{pol}}/w$ 成标度关系的稳定项。\n- 外部施加的共振场产生一个额外的驱动项，在常数-$\\psi$匹配下，该项在非线性驱动括号项中与 $+\\alpha (r_s/B_{\\theta}) (b_r \\cos\\phi)/w^2$ 成标度关系，其中 $B_{\\theta}$ 是 $r_s$ 处的平衡极向磁场，$\\phi$ 是磁岛与外场之间的相位差，$\\alpha$ 是一个几何/匹配常数，由真空共振扰动的标准内外层匹配积分确定。\n- 一个简单的线性力矩-相位模型给出 $\\tan\\phi = \\omega/\\omega_c$，其中 $\\omega$ 是有理面处的等离子体旋转频率，$\\omega_c$ 是特征电磁锁定率。因此，$\\cos\\phi = 1/\\sqrt{1+(\\omega/\\omega_c)^2}$。\n\n在这些假设下，稳态饱和磁岛宽度 $w_{\\text{sat}}$ 可以通过将非线性驱动括号项设为零并求解 $w$ 得到。使用以下指定参数：\n- $r_s = 1.00\\,\\text{m}$，\n- $B_{\\theta} = 0.50\\,\\text{T}$，\n- $\\Delta' = 0.80\\,\\text{m}^{-1}$，\n- $K_{\\text{pol}} = 0.050$，\n- $b_r = 1.00\\times 10^{-4}\\,\\text{T}$，\n- $\\omega = 300\\,\\text{rad}\\,\\text{s}^{-1}$，\n- $\\omega_c = 600\\,\\text{rad}\\,\\text{s}^{-1}$，\n\n并取标准常数-$\\psi$真空共振匹配常数为 $\\alpha = 8/\\pi$。请从第一性原理推导稳态条件，并计算包含旋转效应（通过 $\\cos\\phi$）的 $w_{\\text{sat}}$。以米为单位表示最终答案，并将结果四舍五入到四位有效数字。在你的推导过程中，请评估旋转制动（即 $\\omega$ 减小至零）如何影响饱和磁岛宽度，但仅报告包含给定非零 $\\omega$ 的计算值。",
            "solution": "用户请求解答一个关于磁流体力学 (MHD) 稳定性的问题，具体涉及托卡马克中撕裂模磁岛的饱和宽度。在给出解答之前，必须对问题陈述进行严格验证。\n\n### 第一步：提取给定条件\n\n-   **模型：** 电阻磁流体力学，针对 $m/n$ 撕裂不稳定的常数-$\\psi$近似。\n-   **有理面半径：** $r_s = 1.00\\,\\text{m}$\n-   **平衡极向磁场：** $B_{\\theta} = 0.50\\,\\text{T}$\n-   **撕裂稳定指数：** $\\Delta' = 0.80\\,\\text{m}^{-1}$\n-   **新经典极化系数：** $K_{\\text{pol}} = 0.050$ (无量纲)\n-   **真空共振磁扰动振幅：** $b_r = 1.00\\times 10^{-4}\\,\\text{T}$\n-   **等离子体旋转频率：** $\\omega = 300\\,\\text{rad}\\,\\text{s}^{-1}$\n-   **特征锁定率：** $\\omega_c = 600\\,\\text{rad}\\,\\text{s}^{-1}$\n-   **几何/匹配常数：** $\\alpha = 8/\\pi$\n-   **磁岛宽度演化物理：** 磁岛半宽度 $w(t)$ 的非线性演化由一个驱动括号项决定，该项包含：\n    1.  经典撕裂驱动 $\\Delta'$。\n    2.  与 $-K_{\\text{pol}}/w$ 成标度关系的新经典极化电流稳定项。\n    3.  与 $+\\alpha (r_s/B_{\\theta}) (b_r \\cos\\phi)/w^2$ 成标度关系的外场驱动项。\n-   **相位关系：** 磁岛与外场之间的相位差 $\\phi$ 由 $\\tan\\phi = \\omega/\\omega_c$ 给出，这意味着 $\\cos\\phi = 1/\\sqrt{1+(\\omega/\\omega_c)^2}$。\n-   **目标：** 计算稳态饱和磁岛宽度 $w_{\\text{sat}}$，以米为单位，并四舍五入到四位有效数字。\n\n### 第二步：使用提取的给定条件进行验证\n\n根据指定标准对问题进行验证。\n\n-   **科学依据：** 该问题基于修正的Rutherford方程，这是聚变等离子体中非线性撕裂模理论的基石。代表经典撕裂指数 ($\\Delta'$)、新经典极化电流和外部共振磁扰动的各项是该模型的标准组成部分。该物理框架在等离子体物理和磁流体力学中是公认的。该问题在科学上是合理的。\n-   **良态性：** 该问题要求解一个由稳态条件产生的特定代数方程。所有参数和函数形式都已提供，从而形成一个定义明确的数学问题，并期望得到一个有物理意义的解。\n-   **客观性：** 该问题以精确、定量且无偏见的技术语言陈述。\n-   **完整性与一致性：** 所有必要的参数都已提供，以求解饱和磁岛宽度。检查了控制方程中各项的单位以确保一致性。\n    -   $\\Delta'$ 的单位是 $\\text{m}^{-1}$。\n    -   $-K_{\\text{pol}}/w$ 的单位是 $\\text{m}^{-1}$，因为 $K_{\\text{pol}}$ 是无量纲的。\n    -   外场项的单位是 $\\frac{[\\text{m}]}{[\\text{T}]} \\frac{[\\text{T}]}{[\\text{m}]^2} = \\text{m}^{-1}$。\n    所有项在量纲上都是一致的。该问题是完整且自洽的。\n-   **真实性与可行性：** 给定的磁场、尺寸、频率和稳定性参数的数值对于常规托卡马克是物理上可信的。\n-   **结构与清晰度：** 该问题结构清晰，定义了物理模型，提供了所有参数，并陈述了明确的目标。各项的定义没有歧义。\n\n### 第三步：结论与行动\n\n该问题是 **有效的**，因为其科学依据充分、良态、完整且一致。我现在将开始推导解答。\n\n### 解答推导\n\n磁岛半宽度 $w$ 的演化由修正的Rutherford方程控制。根据问题陈述，磁岛增长的净驱动与一个括号项 $\\mathcal{D}(w)$ 成正比，该项是经典撕裂驱动、新经典效应和外部磁扰动的贡献之和。一个稳态饱和磁岛，即 $dw/dt = 0$ 的情况，对应于此净驱动为零的条件。\n\n驱动括号项 $\\mathcal{D}(w)$ 由下式给出：\n$$\n\\mathcal{D}(w) = \\Delta' - \\frac{K_{\\text{pol}}}{w} + \\alpha \\frac{r_s}{B_{\\theta}} \\frac{b_r \\cos\\phi}{w^2}\n$$\n对于宽度为 $w_{\\text{sat}}$ 的稳态饱和磁岛，我们必须有 $\\mathcal{D}(w_{\\text{sat}}) = 0$：\n$$\n\\Delta' - \\frac{K_{\\text{pol}}}{w_{\\text{sat}}} + \\alpha \\frac{r_s}{B_{\\theta}} \\frac{b_r \\cos\\phi}{w_{\\text{sat}}^2} = 0\n$$\n为了求解 $w_{\\text{sat}}$，我们可以乘以 $w_{\\text{sat}}^2$ 得到一个关于 $w_{\\text{sat}}$ 的二次方程：\n$$\n\\Delta' w_{\\text{sat}}^2 - K_{\\text{pol}} w_{\\text{sat}} + \\alpha \\frac{r_s b_r}{B_{\\theta}} \\cos\\phi = 0\n$$\n这是一个形式为 $Aw^2 + Bw + C = 0$ 的标准二次方程，其系数为：\n-   $A = \\Delta'$\n-   $B = -K_{\\text{pol}}$\n-   $C = \\alpha \\frac{r_s b_r}{B_{\\theta}} \\cos\\phi$\n\n首先，我们使用给定的等离子体旋转参数计算 $\\cos\\phi$ 项：\n$$\n\\frac{\\omega}{\\omega_c} = \\frac{300\\,\\text{rad}\\,\\text{s}^{-1}}{600\\,\\text{rad}\\,\\text{s}^{-1}} = 0.5\n$$\n$$\n\\cos\\phi = \\frac{1}{\\sqrt{1 + (\\omega/\\omega_c)^2}} = \\frac{1}{\\sqrt{1 + (0.5)^2}} = \\frac{1}{\\sqrt{1.25}} = \\frac{1}{\\sqrt{5/4}} = \\frac{2}{\\sqrt{5}}\n$$\n接下来，我们将给定的参数值代入系数 $A$、 $B$ 和 $C$：\n-   $A = \\Delta' = 0.80\\,\\text{m}^{-1}$\n-   $B = -K_{\\text{pol}} = -0.050$\n-   $C = \\left(\\frac{8}{\\pi}\\right) \\frac{(1.00\\,\\text{m}) (1.00 \\times 10^{-4}\\,\\text{T})}{0.50\\,\\text{T}} \\left(\\frac{2}{\\sqrt{5}}\\right) = \\frac{1.6 \\times 10^{-3}}{\\pi \\sqrt{1.25}}\\,\\text{m} \\approx 4.5553 \\times 10^{-4}\\,\\text{m}$\n\n关于 $w_{\\text{sat}}$ 的二次方程为：\n$$\n(0.80) w_{\\text{sat}}^2 - (0.050) w_{\\text{sat}} + (4.5553 \\times 10^{-4}) = 0\n$$\n解由二次公式给出，$w_{\\text{sat}} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$：\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{(-0.050)^2 - 4(0.80)(4.5553 \\times 10^{-4})}}{2(0.80)}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{2.5 \\times 10^{-3} - 1.4577 \\times 10^{-3}}}{1.6}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm \\sqrt{1.0423 \\times 10^{-3}}}{1.6}\n$$\n$$\nw_{\\text{sat}} = \\frac{0.050 \\pm 0.03228}{1.6}\n$$\n这产生了两个正实根：\n-   $w_1 = \\frac{0.050 + 0.03228}{1.6} = \\frac{0.08228}{1.6} \\approx 0.0514\\,\\text{m}$\n-   $w_2 = \\frac{0.050 - 0.03228}{1.6} = \\frac{0.01772}{1.6} \\approx 0.0111\\,\\text{m}$\n\n为了确定哪个根对应于稳定的饱和状态，我们分析其稳定性。磁岛演化由 $dw/dt \\propto \\mathcal{D}(w)$ 描述。如果一个小的扰动能使其恢复到 $w_{\\text{sat}}$，则状态 $w_{\\text{sat}}$ 是稳定的。这要求在 $w_{\\text{sat}}$ 处计算的导数 $\\mathcal{D}'(w)$ 为负。\n函数 $\\mathcal{D}(w) = \\Delta' - K_{\\text{pol}}/w + C/w^2$ （其中 $C$ 是第三项的常数部分）的行为如下：\n-   当 $w \\to 0^+$ 时, $\\mathcal{D}(w) \\to +\\infty$。\n-   当 $w \\to \\infty$ 时, $\\mathcal{D}(w) \\to \\Delta' > 0$。\n由于函数 $\\mathcal{D}(w)$ 在 $w$ 很小和很大时都为正，并且我们有两个根，因此它在两根之间必定为负。设 $w_2  w_1$。\n-   对于 $w \\in (0, w_2)$，$\\mathcal{D}(w) > 0$，所以 $dw/dt > 0$。磁岛向 $w_2$ 增长。\n-   对于 $w \\in (w_2, w_1)$，$\\mathcal{D}(w)  0$，所以 $dw/dt  0$。磁岛向 $w_2$ 收缩。\n-   对于 $w > w_1$，$\\mathcal{D}(w) > 0$，所以 $dw/dt > 0$。磁岛从 $w_1$ 开始增长。\n此分析表明，较小的根 $w_2$ 是稳定的饱和状态，而较大的根 $w_1$ 是一个不稳定的阈值。因此，物理上观测到的饱和磁岛宽度是 $w_2$。\n\n现在，我们按要求评估旋转制动的效果。旋转制动对应于 $\\omega \\to 0$。在此极限下，$\\omega/\\omega_c \\to 0$ 且 $\\cos\\phi \\to 1$。一个更大的 $\\cos\\phi$ 会增加二次方程中的系数 $C$。二次函数 $\\Delta' w^2 - K_{\\text{pol}} w + C$ 垂直向上平移。这导致其两个根向抛物线的顶点移动，顶点位于 $w_v = K_{\\text{pol}}/(2\\Delta')$。较小的根 $w_2$ 增加，较大的根 $w_1$ 减少。因此，制动等离子体旋转会增加稳定的饱和磁岛宽度。这在物理上是一致的，因为更强的外场驱动（更大的 $\\cos\\phi$）应该导致更大的磁岛。\n\n问题要求计算给定非零旋转下的 $w_{\\text{sat}}$ 数值。这是稳定根 $w_2$。使用更高精度进行计算：\n$A = 0.8$\n$B = -0.05$\n$C = \\frac{1.6 \\times 10^{-3}}{\\pi \\sqrt{1.25}} \\approx 4.5553175 \\times 10^{-4}$\n$w_2 = \\frac{-B - \\sqrt{B^2 - 4AC}}{2A} = \\frac{0.05 - \\sqrt{0.0025 - 4(0.8)(4.5553175 \\times 10^{-4})}}{1.6}$\n$w_2 = \\frac{0.05 - \\sqrt{0.0010422984}}{1.6} = \\frac{0.05 - 0.032284646}{1.6} = \\frac{0.017715354}{1.6} \\approx 0.011072096\\,\\text{m}$\n\n将结果四舍五入到四位有效数字，得到 $0.01107\\,\\text{m}$。",
            "answer": "$$\\boxed{0.01107}$$"
        },
        {
            "introduction": "聚变反应堆的设计面临的一大核心挑战是面向等离子体部件（PFCs）的材料选择与工程设计。在反应堆中，偏滤器靶板必须承受来自等离子体的巨大热负荷，特别是像边界局域模（ELMs）这类快速瞬态事件带来的极高热流。本练习将运用瞬态热传导的基本原理，从第一性原理出发推导并计算钨（W）材料的偏滤器靶板在熔化之前所能承受的最大ELM能量密度。这个极限值是决定反应堆安全运行窗口和指导偏滤器设计的关键工程参数。",
            "id": "3955737",
            "problem": "您的任务是，使用半无限固体内的一维瞬态热传导模型，确定钨偏滤器表面在不达到其熔化温度的情况下所能承受的边界局域模 (ELM) 热脉冲的最大入射能量密度。请从第一性原理出发，根据下述热方程和边界条件推导所有必要的表达式，不假设任何已知的闭合形式热响应。然后通过算法实现所得表达式，以计算所要求的输出。\n\n假设和物理模型：\n- 固体为钨，占据半空间 $x \\ge 0$，初始时对于所有 $x \\ge 0$ 均处于均匀温度 $T(x,0) = T_{0}$。\n- 控制方程为一维热方程 $\\,\\partial T/\\partial t = \\alpha \\,\\partial^{2}T/\\partial x^{2}\\,$，且热物理性质为常数。\n- 热扩散率 $\\alpha = k/(\\rho c_{p})$，其中 $k$ 是热导率，$\\rho$ 是质量密度， $c_{p}$ 是恒压比热容。\n- 位于 $x=0$ 的表面受到一个空间均匀、时间恒定的热通量脉冲，持续时间为 $\\tau$：对于 $0 \\le t \\le \\tau$，边界条件为 $-k\\,(\\partial T/\\partial x)|_{x=0} = q_{0}$；对于 $t  \\tau$，边界条件为 $-k\\,(\\partial T/\\partial x)|_{x=0} = 0$。脉冲的能量密度（时间积分的表面热通量）为 $E = q_{0}\\,\\tau$。\n- 忽略任何辐射损失、蒸发或相变；唯一的约束是在脉冲期间及之后，保持表面温度低于熔化温度。\n\n目标：\n- 对于每个指定的测试用例，在给定初始均匀温度 $T_{0}$ 和脉冲持续时间 $\\tau$ 的情况下，计算最大允许ELM能量密度 $E_{\\max}$，以使 $x=0$ 处的表面温度在任何时候都不超过钨的熔化温度 $T_{m}$。\n- 以兆焦耳每平方米 (MJ/m$^{2}$) 为单位表示 $E_{\\max}$，四舍五入到六位小数。\n\n钨的材料特性（对所有测试用例均为常数）：\n- 热导率 $k = $ $174$ W/(m·K)\n- 密度 $\\rho = $ $19250$ kg/m$^{3}$\n- 比热容 $c_{p} = $ $134$ J/(kg·K)\n- 熔化温度 $T_{m} = $ $3695$ K\n\n推导必须使用的基本原理：\n- 在半无限域 $x \\ge 0$ 上的一维热方程 $\\,\\partial T/\\partial t = \\alpha \\,\\partial^{2}T/\\partial x^{2}\\,$，以及代表施加的表面热通量的诺伊曼边界条件。\n- 用于构建有限持续时间脉冲的线性系统的时间叠加原理和因果关系。\n\n测试组：\n- 用例 A (正常情况): $T_{0} = $ $1200$ K, $\\tau = $ $1.0 \\times 10^{-3}$ s。\n- 用例 B (更短的脉冲，更冷的壁): $T_{0} = $ $300$ K, $\\tau = $ $5.0 \\times 10^{-4}$ s。\n- 用例 C (接近熔化的初始壁温): $T_{0} = $ $3600$ K, $\\tau = $ $1.0 \\times 10^{-3}$ s。\n- 用例 D (初始温度为熔点): $T_{0} = T_{m}$, $\\tau = $ $2.0 \\times 10^{-3}$ s。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为 [用例 A, 用例 B, 用例 C, 用例 D]。每个列表元素是等于 $E_{\\max}$ 的浮点数，单位为 MJ/m$^{2}$，四舍五入到六位小数。例如，输出可能看起来像 “[$x_{A}$,$x_{B}$,$x_{C}$,$x_{D}$]”，其中每个 $x$ 都四舍五入到六位小数。",
            "solution": "用户希望我解决一个一维瞬态热传导问题，以确定钨表面上允许的最大能量密度。解决方案必须从第一性原理推导。\n\n**1. 问题表述**\n\n该物理系统被建模为一个半无限固体 ($x \\ge 0$)，初始温度均匀为 $T_0$。温度演变 $T(x,t)$ 由一维热方程控制：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $\\alpha = k/(\\rho c_p)$ 是热扩散率，$k$ 是热导率，$\\rho$ 是密度，$c_p$ 是比热容。\n\n初始条件为：\n$$\nT(x,0) = T_0 \\quad \\text{对于 } x \\ge 0\n$$\n\n一个热通量脉冲施加在表面 $x=0$ 处。边界条件由诺伊曼条件描述：\n$$\n-k \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} = q(t)\n$$\n其中热通量 $q(t)$ 是一个持续时间为 $\\tau$、幅度为 $q_0$ 的方波脉冲：\n$$\nq(t) = \\begin{cases}\nq_0  \\text{若 } 0 \\le t \\le \\tau \\\\\n0  \\text{若 } t > \\tau\n\\end{cases}\n$$\n远离表面处，温度保持其初始值：\n$$\n\\lim_{x \\to \\infty} T(x,t) = T_0\n$$\n为简化问题，我们定义高于初始温度的温升为 $\\theta(x,t) = T(x,t) - T_0$。关于 $\\theta$ 的问题是：\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2}\n$$\n其初始条件和边界条件为：\n$$\n\\theta(x,0) = 0\n$$\n$$\n-k \\frac{\\partial \\theta}{\\partial x}\\bigg|_{x=0} = q(t)\n$$\n$$\n\\lim_{x \\to \\infty} \\theta(x,t) = 0\n$$\n\n**2. 使用拉普拉斯变换求解阶跃热通量**\n\n我们首先求解在所有时间 $t \\ge 0$ 上施加恒定热通量 $q_0$（一个亥维赛阶跃函数，$q(t) = q_0 H(t)$）的问题。我们对时间应用拉普拉斯变换，$\\bar{\\theta}(x,s) = \\mathcal{L}\\{\\theta(x,t)\\}$。变换后的偏微分方程变成关于 $x$ 的常微分方程 (ODE)：\n$$\ns\\bar{\\theta}(x,s) - \\theta(x,0) = \\alpha \\frac{d^2 \\bar{\\theta}(x,s)}{dx^2}\n$$\n使用初始条件 $\\theta(x,0)=0$，我们得到：\n$$\n\\frac{d^2 \\bar{\\theta}}{dx^2} - \\frac{s}{\\alpha} \\bar{\\theta} = 0\n$$\n该常微分方程的通解是：\n$$\n\\bar{\\theta}(x,s) = A(s)e^{\\sqrt{s/\\alpha}x} + B(s)e^{-\\sqrt{s/\\alpha}x}\n$$\n无穷远处的边界条件 $\\lim_{x \\to \\infty} \\theta(x,t) = 0$ 意味着 $\\lim_{x \\to \\infty} \\bar{\\theta}(x,s) = 0$。这要求 $A(s)=0$ 以确保解保持有界。因此：\n$$\n\\bar{\\theta}(x,s) = B(s)e^{-\\sqrt{s/\\alpha}x}\n$$\n表面的边界条件变为：\n$$\n\\mathcal{L}\\left\\{-k\\frac{\\partial \\theta}{\\partial x}\\bigg|_{x=0}\\right\\} = \\mathcal{L}\\{q_0 H(t)\\} \\implies -k\\frac{d\\bar{\\theta}}{dx}\\bigg|_{x=0} = \\frac{q_0}{s}\n$$\n我们求 $\\bar{\\theta}(x,s)$ 对 $x$ 的导数：\n$$\n\\frac{d\\bar{\\theta}}{dx} = -B(s) \\sqrt{\\frac{s}{\\alpha}} e^{-\\sqrt{s/\\alpha}x}\n$$\n在 $x=0$ 处求值：\n$$\n\\frac{d\\bar{\\theta}}{dx}\\bigg|_{x=0} = -B(s) \\sqrt{\\frac{s}{\\alpha}}\n$$\n将此代入变换后的边界条件：\n$$\n-k \\left(-B(s) \\sqrt{\\frac{s}{\\alpha}}\\right) = \\frac{q_0}{s} \\implies B(s) = \\frac{q_0}{k\\sqrt{s/\\alpha}s} = \\frac{q_0\\sqrt{\\alpha}}{k} s^{-3/2}\n$$\n在拉普拉斯域中，表面温升的解通过设置 $x=0$ 得到：\n$$\n\\bar{\\theta}(0,s) = B(s) = \\frac{q_0\\sqrt{\\alpha}}{k} s^{-3/2}\n$$\n为了在时域中找到解，我们进行拉普拉斯逆变换。使用已知的变换对 $\\mathcal{L}^{-1}\\{s^{-a}\\} = \\frac{t^{a-1}}{\\Gamma(a)}$，其中 $a=3/2$ 且 $\\Gamma(3/2)=\\frac{1}{2}\\sqrt{\\pi}$：\n$$\n\\theta_{\\text{step}}(0,t) = \\mathcal{L}^{-1}\\{\\bar{\\theta}(0,s)\\} = \\frac{q_0\\sqrt{\\alpha}}{k} \\frac{t^{1/2}}{\\Gamma(3/2)} = \\frac{q_0\\sqrt{\\alpha}}{k} \\frac{\\sqrt{t}}{\\sqrt{\\pi}/2} = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\n这是从 $t=0$ 开始的连续恒定热通量 $q_0$ 作用下的表面温升。\n\n**3. 使用叠加法求解脉冲热通量**\n\n热通量脉冲 $q(t)$ 可以表示为两个阶跃函数的叠加：一个是在 $t=0$ 开始的大小为 $q_0$ 的正阶跃，另一个是在 $t=\\tau$ 开始的大小为 $-q_0$ 的负阶跃。\n$$\nq(t) = q_0 H(t) - q_0 H(t-\\tau)\n$$\n由于热方程的线性特性，表面的总温升 $\\theta(0,t)$ 是对这两个阶跃函数响应的总和。令 $\\Delta T_{surf}(t) = \\theta(0,t)$。\n\n对于 $0 \\le t \\le \\tau$：只有第一个阶跃函数起作用。\n$$\n\\Delta T_{surf}(t) = \\theta_{\\text{step}}(0,t) = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\n对于 $t > \\tau$：两个阶跃函数都起作用。第二个阶跃的响应延迟了 $\\tau$。\n$$\n\\Delta T_{surf}(t) = \\theta_{\\text{step}}(0,t) - \\theta_{\\text{step}}(0, t-\\tau) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\left( \\sqrt{t} - \\sqrt{t-\\tau} \\right)\n$$\n\n**4. 求取最大表面温度**\n\n我们需要找到在所有 $t \\ge 0$ 时间内表面温度 $T(0,t) = T_0 + \\Delta T_{surf}(t)$ 的最大值。这等同于找到 $\\Delta T_{surf}(t)$ 的最大值。\n\n- 对于 $0 \\le t \\le \\tau$，$\\Delta T_{surf}(t)$ 与 $\\sqrt{t}$ 成正比，这是一个单调递增函数。它在此区间内的最大值出现在终点 $t=\\tau$。\n- 对于 $t > \\tau$，我们考察 $\\Delta T_{surf}(t)$ 的导数：\n$$\n\\frac{d}{dt} \\Delta T_{surf}(t) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\frac{d}{dt} \\left(\\sqrt{t} - \\sqrt{t-\\tau}\\right) = \\frac{2q_0\\sqrt{\\alpha}}{k\\sqrt{\\pi}} \\left(\\frac{1}{2\\sqrt{t}} - \\frac{1}{2\\sqrt{t-\\tau}}\\right)\n$$\n由于 $t > t-\\tau > 0$，我们有 $\\sqrt{t} > \\sqrt{t-\\tau}$，这意味着 $\\frac{1}{\\sqrt{t}}  \\frac{1}{\\sqrt{t-\\tau}}$。因此，对于所有 $t > \\tau$，导数都是负的。这意味着 $\\Delta T_{surf}(t)$ 在 $t > \\tau$ 时是单调递减的。\n\n最大表面温升发生在热脉冲结束的瞬间，即在 $t=\\tau$ 时。\n$$\n\\Delta T_{max, surf} = \\Delta T_{surf}(\\tau) = \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}}\n$$\n最大表面温度为：\n$$\nT_{max, surf} = T_0 + \\Delta T_{max, surf} = T_0 + \\frac{2q_0}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}}\n$$\n\n**5. 最大能量密度 ($E_{max}$) 的推导**\n\n问题要求最大表面温度不超过熔化温度 $T_m$。\n$$\nT_{max, surf} \\le T_m \\implies T_0 + \\frac{2q_{0,max}}{k}\\sqrt{\\frac{\\alpha \\tau}{\\pi}} = T_m\n$$\n我们求解最大允许热通量 $q_{0,max}$：\n$$\nq_{0,max} = (T_m - T_0) \\frac{k\\sqrt{\\pi}}{2\\sqrt{\\alpha \\tau}}\n$$\n脉冲的总能量密度为 $E = q_0\\tau$。因此，最大允许能量密度 $E_{max}$ 为：\n$$\nE_{max} = q_{0,max} \\tau = (T_m - T_0) \\frac{k\\sqrt{\\pi}}{2\\sqrt{\\alpha \\tau}} \\tau = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2\\sqrt{\\alpha}}\n$$\n代入热扩散率的定义 $\\alpha = k/(\\rho c_p)$：\n$$\nE_{max} = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2\\sqrt{k/(\\rho c_p)}} = (T_m - T_0) \\frac{k\\sqrt{\\pi\\tau}}{2} \\frac{\\sqrt{\\rho c_p}}{\\sqrt{k}}\n$$\n这简化为最终表达式：\n$$\nE_{max} = \\frac{\\sqrt{\\pi}}{2} (T_m - T_0) \\sqrt{k \\rho c_p \\tau}\n$$\n此公式将用于计算给定测试用例的结果。结果单位为 J/m$^2$。要转换为 MJ/m$^2$，我们除以 $10^6$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum allowable energy density for an ELM heat pulse on a\n    tungsten divertor without exceeding its melting temperature, based on a\n    1D transient heat conduction model in a semi-infinite solid.\n    \"\"\"\n\n    # Material properties of tungsten (W)\n    k = 174.0       # Thermal conductivity in W/(m·K)\n    rho = 19250.0   # Density in kg/m^3\n    cp = 134.0      # Specific heat capacity in J/(kg·K)\n    Tm = 3695.0     # Melting temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T0, tau)\n    # T0 is the initial temperature in K\n    # tau is the pulse duration in s\n    test_cases = [\n        (1200.0, 1.0e-3),  # Case A\n        (300.0, 5.0e-4),   # Case B\n        (3600.0, 1.0e-3),  # Case C\n        (Tm, 2.0e-3),      # Case D\n    ]\n\n    results = []\n    \n    # Pre-calculate the material property group for efficiency\n    # This term represents the square of the thermal effusivity\n    k_rho_cp = k * rho * cp\n\n    for T0, tau in test_cases:\n        # The derived formula for the maximum allowable energy density (E_max) is:\n        # E_max = (sqrt(pi)/2) * (Tm - T0) * sqrt(k * rho * cp * tau)\n        # The result of this formula is in J/m^2.\n\n        delta_T = Tm - T0\n        \n        # Handle the case where initial temperature is already at or above melting\n        if delta_T = 0:\n            E_max_joules = 0.0\n        else:\n            E_max_joules = (np.sqrt(np.pi) / 2.0) * delta_T * np.sqrt(k_rho_cp * tau)\n\n        # Convert the result from J/m^2 to MJ/m^2\n        E_max_megajoules = E_max_joules / 1.0e6\n        \n        # Round to six decimal places as specified\n        results.append(round(E_max_megajoules, 6))\n\n    # Format the results into the required string output\n    output_string = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "一个成功的反应堆设计不仅要考虑正常运行工况，还必须能够承受非正常事件带来的极端负载。等离子体大破裂（disruption）是聚变装置中一种剧烈的放电终止过程，它会在真空室等导电结构中感应出巨大的电流和电磁力。本练习将带你亲手计算这些所谓的“晕电流”（halo currents）所产生的强大洛伦兹力。精确评估这些力的大小是验证真空室结构完整性、确保整个反应堆系统安全性的关键一步。",
            "id": "3955700",
            "problem": "考虑一个下一代燃烧等离子体托卡马克真空室段，在电流猝灭期间承受晕电流负载。假设一个圆形截面的托卡马克，其大半径为 $R_0=7.0\\ \\mathrm{m}$，小半径为 $a=2.3\\ \\mathrm{m}$，因此外侧中平面的接触半径为 $R_{\\mathrm{out}}=R_0+a$。在猝灭过程中我们关注的时刻，剩余等离子体电流为 $I_{\\mathrm{res}}=12.0\\times 10^{6}\\ \\mathrm{A}$。该真空室段是一个外侧中平面带，其垂直高度 $h=1.0\\ \\mathrm{m}$，壁厚 $t=0.050\\ \\mathrm{m}$，环向范围 $\\Delta\\phi=100^{\\circ}$。在力的计算中，所有角度积分均使用弧度制。对该带上的净径向力有贡献的唯一磁场是极向磁场 $B_{\\theta}(R)$。对于一个圆形、轴对称的环体，该磁场可由安培定律近似为 $B_{\\theta}(R)=\\mu_{0} I/(2\\pi R)$，其中真空磁导率 $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N/A^{2}}$，且 $I=I_{\\mathrm{res}}$。\n\n假设在该带的真空室壁内，环向晕电流密度由于 $n=1$ 非对称性而空间非均匀，并被建模为\n$$\nJ_{\\phi}(\\phi)=J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right],\n$$\n在壁厚和垂直高度上均匀分布，其中 $J_{0}=1.80\\times 10^{7}\\ \\mathrm{A/m^{2}}$，$\\varepsilon=0.30$，$\\phi$ 是在该带内从 $\\phi=0$ 到 $\\phi=\\Delta\\phi$ 测量的环向角。\n\n使用洛伦兹力密度 $\\mathbf{f}=\\mathbf{J}\\times \\mathbf{B}$，并忽略对带上不产生净径向力的贡献，通过在带的体积上对 $J_{\\phi}\\times B_{\\theta}$ 进行积分，计算真空室带上的净向外径向力 $F_{R}$。然后，通过构建安全裕度\n$$\nm=\\frac{F_{R}}{F_{\\mathrm{limit}}}\n$$\n将结果与该段的许用结构极限 $F_{\\mathrm{limit}}=6.0\\times 10^{6}\\ \\mathrm{N}$ 进行比较。\n\n将 $m$ 的最终答案表示为四舍五入到四位有效数字的无单位小数。在积分中使用弧度表示 $\\Delta\\phi$，并将任何中间力以牛顿为单位表示。",
            "solution": "该问题提法恰当，有科学依据，并包含了计算唯一解所需的所有必要信息。基于洛伦兹力和安培定律的物理模型，是聚变科学中此类工程分析的标准模型。所有给定参数对于下一代托卡马克都是物理上合理的。因此，该问题是有效的，解法推导如下。\n\n真空室带上的净向外径向力 $F_{R}$ 是通过在带的体积 $V$ 上对洛伦兹力密度 $\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}$ 进行积分来确定的。问题指定了环向晕电流密度 $\\mathbf{J} = J_{\\phi}(\\phi)\\hat{\\phi}$ 和极向磁场 $\\mathbf{B} = B_{\\theta}(R)\\hat{\\theta}$。在标准柱坐标系 $(R, \\phi, Z)$ 中，环向为 $\\hat{\\phi}$ 方向。在外侧中平面，极向 $\\hat{\\theta}$ 对应于负垂直方向 $-\\hat{Z}$。\n\n因此，洛伦兹力密度矢量为：\n$$ \\mathbf{f} = J_{\\phi}(\\phi)\\hat{\\phi} \\times B_{\\theta}(R)(-\\hat{Z}) = -J_{\\phi}(\\phi)B_{\\theta}(R)(\\hat{\\phi} \\times \\hat{Z}) $$\n根据柱坐标系的右手定则，$\\hat{\\phi} \\times \\hat{Z} = -\\hat{R}$，其中 $\\hat{R}$ 是向外径向方向的单位矢量。\n$$ \\mathbf{f} = -J_{\\phi}(\\phi)B_{\\theta}(R)(-\\hat{R}) = J_{\\phi}(\\phi)B_{\\theta}(R)\\hat{R} $$\n该力径向向外，其大小为 $f_{R} = J_{\\phi}(\\phi)B_{\\theta}(R)$。总径向力 $F_{R}$ 是该力密度的体积分。在柱坐标系中，体积元为 $dV = R \\, dR \\, d\\phi \\, dZ$。\n\n总径向力由以下积分给出：\n$$ F_{R} = \\iiint_{V} f_{R} \\, dV = \\iiint_{V} J_{\\phi}(\\phi)B_{\\theta}(R) \\, R \\, dR \\, d\\phi \\, dZ $$\n问题给出了电流密度和磁场的表达式：\n$$ J_{\\phi}(\\phi) = J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right] $$\n$$ B_{\\theta}(R) = \\frac{\\mu_{0} I_{\\mathrm{res}}}{2\\pi R} $$\n将这些表达式代入 $F_R$ 的积分中：\n$$ F_{R} = \\iiint_{V} J_{0}\\left[1+\\varepsilon\\cos(\\phi)\\right] \\left(\\frac{\\mu_{0} I_{\\mathrm{res}}}{2\\pi R}\\right) R \\, dR \\, d\\phi \\, dZ $$\n一个关键的简化是体积元中的因子 $R$ 与 $B_{\\theta}(R)$ 表达式中的 $1/R$ 依赖项相消：\n$$ F_{R} = \\iiint_{V} \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0}}{2\\pi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, dR \\, d\\phi \\, dZ $$\n现在被积函数与 $R$ 和 $Z$ 无关。积分是在真空室带的体积上进行的，该带的环向范围为 $\\Delta\\phi$，垂直高度为 $h$，壁厚为 $t$。积分限为 $\\phi$ 从 0 到 $\\Delta\\phi$，$Z$ 从 $-h/2$ 到 $h/2$（假设该带以中平面为中心），以及 $R$ 在壁厚范围内。对 $Z$ 和 $R$ 的定积分变为：\n$$ \\int_{-h/2}^{h/2} dZ = h $$\n$$ \\int_{R_{\\mathrm{in}}}^{R_{\\mathrm{out}}} dR = t $$\n力的积分简化为对环向角 $\\phi$ 的积分：\n$$ F_{R} = \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} \\int_{0}^{\\Delta\\phi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, d\\phi $$\n现在，我们对 $\\phi$ 进行积分：\n$$ \\int_{0}^{\\Delta\\phi} \\left[1+\\varepsilon\\cos(\\phi)\\right] \\, d\\phi = \\left[\\phi + \\varepsilon\\sin(\\phi)\\right]_{0}^{\\Delta\\phi} = \\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi) $$\n因此，总径向力的解析表达式为：\n$$ F_{R} = \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} \\left(\\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi)\\right) $$\n给定值为：\n- $\\mu_{0} = 4\\pi \\times 10^{-7}\\ \\mathrm{N/A^{2}}$\n- $I_{\\mathrm{res}} = 12.0 \\times 10^{6}\\ \\mathrm{A}$\n- $J_{0} = 1.80 \\times 10^{7}\\ \\mathrm{A/m^{2}}$\n- $h = 1.0\\ \\mathrm{m}$\n- $t = 0.050\\ \\mathrm{m}$\n- $\\varepsilon = 0.30$\n- $\\Delta\\phi = 100^{\\circ}$，必须转换为弧度： $\\Delta\\phi = 100^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} = \\frac{5\\pi}{9}\\ \\mathrm{rad}$。\n\n首先，我们计算积分前的因子：\n$$ \\frac{\\mu_{0} I_{\\mathrm{res}} J_{0} h t}{2\\pi} = \\frac{(4\\pi \\times 10^{-7}) (12.0 \\times 10^{6}) (1.80 \\times 10^{7}) (1.0) (0.050)}{2\\pi} $$\n$$ = (2 \\times 10^{-7}) (12.0 \\times 10^{6}) (1.80 \\times 10^{7}) (1.0) (0.050) $$\n$$ = (2.4) (1.80 \\times 10^{7}) (0.050) = (2.4) (0.09 \\times 10^{7}) = 0.216 \\times 10^{7} = 2.16 \\times 10^{6}\\ \\mathrm{N} $$\n接下来，我们计算角度项的值：\n$$ \\Delta\\phi + \\varepsilon\\sin(\\Delta\\phi) = \\frac{5\\pi}{9} + 0.30 \\sin\\left(\\frac{5\\pi}{9}\\right) $$\n使用计算器，$\\frac{5\\pi}{9} \\approx 1.745329$ 且 $\\sin\\left(\\frac{5\\pi}{9}\\right) \\approx 0.984808$。\n$$ 1.745329 + 0.30 \\times 0.984808 = 1.745329 + 0.295442 = 2.040771 $$\n现在，我们计算总力 $F_{R}$：\n$$ F_{R} = (2.16 \\times 10^{6}\\ \\mathrm{N}) \\times 2.040771 \\approx 4.408066 \\times 10^{6}\\ \\mathrm{N} $$\n最后一步是通过将此力与许用结构极限 $F_{\\mathrm{limit}} = 6.0 \\times 10^{6}\\ \\mathrm{N}$进行比较，来计算安全裕度 $m$。\n$$ m = \\frac{F_{R}}{F_{\\mathrm{limit}}} = \\frac{4.408066 \\times 10^{6}\\ \\mathrm{N}}{6.0 \\times 10^{6}\\ \\mathrm{N}} \\approx 0.7346777 $$\n按要求将结果四舍五入到四位有效数字，得到：\n$$ m \\approx 0.7347 $$",
            "answer": "$$\\boxed{0.7347}$$"
        }
    ]
}