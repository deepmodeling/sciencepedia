{
    "hands_on_practices": [
        {
            "introduction": "This first exercise is a cornerstone of radiation transport theory. You will derive the formal solution to the Radiative Transfer Equation (RTE) for an idealized, homogeneous plasma slab. By solving this fundamental problem analytically, you will gain a clear understanding of how an initial radiation field is attenuated and how the plasma's own emission contributes to the final emergent intensity, concepts that are essential for interpreting spectroscopic data from plasmas. ",
            "id": "4037038",
            "problem": "Consider a plane-parallel, homogeneous plasma slab of physical thickness $L$ observed at a fixed frequency $\\nu$. Let the spatial coordinate $s$ measure distance along a normal ray through the slab, with $s=0$ at the entrance surface and $s=L$ at the exit surface. Assume the absorption coefficient $\\alpha_{\\nu}$ is uniform in space and the emission is isotropic with a constant source function $S_{\\nu}$ (independent of $s$). The boundary condition at the entrance surface is that the incoming specific intensity is $I_{\\nu}(0)$. Starting from the frequency-dependent Radiative Transfer Equation (RTE),\n$$\\frac{d I_{\\nu}}{d s}=-\\alpha_{\\nu} I_{\\nu}+j_{\\nu},$$\nand the definition of the source function $S_{\\nu}\\equiv j_{\\nu}/\\alpha_{\\nu}$, derive the emergent specific intensity $I_{\\nu}(L)$ at the exit surface. Then evaluate your derived expression numerically for the following parameters: $L=0.20\\,\\text{m}$, $\\alpha_{\\nu}=0.75\\,\\text{m}^{-1}$, $S_{\\nu}=2.00\\times 10^{-7}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$, and $I_{\\nu}(0)=1.00\\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$. Express the final emergent specific intensity in $\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard initial value problem based on the fundamental Radiative Transfer Equation. The provided physical parameters and boundary conditions are consistent and plausible. The problem is therefore valid, and a solution will be derived.\n\nThe starting point is the frequency-dependent Radiative Transfer Equation (RTE) for the specific intensity $I_{\\nu}$ along a ray path with coordinate $s$:\n$$\n\\frac{d I_{\\nu}}{d s}=-\\alpha_{\\nu} I_{\\nu}+j_{\\nu}\n$$\nHere, $\\alpha_{\\nu}$ is the absorption coefficient and $j_{\\nu}$ is the emission coefficient.\nThe source function $S_{\\nu}$ is defined as the ratio of the emission to the absorption coefficient:\n$$\nS_{\\nu} \\equiv \\frac{j_{\\nu}}{\\alpha_{\\nu}}\n$$\nSubstituting $j_{\\nu} = S_{\\nu} \\alpha_{\\nu}$ into the RTE gives:\n$$\n\\frac{d I_{\\nu}}{d s}=-\\alpha_{\\nu} I_{\\nu}+S_{\\nu} \\alpha_{\\nu}\n$$\nThis equation can be rearranged as:\n$$\n\\frac{d I_{\\nu}}{d s} + \\alpha_{\\nu} I_{\\nu} = \\alpha_{\\nu} S_{\\nu}\n$$\nThe problem states that the plasma slab is homogeneous, meaning the absorption coefficient $\\alpha_{\\nu}$ is constant with respect to the spatial coordinate $s$. It is also given that the source function $S_{\\nu}$ is constant. Consequently, the entire right-hand side of the rearranged equation, $\\alpha_{\\nu} S_{\\nu}$, is constant.\n\nThis is a first-order linear ordinary differential equation of the form $\\frac{dy}{dx} + P(x)y = Q(x)$, where $y(x) = I_{\\nu}(s)$, $P(s) = \\alpha_{\\nu}$, and $Q(s) = \\alpha_{\\nu} S_{\\nu}$. The solution can be found using an integrating factor, $\\mu(s)$, defined as:\n$$\n\\mu(s) = \\exp\\left(\\int P(s) \\, ds\\right) = \\exp\\left(\\int \\alpha_{\\nu} \\, ds\\right)\n$$\nSince $\\alpha_{\\nu}$ is constant, the integral is straightforward:\n$$\n\\mu(s) = \\exp(\\alpha_{\\nu} s)\n$$\nMultiplying the RTE by the integrating factor $\\mu(s)$ yields:\n$$\n\\exp(\\alpha_{\\nu} s) \\frac{d I_{\\nu}}{d s} + \\alpha_{\\nu} \\exp(\\alpha_{\\nu} s) I_{\\nu} = \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s)\n$$\nThe left side of this equation is, by the product rule of differentiation, the derivative of $I_{\\nu}(s) \\exp(\\alpha_{\\nu} s)$:\n$$\n\\frac{d}{ds} \\left( I_{\\nu}(s) \\exp(\\alpha_{\\nu} s) \\right) = \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s)\n$$\nWe can integrate this equation along the path length $s$ from the entrance of the slab at $s=0$ to the exit at $s=L$:\n$$\n\\int_{0}^{L} \\frac{d}{ds'} \\left( I_{\\nu}(s') \\exp(\\alpha_{\\nu} s') \\right) ds' = \\int_{0}^{L} \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s') ds'\n$$\nThe left-hand side, by the fundamental theorem of calculus, is:\n$$\n\\left[ I_{\\nu}(s') \\exp(\\alpha_{\\nu} s') \\right]_{0}^{L} = I_{\\nu}(L) \\exp(\\alpha_{\\nu} L) - I_{\\nu}(0) \\exp(0) = I_{\\nu}(L) \\exp(\\alpha_{\\nu} L) - I_{\\nu}(0)\n$$\nThe right-hand side integral is:\n$$\n\\int_{0}^{L} \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s') ds' = \\alpha_{\\nu} S_{\\nu} \\left[ \\frac{1}{\\alpha_{\\nu}} \\exp(\\alpha_{\\nu} s') \\right]_{0}^{L} = S_{\\nu} \\left( \\exp(\\alpha_{\\nu} L) - \\exp(0) \\right) = S_{\\nu} \\left( \\exp(\\alpha_{\\nu} L) - 1 \\right)\n$$\nEquating the two results:\n$$\nI_{\\nu}(L) \\exp(\\alpha_{\\nu} L) - I_{\\nu}(0) = S_{\\nu} \\left( \\exp(\\alpha_{\\nu} L) - 1 \\right)\n$$\nNow, we solve for the emergent intensity, $I_{\\nu}(L)$:\n$$\nI_{\\nu}(L) \\exp(\\alpha_{\\nu} L) = I_{\\nu}(0) + S_{\\nu} \\exp(\\alpha_{\\nu} L) - S_{\\nu}\n$$\n$$\nI_{\\nu}(L) = I_{\\nu}(0) \\exp(-\\alpha_{\\nu} L) + S_{\\nu} - S_{\\nu} \\exp(-\\alpha_{\\nu} L)\n$$\nFactoring out $S_{\\nu}$ yields the final symbolic expression for the emergent intensity:\n$$\nI_{\\nu}(L) = I_{\\nu}(0) \\exp(-\\alpha_{\\nu} L) + S_{\\nu} (1 - \\exp(-\\alpha_{\\nu} L))\n$$\nThis expression is the formal solution to the RTE for a homogeneous medium. It shows that the emergent intensity is the sum of two terms: the initial intensity $I_{\\nu}(0)$ attenuated by the factor $\\exp(-\\alpha_{\\nu} L)$ as it passes through the slab, and the integrated emission from the slab itself, represented by the source function $S_{\\nu}$ multiplied by $(1 - \\exp(-\\alpha_{\\nu} L))$. The dimensionless quantity $\\tau_{\\nu,L} = \\alpha_{\\nu} L$ is known as the optical depth of the slab.\n\nNext, we evaluate this expression numerically using the given parameters:\n$L = 0.20\\,\\text{m}$\n$\\alpha_{\\nu} = 0.75\\,\\text{m}^{-1}$\n$S_{\\nu} = 2.00 \\times 10^{-7}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$\n$I_{\\nu}(0) = 1.00 \\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$\n\nFirst, we calculate the optical depth $\\tau_{\\nu,L}$:\n$$\n\\tau_{\\nu,L} = \\alpha_{\\nu} L = (0.75\\,\\text{m}^{-1}) \\times (0.20\\,\\text{m}) = 0.15\n$$\nThe attenuation factor is $\\exp(-\\tau_{\\nu,L}) = \\exp(-0.15)$.\n$$\n\\exp(-0.15) \\approx 0.8607079764\n$$\nNow, substitute the numerical values into the derived formula:\n$$\nI_{\\nu}(L) = (1.00 \\times 10^{-8}) \\exp(-0.15) + (2.00 \\times 10^{-7}) (1 - \\exp(-0.15))\n$$\n$$\nI_{\\nu}(L) \\approx (1.00 \\times 10^{-8})(0.8607079764) + (2.00 \\times 10^{-7})(1 - 0.8607079764)\n$$\n$$\nI_{\\nu}(L) \\approx 0.8607079764 \\times 10^{-8} + (2.00 \\times 10^{-7})(0.1392920236)\n$$\n$$\nI_{\\nu}(L) \\approx 0.8607079764 \\times 10^{-8} + 2.785840472 \\times 10^{-8}\n$$\n$$\nI_{\\nu}(L) \\approx (0.8607079764 + 2.785840472) \\times 10^{-8}\n$$\n$$\nI_{\\nu}(L) \\approx 3.646548448 \\times 10^{-8} \\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nI_{\\nu}(L) \\approx 3.647 \\times 10^{-8} \\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}\n$$",
            "answer": "$$\n\\boxed{3.647 \\times 10^{-8}}\n$$"
        },
        {
            "introduction": "The coefficients in the RTE, such as the absorption coefficient $\\alpha_{\\nu}$, are not arbitrary parameters but are determined by the underlying atomic physics. This practice challenges you to look inside the 'black box' of opacity by deriving the correction factor due to stimulated emission, starting from the fundamental Einstein coefficients. This exercise demonstrates how quantum mechanical effects become critically important in the high-temperature, high-radiation-density environments found in fusion plasmas. ",
            "id": "4037013",
            "problem": "A homogeneous, stationary deuterium–tritium plasma is observed via a single bound–bound resonance line at photon frequency $\\nu_{0}$. Assume the level populations are in Local Thermodynamic Equilibrium (LTE) at the electron temperature, with $k_{B} T_{e}$ denoting the thermal energy where $k_{B}$ is the Boltzmann constant and $T_{e}$ is the electron temperature. Starting from the Einstein coefficients for radiative transitions and the principle of detailed balance, derive the multiplicative correction factor to the monochromatic bound–bound line absorption coefficient due to stimulated emission. Then, for a fusion-relevant core electron temperature corresponding to $k_{B} T_{e} = 10$ keV, determine the photon frequency $\\nu_{*}$ at which the corrected line opacity is exactly one-half of what it would be if stimulated emission were neglected. Express your final answer for $\\nu_{*}$ in Hz and round to four significant figures.",
            "solution": "The problem asks for the derivation of the stimulated emission correction factor for the line absorption coefficient and its application to a specific scenario.\n\nLet us consider a bound-bound transition between a lower energy level $1$ and an upper energy level $2$, with number densities $n_1$ and $n_2$ and statistical weights (degeneracies) $g_1$ and $g_2$, respectively. The energy difference between the levels is $E_2 - E_1 = h\\nu_0$, where $h$ is the Planck constant and $\\nu_0$ is the line-center frequency.\n\nThree radiative processes govern the populations of these levels:\n1.  **Spontaneous Emission:** An atom in level $2$ decays to level $1$, emitting a photon. The rate is proportional to $n_2$. The Einstein coefficient for this process is $A_{21}$.\n2.  **Absorption:** An atom in level $1$ absorbs a photon of frequency $\\nu \\approx \\nu_0$ and transitions to level $2$. The rate is proportional to $n_1$ and the radiation energy density at that frequency, $u_\\nu$. The Einstein coefficient is $B_{12}$.\n3.  **Stimulated Emission:** A photon of frequency $\\nu$ induces an atom in level $2$ to emit a second, identical photon and transition to level $1$. The rate is proportional to $n_2$ and $u_\\nu$. The Einstein coefficient is $B_{21}$.\n\nThe change in the specific intensity $I_\\nu$ of a beam of radiation as it passes through a slab of material of thickness $ds$ is given by the equation of radiative transfer. When considering only absorption and emission processes, we can write:\n$$ \\frac{dI_\\nu}{ds} = j_\\nu - \\kappa_{\\nu, \\text{eff}} I_\\nu $$\nwhere $j_\\nu$ is the emission coefficient (due to spontaneous emission) and $\\kappa_{\\nu, \\text{eff}}$ is the effective absorption coefficient, which accounts for both true absorption and stimulated emission.\n\nThe energy removed from the beam per unit volume, per unit time, per unit frequency, and per unit solid angle is $\\kappa_{\\nu, \\text{eff}} I_\\nu$. This net removal is the difference between energy absorbed by the $1 \\to 2$ transitions and energy added coherently to the beam by stimulated emission ($2 \\to 1$ transitions).\n\nThe rate of true absorptions per unit volume is $n_1 B_{12} u_\\nu$. The rate of stimulated emissions per unit volume is $n_2 B_{21} u_\\nu$. Each process involves a photon of energy $h\\nu$. Let $\\phi(\\nu)$ be the normalized line profile function. The coefficient for true absorption, which we denote as $\\kappa'_\\nu$, is proportional to the density of absorbers, $n_1$. Let us write it as:\n$$ \\kappa'_\\nu = n_1 \\sigma_{12}(\\nu) $$\nwhere $\\sigma_{12}(\\nu)$ is the absorption cross-section. Similarly, the \"negative absorption\" coefficient due to stimulated emission is proportional to $n_2$:\n$$ \\kappa''_\\nu = n_2 \\sigma_{21}(\\nu) $$\nwhere $\\sigma_{21}(\\nu)$ is the cross-section for stimulated emission. The effective absorption coefficient is the difference:\n$$ \\kappa_{\\nu, \\text{eff}} = \\kappa'_\\nu - \\kappa''_\\nu = n_1 \\sigma_{12}(\\nu) - n_2 \\sigma_{21}(\\nu) $$\nThe cross-sections are related to the Einstein B-coefficients. Factoring out the true absorption term gives:\n$$ \\kappa_{\\nu, \\text{eff}} = n_1 \\sigma_{12}(\\nu) \\left[ 1 - \\frac{n_2 \\sigma_{21}(\\nu)}{n_1 \\sigma_{12}(\\nu)} \\right] = \\kappa'_\\nu \\left[ 1 - \\frac{n_2 B_{21}}{n_1 B_{12}} \\right] $$\nThe term in the square brackets is the multiplicative correction factor due to stimulated emission.\n\nTo simplify this factor, we use the conditions given. The principle of detailed balance in thermodynamic equilibrium relates the Einstein coefficients:\n$$ g_1 B_{12} = g_2 B_{21} \\quad \\implies \\quad \\frac{B_{21}}{B_{12}} = \\frac{g_1}{g_2} $$\nThe plasma is in LTE, so the level populations follow the Boltzmann distribution at the electron temperature $T_e$:\n$$ \\frac{n_2}{n_1} = \\frac{g_2}{g_1} \\exp\\left(-\\frac{h\\nu}{k_B T_e}\\right) $$\nHere, we use $\\nu$ as the frequency of the interacting photon, which is close to the resonance frequency $\\nu_0$.\n\nSubstituting these two relations into the correction factor expression:\n$$ \\text{Correction Factor} = 1 - \\frac{n_2}{n_1} \\frac{B_{21}}{B_{12}} = 1 - \\left( \\frac{g_2}{g_1} \\exp\\left(-\\frac{h\\nu}{k_B T_e}\\right) \\right) \\left( \\frac{g_1}{g_2} \\right) $$\n$$ \\text{Correction Factor} = 1 - \\exp\\left(-\\frac{h\\nu}{k_B T_e}\\right) $$\nThis is the derived multiplicative correction factor. The corrected (effective) absorption coefficient is therefore:\n$$ \\kappa_{\\nu, \\text{eff}} = \\kappa'_\\nu \\left[ 1 - \\exp\\left(-\\frac{h\\nu}{k_B T_e}\\right) \\right] $$\nwhere $\\kappa'_\\nu$ is the absorption coefficient neglecting stimulated emission.\n\nThe second part of the problem asks for the frequency $\\nu_*$ at which the corrected opacity is one-half of the uncorrected opacity, given a specific thermal energy.\nThe condition is:\n$$ \\kappa_{\\nu_*, \\text{eff}} = \\frac{1}{2} \\kappa'_{\\nu_*} $$\nSubstituting our expression for the corrected coefficient:\n$$ \\kappa'_{\\nu_*} \\left[ 1 - \\exp\\left(-\\frac{h\\nu_*}{k_B T_e}\\right) \\right] = \\frac{1}{2} \\kappa'_{\\nu_*} $$\nAssuming $\\kappa'_{\\nu_*} \\neq 0$ (i.e., there is some absorption at this frequency), we can divide both sides by $\\kappa'_{\\nu_*}$:\n$$ 1 - \\exp\\left(-\\frac{h\\nu_*}{k_B T_e}\\right) = \\frac{1}{2} $$\nSolving for the exponential term:\n$$ \\exp\\left(-\\frac{h\\nu_*}{k_B T_e}\\right) = 1 - \\frac{1}{2} = \\frac{1}{2} $$\nTaking the natural logarithm of both sides:\n$$ -\\frac{h\\nu_*}{k_B T_e} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) $$\nThis simplifies to:\n$$ \\frac{h\\nu_*}{k_B T_e} = \\ln(2) $$\nSolving for $\\nu_*$:\n$$ \\nu_* = \\frac{k_B T_e}{h} \\ln(2) $$\nNow, we must substitute the given numerical values.\nThe thermal energy is $k_B T_e = 10 \\text{ keV}$. We convert this to Joules:\n$1 \\text{ eV} = 1.602176634 \\times 10^{-19} \\text{ J}$\n$1 \\text{ keV} = 10^3 \\text{ eV}$\n$$ k_B T_e = 10 \\times 10^3 \\text{ eV} \\times \\frac{1.602176634 \\times 10^{-19} \\text{ J}}{1 \\text{ eV}} = 1.602176634 \\times 10^{-15} \\text{ J} $$\nThe physical constants are:\nPlanck constant, $h = 6.62607015 \\times 10^{-34} \\text{ J}\\cdot\\text{s}$\nNatural logarithm of $2$, $\\ln(2) \\approx 0.69314718$\n\nSubstituting these values into the expression for $\\nu_*$:\n$$ \\nu_* = \\frac{1.602176634 \\times 10^{-15} \\text{ J}}{6.62607015 \\times 10^{-34} \\text{ J}\\cdot\\text{s}} \\times 0.69314718 $$\n$$ \\nu_* \\approx (2.4179892 \\times 10^{18} \\text{ s}^{-1}) \\times 0.69314718 $$\n$$ \\nu_* \\approx 1.6761358 \\times 10^{18} \\text{ Hz} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\nu_* \\approx 1.676 \\times 10^{18} \\text{ Hz} $$\nThis frequency corresponds to a photon energy of $h\\nu_* = \\ln(2) \\times 10 \\text{ keV} \\approx 6.93 \\text{ keV}$, which is in the X-ray part of the spectrum, a typical energy for transitions in highly ionized impurities within a fusion plasma.",
            "answer": "$$ \\boxed{1.676 \\times 10^{18}} $$"
        },
        {
            "introduction": "Analytical solutions are limited to highly simplified geometries, making numerical methods essential for practical applications in fusion science. This hands-on coding exercise guides you through the development of a two-dimensional Discrete Ordinates ($S_N$) solver, a workhorse algorithm in computational radiation transport. You will implement the core concepts of sweep ordering and upwind differencing, which are crucial for building stable and physically accurate models of radiation flow in complex systems. ",
            "id": "4036979",
            "problem": "Consider the steady, monoenergetic radiation transport in a two-dimensional, convex, rectangular plasma domain with inflow boundary conditions. Let the angular flux be denoted by $\\psi(x,y,\\Omega)$, where $(x,y)$ are Cartesian coordinates and $\\Omega$ is the direction on the unit circle with direction cosines $\\mu$ (for $x$) and $\\eta$ (for $y$). The governing equation for an absorbing, isotropically emitting medium is the steady linear radiation transport equation\n$$\n\\mu \\frac{\\partial \\psi}{\\partial x} + \\eta \\frac{\\partial \\psi}{\\partial y} + \\sigma_t \\psi = q,\n$$\nwhere $\\sigma_t$ is the macroscopic total cross section and $q$ is an isotropic volumetric source term. On inflow boundaries (those portions of the boundary where $\\Omega \\cdot \\mathbf{n} < 0$ with $\\mathbf{n}$ the outward unit normal), prescribe $\\psi = g(\\Omega)$; on outflow boundaries, $\\psi$ is determined by the interior solution.\n\nUse the Discrete Ordinates (S$_N$) method with a finite set of directions $\\{\\Omega_m\\}_{m=1}^M$ and corresponding weights $\\{w_m\\}_{m=1}^M$. Assume weights are normalized such that $\\sum_{m=1}^M w_m = 1$, so the discrete scalar flux is the angular average\n$$\n\\phi(x,y) = \\sum_{m=1}^M w_m \\psi(x,y,\\Omega_m).\n$$\n\nOn a uniform Cartesian grid with $N_x \\times N_y$ cells, spacings $\\Delta x$ and $\\Delta y$, construct:\n- A sweep ordering for each discrete direction $\\Omega_m = (\\mu_m,\\eta_m)$ that visits cells from the inflow boundary into the domain.\n- A first-order upwind differencing scheme consistent with the above equation and inflow boundary conditions, ensuring monotonicity of the numerical solution when $q \\ge 0$ and $g(\\Omega_m) \\ge 0$.\n\nStarting from fundamental principles and definitions (the above transport equation, inflow boundary conditions, and upwind differencing for directional derivatives), derive the discrete update for $\\psi_{i,j,m}$ at cell $(i,j)$ for direction $m$ in terms of its upwind neighbors and boundary inflow values. Then implement a program that:\n- Generates the sweep order for each direction.\n- Computes the angular flux $\\psi_{i,j,m}$ and scalar flux $\\phi_{i,j}$ for specified test cases.\n- Verifies monotonicity properties implied by the upwind scheme.\n\nAssume a convex rectangular domain and indices $i \\in \\{0,\\ldots,N_x-1\\}$ and $j \\in \\{0,\\ldots,N_y-1\\}$. Use the following discrete direction set in two dimensions:\n- Four directions with direction cosines $\\left(\\mu_m,\\eta_m\\right) \\in \\left\\{ \\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right), \\left(\\frac{1}{\\sqrt{2}},-\\frac{1}{\\sqrt{2}}\\right), \\left(-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right), \\left(-\\frac{1}{\\sqrt{2}},-\\frac{1}{\\sqrt{2}}\\right) \\right\\}$ and weights $w_m = \\frac{1}{4}$ for $m=1,\\ldots,4$.\n\nYour program must implement the upwind discrete update, apply the inflow boundary condition $g$ where the upwind neighbor lies outside the domain, and perform sweeps in the correct order for each direction based on the signs of $\\mu_m$ and $\\eta_m$.\n\nTest Suite:\n- Test Case 1 (happy path): $N_x = 6$, $N_y = 5$, $\\Delta x = 0.1$ meters, $\\Delta y = 0.1$ meters, $\\sigma_t = 1.0$ meters$^{-1}$, $q = 1.0$ (isotropic, same for all directions), $g = 0.0$. Compute the scalar flux field and report $\\min_{i,j} \\phi_{i,j}$. Express the value in particles per square meter per second (i.e., in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$).\n- Test Case 2 (monotonicity in source): Same geometry and directions as Test Case 1. Compare two cases with $q_1 = 0.5$ and $q_2 = 1.0$, with $g = 0.0$ and $\\sigma_t = 1.0$ meters$^{-1}$. Verify that $\\phi^{(2)}_{i,j} \\ge \\phi^{(1)}_{i,j}$ for all cells. Output a boolean that is $\\mathrm{True}$ if the inequality holds everywhere (to within a tolerance consistent with floating-point arithmetic), otherwise $\\mathrm{False}$.\n- Test Case 3 (monotonicity in absorption): Same geometry and directions as Test Case 1. With $q = 1.0$ and $g = 0.0$, compare $\\sigma_{t,\\mathrm{low}} = 0.5$ meters$^{-1}$ and $\\sigma_{t,\\mathrm{high}} = 2.0$ meters$^{-1}$. Verify that $\\phi^{(\\mathrm{high})}_{i,j} \\le \\phi^{(\\mathrm{low})}_{i,j}$ for all cells. Output a boolean that is $\\mathrm{True}$ if the inequality holds everywhere (to within a tolerance consistent with floating-point arithmetic), otherwise $\\mathrm{False}$.\n- Test Case 4 (ordering check, edge case): $N_x = 3$, $N_y = 3$, a single direction with $(\\mu,\\eta) = (0.6,-0.8)$ (unit direction is not required for the ordering check), and arbitrary $\\Delta x$, $\\Delta y$. Construct the sweep ordering and verify that the first visited cell is $(0,N_y-1)$ and the last visited cell is $(N_x-1,0)$ when $\\mu>0$ and $\\eta<0$, and that the ordering contains exactly $N_x \\cdot N_y$ cells. Output a boolean that is $\\mathrm{True}$ if all conditions hold, otherwise $\\mathrm{False}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n- $\\min \\phi$ for Test Case 1 (a float in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$),\n- the boolean result for Test Case 2,\n- the boolean result for Test Case 3,\n- the boolean result for Test Case 4.\n\nFor example, the output should look like $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$.\n\nAll angles are specified via direction cosines, which are dimensionless. The scalar flux values reported are angular averages (weights sum to $1$), so their units are the same as the angular flux, namely particles per square meter per second. Angles are not reported, so no angle unit is required for the output. Ensure that all numeric outputs are generated deterministically without requiring any external input.",
            "solution": "The task is to solve the two-dimensional, steady-state, monoenergetic linear radiation transport equation on a rectangular domain using the Discrete Ordinates (S$_N$) method with first-order upwind spatial differencing. The governing equation is:\n$$\n\\mu \\frac{\\partial \\psi}{\\partial x} + \\eta \\frac{\\partial \\psi}{\\partial y} + \\sigma_t \\psi = q\n$$\nHere, $\\psi(x, y, \\Omega)$ is the angular flux for particles at position $(x,y)$ traveling in direction $\\Omega$. The direction cosines are $\\mu$ and $\\eta$. The medium is characterized by a constant total cross-section $\\sigma_t$ and an isotropic volumetric source $q$. The solution will be developed by first deriving the discrete update formula, then establishing the correct computational procedure (sweep order), and finally implementing this algorithm to solve the specified test cases.\n\n**1. Discretization of the Transport Equation**\n\nWe discretize the equation on a uniform Cartesian grid with cells of size $\\Delta x \\times \\Delta y$. The grid indices are $i \\in \\{0, \\ldots, N_x-1\\}$ and $j \\in \\{0, \\ldots, N_y-1\\}$. We consider a discrete set of $M$ directions $\\{\\Omega_m\\}_{m=1}^M$, where direction $\\Omega_m$ has cosines $(\\mu_m, \\eta_m)$. For each direction $m$, we approximate the continuous equation. Let $\\psi_{i,j,m}$ be the average angular flux in cell $(i,j)$ for direction $m$.\n\nA first-order finite difference approximation of the spatial derivatives at the cell center $(x_i, y_j)$ is:\n$$\n\\left. \\frac{\\partial \\psi_m}{\\partial x} \\right|_{i,j} \\approx \\frac{\\psi_{i+1/2,j,m} - \\psi_{i-1/2,j,m}}{\\Delta x}\n$$\n$$\n\\left. \\frac{\\partial \\psi_m}{\\partial y} \\right|_{i,j} \\approx \\frac{\\psi_{i,j+1/2,m} - \\psi_{i,j-1/2,m}}{\\Delta y}\n$$\nwhere $\\psi_{i+1/2,j,m}$ is the angular flux on the right face of the cell, $\\psi_{i-1/2,j,m}$ is the flux on the left face, and so on.\n\nThe first-order upwind scheme (or \"step\" scheme) approximates the face flux with the cell-average flux from the upwind cell. The upwind cell is the one from which particles are flowing. For example, if $\\mu_m > 0$, particles flow from left to right, so the upwind direction for the $x$-derivative is from cell $i-1$. The face fluxes are thus approximated as:\n- $\\psi_{i-1/2,j,m} = \\psi_{i-1,j,m}$ and $\\psi_{i+1/2,j,m} = \\psi_{i,j,m}$ if $\\mu_m > 0$.\n- $\\psi_{i+1/2,j,m} = \\psi_{i+1,j,m}$ and $\\psi_{i-1/2,j,m} = \\psi_{i,j,m}$ if $\\mu_m < 0$.\n\nAnd similarly for the $y$-direction based on the sign of $\\eta_m$. Substituting these into the finite difference approximations gives:\n$$\n\\frac{\\partial \\psi_m}{\\partial x} \\approx \\frac{\\psi_{i,j,m} - \\psi_{\\text{upwind},x}}{\\Delta x} \\quad (\\text{if } \\mu_m > 0) \\quad \\text{or} \\quad \\frac{\\psi_{\\text{upwind},x} - \\psi_{i,j,m}}{\\Delta x} \\quad (\\text{if } \\mu_m < 0)\n$$\nThis can be written compactly using the absolute value: $\\mu_m \\frac{\\partial \\psi_m}{\\partial x} \\approx \\frac{|\\mu_m|}{\\Delta x} (\\psi_{i,j,m} - \\psi_{\\text{upwind},x})$.\n\nThe fully discretized equation for cell $(i,j)$ and direction $m$ is:\n$$\n\\frac{|\\mu_m|}{\\Delta x} (\\psi_{i,j,m} - \\psi_{x, \\text{in}}) + \\frac{|\\eta_m|}{\\Delta y} (\\psi_{i,j,m} - \\psi_{y, \\text{in}}) + \\sigma_t \\psi_{i,j,m} = q\n$$\nHere, $\\psi_{x, \\text{in}}$ and $\\psi_{y, \\text{in}}$ are the upwind angular fluxes on the cell faces in the $x$ and $y$ directions, respectively.\n\n**2. Discrete Update Formula**\n\nWe can solve the algebraic equation from the previous step for $\\psi_{i,j,m}$:\n$$\n\\psi_{i,j,m} \\left( \\frac{|\\mu_m|}{\\Delta x} + \\frac{|\\eta_m|}{\\Delta y} + \\sigma_t \\right) = \\frac{|\\mu_m|}{\\Delta x} \\psi_{x, \\text{in}} + \\frac{|\\eta_m|}{\\Delta y} \\psi_{y, \\text{in}} + q\n$$\nThis yields the final update formula:\n$$\n\\psi_{i,j,m} = \\frac{\\frac{|\\mu_m|}{\\Delta x} \\psi_{x, \\text{in}} + \\frac{|\\eta_m|}{\\Delta y} \\psi_{y, \\text{in}} + q}{\\frac{|\\mu_m|}{\\Delta x} + \\frac{|\\eta_m|}{\\Delta y} + \\sigma_t}\n$$\nThe upwind flux values, $\\psi_{x, \\text{in}}$ and $\\psi_{y, \\text{in}}$, depend on the direction $(\\mu_m, \\eta_m)$:\n- If $\\mu_m > 0$, $\\psi_{x, \\text{in}} = \\psi_{i-1,j,m}$. If $i=0$, this is an inflow boundary, so $\\psi_{x, \\text{in}} = g(\\Omega_m)$.\n- If $\\mu_m < 0$, $\\psi_{x, \\text{in}} = \\psi_{i+1,j,m}$. If $i=N_x-1$, this is an inflow boundary, so $\\psi_{x, \\text{in}} = g(\\Omega_m)$.\n- If $\\eta_m > 0$, $\\psi_{y, \\text{in}} = \\psi_{i,j-1,m}$. If $j=0$, this is an inflow boundary, so $\\psi_{y, \\text{in}} = g(\\Omega_m)$.\n- If $\\eta_m < 0$, $\\psi_{y, \\text{in}} = \\psi_{i,j+1,m}$. If $j=N_y-1$, this is an inflow boundary, so $\\psi_{y, \\text{in}} = g(\\Omega_m)$.\n\n**3. Sweep Ordering**\n\nThe update for $\\psi_{i,j,m}$ depends on pre-computed values in adjacent upwind cells. This data dependency imposes a strict computational order, known as a sweep, across the grid. The sweep must proceed from the inflow boundaries of the domain into the interior, following the \"flow\" of particles for that direction. The sweep order is determined entirely by the signs of $\\mu_m$ and $\\eta_m$, which define the quadrant of the direction vector.\n\nFor a rectangular grid with $i \\in \\{0, \\ldots, N_x-1\\}$ and $j \\in \\{0, \\ldots, N_y-1\\}$:\n1.  **Quadrant I ($\\mu_m > 0, \\eta_m > 0$):** Sweep from bottom-left to top-right. The loops run $i$ from $0$ to $N_x-1$ and $j$ from $0$ to $N_y-1$.\n2.  **Quadrant II ($\\mu_m < 0, \\eta_m > 0$):** Sweep from bottom-right to top-left. The loops run $i$ from $N_x-1$ down to $0$ and $j$ from $0$ to $N_y-1$.\n3.  **Quadrant III ($\\mu_m < 0, \\eta_m < 0$):** Sweep from top-right to bottom-left. The loops run $i$ from $N_x-1$ down to $0$ and $j$ from $N_y-1$ down to $0$.\n4.  **Quadrant IV ($\\mu_m > 0, \\eta_m < 0$):** Sweep from top-left to bottom-right. The loops run $i$ from $0$ to $N_x-1$ and $j$ from $N_y-1$ down to $0$.\n\nThis ensures that whenever $\\psi_{i,j,m}$ is computed, the necessary upwind values ($\\psi_{i \\pm 1, j, m}$ and $\\psi_{i, j \\pm 1, m}$) are already available from the current sweep.\n\n**4. Algorithmic Implementation and Verification**\n\nThe overall algorithm consists of iterating through each discrete direction, performing a full spatial sweep to compute the angular flux field $\\psi_m(x,y)$, and adding its weighted contribution to the total scalar flux $\\phi(x,y)$.\n\nThe algorithm is as follows:\n1.  Initialize a $N_x \\times N_y$ array for the scalar flux $\\phi$ to all zeros.\n2.  For each discrete direction $\\Omega_m$ with weight $w_m$:\n    a. Determine the sweep order (loop ranges for $i$ and $j$) based on the signs of $\\mu_m, \\eta_m$.\n    b. Create a temporary $N_x \\times N_y$ array, $\\psi_m$, initialized to zeros.\n    c. Perform the sweep: iterate through all cells $(i,j)$ in the determined order. In each cell:\n        i. Identify the upwind fluxes $\\psi_{x, \\text{in}}$ and $\\psi_{y, \\text{in}}$ using the boundary value $g(\\Omega_m)$ or the previously computed value in $\\psi_m$.\n        ii. Calculate $\\psi_{i,j,m}$ using the derived discrete update formula.\n        iii. Store the result in $\\psi_m[i,j]$.\n    d. Add the angular flux contribution to the scalar flux: $\\phi \\leftarrow \\phi + w_m \\psi_m$.\n3.  After iterating through all directions, the array $\\phi$ contains the final scalar flux field.\n\nThis algorithm is implemented in the provided Python code. The test cases verify key properties:\n- **Test Case 1:** Directly computes the scalar flux field and finds its minimum value for a given set of parameters.\n- **Test Case 2 (Source Monotonicity):** The update formula shows that $\\psi_{i,j,m}$ is a monotonically increasing function of the source term $q$ (since all coefficients and the denominator are positive). Thus, the scalar flux $\\phi = \\sum w_m \\psi_m$ must also be monotonic with respect to $q$. We verify that $\\phi^{(2)} \\ge \\phi^{(1)}$ when $q_2 > q_1$.\n- **Test Case 3 (Absorption Monotonicity):** The cross-section $\\sigma_t$ appears in the denominator of the update formula. Thus, $\\psi_{i,j,m}$ is a monotonically decreasing function of $\\sigma_t$. We verify that $\\phi^{(\\text{high})} \\le \\phi^{(\\text{low})}$ when $\\sigma_{t,\\text{high}} > \\sigma_{t,\\text{low}}$.\n- **Test Case 4 (Sweep Order):** The sweep ordering logic is directly tested for a direction in Quadrant IV, confirming the first and last cells visited and the total number of cells in the sweep path.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_sweep_order_info(Nx, Ny, mu, eta):\n    \"\"\"\n    Generates sweep order for a given direction and performs checks for Test Case 4.\n    \"\"\"\n    order = []\n    i_range = range(Nx) if mu > 0 else range(Nx - 1, -1, -1)\n    j_range = range(Ny) if eta > 0 else range(Ny - 1, -1, -1)\n    \n    for i in i_range:\n        for j in j_range:\n            order.append((i, j))\n            \n    # Expected first and last cells for mu > 0, eta  0\n    expected_first = (0, Ny - 1)\n    expected_last = (Nx - 1, 0)\n    \n    check1 = (order[0] == expected_first)\n    check2 = (order[-1] == expected_last)\n    check3 = (len(order) == Nx * Ny)\n    \n    return all([check1, check2, check3])\n\ndef transport_sweep_solver(Nx, Ny, dx, dy, sigma_t, q, g, directions, weights):\n    \"\"\"\n    Solves the 2D S_N transport equation using first-order upwinding.\n    \"\"\"\n    phi = np.zeros((Nx, Ny))\n    num_directions = len(directions)\n    \n    for m in range(num_directions):\n        mu_m, eta_m = directions[m]\n        w_m = weights[m]\n        \n        psi_m = np.zeros((Nx, Ny))\n        \n        # Determine sweep order based on direction quadrant\n        i_range = range(Nx) if mu_m > 0 else range(Nx - 1, -1, -1)\n        j_range = range(Ny) if eta_m > 0 else range(Ny - 1, -1, -1)\n        \n        # Perform transport sweep for direction m\n        for i in i_range:\n            for j in j_range:\n                # Determine upwind flux in x-direction\n                if mu_m > 0:\n                    psi_x_in = psi_m[i - 1, j] if i > 0 else g\n                else:  # mu_m  0\n                    psi_x_in = psi_m[i + 1, j] if i  Nx - 1 else g\n                \n                # Determine upwind flux in y-direction\n                if eta_m > 0:\n                    psi_y_in = psi_m[i, j - 1] if j > 0 else g\n                else:  # eta_m  0\n                    psi_y_in = psi_m[i, j + 1] if j  Ny - 1 else g\n\n                # Since mu_m and eta_m are non-zero for the given problem,\n                # we don't need to handle the case of zero-dimensional derivatives.\n                \n                abs_mu_m = abs(mu_m)\n                abs_eta_m = abs(eta_m)\n                \n                numerator = (abs_mu_m / dx) * psi_x_in + (abs_eta_m / dy) * psi_y_in + q\n                denominator = (abs_mu_m / dx) + (abs_eta_m / dy) + sigma_t\n                \n                psi_m[i, j] = numerator / denominator\n                \n        # Add contribution to scalar flux\n        phi += w_m * psi_m\n        \n    return phi\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    results = []\n    \n    # Common parameters\n    Nx_common, Ny_common = 6, 5\n    dx_common, dy_common = 0.1, 0.1\n    g_common = 0.0\n    \n    # S4-like discrete ordinate set\n    sqrt2_inv = 1.0 / np.sqrt(2)\n    directions_common = np.array([\n        [sqrt2_inv, sqrt2_inv],\n        [sqrt2_inv, -sqrt2_inv],\n        [-sqrt2_inv, sqrt2_inv],\n        [-sqrt2_inv, -sqrt2_inv]\n    ])\n    weights_common = np.array([0.25, 0.25, 0.25, 0.25])\n    \n    # --- Test Case 1: Happy Path ---\n    sigma_t_tc1 = 1.0\n    q_tc1 = 1.0\n    phi_tc1 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_tc1, q_tc1, g_common,\n        directions_common, weights_common\n    )\n    result1 = np.min(phi_tc1)\n    results.append(result1)\n\n    # --- Test Case 2: Monotonicity in Source ---\n    sigma_t_tc2 = 1.0\n    q1 = 0.5\n    q2 = 1.0\n    phi1_tc2 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_tc2, q1, g_common,\n        directions_common, weights_common\n    )\n    phi2_tc2 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_tc2, q2, g_common,\n        directions_common, weights_common\n    )\n    # Verify phi2 >= phi1 for all cells, with a small tolerance for floating point errors\n    result2 = bool(np.all(phi2_tc2 >= phi1_tc2 - 1e-12))\n    results.append(result2)\n\n    # --- Test Case 3: Monotonicity in Absorption ---\n    q_tc3 = 1.0\n    sigma_t_low = 0.5\n    sigma_t_high = 2.0\n    phi_low_tc3 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_low, q_tc3, g_common,\n        directions_common, weights_common\n    )\n    phi_high_tc3 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_high, q_tc3, g_common,\n        directions_common, weights_common\n    )\n    # Verify phi_high = phi_low for all cells, with a small tolerance\n    result3 = bool(np.all(phi_high_tc3 = phi_low_tc3 + 1e-12))\n    results.append(result3)\n    \n    # --- Test Case 4: Ordering Check ---\n    Nx_tc4, Ny_tc4 = 3, 3\n    mu_tc4, eta_tc4 = 0.6, -0.8 # mu > 0, eta  0\n    # The dx, dy values are not needed for ordering check.\n    result4 = generate_sweep_order_info(Nx_tc4, Ny_tc4, mu_tc4, eta_tc4)\n    results.append(result4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}