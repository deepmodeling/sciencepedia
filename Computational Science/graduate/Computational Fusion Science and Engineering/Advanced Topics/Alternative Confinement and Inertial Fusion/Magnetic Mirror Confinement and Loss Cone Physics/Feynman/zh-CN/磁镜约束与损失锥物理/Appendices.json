{
    "hands_on_practices": [
        {
            "introduction": "磁镜约束中的基本概念是将粒子区分为“捕获”和“丢失”两类。本练习将引导您直接从能量守恒和磁矩守恒这两个第一性原理出发，推导出定义“损失锥”的临界俯仰角。通过将此推导应用于一个具体场景 ，您将巩固对粒子约束基本条件的理解。",
            "id": "4012768",
            "problem": "考虑一个直的、轴对称的磁镜装置，其磁场大小沿磁力线变化，在中间平面处有最小值，在两端有对称的最大值。假设粒子运动遵循导心近似，在没有电场和碰撞的情况下，第一绝热不变量（磁矩）和总能量守恒。设磁镜比定义为 $R \\equiv B_{\\max}/B_{\\min}$。一个离子在中间平面（$B=B_{\\min}$）处以总速率 $v$ 和俯仰角 $\\alpha$ 注入，中间平面处的俯仰角定义为 $\\tan\\alpha \\equiv v_{\\perp}/v_{\\parallel}$。\n\n从磁矩 $\\mu \\equiv m v_{\\perp}^{2}/(2B)$ 和总能量 $E \\equiv \\tfrac{1}{2} m v^{2}$ 的定义出发，并仅利用它们沿磁力线的守恒性，推导磁镜反射的条件，并确定在中间平面处区分被捕获轨道与进入磁镜喉部而丢失的轨道的临界俯仰角 $\\alpha_{c}$。\n\n然后，对于在 $B_{\\min}=0.2\\,\\text{T}$ 处速度为 $v=3\\times 10^{5}\\,\\text{m/s}$、磁镜比为 $R=16$ 的离子，计算 $\\alpha_{c}$，并确定一个在中间平面以初始俯仰角 $\\alpha=10^{\\circ}$ 发射的粒子是丢失还是被约束。将临界俯仰角以度为单位表示，并四舍五入到四位有效数字。为了报告结果，定义一个指示符 $L$，如果粒子丢失（即其轨道在损失锥内），则 $L=1$；如果粒子被约束（即它被反射），则 $L=0$。将您的最终答案以一个 $1\\times 2$ 的行矩阵 $\\begin{pmatrix} \\alpha_{c}  L \\end{pmatrix}$ 的形式报告，其中 $\\alpha_{c}$ 按要求以度为单位。",
            "solution": "所述问题在科学上是合理的，提法恰当，并包含了唯一解所需的所有信息。这是一个关于带电粒子在磁镜位形中运动的等离子体物理学标准问题。因此，我们可以进行推导和求解。\n\n控制粒子运动的基本原理是其总动能 $E$ 和磁矩 $\\mu$ 的守恒。给定没有电场，因此势能为零。\n\n总动能为：\n$$ E = \\frac{1}{2} m v^{2} = \\frac{1}{2} m (v_{\\parallel}^{2} + v_{\\perp}^{2}) $$\n这里，$m$ 是粒子质量，$v$ 是其总速率，$v_{\\parallel}$ 和 $v_{\\perp}$ 分别是平行和垂直于磁场矢量 $\\vec{B}$ 的速度分量。由于 $E$ 和 $m$ 是常数，总速率 $v$ 沿粒子轨道也是恒定的。\n\n磁矩，或第一绝热不变量，是：\n$$ \\mu = \\frac{m v_{\\perp}^{2}}{2B} $$\n其中 $B = |\\vec{B}|$ 是磁场的大小。$\\mu$ 的守恒是这个问题的基石。\n\n我们用下标 '$0$' 表示磁镜装置中间平面处的条件，那里的磁场处于其最小值 $B_{\\min}$。任何没有下标的量指的是粒子路径上磁场强度为 $B$ 的任意点处的值。\n\n根据 $\\mu$ 的守恒，我们可以写出：\n$$ \\frac{m v_{\\perp,0}^{2}}{2 B_{\\min}} = \\frac{m v_{\\perp}^{2}}{2 B} $$\n这使我们可以将任意点的垂直速率与其在中间平面处的初始值联系起来：\n$$ v_{\\perp}^{2} = v_{\\perp,0}^{2} \\left( \\frac{B}{B_{\\min}} \\right) $$\n\n根据能量守恒，我们有：\n$$ v^{2} = v_{\\parallel}^{2} + v_{\\perp}^{2} = v_{\\parallel,0}^{2} + v_{\\perp,0}^{2} $$\n我们可以在任意点 $B$ 处找到平行速度分量 $v_{\\parallel}$ 的表达式：\n$$ v_{\\parallel}^{2} = v^{2} - v_{\\perp}^{2} $$\n代入从 $\\mu$ 守恒得到的 $v_{\\perp}^{2}$ 的表达式：\n$$ v_{\\parallel}^{2} = v^{2} - v_{\\perp,0}^{2} \\left( \\frac{B}{B_{\\min}} \\right) $$\n\n问题指明了在中间平面处的初始俯仰角 $\\alpha$。中间平面处的速度分量可以用总速率 $v$ 和这个俯仰角 $\\alpha$ 表示为：\n$$ v_{\\perp,0} = v \\sin\\alpha $$\n$$ v_{\\parallel,0} = v \\cos\\alpha $$\n这些定义与问题陈述中 $\\tan\\alpha = v_{\\perp,0}/v_{\\parallel,0}$ 一致。将 $v_{\\perp,0}^{2} = v^{2} \\sin^{2}\\alpha$ 代入 $v_{\\parallel}^{2}$ 的方程中：\n$$ v_{\\parallel}^{2} = v^{2} - (v^{2} \\sin^{2}\\alpha) \\left( \\frac{B}{B_{\\min}} \\right) $$\n提出因子 $v^{2}$：\n$$ v_{\\parallel}^{2} = v^{2} \\left( 1 - \\frac{B}{B_{\\min}} \\sin^{2}\\alpha \\right) $$\n这个方程描述了粒子的平行动能如何随着它沿磁力线运动而变化。\n\n当粒子的平行速度变为零（$v_{\\parallel} = 0$）时，它在该点被反射或“镜像”。在这个转折点，其所有动能都在垂直运动中。设反射点的磁场为 $B_{\\text{refl}}$。令 $v_{\\parallel} = 0$ 提供了反射条件：\n$$ 0 = v^{2} \\left( 1 - \\frac{B_{\\text{refl}}}{B_{\\min}} \\sin^{2}\\alpha \\right) $$\n对于一个速度不为零的粒子（$v \\neq 0$），这简化为：\n$$ 1 = \\frac{B_{\\text{refl}}}{B_{\\min}} \\sin^{2}\\alpha \\quad \\implies \\quad \\sin^{2}\\alpha = \\frac{B_{\\min}}{B_{\\text{refl}}} $$\n\n如果一个粒子在到达磁镜末端（磁场达到最大值 $B_{\\max}$）之前被反射，则认为它被捕获或约束。这意味着反射必须在场强 $B_{\\text{refl}} \\le B_{\\max}$ 处发生。将此应用于我们的反射条件：\n$$ \\frac{B_{\\min}}{\\sin^{2}\\alpha} \\le B_{\\max} $$\n重新整理这个不等式，得到用初始俯仰角 $\\alpha$ 表示的粒子约束条件：\n$$ \\sin^{2}\\alpha \\ge \\frac{B_{\\min}}{B_{\\max}} $$\n使用磁镜比的定义 $R \\equiv B_{\\max}/B_{\\min}$，约束条件变为：\n$$ \\sin^{2}\\alpha \\ge \\frac{1}{R} $$\n\n不满足此条件的粒子将穿过磁镜而丢失。这些粒子被称为在“损失锥”中。临界俯仰角 $\\alpha_c$ 定义了这个损失锥的边界。它对应于一个恰好在最大磁场处反射的粒子，即 $B_{\\text{refl}} = B_{\\max}$。在这个临界角下，约束条件是一个等式：\n$$ \\sin^{2}\\alpha_{c} = \\frac{1}{R} $$\n由于俯仰角在范围 $[0, \\pi/2]$ 内，我们可以取正平方根：\n$$ \\sin\\alpha_{c} = \\frac{1}{\\sqrt{R}} $$\n因此，临界俯仰角由以下公式给出：\n$$ \\alpha_{c} = \\arcsin\\left(\\frac{1}{\\sqrt{R}}\\right) $$\n任何在中间平面以初始俯仰角 $\\alpha  \\alpha_c$ 发射的粒子都在损失锥内，将会逃逸。\n\n现在我们应用给定的数值。我们有磁镜比 $R=16$。粒子速度 $v=3 \\times 10^{5}\\,\\text{m/s}$ 和最小场强 $B_{\\min}=0.2\\,\\text{T}$ 的值对于计算 $\\alpha_c$ 不是必需的，因为它仅取决于通过 $R$ 表示的磁场几何形状。\n$$ \\alpha_{c} = \\arcsin\\left(\\frac{1}{\\sqrt{16}}\\right) = \\arcsin\\left(\\frac{1}{4}\\right) = \\arcsin(0.25) $$\n为了用度表示，我们进行数值计算：\n$$ \\alpha_{c} \\approx 14.477512...^{\\circ} $$\n按要求四舍五入到四位有效数字：\n$$ \\alpha_{c} \\approx 14.48^{\\circ} $$\n\n接下来，我们评估一个以初始俯仰角 $\\alpha_{\\text{initial}} = 10^{\\circ}$ 发射的粒子的轨道。我们将这个角度与临界角 $\\alpha_c$ 进行比较：\n$$ \\alpha_{\\text{initial}} = 10^{\\circ}  14.48^{\\circ} \\approx \\alpha_{c} $$\n由于初始俯仰角小于临界角，粒子的速度矢量位于损失锥内。因此，粒子未被约束并将丢失。\n\n最后，我们确定指示变量 $L$，其定义为：对于丢失的粒子 $L=1$，对于被约束的粒子 $L=0$。由于粒子丢失，我们有 $L=1$。\n\n所要求的答案是行矩阵 $\\begin{pmatrix} \\alpha_c  L \\end{pmatrix}$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 14.48  1 \\end{pmatrix}} $$"
        },
        {
            "introduction": "对于被成功捕获的粒子，它们的运动并非静止不变，而是在磁场线上的两个反射点之间振荡。本练习通过为一个抛物线形磁阱推导轴向反弹频率，来量化这种“反弹运动” 。理解这个频率对于分析约束的时间尺度和共振相互作用的可能性至关重要。",
            "id": "4007024",
            "problem": "考虑一个非相对论性带电粒子，在静态轴对称磁镜中进行导心运动。磁镜在中平面附近的轴向磁场由 $B(z) = B_0 (1 + \\beta z^2)$ 给出，其中 $B_0  0$ 和 $\\beta  0$ 是常数，$z$ 是从中平面 $z=0$ 测量的轴向坐标。粒子的总动能为 $E$，在 $z=0$ 处的初始投掷角为 $\\alpha_0$，投掷角定义为粒子速度与磁场方向之间的夹角。假设第一绝热不变量守恒，且粒子被捕获，满足 $0  \\alpha_0  \\pi/2$，因此存在转折点。仅从能量守恒和第一绝热不变量守恒出发，推导出磁镜捕获运动的轴向弹跳角频率 $\\omega_b$ 的闭合形式表达式，该表达式是 $E$、$\\alpha_0$、$\\beta$ 和粒子质量 $m$ 的函数。角度必须以弧度表示。最终的角弹跳频率以弧度/秒为单位表示。此外，定性地说明在 $E$、$\\alpha_0$ 和 $m$ 固定的情况下，$\\omega_b$ 如何依赖于 $\\beta$。你的最终答案必须是 $\\omega_b$ 的一个解析表达式。",
            "solution": "我们使用导心近似来模拟粒子在缓变磁场中的运动，并假设其为非相对论性运动。基本出发点是：\n- 总动能守恒：$E = \\frac{1}{2} m v^2$，其中 $v^2 = v_{\\parallel}^2 + v_{\\perp}^2$。\n- 第一绝热不变量守恒：$\\mu = \\frac{m v_{\\perp}^2}{2 B}$。\n\n在中平面 $z=0$ 处，磁场为 $B(0)=B_0$。投掷角 $\\alpha_0$ 由 $\\sin \\alpha_0 = v_{\\perp}(0)/v(0)$ 和 $\\cos \\alpha_0 = v_{\\parallel}(0)/v(0)$ 定义。利用 $v^2 = \\frac{2E}{m}$，我们求出 $z=0$ 处的磁矩，\n$$\n\\mu = \\frac{m v_{\\perp}^2(0)}{2 B_0} = \\frac{m}{2 B_0} \\left( v^2(0) \\sin^2 \\alpha_0 \\right) = \\frac{m}{2 B_0} \\left( \\frac{2E}{m} \\sin^2 \\alpha_0 \\right) = \\frac{E \\sin^2 \\alpha_0}{B_0}.\n$$\n\n因为 $\\mu$ 是守恒的，所以在任意 $z$ 处的垂直速度满足 $v_{\\perp}^2(z) = \\frac{2 \\mu B(z)}{m}$。那么平行速度为\n$$\nv_{\\parallel}^2(z) = v^2 - v_{\\perp}^2(z) = \\frac{2E}{m} - \\frac{2\\mu B(z)}{m} = \\frac{2}{m} \\left( E - \\mu B(z) \\right).\n$$\n利用 $B(z) = B_0 (1 + \\beta z^2)$ 和 $\\mu = \\frac{E \\sin^2 \\alpha_0}{B_0}$，我们得到\n$$\nE - \\mu B(z) = E - \\frac{E \\sin^2 \\alpha_0}{B_0} B_0 (1 + \\beta z^2) = E \\left[ 1 - \\sin^2 \\alpha_0 (1 + \\beta z^2) \\right] = E \\left[ \\cos^2 \\alpha_0 - \\beta \\sin^2 \\alpha_0 \\, z^2 \\right].\n$$\n因此，\n$$\nv_{\\parallel}(z) = \\sqrt{\\frac{2E}{m}} \\, \\sqrt{ \\cos^2 \\alpha_0 - \\beta \\sin^2 \\alpha_0 \\, z^2 }.\n$$\n\n转折点 $z = \\pm z_m$ 由 $v_{\\parallel}(z_m) = 0$ 给出，所以\n$$\n\\cos^2 \\alpha_0 - \\beta \\sin^2 \\alpha_0 \\, z_m^2 = 0 \\quad \\Rightarrow \\quad z_m^2 = \\frac{\\cos^2 \\alpha_0}{\\beta \\sin^2 \\alpha_0}.\n$$\n\n在 $-z_m$ 和 $+z_m$ 之间一次完整振荡的弹跳周期 $T_b$ 是\n$$\nT_b = 2 \\int_{-z_m}^{z_m} \\frac{dz}{|v_{\\parallel}(z)|} = 4 \\int_{0}^{z_m} \\frac{dz}{v_{\\parallel}(z)},\n$$\n利用对称性以及在 $z \\in (0,z_m)$ 区间内 $v_{\\parallel}(z)  0$。代入 $v_{\\parallel}(z)$ 的表达式，\n$$\nT_b = \\frac{4}{\\sqrt{ \\frac{2E}{m} }} \\int_{0}^{z_m} \\frac{dz}{ \\sqrt{ \\cos^2 \\alpha_0 - \\beta \\sin^2 \\alpha_0 \\, z^2 } }.\n$$\n\n定义 $A = \\cos^2 \\alpha_0$ 和 $B = \\beta \\sin^2 \\alpha_0$，则积分变为\n$$\nI \\equiv \\int_{0}^{z_m} \\frac{dz}{\\sqrt{A - B z^2}}, \\quad z_m = \\sqrt{\\frac{A}{B}}.\n$$\n在平方根内提出因子 $A$：\n$$\nI = \\frac{1}{\\sqrt{A}} \\int_{0}^{z_m} \\frac{dz}{\\sqrt{1 - \\frac{B}{A} z^2}}.\n$$\n令 $u = \\sqrt{\\frac{B}{A}} \\, z$，则 $dz = \\sqrt{\\frac{A}{B}} \\, du$，积分上下限变为 $u \\in [0,1]$。那么\n$$\nI = \\frac{1}{\\sqrt{A}} \\int_{0}^{1} \\frac{\\sqrt{\\frac{A}{B}} \\, du}{\\sqrt{1 - u^2}} = \\frac{1}{\\sqrt{B}} \\int_{0}^{1} \\frac{du}{\\sqrt{1 - u^2}} = \\frac{1}{\\sqrt{B}} \\left[ \\arcsin(u) \\right]_0^1 = \\frac{\\pi}{2 \\sqrt{B}}.\n$$\n因此，\n$$\nT_b = \\frac{4}{\\sqrt{ \\frac{2E}{m} }} \\cdot \\frac{\\pi}{2 \\sqrt{B}} = \\frac{2 \\pi}{ \\sqrt{ \\frac{2E}{m} } \\, \\sqrt{B} }.\n$$\n弹跳角频率 $\\omega_b$ 是\n$$\n\\omega_b = \\frac{2 \\pi}{T_b} = \\sqrt{ \\frac{2E}{m} } \\, \\sqrt{B}.\n$$\n代回 $B = \\beta \\sin^2 \\alpha_0$，我们得到闭合形式的表达式\n$$\n\\omega_b = \\sqrt{ \\frac{2E}{m} } \\, \\sqrt{ \\beta } \\, |\\sin \\alpha_0|.\n$$\n在给定的捕获条件 $0  \\alpha_0  \\pi/2$ 和 $\\beta  0$ 下，$\\sin \\alpha_0  0$，所以我们可以写成\n$$\n\\omega_b = \\sqrt{ \\frac{2 E \\beta}{m} } \\, \\sin \\alpha_0.\n$$\n\n对 $\\beta$ 的定性依赖关系：对于固定的 $E$、$\\alpha_0$ 和 $m$，弹跳角频率按 $\\omega_b \\propto \\sqrt{\\beta}$ 的比例变化。因此，增加 $\\beta$（这会增强中平面附近 $B(z)$ 的轴向曲率）会使弹跳频率像 $\\beta$ 的平方根一样单调增加。此外，在这个局域二次模型中，$\\omega_b$ 与 $B_0$ 无关，这反映了小振幅回复力取决于曲率 $\\beta$ 和磁矩 $\\mu$，而不是中平面场幅 $B_0$。陷俘条件要求 $\\beta  0$；当 $\\beta \\to 0^+$ 时，弹跳频率趋于 $0$，这与在该局域近似下磁镜曲率消失和沿 $z$ 方向的振荡约束丧失相一致。",
            "answer": "$$\\boxed{\\sqrt{\\frac{2 E \\beta}{m}}\\,\\sin\\alpha_0}$$"
        },
        {
            "introduction": "理想的无碰撞约束是一个有用的起点，但现实世界中的磁镜装置受限于将粒子散射到损失锥中的各种过程。这个高级问题通过将俯仰角散射建模为一个扩散过程，在理论与现实之间架起了一座桥梁 。通过计算一个粒子在完成至少一次反射前仍然存活的概率，您将接触到决定非理想磁镜中实际约束时间的核心概念。",
            "id": "4007073",
            "problem": "考虑带电粒子在静态、轴对称磁镜中的运动，该磁镜在中平面 $s=0$ 处的磁场最小，为 $B_{\\min}$，在 $s=\\pm L$ 处磁场最大，为 $B_{\\max}$，磁镜比 $R_m = B_{\\max}/B_{\\min}  1$。一个粒子以速度 $v$ 和投掷角 $\\alpha_0$（速度与磁场之间的夹角）在 $s=0$ 处注入，满足 $\\alpha_0  \\alpha_c$，其中 $\\alpha_c$ 是与中平面相关的损失锥角。假设在一个弹跳周期内，导心近似和第一绝热不变量（磁矩）守恒成立，且碰撞引起的弱投掷角散射可建模为 $\\alpha$ 中的一维扩散。\n\n基本原理：\n- 洛伦兹力定律决定带电粒子的运动，在强磁场和沿磁力线缓慢变化的条件下，导心动力学适用。\n- 当磁场变化和碰撞在一个弹跳时间内很弱时，第一绝热不变量（磁矩）$\\mu = m v_{\\perp}^2/(2 B)$ 是守恒的。\n- 损失锥由阈值投掷角 $\\alpha_c$ 定义，在 $s=0$ 处，如果粒子的 $\\alpha_0 \\le \\alpha_c$，它将不会被反射并逃逸到端区；$\\alpha_c$ 通过 $\\mu$ 的不变性取决于 $R_m$。\n- 弱投掷角散射被建模为 $\\alpha$ 中的扩散，扩散系数为 $D_{\\alpha}$（单位为 $\\mathrm{rad}^2/\\mathrm{s}$），这导致一个关于 $\\alpha$ 的福克-普朗克方程，在 $\\alpha = \\alpha_c$ 处有一个吸收边界。\n\n几何结构：\n- 设沿磁力线的磁场分布由 $B(s) = B_{\\min} \\left[ 1 + \\left( R_m - 1 \\right) \\left( \\frac{s}{L} \\right)^2 \\right]$ 给出，对于 $s \\in [-L, L]$，该磁场从中平面开始单调增加，并在 $s = \\pm L$ 处达到 $B_{\\max} = B_{\\min} R_m$。\n\n任务：\n1. 使用磁矩守恒和给定的 $B(s)$，推导从 $s=0$ 开始，以中平面注入投掷角 $\\alpha_0$ 注入的粒子沿磁力线的平行速度 $v_{\\parallel}(s)$ 的表达式。从第一性原理出发，得到首次磁镜反射所需时间（半弹跳时间）$T_{\\mathrm{ref}}$ 作为 $v$、$L$、$R_m$ 和 $\\alpha_0$ 的函数的表达式。\n2. 将弱投掷角扩散建模为 $\\alpha(t)$ 中的一维布朗运动，扩散系数为 $D_{\\alpha}$，在 $\\alpha = \\alpha_c$ 处有吸收边界。利用扩散的基本性质和福克-普朗克方程，确定一个从 $\\alpha_0$ 开始的粒子在时间 $t$ 时仍然存活的概率 $S(t)$。\n3. 结合以上结果，计算在逃逸前发生瞬态磁镜反射的概率，即从恰好在损失锥外的 $\\alpha_0$ 开始，粒子在首次磁镜反射时间 $T_{\\mathrm{ref}}$ 之前在 $\\alpha$ 空间中存活的概率。将概率表示为十进制浮点数。\n\n数值约束和单位：\n- 角度必须以弧度表示。\n- 磁场值必须以 $\\mathrm{T}$ (特斯拉) 为单位。\n- 速度必须以 $\\mathrm{m/s}$ 为单位。\n- 长度 $L$ 必须以 $\\mathrm{m}$ (米) 为单位。\n- 扩散系数 $D_{\\alpha}$ 必须以 $\\mathrm{rad}^2/\\mathrm{s}$ 为单位。\n- 对于每个测试用例，使用由磁矩守恒产生的物理定义，根据磁镜比 $R_m$ 计算损失锥角 $\\alpha_c$。\n- 对于弱扩散，可以假设 $D_{\\alpha}$ 足够小，使得导心近似在半个弹跳周期内仍然有效。\n\n要求的最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result_1,result_2,result_3]$）。\n- 每个结果必须是逃逸前至少发生一次瞬态反射的概率，表示为四舍五入到六位小数的十进制浮点数，无单位。\n\n测试套件：\n为以下参数集实现您的解决方案。在每个元组中，参数按 $(B_{\\min}, R_m, L, v, \\delta, D_{\\alpha})$ 的顺序排列，其中 $\\delta$ 是正偏移量，使得 $\\alpha_0 = \\alpha_c + \\delta$。\n\n- Case A (一般理想情况): $(1.5, 5.0, 1.0, 1.2\\times 10^6, 0.02, 1.0\\times 10^{-3})$\n- Case B (接近边界的投掷角和更强的扩散): $(1.5, 5.0, 1.0, 8.0\\times 10^5, 1.0\\times 10^{-4}, 5.0\\times 10^{-3})$\n- Case C (更高的磁镜比和更长的设备): $(2.0, 10.0, 1.2, 1.0\\times 10^6, 0.015, 1.0\\times 10^{-3})$\n- Case D (较慢的粒子，中等磁镜比): $(1.0, 6.0, 0.8, 2.0\\times 10^5, 0.025, 1.0\\times 10^{-3})$\n- Case E (非常弱的扩散): $(1.2, 4.0, 0.9, 1.5\\times 10^6, 0.01, 1.0\\times 10^{-5})$\n\n对于每种情况：\n- 根据 $R_m$ 计算 $\\alpha_c$ (以弧度为单位)。\n- 设置 $\\alpha_0 = \\alpha_c + \\delta$。\n- 计算 $T_{\\mathrm{ref}}$ (以秒为单位)。\n- 使用 $t = T_{\\mathrm{ref}}$ 时的存活概率，计算在逃逸前至少发生一次瞬态反射的概率。\n\n您的程序必须按照与上述测试套件案例相同的顺序，以指定的单行格式输出五个概率，四舍五入到六位小数。",
            "solution": "该问题在科学上被验证为基础扎实、设定良好且客观。它基于等离子体物理学的既定原理，特别是磁镜约束，并且没有任何可指出的缺陷。因此，我们可以着手解决。\n\n解决方案按要求分三个阶段展开：首先，推导粒子的半弹跳时间；其次，建立投掷角扩散下的存活概率公式；第三，结合这些结果计算最终概率。\n\n**第1部分：半弹跳时间，$T_{\\mathrm{ref}}$**\n\n带电粒子在静态磁场中的运动 conserving 其动能 $E = \\frac{1}{2}mv^2$，这意味着其速率 $v$ 是恒定的。在缓慢变化的磁场中，第一绝热不变量，即磁矩 $\\mu = \\frac{mv_\\perp^2}{2B}$，也是守恒的。此处，$v_\\perp$ 是垂直于磁力线的速度分量，$B$ 是磁场强度。\n\n在中平面 ($s=0$)，磁场为 $B(0) = B_{\\min}$，粒子的速度 $v$ 有一个投掷角 $\\alpha_0$。垂直速度为 $v_{\\perp,0} = v \\sin \\alpha_0$。因此，磁矩固定为 $\\mu = \\frac{m(v \\sin \\alpha_0)^2}{2B_{\\min}}$。\n\n在沿磁力线的任何其他点 $s$，$\\mu$ 的守恒意味着 $\\frac{mv_\\perp(s)^2}{2B(s)} = \\frac{m(v \\sin \\alpha_0)^2}{2B_{\\min}}$。这给出了在 $s$ 点的垂直速度：\n$$v_\\perp(s)^2 = v^2 \\sin^2 \\alpha_0 \\frac{B(s)}{B_{\\min}}$$\n根据能量守恒 $v^2 = v_\\parallel(s)^2 + v_\\perp(s)^2$，平行速度 $v_\\parallel(s)$ 为：\n$$v_\\parallel(s)^2 = v^2 - v_\\perp(s)^2 = v^2 \\left( 1 - \\frac{B(s)}{B_{\\min}} \\sin^2 \\alpha_0 \\right)$$\n如果粒子在到达最大磁场 $B_{\\max}$ 之前反射，则它被捕獲。反射发生在转折点 $s_{tp}$，此处 $v_\\parallel(s_{tp}) = 0$。这要求 $1 - \\frac{B(s_{tp})}{B_{\\min}}\\sin^2 \\alpha_0 = 0$，或 $B(s_{tp}) = B_{\\min}/\\sin^2 \\alpha_0$。为使粒子被约束，我们必须有 $B(s_{tp}) \\le B_{\\max}$，这导致条件 $\\sin^2 \\alpha_0 \\ge B_{\\min}/B_{\\max} = 1/R_m$。中平面处的临界损失锥角 $\\alpha_c$ 由此条件的边界定义：\n$$\\sin \\alpha_c = \\frac{1}{\\sqrt{R_m}} \\implies \\alpha_c = \\arcsin\\left(\\frac{1}{\\sqrt{R_m}}\\right)$$\n具有 $\\alpha_0  \\alpha_c$ 的粒子被捕获。\n\n为了找到半弹跳时间 $T_{\\mathrm{ref}}$，我们对时间微分 $dt = ds/v_\\parallel(s)$ 从中平面 ($s=0$) 到转折点 ($s_{tp}$)进行积分。我们将给定的磁场分布 $B(s) = B_{\\min} \\left[ 1 + (R_m-1)(s/L)^2 \\right]$ 代入 $v_\\parallel(s)$ 的表达式中：\n$$v_\\parallel(s) = v \\sqrt{1 - \\left(1 + (R_m-1)\\frac{s^2}{L^2}\\right) \\sin^2 \\alpha_0} = v \\sqrt{\\cos^2\\alpha_0 - (R_m-1)\\sin^2\\alpha_0 \\frac{s^2}{L^2}}$$\n$$T_{\\mathrm{ref}} = \\int_0^{s_{tp}} \\frac{ds}{v_\\parallel(s)} = \\frac{1}{v} \\int_0^{s_{tp}} \\frac{ds}{\\sqrt{\\cos^2\\alpha_0 - (R_m-1)\\sin^2\\alpha_0 \\frac{s^2}{L^2}}}$$\n转折点 $s_{tp}$ 是平方根下的项为零的地方：$s_{tp} = \\frac{L \\cos\\alpha_0}{\\sqrt{R_m-1}\\sin\\alpha_0}$。\n该积分是一个标准形式。令 $s = s_{tp} \\sin\\theta$。积分的计算结果为：\n$$T_{\\mathrm{ref}} = \\frac{L}{v \\sin\\alpha_0 \\sqrt{R_m-1}} \\int_0^{\\pi/2} d\\theta = \\frac{\\pi L}{2v \\sqrt{R_m-1} \\sin\\alpha_0}$$\n\n**第2部分：存活概率，$S(t)$**\n\n弱投掷角散射被建模为投掷角坐标 $\\alpha$ 中的一维扩散过程。概率密度 $P(\\alpha, t)$ 的演化由扩散方程描述：\n$$\\frac{\\partial P}{\\partial t} = D_\\alpha \\frac{\\partial^2 P}{\\partial \\alpha^2}$$\n其中 $D_\\alpha$ 是给定的常数扩散系数。如果粒子的投掷角散射进入损失锥，即 $\\alpha \\le \\alpha_c$，则粒子丢失。这在 $\\alpha = \\alpha_c$ 处建立了一个吸收边界。粒子从 $\\alpha_0 = \\alpha_c + \\delta$ 开始。我们可以通过移动坐标系来简化问题：令 $x = \\alpha - \\alpha_c$。粒子从 $x_0 = \\delta$ 开始，在 $x=0$ 处有一个吸收边界。$\\alpha$ 的物理域是 $[\\alpha_c, \\pi/2]$，因此 $x$ 的物理域是 $[0, \\pi/2 - \\alpha_c]$。然而，对于弱扩散，首次反射的时间 $T_{\\mathrm{ref}}$ 通常远小于粒子扩散到像 $\\pi/2$ 这样大得多的角度所需的时间。因此，我们可以将系统精确地建模为在半无限域 $x \\in [0, \\infty)$ 中的扩散，这是一个标准的教科书问题。\n\n对于初始条件 $P(x,0) = \\delta_{\\text{Dirac}}(x-x_0)$ 和吸收边界 $P(0,t)=0$ 的概率密度 $P(x,t)$ 的解，可以使用镜像法找到：\n$$P(x,t) = \\frac{1}{\\sqrt{4\\pi D_\\alpha t}} \\left( e^{-\\frac{(x-x_0)^2}{4D_\\alpha t}} - e^{-\\frac{(x+x_0)^2}{4D_\\alpha t}} \\right)$$\n存活概率 $S(t)$ 是在时间 $t$ 在允许区域内找到粒子的总概率：\n$$S(t) = \\int_0^\\infty P(x,t) dx$$\n对 $P(x,t)$ 的表达式进行积分，得到以误差函数 $\\mathrm{erf}(z)$ 表示的解：\n$$S(t) = \\mathrm{erf}\\left(\\frac{x_0}{\\sqrt{4D_\\alpha t}}\\right)$$\n\n**第3部分：最终计算**\n\n问题要求计算粒子在逃逸前经历至少一次磁镜反射的概率。这恰好是粒子在扩散散射过程中存活时间等于其到达第一个反射点所需时间 $T_{\\mathrm{ref}}$ 的概率。我们通过将 $t = T_{\\mathrm{ref}}$ 和 $x_0 = \\delta$ 代入存活概率方程来结合第1部分和第2部分的结果：\n$$P_{\\mathrm{reflect}} = S(T_{\\mathrm{ref}}) = \\mathrm{erf}\\left(\\frac{\\delta}{\\sqrt{4 D_\\alpha T_{\\mathrm{ref}}}}\\right)$$\n\n每个测试用例的算法如下：\n1.  给定 $R_m$，计算损失锥角 $\\alpha_c = \\arcsin(1/\\sqrt{R_m})$。\n2.  给定 $\\delta$，计算初始投掷角 $\\alpha_0 = \\alpha_c + \\delta$。\n3.  给定 $L$、$v$、$R_m$ 和计算出的 $\\alpha_0$，计算半弹跳时间 $T_{\\mathrm{ref}} = \\frac{\\pi L}{2v \\sqrt{R_m-1} \\sin\\alpha_0}$。\n4.  给定 $D_\\alpha$、$\\delta$ 和计算出的 $T_{\\mathrm{ref}}$，计算最终概率 $P_{\\mathrm{reflect}} = \\mathrm{erf}\\left(\\frac{\\delta}{\\sqrt{4 D_\\alpha T_{\\mathrm{ref}}}}\\right)$。\n\n此方法应用于每个测试用例以产生最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the probability of a transient mirror reflection for a charged particle\n    in a magnetic mirror, considering pitch-angle diffusion.\n    \"\"\"\n\n    # Test cases are tuples of (B_min, R_m, L, v, delta, D_alpha)\n    # B_min is not directly used in the final formulas but is part of the problem context.\n    test_cases = [\n        # Case A (general happy path)\n        (1.5, 5.0, 1.0, 1.2e6, 0.02, 1.0e-3),\n        # Case B (near-boundary pitch angle and stronger diffusion)\n        (1.5, 5.0, 1.0, 8.0e5, 1.0e-4, 5.0e-3),\n        # Case C (higher mirror ratio and longer device)\n        (2.0, 10.0, 1.2, 1.0e6, 0.015, 1.0e-3),\n        # Case D (slower particle, moderate mirror ratio)\n        (1.0, 6.0, 0.8, 2.0e5, 0.025, 1.0e-3),\n        # Case E (very weak diffusion)\n        (1.2, 4.0, 0.9, 1.5e6, 0.01, 1.0e-5),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        B_min, R_m, L, v, delta, D_alpha = case\n\n        # 1. Compute the loss-cone angle alpha_c in radians from the mirror ratio R_m.\n        # The condition for reflection is sin^2(alpha_0) = 1/R_m.\n        # The loss cone angle is the boundary of this condition.\n        alpha_c = np.arcsin(1.0 / np.sqrt(R_m))\n\n        # 2. Set the initial pitch angle alpha_0.\n        alpha_0 = alpha_c + delta\n\n        # 3. Compute the half-bounce time T_ref in seconds.\n        # This is derived from integrating ds/v_parallel for a parabolic B-field.\n        # T_ref = (pi * L) / (2 * v * sqrt(R_m - 1) * sin(alpha_0))\n        T_ref = (np.pi * L) / (2 * v * np.sqrt(R_m - 1) * np.sin(alpha_0))\n\n        # 4. Compute the survival probability at t = T_ref.\n        # This is modeled as 1D diffusion in a semi-infinite domain with an\n        # absorbing boundary. The survival probability S(t) for a particle\n        # starting at a distance 'delta' from the boundary is:\n        # S(t) = erf(delta / sqrt(4 * D_alpha * t))\n        \n        # Argument of the error function\n        denominator_squared = 4 * D_alpha * T_ref\n        \n        # Handle edge cases where denominator is zero or negative, although\n        # physically impossible with the given constraints.\n        if denominator_squared == 0:\n            # If D_alpha or T_ref is zero, there is no diffusion or time to diffuse,\n            # so survival probability is 1.\n            prob = 1.0\n        else:\n            argument = delta / np.sqrt(denominator_squared)\n            prob = erf(argument)\n        \n        results.append(prob)\n\n    # Format the results to exactly six decimal places and join into a single string.\n    formatted_results = [f'{r:.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}