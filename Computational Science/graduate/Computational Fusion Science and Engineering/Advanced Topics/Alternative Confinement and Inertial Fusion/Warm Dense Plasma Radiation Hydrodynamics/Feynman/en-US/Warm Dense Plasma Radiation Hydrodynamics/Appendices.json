{
    "hands_on_practices": [
        {
            "introduction": "Before modeling any physical system, it is crucial to understand its fundamental state. This exercise provides a foundational calculation that defines the Warm Dense Matter (WDM) regime by comparing the average distance between particles to the characteristic length scale of electrostatic screening. By computing this ratio, you will see firsthand why the simple, weakly-coupled plasma theories, such as the Debye-Hückel model, break down in WDM and why more advanced descriptions are necessary .",
            "id": "4063812",
            "problem": "A uniform, fully ionized hydrogenic warm dense plasma representative of an ablation layer in Inertial Confinement Fusion (ICF) radiation hydrodynamics is characterized by an ion number density $n_{i}$ and electron temperature $T$. The mean ionization state is $\\bar{Z}$. In the regime of interest, the validity of Debye-Hückel screening hinges on the ratio of the mean interparticle spacing to the electrostatic screening length. Using only first-principles definitions, estimate the ratio of the Wigner–Seitz mean interparticle spacing to the classical electrostatic screening length (Debye length) for the following conditions:\n- $n_{i} = 1.0 \\times 10^{29}\\ \\mathrm{m}^{-3}$,\n- $\\bar{Z} = 1.0$ (so the electron number density is $n_{e} = \\bar{Z} n_{i}$),\n- $T = 10\\ \\mathrm{eV}$.\n\nUse the standard definitions of the Wigner–Seitz radius $a$ and the classical Debye length $\\lambda_{D}$ derived from linear response of a Maxwell–Boltzmann electron population. Assume immobile ions for the electrostatic response on the screening scale. Take the following constants:\n- vacuum permittivity $\\epsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$,\n- Boltzmann constant $k_{B} = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$,\n- elementary charge $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{C}$,\n- use $\\pi = 3.141\\,592\\,653\\,589\\,793$,\n- the temperature-energy conversion $1\\ \\mathrm{eV} = e \\times 1\\ \\mathrm{V} = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{J}$.\n\nWork symbolically until the final numerical evaluation. Compute the dimensionless ratio $a/\\lambda_{D}$ and report it as a pure number. Round your final result to three significant figures.",
            "solution": "The goal is to compute the ratio $a/\\lambda_{D}$ under warm dense plasma conditions using first principles.\n\nStart from the definition of the Wigner–Seitz radius (mean interparticle spacing) for ions. The Wigner–Seitz sphere is defined so that one ion occupies a volume equal to the sphere volume:\n$$\n\\frac{4}{3}\\pi a^{3} = \\frac{1}{n_{i}} \\quad \\Longrightarrow \\quad a = \\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}.\n$$\n\nNext, derive the classical Debye length from linear response of a Maxwell–Boltzmann electron gas. Consider a small electrostatic potential perturbation $\\phi$ in a quasi-neutral plasma. The electron density responds according to the Boltzmann factor:\n$$\nn_{e}(\\phi) \\approx n_{e0} \\exp\\!\\left(\\frac{e\\phi}{k_{B}T}\\right) \\approx n_{e0}\\left(1 + \\frac{e\\phi}{k_{B}T}\\right),\n$$\nwhere the linearization assumes $|e\\phi| \\ll k_{B}T$. The charge density perturbation is $\\rho \\approx -e\\left[n_{e}(\\phi)-n_{e0}\\right] \\approx -e n_{e0}\\left(\\frac{e\\phi}{k_{B}T}\\right)$. Poisson’s equation gives\n$$\n\\nabla^{2}\\phi = -\\frac{\\rho}{\\epsilon_{0}} \\approx \\frac{e^{2} n_{e0}}{\\epsilon_{0} k_{B} T}\\,\\phi.\n$$\nIdentifying the screening length $\\lambda_{D}$ from $\\nabla^{2}\\phi - \\phi/\\lambda_{D}^{2} = 0$ yields the classical Debye length\n$$\n\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n_{e} e^{2}}}.\n$$\n\nFor a fully ionized hydrogenic plasma with mean ionization $\\bar{Z}$, the electron density is $n_{e} = \\bar{Z} n_{i}$. Therefore, the ratio of interest is\n$$\n\\frac{a}{\\lambda_{D}} = \\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}\\,\\sqrt{\\frac{n_{e} e^{2}}{\\epsilon_{0} k_{B} T}}\n= \\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}\\,\\sqrt{\\frac{\\bar{Z} n_{i} e^{2}}{\\epsilon_{0} k_{B} T}}.\n$$\n\nInsert the given parameters $n_{i} = 1.0 \\times 10^{29}\\ \\mathrm{m^{-3}}$, $\\bar{Z} = 1.0$, and $T = 10\\ \\mathrm{eV}$. First compute $a$:\n$$\na = \\left(\\frac{3}{4\\pi \\times 1.0 \\times 10^{29}}\\right)^{1/3}\\ \\mathrm{m}.\n$$\nNumerically,\n$$\n\\frac{3}{4\\pi \\times 1.0 \\times 10^{29}} = \\frac{3}{1.256637061 \\times 10^{30}} \\approx 2.387324146 \\times 10^{-30},\n$$\nso\n$$\na \\approx \\left(2.387324146 \\times 10^{-30}\\right)^{1/3}\\ \\mathrm{m} \\approx 1.336 \\times 10^{-10}\\ \\mathrm{m}.\n$$\n\nNext compute $\\lambda_{D}$ using $n_{e} = \\bar{Z} n_{i} = 1.0 \\times 10^{29}\\ \\mathrm{m^{-3}}$ and $k_{B}T = 10\\ \\mathrm{eV} = 10 \\times 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{J} = 1.602\\,176\\,634 \\times 10^{-18}\\ \\mathrm{J}$:\n$$\n\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n_{e} e^{2}}}\n= \\sqrt{\\frac{(8.854\\,187\\,8128 \\times 10^{-12})\\times(1.602\\,176\\,634 \\times 10^{-18})}{(1.0 \\times 10^{29})\\times(1.602\\,176\\,634 \\times 10^{-19})^{2}}}\\ \\mathrm{m}.\n$$\nCompute numerator and denominator separately:\n$$\n\\epsilon_{0} k_{B} T \\approx 1.419 \\times 10^{-29}\\ \\mathrm{J\\,F\\,m^{-1}},\\quad\nn_{e} e^{2} = 1.0 \\times 10^{29} \\times 2.566\\,969\\,9 \\times 10^{-38} \\approx 2.566\\,969\\,9 \\times 10^{-9}.\n$$\nThus\n$$\n\\lambda_{D} \\approx \\sqrt{\\frac{1.419 \\times 10^{-29}}{2.566\\,969\\,9 \\times 10^{-9}}}\\ \\mathrm{m}\n= \\sqrt{5.532 \\times 10^{-21}}\\ \\mathrm{m} \\approx 7.436 \\times 10^{-11}\\ \\mathrm{m}.\n$$\n\nFinally, evaluate the ratio:\n$$\n\\frac{a}{\\lambda_{D}} \\approx \\frac{1.336 \\times 10^{-10}}{7.436 \\times 10^{-11}} \\approx 1.796.\n$$\nRounded to three significant figures, the result is $1.80$.\n\nInterpretation in the context of warm dense plasma radiation hydrodynamics: The ratio $a/\\lambda_{D} \\gtrsim 1$ implies the number of electrons within a Debye sphere, $N_{D} = \\tfrac{4}{3}\\pi n_{e} \\lambda_{D}^{3}$, is of order unity, violating the weak-coupling assumption underlying Debye–Hückel theory. This indicates that in the given warm dense matter state, collective screening is not well separated from interparticle scales, necessitating beyond–Debye–Hückel models when coupling radiation transport to the plasma microphysics. However, the requested quantity is the numerical ratio computed above.",
            "answer": "$$\\boxed{1.80}$$"
        },
        {
            "introduction": "Accurate modeling of radiation transport is central to understanding energy flow in WDM. This practice explores the critical distinction between the Planck and Rosseland mean opacities, which are used to simplify frequency-dependent radiation transport into a \"gray\" approximation. You will implement the definitions of both means and quantify the significant errors in radiative flux and thermal wave speed that result from using the physically incorrect average, providing a concrete demonstration of why the Rosseland mean is essential for diffusion modeling .",
            "id": "4063844",
            "problem": "Consider a one-dimensional warm dense plasma (WDP) in the radiation diffusion regime. The radiation transport is modeled using the diffusion approximation, and frequency-dependent absorption is described by a group spectrum with piecewise-constant mass absorption opacity. Your task is to quantify the error incurred by using the Planck mean opacity instead of the Rosseland mean opacity in two physically relevant quantities: the radiative energy flux and the instantaneous Marshak front speed. Warm dense plasma refers to a regime where material is partially ionized and radiation significantly contributes to energy transport, with temperatures of order $10^{5}\\text{ K}$ to $10^{6}\\text{ K}$ and solid-like densities. The program must compute and report results for the specified test suite.\n\nFundamental bases to use:\n- The Planck spectral radiance $B_{\\nu}(T)$ for a blackbody at temperature $T$ is\n$$\nB_{\\nu}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\frac{1}{\\exp\\!\\left(\\frac{h \\nu}{k_{\\mathrm{B}} T}\\right) - 1},\n$$\nwhere $h$ is Planck's constant, $c$ is the speed of light in vacuum, $\\nu$ is the photon frequency, and $k_{\\mathrm{B}}$ is Boltzmann's constant.\n- The temperature derivative of the Planck spectral radiance is\n$$\n\\frac{\\partial B_{\\nu}}{\\partial T}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\cdot \\frac{x \\exp(x)}{T \\left(\\exp(x) - 1\\right)^{2}},\n\\quad \\text{with} \\quad x = \\frac{h \\nu}{k_{\\mathrm{B}} T}.\n$$\n- The Planck mean opacity $\\kappa_{\\mathrm{P}}(T)$ over a given frequency range with mass absorption opacity $\\kappa_{\\nu}$ is defined as\n$$\n\\kappa_{\\mathrm{P}}(T) = \\frac{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} \\kappa_{\\nu} B_{\\nu}(T)\\, d\\nu}{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} B_{\\nu}(T)\\, d\\nu}.\n$$\n- The Rosseland mean opacity $\\kappa_{\\mathrm{R}}(T)$ over the same range is defined via\n$$\n\\frac{1}{\\kappa_{\\mathrm{R}}(T)} = \\frac{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}.\n$$\n- The radiation constant $a$ is related to the Stefan–Boltzmann constant $\\sigma$ by $a = \\frac{4 \\sigma}{c}$.\n- In the radiation diffusion approximation, the radiative energy flux magnitude for a uniform temperature gradient $\\nabla T$ and mass density $\\rho$ is\n$$\nF = \\frac{4 a c T^{3}}{3 \\kappa \\rho} \\left\\lVert \\nabla T \\right\\rVert,\n$$\nwhere $\\kappa$ must be the Rosseland mean opacity $\\kappa_{\\mathrm{R}}(T)$ to be physically consistent. Using $\\kappa_{\\mathrm{P}}(T)$ in this formula introduces an error to be quantified.\n- The radiation energy diffusion coefficient for the radiation energy density $E_{\\mathrm{rad}} = a T^{4}$ is\n$$\nD = \\frac{c}{3 \\kappa \\rho}.\n$$\n- For a semi-infinite medium initially at zero radiation energy density, with a boundary held at radiation energy density $E_{s} = a T^{4}$ at position $x = 0$, the solution of the linear diffusion equation with constant $D$ is\n$$\nE(x,t) = E_{s} \\, \\mathrm{erfc}\\!\\left(\\frac{x}{2 \\sqrt{D t}}\\right),\n$$\nwhere $\\mathrm{erfc}$ is the complementary error function. Define the Marshak front position $x_{f}(t)$ implicitly by $E(x_{f},t) = \\frac{E_{s}}{2}$, which yields\n$$\nx_{f}(t) = 2 \\sqrt{D t} \\, \\mathrm{erfc}^{-1}\\!\\left(\\frac{1}{2}\\right),\n$$\nand the instantaneous front speed is\n$$\nv(t) = \\frac{d x_{f}}{d t} = \\mathrm{erfc}^{-1}\\!\\left(\\frac{1}{2}\\right) \\sqrt{\\frac{D}{t}}.\n$$\n\nComputational task:\n- For each test case, compute the Planck mean opacity $\\kappa_{\\mathrm{P}}(T)$ and the Rosseland mean opacity $\\kappa_{\\mathrm{R}}(T)$ by numerically integrating over the specified frequency groups. Each group $i$ is specified by a lower bound $\\nu_{i}^{\\mathrm{low}}$, an upper bound $\\nu_{i}^{\\mathrm{high}}$, and a constant mass absorption opacity $\\kappa_{i}$; within a group, set $\\kappa_{\\nu} = \\kappa_{i}$. The total integration bounds are $\\nu_{\\min} = \\min_{i} \\nu_{i}^{\\mathrm{low}}$ and $\\nu_{\\max} = \\max_{i} \\nu_{i}^{\\mathrm{high}}$, and the integrals are evaluated as sums of integrals over each group subinterval.\n- Using $\\kappa_{\\mathrm{R}}(T)$, compute the physically consistent radiative flux magnitude $F_{\\mathrm{R}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{R}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$. Then, compute the erroneous flux magnitude obtained by substituting $\\kappa_{\\mathrm{P}}(T)$ into the same formula, $F_{\\mathrm{P}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{P}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$.\n- Compute the radiation diffusion coefficients $D_{\\mathrm{R}} = \\frac{c}{3 \\kappa_{\\mathrm{R}} \\rho}$ and $D_{\\mathrm{P}} = \\frac{c}{3 \\kappa_{\\mathrm{P}} \\rho}$, and then compute the instantaneous Marshak front speeds $v_{\\mathrm{R}}(t)$ and $v_{\\mathrm{P}}(t)$ using the formula above, at the specified time $t$.\n- For each test case, report two decimal numbers: the relative error in flux magnitude $\\left|F_{\\mathrm{P}} - F_{\\mathrm{R}}\\right| / F_{\\mathrm{R}}$ and the relative error in instantaneous front speed $\\left|v_{\\mathrm{P}} - v_{\\mathrm{R}}\\right| / v_{\\mathrm{R}}$. These are both dimensionless and must be reported as decimal numbers without any percentage sign.\n\nPhysical units and constants:\n- Use the International System of Units (SI). Temperatures are in $\\text{K}$, frequencies in $\\text{Hz}$, opacities in $\\text{m}^{2}\\!/\\!\\text{kg}$, density in $\\text{kg}\\!/\\!\\text{m}^{3}$, spatial gradients in $\\text{K}\\!/\\!\\text{m}$, time in $\\text{s}$, flux in $\\text{W}\\!/\\!\\text{m}^{2}$, speeds in $\\text{m}\\!/\\!\\text{s}$.\n- Constants: $h = 6.62607015 \\times 10^{-34}\\, \\text{J}\\cdot\\text{s}$, $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\, \\text{J}\\!/\\!\\text{K}$, $c = 2.99792458 \\times 10^{8}\\, \\text{m}\\!/\\!\\text{s}$, $\\sigma = 5.670374419 \\times 10^{-8}\\, \\text{W}\\!/\\!\\text{m}^{2}\\!/\\!\\text{K}^{4}$, $a = \\frac{4 \\sigma}{c}$.\n\nTest suite:\n- Test case $1$ (typical warm dense plasma with frequency-dependent opacity):\n  - $T = 1.5 \\times 10^{6}\\, \\text{K}$, $\\rho = 1.0 \\times 10^{3}\\, \\text{kg}\\!/\\!\\text{m}^{3}$, $\\left\\lVert \\nabla T \\right\\rVert = 1.0 \\times 10^{6}\\, \\text{K}\\!/\\!\\text{m}$, $t = 1.0 \\times 10^{-8}\\, \\text{s}$.\n  - Groups: $\\left(1.0 \\times 10^{15},\\, 5.0 \\times 10^{15},\\, 0.5\\right)$, $\\left(5.0 \\times 10^{15},\\, 2.0 \\times 10^{16},\\, 1.0\\right)$, $\\left(2.0 \\times 10^{16},\\, 5.0 \\times 10^{16},\\, 5.0\\right)$, $\\left(5.0 \\times 10^{16},\\, 1.0 \\times 10^{17},\\, 10.0\\right)$.\n- Test case $2$ (near-constant opacity across the spectrum):\n  - $T = 1.0 \\times 10^{6}\\, \\text{K}$, $\\rho = 1.0 \\times 10^{3}\\, \\text{kg}\\!/\\!\\text{m}^{3}$, $\\left\\lVert \\nabla T \\right\\rVert = 1.0 \\times 10^{6}\\, \\text{K}\\!/\\!\\text{m}$, $t = 1.0 \\times 10^{-8}\\, \\text{s}$.\n  - Groups: $\\left(1.0 \\times 10^{15},\\, 5.0 \\times 10^{15},\\, 2.0\\right)$, $\\left(5.0 \\times 10^{15},\\, 2.0 \\times 10^{16},\\, 2.0\\right)$, $\\left(2.0 \\times 10^{16},\\, 5.0 \\times 10^{16},\\, 2.0\\right)$, $\\left(5.0 \\times 10^{16},\\, 1.0 \\times 10^{17},\\, 2.0\\right)$.\n- Test case $3$ (strongly increasing opacity with frequency and higher density):\n  - $T = 5.0 \\times 10^{5}\\, \\text{K}$, $\\rho = 3.0 \\times 10^{3}\\, \\text{kg}\\!/\\!\\text{m}^{3}$, $\\left\\lVert \\nabla T \\right\\rVert = 5.0 \\times 10^{5}\\, \\text{K}\\!/\\!\\text{m}$, $t = 5.0 \\times 10^{-9}\\, \\text{s}$.\n  - Groups: $\\left(1.0 \\times 10^{15},\\, 3.0 \\times 10^{15},\\, 0.1\\right)$, $\\left(3.0 \\times 10^{15},\\, 1.0 \\times 10^{16},\\, 0.2\\right)$, $\\left(1.0 \\times 10^{16},\\, 5.0 \\times 10^{16},\\, 2.0\\right)$, $\\left(5.0 \\times 10^{16},\\, 2.0 \\times 10^{17},\\, 20.0\\right)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases. For each test case, output first the flux relative error and then the Marshak front speed relative error. For example, the output should look like\n$$\n[\\delta F_{1}, \\delta v_{1}, \\delta F_{2}, \\delta v_{2}, \\delta F_{3}, \\delta v_{3}],\n$$\nwhere each $\\delta$ is a decimal number.",
            "solution": "The problem requires a quantitative analysis of the error introduced when the Planck mean opacity, $\\kappa_{\\mathrm{P}}$, is used in place of the physically correct Rosseland mean opacity, $\\kappa_{\\mathrm{R}}$, in formulas for radiative flux and Marshak front propagation speed. This analysis is contextualized within the radiation diffusion approximation for a one-dimensional warm dense plasma with a piecewise-constant mass absorption opacity spectrum.\n\nThe core of the problem lies in the distinct physical roles and mathematical definitions of the two mean opacities. The Planck mean opacity, $\\kappa_{\\mathrm{P}}(T)$, is an average of the frequency-dependent opacity $\\kappa_{\\nu}$ weighted by the Planck blackbody spectrum $B_{\\nu}(T)$.\n$$\n\\kappa_{\\mathrm{P}}(T) = \\frac{\\displaystyle \\int \\kappa_{\\nu} B_{\\nu}(T)\\, d\\nu}{\\displaystyle \\int B_{\\nu}(T)\\, d\\nu}\n$$\nThis average is most relevant when considering the total energy emitted by or contained within a volume of material in local thermodynamic equilibrium.\n\nConversely, the Rosseland mean opacity, $\\kappa_{\\mathrm{R}}(T)$, is a harmonic mean weighted by the temperature derivative of the Planck function, $\\frac{\\partial B_{\\nu}}{\\partial T}(T)$.\n$$\n\\frac{1}{\\kappa_{\\mathrm{R}}(T)} = \\frac{\\displaystyle \\int \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}{\\displaystyle \\int \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}\n$$\nThe weighting function $\\frac{\\partial B_{\\nu}}{\\partial T}$ emphasizes the frequencies at which a change in temperature causes the largest change in radiative intensity. The harmonic mean structure gives greater weight to frequencies where the opacity $\\kappa_{\\nu}$ is low (i.e., where the medium is transparent). This is because in a diffusive process, energy preferentially flows through these low-opacity \"windows\" in the spectrum. Consequently, $\\kappa_{\\mathrm{R}}$ is the correct mean opacity to use for modeling radiative energy transport under the diffusion approximation. It is a fundamental result of radiation transport theory that $\\kappa_{\\mathrm{R}} \\le \\kappa_{\\mathrm{P}}$, with equality holding only if $\\kappa_{\\nu}$ is independent of frequency.\n\nThe task is to compute the relative errors for two quantities: radiative flux magnitude, $F$, and instantaneous Marshak front speed, $v(t)$.\n\nFirst, consider the radiative energy flux magnitude, given by Fick's law for radiation diffusion:\n$$\nF = \\frac{c}{3 \\rho \\kappa} \\frac{d(aT^4)}{dx} = \\frac{4 a c T^3}{3 \\rho \\kappa} \\frac{dT}{dx}\n$$\nFor a uniform temperature gradient $\\left\\lVert \\nabla T \\right\\rVert$, the physically consistent flux is $F_{\\mathrm{R}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{R}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$, while the erroneous flux is $F_{\\mathrm{P}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{P}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$. The relative error is:\n$$\n\\delta F = \\frac{\\left|F_{\\mathrm{P}} - F_{\\mathrm{R}}\\right|}{F_{\\mathrm{R}}} = \\frac{\\left|\\frac{1}{\\kappa_{\\mathrm{P}}} - \\frac{1}{\\kappa_{\\mathrm{R}}}\\right|}{\\frac{1}{\\kappa_{\\mathrm{R}}} } = \\left|\\frac{\\kappa_{\\mathrm{R}}}{\\kappa_{\\mathrm{P}}} - 1\\right|\n$$\nThis derivation shows that the relative error in flux depends only on the ratio of the two mean opacities.\n\nNext, consider the instantaneous Marshak front speed. The front propagation is modeled as a diffusion process with diffusion coefficient $D = \\frac{c}{3 \\kappa \\rho}$. The front speed at time $t$ is given as $v(t) = C \\sqrt{D/t}$, where $C = \\mathrm{erfc}^{-1}(1/2)$ is a constant. The physically consistent speed is $v_{\\mathrm{R}}(t) = C \\sqrt{D_{\\mathrm{R}}/t}$ with $D_{\\mathrm{R}} = \\frac{c}{3 \\kappa_{\\mathrm{R}} \\rho}$, and the erroneous speed is $v_{\\mathrm{P}}(t) = C \\sqrt{D_{\\mathrm{P}}/t}$ with $D_{\\mathrm{P}} = \\frac{c}{3 \\kappa_{\\mathrm{P}} \\rho}$. The relative error is:\n$$\n\\delta v = \\frac{\\left|v_{\\mathrm{P}} - v_{\\mathrm{R}}\\right|}{v_{\\mathrm{R}}} = \\frac{\\left|C \\sqrt{D_{\\mathrm{P}}/t} - C \\sqrt{D_{\\mathrm{R}}/t}\\right|}{C \\sqrt{D_{\\mathrm{R}}/t}} = \\frac{\\left|\\sqrt{D_{\\mathrm{P}}} - \\sqrt{D_{\\mathrm{R}}}\\right|}{\\sqrt{D_{\\mathrm{R}}}} = \\left|\\sqrt{\\frac{D_{\\mathrm{P}}}{D_{\\mathrm{R}}}} - 1\\right|\n$$\nSubstituting the definitions for the diffusion coefficients, we find the ratio $\\frac{D_{\\mathrm{P}}}{D_{\\mathrm{R}}} = \\frac{c / (3 \\kappa_{\\mathrm{P}} \\rho)}{c / (3 \\kappa_{\\mathrm{R}} \\rho)} = \\frac{\\kappa_{\\mathrm{R}}}{\\kappa_{\\mathrm{P}}}$. Therefore, the relative error in speed is:\n$$\n\\delta v = \\left|\\sqrt{\\frac{\\kappa_{\\mathrm{R}}}{\\kappa_{\\mathrm{P}}}} - 1\\right|\n$$\nAs with the flux, the relative error in speed depends solely on the ratio $\\kappa_{\\mathrm{R}}/\\kappa_{\\mathrm{P}}$. This simplifies the computational task significantly, as we only need to compute $\\kappa_{\\mathrm{P}}(T)$ and $\\kappa_{\\mathrm{R}}(T)$ for the given temperature $T$ and opacity spectrum.\n\nThe computational procedure is as follows. For each test case, we are given a temperature $T$ and a set of frequency groups, each defined by a range $[\\nu_{i}^{\\mathrm{low}}, \\nu_{i}^{\\mathrm{high}}]$ and a constant mass absorption opacity $\\kappa_{i}$. To calculate $\\kappa_{\\mathrm{P}}$ and $\\kappa_{\\mathrm{R}}$, we must evaluate four integrals over the full frequency range $[\\nu_{\\min}, \\nu_{\\max}]$:\n1.  $I_{1} = \\int \\kappa_{\\nu} B_{\\nu}(T) d\\nu = \\sum_i \\kappa_i \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} B_{\\nu}(T) d\\nu$\n2.  $I_{2} = \\int B_{\\nu}(T) d\\nu = \\sum_i \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} B_{\\nu}(T) d\\nu$\n3.  $I_{3} = \\int \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu = \\sum_i \\frac{1}{\\kappa_i} \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu$\n4.  $I_{4} = \\int \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu = \\sum_i \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu$\n\nThe integrands $B_{\\nu}(T)$ and $\\frac{\\partial B_{\\nu}}{\\partial T}(T)$ do not have elementary anti-derivatives, so these integrals must be computed numerically. We will use a standard numerical quadrature routine for this purpose, applied to each frequency group. Once the four integral sums are computed, the mean opacities are found via:\n$$\n\\kappa_{\\mathrm{P}}(T) = \\frac{I_1}{I_2} \\quad \\text{and} \\quad \\kappa_{\\mathrm{R}}(T) = \\frac{I_4}{I_3}\n$$\nThe required relative errors $\\delta F$ and $\\delta v$ are then calculated from the ratio $\\kappa_{\\mathrm{R}} / \\kappa_{\\mathrm{P}}$.\n\nA special case arises when the opacity $\\kappa_{\\nu}$ is constant across the entire spectrum, as is approximately true in Test Case 2. If $\\kappa_{\\nu} = \\kappa_{0}$, then $\\kappa_{\\mathrm{P}} = \\frac{\\int \\kappa_0 B_{\\nu} d\\nu}{\\int B_{\\nu} d\\nu} = \\kappa_0$ and $\\frac{1}{\\kappa_{\\mathrm{R}}} = \\frac{\\int (1/\\kappa_0) (\\partial B_{\\nu}/\\partial T) d\\nu}{\\int (\\partial B_{\\nu}/\\partial T) d\\nu} = 1/\\kappa_0$, which implies $\\kappa_{\\mathrm{R}} = \\kappa_0$. In this scenario, $\\kappa_{\\mathrm{P}} = \\kappa_{\\mathrm{R}}$, the ratio is $1$, and both relative errors $\\delta F$ and $\\delta v$ are exactly $0$. This provides a valuable sanity check for the correctness of the implementation. For frequency-dependent opacity, however, we expect $\\kappa_{\\mathrm{P}} > \\kappa_{\\mathrm{R}}$, leading to non-zero errors.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Solves the warm dense plasma opacity problem for the given test suite.\n    \"\"\"\n\n    # Physical constants from problem statement and SciPy library\n    h = constants.h  # 6.62607015e-34 J*s\n    k_B = constants.k  # 1.380649e-23 J/K\n    c = constants.c  # 2.99792458e8 m/s\n    sigma = constants.sigma # 5.670374419e-8 W/(m^2 K^4)\n    a = 4 * sigma / c\n\n    # Define test cases\n    # Format: (T, rho, grad_T, t, groups)\n    # groups format: list of (nu_low, nu_high, kappa_i)\n    test_cases = [\n        (1.5e6, 1.0e3, 1.0e6, 1.0e-8, [\n            (1.0e15, 5.0e15, 0.5), (5.0e15, 2.0e16, 1.0),\n            (2.0e16, 5.0e16, 5.0), (5.0e16, 1.0e17, 10.0)\n        ]),\n        (1.0e6, 1.0e3, 1.0e6, 1.0e-8, [\n            (1.0e15, 5.0e15, 2.0), (5.0e15, 2.0e16, 2.0),\n            (2.0e16, 5.0e16, 2.0), (5.0e16, 1.0e17, 2.0)\n        ]),\n        (5.0e5, 3.0e3, 5.0e5, 5.0e-9, [\n            (1.0e15, 3.0e15, 0.1), (3.0e15, 1.0e16, 0.2),\n            (1.0e16, 5.0e16, 2.0), (5.0e16, 2.0e17, 20.0)\n        ]),\n    ]\n\n    def B_nu(nu, T):\n        \"\"\"\n        Planck spectral radiance B_nu(T).\n        nu: frequency in Hz\n        T: temperature in K\n        \"\"\"\n        x = h * nu / (k_B * T)\n        # Avoid overflow for large x, where exp(x) is huge and B_nu -> 0.\n        if x > 700:  # np.exp(709) is near float limit\n            return 0.0\n        \n        factor = 2 * h * nu**3 / c**2\n        return factor / (np.exp(x) - 1)\n\n    def dB_nu_dT(nu, T):\n        \"\"\"\n        Temperature derivative of Planck spectral radiance, d(B_nu)/dT.\n        nu: frequency in Hz\n        T: temperature in K\n        \"\"\"\n        x = h * nu / (k_B * T)\n        # Avoid overflow\n        if x > 700:\n            return 0.0\n\n        exp_x = np.exp(x)\n        factor = (2 * h**2 * nu**4) / (c**2 * k_B * T**2)\n        denominator = (exp_x - 1)**2\n        # Avoid division by zero if exp_x is too big\n        if denominator == 0 or np.isinf(denominator):\n             return 0.0\n        return factor * exp_x / denominator\n\n    def compute_opacities(T, groups):\n        \"\"\"\n        Computes Planck and Rosseland mean opacities for a given T and group structure.\n        Returns (kappa_P, kappa_R).\n        \"\"\"\n        # Numerators and Denominators for kappa_P and kappa_R calculations\n        # kappa_P = integral(kappa*B) / integral(B)\n        # 1/kappa_R = integral(1/kappa * dB/dT) / integral(dB/dT)\n        \n        integral_kappa_B_nu = 0.0\n        integral_B_nu = 0.0\n        integral_inv_kappa_dB_dT = 0.0\n        integral_dB_dT = 0.0\n\n        for group in groups:\n            nu_low, nu_high, kappa_i = group\n            \n            # Integrals for Planck mean\n            res_B_nu, _ = integrate.quad(lambda nu: B_nu(nu, T), nu_low, nu_high)\n            integral_B_nu += res_B_nu\n            integral_kappa_B_nu += kappa_i * res_B_nu\n            \n            # Integrals for Rosseland mean\n            res_dB_dT, _ = integrate.quad(lambda nu: dB_nu_dT(nu, T), nu_low, nu_high)\n            integral_dB_dT += res_dB_dT\n            # The case kappa_i = 0 is not present in test data but handled for robustness\n            if kappa_i > 0:\n                integral_inv_kappa_dB_dT += (1.0 / kappa_i) * res_dB_dT\n\n        # Calculate mean opacities\n        kappa_P = integral_kappa_B_nu / integral_B_nu if integral_B_nu != 0 else 0\n        kappa_R = integral_dB_dT / integral_inv_kappa_dB_dT if integral_inv_kappa_dB_dT != 0 else float('inf')\n\n        return kappa_P, kappa_R\n\n    results = []\n    for case in test_cases:\n        T, rho, grad_T, t, groups = case\n        \n        kappa_P, kappa_R = compute_opacities(T, groups)\n\n        # Handle the case of zero opacity which can lead to division by zero\n        if kappa_P == 0.0:\n             # This physical situation would mean infinite flux/speed,\n             # but we can't form a ratio. This won't happen with the test data.\n             # If kappa_R is also 0, error is 0. Otherwise, error is infinite.\n             err_F = 0.0 if kappa_R == 0 else float('inf')\n             err_v = 0.0 if kappa_R == 0 else float('inf')\n        else:\n            kappa_ratio = kappa_R / kappa_P\n            \n            # Relative error in flux\n            # err_F = | F_P/F_R - 1 | = | (1/kappa_P) / (1/kappa_R) -1 | = | kappa_R/kappa_P - 1 |\n            err_F = abs(kappa_ratio - 1)\n            \n            # Relative error in speed\n            # err_v = | v_P/v_R - 1| = | sqrt(D_P/D_R) - 1 | = | sqrt(kappa_R/kappa_P) - 1|\n            err_v = abs(np.sqrt(kappa_ratio) - 1)\n        \n        results.append(f\"{err_F:.6f}\")\n        results.append(f\"{err_v:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Numerical simulations of WDM must overcome the challenge of \"stiffness,\" where physical processes like collisional energy exchange occur on timescales much shorter than the hydrodynamic timescale. This exercise guides you through the derivation and implementation of a semi-implicit numerical scheme for handling the stiff energy coupling between electrons and ions. By proving the scheme's conservation, positivity, and unconditional stability, you will gain hands-on experience with a powerful technique for developing robust algorithms capable of handling multi-scale physics .",
            "id": "4063837",
            "problem": "Consider a two-temperature warm dense matter (WDM) model in radiation hydrodynamics where electrons and ions exchange energy through binary collisions. Let $E_e(t)$ and $E_i(t)$ denote the electron and ion internal energies, respectively, and let $C_e>0$ and $C_i>0$ be the corresponding constant volumetric heat capacities evaluated at the previous time level. The collisional energy exchange is modeled by the source term $Q_{ei}=\\Gamma\\left(T_e-T_i\\right)$, where $\\Gamma\\ge 0$ is a given coupling coefficient, $T_e=E_e/C_e$, and $T_i=E_i/C_i$. The continuous subproblem for the exchange-only step is\n$$\n\\frac{dE_e}{dt}=-Q_{ei},\\quad \\frac{dE_i}{dt}=+Q_{ei},\n$$\nwhich strictly conserves the total energy $E_{\\text{tot}}(t)=E_e(t)+E_i(t)$ and drives the temperature difference $T_e-T_i$ to zero.\n\nYour task is to derive and implement a semi-implicit time update from time level $n$ to $n+1$ that treats $Q_{ei}$ implicitly while freezing $C_e$ and $C_i$ at their values from time level $n$. Using a time step $\\Delta t\\ge 0$, the semi-implicit update is defined by\n$$\nE_e^{n+1}=E_e^n-\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right),\\quad\nE_i^{n+1}=E_i^n+\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right).\n$$\nStarting from the fundamental exchange model and the definitions of temperature and heat capacity, you must:\n- Derive a closed-form expression for $E_e^{n+1}$ and $E_i^{n+1}$ in terms of $E_e^n$, $E_i^n$, $C_e$, $C_i$, $\\Gamma$, and $\\Delta t$.\n- Demonstrate that the discrete update conserves $E_{\\text{tot}}^{n+1}=E_e^{n+1}+E_i^{n+1}=E_e^n+E_i^n$ for any $\\Delta t\\ge 0$.\n- Establish positivity preservation: if $E_e^n\\ge 0$ and $E_i^n\\ge 0$, then $E_e^{n+1}\\ge 0$ and $E_i^{n+1}\\ge 0$ for any $\\Delta t\\ge 0$, provided $C_e>0$, $C_i>0$, and $\\Gamma\\ge 0$.\n- Prove unconditional stability in the sense of contractivity of the temperature difference by deriving the amplification factor $g$ for $\\Delta T^{n}=T_e^n-T_i^n$ such that\n$$\n\\Delta T^{n+1}=g\\,\\Delta T^n,\n$$\nand show that $0\\le g\\le 1$ under the timestep constraint implied purely by energy conservation and positivity (namely $\\Delta t\\ge 0$, $C_e>0$, $C_i>0$, and $\\Gamma\\ge 0$).\n\nImplement your derived update in a program that evaluates the scheme on the following test suite. All quantities must be treated in the specified units: energies $E$ in joules ($\\mathrm{J}$), heat capacities $C$ in joule per kelvin ($\\mathrm{J}/\\mathrm{K}$), time step $\\Delta t$ in seconds ($\\mathrm{s}$), and coupling coefficient $\\Gamma$ in joule per second per kelvin ($\\mathrm{J}/(\\mathrm{s}\\cdot\\mathrm{K})$). Angles do not appear, so no angle unit is required.\n\nTest suite (each case is $(C_e,C_i,\\Gamma,\\Delta t,E_e^n,E_i^n)$):\n- Case $1$ (happy path): $(2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-9},\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-4})$.\n- Case $2$ (stiff coupling, large timestep): $(2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{5},\\,1.0\\times 10^{-3},\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-4})$.\n- Case $3$ (boundary $\\Delta t=0$): $(2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{3},\\,0.0,\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-4})$.\n- Case $4$ (strong heat capacity asymmetry): $(2.0\\times 10^{-9},\\,3.0\\times 10^{-6},\\,1.0,\\,1.0\\times 10^{-6},\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-1})$.\n- Case $5$ (zero initial temperature difference): $(5.0\\times 10^{-9},\\,5.0\\times 10^{-9},\\,1.0\\times 10^{2},\\,1.0\\times 10^{-6},\\,2.5\\times 10^{-4},\\,2.5\\times 10^{-4})$.\n\nFor each case, compute:\n- A boolean indicating discrete conservation of total energy within an absolute tolerance of $10^{-12}$ times $\\max(1,|E_e^n+E_i^n|)$.\n- A boolean indicating positivity of $E_e^{n+1}$ and $E_i^{n+1}$ with a tolerance of $10^{-18}$ (i.e., values greater than or equal to $-10^{-18}$ are acceptable due to roundoff).\n- A boolean indicating unconditional stability by checking both $0\\le g\\le 1$ and that the numerically measured amplification $g_{\\text{num}}=\\Delta T^{n+1}/\\Delta T^{n}$ (defined as $g_{\\text{num}}=1$ if $\\Delta T^n=0$) agrees with the analytically derived $g$ within an absolute tolerance of $10^{-12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$), where the list concatenates, for each case in order, the three booleans in the order described above.",
            "solution": "The starting point is the collisional energy exchange model\n$$\n\\frac{dE_e}{dt}=-Q_{ei},\\quad \\frac{dE_i}{dt}=+Q_{ei},\\quad Q_{ei}=\\Gamma\\left(T_e-T_i\\right),\\quad T_e=\\frac{E_e}{C_e},\\quad T_i=\\frac{E_i}{C_i},\n$$\nwith $C_e>0$, $C_i>0$, and $\\Gamma\\ge 0$. This model is a subset of the full warm dense matter (WDM) radiation hydrodynamics equations that isolates the electron-ion energy coupling substep, assuming the heat capacities are frozen at the previous time level, a standard semi-implicit practice that avoids nonlinear solves when $C_e$ and $C_i$ depend on temperature.\n\nTo advance from time level $n$ to $n+1$ with time step $\\Delta t\\ge 0$, we treat $Q_{ei}$ implicitly while freezing $C_e$ and $C_i$ at their known values. The semi-implicit discrete equations are\n$$\nE_e^{n+1}=E_e^n-\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right),\\quad\nE_i^{n+1}=E_i^n+\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right).\n$$\nDefine the nonnegative parameters\n$$\na=\\frac{\\Delta t\\,\\Gamma}{C_e}\\ge 0,\\quad b=\\frac{\\Delta t\\,\\Gamma}{C_i}\\ge 0.\n$$\nRewriting the discrete system yields a linear $2\\times 2$ system for $\\left(E_e^{n+1},E_i^{n+1}\\right)$:\n$$\n(1+a)E_e^{n+1}-b\\,E_i^{n+1}=E_e^n,\\quad -a\\,E_e^{n+1}+(1+b)E_i^{n+1}=E_i^n.\n$$\nIn matrix form, this is\n$$\n\\begin{pmatrix}\n1+a & -b\\\\\n-a & 1+b\n\\end{pmatrix}\n\\begin{pmatrix}\nE_e^{n+1}\\\\\nE_i^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nE_e^n\\\\\nE_i^n\n\\end{pmatrix}.\n$$\nThe determinant of the coefficient matrix is\n$$\nD=(1+a)(1+b)-ab=1+a+b>0,\n$$\nwhich guarantees a unique solution for all $\\Delta t\\ge 0$, $C_e>0$, $C_i>0$, and $\\Gamma\\ge 0$. The inverse matrix is\n$$\n\\frac{1}{D}\n\\begin{pmatrix}\n1+b & b\\\\\na & 1+a\n\\end{pmatrix},\n$$\nso the closed-form update is\n$$\nE_e^{n+1}=\\frac{(1+b)E_e^n+b\\,E_i^n}{1+a+b},\\quad\nE_i^{n+1}=\\frac{a\\,E_e^n+(1+a)E_i^n}{1+a+b}.\n$$\n\nDiscrete conservation follows directly by summing the two updates:\n$$\nE_e^{n+1}+E_i^{n+1}=\\frac{(1+b)E_e^n+b\\,E_i^n+a\\,E_e^n+(1+a)E_i^n}{1+a+b}\n=\\frac{(1+a+b)\\left(E_e^n+E_i^n\\right)}{1+a+b}=E_e^n+E_i^n.\n$$\nTherefore, the method exactly conserves total energy for any $\\Delta t\\ge 0$.\n\nPositivity preservation is obtained by inspecting the update coefficients. If $E_e^n\\ge 0$ and $E_i^n\\ge 0$, then\n$$\nE_e^{n+1}=\\frac{(1+b)E_e^n+b\\,E_i^n}{1+a+b}\\ge 0,\\quad\nE_i^{n+1}=\\frac{a\\,E_e^n+(1+a)E_i^n}{1+a+b}\\ge 0,\n$$\nsince the numerator coefficients $(1+b)$, $b$, $a$, and $(1+a)$ are all nonnegative and the denominator $1+a+b$ is positive. No restriction beyond $\\Delta t\\ge 0$, $C_e>0$, $C_i>0$, and $\\Gamma\\ge 0$ is required.\n\nUnconditional stability in the sense of contractivity of the temperature difference is revealed by considering the discrete evolution of $\\Delta T^n=T_e^n-T_i^n=E_e^n/C_e-E_i^n/C_i$. A more direct and clean derivation uses the continuous model for temperatures. From\n$$\n\\frac{dT_e}{dt}=-\\frac{\\Gamma}{C_e}\\left(T_e-T_i\\right),\\quad \\frac{dT_i}{dt}=\\frac{\\Gamma}{C_i}\\left(T_e-T_i\\right),\n$$\none obtains\n$$\n\\frac{d}{dt}\\left(T_e-T_i\\right)=-\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\left(T_e-T_i\\right).\n$$\nThe corresponding backward Euler step for $\\Delta T$ induced by our semi-implicit energy update is\n$$\n\\Delta T^{n+1}=\\Delta T^n-\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\Delta T^{n+1},\n$$\nwhich solves to\n$$\n\\Delta T^{n+1}=\\frac{\\Delta T^n}{1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)}.\n$$\nTherefore, the amplification factor is\n$$\ng=\\frac{1}{1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)}.\n$$\nBecause $\\Delta t\\ge 0$, $\\Gamma\\ge 0$, $C_e>0$, and $C_i>0$, it follows that $1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\ge 1$, hence $0\\le g\\le 1$. This contractivity is unconditional with respect to the stiffness of $Q_{ei}$ and the magnitude of $\\Delta t$; no additional timestep restriction is necessary beyond the physical positivity conditions. In particular, $g\\to 0$ as $\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\to\\infty$, reflecting rapid equilibration, and $g=1$ when $\\Delta t=0$, as expected.\n\nAlgorithmically, the implementation proceeds as follows for each test case:\n- Compute $a=\\Delta t\\,\\Gamma/C_e$, $b=\\Delta t\\,\\Gamma/C_i$, and $D=1+a+b$.\n- Update the energies using $E_e^{n+1}=\\left((1+b)E_e^n+b\\,E_i^n\\right)/D$ and $E_i^{n+1}=\\left(a\\,E_e^n+(1+a)E_i^n\\right)/D$.\n- Verify discrete conservation: check $\\left|E_e^{n+1}+E_i^{n+1}-(E_e^n+E_i^n)\\right|\\le 10^{-12}\\max\\left(1,\\left|E_e^n+E_i^n\\right|\\right)$.\n- Verify positivity: check $E_e^{n+1}\\ge -10^{-18}$ and $E_i^{n+1}\\ge -10^{-18}$.\n- Compute the analytical amplification $g=\\left(1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\right)^{-1}$ and the numerical amplification $g_{\\text{num}}=\\Delta T^{n+1}/\\Delta T^{n}$, defined as $g_{\\text{num}}=1$ if $\\Delta T^n=0$. Verify unconditional stability by checking $0\\le g\\le 1$ and $\\left|g_{\\text{num}}-g\\right|\\le 10^{-12}$.\n\nThe program outputs, for each test case, three booleans corresponding to conservation, positivity, and stability checks, aggregated into a single bracketed, comma-separated list as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef semi_implicit_update(Ee, Ei, Ce, Ci, Gamma, dt):\n    \"\"\"\n    Semi-implicit update for electron and ion energies with stiff collisional exchange.\n    Ce, Ci: heat capacities (J/K)\n    Gamma: coupling coefficient (J/(s*K))\n    dt: timestep (s)\n    Returns Ee_next, Ei_next\n    \"\"\"\n    a = dt * Gamma / Ce  # nonnegative if dt>=0, Gamma>=0, Ce>0\n    b = dt * Gamma / Ci  # nonnegative if dt>=0, Gamma>=0, Ci>0\n    D = 1.0 + a + b      # strictly positive\n    Ee_next = ((1.0 + b) * Ee + b * Ei) / D\n    Ei_next = (a * Ee + (1.0 + a) * Ei) / D\n    return Ee_next, Ei_next\n\ndef amplification_factors(Ee, Ei, Ce, Ci, Ee_next, Ei_next, Gamma, dt):\n    \"\"\"\n    Compute analytical and numerical amplification factors for Delta T.\n    \"\"\"\n    # Temperatures\n    Te = Ee / Ce\n    Ti = Ei / Ci\n    Te_next = Ee_next / Ce\n    Ti_next = Ei_next / Ci\n    dT_n = Te - Ti\n    dT_np1 = Te_next - Ti_next\n\n    # Analytical amplification factor\n    g_analytical = 1.0 / (1.0 + dt * Gamma * (1.0 / Ce + 1.0 / Ci))\n\n    # Numerical amplification factor; define as 1 when initial difference is zero\n    if np.isclose(dT_n, 0.0, atol=1e-30, rtol=0.0):\n        g_numeric = 1.0 if np.isclose(dT_np1, 0.0, atol=1e-30, rtol=0.0) else np.nan\n    else:\n        g_numeric = dT_np1 / dT_n\n\n    return g_analytical, g_numeric\n\ndef check_case(case):\n    Ce, Ci, Gamma, dt, Ee_n, Ei_n = case\n    Ee_np1, Ei_np1 = semi_implicit_update(Ee_n, Ei_n, Ce, Ci, Gamma, dt)\n\n    # Conservation check\n    Etot_n = Ee_n + Ei_n\n    Etot_np1 = Ee_np1 + Ei_np1\n    tol_cons = 1e-12 * max(1.0, abs(Etot_n))\n    conserved = abs(Etot_np1 - Etot_n) <= tol_cons\n\n    # Positivity check (allow tiny negativity due to roundoff)\n    tol_pos = 1e-18\n    positive = (Ee_np1 >= -tol_pos) and (Ei_np1 >= -tol_pos)\n\n    # Stability check: 0 <= g <= 1 and numeric amplification agrees with analytical\n    g_analytical, g_numeric = amplification_factors(Ee_n, Ei_n, Ce, Ci, Ee_np1, Ei_np1, Gamma, dt)\n    g_bounds_ok = (g_analytical >= -1e-18) and (g_analytical <= 1.0 + 1e-18)\n    # Agreement check; if numeric is nan due to zero division with nonzero next, mark as False\n    if np.isnan(g_numeric):\n        g_agree = False\n    else:\n        g_agree = abs(g_numeric - g_analytical) <= 1e-12\n    stable = g_bounds_ok and g_agree\n\n    return conserved, positive, stable\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        (2.0e-9, 3.0e-9, 1.0e-3, 1.0e-9, 2.0e-4, 1.0e-4),\n        # Case 2 (stiff coupling, large timestep)\n        (2.0e-9, 3.0e-9, 1.0e5, 1.0e-3, 2.0e-4, 1.0e-4),\n        # Case 3 (boundary dt=0)\n        (2.0e-9, 3.0e-9, 1.0e3, 0.0, 2.0e-4, 1.0e-4),\n        # Case 4 (strong heat capacity asymmetry)\n        (2.0e-9, 3.0e-6, 1.0, 1.0e-6, 2.0e-4, 1.0e-1),\n        # Case 5 (zero initial temperature difference)\n        (5.0e-9, 5.0e-9, 1.0e2, 1.0e-6, 2.5e-4, 2.5e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        conserved, positive, stable = check_case(case)\n        results.extend([conserved, positive, stable])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}