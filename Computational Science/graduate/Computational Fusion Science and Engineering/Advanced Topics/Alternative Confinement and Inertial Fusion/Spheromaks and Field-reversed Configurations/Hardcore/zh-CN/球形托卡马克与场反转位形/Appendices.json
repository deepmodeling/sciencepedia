{
    "hands_on_practices": [
        {
            "introduction": "像球马克（spheromak）和场反位形（FRC）这类轴对称磁约束装置的内部结构由Grad-Shafranov（GS）方程所描述。本实践将通过有限差分法，带你亲手数值求解这个关键的椭圆型偏微分方程。掌握这项技术是为这些聚变概念建立预测性模型的第一步。",
            "id": "4046757",
            "problem": "考虑在柱坐标系中的轴对称磁流体动力学（MHD）平衡，其径向坐标为 $R$，轴向坐标为 $z$。设极向磁通函数为 $\\psi(R,z)$，压力为 $p(\\psi) = p_0 \\left(1 - \\psi / \\psi_a\\right)$，环向场函数为 $F(\\psi) = \\gamma \\psi$，其中 $p_0$ 是一个单位为帕斯卡（$\\mathrm{Pa}$）的正值常数，$\\psi_a$ 是一个单位为韦伯（$\\mathrm{Wb}$）的正值常数，$\\gamma$ 是一个单位为 $\\mathrm{m}^{-1}$ 的正值常数。磁静态平衡由 Grad–Shafranov 方程决定，\n$$\n\\Delta^* \\psi = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi},\n$$\n其中 $\\mu_0$ 是自由空间磁导率，其值为 $\\mu_0 = 4 \\pi \\times 10^{-7} \\ \\mathrm{H/m}$，椭圆算子为\n$$\n\\Delta^* \\psi = R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2}.\n$$\n从这些定义和定律出发，推导适用于 $(R,z)$ 矩形网格的守恒形式的椭圆算子，并计算在间距为 $\\Delta R$ 和 $\\Delta z$ 的均匀网格上五点差分格式的相应有限差分系数。在矩形计算域的所有边界上使用齐次狄利克雷边界条件 $\\psi = 0$。您的推导应从 Grad–Shafranov 方程开始，并明确表达所有数学步骤。\n\n基于有限差分法（FDM）构建一个数值方案，以求解在矩形域 $R \\in [R_{\\min}, R_{\\max}]$ 和 $z \\in [-Z_{\\max}, Z_{\\max}]$ 内的 $\\psi(R,z)$。使用 $N_R$ 个均匀分布的径向点和 $N_z$ 个均匀分布的轴向点（包括边界）进行离散化。仅针对内部未知数构建所得的稀疏线性系统，并使用直接稀疏求解器求解。必须推导并一致地离散化右侧源项。仅使用物理上合理的参数，并确保您的实现是自包含且数值稳定的。\n\n将该方案实现为一个完整的、可运行的程序。为进行验证，请对每个测试案例计算：\n- 在最接近几何中心 $(R_c, z_c)$ 的网格点处 $\\psi$ 的数值，其中 $R_c = (R_{\\min} + R_{\\max})/2$ 且 $z_c = 0$。将此值以韦伯（$\\mathrm{Wb}$）为单位表示，并四舍五入至六位小数。\n- 归一化残差，定义为 $\\lVert A \\psi - b \\rVert_2 / \\max\\{\\lVert b \\rVert_2, \\epsilon\\}$，其中 $\\epsilon = 10^{-16}$，四舍五入至六位小数。将残差视为无量纲。\n\n测试套件：\n- 案例1（类球马克）：$R_{\\min} = 0.2 \\ \\mathrm{m}$，$R_{\\max} = 0.8 \\ \\mathrm{m}$，$Z_{\\max} = 0.4 \\ \\mathrm{m}$，$N_R = 81$，$N_z = 81$，$p_0 = 2000 \\ \\mathrm{Pa}$，$\\psi_a = 0.5 \\ \\mathrm{Wb}$，$\\gamma = 3 \\ \\mathrm{m}^{-1}$。\n- 案例2（环向场函数消失的边缘情况）：$R_{\\min} = 0.05 \\ \\mathrm{m}$，$R_{\\max} = 0.35 \\ \\mathrm{m}$，$Z_{\\max} = 0.2 \\ \\mathrm{m}$，$N_R = 61$，$N_z = 61$，$p_0 = 1500 \\ \\mathrm{Pa}$，$\\psi_a = 0.3 \\ \\mathrm{Wb}$，$\\gamma = 0 \\ \\mathrm{m}^{-1}$。\n- 案例3（强 $F(\\psi)$ 的近真空情况）：$R_{\\min} = 0.2 \\ \\mathrm{m}$，$R_{\\max} = 1.0 \\ \\mathrm{m}$，$Z_{\\max} = 0.6 \\ \\mathrm{m}$，$N_R = 71$，$N_z = 91$，$p_0 = 1 \\ \\mathrm{Pa}$，$\\psi_a = 1.0 \\ \\mathrm{Wb}$，$\\gamma = 8 \\ \\mathrm{m}^{-1}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：$[\\psi_{c,1}, r_1, \\psi_{c,2}, r_2, \\psi_{c,3}, r_3]$，其中 $\\psi_{c,i}$ 是案例 $i$ 中 $\\psi$ 的中心值（单位为 $\\mathrm{Wb}$），四舍五入至六位小数，而 $r_i$ 是案例 $i$ 的归一化残差，四舍五入至六位小数。",
            "solution": "该问题是有效的，因为它在科学上基于磁流体动力学，在数学上是一个具有指定边界条件的良定线性椭圆偏微分方程，并为数值求解提供了一套完整且一致的参数。该任务具有挑战性且可验证。\n\n分析始于给定的 Grad–Shafranov 方程\n$$\n\\Delta^* \\psi = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi}\n$$\n其中椭圆算子为\n$$\n\\Delta^* \\psi = R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2}\n$$\n压力 $p(\\psi)$ 和环向场函数 $F(\\psi)$ 由下式给出\n$$\np(\\psi) = p_0 \\left(1 - \\frac{\\psi}{\\psi_a}\\right) \\quad \\text{和} \\quad F(\\psi) = \\gamma \\psi\n$$\n首先，我们计算 Grad–Shafranov 方程右侧（RHS）源项所需的导数。\n$$\n\\frac{dp}{d\\psi} = \\frac{d}{d\\psi} \\left[ p_0 \\left(1 - \\frac{\\psi}{\\psi_a}\\right) \\right] = -\\frac{p_0}{\\psi_a}\n$$\n$$\n\\frac{dF}{d\\psi} = \\frac{d}{d\\psi} (\\gamma \\psi) = \\gamma\n$$\n将这些表达式代入 RHS 得到\n$$\n- \\mu_0 R^2 \\left(-\\frac{p_0}{\\psi_a}\\right) - (\\gamma \\psi)(\\gamma) = \\frac{\\mu_0 p_0}{\\psi_a} R^2 - \\gamma^2 \\psi\n$$\n因此，Grad–Shafranov 方程是关于 $\\psi(R,z)$ 的一个线性、非齐次、二阶偏微分方程。我们可以将其重排为亥姆霍兹型方程的形式：\n$$\n\\Delta^* \\psi + \\gamma^2 \\psi = \\frac{\\mu_0 p_0}{\\psi_a} R^2\n$$\n或者，展开算子，\n$$\nR \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2} + \\gamma^2 \\psi = \\frac{\\mu_0 p_0}{\\psi_a} R^2\n$$\n我们在矩形域 $R \\in [R_{\\min}, R_{\\max}]$ 和 $z \\in [-Z_{\\max}, Z_{\\max}]$ 上求解此方程，所有边界均采用齐次狄利克雷边界条件 $\\psi=0$。\n\n为了数值求解，我们在均匀的笛卡尔网格上采用有限差分法（FDM）。该域在径向使用 $N_R$ 个点，在轴向使用 $N_z$ 个点进行离散化。网格点为 $(R_i, z_j)$，其中\n$$\nR_i = R_{\\min} + i \\Delta R, \\quad i \\in \\{0, 1, \\dots, N_R-1\\}\n$$\n$$\nz_j = -Z_{\\max} + j \\Delta z, \\quad j \\in \\{0, 1, \\dots, N_z-1\\}\n$$\n均匀网格间距为\n$$\n\\Delta R = \\frac{R_{\\max} - R_{\\min}}{N_R-1}, \\quad \\Delta z = \\frac{2 Z_{\\max}}{N_z-1}\n$$\n令 $\\psi_{i,j}$ 表示 $\\psi(R_i, z_j)$ 的数值近似。我们使用二阶中心差分来近似内部网格点 $(i,j)$ 处的偏导数，其中 $1 \\le i \\le N_R-2$ 且 $1 \\le j \\le N_z-2$。\n\n轴向二阶导数近似为：\n$$\n\\frac{\\partial^2 \\psi}{\\partial z^2} \\bigg|_{(i,j)} \\approx \\frac{\\psi_{i, j+1} - 2\\psi_{i,j} + \\psi_{i, j-1}}{(\\Delta z)^2}\n$$\n对于 $\\Delta^*$ 算子的径向部分，我们通过在交错网格上计算一阶导数来使用守恒有限差分格式。设 $u(R, z) = \\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}$。算子项为 $R \\frac{\\partial u}{\\partial R}$。我们将其离散化为：\n$$\nR \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) \\bigg|_{(i,j)} \\approx R_i \\frac{u_{i+1/2, j} - u_{i-1/2, j}}{\\Delta R}\n$$\n其中 $u$ 在单元面（半整数索引）上求值：\n$$\nu_{i+1/2, j} \\approx \\frac{1}{R_{i+1/2}} \\left(\\frac{\\partial \\psi}{\\partial R}\\right)_{i+1/2, j} \\approx \\frac{1}{R_i + \\frac{\\Delta R}{2}} \\left( \\frac{\\psi_{i+1,j} - \\psi_{i,j}}{\\Delta R} \\right)\n$$\n$$\nu_{i-1/2, j} \\approx \\frac{1}{R_{i-1/2}} \\left(\\frac{\\partial \\psi}{\\partial R}\\right)_{i-1/2, j} \\approx \\frac{1}{R_i - \\frac{\\Delta R}{2}} \\left( \\frac{\\psi_{i,j} - \\psi_{i-1,j}}{\\Delta R} \\right)\n$$\n将这些代回，在 $(i,j)$ 处的径向算子变为：\n$$\n\\frac{R_i}{(\\Delta R)^2} \\left[ \\frac{1}{R_{i+1/2}}(\\psi_{i+1,j} - \\psi_{i,j}) - \\frac{1}{R_{i-1/2}}(\\psi_{i,j} - \\psi_{i-1,j}) \\right]\n$$\n这可以展开为五点差分格式形式，将 $\\psi_{i,j}$ 与其邻点 $\\psi_{i\\pm1, j}$ 和 $\\psi_{i, j\\pm1}$ 联系起来。在点 $(i,j)$ 处组合离散化偏微分方程的所有项：\n$$\n\\frac{R_i}{R_{i-1/2}(\\Delta R)^2} \\psi_{i-1,j} + \\frac{R_i}{R_{i+1/2}(\\Delta R)^2} \\psi_{i+1,j} + \\frac{1}{(\\Delta z)^2} \\psi_{i,j-1} + \\frac{1}{(\\Delta z)^2} \\psi_{i,j+1} \\\\\n- \\left[ \\frac{R_i}{(\\Delta R)^2}\\left(\\frac{1}{R_{i+1/2}} + \\frac{1}{R_{i-1/2}}\\right) + \\frac{2}{(\\Delta z)^2} - \\gamma^2 \\right] \\psi_{i,j} = \\frac{\\mu_0 p_0}{\\psi_a} R_i^2\n$$\n该方程对每个内部点 $i \\in \\{1, \\dots, N_R-2\\}$, $j \\in \\{1, \\dots, N_z-2\\}$ 都成立。这组方程构成一个大型稀疏线性系统，形式为 $A \\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x}$ 是所有 $(N_R-2) \\times (N_z-2)$ 个内部网格点上未知 $\\psi_{i,j}$ 值的向量。矩阵 $A$ 包含有限差分系数，向量 $\\mathbf{b}$ 包含源项。\n\n点 $(i,j)$ 处差分格式的有限差分系数为：\n- 西邻点 $(\\psi_{i-1,j})$: $C_W = \\frac{R_i}{(R_i - \\Delta R/2)(\\Delta R)^2}$\n- 东邻点 $(\\psi_{i+1,j})$: $C_E = \\frac{R_i}{(R_i + \\Delta R/2)(\\Delta R)^2}$\n- 南邻点 $(\\psi_{i,j-1})$: $C_S = \\frac{1}{(\\Delta z)^2}$\n- 北邻点 $(\\psi_{i,j+1})$: $C_N = \\frac{1}{(\\Delta z)^2}$\n- 中心点 $(\\psi_{i,j})$: $C_P = - (C_W + C_E + C_S + C_N) + \\gamma^2$\n\n节点 $(i,j)$ 的方程为 $C_W \\psi_{i-1,j} + C_E \\psi_{i+1,j} + C_S \\psi_{i,j-1} + C_N \\psi_{i,j+1} + C_P \\psi_{i,j} = S_{i,j}$，其中源项为 $S_{i,j} = \\frac{\\mu_0 p_0}{\\psi_a} R_i^2$。由于齐次狄利克雷边界条件（所有边界上 $\\psi = 0$），涉及边界节点的项为零，对系统没有贡献，从而简化了构建过程。\n\n我们使用字典序将内部未知数的二维网格 $(i,j)$ 映射到一维向量索引 $k$：$k = (i-1)(N_z-2) + (j-1)$。矩阵 $A$ 基于此映射构建。对于每个 $k$，$A$ 中对应的行最多有五个非零项（对应点本身及其四个邻点）。所得矩阵在块意义上是五对角的，但由于依赖于 $R$ 的系数而不是对称的。\n\n该系统使用直接稀疏求解器求解，特别是 `scipy.sparse.linalg.spsolve`，它对此类系统非常高效。获得解向量后，将其重塑为表示内部网格上 $\\psi_{i,j}$ 的二维数组。然后将其嵌入到一个带有零边界的完整网格中。\n\n最后，我们计算两个要求的验证指标：\n1. 在最接近几何中心 $(R_c, z_c)$ 的网格点 $(R_{i_c}, z_{j_c})$ 处 $\\psi$ 的值。\n2. 归一化残差 $r = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2 / \\max\\{\\lVert \\mathbf{b} \\rVert_2, \\epsilon\\}$，其中 $\\mathbf{x}$ 是计算出的解向量，$\\epsilon=10^{-16}$ 是一个小数，用于防止在类真空情况下出现除以零的错误。该指标量化了数值解满足离散化方程的程度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\nfrom numpy.linalg import norm\n\ndef solve():\n    \"\"\"\n    Solves the Grad-Shafranov equation using the Finite Difference Method\n    for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general spheromak-like)\n        {'R_min': 0.2, 'R_max': 0.8, 'Z_max': 0.4, 'N_R': 81, 'N_z': 81, 'p0': 2000.0, 'psi_a': 0.5, 'gamma': 3.0},\n        # Case 2 (edge case with vanishing toroidal field function)\n        {'R_min': 0.05, 'R_max': 0.35, 'Z_max': 0.2, 'N_R': 61, 'N_z': 61, 'p0': 1500.0, 'psi_a': 0.3, 'gamma': 0.0},\n        # Case 3 (near-vacuum with strong F(psi))\n        {'R_min': 0.2, 'R_max': 1.0, 'Z_max': 0.6, 'N_R': 71, 'N_z': 91, 'p0': 1.0, 'psi_a': 1.0, 'gamma': 8.0},\n    ]\n\n    results = []\n    \n    # Physical constant mu_0 (permeability of free space)\n    mu_0 = 4.0 * np.pi * 1e-7\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        R_min, R_max = case['R_min'], case['R_max']\n        Z_max = case['Z_max']\n        N_R, N_z = case['N_R'], case['N_z']\n        p0, psi_a = case['p0'], case['psi_a']\n        gamma = case['gamma']\n        \n        # Grid setup\n        R = np.linspace(R_min, R_max, N_R)\n        Z = np.linspace(-Z_max, Z_max, N_z)\n        delta_R = (R_max - R_min) / (N_R - 1)\n        delta_z = (2 * Z_max) / (N_z - 1)\n        \n        # Number of interior points\n        N_R_int = N_R - 2\n        N_z_int = N_z - 2\n        num_unknowns = N_R_int * N_z_int\n\n        # Initialize sparse matrix A and source vector b\n        A = lil_matrix((num_unknowns, num_unknowns))\n        b = np.zeros(num_unknowns)\n\n        # Assemble the matrix A and vector b\n        for i in range(1, N_R - 1): # Radial index for full grid\n            for j in range(1, N_z - 1): # Axial index for full grid\n                \n                # Map 2D interior indices (i-1, j-1) to 1D vector index k\n                k = (i - 1) * N_z_int + (j - 1)\n\n                R_i = R[i]\n                R_half_minus = R_i - delta_R / 2.0\n                R_half_plus = R_i + delta_R / 2.0\n\n                # Calculate coefficients for the 5-point stencil\n                c_W = R_i / (R_half_minus * delta_R**2)\n                c_E = R_i / (R_half_plus * delta_R**2)\n                c_S = 1.0 / delta_z**2\n                c_N = 1.0 / delta_z**2\n                c_P = -(c_W + c_E + c_S + c_N) + gamma**2\n\n                # Set matrix coefficients\n                A[k, k] = c_P\n                \n                # Check neighbors and set off-diagonal elements\n                # West neighbor\n                if i > 1:\n                    A[k, k - N_z_int] = c_W\n                \n                # East neighbor\n                if i  N_R - 2:\n                    A[k, k + N_z_int] = c_E\n\n                # South neighbor\n                if j > 1:\n                    A[k, k - 1] = c_S\n\n                # North neighbor\n                if j  N_z - 2:\n                    A[k, k + 1] = c_N\n                \n                # Set source term for vector b\n                b[k] = (mu_0 * p0 / psi_a) * R_i**2\n\n        # Convert A to CSC format for efficient solving\n        A_csc = A.tocsc()\n\n        # Solve the linear system A*psi_vec = b\n        psi_vec = spsolve(A_csc, b)\n        \n        # --- Post-processing and Verification ---\n\n        # Calculate center value of psi\n        # The geometric center falls on a grid point for all test cases\n        i_c = (N_R - 1) // 2\n        j_c = (N_z - 1) // 2\n        k_c = (i_c - 1) * N_z_int + (j_c - 1)\n        psi_center = psi_vec[k_c]\n\n        # Calculate normalized residual\n        b_norm = norm(b)\n        residual = norm(A_csc @ psi_vec - b) / max(b_norm, 1e-16)\n\n        results.extend([round(psi_center, 6), round(residual, 6)])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际实验中，等离子体被约束在导电容器内，这会对磁场施加严格的边界条件，即法向分量必须为零（$ \\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0 $）。本实践将介绍一种强大的边界积分方法——镜像电流法，它能够巧妙地在模拟中施加这种理想导体边界条件。通过这个练习，你将学会如何对等离子体与其导电壁之间的关键相互作用进行建模，这是进行真实平衡与稳定性计算的核心环节。",
            "id": "4046776",
            "problem": "您的任务是构建并实现一种边界积分方法，该方法为一个被理想导电圆壳包围的球马克平衡简化模型强制施加理想导体条件。您将在一个与对称轴正交的二维横截面中工作，并将球马克的环向电流分布建模为一组与对称轴对齐（平面外）的无限长直电流丝。使用麦克斯韦方程组的静磁极限，并采用归一化的无量纲单位，其中真空磁导率设为1。所有角度都必须以弧度为单位，所有输出都必须是无量纲实数。\n\n基本原理：\n- 静磁学：根据麦克斯韦方程组，使用 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$、$\\nabla \\cdot \\mathbf{B} = 0$，并表示 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$。\n- 在二维 $x$–$y$ 平面中，若电流密度为 $\\mathbf{J} = J_z(x,y)\\,\\hat{\\mathbf{z}}$，矢量势为 $\\mathbf{A} = A_z(x,y)\\,\\hat{\\mathbf{z}}$，则标量势 $A_z$ 满足泊松方程 $\\nabla^2 A_z = -\\mu_0 J_z$ 且 $\\mathbf{B}(x,y) = \\hat{\\mathbf{z}} \\times \\nabla A_z(x,y)$。\n- 在理想磁流体动力学 (MHD) 中，理想导电壁要求壁上的法向磁场为零，即在边界上 $\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$。对于上述二维公式，这等效于沿边界 $A_z = \\text{constant}$。\n\n您将使用一种基于二维泊松方程的自由空间格林函数构建的边界积分方法，并将其应用于半径为 $R$ 的圆形边界（导电壳）。对于一组位于位置 $\\mathbf{r}_i = (x_i, y_i)$、强度为 $I_i$（均沿 $+\\hat{\\mathbf{z}}$ 方向）的 $N$ 个电流丝，自由空间标量势为\n$$\nA_z(\\mathbf{r}) = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi} \\ln \\left\\|\\mathbf{r} - \\mathbf{r}_i\\right\\|,\n$$\n由此可得磁场为\n$$\n\\mathbf{B}(\\mathbf{r}) = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi}\\, \\frac{\\hat{\\mathbf{z}} \\times (\\mathbf{r} - \\mathbf{r}_i)}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2}.\n$$\n为了在圆 $\\|\\mathbf{r}\\|=R$ 上强制施加理想导体边界条件，请使用镜像电流法：对于每个位于 $\\mathbf{r}_i$ 的内部电流丝，在\n$$\n\\mathbf{r}_i^\\ast = \\frac{R^2}{\\|\\mathbf{r}_i\\|^2}\\,\\mathbf{r}_i\n$$\n位置放置一个镜像电流丝，其电流为 $I_i^\\ast = -I_i$。最终的标量势\n$$\nA_z^{\\text{img}}(\\mathbf{r}) = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi} \\left[ \\ln \\left\\|\\mathbf{r} - \\mathbf{r}_i\\right\\| - \\ln \\left\\|\\mathbf{r} - \\mathbf{r}_i^\\ast\\right\\| \\right]\n$$\n在 $\\|\\mathbf{r}\\|=R$ 上为常数，这意味着边界上 $\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$。您需要通过计算有和没有镜像电流时边界上磁场的法向分量来数值验证这一点。\n\n您的程序必须：\n1) 实现半径为 $R$ 的圆形壁上磁场的法向分量 $\\mathbf{B}\\cdot \\hat{\\mathbf{n}}$。该磁场由一组位于 $\\mathbf{r}_i$、电流为 $I_i$ 的 $N$ 个直电流丝产生。需要考虑两种情况：自由空间（无镜像电流）和按上述定义添加镜像电流的情况。\n2) 在 $M$ 个均匀分布的点 $\\mathbf{r}(\\theta_k) = R(\\cos\\theta_k,\\sin\\theta_k)$ 上对壁进行采样，其中 $\\theta_k = 2\\pi k/M$，$k=0,\\dots,M-1$，且 $\\hat{\\mathbf{n}}(\\theta_k) = (\\cos\\theta_k,\\sin\\theta_k)$。\n3) 计算边界条件的最大绝对违背值 $\\max_k |\\mathbf{B}(\\mathbf{r}(\\theta_k))\\cdot \\hat{\\mathbf{n}}(\\theta_k)|$，包括自由空间和镜像电流两种情况。\n\n测试套件：\n使用 $M=2048$ 个边界样本点（角度以弧度为单位），$\\mu_0=1$，以及以下四个测试用例。所有量均为无量纲。\n\n- 用例 1（单个偏心电流丝）：\n  - $R = 1.0$\n  - 电流丝：一个电流为 $I_1 = 1.0$ 的电流丝，位于 $(x_1,y_1)=(0.3,0.0)$。\n\n- 用例 2（两个离轴电流丝）：\n  - $R = 1.0$\n  - 电流丝：两个电流丝，一个电流为 $I_1 = 0.8$，位于 $(0.4,0.2)$；另一个电流为 $I_2 = 0.8$，位于 $(-0.4,0.2)$。\n\n- 用例 3（四重对称配置）：\n  - $R = 1.0$\n  - 电流丝：四个电流为 $I=0.5$ 的电流丝，分别位于 $(0.5,0)$、$(0,-0.5)$、$(-0.5,0)$ 和 $(0,0.5)$。\n\n- 用例 4（近壁电流丝）：\n  - $R = 1.0$\n  - 电流丝：一个电流为 $I_1 = 1.0$ 的电流丝，位于 $(x_1,y_1)=(0.9,0.0)$。\n\n对于每个用例，计算两个浮点数：\n- $V_{\\text{free}}$：无镜像电流时壁上法向分量的最大绝对值。\n- $V_{\\text{image}}$：添加镜像电流时壁上法向分量的最大绝对值。\n\n最终输出格式：\n您的程序应生成单行输出，其中按顺序包含八个结果，格式为方括号内的逗号分隔列表：\n[Case1_V_free,Case1_V_image,Case2_V_free,Case2_V_image,Case3_V_free,Case3_V_image,Case4_V_free,Case4_V_image]\n所有值必须打印为四舍五入到八位有效数字的十进制浮点数。由于所有量都是无量纲的，因此输出中不应包含任何物理单位。",
            "solution": "该问题要求构建并实现一种边界积分方法，以验证一个二维静磁系统的理想导体边界条件 $\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$。该系统由一组无限长直电流丝（代表一个简化的球马克）和一个包围它们的理想导电圆壳组成。我们将计算在两种情况下壳边界上的最大法向磁场：一种是仅有源电流丝（自由空间），另一种是添加镜像电流以强制满足边界条件。\n\n分析在二维笛卡尔坐标系 $(x,y)$ 中进行，采用静磁极限，并使用归一化单位，其中真空磁导率 $\\mu_0$ 设为 $1$。\n\n在位置 $\\mathbf{r}_s = (x_s, y_s)$ 处，一根沿 $\\hat{\\mathbf{z}}$ 轴方向、电流为 $I_s$ 的单根电流丝在 $x-y$ 平面产生的磁场由下式给出：\n$$\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_0 I_s}{2\\pi} \\frac{\\hat{\\mathbf{z}} \\times (\\mathbf{r} - \\mathbf{r}_s)}{\\|\\mathbf{r} - \\mathbf{r}_s\\|^2}\n$$\n此处，$\\mathbf{r} = (x, y)$ 是观测点。矢量叉积展开为 $\\hat{\\mathbf{z}} \\times (\\mathbf{r} - \\mathbf{r}_s) = (-(y - y_s), x - x_s, 0)$。因此，磁场矢量为：\n$$\n\\mathbf{B}(x, y) = \\frac{\\mu_0 I_s}{2\\pi} \\frac{(-(y - y_s), x - x_s)}{(x - x_s)^2 + (y - y_s)^2}\n$$\n\n我们关心的是该磁场垂直于半径为 $R$ 的圆形导电壳的分量。壳上的一个点可以通过角度 $\\theta$ 参数化为 $\\mathbf{r}(\\theta) = (R\\cos\\theta, R\\sin\\theta)$。该点的向外单位法向量为 $\\hat{\\mathbf{n}}(\\theta) = (\\cos\\theta, \\sin\\theta)$，等价于 $\\mathbf{r}/R$。\n\n边界上一点 $\\mathbf{r}$ 处的磁场法向分量 $\\mathbf{B} \\cdot \\hat{\\mathbf{n}}$ 通过点积计算：\n$$\n\\mathbf{B}(\\mathbf{r}) \\cdot \\hat{\\mathbf{n}} = \\frac{\\mu_0 I_s}{2\\pi} \\frac{(-(y - y_s), x - x_s)}{(x - x_s)^2 + (y - y_s)^2} \\cdot \\left(\\frac{x}{R}, \\frac{y}{R}\\right)\n$$\n$$\n\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = \\frac{\\mu_0 I_s}{2\\pi R} \\frac{-x(y - y_s) + y(x - x_s)}{(x - x_s)^2 + (y - y_s)^2} = \\frac{\\mu_0 I_s}{2\\pi R} \\frac{-xy + xy_s + yx - yx_s}{(x - x_s)^2 + (y - y_s)^2}\n$$\n化简后得到：\n$$\n\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = \\frac{\\mu_0 I_s}{2\\pi R} \\frac{x y_s - y x_s}{\\|\\mathbf{r} - \\mathbf{r}_s\\|^2}\n$$\n分子 $x y_s - y x_s$ 是二维叉积 $(\\mathbf{r} \\times \\mathbf{r}_s)_z$ 的大小。\n\n对于一个由 $N$ 个源电流丝（电流为 $I_i$ 和位置为 $\\mathbf{r}_i$）组成的系统，总磁场是每个电流丝产生磁场的线性叠加。边界点 $\\mathbf{r}$ 处的总法向分量为：\n$$\n(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{free}} = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi R} \\frac{(\\mathbf{r} \\times \\mathbf{r}_i)_z}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2}\n$$\n该表达式对应于“自由空间”情况，其中忽略了导电壁的影响。此量在边界上的最大绝对值 $\\max |(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{free}}|$，就是我们计算的 $V_{\\text{free}}$。\n\n为了强制施加理想导体边界条件，我们使用镜像法。对于圆内位置为 $\\mathbf{r}_i$、电流为 $I_i$ 的每个源电流丝 $i$，在圆外放置一个镜像电流丝。该镜像电流丝的电流为 $I_i^\\ast = -I_i$，位置为：\n$$\n\\mathbf{r}_i^\\ast = \\frac{R^2}{\\|\\mathbf{r}_i\\|^2}\\mathbf{r}_i\n$$\n现在的总磁场是 $N$ 个源电流丝及其对应的 $N$ 个镜像电流丝产生磁场的叠加。边界上的法向分量为：\n$$\n(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{image}} = \\sum_{i=1}^N \\left( \\frac{\\mu_0 I_i}{2\\pi R} \\frac{(\\mathbf{r} \\times \\mathbf{r}_i)_z}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2} + \\frac{\\mu_0 I_i^\\ast}{2\\pi R} \\frac{(\\mathbf{r} \\times \\mathbf{r}_i^\\ast)_z}{\\|\\mathbf{r} - \\mathbf{r}_i^\\ast\\|^2} \\right)\n$$\n代入 $I_i^\\ast = -I_i$，我们得到：\n$$\n(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{image}} = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi R} \\left( \\frac{(\\mathbf{r} \\times \\mathbf{r}_i)_z}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2} - \\frac{(\\mathbf{r} \\times \\mathbf{r}_i^\\ast)_z}{\\|\\mathbf{r} - \\mathbf{r}_i^\\ast\\|^2} \\right)\n$$\n理论上，对于圆 $\\|\\mathbf{r}\\|=R$ 上的任意点 $\\mathbf{r}$，此表达式的计算结果都为零，从而满足边界条件。此数值计算量的最大绝对值 $\\max |(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{image}}|$ 即为 $V_{\\text{image}}$。任何非零结果都可归因于浮点表示和算术误差。\n\n数值实现过程如下：\n1.  将圆形边界离散为 $M$ 个均匀分布的点 $\\mathbf{r}_k = (R\\cos\\theta_k, R\\sin\\theta_k)$，其中 $\\theta_k = 2\\pi k/M$，$k = 0, \\dots, M-1$。\n2.  对于每个测试用例，定义源电流丝集合（电流 $I_i$ 和位置 $\\mathbf{r}_i$）。\n3.  计算镜像电流丝的位置 $\\mathbf{r}_i^\\ast$ 和电流 $I_i^\\ast$。\n4.  为提高效率，使用矢量化计算来评估所有源电流丝在所有 $M$ 个边界点上的法向磁场贡献。将这些贡献相加，得到自由空间情况下的总法向场数组。\n5.  类似地，计算来自镜像电流丝的贡献。\n6.  镜像电流情况下的法向场是源电流丝及其镜像电流丝贡献的总和。\n7.  自由空间和镜像电流情况下所得数组中元素的最大绝对值分别得出 $V_{\\text{free}}$ 和 $V_{\\text{image}}$。\n\n此过程将应用于问题描述中指定的四个测试用例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_max_violations(R, filaments, M, mu0):\n    \"\"\"\n    Computes the maximum violation of the perfect conductor boundary condition.\n\n    Args:\n        R (float): Radius of the circular conducting shell.\n        filaments (np.ndarray): Array of shape (N, 3) where N is the number of\n                                filaments. Each row is [I, x, y].\n        M (int): Number of sample points on the boundary.\n        mu0 (float): Vacuum permeability.\n\n    Returns:\n        tuple[float, float]: A tuple containing (V_free, V_image), where\n                             V_free is the max violation without images and\n                             V_image is the max violation with images.\n    \"\"\"\n    # 1. Discretize the boundary\n    theta = 2 * np.pi * np.arange(M) / M\n    # Boundary points r_k = (r_kx, r_ky), shape (M,)\n    r_kx = R * np.cos(theta)\n    r_ky = R * np.sin(theta)\n\n    # 2. Unpack filament data\n    # I_i, r_ix, r_iy, shape(N,)\n    I_s = filaments[:, 0]\n    r_sx = filaments[:, 1]\n    r_sy = filaments[:, 2]\n    N = len(I_s)\n\n    # 3. Compute contributions from source filaments\n    # Use broadcasting: r_k is (M,1), r_s is (1,N) - result is (M,N)\n    \n    # Numerator term: (r_k x r_s)_z = r_kx * r_sy - r_ky * r_sx\n    num_s = r_kx[:, np.newaxis] * r_sy[np.newaxis, :] - r_ky[:, np.newaxis] * r_sx[np.newaxis, :]\n    \n    # Denominator term: ||r_k - r_s||^2\n    # delta_x = r_kx - r_sx, delta_y = r_ky - r_sy\n    delta_x_s = r_kx[:, np.newaxis] - r_sx[np.newaxis, :]\n    delta_y_s = r_ky[:, np.newaxis] - r_sy[np.newaxis, :]\n    den_s = delta_x_s**2 + delta_y_s**2\n\n    # Normal B field contribution from each source filament at each boundary point\n    B_n_contrib_s = (mu0 * I_s[np.newaxis, :] / (2 * np.pi * R)) * (num_s / den_s)\n\n    # 4. Compute V_free by summing contributions\n    B_n_free = np.sum(B_n_contrib_s, axis=1)\n    V_free = np.max(np.abs(B_n_free))\n\n    # 5. Compute image filament properties\n    I_img = -I_s\n    r_s_norm_sq = r_sx**2 + r_sy**2\n\n    # Handle potential filament at origin, though not in test cases\n    # If r_s_norm_sq is 0, factor becomes inf. A central filament needs no image.\n    # Its contribution to B_n is already 0. We avoid division by zero.\n    factor = np.divide(R**2, r_s_norm_sq, out=np.zeros_like(r_s_norm_sq), where=r_s_norm_sq!=0)\n    \n    r_sx_img = factor * r_sx\n    r_sy_img = factor * r_sy\n\n    # 6. Compute contributions from image filaments\n    # Numerator term: (r_k x r_s_img)_z\n    num_img = r_kx[:, np.newaxis] * r_sy_img[np.newaxis, :] - r_ky[:, np.newaxis] * r_sx_img[np.newaxis, :]\n    \n    # Denominator term: ||r_k - r_s_img||^2\n    delta_x_img = r_kx[:, np.newaxis] - r_sx_img[np.newaxis, :]\n    delta_y_img = r_ky[:, np.newaxis] - r_sy_img[np.newaxis, :]\n    den_img = delta_x_img**2 + delta_y_img**2\n\n    B_n_contrib_img = (mu0 * I_img[np.newaxis, :] / (2 * np.pi * R)) * (num_img / den_img)\n\n    # 7. Compute V_image by summing all contributions\n    B_n_image = np.sum(B_n_contrib_s + B_n_contrib_img, axis=1)\n    V_image = np.max(np.abs(B_n_image))\n\n    return V_free, V_image\n\ndef solve():\n    \"\"\"\n    Main solver function that runs the test suite and prints the formatted output.\n    \"\"\"\n    # Define problem constants\n    M = 2048\n    mu0 = 1.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (1.0, np.array([[1.0, 0.3, 0.0]])),\n        # Case 2\n        (1.0, np.array([[0.8, 0.4, 0.2], [0.8, -0.4, 0.2]])),\n        # Case 3\n        (1.0, np.array([[0.5, 0.5, 0.0], [0.5, 0.0, -0.5], [0.5, -0.5, 0.0], [0.5, 0.0, 0.5]])),\n        # Case 4\n        (1.0, np.array([[1.0, 0.9, 0.0]])),\n    ]\n\n    results = []\n    for R, filaments in test_cases:\n        V_free, V_image = compute_max_violations(R, filaments, M, mu0)\n        results.append(V_free)\n        results.append(V_image)\n    \n    # Format results to 8 significant digits\n    formatted_results = ['{:.8g}'.format(res) for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "尽管磁流体力学（MHD）提供了良好的初步近似，但球马克和FRC中的许多关键动态过程，例如形成过程中的快速磁重联，都需要包含霍尔物理在内的更高级双流体模型来描述。本实践将引导你完成双流体模拟的关键准备步骤，这是计算物理学家的必备技能。你将学习如何对控制方程进行归一化，并计算关键的无量纲参数和诊断量，从而在启动大规模模拟之前确定主导的物理机制。",
            "id": "4046753",
            "problem": "您需要实现一个完整的、可运行的程序，该程序构建一个归一化的、轴对称的双流体设置，适用于通过 θ-箍缩 模拟场反位形（FRC）的形成，并计算诊断信息，以指明在给定的参数集下，哨声波介导的重联是否预计会占主导地位。您的程序不应对时间推进方程；相反，它应建立归一化方案、初始化剖面、边界条件，并从第一性原理计算诊断信息。\n\n其基本理论基础包括双流体等离子体方程（离子和电子）、麦克斯韦方程组，以及适用于哨声波的冷、无碰撞极限下派生等离子体参数的标准定义。场反位形（FRC）是一种紧凑环，其特征是闭合的极向磁场和可忽略的环向磁场。θ-箍缩形成方法利用快速上升的轴向磁场来感应出驱动电流的角向电场，从而形成 FRC。磁流体力学（MHD）及其双流体扩展（包括霍尔物理和有限电子惯性）将被用作建模背景。缩略词在首次出现时必须定义：场反位形（FRC）、磁流体力学（MHD）、电子磁流体力学（EMHD）。\n\n实现要求：\n\n- 几何与离散化：\n  - 使用一个半径为 $R$、轴向长度为 $L_z$ 的轴对称圆柱域。使用均匀网格对半径 $r \\in [0,R]$ 和轴向坐标 $z \\in [-L_z/2, L_z/2]$ 进行离散化。角度必须以弧度为单位。\n  - 初始化一个极向磁场，其轴向分量 $B_z(r)$ 在核心区符号反转，以模拟类 FRC 剖面。需要一个科学上合理的剖面；例如，$B_z(r) = B_0\\left(1 - 2\\exp\\left(-\\left(\\frac{r}{a}\\right)^2\\right)\\right)$，其中 $B_0$ 是特征轴向磁场，$a$ 是一个电流片半厚度标度。初始时设置 $B_r(r,z) = 0$ 且没有环向分量。\n\n- 归一化：\n  - 定义特征标度：长度 $L_0 = R$，磁场 $B_0$，密度 $n_0$，以及阿尔芬速度 $v_A = \\frac{B_0}{\\sqrt{\\mu_0 m_i n_0}}$，其中 $\\mu_0$ 是真空磁导率，$m_i$ 是离子质量（使用氢，$m_i = m_p$）。时间标度为 $\\tau_A = \\frac{L_0}{v_A}$。电场标度为 $E_0 = v_A B_0$。用这些标度对场、空间和时间进行归一化。使用国际单位制（SI）。\n\n- 边界条件：\n  - 在 $r=R$ 处的理想导电壁：强制施加物理上一致的静态初始约束，使得在初始状态下壁上的切向电场为零，并且没有法向磁通量穿透材料。对于静态初始状态，验证 $B_r(R,z)=0$；选择与初始剖面一致的 $B_z(R)$。\n  - 在 $r=0$ 处的轴上正则性：确保场是有限的，没有非物理奇点。\n  - 在 $z = \\pm L_z/2$ 处的轴向边界：对初始剖面使用对称或零梯度条件。\n\n- 哨声波介导重联的诊断：\n  - 导出参数：\n    - 电子等离子体频率 $\\omega_{pe} = \\sqrt{\\frac{n_0 e^2}{\\varepsilon_0 m_e}}$，离子等离子体频率 $\\omega_{pi} = \\sqrt{\\frac{n_0 e^2}{\\varepsilon_0 m_i}}$，其中 $e$ 是元电荷，$\\varepsilon_0$ 是真空介电常数，$m_e$ 是电子质量。\n    - 惯性长度 $d_e = \\frac{c}{\\omega_{pe}}$，$d_i = \\frac{c}{\\omega_{pi}}$，其中 $c$ 是光速。\n    - 回旋频率 $\\Omega_e = \\frac{e B_0}{m_e}$，$\\Omega_i = \\frac{e B_0}{m_i}$。\n  - 取特征波数 $k = \\frac{\\pi}{a}$，对应于电流片的基模。\n  - 在冷、平行传播 EMHD 哨声波近似中，使用色散关系 $\\omega_w = \\Omega_e d_e^2 k^2$ 和群速度 $v_g = 2 \\Omega_e d_e^2 k$。为符合物理真实性，将 $v_g$ 的上限设为 $c$。\n  - 霍尔参数 $H = \\frac{d_i}{a}$。\n  - 计算以下判据：\n    - $C_1$: $v_g  v_A$,\n    - $C_2$: $\\omega_w  \\Omega_i$,\n    - $C_3$: $H  0.5$,\n    - $C_4$: $a  R$,\n    - $C_5$: $a  3 d_e$（以避免由电子尺度主导的电流片，这种情况会使初始设置的假设排序失效），\n    - $C_6$: 数值计算出的 $\\mathbf{B}$ 的归一化散度的最大值足够小，定义为 $\\max \\left|\\nabla \\cdot \\mathbf{B}\\right| / \\left(B_0/L_0\\right)  10^{-8}$，在轴对称下使用柱坐标中一致的离散散度：$\\nabla \\cdot \\mathbf{B} = \\frac{1}{r}\\frac{\\partial (r B_r)}{\\partial r} + \\frac{\\partial B_z}{\\partial z}$。小心处理 $r=0$ 以避免除以零。\n  - 对于每个参数集，最终的布尔判决为真，当且仅当所有 $C_1$ 到 $C_6$ 都满足。\n\n- 单位与常数：\n  - 所有输入和输出必须采用国际单位制（SI）单位。角度必须以弧度为单位。使用 $m_i = m_p$ 和 $Z=1$。\n\n- 测试套件：\n  为以下四个科学上合理的参数集实现并评估诊断（每个参数集是一个元组 $(n_0, T_e, B_0, a, R, L_z, \\dot{B})$，其中 $T_e$ 是电子温度，$\\dot{B} = \\frac{dB}{dt}$ 是轴向场斜坡率）：\n  1. 基准类 FRC 设置：$n_0 = 2.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $T_e = 100\\ \\mathrm{eV}$, $B_0 = 0.5\\ \\mathrm{T}$, $a = 3.0 \\times 10^{-2}\\ \\mathrm{m}$, $R = 1.0 \\times 10^{-1}\\ \\mathrm{m}$, $L_z = 5.0 \\times 10^{-1}\\ \\mathrm{m}$, $\\dot{B} = 1.0 \\times 10^{5}\\ \\mathrm{T/s}$。\n  2. 高密度、中等场情况：$n_0 = 1.0 \\times 10^{21}\\ \\mathrm{m}^{-3}$, $T_e = 50\\ \\mathrm{eV}$, $B_0 = 0.2\\ \\mathrm{T}$, $a = 2.0 \\times 10^{-2}\\ \\mathrm{m}$, $R = 1.0 \\times 10^{-1}\\ \\mathrm{m}$, $L_z = 5.0 \\times 10^{-1}\\ \\mathrm{m}$, $\\dot{B} = 5.0 \\times 10^{4}\\ \\mathrm{T/s}$。\n  3. 薄电流片情况：$n_0 = 5.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $T_e = 80\\ \\mathrm{eV}$, $B_0 = 0.3\\ \\mathrm{T}$, $a = 8.0 \\times 10^{-3}\\ \\mathrm{m}$, $R = 1.0 \\times 10^{-1}\\ \\mathrm{m}$, $L_z = 5.0 \\times 10^{-1}\\ \\mathrm{m}$, $\\dot{B} = 1.0 \\times 10^{5}\\ \\mathrm{T/s}$。\n  4. 弱场、低密度情况：$n_0 = 1.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$, $T_e = 30\\ \\mathrm{eV}$, $B_0 = 5.0 \\times 10^{-2}\\ \\mathrm{T}$, $a = 2.0 \\times 10^{-2}\\ \\mathrm{m}$, $R = 1.0 \\times 10^{-1}\\ \\mathrm{m}$, $L_z = 5.0 \\times 10^{-1}\\ \\mathrm{m}$, $\\dot{B} = 2.0 \\times 10^{4}\\ \\mathrm{T/s}$。\n\n- 计算与输出：\n  - 对于每个参数集，构建归一化设置，计算 $v_A$、$\\omega_{pe}$、$\\omega_{pi}$、$d_e$、$d_i$、$\\Omega_e$、$\\Omega_i$、$k$、$\\omega_w$、$v_g$（上限为 $c$）、霍尔参数 $H$、归一化散度最大值，并评估判据 $C_1$ 到 $C_6$。\n  - 您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表形式的结果，每个测试用例对应一个布尔值，并按上述顺序排列，例如，“[true,false,true,true]”。使用小写布尔值。",
            "solution": "所提出的问题已经过严格验证，并被确定为科学上合理、适定的、客观且内部一致的。它代表了计算聚变科学领域内一个有效且可形式化的任务。我们注意到了无关参数，即电子温度 $T_e$ 和磁场斜坡率 $\\dot{B}$；然而，它们并不会使问题无效，因为针对初始状态诊断的指定计算是基于冷等离子体近似，并未使用这些特定值。它们为更广泛的 FRC 形成物理场景提供了相关背景，但对于当前任务并非必需。我们现在可以着手给出一个完整的解决方案。\n\n该问题要求确定在给定的场反位形（FRC）θ-箍缩设置中，哨声波介导的重联是否是主导机制。这是通过评估基于初始状态派生出的基本等离子体参数的一系列六个判据（$C_1$ 到 $C_6$）来完成的。每个参数集的最终判决是这六个独立判据的逻辑合取。\n\n首先，我们定义国际单位制（SI）中的必要物理常数：\n- 元电荷, $e \\approx 1.602 \\times 10^{-19}\\ \\mathrm{C}$\n- 真空磁导率, $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$\n- 真空介电常数, $\\varepsilon_0 \\approx 8.854 \\times 10^{-12}\\ \\mathrm{F/m}$\n- 电子质量, $m_e \\approx 9.109 \\times 10^{-31}\\ \\mathrm{kg}$\n- 质子质量, $m_p \\approx 1.672 \\times 10^{-27}\\ \\mathrm{kg}$\n- 真空中光速, $c \\approx 2.998 \\times 10^{8}\\ \\mathrm{m/s}$\n\n问题指定了氢等离子体，因此离子质量 $m_i$ 取为质子质量，$m_i = m_p$。\n\n对于每个由参数元组 $(n_0, T_e, B_0, a, R, L_z, \\dot{B})$ 定义的测试用例，我们计算以下量。\n\n1.  **特征等离子体参数**：\n    阿尔芬速度 $v_A$ 是大尺度 MHD 波的特征传播速度，由下式给出：\n    $$v_A = \\frac{B_0}{\\sqrt{\\mu_0 m_i n_0}}$$\n    电子和离子等离子体频率代表了电子和离子物种的自然振荡频率，分别是：\n    $$\\omega_{pe} = \\sqrt{\\frac{n_0 e^2}{\\varepsilon_0 m_e}}$$\n    $$\\omega_{pi} = \\sqrt{\\frac{n_0 e^2}{\\varepsilon_0 m_i}}$$\n    电子和离子惯性长度（或趋肤深度）$d_e$ 和 $d_i$ 是电子和离子惯性变得重要的特征长度尺度，分别是：\n    $$d_e = \\frac{c}{\\omega_{pe}}$$\n    $$d_i = \\frac{c}{\\omega_{pi}}$$\n    电子和离子回旋（或陀螺）频率是粒子围绕磁力线回旋的频率，分别是：\n    $$\\Omega_e = \\frac{e B_0}{m_e}$$\n    $$\\Omega_i = \\frac{e B_0}{m_i}$$\n\n2.  **哨声波性质**：\n    哨声波是可以介导快速磁重联的高频电磁波。它们的性质在与电流片半厚度 $a$ 的空间尺度相关的特征波数 $k$ 处进行评估。基模的一个合理选择是：\n    $$k = \\frac{\\pi}{a}$$\n    在冷、平行传播的电子磁流体力学（EMHD）近似下，哨声波的色散关系给出为：\n    $$\\omega_w = \\Omega_e d_e^2 k^2$$\n    相应的群速度决定了波能量和重联磁通量的传播速度，为：\n    $$v_g = \\frac{\\partial \\omega_w}{\\partial k} = 2 \\Omega_e d_e^2 k$$\n    为符合物理真实性，群速度不能超过光速，因此其上限为 $c$：$v_g = \\min(v_g, c)$。\n\n3.  **霍尔参数**：\n    霍尔参数 $H$ 通过比较离子惯性长度与电流片尺度长度来量化霍尔效应的重要性。当 $H$ 不小时，霍尔项变得显著。\n    $$H = \\frac{d_i}{a}$$\n\n4.  **判据评估 ($C_1$ - $C_6$)**：\n    我们评估这六个判据，以确定系统是否处于哨声波介导的重联机制区。\n\n    -   **$C_1: v_g  v_A$**：此判据规定，由哨声波群速度 $v_g$ 表征的重联出流必须相对于入流阿尔芬速度 $v_A$ 是超阿尔芬的。这是快速重联的一个标志。\n\n    -   **$C_2: \\omega_w  \\Omega_i$**：为使重联与离子的缓慢动力学解耦，该过程的特征频率 $\\omega_w$ 必须大于离子回旋频率 $\\Omega_i$。\n\n    -   **$C_3: H  0.5$**：霍尔效应对于实现快速重联至关重要。此判据要求电流片厚度 $a$ 小于两倍的离子趋肤深度 $d_i$，以确保双流体效应显著。0.5 的阈值是一个标准的经验法则。\n\n    -   **$C_4: a  R$**：这是一个基本的几何约束，确保电流片结构在物理上包含在计算域的径向边界 $R$ 之内。\n\n    -   **$C_5: a  3 d_e$**：此判据确保电流片相对于电子惯性长度 $d_e$ 足够厚，以保持在双流体霍尔 MHD 模型的有效性范围内。如果 $a$ 变得与 $d_e$ 相当，此流体模型未捕获的动理学效应将占主导地位。\n\n    -   **$C_6: \\max \\left|\\nabla \\cdot \\mathbf{B}\\right| / \\left(B_0/L_0\\right)  10^{-8}$**：此条件验证初始磁场是无散的，这与麦克斯韦方程组（$\\nabla \\cdot \\mathbf{B} = 0$）一致。对于给定的轴对称设置，散度为 $\\nabla \\cdot \\mathbf{B} = \\frac{1}{r}\\frac{\\partial (r B_r)}{\\partial r} + \\frac{\\partial B_z}{\\partial z}$。问题指定的初始场为 $B_r(r,z) = 0$ 和 $B_z(r,z) = B_z(r)$。将这些代入散度公式得到：\n        $$\\nabla \\cdot \\mathbf{B} = \\frac{1}{r}\\frac{\\partial (r \\cdot 0)}{\\partial r} + \\frac{\\partial (B_z(r))}{\\partial z} = 0 + 0 = 0$$\n        散度在解析上处处为零。因此，任何一致的数值计算都将得到一个零值（在机器精度范围内）。因此，归一化散度的最大值为 $0$，这轻易地满足条件 $0  10^{-8}$。因此，对于指定的初始场，此判据总是满足的。\n\n每个测试用例的最终布尔结果为 `true`，当且仅当所有六个判据（$C_1$ AND $C_2$ AND $C_3$ AND $C_4$ AND $C_5$ AND $C_6$）都满足。以下程序实现了这一逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Constructs a normalized, axisymmetric, two-fluid setup for FRC formation\n    and computes diagnostics for whistler-mediated reconnection.\n    \"\"\"\n\n    # Physical constants in SI units\n    e = constants.e\n    mu_0 = constants.mu_0\n    epsilon_0 = constants.epsilon_0\n    m_e = constants.m_e\n    m_p = constants.m_p  # Ion mass is proton mass for hydrogen\n    c = constants.c\n    m_i = m_p\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n0, Te, B0, a, R, Lz, B_dot)\n    # n0 (m^-3), Te (eV), B0 (T), a (m), R (m), Lz (m), B_dot (T/s)\n    # Note: Te and B_dot are not used in the diagnostic calculations as per the problem's\n    # \"cold, collisionless\" and \"initial state\" specifications.\n    test_cases = [\n        (2.0e19, 100, 0.5, 3.0e-2, 1.0e-1, 5.0e-1, 1.0e5),\n        (1.0e21, 50, 0.2, 2.0e-2, 1.0e-1, 5.0e-1, 5.0e4),\n        (5.0e19, 80, 0.3, 8.0e-3, 1.0e-1, 5.0e-1, 1.0e5),\n        (1.0e19, 30, 5.0e-2, 2.0e-2, 1.0e-1, 5.0e-1, 2.0e4),\n    ]\n\n    results = []\n    for case in test_cases:\n        n0, _, B0, a, R, _, _ = case\n\n        # --- Step 1: Compute derived plasma parameters ---\n        v_A = B0 / np.sqrt(mu_0 * m_i * n0)\n        \n        omega_pe = np.sqrt(n0 * e**2 / (epsilon_0 * m_e))\n        omega_pi = np.sqrt(n0 * e**2 / (epsilon_0 * m_i))\n        \n        d_e = c / omega_pe\n        d_i = c / omega_pi\n        \n        Omega_e = e * B0 / m_e\n        Omega_i = e * B0 / m_i\n\n        # --- Step 2: Compute whistler wave properties ---\n        # Characteristic wavenumber for the current sheet\n        k = np.pi / a\n        \n        # Whistler dispersion relation (EMHD approximation)\n        omega_w = Omega_e * d_e**2 * k**2\n        \n        # Whistler group velocity\n        v_g = 2 * Omega_e * d_e**2 * k\n        v_g = min(v_g, c)  # Cap group velocity at speed of light\n\n        # --- Step 3: Compute Hall parameter ---\n        H = d_i / a\n\n        # --- Step 4: Evaluate the six criteria (C1-C6) ---\n        C1 = v_g > v_A\n        C2 = omega_w > Omega_i\n        C3 = H > 0.5\n        C4 = a  R\n        C5 = a > (3 * d_e)\n        \n        # C6: Check for divergence-free magnetic field.\n        # As established in the solution text, the given analytical field\n        # B_r=0, B_z=B_z(r) is analytically divergence-free.\n        # The numerical divergence is therefore zero (to machine precision),\n        # satisfying the criterion max|div(B)| / (B0/L0)  1e-8.\n        C6 = True\n\n        # The final verdict is true if and only if all criteria are met.\n        verdict = all([C1, C2, C3, C4, C5, C6])\n        results.append(str(verdict).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}