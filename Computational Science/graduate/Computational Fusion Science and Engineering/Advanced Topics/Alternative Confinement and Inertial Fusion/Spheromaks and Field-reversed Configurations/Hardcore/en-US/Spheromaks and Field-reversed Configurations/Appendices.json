{
    "hands_on_practices": [
        {
            "introduction": "The foundation for analyzing any magnetic confinement configuration is determining its equilibrium state. For axisymmetric devices like spheromaks and some models of Field-Reversed Configurations (FRCs), the magnetohydrodynamic (MHD) equilibrium is described by the Grad–Shafranov equation. This powerful partial differential equation relates the magnetic flux function to the plasma pressure and current profiles. In this exercise, you will develop a numerical solver for the Grad-Shafranov equation, a cornerstone computational skill for modeling and designing such fusion concepts .",
            "id": "4046757",
            "problem": "Consider axisymmetric magnetohydrodynamic (MHD) equilibria in cylindrical coordinates with radial coordinate $R$ and axial coordinate $z$. Let the poloidal flux function be $\\psi(R,z)$, the pressure be $p(\\psi) = p_0 \\left(1 - \\psi / \\psi_a\\right)$, and the toroidal field function be $F(\\psi) = \\gamma \\psi$, where $p_0$ is a positive constant with units pascal ($\\mathrm{Pa}$), $\\psi_a$ is a positive constant with units weber ($\\mathrm{Wb}$), and $\\gamma$ is a positive constant with units $\\mathrm{m}^{-1}$. The magnetostatic equilibrium is governed by the Grad–Shafranov equation,\n$$\n\\Delta^* \\psi = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi},\n$$\nwhere $\\mu_0$ is the permeability of free space with value $\\mu_0 = 4 \\pi \\times 10^{-7} \\ \\mathrm{H/m}$, and the elliptic operator is\n$$\n\\Delta^* \\psi = R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2}.\n$$\nStarting from these definitions and laws, derive the form of the elliptic operator in conservative form appropriate for a rectangular grid in $(R,z)$, and compute the corresponding finite-difference coefficients for a five-point stencil on a uniform grid with spacings $\\Delta R$ and $\\Delta z$. Use homogeneous Dirichlet boundary conditions $\\psi = 0$ on all boundaries of the rectangular computational domain. Your derivation should begin from the Grad–Shafranov equation and express all mathematical steps explicitly.\n\nFormulate a numerical scheme based on the Finite Difference Method (FDM) to solve for $\\psi(R,z)$ in a rectangular domain with $R \\in [R_{\\min}, R_{\\max}]$ and $z \\in [-Z_{\\max}, Z_{\\max}]$. Discretize with $N_R$ uniformly spaced radial points and $N_z$ uniformly spaced axial points, including boundaries. Assemble the resulting sparse linear system in the interior unknowns only and solve it using a direct sparse solver. The right-hand side source term must be derived and consistently discretized. Use only physically plausible parameters, and ensure your implementation is self-contained and numerically stable.\n\nImplement the scheme in a complete, runnable program. For verification, compute for each test case:\n- The numerical value of $\\psi$ at the grid point closest to the geometric center $(R_c, z_c)$, where $R_c = (R_{\\min} + R_{\\max})/2$ and $z_c = 0$. Express this value in weber ($\\mathrm{Wb}$), rounded to six decimal places.\n- The normalized residual defined as $\\lVert A \\psi - b \\rVert_2 / \\max\\{\\lVert b \\rVert_2, \\epsilon\\}$ with $\\epsilon = 10^{-16}$, rounded to six decimal places. Treat the residual as dimensionless.\n\nTest Suite:\n- Case 1 (general spheromak-like): $R_{\\min} = 0.2 \\ \\mathrm{m}$, $R_{\\max} = 0.8 \\ \\mathrm{m}$, $Z_{\\max} = 0.4 \\ \\mathrm{m}$, $N_R = 81$, $N_z = 81$, $p_0 = 2000 \\ \\mathrm{Pa}$, $\\psi_a = 0.5 \\ \\mathrm{Wb}$, $\\gamma = 3 \\ \\mathrm{m}^{-1}$.\n- Case 2 (edge case with vanishing toroidal field function): $R_{\\min} = 0.05 \\ \\mathrm{m}$, $R_{\\max} = 0.35 \\ \\mathrm{m}$, $Z_{\\max} = 0.2 \\ \\mathrm{m}$, $N_R = 61$, $N_z = 61$, $p_0 = 1500 \\ \\mathrm{Pa}$, $\\psi_a = 0.3 \\ \\mathrm{Wb}$, $\\gamma = 0 \\ \\mathrm{m}^{-1}$.\n- Case 3 (near-vacuum with strong $F(\\psi)$): $R_{\\min} = 0.2 \\ \\mathrm{m}$, $R_{\\max} = 1.0 \\ \\mathrm{m}$, $Z_{\\max} = 0.6 \\ \\mathrm{m}$, $N_R = 71$, $N_z = 91$, $p_0 = 1 \\ \\mathrm{Pa}$, $\\psi_a = 1.0 \\ \\mathrm{Wb}$, $\\gamma = 8 \\ \\mathrm{m}^{-1}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order: $[\\psi_{c,1}, r_1, \\psi_{c,2}, r_2, \\psi_{c,3}, r_3]$, where $\\psi_{c,i}$ is the center value of $\\psi$ in $\\mathrm{Wb}$ for case $i$ rounded to six decimal places, and $r_i$ is the normalized residual for case $i$ rounded to six decimal places.",
            "solution": "The problem is valid as it is scientifically grounded in magnetohydrodynamics, mathematically well-posed as a linear elliptic partial differential equation with specified boundary conditions, and provides a complete and consistent set of parameters for a numerical solution. The task is non-trivial and verifiable.\n\nThe analysis begins with the Grad–Shafranov equation given as\n$$\n\\Delta^* \\psi = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi}\n$$\nwhere the elliptic operator is\n$$\n\\Delta^* \\psi = R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2}\n$$\nThe pressure $p(\\psi)$ and toroidal field function $F(\\psi)$ are given by\n$$\np(\\psi) = p_0 \\left(1 - \\frac{\\psi}{\\psi_a}\\right) \\quad \\text{and} \\quad F(\\psi) = \\gamma \\psi\n$$\nFirst, we compute the derivatives required for the source term on the right-hand side (RHS) of the Grad–Shafranov equation.\n$$\n\\frac{dp}{d\\psi} = \\frac{d}{d\\psi} \\left[ p_0 \\left(1 - \\frac{\\psi}{\\psi_a}\\right) \\right] = -\\frac{p_0}{\\psi_a}\n$$\n$$\n\\frac{dF}{d\\psi} = \\frac{d}{d\\psi} (\\gamma \\psi) = \\gamma\n$$\nSubstituting these expressions into the RHS gives\n$$\n- \\mu_0 R^2 \\left(-\\frac{p_0}{\\psi_a}\\right) - (\\gamma \\psi)(\\gamma) = \\frac{\\mu_0 p_0}{\\psi_a} R^2 - \\gamma^2 \\psi\n$$\nThe Grad–Shafranov equation is therefore a linear, inhomogeneous, second-order partial differential equation in $\\psi(R,z)$. We can rearrange it into the form of a Helmholtz-type equation:\n$$\n\\Delta^* \\psi + \\gamma^2 \\psi = \\frac{\\mu_0 p_0}{\\psi_a} R^2\n$$\nor, expanding the operator,\n$$\nR \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2} + \\gamma^2 \\psi = \\frac{\\mu_0 p_0}{\\psi_a} R^2\n$$\nWe solve this equation on a rectangular domain $R \\in [R_{\\min}, R_{\\max}]$ and $z \\in [-Z_{\\max}, Z_{\\max}]$ with homogeneous Dirichlet boundary conditions, $\\psi=0$, on all boundaries.\n\nTo solve this numerically, we employ the Finite Difference Method (FDM) on a uniform Cartesian grid. The domain is discretized with $N_R$ points in the radial direction and $N_z$ points in the axial direction. The grid points are $(R_i, z_j)$ where\n$$\nR_i = R_{\\min} + i \\Delta R, \\quad i \\in \\{0, 1, \\dots, N_R-1\\}\n$$\n$$\nz_j = -Z_{\\max} + j \\Delta z, \\quad j \\in \\{0, 1, \\dots, N_z-1\\}\n$$\nThe uniform grid spacings are\n$$\n\\Delta R = \\frac{R_{\\max} - R_{\\min}}{N_R-1}, \\quad \\Delta z = \\frac{2 Z_{\\max}}{N_z-1}\n$$\nLet $\\psi_{i,j}$ denote the numerical approximation of $\\psi(R_i, z_j)$. We use second-order central differences to approximate the partial derivatives at an interior grid point $(i,j)$, where $1 \\le i \\le N_R-2$ and $1 \\le j \\le N_z-2$.\n\nThe axial second derivative is approximated as:\n$$\n\\frac{\\partial^2 \\psi}{\\partial z^2} \\bigg|_{(i,j)} \\approx \\frac{\\psi_{i, j+1} - 2\\psi_{i,j} + \\psi_{i, j-1}}{(\\Delta z)^2}\n$$\nFor the radial part of the $\\Delta^*$ operator, we use a conservative finite difference scheme by evaluating the first derivative on a staggered grid. Let $u(R, z) = \\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}$. The operator term is $R \\frac{\\partial u}{\\partial R}$. We discretize this as:\n$$\nR \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) \\bigg|_{(i,j)} \\approx R_i \\frac{u_{i+1/2, j} - u_{i-1/2, j}}{\\Delta R}\n$$\nwhere $u$ is evaluated at the cell faces (half-integer indices):\n$$\nu_{i+1/2, j} \\approx \\frac{1}{R_{i+1/2}} \\left(\\frac{\\partial \\psi}{\\partial R}\\right)_{i+1/2, j} \\approx \\frac{1}{R_i + \\frac{\\Delta R}{2}} \\left( \\frac{\\psi_{i+1,j} - \\psi_{i,j}}{\\Delta R} \\right)\n$$\n$$\nu_{i-1/2, j} \\approx \\frac{1}{R_{i-1/2}} \\left(\\frac{\\partial \\psi}{\\partial R}\\right)_{i-1/2, j} \\approx \\frac{1}{R_i - \\frac{\\Delta R}{2}} \\left( \\frac{\\psi_{i,j} - \\psi_{i-1,j}}{\\Delta R} \\right)\n$$\nSubstituting these back, the radial operator at $(i,j)$ becomes:\n$$\n\\frac{R_i}{(\\Delta R)^2} \\left[ \\frac{1}{R_{i+1/2}}(\\psi_{i+1,j} - \\psi_{i,j}) - \\frac{1}{R_{i-1/2}}(\\psi_{i,j} - \\psi_{i-1,j}) \\right]\n$$\nThis can be expanded into the five-point stencil form relating $\\psi_{i,j}$ to its neighbors $\\psi_{i\\pm1, j}$ and $\\psi_{i, j\\pm1}$. Assembling all terms of the discretized PDE at point $(i,j)$:\n$$\n\\frac{R_i}{R_{i-1/2}(\\Delta R)^2} \\psi_{i-1,j} + \\frac{R_i}{R_{i+1/2}(\\Delta R)^2} \\psi_{i+1,j} + \\frac{1}{(\\Delta z)^2} \\psi_{i,j-1} + \\frac{1}{(\\Delta z)^2} \\psi_{i,j+1} \\\\\n- \\left[ \\frac{R_i}{(\\Delta R)^2}\\left(\\frac{1}{R_{i+1/2}} + \\frac{1}{R_{i-1/2}}\\right) + \\frac{2}{(\\Delta z)^2} - \\gamma^2 \\right] \\psi_{i,j} = \\frac{\\mu_0 p_0}{\\psi_a} R_i^2\n$$\nThis equation holds for each interior point, $i \\in \\{1, \\dots, N_R-2\\}$, $j \\in \\{1, \\dots, N_z-2\\}$. This set of equations forms a large, sparse linear system of the form $A \\mathbf{x} = \\mathbf{b}$, where $\\mathbf{x}$ is a vector of the unknown $\\psi_{i,j}$ values at all $(N_R-2) \\times (N_z-2)$ interior grid points. The matrix $A$ contains the finite-difference coefficients, and the vector $\\mathbf{b}$ contains the source terms.\n\nThe finite-difference coefficients for the stencil at point $(i,j)$ are:\n- West neighbor $(\\psi_{i-1,j})$: $C_W = \\frac{R_i}{(R_i - \\Delta R/2)(\\Delta R)^2}$\n- East neighbor $(\\psi_{i+1,j})$: $C_E = \\frac{R_i}{(R_i + \\Delta R/2)(\\Delta R)^2}$\n- South neighbor $(\\psi_{i,j-1})$: $C_S = \\frac{1}{(\\Delta z)^2}$\n- North neighbor $(\\psi_{i,j+1})$: $C_N = \\frac{1}{(\\Delta z)^2}$\n- Center point $(\\psi_{i,j})$: $C_P = - (C_W + C_E + C_S + C_N) + \\gamma^2$\n\nThe equation for node $(i,j)$ is $C_W \\psi_{i-1,j} + C_E \\psi_{i+1,j} + C_S \\psi_{i,j-1} + C_N \\psi_{i,j+1} + C_P \\psi_{i,j} = S_{i,j}$, where the source term is $S_{i,j} = \\frac{\\mu_0 p_0}{\\psi_a} R_i^2$. Because of the homogeneous Dirichlet boundary conditions ($\\psi = 0$ at all boundaries), terms involving boundary nodes are zero and do not contribute to the system, simplifying the assembly.\n\nWe map the 2D grid of interior unknowns $(i,j)$ to a 1D vector index $k$ using lexicographical ordering: $k = (i-1)(N_z-2) + (j-1)$. The matrix $A$ is constructed based on this mapping. For each $k$, the corresponding row in $A$ will have at most five non-zero entries (for the point itself and its four neighbors). The resulting matrix is pentadiagonal in a block sense, but not symmetric due to the $R$-dependent coefficients.\n\nThe system is solved using a direct sparse solver, specifically `scipy.sparse.linalg.spsolve`, which is efficient for this type of system. After obtaining the solution vector, it is reshaped back into a 2D array representing $\\psi_{i,j}$ on the interior grid. This is then embedded in a full grid with the zero boundaries.\n\nFinally, we compute the two requested verification metrics:\n$1$. The value of $\\psi$ at the grid point $(R_{i_c}, z_{j_c})$ closest to the geometric center $(R_c, z_c)$.\n$2$. The normalized residual $r = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2 / \\max\\{\\lVert \\mathbf{b} \\rVert_2, \\epsilon\\}$, where $\\mathbf{x}$ is the computed solution vector and $\\epsilon=10^{-16}$ is a small number to prevent division by zero in vacuum-like cases. This metric quantifies how well the numerical solution satisfies the discretized equations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\nfrom numpy.linalg import norm\n\ndef solve():\n    \"\"\"\n    Solves the Grad-Shafranov equation using the Finite Difference Method\n    for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general spheromak-like)\n        {'R_min': 0.2, 'R_max': 0.8, 'Z_max': 0.4, 'N_R': 81, 'N_z': 81, 'p0': 2000.0, 'psi_a': 0.5, 'gamma': 3.0},\n        # Case 2 (edge case with vanishing toroidal field function)\n        {'R_min': 0.05, 'R_max': 0.35, 'Z_max': 0.2, 'N_R': 61, 'N_z': 61, 'p0': 1500.0, 'psi_a': 0.3, 'gamma': 0.0},\n        # Case 3 (near-vacuum with strong F(psi))\n        {'R_min': 0.2, 'R_max': 1.0, 'Z_max': 0.6, 'N_R': 71, 'N_z': 91, 'p0': 1.0, 'psi_a': 1.0, 'gamma': 8.0},\n    ]\n\n    results = []\n    \n    # Physical constant mu_0 (permeability of free space)\n    mu_0 = 4.0 * np.pi * 1e-7\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        R_min, R_max = case['R_min'], case['R_max']\n        Z_max = case['Z_max']\n        N_R, N_z = case['N_R'], case['N_z']\n        p0, psi_a = case['p0'], case['psi_a']\n        gamma = case['gamma']\n        \n        # Grid setup\n        R = np.linspace(R_min, R_max, N_R)\n        Z = np.linspace(-Z_max, Z_max, N_z)\n        delta_R = (R_max - R_min) / (N_R - 1)\n        delta_z = (2 * Z_max) / (N_z - 1)\n        \n        # Number of interior points\n        N_R_int = N_R - 2\n        N_z_int = N_z - 2\n        num_unknowns = N_R_int * N_z_int\n\n        # Initialize sparse matrix A and source vector b\n        A = lil_matrix((num_unknowns, num_unknowns))\n        b = np.zeros(num_unknowns)\n\n        # Assemble the matrix A and vector b\n        for i in range(1, N_R - 1): # Radial index for full grid\n            for j in range(1, N_z - 1): # Axial index for full grid\n                \n                # Map 2D interior indices (i-1, j-1) to 1D vector index k\n                k = (i - 1) * N_z_int + (j - 1)\n\n                R_i = R[i]\n                R_half_minus = R_i - delta_R / 2.0\n                R_half_plus = R_i + delta_R / 2.0\n\n                # Calculate coefficients for the 5-point stencil\n                c_W = R_i / (R_half_minus * delta_R**2)\n                c_E = R_i / (R_half_plus * delta_R**2)\n                c_S = 1.0 / delta_z**2\n                c_N = 1.0 / delta_z**2\n                c_P = -(c_W + c_E + c_S + c_N) + gamma**2\n\n                # Set matrix coefficients\n                A[k, k] = c_P\n                \n                # Check neighbors and set off-diagonal elements\n                # West neighbor\n                if i > 1:\n                    A[k, k - N_z_int] = c_W\n                \n                # East neighbor\n                if i  N_R - 2:\n                    A[k, k + N_z_int] = c_E\n\n                # South neighbor\n                if j > 1:\n                    A[k, k - 1] = c_S\n\n                # North neighbor\n                if j  N_z - 2:\n                    A[k, k + 1] = c_N\n                \n                # Set source term for vector b\n                b[k] = (mu_0 * p0 / psi_a) * R_i**2\n\n        # Convert A to CSC format for efficient solving\n        A_csc = A.tocsc()\n\n        # Solve the linear system A*psi_vec = b\n        psi_vec = spsolve(A_csc, b)\n        \n        # --- Post-processing and Verification ---\n\n        # Calculate center value of psi\n        # The geometric center falls on a grid point for all test cases\n        i_c = (N_R - 1) // 2\n        j_c = (N_z - 1) // 2\n        k_c = (i_c - 1) * N_z_int + (j_c - 1)\n        psi_center = psi_vec[k_c]\n\n        # Calculate normalized residual\n        b_norm = norm(b)\n        residual = norm(A_csc @ psi_vec - b) / max(b_norm, 1e-16)\n\n        results.extend([round(psi_center, 6), round(residual, 6)])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond static equilibria, we must understand the dynamic processes that govern the formation and stability of compact toroids. Magnetic reconnection—the process by which magnetic field lines break and reconfigure—is fundamental to these phenomena. This practice explores the critical transition from slow, resistive reconnection to the fast reconnection observed in experiments, which is enabled by two-fluid physics. By calculating the dimensionless Hall parameter for hypothetical spheromak and FRC scenarios, you will gain insight into when and why Hall effects become dominant .",
            "id": "4046763",
            "problem": "Consider two compact toroidal fusion configurations operated with deuterium ions: a spheromak and a Field-Reversed Configuration (FRC). The spheromak has ion number density $n_i = 5.0 \\times 10^{19}\\ \\mathrm{m^{-3}}$ and a characteristic system size $L = 0.30\\ \\mathrm{m}$. The FRC has ion number density $n_i = 2.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$ and $L = 0.50\\ \\mathrm{m}$. Use the deuterium ion mass $m_i = 3.34 \\times 10^{-27}\\ \\mathrm{kg}$, elementary charge $e = 1.602 \\times 10^{-19}\\ \\mathrm{C}$, vacuum permittivity $\\epsilon_0 = 8.854 \\times 10^{-12}\\ \\mathrm{F/m}$, and speed of light $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$. The ion inertial length $d_i$ is related to the ion plasma frequency $\\omega_{pi}$ by elementary electrodynamics, and the non-dimensional Hall parameter $\\epsilon_H$ quantifies the relative importance of Hall physics by comparing an ion characteristic scale to the macroscopic device size.\n\nStarting from first principles, do the following for each device:\n- Derive and compute the ion inertial length $d_i$ from the given parameters.\n- Compute the non-dimensional Hall parameter $\\epsilon_H$ using your result for $d_i$ and the given $L$.\n- Using the generalized Ohm’s law and scale analysis, assess whether the reconnection rate is expected to show qualitative changes associated with Hall magnetohydrodynamics (MHD), such as weak dependence on the Lundquist number and the appearance of quadrupolar out-of-plane magnetic fields.\n\nSelect the option that most accurately reports the computed $d_i$ and $\\epsilon_H$ for the spheromak and FRC and provides the most consistent qualitative prediction for reconnection-rate behavior.\n\nA. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is dynamically important, enabling fast reconnection with weak Lundquist-number dependence and quadrupolar out-of-plane magnetic fields. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall corrections are modest, yielding some acceleration relative to resistive Magnetohydrodynamics (MHD) but weaker Hall signatures than in the spheromak.\n\nB. Spheromak: $d_i \\approx 0.46\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.015$; Hall physics is negligible, reconnection remains in the classical Sweet–Parker regime. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall physics is negligible; reconnection remains Sweet–Parker in both devices.\n\nC. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is negligible and reconnection is resistive. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; strong Hall reconnection dominates with signatures independent of the Lundquist number.\n\nD. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; strong Hall reconnection with quadrupolar magnetic fields. FRC: $d_i \\approx 7.0\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.14$; Hall physics equally strong as in the spheromak, implying similar fast-reconnection signatures.",
            "solution": "The problem requires the calculation of the ion inertial length $d_i$ and the non-dimensional Hall parameter $\\epsilon_H$ for two fusion devices, a spheromak and a Field-Reversed Configuration (FRC), followed by a qualitative assessment of the role of Hall physics in magnetic reconnection for each case.\n\nFirst, we establish the theoretical foundation from first principles as requested.\n\nThe ion plasma frequency, $\\omega_{pi}$, is a natural frequency of oscillation for ions in a plasma. For a plasma consisting of ions with number density $n_i$, mass $m_i$, and charge $Z e$ (where $Z$ is the charge number and $e$ is the elementary charge), the ion plasma frequency is given by:\n$$ \\omega_{pi} = \\sqrt{\\frac{n_i (Z e)^2}{\\epsilon_0 m_i}} $$\nThe problem specifies deuterium ions, for which the nucleus is a deuteron with charge number $Z=1$. Thus, the formula simplifies to:\n$$ \\omega_{pi} = \\sqrt{\\frac{n_i e^2}{\\epsilon_0 m_i}} $$\nwhere $\\epsilon_0$ is the vacuum permittivity.\n\nThe ion inertial length, $d_i$, also known as the ion skin depth, is the characteristic length scale over which deviations from plasma quasineutrality can occur due to ion inertia. It is defined in terms of the ion plasma frequency and the speed of light in vacuum, $c$, as:\n$$ d_i = \\frac{c}{\\omega_{pi}} $$\nSubstituting the expression for $\\omega_{pi}$, we obtain the formula for the ion inertial length:\n$$ d_i = c \\sqrt{\\frac{\\epsilon_0 m_i}{n_i e^2}} $$\nThis equation will be used for the calculations.\n\nThe non-dimensional Hall parameter, $\\epsilon_H$, is defined as the ratio of the ion inertial length $d_i$ to a characteristic macroscopic length scale of the system, $L$.\n$$ \\epsilon_H = \\frac{d_i}{L} $$\nThis parameter quantifies the importance of two-fluid effects, described by the Hall term in the generalized Ohm's law, relative to single-fluid magnetohydrodynamics (MHD). In the context of magnetic reconnection, when $d_i$ is comparable to the reconnection layer thickness, the dynamics change fundamentally from the slow, resistive Sweet-Parker model to a fast reconnection regime. A non-negligible value of $\\epsilon_H = d_i/L$ indicates that the system is large enough, in units of $d_i$, for Hall effects to be globally significant. A common rule of thumb is that for $\\epsilon_H \\gtrsim 0.1$, Hall physics becomes dynamically important, leading to fast reconnection rates that are weakly dependent on the plasma resistivity (and hence the Lundquist number, $S$), and the appearance of a characteristic quadrupolar out-of-plane magnetic field structure.\n\nThe given physical constants are:\n- Deuterium ion mass: $m_i = 3.34 \\times 10^{-27}\\ \\mathrm{kg}$\n- Elementary charge: $e = 1.602 \\times 10^{-19}\\ \\mathrm{C}$\n- Vacuum permittivity: $\\epsilon_0 = 8.854 \\times 10^{-12}\\ \\mathrm{F/m}$\n- Speed of light: $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$\n\nWe now proceed with the calculations for each device.\n\n**Spheromak Analysis**\nThe given parameters for the spheromak are:\n- Ion number density: $n_i = 5.0 \\times 10^{19}\\ \\mathrm{m^{-3}}$\n- Characteristic system size: $L = 0.30\\ \\mathrm{m}$\n\nFirst, we compute the ion inertial length $d_i$:\n$$ d_i = (2.998 \\times 10^8\\ \\mathrm{m/s}) \\sqrt{\\frac{(8.854 \\times 10^{-12}\\ \\mathrm{F/m}) (3.34 \\times 10^{-27}\\ \\mathrm{kg})}{(5.0 \\times 10^{19}\\ \\mathrm{m^{-3}}) (1.602 \\times 10^{-19}\\ \\mathrm{C})^2}} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{\\frac{2.957 \\times 10^{-38}}{1.283 \\times 10^{-18}}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{2.305 \\times 10^{-20}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) (1.518 \\times 10^{-10})\\ \\mathrm{m} $$\n$$ d_i \\approx 0.04551\\ \\mathrm{m} \\approx 4.55\\ \\mathrm{cm} $$\nRounding to two significant figures, we get $d_i \\approx 4.6\\ \\mathrm{cm}$.\n\nNext, we compute the Hall parameter $\\epsilon_H$:\n$$ \\epsilon_H = \\frac{d_i}{L} = \\frac{0.04551\\ \\mathrm{m}}{0.30\\ \\mathrm{m}} \\approx 0.1517 $$\nRounding to two significant figures, we get $\\epsilon_H \\approx 0.15$.\n\nWith $\\epsilon_H \\approx 0.15$, this value is significant and falls squarely in the regime where Hall physics is expected to dominate reconnection dynamics. Therefore, one expects to observe fast reconnection, a weak dependence of the reconnection rate on the Lundquist number, and the formation of quadrupolar out-of-plane magnetic fields.\n\n**Field-Reversed Configuration (FRC) Analysis**\nThe given parameters for the FRC are:\n- Ion number density: $n_i = 2.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$\n- Characteristic system size: $L = 0.50\\ \\mathrm{m}$\n\nFirst, we compute the ion inertial length $d_i$:\n$$ d_i = (2.998 \\times 10^8\\ \\mathrm{m/s}) \\sqrt{\\frac{(8.854 \\times 10^{-12}\\ \\mathrm{F/m}) (3.34 \\times 10^{-27}\\ \\mathrm{kg})}{(2.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) (1.602 \\times 10^{-19}\\ \\mathrm{C})^2}} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{\\frac{2.957 \\times 10^{-38}}{5.132 \\times 10^{-18}}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{0.5761 \\times 10^{-20}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) (0.7590 \\times 10^{-10})\\ \\mathrm{m} $$\n$$ d_i \\approx 0.02275\\ \\mathrm{m} \\approx 2.28\\ \\mathrm{cm} $$\nRounding to two significant figures, we get $d_i \\approx 2.3\\ \\mathrm{cm}$.\n\nNext, we compute the Hall parameter $\\epsilon_H$:\n$$ \\epsilon_H = \\frac{d_i}{L} = \\frac{0.02275\\ \\mathrm{m}}{0.50\\ \\mathrm{m}} \\approx 0.0455 $$\nRounding to two significant figures, we get $\\epsilon_H \\approx 0.046$.\n\nFor the FRC, $\\epsilon_H \\approx 0.046$. This value is smaller than that of the spheromak but is not negligible. It suggests a transitional regime where Hall effects are present and will likely lead to reconnection rates faster than predicted by resistive MHD. However, the signatures of Hall physics may be less pronounced than in the spheromak case. The term \"modest\" is an appropriate description for the role of Hall corrections.\n\n**Evaluation of Options**\n\nWe now evaluate each option based on our calculations and physical interpretation.\n\n**A. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is dynamically important, enabling fast reconnection with weak Lundquist-number dependence and quadrupolar out-of-plane magnetic fields. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall corrections are modest, yielding some acceleration relative to resistive Magnetohydrodynamics (MHD) but weaker Hall signatures than in the spheromak.**\n- **Spheromak**: The calculated values $d_i \\approx 4.6\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.15$ are correct. The physical interpretation is consistent with $\\epsilon_H \\approx 0.15$.\n- **FRC**: The calculated values $d_i \\approx 2.3\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.046$ are correct. The physical interpretation accurately describes a regime with \"modest\" Hall effects, which are weaker than in the spheromak case.\n- **Verdict**: Correct.\n\n**B. Spheromak: $d_i \\approx 0.46\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.015$; Hall physics is negligible, reconnection remains in the classical Sweet–Parker regime. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall physics is negligible; reconnection remains Sweet–Parker in both devices.**\n- **Spheromak**: The calculated value $d_i \\approx 0.46\\ \\mathrm{cm}$ is incorrect by a factor of $10$. Consequently, $\\epsilon_H$ is also incorrect. The interpretation is based on faulty numbers.\n- **FRC**: While the numerical values are correct, the interpretation that Hall physics is \"negligible\" is an oversimplification for $\\epsilon_H \\approx 0.046$.\n- **Verdict**: Incorrect.\n\n**C. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is negligible and reconnection is resistive. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; strong Hall reconnection dominates with signatures independent of the Lundquist number.**\n- **Spheromak**: The calculated values are correct, but the interpretation (\"Hall physics is negligible\") is fundamentally incorrect and contradicts the meaning of a large Hall parameter $\\epsilon_H \\approx 0.15$.\n- **FRC**: The calculated values are correct, but the interpretation (\"strong Hall reconnection dominates\") is an overstatement for $\\epsilon_H \\approx 0.046$ and incorrectly presents the FRC as being more dominated by Hall effects than the spheromak.\n- **Verdict**: Incorrect.\n\n**D. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; strong Hall reconnection with quadrupolar magnetic fields. FRC: $d_i \\approx 7.0\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.14$; Hall physics equally strong as in the spheromak, implying similar fast-reconnection signatures.**\n- **Spheromak**: The calculated values and interpretation are correct.\n- **FRC**: The calculated values $d_i \\approx 7.0\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.14$ are incorrect. Our calculation yields $d_i \\approx 2.3\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.046$. The interpretation is based on these faulty numbers.\n- **Verdict**: Incorrect.\n\nBased on this analysis, option A is the only one that provides both correct numerical results and a physically sound interpretation for both configurations.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Ultimately, the viability of any magnetic confinement concept for fusion energy depends on its ability to achieve and sustain high plasma temperatures. This is determined by the global power balance between heating sources and energy loss channels. This final practice addresses this crucial aspect by having you model a core element of plasma sustainment. By balancing ohmic heating against losses from radiation, you will derive an analytical expression for the steady-state electron temperature, providing a first-principles look at plasma performance .",
            "id": "4046754",
            "problem": "Consider a uniform, axisymmetric spheromak plasma in a magnetohydrodynamic (MHD) equilibrium, representative of self-organized magnetic configurations also encountered in Field-Reversed Configurations (FRCs). Assume the electron temperature $T_e$ and the electron and ion number densities, $n_e$ and $n_i$, are spatially uniform throughout the plasma volume $V$. The plasma is sustained by externally injected electrical power $P_{\\text{inj}}$ that ultimately enters the electron fluid via ohmic heating. The electron energy is lost via radiation. Ignore conductive and convective losses and any power transfer to ions, so that the electron energy balance is determined solely by ohmic heating and radiation.\n\nUse the following bases:\n- The electron energy evolution obeys $ \\frac{3}{2} n_e k_B V \\frac{d T_e}{d t} = P_{\\text{ohm}} - P_{\\text{rad}} $, where $k_B$ is the Boltzmann constant, $P_{\\text{ohm}}$ is the ohmic heating power, and $P_{\\text{rad}}$ is the total radiated power.\n- Ohmic heating follows $ P_{\\text{ohm}} = \\int_V \\eta(T_e)\\, |\\mathbf{J}|^2 \\, dV $, where $\\eta(T_e)$ is the electrical resistivity and $\\mathbf{J}$ is the current density. Assume the resistivity obeys the Spitzer law $ \\eta(T_e) = \\eta_0 T_e^{-3/2} $, with $\\eta_0$ a constant parameter that depends on the effective charge state and the Coulomb logarithm. Assume $P_{\\text{inj}} = P_{\\text{ohm}}$ in steady state.\n- For the radiated power, adopt a widely used two-term model combining free–free (bremsstrahlung) and effective line radiation from impurities: $ q_{\\text{rad}}(T_e) = C_b Z_{\\text{eff}} n_e^2 T_e^{1/2} + C_\\ell Z_{\\text{eff}} n_e n_i T_e^{-1/2} $, where $q_{\\text{rad}}$ is the volumetric power density, $C_b$ and $C_\\ell$ are known positive coefficients for bremsstrahlung and line radiation respectively (treated as constants), and $Z_{\\text{eff}}$ is the effective ion charge. The total radiated power is $ P_{\\text{rad}} = \\int_V q_{\\text{rad}} \\, dV = V q_{\\text{rad}}(T_e) $ due to uniformity.\n\nUnder these assumptions, derive from first principles the steady-state electron temperature $T_e$ as a closed-form analytic expression in terms of the injected power $P_{\\text{inj}}$, plasma volume $V$, electron and ion densities $n_e$ and $n_i$, radiation coefficients $C_b$ and $C_\\ell$, and $Z_{\\text{eff}}$. Make no small-parameter approximations beyond those already stated. Express the final temperature in Kelvin. Your final answer must be a single analytical expression for $T_e$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the steady-state electron temperature $T_e$ in a plasma where ohmic heating is balanced by radiation losses. The starting point is the electron energy evolution equation provided:\n$$\n\\frac{3}{2} n_e k_B V \\frac{d T_e}{d t} = P_{\\text{ohm}} - P_{\\text{rad}}\n$$\nHere, $n_e$ is the electron number density, $k_B$ is the Boltzmann constant, $V$ is the plasma volume, $T_e$ is the electron temperature, $P_{\\text{ohm}}$ is the ohmic heating power, and $P_{\\text{rad}}$ is the total radiated power.\n\nFor a steady-state solution, the electron temperature does not change with time, which implies that $\\frac{d T_e}{d t} = 0$. Applying this condition to the energy evolution equation yields the steady-state power balance equation:\n$$\nP_{\\text{ohm}} = P_{\\text{rad}}\n$$\nThe problem states that in steady state, the externally injected power $P_{\\text{inj}}$ is equal to the ohmic heating power absorbed by the plasma, so $P_{\\text{inj}} = P_{\\text{ohm}}$. Therefore, the power balance becomes:\n$$\nP_{\\text{inj}} = P_{\\text{rad}}\n$$\nThe total radiated power $P_{\\text{rad}}$ is given by the integral of the volumetric radiated power density $q_{\\text{rad}}$ over the plasma volume $V$. Since the plasma properties are assumed to be uniform, this integral simplifies to $P_{\\text{rad}} = V q_{\\text{rad}}(T_e)$. The provided model for $q_{\\text{rad}}(T_e)$ is:\n$$\nq_{\\text{rad}}(T_e) = C_b Z_{\\text{eff}} n_e^2 T_e^{1/2} + C_\\ell Z_{\\text{eff}} n_e n_i T_e^{-1/2}\n$$\nwhere $C_b$ and $C_\\ell$ are coefficients for bremsstrahlung and line radiation, respectively, $Z_{\\text{eff}}$ is the effective ion charge, and $n_i$ is the ion number density.\n\nSubstituting the expression for $P_{\\text{rad}}$ into the power balance equation, we get:\n$$\nP_{\\text{inj}} = V \\left( C_b Z_{\\text{eff}} n_e^2 T_e^{1/2} + C_\\ell Z_{\\text{eff}} n_e n_i T_e^{-1/2} \\right)\n$$\nOur goal is to solve this equation for $T_e$. To simplify the algebra, let us introduce a new variable $x = T_e^{1/2}$. Since temperature $T_e$ must be positive, $x$ must also be a positive real number. The equation in terms of $x$ is:\n$$\nP_{\\text{inj}} = V \\left( C_b Z_{\\text{eff}} n_e^2 x + C_\\ell Z_{\\text{eff}} n_e n_i \\frac{1}{x} \\right)\n$$\nTo eliminate the $1/x$ term, we multiply the entire equation by $x$ and rearrange it into a standard quadratic form $ax^2+bx+c=0$:\n$$\nP_{\\text{inj}} x = V \\left( C_b Z_{\\text{eff}} n_e^2 x^2 + C_\\ell Z_{\\text{eff}} n_e n_i \\right)\n$$\n$$\n(V C_b Z_{\\text{eff}} n_e^2) x^2 - P_{\\text{inj}} x + (V C_\\ell Z_{\\text{eff}} n_e n_i) = 0\n$$\nThis is a quadratic equation for $x = T_e^{1/2}$. The coefficients are:\n$a = V C_b Z_{\\text{eff}} n_e^2$\n$b = -P_{\\text{inj}}$\n$c = V C_\\ell Z_{\\text{eff}} n_e n_i$\n\nThe solutions for $x$ are given by the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nx = \\frac{P_{\\text{inj}} \\pm \\sqrt{(-P_{\\text{inj}})^2 - 4 (V C_b Z_{\\text{eff}} n_e^2)(V C_\\ell Z_{\\text{eff}} n_e n_i)}}{2 (V C_b Z_{\\text{eff}} n_e^2)}\n$$\nSimplifying the expression under the square root:\n$$\nx = \\frac{P_{\\text{inj}} \\pm \\sqrt{P_{\\text{inj}}^2 - 4 V^2 C_b C_\\ell Z_{\\text{eff}}^2 n_e^3 n_i}}{2 V C_b Z_{\\text{eff}} n_e^2}\n$$\nThis yields two possible real solutions for $x$ (and thus for $T_e$), provided the discriminant is non-negative ($P_{\\text{inj}}^2 \\ge 4 V^2 C_b C_\\ell Z_{\\text{eff}}^2 n_e^3 n_i$). The two solutions correspond to two different temperature equilibria. One is on the low-temperature side of the radiation curve where line radiation dominates, and the other is on the high-temperature side where bremsstrahlung dominates. A thermal stability analysis shows that for a small increase in temperature, the radiated power must also increase to radiate away the excess energy. This condition, $\\frac{dP_{\\text{rad}}}{dT_e} > 0$, is only met by the higher-temperature solution. Therefore, the physically stable steady-state solution corresponds to the larger of the two roots for $x$, which is obtained by taking the '$+$' sign in the numerator.\n\nWe thus select the physically meaningful solution for $x = T_e^{1/2}$:\n$$\nT_e^{1/2} = \\frac{P_{\\text{inj}} + \\sqrt{P_{\\text{inj}}^2 - 4 V^2 C_b C_\\ell Z_{\\text{eff}}^2 n_e^3 n_i}}{2 V C_b Z_{\\text{eff}} n_e^2}\n$$\nTo find the final expression for the electron temperature $T_e$, we square both sides of the equation:\n$$\nT_e = \\left( \\frac{P_{\\text{inj}} + \\sqrt{P_{\\text{inj}}^2 - 4 V^2 C_b C_\\ell Z_{\\text{eff}}^2 n_e^3 n_i}}{2 V C_b Z_{\\text{eff}} n_e^2} \\right)^2\n$$\nThis is the closed-form analytic expression for the steady-state electron temperature in terms of the given parameters. The unit of temperature resulting from this expression will be Kelvin, provided all input parameters are in a consistent set of units (e.g., SI units).",
            "answer": "$$\n\\boxed{T_e = \\left( \\frac{P_{\\text{inj}} + \\sqrt{P_{\\text{inj}}^2 - 4 V^2 C_b C_\\ell Z_{\\text{eff}}^2 n_e^3 n_i}}{2 V C_b Z_{\\text{eff}} n_e^2} \\right)^2}\n$$"
        }
    ]
}