{
    "hands_on_practices": [
        {
            "introduction": "The fundamental magnetic structure of axisymmetric plasmas like spheromaks and Field-Reversed Configurations (FRCs) is described by the Grad-Shafranov equation, which represents the magnetohydrodynamic (MHD) force balance. Solving this equation yields the poloidal magnetic flux function, $\\psi$, whose contours define the nested magnetic surfaces that confine the plasma. This computational exercise is foundational, providing direct experience in numerically solving the core equation that governs MHD equilibrium in these important fusion concepts. ",
            "id": "4046757",
            "problem": "Consider axisymmetric magnetohydrodynamic (MHD) equilibria in cylindrical coordinates with radial coordinate $R$ and axial coordinate $z$. Let the poloidal flux function be $\\psi(R,z)$, the pressure be $p(\\psi) = p_0 \\left(1 - \\psi / \\psi_a\\right)$, and the toroidal field function be $F(\\psi) = \\gamma \\psi$, where $p_0$ is a positive constant with units pascal ($\\mathrm{Pa}$), $\\psi_a$ is a positive constant with units weber ($\\mathrm{Wb}$), and $\\gamma$ is a positive constant with units $\\mathrm{m}^{-1}$. The magnetostatic equilibrium is governed by the Grad–Shafranov equation,\n$$\n\\Delta^* \\psi = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi},\n$$\nwhere $\\mu_0$ is the permeability of free space with value $\\mu_0 = 4 \\pi \\times 10^{-7} \\ \\mathrm{H/m}$, and the elliptic operator is\n$$\n\\Delta^* \\psi = R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2}.\n$$\nStarting from these definitions and laws, derive the form of the elliptic operator in conservative form appropriate for a rectangular grid in $(R,z)$, and compute the corresponding finite-difference coefficients for a five-point stencil on a uniform grid with spacings $\\Delta R$ and $\\Delta z$. Use homogeneous Dirichlet boundary conditions $\\psi = 0$ on all boundaries of the rectangular computational domain. Your derivation should begin from the Grad–Shafranov equation and express all mathematical steps explicitly.\n\nFormulate a numerical scheme based on the Finite Difference Method (FDM) to solve for $\\psi(R,z)$ in a rectangular domain with $R \\in [R_{\\min}, R_{\\max}]$ and $z \\in [-Z_{\\max}, Z_{\\max}]$. Discretize with $N_R$ uniformly spaced radial points and $N_z$ uniformly spaced axial points, including boundaries. Assemble the resulting sparse linear system in the interior unknowns only and solve it using a direct sparse solver. The right-hand side source term must be derived and consistently discretized. Use only physically plausible parameters, and ensure your implementation is self-contained and numerically stable.\n\nImplement the scheme in a complete, runnable program. For verification, compute for each test case:\n- The numerical value of $\\psi$ at the grid point closest to the geometric center $(R_c, z_c)$, where $R_c = (R_{\\min} + R_{\\max})/2$ and $z_c = 0$. Express this value in weber ($\\mathrm{Wb}$), rounded to six decimal places.\n- The normalized residual defined as $\\lVert A \\psi - b \\rVert_2 / \\max\\{\\lVert b \\rVert_2, \\epsilon\\}$ with $\\epsilon = 10^{-16}$, rounded to six decimal places. Treat the residual as dimensionless.\n\nTest Suite:\n- Case 1 (general spheromak-like): $R_{\\min} = 0.2 \\ \\mathrm{m}$, $R_{\\max} = 0.8 \\ \\mathrm{m}$, $Z_{\\max} = 0.4 \\ \\mathrm{m}$, $N_R = 81$, $N_z = 81$, $p_0 = 2000 \\ \\mathrm{Pa}$, $\\psi_a = 0.5 \\ \\mathrm{Wb}$, $\\gamma = 3 \\ \\mathrm{m}^{-1}$.\n- Case 2 (edge case with vanishing toroidal field function): $R_{\\min} = 0.05 \\ \\mathrm{m}$, $R_{\\max} = 0.35 \\ \\mathrm{m}$, $Z_{\\max} = 0.2 \\ \\mathrm{m}$, $N_R = 61$, $N_z = 61$, $p_0 = 1500 \\ \\mathrm{Pa}$, $\\psi_a = 0.3 \\ \\mathrm{Wb}$, $\\gamma = 0 \\ \\mathrm{m}^{-1}$.\n- Case 3 (near-vacuum with strong $F(\\psi)$): $R_{\\min} = 0.2 \\ \\mathrm{m}$, $R_{\\max} = 1.0 \\ \\mathrm{m}$, $Z_{\\max} = 0.6 \\ \\mathrm{m}$, $N_R = 71$, $N_z = 91$, $p_0 = 1 \\ \\mathrm{Pa}$, $\\psi_a = 1.0 \\ \\mathrm{Wb}$, $\\gamma = 8 \\ \\mathrm{m}^{-1}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order: $[\\psi_{c,1}, r_1, \\psi_{c,2}, r_2, \\psi_{c,3}, r_3]$, where $\\psi_{c,i}$ is the center value of $\\psi$ in $\\mathrm{Wb}$ for case $i$ rounded to six decimal places, and $r_i$ is the normalized residual for case $i$ rounded to six decimal places.",
            "solution": "The problem is valid as it is scientifically grounded in magnetohydrodynamics, mathematically well-posed as a linear elliptic partial differential equation with specified boundary conditions, and provides a complete and consistent set of parameters for a numerical solution. The task is non-trivial and verifiable.\n\nThe analysis begins with the Grad–Shafranov equation given as\n$$\n\\Delta^* \\psi = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi}\n$$\nwhere the elliptic operator is\n$$\n\\Delta^* \\psi = R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2}\n$$\nThe pressure $p(\\psi)$ and toroidal field function $F(\\psi)$ are given by\n$$\np(\\psi) = p_0 \\left(1 - \\frac{\\psi}{\\psi_a}\\right) \\quad \\text{and} \\quad F(\\psi) = \\gamma \\psi\n$$\nFirst, we compute the derivatives required for the source term on the right-hand side (RHS) of the Grad–Shafranov equation.\n$$\n\\frac{dp}{d\\psi} = \\frac{d}{d\\psi} \\left[ p_0 \\left(1 - \\frac{\\psi}{\\psi_a}\\right) \\right] = -\\frac{p_0}{\\psi_a}\n$$\n$$\n\\frac{dF}{d\\psi} = \\frac{d}{d\\psi} (\\gamma \\psi) = \\gamma\n$$\nSubstituting these expressions into the RHS gives\n$$\n- \\mu_0 R^2 \\left(-\\frac{p_0}{\\psi_a}\\right) - (\\gamma \\psi)(\\gamma) = \\frac{\\mu_0 p_0}{\\psi_a} R^2 - \\gamma^2 \\psi\n$$\nThe Grad–Shafranov equation is therefore a linear, inhomogeneous, second-order partial differential equation in $\\psi(R,z)$. We can rearrange it into the form of a Helmholtz-type equation:\n$$\n\\Delta^* \\psi + \\gamma^2 \\psi = \\frac{\\mu_0 p_0}{\\psi_a} R^2\n$$\nor, expanding the operator,\n$$\nR \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial z^2} + \\gamma^2 \\psi = \\frac{\\mu_0 p_0}{\\psi_a} R^2\n$$\nWe solve this equation on a rectangular domain $R \\in [R_{\\min}, R_{\\max}]$ and $z \\in [-Z_{\\max}, Z_{\\max}]$ with homogeneous Dirichlet boundary conditions, $\\psi=0$, on all boundaries.\n\nTo solve this numerically, we employ the Finite Difference Method (FDM) on a uniform Cartesian grid. The domain is discretized with $N_R$ points in the radial direction and $N_z$ points in the axial direction. The grid points are $(R_i, z_j)$ where\n$$\nR_i = R_{\\min} + i \\Delta R, \\quad i \\in \\{0, 1, \\dots, N_R-1\\}\n$$\n$$\nz_j = -Z_{\\max} + j \\Delta z, \\quad j \\in \\{0, 1, \\dots, N_z-1\\}\n$$\nThe uniform grid spacings are\n$$\n\\Delta R = \\frac{R_{\\max} - R_{\\min}}{N_R-1}, \\quad \\Delta z = \\frac{2 Z_{\\max}}{N_z-1}\n$$\nLet $\\psi_{i,j}$ denote the numerical approximation of $\\psi(R_i, z_j)$. We use second-order central differences to approximate the partial derivatives at an interior grid point $(i,j)$, where $1 \\le i \\le N_R-2$ and $1 \\le j \\le N_z-2$.\n\nThe axial second derivative is approximated as:\n$$\n\\frac{\\partial^2 \\psi}{\\partial z^2} \\bigg|_{(i,j)} \\approx \\frac{\\psi_{i, j+1} - 2\\psi_{i,j} + \\psi_{i, j-1}}{(\\Delta z)^2}\n$$\nFor the radial part of the $\\Delta^*$ operator, we use a conservative finite difference scheme by evaluating the first derivative on a staggered grid. Let $u(R, z) = \\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}$. The operator term is $R \\frac{\\partial u}{\\partial R}$. We discretize this as:\n$$\nR \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) \\bigg|_{(i,j)} \\approx R_i \\frac{u_{i+1/2, j} - u_{i-1/2, j}}{\\Delta R}\n$$\nwhere $u$ is evaluated at the cell faces (half-integer indices):\n$$\nu_{i+1/2, j} \\approx \\frac{1}{R_{i+1/2}} \\left(\\frac{\\partial \\psi}{\\partial R}\\right)_{i+1/2, j} \\approx \\frac{1}{R_i + \\frac{\\Delta R}{2}} \\left( \\frac{\\psi_{i+1,j} - \\psi_{i,j}}{\\Delta R} \\right)\n$$\n$$\nu_{i-1/2, j} \\approx \\frac{1}{R_{i-1/2}} \\left(\\frac{\\partial \\psi}{\\partial R}\\right)_{i-1/2, j} \\approx \\frac{1}{R_i - \\frac{\\Delta R}{2}} \\left( \\frac{\\psi_{i,j} - \\psi_{i-1,j}}{\\Delta R} \\right)\n$$\nSubstituting these back, the radial operator at $(i,j)$ becomes:\n$$\n\\frac{R_i}{(\\Delta R)^2} \\left[ \\frac{1}{R_{i+1/2}}(\\psi_{i+1,j} - \\psi_{i,j}) - \\frac{1}{R_{i-1/2}}(\\psi_{i,j} - \\psi_{i-1,j}) \\right]\n$$\nThis can be expanded into the five-point stencil form relating $\\psi_{i,j}$ to its neighbors $\\psi_{i\\pm1, j}$ and $\\psi_{i, j\\pm1}$. Assembling all terms of the discretized PDE at point $(i,j)$:\n$$\n\\frac{R_i}{R_{i-1/2}(\\Delta R)^2} \\psi_{i-1,j} + \\frac{R_i}{R_{i+1/2}(\\Delta R)^2} \\psi_{i+1,j} + \\frac{1}{(\\Delta z)^2} \\psi_{i,j-1} + \\frac{1}{(\\Delta z)^2} \\psi_{i,j+1} \\\\\n- \\left[ \\frac{R_i}{(\\Delta R)^2}\\left(\\frac{1}{R_{i+1/2}} + \\frac{1}{R_{i-1/2}}\\right) + \\frac{2}{(\\Delta z)^2} - \\gamma^2 \\right] \\psi_{i,j} = \\frac{\\mu_0 p_0}{\\psi_a} R_i^2\n$$\nThis equation holds for each interior point, $i \\in \\{1, \\dots, N_R-2\\}$, $j \\in \\{1, \\dots, N_z-2\\}$. This set of equations forms a large, sparse linear system of the form $A \\mathbf{x} = \\mathbf{b}$, where $\\mathbf{x}$ is a vector of the unknown $\\psi_{i,j}$ values at all $(N_R-2) \\times (N_z-2)$ interior grid points. The matrix $A$ contains the finite-difference coefficients, and the vector $\\mathbf{b}$ contains the source terms.\n\nThe finite-difference coefficients for the stencil at point $(i,j)$ are:\n- West neighbor $(\\psi_{i-1,j})$: $C_W = \\frac{R_i}{(R_i - \\Delta R/2)(\\Delta R)^2}$\n- East neighbor $(\\psi_{i+1,j})$: $C_E = \\frac{R_i}{(R_i + \\Delta R/2)(\\Delta R)^2}$\n- South neighbor $(\\psi_{i,j-1})$: $C_S = \\frac{1}{(\\Delta z)^2}$\n- North neighbor $(\\psi_{i,j+1})$: $C_N = \\frac{1}{(\\Delta z)^2}$\n- Center point $(\\psi_{i,j})$: $C_P = - (C_W + C_E + C_S + C_N) + \\gamma^2$\n\nThe equation for node $(i,j)$ is $C_W \\psi_{i-1,j} + C_E \\psi_{i+1,j} + C_S \\psi_{i,j-1} + C_N \\psi_{i,j+1} + C_P \\psi_{i,j} = S_{i,j}$, where the source term is $S_{i,j} = \\frac{\\mu_0 p_0}{\\psi_a} R_i^2$. Because of the homogeneous Dirichlet boundary conditions ($\\psi = 0$ at all boundaries), terms involving boundary nodes are zero and do not contribute to the system, simplifying the assembly.\n\nWe map the 2D grid of interior unknowns $(i,j)$ to a 1D vector index $k$ using lexicographical ordering: $k = (i-1)(N_z-2) + (j-1)$. The matrix $A$ is constructed based on this mapping. For each $k$, the corresponding row in $A$ will have at most five non-zero entries (for the point itself and its four neighbors). The resulting matrix is pentadiagonal in a block sense, but not symmetric due to the $R$-dependent coefficients.\n\nThe system is solved using a direct sparse solver, specifically `scipy.sparse.linalg.spsolve`, which is efficient for this type of system. After obtaining the solution vector, it is reshaped back into a 2D array representing $\\psi_{i,j}$ on the interior grid. This is then embedded in a full grid with the zero boundaries.\n\nFinally, we compute the two requested verification metrics:\n$1$. The value of $\\psi$ at the grid point $(R_{i_c}, z_{j_c})$ closest to the geometric center $(R_c, z_c)$.\n$2$. The normalized residual $r = \\lVert A \\mathbf{x} - \\mathbf{b} \\rVert_2 / \\max\\{\\lVert \\mathbf{b} \\rVert_2, \\epsilon\\}$, where $\\mathbf{x}$ is the computed solution vector and $\\epsilon=10^{-16}$ is a small number to prevent division by zero in vacuum-like cases. This metric quantifies how well the numerical solution satisfies the discretized equations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\nfrom numpy.linalg import norm\n\ndef solve():\n    \"\"\"\n    Solves the Grad-Shafranov equation using the Finite Difference Method\n    for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general spheromak-like)\n        {'R_min': 0.2, 'R_max': 0.8, 'Z_max': 0.4, 'N_R': 81, 'N_z': 81, 'p0': 2000.0, 'psi_a': 0.5, 'gamma': 3.0},\n        # Case 2 (edge case with vanishing toroidal field function)\n        {'R_min': 0.05, 'R_max': 0.35, 'Z_max': 0.2, 'N_R': 61, 'N_z': 61, 'p0': 1500.0, 'psi_a': 0.3, 'gamma': 0.0},\n        # Case 3 (near-vacuum with strong F(psi))\n        {'R_min': 0.2, 'R_max': 1.0, 'Z_max': 0.6, 'N_R': 71, 'N_z': 91, 'p0': 1.0, 'psi_a': 1.0, 'gamma': 8.0},\n    ]\n\n    results = []\n    \n    # Physical constant mu_0 (permeability of free space)\n    mu_0 = 4.0 * np.pi * 1e-7\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        R_min, R_max = case['R_min'], case['R_max']\n        Z_max = case['Z_max']\n        N_R, N_z = case['N_R'], case['N_z']\n        p0, psi_a = case['p0'], case['psi_a']\n        gamma = case['gamma']\n        \n        # Grid setup\n        R = np.linspace(R_min, R_max, N_R)\n        Z = np.linspace(-Z_max, Z_max, N_z)\n        delta_R = (R_max - R_min) / (N_R - 1)\n        delta_z = (2 * Z_max) / (N_z - 1)\n        \n        # Number of interior points\n        N_R_int = N_R - 2\n        N_z_int = N_z - 2\n        num_unknowns = N_R_int * N_z_int\n\n        # Initialize sparse matrix A and source vector b\n        A = lil_matrix((num_unknowns, num_unknowns))\n        b = np.zeros(num_unknowns)\n\n        # Assemble the matrix A and vector b\n        for i in range(1, N_R - 1): # Radial index for full grid\n            for j in range(1, N_z - 1): # Axial index for full grid\n                \n                # Map 2D interior indices (i-1, j-1) to 1D vector index k\n                k = (i - 1) * N_z_int + (j - 1)\n\n                R_i = R[i]\n                R_half_minus = R_i - delta_R / 2.0\n                R_half_plus = R_i + delta_R / 2.0\n\n                # Calculate coefficients for the 5-point stencil\n                c_W = R_i / (R_half_minus * delta_R**2)\n                c_E = R_i / (R_half_plus * delta_R**2)\n                c_S = 1.0 / delta_z**2\n                c_N = 1.0 / delta_z**2\n                c_P = -(c_W + c_E + c_S + c_N) + gamma**2\n\n                # Set matrix coefficients\n                A[k, k] = c_P\n                \n                # Check neighbors and set off-diagonal elements\n                # West neighbor\n                if i > 1:\n                    A[k, k - N_z_int] = c_W\n                \n                # East neighbor\n                if i < N_R - 2:\n                    A[k, k + N_z_int] = c_E\n\n                # South neighbor\n                if j > 1:\n                    A[k, k - 1] = c_S\n\n                # North neighbor\n                if j < N_z - 2:\n                    A[k, k + 1] = c_N\n                \n                # Set source term for vector b\n                b[k] = (mu_0 * p0 / psi_a) * R_i**2\n\n        # Convert A to CSC format for efficient solving\n        A_csc = A.tocsc()\n\n        # Solve the linear system A*psi_vec = b\n        psi_vec = spsolve(A_csc, b)\n        \n        # --- Post-processing and Verification ---\n\n        # Calculate center value of psi\n        # The geometric center falls on a grid point for all test cases\n        i_c = (N_R - 1) // 2\n        j_c = (N_z - 1) // 2\n        k_c = (i_c - 1) * N_z_int + (j_c - 1)\n        psi_center = psi_vec[k_c]\n\n        # Calculate normalized residual\n        b_norm = norm(b)\n        residual = norm(A_csc @ psi_vec - b) / max(b_norm, 1e-16)\n\n        results.extend([round(psi_center, 6), round(residual, 6)])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Effective plasma confinement in many spheromak designs relies on a close-fitting, perfectly conducting shell, which dictates that the normal component of the magnetic field must vanish at the wall, i.e., $\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$. This practice explores the method of images, an elegant and powerful boundary-integral technique for enforcing such boundary conditions in magnetostatic problems. Implementing this method provides concrete insight into how idealized boundary conditions are realized numerically and how they shape the confining magnetic field. ",
            "id": "4046776",
            "problem": "You are tasked with formulating and implementing a boundary-integral method that enforces the perfect-conductor condition for a simplified model of a spheromak equilibrium surrounded by a perfectly conducting circular shell. Work in a two-dimensional cross-section orthogonal to the symmetry axis and model the spheromak’s toroidal current distribution as a finite set of infinitely long, straight current filaments aligned with the symmetry axis (out of the plane). Use the magnetostatic limit of Maxwell’s equations and adopt normalized, dimensionless units in which the vacuum permeability is set to unity. All angles must be treated in radians, and all outputs must be dimensionless real numbers.\n\nFundamental base:\n- Magnetostatics: from Maxwell’s equations, use $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$, $\\nabla \\cdot \\mathbf{B} = 0$, and represent $\\mathbf{B} = \\nabla \\times \\mathbf{A}$.\n- In a two-dimensional $x$–$y$ plane with current density $\\mathbf{J} = J_z(x,y)\\,\\hat{\\mathbf{z}}$ and vector potential $\\mathbf{A} = A_z(x,y)\\,\\hat{\\mathbf{z}}$, the scalar potential $A_z$ satisfies the Poisson equation $\\nabla^2 A_z = -\\mu_0 J_z$ and $\\mathbf{B}(x,y) = \\hat{\\mathbf{z}} \\times \\nabla A_z(x,y)$.\n- In ideal Magnetohydrodynamics (MHD), a perfectly conducting wall enforces that the normal magnetic field vanishes at the wall, i.e., $\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$ on the boundary. For the two-dimensional formulation above, this is equivalent to $A_z = \\text{constant}$ along the boundary.\n\nYou will use a boundary-integral method built from the free-space Green’s function for two-dimensional Poisson equations, specialized to a circular boundary (a conducting shell) of radius $R$. For a set of $N$ filamentary currents at positions $\\mathbf{r}_i = (x_i, y_i)$ with strengths $I_i$ (all along $+\\hat{\\mathbf{z}}$), the free-space scalar potential is\n$$\nA_z(\\mathbf{r}) = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi} \\ln \\left\\|\\mathbf{r} - \\mathbf{r}_i\\right\\|,\n$$\nwhich yields the magnetic field\n$$\n\\mathbf{B}(\\mathbf{r}) = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi}\\, \\frac{\\hat{\\mathbf{z}} \\times (\\mathbf{r} - \\mathbf{r}_i)}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2}.\n$$\nTo enforce the perfect-conductor boundary condition on the circle $\\|\\mathbf{r}\\|=R$, use image currents: for each interior filament at $\\mathbf{r}_i$ place an image filament at\n$$\n\\mathbf{r}_i^\\ast = \\frac{R^2}{\\|\\mathbf{r}_i\\|^2}\\,\\mathbf{r}_i\n$$\nwith current $I_i^\\ast = -I_i$. The resulting scalar potential\n$$\nA_z^{\\text{img}}(\\mathbf{r}) = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi} \\left[ \\ln \\left\\|\\mathbf{r} - \\mathbf{r}_i\\right\\| - \\ln \\left\\|\\mathbf{r} - \\mathbf{r}_i^\\ast\\right\\| \\right]\n$$\nis constant on $\\|\\mathbf{r}\\|=R$, which implies $\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$ on the boundary. You are to demonstrate this numerically by evaluating the normal component of the magnetic field on the boundary with and without image currents.\n\nYour program must:\n1) Implement the normal component of the magnetic field $\\mathbf{B}\\cdot \\hat{\\mathbf{n}}$ on the circular wall of radius $R$ from a set of $N$ straight filaments with currents $I_i$ at locations $\\mathbf{r}_i$, for two cases: free-space (no image currents) and image currents added as defined above.\n2) Sample the wall at $M$ uniformly spaced points $\\mathbf{r}(\\theta_k) = R(\\cos\\theta_k,\\sin\\theta_k)$ with $\\theta_k = 2\\pi k/M$ for $k=0,\\dots,M-1$ and $\\hat{\\mathbf{n}}(\\theta_k) = (\\cos\\theta_k,\\sin\\theta_k)$.\n3) Compute the maximum absolute violation of the boundary condition, $\\max_k |\\mathbf{B}(\\mathbf{r}(\\theta_k))\\cdot \\hat{\\mathbf{n}}(\\theta_k)|$, for both the free-space and the image-current cases.\n\nTest suite:\nUse $M=2048$ boundary samples (angles in radians), $\\mu_0=1$, and the following four test cases. All quantities are dimensionless.\n\n- Case 1 (single off-center filament):\n  - $R = 1.0$\n  - Filaments: one filament with $I_1 = 1.0$ at $(x_1,y_1)=(0.3,0.0)$.\n\n- Case 2 (two off-axis filaments):\n  - $R = 1.0$\n  - Filaments: two filaments with $I_1 = 0.8$ at $(0.4,0.2)$ and $I_2 = 0.8$ at $(-0.4,0.2)$.\n\n- Case 3 (four-fold symmetric configuration):\n  - $R = 1.0$\n  - Filaments: four filaments with $I=0.5$ at $(0.5,0)$, $(0,-0.5)$, $(-0.5,0)$, and $(0,0.5)$.\n\n- Case 4 (near-wall filament):\n  - $R = 1.0$\n  - Filaments: one filament with $I_1 = 1.0$ at $(x_1,y_1)=(0.9,0.0)$.\n\nFor each case, compute two floats:\n- $V_{\\text{free}}$: the maximum absolute normal component on the wall without images.\n- $V_{\\text{image}}$: the maximum absolute normal component on the wall with image currents added.\n\nFinal output format:\nYour program should produce a single line of output containing the eight results in order, as a comma-separated list enclosed in square brackets:\n[Case1_V_free,Case1_V_image,Case2_V_free,Case2_V_image,Case3_V_free,Case3_V_image,Case4_V_free,Case4_V_image]\nAll values must be printed as decimal floats rounded to eight significant digits. Since all quantities are dimensionless, do not include any physical units in the output.",
            "solution": "The problem requires the formulation and implementation of a boundary-integral method to verify the perfect conductor boundary condition, $\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$, for a 2D magnetostatic system. The system consists of a set of infinitely long, straight current filaments, representing a simplified spheromak, enclosed by a perfectly conducting circular shell. We will compute the maximum normal magnetic field on the shell boundary for two scenarios: one with only the source filaments (free-space) and another where image currents are added to enforce the boundary condition.\n\nThe analysis is performed in a 2D Cartesian coordinate system $(x,y)$ within the magnetostatic limit, using normalized units where the vacuum permeability $\\mu_0$ is set to $1$.\n\nA single filament of current $I_s$ oriented along the $\\hat{\\mathbf{z}}$-axis at position $\\mathbf{r}_s = (x_s, y_s)$ generates a magnetic field in the $x-y$ plane given by:\n$$\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_0 I_s}{2\\pi} \\frac{\\hat{\\mathbf{z}} \\times (\\mathbf{r} - \\mathbf{r}_s)}{\\|\\mathbf{r} - \\mathbf{r}_s\\|^2}\n$$\nHere, $\\mathbf{r} = (x, y)$ is the observation point. The vector cross product expands to $\\hat{\\mathbf{z}} \\times (\\mathbf{r} - \\mathbf{r}_s) = (-(y - y_s), x - x_s, 0)$. Thus, the magnetic field vector is:\n$$\n\\mathbf{B}(x, y) = \\frac{\\mu_0 I_s}{2\\pi} \\frac{(-(y - y_s), x - x_s)}{(x - x_s)^2 + (y - y_s)^2}\n$$\n\nWe are interested in the component of this field that is normal to the circular conducting shell of radius $R$. A point on the shell can be parameterized by an angle $\\theta$ as $\\mathbf{r}(\\theta) = (R\\cos\\theta, R\\sin\\theta)$. The outward unit normal vector at this point is $\\hat{\\mathbf{n}}(\\theta) = (\\cos\\theta, \\sin\\theta)$, which is equivalent to $\\mathbf{r}/R$.\n\nThe normal component of the magnetic field, $\\mathbf{B} \\cdot \\hat{\\mathbf{n}}$, at a point $\\mathbf{r}$ on the boundary is calculated by the dot product:\n$$\n\\mathbf{B}(\\mathbf{r}) \\cdot \\hat{\\mathbf{n}} = \\frac{\\mu_0 I_s}{2\\pi} \\frac{(-(y - y_s), x - x_s)}{(x - x_s)^2 + (y - y_s)^2} \\cdot \\left(\\frac{x}{R}, \\frac{y}{R}\\right)\n$$\n$$\n\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = \\frac{\\mu_0 I_s}{2\\pi R} \\frac{-x(y - y_s) + y(x - x_s)}{(x - x_s)^2 + (y - y_s)^2} = \\frac{\\mu_0 I_s}{2pi R} \\frac{-xy + xy_s + yx - yx_s}{(x - x_s)^2 + (y - y_s)^2}\n$$\nThis simplifies to:\n$$\n\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = \\frac{\\mu_0 I_s}{2\\pi R} \\frac{x y_s - y x_s}{\\|\\mathbf{r} - \\mathbf{r}_s\\|^2}\n$$\nThe numerator, $x y_s - y x_s$, is the magnitude of the 2D cross product $(\\mathbf{r} \\times \\mathbf{r}_s)_z$.\n\nFor a system of $N$ source filaments with currents $I_i$ at positions $\\mathbf{r}_i$, the total magnetic field is the linear superposition of the fields from each filament. The total normal component at a boundary point $\\mathbf{r}$ is:\n$$\n(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{free}} = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi R} \\frac{(\\mathbf{r} \\times \\mathbf{r}_i)_z}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2}\n$$\nThis expression corresponds to the \"free-space\" case, where the conducting wall's influence is ignored. The maximum absolute value of this quantity over the boundary, $\\max |(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{free}}|$, is what we compute as $V_{\\text{free}}$.\n\nTo enforce the perfect conductor boundary condition, we use the method of images. For each source filament $i$ with current $I_i$ at position $\\mathbf{r}_i$ inside the circle, an image filament is placed outside the circle. The image filament has current $I_i^\\ast = -I_i$ and is located at position:\n$$\n\\mathbf{r}_i^\\ast = \\frac{R^2}{\\|\\mathbf{r}_i\\|^2}\\mathbf{r}_i\n$$\nThe total magnetic field is now the superposition of the fields from the $N$ source filaments and their corresponding $N$ image filaments. The normal component on the boundary is:\n$$\n(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{image}} = \\sum_{i=1}^N \\left( \\frac{\\mu_0 I_i}{2\\pi R} \\frac{(\\mathbf{r} \\times \\mathbf{r}_i)_z}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2} + \\frac{\\mu_0 I_i^\\ast}{2\\pi R} \\frac{(\\mathbf{r} \\times \\mathbf{r}_i^\\ast)_z}{\\|\\mathbf{r} - \\mathbf{r}_i^\\ast\\|^2} \\right)\n$$\nSubstituting $I_i^\\ast = -I_i$, we get:\n$$\n(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{image}} = \\sum_{i=1}^N \\frac{\\mu_0 I_i}{2\\pi R} \\left( \\frac{(\\mathbf{r} \\times \\mathbf{r}_i)_z}{\\|\\mathbf{r} - \\mathbf{r}_i\\|^2} - \\frac{(\\mathbf{r} \\times \\mathbf{r}_i^\\ast)_z}{\\|\\mathbf{r} - \\mathbf{r}_i^\\ast\\|^2} \\right)\n$$\nTheoretically, this expression evaluates to zero for any point $\\mathbf{r}$ on the circle $\\|\\mathbf{r}\\|=R$, thus satisfying the boundary condition. The maximum absolute value of this numerically computed quantity, $\\max |(\\mathbf{B} \\cdot \\hat{\\mathbf{n}})_{\\text{image}}|$, is $V_{\\text{image}}$. Any non-zero result is attributable to floating-point representation and arithmetic errors.\n\nThe numerical implementation proceeds as follows:\n1.  Discretize the circular boundary into $M$ uniformly spaced points, $\\mathbf{r}_k = (R\\cos\\theta_k, R\\sin\\theta_k)$ for $\\theta_k = 2\\pi k/M$ where $k = 0, \\dots, M-1$.\n2.  For each test case, define the set of source filaments (currents $I_i$ and positions $\\mathbf{r}_i$).\n3.  Calculate the positions $\\mathbf{r}_i^\\ast$ and currents $I_i^\\ast$ of the image filaments.\n4.  Using vectorized computations for efficiency, evaluate the normal magnetic field contributions from all source filaments at all $M$ boundary points. Sum these contributions to get the total normal field array for the free-space case.\n5.  Similarly, compute the contributions from the image filaments.\n6.  The normal field for the image-current case is the sum of the contributions from the source filaments and their images.\n7.  The maximum absolute value of the elements in the resulting arrays for the free-space and image-current cases yields $V_{\\text{free}}$ and $V_{\\text{image}}$, respectively.\n\nThis procedure is applied to each of the four test cases specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_max_violations(R, filaments, M, mu0):\n    \"\"\"\n    Computes the maximum violation of the perfect conductor boundary condition.\n\n    Args:\n        R (float): Radius of the circular conducting shell.\n        filaments (np.ndarray): Array of shape (N, 3) where N is the number of\n                                filaments. Each row is [I, x, y].\n        M (int): Number of sample points on the boundary.\n        mu0 (float): Vacuum permeability.\n\n    Returns:\n        tuple[float, float]: A tuple containing (V_free, V_image), where\n                             V_free is the max violation without images and\n                             V_image is the max violation with images.\n    \"\"\"\n    # 1. Discretize the boundary\n    theta = 2 * np.pi * np.arange(M) / M\n    # Boundary points r_k = (r_kx, r_ky), shape (M,)\n    r_kx = R * np.cos(theta)\n    r_ky = R * np.sin(theta)\n\n    # 2. Unpack filament data\n    # I_i, r_ix, r_iy, shape(N,)\n    I_s = filaments[:, 0]\n    r_sx = filaments[:, 1]\n    r_sy = filaments[:, 2]\n    N = len(I_s)\n\n    # 3. Compute contributions from source filaments\n    # Use broadcasting: r_k is (M,1), r_s is (1,N) -> result is (M,N)\n    \n    # Numerator term: (r_k x r_s)_z = r_kx * r_sy - r_ky * r_sx\n    num_s = r_kx[:, np.newaxis] * r_sy[np.newaxis, :] - r_ky[:, np.newaxis] * r_sx[np.newaxis, :]\n    \n    # Denominator term: ||r_k - r_s||^2\n    # delta_x = r_kx - r_sx, delta_y = r_ky - r_sy\n    delta_x_s = r_kx[:, np.newaxis] - r_sx[np.newaxis, :]\n    delta_y_s = r_ky[:, np.newaxis] - r_sy[np.newaxis, :]\n    den_s = delta_x_s**2 + delta_y_s**2\n\n    # Normal B field contribution from each source filament at each boundary point\n    B_n_contrib_s = (mu0 * I_s[np.newaxis, :] / (2 * np.pi * R)) * (num_s / den_s)\n\n    # 4. Compute V_free by summing contributions\n    B_n_free = np.sum(B_n_contrib_s, axis=1)\n    V_free = np.max(np.abs(B_n_free))\n\n    # 5. Compute image filament properties\n    I_img = -I_s\n    r_s_norm_sq = r_sx**2 + r_sy**2\n\n    # Handle potential filament at origin, though not in test cases\n    # If r_s_norm_sq is 0, factor becomes inf. A central filament needs no image.\n    # Its contribution to B_n is already 0. We avoid division by zero.\n    factor = np.divide(R**2, r_s_norm_sq, out=np.zeros_like(r_s_norm_sq), where=r_s_norm_sq!=0)\n    \n    r_sx_img = factor * r_sx\n    r_sy_img = factor * r_sy\n\n    # 6. Compute contributions from image filaments\n    # Numerator term: (r_k x r_s_img)_z\n    num_img = r_kx[:, np.newaxis] * r_sy_img[np.newaxis, :] - r_ky[:, np.newaxis] * r_sx_img[np.newaxis, :]\n    \n    # Denominator term: ||r_k - r_s_img||^2\n    delta_x_img = r_kx[:, np.newaxis] - r_sx_img[np.newaxis, :]\n    delta_y_img = r_ky[:, np.newaxis] - r_sy_img[np.newaxis, :]\n    den_img = delta_x_img**2 + delta_y_img**2\n\n    B_n_contrib_img = (mu0 * I_img[np.newaxis, :] / (2 * np.pi * R)) * (num_img / den_img)\n\n    # 7. Compute V_image by summing all contributions\n    B_n_image = np.sum(B_n_contrib_s + B_n_contrib_img, axis=1)\n    V_image = np.max(np.abs(B_n_image))\n\n    return V_free, V_image\n\ndef solve():\n    \"\"\"\n    Main solver function that runs the test suite and prints the formatted output.\n    \"\"\"\n    # Define problem constants\n    M = 2048\n    mu0 = 1.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (1.0, np.array([[1.0, 0.3, 0.0]])),\n        # Case 2\n        (1.0, np.array([[0.8, 0.4, 0.2], [0.8, -0.4, 0.2]])),\n        # Case 3\n        (1.0, np.array([[0.5, 0.5, 0.0], [0.5, 0.0, -0.5], [0.5, -0.5, 0.0], [0.5, 0.0, 0.5]])),\n        # Case 4\n        (1.0, np.array([[1.0, 0.9, 0.0]])),\n    ]\n\n    results = []\n    for R, filaments in test_cases:\n        V_free, V_image = compute_max_violations(R, filaments, M, mu0)\n        results.append(V_free)\n        results.append(V_image)\n    \n    # Format results to 8 significant digits\n    formatted_results = ['{:.8g}'.format(res) for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond static equilibrium, dynamic processes like magnetic reconnection are critical to the formation, stability, and evolution of compact toroids. The simplest fluid models are often insufficient to explain the rapid reconnection observed in experiments, necessitating the inclusion of two-fluid physics. This exercise introduces the ion inertial length, $d_i$, and the dimensionless Hall parameter, $\\epsilon_H$, which measure the scale at which ion and electron fluid motions decouple, enabling fast reconnection. By calculating these key parameters, you will learn to assess whether Hall physics is expected to play a dominant role in the dynamics of a given spheromak or FRC plasma. ",
            "id": "4046763",
            "problem": "Consider two compact toroidal fusion configurations operated with deuterium ions: a spheromak and a Field-Reversed Configuration (FRC). The spheromak has ion number density $n_i = 5.0 \\times 10^{19}\\ \\mathrm{m^{-3}}$ and a characteristic system size $L = 0.30\\ \\mathrm{m}$. The FRC has ion number density $n_i = 2.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$ and $L = 0.50\\ \\mathrm{m}$. Use the deuterium ion mass $m_i = 3.34 \\times 10^{-27}\\ \\mathrm{kg}$, elementary charge $e = 1.602 \\times 10^{-19}\\ \\mathrm{C}$, vacuum permittivity $\\epsilon_0 = 8.854 \\times 10^{-12}\\ \\mathrm{F/m}$, and speed of light $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$. The ion inertial length $d_i$ is related to the ion plasma frequency $\\omega_{pi}$ by elementary electrodynamics, and the non-dimensional Hall parameter $\\epsilon_H$ quantifies the relative importance of Hall physics by comparing an ion characteristic scale to the macroscopic device size.\n\nStarting from first principles, do the following for each device:\n- Derive and compute the ion inertial length $d_i$ from the given parameters.\n- Compute the non-dimensional Hall parameter $\\epsilon_H$ using your result for $d_i$ and the given $L$.\n- Using the generalized Ohm’s law and scale analysis, assess whether the reconnection rate is expected to show qualitative changes associated with Hall magnetohydrodynamics (MHD), such as weak dependence on the Lundquist number and the appearance of quadrupolar out-of-plane magnetic fields.\n\nSelect the option that most accurately reports the computed $d_i$ and $\\epsilon_H$ for the spheromak and FRC and provides the most consistent qualitative prediction for reconnection-rate behavior.\n\nA. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is dynamically important, enabling fast reconnection with weak Lundquist-number dependence and quadrupolar out-of-plane magnetic fields. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall corrections are modest, yielding some acceleration relative to resistive Magnetohydrodynamics (MHD) but weaker Hall signatures than in the spheromak.\n\nB. Spheromak: $d_i \\approx 0.46\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.015$; Hall physics is negligible, reconnection remains in the classical Sweet–Parker regime. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall physics is negligible; reconnection remains Sweet–Parker in both devices.\n\nC. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is negligible and reconnection is resistive. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; strong Hall reconnection dominates with signatures independent of the Lundquist number.\n\nD. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; strong Hall reconnection with quadrupolar magnetic fields. FRC: $d_i \\approx 7.0\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.14$; Hall physics equally strong as in the spheromak, implying similar fast-reconnection signatures.",
            "solution": "The problem requires the calculation of the ion inertial length $d_i$ and the non-dimensional Hall parameter $\\epsilon_H$ for two fusion devices, a spheromak and a Field-Reversed Configuration (FRC), followed by a qualitative assessment of the role of Hall physics in magnetic reconnection for each case.\n\nFirst, we establish the theoretical foundation from first principles as requested.\n\nThe ion plasma frequency, $\\omega_{pi}$, is a natural frequency of oscillation for ions in a plasma. For a plasma consisting of ions with number density $n_i$, mass $m_i$, and charge $Z e$ (where $Z$ is the charge number and $e$ is the elementary charge), the ion plasma frequency is given by:\n$$ \\omega_{pi} = \\sqrt{\\frac{n_i (Z e)^2}{\\epsilon_0 m_i}} $$\nThe problem specifies deuterium ions, for which the nucleus is a deuteron with charge number $Z=1$. Thus, the formula simplifies to:\n$$ \\omega_{pi} = \\sqrt{\\frac{n_i e^2}{\\epsilon_0 m_i}} $$\nwhere $\\epsilon_0$ is the vacuum permittivity.\n\nThe ion inertial length, $d_i$, also known as the ion skin depth, is the characteristic length scale over which deviations from plasma quasineutrality can occur due to ion inertia. It is defined in terms of the ion plasma frequency and the speed of light in vacuum, $c$, as:\n$$ d_i = \\frac{c}{\\omega_{pi}} $$\nSubstituting the expression for $\\omega_{pi}$, we obtain the formula for the ion inertial length:\n$$ d_i = c \\sqrt{\\frac{\\epsilon_0 m_i}{n_i e^2}} $$\nThis equation will be used for the calculations.\n\nThe non-dimensional Hall parameter, $\\epsilon_H$, is defined as the ratio of the ion inertial length $d_i$ to a characteristic macroscopic length scale of the system, $L$.\n$$ \\epsilon_H = \\frac{d_i}{L} $$\nThis parameter quantifies the importance of two-fluid effects, described by the Hall term in the generalized Ohm's law, relative to single-fluid magnetohydrodynamics (MHD). In the context of magnetic reconnection, when $d_i$ is comparable to the reconnection layer thickness, the dynamics change fundamentally from the slow, resistive Sweet-Parker model to a fast reconnection regime. A non-negligible value of $\\epsilon_H = d_i/L$ indicates that the system is large enough, in units of $d_i$, for Hall effects to be globally significant. A common rule of thumb is that for $\\epsilon_H \\gtrsim 0.1$, Hall physics becomes dynamically important, leading to fast reconnection rates that are weakly dependent on the plasma resistivity (and hence the Lundquist number, $S$), and the appearance of a characteristic quadrupolar out-of-plane magnetic field structure.\n\nThe given physical constants are:\n- Deuterium ion mass: $m_i = 3.34 \\times 10^{-27}\\ \\mathrm{kg}$\n- Elementary charge: $e = 1.602 \\times 10^{-19}\\ \\mathrm{C}$\n- Vacuum permittivity: $\\epsilon_0 = 8.854 \\times 10^{-12}\\ \\mathrm{F/m}$\n- Speed of light: $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$\n\nWe now proceed with the calculations for each device.\n\n**Spheromak Analysis**\nThe given parameters for the spheromak are:\n- Ion number density: $n_i = 5.0 \\times 10^{19}\\ \\mathrm{m^{-3}}$\n- Characteristic system size: $L = 0.30\\ \\mathrm{m}$\n\nFirst, we compute the ion inertial length $d_i$:\n$$ d_i = (2.998 \\times 10^8\\ \\mathrm{m/s}) \\sqrt{\\frac{(8.854 \\times 10^{-12}\\ \\mathrm{F/m}) (3.34 \\times 10^{-27}\\ \\mathrm{kg})}{(5.0 \\times 10^{19}\\ \\mathrm{m^{-3}}) (1.602 \\times 10^{-19}\\ \\mathrm{C})^2}} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{\\frac{2.957 \\times 10^{-38}}{1.283 \\times 10^{-18}}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{2.305 \\times 10^{-20}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) (1.518 \\times 10^{-10})\\ \\mathrm{m} $$\n$$ d_i \\approx 0.04551\\ \\mathrm{m} \\approx 4.55\\ \\mathrm{cm} $$\nRounding to two significant figures, we get $d_i \\approx 4.6\\ \\mathrm{cm}$.\n\nNext, we compute the Hall parameter $\\epsilon_H$:\n$$ \\epsilon_H = \\frac{d_i}{L} = \\frac{0.04551\\ \\mathrm{m}}{0.30\\ \\mathrm{m}} \\approx 0.1517 $$\nRounding to two significant figures, we get $\\epsilon_H \\approx 0.15$.\n\nWith $\\epsilon_H \\approx 0.15$, this value is significant and falls squarely in the regime where Hall physics is expected to dominate reconnection dynamics. Therefore, one expects to observe fast reconnection, a weak dependence of the reconnection rate on the Lundquist number, and the formation of quadrupolar out-of-plane magnetic fields.\n\n**Field-Reversed Configuration (FRC) Analysis**\nThe given parameters for the FRC are:\n- Ion number density: $n_i = 2.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$\n- Characteristic system size: $L = 0.50\\ \\mathrm{m}$\n\nFirst, we compute the ion inertial length $d_i$:\n$$ d_i = (2.998 \\times 10^8\\ \\mathrm{m/s}) \\sqrt{\\frac{(8.854 \\times 10^{-12}\\ \\mathrm{F/m}) (3.34 \\times 10^{-27}\\ \\mathrm{kg})}{(2.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) (1.602 \\times 10^{-19}\\ \\mathrm{C})^2}} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{\\frac{2.957 \\times 10^{-38}}{5.132 \\times 10^{-18}}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) \\sqrt{0.5761 \\times 10^{-20}}\\ \\mathrm{m} $$\n$$ d_i = (2.998 \\times 10^8) (0.7590 \\times 10^{-10})\\ \\mathrm{m} $$\n$$ d_i \\approx 0.02275\\ \\mathrm{m} \\approx 2.28\\ \\mathrm{cm} $$\nRounding to two significant figures, we get $d_i \\approx 2.3\\ \\mathrm{cm}$.\n\nNext, we compute the Hall parameter $\\epsilon_H$:\n$$ \\epsilon_H = \\frac{d_i}{L} = \\frac{0.02275\\ \\mathrm{m}}{0.50\\ \\mathrm{m}} \\approx 0.0455 $$\nRounding to two significant figures, we get $\\epsilon_H \\approx 0.046$.\n\nFor the FRC, $\\epsilon_H \\approx 0.046$. This value is smaller than that of the spheromak but is not negligible. It suggests a transitional regime where Hall effects are present and will likely lead to reconnection rates faster than predicted by resistive MHD. However, the signatures of Hall physics may be less pronounced than in the spheromak case. The term \"modest\" is an appropriate description for the role of Hall corrections.\n\n**Evaluation of Options**\n\nWe now evaluate each option based on our calculations and physical interpretation.\n\n**A. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is dynamically important, enabling fast reconnection with weak Lundquist-number dependence and quadrupolar out-of-plane magnetic fields. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall corrections are modest, yielding some acceleration relative to resistive Magnetohydrodynamics (MHD) but weaker Hall signatures than in the spheromak.**\n- **Spheromak**: The calculated values $d_i \\approx 4.6\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.15$ are correct. The physical interpretation is consistent with $\\epsilon_H \\approx 0.15$.\n- **FRC**: The calculated values $d_i \\approx 2.3\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.046$ are correct. The physical interpretation accurately describes a regime with \"modest\" Hall effects, which are weaker than in the spheromak case.\n- **Verdict**: Correct.\n\n**B. Spheromak: $d_i \\approx 0.46\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.015$; Hall physics is negligible, reconnection remains in the classical Sweet–Parker regime. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; Hall physics is negligible; reconnection remains Sweet–Parker in both devices.**\n- **Spheromak**: The calculated value $d_i \\approx 0.46\\ \\mathrm{cm}$ is incorrect by a factor of $10$. Consequently, $\\epsilon_H$ is also incorrect. The interpretation is based on faulty numbers.\n- **FRC**: While the numerical values are correct, the interpretation that Hall physics is \"negligible\" is an oversimplification for $\\epsilon_H \\approx 0.046$.\n- **Verdict**: Incorrect.\n\n**C. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; Hall physics is negligible and reconnection is resistive. FRC: $d_i \\approx 2.3\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.046$; strong Hall reconnection dominates with signatures independent of the Lundquist number.**\n- **Spheromak**: The calculated values are correct, but the interpretation (\"Hall physics is negligible\") is fundamentally incorrect and contradicts the meaning of a large Hall parameter $\\epsilon_H \\approx 0.15$.\n- **FRC**: The calculated values are correct, but the interpretation (\"strong Hall reconnection dominates\") is an overstatement for $\\epsilon_H \\approx 0.046$ and incorrectly presents the FRC as being more dominated by Hall effects than the spheromak.\n- **Verdict**: Incorrect.\n\n**D. Spheromak: $d_i \\approx 4.6\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.15$; strong Hall reconnection with quadrupolar magnetic fields. FRC: $d_i \\approx 7.0\\ \\mathrm{cm}$, $\\epsilon_H \\approx 0.14$; Hall physics equally strong as in the spheromak, implying similar fast-reconnection signatures.**\n- **Spheromak**: The calculated values and interpretation are correct.\n- **FRC**: The calculated values $d_i \\approx 7.0\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.14$ are incorrect. Our calculation yields $d_i \\approx 2.3\\ \\mathrm{cm}$ and $\\epsilon_H \\approx 0.046$. The interpretation is based on these faulty numbers.\n- **Verdict**: Incorrect.\n\nBased on this analysis, option A is the only one that provides both correct numerical results and a physically sound interpretation for both configurations.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}