{
    "hands_on_practices": [
        {
            "introduction": "理解驱动不对称性如何转化为内爆壳层变形是掌握惯性约束聚变（ICF）对称性控制的基础。本练习旨在通过一个简化的分析模型，揭示驱动压力的微小空间变化与壳层最终形状畸变之间的直接联系。通过应用牛顿第二定律和线性运动学，您将推导出压力不均匀性如何导致加速度不均匀性，并最终在壳层向心汇聚过程中被放大，从而形成可量化的形状畸变。 这个基本练习是理解所有更复杂对称性控制策略的物理出发点。",
            "id": "3995575",
            "problem": "惯性约束聚变（ICF）内爆中的球形薄壳靶丸受到一种烧蚀压力驱动，该驱动几乎均匀，但包含一个受控的低模非均匀性。假设在加速阶段，该壳层可以被建模为一个具有与角度无关的面密度 $\\Sigma(t)$ 的薄层，并且局部法向加速度由单位面积的牛顿第二定律给出。设烧蚀压力为\n$$\np_{a}(\\theta,t) = p_{0}(t)\\left[1 + \\epsilon\\,P_{2}(\\cos\\theta)\\right],\n$$\n其中 $P_{2}(\\cos\\theta)$ 是二阶勒让德多项式，$P_{2}(\\mu) = \\frac{1}{2}\\left(3\\mu^{2}-1\\right)$，而 $\\epsilon$ 是一个小的、不随时间变化的模幅。极向 $\\pm 1\\%$ 的变化由 $\\epsilon = 0.01$ 表示，因此在两极（$\\theta=0$），压力相对于平均值增加了 $+1\\%$。\n\n壳层在 $t=0$ 时从静止状态开始，初始外半径为 $R_{i}$，并被 $p_{a}(\\theta,t)$ 向内加速，直到加速阶段结束的时刻 $t_{f}$，此时平均外半径为 $R_{f}$。假设在此阶段内部压力保持球对称，因此它不会对加速度产生任何角度变化，并且在每个极角处的运动都是纯径向的。\n\n1. 仅使用基本原理（单位面积的牛顿第二定律和给定的 $p_{a}(\\theta,t)$ 形式），推导壳层加速度 $a_{s}(\\theta,t)$ 的角度依赖性及其相对于平均值的份数变化。\n\n2. 用 $R_{0}(t)$ 表示平均半径，用下式表示最终半径场\n$$\nR_{f}(\\theta) = R_{f}\\left[1 + a_{2}\\,P_{2}(\\cos\\theta)\\right],\n$$\n这定义了加速阶段结束时的时间积分形状系数 $a_{2}$。从壳层的线性化运动学以及加速度和位移之间的关系出发，假设初始条件 $R(\\theta,0)=R_{i}$ 和 $\\dot{R}(\\theta,0)=0$ 与角度无关，推导 $a_{2}$ 关于 $\\epsilon$ 和会聚比 $C \\equiv R_{i}/R_{f}$ 的闭合形式表达式。\n\n3. 对于 $R_{i} = 1.0~\\mathrm{mm}$ 和 $R_{f} = 0.2~\\mathrm{mm}$，以及 $\\epsilon = 0.01$ 的情况，计算结果。将 $a_{2}$ 的最终答案表示为一个无量纲数。最终答案无需四舍五入。",
            "solution": "该问题要求分析在非均匀烧蚀压力驱动下，惯性约束聚变（ICF）中内爆球壳上低模形状扰动的增长。该分析将分三部分进行。\n\n### 第1部分：壳层加速度的角度依赖性\n\n我们从应用于壳层单位面积的牛顿第二定律开始。使壳层向内加速的净压力是外部烧蚀压力 $p_{a}(\\theta, t)$ 与内部压力 $p_{int}(t)$ 之差。该定律指出，单位面积上的净力等于面密度 $\\Sigma(t)$ 乘以局部法向加速度 $a_{s}(\\theta, t)$。我们定义向内运动的加速度为正。\n\n$$\n\\Sigma(t) a_{s}(\\theta, t) = p_{a}(\\theta, t) - p_{int}(t)\n$$\n\n问题给出了烧蚀压力的形式：\n$$\np_{a}(\\theta,t) = p_{0}(t)\\left[1 + \\epsilon\\,P_{2}(\\cos\\theta)\\right]\n$$\n内部压力 $p_{int}(t)$ 被设定为球对称。将压力表达式代入牛顿第二定律得到：\n$$\na_{s}(\\theta, t) = \\frac{p_{0}(t)\\left[1 + \\epsilon\\,P_{2}(\\cos\\theta)\\right] - p_{int}(t)}{\\Sigma(t)}\n$$\n\n我们可以将其分为一个平均（球对称）分量和一个扰动分量。平均加速度 $a_{s,0}(t)$ 是 $a_{s}(\\theta, t)$ 的球平均值。由于对于 $\\ell > 0$，勒让德多项式 $P_{\\ell}(\\cos\\theta)$ 的球平均值为零，因此通过将扰动项设为零可得到平均加速度：\n$$\na_{s,0}(t) = \\frac{p_{0}(t) - p_{int}(t)}{\\Sigma(t)}\n$$\n\n现在，完整的角度依赖加速度可以表示为：\n$$\na_{s}(\\theta, t) = \\frac{p_{0}(t) - p_{int}(t)}{\\Sigma(t)} + \\frac{p_{0}(t)\\epsilon\\,P_{2}(\\cos\\theta)}{\\Sigma(t)}\n$$\n$$\na_{s}(\\theta, t) = a_{s,0}(t) + \\frac{p_{0}(t)}{\\Sigma(t)}\\epsilon\\,P_{2}(\\cos\\theta)\n$$\n\n加速度相对于平均值的份数变化定义为 $\\frac{a_{s}(\\theta, t) - a_{s,0}(t)}{a_{s,0}(t)}$。\n$$\n\\frac{\\Delta a_{s}}{a_{s,0}} = \\frac{a_{s}(\\theta, t) - a_{s,0}(t)}{a_{s,0}(t)} = \\frac{\\frac{p_{0}(t)}{\\Sigma(t)}\\epsilon\\,P_{2}(\\cos\\theta)}{a_{s,0}(t)}\n$$\n代入 $a_{s,0}(t)$ 的表达式：\n$$\n\\frac{\\Delta a_{s}}{a_{s,0}} = \\frac{\\frac{p_{0}(t)}{\\Sigma(t)}\\epsilon\\,P_{2}(\\cos\\theta)}{\\frac{p_{0}(t) - p_{int}(t)}{\\Sigma(t)}} = \\left(\\frac{p_{0}(t)}{p_{0}(t) - p_{int}(t)}\\right) \\epsilon\\,P_{2}(\\cos\\theta)\n$$\n这就是加速度份数变化的角度依赖性。\n\n### 第2部分：形状系数 $a_{2}$ 的推导\n\n在给定的极角 $\\theta$ 和时间 $t$ 时壳层的位置用 $R(\\theta, t)$ 表示。运动是纯径向的，所以加速度为 $a_s(\\theta, t) = -\\ddot{R}(\\theta, t)$，其中双点表示二阶时间导数。\n\n我们通过将半径分解为一个平均分量 $R_0(t)$ 和一个小扰动 $\\delta R(\\theta, t)$ 来线性化问题：\n$$\nR(\\theta, t) = R_0(t) + \\delta R(\\theta, t)\n$$\n扰动是由压力中的 $P_2$ 模驱动的，因此我们假设其形状也遵循 $P_2$ 依赖性：\n$$\n\\delta R(\\theta, t) = \\delta R_2(t) P_2(\\cos \\theta)\n$$\n运动方程为 $\\ddot{R}(\\theta, t) = -a_s(\\theta, t)$。应用分解：\n$$\n\\ddot{R}_0(t) + \\delta\\ddot{R}_2(t)P_2(\\cos \\theta) = -a_{s,0}(t) - \\frac{p_{0}(t)}{\\Sigma(t)}\\epsilon\\,P_{2}(\\cos\\theta)\n$$\n令基函数（1 和 $P_2(\\cos \\theta)$）的系数相等，得到两个方程：\n1. 平均运动：$\\ddot{R}_0(t) = -a_{s,0}(t) = -\\frac{p_0(t) - p_{int}(t)}{\\Sigma(t)}$\n2. 扰动运动：$\\delta\\ddot{R}_2(t) = -\\frac{p_0(t)\\epsilon}{\\Sigma(t)}$\n\n为了获得仅用会聚比 $C$ 和 $\\epsilon$ 表示的 $a_2$ 的闭合形式解，我们必须消除对未指定的随时间变化函数 $p_0(t)$、$p_{int}(t)$ 和 $\\Sigma(t)$ 的依赖。我们注意到，在ICF内爆的加速阶段，烧蚀压力通常远大于内部填充压力，即 $p_0(t) \\gg p_{int}(t)$。在这个标准的、有物理依据的近似下，平均运动方程简化为 $\\ddot{R}_0(t) \\approx -p_0(t)/\\Sigma(t)$。\n\n将此近似代入扰动方程：\n$$\n\\delta\\ddot{R}_2(t) \\approx \\left(\\ddot{R}_0(t)\\right) \\epsilon\n$$\n这提供了扰动运动学和平均运动学之间的直接关系，与具体的驱动历史无关。我们现在将这个方程对时间从 $t=0$ 到一般时间 $t$ 积分两次。初始条件是壳层从静止开始，具有完美的球形：\n- $R(\\theta, 0) = R_i \\implies R_0(0) = R_i$ 且 $\\delta R(\\theta, 0) = 0$，所以 $\\delta R_2(0) = 0$。\n- $\\dot{R}(\\theta, 0) = 0 \\implies \\dot{R}_0(0) = 0$ 且 $\\delta\\dot{R}(\\theta, 0) = 0$，所以 $\\delta\\dot{R}_2(0) = 0$。\n\n对 $\\delta\\ddot{R}_2(t) = \\epsilon \\ddot{R}_0(t)$ 积分一次：\n$$\n\\int_0^t \\delta\\ddot{R}_2(\\tau)d\\tau = \\epsilon \\int_0^t \\ddot{R}_0(\\tau)d\\tau\n$$\n$$\n\\delta\\dot{R}_2(t) - \\delta\\dot{R}_2(0) = \\epsilon \\left( \\dot{R}_0(t) - \\dot{R}_0(0) \\right)\n$$\n应用初始条件 $\\delta\\dot{R}_2(0) = 0$ 和 $\\dot{R}_0(0) = 0$：\n$$\n\\delta\\dot{R}_2(t) = \\epsilon \\dot{R}_0(t)\n$$\n再次积分：\n$$\n\\int_0^t \\delta\\dot{R}_2(\\tau)d\\tau = \\epsilon \\int_0^t \\dot{R}_0(\\tau)d\\tau\n$$\n$$\n\\delta R_2(t) - \\delta R_2(0) = \\epsilon \\left( R_0(t) - R_0(0) \\right)\n$$\n应用初始条件 $\\delta R_2(0) = 0$ 和 $R_0(0) = R_i$：\n$$\n\\delta R_2(t) = \\epsilon \\left( R_0(t) - R_i \\right)\n$$\n此关系在整个加速阶段都成立。我们在最终时刻 $t_f$ 对其求值。此时，平均半径为 $R_0(t_f) = R_f$。扰动幅度由问题中最终形状的定义给出：$R_f(\\theta) = R_f [1 + a_2 P_2(\\cos\\theta)]$。将其与 $R(t_f, \\theta) = R_0(t_f) + \\delta R_2(t_f)P_2(\\cos \\theta)$ 进行比较，我们确定 $\\delta R_2(t_f) = R_f a_2$。\n\n将这些代入我们在 $t=t_f$ 时的积分运动学关系中：\n$$\nR_f a_2 = \\epsilon (R_f - R_i)\n$$\n解出 $a_2$：\n$$\na_2 = \\epsilon \\frac{R_f - R_i}{R_f} = \\epsilon \\left(1 - \\frac{R_i}{R_f}\\right)\n$$\n使用会聚比的定义 $C = R_i/R_f$：\n$$\na_2 = \\epsilon(1-C)\n$$\n\n### 第3部分：对给定参数求值\n\n问题提供了以下值：\n- 初始半径：$R_i = 1.0~\\mathrm{mm}$\n- 最终平均半径：$R_f = 0.2~\\mathrm{mm}$\n- 压力模幅：$\\epsilon = 0.01$\n\n首先，我们计算会聚比 $C$：\n$$\nC = \\frac{R_i}{R_f} = \\frac{1.0}{0.2} = 5\n$$\n现在，我们使用推导出的 $a_2$ 公式：\n$$\na_2 = \\epsilon(1-C) = 0.01 \\times (1 - 5) = 0.01 \\times (-4)\n$$\n$$\na_2 = -0.04\n$$\n$a_2$ 的值是一个无量纲数，表示以最终半径为单位的最终壳层形状畸变的幅度。负号表示，对于在极点处压力最高的驱动（$\\epsilon > 0$），壳层在极点处向内移动最快，导致相对于平均球面，形状变得扁平（扁球体），即极点处的半径小于平均半径。",
            "answer": "$$\\boxed{-0.04}$$"
        },
        {
            "introduction": "在理解了驱动不平衡是不可避免的之后，下一个实际问题就是：我们需要将这种不平衡控制在多小的范围内？本练习将理论与工程实践相结合，介绍如何利用线性响应模型为激光系统设定精确的工程容差。您将使用给定的热斑不对称性对各束群功率的灵敏度系数，通过最坏情况分析来确定为达到所需内爆性能所允许的最大束间功率失配。 这项实践展示了如何将复杂的物理关系转化为具体的、可操作的工程设计指标。",
            "id": "3995539",
            "problem": "在惯性约束聚变（ICF）中，通常使用球谐函数来描述滞止时刻热斑的形状，以量化低阶不对称性。令无量纲勒让德模振幅 $a_{2}$ 表示由激光加热的黑腔驱动的热斑的滞止四极不对称性。假设对于标称工作点附近的小偏离，$a_{2}$ 对束组功率微扰呈线性响应，这与球谐驱动分量的叠加相一致，并且标称设计中 $a_{2}^{0}=0$。\n\n一个特定的圆柱形黑腔设计由四个束组驱动：顶部内环（TI）、顶部外环（TO）、底部内环（BI）和底部外环（BO）。在该工作点，标称束组功率为 $P_{\\mathrm{TI}}^{0}=P_{\\mathrm{TO}}^{0}=P_{\\mathrm{BI}}^{0}=P_{\\mathrm{BO}}^{0}=100$ TW，测得的 $a_{2}$ 对各束组功率微小变化的滞止灵敏度为\n$$\n\\left.\\frac{\\partial a_{2}}{\\partial P_{\\mathrm{TI}}}\\right|_{0}=+2.5\\times 10^{-3}\\,\\mathrm{TW}^{-1},\\quad\n\\left.\\frac{\\partial a_{2}}{\\partial P_{\\mathrm{TO}}}\\right|_{0}=-1.5\\times 10^{-3}\\,\\mathrm{TW}^{-1},\n$$\n$$\n\\left.\\frac{\\partial a_{2}}{\\partial P_{\\mathrm{BI}}}\\right|_{0}=+2.5\\times 10^{-3}\\,\\mathrm{TW}^{-1},\\quad\n\\left.\\frac{\\partial a_{2}}{\\partial P_{\\mathrm{BO}}}\\right|_{0}=-1.5\\times 10^{-3}\\,\\mathrm{TW}^{-1}.\n$$\n\n假设不对称性的唯一来源是束间功率失配，其被建模为每个束组功率的有界相对误差：对于每个束组 $i\\in\\{\\mathrm{TI},\\mathrm{TO},\\mathrm{BI},\\mathrm{BO}\\}$，实际功率为 $P_{i}=P_{i}^{0}(1+\\delta_{i})$，其中 $|\\delta_{i}|\\leq \\varepsilon$，$\\varepsilon$ 是一个统一的束间功率匹配精度（以分数表示）。使用线性响应的第一性原理和最坏情况边界法（即，除了统一边界外，不对 $\\delta_{i}$ 之间的相关性做任何假设），确定能使滞止不对称性对所有允许的 $\\{\\delta_{i}\\}$ 都满足 $|a_{2}|\\le 0.02$ 的最大 $\\varepsilon$ 值。\n\n将您的答案表示为 $\\varepsilon$ 的单个小数（分数形式，不带百分号）。无需单位。如果可以得到精确小数，则无需取整。",
            "solution": "该问题要求计算最大的分数形式束功率匹配精度 $\\varepsilon$，以确保无量纲滞止四极不对称性 $a_2$ 满足条件 $|a_2| \\le 0.02$。该分析基于针对小微扰的线性响应模型。\n\n不对称性 $a_2$ 是四个束组功率 $P_{\\mathrm{TI}}$、$P_{\\mathrm{TO}}$、$P_{\\mathrm{BI}}$ 和 $P_{\\mathrm{BO}}$ 的函数。根据针对标称工作点小偏离的线性响应假设，$a_2$ 的变化量可以通过一阶泰勒展开来近似：\n$$ \\Delta a_2 \\approx \\sum_{i \\in \\{\\mathrm{TI},\\mathrm{TO},\\mathrm{BI},\\mathrm{BO}\\}} \\left.\\frac{\\partial a_2}{\\partial P_i}\\right|_{0} \\Delta P_i $$\n其中 $\\left.\\frac{\\partial a_2}{\\partial P_i}\\right|_{0}$ 表示 $a_2$ 对束组 $i$ 功率变化的灵敏度（在标称工作点处计算的值），而 $\\Delta P_i$ 是束组 $i$ 的功率微扰。\n\n问题陈述指出标称设计是对称的，这意味着标称不对称性为 $a_2^0 = 0$。因此，$\\Delta a_2 = a_2 - a_2^0 = a_2$。每个束组的功率微扰由 $P_i = P_i^0(1+\\delta_i)$ 给出，因此与标称功率的偏差为：\n$$ \\Delta P_i = P_i - P_i^0 = P_i^0(1+\\delta_i) - P_i^0 = P_i^0 \\delta_i $$\n将这些代入线性响应公式，得到：\n$$ a_2 \\approx \\sum_{i} \\left.\\frac{\\partial a_2}{\\partial P_i}\\right|_{0} (P_i^0 \\delta_i) $$\n所有四个束组的标称功率是相同的：$P_{\\mathrm{TI}}^{0}=P_{\\mathrm{TO}}^{0}=P_{\\mathrm{BI}}^{0}=P_{\\mathrm{BO}}^{0}=P^0=100 \\, \\mathrm{TW}$。令 $S_i = \\left.\\frac{\\partial a_2}{\\partial P_i}\\right|_{0}$ 表示给定的灵敏度。$a_2$ 的表达式可简化为：\n$$ a_2 \\approx P^0 \\sum_{i} S_i \\delta_i $$\n我们需要确保对于所有受 $|\\delta_i| \\le \\varepsilon$ 限制的允许功率微扰，都有 $|a_2| \\le 0.02$。为此，我们必须找到在给定 $\\varepsilon$ 下 $|a_2|$ 的最大可能值，这对应于“最坏情况”的情景。使用三角不等式：\n$$ |a_2| = \\left|P^0 \\sum_{i} S_i \\delta_i\\right| = P^0 \\left|\\sum_{i} S_i \\delta_i\\right| \\le P^0 \\sum_{i} |S_i \\delta_i| = P^0 \\sum_{i} |S_i| |\\delta_i| $$\n由于对所有的 $i$ 都有 $|\\delta_i| \\le \\varepsilon$，我们可以进一步约束 $|a_2|$ 的上界：\n$$ |a_2| \\le P^0 \\sum_{i} |S_i| \\varepsilon = \\varepsilon P^0 \\sum_{i} |S_i| $$\n$|a_2|$ 的最大值，记为 $|a_2|_{\\max}$，在上述不等式取等号时达到。这种情况发生在求和中的所有项 $S_i \\delta_i$ 符号相同，且 $|\\delta_i|$ 取其最大值 $\\varepsilon$ 的时候。这可以通过选择 $\\delta_i = \\varepsilon \\cdot \\mathrm{sgn}(S_i)$ 来实现，这是一个允许的选择，因为 $|\\delta_i| = \\varepsilon \\le \\varepsilon$。\n\n给定的灵敏度为：\n$$ S_{\\mathrm{TI}} = +2.5 \\times 10^{-3} \\, \\mathrm{TW}^{-1} $$\n$$ S_{\\mathrm{TO}} = -1.5 \\times 10^{-3} \\, \\mathrm{TW}^{-1} $$\n$$ S_{\\mathrm{BI}} = +2.5 \\times 10^{-3} \\, \\mathrm{TW}^{-1} $$\n$$ S_{\\mathrm{BO}} = -1.5 \\times 10^{-3} \\, \\mathrm{TW}^{-1} $$\n我们计算灵敏度绝对值的总和：\n$$ \\sum_{i} |S_i| = |S_{\\mathrm{TI}}| + |S_{\\mathrm{TO}}| + |S_{\\mathrm{BI}}| + |S_{\\mathrm{BO}}| $$\n$$ \\sum_{i} |S_i| = (2.5 \\times 10^{-3}) + |-1.5 \\times 10^{-3}| + (2.5 \\times 10^{-3}) + |-1.5 \\times 10^{-3}| \\, \\mathrm{TW}^{-1} $$\n$$ \\sum_{i} |S_i| = (2.5 + 1.5 + 2.5 + 1.5) \\times 10^{-3} \\, \\mathrm{TW}^{-1} = 8.0 \\times 10^{-3} \\, \\mathrm{TW}^{-1} $$\n现在我们可以写出最坏情况不对称性的表达式：\n$$ |a_2|_{\\max} = \\varepsilon P^0 \\sum_{i} |S_i| $$\n代入 $P^0$ 和灵敏度总和的值：\n$$ |a_2|_{\\max} = \\varepsilon \\cdot (100 \\, \\mathrm{TW}) \\cdot (8.0 \\times 10^{-3} \\, \\mathrm{TW}^{-1}) $$\n$$ |a_2|_{\\max} = \\varepsilon \\cdot (100 \\cdot 8.0 \\times 10^{-3}) = \\varepsilon \\cdot 0.8 $$\n问题要求找到最大的 $\\varepsilon$ 使得 $|a_2| \\le 0.02$。这意味着最坏情况下的不对称性不能超过此限制。为了找到 $\\varepsilon$ 的边界值，我们将 $|a_2|_{\\max}$ 设为指定的极限值：\n$$ 0.8 \\varepsilon = 0.02 $$\n解出 $\\varepsilon$：\n$$ \\varepsilon = \\frac{0.02}{0.8} = \\frac{2 \\times 10^{-2}}{8 \\times 10^{-1}} = \\frac{2}{8} \\times 10^{-1} = 0.25 \\times 10^{-1} $$\n$$ \\varepsilon = 0.025 $$\n这是 $\\varepsilon$ 的最大允许值。",
            "answer": "$$\n\\boxed{0.025}\n$$"
        },
        {
            "introduction": "高级的ICF设计不僅僅是被动地限制不对称性，而是主动地通过设计激光脉冲来动态地控制对称性。本练习将引导您进入ICF计算设计的核心领域：最优控制。您将建立一个成本函数，该函数不仅要最小化由激光-靶丸相互作用（如交叉束能量转移）引起的驱动不对称性，还要保证控制变量（内外环功率比）的时间平滑性。 通过解决这个带约束的二次规划问题，您将体验到现代ICF设计中用于生成高性能、高对称性内爆脉冲波形的复杂计算方法。",
            "id": "3995583",
            "problem": "给定一个由 $k \\in \\{0,1,\\dots,N-1\\}$ 索引的离散化一维时间历史，考虑一个惯性约束聚变黑腔对称性的简化线性响应模型，其中勒让德模式2驱动不平衡幅度 $a_2(t)$ 在跨束能量转移（CBET）后线性地依赖于内外锥功率。假设以下具有物理动机的一阶模型：\n\n1. CBET将外锥入射功率的一部分 $T(t)$ 转移到内锥。在黑腔能量守恒的条件下，等效的内外锥功率为\n$$\nP_{\\text{in}}^{\\text{eff}}(t) = P_{\\text{in}}(t) + T(t)\\,P_{\\text{out}}(t), \\qquad\nP_{\\text{out}}^{\\text{eff}}(t) = \\bigl(1 - T(t)\\bigr)\\,P_{\\text{out}}(t),\n$$\n其中 $P_{\\text{in}}(t) = R(t)\\,P_{\\text{out}}(t)$，而 $R(t)$ 是我们要求解的内外锥功率比。\n\n2. 模式2幅度由以下模型描述\n$$\na_2(t) = H_2(t)\\,\\bigl[\\,G_{\\text{out}}(t)\\,P_{\\text{out}}^{\\text{eff}}(t) - G_{\\text{in}}(t)\\,P_{\\text{in}}^{\\text{eff}}(t)\\,\\bigr],\n$$\n其中 $H_2(t)$ 是一个随时间变化的几何传递系数，它将驱动不对称性与勒让德模式2响应联系起来；$G_{\\text{in}}(t)$ 和 $G_{\\text{out}}(t)$ 分别是几何耦合权重，用于捕捉黑腔辐射场对内锥和外锥的特定锥灵敏度。这种线性叠加是与能量守恒和线性化角系数耦合相一致的一阶小信号近似。\n\n3. 为了计算上的易处理性且不失一般性，可以设置 $P_{\\text{out}}(t) \\equiv 1$。\n\n定义代价泛函，该泛函惩罚对称性不平衡并强制 $R(t)$ 的时间平滑性：\n$$\nJ[R] = \\sum_{k=0}^{N-1} w_k\\,\\bigl(a_2(t_k)\\bigr)^2 \\;+\\; \\alpha\\,\\sum_{k=0}^{N-2}\\bigl(R(t_{k+1}) - R(t_k)\\bigr)^2,\n$$\n其中 $w_k$ 是非负权重，$\\alpha \\ge 0$ 是平滑系数。施加点态边界 $R_{\\min} \\le R(t_k) \\le R_{\\max}$。\n\n您的任务是：\n- 从以上定义出发，推导出一个用于最小化 $J[R]$ 的关于 $R(t_k)$ 的离散时间二次规划。\n- 实现一个算法，通过求解无约束法方程，然后应用投影梯度迭代来计算最优有界比率 $R^\\star(t_k)$。迭代步长需根据系统矩阵谱半径的一个有效上界来选择，以确保所选步长的收敛性。\n- 通过计算基于微小扰动 $\\delta T(t)$ 的有限差分灵敏度度量，分析对CBET转移分数 $T(t)$ 中误差的灵敏度。\n\n您必须实现以下测试套件，其中所有量均以无量纲单位表示：\n\n- 测试用例A（中等恒定CBET，正弦 $H_2$）：\n    - $N = 64$，\n    - $T(t_k) = 0.25$，\n    - $H_2(t_k) = 0.8 + 0.2\\sin\\!\\bigl(2\\pi k/N\\bigr)$，\n    - $G_{\\text{in}}(t_k) = 1.0$， $G_{\\text{out}}(t_k) = 1.0$，\n    - 对所有 $k$，$w_k = 1.0$，\n    - $\\alpha = 0.01$，\n    - $R_{\\min} = 0.6$， $R_{\\max} = 1.4$，\n    - $\\delta T(t_k) = 0.02\\cos\\!\\bigl(4\\pi k/N\\bigr)$。\n\n- 测试用例B（无CBET，恒定 $H_2$）：\n    - $N = 64$，\n    - $T(t_k) = 0.0$，\n    - $H_2(t_k) = 1.0$，\n    - $G_{\\text{in}}(t_k) = 1.0$， $G_{\\text{out}}(t_k) = 1.0$，\n    - 对所有 $k$，$w_k = 1.0$，\n    - $\\alpha = 0.01$，\n    - $R_{\\min} = 0.6$， $R_{\\max} = 1.4$，\n    - $\\delta T(t_k) = 0.02\\sin\\!\\bigl(2\\pi k/N\\bigr)$。\n\n- 测试用例C（斜坡式CBET，分段 $H_2$，不等几何）：\n    - $N = 64$，\n    - $T(t_k) = 0.1 + 0.4\\,\\frac{k}{N-1}$，\n    - $H_2(t_k) = \\begin{cases}1.0 & \\text{当 } k < N/2 \\\\ 0.6 & \\text{当 } k \\ge N/2 \\end{cases}$\n    - $G_{\\text{in}}(t_k) = 1.2$， $G_{\\text{out}}(t_k) = 0.8$，\n    - 对所有 $k$，$w_k = 1.0$，\n    - $\\alpha = 0.02$，\n    - $R_{\\min} = 0.5$， $R_{\\max} = 1.8$，\n    - $\\delta T(t_k) = 0.02 + 0.01\\sin\\!\\bigl(2\\pi k/N\\bigr)$。\n\n- 测试用例D（小 $H_2$，强平滑）：\n    - $N = 64$，\n    - $T(t_k) = 0.3$，\n    - $H_2(t_k) = 0.05 + 0.05\\sin\\!\\bigl(2\\pi k/N\\bigr)$，\n    - $G_{\\text{in}}(t_k) = 1.0$， $G_{\\text{out}}(t_k) = 1.0$，\n    - 对所有 $k$，$w_k = 1.0$，\n    - $\\alpha = 0.2$，\n    - $R_{\\min} = 0.7$， $R_{\\max} = 1.3$，\n    - $\\delta T(t_k) = 0.02\\sin\\!\\bigl(6\\pi k/N\\bigr)$。\n\n对每个测试用例，计算：\n- 使用标称 $T(t)$ 时的最小化代价，记为 $J^\\star$。\n- 使用微扰后的转移 $T(t) + \\delta T(t)$ 时的最小化代价，记为 $J^\\star_{\\text{pert}}$。\n- 有限差分灵敏度度量\n$$\nS = \\frac{J^\\star_{\\text{pert}} - J^\\star}{\\left\\|\\delta T\\right\\|_2},\n$$\n其中 $\\left\\|\\delta T\\right\\|_2 = \\Bigl(\\sum_{k=0}^{N-1} \\bigl(\\delta T(t_k)\\bigr)^2\\Bigr)^{1/2}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[result1,result2,\\dots]$）。该序列必须按顺序连接测试用例 A、B、C、D 的每个浮点数三元组 $\\bigl(J^\\star, J^\\star_{\\text{pert}}, S\\bigr)$。不允许有其他输出。",
            "solution": "该问题要求确定一个最优的内外锥功率比 $R(t)$，以在惯性约束聚变中维持黑腔驱动的对称性。这被表述为一个约束优化问题，我们将使用投影梯度下降法来求解。分析过程包括三个主要阶段：推导二次规划，设计数值求解器，以及执行灵敏度分析。\n\n### 1. 二次规划的推导\n\n问题的核心是在控制变量 $R(t)$ 的箱式约束下，最小化代价泛函 $J[R]$。首先，我们必须将代价泛函 $J[R]$ 表示为关于离散化功率比向量 $\\mathbf{R} = [R_0, R_1, \\dots, R_{N-1}]^T$ 的二次型形式，其中 $R_k = R(t_k)$。\n\n模式2驱动不平衡幅度 $a_2(t_k)$ 由下式给出：\n$$\na_2(t_k) = H_2(t_k)\\,\\bigl[\\,G_{\\text{out}}(t_k)\\,P_{\\text{out}}^{\\text{eff}}(t_k) - G_{\\text{in}}(t_k)\\,P_{\\text{in}}^{\\text{eff}}(t_k)\\,\\bigr]\n$$\n使用关系式 $P_{\\text{in}}(t) = R(t)P_{\\text{out}}(t)$、包含跨束能量转移（CBET）的等效功率定义以及归一化条件 $P_{\\text{out}}(t) \\equiv 1$，我们得到：\n$$\nP_{\\text{in}}^{\\text{eff}}(t_k) = R(t_k) + T(t_k) = R_k + T_k\n$$\n$$\nP_{\\text{out}}^{\\text{eff}}(t_k) = 1 - T(t_k)\n$$\n将这些代入 $a_2(t_k)$ 的表达式中：\n$$\na_2(t_k) = H_{2,k}\\,[G_{\\text{out},k}(1 - T_k) - G_{\\text{in},k}(R_k + T_k)]\n$$\n这证实了 $a_2(t_k)$ 是 $R_k$ 的线性函数。让我们将包含 $R_k$ 的项和不依赖于它的项分组：\n$$\na_2(t_k) = \\underbrace{(-H_{2,k} G_{\\text{in},k})}_{f_k} R_k + \\underbrace{H_{2,k}\\,[G_{\\text{out},k}(1 - T_k) - G_{\\text{in},k}T_k]}_{g_k}\n$$\n因此，我们可以写成 $a_{2,k} = f_k R_k + g_k$。在向量表示法中，其中 $\\mathbf{a}_2$、$\\mathbf{R}$ 和 $\\mathbf{g}$ 是长度为 $N$ 的列向量，$\\mathbf{F}$ 是对角矩阵且 $F_{kk} = f_k$，此关系变为：\n$$\n\\mathbf{a}_2 = \\mathbf{F}\\mathbf{R} + \\mathbf{g}\n$$\n代价泛函 $J[R]$ 由两部分组成：对称性不平衡惩罚项和时间平滑性正则化项。\n$$\nJ[R] = \\sum_{k=0}^{N-1} w_k\\,\\bigl(a_2(t_k)\\bigr)^2 \\;+\\; \\alpha\\,\\sum_{k=0}^{N-2}\\bigl(R_{k+1} - R_k\\bigr)^2\n$$\n第一项可以写成矩阵形式 $\\mathbf{a}_2^T \\mathbf{W} \\mathbf{a}_2$，其中 $\\mathbf{W}$ 是对角矩阵，其元素为 $W_{kk} = w_k$：\n$$\n\\sum_{k=0}^{N-1} w_k a_{2,k}^2 = (\\mathbf{F}\\mathbf{R} + \\mathbf{g})^T \\mathbf{W} (\\mathbf{F}\\mathbf{R} + \\mathbf{g}) = \\mathbf{R}^T\\mathbf{F}^T\\mathbf{W}\\mathbf{F}\\mathbf{R} + 2\\mathbf{g}^T\\mathbf{W}\\mathbf{F}\\mathbf{R} + \\mathbf{g}^T\\mathbf{W}\\mathbf{g}\n$$\n第二项，即吉洪诺夫（Tikhonov）正则化项，可以表示为 $\\alpha \\mathbf{R}^T \\mathbf{D} \\mathbf{R}$，其中 $\\mathbf{D}$ 是表示二阶有限差分算子（对于这些边界条件，即一维离散拉普拉斯算子）的 $N \\times N$ 矩阵：\n$$\n\\mathbf{D} = \n\\begin{pmatrix}\n1  & -1 & 0 & \\dots & 0 \\\\\n-1 & 2 & -1 & \\dots & 0 \\\\\n0 & -1 & 2 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & 2 & -1 \\\\\n0 & 0 & \\dots & -1 & 1\n\\end{pmatrix}\n$$\n结合这些项，代价泛函变为：\n$$\nJ(\\mathbf{R}) = \\mathbf{R}^T (\\mathbf{F}^T\\mathbf{W}\\mathbf{F} + \\alpha\\mathbf{D})\\mathbf{R} + 2(\\mathbf{F}^T\\mathbf{W}\\mathbf{g})^T \\mathbf{R} + \\mathbf{g}^T\\mathbf{W}\\mathbf{g}\n$$\n这是一个标准的二次型。为简化起见，我们定义系统矩阵 $\\mathbf{A}$ 和向量 $\\mathbf{b}$：\n$$\n\\mathbf{A} = \\mathbf{F}^T\\mathbf{W}\\mathbf{F} + \\alpha\\mathbf{D} \\qquad \\text{和} \\qquad \\mathbf{b} = -\\mathbf{F}^T\\mathbf{W}\\mathbf{g}\n$$\n矩阵 $\\mathbf{A}$ 是对称正定的，因为 $\\mathbf{F}^T\\mathbf{W}\\mathbf{F}$ 是对角矩阵，其元素非负（如果任何 $f_k \\neq 0$ 则为正），而 $\\mathbf{D}$ 是半正定的，$\\alpha > 0$ 保证了正定性。代价泛函，忽略不影响最小化器的常数项 $\\mathbf{g}^T\\mathbf{W}\\mathbf{g}$，为：\n$$\nJ(\\mathbf{R}) \\propto \\frac{1}{2}\\mathbf{R}^T (2\\mathbf{A}) \\mathbf{R} - (2\\mathbf{b})^T \\mathbf{R}\n$$\n通过将其关于 $\\mathbf{R}$ 的梯度设为零，可以找到此泛函的无约束最小值：\n$$\n\\nabla_{\\mathbf{R}} J = 2\\mathbf{A}\\mathbf{R} - 2\\mathbf{b} = \\mathbf{0} \\implies \\mathbf{A}\\mathbf{R} = \\mathbf{b}\n$$\n此线性方程组的解 $\\mathbf{R}_{\\text{uncon}} = \\mathbf{A}^{-1}\\mathbf{b}$ 给出了无约束的最优功率比。\n\n### 2. 算法求解：投影梯度下降\n\n该问题要求在对所有 $k$ 满足箱式约束 $R_{\\min} \\le R_k \\le R_{\\max}$ 的条件下，找到 $J(\\mathbf{R})$ 的最小值。这个约束优化问题可以使用投影梯度下降法有效求解。该算法通过沿负梯度方向迈出一步，然后将结果投影回可行集（由约束定义的箱式区域）来迭代更新解。\n\n迭代更新规则为：\n$$\n\\mathbf{R}^{(m+1)} = \\mathcal{P}_{[\\mathbf{R}_{\\min}, \\mathbf{R}_{\\max}]}(\\mathbf{R}^{(m)} - \\eta \\nabla J(\\mathbf{R}^{(m)}))\n$$\n其中 $m$ 是迭代索引，$\\eta$ 是步长，$\\mathcal{P}$ 是投影算子。对于箱式约束，投影是一个简单的逐元素裁剪操作：\n$$\n(\\mathcal{P}_{[\\mathbf{R}_{\\min}, \\mathbf{R}_{\\max}]}(\\mathbf{v}))_k = \\max(R_{\\min}, \\min(R_{\\max}, v_k))\n$$\n梯度为 $\\nabla J(\\mathbf{R}) = 2(\\mathbf{A}\\mathbf{R} - \\mathbf{b})$。算法按以下步骤进行：\n1.  **初始化**：计算无约束解 $\\mathbf{R}_{\\text{uncon}} = \\mathbf{A}^{-1}\\mathbf{b}$ 作为初始猜测值 $\\mathbf{R}^{(0)} = \\mathbf{R}_{\\text{uncon}}$。\n2.  **步长选择**：为使梯度下降收敛，步长 $\\eta$ 必须满足 $0  \\eta  1/\\lambda_{\\max}(2\\mathbf{A})$，其中 $\\lambda_{\\max}$ 是矩阵的最大特征值（谱半径）。我们可以使用 $\\lambda_{\\max}(2\\mathbf{A})$ 的一个上界来确定一个安全的步长。盖尔什戈林圆盘定理提供了一个方便的界。对于对称矩阵 $\\mathbf{A}$，其最大特征值受以下不等式约束：\n    $$\n    \\lambda_{\\max}(\\mathbf{A}) \\le \\max_i \\left( A_{ii} + \\sum_{j \\neq i} |A_{ij}| \\right)\n    $$\n    由于 $\\mathbf{A} = \\text{diag}(w_k f_k^2) + \\alpha\\mathbf{D}$，我们有 $A_{ii} = w_i f_i^2 + \\alpha D_{ii}$，并且 $A_{i,j \\neq i}$ 是 $\\alpha\\mathbf{D}$ 的非零非对角元素，即 $-\\alpha$。非对角元素绝对值的最大行和为 $2\\alpha$。$\\mathbf{D}$ 的对角元素为 $1$ 或 $2$。因此，一个简单的上界是：\n    $$\n    \\rho_{\\text{upper}} = \\max_k(w_k f_k^2) + 4\\alpha\n    $$\n    我们选择步长 $\\eta = 0.5 / \\rho_{\\text{upper}}$ 来确保鲁棒收敛（对于 $\\nabla J = 2(\\mathbf{AR}-\\mathbf{b})$ 的形式）。\n3.  **迭代**：对固定次数的迭代更新解 $\\mathbf{R}$：\n    $$\n    \\mathbf{R}^{(m+1)} = \\mathcal{P}_{[\\mathbf{R}_{\\min}, \\mathbf{R}_{\\max}]}(\\mathbf{R}^{(m)} - \\eta(2(\\mathbf{A}\\mathbf{R}^{(m)} - \\mathbf{b})))\n    $$\n    经过足够多的迭代次数后，$\\mathbf{R}^{(m)}$ 收敛到最优约束解 $\\mathbf{R}^\\star$。\n\n### 3. 灵敏度分析\n\n灵敏度分析量化了最小化代价 $J^\\star$ 如何响应CBET转移分数中的微小扰动 $\\delta T(t)$ 而变化。其步骤如下：\n1.  **标称解**：对于给定的测试用例，使用标称的 $T(t_k)$ 构建矩阵 $\\mathbf{A}$ 和向量 $\\mathbf{b}$。使用投影梯度下降法求解最优解 $\\mathbf{R}^\\star$。使用原始代价泛函定义计算最小化代价 $J^\\star = J[\\mathbf{R}^\\star]$。\n2.  **微扰解**：创建一个微扰后的转移分数 $T'(t_k) = T(t_k) + \\delta T(t_k)$。这个扰动只影响向量 $\\mathbf{g}$，进而修改向量 $\\mathbf{b}$。系统矩阵 $\\mathbf{A}$ 保持不变。设新向量为 $\\mathbf{b}'$。在相同的约束下求解新问题 $\\mathbf{A}\\mathbf{R} = \\mathbf{b}'$，得到微扰后的最优解 $\\mathbf{R}^\\star_{\\text{pert}}$。\n3.  **微扰代价**：计算代价 $J^\\star_{\\text{pert}} = J'[\\mathbf{R}^\\star_{\\text{pert}}]$，其中 $J'$ 是使用微扰输入（$T'$ 以及因此产生的 $g'$）计算的代价泛函。\n4.  **灵敏度度量**：计算有限差分灵敏度：\n    $$\n    S = \\frac{J^\\star_{\\text{pert}} - J^\\star}{\\left\\|\\delta T\\right\\|_2}\n    $$\n    其中 $\\left\\|\\delta T\\right\\|_2$ 是扰动向量 $\\delta \\mathbf{T}$ 的欧几里得范数。\n\n将此完整过程应用于问题陈述中提供的每个测试用例，以生成所需的数值结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n\n    # Define test cases as per the problem statement.\n    test_cases = [\n        # Test case A\n        {\n            \"N\": 64,\n            \"T_func\": lambda k, N: 0.25,\n            \"H2_func\": lambda k, N: 0.8 + 0.2 * np.sin(2 * np.pi * k / N),\n            \"Gin_func\": lambda k, N: 1.0,\n            \"Gout_func\": lambda k, N: 1.0,\n            \"w_func\": lambda k, N: 1.0,\n            \"alpha\": 0.01,\n            \"Rmin\": 0.6,\n            \"Rmax\": 1.4,\n            \"deltaT_func\": lambda k, N: 0.02 * np.cos(4 * np.pi * k / N),\n        },\n        # Test case B\n        {\n            \"N\": 64,\n            \"T_func\": lambda k, N: 0.0,\n            \"H2_func\": lambda k, N: 1.0,\n            \"Gin_func\": lambda k, N: 1.0,\n            \"Gout_func\": lambda k, N: 1.0,\n            \"w_func\": lambda k, N: 1.0,\n            \"alpha\": 0.01,\n            \"Rmin\": 0.6,\n            \"Rmax\": 1.4,\n            \"deltaT_func\": lambda k, N: 0.02 * np.sin(2 * np.pi * k / N),\n        },\n        # Test case C\n        {\n            \"N\": 64,\n            \"T_func\": lambda k, N: 0.1 + 0.4 * k / (N - 1),\n            \"H2_func\": lambda k, N: 1.0 if k  N / 2 else 0.6,\n            \"Gin_func\": lambda k, N: 1.2,\n            \"Gout_func\": lambda k, N: 0.8,\n            \"w_func\": lambda k, N: 1.0,\n            \"alpha\": 0.02,\n            \"Rmin\": 0.5,\n            \"Rmax\": 1.8,\n            \"deltaT_func\": lambda k, N: 0.02 + 0.01 * np.sin(2 * np.pi * k / N),\n        },\n        # Test case D\n        {\n            \"N\": 64,\n            \"T_func\": lambda k, N: 0.3,\n            \"H2_func\": lambda k, N: 0.05 + 0.05 * np.sin(2 * np.pi * k / N),\n            \"Gin_func\": lambda k, N: 1.0,\n            \"Gout_func\": lambda k, N: 1.0,\n            \"w_func\": lambda k, N: 1.0,\n            \"alpha\": 0.2,\n            \"Rmin\": 0.7,\n            \"Rmax\": 1.3,\n            \"deltaT_func\": lambda k, N: 0.02 * np.sin(6 * np.pi * k / N),\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        J_star, J_star_pert, S = run_case(case)\n        all_results.extend([J_star, J_star_pert, S])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\n\ndef calculate_cost(R, T, H2, Gin, Gout, w, alpha):\n    \"\"\"Calculates the cost functional J[R].\"\"\"\n    N = len(R)\n    # Calculate a2(t_k)\n    a2 = H2 * (Gout * (1 - T) - Gin * (R + T))\n    \n    # Imbalance term\n    imbalance_cost = np.sum(w * (a2**2))\n    \n    # Smoothness term\n    diff_R = R[1:] - R[:-1]\n    smoothness_cost = alpha * np.sum(diff_R**2)\n    \n    return imbalance_cost + smoothness_cost\n\n\ndef optimize_R(params):\n    \"\"\"\n    Solves for the optimal R* using projected gradient descent.\n    \"\"\"\n    N = params['N']\n    k = np.arange(N)\n    T = np.array([params['T_func'](i, N) for i in k])\n    H2 = np.array([params['H2_func'](i, N) for i in k])\n    Gin = np.array([params['Gin_func'](i, N) for i in k])\n    Gout = np.array([params['Gout_func'](i, N) for i in k])\n    w = np.array([params['w_func'](i, N) for i in k])\n    alpha = params['alpha']\n    Rmin = params['Rmin']\n    Rmax = params['Rmax']\n    \n    # 1. Construct matrices for the QP: A*R = b\n    # f_k = -H_{2,k} * G_{in,k}\n    f = -H2 * Gin\n    # g_k = H_{2,k} * [G_{out,k}(1-T_k) - G_{in,k}T_k]\n    g = H2 * (Gout * (1 - T) - Gin * T)\n    \n    # Matrix A = F^T*W*F + alpha*D, where F is diag(f) and W is diag(w)\n    # F^T*W*F is diagonal with entries w_k * f_k^2\n    A_diag = w * f**2\n    \n    # Matrix D for smoothness term\n    D = np.diag(2 * np.ones(N)) - np.diag(np.ones(N - 1), k=1) - np.diag(np.ones(N - 1), k=-1)\n    D[0, 0] = 1\n    D[N - 1, N - 1] = 1\n    \n    A = np.diag(A_diag) + alpha * D\n    \n    # Vector b = -F^T*W*g\n    b = -f * w * g\n    \n    # 2. Solve for optimal R using projected gradient descent\n    # Initial guess: unconstrained solution\n    try:\n        R_uncon = np.linalg.solve(A, b)\n    except np.linalg.LinAlgError:\n        R_uncon = np.linalg.lstsq(A, b, rcond=None)[0]\n    \n    R = R_uncon.copy()\n\n    # Step size selection\n    rho_upper = np.max(A_diag) + 4 * alpha\n    # The gradient of J is 2*(AR-b). For update R_new = R - step * grad(J),\n    # we need step  1/lambda_max(A) to ensure convergence of the fixed point iteration on the gradient.\n    # The update is R_{k+1} = R_k - eta * (2*(A*R-b))\n    # We choose eta = 0.5 / rho_upper, so eta*2 = 1/rho_upper.\n    eta = 0.5 / rho_upper \n\n    num_iterations = 20000 \n    for _ in range(num_iterations):\n        grad = 2 * (A @ R - b)\n        R_new = R - eta * grad\n        R = np.clip(R_new, Rmin, Rmax)\n        # Convergence check could be added, but fixed iterations are sufficient here.\n\n    # 3. Calculate final cost\n    final_cost = calculate_cost(R, T, H2, Gin, Gout, w, alpha)\n    \n    return R, final_cost\n\n\ndef run_case(case_params):\n    \"\"\"\n    Runs a single test case for both nominal and perturbed T.\n    \"\"\"\n    N = case_params['N']\n    k = np.arange(N)\n    \n    # Nominal case\n    params_nom = case_params.copy()\n    _, J_star = optimize_R(params_nom)\n\n    # Perturbed case\n    params_pert = case_params.copy()\n    deltaT = np.array([params_pert['deltaT_func'](i, N) for i in k])\n    T_nom_func = params_pert['T_func']\n    # Create a new lambda that incorporates the perturbation\n    params_pert['T_func'] = lambda i, n, T_nom=T_nom_func, dt=deltaT: T_nom(i, n) + dt[i]\n    \n    _, J_star_pert = optimize_R(params_pert)\n\n    # Sensitivity metric\n    norm_delta_T = np.linalg.norm(deltaT)\n    if norm_delta_T == 0:\n        S = 0.0\n    else:\n        S = (J_star_pert - J_star) / norm_delta_T\n\n    return J_star, J_star_pert, S\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}