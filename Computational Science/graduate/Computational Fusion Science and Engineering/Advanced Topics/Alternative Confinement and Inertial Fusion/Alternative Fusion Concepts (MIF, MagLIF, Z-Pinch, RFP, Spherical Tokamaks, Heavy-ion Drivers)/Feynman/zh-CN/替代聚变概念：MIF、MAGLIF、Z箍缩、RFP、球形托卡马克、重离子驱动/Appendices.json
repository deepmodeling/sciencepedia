{
    "hands_on_practices": [
        {
            "introduction": "在实现聚变之前，燃料通常需要被预热到一个初始等离子体状态。这个过程需要精确计算能量收支，以确保驱动器能够提供足够的能量来增加等离子体的内能，同时补偿能量损失。本练习  将引导你完成一个基础但至关重要的能量平衡估算，你需要考虑等离子体热能的增加以及轫致辐射造成的不可避免的能量损失，从而确定预热阶段所需的最小驱动能量。",
            "id": "3950883",
            "problem": "在一个磁化套筒惯性聚变 (MagLIF) 构型中，一个圆柱形氘氚燃料柱被预热，这是磁惯性聚变 (MIF) 的一种典型形式。假设燃料在空间上是均匀的、完全电离的，并且对其自身的轫致辐射是光学薄的。该圆柱体的长度为 $L = 5\\,\\mathrm{mm}$，半径为 $R = 2\\,\\mathrm{mm}$，总粒子数密度（电子加离子）为 $n = 1.0\\times 10^{23}\\,\\mathrm{m}^{-3}$。离子电荷数为 $Z=1$。预热驱动器在 $\\tau = 100\\,\\mathrm{ns}$ 的脉冲持续时间内，将等离子体温度从 $0$ 提高到最终值 $T = 5\\,\\mathrm{keV}$，温度呈线性增长，即在 $0 \\le t \\le \\tau$ 时间段内，$T(t) = T\\, t/\\tau$。为了获得一个下限估计，忽略了诸如热传导和端部损失等非辐射损失。\n\n从能量守恒出发，最小驱动能量是内能的增加量与加热时间内因轫致辐射造成的辐射损失之和。使用能量均分假设 $T_e = T_i = T$，因此内能的增加是两种粒子（电子和离子）的总和。对于光学薄的自由-自由发射，体积轫致辐射功率密度的形式为 $P_{\\mathrm{br}}(t) = C\\, n_e n_i Z^2 \\sqrt{T(t)}$，其中 $C = 1.69\\times 10^{-38} g_B\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$，冈特因子 $g_B = 1.2$。对于 $Z=1$ 的情况，根据准中性条件，有 $n_e = n_i = n/2$。将等离子体体积视为 $V = \\pi R^2 L$，并使用 $k_B T = (\\text{每个粒子的能量})$ 的关系将温度 $T$ 从 $\\mathrm{keV}$ 转换为 $\\mathrm{K}$，其中 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$，玻尔兹曼常数 $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n推导所需驱动能量的表达式，并根据给定参数进行数值计算。最终能量以 $\\mathrm{kJ}$ 为单位表示，并将您的答案四舍五入到三位有效数字。",
            "solution": "问题要求计算预热圆柱形氘氚燃料柱所需的最小驱动能量。该能量是等离子体内能的增加量与加热过程中因轫致辐射损失的能量之和。我们首先写出能量守恒方程：\n$$\nE_{\\mathrm{driver}} = \\Delta E_{\\mathrm{thermal}} + E_{\\mathrm{rad}}\n$$\n其中 $\\Delta E_{\\mathrm{thermal}}$ 是等离子体总内能的变化量，$E_{\\mathrm{rad}}$ 是总辐射能量。我们将推导每一项的表达式，然后将它们相加得到总驱动能量。\n\n首先，我们计算内能的变化量 $\\Delta E_{\\mathrm{thermal}}$。等离子体由电子和离子组成，对于理想气体，其内能由 $E_{\\mathrm{thermal}} = \\frac{3}{2} N k_B T$ 给出，其中 $N$ 是总粒子数，$k_B$ 是玻尔兹曼常数，$T$ 是温度。总粒子数是总粒子数密度 $n$ 乘以等离子体体积 $V$。圆柱体的体积是 $V = \\pi R^2 L$。因此，$N = nV = n\\pi R^2 L$。\n\n内能的变化量是最终能量减去初始能量：\n$$\n\\Delta E_{\\mathrm{thermal}} = E_{\\mathrm{thermal, final}} - E_{\\mathrm{thermal, initial}} = \\frac{3}{2} N k_B T_f - \\frac{3}{2} N k_B T(0)\n$$\n题目说明加热从温度 $0$ 开始，所以 $T(0) = 0$。最终温度记为 $T_f$。因此，内能的变化量就是最终的内能：\n$$\n\\Delta E_{\\mathrm{thermal}} = \\frac{3}{2} N k_B T_f = \\frac{3}{2} (n \\pi R^2 L) k_B T_f\n$$\n注意，量 $k_B T_f$ 代表每个粒子的最终热能，其给定值为 $5\\,\\mathrm{keV}$。\n\n接下来，我们计算总辐射能量 $E_{\\mathrm{rad}}$。该能量是总辐射功率 $P_{\\mathrm{rad}}(t)$ 在加热脉冲持续时间 $\\tau$ 内的时间积分。\n$$\nE_{\\mathrm{rad}} = \\int_0^\\tau P_{\\mathrm{rad}}(t)\\,dt\n$$\n总功率是体积功率密度 $P_{\\mathrm{br}}(t)$ 乘以等离子体体积 $V$。\n$$\nP_{\\mathrm{rad}}(t) = V \\cdot P_{\\mathrm{br}}(t) = (\\pi R^2 L) P_{\\mathrm{br}}(t)\n$$\n体积轫致辐射功率密度由 $P_{\\mathrm{br}}(t) = C n_e n_i Z^2 \\sqrt{T(t)}$ 给出。对于具有单电荷离子（$Z=1$）的准中性等离子体，电子密度 $n_e$ 和离子密度 $n_i$ 都等于总粒子密度 $n$ 的一半，即 $n_e = n_i = n/2$。将这些代入功率密度表达式可得：\n$$\nP_{\\mathrm{br}}(t) = C \\left(\\frac{n}{2}\\right) \\left(\\frac{n}{2}\\right) (1)^2 \\sqrt{T(t)} = \\frac{1}{4} C n^2 \\sqrt{T(t)}\n$$\n温度随时间线性增加，关系式为 $T(t) = T_f \\frac{t}{\\tau}$（$0 \\le t \\le \\tau$）。将此代入 $P_{\\mathrm{br}}(t)$ 的表达式中得到：\n$$\nP_{\\mathrm{br}}(t) = \\frac{1}{4} C n^2 \\sqrt{T_f \\frac{t}{\\tau}} = \\frac{C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} t^{1/2}\n$$\n现在，我们可以对总功率 $P_{\\mathrm{rad}}(t) = V \\cdot P_{\\mathrm{br}}(t)$ 从 $t=0$ 到 $t=\\tau$ 进行积分：\n$$\nE_{\\mathrm{rad}} = \\int_0^\\tau (\\pi R^2 L) \\left( \\frac{C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} t^{1/2} \\right) dt\n$$\n与 $t$ 无关的项可以移到积分号外：\n$$\nE_{\\mathrm{rad}} = \\frac{\\pi R^2 L C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} \\int_0^\\tau t^{1/2} dt\n$$\n$t^{1/2}$ 的积分是 $\\frac{2}{3} t^{3/2}$。计算其从 $0$ 到 $\\tau$ 的定积分：\n$$\n\\int_0^\\tau t^{1/2} dt = \\left[ \\frac{2}{3} t^{3/2} \\right]_0^\\tau = \\frac{2}{3} \\tau^{3/2}\n$$\n将此结果代回 $E_{\\mathrm{rad}}$ 的表达式中：\n$$\nE_{\\mathrm{rad}} = \\frac{\\pi R^2 L C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} \\left( \\frac{2}{3} \\tau^{3/2} \\right) = \\frac{2}{12} (\\pi R^2 L) C n^2 \\sqrt{T_f} \\frac{\\tau^{3/2}}{\\tau^{1/2}}\n$$\n$$\nE_{\\mathrm{rad}} = \\frac{1}{6} (\\pi R^2 L) C n^2 \\tau \\sqrt{T_f}\n$$\n所需的总驱动能量是这两个分量的和：\n$$\nE_{\\mathrm{driver}} = \\frac{3}{2} n (\\pi R^2 L) k_B T_f + \\frac{1}{6} (\\pi R^2 L) C n^2 \\tau \\sqrt{T_f}\n$$\n这是驱动能量的最终解析表达式。\n\n现在我们对该表达式进行数值计算。首先，我们列出国际单位制（SI）下的给定参数：\n- 长度: $L = 5\\,\\mathrm{mm} = 5 \\times 10^{-3}\\,\\mathrm{m}$\n- 半径: $R = 2\\,\\mathrm{mm} = 2 \\times 10^{-3}\\,\\mathrm{m}$\n- 总粒子数密度: $n = 1.0 \\times 10^{23}\\,\\mathrm{m}^{-3}$\n- 最终温度（每个粒子的能量）: $E_p = 5\\,\\mathrm{keV} = 5 \\times 10^3\\,\\mathrm{eV} \\times (1.602176634\\times 10^{-19}\\,\\mathrm{J/eV}) = 8.01088 \\times 10^{-16}\\,\\mathrm{J}$。这一项等效于 $k_B T_f$。\n- 脉冲持续时间: $\\tau = 100\\,\\mathrm{ns} = 1.0 \\times 10^{-7}\\,\\mathrm{s}$\n- 轫致辐射常数系数: $C_{base} = 1.69\\times 10^{-38}\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$\n- 冈特因子: $g_B = 1.2$\n- 玻尔兹曼常数: $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n\n首先，我们计算常数和派生量：\n- 等离子体体积: $V = \\pi R^2 L = \\pi (2\\times 10^{-3}\\,\\mathrm{m})^2 (5\\times 10^{-3}\\,\\mathrm{m}) = 2\\pi \\times 10^{-8}\\,\\mathrm{m}^3$。\n- 最终温度（开尔文）: $T_f = E_p / k_B = (8.01088 \\times 10^{-16}\\,\\mathrm{J}) / (1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\approx 5.8021 \\times 10^7\\,\\mathrm{K}$。\n- 包含冈特因子的轫致辐射常数: $C = C_{base} \\times g_B = (1.69\\times 10^{-38}) \\times 1.2 = 2.028 \\times 10^{-38}\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$。\n\n现在我们计算两个能量项：\n- 内能增加量：\n$\\Delta E_{\\mathrm{thermal}} = \\frac{3}{2} n V (k_B T_f) = \\frac{3}{2} (1.0 \\times 10^{23}\\,\\mathrm{m}^{-3}) (2\\pi \\times 10^{-8}\\,\\mathrm{m}^3) (8.01088 \\times 10^{-16}\\,\\mathrm{J}) \\approx 7.5498\\,\\mathrm{J}$。\n\n- 辐射能量：\n$E_{\\mathrm{rad}} = \\frac{1}{6} V C n^2 \\tau \\sqrt{T_f}$\n$E_{\\mathrm{rad}} = \\frac{1}{6} (2\\pi \\times 10^{-8}) (2.028 \\times 10^{-38}) (1.0 \\times 10^{23})^2 (1.0 \\times 10^{-7}) \\sqrt{5.8021 \\times 10^7}$\n$E_{\\mathrm{rad}} \\approx \\frac{\\pi}{3} (10^{-8}) (2.028 \\times 10^{-38}) (10^{46}) (10^{-7}) (7.617 \\times 10^3) \\approx 0.001618\\,\\mathrm{J}$。\n\n总驱动能量为各项之和：\n$E_{\\mathrm{driver}} = \\Delta E_{\\mathrm{thermal}} + E_{\\mathrm{rad}} \\approx 7.5498\\,\\mathrm{J} + 0.001618\\,\\mathrm{J} \\approx 7.5514\\,\\mathrm{J}$。\n\n问题要求答案以千焦（$\\mathrm{kJ}$）为单位，并四舍五入到三位有效数字。\n$E_{\\mathrm{driver}} = 7.5514\\,\\mathrm{J} = 0.0075514\\,\\mathrm{kJ}$。\n四舍五入到三位有效数字，我们得到 $0.00755\\,\\mathrm{kJ}$。",
            "answer": "$$\\boxed{0.00755}$$"
        },
        {
            "introduction": "在许多惯性聚变方案中，通过一个内爆的“衬套”或“推杆”向燃料发射一系列冲击波，是实现燃料剧烈压缩的关键。为了在燃料中心实现最大程度的压缩，这些冲击波必须精确地同时到达。本练习  探讨了冲击波定时的核心问题，你将通过编程一个基于强冲击波物理的模型，学习如何精心设计内爆过程，以实现冲击波的会聚。",
            "id": "3950850",
            "problem": "考虑一个由磁化套筒惯性聚变（MagLIF）驱动的内爆金属套筒驱动的球对称磁惯性聚变（MIF）靶丸。燃料占据套筒内表面内部的区域，假定其初始半径为 $R_0$。当套筒内爆时，在每个瞬时内半径 $R$ 处，它会向燃料中发射一个向内传播的激波。燃料被建模为具有均匀质量密度 $\\rho_f$ 和绝热指数 $\\gamma$ 的理想气体，套筒则充当一个活塞，其向内速度剖面为 $v(R)$，其中 $R$ 是瞬时套筒内半径。假设为球对称，并忽略辐射损失、磁场效应以及套筒和燃料的材料强度（除了它们在设定活塞速度和激波传播中的作用）。\n\n从可压缩流的质量、动量和能量守恒以及跨越激波的朗肯-雨贡纽跳跃条件出发，构建一个算法。该算法针对在半径 $\\{R_i\\}$ 处的一系列离散激波发射，计算使激波在燃料中心汇聚所需的发射时间 $t_{\\mathrm{launch}}(R_i)$ 以及由此产生的中心压力估算值。使用以下建模假设将物理原理与计算过程联系起来：\n- 在激波发射的瞬间，每个激波前方的燃料相对于实验室参考系初始处于静止状态。\n- 在实验室参考系中，活塞驱动的激波速度 $U_s(R)$ 由活塞速度 $v(R)$ 和强激波极限下的理想气体跳跃条件确定，而波后压力 $p_2(R)$ 由上游燃料性质和 $U_s(R)$ 确定。\n- 在半径 $R$ 处发射的激波到达中心的行进距离为 $R$，行进时间为 $R / U_s(R)$。\n- 发射时间 $t_{\\mathrm{launch}}(R)$ 等于套筒内表面遵循速度剖面 $v(R)$ 从 $R_0$ 移动到 $R$ 所需的时间，即形式为 $\\int_{R}^{R_0} \\frac{d\\xi}{v(\\xi)}$ 的积分。\n- 为了在共同时间 $t_c$ 在中心实现完美汇聚，对每个在 $R_i$ 处发射的激波所需的时间调整为 $\\delta t(R_i) = t_c - \\left(t_{\\mathrm{launch}}(R_i) + \\frac{R_i}{U_s(R_i)}\\right)$，该值必须为非负。\n\n您的程序必须为以下三个测试用例实现此算法，每个用例指定了一个物理上合理的速度剖面 $v(R)$、燃料性质以及一组在 $R_{\\min}$ 和 $R_0$ 之间（含两端）均匀间隔的离散发射半径。对于每个用例，计算：\n1. 汇聚时间 $t_c$（单位：秒），定义为 $t_{\\mathrm{launch}}(R_i) + \\frac{R_i}{U_s(R_i)}$ 对所有 $i$ 的最大值。\n2. 中心压力估算值 $p_c$（单位：帕斯卡），取为 $p_2(R_i)$ 对所有 $i$ 的最大值。\n3. 最大所需时间调整 $\\max_i \\delta t(R_i)$（单位：秒），代表为确保在 $t_c$ 时刻汇聚所需的最大延迟。\n\n所有时间以秒表示，所有压力以帕斯卡表示，均为实数值。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容按测试用例排序，且每个测试用例内部按 $[t_c, p_c, \\max \\delta t]$ 的顺序排列。\n\n测试套件：\n- 用例A（理想路径，恒速套筒）：\n  - $R_0 = 3 \\times 10^{-3}\\,\\mathrm{m}$，$R_{\\min} = 1 \\times 10^{-3}\\,\\mathrm{m}$，$N = 5$ 个发射半径。\n  - $v(R) = v_0$，其中 $v_0 = 5.0 \\times 10^{4}\\,\\mathrm{m/s}$。\n  - $\\rho_f = 1.0\\,\\mathrm{kg/m^3}$，$\\gamma = 5/3$。\n- 用例B（套筒随半径中等加速）：\n  - $R_0 = 4 \\times 10^{-3}\\,\\mathrm{m}$，$R_{\\min} = 1 \\times 10^{-3}\\,\\mathrm{m}$，$N = 7$ 个发射半径。\n  - $v(R) = v_0 + k \\left(R_0 - R\\right)$，其中 $v_0 = 3.0 \\times 10^{4}\\,\\mathrm{m/s}$ 且 $k = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}$。\n  - $\\rho_f = 1.2\\,\\mathrm{kg/m^3}$，$\\gamma = 5/3$。\n- 用例C（套筒速度随半径减小呈幂律增长）：\n  - $R_0 = 5 \\times 10^{-3}\\,\\mathrm{m}$，$R_{\\min} = 1 \\times 10^{-3}\\,\\mathrm{m}$，$N = 9$ 个发射半径。\n  - $v(R) = v_0 \\left(\\frac{R}{R_0}\\right)^{-n}$，其中 $v_0 = 2.0 \\times 10^{4}\\,\\mathrm{m/s}$ 且 $n = 0.5$。\n  - $\\rho_f = 0.5\\,\\mathrm{kg/m^3}$，$\\gamma = 1.4$。\n\n您的程序必须一致地融合物理原理，并通过使用提供的速度剖面，积分从 $R_0$ 到每个发射半径的飞行时间来计算上述量值。您的程序应精确生成一行格式为 $[r_1,r_2,r_3,\\dots]$ 的输出，其中条目依次对应于用例A的 $t_c$、用例A的 $p_c$、用例A的 $\\max \\delta t$，接着是用例B的 $t_c$、用例B的 $p_c$、用例B的 $\\max \\delta t$，然后是用例C的 $t_c$、用例C的 $p_c$、用例C的 $\\max \\delta t$。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它科学地基于流体动力学和惯性约束聚变的既定原理，提出了一个适定的、客观的、可形式化的问题。所有必要的参数和定义都已提供，所要求的计算基于一个简化但一致的物理模型。\n\n任务是开发一个算法，用于计算简化磁惯性聚变（MIF）场景中激波汇聚的关键指标。这涉及到分析从一个内爆球形套筒在离散半径 $\\{R_i\\}$ 处发射的一系列激波。对于每个发射半径 $R_i$，我们必须计算套筒行进到该半径的时间、发射激波的性质以及激波到中心的渡越时间。最终目标是确定汇聚时间 $t_c$、最大中心压力 $p_c$ 以及在中心实现完美激波会聚所需的最大时间调整 $\\max \\delta t$。\n\n问题的核心在于强激波在静止理想气体中传播的朗肯-雨贡纽跳跃条件。套筒充当一个以指定速度 $v(R)$ 移动的活塞。在静止的上游燃料参考系中，活塞速度为 $v_p = v(R)$，这也是波后流体的速度 $u_2$。\n\n对于一个由活塞驱动进入绝热指数为 $\\gamma$ 的静止理想气体的强激波，活塞速度 $v_p$ 和激波速度 $U_s$ 之间的关系由下式给出：\n$$\nu_2 = v_p = \\frac{2}{\\gamma+1} U_s\n$$\n由此，我们可以将激波速度 $U_s$ 表示为套筒瞬时速度 $v(R)$ 的函数：\n$$\nU_s(R) = \\frac{\\gamma+1}{2} v(R)\n$$\n在强激波极限下（$p_2 \\gg p_1$，其中 $p_1$ 是初始燃料压力），激波后的压力 $p_2$ 由下式给出：\n$$\np_2 - p_1 \\approx p_2 = \\rho_1 U_s u_2\n$$\n这里，$\\rho_1$ 是初始的、未受激波冲击的燃料密度，表示为 $\\rho_f$。代入 $U_s$ 和 $u_2=v(R)$ 的表达式，我们得到波后压力作为套筒速度的函数：\n$$\np_2(R) = \\rho_f \\left( \\frac{\\gamma+1}{2} v(R) \\right) v(R) = \\frac{\\gamma+1}{2} \\rho_f v(R)^2\n$$\n对于每个测试用例，算法按以下步骤进行：\n\n1.  **生成离散化发射半径**：生成一组 $N$ 个发射半径 $\\{R_i\\}$，它们在初始半径 $R_0$ 和最小半径 $R_{\\min}$ 之间均匀间隔（含两端）。\n\n2.  **为每个 $R_i$ 计算状态变量**：对于该组中的每个半径 $R_i$，我们计算几个量。\n    \n    a.  **套筒速度 $v(R_i)$**：使用每个测试用例提供的特定函数形式计算套筒速度。\n    \n    b.  **激波速度 $U_s(R_i)$**：使用套筒速度，将激波速度计算为 $U_s(R_i) = \\frac{\\gamma+1}{2} v(R_i)$。\n    \n    c.  **激波渡越时间 $t_{\\mathrm{transit}}(R_i)$**：在 $R_i$ 处发射的激波到达中心（距离为 $R_i$）的时间是 $t_{\\mathrm{transit}}(R_i) = \\frac{R_i}{U_s(R_i)}$。\n    \n    d.  **波后压力 $p_2(R_i)$**：此值计算为 $p_2(R_i) = \\frac{\\gamma+1}{2} \\rho_f v(R_i)^2$。\n    \n    e.  **套筒行进时间（发射时间） $t_{\\mathrm{launch}}(R_i)$**：这是套筒从 $R_0$ 内爆到 $R_i$ 所需的时间。它由积分 $t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v(\\xi)}$ 给出。我们为每个用例解析求解此积分：\n        \n        -   **用例A**：$v(\\xi) = v_0$。\n            $$\n            t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v_0} = \\frac{R_0 - R_i}{v_0}\n            $$\n        -   **用例B**：$v(\\xi) = v_0 + k(R_0 - \\xi)$。\n            $$\n            t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v_0 + k(R_0 - \\xi)} = \\left[ -\\frac{1}{k} \\ln(v_0 + k(R_0 - \\xi)) \\right]_{R_i}^{R_0} = \\frac{1}{k} \\ln\\left( \\frac{v_0 + k(R_0 - R_i)}{v_0} \\right)\n            $$\n        -   **用例C**：$v(\\xi) = v_0 \\left(\\frac{\\xi}{R_0}\\right)^{-n}$。\n            $$\n            t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v_0 (\\xi/R_0)^{-n}} = \\frac{R_0^{-n}}{v_0} \\int_{R_i}^{R_0} \\xi^n d\\xi = \\frac{R_0^{-n}}{v_0(n+1)} \\left[\\xi^{n+1}\\right]_{R_i}^{R_0} = \\frac{R_0}{v_0(n+1)} \\left(1 - \\left(\\frac{R_i}{R_0}\\right)^{n+1}\\right)\n            $$\n\n    f.  **总到达时间 $t_{\\mathrm{arrival}}(R_i)$**：从内爆开始（$t=0$ 时 $R=R_0$）到在 $R_i$ 处发射的激波到达中心的总时间是发射时间和渡越时间之和：\n        $$\n        t_{\\mathrm{arrival}}(R_i) = t_{\\mathrm{launch}}(R_i) + t_{\\mathrm{transit}}(R_i)\n        $$\n\n3.  **确定最终输出**：在为所有 $i$ 计算出 $\\{t_{\\mathrm{arrival}}(R_i)\\}$ 和 $\\{p_2(R_i)\\}$ 数组后：\n    \n    a.  **汇聚时间 $t_c$**：为确保所有激波都到达，我们必须等待耗时最长的那一个。因此，$t_c$ 是所有到达时间的最大值。\n        $$\n        t_c = \\max_i \\{ t_{\\mathrm{arrival}}(R_i) \\}\n        $$\n    b.  **中心压力估算值 $p_c$**：中心压力被估算为所有发射的激波中产生的最高压力。\n        $$\n        p_c = \\max_i \\{ p_2(R_i) \\}\n        $$\n    c.  **最大时间调整 $\\max \\delta t$**：每个激波的时间调整为 $\\delta t(R_i) = t_c - t_{\\mathrm{arrival}}(R_i)$，这代表了该激波发射所需的延迟。所需的最大调整为：\n        $$\n        \\max \\delta t = \\max_i \\{ \\delta t(R_i) \\} = t_c - \\min_i \\{ t_{\\mathrm{arrival}}(R_i) \\}\n        $$\n\n对每个测试用例实施这些步骤以产生所需的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the shock coalescence problem for MIF targets for three test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            # Case A (happy path, constant-speed liner)\n            'name': 'A',\n            'R0': 3e-3, 'R_min': 1e-3, 'N': 5,\n            'v_params': {'v0': 5.0e4},\n            'rho_f': 1.0, 'gamma': 5/3\n        },\n        {\n            # Case B (moderate acceleration of liner with radius)\n            'name': 'B',\n            'R0': 4e-3, 'R_min': 1e-3, 'N': 7,\n            'v_params': {'v0': 3.0e4, 'k': 2.0e7},\n            'rho_f': 1.2, 'gamma': 5/3\n        },\n        {\n            # Case C (power-law increase in liner speed toward smaller radius)\n            'name': 'C',\n            'R0': 5e-3, 'R_min': 1e-3, 'N': 9,\n            'v_params': {'v0': 2.0e4, 'n': 0.5},\n            'rho_f': 0.5, 'gamma': 1.4\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        R0 = case['R0']\n        R_min = case['R_min']\n        N = case['N']\n        rho_f = case['rho_f']\n        gamma = case['gamma']\n        v_params = case['v_params']\n        \n        # 1. Generate Discretized Launch Radii\n        # An array of N radii from R0 (outer) to R_min (inner)\n        R_i = np.linspace(R0, R_min, N)\n        \n        # 2. Calculate State Variables for each R_i\n        \n        # 2a. Liner Speed v(R_i)\n        if case['name'] == 'A':\n            v0 = v_params['v0']\n            v_R = np.full_like(R_i, v0)\n        elif case['name'] == 'B':\n            v0 = v_params['v0']\n            k = v_params['k']\n            v_R = v0 + k * (R0 - R_i)\n        elif case['name'] == 'C':\n            v0 = v_params['v0']\n            n = v_params['n']\n            # Avoid division by zero if R0 is in R_i and R_i is zero, though not an issue here.\n            # (R_i / R0) will be > 0.\n            v_R = v0 * (R_i / R0)**(-n)\n        \n        # Physics factor from strong shock relation\n        gamma_factor = (gamma + 1) / 2\n        \n        # 2b. Shock Speed U_s(R_i)\n        # U_s = (gamma+1)/2 * v_piston\n        U_s = gamma_factor * v_R\n        \n        # 2c. Shock Transit Time t_transit(R_i)\n        # t = distance / speed = R_i / U_s\n        # Handle potential division by zero, although v_R > 0 for all cases here.\n        t_transit = np.divide(R_i, U_s, out=np.zeros_like(U_s), where=U_s!=0)\n        \n        # 2d. Post-Shock Pressure p_2(R_i)\n        # p2 = rho_1 * U_s * u_2 = rho_1 * U_s * v_piston\n        # p2 = (gamma+1)/2 * rho_1 * v_piston^2\n        p2 = gamma_factor * rho_f * v_R**2\n        \n        # 2e. Liner Travel Time (Launch Time) t_launch(R_i)\n        # Integrate 1/v(xi) from R_i to R0\n        if case['name'] == 'A':\n            v0 = v_params['v0']\n            t_launch = (R0 - R_i) / v0\n        elif case['name'] == 'B':\n            v0 = v_params['v0']\n            k = v_params['k']\n            # Using log identity to avoid potential floating point issues with log(1)\n            arg = k * (R0 - R_i) / v0\n            t_launch = (1/k) * np.log1p(arg)\n        elif case['name'] == 'C':\n            v0 = v_params['v0']\n            n = v_params['n']\n            t_launch = (R0 / (v0 * (n + 1))) * (1 - (R_i / R0)**(n + 1))\n\n        # 2f. Total Arrival Time t_arrival(R_i)\n        t_arrival = t_launch + t_transit\n        \n        # 3. Determine Final Outputs\n        \n        # 3a. Coalescence Time t_c\n        tc = np.max(t_arrival)\n        \n        # 3b. Central Pressure Estimate p_c\n        pc = np.max(p2)\n        \n        # 3c. Maximum Timing Adjustment max_delta_t\n        # delta_t = tc - t_arrival. max(delta_t) = tc - min(t_arrival)\n        max_delta_t = tc - np.min(t_arrival)\n        \n        results.extend([tc, pc, max_delta_t])\n\n    # Final print statement in the exact required format.\n    # Flatten the list of results and format as a comma-separated string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "实现聚变点火后，维持燃烧是下一个挑战。在一个“燃烧等离子体”中，聚变反应产生的阿尔法粒子必须将其能量重新沉积在燃料中，以维持其高温状态。本练习  结合了碰撞物理和磁约束原理，你将建立一个模型来估算阿尔法粒子能量的沉积份额，这是决定点火是否成功和聚变燃烧能否持续的关键因素。",
            "id": "3950849",
            "problem": "考虑一种与替代聚变概念相关的磁化氘氚燃料，这些概念包括磁化惯性聚变（Magnetized Inertial Fusion, MIF）、磁化套筒惯性聚变（Magnetized Liner Inertial Fusion, MagLIF）、Z-pinch、反向场箍缩（Reversed Field Pinch, RFP）、球形托卡马克和重离子驱动器。一个聚变产生的阿尔法粒子在沿约束磁场线的磁场最小值位置诞生，具有一定的动能和各向同性的投掷角分布。目标是利用碰撞阻止和磁镜效应的第一性原理模型，估算燃料中沉积的阿尔法能量的分数，并确定其对热能平衡的相应贡献。\n\n从基本原理出发：\n\n- 带电粒子之间的库仑碰撞将能量从快离子转移到背景电子和离子。在高速极限下，阿尔法粒子的减速由与电子的库仑散射造成的能量损失所主导。\n- 在缓慢变化的磁场中，绝热磁矩不变量和总能量守恒决定了带电粒子沿场运动的磁镜约束条件。\n\n将使用的假设：\n\n- 阿尔法粒子的初始动能为 $E_0$。\n- 阿尔法粒子的电荷数为 $Z_\\alpha = 2$，质量为 $m_\\alpha$。\n- 电子数密度为 $n_e$，电子质量为 $m_e$。\n- 库仑对数为 $\\ln\\Lambda$。\n- 电子和离子温度相等，记为 $T$。\n- 离子数密度满足 $n_i = n_e$。\n- 磁场沿磁场线有最小值 $B_{\\min}$ 和最大值 $B_{\\max}$，定义磁镜比 $R_m = B_{\\max}/B_{\\min} \\ge 1$。\n- 投掷角 $\\theta$ 以弧度为单位。\n- 到端部损失区的特征平行距离为 $L_\\parallel$（单位：米）。\n- 阿尔法粒子诞生时的投掷角分布在 $B_{\\min}$ 处是各向同性的。\n- 沉积的能量被添加到等离子体的热能中；热能密度为 $U_{\\mathrm{th}} = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T$。\n- 单位体积的阿尔法粒子源率为 $S_\\alpha$（单位：$\\mathrm{s^{-1}\\,m^{-3}}$）。\n- 热化阈值能量为 $E_{\\mathrm{th}} = 3 k_B T$。\n\n定义以下计算任务：\n\n1.  利用高速库仑碰撞模型，推导一个诞生能量为 $E_0$ 的阿尔法粒子在密度为 $n_e$、温度为 $T$ 的背景等离子体中减速到 $E_{\\mathrm{th}}$ 所需的碰撞能量减速时间 $\\tau_s$。所有量均以国际单位制表示。\n2.  根据磁镜不变量推导在 $B_{\\min}$ 处的磁损失锥半角，并计算各向同性分布下阿尔法粒子投掷角的约束分数 $f_{\\mathrm{conf}}$。\n3.  通过对损失锥分布上的平行渡越时间进行平均，估算处于损失锥中的阿尔法粒子的平均逃逸时间 $\\tau_{\\mathrm{esc}}$。此估算使用 $L_\\parallel$ 和初始阿尔法速度 $v_0 = \\sqrt{2 E_0 / m_\\alpha}$。\n4.  计算阿尔法能量沉积分数 $f_{\\mathrm{dep}}$，其为以下两项之和：\n    -   由磁约束部分 $f_{\\mathrm{conf}}$ 造成的完全沉积，以及\n    -   由损失锥部分 $(1 - f_{\\mathrm{conf}})$ 造成的部分沉积，近似为 $\\min(1, \\tau_{\\mathrm{esc}} / \\tau_s)$。\n5.  计算体积阿尔法加热率 $Q_\\alpha = f_{\\mathrm{dep}} E_0 S_\\alpha$ 和相对于现有热能密度的加热率 $r = Q_\\alpha / U_{\\mathrm{th}}$（单位：$\\mathrm{s^{-1}}$）。\n\n单位和输出：\n\n-   全部使用国际单位制。能量必须以焦耳为单位，磁场以特斯拉为单位，长度以米为单位，数密度以 $\\mathrm{m^{-3}}$ 为单位，温度通过 $k_B T$ 以焦耳为单位，时间以秒为单位。\n-   角度以弧度为单位。\n-   对于每个测试案例，程序必须输出两个值：能量沉积分数 $f_{\\mathrm{dep}}$（无量纲）和加热率比值 $r$（单位：$\\mathrm{s^{-1}}$）。\n-   将每个输出值表示为四舍五入到 $6$ 位有效数字的小数。\n-   您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序为 $[f_{\\mathrm{dep},1}, r_1, f_{\\mathrm{dep},2}, r_2, f_{\\mathrm{dep},3}, r_3, f_{\\mathrm{dep},4}, r_4]$。\n\n使用的物理常数（国际单位制）：\n\n-   基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n-   电子质量 $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n-   阿尔法粒子质量 $m_\\alpha = 6.6446573357 \\times 10^{-27}\\,\\mathrm{kg}$。\n-   玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n-   库仑常数 $k_e = 1/(4\\pi\\epsilon_0) = 8.9875517923 \\times 10^{9}\\,\\mathrm{N\\,m^2\\,C^{-2}}$。\n-   阿尔法粒子诞生能量 $E_0 = 3.5\\,\\mathrm{MeV}$。\n\n测试组：\n\n提供以下四个测试案例，每个案例由 $(n_e, T, R_m, L_\\parallel, \\ln\\Lambda, S_\\alpha)$ 指定：\n\n-   案例1（Magnetized Liner Inertial Fusion 柱体）：\n    -   $n_e = 1.0 \\times 10^{26}\\,\\mathrm{m^{-3}}$，\n    -   $T = 3.0\\,\\mathrm{keV}$，\n    -   $R_m = 10.0$，\n    -   $L_\\parallel = 0.01\\,\\mathrm{m}$，\n    -   $\\ln\\Lambda = 10.0$，\n    -   $S_\\alpha = 1.0 \\times 10^{29}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n-   案例2（类球形托卡马克参数）：\n    -   $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，\n    -   $T = 10.0\\,\\mathrm{keV}$，\n    -   $R_m = 1.5$，\n    -   $L_\\parallel = 5.0\\,\\mathrm{m}$，\n    -   $\\ln\\Lambda = 17.0$，\n    -   $S_\\alpha = 1.0 \\times 10^{22}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n-   案例3（类Z-pinch密柱）：\n    -   $n_e = 5.0 \\times 10^{27}\\,\\mathrm{m^{-3}}$，\n    -   $T = 1.0\\,\\mathrm{keV}$，\n    -   $R_m = 5.0$，\n    -   $L_\\parallel = 0.005\\,\\mathrm{m}$，\n    -   $\\ln\\Lambda = 8.0$，\n    -   $S_\\alpha = 5.0 \\times 10^{30}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n-   案例4（重离子驱动器磁化靶）：\n    -   $n_e = 1.0 \\times 10^{25}\\,\\mathrm{m^{-3}}$，\n    -   $T = 5.0\\,\\mathrm{keV}$，\n    -   $R_m = 2.0$，\n    -   $L_\\parallel = 0.02\\,\\mathrm{m}$，\n    -   $\\ln\\Lambda = 12.0$，\n    -   $S_\\alpha = 1.0 \\times 10^{28}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n\n您的程序必须实现上述物理过程，计算每个案例的 $f_{\\mathrm{dep}}$ 和 $r$，并按规定输出单行结果。",
            "solution": "该问题陈述具有科学依据、问题良态且内容自洽，提出了一个关于等离子体约束和高能粒子输运的有效的经典物理问题。它提供了所有必要的物理常数、参数，以及一套基于等离子体物理学既定原理的清晰计算任务。我们接下来逐步推导所要求的量。\n\n问题的核心在于两个特征时间尺度的相互作用：碰撞减速时间 $\\tau_s$ 和由磁约束几何构型决定的粒子损失时间。我们通过将聚变产生的阿尔法粒子划分为两个群体来分析它们的行为：一个磁约束部分和一个逃逸（损失锥）部分。\n\n**1. 碰撞能量减速时间 $\\tau_s$**\n\n一个高能阿尔法粒子穿过等离子体时，主要通过与背景电子和离子的库仑碰撞损失能量。问题指定了高速极限，此时阿尔法粒子速度 $v_\\alpha$ 远大于背景电子的热速度。在此机制下，能量损失主要由电子的拖拽力主导。能量损失率由下式给出：\n$$ \\frac{dE}{dt} = -\\frac{n_e Z_\\alpha^2 e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e v_\\alpha} $$\n这里，$E = \\frac{1}{2} m_\\alpha v_\\alpha^2$ 是阿尔法粒子的动能，$Z_\\alpha = 2$ 是其电荷数，$m_\\alpha$ 是其质量，$n_e$ 是电子密度，$m_e$ 是电子质量，$e$ 是基本电荷，$\\ln\\Lambda$ 是库仑对数。我们可以将速度表示为 $v_\\alpha = \\sqrt{2E/m_\\alpha}$。将其代入能量损失方程，并使用库仑常数 $k_e = 1/(4\\pi\\epsilon_0)$（这意味着 $1/\\epsilon_0^2 = 16\\pi^2 k_e^2$），我们得到：\n$$ \\frac{dE}{dt} = -\\frac{4\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda}{m_e} \\sqrt{\\frac{m_\\alpha}{2E}} = -C \\frac{1}{\\sqrt{E}} $$\n其中常数 $C$ 由 $C = \\frac{4\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda \\sqrt{m_\\alpha}}{m_e \\sqrt{2}}$ 给出。这是一个关于能量 $E(t)$ 的可分离常微分方程。为了找到一个阿尔法粒子从其诞生能量 $E_0$ 减速到热化能量 $E_{\\mathrm{th}} = 3k_B T$ 所需的时间 $\\tau_s$，我们进行积分：\n$$ \\int_{E_0}^{E_{\\mathrm{th}}} E^{1/2} dE = -\\int_0^{\\tau_s} C dt $$\n$$ \\left[ \\frac{2}{3} E^{3/2} \\right]_{E_0}^{E_{\\mathrm{th}}} = -C \\tau_s $$\n$$ \\frac{2}{3} (E_{\\mathrm{th}}^{3/2} - E_0^{3/2}) = -C \\tau_s $$\n求解减速时间 $\\tau_s$：\n$$ \\tau_s = \\frac{2(E_0^{3/2} - E_{\\mathrm{th}}^{3/2})}{3C} = \\frac{\\sqrt{2} m_e (E_0^{3/2} - E_{\\mathrm{th}}^{3/2})}{6\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda \\sqrt{m_\\alpha}} $$\n$\\tau_s$ 的这个表达式将使用所提供的参数在国际单位制下实现。\n\n**2. 磁损失锥和约束分数 $f_{\\mathrm{conf}}$**\n\n在磁镜位形中，带电粒子的运动由动能 $E$ 和第一绝热不变量——磁矩 $\\mu = \\frac{m_\\alpha v_\\perp^2}{2B}$ 的守恒所支配，其中 $v_\\perp$ 是垂直于磁场 $\\vec{B}$ 的速度分量。给定投掷角 $\\theta$ 使得 $v_\\perp = v \\sin\\theta$，$\\mu$ 和 $E$ 的守恒意味着：\n$$ \\frac{\\sin^2\\theta}{B} = \\text{常数} $$\n一个粒子以投掷角 $\\theta_{\\min}$ 从磁场最小值 $B_{\\min}$ 处开始运动，当其投掷角变为 $\\pi/2$ 时将被反射。设此反射点的磁场为 $B_{\\mathrm{refl}}$。那么，$\\frac{\\sin^2\\theta_{\\min}}{B_{\\min}} = \\frac{\\sin^2(\\pi/2)}{B_{\\mathrm{refl}}} = \\frac{1}{B_{\\mathrm{refl}}}$。\n如果粒子在到达最大磁场 $B_{\\max}$ 之前反射，即 $B_{\\mathrm{refl}} \\le B_{\\max}$，则它被约束。这意味着 $\\sin^2\\theta_{\\min} \\le \\frac{B_{\\min}}{B_{\\max}} = \\frac{1}{R_m}$，其中 $R_m$ 是磁镜比。\n不满足此条件的粒子位于“损失锥”中并逃逸。损失锥半角 $\\theta_L$ 由该条件的边界定义：$\\sin\\theta_L = 1/\\sqrt{R_m}$。\n对于诞生时各向同性的投掷角分布，粒子分布在 $4\\pi$ 的立体角上是均匀的。被约束的粒子分数对应于两个损失锥（位于速度球体的两端）之外的总立体角分数。该分数由下式给出：\n$$ f_{\\mathrm{conf}} = \\frac{\\int_{\\theta_L}^{\\pi-\\theta_L} 2\\pi \\sin\\theta d\\theta}{\\int_0^\\pi 2\\pi \\sin\\theta d\\theta} = \\frac{[-\\cos\\theta]_{\\theta_L}^{\\pi-\\theta_L}}{2} = \\frac{\\cos\\theta_L - \\cos(\\pi-\\theta_L)}{2} = \\cos\\theta_L $$\n使用恒等式 $\\cos\\theta_L = \\sqrt{1-\\sin^2\\theta_L}$，我们发现约束分数为：\n$$ f_{\\mathrm{conf}} = \\sqrt{1 - \\frac{1}{R_m}} $$\n\n**3. 平均逃逸时间 $\\tau_{\\mathrm{esc}}$**\n\n对于在损失锥内诞生（$0 \\le \\theta  \\theta_L$）的粒子，我们估算它们的逃逸时间。平行速度为 $v_\\parallel(\\theta) = v_0 \\cos\\theta$，其中 $v_0 = \\sqrt{2E_0/m_\\alpha}$ 是初始速率。在距离 $L_\\parallel$ 上逃逸的渡越时间为 $t(\\theta) = L_\\parallel / v_\\parallel(\\theta)$。为了找到平均逃逸时间，我们在损失锥投掷角分布上对 $t(\\theta)$ 进行平均。$\\theta$ 的概率分布为 $p(\\theta) = \\frac{1}{2}\\sin\\theta$。\n考虑到一个损失锥（$0 \\le \\theta  \\theta_L$），平均时间为：\n$$ \\tau_{\\mathrm{esc}} = \\frac{\\int_0^{\\theta_L} t(\\theta) p(\\theta) d\\theta}{\\int_0^{\\theta_L} p(\\theta) d\\theta} = \\frac{\\int_0^{\\theta_L} \\frac{L_\\parallel}{v_0 \\cos\\theta} \\frac{1}{2}\\sin\\theta d\\theta}{\\int_0^{\\theta_L} \\frac{1}{2}\\sin\\theta d\\theta} $$\n分子积分为 $\\frac{L_\\parallel}{2v_0} \\int_0^{\\theta_L} \\tan\\theta d\\theta = \\frac{L_\\parallel}{2v_0} [-\\ln(\\cos\\theta)]_0^{\\theta_L} = -\\frac{L_\\parallel}{2v_0} \\ln(\\cos\\theta_L)$。\n分母积分为 $\\frac{1}{2}[-\\cos\\theta]_0^{\\theta_L} = \\frac{1}{2}(1 - \\cos\\theta_L)$。\n综合这些结果得到平均逃逸时间：\n$$ \\tau_{\\mathrm{esc}} = \\frac{-\\frac{L_\\parallel}{2v_0} \\ln(\\cos\\theta_L)}{\\frac{1}{2}(1 - \\cos\\theta_L)} = \\frac{L_\\parallel}{v_0} \\frac{-\\ln(\\cos\\theta_L)}{1 - \\cos\\theta_L} $$\n使用 $\\cos\\theta_L = \\sqrt{1-1/R_m}$，我们可以计算 $\\tau_{\\mathrm{esc}}$。对于 $R_m=1$，此表达式无定义，但所提供的测试案例均有 $R_m > 1$。\n\n**4. 总阿尔法能量沉积分数 $f_{\\mathrm{dep}}$**\n\n沉积的阿尔法能量的总分数是来自约束粒子群和逃逸粒子群贡献的总和。\n-   约束部分 $f_{\\mathrm{conf}}$ 假定沉积其全部能量。其贡献为 $f_{\\mathrm{conf}} \\times 1$。\n-   损失锥部分 $(1 - f_{\\mathrm{conf}})$ 在平均时间 $\\tau_{\\mathrm{esc}}$ 内逃逸。在此期间，它沉积的能量分数由时间尺度之比 $\\tau_{\\mathrm{esc}}/\\tau_s$ 近似。此部分沉积的上限为 $1$，因为粒子不能沉积超过其总能量。所以其贡献为 $(1-f_{\\mathrm{conf}}) \\times \\min(1, \\tau_{\\mathrm{esc}}/\\tau_s)$。\n将这些贡献相加得到总沉积分数：\n$$ f_{\\mathrm{dep}} = f_{\\mathrm{conf}} + (1 - f_{\\mathrm{conf}}) \\min(1, \\frac{\\tau_{\\mathrm{esc}}}{\\tau_s}) $$\n\n**5. 体积加热率 $Q_\\alpha$ 和相对加热率 $r$**\n\n体积阿尔法加热功率密度 $Q_\\alpha$ 是单位体积的阿尔法源率 $S_\\alpha$、每个阿尔法粒子的能量 $E_0$ 以及沉积的能量分数 $f_{\\mathrm{dep}}$ 的乘积：\n$$ Q_\\alpha = f_{\\mathrm{dep}} E_0 S_\\alpha $$\n假设电子和离子温度相等（$T_e=T_i=T$）且氘氚等离子体满足电荷中性（$n_i=n_e$），背景等离子体的热能密度为：\n$$ U_{\\mathrm{th}} = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T = 3 n_e k_B T $$\n相对于现有热能密度的加热率 $r$ 是加热功率密度与热能密度的比值。这个量的单位是 $\\mathrm{s^{-1}}$，代表了等离子体被阿尔法粒子加热的特征逆时间。\n$$ r = \\frac{Q_\\alpha}{U_{\\mathrm{th}}} = \\frac{f_{\\mathrm{dep}} E_0 S_\\alpha}{3 n_e k_B T} $$\n这些公式为数值计算提供了基础。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for alpha particle energy deposition fraction and relative heating rate\n    for several alternative fusion concept scenarios.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_E = 9.1093837015e-31      # Electron mass in kg\n    M_ALPHA = 6.6446573357e-27  # Alpha particle mass in kg\n    K_B = 1.380649e-23          # Boltzmann constant in J/K\n    K_E = 8.9875517923e9        # Coulomb constant in N m^2 C^-2\n    \n    # Problem-specific constants\n    E0_MEV = 3.5                # Alpha birth energy in MeV\n    E0_J = E0_MEV * 1e6 * E_CHARGE  # Alpha birth energy in Joules\n    Z_ALPHA = 2.0                 # Alpha charge number\n\n    def calculate_metrics(n_e, T_keV, R_m, L_parallel, ln_Lambda, S_alpha):\n        \"\"\"\n        Computes f_dep and r for a single test case.\n        \n        Args:\n            n_e (float): Electron number density (m^-3)\n            T_keV (float): Plasma temperature (k_B*T) in keV\n            R_m (float): Mirror ratio (B_max / B_min)\n            L_parallel (float): Parallel distance to end loss region (m)\n            ln_Lambda (float): Coulomb logarithm\n            S_alpha (float): Alpha source rate per unit volume (s^-1 m^-3)\n\n        Returns:\n            tuple: (f_dep, r)\n        \"\"\"\n        \n        # Convert temperature to Joules\n        kBT_J = T_keV * 1e3 * E_CHARGE\n        \n        # --- Task 1: Calculate collisional slowing-down time tau_s ---\n        E_th = 3.0 * kBT_J  # Thermalization energy\n        \n        # Ensure E0 > E_th to avoid math domain errors\n        if E0_J = E_th:\n             tau_s = 0.0\n        else:\n            # Constant part of the tau_s formula\n            C1 = (np.sqrt(2.0) * M_E) / (6.0 * np.pi * K_E**2 * E_CHARGE**4)\n            # Variable part\n            C2 = (E0_J**1.5 - E_th**1.5) / (n_e * ln_Lambda * Z_ALPHA**2 * np.sqrt(M_ALPHA))\n            tau_s = C1 * C2\n\n        # --- Task 2: Calculate confined fraction f_conf ---\n        if R_m  1.0:\n            # Physically R_m should be >= 1. If not, handle as no confinement.\n            f_conf = 0.0\n        else:\n            f_conf = np.sqrt(1.0 - 1.0 / R_m)\n\n        # --- Task 3: Calculate average escape time tau_esc ---\n        v0 = np.sqrt(2.0 * E0_J / M_ALPHA)\n        cos_theta_L = f_conf # As derived: f_conf = cos(theta_L)\n        \n        # Handle the case R_m = 1 (cos_theta_L = 0) where log(0) is -inf\n        if np.isclose(cos_theta_L, 0):\n            # Model breaks down, escape time is effectively infinite for some particles\n            # but for the average, it is very large compared to tau_s.\n            # Using a very large number to ensure min(1, tau_esc/tau_s) = 1\n            tau_esc = np.inf\n        else:\n            tau_esc = (L_parallel / v0) * (-np.log(cos_theta_L) / (1.0 - cos_theta_L))\n\n        # --- Task 4: Compute alpha energy deposition fraction f_dep ---\n        if tau_s > 0:\n            deposition_ratio = tau_esc / tau_s\n        else: # If tau_s is effectively zero (instant slowing), deposition is immediate\n             deposition_ratio = np.inf\n\n        partial_deposition = min(1.0, deposition_ratio)\n        f_dep = f_conf + (1.0 - f_conf) * partial_deposition\n        \n        # --- Task 5: Compute volumetric heating rate Q_alpha and relative rate r ---\n        U_th = 3.0 * n_e * kBT_J\n        Q_alpha = f_dep * E0_J * S_alpha\n        \n        if U_th > 0:\n            r = Q_alpha / U_th\n        else:\n            r = np.inf # If thermal energy is zero, any heating is infinite relative rate\n\n        return f_dep, r\n\n    # Test suite from the problem description\n    test_cases = [\n        # Case 1 (MagLIF)\n        (1.0e26, 3.0, 10.0, 0.01, 10.0, 1.0e29),\n        # Case 2 (spherical tokamak)\n        (5.0e19, 10.0, 1.5, 5.0, 17.0, 1.0e22),\n        # Case 3 (Z-pinch)\n        (5.0e27, 1.0, 5.0, 0.005, 8.0, 5.0e30),\n        # Case 4 (heavy-ion driver)\n        (1.0e25, 5.0, 2.0, 0.02, 12.0, 1.0e28),\n    ]\n\n    results = []\n    for case in test_cases:\n        f_dep, r = calculate_metrics(*case)\n        # Format to 6 significant figures\n        results.append(f\"{f_dep:.6g}\")\n        results.append(f\"{r:.6g}\")\n\n    # Print the final output in the specified single-line format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}