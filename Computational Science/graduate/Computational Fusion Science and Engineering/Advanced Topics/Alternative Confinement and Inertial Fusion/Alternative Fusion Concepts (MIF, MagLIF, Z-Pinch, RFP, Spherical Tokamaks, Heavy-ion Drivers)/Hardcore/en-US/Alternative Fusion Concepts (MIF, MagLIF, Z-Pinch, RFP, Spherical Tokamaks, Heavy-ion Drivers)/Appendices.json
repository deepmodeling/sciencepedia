{
    "hands_on_practices": [
        {
            "introduction": "Achieving fusion conditions in many alternative concepts begins with preparing the fuel plasma. This first exercise models the critical \"preheat\" stage, characteristic of Magneto-Inertial Fusion (MIF) concepts like MagLIF, where an external driver initially heats the fuel. By working through this problem (), you will perform a fundamental energy balance calculation, accounting for both the required increase in plasma thermal energy and the unavoidable energy losses from bremsstrahlung radiation. This practice illuminates the basic energetic requirements and trade-offs involved in setting the stage for a successful implosion.",
            "id": "3950883",
            "problem": "A cylindrical deuterium–tritium fuel column is preheated in a Magnetized Liner Inertial Fusion (MagLIF) configuration, representative of Magneto-Inertial Fusion (MIF). The fuel is assumed spatially uniform, fully ionized, and optically thin to its own bremsstrahlung. The cylinder has length $L = 5\\,\\mathrm{mm}$, radius $R = 2\\,\\mathrm{mm}$, and total particle number density (electrons plus ions) $n = 1.0\\times 10^{23}\\,\\mathrm{m}^{-3}$. The ion charge is $Z=1$. The preheat driver raises the plasma temperature from $0$ to a final value $T = 5\\,\\mathrm{keV}$ over a pulse duration $\\tau = 100\\,\\mathrm{ns}$, with a linear temperature ramp $T(t) = T\\, t/\\tau$ for $0 \\le t \\le \\tau$. Non-radiative losses such as conduction and end losses are neglected to obtain a lower-bound estimate.\n\nStarting from energy conservation, the minimum driver energy is the sum of the increase in internal thermal energy and the radiative loss to bremsstrahlung over the heating time. Use the equipartition assumption $T_e = T_i = T$, so the internal energy increase is that of both species. For optically thin free–free emission, take the volumetric bremsstrahlung power density in the form $P_{\\mathrm{br}}(t) = C\\, n_e n_i Z^2 \\sqrt{T(t)}$, where $C = 1.69\\times 10^{-38} g_B\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$ with Gaunt factor $g_B = 1.2$, and $n_e = n_i = n/2$ by quasineutrality for $Z=1$. Treat the plasma volume as $V = \\pi R^2 L$, and convert $T$ from $\\mathrm{keV}$ to $\\mathrm{K}$ using $k_B T = (\\text{energy per particle})$ with $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ and Boltzmann’s constant $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$.\n\nDerive the expression for the required driver energy and evaluate it numerically for the given parameters. Express the final energy in $\\mathrm{kJ}$ and round your answer to three significant figures.",
            "solution": "The problem asks for the minimum driver energy required to preheat a cylindrical deuterium-tritium fuel column. This energy is the sum of the increase in the plasma's internal thermal energy and the energy lost to bremsstrahlung radiation during the heating process. We begin by stating the governing energy conservation equation:\n$$\nE_{\\mathrm{driver}} = \\Delta E_{\\mathrm{thermal}} + E_{\\mathrm{rad}}\n$$\nwhere $\\Delta E_{\\mathrm{thermal}}$ is the change in the total internal energy of the plasma and $E_{\\mathrm{rad}}$ is the total energy radiated away. We will derive an expression for each term and then sum them to find the total driver energy.\n\nFirst, we calculate the change in internal thermal energy, $\\Delta E_{\\mathrm{thermal}}$. The plasma is composed of electrons and ions, and for an ideal gas, the internal energy is given by $E_{\\mathrm{thermal}} = \\frac{3}{2} N k_B T$, where $N$ is the total number of particles, $k_B$ is the Boltzmann constant, and $T$ is the temperature. The total number of particles is the total number density $n$ multiplied by the plasma volume $V$. The volume of the cylinder is $V = \\pi R^2 L$. Therefore, $N = nV = n\\pi R^2 L$.\n\nThe change in internal energy is the final energy minus the initial energy:\n$$\n\\Delta E_{\\mathrm{thermal}} = E_{\\mathrm{thermal, final}} - E_{\\mathrm{thermal, initial}} = \\frac{3}{2} N k_B T_f - \\frac{3}{2} N k_B T(0)\n$$\nThe problem states the heating starts from a temperature of $0$, so $T(0) = 0$. The final temperature is denoted as $T_f$. Thus, the change in internal energy is simply the final internal energy:\n$$\n\\Delta E_{\\mathrm{thermal}} = \\frac{3}{2} N k_B T_f = \\frac{3}{2} (n \\pi R^2 L) k_B T_f\n$$\nNote that the quantity $k_B T_f$ represents the final thermal energy per particle, which is given as $5\\,\\mathrm{keV}$.\n\nNext, we calculate the total radiated energy, $E_{\\mathrm{rad}}$. This energy is the time integral of the total radiated power, $P_{\\mathrm{rad}}(t)$, over the heating pulse duration $\\tau$.\n$$\nE_{\\mathrm{rad}} = \\int_0^\\tau P_{\\mathrm{rad}}(t)\\,dt\n$$\nThe total power is the volumetric power density, $P_{\\mathrm{br}}(t)$, multiplied by the plasma volume $V$.\n$$\nP_{\\mathrm{rad}}(t) = V \\cdot P_{\\mathrm{br}}(t) = (\\pi R^2 L) P_{\\mathrm{br}}(t)\n$$\nThe volumetric bremsstrahlung power density is given by $P_{\\mathrm{br}}(t) = C n_e n_i Z^2 \\sqrt{T(t)}$. For a quasineutral plasma with singly charged ions ($Z=1$), the electron density $n_e$ and ion density $n_i$ are both equal to half the total particle density $n$, so $n_e = n_i = n/2$. Substituting these into the power density expression gives:\n$$\nP_{\\mathrm{br}}(t) = C \\left(\\frac{n}{2}\\right) \\left(\\frac{n}{2}\\right) (1)^2 \\sqrt{T(t)} = \\frac{1}{4} C n^2 \\sqrt{T(t)}\n$$\nThe temperature increases linearly with time according to $T(t) = T_f \\frac{t}{\\tau}$ for $0 \\le t \\le \\tau$. Substituting this into the expression for $P_{\\mathrm{br}}(t)$ yields:\n$$\nP_{\\mathrm{br}}(t) = \\frac{1}{4} C n^2 \\sqrt{T_f \\frac{t}{\\tau}} = \\frac{C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} t^{1/2}\n$$\nNow, we can integrate the total power $P_{\\mathrm{rad}}(t) = V \\cdot P_{\\mathrm{br}}(t)$ from $t=0$ to $t=\\tau$:\n$$\nE_{\\mathrm{rad}} = \\int_0^\\tau (\\pi R^2 L) \\left( \\frac{C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} t^{1/2} \\right) dt\n$$\nThe terms independent of $t$ can be moved outside the integral:\n$$\nE_{\\mathrm{rad}} = \\frac{\\pi R^2 L C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} \\int_0^\\tau t^{1/2} dt\n$$\nThe integral of $t^{1/2}$ is $\\frac{2}{3} t^{3/2}$. Evaluating this from $0$ to $\\tau$:\n$$\n\\int_0^\\tau t^{1/2} dt = \\left[ \\frac{2}{3} t^{3/2} \\right]_0^\\tau = \\frac{2}{3} \\tau^{3/2}\n$$\nSubstituting this result back into the expression for $E_{\\mathrm{rad}}$:\n$$\nE_{\\mathrm{rad}} = \\frac{\\pi R^2 L C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} \\left( \\frac{2}{3} \\tau^{3/2} \\right) = \\frac{2}{12} (\\pi R^2 L) C n^2 \\sqrt{T_f} \\frac{\\tau^{3/2}}{\\tau^{1/2}}\n$$\n$$\nE_{\\mathrm{rad}} = \\frac{1}{6} (\\pi R^2 L) C n^2 \\tau \\sqrt{T_f}\n$$\nThe total required driver energy is the sum of these two components:\n$$\nE_{\\mathrm{driver}} = \\frac{3}{2} n (\\pi R^2 L) k_B T_f + \\frac{1}{6} (\\pi R^2 L) C n^2 \\tau \\sqrt{T_f}\n$$\nThis is the final analytical expression for the driver energy.\n\nWe now evaluate this expression numerically. First, we list the given parameters in SI units:\n- Length: $L = 5\\,\\mathrm{mm} = 5 \\times 10^{-3}\\,\\mathrm{m}$\n- Radius: $R = 2\\,\\mathrm{mm} = 2 \\times 10^{-3}\\,\\mathrm{m}$\n- Total particle density: $n = 1.0 \\times 10^{23}\\,\\mathrm{m}^{-3}$\n- Final temperature (energy per particle): $E_p = 5\\,\\mathrm{keV} = 5 \\times 10^3\\,\\mathrm{eV} \\times (1.602176634\\times 10^{-19}\\,\\mathrm{J/eV}) = 8.01088 \\times 10^{-16}\\,\\mathrm{J}$. This term is equivalent to $k_B T_f$.\n- Pulse duration: $\\tau = 100\\,\\mathrm{ns} = 1.0 \\times 10^{-7}\\,\\mathrm{s}$\n- Bremsstrahlung constant coefficient: $C_{base} = 1.69\\times 10^{-38}\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$\n- Gaunt factor: $g_B = 1.2$\n- Boltzmann constant: $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n\nFirst, we calculate the constants and derived quantities:\n- Plasma volume: $V = \\pi R^2 L = \\pi (2\\times 10^{-3}\\,\\mathrm{m})^2 (5\\times 10^{-3}\\,\\mathrm{m}) = 2\\pi \\times 10^{-8}\\,\\mathrm{m}^3$.\n- Final temperature in Kelvin: $T_f = E_p / k_B = (8.01088 \\times 10^{-16}\\,\\mathrm{J}) / (1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\approx 5.8021 \\times 10^7\\,\\mathrm{K}$.\n- Bremsstrahlung constant with Gaunt factor: $C = C_{base} \\times g_B = (1.69\\times 10^{-38}) \\times 1.2 = 2.028 \\times 10^{-38}\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$.\n\nNow we calculate the two energy terms:\n- Internal energy increase:\n$\\Delta E_{\\mathrm{thermal}} = \\frac{3}{2} n V (k_B T_f) = \\frac{3}{2} (1.0 \\times 10^{23}\\,\\mathrm{m}^{-3}) (2\\pi \\times 10^{-8}\\,\\mathrm{m}^3) (8.01088 \\times 10^{-16}\\,\\mathrm{J}) \\approx 7.5498\\,\\mathrm{J}$.\n\n- Radiated energy:\n$E_{\\mathrm{rad}} = \\frac{1}{6} V C n^2 \\tau \\sqrt{T_f}$\n$E_{\\mathrm{rad}} = \\frac{1}{6} (2\\pi \\times 10^{-8}) (2.028 \\times 10^{-38}) (1.0 \\times 10^{23})^2 (1.0 \\times 10^{-7}) \\sqrt{5.8021 \\times 10^7}$\n$E_{\\mathrm{rad}} \\approx \\frac{\\pi}{3} (10^{-8}) (2.028 \\times 10^{-38}) (10^{46}) (10^{-7}) (7.617 \\times 10^3) \\approx 0.001618\\,\\mathrm{J}$.\n\nThe total driver energy is the sum:\n$E_{\\mathrm{driver}} = \\Delta E_{\\mathrm{thermal}} + E_{\\mathrm{rad}} \\approx 7.5498\\,\\mathrm{J} + 0.001618\\,\\mathrm{J} \\approx 7.5514\\,\\mathrm{J}$.\n\nThe problem requires the answer in kilojoules ($\\mathrm{kJ}$) rounded to three significant figures.\n$E_{\\mathrm{driver}} = 7.5514\\,\\mathrm{J} = 0.0075514\\,\\mathrm{kJ}$.\nRounding to three significant figures, we get $0.00755\\,\\mathrm{kJ}$.",
            "answer": "$$\\boxed{0.00755}$$"
        },
        {
            "introduction": "Once preheated, the fuel must be rapidly compressed to reach the extreme densities and temperatures required for fusion. This exercise delves into the hydrodynamics of the implosion phase, focusing on the crucial challenge of \"shock timing\" in a spherically symmetric target (). Treating the imploding liner as a moving piston, you will develop an algorithm to determine how to shape the implosion so that the generated shock waves coalesce precisely at the target's center. Mastering this concept is essential for designing efficient compression schemes in inertial fusion.",
            "id": "3950850",
            "problem": "Consider a spherically symmetric Magneto-Inertial Fusion (MIF) target driven by a Magnetized Liner Inertial Fusion (MagLIF) imploding metallic liner. The fuel occupies the region interior to the liner inner surface, assumed initially at radius $R_0$. As the liner implodes, at each instantaneous inner radius $R$ it launches an inward-propagating shock into the fuel. The fuel is modeled as an ideal gas with uniform mass density $\\rho_f$ and adiabatic index $\\gamma$, and the liner acts as a piston with a prescribed inward speed profile $v(R)$, where $R$ is the instantaneous liner inner radius. Assume spherical symmetry and neglect radiation losses, magnetic field effects, and material strength of the liner and fuel beyond their roles in setting the piston speed and shock propagation.\n\nStarting from the conservation of mass, momentum, and energy for compressible flow and the Rankine–Hugoniot jump conditions across a shock, construct an algorithm that, for a set of discrete shock launches at radii $\\{R_i\\}$, computes the launch time $t_{\\mathrm{launch}}(R_i)$ required for shocks to coalesce at the fuel center and the resulting central pressure estimate. Use the following modeling assumptions to connect the physics to a computational procedure:\n- The fuel ahead of each shock is initially at rest relative to the laboratory frame at the moment the shock is launched.\n- The piston-driven shock speed $U_s(R)$ in the laboratory frame is determined by the piston speed $v(R)$ and the ideal-gas jump conditions in the strong-shock limit, and the post-shock pressure $p_2(R)$ is determined by the upstream fuel properties and $U_s(R)$.\n- The travel distance for a shock launched at radius $R$ to reach the center is $R$, and the travel time is $R / U_s(R)$.\n- The launch time $t_{\\mathrm{launch}}(R)$ equals the time it takes the liner inner surface to move from $R_0$ to $R$ following the speed profile $v(R)$, that is, an integral of the form $\\int_{R}^{R_0} \\frac{d\\xi}{v(\\xi)}$.\n- To achieve perfect coalescence at the center at a common time $t_c$, the required timing adjustment for each shock launched at $R_i$ is $\\delta t(R_i) = t_c - \\left(t_{\\mathrm{launch}}(R_i) + \\frac{R_i}{U_s(R_i)}\\right)$, which must be nonnegative.\n\nYour program must implement this algorithm for the three test cases below, each specifying a physically plausible speed profile $v(R)$, fuel properties, and a discrete set of launch radii uniformly spaced between $R_{\\min}$ and $R_0$ (inclusive). For each case, compute:\n1. The coalescence time $t_c$ in seconds, defined as the maximum over $i$ of $t_{\\mathrm{launch}}(R_i) + \\frac{R_i}{U_s(R_i)}$.\n2. The central pressure estimate $p_c$ in pascals, taken as the maximum over $i$ of $p_2(R_i)$.\n3. The maximum required timing adjustment $\\max_i \\delta t(R_i)$ in seconds, representing the largest delay needed to ensure coalescence at $t_c$.\n\nExpress all times in seconds and all pressures in pascals, as real-valued numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by test case and, within each test case, ordered as $[t_c, p_c, \\max \\delta t]$.\n\nTest Suite:\n- Case A (happy path, constant-speed liner):\n  - $R_0 = 3 \\times 10^{-3}\\,\\mathrm{m}$, $R_{\\min} = 1 \\times 10^{-3}\\,\\mathrm{m}$, $N = 5$ launch radii.\n  - $v(R) = v_0$ with $v_0 = 5.0 \\times 10^{4}\\,\\mathrm{m/s}$.\n  - $\\rho_f = 1.0\\,\\mathrm{kg/m^3}$, $\\gamma = 5/3$.\n- Case B (moderate acceleration of liner with radius):\n  - $R_0 = 4 \\times 10^{-3}\\,\\mathrm{m}$, $R_{\\min} = 1 \\times 10^{-3}\\,\\mathrm{m}$, $N = 7$ launch radii.\n  - $v(R) = v_0 + k \\left(R_0 - R\\right)$ with $v_0 = 3.0 \\times 10^{4}\\,\\mathrm{m/s}$ and $k = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}$.\n  - $\\rho_f = 1.2\\,\\mathrm{kg/m^3}$, $\\gamma = 5/3$.\n- Case C (power-law increase in liner speed toward smaller radius):\n  - $R_0 = 5 \\times 10^{-3}\\,\\mathrm{m}$, $R_{\\min} = 1 \\times 10^{-3}\\,\\mathrm{m}$, $N = 9$ launch radii.\n  - $v(R) = v_0 \\left(\\frac{R}{R_0}\\right)^{-n}$ with $v_0 = 2.0 \\times 10^{4}\\,\\mathrm{m/s}$ and $n = 0.5$.\n  - $\\rho_f = 0.5\\,\\mathrm{kg/m^3}$, $\\gamma = 1.4$.\n\nYour program must incorporate the physics consistently and compute the above quantities by integrating the time-of-flight to each launch radius from $R_0$ using the provided speed profiles. Your program should produce exactly one line of output of the form $[r_1,r_2,r_3,\\dots]$, where the entries correspond to Case A $t_c$, Case A $p_c$, Case A $\\max \\delta t$, then Case B $t_c$, Case B $p_c$, Case B $\\max \\delta t$, then Case C $t_c$, Case C $p_c$, Case C $\\max \\delta t$.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the established principles of fluid dynamics and inertial confinement fusion, presenting a well-posed, objective, and formalizable problem. All necessary parameters and definitions are provided, and the requested calculations are based on a simplified but consistent physical model.\n\nThe task is to develop an algorithm to compute key metrics for shock coalescence in a simplified Magneto-Inertial Fusion (MIF) scenario. This involves analyzing a series of shocks launched from an imploding spherical liner at discrete radii $\\{R_i\\}$. For each launch radius $R_i$, we must calculate the liner's travel time to that radius, the properties of the launched shock, and the shock's transit time to the center. The final goal is to determine the coalescence time $t_c$, the maximum central pressure $p_c$, and the maximum timing adjustment $\\max \\delta t$ required for perfect shock convergence at the center.\n\nThe core of the problem rests on the Rankine–Hugoniot jump conditions for a strong shock propagating into a stationary ideal gas. The liner acts as a piston moving with a specified speed $v(R)$. In the reference frame of the stationary upstream fuel, the piston speed is $v_p = v(R)$, which is also the speed of the post-shock fluid, $u_2$.\n\nFor a strong shock driven by a piston into a quiescent ideal gas with adiabatic index $\\gamma$, the relationship between the piston speed $v_p$ and the shock speed $U_s$ is given by:\n$$\nu_2 = v_p = \\frac{2}{\\gamma+1} U_s\n$$\nFrom this, we can express the shock speed $U_s$ as a function of the liner's instantaneous speed $v(R)$:\n$$\nU_s(R) = \\frac{\\gamma+1}{2} v(R)\n$$\nThe pressure behind the shock, $p_2$, in the strong shock limit ($p_2 \\gg p_1$, where $p_1$ is the initial fuel pressure), is given by:\n$$\np_2 - p_1 \\approx p_2 = \\rho_1 U_s u_2\n$$\nHere, $\\rho_1$ is the initial, unshocked fuel density, denoted as $\\rho_f$. Substituting the expressions for $U_s$ and $u_2=v(R)$, we obtain the post-shock pressure as a function of the liner speed:\n$$\np_2(R) = \\rho_f \\left( \\frac{\\gamma+1}{2} v(R) \\right) v(R) = \\frac{\\gamma+1}{2} \\rho_f v(R)^2\n$$\nThe algorithm proceeds as follows for each test case:\n\n1.  **Generate Discretized Launch Radii**: A set of $N$ launch radii, $\\{R_i\\}$, is generated, uniformly spaced between the initial radius $R_0$ and the minimum radius $R_{\\min}$, inclusive.\n\n2.  **Calculate State Variables for each $R_i$**: For each radius $R_i$ in the set, we compute several quantities.\n    \n    a.  **Liner Speed $v(R_i)$**: The liner speed is calculated using the specific functional form provided for each test case.\n    \n    b.  **Shock Speed $U_s(R_i)$**: Using the liner speed, the shock speed is calculated as $U_s(R_i) = \\frac{\\gamma+1}{2} v(R_i)$.\n    \n    c.  **Shock Transit Time $t_{\\mathrm{transit}}(R_i)$**: The time for a shock launched at $R_i$ to reach the center (a distance of $R_i$) is $t_{\\mathrm{transit}}(R_i) = \\frac{R_i}{U_s(R_i)}$.\n    \n    d.  **Post-Shock Pressure $p_2(R_i)$**: This is calculated as $p_2(R_i) = \\frac{\\gamma+1}{2} \\rho_f v(R_i)^2$.\n    \n    e.  **Liner Travel Time (Launch Time) $t_{\\mathrm{launch}}(R_i)$**: This is the time it takes for the liner to implode from $R_0$ to $R_i$. It is given by the integral $t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v(\\xi)}$. We solve this integral analytically for each case:\n        \n        -   **Case A**: $v(\\xi) = v_0$.\n            $$\n            t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v_0} = \\frac{R_0 - R_i}{v_0}\n            $$\n        -   **Case B**: $v(\\xi) = v_0 + k(R_0 - \\xi)$.\n            $$\n            t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v_0 + k(R_0 - \\xi)} = \\left[ -\\frac{1}{k} \\ln(v_0 + k(R_0 - \\xi)) \\right]_{R_i}^{R_0} = \\frac{1}{k} \\ln\\left( \\frac{v_0 + k(R_0 - R_i)}{v_0} \\right)\n            $$\n        -   **Case C**: $v(\\xi) = v_0 \\left(\\frac{\\xi}{R_0}\\right)^{-n}$.\n            $$\n            t_{\\mathrm{launch}}(R_i) = \\int_{R_i}^{R_0} \\frac{d\\xi}{v_0 (\\xi/R_0)^{-n}} = \\frac{R_0^{-n}}{v_0} \\int_{R_i}^{R_0} \\xi^n d\\xi = \\frac{R_0^{-n}}{v_0(n+1)} \\left[\\xi^{n+1}\\right]_{R_i}^{R_0} = \\frac{R_0}{v_0(n+1)} \\left(1 - \\left(\\frac{R_i}{R_0}\\right)^{n+1}\\right)\n            $$\n\n    f.  **Total Arrival Time $t_{\\mathrm{arrival}}(R_i)$**: The total time from the start of the implosion ($t=0$ at $R=R_0$) for a shock launched at $R_i$ to reach the center is the sum of the launch time and the transit time:\n        $$\n        t_{\\mathrm{arrival}}(R_i) = t_{\\mathrm{launch}}(R_i) + t_{\\mathrm{transit}}(R_i)\n        $$\n\n3.  **Determine Final Outputs**: After calculating the arrays of $\\{t_{\\mathrm{arrival}}(R_i)\\}$ and $\\{p_2(R_i)\\}$ for all $i$:\n    \n    a.  **Coalescence Time $t_c$**: To ensure all shocks arrive, we must wait for the one that takes the longest. Thus, $t_c$ is the maximum of all arrival times.\n        $$\n        t_c = \\max_i \\{ t_{\\mathrm{arrival}}(R_i) \\}\n        $$\n    b.  **Central Pressure Estimate $p_c$**: The central pressure is estimated as the highest pressure generated by any of the launched shocks.\n        $$\n        p_c = \\max_i \\{ p_2(R_i) \\}\n        $$\n    c.  **Maximum Timing Adjustment $\\max \\delta t$**: The timing adjustment for each shock is $\\delta t(R_i) = t_c - t_{\\mathrm{arrival}}(R_i)$, which represents the delay needed for that shock launch. The maximum required adjustment is:\n        $$\n        \\max \\delta t = \\max_i \\{ \\delta t(R_i) \\} = t_c - \\min_i \\{ t_{\\mathrm{arrival}}(R_i) \\}\n        $$\n\nThese steps are implemented for each test case to produce the required results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the shock coalescence problem for MIF targets for three test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            # Case A (happy path, constant-speed liner)\n            'name': 'A',\n            'R0': 3e-3, 'R_min': 1e-3, 'N': 5,\n            'v_params': {'v0': 5.0e4},\n            'rho_f': 1.0, 'gamma': 5/3\n        },\n        {\n            # Case B (moderate acceleration of liner with radius)\n            'name': 'B',\n            'R0': 4e-3, 'R_min': 1e-3, 'N': 7,\n            'v_params': {'v0': 3.0e4, 'k': 2.0e7},\n            'rho_f': 1.2, 'gamma': 5/3\n        },\n        {\n            # Case C (power-law increase in liner speed toward smaller radius)\n            'name': 'C',\n            'R0': 5e-3, 'R_min': 1e-3, 'N': 9,\n            'v_params': {'v0': 2.0e4, 'n': 0.5},\n            'rho_f': 0.5, 'gamma': 1.4\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        R0 = case['R0']\n        R_min = case['R_min']\n        N = case['N']\n        rho_f = case['rho_f']\n        gamma = case['gamma']\n        v_params = case['v_params']\n        \n        # 1. Generate Discretized Launch Radii\n        # An array of N radii from R0 (outer) to R_min (inner)\n        R_i = np.linspace(R0, R_min, N)\n        \n        # 2. Calculate State Variables for each R_i\n        \n        # 2a. Liner Speed v(R_i)\n        if case['name'] == 'A':\n            v0 = v_params['v0']\n            v_R = np.full_like(R_i, v0)\n        elif case['name'] == 'B':\n            v0 = v_params['v0']\n            k = v_params['k']\n            v_R = v0 + k * (R0 - R_i)\n        elif case['name'] == 'C':\n            v0 = v_params['v0']\n            n = v_params['n']\n            # Avoid division by zero if R0 is in R_i and R_i is zero, though not an issue here.\n            # (R_i / R0) will be > 0.\n            v_R = v0 * (R_i / R0)**(-n)\n        \n        # Physics factor from strong shock relation\n        gamma_factor = (gamma + 1) / 2\n        \n        # 2b. Shock Speed U_s(R_i)\n        # U_s = (gamma+1)/2 * v_piston\n        U_s = gamma_factor * v_R\n        \n        # 2c. Shock Transit Time t_transit(R_i)\n        # t = distance / speed = R_i / U_s\n        # Handle potential division by zero, although v_R > 0 for all cases here.\n        t_transit = np.divide(R_i, U_s, out=np.zeros_like(U_s), where=U_s!=0)\n        \n        # 2d. Post-Shock Pressure p_2(R_i)\n        # p2 = rho_1 * U_s * u_2 = rho_1 * U_s * v_piston\n        # p2 = (gamma+1)/2 * rho_1 * v_piston^2\n        p2 = gamma_factor * rho_f * v_R**2\n        \n        # 2e. Liner Travel Time (Launch Time) t_launch(R_i)\n        # Integrate 1/v(xi) from R_i to R0\n        if case['name'] == 'A':\n            v0 = v_params['v0']\n            t_launch = (R0 - R_i) / v0\n        elif case['name'] == 'B':\n            v0 = v_params['v0']\n            k = v_params['k']\n            # Using log identity to avoid potential floating point issues with log(1)\n            arg = k * (R0 - R_i) / v0\n            t_launch = (1/k) * np.log1p(arg)\n        elif case['name'] == 'C':\n            v0 = v_params['v0']\n            n = v_params['n']\n            t_launch = (R0 / (v0 * (n + 1))) * (1 - (R_i / R0)**(n + 1))\n\n        # 2f. Total Arrival Time t_arrival(R_i)\n        t_arrival = t_launch + t_transit\n        \n        # 3. Determine Final Outputs\n        \n        # 3a. Coalescence Time t_c\n        tc = np.max(t_arrival)\n        \n        # 3b. Central Pressure Estimate p_c\n        pc = np.max(p2)\n        \n        # 3c. Maximum Timing Adjustment max_delta_t\n        # delta_t = tc - t_arrival. max(delta_t) = tc - min(t_arrival)\n        max_delta_t = tc - np.min(t_arrival)\n        \n        results.extend([tc, pc, max_delta_t])\n\n    # Final print statement in the exact required format.\n    # Flatten the list of results and format as a comma-separated string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The ultimate success of a fusion system hinges on achieving a self-sustaining burn, where energetic fusion products deposit their energy back into the plasma, offsetting losses. This final practice tackles the complex physics of alpha particle confinement and heating in a magnetized plasma, a core challenge for many alternative concepts (). You will build a model that combines collisional slowing-down with magnetic mirror confinement to estimate what fraction of the alpha particle energy is successfully retained by the fuel. This analysis provides critical insight into the conditions needed to \"bootstrap\" the plasma to ignition.",
            "id": "3950849",
            "problem": "Consider a magnetized deuterium–tritium fuel relevant to alternative fusion concepts including Magnetized Inertial Fusion (MIF), Magnetized Liner Inertial Fusion (MagLIF), Z-pinch, Reversed Field Pinch (RFP), spherical tokamaks, and heavy-ion drivers. A fusion-produced alpha particle is born with kinetic energy and an isotropic pitch-angle distribution at a location of minimum magnetic field along the confining field line. The objective is to estimate the fraction of the alpha energy that is deposited within the fuel and to determine the corresponding contribution to the thermal energy balance, using first-principles models for collisional stopping and magnetic mirroring.\n\nStarting from fundamental bases:\n\n- Coulomb collisions between charged particles transfer energy from a fast ion to background electrons and ions. Alpha slowing-down is governed by energy loss due to Coulomb scattering with electrons in the high-speed limit.\n- The adiabatic magnetic moment invariance and conservation of total energy in a slowly varying magnetic field determine the magnetic mirroring condition for charged particle motion along the field.\n\nAssumptions to be used:\n\n- The alpha particle initial kinetic energy is $E_0$.\n- The alpha charge number is $Z_\\alpha = 2$ and mass is $m_\\alpha$.\n- The electron number density is $n_e$ and electron mass is $m_e$.\n- The Coulomb logarithm is $\\ln\\Lambda$.\n- The electron and ion temperatures are equal and denoted $T$.\n- The ion number density satisfies $n_i = n_e$.\n- The magnetic field has a minimum $B_{\\min}$ and maximum $B_{\\max}$ along the field line, defining the mirror ratio $R_m = B_{\\max}/B_{\\min} \\ge 1$.\n- The pitch-angle $\\theta$ is measured in radians.\n- The characteristic parallel distance to an end loss region is $L_\\parallel$ (in meters).\n- The alpha birth pitch-angle distribution is isotropic at $B_{\\min}$.\n- The deposited energy is added to the thermal energy of the plasma; the thermal energy density is $U_{\\mathrm{th}} = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T$.\n- The alpha source rate per unit volume is $S_\\alpha$ (in $\\mathrm{s^{-1}\\,m^{-3}}$).\n- The thermalization threshold energy is $E_{\\mathrm{th}} = 3 k_B T$.\n\nDefine the following computational tasks:\n\n1. Derive the collisional energy slowing-down time $\\tau_s$ required for an alpha born at energy $E_0$ to slow to $E_{\\mathrm{th}}$ in a background plasma of electrons with density $n_e$ and temperature $T$, using a high-speed Coulomb collision model. Express all quantities in SI units.\n2. Derive the magnetic loss cone half-angle at $B_{\\min}$ from magnetic mirroring invariants and compute the confined fraction of alpha pitch angles $f_{\\mathrm{conf}}$ for an isotropic distribution.\n3. Estimate the average escape time $\\tau_{\\mathrm{esc}}$ for alphas that are in the loss cone, by averaging the parallel transit time to the end loss region over the loss cone distribution. Use $L_\\parallel$ and the initial alpha speed $v_0 = \\sqrt{2 E_0 / m_\\alpha}$ for this estimate.\n4. Compute the alpha energy deposition fraction $f_{\\mathrm{dep}}$ as the sum of:\n   - Complete deposition by the magnetically confined fraction $f_{\\mathrm{conf}}$, and\n   - Partial deposition by the loss-cone fraction $(1 - f_{\\mathrm{conf}})$, approximated by $\\min(1, \\tau_{\\mathrm{esc}} / \\tau_s)$.\n5. Compute the volumetric alpha heating rate $Q_\\alpha = f_{\\mathrm{dep}} E_0 S_\\alpha$ and the heating rate relative to the existing thermal energy density $r = Q_\\alpha / U_{\\mathrm{th}}$ (in $\\mathrm{s^{-1}}$).\n\nUnits and outputs:\n\n- Use SI units throughout. Energies must be in joules, magnetic fields in tesla, lengths in meters, number densities in $\\mathrm{m^{-3}}$, temperatures in joules via $k_B T$, and time in seconds.\n- Angles are in radians.\n- The program must output, for each test case, two values: the energy deposition fraction $f_{\\mathrm{dep}}$ (dimensionless) and the heating rate ratio $r$ (in $\\mathrm{s^{-1}}$).\n- Express each output value as a decimal rounded to $6$ significant figures.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[f_{\\mathrm{dep},1}, r_1, f_{\\mathrm{dep},2}, r_2, f_{\\mathrm{dep},3}, r_3, f_{\\mathrm{dep},4}, r_4]$.\n\nPhysical constants to be used (in SI):\n\n- Elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$.\n- Electron mass $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$.\n- Alpha mass $m_\\alpha = 6.6446573357 \\times 10^{-27}\\,\\mathrm{kg}$.\n- Boltzmann constant $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$.\n- Coulomb constant $k_e = 1/(4\\pi\\epsilon_0) = 8.9875517923 \\times 10^{9}\\,\\mathrm{N\\,m^2\\,C^{-2}}$.\n- Alpha birth energy $E_0 = 3.5\\,\\mathrm{MeV}$.\n\nTest suite:\n\nProvide the following four test cases, each specified by $(n_e, T, R_m, L_\\parallel, \\ln\\Lambda, S_\\alpha)$:\n\n- Case $1$ (Magnetized Liner Inertial Fusion cylinder):\n  - $n_e = 1.0 \\times 10^{26}\\,\\mathrm{m^{-3}}$,\n  - $T = 3.0\\,\\mathrm{keV}$,\n  - $R_m = 10.0$,\n  - $L_\\parallel = 0.01\\,\\mathrm{m}$,\n  - $\\ln\\Lambda = 10.0$,\n  - $S_\\alpha = 1.0 \\times 10^{29}\\,\\mathrm{s^{-1}\\,m^{-3}}$.\n- Case $2$ (spherical tokamak-like parameters):\n  - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$,\n  - $T = 10.0\\,\\mathrm{keV}$,\n  - $R_m = 1.5$,\n  - $L_\\parallel = 5.0\\,\\mathrm{m}$,\n  - $\\ln\\Lambda = 17.0$,\n  - $S_\\alpha = 1.0 \\times 10^{22}\\,\\mathrm{s^{-1}\\,m^{-3}}$.\n- Case $3$ (Z-pinch-like dense column):\n  - $n_e = 5.0 \\times 10^{27}\\,\\mathrm{m^{-3}}$,\n  - $T = 1.0\\,\\mathrm{keV}$,\n  - $R_m = 5.0$,\n  - $L_\\parallel = 0.005\\,\\mathrm{m}$,\n  - $\\ln\\Lambda = 8.0$,\n  - $S_\\alpha = 5.0 \\times 10^{30}\\,\\mathrm{s^{-1}\\,m^{-3}}$.\n- Case $4$ (heavy-ion driver magnetized target):\n  - $n_e = 1.0 \\times 10^{25}\\,\\mathrm{m^{-3}}$,\n  - $T = 5.0\\,\\mathrm{keV}$,\n  - $R_m = 2.0$,\n  - $L_\\parallel = 0.02\\,\\mathrm{m}$,\n  - $\\ln\\Lambda = 12.0$,\n  - $S_\\alpha = 1.0 \\times 10^{28}\\,\\mathrm{s^{-1}\\,m^{-3}}$.\n\nYour program must implement the above physics, compute $f_{\\mathrm{dep}}$ and $r$ for each case, and output a single line as specified.",
            "solution": "The problem statement is scientifically grounded, well-posed, and self-contained, presenting a valid classical physics problem in plasma confinement and energetic particle transport. It provides all necessary physical constants, parameters, and a clear set of computational tasks based on established principles of plasma physics. We proceed with a step-by-step derivation of the requested quantities.\n\nThe core of the problem lies in the interplay between two characteristic timescales: the collisional slowing-down time, $\\tau_s$, and the particle loss time, which is determined by magnetic confinement geometry. We analyze the behavior of fusion-born alpha particles by partitioning them into two populations: a magnetically confined fraction and an escaping (loss-cone) fraction.\n\n**1. Collisional Energy Slowing-Down Time, $\\tau_s$**\n\nAn energetic alpha particle traversing a plasma loses energy primarily through Coulomb collisions with the background electrons and ions. The problem specifies the high-speed limit, where the alpha speed $v_\\alpha$ is much greater than the thermal speed of the background electrons. In this regime, the energy loss is dominated by drag from the electrons. The rate of energy loss is given by:\n$$ \\frac{dE}{dt} = -\\frac{n_e Z_\\alpha^2 e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e v_\\alpha} $$\nHere, $E = \\frac{1}{2} m_\\alpha v_\\alpha^2$ is the kinetic energy of the alpha particle, $Z_\\alpha = 2$ is its charge number, $m_\\alpha$ its mass, $n_e$ is the electron density, $m_e$ is the electron mass, $e$ is the elementary charge, and $\\ln\\Lambda$ is the Coulomb logarithm. We can express the velocity as $v_\\alpha = \\sqrt{2E/m_\\alpha}$. Substituting this into the energy loss equation and using the Coulomb constant $k_e = 1/(4\\pi\\epsilon_0)$ (which implies $1/\\epsilon_0^2 = 16\\pi^2 k_e^2$), we get:\n$$ \\frac{dE}{dt} = -\\frac{4\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda}{m_e} \\sqrt{\\frac{m_\\alpha}{2E}} = -C \\frac{1}{\\sqrt{E}} $$\nwhere the constant $C$ is given by $C = \\frac{4\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda \\sqrt{m_\\alpha}}{m_e \\sqrt{2}}$. This is a separable ordinary differential equation for the energy $E(t)$. To find the time $\\tau_s$ it takes for an alpha particle to slow from its birth energy $E_0$ to a thermalization energy $E_{\\mathrm{th}} = 3k_B T$, we integrate:\n$$ \\int_{E_0}^{E_{\\mathrm{th}}} E^{1/2} dE = -\\int_0^{\\tau_s} C dt $$\n$$ \\left[ \\frac{2}{3} E^{3/2} \\right]_{E_0}^{E_{\\mathrm{th}}} = -C \\tau_s $$\n$$ \\frac{2}{3} (E_{\\mathrm{th}}^{3/2} - E_0^{3/2}) = -C \\tau_s $$\nSolving for the slowing-down time $\\tau_s$:\n$$ \\tau_s = \\frac{2(E_0^{3/2} - E_{\\mathrm{th}}^{3/2})}{3C} = \\frac{\\sqrt{2} m_e (E_0^{3/2} - E_{\\mathrm{th}}^{3/2})}{6\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda \\sqrt{m_\\alpha}} $$\nThis expression for $\\tau_s$ will be implemented using the provided parameters, all in SI units.\n\n**2. Magnetic Loss Cone and Confined Fraction, $f_{\\mathrm{conf}}$**\n\nIn a magnetic mirror configuration, charged particle motion is governed by the conservation of kinetic energy $E$ and the first adiabatic invariant, the magnetic moment $\\mu = \\frac{m_\\alpha v_\\perp^2}{2B}$, where $v_\\perp$ is the velocity component perpendicular to the magnetic field $\\vec{B}$. Given a pitch angle $\\theta$ such that $v_\\perp = v \\sin\\theta$, conservation of $\\mu$ and $E$ implies:\n$$ \\frac{\\sin^2\\theta}{B} = \\text{constant} $$\nA particle starting at the magnetic field minimum $B_{\\min}$ with pitch angle $\\theta_{\\min}$ will be reflected where its pitch angle becomes $\\pi/2$. Let the field at this reflection point be $B_{\\mathrm{refl}}$. Then, $\\frac{\\sin^2\\theta_{\\min}}{B_{\\min}} = \\frac{\\sin^2(\\pi/2)}{B_{\\mathrm{refl}}} = \\frac{1}{B_{\\mathrm{refl}}}$.\nA particle is confined if it reflects before reaching the maximum field $B_{\\max}$, i.e., if $B_{\\mathrm{refl}} \\le B_{\\max}$. This implies $\\sin^2\\theta_{\\min} \\le \\frac{B_{\\min}}{B_{\\max}} = \\frac{1}{R_m}$, where $R_m$ is the mirror ratio.\nParticles that do not satisfy this condition are in the \"loss cone\" and escape. The loss cone half-angle, $\\theta_L$, is defined by the boundary of this condition: $\\sin\\theta_L = 1/\\sqrt{R_m}$.\nFor an isotropic pitch-angle distribution at birth, the particle distribution is uniform over the solid angle $4\\pi$. The fraction of particles that are confined corresponds to the fraction of the total solid angle outside the two loss cones (one at each end of the velocity sphere). This fraction is given by:\n$$ f_{\\mathrm{conf}} = \\frac{\\int_{\\theta_L}^{\\pi-\\theta_L} 2\\pi \\sin\\theta d\\theta}{\\int_0^\\pi 2\\pi \\sin\\theta d\\theta} = \\frac{[-\\cos\\theta]_{\\theta_L}^{\\pi-\\theta_L}}{2} = \\frac{\\cos\\theta_L - \\cos(\\pi-\\theta_L)}{2} = \\cos\\theta_L $$\nUsing the identity $\\cos\\theta_L = \\sqrt{1-\\sin^2\\theta_L}$, we find the confined fraction to be:\n$$ f_{\\mathrm{conf}} = \\sqrt{1 - \\frac{1}{R_m}} $$\n\n**3. Average Escape Time, $\\tau_{\\mathrm{esc}}$**\n\nFor particles born in the loss cone ($0 \\le \\theta < \\theta_L$), we estimate their escape time. The parallel velocity is $v_\\parallel(\\theta) = v_0 \\cos\\theta$, where $v_0 = \\sqrt{2E_0/m_\\alpha}$ is the initial speed. The transit time to escape over a distance $L_\\parallel$ is $t(\\theta) = L_\\parallel / v_\\parallel(\\theta)$. To find the average escape time, we average $t(\\theta)$ over the loss-cone pitch-angle distribution. The probability distribution for $\\theta$ is $p(\\theta) = \\frac{1}{2}\\sin\\theta$.\nThe average time, considering one loss cone ($0 \\le \\theta < \\theta_L$), is:\n$$ \\tau_{\\mathrm{esc}} = \\frac{\\int_0^{\\theta_L} t(\\theta) p(\\theta) d\\theta}{\\int_0^{\\theta_L} p(\\theta) d\\theta} = \\frac{\\int_0^{\\theta_L} \\frac{L_\\parallel}{v_0 \\cos\\theta} \\frac{1}{2}\\sin\\theta d\\theta}{\\int_0^{\\theta_L} \\frac{1}{2}\\sin\\theta d\\theta} $$\nThe numerator integral is $\\frac{L_\\parallel}{2v_0} \\int_0^{\\theta_L} \\tan\\theta d\\theta = \\frac{L_\\parallel}{2v_0} [-\\ln(\\cos\\theta)]_0^{\\theta_L} = -\\frac{L_\\parallel}{2v_0} \\ln(\\cos\\theta_L)$.\nThe denominator integral is $\\frac{1}{2}[-\\cos\\theta]_0^{\\theta_L} = \\frac{1}{2}(1 - \\cos\\theta_L)$.\nCombining these results gives the average escape time:\n$$ \\tau_{\\mathrm{esc}} = \\frac{-\\frac{L_\\parallel}{2v_0} \\ln(\\cos\\theta_L)}{\\frac{1}{2}(1 - \\cos\\theta_L)} = \\frac{L_\\parallel}{v_0} \\frac{-\\ln(\\cos\\theta_L)}{1 - \\cos\\theta_L} $$\nUsing $\\cos\\theta_L = \\sqrt{1-1/R_m}$, we can calculate $\\tau_{\\mathrm{esc}}$. For $R_m=1$, this expression is undefined, but the provided test cases all have $R_m > 1$.\n\n**4. Total Alpha Energy Deposition Fraction, $f_{\\mathrm{dep}}$**\n\nThe total fraction of deposited alpha energy is the sum of contributions from the confined and escaping populations.\n- The confined fraction, $f_{\\mathrm{conf}}$, is assumed to deposit its entire energy. Its contribution is $f_{\\mathrm{conf}} \\times 1$.\n- The loss-cone fraction, $(1 - f_{\\mathrm{conf}})$, escapes in an average time $\\tau_{\\mathrm{esc}}$. During this time, it deposits a fraction of its energy approximated by the ratio of timescales $\\tau_{\\mathrm{esc}}/\\tau_s$. This fractional deposition is capped at $1$, as a particle cannot deposit more than its total energy. So the contribution is $(1-f_{\\mathrm{conf}}) \\times \\min(1, \\tau_{\\mathrm{esc}}/\\tau_s)$.\nSumming these contributions gives the total deposition fraction:\n$$ f_{\\mathrm{dep}} = f_{\\mathrm{conf}} + (1 - f_{\\mathrm{conf}}) \\min(1, \\frac{\\tau_{\\mathrm{esc}}}{\\tau_s}) $$\n\n**5. Volumetric Heating Rate, $Q_\\alpha$, and Relative Heating Rate, $r$**\n\nThe volumetric alpha heating power density, $Q_\\alpha$, is the product of the alpha source rate per unit volume $S_\\alpha$, the energy per alpha $E_0$, and the fraction of that energy which is deposited, $f_{\\mathrm{dep}}$:\n$$ Q_\\alpha = f_{\\mathrm{dep}} E_0 S_\\alpha $$\nThe thermal energy density of the background plasma, assuming equal electron and ion temperatures ($T_e=T_i=T$) and charge neutrality for a deuterium-tritium plasma ($n_i=n_e$), is:\n$$ U_{\\mathrm{th}} = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T = 3 n_e k_B T $$\nThe heating rate relative to the existing thermal energy density, $r$, is the ratio of the heating power density to the thermal energy density. This quantity has units of $\\mathrm{s^{-1}}$ and represents a characteristic inverse time for plasma heating by alpha particles.\n$$ r = \\frac{Q_\\alpha}{U_{\\mathrm{th}}} = \\frac{f_{\\mathrm{dep}} E_0 S_\\alpha}{3 n_e k_B T} $$\nThese formulae provide the basis for the numerical computation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for alpha particle energy deposition fraction and relative heating rate\n    for several alternative fusion concept scenarios.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_E = 9.1093837015e-31      # Electron mass in kg\n    M_ALPHA = 6.6446573357e-27  # Alpha particle mass in kg\n    K_B = 1.380649e-23          # Boltzmann constant in J/K\n    K_E = 8.9875517923e9        # Coulomb constant in N m^2 C^-2\n    \n    # Problem-specific constants\n    E0_MEV = 3.5                # Alpha birth energy in MeV\n    E0_J = E0_MEV * 1e6 * E_CHARGE  # Alpha birth energy in Joules\n    Z_ALPHA = 2.0                 # Alpha charge number\n\n    def calculate_metrics(n_e, T_keV, R_m, L_parallel, ln_Lambda, S_alpha):\n        \"\"\"\n        Computes f_dep and r for a single test case.\n        \n        Args:\n            n_e (float): Electron number density (m^-3)\n            T_keV (float): Plasma temperature (k_B*T) in keV\n            R_m (float): Mirror ratio (B_max / B_min)\n            L_parallel (float): Parallel distance to end loss region (m)\n            ln_Lambda (float): Coulomb logarithm\n            S_alpha (float): Alpha source rate per unit volume (s^-1 m^-3)\n\n        Returns:\n            tuple: (f_dep, r)\n        \"\"\"\n        \n        # Convert temperature to Joules\n        kBT_J = T_keV * 1e3 * E_CHARGE\n        \n        # --- Task 1: Calculate collisional slowing-down time tau_s ---\n        E_th = 3.0 * kBT_J  # Thermalization energy\n        \n        # Ensure E0 > E_th to avoid math domain errors\n        if E0_J <= E_th:\n             tau_s = 0.0\n        else:\n            # Constant part of the tau_s formula\n            C1 = (np.sqrt(2.0) * M_E) / (6.0 * np.pi * K_E**2 * E_CHARGE**4)\n            # Variable part\n            C2 = (E0_J**1.5 - E_th**1.5) / (n_e * ln_Lambda * Z_ALPHA**2 * np.sqrt(M_ALPHA))\n            tau_s = C1 * C2\n\n        # --- Task 2: Calculate confined fraction f_conf ---\n        if R_m < 1.0:\n            # Physically R_m should be >= 1. If not, handle as no confinement.\n            f_conf = 0.0\n        else:\n            f_conf = np.sqrt(1.0 - 1.0 / R_m)\n\n        # --- Task 3: Calculate average escape time tau_esc ---\n        v0 = np.sqrt(2.0 * E0_J / M_ALPHA)\n        cos_theta_L = f_conf # As derived: f_conf = cos(theta_L)\n        \n        # Handle the case R_m = 1 (cos_theta_L = 0) where log(0) is -inf\n        if np.isclose(cos_theta_L, 0):\n            # Model breaks down, escape time is effectively infinite for some particles\n            # but for the average, it is very large compared to tau_s.\n            # Using a very large number to ensure min(1, tau_esc/tau_s) = 1\n            tau_esc = np.inf\n        else:\n            tau_esc = (L_parallel / v0) * (-np.log(cos_theta_L) / (1.0 - cos_theta_L))\n\n        # --- Task 4: Compute alpha energy deposition fraction f_dep ---\n        if tau_s > 0:\n            deposition_ratio = tau_esc / tau_s\n        else: # If tau_s is effectively zero (instant slowing), deposition is immediate\n             deposition_ratio = np.inf\n\n        partial_deposition = min(1.0, deposition_ratio)\n        f_dep = f_conf + (1.0 - f_conf) * partial_deposition\n        \n        # --- Task 5: Compute volumetric heating rate Q_alpha and relative rate r ---\n        U_th = 3.0 * n_e * kBT_J\n        Q_alpha = f_dep * E0_J * S_alpha\n        \n        if U_th > 0:\n            r = Q_alpha / U_th\n        else:\n            r = np.inf # If thermal energy is zero, any heating is infinite relative rate\n\n        return f_dep, r\n\n    # Test suite from the problem description\n    test_cases = [\n        # Case 1 (MagLIF)\n        (1.0e26, 3.0, 10.0, 0.01, 10.0, 1.0e29),\n        # Case 2 (spherical tokamak)\n        (5.0e19, 10.0, 1.5, 5.0, 17.0, 1.0e22),\n        # Case 3 (Z-pinch)\n        (5.0e27, 1.0, 5.0, 0.005, 8.0, 5.0e30),\n        # Case 4 (heavy-ion driver)\n        (1.0e25, 5.0, 2.0, 0.02, 12.0, 1.0e28),\n    ]\n\n    results = []\n    for case in test_cases:\n        f_dep, r = calculate_metrics(*case)\n        # Format to 6 significant figures\n        results.append(f\"{f_dep:.6g}\")\n        results.append(f\"{r:.6g}\")\n\n    # Print the final output in the specified single-line format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}