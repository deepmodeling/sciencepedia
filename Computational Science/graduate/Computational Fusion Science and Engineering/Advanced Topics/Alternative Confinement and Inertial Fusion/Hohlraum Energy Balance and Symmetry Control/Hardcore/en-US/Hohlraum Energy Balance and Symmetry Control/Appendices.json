{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes a baseline understanding of energy conservation within the hohlraum. By applying a simplified lumped thermal capacity model, you will derive an estimate for the time required for laser energy to heat the hohlraum wall to a target temperature . This practice grounds the complex physics of hohlraums in fundamental energy balance principles and provides a tangible feel for the timescales involved in laser-plasma interactions.",
            "id": "3991144",
            "problem": "A cylindrical hohlraum is used to convert laser energy to x-rays for indirect-drive inertial confinement fusion. The inner wall is made of high-atomic-number metal and is modeled as a lumped thermal capacity over the wall thickness. Consider a hohlraum with inner radius $R$, axial length $L$, and two Laser Entrance Holes (LEHs) of radius $r_{\\mathrm{LEH}}$ on the endcaps. The wall has uniform thickness $t$, mass density $\\rho$, and constant (effective) specific heat $c_p$ over the relevant temperature range. The net fraction of incident laser power absorbed into the wall (after laser-to-x-ray conversion and any re-radiation losses) is $\\eta_{\\mathrm{abs}}$, and the laser delivers constant power $P_L$ during the time of interest.\n\nStarting from conservation of energy and the definition of thermal capacity, derive a closed-form expression for the wall heating time $t_h$ required to raise the wall temperature by $\\Delta T$ under uniform energy deposition over the inner surface area. Use the cylindrical geometry to construct the inner wall area as the sum of the inner cylindrical surface and the two endcaps, subtracting the two LEHs:\n$$\nA_w \\;=\\; 2\\pi R L \\;+\\; 2\\pi R^2 \\;-\\; 2\\pi r_{\\mathrm{LEH}}^2.\n$$\nDefine the areal mass as $m_a=\\rho\\,t$ and model the energy required for the temperature rise by the lumped capacity relation $E_{\\mathrm{req}} \\approx A_w\\,m_a\\,c_p\\,\\Delta T$. Relate $E_{\\mathrm{req}}$ to the absorbed laser energy $\\eta_{\\mathrm{abs}} P_L t_h$ and solve for $t_h$.\n\nCompute the numerical value of $t_h$ for the following parameters, and use the specified units and precision:\n- $R = 2.00 \\times 10^{-3}$ m, $L = 9.00 \\times 10^{-3}$ m, $r_{\\mathrm{LEH}} = 1.00 \\times 10^{-3}$ m,\n- $t = 1.50 \\times 10^{-4}$ m, $\\rho = 1.93 \\times 10^{4}$ kg/m$^3$, $c_p = 1.29 \\times 10^{2}$ J/kg/K,\n- $\\Delta T = 3.00 \\times 10^{3}$ K, $\\eta_{\\mathrm{abs}} = 0.75$, $P_L = 1.00 \\times 10^{11}$ W.\n\nExpress the final heating time in nanoseconds (ns). Round your answer to three significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed. The givens are:\n- Inner radius: $R = 2.00 \\times 10^{-3}$ m\n- Axial length: $L = 9.00 \\times 10^{-3}$ m\n- Laser Entrance Hole (LEH) radius: $r_{\\mathrm{LEH}} = 1.00 \\times 10^{-3}$ m\n- Wall thickness: $t = 1.50 \\times 10^{-4}$ m\n- Mass density: $\\rho = 1.93 \\times 10^{4}$ kg/m$^3$\n- Specific heat: $c_p = 1.29 \\times 10^{2}$ J/kg/K\n- Wall temperature rise: $\\Delta T = 3.00 \\times 10^{3}$ K\n- Net fraction of absorbed laser power: $\\eta_{\\mathrm{abs}} = 0.75$\n- Laser power: $P_L = 1.00 \\times 10^{11}$ W\n- Inner wall area: $A_w = 2\\pi R L + 2\\pi R^2 - 2\\pi r_{\\mathrm{LEH}}^2$\n- Areal mass: $m_a = \\rho t$\n- Required energy for temperature rise: $E_{\\mathrm{req}} \\approx A_w m_a c_p \\Delta T$\n\nThe problem is based on the fundamental principle of energy conservation and uses a standard lumped-parameter model for thermal analysis, which is a valid simplification in this context. The parameters provided are physically realistic for indirect-drive inertial confinement fusion experiments. The problem is well-defined, with all necessary information provided and no contradictions. Therefore, the problem is deemed valid and a solution can be formulated.\n\nThe solution proceeds by applying the principle of conservation of energy. The total energy absorbed by the hohlraum wall, $E_{\\mathrm{abs}}$, over the heating time $t_h$ must equal the energy required to raise the wall temperature by $\\Delta T$, denoted as $E_{\\mathrm{req}}$.\n$$\nE_{\\mathrm{abs}} = E_{\\mathrm{req}}\n$$\nThe absorbed energy is the product of the constant absorbed power and the heating time. The absorbed power is the fraction $\\eta_{\\mathrm{abs}}$ of the incident laser power $P_L$.\n$$\nE_{\\mathrm{abs}} = (\\eta_{\\mathrm{abs}} P_L) t_h\n$$\nThe energy required to heat the wall is given by the lumped thermal capacity relation provided in the problem statement. The total mass of the wall to be heated is the product of the inner wall surface area $A_w$, the wall thickness $t$, and the mass density $\\rho$. The problem simplifies this by defining an areal mass $m_a = \\rho t$.\n$$\nE_{\\mathrm{req}} = A_w m_a c_p \\Delta T\n$$\nEquating the expressions for absorbed and required energy, we obtain:\n$$\n\\eta_{\\mathrm{abs}} P_L t_h = A_w m_a c_p \\Delta T\n$$\nSolving for the heating time $t_h$ gives the general symbolic expression:\n$$\nt_h = \\frac{A_w m_a c_p \\Delta T}{\\eta_{\\mathrm{abs}} P_L}\n$$\nNow, we substitute the given expressions for the wall area $A_w$ and the areal mass $m_a$:\n$$\nA_w = 2\\pi (RL + R^2 - r_{\\mathrm{LEH}}^2)\n$$\n$$\nm_a = \\rho t\n$$\nSubstituting these into the equation for $t_h$ yields the complete closed-form expression:\n$$\nt_h = \\frac{2\\pi (RL + R^2 - r_{\\mathrm{LEH}}^2) (\\rho t) c_p \\Delta T}{\\eta_{\\mathrm{abs}} P_L}\n$$\nThis completes the derivation part of the problem. The next step is to compute the numerical value of $t_h$ using the provided parameters.\n\nFirst, we calculate the terms in the numerator.\nThe inner wall area $A_w$:\n$$\nA_w = 2\\pi \\left( (2.00 \\times 10^{-3})(9.00 \\times 10^{-3}) + (2.00 \\times 10^{-3})^2 - (1.00 \\times 10^{-3})^2 \\right)\n$$\n$$\nA_w = 2\\pi \\left( 18.0 \\times 10^{-6} + 4.00 \\times 10^{-6} - 1.00 \\times 10^{-6} \\right) \\text{m}^2\n$$\n$$\nA_w = 2\\pi (21.0 \\times 10^{-6}) \\text{ m}^2 = 42.0\\pi \\times 10^{-6} \\text{ m}^2\n$$\nThe areal mass $m_a$:\n$$\nm_a = \\rho t = (1.93 \\times 10^{4} \\text{ kg/m}^3)(1.50 \\times 10^{-4} \\text{ m}) = 2.895 \\text{ kg/m}^2\n$$\nNow, we calculate the total required energy $E_{\\mathrm{req}}$:\n$$\nE_{\\mathrm{req}} = A_w m_a c_p \\Delta T\n$$\n$$\nE_{\\mathrm{req}} = (42.0\\pi \\times 10^{-6} \\text{ m}^2) (2.895 \\text{ kg/m}^2) (1.29 \\times 10^{2} \\text{ J/kg/K}) (3.00 \\times 10^{3} \\text{ K})\n$$\n$$\nE_{\\mathrm{req}} = (42.0 \\times 2.895 \\times 1.29 \\times 3.00) \\pi \\times 10^{-6+2+3} \\text{ J}\n$$\n$$\nE_{\\mathrm{req}} = 469.551 \\pi \\times 10^{-1} \\text{ J} \\approx 147.513 \\text{ J}\n$$\nNext, we calculate the absorbed power, $P_{\\mathrm{abs}}$:\n$$\nP_{\\mathrm{abs}} = \\eta_{\\mathrm{abs}} P_L = (0.75)(1.00 \\times 10^{11} \\text{ W}) = 0.75 \\times 10^{11} \\text{ W}\n$$\nFinally, we compute the heating time $t_h$ in seconds:\n$$\nt_h = \\frac{E_{\\mathrm{req}}}{P_{\\mathrm{abs}}} = \\frac{46.9551 \\pi \\text{ J}}{0.75 \\times 10^{11} \\text{ W}}\n$$\n$$\nt_h = \\frac{147.513...}{0.75 \\times 10^{11}} \\text{ s} \\approx 1.96684 \\times 10^{-9} \\text{ s}\n$$\nThe problem requires the final answer in nanoseconds (ns), where $1 \\text{ ns} = 10^{-9} \\text{ s}$.\n$$\nt_h \\approx 1.96684 \\text{ ns}\n$$\nRounding the result to three significant figures, we get:\n$$\nt_h \\approx 1.97 \\text{ ns}\n$$",
            "answer": "$$\\boxed{1.97}$$"
        },
        {
            "introduction": "Achieving a spherically symmetric implosion is paramount in inertial confinement fusion. This practice moves beyond total energy to explore its spatial distribution, introducing the crucial concepts of Legendre moments to quantify asymmetry . You will implement a viewfactor-based sensitivity analysis to determine how engineering imperfections, such as laser pointing jitter, translate into a low-order drive asymmetry ($P_2$), a core skill for defining system tolerances.",
            "id": "3991079",
            "problem": "You are tasked with developing a program that computes the allowable angular jitter in laser beam pointing for an inertial confinement fusion (ICF) hohlraum such that the resulting second-order Legendre moment of the capsule drive asymmetry, denoted by $P_2$, remains below a specified tolerance. The calculation must incorporate a viewfactor-based sensitivity analysis. The allowable jitter must be returned in radians. The final program output must aggregate the results of all test cases on a single line as a comma-separated list enclosed in square brackets.\n\nThe fundamental base for this problem is as follows:\n- Conservation of energy: the radiative flux absorbed by the capsule is the sum of contributions from each source region (laser spot or x-ray emitting region) weighted by geometric viewfactors.\n- Radiative viewfactor method: the absorbed flux at a given capsule surface patch is the source power multiplied by a dimensionless viewfactor between the source and the patch.\n- Spherical harmonics and Legendre polynomials: angular drive asymmetry is represented by Legendre moments, with $P_2$ the second Legendre polynomial $P_2(x) = \\frac{3x^2 - 1}{2}$.\n- Small-angle linearization: for sufficiently small pointing-angle perturbations, the change in viewfactor is linear in the angle perturbation.\n\nAssume an axisymmetric capsule where the absorbed flux distribution on the capsule is discretized at $n_p$ polar locations indexed by $j \\in \\{1,\\dots,n_p\\}$ with polar angles $\\theta_j \\in [0,\\pi]$ and corresponding Gauss-Legendre quadrature abscissas $\\mu_j = \\cos(\\theta_j)$ and weights $w_j$ that integrate polynomials in $\\mu$ over $[-1,1]$ exactly up to a specified degree. Assume $n_b$ laser beams indexed by $i \\in \\{1,\\dots,n_b\\}$, each with power $P_i$ (in watts). Let the nominal viewfactor from beam $i$ to capsule patch $j$ be $V_{ij}$ (dimensionless), and the sensitivity of the viewfactor with respect to the pointing angle $\\alpha_i$ be $S_{ij} = \\frac{\\partial V_{ij}}{\\partial \\alpha_i}$ (in $\\mathrm{rad}^{-1}$). The nominal absorbed flux at patch $j$ is defined by\n$$\nq_j = \\sum_{i=1}^{n_b} P_i V_{ij},\n$$\nand the nominal $P_2$ moment (dimensionless) of the drive is defined by\n$$\nA_2 = \\frac{\\sum_{j=1}^{n_p} q_j \\, P_2(\\mu_j) \\, w_j}{\\sum_{j=1}^{n_p} q_j \\, w_j}.\n$$\nAssume small angular jitter $\\delta \\alpha_i$ in the pointing angle of each beam $i$, and approximate the change in absorbed flux at patch $j$ as\n$$\n\\delta q_j \\approx \\sum_{i=1}^{n_b} P_i S_{ij} \\, \\delta \\alpha_i,\n$$\nwhich follows from a first-order Taylor expansion (small-angle linearization). The corresponding first-order change in $A_2$ can be derived by differentiating the above quotient of linear functionals with respect to each angle, yielding the sensitivity $g_i = \\frac{\\partial A_2}{\\partial \\alpha_i}$, which is a linear functional of $S_{ij}$, $P_i$, $w_j$, $P_2(\\mu_j)$, $q_j$, and the denominator sum. For worst-case jitter bounded in the infinity norm, i.e., $|\\delta \\alpha_i| \\leq \\Delta$ for all $i$, a guaranteed bound on the $P_2$ excursion is\n$$\n|\\delta A_2| \\leq \\Delta \\sum_{i=1}^{n_b} |g_i|.\n$$\nTo ensure the total $P_2$ remains below a specified tolerance $T$ (dimensionless), we require\n$$\n|A_2| + \\Delta \\sum_{i=1}^{n_b} |g_i| \\leq T,\n$$\nwhich yields the maximum allowable jitter amplitude\n$$\n\\Delta^\\star =\n\\begin{cases}\n\\frac{T - |A_2|}{\\sum_{i=1}^{n_b} |g_i|}, & \\text{if } \\sum_{i=1}^{n_b} |g_i| > 0 \\text{ and } T \\geq |A_2|, \\\\\n+\\infty, & \\text{if } \\sum_{i=1}^{n_b} |g_i| = 0 \\text{ and } T \\geq |A_2|, \\\\\n0, & \\text{if } T < |A_2|.\n\\end{cases}\n$$\nYou must compute $\\Delta^\\star$ using the above definitions for each test case. Angles must be expressed in radians. The final program output must be a single line containing the list of results as floats in radians.\n\nThe Gauss-Legendre quadrature abscissas and weights for order $4$ are provided and must be used for all test cases:\n- Abscissas $\\mu_j$ for $j \\in \\{1,2,3,4\\}$:\n  - $\\mu_1 = -0.8611363116$, $\\mu_2 = -0.3399810436$, $\\mu_3 = 0.3399810436$, $\\mu_4 = 0.8611363116$.\n- Weights $w_j$ for $j \\in \\{1,2,3,4\\}$:\n  - $w_1 = 0.3478548451$, $w_2 = 0.6521451549$, $w_3 = 0.6521451549$, $w_4 = 0.3478548451$.\n\nYour program must implement the following test suite and produce results in radians:\n\n- Test Case $1$ (general case with nonzero sensitivity):\n  - Number of beams $n_b = 4$, number of patches $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 0.9 \\times 10^{12}, 1.1 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.020, 0.024, 0.026, 0.023]$,\n    - Row $2$: $[0.019, 0.023, 0.025, 0.022]$,\n    - Row $3$: $[0.021, 0.025, 0.027, 0.024]$,\n    - Row $4$: $[0.020, 0.024, 0.026, 0.023]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$):\n    - Row $1$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $2$: $[0.0009, 0.0011, 0.0012, 0.0010]$,\n    - Row $3$: $[0.0011, 0.0013, 0.0014, 0.0012]$,\n    - Row $4$: $[0.0010, 0.0012, 0.0013, 0.0011]$.\n  - Tolerance $T = 0.01$ (dimensionless).\n\n- Test Case $2$ (edge case with zero sensitivity):\n  - $n_b = 4$, $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.020, 0.020, 0.020, 0.020]$,\n    - Row $2$: $[0.020, 0.020, 0.020, 0.020]$,\n    - Row $3$: $[0.020, 0.020, 0.020, 0.020]$,\n    - Row $4$: $[0.020, 0.020, 0.020, 0.020]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$) is the zero matrix:\n    - Row $1$: $[0.0, 0.0, 0.0, 0.0]$,\n    - Row $2$: $[0.0, 0.0, 0.0, 0.0]$,\n    - Row $3$: $[0.0, 0.0, 0.0, 0.0]$,\n    - Row $4$: $[0.0, 0.0, 0.0, 0.0]$.\n  - Tolerance $T = 0.1$ (dimensionless).\n\n- Test Case $3$ (edge case where tolerance is smaller than the nominal $P_2$, resulting in zero allowable jitter):\n  - $n_b = 4$, $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.010, 0.060, 0.060, 0.010]$,\n    - Row $2$: $[0.010, 0.060, 0.060, 0.010]$,\n    - Row $3$: $[0.010, 0.060, 0.060, 0.010]$,\n    - Row $4$: $[0.010, 0.060, 0.060, 0.010]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$):\n    - Row $1$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $2$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $3$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $4$: $[0.0010, 0.0012, 0.0013, 0.0011]$.\n  - Tolerance $T = 0.001$ (dimensionless).\n\n- Test Case $4$ (boundary case where tolerance equals the nominal $P_2$):\n  - $n_b = 4$, $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.050, 0.010, 0.010, 0.050]$,\n    - Row $2$: $[0.050, 0.010, 0.010, 0.050]$,\n    - Row $3$: $[0.050, 0.010, 0.010, 0.050],\n    - Row $4$: $[0.050, 0.010, 0.010, 0.050]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$):\n    - Row $1$: $[0.0005, 0.0005, 0.0005, 0.0005]$,\n    - Row $2$: $[0.0005, 0.0005, 0.0005, 0.0005]$,\n    - Row $3$: $[0.0005, 0.0005, 0.0005, 0.0005]$,\n    - Row $4$: $[0.0005, 0.0005, 0.0005, 0.0005]$.\n  - Tolerance $T$ must be set equal to the nominal $P_2$ computed from the above parameters (i.e., $T = |A_2|$ for Test Case $4$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_k$ is the computed $\\Delta^\\star$ in radians for Test Case $k$ as a floating-point number. No additional text should be printed. All angle quantities must be in radians, and all $P_2$-related values are dimensionless. The result type for each test case must be a float, with the special case of $+\\infty$ printed as $inf$ where applicable.",
            "solution": "The problem as stated is scientifically sound, mathematically well-posed, and provides all necessary information for a unique solution. The underlying model is a standard, albeit simplified, representation of drive asymmetry analysis in inertial confinement fusion, based on established principles of radiative transfer, spherical harmonics, and linear sensitivity analysis. All data provided for the test cases are numerically and dimensionally consistent. Therefore, a full solution is warranted.\n\nThe central task is to compute the maximum allowable angular jitter amplitude, denoted $\\Delta^\\star$, for a set of laser beams in a hohlraum, such that the resulting drive asymmetry on the fusion capsule remains within a specified tolerance. The drive asymmetry is quantified by the second Legendre moment, $A_2$.\n\nThe derivation proceeds in three main stages: first, calculating the nominal (unperturbed) drive asymmetry, $A_2$; second, determining the sensitivity of this asymmetry to small pointing errors in each beam; and third, using this sensitivity to establish the maximum permissible jitter.\n\nWe begin by defining the quantities and their mathematical representations.\nThe system consists of $n_b$ laser beams and $n_p$ capsule surface patches. The capsule patches are located at polar angles $\\theta_j$ corresponding to the abscissas $\\mu_j = \\cos(\\theta_j)$ of a Gauss-Legendre quadrature scheme of order $n_p$. The associated quadrature weights are $w_j$. For this problem, $n_p=4$, and the abscissas and weights are provided. The second Legendre polynomial is given by $P_2(\\mu) = \\frac{3\\mu^2 - 1}{2}$.\n\nThe nominal radiative flux absorbed at patch $j$ is given by the sum of contributions from all beams:\n$$\nq_j = \\sum_{i=1}^{n_b} P_i V_{ij}\n$$\nwhere $P_i$ is the power of beam $i$ and $V_{ij}$ is the dimensionless viewfactor from beam $i$ to patch $j$. In matrix-vector notation, if we define $\\mathbf{P}$ as a column vector of beam powers (shape $n_b \\times 1$) and $\\mathbf{q}$ as a column vector of patch fluxes (shape $n_p \\times 1$), and $\\mathbf{V}$ as the viewfactor matrix of shape ($n_b \\times n_p$), this can be written as $\\mathbf{q} = \\mathbf{V}^T \\mathbf{P}$.\n\nThe nominal $P_2$ drive asymmetry, $A_2$, is the normalized second Legendre moment of the flux distribution:\n$$\nA_2 = \\frac{\\sum_{j=1}^{n_p} q_j P_2(\\mu_j) w_j}{\\sum_{j=1}^{n_p} q_j w_j}\n$$\nLet us define the numerator as $N = \\sum_{j=1}^{n_p} q_j P_2(\\mu_j) w_j$ and the denominator as $D = \\sum_{j=1}^{n_p} q_j w_j$. So, $A_2 = N/D$. The denominator $D$ represents the total weighted flux, proportional to the total energy absorbed by the capsule.\n\nThe next step is to find the sensitivity of $A_2$ to a small change in the pointing angle $\\alpha_i$ of beam $i$. This sensitivity is $g_i = \\frac{\\partial A_2}{\\partial \\alpha_i}$. We apply the quotient rule for differentiation:\n$$\ng_i = \\frac{\\partial A_2}{\\partial \\alpha_i} = \\frac{1}{D^2} \\left[ \\frac{\\partial N}{\\partial \\alpha_i} D - N \\frac{\\partial D}{\\partial \\alpha_i} \\right]\n$$\nThe partial derivatives of $N$ and $D$ with respect to $\\alpha_i$ are required. These depend on the change in flux $q_j$ with respect to $\\alpha_i$. From the problem statement, the change in viewfactor is $S_{ij} = \\frac{\\partial V_{ij}}{\\partial \\alpha_i}$. Thus, the change in flux is:\n$$\n\\frac{\\partial q_j}{\\partial \\alpha_i} = \\frac{\\partial}{\\partial \\alpha_i} \\left( \\sum_{k=1}^{n_b} P_k V_{kj} \\right) = P_i S_{ij}\n$$\nNow, we can compute the derivatives of $N$ and $D$:\n$$\n\\frac{\\partial N}{\\partial \\alpha_i} = \\sum_{j=1}^{n_p} \\frac{\\partial q_j}{\\partial \\alpha_i} P_2(\\mu_j) w_j = \\sum_{j=1}^{n_p} (P_i S_{ij}) P_2(\\mu_j) w_j = P_i \\sum_{j=1}^{n_p} S_{ij} P_2(\\mu_j) w_j\n$$\n$$\n\\frac{\\partial D}{\\partial \\alpha_i} = \\sum_{j=1}^{n_p} \\frac{\\partial q_j}{\\partial \\alpha_i} w_j = \\sum_{j=1}^{n_p} (P_i S_{ij}) w_j = P_i \\sum_{j=1}^{n_p} S_{ij} w_j\n$$\nSubstituting these back into the expression for $g_i$ and dividing by $D$ yields a more elegant form:\n$$\ng_i = \\frac{1}{D} \\frac{\\partial N}{\\partial \\alpha_i} - \\frac{N}{D^2} \\frac{\\partial D}{\\partial \\alpha_i} = \\frac{P_i}{D} \\sum_{j=1}^{n_p} S_{ij} P_2(\\mu_j) w_j - \\frac{A_2}{D} \\left( P_i \\sum_{j=1}^{n_p} S_{ij} w_j \\right)\n$$\nFactoring out common terms, we arrive at the final expression for the sensitivity of beam $i$:\n$$\ng_i = \\frac{P_i}{D} \\left( \\sum_{j=1}^{n_p} S_{ij} P_2(\\mu_j) w_j - A_2 \\sum_{j=1}^{n_p} S_{ij} w_j \\right)\n$$\nThis calculation must be performed for each beam $i \\in \\{1, \\dots, n_b\\}$.\n\nThe problem imposes a worst-case jitter scenario, where the pointing error of each beam, $\\delta \\alpha_i$, is bounded by $|\\delta \\alpha_i| \\leq \\Delta$. The total change in asymmetry, $\\delta A_2$, is approximated to first order as $\\delta A_2 \\approx \\sum_{i=1}^{n_b} g_i \\delta \\alpha_i$. A conservative upper bound on the magnitude of this change is obtained via the triangle inequality:\n$$\n|\\delta A_2| \\leq \\sum_{i=1}^{n_b} |g_i| |\\delta \\alpha_i| \\leq \\Delta \\sum_{i=1}^{n_b} |g_i|\n$$\nThe final asymmetry is $A_2^{\\text{final}} = A_2 + \\delta A_2$. To ensure that the total asymmetry remains within a tolerance $T$, i.e., $|A_2^{\\text{final}}| \\leq T$, we impose a stricter condition on the upper bound:\n$$\n|A_2| + |\\delta A_2|_{\\text{max}} \\leq T \\implies |A_2| + \\Delta \\sum_{i=1}^{n_b} |g_i| \\leq T\n$$\nSolving for $\\Delta$ gives the allowable jitter amplitude. This leads to the piecewise definition for the maximum allowable jitter, $\\Delta^\\star$:\n$$\n\\Delta^\\star =\n\\begin{cases}\n\\frac{T - |A_2|}{\\sum_{i=1}^{n_b} |g_i|}, & \\text{if } \\sum_{i=1}^{n_b} |g_i| > 0 \\text{ and } T \\geq |A_2| \\\\\n+\\infty, & \\text{if } \\sum_{i=1}^{n_b} |g_i| = 0 \\text{ and } T \\geq |A_2| \\\\\n0, & \\text{if } T < |A_2|\n\\end{cases}\n$$\nThe case $\\Delta^\\star=0$ signifies that the nominal asymmetry $|A_2|$ already exceeds the tolerance $T$, so no jitter is permissible. The case $\\Delta^\\star=+\\infty$ signifies that the system is insensitive to pointing errors ($g_i=0$ for all $i$), and the nominal asymmetry is within tolerance, so theoretically any amount of jitter (within the linear approximation's validity) is allowed.\n\nTo implement the solution, the following algorithm is executed for each test case:\n$1$. Define the input parameters: vectors $\\mathbf{P}$, $\\boldsymbol{\\mu}$, $\\mathbf{w}$, and matrices $\\mathbf{V}$, $\\mathbf{S}$.\n$2$. Compute the vector of Legendre polynomial values $\\mathbf{P_2}$ where $(\\mathbf{P_2})_j = P_2(\\mu_j)$.\n$3$. Calculate the nominal flux vector $\\mathbf{q} = \\mathbf{V}^T \\mathbf{P}$.\n$4$. Calculate the sums $N = \\mathbf{q}^T (\\mathbf{P_2} \\odot \\mathbf{w})$ and $D = \\mathbf{q}^T \\mathbf{w}$, where $\\odot$ denotes element-wise multiplication.\n$5$. Compute the nominal asymmetry $A_2 = N/D$.\n$6$. For Test Case $4$, set the tolerance $T = |A_2|$.\n$7$. For each beam $i$, calculate the sensitivity $g_i$ using the derived formula. This can be vectorized.\n$8$. Compute the sum of the absolute values of the sensitivities, $\\Sigma_g = \\sum_{i=1}^{n_b} |g_i|$.\n$9$. Apply the piecewise formula to determine $\\Delta^\\star$ based on the values of $T$, $|A_2|$, and $\\Sigma_g$.\n$10$. The resulting $\\Delta^\\star$ is the final answer for the test case, in radians.\n\nThis procedure is systematically applied to all provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_jitter_limit(case_params):\n    \"\"\"\n    Calculates the allowable angular jitter for a single test case.\n\n    Args:\n        case_params (dict): A dictionary containing all parameters for the test case.\n                            Keys: 'P', 'V', 'S', 'T'.\n\n    Returns:\n        float: The maximum allowable jitter amplitude Delta* in radians.\n    \"\"\"\n    # Step 1: Extract givens and define constants\n    P = np.array(case_params['P'], dtype=float)\n    V = np.array(case_params['V'], dtype=float)\n    S = np.array(case_params['S'], dtype=float)\n    T = case_params['T'] # Can be a float or None\n\n    # Gauss-Legendre quadrature for order 4 (n_p = 4)\n    mu_j = np.array([-0.8611363116, -0.3399810436, 0.3399810436, 0.8611363116])\n    w_j = np.array([0.3478548451, 0.6521451549, 0.6521451549, 0.3478548451])\n    \n    # Step 2: Compute P2(mu_j)\n    # P_2(x) = (3*x^2 - 1) / 2\n    p2_of_mu = 0.5 * (3.0 * mu_j**2 - 1.0)\n    \n    # Step 3: Calculate nominal flux q_j\n    # q_j = sum_i(P_i * V_ij)\n    # This corresponds to V.T @ P in numpy, where V has shape (n_b, n_p)\n    # and P has shape (n_b,).\n    q_j = V.T @ P\n    \n    # Step 4: Calculate nominal asymmetry A_2\n    # A_2 = Numerator / Denominator\n    numerator_A2 = np.dot(q_j, p2_of_mu * w_j)\n    denominator_A2 = np.dot(q_j, w_j)\n    \n    # Handle the case of zero total flux, though physically unlikely with given data.\n    if np.isclose(denominator_A2, 0.0):\n        # If total flux is zero, q_j is all zero, so numerator is also zero.\n        # A_2 is 0/0, which is ill-defined. We define it as 0 in this context.\n        A_2 = 0.0\n    else:\n        A_2 = numerator_A2 / denominator_A2\n        \n    # Step 5: Handle Test Case 4's special tolerance\n    if T is None:\n        T = np.abs(A_2)\n\n    # Step 6: Calculate asymmetry sensitivities g_i\n    # g_i = (P_i / D) * ( sum_j(S_ij * P2_j * w_j) - A_2 * sum_j(S_ij * w_j) )\n    if np.isclose(denominator_A2, 0.0):\n        g_i = np.zeros_like(P)\n    else:\n        # Vectorized calculation for g_i\n        # sum_vec1 is sum_j(S_ij * p2_of_mu_j * w_j) for each i\n        sum_vec1 = S @ (p2_of_mu * w_j)\n        # sum_vec2 is sum_j(S_ij * w_j) for each i\n        sum_vec2 = S @ w_j\n        \n        g_i = (P / denominator_A2) * (sum_vec1 - A_2 * sum_vec2)\n        \n    # Step 7: Calculate sum of absolute sensitivities\n    sum_abs_g = np.sum(np.abs(g_i))\n    \n    # Step 8: Apply piecewise formula to calculate Delta*\n    abs_A2 = np.abs(A_2)\n    \n    # Check for T < |A_2| with a small tolerance for floating point comparisons\n    if T  abs_A2 and not np.isclose(T, abs_A2):\n        delta_star = 0.0\n    else:\n        if np.isclose(sum_abs_g, 0.0):\n            delta_star = np.inf\n        else:\n            delta_star = (T - abs_A2) / sum_abs_g\n\n    return delta_star\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1 (general case with nonzero sensitivity)\n        {\n            'P': [1.0e12, 0.9e12, 1.1e12, 1.0e12],\n            'V': [\n                [0.020, 0.024, 0.026, 0.023],\n                [0.019, 0.023, 0.025, 0.022],\n                [0.021, 0.025, 0.027, 0.024],\n                [0.020, 0.024, 0.026, 0.023]\n            ],\n            'S': [\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0009, 0.0011, 0.0012, 0.0010],\n                [0.0011, 0.0013, 0.0014, 0.0012],\n                [0.0010, 0.0012, 0.0013, 0.0011]\n            ],\n            'T': 0.01\n        },\n        # Test Case 2 (edge case with zero sensitivity)\n        {\n            'P': [1.0e12, 1.0e12, 1.0e12, 1.0e12],\n            'V': [\n                [0.020, 0.020, 0.020, 0.020],\n                [0.020, 0.020, 0.020, 0.020],\n                [0.020, 0.020, 0.020, 0.020],\n                [0.020, 0.020, 0.020, 0.020]\n            ],\n            'S': [\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0]\n            ],\n            'T': 0.1\n        },\n        # Test Case 3 (edge case with T  |A_2|)\n        {\n            'P': [1.0e12, 1.0e12, 1.0e12, 1.0e12],\n            'V': [\n                [0.010, 0.060, 0.060, 0.010],\n                [0.010, 0.060, 0.060, 0.010],\n                [0.010, 0.060, 0.060, 0.010],\n                [0.010, 0.060, 0.060, 0.010]\n            ],\n            'S': [\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0010, 0.0012, 0.0013, 0.0011]\n            ],\n            'T': 0.001\n        },\n        # Test Case 4 (boundary case with T = |A_2|)\n        {\n            'P': [1.0e12, 1.0e12, 1.0e12, 1.0e12],\n            'V': [\n                [0.050, 0.010, 0.010, 0.050],\n                [0.050, 0.010, 0.010, 0.050],\n                [0.050, 0.010, 0.010, 0.050],\n                [0.050, 0.010, 0.010, 0.050]\n            ],\n            'S': [\n                [0.0005, 0.0005, 0.0005, 0.0005],\n                [0.0005, 0.0005, 0.0005, 0.0005],\n                [0.0005, 0.0005, 0.0005, 0.0005],\n                [0.0005, 0.0005, 0.0005, 0.0005]\n            ],\n            'T': None # Placeholder to signify T = |A_2|\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_jitter_limit(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice synthesizes the concepts of energy balance and symmetry into a comprehensive design problem. You will construct a parametric model that links hohlraum geometry to the time-dependent x-ray drive on the capsule, accounting for laser pulse shapes and wall re-emission . The goal is to employ numerical optimization to find the ideal hohlraum shape that actively minimizes high-order drive asymmetry ($P_4$), mirroring the sophisticated computational design loops used in modern ICF research.",
            "id": "3991133",
            "problem": "Consider an axisymmetric \"rugby\" hohlraum surrounding a centrally located spherical capsule. The hohlraum geometry is approximated by a prolate spheroid with total length $L$ and equatorial inner diameter $D$, with length-to-diameter ratio $r = L/D$. Laser beams enter through the Laser Entrance Hole (LEH) at each end and are grouped into three cone sets with fixed polar angles relative to the hohlraum axis. The capsule flux asymmetry is quantified by the Legendre mode amplitude $P_4$, defined as the normalized coefficient of the fourth-order Legendre polynomial in the axisymmetric spatial drive at the capsule. The task is to determine the value of $r$ that minimizes the peak (in time) of $P_4$ for a fixed set of cone angles and LEH sizes using a parametric viewfactor model grounded in energy balance.\n\nStarting point and fundamental base:\n- Radiative energy balance and viewfactor approximation: the time-dependent mean x-ray flux incident on the capsule is proportional to the hohlraum wall reemission fraction and to the sum of laser intensities weighted by geometric viewfactors.\n- Axisymmetric spherical harmonic decomposition uses Legendre polynomials $P_\\ell(\\cos\\theta)$; the $\\ell=4$ component of the flux spatial distribution on the capsule is proportional to $P_4(\\cos\\theta)$ contributions from emitting regions.\n\nParametric geometric model:\n- The inner wall is modeled as a prolate spheroid. For axial coordinate $z \\in [0,L/2]$ (one endcap), the local inner-wall radius is\n$$\nr_w(z) = \\frac{D}{2}\\sqrt{1 - \\left(\\frac{z}{L/2}\\right)^2}.\n$$\n- Each cone with polar angle $\\beta_j$ (measured in degrees in the input; use radians in computation) deposits energy predominantly near an axial location on the inner wall given by\n$$\nz_j(r) = \\max\\left(0, \\min\\left(\\frac{L}{2}, \\frac{L}{2} - \\frac{D}{2}\\cot\\beta_j\\right)\\right).\n$$\n- The point on the inner wall at $(z_j, r_w(z_j))$ as seen from the capsule center subtends polar angle $\\theta_j$ relative to the hohlraum axis. Its cosine is\n$$\n\\cos\\theta_j = \\frac{z_j}{\\sqrt{z_j^2 + r_w(z_j)^2}}.\n$$\n- The Legendre polynomial of order $4$ is\n$$\nP_4(x) = \\frac{1}{8}\\left(35x^4 - 30x^2 + 3\\right).\n$$\n- The geometric viewfactor-like weight for cone $j$ is modeled as\n$$\nv_j(r) = \\frac{S_j(r)}{\\left(z_j^2 + r_w(z_j)^2\\right)},\n$$\nwhere the LEH loss factor is\n$$\nS_j(r) = 1 - \\exp\\left(-\\left(\\frac{\\frac{L}{2} - z_j}{a_{\\mathrm{LEH}}}\\right)^2\\right),\n$$\nand $a_{\\mathrm{LEH}}$ is the LEH radius.\n\nEnergy balance and time dependence:\n- Let $I_j(t_k)$ be the dimensionless laser intensity for cone $j$ at discrete times $t_k$, and let the wall albedo be modeled as\n$$\n\\alpha(t_k) = \\alpha_0 + (\\alpha_1 - \\alpha_0)\\frac{t_k}{t_{\\mathrm{end}}},\n$$\nwith $t_{\\mathrm{end}}$ the final time point.\n- The mean (zeroth-order) drive at the capsule is proportional to\n$$\nF_0(t_k; r) = \\alpha(t_k)\\sum_j I_j(t_k) v_j(r).\n$$\n- The fourth-order Legendre component numerator is modeled as\n$$\nF_4(t_k; r) = \\sum_j I_j(t_k) v_j(r) P_4\\left(\\cos\\theta_j(r)\\right).\n$$\n- The normalized $P_4$ amplitude at time $t_k$ is\n$$\nP_4^{\\mathrm{norm}}(t_k; r) = \\frac{\\left|F_4(t_k; r)\\right|}{F_0(t_k; r)}.\n$$\n- The peak $P_4$ for a given $r$ is\n$$\nP_{4,\\mathrm{peak}}(r) = \\max_k P_4^{\\mathrm{norm}}(t_k; r).\n$$\n\nOptimization goal:\n- Find $r^\\star \\in [r_{\\min}, r_{\\max}]$ that minimizes $P_{4,\\mathrm{peak}}(r)$:\n$$\nr^\\star = \\arg\\min_{r \\in [r_{\\min}, r_{\\max}]} P_{4,\\mathrm{peak}}(r).\n$$\n\nImplementation requirements:\n- Angles $\\beta_j$ are provided in degrees; convert to radians before using trigonometric functions.\n- All quantities are dimensionless in this problem; no physical units are required.\n- Use the formulas above to compute $P_{4,\\mathrm{peak}}(r)$ and then optimize $r$ in the prescribed bounds for each test case.\n\nTest suite:\nFor all test cases, use $D = 1.0$, $r_{\\min} = 2.8$, $r_{\\max} = 4.2$, cone angles in degrees $\\beta = [23.5, 30.0, 44.5]$, discrete times $t = [0.0, 0.6, 1.2, 1.8]$, and $t_{\\mathrm{end}} = 1.8$.\n\n- Test case $1$ (happy path):\n  - $a_{\\mathrm{LEH}} = 0.25$.\n  - Intensities per cone at times $t$: inner $[0.6, 0.8, 0.7, 0.5]$, middle $[0.5, 0.9, 0.9, 0.6]$, outer $[0.4, 0.7, 1.0, 1.0]$.\n  - Albedo parameters: $\\alpha_0 = 0.70$, $\\alpha_1 = 0.85$.\n- Test case $2$ (boundary with large LEH):\n  - $a_{\\mathrm{LEH}} = 0.45$.\n  - Intensities per cone at times $t$: inner $[0.6, 0.8, 0.7, 0.5]$, middle $[0.5, 0.9, 0.9, 0.6]$, outer $[0.4, 0.7, 1.0, 1.0]$.\n  - Albedo parameters: $\\alpha_0 = 0.68$, $\\alpha_1 = 0.82$.\n- Test case $3$ (edge case with inner-cone-dominated early drive):\n  - $a_{\\mathrm{LEH}} = 0.15$.\n  - Intensities per cone at times $t$: inner $[1.2, 1.0, 0.6, 0.4]$, middle $[0.3, 0.5, 0.8, 0.9]$, outer $[0.2, 0.5, 0.9, 1.1]$.\n  - Albedo parameters: $\\alpha_0 = 0.72$, $\\alpha_1 = 0.88$.\n\nOutput specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result must be a two-element list $[r^\\star, P_{4,\\mathrm{peak}}(r^\\star)]$ for the corresponding test case, with both values as floats. For example, the output format should be like $[[r_1, p_1],[r_2, p_2],[r_3, p_3]]$.",
            "solution": "The problem presented is a well-posed optimization task grounded in a parametric model of inertial confinement fusion (ICF) hohlraum physics. It is scientifically consistent within its simplified framework, provides all necessary data and equations, and is mathematically formalizable. Therefore, the problem is deemed valid.\n\nThe objective is to find the optimal hohlraum length-to-diameter ratio, denoted as $r = L/D$, that minimizes the peak time-dependent drive asymmetry on a fusion capsule. The asymmetry is quantified by the normalized amplitude of the fourth-order Legendre polynomial, $P_4$. The analysis is performed over a specified range of $r \\in [r_{\\min}, r_{\\max}]$.\n\nThe solution is architected as a numerical optimization procedure. The core of this procedure is an objective function, $P_{4,\\mathrm{peak}}(r)$, which must be minimized. This function represents the maximum (peak) value of the normalized $P_4$ asymmetry observed over a series of discrete time points, for a given geometry ratio $r$.\n\nThe algorithmic design proceeds as follows:\n\n1.  **Geometric Factor Calculation**: For any given ratio $r=L/D$, a set of time-independent geometric quantities are calculated for each of the $j$ laser cones.\n    *   The hohlraum length is $L = r \\cdot D$.\n    *   The polar angles $\\beta_j$ (given in degrees) are converted to radians for use in trigonometric functions.\n    *   The axial position $z_j$ where the $j$-th cone deposits its energy is determined by the geometric relation:\n        $$\n        z_j(r) = \\frac{D}{2}(r - \\cot\\beta_j)\n        $$\n        This simplified form is valid for the provided parameter space, ensuring $z_j \\in [0, L/2]$.\n    *   The corresponding inner-wall radius $r_w(z_j)$ at this axial position is found using the prolate spheroid equation:\n        $$\n        r_w(z_j) = \\frac{D}{2}\\sqrt{1 - \\left(\\frac{z_j}{L/2}\\right)^2}\n        $$\n    *   The cosine of the polar angle $\\theta_j$ of the deposition spot, as viewed from the capsule at the origin, is given by:\n        $$\n        \\cos\\theta_j(r) = \\frac{z_j}{\\sqrt{z_j^2 + r_w(z_j)^2}}\n        $$\n    *   The geometric viewfactor-like weight $v_j(r)$ for each cone incorporates the solid angle subtended by the deposition spot and a loss factor $S_j(r)$ accounting for x-rays escaping through the laser entrance holes (LEHs):\n        $$\n        v_j(r) = \\frac{S_j(r)}{z_j^2 + r_w(z_j)^2} \\quad \\text{where} \\quad S_j(r) = 1 - \\exp\\left(-\\left(\\frac{L/2 - z_j}{a_{\\mathrm{LEH}}}\\right)^2\\right)\n        $$\n    These quantities ($z_j$, $r_w(z_j)$, $\\cos\\theta_j$, and $v_j$) depend only on the geometry ratio $r$ and are computed once for each evaluation of the objective function.\n\n2.  **Time-Dependent Asymmetry Calculation**: With the geometric factors established, the algorithm iterates through a set of discrete time points $t_k$ to compute the normalized $P_4$ asymmetry at each instant.\n    *   The time-varying wall albedo (re-emission efficiency), $\\alpha(t_k)$, is calculated using the provided linear model:\n        $$\n        \\alpha(t_k) = \\alpha_0 + (\\alpha_1 - \\alpha_0)\\frac{t_k}{t_{\\mathrm{end}}}\n        $$\n    *   The laser intensities $I_j(t_k)$ for each cone $j$ at time $t_k$ are given as input.\n    *   The zeroth-order ($F_0$) and fourth-order ($F_4$) components of the x-ray drive are calculated. $F_0$ represents the total flux incident on the capsule, while $F_4$ represents the numerator of the $P_4(\\cos\\theta)$ component of that flux.\n        $$\n        F_0(t_k; r) = \\alpha(t_k)\\sum_j I_j(t_k) v_j(r)\n        $$\n        $$\n        F_4(t_k; r) = \\sum_j I_j(t_k) v_j(r) P_4\\left(\\cos\\theta_j(r)\\right)\n        $$\n    *   The value of the fourth Legendre polynomial, $P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$, is evaluated using the pre-calculated $\\cos\\theta_j(r)$ values.\n    *   The normalized $P_4$ amplitude at time $t_k$ is the ratio of the absolute value of the fourth-order component to the zeroth-order flux:\n        $$\n        P_4^{\\mathrm{norm}}(t_k; r) = \\frac{\\left|F_4(t_k; r)\\right|}{F_0(t_k; r)}\n        $$\n\n3.  **Objective Function Evaluation**: The objective function, $P_{4,\\mathrm{peak}}(r)$, is the maximum value of $P_4^{\\mathrm{norm}}(t_k; r)$ across all time steps for a fixed $r$:\n    $$\n    P_{4,\\mathrm{peak}}(r) = \\max_k P_4^{\\mathrm{norm}}(t_k; r)\n    $$\n\n4.  **Numerical Optimization**: The final step is to find the optimal ratio $r^\\star$ that minimizes the objective function within the specified bounds $[r_{\\min}, r_{\\max}]$.\n    $$\n    r^\\star = \\arg\\min_{r \\in [r_{\\min}, r_{\\max}]} P_{4,\\mathrm{peak}}(r)\n    $$\n    This is a one-dimensional, bounded minimization problem. We employ a robust numerical solver, specifically `scipy.optimize.minimize_scalar` with the 'bounded' method, to efficiently find the minimum of the continuous function $P_{4,\\mathrm{peak}}(r)$.\n\nThis entire procedure is applied to each of the three test cases provided, using their respective parameters for LEH radius $a_{\\mathrm{LEH}}$, laser intensities $I_j(t_k)$, and albedo coefficients $\\alpha_0$ and $\\alpha_1$. The final output for each case consists of the optimal ratio $r^\\star$ and the corresponding minimum peak asymmetry $P_{4,\\mathrm{peak}}(r^\\star)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the optimal hohlraum aspect ratio to minimize P4 asymmetry\n    for a set of test cases.\n    \"\"\"\n    \n    # Common parameters for all test cases\n    D = 1.0\n    r_min = 2.8\n    r_max = 4.2\n    betas_deg = np.array([23.5, 30.0, 44.5])\n    times = np.array([0.0, 0.6, 1.2, 1.8])\n    t_end = 1.8\n\n    # Test suite data\n    test_cases = [\n        {\n            \"a_LEH\": 0.25,\n            \"intensities\": np.array([\n                [0.6, 0.8, 0.7, 0.5], # Inner cone\n                [0.5, 0.9, 0.9, 0.6], # Middle cone\n                [0.4, 0.7, 1.0, 1.0]  # Outer cone\n            ]),\n            \"alpha_0\": 0.70,\n            \"alpha_1\": 0.85,\n        },\n        {\n            \"a_LEH\": 0.45,\n            \"intensities\": np.array([\n                [0.6, 0.8, 0.7, 0.5],\n                [0.5, 0.9, 0.9, 0.6],\n                [0.4, 0.7, 1.0, 1.0]\n            ]),\n            \"alpha_0\": 0.68,\n            \"alpha_1\": 0.82,\n        },\n        {\n            \"a_LEH\": 0.15,\n            \"intensities\": np.array([\n                [1.2, 1.0, 0.6, 0.4],\n                [0.3, 0.5, 0.8, 0.9],\n                [0.2, 0.5, 0.9, 1.1]\n            ]),\n            \"alpha_0\": 0.72,\n            \"alpha_1\": 0.88,\n        },\n    ]\n\n    def p4_poly(x):\n        \"\"\"Computes the fourth-order Legendre polynomial P_4(x).\"\"\"\n        return (1/8) * (35 * x**4 - 30 * x**2 + 3)\n\n    def p_4_peak_of_r(r, params, betas_deg, times, t_end, D):\n        \"\"\"\n        Calculates the objective function P_{4,peak}(r) for a given r.\n        This is the function to be minimized.\n        \"\"\"\n        # Unpack case-specific parameters\n        a_LEH = params[\"a_LEH\"]\n        intensities = params[\"intensities\"]\n        alpha_0 = params[\"alpha_0\"]\n        alpha_1 = params[\"alpha_1\"]\n\n        # --- 1. Geometric Factor Calculation (time-independent) ---\n        L = r * D\n        L_half = L / 2.0\n        \n        betas_rad = np.deg2rad(betas_deg)\n        cot_betas = 1.0 / np.tan(betas_rad)\n\n        z_j = (D / 2.0) * (r - cot_betas)\n        \n        # Defensive check to prevent math domain error if z_j = L_half\n        # Although problem analysis shows this won't happen for the given parameters.\n        ratio_z_Lh = z_j / L_half\n        if np.any(ratio_z_Lh >= 1.0):\n            return np.inf\n\n        r_w_z_j = (D / 2.0) * np.sqrt(1.0 - ratio_z_Lh**2)\n        \n        dist_sq = z_j**2 + r_w_z_j**2\n        cos_theta_j = z_j / np.sqrt(dist_sq)\n\n        p4_vals = p4_poly(cos_theta_j)\n        \n        S_j = 1.0 - np.exp(-((L_half - z_j) / a_LEH)**2)\n        v_j = S_j / dist_sq\n\n        # --- 2. Time-Dependent Asymmetry Calculation ---\n        p4_norm_over_time = []\n        for k, t_k in enumerate(times):\n            alpha_k = alpha_0 + (alpha_1 - alpha_0) * (t_k / t_end)\n            I_k = intensities[:, k]\n\n            sum_I_v = np.sum(I_k * v_j)\n            \n            F_0_k = alpha_k * sum_I_v\n            F_4_k = np.sum(I_k * v_j * p4_vals)\n\n            if F_0_k == 0:\n                p4_norm_k = 0.0\n            else:\n                p4_norm_k = np.abs(F_4_k) / F_0_k\n            \n            p4_norm_over_time.append(p4_norm_k)\n\n        # --- 3. Objective Function Evaluation ---\n        return np.max(p4_norm_over_time)\n\n    results = []\n    for case_params in test_cases:\n        # --- 4. Numerical Optimization ---\n        opt_result = minimize_scalar(\n            p_4_peak_of_r,\n            bounds=(r_min, r_max),\n            method='bounded',\n            args=(case_params, betas_deg, times, t_end, D)\n        )\n        \n        r_star = opt_result.x\n        p4_min_peak = opt_result.fun\n        results.append([r_star, p4_min_peak])\n\n    # Format output string exactly as specified, avoiding extra spaces\n    str_results = []\n    for res_pair in results:\n        str_results.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    final_output_str = f\"[{','.join(str_results)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}