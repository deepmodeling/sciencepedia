{
    "hands_on_practices": [
        {
            "introduction": "Understanding the energy balance in a hohlraum begins with the interaction between the laser energy and the hohlraum wall. This exercise applies the fundamental principle of energy conservation to estimate the time required to heat the wall to plasma-emitting temperatures. By using a simplified lumped-parameter thermal model, you will practice connecting basic thermal physics with the high-energy-density parameters relevant to inertial confinement fusion, providing a crucial first estimate for the initial phase of the laser pulse .",
            "id": "3991144",
            "problem": "A cylindrical hohlraum is used to convert laser energy to x-rays for indirect-drive inertial confinement fusion. The inner wall is made of high-atomic-number metal and is modeled as a lumped thermal capacity over the wall thickness. Consider a hohlraum with inner radius $R$, axial length $L$, and two Laser Entrance Holes (LEHs) of radius $r_{\\mathrm{LEH}}$ on the endcaps. The wall has uniform thickness $t$, mass density $\\rho$, and constant (effective) specific heat $c_p$ over the relevant temperature range. The net fraction of incident laser power absorbed into the wall (after laser to x-ray conversion and any reradiation losses) is $\\eta_{\\mathrm{abs}}$, and the laser delivers constant power $P_L$ during the time of interest.\n\nStarting from conservation of energy and the definition of thermal capacity, derive a closed-form expression for the wall heating time $t_h$ required to raise the wall temperature by $\\Delta T$ under uniform energy deposition over the inner surface area. Use the cylindrical geometry to construct the inner wall area as the sum of the inner cylindrical surface and the two endcaps, subtracting the two LEHs:\n$$\nA_w \\;=\\; 2\\pi R L \\;+\\; 2\\pi R^2 \\;-\\; 2\\pi r_{\\mathrm{LEH}}^2.\n$$\nDefine the areal mass as $m_a=\\rho\\,t$ and model the energy required for the temperature rise by the lumped capacity relation $E_{\\mathrm{req}} \\approx A_w\\,m_a\\,c_p\\,\\Delta T$. Relate $E_{\\mathrm{req}}$ to the absorbed laser energy $\\eta_{\\mathrm{abs}} P_L t_h$ and solve for $t_h$.\n\nCompute the numerical value of $t_h$ for the following parameters, and use the specified units and precision:\n- $R = 2.00 \\times 10^{-3}$ m, $L = 9.00 \\times 10^{-3}$ m, $r_{\\mathrm{LEH}} = 1.00 \\times 10^{-3}$ m,\n- $t = 1.50 \\times 10^{-4}$ m, $\\rho = 1.93 \\times 10^{4}$ kg/m$^3$, $c_p = 1.29 \\times 10^{2}$ J/kg/K,\n- $\\Delta T = 3.00 \\times 10^{3}$ K, $\\eta_{\\mathrm{abs}} = 0.75$, $P_L = 1.00 \\times 10^{11}$ W.\n\nExpress the final heating time in nanoseconds (ns). Round your answer to three significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed. The givens are:\n- Inner radius: $R = 2.00 \\times 10^{-3}$ m\n- Axial length: $L = 9.00 \\times 10^{-3}$ m\n- Laser Entrance Hole (LEH) radius: $r_{\\mathrm{LEH}} = 1.00 \\times 10^{-3}$ m\n- Wall thickness: $t = 1.50 \\times 10^{-4}$ m\n- Mass density: $\\rho = 1.93 \\times 10^{4}$ kg/m$^3$\n- Specific heat: $c_p = 1.29 \\times 10^{2}$ J/kg/K\n- Wall temperature rise: $\\Delta T = 3.00 \\times 10^{3}$ K\n- Net fraction of absorbed laser power: $\\eta_{\\mathrm{abs}} = 0.75$\n- Laser power: $P_L = 1.00 \\times 10^{11}$ W\n- Inner wall area: $A_w = 2\\pi R L + 2\\pi R^2 - 2\\pi r_{\\mathrm{LEH}}^2$\n- Areal mass: $m_a = \\rho t$\n- Required energy for temperature rise: $E_{\\mathrm{req}} \\approx A_w m_a c_p \\Delta T$\n\nThe problem is based on the fundamental principle of energy conservation and uses a standard lumped-parameter model for thermal analysis, which is a valid simplification in this context. The parameters provided are physically realistic for indirect-drive inertial confinement fusion experiments. The problem is well-defined, with all necessary information provided and no contradictions. Therefore, the problem is deemed valid and a solution can be formulated.\n\nThe solution proceeds by applying the principle of conservation of energy. The total energy absorbed by the hohlraum wall, $E_{\\mathrm{abs}}$, over the heating time $t_h$ must equal the energy required to raise the wall temperature by $\\Delta T$, denoted as $E_{\\mathrm{req}}$.\n$$\nE_{\\mathrm{abs}} = E_{\\mathrm{req}}\n$$\nThe absorbed energy is the product of the constant absorbed power and the heating time. The absorbed power is the fraction $\\eta_{\\mathrm{abs}}$ of the incident laser power $P_L$.\n$$\nE_{\\mathrm{abs}} = (\\eta_{\\mathrm{abs}} P_L) t_h\n$$\nThe energy required to heat the wall is given by the lumped thermal capacity relation provided in the problem statement. The total mass of the wall to be heated is the product of the inner wall surface area $A_w$, the wall thickness $t$, and the mass density $\\rho$. The problem simplifies this by defining an areal mass $m_a = \\rho t$.\n$$\nE_{\\mathrm{req}} = A_w m_a c_p \\Delta T\n$$\nEquating the expressions for absorbed and required energy, we obtain:\n$$\n\\eta_{\\mathrm{abs}} P_L t_h = A_w m_a c_p \\Delta T\n$$\nSolving for the heating time $t_h$ gives the general symbolic expression:\n$$\nt_h = \\frac{A_w m_a c_p \\Delta T}{\\eta_{\\mathrm{abs}} P_L}\n$$\nNow, we substitute the given expressions for the wall area $A_w$ and the areal mass $m_a$:\n$$\nA_w = 2\\pi (RL + R^2 - r_{\\mathrm{LEH}}^2)\n$$\n$$\nm_a = \\rho t\n$$\nSubstituting these into the equation for $t_h$ yields the complete closed-form expression:\n$$\nt_h = \\frac{2\\pi (RL + R^2 - r_{\\mathrm{LEH}}^2) (\\rho t) c_p \\Delta T}{\\eta_{\\mathrm{abs}} P_L}\n$$\nThis completes the derivation part of the problem. The next step is to compute the numerical value of $t_h$ using the provided parameters.\n\nFirst, we calculate the terms in the numerator.\nThe inner wall area $A_w$:\n$$\nA_w = 2\\pi \\left( (2.00 \\times 10^{-3})(9.00 \\times 10^{-3}) + (2.00 \\times 10^{-3})^2 - (1.00 \\times 10^{-3})^2 \\right)\n$$\n$$\nA_w = 2\\pi \\left( 18.0 \\times 10^{-6} + 4.00 \\times 10^{-6} - 1.00 \\times 10^{-6} \\right) \\text{m}^2\n$$\n$$\nA_w = 2\\pi (21.0 \\times 10^{-6}) \\text{ m}^2 = 42.0\\pi \\times 10^{-6} \\text{ m}^2\n$$\nThe areal mass $m_a$:\n$$\nm_a = \\rho t = (1.93 \\times 10^{4} \\text{ kg/m}^3)(1.50 \\times 10^{-4} \\text{ m}) = 2.895 \\text{ kg/m}^2\n$$\nNow, we calculate the total required energy $E_{\\mathrm{req}}$:\n$$\nE_{\\mathrm{req}} = A_w m_a c_p \\Delta T\n$$\n$$\nE_{\\mathrm{req}} = (42.0\\pi \\times 10^{-6} \\text{ m}^2) (2.895 \\text{ kg/m}^2) (1.29 \\times 10^{2} \\text{ J/kg/K}) (3.00 \\times 10^{3} \\text{ K})\n$$\n$$\nE_{\\mathrm{req}} = (42.0 \\times 2.895 \\times 1.29 \\times 3.00) \\pi \\times 10^{-6+2+3} \\text{ J}\n$$\n$$\nE_{\\mathrm{req}} = 469.551 \\pi \\times 10^{-1} \\text{ J} \\approx 147.513 \\text{ J}\n$$\nNext, we calculate the absorbed power, $P_{\\mathrm{abs}}$:\n$$\nP_{\\mathrm{abs}} = \\eta_{\\mathrm{abs}} P_L = (0.75)(1.00 \\times 10^{11} \\text{ W}) = 0.75 \\times 10^{11} \\text{ W}\n$$\nFinally, we compute the heating time $t_h$ in seconds:\n$$\nt_h = \\frac{E_{\\mathrm{req}}}{P_{\\mathrm{abs}}} = \\frac{46.9551 \\pi \\text{ J}}{0.75 \\times 10^{11} \\text{ W}}\n$$\n$$\nt_h = \\frac{147.513...}{0.75 \\times 10^{11}} \\text{ s} \\approx 1.96684 \\times 10^{-9} \\text{ s}\n$$\nThe problem requires the final answer in nanoseconds (ns), where $1 \\text{ ns} = 10^{-9} \\text{ s}$.\n$$\nt_h \\approx 1.96684 \\text{ ns}\n$$\nRounding the result to three significant figures, we get:\n$$\nt_h \\approx 1.97 \\text{ ns}\n$$",
            "answer": "$$\\boxed{1.97}$$"
        },
        {
            "introduction": "After the initial wall heating, a bath of x-rays fills the hohlraum, and its temperature dictates the drive pressure on the fusion capsule. This practice models the dynamic evolution of this radiation temperature in response to a change in input laser power. By solving the zero-dimensional energy balance equation, you will derive the transient response of the system and understand the characteristic timescale for the hohlraum to reach a new thermal equilibrium, a key concept for designing time-dependent laser pulses (pulse shaping) .",
            "id": "3991152",
            "problem": "A hohlraum used for indirect-drive inertial confinement fusion is approximated as a cavity of volume $V$ containing an isotropic radiation field characterized by a radiation temperature $T_r(t)$. The internal radiation energy is $E_{\\mathrm{rad}}(t)=a\\,V\\,T_r(t)^{4}$, where $a$ is the radiation constant. The laser deposits absorbed power $P_{\\mathrm{abs}}(t)$ into the cavity, while net radiative leakage and coupling to apertures and the capsule are modeled as a linear loss of the internal radiation energy with coefficient $\\gamma>0$, so that the loss power is $P_{\\mathrm{leak}}(T_r)=\\gamma\\,a\\,V\\,T_r^{4}$. The radiative heat capacity is $C_{\\mathrm{rad}}(T_r)=4\\,a\\,V\\,T_r^{3}$. Assume spatial uniformity of the radiation field and negligible wall thermal inertia so that the zero-dimensional energy balance\n$$\\frac{d}{dt}\\big(a\\,V\\,T_r^{4}\\big)=P_{\\mathrm{abs}}(t)-\\gamma\\,a\\,V\\,T_r^{4}$$\nholds for all times.\n\nInitially, for $t<0$, the system is at a steady state with absorbed power $P_{0}$ and radiation temperature $T_{r,0}$ satisfying $P_{0}=\\gamma\\,a\\,V\\,T_{r,0}^{4}$. At $t=0$, the absorbed power undergoes a step to a new constant value $P_{1}>P_{0}$, which defines a new steady radiation temperature $T_{r,1}$ via $P_{1}=\\gamma\\,a\\,V\\,T_{r,1}^{4}$. Let $\\phi\\in(0,1)$ be a specified fraction of the new steady radiation temperature.\n\nStarting only from the conservation law above and the definition of $C_{\\mathrm{rad}}(T_r)$, derive the transient response $T_r(t)$ and compute the time $t_f$ at which the radiation temperature first reaches $T_r(t_f)=\\phi\\,T_{r,1}$. Express $t_f$ as a single closed-form analytic expression in terms of $\\phi$, $P_{0}$, $P_{1}$, $a$, $V$, and $\\gamma$. No numerical values are required; provide the final expression only. If any intermediate steady-state quantities are used, they must be eliminated in favor of the given parameters in the final expression. The answer does not require rounding.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard initial value problem for a first-order differential equation modeling a simplified physical system. All required data and conditions are provided, and there are no internal contradictions.\n\nThe analysis begins with the provided zero-dimensional energy balance equation, which governs the evolution of the radiation temperature $T_r(t)$:\n$$ \\frac{d}{dt}\\big(a\\,V\\,T_r(t)^{4}\\big) = P_{\\mathrm{abs}}(t)-\\gamma\\,a\\,V\\,T_r(t)^{4} $$\nHere, $a$ is the radiation constant, $V$ is the hohlraum volume, $P_{\\mathrm{abs}}(t)$ is the absorbed laser power, and $\\gamma$ is the radiative loss coefficient.\n\nFor times $t \\geq 0$, the absorbed power is constant at $P_{\\mathrm{abs}}(t) = P_{1}$. The equation becomes:\n$$ \\frac{d}{dt}\\big(a\\,V\\,T_r(t)^{4}\\big) = P_{1}-\\gamma\\,a\\,V\\,T_r(t)^{4} $$\nTo simplify this equation, we define the total internal radiation energy as $E(t) = a\\,V\\,T_r(t)^{4}$. Substituting this definition into the energy balance equation yields a linear first-order ordinary differential equation (ODE) for $E(t)$:\n$$ \\frac{dE}{dt} = P_{1} - \\gamma E(t) $$\nThis can be rewritten in the standard form:\n$$ \\frac{dE}{dt} + \\gamma E(t) = P_{1} $$\nThe initial condition for this ODE is determined by the steady state at $t < 0$. At $t=0$, the system is in equilibrium with an absorbed power of $P_{0}$ and a radiation temperature of $T_{r,0}$. The problem states this corresponds to the relation $P_{0} = \\gamma\\,a\\,V\\,T_{r,0}^{4}$. The initial energy at $t=0$ is therefore:\n$$ E(0) = a\\,V\\,T_r(0)^{4} = a\\,V\\,T_{r,0}^{4} = \\frac{P_{0}}{\\gamma} $$\nThe general solution to the ODE for $E(t)$ is the sum of a homogeneous solution $E_h(t)$ and a particular solution $E_p(t)$. The homogeneous equation is $\\frac{dE_h}{dt} + \\gamma E_h = 0$, which has the solution $E_h(t) = C\\exp(-\\gamma t)$ for some constant $C$. For the particular solution, since the forcing term $P_{1}$ is constant, we can assume a constant solution $E_p(t) = K$. Substituting into the ODE gives $0 + \\gamma K = P_{1}$, which yields $K = \\frac{P_{1}}{\\gamma}$.\nThe general solution for the energy is:\n$$ E(t) = C\\exp(-\\gamma t) + \\frac{P_{1}}{\\gamma} $$\nWe determine the constant $C$ using the initial condition $E(0) = P_{0}/\\gamma$:\n$$ E(0) = C\\exp(0) + \\frac{P_{1}}{\\gamma} = C + \\frac{P_{1}}{\\gamma} = \\frac{P_{0}}{\\gamma} $$\nSolving for $C$ gives $C = \\frac{P_{0} - P_{1}}{\\gamma}$.\nSubstituting $C$ back into the general solution, we obtain the transient response of the internal radiation energy for $t \\geq 0$:\n$$ E(t) = \\frac{P_{0} - P_{1}}{\\gamma}\\exp(-\\gamma t) + \\frac{P_{1}}{\\gamma} $$\nThis can be rearranged to:\n$$ E(t) = \\frac{P_{1}}{\\gamma} - \\frac{P_{1} - P_{0}}{\\gamma}\\exp(-\\gamma t) $$\nFrom the definition $E(t) = a\\,V\\,T_r(t)^{4}$, we can write the transient response for the fourth power of the radiation temperature:\n$$ T_r(t)^{4} = \\frac{E(t)}{aV} = \\frac{1}{aV\\gamma} \\left( P_{1} - (P_{1}-P_{0})\\exp(-\\gamma t) \\right) $$\nThe problem asks for the time $t_f$ at which the radiation temperature reaches a fraction $\\phi$ of its new steady-state value $T_{r,1}$. The target condition is $T_r(t_f) = \\phi T_{r,1}$. This is equivalent to:\n$$ T_r(t_f)^{4} = (\\phi T_{r,1})^{4} = \\phi^{4} T_{r,1}^{4} $$\nThe new steady-state temperature $T_{r,1}$ is defined by the relation $P_{1} = \\gamma\\,a\\,V\\,T_{r,1}^{4}$. Therefore, $T_{r,1}^{4} = \\frac{P_{1}}{\\gamma a V}$.\nSubstituting this into the target condition gives:\n$$ T_r(t_f)^{4} = \\phi^{4} \\frac{P_{1}}{\\gamma a V} $$\nNow, we set the expression for the transient temperature response at $t=t_f$ equal to this target value:\n$$ \\frac{1}{aV\\gamma} \\left( P_{1} - (P_{1}-P_{0})\\exp(-\\gamma t_f) \\right) = \\phi^{4} \\frac{P_{1}}{\\gamma a V} $$\nThe factor $\\frac{1}{aV\\gamma}$ cancels from both sides:\n$$ P_{1} - (P_{1}-P_{0})\\exp(-\\gamma t_f) = \\phi^{4}P_{1} $$\nWe now solve for $t_f$. Rearranging the terms to isolate the exponential:\n$$ (P_{1}-P_{0})\\exp(-\\gamma t_f) = P_{1} - \\phi^{4}P_{1} = P_{1}(1-\\phi^{4}) $$\n$$ \\exp(-\\gamma t_f) = \\frac{P_{1}(1-\\phi^{4})}{P_{1}-P_{0}} $$\nTaking the natural logarithm of both sides:\n$$ -\\gamma t_f = \\ln\\left( \\frac{P_{1}(1-\\phi^{4})}{P_{1}-P_{0}} \\right) $$\nFinally, solving for $t_f$:\n$$ t_f = -\\frac{1}{\\gamma} \\ln\\left( \\frac{P_{1}(1-\\phi^{4})}{P_{1}-P_{0}} \\right) = \\frac{1}{\\gamma} \\ln\\left( \\left[ \\frac{P_{1}(1-\\phi^{4})}{P_{1}-P_{0}} \\right]^{-1} \\right) $$\n$$ t_f = \\frac{1}{\\gamma} \\ln\\left( \\frac{P_{1}-P_{0}}{P_{1}(1-\\phi^{4})} \\right) $$\nThis expression for $t_f$ is in terms of the specified parameters $\\phi$, $P_{0}$, $P_{1}$, and $\\gamma$. The parameters $a$ and $V$ canceled during the derivation, so they do not appear in the final answer, which is permitted.\nFor a physically meaningful positive time $t_f>0$, the argument of the logarithm must be greater than $1$. This implies $P_{1}-P_{0} > P_{1}(1-\\phi^{4})$, which simplifies to $P_{0} < P_{1}\\phi^{4}$, or $T_{r,0} < \\phi T_{r,1}$. This means the initial temperature must be less than the target temperature, a condition implicitly assumed by the problem framing.",
            "answer": "$$\n\\boxed{\\frac{1}{\\gamma} \\ln\\left( \\frac{P_{1} - P_{0}}{P_{1}(1 - \\phi^{4})} \\right)}\n$$"
        },
        {
            "introduction": "Achieving a symmetric implosion requires not only delivering the correct total energy but also ensuring it is distributed uniformly over the capsule surface. This advanced practice addresses the critical issue of symmetry control by quantifying the effects of small, unavoidable errors in laser beam pointing on the drive uniformity. You will implement a viewfactor-based sensitivity analysis to determine the allowable pointing jitter that keeps the low-mode asymmetry, specifically the $P_2$ Legendre moment, within acceptable engineering tolerances .",
            "id": "3991079",
            "problem": "You are tasked with developing a program that computes the allowable angular jitter in laser beam pointing for an inertial confinement fusion (ICF) hohlraum such that the resulting second-order Legendre moment of the capsule drive asymmetry, denoted by $P_2$, remains below a specified tolerance. The calculation must incorporate a viewfactor-based sensitivity analysis. The allowable jitter must be returned in radians. The final program output must aggregate the results of all test cases on a single line as a comma-separated list enclosed in square brackets.\n\nThe fundamental base for this problem is as follows:\n- Conservation of energy: the radiative flux absorbed by the capsule is the sum of contributions from each source region (laser spot or x-ray emitting region) weighted by geometric viewfactors.\n- Radiative viewfactor method: the absorbed flux at a given capsule surface patch is the source power multiplied by a dimensionless viewfactor between the source and the patch.\n- Spherical harmonics and Legendre polynomials: angular drive asymmetry is represented by Legendre moments, with $P_2$ the second Legendre polynomial $P_2(x) = \\frac{3x^2 - 1}{2}$.\n- Small-angle linearization: for sufficiently small pointing-angle perturbations, the change in viewfactor is linear in the angle perturbation.\n\nAssume an axisymmetric capsule where the absorbed flux distribution on the capsule is discretized at $n_p$ polar locations indexed by $j \\in \\{1,\\dots,n_p\\}$ with polar angles $\\theta_j \\in [0,\\pi]$ and corresponding Gauss-Legendre quadrature abscissas $\\mu_j = \\cos(\\theta_j)$ and weights $w_j$ that integrate polynomials in $\\mu$ over $[-1,1]$ exactly up to a specified degree. Assume $n_b$ laser beams indexed by $i \\in \\{1,\\dots,n_b\\}$, each with power $P_i$ (in watts). Let the nominal viewfactor from beam $i$ to capsule patch $j$ be $V_{ij}$ (dimensionless), and the sensitivity of the viewfactor with respect to the pointing angle $\\alpha_i$ be $S_{ij} = \\frac{\\partial V_{ij}}{\\partial \\alpha_i}$ (in $\\mathrm{rad}^{-1}$). The nominal absorbed flux at patch $j$ is defined by\n$$\nq_j = \\sum_{i=1}^{n_b} P_i V_{ij},\n$$\nand the nominal $P_2$ moment (dimensionless) of the drive is defined by\n$$\nA_2 = \\frac{\\sum_{j=1}^{n_p} q_j \\, P_2(\\mu_j) \\, w_j}{\\sum_{j=1}^{n_p} q_j \\, w_j}.\n$$\nAssume small angular jitter $\\delta \\alpha_i$ in the pointing angle of each beam $i$, and approximate the change in absorbed flux at patch $j$ as\n$$\n\\delta q_j \\approx \\sum_{i=1}^{n_b} P_i S_{ij} \\, \\delta \\alpha_i,\n$$\nwhich follows from a first-order Taylor expansion (small-angle linearization). The corresponding first-order change in $A_2$ can be derived by differentiating the above quotient of linear functionals with respect to each angle, yielding the sensitivity $g_i = \\frac{\\partial A_2}{\\partial \\alpha_i}$, which is a linear functional of $S_{ij}$, $P_i$, $w_j$, $P_2(\\mu_j)$, $q_j$, and the denominator sum. For worst-case jitter bounded in the infinity norm, i.e., $|\\delta \\alpha_i| \\leq \\Delta$ for all $i$, a guaranteed bound on the $P_2$ excursion is\n$$\n|\\delta A_2| \\leq \\Delta \\sum_{i=1}^{n_b} |g_i|.\n$$\nTo ensure the total $P_2$ remains below a specified tolerance $T$ (dimensionless), we require\n$$\n|A_2| + \\Delta \\sum_{i=1}^{n_b} |g_i| \\leq T,\n$$\nwhich yields the maximum allowable jitter amplitude\n$$\n\\Delta^\\star =\n\\begin{cases}\n\\frac{T - |A_2|}{\\sum_{i=1}^{n_b} |g_i|}, & \\text{if } \\sum_{i=1}^{n_b} |g_i| > 0 \\text{ and } T \\geq |A_2|, \\\\\n+\\infty, & \\text{if } \\sum_{i=1}^{n_b} |g_i| = 0 \\text{ and } T \\geq |A_2|, \\\\\n0, & \\text{if } T < |A_2|.\n\\end{cases}\n$$\nYou must compute $\\Delta^\\star$ using the above definitions for each test case. Angles must be expressed in radians. The final program output must be a single line containing the list of results as floats in radians.\n\nThe Gauss-Legendre quadrature abscissas and weights for order $4$ are provided and must be used for all test cases:\n- Abscissas $\\mu_j$ for $j \\in \\{1,2,3,4\\}$:\n  - $\\mu_1 = -0.8611363116$, $\\mu_2 = -0.3399810436$, $\\mu_3 = 0.3399810436$, $\\mu_4 = 0.8611363116$.\n- Weights $w_j$ for $j \\in \\{1,2,3,4\\}$:\n  - $w_1 = 0.3478548451$, $w_2 = 0.6521451549$, $w_3 = 0.6521451549$, $w_4 = 0.3478548451$.\n\nYour program must implement the following test suite and produce results in radians:\n\n- Test Case $1$ (general case with nonzero sensitivity):\n  - Number of beams $n_b = 4$, number of patches $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 0.9 \\times 10^{12}, 1.1 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.020, 0.024, 0.026, 0.023]$,\n    - Row $2$: $[0.019, 0.023, 0.025, 0.022]$,\n    - Row $3$: $[0.021, 0.025, 0.027, 0.024]$,\n    - Row $4$: $[0.020, 0.024, 0.026, 0.023]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$):\n    - Row $1$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $2$: $[0.0009, 0.0011, 0.0012, 0.0010]$,\n    - Row $3$: $[0.0011, 0.0013, 0.0014, 0.0012]$,\n    - Row $4$: $[0.0010, 0.0012, 0.0013, 0.0011]$.\n  - Tolerance $T = 0.01$ (dimensionless).\n\n- Test Case $2$ (edge case with zero sensitivity):\n  - $n_b = 4$, $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.020, 0.020, 0.020, 0.020]$,\n    - Row $2$: $[0.020, 0.020, 0.020, 0.020]$,\n    - Row $3$: $[0.020, 0.020, 0.020, 0.020]$,\n    - Row $4$: $[0.020, 0.020, 0.020, 0.020]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$) is the zero matrix:\n    - Row $1$: $[0.0, 0.0, 0.0, 0.0]$,\n    - Row $2$: $[0.0, 0.0, 0.0, 0.0]$,\n    - Row $3$: $[0.0, 0.0, 0.0, 0.0]$,\n    - Row $4$: $[0.0, 0.0, 0.0, 0.0]$.\n  - Tolerance $T = 0.1$ (dimensionless).\n\n- Test Case $3$ (edge case where tolerance is smaller than the nominal $P_2$, resulting in zero allowable jitter):\n  - $n_b = 4$, $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.010, 0.060, 0.060, 0.010]$,\n    - Row $2$: $[0.010, 0.060, 0.060, 0.010]$,\n    - Row $3$: $[0.010, 0.060, 0.060, 0.010]$,\n    - Row $4$: $[0.010, 0.060, 0.060, 0.010]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$):\n    - Row $1$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $2$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $3$: $[0.0010, 0.0012, 0.0013, 0.0011]$,\n    - Row $4$: $[0.0010, 0.0012, 0.0013, 0.0011]$.\n  - Tolerance $T = 0.001$ (dimensionless).\n\n- Test Case $4$ (boundary case where tolerance equals the nominal $P_2$):\n  - $n_b = 4$, $n_p = 4$.\n  - Beam powers (in watts): $P = [1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}, 1.0 \\times 10^{12}]$.\n  - Nominal viewfactor matrix $V$ (dimensionless):\n    - Row $1$: $[0.050, 0.010, 0.010, 0.050]$,\n    - Row $2$: $[0.050, 0.010, 0.010, 0.050]$,\n    - Row $3$: $[0.050, 0.010, 0.010, 0.050]$,\n    - Row $4$: $[0.050, 0.010, 0.010, 0.050]$.\n  - Sensitivity matrix $S$ (in $\\mathrm{rad}^{-1}$):\n    - Row $1$: $[0.0005, 0.0005, 0.0005, 0.0005]$,\n    - Row $2$: $[0.0005, 0.0005, 0.0005, 0.0005]$,\n    - Row $3$: $[0.0005, 0.0005, 0.0005, 0.0005]$,\n    - Row $4$: $[0.0005, 0.0005, 0.0005, 0.0005]$.\n  - Tolerance $T$ must be set equal to the nominal $P_2$ computed from the above parameters (i.e., $T = |A_2|$ for Test Case $4$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_k$ is the computed $\\Delta^\\star$ in radians for Test Case $k$ as a floating-point number. No additional text should be printed. All angle quantities must be in radians, and all $P_2$-related values are dimensionless. The result type for each test case must be a float, with the special case of $+\\infty$ printed as $inf$ where applicable.",
            "solution": "The problem as stated is scientifically sound, mathematically well-posed, and provides all necessary information for a unique solution. The underlying model is a standard, albeit simplified, representation of drive asymmetry analysis in inertial confinement fusion, based on established principles of radiative transfer, spherical harmonics, and linear sensitivity analysis. All data provided for the test cases are numerically and dimensionally consistent. Therefore, a full solution is warranted.\n\nThe central task is to compute the maximum allowable angular jitter amplitude, denoted $\\Delta^\\star$, for a set of laser beams in a hohlraum, such that the resulting drive asymmetry on the fusion capsule remains within a specified tolerance. The drive asymmetry is quantified by the second Legendre moment, $A_2$.\n\nThe derivation proceeds in three main stages: first, calculating the nominal (unperturbed) drive asymmetry, $A_2$; second, determining the sensitivity of this asymmetry to small pointing errors in each beam; and third, using this sensitivity to establish the maximum permissible jitter.\n\nWe begin by defining the quantities and their mathematical representations.\nThe system consists of $n_b$ laser beams and $n_p$ capsule surface patches. The capsule patches are located at polar angles $\\theta_j$ corresponding to the abscissas $\\mu_j = \\cos(\\theta_j)$ of a Gauss-Legendre quadrature scheme of order $n_p$. The associated quadrature weights are $w_j$. For this problem, $n_p=4$, and the abscissas and weights are provided. The second Legendre polynomial is given by $P_2(\\mu) = \\frac{3\\mu^2 - 1}{2}$.\n\nThe nominal radiative flux absorbed at patch $j$ is given by the sum of contributions from all beams:\n$$\nq_j = \\sum_{i=1}^{n_b} P_i V_{ij}\n$$\nwhere $P_i$ is the power of beam $i$ and $V_{ij}$ is the dimensionless viewfactor from beam $i$ to patch $j$. In matrix-vector notation, if we define $\\mathbf{P}$ as a column vector of beam powers (shape $n_b \\times 1$) and $\\mathbf{q}$ as a column vector of patch fluxes (shape $n_p \\times 1$), and $\\mathbf{V}$ as the viewfactor matrix of shape ($n_b \\times n_p$), this can be written as $\\mathbf{q} = \\mathbf{V}^T \\mathbf{P}$.\n\nThe nominal $P_2$ drive asymmetry, $A_2$, is the normalized second Legendre moment of the flux distribution:\n$$\nA_2 = \\frac{\\sum_{j=1}^{n_p} q_j P_2(\\mu_j) w_j}{\\sum_{j=1}^{n_p} q_j w_j}\n$$\nLet us define the numerator as $N = \\sum_{j=1}^{n_p} q_j P_2(\\mu_j) w_j$ and the denominator as $D = \\sum_{j=1}^{n_p} q_j w_j$. So, $A_2 = N/D$. The denominator $D$ represents the total weighted flux, proportional to the total energy absorbed by the capsule.\n\nThe next step is to find the sensitivity of $A_2$ to a small change in the pointing angle $\\alpha_i$ of beam $i$. This sensitivity is $g_i = \\frac{\\partial A_2}{\\partial \\alpha_i}$. We apply the quotient rule for differentiation:\n$$\ng_i = \\frac{\\partial A_2}{\\partial \\alpha_i} = \\frac{1}{D^2} \\left[ \\frac{\\partial N}{\\partial \\alpha_i} D - N \\frac{\\partial D}{\\partial \\alpha_i} \\right]\n$$\nThe partial derivatives of $N$ and $D$ with respect to $\\alpha_i$ are required. These depend on the change in flux $q_j$ with respect to $\\alpha_i$. From the problem statement, the change in viewfactor is $S_{ij} = \\frac{\\partial V_{ij}}{\\partial \\alpha_i}$. Thus, the change in flux is:\n$$\n\\frac{\\partial q_j}{\\partial \\alpha_i} = \\frac{\\partial}{\\partial \\alpha_i} \\left( \\sum_{k=1}^{n_b} P_k V_{kj} \\right) = P_i S_{ij}\n$$\nNow, we can compute the derivatives of $N$ and $D$:\n$$\n\\frac{\\partial N}{\\partial \\alpha_i} = \\sum_{j=1}^{n_p} \\frac{\\partial q_j}{\\partial \\alpha_i} P_2(\\mu_j) w_j = \\sum_{j=1}^{n_p} (P_i S_{ij}) P_2(\\mu_j) w_j = P_i \\sum_{j=1}^{n_p} S_{ij} P_2(\\mu_j) w_j\n$$\n$$\n\\frac{\\partial D}{\\partial \\alpha_i} = \\sum_{j=1}^{n_p} \\frac{\\partial q_j}{\\partial \\alpha_i} w_j = \\sum_{j=1}^{n_p} (P_i S_{ij}) w_j = P_i \\sum_{j=1}^{n_p} S_{ij} w_j\n$$\nSubstituting these back into the expression for $g_i$ and dividing by $D$ yields a more elegant form:\n$$\ng_i = \\frac{1}{D} \\frac{\\partial N}{\\partial \\alpha_i} - \\frac{N}{D^2} \\frac{\\partial D}{\\partial \\alpha_i} = \\frac{P_i}{D} \\sum_{j=1}^{n_p} S_{ij} P_2(\\mu_j) w_j - \\frac{A_2}{D} \\left( P_i \\sum_{j=1}^{n_p} S_{ij} w_j \\right)\n$$\nFactoring out common terms, we arrive at the final expression for the sensitivity of beam $i$:\n$$\ng_i = \\frac{P_i}{D} \\left( \\sum_{j=1}^{n_p} S_{ij} P_2(\\mu_j) w_j - A_2 \\sum_{j=1}^{n_p} S_{ij} w_j \\right)\n$$\nThis calculation must be performed for each beam $i \\in \\{1, \\dots, n_b\\}$.\n\nThe problem imposes a worst-case jitter scenario, where the pointing error of each beam, $\\delta \\alpha_i$, is bounded by $|\\delta \\alpha_i| \\leq \\Delta$. The total change in asymmetry, $\\delta A_2$, is approximated to first order as $\\delta A_2 \\approx \\sum_{i=1}^{n_b} g_i \\delta \\alpha_i$. A conservative upper bound on the magnitude of this change is obtained via the triangle inequality:\n$$\n|\\delta A_2| \\leq \\sum_{i=1}^{n_b} |g_i| |\\delta \\alpha_i| \\leq \\Delta \\sum_{i=1}^{n_b} |g_i|\n$$\nThe final asymmetry is $A_2^{\\text{final}} = A_2 + \\delta A_2$. To ensure that the total asymmetry remains within a tolerance $T$, i.e., $|A_2^{\\text{final}}| \\leq T$, we impose a stricter condition on the upper bound:\n$$\n|A_2| + |\\delta A_2|_{\\text{max}} \\leq T \\implies |A_2| + \\Delta \\sum_{i=1}^{n_b} |g_i| \\leq T\n$$\nSolving for $\\Delta$ gives the allowable jitter amplitude. This leads to the piecewise definition for the maximum allowable jitter, $\\Delta^\\star$:\n$$\n\\Delta^\\star =\n\\begin{cases}\n\\frac{T - |A_2|}{\\sum_{i=1}^{n_b} |g_i|}, & \\text{if } \\sum_{i=1}^{n_b} |g_i| > 0 \\text{ and } T \\geq |A_2| \\\\\n+\\infty, & \\text{if } \\sum_{i=1}^{n_b} |g_i| = 0 \\text{ and } T \\geq |A_2| \\\\\n0, & \\text{if } T < |A_2|\n\\end{cases}\n$$\nThe case $\\Delta^\\star=0$ signifies that the nominal asymmetry $|A_2|$ already exceeds the tolerance $T$, so no jitter is permissible. The case $\\Delta^\\star=+\\infty$ signifies that the system is insensitive to pointing errors ($g_i=0$ for all $i$), and the nominal asymmetry is within tolerance, so theoretically any amount of jitter (within the linear approximation's validity) is allowed.\n\nTo implement the solution, the following algorithm is executed for each test case:\n$1$. Define the input parameters: vectors $\\mathbf{P}$, $\\boldsymbol{\\mu}$, $\\mathbf{w}$, and matrices $\\mathbf{V}$, $\\mathbf{S}$.\n$2$. Compute the vector of Legendre polynomial values $\\mathbf{P_2}$ where $(\\mathbf{P_2})_j = P_2(\\mu_j)$.\n$3$. Calculate the nominal flux vector $\\mathbf{q} = \\mathbf{V}^T \\mathbf{P}$.\n$4$. Calculate the sums $N = \\mathbf{q}^T (\\mathbf{P_2} \\odot \\mathbf{w})$ and $D = \\mathbf{q}^T \\mathbf{w}$, where $\\odot$ denotes element-wise multiplication.\n$5$. Compute the nominal asymmetry $A_2 = N/D$.\n$6$. For Test Case $4$, set the tolerance $T = |A_2|$.\n$7$. For each beam $i$, calculate the sensitivity $g_i$ using the derived formula. This can be vectorized.\n$8$. Compute the sum of the absolute values of the sensitivities, $\\Sigma_g = \\sum_{i=1}^{n_b} |g_i|$.\n$9$. Apply the piecewise formula to determine $\\Delta^\\star$ based on the values of $T$, $|A_2|$, and $\\Sigma_g$.\n$10$. The resulting $\\Delta^\\star$ is the final answer for the test case, in radians.\n\nThis procedure is systematically applied to all provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_jitter_limit(case_params):\n    \"\"\"\n    Calculates the allowable angular jitter for a single test case.\n\n    Args:\n        case_params (dict): A dictionary containing all parameters for the test case.\n                            Keys: 'P', 'V', 'S', 'T'.\n\n    Returns:\n        float: The maximum allowable jitter amplitude Delta* in radians.\n    \"\"\"\n    # Step 1: Extract givens and define constants\n    P = np.array(case_params['P'], dtype=float)\n    V = np.array(case_params['V'], dtype=float)\n    S = np.array(case_params['S'], dtype=float)\n    T = case_params['T'] # Can be a float or None\n\n    # Gauss-Legendre quadrature for order 4 (n_p = 4)\n    mu_j = np.array([-0.8611363116, -0.3399810436, 0.3399810436, 0.8611363116])\n    w_j = np.array([0.3478548451, 0.6521451549, 0.6521451549, 0.3478548451])\n    \n    # Step 2: Compute P2(mu_j)\n    # P_2(x) = (3*x^2 - 1) / 2\n    p2_of_mu = 0.5 * (3.0 * mu_j**2 - 1.0)\n    \n    # Step 3: Calculate nominal flux q_j\n    # q_j = sum_i(P_i * V_ij)\n    # This corresponds to V.T @ P in numpy, where V has shape (n_b, n_p)\n    # and P has shape (n_b,).\n    q_j = V.T @ P\n    \n    # Step 4: Calculate nominal asymmetry A_2\n    # A_2 = Numerator / Denominator\n    numerator_A2 = np.dot(q_j, p2_of_mu * w_j)\n    denominator_A2 = np.dot(q_j, w_j)\n    \n    # Handle the case of zero total flux, though physically unlikely with given data.\n    if np.isclose(denominator_A2, 0.0):\n        # If total flux is zero, q_j is all zero, so numerator is also zero.\n        # A_2 is 0/0, which is ill-defined. We define it as 0 in this context.\n        A_2 = 0.0\n    else:\n        A_2 = numerator_A2 / denominator_A2\n        \n    # Step 5: Handle Test Case 4's special tolerance\n    if T is None:\n        T = np.abs(A_2)\n\n    # Step 6: Calculate asymmetry sensitivities g_i\n    # g_i = (P_i / D) * ( sum_j(S_ij * P2_j * w_j) - A_2 * sum_j(S_ij * w_j) )\n    if np.isclose(denominator_A2, 0.0):\n        g_i = np.zeros_like(P)\n    else:\n        # Vectorized calculation for g_i\n        # sum_vec1 is sum_j(S_ij * p2_of_mu_j * w_j) for each i\n        sum_vec1 = S @ (p2_of_mu * w_j)\n        # sum_vec2 is sum_j(S_ij * w_j) for each i\n        sum_vec2 = S @ w_j\n        \n        g_i = (P / denominator_A2) * (sum_vec1 - A_2 * sum_vec2)\n        \n    # Step 7: Calculate sum of absolute sensitivities\n    sum_abs_g = np.sum(np.abs(g_i))\n    \n    # Step 8: Apply piecewise formula to calculate Delta*\n    abs_A2 = np.abs(A_2)\n    \n    # Check for T < |A_2| with a small tolerance for floating point comparisons\n    if T < abs_A2 and not np.isclose(T, abs_A2):\n        delta_star = 0.0\n    else:\n        if np.isclose(sum_abs_g, 0.0):\n            delta_star = np.inf\n        else:\n            delta_star = (T - abs_A2) / sum_abs_g\n\n    return delta_star\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1 (general case with nonzero sensitivity)\n        {\n            'P': [1.0e12, 0.9e12, 1.1e12, 1.0e12],\n            'V': [\n                [0.020, 0.024, 0.026, 0.023],\n                [0.019, 0.023, 0.025, 0.022],\n                [0.021, 0.025, 0.027, 0.024],\n                [0.020, 0.024, 0.026, 0.023]\n            ],\n            'S': [\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0009, 0.0011, 0.0012, 0.0010],\n                [0.0011, 0.0013, 0.0014, 0.0012],\n                [0.0010, 0.0012, 0.0013, 0.0011]\n            ],\n            'T': 0.01\n        },\n        # Test Case 2 (edge case with zero sensitivity)\n        {\n            'P': [1.0e12, 1.0e12, 1.0e12, 1.0e12],\n            'V': [\n                [0.020, 0.020, 0.020, 0.020],\n                [0.020, 0.020, 0.020, 0.020],\n                [0.020, 0.020, 0.020, 0.020],\n                [0.020, 0.020, 0.020, 0.020]\n            ],\n            'S': [\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0]\n            ],\n            'T': 0.1\n        },\n        # Test Case 3 (edge case with T < |A_2|)\n        {\n            'P': [1.0e12, 1.0e12, 1.0e12, 1.0e12],\n            'V': [\n                [0.010, 0.060, 0.060, 0.010],\n                [0.010, 0.060, 0.060, 0.010],\n                [0.010, 0.060, 0.060, 0.010],\n                [0.010, 0.060, 0.060, 0.010]\n            ],\n            'S': [\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0010, 0.0012, 0.0013, 0.0011],\n                [0.0010, 0.0012, 0.0013, 0.0011]\n            ],\n            'T': 0.001\n        },\n        # Test Case 4 (boundary case with T = |A_2|)\n        {\n            'P': [1.0e12, 1.0e12, 1.0e12, 1.0e12],\n            'V': [\n                [0.050, 0.010, 0.010, 0.050],\n                [0.050, 0.010, 0.010, 0.050],\n                [0.050, 0.010, 0.010, 0.050],\n                [0.050, 0.010, 0.010, 0.050]\n            ],\n            'S': [\n                [0.0005, 0.0005, 0.0005, 0.0005],\n                [0.0005, 0.0005, 0.0005, 0.0005],\n                [0.0005, 0.0005, 0.0005, 0.0005],\n                [0.0005, 0.0005, 0.0005, 0.0005]\n            ],\n            'T': None # Placeholder to signify T = |A_2|\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_jitter_limit(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}