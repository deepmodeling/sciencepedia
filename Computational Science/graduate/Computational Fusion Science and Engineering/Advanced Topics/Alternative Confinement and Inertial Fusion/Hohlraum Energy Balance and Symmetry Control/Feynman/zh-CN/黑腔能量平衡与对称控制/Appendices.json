{
    "hands_on_practices": [
        {
            "introduction": "我们实践练习的第一步是建立一个坚实的基础，理解激光能量如何与空腔壁相互作用。这个练习将引导你使用集总热容模型——一个在热分析中广泛应用且有效的简化方法——来估算加热空腔壁所需的时间。通过将能量守恒的基本原理应用于一个具体的几何结构，你将亲身体会到如何将核心物理参数（如激光功率和材料特性）与空腔等离子体形成的关键时间尺度联系起来 ()。",
            "id": "3991144",
            "problem": "柱形黑腔用于将激光能量转换为X射线，以实现间接驱动惯性约束聚变。内壁由高原子序数金属制成，并在整个壁厚上被建模为集总热容。考虑一个内半径为$R$、轴向长度为$L$的黑腔，其两端盖上各有一个半径为$r_{\\mathrm{LEH}}$的激光注入孔 (LEH)。黑腔壁具有均匀的厚度$t$、质量密度$\\rho$，并且在相关温度范围内具有恒定（有效）的比热容$c_p$。入射激光功率被壁吸收的净比例为$\\eta_{\\mathrm{abs}}$，并且在所关注的时间内，激光提供恒定的功率$P_L$。\n\n从能量守恒和热容的定义出发，推导在内表面积上均匀能量沉积下，将壁温升高$\\Delta T$所需的壁加热时间$t_h$的闭式表达式。使用柱形几何结构，将内壁面积构建为内圆柱表面积与两个端盖面积之和，再减去两个激光注入孔的面积：\n$$\nA_w \\;=\\; 2\\pi R L \\;+\\; 2\\pi R^2 \\;-\\; 2\\pi r_{\\mathrm{LEH}}^2.\n$$\n将面密度定义为$m_a=\\rho\\,t$，并使用集总热容关系$E_{\\mathrm{req}} \\approx A_w\\,m_a\\,c_p\\,\\Delta T$来模拟温升所需的能量。将$E_{\\mathrm{req}}$与吸收的激光能量$\\eta_{\\mathrm{abs}} P_L t_h$关联起来，并求解$t_h$。\n\n使用以下参数计算$t_h$的数值，并使用指定的单位和精度：\n- $R = 2.00 \\times 10^{-3}$ m, $L = 9.00 \\times 10^{-3}$ m, $r_{\\mathrm{LEH}} = 1.00 \\times 10^{-3}$ m,\n- $t = 1.50 \\times 10^{-4}$ m, $\\rho = 1.93 \\times 10^{4}$ kg/m$^3$, $c_p = 1.29 \\times 10^{2}$ J/kg/K,\n- $\\Delta T = 3.00 \\times 10^{3}$ K, $\\eta_{\\mathrm{abs}} = 0.75$, $P_L = 1.00 \\times 10^{11}$ W.\n\n将最终的加热时间以纳秒 (ns) 为单位表示。将您的答案四舍五入到三位有效数字。",
            "solution": "首先验证问题，以确保其具有科学依据、内容自洽且提法明确。给定的参数如下：\n- 内半径：$R = 2.00 \\times 10^{-3}$ m\n- 轴向长度：$L = 9.00 \\times 10^{-3}$ m\n- 激光注入孔 (LEH) 半径：$r_{\\mathrm{LEH}} = 1.00 \\times 10^{-3}$ m\n- 壁厚：$t = 1.50 \\times 10^{-4}$ m\n- 质量密度：$\\rho = 1.93 \\times 10^{4}$ kg/m$^3$\n- 比热容：$c_p = 1.29 \\times 10^{2}$ J/kg/K\n- 壁温升高：$\\Delta T = 3.00 \\times 10^{3}$ K\n- 吸收的激光功率净比例：$\\eta_{\\mathrm{abs}} = 0.75$\n- 激光功率：$P_L = 1.00 \\times 10^{11}$ W\n- 内壁面积：$A_w = 2\\pi R L + 2\\pi R^2 - 2\\pi r_{\\mathrm{LEH}}^2$\n- 面密度：$m_a = \\rho t$\n- 温升所需能量：$E_{\\mathrm{req}} \\approx A_w m_a c_p \\Delta T$\n\n该问题基于能量守恒基本原理，并使用标准集总参数模型进行热分析，这在此背景下是一种有效的简化。所提供的参数对于间接驱动惯性约束聚变实验是物理上现实的。问题定义明确，提供了所有必要信息，且无内在矛盾。因此，该问题被视为有效，可以构建解答。\n\n求解过程通过应用能量守恒原理进行。在加热时间$t_h$内，黑腔壁吸收的总能量$E_{\\mathrm{abs}}$必须等于将壁温升高$\\Delta T$所需的能量，记作$E_{\\mathrm{req}}$。\n$$\nE_{\\mathrm{abs}} = E_{\\mathrm{req}}\n$$\n吸收的能量是恒定吸收功率与加热时间的乘积。吸收功率是入射激光功率$P_L$的$\\eta_{\\mathrm{abs}}$倍。\n$$\nE_{\\mathrm{abs}} = (\\eta_{\\mathrm{abs}} P_L) t_h\n$$\n加热壁所需的能量由问题陈述中提供的集总热容关系给出。要加热的壁的总质量是内壁表面积$A_w$、壁厚$t$和质量密度$\\rho$的乘积。问题通过定义面密度$m_a = \\rho t$来简化此计算。\n$$\nE_{\\mathrm{req}} = A_w m_a c_p \\Delta T\n$$\n令吸收能量和所需能量的表达式相等，我们得到：\n$$\n\\eta_{\\mathrm{abs}} P_L t_h = A_w m_a c_p \\Delta T\n$$\n求解加热时间$t_h$，得到通用符号表达式：\n$$\nt_h = \\frac{A_w m_a c_p \\Delta T}{\\eta_{\\mathrm{abs}} P_L}\n$$\n现在，我们代入壁面积$A_w$和面密度$m_a$的给定表达式：\n$$\nA_w = 2\\pi (RL + R^2 - r_{\\mathrm{LEH}}^2)\n$$\n$$\nm_a = \\rho t\n$$\n将这些代入$t_h$的方程，得到完整的闭式表达式：\n$$\nt_h = \\frac{2\\pi (RL + R^2 - r_{\\mathrm{LEH}}^2) (\\rho t) c_p \\Delta T}{\\eta_{\\mathrm{abs}} P_L}\n$$\n这就完成了问题的推导部分。下一步是使用提供的参数计算$t_h$的数值。\n\n首先，我们计算分子中的各项。\n内壁面积 $A_w$：\n$$\nA_w = 2\\pi \\left( (2.00 \\times 10^{-3})(9.00 \\times 10^{-3}) + (2.00 \\times 10^{-3})^2 - (1.00 \\times 10^{-3})^2 \\right)\n$$\n$$\nA_w = 2\\pi \\left( 18.0 \\times 10^{-6} + 4.00 \\times 10^{-6} - 1.00 \\times 10^{-6} \\right) \\text{m}^2\n$$\n$$\nA_w = 2\\pi (21.0 \\times 10^{-6}) \\text{ m}^2 = 42.0\\pi \\times 10^{-6} \\text{ m}^2\n$$\n面密度 $m_a$：\n$$\nm_a = \\rho t = (1.93 \\times 10^{4} \\text{ kg/m}^3)(1.50 \\times 10^{-4} \\text{ m}) = 2.895 \\text{ kg/m}^2\n$$\n现在，我们计算所需的总能量 $E_{\\mathrm{req}}$：\n$$\nE_{\\mathrm{req}} = A_w m_a c_p \\Delta T\n$$\n$$\nE_{\\mathrm{req}} = (42.0\\pi \\times 10^{-6} \\text{ m}^2) (2.895 \\text{ kg/m}^2) (1.29 \\times 10^{2} \\text{ J/kg/K}) (3.00 \\times 10^{3} \\text{ K})\n$$\n$$\nE_{\\mathrm{req}} = (42.0 \\times 2.895 \\times 1.29 \\times 3.00) \\pi \\times 10^{-6+2+3} \\text{ J}\n$$\n$$\nE_{\\mathrm{req}} = 469.551 \\pi \\times 10^{-1} \\text{ J} \\approx 147.513 \\text{ J}\n$$\n接下来，我们计算吸收功率 $P_{\\mathrm{abs}}$：\n$$\nP_{\\mathrm{abs}} = \\eta_{\\mathrm{abs}} P_L = (0.75)(1.00 \\times 10^{11} \\text{ W}) = 0.75 \\times 10^{11} \\text{ W}\n$$\n最后，我们计算以秒为单位的加热时间 $t_h$：\n$$\nt_h = \\frac{E_{\\mathrm{req}}}{P_{\\mathrm{abs}}} = \\frac{46.9551 \\pi \\text{ J}}{0.75 \\times 10^{11} \\text{ W}}\n$$\n$$\nt_h = \\frac{147.513...}{0.75 \\times 10^{11}} \\text{ s} \\approx 1.96684 \\times 10^{-9} \\text{ s}\n$$\n问题要求最终答案以纳秒 (ns) 为单位，其中 $1 \\text{ ns} = 10^{-9} \\text{ s}$。\n$$\nt_h \\approx 1.96684 \\text{ ns}\n$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\nt_h \\approx 1.97 \\text{ ns}\n$$",
            "answer": "$$\\boxed{1.97}$$"
        },
        {
            "introduction": "在掌握了基本的能量沉积之后，我们转向对称性控制的一个核心物理机制：交叉束能量转移（CBET）。CBET 描述了不同激光束在等离子体中相互作用并交换能量的现象，这是主动调节内爆对称性的一个关键工具。通过求解一个简化的耦合常微分方程组，你将模拟内锥和外锥激光束之间的能量转移，从而深入理解如何通过初始激光功率的设定来影响最终驱动的对称性 ()。",
            "id": "3991159",
            "problem": "考虑一个用于间接驱动惯性约束聚变的柱形黑腔中交叉束能量转移 (CBET) 的简化模型。交叉束能量转移 (CBET) 在内外束锥之间重新分配激光束功率，以影响惯性约束聚变靶丸上的X射线驱动对称性。假设存在一个沿公共路径坐标 $z \\in [0,L]$ 的一维相互作用区域，其长度为 $L$。令 $P_i(z)$ 和 $P_o(z)$ 分别表示内锥和外锥光束的功率，单位均为瓦特。局部功率交换遵循以下耦合常微分方程\n$$\\frac{dP_i}{dz} = -K\\,P_i\\,P_o,\\qquad \\frac{dP_o}{dz} = +K\\,P_i\\,P_o,$$\n其中 $K$ 是一个恒定的CBET耦合系数，单位为 $\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1}$。假设初始条件为 $P_i(0)=P_{i0}$ 和 $P_o(0)=P_{o0}$，其中 $P_{i0}$ 和 $P_{o0}$ 的单位均为瓦特。如果在相互作用区域中吸收和自发辐射可以忽略不计，则总功率 $P_i(z)+P_o(z)$ 是守恒的，这与黑腔设计中对称性控制分析常用的能量平衡假设相一致。\n\n任务：从基本能量守恒论证和给定的局部相互作用模型出发，推导一种算法来计算任意给定参数 $(P_{i0},P_{o0},K,L)$ 下的最终功率 $P_i(L)$ 和 $P_o(L)$（单位为瓦特），并将其实现为一个完整的、可运行的程序。如果 $P_{i0}$ 或 $P_{o0}$ 为零，或者 $K=0$，或者 $L=0$，则将这些情况作为与控制方程和能量守恒一致的边界情况处理。\n\n单位和输出要求：\n- 所有输入功率必须以瓦特为单位，所有长度以米为单位，耦合系数以 $\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1}$ 为单位。\n- 您的程序必须以瓦特为单位输出最终功率。\n- 为便于数值表示，请将每个最终功率四舍五入到6位小数。\n\n测试套件：\n使用以下参数集来验证正确性和边缘情况下的行为。对于每种情况，计算 $P_i(L)$ 和 $P_o(L)$（单位为瓦特）。\n- 情况1（一般耦合，中等交换）：$(P_{i0},P_{o0},K,L) = (\\,600000.0\\,\\mathrm{W},\\,400000.0\\,\\mathrm{W},\\,10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,1.0\\,\\mathrm{m}\\,)$。\n- 情况2（无耦合）：$(P_{i0},P_{o0},K,L) = (\\,600000.0\\,\\mathrm{W},\\,400000.0\\,\\mathrm{W},\\,0.0\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,5.0\\,\\mathrm{m}\\,)$。\n- 情况3（强交换）：$(P_{i0},P_{o0},K,L) = (\\,800000.0\\,\\mathrm{W},\\,200000.0\\,\\mathrm{W},\\,5\\times 10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,1.5\\,\\mathrm{m}\\,)$。\n- 情况4（内锥光束功率为零）：$(P_{i0},P_{o0},K,L) = (\\,0.0\\,\\mathrm{W},\\,1000000.0\\,\\mathrm{W},\\,10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,10.0\\,\\mathrm{m}\\,)$。\n- 情况5（相互作用长度为零）：$(P_{i0},P_{o0},K,L) = (\\,500000.0\\,\\mathrm{W},\\,500000.0\\,\\mathrm{W},\\,10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,0.0\\,\\mathrm{m}\\,)$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含五个情况的结果，格式为一个由方括号括起的逗号分隔列表，每个情况表示为一个双元素列表 $[P_i(L),P_o(L)]$，且不含空格。例如，输出必须严格遵循以下格式\n$$[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4],[x_5,y_5]]$$\n其中每个 $x_j$ 和 $y_j$ 是一个以瓦特为单位、四舍五入到6位小数的十进制数。",
            "solution": "根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- **控制方程**：沿一维路径 $z \\in [0,L]$ 的内锥功率 $P_i(z)$ 和外锥功率 $P_o(z)$ 的耦合常微分方程组：\n  $$ \\frac{dP_i}{dz} = -K\\,P_i\\,P_o $$\n  $$ \\frac{dP_o}{dz} = +K\\,P_i\\,P_o $$\n- **耦合系数**：$K$ 是一个常数，单位为 $\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1}$。\n- **初始条件**：在 $z=0$ 处，功率为 $P_i(0)=P_{i0}$ 和 $P_o(0)=P_{o0}$，单位为瓦特。\n- **守恒定律**：总功率 $P_i(z)+P_o(z)$ 是守恒的。\n- **任务**：给定参数 $(P_{i0}, P_{o0}, K, L)$，推导一种算法以求得最终功率 $P_i(L)$ 和 $P_o(L)$。\n- **边界情况**：对 $P_{i0}$、$P_{o0}$、$K$ 或 $L$ 为零的情况进行特殊处理。\n- **单位**：功率以瓦特 (W) 为单位，长度以米 (m) 为单位，$K$ 以 $\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1}$ 为单位。\n- **输出精度**：最终功率必须四舍五入到6位小数。\n- **测试套件**：\n  - 情况1：$(P_{i0},P_{o0},K,L) = (\\,600000.0\\,\\mathrm{W},\\,400000.0\\,\\mathrm{W},\\,10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,1.0\\,\\mathrm{m}\\,)$。\n  - 情况2：$(P_{i0},P_{o0},K,L) = (\\,600000.0\\,\\mathrm{W},\\,400000.0\\,\\mathrm{W},\\,0.0\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,5.0\\,\\mathrm{m}\\,)$。\n  - 情况3：$(P_{i0},P_{o0},K,L) = (\\,800000.0\\,\\mathrm{W},\\,200000.0\\,\\mathrm{W},\\,5\\times 10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,1.5\\,\\mathrm{m}\\,)$。\n  - 情况4：$(P_{i0},P_{o0},K,L) = (\\,0.0\\,\\mathrm{W},\\,1000000.0\\,\\mathrm{W},\\,10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,10.0\\,\\mathrm{m}\\,)$。\n  - 情况5：$(P_{i0},P_{o0},K,L) = (\\,500000.0\\,\\mathrm{W},\\,500000.0\\,\\mathrm{W},\\,10^{-6}\\,\\mathrm{W}^{-1}\\,\\mathrm{m}^{-1},\\,0.0\\,\\mathrm{m}\\,)$。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行分析。\n1.  **科学依据**：该模型是交叉束能量转移 (CBET) 的一个简化唯象表示，CBET是惯性约束聚变研究中一个已被充分证实的物理过程。该耦合常微分方程是模拟相互作用的布居数或量的标准数学工具。所述的能量守恒是控制方程的直接数学推论：$\\frac{d}{dz}(P_i + P_o) = -K P_i P_o + K P_i P_o = 0$。该问题在科学上是合理的，并基于等离子体物理和激光-物质相互作用的原理。\n2.  **适定性**：该问题是一个适定的初值问题。常微分方程的右侧是李普希兹连续的，这保证了对于给定的初始条件存在唯一解。\n3.  **客观性与清晰度**：该问题使用精确的数学表达式和客观、无歧义的语言进行阐述。所有参数和变量都得到了明确定义。\n4.  **完整性与一致性**：该问题提供了推导解所需的所有必要信息（方程、初始条件、参数）。所述的能量守恒与所提供的微分方程是一致的。不存在矛盾。\n5.  **合理性**：单位在量纲上是一致的。测试用例中的数值代表了高能量密度物理实验中遇到的数量级。\n\n### 步骤3：结论与行动\n该问题是有效的。它在科学上合理，适定，内部一致，且表述清晰。我们继续进行解的推导。\n\n### 算法推导与求解\n\n该问题要求解关于光束功率 $P_i(z)$ 和 $P_o(z)$ 的耦合常微分方程组：\n$$ \\frac{dP_i}{dz} = -K\\,P_i\\,P_o \\quad (1) $$\n$$ \\frac{dP_o}{dz} = +K\\,P_i\\,P_o \\quad (2) $$\n初始条件为 $P_i(0) = P_{i0}$ 和 $P_o(0) = P_{o0}$。\n\n首先，我们验证总功率守恒。将方程 $(1)$ 和 $(2)$ 相加得到：\n$$ \\frac{d}{dz}(P_i(z) + P_o(z)) = \\frac{dP_i}{dz} + \\frac{dP_o}{dz} = -K P_i P_o + K P_i P_o = 0 $$\n这证实了总功率 $P_T = P_i(z) + P_o(z)$ 沿相互作用路径 $z$ 是一个常数。其值由初始条件设定：\n$$ P_T = P_i(0) + P_o(0) = P_{i0} + P_{o0} $$\n这个守恒定律使我们能够将两个方程组成的系统简化为单个方程。我们可以用 $P_i(z)$ 和常数 $P_T$ 来表示 $P_o(z)$：\n$$ P_o(z) = P_T - P_i(z) $$\n将此代入方程 $(1)$，我们得到一个关于 $P_i(z)$ 的单一微分方程：\n$$ \\frac{dP_i}{dz} = -K P_i(z) (P_T - P_i(z)) $$\n这是一个标准的一阶非线性常微分方程，具体来说是一个逻辑斯谛型方程，它是可分离的。我们分离变量以便进行积分：\n$$ \\frac{dP_i}{P_i(P_T - P_i)} = -K\\,dz $$\n该方程在 $P_{i0} > 0$ 和 $P_{o0} > 0$ 的一般情况下有效。边界情况将单独处理。我们对两边从初始位置 $z=0$ 到最终位置 $z=L$ 进行积分：\n$$ \\int_{P_{i0}}^{P_i(L)} \\frac{dP_i}{P_i(P_T - P_i)} = \\int_0^L -K\\,dz = -K L $$\n假设 $P_T \\ne 0$，左边的积分使用部分分式分解法求解。\n$$ \\frac{1}{P_i(P_T - P_i)} = \\frac{1}{P_T}\\left(\\frac{1}{P_i} + \\frac{1}{P_T - P_i}\\right) $$\n积分过程如下：\n$$ \\frac{1}{P_T} \\int_{P_{i0}}^{P_i(L)} \\left(\\frac{1}{P_i} + \\frac{1}{P_T - P_i}\\right) dP_i = -K L $$\n$$ \\frac{1}{P_T} \\left[ \\ln(P_i) - \\ln(P_T - P_i) \\right]_{P_{i0}}^{P_i(L)} = -K L $$\n应用积分限：\n$$ \\frac{1}{P_T} \\left( \\ln\\left(\\frac{P_i(L)}{P_T - P_i(L)}\\right) - \\ln\\left(\\frac{P_{i0}}{P_T - P_{i0}}\\right) \\right) = -K L $$\n注意到 $P_o = P_T - P_i$，我们可以用功率比 $R(z) = P_i(z)/P_o(z)$ 来表示此式：\n$$ \\ln(R(L)) - \\ln(R(0)) = -K P_T L $$\n$$ \\ln\\left(\\frac{R(L)}{R(0)}\\right) = -K P_T L $$\n对两边取指数，得到以初始比率 $R(0)$ 表示的最终比率 $R(L)$：\n$$ R(L) = R(0) \\exp(-K P_T L) = \\frac{P_{i0}}{P_{o0}} \\exp(-K(P_{i0}+P_{o0})L) $$\n利用最终比率 $R(L)$ 和守恒定律 $P_i(L) + P_o(L) = P_T$，我们建立一个由两个代数方程组成的方程组来求解最终功率 $P_i(L)$ 和 $P_o(L)$：\n$$ P_i(L) = R(L) P_o(L) $$\n$$ R(L) P_o(L) + P_o(L) = P_T \\implies P_o(L) (R(L) + 1) = P_T $$\n这就得出了最终外锥功率的解：\n$$ P_o(L) = \\frac{P_T}{R(L) + 1} $$\n以及最终内锥功率的解：\n$$ P_i(L) = P_T - P_o(L) = \\frac{P_T R(L)}{R(L) + 1} $$\n\n**边界情况分析**：\n推导出的解析解依赖于比率 $P_{i0}/P_{o0}$，如果 $P_{o0}=0$ 则该比率无定义。我们必须直接从常微分方程分析这些情况。\n1.  如果 $K=0$ 或 $L=0$：则项 $K L$ 为零。指数项变为 $\\exp(0)=1$，因此 $R(L)=R(0)$。这意味着功率比不变，因此，各个功率保持其初始值：$P_i(L)=P_{i0}$ 和 $P_o(L)=P_{o0}$。\n2.  如果 $P_{i0}=0$：从方程 $(1)$，$\\frac{dP_i}{dz} = -K P_i P_o$。如果 $P_i(0)=0$，则 $\\frac{dP_i}{dz}$ 初始为 $0$。该初值问题的唯一解是对于所有 $z \\ge 0$，$P_i(z)=0$。因此，根据功率守恒，$P_o(z) = P_{o0}$ 对所有 $z$ 成立。因此，$P_i(L)=0$ 且 $P_o(L)=P_{o0}$。\n3.  如果 $P_{o0}=0$：类似地，从方程 $(2)$，$\\frac{dP_o}{dz} = K P_i P_o$。如果 $P_o(0)=0$，则唯一解是对于所有 $z \\ge 0$，$P_o(z)=0$。因此，$P_i(z)=P_{i0}$。因此，$P_o(L)=0$ 且 $P_i(L)=P_{i0}$。\n\n**最终算法**：\n基于以上推导，一个用于计算 $(P_i(L), P_o(L))$ 的鲁棒算法如下：\n1.  输入参数 $(P_{i0}, P_{o0}, K, L)$。\n2.  检查边界条件：如果 $K=0$、$L=0$、$P_{i0}=0$ 或 $P_{o0}=0$，则没有能量交换。返回初始功率 $(P_{i0}, P_{o0})$。\n3.  对于一般情况：\n    a. 计算总功率：$P_T = P_{i0} + P_{o0}$。\n    b. 计算初始功率比：$R_0 = P_{i0} / P_{o0}$。\n    c. 计算指数因子：$\\alpha = \\exp(-K P_T L)$。\n    d. 计算最终功率比：$R_L = R_0 \\cdot \\alpha$。\n    e. 计算最终功率：\n       $P_o(L) = P_T / (R_L + 1)$。\n       $P_i(L) = P_T - P_o(L)$。\n    f. 返回 $(P_i(L), P_o(L))$。\n4.  将计算出的最终功率四舍五入到6位小数以供输出。\n\n该算法为所有指定条件提供了一个完整且正确的解决方案。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the CBET problem for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (P_i0, P_o0, K, L)\n    test_cases = [\n        # Case 1 (general coupling, moderate exchange)\n        (600000.0, 400000.0, 1e-6, 1.0),\n        # Case 2 (no coupling)\n        (600000.0, 400000.0, 0.0, 5.0),\n        # Case 3 (strong exchange)\n        (800000.0, 200000.0, 5e-6, 1.5),\n        # Case 4 (zero inner-beam power)\n        (0.0, 1000000.0, 1e-6, 10.0),\n        # Case 5 (zero interaction length)\n        (500000.0, 500000.0, 1e-6, 0.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        p_i0, p_o0, K, L = case\n        \n        # Main logic to calculate the result for one case\n        p_i_L, p_o_L = solve_cbet(p_i0, p_o0, K, L)\n        \n        # Round the final powers to 6 decimal places as required.\n        p_i_L_rounded = round(p_i_L, 6)\n        p_o_L_rounded = round(p_o_L, 6)\n        \n        all_results.append((p_i_L_rounded, p_o_L_rounded))\n\n    # Format the results into the exact required string format.\n    # e.g., [[x1,y1],[x2,y2],...] with no spaces.\n    results_str_list = [f\"[{res[0]},{res[1]}]\" for res in all_results]\n    final_output_str = f\"[{','.join(results_str_list)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\ndef solve_cbet(p_i0, p_o0, K, L):\n    \"\"\"\n    Calculates the final powers P_i(L) and P_o(L) based on the analytical\n    solution to the CBET coupled equations.\n\n    Args:\n        p_i0 (float): Initial power of the inner beam in watts.\n        p_o0 (float): Initial power of the outer beam in watts.\n        K (float): CBET coupling coefficient in W^-1 m^-1.\n        L (float): Interaction length in meters.\n\n    Returns:\n        tuple: A tuple containing (P_i(L), P_o(L)) in watts.\n    \"\"\"\n    # Handle boundary cases where no energy transfer occurs.\n    # This occurs if the coupling K or length L is zero, or if one of the\n    # initial beam powers is zero (no medium for exchange).\n    if K == 0.0 or L == 0.0 or p_i0 == 0.0 or p_o0 == 0.0:\n        return p_i0, p_o0\n\n    # For the general case, apply the derived analytical solution.\n    \n    # 1. Calculate total power (conserved quantity)\n    p_total = p_i0 + p_o0\n    \n    # 2. Calculate the initial ratio of powers. This is safe due to the p_o0==0 check above.\n    r_0 = p_i0 / p_o0\n    \n    # 3. Calculate the argument of the exponential term in the solution for the ratio.\n    exponent_arg = -K * p_total * L\n    \n    # 4. Calculate the ratio of powers at z=L.\n    r_L = r_0 * np.exp(exponent_arg)\n    \n    # 5. Calculate final powers using the final ratio and conservation of power.\n    # P_o(L) = P_total / (R(L) + 1)\n    # P_i(L) = P_total - P_o(L)\n    p_o_L = p_total / (r_L + 1.0)\n    p_i_L = p_total - p_o_L\n    \n    return p_i_L, p_o_L\n\n# Execute the solver\nsolve()\n```"
        },
        {
            "introduction": "最后的练习将前面的概念整合到一个综合性的设计优化问题中。空腔的几何形状是决定 X 射线驱动对称性的首要因素，通过精心设计其形状可以被动地最小化不对称性。在这个实践中，你将运用一个参数化的视因子模型，通过优化“橄榄球”形空腔的长径比来最小化关键的 $P_4$ 不对称模式，这体现了在实际聚变研究中，几何设计、能量平衡和时变驱动之间复杂的相互作用 ()。",
            "id": "3991133",
            "problem": "考虑一个围绕中心球形靶丸的轴对称“橄榄球”形黑腔。黑腔几何近似为一个长椭球，总长度为 $L$，赤道内径为 $D$，长径比为 $r = L/D$。激光束从两端的激光入口孔（LEH）进入，并分为三组束锥，这些束锥相对于黑腔轴线具有固定的极角。靶丸注量不对称性由勒让德模式振幅 $P_4$ 量化，其定义为靶丸上轴对称空间驱动中四阶勒让德多项式的归一化系数。任务是使用基于能量平衡的参数化角系数模型，为一组固定的束锥角度和LEH尺寸，确定使 $P_4$ 的峰值（随时间）最小化的 $r$ 值。\n\n起点和基本依据：\n- 辐射能量平衡和角系数近似：入射到靶丸上的随时间变化的平均X射线通量，与黑腔壁的再发射分数以及由几何角系数加权的激光强度总和成正比。\n- 轴对称球谐函数分解使用勒让德多项式 $P_\\ell(\\cos\\theta)$；靶丸上注量空间分布的 $\\ell=4$ 分量与来自发射区域的 $P_4(\\cos\\theta)$ 贡献成正比。\n\n参数化几何模型：\n- 内壁被建模为长椭球。对于轴向坐标 $z \\in [0,L/2]$（一个端盖），局部内壁半径为\n$$\nr_w(z) = \\frac{D}{2}\\sqrt{1 - \\left(\\frac{z}{L/2}\\right)^2}.\n$$\n- 每个极角为 $\\beta_j$ 的束锥（输入中以度为单位；计算中使用弧度）主要将能量沉积在内壁上一个由下式给出的轴向位置附近\n$$\nz_j(r) = \\max\\left(0, \\min\\left(\\frac{L}{2}, \\frac{L}{2} - \\frac{D}{2}\\cot\\beta_j\\right)\\right).\n$$\n- 从靶丸中心看，内壁上点 $(z_j, r_w(z_j))$ 相对于黑腔轴线所张的极角为 $\\theta_j$。其角色散值为\n$$\n\\cos\\theta_j = \\frac{z_j}{\\sqrt{z_j^2 + r_w(z_j)^2}}.\n$$\n- 4阶勒让德多项式为\n$$\nP_4(x) = \\frac{1}{8}\\left(35x^4 - 30x^2 + 3\\right).\n$$\n- 束锥 $j$ 的类几何角系数值权重被建模为\n$$\nv_j(r) = \\frac{S_j(r)}{\\left(z_j^2 + r_w(z_j)^2\\right)},\n$$\n其中LEH损失因子为\n$$\nS_j(r) = 1 - \\exp\\left(-\\left(\\frac{\\frac{L}{2} - z_j}{a_{\\mathrm{LEH}}}\\right)^2\\right),\n$$\n且 $a_{\\mathrm{LEH}}$ 是LEH半径。\n\n能量平衡和时间依赖性：\n- 设 $I_j(t_k)$ 为束锥 $j$ 在离散时间 $t_k$ 的无量纲激光强度，并设腔壁反照率建模为\n$$\n\\alpha(t_k) = \\alpha_0 + (\\alpha_1 - \\alpha_0)\\frac{t_k}{t_{\\mathrm{end}}},\n$$\n其中 $t_{\\mathrm{end}}$ 是最终时间点。\n- 靶丸上的平均（零阶）驱动正比于\n$$\nF_0(t_k; r) = \\alpha(t_k)\\sum_j I_j(t_k) v_j(r).\n$$\n- 四阶勒让德分量分子建模为\n$$\nF_4(t_k; r) = \\sum_j I_j(t_k) v_j(r) P_4\\left(\\cos\\theta_j(r)\\right).\n$$\n- 在时间 $t_k$ 的归一化 $P_4$ 振幅为\n$$\nP_4^{\\mathrm{norm}}(t_k; r) = \\frac{\\left|F_4(t_k; r)\\right|}{F_0(t_k; r)}.\n$$\n- 给定 $r$ 的峰值 $P_4$ 为\n$$\nP_{4,\\mathrm{peak}}(r) = \\max_k P_4^{\\mathrm{norm}}(t_k; r).\n$$\n\n优化目标：\n- 找到 $r^\\star \\in [r_{\\min}, r_{\\max}]$，使 $P_{4,\\mathrm{peak}}(r)$ 最小化：\n$$\nr^\\star = \\arg\\min_{r \\in [r_{\\min}, r_{\\max}]} P_{4,\\mathrm{peak}}(r).\n$$\n\n实现要求：\n- 角度 $\\beta_j$ 以度为单位提供；在使用三角函数前需转换为弧度。\n- 在此问题中，所有量均为无量纲；不需要物理单位。\n- 使用上述公式计算 $P_{4,\\mathrm{peak}}(r)$，然后在每个测试案例的规定界限内优化 $r$。\n\n测试套件：\n对于所有测试案例，使用 $D = 1.0$， $r_{\\min} = 2.8$， $r_{\\max} = 4.2$，束锥角度（度）$\\beta = [23.5, 30.0, 44.5]$，离散时间 $t = [0.0, 0.6, 1.2, 1.8]$，以及 $t_{\\mathrm{end}} = 1.8$。\n\n- 测试案例1（标准情况）：\n  - $a_{\\mathrm{LEH}} = 0.25$。\n  - 在时间 $t$ 时每个束锥的强度：内圈 $[0.6, 0.8, 0.7, 0.5]$，中圈 $[0.5, 0.9, 0.9, 0.6]$，外圈 $[0.4, 0.7, 1.0, 1.0]$。\n  - 反照率参数：$\\alpha_0 = 0.70$，$\\alpha_1 = 0.85$。\n- 测试案例2（大LEH边界情况）：\n  - $a_{\\mathrm{LEH}} = 0.45$。\n  - 在时间 $t$ 时每个束锥的强度：内圈 $[0.6, 0.8, 0.7, 0.5]$，中圈 $[0.5, 0.9, 0.9, 0.6]$，外圈 $[0.4, 0.7, 1.0, 1.0]$。\n  - 反照率参数：$\\alpha_0 = 0.68$，$\\alpha_1 = 0.82$。\n- 测试案例3（早期以内圈束锥为主的边缘情况）：\n  - $a_{\\mathrm{LEH}} = 0.15$。\n  - 在时间 $t$ 时每个束锥的强度：内圈 $[1.2, 1.0, 0.6, 0.4]$，中圈 $[0.3, 0.5, 0.8, 0.9]$，外圈 $[0.2, 0.5, 0.9, 1.1]$。\n  - 反照率参数：$\\alpha_0 = 0.72$，$\\alpha_1 = 0.88$。\n\n输出规范：\n您的程序应生成单行输出，包含一个逗号分隔的列表，该列表用方括号括起来。每个结果必须是一个双元素列表 $[r^\\star, P_{4,\\mathrm{peak}}(r^\\star)]$，对应相应的测试案例，两个值都为浮点数。例如，输出格式应类似于 $[[r_1, p_1],[r_2, p_2],[r_3, p_3]]$。",
            "solution": "所呈现的问题是一个适定的优化任务，其基础是惯性约束聚变（ICF）黑腔物理的参数化模型。在其简化框架内，该问题在科学上是一致的，提供了所有必要的数据和方程，并且可以进行数学形式化。因此，该问题被认为是有效的。\n\n目标是找到最佳的黑腔长径比，表示为 $r = L/D$，以最小化聚变靶丸上的峰值瞬时驱动不对称性。该不对称性由四阶勒让德多项式的归一化振幅 $P_4$ 来量化。分析在指定的 $r$ 范围 $r \\in [r_{\\min}, r_{\\max}]$ 内进行。\n\n解决方案被构建为一个数值优化过程。该过程的核心是一个必须最小化的目标函数 $P_{4,\\mathrm{peak}}(r)$。此函数表示在给定几何比率 $r$ 的情况下，在一系列离散时间点上观察到的归一化 $P_4$ 不对称性的最大值（峰值）。\n\n算法设计如下：\n\n1.  **几何因子计算**：对于任何给定的比率 $r=L/D$，为每个 $j$ 激光束锥计算一组不依赖于时间的几何量。\n    *   黑腔长度为 $L = r \\cdot D$。\n    *   极角 $\\beta_j$（以度为单位给出）被转换为弧度，用于三角函数计算。\n    *   第 $j$ 个束锥沉积能量的轴向位置 $z_j$ 由几何关系确定：\n        $$\n        z_j(r) = \\frac{D}{2}(r - \\cot\\beta_j)\n        $$\n        对于给定的参数空间，此简化形式有效，确保 $z_j \\in [0, L/2]$。\n    *   在该轴向位置对应的内壁半径 $r_w(z_j)$ 使用长椭球方程找到：\n        $$\n        r_w(z_j) = \\frac{D}{2}\\sqrt{1 - \\left(\\frac{z_j}{L/2}\\right)^2}\n        $$\n    *   从位于原点的靶丸看，沉积点的极角 $\\theta_j$ 的余弦值由下式给出：\n        $$\n        \\cos\\theta_j(r) = \\frac{z_j}{\\sqrt{z_j^2 + r_w(z_j)^2}}\n        $$\n    *   每个束锥的类几何角系数值权重 $v_j(r)$ 包含了沉积点所对的立体角和一个损失因子 $S_j(r)$，该因子考虑了通过激光入口孔（LEH）逸出的X射线：\n        $$\n        v_j(r) = \\frac{S_j(r)}{z_j^2 + r_w(z_j)^2} \\quad \\text{其中} \\quad S_j(r) = 1 - \\exp\\left(-\\left(\\frac{L/2 - z_j}{a_{\\mathrm{LEH}}}\\right)^2\\right)\n        $$\n    这些量（$z_j$、$r_w(z_j)$、$\\cos\\theta_j$ 和 $v_j$）仅依赖于几何比率 $r$，并在每次评估目标函数时计算一次。\n\n2.  **瞬时不对称性计算**：在确定几何因子后，算法遍历一组离散时间点 $t_k$，以计算每个瞬间的归一化 $P_4$ 不对称性。\n    *   随时间变化的腔壁反照率（再发射效率）$\\alpha(t_k)$，使用提供的线性模型计算：\n        $$\n        \\alpha(t_k) = \\alpha_0 + (\\alpha_1 - \\alpha_0)\\frac{t_k}{t_{\\mathrm{end}}}\n        $$\n    *   每个束锥 $j$ 在时间 $t_k$ 的激光强度 $I_j(t_k)$ 作为输入给出。\n    *   计算X射线驱动的零阶（$F_0$）和四阶（$F_4$）分量。$F_0$ 代表入射到靶丸上的总通量，而 $F_4$ 代表该通量中 $P_4(\\cos\\theta)$ 分量的分子。\n        $$\n        F_0(t_k; r) = \\alpha(t_k)\\sum_j I_j(t_k) v_j(r)\n        $$\n        $$\n        F_4(t_k; r) = \\sum_j I_j(t_k) v_j(r) P_4\\left(\\cos\\theta_j(r)\\right)\n        $$\n    *   使用预先计算的 $\\cos\\theta_j(r)$ 值，评估第四勒让德多项式 $P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$ 的值。\n    *   在时间 $t_k$ 的归一化 $P_4$ 振幅是四阶分量的绝对值与零阶通量之比：\n        $$\n        P_4^{\\mathrm{norm}}(t_k; r) = \\frac{\\left|F_4(t_k; r)\\right|}{F_0(t_k; r)}\n        $$\n\n3.  **目标函数评估**：目标函数 $P_{4,\\mathrm{peak}}(r)$ 是对于固定的 $r$，在所有时间步长中 $P_4^{\\mathrm{norm}}(t_k; r)$ 的最大值：\n    $$\n    P_{4,\\mathrm{peak}}(r) = \\max_k P_4^{\\mathrm{norm}}(t_k; r)\n    $$\n\n4.  **数值优化**：最后一步是找到最佳比率 $r^\\star$，使得目标函数在指定边界 $[r_{\\min}, r_{\\max}]$ 内最小化。\n    $$\n    r^\\star = \\arg\\min_{r \\in [r_{\\min}, r_{\\max}]} P_{4,\\mathrm{peak}}(r)\n    $$\n    这是一个一维有界最小化问题。我们采用一个稳健的数值求解器，特别是 `scipy.optimize.minimize_scalar` 的 'bounded' 方法，来高效地找到连续函数 $P_{4,\\mathrm{peak}}(r)$ 的最小值。\n\n这整个过程应用于所提供的三个测试案例中的每一个，使用它们各自的LEH半径 $a_{\\mathrm{LEH}}$、激光强度 $I_j(t_k)$ 和反照率系数 $\\alpha_0$ 和 $\\alpha_1$ 的参数。每个案例的最终输出包括最佳比率 $r^\\star$ 和相应的最小峰值不对称性 $P_{4,\\mathrm{peak}}(r^\\star)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the optimal hohlraum aspect ratio to minimize P4 asymmetry\n    for a set of test cases.\n    \"\"\"\n    \n    # Common parameters for all test cases\n    D = 1.0\n    r_min = 2.8\n    r_max = 4.2\n    betas_deg = np.array([23.5, 30.0, 44.5])\n    times = np.array([0.0, 0.6, 1.2, 1.8])\n    t_end = 1.8\n\n    # Test suite data\n    test_cases = [\n        {\n            \"a_LEH\": 0.25,\n            \"intensities\": np.array([\n                [0.6, 0.8, 0.7, 0.5], # Inner cone\n                [0.5, 0.9, 0.9, 0.6], # Middle cone\n                [0.4, 0.7, 1.0, 1.0]  # Outer cone\n            ]),\n            \"alpha_0\": 0.70,\n            \"alpha_1\": 0.85,\n        },\n        {\n            \"a_LEH\": 0.45,\n            \"intensities\": np.array([\n                [0.6, 0.8, 0.7, 0.5],\n                [0.5, 0.9, 0.9, 0.6],\n                [0.4, 0.7, 1.0, 1.0]\n            ]),\n            \"alpha_0\": 0.68,\n            \"alpha_1\": 0.82,\n        },\n        {\n            \"a_LEH\": 0.15,\n            \"intensities\": np.array([\n                [1.2, 1.0, 0.6, 0.4],\n                [0.3, 0.5, 0.8, 0.9],\n                [0.2, 0.5, 0.9, 1.1]\n            ]),\n            \"alpha_0\": 0.72,\n            \"alpha_1\": 0.88,\n        },\n    ]\n\n    def p4_poly(x):\n        \"\"\"Computes the fourth-order Legendre polynomial P_4(x).\"\"\"\n        return (1/8) * (35 * x**4 - 30 * x**2 + 3)\n\n    def p_4_peak_of_r(r, params, betas_deg, times, t_end, D):\n        \"\"\"\n        Calculates the objective function P_{4,peak}(r) for a given r.\n        This is the function to be minimized.\n        \"\"\"\n        # Unpack case-specific parameters\n        a_LEH = params[\"a_LEH\"]\n        intensities = params[\"intensities\"]\n        alpha_0 = params[\"alpha_0\"]\n        alpha_1 = params[\"alpha_1\"]\n\n        # --- 1. Geometric Factor Calculation (time-independent) ---\n        L = r * D\n        L_half = L / 2.0\n        \n        betas_rad = np.deg2rad(betas_deg)\n        cot_betas = 1.0 / np.tan(betas_rad)\n\n        z_j = (D / 2.0) * (r - cot_betas)\n        \n        # Defensive check to prevent math domain error if z_j >= L_half\n        # Although problem analysis shows this won't happen for the given parameters.\n        ratio_z_Lh = z_j / L_half\n        if np.any(ratio_z_Lh >= 1.0):\n            return np.inf\n\n        r_w_z_j = (D / 2.0) * np.sqrt(1.0 - ratio_z_Lh**2)\n        \n        dist_sq = z_j**2 + r_w_z_j**2\n        cos_theta_j = z_j / np.sqrt(dist_sq)\n\n        p4_vals = p4_poly(cos_theta_j)\n        \n        S_j = 1.0 - np.exp(-((L_half - z_j) / a_LEH)**2)\n        v_j = S_j / dist_sq\n\n        # --- 2. Time-Dependent Asymmetry Calculation ---\n        p4_norm_over_time = []\n        for k, t_k in enumerate(times):\n            alpha_k = alpha_0 + (alpha_1 - alpha_0) * (t_k / t_end)\n            I_k = intensities[:, k]\n\n            sum_I_v = np.sum(I_k * v_j)\n            \n            F_0_k = alpha_k * sum_I_v\n            F_4_k = np.sum(I_k * v_j * p4_vals)\n\n            if F_0_k == 0:\n                p4_norm_k = 0.0\n            else:\n                p4_norm_k = np.abs(F_4_k) / F_0_k\n            \n            p4_norm_over_time.append(p4_norm_k)\n\n        # --- 3. Objective Function Evaluation ---\n        return np.max(p4_norm_over_time)\n\n    results = []\n    for case_params in test_cases:\n        # --- 4. Numerical Optimization ---\n        opt_result = minimize_scalar(\n            p_4_peak_of_r,\n            bounds=(r_min, r_max),\n            method='bounded',\n            args=(case_params, betas_deg, times, t_end, D)\n        )\n        \n        r_star = opt_result.x\n        p4_min_peak = opt_result.fun\n        results.append([r_star, p4_min_peak])\n\n    # Format output string exactly as specified, avoiding extra spaces\n    str_results = []\n    for res_pair in results:\n        str_results.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    final_output_str = f\"[{','.join(str_results)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}