{
    "hands_on_practices": [
        {
            "introduction": "交叉束能量转移（CBET）的物理核心在于一种共振的波-波相互作用。本练习旨在帮助你理解这一过程的增益如何在一个共振频率附近形成尖锐的峰值，以及频率失谐如何抑制能量转移。通过推导经典的洛伦兹线型函数并将其应用于具体场景，你将掌握量化CBET效率的关键技能 ()。",
            "id": "3962475",
            "problem": "两束真空波长为 $\\lambda_0$ 的相干受激辐射光放大（LASER，激光）光束在代表惯性约束聚变（ICF）黑腔条件的均匀、准中性等离子体内部以角度 $\\theta$ 交叉。电子数密度为 $n_e$，离子为单电荷，质量为 $m_i$，电子和离子温度分别为 $T_e$ 和 $T_i$。交叉光束能量转移（CBET）现象通过受驱的离子声波起作用，该离子声波由两束电磁波的有质动力拍频所激发，其拍频波矢为 $\\mathbf{q} = \\mathbf{k}_1 - \\mathbf{k}_2$，拍频角频率为 $\\Delta \\omega = \\omega_1 - \\omega_2$。等离子体的折射率为 $n(\\omega_0) = \\sqrt{1 - \\omega_{pe}^2/\\omega_0^2}$，其中 $\\omega_{pe}^2 = n_e e^2/(\\epsilon_0 m_e)$ 且 $\\omega_0 = 2 \\pi c/\\lambda_0$。在流体极限下，离子声波的色散关系为 $\\omega_a \\approx c_s q$，其中 $q = |\\mathbf{q}|$ 且对于等温电子和绝热离子的情况，$c_s = \\sqrt{\\left(Z k_B T_e + 3 k_B T_i\\right)/m_i}$，此处 $Z$ 是离子电荷态。朗道阻尼和碰撞阻尼由一个有效的离子声波阻尼率 $\\nu_s$ 表示，假设其与声波频率成正比，即 $\\nu_s = \\alpha \\,\\omega_a$，其中给定 $0  \\alpha  1$。失谐参数为 $\\delta \\equiv \\Delta \\omega - \\omega_a$，当 $\\delta = 0$ 时实现精确的相位匹配。\n\n从色散电介质中由麦克斯韦方程组推导出的电磁波方程出发，结合离子-电子流体的动量和连续性方程，以及由两束平面波拍频产生的有质动力，推导在 $(\\mathbf{q}, \\Delta \\omega)$ 处离子声波密度微扰的稳态受驱响应，并说明其大小如何在 CBET 的有效耦合中产生一个洛伦兹缩减因子。利用此结果，得到一个关于探测光束的小信号空间强度增益系数 $g$ 的表达式，该表达式用其共振值 $g_{\\mathrm{on}}$ 和比值 $\\delta/\\nu_s$ 来表示。明确指出相位匹配条件及其在失谐情况下的偏离。然后，对于下面给出的具体情况，计算探测光束在等离子体中沿直线路径传播长度 $L$ 后的强度增益因子 $G(L) \\equiv \\exp\\!\\left(g L\\right)$。\n\n具体参数如下：\n- $\\lambda_0 = 351 \\,\\mathrm{nm}$，\n- $\\theta = 40^\\circ$（角度以度表示），\n- $n_e = 0.10 \\, n_c$，其中 $n_c = \\epsilon_0 m_e \\omega_0^2/e^2$，\n- $Z = 1$, $m_i = m_p$, $T_e = 3 \\,\\mathrm{keV}$, $T_i = 1 \\,\\mathrm{keV}$，\n- $\\Delta \\omega = \\eta \\,\\omega_a$，其中 $\\eta = 1.15$，\n- $\\nu_s = \\alpha \\,\\omega_a$，其中 $\\alpha = 0.30$，\n- $g_{\\mathrm{on}} = 70 \\,\\mathrm{m}^{-1}$，\n- $L = 8 \\,\\mathrm{mm}$。\n\n取 $c$ 为真空中的光速，$e$ 为基本电荷，$\\epsilon_0$ 为真空介电常数，$m_e$ 为电子质量，$m_p$ 为质子质量，$k_B$ 为玻尔兹曼常数。您可以假设慢变包络近似和平面波近似适用，并且在长度 $L$ 上泵浦光的衰减可以忽略不计，因此小信号模型是有效的。\n\n将您计算出的 $G(L)$ 的最终数值结果四舍五入到四位有效数字。将 $G(L)$ 表示为一个无量纲因子。",
            "solution": "用户要求解答一个关于等离子体中交叉光束能量转移（CBET）的问题。\n\n### 第1步：提取给定条件\n-   **激光束：** 两束相干光束，真空波长为 $\\lambda_0$。\n-   **交叉角：** $\\theta$。\n-   **等离子体性质：** 均匀、准中性、电子数密度 $n_e$、单电荷离子（$Z=1$），质量为 $m_i$、电子温度 $T_e$、离子温度 $T_i$。\n-   **CBET机制：** 由有质动力拍频激发的受驱离子声波（IAW）。\n-   **拍频波：** 波矢 $\\mathbf{q} = \\mathbf{k}_1 - \\mathbf{k}_2$，角频率 $\\Delta \\omega = \\omega_1 - \\omega_2$。\n-   **等离子体折射率：** $n(\\omega_0) = \\sqrt{1 - \\omega_{pe}^2/\\omega_0^2}$。\n-   **等离子体频率：** $\\omega_{pe}^2 = n_e e^2/(\\epsilon_0 m_e)$。\n-   **激光频率：** $\\omega_0 = 2 \\pi c/\\lambda_0$。\n-   **IAW色散关系：** $\\omega_a \\approx c_s q$，其中 $q = |\\mathbf{q}|$。\n-   **离子声速：** $c_s = \\sqrt{\\left(Z k_B T_e + 3 k_B T_i\\right)/m_i}$。\n-   **IAW阻尼率：** $\\nu_s = \\alpha \\omega_a$，其中 $0  \\alpha  1$。\n-   **失谐参数：** $\\delta \\equiv \\Delta \\omega - \\omega_a$。\n-   **近似：** 慢变包络、平面波和可忽略的泵浦光衰减。小信号模型有效。\n-   **用于计算的具体参数：**\n    -   $\\lambda_0 = 351 \\,\\mathrm{nm}$\n    -   $\\theta = 40^\\circ$\n    -   $n_e = 0.10 \\, n_c$，其中 $n_c = \\epsilon_0 m_e \\omega_0^2/e^2$。\n    -   $Z = 1$\n    -   $m_i = m_p$ (质子质量)\n    -   $T_e = 3 \\,\\mathrm{keV}$\n    -   $T_i = 1 \\,\\mathrm{keV}$\n    -   $\\Delta \\omega = \\eta \\,\\omega_a$，其中 $\\eta = 1.15$\n    -   $\\nu_s = \\alpha \\,\\omega_a$，其中 $\\alpha = 0.30$\n    -   $g_{\\mathrm{on}} = 70 \\,\\mathrm{m}^{-1}$ (共振空间强度增益系数)\n    -   $L = 8 \\,\\mathrm{mm}$ (传播路径长度)\n-   **常量：** $c, e, \\epsilon_0, m_e, m_p, k_B$。\n\n### 第2步：使用提取的给定条件进行验证\n该问题具有科学依据，描述了在惯性约束聚变背景下通过受激布里渊散射实现交叉光束能量转移的成熟物理过程。所有的物理模型和方程，如有质动力、离子声波色散关系以及共振能量转移的概念，都是等离子体物理学中的标准内容。该问题提法恰当，为推导和后续计算提供了所有必要信息，且目标明确。语言客观、精确。所提供的参数对于ICF实验中的黑腔等离子体是符合实际的。该问题是自洽的，没有矛盾。辅助参数（例如 $\\lambda_0, \\theta, T_e$）为推导提供了物理背景，而数值计算则依赖于一组简化的参数（$\\eta, \\alpha, g_{\\mathrm{on}}, L$），这种结构旨在测试概念理解以及后续对推导公式的应用。这并未使问题变得无聊或牵强。\n\n### 第3步：结论与行动\n问题有效。我将继续进行解答。\n\n交叉光束能量转移现象是由激光拍频波的有质动力驱动的离子声波（IAW）所介导的。与IAW相关的归一化电子密度微扰 $\\delta n_e / n_e$ 的动力学可以用受驱阻尼谐振子的方程来描述：\n$$\n\\left( \\frac{\\partial^2}{\\partial t^2} + 2\\nu_s \\frac{\\partial}{\\partial t} + \\omega_a^2 \\right) \\frac{\\delta n_e}{n_e} = F_p(\\mathbf{r}, t)\n$$\n其中 $\\omega_a = c_s q$ 是IAW的固有频率，$\\nu_s$ 是其阻尼率，而 $F_p$ 是源自有质动力的驱动项。有质动力与激光强度的梯度成正比，其拍频分量以差频 $\\Delta \\omega = \\omega_1 - \\omega_2$ 振荡，并且具有由波矢 $\\mathbf{q} = \\mathbf{k}_1 - \\mathbf{k}_2$ 给出的空间结构。我们考虑与此拍频波相对应的单个傅里叶模式，因此我们寻找形式为 $\\delta n_e(\\mathbf{r}, t) \\propto \\exp[i(\\mathbf{q}\\cdot\\mathbf{r} - \\Delta\\omega t)]$ 的稳态解。将此代入微分方程，得到一个关于密度微扰复振幅的代数方程：\n$$\n\\left( -\\Delta\\omega^2 - 2i\\nu_s\\Delta\\omega + \\omega_a^2 \\right) \\frac{\\widetilde{\\delta n_e}}{n_e} \\propto \\widetilde{E_1}\\widetilde{E_2}^*\n$$\n因此，受驱密度响应的复振幅为：\n$$\n\\frac{\\widetilde{\\delta n_e}}{n_e} \\propto \\frac{1}{\\omega_a^2 - \\Delta\\omega^2 - 2i\\nu_s\\Delta\\omega}\n$$\n当系统在共振附近被驱动时，即 $\\Delta\\omega \\approx \\omega_a$，会发生能量转移。我们可以利用这个近似来简化分母。令 $\\delta = \\Delta\\omega - \\omega_a$ 为与共振的失谐量。\n$$\n\\omega_a^2 - \\Delta\\omega^2 = (\\omega_a - \\Delta\\omega)(\\omega_a + \\Delta\\omega) = (-\\delta)(2\\omega_a + \\delta) \\approx -2\\omega_a\\delta\n$$\n对于阻尼项，$2i\\nu_s\\Delta\\omega \\approx 2i\\nu_s\\omega_a$。分母近似变为 $-2\\omega_a\\delta - 2i\\nu_s\\omega_a = -2\\omega_a(\\delta + i\\nu_s)$。\n于是密度微扰的响应为：\n$$\n\\frac{\\widetilde{\\delta n_e}}{n_e} \\propto \\frac{1}{\\delta + i\\nu_s} = \\frac{\\delta - i\\nu_s}{\\delta^2 + \\nu_s^2}\n$$\n探测光束的小信号增益系数 $g$ 与从泵浦光束转移的能量速率成正比。当驱动力对等离子体波做功时，该能量转移速率达到最大。转移的功率与等离子体极化率的虚部成正比，而极化率的虚部又与密度响应振幅的虚部成正比。虚部代表了与驱动力正交（即相位相差 $\\pi/2$）的振荡分量，这使得在一个周期内可以做净功。\n$$\ng \\propto -\\text{Im}\\left( \\frac{\\widetilde{\\delta n_e}}{n_e} \\right)\n$$\n符号约定取决于 $\\Delta \\omega$ 是代表增益还是损耗。对于频率较低的光束（$\\omega_2$）的增益，我们要求 $\\omega_1 > \\omega_2$，因此 $\\Delta \\omega > 0$。增益为正。\n$$\ng \\propto -\\text{Im}\\left( \\frac{\\delta - i\\nu_s}{\\delta^2 + \\nu_s^2} \\right) = -\\left( \\frac{-\\nu_s}{\\delta^2 + \\nu_s^2} \\right) = \\frac{\\nu_s}{\\delta^2 + \\nu_s^2}\n$$\n该表达式描述了增益的共振线型。在相位匹配条件下，增益达到最大，即精确共振：$\\delta = 0$，或 $\\Delta\\omega = \\omega_a$。共振增益系数 $g_{\\mathrm{on}}$ 为：\n$$\ng_{\\mathrm{on}} \\propto \\frac{\\nu_s}{0^2 + \\nu_s^2} = \\frac{1}{\\nu_s}\n$$\n我们可以将比例常数表示为 $C = g_{\\mathrm{on}}\\nu_s$。将此代回 $g$ 的表达式：\n$$\ng = (g_{\\mathrm{on}}\\nu_s) \\frac{\\nu_s}{\\delta^2 + \\nu_s^2} = g_{\\mathrm{on}} \\frac{\\nu_s^2}{\\delta^2 + \\nu_s^2}\n$$\n将分子和分母同除以 $\\nu_s^2$，我们得到以共振值和失谐-阻尼比表示的增益系数：\n$$\ng = g_{\\mathrm{on}} \\frac{1}{1 + (\\delta/\\nu_s)^2}\n$$\n该表达式表明，当拍频频率偏离IAW固有频率时，增益会从其峰值 $g_{\\mathrm{on}}$ 减小，缩减因子为一个洛伦兹因子 $\\left[1 + (\\delta/\\nu_s)^2\\right]^{-1}$。最大能量转移的相位匹配条件是 $\\delta = 0$，任何偏离此条件的失谐（$\\delta \\neq 0$）都会降低耦合效率。\n\n现在，我们根据给定参数计算探测光束的强度增益因子 $G(L)$。传播距离 $L$ 后的增益因子由 $G(L) = \\exp(gL)$ 给出。我们首先需要计算失谐增益系数 $g$ 的值。\n\n失谐量为 $\\delta = \\Delta\\omega - \\omega_a$。给定 $\\Delta\\omega = \\eta \\omega_a$，其中 $\\eta = 1.15$。\n$$\n\\delta = 1.15 \\omega_a - \\omega_a = 0.15 \\omega_a\n$$\n阻尼率由 $\\nu_s = \\alpha \\omega_a$ 给出，其中 $\\alpha = 0.30$。\n$$\n\\nu_s = 0.30 \\omega_a\n$$\n失谐与阻尼之比为：\n$$\n\\frac{\\delta}{\\nu_s} = \\frac{0.15 \\omega_a}{0.30 \\omega_a} = \\frac{0.15}{0.30} = 0.5\n$$\n现在我们可以使用给定的共振值 $g_{\\mathrm{on}} = 70 \\,\\mathrm{m}^{-1}$ 来计算增益系数 $g$：\n$$\ng = g_{\\mathrm{on}} \\frac{1}{1 + (\\delta/\\nu_s)^2} = (70 \\,\\mathrm{m}^{-1}) \\frac{1}{1 + (0.5)^2} = 70 \\frac{1}{1 + 0.25} = 70 \\frac{1}{1.25}\n$$\n$$\ng = \\frac{70}{5/4} = 70 \\times \\frac{4}{5} = 14 \\times 4 = 56 \\,\\mathrm{m}^{-1}\n$$\n传播路径长度为 $L = 8 \\,\\mathrm{mm} = 8 \\times 10^{-3} \\,\\mathrm{m}$。指数的宗量是总增益指数 $gL$：\n$$\ngL = (56 \\,\\mathrm{m}^{-1}) \\times (8 \\times 10^{-3} \\,\\mathrm{m}) = 0.448\n$$\n因此，强度增益因子 $G(L)$ 为：\n$$\nG(L) = \\exp(gL) = \\exp(0.448)\n$$\n计算其值并四舍五入到四位有效数字：\n$$\nG(L) \\approx 1.565153\n$$\n$$\nG(L) \\approx 1.565\n$$\n这是一个无量纲因子，代表探测光束初始强度的倍增。",
            "answer": "$$\n\\boxed{1.565}\n$$"
        },
        {
            "introduction": "理想化的均匀等离子体假设在真实的惯性约束聚变（ICF）环境中并不成立。本练习引入了一个关键的实际复杂性——等离子体流速梯度，它会导致共振条件沿着激光路径不断变化，从而产生失谐。通过对非均匀等离子体板中的增益进行积分，你将亲身体会到这种不均匀性如何限制有效相互作用长度，并最终影响总的能量转移量 ()。",
            "id": "278282",
            "problem": "在惯性约束聚变 (ICF) 的背景下，交叉光束能量转移 (CBET) 是一个过程，其中两束相交的激光束通过基于等离子体的媒介（通常是受激离子声波 (IAW)）交换能量。该过程对激光拍波和IAW之间的共振条件高度敏感。\n\n考虑一束泵浦激光束（频率为 $\\omega_p$，波矢为 $\\mathbf{k}_p$）和一束种子激光束（频率为 $\\omega_s$，波矢为 $\\mathbf{k}_s$）在长度为 $L$ 的等离子体板内相互作用。该板从 $z=0$ 延伸到 $z=L$。能量转移由一个IAW介导，其自然频率为 $\\omega_{IAW}$（在等离子体静止坐标系中），唯象阻尼率为 $\\nu_{IAW}$。IAW的波矢由交叉光束的几何形状决定：$\\mathbf{k}_{IAW} = \\mathbf{k}_p - \\mathbf{k}_s$。\n\n等离子体具有不均匀的流速 $\\mathbf{v}(z)$，其方向纯粹沿 $z$ 轴，并随位置线性变化：$\\mathbf{v}(z) = (v_0 + v'z) \\hat{\\mathbf{z}}$，其中 $v_0$ 是板入口处的流速，$v'$ 是一个恒定的速度梯度。对于本问题，假设 $\\mathbf{k}_{IAW}$ 也与 $z$ 轴对齐，因此 $\\mathbf{k}_{IAW} \\cdot \\mathbf{v}(z) = k_{IAW} (v_0 + v'z)$。\n\n激光频率被调整，使得三波共振条件 $\\omega_p - \\omega_s = \\omega_{IAW} + \\mathbf{k}_{IAW} \\cdot \\mathbf{v}(z)$ 在等离子体板的入口处（即 $z=0$）完全满足。\n\n在非耗尽泵浦近似下，种子光束强度的空间增益系数 $g(z)$ 对偏离局部共振点的频率失配 $\\Delta\\omega(z)$ 具有洛伦兹依赖关系：\n$$g(z) = g_0 \\frac{\\nu_{IAW}^2}{(\\Delta\\omega(z))^2 + \\nu_{IAW}^2}$$\n此处，$g_0$ 是峰值共振增益系数（一个给定的常数），$\\Delta\\omega(z)$ 是相对于在 $z=0$ 处设定的共振条件的频率失谐。\n\n推导种子光束穿过整个等离子体板时所经历的总增益指数 $G = \\int_0^L g(z) dz$ 的表达式。您的最终表达式应以 $g_0$、$L$、$k_{IAW}$、$v'$ 和 $\\nu_{IAW}$ 表示。",
            "solution": "1. 共振的频率失谐为\n$$\n\\Delta\\omega(z)\n= [\\omega_p - \\omega_s] - [\\omega_{IAW} + k_{IAW}(v_0 + v'z)].\n$$\n因为在 $z=0$ 处共振条件成立，\n$$\n\\omega_p - \\omega_s = \\omega_{IAW} + k_{IAW}v_0,\n$$\n可得\n$$\n\\Delta\\omega(z) = -k_{IAW} v' z.\n$$\n由于增益公式中使用的是 $(\\Delta\\omega(z))^2$，负号不影响最终结果。\n\n2. 总增益指数为\n$$\nG = \\int_0^L g(z)\\,dz\n= g_0\\,\\nu_{IAW}^2 \\int_0^L \\frac{dz}{(k_{IAW} v' z)^2 + \\nu_{IAW}^2}.\n$$\n\n3. 定义 $a = k_{IAW} v'$。则\n$$\n\\int_0^L \\frac{dz}{a^2 z^2 + \\nu_{IAW}^2}\n= \\frac{1}{a\\,\\nu_{IAW}}\n\\Bigl[\\arctan\\!\\bigl(\\tfrac{a z}{\\nu_{IAW}}\\bigr)\\Bigr]_0^L\n= \\frac{1}{a\\,\\nu_{IAW}}\\arctan\\!\\Bigl(\\frac{a L}{\\nu_{IAW}}\\Bigr).\n$$\n\n4. 代回可得\n$$\nG\n= g_0\\,\\nu_{IAW}^2 \\cdot \\frac{1}{k_{IAW} v'\\,\\nu_{IAW}} \\arctan\\!\\Bigl(\\frac{k_{IAW} v' L}{\\nu_{IAW}}\\Bigr)\n= \\frac{g_0\\,\\nu_{IAW}}{k_{IAW} v'} \n\\arctan\\!\\Bigl(\\frac{k_{IAW} v' L}{\\nu_{IAW}}\\Bigr).\n$$",
            "answer": "$$\\boxed{\\frac{g_0\\,\\nu_{IAW}}{k_{IAW} v'} \\arctan\\!\\Bigl(\\frac{k_{IAW} v' L}{\\nu_{IAW}}\\Bigr)}$$"
        },
        {
            "introduction": "本最终练习将视角从物理细节提升到系统工程层面，直接应对CBET在ICF实验中的核心挑战——内爆对称性控制。你将把复杂的CBET物理抽象为一个时变传递函数，并设计一种控制策略，通过动态调整不同锥角的激光功率来抵消能量转移造成的不对称性。此练习还将让你直面模型不确定性的影响，评估控制方案的鲁棒性，这与实际聚变实验中工程师面临的挑战高度契合 ()。",
            "id": "3995516",
            "problem": "给定一个交叉光束能量转移 (cross-beam energy transfer, CBET) 模型。在该模型中，在黑腔的每一侧，发射到外环上的激光功率有一部分会转移到内环上。黑腔对称性由一个低阶勒让德 (Legendre) 分量 $P_2$ 表示，该分量源于内、外环驱动在靶丸上的差异加权。目标是计算内、外环随时间变化的指令功率，以在标称 CBET 转移函数下维持驱动平衡（定义为 $P_2$ 为零），然后评估当 CBET 转移函数在指定边界内不确定时产生的残余低阶模误差。\n\n基本原理和假设：\n- 在交叉光束能量转移过程中激光功率守恒，这表现为发射功率的线性再分配。这意味着传递功率对于发射功率和 CBET 转移函数是线性的。\n- 靶丸驱动通过线性权重建模，这些权重通过叠加将传递的环锥功率映射到总通量和低阶 $P_2$ 矩。\n\n设每侧的总指令激光功率为 $S(t)$，随时间变化的标称 CBET 转移函数为 $T(t)$，其有界不确定性为 $\\Delta T(t)$，因此实际转移函数位于 $[T(t)-\\Delta T(t), T(t)+\\Delta T(t)]$ 区间内，并截断到 $[0,1]$。设内、外环的低阶模耦合系数分别为 $\\alpha_i$ 和 $\\alpha_o$，总通量耦合系数分别为 $\\beta_i$ 和 $\\beta_o$。在时间 $t$，定义外环指令功率 $P_o^{\\mathrm{cmd}}(t)$ 和内环指令功率 $P_i^{\\mathrm{cmd}}(t)$，使得 $P_i^{\\mathrm{cmd}}(t)+P_o^{\\mathrm{cmd}}(t)=S(t)$。在 CBET 作用下，时间 $t$ 的传递功率为\n$$\nP_i^{\\mathrm{del}}(t) = P_i^{\\mathrm{cmd}}(t) + T(t)\\,P_o^{\\mathrm{cmd}}(t),\\quad\nP_o^{\\mathrm{del}}(t) = \\big(1 - T(t)\\big)\\,P_o^{\\mathrm{cmd}}(t).\n$$\n瞬时低阶 $P_2$ 矩和总通量模型为\n$$\nA_2(t) = \\alpha_i\\,P_i^{\\mathrm{del}}(t) + \\alpha_o\\,P_o^{\\mathrm{del}}(t),\\qquad\nF(t) = \\beta_i\\,P_i^{\\mathrm{del}}(t) + \\beta_o\\,P_o^{\\mathrm{del}}(t).\n$$\n\n任务：\n1. 对每个时间样本，在物理允许的范围 $[0, S(t)]$ 内选择 $P_o^{\\mathrm{cmd}}(t)$，以便在标称转移函数 $T(t)$ 下尽可能实现驱动平衡 $A_2(t)=0$。如果由于约束条件，无法实现精确抵消，则在 $[0, S(t)]$ 内选择 $P_o^{\\mathrm{cmd}}(t)$，以最小化标称 $T(t)$ 下 $A_2(t)$ 的绝对值。\n2. 使用计算出的指令功率，评估当实际转移函数不确定时最坏情况下的残余低阶模误差。对每个时间点，计算两个极端的实际转移函数 $T_-(t)=\\max\\{0,\\,T(t)-\\Delta T(t)\\}$ 和 $T_+(t)=\\min\\{1,\\,T(t)+\\Delta T(t)\\}$，构建相应的 $A_2(t)$ 和 $F(t)$，并定义瞬时最坏情况归一化残差\n$$\nr(t) = \\max\\left\\{ \\left|\\frac{A_2(t;T_-(t))}{F(t;T_-(t))}\\right|,\\, \\left|\\frac{A_2(t;T_+(t))}{F(t;T_+(t))}\\right| \\right\\}.\n$$\n通过计算均方根 (RMS) 残差来对整个脉冲进行聚合\n$$\nR = \\sqrt{\\frac{1}{N}\\sum_{k=1}^{N} r(t_k)^2},\n$$\n其中 $N$ 是时间样本的数量。\n\n所有功率均以任意归一化单位表示，最终的残差是一个无量纲小数。\n\n测试套件：\n对于每个测试用例，您将获得在 $N$ 个时间点采样的 $S(t)$、$T(t)$ 和 $\\Delta T(t)$ 数组，以及标量 $\\alpha_i$、$\\alpha_o$、$\\beta_i$、$\\beta_o$。请使用以下四个测试用例：\n\n- 用例 1（基准线，中等 CBET，不同的低阶模灵敏度）：\n  - $S(t) = [\\,1.0,\\,1.2,\\,1.5,\\,1.2,\\,1.0\\,]$\n  - $T(t) = [\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25\\,]$\n  - $\\Delta T(t) = [\\,0.05,\\,0.05,\\,0.05,\\,0.05,\\,0.05\\,]$\n  - $\\alpha_i = 1.0$, $\\alpha_o = -0.6$, $\\beta_i = 0.9$, $\\beta_o = 1.0$\n\n- 用例 2（无 CBET，平衡的通量权重）：\n  - $S(t) = [\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0\\,]$\n  - $T(t) = [\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n  - $\\Delta T(t) = [\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n  - $\\alpha_i = 0.8$, $\\alpha_o = -0.5$, $\\beta_i = 1.0$, $\\beta_o = 1.0$\n\n- 用例 3（随时间变化的 CBET 及不确定性，更强的内模灵敏度）：\n  - $S(t) = [\\,0.8,\\,1.0,\\,1.2,\\,1.0,\\,0.8\\,]$\n  - $T(t) = [\\,0.3,\\,0.4,\\,0.5,\\,0.4,\\,0.3\\,]$\n  - $\\Delta T(t) = [\\,0.1,\\,0.1,\\,0.1,\\,0.05,\\,0.05\\,]$\n  - $\\alpha_i = 1.1$, $\\alpha_o = -0.7$, $\\beta_i = 0.95$, $\\beta_o = 1.05$\n\n- 用例 4（近饱和 CBET 片段，可行性受限的抵消）：\n  - $S(t) = [\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0\\,]$\n  - $T(t) = [\\,0.65,\\,0.7,\\,0.75,\\,0.7,\\,0.65\\,]$\n  - $\\Delta T(t) = [\\,0.1,\\,0.1,\\,0.1,\\,0.1,\\,0.1\\,]$\n  - $\\alpha_i = 1.0$, $\\alpha_o = -0.9$, $\\beta_i = 1.0$, $\\beta_o = 1.0$\n\n程序要求：\n- 实现算法，为每个测试用例计算随时间变化的指令功率和最终的最坏情况 RMS 残差 $R$。\n- 您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，结果顺序与四个测试用例一致，例如 $[r_1,r_2,r_3,r_4]$。每个 $r_j$ 都必须是小数值。",
            "solution": "该问题被评估为有效。它在科学上基于惯性约束聚变中一个简化但标准的交叉光束能量转移 (CBET) 模型，问题是适定的（well-posed），提供了所有必要的数据和约束，并以客观、正式的语言表述。解决方案如下。\n\n目标是计算在激光脉冲期间，最坏情况归一化低阶模不对称性的均方根 (RMS) 值 $R$，该值受 CBET 模型中的不确定性影响。这需要在每个时间样本 $t_k$ 上分两步进行：首先，确定内、外环的最优指令功率，以在标称条件下实现驱动平衡；其次，使用这些指令功率，在 CBET 有界不确定性的情况下评估可能的最大不对称性。\n\n### 第1部分：指令激光功率的确定\n\n在任意给定时间 $t$，总指令功率 $S(t)$ 被分配给内环 $P_i^{\\mathrm{cmd}}(t)$ 和外环 $P_o^{\\mathrm{cmd}}(t)$，使得 $P_i^{\\mathrm{cmd}}(t) + P_o^{\\mathrm{cmd}}(t) = S(t)$。外环指令功率的物理允许范围是 $P_o^{\\mathrm{cmd}}(t) \\in [0, S(t)]$。\n\n第一个任务是选择 $P_o^{\\mathrm{cmd}}(t)$，以在标称 CBET 转移函数 $T(t)$ 下，使由勒让德矩 $A_2(t)$ 表示的低阶驱动不对称性为零。矩 $A_2(t)$ 由下式给出：\n$$\nA_2(t) = \\alpha_i\\,P_i^{\\mathrm{del}}(t) + \\alpha_o\\,P_o^{\\mathrm{del}}(t)\n$$\n代入传递功率的表达式 $P_i^{\\mathrm{del}}(t) = P_i^{\\mathrm{cmd}}(t) + T(t)\\,P_o^{\\mathrm{cmd}}(t)$ 和 $P_o^{\\mathrm{del}}(t) = (1 - T(t))\\,P_o^{\\mathrm{cmd}}(t)$，我们得到：\n$$\nA_2(t) = \\alpha_i \\left( P_i^{\\mathrm{cmd}}(t) + T(t)\\,P_o^{\\mathrm{cmd}}(t) \\right) + \\alpha_o \\left( (1 - T(t))\\,P_o^{\\mathrm{cmd}}(t) \\right)\n$$\n使用功率守恒约束 $P_i^{\\mathrm{cmd}}(t) = S(t) - P_o^{\\mathrm{cmd}}(t)$:\n$$\nA_2(t) = \\alpha_i \\left( S(t) - P_o^{\\mathrm{cmd}}(t) + T(t)\\,P_o^{\\mathrm{cmd}}(t) \\right) + \\alpha_o \\left( (1 - T(t))\\,P_o^{\\mathrm{cmd}}(t) \\right)\n$$\n为了找到对 $P_o^{\\mathrm{cmd}}(t)$ 的依赖关系，我们重新整理各项：\n$$\nA_2(t) = \\alpha_i S(t) + P_o^{\\mathrm{cmd}}(t) \\left[ -\\alpha_i + \\alpha_i T(t) + \\alpha_o (1 - T(t)) \\right]\n$$\n$$\nA_2(t) = \\alpha_i S(t) + P_o^{\\mathrm{cmd}}(t) \\left[ (\\alpha_o - \\alpha_i) - (\\alpha_o - \\alpha_i) T(t) \\right]\n$$\n$$\nA_2(t) = \\alpha_i S(t) + P_o^{\\mathrm{cmd}}(t) (\\alpha_o - \\alpha_i)(1 - T(t))\n$$\n设 $A_2(t) = 0$ 以求得理想的外环指令功率，记为 $P_{o, \\text{ideal}}^{\\mathrm{cmd}}(t)$，可得：\n$$\n- \\alpha_i S(t) = P_{o, \\text{ideal}}^{\\mathrm{cmd}}(t) (\\alpha_o - \\alpha_i)(1 - T(t))\n$$\n$$\nP_{o, \\text{ideal}}^{\\mathrm{cmd}}(t) = \\frac{- \\alpha_i S(t)}{(\\alpha_o - \\alpha_i)(1 - T(t))} = \\frac{\\alpha_i S(t)}{(\\alpha_i - \\alpha_o)(1 - T(t))}\n$$\n该表达式在分母不为零时有效，这对所有测试用例都成立，因为 $\\alpha_i \\neq \\alpha_o$ 且 $T(t)  1$。\n\n计算出的 $P_{o, \\text{ideal}}^{\\mathrm{cmd}}(t)$ 可能落在物理允许范围 $[0, S(t)]$ 之外。由于 $A_2(t)$ 是 $P_o^{\\mathrm{cmd}}(t)$ 的线性函数，如果理想值在区间 $[0, S(t)]$ 之外，则 $|A_2(t)|$ 在此区间上的最小值将出现在最接近理想值的边界端点处。这正是截断操作所实现的效果。因此，外环指令功率由下式确定：\n$$\nP_o^{\\mathrm{cmd}}(t) = \\text{clip}\\left( P_{o, \\text{ideal}}^{\\mathrm{cmd}}(t),\\, 0,\\, S(t) \\right)\n$$\n一旦为每个时间样本确定了 $P_o^{\\mathrm{cmd}}(t)$，就可以通过 $P_i^{\\mathrm{cmd}}(t) = S(t) - P_o^{\\mathrm{cmd}}(t)$ 求出 $P_i^{\\mathrm{cmd}}(t)$。\n\n### 第2部分：最坏情况归一化残差的计算\n\n在确定了随时间变化的指令功率后，我们现在评估 CBET 不确定性的影响。实际的转移函数是未知的，但位于 $[T(t) - \\Delta T(t), T(t) + \\Delta T(t)]$ 的边界内，并被截断到 $[0, 1]$。极端的转移函数是：\n$$\nT_-(t) = \\max\\{0,\\, T(t) - \\Delta T(t)\\}\n$$\n$$\nT_+(t) = \\min\\{1,\\, T(t) + \\Delta T(t)\\}\n$$\n归一化残差是实际转移函数 $T_{\\text{actual}}(t)$ 的函数。对于给定的 $T_{\\text{actual}}(t)$，传递功率为：\n$$\nP_i^{\\mathrm{del}}(t; T_{\\text{actual}}) = P_i^{\\mathrm{cmd}}(t) + T_{\\text{actual}}(t)\\,P_o^{\\mathrm{cmd}}(t)\n$$\n$$\nP_o^{\\mathrm{del}}(t; T_{\\text{actual}}) = (1 - T_{\\text{actual}}(t))\\,P_o^{\\mathrm{cmd}}(t)\n$$\n相应的不对称性 $A_2$ 和总通量 $F$ 为：\n$$\nA_2(t; T_{\\text{actual}}) = \\alpha_i\\,P_i^{\\mathrm{del}}(t; T_{\\text{actual}}) + \\alpha_o\\,P_o^{\\mathrm{del}}(t; T_{\\text{actual}})\n$$\n$$\nF(t; T_{\\text{actual}}) = \\beta_i\\,P_i^{\\mathrm{del}}(t; T_{\\text{actual}}) + \\beta_o\\,P_o^{\\mathrm{del}}(t; T_{\\text{actual}})\n$$\n由于 $A_2$ 和 $F$ 都是 $T_{\\text{actual}}$ 的线性函数，比率 $|A_2/F|$ 的极值将出现在 $T_{\\text{actual}}$ 的区间边界处，即 $T_-(t)$ 和 $T_+(t)$。因此，瞬时最坏情况归一化残差 $r(t)$ 是在这两个极端转移函数下计算出的绝对残差的最大值：\n$$\nr(t) = \\max\\left\\{ \\left|\\frac{A_2(t;T_-(t))}{F(t;T_-(t))}\\right|,\\, \\left|\\frac{A_2(t;T_+(t))}{F(t;T_+(t))}\\right| \\right\\}\n$$\n假设分母 $F(t)$ 为一个小的非零值，这在物理上是合理的，因为它代表总通量。\n\n### 第3部分：聚合 RMS 残差\n\n最后，整体性能指标 $R$ 是脉冲中所有 $N$ 个时间样本的瞬时最坏情况残差 $r(t_k)$ 的均方根 (RMS)：\n$$\nR = \\sqrt{\\frac{1}{N}\\sum_{k=1}^{N} r(t_k)^2}\n$$\n这个量值为功率平衡策略抵抗 CBET 不确定性的鲁棒性提供了一个单一的品质因数。以下算法为每个测试用例实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the worst-case RMS low-mode residual for several test cases\n    of a simplified CBET model in inertial confinement fusion.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"Case 1\",\n            \"S\": np.array([1.0, 1.2, 1.5, 1.2, 1.0]),\n            \"T\": np.array([0.25, 0.25, 0.25, 0.25, 0.25]),\n            \"dT\": np.array([0.05, 0.05, 0.05, 0.05, 0.05]),\n            \"alpha_i\": 1.0, \"alpha_o\": -0.6,\n            \"beta_i\": 0.9, \"beta_o\": 1.0\n        },\n        {\n            \"name\": \"Case 2\",\n            \"S\": np.array([1.0, 1.0, 1.0, 1.0, 1.0]),\n            \"T\": np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"dT\": np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"alpha_i\": 0.8, \"alpha_o\": -0.5,\n            \"beta_i\": 1.0, \"beta_o\": 1.0\n        },\n        {\n            \"name\": \"Case 3\",\n            \"S\": np.array([0.8, 1.0, 1.2, 1.0, 0.8]),\n            \"T\": np.array([0.3, 0.4, 0.5, 0.4, 0.3]),\n            \"dT\": np.array([0.1, 0.1, 0.1, 0.05, 0.05]),\n            \"alpha_i\": 1.1, \"alpha_o\": -0.7,\n            \"beta_i\": 0.95, \"beta_o\": 1.05\n        },\n        {\n            \"name\": \"Case 4\",\n            \"S\": np.array([1.0, 1.0, 1.0, 1.0, 1.0]),\n            \"T\": np.array([0.65, 0.7, 0.75, 0.7, 0.65]),\n            \"dT\": np.array([0.1, 0.1, 0.1, 0.1, 0.1]),\n            \"alpha_i\": 1.0, \"alpha_o\": -0.9,\n            \"beta_i\": 1.0, \"beta_o\": 1.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        S, T, dT = case[\"S\"], case[\"T\"], case[\"dT\"]\n        ai, ao = case[\"alpha_i\"], case[\"alpha_o\"]\n        bi, bo = case[\"beta_i\"], case[\"beta_o\"]\n\n        # Step 1: Determine commanded powers to null A2 under nominal T\n        # P_o_ideal = (ai * S) / ((ai - ao) * (1 - T))\n        denominator = (ai - ao) * (1 - T)\n        \n        # Handle cases where the denominator is zero, although not in test data.\n        # If denominator is 0, A2 is not controllable through P_o_cmd.\n        # An arbitrary choice (e.g., 0) would suffice since it has no effect on A2.\n        P_o_ideal = np.divide(ai * S, denominator, \n                              out=np.zeros_like(S), \n                              where=denominator!=0)\n\n        # Apply physical constraint 0 = P_o_cmd = S\n        P_o_cmd = np.clip(P_o_ideal, 0, S)\n        P_i_cmd = S - P_o_cmd\n\n        # Step 2: Evaluate worst-case residual given uncertainty dT\n        \n        # Define extremal transfer functions\n        T_minus = np.maximum(0, T - dT)\n        T_plus = np.minimum(1, T + dT)\n\n        def get_residual(T_actual, P_i_cmd, P_o_cmd, ai, ao, bi, bo):\n            \"\"\"Calculates A2 and F for a given actual transfer function.\"\"\"\n            P_i_del = P_i_cmd + T_actual * P_o_cmd\n            P_o_del = (1 - T_actual) * P_o_cmd\n\n            A2 = ai * P_i_del + ao * P_o_del\n            F = bi * P_i_del + bo * P_o_del\n            \n            # If F is zero, the normalized residual could be infinite or undefined.\n            # We assume F  0 based on the physics (total flux).\n            # The case F=0 and A2=0 is handled as zero residual.\n            return np.divide(A2, F, out=np.zeros_like(A2), where=F!=0)\n\n        r_minus = np.abs(get_residual(T_minus, P_i_cmd, P_o_cmd, ai, ao, bi, bo))\n        r_plus = np.abs(get_residual(T_plus, P_i_cmd, P_o_cmd, ai, ao, bi, bo))\n        \n        r_t = np.maximum(r_minus, r_plus)\n\n        # Step 3: Aggregate over the pulse by computing the RMS residual\n        R = np.sqrt(np.mean(r_t**2))\n        results.append(f\"{R:.7f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}