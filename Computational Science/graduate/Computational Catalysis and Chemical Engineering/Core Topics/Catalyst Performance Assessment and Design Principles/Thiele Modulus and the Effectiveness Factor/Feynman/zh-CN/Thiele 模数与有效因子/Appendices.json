{
    "hands_on_practices": [
        {
            "introduction": "理论的价值在于应用。本章的第一个实践练习将从最基本但至关重要的步骤开始：正确计算塞勒模量（Thiele Modulus）。塞勒模量 $ \\phi $ 是一个无量纲数，它量化了化学反应速率与催化剂颗粒内传质速率之间的相对重要性。此练习  强调了在将物理参数代入公式时确保单位一致性的必要性，这是避免在工程计算中出现常见错误的关键一步。",
            "id": "1527052",
            "problem": "一位化学工程师的任务是评估一个设计用于气相异构化反应 $A \\rightarrow B$ 的填充床反应器的性能。该反应由球形多孔催化剂颗粒催化，并且实验证实其相对于反应物A遵循一级动力学。\n\n已收集到以下数据：\n- 使用精细粉碎的催化剂颗粒以消除扩散阻力测得的本征一级反应速率常数 $k$ 为 $0.85 \\, \\text{s}^{-1}$。\n- 反应物A在催化剂颗粒多孔结构内的有效扩散系数 $D_e$ 为 $2.0 \\times 10^{-8} \\, \\text{m}^2/\\text{s}$。\n- 填充床反应器中使用的球形催化剂颗粒的半径 $R$ 为 $1.5 \\, \\text{mm}$。\n\n工程师需要计算塞勒模量 $\\phi$，以评估内传质限制的重要性。对于在球形颗粒中发生的一级反应，塞勒模量定义为：\n$$\n\\phi = R \\sqrt{\\frac{k}{D_e}}\n$$\n该公式的一个关键要求是，所得的塞勒模量必须是一个无量纲的量，这要求所有物理参数都使用一套一致的单位。请根据所提供的数据，计算塞勒模量的正确无量纲值。\n\n将您的最终答案四舍五入到三位有效数字。",
            "solution": "我们从球形颗粒内一级反应的定义开始：\n$$\n\\phi = R \\sqrt{\\frac{k}{D_{e}}}.\n$$\n为确保 $\\phi$ 是无量纲的，我们先验证单位。已知 $[k] = \\text{s}^{-1}$ 且 $[D_{e}] = \\text{m}^{2}\\,\\text{s}^{-1}$，则比值的单位为\n$$\n\\left[\\frac{k}{D_{e}}\\right] = \\frac{\\text{s}^{-1}}{\\text{m}^{2}\\,\\text{s}^{-1}} = \\text{m}^{-2},\n$$\n所以 $\\sqrt{k/D_{e}}$ 的单位是 $\\text{m}^{-1}$，再乘以单位为 $\\text{m}$ 的 $R$，即可得到无量纲的 $\\phi$，符合要求。\n\n将催化剂颗粒半径转换为米：\n$$\nR = 1.5\\,\\text{mm} = 1.5 \\times 10^{-3}\\,\\text{m}.\n$$\n计算比值 $k/D_{e}$：\n$$\n\\frac{k}{D_{e}} = \\frac{0.85\\,\\text{s}^{-1}}{2.0 \\times 10^{-8}\\,\\text{m}^{2}\\,\\text{s}^{-1}} = 4.25 \\times 10^{7}\\,\\text{m}^{-2}.\n$$\n取平方根：\n$$\n\\sqrt{\\frac{k}{D_{e}}} = \\sqrt{4.25 \\times 10^{7}} = \\sqrt{4.25}\\times 10^{3}\\sqrt{10} \\approx 6.5192 \\times 10^{3}\\,\\text{m}^{-1}.\n$$\n乘以 $R$ 得到塞勒模量：\n$$\n\\phi = \\left(1.5 \\times 10^{-3}\\,\\text{m}\\right)\\left(6.5192 \\times 10^{3}\\,\\text{m}^{-1}\\right) = 9.7788.\n$$\n四舍五入到三位有效数字，得到\n$$\n\\phi = 9.78.\n$$\n该值为无量纲，满足要求。",
            "answer": "$$\\boxed{9.78}$$"
        },
        {
            "introduction": "在掌握了一级反应的基本情况后，我们将探索不同反应动力学下的扩散限制效应。本练习  考察了一个零级反应，其反应速率在反应物浓度大于零时为常数。这种动力学行为可能导致催化剂颗粒内部形成一个反应物完全耗尽的“死区”，从而深刻影响催化剂的有效因子 $ \\eta $。通过推导这种特定情景下的解，您可以更深入地理解反应级数与内部传质限制之间的相互作用。",
            "id": "1527083",
            "problem": "一个多相催化反应 $A \\rightarrow B$ 被用于去除工业废物流中的一种污染物。该反应相对于污染物 $A$ 是零级反应，具有恒定的体积反应速率 $k_0$。催化剂被制成半厚度为 $L$ 的大平板。反应物 $A$ 在平板外表面的浓度维持在一个恒定值 $C_{As}$，而 $A$ 在多孔催化剂内的有效扩散系数为 $D_e$。\n\n该过程在强扩散限制条件下的稳态下运行。这意味着反应物 $A$ 在其能渗透到催化剂板中心之前就被完全消耗掉了。具体来说，$A$ 的浓度在板的中心区域为零。这个“死区”的边界，即反应物浓度首次降至零的位置，位于距板中心（$z=0$）$z = L/2$ 的距离处。\n\n在这些特定的操作条件下，计算催化剂有效因子 $\\eta$。有效因子定义为催化剂内实际的总反应速率与假设整个催化剂体积都暴露在表面浓度 $C_{As}$ 下所能达到的反应速率之比。以精确数值的形式给出答案。",
            "solution": "设平板的表面位于 $z=\\pm L$，中心位于 $z=0$。在存在 $A$ 的区域内，稳态扩散伴随零级消耗，其一维物种平衡方程为\n$$\n\\frac{d}{dz}\\left(-D_{e}\\frac{dC_{A}}{dz}\\right)=-r_{A},\\quad r_{A}=k_{0}\\ \\text{where}\\ C_{A}>0,\n$$\n在反应区域内，该方程简化为\n$$\nD_{e}\\frac{d^{2}C_{A}}{dz^{2}}=k_{0}.\n$$\n存在一个中心死区，其中 $C_{A}=0$ 且没有反应发生。死区边界处浓度和通量的连续性意味着在渗透边界 $z=z_{p}$ 处\n$$\nC_{A}(z_{p})=0,\\qquad \\left.\\frac{dC_{A}}{dz}\\right|_{z_{p}}=0.\n$$\n在反应壳层 $z\\in[z_{p},L]$ 内利用这些条件求解微分方程，得到\n$$\nC_{A}(z)=\\frac{k_{0}}{2D_{e}}(z-z_{p})^{2},\n$$\n而表面条件 $C_{A}(L)=C_{As}$ 意味着\n$$\nC_{As}=\\frac{k_{0}}{2D_{e}}(L-z_{p})^{2}.\n$$\n单位外表面积的实际总反应速率是体积速率在两侧反应区域上的积分：\n$$\nR_{\\text{actual}}'=\\int_{-L}^{L}r_{A}(z)\\,dz=2\\,k_{0}\\,(L-z_{p}),\n$$\n因为在每个厚度为 $(L-z_{p})$ 的反应壳层中 $r_{A}=k_{0}$，而在死区中为零。如果整个催化剂体积都暴露于 $C_{As}$，则各处的体积速率都将是 $k_{0}$，得到\n$$\nR_{\\text{ideal}}'=2L\\,k_{0}.\n$$\n因此，有效因子为\n$$\n\\eta=\\frac{R_{\\text{actual}}'}{R_{\\text{ideal}}'}=\\frac{2k_{0}(L-z_{p})}{2Lk_{0}}=\\frac{L-z_{p}}{L}.\n$$\n在所述的死区边界位于 $z_{p}=L/2$ 的条件下，该式变为\n$$\n\\eta=\\frac{L-\\frac{L}{2}}{L}=\\frac{1}{2}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在现代催化研究中，数值方法是分析和设计催化剂不可或缺的工具，尤其是在解析解不存在的复杂系统中。这个高级实践  将指导您构建一个数值模型来求解控制催化剂颗粒内浓度分布的边界值问题。通过应用有限差分法，您将能够从基本原理出发计算浓度分布和有效因子，并将其与解析解进行比较，这正是计算催化领域的核心技能之一。",
            "id": "3902605",
            "problem": "考虑一个等温、多孔的球形催化剂颗粒，在稳态下，其中发生单一的不可逆一级反应，无外部传质阻力且有效扩散系数恒定。从物种守恒和菲克定律（Fick’s law）作为基本出发点，推导出描述无量纲浓度分布的无量纲边值问题。令 $x \\in [0,1]$ 为无量纲径向坐标，$x = r/R$，令 $y(x)$ 为无量纲浓度，$y = c/c_{s}$，其中 $c_{s}$ 是表面浓度。该问题中的无量纲群是塞勒模量 (Thiele modulus) $\\phi$，其定义为 $\\phi^{2} = R^{2} k_{\\mathrm{eff}}/D_{\\mathrm{eff}}$，其中 $R$ 是颗粒半径，$k_{\\mathrm{eff}}$ 是有效一级反应速率常数，$D_{\\mathrm{eff}}$ 是有效扩散系数。稳态球形扩散-反应方程可以写成如下的无量纲形式的二阶常微分方程（ODE）：\n$$(1/x^{2}) \\, \\dfrac{d}{dx} \\!\\left(x^{2} \\dfrac{dy}{dx}\\right) - \\phi^{2} y = 0 \\quad \\text{for} \\quad x \\in (0,1),$$\n服从以下对称边界条件和狄利克雷（Dirichlet）边界条件\n$$\\left.\\dfrac{dy}{dx}\\right|_{x=0} = 0, \\qquad y(1) = 1.$$\n有效因子 $\\eta$ 根据其基本定义，被定义为无量纲的体积平均反应速率与表面浓度下反应速率的比值，即：\n$$\\eta = 3 \\int_{0}^{1} y(x)\\, x^{2}\\, dx.$$\n您的任务是设计并实现一个在均匀网格上的二阶守恒型有限差分格式，用以近似求解 $y(x)$，然后通过对上述定义进行数值积分来计算 $\\eta$。该数值方法必须满足：\n- 以守恒形式离散化球形算子，以避免 $x = 0$ 处的奇点。\n- 在中心施加对称边界条件，在表面施加狄利克雷边界条件。\n- 组装并求解得到的线性系统。\n- 在同一网格上使用高精度求积法计算 $\\eta$。\n\n然后，独立地计算球体中一级反应的解析有效因子，将其表示为塞勒模量 $\\phi$ 的函数（不得未经推导就假设或引用任何“捷径”结果；应将其视为一个已知的、用于验证的结果）。使用一种在 $\\phi$ 非常小和非常大时都能保持精确的数值稳定实现。\n\n测试套件：\n- 在 $x \\in [0,1]$ 上使用包含 $N = 4000$ 个节点的均匀网格。\n- 对以下塞勒模数值 $\\phi \\in \\{0.01, 0.10, 1.00, 5.00, 50.00\\}$，评估数值有效因子和解析有效因子之间的绝对误差。\n\n答案规范：\n- 对于测试套件中的每个 $\\phi$，计算绝对误差 $|\\eta_{\\mathrm{num}} - \\eta_{\\mathrm{ana}}|$ 并四舍五入到 $10$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如，$\\,[0.0000000001,0.0000000002,0.0000000003,0.0000000004,0.0000000005]\\,).$\n- 此问题中的所有量均为无量纲，因此输出中不需要物理单位。",
            "solution": "用户提供的问题是化学反应工程领域一个适定且具有坚实科学基础的边值问题，因此被认为是有效的。我们接下来给出一个完整的解法。\n\n该问题要求对球形催化剂颗粒内的稳态、一维、等温扩散-反应系统进行数值和解析处理。\n\n描述浓度分布 $y(x)$ 的无量纲控制微分方程为：\n$$ \\frac{1}{x^2} \\frac{d}{dx} \\left(x^2 \\frac{dy}{dx}\\right) - \\phi^2 y = 0 \\quad \\text{for} \\quad x \\in (0,1) $$\n边界条件为：\n$$ \\left.\\frac{dy}{dx}\\right|_{x=0} = 0, \\qquad y(1) = 1 $$\n其中 $y$ 是无量纲浓度，$x$ 是无量纲径向位置，$\\phi$ 是希勒模数。\n\n**1. 数值解：守恒型有限差分法**\n\n为获得数值解，我们使用一个包含 $N$ 个节点的均匀网格对区域 $x \\in [0,1]$ 进行离散化：$x_i = i h$，其中 $i=0, 1, \\dots, N-1$，步长为 $h = 1/(N-1)$。函数在节点 $x_i$ 处的值表示为 $y_i \\approx y(x_i)$。\n\n首先将常微分方程两边乘以 $x^2$，写成其守恒形式：\n$$ \\frac{d}{dx} \\left(x^2 \\frac{dy}{dx}\\right) - \\phi^2 x^2 y = 0 $$\n我们采用有限体积法来离散化这个方程，该方法具有内在的守恒性。对于一个内部节点 $x_i$ ($1 \\le i \\le N-2$)，我们在控制体积 $[x_{i-1/2}, x_{i+1/2}]$ 上对该方程进行积分，其中 $x_{i \\pm 1/2} = x_i \\pm h/2$。\n\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx} \\left(x^2 \\frac{dy}{dx}\\right) dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi^2 x^2 y(x) dx = 0 $$\n根据微积分基本定理，第一项是穿过控制体边界的净通量：\n$$ \\left[x^2 \\frac{dy}{dx}\\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i+1/2}} - \\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i-1/2}} $$\n导数项使用二阶中心差分进行近似：\n$$ \\left. \\frac{dy}{dx} \\right|_{x_{i+1/2}} \\approx \\frac{y_{i+1} - y_i}{h}, \\qquad \\left. \\frac{dy}{dx} \\right|_{x_{i-1/2}} \\approx \\frac{y_i - y_{i-1}}{h} $$\n反应（汇）项通过假设在控制体积内 $y(x) \\approx y_i$ 来近似：\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi^2 x^2 y(x) dx \\approx \\phi^2 y_i \\int_{x_i-h/2}^{x_i+h/2} x^2 dx = \\phi^2 y_i \\frac{1}{3} \\left[x^3\\right]_{x_i-h/2}^{x_i+h/2} $$\n对于均匀网格，这个积分很复杂。一个更简单且同样有效的二阶方法是在节点 $x_i$ 处近似微分方程：\n$$ \\frac{\\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i+1/2}} - \\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i-1/2}}}{h} - \\phi^2 x_i^2 y_i = 0 $$\n代入导数的有限差分近似，得到：\n$$ \\frac{1}{h} \\left( x_{i+1/2}^2 \\frac{y_{i+1} - y_i}{h} - x_{i-1/2}^2 \\frac{y_i - y_{i-1}}{h} \\right) - \\phi^2 x_i^2 y_i = 0 $$\n整理后可得内部节点 $i$（其中 $1 \\le i \\le N-2$）的线性方程：\n$$ \\left(\\frac{x_{i-1/2}^2}{h^2}\\right) y_{i-1} - \\left(\\frac{x_{i+1/2}^2 + x_{i-1/2}^2}{h^2} + \\phi^2 x_i^2\\right) y_i + \\left(\\frac{x_{i+1/2}^2}{h^2}\\right) y_{i+1} = 0 $$\n\n为了处理 $x=0$ 处的奇点，我们分析当 $x \\to 0$ 时常微分方程的行为。对称条件 $y'(0)=0$ 意味着 $y(x)$ 在 $x=0$ 附近的泰勒级数具有 $y(x) = y(0) + a_2 x^2 + O(x^4)$ 的形式。对展开形式的常微分方程 $y'' + (2/x)y' - \\phi^2 y = 0$ 取 $x \\to 0$ 的极限，并对 $(2/x)y'$ 项应用洛必达法则（L'Hôpital's rule），得到 $\\lim_{x\\to 0}(y'' + 2y'' - \\phi^2 y) = 3y''(0) - \\phi^2 y(0) = 0$。\n我们对 $y''(0)$ 使用一个二阶有限差分，该差分引入一个“虚拟点” $y_{-1}$ 并利用对称条件 $y_{-1}=y_1$：\n$$ y''(0) \\approx \\frac{y_1 - 2y_0 + y_{-1}}{h^2} = \\frac{2y_1 - 2y_0}{h^2} $$\n将此代入极限形式的常微分方程，得到中心节点（$i=0$）的方程：\n$$ 3 \\left(\\frac{2y_1 - 2y_0}{h^2}\\right) - \\phi^2 y_0 = 0 \\implies -(6 + h^2 \\phi^2) y_0 + 6 y_1 = 0 $$\n这提供了我们线性系统的第一个方程。\n\n表面的边界条件是 $y(1)=1$，这设定了 $y_{N-1}=1$。这是一个狄利克雷条件。因此，未知数是 $y_0, y_1, \\dots, y_{N-2}$。最后一个未知节点 $i=N-2$ 的方程是：\n$$ \\left(\\frac{x_{N-5/2}^2}{h^2}\\right) y_{N-3} - \\left(\\frac{x_{N-3/2}^2 + x_{N-5/2}^2}{h^2} + \\phi^2 x_{N-2}^2\\right) y_{N-2} + \\left(\\frac{x_{N-3/2}^2}{h^2}\\right) y_{N-1} = 0 $$\n由于 $y_{N-1}=1$ 是已知的，该项被移到线性系统 $A\\vec{y}=\\vec{b}$ 的右侧。得到的系统是三对角系统，可以被高效求解。\n\n求解出浓度分布 $\\{y_i\\}$ 后，通过对其定义进行数值积分来计算有效因子 $\\eta$：\n$$ \\eta = 3 \\int_{0}^{1} y(x) x^2 dx $$\n为了获得高精度，我们使用辛普森法则（Simpson's rule），这是一种四阶求积方法，正如在 `scipy.integrate.simpson` 中实现的那样。该函数可以处理奇数个区间，我们的网格（$N=4000$ 个节点， $N-1=3999$ 个区间）恰好符合。\n\n**2. 解析解**\n\n通过代换 $u(x) = x y(x)$，可以简化常微分方程 $y'' + (2/x)y' - \\phi^2 y = 0$。这将常微分方程转换为一个标准的常系数线性二阶方程：\n$$ u'' - \\phi^2 u = 0 $$\n$u(x)$ 的通解是 $u(x) = C_1 \\cosh(\\phi x) + C_2 \\sinh(\\phi x)$。因此，$y(x)$ 的解为：\n$$ y(x) = \\frac{u(x)}{x} = \\frac{C_1 \\cosh(\\phi x) + C_2 \\sinh(\\phi x)}{x} $$\n利用边界条件来确定常数 $C_1$ 和 $C_2$。\n中心（$x=0$）浓度有限的条件要求 $\\lim_{x\\to 0} y(x)$ 为有限值。由于 $\\lim_{x\\to 0} \\cosh(\\phi x)/x \\to \\infty$ 且 $\\lim_{x\\to 0} \\sinh(\\phi x)/x = \\phi$，为了得到一个有物理意义的解，我们必须有 $C_1=0$。\n当 $C_1=0$ 时，解变为 $y(x) = C_2 \\frac{\\sinh(\\phi x)}{x}$。对称条件 $y'(0)=0$ 自动得到满足。\n表面边界条件 $y(1)=1$ 给出 $1 = C_2 \\frac{\\sinh(\\phi)}{1}$，因此 $C_2 = 1/\\sinh(\\phi)$。\n浓度分布的解析解是：\n$$ y(x) = \\frac{\\sinh(\\phi x)}{x \\sinh(\\phi)} $$\n为了求得解析有效因子 $\\eta_{\\mathrm{ana}}$，我们将此表达式代入 $\\eta$ 的定义中：\n$$ \\eta_{\\mathrm{ana}} = 3 \\int_{0}^{1} \\left(\\frac{\\sinh(\\phi x)}{x \\sinh(\\phi)}\\right) x^2 dx = \\frac{3}{\\sinh(\\phi)} \\int_{0}^{1} x \\sinh(\\phi x) dx $$\n使用分部积分法，我们得到 $\\int x \\sinh(\\phi x) dx = \\frac{x}{\\phi}\\cosh(\\phi x) - \\frac{1}{\\phi^2}\\sinh(\\phi x)$。\n计算从 $0$ 到 $1$ 的定积分并代回，得到熟知的结果：\n$$ \\eta_{\\mathrm{ana}} = \\frac{3}{\\phi^2} (\\phi \\coth(\\phi) - 1) $$\n对于较小的 $\\phi$，由于灾难性抵消，该公式在数值上是不稳定的。我们使用 $\\phi \\coth(\\phi) = 1 + \\frac{\\phi^2}{3} - \\frac{\\phi^4}{45} + O(\\phi^6)$ 的泰勒级数展开来推导适用于小 $\\phi$ 值的稳定近似式：\n$$ \\eta_{\\mathrm{ana}} \\approx \\frac{3}{\\phi^2} \\left( \\left(1 + \\frac{\\phi^2}{3} - \\frac{\\phi^4}{45} + \\dots \\right) - 1 \\right) = 1 - \\frac{\\phi^2}{15} + \\frac{2\\phi^4}{315} - \\dots $$\n在实现中，对于 $\\phi  10^{-4}$ 的情况，我们从标准公式切换到此级数展开，以确保在所有测试值上都能获得高精度。\n\n最后，我们为每个指定的希勒模数计算绝对误差 $|\\eta_{\\mathrm{num}} - \\eta_{\\mathrm{ana}}|$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\nfrom scipy.integrate import simpson\n\ndef solve_bvp(phi, N):\n    \"\"\"\n    Solves the dimensionless diffusion-reaction BVP using a finite-difference scheme.\n\n    Args:\n        phi (float): The Thiele modulus.\n        N (int): The number of grid points.\n\n    Returns:\n        tuple[np.ndarray, np.ndarray]: The grid points (x) and the concentration profile (y).\n    \"\"\"\n    h = 1.0 / (N - 1)\n    x_full = np.linspace(0, 1, N)\n\n    # The number of unknowns is N-1, corresponding to y_0, ..., y_{N-2}\n    M = N - 1\n\n    # `ab` is the matrix in banded form [u, d, l] for solve_banded\n    # ab[0,:] = super-diagonal (u)\n    # ab[1,:] = main diagonal (d)\n    # ab[2,:] = sub-diagonal (l)\n    # We will build it as [l, d, u] and then roll it.\n    ab = np.zeros((3, M))\n    b = np.zeros(M)\n    \n    # Equation for node i=0\n    # -(6 + h^2*phi^2)*y_0 + 6*y_1 = 0\n    ab[1, 0] = -(6.0 + phi**2 * h**2)\n    ab[0, 1] = 6.0\n    b[0] = 0.0\n\n    # Equations for interior nodes i=1 to N-3 (last unknown is y_{N-2})\n    for i in range(1, N - 2):\n        x_i = i * h\n        x_half_plus_sq = ((i + 0.5) * h)**2\n        x_half_minus_sq = ((i - 0.5) * h)**2\n        \n        ab[2, i - 1] = x_half_minus_sq / h**2  # Lower diagonal (coeff of y_{i-1})\n        ab[1, i] = -(x_half_plus_sq + x_half_minus_sq) / h**2 - phi**2 * x_i**2  # Main diagonal (coeff of y_i)\n        ab[0, i + 1] = x_half_plus_sq / h**2  # Upper diagonal (coeff of y_{i+1})\n        b[i] = 0.0\n\n    # Equation for last unknown node i=N-2\n    i = N - 2\n    x_i = i * h\n    x_half_plus_sq = ((i + 0.5) * h)**2\n    x_half_minus_sq = ((i - 0.5) * h)**2\n    \n    ab[2, i - 1] = x_half_minus_sq / h**2 # Lower diagonal\n    ab[1, i] = -(x_half_plus_sq + x_half_minus_sq) / h**2 - phi**2 * x_i**2 # Main diagonal\n    # The y_{N-1} term moves to the RHS\n    b[i] = -x_half_plus_sq / h**2  # * y_{N-1} which is 1.0\n\n    # Solve the tridiagonal system Ay=b\n    y_unknowns = solve_banded((1, 1), ab, b)\n    \n    # Reconstruct the full solution vector, including the boundary value y(1)=1\n    y_full = np.append(y_unknowns, 1.0)\n    \n    return x_full, y_full\n\ndef calculate_numerical_eta(x, y):\n    \"\"\"\n    Calculates the effectiveness factor eta using numerical quadrature.\n\n    Args:\n        x (np.ndarray): The grid points.\n        y (np.ndarray): The concentration profile.\n\n    Returns:\n        float: The numerical effectiveness factor.\n    \"\"\"\n    integrand = y * x**2\n    integral_val = simpson(integrand, x)\n    return 3.0 * integral_val\n\ndef calculate_analytical_eta(phi):\n    \"\"\"\n    Calculates the analytical effectiveness factor for a sphere.\n    This implementation is numerically stable for small and large phi.\n\n    Args:\n        phi (float): The Thiele modulus.\n\n    Returns:\n        float: The analytical effectiveness factor.\n    \"\"\"\n    if np.abs(phi)  1e-4:\n        # For very small phi, use Taylor series to avoid catastrophic cancellation\n        # eta = 1 - phi^2/15 + 2*phi^4/315 - O(phi^6)\n        phi2 = phi**2\n        return 1.0 - phi2 / 15.0 + 2.0 * phi2**2 / 315.0\n    else:\n        # Standard formula for phi  0\n        coth_val = np.cosh(phi) / np.sinh(phi)\n        return (3.0 / phi**2) * (phi * coth_val - 1.0)\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    test_cases = [0.01, 0.10, 1.00, 5.00, 50.00]\n    N = 4000\n    \n    errors = []\n    \n    for phi in test_cases:\n        # 1. Solve BVP numerically\n        x, y_num = solve_bvp(phi, N)\n        \n        # 2. Calculate numerical effectiveness factor\n        eta_num = calculate_numerical_eta(x, y_num)\n        \n        # 3. Calculate analytical effectiveness factor\n        eta_ana = calculate_analytical_eta(phi)\n        \n        # 4. Calculate absolute error and round\n        error = np.abs(eta_num - eta_ana)\n        errors.append(round(error, 10))\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{e:.10f}' for e in errors)}]\")\n\nsolve()\n```"
        }
    ]
}