{
    "hands_on_practices": [
        {
            "introduction": "The Thiele modulus, $\\phi$, is the cornerstone for analyzing internal mass transfer limitations, providing a direct comparison between the characteristic rate of reaction and the rate of diffusion. This first exercise  serves as a critical check on fundamentals, focusing on the correct calculation of this dimensionless group. Mastering the dimensional consistency among the catalyst characteristic length, the intrinsic rate constant, and the effective diffusivity is a non-negotiable first step before tackling more complex effectiveness factor calculations.",
            "id": "1527052",
            "problem": "A chemical engineer is tasked with evaluating the performance of a packed-bed reactor designed for a gas-phase isomerization reaction, $A \\rightarrow B$. The reaction is catalyzed by spherical porous pellets and is experimentally confirmed to follow first-order kinetics with respect to reactant A.\n\nThe following data has been collected:\n- The intrinsic first-order rate constant, $k$, determined using finely crushed catalyst particles to eliminate diffusional resistance, is $0.85 \\, \\text{s}^{-1}$.\n- The effective diffusivity of reactant A within the porous structure of a catalyst pellet, $D_e$, is $2.0 \\times 10^{-8} \\, \\text{m}^2/\\text{s}$.\n- The radius of the spherical catalyst pellets used in the packed-bed reactor, $R$, is $1.5 \\, \\text{mm}$.\n\nThe engineer needs to calculate the Thiele modulus, $\\phi$, to assess the significance of internal mass transfer limitations. For a first-order reaction occurring in a spherical particle, the Thiele modulus is defined as:\n$$\n\\phi = R \\sqrt{\\frac{k}{D_e}}\n$$\nA critical requirement for this formula is that the resulting Thiele modulus must be a dimensionless quantity, which necessitates a consistent set of units for all physical parameters. Calculate the correct, dimensionless value for the Thiele modulus based on the provided data.\n\nRound your final answer to three significant figures.",
            "solution": "We start from the definition for a first-order reaction in a spherical pellet:\n$$\n\\phi = R \\sqrt{\\frac{k}{D_{e}}}.\n$$\nTo ensure that $\\phi$ is dimensionless, verify the units. With $[k] = \\text{s}^{-1}$ and $[D_{e}] = \\text{m}^{2}\\,\\text{s}^{-1}$, the units of the ratio are\n$$\n\\left[\\frac{k}{D_{e}}\\right] = \\frac{\\text{s}^{-1}}{\\text{m}^{2}\\,\\text{s}^{-1}} = \\text{m}^{-2},\n$$\nso $\\sqrt{k/D_{e}}$ has units of $\\text{m}^{-1}$, and multiplying by $R$ (with units of $\\text{m}$) yields a dimensionless $\\phi$, as required.\n\nConvert the pellet radius to meters:\n$$\nR = 1.5\\,\\text{mm} = 1.5 \\times 10^{-3}\\,\\text{m}.\n$$\nCompute the ratio $k/D_{e}$:\n$$\n\\frac{k}{D_{e}} = \\frac{0.85\\,\\text{s}^{-1}}{2.0 \\times 10^{-8}\\,\\text{m}^{2}\\,\\text{s}^{-1}} = 4.25 \\times 10^{7}\\,\\text{m}^{-2}.\n$$\nTake the square root:\n$$\n\\sqrt{\\frac{k}{D_{e}}} = \\sqrt{4.25 \\times 10^{7}} = \\sqrt{4.25}\\times 10^{3}\\sqrt{10} \\approx 6.5192 \\times 10^{3}\\,\\text{m}^{-1}.\n$$\nMultiply by $R$ to obtain the Thiele modulus:\n$$\n\\phi = \\left(1.5 \\times 10^{-3}\\,\\text{m}\\right)\\left(6.5192 \\times 10^{3}\\,\\text{m}^{-1}\\right) = 9.7788.\n$$\nRounding to three significant figures gives\n$$\n\\phi = 9.78.\n$$\nThis value is dimensionless, satisfying the requirement.",
            "answer": "$$\\boxed{9.78}$$"
        },
        {
            "introduction": "Moving beyond the classic first-order case, this practice explores the unique behavior of zero-order reactions within a porous catalyst, a scenario relevant to reactions under high reactant concentrations. You will derive the effectiveness factor for a situation where the reactant is completely consumed before reaching the catalyst's center, creating a \"dead zone\" where no reaction occurs. This exercise  challenges you to solve the diffusion-reaction problem from first principles for this strongly diffusion-limited regime, providing deeper insight into how reaction kinetics influence catalyst utilization.",
            "id": "1527083",
            "problem": "A heterogeneous catalytic reaction, $A \\rightarrow B$, is used to remove a pollutant from an industrial waste stream. The reaction is zero-order with respect to the pollutant $A$, with a constant volumetric reaction rate of $k_0$. The catalyst is shaped into large, flat plates of half-thickness $L$. The concentration of reactant $A$ at the outer surface of a plate is maintained at a constant value, $C_{As}$, and the effective diffusivity of $A$ within the porous catalyst is $D_e$.\n\nThe process is operated at a steady state under strongly diffusion-limited conditions. This means reactant $A$ is completely consumed before it can penetrate to the center of the catalyst plate. Specifically, the concentration of $A$ is zero in a central region of the plate. The boundary of this \"dead zone,\" where the reactant concentration first drops to zero, is located at a distance of $z = L/2$ from the center of the plate ($z=0$).\n\nCalculate the catalyst effectiveness factor, $\\eta$, under these specific operating conditions. The effectiveness factor is defined as the ratio of the actual overall reaction rate within the catalyst to the reaction rate that would be achieved if the entire catalyst volume were exposed to the surface concentration $C_{As}$. Provide the answer as an exact numerical value.",
            "solution": "Let the slab have surfaces at $z=\\pm L$ and center at $z=0$. Under steady state diffusion with zero-order consumption in the region where $A$ is present, the one-dimensional species balance is\n$$\n\\frac{d}{dz}\\left(-D_{e}\\frac{dC_{A}}{dz}\\right)=-r_{A},\\quad r_{A}=k_{0}\\ \\text{where}\\ C_{A}0,\n$$\nwhich reduces in the reactive region to\n$$\nD_{e}\\frac{d^{2}C_{A}}{dz^{2}}=k_{0}.\n$$\nA central dead zone exists where $C_{A}=0$ and no reaction occurs. Continuity of concentration and flux at the boundary of the dead zone implies at the penetration boundary $z=z_{p}$ that\n$$\nC_{A}(z_{p})=0,\\qquad \\left.\\frac{dC_{A}}{dz}\\right|_{z_{p}}=0.\n$$\nSolving the differential equation in the reactive shell $z\\in[z_{p},L]$ with these conditions gives\n$$\nC_{A}(z)=\\frac{k_{0}}{2D_{e}}(z-z_{p})^{2},\n$$\nand the surface condition $C_{A}(L)=C_{As}$ implies\n$$\nC_{As}=\\frac{k_{0}}{2D_{e}}(L-z_{p})^{2}.\n$$\nThe actual overall reaction rate per unit external area is the integral of the volumetric rate over the reactive regions on both sides:\n$$\nR_{\\text{actual}}'=\\int_{-L}^{L}r_{A}(z)\\,dz=2\\,k_{0}\\,(L-z_{p}),\n$$\nbecause $r_{A}=k_{0}$ over each reactive shell of thickness $(L-z_{p})$ and zero in the dead zone. If the entire catalyst volume were exposed to $C_{As}$, the volumetric rate would be $k_{0}$ everywhere, giving\n$$\nR_{\\text{ideal}}'=2L\\,k_{0}.\n$$\nHence, the effectiveness factor is\n$$\n\\eta=\\frac{R_{\\text{actual}}'}{R_{\\text{ideal}}'}=\\frac{2k_{0}(L-z_{p})}{2Lk_{0}}=\\frac{L-z_{p}}{L}.\n$$\nUnder the stated condition that the dead-zone boundary is at $z_{p}=L/2$, this becomes\n$$\n\\eta=\\frac{L-\\frac{L}{2}}{L}=\\frac{1}{2}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "This advanced practice transitions from analytical solutions to the computational methods that are central to modern catalytic engineering and design. You will develop and implement a finite-difference scheme to numerically solve the reaction-diffusion boundary value problem within a spherical catalyst pellet. By building a solver and validating your numerical results against the well-known analytical solution, this capstone exercise  provides hands-on experience with the tools used to model and predict catalyst performance under realistic conditions.",
            "id": "3902605",
            "problem": "Consider an isothermal, porous, spherical catalyst pellet in which a single irreversible first-order reaction takes place under steady state with no external mass-transfer resistance and constant effective diffusivity. Begin from species conservation and Fick’s law as the fundamental base to obtain the dimensionless boundary-value problem for the dimensionless concentration profile. Let $x \\in [0,1]$ be the dimensionless radial coordinate, $x = r/R$, and let $y(x)$ be the dimensionless concentration, $y = c/c_{s}$, where $c_{s}$ is the surface concentration. The dimensionless group is the Thiele modulus $\\phi$, defined by $\\phi^{2} = R^{2} k_{\\mathrm{eff}}/D_{\\mathrm{eff}}$, where $R$ is the pellet radius, $k_{\\mathrm{eff}}$ the effective first-order rate constant, and $D_{\\mathrm{eff}}$ the effective diffusivity. The steady-state spherical diffusion-reaction equation can be written in dimensionless form as a second-order Ordinary Differential Equation (ODE):\n$$(1/x^{2}) \\, \\dfrac{d}{dx} \\!\\left(x^{2} \\dfrac{dy}{dx}\\right) - \\phi^{2} y = 0 \\quad \\text{for} \\quad x \\in (0,1),$$\nsubject to the symmetry and Dirichlet boundary conditions\n$$\\left.\\dfrac{dy}{dx}\\right|_{x=0} = 0, \\qquad y(1) = 1.$$\nThe effectiveness factor $\\eta$ is defined (by its fundamental definition) as the dimensionless volume-averaged reaction rate normalized by the rate at the surface concentration, i.e.,\n$$\\eta = 3 \\int_{0}^{1} y(x)\\, x^{2}\\, dx.$$\nYour task is to design and implement a second-order, conservative, finite-difference scheme on a uniform grid to approximate $y(x)$ and then compute $\\eta$ by numerically integrating the definition above. The numerical method must:\n- Discretize the spherical operator in conservative form to avoid the singularity at $x = 0$.\n- Enforce the symmetry boundary condition at the center and the Dirichlet boundary condition at the surface.\n- Assemble the resulting linear system and solve it.\n- Compute $\\eta$ using a high-accuracy quadrature on the same grid.\n\nThen, independently compute the analytical effectiveness factor for a first-order reaction in a sphere as a function of the Thiele modulus $\\phi$ (do not assume or quote any “shortcut” result without derivation; treat it as a known result you verify against). Use a numerically stable implementation that remains accurate for very small and very large $\\phi$.\n\nTest Suite:\n- Use a uniform grid with $N = 4000$ nodes over $x \\in [0,1]$.\n- Evaluate the absolute error between the numerical and analytical effectiveness factors for the following Thiele moduli: $\\phi \\in \\{0.01, 0.10, 1.00, 5.00, 50.00\\}$.\n\nAnswer specification:\n- For each $\\phi$ in the test suite, compute the absolute error $|\\eta_{\\mathrm{num}} - \\eta_{\\mathrm{ana}}|$ and round it to $10$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\,[0.0000000001,0.0000000002,0.0000000003,0.0000000004,0.0000000005]\\,).$\n- All quantities in this problem are dimensionless, so no physical units are required in the output.",
            "solution": "The user-provided problem is a well-posed and scientifically grounded boundary-value problem from the field of chemical reaction engineering, and is therefore deemed valid. We proceed with a complete solution.\n\nThe problem requires a numerical and analytical treatment of a steady-state, one-dimensional, isothermal diffusion-reaction system in a spherical catalyst pellet.\n\nThe governing dimensionless differential equation for the concentration profile $y(x)$ is:\n$$ \\frac{1}{x^2} \\frac{d}{dx} \\left(x^2 \\frac{dy}{dx}\\right) - \\phi^2 y = 0 \\quad \\text{for} \\quad x \\in (0,1) $$\nwith boundary conditions:\n$$ \\left.\\frac{dy}{dx}\\right|_{x=0} = 0, \\qquad y(1) = 1 $$\nwhere $y$ is the dimensionless concentration, $x$ is the dimensionless radial position, and $\\phi$ is the Thiele modulus.\n\n**1. Numerical Solution: Conservative Finite-Difference Method**\n\nTo obtain a numerical solution, we discretize the domain $x \\in [0,1]$ using a uniform grid with $N$ nodes: $x_i = i h$ for $i=0, 1, \\dots, N-1$, where the step size is $h = 1/(N-1)$. The value of the function at node $x_i$ is denoted by $y_i \\approx y(x_i)$.\n\nThe ODE is first written in its conservative form by multiplying by $x^2$:\n$$ \\frac{d}{dx} \\left(x^2 \\frac{dy}{dx}\\right) - \\phi^2 x^2 y = 0 $$\nWe discretize this equation using a finite-volume approach, which is inherently conservative. For an interior node $x_i$ ($1 \\le i \\le N-2$), we integrate the equation over a control volume $[x_{i-1/2}, x_{i+1/2}]$, where $x_{i \\pm 1/2} = x_i \\pm h/2$.\n\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx} \\left(x^2 \\frac{dy}{dx}\\right) dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi^2 x^2 y(x) dx = 0 $$\nThe first term, by the fundamental theorem of calculus, is the net flux across the control volume boundaries:\n$$ \\left[x^2 \\frac{dy}{dx}\\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i+1/2}} - \\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i-1/2}} $$\nThe derivative terms are approximated using second-order central differences:\n$$ \\left. \\frac{dy}{dx} \\right|_{x_{i+1/2}} \\approx \\frac{y_{i+1} - y_i}{h}, \\qquad \\left. \\frac{dy}{dx} \\right|_{x_{i-1/2}} \\approx \\frac{y_i - y_{i-1}}{h} $$\nThe reaction (sink) term is approximated by assuming $y(x) \\approx y_i$ within the control volume:\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi^2 x^2 y(x) dx \\approx \\phi^2 y_i \\int_{x_i-h/2}^{x_i+h/2} x^2 dx = \\phi^2 y_i \\frac{1}{3} \\left[x^3\\right]_{x_i-h/2}^{x_i+h/2} $$\nFor a uniform grid, this integral is complex. A simpler and equally valid second-order approach is to approximate the differential equation at the node $x_i$:\n$$ \\frac{\\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i+1/2}} - \\left. \\left(x^2 \\frac{dy}{dx}\\right) \\right|_{x_{i-1/2}}}{h} - \\phi^2 x_i^2 y_i = 0 $$\nSubstituting the finite-difference approximations for the derivatives yields:\n$$ \\frac{1}{h} \\left( x_{i+1/2}^2 \\frac{y_{i+1} - y_i}{h} - x_{i-1/2}^2 \\frac{y_i - y_{i-1}}{h} \\right) - \\phi^2 x_i^2 y_i = 0 $$\nRearranging gives the linear equation for an interior node $i$ (where $1 \\le i \\le N-2$):\n$$ \\left(\\frac{x_{i-1/2}^2}{h^2}\\right) y_{i-1} - \\left(\\frac{x_{i+1/2}^2 + x_{i-1/2}^2}{h^2} + \\phi^2 x_i^2\\right) y_i + \\left(\\frac{x_{i+1/2}^2}{h^2}\\right) y_{i+1} = 0 $$\n\nTo handle the singularity at $x=0$, we analyze the ODE as $x \\to 0$. The symmetry condition $y'(0)=0$ implies that the Taylor series of $y(x)$ around $x=0$ has the form $y(x) = y(0) + a_2 x^2 + O(x^4)$. Taking the limit of the expanded form of the ODE, $y'' + (2/x)y' - \\phi^2 y = 0$, as $x \\to 0$ and applying L'Hôpital's rule to the term $(2/x)y'$ gives $\\lim_{x\\to 0}(y'' + 2y'' - \\phi^2 y) = 3y''(0) - \\phi^2 y(0) = 0$.\nWe use a second-order finite difference for $y''(0)$ that incorporates a \"ghost point\" $y_{-1}$ and the symmetry condition $y_{-1}=y_1$:\n$$ y''(0) \\approx \\frac{y_1 - 2y_0 + y_{-1}}{h^2} = \\frac{2y_1 - 2y_0}{h^2} $$\nSubstituting this into the limiting ODE form gives the equation for the center node ($i=0$):\n$$ 3 \\left(\\frac{2y_1 - 2y_0}{h^2}\\right) - \\phi^2 y_0 = 0 \\implies -(6 + h^2 \\phi^2) y_0 + 6 y_1 = 0 $$\nThis provides the first equation of our linear system.\n\nThe boundary condition at the surface is $y(1)=1$, which sets $y_{N-1}=1$. This is a Dirichlet condition. The unknowns are thus $y_0, y_1, \\dots, y_{N-2}$. The equation for the last unknown node, $i=N-2$, is:\n$$ \\left(\\frac{x_{N-5/2}^2}{h^2}\\right) y_{N-3} - \\left(\\frac{x_{N-3/2}^2 + x_{N-5/2}^2}{h^2} + \\phi^2 x_{N-2}^2\\right) y_{N-2} + \\left(\\frac{x_{N-3/2}^2}{h^2}\\right) y_{N-1} = 0 $$\nSince $y_{N-1}=1$ is known, this term is moved to the right-hand side of the linear system, $A\\vec{y}=\\vec{b}$. The resulting system is tridiagonal and can be efficiently solved.\n\nAfter solving for the concentration profile $\\{y_i\\}$, the effectiveness factor $\\eta$ is computed by numerically integrating its definition:\n$$ \\eta = 3 \\int_{0}^{1} y(x) x^2 dx $$\nFor high accuracy, we use Simpson's rule, a fourth-order quadrature method, as implemented in `scipy.integrate.simpson`. This function can handle an odd number of intervals, which our grid ($N=4000$ nodes, $N-1=3999$ intervals) possesses.\n\n**2. Analytical Solution**\n\nThe ODE $y'' + (2/x)y' - \\phi^2 y = 0$ can be simplified by the substitution $u(x) = x y(x)$. This transforms the ODE into a standard linear second-order equation with constant coefficients:\n$$ u'' - \\phi^2 u = 0 $$\nThe general solution for $u(x)$ is $u(x) = C_1 \\cosh(\\phi x) + C_2 \\sinh(\\phi x)$. The solution for $y(x)$ is therefore:\n$$ y(x) = \\frac{u(x)}{x} = \\frac{C_1 \\cosh(\\phi x) + C_2 \\sinh(\\phi x)}{x} $$\nThe boundary conditions are used to find the constants $C_1$ and $C_2$.\nThe condition of a finite concentration at the center ($x=0$) requires that $\\lim_{x\\to 0} y(x)$ be finite. Since $\\lim_{x\\to 0} \\cosh(\\phi x)/x \\to \\infty$ and $\\lim_{x\\to 0} \\sinh(\\phi x)/x = \\phi$, we must have $C_1=0$ for a physically meaningful solution.\nWith $C_1=0$, the solution becomes $y(x) = C_2 \\frac{\\sinh(\\phi x)}{x}$. The symmetry condition $y'(0)=0$ is automatically satisfied.\nThe surface boundary condition $y(1)=1$ gives $1 = C_2 \\frac{\\sinh(\\phi)}{1}$, so $C_2 = 1/\\sinh(\\phi)$.\nThe analytical solution for the concentration profile is:\n$$ y(x) = \\frac{\\sinh(\\phi x)}{x \\sinh(\\phi)} $$\nTo find the analytical effectiveness factor, $\\eta_{\\mathrm{ana}}$, we substitute this expression into the definition of $\\eta$:\n$$ \\eta_{\\mathrm{ana}} = 3 \\int_{0}^{1} \\left(\\frac{\\sinh(\\phi x)}{x \\sinh(\\phi)}\\right) x^2 dx = \\frac{3}{\\sinh(\\phi)} \\int_{0}^{1} x \\sinh(\\phi x) dx $$\nUsing integration by parts, we find $\\int x \\sinh(\\phi x) dx = \\frac{x}{\\phi}\\cosh(\\phi x) - \\frac{1}{\\phi^2}\\sinh(\\phi x)$.\nEvaluating the definite integral from $0$ to $1$ and substituting back gives the well-known result:\n$$ \\eta_{\\mathrm{ana}} = \\frac{3}{\\phi^2} (\\phi \\coth(\\phi) - 1) $$\nFor small $\\phi$, this formula is numerically unstable due to catastrophic cancellation. We use the Taylor series expansion of $\\phi \\coth(\\phi) = 1 + \\frac{\\phi^2}{3} - \\frac{\\phi^4}{45} + O(\\phi^6)$ to derive a stable approximation for small $\\phi$:\n$$ \\eta_{\\mathrm{ana}} \\approx \\frac{3}{\\phi^2} \\left( \\left(1 + \\frac{\\phi^2}{3} - \\frac{\\phi^4}{45} + \\dots \\right) - 1 \\right) = 1 - \\frac{\\phi^2}{15} + \\frac{2\\phi^4}{315} - \\dots $$\nIn the implementation, we switch from the standard formula to this series expansion for $\\phi  10^{-4}$ to ensure high accuracy across all tested values.\n\nFinally, we compute the absolute error $|\\eta_{\\mathrm{num}} - \\eta_{\\mathrm{ana}}|$ for each specified Thiele modulus.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\nfrom scipy.integrate import simpson\n\ndef solve_bvp(phi, N):\n    \"\"\"\n    Solves the dimensionless diffusion-reaction BVP using a finite-difference scheme.\n\n    Args:\n        phi (float): The Thiele modulus.\n        N (int): The number of grid points.\n\n    Returns:\n        tuple[np.ndarray, np.ndarray]: The grid points (x) and the concentration profile (y).\n    \"\"\"\n    h = 1.0 / (N - 1)\n    x_full = np.linspace(0, 1, N)\n\n    # The number of unknowns is N-1, corresponding to y_0, ..., y_{N-2}\n    M = N - 1\n\n    # `ab` is the matrix in banded form [u, d, l] for solve_banded\n    # ab[0,:] = super-diagonal (u)\n    # ab[1,:] = main diagonal (d)\n    # ab[2,:] = sub-diagonal (l)\n    # We will build it as [l, d, u] and then roll it.\n    ab = np.zeros((3, M))\n    b = np.zeros(M)\n    \n    # Equation for node i=0\n    # -(6 + h^2*phi^2)*y_0 + 6*y_1 = 0\n    ab[1, 0] = -(6.0 + phi**2 * h**2)\n    ab[0, 1] = 6.0\n    b[0] = 0.0\n\n    # Equations for interior nodes i=1 to N-3 (last unknown is y_{N-2})\n    for i in range(1, N - 2):\n        x_i = i * h\n        x_half_plus_sq = ((i + 0.5) * h)**2\n        x_half_minus_sq = ((i - 0.5) * h)**2\n        \n        ab[2, i - 1] = x_half_minus_sq / h**2  # Lower diagonal (coeff of y_{i-1})\n        ab[1, i] = -(x_half_plus_sq + x_half_minus_sq) / h**2 - phi**2 * x_i**2  # Main diagonal (coeff of y_i)\n        ab[0, i + 1] = x_half_plus_sq / h**2  # Upper diagonal (coeff of y_{i+1})\n        b[i] = 0.0\n\n    # Equation for last unknown node i=N-2\n    i = N - 2\n    x_i = i * h\n    x_half_plus_sq = ((i + 0.5) * h)**2\n    x_half_minus_sq = ((i - 0.5) * h)**2\n    \n    ab[2, i - 1] = x_half_minus_sq / h**2 # Lower diagonal\n    ab[1, i] = -(x_half_plus_sq + x_half_minus_sq) / h**2 - phi**2 * x_i**2 # Main diagonal\n    # The y_{N-1} term moves to the RHS\n    b[i] = -x_half_plus_sq / h**2  # * y_{N-1} which is 1.0\n\n    # Solve the tridiagonal system Ay=b\n    y_unknowns = solve_banded((1, 1), ab, b)\n    \n    # Reconstruct the full solution vector, including the boundary value y(1)=1\n    y_full = np.append(y_unknowns, 1.0)\n    \n    return x_full, y_full\n\ndef calculate_numerical_eta(x, y):\n    \"\"\"\n    Calculates the effectiveness factor eta using numerical quadrature.\n\n    Args:\n        x (np.ndarray): The grid points.\n        y (np.ndarray): The concentration profile.\n\n    Returns:\n        float: The numerical effectiveness factor.\n    \"\"\"\n    integrand = y * x**2\n    integral_val = simpson(integrand, x)\n    return 3.0 * integral_val\n\ndef calculate_analytical_eta(phi):\n    \"\"\"\n    Calculates the analytical effectiveness factor for a sphere.\n    This implementation is numerically stable for small and large phi.\n\n    Args:\n        phi (float): The Thiele modulus.\n\n    Returns:\n        float: The analytical effectiveness factor.\n    \"\"\"\n    if np.abs(phi)  1e-4:\n        # For very small phi, use Taylor series to avoid catastrophic cancellation\n        # eta = 1 - phi^2/15 + 2*phi^4/315 - O(phi^6)\n        phi2 = phi**2\n        return 1.0 - phi2 / 15.0 + 2.0 * phi2**2 / 315.0\n    else:\n        # Standard formula for phi  0\n        coth_val = np.cosh(phi) / np.sinh(phi)\n        return (3.0 / phi**2) * (phi * coth_val - 1.0)\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    test_cases = [0.01, 0.10, 1.00, 5.00, 50.00]\n    N = 4000\n    \n    errors = []\n    \n    for phi in test_cases:\n        # 1. Solve BVP numerically\n        x, y_num = solve_bvp(phi, N)\n        \n        # 2. Calculate numerical effectiveness factor\n        eta_num = calculate_numerical_eta(x, y_num)\n        \n        # 3. Calculate analytical effectiveness factor\n        eta_ana = calculate_analytical_eta(phi)\n        \n        # 4. Calculate absolute error and round\n        error = np.abs(eta_num - eta_ana)\n        errors.append(round(error, 10))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, errors))}]\")\n\nsolve()\n```"
        }
    ]
}