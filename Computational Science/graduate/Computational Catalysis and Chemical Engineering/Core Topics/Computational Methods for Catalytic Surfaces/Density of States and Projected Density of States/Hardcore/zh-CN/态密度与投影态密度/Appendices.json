{
    "hands_on_practices": [
        {
            "introduction": "自由电子气模型是理解金属电子结构最基本的出发点。通过从第一性原理出发，本练习将引导你推导三维自由电子气态密度$D(E)$的经典表达式。掌握这一推导过程不仅能帮助你理解简单金属中态密度与能量的平方根关系（$D(E) \\propto \\sqrt{E}$）的来源，也为理解更复杂材料的电子态密度提供了重要的理论基准 。",
            "id": "3877242",
            "problem": "在计算催化中，金属载体通常被近似为自由电子库，用以合理解释控制吸附和反应能学的电子描述符。考虑一个体积为 $V$ 的大立方体金属催化剂板，其被建模为一个具有周期性边界条件的三维 ($3$D) 无相互作用的自由电子气。单粒子色散关系为 $E=\\frac{\\hbar^{2}k^{2}}{2m}$，其中 $m$ 是电子质量，$k=|\\mathbf{k}|$ 是晶格波矢的大小，$\\hbar$ 是约化普朗克常数。假设自旋简并度为 $g_{s}=2$，并且允许的 $\\mathbf{k}$ 点根据标准的周期性箱量子化在倒易空间中均匀分布。在诸如密度泛函理论 (DFT) 的第一性原理分析中，总态密度 (DOS) 和投影到原子或轨道子空间的投影态密度 (PDOS) 通常是通过在 $\\mathbf{k}$ 空间中计数态并对能量求导来构建的。\n\n仅从以下基础出发：\n- 色散关系 $E=\\frac{\\hbar^{2}k^{2}}{2m}$，\n- 体积为 $V$ 的周期性箱中的均匀 $\\mathbf{k}$ 空间态计数，\n- 自旋简并度 $g_{s}=2$，\n\n推导此三维自由电子气的单位能量总态密度 $D(E)$ 作为 $E$、$V$、$m$ 和 $\\hbar$ 的函数的闭式表达式。将您的最终结果表示为由这些符号组成的单个解析表达式。不要进行任何数值代入。您的最终答案应仅为 $D(E)$ 的表达式。",
            "solution": "该问题陈述是基础固体物理学中一个有效且自洽的练习。它提供了推导三维 ($3$D) 无相互作用自由电子气的态密度 ($DOS$) 所需的所有信息。其前提在科学上是合理的，目标也定义明确。我们将开始推导。\n\n态密度 $D(E)$ 定义为在给定能量 $E$ 处单位能量间隔内的可用电子态数量。其形式上表示为能量小于或等于 $E$ 的总态数 $N(E)$ 对能量的导数：\n$$\nD(E) = \\frac{dN(E)}{dE}\n$$\n我们的推导分三个主要步骤进行：\n1.  基于周期性边界条件，确定倒易空间（k空间）中允许的波矢 $\\mathbf{k}$ 的密度。\n2.  通过对 k 空间中对应于能量 $E$ 的球内的允许 $\\mathbf{k}$ 点进行计数，来计算总态数 $N(E)$。\n3.  对 $N(E)$ 求关于 $E$ 的导数，以获得 $D(E)$ 的最终表达式。\n\n**步骤 1：$\\mathbf{k}$ 空间的量子化**\n对于一个被限制在体积为 $V=L^3$ 的立方体盒子中且具有周期性边界条件的无相互作用电子系统，其允许的单粒子波函数 $\\psi(\\mathbf{r})$ 必须满足 $\\psi(x+L, y, z) = \\psi(x, y, z)$，以及对 y 和 z 方向的类似条件。这些条件将允许的波矢 $\\mathbf{k}$ 量子化为 k 空间中的离散点：\n$$\n\\mathbf{k} = \\left( \\frac{2\\pi n_x}{L}, \\frac{2\\pi n_y}{L}, \\frac{2\\pi n_z}{L} \\right)\n$$\n其中 $n_x$、$n_y$ 和 $n_z$ 是任意整数。每一组不同的 $(n_x, n_y, n_z)$ 定义了一个唯一的轨道态。这些允许的 $\\mathbf{k}$ 点在倒易空间中形成一个均匀的网格。单个此类态在 k 空间中占据的体积是：\n$$\n\\Delta V_k = \\left(\\frac{2\\pi}{L}\\right)^3 = \\frac{(2\\pi)^3}{L^3} = \\frac{8\\pi^3}{V}\n$$\n对于一个大的体积 $V$，这些离散点非常密集，我们可以将其分布视为连续的。k 空间的一个无穷小体积元 $d^3k$ 中的轨道态数量由 $d^3k$ 与每个态的体积 $\\Delta V_k$ 的比值给出：\n$$\n\\text{Number of orbital states in } d^3k = \\frac{d^3k}{\\Delta V_k} = \\frac{d^3k}{8\\pi^3/V} = \\frac{V}{(2\\pi)^3} d^3k\n$$\n问题指定了自旋简并度为 $g_s=2$（对于自旋向上和自旋向下的电子）。因此，每个轨道态可以容纳两个电子。体积元 $d^3k$ 中的电子态总数为：\n$$\ndN = g_s \\frac{V}{(2\\pi)^3} d^3k = 2 \\frac{V}{8\\pi^3} d^3k = \\frac{V}{4\\pi^3} d^3k\n$$\n\n**步骤 2：总态数 $N(E)$**\n能量小于或等于 $E$ 的总态数 $N(E)$ 是通过对所有波矢 $\\mathbf{k}'$（其能量 $E(\\mathbf{k}')$ 小于或等于 $E$）积分 $dN$ 来求得的。给定的色散关系为 $E = \\frac{\\hbar^2 k^2}{2m}$，其中 $k=|\\mathbf{k}|$。此关系是各向同性的，意味着能量仅取决于波矢的大小，而与其方向无关。条件 $E(\\mathbf{k}') \\le E$ 在 k 空间中定义了一个以原点为中心、半径为 $k(E)$ 的球体。根据色散关系，对应于能量 $E$ 的半径 $k$ 为：\n$$\nk^2 = \\frac{2mE}{\\hbar^2} \\implies k(E) = \\sqrt{\\frac{2mE}{\\hbar^2}}\n$$\n为了求得 $N(E)$，我们对 k 空间中这个球体的体积进行积分。\n$$\nN(E) = \\int_{|\\mathbf{k}'| \\le k(E)} \\frac{V}{4\\pi^3} d^3k'\n$$\n积分 $\\int d^3k'$ 就是半径为 $k(E)$ 的球的体积，即 $\\frac{4}{3}\\pi k(E)^3$。\n$$\nN(E) = \\frac{V}{4\\pi^3} \\left( \\frac{4}{3}\\pi k(E)^3 \\right) = \\frac{V}{3\\pi^2} k(E)^3\n$$\n现在，我们代入 $k(E)$ 的表达式：\n$$\nN(E) = \\frac{V}{3\\pi^2} \\left( \\sqrt{\\frac{2mE}{\\hbar^2}} \\right)^3 = \\frac{V}{3\\pi^2} \\left( \\frac{2mE}{\\hbar^2} \\right)^{3/2}\n$$\n为了方便求导，我们可以将其写为：\n$$\nN(E) = \\frac{V}{3\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} E^{3/2}\n$$\n\n**步骤 3：态密度 $D(E)$ 的推导**\n最后，我们通过对 $N(E)$ 求关于能量 $E$ 的导数来计算态密度 $D(E)$。项 $V$、$m$ 和 $\\hbar$ 都是常数。\n$$\nD(E) = \\frac{dN(E)}{dE} = \\frac{d}{dE} \\left[ \\frac{V}{3\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} E^{3/2} \\right]\n$$\n$E^{3/2}$ 对 $E$ 的导数是 $\\frac{3}{2}E^{(3/2-1)} = \\frac{3}{2}E^{1/2}$。\n$$\nD(E) = \\frac{V}{3\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} \\left( \\frac{3}{2} E^{1/2} \\right)\n$$\n分子和分母中的因子 $3$ 相互抵消，得到三维自由电子气态密度的最终表达式：\n$$\nD(E) = \\frac{V}{2\\pi^2} \\left( \\frac{2m}{\\hbar^2} \\right)^{3/2} E^{1/2}\n$$\n此表达式给出了在能量 $E$ 处单位能量内的可用电子态数量，它是系统体积 $V$、电子质量 $m$、约化普朗克常数 $\\hbar$ 和能量 $E$ 的函数。",
            "answer": "$$\n\\boxed{\\frac{V}{2\\pi^2} \\left(\\frac{2m}{\\hbar^2}\\right)^{3/2} E^{1/2}}\n$$"
        },
        {
            "introduction": "从理想的理论模型转向计算实践时，我们面临着确保数值结果可靠性的挑战。利用密度泛函理论（DFT）等第一性原理方法计算态密度（DOS）和投影态密度（PDOS）时，结果的准确性严重依赖于一系列计算参数的收敛性。本练习旨在检验你对如何系统地验证和确保PDOS计算结果稳定性的理解，这对于任何计算催化或材料科学的研究者来说都是一项至关重要的实践技能 。",
            "id": "3877177",
            "problem": "对一个吸附有分子的金属平板进行催化表面计算，该计算使用平面波基组和周期性边界条件。其目标是获得吸附物和表面原子在费米能级附近可靠的态密度 (DOS) 和投影态密度 (PDOS)。周期性体系的态密度 (DOS) 由能带能量在布里渊区 (BZ) 上的积分定义，$$D(E) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} \\delta\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\mathrm{d}^3\\mathbf{k},$$ 其中 $E$ 是能量，$n$ 是能带索引，$\\mathbf{k}$ 是晶体动量，$\\epsilon_{n\\mathbf{k}}$ 是本征值，$\\Omega_{\\mathrm{BZ}}$ 是布里渊区的体积。在实践中，该积分通过对 $\\mathbf{k}$ 点的有限采样来近似，并将狄拉克δ分布替换为宽度为 $\\sigma$ 的平滑展宽函数 $g_{\\sigma}(E)$，从而产生一个展宽后的态密度 $D_{\\sigma}(E)$。投影到局域通道（例如，原子 $A$，角动量 $l$）上的PDOS是通过将Kohn–Sham态投影到局域基或投影算符 $\\phi_{A,l}(\\mathbf{r})$ 上来定义的，$$D_{A,l}(E;R_p) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} g_{\\sigma}\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\left|\\left\\langle \\phi_{A,l}^{(R_p)} \\middle| \\psi_{n\\mathbf{k}} \\right\\rangle\\right|^2\\,\\mathrm{d}^3\\mathbf{k},$$ 其中 $\\psi_{n\\mathbf{k}}(\\mathbf{r})$ 是Kohn–Sham轨道，而 $\\phi_{A,l}^{(R_p)}(\\mathbf{r})$ 表示在半径 $R_p$ 内定义的局域投影算符（例如，在投影缀加波(PAW)方法或线性化缀加平面波(LAPW)方法中）。平面波基组的完备性由动能截断 $E_{\\mathrm{cut}}$ 控制。占据数和费米能级 $E_F$ 是自洽决定的，其展宽由所使用的展宽函数（例如，高斯展宽或Methfessel–Paxton (MP) 展宽）控制。\n\n根据这些定义和数值近似，确定哪一套定量收敛标准在科学上是合理的，以确保PDOS特征（峰位、$E_F$ 附近的积分权重以及吸附物-金属杂化态的相对强度）相对于 $\\mathbf{k}$ 点采样、平面波截断 $E_{\\mathrm{cut}}$、展宽宽度 $\\sigma$ 和投影半径 $R_p$ 是稳定的。\n\n假设PDOS特征的目标能量分辨率在几十毫电子伏特的量级，并且在 $E_F$ 附近一个小窗口内的积分PDOS的目标精度在百分之一个电子的量级。\n\n选择最佳选项。\n\nA. 仅使用总能量收敛：增加 $E_{\\mathrm{cut}}$ 直到总能量变化小于 $1\\,\\mathrm{meV}$/原子；对金属平板使用单个 $\\Gamma$ 点 ($\\mathbf{k}=\\mathbf{0}$)；应用 $\\sigma = 0.5\\,\\mathrm{eV}$ 的大展宽 $g_{\\sigma}$ 来抑制数值噪音；将 $R_p$ 设置为 Wigner–Seitz 半径以最大化重叠，不再进行进一步测试。\n\nB. 要求在系统性参数改变下PDOS具有特定不变性：\n- 沿每个周期性晶格方向将线性 $\\mathbf{k}$ 点密度加倍时，可识别的PDOS峰能量的位移小于 $0.02\\,\\mathrm{eV}$，且在 $[E_F - 0.5\\,\\mathrm{eV},\\,E_F + 0.5\\,\\mathrm{eV}]$ 范围内的积分PDOS，$$I_{A,l} = \\int_{E_F - 0.5\\,\\mathrm{eV}}^{E_F + 0.5\\,\\mathrm{eV}} D_{A,l}(E;R_p)\\,\\mathrm{d}E,$$ 对于所有相关通道的变化小于 $0.01$ 个电子。\n- 将 $E_{\\mathrm{cut}}$ 增加 $25\\%$ 时，$I_{A,l}$ 的变化小于 $0.01$ 个电子，PDOS峰位的变化小于 $0.02\\,\\mathrm{eV}$。\n- 在至少三个值上改变 $\\sigma$（例如，$\\sigma = 0.05,\\,0.10,\\,0.15\\,\\mathrm{eV}$），并将特征外推到 $\\sigma \\to 0$，得到在 $0.02\\,\\mathrm{eV}$ 内一致的峰位和在 $0.01$ 个电子内一致的积分权重；选择最终的 $\\sigma$ 小于最窄收敛特征宽度的一半。\n- 将 $R_p$ 改变 $\\pm 0.2\\,\\mathrm{\\AA}$ 时，$I_{A,l}$ 在 $0.02$ 个电子内保持稳定，峰位在 $0.02\\,\\mathrm{eV}$ 内保持稳定。\n\nC. 确保能带宽度级别的平滑：选择 $\\sigma$ 等于整个 $d$ 带宽度（例如，$\\sigma = 2\\,\\mathrm{eV}$）；仅在 $\\Gamma$ 点采样并进行对称性平均；增加 $E_{\\mathrm{cut}}$ 直到应力张量收敛；使用电荷划分方案（例如，Bader分析）来代替PDOS积分，从而避免对投影半径的依赖。\n\nD. 关注费米能级稳定性和峰高：使用粗糙的 Monkhorst–Pack 网格（例如，$3\\times 3\\times 1$），当参数变化时接受高达 $0.5\\,\\mathrm{eV}$ 的 $E_F$ 变化；要求在增加 $E_{\\mathrm{cut}}$ 时总能量变化小于 $5\\,\\mathrm{meV}$/原子；选择单个固定的 $\\sigma = 0.2\\,\\mathrm{eV}$；将 $R_p$ 设置为共价半径，并且如果峰高变化小于 $50\\%$ 则认为达到收敛，而无需明确监控积分PDOS。",
            "solution": "问题要求为计算带有吸附物的金属平板的投影态密度（PDOS）确定一套科学上合理的定量收敛标准。该计算使用平面波基组，目标精度为：能量分辨率在几十毫电子伏特的量级，费米能级 $E_F$ 附近的积分权重在百分之一个电子的量级。\n\n首先评估问题陈述的有效性。\n\n**问题验证**\n\n**步骤 1：提取已知信息**\n- **体系：** 带有吸附分子的金属平板。\n- **方法：** 平面波基组，周期性边界条件。\n- **目标：** 费米能级附近可靠的态密度 (DOS) 和投影态密度 (PDOS)。\n- **DOS 定义：** $$D(E) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} \\delta\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\mathrm{d}^3\\mathbf{k}$$\n- **数值DOS：** 在有限 $\\mathbf{k}$ 点样本上的积分，其中狄拉克δ函数 $\\delta(x)$ 被宽度为 $\\sigma$ 的展宽函数 $g_{\\sigma}(E)$ 替代。\n- **PDOS 定义：** $$D_{A,l}(E;R_p) = \\frac{1}{\\Omega_{\\mathrm{BZ}}}\\sum_{n}\\int_{\\mathrm{BZ}} g_{\\sigma}\\!\\left(E-\\epsilon_{n\\mathbf{k}}\\right)\\,\\left|\\left\\langle \\phi_{A,l}^{(R_p)} \\middle| \\psi_{n\\mathbf{k}} \\right\\rangle\\right|^2\\,\\mathrm{d}^3\\mathbf{k}$$\n- **数值参数：** $\\mathbf{k}$ 点采样密度、平面波截断能 $E_{\\mathrm{cut}}$、展宽宽度 $\\sigma$、投影半径 $R_p$。\n- **目标精度：**\n    - PDOS特征的能量分辨率：几十毫电子伏特（例如，$\\sim 0.01-0.09\\,\\mathrm{eV}$）。\n    - $E_F$ 附近小窗口内的积分PDOS精度：百分之一个电子（例如，$\\sim 0.01$ 个电子）。\n- **问题：** 确定一套定量收敛标准，以确保PDOS特征（峰位、积分权重、相对强度）对于四个关键数值参数是稳定的。\n\n**步骤 2：使用提取的已知信息进行验证**\n- **科学基础：** 该问题牢固地基于应用于固态体系的密度泛函理论（DFT）的标准理论和计算框架。DOS和PDOS的定义是常规的，所列出的数值参数正是在平面波DFT计算中必须收敛的参数。该问题在科学上是合理的。\n- **良态性：** 该问题要求为特定的、明确定义的物理性质（PDOS特征）提供一套合理的收敛标准，并达到指定的精度水平。该领域对此类任务存在一套独特的最佳实践，因此该问题是良态的。\n- **客观性：** 该问题以精确的技术语言陈述，没有主观性。所涉及的量和目标都是量化的。\n- **完备性和一致性：** 提供了理解背景和问题所需的所有必要信息。定义和参数都是标准的，并且内部一致。\n\n**步骤 3：结论和行动**\n- 该问题是有效的。它代表了计算材料科学中一个标准的、非平凡的挑战。我将继续对选项进行全面解答和分析。\n\n**推导正确的收敛策略**\n\n数值收敛的基本原则是，当使某个数值参数更严格（例如，更密的 $\\mathbf{k}$ 点网格，更高的 $E_{\\mathrm{cut}}$）时，如果一个计算出的性质的值在预定义的容差范围内不再变化，则认为该性质相对于该参数是收敛的。对于本问题，我们感兴趣的性质是PDOS的峰位和积分PDOS权重。至关重要的是直接测试这些性质的收敛性，而不是依赖于可能以不同速率收敛的代理性质，如总能量。\n\n1.  **$\\mathbf{k}$点采样：** 体系是一个金属平板。金属具有费米面，意味着有能带穿过费米能级。对这些能带和费米面拓扑的准确描述对所有电子性质都至关重要。这要求对布里渊区（BZ）进行密集采样。单个 $\\mathbf{k}$ 点（如 $\\Gamma$ 点）是完全不够的，因为它完全忽略了能带色散，导致不正确的占据数以及在定性上错误的 $E_F$ 和DOS。必须通过系统地增加 $\\mathbf{k}$ 点网格的密度（例如，从 $N_1 \\times N_2 \\times 1$ 网格增加到 $2N_1 \\times 2N_2 \\times 1$ 网格）并监控PDOS特征，直到它们在目标容差内稳定（例如，峰位移小于 $0.02\\,\\mathrm{eV}$，积分权重变化小于 $0.01$ 个电子），来确定收敛性。\n\n2.  **平面波截断能 ($E_{\\mathrm{cut}}$)：** $E_{\\mathrm{cut}}$ 决定了用于表示Kohn-Sham波函数 $\\psi_{n\\mathbf{k}}$ 的基组的大小。更高的截断能产生更准确的表示。虽然总能量收敛是必要的第一步，但本征值 $\\epsilon_{n\\mathbf{k}}$ 和波函数 $\\psi_{n\\mathbf{k}}$ 的收敛可能更慢。由于PDOS直接依赖于这两者，因此必须通过增加 $E_{\\mathrm{cut}}$（例如，增加 $25-30\\%$）并确保PDOS特征在目标容差内保持稳定，来明确验证其相对于 $E_{\\mathrm{cut}}$ 的收敛性。\n\n3.  **展宽宽度 ($\\sigma$)：** 展宽参数 $\\sigma$ 有两个目的：稳定金属的自洽场（SCF）计算，以及将离散的本征值展宽成连续的DOS/PDOS以供分析。为了进行分析，必须仔细选择 $\\sigma$。如果 $\\sigma$太大，它会把我们感兴趣的特征展宽掉。如果它太小，由于有限的 $\\mathbf{k}$ 点采样，DOS可能会显得有噪音。一个稳健的程序是首先确保 $\\mathbf{k}$ 点网格足够密集，然后使用一个小的 $\\sigma$（例如，$0.05-0.1\\,\\mathrm{eV}$）进行绘图。为确保结果不是特定 $\\sigma$ 值的产物，应检查物理信息（峰位和面积）在一系列小的 $\\sigma$ 值范围内是否稳定。一种严谨的方法是将关键特征外推到 $\\sigma \\to 0$ 的极限。用于绘图的最终 $\\sigma$ 值应小于最窄目标特征的宽度，以确保该特征能被分辨出来。\n\n4.  **投影半径 ($R_p$)：** PDOS是通过将波函数投影到定义在特定半径 $R_p$ 内的局域类原子轨道或投影算符上来计算的。由此产生的绝对积分PDOS可能对这个选择很敏感。一个科学上合理的分析要求从PDOS中得出的*结论*——例如峰的相对位置和不同轨道的相对积分权重——不能是任意选择 $R_p$ 的产物。因此，应针对 $R_p$ 的合理变化（例如，$\\pm 0.2\\,\\mathrm{\\AA}$）测试PDOS特征的稳定性。\n\n**逐项分析选项**\n\n**A. 仅使用总能量收敛：增加 $E_{\\mathrm{cut}}$ 直到总能量变化小于 $1\\,\\mathrm{meV}$/原子；对金属平板使用单个 $\\Gamma$ 点 ($\\mathbf{k}=\\mathbf{0}$)；应用 $\\sigma = 0.5\\,\\mathrm{eV}$ 的大展宽 $g_{\\sigma}$ 来抑制数值噪音；将 $R_p$ 设置为 Wigner–Seitz 半径以最大化重叠，不再进行进一步测试。**\n- 单独使用总能量收敛对于DOS性质是不够的。\n- 对金属体系使用单个 $\\Gamma$ 点是一个会产生非物理结果的严重错误。\n- $\\sigma=0.5\\,\\mathrm{eV}$ 的展宽过大，会掩盖任何几十meV尺度的特征。\n- 不测试对 $R_p$ 的依赖性会使PDOS结果不可靠。\n**结论：不正确。**\n\n**B. 要求在系统性参数改变下PDOS具有特定不变性：...**\n- **$\\mathbf{k}$点：** 将 $\\mathbf{k}$ 点密度加倍，并检查PDOS峰的稳定性（小于 $0.02\\,\\mathrm{eV}$）和积分权重的稳定性（小于 $0.01$ 个电子）的标准，是一个直接、定量且正确的程序，与问题陈述的精度目标相匹配。\n- **$E_{\\mathrm{cut}}$：** 增加 $E_{\\mathrm{cut}}$ 并以同样严格的容差检查PDOS特征的稳定性也是正确的程序。\n- **$\\sigma$：** 所提出的测试多个小 $\\sigma$ 值（例如，$0.05, 0.10, 0.15\\,\\mathrm{eV}$）、外推到 $\\sigma \\to 0$ 并根据特征宽度选择最终 $\\sigma$ 的方法，是获得可靠、高分辨率结果的严谨且非常合适的策略。\n- **$R_p$：** 针对 $R_p$ 的变化（例如，$\\pm 0.2\\,\\mathrm{\\AA}$）测试PDOS特征的稳定性，正确地解决了投影方法可能存在的模糊性。指定的容差是合理的。\n该选项描述了一套全面且科学严谨的收敛测试，这些测试正是为获得准确的PDOS这一目标量身定制的。\n**结论：正确。**\n\n**C. 确保能带宽度级别的平滑：选择 $\\sigma$ 等于整个 $d$ 带宽度（例如，$\\sigma = 2\\,\\mathrm{eV}$）；仅在 $\\Gamma$ 点采样并进行对称性平均；增加 $E_{\\mathrm{cut}}$ 直到应力张量收敛；使用电荷划分方案（例如，Bader分析）来代替PDOS积分，从而避免对投影半径的依赖。**\n- $\\sigma=2\\,\\mathrm{eV}$ 的展宽会破坏PDOS中所有有意义的信息。\n- 对金属使用 $\\Gamma$ 点是不正确的。\n- 收敛应力张量并不是收敛PDOS的直接或充分条件。\n- Bader分析计算的是积分原子电荷，而不是能量分辨的态密度。它是一个不同的物理量，不能替代PDOS计算。\n**结论：不正确。**\n\n**D. 关注费米能级稳定性和峰高：使用粗糙的 Monkhorst–Pack 网格（例如，$3\\times 3\\times 1$），当参数变化时接受高达 $0.5\\,\\mathrm{eV}$ 的 $E_F$ 变化；要求在增加 $E_{\\mathrm{cut}}$ 时总能量变化小于 $5\\,\\mathrm{meV}$/原子；选择单个固定的 $\\sigma = 0.2\\,\\mathrm{eV}$；将 $R_p$ 设置为共价半径，并且如果峰高变化小于 $50\\%$ 则认为达到收敛，而无需明确监控积分PDOS。**\n- 收敛标准过于宽松。$E_F$ 变化 $0.5\\,\\mathrm{eV}$ 表明严重缺乏收敛。峰高变化 $50\\%$ 是巨大的。\n- 未经测试就使用粗糙网格是不合理的。\n- 监控峰高而不监控更稳健的积分权重是不良做法。\n- 参数 $\\sigma$ 和 $R_p$ 在没有进行稳定性测试的情况下被固定。这个过程很草率，不会产生可靠的结果。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "投影态密度（PDOS）不仅是一个理论概念，更是一个强大的分析工具，它能够帮助我们“解剖”复杂体系（如催化纳米颗粒）的电子结构，区分不同原子或区域的贡献。本练习将通过一个具体的编程任务，让你实现一个算法，用于根据原子在空间上的位置（核层 vs. 表层）来分离其电子态贡献。这种方法是分析催化活性位点电子特性的常用技术，能够深化你对如何运用PDOS进行材料分析的理解 。",
            "id": "3877232",
            "problem": "您需要形式化并实现一个壳层投影计算，以分离模型纳米颗粒的投影态密度（PDOS）中核层与表层的贡献。请从第一性原理出发，使用态密度和投影算符的定义。能量为 $E$ 时的态密度由一组本征值 $\\{\\varepsilon_n\\}$ 定义为 $D(E) = \\sum_n \\delta(E - \\varepsilon_n)$。投影到某个局域子空间（例如原子 $a$）上的投影态密度定义为 $D_a(E) = \\sum_n \\lvert \\langle \\phi_a \\vert \\psi_n \\rangle \\rvert^2 \\delta(E - \\varepsilon_n)$。对于一个由原子 $a \\in S$ 组成的壳层 $S$，其壳层投影PDOS由 $D_S(E) = \\sum_{a \\in S} D_a(E)$ 给出。在一个使用能量网格和平滑核函数的离散化计算中，$D_S(E)$ 在能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$ 上的积分可以近似该窗口内与壳层 $S$ 相关的态的数量，即 $N_S([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} D_S(E)\\, dE$。\n\n您将实现以下模型和算法。\n\n1. 几何结构与壳层定义：\n   - 考虑一个纳米颗粒，其原子位于一个正八面体的顶点外加一个中心点。其笛卡尔坐标（单位为埃）由集合 $\\{(0,0,0), (\\pm a, 0, 0), (0, \\pm a, 0), (0, 0, \\pm a)\\}$ 给出，其中 $a > 0$ 是一个尺度参数。\n   - 将几何中心 $\\mathbf{R}_{\\mathrm{cm}}$ 定义为原子位置的算术平均值。\n   - 对每个原子 $i$，计算其径向距离 $r_i = \\lVert \\mathbf{R}_i - \\mathbf{R}_{\\mathrm{cm}} \\rVert$。\n   - 定义一个径向阈值 $r_{\\mathrm{th}} > 0$。如果原子 $i$ 的 $r_i \\le r_{\\mathrm{th}}$，则将其分配到核层，否则分配到表层。\n\n2. 能量网格与PDOS模型：\n   - 使用一个能量网格，该网格包含 $N_E$ 个均匀分布的点，范围从 $E_{\\min}$ 到 $E_{\\max}$（单位均为电子伏特），包含两端点。\n   - 为进行此计算，使用归一化类高斯峰构建每个原子的合成PDOS，以模拟与壳层相关的特征：\n     - 设 $(\\mu_{\\mathrm{c}}, \\sigma_{\\mathrm{c}})$ 为类核层PDOS特征的中心和宽度，$(\\mu_{\\mathrm{s}}, \\sigma_{\\mathrm{s}})$ 为类表层特征的参数，单位均为电子伏特。\n     - 对任何核层原子，定义 $D_a(E) = A_{\\mathrm{c}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{c}})^2}{2\\sigma_{\\mathrm{c}}^2}\\big) + \\alpha A_{\\mathrm{s}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{s}})^2}{2\\sigma_{\\mathrm{s}}^2}\\big)$。\n     - 对任何表层原子，定义 $D_a(E) = A_{\\mathrm{s}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{s}})^2}{2\\sigma_{\\mathrm{s}}^2}\\big) + \\alpha A_{\\mathrm{c}} \\exp\\!\\big(-\\tfrac{(E - \\mu_{\\mathrm{c}})^2}{2\\sigma_{\\mathrm{c}}^2}\\big)$。\n     - 此处 $A_{\\mathrm{c}} > 0$ 和 $A_{\\mathrm{s}} > 0$ 是振幅，$\\alpha \\in [0, 1]$ 是一个小的混合因子，用于模拟跨壳层的杂化。\n\n3. 在能量窗口上进行壳层投影积分：\n   - 对于一个给定的能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$（其中 $E_{\\min} \\le E_{\\mathrm{L}} \\le E_{\\mathrm{U}} \\le E_{\\max}$），计算\n     $$N_{\\mathrm{core}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} \\left(\\sum_{a \\in \\text{core}} D_a(E)\\right) dE, \\quad N_{\\mathrm{surf}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} \\left(\\sum_{a \\in \\text{surface}} D_a(E)\\right) dE.$$\n   - 在离散网格上使用梯形法则来近似每个积分。如果窗口包含的网格点少于2个，则将相应的积分定义为0。\n   - 将该窗口中的表层分数定义为\n     $$f_{\\mathrm{surf}} = \\begin{cases}\n     \\dfrac{N_{\\mathrm{surf}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}])}{N_{\\mathrm{core}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) + N_{\\mathrm{surf}}([E_{\\mathrm{L}}, E_{\\mathrm{U}}])},  \\text{若 } N_{\\mathrm{core}} + N_{\\mathrm{surf}} > 0,\\\\[6pt]\n     0,  \\text{其他情况}。\n     \\end{cases}$$\n     分数 $f_{\\mathrm{surf}}$ 是无量纲的，必须以小数形式报告。\n\n测试套件规范。除非明确改变，否则所有测试用例均使用以下参数值：\n\n- 几何参数 $a = 2.0$ 埃，径向阈值 $r_{\\mathrm{th}} = 0.4$ 埃。\n- 能量网格参数 $E_{\\min} = -3.0$ 电子伏特，$E_{\\max} = 3.0$ 电子伏特，$N_E = 1201$ 个点。\n- PDOS模型参数：$A_{\\mathrm{c}} = 1.0$, $A_{\\mathrm{s}} = 1.0$, $\\alpha = 0.1$, $\\mu_{\\mathrm{c}} = -1.0$ 电子伏特, $\\sigma_{\\mathrm{c}} = 0.2$ 电子伏特, $\\mu_{\\mathrm{s}} = 1.0$ 电子伏特, $\\sigma_{\\mathrm{s}} = 0.3$ 电子伏特。\n\n定义四个测试用例，每个用例包含一个能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$：\n\n- 测试用例 1 (核层主导窗口)：$E_{\\mathrm{L}} = -1.5$ 电子伏特, $E_{\\mathrm{U}} = -0.5$ 电子伏特。\n- 测试用例 2 (表层主导窗口)：$E_{\\mathrm{L}} = 0.5$ 电子伏特, $E_{\\mathrm{U}} = 1.5$ 电子伏特。\n- 测试用例 3 (带隙窗口，PDOS接近零)：$E_{\\mathrm{L}} = 2.5$ 电子伏特, $E_{\\mathrm{U}} = 3.0$ 电子伏特。\n- 测试用例 4 (零宽度窗口)：$E_{\\mathrm{L}} = -1.0$ 电子伏特, $E_{\\mathrm{U}} = -1.0$ 电子伏特。\n\n要求的最终输出格式。您的程序必须按顺序计算四个测试用例的 $f_{\\mathrm{surf}}$，并打印一行包含四个小数值的逗号分隔列表，这些值四舍五入到恰好6位小数，并用方括号括起来，例如 $[x_1,x_2,x_3,x_4]$。输出是无量纲的（无单位）。不应打印任何其他文本。角度单位不适用。所有能量单位为电子伏特，长度单位为埃，但报告的分数是无单位的。",
            "solution": "我们从态密度的定义开始。对于一组本征对 $\\{(\\varepsilon_n, \\vert \\psi_n \\rangle)\\}$，能量为 $E$ 时的态密度是 $D(E) = \\sum_n \\delta(E - \\varepsilon_n)$。通过一个投影算符 $\\hat{P}_a$，可以实现到与原子 $a$ 相关联的局域轨道子空间 $\\mathcal{H}_a$ 上的投影，因此投影到原子 $a$ 上的投影态密度是 $D_a(E) = \\sum_n \\langle \\psi_n \\vert \\hat{P}_a \\vert \\psi_n \\rangle \\delta(E - \\varepsilon_n)$。对每个原子 $a$ 使用一个标准正交集 $\\{\\vert \\phi_a \\rangle\\}$，该式变为 $D_a(E) = \\sum_n \\lvert \\langle \\phi_a \\vert \\psi_n \\rangle \\rvert^2 \\delta(E - \\varepsilon_n)$。对于构成一个壳层 $S$ 的原子集合，其壳层投影态密度为 $D_S(E) = \\sum_{a \\in S} D_a(E)$。\n\n我们关心的是在能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$ 内由壳层 $S$ 贡献的态的数量，这通过在该窗口上对壳层投影态密度进行积分得到：\n$$\nN_S([E_{\\mathrm{L}}, E_{\\mathrm{U}}]) = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} D_S(E)\\, dE = \\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} \\left(\\sum_{a \\in S} D_a(E)\\right) dE.\n$$\n在计算环境中，我们用平滑核函数近似delta函数，并在一个离散的能量网格 $\\{E_k\\}_{k=1}^{N_E}$ 上计算 $D_a(E)$。积分通过数值积分方法（如梯形法则）来近似：\n$$\n\\int_{E_{\\mathrm{L}}}^{E_{\\mathrm{U}}} f(E)\\, dE \\approx \\sum_{k \\in \\mathcal{K}} \\frac{f(E_{k}) + f(E_{k+1})}{2} (E_{k+1} - E_{k}),\n$$\n其中 $\\mathcal{K}$ 索引了位于窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$ 内的网格子集。\n\n在本问题中，我们构建了一个人工合成但科学上合理的PDOS模型，它通过特征高斯函数来区分核层原子和表层原子。对于核层原子，我们使用\n$$\nD_a(E) = A_{\\mathrm{c}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{c}})^2}{2 \\sigma_{\\mathrm{c}}^2}\\right) + \\alpha A_{\\mathrm{s}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{s}})^2}{2 \\sigma_{\\mathrm{s}}^2}\\right),\n$$\n对于表层原子，\n$$\nD_a(E) = A_{\\mathrm{s}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{s}})^2}{2 \\sigma_{\\mathrm{s}}^2}\\right) + \\alpha A_{\\mathrm{c}} \\exp\\!\\left(-\\frac{(E - \\mu_{\\mathrm{c}})^2}{2 \\sigma_{\\mathrm{c}}^2}\\right).\n$$\n此处 $A_{\\mathrm{c}}$ 和 $A_{\\mathrm{s}}$ 是振幅，$\\mu_{\\mathrm{c}}$ 和 $\\mu_{\\mathrm{s}}$ 是主导特征的中心（能量），$\\sigma_{\\mathrm{c}}$ 和 $\\sigma_{\\mathrm{s}}$ 是它们的宽度，$\\alpha$ 是一个捕获跨壳层微小杂化的混合因子。这个模型反映了计算催化中的一个常见模式，即类核层态倾向于处于较低能量，而类表层态倾向于处于较高能量。\n\n算法步骤：\n1. 构建纳米颗粒的几何结构，其为原点和六个在坐标轴上距离为 $a$ 的点的并集，即 $\\{(0,0,0), (\\pm a, 0, 0), (0, \\pm a, 0), (0, 0, \\pm a)\\}$。\n2. 计算质心 $\\mathbf{R}_{\\mathrm{cm}}$ 作为坐标的平均值。由于对称性，$\\mathbf{R}_{\\mathrm{cm}}$ 是 $(0,0,0)$；但为了通用性，我们仍然通过编程计算它。\n3. 计算半径 $r_i = \\lVert \\mathbf{R}_i - \\mathbf{R}_{\\mathrm{cm}} \\rVert$，如果 $r_i \\le r_{\\mathrm{th}}$，则将原子分配到核层，否则分配到表层。\n4. 构建一个从 $E_{\\min}$到 $E_{\\max}$（含两端）的均匀能量网格，包含 $N_E$ 个点。\n5. 对每个原子，使用相应的公式（核层或表层）在网格上计算 $D_a(E_k)$。\n6. 对于每个能量窗口 $[E_{\\mathrm{L}}, E_{\\mathrm{U}}]$，确定窗口内的网格点子集。如果窗口内的点少于2个，则将积分设为0。否则，将 $N_{\\mathrm{core}}$ 计算为 $\\sum_{a \\in \\text{core}} D_a(E)$ 在该窗口上的梯形积分，对 $N_{\\mathrm{surf}}$ 也做同样处理。\n7. 如果分母为正，则计算 $f_{\\mathrm{surf}} = N_{\\mathrm{surf}}/(N_{\\mathrm{core}}+N_{\\mathrm{surf}})$，否则 $f_{\\mathrm{surf}} = 0$。\n8. 将每个 $f_{\\mathrm{surf}}$ 四舍五入到6位小数并打印列表。\n\n测试套件讨论：\n- 使用 $a = 2.0$ 和 $r_{\\mathrm{th}} = 0.4$ 会将原点处的原子分配给核层，将六个外部原子分配给表层，因为对于核层原子 $r=0 \\le 0.4$，而对于表层原子 $r=a=2.0 > 0.4$。\n- 核层主导的窗口 $[-1.5, -0.5]$ 中心在 $\\mu_{\\mathrm{c}} = -1.0$，其 $\\sigma_{\\mathrm{c}} = 0.2$，所以 $N_{\\mathrm{core}}$ 相当大，而 $N_{\\mathrm{surf}}$ 主要来自混合项 $\\alpha$ 和高斯函数的尾部。\n- 表层主导的窗口 $[0.5, 1.5]$ 中心在 $\\mu_{\\mathrm{s}} = 1.0$，其 $\\sigma_{\\mathrm{s}} = 0.3$，这将产生一个相对于 $N_{\\mathrm{core}}$ 而言很大的 $N_{\\mathrm{surf}}$。\n- 带隙窗口 $[2.5, 3.0]$ 远离任何一个特征峰，导致两个积分都接近于零；在这种情况下，我们明确将分数值定义为零。\n- 零宽度窗口 $[-1.0, -1.0]$ 最多包含一个网格点，因此根据构造，梯形积分为零，分数值也设为零。\n\n输出为单行格式 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 分别是测试用例1到4的 $f_{\\mathrm{surf}}$ 的小数值，四舍五入到恰好6位小数。能量单位为电子伏特，位置单位为埃，报告的分数是无量纲的。",
            "answer": "```python\nimport numpy as np\n\ndef gaussian(E, mu, sigma, amp):\n    # amp * exp(- (E-mu)^2 / (2 sigma^2))\n    return amp * np.exp(-0.5 * ((E - mu) / sigma) ** 2)\n\ndef build_octahedron_positions(a):\n    # Positions: center + 6 at +/- axes\n    positions = [\n        (0.0, 0.0, 0.0),\n        ( a, 0.0, 0.0), (-a, 0.0, 0.0),\n        (0.0,  a, 0.0), (0.0, -a, 0.0),\n        (0.0, 0.0,  a), (0.0, 0.0, -a),\n    ]\n    return np.array(positions, dtype=float)\n\ndef assign_shells(positions, r_th):\n    # Compute center of mass (geometric center)\n    R_cm = positions.mean(axis=0)\n    radii = np.linalg.norm(positions - R_cm, axis=1)\n    core_idx = np.where(radii <= r_th)[0]\n    surf_idx = np.where(radii > r_th)[0]\n    return core_idx, surf_idx\n\ndef construct_pdos_per_atom(E, is_core_mask, params):\n    # params: dict with Ac, As, alpha, muc, sigc, mus, sigs\n    Ac = params['Ac']; As = params['As']; alpha = params['alpha']\n    muc = params['muc']; sigc = params['sigc']\n    mus = params['mus']; sigs = params['sigs']\n    n_atoms = is_core_mask.shape[0]\n    pdos = np.zeros((n_atoms, E.size), dtype=float)\n    core_main_c = gaussian(E, muc, sigc, Ac)\n    core_mix_s = gaussian(E, mus, sigs, alpha * As)\n    surf_main_s = gaussian(E, mus, sigs, As)\n    surf_mix_c = gaussian(E, muc, sigc, alpha * Ac)\n    for i in range(n_atoms):\n        if is_core_mask[i]:\n            pdos[i, :] = core_main_c + core_mix_s\n        else:\n            pdos[i, :] = surf_main_s + surf_mix_c\n    return pdos\n\ndef integrate_window(E, y, Emin, Emax):\n    # Integrate y(E) over [Emin, Emax] using trapezoidal rule on the subset of points.\n    mask = (E >= Emin) & (E <= Emax)\n    idx = np.where(mask)[0]\n    if idx.size < 2:\n        return 0.0\n    return np.trapz(y[mask], E[mask])\n\ndef solve():\n    # Common parameters\n    a = 2.0  # angstrom\n    r_th = 0.4  # angstrom\n    Emin = -3.0  # eV\n    Emax = 3.0   # eV\n    NE = 1201\n    E = np.linspace(Emin, Emax, NE)\n\n    params = {\n        'Ac': 1.0,\n        'As': 1.0,\n        'alpha': 0.1,\n        'muc': -1.0,\n        'sigc': 0.2,\n        'mus': 1.0,\n        'sigs': 0.3\n    }\n\n    # Build geometry and shells\n    positions = build_octahedron_positions(a)\n    core_idx, surf_idx = assign_shells(positions, r_th)\n    n_atoms = positions.shape[0]\n    is_core_mask = np.zeros(n_atoms, dtype=bool)\n    is_core_mask[core_idx] = True\n\n    # Construct PDOS per atom\n    pdos = construct_pdos_per_atom(E, is_core_mask, params)\n\n    # Aggregate PDOS by shell\n    pdos_core = pdos[core_idx, :].sum(axis=0) if core_idx.size > 0 else np.zeros_like(E)\n    pdos_surf = pdos[surf_idx, :].sum(axis=0) if surf_idx.size > 0 else np.zeros_like(E)\n\n    # Test suite windows\n    test_cases = [\n        (-1.5, -0.5),  # core-dominated\n        (0.5, 1.5),    # surface-dominated\n        (2.5, 3.0),    # gap\n        (-1.0, -1.0),  # zero-width\n    ]\n\n    results = []\n    for (El, Eu) in test_cases:\n        N_core = integrate_window(E, pdos_core, El, Eu)\n        N_surf = integrate_window(E, pdos_surf, El, Eu)\n        denom = N_core + N_surf\n        if denom > 0.0:\n            frac = N_surf / denom\n        else:\n            frac = 0.0\n        # Round to 6 decimals\n        results.append(f\"{frac:.6f}\")\n\n    # Print as required: single line \"[x1,x2,x3,x4]\"\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}