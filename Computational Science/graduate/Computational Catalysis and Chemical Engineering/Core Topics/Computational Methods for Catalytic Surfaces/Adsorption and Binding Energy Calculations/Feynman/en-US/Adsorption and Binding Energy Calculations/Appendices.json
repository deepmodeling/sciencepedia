{
    "hands_on_practices": [
        {
            "introduction": "The starting point for any computational study of surface chemistry is the calculation of the adsorption energy ($E_{\\mathrm{ads}}$), which quantifies the thermodynamic stability of an adsorbate on a surface. This practice demonstrates the fundamental procedure using total energies obtained from Density Functional Theory (DFT) calculations. You will apply the core formula to find $E_{\\mathrm{ads}}$ and also interpret the force convergence criteria, a practical check that ensures the calculated geometry corresponds to a stationary point on the potential energy surface.",
            "id": "3867641",
            "problem": "A periodic slab calculation using Density Functional Theory (DFT) within the Generalized Gradient Approximation (GGA) and the Projector Augmented-Wave (PAW) formalism is performed to study adsorption of a closed-shell molecule on a metal $(111)$ surface. All total energies are computed at the same settings (identical lattice vectors, plane-wave cutoff, $k$-point mesh, and vacuum thickness). The structures are fully relaxed until the maximum residual force on any unconstrained atom is below a preset threshold. The following total energies are obtained after relaxation:\n- Clean slab total energy: $E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$.\n- Isolated adsorbate (in the same supercell and vacuum) total energy: $E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$.\n- Adsorbate on slab total energy: $E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$.\n\nAssume the adsorption process is defined as bringing the relaxed isolated adsorbate from infinity to bind on the relaxed slab at the identified site, with no change in computational settings or stoichiometry. Based on the foundational thermodynamic definition of a reaction energy as the change in internal energy between products and reactants on the Born–Oppenheimer potential energy surface, compute the adsorption energy $E_{\\mathrm{ads}}$ using only the data provided.\n\nIn the structural relaxation that produced $E_{\\mathrm{slab+ads}}$, the final unconstrained atomic forces had magnitudes $0.012\\,\\mathrm{eV}/\\AA$, $0.019\\,\\mathrm{eV}/\\AA$, and $0.017\\,\\mathrm{eV}/\\AA$ on the three atoms with the largest residual forces. Briefly describe the mechanical meaning of the post-relaxation maximum force criterion and whether these values indicate convergence if the threshold is $0.020\\,\\mathrm{eV}/\\AA$.\n\nExpress the adsorption energy in electronvolts. Round your final numerical answer to three significant figures.",
            "solution": "The solution consists of two parts as requested: the calculation of the adsorption energy and an explanation of the force convergence criterion.\n\n**Part 1: Calculation of Adsorption Energy**\n\nThe adsorption energy, $E_{\\mathrm{ads}}$, represents the change in energy when an adsorbate molecule binds to a surface. The adsorption process can be written as a reaction:\n$$\n\\text{Slab} + \\text{Adsorbate} \\rightarrow \\text{Slab-Adsorbate System}\n$$\nIn the context of DFT calculations at zero Kelvin, the change in energy for this process is calculated as the total energy of the final state (products) minus the sum of the total energies of the initial states (reactants). The reactants are the isolated, relaxed clean slab and the isolated, relaxed adsorbate molecule. The product is the combined system with the adsorbate bound to the slab, also in its relaxed state.\n\nThe formula for the adsorption energy is therefore:\n$$\nE_{\\mathrm{ads}} = E_{\\mathrm{slab+ads}} - (E_{\\mathrm{slab}} + E_{\\mathrm{ads}}^{\\mathrm{iso}})\n$$\nwhere:\n- $E_{\\mathrm{slab+ads}}$ is the total energy of the relaxed slab with the adsorbate on its surface.\n- $E_{\\mathrm{slab}}$ is the total energy of the relaxed clean slab.\n- $E_{\\mathrm{ads}}^{\\mathrm{iso}}$ is the total energy of the relaxed isolated adsorbate molecule, computed in the same supercell to ensure consistency of the energy reference and cancellation of basis set superposition error (BSSE), although GGA is less sensitive to BSSE than some other methods.\n\nUsing the given values:\n$E_{\\mathrm{slab}} = -256.873\\,\\mathrm{eV}$\n$E_{\\mathrm{ads}}^{\\mathrm{iso}} = -14.209\\,\\mathrm{eV}$\n$E_{\\mathrm{slab+ads}} = -271.427\\,\\mathrm{eV}$\n\nFirst, we calculate the total energy of the reactants:\n$$\nE_{\\mathrm{reactants}} = E_{\\mathrm{slab}} + E_{\\mathrm{ads}}^{\\mathrm{iso}} = -256.873\\,\\mathrm{eV} + (-14.209\\,\\mathrm{eV}) = -271.082\\,\\mathrm{eV}\n$$\nNow, we can compute the adsorption energy:\n$$\nE_{\\mathrm{ads}} = E_{\\mathrm{slab+ads}} - E_{\\mathrm{reactants}} = -271.427\\,\\mathrm{eV} - (-271.082\\,\\mathrm{eV})\n$$\n$$\nE_{\\mathrm{ads}} = -271.427\\,\\mathrm{eV} + 271.082\\,\\mathrm{eV} = -0.345\\,\\mathrm{eV}\n$$\nThe negative sign of the adsorption energy indicates that the process is exothermic, meaning energy is released upon adsorption and the bound state is more stable than the separated components. This is a necessary condition for spontaneous adsorption to occur.\n\nThe problem requires the answer to be rounded to three significant figures. The calculated value of $-0.345\\,\\mathrm{eV}$ already has three significant figures (the digits $3$, $4$, and $5$).\n\n**Part 2: Meaning of the Force Criterion and Convergence Assessment**\n\nA structural relaxation in a quantum mechanical calculation aims to find a local minimum on the Born-Oppenheimer potential energy surface (PES). The PES describes the system's total energy as a function of the positions of its atomic nuclei. A stable equilibrium geometry corresponds to a point where the energy is at a local minimum.\n\nFrom mechanics, a condition for equilibrium is that the net force on each atom is zero. In the context of the PES, the force $\\vec{F}_i$ on an atom $i$ is the negative gradient of the total energy $E$ with respect to the atom's coordinates $\\vec{r}_i$:\n$$\n\\vec{F}_i = -\\nabla_{\\vec{r}_i} E\n$$\nThus, at a local minimum (or any stationary point) of the PES, the forces on all atoms are zero.\n\nIn a numerical computation, it is practically impossible to find a geometry where all forces are exactly zero. Instead, a relaxation is considered \"converged\" when the forces on all unconstrained atoms are smaller than a predefined, small positive value, known as the force convergence threshold. The \"maximum force criterion\" specifies that the magnitude of the largest force vector among all unconstrained atoms in the system must be less than this threshold. This ensures that the system is very close to a stationary point on the PES and that any further structural changes would result in a negligible change in total energy.\n\nFor the given problem:\n- The force convergence threshold is set to $0.020\\,\\mathrm{eV}/\\AA$.\n- The magnitudes of the three largest residual forces are reported as $0.012\\,\\mathrm{eV}/\\AA$, $0.019\\,\\mathrm{eV}/\\AA$, and $0.017\\,\\mathrm{eV}/\\AA$.\n- The maximum of these forces is $\\max(0.012, 0.019, 0.017) = 0.019\\,\\mathrm{eV}/\\AA$.\n\nTo assess convergence, we compare the maximum observed force to the threshold:\n$$\n0.019\\,\\mathrm{eV}/\\AA < 0.020\\,\\mathrm{eV}/\\AA\n$$\nSince the largest residual force in the system is smaller than the specified convergence threshold, the structural relaxation is considered successfully converged according to the given criterion.",
            "answer": "$$\n\\boxed{-0.345}\n$$"
        },
        {
            "introduction": "Real catalytic surfaces often feature a variety of adsorbate coverages, and interactions between adsorbates can significantly alter binding strength. To make meaningful comparisons between systems of different sizes or coverages, we must move from extensive total energies to intensive, normalized quantities. This exercise will guide you through calculating adsorption energy per molecule and per surface site, which are essential for understanding coverage effects and constructing surface phase diagrams.",
            "id": "3867652",
            "problem": "A catalytic surface is modeled using periodic slabs in first-principles calculations based on Density Functional Theory (DFT). Consider carbon monoxide adsorption on a metal surface that has one adsorption site per $(1 \\times 1)$ primitive surface cell. A monolayer (ML) is defined as one molecule per adsorption site. For each supercell, you are given the total energy of the clean slab, the total energy of the adsorbed system, and the total energy of the gas-phase carbon monoxide molecule computed with identical numerical settings to ensure consistent references.\n\nData:\n- Clean slab total energies: $(1 \\times 1)$: $E_{\\mathrm{slab}}^{1 \\times 1} = -125.000\\,\\mathrm{eV}$; $(2 \\times 2)$: $E_{\\mathrm{slab}}^{2 \\times 2} = -500.100\\,\\mathrm{eV}$; $(3 \\times 3)$: $E_{\\mathrm{slab}}^{3 \\times 3} = -1125.300\\,\\mathrm{eV}$.\n- Gas-phase carbon monoxide total energy: $E_{\\mathrm{CO(g)}} = -14.000\\,\\mathrm{eV}$.\n- Adsorbed systems:\n  - $(1 \\times 1)$ with $N=1$ carbon monoxide: $E_{\\mathrm{tot}}^{1 \\times 1 + 1\\ \\mathrm{CO}} = -141.500\\,\\mathrm{eV}$.\n  - $(2 \\times 2)$ with $N=1$ carbon monoxide: $E_{\\mathrm{tot}}^{2 \\times 2 + 1\\ \\mathrm{CO}} = -516.900\\,\\mathrm{eV}$.\n  - $(3 \\times 3)$ with $N=2$ carbon monoxide: $E_{\\mathrm{tot}}^{3 \\times 3 + 2\\ \\mathrm{CO}} = -1158.700\\,\\mathrm{eV}$.\n\nAssume that adding $N$ molecules from a large gas-phase reservoir to the surface changes the total energy by the adsorption energy, and that negative adsorption energies indicate exothermic binding. The surface has $N_{\\mathrm{sites}}$ adsorption sites per supercell equal to the number of $(1 \\times 1)$ units contained in the supercell (for example, $N_{\\mathrm{sites}}=4$ for a $(2 \\times 2)$ supercell). Coverage is defined as $\\theta = N/N_{\\mathrm{sites}}$.\n\nTasks:\n1. Using only the definition of adsorption energy as a change in total energy upon transferring $N$ molecules from the gas-phase reservoir to the slab, compute the adsorption energy per molecule for each of the three adsorbed systems above at their respective coverages.\n2. Compute the adsorption energy per surface site for each case by normalizing the total adsorption energy to $N_{\\mathrm{sites}}$.\n3. Briefly explain, in terms of energetic normalization, how to compare adsorption energetics across different supercells and coverages, and why per-molecule and per-site quantities are appropriate.\n4. Report the adsorption energy per surface site corresponding to the $(2 \\times 2)$ supercell with $N=1$ carbon monoxide (coverage $\\theta = 1/4\\,\\mathrm{ML}$). Express the final energy in electron-volts (eV) and round your answer to four significant figures.",
            "solution": "### Solution\nThe adsorption energy, $E_{\\mathrm{ads}}$, is defined as the change in total energy when $N$ molecules are transferred from a gas-phase reservoir to a clean surface slab. The total adsorption energy, $E_{\\mathrm{ads,tot}}$, for a system with $N$ adsorbed molecules in a supercell is given by the formula:\n$$E_{\\mathrm{ads,tot}} = E_{\\mathrm{tot,ads\\_system}} - (E_{\\mathrm{slab}} + N \\cdot E_{\\mathrm{gas\\_molecule}})$$\nwhere $E_{\\mathrm{tot,ads\\_system}}$ is the total energy of the slab with adsorbates, $E_{\\mathrm{slab}}$ is the total energy of the clean slab, and $E_{\\mathrm{gas\\_molecule}}$ is the total energy of one molecule in the gas phase.\n\n**1. Adsorption Energy Per Molecule ($E_{\\mathrm{ads/mol}}$)**\n\nThe adsorption energy per molecule is the total adsorption energy normalized by the number of adsorbed molecules, $N$:\n$$E_{\\mathrm{ads/mol}} = \\frac{E_{\\mathrm{ads,tot}}}{N} = \\frac{E_{\\mathrm{tot,ads\\_system}} - E_{\\mathrm{slab}} - N \\cdot E_{\\mathrm{CO(g)}}}{N}$$\n\nWe apply this formula to the three cases provided.\n\n- **Case 1: $(1 \\times 1)$ supercell with $N=1$ CO**\n  The number of sites is $N_{\\mathrm{sites}} = 1^2 = 1$. The coverage is $\\theta = N/N_{\\mathrm{sites}} = 1/1 = 1\\,\\mathrm{ML}$.\n  $$E_{\\mathrm{ads/mol}}^{(1 \\times 1)} = \\frac{E_{\\mathrm{tot}}^{1 \\times 1 + 1\\ \\mathrm{CO}} - E_{\\mathrm{slab}}^{1 \\times 1} - 1 \\cdot E_{\\mathrm{CO(g)}}}{1} = \\frac{-141.500\\,\\mathrm{eV} - (-125.000\\,\\mathrm{eV}) - (-14.000\\,\\mathrm{eV})}{1} = -2.500\\,\\mathrm{eV}$$\n\n- **Case 2: $(2 \\times 2)$ supercell with $N=1$ CO**\n  The number of sites is $N_{\\mathrm{sites}} = 2^2 = 4$. The coverage is $\\theta = N/N_{\\mathrm{sites}} = 1/4 = 0.25\\,\\mathrm{ML}$.\n  $$E_{\\mathrm{ads/mol}}^{(2 \\times 2)} = \\frac{E_{\\mathrm{tot}}^{2 \\times 2 + 1\\ \\mathrm{CO}} - E_{\\mathrm{slab}}^{2 \\times 2} - 1 \\cdot E_{\\mathrm{CO(g)}}}{1} = \\frac{-516.900\\,\\mathrm{eV} - (-500.100\\,\\mathrm{eV}) - (-14.000\\,\\mathrm{eV})}{1} = -2.800\\,\\mathrm{eV}$$\n\n- **Case 3: $(3 \\times 3)$ supercell with $N=2$ CO**\n  The number of sites is $N_{\\mathrm{sites}} = 3^2 = 9$. The coverage is $\\theta = N/N_{\\mathrm{sites}} = 2/9 \\approx 0.22\\,\\mathrm{ML}$.\n  $$E_{\\mathrm{ads/mol}}^{(3 \\times 3)} = \\frac{E_{\\mathrm{tot}}^{3 \\times 3 + 2\\ \\mathrm{CO}} - E_{\\mathrm{slab}}^{3 \\times 3} - 2 \\cdot E_{\\mathrm{CO(g)}}}{2} = \\frac{-1158.700\\,\\mathrm{eV} - (-1125.300\\,\\mathrm{eV}) - 2 \\cdot (-14.000\\,\\mathrm{eV})}{2} = \\frac{-33.400\\,\\mathrm{eV} + 28.000\\,\\mathrm{eV}}{2} = \\frac{-5.400\\,\\mathrm{eV}}{2} = -2.700\\,\\mathrm{eV}$$\n\n**2. Adsorption Energy Per Surface Site ($E_{\\mathrm{ads/site}}$)**\n\nThe adsorption energy per surface site is the total adsorption energy normalized by the number of available adsorption sites in the supercell, $N_{\\mathrm{sites}}$:\n$$E_{\\mathrm{ads/site}} = \\frac{E_{\\mathrm{ads,tot}}}{N_{\\mathrm{sites}}} = \\frac{E_{\\mathrm{tot,ads\\_system}} - E_{\\mathrm{slab}} - N \\cdot E_{\\mathrm{CO(g)}}}{N_{\\mathrm{sites}}}$$\nThis can also be calculated from the per-molecule energy and coverage: $E_{\\mathrm{ads/site}} = \\theta \\cdot E_{\\mathrm{ads/mol}}$.\n\n- **Case 1: $(1 \\times 1)$ supercell with $N=1$ CO**\n  $$E_{\\mathrm{ads/site}}^{(1 \\times 1)} = \\frac{E_{\\mathrm{ads,tot}}^{(1 \\times 1)}}{N_{\\mathrm{sites}}} = \\frac{-2.500\\,\\mathrm{eV}}{1} = -2.500\\,\\mathrm{eV/site}$$\n\n- **Case 2: $(2 \\times 2)$ supercell with $N=1$ CO**\n  $$E_{\\mathrm{ads/site}}^{(2 \\times 2)} = \\frac{E_{\\mathrm{ads,tot}}^{(2 \\times 2)}}{N_{\\mathrm{sites}}} = \\frac{-2.800\\,\\mathrm{eV}}{4} = -0.700\\,\\mathrm{eV/site}$$\n\n- **Case 3: $(3 \\times 3)$ supercell with $N=2$ CO**\n  The total adsorption energy is $E_{\\mathrm{ads,tot}}^{(3 \\times 3)} = 2 \\cdot E_{\\mathrm{ads/mol}}^{(3 \\times 3)} = 2 \\cdot (-2.700\\,\\mathrm{eV}) = -5.400\\,\\mathrm{eV}$.\n  $$E_{\\mathrm{ads/site}}^{(3 \\times 3)} = \\frac{E_{\\mathrm{ads,tot}}^{(3 \\times 3)}}{N_{\\mathrm{sites}}} = \\frac{-5.400\\,\\mathrm{eV}}{9} = -0.600\\,\\mathrm{eV/site}$$\n\n**3. Explanation of Energetic Normalization**\n\nIn computational surface science, simulations are performed on supercells of varying sizes and with different numbers of adsorbates. Total energies are extensive quantities that depend on the size of the system and are therefore not directly comparable. Normalization is essential to derive intensive quantities that allow for meaningful comparison across different calculations.\n\n- **Adsorption energy per molecule ($E_{\\mathrm{ads/mol}}$)**: This quantity normalizes the total adsorption energy by the number of adsorbates, $N$. It represents the average binding energy of a single adsorbate molecule at a specific coverage. Comparing $E_{\\mathrm{ads/mol}}$ at different coverages reveals the strength of adsorbate-adsorbate interactions. In this problem, the adsorption is strongest ($-2.800\\,\\mathrm{eV}$) at the lowest coverage ($\\theta=0.25\\,\\mathrm{ML}$), indicating that repulsive interactions likely weaken the binding at higher coverages (e.g., at $\\theta=1.0\\,\\mathrm{ML}$, the binding strength is only $-2.500\\,\\mathrm{eV}$).\n\n- **Adsorption energy per surface site ($E_{\\mathrm{ads/site}}$)**: This quantity normalizes the total adsorption energy by the number of surface sites, $N_{\\mathrm{sites}}$, which is a proxy for the surface area. It represents the change in the surface energy per unit area due to adsorption. This metric is crucial for constructing surface phase diagrams within the framework of ab initio atomistic thermodynamics. It allows for the direct comparison of the thermodynamic stability of different surface coverages and configurations under given external conditions (temperature and pressure), as the most stable surface is the one that minimizes the total surface free energy.\n\n**4. Final Answer Calculation**\n\nThe task is to report the adsorption energy per surface site for the $(2 \\times 2)$ supercell with $N=1$ carbon monoxide. This corresponds to the value calculated for Case 2 in part 2.\n$$E_{\\mathrm{ads/site}}^{(2 \\times 2)} = -0.700\\,\\mathrm{eV/site}$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value is exactly $-0.700$. To express it with four significant figures, we write it as $-0.7000$.",
            "answer": "$$\n\\boxed{-0.7000}\n$$"
        },
        {
            "introduction": "A geometry optimization routine finds a stationary point on the potential energy surface, where forces are zero, but this does not guarantee the structure is a stable minimum. It could be a transition state, or saddle point, which is crucial for studying reaction barriers but not for stable adsorption. This practice delves into the definitive method for validating a minimum: vibrational frequency analysis. By analyzing the eigenvalues of the mass-weighted Hessian matrix, you can confirm that your structure is a true minimum, characterized by all real vibrational frequencies, and not an unstable configuration.",
            "id": "3867632",
            "problem": "You are given a reduced vibrational analysis task drawn from adsorption geometry validation in computational catalysis and chemical engineering. The objective is to determine whether a reported adsorption geometry corresponds to a true minimum on the Potential Energy Surface (PES) or to a saddle point, by using vibrational analysis and eigenmode inspection. The fundamental base for the derivation and algorithm shall begin from the Born–Oppenheimer approximation and the second-order Taylor expansion of the potential energy about a stationary point, together with the definition of the Hessian matrix and mass-weighting for normal mode analysis.\n\nStart from the following fundamental principles:\n\n1. Under the Born–Oppenheimer approximation, the PES $V(\\mathbf{R})$ depends on nuclear coordinates $\\mathbf{R}$, and a stationary point $\\mathbf{R}_0$ satisfies $\\nabla V(\\mathbf{R}_0) = \\mathbf{0}$.\n\n2. The second-order Taylor expansion of the potential energy around $\\mathbf{R}_0$ is $V(\\mathbf{R}_0 + \\Delta \\mathbf{R}) \\approx V(\\mathbf{R}_0) + \\tfrac{1}{2}\\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}$, where $\\mathbf{K}$ is the Hessian matrix of second derivatives with components $K_{\\alpha\\beta} = \\left. \\dfrac{\\partial^2 V}{\\partial R_{\\alpha} \\partial R_{\\beta}}\\right|_{\\mathbf{R}_0}$.\n\n3. Define the diagonal mass matrix $\\mathbf{M}$ containing the masses of the atoms repeated per coordinate, and the mass-weighted Hessian $\\mathbf{F} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$. Normal mode analysis solves the eigenproblem $\\mathbf{F} \\mathbf{v}_i = \\lambda_i \\mathbf{v}_i$, where $\\lambda_i$ are curvature eigenvalues proportional to squared angular frequencies in consistent units.\n\n4. A true minimum is characterized by a positive semidefinite Hessian after removing rigid translations and rotations; equivalently, for the mass-weighted Hessian $\\mathbf{F}$, one must have $\\lambda_i \\ge 0$ for all $i$ up to numerical tolerance. A first-order saddle has exactly one negative eigenvalue $\\lambda_i < 0$, which corresponds to an imaginary frequency along an unstable eigenmode.\n\nYour program must implement the following algorithm:\n\n- Given a symmetric Hessian $\\mathbf{K}$ and a list of atomic masses $m_j$, construct the diagonal mass-weighting $d_\\alpha = 1/\\sqrt{m_\\alpha}$ for each coordinate $\\alpha$ and compute $\\mathbf{F} = \\mathrm{diag}(d) \\, \\mathbf{K} \\, \\mathrm{diag}(d)$.\n\n- Compute all eigenvalues $\\lambda_i$ and orthonormal eigenvectors $\\mathbf{v}_i$ of $\\mathbf{F}$.\n\n- Use a strict numerical threshold $\\varepsilon$ to distinguish physical negativity from numerical noise. Count the number of imaginary modes $N_{\\mathrm{imag}}$ as the number of eigenvalues satisfying $\\lambda_i < -\\varepsilon$.\n\n- Determine a boolean classification $b_{\\mathrm{min}}$ that is $b_{\\mathrm{min}} = \\mathrm{True}$ if $N_{\\mathrm{imag}} = 0$, and $b_{\\mathrm{min}} = \\mathrm{False}$ otherwise.\n\n- If $N_{\\mathrm{imag}} > 0$, identify the most negative eigenvalue $\\lambda_{\\min}$ and its eigenvector $\\mathbf{v}_{\\min}$, and compute the adsorbate localization metric $L_{\\mathrm{ads}} = \\dfrac{\\sum_{\\alpha \\in \\mathcal{A}} v_{\\min,\\alpha}^2}{\\sum_{\\alpha} v_{\\min,\\alpha}^2}$, where $\\mathcal{A}$ is the set of coordinate indices belonging to the adsorbate. If $N_{\\mathrm{imag}} = 0$, define $L_{\\mathrm{ads}} = 0$.\n\nAll mathematical entities in this problem must be treated in LaTeX as above, and the logic must be expressed surgically without shortcut formulas beyond the base principles listed. The result is purely computational and does not require reporting physical units because only signs of curvature (eigenvalues) and a dimensionless localization metric are used. Angles do not apply, and percentages must not be used; $L_{\\mathrm{ads}}$ is a decimal between $0$ and $1$.\n\nImplement and test your solution on the following test suite. Each test case specifies $(\\mathbf{K}, \\mathbf{m}, \\mathcal{A}, \\varepsilon)$:\n\n- Test case $1$ (happy path minimum): A stable adsorption geometry with positive-definite curvature. Use\n$$\n\\mathbf{K}_1 = \\begin{bmatrix}\n8.0 & 0.2 & 0.0 \\\\\n0.2 & 12.0 & 0.1 \\\\\n0.0 & 0.1 & 15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_1 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_1 = \\{0\\}, \\quad\n\\varepsilon_1 = 1\\times 10^{-6}.\n$$\n\n- Test case $2$ (first-order saddle along adsorbate coordinate): An unstable direction dominated by the adsorbate normal mode. Use\n$$\n\\mathbf{K}_2 = \\begin{bmatrix}\n-1.0 & 0.1 & 0.0 \\\\\n0.1 & 12.0 & 0.1 \\\\\n0.0 & 0.1 & 15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_2 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_2 = \\{0\\}, \\quad\n\\varepsilon_2 = 1\\times 10^{-6}.\n$$\n\n- Test case $3$ (first-order saddle localized on the surface): An unstable direction dominated by a surface atom mode. Use\n$$\n\\mathbf{K}_3 = \\begin{bmatrix}\n8.0 & 0.1 & 0.0 \\\\\n0.1 & 12.0 & 0.1 \\\\\n0.0 & 0.1 & -0.5\n\\end{bmatrix}, \\quad\n\\mathbf{m}_3 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_3 = \\{0\\}, \\quad\n\\varepsilon_3 = 1\\times 10^{-6}.\n$$\n\n- Test case $4$ (near-zero numerical noise): Apparent tiny negative curvature well within numerical tolerance, to be treated as zero. Use\n$$\n\\mathbf{K}_4 = \\begin{bmatrix}\n8.0 & 0.0 & 0.0 \\\\\n0.0 & -1\\times 10^{-8} & 0.0 \\\\\n0.0 & 0.0 & 15.0\n\\end{bmatrix}, \\quad\n\\mathbf{m}_4 = [15.999, 195.084, 195.084], \\quad\n\\mathcal{A}_4 = \\{0\\}, \\quad\n\\varepsilon_4 = 1\\times 10^{-6}.\n$$\n\nYour program must evaluate each test case according to the algorithm above and produce the final output as a single line containing a comma-separated list of per-test-case results, where each per-test-case result is a list of the form $[b_{\\mathrm{min}}, N_{\\mathrm{imag}}, L_{\\mathrm{ads}}]$. The output format must be exactly one line with no spaces, for example:\n$$\n\\text{[[True,0,0.000],[False,1,0.985],[False,1,0.013],[True,0,0.000]]}\n$$\nThe numeric value of $L_{\\mathrm{ads}}$ must be rounded to three decimal places. The booleans must appear as either $\\text{True}$ or $\\text{False}$.",
            "solution": "The theoretical foundation for this analysis resides in the application of classical mechanics to molecular vibrations under the Born-Oppenheimer approximation. According to this approximation, the electronic and nuclear motions can be decoupled, allowing for the definition of a potential energy surface (PES), denoted as $V(\\mathbf{R})$, which is a function solely of the nuclear coordinates $\\mathbf{R}$.\n\nStationary points on the PES, $\\mathbf{R}_0$, are of primary interest as they represent equilibrium geometries (minima) or transition states (saddle points). At these points, the net force on every nucleus is zero, which is mathematically expressed as the vanishing of the potential energy gradient:\n$$\n\\nabla V(\\mathbf{R}_0) = \\mathbf{0}\n$$\nTo determine the nature of a stationary point (i.e., whether it is a minimum, maximum, or saddle point), one must examine the curvature of the PES in its vicinity. This is accomplished by performing a second-order Taylor expansion of the potential energy $V(\\mathbf{R})$ around the stationary point $\\mathbf{R}_0$. For a small displacement $\\Delta \\mathbf{R} = \\mathbf{R} - \\mathbf{R}_0$, the potential energy is approximated as:\n$$\nV(\\mathbf{R}) \\approx V(\\mathbf{R}_0) + \\nabla V(\\mathbf{R}_0)^{\\top} \\Delta \\mathbf{R} + \\frac{1}{2} \\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}\n$$\nSince $\\nabla V(\\mathbf{R}_0) = \\mathbf{0}$, this simplifies to:\n$$\nV(\\mathbf{R}) - V(\\mathbf{R}_0) \\approx \\frac{1}{2} \\Delta \\mathbf{R}^{\\top} \\mathbf{K} \\Delta \\mathbf{R}\n$$\nHere, $\\mathbf{K}$ is the Hessian matrix, a symmetric matrix of second partial derivatives of the potential energy with respect to the nuclear coordinates, evaluated at the stationary point $\\mathbf{R}_0$:\n$$\nK_{\\alpha\\beta} = \\left. \\frac{\\partial^2 V}{\\partial R_{\\alpha} \\partial R_{\\beta}} \\right|_{\\mathbf{R}_0}\n$$\nThe classical equation of motion for small vibrations around $\\mathbf{R}_0$ is derived from the Lagrangian $\\mathcal{L} = T - V$. The kinetic energy $T$ is given by $T = \\frac{1}{2} \\dot{\\mathbf{R}}^{\\top} \\mathbf{M} \\dot{\\mathbf{R}}$, where $\\mathbf{M}$ is the diagonal matrix of atomic masses corresponding to the coordinates in $\\mathbf{R}$. The resulting equation of motion in terms of the displacement coordinates $\\Delta \\mathbf{R}$ is:\n$$\n\\mathbf{M} \\ddot{\\Delta \\mathbf{R}} = -\\mathbf{K} \\Delta \\mathbf{R}\n$$\nThis is a system of coupled second-order differential equations. To decouple them, we seek normal modes of vibration by assuming a harmonic solution of the form $\\Delta \\mathbf{R}(t) = \\mathbf{A} e^{i\\omega t}$. Substituting this into the equation of motion yields a generalized eigenvalue problem:\n$$\n\\mathbf{K} \\mathbf{A} = \\omega^2 \\mathbf{M} \\mathbf{A}\n$$\nTo convert this into a standard eigenvalue problem, we introduce mass-weighted coordinates, $\\mathbf{q} = \\mathbf{M}^{1/2} \\Delta \\mathbf{R}$. The corresponding transformation is $\\Delta \\mathbf{R} = \\mathbf{M}^{-1/2} \\mathbf{q}$. Substituting this into the equation of motion and pre-multiplying by $\\mathbf{M}^{-1/2}$ gives:\n$$\n\\mathbf{M}^{-1/2} \\mathbf{M} (\\mathbf{M}^{-1/2} \\ddot{\\mathbf{q}}) = -\\mathbf{M}^{-1/2} \\mathbf{K} (\\mathbf{M}^{-1/2} \\mathbf{q})\n$$\n$$\n\\ddot{\\mathbf{q}} = -(\\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}) \\mathbf{q}\n$$\nWe define the mass-weighted Hessian matrix $\\mathbf{F} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$. The equation of motion becomes $\\ddot{\\mathbf{q}} = -\\mathbf{F} \\mathbf{q}$. Solving this via the standard eigenvalue problem $\\mathbf{F} \\mathbf{v}_i = \\lambda_i \\mathbf{v}_i$ gives the eigenvalues $\\lambda_i = \\omega_i^2$ (proportional to squared vibrational frequencies) and the eigenvectors $\\mathbf{v}_i$ (the normal modes in mass-weighted coordinates).\n\nThe signs of the eigenvalues $\\lambda_i$ classify the stationary point:\n- If all $\\lambda_i \\geq 0$ (after excluding zero-frequency modes corresponding to rigid-body translation and rotation, which are not a factor in this simplified problem), the stationary point is a true local minimum on the PES. Every vibrational mode corresponds to a real frequency $\\omega_i = \\sqrt{\\lambda_i}$.\n- If one or more eigenvalues $\\lambda_i$ are negative, the stationary point is a saddle point. A negative eigenvalue $\\lambda_i < 0$ corresponds to an imaginary frequency $\\omega_i = i\\sqrt{|\\lambda_i|}$, indicating an unstable mode along which the energy decreases. The number of negative eigenvalues, $N_{\\mathrm{imag}}$, defines the order of the saddle point. A first-order saddle point, a common representation of a transition state, has exactly one negative eigenvalue.\n\nThe algorithm to be implemented follows this derivation directly.\n\n1.  For each test case, we are given the Cartesian Hessian matrix $\\mathbf{K}$, a list of masses $\\mathbf{m}$ corresponding to each coordinate, the set of adsorbate coordinate indices $\\mathcal{A}$, and a numerical threshold $\\varepsilon$.\n2.  Construct the diagonal mass-weighting vector $d$ with elements $d_\\alpha = 1/\\sqrt{m_\\alpha}$.\n3.  Compute the symmetric, mass-weighted Hessian matrix $\\mathbf{F}$ as $\\mathbf{F} = \\mathrm{diag}(d) \\, \\mathbf{K} \\, \\mathrm{diag}(d)$.\n4.  Solve the standard eigenproblem for $\\mathbf{F}$ to obtain its eigenvalues $\\lambda_i$ and corresponding orthonormal eigenvectors $\\mathbf{v}_i$.\n5.  Count the number of imaginary modes, $N_{\\mathrm{imag}}$, by identifying how many eigenvalues are negative beyond the numerical tolerance: $N_{\\mathrm{imag}} = \\text{count of } \\{\\lambda_i | \\lambda_i < -\\varepsilon\\}$.\n6.  The geometry is classified as a minimum if and only if there are no such imaginary modes. Thus, the boolean classification is $b_{\\mathrm{min}} = (N_{\\mathrm{imag}} = 0)$.\n7.  If $N_{\\mathrm{imag}} > 0$, we identify the unstable mode associated with the most negative eigenvalue, $\\lambda_{\\min}$, and its eigenvector, $\\mathbf{v}_{\\min}$. The adsorbate localization metric, $L_{\\mathrm{ads}}$, is computed to quantify the degree to which this unstable mode involves motions of the adsorbate coordinates. Given that the eigenvectors $\\mathbf{v}_i$ are normalized such that $\\sum_{\\alpha} v_{i,\\alpha}^2 = 1$, the metric simplifies to a sum over the adsorbate indices: $L_{\\mathrm{ads}} = \\sum_{\\alpha \\in \\mathcal{A}} v_{\\min,\\alpha}^2$.\n8.  If $N_{\\mathrm{imag}} = 0$, the structure is a minimum, and there is no unstable mode to analyze. In this case, $L_{\\mathrm{ads}}$ is defined to be $0$.\n\nThis procedure will be applied to each test case to generate the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vibrational analysis problem for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"K\": np.array([\n                [8.0, 0.2, 0.0],\n                [0.2, 12.0, 0.1],\n                [0.0, 0.1, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [-1.0, 0.1, 0.0],\n                [0.1, 12.0, 0.1],\n                [0.0, 0.1, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [8.0, 0.1, 0.0],\n                [0.1, 12.0, 0.1],\n                [0.0, 0.1, -0.5]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        },\n        {\n            \"K\": np.array([\n                [8.0, 0.0, 0.0],\n                [0.0, -1e-8, 0.0],\n                [0.0, 0.0, 15.0]\n            ]),\n            \"m\": np.array([15.999, 195.084, 195.084]),\n            \"A\": {0},\n            \"eps\": 1e-6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        K = case[\"K\"]\n        m = case[\"m\"]\n        A_indices = case[\"A\"]\n        epsilon = case[\"eps\"]\n\n        # 1. Construct the diagonal mass-weighting vector d_alpha = 1/sqrt(m_alpha).\n        d = 1.0 / np.sqrt(m)\n\n        # 2. Compute the mass-weighted Hessian F = diag(d) * K * diag(d).\n        # This can be done efficiently using broadcasting.\n        F = np.outer(d, d) * K\n\n        # 3. Compute all eigenvalues and orthonormal eigenvectors of F.\n        # np.linalg.eigh is used for symmetric matrices and returns eigenvalues\n        # in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(F)\n\n        # 4. Count the number of imaginary modes N_imag.\n        imaginary_modes_mask = eigenvalues < -epsilon\n        N_imag = np.sum(imaginary_modes_mask)\n\n        # 5. Determine the boolean classification b_min.\n        b_min = (N_imag == 0)\n\n        # 6. Compute adsorbate localization metric L_ads.\n        if N_imag > 0:\n            # Eigenvalues are sorted, so the most negative is the first one.\n            # The corresponding eigenvector is the first column of the eigenvector matrix.\n            v_min = eigenvectors[:, 0]\n            \n            # The denominator sum of squares is 1 for normalized eigenvectors.\n            # We only need to sum the squared components for the adsorbate indices.\n            ads_squared_components = [v_min[i]**2 for i in A_indices]\n            L_ads = np.sum(ads_squared_components)\n        else:\n            # If N_imag is 0, L_ads is defined as 0.\n            L_ads = 0.0\n\n        # Round L_ads to three decimal places.\n        L_ads_rounded = round(L_ads, 3)\n\n        results.append([b_min, int(N_imag), L_ads_rounded])\n\n    # Final print statement in the exact required format.\n    str_results = [f\"[{str(b)},{n},{l:.3f}]\" for b, n, l in results]\n    print(f\"[[{','.join(str_results)}]]\")\n\nsolve()\n```"
        }
    ]
}