{
    "hands_on_practices": [
        {
            "introduction": "在计算催化中，获得可靠的吸附能是至关重要的第一步。本练习将指导您完成一个基本但核心的任务：测试平面波截止能（$E_{\\text{cut}}$）对吸附能计算的收敛性。通过分析一个基于物理模型的能量收敛行为，您将学会如何确定保证结果达到所需数值精度的最小计算参数。",
            "id": "3875446",
            "problem": "您的任务是，在对一氧化碳 (CO) 在铂(111)表面吸附的平面波密度泛函理论 (DFT) 计算中，量化基组收敛性，重点关注数值精度和确定达到指定容差所需的最小平面波动能截断。考虑基于组合体系和孤立体系总能量的吸附能定义，其中吸附能定义为 $E_{\\text{ads}} = E_{\\text{CO/Pt}} - (E_{\\text{Pt}} + E_{\\text{CO}})$，以电子伏特 (eV) 为单位。对于动能截断为 $E_{\\text{cut}}$ (单位为 eV) 的平面波基组，将每个体系计算出的总能量建模为通过幂律基组误差从上方收敛到其完全基组极限：\n- $E_{X}(E_{\\text{cut}}) = E_{X}^{\\infty} + \\delta_{X}(E_{\\text{cut}})$,\n- $\\delta_{X}(E_{\\text{cut}}) = c_{X} \\, E_{\\text{cut}}^{-p_{X}}$,\n其中 $X \\in \\{\\text{CO/Pt}, \\text{Pt}, \\text{CO}\\}$，$c_{X} \\ge 0$ 且 $p_{X} > 0$。这里 $E_{X}^{\\infty}$ 表示完全基组能量（$E_{\\text{cut}} \\to \\infty$ 时的极限）。由此，有限截断下的吸附能为\n$$\nE_{\\text{ads}}(E_{\\text{cut}}) = E_{\\text{ads}}^{\\infty} + \\delta_{\\text{CO/Pt}}(E_{\\text{cut}}) - \\delta_{\\text{Pt}}(E_{\\text{cut}}) - \\delta_{\\text{CO}}(E_{\\text{cut}}),\n$$\n其中 $E_{\\text{ads}}^{\\infty} = E_{\\text{CO/Pt}}^{\\infty} - (E_{\\text{Pt}}^{\\infty} + E_{\\text{CO}}^{\\infty})$。\n\n您的程序必须：\n- 在离散的截断能网格 $[200, 300, 400, 500, 600, 700, 800]$ eV 上评估 $E_{\\text{ads}}(E_{\\text{cut}})$（即，在 $E_{\\text{cut}} = 200, 300, 400, 500, 600, 700, 800$ eV 时，单位均为 eV）。\n- 对于下面的每个测试用例，确定所提供网格中的最小 $E_{\\text{cut}}$，使得相对于最高截断结果 $E_{\\text{ads}}(800)$ 的吸附能绝对变化小于或等于 $0.010$ eV（即 $|E_{\\text{ads}}(E_{\\text{cut}}) - E_{\\text{ads}}(800)| \\le 0.010$）。报告最小的 $E_{\\text{cut}}$，单位为 eV。\n\n使用以下参数值的测试套件。每个用例都指定了 $E_{\\text{ads}}^{\\infty}$，$c_{\\text{CO/Pt}}$，$p_{\\text{CO/Pt}}$，$c_{\\text{Pt}}$，$p_{\\text{Pt}}$，$c_{\\text{CO}}$，$p_{\\text{CO}}$：\n- 用例 1（中等误差，部分抵消）：$E_{\\text{ads}}^{\\infty} = -1.60$ eV, $c_{\\text{CO/Pt}} = 200$, $p_{\\text{CO/Pt}} = 1.6$, $c_{\\text{Pt}} = 250$, $p_{\\text{Pt}} = 1.5$, $c_{\\text{CO}} = 80$, $p_{\\text{CO}} = 2.0$。\n- 用例 2（由于强抵消而提早收敛）：$E_{\\text{ads}}^{\\infty} = -1.75$ eV, $c_{\\text{CO/Pt}} = 600$, $p_{\\text{CO/Pt}} = 1.5$, $c_{\\text{Pt}} = 580$, $p_{\\text{Pt}} = 1.5$, $c_{\\text{CO}} = 5$, $p_{\\text{CO}} = 2.2$。\n- 用例 3（由吸附体系主导的缓慢收敛）：$E_{\\text{ads}}^{\\infty} = -1.50$ eV, $c_{\\text{CO/Pt}} = 400$, $p_{\\text{CO/Pt}} = 1.4$, $c_{\\text{Pt}} = 200$, $p_{\\text{Pt}} = 2.5$, $c_{\\text{CO}} = 50$, $p_{\\text{CO}} = 2.0$。\n- 用例 4（仅在最高截断下满足阈值）：$E_{\\text{ads}}^{\\infty} = -2.00$ eV, $c_{\\text{CO/Pt}} = 1000$, $p_{\\text{CO/Pt}} = 1.3$, $c_{\\text{Pt}} = 100$, $p_{\\text{Pt}} = 1.3$, $c_{\\text{CO}} = 50$, $p_{\\text{CO}} = 1.3$。\n\n物理和数值单位：\n- 所有能量必须以 eV 为单位处理和解释。\n- 以数值形式报告最小截断能，单位为 eV。\n- 不涉及角度。\n- 容差为 $0.010$ eV，相当于 $10$ meV。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个用例的最小截断能，格式为方括号括起来的逗号分隔列表，每个元素都是一个以 eV 为单位的数字，例如 $[500,200,700,800]$。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于计算材料科学的原理，特别是密度泛函理论 (DFT) 的计算。该问题定义明确，提供了清晰的数学模型、每个测试用例的完整参数集以及明确的目标。术语客观而精确，设置内部一致且无矛盾。\n\n任务是确定所需的最小平面波动能截断 $E_{\\text{cut}}$，以将计算出的吸附能 $E_{\\text{ads}}$ 收敛到指定的数值容差内。这是计算研究中一个标准且关键的步骤，旨在通过平衡计算成本和精度来确保结果的数值准确性。\n\n吸附能 $E_{\\text{ads}}$ 定义为组合体系（吸附物在衬底上）的总能量与孤立组分能量之和的差值：\n$$E_{\\text{ads}} = E_{\\text{CO/Pt}} - (E_{\\text{Pt}} + E_{\\text{CO}})$$\n在任何使用有限基组（如 DFT 中的平面波基组）的实际计算中，任何体系 $X$ 的计算总能量（表示为 $E_{X}(E_{\\text{cut}})$）都会偏离真实的完全基组极限 $E_{X}^{\\infty}$。这种偏差就是基组不完备性误差 $\\delta_{X}(E_{\\text{cut}})$。问题为这个误差提供了一个经验驱动的幂律模型，该模型依赖于动能截断 $E_{\\text{cut}}$：\n$$E_{X}(E_{\\text{cut}}) = E_{X}^{\\infty} + \\delta_{X}(E_{\\text{cut}})$$\n其中误差项由下式给出：\n$$\\delta_{X}(E_{\\text{cut}}) = c_{X} \\, E_{\\text{cut}}^{-p_{X}}$$\n参数 $c_X$ 和 $p_X$ 取决于体系 $X$ 和计算的具体细节（例如，赝势）。对于所涉及的三个体系——组合的铂板上的一氧化碳（$X = \\text{CO/Pt}$）、裸铂板（$X = \\text{Pt}$）和孤立的一氧化碳分子（$X = \\text{CO}$）——在有限截断 $E_{\\text{cut}}$ 下的吸附能可以表示为：\n$$E_{\\text{ads}}(E_{\\text{cut}}) = E_{\\text{CO/Pt}}(E_{\\text{cut}}) - (E_{\\text{Pt}}(E_{\\text{cut}}) + E_{\\text{CO}}(E_{\\text{cut}}))$$\n$$E_{\\text{ads}}(E_{\\text{cut}}) = (E_{\\text{CO/Pt}}^{\\infty} + \\delta_{\\text{CO/Pt}}(E_{\\text{cut}})) - ((E_{\\text{Pt}}^{\\infty} + \\delta_{\\text{Pt}}(E_{\\text{cut}})) + (E_{\\text{CO}}^{\\infty} + \\delta_{\\text{CO}}(E_{\\text{cut}})))$$\n通过重新排列并代入定义 $E_{\\text{ads}}^{\\infty} = E_{\\text{CO/Pt}}^{\\infty} - (E_{\\text{Pt}}^{\\infty} + E_{\\text{CO}}^{\\infty})$，我们得到吸附能作为截断能函数的工作方程：\n$$E_{\\text{ads}}(E_{\\text{cut}}) = E_{\\text{ads}}^{\\infty} + \\delta_{\\text{CO/Pt}}(E_{\\text{cut}}) - \\delta_{\\text{Pt}}(E_{\\text{cut}}) - \\delta_{\\text{CO}}(E_{\\text{cut}})$$\n将误差项的幂律形式代入，得到待评估的最终表达式：\n$$E_{\\text{ads}}(E_{\\text{cut}}) = E_{\\text{ads}}^{\\infty} + c_{\\text{CO/Pt}} E_{\\text{cut}}^{-p_{\\text{CO/Pt}}} - c_{\\text{Pt}} E_{\\text{cut}}^{-p_{\\text{Pt}}} - c_{\\text{CO}} E_{\\text{cut}}^{-p_{\\text{CO}}}$$\n目标是从离散值网格 $\\{200, 300, 400, 500, 600, 700, 800\\}$ eV 中找到最小的 $E_{\\text{cut}}$，使得计算出的吸附能充分收敛。收敛性是与在网格中最高截断 $E_{\\text{cut,max}} = 800$ eV 下获得的值进行比较，该值作为可用的最佳参考值 $E_{\\text{ads,ref}}$。收敛标准是绝对容差 $\\tau = 0.010$ eV：\n$$|E_{\\text{ads}}(E_{\\text{cut}}) - E_{\\text{ads,ref}}| \\le \\tau$$\n其中 $E_{\\text{ads,ref}} = E_{\\text{ads}}(800)$。\n\n对于每个测试用例，算法按以下步骤进行：\n1.  使用该用例的参数（$E_{\\text{ads}}^{\\infty}$, $c_{\\text{CO/Pt}}$, $p_{\\text{CO/Pt}}$, $c_{\\text{Pt}}$, $p_{\\text{Pt}}$, $c_{\\text{CO}}$, $p_{\\text{CO}}$）来定义特定的函数 $E_{\\text{ads}}(E_{\\text{cut}})$。\n2.  通过在 $E_{\\text{cut}} = 800$ eV 处评估此函数来计算参考能量 $E_{\\text{ads,ref}}$。\n3.  算法按升序遍历截断能网格 $E_{\\text{cut}} \\in \\{200, 300, 400, 500, 600, 700, 800\\}$ eV。\n4.  对于网格中的每个 $E_{\\text{cut}}$，计算 $E_{\\text{ads}}(E_{\\text{cut}})$，并将其与参考值的绝对差 $|E_{\\text{ads}}(E_{\\text{cut}}) - E_{\\text{ads,ref}}|$ 与容差 $\\tau = 0.010$ eV 进行比较。\n5.  第一个满足不等式的 $E_{\\text{cut}}$ 值即为该用例所需的最小截断能。记录此值。\n对所有四个测试用例重复此过程，并汇编所得的最小截断能。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimal plane-wave kinetic energy cutoff for four test cases\n    of CO adsorption on Pt(111), based on a provided convergence model.\n    \"\"\"\n    \n    # Define the discrete grid of cutoff energies in eV.\n    cutoff_grid = [200, 300, 400, 500, 600, 700, 800]\n    \n    # Define the convergence tolerance in eV.\n    tolerance = 0.010\n    \n    # Define the parameter sets for the four test cases.\n    # Format: (E_ads_inf, c_comp, p_comp, c_surf, p_surf, c_gas, p_gas)\n    # where comp=CO/Pt, surf=Pt, gas=CO.\n    test_cases = [\n        # Case 1: Moderate errors with partial cancellation\n        (-1.60, 200, 1.6, 250, 1.5, 80, 2.0),\n        # Case 2: Early convergence due to strong cancellation\n        (-1.75, 600, 1.5, 580, 1.5, 5, 2.2),\n        # Case 3: Slow convergence dominated by adsorbed system\n        (-1.50, 400, 1.4, 200, 2.5, 50, 2.0),\n        # Case 4: Threshold met only at highest cutoff\n        (-2.00, 1000, 1.3, 100, 1.3, 50, 1.3)\n    ]\n\n    def calculate_e_ads(e_cut, params):\n        \"\"\"\n        Calculates the adsorption energy for a given cutoff and parameter set.\n        \n        Args:\n            e_cut (float): The kinetic energy cutoff in eV.\n            params (tuple): A tuple containing the model parameters:\n                            (E_ads_inf, c_CO/Pt, p_CO/Pt, c_Pt, p_Pt, c_CO, p_CO).\n        \n        Returns:\n            float: The calculated adsorption energy in eV.\n        \"\"\"\n        e_ads_inf, c_comp, p_comp, c_surf, p_surf, c_gas, p_gas = params\n        \n        e_ads = (e_ads_inf +\n                 c_comp * e_cut**(-p_comp) -\n                 c_surf * e_cut**(-p_surf) -\n                 c_gas * e_cut**(-p_gas))\n        return e_ads\n\n    results = []\n    \n    # Process each test case\n    for case_params in test_cases:\n        # Calculate the reference adsorption energy at the highest cutoff\n        e_ads_ref = calculate_e_ads(cutoff_grid[-1], case_params)\n        \n        minimal_cutoff_found = False\n        for e_cut in cutoff_grid:\n            # Calculate the adsorption energy at the current cutoff\n            e_ads_current = calculate_e_ads(e_cut, case_params)\n            \n            # Check if the convergence criterion is met\n            if np.abs(e_ads_current - e_ads_ref) = tolerance:\n                results.append(e_cut)\n                minimal_cutoff_found = True\n                break\n        \n        # This case should not be entered given problem structure,\n        # as the highest cutoff always satisfies the condition.\n        if not minimal_cutoff_found:\n             # Fallback, theoretically unreachable\n            results.append(cutoff_grid[-1])\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然单个体系的总能量计算可能存在显著的数值误差，但我们通常更关心的是能量差，例如吸附能。本练习利用一个参数化模型来揭示一个关键概念：误差对消。您将量化比较总能量的绝对误差和吸附能的最终误差，从而深刻理解为何能量差的计算可以达到比总能量本身高得多的精度。",
            "id": "3875307",
            "problem": "考虑与氢在铂(111)表面吸附相关的三个体系的 Born–Oppenheimer 电子能量 $E$：一个洁净的周期性铂板、一个孤立的氢原子以及带有吸附氢原子的板。将洁净板的能量记为 $E_{\\text{S}}$，孤立氢的能量记为 $E_{\\text{H}}$，带吸附氢的板的能量记为 $E_{\\text{SH}}$，吸附能记为 $\\Delta E_{\\text{ads}} \\equiv E_{\\text{SH}} - E_{\\text{S}} - E_{\\text{H}}$。在计算催化中，这些量通过诸如密度泛函理论 (DFT) 等电子结构方法计算，其收敛性和数值精度由平面波能量截断和布里渊区 (BZ) 采样（$k$点数量）控制。量子力学的变分原理确保了不完备的平面波基组会产生高于收敛值的能量，并且随着平面波能量截断的增加，这种基组误差会单调减小。由布里渊区中有限$k$点采样引起的数值积分误差会随着$k$点数量的增加而减小。\n\n您将实现一个程序，用一个简化的、物理上合理的参数化误差模型来模拟每个体系 $X \\in \\{\\text{S}, \\text{H}, \\text{SH}\\}$ 的这些收敛行为：\n$$\nE_X^{\\text{approx}}(E_{\\text{cut}},K) \\;=\\; E_X^{\\text{true}} \\;+\\; \\frac{\\alpha_X}{E_{\\text{cut}}} \\;+\\; \\frac{\\gamma_X}{E_{\\text{cut}}^2} \\;+\\; \\frac{\\beta_X}{K} \\;+\\; \\frac{\\delta_X}{E_{\\text{cut}}\\,K},\n$$\n其中 $E_{\\text{cut}}$ 是以电子伏特为单位的平面波能量截断， $K$ 是用于采样布里渊区的平面内$k$点总数，模型系数捕捉了领头阶的基组误差和采样误差。对于孤立氢原子，将其视为非周期性计算，因此将采样项设置为零：\n$$\nE_{\\text{H}}^{\\text{approx}}(E_{\\text{cut}}) \\;=\\; E_{\\text{H}}^{\\text{true}} \\;+\\; \\frac{\\alpha_{\\text{H}}}{E_{\\text{cut}}} \\;+\\; \\frac{\\gamma_{\\text{H}}}{E_{\\text{cut}}^2}.\n$$\n定义反映误差大小上定性差异的体系依赖系数：\n- 铂板：$\\alpha_{\\text{S}} = 25\\,\\text{eV}^2$, $\\gamma_{\\text{S}} = 2000\\,\\text{eV}^3$, $\\beta_{\\text{S}} = 1.8\\,\\text{eV}$, $\\delta_{\\text{S}} = 10\\,\\text{eV}^2$。\n- 氢原子：$\\alpha_{\\text{H}} = 5\\,\\text{eV}^2$, $\\gamma_{\\text{H}} = 1000\\,\\text{eV}^3$。\n- 带吸附氢的板：通过乘法因子 $m_\\alpha$ 和 $m_\\beta$ 模拟相对于洁净板在误差特性上物理合理的失配：\n$$\n\\alpha_{\\text{SH}} = \\alpha_{\\text{S}}(1+m_\\alpha), \\quad \\gamma_{\\text{SH}} = \\gamma_{\\text{S}}(1+m_\\alpha), \\quad \\beta_{\\text{SH}} = \\beta_{\\text{S}}(1+m_\\beta), \\quad \\delta_{\\text{SH}} = \\delta_{\\text{S}}(1+m_\\alpha).\n$$\n使用以下真实能量（所有能量以电子伏特表示）：\n$$\nE_{\\text{S}}^{\\text{true}} = -100.000, \\quad E_{\\text{H}}^{\\text{true}} = -13.600, \\quad \\Delta E_{\\text{ads}}^{\\text{true}} = -0.450,\n$$\n并定义 $E_{\\text{SH}}^{\\text{true}} = E_{\\text{S}}^{\\text{true}} + E_{\\text{H}}^{\\text{true}} + \\Delta E_{\\text{ads}}^{\\text{true}} = -114.050$。\n\n对于下方测试套件中的每个参数集 $(E_{\\text{cut}},K,m_\\alpha,m_\\beta)$，您必须：\n1. 计算 $E_{\\text{S}}^{\\text{approx}}$、$E_{\\text{H}}^{\\text{approx}}$、$E_{\\text{SH}}^{\\text{approx}}$，单位为 $\\text{eV}$。\n2. 计算 $\\Delta E_{\\text{ads}}^{\\text{approx}} = E_{\\text{SH}}^{\\text{approx}} - E_{\\text{S}}^{\\text{approx}} - E_{\\text{H}}^{\\text{approx}}$，单位为 $\\text{eV}$。\n3. 计算吸附能绝对误差 $|\\Delta E_{\\text{ads}}^{\\text{approx}} - \\Delta E_{\\text{ads}}^{\\text{true}}|$，单位为 $\\text{eV}$。\n4. 通过以下比率量化误差抵消：\n$$\nC \\;=\\; \\frac{\\left|\\Delta E_{\\text{ads}}^{\\text{approx}} - \\Delta E_{\\text{ads}}^{\\text{true}}\\right|}{\\sqrt{\\frac{\\left(E_{\\text{SH}}^{\\text{approx}}-E_{\\text{SH}}^{\\text{true}}\\right)^2 + \\left(E_{\\text{S}}^{\\text{approx}}-E_{\\text{S}}^{\\text{true}}\\right)^2 + \\left(E_{\\text{H}}^{\\text{approx}}-E_{\\text{H}}^{\\text{true}}\\right)^2}{3}}}.\n$$\n这个 $C$ 值衡量了误差抵消的程度：较小的值表示相对于原始能量误差的大小，抵消作用更强。\n5. 通过评估以下定义的布尔值 $B$ 来判断吸附能是否满足目标精度容差：\n$$\nB \\;=\\; \\left(\\left|\\Delta E_{\\text{ads}}^{\\text{approx}} - \\Delta E_{\\text{ads}}^{\\text{true}}\\right| \\leq 0.020\\right).\n$$\n\n测试套件（每个案例是一个元组 $(E_{\\text{cut}},K,m_\\alpha,m_\\beta)$）：\n- 案例1 (良好收敛，轻度失配): $(500, 36, 0.05, 0.05)$。\n- 案例2 (基组受限，相同采样): $(250, 36, 0.05, 0.05)$。\n- 案例3 (采样受限，采样中较大失配): $(500, 4, 0.05, 0.20)$。\n- 案例4 (两者皆差，强烈失配): $(200, 1, 0.30, 0.30)$。\n- 案例5 (中等设置，不等失配): $(350, 9, 0.20, 0.05)$。\n- 案例6 (近乎理想，无失配): $(600, 100, 0.00, 0.00)$。\n\n所需输出格式：您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试案例，其本身是一个形如\n$$\n[\\Delta E_{\\text{ads}}^{\\text{approx}}\\ \\text{(eV)},\\ |\\text{error}|\\ \\text{(eV)},\\ C,\\ B].\n$$\n的所有浮点数必须四舍五入到六位小数，能量单位必须是电子伏特，布尔值必须报告为 Python 布尔字面量。例如：\n$$\n[[x_1,y_1,z_1,B_1],[x_2,y_2,z_2,B_2],\\ldots]\n$$\n其中 $x_i$、$y_i$、$z_i$ 是以电子伏特为单位的浮点数，$B_i$ 是一个布尔值。\n\n该问题是通用的，因为所有操作都可归结为对所提供的参数和常数进行的算术和逻辑运算；不涉及角度。请遵循所述的参数化模型和单位，以确保科学真实性。",
            "solution": "所提供的问题是有效的。它在科学上基于计算材料科学的原理，特别是关于密度泛函理论 (DFT) 计算中的数值收敛性。该问题是良定的，提供了一套完整且一致的定义、方程和参数。使用参数化模型来研究误差传播和抵消是一种标准的教学工具，它反映了计算研究中的现实挑战。所有术语都得到了客观且明确的定义。该问题要求将提供的公式应用于一组测试案例，这是一项直接且可验证的任务。\n\n问题的核心是使用一个简化的参数化模型来计算氢原子在铂表面上的吸附能 $\\Delta E_{\\text{ads}}$，该模型用于表示从量子力学计算中得到的总能量。该模型考虑了周期性平面波计算中数值误差的两个主要来源：由能量截断 $E_{\\text{cut}}$ 控制的基组不完备性，以及由$k$点数量 $K$ 控制的布里渊区离散采样。一个体系 $X$ 的近似能量 $E_X^{\\text{approx}}$ 被建模为其真实的、完全收敛的能量 $E_X^{\\text{true}}$ 与几个随 $E_{\\text{cut}}$ 和 $K$ 增加而减小的误差项之和。\n\n一个周期性体系 $X \\in \\{\\text{S}, \\text{SH}\\}$ 的模型由下式给出：\n$$\nE_X^{\\text{approx}}(E_{\\text{cut}},K) \\;=\\; E_X^{\\text{true}} \\;+\\; \\underbrace{\\frac{\\alpha_X}{E_{\\text{cut}}} \\;+\\; \\frac{\\gamma_X}{E_{\\text{cut}}^2}}_{\\text{基组误差}} \\;+\\; \\underbrace{\\frac{\\beta_X}{K} \\;+\\; \\frac{\\delta_X}{E_{\\text{cut}}\\,K}}_{\\text{BZ采样误差}}\n$$\n正系数 $\\alpha_X$ 和 $\\gamma_X$ 确保基组误差为正，这与量子力学的变分原理一致，该原理指出不完备的基组会产生一个高于真实基态能量的能量估计值。孤立氢原子是一个非周期性体系，没有布里渊区，其能量模型正确地省略了与 $K$ 相关的项：\n$$\nE_{\\text{H}}^{\\text{approx}}(E_{\\text{cut}}) \\;=\\; E_{\\text{H}}^{\\text{true}} \\;+\\; \\frac{\\alpha_{\\text{H}}}{E_{\\text{cut}}} \\;+\\; \\frac{\\gamma_{\\text{H}}}{E_{\\text{cut}}^2}\n$$\n该问题定义了所有必要的真实能量和误差系数。组合体系（带吸附物的板）的系数 $\\alpha_{\\text{SH}}$、$\\gamma_{\\text{SH}}$、$\\beta_{\\text{SH}}$ 和 $\\delta_{\\text{SH}}$ 通过失配因子 $m_\\alpha$ 和 $m_\\beta$ 与洁净板的系数相关联。这种设置真实地模拟了吸附物的存在会改变体系收敛行为这一事实。\n\n主要关注的量是吸附能，它是一个能量差：\n$$\n\\Delta E_{\\text{ads}} = E_{\\text{SH}} - E_{\\text{S}} - E_{\\text{H}}\n$$\n我们通过代入各组分的近似能量来计算近似吸附能 $\\Delta E_{\\text{ads}}^{\\text{approx}}$：\n$$\n\\Delta E_{\\text{ads}}^{\\text{approx}} = E_{\\text{SH}}^{\\text{approx}} - E_{\\text{S}}^{\\text{approx}} - E_{\\text{H}}^{\\text{approx}}\n$$\n计算科学中的一个关键概念是在计算能量差时误差的抵消。吸附能的绝对误差是 $|\\Delta E_{\\text{ads}}^{\\text{approx}} - \\Delta E_{\\text{ads}}^{\\text{true}}|$。让我们将体系 $X$ 的总误差表示为 $\\mathcal{E}_X = E_X^{\\text{approx}} - E_X^{\\text{true}}$。那么吸附能的误差可以表示为：\n$$\n\\Delta E_{\\text{ads}}^{\\text{approx}} - \\Delta E_{\\text{ads}}^{\\text{true}} = (E_{\\text{SH}}^{\\text{true}} + \\mathcal{E}_{\\text{SH}}) - (E_{\\text{S}}^{\\text{true}} + \\mathcal{E}_{\\text{S}}) - (E_{\\text{H}}^{\\text{true}} + \\mathcal{E}_{\\text{H}}) - (E_{\\text{SH}}^{\\text{true}} - E_{\\text{S}}^{\\text{true}} - E_{\\text{H}}^{\\text{true}}) = \\mathcal{E}_{\\text{SH}} - \\mathcal{E}_{\\text{S}} - \\mathcal{E}_{\\text{H}}\n$$\n这个表达式表明，最终量的误差取决于各组分误差之间的差值。如果误差 $\\mathcal{E}_{\\text{SH}}$ 和 $\\mathcal{E}_{\\text{S}}$ 相似，它们将在很大程度上相互抵消，导致 $\\Delta E_{\\text{ads}}^{\\text{approx}}$ 的净误差远小于单个误差 $\\mathcal{E}_{\\text{S}}$、$\\mathcal{E}_{\\text{H}}$ 和 $\\mathcal{E}_{\\text{SH}}$。该问题要求我们通过比率 $C$ 来量化这种抵消：\n$$\nC \\;=\\; \\frac{\\left|\\mathcal{E}_{\\text{SH}} - \\mathcal{E}_{\\text{S}} - \\mathcal{E}_{\\text{H}}\\right|}{\\sqrt{\\frac{\\mathcal{E}_{\\text{SH}}^2 + \\mathcal{E}_{\\text{S}}^2 + \\mathcal{E}_{\\text{H}}^2}{3}}}\n$$\n分子是净误差的大小，而分母是各组分误差大小的均方根 (RMS)。$C \\ll 1$ 的值表示强烈的误差抵消，而 $C \\approx \\sqrt{3}$ 则表示误差相加。\n\n最后，该问题要求评估计算出的吸附能是否满足指定的 $0.020\\,\\text{eV}$ 精度阈值，这通过一个布尔变量 $B$ 来评估。\n\n解决方案涉及对每个提供的测试案例 $(E_{\\text{cut}},K,m_\\alpha,m_\\beta)$ 进行系统性的、分步的计算实现。\n1.  定义所有常量参数和真实能量。\n2.  对每个测试案例，根据 $m_\\alpha$ 和 $m_\\beta$ 计算 SH 体系的特定系数。\n3.  使用提供的公式计算三个体系中每个体系的误差项 $\\mathcal{E}_{\\text{S}}$、$\\mathcal{E}_{\\text{H}}$ 和 $\\mathcal{E}_{\\text{SH}}$。\n4.  计算 $\\Delta E_{\\text{ads}}^{\\text{approx}} = \\Delta E_{\\text{ads}}^{\\text{true}} + \\mathcal{E}_{\\text{SH}} - \\mathcal{E}_{\\text{S}} - \\mathcal{E}_{\\text{H}}$。\n5.  计算绝对误差 $|\\Delta E_{\\text{ads}}^{\\text{approx}} - \\Delta E_{\\text{ads}}^{\\text{true}}|$。\n6.  计算抵消比率 $C$。包含一个条件检查来处理所有组分误差都为零的理论情况，此时净误差也为零，$C$ 定义为 $0$。\n7.  评估布尔条件 $B$。\n8.  将每个测试案例的结果——$\\Delta E_{\\text{ads}}^{\\text{approx}}$、绝对误差、$C$ 和 $B$——格式化为字符串，其中浮点数四舍五入到六位小数，并收集这些字符串。\n9.  连接所有测试案例的字符串，并以指定的列表的列表格式呈现。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Calculates the convergence behavior of hydrogen adsorption energy on Pt(111)\n    using a parametric error model.\n    \"\"\"\n\n    # Define true (converged) energies in eV\n    E_S_true = -100.000\n    E_H_true = -13.600\n    delta_E_ads_true = -0.450\n    E_SH_true = E_S_true + E_H_true + delta_E_ads_true\n\n    # Define error model coefficients\n    # Platinum slab (S)\n    alpha_S = 25.0  # eV^2\n    gamma_S = 2000.0  # eV^3\n    beta_S = 1.8  # eV\n    delta_S = 10.0  # eV^2\n    \n    # Hydrogen atom (H)\n    alpha_H = 5.0  # eV^2\n    gamma_H = 1000.0  # eV^3\n    \n    # Define test suite: (E_cut, K, m_alpha, m_beta)\n    test_cases = [\n        (500, 36, 0.05, 0.05),   # Case 1\n        (250, 36, 0.05, 0.05),   # Case 2\n        (500, 4, 0.05, 0.20),    # Case 3\n        (200, 1, 0.30, 0.30),    # Case 4\n        (350, 9, 0.20, 0.05),    # Case 5\n        (600, 100, 0.00, 0.00),  # Case 6\n    ]\n\n    all_formatted_results = []\n\n    for case in test_cases:\n        E_cut, K, m_alpha, m_beta = case\n\n        # 1. Compute individual energy errors (E_approx - E_true)\n        \n        # Error for the clean slab (S)\n        err_S = (alpha_S / E_cut) + \\\n                (gamma_S / E_cut**2) + \\\n                (beta_S / K) + \\\n                (delta_S / (E_cut * K))\n\n        # Error for the isolated hydrogen atom (H)\n        err_H = (alpha_H / E_cut) + \\\n                (gamma_H / E_cut**2)\n        \n        # Coefficients for the slab with adsorbed hydrogen (SH)\n        alpha_SH = alpha_S * (1 + m_alpha)\n        gamma_SH = gamma_S * (1 + m_alpha)\n        beta_SH = beta_S * (1 + m_beta)\n        delta_SH = delta_S * (1 + m_alpha)\n\n        # Error for the slab with adsorbed hydrogen (SH)\n        err_SH = (alpha_SH / E_cut) + \\\n                 (gamma_SH / E_cut**2) + \\\n                 (beta_SH / K) + \\\n                 (delta_SH / (E_cut * K))\n\n        # 2. Compute approximate adsorption energy\n        delta_E_ads_approx = E_SH_true + err_SH - (E_S_true + err_S) - (E_H_true + err_H)\n        \n        # 3. Compute absolute error in adsorption energy\n        # This simplifies to |err_SH - err_S - err_H|\n        ads_error = abs(delta_E_ads_approx - delta_E_ads_true)\n        \n        # 4. Quantify error cancellation\n        # Numerator is the absolute error in the energy difference\n        numerator_c = ads_error\n        \n        # Denominator is the RMS of the absolute errors of the components\n        rms_error_sq = (err_SH**2 + err_S**2 + err_H**2) / 3.0\n        \n        # Avoid division by zero if all errors happen to be zero\n        if rms_error_sq > 0:\n            denominator_c = math.sqrt(rms_error_sq)\n            C_ratio = numerator_c / denominator_c\n        else:\n            C_ratio = 0.0  # Perfect cancellation/no error\n\n        # 5. Assess accuracy tolerance\n        accuracy_tolerance = 0.020\n        B_val = (ads_error = accuracy_tolerance)\n\n        # Format results for this case into the required string format\n        case_string = (\n            f\"[{delta_E_ads_approx:.6f},\"\n            f\"{ads_error:.6f},\"\n            f\"{C_ratio:.6f},\"\n            f\"{B_val}]\"\n        )\n        all_formatted_results.append(case_string)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实的量子计算研究需要在精度和计算成本之间做出权衡。本练习模拟了计算金属表面功函数的过程，您需要同时考虑真空层厚度（$L$）和$k$点网格密度（$N$）两个收敛参数。您的任务是，在一个给定的计算成本模型下，找到满足目标精度且计算成本最低的参数组合，这正是计算科学家在日常研究中面临的典型优化问题。",
            "id": "3875442",
            "problem": "考虑一个在密度泛函理论（DFT）中采用板层模型建模的金属表面。功函数由基本关系式 $ \\phi = V_{\\text{vac}} - E_{\\text{F}} $ 定义，其中 $ \\phi $ 是功函数，$ V_{\\text{vac}} $ 是远离表面的真空区域中的静电势，$ E_{\\text{F}} $ 是板层的费米能级。在周期性板层计算中，有限的真空层间距和布里渊区（BZ）采样会引入数值误差，从而使 $ \\phi $ 产生偏差，这些误差可以从静电学和数值积分的第一性原理来理解。\n\n根据表面偶极子周期性阵列的泊松方程和金属的屏蔽特性，势中的有限真空相互作用误差随真空层间距 $ L $ 指数衰减，即 $ \\Delta \\phi_{\\text{vac}}(L) \\propto \\exp(-\\alpha L) $，其中 $ \\alpha $ 是由消逝模和材料响应决定的衰减常数。根据光滑周期被积函数的数值求积理论，对于具有形态良好费米面的金属，二维布里渊区k点采样的误差对于边长为 $ N $ 的正方形k点网格（一个 $ N \\times N $ 的网格）遵循幂律关系 $ \\Delta \\phi_{k}(N) \\propto N^{-p} $，其中对于应用于光滑函数的梯形法则或辛普森类法则，$ p \\ge 2 $。在没有额外强耦合效应的情况下，领头阶组合误差可以加性地近似为\n$$\n\\Delta \\phi(L,N) \\approx A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p},\n$$\n其中 $ A $、$ \\alpha $、$ B $ 和 $ p $ 是依赖于材料和方法的常数。\n\n假设一个针对金(111)表面（Au(111)）的物理上真实的替代模型，其渐近收敛的功函数为 $ \\phi_{\\infty} $，且常数经过标定以反映典型的金属板层行为：\n- $ \\phi_{\\infty} = 5.310 \\text{ eV} $,\n- $ A = 0.200 \\text{ eV} $,\n- $ \\alpha = 0.400 \\mathrm{\\AA}^{-1} $,\n- $ B = 0.120 \\text{ eV} $,\n- $ p = 2 $.\n\n假设在有限的 $ L $ 和 $ N $ 下计算出的功函数由以下模型描述\n$$\n\\phi(L,N) = \\phi_{\\infty} + \\Delta \\phi(L,N) = \\phi_{\\infty} + A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p}.\n$$\n假设一个简单的计算成本模型，该模型反映了平面波板层计算中的主要标度贡献，\n$$\nC(L,N) = c_{k} \\, N^{2} + c_{L} \\, L,\n$$\n其中 $ c_{k} = 1.0 $（任意单位/k点网格边长平方）和 $ c_{L} = 0.5 $（任意单位/埃格斯特朗真空层）。\n\n任务：给定候选的真空层间距 $ L $（单位为埃格斯特朗）和k点网格边长 $ N $（无量纲）集合，以及一个绝对精度目标 $ \\epsilon $（单位为电子伏特），绘制收敛景观图 $ \\phi(L,N) $，并找出满足 $ |\\phi(L,N) - \\phi_{\\infty}| \\le \\epsilon $ 且最小化成本 $ C(L,N) $ 的最小计算设置 $ (L,N) $。如果多个 $ (L,N) $ 对以相同的最小成本满足精度目标，则通过选择较小的 $ N $ 来处理并列情况，其次是选择较小的 $ L $。如果没有候选者满足目标精度，则返回一个表示不可行的哨兵结果。\n\n物理单位和取整要求：\n- 所有功函数和绝对误差均以电子伏特（eV）为单位报告，并四舍五入到 $ 10^{-3} $ eV。\n- 真空层间距 $ L $ 以埃格斯特朗（$ \\mathrm{\\AA} $）为单位。\n- 成本 $ C $ 以任意单位计，并四舍五入到 $ 10^{-3} $。\n\n带覆盖范围的测试套件：\n- 案例 1（常规成功路径）：$ L \\in \\{6,8,10,12,15\\} $ $ \\mathrm{\\AA} $，$ N \\in \\{4,6,8,10,12\\} $，$ \\epsilon = 0.010 \\text{ eV} $。\n- 案例 2（不可行性边界）：$ L \\in \\{6,7,8\\} $ $ \\mathrm{\\AA} $，$ N \\in \\{3,4,5\\} $，$ \\epsilon = 0.008 \\text{ eV} $。\n- 案例 3（边界相等）：$ L \\in \\{8,10\\} $ $ \\mathrm{\\AA} $，$ N \\in \\{10,12\\} $，$ \\epsilon = 0.00935244 \\text{ eV} $。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个项目本身也是一个逗号分隔的列表 $ [L,N,\\phi,e,C] $，分别代表真空层间距 $ L $（$ \\mathrm{\\AA} $）、k点网格边长 $ N $、计算出的功函数 $ \\phi $（eV，四舍五入到 $ 10^{-3} $ eV）、绝对误差 $ e = |\\phi - \\phi_{\\infty}| $（eV，四舍五入到 $ 10^{-3} $ eV）和计算成本 $ C $（任意单位，四舍五入到 $ 10^{-3} $）。如果没有任何组合满足目标，则返回 $ [-1,-1,-1,-1,-1] $。对于给定的测试套件，输出应为单行，类似于\n$ [[L_{1},N_{1},\\phi_{1},e_{1},C_{1}],[L_{2},N_{2},\\phi_{2},e_{2},C_{2}],[L_{3},N_{3},\\phi_{3},e_{3},C_{3}]] $，\n其中的数值由您的计算填入。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取给定信息\n\n明确提供了以下数据和模型：\n- **功函数定义**：$ \\phi = V_{\\text{vac}} - E_{\\text{F}} $\n- **组合误差模型**：对于给定的真空层间距 $ L $ 和 $ N \\times N $ k点网格边长，计算出的功函数 $ \\phi(L,N) $ 被建模为 $ \\phi(L,N) = \\phi_{\\infty} + \\Delta \\phi(L,N) $，其中 $ \\Delta \\phi(L,N) $ 是可加性误差。\n- **误差公式**：$ \\Delta \\phi(L,N) \\approx A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p} $\n- **模型参数**：\n  - 收敛功函数：$ \\phi_{\\infty} = 5.310 \\text{ eV} $\n  - 误差系数 $ A = 0.200 \\text{ eV} $\n  - 误差衰减常数 $ \\alpha = 0.400 \\mathrm{\\AA}^{-1} $\n  - 误差系数 $ B = 0.120 \\text{ eV} $\n  - 误差指数 $ p = 2 $\n- **计算成本模型**：$ C(L,N) = c_{k} \\, N^{2} + c_{L} \\, L $\n- **成本参数**：\n  - k点网格成本因子：$ c_{k} = 1.0 $ (任意单位/k点网格边长$^2$)\n  - 真空层成本因子：$ c_{L} = 0.5 $ (任意单位/$\\mathrm{\\AA}$)\n- **任务目标**：给定 $ L $ 和 $ N $ 的候选值集合以及一个绝对精度目标 $ \\epsilon $，找到既满足精度标准 $ |\\phi(L,N) - \\phi_{\\infty}| \\le \\epsilon $ 又最小化计算成本 $ C(L,N) $ 的参数对 $ (L,N) $。\n- **平局处理规则**：对于相同的最小成本，通过选择较小的 $ N $ 来打破平局，其次是较小的 $ L $。\n- **不可行条件**：如果没有 $ (L,N) $ 对满足精度目标，则必须返回哨兵结果 $ [-1,-1,-1,-1,-1] $。\n- **取整和单位**：所有功函数 $ \\phi $、绝对误差 $ e $ 和成本 $ C $ 的最终值都应四舍五入到 $ 10^{-3} $（三位小数）。$ L $ 的单位是埃格斯特朗（$ \\mathrm{\\AA} $），$ N $ 是无量纲的。\n- **测试套件**：\n  - 案例 1：$ L \\in \\{6,8,10,12,15\\} $ $ \\mathrm{\\AA} $，$ N \\in \\{4,6,8,10,12\\} $，$ \\epsilon = 0.010 \\text{ eV} $。\n  - 案例 2：$ L \\in \\{6,7,8\\} $ $ \\mathrm{\\AA} $，$ N \\in \\{3,4,5\\} $，$ \\epsilon = 0.008 \\text{ eV} $。\n  - 案例 3：$ L \\in \\{8,10\\} $ $ \\mathrm{\\AA} $，$ N \\in \\{10,12\\} $，$ \\epsilon = 0.00935244 \\text{ eV} $。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n根据验证标准对问题进行评估：\n- **科学基础**：该问题在计算材料科学，特别是密度泛函理论（DFT）的原理方面有充分的依据。表面相互作用误差随真空层间距的指数衰减以及布里渊区积分误差的幂律衰减是用于分析板层计算收敛性的标准、有物理动机的模型。成本函数 $ C(L,N) $ 正确地反映了平面波DFT代码的主要标度行为。所有提供的参数对于像Au(111)这样的金属体系都是物理上合理的。\n- **适定性**：该问题在数学上是适定的。它提供了所有必要的函数、参数和约束。目标定义明确（在精度约束下最小化成本），并且平局处理规则确保对于任何有效的输入集都存在唯一解。\n- **客观性**：问题以精确、量化和无偏见的语言陈述，不含任何主观或推测性元素。\n\n该问题没有表现出任何已列举的缺陷（例如，科学上不合理、不完整、模糊不清）。它代表了计算研究中遇到的一个标准优化任务。\n\n### 步骤 3：结论与行动\n\n该问题是**有效的**。将制定解决方案。\n\n### 求解推导\n\n任务是从一个离散的候选集中找到一对最优计算参数 $ (L, N) $，它在满足误差约束的同时最小化成本函数。对于每个测试用例，将通过系统地评估所有可能的参数对来获得解决方案。\n\n控制方程定义如下：\n计算出的功函数由下式给出：\n$$ \\phi(L,N) = \\phi_{\\infty} + A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p} $$\n代入给定常数：\n$$ \\phi(L,N) = 5.310 + 0.200 \\,\\mathrm{e}^{-0.400 L} + 0.120 \\, N^{-2} $$\n\n相对于收敛值 $ \\phi_{\\infty} $ 的绝对误差 $ e(L,N) $ 是：\n$$ e(L,N) = |\\phi(L,N) - \\phi_{\\infty}| = |A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p}| $$\n由于 $ A $、$ B $、$ L $ 和 $ N $ 均为正数，绝对值内的表达式始终为正。因此，误差就是：\n$$ e(L,N) = A \\,\\mathrm{e}^{-\\alpha L} + B \\, N^{-p} = 0.200 \\,\\mathrm{e}^{-0.400 L} + 0.120 \\, N^{-2} $$\n精度约束为 $ e(L,N) \\le \\epsilon $。\n\n计算成本函数为：\n$$ C(L,N) = c_{k} \\, N^{2} + c_{L} \\, L $$\n代入给定常数：\n$$ C(L,N) = 1.0 \\, N^{2} + 0.5 \\, L $$\n\n解决每个测试用例问题的算法如下：\n1.  初始化一个空列表 `valid_candidates`，用于存储满足精度要求的配置参数。\n2.  对于给定的测试用例，其中包含 $ L $ 和 $ N $ 的候选集以及目标精度 $ \\epsilon $，遍历所有可能的参数对 $ (L, N) $。\n3.  对于每对参数，计算误差 $ e(L,N) $。\n4.  如果 $ e(L,N) \\leq \\epsilon $，则该参数对是有效候选者。计算其相关成本 $ C(L,N) $ 并将元组 $ (C, N, L) $ 存储在 `valid_candidates` 列表中。按此顺序存储元组有助于根据平局处理规则进行排序。\n5.  检查完所有参数对后，查看 `valid_candidates` 列表。\n    a. 如果列表为空，则没有参数组合满足精度目标。对于此测试用例，问题是不可行的，并记录哨兵结果 $ [-1,-1,-1,-1,-1] $。\n    b. 如果列表包含一个或多个候选者，则按升序对其进行排序。由于元组结构为 $ (C, N, L) $，这将自动首先按成本排序，然后按 $ N $ 排序，最后按 $ L $ 排序，从而正确实现指定的平局处理逻辑。\n6.  排序后列表的第一个元素 $ (C^*, N^*, L^*) $ 代表最优配置。\n7.  使用最优参数 $ L^* $ 和 $ N^* $，计算最终量：\n    - 计算出的功函数 $ \\phi(L^*, N^*) $。\n    - 绝对误差 $ e(L^*, N^*) $。\n    - 计算成本 $ C(L^*, N^*) $。\n8.  按要求将计算出的 $ \\phi $、$ e $ 和 $ C $ 的值四舍五入到 $ 10^{-3} $。\n9.  将测试用例的最终结果格式化为列表 $ [L^*, N^*, \\phi, e, C] $。\n\n此过程是确定性的，并保证根据问题的标准为每个测试用例找到唯一的最优解。它将针对提供的测试套件实施。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding optimal computational parameters (L, N)\n    for DFT slab calculations based on a given error and cost model.\n    \"\"\"\n\n    # --- Model Constants ---\n    PHI_INF = 5.310  # Converged work function in eV\n    A = 0.200        # Error coefficient in eV\n    ALPHA = 0.400    # Error decay constant in 1/Angstrom\n    B = 0.120        # Error coefficient in eV\n    P = 2            # Error exponent\n    C_K = 1.0        # k-mesh cost factor\n    C_L = 0.5        # Vacuum cost factor\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"L_set\": [6, 8, 10, 12, 15],\n            \"N_set\": [4, 6, 8, 10, 12],\n            \"epsilon\": 0.010\n        },\n        {\n            \"L_set\": [6, 7, 8],\n            \"N_set\": [3, 4, 5],\n            \"epsilon\": 0.008\n        },\n        {\n            \"L_set\": [8, 10],\n            \"N_set\": [10, 12],\n            \"epsilon\": 0.00935244\n        }\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        L_set = case[\"L_set\"]\n        N_set = case[\"N_set\"]\n        epsilon = case[\"epsilon\"]\n\n        valid_candidates = []\n\n        for L in L_set:\n            for N in N_set:\n                # Calculate the absolute error\n                error = A * np.exp(-ALPHA * L) + B * (N ** -P)\n\n                # Check if the accuracy target is met\n                if error = epsilon:\n                    # Calculate the computational cost\n                    cost = C_K * (N ** 2) + C_L * L\n                    # Store as (cost, N, L) for sorting\n                    valid_candidates.append((cost, N, L))\n\n        if not valid_candidates:\n            # No valid configuration found\n            final_results.append([-1, -1, -1.0, -1.0, -1.0])\n        else:\n            # Sort to find the minimum cost, with tie-breaking N then L\n            valid_candidates.sort()\n            best_cost, best_N, best_L = valid_candidates[0]\n\n            # Recalculate final values for the optimal (L, N) pair\n            optimal_error = A * np.exp(-ALPHA * best_L) + B * (best_N ** -P)\n            optimal_phi = PHI_INF + optimal_error\n            optimal_cost = C_K * (best_N ** 2) + C_L * best_L\n\n            # Round values to 3 decimal places\n            phi_rounded = round(optimal_phi, 3)\n            error_rounded = round(optimal_error, 3)\n            cost_rounded = round(optimal_cost, 3)\n\n            final_results.append([best_L, best_N, phi_rounded, error_rounded, cost_rounded])\n\n    # --- Format and Print Final Output ---\n    # The output format must be a list of lists, represented as a string.\n    # e.g., [[L1,N1,phi1,e1,C1],[L2,N2,phi2,e2,C2]]\n    result_strings = []\n    for res in final_results:\n        if res[0] == -1:\n            # Sentinel case\n            result_strings.append(\"[-1,-1,-1.000,-1.000,-1.000]\")\n        else:\n            L, N, phi, e, C = res\n            result_strings.append(f\"[{L},{N},{phi:.3f},{e:.3f},{C:.3f}]\")\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n\n```"
        }
    ]
}