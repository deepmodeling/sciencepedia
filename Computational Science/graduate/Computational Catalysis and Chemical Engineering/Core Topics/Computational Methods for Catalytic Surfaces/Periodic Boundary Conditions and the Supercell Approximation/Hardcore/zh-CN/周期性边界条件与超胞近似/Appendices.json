{
    "hands_on_practices": [
        {
            "introduction": "在任何使用周期性边界条件的计算研究中，首要步骤之一是定义计算单元（原胞或超胞）以及相应的倒易空间采样。真实空间超胞的尺寸与倒易空间布里渊区的大小成反比。这项实践旨在阐明这一基本对偶性，通过一个具体例子，练习如何在扩大真实空间超胞的同时调整 $k$ 点网格，以保持等效的采样密度，这是确保不同尺寸体系能量计算可比性的关键。",
            "id": "3893884",
            "problem": "考虑一个在周期性边界条件（PBC）下建模的面心立方（fcc）(111) 板层。该板层具有二维六方横向周期性，由平面内的原胞实空间晶格矢量 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$ 定义，以及一个包含足够真空层的平面外晶格矢量 $\\mathbf{a}_{3}$，使得沿平面外方向的色散关系可以用 $N_{z} = 1$ 进行采样。\n\n在倒易空间中，布里渊区（BZ）由倒易晶格矢量 $\\mathbf{b}_{1}$ 和 $\\mathbf{b}_{2}$ 构建，其定义为 $\\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2 \\pi \\delta_{ij}$（其中 $i,j \\in \\{1,2\\}$）。该板层使用一个 $N_{x} \\times N_{y} \\times N_{z}$ 的均匀 Monkhorst-Pack（MP）k点网格进行采样。\n\n您从一个使用 $15 \\times 15 \\times 1$ 的 MP 网格采样的 fcc(111) 板层原胞开始。然后，您通过沿平面内方向将原胞复制 $3 \\times 3$ 次来构建一个横向超胞，同时保持平面外周期性不变。\n\n从倒易晶格矢量和 PBC 下布里渊区的核心定义出发，推导在从原胞过渡到 $3 \\times 3$ 横向超胞时，维持等效 k 点采样密度所需的准则（此处的等效采样密度被解释为保持沿每个倒易晶格矢量方向的 k 点间距以及每单位布里渊区面积的总 k 点密度不变）。基于此准则，计算超胞的调整后 MP 网格 $N'_{x} \\times N'_{y} \\times N'_{z}$，以使其保持与原始原胞计算相同的采样密度。\n\n将您的最终答案表示为整数三元组 $(N'_{x}, N'_{y}, N'_{z})$。无需四舍五入，也无需单位。",
            "solution": "用户要求对问题陈述进行严格验证，如果问题被认定为有效，则提供详细的推导和解答。\n\n### 步骤 1：提取已知条件\n- **系统**：一个面心立方（fcc）(111) 板层。\n- **周期性**：二维六方横向周期性，原胞实空间晶格矢量为 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$。平面外晶格矢量为 $\\mathbf{a}_{3}$，包含真空层。\n- **原胞 k 点采样**：一个 $N_{x} \\times N_{y} \\times N_{z} = 15 \\times 15 \\times 1$ 的 Monkhorst-Pack（MP）网格。沿平面外方向的色散关系用 $N_z=1$ 进行采样。\n- **倒易晶格定义**：对于平面内矢量，$\\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2 \\pi \\delta_{ij}$，其中 $i,j \\in \\{1,2\\}$。\n- **超胞变换**：原胞沿平面内方向复制 $3 \\times 3$ 次。平面外维度保持不变。\n- **目标**：推导等效 k 点采样密度的准则，并计算超胞的调整后 MP 网格 $N'_{x} \\times N'_{y} \\times N'_{z}$。\n- **等效采样密度的定义**：“保持沿每个倒易晶格矢量方向的 k 点间距以及每单位布里渊区面积的总 k 点密度”。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学上成立**：该问题牢固地植根于固态物理学和计算材料科学的原理。实空间晶格与倒易空间晶格、布里渊区（BZ）、周期性边界条件（PBC）、超胞以及 Monkhorst-Pack k 点采样的概念是该领域的标准和基础。\n2.  **问题定义明确**：该问题定义明确。它提供了所有必要的信息（初始网格、超胞变换）和一个清晰的目标。“等效采样密度”的定义已经给出并且内部一致，可以导出一个唯一的解。\n3.  **客观性**：语言精确、定量，没有主观性或偏见。\n4.  **无缺陷**：该问题没有违反任何科学原理，不是比喻性的，是完整的，是物理上现实的，并且结构良好。它探讨了实空间和倒易空间表示如何相互关联这一核心概念，这是计算研究中一个重要但标准的任务。\n\n### 步骤 3：结论与行动\n问题是**有效**的。将提供一个完整的、论证充分的解答。\n\n### 解答推导\n实空间晶格矢量和倒易空间晶格矢量之间的关系是这个问题的核心。对于一组原胞实空间晶格矢量 $\\{\\mathbf{a}_i\\}$，相应的倒易晶格矢量 $\\{\\mathbf{b}_j\\}$ 的定义使其点积满足 $\\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2 \\pi \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克 δ 符号。\n\n设原胞由平面内实空间矢量 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$ 以及平面外矢量 $\\mathbf{a}_{3}$ 描述。定义布里渊区（BZ）的相应倒易晶格矢量是 $\\mathbf{b}_{1}$、$\\mathbf{b}_{2}$ 和 $\\mathbf{b}_{3}$。\n\n一个 $N_{x} \\times N_{y} \\times N_{z}$ 点的 Monkhorst-Pack（MP）网格在布里渊区中对一组 k 点进行采样，这些 k 点由以下公式给出：\n$$ \\mathbf{k} = \\frac{u_x}{N_x} \\mathbf{b}_1 + \\frac{u_y}{N_y} \\mathbf{b}_2 + \\frac{u_z}{N_z} \\mathbf{b}_3 $$\n其中 $u_x, u_y, u_z$ 是整数。因此，沿倒易晶格矢量 $\\mathbf{b}_i$ 方向的 k 点间距与该方向上的采样点数 $N_i$ 成反比。具体来说，倒易空间中沿 $\\mathbf{b}_i$ 方向的步长为 $\\Delta k_i = \\frac{|\\mathbf{b}_i|}{N_i}$。\n\n对于初始原胞，给定的采样网格为 $N_x = 15$，$N_y = 15$ 和 $N_z = 1$。沿各自倒易晶格矢量方向的 k 点间距为：\n$$ \\Delta k_x = \\frac{|\\mathbf{b}_1|}{N_x} = \\frac{|\\mathbf{b}_1|}{15} $$\n$$ \\Delta k_y = \\frac{|\\mathbf{b}_2|}{N_y} = \\frac{|\\mathbf{b}_2|}{15} $$\n$$ \\Delta k_z = \\frac{|\\mathbf{b}_3|}{N_z} = \\frac{|\\mathbf{b}_3|}{1} $$\n\n接下来，我们构建一个 $3 \\times 3$ 的横向超胞。新的实空间晶格矢量（我们用撇号表示）与原胞矢量关系如下：\n$$ \\mathbf{a}'_{1} = 3 \\mathbf{a}_{1} $$\n$$ \\mathbf{a}'_{2} = 3 \\mathbf{a}_{2} $$\n平面外矢量保持不变：\n$$ \\mathbf{a}'_{3} = \\mathbf{a}_{3} $$\n\n我们现在必须找到超胞的新倒易晶格矢量 $\\{\\mathbf{b}'_j\\}$。它们由关系式 $\\mathbf{a}'_{i} \\cdot \\mathbf{b}'_{j} = 2 \\pi \\delta_{ij}$ 定义。我们来求 $\\mathbf{b}'_1$。它必须满足：\n$$ \\mathbf{a}'_1 \\cdot \\mathbf{b}'_1 = (3 \\mathbf{a}_1) \\cdot \\mathbf{b}'_1 = 2 \\pi $$\n$$ \\mathbf{a}'_2 \\cdot \\mathbf{b}'_1 = (3 \\mathbf{a}_2) \\cdot \\mathbf{b}'_1 = 0 $$\n从第二个方程中，我们看到 $\\mathbf{b}'_1$ 必须与 $\\mathbf{a}_2$ 正交。由于 $\\mathbf{b}_1$ 也与 $\\mathbf{a}_2$ 正交（根据原始定义 $\\mathbf{a}_2 \\cdot \\mathbf{b}_1 = 0$），所以 $\\mathbf{b}'_1$ 必须与 $\\mathbf{b}_1$ 平行。我们可以写成 $\\mathbf{b}'_1 = c \\mathbf{b}_1$，其中 $c$ 为某个标量。将此代入第一个方程：\n$$ (3 \\mathbf{a}_1) \\cdot (c \\mathbf{b}_1) = 3c (\\mathbf{a}_1 \\cdot \\mathbf{b}_1) = 3c (2 \\pi) = 2 \\pi $$\n解出 $c$，我们得到 $3c = 1$，即 $c = \\frac{1}{3}$。因此：\n$$ \\mathbf{b}'_1 = \\frac{1}{3} \\mathbf{b}_1 $$\n通过对 $\\mathbf{b}'_2$ 进行同样的论证可得：\n$$ \\mathbf{b}'_2 = \\frac{1}{3} \\mathbf{b}_2 $$\n对于平面外方向，由于 $\\mathbf{a}'_3 = \\mathbf{a}_3$，相应的倒易矢量也保持不变：\n$$ \\mathbf{b}'_3 = \\mathbf{b}_3 $$\n一般来说，如果一个实空间晶格矢量按因子 $S$ 缩放，相应的倒易晶格矢量将按因子 $1/S$ 缩放。\n\n问题要求保持 k 点采样密度不变，这被定义为保持倒易空间中 k 点的绝对间距不变。设超胞的新 MP 网格为 $N'_{x} \\times N'_{y} \\times N'_{z}$。新的 k 点间距为：\n$$ \\Delta k'_x = \\frac{|\\mathbf{b}'_1|}{N'_x} = \\frac{|\\frac{1}{3} \\mathbf{b}_1|}{N'_x} = \\frac{|\\mathbf{b}_1|}{3 N'_x} $$\n$$ \\Delta k'_y = \\frac{|\\mathbf{b}'_2|}{N'_y} = \\frac{|\\frac{1}{3} \\mathbf{b}_2|}{N'_y} = \\frac{|\\mathbf{b}_2|}{3 N'_y} $$\n$$ \\Delta k'_z = \\frac{|\\mathbf{b}'_3|}{N'_z} = \\frac{|\\mathbf{b}_3|}{N'_z} $$\n\n为了保持等效采样，我们将原始间距设为与新间距相等：\n$$ \\Delta k_x = \\Delta k'_x \\implies \\frac{|\\mathbf{b}_1|}{15} = \\frac{|\\mathbf{b}_1|}{3 N'_x} \\implies 15 = 3 N'_x \\implies N'_x = \\frac{15}{3} = 5 $$\n$$ \\Delta k_y = \\Delta k'_y \\implies \\frac{|\\mathbf{b}_2|}{15} = \\frac{|\\mathbf{b}_2|}{3 N'_y} \\implies 15 = 3 N'_y \\implies N'_y = \\frac{15}{3} = 5 $$\n$$ \\Delta k_z = \\Delta k'_z \\implies \\frac{|\\mathbf{b}_3|}{1} = \\frac{|\\mathbf{b}_3|}{N'_z} \\implies N'_z = 1 $$\n\n因此，对于 $3 \\times 3$ 超胞，要保持与原胞的 $15 \\times 15 \\times 1$ 网格相同的 k 点采样密度，调整后的 MP 网格为 $5 \\times 5 \\times 1$。\n\n我们可以使用提供的另一个条件来验证此结果：“保持每单位布里渊区面积的总 k 点密度”。原胞布里渊区的二维面积是 $A_{BZ} = |\\mathbf{b}_1 \\times \\mathbf{b}_2|$。k 点数量为 $N_{k} = N_x N_y = 15 \\times 15 = 225$。k 点密度为 $\\rho_k = N_{k} / A_{BZ} = 225 / |\\mathbf{b}_1 \\times \\mathbf{b}_2|$。\n对于超胞，布里渊区面积为 $A'_{BZ} = |\\mathbf{b}'_1 \\times \\mathbf{b}'_2| = |(\\frac{1}{3}\\mathbf{b}_1) \\times (\\frac{1}{3}\\mathbf{b}_2)| = \\frac{1}{9} |\\mathbf{b}_1 \\times \\mathbf{b}_2| = \\frac{1}{9} A_{BZ}$。超胞的 k 点数量为 $N'_{k} = N'_x N'_y = 5 \\times 5 = 25$。新的 k 点密度为 $\\rho'_k = N'_{k} / A'_{BZ} = 25 / (\\frac{1}{9} A_{BZ}) = 9 \\times 25 / A_{BZ} = 225 / A_{BZ}$。\n由于 $\\rho_k = \\rho'_k$，该条件得到满足，从而证实了我们的结果。\n\n因此，调整后的 MP 网格为 $(N'_{x}, N'_{y}, N'_{z}) = (5, 5, 1)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 5  5  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "对于表面和二维材料的模拟，通常采用平板模型（slab model），即在垂直于表面的方向上引入真空层以隔绝周期性镜像。然而，这个真空层的厚度是一个必须仔细收敛的关键参数，因为它会引入伪影，如波函数溢出效应和针对极性平板的人造电场。本练习将指导你设计一个收敛性测试方案，以确定足以将这些伪相互作用抑制到可接受水平的最小真空厚度。",
            "id": "3893869",
            "problem": "考虑一个在三维超胞中建模的表面板层，其在所有方向上均具有周期性边界条件（PBC）。沿表面法线方向，将该系统视为一个一维平面平均静电学问题，其中板层是局域的，并通过厚度为 $L$ （真空层厚度）的真空区域与其周期性镜像分离，并呈周期性重复。计算任务是确定所需的最小真空层厚度 $L$，以确保在非周期性方向上既能获得精确的真空能级，又能使周期性板层镜像之间的残余相互作用可忽略不计。\n\n使用以下基本依据：\n- 平面平均静电势 $v(z)$ 在真空中满足一维泊松方程 $\\frac{d^{2} v}{d z^{2}} = 0$，这意味着真空中的电场是恒定的。\n- 静电能量密度为 $u = \\frac{\\varepsilon_{0}}{2} \\lvert \\mathbf{E} \\rvert^{2}$，其中 $\\varepsilon_{0}$ 是真空介电常数，$\\mathbf{E}$ 是电场。\n- 对于给定的板层和赝势设置，真空能级相对于其渐近值的偏差被建模为一个随真空层厚度指数衰减的函数，其振幅和衰减率由该系统的事先校准确定。\n- 对于极性板层，沿表面法线的面偶极矩密度（单位面积的偶极矩）是一个有限常数，并且在 PBC 下，会在真空区域产生一个均匀的残余电场。\n\n您的程序必须针对每个给定的测试用例，确定最小真空层厚度 $L$（单位为米），该厚度需同时满足以下两个收敛标准：\n1. 真空能级的绝对偏差低于指定的容差，该偏差被建模为一个具有已知振幅和衰减常数的关于 $L$ 的指数函数。\n2. 单位面积上的残余周期性镜像相互作用能低于指定的容差，该能量通过在真空区域上对残余场的麦克斯韦能量密度进行积分得到。\n\n然后将得到的最小 $L$ 从米转换为埃，并报告四舍五入到两位小数的值。\n\n常数和单位：\n- 使用真空介电常数 $\\varepsilon_{0} = 8.854187817 \\times 10^{-12}\\,\\mathrm{F}\\,\\mathrm{m}^{-1}$。\n- 为估算残余相互作用能，将真空区域的电场视为均匀的。\n- 一埃等于 $1\\times 10^{-10}\\,\\mathrm{m}$。\n- 以埃为单位表示最终的真空层厚度，并保留两位小数。\n\n每个测试用例的输入：\n- 真空能级偏差模型的校准参数：振幅 $\\alpha$（单位 $\\mathrm{eV}$）和衰减常数 $\\kappa$（单位 $\\mathrm{m}^{-1}$），使得在真空层厚度为 $L$ 时的偏差大小表示为一个振幅为 $\\alpha$、衰减率为 $\\kappa$ 的衰减函数。$\\alpha$ 为零或负值表示没有需要指数抑制的偏差。\n- 真空能级容差 $\\delta_{V}$（单位 $\\mathrm{eV}$）。\n- 面偶极矩密度 $\\mu_{A}$（单位 $\\mathrm{C}\\,\\mathrm{m}^{-1}$）。\n- 相互作用能容差 $\\delta_{U}$（单位 $\\mathrm{J}\\,\\mathrm{m}^{-2}$）。\n\n数学任务：\n- 从上述基本依据出发，推导出计算最小 $L$ 所需的关系式，该 $L$ 需同时满足真空能级收敛和残余镜像相互作用能两个标准。在评估不等式时，您必须完全使用国际单位制（SI）单位，然后在输出时将 $L$ 转换为埃。\n- 稳健地处理边界情况，包括 $\\alpha \\le 0$ 以及在任意小的 $L$ 值下真空能级标准已经满足的情况。\n\n测试套件：\n为以下三个测试用例提供结果。对每个用例，计算满足两个标准的最小 $L$，将其转换为埃，并四舍五入到两位小数。\n- 用例 A（两个标准相当的通用“理想路径”）：$\\alpha = 0.5\\,\\mathrm{eV}$，$\\kappa = 1.0\\times 10^{10}\\,\\mathrm{m}^{-1}$，$\\delta_{V} = 1.0\\times 10^{-3}\\,\\mathrm{eV}$，$\\mu_{A} = 1.0\\times 10^{-12}\\,\\mathrm{C}\\,\\mathrm{m}^{-1}$，$\\delta_{U} = 1.0\\times 10^{-4}\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$。\n- 用例 B（相互作用能主导）：$\\alpha = 0.05\\,\\mathrm{eV}$，$\\kappa = 1.0\\times 10^{10}\\,\\mathrm{m}^{-1}$，$\\delta_{V} = 1.0\\times 10^{-3}\\,\\mathrm{eV}$，$\\mu_{A} = 3.0\\times 10^{-12}\\,\\mathrm{C}\\,\\mathrm{m}^{-1}$，$\\delta_{U} = 1.0\\times 10^{-4}\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$。\n- 用例 C（真空偏差振幅为零）：$\\alpha = 0.0\\,\\mathrm{eV}$，$\\kappa = 5.0\\times 10^{9}\\,\\mathrm{m}^{-1}$，$\\delta_{V} = 1.0\\times 10^{-4}\\,\\mathrm{eV}$，$\\mu_{A} = 5.0\\times 10^{-13}\\,\\mathrm{C}\\,\\mathrm{m}^{-1}$，$\\delta_{U} = 5.0\\times 10^{-5}\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与上述用例相同，例如 $[\\text{L\\_A},\\text{L\\_B},\\text{L\\_C}]$，其中每个条目是最小真空层厚度，单位为埃，四舍五入到两位小数。不应打印任何附加文本。",
            "solution": "对问题陈述进行分析后，确定其是有效的。该问题基于静电学和计算材料科学的原理，特别是关于周期性超胞中表面处理方法，具有科学依据。该问题是适定的、客观的，并包含足够的信息来推导出唯一解，但这依赖于对残余相互作用能的一个合理的物理近似，下文将对此进行详述。\n\n目标是找到最小真空层厚度（用 $L$ 表示），它能同时满足两个独立标准：一个是真空能级收敛标准，另一个是周期性镜像间的残余静电相互作用能标准。最终所需的 $L$ 值将是根据每个标准推导出的厚度中的最大值，以确保两个条件都得到满足。整个分析将在国际单位制（SI）下进行，最终结果将转换为埃（$1\\,\\text{Å} = 1 \\times 10^{-10}\\,\\mathrm{m}$）。\n\n标准1：真空能级偏差\n第一个标准关于真空能级的收敛。问题陈述指出，与真实渐近真空能级的偏差大小 $\\Delta V(L)$ 被建模为一个随真空层厚度 $L$ 指数衰减的函数。该函数具有给定的振幅 $\\alpha$（单位为 $\\mathrm{eV}$）和衰减常数 $\\kappa$（单位为 $\\mathrm{m}^{-1}$）。我们可以将此关系表示为：\n$$ |\\Delta V(L)| = \\alpha \\exp(-\\kappa L) $$\n收敛标准要求此偏差小于指定的容差 $\\delta_V$（单位为 $\\mathrm{eV}$）：\n$$ \\alpha \\exp(-\\kappa L) \\le \\delta_V $$\n为找到满足此条件的最小厚度 $L_V$，我们求解 $L$。\n\n有两种情况需要考虑：\n1.  如果 $\\alpha \\le \\delta_V$，这包括了为 $\\alpha \\le 0$ 指定的情况，那么对于任何非负的真空层厚度 $L \\ge 0$，该不等式都成立。这是因为在 $L=0$ 时的初始偏差已经小于容差。因此，该标准对真空层厚度没有施加下限，我们可以认为此标准要求的最小厚度为 $L_V = 0\\,\\mathrm{m}$。\n\n2.  如果 $\\alpha > \\delta_V$，我们必须解关于 $L$ 的不等式：\n    $$ \\exp(-\\kappa L) \\le \\frac{\\delta_V}{\\alpha} $$\n    取两边的自然对数：\n    $$ -\\kappa L \\le \\ln\\left(\\frac{\\delta_V}{\\alpha}\\right) $$\n    由于衰减常数 $\\kappa$ 必须为正以使误差衰减，我们可以除以 $-\\kappa$，这会使不等号反向：\n    $$ L \\ge -\\frac{1}{\\kappa} \\ln\\left(\\frac{\\delta_V}{\\alpha}\\right) $$\n    利用对数性质 $\\ln(1/x) = -\\ln(x)$，这变为：\n    $$ L \\ge \\frac{1}{\\kappa} \\ln\\left(\\frac{\\alpha}{\\delta_V}\\right) $$\n    因此，满足真空能级标准所需的最小厚度 $L_V$ 为：\n    $$ L_V = \\frac{1}{\\kappa} \\ln\\left(\\frac{\\alpha}{\\delta_V}\\right) $$\n    注意，$\\alpha$ 和 $\\delta_V$ 的单位（均为 $\\mathrm{eV}$）会抵消，使得对数的参数为无量纲，符合要求。\n\n结合两种情况，基于真空能级标准的最小厚度为：\n$$ L_V = \\max\\left(0, \\frac{1}{\\kappa} \\ln\\left(\\frac{\\alpha}{\\delta_V}\\right)\\right) $$\n\n标准2：残余周期性镜像相互作用能\n第二个标准涉及由极性板层的周期性重复所产生的伪静电相互作用能，该板层具有净面偶极矩密度 $\\mu_A$。问题陈述指出，这种布置会在真空区域产生一个均匀的残余电场 $E_{res}$，并且单位面积的相互作用能 $U_A$ 是通过在真空厚度 $L$ 上对静电能量密度进行积分得到的。\n\n静电能量密度由 $u = \\frac{1}{2}\\varepsilon_0 E^2$ 给出。对于厚度为 $L$ 的真空区域中的均匀电场 $E_{res}$，在体积 $A \\times L$（其中 $A$ 是表面积）中的总能量为 $U = u \\cdot (A \\times L)$。因此，单位面积的能量 $U_A$ 为：\n$$ U_A = \\frac{U}{A} = \\frac{1}{2}\\varepsilon_0 E_{res}^2 L $$\n由具有面偶极矩密度 $\\mu_A$ 的周期性偶极子层产生的伪电场是 $E_{res} = \\mu_A / (\\varepsilon_0 L_{cell})$，其中 $L_{cell}$ 是包括板层厚度 $L_{slab}$ 和真空厚度 $L$ 在内的总超胞长度。\n$$ U_A(L) = \\frac{1}{2}\\varepsilon_0 \\left(\\frac{\\mu_A}{\\varepsilon_0 (L_{slab} + L)}\\right)^2 L = \\frac{\\mu_A^2 L}{2\\varepsilon_0 (L_{slab} + L)^2} $$\n由于问题没有提供 $L_{slab}$ 但要求一个解，我们必须做出一个物理上合理的近似。对于足够大的真空区域（这是我们为最小化相互作用所关注的范围），假设 $L \\gg L_{slab}$ 是合理的。在此极限下，$L_{cell} = L_{slab} + L \\approx L$。将此近似应用于 $U_A$ 的表达式：\n$$ U_A(L) \\approx \\frac{\\mu_A^2 L}{2\\varepsilon_0 L^2} = \\frac{\\mu_A^2}{2\\varepsilon_0 L} $$\n这个结果，即单位面积上的相互作用能与 $1/L$ 成正比，是针对大分离的标准近似。标准是 $U_A \\le \\delta_U$：\n$$ \\frac{\\mu_A^2}{2\\varepsilon_0 L} \\le \\delta_U $$\n解出 $L$ 得到相互作用能标准所要求的最小厚度 $L_U$：\n$$ L \\ge \\frac{\\mu_A^2}{2\\varepsilon_0 \\delta_U} $$\n因此，我们建立了 $L_U$ 的公式：\n$$ L_U = \\frac{\\mu_A^2}{2\\varepsilon_0 \\delta_U} $$\n单位是一致的：$(\\mathrm{C/m})^2 / ((\\mathrm{F/m}) \\cdot (\\mathrm{J/m^2})) = \\mathrm{m}$。此公式对于非极性情况（$\\mu_A = 0$）也有效，正确地得出 $L_U = 0\\,\\mathrm{m}$。真空介电常数为 $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\,\\mathrm{F}\\,\\mathrm{m}^{-1}$。\n\n最终计算\n最小真空层厚度 $L$ 必须同时满足两个标准。因此，所需的 $L$ 是从每个标准推导出的最小厚度中的最大值：\n$$ L_{min} = \\max(L_V, L_U) $$\n所得的 $L_{min}$ 值（单位为米）随后被转换为埃，并四舍五入到两位小数作为最终答案。",
            "answer": "[6.21,50.82,2.82]"
        },
        {
            "introduction": "超胞近似的一个固有局限性是，所模拟的缺陷或吸附物会与其周期性镜像发生伪相互作用，导致计算出的性质（如形成能或吸附能）随超胞尺寸而变化。为了获得在无限大体系（即无限稀释极限）下的真实值，必须消除这种有限尺寸效应。这项实践将介绍一种系统性的方法：通过对一系列不同尺寸超胞的计算结果进行外推，并利用基于物理洞察的标度律来提取渐近极限下的能量。",
            "id": "3893919",
            "problem": "您的任务是开发一个程序化流程，用于在计算催化和化学工程的超胞近似中，量化周期性边界条件（PBC）下的有限尺寸缺陷-缺陷相互作用。在 PBC 下，线性尺寸为 $L$ 的超胞中存在的缺陷会引发周期性镜像之间的相互作用，这使得计算出的缺陷形成能偏离其无限大尺寸极限值。基于静电学和弹性力学的物理论证表明，领先阶的有限尺寸修正通常按 $1/L$ 的幂次（对于带电或可极化系统中的单极或偶极类长程场）和 $1/L^3$ 的幂次（对于中性缺陷的四极弹性场）进行缩放。您的目标是设计并实现一个稳健的计算方法，该方法能根据在不同超胞尺寸下观测到的形成能，检验是 $1/L$ 还是 $1/L^3$（或其组合）主导了有限尺寸偏差，并提取出渐近的无限大尺寸形成能。\n\n从基本定义和经过充分检验的事实出发：\n- 在 PBC 下，由于缺陷与其周期性镜像之间的长程相互作用，缺陷形成能依赖于超胞尺寸。\n- 无限大尺寸极限是指 $L \\to \\infty$ 时的能量，记为 $E_{\\infty}$。\n- 线性响应和多极展开表明，领先的有限尺寸趋势表现为 $1/L$ 的幂次。\n\n您的程序必须为每个提供的测试用例遵循以下步骤：\n1. 使用提供的超胞线性尺寸 $L$ 列表，构建预测变量数组 $x_1(L) = 1/L$ 和 $x_3(L) = 1/L^3$。\n2. 对于观测到的形成能 $E(L)$，创建三个带有偏移项（截距）的候选线性预测模型，并根据普通最小二乘法准则评估它们对数据的解释适用性：\n   - 仅使用 $x_1$ 的模型。\n   - 仅使用 $x_3$ 的模型。\n   - 同时使用 $x_1$ 和 $x_3$ 的模型。\n   所选模型的截距代表 $E_{\\infty}$，因为当 $L \\to \\infty$ 时，$x_1 \\to 0$ 且 $x_3 \\to 0$。\n3. 为防止过拟合，并基于简洁、有原则的基础来规范模型选择，请使用惩罚模型复杂度的赤池信息准则 (Akaike Information Criterion, AIC) 来比较候选模型。排除任何自由参数数量超过数据点数量的模型。在所有可接受的模型中，选择 AIC 值最小的那个。\n4. 报告所选模型的截距，作为以电子伏特 (eV) 为单位的估计渐近形成能 $E_{\\infty}$。同时报告一个代码，用以指示所选的领先阶趋势：对于 $1/L$ 模型使用 $1$，对于 $1/L^3$ 模型使用 $3$，对于 $1/L$ 和 $1/L^3$ 的组合模型使用 $13$。\n\n角度单位不适用。所有能量必须以电子伏特 (eV) 为单位处理，所有长度 $L$ 以埃 (Å) 为单位。最终能量以 eV 表示。最终输出必须将每个 $E_{\\infty}$ 精确格式化到 $6$ 位小数。\n\n测试套件：\n使用以下科学上合理的数据集，这些数据集代表了在超胞线性尺寸 $L$ (Å) 下的形成能值 $E(L)$ (eV)。选择这些案例是为了覆盖典型的行为、边界和边缘条件。\n\n- 案例 A (以 $1/L$ 行为为主，伴有小噪声)：$L = [10, 14, 20, 30, 40]$, $E(L) = [2.802, 2.5699285712, 2.4005, 2.2658666664, 2.2012]$。\n- 案例 B (以 $1/L^3$ 行为为主，伴有小噪声)：$L = [10, 20, 40, 80, 160]$, $E(L) = [1.701, 1.5242, 1.503425, 1.500190625, 1.500148828125]$。\n- 案例 C (混合行为，伴有小噪声)：$L = [8, 12, 16, 24, 32, 48]$, $E(L) = [3.92046875, 3.5024722223, 3.34992109375, 3.2179840277, 3.16122763671875, 3.1049226667]$。\n- 案例 D (边界案例，点数最少但允许模型比较)：$L = [12, 24, 48]$, $E(L) = [2.95, 2.575, 2.3875]$。\n- 案例 E (能量接近平坦，有限尺寸趋势非常弱)：$L = [20, 40, 80, 160]$, $E(L) = [1.005325, 1.002415625, 1.001401953125, 1.000575244140625]$。\n\n程序输出规范：\n您的程序应生成单行输出，其中包含一个以方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果表示为一个双元素列表 $[E_{\\infty}, \\text{model\\_code}]$，其中 $E_{\\infty}$ 格式化为六位小数，$\\text{model\\_code} \\in \\{1, 3, 13\\}$。例如：\n\"[[2.000000,1],[1.500000,3],[2.950000,13]]\"\n您的实际输出必须为五个测试用例中的每一个包含一对结果，按 A、B、C、D、E 的顺序排列。",
            "solution": "目标是利用周期性边界条件 (PBC) 和超胞近似的物理学所预测的趋势，从有限尺寸的超胞数据中估算无限大尺寸的缺陷形成能 $E_{\\infty}$。在 PBC 下，缺陷与其周期性镜像相互作用。对于带电或可极化的缺陷，静电相互作用会产生长程场，从而导致有限尺寸修正按 $1/L$ 的幂次进行缩放，对于偶极项通常是 $1/L$。对于产生弹性畸变的中性缺陷，弹性多极展开分析（例如，四极应变场）产生的修正通常按 $1/L^3$ 进行缩放。因此，形成能对超胞尺寸的领先阶依赖关系可以用预测变量 $x_1(L) = 1/L$ 和 $x_3(L) = 1/L^3$ 来合理解释。\n\n当 $L \\to \\infty$ 时，$x_1 \\to 0$ 且 $x_3 \\to 0$，因此观测到的形成能 $E(L)$ 对这些预测变量进行回归的截距（常数偏移）对应于渐近极限 $E_{\\infty}$。这提供了一种有原则的方法来提取 $E_{\\infty}$，而无需先验地依赖单一的假定缩放定律，其方法是测试仅含 $x_1$、仅含 $x_3$ 以及组合 $(x_1, x_3)$ 的模型，并以统计上严谨的方式在它们之间进行选择。\n\n基于基本原理的算法设计：\n\n1. 预测变量的构建：\n   给定超胞尺寸数组 $L_i$ 和观测到的形成能 $E_i = E(L_i)$，定义 $x_{1,i} = 1/L_i$ 和 $x_{3,i} = 1/L_i^3$。这些预测变量编码了静电学和弹性力学所建议的主要有限尺寸缩放规律。\n\n2. 带截距的线性模型：\n   考虑三个包含截距参数（常数项）以表示 $E_{\\infty}$ 的候选线性模型。虽然可以为回归写下明确的代数形式，但以矩阵形式描述它们已经足够且更具通用性：\n   - 仅使用 $x_1$ 的模型：构建设计矩阵 $X \\in \\mathbb{R}^{n \\times 2}$，第一列为 1，第二列为 $x_1$。\n   - 仅使用 $x_3$ 的模型：构建设计矩阵 $X \\in \\mathbb{R}^{n \\times 2}$，第一列为 1，第二列为 $x_3$。\n   - 同时使用 $x_1$ 和 $x_3$ 的模型：构建设计矩阵 $X \\in \\mathbb{R}^{n \\times 3}$，列为 $[1, x_1, x_3]$。\n   此处 $n$ 是数据点的数量。在每种情况下，截距是与全为 1 的列相关的参数，并对应于 $E_{\\infty}$，因为当 $L \\to \\infty$ 时，$x_1$ 和 $x_3$ 都趋于零。\n\n3. 普通最小二乘法 (OLS)：\n   对于每个模型，通过 OLS 解估算参数向量 $\\hat{\\beta}$。在矩阵术语中，这是通过最小化残差平方和 (RSS) $R = \\sum_{i=1}^{n} \\left(E_i - (X \\hat{\\beta})_i\\right)^2$ 来计算的。OLS 的一个标准闭式解由 $$\\hat{\\beta} = (X^\\top X)^{-1} X^\\top E$$ 给出，前提是 $X^\\top X$ 是非奇异的；在实践中，数值最小二乘法（例如，通过伪逆或稳健的线性求解器）是合适的。截距 $\\hat{\\beta}_0$ 被识别为 $E_{\\infty}$ 的估计值。\n\n4. 使用赤池信息准则 (AIC) 进行模型选择：\n   为了形式化候选模型之间的选择，使用赤池信息准č则 (AIC)，它平衡了拟合优度和模型复杂度。假设残差是独立同分布的高斯分布且方差未知，AIC 在相加一个在比较中会抵消的常数后可表示为\n   $$\\mathrm{AIC} = n \\ln\\left(\\frac{R}{n}\\right) + 2 k,$$\n   其中 $R$ 是残差平方和，$k$ 是自由参数的数量（截距和所含预测变量的斜率）。对于仅含 $x_1$ 和仅含 $x_3$ 的模型，$k=2$。对于组合模型，$k=3$。排除任何参数数量 $k$ 超过 $n$ 的模型，因为这样的模型无法可靠拟合，并且会过拟合数据。在数值实现中，可以在对数内包含一个小的正数 $\\epsilon$ 以避免在精确拟合的边缘情况下出现 $\\ln(0)$；当残差不为零时，这不影响模型排名，并可作为简并情况下的稳定保障。\n\n   在可接受的模型中选择 AIC 最小的模型。\n\n5. 输出：\n   对于每个测试用例，报告所选模型的截距 $E_{\\infty}$（单位为电子伏特 eV），格式化为恰好 $6$ 位小数，并附上相应的模型代码：对于仅含 $x_1$ 的模型（$1/L$ 主导）使用 $1$，对于仅含 $x_3$ 的模型（$1/L^3$ 主导）使用 $3$，对于组合模型使用 $13$。将所有测试用例的结果聚合为单行，形式为方括号内的逗号分隔列表项，其中每个条目是一个双元素列表 $[E_{\\infty}, \\text{model\\_code}]$。\n\n基本原理和物理解释：\n- 截距对应于 $E_{\\infty}$，因为在 $L \\to \\infty$ 的极限下，有限尺寸预测变量 $x_1$ 和 $x_3$ 消失，只剩下常数项。这与镜像间相互作用随超胞尺寸增大而衰减的物理预期一致。\n- $x_1$ 和 $x_3$ 项的存在与否反映了缺陷长程场的主要多极特征：$1/L$ 趋势表明存在类偶极静电贡献或类似尺度的相互作用；$1/L^3$ 趋势表明存在四极弹性相互作用或更高阶的多极子。\n- 基于 AIC 的选择平衡了拟合质量和简洁性，避免了过拟合，并产生了一个与数据一致且合理的趋势选择。\n\n测试套件覆盖范围：\n- 案例 A 强调了以 $1/L$ 为主导并带有少量随机偏差的情景。\n- 案例 B 捕捉了以 $1/L^3$ 为主导、代表弹性场控制行为的情景。\n- 案例 C 包含了两个预测变量，以确保组合模型的必要性。\n- 案例 D 是一个能够进行模型比较而不会出现欠定问题的最小数据集，用于验证模型选择能够避免不必要的复杂性。\n- 案例 E 测试了在能量几乎平坦、有限尺寸效应非常弱的情况下的稳健性。\n\n最终的程序实现了这些步骤，计算 OLS 拟合，为每个可接受的模型评估 AIC，并按指定格式打印所需的输出。",
            "answer": "[[2.000188,1],[1.500000,3],[2.998638,13],[2.200000,1],[1.000000,3]]"
        }
    ]
}