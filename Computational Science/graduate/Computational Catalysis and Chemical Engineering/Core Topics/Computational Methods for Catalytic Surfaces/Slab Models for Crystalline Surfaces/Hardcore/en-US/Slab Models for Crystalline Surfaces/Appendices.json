{
    "hands_on_practices": [
        {
            "introduction": "A foundational step in simulating surface phenomena is constructing a supercell that accurately represents the desired adsorbate coverage. This practice connects the macroscopic concept of coverage, $\\Theta$, to the microscopic geometry of the simulation cell. By working through this exercise, you will learn how to determine the necessary lateral dimensions of your slab model based on the surface crystallography and the specific chemical scenario you aim to study, a crucial skill for setting up meaningful computational experiments. ",
            "id": "3899366",
            "problem": "In computational catalysis and chemical engineering, slab models for crystalline surfaces must represent a target adsorbate coverage in a finite, periodic supercell. Coverage, denoted by $\\Theta$, is defined as the fraction of available adsorption sites occupied, and surface site density, denoted by $\\rho_{s}$, is defined as the number of adsorption sites per unit area. For a slab model that places exactly one adsorbate per lateral supercell, the minimal lateral supercell area is the area required per adsorbate for the target coverage.\n\nStarting from the definitions of coverage and surface site density, derive an expression for the minimal lateral supercell area $A_{\\mathrm{cell}}$ that yields one adsorbate per supercell at a target coverage $\\Theta$ on a surface with site density $\\rho_{s}$. Then, consider a Face-Centered Cubic (FCC) $(111)$ surface with conventional cubic lattice parameter $a$ forming a two-dimensional (2D) hexagonal lattice of surface atoms. Using crystallographic geometry for the FCC $(111)$ plane, express $\\rho_{s}$ in terms of $a$ and fundamental constants, and use your derived expression for $A_{\\mathrm{cell}}$ to compute the minimal supercell area when $a = 0.39200\\,\\mathrm{nm}$ and $\\Theta = \\frac{1}{3}$.\n\nExpress the final area in $\\mathrm{nm}^{2}$ and round your answer to four significant figures.",
            "solution": "The problem will be solved in three stages. First, we will derive a general expression for the minimal lateral supercell area, $A_{\\mathrm{cell}}$, in terms of the target coverage, $\\Theta$, and the surface site density, $\\rho_{s}$. Second, we will derive an expression for the site density, $\\rho_{s}$, for a Face-Centered Cubic (FCC) $(111)$ surface as a function of the conventional cubic lattice parameter, $a$. Finally, we will combine these expressions and substitute the given numerical values to compute the final area.\n\n**Part 1: Derivation of the minimal supercell area, $A_{\\mathrm{cell}}$**\n\nCoverage, $\\Theta$, is defined as the fraction of available adsorption sites that are occupied. For a uniform surface area $A$ containing $N_{\\mathrm{ads}}$ adsorbates and having a total of $N_{\\mathrm{sites}}$ available adsorption sites, the coverage is:\n$$\n\\Theta = \\frac{N_{\\mathrm{ads}}}{N_{\\mathrm{sites}}}\n$$\nThe surface site density, $\\rho_{s}$, is the number of available adsorption sites per unit area. Therefore, the total number of sites in an area $A$ can be expressed as:\n$$\nN_{\\mathrm{sites}} = \\rho_{s} A\n$$\nSubstituting this into the expression for coverage gives:\n$$\n\\Theta = \\frac{N_{\\mathrm{ads}}}{\\rho_{s} A}\n$$\nThe problem specifies a slab model with a minimal lateral supercell of area $A_{\\mathrm{cell}}$ that contains exactly one adsorbate. For this specific case, we set $N_{\\mathrm{ads}} = 1$ and $A = A_{\\mathrm{cell}}$. The expression for coverage becomes:\n$$\n\\Theta = \\frac{1}{\\rho_{s} A_{\\mathrm{cell}}}\n$$\nRearranging this equation to solve for the minimal supercell area, $A_{\\mathrm{cell}}$, yields the desired general expression:\n$$\nA_{\\mathrm{cell}} = \\frac{1}{\\Theta \\rho_{s}}\n$$\n\n**Part 2: Derivation of the surface site density, $\\rho_{s}$, for an FCC(111) surface**\n\nThe FCC $(111)$ surface consists of atoms arranged in a two-dimensional (2D) hexagonal lattice. To find the site density, we must first determine the area occupied by a single surface atom, assuming one adsorption site per atom (e.g., an atop site). This area is equivalent to the area of the primitive unit cell of the 2D surface lattice.\n\nIn an FCC crystal lattice with a conventional cubic lattice parameter $a$, the shortest distance between atoms (the nearest-neighbor distance, $d_{\\mathrm{nn}}$) is the distance from a corner atom to a face-center atom. This distance is:\n$$\nd_{\\mathrm{nn}} = \\sqrt{\\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2}\\right)^2} = \\sqrt{\\frac{a^2}{4} + \\frac{a^2}{4}} = \\sqrt{\\frac{a^2}{2}} = \\frac{a}{\\sqrt{2}}\n$$\nThe primitive unit cell of the 2D hexagonal lattice on the $(111)$ surface is a rhombus. The sides of this rhombus are defined by the nearest-neighbor vectors on the surface, so the side length $s$ is equal to $d_{\\mathrm{nn}}$. The internal angles of this rhombus are $60^{\\circ}$ and $120^{\\circ}$.\n\nThe area of this primitive rhombus cell, $A_{\\mathrm{prim}}$, which contains exactly one lattice point (and thus one surface atom/site), is given by the formula $A = s^2 \\sin(\\alpha)$, where $\\alpha$ is one of the internal angles. Using $\\alpha = 60^{\\circ}$:\n$$\nA_{\\mathrm{prim}} = s^2 \\sin(60^{\\circ}) = \\left(\\frac{a}{\\sqrt{2}}\\right)^2 \\frac{\\sqrt{3}}{2} = \\frac{a^2}{2} \\frac{\\sqrt{3}}{2} = \\frac{\\sqrt{3} a^2}{4}\n$$\nThis is the area per site. The surface site density, $\\rho_{s}$, is the reciprocal of this area:\n$$\n\\rho_{s} = \\frac{1}{A_{\\mathrm{prim}}} = \\frac{4}{\\sqrt{3} a^2}\n$$\n\n**Part 3: Calculation of the minimal supercell area, $A_{\\mathrm{cell}}$**\n\nNow we substitute the expression for $\\rho_{s}$ for the FCC$(111)$ surface into our general formula for $A_{\\mathrm{cell}}$:\n$$\nA_{\\mathrm{cell}} = \\frac{1}{\\Theta \\rho_{s}} = \\frac{1}{\\Theta} \\left(\\frac{1}{\\rho_{s}}\\right) = \\frac{1}{\\Theta} A_{\\mathrm{prim}} = \\frac{1}{\\Theta} \\frac{\\sqrt{3} a^2}{4}\n$$\nThe problem provides the following values:\n- Conventional cubic lattice parameter: $a = 0.39200\\,\\mathrm{nm}$\n- Target coverage: $\\Theta = \\frac{1}{3}$\n\nSubstituting these values into the expression for $A_{\\mathrm{cell}}$:\n$$\nA_{\\mathrm{cell}} = \\frac{1}{\\frac{1}{3}} \\frac{\\sqrt{3} (0.39200\\,\\mathrm{nm})^2}{4} = 3 \\times \\frac{\\sqrt{3} (0.39200)^2}{4}\\,\\mathrm{nm}^2\n$$\n$$\nA_{\\mathrm{cell}} = \\frac{3 \\sqrt{3}}{4} (0.39200)^2\\,\\mathrm{nm}^2\n$$\nNow, we perform the numerical calculation:\n$$\n(0.39200)^2 = 0.153664\n$$\n$$\nA_{\\mathrm{cell}} = \\frac{3 \\sqrt{3}}{4} (0.153664)\\,\\mathrm{nm}^2 \\approx (1.299038) \\times (0.153664)\\,\\mathrm{nm}^2 \\approx 0.1996203\\,\\mathrm{nm}^2\n$$\nThe problem requires the answer to be rounded to four significant figures. The fifth significant figure is $2$, so we round down.\n$$\nA_{\\mathrm{cell}} \\approx 0.1996\\,\\mathrm{nm}^2\n$$",
            "answer": "$$\\boxed{0.1996}$$"
        },
        {
            "introduction": "Slab models are inherently finite approximations of a semi-infinite surface, which introduces errors that depend on the slab's thickness. This exercise delves into the physical origin of these finite-size effects, showing how surface stress induces strain within the slab, altering its total energy. You will derive the mathematical relationship between the calculated surface energy and slab thickness and then apply this model to a set of hypothetical data to extract the true, converged surface energy, a vital procedure for ensuring the accuracy of surface property calculations. ",
            "id": "3899339",
            "problem": "Consider a crystalline face-centered cubic metal with a $(111)$ surface modeled by a periodic, symmetric slab containing $N$ atomic layers, a primitive surface unit cell of area $A$, and two equivalent free surfaces. Let the total energy of the slab be $E_{\\mathrm{slab}}(N)$ and the bulk energy per atom be $e_{\\mathrm{bulk}}$. The surface energy per unit area is defined by the core thermodynamic relation\n$$\n\\gamma(N) \\equiv \\frac{E_{\\mathrm{slab}}(N) - N\\,e_{\\mathrm{bulk}}}{2A},\n$$\nwhere the denominator accounts for the two identical surfaces in the symmetric slab. Assume the slab is fully relaxed in the direction normal to the surface under zero external load and is subject to in-plane periodic boundary conditions so that any in-plane strain is uniform across the slab thickness.\n\nStarting strictly from this definition and from linear elastic response of a homogeneous continuum, reason about how the presence of two stressed surfaces separated by a thickness $t$ causes a finite-size correction to the surface energy. Use the plane-stress constitutive relation $\\sigma = E'\\,\\varepsilon$ (where $E'$ is the appropriate plane-stress elastic modulus and $\\varepsilon$ is the in-plane strain) and the mechanical equilibrium condition that the net in-plane force in the slab balances the surface stresses. Derive the leading-order finite-size scaling of $\\gamma(N)$ with increasing $N$, showing that it approaches $\\gamma(\\infty)$ with an inverse-thickness correction. Express your result in terms of the interlayer spacing $d$ (so that $t = N d$), the surface stress magnitude $s$ (units of $\\mathrm{N}\\,\\mathrm{m}^{-1}$), and $E'$.\n\nThen, consider a set of surface energy calculations for slabs of different thicknesses $N \\in \\{4,6,8,10,12\\}$, reported per unit area for the primitive $(111)$ surface cell:\n- $N=4$: $\\gamma(4) = 1.8\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$\n- $N=6$: $\\gamma(6) = 1.733333\\ldots\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$\n- $N=8$: $\\gamma(8) = 1.7\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$\n- $N=10$: $\\gamma(10) = 1.68\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$\n- $N=12$: $\\gamma(12) = 1.666666\\ldots\\,\\mathrm{J}\\,\\mathrm{m}^{-2}$\n\nUsing the leading-order finite-size model you derived, fit $\\gamma(N)$ as a function of $1/N$ by ordinary least squares to extract the asymptotic surface energy $\\gamma(\\infty)$. Round your final value to four significant figures. Express the final energy in $\\mathrm{J}\\,\\mathrm{m}^{-2}$. The final answer must be a single real number.",
            "solution": "The problem requires a two-part solution. First, we must derive the leading-order finite-size scaling for the calculated surface energy of a symmetric slab. Second, we must use this scaling law to analyze a given set of computational data and extract the surface energy for an infinitely thick slab, $\\gamma(\\infty)$.\n\nPart 1: Derivation of the Finite-Size Scaling of Surface Energy\n\nThe problem defines the calculated surface energy for a slab of $N$ layers as:\n$$\n\\gamma(N) = \\frac{E_{\\mathrm{slab}}(N) - N\\,e_{\\mathrm{bulk}}}{2A}\n$$\nwhere $E_{\\mathrm{slab}}(N)$ is the total energy of the slab, $e_{\\mathrm{bulk}}$ is the energy of a corresponding layer of atoms in the bulk, and $A$ is the area of the primitive surface unit cell. The factor of $2$ in the denominator accounts for the two identical surfaces of the symmetric slab.\n\nThe total energy of the slab, $E_{\\mathrm{slab}}(N)$, can be decomposed into three components:\n1.  The energy of $N$ layers of bulk material, which is $N\\,e_{\\mathrm{bulk}}$.\n2.  The energy required to create the two surfaces, assuming the slab is infinitely thick. This is $2A\\,\\gamma(\\infty)$, where $\\gamma(\\infty)$ is the true surface energy of a semi-infinite solid.\n3.  An additional energy term, $U_{\\mathrm{el}}$, arising from the elastic deformation of the slab. This deformation is caused by the surface stress.\n\nThe total energy is thus modeled as:\n$$\nE_{\\mathrm{slab}}(N) = N\\,e_{\\mathrm{bulk}} + 2A\\,\\gamma(\\infty) + U_{\\mathrm{el}}\n$$\n\nThe origin of the elastic energy $U_{\\mathrm{el}}$ is the mechanical equilibrium between the surface stress and the induced bulk stress. A surface possesses a surface stress, $s$, which is a measure of the force per unit length acting within the surface plane. For a free-standing slab with two surfaces, the tensile or compressive forces exerted by the surfaces must be balanced by an opposing stress within the bulk of the slab.\n\nLet the slab have a thickness $t$. The condition of mechanical equilibrium for the in-plane forces, integrated over the slab thickness, states that the net force is zero. Per unit length of a conceptual cut through the slab, the total force from the two surfaces is $2s$, which must be balanced by the integrated bulk stress, $\\sigma t$.\n$$\n2s + \\sigma t = 0\n$$\nThis yields the in-plane bulk stress $\\sigma$ induced by the surface stress:\n$$\n\\sigma = -\\frac{2s}{t}\n$$\nAccording to the provided plane-stress constitutive relation, $\\sigma = E'\\,\\varepsilon$, where $E'$ is the plane-stress elastic modulus, the uniform in-plane strain $\\varepsilon$ in the slab is:\n$$\n\\varepsilon = \\frac{\\sigma}{E'} = -\\frac{2s}{t E'}\n$$\nThis strain stores elastic energy in the slab. For a linear elastic material under isotropic in-plane stress, the elastic strain energy density (energy per unit volume), $w_{\\mathrm{el}}$, is given by $w_{\\mathrm{el}} = \\frac{1}{2} \\sigma \\varepsilon$. The total elastic energy $U_{\\mathrm{el}}$ stored in the volume of the slab $V = A t$ is:\n$$\nU_{\\mathrm{el}} = w_{\\mathrm{el}} V = \\left(\\frac{1}{2} \\sigma \\varepsilon\\right)(A t) = \\frac{1}{2} \\left(-\\frac{2s}{t}\\right) \\left(-\\frac{2s}{t E'}\\right) (A t) = \\frac{2 A s^2}{t E'}\n$$\nNow we can substitute the expression for $E_{\\mathrm{slab}}(N)$ into the definition of $\\gamma(N)$:\n$$\n\\gamma(N) = \\frac{(N\\,e_{\\mathrm{bulk}} + 2A\\,\\gamma(\\infty) + U_{\\mathrm{el}}) - N\\,e_{\\mathrm{bulk}}}{2A} = \\frac{2A\\,\\gamma(\\infty) + U_{\\mathrm{el}}}{2A} = \\gamma(\\infty) + \\frac{U_{\\mathrm{el}}}{2A}\n$$\nSubstituting the derived expression for $U_{\\mathrm{el}}$:\n$$\n\\gamma(N) = \\gamma(\\infty) + \\frac{1}{2A} \\left( \\frac{2 A s^2}{t E'} \\right) = \\gamma(\\infty) + \\frac{s^2}{t E'}\n$$\nThe problem states that the slab thickness $t$ is related to the number of layers $N$ and the interlayer spacing $d$ by $t = N d$. Substituting this gives the final scaling relation:\n$$\n\\gamma(N) = \\gamma(\\infty) + \\left(\\frac{s^2}{E'd}\\right) \\frac{1}{N}\n$$\nThis equation shows that the calculated surface energy $\\gamma(N)$ approaches the true surface energy $\\gamma(\\infty)$ with a correction term that scales inversely with the number of layers $N$ (and thus the slab thickness $t$). This relationship is linear in the variable $1/N$, having the form $y = c + mx$, where $y = \\gamma(N)$, $x = 1/N$, the y-intercept is $c = \\gamma(\\infty)$, and the slope is $m = s^2/(E'd)$.\n\nPart 2: Data Analysis and Extraction of $\\gamma(\\infty)$\n\nWe are given a set of five data points $(\\gamma(N), N)$ and are asked to find $\\gamma(\\infty)$ by fitting the data to the derived linear model. The data points are:\n- ($N=4, \\gamma(4) = 1.8$) which corresponds to $(x,y) = (1/4, 1.8) = (0.25, 1.8)$\n- ($N=6, \\gamma(6) = 1.733333\\ldots = 26/15$) which corresponds to $(x,y) = (1/6, 26/15)$\n- ($N=8, \\gamma(8) = 1.7$) which corresponds to $(x,y) = (1/8, 1.7) = (0.125, 1.7)$\n- ($N=10, \\gamma(10) = 1.68$) which corresponds to $(x,y) = (1/10, 1.68) = (0.1, 1.68)$\n- ($N=12, \\gamma(12) = 1.666666\\ldots = 5/3$) which corresponds to $(x,y) = (1/12, 5/3)$\n\nWe perform an ordinary least squares (OLS) regression on these five points $(x_i, y_i) = (1/N_i, \\gamma(N_i))$ to find the parameters of the line $y = c + mx$. The parameter of interest is the intercept $c$, which represents $\\gamma(\\infty)$.\n\nThe formulas for the OLS estimators for the slope ($m$) and intercept ($c$) are:\n$$\nm = \\frac{n \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{n \\sum(x_i^2) - (\\sum x_i)^2}\n\\quad \\text{and} \\quad\nc = \\bar{y} - m \\bar{x}\n$$\nwhere $n=5$ is the number of data points, and $\\bar{x}$ and $\\bar{y}$ are the sample means of $x$ and $y$.\n\nAs it turns out, the provided data points perfectly lie on a straight line. We can verify this by checking if the model $\\gamma(N) = c + m/N$ holds for some constants $c$ and $m$.\nLet's test the hypothesis that the data follow the equation $\\gamma(N) = 1.6 + 0.8/N$:\n- For $N=4$: $\\gamma(4) = 1.6 + 0.8/4 = 1.6 + 0.2 = 1.8$. This matches the data.\n- For $N=6$: $\\gamma(6) = 1.6 + 0.8/6 = 1.6 + 4/30 = 8/5 + 2/15 = 24/15 + 2/15 = 26/15 = 1.7333\\ldots$. This matches the data.\n- For $N=8$: $\\gamma(8) = 1.6 + 0.8/8 = 1.6 + 0.1 = 1.7$. This matches the data.\n- For $N=10$: $\\gamma(10) = 1.6 + 0.8/10 = 1.6 + 0.08 = 1.68$. This matches the data.\n- For $N=12$: $\\gamma(12) = 1.6 + 0.8/12 = 1.6 + 1/15 = 8/5 + 1/15 = 24/15 + 1/15 = 25/15 = 5/3 = 1.6666\\ldots$. This matches the data.\n\nSince the data points perfectly fit the linear model $\\gamma(N) = 1.6 + 0.8/N$, the ordinary least squares fit will yield exactly these parameters. The intercept of the line $\\gamma(N)$ versus $1/N$ is the value of $\\gamma(N)$ as $1/N \\to 0$, which corresponds to $N \\to \\infty$.\nTherefore, the asymptotic surface energy is:\n$$\n\\gamma(\\infty) = 1.6 \\, \\mathrm{J}\\,\\mathrm{m}^{-2}\n$$\nThe problem requires rounding the final value to four significant figures. Thus, the value is $1.600$.",
            "answer": "$$\\boxed{1.600}$$"
        },
        {
            "introduction": "When using periodic boundary conditions, it is crucial to make the vacuum layer separating slab images large enough to prevent spurious interactions. This practice explores the quantum mechanical origins of these interactions, rooted in the evanescent decay of electronic wavefunctions into the vacuum. You will derive the characteristic decay length from fundamental principles and design a robust protocol for choosing an adequate vacuum spacing by simultaneously monitoring charge density overlap and total energy convergence, a critical step for obtaining reliable and artifact-free simulation results. ",
            "id": "3899413",
            "problem": "Consider a symmetric metallic slab model used in surface simulations of catalytic materials. The slab has two identical surfaces separated by a vacuum thickness denoted by $L_{\\mathrm{vac}}$. The electronic structure calculation performed on such a slab can exhibit spurious interactions between the two surfaces when $L_{\\mathrm{vac}}$ is insufficiently large, due to the overlap of the evanescent electronic states into the vacuum. For metals, outside the surface the electrons experience a potential barrier set by the work function, causing the wavefunction amplitude to decay into the vacuum. The interaction between the two interfaces through the vacuum leads to an $L_{\\mathrm{vac}}$-dependent correction to the total energy of the slab, and the planar-averaged charge density in the vacuum decays away from each surface.\n\nStarting from the time-independent Schrödinger equation for a particle of mass $m_{\\mathrm{e}}$ in a region outside a metal where the energy relative to the vacuum level is below the barrier height set by the work function $\\Phi$, and recognizing that the solution in the classically forbidden region is evanescent, derive the functional dependence of the decay constant that governs the exponential suppression of the electronic wavefunction amplitude into the vacuum in terms of $\\Phi$, $m_{\\mathrm{e}}$, and the reduced Planck constant $\\hbar$. Use only this fundamental base and standard unit conversions.\n\nAssume the planar-averaged charge density in the vacuum region due to one surface takes an exponentially decaying form with a characteristic amplitude near the surface and the proper decay constant you have derived. Consider the symmetric slab where the vacuum separates two identical surfaces. The total energy of the slab approaches an asymptote as $L_{\\mathrm{vac}}$ increases, with a correction term that is governed by the overlap of the evanescent densities. The task is to design and implement a protocol for choosing $L_{\\mathrm{vac}}$ from a specified grid such that both of the following quantitative criteria are simultaneously satisfied:\n- The planar-averaged charge density at the mid-vacuum plane $z = L_{\\mathrm{vac}}/2$ is not greater than a specified threshold $\\rho_{\\mathrm{thresh}}$.\n- The magnitude of the $L_{\\mathrm{vac}}$-dependent correction to the total energy is not greater than a specified tolerance $\\delta E$.\n\nThe implementation should compute the decay constant from the work function, evaluate the total energy convergence as a function of $L_{\\mathrm{vac}}$, and implement the protocol for choosing the minimal $L_{\\mathrm{vac}}$ on the provided grid that simultaneously satisfies both criteria.\nFor each test case, the result should be a list containing:\n    1. The selected $L_{\\mathrm{vac}}$ on the grid, expressed in $\\mathrm{\\AA}$, rounded to three decimal places.\n    2. The energy correction magnitude at the selected $L_{\\mathrm{vac}}$, expressed in $\\mathrm{eV}$, rounded to six decimal places.\n    3. A boolean indicating whether the mid-vacuum charge density criterion is satisfied at the selected $L_{\\mathrm{vac}}$.\n\nPhysical units must be respected:\n- Express $L_{\\mathrm{vac}}$ in $\\mathrm{\\AA}$.\n- Express energies in $\\mathrm{eV}$.\n- Express charge densities in $\\mathrm{e}/\\mathrm{\\AA}^3$.\n\nUse the following test suite of parameter values. For each case, treat $E_{\\infty}$ as the asymptotic total energy in $\\mathrm{eV}$, $C$ as a positive prefactor for the energy correction term in $\\mathrm{eV}$, $\\rho_0$ as the characteristic amplitude of the planar-averaged charge density near a surface in $\\mathrm{e}/\\mathrm{\\AA}^3$, and $\\Phi$ as the work function in $\\mathrm{eV}$. The $L_{\\mathrm{vac}}$ grid is specified by its start, stop, and step in $\\mathrm{\\AA}$, inclusive of the start and stop if the step divides the interval.\n\n- Test case $1$ (happy path):\n    - $\\Phi = 5.4\\,\\mathrm{eV}$, $\\rho_0 = 0.05\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $C = 0.2\\,\\mathrm{eV}$, $E_{\\infty} = -123.45\\,\\mathrm{eV}$, $\\rho_{\\mathrm{thresh}} = 1\\times 10^{-5}\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $\\delta E = 1\\times 10^{-3}\\,\\mathrm{eV}$, $L_{\\mathrm{vac}}$ grid: start $5\\,\\mathrm{\\AA}$, stop $30\\,\\mathrm{\\AA}$, step $1\\,\\mathrm{\\AA}$.\n- Test case $2$ (weaker barrier, stronger tails):\n    - $\\Phi = 3.0\\,\\mathrm{eV}$, $\\rho_0 = 0.10\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $C = 0.3\\,\\mathrm{eV}$, $E_{\\infty} = -45.678\\,\\mathrm{eV}$, $\\rho_{\\mathrm{thresh}} = 1\\times 10^{-6}\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $\\delta E = 5\\times 10^{-4}\\,\\mathrm{eV}$, $L_{\\mathrm{vac}}$ grid: start $5\\,\\mathrm{\\AA}$, stop $35\\,\\mathrm{\\AA}$, step $1\\,\\mathrm{\\AA}$.\n- Test case $3$ (coarse thresholds):\n    - $\\Phi = 4.5\\,\\mathrm{eV}$, $\\rho_0 = 0.05\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $C = 0.1\\,\\mathrm{eV}$, $E_{\\infty} = -10.0\\,\\mathrm{eV}$, $\\rho_{\\mathrm{thresh}} = 1\\times 10^{-3}\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $\\delta E = 1\\times 10^{-2}\\,\\mathrm{eV}$, $L_{\\mathrm{vac}}$ grid: start $5\\,\\mathrm{\\AA}$, stop $20\\,\\mathrm{\\AA}$, step $1\\,\\mathrm{\\AA}$.\n- Test case $4$ (tight tolerances and threshold):\n    - $\\Phi = 5.5\\,\\mathrm{eV}$, $\\rho_0 = 0.05\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $C = 0.2\\,\\mathrm{eV}$, $E_{\\infty} = -200.0\\,\\mathrm{eV}$, $\\rho_{\\mathrm{thresh}} = 1\\times 10^{-8}\\,\\mathrm{e}/\\mathrm{\\AA}^3$, $\\delta E = 1\\times 10^{-7}\\,\\mathrm{eV}$, $L_{\\mathrm{vac}}$ grid: start $5\\,\\mathrm{\\AA}$, stop $50\\,\\mathrm{\\AA}$, step $1\\,\\mathrm{\\AA}$.",
            "solution": "The solution proceeds in three main stages:\n1. Derivation of the decay constant for the electronic wavefunction and charge density in the vacuum region.\n2. Formulation of the mathematical models for the vacuum charge density and inter-slab energy correction.\n3. Implementation of a numerical algorithm to find the minimal vacuum thickness, $L_{\\mathrm{vac}}$, that satisfies the given convergence criteria.\n\n**1. Derivation of the Decay Constant**\n\nThe starting point is the one-dimensional time-independent Schrödinger equation (TISE) for an electron of mass $m_{\\mathrm{e}}$ in the vacuum region. We place the origin $z=0$ at the edge of one slab surface, so the vacuum spans the region $0  z  L_{\\mathrm{vac}}$. In this region, the potential $V(z)$ is assumed to be constant and equal to the vacuum level, $V_0$. The TISE is:\n$$ -\\frac{\\hbar^2}{2m_{\\mathrm{e}}} \\frac{d^2\\psi(z)}{dz^2} + V_0\\psi(z) = E\\psi(z) $$\nwhere $\\psi(z)$ is the wavefunction, $E$ is the electron energy, and $\\hbar$ is the reduced Planck constant.\n\nFor evanescent states, the electron's energy $E$ is less than the potential barrier height $V_0$. The work function, $\\Phi$, is defined as $\\Phi = V_0 - E_{\\mathrm{F}}$, where $E_{\\mathrm{F}}$ is the Fermi energy. The electrons at the Fermi level have the longest-ranging wavefunctions into the vacuum, governing the overall decay behavior. For such an electron, the energy difference $V_0 - E$ in the TISE is equal to the work function $\\Phi$.\n\nRearranging the TISE gives:\n$$ \\frac{d^2\\psi(z)}{dz^2} = \\left(\\frac{2m_{\\mathrm{e}}\\Phi}{\\hbar^2}\\right)\\psi(z) $$\nThis is a standard second-order ordinary differential equation. We define the decay constant $\\kappa$ as:\n$$ \\kappa = \\sqrt{\\frac{2m_{\\mathrm{e}}\\Phi}{\\hbar^2}} $$\nThe general solution for the wavefunction is $\\psi(z) = A e^{-\\kappa z} + B e^{\\kappa z}$. For a single surface at $z=0$ and vacuum for $z>0$, the physically realistic solution must decay to zero as $z \\to \\infty$, so the wavefunction has the form $\\psi(z) \\propto e^{-\\kappa z}$. This $\\kappa$ is the decay constant for the wavefunction amplitude.\n\nThe planar-averaged electronic charge density, $\\rho(z)$, is proportional to the squared magnitude of the wavefunction, summed over occupied states. Assuming the decay is dominated by the states near the Fermi level, the charge density will decay as $|\\psi(z)|^2 \\propto (e^{-\\kappa z})^2 = e^{-2\\kappa z}$. Therefore, the decay constant for the charge density, denoted as $\\lambda$, is twice that of the wavefunction amplitude:\n$$ \\lambda = 2\\kappa = 2\\sqrt{\\frac{2m_{\\mathrm{e}}\\Phi}{\\hbar^2}} $$\nThis derived constant $\\lambda$ governs the exponential decay of both the charge density and the spurious energy correction.\n\n**2. Model Formulation for Physical Observables**\n\nWith the decay constant $\\lambda$ established, we formulate the models for the two quantities of interest.\n\n**Charge Density Criterion:**\nFor a symmetric slab with surfaces at $z=0$ and $z=L_{\\mathrm{vac}}$, the total charge density at a point $z$ in the vacuum is the superposition of the contributions from the left and right surfaces. Using the provided characteristic amplitude $\\rho_0$, we model the density as:\n$$ \\rho_{\\mathrm{total}}(z) = \\rho_L(z) + \\rho_R(z) = \\rho_0 e^{-\\lambda z} + \\rho_0 e^{-\\lambda(L_{\\mathrm{vac}}-z)} $$\nAt the mid-vacuum plane, $z = L_{\\mathrm{vac}}/2$, the density is:\n$$ \\rho_{\\mathrm{mid}}(L_{\\mathrm{vac}}) = \\rho_0 e^{-\\lambda L_{\\mathrm{vac}}/2} + \\rho_0 e^{-\\lambda(L_{\\mathrm{vac}}-L_{\\mathrm{vac}}/2)} = 2\\rho_0 e^{-\\lambda L_{\\mathrm{vac}}/2} $$\nThe first criterion requires this density to be no greater than a threshold $\\rho_{\\mathrm{thresh}}$:\n$$ 2\\rho_0 e^{-\\lambda L_{\\mathrm{vac}}/2} \\le \\rho_{\\mathrm{thresh}} $$\n\n**Energy Correction Criterion:**\nThe interaction energy between the two decaying charge distributions is expected to decay exponentially with their separation $L_{\\mathrm{vac}}$. The leading term in this interaction will be proportional to $e^{-\\lambda L_{\\mathrm{vac}}}$. Using the provided prefactor $C$, we model the magnitude of the $L_{\\mathrm{vac}}$-dependent energy correction as:\n$$ |\\Delta E(L_{\\mathrm{vac}})| = C e^{-\\lambda L_{\\mathrm{vac}}} $$\nThe second criterion requires this correction to be no greater than a tolerance $\\delta E$:\n$$ C e^{-\\lambda L_{\\mathrm{vac}}} \\le \\delta E $$\n\n**3. Algorithmic Protocol for Selecting $L_{\\mathrm{vac}}$**\n\nThe protocol finds the minimum value of $L_{\\mathrm{vac}}$ on a discrete grid that simultaneously satisfies both criteria.\n\nThe algorithm is as follows:\n1.  For each test case, obtain the parameters: $\\Phi$, $\\rho_0$, $C$, $\\rho_{\\mathrm{thresh}}$, $\\delta E$, and the grid specifications.\n2.  Calculate the charge density decay constant $\\lambda$. Using physical constants and appropriate unit conversions, the decay constant can be calculated from the work function $\\Phi$ (in eV) as $\\lambda\\; [\\mathrm{\\AA}^{-1}] \\approx 1.0246 \\sqrt{\\Phi\\;[\\mathrm{eV}]}$.\n3.  Generate the discrete grid of $L_{\\mathrm{vac}}$ values.\n4.  Iterate through the $L_{\\mathrm{vac}}$ grid in increasing order. For each value of $L_{\\mathrm{vac}}$:\n    a.  Compute $\\rho_{\\mathrm{mid}}(L_{\\mathrm{vac}}) = 2\\rho_0 e^{-\\lambda L_{\\mathrm{vac}}/2}$.\n    b.  Compute $|\\Delta E(L_{\\mathrm{vac}})| = C e^{-\\lambda L_{\\mathrm{vac}}}$.\n    c.  Check if both $\\rho_{\\mathrm{mid}}(L_{\\mathrm{vac}}) \\le \\rho_{\\mathrm{thresh}}$ and $|\\Delta E(L_{\\mathrm{vac}})| \\le \\delta E$ are true.\n5.  The first $L_{\\mathrm{vac}}$ value that satisfies both conditions is the desired minimal thickness, $L_{\\mathrm{vac}}^{\\ast}$.\n6.  For this $L_{\\mathrm{vac}}^{\\ast}$, record the value of the energy correction $|\\Delta E(L_{\\mathrm{vac}}^{\\ast})|$ and the status of the charge density criterion.\n7.  The numerical results are rounded as specified: $L_{\\mathrm{vac}}^{\\ast}$ to 3 decimal places and $|\\Delta E(L_{\\mathrm{vac}}^{\\ast})|$ to 6 decimal places.\n\nThis protocol is implemented in the provided Python code.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the minimal vacuum spacing in symmetric slab calculations\n    based on charge density and energy correction criteria.\n    \"\"\"\n    \n    # Physical constants for decay constant calculation.\n    # The prefactor combines 2 * sqrt(2 * m_e) / hbar and converts units\n    # such that if the work function Phi is in eV, the resulting decay\n    # constant lambda is in 1/Angstrom.\n    # lambda = (2 * sqrt(2 * m_e * Phi_J)) / hbar_Js  (in 1/m)\n    # Phi_J = Phi_eV * e_charge\n    # lambda [1/A] = lambda [1/m] * 1e-10 m/A\n    # Using more precise values from scipy.constants:\n    # hbar_eVs = 6.582119569e-16 eV*s\n    # m_e_eV = 510998.95000 eV/c^2\n    # Combined prefactor: 2 * sqrt(2 * m_e_eV) / (hbar_eVs * c_light) - gives 1/m\n    # A well-known value derived from these constants:\n    # kappa [A^-1] = 0.5123 * sqrt(Phi [eV])\n    # lambda = 2 * kappa\n    DECAY_PREFACTOR = 1.024634  # Unit: 1 / (Angstrom * sqrt(eV))\n\n    test_cases = [\n        {\n            \"Phi\": 5.4, \"rho0\": 0.05, \"C\": 0.2, \"E_inf\": -123.45,\n            \"rho_thresh\": 1e-5, \"delta_E\": 1e-3,\n            \"lvac_grid\": (5.0, 30.0, 1.0)\n        },\n        {\n            \"Phi\": 3.0, \"rho0\": 0.10, \"C\": 0.3, \"E_inf\": -45.678,\n            \"rho_thresh\": 1e-6, \"delta_E\": 5e-4,\n            \"lvac_grid\": (5.0, 35.0, 1.0)\n        },\n        {\n            \"Phi\": 4.5, \"rho0\": 0.05, \"C\": 0.1, \"E_inf\": -10.0,\n            \"rho_thresh\": 1e-3, \"delta_E\": 1e-2,\n            \"lvac_grid\": (5.0, 20.0, 1.0)\n        },\n        {\n            \"Phi\": 5.5, \"rho0\": 0.05, \"C\": 0.2, \"E_inf\": -200.0,\n            \"rho_thresh\": 1e-8, \"delta_E\": 1e-7,\n            \"lvac_grid\": (5.0, 50.0, 1.0)\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract parameters for the current test case\n        Phi = case[\"Phi\"]\n        rho0 = case[\"rho0\"]\n        C = case[\"C\"]\n        rho_thresh = case[\"rho_thresh\"]\n        delta_E_thresh = case[\"delta_E\"]\n        lvac_start, lvac_stop, lvac_step = case[\"lvac_grid\"]\n\n        # 1. Calculate the charge density decay constant lambda\n        lambda_decay = DECAY_PREFACTOR * np.sqrt(Phi)\n\n        # 2. Generate the L_vac grid\n        # Use a small epsilon to ensure the stop value is included if it's a multiple of the step\n        lvac_grid = np.arange(lvac_start, lvac_stop + lvac_step * 0.5, lvac_step)\n        \n        found_lvac = None\n        \n        # 3. Iterate through the grid to find the minimal L_vac satisfying both criteria\n        for lvac in lvac_grid:\n            # Calculate charge density at mid-vacuum\n            rho_mid = 2 * rho0 * np.exp(-lambda_decay * lvac / 2.0)\n            \n            # Calculate energy correction magnitude\n            delta_E = C * np.exp(-lambda_decay * lvac)\n\n            # Check if both criteria are simultaneously satisfied\n            charge_crit_satisfied = rho_mid = rho_thresh\n            energy_crit_satisfied = delta_E = delta_E_thresh\n            \n            if charge_crit_satisfied and energy_crit_satisfied:\n                found_lvac = lvac\n                final_delta_E = delta_E\n                final_charge_crit_satisfied = charge_crit_satisfied\n                break\n        \n        # Assume a solution is always found on the grid as per problem context\n        if found_lvac is not None:\n             all_results.append([\n                f\"{found_lvac:.3f}\",\n                f\"{final_delta_E:.6f}\",\n                final_charge_crit_satisfied\n            ])\n\n    # Convert list of lists to the required string format\n    # The formatting requires each sublist to be represented as a string\n    results_str = [\n        f\"[{lvac}, {delta_E}, {str(charge_ok).lower()}]\" \n        for lvac, delta_E, charge_ok in all_results\n    ]\n    # In Python 3.9+, bool.__str__ is 'True'/'False'. For older versions this might differ.\n    # The required format is ambiguous about case. Standard JSON uses lowercase 'true'/'false'.\n    # We will output as Python's default, which is 'True'/'False'.\n    # Re-reading format string from prompt: `[L_vac*, Delta E*, boolean]`\n    # Let's adjust to be more robust. Python's print(True) is 'True'. The problem spec has `boolean`.\n    # Let's use Python's default representation for bool.\n    final_output_list = []\n    for lvac, delta_E, charge_ok in all_results:\n        final_output_list.append(f\"[{lvac}, {delta_E}, {charge_ok}]\")\n    print(f\"[{','.join(final_output_list)}]\")\n\n\ndef custom_bool_formatter(b):\n    \"\"\"Converts a Python boolean to a string representation.\"\"\"\n    return str(b)\n\ndef solve_for_print():\n    \"\"\"\n    Refined solver for producing the exact print string as requested.\n    This version avoids potential ambiguities in string conversion.\n    \"\"\"\n    DECAY_PREFACTOR = 1.024634  # Unit: 1 / (Angstrom * sqrt(eV))\n\n    test_cases = [\n        {\"Phi\": 5.4, \"rho0\": 0.05, \"C\": 0.2, \"rho_thresh\": 1e-5, \"delta_E\": 1e-3, \"lvac_grid\": (5.0, 30.0, 1.0)},\n        {\"Phi\": 3.0, \"rho0\": 0.10, \"C\": 0.3, \"rho_thresh\": 1e-6, \"delta_E\": 5e-4, \"lvac_grid\": (5.0, 35.0, 1.0)},\n        {\"Phi\": 4.5, \"rho0\": 0.05, \"C\": 0.1, \"rho_thresh\": 1e-3, \"delta_E\": 1e-2, \"lvac_grid\": (5.0, 20.0, 1.0)},\n        {\"Phi\": 5.5, \"rho0\": 0.05, \"C\": 0.2, \"rho_thresh\": 1e-8, \"delta_E\": 1e-7, \"lvac_grid\": (5.0, 50.0, 1.0)},\n    ]\n\n    results_for_print = []\n    for case in test_cases:\n        Phi, rho0, C, rho_thresh, delta_E_thresh = case[\"Phi\"], case[\"rho0\"], case[\"C\"], case[\"rho_thresh\"], case[\"delta_E\"]\n        lvac_start, lvac_stop, lvac_step = case[\"lvac_grid\"]\n        \n        lambda_decay = DECAY_PREFACTOR * np.sqrt(Phi)\n        lvac_grid = np.arange(lvac_start, lvac_stop + lvac_step * 0.5, lvac_step)\n        \n        found_lvac = None\n        for lvac in lvac_grid:\n            rho_mid = 2 * rho0 * np.exp(-lambda_decay * lvac / 2.0)\n            delta_E = C * np.exp(-lambda_decay * lvac)\n            \n            charge_crit_satisfied = rho_mid = rho_thresh\n            energy_crit_satisfied = delta_E = delta_E_thresh\n            \n            if charge_crit_satisfied and energy_crit_satisfied:\n                found_lvac = lvac\n                final_delta_E = delta_E\n                final_charge_crit_satisfied = charge_crit_satisfied\n                \n                # Format results for this found lvac and append\n                lvac_str = f\"{found_lvac:.3f}\"\n                delta_E_str = f\"{final_delta_E:.6f}\"\n                bool_str = str(final_charge_crit_satisfied)\n                results_for_print.append(f\"[{lvac_str}, {delta_E_str}, {bool_str}]\")\n                break\n    \n    print(f\"[{','.join(results_for_print)}]\")\n\n# Execute the main function.\nsolve_for_print()\n\n```"
        }
    ]
}