{
    "hands_on_practices": [
        {
            "introduction": "Langmuir-Hinshelwood (LH) 模型是多相催化领域描述表面反应的基石。本练习将指导你从基本原理出发，为经典的双分子LH反应推导速率方程和反应级数。通过这项实践，你将掌握将一个假设的反应机理转化为数学模型，并分析其在不同压力和温度条件下动力学行为的核心技能，这是所有动力学研究者的必备能力。",
            "id": "3879681",
            "problem": "考虑一个双组分 Langmuir-Hinshelwood (LH) 机理，用于描述一个涉及两种气相物种 $A$ 和 $B$ 的催化表面反应。这两种物种在同一种类型的表面位点上进行竞争性吸附，并通过一个基元双分子表面反应进行反应。假设以下基元步骤和模型假设成立：(i) $A$ 和 $B$ 的非解离吸附遵循质量作用动力学，(ii) 每种物种的吸附和解吸达到准平衡，具有明确定义的吸附平衡常数，(iii) 每个吸附质占据一个位点且无横向相互作用（理想平均场 Langmuir 模型），(iv) 只有单一类型的均匀表面位点，(v) 位点平衡强制分数覆盖度守恒，以及 (vi) 已吸附的 $A$ 和 $B$ 之间的表面反应是基元的且不可逆的。\n\n你的任务是基于第一性原理，推导并实现产物生成速率相对于分压 $p_A$ 和 $p_B$ 的反应级数。从包含基元表面步骤的质量作用动力学、吸附/解吸的准平衡以及 Langmuir 位点平衡的基本基础出发。不要从任何预先指定的速率表达式开始。使用以下定义和物理关系：\n\n- 吸附平衡由随温度变化的平衡常数 $K_A(T)$ 和 $K_B(T)$ 表征，当压力以 $\\text{bar}$ 为单位时，其单位为 $\\text{bar}^{-1}$。这些常数遵循由参考温度 $T_{\\mathrm{ref}}$ 和吸附焓 $\\Delta H_A$、$\\Delta H_B$（对于放热吸附为负值）参数化的 van’t Hoff 关系：\n$$\nK_i(T) \\;=\\; K_{i,\\mathrm{ref}} \\,\\exp\\!\\left(\\frac{\\Delta H_i}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}}-\\frac{1}{T}\\right)\\right), \\quad i \\in \\{A,B\\}.\n$$\n- 表面反应速率常数 $k_s(T)$ 遵循 Arrhenius 行为，$k_s(T) \\;=\\; k_0 \\exp\\!\\left(-\\frac{E_a}{R T}\\right)$，其中 $k_0$ 是指前因子，$E_a$ 是表面反应的活化能。尽管 $k_s(T)$ 影响速率的大小，但在所述假设下，当对 $p_A$ 和 $p_B$ 求导以获得反应级数时，$k_s(T)$ 对压力依赖性没有贡献。\n- 反应级数定义为速率 $r$ 相对于分压的对数灵敏度：\n$$\nn_A \\;=\\; \\frac{\\partial \\ln r}{\\partial \\ln p_A}, \\qquad\nn_B \\;=\\; \\frac{\\partial \\ln r}{\\partial \\ln p_B}.\n$$\n\n任务：\n1. 从基元步骤、吸附的准平衡以及分数覆盖度的 Langmuir 位点平衡出发，推导已吸附的 $A$ 和 $B$ 的分数覆盖度，用 $p_A$、$p_B$、$K_A(T)$、$K_B(T)$ 和空位点分数来表示。然后，获得已吸附的 $A$ 和 $B$ 之间基元表面反应的速率 $r$，作为这些量的函数。\n2. 从你推导出的 $r$ 中，获得反应级数 $n_A$ 和 $n_B$ 的解析表达式，仅作为 $p_A$、$p_B$、$K_A(T)$ 和 $K_B(T)$ 的函数。\n3. 实现一个程序，使用提供的物理常数和关系式，为下面给出的 $(p_A,p_B,T)$ 值的测试套件计算 $n_A$ 和 $n_B$。程序必须通过 van’t Hoff 关系计算 $K_A(T)$ 和 $K_B(T)$，然后根据你推导的表达式计算 $n_A$ 和 $n_B$。所有分压以 $\\text{bar}$ 表示，所有温度以 $\\text{K}$ 表示。反应级数是无量纲的。报告的每个数字应四舍五入到六位小数。\n常数：\n- $R = 8.314462618 \\;\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$，\n- $T_{\\mathrm{ref}} = 500 \\;\\text{K}$，\n- $K_{A,\\mathrm{ref}} = 2.0 \\;\\text{bar}^{-1}$，\n- $K_{B,\\mathrm{ref}} = 0.2 \\;\\text{bar}^{-1}$，\n- $\\Delta H_A = -40000 \\;\\text{J}\\,\\text{mol}^{-1}$，\n- $\\Delta H_B = -20000 \\;\\text{J}\\,\\text{mol}^{-1}$，\n- $k_0 = 1.0\\times 10^5 \\;\\text{s}^{-1}$ (计算反应级数不需要)，\n- $E_a = 60000 \\;\\text{J}\\,\\text{mol}^{-1}$ (计算反应级数不需要)。\n\n测试套件 (每个元组为 $(p_A,p_B,T)$)：\n- 情况 1：$(0.01,\\,0.01,\\,700)$\n- 情况 2：$(5.0,\\,0.1,\\,500)$\n- 情况 3：$(0.5,\\,40.0,\\,350)$\n- 情况 4：$(20.0,\\,0.0,\\,450)$\n- 情况 5：$(1.0,\\,1.0,\\,300)$\n- 情况 6：$(1.0,\\,1.0,\\,800)$\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个双元素列表 $[n_A,n_B]$，两个数字都四舍五入到六位小数。例如，输出格式必须为：\n$$\n[[n_{A,1},n_{B,1}],[n_{A,2},n_{B,2}],\\ldots,[n_{A,6},n_{B,6}]]\n$$\n列表中不插入空格，并精确地作为单行打印。",
            "solution": "用户在化学工程和多相催化领域提供了一个有效的问题陈述。该问题要求推导并实现一个双组分 Langmuir-Hinshelwood (LH) 催化反应的反应级数表达式。该问题有科学依据，提法恰当，并提供了所有必要的参数。\n\n推导过程按要求从基本原理出发。令 $*$ 表示一个空的表面位点，$A(g)$ 和 $B(g)$ 表示气相反应物，$A*$ 和 $B*$ 表示相应的吸附物种。\n\n**1. 表面覆盖度和反应速率的推导**\n\n该过程的基元步骤如下：\n1. 物种 A 的可逆、非解离吸附： $A(g) + * \\rightleftharpoons A*$\n2. 物种 B 的可逆、非解离吸附： $B(g) + * \\rightleftharpoons B*$\n3. 不可逆的基元表面反应： $A* + B* \\rightarrow \\text{产物} + 2*$\n\n令 $\\theta_A$、$\\theta_B$ 和 $\\theta_v$ 分别为物种 $A$、物种 $B$ 和空位点的表面分数覆盖度。\n\n在吸附的准平衡假设下（步骤 1 和 2），对于每种物种，吸附速率等于解吸速率。对于物种 $A$，这表示为：\n$$r_{ad,A} = r_{des,A}$$\n使用质量作用动力学，其中吸附速率与分压 $p_A$ 和空位点分数 $\\theta_v$ 成正比，而解吸速率与已吸附位点分数 $\\theta_A$ 成正比：\n$$k_{ad,A} p_A \\theta_v = k_{des,A} \\theta_A$$\n重排此式可得 $\\theta_A$ 的表达式：\n$$\\theta_A = \\frac{k_{ad,A}}{k_{des,A}} p_A \\theta_v = K_A(T) p_A \\theta_v$$\n其中 $K_A(T) = k_{ad,A}/k_{des,A}$ 是物种 $A$ 的随温度变化的吸附平衡常数。\n\n对物种 $B$ 进行相同的论证：\n$$\\theta_B = K_B(T) p_B \\theta_v$$\n其中 $K_B(T)$ 是物种 $B$ 的吸附平衡常数。\n\nLangmuir 模型假设总位点数是固定的。位点平衡方程指出，所有分数覆盖度的总和必须为 1：\n$$\\theta_A + \\theta_B + \\theta_v = 1$$\n现在我们可以通过将 $\\theta_A$ 和 $\\theta_B$ 的平衡表达式代入位点平衡方程来求解覆盖度：\n$$K_A(T) p_A \\theta_v + K_B(T) p_B \\theta_v + \\theta_v = 1$$\n提出因子 $\\theta_v$：\n$$\\theta_v(1 + K_A(T) p_A + K_B(T) p_B) = 1$$\n这就得到了空位点分数的表达式：\n$$\\theta_v = \\frac{1}{1 + K_A(T) p_A + K_B(T) p_B}$$\n将这个 $\\theta_v$ 的表达式代回到 $\\theta_A$ 和 $\\theta_B$ 的方程中，我们得到表面覆盖度的最终表达式：\n$$\\theta_A = \\frac{K_A(T) p_A}{1 + K_A(T) p_A + K_B(T) p_B}$$\n$$\\theta_B = \\frac{K_B(T) p_B}{1 + K_A(T) p_A + K_B(T) p_B}$$\n\n表面反应步骤 $A* + B* \\rightarrow \\text{产物}$ 被规定为基元且不可逆的。因此，该反应的速率 $r$ 由应用于表面物种的质量作用定律给出：\n$$r = k_s(T) \\theta_A \\theta_B$$\n其中 $k_s(T)$ 是表面反应速率常数。代入推导出的 $\\theta_A$ 和 $\\theta_B$ 表达式，得到完整的速率定律：\n$$r(p_A, p_B, T) = k_s(T) \\frac{K_A(T) p_A}{(1 + K_A(T) p_A + K_B(T) p_B)} \\frac{K_B(T) p_B}{(1 + K_A(T) p_A + K_B(T) p_B)}$$\n$$r = \\frac{k_s(T) K_A(T) K_B(T) p_A p_B}{(1 + K_A(T) p_A + K_B(T) p_B)^2}$$\n这就是两种竞争性吸附物种之间双分子反应的 Langmuir-Hinshelwood 速率表达式。\n\n**2. 反应级数的推导**\n\n相对于某物种的反应级数定义为速率对其分压的对数导数。对于物种 $A$，反应级数 $n_A$ 是：\n$$n_A = \\frac{\\partial \\ln r}{\\partial \\ln p_A} \\equiv \\frac{p_A}{r} \\frac{\\partial r}{\\partial p_A}$$\n为了推导 $n_A$ 的表达式，我们首先对速率表达式 $r$ 取自然对数：\n$$\\ln r = \\ln(k_s(T) K_A(T) K_B(T)) + \\ln p_A + \\ln p_B - 2 \\ln(1 + K_A(T) p_A + K_B(T) p_B)$$\n现在，我们对 $\\ln r$ 关于 $p_A$ 求导，同时保持 $p_B$ 和 $T$ 不变。项 $k_s(T)$、$K_A(T)$ 和 $K_B(T)$ 相对于压力是常数。\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{\\partial}{\\partial p_A} \\left[ \\ln p_A - 2 \\ln(1 + K_A p_A + K_B p_B) \\right]$$\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{1}{p_A} - 2 \\frac{1}{1 + K_A p_A + K_B p_B} \\frac{\\partial}{\\partial p_A}(1 + K_A p_A + K_B p_B)$$\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{1}{p_A} - \\frac{2 K_A}{1 + K_A p_A + K_B p_B}$$\n使用链式法则定义 $n_A = \\frac{\\partial \\ln r}{\\partial \\ln p_A} = p_A\\frac{\\partial \\ln r}{\\partial p_A}$：\n$$n_A = p_A \\left( \\frac{1}{p_A} - \\frac{2 K_A}{1 + K_A p_A + K_B p_B} \\right)$$\n$$n_A = 1 - \\frac{2 K_A p_A}{1 + K_A p_A + K_B p_B}$$\n这是关于物种 $A$ 的反应级数的最终表达式。\n\n$n_B$ 的推导是对称的：\n$$n_B = \\frac{\\partial \\ln r}{\\partial \\ln p_B}$$\n对 $\\ln r$ 关于 $p_B$ 求导：\n$$\\frac{\\partial (\\ln r)}{\\partial p_B} = \\frac{1}{p_B} - \\frac{2 K_B}{1 + K_A p_A + K_B p_B}$$\n乘以 $p_B$：\n$$n_B = p_B \\left( \\frac{1}{p_B} - \\frac{2 K_B}{1 + K_A p_A + K_B p_B} \\right)$$\n$$n_B = 1 - \\frac{2 K_B p_B}{1 + K_A p_A + K_B p_B}$$\n\n**3. 实现计划**\n推导出的表达式将在一个 Python 程序中实现。该程序将首先定义给定的物理常数。然后，对于每个测试用例 $(p_A, p_B, T)$：\na. 它将使用提供的 van't Hoff 方程计算随温度变化的吸附常数 $K_A(T)$ 和 $K_B(T)$：\n   $$K_i(T) = K_{i,\\mathrm{ref}} \\exp\\left(\\frac{\\Delta H_i}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}}-\\frac{1}{T}\\right)\\right)$$\nb. 然后它将计算分母项 $D = 1 + K_A(T) p_A + K_B(T) p_B$。\nc. 最后，它将计算 $n_A = 1 - 2 K_A(T) p_A / D$ 和 $n_B = 1 - 2 K_B(T) p_B / D$。\nd. 每个测试用例的结果，四舍五入到六位小数，将被收集并格式化为所需的输出字符串。对于反应物分压为零的特殊情况，如测试用例 4 ($p_B=0.0$)，推导出的公式能正确处理，得到 $n_B=1$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes reaction orders for a Langmuir-Hinshelwood mechanism.\n    \"\"\"\n\n    # --- Define Physical Constants ---\n    R = 8.314462618  # J mol^-1 K^-1\n    T_ref = 500.0      # K\n    K_A_ref = 2.0      # bar^-1\n    K_B_ref = 0.2      # bar^-1\n    dH_A = -40000.0    # J mol^-1\n    dH_B = -20000.0    # J mol^-1\n    # k0 and Ea are not needed for reaction order calculation.\n\n    # --- Define Test Suite ---\n    # Each tuple is (p_A [bar], p_B [bar], T [K])\n    test_cases = [\n        (0.01, 0.01, 700.0),\n        (5.0, 0.1, 500.0),\n        (0.5, 40.0, 350.0),\n        (20.0, 0.0, 450.0),\n        (1.0, 1.0, 300.0),\n        (1.0, 1.0, 800.0),\n    ]\n\n    def calculate_K(K_ref, dH, T):\n        \"\"\"\n        Calculates the adsorption equilibrium constant K at temperature T\n        using the van't Hoff relation.\n        \"\"\"\n        if T == 0:\n            # Avoid division by zero; realistically, T > 0K.\n            # As T->0, for exothermic adsorption, K->infinity.\n            return float('inf')\n        \n        exponent = (dH / R) * ((1.0 / T_ref) - (1.0 / T))\n        return K_ref * np.exp(exponent)\n\n    def calculate_orders(p_A, p_B, T):\n        \"\"\"\n        Calculates the reaction orders n_A and n_B.\n        \"\"\"\n        # Calculate temperature-dependent equilibrium constants\n        K_A = calculate_K(K_A_ref, dH_A, T)\n        K_B = calculate_K(K_B_ref, dH_B, T)\n\n        # Calculate the denominator of the rate expression\n        denominator = 1.0 + K_A * p_A + K_B * p_B\n\n        # Calculate reaction orders based on the derived expressions\n        # n_A = 1 - 2 * K_A * p_A / denominator\n        # n_B = 1 - 2 * K_B * p_B / denominator\n        if denominator == 0:\n            # Should not happen under physical conditions\n            return (np.nan, np.nan)\n        \n        n_A = 1.0 - (2.0 * K_A * p_A) / denominator\n        n_B = 1.0 - (2.0 * K_B * p_B) / denominator\n        \n        return n_A, n_B\n\n    results = []\n    for case in test_cases:\n        p_A, p_B, T = case\n        n_A, n_B = calculate_orders(p_A, p_B, T)\n        \n        # Round the results to six decimal places\n        n_A_rounded = round(n_A, 6)\n        n_B_rounded = round(n_B, 6)\n        \n        results.append([n_A_rounded, n_B_rounded])\n\n    # Format the final output string exactly as required\n    # e.g., [[-0.818182,0.909091],[...]]\n    # Using str().replace() is a robust way to remove spaces.\n    final_output = str(results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在构建了动力学模型之后，一个自然而然的问题是：模型中的速率常数 $k$ 从何而来？本练习将引导你超越唯象模型，深入探讨速率常数的物理本质。我们将运用过渡态理论（Transition State Theory, TST）和微观可逆性原理，确保模型的热力学一致性，即正向和逆向速率常数之比必须等于由反应自由能决定的平衡常数。通过这项实践，你将学会如何将微观理论与宏观热力学约束相结合，构建物理上更为严谨的动力学模型。",
            "id": "3879666",
            "problem": "考虑一个多相催化表面的可逆微观动力学模型，其中每个基元步骤都以符合过渡态理论 (Transition State Theory, TST) 的方式进行建模。目的是强制实现热力学一致性，使得正向和逆向速率常数的比值能够重现由标准吉布斯自由能变所隐含的热力学平衡常数。你需要实现一个程序，针对给定的一组基元步骤，计算以秒的倒数 ($\\mathrm{s^{-1}}$) 为单位的正向和逆向速率常数，同时确保这些速率常数的比值能重现每一步的平衡常数。\n\n假设以下基本前提，适用于催化表面上的基元吸附、脱附和表面反应步骤：\n- 平衡状态下的细致平衡原理要求正向和逆向的单向通量相等，这意味着正向和逆向速率常数的比值必须等于从标准吉布斯自由能变计算出的平衡常数。\n- 平衡常数由标准吉布斯自由能变通过一个源于统计力学和经典热力学的、经过充分检验的热力学关系式来定义。\n- 过渡态理论 (Transition State Theory, TST) 提供了一种用活化自由能和普适常数来表达基元步骤速率常数的方法。\n\n你的程序必须为每个测试用例执行以下操作：\n- 使用以 $\\mathrm{K}$ 为单位的绝对温度 $T$、以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的标准吉布斯自由能变 $\\Delta G^\\circ$ 以及以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的正向活化自由能 $\\Delta G^\\ddagger_{\\mathrm{f}}$，在过渡态理论的假设下计算以 $\\mathrm{s^{-1}}$ 为单位的正向和逆向速率常数 $k_{\\mathrm{f}}$ 和 $k_{\\mathrm{r}}$。\n- 为每个基元步骤实现热力学一致性，使得比值 $k_{\\mathrm{f}}/k_{\\mathrm{r}}$ 等于由 $\\Delta G^\\circ$ 所隐含的平衡常数。\n- 使用普适气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$、玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ 和普朗克常数 $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$。在转换能量时，$1\\,\\mathrm{kJ\\,mol^{-1}} = 1000\\,\\mathrm{J\\,mol^{-1}}$。\n- 对于每个测试用例，计算模型的比值 $k_{\\mathrm{f}}/k_{\\mathrm{r}}$ 与由 $\\Delta G^\\circ$ 隐含的平衡常数 $K_{\\mathrm{eq}}$ 之间的绝对相对偏差（无量纲），其定义为 $\\left|\\dfrac{(k_{\\mathrm{f}}/k_{\\mathrm{r}})}{K_{\\mathrm{eq}}} - 1\\right|$。\n\n内部计算的所有速率常数均以 $\\mathrm{s^{-1}}$ 表示。程序的最终输出应为针对所提供测试集的一列无量纲的绝对相对偏差。程序必须打印单行结果，形式为方括号内以逗号分隔的列表。\n\n使用以下参数值测试集，以确保覆盖典型和边缘场景：\n- 用例 1：$T = 600\\,\\mathrm{K}$，$\\Delta G^\\circ = -20\\,\\mathrm{kJ\\,mol^{-1}}$，$\\Delta G^\\ddagger_{\\mathrm{f}} = 80\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 用例 2 (热中性类异构化步骤)：$T = 500\\,\\mathrm{K}$，$\\Delta G^\\circ = 0\\,\\mathrm{kJ\\,mol^{-1}}$，$\\Delta G^\\ddagger_{\\mathrm{f}} = 65\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 用例 3 (高温吸能表面反应)：$T = 1200\\,\\mathrm{K}$，$\\Delta G^\\circ = 50\\,\\mathrm{kJ\\,mol^{-1}}$，$\\Delta G^\\ddagger_{\\mathrm{f}} = 90\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 用例 4 (低温微放能类吸附步骤，视为基元可逆变换)：$T = 250\\,\\mathrm{K}$，$\\Delta G^\\circ = -5\\,\\mathrm{kJ\\,mol^{-1}}$，$\\Delta G^\\ddagger_{\\mathrm{f}} = 35\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 用例 5 (近热中性基元步骤)：$T = 298\\,\\mathrm{K}$，$\\Delta G^\\circ = 1\\,\\mathrm{kJ\\,mol^{-1}}$，$\\Delta G^\\ddagger_{\\mathrm{f}} = 20\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n你的程序应生成单行输出，其中包含方括号内的逗号分隔列表形式的结果（例如，$[\\text{result1},\\text{result2},\\text{result3},\\ldots]$），每个条目是对应测试用例的绝对相对偏差（无量纲），顺序如上所述。",
            "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据、良构且客观，为获得唯一解提供了所有必要信息，没有矛盾或歧义。它描述了计算化学动力学中的一个标准和基本任务：确保微观动力学模型中的速率常数与基元步骤的内在热力学相一致。因此，我们可以进行形式化的求解。\n\n问题的核心在于基元可逆反应的热力学和动力学之间的关系。该关系通过细致平衡原理强制实现，该原理指出，在平衡状态下，每个基元过程的速率都等于其逆过程的速率。对于一个简单的可逆步骤，这意味着正向速率常数 $k_{\\mathrm{f}}$ 与逆向速率常数 $k_{\\mathrm{r}}$ 的比值必须等于热力学平衡常数 $K_{\\mathrm{eq}}$。\n\n$$\n\\frac{k_{\\mathrm{f}}}{k_{\\mathrm{r}}} = K_{\\mathrm{eq}}\n$$\n\n解决方案要求我们使用过渡态理论 (TST) 计算 $k_{\\mathrm{f}}$ 和 $k_{\\mathrm{r}}$，并确保计算方式遵循此条件。\n\n首先，平衡常数 $K_{\\mathrm{eq}}$ 通过基本热力学方程与反应的标准吉布斯自由能变 $\\Delta G^\\circ$ 相关联：\n\n$$\nK_{\\mathrm{eq}} = \\exp\\left(-\\frac{\\Delta G^\\circ}{RT}\\right)\n$$\n\n此处，$R$ 是普适气体常数 ($8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$)，$T$ 是以开尔文为单位的绝对温度。\n\n其次，根据过渡态理论（具体来说是 Eyring 方程），基元步骤的速率常数 $k$ 由下式给出：\n\n$$\nk = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{RT}\\right)\n$$\n\n在此表达式中，$k_{\\mathrm{B}}$ 是玻尔兹曼常数 ($1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$)，$h$ 是普朗克常数 ($6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$)，$\\Delta G^\\ddagger$ 是摩尔活化吉布斯自由能。透射系数假定为 1，这是处理表面基元步骤的常见做法，除非量子隧穿效应显著。指前因子 $\\frac{k_{\\mathrm{B}}T}{h}$ 的单位是 $\\mathrm{s^{-1}}$，与要求的速率常数输出单位一致。\n\n将 TST 表达式应用于正向和逆向反应，我们得到：\n\n$$\nk_{\\mathrm{f}} = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right)\n$$\n\n$$\nk_{\\mathrm{r}} = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{r}}}{RT}\\right)\n$$\n\n其中 $\\Delta G^\\ddagger_{\\mathrm{f}}$ 和 $\\Delta G^\\ddagger_{\\mathrm{r}}$ 分别是正向和逆向的活化自由能。\n\n为强制实现热力学一致性，我们将这些表达式代入细致平衡条件：\n\n$$\n\\frac{k_{\\mathrm{f}}}{k_{\\mathrm{r}}} = \\frac{\\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right)}{\\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{r}}}{RT}\\right)} = \\exp\\left(\\frac{\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right)\n$$\n\n将此式与 $K_{\\mathrm{eq}}$ 的热力学表达式相等：\n\n$$\n\\exp\\left(\\frac{\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right) = \\exp\\left(-\\frac{\\Delta G^\\circ}{RT}\\right)\n$$\n\n对两边取自然对数，我们得到活化能与总反应能之间的关系：\n\n$$\n\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}} = -\\Delta G^\\circ\n$$\n\n这可以重新整理，用给定的正向活化能和吉布斯自由能变来表示逆向活化能：\n\n$$\n\\Delta G^\\ddagger_{\\mathrm{r}} = \\Delta G^\\ddagger_{\\mathrm{f}} - \\Delta G^\\circ\n$$\n\n这个方程是确保热力学一致性的关键。它表明，如果正向活化能和反应能已知，则逆向活化能是唯一确定的。\n\n每个测试用例的计算步骤如下：\n1.  获取输入参数：温度 $T$、标准吉布斯自由能变 $\\Delta G^\\circ$ 和正向活化自由能 $\\Delta G^\\ddagger_{\\mathrm{f}}$。\n2.  将能量值从 $\\mathrm{kJ\\,mol^{-1}}$ 转换为 $\\mathrm{J\\,mol^{-1}}$（乘以 $1000$）。\n3.  计算热力学平衡常数，$K_{\\mathrm{eq}} = \\exp(-\\frac{\\Delta G^\\circ}{RT})$。\n4.  使用 $\\Delta G^\\ddagger_{\\mathrm{f}}$ 通过其 TST 表达式计算正向速率常数 $k_{\\mathrm{f}}$。\n5.  计算逆向活化自由能，$\\Delta G^\\ddagger_{\\mathrm{r}} = \\Delta G^\\ddagger_{\\mathrm{f}} - \\Delta G^\\circ$。\n6.  使用推导出的 $\\Delta G^\\ddagger_{\\mathrm{r}}$ 通过其 TST 表达式计算逆向速率常数 $k_{\\mathrm{r}}$。\n7.  计算所算得的速率常数之比，$(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}} = k_{\\mathrm{f}}/k_{\\mathrm{r}}$。\n8.  最后，计算绝对相对偏差以验证一致性：$\\left|\\dfrac{(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}}}{K_{\\mathrm{eq}}} - 1\\right|$。\n\n根据构造，比值 $(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}}$ 在数学上将与 $K_{\\mathrm{eq}}$ 完全相同：\n$$\n(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}} = \\exp\\left(\\frac{\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right) = \\exp\\left(\\frac{(\\Delta G^\\ddagger_{\\mathrm{f}} - \\Delta G^\\circ) - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right) = \\exp\\left(-\\frac{\\Delta G^\\circ}{RT}\\right) = K_{\\mathrm{eq}}\n$$\n因此，绝对相对偏差应为零，或一个可归因于计算机算术中浮点精度限制的非常小的数。此计算可作为对实现方案的极佳内部一致性检查。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy is not used but is available as per the environment specification.\n\ndef solve():\n    \"\"\"\n    Computes the absolute relative deviation between the kinetic and thermodynamic\n    equilibrium constants for a series of elementary reaction steps.\n    \"\"\"\n    # Define physical constants as provided in the problem statement.\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.314462618\n    # Boltzmann constant in J K^-1\n    k_B = 1.380649e-23\n    # Planck's constant in J s\n    h = 6.62607015e-34\n\n    # The test suite provided in the problem statement.\n    # Each case is a tuple: (T in K, dG_circ in kJ/mol, dGf_act in kJ/mol)\n    test_cases = [\n        (600, -20, 80),   # Case 1\n        (500, 0, 65),     # Case 2\n        (1200, 50, 90),   # Case 3\n        (250, -5, 35),    # Case 4\n        (298, 1, 20),     # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        T, dG_circ_kJ, dGf_act_kJ = case\n\n        # Convert energies from kJ/mol to J/mol for consistency with constants.\n        dG_circ_J = dG_circ_kJ * 1000.0\n        dGf_act_J = dGf_act_kJ * 1000.0\n\n        # 1. Calculate the thermodynamic equilibrium constant, K_eq.\n        # K_eq = exp(-dG_circ / (R * T))\n        K_eq = np.exp(-dG_circ_J / (R * T))\n\n        # 2. Calculate the forward rate constant, k_f, using Transition State Theory.\n        # k_f = (k_B * T / h) * exp(-dGf_act / (R * T))\n        kf = (k_B * T / h) * np.exp(-dGf_act_J / (R * T))\n\n        # 3. Calculate the reverse activation free energy, dGr_act, to enforce\n        #    thermodynamic consistency (dGr_act = dGf_act - dG_circ).\n        dGr_act_J = dGf_act_J - dG_circ_J\n\n        # 4. Calculate the reverse rate constant, k_r, using Transition State Theory.\n        # k_r = (k_B * T / h) * exp(-dGr_act / (R * T))\n        kr = (k_B * T / h) * np.exp(-dGr_act_J / (R * T))\n        \n        # 5. Calculate the ratio of the computed rate constants.\n        kf_kr_ratio = kf / kr\n        \n        # 6. Compute the absolute relative deviation to verify consistency.\n        # The deviation should be zero, barring floating-point inaccuracies.\n        deviation = np.abs(kf_kr_ratio / K_eq - 1.0)\n        \n        results.append(deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "构建并参数化动力学模型后，下一步是进行数值求解。然而，表面反应的动力学模型往往构成一个包含多个时间尺度的常微分方程组（ODEs），这种特性被称为“刚性”（stiffness），给数值积分带来巨大挑战。本练习将聚焦于解决这一实际问题，你将学习如何通过计算系统的雅可比矩阵（Jacobian matrix）并分析其特征值来诊断刚性，并据此选择最高效、最稳定的数值求解器。掌握这项技能对于成功执行准确且高效的动力学模拟至关重要。",
            "id": "3879644",
            "problem": "考虑一个良好混合的等温催化表面，其上只有一种类型的空位，该过程通过 Langmuir–Hinshelwood 机理建模。两种吸附物 $A$ 和 $B$ 进行竞争性吸附、解吸，并发生双分子表面反应生成气相产物 $P$。令 $\\theta_A$ 和 $\\theta_B$ 分别表示 $A$ 和 $B$ 在表面上的分数覆盖率，令 $\\theta_\\star$ 表示空位的分数。位点平衡关系为 $ \\theta_\\star + \\theta_A + \\theta_B = 1$。气相分压为 $p_A$ 和 $p_B$（单位为 $\\mathrm{Pa}$）。基元步骤如下：\n- 吸附：$A(\\mathrm{g}) + \\star \\to A\\star$ 和 $B(\\mathrm{g}) + \\star \\to B\\star$。\n- 解吸：$A\\star \\to A(\\mathrm{g}) + \\star$ 和 $B\\star \\to B(\\mathrm{g}) + \\star$。\n- 表面反应：$A\\star + B\\star \\to P(\\mathrm{g}) + 2\\star$。\n\n假设每个基元步骤的广义质量作用速率如下：\n- $A$ 的吸附：$r_{\\mathrm{ads},A} = k_{\\mathrm{ads},A} \\, p_A \\, \\theta_\\star$。\n- $A$ 的解吸：$r_{\\mathrm{des},A} = k_{\\mathrm{des},A} \\, \\theta_A$。\n- $B$ 的吸附：$r_{\\mathrm{ads},B} = k_{\\mathrm{ads},B} \\, p_B \\, \\theta_\\star$。\n- $B$ 的解吸：$r_{\\mathrm{des},B} = k_{\\mathrm{des},B} \\, \\theta_B$。\n- 表面反应：$r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B$。\n\n此处，$k_{\\mathrm{ads},A}$ 和 $k_{\\mathrm{ads},B}$ 的单位为 $\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$，而 $k_{\\mathrm{des},A}$、$k_{\\mathrm{des},B}$ 和 $k_{\\mathrm{rxn}}$ 的单位为 $\\mathrm{s}^{-1}$。覆盖率的控制性常微分方程 (ODEs) 为\n$$\n\\frac{d\\theta_A}{dt} = r_{\\mathrm{ads},A} - r_{\\mathrm{des},A} - r_{\\mathrm{rxn}}, \\quad\n\\frac{d\\theta_B}{dt} = r_{\\mathrm{ads},B} - r_{\\mathrm{des},B} - r_{\\mathrm{rxn}},\n$$\n其中 $\\theta_\\star = 1 - \\theta_A - \\theta_B$。\n\n在给定状态 $(\\theta_A,\\theta_B)$ 和参数 $(p_A,p_B,k_{\\mathrm{ads},A},k_{\\mathrm{des},A},k_{\\mathrm{ads},B},k_{\\mathrm{des},B},k_{\\mathrm{rxn}})$ 下，构建该动力学系统的 $2\\times 2$ 雅可比矩阵 $J(\\theta_A,\\theta_B)$，其元素为\n$$\nJ_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}, \\quad \n\\text{where } \\mathbf{f}(\\theta_A,\\theta_B) = \\begin{bmatrix} d\\theta_A/dt \\\\ d\\theta_B/dt \\end{bmatrix}.\n$$\n使用 $J$ 的特征值分析来识别刚性，并提出一种高效的数值积分策略。定义刚性比\n$$\n\\kappa = \\frac{\\max\\{|\\lambda_1|,|\\lambda_2|\\}}{\\min\\{|\\lambda_1|,|\\lambda_2|\\}}, \n$$\n其中 $\\lambda_1,\\lambda_2$ 是 $J$ 的特征值，而 $|\\cdot|$ 表示复数的模。如果最小模小于 $10^{-12}$，则在计算 $\\kappa$ 时将其视为 $10^{-12}$。如果 $\\kappa  100$，则将系统分类为刚性（布尔值输出）。根据以下规则选择方法代码，提出数值策略：\n- $0$ 用于非刚性区域（推荐使用显式龙格－库塔方法，如 $RK45$），\n- $2$ 用于中等刚性区域（$100  \\kappa \\leq 1000$，推荐使用隐式龙格－库塔方法，如 $Radau$），\n- $1$ 用于非常刚性的区域（$\\kappa  1000$，推荐使用隐式多步法，如 $BDF$）。\n\n此外，基于谱半径 $\\rho = \\max\\{|\\lambda_1|,|\\lambda_2|\\}$，计算一个用于线性稳定性的保守显式步长建议值（单位为秒）：\n$$\n\\Delta t_{\\mathrm{safe}} = \\frac{\\alpha}{\\rho},\n$$\n其中，如果非刚性（$\\kappa \\leq 100$），则 $\\alpha = 0.2$；如果中等刚性（$100  \\kappa \\leq 1000$），则 $\\alpha = 0.05$；如果非常刚性（$\\kappa  1000$），则 $\\alpha = 0.01$。如果 $\\rho = 0$，则设 $\\Delta t_{\\mathrm{safe}} = 1.0$。\n\n对于下方的每个测试用例，在指定的初始覆盖率下计算雅可比矩阵并执行特征值分析。以 $\\mathrm{s}$ 为单位表示 $\\Delta t_{\\mathrm{safe}}$。\n\n测试套件（每个元组对应于 $(p_A, p_B, k_{\\mathrm{ads},A}, k_{\\mathrm{des},A}, k_{\\mathrm{ads},B}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}, \\theta_A^0, \\theta_B^0)$）：\n1. $(10{,}000, 5{,}000, 1\\times 10^{-4}, 1\\times 10^{-2}, 2\\times 10^{-4}, 5\\times 10^{-3}, 5\\times 10^{-1}, 0.10, 0.10)$\n2. $(20{,}000, 20{,}000, 5\\times 10^{-5}, 1\\times 10^{-2}, 5\\times 10^{-5}, 1\\times 10^{-2}, 1\\times 10^{4}, 0.30, 0.30)$\n3. $(50{,}000, 40{,}000, 1\\times 10^{-4}, 5\\times 10^{-2}, 2\\times 10^{-4}, 1\\times 10^{-2}, 1\\times 10^{-1}, 0.90, 0.09)$\n4. $(100, 100, 1\\times 10^{-5}, 1\\times 10^{-3}, 1\\times 10^{-5}, 1\\times 10^{-3}, 0, 0.01, 0.01)$\n\n您的程序必须对每个测试用例按给定顺序计算并输出以下四个值：刚性比 $\\kappa$（浮点数），刚性分类（布尔值），推荐的方法代码（整数），以及建议的显式稳定步长 $\\Delta t_{\\mathrm{safe}}$（浮点数，单位为秒）。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。总输出列表应该是每个测试用例的四个值按顺序串联而成，形成一个长度为 $16$ 的单一扁平列表。",
            "solution": "对用户提供的问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **模型框架**：一个由 Langmuir–Hinshelwood 机理描述的良好混合的等温催化表面，涉及两种物质 $A$ 和 $B$ 的竞争性吸附。\n- **状态变量**：分数表面覆盖率 $\\theta_A$ 和 $\\theta_B$。\n- **位点平衡约束**：$\\theta_\\star = 1 - \\theta_A - \\theta_B$，其中 $\\theta_\\star$ 是空位的分数。\n- **系统输入**：分压 $p_A$ 和 $p_B$，单位为 $\\mathrm{Pa}$。\n- **基元步骤和速率定律**：\n    - 吸附 ($A$)：$r_{\\mathrm{ads},A} = k_{\\mathrm{ads},A} \\, p_A \\, \\theta_\\star$。\n    - 解吸 ($A$)：$r_{\\mathrm{des},A} = k_{\\mathrm{des},A} \\, \\theta_A$。\n    - 吸附 ($B$)：$r_{\\mathrm{ads},B} = k_{\\mathrm{ads},B} \\, p_B \\, \\theta_\\star$。\n    - 解吸 ($B$)：$r_{\\mathrm{des},B} = k_{\\mathrm{des},B} \\, \\theta_B$。\n    - 表面反应 ($A\\star + B\\star$)：$r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B$。\n- **速率常数**：$k_{\\mathrm{ads},A}, k_{\\mathrm{ads},B}$ 的单位为 $\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$；$k_{\\mathrm{des},A}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}$ 的单位为 $\\mathrm{s}^{-1}$。\n- **控制性 ODEs**：覆盖率的时间演化由向量函数 $\\mathbf{f}(\\theta_A, \\theta_B) = [f_1, f_2]^T$ 给出，其中：\n    $$f_1 = \\frac{d\\theta_A}{dt} = r_{\\mathrm{ads},A} - r_{\\mathrm{des},A} - r_{\\mathrm{rxn}}$$\n    $$f_2 = \\frac{d\\theta_B}{dt} = r_{\\mathrm{ads},B} - r_{\\mathrm{des},B} - r_{\\mathrm{rxn}}$$\n- **雅可比矩阵**：$J_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}$，对于 $i,j \\in \\{1,2\\}$，其中 $\\theta_1=\\theta_A$ 且 $\\theta_2=\\theta_B$。\n- **刚性比 ($\\kappa$)**：$\\kappa = \\frac{\\max\\{|\\lambda_1|,|\\lambda_2|\\}}{\\min\\{|\\lambda_1|,|\\lambda_2|\\}}$，其中 $\\lambda_1, \\lambda_2$ 是 $J$ 的特征值。如果 $\\min\\{|\\lambda_i|\\}  10^{-12}$，则其下限取为 $10^{-12}$。\n- **刚性分类**：如果 $\\kappa  100$，则系统是刚性的。\n- **数值方法代码**：$0$ 表示非刚性 ($\\kappa \\leq 100$)，$2$ 表示中等刚性 ($100  \\kappa \\leq 1000$)，$1$ 表示非常刚性 ($\\kappa  1000$)。\n- **安全步长 ($\\Delta t_{\\mathrm{safe}}$)**：$\\Delta t_{\\mathrm{safe}} = \\frac{\\alpha}{\\rho}$，其中 $\\rho$ 是 $J$ 的谱半径。对于非刚性、中等刚性或非常刚性的系统，$\\alpha$ 分别为 $0.2$、$0.05$ 或 $0.01$。如果 $\\rho = 0$，则 $\\Delta t_{\\mathrm{safe}} = 1.0\\,\\mathrm{s}$。\n- **任务**：对于一组测试用例，在给定的初始覆盖率下计算 $\\kappa$、刚性布尔值、方法代码和 $\\Delta t_{\\mathrm{safe}}$。\n- **测试套件**：提供了四组参数 $(p_A, p_B, k_{\\mathrm{ads},A}, k_{\\mathrm{des},A}, k_{\\mathrm{ads},B}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}, \\theta_A^0, \\theta_B^0)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于成熟的 Langmuir-Hinshelwood 表面动力学模型，这是催化领域的一个基本概念。通过雅可比矩阵特征值分析系统刚性是常微分方程 (ODEs) 数值求解中的标准严谨方法，尤其是在化学动力学中。该问题在化学和数学上是合理的。\n- **适定性**：问题是完全指定的。所有必要的常数、初始条件和函数形式都已提供。刚性、方法代码和步长的定义明确，可以为每个测试用例计算出唯一的解。\n- **客观性**：问题使用精确、客观的数学语言陈述。分类标准是定量的，没有主观解释的余地。\n- **结论**：该问题不违反任何无效标准。它具有科学依据、适定、客观且完整。\n\n### 步骤 3：结论与行动\n该问题被判定为有效。将提供一个解决方案。\n\n### 基于原理的解决方案\n解决方案要求在状态空间 $(\\theta_A, \\theta_B)$ 的特定点上分析给定 ODE 系统的局部稳定性和刚性。此分析使用系统的雅可比矩阵进行。\n\n**1. ODE 系统的公式化**\n\n首先，我们通过将位点平衡方程 $\\theta_\\star = 1 - \\theta_A - \\theta_B$ 代入速率定律，将覆盖率的变化率 $f_1 = d\\theta_A/dt$ 和 $f_2 = d\\theta_B/dt$ 明确地表示为状态变量 $\\theta_A$ 和 $\\theta_B$ 的函数：\n$$\nf_1(\\theta_A, \\theta_B) = k_{\\mathrm{ads},A} \\, p_A \\, (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\, \\theta_A - k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B\n$$\n$$\nf_2(\\theta_A, \\theta_B) = k_{\\mathrm{ads},B} \\, p_B \\, (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\, \\theta_B - k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B\n$$\n\n**2. 雅可比矩阵的推导**\n\n雅可比矩阵 $J$ 将系统动力学在点 $(\\theta_A, \\theta_B)$ 附近线性化。其元素 $J_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}$ 表征了一个覆盖率的微小扰动如何影响另一个覆盖率的变化率。自变量为 $\\theta_1 \\equiv \\theta_A$ 和 $\\theta_2 \\equiv \\theta_B$。\n\n四个偏导数计算如下：\n- **$J_{11} = \\frac{\\partial f_1}{\\partial \\theta_A}$**：\n  $$\n  \\frac{\\partial}{\\partial \\theta_A} \\left( k_{\\mathrm{ads},A} p_A (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\theta_A - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{des},A} - k_{\\mathrm{rxn}} \\theta_B\n  $$\n- **$J_{12} = \\frac{\\partial f_1}{\\partial \\theta_B}$**：\n  $$\n  \\frac{\\partial}{\\partial \\theta_B} \\left( k_{\\mathrm{ads},A} p_A (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\theta_A - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{rxn}} \\theta_A\n  $$\n- **$J_{21} = \\frac{\\partial f_2}{\\partial \\theta_A}$**：\n  $$\n  \\frac{\\partial}{\\partial \\theta_A} \\left( k_{\\mathrm{ads},B} p_B (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\theta_B - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{rxn}} \\theta_B\n  $$\n- **$J_{22} = \\frac{\\partial f_2}{\\partial \\theta_B}$**：\n  $$\n  \\frac{\\partial}{\\partial \\theta_B} \\left( k_{\\mathrm{ads},B} p_B (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\theta_B - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{des},B} - k_{\\mathrm{rxn}} \\theta_A\n  $$\n因此，雅可比矩阵为：\n$$\nJ(\\theta_A, \\theta_B) = \\begin{bmatrix}\n-k_{\\mathrm{ads},A} p_A - k_{\\mathrm{des},A} - k_{\\mathrm{rxn}} \\theta_B  -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{rxn}} \\theta_A \\\\\n-k_{\\mathrm{ads},B} p_B - k_{\\mathrm{rxn}} \\theta_B  -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{des},B} - k_{\\mathrm{rxn}} \\theta_A\n\\end{bmatrix}\n$$\n\n**3. 特征值分析与刚性表征**\n\n雅可比矩阵的特征值 $\\lambda$ 决定了系统对扰动响应的特征时间尺度。对于稳定系统，特征值的实部为负，其大小 $|\\mathrm{Re}(\\lambda)|$ 是弛豫时间尺度的倒数。\n\n- **刚性**：如果一个系统的特征时间尺度相差悬殊，则该系统在数值上是刚性的。这可以通过刚性比 $\\kappa$ 来量化，定义为最大特征值模与最小特征值模之比。\n  $$\n  \\kappa = \\frac{\\max\\{|\\lambda_1|, |\\lambda_2|\\}}{\\min\\{|\\lambda_1|, |\\lambda_2|\\}}\n  $$\n  大的 $\\kappa$ 值表示刚性，这意味着显式数值积分器将被最快的过程（最大的 $|\\lambda|$）迫使采用极小的时间步长，以便在最慢过程（最小的 $|\\lambda|$）的时间尺度上求解系统，从而导致效率低下。\n- **数值策略**：ODE 求解器的选择取决于此刚性分类。非刚性问题可以用显式方法（例如，Runge-Kutta $45$）高效求解，而刚性问题则需要隐式方法（例如，BDF, Radau）以在合理的步长下保持稳定性。\n- **显式步长限制**：对于显式方法，时间步长 $\\Delta t$ 受该方法的稳定区域限制，该区域与谱半径 $\\rho = \\max\\{|\\lambda_i|\\}$ 成反比。问题提供了一个保守的“安全”步长公式，$\\Delta t_{\\mathrm{safe}} = \\alpha / \\rho$，其中 $\\alpha$ 是一个安全因子，随着刚性的增加而减小。\n\n**4. 计算算法**\n\n对每个测试用例，执行以下步骤：\n1.  将给定参数 $(p_A, p_B, k_{\\dots}, \\theta_A^0, \\theta_B^0)$ 代入推导出的雅可比矩阵元素 $J_{11}, J_{12}, J_{21}, J_{22}$ 的表达式中。\n2.  构造 $2 \\times 2$ 的数值雅可比矩阵。\n3.  计算其两个特征值 $\\lambda_1$ 和 $\\lambda_2$。\n4.  计算特征值的复模 $|\\lambda_1|$ 和 $|\\lambda_2|$。\n5.  确定 $\\lambda_{\\max} = \\max\\{|\\lambda_1|, |\\lambda_2|\\}$ 和 $\\lambda_{\\min} = \\min\\{|\\lambda_1|, |\\lambda_2|\\}$。\n6.  计算刚性比 $\\kappa = \\lambda_{\\max} / \\max(\\lambda_{\\min}, 10^{-12})$。\n7.  根据 $\\kappa$ 的值对系统进行分类并确定方法代码。\n8.  根据分类确定因子 $\\alpha$。\n9.  计算安全步长 $\\Delta t_{\\mathrm{safe}} = \\alpha / \\lambda_{\\max}$（使用 $\\rho = \\lambda_{\\max}$），并处理 $\\rho=0$ 的情况。\n10. 整理四个结果值：$\\kappa$（浮点数）、刚性（布尔值）、方法代码（整数）和 $\\Delta t_{\\mathrm{safe}}$（浮点数）。\n\n此过程在提供的 Python 代码中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stiffness of a surface reaction kinetic system for several test cases.\n    For each case, it computes the Jacobian matrix, its eigenvalues, the stiffness ratio,\n    a stiffness classification, a recommended numerical method, and a safe explicit step size.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (p_A, p_B, k_ads_A, k_des_A, k_ads_B, k_des_B, k_rxn, theta_A_initial, theta_B_initial)\n    test_cases = [\n        (10000.0, 5000.0, 1.0e-4, 1.0e-2, 2.0e-4, 5.0e-3, 5.0e-1, 0.10, 0.10),\n        (20000.0, 20000.0, 5.0e-5, 1.0e-2, 5.0e-5, 1.0e-2, 1.0e4, 0.30, 0.30),\n        (50000.0, 40000.0, 1.0e-4, 5.0e-2, 2.0e-4, 1.0e-2, 1.0e-1, 0.90, 0.09),\n        (100.0, 100.0, 1.0e-5, 1.0e-3, 1.0e-5, 1.0e-3, 0.0, 0.01, 0.01)\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        p_A, p_B, k_ads_A, k_des_A, k_ads_B, k_des_B, k_rxn, theta_A, theta_B = case\n\n        # Construct the Jacobian matrix J(theta_A, theta_B) based on the derived analytical expressions.\n        # J_ij = d(f_i)/d(theta_j), where f = [d(theta_A)/dt, d(theta_B)/dt]\n        J11 = -k_ads_A * p_A - k_des_A - k_rxn * theta_B\n        J12 = -k_ads_A * p_A - k_rxn * theta_A\n        J21 = -k_ads_B * p_B - k_rxn * theta_B\n        J22 = -k_ads_B * p_B - k_des_B - k_rxn * theta_A\n        \n        J = np.array([[J11, J12], [J21, J22]])\n        \n        # Compute the eigenvalues of the Jacobian matrix.\n        eigenvalues = np.linalg.eigvals(J)\n        \n        # Calculate the moduli (absolute values) of the eigenvalues.\n        lambda_moduli = np.abs(eigenvalues)\n        \n        # Get the maximum and minimum modulus.\n        lambda_max_mod = np.max(lambda_moduli)\n        lambda_min_mod = np.min(lambda_moduli)\n        \n        # Calculate the stiffness ratio kappa.\n        # Apply the floor of 1e-12 to the minimum modulus as per the problem statement.\n        kappa_denominator = max(lambda_min_mod, 1e-12)\n        kappa = lambda_max_mod / kappa_denominator\n        \n        # Determine stiffness classification and recommend the numerical method code.\n        is_stiff = kappa > 100.0\n        \n        if kappa = 100.0:\n            # Non-stiff regime\n            method_code = 0\n            alpha = 0.2\n        elif kappa = 1000.0:\n            # Moderately stiff regime\n            method_code = 2\n            alpha = 0.05\n        else:  # kappa > 1000.0\n            # Very stiff regime\n            method_code = 1\n            alpha = 0.01\n            \n        # Calculate the conservative explicit step size suggestion.\n        # Spectral radius rho is the maximum eigenvalue modulus.\n        rho = lambda_max_mod\n        \n        # Handle the special case where the spectral radius is zero.\n        if rho == 0.0:\n            delta_t_safe = 1.0\n        else:\n            delta_t_safe = alpha / rho\n            \n        # Append the four computed values for this test case to the results list.\n        all_results.extend([kappa, is_stiff, method_code, delta_t_safe])\n        \n    # Print the final flattened list of results in the required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}