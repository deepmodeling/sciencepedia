{
    "hands_on_practices": [
        {
            "introduction": "The Langmuir-Hinshelwood (LH) mechanism is a cornerstone for describing reactions on catalytic surfaces. This practice guides you through deriving the LH rate law from elementary steps, providing a foundational skill in kinetic modeling. By subsequently deriving expressions for the apparent reaction orders , you will gain insight into how the reaction rate's sensitivity to reactant pressures shifts with temperature and surface coverage.",
            "id": "3879681",
            "problem": "Consider a binary Langmuir-Hinshelwood (LH) mechanism for a catalytic surface reaction involving two gas-phase species $A$ and $B$ that adsorb competitively on the same type of surface site and react via an elementary bimolecular surface reaction. Assume the following elementary steps and modeling assumptions hold: (i) non-dissociative adsorption of $A$ and $B$ obeys mass-action kinetics, (ii) adsorption and desorption of each species reach quasi-equilibrium with well-defined adsorption equilibrium constants, (iii) one site per adsorbate and no lateral interactions (ideal mean-field Langmuir model), (iv) a single type of uniform surface site, (v) the site balance enforces conservation of fractional coverage, and (vi) the surface reaction between adsorbed $A$ and $B$ is elementary and irreversible.\n\nYou are to derive and implement the reaction orders with respect to the partial pressures $p_A$ and $p_B$ for the rate of product formation, based on first principles. Start from the fundamental base consisting of mass-action kinetics for elementary surface steps, quasi-equilibrium for adsorption/desorption, and the Langmuir site balance. Do not begin from any pre-specified rate expression. Use the following definitions and physical relations:\n\n- The adsorption equilibria are characterized by temperature-dependent equilibrium constants $K_A(T)$ and $K_B(T)$ with units of $\\text{bar}^{-1}$ when pressure is measured in $\\text{bar}$. These obey the van’t Hoff relation parameterized by a reference temperature $T_{\\mathrm{ref}}$ and adsorption enthalpies $\\Delta H_A$ and $\\Delta H_B$ (negative for exothermic adsorption):\n$$\nK_i(T) \\;=\\; K_{i,\\mathrm{ref}} \\,\\exp\\!\\left(\\frac{\\Delta H_i}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}}-\\frac{1}{T}\\right)\\right), \\quad i \\in \\{A,B\\}.\n$$\n- The surface reaction rate constant $k_s(T)$ obeys Arrhenius behavior, $k_s(T) \\;=\\; k_0 \\exp\\!\\left(-\\frac{E_a}{R T}\\right)$, with $k_0$ the pre-exponential factor and $E_a$ the activation energy of the surface reaction. Although $k_s(T)$ affects the magnitude of the rate, when differentiating with respect to $p_A$ and $p_B$ to obtain reaction orders, $k_s(T)$ does not contribute to the pressure dependence under the stated assumptions.\n- The reaction orders are defined as the logarithmic sensitivities of the rate $r$ with respect to the partial pressures:\n$$\nn_A \\;=\\; \\frac{\\partial \\ln r}{\\partial \\ln p_A}, \\qquad\nn_B \\;=\\; \\frac{\\partial \\ln r}{\\partial \\ln p_B}.\n$$\n\nTasks:\n1. From the elementary steps, quasi-equilibrium of adsorption, and the Langmuir site balance for fractional coverages, derive the fractional coverages of adsorbed $A$ and $B$ in terms of $p_A$, $p_B$, $K_A(T)$, $K_B(T)$, and the fraction of empty sites. Then obtain the rate $r$ of the elementary surface reaction between adsorbed $A$ and $B$ as a function of these quantities.\n2. From your derived $r$, obtain closed-form expressions for the reaction orders $n_A$ and $n_B$ as functions of $p_A$, $p_B$, $K_A(T)$, and $K_B(T)$ only.\n3. Implement a program that computes $n_A$ and $n_B$ for the following test suite of $(p_A,p_B,T)$ values, using the provided physical constants and relations. The program must evaluate $K_A(T)$ and $K_B(T)$ via the van’t Hoff relation and then compute $n_A$ and $n_B$ from your derived expressions. Express all partial pressures in $\\text{bar}$ and all temperatures in $\\text{K}$. Reaction orders are dimensionless. Each reported number should be rounded to six decimal places.\nConstants:\n- $R = 8.314462618 \\;\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$,\n- $T_{\\mathrm{ref}} = 500 \\;\\text{K}$,\n- $K_{A,\\mathrm{ref}} = 2.0 \\;\\text{bar}^{-1}$,\n- $K_{B,\\mathrm{ref}} = 0.2 \\;\\text{bar}^{-1}$,\n- $\\Delta H_A = -40000 \\;\\text{J}\\,\\text{mol}^{-1}$,\n- $\\Delta H_B = -20000 \\;\\text{J}\\,\\text{mol}^{-1}$,\n- $k_0 = 1.0\\times 10^5 \\;\\text{s}^{-1}$ (not needed for reaction orders),\n- $E_a = 60000 \\;\\text{J}\\,\\text{mol}^{-1}$ (not needed for reaction orders).\n\nTest suite (each tuple is $(p_A,p_B,T)$):\n- Case $1$: $(0.01,\\,0.01,\\,700)$\n- Case $2$: $(5.0,\\,0.1,\\,500)$\n- Case $3$: $(0.5,\\,40.0,\\,350)$\n- Case $4$: $(20.0,\\,0.0,\\,450)$\n- Case $5$: $(1.0,\\,1.0,\\,300)$\n- Case $6$: $(1.0,\\,1.0,\\,800)$\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a two-element list $[n_A,n_B]$ with both numbers rounded to six decimal places. For example, the output format must be\n$$\n[[n_{A,1},n_{B,1}],[n_{A,2},n_{B,2}],\\ldots,[n_{A,6},n_{B,6}]]\n$$\nwith no spaces inserted in the lists, printed exactly as a single line.",
            "solution": "The user has provided a valid problem statement in the domain of chemical engineering and heterogeneous catalysis. The problem asks for the derivation and implementation of expressions for the reaction orders of a binary Langmuir-Hinshelwood (LH) catalytic reaction. The problem is scientifically grounded, well-posed, and all necessary parameters are provided.\n\nThe derivation proceeds from fundamental principles as requested. Let $\\star$ denote a vacant surface site, $A(g)$ and $B(g)$ the gas-phase reactants, and $A\\star$ and $B\\star$ the corresponding adsorbed species.\n\n**1. Derivation of Surface Coverages and Reaction Rate**\n\nThe elementary steps for the process are:\n1.  Reversible, non-dissociative adsorption of species $A$: $A(g) + \\star \\rightleftharpoons A\\star$\n2.  Reversible, non-dissociative adsorption of species $B$: $B(g) + \\star \\rightleftharpoons B\\star$\n3.  Irreversible, elementary surface reaction: $A\\star + B\\star \\rightarrow \\text{Products} + 2\\star$\n\nLet $\\theta_A$, $\\theta_B$, and $\\theta_v$ be the fractional surface coverages of species $A$, species $B$, and vacant sites, respectively.\n\nUnder the quasi-equilibrium assumption for adsorption (steps 1 and 2), the rate of adsorption equals the rate of desorption for each species. For species $A$, this is expressed as:\n$$r_{ad,A} = r_{des,A}$$\nUsing mass-action kinetics, where the rate of adsorption is proportional to the partial pressure $p_A$ and the fraction of vacant sites $\\theta_v$, and the rate of desorption is proportional to the fraction of adsorbed sites $\\theta_A$:\n$$k_{ad,A} p_A \\theta_v = k_{des,A} \\theta_A$$\nRearranging this gives an expression for $\\theta_A$:\n$$\\theta_A = \\frac{k_{ad,A}}{k_{des,A}} p_A \\theta_v = K_A(T) p_A \\theta_v$$\nwhere $K_A(T) = k_{ad,A}/k_{des,A}$ is the temperature-dependent adsorption equilibrium constant for species $A$.\n\nBy an identical argument for species $B$:\n$$\\theta_B = K_B(T) p_B \\theta_v$$\nwhere $K_B(T)$ is the adsorption equilibrium constant for species $B$.\n\nThe Langmuir model assumes a fixed number of total sites. The site balance equation states that the sum of all fractional coverages must be unity:\n$$\\theta_A + \\theta_B + \\theta_v = 1$$\nWe can now solve for the coverages by substituting the equilibrium expressions for $\\theta_A$ and $\\theta_B$ into the site balance equation:\n$$K_A(T) p_A \\theta_v + K_B(T) p_B \\theta_v + \\theta_v = 1$$\nFactoring out $\\theta_v$:\n$$\\theta_v(1 + K_A(T) p_A + K_B(T) p_B) = 1$$\nThis yields the expression for the fraction of vacant sites:\n$$\\theta_v = \\frac{1}{1 + K_A(T) p_A + K_B(T) p_B}$$\nSubstituting this expression for $\\theta_v$ back into the equations for $\\theta_A$ and $\\theta_B$, we obtain the final expressions for the surface coverages:\n$$\\theta_A = \\frac{K_A(T) p_A}{1 + K_A(T) p_A + K_B(T) p_B}$$\n$$\\theta_B = \\frac{K_B(T) p_B}{1 + K_A(T) p_A + K_B(T) p_B}$$\n\nThe surface reaction step, $A\\star + B\\star \\rightarrow \\text{Products}$, is stated to be elementary and irreversible. The rate of this reaction, $r$, is therefore given by the law of mass action applied to the surface species:\n$$r = k_s(T) \\theta_A \\theta_B$$\nwhere $k_s(T)$ is the surface reaction rate constant. Substituting the derived expressions for $\\theta_A$ and $\\theta_B$ gives the full rate law:\n$$r(p_A, p_B, T) = k_s(T) \\frac{K_A(T) p_A}{(1 + K_A(T) p_A + K_B(T) p_B)} \\frac{K_B(T) p_B}{(1 + K_A(T) p_A + K_B(T) p_B)}$$\n$$r = \\frac{k_s(T) K_A(T) K_B(T) p_A p_B}{(1 + K_A(T) p_A + K_B(T) p_B)^2}$$\nThis is the Langmuir-Hinshelwood rate expression for a bimolecular reaction between two competitively adsorbed species.\n\n**2. Derivation of Reaction Orders**\n\nThe reaction order with respect to a species is defined as the logarithmic derivative of the rate with respect to its partial pressure. For species $A$, the reaction order $n_A$ is:\n$$n_A = \\frac{\\partial \\ln r}{\\partial \\ln p_A} \\equiv \\frac{p_A}{r} \\frac{\\partial r}{\\partial p_A}$$\nTo derive the expression for $n_A$, we first take the natural logarithm of the rate expression $r$:\n$$\\ln r = \\ln(k_s(T) K_A(T) K_B(T)) + \\ln p_A + \\ln p_B - 2 \\ln(1 + K_A(T) p_A + K_B(T) p_B)$$\nNow, we differentiate $\\ln r$ with respect to $p_A$, holding $p_B$ and $T$ constant. The terms $k_s(T)$, $K_A(T)$, and $K_B(T)$ are constant with respect to pressure.\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{\\partial}{\\partial p_A} \\left[ \\ln p_A - 2 \\ln(1 + K_A p_A + K_B p_B) \\right]$$\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{1}{p_A} - 2 \\frac{1}{1 + K_A p_A + K_B p_B} \\frac{\\partial}{\\partial p_A}(1 + K_A p_A + K_B p_B)$$\n$$\\frac{\\partial (\\ln r)}{\\partial p_A} = \\frac{1}{p_A} - \\frac{2 K_A}{1 + K_A p_A + K_B p_B}$$\nUsing the chain rule definition $n_A = \\frac{\\partial \\ln r}{\\partial \\ln p_A} = p_A\\frac{\\partial \\ln r}{\\partial p_A}$:\n$$n_A = p_A \\left( \\frac{1}{p_A} - \\frac{2 K_A}{1 + K_A p_A + K_B p_B} \\right)$$\n$$n_A = 1 - \\frac{2 K_A p_A}{1 + K_A p_A + K_B p_B}$$\nThis is the final expression for the reaction order with respect to species $A$.\n\nThe derivation for $n_B$ is symmetrical:\n$$n_B = \\frac{\\partial \\ln r}{\\partial \\ln p_B}$$\nDifferentiating $\\ln r$ with respect to $p_B$:\n$$\\frac{\\partial (\\ln r)}{\\partial p_B} = \\frac{1}{p_B} - \\frac{2 K_B}{1 + K_A p_A + K_B p_B}$$\nMultiplying by $p_B$:\n$$n_B = p_B \\left( \\frac{1}{p_B} - \\frac{2 K_B}{1 + K_A p_A + K_B p_B} \\right)$$\n$$n_B = 1 - \\frac{2 K_B p_B}{1 + K_A p_A + K_B p_B}$$\n\n**3. Implementation Plan**\nThe derived expressions will be implemented in a Python program. The program will first define the given physical constants. Then, for each test case $(p_A, p_B, T)$:\na. It will compute the temperature-dependent adsorption constants $K_A(T)$ and $K_B(T)$ using the provided van't Hoff equation:\n   $$K_i(T) = K_{i,\\mathrm{ref}} \\exp\\left(\\frac{\\Delta H_i}{R}\\left(\\frac{1}{T_{\\mathrm{ref}}}-\\frac{1}{T}\\right)\\right)$$\nb. It will then compute the denominator term $D = 1 + K_A(T) p_A + K_B(T) p_B$.\nc. Finally, it will calculate $n_A = 1 - 2 K_A(T) p_A / D$ and $n_B = 1 - 2 K_B(T) p_B / D$.\nd. The results for each test case, rounded to six decimal places, will be collected and formatted into the required output string. The special case where a reactant partial pressure is zero, as in test case $4$ ($p_B=0.0$), is handled correctly by the derived formulae, yielding $n_B=1$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes reaction orders for a Langmuir-Hinshelwood mechanism.\n    \"\"\"\n\n    # --- Define Physical Constants ---\n    R = 8.314462618  # J mol^-1 K^-1\n    T_ref = 500.0      # K\n    K_A_ref = 2.0      # bar^-1\n    K_B_ref = 0.2      # bar^-1\n    dH_A = -40000.0    # J mol^-1\n    dH_B = -20000.0    # J mol^-1\n    # k0 and Ea are not needed for reaction order calculation.\n\n    # --- Define Test Suite ---\n    # Each tuple is (p_A [bar], p_B [bar], T [K])\n    test_cases = [\n        (0.01, 0.01, 700.0),\n        (5.0, 0.1, 500.0),\n        (0.5, 40.0, 350.0),\n        (20.0, 0.0, 450.0),\n        (1.0, 1.0, 300.0),\n        (1.0, 1.0, 800.0),\n    ]\n\n    def calculate_K(K_ref, dH, T):\n        \"\"\"\n        Calculates the adsorption equilibrium constant K at temperature T\n        using the van't Hoff relation.\n        \"\"\"\n        if T == 0:\n            # Avoid division by zero; realistically, T > 0K.\n            # As T->0, for exothermic adsorption, K->infinity.\n            return float('inf')\n        \n        exponent = (dH / R) * ((1.0 / T_ref) - (1.0 / T))\n        return K_ref * np.exp(exponent)\n\n    def calculate_orders(p_A, p_B, T):\n        \"\"\"\n        Calculates the reaction orders n_A and n_B.\n        \"\"\"\n        # Calculate temperature-dependent equilibrium constants\n        K_A = calculate_K(K_A_ref, dH_A, T)\n        K_B = calculate_K(K_B_ref, dH_B, T)\n\n        # Calculate the denominator of the rate expression\n        denominator = 1.0 + K_A * p_A + K_B * p_B\n\n        # Calculate reaction orders based on the derived expressions\n        # n_A = 1 - 2 * K_A * p_A / denominator\n        # n_B = 1 - 2 * K_B * p_B / denominator\n        if denominator == 0:\n            # Should not happen under physical conditions\n            return (np.nan, np.nan)\n        \n        n_A = 1.0 - (2.0 * K_A * p_A) / denominator\n        n_B = 1.0 - (2.0 * K_B * p_B) / denominator\n        \n        return n_A, n_B\n\n    results = []\n    for case in test_cases:\n        p_A, p_B, T = case\n        n_A, n_B = calculate_orders(p_A, p_B, T)\n        \n        # Round the results to six decimal places\n        n_A_rounded = round(n_A, 6)\n        n_B_rounded = round(n_B, 6)\n        \n        results.append([n_A_rounded, n_B_rounded])\n\n    # Format the final output string exactly as required\n    # e.g., [[-0.818182,0.909091],[...]]\n    # Using str().replace() is a robust way to remove spaces.\n    final_output = str(results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "A robust microkinetic model must not only describe reaction rates but also adhere to fundamental thermodynamic laws. This exercise focuses on enforcing this consistency through the principle of detailed balance, which connects kinetics and thermodynamics via Transition State Theory (TST). You will implement a model where the ratio of forward and reverse rate constants, $k_{\\mathrm{f}}/k_{\\mathrm{r}}$, correctly reproduces the thermodynamic equilibrium constant $K_{\\mathrm{eq}}$ for an elementary step , a critical check for any predictive simulation.",
            "id": "3879666",
            "problem": "Consider a reversible microkinetic model of a heterogeneous catalytic surface where each elementary step is modeled in a manner consistent with Transition State Theory (TST). The purpose is to enforce thermodynamic consistency so that the ratio of the forward and reverse rate constants recovers the thermodynamic equilibrium constant implied by the standard Gibbs free energy change. You are to implement a program that, for a provided suite of elementary steps, computes forward and reverse rate constants in per-second units while ensuring the ratio of these rate constants reproduces the equilibrium constant for each step.\n\nAssume the following fundamental base, applicable to elementary adsorption, desorption, and surface reaction steps on a catalytic surface:\n- Detailed balance at equilibrium requires the forward and reverse one-way fluxes to be equal, which implies that the ratio of forward and reverse rate constants must equal the equilibrium constant computed from the change in standard Gibbs free energy.\n- The equilibrium constant is defined by the standard Gibbs free energy change via a well-tested thermodynamic relation derived from statistical mechanics and classical thermodynamics.\n- Transition State Theory (TST) provides a route to express elementary-step rate constants in terms of activation free energies and universal constants.\n\nYour program must, for each test case, perform the following:\n- Use the absolute temperature $T$ in $\\mathrm{K}$, the standard Gibbs free energy change $\\Delta G^\\circ$ in $\\mathrm{kJ\\,mol^{-1}}$, and the forward activation free energy $\\Delta G^\\ddagger_{\\mathrm{f}}$ in $\\mathrm{kJ\\,mol^{-1}}$ to compute forward and reverse rate constants $k_{\\mathrm{f}}$ and $k_{\\mathrm{r}}$ in $\\mathrm{s^{-1}}$ under the assumptions of Transition State Theory.\n- Implement thermodynamic consistency for each elementary step such that the ratio $k_{\\mathrm{f}}/k_{\\mathrm{r}}$ equals the equilibrium constant implied by $\\Delta G^\\circ$.\n- Use the universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, the Boltzmann constant $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, and Planck’s constant $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$. When converting energies, $1\\,\\mathrm{kJ\\,mol^{-1}} = 1000\\,\\mathrm{J\\,mol^{-1}}$.\n- For each test case, compute the absolute relative deviation (dimensionless) between the model’s ratio $k_{\\mathrm{f}}/k_{\\mathrm{r}}$ and the equilibrium constant $K_{\\mathrm{eq}}$ implied by $\\Delta G^\\circ$, defined as $\\left|\\dfrac{(k_{\\mathrm{f}}/k_{\\mathrm{r}})}{K_{\\mathrm{eq}}} - 1\\right|$.\n\nExpress all computed rate constants internally in $\\mathrm{s^{-1}}$. The program’s final output should be a dimensionless list of absolute relative deviations for the provided test suite. The program must print a single line containing the results as a comma-separated list enclosed in square brackets.\n\nUse the following test suite of parameter values to ensure coverage of typical and edge scenarios:\n- Case $1$: $T = 600\\,\\mathrm{K}$, $\\Delta G^\\circ = -20\\,\\mathrm{kJ\\,mol^{-1}}$, $\\Delta G^\\ddagger_{\\mathrm{f}} = 80\\,\\mathrm{kJ\\,mol^{-1}}$.\n- Case $2$ (thermoneutral isomerization-like step): $T = 500\\,\\mathrm{K}$, $\\Delta G^\\circ = 0\\,\\mathrm{kJ\\,mol^{-1}}$, $\\Delta G^\\ddagger_{\\mathrm{f}} = 65\\,\\mathrm{kJ\\,mol^{-1}}$.\n- Case $3$ (high-temperature endergonic surface reaction): $T = 1200\\,\\mathrm{K}$, $\\Delta G^\\circ = 50\\,\\mathrm{kJ\\,mol^{-1}}$, $\\Delta G^\\ddagger_{\\mathrm{f}} = 90\\,\\mathrm{kJ\\,mol^{-1}}$.\n- Case $4$ (low-temperature mildly exergonic adsorption-like step treated as an elementary reversible transformation): $T = 250\\,\\mathrm{K}$, $\\Delta G^\\circ = -5\\,\\mathrm{kJ\\,mol^{-1}}$, $\\Delta G^\\ddagger_{\\mathrm{f}} = 35\\,\\mathrm{kJ\\,mol^{-1}}$.\n- Case $5$ (near-thermoneutral elementary step): $T = 298\\,\\mathrm{K}$, $\\Delta G^\\circ = 1\\,\\mathrm{kJ\\,mol^{-1}}$, $\\Delta G^\\ddagger_{\\mathrm{f}} = 20\\,\\mathrm{kJ\\,mol^{-1}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\text{result1},\\text{result2},\\text{result3},\\ldots]$), where each entry is the absolute relative deviation (dimensionless) for the corresponding test case in the order specified above.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and objective, providing all necessary information for a unique solution without contradictions or ambiguities. It describes a standard and fundamental task in computational chemical kinetics: ensuring that the rate constants in a microkinetic model are consistent with the underlying thermodynamics of the elementary steps. We may therefore proceed with a formal solution.\n\nThe core of the problem lies in the relationship between thermodynamics and kinetics for an elementary reversible reaction. This relationship is enforced by the principle of detailed balance, which states that at equilibrium, the rate of every elementary process is equal to the rate of its reverse process. For a simple reversible step, this implies that the ratio of the forward rate constant, $k_{\\mathrm{f}}$, to the reverse rate constant, $k_{\\mathrm{r}}$, must be equal to the thermodynamic equilibrium constant, $K_{\\mathrm{eq}}$.\n\n$$\n\\frac{k_{\\mathrm{f}}}{k_{\\mathrm{r}}} = K_{\\mathrm{eq}}\n$$\n\nThe solution requires us to compute both $k_{\\mathrm{f}}$ and $k_{\\mathrm{r}}$ using Transition State Theory (TST) in a way that respects this condition.\n\nFirst, the equilibrium constant, $K_{\\mathrm{eq}}$, is related to the standard Gibbs free energy change of the reaction, $\\Delta G^\\circ$, by the fundamental thermodynamic equation:\n\n$$\nK_{\\mathrm{eq}} = \\exp\\left(-\\frac{\\Delta G^\\circ}{RT}\\right)\n$$\n\nHere, $R$ is the universal gas constant ($8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$) and $T$ is the absolute temperature in Kelvin.\n\nSecond, according to Transition State Theory (specifically, the Eyring equation), the rate constant, $k$, for an elementary step is given by:\n\n$$\nk = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{RT}\\right)\n$$\n\nIn this expression, $k_{\\mathrm{B}}$ is the Boltzmann constant ($1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$), $h$ is Planck's constant ($6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$), and $\\Delta G^\\ddagger$ is the molar Gibbs free energy of activation. The transmission coefficient is assumed to be unity, a common practice for elementary steps on surfaces unless quantum tunneling is significant. The units of the pre-exponential factor $\\frac{k_{\\mathrm{B}}T}{h}$ are $\\mathrm{s}^{-1}$, consistent with the required output units for the rate constants.\n\nApplying the TST expression to the forward and reverse reactions, we have:\n\n$$\nk_{\\mathrm{f}} = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right)\n$$\n\n$$\nk_{\\mathrm{r}} = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{r}}}{RT}\\right)\n$$\n\nwhere $\\Delta G^\\ddagger_{\\mathrm{f}}$ and $\\Delta G^\\ddagger_{\\mathrm{r}}$ are the activation free energies for the forward and reverse directions, respectively.\n\nTo enforce thermodynamic consistency, we substitute these expressions into the detailed balance condition:\n\n$$\n\\frac{k_{\\mathrm{f}}}{k_{\\mathrm{r}}} = \\frac{\\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right)}{\\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger_{\\mathrm{r}}}{RT}\\right)} = \\exp\\left(\\frac{\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right)\n$$\n\nSetting this equal to the thermodynamic expression for $K_{\\mathrm{eq}}$:\n\n$$\n\\exp\\left(\\frac{\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right) = \\exp\\left(-\\frac{\\Delta G^\\circ}{RT}\\right)\n$$\n\nBy taking the natural logarithm of both sides, we obtain the relationship between the activation energies and the overall reaction energy:\n\n$$\n\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}} = -\\Delta G^\\circ\n$$\n\nThis can be rearranged to express the reverse activation energy in terms of the given forward activation energy and the Gibbs free energy change:\n\n$$\n\\Delta G^\\ddagger_{\\mathrm{r}} = \\Delta G^\\ddagger_{\\mathrm{f}} - \\Delta G^\\circ\n$$\n\nThis equation is the key to ensuring thermodynamic consistency. It demonstrates that if the forward activation energy and the reaction energy are known, the reverse activation energy is uniquely determined.\n\nThe computational procedure for each test case is as follows:\n1.  Take the input parameters: temperature $T$, standard Gibbs free energy change $\\Delta G^\\circ$, and forward activation free energy $\\Delta G^\\ddagger_{\\mathrm{f}}$.\n2.  Convert the energy values from $\\mathrm{kJ\\,mol^{-1}}$ to $\\mathrm{J\\,mol^{-1}}$ by multiplying by $1000$.\n3.  Calculate the thermodynamic equilibrium constant, $K_{\\mathrm{eq}} = \\exp(-\\frac{\\Delta G^\\circ}{RT})$.\n4.  Calculate the forward rate constant, $k_{\\mathrm{f}}$, using its TST expression with $\\Delta G^\\ddagger_{\\mathrm{f}}$.\n5.  Calculate the reverse activation free energy, $\\Delta G^\\ddagger_{\\mathrm{r}} = \\Delta G^\\ddagger_{\\mathrm{f}} - \\Delta G^\\circ$.\n6.  Calculate the reverse rate constant, $k_{\\mathrm{r}}$, using its TST expression with the derived $\\Delta G^\\ddagger_{\\mathrm{r}}$.\n7.  Compute the ratio of the calculated rate constants, $(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}} = k_{\\mathrm{f}}/k_{\\mathrm{r}}$.\n8.  Finally, calculate the absolute relative deviation to verify consistency: $\\left|\\dfrac{(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}}}{K_{\\mathrm{eq}}} - 1\\right|$.\n\nBy construction, the ratio $(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}}$ will be mathematically identical to $K_{\\mathrm{eq}}$:\n$$\n(k_{\\mathrm{f}}/k_{\\mathrm{r}})_{\\text{model}} = \\exp\\left(\\frac{\\Delta G^\\ddagger_{\\mathrm{r}} - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right) = \\exp\\left(\\frac{(\\Delta G^\\ddagger_{\\mathrm{f}} - \\Delta G^\\circ) - \\Delta G^\\ddagger_{\\mathrm{f}}}{RT}\\right) = \\exp\\left(-\\frac{\\Delta G^\\circ}{RT}\\right) = K_{\\mathrm{eq}}\n$$\nTherefore, the absolute relative deviation should be zero, or a very small number attributable to floating-point precision limitations in the computer's arithmetic. This calculation serves as an excellent internal consistency check on the implementation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy is not used but is available as per the environment specification.\n\ndef solve():\n    \"\"\"\n    Computes the absolute relative deviation between the kinetic and thermodynamic\n    equilibrium constants for a series of elementary reaction steps.\n    \"\"\"\n    # Define physical constants as provided in the problem statement.\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.314462618\n    # Boltzmann constant in J K^-1\n    k_B = 1.380649e-23\n    # Planck's constant in J s\n    h = 6.62607015e-34\n\n    # The test suite provided in the problem statement.\n    # Each case is a tuple: (T in K, dG_circ in kJ/mol, dGf_act in kJ/mol)\n    test_cases = [\n        (600, -20, 80),   # Case 1\n        (500, 0, 65),     # Case 2\n        (1200, 50, 90),   # Case 3\n        (250, -5, 35),    # Case 4\n        (298, 1, 20),     # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        T, dG_circ_kJ, dGf_act_kJ = case\n\n        # Convert energies from kJ/mol to J/mol for consistency with constants.\n        dG_circ_J = dG_circ_kJ * 1000.0\n        dGf_act_J = dGf_act_kJ * 1000.0\n\n        # 1. Calculate the thermodynamic equilibrium constant, K_eq.\n        # K_eq = exp(-dG_circ / (R * T))\n        K_eq = np.exp(-dG_circ_J / (R * T))\n\n        # 2. Calculate the forward rate constant, k_f, using Transition State Theory.\n        # k_f = (k_B * T / h) * exp(-dGf_act / (R * T))\n        kf = (k_B * T / h) * np.exp(-dGf_act_J / (R * T))\n\n        # 3. Calculate the reverse activation free energy, dGr_act, to enforce\n        #    thermodynamic consistency (dGr_act = dGf_act - dG_circ).\n        dGr_act_J = dGf_act_J - dG_circ_J\n\n        # 4. Calculate the reverse rate constant, k_r, using Transition State Theory.\n        # k_r = (k_B * T / h) * exp(-dGr_act / (R * T))\n        kr = (k_B * T / h) * np.exp(-dGr_act_J / (R * T))\n        \n        # 5. Calculate the ratio of the computed rate constants.\n        kf_kr_ratio = kf / kr\n        \n        # 6. Compute the absolute relative deviation to verify consistency.\n        # The deviation should be zero, barring floating-point inaccuracies.\n        deviation = np.abs(kf_kr_ratio / K_eq - 1.0)\n        \n        results.append(deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once a physically consistent kinetic model is formulated, the next challenge is to solve the system of differential equations numerically. This practice addresses the common problem of stiffness, which arises from widely separated timescales among elementary steps. By constructing the Jacobian matrix and analyzing its eigenvalues , you will learn to diagnose stiffness and select an appropriate and efficient numerical integration method for simulating the system's dynamic behavior.",
            "id": "3879644",
            "problem": "Consider a well-mixed isothermal catalytic surface with a single type of vacant site modeled by a Langmuir–Hinshelwood mechanism. Two adsorbates, $A$ and $B$, competitively adsorb, desorb, and undergo a bimolecular surface reaction to form a gas-phase product $P$. Let $\\theta_A$ and $\\theta_B$ denote the fractional coverages of $A$ and $B$, respectively, on the surface, and let $\\theta_\\star$ denote the fraction of vacant sites. The site balance is $ \\theta_\\star + \\theta_A + \\theta_B = 1$. Gas-phase partial pressures are $p_A$ and $p_B$ (in $\\mathrm{Pa}$). The elementary steps are:\n- Adsorption: $A(\\mathrm{g}) + \\star \\to A\\star$ and $B(\\mathrm{g}) + \\star \\to B\\star$.\n- Desorption: $A\\star \\to A(\\mathrm{g}) + \\star$ and $B\\star \\to B(\\mathrm{g}) + \\star$.\n- Surface reaction: $A\\star + B\\star \\to P(\\mathrm{g}) + 2\\star$.\n\nAssume the following generalized mass-action rates for each elementary step:\n- Adsorption of $A$: $r_{\\mathrm{ads},A} = k_{\\mathrm{ads},A} \\, p_A \\, \\theta_\\star$.\n- Desorption of $A$: $r_{\\mathrm{des},A} = k_{\\mathrm{des},A} \\, \\theta_A$.\n- Adsorption of $B$: $r_{\\mathrm{ads},B} = k_{\\mathrm{ads},B} \\, p_B \\, \\theta_\\star$.\n- Desorption of $B$: $r_{\\mathrm{des},B} = k_{\\mathrm{des},B} \\, \\theta_B$.\n- Surface reaction: $r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B$.\n\nHere $k_{\\mathrm{ads},A}$ and $k_{\\mathrm{ads},B}$ have units $\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$, while $k_{\\mathrm{des},A}$, $k_{\\mathrm{des},B}$, and $k_{\\mathrm{rxn}}$ have units $\\mathrm{s}^{-1}$. The governing ordinary differential equations (ODEs) for the coverages are\n$$\n\\frac{d\\theta_A}{dt} = r_{\\mathrm{ads},A} - r_{\\mathrm{des},A} - r_{\\mathrm{rxn}}, \\quad\n\\frac{d\\theta_B}{dt} = r_{\\mathrm{ads},B} - r_{\\mathrm{des},B} - r_{\\mathrm{rxn}},\n$$\nwith $\\theta_\\star = 1 - \\theta_A - \\theta_B$.\n\nAt a given state $(\\theta_A,\\theta_B)$ and parameters $(p_A,p_B,k_{\\mathrm{ads},A},k_{\\mathrm{des},A},k_{\\mathrm{ads},B},k_{\\mathrm{des},B},k_{\\mathrm{rxn}})$, form the $2\\times 2$ Jacobian matrix $J(\\theta_A,\\theta_B)$ of the kinetic system with entries\n$$\nJ_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}, \\quad \n\\text{where } \\mathbf{f}(\\theta_A,\\theta_B) = \\begin{bmatrix} d\\theta_A/dt \\\\ d\\theta_B/dt \\end{bmatrix}.\n$$\nUse eigenvalue analysis of $J$ to identify stiffness and propose an efficient numerical integration strategy. Define the stiffness ratio\n$$\n\\kappa = \\frac{\\max\\{|\\lambda_1|,|\\lambda_2|\\}}{\\min\\{|\\lambda_1|,|\\lambda_2|\\}}, \n$$\nwhere $\\lambda_1,\\lambda_2$ are the eigenvalues of $J$ and $|\\cdot|$ denotes the complex modulus. If the minimum modulus is smaller than $10^{-12}$, treat it as $10^{-12}$ when computing $\\kappa$. Classify the system as stiff if $\\kappa > 100$ (boolean output). Propose a numerical strategy by selecting a method code according to:\n- $0$ for non-stiff regimes (recommend an explicit Runge–Kutta method such as $RK45$),\n- $2$ for moderately stiff regimes ($100 < \\kappa \\leq 1000$, recommend an implicit Runge–Kutta method such as $Radau$),\n- $1$ for very stiff regimes ($\\kappa > 1000$, recommend an implicit multistep method such as $BDF$).\n\nAlso compute a conservative explicit step size suggestion in seconds for linear stability based on the spectral radius $\\rho = \\max\\{|\\lambda_1|,|\\lambda_2|\\}$:\n$$\n\\Delta t_{\\mathrm{safe}} = \\frac{\\alpha}{\\rho},\n$$\nwhere $\\alpha = 0.2$ if non-stiff ($\\kappa \\leq 100$), $\\alpha = 0.05$ if moderately stiff ($100 < \\kappa \\leq 1000$), and $\\alpha = 0.01$ if very stiff ($\\kappa > 1000$). If $\\rho = 0$, set $\\Delta t_{\\mathrm{safe}} = 1.0$.\n\nCompute the Jacobian and perform the eigenvalue analysis at the specified initial coverages for each test case below. Express $\\Delta t_{\\mathrm{safe}}$ in $\\mathrm{s}$.\n\nTest suite (each tuple corresponds to $(p_A, p_B, k_{\\mathrm{ads},A}, k_{\\mathrm{des},A}, k_{\\mathrm{ads},B}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}, \\theta_A^0, \\theta_B^0)$):\n1. $(10{,}000, 5{,}000, 1\\times 10^{-4}, 1\\times 10^{-2}, 2\\times 10^{-4}, 5\\times 10^{-3}, 5\\times 10^{-1}, 0.10, 0.10)$\n2. $(20{,}000, 20{,}000, 5\\times 10^{-5}, 1\\times 10^{-2}, 5\\times 10^{-5}, 1\\times 10^{-2}, 1\\times 10^{4}, 0.30, 0.30)$\n3. $(50{,}000, 40{,}000, 1\\times 10^{-4}, 5\\times 10^{-2}, 2\\times 10^{-4}, 1\\times 10^{-2}, 1\\times 10^{-1}, 0.90, 0.09)$\n4. $(100, 100, 1\\times 10^{-5}, 1\\times 10^{-3}, 1\\times 10^{-5}, 1\\times 10^{-3}, 0, 0.01, 0.01)$\n\nYour program must, for each test case in the order given, compute and output the following four values in order: the stiffness ratio $\\kappa$ as a float, the stiffness classification as a boolean, the recommended method code as an integer, and the suggested explicit stable step size $\\Delta t_{\\mathrm{safe}}$ in seconds as a float. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\dots]$). The overall output list should be the concatenation of the four values for each test case, in sequence, resulting in a single flat list of length $16$.",
            "solution": "The user-provided problem statement is subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Model Framework**: A well-mixed isothermal catalytic surface described by a Langmuir–Hinshelwood mechanism with competitive adsorption of two species, $A$ and $B$.\n- **State Variables**: Fractional surface coverages $\\theta_A$ and $\\theta_B$.\n- **Site Balance Constraint**: $\\theta_\\star = 1 - \\theta_A - \\theta_B$, where $\\theta_\\star$ is the fraction of vacant sites.\n- **System Inputs**: Partial pressures $p_A$ and $p_B$ in units of $\\mathrm{Pa}$.\n- **Elementary Steps and Rate Laws**:\n    - Adsorption ($A$): $r_{\\mathrm{ads},A} = k_{\\mathrm{ads},A} \\, p_A \\, \\theta_\\star$.\n    - Desorption ($A$): $r_{\\mathrm{des},A} = k_{\\mathrm{des},A} \\, \\theta_A$.\n    - Adsorption ($B$): $r_{\\mathrm{ads},B} = k_{\\mathrm{ads},B} \\, p_B \\, \\theta_\\star$.\n    - Desorption ($B$): $r_{\\mathrm{des},B} = k_{\\mathrm{des},B} \\, \\theta_B$.\n    - Surface reaction ($A\\star + B\\star$): $r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B$.\n- **Rate Constants**: $k_{\\mathrm{ads},A}, k_{\\mathrm{ads},B}$ in $\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$; $k_{\\mathrm{des},A}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}$ in $\\mathrm{s}^{-1}$.\n- **Governing ODEs**: The time evolution of the coverages is given by the vector function $\\mathbf{f}(\\theta_A, \\theta_B) = [f_1, f_2]^T$, where:\n    $$f_1 = \\frac{d\\theta_A}{dt} = r_{\\mathrm{ads},A} - r_{\\mathrm{des},A} - r_{\\mathrm{rxn}}$$\n    $$f_2 = \\frac{d\\theta_B}{dt} = r_{\\mathrm{ads},B} - r_{\\mathrm{des},B} - r_{\\mathrm{rxn}}$$\n- **Jacobian Matrix**: $J_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}$ for $i,j \\in \\{1,2\\}$, where $\\theta_1=\\theta_A$ and $\\theta_2=\\theta_B$.\n- **Stiffness Ratio ($\\kappa$)**: $\\kappa = \\frac{\\max\\{|\\lambda_1|,|\\lambda_2|\\}}{\\min\\{|\\lambda_1|,|\\lambda_2|\\}}$, where $\\lambda_1, \\lambda_2$ are the eigenvalues of $J$. If $\\min\\{|\\lambda_i|\\} < 10^{-12}$, it is floored at $10^{-12}$.\n- **Stiffness Classification**: System is stiff if $\\kappa > 100$.\n- **Numerical Method Code**: $0$ for non-stiff ($\\kappa \\leq 100$), $2$ for moderately stiff ($100 < \\kappa \\leq 1000$), $1$ for very stiff ($\\kappa > 1000$).\n- **Safe Step Size ($\\Delta t_{\\mathrm{safe}}$)**: $\\Delta t_{\\mathrm{safe}} = \\frac{\\alpha}{\\rho}$, where $\\rho$ is the spectral radius of $J$. $\\alpha$ is $0.2$, $0.05$, or $0.01$ for non-stiff, moderately stiff, or very stiff systems, respectively. If $\\rho = 0$, $\\Delta t_{\\mathrm{safe}} = 1.0\\,\\mathrm{s}$.\n- **Task**: For a set of test cases, compute $\\kappa$, the stiffness boolean, the method code, and $\\Delta t_{\\mathrm{safe}}$ at the given initial coverages.\n- **Test Suite**: Four sets of parameters $(p_A, p_B, k_{\\mathrm{ads},A}, k_{\\mathrm{des},A}, k_{\\mathrm{ads},B}, k_{\\mathrm{des},B}, k_{\\mathrm{rxn}}, \\theta_A^0, \\theta_B^0)$ are provided.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is based on the well-established Langmuir-Hinshelwood model of surface kinetics, a fundamental concept in catalysis. The analysis of system stiffness via the Jacobian matrix eigenvalues is a standard and rigorous method in the numerical solution of ordinary differential equations (ODEs), particularly in chemical kinetics. The problem is chemically and mathematically sound.\n- **Well-Posedness**: The problem is fully specified. All necessary constants, initial conditions, and functional forms are provided. The definitions for stiffness, method codes, and step size are unambiguous and allow for the computation of a unique solution for each test case.\n- **Objectivity**: The problem is stated using precise, objective mathematical language. The criteria for classification are quantitative and free from subjective interpretation.\n- **Conclusion**: The problem does not violate any of the invalidity criteria. It is scientifically grounded, well-posed, objective, and complete.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Principle-Based Solution\nThe solution requires analyzing the local stability and stiffness of the given system of ODEs at a specific point in the state space $(\\theta_A, \\theta_B)$. This analysis is performed using the Jacobian matrix of the system.\n\n**1. Formulation of the ODE System**\n\nFirst, we express the rate of change of coverages, $f_1 = d\\theta_A/dt$ and $f_2 = d\\theta_B/dt$, explicitly in terms of the state variables $\\theta_A$ and $\\theta_B$ by substituting the site balance equation $\\theta_\\star = 1 - \\theta_A - \\theta_B$ into the rate laws:\n$$\nf_1(\\theta_A, \\theta_B) = k_{\\mathrm{ads},A} \\, p_A \\, (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\, \\theta_A - k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B\n$$\n$$\nf_2(\\theta_A, \\theta_B) = k_{\\mathrm{ads},B} \\, p_B \\, (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\, \\theta_B - k_{\\mathrm{rxn}} \\, \\theta_A \\, \\theta_B\n$$\n\n**2. Derivation of the Jacobian Matrix**\n\nThe Jacobian matrix $J$ linearizes the system dynamics around a point $(\\theta_A, \\theta_B)$. Its elements, $J_{ij} = \\frac{\\partial f_i}{\\partial \\theta_j}$, characterize how a small perturbation in one coverage affects the rate of change of another. The independent variables are $\\theta_1 \\equiv \\theta_A$ and $\\theta_2 \\equiv \\theta_B$.\n\nThe four partial derivatives are calculated as follows:\n- **$J_{11} = \\frac{\\partial f_1}{\\partial \\theta_A}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_A} \\left( k_{\\mathrm{ads},A} p_A (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\theta_A - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{des},A} - k_{\\mathrm{rxn}} \\theta_B\n  $$\n- **$J_{12} = \\frac{\\partial f_1}{\\partial \\theta_B}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_B} \\left( k_{\\mathrm{ads},A} p_A (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},A} \\theta_A - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{rxn}} \\theta_A\n  $$\n- **$J_{21} = \\frac{\\partial f_2}{\\partial \\theta_A}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_A} \\left( k_{\\mathrm{ads},B} p_B (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\theta_B - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{rxn}} \\theta_B\n  $$\n- **$J_{22} = \\frac{\\partial f_2}{\\partial \\theta_B}$**:\n  $$\n  \\frac{\\partial}{\\partial \\theta_B} \\left( k_{\\mathrm{ads},B} p_B (1 - \\theta_A - \\theta_B) - k_{\\mathrm{des},B} \\theta_B - k_{\\mathrm{rxn}} \\theta_A \\theta_B \\right) = -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{des},B} - k_{\\mathrm{rxn}} \\theta_A\n  $$\nThus, the Jacobian matrix is:\n$$\nJ(\\theta_A, \\theta_B) = \\begin{bmatrix}\n-k_{\\mathrm{ads},A} p_A - k_{\\mathrm{des},A} - k_{\\mathrm{rxn}} \\theta_B  & -k_{\\mathrm{ads},A} p_A - k_{\\mathrm{rxn}} \\theta_A \\\\\n-k_{\\mathrm{ads},B} p_B - k_{\\mathrm{rxn}} \\theta_B  & -k_{\\mathrm{ads},B} p_B - k_{\\mathrm{des},B} - k_{\\mathrm{rxn}} \\theta_A\n\\end{bmatrix}\n$$\n\n**3. Eigenvalue Analysis and Stiffness Characterization**\n\nThe eigenvalues $\\lambda$ of the Jacobian matrix determine the characteristic time scales of the system's response to perturbations. For a stable system, the real parts of the eigenvalues are negative, and their magnitudes, $|\\mathrm{Re}(\\lambda)|$, are the inverse of the relaxation time scales.\n\n- **Stiffness**: A system is numerically stiff if its characteristic time scales are widely separated. This is quantified by the stiffness ratio, $\\kappa$, defined as the ratio of the largest to the smallest eigenvalue modulus.\n  $$\n  \\kappa = \\frac{\\max\\{|\\lambda_1|, |\\lambda_2|\\}}{\\min\\{|\\lambda_1|, |\\lambda_2|\\}}\n  $$\n  A large $\\kappa$ indicates stiffness, meaning an explicit numerical integrator would be forced to take tiny time steps by the fastest process (largest $|\\lambda|$) to solve the system over the time scale of the slowest process (smallest $|\\lambda|$), leading to inefficiency.\n- **Numerical Strategy**: The choice of an ODE solver depends on this stiffness classification. Non-stiff problems can be efficiently solved with explicit methods (e.g., Runge-Kutta $45$), while stiff problems require implicit methods (e.g., BDF, Radau) to maintain stability with reasonable step sizes.\n- **Explicit Step Size Limit**: For an explicit method, the time step $\\Delta t$ is limited by the stability region of the method, which is inversely proportional to the spectral radius $\\rho = \\max\\{|\\lambda_i|\\}$. The problem provides a formula for a conservative \"safe\" step size, $\\Delta t_{\\mathrm{safe}} = \\alpha / \\rho$, where $\\alpha$ is a safety factor that decreases as stiffness increases.\n\n**4. Computational Algorithm**\n\nFor each test case, the following procedure is executed:\n1.  Substitute the given parameters $(p_A, p_B, k_{\\dots}, \\theta_A^0, \\theta_B^0)$ into the derived expressions for the Jacobian elements $J_{11}, J_{12}, J_{21}, J_{22}$.\n2.  Construct the $2 \\times 2$ numerical Jacobian matrix.\n3.  Compute its two eigenvalues, $\\lambda_1$ and $\\lambda_2$.\n4.  Calculate the complex moduli of the eigenvalues, $|\\lambda_1|$ and $|\\lambda_2|$.\n5.  Determine $\\lambda_{\\max} = \\max\\{|\\lambda_1|, |\\lambda_2|\\}$ and $\\lambda_{\\min} = \\min\\{|\\lambda_1|, |\\lambda_2|\\}$.\n6.  Compute the stiffness ratio $\\kappa = \\lambda_{\\max} / \\max(\\lambda_{\\min}, 10^{-12})$.\n7.  Classify the system and determine the method code based on the value of $\\kappa$.\n8.  Determine the factor $\\alpha$ based on the classification.\n9.  Calculate the safe step size $\\Delta t_{\\mathrm{safe}} = \\alpha / \\lambda_{\\max}$ (using $\\rho = \\lambda_{\\max}$), handling the case $\\rho=0$.\n10. Collate the four resulting values: $\\kappa$ (float), stiffness (boolean), method code (integer), and $\\Delta t_{\\mathrm{safe}}$ (float).\n\nThis procedure is implemented in the provided Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stiffness of a surface reaction kinetic system for several test cases.\n    For each case, it computes the Jacobian matrix, its eigenvalues, the stiffness ratio,\n    a stiffness classification, a recommended numerical method, and a safe explicit step size.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (p_A, p_B, k_ads_A, k_des_A, k_ads_B, k_des_B, k_rxn, theta_A_initial, theta_B_initial)\n    test_cases = [\n        (10000.0, 5000.0, 1.0e-4, 1.0e-2, 2.0e-4, 5.0e-3, 5.0e-1, 0.10, 0.10),\n        (20000.0, 20000.0, 5.0e-5, 1.0e-2, 5.0e-5, 1.0e-2, 1.0e4, 0.30, 0.30),\n        (50000.0, 40000.0, 1.0e-4, 5.0e-2, 2.0e-4, 1.0e-2, 1.0e-1, 0.90, 0.09),\n        (100.0, 100.0, 1.0e-5, 1.0e-3, 1.0e-5, 1.0e-3, 0.0, 0.01, 0.01)\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        p_A, p_B, k_ads_A, k_des_A, k_ads_B, k_des_B, k_rxn, theta_A, theta_B = case\n\n        # Construct the Jacobian matrix J(theta_A, theta_B) based on the derived analytical expressions.\n        # J_ij = d(f_i)/d(theta_j), where f = [d(theta_A)/dt, d(theta_B)/dt]\n        J11 = -k_ads_A * p_A - k_des_A - k_rxn * theta_B\n        J12 = -k_ads_A * p_A - k_rxn * theta_A\n        J21 = -k_ads_B * p_B - k_rxn * theta_B\n        J22 = -k_ads_B * p_B - k_des_B - k_rxn * theta_A\n        \n        J = np.array([[J11, J12], [J21, J22]])\n        \n        # Compute the eigenvalues of the Jacobian matrix.\n        eigenvalues = np.linalg.eigvals(J)\n        \n        # Calculate the moduli (absolute values) of the eigenvalues.\n        lambda_moduli = np.abs(eigenvalues)\n        \n        # Get the maximum and minimum modulus.\n        lambda_max_mod = np.max(lambda_moduli)\n        lambda_min_mod = np.min(lambda_moduli)\n        \n        # Calculate the stiffness ratio kappa.\n        # Apply the floor of 1e-12 to the minimum modulus as per the problem statement.\n        kappa_denominator = max(lambda_min_mod, 1e-12)\n        kappa = lambda_max_mod / kappa_denominator\n        \n        # Determine stiffness classification and recommend the numerical method code.\n        is_stiff = kappa > 100.0\n        \n        if kappa <= 100.0:\n            # Non-stiff regime\n            method_code = 0\n            alpha = 0.2\n        elif kappa <= 1000.0:\n            # Moderately stiff regime\n            method_code = 2\n            alpha = 0.05\n        else:  # kappa > 1000.0\n            # Very stiff regime\n            method_code = 1\n            alpha = 0.01\n            \n        # Calculate the conservative explicit step size suggestion.\n        # Spectral radius rho is the maximum eigenvalue modulus.\n        rho = lambda_max_mod\n        \n        # Handle the special case where the spectral radius is zero.\n        if rho == 0.0:\n            delta_t_safe = 1.0\n        else:\n            delta_t_safe = alpha / rho\n            \n        # Append the four computed values for this test case to the results list.\n        all_results.extend([kappa, is_stiff, method_code, delta_t_safe])\n        \n    # Print the final flattened list of results in the required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}