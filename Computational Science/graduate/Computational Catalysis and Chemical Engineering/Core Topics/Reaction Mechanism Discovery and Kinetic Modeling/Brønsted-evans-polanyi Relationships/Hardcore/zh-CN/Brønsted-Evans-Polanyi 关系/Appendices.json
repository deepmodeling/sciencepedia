{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个实践是基础性的。我们将利用从“微动弹性带”（Nudged Elastic Band, NEB）等方法中获得的原始活化能和反应能数据，从零开始实现普通最小二乘法（Ordinary Least Squares, OLS）。通过这项练习 ，您将掌握拟合BEP关系参数（$\\alpha$ 和 $E_0$）的核心计算技能，并学会通过决定系数 $R^2$ 来评估拟合优度。",
            "id": "3871019",
            "problem": "您的任务是实现一个算法上可靠的拟合，该拟合基于布朗斯特-埃文斯-波兰尼 (Brønsted-Evans-Polanyi, BEP) 线性关系，用于从微扰弹性带 (Nudged Elastic Band, NEB) 方法生成的数据中估算活化能垒和反应能之间的截距和斜率。布朗斯特-埃文斯-波兰尼 (BEP) 关系假设，势能面上一个基元步骤的活化能 $E_a$ 与该步骤的热力学驱动力（反应能）$\\Delta E$ 呈线性相关。在计算催化领域，NEB 方法提供了在势能面上一致构型下的能垒和反应能估算值，而 BEP 关系则用于构建参数维度降低的微观动力学模型。\n\n从以下基础出发：\n- 过渡态理论 (Transition State Theory, TST) 将反应速率常数与活化能垒联系起来，而 NEB 方法在势能面上的一致构型下提供了 $E_a$ 和 $\\Delta E$。\n- BEP 关系将 $E_a$ 建模为 $\\Delta E$ 的线性函数。您的目标是通过最小化观测到的活化能与模型预测值之间的残差平方和来估算此线性模型的参数。\n- 普通最小二乘法 (Ordinary Least Squares, OLS) 是一种经过充分检验的方法，通过最小化误差平方和来估算线性模型参数。\n\n请实现一个程序，对下面提供的每一组数据 $\\{(E_a,\\Delta E)\\}$，执行线性模型 $E_a = E_0 + \\alpha \\,\\Delta E$ 的普通最小二乘法拟合，其中 $E_0$ 是截距（以电子伏特报告），$\\alpha$ 是斜率（无量纲）。计算并报告：\n1. 回归斜率 $\\alpha$。\n2. 回归截距 $E_0$，单位为电子伏特。\n3. 决定系数 $R^2$，作为拟合优度的度量，定义为 $E_a$ 中可由线性模型解释的方差分数。\n\n为保证数值稳定性和完整性，请遵循以下规则：\n- 使用通过最小化残差平方和推导出的无偏 OLS 正规方程解。不要使用黑盒回归工具；使用和与均值从第一性原理出发实现计算。\n- 如果数据集中 $\\Delta E$ 的方差为零，则设 $\\alpha = 0$，并将 $E_0$ 设为 $E_a$ 的均值。对于 $R^2$，如果 $E_a$ 的总平方和为零且残差平方和也为零，则设 $R^2 = 1$。如果 $E_a$ 的总平方和为零但残差平方和非零，则设 $R^2 = 0$。\n- 所有能量单位均为电子伏特 (eV)。报告 $E_0$ 时单位为 eV。报告 $\\alpha$ 和 $R^2$ 时为无量纲数。\n\n使用以下测试数据集，每个数据集指定为一系列 $(E_a,\\Delta E)$ 对（单位为电子伏特）：\n- 情况 1（三个 NEB 计算的能垒；典型的正 BEP 斜率）：$\\{(E_a,\\Delta E) = (1.0,0.5),(0.8,0.2),(0.5,-0.3)\\}$。\n- 情况 2（四个点；中等噪声，与接近 $0.5$ 的 BEP 斜率一致）：$\\{(E_a,\\Delta E) = (0.87,0.4),(0.64,0.0),(0.55,-0.2),(0.38,-0.6)\\}$。\n- 情况 3（三个点；$\\Delta E$ 分布范围小，以测试数值稳定性）：$\\{(E_a,\\Delta E) = (0.761,0.100),(0.7591,0.101),(0.7599,0.099)\\}$。\n- 情况 4（三个点；一个离群值以降低 $R^2$）：$\\{(E_a,\\Delta E) = (0.22,-0.5),(0.73,0.2),(1.25,0.6)\\}$。\n- 情况 5（三个点；完全线性的对称集合；$R^2$ 应很高）：$\\{(E_a,\\Delta E) = (0.40,-1.0),(0.80,0.0),(1.20,1.0)\\}$。\n\n您的程序必须为每种情况计算三元组 $[\\alpha, E_0, R^2]$，并将每个值四舍五入到六位小数。最终输出必须是单行，包含一个由这些三元组组成的逗号分隔列表，并用方括号括起来。例如，输出格式为 $[[\\alpha_1,E_{0,1},R^2_1],[\\alpha_2,E_{0,2},R^2_2],\\dots]$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果（例如，\"[[alpha1,E01,R21],[alpha2,E02,R22],...]\"）。不应打印任何额外文本。",
            "solution": "该问题要求实现普通最小二乘法 (OLS) 回归，以从给定的活化能 ($E_a$) 和反应能 ($\\Delta E$) 数据集中确定布朗斯特-埃文斯-波兰尼 (BEP) 线性模型 $E_a = E_0 + \\alpha \\Delta E$ 的参数。需要确定的参数是截距 $E_0$ 和斜率 $\\alpha$。此外，必须计算决定系数 $R^2$ 作为拟合优度的度量。该实现必须从第一性原理出发，基于残差平方和的最小化。\n\n假设一个给定的数据集包含 $n$ 对观测值 $(\\Delta E_i, E_{a,i})$，其中 $i=1, \\dots, n$。我们将自变量定义为 $x_i = \\Delta E_i$，因变量定义为 $y_i = E_{a,i}$。线性模型预测的活化能为 $y_i^{\\text{pred}} = E_0 + \\alpha x_i$。\n\nOLS 方法通过最小化残差平方和 (SSR) $S(E_0, \\alpha)$ 来找到 $E_0$ 和 $\\alpha$ 的最优值，SSR 是观测值 $y_i$ 和预测值 $y_i^{\\text{pred}}$ 之间差的平方和。\n$$\nS(E_0, \\alpha) = \\sum_{i=1}^{n} (y_i - y_i^{\\text{pred}})^2 = \\sum_{i=1}^{n} (y_i - (E_0 + \\alpha x_i))^2\n$$\n为求最小值，我们对 $S$ 求关于 $E_0$ 和 $\\alpha$ 的偏导数并令其为零。这得到正规方程：\n$$\n\\frac{\\partial S}{\\partial E_0} = -2 \\sum_{i=1}^{n} (y_i - E_0 - \\alpha x_i) = 0\n$$\n$$\n\\frac{\\partial S}{\\partial \\alpha} = -2 \\sum_{i=1}^{n} x_i(y_i - E_0 - \\alpha x_i) = 0\n$$\n令 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$ 和 $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i$ 分别为 $\\Delta E$ 和 $E_a$ 的样本均值。第一个正规方程可简化为：\n$$\n\\sum y_i - nE_0 - \\alpha \\sum x_i = 0 \\implies n\\bar{y} - nE_0 - n\\alpha\\bar{x} = 0 \\implies E_0 = \\bar{y} - \\alpha \\bar{x}\n$$\n这表明回归线必须通过样本均值点 $(\\bar{x}, \\bar{y})$。将 $E_0$ 的这个表达式代入第二个正规方程并化简，得到斜率 $\\alpha$ 的解：\n$$\n\\alpha = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2}\n$$\n分子是 $x$ 和 $y$ 之间的样本协方差（乘以 $n-1$），分母是 $x$ 的样本方差（乘以 $n-1$）。\n\n决定系数 $R^2$ 量化了因变量 $E_a$ 的方差中可由自变量 $\\Delta E$ 预测的比例。其定义为：\n$$\nR^2 = 1 - \\frac{\\text{SSR}}{\\text{SST}}\n$$\n其中 SSR 是如前定义的残差平方和，SST 是总平方和，用于衡量因变量 $y_i$ 在其均值 $\\bar{y}$ 周围的总方差。\n$$\n\\text{SST} = \\sum_{i=1}^{n} (y_i - \\bar{y})^2\n$$\n$$\n\\text{SSR} = \\sum_{i=1}^{n} (y_i - (E_0 + \\alpha x_i))^2\n$$\n$R^2$ 值为 $1$ 表示完美拟合，而值为 $0$ 表示模型相比仅使用均值 $\\bar{y}$ 作为预测没有任何改进。\n\n问题规定了特殊数值情况的处理：\n1.  如果 $\\Delta E$ 的方差为零（即 $\\sum (x_i - \\bar{x})^2 = 0$），则 $\\alpha$ 表达式中的分母为零。在这种情况下，将 $\\alpha$ 设置为 $0$，将 $E_0$ 设置为 $E_a$ 的均值，即 $E_0 = \\bar{y}$。这在物理上是合理的，因为当 $\\Delta E$ 没有变化时，无法建立相关性。\n2.  如果 $E_a$ 的总平方和为零（即 $\\text{SST} = 0$），则所有 $E_a$ 值都相同。\n    - 如果残差平方和 (SSR) 也为零，这意味着一个完美的预测。$R^2$ 设置为 $1$。\n    - 如果 SSR 非零，则模型未能捕捉到常数数据，表明拟合不佳。$R^2$ 设置为 $0$。\n\n每个数据集的算法步骤如下：\n1.  将数据对分成 $\\Delta E$（记为 $x$）和 $E_a$（记为 $y$）的数组。\n2.  计算均值 $\\bar{x}$ 和 $\\bar{y}$。\n3.  计算项 $S_{xx} = \\sum (x_i - \\bar{x})^2$，该项与 $x$ 的方差成正比。\n4.  如果 $S_{xx}$ 在数值上为零，则设 $\\alpha = 0$ 且 $E_0 = \\bar{y}$。否则，计算 $S_{xy} = \\sum (x_i - \\bar{x})(y_i - \\bar{y})$ 并计算 $\\alpha = S_{xy} / S_{xx}$ 和 $E_0 = \\bar{y} - \\alpha \\bar{x}$。\n5.  计算总平方和 $\\text{SST} = \\sum (y_i - \\bar{y})^2$。\n6.  计算残差平方和 $\\text{SSR} = \\sum (y_i - (E_0 + \\alpha x_i))^2$。\n7.  使用公式 $R^2 = 1 - \\text{SSR}/\\text{SST}$ 计算 $R^2$，并应用处理 $\\text{SST}$ 为零情况的规定规则。\n8.  收集结果三元组 $[\\alpha, E_0, R^2]$，将每个值四舍五入到六位小数，并按规定格式化最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs an Ordinary Least Squares fit for the Brønsted-Evans-Polanyi\n    relationship on several datasets and formats the output.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a list of (E_a, Delta_E) pairs in eV.\n    test_cases = [\n        # Case 1\n        [(1.0, 0.5), (0.8, 0.2), (0.5, -0.3)],\n        # Case 2\n        [(0.87, 0.4), (0.64, 0.0), (0.55, -0.2), (0.38, -0.6)],\n        # Case 3\n        [(0.761, 0.100), (0.7591, 0.101), (0.7599, 0.099)],\n        # Case 4\n        [(0.22, -0.5), (0.73, 0.2), (1.25, 0.6)],\n        # Case 5\n        [(0.40, -1.0), (0.80, 0.0), (1.20, 1.0)],\n    ]\n\n    results = []\n    \n    # A small tolerance for floating point comparisons to zero.\n    TOLERANCE = 1e-12\n\n    for case_data in test_cases:\n        # Unpack data into E_a (y) and Delta_E (x)\n        # Note: The problem gives (Ea, DeltaE), so y is first and x is second.\n        data = np.array(case_data)\n        y = data[:, 0]  # Activation energy E_a\n        x = data[:, 1]  # Reaction energy Delta_E\n        \n        n = len(x)\n        \n        # Calculate means\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n        \n        # Calculate sum of squared deviations for the independent variable x\n        s_xx = np.sum((x - x_mean)**2)\n        \n        # Handle the case where the variance of Delta_E is zero\n        if s_xx  TOLERANCE:\n            alpha = 0.0\n            e0 = y_mean\n        else:\n            # Calculate sum of products of deviations\n            s_xy = np.sum((x - x_mean) * (y - y_mean))\n            \n            # Calculate slope (alpha) and intercept (e0)\n            alpha = s_xy / s_xx\n            e0 = y_mean - alpha * x_mean\n            \n        # Calculate the coefficient of determination (R^2)\n        # Total Sum of Squares (SST)\n        sst = np.sum((y - y_mean)**2)\n        \n        # Residual Sum of Squares (SSR)\n        y_pred = e0 + alpha * x\n        ssr = np.sum((y - y_pred)**2)\n        \n        # Handle special cases for R^2 calculation\n        if sst  TOLERANCE:\n            if ssr  TOLERANCE:\n                r_squared = 1.0\n            else:\n                r_squared = 0.0\n        else:\n            r_squared = 1.0 - (ssr / sst)\n            \n        # Round results to six decimal places\n        alpha_rounded = round(alpha, 6)\n        e0_rounded = round(e0, 6)\n        r_squared_rounded = round(r_squared, 6)\n        \n        results.append([alpha_rounded, e0_rounded, r_squared_rounded])\n\n    # Format the final output string\n    # e.g., [[alpha1,E01,R21],[alpha2,E02,R22],...]\n    formatted_results = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在基础拟合之上，本实践引入了一项关键的物理修正。电子结构计算通常忽略了原子核的量子效应，但零点能（Zero-Point Energy, ZPE）可以显著改变能垒和反应能。本练习  将演示如何将ZPE修正应用于原始电子能量，并探究这些修正如何系统地改变BEP关系的参数。",
            "id": "3870968",
            "problem": "一个表面介导的基元反应从一个明确的初始态（反应物，R）通过单一鞍点（过渡态，TS）进行到产物态（P）。在忽略原子核零点运动的周期性电子结构计算中，电子活化能垒和反应能分别为 $E_{a}^{\\mathrm{el}} = 0.80\\,\\mathrm{eV}$ 和 $\\Delta E^{\\mathrm{el}} = -0.20\\,\\mathrm{eV}$。独立的简正模式分析（谐振子近似）得到每个驻点的零点能（ZPE）校正值：$\\Delta \\mathrm{ZPE}_{R} = 0.10\\,\\mathrm{eV}$、$\\Delta \\mathrm{ZPE}_{\\mathrm{TS}} = 0.06\\,\\mathrm{eV}$ 和 $\\Delta \\mathrm{ZPE}_{P} = 0.04\\,\\mathrm{eV}$。先前针对该反应家族拟合的、基于不含ZPE的电子能量构建的Brønsted-Evans-Polanyi（BEP）线性自由能关系，其斜率为 $\\alpha = 0.60$。\n\n仅使用以下基本定义：(i) 活化能等于过渡态与反应物之间的能量差，(ii) 反应能等于产物与反应物之间的能量差，首先推导特定状态的ZPE校正如何修正 $E_{a}$ 和 $\\Delta E$。然后根据上述数据计算经ZPE校正的活化能垒 $E_{a}^{\\mathrm{corr}}$ 和反应能 $\\Delta E^{\\mathrm{corr}}$。最后，假设BEP斜率 $\\alpha$ 在ZPE校正后保持不变，计算由这些ZPE校正所隐含的BEP截距偏移量 $\\Delta E_{0} \\equiv E_{0}^{\\mathrm{corr}} - E_{0}^{\\mathrm{el}}$。\n\n将您的最终数值结果以单行矩阵的形式报告，矩阵中依次包含 $E_{a}^{\\mathrm{corr}}$、$\\Delta E^{\\mathrm{corr}}$ 和 $\\Delta E_{0}$。将所有三个数值四舍五入到四位有效数字，并以 $\\mathrm{eV}$ 为单位表示能量。",
            "solution": "用户要求验证问题陈述的有效性，如果问题被认为是有效的，则提供一个完整的解决方案。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 电子活化能垒：$E_{a}^{\\mathrm{el}} = 0.80\\,\\mathrm{eV}$\n- 电子反应能：$\\Delta E^{\\mathrm{el}} = -0.20\\,\\mathrm{eV}$\n- 反应物（R）的零点能（ZPE）校正值：$\\Delta \\mathrm{ZPE}_{R} = 0.10\\,\\mathrm{eV}$\n- 过渡态（TS）的零点能校正值：$\\Delta \\mathrm{ZPE}_{\\mathrm{TS}} = 0.06\\,\\mathrm{eV}$\n- 产物（P）的零点能校正值：$\\Delta \\mathrm{ZPE}_{P} = 0.04\\,\\mathrm{eV}$\n- Brønsted-Evans-Polanyi（BEP）斜率：$\\alpha = 0.60$\n- 活化能定义：$E_{a} = E_{\\mathrm{TS}} - E_{\\mathrm{R}}$\n- 反应能定义：$\\Delta E = E_{\\mathrm{P}} - E_{\\mathrm{R}}$\n- 任务1：推导ZPE校正如何修正 $E_{a}$ 和 $\\Delta E$。\n- 任务2：计算经ZPE校正的活化能垒 $E_{a}^{\\mathrm{corr}}$ 和反应能 $\\Delta E^{\\mathrm{corr}}$。\n- 任务3：计算BEP截距偏移量 $\\Delta E_{0} \\equiv E_{0}^{\\mathrm{corr}} - E_{0}^{\\mathrm{el}}$。\n- 输出格式：以行矩阵形式报告 $E_{a}^{\\mathrm{corr}}$、$\\Delta E^{\\mathrm{corr}}$ 和 $\\Delta E_{0}$，四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估：\n- **科学依据**：该问题基于计算化学和多相催化的基本概念，包括电子结构计算、谐振子近似下的零点能校正，以及线性自由能关系（特别是BEP关系）。所有概念和术语均为该领域的标准用法。所提供的能量值对于表面催化反应是物理上现实的。\n- **适定性**：问题陈述清晰、自洽，并提供了得出唯一解所需的所有数据和定义。所需计算逻辑有序且无歧义。\n- **客观性**：问题使用精确、定量和无偏见的语言进行陈述。它不含任何主观或推测性内容。\n\n基于此评估，问题陈述没有任何科学缺陷、不一致或含糊之处。这是一个在计算化学工程领域中有效且适定的问题。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将提供详细的解决方案。\n\n### 解答\n\n解决方案按照问题陈述的要求分三部分进行。\n\n**第1部分：ZPE校正能量表达式的推导**\n\n设 $E^{\\mathrm{el}}_{i}$ 是驻点 $i$（其中 $i \\in \\{R, TS, P\\}$）的电子能量，$\\Delta\\mathrm{ZPE}_{i}$ 是其对应的零点能校正值。经ZPE校正的总能量 $E^{\\mathrm{corr}}_{i}$ 是这两个分量的和：\n$$E^{\\mathrm{corr}}_{i} = E^{\\mathrm{el}}_{i} + \\Delta\\mathrm{ZPE}_{i}$$\n活化能 $E_a$ 和反应能 $\\Delta E$ 被定义为能量差。\n\n经ZPE校正的活化能垒 $E_a^{\\mathrm{corr}}$ 定义为过渡态和反应物的校正能量之差：\n$$E_a^{\\mathrm{corr}} = E^{\\mathrm{corr}}_{\\mathrm{TS}} - E^{\\mathrm{corr}}_{\\mathrm{R}}$$\n代入校正能量的表达式：\n$$E_a^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{TS}} + \\Delta\\mathrm{ZPE}_{\\mathrm{TS}}) - (E^{\\mathrm{el}}_{\\mathrm{R}} + \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\n重新整理各项，将电子能量和ZPE校正分开分组：\n$$E_a^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{TS}} - E^{\\mathrm{el}}_{\\mathrm{R}}) + (\\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\n根据定义，电子活化能垒为 $E_a^{\\mathrm{el}} = E^{\\mathrm{el}}_{\\mathrm{TS}} - E^{\\mathrm{el}}_{\\mathrm{R}}$。因此，校正活化能垒与电子活化能垒之间的关系是：\n$$E_a^{\\mathrm{corr}} = E_a^{\\mathrm{el}} + \\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\n\n同样，经ZPE校正的反应能 $\\Delta E^{\\mathrm{corr}}$ 定义为产物和反应物的校正能量之差：\n$$\\Delta E^{\\mathrm{corr}} = E^{\\mathrm{corr}}_{\\mathrm{P}} - E^{\\mathrm{corr}}_{\\mathrm{R}}$$\n代入校正能量的表达式：\n$$\\Delta E^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{P}} + \\Delta\\mathrm{ZPE}_{\\mathrm{P}}) - (E^{\\mathrm{el}}_{\\mathrm{R}} + \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\n重新整理各项：\n$$\\Delta E^{\\mathrm{corr}} = (E^{\\mathrm{el}}_{\\mathrm{P}} - E^{\\mathrm{el}}_{\\mathrm{R}}) + (\\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\n根据定义，电子反应能为 $\\Delta E^{\\mathrm{el}} = E^{\\mathrm{el}}_{\\mathrm{P}} - E^{\\mathrm{el}}_{\\mathrm{R}}$。因此，其关系为：\n$$\\Delta E^{\\mathrm{corr}} = \\Delta E^{\\mathrm{el}} + \\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\n至此完成所要求的推导。\n\n**第2部分：$E_a^{\\mathrm{corr}}$ 和 $\\Delta E^{\\mathrm{corr}}$ 的计算**\n\n使用推导出的公式和给定的数据：\n- $E_{a}^{\\mathrm{el}} = 0.80\\,\\mathrm{eV}$\n- $\\Delta E^{\\mathrm{el}} = -0.20\\,\\mathrm{eV}$\n- $\\Delta \\mathrm{ZPE}_{R} = 0.10\\,\\mathrm{eV}$\n- $\\Delta \\mathrm{ZPE}_{\\mathrm{TS}} = 0.06\\,\\mathrm{eV}$\n- $\\Delta \\mathrm{ZPE}_{P} = 0.04\\,\\mathrm{eV}$\n\n经ZPE校正的活化能垒为：\n$$E_a^{\\mathrm{corr}} = 0.80\\,\\mathrm{eV} + 0.06\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV} = 0.76\\,\\mathrm{eV}$$\n\n经ZPE校正的反应能为：\n$$\\Delta E^{\\mathrm{corr}} = -0.20\\,\\mathrm{eV} + 0.04\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV} = -0.26\\,\\mathrm{eV}$$\n\n**第3部分：BEP截距偏移量 $\\Delta E_0$ 的计算**\n\nBrønsted-Evans-Polanyi关系是一个线性模型，形式为 $E_a = \\alpha \\Delta E + E_0$，其中 $\\alpha$ 是斜率， $E_0$ 是截距。\n\n对于电子能量，该关系式为：\n$$E_a^{\\mathrm{el}} = \\alpha \\Delta E^{\\mathrm{el}} + E_0^{\\mathrm{el}}$$\n因此，截距为 $E_0^{\\mathrm{el}} = E_a^{\\mathrm{el}} - \\alpha \\Delta E^{\\mathrm{el}}$。\n\n对于经ZPE校正的能量，假设斜率 $\\alpha$ 不变：\n$$E_a^{\\mathrm{corr}} = \\alpha \\Delta E^{\\mathrm{corr}} + E_0^{\\mathrm{corr}}$$\n截距为 $E_0^{\\mathrm{corr}} = E_a^{\\mathrm{corr}} - \\alpha \\Delta E^{\\mathrm{corr}}$。\n\n截距的偏移量 $\\Delta E_0$ 定义为 $\\Delta E_0 = E_0^{\\mathrm{corr}} - E_0^{\\mathrm{el}}$。代入截距的表达式：\n$$\\Delta E_0 = (E_a^{\\mathrm{corr}} - \\alpha \\Delta E^{\\mathrm{corr}}) - (E_a^{\\mathrm{el}} - \\alpha \\Delta E^{\\mathrm{el}})$$\n$$\\Delta E_0 = (E_a^{\\mathrm{corr}} - E_a^{\\mathrm{el}}) - \\alpha (\\Delta E^{\\mathrm{corr}} - \\Delta E^{\\mathrm{el}})$$\n从第1部分可知，差值 $(E_a^{\\mathrm{corr}} - E_a^{\\mathrm{el}})$ 和 $(\\Delta E^{\\mathrm{corr}} - \\Delta E^{\\mathrm{el}})$ 为：\n$$E_a^{\\mathrm{corr}} - E_a^{\\mathrm{el}} = \\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\n$$\\Delta E^{\\mathrm{corr}} - \\Delta E^{\\mathrm{el}} = \\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}$$\n将这些代入 $\\Delta E_0$ 的表达式：\n$$\\Delta E_0 = (\\Delta\\mathrm{ZPE}_{\\mathrm{TS}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}}) - \\alpha (\\Delta\\mathrm{ZPE}_{\\mathrm{P}} - \\Delta\\mathrm{ZPE}_{\\mathrm{R}})$$\n现在，我们代入给定的数值：$\\alpha=0.60$，$\\Delta\\mathrm{ZPE}_{\\mathrm{R}}=0.10\\,\\mathrm{eV}$，$\\Delta\\mathrm{ZPE}_{\\mathrm{TS}}=0.06\\,\\mathrm{eV}$，以及 $\\Delta\\mathrm{ZPE}_{\\mathrm{P}}=0.04\\,\\mathrm{eV}$。\n$$\\Delta E_0 = (0.06\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV}) - 0.60 \\times (0.04\\,\\mathrm{eV} - 0.10\\,\\mathrm{eV})$$\n$$\\Delta E_0 = (-0.04\\,\\mathrm{eV}) - 0.60 \\times (-0.06\\,\\mathrm{eV})$$\n$$\\Delta E_0 = -0.04\\,\\mathrm{eV} + 0.036\\,\\mathrm{eV}$$\n$$\\Delta E_0 = -0.004\\,\\mathrm{eV}$$\n\n按要求将最终结果四舍五入到四位有效数字：\n$E_a^{\\mathrm{corr}} = 0.7600\\,\\mathrm{eV}$\n$\\Delta E^{\\mathrm{corr}} = -0.2600\\,\\mathrm{eV}$\n$\\Delta E_0 = -0.004000\\,\\mathrm{eV}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7600  -0.2600  -0.004000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的催化体系中，单一的BEP关系可能不足以描述通过不同机理进行的反应。这项高级实践  旨在解决一个常见的研究问题：如何判断是应该用独立的BEP关系来分别建模不同的反应类别，还是用一个统一的关系来描述所有数据。您将使用赤池信息准则（Akaike Information Criterion, AIC）作为模型选择的严谨统计工具，这是构建预测性微动力学模型的关键技能。",
            "id": "3870994",
            "problem": "给定一组在后过渡金属催化剂上发生的碳氢键活化步骤的密度泛函理论 (DFT) 计算的反应能和活化能垒，其中每个数据点都标有一个机理类别。提供的两个机理标签是氧化加成和 sigma-键复分解。你的任务是设计并实现一个协议，该协议针对每个机理类别以及合并的数据集，估计从反应能到活化能垒的最佳线性映射，该映射由斜率和截距表征。该协议必须基于经过充分检验的过渡态理论原理和具有物理动机的能景论证，并且必须评估相对于单一的合并拟合，尊重机理分组的模型拟合是否至关重要。\n\n使用以下背景知识作为你推理和算法设计的基础，但不要直接陈述或使用目标概念作为给定的公式。过渡态理论 (TST) 指出，一个基元步骤的速率常数 $k$ 为 $k = A \\exp\\left(-E_a/(k_B T)\\right)$，其中 $A$ 是指前因子，$E_a$ 是活化能垒，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。对于热活化过程的经验和理论观察表明，反应热化学 $\\Delta E$ 的变化和过渡态沿反应坐标的位置共同调节能垒的高度。能垒和热化学之间的仿射线性关系可以通过围绕参考反应能对能垒进行局部展开，并结合关于过渡态移动的 Hammond 型论证来得到。普通最小二乘法 (OLS) 是在高斯残差假设下估计测量输入和输出之间线性映射的标准方法。为了比较机理分组是否至关重要，请使用 Akaike Information Criterion (AIC)，其定义为 $\\mathrm{AIC} = n \\ln\\left(\\mathrm{RSS}/n\\right) + 2k$，其中 $n$ 是观测值的数量，$\\mathrm{RSS}$ 是残差平方和，$k$ 是拟合参数的数量。\n\n按如下方式实现协议：\n- 根据机理标签划分数据集，并考虑包含所有数据点的合并数据集。\n- 对于每个划分，使用普通最小二乘法估计从 $\\Delta E$ 到 $E_a$ 的最佳仿射映射的斜率 $\\alpha$ 和截距 $E_0$。\n- 计算每个划分的残差平方和 $\\mathrm{RSS}$ 和 Akaike Information Criterion $\\mathrm{AIC}$。\n- 将分组 $\\mathrm{AIC}$ 总和（定义为各机理划分上 $\\mathrm{AIC}$ 值的总和）与合并 $\\mathrm{AIC}$ 进行比较。定义一个布尔改进标志，如果分组 $\\mathrm{AIC}$ 严格小于合并 $\\mathrm{AIC}$，则该标志为 $1$，否则为 $0$。\n\n单位和数值要求：\n- 所有能量 $\\Delta E$ 和 $E_a$ 均以电子伏特 (eV) 为单位提供。报告 $E_0$ 时以电子伏特 (eV) 为单位，$\\alpha$ 为无量纲值。将 $\\mathrm{AIC}$ 报告为无量纲浮点数。\n- 将所有浮点输出四舍五入到4位小数。\n- 本问题不涉及角度。\n\n测试套件：\n请严格使用以下标记数据集，不要修改数值。对于氧化加成 (OA)，使用 $\\Delta E\\,\\mathrm{(eV)} = [\\,0.10,\\,0.30,\\,0.50,\\,0.70,\\,0.90\\,]$ 和 $E_a\\,\\mathrm{(eV)} = [\\,0.425,\\,0.540,\\,0.675,\\,0.820,\\,0.915\\,]$。对于 sigma-键复分解 (SBM)，使用 $\\Delta E\\,\\mathrm{(eV)} = [\\,-0.20,\\,0.00,\\,0.20,\\,0.40,\\,0.60\\,]$ 和 $E_a\\,\\mathrm{(eV)} = [\\,0.790,\\,0.860,\\,0.890,\\,0.970,\\,1.015\\,]$。SBM 数据集包含边界情况 $\\Delta E = 0.00$，这可以用于测试对截距的解释。合并的数据集是 OA 和 SBM 数据集的拼接。\n\n最终输出规范：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序必须严格如下：\n$[\\alpha_{\\mathrm{OA}},\\,E_{0,\\mathrm{OA}},\\,\\alpha_{\\mathrm{SBM}},\\,E_{0,\\mathrm{SBM}},\\,\\alpha_{\\mathrm{all}},\\,E_{0,\\mathrm{all}},\\,\\mathrm{AIC}_{\\mathrm{grouped}},\\,\\mathrm{AIC}_{\\mathrm{pooled}},\\,\\mathrm{improvement\\_flag}\\,]$,\n其中 $\\alpha_{\\mathrm{OA}}$ 和 $E_{0,\\mathrm{OA}}$ 是氧化加成的斜率和截距，$\\alpha_{\\mathrm{SBM}}$ 和 $E_{0,\\mathrm{SBM}}$ 是 sigma-键复分解的斜率和截距，$\\alpha_{\\mathrm{all}}$ 和 $E_{0,\\mathrm{all}}$ 是合并数据集的斜率和截距，$\\mathrm{AIC}_{\\mathrm{grouped}}$ 是分组 AIC 值的总和，$\\mathrm{AIC}_{\\mathrm{pooled}}$ 是合并模型的 AIC，$\\mathrm{improvement\\_flag}$ 是整数 $0$ 或 $1$。所有浮点值必须四舍五入到4位小数。输出必须严格遵循格式示例 $[\\,0.1234,0.5678,0.1234,0.5678,0.1234,0.5678,-12.3456,-12.3456,1\\,]$。",
            "solution": "该问题要求设计并实现一个计算协议，用于分析两类催化反应——氧化加成 (OA) 和 sigma-键复分解 (SBM)——的反应能 ($\\Delta E$) 与活化能垒 ($E_a$) 之间的关系。核心任务是为每个类别和合并的数据集确定最佳拟合的仿射映射 $E_a = \\alpha \\Delta E + E_0$，然后使用 Akaike Information Criterion (AIC) 来评估与合并数据的单一模型相比，将两个机理类别分开处理是否能提供一个统计上更优的模型。这种类型的线性关系是催化领域的一块基石，被称为 Brønsted-Evans-Polanyi (BEP) 关系。\n\n该协议的基础建立在两个关键原则之上：通过普通最小二乘法 (OLS) 进行线性回归以实现参数估计，以及使用 AIC 进行模型选择。\n\n首先，我们处理参数 $\\alpha$ (BEP 斜率) 和 $E_0$ (内在活化能垒) 的估计。对于一个给定的包含 $n$ 个数据点 $(\\Delta E_i, E_{a,i})$ 的数据集，OLS 的目标是找到一条线，使数据点与该线之间的垂直距离的平方和最小化。这个量就是残差平方和 (RSS)：\n$$ \\mathrm{RSS} = \\sum_{i=1}^{n} (E_{a,i} - (\\alpha \\Delta E_i + E_0))^2 $$\n最小化此函数的 $\\alpha$ 和 $E_0$ 的值可以解析地找到。给定样本均值 $\\overline{\\Delta E} = \\frac{1}{n}\\sum_{i=1}^{n} \\Delta E_i$ 和 $\\overline{E_a} = \\frac{1}{n}\\sum_{i=1}^{n} E_{a,i}$，最优参数为：\n$$ \\alpha = \\frac{\\sum_{i=1}^{n} (\\Delta E_i - \\overline{\\Delta E})(E_{a,i} - \\overline{E_a})}{\\sum_{i=1}^{n} (\\Delta E_i - \\overline{\\Delta E})^2} $$\n$$ E_0 = \\overline{E_a} - \\alpha \\overline{\\Delta E} $$\n参数 $E_0$ 表示当反应是热中性 ($\\Delta E = 0$) 时的活化能垒，而 $\\alpha$ 量化了活化能垒对反应热化学变化的敏感度。根据 Hammond's Postulate，$\\alpha$ 通常被解释为衡量过渡态沿反应坐标位置的指标，其值通常在 $0$ 和 $1$ 之间。\n\n其次，我们必须比较两种相互竞争的建模假设：(1) “分组”模型，其中 OA 和 SBM 反应由独立的 BEP 关系描述；(2) “合并”模型，其中单一的 BEP 关系描述所有数据点，不考虑其机理。Akaike Information Criterion (AIC) 为这种比较提供了一种方法。AIC 评估了拟合优度 (较低的 RSS) 和模型复杂度 (拟合参数的数量) 之间的权衡。其公式如下：\n$$ \\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{RSS}}{n}\\right) + 2k $$\n这里，$n$ 是数据点的数量，$\\mathrm{RSS}$ 是 OLS 拟合的残差平方和，$k$ 是模型中的参数数量。对于我们的仿射模型 $E_a = \\alpha \\Delta E + E_0$，我们估计两个参数 ($\\alpha$ 和 $E_0$)，因此 $k=2$。较低的 AIC 值表示更好的模型，表明它在不过于复杂的情况下实现了良好的拟合。\n\n计算协议将按以下步骤进行：\n1.  定义一个函数，该函数接受一组 $\\Delta E$ 和 $E_a$ 数据。该函数将：\n    a. 计算 OLS 参数 $\\alpha$ 和 $E_0$。\n    b. 计算预测的活化能垒 $\\hat{E}_{a,i} = \\alpha \\Delta E_i + E_0$。\n    c. 根据真实能垒和预测能垒计算 RSS。\n    d. 使用点数 $n$ 和参数数 $k=2$ 来计算 AIC。\n    e. 返回计算出的 $\\alpha$、$E_0$ 和 AIC。\n2.  该函数将被应用三次：\n    a. 应用于氧化加成 (OA) 数据，得到 $\\alpha_{\\mathrm{OA}}$、$E_{0,\\mathrm{OA}}$ 和 $\\mathrm{AIC}_{\\mathrm{OA}}$。\n    b. 应用于 sigma-键复分解 (SBM) 数据，得到 $\\alpha_{\\mathrm{SBM}}$、$E_{0,\\mathrm{SBM}}$ 和 $\\mathrm{AIC}_{\\mathrm{SBM}}$。\n    c. 应用于合并数据集 (拼接的 OA 和 SBM 数据)，得到 $\\alpha_{\\mathrm{all}}$、$E_{0,\\mathrm{all}}$ 和 $\\mathrm{AIC}_{\\mathrm{pooled}}$。\n3.  分组模型的总 AIC 定义为各个 AIC 的总和：\n    $$ \\mathrm{AIC}_{\\mathrm{grouped}} = \\mathrm{AIC}_{\\mathrm{OA}} + \\mathrm{AIC}_{\\mathrm{SBM}} $$\n    这种方法正确地表示了拟合两个独立模型所带来的信息损失。\n4.  最后，我们比较两种建模策略。如果分组模型更优（即具有严格更低的 AIC 值），则将改进标志设置为 $1$，否则设置为 $0$。\n    $$ \\mathrm{improvement\\_flag} = \\begin{cases} 1  \\text{ if } \\mathrm{AIC}_{\\mathrm{grouped}}  \\mathrm{AIC}_{\\mathrm{pooled}} \\\\ 0  \\text{ otherwise} \\end{cases} $$\n    标志为 $1$ 意味着机理上的区别在统计上是有意义的，并且数据支持对 OA 和 SBM 使用独立的模型。所有浮点结果将按要求四舍五入到四位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Note: scipy is permitted but not required for this problem,\n# as np.polyfit is sufficient for ordinary least squares.\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting Brønsted-Evans-Polanyi relationships for\n    catalytic C-H activation and comparing model performance using AIC.\n    \"\"\"\n    # Define the datasets from the problem statement.\n    test_cases = {\n        \"OA\": {\n            \"delta_e\": np.array([0.10, 0.30, 0.50, 0.70, 0.90]),\n            \"e_a\": np.array([0.425, 0.540, 0.675, 0.820, 0.915]),\n        },\n        \"SBM\": {\n            \"delta_e\": np.array([-0.20, 0.00, 0.20, 0.40, 0.60]),\n            \"e_a\": np.array([0.790, 0.860, 0.890, 0.970, 1.015]),\n        },\n    }\n\n    # Combine datasets for the pooled analysis\n    pooled_delta_e = np.concatenate([test_cases[\"OA\"][\"delta_e\"], test_cases[\"SBM\"][\"delta_e\"]])\n    pooled_e_a = np.concatenate([test_cases[\"OA\"][\"e_a\"], test_cases[\"SBM\"][\"e_a\"]])\n    \n    test_cases[\"all\"] = {\n        \"delta_e\": pooled_delta_e,\n        \"e_a\": pooled_e_a,\n    }\n\n    def perform_regression_analysis(delta_e, e_a):\n        \"\"\"\n        Performs OLS regression and calculates AIC for a given dataset.\n\n        Args:\n            delta_e (np.ndarray): Reaction energies (independent variable).\n            e_a (np.ndarray): Activation barriers (dependent variable).\n\n        Returns:\n            tuple: Contains slope (alpha), intercept (E0), and AIC.\n        \"\"\"\n        # Number of data points\n        n = len(delta_e)\n        # Number of fitted parameters for an affine model (slope, intercept)\n        k = 2\n\n        # Use numpy.polyfit for Ordinary Least Squares to find slope (alpha) and intercept (E0)\n        # It returns coefficients in descending power order, so [slope, intercept] for degree 1\n        alpha, e0 = np.polyfit(delta_e, e_a, 1)\n\n        # Calculate predicted activation barriers\n        e_a_predicted = alpha * delta_e + e0\n\n        # Calculate Residual Sum of Squares (RSS)\n        rss = np.sum((e_a - e_a_predicted)**2)\n\n        # Calculate Akaike Information Criterion (AIC)\n        # Use a small epsilon to avoid log(0) in case of a perfect fit\n        if rss = 0:\n            aic = -np.inf\n        else:\n            aic = n * np.log(rss / n) + 2 * k\n        \n        return alpha, e0, aic\n\n    # Perform analysis for each partition\n    alpha_oa, e0_oa, aic_oa = perform_regression_analysis(test_cases[\"OA\"][\"delta_e\"], test_cases[\"OA\"][\"e_a\"])\n    alpha_sbm, e0_sbm, aic_sbm = perform_regression_analysis(test_cases[\"SBM\"][\"delta_e\"], test_cases[\"SBM\"][\"e_a\"])\n    alpha_all, e0_all, aic_pooled = perform_regression_analysis(test_cases[\"all\"][\"delta_e\"], test_cases[\"all\"][\"e_a\"])\n\n    # Calculate total grouped AIC as the sum of individual AICs\n    aic_grouped = aic_oa + aic_sbm\n\n    # Determine if the grouped model is an improvement\n    improvement_flag = 1 if aic_grouped  aic_pooled else 0\n\n    # Collect all results\n    results = [\n        alpha_oa, e0_oa,\n        alpha_sbm, e0_sbm,\n        alpha_all, e0_all,\n        aic_grouped, aic_pooled,\n        improvement_flag,\n    ]\n\n    # Format the results for output\n    formatted_results = []\n    for res in results:\n        if isinstance(res, (float, np.floating)):\n            formatted_results.append(f\"{res:.4f}\")\n        else:\n            formatted_results.append(str(res))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}