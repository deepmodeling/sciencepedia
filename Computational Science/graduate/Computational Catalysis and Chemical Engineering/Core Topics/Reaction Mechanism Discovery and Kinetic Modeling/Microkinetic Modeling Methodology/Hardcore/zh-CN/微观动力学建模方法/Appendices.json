{
    "hands_on_practices": [
        {
            "introduction": "微观动力学模型的核心是热力学自洽性，它通过细致平衡原理 (principle of detailed balance) 得以保证。该原理建立了动力学（速率常数）和热力学（吉布斯自由能 $G$）之间的根本联系，确保模型在平衡状态下不会产生矛盾。本练习将引导你应用这一定律，通过给定的正向速率常数和反应吉布斯自由能计算逆向速率常数 ()，这是构建任何有效微观动力学模型的基础步骤。",
            "id": "3887601",
            "problem": "我们为单中心金属表面构建了一个催化微动力学模型，该模型使用基于活度的质量作用动力学，其中气相活度定义为 $a_{i} = p_{i}/p^{\\circ}$（$p^{\\circ} = 1.0 \\times 10^{5}\\ \\mathrm{Pa}$），表面活度为位点分数（无量纲）。模型中所有的动力学速率常数都定义为与无量纲活度相乘，因此它们的单位是 $\\mathrm{s}^{-1}$。温度为 $T = 600\\ \\mathrm{K}$。考虑以下三个可逆基元步骤，其中反应的标准吉布斯自由能 $\\Delta G^{\\circ}$ 的符号约定是针对所写的正向反应方向：\n\n1. 表面异构化：$\\mathrm{A}^{*} \\rightleftharpoons \\mathrm{B}^{*}$，正向速率常数为 $k_{\\mathrm{f},1} = 2.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$ 且 $\\Delta G_{1}^{\\circ} = -12.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}$。\n\n2. 有位点守恒的表面反应：$\\mathrm{A}^{*} + \\mathrm{B}^{*} \\rightleftharpoons \\mathrm{C}^{*} + *$，正向速率常数为 $k_{\\mathrm{f},2} = 5.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$ 且 $\\Delta G_{2}^{\\circ} = +5.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}$。\n\n3. 可逆吸附：$\\mathrm{G}(\\mathrm{g}) + * \\rightleftharpoons \\mathrm{G}^{*}$，正向速率常数为 $k_{\\mathrm{f},3} = 1.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$ 且 $\\Delta G_{3}^{\\circ} = -20.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}$。\n\n假设理想行为和热力学一致性。通过使用平衡常数在指定温度下用标准反应吉布斯自由能表示的热力学定义，对每个基元步骤强制执行细致平衡。根据所述的活度约定，计算与细致平衡一致的逆向速率常数 $k_{\\mathrm{r},i}$（$i = 1,2,3$）。使用通用气体常数 $R = 8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$。将每个 $k_{\\mathrm{r},i}$ 以 $\\mathrm{s}^{-1}$ 为单位表示，并将最终数值四舍五入至三位有效数字。按步骤 1–3 的顺序，将最终答案以行向量的形式呈现。",
            "solution": "该问题要求计算催化循环中三个基元步骤的逆向速率常数 $k_{\\mathrm{r},i}$，并通过细致平衡原理强制实现热力学一致性。\n\n基元反应的细致平衡原理规定，在平衡状态下，正向速率等于逆向速率。这导出了正向速率常数（$k_{\\mathrm{f}}$）、逆向速率常数（$k_{\\mathrm{r}}$）和平衡常数（$K$）之间的关系。对于任何基元步骤，此关系由下式给出：\n$$K = \\frac{k_{\\mathrm{f}}}{k_{\\mathrm{r}}}$$\n$K$ 用速率常数表示的公式取决于速率的定义方式。此处，速率基于使用无量纲活度（表面物种的位点分数和气相物种的归一化分压 $p_i/p^{\\circ}$）的质量作用动力学。这会得到一个无量纲的平衡常数 $K$。\n\n热力学提供了平衡常数的一个独立定义，用标准反应吉布斯自由能 $\\Delta G^{\\circ}$ 和绝对温度 $T$ 表示：\n$$K = \\exp\\left(-\\frac{\\Delta G^{\\circ}}{RT}\\right)$$\n其中 $R$ 是通用气体常数。$\\Delta G^{\\circ}$ 的标准态必须与活度的定义一致，本题中情况即是如此（气体的标准压力为 $p^{\\circ} = 1.0 \\times 10^{5}\\ \\mathrm{Pa}$，表面物种的覆盖度为纯组分）。\n\n通过将平衡常数的动力学表达式和热力学表达式相等，我们得到：\n$$\\frac{k_{\\mathrm{f}}}{k_{\\mathrm{r}}} = \\exp\\left(-\\frac{\\Delta G^{\\circ}}{RT}\\right)$$\n该方程可以重新排列以求解逆向速率常数 $k_{\\mathrm{r}}$：\n$$k_{\\mathrm{r}} = k_{\\mathrm{f}} \\exp\\left(\\frac{\\Delta G^{\\circ}}{RT}\\right)$$\n这个核心关系将应用于三个基元步骤中的每一个。\n\n给定的常数是温度 $T = 600\\ \\mathrm{K}$ 和通用气体常数 $R = 8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$。乘积 $RT$ 为：\n$$RT = (8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}) \\times (600\\ \\mathrm{K}) = 4988.6775708\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}$$\n$\\Delta G^{\\circ}$ 的值以 $\\mathrm{kJ}\\ \\mathrm{mol}^{-1}$ 给出，为了保持单位一致性，必须乘以 $1000$ 将其转换为 $\\mathrm{J}\\ \\mathrm{mol}^{-1}$。\n\n我们现在开始计算每个步骤 $i=1, 2, 3$ 的 $k_{\\mathrm{r},i}$。\n\n步骤 1：表面异构化，$\\mathrm{A}^{*} \\rightleftharpoons \\mathrm{B}^{*}$\n给定的参数是：\n$k_{\\mathrm{f},1} = 2.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$\n$\\Delta G_{1}^{\\circ} = -12.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1} = -12000\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}$\n使用推导出的公式：\n$$k_{\\mathrm{r},1} = k_{\\mathrm{f},1} \\exp\\left(\\frac{\\Delta G_{1}^{\\circ}}{RT}\\right) = (2.0 \\times 10^{3}\\ \\mathrm{s}^{-1}) \\times \\exp\\left(\\frac{-12000\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}}{4988.6775708\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}}\\right)$$\n$$k_{\\mathrm{r},1} \\approx (2.0 \\times 10^{3}) \\times \\exp(-2.4056) \\approx (2.0 \\times 10^{3}) \\times 0.090209 = 180.418\\ \\mathrm{s}^{-1}$$\n四舍五入到三位有效数字，我们得到：\n$$k_{\\mathrm{r},1} = 1.80 \\times 10^{2}\\ \\mathrm{s}^{-1}$$\n\n步骤 2：表面反应，$\\mathrm{A}^{*} + \\mathrm{B}^{*} \\rightleftharpoons \\mathrm{C}^{*} + *$\n给定的参数是：\n$k_{\\mathrm{f},2} = 5.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$\n$\\Delta G_{2}^{\\circ} = +5.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1} = +5000\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}$\n使用该公式：\n$$k_{\\mathrm{r},2} = k_{\\mathrm{f},2} \\exp\\left(\\frac{\\Delta G_{2}^{\\circ}}{RT}\\right) = (5.0 \\times 10^{2}\\ \\mathrm{s}^{-1}) \\times \\exp\\left(\\frac{5000\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}}{4988.6775708\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}}\\right)$$\n$$k_{\\mathrm{r},2} \\approx (5.0 \\times 10^{2}) \\times \\exp(1.00227) \\approx (5.0 \\times 10^{2}) \\times 2.72444 = 1362.22\\ \\mathrm{s}^{-1}$$\n四舍五入到三位有效数字，我们得到：\n$$k_{\\mathrm{r},2} = 1.36 \\times 10^{3}\\ \\mathrm{s}^{-1}$$\n\n步骤 3：可逆吸附，$\\mathrm{G}(\\mathrm{g}) + * \\rightleftharpoons \\mathrm{G}^{*}$\n给定的参数是：\n$k_{\\mathrm{f},3} = 1.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$\n$\\Delta G_{3}^{\\circ} = -20.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1} = -20000\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}$\n使用该公式：\n$$k_{\\mathrm{r},3} = k_{\\mathrm{f},3} \\exp\\left(\\frac{\\Delta G_{3}^{\\circ}}{RT}\\right) = (1.0 \\times 10^{4}\\ \\mathrm{s}^{-1}) \\times \\exp\\left(\\frac{-20000\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}}{4988.6775708\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}}\\right)$$\n$$k_{\\mathrm{r},3} \\approx (1.0 \\times 10^{4}) \\times \\exp(-4.00938) \\approx (1.0 \\times 10^{4}) \\times 0.0181905 = 181.905\\ \\mathrm{s}^{-1}$$\n四舍五入到三位有效数字，我们得到：\n$$k_{\\mathrm{r},3} = 1.82 \\times 10^{2}\\ \\mathrm{s}^{-1}$$\n\n计算出的逆向速率常数，四舍五入到三位有效数字后，分别为 $k_{\\mathrm{r},1} = 1.80 \\times 10^{2}\\ \\mathrm{s}^{-1}$，$k_{\\mathrm{r},2} = 1.36 \\times 10^{3}\\ \\mathrm{s}^{-1}$ 和 $k_{\\mathrm{r},3} = 1.82 \\times 10^{2}\\ \\mathrm{s}^{-1}$。根据要求，这些值以行向量的形式呈现。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.80 \\times 10^{2}  1.36 \\times 10^{3}  1.82 \\times 10^{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "完整的微观动力学模型虽然精确，但其复杂性往往掩盖了关键的动力学关系。为了获得可解析的速率方程并洞察反应机理，化学家们常常采用准稳态近似 (Quasi-Steady-State Approximation, QSSA) 和准平衡近似 (Quasi-Equilibrium Approximation, QE)。本练习 () 要求你从基本原理出发，对一个多步反应机理应用这些近似方法，推导出简化的速率表达式，并通过编程计算来检验其在不同条件下的有效性。",
            "id": "3887624",
            "problem": "考虑以下在具有单一类型活性位点的催化表面上形成气相产物的微观动力学模型，其中活性位点用空位符号 $*$ 表示。该机理包含 $3$ 个步骤：\n- 步骤 $(1)$：$A(g) + * \\rightleftharpoons A*$（$A(g)$ 的分子吸附/脱附），\n- 步骤 $(2)$：$A* + B(g) \\rightleftharpoons I*$（表面反应生成活性中间体 $I*$），\n- 步骤 $(3)$：$I* \\rightarrow P(g) + *$（不可逆分解/脱附生成产物）。\n\n假设理想气体行为和基于质量作用定律的平均场位点平均动力学。令 $\\theta_A$ 表示 $A*$ 的分数覆盖度，$\\theta_I$ 表示 $I*$ 的分数覆盖度，$\\theta_*$ 表示空位点的分数覆盖度。位点守恒为 $\\theta_* + \\theta_A + \\theta_I = 1$。令 $P_A$ 和 $P_B$ 分别为 $A(g)$ 和 $B(g)$ 的分压，单位为 $\\mathrm{bar}$。动力学参数如下：\n- $A(g)$ 的吸附/脱附：正向速率常数 $k_{1f}$，单位为 $\\mathrm{bar}^{-1}\\ \\mathrm{s}^{-1}$；逆向速率常数 $k_{1r}$，单位为 $\\mathrm{s}^{-1}$，\n- 生成及从 $I*$ 返回的表面反应：正向速率常数 $k_{2f}$，单位为 $\\mathrm{bar}^{-1}\\ \\mathrm{s}^{-1}$；逆向速率常数 $k_{2r}$，单位为 $\\mathrm{s}^{-1}$，\n- $I*$ 的不可逆分解：速率常数 $k_3$，单位为 $\\mathrm{s}^{-1}$。\n\n由质量作用定律和位点守恒导出的完整平均场常微分方程 (ODE) 模型为\n$$\n\\frac{d\\theta_A}{dt} = k_{1f} P_A \\theta_* - k_{1r} \\theta_A - k_{2f} P_B \\theta_A + k_{2r} \\theta_I,\n$$\n$$\n\\frac{d\\theta_I}{dt} = k_{2f} P_B \\theta_A - k_{2r} \\theta_I - k_3 \\theta_I,\n$$\n其中 $\\theta_* = 1 - \\theta_A - \\theta_I$。每个位点的稳态产物生成速率为 $r_{\\mathrm{full}} = k_3 \\theta_I^{ss}$，单位为每个位点 $\\mathrm{s}^{-1}$，其中 $\\theta_I^{ss}$ 表示 $\\theta_I$ 的稳态值。\n\n任务：\n1. 仅从上述基本要素（质量作用定律、位点守恒和定义）出发，对步骤 $(1)$ 应用准平衡 (QE) 近似，对活性中间体 $I*$ 应用准稳态近似 (QSSA)，以获得每个位点产物生成速率的简化显式速率表达式 $r_{\\mathrm{red}}$，单位为 $\\mathrm{s}^{-1}$。你的推导必须从第一性原理出发，除了已给出的定义外，不引入任何额外的简化公式。\n2. 实现一个程序，对下面列出的每个测试条件，根据你的简化表达式计算 $r_{\\mathrm{red}}$，并通过求解 ODE 模型所蕴含的完整稳态方程计算 $r_{\\mathrm{full}}$。然后计算绝对相对误差 $E = \\lvert r_{\\mathrm{red}} - r_{\\mathrm{full}} \\rvert / r_{\\mathrm{full}}$ 并以小数形式表示。\n3. 将所有测试用例的最终数值答案表示为单行，包含一个用方括号括起来的、以逗号分隔的列表，其中每个条目是对应的绝对相对误差 $E$ 四舍五入到 $6$ 位小数的值。不应打印任何其他文本。\n\n使用以下参数集测试套件。对于每种情况，元组列出了 $(P_A\\ [\\mathrm{bar}],\\ P_B\\ [\\mathrm{bar}],\\ k_{1f}\\ [\\mathrm{bar}^{-1}\\mathrm{s}^{-1}],\\ k_{1r}\\ [\\mathrm{s}^{-1}],\\ k_{2f}\\ [\\mathrm{bar}^{-1}\\mathrm{s}^{-1}],\\ k_{2r}\\ [\\mathrm{s}^{-1}],\\ k_3\\ [\\mathrm{s}^{-1}])$：\n\n- 情况 $1$ (快速吸附 QE，中等条件)：$(0.1,\\ 0.1,\\ 1.0\\times 10^{5},\\ 1.0\\times 10^{2},\\ 1.0\\times 10^{5},\\ 1.0\\times 10^{3},\\ 10.0)$。\n- 情况 $2$ (低压极限)：$(1.0\\times 10^{-6},\\ 2.0\\times 10^{-6},\\ 1.0\\times 10^{5},\\ 1.0\\times 10^{2},\\ 1.0\\times 10^{5},\\ 1.0\\times 10^{3},\\ 10.0)$。\n- 情况 $3$ (近饱和区域)：$(1.0,\\ 1.0,\\ 1.0\\times 10^{5},\\ 1.0\\times 10^{2},\\ 1.0\\times 10^{5},\\ 1.0\\times 10^{3},\\ 10.0)$。\n- 情况 $4$ (QE 有效性受挑战：慢吸附，快表面反应)：$(0.1,\\ 0.1,\\ 10.0,\\ 1.0,\\ 10.0,\\ 1.0,\\ 1000.0)$。\n- 情况 $5$ ($I*$ 生成/消耗的时间尺度受挑战)：$(0.5,\\ 0.5,\\ 1.0\\times 10^{5},\\ 1.0\\times 10^{2},\\ 1.0\\times 10^{2},\\ 1.0\\times 10^{-2},\\ 1.0\\times 10^{-2})$。\n\n所有速率单位必须是每个位点 $\\mathrm{s}^{-1}$。不涉及角度。不得使用百分比；绝对相对误差必须以小数形式报告。你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\n[r_1,r_2,r_3,r_4,r_5]$）。",
            "solution": "首先验证问题，确保其科学上合理、设定良好且客观。\n\n### 步骤 1：提取已知条件\n- **反应机理**:\n  1. 吸附：$A(g) + * \\rightleftharpoons A*$\n  2. 表面反应：$A* + B(g) \\rightleftharpoons I*$\n  3. 产物生成：$I* \\rightarrow P(g) + *$ (不可逆)\n- **状态变量**:\n  - 分数覆盖度：$\\theta_*$ (空位点)，$\\theta_A$ (吸附的 $A$)，$\\theta_I$ (中间体 $I$)。\n  - 分压：$P_A$ 和 $P_B$ (单位 $\\mathrm{bar}$)。\n- **约束条件**:\n  - 位点守恒：$\\theta_* + \\theta_A + \\theta_I = 1$。\n- **动力学参数**:\n  - 步骤 (1)：$k_{1f}$ ($\\mathrm{bar}^{-1}\\ \\mathrm{s}^{-1}$)，$k_{1r}$ ($\\mathrm{s}^{-1}$)\n  - 步骤 (2)：$k_{2f}$ ($\\mathrm{bar}^{-1}\\ \\mathrm{s}^{-1}$)，$k_{2r}$ ($\\mathrm{s}^{-1}$)\n  - 步骤 (3)：$k_3$ ($\\mathrm{s}^{-1}$)\n- **控制方程 (平均场 ODE)**:\n  $$ \\frac{d\\theta_A}{dt} = k_{1f} P_A \\theta_* - k_{1r} \\theta_A - k_{2f} P_B \\theta_A + k_{2r} \\theta_I $$\n  $$ \\frac{d\\theta_I}{dt} = k_{2f} P_B \\theta_A - k_{2r} \\theta_I - k_3 \\theta_I $$\n- **定义**:\n  - 完整稳态速率：$r_{\\mathrm{full}} = k_3 \\theta_I^{ss}$。\n- **任务**:\n  1. 通过对步骤 (1) 应用准平衡 (QE) 近似和对中间体 $I*$ 应用准稳态近似 (QSSA) 来推导简化速率表达式 $r_{\\mathrm{red}}$。\n  2. 从完整稳态解计算 $r_{\\mathrm{full}}$，从推导的表达式计算 $r_{\\mathrm{red}}$。\n  3. 对五个给定的参数集计算绝对相对误差 $E = \\lvert r_{\\mathrm{red}} - r_{\\mathrm{full}} \\rvert / r_{\\mathrm{full}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是化学反应工程和多相催化中的一个标准练习。它科学上基于微观动力学建模原理，使用了质量作用定律和成熟的近似方法 (QE, QSSA)。问题设定良好，提供了一套完整的方程、参数和明确定义的目标。语言正式且客观。提供了所有必要数据，且没有内部矛盾。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将制定一个解决方案。\n\n### 完整稳态速率表达式 ($r_{\\mathrm{full}}$) 的推导\n\n在稳态下，覆盖度的时间导数为零，$d\\theta_A/dt = 0$ 且 $d\\theta_I/dt = 0$。ODE 系统变成一个代数方程组：\n$$ k_{1f} P_A \\theta_* - k_{1r} \\theta_A - k_{2f} P_B \\theta_A + k_{2r} \\theta_I = 0 \\quad (1) $$\n$$ k_{2f} P_B \\theta_A - k_{2r} \\theta_I - k_3 \\theta_I = 0 \\quad (2) $$\n位点守恒方程为：\n$$ \\theta_* = 1 - \\theta_A - \\theta_I \\quad (3) $$\n从方程 ($2$)，我们求解 $\\theta_I$ 关于 $\\theta_A$ 的表达式：\n$$ k_{2f} P_B \\theta_A = (k_{2r} + k_3) \\theta_I $$\n$$ \\theta_I = \\left( \\frac{k_{2f} P_B}{k_{2r} + k_3} \\right) \\theta_A \\quad (4) $$\n这是一个稳态下的精确关系。接下来，我们将方程 ($3$) 代入方程 ($1$)：\n$$ k_{1f} P_A (1 - \\theta_A - \\theta_I) - k_{1r} \\theta_A - k_{2f} P_B \\theta_A + k_{2r} \\theta_I = 0 $$\n重新整理以分离常数项并按覆盖度对各项进行分组：\n$$ k_{1f} P_A = (k_{1f} P_A + k_{1r} + k_{2f} P_B) \\theta_A + (k_{1f} P_A - k_{2r}) \\theta_I \\quad (5) $$\n现在我们有两个关于未知覆盖度 $\\theta_A$ 和 $\\theta_I$ 的线性方程组 ($4$) 和 ($5$)。将 ($4$) 中的 $\\theta_I$ 代入 ($5$)：\n$$ k_{1f} P_A = \\left( k_{1f} P_A + k_{1r} + k_{2f} P_B \\right) \\theta_A + (k_{1f} P_A - k_{2r}) \\left( \\frac{k_{2f} P_B}{k_{2r} + k_3} \\right) \\theta_A $$\n提取 $\\theta_A$ 并将系数合并到一个公分母上：\n$$ k_{1f} P_A = \\left[ \\frac{(k_{1f} P_A + k_{1r} + k_{2f} P_B)(k_{2r} + k_3) + (k_{1f} P_A - k_{2r}) k_{2f} P_B}{k_{2r} + k_3} \\right] \\theta_A $$\n展开方括号内的分子并消去 $\\pm k_{2f} P_B k_{2r}$ 项进行简化，我们得到：\n$$ k_{1f} P_A (k_{2r} + k_3) = \\left[ (k_{1r} + k_{1f} P_A)(k_{2r} + k_3) + k_3 k_{2f} P_B + k_{1f} k_{2f} P_A P_B \\right] \\theta_A $$\n求解稳态覆盖度 $\\theta_A^{ss}$：\n$$ \\theta_A^{ss} = \\frac{k_{1f} P_A (k_{2r} + k_3)}{(k_{1r} + k_{1f} P_A)(k_{2r} + k_3) + k_3 k_{2f} P_B + k_{1f} k_{2f} P_A P_B} $$\n使用方程 ($4$)，我们得到 $\\theta_I^{ss}$：\n$$ \\theta_I^{ss} = \\frac{k_{2f} P_B}{k_{2r} + k_3} \\theta_A^{ss} = \\frac{k_{1f} k_{2f} P_A P_B}{(k_{1r} + k_{1f} P_A)(k_{2r} + k_3) + k_3 k_{2f} P_B + k_{1f} k_{2f} P_A P_B} $$\n精确的稳态生成速率为 $r_{\\mathrm{full}} = k_3 \\theta_I^{ss}$，即：\n$$ r_{\\mathrm{full}} = \\frac{k_3 k_{1f} k_{2f} P_A P_B}{(k_{1r} + k_{1f} P_A)(k_{2r} + k_3) + k_3 k_{2f} P_B + k_{1f} k_{2f} P_A P_B} $$\n\n### 简化速率表达式 ($r_{\\mathrm{red}}$) 的推导\n\n此推导应用了两种标准近似。\n1.  **步骤 (1) 的准平衡 (QE) 近似：** $A(g) + * \\rightleftharpoons A*$。\n此近似假设步骤 ($1$) 的正向和逆向速率远大于所有其他步骤的速率，导致步骤 ($1$) 处于近平衡状态。因此，步骤 ($1$) 的净速率被认为是零。\n$$ r_1 = k_{1f} P_A \\theta_* - k_{1r} \\theta_A \\approx 0 \\implies k_{1f} P_A \\theta_* \\approx k_{1r} \\theta_A $$\n这得到了一个用 $\\theta_*$ 表示 $\\theta_A$ 的表达式，其中 $K_1 = k_{1f}/k_{1r}$ 是吸附平衡常数：\n$$ \\theta_A \\approx \\frac{k_{1f}}{k_{1r}} P_A \\theta_* = K_1 P_A \\theta_* \\quad (6) $$\n2.  **活性中间体 $I*$ 的准稳态近似 (QSSA)**：\n此近似假设活性中间体 $I*$ 的浓度很低且随时间变化缓慢，因此 $d\\theta_I/dt \\approx 0$。\n$$ k_{2f} P_B \\theta_A - (k_{2r} + k_3) \\theta_I \\approx 0 \\implies \\theta_I \\approx \\left( \\frac{k_{2f} P_B}{k_{2r} + k_3} \\right) \\theta_A \\quad (7) $$\n我们使用位点守恒 $\\theta_* + \\theta_A + \\theta_I = 1$ 来求解覆盖度。将 $\\theta_A$ (来自 $6$) 和 $\\theta_I$ (来自 $7$) 的表达式代入位点守恒方程，用 $\\theta_*$ 表示所有覆盖度：\n$$ \\theta_* + (K_1 P_A \\theta_*) + \\left( \\frac{k_{2f} P_B}{k_{2r} + k_3} \\right) (K_1 P_A \\theta_*) = 1 $$\n求解 $\\theta_*$：\n$$ \\theta_* \\left( 1 + K_1 P_A + \\frac{k_{2f} K_1 P_A P_B}{k_{2r} + k_3} \\right) = 1 \\implies \\theta_* \\approx \\frac{1}{1 + K_1 P_A + \\frac{k_{2f} K_1 P_A P_B}{k_{2r} + k_3}} $$\n产物生成速率为 $r_{\\mathrm{red}} = k_3 \\theta_I^{\\mathrm{approx}}$。我们通过组合方程 ($6$) 和 ($7$) 并代入 $\\theta_*$ 的表达式来求得 $\\theta_I^{\\mathrm{approx}}$：\n$$ \\theta_I^{\\mathrm{approx}} \\approx \\left(\\frac{k_{2f} K_1 P_A P_B}{k_{2r} + k_3}\\right) \\theta_* \\approx \\frac{\\frac{k_{2f} K_1 P_A P_B}{k_{2r} + k_3}}{1 + K_1 P_A + \\frac{k_{2f} K_1 P_A P_B}{k_{2r} + k_3}} $$\n分子和分母同乘以 $k_{2r} + k_3$：\n$$ \\theta_I^{\\mathrm{approx}} \\approx \\frac{k_{2f} K_1 P_A P_B}{(k_{2r} + k_3)(1 + K_1 P_A) + k_{2f} K_1 P_A P_B} $$\n代入 $K_1 = k_{1f}/k_{1r}$：\n$$ \\theta_I^{\\mathrm{approx}} \\approx \\frac{k_{2f} (k_{1f}/k_{1r}) P_A P_B}{(k_{2r} + k_3)(1 + (k_{1f}/k_{1r}) P_A) + k_{2f} (k_{1f}/k_{1r}) P_A P_B} $$\n分子和分母同乘以 $k_{1r}$：\n$$ \\theta_I^{\\mathrm{approx}} \\approx \\frac{k_{1f} k_{2f} P_A P_B}{(k_{2r} + k_3)(k_{1r} + k_{1f} P_A) + k_{1f} k_{2f} P_A P_B} $$\n因此，简化的速率表达式为 $r_{\\mathrm{red}} = k_3 \\theta_I^{\\mathrm{approx}}$：\n$$ r_{\\mathrm{red}} = \\frac{k_3 k_{1f} k_{2f} P_A P_B}{(k_{1r} + k_{1f} P_A)(k_{2r} + k_3) + k_{1f} k_{2f} P_A P_B} $$\n最后的任务是实现 $r_{\\mathrm{full}}$ 和 $r_{\\mathrm{red}}$ 这两个表达式，为给定的测试用例计算绝对相对误差 $E = \\lvert r_{\\mathrm{red}} - r_{\\mathrm{full}} \\rvert / r_{\\mathrm{full}}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the absolute relative error between a full steady-state rate\n    and a reduced rate based on QE and QSSA approximations for a catalytic\n    reaction mechanism.\n    \"\"\"\n    \n    # Test cases: (P_A, P_B, k_1f, k_1r, k_2f, k_2r, k_3)\n    # Units: P in bar, k in combinations of bar, s.\n    test_cases = [\n        (0.1, 0.1, 1.0e5, 1.0e2, 1.0e5, 1.0e3, 10.0),\n        (1.0e-6, 2.0e-6, 1.0e5, 1.0e2, 1.0e5, 1.0e3, 10.0),\n        (1.0, 1.0, 1.0e5, 1.0e2, 1.0e5, 1.0e3, 10.0),\n        (0.1, 0.1, 10.0, 1.0, 10.0, 1.0, 1000.0),\n        (0.5, 0.5, 1.0e5, 1.0e2, 1.0e2, 1.0e-2, 1.0e-2)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        PA, PB, k1f, k1r, k2f, k2r, k3 = case\n\n        # Common terms in the rate expressions for clarity and efficiency.\n        # Let's define the components of the denominators.\n        # Denominator of r_full is: D = (k1r + k1f*PA)*(k2r + k3) + k3*k2f*PB + k1f*k2f*PA*PB\n        # Denominator of r_red is: D' = (k1r + k1f*PA)*(k2r + k3) + k1f*k2f*PA*PB\n        # The numerator for both rates is: N = k3 * k1f * k2f * PA * PB\n\n        term1 = (k1r + k1f * PA) * (k2r + k3)\n        term2 = k1f * k2f * PA * PB\n        term_extra_for_full = k3 * k2f * PB\n        \n        # Numerator expression (without k3, which is multiplied at the end)\n        numerator_base = term2 \n\n        # Denominator for the full rate expression\n        den_full = term1 + term_extra_for_full + term2\n\n        # Denominator for the reduced (approximated) rate expression\n        den_red = term1 + term2\n\n        # Calculate the rates.\n        # Since all parameters in the test cases are > 0, division by zero is not a concern.\n        r_full = k3 * numerator_base / den_full\n        r_red = k3 * numerator_base / den_red\n        \n        # Calculate the absolute relative error\n        error = abs(r_red - r_full) / r_full\n        \n        # Append the rounded result to the list\n        results.append(round(error, 6))\n\n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "微观动力学模型的预测能力取决于其参数的准确性，而这些参数通常需要通过充满噪声的实验数据来确定。贝叶斯推断 (Bayesian inference) 为此提供了一个强大的统计框架，它使我们能够结合先验知识与实验证据，系统地更新对模型参数（如活化能 $E$）的估计，并量化其不确定性。在此练习 () 中，你将通过一个实际案例，学习如何利用贝叶斯方法处理实验数据，从而得到更精确的参数值及其可信区间 (credible interval)。",
            "id": "3887618",
            "problem": "您需要为一个微动力学模型中的单个活化能参数实现贝叶斯更新，该更新使用在单一温度下收集的带有噪声的速率常数测量值。活化能被建模为单个标量参数 $E$（以电子伏特表示），基元反应的速率常数则通过源于过渡态理论 (TST) 的、与温度相关的阿伦尼乌斯形式进行建模。使用以下基本假设作为基础：\n\n- 单个基元反应的阿伦尼乌斯定律为 $k = A \\exp\\!\\left(-\\frac{E}{k_B T}\\right)$，其中 $k$ 是速率常数（单位为 $\\mathrm{s^{-1}}$），$A$ 是指前因子（单位为 $\\mathrm{s^{-1}}$），$E$ 是活化能（单位为 $\\mathrm{eV}$），$k_B$ 是玻尔兹曼常数，$T$ 是温度（单位为 $\\mathrm{K}$）。\n- 玻尔兹曼常数为 $k_B = 8.617333262145 \\times 10^{-5}$ $\\mathrm{eV/K}$。\n- 温度固定为 $T = 600$ $\\mathrm{K}$。\n- 速率常数的测量值受到对数正态分布的乘性噪声影响。等效地，测得的速率常数的自然对数被建模为独立同分布 (i.i.d.) 的高斯随机变量：$\\ln k_i \\sim \\mathcal{N}\\!\\left(\\ln A - \\frac{E}{k_B T}, \\sigma_{\\ln}^2\\right)$，其中 $\\sigma_{\\ln}$ 是对数测量噪声的已知标准差。\n- 活化能的先验分布是高斯分布：$E \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$，其中 $\\mu_0$ 是先验均值（单位为 $\\mathrm{eV}$），$\\sigma_0$ 是先验标准差（单位为 $\\mathrm{eV}$）。\n\n从贝叶斯定理和上述假设出发，实现一个贝叶斯更新，以计算由模型的线性高斯结构所蕴含的后验分布 $p(E \\mid \\{\\ln k_i\\}, A, T, \\sigma_{\\ln}, \\mu_0, \\sigma_0)$。使用此后验分布，为每个测试用例计算：\n- $E$ 的后验均值，单位为 $\\mathrm{eV}$。\n- $E$ 在 $0.95$ 水平上的中心可信区间，以 $\\mathrm{eV}$ 为单位表示，并以区间的下界和上界形式给出。\n\n所有输出必须以 $\\mathrm{eV}$ 表示，并四舍五入到 $6$ 位小数。\n\n您的程序必须使用下面提供的测试套件。对于每个测试用例，输入为 $(\\mu_0, \\sigma_0, A, \\sigma_{\\ln}, \\{k_i\\})$，其中温度 $T = 600$ $\\mathrm{K}$ 对所有用例均固定。指前因子 $A$ 在所有测试用例中共享。测量数据集 $\\{k_i\\}$ 以 $\\mathrm{s^{-1}}$ 为单位提供。\n\n测试套件：\n- 用例 $1$ (一般情况)：$\\mu_0 = 0.9$ $\\mathrm{eV}$，$\\sigma_0 = 0.2$ $\\mathrm{eV}$，$A = 1.0 \\times 10^{13}$ $\\mathrm{s^{-1}}$，$\\sigma_{\\ln} = 0.2$，$\\{k_i\\} = \\{1.6 \\times 10^{6}, 2.0 \\times 10^{6}, 1.7 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n- 用例 $2$ (窄先验，低噪声)：$\\mu_0 = 0.75$ $\\mathrm{eV}$，$\\sigma_0 = 0.05$ $\\mathrm{eV}$，$A = 1.0 \\times 10^{13}$ $\\mathrm{s^{-1}}$，$\\sigma_{\\ln} = 0.05$，$\\{k_i\\} = \\{2.3 \\times 10^{6}, 2.4 \\times 10^{6}, 2.5 \\times 10^{6}, 2.6 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n- 用例 $3$ (单次测量，高噪声)：$\\mu_0 = 1.2$ $\\mathrm{eV}$，$\\sigma_0 = 0.5$ $\\mathrm{eV}$，$A = 1.0 \\times 10^{13}$ $\\mathrm{s^{-1}}$，$\\sigma_{\\ln} = 0.4$，$\\{k_i\\} = \\{1.0 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n- 用例 $4$ (近确定性测量)：$\\mu_0 = 0.82$ $\\mathrm{eV}$，$\\sigma_0 = 0.1$ $\\mathrm{eV}$，$A = 1.0 \\times 10^{13}$ $\\mathrm{s^{-1}}$，$\\sigma_{\\ln} = 1.0 \\times 10^{-6}$，$\\{k_i\\} = \\{1.9 \\times 10^{6}, 1.9 \\times 10^{6}, 1.9 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n- 用例 $5$ (先验远离数据)：$\\mu_0 = 1.3$ $\\mathrm{eV}$，$\\sigma_0 = 0.3$ $\\mathrm{eV}$，$A = 1.0 \\times 10^{13}$ $\\mathrm{s^{-1}}$，$\\sigma_{\\ln} = 0.15$，$\\{k_i\\} = \\{2.2 \\times 10^{6}, 2.1 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表，列表用方括号括起来，其中每个测试用例的结果是一个包含三个浮点数（单位为 $\\mathrm{eV}$）的列表：$[\\text{posterior\\_mean}, \\text{lower}, \\text{upper}]$。\n- 对于完整的测试套件，输出必须是一个聚合了各用例列表的顶级列表，例如：$[[m_1,\\ell_1,u_1],[m_2,\\ell_2,u_2],\\dots]$。\n- 所有数字必须四舍五入到 $6$ 位小数。",
            "solution": "用户希望为一个微动力学模型中的单个活化能参数 $E$ 实现贝叶斯更新。\n\n### 问题验证\n\n#### 第 1 步：提取已知条件\n\n问题陈述中逐字给出的条件如下：\n- **阿伦尼乌斯定律**：$k = A \\exp\\!\\left(-\\frac{E}{k_B T}\\right)$，其中 $k$ 是速率常数（单位为 $\\mathrm{s^{-1}}$），$A$ 是指前因子（单位为 $\\mathrm{s^{-1}}$），$E$ 是活化能（单位为 $\\mathrm{eV}$），$k_B$ 是玻尔兹曼常数，$T$ 是温度（单位为 $\\mathrm{K}$）。\n- **玻尔兹曼常数**：$k_B = 8.617333262145 \\times 10^{-5}$ $\\mathrm{eV/K}$。\n- **温度**：$T = 600$ $\\mathrm{K}$。\n- **似然模型**：测得的速率常数的自然对数 $\\ln k_i$ 是独立同分布 (i.i.d.) 的高斯随机变量：$\\ln k_i \\sim \\mathcal{N}\\!\\left(\\ln A - \\frac{E}{k_B T}, \\sigma_{\\ln}^2\\right)$，其中 $\\sigma_{\\ln}$ 是对数测量噪声的已知标准差。\n- **先验模型**：活化能的先验分布是高斯分布：$E \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$，其中 $\\mu_0$ 是先验均值（单位为 $\\mathrm{eV}$），$\\sigma_0$ 是先验标准差（单位为 $\\mathrm{eV}$）。\n- **任务**：为每个测试用例计算 $E$ 的后验均值和 $0.95$ 中心可信区间。\n- **测试套件**：\n    - **共享参数**：$A = 1.0 \\times 10^{13}$ $\\mathrm{s^{-1}}$，$T = 600$ $\\mathrm{K}$。\n    - **用例 1**：$\\mu_0 = 0.9$ $\\mathrm{eV}$，$\\sigma_0 = 0.2$ $\\mathrm{eV}$，$\\sigma_{\\ln} = 0.2$，$\\{k_i\\} = \\{1.6 \\times 10^{6}, 2.0 \\times 10^{6}, 1.7 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n    - **用例 2**：$\\mu_0 = 0.75$ $\\mathrm{eV}$，$\\sigma_0 = 0.05$ $\\mathrm{eV}$，$\\sigma_{\\ln} = 0.05$，$\\{k_i\\} = \\{2.3 \\times 10^{6}, 2.4 \\times 10^{6}, 2.5 \\times 10^{6}, 2.6 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n    - **用例 3**：$\\mu_0 = 1.2$ $\\mathrm{eV}$，$\\sigma_0 = 0.5$ $\\mathrm{eV}$，$\\sigma_{\\ln} = 0.4$，$\\{k_i\\} = \\{1.0 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n    - **用例 4**：$\\mu_0 = 0.82$ $\\mathrm{eV}$，$\\sigma_0 = 0.1$ $\\mathrm{eV}$，$\\sigma_{\\ln} = 1.0 \\times 10^{-6}$，$\\{k_i\\} = \\{1.9 \\times 10^{6}, 1.9 \\times 10^{6}, 1.9 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n    - **用例 5**：$\\mu_0 = 1.3$ $\\mathrm{eV}$，$\\sigma_0 = 0.3$ $\\mathrm{eV}$，$\\sigma_{\\ln} = 0.15$，$\\{k_i\\} = \\{2.2 \\times 10^{6}, 2.1 \\times 10^{6}\\}$ $\\mathrm{s^{-1}}$。\n\n#### 第 2 步：使用提取的已知条件进行验证\n\n根据验证标准对问题进行审查：\n- **科学性**：该问题基于阿伦尼乌斯方程和过渡态理论，这些是化学动力学的基础原理。其统计框架（使用高斯先验和对数正态似然的贝叶斯推断）是参数估计和不确定性量化的标准方法。该问题是科学合理的。\n- **适定性**：该问题是适定的。高斯先验和高斯似然（在变换后的变量空间中）的组合是共轭配对，这保证了一个唯一、稳定且定义明确的高斯后验分布。所有必需的参数和数据都已提供。\n- **客观性**：该问题以精确、客观的语言陈述。所有术语都有定义，所需的计算也得到了明确的规定。\n- **完整性与一致性**：该问题是自洽的。所有必需的常数 ($k_B$)、固定参数 ($T$, $A$) 以及特定用例的数据 ($\\mu_0$, $\\sigma_0$, $\\sigma_{\\ln}$, $\\{k_i\\}$) 都已提供。没有内部矛盾。\n\n该问题没有表现出任何列出的缺陷。\n\n#### 第 3 步：结论与行动\n\n问题有效。将提供解决方案。\n\n### 求解推导\n\n目标是给定一组 $N$ 个速率常数测量值 $\\{k_i\\}_{i=1}^N$ 的情况下，求出活化能 $E$ 的后验概率分布。我们应用贝叶斯定理：\n$$\np(E \\mid \\{\\ln k_i\\}) \\propto p(\\{\\ln k_i\\} \\mid E) \\, p(E)\n$$\n其中 $p(E \\mid \\{\\ln k_i\\})$ 是后验， $p(\\{\\ln k_i\\} \\mid E)$ 是似然，而 $p(E)$ 是先验。\n\n1.  **先验分布**：$E$ 的先验被给定为高斯分布：\n    $$\n    p(E) = \\mathcal{N}(E; \\mu_0, \\sigma_0^2) \\propto \\exp\\left(-\\frac{(E - \\mu_0)^2}{2\\sigma_0^2}\\right)\n    $$\n    其中 $\\mu_0$ 和 $\\sigma_0^2$ 分别是先验均值和方差。\n\n2.  **似然函数**：测量值 $\\ln k_i$ 是独立同分布的高斯随机变量：\n    $$\n    \\ln k_i \\sim \\mathcal{N}\\left(\\ln A - \\frac{E}{k_B T}, \\sigma_{\\ln}^2\\right)\n    $$\n    对于 $N$ 个测量值的集合，其似然是它们各自概率密度的乘积：\n    $$\n    p(\\{\\ln k_i\\} \\mid E) = \\prod_{i=1}^N \\mathcal{N}\\left(\\ln k_i; \\ln A - \\frac{E}{k_B T}, \\sigma_{\\ln}^2\\right)\n    $$\n    使用对数似然更为方便：\n    $$\n    \\ln p(\\{\\ln k_i\\} \\mid E) = \\sum_{i=1}^N \\ln \\mathcal{N}\\left(\\ln k_i; \\ln A - \\frac{E}{k_B T}, \\sigma_{\\ln}^2\\right)\n    $$\n    忽略不依赖于 $E$ 的项，上式可写为：\n    $$\n    \\ln p(\\{\\ln k_i\\} \\mid E) \\propto \\sum_{i=1}^N \\left( -\\frac{\\left(\\ln k_i - \\left(\\ln A - \\frac{E}{k_B T}\\right)\\right)^2}{2\\sigma_{\\ln}^2} \\right)\n    $$\n    为简化起见，我们可以重新整理表达式，使其对 $E$ 是线性的。我们定义一个新变量 $y_i$，代表从每个数据点 $k_i$ 测得的活化能：\n    $$\n    y_i = k_B T (\\ln A - \\ln k_i)\n    $$\n    测量模型表明 $\\ln k_i = \\ln A - \\frac{E}{k_B T} + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_{\\ln}^2)$。两边乘以 $-k_B T$ 并重新排列得到：\n    $$\n    k_B T (\\ln A - \\ln k_i) = E - k_B T \\epsilon_i\n    $$\n    因此，我们的变换后测量值为 $y_i = E + \\delta_i$，其中新的噪声项 $\\delta_i = -k_B T \\epsilon_i$ 也服从高斯分布，均值为 $0$，方差为 $\\sigma_y^2 = \\text{Var}(-k_B T \\epsilon_i) = (k_B T)^2 \\sigma_{\\ln}^2$。\n    单个变换后测量值 $y_i$ 的似然为 $p(y_i \\mid E) = \\mathcal{N}(y_i; E, \\sigma_y^2)$。\n\n3.  **后验分布**：对数后验是对数先验和对数似然之和（忽略常数）：\n    $$\n    \\ln p(E \\mid \\{y_i\\}) \\propto -\\frac{(E - \\mu_0)^2}{2\\sigma_0^2} - \\sum_{i=1}^N \\frac{(y_i - E)^2}{2\\sigma_y^2}\n    $$\n    这个表达式是 $E$ 的二次型，这意味着后验分布也是高斯分布，$p(E \\mid \\{y_i\\}) = \\mathcal{N}(E; \\mu_N, \\sigma_N^2)$。这个后验高斯分布的参数可以通过配方法或使用组合高斯分布的标准精度加权公式找到。精度（方差的倒数）相加：\n    $$\n    \\frac{1}{\\sigma_N^2} = \\frac{1}{\\sigma_0^2} + \\frac{N}{\\sigma_y^2} = \\frac{1}{\\sigma_0^2} + \\frac{N}{(k_B T \\sigma_{\\ln})^2}\n    $$\n    后验均值是先验均值和数据均值的精度加权平均值：\n    $$\n    \\mu_N = \\sigma_N^2 \\left( \\frac{\\mu_0}{\\sigma_0^2} + \\frac{\\sum_{i=1}^N y_i}{\\sigma_y^2} \\right) = \\sigma_N^2 \\left( \\frac{\\mu_0}{\\sigma_0^2} + \\frac{\\sum_{i=1}^N k_B T (\\ln A - \\ln k_i)}{(k_B T \\sigma_{\\ln})^2} \\right)\n    $$\n\n4.  **可信区间**：对于高斯分布的参数 $E \\sim \\mathcal{N}(\\mu_N, \\sigma_N^2)$，一个 $100(1-\\alpha)\\%$ 的中心可信区间由下式给出：\n    $$\n    [\\mu_N - z_{1-\\alpha/2} \\sigma_N, \\mu_N + z_{1-\\alpha/2} \\sigma_N]\n    $$\n    其中 $z_{1-\\alpha/2}$ 是标准正态分布 $\\mathcal{N}(0, 1)$ 的 $(1-\\alpha/2)$-分位数。对于 $95\\%$ 的可信区间，$\\alpha = 0.05$，所以我们需要 $0.975$-分位数，$z_{0.975} \\approx 1.959964$。后验标准差为 $\\sigma_N = \\sqrt{\\sigma_N^2}$。\n\n### 算法总结\n\n对于每个测试用例：\n1.  定义常数：$k_B = 8.617333262145 \\times 10^{-5}$ $\\mathrm{eV/K}$ 和 $T = 600$ $\\mathrm{K}$。\n2.  获取输入：$\\mu_0$, $\\sigma_0$, $A$, $\\sigma_{\\ln}$ 以及测量值集合 $\\{k_i\\}$。令 $N$ 为测量次数。\n3.  计算后验精度（方差的倒数）$\\tau_N = 1/\\sigma_N^2$：\n    $$\n    \\tau_N = \\frac{1}{\\sigma_0^2} + \\frac{N}{(k_B T \\sigma_{\\ln})^2}\n    $$\n4.  计算后验方差 $\\sigma_N^2 = 1/\\tau_N$。\n5.  计算与数据相关的项：\n    $$\n    S = \\frac{\\sum_{i=1}^N k_B T (\\ln A - \\ln k_i)}{(k_B T \\sigma_{\\ln})^2}\n    $$\n6.  计算后验均值 $\\mu_N$：\n    $$\n    \\mu_N = \\sigma_N^2 \\left( \\frac{\\mu_0}{\\sigma_0^2} + S \\right)\n    $$\n7.  计算后验标准差 $\\sigma_N = \\sqrt{\\sigma_N^2}$。\n8.  找到 $95\\%$ 可信区间的 $z$-分数：$z = z_{0.975}$。\n9.  计算下界 $L = \\mu_N - z \\cdot \\sigma_N$ 和上界 $U = \\mu_N + z \\cdot \\sigma_N$。\n10. 将 $\\mu_N$, $L$, 和 $U$ 四舍五入到 $6$ 位小数并报告。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Implements a Bayesian update for a single activation barrier parameter\n    in a microkinetic model.\n    \"\"\"\n    \n    # Define physical constants and fixed parameters\n    KB_EV_K = 8.617333262145e-5  # Boltzmann constant in eV/K\n    T_K = 600.0  # Temperature in K\n    A_S_INV = 1.0e13  # Pre-exponential factor in s^-1\n    \n    # Pre-calculate common terms\n    KB_T = KB_EV_K * T_K\n    LN_A = np.log(A_S_INV)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general case)\n        (0.9, 0.2, 0.2, [1.6e6, 2.0e6, 1.7e6]),\n        # Case 2 (tight prior, low noise)\n        (0.75, 0.05, 0.05, [2.3e6, 2.4e6, 2.5e6, 2.6e6]),\n        # Case 3 (single measurement, high noise)\n        (1.2, 0.5, 0.4, [1.0e6]),\n        # Case 4 (near-deterministic measurements)\n        (0.82, 0.1, 1.0e-6, [1.9e6, 1.9e6, 1.9e6]),\n        # Case 5 (prior far from data)\n        (1.3, 0.3, 0.15, [2.2e6, 2.1e6]),\n    ]\n\n    results = []\n    \n    # Z-score for 95% central credible interval (P(Z = z) = 0.975)\n    z_score = norm.ppf(0.975)\n\n    for case in test_cases:\n        mu_0, sigma_0, sigma_ln, k_measurements = case\n        \n        # Number of measurements\n        n_measurements = len(k_measurements)\n        \n        # Transform measurements k_i to y_i = kB*T*(lnA - ln(k_i))\n        y_measurements = [KB_T * (LN_A - np.log(k)) for k in k_measurements]\n        \n        # Prior variance\n        var_0 = sigma_0**2\n        \n        # Variance of transformed measurement y_i\n        var_y = (KB_T * sigma_ln)**2\n        \n        # Calculate posterior variance sigma_N^2\n        # Handle the case where var_y is zero to avoid division by zero\n        if var_y > 0:\n            # Precisions add: 1/var_N = 1/var_0 + N/var_y\n            # Catch case where prior variance is effectively infinite or zero.\n            if var_0 > 0:\n                inv_var_N = (1.0 / var_0) + (n_measurements / var_y)\n            else: # Zero prior variance, posterior is just the prior.\n                inv_var_N = np.inf\n        else: # Zero measurement variance: data is perfect.\n            inv_var_N = np.inf\n\n        if inv_var_N > 0 and np.isfinite(inv_var_N):\n            var_N = 1.0 / inv_var_N\n        else: # Effectively infinite precision, so zero variance.\n            var_N = 0.0\n\n        # Calculate posterior mean mu_N\n        # mu_N = var_N * (mu_0/var_0 + sum(y_i)/var_y)\n        if var_y > 0:\n            if var_0 > 0:\n                weighted_prior_mean = mu_0 / var_0\n            else: # Prior is a delta function at mu_0.\n                  # In this scenario, posterior should just be mu_0, var_N=0.\n                mu_N = mu_0\n                results.append([round(mu_N, 6), round(mu_N, 6), round(mu_N, 6)])\n                continue\n            \n            weighted_data_mean = sum(y_measurements) / var_y\n            mu_N = var_N * (weighted_prior_mean + weighted_data_mean)\n        else: # Perfect measurements, prior is ignored.\n            mu_N = np.mean(y_measurements)\n\n\n        # Posterior standard deviation\n        sigma_N = np.sqrt(var_N)\n        \n        # Calculate the 95% central credible interval\n        margin_of_error = z_score * sigma_N\n        lower_bound = mu_N - margin_of_error\n        upper_bound = mu_N + margin_of_error\n        \n        # Append the rounded results for the current case\n        results.append([\n            round(mu_N, 6),\n            round(lower_bound, 6),\n            round(upper_bound, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}