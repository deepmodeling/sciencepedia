{
    "hands_on_practices": [
        {
            "introduction": "Many complex catalytic cycles involve rapid, reversible adsorption and desorption steps that are much faster than subsequent surface reactions. The steady-state approximation (SSA), particularly in its quasi-equilibrium form, allows us to simplify the model by algebraically relating surface coverages to gas-phase conditions. This foundational exercise guides you through applying the SSA to derive the competitive Langmuir isotherm, a cornerstone expression for surface coverages that is essential for building more complex microkinetic models.",
            "id": "3900501",
            "problem": "A flat catalyst surface with a uniform population of identical sites is exposed to a ternary gas mixture containing adsorbates $A$, $B$, and $C$ at temperature $T$. Consider the microkinetic scheme consisting only of site-blocking competitive adsorption and desorption for each species,\n$$A(\\mathrm{g}) + * \\rightleftharpoons A*, \\quad B(\\mathrm{g}) + * \\rightleftharpoons B*, \\quad C(\\mathrm{g}) + * \\rightleftharpoons C*,$$\nwhere $*$ denotes a vacant site and $X*$ denotes species $X \\in \\{A,B,C\\}$ adsorbed on a single site. Assume ideal-gas behavior for the gas phase, no lateral interactions on the surface, monomeric adsorption ($X*$ occupies exactly one site), and that all adsorption–desorption processes are much faster than any other elementary steps that may occur on the surface, so that adsorption–desorption is in the quasi-equilibrium limit. Let the gas-phase fugacities be $f_A$, $f_B$, and $f_C$, and let the adsorption equilibrium constants be $K_A$, $K_B$, and $K_C$, respectively, defined for the elementary steps above at the given $T$.\n\nStarting from mass-action kinetics for elementary steps, the site-conservation law, and the steady-state approximation (SSA) for surface coverages (i.e., the time derivatives of surface coverages are approximately zero under the quasi-equilibrium limit for adsorption), derive closed-form expressions for the steady-state coverage fractions $\\theta_A$, $\\theta_B$, $\\theta_C$, and the vacant-site fraction $\\theta_*$ in terms of only $K_A$, $K_B$, $K_C$, $f_A$, $f_B$, and $f_C$.\n\nExpress your final answer as a single row matrix containing $\\theta_A$, $\\theta_B$, $\\theta_C$, and $\\theta_*$, in that order. Do not include any units. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the steady-state surface coverages for a competitive adsorption system involving three species, $A$, $B$, and $C$, under the quasi-equilibrium approximation. This is a classic problem in heterogeneous catalysis, leading to the competitive Langmuir adsorption isotherm.\n\nThe microkinetic scheme is given by three reversible elementary steps for $X \\in \\{A, B, C\\}$:\n$$\nX(\\mathrm{g}) + * \\rightleftharpoons X*\n$$\nHere, $*$ represents a vacant adsorption site on the catalyst surface, and $X*$ represents a site occupied by species $X$. The total concentration of sites on the surface is constant. We can work with fractional coverages, where $\\theta_X$ is the fraction of sites occupied by species $X$, and $\\theta_*$ is the fraction of vacant sites.\n\nWe begin by applying the principle of mass-action kinetics to each elementary step. For a generic species $X$, the rate of adsorption, $r_{\\text{ads},X}$, is proportional to the fugacity of $X$ in the gas phase, $f_X$, and the fraction of available vacant sites, $\\theta_*$. The rate of desorption, $r_{\\text{des},X}$, is proportional to the fraction of sites occupied by $X$, $\\theta_X$.\nThus, we can write the rates as:\n$$\nr_{\\text{ads},X} = k_{\\text{ads},X} f_X \\theta_*\n$$\n$$\nr_{\\text{des},X} = k_{\\text{des},X} \\theta_X\n$$\nwhere $k_{\\text{ads},X}$ and $k_{\\text{des},X}$ are the rate constants for adsorption and desorption of species $X$, respectively, at temperature $T$.\n\nThe problem states that the adsorption-desorption processes are in the quasi-equilibrium limit. This means these steps are much faster than any subsequent reaction steps (which are not specified but their potential existence is implied). Under this condition, the net rate of formation for each adsorbed species is effectively zero. This is mathematically equivalent to applying the steady-state approximation (SSA) to the surface intermediates $A*$, $B*$, and $C*$. For each species $X*$:\n$$\n\\frac{d\\theta_X}{dt} = r_{\\text{ads},X} - r_{\\text{des},X} \\approx 0\n$$\nThis implies that the forward and reverse rates are balanced:\n$$\nr_{\\text{ads},X} = r_{\\text{des},X}\n$$\nSubstituting the rate expressions from mass-action kinetics:\n$$\nk_{\\text{ads},X} f_X \\theta_* = k_{\\text{des},X} \\theta_X\n$$\nThe adsorption equilibrium constant, $K_X$, for the elementary step $X(\\mathrm{g}) + * \\rightleftharpoons X*$ is defined as the ratio of the forward rate constant to the reverse rate constant:\n$$\nK_X = \\frac{k_{\\text{ads},X}}{k_{\\text{des},X}}\n$$\nSubstituting this definition into the equilibrium condition, we can express the coverage of each species, $\\theta_X$, in terms of the vacant site coverage, $\\theta_*$.\n$$\n\\frac{k_{\\text{ads},X}}{k_{\\text{des},X}} f_X \\theta_* = \\theta_X \\implies \\theta_X = K_X f_X \\theta_*\n$$\nThis relationship holds for all three species, $A$, $B$, and $C$:\n$$\n\\theta_A = K_A f_A \\theta_*\n$$\n$$\n\\theta_B = K_B f_B \\theta_*\n$$\n$$\n\\theta_C = K_C f_C \\theta_*\n$$\nWe now have three equations relating the coverages of the adsorbed species to the coverage of vacant sites. To solve for the individual coverages, we must invoke the site conservation law (or site balance). The sum of the fractional coverages of all possible species on the surface, including vacant sites, must be equal to unity.\n$$\n\\theta_A + \\theta_B + \\theta_C + \\theta_* = 1\n$$\nNow, we substitute the expressions for $\\theta_A$, $\\theta_B$, and $\\theta_C$ into the site balance equation:\n$$\n(K_A f_A \\theta_*) + (K_B f_B \\theta_*) + (K_C f_C \\theta_*) + \\theta_* = 1\n$$\nWe can factor out the common term $\\theta_*$:\n$$\n\\theta_* (K_A f_A + K_B f_B + K_C f_C + 1) = 1\n$$\nFrom this, we can solve for the vacant site fraction, $\\theta_*$:\n$$\n\\theta_* = \\frac{1}{1 + K_A f_A + K_B f_B + K_C f_C}\n$$\nThis is the expression for the vacant site fraction in terms of the given fugacities and equilibrium constants.\n\nFinally, we can find the expressions for the coverages of the adsorbed species by substituting this expression for $\\theta_*$ back into the equilibrium relationships derived earlier.\nFor species $A$:\n$$\n\\theta_A = K_A f_A \\theta_* = K_A f_A \\left( \\frac{1}{1 + K_A f_A + K_B f_B + K_C f_C} \\right) = \\frac{K_A f_A}{1 + K_A f_A + K_B f_B + K_C f_C}\n$$\nFor species $B$:\n$$\n\\theta_B = K_B f_B \\theta_* = K_B f_B \\left( \\frac{1}{1 + K_A f_A + K_B f_B + K_C f_C} \\right) = \\frac{K_B f_B}{1 + K_A f_A + K_B f_B + K_C f_C}\n$$\nFor species $C$:\n$$\n\\theta_C = K_C f_C \\theta_* = K_C f_C \\left( \\frac{1}{1 + K_A f_A + K_B f_B + K_C f_C} \\right) = \\frac{K_C f_C}{1 + K_A f_A + K_B f_B + K_C f_C}\n$$\nThese four expressions for $\\theta_A$, $\\theta_B$, $\\theta_C$, and $\\theta_*$ constitute the complete solution. They are expressed solely in terms of the given constants ($K_A, K_B, K_C$) and variables ($f_A, f_B, f_C$), as required.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{K_A f_A}{1 + K_A f_A + K_B f_B + K_C f_C}  \\frac{K_B f_B}{1 + K_A f_A + K_B f_B + K_C f_C}  \\frac{K_C f_C}{1 + K_A f_A + K_B f_B + K_C f_C}  \\frac{1}{1 + K_A f_A + K_B f_B + K_C f_C} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the steady-state approximation is a powerful tool for simplification, its validity rests on a clear separation of timescales between fast and slow processes. This practice moves beyond analytical derivation to numerical validation, where you will compare the full transient dynamics of a microkinetic model against its SSA-reduced counterpart. By implementing a quantitative validation protocol, you will gain hands-on experience in assessing the accuracy of the SSA and connecting the approximation error to the underlying physical timescales of the system .",
            "id": "3900467",
            "problem": "Consider a catalytic surface with a single type of active site undergoing the following microkinetic scheme driven by mass-action kinetics, where $A(\\mathrm{g})$ is a gas-phase reactant, $A^*$ is an adsorbed species, $I^*$ is a reactive intermediate, and $B(\\mathrm{g})$ is a gas-phase product: $A(\\mathrm{g}) + * \\rightleftharpoons A^*$, $A^* \\rightleftharpoons I^*$, $I^* \\rightarrow B(\\mathrm{g}) + *$. Let $\\theta_*$, $\\theta_A$, and $\\theta_I$ denote the surface coverages of empty sites, $A^*$, and $I^*$ respectively, with the site balance $\\theta_* + \\theta_A + \\theta_I = 1$. The gas-phase partial pressure of $A(\\mathrm{g})$ is $p_A$ (in bar). The rate constants are $k_{\\mathrm{ads}}$ (in $\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$) for adsorption, $k_{\\mathrm{des}}$ (in $\\mathrm{s}^{-1}$) for desorption, $k_{\\mathrm{iso,f}}$ (in $\\mathrm{s}^{-1}$) and $k_{\\mathrm{iso,r}}$ (in $\\mathrm{s}^{-1}$) for forward and reverse surface isomerization, and $k_{\\mathrm{rxn}}$ (in $\\mathrm{s}^{-1}$) for the irreversible reaction of $I^*$ to $B(\\mathrm{g})$. By mass-action, the rates are $r_{\\mathrm{ads}} = k_{\\mathrm{ads}}\\,p_A\\,\\theta_*$, $r_{\\mathrm{des}} = k_{\\mathrm{des}}\\,\\theta_A$, $r_{\\mathrm{iso,f}} = k_{\\mathrm{iso,f}}\\,\\theta_A$, $r_{\\mathrm{iso,r}} = k_{\\mathrm{iso,r}}\\,\\theta_I$, and $r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}}\\,\\theta_I$. The full transient dynamics for the coverages are governed by the ordinary differential equations $d\\theta_A/dt = r_{\\mathrm{ads}} - r_{\\mathrm{des}} - r_{\\mathrm{iso,f}} + r_{\\mathrm{iso,r}}$ and $d\\theta_I/dt = r_{\\mathrm{iso,f}} - r_{\\mathrm{iso,r}} - r_{\\mathrm{rxn}}$, with $\\theta_* = 1 - \\theta_A - \\theta_I$. At time $t=0$, the system experiences a step change in $p_A$ from an initial value $p_{A,0}$ to a final value $p_{A,1}$, which remains constant for $t \\ge 0$.\n\nYour task is to implement a validation protocol that compares the full transient integration of the microkinetic model to a prediction obtained via the Steady-State Approximation (SSA), defined here as the assumption $d\\theta_I/dt \\approx 0$ for all $t \\ge 0$. Under SSA, $\\theta_I$ must be computed algebraically at each time from the condition $d\\theta_I/dt = 0$, and the remaining dynamic variable(s) must be integrated to predict the transient response to the step in $p_A$. Use the steady state at $p_{A,0}$ as the initial condition at $t=0$, computed consistently with the kinetic scheme.\n\nDefine the validation error as the time-continuous relative $L^2$ norm over the interval $[0,T]$ of the difference between SSA and full-transient coverage trajectories for the set $\\{\\theta_A,\\theta_I\\}$, namely\n$$\n\\mathcal{E} = \\sqrt{ \\frac{ \\int_0^T \\left[ \\left(\\theta_A^{\\mathrm{SSA}}(t) - \\theta_A^{\\mathrm{full}}(t)\\right)^2 + \\left(\\theta_I^{\\mathrm{SSA}}(t) - \\theta_I^{\\mathrm{full}}(t)\\right)^2 \\right] \\, dt }{ \\int_0^T \\left[ \\left(\\theta_A^{\\mathrm{full}}(t)\\right)^2 + \\left(\\theta_I^{\\mathrm{full}}(t)\\right)^2 \\right] \\, dt + \\delta } },\n$$\nwhere $\\delta$ is a small positive regularization parameter (dimensionless) to avoid division by zero. Define an acceptable error threshold as\n$$\n\\epsilon_{\\mathrm{acc}} = \\min\\left( \\epsilon_{\\max}, \\alpha \\frac{ \\tau_{\\mathrm{fast}} }{ \\tau_{\\mathrm{slow}} } \\right),\n$$\nwith $\\epsilon_{\\max}$ (dimensionless) and $\\alpha$ (dimensionless) chosen constants, $\\tau_{\\mathrm{fast}} = 1 / \\left(k_{\\mathrm{iso,f}} + k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}\\right)$ (in seconds) representing the characteristic timescale of the fast intermediate $I^*$, and $\\tau_{\\mathrm{slow}} = 1 / \\left(k_{\\mathrm{ads}}\\,p_{A,1} + k_{\\mathrm{des}}\\right)$ (in seconds) representing the characteristic timescale of the slower adsorption-desorption process at the post-step pressure. Units: express pressure in bar, time in seconds, and coverages are dimensionless.\n\nImplement both the full transient integration and the SSA-reduced integration using the above definitions, compute $\\mathcal{E}$, and compare it to $\\epsilon_{\\mathrm{acc}}$ to decide whether SSA is acceptable for the given parameter set.\n\nTest Suite:\n- Case 1 (timescale separation, happy path): $k_{\\mathrm{ads}} = 0.2\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$, $k_{\\mathrm{des}} = 0.05\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{iso,f}} = 50\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{iso,r}} = 30\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{rxn}} = 20\\,\\mathrm{s}^{-1}$, $p_{A,0} = 0.1\\,\\mathrm{bar}$, $p_{A,1} = 1.0\\,\\mathrm{bar}$, $T = 10\\,\\mathrm{s}$.\n- Case 2 (poor separation, boundary condition): $k_{\\mathrm{ads}} = 0.2\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$, $k_{\\mathrm{des}} = 0.05\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{iso,f}} = 0.05\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{iso,r}} = 0.05\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{rxn}} = 0.05\\,\\mathrm{s}^{-1}$, $p_{A,0} = 0.1\\,\\mathrm{bar}$, $p_{A,1} = 1.0\\,\\mathrm{bar}$, $T = 10\\,\\mathrm{s}$.\n- Case 3 (near saturation, but excellent separation): $k_{\\mathrm{ads}} = 0.1\\,\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$, $k_{\\mathrm{des}} = 0.01\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{iso,f}} = 100\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{iso,r}} = 50\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{rxn}} = 50\\,\\mathrm{s}^{-1}$, $p_{A,0} = 0.01\\,\\mathrm{bar}$, $p_{A,1} = 10.0\\,\\mathrm{bar}$, $T = 10\\,\\mathrm{s}$.\n\nUse $\\delta = 10^{-12}$, $\\epsilon_{\\max} = 0.02$, and $\\alpha = 2.0$. Angles are not used. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a boolean indicating, for each test case in order, whether $\\mathcal{E} \\le \\epsilon_{\\mathrm{acc}}$ (i.e., whether SSA is acceptable), formatted exactly like $[b_1,b_2,b_3]$.",
            "solution": "The user-provided problem is first subjected to a rigorous validation protocol.\n\n### Step 1: Extract Givens\n\n**Reaction Mechanism:**\n-   $A(\\mathrm{g}) + * \\rightleftharpoons A^*$\n-   $A^* \\rightleftharpoons I^*$\n-   $I^* \\rightarrow B(\\mathrm{g}) + *$\n\n**Species and Coverages:**\n-   $A(\\mathrm{g})$: gas-phase reactant\n-   $B(\\mathrm{g})$: gas-phase product\n-   $*$: empty active site\n-   $A^*$: adsorbed species\n-   $I^*$: reactive intermediate\n-   $\\theta_*$: coverage of empty sites\n-   $\\theta_A$: coverage of $A^*$\n-   $\\theta_I$: coverage of $I^*$\n-   Site Balance: $\\theta_* + \\theta_A + \\theta_I = 1$\n\n**Kinetics and Rate Constants:**\n-   Partial pressure of $A$: $p_A$ (bar)\n-   Adsorption rate constant: $k_{\\mathrm{ads}}$ ($\\mathrm{s}^{-1}\\,\\mathrm{bar}^{-1}$)\n-   Desorption rate constant: $k_{\\mathrm{des}}$ ($\\mathrm{s}^{-1}$)\n-   Forward isomerization rate constant: $k_{\\mathrm{iso,f}}$ ($\\mathrm{s}^{-1}$)\n-   Reverse isomerization rate constant: $k_{\\mathrm{iso,r}}$ ($\\mathrm{s}^{-1}$)\n-   Reaction rate constant: $k_{\\mathrm{rxn}}$ ($\\mathrm{s}^{-1}$)\n-   Rate expressions (mass-action):\n    -   $r_{\\mathrm{ads}} = k_{\\mathrm{ads}}\\,p_A\\,\\theta_*$\n    -   $r_{\\mathrm{des}} = k_{\\mathrm{des}}\\,\\theta_A$\n    -   $r_{\\mathrm{iso,f}} = k_{\\mathrm{iso,f}}\\,\\theta_A$\n    -   $r_{\\mathrm{iso,r}} = k_{\\mathrm{iso,r}}\\,\\theta_I$\n    -   $r_{\\mathrm{rxn}} = k_{\\mathrm{rxn}}\\,\\theta_I$\n\n**Full Transient Dynamics (ODEs):**\n-   $d\\theta_A/dt = r_{\\mathrm{ads}} - r_{\\mathrm{des}} - r_{\\mathrm{iso,f}} + r_{\\mathrm{iso,r}}$\n-   $d\\theta_I/dt = r_{\\mathrm{iso,f}} - r_{\\mathrm{iso,r}} - r_{\\mathrm{rxn}}$\n-   $\\theta_* = 1 - \\theta_A - \\theta_I$\n\n**Experimental Conditions:**\n-   At $t=0$, a step change in pressure from $p_{A,0}$ to $p_{A,1}$.\n-   For $t \\ge 0$, $p_A = p_{A,1}$.\n-   Initial conditions at $t=0$ are the steady-state coverages at $p_{A,0}$.\n\n**Steady-State Approximation (SSA):**\n-   Assumption: $d\\theta_I/dt \\approx 0$ for all $t \\ge 0$.\n-   $\\theta_I$ is computed algebraically from $d\\theta_I/dt = 0$.\n-   Remaining dynamic variables are integrated.\n\n**Validation Error Metric:**\n-   $\\mathcal{E} = \\sqrt{ \\frac{ \\int_0^T \\left[ \\left(\\theta_A^{\\mathrm{SSA}}(t) - \\theta_A^{\\mathrm{full}}(t)\\right)^2 + \\left(\\theta_I^{\\mathrm{SSA}}(t) - \\theta_I^{\\mathrm{full}}(t)\\right)^2 \\right] \\, dt }{ \\int_0^T \\left[ \\left(\\theta_A^{\\mathrm{full}}(t)\\right)^2 + \\left(\\theta_I^{\\mathrm{full}}(t)\\right)^2 \\right] \\, dt + \\delta } }$\n-   Integration interval: $[0, T]$\n-   Regularization parameter: $\\delta$\n\n**Acceptable Error Threshold:**\n-   $\\epsilon_{\\mathrm{acc}} = \\min\\left( \\epsilon_{\\max}, \\alpha \\frac{ \\tau_{\\mathrm{fast}} }{ \\tau_{\\mathrm{slow}} } \\right)$\n-   Fast timescale: $\\tau_{\\mathrm{fast}} = 1 / \\left(k_{\\mathrm{iso,f}} + k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}\\right)$\n-   Slow timescale: $\\tau_{\\mathrm{slow}} = 1 / \\left(k_{\\mathrm{ads}}\\,p_{A,1} + k_{\\mathrm{des}}\\right)$\n\n**Constants:**\n-   $\\delta = 10^{-12}$\n-   $\\epsilon_{\\max} = 0.02$\n-   $\\alpha = 2.0$\n\n**Test Suite:**\n-   Case 1: $k_{\\mathrm{ads}} = 0.2$, $k_{\\mathrm{des}} = 0.05$, $k_{\\mathrm{iso,f}} = 50$, $k_{\\mathrm{iso,r}} = 30$, $k_{\\mathrm{rxn}} = 20$, $p_{A,0} = 0.1$, $p_{A,1} = 1.0$, $T = 10$.\n-   Case 2: $k_{\\mathrm{ads}} = 0.2$, $k_{\\mathrm{des}} = 0.05$, $k_{\\mathrm{iso,f}} = 0.05$, $k_{\\mathrm{iso,r}} = 0.05$, $k_{\\mathrm{rxn}} = 0.05$, $p_{A,0} = 0.1$, $p_{A,1} = 1.0$, $T = 10$.\n-   Case 3: $k_{\\mathrm{ads}} = 0.1$, $k_{\\mathrm{des}} = 0.01$, $k_{\\mathrm{iso,f}} = 100$, $k_{\\mathrm{iso,r}} = 50$, $k_{\\mathrm{rxn}} = 50$, $p_{A,0} = 0.01$, $p_{A,1} = 10.0$, $T = 10$.\n\n**Output Format:**\n-   Single line: `[b_1,b_2,b_3]` where $b_i$ is a boolean for whether $\\mathcal{E} \\le \\epsilon_{\\mathrm{acc}}$ for case $i$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is subjected to scrutiny based on the criteria provided.\n\n-   **Scientifically Grounded**: The problem describes a standard microkinetic model based on mass-action kinetics, a cornerstone of chemical reaction engineering and catalysis. The derivation of the ordinary differential equations (ODEs) from the reaction steps is correct. The Steady-State Approximation (SSA) is a widely used and well-understood simplification technique in chemical kinetics. The definitions for timescales are physically meaningful, representing the characteristic relaxation times of the involved processes. The problem is scientifically sound and correctly formulated.\n-   **Well-Posed**: The task involves solving initial value problems (IVPs) for systems of ODEs. The functions defining the ODEs are continuous and well-behaved, ensuring the existence and uniqueness of solutions. All necessary parameters, initial conditions (defined via a steady-state calculation), and definitions are provided. The error metric $\\mathcal{E}$ is rigorously defined, including a regularization term $\\delta$ to prevent division by zero. The structure is logical and leads to a computable, unique result.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased language. All terms are formally defined.\n\nThe problem does not exhibit any of the invalidity flags: it is scientifically sound, fully formalizable, internally consistent, physically plausible, and well-posed.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A solution will be developed.\n\n### Solution Derivations\n\nThe solution requires comparing two models: the full transient model and the SSA-reduced model.\n\n**1. Full Transient Model**\nThe state of the system is described by the coverages $\\theta_A$ and $\\theta_I$. The dynamics are governed by a system of two coupled ODEs. Substituting $\\theta_* = 1 - \\theta_A - \\theta_I$ into the rate term $r_{\\mathrm{ads}}$ and combining all rates yields:\n$$\n\\frac{d\\theta_A}{dt} = k_{\\mathrm{ads}}\\,p_A\\,(1 - \\theta_A - \\theta_I) - k_{\\mathrm{des}}\\,\\theta_A - k_{\\mathrm{iso,f}}\\,\\theta_A + k_{\\mathrm{iso,r}}\\,\\theta_I\n$$\n$$\n\\frac{d\\theta_I}{dt} = k_{\\mathrm{iso,f}}\\,\\theta_A - (k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}})\\,\\theta_I\n$$\nThis is an initial value problem defined by the vector field $\\frac{d}{dt} \\begin{pmatrix} \\theta_A \\\\ \\theta_I \\end{pmatrix} = \\mathbf{f}(\\theta_A, \\theta_I, p_A, \\mathbf{k})$, where $\\mathbf{k}$ is the vector of rate constants.\n\n**2. Steady-State Approximation (SSA) Model**\nThe SSA is applied to the intermediate species $I^*$, assuming its net rate of formation is zero at all times $t \\ge 0$:\n$$\n\\frac{d\\theta_I}{dt} = k_{\\mathrm{iso,f}}\\,\\theta_A - (k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}})\\,\\theta_I \\approx 0\n$$\nThis provides an algebraic relationship between $\\theta_I$ and $\\theta_A$:\n$$\n\\theta_I^{\\mathrm{SSA}}(t) = \\frac{k_{\\mathrm{iso,f}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}} \\theta_A^{\\mathrm{SSA}}(t)\n$$\nSubstituting this into the ODE for $\\theta_A$ eliminates $\\theta_I$ and reduces the system to a single ODE for $\\theta_A^{\\mathrm{SSA}}(t)$. After substitution and simplification, the term $(- k_{\\mathrm{iso,f}}\\,\\theta_A + k_{\\mathrm{iso,r}}\\,\\theta_I)$ becomes:\n$$\n- k_{\\mathrm{iso,f}}\\,\\theta_A + k_{\\mathrm{iso,r}}\\left(\\frac{k_{\\mathrm{iso,f}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}} \\theta_A\\right) = \\left(-k_{\\mathrm{iso,f}} + \\frac{k_{\\mathrm{iso,r}}k_{\\mathrm{iso,f}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}}\\right)\\theta_A = \\frac{-k_{\\mathrm{iso,f}}(k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}) + k_{\\mathrm{iso,r}}k_{\\mathrm{iso,f}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}}\\theta_A = -\\frac{k_{\\mathrm{iso,f}}k_{\\mathrm{rxn}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}}\\theta_A\n$$\nThe full ODE for $\\theta_A^{\\mathrm{SSA}}$ is:\n$$\n\\frac{d\\theta_A^{\\mathrm{SSA}}}{dt} = k_{\\mathrm{ads}}\\,p_A\\,\\left(1 - \\theta_A^{\\mathrm{SSA}} - \\frac{k_{\\mathrm{iso,f}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}} \\theta_A^{\\mathrm{SSA}}\\right) - k_{\\mathrm{des}}\\,\\theta_A^{\\mathrm{SSA}} - \\frac{k_{\\mathrm{iso,f}}k_{\\mathrm{rxn}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}}\\theta_A^{\\mathrm{SSA}}\n$$\nThis is a first-order linear ODE in $\\theta_A^{\\mathrm{SSA}}$.\n\n**3. Initial Conditions**\nThe initial conditions at $t=0$ are the steady-state coverages corresponding to the pressure $p_{A,0}$. At steady state, both $d\\theta_A/dt=0$ and $d\\theta_I/dt=0$. This leads to a system of two linear algebraic equations for the unknowns $\\theta_{A,ss}$ and $\\theta_{I,ss}$:\n$$\n0 = k_{\\mathrm{ads}}\\,p_{A,0}\\,(1 - \\theta_{A,ss} - \\theta_{I,ss}) - k_{\\mathrm{des}}\\,\\theta_{A,ss} - k_{\\mathrm{iso,f}}\\,\\theta_{A,ss} + k_{\\mathrm{iso,r}}\\,\\theta_{I,ss}\n$$\n$$\n0 = k_{\\mathrm{iso,f}}\\,\\theta_{A,ss} - (k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}})\\,\\theta_{I,ss}\n$$\nThe second equation immediately gives $\\theta_{I,ss} = \\frac{k_{\\mathrm{iso,f}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}}\\theta_{A,ss}$, which is the same algebraic relation used in the SSA. Substituting this into the first equation and solving for $\\theta_{A,ss}$ yields:\n$$\n\\theta_{A,ss}(p_A) = \\frac{k_{\\mathrm{ads}}\\,p_A}{k_{\\mathrm{ads}}\\,p_A \\left(1 + \\frac{k_{\\mathrm{iso,f}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}}\\right) + k_{\\mathrm{des}} + \\frac{k_{\\mathrm{iso,f}}k_{\\mathrm{rxn}}}{k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}}}}\n$$\nThe initial conditions for the transient simulations are $\\theta_A(0) = \\theta_{A,ss}(p_{A,0})$ and $\\theta_I(0) = \\theta_{I,ss}(p_{A,0})$. Note that the initial conditions are identical for both the full and SSA models, as the steady-state condition is equivalent to the SSA condition.\n\n**4. Numerical Implementation**\nThe procedure for each test case is as follows:\n1.  Calculate the initial coverages $\\theta_A(0)$ and $\\theta_I(0)$ using the steady-state equations with pressure $p_{A,0}$.\n2.  Integrate the full $2$-dimensional ODE system from $t=0$ to $T$ using the initial conditions and pressure $p_{A,1}$ to obtain the functions $\\theta_A^{\\mathrm{full}}(t)$ and $\\theta_I^{\\mathrm{full}}(t)$. A numerical solver like `scipy.integrate.solve_ivp` with dense output is suitable.\n3.  Integrate the SSA-reduced $1$-dimensional ODE for $\\theta_A^{\\mathrm{SSA}}$ from $t=0$ to $T$ using the initial condition $\\theta_A(0)$ and pressure $p_{A,1}$ to get $\\theta_A^{\\mathrm{SSA}}(t)$. Then compute $\\theta_I^{\\mathrm{SSA}}(t)$ using the algebraic relation.\n4.  Define the integrands for the error metric $\\mathcal{E}$. The numerator integrand is $f_{num}(t) = (\\theta_A^{\\mathrm{SSA}}(t) - \\theta_A^{\\mathrm{full}}(t))^2 + (\\theta_I^{\\mathrm{SSA}}(t) - \\theta_I^{\\mathrm{full}}(t))^2$. The denominator integrand is $f_{den}(t) = (\\theta_A^{\\mathrm{full}}(t))^2 + (\\theta_I^{\\mathrm{full}}(t))^2$.\n5.  Compute the integrals $\\int_0^T f_{num}(t)\\,dt$ and $\\int_0^T f_{den}(t)\\,dt$ using a numerical quadrature method like `scipy.integrate.quad`.\n6.  Calculate the error $\\mathcal{E}$ using its definition with $\\delta = 10^{-12}$.\n7.  Calculate the timescales $\\tau_{\\mathrm{fast}} = 1 / (k_{\\mathrm{iso,f}} + k_{\\mathrm{iso,r}} + k_{\\mathrm{rxn}})$ and $\\tau_{\\mathrm{slow}} = 1 / (k_{\\mathrm{ads}}\\,p_{A,1} + k_{\\mathrm{des}})$.\n8.  Calculate the acceptance threshold $\\epsilon_{\\mathrm{acc}} = \\min(\\epsilon_{\\max}, \\alpha \\frac{\\tau_{\\mathrm{fast}}}{\\tau_{\\mathrm{slow}}})$ with $\\epsilon_{\\max} = 0.02$ and $\\alpha = 2.0$.\n9.  Determine the boolean result by checking if $\\mathcal{E} \\le \\epsilon_{\\mathrm{acc}}$.\n\nThis procedure is repeated for all three test cases to generate the final list of boolean values. Case $1$ is expected to be accepted due to large timescale separation (fast isomerization, slow adsorption). Case $2$ is expected to be rejected due to poor timescale separation. Case $3$ has excellent timescale separation and should be accepted, despite operating in a different pressure regime.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\n\ndef solve():\n    \"\"\"\n    Validates the Steady-State Approximation (SSA) for a given microkinetic model\n    by comparing it to the full transient solution.\n    \"\"\"\n    test_cases = [\n        # Case 1: Timescale separation, happy path\n        {\n            \"k_ads\": 0.2, \"k_des\": 0.05, \"k_iso_f\": 50.0, \"k_iso_r\": 30.0, \"k_rxn\": 20.0,\n            \"pA0\": 0.1, \"pA1\": 1.0, \"T\": 10.0\n        },\n        # Case 2: Poor separation, boundary condition\n        {\n            \"k_ads\": 0.2, \"k_des\": 0.05, \"k_iso_f\": 0.05, \"k_iso_r\": 0.05, \"k_rxn\": 0.05,\n            \"pA0\": 0.1, \"pA1\": 1.0, \"T\": 10.0\n        },\n        # Case 3: Near saturation, but excellent separation\n        {\n            \"k_ads\": 0.1, \"k_des\": 0.01, \"k_iso_f\": 100.0, \"k_iso_r\": 50.0, \"k_rxn\": 50.0,\n            \"pA0\": 0.01, \"pA1\": 10.0, \"T\": 10.0\n        }\n    ]\n\n    # Global constants\n    DELTA = 1e-12\n    EPS_MAX = 0.02\n    ALPHA = 2.0\n\n    results = []\n    \n    for case in test_cases:\n        k_ads = case[\"k_ads\"]\n        k_des = case[\"k_des\"]\n        k_iso_f = case[\"k_iso_f\"]\n        k_iso_r = case[\"k_iso_r\"]\n        k_rxn = case[\"k_rxn\"]\n        pA0 = case[\"pA0\"]\n        pA1 = case[\"pA1\"]\n        T = case[\"T\"]\n\n        # 1. Calculate initial conditions (steady-state at pA0)\n        def get_steady_state(pA, k_ads, k_des, k_iso_f, k_iso_r, k_rxn):\n            # Solves for theta_A and theta_I at steady state for a given pressure pA\n            # theta_I = C_I * theta_A where C_I = k_iso_f / (k_iso_r + k_rxn)\n            # k_ads * pA = theta_A * [ k_ads*pA*(1+C_I) + k_des + C_I*k_rxn ]\n            C_I = k_iso_f / (k_iso_r + k_rxn)\n            denominator = k_ads * pA * (1 + C_I) + k_des + C_I * k_rxn\n            theta_A_ss = (k_ads * pA) / denominator if denominator != 0 else 0.0\n            theta_I_ss = C_I * theta_A_ss\n            return np.array([theta_A_ss, theta_I_ss])\n\n        theta0 = get_steady_state(pA0, k_ads, k_des, k_iso_f, k_iso_r, k_rxn)\n\n        # 2. Define ODE systems\n        def full_model(t, y, pA, k_ads, k_des, k_iso_f, k_iso_r, k_rxn):\n            theta_A, theta_I = y\n            theta_star = 1 - theta_A - theta_I\n            dthetaA_dt = k_ads * pA * theta_star - k_des * theta_A - k_iso_f * theta_A + k_iso_r * theta_I\n            dthetaI_dt = k_iso_f * theta_A - k_iso_r * theta_I - k_rxn * theta_I\n            return [dthetaA_dt, dthetaI_dt]\n\n        def ssa_model(t, y, pA, k_ads, k_des, k_iso_f, k_iso_r, k_rxn):\n            theta_A_ssa = y[0]\n            # Algebraic relation: theta_I_ssa = C_I * theta_A_ssa\n            C_I = k_iso_f / (k_iso_r + k_rxn)\n            theta_I_ssa = C_I * theta_A_ssa\n            \n            theta_star_ssa = 1 - theta_A_ssa - theta_I_ssa\n            # The term (-k_iso_f*theta_A + k_iso_r*theta_I) becomes -(k_iso_f*k_rxn / (k_iso_r+k_rxn)) * theta_A\n            eff_rxn_term = (k_iso_f * k_rxn) / (k_iso_r + k_rxn)\n            dthetaA_dt_ssa = k_ads * pA * theta_star_ssa - k_des * theta_A_ssa - eff_rxn_term * theta_A_ssa\n            return [dthetaA_dt_ssa]\n\n        # 3. Integrate both models\n        sol_full = solve_ivp(\n            full_model, [0, T], theta0,\n            args=(pA1, k_ads, k_des, k_iso_f, k_iso_r, k_rxn),\n            dense_output=True, method='LSODA'\n        )\n        \n        # SSA model only needs theta_A(0) as initial condition\n        sol_ssa = solve_ivp(\n            ssa_model, [0, T], [theta0[0]],\n            args=(pA1, k_ads, k_des, k_iso_f, k_iso_r, k_rxn),\n            dense_output=True, method='LSODA'\n        )\n        \n        C_I_const = k_iso_f / (k_iso_r + k_rxn)\n\n        # 4. Define integrands for error calculation\n        def numerator_integrand(t):\n            theta_full_t = sol_full.sol(t)\n            theta_A_ssa_t = sol_ssa.sol(t)[0]\n            theta_I_ssa_t = C_I_const * theta_A_ssa_t\n            \n            diff_A = theta_A_ssa_t - theta_full_t[0]\n            diff_I = theta_I_ssa_t - theta_full_t[1]\n            return diff_A**2 + diff_I**2\n\n        def denominator_integrand(t):\n            theta_full_t = sol_full.sol(t)\n            return theta_full_t[0]**2 + theta_full_t[1]**2\n\n        # 5. Compute integrals\n        integral_num, _ = quad(numerator_integrand, 0, T, limit=200)\n        integral_den, _ = quad(denominator_integrand, 0, T, limit=200)\n\n        # 6. Calculate error E\n        error_E = np.sqrt(integral_num / (integral_den + DELTA))\n\n        # 7. Calculate timescales and acceptance threshold\n        tau_fast = 1.0 / (k_iso_f + k_iso_r + k_rxn)\n        tau_slow = 1.0 / (k_ads * pA1 + k_des)\n        \n        eps_acc = min(EPS_MAX, ALPHA * (tau_fast / tau_slow))\n        \n        # 8. Compare and store result\n        is_acceptable = error_E = eps_acc\n        results.append(is_acceptable)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "The true power of the SSA is revealed when microkinetic models are coupled with macroscopic phenomena, such as heat and mass transport in a reactor, which can in turn challenge the validity of the approximation. This advanced practice explores the interplay between a fast surface reaction network and slow thermal dynamics, a classic multiscale problem in reaction engineering. By using an SSA-derived rate law to analyze complex behaviors like thermal ignition, you will also learn how the timescale separation justifying the SSA can break down near system-level critical points, providing a deep insight into the context-dependent nature of model reduction .",
            "id": "3900460",
            "problem": "Consider a well-stirred catalytic reactor in which a single gas-phase reactant adsorbs onto a catalytic surface and is converted to a product via an exothermic surface reaction. The microkinetic scheme contains one surface intermediate with coverage dynamics modeled by mass-action kinetics and site conservation. The temperature dynamics are governed by a lumped energy balance with linear heat removal to an external fluid at a fixed temperature. Your task is to formalize this system, apply the steady-state approximation for the surface intermediate when justified, couple the resulting microkinetic rate to the energy balance, and analyze thermal ignition and the validity of the steady-state approximation near critical points.\n\nFundamental base and assumptions to use:\n- Adsorption-desorption-reaction sequence on a single site type with site conservation: the surface coverage of the reactive intermediate is a scalar function denoted by $\\theta(t)$ with $0 \\le \\theta \\le 1$, and the rate expressions follow mass-action kinetics.\n- Arrhenius law for the temperature dependence of the rate constant of the surface reaction: the reaction step has a rate constant $k_{\\mathrm{rxn}}(T)$ that obeys $\\ln k_{\\mathrm{rxn}}(T)$ being linear in $1/T$ through an activation energy $E_{\\mathrm{a}}$ and a pre-exponential factor $k_0$.\n- Ideal lumped (isothermal spatially) energy balance with linear heat removal and volumetric heat capacity: the temperature $T(t)$ evolves according to an energy balance that includes linear heat loss to a coolant at feed temperature $T_{\\mathrm{f}}$ and heat generation per volume due to the exothermic surface reaction. The volumetric heat capacity of the reacting system is $C_{\\mathrm{v}}$.\n- Constant gas-phase driving (reactant partial pressure sufficiently high and constant) so that the adsorption step is effectively first order in the fraction of empty sites (captured by a constant effective adsorption rate constant).\n- Surface area per unit reactor volume $a_{\\mathrm{s}}$ and surface site density $N_{\\mathrm{s}}$ allow conversion between per-area and per-volume rates.\n- Negative heat of reaction per mole of reactant, $\\Delta H_{\\mathrm{rxn}}0$, with magnitude $|\\Delta H_{\\mathrm{rxn}}|$.\n\nModel formulation:\n- The coverage dynamics are described by $d\\theta/dt$ driven by adsorption onto empty sites, desorption, and reaction consumption of the intermediate, using mass-action kinetics and site conservation.\n- The molar surface reaction flux is $r_{\\mathrm{surf}}(T,\\theta)$ and the volumetric reaction rate is $R_{\\mathrm{v}}(T,\\theta)=a_{\\mathrm{s}}\\,r_{\\mathrm{surf}}(T,\\theta)$. The volumetric heat generation rate is $Q_{\\mathrm{gen}}(T,\\theta)=|\\Delta H_{\\mathrm{rxn}}|\\,R_{\\mathrm{v}}(T,\\theta)$.\n- Let the linear volumetric heat removal be $Q_{\\mathrm{rem}}(T)=h_{\\mathrm{v}}\\,(T-T_{\\mathrm{f}})$, with $h_{\\mathrm{v}}0$ a volumetric heat transfer coefficient. The energy balance is $C_{\\mathrm{v}}\\,dT/dt=-Q_{\\mathrm{rem}}(T)+Q_{\\mathrm{gen}}(T,\\theta)$.\n\nTasks:\n1. Starting from the fundamental base and model formulation above, apply the steady-state approximation (SSA) to the surface coverage $\\theta$ where justified. Express the resulting algebraic coverage $\\theta_{\\mathrm{ss}}(T)$ and the corresponding volumetric heat generation $Q_{\\mathrm{gen}}(T,\\theta_{\\mathrm{ss}}(T))$ as functions of $T$ only. Use $k_{\\mathrm{rxn}}(T)$ from Arrhenius law, $k_{\\mathrm{rxn}}(T)=k_0\\,\\exp\\!\\big(-E_{\\mathrm{a}}/(R\\,T)\\big)$, where $R$ is the universal gas constant and $T$ is in Kelvin.\n2. Define the scalar function $F(T)=-Q_{\\mathrm{rem}}(T)+Q_{\\mathrm{gen}}(T,\\theta_{\\mathrm{ss}}(T))$. A temperature steady state $T^\\ast$ satisfies $F(T^\\ast)=0$. Analyze the stability of each steady state using the sign of $F'(T^\\ast)$: a steady state is stable if $F'(T^\\ast)0$ and unstable if $F'(T^\\ast)0$, which follows from linearization of $C_{\\mathrm{v}}\\,dT/dt=F(T)$.\n3. Demonstrate how thermal coupling can lead to ignition phenomena by identifying multiplicity of steady states (two or more distinct $T^\\ast$ values) with alternating stability (low-temperature stable, intermediate unstable, high-temperature stable), which indicates possible ignition/extinction via saddle-node (fold) bifurcations.\n4. Near a critical point (saddle-node), the thermal timescale $ \\tau_T(T^\\ast)=C_{\\mathrm{v}}/|F'(T^\\ast)|$ becomes large. Re-evaluate the validity of SSA for $\\theta$ by comparing the coverage relaxation timescale $\\tau_\\theta(T^\\ast)$ to $\\tau_T(T^\\ast)$ at the nearest-to-critical steady state (the one with smallest $|F'(T^\\ast)|$). Define $\\tau_\\theta(T)=1/\\big(k_{\\mathrm{ads}}+k_{\\mathrm{des}}+k_{\\mathrm{rxn}}(T)\\big)$ and the SSA validity metric $\\varepsilon(T^\\ast)=\\tau_\\theta(T^\\ast)/\\tau_T(T^\\ast)$. For this problem, declare SSA valid at the near-critical steady state if $\\varepsilon(T^\\ast)0.1$ and invalid otherwise.\n\nPhysical units and constants:\n- Use $T$ in Kelvin ($\\mathrm{K}$), $C_{\\mathrm{v}}$ in Joules per cubic meter Kelvin ($\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$), $h_{\\mathrm{v}}$ in Watts per cubic meter Kelvin ($\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$), $|\\Delta H_{\\mathrm{rxn}}|$ in Joules per mole ($\\mathrm{J}\\,\\mathrm{mol}^{-1}$), $a_{\\mathrm{s}}$ in square meters per cubic meter ($\\mathrm{m}^2\\,\\mathrm{m}^{-3}$), $N_{\\mathrm{s}}$ in moles per square meter ($\\mathrm{mol}\\,\\mathrm{m}^{-2}$), $k_{\\mathrm{ads}}$, $k_{\\mathrm{des}}$, and $k_{\\mathrm{rxn}}$ in inverse seconds ($\\mathrm{s}^{-1}$), and $R$ in Joules per mole Kelvin ($\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$).\n\nNumerical requirements:\n- Your program must compute all steady-state temperatures $T^\\ast$ by finding roots of $F(T)$ over a physically reasonable temperature interval. Use bracketing and root-finding on subintervals where the sign of $F(T)$ changes. Classify the stability of each root using $F'(T^\\ast)$ computed numerically.\n- The final answer for each test case must be a list of fundamental types containing: the integer number of steady states, the lowest steady-state temperature in $\\mathrm{K}$ rounded to three decimals, the highest steady-state temperature in $\\mathrm{K}$ rounded to three decimals, a boolean indicating whether ignition is possible (defined as the presence of at least two stable steady states separated by an unstable steady state), and a boolean indicating whether SSA is valid at the near-critical steady state under the criterion above.\n\nTest suite:\nCompute the outputs for the following parameter sets (all parameters not listed in a case use the common values given below):\n- Common values: $R=8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, $T_{\\mathrm{f}}=500\\,\\mathrm{K}$, $|\\Delta H_{\\mathrm{rxn}}|=1.20\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $a_{\\mathrm{s}}=5.0\\times 10^3\\,\\mathrm{m}^2\\,\\mathrm{m}^{-3}$, $N_{\\mathrm{s}}=2.0\\times 10^{-5}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}$, $E_{\\mathrm{a}}=8.0\\times 10^4\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $k_0=1.0\\times 10^{10}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{des}}=0.10\\,\\mathrm{s}^{-1}$, $C_{\\mathrm{v}}=3.0\\times 10^6\\,\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$.\n- Case $1$ (strong heat removal, single steady state expected): $h_{\\mathrm{v}}=1.0\\times 10^6\\,\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$, $k_{\\mathrm{ads}}=2.0\\times 10^3\\,\\mathrm{s}^{-1}$.\n- Case $2$ (moderate heat removal, multiplicity possible): $h_{\\mathrm{v}}=5.0\\times 10^4\\,\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$, $k_{\\mathrm{ads}}=2.0\\times 10^3\\,\\mathrm{s}^{-1}$.\n- Case $3$ (near-critical heat removal): $h_{\\mathrm{v}}=8.0\\times 10^4\\,\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$, $k_{\\mathrm{ads}}=2.0\\times 10^3\\,\\mathrm{s}^{-1}$.\n- Case $4$ (weak adsorption, boundary case): $h_{\\mathrm{v}}=5.0\\times 10^4\\,\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$, $k_{\\mathrm{ads}}=1.0\\,\\mathrm{s}^{-1}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, where each element is itself a list in the order specified above. For example, the output must look like $[\\,[n_1,T_{\\min,1},T_{\\max,1},\\mathrm{ign}_1,\\mathrm{ssa}_1],\\,[n_2,T_{\\min,2},T_{\\max,2},\\mathrm{ign}_2,\\mathrm{ssa}_2],\\,[n_3,T_{\\min,3},T_{\\max,3},\\mathrm{ign}_3,\\mathrm{ssa}_3],\\,[n_4,T_{\\min,4},T_{\\max,4},\\mathrm{ign}_4,\\mathrm{ssa}_4]\\,]$ with booleans rendered as programming language booleans and temperatures in Kelvin rounded to three decimals. No additional text should be printed.",
            "solution": "We begin from the mass-action microkinetic scheme on a single site type with site conservation. Let $\\theta(t)$ denote the coverage of the reactive intermediate, and $1-\\theta(t)$ the fraction of empty sites. The adsorption is taken as effectively first order into empty sites with rate constant $k_{\\mathrm{ads}}$ (absorbing the dependence on reactant partial pressure under the constant driving assumption). Desorption is first order in $\\theta$ with rate constant $k_{\\mathrm{des}}$. The surface reaction step consumes the intermediate with a rate constant $k_{\\mathrm{rxn}}(T)$ that obeys Arrhenius law. The coverage dynamics are therefore\n$$\n\\frac{d\\theta}{dt} = k_{\\mathrm{ads}}\\,(1-\\theta) - k_{\\mathrm{des}}\\,\\theta - k_{\\mathrm{rxn}}(T)\\,\\theta.\n$$\nDefine $k_{\\mathrm{sum}}(T) = k_{\\mathrm{ads}} + k_{\\mathrm{des}} + k_{\\mathrm{rxn}}(T)$. When the steady-state approximation (SSA) is valid for the intermediate, we set $d\\theta/dt \\approx 0$ and solve the algebraic balance, yielding\n$$\n0 = k_{\\mathrm{ads}} - k_{\\mathrm{sum}}(T)\\,\\theta_{\\mathrm{ss}}(T) \\quad \\Rightarrow \\quad \\theta_{\\mathrm{ss}}(T) = \\frac{k_{\\mathrm{ads}}}{k_{\\mathrm{ads}} + k_{\\mathrm{des}} + k_{\\mathrm{rxn}}(T)}.\n$$\nThe surface reaction molar flux (per area) is $r_{\\mathrm{surf}}(T,\\theta) = k_{\\mathrm{rxn}}(T)\\,\\theta\\,N_{\\mathrm{s}}$, where $N_{\\mathrm{s}}$ is the surface site density in $\\mathrm{mol}\\,\\mathrm{m}^{-2}$. Converting to volumetric rate using the surface area per unit volume $a_{\\mathrm{s}}$, the volumetric reaction rate is\n$$\nR_{\\mathrm{v}}(T,\\theta) = a_{\\mathrm{s}}\\,r_{\\mathrm{surf}}(T,\\theta) = a_{\\mathrm{s}}\\,k_{\\mathrm{rxn}}(T)\\,\\theta\\,N_{\\mathrm{s}}.\n$$\nUsing SSA, this becomes a function of $T$ only:\n$$\nR_{\\mathrm{v}}(T,\\theta_{\\mathrm{ss}}(T)) = a_{\\mathrm{s}}\\,N_{\\mathrm{s}}\\,\\frac{k_{\\mathrm{rxn}}(T)\\,k_{\\mathrm{ads}}}{k_{\\mathrm{ads}} + k_{\\mathrm{des}} + k_{\\mathrm{rxn}}(T)}.\n$$\nThe exothermic heat generation per unit volume is $Q_{\\mathrm{gen}}(T,\\theta_{\\mathrm{ss}}(T)) = |\\Delta H_{\\mathrm{rxn}}|\\,R_{\\mathrm{v}}(T,\\theta_{\\mathrm{ss}}(T))$, and the linear heat removal per unit volume is $Q_{\\mathrm{rem}}(T) = h_{\\mathrm{v}}\\,(T - T_{\\mathrm{f}})$. The energy balance is modeled as\n$$\nC_{\\mathrm{v}}\\,\\frac{dT}{dt} = -Q_{\\mathrm{rem}}(T) + Q_{\\mathrm{gen}}(T,\\theta_{\\mathrm{ss}}(T)) \\equiv F(T).\n$$\nA steady-state temperature $T^\\ast$ satisfies the scalar equation\n$$\nF(T^\\ast) = -h_{\\mathrm{v}}\\,(T^\\ast - T_{\\mathrm{f}}) + |\\Delta H_{\\mathrm{rxn}}|\\,a_{\\mathrm{s}}\\,N_{\\mathrm{s}}\\,\\frac{k_{\\mathrm{rxn}}(T^\\ast)\\,k_{\\mathrm{ads}}}{k_{\\mathrm{ads}} + k_{\\mathrm{des}} + k_{\\mathrm{rxn}}(T^\\ast)} = 0,\n$$\nwith $k_{\\mathrm{rxn}}(T) = k_0\\,\\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{R\\,T}\\right)$.\n\nTo analyze stability, linearize the scalar ordinary differential equation around a steady state $T^\\ast$. Let $T = T^\\ast + \\delta T$ with $|\\delta T|$ small. Then\n$$\nC_{\\mathrm{v}}\\,\\frac{d\\,\\delta T}{dt} \\approx F'(T^\\ast)\\,\\delta T.\n$$\nIf $F'(T^\\ast)  0$, small perturbations decay exponentially and the steady state is stable; if $F'(T^\\ast)  0$, perturbations grow and the steady state is unstable. The derivative $F'(T)$ can be computed numerically via a central finite difference for robustness:\n$$\nF'(T) \\approx \\frac{F(T+\\Delta T) - F(T-\\Delta T)}{2\\,\\Delta T},\n$$\nwith $\\Delta T$ chosen sufficiently small, for example $1.0\\times 10^{-3}\\,\\mathrm{K}$ to $1.0\\times 10^{-2}\\,\\mathrm{K}$.\n\nThermal ignition phenomena occur in this coupled system when the heat generation rises rapidly with temperature (due to the Arrhenius dependence of $k_{\\mathrm{rxn}}(T)$), generating multiple intersections between $Q_{\\mathrm{gen}}(T,\\theta_{\\mathrm{ss}}(T))$ and $Q_{\\mathrm{rem}}(T)$ as functions of $T$. The characteristic signature of ignition/extinction includes three steady states in temperature: a low-temperature stable state (near $T_{\\mathrm{f}}$), an intermediate unstable state, and a high-temperature stable state. Transitions between branches occur at critical points (saddle-node, also called fold bifurcation), where $F(T^\\ast)=0$ and $F'(T^\\ast)=0$.\n\nNear a critical point, the thermal timescale becomes large because the linearized dynamics slow down: define the thermal timescale at a steady state\n$$\n\\tau_T(T^\\ast) = \\frac{C_{\\mathrm{v}}}{|F'(T^\\ast)|}.\n$$\nThe coverage relaxation timescale is obtained from the eigenvalue of the linearized coverage equation,\n$$\n\\tau_\\theta(T) = \\frac{1}{k_{\\mathrm{ads}} + k_{\\mathrm{des}} + k_{\\mathrm{rxn}}(T)}.\n$$\nThe steady-state approximation for $\\theta$ is justified if the coverage relaxes much faster than the thermal dynamics, namely if $\\varepsilon(T^\\ast) = \\tau_\\theta(T^\\ast)/\\tau_T(T^\\ast) \\ll 1$. In this problem, we use the quantitative criterion $\\varepsilon(T^\\ast)  0.1$ to declare SSA valid at the near-critical steady state (the one with smallest $|F'(T^\\ast)|$).\n\nAlgorithmic design to meet the numerical requirements:\n- For each test case, define $F(T)$ from the parameters and SSA-based $Q_{\\mathrm{gen}}(T,\\theta_{\\mathrm{ss}}(T))$.\n- Scan a temperature interval, for example $[250\\,\\mathrm{K},1200\\,\\mathrm{K}]$, tabulating $F(T)$ on a fine grid to detect sign changes. Each sign change bracket $(T_i, T_{i+1})$ indicates the presence of a root; use a robust bracketing root finder to compute $T^\\ast$ in that bracket.\n- Deduplicate roots that may arise from numerical artifacts by clustering within a small tolerance, such as $10^{-6}\\,\\mathrm{K}$.\n- Compute $F'(T^\\ast)$ via central finite difference and classify stability by the sign.\n- Determine ignition possibility: sort the steady states by increasing $T^\\ast$ and check for the pattern of stability being stable–unstable–stable with at least two stable states separated by an unstable one.\n- Identify the near-critical steady state by finding the one with the smallest $|F'(T^\\ast)|$. Evaluate $\\tau_T(T^\\ast)$ and $\\tau_\\theta(T^\\ast)$, compute $\\varepsilon(T^\\ast)$, and compare to the threshold $0.1$ to decide SSA validity.\n- Report the integer number of steady states, the minimum and maximum $T^\\ast$ rounded to three decimals (in $\\mathrm{K}$), the ignition boolean, and the SSA validity boolean for the near-critical steady state, in the specified single-line aggregated output format.\n\nThis approach integrates the underlying microkinetic and thermal physics, demonstrates how thermal coupling induces multiplicity and ignition, and provides a quantitative re-evaluation of the steady-state approximation near critical points by comparing intrinsic timescales.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\n# Constants common to all cases\nR = 8.314  # J/mol/K\nT_feed = 500.0  # K\ndH_abs = 1.20e5  # J/mol (magnitude of exothermic heat)\na_s = 5.0e3  # m^2/m^3\nN_s = 2.0e-5  # mol/m^2\nE_a = 8.0e4  # J/mol\nk0 = 1.0e10  # 1/s\nk_des = 0.10  # 1/s\nC_v = 3.0e6  # J/m^3/K\n\n# Temperature domain for root finding\nT_min = 250.0  # K\nT_max = 1200.0  # K\ngrid_points = 5000  # resolution for scanning\n\ndef k_rxn(T):\n    # Arrhenius rate constant for the reaction step\n    return k0 * np.exp(-E_a / (R * T))\n\ndef theta_ss(T, k_ads):\n    # SSA coverage\n    return k_ads / (k_ads + k_des + k_rxn(T))\n\ndef R_vol(T, k_ads):\n    # Volumetric molar rate under SSA\n    return a_s * N_s * k_rxn(T) * theta_ss(T, k_ads)\n\ndef Q_gen(T, k_ads):\n    # Volumetric heat generation (positive for exothermic)\n    return dH_abs * R_vol(T, k_ads)\n\ndef Q_rem(T, h_v):\n    # Volumetric heat removal\n    return h_v * (T - T_feed)\n\ndef F(T, k_ads, h_v):\n    # RHS of energy balance: C_v dT/dt = F(T)\n    return -Q_rem(T, h_v) + Q_gen(T, k_ads)\n\ndef Fprime_numeric(T, k_ads, h_v, dT=1e-3):\n    # Numerical derivative using central difference\n    Tp = min(T_max, T + dT)\n    Tm = max(T_min, T - dT)\n    return (F(Tp, k_ads, h_v) - F(Tm, k_ads, h_v)) / (Tp - Tm)\n\ndef find_roots(k_ads, h_v):\n    # Scan for sign changes and refine with brentq\n    Ts = np.linspace(T_min, T_max, grid_points)\n    Fs = F(Ts, k_ads, h_v)\n    roots = []\n    for i in range(len(Ts) - 1):\n        f1 = Fs[i]\n        f2 = Fs[i + 1]\n        if np.isnan(f1) or np.isnan(f2):\n            continue\n        if f1 == 0.0:\n            roots.append(Ts[i])\n        elif f2 == 0.0:\n            roots.append(Ts[i + 1])\n        elif f1 * f2  0.0:\n            try:\n                r = brentq(lambda T: F(T, k_ads, h_v), Ts[i], Ts[i + 1], maxiter=100, xtol=1e-12)\n                roots.append(r)\n            except Exception:\n                # Skip if brentq fails\n                pass\n    # Deduplicate roots within tolerance\n    roots_sorted = sorted(roots)\n    dedup = []\n    tol = 1e-6\n    for r in roots_sorted:\n        if not dedup or abs(r - dedup[-1])  tol:\n            dedup.append(r)\n    return dedup\n\ndef classify_stability(roots, k_ads, h_v):\n    # Compute F' and stability for each root\n    derivs = []\n    stabs = []\n    for r in roots:\n        fp = Fprime_numeric(r, k_ads, h_v, dT=1e-3)\n        derivs.append(fp)\n        stabs.append(fp  0.0)\n    return derivs, stabs\n\ndef ignition_possible(roots, stabs):\n    # Ignition if at least two stable steady states separated by an unstable one\n    if len(roots)  3:\n        return False\n    # Assume roots sorted by T ascending and stabs aligned\n    # Look for stable-unstable-stable pattern anywhere\n    for i in range(len(roots) - 2):\n        if stabs[i] and (not stabs[i + 1]) and stabs[i + 2]:\n            return True\n    return False\n\ndef ssa_valid_near_critical(roots, derivs, k_ads, h_v):\n    # Determine near-critical steady state (min |F'|), compute epsilon = tau_theta / tau_T\n    if len(roots) == 0:\n        return False  # No steady state; define as invalid\n    idx = int(np.argmin(np.abs(derivs)))\n    T_star = roots[idx]\n    # Timescales\n    tau_theta = 1.0 / (k_ads + k_des + k_rxn(T_star))\n    fp_abs = max(abs(derivs[idx]), 1e-12)  # avoid division by zero\n    tau_T = C_v / fp_abs\n    epsilon = tau_theta / tau_T\n    return epsilon  0.1\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k_ads, h_v) pairs for cases 1-4\n        (2.0e3, 1.0e6),  # Case 1: strong heat removal\n        (2.0e3, 5.0e4),  # Case 2: moderate heat removal\n        (2.0e3, 8.0e4),  # Case 3: near-critical heat removal\n        (1.0e0, 5.0e4),  # Case 4: weak adsorption\n    ]\n\n    results = []\n    for k_ads, h_v in test_cases:\n        roots = find_roots(k_ads, h_v)\n        roots_sorted = sorted(roots)\n        derivs, stabs = classify_stability(roots_sorted, k_ads, h_v)\n        ign = ignition_possible(roots_sorted, stabs)\n        ssa_ok = ssa_valid_near_critical(roots_sorted, derivs, k_ads, h_v)\n        n_ss = len(roots_sorted)\n        if n_ss == 0:\n            Tmin = float('nan')\n            Tmax = float('nan')\n        else:\n            Tmin = round(roots_sorted[0], 3)\n            Tmax = round(roots_sorted[-1], 3)\n        results.append([n_ss, Tmin, Tmax, ign, ssa_ok])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}