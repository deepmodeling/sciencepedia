{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导您从第一性原理出发，巩固您对谐振子模型的理解。您将从经典的胡克定律和牛顿运动定律推导出双原子分子的振动频率，然后应用量子化条件计算其零点能（$ZPE$），并最终用它来修正电子解离能。这个过程旨在建立一个坚实的概念基础，阐明谐振热化学的核心计算步骤。",
            "id": "3882171",
            "problem": "一个线性双原子分子表现出单一的振动简正模式，可以被建模为一维谐振子。考虑一个气相双原子分子，其折合质量为 $\\mu$，谐波力常数为 $k$。你需要计算其谐波振动波数，然后对解离能进行零点能校正。\n\n仅从适用于谐波热力学的基本定律和核心定义出发：\n- 在线性恢复力场 $F=-kx$ 中，质量为 $\\mu$ 的粒子的经典运动方程。\n- 一维量子谐振子能级的量子化。\n- 角频率 $\\omega$、普通频率 $\\nu$ 和波数 $\\tilde{\\nu}$ 的定义。\n- 通过普朗克关系建立的能量与频率之间的关系。\n\n完成以下任务：\n1. 推导双原子分子的谐波振动波数 $\\tilde{\\nu}$ 的表达式，用 $\\mu$、$k$ 和物理常数表示，并确定要使 $\\tilde{\\nu}$ 以 $\\text{cm}^{-1}$ 为单位表示所必需的单位选择。\n2. 使用你的表达式，计算当参数 $\\mu = 1.328 \\times 10^{-26}$ kg 和 $k = 1170\\ \\text{N m}^{-1}$ 时的 $\\tilde{\\nu}$ 的数值。\n3. 使用谐振子零点能，计算每摩尔分子的零点能。\n4. 一个高水平的电子结构计算给出了该双原子分子的电子解离能（势阱深度）为 $D_{e} = 498.0\\ \\text{kJ mol}^{-1}$。使用你计算的零点能，计算从振动基态开始的解离能 $D_{0}$。\n\n请明确说明你使用的基本常数及其单位，以确保在获得以 $\\text{cm}^{-1}$ 为单位的 $\\tilde{\\nu}$ 和以 $\\text{kJ mol}^{-1}$ 为单位的能量时，量纲分析是一致的。使用以下常数数值：\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\ \\text{J s}$，\n- 光速 $c = 2.99792458 \\times 10^{10}\\ \\text{cm s}^{-1}$，\n- 阿伏伽德罗常数 $N_{A} = 6.02214076 \\times 10^{23}\\ \\text{mol}^{-1}$。\n\n将你的最终答案表示为经过零点能校正的解离能 $D_{0}$，单位为 $\\text{kJ mol}^{-1}$，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导并计算一个被建模为一维谐振子的双原子分子的热化学性质。解题过程首先推导振动波数，然后计算零点能，最后校正电子解离能。\n\n**1. 谐波振动波数 $\\tilde{\\nu}$ 的推导**\n\n分析始于一个折合质量为 $\\mu$ 的粒子在线性恢复力 $F = -kx$ 作用下的经典运动方程，其中 $k$ 是谐波力常数，$x$ 是偏离平衡位置的位移。根据牛顿第二运动定律，$F = \\mu a$，其中加速度 $a = \\frac{d^2x}{dt^2}$。这得到：\n$$\n-kx = \\mu \\frac{d^2x}{dt^2}\n$$\n这个方程可以重排为简谐振子的标准形式：\n$$\n\\frac{d^2x}{dt^2} + \\left(\\frac{k}{\\mu}\\right)x = 0\n$$\n这个方程具有一般形式 $\\frac{d^2x}{dt^2} + \\omega^2 x = 0$，其中 $\\omega$ 是振荡的经典角频率。通过比较这两种形式，我们可以确定角频率为：\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\n角频率 $\\omega$（单位为 $\\mathrm{s}^{-1}$）通过关系式 $\\omega = 2\\pi\\nu$ 与普通频率 $\\nu$（单位为 $\\mathrm{Hz}$ 或 $\\mathrm{s}^{-1}$）相关。因此，普通频率的表达式为：\n$$\n\\nu = \\frac{\\omega}{2\\pi} = \\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu}}\n$$\n波数 $\\tilde{\\nu}$ 被定义为波长 $\\lambda$ 的倒数，它通过关系式 $\\tilde{\\nu} = \\frac{\\nu}{c}$ 与普通频率 $\\nu$ 和光速 $c$ 相关。代入 $\\nu$ 的表达式，得到谐波振动波数的最终表达式：\n$$\n\\tilde{\\nu} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}}\n$$\n为确保 $\\tilde{\\nu}$ 以 $\\text{cm}^{-1}$ 为单位表示，必须为常数和变量使用一组一致的单位。具体来说，光速 $c$ 的单位必须是 $\\text{cm s}^{-1}$。项 $\\sqrt{k/\\mu}$ 的单位必须是 $\\text{s}^{-1}$。对 $k$（$\\text{N m}^{-1}$）和 $\\mu$（kg）使用国际单位制（SI）单位，比率 $k/\\mu$ 的单位变为 $\\frac{\\text{N m}^{-1}}{\\text{kg}} = \\frac{(\\text{kg m s}^{-2})\\ \\text{m}^{-1}}{\\text{kg}} = \\text{s}^{-2}$。因此，$\\sqrt{k/\\mu}$ 的单位是 $\\text{s}^{-1}$。那么 $\\tilde{\\nu}$ 的总表达式的单位就是 $\\frac{\\text{s}^{-1}}{\\text{cm s}^{-1}} = \\text{cm}^{-1}$，符合要求。\n\n**2. $\\tilde{\\nu}$ 的数值计算**\n\n问题提供了以下数值：\n- 折合质量, $\\mu = 1.328 \\times 10^{-26}$ kg\n- 力常数, $k = 1170\\ \\text{N m}^{-1}$\n- 光速, $c = 2.99792458 \\times 10^{10}\\ \\text{cm s}^{-1}$\n\n将这些值代入推导出的 $\\tilde{\\nu}$ 表达式中：\n$$\n\\tilde{\\nu} = \\frac{1}{2\\pi (2.99792458 \\times 10^{10}\\ \\text{cm s}^{-1})} \\sqrt{\\frac{1170\\ \\text{N m}^{-1}}{1.328 \\times 10^{-26}\\ \\text{kg}}}\n$$\n首先，计算平方根内的项：\n$$\n\\frac{k}{\\mu} = \\frac{1170}{1.328 \\times 10^{-26}}\\ \\mathrm{s}^{-2} \\approx 8.80948795 \\times 10^{28}\\ \\mathrm{s}^{-2}\n$$\n接下来，计算角频率 $\\omega$：\n$$\n\\omega = \\sqrt{8.80948795 \\times 10^{28}\\ \\mathrm{s}^{-2}} \\approx 2.96807813 \\times 10^{14}\\ \\mathrm{s}^{-1}\n$$\n最后，除以 $2\\pi c$ 得到波数：\n$$\n\\tilde{\\nu} = \\frac{2.96807813 \\times 10^{14}\\ \\mathrm{s}^{-1}}{2\\pi (2.99792458 \\times 10^{10}\\ \\text{cm s}^{-1})} \\approx 1575.6946\\ \\text{cm}^{-1}\n$$\n在后续步骤中将使用更高精度的该值。\n\n**3. 每摩尔零点能的计算**\n\n量子谐振子的能级是量子化的，由公式 $E_v = (v + \\frac{1}{2})h\\nu$ 给出，其中 $v = 0, 1, 2, \\dots$ 是振动量子数，$h$ 是普朗克常数。零点能（$ZPE$）是最低振动能态的能量，对应于 $v=0$：\n$$\nZPE_{\\mathrm{molecule}} = E_0 = \\frac{1}{2}h\\nu\n$$\n使用关系式 $\\nu = c\\tilde{\\nu}$，单个分子的 $ZPE$ 可以用波数表示：\n$$\nZPE_{\\mathrm{molecule}} = \\frac{1}{2}hc\\tilde{\\nu}\n$$\n要获得每摩尔的零点能（$ZPE_{\\mathrm{mole}}$），我们将每个分子的能量乘以阿伏伽德罗常数 $N_A$：\n$$\nZPE_{\\mathrm{mole}} = N_A \\cdot ZPE_{\\mathrm{molecule}} = \\frac{1}{2}N_A h c \\tilde{\\nu}\n$$\n这个量需要以 $\\text{kJ mol}^{-1}$ 为单位进行计算。乘积 $N_A h c \\tilde{\\nu}$ 的结果单位是 $\\text{J mol}^{-1}$，因此需要一个 $\\frac{1}{1000}$ 的转换因子。使用的常数是：\n- $h = 6.62607015 \\times 10^{-34}\\ \\text{J s}$\n- $c = 2.99792458 \\times 10^{10}\\ \\text{cm s}^{-1}$\n- $N_A = 6.02214076 \\times 10^{23}\\ \\text{mol}^{-1}$\n$$\nZPE_{\\mathrm{mole}} = \\frac{1}{2 \\times 1000} (6.02214076 \\times 10^{23}) (6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^{10}) (1575.6946)\\ \\text{kJ mol}^{-1}\n$$\n$$\nZPE_{\\mathrm{mole}} \\approx \\frac{1}{2000} (11.962656\\ \\text{J mol}^{-1}\\ \\text{cm}) (1575.6946\\ \\text{cm}^{-1})\n$$\n$$\nZPE_{\\mathrm{mole}} \\approx \\frac{18843.95}{2000}\\ \\text{kJ mol}^{-1} \\approx 9.421975\\ \\text{kJ mol}^{-1}\n$$\n\n**4. 解离能 $D_0$ 的计算**\n\n电子解离能 $D_e$ 是从势能曲线的最小值到无限远处分离的原子之间的能量差（“势阱深度”）。实际上，由于不确定性原理，分子不能存在于这个最小值处；其最低可能能量是高于最小值的零点能 $ZPE_{\\mathrm{mole}}$。从振动基态开始的解离能 $D_0$ 是从这个 $v=0$ 能级开始打破化学键所需的能量。这些量之间的关系是：\n$$\nD_0 = D_e - ZPE_{\\mathrm{mole}}\n$$\n给定电子解离能 $D_e = 498.0\\ \\text{kJ mol}^{-1}$ 并使用计算出的摩尔零点能：\n$$\nD_0 = 498.0\\ \\text{kJ mol}^{-1} - 9.421975\\ \\text{kJ mol}^{-1} \\approx 488.578025\\ \\text{kJ mol}^{-1}\n$$\n问题要求最终答案四舍五入到四位有效数字。\n$$\nD_0 \\approx 488.6\\ \\text{kJ mol}^{-1}\n$$",
            "answer": "$$\n\\boxed{488.6}\n$$"
        },
        {
            "introduction": "理解了零点能的计算之后，下一个关键步骤是将其与可观测的化学现象联系起来。本练习探讨了零点能最显著的化学效应之一：动力学同位素效应（Kinetic Isotope Effect, KIE）。通过估算X–H键进行H/D（氢/氘）替换后零点能的变化，您将能够从微观层面理解同位素取代为何能显著改变宏观反应速率，这在催化研究中至关重要。",
            "id": "3882216",
            "problem": "在一个催化循环中，一个表面束缚的中间体表现出一种高频 X-H 伸缩振动，在谐波近似下，该振动可以被建模为一个一维量子谐振子。对于氢同位素体，观测到的波数为 $\\tilde{\\nu}_{\\text{H}}=3000\\ \\text{cm}^{-1}$。考虑在该模式上用氘进行同位素取代，使得该模式的有效振动质量加倍，而局部力常数保持不变。假设振动频率与有效质量的平方根成反比。使用量子谐振子的基态能量作为零点能，估算对于这单一模式，氢被氘取代后零点能的变化，定义为 $\\Delta E_{\\text{ZPE}} = E_{\\text{ZPE}}(\\text{D}) - E_{\\text{ZPE}}(\\text{H})$，并以每摩尔为基准进行计算。将您的最终答案以 $\\text{kJ mol}^{-1}$ 为单位表示，并四舍五入到四位有效数字。对于单一谐振模式，使用关系式 $E = h c \\tilde{\\nu}$ 和 $E_{\\text{ZPE}} = \\frac{1}{2} h c \\tilde{\\nu}$，其中 $h = 6.62607015 \\times 10^{-34}\\ \\text{J s}$，$c = 2.99792458 \\times 10^{10}\\ \\text{cm s}^{-1}$，以及 $N_{\\text{A}} = 6.02214076 \\times 10^{23}\\ \\text{mol}^{-1}$。您也可以等效地使用换算关系 $1\\ \\text{cm}^{-1} = 0.01196266\\ \\text{kJ mol}^{-1}$。当所有其他模式保持不变时，在谐波近似下，请用文字简要说明，在 $T=298\\ \\text{K}$ 时，该零点能的变化预计将如何影响表观自由能垒 $\\Delta G^{\\ddagger}$。只有 $\\Delta E_{\\text{ZPE}}$ 的数值将被作为最终答案评分；讨论部分应包含在您的解题思路中。",
            "solution": "我们从量子谐振子的能级公式 $E_{n} = \\left(n+\\frac{1}{2}\\right) h \\nu = \\left(n+\\frac{1}{2}\\right) h c \\tilde{\\nu}$ 开始，其中 $h$ 是普朗克常数，$c$ 是光速，$\\tilde{\\nu}$ 是波数。因此，单一谐振模式的零点能（基态能量）为 $E_{\\text{ZPE}} = \\frac{1}{2} h c \\tilde{\\nu}$。\n\n在一个由氢原子运动主导的模式上，用氘进行同位素取代后，有效振动质量大约加倍。对于一个力常数固定的谐振子，角频率 $\\omega$ 与有效质量 $\\mu$ 的关系为 $\\omega \\propto \\mu^{-1/2}$。因此，波数 $\\tilde{\\nu}$ 与有效质量 $\\mu$ 的关系为 $\\tilde{\\nu} \\propto \\mu^{-1/2}$。如果质量加倍，那么氘代后的波数为\n$$\n\\tilde{\\nu}_{\\text{D}} = \\frac{\\tilde{\\nu}_{\\text{H}}}{\\sqrt{2}} = \\frac{3000\\ \\text{cm}^{-1}}{\\sqrt{2}} = 3000 \\times \\frac{1}{\\sqrt{2}}\\ \\text{cm}^{-1}.\n$$\n每个分子的零点能变化为\n$$\n\\Delta E_{\\text{ZPE,\\,molecule}} = \\frac{1}{2} h c \\left(\\tilde{\\nu}_{\\text{D}} - \\tilde{\\nu}_{\\text{H}}\\right) = \\frac{1}{2} h c \\left(3000\\left(\\frac{1}{\\sqrt{2}} - 1\\right)\\right)\\ \\text{cm}^{-1}.\n$$\n使用阿伏伽德罗常数 $N_{\\text{A}}$ 将其转换为摩尔量，等同于使用标准的能量-波数换算关系。为方便起见，我们将使用提供的摩尔换算关系：$1\\ \\text{cm}^{-1} = 0.01196266\\ \\text{kJ mol}^{-1}$。因此，\n$$\n\\Delta E_{\\text{ZPE}} = \\frac{1}{2} \\times 0.01196266\\ \\frac{\\text{kJ}}{\\text{mol} \\cdot \\text{cm}^{-1}} \\times \\left(3000\\ \\text{cm}^{-1}\\right)\\left(\\frac{1}{\\sqrt{2}} - 1\\right).\n$$\n计算数值因子：\n$$\n\\frac{1}{\\sqrt{2}} - 1 \\approx 0.7071067811865475 - 1 = -0.2928932188134524,\n$$\n所以\n$$\n\\Delta E_{\\text{ZPE}} = \\frac{1}{2} \\times 0.01196266 \\times 3000 \\times \\left(-0.2928932188134524\\right)\\ \\text{kJ mol}^{-1}.\n$$\n首先计算 $3000 \\times \\left(-0.2928932188134524\\right) = -878.6796564403572\\ \\text{cm}^{-1}$。然后\n$$\n\\Delta E_{\\text{ZPE}} = \\frac{1}{2} \\times 0.01196266 \\times \\left(-878.6796564403572\\right)\\ \\text{kJ mol}^{-1}.\n$$\n这得到\n$$\n\\Delta E_{\\text{ZPE}} \\approx -5.255672989\\ \\text{kJ mol}^{-1}.\n$$\n按要求四舍五入到四位有效数字，结果为\n$$\n\\Delta E_{\\text{ZPE}} \\approx -5.256\\ \\text{kJ mol}^{-1}.\n$$\n\n为了讨论在过渡态理论的谐波近似下对表观自由能垒 $\\Delta G^{\\ddagger}$ 的影响，需要注意振动自由能的贡献包括零点能和热/熵项。对于在 $T=298\\ \\text{K}$ 下的高频 X-H 伸缩振动，基态以上的热布居数可以忽略不计，因此主要的同位素效应来自于零点能。氘代物种具有更低的零点能（负的 $\\Delta E_{\\text{ZPE}}$），从而稳定了振动未激发态。在一个典型的一级动力学同位素效应中，相应的化学键在过渡态中被部分削弱，因此该模式在过渡态中的对应模式的频率低于其在反应物中的频率（或沿反应坐标被投影掉）。因此，在氘代后，反应物的零点能比过渡态的零点能下降得更多，从而增加了 $E_{\\text{TS}} - E_{\\text{R}}$ 的差值，并因此增加了氘相对于氢的 $\\Delta G^{\\ddagger}$。定量地讲，能垒的增加量等于受影响模式在过渡态和反应物之间零点能变化的差值；在没有具体的过渡态频率的情况下，我们无法计算出确切的值，但其符号预计为正（氘的能垒更高），这与正常的动力学同位素效应是一致的。",
            "answer": "$$\\boxed{-5.256}$$"
        },
        {
            "introduction": "谐振子模型虽然强大，但并非普遍适用，尤其是在处理分子内部的大幅度、低频率运动（如甲基旋转）时。本练习将挑战您思考谐振子近似的局限性，并引入一种更精确的处理方法——受阻转子模型。通过设计一个算法来求解一维受阻转子的薛定谔方程，您将亲身体验如何超越谐振近似，从而在计算热化学中获得更高的准确性。",
            "id": "3882162",
            "problem": "您的任务是设计并实现一个完整、可运行的程序，该程序基于沿内坐标的投影扫描，将选定的低频简正模式替换为一维受阻转子，并量化此替换的热化学影响。目标是计算单个低频模式在一维受阻转子（HR）和简谐振子（HO）两种处理方法下的差异，重点关注零点能（ZPE）和有限温度下的亥姆霍兹自由能。您的实现应基于第一性原理，包括量子力学和统计力学，并且必须采用转子的薛定谔方程的数值解法。\n\n从以下基本原理开始：\n- 对于一个转动惯量为 $I$ 的转子，在周期性势 $V(\\phi)$ 下，其角坐标 $\\phi$（以弧度为单位）的薛定谔方程为：\n$$\n\\left[-\\frac{\\hbar^2}{2I}\\frac{d^2}{d\\phi^2} + V(\\phi)\\right]\\psi_n(\\phi) = E_n \\psi_n(\\phi),\n$$\n满足 $2\\pi$ 周期性边界条件 $\\psi(\\phi + 2\\pi) = \\psi(\\phi)$，其中 $\\hbar$ 是约化普朗克常数，$I$ 的单位是 $\\text{kg} \\cdot \\text{m}^2$，$V(\\phi)$ 是单个分子的能量，单位是 J。\n- 正则配分函数由下式给出\n$$\nZ = \\sum_{n} e^{-\\beta E_n}, \\quad \\beta = \\frac{1}{k_\\mathrm{B} T},\n$$\n其中 $k_\\mathrm{B}$ 是玻尔兹曼常数，$T$ 是绝对温度，单位是 K。\n- 单个分子的亥姆霍兹自由能为\n$$\nF = -k_\\mathrm{B} T \\ln Z,\n$$\n而零点能是基态能量 $E_0$。\n- 一个波数为 $\\bar{\\nu}$（单位为 $\\text{cm}^{-1}$）的简谐正交模的能级为\n$$\nE_n^{\\mathrm{HO}} = h c \\bar{\\nu} \\left(n + \\frac{1}{2}\\right),\n$$\n相应的配分函数为\n$$\nZ_{\\mathrm{HO}} = \\sum_{n=0}^{\\infty} e^{-\\beta h c \\bar{\\nu} \\left(n + \\frac{1}{2}\\right)} = \\frac{e^{-\\beta h c \\bar{\\nu}/2}}{1 - e^{-\\beta h c \\bar{\\nu}}},\n$$\n其中 $h$ 是普朗克常数，$c$ 是光速。\n\n您必须实现以下算法步骤：\n1. 将角坐标 $\\phi$ 在一个均匀网格 $\\phi_i = i \\Delta \\phi$（$i = 0,1,\\dots,N-1$）上离散化，其中 $\\Delta \\phi = 2\\pi/N$，并采用周期性边界条件。使用 $N = 256$ 个点。所有角度都必须以弧度处理。\n2. 基于二阶导数的中心差分近似，构建动能算符的有限差分表示。算符 $-\\frac{\\hbar^2}{2I} \\frac{d^2}{d\\phi^2}$ 被映射为一个带周期性环绕（periodic wrap-around）的三对角矩阵。确保符号和缩放正确，使得自由转子的本征值对于整数 $m$ 趋近于 $E_m = \\frac{\\hbar^2 m^2}{2I}$。\n3. 基于投影的内坐标扫描来定义 $V(\\phi)$。为本问题之目的，使用物理上合理且能模拟此类扫描的显式解析形式：\n   - 情况 A（自由转子基准）：$V(\\phi) = 0$（单位 kJ/mol），转动惯量 $I = 10$（单位 $\\text{amu} \\cdot \\text{Å}^2$），简谐波数 $\\bar{\\nu} = 30$（单位 $\\text{cm}^{-1}$）。\n   - 情况 B（三重受阻转子）：$V(\\phi) = \\frac{V_0}{2}\\left(1 - \\cos(3\\phi)\\right)$（单位 kJ/mol），其中 $V_0 = 3$，转动惯量 $I = 5$（单位 $\\text{amu} \\cdot \\text{Å}^2$），简谐波数 $\\bar{\\nu} = 50$（单位 $\\text{cm}^{-1}$）。\n   - 情况 C（非对称受阻转子）：$V(\\phi) = a \\cos(\\phi) + b \\cos(2\\phi) + c \\sin(\\phi)$（单位 kJ/mol），其中 $a = 1.5$，$b = 0.8$，$c = 0.2$，并经过平移以使 $\\min_{\\phi \\in [0,2\\pi)} V(\\phi) = 0$，转动惯量 $I = 3$（单位 $\\text{amu} \\cdot \\text{Å}^2$），简谐波数 $\\bar{\\nu} = 80$（单位 $\\text{cm}^{-1}$）。\n4. 将所有量转换为一致的单位，以用于薛定谔方程和统计力学：\n   - 使用 $I$（单位 $\\text{kg} \\cdot \\text{m}^2$），通过 $I\\,[\\text{kg} \\cdot \\text{m}^2] = I\\,[\\text{amu} \\cdot \\text{Å}^2] \\times m_\\mathrm{u} \\times \\left(10^{-10}\\right)^2$ 计算，其中 $m_\\mathrm{u}$ 是原子质量单位。\n   - 将势能从 kJ/mol 转换为每个分子的 J，通过除以阿伏伽德罗数并乘以 $1000$。\n   - 使用 $\\bar{\\nu}$（单位 $\\text{cm}^{-1}$）计算每个分子的量子能量 $\\epsilon = h c \\bar{\\nu}$（单位 J）。\n   - 使用 $T = 298.15$ K。\n5. 对角化转子哈密顿量以获得 $\\{E_n\\}$，并计算转子的配分函数 $Z_{\\mathrm{HR}}(T)$ 和单个分子的自由能 $F_{\\mathrm{HR}}(T)$。计算单个分子的基态能量 $E_0$。\n6. 计算简谐振子的配分函数 $Z_{\\mathrm{HO}}(T)$、单个分子的自由能 $F_{\\mathrm{HO}}(T)$ 以及单个分子的零点能 $E_0^{\\mathrm{HO}} = \\frac{1}{2} h c \\bar{\\nu}$。\n7. 计算用HR处理方法替换HO模式后的热化学校正：\n   - 零点能校正（单位 $\\text{kJ/mol}$）为 $\\Delta E_{\\mathrm{ZPE}} = \\left(E_0 - \\frac{1}{2} h c \\bar{\\nu}\\right) N_\\mathrm{A} / 1000$，其中 $N_\\mathrm{A}$ 是阿伏伽德罗数。\n   - 在温度 $T$ 下的亥姆霍兹自由能校正（单位 $\\text{kJ/mol}$）为 $\\Delta F(T) = \\left(F_{\\mathrm{HR}}(T) - F_{\\mathrm{HO}}(T)\\right) N_\\mathrm{A}/1000$。\n8. 数值稳定性要求：\n   - 在计算配分函数中的指数和时，通过最小本征值 $E_0$ 进行能量平移以避免下溢，即计算 $Z = e^{-\\beta E_0} \\sum_n e^{-\\beta (E_n - E_0)}$。\n   - 使用HO配分函数的精确无穷级数表达式的封闭形式。\n9. 模式耦合的意义：\n   - 认识到HR处理方法隐含地假设了 $\\phi$ 与其他简正模式是可分离的，这是通过在扫描过程中弛豫正交坐标实现的；在实践中，耦合会使 $V(\\phi)$ 偏离简单的余弦形式并改变 $I$。在您的解决方案叙述中，解释投影扫描和 $V(\\phi)$ 的傅里叶成分如何反映耦合，以及这如何影响 $E_0$ 和 $F(T)$。\n\n为指定的测试套件实现此算法，参数如下：\n- 温度 $T = 298.15$ K。\n- 在 $[0, 2\\pi)$（弧度）范围内的网格点数 $N = 256$。\n\n您的程序应生成单行输出，其格式为一个包含三个列表的列表，每个子列表包含两个浮点数 $[\\Delta E_{\\mathrm{ZPE}}, \\Delta F(T)]$（单位为 kJ/mol），每个值都四舍五入到六位小数。例如，输出格式必须为：\n$$\n[[x_1, y_1], [x_2, y_2], [x_3, y_3]]\n$$",
            "solution": "核心任务是评估当一个通常被近似为量子简谐振子（HO）的低频振动模式，被替换为一维受阻转子（HR）处理时所产生的热化学校正。这种替换对于软扭转模式具有物理动机，在这些模式中，势能面是周期性的，简谐近似会失效。我们将通过数值求解转子的薛定谔方程，并将结果与简谐振子的解析表达式进行比较，来计算零点能（$\\Delta E_{\\mathrm{ZPE}}$）和亥姆霍兹自由能（$\\Delta F(T)$）的校正。\n\n一维受阻转子的基本控制方程是在周期性势 $V(\\phi)$ 下环上粒子的不含时薛定谔方程：\n$$\n\\hat{H}\\psi_n(\\phi) = \\left[-\\frac{\\hbar^2}{2I}\\frac{d^2}{d\\phi^2} + V(\\phi)\\right]\\psi_n(\\phi) = E_n \\psi_n(\\phi)\n$$\n此处，$\\phi \\in [0, 2\\pi)$ 是旋转角（以弧度为单位），$I$ 是转动惯量（单位 $\\text{kg} \\cdot \\text{m}^2$），$\\hbar$ 是约化普朗克常数，$V(\\phi)$ 是单个分子的势能（单位焦耳），$\\{E_n\\}$ 是能量本征值。波函数 $\\psi_n(\\phi)$ 必须满足 $2\\pi$ 周期性边界条件，即 $\\psi_n(\\phi) = \\psi_n(\\phi + 2\\pi)$。\n\n作为对比，一个基频波数为 $\\bar{\\nu}$（单位为 $\\text{cm}^{-1}$）的量子简谐振子的能级由下式给出：\n$$\nE_n^{\\mathrm{HO}} = h c \\bar{\\nu} \\left(n + \\frac{1}{2}\\right), \\quad n = 0, 1, 2, \\dots\n$$\n其中 $h$ 是普朗克常数，$c$ 是光速。\n\n为求解受阻转子的薛定谔方程，我们采用数值有限差分法。角坐标 $\\phi$ 被离散化为 $N$ 个点的均匀网格，$\\phi_i = i \\Delta\\phi$（$i=0, 1, \\dots, N-1$），其中网格间距为 $\\Delta\\phi = 2\\pi/N$。在此网格上，波函数由其在网格点上的值构成的向量 $\\bm{\\psi} = (\\psi(\\phi_0), \\psi(\\phi_1), \\dots, \\psi(\\phi_{N-1}))^T$ 表示。\n\n势能算符 $V(\\phi)$ 变为一个对角矩阵 $\\mathbf{V}$，其元素为 $\\mathbf{V}_{ii} = V(\\phi_i)$。\n\n动能算符 $\\hat{T} = -\\frac{\\hbar^2}{2I}\\frac{d^2}{d\\phi^2}$ 是一个正定算符。其矩阵表示 $\\mathbf{T}$ 是使用二阶导数的二阶中心差分近似构建的：\n$$\n\\frac{d^2\\psi}{d\\phi^2}\\bigg|_{\\phi_i} \\approx \\frac{\\psi(\\phi_{i+1}) - 2\\psi(\\phi_i) + \\psi(\\phi_{i-1})}{(\\Delta\\phi)^2}\n$$\n应用周期性边界条件，其中 $\\psi(\\phi_{-1}) = \\psi(\\phi_{N-1})$ 和 $\\psi(\\phi_{N}) = \\psi(\\phi_{0})$，算符 $-\\frac{d^2}{d\\phi^2}$ 对应一个对称的循环（或环绕三对角）矩阵。相应的动能矩阵 $\\mathbf{T}$ 具有以下元素：\n$$\n\\mathbf{T}_{ij} = \\frac{\\hbar^2}{2I(\\Delta\\phi)^2} \\times\n\\begin{cases}\n    2  \\text{if } i = j \\\\\n    -1  \\text{if } |i-j| = 1 \\\\\n    -1  \\text{if } \\{i,j\\} = \\{0, N-1\\} \\\\\n    0  \\text{otherwise}\n\\end{cases}\n$$\n完整的哈密顿量则由矩阵 $\\mathbf{H} = \\mathbf{T} + \\mathbf{V}$ 表示。对角化这个 $N \\times N$ 矩阵可得到 $N$ 个本征值，这些本征值是我们对受阻转子能级 $\\{E_n\\}$ 的数值近似。\n\n一旦获得了两种模型的能级，我们就可以计算相关的热化学量。零点能（ZPE）是基态能量。对于 HR 模型，这是最低的本征值，$E_0 = \\min(\\{E_n\\})$。对于 HO 模型，它是 $E_0^{\\mathrm{HO}} = \\frac{1}{2}h c \\bar{\\nu}$。\n\n在温度 $T$ 下的正则配分函数 $Z$ 通过对所有态求和计算得出：\n$$\nZ = \\sum_n e^{-E_n / (k_\\mathrm{B} T)}\n$$\n其中 $k_\\mathrm{B}$ 是玻尔兹曼常数。对于 HR 模型，这是对数值计算出的本征值的直接求和：\n$$\nZ_{\\mathrm{HR}}(T) = \\sum_{n=0}^{N-1} e^{-E_n / (k_\\mathrm{B} T)}\n$$\n为防止因大的负指数而产生数值下溢，我们提出基态能量因子：$Z_{\\mathrm{HR}}(T) = e^{-E_0 / (k_\\mathrm{B} T)} \\sum_{n=0}^{N-1} e^{-(E_n - E_0) / (k_\\mathrm{B} T)}$。\n对于 HO 模型，配分函数的无穷几何级数有一个封闭形式的表达式：\n$$\nZ_{\\mathrm{HO}}(T) = \\sum_{n=0}^{\\infty} e^{-\\beta h c \\bar{\\nu}(n+1/2)} = \\frac{e^{-\\beta h c \\bar{\\nu}/2}}{1 - e^{-\\beta h c \\bar{\\nu}}}, \\quad \\beta = \\frac{1}{k_\\mathrm{B} T}\n$$\n根据配分函数，单个分子的亥姆霍兹自由能 $F$ 由 $F = -k_\\mathrm{B} T \\ln Z$ 给出。\n对于 HR 模型：\n$F_{\\mathrm{HR}}(T) = -k_\\mathrm{B} T \\ln Z_{\\mathrm{HR}}(T) = E_0 - k_\\mathrm{B} T \\ln\\left(\\sum_{n=0}^{N-1} e^{-(E_n-E_0)/(k_\\mathrm{B} T)}\\right)$。\n对于 HO 模型：\n$F_{\\mathrm{HO}}(T) = -k_\\mathrm{B} T \\ln Z_{\\mathrm{HO}}(T) = E_0^{\\mathrm{HO}} + k_\\mathrm{B} T \\ln\\left(1 - e^{-\\beta h c \\bar{\\nu}}\\right)$。\n\n最后，我们通过计算 HR 和 HO 处理方法之间的差值，并乘以阿伏伽德罗数 $N_\\mathrm{A}$ 进行换算，来计算所需的以 $\\mathrm{kJ/mol}$ 为单位的热化学校正：\n$$\n\\Delta E_{\\mathrm{ZPE}} = \\frac{N_\\mathrm{A}}{1000} \\left(E_0 - E_0^{\\mathrm{HO}}\\right)\n$$\n$$\n\\Delta F(T) = \\frac{N_\\mathrm{A}}{1000} \\left(F_{\\mathrm{HR}}(T) - F_{\\mathrm{HO}}(T)\\right)\n$$\n在这些方程中使用之前，所有输入参数（$I, V, \\bar{\\nu}$）都必须转换为一套一致的国际单位制（SI）单位（$\\text{kg} \\cdot \\text{m}^2$，$\\mathrm{J}$，$\\mathrm{m^{-1}}$）。\n\n在真实的化学体系中，势能 $V(\\phi)$ 是通过“投影扫描”获得的，即在改变扭转角 $\\phi$ 的同时，在每一步都对所有其他内部坐标进行弛豫以使能量最小化。得到的能量曲线 $V(\\phi)$ 是高维势能面上的一个一维切片。这个势的结构——其周期性、势垒高度和形状，由其傅里叶分量所捕捉——是扭转运动与其他自由度之间耦合的直接体现。一个简单的势，如 $\\frac{V_0}{2}(1-\\cos(n\\phi))$，反映了一个 n 重对称转子，而更复杂的傅里叶级数，如情况 C 所示，则表示更低的对称性和更复杂的耦合。这种耦合显著影响能级间距。高势垒在势阱底部产生准简并的隧穿态，这与简谐振子的等间距能级有很大偏离。这种改变了的状态密度，尤其是在低能量区域，直接影响零点能和依赖于温度的自由能。HR 模型通过使用一维势的真实形状，捕捉到了这些被简谐近似完全忽略的关键效应。",
            "answer": "```python\nimport numpy as np\nfrom scipy.constants import h, hbar, c, k as k_B, N_A, physical_constants\n\ndef solve():\n    \"\"\"\n    Computes thermochemical corrections for replacing a harmonic oscillator\n    treatment of a low-frequency mode with a 1D hindered rotor model.\n    \"\"\"\n\n    # Physical constants in SI units\n    m_u = physical_constants['atomic mass constant'][0]  # kg\n\n    # Simulation parameters\n    T = 298.15  # K\n    N = 256  # Number of grid points\n\n    # Test cases defined in the problem\n    test_cases = [\n        {\n            \"name\": \"Case A: Free Rotor\",\n            \"I_amu_A2\": 10.0,\n            \"nu_bar_cm_1\": 30.0,\n            \"potential_def\": {\n                \"type\": \"analytic\",\n                \"func\": lambda phi, params: np.zeros_like(phi),\n                \"params\": {}\n            }\n        },\n        {\n            \"name\": \"Case B: Threefold Hindered Rotor\",\n            \"I_amu_A2\": 5.0,\n            \"nu_bar_cm_1\": 50.0,\n            \"potential_def\": {\n                \"type\": \"analytic\",\n                \"func\": lambda phi, params: (params['V0'] / 2.0) * (1.0 - np.cos(3.0 * phi)),\n                \"params\": {\"V0\": 3.0}\n            }\n        },\n        {\n            \"name\": \"Case C: Asymmetric Hindered Rotor\",\n            \"I_amu_A2\": 3.0,\n            \"nu_bar_cm_1\": 80.0,\n            \"potential_def\": {\n                \"type\": \"analytic_shifted\",\n                \"func\": lambda phi, params: (params['a'] * np.cos(phi) +\n                                         params['b'] * np.cos(2.0 * phi) +\n                                         params['c'] * np.sin(phi)),\n                \"params\": {\"a\": 1.5, \"b\": 0.8, \"c\": 0.2}\n            }\n        }\n    ]\n\n    results = []\n    \n    # Angular grid\n    phi = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    dphi = 2 * np.pi / N\n\n    for case in test_cases:\n        # --- Parameter and Unit Conversion ---\n        I_amu_A2 = case[\"I_amu_A2\"]\n        nu_bar_cm_1 = case[\"nu_bar_cm_1\"]\n        \n        # Convert to SI units\n        I = I_amu_A2 * m_u * (1e-10)**2  # kg*m^2\n        nu_bar_m_1 = nu_bar_cm_1 * 100  # m^-1\n\n        # --- Hindered Rotor (HR) Calculation ---\n\n        # 1. Construct Hamiltonian matrix H = T + V\n        \n        # Kinetic energy matrix T\n        T_mat = np.zeros((N, N))\n        kinetic_prefactor = hbar**2 / (2 * I * dphi**2)\n        diag_val = 2.0 * kinetic_prefactor\n        off_diag_val = -1.0 * kinetic_prefactor\n        \n        np.fill_diagonal(T_mat, diag_val)\n        T_mat += np.diag(np.full(N - 1, off_diag_val), k=1)\n        T_mat += np.diag(np.full(N - 1, off_diag_val), k=-1)\n        # Periodic boundary conditions\n        T_mat[0, N - 1] = off_diag_val\n        T_mat[N - 1, 0] = off_diag_val\n        \n        # Potential energy matrix V (diagonal)\n        pot_def = case[\"potential_def\"]\n        pot_func = pot_def[\"func\"]\n        pot_params = pot_def[\"params\"]\n        \n        v_kjmol = pot_func(phi, pot_params)\n        \n        if pot_def[\"type\"] == \"analytic_shifted\":\n            min_v = np.min(v_kjmol)\n            v_kjmol -= min_v\n        \n        v_joules = v_kjmol * 1000.0 / N_A\n        V_mat = np.diag(v_joules)\n\n        # Total Hamiltonian matrix\n        H_mat = T_mat + V_mat\n\n        # 2. Diagonalize H to get eigenvalues (energies)\n        eigenvalues = np.linalg.eigh(H_mat)[0]\n        \n        # 3. Compute HR thermochemical quantities\n        E0_HR = np.min(eigenvalues)  # Ground state energy in Joules\n        beta = 1.0 / (k_B * T)\n        \n        # Partition function with numerical stability\n        shifted_eigenvalues = eigenvalues - E0_HR\n        Z_sum = np.sum(np.exp(-beta * shifted_eigenvalues))\n        F_HR = E0_HR - k_B * T * np.log(Z_sum) # Helmholtz free energy in Joules\n\n        # --- Harmonic Oscillator (HO) Calculation ---\n        \n        E0_HO = 0.5 * h * c * nu_bar_m_1  # ZPE in Joules\n        x = h * c * nu_bar_m_1 / (k_B * T)\n        \n        # Check for x being too large to avoid overflow in exp(-x) -> 0\n        if x > 700: # np.log(1 - exp(-x)) -> np.log(1) = 0\n             F_HO = E0_HO\n        else:\n             F_HO = E0_HO + k_B * T * np.log(1.0 - np.exp(-x)) # Helmholtz free energy in Joules\n\n        # --- Calculate Final Corrections ---\n        \n        # Convert from J/molecule to kJ/mol\n        delta_E_ZPE = (E0_HR - E0_HO) * N_A / 1000.0\n        delta_F_T = (F_HR - F_HO) * N_A / 1000.0\n        \n        results.append([round(delta_E_ZPE, 6), round(delta_F_T, 6)])\n\n    # Format output as specified\n    final_output = f\"[[{results[0][0]},{results[0][1]}],[{results[1][0]},{results[1][1]}],[{results[2][0]},{results[2][1]}]]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}