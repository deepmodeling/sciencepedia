{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp electronic structure theory, one must look under the hood of the computational engine. This first practice provides a hands-on opportunity to implement the heart of the Hartree-Fock method: the self-consistent field (SCF) procedure. By building a simplified model for a catalytic metal site, you will directly quantify the energetic impact of improving a basis set from double-zeta (DZ) to include polarization functions (DZP), offering a clear illustration of how basis set choice influences the description of chemical bonding .",
            "id": "3882509",
            "problem": "You will implement a minimal self-consistent field model in atomic units (hartree for energy, bohr for length) to quantify how the Hartree-Fock (HF) total energy changes when moving from a double-zeta (DZ) basis to a double-zeta plus polarization (DZP) basis for a model catalytic metal site subjected to an anisotropic ligand field. The system is a single effective metal center at the origin with two electrons in a closed-shell, spin-restricted configuration. The anisotropic environment is modeled by an external point ligand of charge $q$ placed along the $x$ axis at a distance $R$ from the origin, which induces mixing between $s$-like and $p_x$-like valence character. You will compute the HF ground-state energy using a simplified but standard mean-field approximation and quantify the energy lowering $\\Delta E = E_{\\mathrm{DZP}} - E_{\\mathrm{DZ}}$ that arises when polarization functions are included.\n\nFundamental base:\n- Restricted Hartree-Fock (RHF) energy is given by \n$$\nE = \\sum_{\\mu\\nu} P_{\\mu\\nu} h_{\\mu\\nu} + \\tfrac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu} \\left(F_{\\mu\\nu} - h_{\\mu\\nu}\\right),\n$$\nwhere $P$ is the spin-summed density matrix, $h$ is the one-electron Hamiltonian matrix, and $F$ is the Fock matrix. The RHF density matrix for a closed shell with $N$ electrons is \n$$\nP = 2 \\sum_{i=1}^{N/2} \\mathbf{c}_i \\mathbf{c}_i^\\top,\n$$\nwith $\\mathbf{c}_i$ the occupied molecular orbital coefficient vectors in an orthonormal basis. The Fock matrix is \n$$\nF_{\\mu\\nu} = h_{\\mu\\nu} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[(\\mu\\nu|\\lambda\\sigma) - \\tfrac{1}{2}(\\mu\\sigma|\\lambda\\nu)\\right].\n$$\n\nModel approximations and definitions:\n- Basis sets:\n  - DZ basis: two orthonormal $s$-like functions at the metal center, denoted by indices $\\mu \\in \\{s_1, s_2\\}$, representing a double-zeta description.\n  - DZP basis: the DZ basis augmented by three orthonormal $p$-like functions $\\mu \\in \\{p_x, p_y, p_z\\}$, representing polarization.\n- One-electron Hamiltonian $h$:\n  - On-site energies: $h_{s_1 s_1} = \\varepsilon_{s_1}$, $h_{s_2 s_2} = \\varepsilon_{s_2}$, $h_{pp} = \\varepsilon_p$ for $p \\in \\{p_x, p_y, p_z\\}$.\n  - Metal $s$–$s$ interaction: $h_{s_1 s_2} = h_{s_2 s_1} = t_{ss}$.\n  - Ligand-induced anisotropic mixing: only $h_{s_1 p_x}$ and $h_{s_2 p_x}$ are nonzero, given by\n  $$\n  h_{s_1 p_x} = w_1 V(q,R), \\quad h_{s_2 p_x} = w_2 V(q,R),\n  $$\n  with $V(q,R) = A q \\exp(-\\kappa R)$. All other off-diagonal one-electron elements are zero. For the DZ basis, $p$-like functions are absent, so only the $s$ block appears.\n- Two-electron interactions use a Complete Neglect of Differential Overlap (CNDO) style approximation:\n  - Define on-site Coulomb parameters $U_{s_1}$, $U_{s_2}$, $U_p$ and interorbital effective Coulomb interactions \n  $$\n  \\gamma_{\\mu\\nu} = \n  \\begin{cases}\n  U_\\mu,  \\mu=\\nu \\\\\n  \\dfrac{1}{\\dfrac{1}{U_\\mu} + \\dfrac{1}{U_\\nu}},  \\mu \\neq \\nu\n  \\end{cases}\n  $$\n  - The Fock matrix is approximated as\n  $$\n  F_{\\mu\\nu} = h_{\\mu\\nu} + \\delta_{\\mu\\nu} \\sum_{\\lambda} P_{\\lambda\\lambda}\\,\\gamma_{\\mu\\lambda} - \\tfrac{1}{2} P_{\\mu\\nu}\\,\\gamma_{\\mu\\nu},\n  $$\n  where $\\delta_{\\mu\\nu}$ is the Kronecker delta. This captures Coulomb and exchange effects in a mean-field way on a single site.\n- Orthogonality: The basis is orthonormal so the overlap matrix is the identity.\n\nConstants for the model (atomic units):\n- One-electron parameters: $\\varepsilon_{s_1} = -0.80$, $\\varepsilon_{s_2} = -0.40$, $\\varepsilon_{p} = +0.10$, $t_{ss} = -0.25$.\n- Coulomb parameters: $U_{s_1} = 0.90$, $U_{s_2} = 0.70$, $U_{p} = 0.60$.\n- Ligand coupling parameters: $A = 0.50$, $\\kappa = 0.80$, weights $w_1 = 0.60$, $w_2 = 1.00$.\n\nNumerical task:\n- Implement a self-consistent field procedure that, for given $(q,R)$, builds the DZ Hamiltonian and solves the RHF equations to obtain $E_{\\mathrm{DZ}}$, and builds the DZP Hamiltonian and solves the RHF equations to obtain $E_{\\mathrm{DZP}}$. Use two electrons (closed shell) in both cases. Use an iterative diagonalization of the Fock matrix with density mixing (damping) until the Frobenius norm of the density matrix change is less than $10^{-10}$ or a maximum of $500$ iterations is reached.\n- Compute and report the energy difference \n$$\n\\Delta E(q,R) = E_{\\mathrm{DZP}}(q,R) - E_{\\mathrm{DZ}}(q,R),\n$$\nin hartree, rounded to six decimal places.\n\nTest suite:\n- Use the following test cases (in atomic units): \n  1. $(q,R) = (-0.8, 1.5)$,\n  2. $(q,R) = (-0.8, 5.0)$,\n  3. $(q,R) = (0.0, 2.0)$,\n  4. $(q,R) = (-1.2, 1.0)$.\nThese cover a moderate anisotropy, a weak-field far-ligand limit, an isotropic limit, and a strong anisotropy case.\n\nProgram output specification:\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, for example, \"[x1,x2,x3,x4]\".\n- Each $x_i$ must be a float in hartree rounded to six decimal places. Angles are not used. Percentages are not used. Physical units are atomic units by construction and do not need to be printed, but values are in hartree.",
            "solution": "The problem asks for the implementation of a minimal Restricted Hartree-Fock (RHF) self-consistent field (SCF) model to compute the energy difference, $\\Delta E = E_{\\mathrm{DZP}} - E_{\\mathrm{DZ}}$, for a model catalytic site. This difference quantifies the energetic contribution of polarization functions ($p$-orbitals) when added to a double-zeta ($s$-orbitals) basis set under the influence of an external ligand field. The entire model is defined in atomic units.\n\nThe solution is developed by first formalizing the components of the RHF calculation based on the provided model approximations and then implementing the iterative SCF procedure.\n\n**1. RHF Formalism and Model-Specific Matrices**\n\nThe total RHF energy for a closed-shell system is given by:\n$$\nE = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu} (h_{\\mu\\nu} + F_{\\mu\\nu}) = \\frac{1}{2} \\mathrm{Tr}(\\mathbf{P}(\\mathbf{h} + \\mathbf{F}))\n$$\nwhere $\\mathbf{P}$ is the density matrix, $\\mathbf{h}$ is the one-electron core Hamiltonian matrix, and $\\mathbf{F}$ is the Fock matrix.\n\nThe system contains $N=2$ electrons, so the density matrix is constructed from the single occupied molecular orbital (MO), $\\mathbf{c}_1$, which corresponds to the lowest orbital energy:\n$$\n\\mathbf{P} = 2 \\mathbf{c}_1 \\mathbf{c}_1^\\top\n$$\n\nThe Fock matrix, $\\mathbf{F}$, which represents the effective one-electron Hamiltonian in the mean field of all other electrons, is defined by the model's CNDO-style approximation:\n$$\nF_{\\mu\\nu} = h_{\\mu\\nu} + \\delta_{\\mu\\nu} \\sum_{\\lambda} P_{\\lambda\\lambda}\\,\\gamma_{\\mu\\lambda} - \\tfrac{1}{2} P_{\\mu\\nu}\\,\\gamma_{\\mu\\nu}\n$$\nThis can be expressed in matrix form as $\\mathbf{F} = \\mathbf{h} + \\mathbf{J} - \\mathbf{K}$, where the Coulomb matrix $\\mathbf{J}$ and exchange matrix $\\mathbf{K}$ are given by:\n$$\nJ_{\\mu\\nu} = \\delta_{\\mu\\nu} \\sum_{\\lambda} P_{\\lambda\\lambda}\\,\\gamma_{\\mu\\lambda}, \\quad K_{\\mu\\nu} = \\tfrac{1}{2} P_{\\mu\\nu}\\,\\gamma_{\\mu\\nu}\n$$\nThe basis sets are orthonormal, simplifying the RHF equations to a standard eigenvalue problem, $\\mathbf{F}\\mathbf{C} = \\mathbf{C}\\boldsymbol{\\epsilon}$.\n\n**2. Matrix Construction**\n\nThe core of the implementation is the construction of the $\\mathbf{h}$ and $\\gamma$ matrices for both the DZ and DZP basis sets.\n\n**Basis Sets:**\n-   **DZ (Double-Zeta):** A $2$-dimensional basis $\\{\\phi_1, \\phi_2\\} = \\{s_1, s_2\\}$.\n-   **DZP (Double-Zeta + Polarization):** A $5$-dimensional basis $\\{\\phi_1, ... \\phi_5\\} = \\{s_1, s_2, p_x, p_y, p_z\\}$.\n\n**One-Electron Hamiltonian Matrix ($\\mathbf{h}$):**\nThe $\\mathbf{h}$ matrix contains the kinetic energy and the potential energy of an electron in the field of the nucleus and the external ligand.\n- For the DZ basis, $\\mathbf{h}$ is a $2 \\times 2$ matrix:\n$$\n\\mathbf{h}_{\\mathrm{DZ}} = \\begin{pmatrix} \\varepsilon_{s_1}  t_{ss} \\\\ t_{ss}  \\varepsilon_{s_2} \\end{pmatrix} = \\begin{pmatrix} -0.80  -0.25 \\\\ -0.25  -0.40 \\end{pmatrix}\n$$\n- For the DZP basis, the ligand potential $V(q,R) = A q \\exp(-\\kappa R)$ induces coupling between the $s$ orbitals and the $p_x$ orbital. The $\\mathbf{h}$ matrix is a $5 \\times 5$ matrix, with indices ordered as $(s_1, s_2, p_x, p_y, p_z)$:\n$$\n\\mathbf{h}_{\\mathrm{DZP}} = \\begin{pmatrix}\n\\varepsilon_{s_1}  t_{ss}  w_1 V(q,R)  0  0 \\\\\nt_{ss}  \\varepsilon_{s_2}  w_2 V(q,R)  0  0 \\\\\nw_1 V(q,R)  w_2 V(q,R)  \\varepsilon_p  0  0 \\\\\n0  0  0  \\varepsilon_p  0 \\\\\n0  0  0  0  \\varepsilon_p\n\\end{pmatrix}\n$$\nUsing the given constants: $\\varepsilon_{s_1}=-0.80, \\varepsilon_{s_2}=-0.40, \\varepsilon_p=0.10, t_{ss}=-0.25, A=0.50, \\kappa=0.80, w_1=0.60, w_2=1.00$. The elements $h_{s_1 p_x}$ and $h_{s_2 p_x}$ depend on the specific $(q,R)$ case.\n\n**Two-Electron Interaction Matrix ($\\boldsymbol{\\gamma}$):**\nThe $\\boldsymbol{\\gamma}$ matrix stores the effective Coulomb interaction parameters.\n$$\n \\gamma_{\\mu\\nu} = \n  \\begin{cases}\n  U_\\mu,  \\mu=\\nu \\\\\n  \\frac{U_\\mu U_\\nu}{U_\\mu + U_\\nu},  \\mu \\neq \\nu\n  \\end{cases}\n$$\nThe on-site parameters are $U_{s_1} = 0.90$, $U_{s_2} = 0.70$, and $U_p = 0.60$. This symmetric matrix is constructed for the appropriate basis dimension ($2 \\times 2$ for DZ, $5 \\times 5$ for DZP).\n\n**3. Self-Consistent Field (SCF) Algorithm**\n\nThe RHF equations are solved iteratively until the electron density is self-consistent. The algorithm proceeds as follows for each basis set and each $(q,R)$ pair:\n\n1.  **Initialization:** Construct the constant matrices $\\mathbf{h}$ and $\\boldsymbol{\\gamma}$. Initialize the density matrix $\\mathbf{P}$ to a zero matrix.\n2.  **Iteration Loop:** Repeat for a maximum of $500$ iterations:\n    a. **Build Fock Matrix:** Construct the Fock matrix $\\mathbf{F} = \\mathbf{h} + \\mathbf{J} - \\mathbf{K}$ using the current density matrix $\\mathbf{P}$. The Coulomb term $\\mathbf{J}$ is a diagonal matrix whose elements are computed as $J_{\\mu\\mu} = (\\boldsymbol{\\gamma} \\cdot \\mathrm{diag}(\\mathbf{P}))_\\mu$, and the exchange term is $\\mathbf{K} = \\frac{1}{2} \\mathbf{P} \\odot \\boldsymbol{\\gamma}$ (element-wise product).\n    b. **Solve Eigenvalue Problem:** Diagonalize the Fock matrix, $\\mathbf{F}\\mathbf{C} = \\mathbf{C}\\boldsymbol{\\epsilon}$, to obtain MO energies $\\boldsymbol{\\epsilon}$ and MO coefficients $\\mathbf{C}$. Since $\\mathbf{F}$ is a real symmetric matrix, `scipy.linalg.eigh` is used.\n    c. **Form New Density Matrix:** Identify the MO coefficient vector $\\mathbf{c}_1$ corresponding to the lowest eigenvalue. Construct the new density matrix $\\mathbf{P}_{\\text{new}} = 2 \\mathbf{c}_1 \\mathbf{c}_1^\\top$.\n    d. **Check Convergence:** Calculate the Frobenius norm of the difference between the new and old density matrices, $\\|\\mathbf{P}_{\\text{new}} - \\mathbf{P}\\|_F$. If this norm is below the threshold of $10^{-10}$, the SCF has converged.\n    e. **Density Mixing:** To improve convergence, the density matrix for the next iteration is formed by mixing the old and new matrices: $\\mathbf{P} \\leftarrow (1-\\alpha)\\mathbf{P} + \\alpha\\mathbf{P}_{\\text{new}}$, where a damping factor of $\\alpha=0.5$ is used.\n3.  **Energy Calculation:** Once converged, the final energy is calculated using the converged density matrix $\\mathbf{P}$ and the final Fock matrix $\\mathbf{F}$ with the formula $E = \\frac{1}{2} \\mathrm{Tr}(\\mathbf{P}(\\mathbf{h} + \\mathbf{F}))$.\n\n**4. Final Computation**\n\nFor each $(q,R)$ pair from the test suite, the SCF procedure is executed twice: once for the DZ basis to obtain $E_{\\mathrm{DZ}}$, and once for the DZP basis to obtain $E_{\\mathrm{DZP}}$. The required energy difference $\\Delta E = E_{\\mathrm{DZP}} - E_{\\mathrm{DZ}}$ is then calculated, rounded to six decimal places, and reported. For the case $(q,R)=(0.0, 2.0)$, the ligand field $V$ is zero, leading to no coupling between $s$ and $p$ orbitals. As a result, the converged energy for both bases should be identical, yielding $\\Delta E=0$, which serves as a valuable consistency check.",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to solve the specified RHF problem for a set of test cases.\n    \"\"\"\n\n    # --- Model Constants (atomic units) ---\n    # One-electron parameters\n    EPS_S1 = -0.80\n    EPS_S2 = -0.40\n    EPS_P = 0.10\n    T_SS = -0.25\n    # Coulomb parameters\n    U_S1 = 0.90\n    U_S2 = 0.70\n    U_P = 0.60\n    # Ligand coupling parameters\n    A = 0.50\n    KAPPA = 0.80\n    W1 = 0.60\n    W2 = 1.00\n\n    # --- SCF Parameters ---\n    MAX_ITER = 500\n    CONV_THRESH = 1e-10\n    DAMPING_FACTOR = 0.5\n    NUM_ELECTRONS = 2\n\n    def compute_hf_energy(q, r, basis_type):\n        \"\"\"\n        Performs the RHF-SCF calculation for a given basis and ligand parameters.\n        \"\"\"\n        if basis_type == 'DZ':\n            n_basis = 2\n            u_vals = np.array([U_S1, U_S2])\n        elif basis_type == 'DZP':\n            n_basis = 5\n            u_vals = np.array([U_S1, U_S2, U_P, U_P, U_P])\n        else:\n            raise ValueError(\"Invalid basis_type specified.\")\n\n        # --- Build Core Hamiltonian (h) ---\n        h = np.zeros((n_basis, n_basis))\n        h[0, 0] = EPS_S1\n        h[1, 1] = EPS_S2\n        h[0, 1] = h[1, 0] = T_SS\n\n        if basis_type == 'DZP':\n            h[2, 2] = h[3, 3] = h[4, 4] = EPS_P\n            # Ligand-induced mixing\n            v_qr = A * q * np.exp(-KAPPA * r)\n            h[0, 2] = h[2, 0] = W1 * v_qr  # s1-px\n            h[1, 2] = h[2, 1] = W2 * v_qr  # s2-px\n\n        # --- Build Two-Electron Interaction Matrix (gamma) ---\n        gamma = np.zeros((n_basis, n_basis))\n        for i in range(n_basis):\n            for j in range(n_basis):\n                if i == j:\n                    gamma[i, j] = u_vals[i]\n                else:\n                    gamma[i, j] = (u_vals[i] * u_vals[j]) / (u_vals[i] + u_vals[j])\n\n        # --- SCF Iteration Loop ---\n        p_matrix = np.zeros((n_basis, n_basis))\n\n        for i in range(MAX_ITER):\n            # Build Fock Matrix (F = h + G)\n            # G_mu_nu = delta_mu_nu * sum_lambda(P_lambda_lambda * gamma_mu_lambda) - 0.5 * P_mu_nu * gamma_mu_nu\n            p_diag = np.diag(p_matrix)\n            j_matrix_diag = gamma @ p_diag\n            j_matrix = np.diag(j_matrix_diag)\n            k_matrix = 0.5 * p_matrix * gamma\n            fock_matrix = h + j_matrix - k_matrix\n\n            # Solve Roothaan-Hall equations (FC = SCe, S=I)\n            eigvals, eigvecs = linalg.eigh(fock_matrix)\n\n            # Form new density matrix from the lowest energy orbital\n            c1 = eigvecs[:, 0]  # First column is the eigenvector for the lowest eigenvalue\n            p_new = NUM_ELECTRONS * np.outer(c1, c1)\n\n            # Check for convergence\n            delta_p_norm = np.linalg.norm(p_new - p_matrix)\n            if delta_p_norm  CONV_THRESH:\n                p_matrix = p_new\n                break\n\n            # Damping to aid convergence\n            p_matrix = (1 - DAMPING_FACTOR) * p_matrix + DAMPING_FACTOR * p_new\n        \n        # --- Calculate Final Total Energy ---\n        # Final Fock matrix from converged density\n        p_diag = np.diag(p_matrix)\n        j_matrix_diag = gamma @ p_diag\n        j_matrix = np.diag(j_matrix_diag)\n        k_matrix = 0.5 * p_matrix * gamma\n        final_fock_matrix = h + j_matrix - k_matrix\n        \n        energy = 0.5 * np.sum(p_matrix * (h + final_fock_matrix))\n        \n        return energy\n    \n    # --- Test Suite ---\n    test_cases = [\n        (-0.8, 1.5),\n        (-0.8, 5.0),\n        (0.0, 2.0),\n        (-1.2, 1.0),\n    ]\n\n    results = []\n    for q_val, r_val in test_cases:\n        e_dz = compute_hf_energy(q_val, r_val, 'DZ')\n        e_dzp = compute_hf_energy(q_val, r_val, 'DZP')\n        delta_e = e_dzp - e_dz\n        results.append(f\"{delta_e:.6f}\") # Format to 6 decimal places\n\n    # --- Print Final Output ---\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The Hartree-Fock approximation, while powerful, is fundamentally a mean-field theory that neglects the instantaneous correlation in electron motions. This missing electron correlation is critical for accurately describing non-covalent interactions, such as the physisorption of molecules on catalyst surfaces. This exercise will guide you in applying Møller-Plesset second-order perturbation theory (MP2), a foundational method for capturing this dynamic correlation, to compute the correlation contribution to a binding energy .",
            "id": "3882483",
            "problem": "A weakly bound physisorbed adsorbate on a catalytic surface is modeled within the Hartree-Fock mean-field as a closed-shell system of canonical molecular orbitals. The second-order correction to the Hartree-Fock binding energy due to electron correlation (Møller-Plesset second order, arising from second-order Rayleigh-Schrödinger perturbation theory on top of the Hartree-Fock reference) is to be computed. The Hartree-Fock binding energy correction is defined as the difference of correlation energies between the adsorbate–surface complex and the separated fragments, namely the surface and the adsorbate. The canonical orbital energies are denoted by $\\epsilon_p$ and the electron repulsion integrals in the molecular orbital basis are provided as antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ in Hartree units. Orbital indices $i,j$ denote occupied molecular orbitals and $a,b$ denote virtual molecular orbitals in the closed-shell Hartree-Fock reference.\n\nStarting from the following fundamental and well-tested base:\n- The Hartree-Fock method provides a mean-field reference state that is an eigenstate of a zeroth-order Hamiltonian, with canonical molecular orbitals and orbital energies $\\epsilon_p$.\n- Second-order Rayleigh-Schrödinger perturbation theory on top of the Hartree-Fock reference yields a correlation energy correction from double excitations, where the energy denominators are differences of sums of occupied and virtual orbital energies, and the couplings are given by matrix elements of the electron-electron interaction operator between the reference and doubly excited determinants.\n- The total binding energy correction due to electron correlation is computed as $E_{\\text{corr}}^{(2)}(\\text{complex}) - E_{\\text{corr}}^{(2)}(\\text{surface}) - E_{\\text{corr}}^{(2)}(\\text{adsorbate})$.\n\nYou must:\n1. Derive the algorithm to compute the second-order correction to the correlation energy from the provided data, and apply it to each system.\n2. Compute the correction to the Hartree-Fock binding energy as the difference between the complex and the separated fragments.\n3. Compute the relative contribution of dispersion-like terms, defined here as those second-order contributions in the complex where the occupied-virtual excitation pairs are fragment-localized and paired across the two fragments, specifically where the fragment labels satisfy $\\text{frag}(i)=\\text{frag}(a)\\neq\\text{frag}(j)=\\text{frag}(b)$. Use the magnitude ratio $\\frac{\\left|E_{\\text{inter}}^{(2)}(\\text{complex})\\right|}{\\left|E_{\\text{bind}}^{(2)}\\right|}$, where $E_{\\text{inter}}^{(2)}(\\text{complex})$ is the sum of dispersion-like contributions in the complex only, and $E_{\\text{bind}}^{(2)}$ is the binding energy correction defined above. If $\\left|E_{\\text{bind}}^{(2)}\\right|=0$, define this ratio as $0.0$ by convention.\n\nYour program must produce results in kilojoules per mole for the binding energy correction. Use the conversion $1$ Hartree $= 2625.49962$ kilojoules per mole. Express the binding energy correction in kilojoules per mole with six decimal places, and the dispersion contribution ratio as a decimal with six decimal places.\n\nImplement the computation for the following test suite. Each system below is fully specified by:\n- A list of orbital energies $\\{\\epsilon_p\\}$ in Hartree.\n- Lists of occupied and virtual orbital indices.\n- A dictionary of nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ in Hartree, keyed by tuples $(i,j,a,b)$ with $ij$ and $ab$.\n- A list of fragment labels for each orbital index (use $0$ for adsorbate and $1$ for surface).\n\nTest case $1$ (happy path, weak physisorption with both intra- and inter-fragment couplings):\n- Complex:\n  - Orbital energies (Hartree): $[-0.40,-0.30,0.10,0.20,-0.50,-0.35,0.15,0.25]$.\n  - Occupied indices: $[0,1,4,5]$.\n  - Virtual indices: $[2,3,6,7]$.\n  - Fragment labels: $[0,0,0,0,1,1,1,1]$.\n  - Nonzero $\\langle ij \\Vert ab \\rangle$ (Hartree):\n    - Intra-adsorbate: $(0,1,2,3)\\!:\\;0.050$.\n    - Intra-surface: $(4,5,6,7)\\!:\\;0.045$.\n    - Inter-fragment (dispersion-like): $(0,4,2,6)\\!:\\;0.012$, $(0,4,3,7)\\!:\\;0.010$, $(1,5,2,7)\\!:\\;0.011$, $(1,5,3,6)\\!:\\;0.009$, $(0,5,2,7)\\!:\\;0.008$, $(1,4,3,6)\\!:\\;0.007$.\n- Adsorbate fragment (isolated):\n  - Orbital energies (Hartree): $[-0.41,-0.29,0.12,0.21]$.\n  - Occupied indices: $[0,1]$.\n  - Virtual indices: $[2,3]$.\n  - Fragment labels: $[0,0,0,0]$.\n  - Nonzero $\\langle ij \\Vert ab \\rangle$ (Hartree): $(0,1,2,3)\\!:\\;0.052$.\n- Surface fragment (isolated):\n  - Orbital energies (Hartree): $[-0.51,-0.34,0.16,0.27]$.\n  - Occupied indices: $[0,1]$.\n  - Virtual indices: $[2,3]$.\n  - Fragment labels: $[1,1,1,1]$.\n  - Nonzero $\\langle ij \\Vert ab \\rangle$ (Hartree): $(0,1,2,3)\\!:\\;0.046$.\n\nTest case $2$ (boundary case with zero inter-fragment couplings and matched monomer properties; the binding correction should be zero by construction):\n- Complex:\n  - Orbital energies (Hartree): $[-0.41,-0.29,0.12,0.21,-0.51,-0.34,0.16,0.27]$.\n  - Occupied indices: $[0,1,4,5]$.\n  - Virtual indices: $[2,3,6,7]$.\n  - Fragment labels: $[0,0,0,0,1,1,1,1]$.\n  - Nonzero $\\langle ij \\Vert ab \\rangle$ (Hartree): $(0,1,2,3)\\!:\\;0.052$, $(4,5,6,7)\\!:\\;0.046$.\n- Adsorbate fragment (isolated): same as in test case $1$.\n- Surface fragment (isolated): same as in test case $1$.\n\nTest case $3$ (edge case with only inter-fragment couplings; the binding correction equals the inter-fragment correlation energy):\n- Complex:\n  - Orbital energies (Hartree): $[-0.40,-0.30,0.10,0.20,-0.50,-0.35,0.15,0.25]$.\n  - Occupied indices: $[0,1,4,5]$.\n  - Virtual indices: $[2,3,6,7]$.\n  - Fragment labels: $[0,0,0,0,1,1,1,1]$.\n  - Nonzero $\\langle ij \\Vert ab \\rangle$ (Hartree), inter-fragment only: $(0,4,2,6)\\!:\\;0.012$, $(0,4,3,7)\\!:\\;0.010$, $(1,5,2,7)\\!:\\;0.011$, $(1,5,3,6)\\!:\\;0.009$, $(0,5,2,7)\\!:\\;0.008$, $(1,4,3,6)\\!:\\;0.007$.\n- Adsorbate fragment (isolated):\n  - Orbital energies (Hartree): $[-0.41,-0.29,0.12,0.21]$.\n  - Occupied indices: $[0,1]$.\n  - Virtual indices: $[2,3]$.\n  - Fragment labels: $[0,0,0,0]$.\n  - Nonzero $\\langle ij \\Vert ab \\rangle$ (Hartree): none.\n- Surface fragment (isolated):\n  - Orbital energies (Hartree): $[-0.51,-0.34,0.16,0.27]$.\n  - Occupied indices: $[0,1]$.\n  - Virtual indices: $[2,3]$.\n  - Fragment labels: $[1,1,1,1]$.\n  - Nonzero $\\langle ij \\Vert ab \\rangle$ (Hartree): none.\n\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of two floats in the form $[\\text{binding\\_correction\\_kJ/mol},\\text{dispersion\\_ratio}]$, with both values formatted to six decimal places. For example: $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$, where $x_k$ is the binding energy correction in kilojoules per mole and $y_k$ is the dispersion ratio as a decimal.",
            "solution": "The problem requires the calculation of the second-order Møller-Plesset (MP2) correction to the binding energy for a physisorbed system, along with the relative contribution of dispersion-like energy terms. The entire analysis is based on a Hartree-Fock reference state for a closed-shell system.\n\nFirst, we establish the fundamental formula for the MP2 correlation energy, $E_{\\text{corr}}^{(2)}$. This energy correction arises from second-order Rayleigh-Schrödinger perturbation theory, where the unperturbed system is the Hartree-Fock ground state and the perturbation is the fluctuation potential (the difference between the true electron-electron repulsion and the mean-field Hartree-Fock potential). For a closed-shell system, the MP2 energy is a sum over contributions from all possible double excitations from occupied molecular orbitals (MOs), indexed by $i$ and $j$, to virtual MOs, indexed by $a$ and $b$. Using the provided antisymmetrized two-electron integrals in the MO basis, $\\langle ij \\Vert ab \\rangle$, the formula is:\n$$\nE_{\\text{corr}}^{(2)} = \\sum_{ij}^{\\text{occ}} \\sum_{ab}^{\\text{virt}} \\frac{|\\langle ij \\Vert ab \\rangle|^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n$$\nHere, $\\epsilon_p$ denotes the canonical Hartree-Fock orbital energy of MO $p$. The summation is restricted to $ij$ and $ab$ to count each distinct pair of excitations once. The denominator, $\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b$, represents the energy difference between the ground state and the doubly excited state in the zeroth-order picture. All quantities are in Hartree atomic units.\n\nThe algorithm to compute $E_{\\text{corr}}^{(2)}$ for any given system (complex, adsorbate, or surface) involves iterating through the provided dictionary of non-zero integrals $\\langle ij \\Vert ab \\rangle$. For each integral, keyed by the tuple $(i, j, a, b)$, its contribution to the total energy is calculated using the corresponding orbital energies and added to a running sum.\n\nNext, the MP2 correction to the binding energy, $E_{\\text{bind}}^{(2)}$, is defined as the difference between the correlation energy of the combined adsorbate-surface complex and the sum of the correlation energies of the isolated fragments:\n$$\nE_{\\text{bind}}^{(2)} = E_{\\text{corr}}^{(2)}(\\text{complex}) - \\left( E_{\\text{corr}}^{(2)}(\\text{adsorbate}) + E_{\\text{corr}}^{(2)}(\\text{surface}) \\right)\n$$\nA negative value of $E_{\\text{bind}}^{(2)}$ indicates that electron correlation stabilizes the bound complex relative to the separated fragments.\n\nThe third task is to quantify the contribution of dispersion-like interactions to the binding. The problem provides a specific definition for these terms as those second-order contributions within the complex where the excitations are localized on different fragments. An integral term $\\langle ij \\Vert ab \\rangle$ is considered dispersion-like if the fragment an orbital belongs to, denoted by $\\text{frag}(p)$, satisfies the condition $\\text{frag}(i)=\\text{frag}(a) \\neq \\text{frag}(j)=\\text{frag}(b)$. This corresponds to a scenario where one electron is excited within the adsorbate and another is simultaneously excited within the surface, which is the physical origin of dispersion forces. The total energy from these terms, $E_{\\text{inter}}^{(2)}(\\text{complex})$, is calculated by summing only the contributions that meet this criterion:\n$$\nE_{\\text{inter}}^{(2)}(\\text{complex}) = \\sum_{\\substack{ij,\\, ab \\\\ \\text{frag}(i)=\\text{frag}(a) \\\\ \\text{frag}(j)=\\text{frag}(b) \\\\ \\text{frag}(i) \\neq \\text{frag}(j)}} \\frac{|\\langle ij \\Vert ab \\rangle|^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n$$\nThe relative contribution of dispersion is then computed as the ratio of the magnitudes:\n$$\n\\text{Dispersion Ratio} = \\frac{\\left|E_{\\text{inter}}^{(2)}(\\text{complex})\\right|}{\\left|E_{\\text{bind}}^{(2)}\\right|}\n$$\nBy convention, if the binding energy correction $E_{\\text{bind}}^{(2)}$ is zero, this ratio is defined to be $0.0$.\n\nFinally, the computed binding energy, which is in Hartree atomic units, is converted to kilojoules per mole using the provided conversion factor $1 \\text{ Hartree} = 2625.49962 \\text{ kJ/mol}$. The final results are presented with the specified numerical precision.",
            "answer": "```python\nimport numpy as np\n\n# Note: The problem statement allows for numpy but not for scipy.\n# The calculation can be completed with numpy and standard Python libraries.\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem for the given test suite.\n    \"\"\"\n    HARTREE_TO_KJ_MOL = 2625.49962\n\n    test_cases = [\n        # Test case 1 (happy path)\n        {\n            \"complex\": {\n                \"energies\": [-0.40, -0.30, 0.10, 0.20, -0.50, -0.35, 0.15, 0.25],\n                \"occupied_indices\": [0, 1, 4, 5],\n                \"virtual_indices\": [2, 3, 6, 7],\n                \"frag_labels\": [0, 0, 0, 0, 1, 1, 1, 1],\n                \"integrals\": {\n                    (0, 1, 2, 3): 0.050,\n                    (4, 5, 6, 7): 0.045,\n                    (0, 4, 2, 6): 0.012,\n                    (0, 4, 3, 7): 0.010,\n                    (1, 5, 2, 7): 0.011,\n                    (1, 5, 3, 6): 0.009,\n                    (0, 5, 2, 7): 0.008,\n                    (1, 4, 3, 6): 0.007,\n                },\n            },\n            \"adsorbate\": {\n                \"energies\": [-0.41, -0.29, 0.12, 0.21],\n                \"occupied_indices\": [0, 1],\n                \"virtual_indices\": [2, 3],\n                \"integrals\": {(0, 1, 2, 3): 0.052},\n            },\n            \"surface\": {\n                \"energies\": [-0.51, -0.34, 0.16, 0.27],\n                \"occupied_indices\": [0, 1],\n                \"virtual_indices\": [2, 3],\n                \"integrals\": {(0, 1, 2, 3): 0.046},\n            },\n        },\n        # Test case 2 (boundary case)\n        {\n            \"complex\": {\n                \"energies\": [-0.41, -0.29, 0.12, 0.21, -0.51, -0.34, 0.16, 0.27],\n                \"occupied_indices\": [0, 1, 4, 5],\n                \"virtual_indices\": [2, 3, 6, 7],\n                \"frag_labels\": [0, 0, 0, 0, 1, 1, 1, 1],\n                \"integrals\": {(0, 1, 2, 3): 0.052, (4, 5, 6, 7): 0.046},\n            },\n            \"adsorbate\": {\n                \"energies\": [-0.41, -0.29, 0.12, 0.21],\n                \"occupied_indices\": [0, 1],\n                \"virtual_indices\": [2, 3],\n                \"integrals\": {(0, 1, 2, 3): 0.052},\n            },\n            \"surface\": {\n                \"energies\": [-0.51, -0.34, 0.16, 0.27],\n                \"occupied_indices\": [0, 1],\n                \"virtual_indices\": [2, 3],\n                \"integrals\": {(0, 1, 2, 3): 0.046},\n            },\n        },\n        # Test case 3 (edge case)\n        {\n            \"complex\": {\n                \"energies\": [-0.40, -0.30, 0.10, 0.20, -0.50, -0.35, 0.15, 0.25],\n                \"occupied_indices\": [0, 1, 4, 5],\n                \"virtual_indices\": [2, 3, 6, 7],\n                \"frag_labels\": [0, 0, 0, 0, 1, 1, 1, 1],\n                \"integrals\": {\n                    (0, 4, 2, 6): 0.012,\n                    (0, 4, 3, 7): 0.010,\n                    (1, 5, 2, 7): 0.011,\n                    (1, 5, 3, 6): 0.009,\n                    (0, 5, 2, 7): 0.008,\n                    (1, 4, 3, 6): 0.007,\n                },\n            },\n            \"adsorbate\": {\n                \"energies\": [-0.41, -0.29, 0.12, 0.21],\n                \"occupied_indices\": [0, 1],\n                \"virtual_indices\": [2, 3],\n                \"integrals\": {},\n            },\n            \"surface\": {\n                \"energies\": [-0.51, -0.34, 0.16, 0.27],\n                \"occupied_indices\": [0, 1],\n                \"virtual_indices\": [2, 3],\n                \"integrals\": {},\n            },\n        },\n    ]\n\n    def compute_mp2(energies, integrals):\n        e_corr = 0.0\n        for (i, j, a, b), value in integrals.items():\n            denominator = energies[i] + energies[j] - energies[a] - energies[b]\n            if abs(denominator)  1e-12:\n                e_corr += (value**2) / denominator\n        return e_corr\n\n    def compute_dispersion(energies, integrals, frag_labels):\n        e_inter = 0.0\n        for (i, j, a, b), value in integrals.items():\n            # Check for the specific dispersion condition from the problem statement\n            is_dispersion = (\n                frag_labels[i] == frag_labels[a] and\n                frag_labels[j] == frag_labels[b] and\n                frag_labels[i] != frag_labels[j]\n            )\n            if is_dispersion:\n                denominator = energies[i] + energies[j] - energies[a] - energies[b]\n                if abs(denominator)  1e-12:\n                    e_inter += (value**2) / denominator\n        return e_inter\n\n    all_results = []\n    for case in test_cases:\n        # Calculate correlation energies for all three systems\n        e_corr_complex = compute_mp2(case[\"complex\"][\"energies\"], case[\"complex\"][\"integrals\"])\n        e_corr_adsorbate = compute_mp2(case[\"adsorbate\"][\"energies\"], case[\"adsorbate\"][\"integrals\"])\n        e_corr_surface = compute_mp2(case[\"surface\"][\"energies\"], case[\"surface\"][\"integrals\"])\n\n        # Calculate the binding energy correction\n        e_bind_hartree = e_corr_complex - e_corr_adsorbate - e_corr_surface\n        e_bind_kjmol = e_bind_hartree * HARTREE_TO_KJ_MOL\n\n        # Calculate the dispersion-like energy for the complex\n        e_inter_hartree = compute_dispersion(case[\"complex\"][\"energies\"], case[\"complex\"][\"integrals\"], case[\"complex\"][\"frag_labels\"])\n\n        # Calculate the dispersion ratio\n        if abs(e_bind_hartree)  1e-12:\n            dispersion_ratio = 0.0\n        else:\n            dispersion_ratio = abs(e_inter_hartree) / abs(e_bind_hartree)\n        \n        all_results.append([e_bind_kjmol, dispersion_ratio])\n\n    # Format the final output string to match the required format precisely\n    formatted_results = []\n    for res_pair in all_results:\n        formatted_results.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Calculating accurate interaction energies between molecular fragments, such as an adsorbate and a surface, is a cornerstone of computational catalysis. However, the use of finite, atom-centered basis sets introduces a subtle numerical artifact known as Basis Set Superposition Error (BSSE), which can lead to an artificial overestimation of binding strength. This practice demonstrates the widely used counterpoise correction scheme, providing a quantitative tool to diagnose and correct for BSSE in both Hartree-Fock and correlated-level calculations .",
            "id": "3882527",
            "problem": "Consider an adsorbate–surface complex comprised of an adsorbate $A$ and a surface $S$. In electronic structure calculations that use a finite one-electron basis, the variational principle implies that adding additional basis functions lowers the computed total energy. When a fragment is computed in the presence of ghost basis functions of its partner, this additional flexibility can artificially lower the fragment energy, producing the Basis Set Superposition Error (BSSE). In Hartree-Fock (HF) theory, BSSE arises from the one-electron basis incompleteness, while in post-Hartree-Fock electron correlation methods (e.g., Møller–Plesset second order (MP2)), an additional basis sensitivity of the correlation energy contributes to BSSE.\n\nYour task is to compute, for a given set of test cases, the magnitude of BSSE for Hartree-Fock and for a correlated method defined by a provided additive correlation energy correction. Use the following fundamental base:\n- The variational principle for electronic energies: a larger basis set yields a lower (or equal) total energy.\n- The definition of binding energy of a complex from fragment and complex energies.\n- The Boys–Bernardi counterpoise concept for BSSE, where fragment energies are evaluated in the presence of the partner’s basis functions (ghost basis).\n\nDefinitions for this problem:\n- Let $E_A^{A}$ denote the total Hartree-Fock energy of adsorbate $A$ computed in the adsorbate’s own basis.\n- Let $E_S^{S}$ denote the total Hartree-Fock energy of surface $S$ computed in the surface’s own basis.\n- Let $E_A^{AS}$ denote the total Hartree-Fock energy of adsorbate $A$ computed in the combined basis of $A$ and $S$ with $S$’s nuclei removed (ghost basis functions of $S$ present).\n- Let $E_S^{AS}$ denote the total Hartree-Fock energy of surface $S$ computed in the combined basis of $A$ and $S$ with $A$’s nuclei removed (ghost basis functions of $A$ present).\n- Let $\\Delta_A^{A}$, $\\Delta_S^{S}$ be additive correlation energy corrections (e.g., from MP2) to the HF energies $E_A^{A}$ and $E_S^{S}$, respectively.\n- Let $\\Delta_A^{AS}$, $\\Delta_S^{AS}$ be additive correlation energy corrections to the HF energies $E_A^{AS}$ and $E_S^{AS}$, respectively.\n\nFrom these quantities, you must compute:\n- The Hartree-Fock BSSE magnitude, defined as the amount by which the binding energy is overestimated due to basis set superposition. Express this as a positive quantity in electronvolts (eV).\n- The correlated-method BSSE magnitude, using the same counterpoise concept applied to the HF energy plus the given additive correlation energy corrections. Express this also as a positive quantity in electronvolts (eV), which may be larger or smaller than the Hartree-Fock BSSE depending on the correlation contributions.\n\nAll energies are provided in electronvolts. Express all final BSSE magnitudes in electronvolts (eV), rounded to three decimal places.\n\nTest suite:\nFor each case, the quantities are given as a tuple of eight numbers in the order $(E_A^{A},E_S^{S},E_A^{AS},E_S^{AS},\\Delta_A^{A},\\Delta_S^{S},\\Delta_A^{AS},\\Delta_S^{AS})$.\n\n- Case 1 (moderate BSSE in Hartree–Fock, correlation increases BSSE):\n  - $( -10.000,\\,-100.000,\\,-10.050,\\,-100.030,\\,-0.500,\\,-5.000,\\,-0.520,\\,-5.050 )$\n- Case 2 (strong BSSE in Hartree–Fock, correlation increases BSSE):\n  - $( -20.000,\\,-200.000,\\,-20.200,\\,-200.150,\\,-1.000,\\,-10.000,\\,-1.060,\\,-10.100 )$\n- Case 3 (boundary case: complete basis effectively for both fragments, zero BSSE):\n  - $( -15.000,\\,-150.000,\\,-15.000,\\,-150.000,\\,-0.750,\\,-7.500,\\,-0.750,\\,-7.500 )$\n- Case 4 (moderate BSSE in Hartree–Fock, correlation decreases BSSE):\n  - $( -12.000,\\,-120.000,\\,-12.060,\\,-120.030,\\,-0.600,\\,-6.000,\\,-0.590,\\,-5.990 )$\n\nYour program must:\n- For each case, compute the Hartree-Fock BSSE magnitude and the correlated-method BSSE magnitude, both in eV rounded to three decimal places.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[ \\text{HF\\_BSSE\\_case1}, \\text{corr\\_BSSE\\_case1}, \\text{HF\\_BSSE\\_case2}, \\text{corr\\_BSSE\\_case2}, \\text{HF\\_BSSE\\_case3}, \\text{corr\\_BSSE\\_case3}, \\text{HF\\_BSSE\\_case4}, \\text{corr\\_BSSE\\_case4} ]$.",
            "solution": "The Basis Set Superposition Error (BSSE) quantifies the artificial stabilization that occurs when the incomplete basis set of one fragment in a complex is supplemented by the basis functions of another fragment. The counterpoise method by Boys and Bernardi is a standard procedure to estimate this error.\n\nThe interaction energy between adsorbate $A$ and surface $S$ is the energy of the complex $E_{AS}^{AS}$ minus the sum of the energies of the infinitely separated fragments. The BSSE arises because the fragment energies, when calculated with their own small basis sets, are artificially high.\n\nThe uncorrected binding energy, $\\Delta E_{\\text{bind}}^{\\text{uncorr}}$, is typically defined as:\n$$ \\Delta E_{\\text{bind}}^{\\text{uncorr}} = E_{AS}^{AS} - (E_A^A + E_S^S) $$\nwhere $E_{AS}^{AS}$ is the energy of the full complex calculated in the full basis.\n\nThe counterpoise-corrected binding energy, $\\Delta E_{\\text{bind}}^{\\text{cp}}$, is defined by replacing the isolated fragment energies with energies calculated in the presence of the partner's \"ghost\" basis functions:\n$$ \\Delta E_{\\text{bind}}^{\\text{cp}} = E_{AS}^{AS} - (E_A^{AS} + E_S^{AS}) $$\n\nThe BSSE is defined as the amount by which the binding energy is overestimated (i.e., made too negative/favorable). This corresponds to the difference between the corrected and uncorrected binding energies:\n$$ \\delta_{\\text{BSSE}} = \\Delta E_{\\text{bind}}^{\\text{cp}} - \\Delta E_{\\text{bind}}^{\\text{uncorr}} $$\nSubstituting the expressions for the binding energies yields:\n$$ \\delta_{\\text{BSSE}} = \\left[ E_{AS}^{AS} - (E_A^{AS} + E_S^{AS}) \\right] - \\left[ E_{AS}^{AS} - (E_A^A + E_S^S) \\right] $$\n$$ \\delta_{\\text{BSSE}} = (E_A^A + E_S^S) - (E_A^{AS} + E_S^{AS}) $$\nThis can be conveniently separated into contributions from each fragment:\n$$ \\delta_{\\text{BSSE}} = (E_A^A - E_A^{AS}) + (E_S^S - E_S^{AS}) $$\nAccording to the variational principle for Hartree-Fock theory, $E_A^A \\ge E_A^{AS}$ and $E_S^S \\ge E_S^{AS}$, ensuring that $\\delta_{\\text{BSSE}}^{\\text{HF}}$ is a non-negative quantity, consistent with the problem's requirement to express it as a positive magnitude.\n\n**1. Hartree-Fock BSSE Magnitude ($\\delta_{\\text{BSSE}}^{\\text{HF}}$)**\n\nUsing the derived formula, the HF BSSE is:\n$$ \\delta_{\\text{BSSE}}^{\\text{HF}} = (E_A^A - E_A^{AS}) + (E_S^S - E_S^{AS}) $$\n\n**2. Correlated-Method BSSE Magnitude ($\\delta_{\\text{BSSE}}^{\\text{corr}}$)**\n\nThe same logic applies to the total correlated energies. The total energy of a fragment $X$ in basis $Y$ is the sum of its HF energy and its correlation correction: $E_X^Y(\\text{total}) = E_X^Y + \\Delta_X^Y$.\n\nThe BSSE for the correlated method is:\n$$ \\delta_{\\text{BSSE}}^{\\text{corr}} = \\left( E_A^A(\\text{total}) - E_A^{AS}(\\text{total}) \\right) + \\left( E_S^S(\\text{total}) - E_S^{AS}(\\text{total}) \\right) $$\nSubstituting the definitions:\n$$ \\delta_{\\text{BSSE}}^{\\text{corr}} = \\left[ (E_A^A + \\Delta_A^A) - (E_A^{AS} + \\Delta_A^{AS}) \\right] + \\left[ (E_S^S + \\Delta_S^S) - (E_S^{AS} + \\Delta_S^{AS}) \\right] $$\nRearranging terms separates the HF and correlation contributions to the BSSE:\n$$ \\delta_{\\text{BSSE}}^{\\text{corr}} = (E_A^A - E_A^{AS}) + (E_S^S - E_S^{AS}) + (\\Delta_A^A - \\Delta_A^{AS}) + (\\Delta_S^S - \\Delta_S^{AS}) $$\n$$ \\delta_{\\text{BSSE}}^{\\text{corr}} = \\delta_{\\text{BSSE}}^{\\text{HF}} + (\\Delta_A^A - \\Delta_A^{AS}) + (\\Delta_S^S - \\Delta_S^{AS}) $$",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Hartree-Fock and correlated-method BSSE magnitudes\n    for a given set of electronic structure energy data.\n    \"\"\"\n\n    # Test suite with energies in electronvolts (eV).\n    # Each case is a tuple:\n    # (E_A^A, E_S^S, E_A^AS, E_S^AS, Delta_A^A, Delta_S^S, Delta_A^AS, Delta_S^AS)\n    test_cases = [\n        # Case 1 (moderate BSSE in Hartree-Fock, correlation increases BSSE)\n        (-10.000, -100.000, -10.050, -100.030, -0.500, -5.000, -0.520, -5.050),\n        # Case 2 (strong BSSE in Hartree-Fock, correlation increases BSSE)\n        (-20.000, -200.000, -20.200, -200.150, -1.000, -10.000, -1.060, -10.100),\n        # Case 3 (boundary case: complete basis effectively for both fragments, zero BSSE)\n        (-15.000, -150.000, -15.000, -150.000, -0.750, -7.500, -0.750, -7.500),\n        # Case 4 (moderate BSSE in Hartree-Fock, correlation decreases BSSE)\n        (-12.000, -120.000, -12.060, -120.030, -0.600, -6.000, -0.590, -5.990)\n    ]\n\n    results = []\n    for case in test_cases:\n        E_A_A, E_S_S, E_A_AS, E_S_AS, D_A_A, D_S_S, D_A_AS, D_S_AS = case\n\n        # --- Hartree-Fock BSSE Calculation ---\n        # BSSE_HF = (E_A^A - E_A^AS) + (E_S^S - E_S^AS)\n        # This is the sum of artificial stabilizations of each fragment due to\n        # the presence of the partner's basis functions (ghosts).\n        hf_bsse = (E_A_A - E_A_AS) + (E_S_S - E_S_AS)\n        \n        # --- Correlated-Method BSSE Calculation ---\n        # The total correlated energy is E_total = E_HF + Delta_corr.\n        # Total energy of fragment A in its own basis:\n        E_A_A_total = E_A_A + D_A_A\n        # Total energy of fragment S in its own basis:\n        E_S_S_total = E_S_S + D_S_S\n        # Total energy of fragment A in the combined basis:\n        E_A_AS_total = E_A_AS + D_A_AS\n        # Total energy of fragment S in the combined basis:\n        E_S_AS_total = E_S_AS + D_S_AS\n\n        # BSSE_corr = (E_A_A_total - E_A_AS_total) + (E_S_S_total - E_S_AS_total)\n        # This follows the same counterpoise correction logic as the HF case.\n        corr_bsse = (E_A_A_total - E_A_AS_total) + (E_S_S_total - E_S_AS_total)\n        \n        # Format results to three decimal places. The f-string formatting\n        # correctly rounds and ensures the required precision.\n        results.append(f\"{hf_bsse:.3f}\")\n        results.append(f\"{corr_bsse:.3f}\")\n\n    # Print the final output in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}