{
    "hands_on_practices": [
        {
            "introduction": "Mastering Plug Flow Reactor (PFR) modeling begins with its foundational design equation. This first practice challenges you to derive this crucial relationship from a basic mole balance over a differential reactor volume. By integrating this equation for simple first- and second-order reactions, you will build a concrete understanding of how reactor volume, conversion, and reaction kinetics are interconnected, a cornerstone of chemical reactor design .",
            "id": "3872934",
            "problem": "A liquid-phase, isothermal, irreversible isomerization of species $A$ to $B$ is carried out in a Plug Flow Reactor (PFR). The feed contains only $A$ at a molar flow rate $F_{A0}$ and concentration $C_{A0}$. The density is constant, volumetric flow is constant, there are no side reactions, and axial dispersion is negligible. Depending on the candidate microkinetic mechanism, the rate-of-disappearance of $A$ may be first-order or second-order in $A$:\n- First-order hypothesis: $-r_{A} = k_{1} C_{A}$ with $k_{1}$ a constant.\n- Second-order hypothesis: $-r_{A} = k_{2} C_{A}^{2}$ with $k_{2}$ a constant.\n\nStarting from the steady-state mole balance on a differential reactor slice and the definition of conversion, derive the PFR design equation $\\mathrm{d}X/\\mathrm{d}V = -r_{A}/F_{A0}$. Then, using the liquid-phase, constant-density relation $C_{A} = C_{A0}(1-X)$, integrate to obtain the reactor volume $V$ as a function of conversion $X$ under each kinetic hypothesis. For a target conversion $X = 0.85$ at $T$ constant, feed molar flow $F_{A0} = 10\\ \\mathrm{kmol}/\\mathrm{h}$, feed concentration $C_{A0} = 1.0\\ \\mathrm{kmol}/\\mathrm{m}^{3}$, first-order rate constant $k_{1} = 0.75\\ \\mathrm{h}^{-1}$, and second-order rate constant $k_{2} = 1.6\\ \\mathrm{m}^{3}/(\\mathrm{kmol}\\cdot\\mathrm{h})$, compute the dimensionless ratio of reactor volumes $V_{\\text{second}}/V_{\\text{first}}$ required to achieve $X = 0.85$ under the two kinetic hypotheses. Round your final ratio to four significant figures and report it as a pure number with no units.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, complete, and consistent. It represents a standard problem in chemical reactor design. Therefore, a full solution is warranted.\n\nThe solution proceeds in three stages as requested: first, the derivation of the Plug Flow Reactor (PFR) design equation in terms of conversion; second, the integration of this equation for first-order and second-order kinetics to find the required reactor volume $V$ as a function of conversion $X$; and third, the calculation of the numerical ratio of the volumes for the two kinetic models under the specified conditions.\n\n**1. Derivation of the PFR Design Equation**\n\nWe begin with a mole balance on species $A$ over a differential volume element $\\mathrm{d}V$ of the PFR operating at steady state. The general mole balance equation is:\n$$\n\\text{Flow in} - \\text{Flow out} + \\text{Generation} = \\text{Accumulation}\n$$\nFor a differential slice from volume $V$ to $V + \\mathrm{d}V$, and for species $A$, this translates to:\n$$\nF_{A}|_{V} - F_{A}|_{V+\\mathrm{d}V} + r_{A} \\mathrm{d}V = 0\n$$\nwhere $F_A$ is the molar flow rate of $A$ and $r_A$ is the rate of formation of $A$ per unit volume. The accumulation term is zero due to the steady-state assumption.\nThe term $F_{A}|_{V+\\mathrm{d}V}$ can be expressed as a Taylor series expansion around $V$: $F_{A}|_{V+\\mathrm{d}V} = F_{A}|_{V} + \\frac{\\mathrm{d}F_A}{\\mathrm{d}V}\\mathrm{d}V + \\dots$. Neglecting higher-order terms, the balance becomes:\n$$\nF_{A}|_{V} - \\left( F_{A}|_{V} + \\frac{\\mathrm{d}F_A}{\\mathrm{d}V}\\mathrm{d}V \\right) + r_{A} \\mathrm{d}V = 0\n$$\n$$\n-\\frac{\\mathrm{d}F_A}{\\mathrm{d}V}\\mathrm{d}V + r_{A} \\mathrm{d}V = 0\n$$\nDividing by $\\mathrm{d}V$ gives the PFR design equation in terms of molar flow rate:\n$$\n\\frac{\\mathrm{d}F_A}{\\mathrm{d}V} = r_A\n$$\nThe fractional conversion $X$ of reactant $A$ is defined as the fraction of the initial moles of $A$ that have reacted:\n$$\nX = \\frac{F_{A0} - F_A}{F_{A0}}\n$$\nwhere $F_{A0}$ is the molar feed rate of $A$ at the reactor inlet ($V=0$). Rearranging for $F_A$ gives:\n$$\nF_A = F_{A0}(1-X)\n$$\nSince $F_{A0}$ is a constant, differentiating $F_A$ with respect to the reactor volume $V$ yields:\n$$\n\\frac{\\mathrm{d}F_A}{\\mathrm{d}V} = \\frac{\\mathrm{d}}{\\mathrm{d}V}[F_{A0}(1-X)] = -F_{A0}\\frac{\\mathrm{d}X}{\\mathrm{d}V}\n$$\nSubstituting this result into the mole balance $\\frac{\\mathrm{d}F_A}{\\mathrm{d}V} = r_A$ gives:\n$$\n-F_{A0}\\frac{\\mathrm{d}X}{\\mathrm{d}V} = r_A\n$$\nFinally, we rearrange to obtain the requested form of the PFR design equation in terms of conversion $X$ and the rate of disappearance of $A$, $-r_A = -r_{A, \\text{formation}} = r_{A, \\text{disappearance}}$:\n$$\n\\frac{\\mathrm{d}X}{\\mathrm{d}V} = \\frac{-r_A}{F_{A0}}\n$$\nThis completes the first part of the derivation.\n\n**2. Reactor Volume as a Function of Conversion**\n\nFor a liquid-phase reaction with constant density, the volumetric flow rate $v$ is constant. The concentration of species $A$, $C_A$, is related to its molar flow rate $F_A$ by $C_A = F_A/v$. At the inlet, $C_{A0} = F_{A0}/v_{0}$. Since $v=v_0$, we can write:\n$$\nC_A = \\frac{F_A}{v_0} = \\frac{F_{A0}(1-X)}{v_0} = C_{A0}(1-X)\n$$\nThis confirms the relation provided in the problem statement. Now we integrate the design equation for each kinetic hypothesis.\n\nThe design equation can be separated and integrated to find the volume $V$ required to achieve a conversion $X$:\n$$\nV = F_{A0} \\int_{0}^{X} \\frac{1}{-r_A} \\mathrm{d}X'\n$$\n\n**First-Order Hypothesis:**\nThe rate law is $-r_A = k_1 C_A$. Substituting the concentration expression, we get:\n$$\n-r_A = k_1 C_{A0}(1-X)\n$$\nSubstituting this into the integral form of the design equation:\n$$\nV_{\\text{first}} = F_{A0} \\int_{0}^{X} \\frac{1}{k_1 C_{A0}(1-X')} \\mathrm{d}X'\n$$\nSince $F_{A0}$, $k_1$, and $C_{A0}$ are constants, we can take them out of the integral:\n$$\nV_{\\text{first}} = \\frac{F_{A0}}{k_1 C_{A0}} \\int_{0}^{X} \\frac{1}{1-X'} \\mathrm{d}X' = \\frac{F_{A0}}{k_1 C_{A0}} [-\\ln(1-X')]_{0}^{X}\n$$\n$$\nV_{\\text{first}} = \\frac{F_{A0}}{k_1 C_{A0}} [-\\ln(1-X) - (-\\ln(1-0))] = -\\frac{F_{A0}}{k_1 C_{A0}} \\ln(1-X) = \\frac{F_{A0}}{k_1 C_{A0}} \\ln\\left(\\frac{1}{1-X}\\right)\n$$\n\n**Second-Order Hypothesis:**\nThe rate law is $-r_A = k_2 C_A^2$. Substituting the concentration expression:\n$$\n-r_A = k_2 (C_{A0}(1-X))^2 = k_2 C_{A0}^2 (1-X)^2\n$$\nSubstituting this into the integral design equation:\n$$\nV_{\\text{second}} = F_{A0} \\int_{0}^{X} \\frac{1}{k_2 C_{A0}^2 (1-X')^2} \\mathrm{d}X'\n$$\nTaking the constants out of the integral:\n$$\nV_{\\text{second}} = \\frac{F_{A0}}{k_2 C_{A0}^2} \\int_{0}^{X} (1-X')^{-2} \\mathrm{d}X' = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left[\\frac{1}{1-X'}\\right]_{0}^{X}\n$$\n$$\nV_{\\text{second}} = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{1}{1-X} - \\frac{1}{1-0}\\right) = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{1 - (1-X)}{1-X}\\right)\n$$\n$$\nV_{\\text{second}} = \\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{X}{1-X}\\right)\n$$\n\n**3. Calculation of the Ratio of Reactor Volumes**\n\nWe now compute the ratio $V_{\\text{second}}/V_{\\text{first}}$ using the derived expressions:\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{\\frac{F_{A0}}{k_2 C_{A0}^2} \\left(\\frac{X}{1-X}\\right)}{\\frac{F_{A0}}{k_1 C_{A0}} \\ln\\left(\\frac{1}{1-X}\\right)}\n$$\nSimplifying the expression by canceling terms ($F_{A0}$ and one factor of $C_{A0}$):\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{k_1}{k_2 C_{A0}} \\frac{\\left(\\frac{X}{1-X}\\right)}{\\ln\\left(\\frac{1}{1-X}\\right)}\n$$\nThis is the final symbolic expression for the ratio. Now, we substitute the given numerical values:\n- Target conversion $X = 0.85$.\n- First-order rate constant $k_1 = 0.75\\ \\mathrm{h}^{-1}$.\n- Second-order rate constant $k_2 = 1.6\\ \\mathrm{m}^{3}/(\\mathrm{kmol}\\cdot\\mathrm{h})$.\n- Feed concentration $C_{A0} = 1.0\\ \\mathrm{kmol}/\\mathrm{m}^{3}$.\n\nFirst, calculate the intermediate terms:\n$$\n1 - X = 1 - 0.85 = 0.15\n$$\n$$\n\\frac{X}{1-X} = \\frac{0.85}{0.15} = \\frac{17}{3}\n$$\n$$\n\\frac{1}{1-X} = \\frac{1}{0.15} = \\frac{20}{3}\n$$\n$$\n\\ln\\left(\\frac{1}{1-X}\\right) = \\ln\\left(\\frac{20}{3}\\right)\n$$\nNow, substitute these into the ratio expression along with the constants:\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{0.75\\ \\mathrm{h}^{-1}}{(1.6\\ \\mathrm{m}^{3}/(\\mathrm{kmol}\\cdot\\mathrm{h})) (1.0\\ \\mathrm{kmol}/\\mathrm{m}^{3})} \\frac{\\frac{17}{3}}{\\ln\\left(\\frac{20}{3}\\right)}\n$$\nThe units in the first term cancel out, as expected for a dimensionless ratio:\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = \\frac{0.75}{1.6} \\frac{\\frac{17}{3}}{\\ln\\left(\\frac{20}{3}\\right)} = 0.46875 \\times \\frac{5.666...}{1.8971199...}\n$$\n$$\n\\frac{V_{\\text{second}}}{V_{\\text{first}}} = 0.46875 \\times 2.986980... \\approx 1.399678...\n$$\nRounding the final result to four significant figures gives $1.400$.",
            "answer": "$$\n\\boxed{1.400}\n$$"
        },
        {
            "introduction": "Real-world reactors often involve complex interactions between fluid dynamics and catalytic chemistry, creating important design trade-offs. This exercise moves beyond the simple PFR model to a packed-bed reactor, where you must balance macroscopic and microscopic phenomena . You will use the Ergun equation to constrain pressure drop and the Thiele modulus to manage internal diffusion limitations, ultimately defining a feasible design window for catalyst particle size.",
            "id": "3894962",
            "problem": "Consider an isothermal Plug Flow Reactor (PFR) packed with spherical porous catalyst pellets of diameter $d_p$ that catalyze a single, first-order reaction with rate constant $k$ in $\\text{s}^{-1}$. The bed has bulk void fraction $ \\varepsilon_b $ and length $ L $ in $\\text{m}$, with a superficial velocity $ v $ in $\\text{m}\\,\\text{s}^{-1}$ of a single-phase fluid of density $ \\rho $ in $\\text{kg}\\,\\text{m}^{-3}$ and dynamic viscosity $ \\mu $ in $\\text{Pa}\\,\\text{s}$. Transport of reactant within a pellet is by molecular diffusion with binary diffusivity $ D_{AB} $ in $\\text{m}^2\\,\\text{s}^{-1}$, pellet porosity $ \\varepsilon_p $, and tortuosity $ \\tau $, giving an effective diffusivity $ D_\\text{eff} = \\varepsilon_p D_{AB} / \\tau $ in $\\text{m}^2\\,\\text{s}^{-1}$. The packed-bed pressure drop must not exceed a specified limit $ \\Delta P_\\text{max} $ in $\\text{Pa}$, and the internal diffusion limitation must be sufficiently weak such that the spherical pellet effectiveness factor $ \\eta $ is at least $ \\eta_\\text{min} $ (dimensionless).\n\nStarting only from a momentum balance across a fixed bed under steady flow and a steady-state diffusion-reaction balance in a spherical porous pellet for a first-order reaction, derive the relationships needed to:\n\n- Compute the minimum pellet diameter $ d_{p,\\min} $ in $\\text{m}$ that satisfies $ \\Delta P \\le \\Delta P_\\text{max} $ for the packed bed.\n- Compute the maximum pellet diameter $ d_{p,\\max} $ in $\\text{m}$ that satisfies $ \\eta \\ge \\eta_\\text{min} $ for the spherical pellet, expressed through the Thiele modulus and the effectiveness factor associated with a first-order reaction in a sphere.\n\nThen, propose a design window for $ d_p $ in $\\text{m}$ that balances transport and reaction by returning the interval $[d_{p,\\min}, d_{p,\\max}]$ when feasible. If no feasible window exists (i.e., $ d_{p,\\min}  d_{p,\\max} $), return an empty list for that case.\n\nAll answers involving physical quantities must be expressed in the specified units. The effectiveness factor threshold must be enforced as a decimal (not a percentage sign).\n\nYour program must implement this logic for the following test suite of parameter sets. Each case provides $(L, \\varepsilon_b, \\mu, \\rho, v, \\Delta P_\\text{max}, k, D_{AB}, \\varepsilon_p, \\tau, \\eta_\\text{min})$ with units as stated above:\n\n- Case $1$ (general gas-phase, feasible):\n  - $L = 5$ $\\text{m}$, $\\varepsilon_b = 0.40$, $\\mu = 2\\times 10^{-5}$ $\\text{Pa}\\,\\text{s}$, $\\rho = 1$ $\\text{kg}\\,\\text{m}^{-3}$, $v = 0.5$ $\\text{m}\\,\\text{s}^{-1}$,\n  - $\\Delta P_\\text{max} = 5.0\\times 10^{4}$ $\\text{Pa}$, $k = 0.5$ $\\text{s}^{-1}$, $D_{AB} = 5.0\\times 10^{-6}$ $\\text{m}^{2}\\,\\text{s}^{-1}$, $\\varepsilon_p = 0.35$, $\\tau = 3.0$, $\\eta_\\text{min} = 0.75$.\n- Case $2$ (stringent pressure-drop constraint, likely infeasible window):\n  - $L = 5$ $\\text{m}$, $\\varepsilon_b = 0.40$, $\\mu = 2\\times 10^{-5}$ $\\text{Pa}\\,\\text{s}$, $\\rho = 1$ $\\text{kg}\\,\\text{m}^{-3}$, $v = 0.5$ $\\text{m}\\,\\text{s}^{-1}$,\n  - $\\Delta P_\\text{max} = 5.0\\times 10^{3}$ $\\text{Pa}$, $k = 0.5$ $\\text{s}^{-1}$, $D_{AB} = 5.0\\times 10^{-6}$ $\\text{m}^{2}\\,\\text{s}^{-1}$, $\\varepsilon_p = 0.35$, $\\tau = 3.0$, $\\eta_\\text{min} = 0.75$.\n- Case $3$ (higher diffusivity and lower velocity, wide feasible window):\n  - $L = 4$ $\\text{m}$, $\\varepsilon_b = 0.40$, $\\mu = 2\\times 10^{-5}$ $\\text{Pa}\\,\\text{s}$, $\\rho = 1$ $\\text{kg}\\,\\text{m}^{-3}$, $v = 0.30$ $\\text{m}\\,\\text{s}^{-1}$,\n  - $\\Delta P_\\text{max} = 3.0\\times 10^{4}$ $\\text{Pa}$, $k = 0.20$ $\\text{s}^{-1}$, $D_{AB} = 2.0\\times 10^{-5}$ $\\text{m}^{2}\\,\\text{s}^{-1}$, $\\varepsilon_p = 0.35$, $\\tau = 3.0$, $\\eta_\\text{min} = 0.80$.\n- Case $4$ (liquid-phase properties with strong reaction, likely infeasible due to diffusion):\n  - $L = 2$ $\\text{m}$, $\\varepsilon_b = 0.45$, $\\mu = 5.0\\times 10^{-3}$ $\\text{Pa}\\,\\text{s}$, $\\rho = 800$ $\\text{kg}\\,\\text{m}^{-3}$, $v = 0.020$ $\\text{m}\\,\\text{s}^{-1}$,\n  - $\\Delta P_\\text{max} = 1.0\\times 10^{5}$ $\\text{Pa}$, $k = 5.0$ $\\text{s}^{-1}$, $D_{AB} = 1.0\\times 10^{-9}$ $\\text{m}^{2}\\,\\text{s}^{-1}$, $\\varepsilon_p = 0.40$, $\\tau = 4.0$, $\\eta_\\text{min} = 0.90$.\n\nYour program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, where each case's result is either a two-element list $[d_{p,\\min}, d_{p,\\max}]$ in $\\text{m}$ or an empty list if no feasible window exists. For example, a valid output format is $[ [a_1,b_1], [], [a_3,b_3], [] ]$, where all $a_i$ and $b_i$ are floats in $\\text{m}$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard chemical engineering design problem involving the optimization of catalyst pellet size in a packed-bed reactor. The problem is based on fundamental principles, namely the Ergun equation for pressure drop and the effectiveness factor concept for diffusion and reaction in porous catalysts. All necessary parameters are provided, and the objectives are clearly defined. Therefore, the problem is valid, and a solution can be constructed.\n\nThe task is to determine a feasible design window for the spherical catalyst pellet diameter, $d_p$, by balancing two competing constraints:\n1.  The pressure drop across the packed bed, $\\Delta P$, must not exceed a maximum allowable value, $\\Delta P_\\text{max}$. This constraint sets a lower bound on the pellet diameter, $d_{p,\\min}$, because smaller pellets lead to higher pressure drops.\n2.  The internal mass transfer limitation must be minimal, such that the catalyst effectiveness factor, $\\eta$, remains above a minimum threshold, $\\eta_\\text{min}$. This constraint sets an upper bound on the pellet diameter, $d_{p,\\max}$, because larger pellets increase diffusion path lengths and enhance mass transfer limitations, thereby reducing $\\eta$.\n\nThe feasible design window is the interval $[d_{p,\\min}, d_{p,\\max}]$, provided that $d_{p,\\min} \\le d_{p,\\max}$.\n\n### Constraint 1: Pressure Drop and Minimum Pellet Diameter ($d_{p,\\min}$)\nThe pressure drop across a packed bed is described by the Ergun equation, which arises from a momentum balance on the fluid flowing through the tortuous paths between particles. The equation relates the pressure gradient, $-\\frac{dP}{dz}$, to the fluid properties, bed characteristics, and particle diameter. For a bed of spherical particles of diameter $d_p$, it is given by:\n$$\n-\\frac{dP}{dz} = \\frac{150 (1-\\varepsilon_b)^2}{\\varepsilon_b^3 d_p^2} \\mu v + \\frac{1.75 (1-\\varepsilon_b)}{\\varepsilon_b^3 d_p} \\rho v^2\n$$\nwhere $\\varepsilon_b$ is the bed void fraction, $\\mu$ is the fluid dynamic viscosity, $\\rho$ is the fluid density, and $v$ is the superficial velocity. The first term represents viscous losses (dominant at low flow rates, akin to the Carman-Kozeny equation), and the second term represents kinetic energy losses (dominant at high flow rates, akin to the Burke-Plummer equation).\n\nAssuming the fluid properties ($\\rho$, $\\mu$) are constant along the reactor length $L$, we can integrate this equation to find the total pressure drop $\\Delta P$:\n$$\n\\Delta P = L \\left( \\frac{150 (1-\\varepsilon_b)^2}{\\varepsilon_b^3 d_p^2} \\mu v + \\frac{1.75 (1-\\varepsilon_b)}{\\varepsilon_b^3 d_p} \\rho v^2 \\right)\n$$\nThe constraint is $\\Delta P \\le \\Delta P_\\text{max}$. Since $\\Delta P$ is a monotonically decreasing function of $d_p$, the minimum allowable pellet diameter, $d_{p,\\min}$, is found when the pressure drop is at its maximum value, $\\Delta P = \\Delta P_\\text{max}$.\n$$\n\\Delta P_\\text{max} = \\frac{L}{d_{p,\\min}^2} \\left[ \\frac{150 (1-\\varepsilon_b)^2}{\\varepsilon_b^3} \\mu v \\right] + \\frac{L}{d_{p,\\min}} \\left[ \\frac{1.75 (1-\\varepsilon_b)}{\\varepsilon_b^3} \\rho v^2 \\right]\n$$\nThis equation is a quadratic equation for the variable $1/d_{p,\\min}$. To solve for $d_{p,\\min}$, we can rearrange it into the standard form $ax^2 + bx + c = 0$, where $x = d_{p,\\min}$:\n$$\n(\\Delta P_\\text{max}) d_{p,\\min}^2 - \\left( L \\frac{1.75 (1-\\varepsilon_b)}{\\varepsilon_b^3} \\rho v^2 \\right) d_{p,\\min} - \\left( L \\frac{150 (1-\\varepsilon_b)^2}{\\varepsilon_b^3} \\mu v \\right) = 0\n$$\nLet's define the coefficients $A$ and $B$ for clarity:\n$$\nA = L \\frac{1.75 (1-\\varepsilon_b)}{\\varepsilon_b^3} \\rho v^2\n$$\n$$\nB = L \\frac{150 (1-\\varepsilon_b)^2}{\\varepsilon_b^3} \\mu v\n$$\nThe equation becomes:\n$$\n\\Delta P_\\text{max} d_{p,\\min}^2 - A d_{p,\\min} - B = 0\n$$\nUsing the quadratic formula and selecting the physically meaningful positive root for the diameter, we obtain:\n$$\nd_{p,\\min} = \\frac{A + \\sqrt{A^2 + 4(\\Delta P_\\text{max})B}}{2 \\Delta P_\\text{max}}\n$$\n\n### Constraint 2: Effectiveness Factor and Maximum Pellet Diameter ($d_{p,\\max}$)\nThe effectiveness factor, $\\eta$, quantifies the effect of internal diffusion limitations on the observed reaction rate. It is defined as the ratio of the actual reaction rate within the pellet to the rate that would occur if the entire pellet interior were at the surface concentration and temperature. For an isothermal, spherical pellet with a first-order irreversible reaction, the steady-state diffusion-reaction mass balance is:\n$$\nD_\\text{eff} \\left( \\frac{d^2C_A}{dr^2} + \\frac{2}{r} \\frac{dC_A}{dr} \\right) - k C_A = 0\n$$\nHere, $D_\\text{eff}$ is the effective diffusivity of the reactant $A$ in the porous pellet, $k$ is the first-order reaction rate constant, and $C_A$ is the concentration of $A$ at a radial position $r$. The effective diffusivity is given by $D_\\text{eff} = \\varepsilon_p D_{AB} / \\tau$, where $\\varepsilon_p$ is the pellet porosity, $D_{AB}$ is the binary gas-phase diffusivity, and $\\tau$ is the tortuosity.\n\nThe solution of this differential equation leads to an expression for the effectiveness factor $\\eta$ in terms of the Thiele modulus, $\\phi_1$. The Thiele modulus is a dimensionless group that compares the characteristic rate of reaction to the characteristic rate of diffusion. For a first-order reaction in a spherical pellet of radius $R_p = d_p/2$:\n$$\n\\phi_1 = R_p \\sqrt{\\frac{k}{D_\\text{eff}}} = \\frac{d_p}{2} \\sqrt{\\frac{k}{D_\\text{eff}}}\n$$\nThe effectiveness factor $\\eta$ is then given by:\n$$\n\\eta = \\frac{3}{\\phi_1^2} (\\phi_1 \\coth(\\phi_1) - 1)\n$$\nwhere $\\coth(x)$ is the hyperbolic cotangent. The value of $\\eta$ ranges from $1$ (for small $\\phi_1$, reaction-limited regime) to $3/\\phi_1$ (for large $\\phi_1$, diffusion-limited regime). Since $\\eta$ is a monotonically decreasing function of $\\phi_1$, and $\\phi_1$ is directly proportional to $d_p$, the constraint $\\eta \\ge \\eta_\\text{min}$ imposes an upper limit on both the Thiele modulus and the pellet diameter.\nLet $\\phi_{1,\\max}$ be the Thiele modulus corresponding to $\\eta_\\text{min}$. It must be found by numerically solving the transcendental equation:\n$$\n\\eta_\\text{min} = \\frac{3}{\\phi_{1,\\max}^2} (\\phi_{1,\\max} \\coth(\\phi_{1,\\max}) - 1)\n$$\nOnce $\\phi_{1,\\max}$ is determined, the maximum allowable pellet diameter, $d_{p,\\max}$, can be calculated by rearranging the definition of the Thiele modulus:\n$$\n\\phi_{1,\\max} = \\frac{d_{p,\\max}}{2} \\sqrt{\\frac{k}{D_\\text{eff}}} \\implies d_{p,\\max} = 2 \\phi_{1,\\max} \\sqrt{\\frac{D_\\text{eff}}{k}}\n$$\nSubstituting the expression for $D_\\text{eff}$:\n$$\nd_{p,\\max} = 2 \\phi_{1,\\max} \\sqrt{\\frac{\\varepsilon_p D_{AB}}{\\tau k}}\n$$\n\n### Feasible Design Window\nBy combining both constraints, a feasible catalyst pellet must have a diameter $d_p$ such that $d_p \\ge d_{p,\\min}$ (to satisfy pressure drop) and $d_p \\le d_{p,\\max}$ (to satisfy effectiveness). A feasible design window exists if and only if $d_{p,\\min} \\le d_{p,\\max}$. The resulting window is the interval $[d_{p,\\min}, d_{p,\\max}]$. If $d_{p,\\min}  d_{p,\\max}$, no pellet diameter can simultaneously satisfy both constraints, and the design is infeasible.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Calculates the feasible design window for catalyst pellet diameter based on\n    pressure drop and effectiveness factor constraints for a series of test cases.\n    \"\"\"\n    # Each test case is a tuple:\n    # (L, eps_b, mu, rho, v, dP_max, k, D_AB, eps_p, tau, eta_min)\n    # Units are SI units as specified in the problem: m, s, kg, Pa.\n    test_cases = [\n        # Case 1 (general gas-phase, feasible)\n        (5.0, 0.40, 2e-5, 1.0, 0.5, 5.0e4, 0.5, 5.0e-6, 0.35, 3.0, 0.75),\n        # Case 2 (stringent pressure-drop constraint, likely infeasible window)\n        (5.0, 0.40, 2e-5, 1.0, 0.5, 5.0e3, 0.5, 5.0e-6, 0.35, 3.0, 0.75),\n        # Case 3 (higher diffusivity and lower velocity, wide feasible window)\n        (4.0, 0.40, 2e-5, 1.0, 0.3, 3.0e4, 0.2, 2.0e-5, 0.35, 3.0, 0.80),\n        # Case 4 (liquid-phase properties with strong reaction, likely infeasible due to diffusion)\n        (2.0, 0.45, 5.0e-3, 800.0, 0.02, 1.0e5, 5.0, 1.0e-9, 0.40, 4.0, 0.90),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, eps_b, mu, rho, v, dP_max, k, D_AB, eps_p, tau, eta_min = case\n\n        # 1. Calculate minimum pellet diameter (dp_min) from pressure drop constraint\n        A = L * (1.75 * (1 - eps_b) / (eps_b**3)) * rho * v**2\n        B = L * (150 * (1 - eps_b)**2 / (eps_b**3)) * mu * v\n        \n        # Solve the quadratic equation: dP_max * dp^2 - A * dp - B = 0\n        # We need the positive root for dp_min\n        discriminant = A**2 + 4 * dP_max * B\n        dp_min = (A + np.sqrt(discriminant)) / (2 * dP_max)\n\n        # 2. Calculate maximum pellet diameter (dp_max) from effectiveness factor constraint\n        D_eff = (eps_p * D_AB) / tau\n\n        # Define the function to find the root phi_max for a given eta_min.\n        # f(phi) = (3/phi^2)*(phi*coth(phi) - 1) - eta_min = 0\n        # We use a lambda function that is robust for small phi.\n        def eta_func(phi):\n            if phi  1e-6:\n                # Taylor expansion for small phi to avoid division by zero\n                # eta â‰ˆ 1 - phi^2/15\n                return 1.0\n            return (3.0 / phi**2) * (phi / np.tanh(phi) - 1.0)\n        \n        def root_func(phi):\n            return eta_func(phi) - eta_min\n\n        # Numerically solve for phi_max\n        # Bracket [a, b] must have f(a)*f(b)  0.\n        # eta(phi->0) = 1, eta(phi->inf) = 0.\n        # For eta_min in (0, 1), a root exists for phi > 0.\n        # A safe bracket is [1e-9, 100].\n        try:\n            sol = optimize.root_scalar(root_func, bracket=[1e-9, 100], method='brentq')\n            phi_max = sol.root\n        except ValueError:\n            # This would happen if eta_min is outside the range [0, 1], which is not the case here.\n            # Handles unexpected issues with the root finder.\n            results.append([])\n            continue\n\n        dp_max = 2 * phi_max * np.sqrt(D_eff / k)\n\n        # 3. Determine the feasible window\n        if dp_min = dp_max:\n            results.append([dp_min, dp_max])\n        else:\n            results.append([])\n\n    # Format the final output string as requested\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Theoretical models must be rigorously tested against experimental reality. This final practice focuses on the critical interface between PFR modeling and laboratory data, introducing the concept of data reconciliation . Using fundamental principles of stoichiometry and atomic conservation, you will learn how to assess the consistency of measured reactor performance data and quantify potential experimental errors or model inconsistencies.",
            "id": "3894999",
            "problem": "A steady-state, isothermal plug flow reactor (PFR) processes a dry gas mixture containing carbon monoxide, hydrogen, oxygen, and nitrogen over a supported oxidation catalyst. Nitrogen is inert. Only the following two independent reactions occur within the reactor:\n- Reaction $\\mathrm{R1}$: $\\mathrm{CO} + \\tfrac{1}{2}\\,\\mathrm{O}_{2} \\rightarrow \\mathrm{CO}_{2}$,\n- Reaction $\\mathrm{R2}$: $\\mathrm{H}_{2} + \\tfrac{1}{2}\\,\\mathrm{O}_{2} \\rightarrow \\mathrm{H}_{2}\\mathrm{O}$.\n\nAssume ideal gas behavior, negligible pressure drop, and no accumulation. The catalyst bed volume is $V = 1.00 \\times 10^{-3}\\ \\mathrm{m}^{3}$. The inlet molar flow rates (in $\\mathrm{mol}\\,\\mathrm{s}^{-1}$) are:\n- $\\mathrm{CO}$: $0.0200$,\n- $\\mathrm{H}_{2}$: $0.0150$,\n- $\\mathrm{O}_{2}$: $0.0190$,\n- $\\mathrm{N}_{2}$: $0.0760$,\n- $\\mathrm{CO}_{2}$: $0$,\n- $\\mathrm{H}_{2}\\mathrm{O}$: $0$.\n\nMeasured outlet molar flow rates (in $\\mathrm{mol}\\,\\mathrm{s}^{-1}$) are:\n- $\\mathrm{CO}$: $0.0079$,\n- $\\mathrm{CO}_{2}$: $0.0118$,\n- $\\mathrm{H}_{2}$: $0.0069$,\n- $\\mathrm{H}_{2}\\mathrm{O}$: $0.0083$,\n- $\\mathrm{O}_{2}$: $0.0092$,\n- $\\mathrm{N}_{2}$: $0.0761$.\n\nStarting from the species mole balance for a steady-state PFR, $dF_{i}/dV = \\sum_{j}\\nu_{ij} r_{j}$, and the definition of the (volume-)integrated reaction extent $\\Xi_{j} = \\int_{0}^{V} r_{j}\\,dV$, derive the relations that connect inlet and outlet molar flows to the reaction extents for this system. Then, using atomic element conservation for carbon, hydrogen, and oxygen, construct elemental balance residuals for the measured outlet data.\n\nDefine the following space-averaged rate estimates (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$) from species-specific stoichiometric inferences:\n- For $\\mathrm{R1}$: $r_{1}^{(\\mathrm{CO})} = \\left(F_{\\mathrm{CO,in}} - F_{\\mathrm{CO,out}}\\right)/V$, and $r_{1}^{(\\mathrm{CO_{2}})} = \\left(F_{\\mathrm{CO_{2},out}} - F_{\\mathrm{CO_{2},in}}\\right)/V$.\n- For $\\mathrm{R2}$: $r_{2}^{(\\mathrm{H_{2}})} = \\left(F_{\\mathrm{H_{2},in}} - F_{\\mathrm{H_{2},out}}\\right)/V$, and $r_{2}^{(\\mathrm{H_{2}O})} = \\left(F_{\\mathrm{H_{2}O,out}} - F_{\\mathrm{H_{2}O,in}}\\right)/V$.\n- From $\\mathrm{O_{2}}$ consumption, the combined average rate $r_{\\Sigma}^{(\\mathrm{O_{2}})} = \\left(\\Xi_{1} + \\Xi_{2}\\right)/V$ obtained via $\\tfrac{1}{2}\\left(\\Xi_{1} + \\Xi_{2}\\right) = F_{\\mathrm{O_{2},in}} - F_{\\mathrm{O_{2},out}}$.\n\nUsing these quantities, define the rate disagreement norm\n$$\nD \\equiv \\sqrt{\\left(r_{1}^{(\\mathrm{CO})} - r_{1}^{(\\mathrm{CO_{2}})}\\right)^{2} + \\left(r_{2}^{(\\mathrm{H_{2}})} - r_{2}^{(\\mathrm{H_{2}O})}\\right)^{2} + \\left(\\left[r_{1}^{(\\mathrm{CO})} + r_{2}^{(\\mathrm{H_{2}})}\\right] - r_{\\Sigma}^{(\\mathrm{O_{2}})}\\right)^{2}}.\n$$\n\nCompute $D$ from the provided data. Round your answer to three significant figures and express it in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.",
            "solution": "The problem statement is critically validated and found to be scientifically sound, well-posed, and internally consistent, allowing for a rigorous solution. The minor discrepancies in the elemental balances, as derived from the provided inlet and outlet molar flow rates, are characteristic of real experimental data and are precisely the object of quantification by the disagreement norm $D$.\n\nFirst, we derive the general relations connecting inlet and outlet molar flows to the reaction extents. The species mole balance for a steady-state plug flow reactor (PFR) is given by:\n$$\n\\frac{dF_{i}}{dV} = R_{i} = \\sum_{j=1}^{N_{R}} \\nu_{ij} r_{j}\n$$\nwhere $F_{i}$ is the molar flow rate of species $i$, $V$ is the reactor volume, $R_{i}$ is the net rate of formation of species $i$, $\\nu_{ij}$ is the stoichiometric coefficient of species $i$ in reaction $j$, $r_{j}$ is the rate of reaction $j$, and $N_{R}$ is the total number of independent reactions. In this system, there are $N_{R}=2$ reactions:\n$$\n\\begin{align*}\n\\mathrm{R1:}\\  \\mathrm{CO} + \\tfrac{1}{2}\\,\\mathrm{O}_{2} \\rightarrow \\mathrm{CO}_{2} \\\\\n\\mathrm{R2:}\\  \\mathrm{H}_{2} + \\tfrac{1}{2}\\,\\mathrm{O}_{2} \\rightarrow \\mathrm{H}_{2}\\mathrm{O}\n\\end{align*}\n$$\nThe species are indexed as follows: $1 = \\mathrm{CO}$, $2 = \\mathrm{H}_{2}$, $3 = \\mathrm{O}_{2}$, $4 = \\mathrm{CO}_{2}$, $5 = \\mathrm{H}_{2}\\mathrm{O}$, $6 = \\mathrm{N}_{2}$. The stoichiometric matrix $\\nu_{ij}$ is:\n$$\n\\boldsymbol{\\nu} =\n\\begin{pmatrix}\n-1  0 \\\\\n0  -1 \\\\\n-1/2  -1/2 \\\\\n+1  0 \\\\\n0  +1 \\\\\n0  0\n\\end{pmatrix}\n$$\nIntegrating the mole balance equation over the reactor volume from $0$ to $V$ yields:\n$$\n\\int_{F_{i,\\text{in}}}^{F_{i,\\text{out}}} dF_{i} = F_{i,\\text{out}} - F_{i,\\text{in}} = \\int_{0}^{V} \\sum_{j=1}^{N_{R}} \\nu_{ij} r_{j} \\,dV = \\sum_{j=1}^{N_{R}} \\nu_{ij} \\int_{0}^{V} r_{j} \\,dV\n$$\nUsing the problem's definition for the volume-integrated reaction extent, $\\Xi_{j} = \\int_{0}^{V} r_{j}\\,dV$, we obtain the fundamental relation:\n$$\nF_{i,\\text{out}} - F_{i,\\text{in}} = \\sum_{j=1}^{N_{R}} \\nu_{ij} \\Xi_{j}\n$$\nApplying this to the reacting species:\nFor $\\mathrm{CO}$: $F_{\\mathrm{CO,out}} - F_{\\mathrm{CO,in}} = -\\Xi_{1}$.\nFor $\\mathrm{H}_{2}$: $F_{\\mathrm{H_{2},out}} - F_{\\mathrm{H_{2},in}} = -\\Xi_{2}$.\nFor $\\mathrm{O}_{2}$: $F_{\\mathrm{O_{2},out}} - F_{\\mathrm{O_{2},in}} = -\\frac{1}{2}\\Xi_{1} - \\frac{1}{2}\\Xi_{2}$.\nFor $\\mathrm{CO}_{2}$: $F_{\\mathrm{CO_{2},out}} - F_{\\mathrm{CO_{2},in}} = +\\Xi_{1}$.\nFor $\\mathrm{H}_{2}\\mathrm{O}$: $F_{\\mathrm{H_{2}O,out}} - F_{\\mathrm{H_{2}O,in}} = +\\Xi_{2}$.\nThese equations formally connect the change in molar flows to the integrated reaction extents.\n\nNext, we construct the elemental balance residuals based on the provided measured data. The flux of an element is the sum of its flux in each species containing it.\nFor Carbon (C):\nInlet flux: $\\mathcal{F}_{\\mathrm{C,in}} = F_{\\mathrm{CO,in}} = 0.0200\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\nOutlet flux: $\\mathcal{F}_{\\mathrm{C,out}} = F_{\\mathrm{CO,out}} + F_{\\mathrm{CO_2,out}} = 0.0079 + 0.0118 = 0.0197\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\nResidual: $\\Delta \\mathcal{F}_{\\text{C}} = \\mathcal{F}_{\\mathrm{C,out}} - \\mathcal{F}_{\\mathrm{C,in}} = 0.0197 - 0.0200 = -0.0003\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\n\nFor Hydrogen (H):\nInlet flux: $\\mathcal{F}_{\\mathrm{H,in}} = 2 F_{\\mathrm{H_2,in}} = 2 \\times 0.0150 = 0.0300\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\nOutlet flux: $\\mathcal{F}_{\\mathrm{H,out}} = 2 F_{\\mathrm{H_2,out}} + 2 F_{\\mathrm{H_2O,out}} = 2(0.0069 + 0.0083) = 0.0304\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\nResidual: $\\Delta \\mathcal{F}_{\\text{H}} = \\mathcal{F}_{\\mathrm{H,out}} - \\mathcal{F}_{\\mathrm{H,in}} = 0.0304 - 0.0300 = +0.0004\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\n\nFor Oxygen (O):\nInlet flux: $\\mathcal{F}_{\\mathrm{O,in}} = F_{\\mathrm{CO,in}} + 2 F_{\\mathrm{O_2,in}} = 0.0200 + 2(0.0190) = 0.0580\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\nOutlet flux: $\\mathcal{F}_{\\mathrm{O,out}} = F_{\\mathrm{CO,out}} + 2 F_{\\mathrm{CO_2,out}} + F_{\\mathrm{H_2O,out}} + 2 F_{\\mathrm{O_2,out}} = 0.0079 + 2(0.0118) + 0.0083 + 2(0.0092) = 0.0079 + 0.0236 + 0.0083 + 0.0184 = 0.0582\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\nResidual: $\\Delta \\mathcal{F}_{\\text{O}} = \\mathcal{F}_{\\mathrm{O,out}} - \\mathcal{F}_{\\mathrm{O,in}} = 0.0582 - 0.0580 = +0.0002\\ \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\nThe non-zero residuals indicate minor inconsistencies in the experimental data, as expected.\n\nNow, we compute the space-averaged rate estimates. The reactor volume is $V = 1.00 \\times 10^{-3}\\ \\mathrm{m}^{3}$.\nFor reaction $\\mathrm{R1}$:\n$r_{1}^{(\\mathrm{CO})} = \\frac{F_{\\mathrm{CO,in}} - F_{\\mathrm{CO,out}}}{V} = \\frac{0.0200 - 0.0079}{1.00 \\times 10^{-3}} = \\frac{0.0121}{10^{-3}} = 12.1\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n$r_{1}^{(\\mathrm{CO_{2}})} = \\frac{F_{\\mathrm{CO_{2},out}} - F_{\\mathrm{CO_{2},in}}}{V} = \\frac{0.0118 - 0}{1.00 \\times 10^{-3}} = \\frac{0.0118}{10^{-3}} = 11.8\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nFor reaction $\\mathrm{R2}$:\n$r_{2}^{(\\mathrm{H_{2}})} = \\frac{F_{\\mathrm{H_{2},in}} - F_{\\mathrm{H_{2},out}}}{V} = \\frac{0.0150 - 0.0069}{1.00 \\times 10^{-3}} = \\frac{0.0081}{10^{-3}} = 8.1\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n$r_{2}^{(\\mathrm{H_{2}O})} = \\frac{F_{\\mathrm{H_{2}O,out}} - F_{\\mathrm{H_{2}O,in}}}{V} = \\frac{0.0083 - 0}{1.00 \\times 10^{-3}} = \\frac{0.0083}{10^{-3}} = 8.3\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nFor the combined rate from $\\mathrm{O}_{2}$ consumption, we use the relation $\\frac{1}{2}(\\Xi_{1} + \\Xi_{2}) = F_{\\mathrm{O_{2},in}} - F_{\\mathrm{O_{2},out}}$. The definition $r_{\\Sigma}^{(\\mathrm{O_{2}})} = \\frac{\\Xi_{1} + \\Xi_{2}}{V}$ implies:\n$r_{\\Sigma}^{(\\mathrm{O_{2}})} = \\frac{2(F_{\\mathrm{O_{2},in}} - F_{\\mathrm{O_{2},out}})}{V} = \\frac{2(0.0190 - 0.0092)}{1.00 \\times 10^{-3}} = \\frac{2(0.0098)}{10^{-3}} = 19.6\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nFinally, we compute the disagreement norm $D$:\n$$\nD = \\sqrt{\\left(r_{1}^{(\\mathrm{CO})} - r_{1}^{(\\mathrm{CO_{2}})}\\right)^{2} + \\left(r_{2}^{(\\mathrm{H_{2}})} - r_{2}^{(\\mathrm{H_{2}O})}\\right)^{2} + \\left(\\left[r_{1}^{(\\mathrm{CO})} + r_{2}^{(\\mathrm{H_{2}})}\\right] - r_{\\Sigma}^{(\\mathrm{O_{2}})}\\right)^{2}}\n$$\nWe calculate the terms inside the square root:\nFirst term: $r_{1}^{(\\mathrm{CO})} - r_{1}^{(\\mathrm{CO_{2}})} = 12.1 - 11.8 = 0.3$.\nSecond term: $r_{2}^{(\\mathrm{H_{2}})} - r_{2}^{(\\mathrm{H_{2}O})} = 8.1 - 8.3 = -0.2$.\nThird term: $[r_{1}^{(\\mathrm{CO})} + r_{2}^{(\\mathrm{H_{2}})}] - r_{\\Sigma}^{(\\mathrm{O_{2}})} = (12.1 + 8.1) - 19.6 = 20.2 - 19.6 = 0.6$.\n\nSubstituting these values into the expression for $D$:\n$$\nD = \\sqrt{(0.3)^{2} + (-0.2)^{2} + (0.6)^{2}}\n$$\n$$\nD = \\sqrt{0.09 + 0.04 + 0.36}\n$$\n$$\nD = \\sqrt{0.49}\n$$\n$$\nD = 0.7\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\nD = 0.700\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}\n$$\nThis value quantifies the inconsistency among the rate estimates derived from different species measurements, which ultimately stems from the minor imbalances in the measured elemental fluxes.",
            "answer": "$$\n\\boxed{0.700}\n$$"
        }
    ]
}