{
    "hands_on_practices": [
        {
            "introduction": "朗缪尔模型是表面吸附理论的基石，它为理解气体分子如何占据催化剂表面的活性位点提供了一个简单而强大的框架。本练习将指导您从基本的动力学原理出发，通过平衡吸附和解吸速率来推导这一基本方程。这不仅能加深您对表面平衡的理解，还能让您熟练掌握表面覆盖率与气体压力之间的关系 。",
            "id": "3867955",
            "problem": "气相吸附物 $A$ 与一个催化活性表面相互作用，该表面由大量相同的、无相互作用的位点组成，温度为 $T$。假设为单层吸附、横向相互作用可忽略、气体为理想气体。令分数表面覆盖率为 $\\theta$，则位点守恒意味着 $\\theta + \\theta_{\\mathrm{vac}} = 1$，其中 $\\theta_{\\mathrm{vac}}$ 是空位点的分数。在等温等压条件下，将吸附和解吸模拟为具有质量作用动力学的基元步骤：\n- 吸附速率：$r_{\\mathrm{ads}} = k_{\\mathrm{ads}}\\,p\\,(1-\\theta)$。\n- 解吸速率：$r_{\\mathrm{des}} = k_{\\mathrm{des}}\\,\\theta$。\n此处，$p$ 是 $A$ 的气相压力，$k_{\\mathrm{ads}}$ 和 $k_{\\mathrm{des}}$ 是与温度相关的速率系数。定义吸附平衡常数 $K \\equiv k_{\\mathrm{ads}}/k_{\\mathrm{des}}$，当压力以 $\\mathrm{bar}$ 为单位时，其单位为 $\\mathrm{bar^{-1}}$。\n\n从动态平衡原理 $r_{\\mathrm{ads}} = r_{\\mathrm{des}}$ 和位点守恒关系出发，推导分数覆盖率 $\\theta$ 作为 $p$ 和 $K$ 的函数的表达式。然后，使用 $K = 0.2\\,\\mathrm{bar^{-1}}$，计算在 $p = 0.1\\,\\mathrm{bar}$、$p = 1\\,\\mathrm{bar}$ 和 $p = 10\\,\\mathrm{bar}$ 时的 $\\theta$。同时，确定由 $\\theta(p_{1/2}) = \\tfrac{1}{2}$ 定义的半覆盖压力 $p_{1/2}$。\n\n根据你推导的表达式和计算出的数值，评论当 $p$ 增加时的饱和行为。将你的最终数值结果以元组 $\\big(\\theta(0.1\\,\\mathrm{bar}),\\,\\theta(1\\,\\mathrm{bar}),\\,\\theta(10\\,\\mathrm{bar}),\\,p_{1/2}\\big)$ 的形式报告。如果可能，将 $\\theta$ 值表示为精确分数；如果选择小数，则四舍五入到四位有效数字。将 $p_{1/2}$ 以 $\\mathrm{bar}$ 为单位表示。",
            "solution": "将通过首先提取所有给定信息，然后根据科学合理性和良态性标准进行检查来验证问题。\n\n**步骤1：提取的已知条件**\n- 吸附物：$A$（气相）在催化表面上。\n- 表面性质：大量相同的、无相互作用的位点。\n- 假设：单层吸附、横向相互作用可忽略、理想气体行为。\n- 条件：等温（恒定温度 $T$）和等压（恒定压力 $p$）。\n- 分数表面覆盖率：$\\theta$。\n- 空位点分数：$\\theta_{\\mathrm{vac}}$。\n- 位点守恒：$\\theta + \\theta_{\\mathrm{vac}} = 1$。\n- 吸附速率：$r_{\\mathrm{ads}} = k_{\\mathrm{ads}}\\,p\\,(1-\\theta)$。\n- 解吸速率：$r_{\\mathrm{des}} = k_{\\mathrm{des}}\\,\\theta$。\n- 速率系数：$k_{\\mathrm{ads}}$, $k_{\\mathrm{des}}$。\n- 吸附平衡常数：$K \\equiv k_{\\mathrm{ads}}/k_{\\mathrm{des}}$，单位为 $\\mathrm{bar^{-1}}$。\n- 平衡条件：$r_{\\mathrm{ads}} = r_{\\mathrm{des}}$。\n- 平衡常数的数值：$K = 0.2\\,\\mathrm{bar^{-1}}$。\n- 用于计算的压力：$p = 0.1\\,\\mathrm{bar}$、$p = 1\\,\\mathrm{bar}$ 和 $p = 10\\,\\mathrm{bar}$。\n- 半覆盖压力定义：$\\theta(p_{1/2}) = \\tfrac{1}{2}$。\n- 要求输出：$\\theta(p, K)$ 的表达式、其在给定压力下的数值、 $p_{1/2}$ 的值、关于饱和行为的评论以及最终结果的元组。\n\n**步骤2：已知条件的验证**\n该问题具有科学依据。它描述了 Langmuir 吸附模型，这是表面科学和多相催化的基石。吸附和解吸的速率表达式基于质量作用定律，这是化学动力学的基本原理。吸附速率与吸附物 $p$ 的分压和可用空位点的分数 $(1-\\theta)$ 成正比，而解吸速率与被占据位点的分数 $\\theta$ 成正比。所有假设（单层吸附、相同位点、无横向相互作用）都是基本 Langmuir 模型的标准理想化。该问题是良态的，提供了推导所需量所需的所有定义、关系和数值。设置是内部一致且客观的。未发现任何缺陷。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**吸附等温线的推导**\n推导始于动态平衡原理，即吸附速率等于解吸速率。\n$$\nr_{\\mathrm{ads}} = r_{\\mathrm{des}}\n$$\n代入给定的速率表达式：\n$$\nk_{\\mathrm{ads}}\\,p\\,(1-\\theta) = k_{\\mathrm{des}}\\,\\theta\n$$\n我们的目标是解此方程以求得分数覆盖率 $\\theta$。我们展开左侧：\n$$\nk_{\\mathrm{ads}}\\,p - k_{\\mathrm{ads}}\\,p\\,\\theta = k_{\\mathrm{des}}\\,\\theta\n$$\n接下来，我们重新整理方程，将所有含 $\\theta$ 的项归到一边：\n$$\nk_{\\mathrm{ads}}\\,p = k_{\\mathrm{des}}\\,\\theta + k_{\\mathrm{ads}}\\,p\\,\\theta\n$$\n从右侧提出公因子 $\\theta$：\n$$\nk_{\\mathrm{ads}}\\,p = \\theta (k_{\\mathrm{des}} + k_{\\mathrm{ads}}\\,p)\n$$\n分离出 $\\theta$ 可得：\n$$\n\\theta = \\frac{k_{\\mathrm{ads}}\\,p}{k_{\\mathrm{des}} + k_{\\mathrm{ads}}\\,p}\n$$\n为了用平衡常数 $K \\equiv k_{\\mathrm{ads}}/k_{\\mathrm{des}}$ 来表示，我们将分子和分母同时除以解吸速率系数 $k_{\\mathrm{des}}$：\n$$\n\\theta = \\frac{\\frac{k_{\\mathrm{ads}}}{k_{\\mathrm{des}}}\\,p}{\\frac{k_{\\mathrm{des}}}{k_{\\mathrm{des}}} + \\frac{k_{\\mathrm{ads}}}{k_{\\mathrm{des}}}\\,p}\n$$\n将 $k_{\\mathrm{ads}}/k_{\\mathrm{des}}$ 替换为 $K$ 并简化，我们得到 Langmuir 吸附等温线：\n$$\n\\theta(p, K) = \\frac{K\\,p}{1 + K\\,p}\n$$\n\n**分数覆盖率 $\\theta$ 的计算**\n给定 $K = 0.2\\,\\mathrm{bar^{-1}}$。我们现在计算在指定压力下的 $\\theta$。\n\n1.  当 $p = 0.1\\,\\mathrm{bar}$ 时：\n    $$\n    \\theta(0.1) = \\frac{(0.2)(0.1)}{1 + (0.2)(0.1)} = \\frac{0.02}{1 + 0.02} = \\frac{0.02}{1.02} = \\frac{2}{102} = \\frac{1}{51}\n    $$\n2.  当 $p = 1\\,\\mathrm{bar}$ 时：\n    $$\n    \\theta(1) = \\frac{(0.2)(1)}{1 + (0.2)(1)} = \\frac{0.2}{1 + 0.2} = \\frac{0.2}{1.2} = \\frac{2}{12} = \\frac{1}{6}\n    $$\n3.  当 $p = 10\\,\\mathrm{bar}$ 时：\n    $$\n    \\theta(10) = \\frac{(0.2)(10)}{1 + (0.2)(10)} = \\frac{2}{1 + 2} = \\frac{2}{3}\n    $$\n\n**半覆盖压力 $p_{1/2}$ 的确定**\n半覆盖压力 $p_{1/2}$ 定义为 $\\theta = \\frac{1}{2}$ 时的压力。我们使用推导出的等温线表达式：\n$$\n\\frac{1}{2} = \\frac{K\\,p_{1/2}}{1 + K\\,p_{1/2}}\n$$\n两边同乘以 $2(1 + K\\,p_{1/2})$ 得：\n$$\n1 + K\\,p_{1/2} = 2\\,K\\,p_{1/2}\n$$\n两边同减去 $K\\,p_{1/2}$ 得：\n$$\n1 = K\\,p_{1/2}\n$$\n求解 $p_{1/2}$ 可得一个通用关系：\n$$\np_{1/2} = \\frac{1}{K}\n$$\n使用给定值 $K = 0.2\\,\\mathrm{bar^{-1}}$：\n$$\np_{1/2} = \\frac{1}{0.2\\,\\mathrm{bar^{-1}}} = 5\\,\\mathrm{bar}\n$$\n\n**关于饱和行为的评论**\n分数覆盖率的推导表达式为 $\\theta = \\frac{K\\,p}{1 + K\\,p}$。为分析压力 $p$ 增加时的行为，我们考察当 $p \\rightarrow \\infty$ 时 $\\theta$ 的极限：\n$$\n\\lim_{p \\to \\infty} \\theta(p) = \\lim_{p \\to \\infty} \\frac{K\\,p}{1 + K\\,p}\n$$\n分子分母同除以 $p$：\n$$\n\\lim_{p \\to \\infty} \\frac{K}{\\frac{1}{p} + K} = \\frac{K}{0 + K} = 1\n$$\n该极限表明，当压力变得非常大时，分数覆盖率 $\\theta$ 趋近于 $1$。这对应于饱和状态，即表面上几乎所有可用的吸附位点都被占据。计算所得的数值与此行为一致：当 $p$ 从 $0.1\\,\\mathrm{bar}$ 增加到 $1\\,\\mathrm{bar}$ 再到 $10\\,\\mathrm{bar}$ 时，$\\theta$ 从 $\\frac{1}{51}$（约 $0.0196$）增加到 $\\frac{1}{6}$（约 $0.167$）再到 $\\frac{2}{3}$（约 $0.667$），逐渐趋近饱和。\n\n元组 $\\big(\\theta(0.1\\,\\mathrm{bar}),\\,\\theta(1\\,\\mathrm{bar}),\\,\\theta(10\\,\\mathrm{bar}),\\,p_{1/2}\\big)$ 的最终数值结果是 $(\\frac{1}{51}, \\frac{1}{6}, \\frac{2}{3}, 5\\,\\mathrm{bar})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{51}  \\frac{1}{6}  \\frac{2}{3}  5 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "经典的朗缪尔模型假设被吸附的分子之间没有相互作用，但这在许多实际体系中并不成立。本练习将引导您超越这一理想假设，引入平均场近似来描述相邻吸附物之间的横向相互作用，从而推导出弗鲁姆金-福勒-古根海姆（Frumkin-Fowler-Guggenheim）等温线。通过这个实践，您将学会如何建立一个更符合物理实际的模型，并掌握使用数值方法求解非线性方程以确定表面覆盖率的技能 。",
            "id": "3867892",
            "problem": "考虑一种处于热平衡状态的理想气体，吸附在一个由催化位点组成的刚性、均匀的晶格上。每个位点既可以空置，也可以被单个吸附物占据。假设相邻位点上吸附物之间的横向相互作用采用平均场近似，并设每个吸附物的均相横向相互作用能为 $w$（负值对应于净吸引相互作用，正值对应于净排斥相互作用）。平衡表面覆盖度定义为分数占据率 $0  \\theta  1$。\n\n使用以下基本依据，推导一个在平衡状态下必须满足的、关于 $\\,\\theta\\,$ 的标量非线性方程：\n\n- 平衡时的化学势相等：$\\,\\mu_{\\mathrm{ads}}(\\theta, T) = \\mu_{\\mathrm{gas}}(p, T)\\,$。\n- 理想气体化学势：$\\,\\mu_{\\mathrm{gas}}(p,T) = \\mu_{\\mathrm{gas}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\\,$，其中 $R$ 是普适气体常数，$p^{0}$ 是参考压力。\n- 由构型熵项和横向相互作用项组成的平均场晶格吸附物化学势：$\\,\\mu_{\\mathrm{ads}}(\\theta,T) = \\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta\\,$。\n\n通过标准态关系 $\\,K \\equiv \\dfrac{1}{p^{0}} \\exp\\!\\left(\\dfrac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T}\\right)\\,$ 定义平衡常数 $K$（单位为压力的倒数），使得推导出的方程包含模型参数 $K$、$w$、$T$、$p$ 和标量未知数 $ \\theta $。您不能使用任何预先记下的吸附等温线；相反，必须从所述的基本依据出发推导关于 $ \\theta $ 的方程。\n\n然后，编写一个程序，对下面测试套件中的每一组参数，数值求解推导出的关于 $ \\theta $ 的标量非线性方程。每个解 $ \\theta $ 必须作为开区间 $\\,\\left(0,1\\right)\\,$ 内的实数返回，并表示为四舍五入到六位小数的小数。使用 $\\,R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$，并在计算前将 $\\,w\\,$ 的单位从 $\\mathrm{kJ\\,mol^{-1}}$ 转换为 $\\mathrm{J\\,mol^{-1}}$。所有压力 $\\,p\\,$ 的单位是 $\\mathrm{bar}$，温度 $\\,T\\,$ 的单位是 $\\mathrm{K}$，$\\,K\\,$ 的单位是 $\\mathrm{bar^{-1}}$。计算出的覆盖度 $ \\theta $ 是无量纲的。\n\n测试套件（每个元组为 $(K, w, T, p)$）：\n- 情况 A（正常路径，协同吸附）：$\\,(0.5, -2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$。\n- 情况 B（边界，极低压力）：$\\,(0.5, -2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 10^{-8}\\,\\mathrm{bar})\\,$。\n- 情况 C（中性相互作用，简化为无横向相互作用极限）：$\\,(0.5, 0\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$。\n- 情况 D（排斥相互作用）：$\\,(0.5, +2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$。\n- 情况 E（更强的吸引作用）：$\\,(0.5, -4\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 1\\,\\mathrm{bar})\\,$。\n- 情况 F（高压，协同吸附）：$\\,(0.5, -2\\,\\mathrm{kJ\\,mol^{-1}}, 400\\,\\mathrm{K}, 20\\,\\mathrm{bar})\\,$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$\\,[\\theta_{A},\\theta_{B},\\theta_{C},\\theta_{D},\\theta_{E},\\theta_{F}]$）。每个条目必须四舍五入到六位小数，并按照情况 A 到 F 的顺序排列。",
            "solution": "问题陈述具有科学依据、提法明确，并包含了推导控制方程和针对指定测试用例进行数值求解所需的所有信息。因此，该问题被认为是有效的。\n\n求解过程包括两个主要步骤：首先，从提供的基本原理推导平衡表面覆盖度 $\\theta$ 的标量非线性方程；其次，实现一个数值程序来对每组参数求解该方程。\n\n**步骤 1：平衡方程的推导**\n\n气相和吸附相之间热力学平衡的条件是它们的化学势相等。\n$$\n\\mu_{\\mathrm{ads}}(\\theta, T) = \\mu_{\\mathrm{gas}}(p, T)\n$$\n\n问题给出了气相化学势 $\\mu_{\\mathrm{gas}}$ 和吸附层化学势 $\\mu_{\\mathrm{ads}}$ 的表达式：\n$$\n\\mu_{\\mathrm{gas}}(p,T) = \\mu_{\\mathrm{gas}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n$$\n\\mu_{\\mathrm{ads}}(\\theta,T) = \\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta\n$$\n在这里，$\\theta$ 是分数表面覆盖度，$T$ 是温度，$p$ 是压力，$R$ 是普适气体常数，$w$ 是平均场横向相互作用能，$\\mu_{\\mathrm{gas}}^{0}(T)$ 和 $\\mu_{\\mathrm{ads}}^{0}(T)$ 分别是气体和吸附物的标准态化学势，$p^0$ 是参考压力。\n\n令两个化学势表达式相等：\n$$\n\\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta = \\mu_{\\mathrm{gas}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\n为分离出含 $\\theta$ 的项，我们重排该方程：\n$$\nR T \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + w\\,\\theta = \\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T) + R T \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\n接下来，我们将整个方程除以 $R T$：\n$$\n\\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} = \\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T} + \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\n问题将平衡常数 $K$ 定义为：\n$$\nK \\equiv \\dfrac{1}{p^{0}} \\exp\\!\\left(\\dfrac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T}\\right)\n$$\n对这个定义式取自然对数，得到：\n$$\n\\ln(K) = \\ln\\left(\\frac{1}{p^0}\\right) + \\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T} = -\\ln(p^0) + \\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T}\n$$\n由此，我们可以将标准态化学势差项表示为：\n$$\n\\frac{\\mu_{\\mathrm{gas}}^{0}(T) - \\mu_{\\mathrm{ads}}^{0}(T)}{R T} = \\ln(K) + \\ln(p^0) = \\ln(K p^0)\n$$\n\n将此代回我们重排后的平衡方程：\n$$\n\\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} = \\ln(K p^0) + \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right)\n$$\n\n使用对数性质 $\\ln(a) + \\ln(b) = \\ln(ab)$，右侧简化为：\n$$\n\\ln(K p^0) + \\ln\\!\\left(\\dfrac{p}{p^{0}}\\right) = \\ln\\left(K p^0 \\cdot \\frac{p}{p^0}\\right) = \\ln(K p)\n$$\n\n这就得到了关于 $\\theta$ 的隐式方程的最终形式，即 Frumkin-Fowler-Guggenheim 等温线方程：\n$$\n\\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} = \\ln(K p)\n$$\n这就是必须求解 $\\theta$ 的标量非线性方程。为了数值求解，我们将其表述为一个求根问题。我们定义一个函数 $f(\\theta)$，使得我们寻求 $f(\\theta) = 0$ 的根：\n$$\nf(\\theta) = \\ln\\!\\left(\\dfrac{\\theta}{1-\\theta}\\right) + \\frac{w\\,\\theta}{R T} - \\ln(K p) = 0\n$$\n\n**步骤 2：数值求解策略**\n\n未知数 $\\theta$ 在物理上被限制在开区间 $(0, 1)$ 内。我们需要在此区间内找到函数 $f(\\theta)$ 的根。\n我们来分析一下 $f(\\theta)$ 在其定义域边界上的行为：\n- 当 $\\theta \\to 0^+$ 时，项 $ \\ln\\left(\\frac{\\theta}{1-\\theta}\\right) \\to -\\infty$，所以 $f(\\theta) \\to -\\infty$。\n- 当 $\\theta \\to 1^-$ 时，项 $ \\ln\\left(\\frac{\\theta}{1-\\theta}\\right) \\to +\\infty$，所以 $f(\\theta) \\to +\\infty$。\n\n由于函数 $f(\\theta)$ 在 $(0, 1)$ 上连续，且从 $-\\infty$ 变化到 $+\\infty$，根据介值定理，可以保证在此区间内至少存在一个根。对于给定的参数范围，该函数也是单调的，确保了根的唯一性。\n\n解决此问题的一个合适的数值方法是区间求根算法，例如 Brent-Dekker 方法（在 `scipy.optimize` 中为 `brentq`）。这种方法很稳健，因为它需要找到一个区间 $[a, b]$，使得 $f(a)$ 和 $f(b)$ 异号。考虑到 $f(\\theta)$ 的边界行为，我们可以选择 $a$ 为一个很小的正数（例如 $10^{-12}$），$b$ 为一个略小于 $1$ 的数（例如 $1 - 10^{-12}$），这将可靠地将根置于区间内。\n\n实现过程将遍历每个测试用例，用特定的参数 $(K, w, T, p)$ 定义函数 $f(\\theta)$，并使用 `scipy.optimize.brentq` 来找到唯一的根 $\\theta \\in (0, 1)$。相互作用能 $w$ 必须通过乘以 $1000$ 从 $\\mathrm{kJ\\,mol^{-1}}$ 转换为 $\\mathrm{J\\,mol^{-1}}$。然后，每个情况计算出的 $\\theta$ 值将被四舍五入到六位小数，作为最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Derives and solves the Frumkin-Fowler-Guggenheim adsorption isotherm equation\n    for several test cases.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.31446261815324\n\n    # Test suite: each tuple is (K [bar^-1], w [kJ mol^-1], T [K], p [bar])\n    test_cases = [\n        # Case A (happy path, cooperative adsorption)\n        (0.5, -2.0, 400.0, 1.0),\n        # Case B (boundary, very low pressure)\n        (0.5, -2.0, 400.0, 1e-8),\n        # Case C (neutral interactions, Langmuir isotherm)\n        (0.5, 0.0, 400.0, 1.0),\n        # Case D (repulsive interactions)\n        (0.5, 2.0, 400.0, 1.0),\n        # Case E (stronger attraction)\n        (0.5, -4.0, 400.0, 1.0),\n        # Case F (high pressure, cooperative adsorption)\n        (0.5, -2.0, 400.0, 20.0),\n    ]\n\n    results = []\n    \n    # Define search interval for theta, which must be in (0, 1)\n    # The interval is chosen to be slightly smaller than (0, 1) to avoid\n    # numerical issues with log(0) or division by zero at the boundaries.\n    lower_bound = 1e-15\n    upper_bound = 1.0 - 1e-15\n\n    for K, w_kJ_mol, T, p in test_cases:\n        # Convert w from kJ/mol to J/mol\n        w = w_kJ_mol * 1000.0\n\n        # The nonlinear equation to solve is f(theta) = 0, where:\n        # f(theta) = ln(theta / (1-theta)) + w*theta/(R*T) - ln(K*p)\n        # We need to find the root theta in the interval (0, 1).\n\n        # Pre-calculate constant terms for efficiency.\n        # Check for non-positive p or K is good practice, though not needed here.\n        if K == 0 or p == 0:\n            # Physical parameters K and p must be positive.\n            # Handle this as an error or an edge case if necessary.\n            # For this problem, all inputs are valid.\n            # For p -> 0+, K*p -> 0+, log(K*p) -> -inf.\n            # The equation is ln(theta/(1-theta)) + w*theta/(R*T) = -inf,\n            # which implies theta must be extremely close to 0.\n            log_Kp = -np.inf \n        else:\n            log_Kp = np.log(K * p)\n\n        def f(theta):\n            \"\"\"\n            The root-finding function f(theta) = 0. This function captures\n            the parameters K, w, T, p from the outer scope.\n            \"\"\"\n            # The term np.log(theta / (1.0 - theta)) is the core of the configurational entropy.\n            # The term (w * theta) / (R * T) is the mean-field interaction energy contribution.\n            # The term log_Kp contains the pressure and standard state information.\n            return np.log(theta / (1.0 - theta)) + (w * theta) / (R * T) - log_Kp\n\n        # Use brentq to find the root. It requires the function to have\n        # opposite signs at the interval endpoints.\n        # As theta -> 0+, f(theta) -> -inf.\n        # As theta -> 1-, f(theta) -> +inf.\n        # Thus, our interval [lower_bound, upper_bound] is guaranteed to bracket the root.\n        theta_solution = brentq(f, lower_bound, upper_bound)\n        \n        # Append the formatted result to the list\n        results.append(f\"{theta_solution:.6f}\")\n\n    # Print the final output in the required format: [res1,res2,...]\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solver\nsolve()\n```"
        },
        {
            "introduction": "理论模型的力量在于其能够与实验数据相结合，揭示潜在的物理化学性质。吸附过程的平衡常数强烈依赖于温度，本练习将向您展示如何利用范特霍夫（van 't Hoff）方程来分析这一依赖关系。通过对一系列温度下的平衡常数数据进行线性回归，您将能够提取出吸附焓（$\\Delta H_{\\mathrm{ads}}$）和吸附熵（$\\Delta S_{\\mathrm{ads}}$）等关键热力学参数，从而量化驱动吸附过程的能量因素 。",
            "id": "3867925",
            "problem": "给定三个温度下的吸附平衡常数，要求您根据第一性原理和数据拟合来确定吸附焓和吸附熵。考虑在低覆盖度下，刚性均匀表面上发生的非解离性单分子吸附过程，该条件下横向相互作用可忽略不计。在化学平衡时，根据热力学定义，吸附的标准吉布斯自由能变（记为 $\\Delta G^\\circ_{\\mathrm{ads}}$）与平衡常数 $K$ 相关。标准吉布斯自由能变也与标准吸附焓 $\\Delta H_{\\mathrm{ads}}$ 和标准吸附熵 $\\Delta S_{\\mathrm{ads}}$ 相关。利用这些事实，论证 $\\ln K$ 对 $1/T$ 的函数依赖关系，并通过统计上可靠的线性拟合来提取 $\\Delta H_{\\mathrm{ads}}$ 和 $\\Delta S_{\\mathrm{ads}}$。\n\n实现一个程序，该程序：\n- 使用自然对数计算 $\\ln$。\n- 对 $y$ 与 $x$（其中 $y = \\ln K$，$x = 1/T$）执行普通最小二乘 (OLS) 线性回归，以获得斜率和截距。然后，根据热力学恒等式推导出 $\\Delta H_{\\mathrm{ads}}$ 和 $\\Delta S_{\\mathrm{ads}}$。\n- 使用普适气体常数 (UGC) $R$，单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，其值为 $R = 8.314462618$。\n\n物理单位和输出要求：\n- 温度必须以 $\\mathrm{K}$ 为单位处理。\n- 平衡常数 $K$ 是无量纲的。\n- 以浮点数形式报告 $\\Delta H_{\\mathrm{ads}}$（单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$）和 $\\Delta S_{\\mathrm{ads}}$（单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$）。\n- 不涉及角度。\n- 您的程序应生成单行输出，其中包含一个列表的列表形式的结果，每个内部列表包含两个浮点数，顺序为 $[\\Delta H_{\\mathrm{ads}}, \\Delta S_{\\mathrm{ads}}]$，并且整个结果用方括号括起来，不含空格，例如：$[[h_1,s_1],[h_2,s_2],[h_3,s_3]]$。\n\n测试套件：\n使用以下四个案例。在每个案例中，给定温度集为 $[350,400,450]\\,\\mathrm{K}$ 以及相应的平衡常数 $K(T)$。所有 $K$ 值均为无量纲。\n1. 案例 A（中等放热吸附，中等熵损失）：温度为 $[350,400,450]$，对应的 $K$ 值为 $[173.0,20.16,3.83]$。\n2. 案例 B（强放热吸附，较大熵损失）：温度为 $[350,400,450]$，对应的 $K$ 值为 $[13300.0,412.0,28.3]$。\n3. 案例 C（接近零的焓变，小熵损失）：温度为 $[350,400,450]$，对应的 $K$ 值为 $[0.772,0.741,0.715]$。\n4. 案例 D（带有轻微测量噪声的中等放热吸附）：温度为 $[350,400,450]$，对应的 $K$ 值为 $[2.04,0.540,0.213]$。\n\nOLS 的算法规范：\n给定数据点 $(x_i,y_i)$，其中 $x_i = 1/T_i$，$y_i = \\ln K(T_i)$，通过 OLS 计算斜率 $m$ 和截距 $b$。然后从具有物理依据的关系式中推断出 $\\Delta H_{\\mathrm{ads}}$ 和 $\\Delta S_{\\mathrm{ads}}$。\n\n最终输出格式：\n- 生成单行输出，该行是一个由方括号括起来的逗号分隔列表，其中包含恰好四个内部列表，每个内部列表的形式为 $[\\Delta H_{\\mathrm{ads}},\\Delta S_{\\mathrm{ads}}]$，且字符串中不含任何空格。例如：$[[h_A,s_A],[h_B,s_B],[h_C,s_C],[h_D,s_D]]$。",
            "solution": "该问题是有效的，因为它在科学上基于化学热力学原理，提法恰当，并为获得唯一解提供了所有必要信息。任务是从不同温度 $T$ 下的平衡常数 $K$ 的实验数据中确定标准吸附焓 $\\Delta H_{\\mathrm{ads}}$ 和标准吸附熵 $\\Delta S_{\\mathrm{ads}}$。这将通过利用描述平衡常数温度依赖性的 van 't Hoff 方程来实现。其推导和应用如下。\n\n分析始于两个基本的热力学关系。首先，吸附的标准吉布斯自由能变 $\\Delta G^\\circ_{\\mathrm{ads}}$ 是用标准焓变和熵变来定义的：\n\n$$\n\\Delta G^\\circ_{\\mathrm{ads}} = \\Delta H_{\\mathrm{ads}} - T\\Delta S_{\\mathrm{ads}}\n$$\n\n此处，假设 $\\Delta H_{\\mathrm{ads}}$ 和 $\\Delta S_{\\mathrm{ads}}$ 在所研究的温度范围内是常数，这对于许多体系在有限范围内是一个常见且合理的近似。\n\n其次，对于一个处于化学平衡的过程，标准吉布斯自由能变通过以下方程与热力学平衡常数 $K$ 相关：\n\n$$\n\\Delta G^\\circ_{\\mathrm{ads}} = -RT \\ln K\n$$\n\n其中 $R$ 是普适气体常数，$T$ 是以开尔文为单位的绝对温度。问题指明 $K$ 是无量纲的，这与其在对数函数中的使用是一致的。\n\n通过令这两个 $\\Delta G^\\circ_{\\mathrm{ads}}$ 的表达式相等，我们建立了平衡常数和热力学状态函数之间的直接联系：\n\n$$\n-RT \\ln K = \\Delta H_{\\mathrm{ads}} - T\\Delta S_{\\mathrm{ads}}\n$$\n\n为了论证问题中要求的线性关系，我们重新排列此方程，将 $\\ln K$ 表示为 $T$ 的函数：\n\n$$\n\\ln K = -\\frac{\\Delta H_{\\mathrm{ads}}}{RT} + \\frac{T\\Delta S_{\\mathrm{ads}}}{RT}\n$$\n\n$$\n\\ln K = \\left(-\\frac{\\Delta H_{\\mathrm{ads}}}{R}\\right) \\frac{1}{T} + \\frac{\\Delta S_{\\mathrm{ads}}}{R}\n$$\n\n这个方程是 van 't Hoff 方程的一种形式。现在很明显，该方程具有直线形式 $y = mx + b$，其中：\n- 因变量为 $y = \\ln K$。\n- 自变量为 $x = 1/T$。\n- 直线的斜率为 $m = -\\frac{\\Delta H_{\\mathrm{ads}}}{R}$。\n- y轴截距为 $b = \\frac{\\Delta S_{\\mathrm{ads}}}{R}$。\n\n这种线性形式验证了问题提出的方法：对 $\\ln K$ 对 $1/T$ 的图进行普通最小二乘 (OLS) 线性回归，以求得斜率 $m$ 和截距 $b$。\n\n一旦对实验数据点 $(x_i, y_i) = (1/T_i, \\ln K_i)$ 执行 OLS 回归，我们就能得到斜率 $m$ 和截距 $b$ 的最佳拟合值。由此，我们可以通过代数方法解出所需的热力学量：\n\n$$\n\\Delta H_{\\mathrm{ads}} = -mR\n$$\n\n$$\n\\Delta S_{\\mathrm{ads}} = bR\n$$\n\n每个测试案例的算法步骤如下：\n1.  给定一组温度 $T_i$ 和相应的平衡常数 $K_i$。普适气体常数的值为 $R = 8.314462618 \\, \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n2.  将数据转换为线性变量：$x_i = 1/T_i$ 和 $y_i = \\ln K_i$。\n3.  对 $(x_i, y_i)$ 数据点执行 OLS 线性回归，以计算斜率 $m$ 和截距 $b$。对于一组 $N$ 个数据点 $(x_i, y_i)$，计算 OLS 系数以最小化残差平方和。对于线性模型 $y = mx+b$，斜率 $m$ 和截距 $b$ 由以下公式给出：\n    $$m = \\frac{N \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{N \\sum(x_i^2) - (\\sum x_i)^2}$$\n    $$b = \\bar{y} - m\\bar{x} = \\frac{\\sum y_i - m \\sum x_i}{N}$$\n    其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是 $x$ 和 $y$ 值的平均值。\n4.  使用推导出的斜率和截距计算标准吸附焓 $\\Delta H_{\\mathrm{ads}}$（单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$）和标准吸附熵 $\\Delta S_{\\mathrm{ads}}$（单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$）。\n5.  按规定格式报告每个案例的结果 $[\\Delta H_{\\mathrm{ads}}, \\Delta S_{\\mathrm{ads}}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the adsorption enthalpy and entropy from equilibrium constants at various temperatures\n    using the van 't Hoff equation and Ordinary Least Squares (OLS) linear regression.\n    \"\"\"\n    \n    # Universal Gas Constant in J mol^-1 K^-1\n    R = 8.314462618\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing a list of temperatures (K) and a list of equilibrium constants (dimensionless).\n    test_cases = [\n        # Case A\n        ([350, 400, 450], [173.0, 20.16, 3.83]),\n        # Case B\n        ([350, 400, 450], [13300.0, 412.0, 28.3]),\n        # Case C\n        ([350, 400, 450], [0.772, 0.741, 0.715]),\n        # Case D\n        ([350, 400, 450], [2.04, 0.540, 0.213]),\n    ]\n    \n    results = []\n    \n    for temps, ks in test_cases:\n        # Convert lists to NumPy arrays for vectorized operations.\n        # Use np.float64 for precision.\n        T = np.array(temps, dtype=np.float64)\n        K = np.array(ks, dtype=np.float64)\n\n        # The van 't Hoff equation is ln(K) = -ΔH/R * (1/T) + ΔS/R.\n        # This is a linear equation of the form y = mx + b.\n        # y = ln(K)\n        # x = 1/T\n        # m (slope) = -ΔH/R\n        # b (intercept) = ΔS/R\n        \n        # Prepare the variables for linear regression.\n        x = 1.0 / T\n        y = np.log(K)\n\n        # Perform OLS linear regression using NumPy's polyfit for a degree 1 polynomial.\n        # This returns the coefficients [slope, intercept].\n        slope, intercept = np.polyfit(x, y, 1)\n\n        # Calculate the thermodynamic quantities from the slope and intercept.\n        # From m = -ΔH/R => ΔH = -m * R\n        # From b = ΔS/R  => ΔS = b * R\n        delta_H_ads = -slope * R\n        delta_S_ads = intercept * R\n        \n        # Append the calculated values to the results list.\n        results.append([delta_H_ads, delta_S_ads])\n        \n    # Format the final output string as a list of lists with no spaces, as specified.\n    inner_strings = [f\"[{h},{s}]\" for h, s in results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}