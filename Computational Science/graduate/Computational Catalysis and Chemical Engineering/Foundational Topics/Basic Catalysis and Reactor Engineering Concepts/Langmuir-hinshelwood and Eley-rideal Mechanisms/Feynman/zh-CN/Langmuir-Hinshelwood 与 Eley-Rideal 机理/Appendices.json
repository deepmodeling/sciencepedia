{
    "hands_on_practices": [
        {
            "introduction": "从一系列提出的基元步骤中推导速率方程是化学动力学研究的基石。本练习  将指导你完成一个经典的双分子Langmuir-Hinshelwood机理的推导过程，从质量作用定律和表面活性位守恒等第一性原理出发。通过计算转换频率（TOF），你将定量地理解反应物压力和吸附强度如何共同决定催化剂的本征活性。",
            "id": "2669659",
            "problem": "一个双分子表面反应在均匀的催化剂表面上遵循 Langmuir-Hinshelwood (LH) 机理进行。在温度 $T$ 下，发生以下基元步骤：\n\n- 气相吸附平衡：\n  - $A(\\text{g}) + * \\rightleftharpoons A*$，吸附平衡常数为 $K_A$。\n  - $B(\\text{g}) + * \\rightleftharpoons B*$，吸附平衡常数为 $K_B$。\n- 表面反应（速率决定步骤）：$A* + B* \\rightarrow \\text{产物} + 2*$，速率常数为 $k$。\n\n假设气体为理想气体，吸附平衡为准平衡，吸附位点均匀且无相互作用，并且满足位点守恒条件。单位几何面积上的总活性位点密度为 $S_{\\text{tot}}$。给定在 $T = 550\\,\\text{K}$ 时的以下数值：\n- $k = 8.00\\,\\text{s}^{-1}$，\n- $K_A = 3.00 \\times 10^{-5}\\,\\text{Pa}^{-1}$，\n- $K_B = 1.20 \\times 10^{-4}\\,\\text{Pa}^{-1}$，\n- $P_A = 2.50 \\times 10^{4}\\,\\text{Pa}$，\n- $P_B = 1.50 \\times 10^{4}\\,\\text{Pa}$，\n- $S_{\\text{tot}} = 1.80 \\times 10^{-5}\\,\\text{mol}\\,\\text{m}^{-2}$。\n\n从多相催化动力学的第一性原理（基元步骤的质量作用定律、吸附准平衡关系和位点守恒）出发，推导转换频率（TOF）的解析表达式。TOF 定义为每个活性位点的摩尔反应速率，并用 $k$、$K_A$、$K_B$、$P_A$、$P_B$ 和 $S_{\\text{tot}}$ 表示。然后使用上述数据对 TOF 进行数值计算。将最终数值答案四舍五入至四位有效数字，并以 $\\text{s}^{-1}$ 为单位表示。\n\n最后，明确说明所计算的 TOF 可被解释为催化剂本征属性的一组物理假设。",
            "solution": "该问题要求推导和计算一个通过 Langmuir-Hinshelwood (LH) 机理进行的双分子表面反应的转换频率 (TOF)。这将从第一性原理出发进行处理。\n\n首先，确认问题陈述的有效性。该问题描述了一个经典的 Langmuir-Hinshelwood 动力学模型，这是物理化学中一个标准且有科学依据的课题。所有必要的数据和定义都已提供，没有内部矛盾、事实错误或含糊之处。该问题是适定的且可解的。\n\n化学反应的速率由其最慢的、速率决定步骤 (RDS) 决定。在本例中，RDS 是吸附物种 $A*$ 和吸附物种 $B*$ 之间的表面反应：\n$$A* + B* \\xrightarrow{k} \\text{products} + 2*$$\n该基元步骤的速率与反应物 $A*$ 和 $B*$ 的表面浓度成正比。在表面动力学中，通常用表面覆盖度分数 $\\theta_A$ 和 $\\theta_B$ 来表示速率。每个活性位点的反应速率，即转换频率 (TOF) 的定义，由下式给出：\n$$ \\text{TOF} = k \\theta_A \\theta_B $$\n这里，速率常数 $k$ 的单位是频率（例如 $\\text{s}^{-1}$），与给定的值 $k = 8.00\\,\\text{s}^{-1}$ 一致。单位表面积的总摩尔反应速率 $r''$ 将是 $r'' = \\text{TOF} \\cdot S_{\\text{tot}} = k S_{\\text{tot}} \\theta_A \\theta_B$。问题要求的是 TOF，即每个位点的速率。\n\n覆盖度分数 $\\theta_A$ 和 $\\theta_B$ 由前面的吸附平衡决定，假设这些平衡是准平衡的。适用竞争性吸附的 Langmuir 模型。对于物种 $A$ 和 $B$ 在空位点 $*$ 上的吸附：\n$$ A(\\text{g}) + * \\rightleftharpoons A* $$\n$$ B(\\text{g}) + * \\rightleftharpoons B* $$\n相应的平衡关系为：\n$$ K_A = \\frac{[A*]}{[A(\\text{g})][*]} = \\frac{\\theta_A}{P_A \\theta_v} $$\n$$ K_B = \\frac{[B*]}{[B(\\text{g})][*]} = \\frac{\\theta_B}{P_B \\theta_v} $$\n其中 $\\theta_v$ 是空位点的分数，并假设理想气体行为，使用分压 $P_A$ 和 $P_B$ 表示气相浓度。从这些方程中，我们用空位点覆盖度来表示 $A$ 和 $B$ 的覆盖度：\n$$ \\theta_A = K_A P_A \\theta_v $$\n$$ \\theta_B = K_B P_B \\theta_v $$\n总位点数是守恒的。表面上所有物种（吸附的 $A$、吸附的 $B$ 和空位点）的覆盖度分数之和必须为 1：\n$$ \\theta_A + \\theta_B + \\theta_v = 1 $$\n将 $\\theta_A$ 和 $\\theta_B$ 的表达式代入位点守恒方程，可以解出 $\\theta_v$：\n$$ K_A P_A \\theta_v + K_B P_B \\theta_v + \\theta_v = 1 $$\n$$ \\theta_v (1 + K_A P_A + K_B P_B) = 1 $$\n$$ \\theta_v = \\frac{1}{1 + K_A P_A + K_B P_B} $$\n现在，我们将 $\\theta_v$ 的这个表达式代回 $\\theta_A$ 和 $\\theta_B$ 的方程中：\n$$ \\theta_A = \\frac{K_A P_A}{1 + K_A P_A + K_B P_B} $$\n$$ \\theta_B = \\frac{K_B P_B}{1 + K_A P_A + K_B P_B} $$\n最后，我们将这些覆盖度分数的表达式代入 TOF 的方程中。这就得出了用给定参数表示的 TOF 的最终解析表达式。该表达式不显式依赖于总位点密度 $S_{\\text{tot}}$，因为在 TOF 作为单位点速率的定义中，该参数被消去了。\n$$ \\text{TOF} = k \\theta_A \\theta_B = k \\left( \\frac{K_A P_A}{1 + K_A P_A + K_B P_B} \\right) \\left( \\frac{K_B P_B}{1 + K_A P_A + K_B P_B} \\right) $$\n$$ \\text{TOF} = \\frac{k K_A K_B P_A P_B}{(1 + K_A P_A + K_B P_B)^2} $$\n这就是所要求的解析表达式。\n\n接下来，我们使用所提供的数据对 TOF 进行数值计算：\n- $k = 8.00\\,\\text{s}^{-1}$\n- $K_A = 3.00 \\times 10^{-5}\\,\\text{Pa}^{-1}$\n- $K_B = 1.20 \\times 10^{-4}\\,\\text{Pa}^{-1}$\n- $P_A = 2.50 \\times 10^{4}\\,\\text{Pa}$\n- $P_B = 1.50 \\times 10^{4}\\,\\text{Pa}$\n\n首先，计算无量纲项 $K_A P_A$ 和 $K_B P_B$：\n$$ K_A P_A = (3.00 \\times 10^{-5}\\,\\text{Pa}^{-1}) \\times (2.50 \\times 10^{4}\\,\\text{Pa}) = 0.750 $$\n$$ K_B P_B = (1.20 \\times 10^{-4}\\,\\text{Pa}^{-1}) \\times (1.50 \\times 10^{4}\\,\\text{Pa}) = 1.80 $$\n现在，将这些值代入 TOF 表达式中：\n$$ \\text{TOF} = \\frac{(8.00\\,\\text{s}^{-1}) \\times (0.750) \\times (1.80)}{(1 + 0.750 + 1.80)^2} $$\n$$ \\text{TOF} = \\frac{10.8\\,\\text{s}^{-1}}{(3.55)^2} $$\n$$ \\text{TOF} = \\frac{10.8\\,\\text{s}^{-1}}{12.6025} \\approx 0.8569728246... \\,\\text{s}^{-1} $$\n按照指示将最终答案四舍五入到四位有效数字，得到：\n$$ \\text{TOF} \\approx 0.8570\\,\\text{s}^{-1} $$\n\n问题的最后一部分要求说明在何种物理假设下，计算出的 TOF 可以被解释为催化剂的*本征*属性。本征属性是指仅取决于催化剂材料性质和温度，而不取决于传输现象或反应器条件的属性。关键假设如下：\n\n1.  **朗缪尔表面模型的有效性**：催化表面在能量上是均匀的，即所有活性位点都是相同的。吸附的分子不表现出侧向相互作用，因此吸附热与覆盖度无关。吸附仅限于单分子层。\n2.  **动力学机理的正确性**：所提出的基元步骤序列（$A$ 和 $B$ 的竞争性吸附，表面反应作为唯一的 RDS，以及快速、不可逆的产物生成和解吸）准确地代表了真实的反应路径。\n3.  **不存在传输限制**：反应速率由表面化学反应的本征动力学控制，而不是由质量或热量传输的速率控制。这意味着：\n    a. 无**外传质限制**：反应物从主体气相到催化剂外表面的传输速率远快于反应速率。\n    b. 无**内传质限制**：如果催化剂是多孔的，反应物在孔内的扩散速率远快于反应速率。\n    c. 无**传热限制**：反应在等温条件下进行，反应产生或消耗的任何热量都能迅速散失，从而防止在催化剂颗粒或反应器床层上出现温度梯度。\n4.  **催化剂稳定性**：在整个测量过程中，催化剂的结构、组成和活性位点数量保持不变。\n\n如果满足这些条件，测得的速率就反映了活性位点上真实的化学动力学，计算出的 TOF 就代表了在指定温度和分压下催化活性的一个本征度量。",
            "answer": "$$\\boxed{0.8570}$$"
        },
        {
            "introduction": "虽然单点的速率计算能提供信息，但动力学模型的真正威力在于预测系统在各种条件下的行为。本计算练习  将探讨表观反应级数这一关键实验可观测量，并以一个单分子LH反应为例。通过模拟反应速率随压力的变化，你将用数值方法证明反应级数如何从一级过渡到零级，并将这一宏观行为与催化剂表面的微观状态——即反应物的覆盖度——直接联系起来。",
            "id": "3885038",
            "problem": "给定一个由 Langmuir-Hinshelwood (LH) 机理描述的催化反应体系，其中气相反应物 $A$ 在表面上可逆吸附，并进行单分子表面反应。基元过程为：吸附 $A(g) + * \\rightleftharpoons A*$ 和单分子表面反应 $A* \\rightarrow \\text{products} + *$。仅从以下基本依据出发：(i) 吸附和解吸的基元质量作用速率定律，(ii) 单一位点表面的位点平衡，以及 (iii) 表观反应级数的定义，即速率对压力的对数导数。\n\n使用这些依据，推导模拟速率所需的控制表达式。具体来说，使用以下原则，不引入任何简化公式：(a) 使用质量作用动力学编写基元吸附和解吸速率，(b) 对吸附-解吸施加准平衡，以压力表示表面覆盖度从而消去它，以及 (c) 将每个位点的宏观产物生成速率表示为单分子表面反应的速率。然后使用对数导数精确定义表观反应级数。不要假设任何已给出的速率或覆盖度的最终公式；相反，应仅从所述依据出发展示推导过程。\n\n然后，您必须实现一个程序，对每个测试用例执行以下操作：\n\n1. 构建一个在最小值 $P_{\\min}$ 和最大值 $P_{\\max}$ 之间的对数间隔压力 $P$ 网格，包含 $N$ 个点，压力单位为 bar。\n2. 使用吸附和解吸速率常数 $k_{\\text{ads}}$ 和 $k_{\\text{des}}$，计算由吸附和解吸的准平衡所隐含的表面覆盖度 $\\theta_A(P)$。\n3. 使用单分子表面反应速率常数 $k_{\\text{rxn}}$，计算每个位点的产物生成速率 $r(P)$ 作为 $P$ 的函数。给定输入常数，$r(P)$ 的单位必须是每个位点 $\\text{s}^{-1}$，与单位点频率一致。\n4. 根据定义 $n_{\\text{app}}(P) \\equiv \\dfrac{d \\ln r}{d \\ln P}$，通过对 $\\ln r$ 对 $\\ln P$ 的数据进行有限差分来计算表观反应级数 $n_{\\text{app}}(P)$。对内部网格点使用中心差分，在边界处使用单侧差分。\n5. 为每个测试用例报告以下四个量：\n   - $n_{\\text{low}}$：在 $P_{\\min}$ 处计算的表观级数（无量纲）。\n   - $n_{\\text{high}}$：在 $P_{\\max}$ 处计算的表观级数（无量纲）。\n   - $P^\\star$：当 $P$ 增加时，$n_{\\text{app}}(P)$ 从上到下穿过 $0.5$ 时的过渡压力（单位 bar）。如果穿越未在 $[P_{\\min}, P_{\\max}]$ 范围内发生（包括当 $n_{\\text{app}}(P_{\\min})  0.5$ 或 $n_{\\text{app}}(P_{\\max})  0.5$ 时），报告 $-1.0$。\n   - $\\theta^\\star$：过渡压力下的表面覆盖度（无量纲）。如果在该范围内没有过渡，报告 $-1.0$。\n   当 $n_{\\text{app}}$ 在相邻网格点之间变化时，使用在 $\\ln P$ 上的线性插值来估计 $P^\\star$。\n6. 您的程序应生成单行输出，包含一个列表的列表形式的结果，每个内部列表对应一个测试用例，其中的四个量按顺序为 $[n_{\\text{low}}, n_{\\text{high}}, P^\\star, \\theta^\\star]$。例如：$[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\dots]$。\n\n使用以下测试套件。每个测试定义了 $(k_{\\text{ads}}, k_{\\text{des}}, k_{\\text{rxn}}, P_{\\min}, P_{\\max}, N)$。\n\n- 测试 A（正常路径，过渡在范围内）：$k_{\\text{ads}} = 1.0\\,\\text{s}^{-1}\\,\\text{bar}^{-1}$，$k_{\\text{des}} = 1.0\\,\\text{s}^{-1}$，$k_{\\text{rxn}} = 10.0\\,\\text{s}^{-1}$，$P_{\\min} = 10^{-3}\\,\\text{bar}$，$P_{\\max} = 10^{3}\\,\\text{bar}$，$N = 200$。\n- 测试 B（强吸附，低压下过渡）：$k_{\\text{ads}} = 100.0\\,\\text{s}^{-1}\\,\\text{bar}^{-1}$，$k_{\\text{des}} = 1.0\\,\\text{s}^{-1}$，$k_{\\text{rxn}} = 5.0\\,\\text{s}^{-1}$，$P_{\\min} = 10^{-5}\\,\\text{bar}$，$P_{\\max} = 1.0\\,\\text{bar}$，$N = 200$。\n- 测试 C（弱吸附，范围内无过渡）：$k_{\\text{ads}} = 0.001\\,\\text{s}^{-1}\\,\\text{bar}^{-1}$，$k_{\\text{des}} = 1.0\\,\\text{s}^{-1}$，$k_{\\text{rxn}} = 1.0\\,\\text{s}^{-1}$，$P_{\\min} = 10^{-4}\\,\\text{bar}$，$P_{\\max} = 10.0\\,\\text{bar}$，$N = 200$。\n- 测试 D（在下边界过渡，粗网格）：$k_{\\text{ads}} = 10^{6}\\,\\text{s}^{-1}\\,\\text{bar}^{-1}$，$k_{\\text{des}} = 1.0\\,\\text{s}^{-1}$，$k_{\\text{rxn}} = 2.0\\,\\text{s}^{-1}$，$P_{\\min} = 10^{-6}\\,\\text{bar}$，$P_{\\max} = 1.0\\,\\text{bar}$，$N = 50$。\n\n所有报告的压力单位必须是 bar，过渡覆盖度必须是无量纲的。表观级数必须是无量纲的。您的程序必须是自包含的，不需要用户输入，并精确地打印一行包含嵌套列表的结果，其顺序与上述测试套件一致。",
            "solution": "该问题要求对遵循 Langmuir-Hinshelwood 机理的单分子催化反应进行严格的推导和随后的数值实现。推导必须源于基本原理，数值分析必须精确遵循指定的计算步骤。\n\n首先，我们应从所述依据出发推导控制方程。该反应体系涉及两个基元步骤：\n1. 气相物种 $A$ 在空表面位点 $*$ 上的可逆吸附：$A(g) + * \\underset{k_{\\text{des}}}{\\stackrel{k_{\\text{ads}}}{\\rightleftharpoons}} A*$\n2. 吸附物种 $A*$ 的不可逆单分子表面反应：$A* \\stackrel{k_{\\text{rxn}}}{\\longrightarrow} \\text{products} + *$\n\n设 $\\theta_A$ 为吸附物种 $A*$ 的分数表面覆盖度，$\\theta_v$ 为空位点 $*$ 的分数覆盖度。根据单一位点表面的位点平衡（依据 ii），分数覆盖度之和必须为1：\n$$ \\theta_A + \\theta_v = 1 \\implies \\theta_v = 1 - \\theta_A $$\n根据质量作用动力学原理（依据 i），我们可以写出基元吸附和解吸过程的速率。吸附速率 $r_{\\text{ads}}$ 与反应物 $A$ 的分压（表示为 $P$）以及可用空位点的分数 $\\theta_v$ 成正比。\n$$ r_{\\text{ads}} = k_{\\text{ads}} P \\theta_v = k_{\\text{ads}} P (1 - \\theta_A) $$\n解吸速率 $r_{\\text{des}}$ 对吸附物种的覆盖度 $\\theta_A$ 是一级反应。\n$$ r_{\\text{des}} = k_{\\text{des}} \\theta_A $$\n问题要求对吸附-解吸步骤使用准平衡近似。这意味着该步骤远快于随后的表面反应，因此可以认为处于平衡状态，即 $r_{\\text{ads}} = r_{\\text{des}}$。\n$$ k_{\\text{ads}} P (1 - \\theta_A) = k_{\\text{des}} \\theta_A $$\n这个方程可以通过代数方法求解，用压力 $P$ 表示表面覆盖度 $\\theta_A$。\n$$ k_{\\text{ads}} P - k_{\\text{ads}} P \\theta_A = k_{\\text{des}} \\theta_A $$\n$$ k_{\\text{ads}} P = (k_{\\text{des}} + k_{\\text{ads}} P) \\theta_A $$\n$$ \\theta_A(P) = \\frac{k_{\\text{ads}} P}{k_{\\text{des}} + k_{\\text{ads}} P} $$\n这个表达式可以通过定义吸附平衡常数 $K = \\frac{k_{\\text{ads}}}{k_{\\text{des}}}$ 来写得更紧凑，其单位是压力的倒数（例如 $\\text{bar}^{-1}$）。\n$$ \\theta_A(P) = \\frac{(k_{\\text{ads}}/k_{\\text{des}}) P}{1 + (k_{\\text{ads}}/k_{\\text{des}}) P} = \\frac{K P}{1 + K P} $$\n这就是 Langmuir 吸附等温线，按要求从动力学第一性原理推导得出。\n\n每个位点的宏观产物生成速率 $r$ 由单分子表面反应步骤的速率决定（依据 iii）。该速率与反应物种 $A*$ 的覆盖度成正比。\n$$ r(P) = k_{\\text{rxn}} \\theta_A(P) $$\n将推导出的 $\\theta_A(P)$ 表达式代入，得到作为压力函数的总速率定律：\n$$ r(P) = k_{\\text{rxn}} \\frac{K P}{1 + K P} $$\n该表达式为数值模拟提供了基础。\n\n表观反应级数 $n_{\\text{app}}$ 定义为速率对压力的对数导数（依据 iii）。\n$$ n_{\\text{app}}(P) \\equiv \\frac{d \\ln r}{d \\ln P} $$\n为了获得解析性洞察，我们可以推导出 $n_{\\text{app}}(P)$ 的精确函数形式。\n$$ \\ln r = \\ln\\left(k_{\\text{rxn}} \\frac{K P}{1 + K P}\\right) = \\ln(k_{\\text{rxn}}) + \\ln(K) + \\ln(P) - \\ln(1 + K P) $$\n对 $\\ln P$ 求导，并使用恒等式 $d/d(\\ln P) = P \\cdot d/dP$：\n$$ n_{\\text{app}}(P) = \\frac{d(\\ln(k_{\\text{rxn}}))}{d(\\ln P)} + \\frac{d(\\ln(K))}{d(\\ln P)} + \\frac{d(\\ln P)}{d(\\ln P)} - \\frac{d(\\ln(1 + K P))}{d(\\ln P)} $$\n$$ n_{\\text{app}}(P) = 0 + 0 + 1 - P \\cdot \\frac{d(\\ln(1 + K P))}{dP} = 1 - P \\cdot \\frac{K}{1 + K P} $$\n$$ n_{\\text{app}}(P) = 1 - \\frac{K P}{1 + K P} = \\frac{(1 + K P) - K P}{1 + K P} = \\frac{1}{1 + K P} $$\n这个解析结果表明，$n_{\\text{app}}$ 在低压（$P \\to 0$）时从 1 变化到高压（$P \\to \\infty$）时的 0。当 $n_{\\text{app}}(P) = 0.5$ 时的过渡压力 $P^\\star$ 对应于 $1/(1+KP^\\star)=0.5$，这得到 $KP^\\star=1$，或 $P^\\star = 1/K$。\n\n数值实现将按以下步骤进行：\n1.  使用 `numpy.logspace` 构建一个压力网格 $P$，以确保在对数域中均匀采样，范围为 $[P_{\\min}, P_{\\max}]$，包含 $N$ 个点。\n2.  计算平衡常数 $K = k_{\\text{ads}} / k_{\\text{des}}$。\n3.  使用推导出的公式计算覆盖度 $\\theta_A(P)$ 和速率 $r(P)$ 的数组。\n4.  计算数组 $\\ln r$ 和 $\\ln P$。使用 `numpy.gradient(ln r, ln P)` 计算表观级数 $n_{\\text{app}}(P)$，该函数对内部点正确应用中心差分，对边界点正确应用单侧差分。\n5.  从 $n_{\\text{app}}$ 数组的第一个和最后一个元素中提取 $n_{\\text{low}}$ 和 $n_{\\text{high}}$。\n6.  为了找到 $n_{\\text{app}}$ 穿过 $0.5$ 的过渡点，我们首先检查是否在范围内发生了这种从上到下的穿越。如果 $n_{\\text{low}}  0.5$ 或 $n_{\\text{high}} > 0.5$，则未找到有效过渡，并将 $P^\\star$ 和 $\\theta^\\star$ 设置为 $-1.0$。\n7.  如果可能存在过渡，代码会迭代相邻点 $([P_i, n_i], [P_{i+1}, n_{i+1}])$ 以找到第一个满足 $n_i \\ge 0.5$ 和 $n_{i+1}  0.5$ 的区间。\n8.  在 $(\\ln P_i, n_i)$ 和 $(\\ln P_{i+1}, n_{i+1})$ 之间使用线性插值来找到对应于 $n_{\\text{app}}=0.5$ 的 $\\ln P^\\star$：$\\ln P^\\star = \\ln P_i + (\\ln P_{i+1} - \\ln P_i) \\frac{0.5 - n_i}{n_{i+1} - n_i}$。\n9.  过渡压力为 $P^\\star = \\exp(\\ln P^\\star)$，相应的覆盖度计算为 $\\theta^\\star = \\frac{K P^\\star}{1 + K P^\\star}$。如果未找到区间，则保留默认值 $-1.0$。\n这个过程为所述问题提供了一个完整且鲁棒的解决方案。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Langmuir-Hinshelwood kinetics problem for multiple test cases.\n    \"\"\"\n    test_cases = [\n        # Test A: happy path, transition in-range\n        (1.0, 1.0, 10.0, 1e-3, 1e3, 200),\n        # Test B: strong adsorption, transition at low pressure\n        (100.0, 1.0, 5.0, 1e-5, 1.0, 200),\n        # Test C: weak adsorption, no transition within range\n        (0.001, 1.0, 1.0, 1e-4, 10.0, 200),\n        # Test D: transition at the lower boundary, coarse grid\n        (1e6, 1.0, 2.0, 1e-6, 1.0, 50),\n    ]\n\n    results = []\n    for k_ads, k_des, k_rxn, P_min, P_max, N in test_cases:\n        # 1. Construct a logarithmically spaced grid of pressures P.\n        log_P_min = np.log10(P_min)\n        log_P_max = np.log10(P_max)\n        P_grid = np.logspace(log_P_min, log_P_max, N)\n\n        # 2. Compute the surface coverage theta_A(P).\n        # Define the adsorption equilibrium constant K.\n        K_eq = k_ads / k_des\n        # Langmuir isotherm: theta_A = (K * P) / (1 + K * P)\n        theta_A = (K_eq * P_grid) / (1 + K_eq * P_grid)\n\n        # 3. Compute the rate r(P).\n        # Rate is proportional to the coverage of the reactant.\n        rate = k_rxn * theta_A\n\n        # Handle case where rate might be zero, causing log to fail.\n        # This is unlikely with the given model unless k_rxn=0 or P=0.\n        # We ensure rate  0 by adding a small epsilon if needed, but the model\n        # structure avoids this for P  0.\n        \n        # 4. Compute the apparent reaction order n_app(P).\n        # n_app = d(ln r) / d(ln P)\n        ln_rate = np.log(rate)\n        ln_P = np.log(P_grid)\n        \n        # Use np.gradient for numerical differentiation. It uses central\n        # differences for interior points and one-sided for boundaries.\n        n_app = np.gradient(ln_rate, ln_P)\n\n        # 5. Report the four specified quantities.\n        n_low = n_app[0]\n        n_high = n_app[-1]\n        \n        # Initialize transition values to the \"not found\" state.\n        P_star = -1.0\n        theta_star = -1.0\n        \n        # Check boundary conditions for crossing.\n        # We are looking for a crossing from above 0.5 to below 0.5.\n        if n_low = 0.5 and n_high  0.5:\n            # Find the index 'i' where n_app[i] = 0.5 and n_app[i+1]  0.5\n            found = False\n            for i in range(len(n_app) - 1):\n                if n_app[i] = 0.5 and n_app[i+1]  0.5:\n                    # The crossing occurs between index i and i+1.\n                    # Perform linear interpolation in log-log space\n                    # to find ln(P*) where n_app = 0.5.\n                    \n                    n_i = n_app[i]\n                    n_i1 = n_app[i+1]\n                    ln_P_i = ln_P[i]\n                    ln_P_i1 = ln_P[i+1]\n                    \n                    # Interpolation formula: x = x1 + (x2-x1)*(y-y1)/(y2-y1)\n                    # Here, x is ln(P) and y is n_app. We are finding x for y=0.5.\n                    ln_P_star = ln_P_i + (ln_P_i1 - ln_P_i) * (0.5 - n_i) / (n_i1 - n_i)\n                    \n                    P_star = np.exp(ln_P_star)\n                    \n                    # Calculate coverage at the transition pressure.\n                    theta_star = (K_eq * P_star) / (1 + K_eq * P_star)\n                    \n                    found = True\n                    break\n            \n            # The problem statement has been carefully interpreted.\n            # If n_app(P_min)  0.5 or n_app(P_max)  0.5, no transition is reported.\n            # This is handled by the outer if-condition. The logic above handles\n            # finding the first crossing if one is guaranteed to exist by the outer check.\n\n        results.append([n_low, n_high, P_star, theta_star])\n    \n    # Format the final output string exactly as required.\n    # Convert each number in the sublists to a string, join them with commas,\n    # then bracket them. Finally, join the outer lists with commas and bracket them.\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "对实验数据的解读是任何动力学模型的最终考验。本高级练习  模拟了催化研究中常用的程序升温反应，旨在深入探讨表观活化能（$E_{\\mathrm{app}}$）的概念。你将了解到，对于表面反应，$E_{\\mathrm{app}}$通常不是一个常数，而是随温度变化，而这种变化蕴含了关于表面覆盖度变化和潜在速控步骤转变的丰富信息。本练习将理论模型与实验室中观察到的复杂动力学特征联系起来。",
            "id": "3885082",
            "problem": "您将获得一个催化表面过程的合成程序升温反应数据，该过程可能遵循 Langmuir–Hinshelwood 机理或 Eley–Rideal 机理。目标是计算表观活化能分布曲线，并量化其与常数的偏差，以诊断覆盖度和机理的变化。\n\n基本原理：\n- 阿伦尼乌斯定律指出，基元反应速率常数为 $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$，其中 $k_0$ 是指前因子，$E$ 是活化能，$R$ 是普适气体常数，$T$ 是温度。\n- 对于单一类型的位点和物种的竞争性吸附，Langmuir 吸附模型给出了物种 $i$ 的分数覆盖度为 $\\theta_i(T) = \\dfrac{K_i(T) p_i}{1 + \\sum_j K_j(T) p_j}$，其中 $p_i$ 是物种 $i$ 的分压，$K_i(T)$ 是物种 $i$ 依赖于温度 $T$ 的吸附平衡常数。\n- 吸附平衡常数的一种合理的温度依赖关系是 $K_i(T) = K_{0,i} \\exp\\!\\left(\\dfrac{E_{\\text{ads},i}}{R T}\\right)$，其中 $K_{0,i}$ 是一个单位为压力倒数的常数，$E_{\\text{ads},i}0$ 是放热吸附能的大小（对 $T$ 的依赖性体现了在较低温度 $T$ 下吸附更强）。\n- Langmuir–Hinshelwood（表面-表面）速率为 $r_{\\mathrm{LH}}(T) = k_{\\mathrm{LH}}(T)\\,\\theta_A(T)\\,\\theta_B(T)$。\n- Eley–Rideal（表面-气相）速率为 $r_{\\mathrm{ER}}(T) = k_{\\mathrm{ER}}(T)\\,\\theta_A(T)\\,p_B$，其中 $p_B$ 是物种 $B$ 的气相分压。\n\n目标量的定义：\n- 表观活化能 $E_{\\mathrm{app}}(T)$ 是基于测得的总速率 $r(T)$ 和阿伦尼乌斯定律定义的，它提供了一种方法，即使在覆盖度不断演变的情况下，也能推断出在每个温度 $T$ 下主导步骤的有效能垒。您的程序必须从阿伦尼乌斯定律推导出并实现正确的关系式，并根据程序升温过程中的 $r(T)$ 数据直接计算 $E_{\\mathrm{app}}(T)$。\n\n任务：\n1. 对于每个给定的参数集，在线性程序升温 $T \\in [T_0, T_f]$（其中 $T(t) = T_0 + \\beta t$）和 $T$ 的均匀网格上合成 $r(T)$。使用上述速率表达式和吸附关系式，为指定的机理计算 $r(T)$。\n2. 根据 $r(T)$，计算在整个温度范围内的 $E_{\\mathrm{app}}(T)$ 分布曲线，仅使用阿伦尼乌斯定律和微积分所蕴含的基本定义和关系（不要引入任何外部的经验性捷径）。\n3. 为每种情况计算以下三个标量指标：\n   - 在对应于最大反应速率（峰值）的温度下求得的 $E_{\\mathrm{app}}$，以千焦每摩尔（kJ/mol）为单位表示，并四舍五入到三位小数。\n   - 在速率显著范围内的变异性指标，定义为变异系数 $\\mathrm{CV} = \\dfrac{\\sigma(E_{\\mathrm{app}})}{\\mu(E_{\\mathrm{app}})}$，该系数是在 $r(T)$ 超过其最大值的某个阈值分数的温度子集上计算的。将此报告为小数，并四舍五入到六位小数。\n   - 在速率显著的同一样本子集上，$E_{\\mathrm{app}}(T)$ 和 $\\theta_A(T)$ 之间的皮尔逊相关系数。将此报告为小数，并四舍五入到六位小数。\n\n科学真实性与单位：\n- 使用 $R = 8.314$，单位为焦耳每摩尔每开尔文 (J/mol/K)。\n- 压力 $p_A$ 和 $p_B$ 的单位为巴 (bar)。\n- $K_{0,i}$ 的单位为 bar$^{-1}$。\n- 活化能 $E$ 和吸附能 $E_{\\text{ads},i}$ 在内部计算时必须以焦耳每摩尔为单位，而在报告 $E_{\\mathrm{app}}$ 指标时需转换为千焦每摩尔。\n- 报告的 $E_{\\mathrm{app}}$ 以千焦每摩尔（kJ/mol）为单位表示，并四舍五入到三位小数。\n\n测试套件：\n使用一个在 $T \\in [T_0,T_f]$ 上的均匀温度网格，其中 $T_0 = 300$ 开尔文，$T_f = 800$ 开尔文，共使用 $N = 801$ 个等距点。虽然定义了升温速率 $\\beta$，但由于 $T$ 是自变量，您可能不需要显式使用它。对于每种情况，根据指定的机理计算 $\\theta_A(T)$、$\\theta_B(T)$ 和 $r(T)$。\n\n情况 1（Langmuir–Hinshelwood，弱吸附基线）：\n- 机理：LH\n- $k_0 = 1.00\\times 10^{5}$, $E = 80.0$ kJ/mol\n- $K_{0,A} = 1.00\\times 10^{-6}$ bar$^{-1}$, $E_{\\text{ads},A} = 20.0$ kJ/mol\n- $K_{0,B} = 1.00\\times 10^{-6}$ bar$^{-1}$, $E_{\\text{ads},B} = 20.0$ kJ/mol\n- $p_A = 0.10$ bar, $p_B = 0.10$ bar\n\n情况 2（Langmuir–Hinshelwood，强吸附伴有显著覆盖度变化）：\n- 机理：LH\n- $k_0 = 1.00\\times 10^{5}$, $E = 80.0$ kJ/mol\n- $K_{0,A} = 1.00\\times 10^{-3}$ bar$^{-1}$, $E_{\\text{ads},A} = 80.0$ kJ/mol\n- $K_{0,B} = 1.00\\times 10^{-4}$ bar$^{-1}$, $E_{\\text{ads},B} = 40.0$ kJ/mol\n- $p_A = 0.10$ bar, $p_B = 0.05$ bar\n\n情况 3（Eley–Rideal，A 强吸附，B 主要处于气相）：\n- 机理：ER\n- $k_0 = 1.00\\times 10^{5}$, $E = 60.0$ kJ/mol\n- $K_{0,A} = 1.00\\times 10^{-3}$ bar$^{-1}$, $E_{\\text{ads},A} = 70.0$ kJ/mol\n- $K_{0,B} = 1.00\\times 10^{-8}$ bar$^{-1}$, $E_{\\text{ads},B} = 10.0$ kJ/mol\n- $p_A = 0.10$ bar, $p_B = 0.20$ bar\n\n情况 4（Langmuir–Hinshelwood，B 强吸附，潜在的位点阻塞）：\n- 机理：LH\n- $k_0 = 5.00\\times 10^{4}$, $E = 75.0$ kJ/mol\n- $K_{0,A} = 1.00\\times 10^{-4}$ bar$^{-1}$, $E_{\\text{ads},A} = 50.0$ kJ/mol\n- $K_{0,B} = 1.00\\times 10^{-2}$ bar$^{-1}$, $E_{\\text{ads},B} = 90.0$ kJ/mol\n- $p_A = 0.05$ bar, $p_B = 0.20$ bar\n\n计算细节：\n- 使用掩码定义“显著速率”区域：包括 $r(T) \\ge \\epsilon \\, r_{\\max}$（其中 $\\epsilon = 10^{-12}$）的温度。\n- 使用关于 $T$ 的数值微分来计算阿伦尼乌斯分析所蕴含的必要导数。\n- 在计算 $r(T)$ 的对数时，通过在取对数前将小于一个极小下限值（例如 $10^{-300}$）的 $r(T)$ 值替换为该下限值，以避免数值问题。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，并且本身是一个逗号分隔的三元素列表，顺序为 $\\left[E_{\\mathrm{app}}(T_{\\text{peak}})\\,\\text{in kJ/mol},\\,\\mathrm{CV},\\,\\mathrm{corr}(E_{\\mathrm{app}},\\theta_A)\\right]$。例如，输出必须如下所示\n$[[e_1,cv_1,c_1],[e_2,cv_2,c_2],[e_3,cv_3,c_3],[e_4,cv_4,c_4]]$，\n其中每个 $e_i$ 是一个以千焦每摩尔为单位、四舍五入到三位小数的浮点数，每个 $cv_i$ 和 $c_i$ 是一个四舍五入到六位小数的小数。",
            "solution": "用户提供了一个化学动力学领域定义明确的计算问题，具体涉及多相催化中表观活化能的分析。该问题在科学上是合理的、内容自洽且在算法上是可解的。\n\n### 第 1 步：理论基础与推导\n\n该问题要求从给定的总反应速率 $r(T)$ 计算表观活化能 $E_{\\mathrm{app}}(T)$。$E_{\\mathrm{app}}(T)$ 的定义是基于对基元反应的阿伦尼乌斯关系的推广。\n\n对于基元速率常数 $k(T)$，阿伦尼乌斯方程为：\n$$k(T) = k_0 \\exp\\left(-\\frac{E}{RT}\\right)$$\n其中，$E$ 是内在活化能，$k_0$ 是指前因子，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n取自然对数，我们得到：\n$$\\ln k(T) = \\ln k_0 - \\frac{E}{RT}$$\n活化能 $E$ 可以通过对逆温 $1/T$ 求导来恢复：\n$$\\frac{d(\\ln k)}{d(1/T)} = -\\frac{E}{R}$$\n$$E = -R \\frac{d(\\ln k)}{d(1/T)}$$\n\n通过类比，对于一个总速率为 $r(T)$ 的复杂反应，其表观活化能 $E_{\\mathrm{app}}(T)$ 定义为：\n$$E_{\\mathrm{app}}(T) = -R \\frac{d(\\ln r(T))}{d(1/T)}$$\n该定义提供了一个随温度变化的能垒，它反映了内在能垒和随温度变化的表面现象（如反应物覆盖度的变化）的综合效应。\n\n为了进行数值计算，使用对温度 $T$ 的导数更为方便。使用链式法则 $\\frac{df}{d(1/T)} = \\frac{df}{dT} \\frac{dT}{d(1/T)}$，并且知道 $\\frac{d(1/T)}{dT} = -1/T^2$，我们得到 $\\frac{dT}{d(1/T)} = -T^2$。将此代入 $E_{\\mathrm{app}}(T)$ 的定义，得到计算公式：\n$$E_{\\mathrm{app}}(T) = -R \\left(\\frac{d(\\ln r(T))}{dT}\\right) (-T^2) = R T^2 \\frac{d(\\ln r(T))}{dT}$$\n这就是要实现的表达式。导数 $\\frac{d(\\ln r(T))}{dT}$ 将从合成的速率数据中进行数值计算。\n\n### 第 2 步：算法步骤\n\n解决每个给定案例的总体步骤如下：\n\n1.  **建立温度网格**：在区间 $T \\in [300, 800]\\, \\mathrm{K}$ 上创建一个包含 $N=801$ 个温度点的均匀网格。\n\n2.  **合成速率数据, $r(T)$**：\n    a. 对于网格中的每个温度 $T_j$，我们首先使用给定的类似 van 't Hoff 的表达式计算吸附平衡常数 $K_A(T_j)$ 和 $K_B(T_j)$：\n    $$K_i(T) = K_{0,i} \\exp\\left(\\frac{E_{\\text{ads},i}}{RT}\\right)$$\n    输入的能量 $E$ 和 $E_{\\text{ads},i}$ 以 $\\mathrm{kJ/mol}$ 给出，必须通过乘以 $1000$ 转换为 $\\mathrm{J/mol}$，以与 $R = 8.314 \\, \\mathrm{J/mol/K}$ 保持一致。\n    b. 然后，使用 Langmuir 竞争性吸附模型计算物种 A 和 B 的分数表面覆盖度 $\\theta_A(T_j)$ 和 $\\theta_B(T_j)$：\n    $$\\theta_i(T) = \\frac{K_i(T) p_i}{1 + K_A(T) p_A + K_B(T) p_B}$$\n    c. 使用阿伦尼乌斯定律计算基元反应速率常数 $k(T_j)$：\n    $$k(T) = k_0 \\exp\\left(-\\frac{E}{RT}\\right)$$\n    d. 根据指定的机理计算总反应速率 $r(T_j)$：\n    -   **Langmuir–Hinshelwood (LH)**：$r_{\\mathrm{LH}}(T) = k(T)\\,\\theta_A(T)\\,\\theta_B(T)$\n    -   **Eley–Rideal (ER)**：$r_{\\mathrm{ER}}(T) = k(T)\\,\\theta_A(T)\\,p_B$\n\n3.  **计算表观活化能分布曲线, $E_{\\mathrm{app}}(T)$**：\n    a. 为防止数值错误，在取对数之前，计算出的速率 $r(T)$ 的下限被设定为一个小的正值 ($10^{-300}$)。\n    b. 计算数组 $\\ln r(T)$。\n    c. 使用二阶有限差分格式对导数 $\\frac{d(\\ln r)}{dT}$ 进行数值计算，`numpy.gradient` 函数对此很适用。\n    d. 使用推导出的公式计算表观活化能分布曲线：$E_{\\mathrm{app}}(T) = R T^2 \\frac{d(\\ln r)}{dT}$。\n\n4.  **计算并报告指标**：\n    a. **峰值速率下的 $E_{\\mathrm{app}}$**：找到最大速率 $r_{\\max} = \\max(r(T))$ 和对应的温度 $T_{\\text{peak}}$。提取 $E_{\\mathrm{app}}(T_{\\text{peak}})$ 的值，将其从 $\\mathrm{J/mol}$ 转换为 $\\mathrm{kJ/mol}$，并四舍五入到三位小数。\n    b. **变异性指标 (CV)**：通过一个掩码定义“显著速率”区域，其中 $r(T) \\ge \\epsilon \\, r_{\\max}$ 且 $\\epsilon = 10^{-12}$。在此区域内，对 $E_{\\mathrm{app}}(T)$ 的值计算变异系数 $\\mathrm{CV} = \\sigma(E_{\\mathrm{app}})/\\mu(E_{\\mathrm{app}})$。结果四舍五入到六位小数。\n    c. **相关性指标**：在同一个显著速率区域内，计算 $E_{\\mathrm{app}}(T)$ 和 $\\theta_A(T)$ 之间的皮尔逊相关系数。结果四舍五入到六位小数。\n\n此过程将应用于问题陈述中指定的四个测试用例中的每一个。最终输出将格式化为列表的列表，其中每个内部列表包含给定案例的三个计算指标。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes apparent activation energy profiles and related metrics for\n    catalytic surface reactions following Langmuir-Hinshelwood or Eley-Rideal mechanisms.\n    \"\"\"\n    R = 8.314  # J/mol/K\n    T0, Tf, N = 300, 800, 801\n    T = np.linspace(T0, Tf, N)\n    \n    # Tiny value to prevent log(0)\n    RATE_FLOOR = 1e-300\n    # Threshold for defining the \"appreciable rate\" region\n    APPRECIABLE_RATE_THRESHOLD = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"mechanism\": \"LH\", \"k0\": 1.00e5, \"E\": 80.0,\n            \"K0A\": 1.00e-6, \"EadsA\": 20.0, \"pA\": 0.10,\n            \"K0B\": 1.00e-6, \"EadsB\": 20.0, \"pB\": 0.10,\n        },\n        {\n            \"mechanism\": \"LH\", \"k0\": 1.00e5, \"E\": 80.0,\n            \"K0A\": 1.00e-3, \"EadsA\": 80.0, \"pA\": 0.10,\n            \"K0B\": 1.00e-4, \"EadsB\": 40.0, \"pB\": 0.05,\n        },\n        {\n            \"mechanism\": \"ER\", \"k0\": 1.00e5, \"E\": 60.0,\n            \"K0A\": 1.00e-3, \"EadsA\": 70.0, \"pA\": 0.10,\n            \"K0B\": 1.00e-8, \"EadsB\": 10.0, \"pB\": 0.20,\n        },\n        {\n            \"mechanism\": \"LH\", \"k0\": 5.00e4, \"E\": 75.0,\n            \"K0A\": 1.00e-4, \"EadsA\": 50.0, \"pA\": 0.05,\n            \"K0B\": 1.00e-2, \"EadsB\": 90.0, \"pB\": 0.20,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Convert energies from kJ/mol to J/mol\n        E_J = case[\"E\"] * 1000.0\n        EadsA_J = case[\"EadsA\"] * 1000.0\n        EadsB_J = case[\"EadsB\"] * 1000.0\n\n        # --- 1. Synthesize Data ---\n        # Adsorption equilibrium constants\n        KA = case[\"K0A\"] * np.exp(EadsA_J / (R * T))\n        KB = case[\"K0B\"] * np.exp(EadsB_J / (R * T))\n        \n        # Denominator for Langmuir isotherm\n        denominator = 1.0 + KA * case[\"pA\"] + KB * case[\"pB\"]\n        \n        # Surface coverages\n        theta_A = (KA * case[\"pA\"]) / denominator\n        theta_B = (KB * case[\"pB\"]) / denominator\n        \n        # Intrinsic rate constant\n        k = case[\"k0\"] * np.exp(-E_J / (R * T))\n        \n        # Overall reaction rate\n        if case[\"mechanism\"] == \"LH\":\n            r = k * theta_A * theta_B\n        elif case[\"mechanism\"] == \"ER\":\n            r = k * theta_A * case[\"pB\"]\n        else:\n            raise ValueError(f\"Unknown mechanism: {case['mechanism']}\")\n\n        # --- 2. Compute Apparent Activation Energy ---\n        # Apply floor to rate for numerical stability\n        r_floored = np.maximum(r, RATE_FLOOR)\n        log_r = np.log(r_floored)\n        \n        # Numerical derivative d(ln(r))/dT\n        d_log_r_dT = np.gradient(log_r, T)\n        \n        # Apparent activation energy in J/mol\n        E_app = R * T**2 * d_log_r_dT\n\n        # --- 3. Calculate Metrics ---\n        # Metric 1: E_app at peak rate\n        idx_peak = np.argmax(r)\n        E_app_peak_J = E_app[idx_peak]\n        E_app_peak_kJ = E_app_peak_J / 1000.0\n\n        # Define appreciable-rate region\n        r_max = r[idx_peak]\n        mask = r = APPRECIABLE_RATE_THRESHOLD * r_max\n        \n        # Filter data for metrics 2 and 3\n        E_app_masked = E_app[mask]\n        theta_A_masked = theta_A[mask]\n        \n        # Metric 2: Coefficient of variation of E_app\n        # Handle case where std is zero to avoid division by zero if mean is zero\n        # or if E_app_masked is constant.\n        mean_E_app = np.mean(E_app_masked)\n        if np.isclose(mean_E_app, 0):\n             cv = 0.0\n        else:\n             cv = np.std(E_app_masked) / mean_E_app\n\n        # Metric 3: Pearson correlation between E_app and theta_A\n        # np.corrcoef returns a matrix, we need the off-diagonal element\n        if len(E_app_masked)  1:\n            corr_matrix = np.corrcoef(E_app_masked, theta_A_masked)\n            corr = corr_matrix[0, 1]\n        else: # Cannot compute correlation for a single point\n            corr = np.nan\n\n        results.append((E_app_peak_kJ, cv, corr))\n\n    # ---- Final Output Formatting ----\n    # Build the output string to perfectly match the required format\n    # e.g., [[e1,cv1,c1],[e2,cv2,c2],...]\n    output_parts = []\n    for e, cv, c in results:\n        # Round according to problem spec\n        e_str = f\"{e:.3f}\"\n        cv_str = f\"{cv:.6f}\"\n        c_str = f\"{np.nan_to_num(c):.6f}\" # Replace potential NaN with 0\n        output_parts.append(f\"[{e_str},{cv_str},{c_str}]\")\n        \n    final_output_str = f\"[{','.join(output_parts)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}