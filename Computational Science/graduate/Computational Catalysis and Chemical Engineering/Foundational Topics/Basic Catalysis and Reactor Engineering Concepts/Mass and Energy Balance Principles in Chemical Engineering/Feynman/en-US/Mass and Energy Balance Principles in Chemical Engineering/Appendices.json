{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of modern chemical engineering is the ability to connect macroscopic reactor performance with the underlying microscopic events on a catalyst surface. This practice guides you through the formulation of a complete model for a Continuous Stirred-Tank Reactor (CSTR) by coupling the gas-phase mass balances with a mean-field microkinetic model for the surface reactions. Mastering this exercise  will equip you with the foundational skill of solving the coupled non-linear algebraic equations that govern many catalytic systems at steady state.",
            "id": "3887008",
            "problem": "Consider a well-mixed gas–solid catalytic system modeled as a Continuous Stirred Tank Reactor (CSTR). The gas comprises species $A$, $B$, and $P$ at total pressure $P_{\\text{tot}}$, with a constant volumetric flow rate $\\dot{V}$ through a reactor of volume $V$. A solid catalyst of surface area $S$ and site density $\\sigma$ provides adsorption sites for $A$ and $B$, enabling a Langmuir–Hinshelwood surface reaction that produces $P$ directly into the gas phase. The reactor is isothermal at temperature $T$. The gas is ideal and described by the Ideal Gas Law (IGL): $p_i = C_i R T$, where $p_i$ is the partial pressure of species $i$, $C_i$ is the molar concentration of species $i$, $R$ is the ideal gas constant, and $T$ is temperature in Kelvin. The kinetics follow mean-field microkinetics with the site balance $\\sum_j \\theta_j = 1$ over site types $j \\in \\{*, A, B\\}$, where $*$ denotes an empty site, and $\\theta_j$ are fractional coverages.\n\nAdsorption and desorption steps for $A$ and $B$ are reversible. The net surface reaction consumes one adsorbed $A$ and one adsorbed $B$ to produce one gas-phase $P$ and two empty sites, represented as $A* + B* \\rightarrow P(g) + * + *$. The rate constants obey Arrhenius-type temperature dependence. Assume the following well-tested physical bases:\n- Species conservation in a CSTR: for each gas species $i$, the transient mass balance is $dC_i/dt = (\\dot{V}/V)(C_{i,\\text{in}} - C_i) + (\\text{interfacial source of }i)/V$, where $C_{i,\\text{in}}$ is the inlet concentration.\n- Mean-field site balances and kinetics: $d\\theta_A/dt = r_{A,\\text{ads}} - r_{A,\\text{des}} - r_{\\text{rxn}}$, $d\\theta_B/dt = r_{B,\\text{ads}} - r_{B,\\text{des}} - r_{\\text{rxn}}$, and $\\theta_* = 1 - \\theta_A - \\theta_B$. Interfacial sources are computed by multiplying per-site rates by the total number of sites $N_{\\text{sites}} = \\sigma S$.\n- Arrhenius expressions for rate constants: $k(T) = A \\exp(-E_a/(R T))$.\n\nYour task is to formulate the coupled mass balances for the gas species and surface coverages under the assumptions above, and compute the steady-state outlet molar flow rate of $P$ for a given set of parameters. The adsorption–desorption and reaction steps are:\n- Adsorption of $A$: $r_{A,\\text{ads}} = k_{A,\\text{ads}}(T) \\, p_A \\, \\theta_*$.\n- Desorption of $A$: $r_{A,\\text{des}} = k_{A,\\text{des}}(T) \\, \\theta_A$.\n- Adsorption of $B$: $r_{B,\\text{ads}} = k_{B,\\text{ads}}(T) \\, p_B \\, \\theta_*$.\n- Desorption of $B$: $r_{B,\\text{des}} = k_{B,\\text{des}}(T) \\, \\theta_B$.\n- Surface reaction: $r_{\\text{rxn}} = k_{\\text{rxn}}(T) \\, \\theta_A \\, \\theta_B$.\n\nUse $R = 8.314462618 \\, \\text{J} \\, \\text{mol}^{-1} \\, \\text{K}^{-1}$, $P_{\\text{tot}} = 100000 \\, \\text{Pa}$, $V = 0.01 \\, \\text{m}^3$, $\\dot{V} = 0.01 \\, \\text{m}^3 \\, \\text{s}^{-1}$, $\\sigma = 2 \\times 10^{-5} \\, \\text{mol} \\, \\text{m}^{-2}$. For the Arrhenius parameters, use the following pre-exponentials and activation energies:\n- $A_{A,\\text{ads}} = 2 \\times 10^{-5} \\, \\text{s}^{-1} \\, \\text{Pa}^{-1}$, $E_{A,\\text{ads}} = 5000 \\, \\text{J} \\, \\text{mol}^{-1}$.\n- $A_{A,\\text{des}} = 1 \\times 10^{5} \\, \\text{s}^{-1}$, $E_{A,\\text{des}} = 80000 \\, \\text{J} \\, \\text{mol}^{-1}$.\n- $A_{B,\\text{ads}} = 1 \\times 10^{-5} \\, \\text{s}^{-1} \\, \\text{Pa}^{-1}$, $E_{B,\\text{ads}} = 4000 \\, \\text{J} \\, \\text{mol}^{-1}$.\n- $A_{B,\\text{des}} = 5 \\times 10^{4} \\, \\text{s}^{-1}$, $E_{B,\\text{des}} = 90000 \\, \\text{J} \\, \\text{mol}^{-1}$.\n- $A_{\\text{rxn}} = 1 \\times 10^{3} \\, \\text{s}^{-1}$, $E_{\\text{rxn}} = 120000 \\, \\text{J} \\, \\text{mol}^{-1}$.\n\nThe inlet is specified by mole fractions $y_{A,\\text{in}}$, $y_{B,\\text{in}}$, and $y_{P,\\text{in}} = 0$, with $y_{I,\\text{in}} = 1 - y_{A,\\text{in}} - y_{B,\\text{in}} - y_{P,\\text{in}}$ for an inert $I$. Convert inlet mole fractions to concentrations using $C_{i,\\text{in}} = y_{i,\\text{in}} P_{\\text{tot}}/(R T)$. The objective is to compute the steady-state outlet molar flow rate of $P$, $F_{P,\\text{out}} = \\dot{V} \\, C_P^{\\text{ss}}$, expressed in $\\text{mol} \\, \\text{s}^{-1}$.\n\nTest Suite:\n- Case $1$: $T = 700 \\, \\text{K}$, $y_{A,\\text{in}} = 0.4$, $y_{B,\\text{in}} = 0.4$, $S = 5.0 \\, \\text{m}^2$.\n- Case $2$: $T = 700 \\, \\text{K}$, $y_{A,\\text{in}} = 0.8$, $y_{B,\\text{in}} = 0.0$, $S = 5.0 \\, \\text{m}^2$.\n- Case $3$: $T = 900 \\, \\text{K}$, $y_{A,\\text{in}} = 0.5$, $y_{B,\\text{in}} = 0.5$, $S = 5.0 \\, \\text{m}^2$.\n- Case $4$: $T = 500 \\, \\text{K}$, $y_{A,\\text{in}} = 0.5$, $y_{B,\\text{in}} = 0.5$, $S = 5.0 \\, \\text{m}^2$.\n- Case $5$: $T = 700 \\, \\text{K}$, $y_{A,\\text{in}} = 0.4$, $y_{B,\\text{in}} = 0.4$, $S = 0.0 \\, \\text{m}^2$.\n\nAngle units are not applicable. Express the final outlet molar flow rates of $P$ in $\\text{mol} \\, \\text{s}^{-1}$ as real-valued floats.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_k$ is the steady-state outlet molar flow rate of $P$ for Case $k$ in $\\text{mol} \\, \\text{s}^{-1}$.",
            "solution": "The problem requires the calculation of the steady-state outlet molar flow rate of product $P$, denoted as $F_{P,\\text{out}}$, in a catalytic Continuous Stirred Tank Reactor (CSTR). The solution necessitates formulating and solving the mass and site balance equations at steady state.\n\nFirst, we establish the governing equations for the system. The reactor operates at steady state, which implies that all time derivatives are equal to zero.\n$dC_i/dt = 0$ for all gas-phase species $i \\in \\{A, B, P\\}$.\n$d\\theta_j/dt = 0$ for all surface species $j \\in \\{A, B\\}$.\n\nThe rate constants for adsorption, desorption, and reaction steps are temperature-dependent and are calculated using the Arrhenius equation:\n$$k(T) = A \\exp\\left(-\\frac{E_a}{RT}\\right)$$\nwhere $A$ is the pre-exponential factor, $E_a$ is the activation energy, $R$ is the ideal gas constant, and $T$ is the absolute temperature.\n\nThe total number of catalytic sites is given by $N_{\\text{sites}} = \\sigma S$, where $\\sigma$ is the site density and $S$ is the catalyst surface area.\n\nThe steady-state balance equations for the fractional surface coverages of species $A$ and $B$ are:\n$$\n\\frac{d\\theta_A}{dt} = r_{A,\\text{ads}} - r_{A,\\text{des}} - r_{\\text{rxn}} = 0\n$$\n$$\n\\frac{d\\theta_B}{dt} = r_{B,\\text{ads}} - r_{B,\\text{des}} - r_{\\text{rxn}} = 0\n$$\nwhere $r_{i,\\text{ads}}$, $r_{i,\\text{des}}$, and $r_{\\text{rxn}}$ are the rates per site. Substituting the given rate expressions:\n$$\nk_{A,\\text{ads}}(T) \\, p_A \\, \\theta_* - k_{A,\\text{des}}(T) \\, \\theta_A - k_{\\text{rxn}}(T) \\, \\theta_A \\, \\theta_B = 0\n$$\n$$\nk_{B,\\text{ads}}(T) \\, p_B \\, \\theta_* - k_{B,\\text{des}}(T) \\, \\theta_B - k_{\\text{rxn}}(T) \\, \\theta_A \\, \\theta_B = 0\n$$\nThe coverage of empty sites, $\\theta_*$, is related to the coverages of adsorbed species by the site balance:\n$$\n\\theta_* = 1 - \\theta_A - \\theta_B\n$$\n\nThe steady-state mass balance for each gas-phase species $i$ in the CSTR is:\n$$\n0 = \\frac{\\dot{V}}{V}(C_{i,\\text{in}} - C_i) + \\frac{\\mathcal{R}_i}{V}\n$$\nwhere $\\dot{V}$ is the volumetric flow rate, $V$ is the reactor volume, $C_{i,\\text{in}}$ and $C_i$ are the inlet and outlet molar concentrations, and $\\mathcal{R}_i$ is the total molar rate of formation of species $i$ from the catalytic surface, given by (rate per site) $\\times N_{\\text{sites}}$. The rates of formation are:\n$$\n\\mathcal{R}_A = (r_{A,\\text{des}} - r_{A,\\text{ads}}) N_{\\text{sites}}\n$$\n$$\n\\mathcal{R}_B = (r_{B,\\text{des}} - r_{B,\\text{ads}}) N_{\\text{sites}}\n$$\n$$\n\\mathcal{R}_P = r_{\\text{rxn}} N_{\\text{sites}}\n$$\nSubstituting the steady-state site balances into the expressions for $\\mathcal{R}_A$ and $\\mathcal{R}_B$, we find that the net rate of adsorption-desorption is balanced by the consumption in the surface reaction:\n$$\nr_{A,\\text{des}} - r_{A,\\text{ads}} = -r_{\\text{rxn}}\n$$\n$$\nr_{B,\\text{des}} - r_{B,\\text{ads}} = -r_{\\text{rxn}}\n$$\nThus, the mass balances become:\n$$\n0 = \\frac{\\dot{V}}{V}(C_{A,\\text{in}} - C_A) - \\frac{r_{\\text{rxn}} N_{\\text{sites}}}{V} \\implies C_A = C_{A,\\text{in}} - \\frac{N_{\\text{sites}}}{\\dot{V}} r_{\\text{rxn}}\n$$\n$$\n0 = \\frac{\\dot{V}}{V}(C_{B,\\text{in}} - C_B) - \\frac{r_{\\text{rxn}} N_{\\text{sites}}}{V} \\implies C_B = C_{B,\\text{in}} - \\frac{N_{\\text{sites}}}{\\dot{V}} r_{\\text{rxn}}\n$$\n$$\n0 = \\frac{\\dot{V}}{V}(C_{P,\\text{in}} - C_P) + \\frac{r_{\\text{rxn}} N_{\\text{sites}}}{V} \\implies C_P = C_{P,\\text{in}} + \\frac{N_{\\text{sites}}}{\\dot{V}} r_{\\text{rxn}}\n$$\nGiven $C_{P,\\text{in}} = 0$, we have a direct relationship between the outlet concentrations. Substituting $r_{\\text{rxn}} = k_{\\text{rxn}}(T) \\theta_A \\theta_B$:\n$$\nC_A^{\\text{ss}} = C_{A,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\n$$\nC_B^{\\text{ss}} = C_{B,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\n$$\nC_P^{\\text{ss}} = \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\nThe partial pressures $p_A$ and $p_B$ are related to the outlet concentrations via the Ideal Gas Law, $p_i = C_i R T$.\n\nThe problem reduces to solving a system of two coupled non-linear algebraic equations for the two unknown steady-state coverages, $\\theta_A^{\\text{ss}}$ and $\\theta_B^{\\text{ss}}$. Let's denote $\\theta_A^{\\text{ss}}$ as $\\theta_A$ and $\\theta_B^{\\text{ss}}$ as $\\theta_B$ for simplicity. These equations are formed by substituting the expressions for $C_A$, $C_B$, and $\\theta_*$ back into the steady-state site balance equations:\n$$\nf_1(\\theta_A, \\theta_B) = k_{A,\\text{ads}} \\left(C_{A,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}}{\\dot{V}} \\theta_A \\theta_B\\right) RT (1-\\theta_A-\\theta_B) - k_{A,\\text{des}} \\theta_A - k_{\\text{rxn}} \\theta_A \\theta_B = 0\n$$\n$$\nf_2(\\theta_A, \\theta_B) = k_{B,\\text{ads}} \\left(C_{B,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}}{\\dot{V}} \\theta_A \\theta_B\\right) RT (1-\\theta_A-\\theta_B) - k_{B,\\text{des}} \\theta_B - k_{\\text{rxn}} \\theta_A \\theta_B = 0\n$$\nThis system must be solved numerically. For each test case, we first compute the inlet concentrations $C_{i,\\text{in}} = y_{i,\\text{in}} P_{\\text{tot}}/(R T)$ and the temperature-dependent rate constants $k(T)$. Then, a numerical root-finding algorithm is employed to find the values of $\\theta_A$ and $\\theta_B$ that simultaneously satisfy $f_1=0$ and $f_2=0$, subject to the physical constraints $0 \\le \\theta_A, 0 \\le \\theta_B$, and $\\theta_A + \\theta_B \\le 1$.\n\nOnce the steady-state coverages $\\theta_A^{\\text{ss}}$ and $\\theta_B^{\\text{ss}}$ are determined, the steady-state outlet concentration of $P$ can be calculated. The problem asks for the outlet molar flow rate of $P$, $F_{P,\\text{out}}$, which is given by:\n$$\nF_{P,\\text{out}} = \\dot{V} C_P^{\\text{ss}} = \\dot{V} \\left( \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}} \\right) = \\sigma S k_{\\text{rxn}}(T) \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\nThis final expression gives the total molar rate of product formation from the catalyst surface, which, at steady state, must equal the molar flow rate of the product exiting the reactor.\nThe computational procedure is as follows:\n1. For each test case, parse the parameters $T$, $y_{A,\\text{in}}$, $y_{B,\\text{in}}$, and $S$.\n2. Handle trivial cases: if $S=0$ (no catalyst) or if either $y_{A,\\text{in}}=0$ or $y_{B,\\text{in}}=0$ (no reactant), the reaction rate is zero, so $F_{P,\\text{out}} = 0$.\n3. For non-trivial cases, calculate the rate constants and inlet concentrations.\n4. Define a function representing the system of two non-linear equations, $f_1$ and $f_2$.\n5. Use a numerical solver, such as `scipy.optimize.root`, to find the coverages $(\\theta_A, \\theta_B)$.\n6. Calculate $F_{P,\\text{out}}$ using the solved coverages.\n7. Collect the results for all test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state outlet molar flow rate of product P in a catalytic CSTR.\n    \"\"\"\n\n    # --- Global Constants ---\n    R = 8.314462618  # J mol^-1 K^-1\n    P_tot = 100000.0  # Pa\n    V_reactor = 0.01  # m^3\n    V_dot = 0.01      # m^3 s^-1\n    sigma = 2e-5      # mol m^-2\n\n    # --- Arrhenius Parameters (A [various], E_a [J mol^-1]) ---\n    arrhenius_params = {\n        'A_ads': {'A': 2e-5, 'Ea': 5000.0},   # s^-1 Pa^-1\n        'A_des': {'A': 1e5,  'Ea': 80000.0},  # s^-1\n        'B_ads': {'A': 1e-5, 'Ea': 4000.0},   # s^-1 Pa^-1\n        'B_des': {'A': 5e4,  'Ea': 90000.0},  # s^-1\n        'rxn':   {'A': 1e3,  'Ea': 120000.0}  # s^-1\n    }\n\n    # --- Test Cases ---\n    test_cases = [\n        {'T': 700.0, 'y_A_in': 0.4, 'y_B_in': 0.4, 'S': 5.0}, # Case 1\n        {'T': 700.0, 'y_A_in': 0.8, 'y_B_in': 0.0, 'S': 5.0}, # Case 2\n        {'T': 900.0, 'y_A_in': 0.5, 'y_B_in': 0.5, 'S': 5.0}, # Case 3\n        {'T': 500.0, 'y_A_in': 0.5, 'y_B_in': 0.5, 'S': 5.0}, # Case 4\n        {'T': 700.0, 'y_A_in': 0.4, 'y_B_in': 0.4, 'S': 0.0}, # Case 5\n    ]\n\n    results = []\n\n    def calculate_rate_constants(T, params):\n        k = {}\n        for key, p in params.items():\n            k[key] = p['A'] * np.exp(-p['Ea'] / (R * T))\n        return k\n\n    for case in test_cases:\n        T = case['T']\n        y_A_in = case['y_A_in']\n        y_B_in = case['y_B_in']\n        S = case['S']\n\n        # Handle trivial cases where no reaction can occur\n        if S == 0.0 or y_A_in == 0.0 or y_B_in == 0.0:\n            results.append(0.0)\n            continue\n\n        # --- Calculate case-specific parameters ---\n        k = calculate_rate_constants(T, arrhenius_params)\n        k_A_ads, k_A_des = k['A_ads'], k['A_des']\n        k_B_ads, k_B_des = k['B_ads'], k['B_des']\n        k_rxn = k['rxn']\n        \n        # Inlet concentrations from mole fractions\n        RT = R * T\n        C_A_in = y_A_in * P_tot / RT\n        C_B_in = y_B_in * P_tot / RT\n\n        def residuals(theta_vec):\n            theta_A, theta_B = theta_vec\n\n            # Physicality checks for solver robustness\n            if theta_A < 0.0 or theta_B < 0.0 or (theta_A + theta_B) > 1.0:\n                return [1e6, 1e6]  # Large penalty for non-physical region\n\n            # Coupling term between surface reaction and gas concentrations\n            gen_term = (sigma * S / V_dot) * k_rxn * theta_A * theta_B\n            \n            C_A = C_A_in - gen_term\n            C_B = C_B_in - gen_term\n\n            if C_A < 0.0 or C_B < 0.0:\n                return [1e6, 1e6] # Large penalty if reactant is over-consumed\n\n            p_A = C_A * RT\n            p_B = C_B * RT\n\n            theta_star = 1.0 - theta_A - theta_B\n            r_rxn_per_site = k_rxn * theta_A * theta_B\n            \n            # --- Steady-state site balance equations ---\n            # d(theta_A)/dt = 0\n            res1 = k_A_ads * p_A * theta_star - k_A_des * theta_A - r_rxn_per_site\n            # d(theta_B)/dt = 0\n            res2 = k_B_ads * p_B * theta_star - k_B_des * theta_B - r_rxn_per_site\n            \n            return [res1, res2]\n\n        # --- Solve for steady-state coverages ---\n        # Initial guess for coverages (small, physically plausible values)\n        initial_guess = [0.1, 0.1]\n        solution = root(residuals, initial_guess, method='hybr')\n\n        F_P_out = 0.0\n        if solution.success:\n            theta_A_ss, theta_B_ss = solution.x\n            # Final check of physical solution\n            if theta_A_ss >= 0 and theta_B_ss >= 0 and (theta_A_ss + theta_B_ss) <= 1.0:\n                # Calculate outlet molar flow rate of P\n                F_P_out = sigma * S * k_rxn * theta_A_ss * theta_B_ss\n        \n        results.append(F_P_out)\n\n    # Format the final output\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond isothermal assumptions, this exercise delves into the critical interplay between reaction kinetics and thermal effects by modeling an adiabatic CSTR. You will set up and solve the coupled mass and energy balance equations to determine the reactor's operating temperature and conversion. The key challenge in this practice  is to go beyond deterministic prediction by applying the Monte Carlo method, a powerful computational technique to quantify how uncertainties in thermophysical data, such as the heat capacity $c_p(T)$, propagate to the final predicted temperature rise.",
            "id": "3887019",
            "problem": "A Continuous Stirred-Tank Reactor (CSTR) operating adiabatically carries out a single, irreversible, exothermic reaction in a slurry-phase catalytic system, where the kinetics follow a first-order Arrhenius law. The goal is to quantify, from first principles, how uncertainties in the Heat Capacity at Constant Pressure (C_p) correlation affect the predicted adiabatic temperature rise, using a purely algorithmic approach grounded in conservation laws. The reactor has a single feed stream at inlet temperature $T_{\\text{in}}$ with species $A$ at inlet concentration $C_{A0}$, and a single outlet stream at steady state. The mixture volumetric heat capacity is represented by a polynomial correlation $c_p(T) = a + b T + c T^2$ with uncertain coefficients. The reaction enthalpy is independent of temperature. The analysis must be based on mass and energy conservation, without assuming shortcuts beyond well-tested formulas and core definitions.\n\nFundamental base to be used:\n- Conservation of mass in a Continuous Stirred-Tank Reactor (CSTR): at steady state, the rate of consumption of species equals the difference between inlet and outlet flow of that species.\n- Conservation of energy in an adiabatic reactor: at steady state and without heat exchange with the surroundings, the enthalpy change of the stream equals the heat released by the reaction.\n- Arrhenius rate law: $k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$ where $k_0$ is the pre-exponential factor, $E$ is the activation energy, and $R$ is the Universal Gas Constant (R).\n- Residence time definition: $\\tau = \\dfrac{V}{q}$, where $V$ is the reactor volume and $q$ is the volumetric flow rate.\n- The reaction is first-order in $A$, liquid-phase, with negligible volume change and constant density.\n\nAssumptions for scientific realism:\n- Ideal, well-mixed liquid-phase reactor.\n- Single reaction with rate $r_A = -k(T) C_A$.\n- The reaction is exothermic with a constant molar reaction enthalpy $\\Delta H_r < 0$ (negative for exothermic), and we use its magnitude $H = -\\Delta H_r > 0$ for energy accounting.\n- The mixture volumetric heat capacity $c_p(T)$ is positive over the temperature range of interest.\n- The feed and product enthalpies can be computed via integrating $c_p(T)$ over temperature.\n\nTasks:\n1. Use mass conservation to express the outlet concentration $C_A(T)$ as a function of temperature for a first-order reaction at steady state in a Continuous Stirred-Tank Reactor (CSTR).\n2. Use energy conservation to set up the implicit equation that determines the adiabatic outlet temperature $T$ given the inlet temperature $T_{\\text{in}}$, the reaction enthalpy, and the $c_p(T)$ correlation.\n3. Given uncertain $c_p(T)$ coefficients, model $a$, $b$, and $c$ as independent Gaussian random variables with specified means and standard deviations. Propagate these uncertainties through the nonlinear implicit equation to quantify their impact on the predicted adiabatic temperature rise $\\Delta T = T - T_{\\text{in}}$ using a fixed-size Monte Carlo sample.\n4. For each test case, compute:\n   - The nominal adiabatic temperature rise $\\Delta T_{\\text{nom}}$ using the nominal $c_p(T)$ coefficients.\n   - The standard deviation of the Monte Carlo sample of $\\Delta T$, denoted $\\sigma_{\\Delta T}$, treating the sample as the population (i.e., divide by $N$ when computing the variance).\n5. Express all temperatures in kelvin (K), all times in seconds (s), concentrations in mol per cubic meter (mol/m^3), the reaction enthalpy in joules per mole (J/mol), and heat capacities in joules per cubic meter per kelvin (J/(m^3 K)).\n6. Use the Universal Gas Constant (R) value $R = 8.314 \\ \\text{J/(mol K)}$.\n7. Use a fixed Monte Carlo sample size of $N = 2000$ for all test cases and fix the random seed to $12345$ for reproducibility.\n8. Root finding must be robustly bracketed between $T_{\\text{in}}$ and a sufficiently high upper bound so that the energy balance has a sign change, using a deterministic algorithmic approach.\n\nTest Suite:\nProvide results for the following three parameter sets. For each set, all quantities are in SI units.\n\n- Test Case $1$ (general strongly exothermic case):\n  - $T_{\\text{in}} = 330 \\ \\text{K}$\n  - $\\tau = 150 \\ \\text{s}$\n  - $C_{A0} = 2500 \\ \\text{mol/m}^3$\n  - $k_0 = 2.00 \\times 10^6 \\ \\text{s}^{-1}$\n  - $E = 90000 \\ \\text{J/mol}$\n  - $\\Delta H_r = -120000 \\ \\text{J/mol}$ so $H = 120000 \\ \\text{J/mol}$\n  - Nominal $c_p(T)$ coefficients: $a_0 = 3.60 \\times 10^6 \\ \\text{J/(m}^3 \\text{K)}$, $b_0 = 1800 \\ \\text{J/(m}^3 \\text{K}^2)$, $c_0 = 1.50 \\ \\text{J/(m}^3 \\text{K}^3)$\n  - Uncertainty (independent Gaussian): $\\sigma_a = 0.03 a_0$, $\\sigma_b = 0.03 b_0$, $\\sigma_c = 0.03 c_0$\n\n- Test Case $2$ (boundary with short residence time and larger $c_p$ uncertainty):\n  - $T_{\\text{in}} = 300 \\ \\text{K}$\n  - $\\tau = 1.0 \\ \\text{s}$\n  - $C_{A0} = 3000 \\ \\text{mol/m}^3$\n  - $k_0 = 1.00 \\times 10^7 \\ \\text{s}^{-1}$\n  - $E = 80000 \\ \\text{J/mol}$\n  - $\\Delta H_r = -100000 \\ \\text{J/mol}$ so $H = 100000 \\ \\text{J/mol}$\n  - Nominal $c_p(T)$ coefficients: $a_0 = 3.80 \\times 10^6 \\ \\text{J/(m}^3 \\text{K)}$, $b_0 = 1500 \\ \\text{J/(m}^3 \\text{K}^2)$, $c_0 = 1.80 \\ \\text{J/(m}^3 \\text{K}^3)$\n  - Uncertainty (independent Gaussian): $\\sigma_a = 0.10 a_0$, $\\sigma_b = 0.10 b_0$, $\\sigma_c = 0.10 c_0$\n\n- Test Case $3$ (boundary with high activation energy sensitivity):\n  - $T_{\\text{in}} = 350 \\ \\text{K}$\n  - $\\tau = 200 \\ \\text{s}$\n  - $C_{A0} = 2000 \\ \\text{mol/m}^3$\n  - $k_0 = 5.00 \\times 10^8 \\ \\text{s}^{-1}$\n  - $E = 120000 \\ \\text{J/mol}$\n  - $\\Delta H_r = -80000 \\ \\text{J/mol}$ so $H = 80000 \\ \\text{J/mol}$\n  - Nominal $c_p(T)$ coefficients: $a_0 = 3.50 \\times 10^6 \\ \\text{J/(m}^3 \\text{K)}$, $b_0 = 2000 \\ \\text{J/(m}^3 \\text{K}^2)$, $c_0 = 2.20 \\ \\text{J/(m}^3 \\text{K}^3)$\n  - Uncertainty (independent Gaussian): $\\sigma_a = 0.05 a_0$, $\\sigma_b = 0.05 b_0$, $\\sigma_c = 0.05 c_0$\n\nProgram requirements:\n- Implement a deterministic algorithm that, for each test case, computes $\\Delta T_{\\text{nom}}$ and $\\sigma_{\\Delta T}$ as described.\n- The final output must be a single line containing a comma-separated list enclosed in square brackets, in the following order: $[\\Delta T_{\\text{nom,1}}, \\sigma_{\\Delta T,1}, \\Delta T_{\\text{nom,2}}, \\sigma_{\\Delta T,2}, \\Delta T_{\\text{nom,3}}, \\sigma_{\\Delta T,3}]$, with each value rounded to three decimal places.",
            "solution": "The problem is to determine the impact of uncertainty in the heat capacity correlation on the steady-state adiabatic temperature rise in a Continuous Stirred-Tank Reactor (CSTR). This requires deriving the governing conservation equations from first principles and then propagating the specified uncertainties using a Monte Carlo simulation.\n\nThe analysis begins with the fundamental conservation laws for mass and energy. We consider a single, irreversible, first-order reaction $A \\rightarrow \\text{products}$ with rate law $r_A = -k(T) C_A$.\n\n**Step 1: Mass Balance for Species A**\n\nFor a CSTR at steady state, the general mass balance equation is:\n$$\n(\\text{molar flow rate in}) - (\\text{molar flow rate out}) + (\\text{rate of generation}) = 0\n$$\nApplied to species $A$, this becomes:\n$$\nq C_{A0} - q C_A + r_A V = 0\n$$\nwhere $q$ is the volumetric flow rate, $V$ is the reactor volume, $C_{A0}$ is the inlet concentration of $A$, and $C_A$ is the outlet concentration of $A$. The rate of generation of $A$ is $r_A V$. Since $A$ is a reactant, its rate is one of consumption, given by $r_A = -k(T) C_A$. Substituting this into the balance equation:\n$$\nq C_{A0} - q C_A - k(T) C_A V = 0\n$$\nDividing by $q$ and introducing the residence time $\\tau = V/q$:\n$$\nC_{A0} - C_A - k(T) C_A \\tau = 0\n$$\nSolving for the outlet concentration $C_A$ as a function of the reactor temperature $T$:\n$$\nC_{A0} = C_A (1 + k(T) \\tau) \\implies C_A(T) = \\frac{C_{A0}}{1 + k(T) \\tau}\n$$\nThis expression fulfills Task 1. The rate constant $k(T)$ follows the Arrhenius law:\n$$\nk(T) = k_0 \\exp\\!\\left(-\\frac{E}{R T}\\right)\n$$\nwhere $k_0$ is the pre-exponential factor, $E$ is the activation energy, and $R$ is the universal gas constant.\n\n**Step 2: Energy Balance**\n\nFor an adiabatic CSTR at steady state, the energy balance equates the sensible heat absorbed by the fluid stream to the heat generated by the exothermic reaction.\n$$\n(\\text{rate of enthalpy change of stream}) = (\\text{rate of heat generated by reaction})\n$$\nThe rate of enthalpy change of the stream flowing from inlet temperature $T_{\\text{in}}$ to outlet temperature $T$ is given by:\n$$\n\\dot{H}_{\\text{stream out}} - \\dot{H}_{\\text{stream in}} = q \\int_{T_{\\text{in}}}^{T} c_p(T') dT'\n$$\nwhere $c_p(T)$ is the volumetric heat capacity of the mixture.\nThe rate of heat generated by the reaction is the product of the volumetric rate of reaction, the reactor volume, and the magnitude of the reaction enthalpy $H = -\\Delta H_r$:\n$$\n\\text{Rate of heat generation} = (-r_A) V H = (k(T) C_A) V H\n$$\nEquating the two terms:\n$$\nq \\int_{T_{\\text{in}}}^{T} c_p(T') dT' = k(T) C_A V H\n$$\nDividing by $q$ and using $\\tau = V/q$:\n$$\n\\int_{T_{\\text{in}}}^{T} c_p(T') dT' = k(T) C_A \\tau H\n$$\nFrom the mass balance, we can substitute for $k(T)C_A\\tau = (C_{A0} - C_A)$:\n$$\n\\int_{T_{\\text{in}}}^{T} c_p(T') dT' = (C_{A0} - C_A) H\n$$\nSubstituting the expression for $C_A(T)$:\n$$\nC_{A0} - C_A = C_{A0} - \\frac{C_{A0}}{1 + k(T) \\tau} = C_{A0} \\left(1 - \\frac{1}{1 + k(T) \\tau}\\right) = C_{A0} \\frac{k(T) \\tau}{1 + k(T) \\tau}\n$$\nSo, the energy balance becomes:\n$$\n\\int_{T_{\\text{in}}}^{T} c_p(T') dT' = C_{A0} H \\frac{k(T) \\tau}{1 + k(T) \\tau}\n$$\nThis is a standard representation. Let's call the left-hand side the \"heat removal\" term, $R_H(T)$, and the right-hand side the \"heat generation\" term, $G_H(T)$. The steady-state temperature $T$ is the root of the equation $f(T) = R_H(T) - G_H(T) = 0$.\n\nThe heat capacity is given by the polynomial $c_p(T) = a + b T + c T^2$. The integral for the heat removal term is:\n$$\nR_H(T) = \\int_{T_{\\text{in}}}^{T} (a + b T' + c T'^2) dT' = \\left[a T' + \\frac{b}{2} T'^2 + \\frac{c}{3} T'^3\\right]_{T_{\\text{in}}}^{T}\n$$\n$$\nR_H(T) = a(T - T_{\\text{in}}) + \\frac{b}{2}(T^2 - T_{\\text{in}}^2) + \\frac{c}{3}(T^3 - T_{\\text{in}}^3)\n$$\nTherefore, the implicit equation for $T$ (fulfilling Task 2) is:\n$$\na(T - T_{\\text{in}}) + \\frac{b}{2}(T^2 - T_{\\text{in}}^2) + \\frac{c}{3}(T^3 - T_{\\text{in}}^3) - C_{A0} H \\frac{\\tau k_0 \\exp(-E/RT)}{1 + \\tau k_0 \\exp(-E/RT)} = 0\n$$\n\n**Step 3 & 4: Numerical Solution and Uncertainty Propagation**\n\nTo solve for the reactor temperature $T$, we must find the root of the nonlinear equation $f(T) = 0$. A robust numerical root-finding algorithm, such as the Brent-Dekker method (`brentq`), is suitable. A valid bracket for the root is required. At $T = T_{\\text{in}}$, the heat removal term $R_H(T_{\\text{in}}) = 0$, while the heat generation term $G_H(T_{\\text{in}}) > 0$, so $f(T_{\\text{in}}) < 0$. For a sufficiently large temperature $T_{\\text{upper}}$, the heat removal term $R_H(T)$, which grows cubically with $T$, will exceed the heat generation term $G_H(T)$, which saturates at $C_{A0} H$. Thus, $f(T_{\\text{upper}}) > 0$. A physically motivated interval $[T_{\\text{in}}, T_{\\text{in}} + 500]$ provides a safe bracket.\n\nThe uncertainty in the heat capacity coefficients $a$, $b$, and $c$ is propagated to the adiabatic temperature rise $\\Delta T = T - T_{\\text{in}}$ via a Monte Carlo simulation. The procedure is as follows:\n1.  **Nominal Solution**: Solve $f(T)=0$ using the nominal coefficients $(a_0, b_0, c_0)$ to find the nominal temperature $T_{\\text{nom}}$. The nominal temperature rise is $\\Delta T_{\\text{nom}} = T_{\\text{nom}} - T_{\\text{in}}$.\n2.  **Monte Carlo Simulation**:\n    a. Initialize a random number generator with a fixed seed ($12345$) for reproducibility.\n    b. Generate a sample of size $N=2000$ for each coefficient from their independent Gaussian distributions: $a_i \\sim \\mathcal{N}(a_0, \\sigma_a^2)$, $b_i \\sim \\mathcal{N}(b_0, \\sigma_b^2)$, and $c_i \\sim \\mathcal{N}(c_0, \\sigma_c^2)$.\n    c. For each set of sampled coefficients $(a_i, b_i, c_i)$, solve the corresponding equation $f_i(T)=0$ to find the temperature $T_i$.\n    d. Compute the temperature rise for each sample: $\\Delta T_i = T_i - T_{\\text{in}}$. This creates a sample distribution of $\\Delta T$.\n3.  **Statistical Analysis**: From the sample of temperature rises $\\{\\Delta T_i\\}_{i=1}^N$, calculate the population standard deviation, $\\sigma_{\\Delta T}$, as requested:\n$$\n\\sigma_{\\Delta T} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\Delta T_i - \\bar{\\Delta T})^2}\n$$\nwhere $\\bar{\\Delta T}$ is the mean of the sample.\n\nThis procedure will be implemented for each of the three test cases specified in the problem statement. The final output is a list of the computed $\\Delta T_{\\text{nom}}$ and $\\sigma_{\\Delta T}$ values for each case, formatted to three decimal places.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for adiabatic temperature rise and its uncertainty in a CSTR\n    for three specified test cases.\n    \"\"\"\n    R = 8.314  # Universal Gas Constant, J/(mol K)\n    N_MC = 2000  # Monte Carlo sample size\n    RANDOM_SEED = 12345  # Fixed seed for reproducibility\n\n    test_cases = [\n        {\n            # Case 1\n            \"Tin\": 330.0, \"tau\": 150.0, \"C_A0\": 2500.0,\n            \"k0\": 2.00e6, \"E\": 90000.0, \"H\": 120000.0,\n            \"a0\": 3.60e6, \"b0\": 1800.0, \"c0\": 1.50,\n            \"sigma_a_frac\": 0.03, \"sigma_b_frac\": 0.03, \"sigma_c_frac\": 0.03,\n        },\n        {\n            # Case 2\n            \"Tin\": 300.0, \"tau\": 1.0, \"C_A0\": 3000.0,\n            \"k0\": 1.00e7, \"E\": 80000.0, \"H\": 100000.0,\n            \"a0\": 3.80e6, \"b0\": 1500.0, \"c0\": 1.80,\n            \"sigma_a_frac\": 0.10, \"sigma_b_frac\": 0.10, \"sigma_c_frac\": 0.10,\n        },\n        {\n            # Case 3\n            \"Tin\": 350.0, \"tau\": 200.0, \"C_A0\": 2000.0,\n            \"k0\": 5.00e8, \"E\": 120000.0, \"H\": 80000.0,\n            \"a0\": 3.50e6, \"b0\": 2000.0, \"c0\": 2.20,\n            \"sigma_a_frac\": 0.05, \"sigma_b_frac\": 0.05, \"sigma_c_frac\": 0.05,\n        },\n    ]\n\n    results = []\n    rng = np.random.default_rng(RANDOM_SEED)\n\n    for case in test_cases:\n        Tin = case[\"Tin\"]\n        \n        # Define the implicit function to find the root T.\n        def get_balance_function(a, b, c):\n            def balance_function(T):\n                # Heat removal term, R_H(T)\n                heat_removal = (a * (T - Tin) +\n                                b/2 * (T**2 - Tin**2) +\n                                c/3 * (T**3 - Tin**3))\n\n                # Rate constant k(T)\n                k_T = case[\"k0\"] * np.exp(-case[\"E\"] / (R * T))\n\n                # Heat generation term, G_H(T)\n                heat_generation = (case[\"C_A0\"] * case[\"H\"] * case[\"tau\"] * k_T /\n                                   (1 + case[\"tau\"] * k_T))\n                \n                return heat_removal - heat_generation\n            return balance_function\n\n        def solve_for_temp(a, b, c):\n            \"\"\"Solves the energy balance for T using provided cp coefficients.\"\"\"\n            f = get_balance_function(a, b, c)\n            # A safe upper bound for temperature search\n            T_upper_bracket = Tin + 500.0\n            try:\n                T_sol = optimize.brentq(f, Tin, T_upper_bracket)\n                return T_sol\n            except ValueError:\n                # This could happen if f(Tin) and f(T_upper_bracket) have the same sign.\n                # It would indicate an issue with the bracketing or model parameters.\n                return np.nan\n\n        # 1. Calculate nominal temperature rise\n        a0, b0, c0 = case[\"a0\"], case[\"b0\"], case[\"c0\"]\n        T_nom = solve_for_temp(a0, b0, c0)\n        delta_T_nom = T_nom - Tin\n\n        # 2. Perform Monte Carlo simulation\n        sigma_a = case[\"sigma_a_frac\"] * a0\n        sigma_b = case[\"sigma_b_frac\"] * b0\n        sigma_c = case[\"sigma_c_frac\"] * c0\n        \n        a_samples = rng.normal(a0, sigma_a, N_MC)\n        b_samples = rng.normal(b0, sigma_b, N_MC)\n        c_samples = rng.normal(c0, sigma_c, N_MC)\n        \n        delta_T_samples = np.zeros(N_MC)\n        for i in range(N_MC):\n            T_i = solve_for_temp(a_samples[i], b_samples[i], c_samples[i])\n            delta_T_samples[i] = T_i - Tin\n            \n        # 3. Calculate standard deviation of Delta T\n        # ddof=0 for population standard deviation as requested\n        sigma_delta_T = np.std(delta_T_samples, ddof=0)\n        \n        # Append formatted results\n        results.append(f\"{delta_T_nom:.3f}\")\n        results.append(f\"{sigma_delta_T:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This advanced practice provides a hands-on experience in multi-scale modeling, a paradigm that connects quantum-level calculations to macroscopic reactor design. You will build a model for a Plug Flow Reactor (PFR) where the reaction rate is determined by a microkinetic scheme whose parameters, such as activation energies $E_i$, are often derived from Density Functional Theory (DFT). The exercise  introduces sensitivity analysis as an efficient method to quantify how uncertainties in these fundamental energy barriers propagate through the system of ordinary differential equations to affect the overall reactor conversion, providing a direct link between computational chemistry and process-level uncertainty.",
            "id": "3886993",
            "problem": "A catalytic conversion of species $A$ to species $B$ occurs on a solid surface through a minimal microkinetic network with a single adsorbed intermediate. The objective is to quantify how uncertainties in Density Functional Theory (DFT) activation barriers propagate through microkinetic balances to uncertainty in reactor-scale conversion, using sensitivity coefficients within the framework of mass and energy balances in chemical engineering. The program you will write must compute, for each specified test case, the standard deviation of the single-pass conversion caused by uncertainties in the activation barriers, under the assumptions given below, and report the results in a single line as described in the final output format. All conversions must be reported as dimensionless fractions.\n\nFundamental base:\n- Ideal gas, isothermal operation at constant temperature $T$ and total pressure $P_{\\mathrm{tot}}$.\n- Plug Flow Reactor (PFR) mass balance in terms of catalyst weight $W$: \n  $$\\frac{dF_A}{dW} = -r'(F_A; \\boldsymbol{k}, \\boldsymbol{\\theta}, \\boldsymbol{\\Pi}),$$\n  where $F_A$ is the molar flow rate of $A$ in $\\mathrm{mol}\\,\\mathrm{s}^{-1}$, $r'$ is the rate of consumption of $A$ per catalyst mass in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$, $\\boldsymbol{k}$ are elementary rate constants, $\\boldsymbol{\\theta}$ are surface coverages, and $\\boldsymbol{\\Pi}$ denotes operating parameters.\n- Elementary steps on the surface:\n  1. Quasi-equilibrated adsorption: $A(g) + * \\rightleftharpoons A*$, with equilibrium relation \n     $$\\theta_A = K_A P_A \\theta_*,$$\n     where $\\theta_A$ and $\\theta_*$ are the fractional coverages of $A*$ and vacant sites $*$, respectively, $K_A$ is the adsorption equilibrium constant in $\\mathrm{Pa}^{-1}$, and $P_A$ is the partial pressure of $A$ in $\\mathrm{Pa}$.\n  2. Irreversible surface reaction: $A* \\rightarrow I*$ with rate $r_1 = k_1 \\theta_A$.\n  3. Irreversible surface reaction: $I* \\rightarrow B*$ with rate $r_2 = k_2 \\theta_I$.\n  4. Irreversible desorption: $B* \\rightarrow B(g) + *$ with rate $r_3 = k_3 \\theta_B$.\n- Quasi-steady-state for the intermediates and site balance:\n  $$r_1 = r_2,\\quad r_2 = r_3,$$\n  $$\\theta_* + \\theta_A + \\theta_I + \\theta_B = 1.$$\n- Arrhenius kinetics for elementary steps:\n  $$k_i = \\nu_i \\exp\\!\\left(-\\frac{E_i}{R T}\\right),\\quad i \\in \\{1,2,3\\},$$\n  where $\\nu_i$ is the pre-exponential factor in $\\mathrm{s}^{-1}$, $E_i$ is the DFT-derived activation barrier in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $R$ is the universal gas constant in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and $T$ is temperature in $\\mathrm{K}$.\n- The mass-specific rate of $A$ consumption is related to the per-site turnover by \n  $$r' = N_s r_{\\mathrm{site}},$$\n  where $N_s$ is the number of active sites per catalyst mass in $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ and $r_{\\mathrm{site}}$ is the per-site rate of $A$ consumption in $\\mathrm{mol}\\,\\mathrm{site}^{-1}\\,\\mathrm{s}^{-1}$. Under the above microkinetic scheme, $r_{\\mathrm{site}}$ equals the common steady-state flux through the sequence.\n\nOperating assumptions:\n- The gas is dilute in $A$ with a large inert co-feed such that the total molar flow $F_{\\mathrm{tot}}$ remains approximately constant and the partial pressure satisfies \n  $$P_A(W) = P_{\\mathrm{tot}} \\frac{F_A(W)}{F_{\\mathrm{tot}}}.$$\n- The reactor is isothermal and the adsorption constant $K_A$ is independent of $W$.\n\nSensitivity and uncertainty propagation:\n- Define the single-pass conversion at reactor outlet as \n  $$X = \\frac{F_{A,0} - F_A(W_{\\mathrm{end}})}{F_{A,0}},$$\n  where $F_{A,0}$ is the inlet molar flow of $A$ and $W_{\\mathrm{end}}$ is the catalyst weight.\n- Let the activation barriers be uncertain, $E_i \\sim \\mathcal{N}(\\bar{E}_i, \\sigma_{E_i}^2)$, independent across $i$. The first-order (linear) uncertainty propagation uses the sensitivity coefficients\n  $$S_i = \\frac{\\partial X}{\\partial E_i}\\bigg|_{\\boldsymbol{E}=\\bar{\\boldsymbol{E}}},$$\n  and the variance in $X$ is approximated by \n  $$\\mathrm{Var}(X) \\approx \\sum_{i=1}^{3} S_i^2 \\,\\sigma_{E_i}^2.$$\n- For numerical estimation, use a central finite difference with step equal to the given standard deviation in energy:\n  $$S_i \\approx \\frac{X(\\bar{E}_i + \\sigma_{E_i}) - X(\\bar{E}_i - \\sigma_{E_i})}{2\\,\\sigma_{E_i}},$$\n  where $\\sigma_{E_i}$ is in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n\nTask:\n- Starting only from the above base and assumptions, derive the microkinetic steady-state relations needed to express $r_{\\mathrm{site}}$ in terms of $k_1$, $k_2$, $k_3$, $K_A$, and $P_A$, eliminate coverages using the site balance, then set up and integrate the PFR mass balance to compute $X$ for given parameters. Numerically estimate $S_i$ via central differences and report the propagated standard deviation $\\sigma_X = \\sqrt{\\mathrm{Var}(X)}$ for each test case below. All energies provided in the test suite are in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ and must be converted to $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ before use. Report each $\\sigma_X$ as a decimal fraction (dimensionless).\n\nTest suite:\n- Case $1$ (general case):\n  - $\\bar{E}_1 = 60\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\bar{E}_2 = 55\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\bar{E}_3 = 80\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n  - $\\sigma_{E_1} = 3\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\sigma_{E_2} = 3\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\sigma_{E_3} = 3\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n  - $T = 600\\,\\mathrm{K}$, $P_{\\mathrm{tot}} = 1.0\\times 10^{5}\\,\\mathrm{Pa}$, $F_{\\mathrm{tot}} = 10.0\\,\\mathrm{mol}\\,\\mathrm{s}^{-1}$, $F_{A,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{s}^{-1}$, $W_{\\mathrm{end}} = 1.0\\,\\mathrm{kg}$.\n  - $\\nu_1 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $\\nu_2 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $\\nu_3 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$.\n  - $K_A = 1.0\\times 10^{-5}\\,\\mathrm{Pa}^{-1}$, $N_s = 1.0\\times 10^{-7}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$.\n- Case $2$ (high temperature, reduced catalyst weight to avoid complete conversion):\n  - Same as Case $1$ except $T = 800\\,\\mathrm{K}$ and $W_{\\mathrm{end}} = 0.05\\,\\mathrm{kg}$.\n- Case $3$ (low temperature boundary):\n  - Same as Case $1$ except $T = 450\\,\\mathrm{K}$.\n- Case $4$ (strong adsorption edge case):\n  - Same as Case $1$ except $K_A = 1.0\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$.\n\nNumerical requirements:\n- Integrate the PFR ordinary differential equation for $F_A(W)$ from $W=0$ to $W=W_{\\mathrm{end}}$; terminate integration early if $F_A$ reaches $0$.\n- Use the universal gas constant $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- All energies must be converted from $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ to $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ before use in Arrhenius expressions and in sensitivity steps.\n- The final output must be a single line containing the list of four propagated standard deviations $\\sigma_X$ corresponding to Cases $1$ through $4$, as a comma-separated list enclosed in square brackets (for example, $[x_1,x_2,x_3,x_4]$). Each $x_i$ must be a floating-point decimal fraction.",
            "solution": "The user's request is to validate and solve a problem concerning uncertainty propagation in a catalytic plug-flow reactor model. The problem is deemed valid as it is scientifically grounded in established principles of chemical kinetics and reactor engineering, is mathematically well-posed, objective, and self-contained with all necessary parameters provided.\n\nThe solution proceeds in four stages:\n1.  Derivation of the microkinetic rate law for the catalytic reaction.\n2.  Formulation of the mass balance for the plug-flow reactor (PFR).\n3.  Specification of the numerical method for calculating reactor conversion.\n4.  Description of the uncertainty propagation analysis using sensitivity coefficients.\n\n**1. Derivation of the Microkinetic Rate Law**\n\nThe problem defines a sequence of elementary steps on a catalyst surface. The overall rate of reaction is governed by the steady-state flux through this sequence. We are given:\n- Quasi-equilibrated adsorption of reactant $A$: $A(g) + * \\rightleftharpoons A*$. The surface coverage of adsorbed $A$, $\\theta_A$, is related to the vacant site coverage, $\\theta_*$, and the partial pressure of $A$, $P_A$, by the equilibrium expression:\n  $$ \\theta_A = K_A P_A \\theta_* $$\n- A series of irreversible surface reactions: $A* \\xrightarrow{r_1} I* \\xrightarrow{r_2} B* \\xrightarrow{r_3} B(g) + *$.\n- The rates of these steps are given by $r_1 = k_1 \\theta_A$, $r_2 = k_2 \\theta_I$, and $r_3 = k_3 \\theta_B$.\n- The system is at a quasi-steady-state, meaning the net rate of formation for each surface intermediate ($I*$ and $B*$) is zero. Since the reactions are irreversible, this implies the rates of all consecutive steps are equal to the overall per-site rate of reaction, which we denote as $r_{\\mathrm{site}}$ (in units of $\\mathrm{mol}\\,\\mathrm{site}^{-1}\\,\\mathrm{s}^{-1}$ or simply $\\mathrm{s}^{-1}$):\n  $$ r_{\\mathrm{site}} = r_1 = r_2 = r_3 $$\n- The sum of all fractional surface coverages must equal unity (site balance):\n  $$ \\theta_* + \\theta_A + \\theta_I + \\theta_B = 1 $$\n\nWe can express each coverage in terms of $r_{\\mathrm{site}}$ and fundamental constants. First, from the rate expressions:\n$$ \\theta_A = \\frac{r_{\\mathrm{site}}}{k_1}, \\quad \\theta_I = \\frac{r_{\\mathrm{site}}}{k_2}, \\quad \\theta_B = \\frac{r_{\\mathrm{site}}}{k_3} $$\nNext, we use the adsorption equilibrium to relate $r_{\\mathrm{site}}$ to $\\theta_*$. Substituting $\\theta_A = r_{\\mathrm{site}}/k_1$ into the equilibrium expression gives:\n$$ \\frac{r_{\\mathrm{site}}}{k_1} = K_A P_A \\theta_* \\implies \\theta_* = \\frac{r_{\\mathrm{site}}}{k_1 K_A P_A} $$\nNow, We substitute all coverage expressions into the site balance equation:\n$$ \\frac{r_{\\mathrm{site}}}{k_1 K_A P_A} + \\frac{r_{\\mathrm{site}}}{k_1} + \\frac{r_{\\mathrm{site}}}{k_2} + \\frac{r_{\\mathrm{site}}}{k_3} = 1 $$\nSolving for $r_{\\mathrm{site}}$ by factoring it out:\n$$ r_{\\mathrm{site}} \\left( \\frac{1}{k_1 K_A P_A} + \\frac{1}{k_1} + \\frac{1}{k_2} + \\frac{1}{k_3} \\right) = 1 $$\nMultiplying the term in parentheses by $k_1 K_A P_A / k_1 K_A P_A$ to clear the first fraction:\n$$ r_{\\mathrm{site}} \\frac{1 + K_A P_A + \\frac{k_1 K_A P_A}{k_2} + \\frac{k_1 K_A P_A}{k_3}}{k_1 K_A P_A} = 1 $$\nFinally, rearranging for $r_{\\mathrm{site}}$ yields the explicit rate law:\n$$ r_{\\mathrm{site}} = \\frac{k_1 K_A P_A}{1 + K_A P_A \\left( 1 + \\frac{k_1}{k_2} + \\frac{k_1}{k_3} \\right)} $$\nThe rate constants $k_i$ are functions of temperature $T$ and their respective activation barriers $E_i$ via the Arrhenius equation: $k_i = \\nu_i \\exp(-E_i / (RT))$.\n\n**2. Plug-Flow Reactor (PFR) Mass Balance**\n\nThe PFR mass balance for reactant $A$ is given by:\n$$ \\frac{dF_A}{dW} = -r' $$\nwhere $F_A$ is the molar flow rate of $A$, $W$ is the catalyst mass, and $r'$ is the mass-specific rate of reaction. The rate $r'$ is related to the per-site rate $r_{\\mathrm{site}}$ by the density of active sites, $N_s$:\n$$ r' = N_s \\, r_{\\mathrm{site}} $$\nUnder the assumption of a dilute system with a large inert co-feed, the total molar flow rate $F_{\\mathrm{tot}}$ is approximately constant. This allows the partial pressure of $A$ to be expressed as:\n$$ P_A(W) = P_{\\mathrm{tot}} \\frac{F_A(W)}{F_{\\mathrm{tot}}} $$\nSubstituting the expressions for $r'$ and $P_A$ into the mass balance gives the ordinary differential equation (ODE) to be solved:\n$$ \\frac{dF_A}{dW} = -N_s \\frac{k_1 K_A \\left(P_{\\mathrm{tot}} \\frac{F_A}{F_{\\mathrm{tot}}}\\right)}{1 + K_A \\left(P_{\\mathrm{tot}} \\frac{F_A}{F_{\\mathrm{tot}}}\\right) \\left( 1 + \\frac{k_1}{k_2} + \\frac{k_1}{k_3} \\right)} $$\nThis ODE describes how the molar flow rate of $A$ changes along the length of the reactor (represented by catalyst weight $W$).\n\n**3. Numerical Solution for Conversion**\n\nTo find the reactor conversion, $X$, we must first determine the outlet molar flow rate of $A$, $F_A(W_{\\mathrm{end}})$. This requires numerically integrating the PFR mass balance ODE from the reactor inlet ($W=0$, where $F_A(0) = F_{A,0}$) to the outlet ($W=W_{\\mathrm{end}}$). A numerical ODE solver, such as `scipy.integrate.solve_ivp`, is used for this purpose. The integration is performed until $W=W_{\\mathrm{end}}$ or until $F_A$ becomes zero, whichever occurs first. Once $F_A(W_{\\mathrm{end}})$ is obtained, the single-pass conversion is calculated as:\n$$ X = \\frac{F_{A,0} - F_A(W_{\\mathrm{end}})}{F_{A,0}} $$\n\n**4. Uncertainty Propagation and Sensitivity Analysis**\n\nThe activation barriers $E_i$ are given as uncertain parameters with mean values $\\bar{E}_i$ and standard deviations $\\sigma_{E_i}$. We use first-order uncertainty propagation to estimate the variance in the output conversion, $\\mathrm{Var}(X)$. This approximation is given by:\n$$ \\mathrm{Var}(X) \\approx \\sum_{i=1}^{3} \\left( \\frac{\\partial X}{\\partial E_i} \\right)^2 \\sigma_{E_i}^2 = \\sum_{i=1}^{3} S_i^2 \\sigma_{E_i}^2 $$\nwhere $S_i$ are the sensitivity coefficients evaluated at the mean values of the activation barriers, $\\boldsymbol{E}=\\bar{\\boldsymbol{E}}$. These sensitivities are estimated numerically using a central finite difference scheme:\n$$ S_i \\approx \\frac{X(\\bar{E}_i + \\sigma_{E_i}) - X(\\bar{E}_i - \\sigma_{E_i})}{2\\sigma_{E_i}} $$\nTo compute $S_i$, the entire PFR simulation to find $X$ is performed twice for each barrier $E_i$: once with $E_i$ perturbed upwards by $\\sigma_{E_i}$ and once with it perturbed downwards by $\\sigma_{E_i}$, while all other parameters are held at their mean values. After calculating all three sensitivities ($S_1, S_2, S_3$), the standard deviation of the conversion, $\\sigma_X$, is computed as the square root of the variance:\n$$ \\sigma_X = \\sqrt{\\mathrm{Var}(X)} $$\nThe computational algorithm involves a helper function that computes $X$ for a given vector of activation energies $[E_1, E_2, E_3]$. This function is called repeatedly with perturbed energy vectors to calculate the finite differences for each $S_i$. The final value $\\sigma_X$ is then assembled for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Validates and solves a problem on uncertainty propagation in a catalytic reactor.\n    The function calculates the standard deviation of reactor conversion due to\n    uncertainties in activation barriers for four different test cases.\n    \"\"\"\n\n    # Universal Gas Constant\n    R = 8.314462618  # J mol^-1 K^-1\n\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {  # Case 1: General case\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 600.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 1.0,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-5, \"Ns\": 1.0e-7\n        },\n        {  # Case 2: High temperature, reduced catalyst weight\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 800.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 0.05,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-5, \"Ns\": 1.0e-7\n        },\n        {  # Case 3: Low temperature boundary\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 450.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 1.0,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-5, \"Ns\": 1.0e-7\n        },\n        {  # Case 4: Strong adsorption edge case\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 600.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 1.0,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-4, \"Ns\": 1.0e-7\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current case\n        T = case[\"T\"]\n        P_tot = case[\"P_tot\"]\n        F_tot = case[\"F_tot\"]\n        FA0 = case[\"FA0\"]\n        W_end = case[\"W_end\"]\n        nus = case[\"nus\"]\n        K_A = case[\"K_A\"]\n        Ns = case[\"Ns\"]\n\n        # Convert energies from kJ/mol to J/mol\n        E_bars = case[\"E_bars_kJ\"] * 1000.0\n        sigma_Es = case[\"sigma_Es_kJ\"] * 1000.0\n\n        def calculate_conversion(energies):\n            \"\"\"\n            Calculates the reactor conversion for a given set of activation energies.\n            \n            Args:\n                energies (np.ndarray): Array of activation barriers [E1, E2, E3] in J/mol.\n            \n            Returns:\n                float: The single-pass conversion X (dimensionless fraction).\n            \"\"\"\n            # Calculate Arrhenius rate constants\n            k = nus * np.exp(-energies / (R * T))\n            k1, k2, k3 = k[0], k[1], k[2]\n\n            # Define the ODE for the PFR mass balance\n            def pfr_ode(W, F_A_arr):\n                F_A = F_A_arr[0]\n                if F_A <= 1e-15:  # Handle near-zero flow to prevent numerical issues\n                    return 0.0\n                \n                P_A = P_tot * F_A / F_tot\n                \n                # Rate law calculation\n                denominator = 1.0 + K_A * P_A * (1.0 + k1 / k2 + k1 / k3)\n                r_site = (k1 * K_A * P_A) / denominator\n                r_prime = Ns * r_site\n                \n                return -r_prime\n\n            # Event to stop integration if F_A reaches zero\n            def zero_crossing_event(W, F_A_arr):\n                return F_A_arr[0]\n            zero_crossing_event.terminal = True\n            zero_crossing_event.direction = -1\n\n            # Integrate the ODE\n            sol = solve_ivp(\n                pfr_ode,\n                (0, W_end),\n                [FA0],\n                events=zero_crossing_event,\n                dense_output=True,\n                rtol=1e-8,\n                atol=1e-10\n            )\n\n            # Determine final molar flow and calculate conversion\n            F_A_end = sol.sol(W_end)[0]\n            if F_A_end < 0:\n                F_A_end = 0.0\n                \n            X = (FA0 - F_A_end) / FA0\n            return X\n\n        # Calculate sensitivities using central finite differences\n        sensitivities = []\n        for i in range(len(E_bars)):\n            # Perturb E_i up\n            E_plus = np.copy(E_bars)\n            E_plus[i] += sigma_Es[i]\n            X_plus = calculate_conversion(E_plus)\n\n            # Perturb E_i down\n            E_minus = np.copy(E_bars)\n            E_minus[i] -= sigma_Es[i]\n            X_minus = calculate_conversion(E_minus)\n\n            # Sensitivity coefficient S_i\n            S_i = (X_plus - X_minus) / (2.0 * sigma_Es[i])\n            sensitivities.append(S_i)\n\n        # Calculate variance and standard deviation of conversion\n        variance_X = sum(S_i**2 * sigma_E**2 for S_i, sigma_E in zip(sensitivities, sigma_Es))\n        sigma_X = np.sqrt(variance_X)\n        \n        results.append(sigma_X)\n\n    # Print the final list of standard deviations\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}