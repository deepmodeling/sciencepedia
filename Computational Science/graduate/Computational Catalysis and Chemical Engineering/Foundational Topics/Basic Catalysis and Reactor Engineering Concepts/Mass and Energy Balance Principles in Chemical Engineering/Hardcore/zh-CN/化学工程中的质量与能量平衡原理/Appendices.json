{
    "hands_on_practices": [
        {
            "introduction": "建立反应器模型是多相催化的核心任务之一。本练习将指导你为一个典型的连续搅拌釜反应器（CSTR）建立稳态模型，该模型结合了气相组分的质量平衡和催化剂表面的位点平衡。通过解决这个  问题，你将掌握构建和求解代表反应器稳态的非线性代数方程组的关键技能，这是理解气相条件与表面动力学之间耦合作用的基础。",
            "id": "3887008",
            "problem": "考虑一个模拟为连续搅拌釜反应器（CSTR）的均匀混合气固催化系统。气体由组分 $A$、$B$ 和 $P$ 组成，总压为 $P_{\\text{tot}}$，以恒定的体积流率 $\\dot{V}$ 通过一个体积为 $V$ 的反应器。一种表面积为 $S$、位点密度为 $\\sigma$ 的固体催化剂为 $A$ 和 $B$ 提供吸附位点，从而实现一个 Langmuir–Hinshelwood 表面反应，该反应直接在气相中生成 $P$。反应器在温度 $T$ 下等温运行。气体是理想的，并由理想气体定律（IGL）描述：$p_i = C_i R T$，其中 $p_i$ 是组分 $i$ 的分压，$C_i$ 是组分 $i$ 的摩尔浓度，$R$ 是理想气体常数，$T$ 是开尔文温度。动力学遵循平均场微观动力学，位点平衡为 $\\sum_j \\theta_j = 1$，其中位点类型 $j \\in \\{*, A, B\\}$，$*$ 表示空位点，$\\theta_j$ 是分数覆盖率。\n\n$A$ 和 $B$ 的吸附和解吸步骤是可逆的。净表面反应消耗一个吸附的 $A$ 和一个吸附的 $B$，生成一个气相的 $P$ 和两个空位点，表示为 $A* + B* \\rightarrow P(g) + * + *$。速率常数遵循阿伦尼乌斯型温度依赖关系。假设以下经过充分检验的物理基础：\n- CSTR 中的物种守恒：对于每种气体组分 $i$，瞬态质量平衡为 $dC_i/dt = (\\dot{V}/V)(C_{i,\\text{in}} - C_i) + (\\text{组分 }i\\text{ 的界面源})/V$，其中 $C_{i,\\text{in}}$ 是入口浓度。\n- 平均场位点平衡和动力学：$d\\theta_A/dt = r_{A,\\text{ads}} - r_{A,\\text{des}} - r_{\\text{rxn}}$，$d\\theta_B/dt = r_{B,\\text{ads}} - r_{B,\\text{des}} - r_{\\text{rxn}}$，以及 $\\theta_* = 1 - \\theta_A - \\theta_B$。界面源通过将单位点速率乘以总位点数 $N_{\\text{sites}} = \\sigma S$ 来计算。\n- 速率常数的阿伦尼乌斯表达式：$k(T) = A \\exp(-E_a/(R T))$。\n\n你的任务是在上述假设下，为气体组分和表面覆盖率建立耦合的质量平衡方程，并为一组给定的参数计算 $P$ 的稳态出口摩尔流率。吸附-解吸和反应步骤如下：\n- $A$ 的吸附：$r_{A,\\text{ads}} = k_{A,\\text{ads}}(T) \\, p_A \\, \\theta_*$。\n- $A$ 的解吸：$r_{A,\\text{des}} = k_{A,\\text{des}}(T) \\, \\theta_A$。\n- $B$ 的吸附：$r_{B,\\text{ads}} = k_{B,\\text{ads}}(T) \\, p_B \\, \\theta_*$。\n- $B$ 的解吸：$r_{B,\\text{des}} = k_{B,\\text{des}}(T) \\, \\theta_B$。\n- 表面反应：$r_{\\text{rxn}} = k_{\\text{rxn}}(T) \\, \\theta_A \\, \\theta_B$。\n\n使用 $R = 8.314462618 \\, \\text{J} \\, \\text{mol}^{-1} \\, \\text{K}^{-1}$，$P_{\\text{tot}} = 100000 \\, \\text{Pa}$，$V = 0.01 \\, \\text{m}^3$，$\\dot{V} = 0.01 \\, \\text{m}^3 \\, \\text{s}^{-1}$，$\\sigma = 2 \\times 10^{-5} \\, \\text{mol} \\, \\text{m}^{-2}$。对于阿伦尼乌斯参数，请使用以下指前因子和活化能：\n- $A_{A,\\text{ads}} = 2 \\times 10^{-5} \\, \\text{s}^{-1} \\, \\text{Pa}^{-1}$，$E_{A,\\text{ads}} = 5000 \\, \\text{J} \\, \\text{mol}^{-1}$。\n- $A_{A,\\text{des}} = 1 \\times 10^{5} \\, \\text{s}^{-1}$，$E_{A,\\text{des}} = 80000 \\, \\text{J} \\, \\text{mol}^{-1}$。\n- $A_{B,\\text{ads}} = 1 \\times 10^{-5} \\, \\text{s}^{-1} \\, \\text{Pa}^{-1}$，$E_{B,\\text{ads}} = 4000 \\, \\text{J} \\, \\text{mol}^{-1}$。\n- $A_{B,\\text{des}} = 5 \\times 10^{4} \\, \\text{s}^{-1}$，$E_{B,\\text{des}} = 90000 \\, \\text{J} \\, \\text{mol}^{-1}$。\n- $A_{\\text{rxn}} = 1 \\times 10^{3} \\, \\text{s}^{-1}$，$E_{\\text{rxn}} = 120000 \\, \\text{J} \\, \\text{mol}^{-1}$。\n\n入口由摩尔分数 $y_{A,\\text{in}}$、$y_{B,\\text{in}}$ 和 $y_{P,\\text{in}} = 0$ 指定，惰性气体 $I$ 的摩尔分数为 $y_{I,\\text{in}} = 1 - y_{A,\\text{in}} - y_{B,\\text{in}} - y_{P,\\text{in}}$。使用 $C_{i,\\text{in}} = y_{i,\\text{in}} P_{\\text{tot}}/(R T)$ 将入口摩尔分数转换为浓度。目标是计算 $P$ 的稳态出口摩尔流率 $F_{P,\\text{out}} = \\dot{V} \\, C_P^{\\text{ss}}$，单位为 $\\text{mol} \\, \\text{s}^{-1}$。\n\n测试套件：\n- 情况 1：$T = 700 \\, \\text{K}$，$y_{A,\\text{in}} = 0.4$，$y_{B,\\text{in}} = 0.4$，$S = 5.0 \\, \\text{m}^2$。\n- 情况 2：$T = 700 \\, \\text{K}$，$y_{A,\\text{in}} = 0.8$，$y_{B,\\text{in}} = 0.0$，$S = 5.0 \\, \\text{m}^2$。\n- 情况 3：$T = 900 \\, \\text{K}$，$y_{A,\\text{in}} = 0.5$，$y_{B,\\text{in}} = 0.5$，$S = 5.0 \\, \\text{m}^2$。\n- 情况 4：$T = 500 \\, \\text{K}$，$y_{A,\\text{in}} = 0.5$，$y_{B,\\text{in}} = 0.5$，$S = 5.0 \\, \\text{m}^2$。\n- 情况 5：$T = 700 \\, \\text{K}$，$y_{A,\\text{in}} = 0.4$，$y_{B,\\text{in}} = 0.4$，$S = 0.0 \\, \\text{m}^2$。\n\n角度单位不适用。将最终的 $P$ 出口摩尔流率以 $\\text{mol} \\, \\text{s}^{-1}$ 为单位表示为实值浮点数。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_k$ 是情况 $k$ 中 $P$ 的稳态出口摩尔流率，单位为 $\\text{mol} \\, \\text{s}^{-1}$。",
            "solution": "该问题要求计算催化连续搅拌釜反应器（CSTR）中产物 $P$ 的稳态出口摩尔流率，记为 $F_{P,\\text{out}}$。解决方案需要建立并求解稳态下的质量和位点平衡方程。\n\n首先，我们建立系统的控制方程。反应器在稳态下运行，这意味着所有时间导数都等于零。\n对于所有气相组分 $i \\in \\{A, B, P\\}$，$dC_i/dt = 0$。\n对于所有表面物种 $j \\in \\{A, B\\}$，$d\\theta_j/dt = 0$。\n\n吸附、解吸和反应步骤的速率常数是温度依赖的，并使用阿伦尼乌斯方程计算：\n$$k(T) = A \\exp\\left(-\\frac{E_a}{RT}\\right)$$\n其中 $A$ 是指前因子，$E_a$ 是活化能，$R$ 是理想气体常数，$T$ 是绝对温度。\n\n催化位点的总数由 $N_{\\text{sites}} = \\sigma S$ 给出，其中 $\\sigma$ 是位点密度，$S$ 是催化剂表面积。\n\n$A$ 和 $B$ 物种的分数表面覆盖率的稳态平衡方程为：\n$$\n\\frac{d\\theta_A}{dt} = r_{A,\\text{ads}} - r_{A,\\text{des}} - r_{\\text{rxn}} = 0\n$$\n$$\n\\frac{d\\theta_B}{dt} = r_{B,\\text{ads}} - r_{B,\\text{des}} - r_{\\text{rxn}} = 0\n$$\n其中 $r_{i,\\text{ads}}$、$r_{i,\\text{des}}$ 和 $r_{\\text{rxn}}$ 是单位点速率。代入给定的速率表达式：\n$$\nk_{A,\\text{ads}}(T) \\, p_A \\, \\theta_* - k_{A,\\text{des}}(T) \\, \\theta_A - k_{\\text{rxn}}(T) \\, \\theta_A \\, \\theta_B = 0\n$$\n$$\nk_{B,\\text{ads}}(T) \\, p_B \\, \\theta_* - k_{B,\\text{des}}(T) \\, \\theta_B - k_{\\text{rxn}}(T) \\, \\theta_A \\, \\theta_B = 0\n$$\n空位点的覆盖率 $\\theta_*$ 通过位点平衡与吸附物种的覆盖率相关：\n$$\n\\theta_* = 1 - \\theta_A - \\theta_B\n$$\n\nCSTR 中每种气相组分 $i$ 的稳态质量平衡为：\n$$\n0 = \\frac{\\dot{V}}{V}(C_{i,\\text{in}} - C_i) + \\frac{\\mathcal{R}_i}{V}\n$$\n其中 $\\dot{V}$ 是体积流率，$V$ 是反应器体积，$C_{i,\\text{in}}$ 和 $C_i$ 是入口和出口摩尔浓度，$\\mathcal{R}_i$ 是从催化剂表面生成的组分 $i$ 的总摩尔速率，由（单位点速率）$\\times N_{\\text{sites}}$ 给出。生成速率为：\n$$\n\\mathcal{R}_A = (r_{A,\\text{des}} - r_{A,\\text{ads}}) N_{\\text{sites}}\n$$\n$$\n\\mathcal{R}_B = (r_{B,\\text{des}} - r_{B,\\text{ads}}) N_{\\text{sites}}\n$$\n$$\n\\mathcal{R}_P = r_{\\text{rxn}} N_{\\text{sites}}\n$$\n将稳态位点平衡代入 $\\mathcal{R}_A$ 和 $\\mathcal{R}_B$ 的表达式，我们发现吸附-解吸的净速率被表面反应中的消耗所平衡：\n$$\nr_{A,\\text{des}} - r_{A,\\text{ads}} = -r_{\\text{rxn}}\n$$\n$$\nr_{B,\\text{des}} - r_{B,\\text{ads}} = -r_{\\text{rxn}}\n$$\n因此，质量平衡变为：\n$$\n0 = \\frac{\\dot{V}}{V}(C_{A,\\text{in}} - C_A) - \\frac{r_{\\text{rxn}} N_{\\text{sites}}}{V} \\implies C_A = C_{A,\\text{in}} - \\frac{N_{\\text{sites}}}{\\dot{V}} r_{\\text{rxn}}\n$$\n$$\n0 = \\frac{\\dot{V}}{V}(C_{B,\\text{in}} - C_B) - \\frac{r_{\\text{rxn}} N_{\\text{sites}}}{V} \\implies C_B = C_{B,\\text{in}} - \\frac{N_{\\text{sites}}}{\\dot{V}} r_{\\text{rxn}}\n$$\n$$\n0 = \\frac{\\dot{V}}{V}(C_{P,\\text{in}} - C_P) + \\frac{r_{\\text{rxn}} N_{\\text{sites}}}{V} \\implies C_P = C_{P,\\text{in}} + \\frac{N_{\\text{sites}}}{\\dot{V}} r_{\\text{rxn}}\n$$\n给定 $C_{P,\\text{in}} = 0$，我们得到了出口浓度之间的直接关系。代入 $r_{\\text{rxn}} = k_{\\text{rxn}}(T) \\theta_A \\theta_B$：\n$$\nC_A^{\\text{ss}} = C_{A,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\n$$\nC_B^{\\text{ss}} = C_{B,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\n$$\nC_P^{\\text{ss}} = \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\n分压 $p_A$ 和 $p_B$ 通过理想气体定律 $p_i = C_i R T$ 与出口浓度相关。\n\n问题简化为求解一个包含两个未知稳态覆盖率 $\\theta_A^{\\text{ss}}$ 和 $\\theta_B^{\\text{ss}}$ 的耦合非线性代数方程组。为简单起见，我们将 $\\theta_A^{\\text{ss}}$ 记为 $\\theta_A$，将 $\\theta_B^{\\text{ss}}$ 记为 $\\theta_B$。这些方程是通过将 $C_A$、$C_B$ 和 $\\theta_*$ 的表达式代回稳态位点平衡方程而形成的：\n$$\nf_1(\\theta_A, \\theta_B) = k_{A,\\text{ads}} \\left(C_{A,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}}{\\dot{V}} \\theta_A \\theta_B\\right) RT (1-\\theta_A-\\theta_B) - k_{A,\\text{des}} \\theta_A - k_{\\text{rxn}} \\theta_A \\theta_B = 0\n$$\n$$\nf_2(\\theta_A, \\theta_B) = k_{B,\\text{ads}} \\left(C_{B,\\text{in}} - \\frac{\\sigma S k_{\\text{rxn}}}{\\dot{V}} \\theta_A \\theta_B\\right) RT (1-\\theta_A-\\theta_B) - k_{B,\\text{des}} \\theta_B - k_{\\text{rxn}} \\theta_A \\theta_B = 0\n$$\n该系统必须进行数值求解。对于每个测试用例，我们首先计算入口浓度 $C_{i,\\text{in}} = y_{i,\\text{in}} P_{\\text{tot}}/(R T)$ 和与温度相关的速率常数 $k(T)$。然后，采用数值求根算法来找到同时满足 $f_1=0$ 和 $f_2=0$ 的 $\\theta_A$ 和 $\\theta_B$ 的值，并满足物理约束条件 $0 \\le \\theta_A, 0 \\le \\theta_B$ 和 $\\theta_A + \\theta_B \\le 1$。\n\n一旦确定了稳态覆盖率 $\\theta_A^{\\text{ss}}$ 和 $\\theta_B^{\\text{ss}}$，$P$ 的稳态出口浓度就可以计算出来。问题要求的是 $P$ 的出口摩尔流率 $F_{P,\\text{out}}$，其计算公式为：\n$$\nF_{P,\\text{out}} = \\dot{V} C_P^{\\text{ss}} = \\dot{V} \\left( \\frac{\\sigma S k_{\\text{rxn}}(T)}{\\dot{V}} \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}} \\right) = \\sigma S k_{\\text{rxn}}(T) \\theta_A^{\\text{ss}} \\theta_B^{\\text{ss}}\n$$\n这个最终表达式给出了催化剂表面产物生成的总摩尔速率，在稳态下，该速率必须等于离开反应器的产物的摩尔流率。\n计算流程如下：\n1. 对于每个测试用例，解析参数 $T$、$y_{A,\\text{in}}$、$y_{B,\\text{in}}$ 和 $S$。\n2. 处理简单情况：如果 $S=0$（无催化剂）或者 $y_{A,\\text{in}}=0$ 或 $y_{B,\\text{in}}=0$（无反应物），则反应速率为零，因此 $F_{P,\\text{out}} = 0$。\n3. 对于非简单情况，计算速率常数和入口浓度。\n4. 定义一个表示两个非线性方程组 $f_1$ 和 $f_2$ 的函数。\n5. 使用数值求解器，如 `scipy.optimize.root`，来求解覆盖率 $(\\theta_A, \\theta_B)$。\n6. 使用求解出的覆盖率计算 $F_{P,\\text{out}}$。\n7. 收集所有测试用例的结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state outlet molar flow rate of product P in a catalytic CSTR.\n    \"\"\"\n\n    # --- Global Constants ---\n    R = 8.314462618  # J mol^-1 K^-1\n    P_tot = 100000.0  # Pa\n    V_reactor = 0.01  # m^3\n    V_dot = 0.01      # m^3 s^-1\n    sigma = 2e-5      # mol m^-2\n\n    # --- Arrhenius Parameters (A [various], E_a [J mol^-1]) ---\n    arrhenius_params = {\n        'A_ads': {'A': 2e-5, 'Ea': 5000.0},   # s^-1 Pa^-1\n        'A_des': {'A': 1e5,  'Ea': 80000.0},  # s^-1\n        'B_ads': {'A': 1e-5, 'Ea': 4000.0},   # s^-1 Pa^-1\n        'B_des': {'A': 5e4,  'Ea': 90000.0},  # s^-1\n        'rxn':   {'A': 1e3,  'Ea': 120000.0}  # s^-1\n    }\n\n    # --- Test Cases ---\n    test_cases = [\n        {'T': 700.0, 'y_A_in': 0.4, 'y_B_in': 0.4, 'S': 5.0}, # Case 1\n        {'T': 700.0, 'y_A_in': 0.8, 'y_B_in': 0.0, 'S': 5.0}, # Case 2\n        {'T': 900.0, 'y_A_in': 0.5, 'y_B_in': 0.5, 'S': 5.0}, # Case 3\n        {'T': 500.0, 'y_A_in': 0.5, 'y_B_in': 0.5, 'S': 5.0}, # Case 4\n        {'T': 700.0, 'y_A_in': 0.4, 'y_B_in': 0.4, 'S': 0.0}, # Case 5\n    ]\n\n    results = []\n\n    def calculate_rate_constants(T, params):\n        k = {}\n        for key, p in params.items():\n            k[key] = p['A'] * np.exp(-p['Ea'] / (R * T))\n        return k\n\n    for case in test_cases:\n        T = case['T']\n        y_A_in = case['y_A_in']\n        y_B_in = case['y_B_in']\n        S = case['S']\n\n        # Handle trivial cases where no reaction can occur\n        if S == 0.0 or y_A_in == 0.0 or y_B_in == 0.0:\n            results.append(0.0)\n            continue\n\n        # --- Calculate case-specific parameters ---\n        k = calculate_rate_constants(T, arrhenius_params)\n        k_A_ads, k_A_des = k['A_ads'], k['A_des']\n        k_B_ads, k_B_des = k['B_ads'], k['B_des']\n        k_rxn = k['rxn']\n        \n        # Inlet concentrations from mole fractions\n        RT = R * T\n        C_A_in = y_A_in * P_tot / RT\n        C_B_in = y_B_in * P_tot / RT\n\n        def residuals(theta_vec):\n            theta_A, theta_B = theta_vec\n\n            # Physicality checks for solver robustness\n            if theta_A  0.0 or theta_B  0.0 or (theta_A + theta_B) > 1.0:\n                return [1e6, 1e6]  # Large penalty for non-physical region\n\n            # Coupling term between surface reaction and gas concentrations\n            gen_term = (sigma * S / V_dot) * k_rxn * theta_A * theta_B\n            \n            C_A = C_A_in - gen_term\n            C_B = C_B_in - gen_term\n\n            if C_A  0.0 or C_B  0.0:\n                return [1e6, 1e6] # Large penalty if reactant is over-consumed\n\n            p_A = C_A * RT\n            p_B = C_B * RT\n\n            theta_star = 1.0 - theta_A - theta_B\n            r_rxn_per_site = k_rxn * theta_A * theta_B\n            \n            # --- Steady-state site balance equations ---\n            # d(theta_A)/dt = 0\n            res1 = k_A_ads * p_A * theta_star - k_A_des * theta_A - r_rxn_per_site\n            # d(theta_B)/dt = 0\n            res2 = k_B_ads * p_B * theta_star - k_B_des * theta_B - r_rxn_per_site\n            \n            return [res1, res2]\n\n        # --- Solve for steady-state coverages ---\n        # Initial guess for coverages (small, physically plausible values)\n        initial_guess = [0.1, 0.1]\n        solution = root(residuals, initial_guess, method='hybr')\n\n        F_P_out = 0.0\n        if solution.success:\n            theta_A_ss, theta_B_ss = solution.x\n            # Final check of physical solution\n            if theta_A_ss >= 0 and theta_B_ss >= 0 and (theta_A_ss + theta_B_ss) = 1.0:\n                # Calculate outlet molar flow rate of P\n                F_P_out = sigma * S * k_rxn * theta_A_ss * theta_B_ss\n        \n        results.append(F_P_out)\n\n    # Format the final output\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了基本的质量平衡后，我们将引入能量平衡和不确定性的概念，这更贴近真实的工程挑战。绝热反应器中的放热反应涉及热量生成与流体吸热之间的精妙平衡，直接影响操作安全性和效率。本练习  将引导你使用强大的蒙特卡洛方法，来量化物理性质（如热容）的不确定性如何传递到关键的性能指标（如绝热温升）上，从而评估模型的预测风险。",
            "id": "3887019",
            "problem": "一个绝热操作的连续搅拌釜反应器（CSTR）中进行着一个单一、不可逆的放热反应。该反应在一个浆相催化体系中进行，其动力学遵循一级阿伦尼乌斯定律。目标是基于第一性原理，通过一种植根于守恒定律的纯粹算法方法，来量化恒压热容（C_p）关联式中的不确定性对预测的绝热温升的影响。该反应器有一个入口温度为$T_{\\text{in}}$、物种$A$的入口浓度为$C_{A0}$的单一进料流，以及一个处于稳态的单一出口流。混合物的体积热容由一个具有不确定系数的多项式关联式$c_p(T) = a + b T + c T^2$表示。反应焓与温度无关。分析必须基于质量和能量守恒，除了经过充分验证的公式和核心定义外，不作任何简化假设。\n\n使用的基本原理：\n- 连续搅拌釜反应器（CSTR）中的质量守恒：在稳态下，物种的消耗速率等于该物种的入口流量与出口流量之差。\n- 绝热反应器中的能量守恒：在稳态且与环境无热交换的情况下，流的焓变等于反应释放的热量。\n- 阿伦尼乌斯速率定律：$k(T) = k_0 \\exp\\!\\left(-\\dfrac{E}{R T}\\right)$，其中$k_0$是指前因子，$E$是活化能，$R$是普适气体常数（R）。\n- 停留时间定义：$\\tau = \\dfrac{V}{q}$，其中$V$是反应器体积，$q$是体积流量。\n- 反应是关于$A$的一级液相反应，体积变化可忽略，密度恒定。\n\n为确保科学真实性所作的假设：\n- 理想、混合均匀的液相反应器。\n- 单一反应，速率为$r_A = -k(T) C_A$。\n- 反应是放热的，具有恒定的摩尔反应焓$\\Delta H_r  0$（放热为负），我们在能量衡算中使用其大小$H = -\\Delta H_r > 0$。\n- 在所关注的温度范围内，混合物体积热容$c_p(T)$为正值。\n- 进料和产物焓可通过对温度积分$c_p(T)$来计算。\n\n任务：\n1. 对于连续搅拌釜反应器（CSTR）中的一级稳态反应，使用质量守恒将出口浓度$C_A(T)$表示为温度的函数。\n2. 使用能量守恒建立一个隐式方程，该方程在给定入口温度$T_{\\text{in}}$、反应焓和$c_p(T)$关联式的情况下，确定绝热出口温度$T$。\n3. 考虑到$c_p(T)$系数的不确定性，将$a$、$b$和$c$建模为具有指定均值和标准差的独立高斯随机变量。使用固定大小的蒙特卡洛样本，通过非线性隐式方程传播这些不确定性，以量化它们对预测的绝热温升$\\Delta T = T - T_{\\text{in}}$的影响。\n4. 对每个测试用例，计算：\n   - 使用名义$c_p(T)$系数计算的名义绝热温升$\\Delta T_{\\text{nom}}$。\n   - $\\Delta T$的蒙特卡洛样本的标准差，记为$\\sigma_{\\Delta T}$，将样本视为总体（即，计算方差时除以$N$）。\n5. 所有温度以开尔文（K）表示，所有时间以秒（s）表示，浓度以摩尔每立方米（mol/m^3）表示，反应焓以焦耳每摩尔（J/mol）表示，热容以焦耳每立方米每开尔文（J/(m^3 K)）表示。\n6. 使用普适气体常数（R）的值$R = 8.314 \\ \\text{J/(mol K)}$。\n7. 对所有测试用例使用固定的蒙特卡洛样本大小$N = 2000$，并为保证可复现性将随机种子固定为$12345$。\n8. 求根过程必须通过确定性算法方法，在$T_{\\text{in}}$和一个足够高的上界之间进行稳健地定界，以确保能量平衡函数有符号变化。\n\n测试套件：\n为以下三组参数提供结果。对于每组参数，所有量均采用国际单位制（SI）。\n\n- 测试用例 $1$（一般强放热情况）：\n  - $T_{\\text{in}} = 330 \\ \\text{K}$\n  - $\\tau = 150 \\ \\text{s}$\n  - $C_{A0} = 2500 \\ \\text{mol/m}^3$\n  - $k_0 = 2.00 \\times 10^6 \\ \\text{s}^{-1}$\n  - $E = 90000 \\ \\text{J/mol}$\n  - $\\Delta H_r = -120000 \\ \\text{J/mol}$，因此$H = 120000 \\ \\text{J/mol}$\n  - 名义$c_p(T)$系数：$a_0 = 3.60 \\times 10^6 \\ \\text{J/(m}^3 \\text{K)}$，$b_0 = 1800 \\ \\text{J/(m}^3 \\text{K}^2)$，$c_0 = 1.50 \\ \\text{J/(m}^3 \\text{K}^3)$\n  - 不确定性（独立高斯）：$\\sigma_a = 0.03 a_0$，$\\sigma_b = 0.03 b_0$，$\\sigma_c = 0.03 c_0$\n\n- 测试用例 $2$（短停留时间和较大$c_p$不确定性的边界情况）：\n  - $T_{\\text{in}} = 300 \\ \\text{K}$\n  - $\\tau = 1.0 \\ \\text{s}$\n  - $C_{A0} = 3000 \\ \\text{mol/m}^3$\n  - $k_0 = 1.00 \\times 10^7 \\ \\text{s}^{-1}$\n  - $E = 80000 \\ \\text{J/mol}$\n  - $\\Delta H_r = -100000 \\ \\text{J/mol}$，因此$H = 100000 \\ \\text{J/mol}$\n  - 名义$c_p(T)$系数：$a_0 = 3.80 \\times 10^6 \\ \\text{J/(m}^3 \\text{K)}$，$b_0 = 1500 \\ \\text{J/(m}^3 \\text{K}^2)$，$c_0 = 1.80 \\ \\text{J/(m}^3 \\text{K}^3)$\n  - 不确定性（独立高斯）：$\\sigma_a = 0.10 a_0$，$\\sigma_b = 0.10 b_0$，$\\sigma_c = 0.10 c_0$\n\n- 测试用例 $3$（高活化能敏感性的边界情况）：\n  - $T_{\\text{in}} = 350 \\ \\text{K}$\n  - $\\tau = 200 \\ \\text{s}$\n  - $C_{A0} = 2000 \\ \\text{mol/m}^3$\n  - $k_0 = 5.00 \\times 10^8 \\ \\text{s}^{-1}$\n  - $E = 120000 \\ \\text{J/mol}$\n  - $\\Delta H_r = -80000 \\ \\text{J/mol}$，因此$H = 80000 \\ \\text{J/mol}$\n  - 名义$c_p(T)$系数：$a_0 = 3.50 \\times 10^6 \\ \\text{J/(m}^3 \\text{K)}$，$b_0 = 2000 \\ \\text{J/(m}^3 \\text{K}^2)$，$c_0 = 2.20 \\ \\text{J/(m}^3 \\text{K}^3)$\n  - 不确定性（独立高斯）：$\\sigma_a = 0.05 a_0$，$\\sigma_b = 0.05 b_0$，$\\sigma_c = 0.05 c_0$\n\n程序要求：\n- 实现一个确定性算法，为每个测试用例计算所描述的$\\Delta T_{\\text{nom}}$和$\\sigma_{\\Delta T}$。\n- 最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，顺序如下：$[\\Delta T_{\\text{nom,1}}, \\sigma_{\\Delta T,1}, \\Delta T_{\\text{nom,2}}, \\sigma_{\\Delta T,2}, \\Delta T_{\\text{nom,3}}, \\sigma_{\\Delta T,3}]$，每个值都四舍五入到三位小数。",
            "solution": "该问题旨在确定热容关联式中的不确定性对连续搅拌釜反应器（CSTR）中稳态绝热温升的影响。这需要从第一性原理推导控制守恒方程，然后使用蒙特卡洛模拟传播指定的不确定性。\n\n分析始于质量和能量的基本守恒定律。我们考虑一个单一的、不可逆的一级反应 $A \\rightarrow \\text{产物}$，其速率定律为 $r_A = -k(T) C_A$。\n\n**步骤 1：物种A的质量平衡**\n\n对于稳态下的CSTR，通用质量平衡方程为：\n$$\n(\\text{摩尔流量输入}) - (\\text{摩尔流量输出}) + (\\text{生成速率}) = 0\n$$\n应用于物种 $A$，这变为：\n$$\nq C_{A0} - q C_A + r_A V = 0\n$$\n其中 $q$ 是体积流量，$V$ 是反应器体积，$C_{A0}$ 是 $A$ 的入口浓度，$C_A$ 是 $A$ 的出口浓度。$A$ 的生成速率是 $r_A V$。由于 $A$ 是反应物，其速率是消耗速率，由 $r_A = -k(T) C_A$ 给出。将其代入平衡方程：\n$$\nq C_{A0} - q C_A - k(T) C_A V = 0\n$$\n两边同除以 $q$ 并引入停留时间 $\\tau = V/q$：\n$$\nC_{A0} - C_A - k(T) C_A \\tau = 0\n$$\n解出作为反应器温度 $T$ 函数的出口浓度 $C_A$：\n$$\nC_{A0} = C_A (1 + k(T) \\tau) \\implies C_A(T) = \\frac{C_{A0}}{1 + k(T) \\tau}\n$$\n这个表达式完成了任务1。速率常数 $k(T)$ 遵循阿伦尼乌斯定律：\n$$\nk(T) = k_0 \\exp\\!\\left(-\\frac{E}{R T}\\right)\n$$\n其中 $k_0$ 是指前因子，$E$ 是活化能，$R$ 是普适气体常数。\n\n**步骤 2：能量平衡**\n\n对于稳态下的绝热CSTR，能量平衡将流体吸收的显热与放热反应产生的热量相等同。\n$$\n(\\text{流的焓变速率}) = (\\text{反应产热速率})\n$$\n从入口温度 $T_{\\text{in}}$ 流到出口温度 $T$ 的流的焓变速率由下式给出：\n$$\n\\dot{H}_{\\text{stream out}} - \\dot{H}_{\\text{stream in}} = q \\int_{T_{\\text{in}}}^{T} c_p(T') dT'\n$$\n其中 $c_p(T)$ 是混合物的体积热容。\n反应产生的热量速率是反应的体积速率、反应器体积和反应焓大小 $H = -\\Delta H_r$ 的乘积：\n$$\n\\text{产热速率} = (-r_A) V H = (k(T) C_A) V H\n$$\n令两项相等：\n$$\nq \\int_{T_{\\text{in}}}^{T} c_p(T') dT' = k(T) C_A V H\n$$\n两边同除以 $q$ 并使用 $\\tau = V/q$：\n$$\n\\int_{T_{\\text{in}}}^{T} c_p(T') dT' = k(T) C_A \\tau H\n$$\n根据质量平衡，我们可以用 $(C_{A0} - C_A)$ 替换 $k(T)C_A\\tau$：\n$$\n\\int_{T_{\\text{in}}}^{T} c_p(T') dT' = (C_{A0} - C_A) H\n$$\n代入 $C_A(T)$ 的表达式：\n$$\nC_{A0} - C_A = C_{A0} - \\frac{C_{A0}}{1 + k(T) \\tau} = C_{A0} \\left(1 - \\frac{1}{1 + k(T) \\tau}\\right) = C_{A0} \\frac{k(T) \\tau}{1 + k(T) \\tau}\n$$\n所以，能量平衡变为：\n$$\n\\int_{T_{\\text{in}}}^{T} c_p(T') dT' = C_{A0} H \\frac{k(T) \\tau}{1 + k(T) \\tau}\n$$\n这是一个标准的表示形式。我们称左边为“移热项”$R_H(T)$，右边为“产热项”$G_H(T)$。稳态温度 $T$ 是方程 $f(T) = R_H(T) - G_H(T) = 0$ 的根。\n\n热容由多项式 $c_p(T) = a + b T + c T^2$ 给出。移热项的积分为：\n$$\nR_H(T) = \\int_{T_{\\text{in}}}^{T} (a + b T' + c T'^2) dT' = \\left[a T' + \\frac{b}{2} T'^2 + \\frac{c}{3} T'^3\\right]_{T_{\\text{in}}}^{T}\n$$\n$$\nR_H(T) = a(T - T_{\\text{in}}) + \\frac{b}{2}(T^2 - T_{\\text{in}}^2) + \\frac{c}{3}(T^3 - T_{\\text{in}}^3)\n$$\n因此，关于 $T$ 的隐式方程（完成任务2）是：\n$$\na(T - T_{\\text{in}}) + \\frac{b}{2}(T^2 - T_{\\text{in}}^2) + \\frac{c}{3}(T^3 - T_{\\text{in}}^3) - C_{A0} H \\frac{\\tau k_0 \\exp(-E/RT)}{1 + \\tau k_0 \\exp(-E/RT)} = 0\n$$\n\n**步骤 3  4：数值求解与不确定性传播**\n\n为了求解反应器温度 $T$，我们必须找到非线性方程 $f(T) = 0$ 的根。一个稳健的数值求根算法，如Brent-Dekker方法（`brentq`），是合适的。需要为根提供一个有效的区间。在 $T = T_{\\text{in}}$ 时，移热项 $R_H(T_{\\text{in}}) = 0$，而产热项 $G_H(T_{\\text{in}}) > 0$，所以 $f(T_{\\text{in}})  0$。对于一个足够大的温度 $T_{\\text{upper}}$，随 $T$ 三次方增长的移热项 $R_H(T)$ 将超过饱和于 $C_{A0} H$ 的产热项 $G_H(T)$。因此，$f(T_{\\text{upper}}) > 0$。一个物理上合理的区间 $[T_{\\text{in}}, T_{\\text{in}} + 500]$ 提供了一个安全的界限。\n\n热容系数 $a$、$b$ 和 $c$ 的不确定性通过蒙特卡洛模拟传播到绝热温升 $\\Delta T = T - T_{\\text{in}}$。过程如下：\n1.  **名义解**：使用名义系数 $(a_0, b_0, c_0)$ 求解 $f(T)=0$ 以找到名义温度 $T_{\\text{nom}}$。名义温升为 $\\Delta T_{\\text{nom}} = T_{\\text{nom}} - T_{\\text{in}}$。\n2.  **蒙特卡洛模拟**：\n    a. 使用固定种子（$12345$）初始化随机数生成器以保证可复现性。\n    b. 从各自的独立高斯分布中为每个系数生成大小为 $N=2000$ 的样本：$a_i \\sim \\mathcal{N}(a_0, \\sigma_a^2)$，$b_i \\sim \\mathcal{N}(b_0, \\sigma_b^2)$，$c_i \\sim \\mathcal{N}(c_0, \\sigma_c^2)$。\n    c. 对于每组采样系数 $(a_i, b_i, c_i)$，求解相应的方程 $f_i(T)=0$ 以找到温度 $T_i$。\n    d. 计算每个样本的温升：$\\Delta T_i = T_i - T_{\\text{in}}$。这将创建一个 $\\Delta T$ 的样本分布。\n3.  **统计分析**：根据温升样本 $\\{\\Delta T_i\\}_{i=1}^N$，按要求计算总体标准差 $\\sigma_{\\Delta T}$：\n$$\n\\sigma_{\\Delta T} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\Delta T_i - \\bar{\\Delta T})^2}\n$$\n其中 $\\bar{\\Delta T}$ 是样本的均值。\n\n这个过程将为问题陈述中指定的三个测试用例分别实现。最终输出是为每个案例计算的 $\\Delta T_{\\text{nom}}$ 和 $\\sigma_{\\Delta T}$ 值的列表，格式化为三位小数。",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for adiabatic temperature rise and its uncertainty in a CSTR\n    for three specified test cases.\n    \"\"\"\n    R = 8.314  # Universal Gas Constant, J/(mol K)\n    N_MC = 2000  # Monte Carlo sample size\n    RANDOM_SEED = 12345  # Fixed seed for reproducibility\n\n    test_cases = [\n        {\n            # Case 1\n            \"Tin\": 330.0, \"tau\": 150.0, \"C_A0\": 2500.0,\n            \"k0\": 2.00e6, \"E\": 90000.0, \"H\": 120000.0,\n            \"a0\": 3.60e6, \"b0\": 1800.0, \"c0\": 1.50,\n            \"sigma_a_frac\": 0.03, \"sigma_b_frac\": 0.03, \"sigma_c_frac\": 0.03,\n        },\n        {\n            # Case 2\n            \"Tin\": 300.0, \"tau\": 1.0, \"C_A0\": 3000.0,\n            \"k0\": 1.00e7, \"E\": 80000.0, \"H\": 100000.0,\n            \"a0\": 3.80e6, \"b0\": 1500.0, \"c0\": 1.80,\n            \"sigma_a_frac\": 0.10, \"sigma_b_frac\": 0.10, \"sigma_c_frac\": 0.10,\n        },\n        {\n            # Case 3\n            \"Tin\": 350.0, \"tau\": 200.0, \"C_A0\": 2000.0,\n            \"k0\": 5.00e8, \"E\": 120000.0, \"H\": 80000.0,\n            \"a0\": 3.50e6, \"b0\": 2000.0, \"c0\": 2.20,\n            \"sigma_a_frac\": 0.05, \"sigma_b_frac\": 0.05, \"sigma_c_frac\": 0.05,\n        },\n    ]\n\n    results = []\n    rng = np.random.default_rng(RANDOM_SEED)\n\n    for case in test_cases:\n        Tin = case[\"Tin\"]\n        \n        # Define the implicit function to find the root T.\n        def get_balance_function(a, b, c):\n            def balance_function(T):\n                # Heat removal term, R_H(T)\n                heat_removal = (a * (T - Tin) +\n                                b/2 * (T**2 - Tin**2) +\n                                c/3 * (T**3 - Tin**3))\n\n                # Rate constant k(T)\n                k_T = case[\"k0\"] * np.exp(-case[\"E\"] / (R * T))\n\n                # Heat generation term, G_H(T)\n                heat_generation = (case[\"C_A0\"] * case[\"H\"] * case[\"tau\"] * k_T /\n                                   (1 + case[\"tau\"] * k_T))\n                \n                return heat_removal - heat_generation\n            return balance_function\n\n        def solve_for_temp(a, b, c):\n            \"\"\"Solves the energy balance for T using provided cp coefficients.\"\"\"\n            f = get_balance_function(a, b, c)\n            # A safe upper bound for temperature search\n            T_upper_bracket = Tin + 500.0\n            try:\n                T_sol = optimize.brentq(f, Tin, T_upper_bracket)\n                return T_sol\n            except ValueError:\n                # This could happen if f(Tin) and f(T_upper_bracket) have the same sign.\n                # It would indicate an issue with the bracketing or model parameters.\n                return np.nan\n\n        # 1. Calculate nominal temperature rise\n        a0, b0, c0 = case[\"a0\"], case[\"b0\"], case[\"c0\"]\n        T_nom = solve_for_temp(a0, b0, c0)\n        delta_T_nom = T_nom - Tin\n\n        # 2. Perform Monte Carlo simulation\n        sigma_a = case[\"sigma_a_frac\"] * a0\n        sigma_b = case[\"sigma_b_frac\"] * b0\n        sigma_c = case[\"sigma_c_frac\"] * c0\n        \n        a_samples = rng.normal(a0, sigma_a, N_MC)\n        b_samples = rng.normal(b0, sigma_b, N_MC)\n        c_samples = rng.normal(c0, sigma_c, N_MC)\n        \n        delta_T_samples = np.zeros(N_MC)\n        for i in range(N_MC):\n            T_i = solve_for_temp(a_samples[i], b_samples[i], c_samples[i])\n            delta_T_samples[i] = T_i - Tin\n            \n        # 3. Calculate standard deviation of Delta T\n        # ddof=0 for population standard deviation as requested\n        sigma_delta_T = np.std(delta_T_samples, ddof=0)\n        \n        # Append formatted results\n        results.append(f\"{delta_T_nom:.3f}\")\n        results.append(f\"{sigma_delta_T:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本节的最终练习将带你进入计算催化领域的前沿，连接微观理论与宏观反应器设计。我们将不再假设宏观的反应速率定律，而是从第一性原理的基元步骤出发构建微观动力学模型。这个练习  将演示如何应用灵敏度分析，高效地评估基础参数（如通过密度泛函理论计算的活化能）的不确定性，并最终预测反应器整体性能（如转化率）的波动范围。",
            "id": "3886993",
            "problem": "物种 $A$ 到物种 $B$ 的催化转化通过一个包含单一吸附中间体的最小微观动力学网络在固体表面上发生。目标是利用化学工程中质量和能量平衡框架内的灵敏度系数，量化密度泛函理论 (DFT) 活化能垒的不确定性如何通过微观动力学平衡传播到反应器尺度转化率的不确定性。您将编写的程序必须根据下述假设，为每个指定的测试用例计算由活化能垒的不确定性引起的单程转化率的标准差，并按照最终输出格式的要求，将结果在一行中报告。所有转化率必须以无量纲分数的形式报告。\n\n基本原理：\n- 理想气体，在恒定温度 $T$ 和总压 $P_{\\mathrm{tot}}$ 下等温操作。\n- 以催化剂重量 $W$ 表示的活塞流反应器 (PFR) 质量平衡：\n  $$\\frac{dF_A}{dW} = -r'(F_A; \\boldsymbol{k}, \\boldsymbol{\\theta}, \\boldsymbol{\\Pi}),$$\n  其中 $F_A$ 是 $A$ 的摩尔流速，单位为 $\\mathrm{mol}\\,\\mathrm{s}^{-1}$，$r'$ 是单位催化剂质量下 $A$ 的消耗速率，单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$，$\\boldsymbol{k}$ 是基元反应速率常数，$\\boldsymbol{\\theta}$ 是表面覆盖度，$\\boldsymbol{\\Pi}$ 表示操作参数。\n- 表面上的基元步骤：\n  1. 准平衡吸附：$A(g) + * \\rightleftharpoons A*$，平衡关系为\n     $$\\theta_A = K_A P_A \\theta_*,$$\n     其中 $\\theta_A$ 和 $\\theta_*$ 分别是 $A*$ 和空位 $*$ 的分数覆盖度，$K_A$ 是吸附平衡常数，单位为 $\\mathrm{Pa}^{-1}$，$P_A$ 是 $A$ 的分压，单位为 $\\mathrm{Pa}$。\n  2. 不可逆表面反应：$A* \\rightarrow I*$，速率为 $r_1 = k_1 \\theta_A$。\n  3. 不可逆表面反应：$I* \\rightarrow B*$，速率为 $r_2 = k_2 \\theta_I$。\n  4. 不可逆解吸：$B* \\rightarrow B(g) + *$，速率为 $r_3 = k_3 \\theta_B$。\n- 中间体和活性位点的准稳态与位点平衡：\n  $$r_1 = r_2,\\quad r_2 = r_3,$$\n  $$\\theta_* + \\theta_A + \\theta_I + \\theta_B = 1.$$\n- 基元步骤的 Arrhenius 动力学：\n  $$k_i = \\nu_i \\exp\\!\\left(-\\frac{E_i}{R T}\\right),\\quad i \\in \\{1,2,3\\},$$\n  其中 $\\nu_i$ 是指前因子，单位为 $\\mathrm{s}^{-1}$，$E_i$ 是 DFT 推导的活化能垒，单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$R$ 是通用气体常数，单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T$ 是温度，单位为 $\\mathrm{K}$。\n- $A$ 的质量比消耗速率与单位活性位点的转换频率相关：\n  $$r' = N_s r_{\\mathrm{site}},$$\n  其中 $N_s$ 是单位催化剂质量的活性位点数，单位为 $\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，$r_{\\mathrm{site}}$ 是单位活性位点上 $A$ 的消耗速率，单位为 $\\mathrm{mol}\\,\\mathrm{site}^{-1}\\,\\mathrm{s}^{-1}$。在上述微观动力学方案下，$r_{\\mathrm{site}}$ 等于通过该序列的共同稳态通量。\n\n操作假设：\n- 气体中 $A$ 是稀释的，并有大量惰性共进料，使得总摩尔流量 $F_{\\mathrm{tot}}$ 保持近似恒定，且分压满足\n  $$P_A(W) = P_{\\mathrm{tot}} \\frac{F_A(W)}{F_{\\mathrm{tot}}}.$$\n- 反应器是等温的，吸附常数 $K_A$ 与 $W$ 无关。\n\n灵敏度与不确定性传播：\n- 定义反应器出口处的单程转化率为\n  $$X = \\frac{F_{A,0} - F_A(W_{\\mathrm{end}})}{F_{A,0}},$$\n  其中 $F_{A,0}$ 是 $A$ 的入口摩尔流量，$W_{\\mathrm{end}}$ 是催化剂重量。\n- 设活化能垒是不确定的，$E_i \\sim \\mathcal{N}(\\bar{E}_i, \\sigma_{E_i}^2)$，且各 $i$ 之间相互独立。一阶（线性）不确定性传播使用灵敏度系数\n  $$S_i = \\frac{\\partial X}{\\partial E_i}\\bigg|_{\\boldsymbol{E}=\\bar{\\boldsymbol{E}}},$$\n  并且 $X$ 的方差近似为\n  $$\\mathrm{Var}(X) \\approx \\sum_{i=1}^{3} S_i^2 \\,\\sigma_{E_i}^2.$$\n- 对于数值估计，使用中心有限差分，步长等于给定的能量标准差：\n  $$S_i \\approx \\frac{X(\\bar{E}_i + \\sigma_{E_i}) - X(\\bar{E}_i - \\sigma_{E_i})}{2\\,\\sigma_{E_i}},$$\n  其中 $\\sigma_{E_i}$ 的单位是 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n任务：\n- 仅从上述基本原理和假设出发，推导所需的微观动力学稳态关系，以用 $k_1$、$k_2$、$k_3$、$K_A$ 和 $P_A$ 表示 $r_{\\mathrm{site}}$，使用位点平衡消除覆盖度，然后建立并积分 PFR 质量平衡以计算给定参数下的 $X$。通过中心差分法数值估计 $S_i$，并报告下述每个测试用例的传播标准差 $\\sigma_X = \\sqrt{\\mathrm{Var}(X)}$。测试套件中提供的所有能量单位均为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，在使用前必须转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。将每个 $\\sigma_X$ 报告为十进制小数（无量纲）。\n\n测试套件：\n- 案例 1 (一般情况)：\n  - $\\bar{E}_1 = 60\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，$\\bar{E}_2 = 55\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，$\\bar{E}_3 = 80\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n  - $\\sigma_{E_1} = 3\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，$\\sigma_{E_2} = 3\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，$\\sigma_{E_3} = 3\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n  - $T = 600\\,\\mathrm{K}$，$P_{\\mathrm{tot}} = 1.0\\times 10^{5}\\,\\mathrm{Pa}$，$F_{\\mathrm{tot}} = 10.0\\,\\mathrm{mol}\\,\\mathrm{s}^{-1}$，$F_{A,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{s}^{-1}$，$W_{\\mathrm{end}} = 1.0\\,\\mathrm{kg}$。\n  - $\\nu_1 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，$\\nu_2 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，$\\nu_3 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$。\n  - $K_A = 1.0\\times 10^{-5}\\,\\mathrm{Pa}^{-1}$，$N_s = 1.0\\times 10^{-7}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。\n- 案例 2 (高温，减少催化剂重量以避免完全转化)：\n  - 除 $T = 800\\,\\mathrm{K}$ 和 $W_{\\mathrm{end}} = 0.05\\,\\mathrm{kg}$ 外，与案例 1 相同。\n- 案例 3 (低温边界)：\n  - 除 $T = 450\\,\\mathrm{K}$ 外，与案例 1 相同。\n- 案例 4 (强吸附边缘情况)：\n  - 除 $K_A = 1.0\\times 10^{-4}\\,\\mathrm{Pa}^{-1}$ 外，与案例 1 相同。\n\n数值要求：\n- 从 $W=0$ 到 $W=W_{\\mathrm{end}}$ 积分关于 $F_A(W)$ 的 PFR 常微分方程；如果 $F_A$ 达到 $0$，则提前终止积分。\n- 使用通用气体常数 $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 在 Arrhenius 表达式和灵敏度步骤中使用之前，所有能量必须从 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 最终输出必须是包含对应案例 1 到 4 的四个传播标准差 $\\sigma_X$ 的单行列表，形式为用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3,x_4]$）。每个 $x_i$ 必须是浮点十进制小数。",
            "solution": "用户的请求是验证并解决一个关于催化活塞流反应器模型中不确定性传播的问题。该问题被认为是有效的，因为它科学地基于化学动力学和反应器工程的既定原理，数学上是适定的、客观的，并且是自洽的，提供了所有必要的参数。\n\n解决方案分四个阶段进行：\n1.  催化反应的微观动力学速率定律的推导。\n2.  活塞流反应器 (PFR) 的质量平衡公式的建立。\n3.  计算反应器转化率的数值方法的说明。\n4.  使用灵敏度系数进行不确定性传播分析的描述。\n\n**1. 微观动力学速率定律的推导**\n\n该问题定义了催化剂表面上的一系列基元步骤。总反应速率由通过该序列的稳态通量决定。给定条件如下：\n- 反应物 $A$ 的准平衡吸附：$A(g) + * \\rightleftharpoons A*$。吸附的 $A$ 的表面覆盖度 $\\theta_A$ 与空位点覆盖度 $\\theta_*$ 以及 $A$ 的分压 $P_A$ 通过平衡表达式相关联：\n  $$ \\theta_A = K_A P_A \\theta_* $$\n- 一系列不可逆表面反应：$A* \\xrightarrow{r_1} I* \\xrightarrow{r_2} B* \\xrightarrow{r_3} B(g) + *$。\n- 这些步骤的速率由 $r_1 = k_1 \\theta_A$、$r_2 = k_2 \\theta_I$ 和 $r_3 = k_3 \\theta_B$ 给出。\n- 系统处于准稳态，意味着每个表面中间体（$I*$ 和 $B*$）的净生成速率为零。由于这些反应是不可逆的，这意味着所有连续步骤的速率都等于总的单位活性位点反应速率，我们将其表示为 $r_{\\mathrm{site}}$（单位为 $\\mathrm{mol}\\,\\mathrm{site}^{-1}\\,\\mathrm{s}^{-1}$ 或简称 $\\mathrm{s}^{-1}$）：\n  $$ r_{\\mathrm{site}} = r_1 = r_2 = r_3 $$\n- 所有分数表面覆盖度的总和必须等于 1（位点平衡）：\n  $$ \\theta_* + \\theta_A + \\theta_I + \\theta_B = 1 $$\n\n我们可以用 $r_{\\mathrm{site}}$ 和基本常数来表示每个覆盖度。首先，从速率表达式得出：\n$$ \\theta_A = \\frac{r_{\\mathrm{site}}}{k_1}, \\quad \\theta_I = \\frac{r_{\\mathrm{site}}}{k_2}, \\quad \\theta_B = \\frac{r_{\\mathrm{site}}}{k_3} $$\n接下来，我们使用吸附平衡将 $r_{\\mathrm{site}}$ 与 $\\theta_*$ 联系起来。将 $\\theta_A = r_{\\mathrm{site}}/k_1$ 代入平衡表达式得到：\n$$ \\frac{r_{\\mathrm{site}}}{k_1} = K_A P_A \\theta_* \\implies \\theta_* = \\frac{r_{\\mathrm{site}}}{k_1 K_A P_A} $$\n现在，我们将所有覆盖度表达式代入位点平衡方程：\n$$ \\frac{r_{\\mathrm{site}}}{k_1 K_A P_A} + \\frac{r_{\\mathrm{site}}}{k_1} + \\frac{r_{\\mathrm{site}}}{k_2} + \\frac{r_{\\mathrm{site}}}{k_3} = 1 $$\n通过因式分解提出 $r_{\\mathrm{site}}$ 来求解：\n$$ r_{\\mathrm{site}} \\left( \\frac{1}{k_1 K_A P_A} + \\frac{1}{k_1} + \\frac{1}{k_2} + \\frac{1}{k_3} \\right) = 1 $$\n将括号中的项乘以 $k_1 K_A P_A / k_1 K_A P_A$ 以消去第一个分数：\n$$ r_{\\mathrm{site}} \\frac{1 + K_A P_A + \\frac{k_1 K_A P_A}{k_2} + \\frac{k_1 K_A P_A}{k_3}}{k_1 K_A P_A} = 1 $$\n最后，重新整理以求解 $r_{\\mathrm{site}}$ 得到显式速率定律：\n$$ r_{\\mathrm{site}} = \\frac{k_1 K_A P_A}{1 + K_A P_A \\left( 1 + \\frac{k_1}{k_2} + \\frac{k_1}{k_3} \\right)} $$\n速率常数 $k_i$ 是温度 $T$ 和其各自活化能垒 $E_i$ 的函数，通过 Arrhenius 方程表示：$k_i = \\nu_i \\exp(-E_i / (RT))$。\n\n**2. 活塞流反应器 (PFR) 质量平衡**\n\n反应物 $A$ 的 PFR 质量平衡由下式给出：\n$$ \\frac{dF_A}{dW} = -r' $$\n其中 $F_A$ 是 $A$ 的摩尔流速，$W$ 是催化剂质量，$r'$ 是质量比反应速率。速率 $r'$ 通过活性位点密度 $N_s$ 与单位活性位点速率 $r_{\\mathrm{site}}$ 相关联：\n$$ r' = N_s \\, r_{\\mathrm{site}} $$\n在稀释系统和大量惰性共进料的假设下，总摩尔流速 $F_{\\mathrm{tot}}$ 近似恒定。这使得 $A$ 的分压可以表示为：\n$$ P_A(W) = P_{\\mathrm{tot}} \\frac{F_A(W)}{F_{\\mathrm{tot}}} $$\n将 $r'$ 和 $P_A$ 的表达式代入质量平衡，得到需要求解的常微分方程 (ODE)：\n$$ \\frac{dF_A}{dW} = -N_s \\frac{k_1 K_A \\left(P_{\\mathrm{tot}} \\frac{F_A}{F_{\\mathrm{tot}}}\\right)}{1 + K_A \\left(P_{\\mathrm{tot}} \\frac{F_A}{F_{\\mathrm{tot}}}\\right) \\left( 1 + \\frac{k_1}{k_2} + \\frac{k_1}{k_3} \\right)} $$\n该 ODE 描述了 $A$ 的摩尔流速如何沿着反应器长度（由催化剂重量 $W$ 表示）变化。\n\n**3. 转化率的数值解**\n\n为了求出反应器转化率 $X$，我们必须首先确定 $A$ 的出口摩尔流速 $F_A(W_{\\mathrm{end}})$。这需要从反应器入口（$W=0$，其中 $F_A(0) = F_{A,0}$）到出口（$W=W_{\\mathrm{end}}$）对 PFR 质量平衡 ODE 进行数值积分。为此，使用数值 ODE 求解器，例如 `scipy.integrate.solve_ivp`。积分进行到 $W=W_{\\mathrm{end}}$ 或 $F_A$ 变为零为止，以先发生者为准。一旦获得 $F_A(W_{\\mathrm{end}})$，单程转化率计算如下：\n$$ X = \\frac{F_{A,0} - F_A(W_{\\mathrm{end}})}{F_{A,0}} $$\n\n**4. 不确定性传播与灵敏度分析**\n\n活化能垒 $E_i$ 被作为不确定参数给出，其平均值为 $\\bar{E}_i$，标准差为 $\\sigma_{E_i}$。我们使用一阶不确定性传播来估计输出转化率的方差 $\\mathrm{Var}(X)$。该近似值由下式给出：\n$$ \\mathrm{Var}(X) \\approx \\sum_{i=1}^{3} \\left( \\frac{\\partial X}{\\partial E_i} \\right)^2 \\sigma_{E_i}^2 = \\sum_{i=1}^{3} S_i^2 \\sigma_{E_i}^2 $$\n其中 $S_i$ 是在活化能垒的平均值 $\\boldsymbol{E}=\\bar{\\boldsymbol{E}}$ 处评估的灵敏度系数。这些灵敏度使用中心有限差分格式进行数值估计：\n$$ S_i \\approx \\frac{X(\\bar{E}_i + \\sigma_{E_i}) - X(\\bar{E}_i - \\sigma_{E_i})}{2\\sigma_{E_i}} $$\n为了计算 $S_i$，对每个能垒 $E_i$ 执行两次完整的 PFR 模拟以求得 $X$：一次是将 $E_i$ 向上扰动 $\\sigma_{E_i}$，另一次是将其向下扰动 $\\sigma_{E_i}$，同时所有其他参数保持其平均值不变。计算出所有三个灵敏度（$S_1, S_2, S_3$）后，转化率的标准差 $\\sigma_X$ 计算为方差的平方根：\n$$ \\sigma_X = \\sqrt{\\mathrm{Var}(X)} $$\n该计算算法涉及一个辅助函数，该函数为给定的活化能向量 $[E_1, E_2, E_3]$ 计算 $X$。该函数通过扰动后的能量向量被重复调用，以计算每个 $S_i$ 的有限差分。然后为每个测试用例汇总最终值 $\\sigma_X$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Validates and solves a problem on uncertainty propagation in a catalytic reactor.\n    The function calculates the standard deviation of reactor conversion due to\n    uncertainties in activation barriers for four different test cases.\n    \"\"\"\n\n    # Universal Gas Constant\n    R = 8.314462618  # J mol^-1 K^-1\n\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {  # Case 1: General case\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 600.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 1.0,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-5, \"Ns\": 1.0e-7\n        },\n        {  # Case 2: High temperature, reduced catalyst weight\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 800.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 0.05,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-5, \"Ns\": 1.0e-7\n        },\n        {  # Case 3: Low temperature boundary\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 450.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 1.0,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-5, \"Ns\": 1.0e-7\n        },\n        {  # Case 4: Strong adsorption edge case\n            \"E_bars_kJ\": np.array([60.0, 55.0, 80.0]),\n            \"sigma_Es_kJ\": np.array([3.0, 3.0, 3.0]),\n            \"T\": 600.0, \"P_tot\": 1.0e5, \"F_tot\": 10.0, \"FA0\": 1.0, \"W_end\": 1.0,\n            \"nus\": np.array([1.0e13, 1.0e13, 1.0e13]),\n            \"K_A\": 1.0e-4, \"Ns\": 1.0e-7\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current case\n        T = case[\"T\"]\n        P_tot = case[\"P_tot\"]\n        F_tot = case[\"F_tot\"]\n        FA0 = case[\"FA0\"]\n        W_end = case[\"W_end\"]\n        nus = case[\"nus\"]\n        K_A = case[\"K_A\"]\n        Ns = case[\"Ns\"]\n\n        # Convert energies from kJ/mol to J/mol\n        E_bars = case[\"E_bars_kJ\"] * 1000.0\n        sigma_Es = case[\"sigma_Es_kJ\"] * 1000.0\n\n        def calculate_conversion(energies):\n            \"\"\"\n            Calculates the reactor conversion for a given set of activation energies.\n            \n            Args:\n                energies (np.ndarray): Array of activation barriers [E1, E2, E3] in J/mol.\n            \n            Returns:\n                float: The single-pass conversion X (dimensionless fraction).\n            \"\"\"\n            # Calculate Arrhenius rate constants\n            k = nus * np.exp(-energies / (R * T))\n            k1, k2, k3 = k[0], k[1], k[2]\n\n            # Define the ODE for the PFR mass balance\n            def pfr_ode(W, F_A_arr):\n                F_A = F_A_arr[0]\n                if F_A = 1e-15:  # Handle near-zero flow to prevent numerical issues\n                    return 0.0\n                \n                P_A = P_tot * F_A / F_tot\n                \n                # Rate law calculation\n                denominator = 1.0 + K_A * P_A * (1.0 + k1 / k2 + k1 / k3)\n                r_site = (k1 * K_A * P_A) / denominator\n                r_prime = Ns * r_site\n                \n                return -r_prime\n\n            # Event to stop integration if F_A reaches zero\n            def zero_crossing_event(W, F_A_arr):\n                return F_A_arr[0]\n            zero_crossing_event.terminal = True\n            zero_crossing_event.direction = -1\n\n            # Integrate the ODE\n            sol = solve_ivp(\n                pfr_ode,\n                (0, W_end),\n                [FA0],\n                events=zero_crossing_event,\n                dense_output=True,\n                rtol=1e-8,\n                atol=1e-10\n            )\n\n            # Determine final molar flow and calculate conversion\n            F_A_end = sol.sol(W_end)[0]\n            if F_A_end  0:\n                F_A_end = 0.0\n                \n            X = (FA0 - F_A_end) / FA0\n            return X\n\n        # Calculate sensitivities using central finite differences\n        sensitivities = []\n        for i in range(len(E_bars)):\n            # Perturb E_i up\n            E_plus = np.copy(E_bars)\n            E_plus[i] += sigma_Es[i]\n            X_plus = calculate_conversion(E_plus)\n\n            # Perturb E_i down\n            E_minus = np.copy(E_bars)\n            E_minus[i] -= sigma_Es[i]\n            X_minus = calculate_conversion(E_minus)\n\n            # Sensitivity coefficient S_i\n            S_i = (X_plus - X_minus) / (2.0 * sigma_Es[i])\n            sensitivities.append(S_i)\n\n        # Calculate variance and standard deviation of conversion\n        variance_X = sum(S_i**2 * sigma_E**2 for S_i, sigma_E in zip(sensitivities, sigma_Es))\n        sigma_X = np.sqrt(variance_X)\n        \n        results.append(sigma_X)\n\n    # Print the final list of standard deviations\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}