## 引言
在原子和分子的微观世界中，除了将原子连接成化学实体的[共价键](@entry_id:146178)外，还存在着一类无处不在、却又更为微妙的力量——非键相互作用。这些相互作用，主要包括范德华力和[静电力](@entry_id:203379)，虽然单个作用微弱，但其集体效应却在宏观尺度上产生了决定性的影响，从液体的密度和[沸点](@entry_id:139893)，到蛋白质的正确折叠，再到催化剂表面的分子吸附，处处可见其身影。准确且高效地对这些相互作用进行建模，是分子模拟领域的核心挑战，也是连接微观机理与宏观现象的桥梁。本文旨在系统性地剖析两大经典的[非键相互作用](@entry_id:189652)模型：[Lennard-Jones势](@entry_id:143105)和静电势。

通过本文的学习，读者将深入了解这些基础模型的物理本质和数学构造。在“原理与机制”章节中，我们将追溯范德华力的量子力学起源，解析[Lennard-Jones 12-6势](@entry_id:751239)的函数形式与参数意义，并探讨在周期性体系中处理[长程静电作用](@entry_id:139854)的Ewald加和等关键技术。接下来，在“应用与跨学科联系”章节中，我们将展示这些模型如何在[计算催化](@entry_id:165043)、材料科学和生物物理等前沿领域中发挥作用，例如模拟[表面吸附](@entry_id:268937)、计算自由能以及解释宏观现象。最后，“动手实践”部分将提供具体的计算练习，帮助读者将理论知识转化为实践技能。本文将带领读者从基本原理出发，逐步构建起对非键相互作用的全面理解。

## 原理与机制

在分子模拟中，系统的总势能 $U_{\text{total}}$ 通常被分解为键合（bonded）项和非键（nonbonded）项之和。[键合项](@entry_id:1121751)描述了由[共价键](@entry_id:146178)连接的原子之间的相互作用，例如键的伸缩、角度的弯曲和[二面角](@entry_id:185221)的扭转。而非键项则描述了所有不通过[共价键](@entry_id:146178)直接相连的原子对之间的相互作用。这些相互作用虽然单个较弱，但其总和在决定物质的宏观性质（如密度、汽化热）以及分子过程（如催化吸附、[蛋白质折叠](@entry_id:136349)）中起着决定性作用。

一个典型的例子是在催化计算中模拟吸附物与催化剂表面的相互作用。当一个刚性分子在刚性[晶体表面](@entry_id:195760)上移动时，其内部的键合能保持不变。因此，不同吸附位点之间能量的差异完全源于吸附物与表面之间的非键相互作用。这些能量差异构成了[势能面](@entry_id:143655)（Potential Energy Surface, PES），其上的极小值点对应于稳定的吸附位点，而连接这些极小值点的最低能量路径上的能垒则决定了表面扩散的速率 。[非键相互作用](@entry_id:189652)通常被进一步分为两个主要部分：范德华（van der Waals, vdW）相互作用和静电（electrostatic）相互作用。

$$
U_{\text{nonbonded}} = U_{\text{vdW}} + U_{\text{electrostatic}}
$$

本章将深入探讨这两种基本[非键相互作用](@entry_id:189652)的物理原理、数学模型及其在[计算模拟](@entry_id:146373)中的实现方法。

### Lennard-Jones势：模拟[范德华相互作用](@entry_id:168429)

[范德华相互作用](@entry_id:168429)是中性原子和分子之间的短程相互作用，它本身是两种截然不同力量的平衡结果：极短距离下的强烈排斥和中长距离下的微弱吸引。Lennard-Jones (LJ) 12-6势是描述这种相互作用的最常用和最成功的简化模型之一。

#### 物理起源

要理解LJ势的函数形式，我们必须追溯到其量子力学起源 。

**短程排斥**：当两个闭壳层原子（如惰性气体原子）相互靠近，其电子云开始重叠时，一种强烈的排斥力便开始显现。这种力源于**泡利不相容原理**（Pauli exclusion principle）。该原理指出，两个具有相同自旋的电子不能占据相同的空间区域。为了避免这种情况，当[轨道重叠](@entry_id:143431)时，电子被迫进入能量更高的[反键轨道](@entry_id:178754)，或者[波函数](@entry_id:201714)必须通过产生额外的节点来保持正交性，这极大地增加了系统的动能。这种排斥能随距离的减小呈指数级增长，其更精确的物理形式是 $A \exp(-Br)$。然而，在[力场](@entry_id:147325)模型中，为了[计算效率](@entry_id:270255)，通常使用 $r^{-12}$ 这样的大指数幂次项来近似模拟这种陡峭的排斥墙。

**长程吸引**：即使是中性、非极性的原子，其电子云也在不断地快速涨落。在任何瞬间，电子的分布都可能是不对称的，从而产生一个[瞬时偶极](@entry_id:139165)矩 $\boldsymbol{\mu}$。这个[瞬时偶极](@entry_id:139165)矩会在其周围产生一个电场，该电场又会[诱导邻近](@entry_id:168500)原子产生一个响应偶极矩。这两个[瞬时偶极](@entry_id:139165)矩之间的相互作用产生了一种净吸[引力](@entry_id:189550)，即**[伦敦色散力](@entry_id:138610)**（London dispersion force）。根据[二阶微扰理论](@entry_id:192858)，对于两个[非极性分子](@entry_id:149614)，其瞬时[偶极-[偶极相互作](@entry_id:144039)用](@entry_id:193339)算符（与 $r^{-3}$ 成正比）的[一阶能量修正](@entry_id:143593)为零。第一个非零的能量贡献来自于[二阶修正](@entry_id:199233)，其能量与 $(r^{-3})^2 = r^{-6}$ 成正比。因此，长程吸[引力](@entry_id:189550)可以表示为 $-C_6/r^6$，其中 $C_6$ 是与原子或分子的[动态极化率](@entry_id:139739)相关的色散系数。

#### 12-6函数形式及其参数

综合上述的排斥和吸引项，John Lennard-Jones 提出了著名的12-6[势能函数](@entry_id:200753)：

$$
u_{\mathrm{LJ}}(r) = 4\varepsilon \left[ \left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6 \right]
$$

其中，$r$ 是两个相互作用中心之间的距离。这个函数形式包含了两个核心参数，$\varepsilon$ 和 $\sigma$，它们具有明确的物理意义 。

**能量参数 $\varepsilon$**：代表势阱的深度，即两个粒子之间[相互作用能](@entry_id:264333)的最大吸引强度。为了找到这个最小值，我们对[势能函数](@entry_id:200753)求导并令其为零（即力为零的位置）：

$$
\frac{du_{\mathrm{LJ}}}{dr} = 4\varepsilon \left[ -12\frac{\sigma^{12}}{r^{13}} + 6\frac{\sigma^6}{r^7} \right] = 0
$$

解得势能最小处的平衡距离 $r_{\text{min}} = 2^{1/6}\sigma$。将此距离代回原[势能函数](@entry_id:200753)，我们得到势阱深度：

$$
u_{\mathrm{LJ}}(r_{\text{min}}) = 4\varepsilon \left[ \left(\frac{\sigma}{2^{1/6}\sigma}\right)^{12} - \left(\frac{\sigma}{2^{1/6}\sigma}\right)^6 \right] = 4\varepsilon \left[ \frac{1}{4} - \frac{1}{2} \right] = -\varepsilon
$$

**尺寸参数 $\sigma$**：代表势能为零时的粒子间距，即 $u_{\mathrm{LJ}}(\sigma) = 0$。这个距离可以被认为是两个粒子的有效碰撞直径。当 $r  \sigma$ 时，排斥力占主导；当 $r > \sigma$ 时，吸[引力](@entry_id:189550)占主导。必须强调，$\sigma$ 并非平衡距离，在 $r=\sigma$ 处，吸[引力](@entry_id:189550)和排斥力并不平衡，净力表现为排斥力。

当LJ势与一个吸引性的[库仑相互作用](@entry_id:747947)（例如，在 $q_i q_j  0$ 的情况下）叠加时，总势能的最小值（即新的平衡距离）会移动到比 $2^{1/6}\sigma$ 更近的距离。这是因为额外的吸[引力](@entry_id:189550)将粒子拉得更近。反之，如果通过增加介[电常数](@entry_id:272823) $\varepsilon_r$ 来屏蔽这种静电吸引，平衡距离会逐渐移回，并以 $2^{1/6}\sigma$ 为极限 。

#### [参数化](@entry_id:265163)与混合规则

LJ参数 $\varepsilon$ 和 $\sigma$ 并非凭空设定，而是通过将[分子模拟](@entry_id:1128112)的计算结果与实验数据进行拟合来确定的。这些实验数据可以包括气体的[第二维里系数](@entry_id:141764) $B_2(T)$、液体的饱和密度 $\rho_{\mathrm{liq}}$ 和汽化热 $\Delta H_{\mathrm{vap}}$ 等。一个严谨的[参数化](@entry_id:265163)过程需要同时拟合多种不同相态和温度下的性质，并采用[加权最小二乘法](@entry_id:177517)和交叉验证等统计方法，以确保得到的参数具有良好的通用性和预测能力 。

当模拟混合物体系时（例如，吸附物和催化剂表面），我们需要确定不同种类原子（$i$ 和 $j$）之间的交叉[相互作用参数](@entry_id:750714) $\varepsilon_{ij}$ 和 $\sigma_{ij}$。由于直接的实验测量非常困难，通常采用**混合规则**（combining rules）来估算。最常用的混合规则是**Lorentz-Berthelot (LB)** 规则 ：

$$
\sigma_{ij} = \frac{\sigma_i + \sigma_j}{2} \quad (\text{算术平均})
$$
$$
\varepsilon_{ij} = \sqrt{\varepsilon_i \varepsilon_j} \quad (\text{几何平均})
$$

$\sigma_{ij}$ 的算术平均规则基于[范德华半径](@entry_id:142957)可加性的简单物理图像。$\varepsilon_{ij}$ 的几何平均规则则源于[伦敦色散](@entry_id:167405)理论的一个近似，即 $C_{6,ij} \approx \sqrt{C_{6,i} C_{6,j}}$。尽管LB规则在许多情况下表现良好，但它基于相互作用是各向同性且成对可加的假设，在处理尺寸或能量差异悬殊的粒子、离子-中性分子相互作用或各向异性环境时可能会失效，需要更复杂的混合规则或环境依赖的修正。

### 静电相互作用：从点电荷到周期性体系

[静电相互作用](@entry_id:166363)是带电粒子之间的力，其长程性质对模拟体系的行为有着深远的影响。

#### [库仑势](@entry_id:154276)与[介电屏蔽](@entry_id:266074)

在[分子力](@entry_id:203760)场中，分子的[电荷分布](@entry_id:144400)通常被简化为一系列位于原子中心的**点电荷**（partial charges）。两个[点电荷](@entry_id:263616) $q_i$ 和 $q_j$ 在距离为 $r$ 时的[相互作用能](@entry_id:264333)由**[库仑定律](@entry_id:139360)**（Coulomb's law）描述。在真空中，其形式为：

$$
u_{ij}(r) = \frac{1}{4\pi\varepsilon_0} \frac{q_i q_j}{r}
$$

其中 $\varepsilon_0$ 是[真空介电常数](@entry_id:204253)，一个定义了[国际单位制](@entry_id:172547)下电磁相互作用强度的[基本物理常数](@entry_id:272808)。

当相互作用发生在凝聚相介质（如水溶液）中时，介质本身会因电场而极化，从而削弱（屏蔽）电荷之间的原始相互作用。在**[隐式溶剂模型](@entry_id:170981)**（implicit solvent model）中，这种屏蔽效应通过引入一个无量纲的**相对介电常数** $\varepsilon_r$ 来宏观地描述 ：

$$
u_{ij}(r) = \frac{1}{4\pi\varepsilon_0\varepsilon_r} \frac{q_i q_j}{r}
$$

然而，在**[显式溶剂模型](@entry_id:202809)**（explicit solvent model）的[分子动力学](@entry_id:147283)（MD）模拟中，溶剂分子（如水）被作为独立的粒子明确地包含在内。它们的重新取向和极化已经从原子层面自然地再现了[介电屏蔽](@entry_id:266074)效应。如果在这种情况下仍然在库仑定律中使用 $\varepsilon_r > 1$，将导致对[屏蔽效应](@entry_id:136974)的“双重计算”，这是一个严重的错误。因此，在标准的[显式溶剂](@entry_id:749178)模拟中，非键相互作用势中的 $\varepsilon_r$ 必须设置为1。

#### 周期性的挑战：Ewald加和

在模拟晶体或大体积溶液时，通常采用**[周期性边界条件](@entry_id:753346)**（Periodic Boundary Conditions, PBC）来消除表面效应并模拟无限体系。这意味着[模拟盒子](@entry_id:1131678)在空间中无限重复。计算一个电荷与体系中所有其他电荷（包括其在所有周期性映像中的副本）的[静电相互作用](@entry_id:166363)，需要对一个[无限晶格](@entry_id:1126489)上的库仑项进行求和。

一个关键的数学问题是，与快速衰减的LJ势（其[晶格和](@entry_id:189839)是[绝对收敛](@entry_id:146726)的）不同，$1/r$ 形式的[库仑势](@entry_id:154276)衰减得太慢。对于一个三维周期性体系，即使满足[电中性条件](@entry_id:1122298)（$\sum q_i = 0$），其[静电势](@entry_id:188370)的[晶格和](@entry_id:189839)仍然是**[条件收敛](@entry_id:147507)**的 。这意味着求和的结果取决于求和的顺序或方式（例如，是按球形壳层求和还是按立方壳层求和）。这种模糊性对应于一个物理问题：长程[静电能](@entry_id:267406)依赖于无限大晶体的宏观边界条件。

为了解决这个问题，Paul Ewald 提出了一种强大的数学方法，即**Ewald加和**。其基本思想是巧妙地将一个缓慢收敛的求和分解为两个快速收敛的求和 ：

1.  在每个[点电荷](@entry_id:263616)周围放置一个符号相反、电荷量相同的高斯电荷分布，从而“屏蔽”其长程电场。这使得原始的点电荷相互作用变成了一个[短程相互作用](@entry_id:145678)，可以在**[实空间](@entry_id:754128)**（real space）中快速求和。这个新的[实空间](@entry_id:754128)势因为高斯屏蔽的存在而快速衰减（如 $\text{erfc}(\alpha r)/r$），因此其[晶格和](@entry_id:189839)是[绝对收敛](@entry_id:146726)的。

2.  为了修正引入的虚拟高斯电荷，必须再减去这些高斯[电荷分布](@entry_id:144400)之间的相互作用。由于[高斯函数](@entry_id:261394)是平滑的，它们的相互作用可以在**倒易空间**（reciprocal space）中高效计算。这个[倒易空间求和](@entry_id:754152)同样是绝对且快速收敛的。

3.  最后，必须减去每个点电荷与其自身屏蔽高斯云之间的非物理相互作用，这被称为**自能校正**（self-interaction correction）。

通过这种方式，Ewald加和将一个[条件收敛](@entry_id:147507)的、结果不明确的求和，转化为两个[绝对收敛](@entry_id:146726)的、结果明确的求和（外加一个简单的校正项），从而为周期性体系的[静电能](@entry_id:267406)提供了一个精确且唯一的计算方法。

#### 粒子网格Ewald (PME) 算法

虽然Ewald加和在理论上是完美的，但其[倒易空间](@entry_id:754151)部分的计算复杂度随粒子数 $N$ 的增加而以 $O(N^2)$ 的速度增长，这对于大型体系是不可接受的。**粒子网格Ewald (PME)** 算法是一种巧妙的改进，它利用[快速傅里叶变换](@entry_id:143432)（FFT）将[倒易空间](@entry_id:754151)的计算复杂度降低到 $O(N\ln N)$，使其成为现代[生物分子](@entry_id:176390)和[材料模拟](@entry_id:176516)的标准方法 。

PME的核心步骤如下：
1.  **电荷分配**：将每个[点电荷](@entry_id:263616)的电荷值分配（或“涂抹”）到最近的几个三维网格点上。这个过程通常使用高阶的**[B样条](@entry_id:172303)**（B-spline）[插值函数](@entry_id:262791)来保证足够的精度和平滑度。
2.  **倒易空间计算（FFT）**：对网格化的电荷密度执行一次FFT，将其转换到倒易空间。然后，将其与一个预先计算好的“[影响函数](@entry_id:168646)”相乘。这个[影响函数](@entry_id:168646)包含了Ewald倒易空间的[格林函数](@entry_id:147802)（即 $\exp(-k^2/4\alpha^2)/k^2$）和一个用于修正电荷分配过程引入的平滑效应的“解卷积”因子。
3.  **势的计算**：对上一步的结果执行一次逆FFT，得到每个网格点上的静电势。然后，再次使用[B样条插值](@entry_id:1121299)，从网格点上将势能插值回每个粒子的实际位置，从而计算出[静电能](@entry_id:267406)。
4.  **力的计算**：力是势能对粒子位置的负梯度。在PME中，这需要对整个计算流程（包括[B样条插值](@entry_id:1121299)函数本身）进行[微分](@entry_id:158422)，以保证能量和力之间的一致性 。

此外，PME计算仍然需要加上Ewald方法的[实空间](@entry_id:754128)[部分和](@entry_id:162077)独立于网格参数的[自能](@entry_id:145608)校正项 $E_{\text{self}} = -\frac{\alpha}{\sqrt{\pi}}\frac{1}{4\pi\varepsilon_0}\sum_i q_i^2$ 。

### 实际应用与高级模型

#### 范德华力的截断与校正

由于LJ势随距离衰减得很快（$r^{-6}$），在模拟中为了节省计算成本，通常会引入一个**[截断半径](@entry_id:136708)** $r_c$。对于距离大于 $r_c$ 的粒子对，其相互作用被忽略。然而，这种简单的截断会带来一些问题 。

- **能量和力的[不连续性](@entry_id:144108)**：在 $r=r_c$ 处，势能会从一个非零值 $u(r_c)$ 突然跳变为零，导致能量不守恒。力（势能的导数）在这一点上也会出现一个冲击性的不连续。
- **[移位](@entry_id:145848)势（Shifted Potential）**：为了解决能量不连续的问题，可以使用移位势：$u_s(r) = u(r) - u(r_c)$ for $r  r_c$。这保证了势能在 $r_c$ 处平滑地过渡到零，但力的[不连续性](@entry_id:144108)依然存在。

为了更精确地计算体系的宏观性质，如能量和压力，需要考虑被截断掉的、$r>r_c$ 范围内的[长程相互作用](@entry_id:140725)的贡献。这可以通过**长程[尾部校正](@entry_id:755799)**（long-range tail corrections）来解析地完成。其基本假设是，在大于 $r_c$ 的距离上，[径向分布函数](@entry_id:1129297) $g(r) \approx 1$（即[液体结构](@entry_id:150165)趋于均匀）。基于此，可以将被忽略的能量和压力贡献通过对LJ势积分得到。例如，能量的[尾部校正](@entry_id:755799)为：

$$
\frac{U_{\text{tail}}}{N} = 2\pi\rho \int_{r_c}^{\infty} u_{\mathrm{LJ}}(r) r^2 dr = \frac{8\pi\rho\varepsilon\sigma^3}{3} \left[ \frac{1}{3}\left(\frac{\sigma}{r_c}\right)^9 - \left(\frac{\sigma}{r_c}\right)^3 \right]
$$

这些校正对于精确模拟液体的[热力学性质](@entry_id:146047)至关重要。

#### 超越固定电荷：[可极化模型](@entry_id:165025)

标准的固定电荷模型虽然计算简单，但其核心缺陷在于它是**非适应性**的：原子的[部分电荷](@entry_id:167157)是预先设定的常数，不会因周围环境（如溶剂、外电场或构象变化）的改变而改变 。这在许多化学过程中是一个粗糙的近似。

**[可极化模型](@entry_id:165025)**（polarizable models）通过允许分子的[电荷分布](@entry_id:144400)响应局部电场来克服这一限制。最简单的方法是为每个原子（或相互作用位点）分配一个**[极化率](@entry_id:143513)** $\boldsymbol{\alpha}$。在局部电场 $\boldsymbol{E}_{\text{local}}$ 的作用下，该位点会产生一个**感生偶极矩** $\boldsymbol{\mu}_{\text{ind}}$：

$$
\boldsymbol{\mu}_{\text{ind}} = \boldsymbol{\alpha} \boldsymbol{E}_{\text{local}}
$$

这里的关键复杂性在于，局部电场 $\boldsymbol{E}_{\text{local}}$ 不仅包括外加电场和固定电荷产生的场，还包括由体系中**所有其他感生偶极矩**产生的场。这意味着感生偶极矩的确定是一个**自洽**问题：每个偶极矩都依赖于所有其他偶极矩。

这个问题通常通过迭代求解：从一个初始猜测（如所有感生偶极为零）开始，计算局部电场，然后计算新的感生偶极矩，再用新的偶极矩更新电场，如此循环，直到所有偶极矩的值收敛到一个稳定解 。

然而，这个自洽过程并非总能保证收敛。如果原子的极化率过大或原子间距离过近，感生偶极之间的相互增强效应可能导致迭代发散，感生偶极矩趋向于无穷大。这种现象被称为“**[极化灾变](@entry_id:137085)**”（polarization catastrophe）。数学上，[迭代过程的稳定性](@entry_id:174376)要求一个由[极化率张量](@entry_id:191938)和[偶极-偶极相互作用](@entry_id:144039)张量构成的[系统矩阵](@entry_id:172230)，其最大本征值的模必须小于1 。[可极化模型](@entry_id:165025)虽然计算成本更高，但它们能够更准确地描述离子-分子相互作用、[氢键](@entry_id:136659)以及发生在异质界面和电场中的过程，代表了[力场](@entry_id:147325)发展的未来方向。