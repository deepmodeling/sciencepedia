{
    "hands_on_practices": [
        {
            "introduction": "在分子力学中，Lennard-Jones (LJ) 势是描述非键相互作用的基石。然而，在实际模拟中，为了提高计算效率，我们必须对这些长程作用进行截断。本练习将引导你深入探讨不同截断方法（如直接截断、移位截断和力移位截断）之间微妙但至关重要的差异，及其对能量守恒等基本物理原理的影响 ()。这不仅是一次数值计算练习，更是确保模拟过程物理真实性的关键一步。",
            "id": "3890789",
            "problem": "考虑在催化表面吸附的分子动力学 (MD) 模拟中，一个吸附原子与单个表面原子相互作用，此相互作用由 Lennard-Jones (LJ) 对势建模。Lennard-Jones 势能函数由下式给出\n$$\nu_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right],\n$$\n其中$r$是原子间距，$\\varepsilon$是一个能量尺度，$\\sigma$是一个长度尺度。标量径向力定义为势能相对于间距的负梯度，$f(r) = - \\frac{\\partial u(r)}{\\partial r}$。假设力的符号约定为：$f(r) > 0$表示指向$r$增大方向（沿分离矢量向外）的排斥力，$f(r)  0$表示吸引力。\n\n在实际的 MD 模拟中，为了降低计算成本，引入了截断半径$r_{c}$，超出此半径的相互作用将被忽略。三种广泛使用的对势截断方案是：\n\n1. 截断势：\n$$\nu_{\\mathrm{T}}(r) = \n\\begin{cases}\nu_{\\mathrm{LJ}}(r),  r  r_{c}, \\\\\n0,  r \\ge r_{c},\n\\end{cases}\n$$\n2. 截断-移动势：\n$$\nu_{\\mathrm{TS}}(r) = \n\\begin{cases}\nu_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c}),  r  r_{c}, \\\\\n0,  r \\ge r_{c},\n\\end{cases}\n$$\n3. 力-移动势：\n$$\nu_{\\mathrm{FS}}(r) =\n\\begin{cases}\nu_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c}) - (r - r_{c}) \\, \\left. \\frac{\\partial u_{\\mathrm{LJ}}}{\\partial r} \\right|_{r=r_{c}},  r  r_{c}, \\\\\n0,  r \\ge r_{c}.\n\\end{cases}\n$$\n\n任务：\n- 从第一性原理出发，推导 LJ 力$f_{\\mathrm{LJ}}(r)$，即$u_{\\mathrm{LJ}}(r)$相对于$r$的负梯度。\n- 对每种截断方案（截断、截断-移动和力-移动），推导在$r  r_{c}$和$r \\ge r_{c}$时对应的力$f(r)$，并使用单侧极限分析$u(r)$和$f(r)$在$r = r_{c}$处的连续性。\n- 利用你的结果，解释力的不连续性对催化表面附近吸附的 MD 模拟的实际影响，重点关注稳定性和能量守恒。\n\n将力-移动方案下$r  r_{c}$时的力$f_{\\mathrm{FS}}(r)$的闭式解析表达式作为最终答案，用$\\varepsilon$、$\\sigma$、$r$和$r_{c}$表示。不需要进行数值计算。将最终答案表示为单个解析表达式。最终答案中不要包含单位。",
            "solution": "该问题陈述经评估具有科学依据、问题明确且客观。它提出了计算化学和统计力学中的一个标准、典型的问题，特别是在分子动力学 (MD) 模拟的背景下。所有函数、变量和任务都定义清晰，没有内部矛盾、歧义或事实错误。该问题有效，将提供解答。\n\n按要求，分析分三部分进行：推导 Lennard-Jones (LJ) 力，分析三种常见截断方案下势和力的连续性，以及讨论实际影响。\n\n**第 1 部分：Lennard-Jones 力 $f_{\\mathrm{LJ}}(r)$ 的推导**\n\nLennard-Jones 势 $u_{\\mathrm{LJ}}(r)$ 由下式给出：\n$$\nu_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]\n$$\n为了方便求导，可将其改写为：\n$$\nu_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left( \\sigma^{12} r^{-12} - \\sigma^{6} r^{-6} \\right)\n$$\n标量径向力 $f(r)$ 定义为势相对于原子间距 $r$ 的负梯度：\n$$\nf_{\\mathrm{LJ}}(r) = - \\frac{\\partial u_{\\mathrm{LJ}}(r)}{\\partial r}\n$$\n我们计算 $u_{\\mathrm{LJ}}(r)$ 的导数：\n$$\n\\frac{\\partial u_{\\mathrm{LJ}}(r)}{\\partial r} = 4 \\varepsilon \\left[ \\sigma^{12} (-12 r^{-13}) - \\sigma^{6} (-6 r^{-7}) \\right]\n$$\n$$\n\\frac{\\partial u_{\\mathrm{LJ}}(r)}{\\partial r} = 4 \\varepsilon \\left[ -12 \\sigma^{12} r^{-13} + 6 \\sigma^{6} r^{-7} \\right]\n$$\n$$\n\\frac{\\partial u_{\\mathrm{LJ}}(r)}{\\partial r} = 24 \\varepsilon \\left[ -2 \\sigma^{12} r^{-13} + \\sigma^{6} r^{-7} \\right]\n$$\n力是该导数的负值：\n$$\nf_{\\mathrm{LJ}}(r) = - \\left( 24 \\varepsilon \\left[ -2 \\sigma^{12} r^{-13} + \\sigma^{6} r^{-7} \\right] \\right)\n$$\n$$\nf_{\\mathrm{LJ}}(r) = 24 \\varepsilon \\left[ 2 \\sigma^{12} r^{-13} - \\sigma^{6} r^{-7} \\right]\n$$\n该表达式可以因式分解为更常见的形式：\n$$\nf_{\\mathrm{LJ}}(r) = \\frac{48 \\varepsilon \\sigma^{12}}{r^{13}} - \\frac{24 \\varepsilon \\sigma^{6}}{r^{7}} = \\frac{24 \\varepsilon}{r} \\left[ 2 \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n$$\n\n**第 2 部分：截断方案分析**\n\n我们对三种方案中的每一种，在截断半径 $r = r_{c}$ 处分析势 $u(r)$ 和力 $f(r)$ 的连续性。某一点的连续性要求左极限、右极限以及函数在该点的值三者都相等。\n\n**1. 截断势 ($u_{\\mathrm{T}}$)**\n势定义为：\n$$\nu_{\\mathrm{T}}(r) = \n\\begin{cases}\nu_{\\mathrm{LJ}}(r),  r  r_{c} \\\\\n0,  r \\ge r_{c}\n\\end{cases}\n$$\n- **在 $r=r_c$ 处的势连续性**：\n  - 左极限：$\\lim_{r \\to r_c^-} u_{\\mathrm{T}}(r) = u_{\\mathrm{LJ}}(r_c) = 4 \\varepsilon [ (\\frac{\\sigma}{r_c})^{12} - (\\frac{\\sigma}{r_c})^{6} ]$。\n  - 右极限：$\\lim_{r \\to r_c^+} u_{\\mathrm{T}}(r) = 0$。\n  - 由于对于任何典型的 $r_c$ 选择（例如，$r_c > \\sigma$），都有 $u_{\\mathrm{LJ}}(r_c) \\neq 0$，因此势 $u_{\\mathrm{T}}(r)$ 在 $r = r_c$ 处是**不连续的**。\n\n- **在 $r=r_c$ 处的力推导和连续性**：\n  力为 $f_{\\mathrm{T}}(r) = -\\frac{\\partial u_{\\mathrm{T}}}{\\partial r}$。\n  - 对于 $r  r_c$：$f_{\\mathrm{T}}(r) = -\\frac{\\partial}{\\partial r} u_{\\mathrm{LJ}}(r) = f_{\\mathrm{LJ}}(r)$。\n  - 对于 $r > r_c$：$f_{\\mathrm{T}}(r) = -\\frac{\\partial}{\\partial r}(0) = 0$。\n  - 左极限：$\\lim_{r \\to r_c^-} f_{\\mathrm{T}}(r) = f_{\\mathrm{LJ}}(r_c) = 24 \\varepsilon [ 2 \\sigma^{12} r_c^{-13} - \\sigma^{6} r_c^{-7} ]$。\n  - 右极限：$\\lim_{r \\to r_c^+} f_{\\mathrm{T}}(r) = 0$。\n  - 由于势是不连续的，力在 $r=r_c$ 处形式上是未定义的。左右极限不匹配，因此力函数 $f_{\\mathrm{T}}(r)$ 在 $r = r_c$ 处也是**不连续的**。\n\n**2. 截断-移动势 ($u_{\\mathrm{TS}}$)**\n势定义为：\n$$\nu_{\\mathrm{TS}}(r) = \n\\begin{cases}\nu_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c}),  r  r_{c} \\\\\n0,  r \\ge r_{c}\n\\end{cases}\n$$\n- **在 $r=r_c$ 处的势连续性**：\n  - 左极限：$\\lim_{r \\to r_c^-} u_{\\mathrm{TS}}(r) = u_{\\mathrm{LJ}}(r_c) - u_{\\mathrm{LJ}}(r_c) = 0$。\n  - 右极限：$\\lim_{r \\to r_c^+} u_{\\mathrm{TS}}(r) = 0$。\n  - 左右极限相等。势 $u_{\\mathrm{TS}}(r)$ 在 $r = r_c$ 处是**连续的**。\n\n- **在 $r=r_c$ 处的力推导和连续性**：\n  力为 $f_{\\mathrm{TS}}(r) = -\\frac{\\partial u_{\\mathrm{TS}}}{\\partial r}$。\n  - 对于 $r  r_c$：$f_{\\mathrm{TS}}(r) = -\\frac{\\partial}{\\partial r} [u_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c})]$。由于 $u_{\\mathrm{LJ}}(r_c)$ 是一个常数，其导数为零。因此，$f_{\\mathrm{TS}}(r) = -\\frac{\\partial u_{\\mathrm{LJ}}(r)}{\\partial r} = f_{\\mathrm{LJ}}(r)$。\n  - 对于 $r > r_c$：$f_{\\mathrm{TS}}(r) = -\\frac{\\partial}{\\partial r}(0) = 0$。\n  - 左极限：$\\lim_{r \\to r_c^-} f_{\\mathrm{TS}}(r) = f_{\\mathrm{LJ}}(r_c)$。\n  - 右极限：$\\lim_{r \\to r_c^+} f_{\\mathrm{TS}}(r) = 0$。\n  - 左右极限不相等（除非 $f_{\\mathrm{LJ}}(r_c) = 0$，这种情况只在势能最小值处发生，而这对于 $r_c$ 来说是一个不常见的选择）。力 $f_{\\mathrm{TS}}(r)$ 在 $r = r_c$ 处是**不连续的**。\n\n**3. 力-移动势 ($u_{\\mathrm{FS}}$)**\n势定义为：\n$$\nu_{\\mathrm{FS}}(r) =\n\\begin{cases}\nu_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c}) - (r - r_{c}) \\, \\left. \\frac{\\partial u_{\\mathrm{LJ}}}{\\partial r} \\right|_{r=r_{c}},  r  r_{c} \\\\\n0,  r \\ge r_{c}\n\\end{cases}\n$$\n注意 $\\left. \\frac{\\partial u_{\\mathrm{LJ}}}{\\partial r} \\right|_{r=r_{c}} = -f_{\\mathrm{LJ}}(r_c)$。\n- **在 $r=r_c$ 处的势连续性**：\n  - 左极限：$\\lim_{r \\to r_c^-} u_{\\mathrm{FS}}(r) = u_{\\mathrm{LJ}}(r_c) - u_{\\mathrm{LJ}}(r_c) - (r_c - r_c) (-f_{\\mathrm{LJ}}(r_c)) = 0$。\n  - 右极限：$\\lim_{r \\to r_c^+} u_{\\mathrm{FS}}(r) = 0$。\n  - 左右极限相等。势 $u_{\\mathrm{FS}}(r)$ 在 $r = r_c$ 处是**连续的**。\n\n- **在 $r=r_c$ 处的力推导和连续性**：\n  力为 $f_{\\mathrm{FS}}(r) = -\\frac{\\partial u_{\\mathrm{FS}}}{\\partial r}$。\n  - 对于 $r  r_c$：\n    $$\n    f_{\\mathrm{FS}}(r) = -\\frac{\\partial}{\\partial r} \\left[ u_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c}) - (r - r_{c}) \\left. \\frac{\\partial u_{\\mathrm{LJ}}}{\\partial r} \\right|_{r=r_{c}} \\right]\n    $$\n    项 $u_{\\mathrm{LJ}}(r_c)$ 和 $\\left. \\frac{\\partial u_{\\mathrm{LJ}}}{\\partial r} \\right|_{r=r_{c}}$ 是关于 $r$ 的常数。令 $C = \\left. \\frac{\\partial u_{\\mathrm{LJ}}}{\\partial r} \\right|_{r=r_{c}}$。\n    $$\n    f_{\\mathrm{FS}}(r) = -\\frac{\\partial}{\\partial r} [ u_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c}) - rC + r_c C ] = - \\left( \\frac{\\partial u_{\\mathrm{LJ}}(r)}{\\partial r} - C \\right)\n    $$\n    $$\n    f_{\\mathrm{FS}}(r) = -\\frac{\\partial u_{\\mathrm{LJ}}(r)}{\\partial r} - \\left( - \\left. \\frac{\\partial u_{\\mathrm{LJ}}}{\\partial r} \\right|_{r=r_{c}} \\right) = f_{\\mathrm{LJ}}(r) - f_{\\mathrm{LJ}}(r_c)\n    $$\n  - 对于 $r > r_c$：$f_{\\mathrm{FS}}(r) = -\\frac{\\partial}{\\partial r}(0) = 0$。\n  - 左极限：$\\lim_{r \\to r_c^-} f_{\\mathrm{FS}}(r) = f_{\\mathrm{LJ}}(r_c) - f_{\\mathrm{LJ}}(r_c) = 0$。\n  - 右极限：$\\lim_{r \\to r_c^+} f_{\\mathrm{FS}}(r) = 0$。\n  - 左右极限相等。力 $f_{\\mathrm{FS}}(r)$ 在 $r = r_c$ 处是**连续的**。\n\n**第 3 部分：力不连续性的实际影响**\n\n在 MD 模拟中，牛顿运动方程使用有限差分积分算法（如 Verlet 算法）进行数值求解。这些算法需要在离散的时间步长 $\\Delta t$ 上计算每个原子上的力。\n\n- **能量守恒：** 对于在微正则 (NVE) 系综中模拟的孤立系统，总能量（动能+势能）必须守恒。\n  - 截断势 ($u_{\\mathrm{T}}$) 在势能函数本身上存在不连续性。当一个粒子穿过 $r_c$ 时，其势能会突然改变，导致系统总能量发生跳跃。这严重违反了能量守恒。\n  - 截断-移动势 ($u_{\\mathrm{TS}}$) 和力-移动势 ($u_{\\mathrm{FS}}$) 在 $r_c$ 处是连续的，因此当粒子穿过截断半径时，它们不会引起总能量的瞬时跳跃。\n\n- **稳定性和准确性：** 数值积分器的准确性和稳定性取决于力函数的光滑程度。\n  - 对于 $u_{\\mathrm{T}}$ 和 $u_{\\mathrm{TS}}$ 方案，力在 $r_c$ 处是不连续的。当一个原子穿过截断半径时，它会经历一个脉冲式的力的变化。这是模型中非物理的人为效应。\n  - 这种力的不连续性会在运动方程的积分中引入大的误差。这会导致长时间模拟中能量守恒性差，即使对于势是连续的 $u_{\\mathrm{TS}}$ 方案也是如此。总能量倾向于表现出系统性漂移或随机游走，从而损害了模拟的物理有效性。在某些情况下，大的积分误差可能导致灾难性的不稳定性，使模拟“爆炸”（即粒子获得不符合物理规律的巨大动能）。\n  - 力-移动方案 ($u_{\\mathrm{FS}}$) 确保了势和力在截断半径处都平滑地变为零。通过使力连续，它消除了在 $r_c$ 处的非物理脉冲。这显著提高了数值稳定性并带来了卓越的能量守恒性，这对于从长时间 MD 模拟中获得可靠的热力学和动力学数据至关重要，特别是对于像催化这样需要精确描述能量景观的敏感应用。\n\n最终答案要求的是 $r  r_{c}$ 时 $f_{\\mathrm{FS}}(r)$ 的闭式表达式。根据上面的推导，这是 $f_{\\mathrm{LJ}}(r) - f_{\\mathrm{LJ}}(r_c)$。代入 $f_{\\mathrm{LJ}}(r)$ 的完整表达式：\n$$\nf_{\\mathrm{FS}}(r) = \\left( \\frac{48 \\varepsilon \\sigma^{12}}{r^{13}} - \\frac{24 \\varepsilon \\sigma^{6}}{r^{7}} \\right) - \\left( \\frac{48 \\varepsilon \\sigma^{12}}{r_{c}^{13}} - \\frac{24 \\varepsilon \\sigma^{6}}{r_{c}^{7}} \\right)\n$$\n整理各项得：\n$$\nf_{\\mathrm{FS}}(r) = 48\\varepsilon\\sigma^{12}\\left(\\frac{1}{r^{13}} - \\frac{1}{r_{c}^{13}}\\right) - 24\\varepsilon\\sigma^{6}\\left(\\frac{1}{r^{7}} - \\frac{1}{r_{c}^{7}}\\right)\n$$\n该表达式等价于：\n$$\nf_{\\mathrm{FS}}(r) = 48\\varepsilon\\sigma^{12}\\left(r^{-13} - r_{c}^{-13}\\right) - 24\\varepsilon\\sigma^{6}\\left(r^{-7} - r_{c}^{-7}\\right)\n$$\n这就是所要求的闭式解析表达式。",
            "answer": "$$\n\\boxed{48\\varepsilon\\sigma^{12}\\left(r^{-13} - r_{c}^{-13}\\right) - 24\\varepsilon\\sigma^{6}\\left(r^{-7} - r_{c}^{-7}\\right)}\n$$"
        },
        {
            "introduction": "在掌握了非键相互作用之后，我们将注意力转向分子内坐标。本练习聚焦于决定分子构象的二面角。通过给定的扭转势能函数，你将亲手计算作用在化学键上的力矩，从而将静态的力场参数与分子的动态旋转行为直接联系起来 ()。理解这种联系对于研究催化反应和分子识别中的构象变化至关重要。",
            "id": "3890782",
            "problem": "一个靠近催化活性位点的表面束缚中间体，其围绕单根碳-碳键的旋转受阻，该旋转由二面角坐标 $\\phi$ 来表征。在分子力学（MM）中，该键的力场扭转部分由一个截断的傅里叶级数建模，该级数代表分子内扭转，并辅以一个由活性位点局部电子环境引起的弱各向异性偏置场。扭转势为\n$$\nU_{\\phi}(\\phi) \\;=\\; \\sum_{n=1}^{3} \\frac{V_{n}}{2}\\big[1+\\cos(n\\phi-\\gamma_{n})\\big] \\;+\\; A\\,\\cos(\\phi-\\phi_{0}),\n$$\n其中 $V_{n}$ 是扭转振幅，$\\gamma_{n}$ 是相移，$A$ 是一个小的偏置振幅，$\\phi_{0}$ 是偏置相位。考虑参数值为 $V_{1}=3.2\\,\\mathrm{kJ/mol}$，$\\gamma_{1}=0$，$V_{2}=0.8\\,\\mathrm{kJ/mol}$，$\\gamma_{2}=\\pi$，$V_{3}=0.5\\,\\mathrm{kJ/mol}$，$\\gamma_{3}=0$，$A=1.1\\,\\mathrm{kJ/mol}$，以及 $\\phi_{0}=\\pi/6$，并指定二面角为 $\\phi^{\\ast}=2.1\\,\\mathrm{rad}$。\n\n从力矩定义为势对广义坐标的负梯度出发，计算力矩 $\\,\\tau(\\phi^{\\ast})=-\\partial U_{\\phi}/\\partial \\phi\\,\\big|_{\\phi=\\phi^{\\ast}}$。然后，在靠近催化活性位点的过阻尼旋转布朗运动框架下，根据计算出的力矩的符号和大小，解释其对二面角坐标 $\\phi$ 的旋转扩散的定性影响。\n\n最终力矩以 $\\mathrm{kJ/mol}$ 为单位表示，其中 $\\phi$ 以弧度为单位，并将您的数值结果四舍五入至四位有效数字。",
            "solution": "用户要求我解决一个关于计算化学的问题。\n\n首先，我将验证问题陈述。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- 二面角坐标 $\\phi$ 的扭转势能：\n$$\nU_{\\phi}(\\phi) \\;=\\; \\sum_{n=1}^{3} \\frac{V_{n}}{2}\\big[1+\\cos\\!\\big(n\\phi-\\gamma_{n}\\big)\\big] \\;+\\; A\\,\\cos\\!\\big(\\phi-\\phi_{0}\\big)\n$$\n- 参数值：\n  - $V_{1}=3.2\\,\\mathrm{kJ/mol}$\n  - $\\gamma_{1}=0$\n  - $V_{2}=0.8\\,\\mathrm{kJ/mol}$\n  - $\\gamma_{2}=\\pi$\n  - $V_{3}=0.5\\,\\mathrm{kJ/mol}$\n  - $\\gamma_{3}=0$\n  - $A=1.1\\,\\mathrm{kJ/mol}$\n  - $\\phi_{0}=\\pi/6$\n- 用于评估的特定二面角：$\\phi^{\\ast}=2.1\\,\\mathrm{rad}$。\n- 力矩的定义：$\\tau(\\phi)= -\\frac{\\partial U_{\\phi}}{\\partial \\phi}$。\n- 主要任务是计算在 $\\phi^{\\ast}$ 处的力矩，记为 $\\tau(\\phi^{\\ast})$。\n- 次要任务是在过阻尼旋转布朗运动的背景下解释计算出的力矩的符号和大小。\n- 最终力矩的数值答案必须以 $\\mathrm{kJ/mol}$ 为单位表示，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础扎实**：该问题在计算化学和经典力学的原理上有坚实的基础。势能函数是分子力学（MM）力场中用于描述扭转势的标准傅里叶级数表示。增加一个余弦项来模拟外场是一个物理上合理的近似。力矩定义为势能的负梯度是力学中的一个基本概念。过阻尼旋转布朗运动的背景是描述分子在粘性环境（如催化剂表面）中旋转的正确物理框架。\n- **适定的**：该问题在数学上是适定的。势函数被明确定义，并且所有必要的参数都已提供。任务涉及一个直接的函数求导和求值，这会得到一个唯一且稳定的解。\n- **客观的**：问题陈述使用了精确、定量和无偏见的语言。没有主观或模棱两可的术语。\n- **完整性和一致性**：问题是自洽的。所有变量、常数和势的函数形式都已给出。单位是一致的：能量项的单位是 $\\mathrm{kJ/mol}$，角度的单位是弧度。能量对无量纲角度（$\\mathrm{rad}$）的导数具有能量的单位，因此要求力矩以 $\\mathrm{kJ/mol}$ 为单位在量纲上是正确的。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个物理化学中的标准、定义明确的问题，旨在测试微积分的应用以及对势能面的物理诠释。我将继续进行解答。\n\n第一步是通过对势能函数 $U_{\\phi}(\\phi)$ 关于二面角 $\\phi$ 求导，来推导力矩 $\\tau(\\phi)$ 的解析表达式。问题将力矩定义为 $\\tau(\\phi) = -\\frac{\\partial U_{\\phi}}{\\partial \\phi}$。\n\n势能由下式给出：\n$$\nU_{\\phi}(\\phi) = \\sum_{n=1}^{3} \\frac{V_{n}}{2}\\left[1+\\cos(n\\phi-\\gamma_{n})\\right] + A\\cos(\\phi-\\phi_{0})\n$$\n我们首先计算 $U_{\\phi}(\\phi)$ 对 $\\phi$ 的偏导数：\n$$\n\\frac{\\partial U_{\\phi}}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\left( \\sum_{n=1}^{3} \\frac{V_{n}}{2}\\left[1+\\cos(n\\phi-\\gamma_{n})\\right] + A\\cos(\\phi-\\phi_{0}) \\right)\n$$\n使用链式法则求导，$\\frac{d}{dx}\\cos(ax+b) = -a\\sin(ax+b)$，我们对每一项进行微分：\n$$\n\\frac{\\partial U_{\\phi}}{\\partial \\phi} = \\sum_{n=1}^{3} \\frac{V_{n}}{2}\\left[ -n\\sin(n\\phi-\\gamma_{n}) \\right] - A\\sin(\\phi-\\phi_{0})\n$$\n$$\n\\frac{\\partial U_{\\phi}}{\\partial \\phi} = -\\sum_{n=1}^{3} \\frac{nV_{n}}{2}\\sin(n\\phi-\\gamma_{n}) - A\\sin(\\phi-\\phi_{0})\n$$\n力矩 $\\tau(\\phi)$ 是该导数的负值：\n$$\n\\tau(\\phi) = -\\frac{\\partial U_{\\phi}}{\\partial \\phi} = \\sum_{n=1}^{3} \\frac{nV_{n}}{2}\\sin(n\\phi-\\gamma_{n}) + A\\sin(\\phi-\\phi_{0})\n$$\n将 $n=1, 2, 3$ 的求和展开：\n$$\n\\tau(\\phi) = \\frac{V_{1}}{2}\\sin(\\phi-\\gamma_{1}) + \\frac{2V_{2}}{2}\\sin(2\\phi-\\gamma_{2}) + \\frac{3V_{3}}{2}\\sin(3\\phi-\\gamma_{3}) + A\\sin(\\phi-\\phi_{0})\n$$\n$$\n\\tau(\\phi) = \\frac{V_{1}}{2}\\sin(\\phi-\\gamma_{1}) + V_{2}\\sin(2\\phi-\\gamma_{2}) + \\frac{3V_{3}}{2}\\sin(3\\phi-\\gamma_{3}) + A\\sin(\\phi-\\phi_{0})\n$$\n现在，我们代入给定的参数值和特定角度 $\\phi^{\\ast} = 2.1\\,\\mathrm{rad}$。所有能量单位（$V_n$，$A$）均为 $\\mathrm{kJ/mol}$，因此得到的力矩单位也将是 $\\mathrm{kJ/mol}$。\n给定值：\n$V_{1}=3.2$, $\\gamma_{1}=0$\n$V_{2}=0.8$, $\\gamma_{2}=\\pi$\n$V_{3}=0.5$, $\\gamma_{3}=0$\n$A=1.1$, $\\phi_{0}=\\pi/6$\n$\\phi^{\\ast}=2.1$\n$$\n\\tau(\\phi^{\\ast}) = \\frac{3.2}{2}\\sin(2.1-0) + 0.8\\sin(2(2.1)-\\pi) + \\frac{3(0.5)}{2}\\sin(3(2.1)-0) + 1.1\\sin(2.1-\\frac{\\pi}{6})\n$$\n$$\n\\tau(2.1) = 1.6\\sin(2.1) + 0.8\\sin(4.2-\\pi) + 0.75\\sin(6.3) + 1.1\\sin(2.1-\\frac{\\pi}{6})\n$$\n我们对每一项进行数值计算，确保计算器处于弧度模式。我们使用 $\\pi \\approx 3.14159265$。\n- 第1项：$1.6\\sin(2.1) \\approx 1.6 \\times 0.863209 = 1.381134$\n- 第2项：$0.8\\sin(4.2 - \\pi) \\approx 0.8\\sin(1.058407) \\approx 0.8 \\times 0.871630 = 0.697304$\n- 第3项：$0.75\\sin(6.3) \\approx 0.75\\sin(6.3 - 2\\pi) \\approx 0.75\\sin(0.016815) \\approx 0.75 \\times 0.016814 = 0.012611$\n- 第4项：$1.1\\sin(2.1 - \\frac{\\pi}{6}) \\approx 1.1\\sin(2.1 - 0.523599) \\approx 1.1\\sin(1.576401) \\approx 1.1 \\times 0.999981 = 1.099979$\n\n将这些项相加：\n$$\n\\tau(2.1) \\approx 1.381134 + 0.697304 + 0.012611 + 1.099979 = 3.191028 \\,\\mathrm{kJ/mol}\n$$\n四舍五入到四位有效数字，我们得到 $3.191\\,\\mathrm{kJ/mol}$。\n\n接下来，我们解释这个结果的符号和大小。\n在过阻尼旋转布朗运动的框架中，二面角 $\\phi$ 的旋转动力学由过阻尼朗之万方程控制：\n$$\n\\zeta \\frac{d\\phi}{dt} = \\tau(\\phi) + \\eta(t)\n$$\n其中 $\\zeta$ 是旋转摩擦系数，$\\eta(t)$ 是一个随机力矩，代表来自环境的随机热冲击，且 $\\langle \\eta(t) \\rangle = 0$。该方程表明，角度的平均变化率，或称漂移速度，与系统力矩成正比：$\\langle \\frac{d\\phi}{dt} \\rangle = \\frac{\\tau(\\phi)}{\\zeta}$。\n\n1.  **符号的解释**：计算出的力矩 $\\tau(\\phi^{\\ast}) = +3.191\\,\\mathrm{kJ/mol}$ 是正的。正力矩表示当 $\\phi$ 从 $\\phi^{\\ast}$ 增加时，势能 $U_{\\phi}$ 减小（因为 $\\tau = -\\frac{\\partial U_{\\phi}}{\\partial \\phi}$）。这意味着系统经历一个系统性的“力”，驱动二面角向 $\\phi$ 增大的方向旋转。这种旋转运动朝向一个必定存在于角度 $\\phi  \\phi^{\\ast}$ 处的局域势能最小值。\n\n2.  **大小的解释**：力矩的大小为 $|\\tau| \\approx 3.191\\,\\mathrm{kJ/mol}$。为了更好地理解其大小，我们将其与室温（$T \\approx 300\\,\\mathrm{K}$）下的热能尺度进行比较，热能尺度为 $k_{B}T \\approx (8.314 \\times 10^{-3} \\,\\mathrm{kJ/(mol \\cdot K)}) \\times 300\\,\\mathrm{K} \\approx 2.5\\,\\mathrm{kJ/mol}$。计算出的力矩与热能尺度在同一数量级。这表明定向旋转的驱动力与随机化的热作用力相比是显著的。虽然布朗运动会导致 $\\phi$ 的随机涨落，但该力矩引起的漂移是强烈的。这意味着在 $\\phi^{\\ast}=2.1\\,\\mathrm{rad}$ 处，该中间体位于其势能面一个相对陡峭的斜坡上，远离力矩为零的驻点（最小值或最大值）。因此，旋转扩散是强偏倚的。",
            "answer": "$$\n\\boxed{3.191}\n$$"
        },
        {
            "introduction": "一个精确的力场是成功模拟的必要条件，但并非充分条件。本练习旨在解决一个普遍存在的实际挑战：如何从一个不完美的初始结构开始进行模拟。你将分析为何原子间的严重重叠会导致灾难性的模拟发散，并学习一套稳健、多阶段的方案来安全地弛豫系统，直至达到物理上有意义的平衡态，为后续的“生产”阶段模拟铺平道路 ()。",
            "id": "3890794",
            "problem": "一个催化分子力学模拟，其内容是吸附物接近微孔铝硅酸盐骨架中的 Brønsted 酸位点，该模拟从一个准备不佳的几何结构开始初始化。发现若干非键合原子对的间距为 $r \\approx 0.3\\,\\mathrm{\\AA}$，而非键合参数是典型的 van der Waals 相互作用参数，其值为 $\\sigma \\approx 3.4\\,\\mathrm{\\AA}$ 和 $\\epsilon \\approx 0.238\\,\\mathrm{kcal/mol}$。分子动力学（MD, Molecular Dynamics）的积分器是速度 Verlet 算法，时间步长为 $\\Delta t = 1\\,\\mathrm{fs}$，系综最初是恒定粒子数、体积和温度的 NVT 系综（constant number of particles, volume, and temperature）。模拟立即发散，在几个积分步长内，位置和速度就变得不符合物理规律。\n\n仅使用“力是势能的负梯度”的定义和 Newton 第二定律“加速度是力除以质量”，从这些基本原理出发，解释为什么分子力学力场中严重的非物理重叠会导致使用标准时间步长的 MD 发生数值发散。然后，选择一个指定了科学合理且稳健的程序序列的选项，该程序用于消除重叠并平衡体系，以便在计算催化中进行后续的生产动力学模拟。\n\nA. 跳过能量最小化，直接在恒定粒子数、压力和温度的 NPT 系综（constant number of particles, pressure, and temperature）中，于 $600\\,\\mathrm{K}$ 温度下开始 MD，时间步长为 $\\Delta t = 4\\,\\mathrm{fs}$，依赖恒温器和恒压器的耦合来耗散多余的能量。\n\nB. 使用完整的非键合相互作用，执行 $100$ 步共轭梯度最小化，然后在 $300\\,\\mathrm{K}$ 下运行 $1\\,\\mathrm{ns}$ 的 NVT 模拟，时间步长为 $\\Delta t = 2\\,\\mathrm{fs}$，且不对含氢键进行约束。\n\nC. 依次进行最小化和平衡：首先对骨架重原子施加位置限制，并使用带线搜索的最速下降法弛豫氢原子和吸附物，直到最大力低于 $1000\\,\\mathrm{kcal/mol/\\AA}$；然后切换到共轭梯度法，直到均方根（RMS）力低于 $10\\,\\mathrm{kcal/mol/\\AA}$。接下来，在 NVT 系综中，使用 $\\Delta t = 0.5\\,\\mathrm{fs}$ 的时间步长并对含氢键进行约束，在 $50\\,\\mathrm{ps}$ 内从 $0\\,\\mathrm{K}$ 缓慢加热到 $300\\,\\mathrm{K}$；随后，在对骨架施加弱位置限制的情况下，进行 $200\\,\\mathrm{ps}$ 的 NPT 模拟。只有在平衡之后，才将生产 MD 的时间步长 $\\Delta t$ 增加到 $2\\,\\mathrm{fs}$。\n\nD. 在 $1000\\,\\mathrm{K}$ 温度下，使用 $\\Delta t = 3\\,\\mathrm{fs}$ 的时间步长运行 $10\\,\\mathrm{ps}$，同时通过设置 $\\epsilon = 0$ 暂时消除排斥力，让原子得以分开；之后恢复原始的非键合参数，并继续进行标准的 MD 模拟。\n\n选择一个最佳选项，该选项既能正确解释非物理重叠处的发散机制，又提出一个稳健、物理上合理的最小化和平衡方案。",
            "solution": "该问题要求两部分内容：首先，从根本上解释为什么严重的非键合重叠会导致分子动力学（MD）模拟中的数值发散；其次，确定一个稳健的程序序列来解决这个问题。\n\n**第一部分：模拟发散的基本原理**\n\n发散源于势能函数、Newton 第二定律以及 MD 中使用的数值积分算法之间的相互作用。\n\n1.  **力与势能**：作用在粒子上的力 $\\vec{F}$ 定义为势能函数 $V$ 的负梯度。\n    $$ \\vec{F} = -\\nabla V $$\n    对于非键合相互作用，一个常见的模型是 Lennard-Jones (LJ) 势 $V_{LJ}$，它将能量描述为原子间距离 $r$ 的函数：\n    $$ V_{LJ}(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] $$\n    这里，$\\epsilon$ 是势阱深度，$\\sigma$ 是势能为零时的距离。第一项与 $r^{-12}$ 成正比，代表强烈的短程 Pauli 排斥力；第二项与 $r^{-6}$ 成正比，代表较弱的长程 van der Waals 吸引力。\n\n    力的大小是势能对距离的负导数：\n    $$ F(r) = -\\frac{dV_{LJ}}{dr} = \\frac{24\\epsilon}{r} \\left[ 2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] $$\n    问题中指出，发现原子对的间距为 $r \\approx 0.3\\,\\mathrm{\\AA}$，而典型的 LJ 参数为 $\\sigma \\approx 3.4\\,\\mathrm{\\AA}$。这构成了严重的原子重叠，因为 $r \\ll \\sigma$。在这种条件下，势能中的排斥项 $r^{-12}$ 和力中的相应项 $r^{-13}$ 占主导地位。比率 $\\sigma/r$ 约为 $3.4/0.3 \\approx 11.3$。力的大小与 $(\\sigma/r)^{12}$ 成正比，导致重叠原子之间产生天文数字般巨大的排斥力。\n\n2.  **Newton 第二定律**：Newton 第二定律指出，质量为 $m$ 的粒子的加速度 $\\vec{a}$ 与作用在其上的合力成正比。\n    $$ \\vec{a} = \\frac{\\vec{F}}{m} $$\n    如上所述计算出的巨大力 $\\vec{F}$ 会导致巨大的加速度 $\\vec{a}$。\n\n3.  **数值积分**：MD 模拟使用数值积分器（如本题指定的速度 Verlet 算法）在时间上推进系统。该算法在有限的时间步长 $\\Delta t$ 内更新位置 $\\vec{r}$ 和速度 $\\vec{v}$。位置更新由下式给出：\n    $$ \\vec{r}(t + \\Delta t) = \\vec{r}(t) + \\vec{v}(t)\\Delta t + \\frac{1}{2}\\vec{a}(t)(\\Delta t)^2 $$\n    该方程由位置的 Taylor 级数展开式导出。为了使积分稳定和准确，力（以及加速度）在时间步长 $\\Delta t$ 内不能发生剧烈变化。\n    当存在巨大的加速度 $\\vec{a}(t)$ 时，一个时间步长内的位移，特别是 $\\frac{1}{2}\\vec{a}(t)(\\Delta t)^2$ 项，会变得极大。即使使用 $\\Delta t=1\\,\\mathrm{fs}$ 的标准时间步长，原子也会被推到几埃甚至几纳米远的新位置，这在物理上是荒谬的。这种剧烈的位移可能会与其他原子产生新的、甚至更严重的重叠，或者将原子抛出模拟盒子。这会形成一个正反馈循环，后续的力和加速度会更大，从而导致数值积分的灾难性失败，表现为能量、位置和速度的发散。\n\n总之，严重的原子重叠会产生巨大的力。这些力产生的加速度如此之大，以至于数值积分器的有限时间步长不足以准确描述由此产生的运动，导致粒子在单一步骤中位移过大的非物理距离，从而引发数值不稳定和发散。\n\n**第二部分：对所提程序的评估**\n\n**A. 跳过能量最小化，直接在恒定粒子数、压力和温度的 NPT 系综（constant number of particles, pressure, and temperature）中，于 $600\\,\\mathrm{K}$ 温度下开始 MD，时间步长为 $\\Delta t = 4\\,\\mathrm{fs}$，依赖恒温器和恒压器的耦合来耗散多余的能量。**\n这个程序存在根本性缺陷并且很危险。\n- **跳过最小化**：核心问题是由巨大的力引起的过高势能。能量最小化是消除这些张力的必要第一步。跳过它保证了模拟会发散。\n- **高温**：在一个已经充满巨大势能的系统上从高温（$600\\,\\mathrm{K}$）开始，会增加大量的动能，加剧不稳定性。\n- **大时间步长**：模拟发散是因为 $1\\,\\mathrm{fs}$ 的标准时间步长对于当前的力的大小来说已经太大了。将时间步长增加到 $4\\,\\mathrm{fs}$ 将导致更快、更剧烈的数值爆炸。$4\\,\\mathrm{fs}$ 的时间步长仅适用于高度约束、完全平衡的系统（如果适用的话）。\n- **依赖恒温器/恒压器**：恒温器和恒压器旨在调节平衡态附近的温度和压力波动，这需要多个时间步长才能实现。它们无法应对原子严重碰撞瞬间释放的巨大能量。在这些控制算法能产生任何有意义的效果之前，模拟早已崩溃。\n**结论：不正确。**\n\n**B. 使用完整的非键合相互作用，执行 $100$ 步共轭梯度最小化，然后在 $300\\,\\mathrm{K}$ 下运行 $1\\,\\mathrm{ns}$ 的 NVT 模拟，时间步长为 $\\Delta t = 2\\,\\mathrm{fs}$，且不对含氢键进行约束。**\n这个程序比 A 有所改进，但仍存在严重缺陷。\n- **最小化策略**：虽然正确地将最小化确定为必要步骤，但对于一个有严重碰撞的系统，从一开始就使用共轭梯度（CG）法并不理想。对于高度张紧结构的初始弛豫，最速下降法更为稳健。此外，仅仅 $100$ 步的最小化很可能不足以解决所述的极端重叠问题。\n- **MD 参数**：立即以 $\\Delta t = 2\\,\\mathrm{fs}$ 的时间步长开始 MD 过于激进。最关键的是，在不约束含氢原子键（如 O-H、C-H）的高频振动的情况下使用 $2\\,\\mathrm{fs}$ 的时间步长是导致不稳定的常见原因。这些振动的周期约为 $10\\,\\mathrm{fs}$，准确地积分它们需要 $1\\,\\mathrm{fs}$ 或更小的时间步长。没有约束，即使初始最小化成功，模拟也很可能失败。\n**结论：不正确。**\n\n**C. 依次进行最小化和平衡：首先对骨架重原子施加位置限制，并使用带线搜索的最速下降法弛豫氢原子和吸附物，直到最大力低于 $1000\\,\\mathrm{kcal/mol/\\AA}$；然后切换到共轭梯度法，直到均方根（RMS）力低于 $10\\,\\mathrm{kcal/mol/\\AA}$。接下来，在 NVT 系综中，使用 $\\Delta t = 0.5\\,\\mathrm{fs}$ 的时间步长并对含氢键进行约束，在 $50\\,\\mathrm{ps}$ 内从 $0\\,\\mathrm{K}$ 缓慢加热到 $300\\,\\mathrm{K}$；随后，在对骨架施加弱位置限制的情况下，进行 $200\\,\\mathrm{ps}$ 的 NPT 模拟。只有在平衡之后，才将生产 MD 的时间步长 $\\Delta t$ 增加到 $2\\,\\mathrm{fs}$。**\n此选项描述了一个全面、多阶段且物理上合理的“最佳实践”方案。\n- **分阶段最小化**：它正确地从稳健的最速下降法开始处理初始的大作用力，然后切换到更高效的共轭梯度法进行更精细的优化。这是一个标准且有效的策略。\n- **位置限制**：对大部分骨架施加限制，同时允许移动的吸附物和氢原子弛豫，这是一种在不破坏整体结构的情况下解决局部碰撞的绝佳技术。\n- **逐步升温**：在一个较长的时间段（$50\\,\\mathrm{ps}$）内将系统从低温（如 $0\\,\\mathrm{K}$）缓慢加热，使系统能够温和地达到热平衡，避免了瞬间增加大量动能所带来的冲击。\n- **保守的 MD 参数**：在精细的加热和初始平衡阶段，使用了小而安全的时间步长（$\\Delta t = 0.5\\,\\mathrm{fs}$）。它还正确地对含氢键施加了约束，这对于之后使用更大的时间步长是必要的。\n- **多系综平衡**：它正确地使用 NVT 阶段进行热平衡，然后使用 NPT 阶段进行密度/压力平衡。\n- **延迟的生产模拟**：只有在完成这个彻底而谨慎的平衡方案后，才开始使用更大、更高效的时间步长（$\\Delta t = 2\\,\\mathrm{fs}$）进行最终的生产 MD。\n**结论：正确。**\n\n**D. 在 $1000\\,\\mathrm{K}$ 温度下，使用 $\\Delta t = 3\\,\\mathrm{fs}$ 的时间步长运行 $10\\,\\mathrm{ps}$，同时通过设置 $\\epsilon = 0$ 暂时消除排斥力，让原子得以分开；之后恢复原始的非键合参数，并继续进行标准的 MD 模拟。**\n这个方法在物理上是荒谬的，不能解决问题。\n- **设置 $\\epsilon = 0$**：这个操作消除了所有的 Lennard-Jones 相互作用（包括排斥和吸引），实际上是将原子变成了可以相互穿过的理想气体粒子。这并不能解决重叠问题，只是忽略了它们。原子将根据它们的键合相互作用（如果有的话）和动能随机漂移。\n- **恢复参数**：当经过 $10\\,\\mathrm{ps}$ 的随机漂移后突然重新开启 LJ 参数时，极有可能已经产生了新的严重原子重叠。系统将体验到与初始构型相同或更糟的巨大作用力，导致立即发散。这种方法注定会失败。正确的“软核势”方法会逐步缩放相互作用以避免此问题，而这不是那种方法。\n**结论：不正确。**",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}