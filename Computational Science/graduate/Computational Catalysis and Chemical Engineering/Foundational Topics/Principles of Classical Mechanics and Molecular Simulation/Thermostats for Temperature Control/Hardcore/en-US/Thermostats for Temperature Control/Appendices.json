{
    "hands_on_practices": [
        {
            "introduction": "This practice serves as a foundational exercise in understanding how a thermostat algorithm translates a continuous-time relaxation model into a discrete action within a simulation. We focus on the Berendsen thermostat, an intuitive method based on weak coupling to an external heat bath. By deriving and applying the velocity scaling factor directly, you will gain a concrete understanding of how the system's kinetic energy is nudged towards a target value at each time step, connecting the theoretical concept of first-order temperature relaxation to its practical implementation .",
            "id": "5274833",
            "problem": "Consider a constant-number, constant-volume Molecular Dynamics (MD) simulation of a biomolecular system with $N_f$ classical degrees of freedom, where temperature is controlled by a velocity-rescaling weak-coupling thermostat of the Berendsen type. The instantaneous kinetic temperature $T_{\\mathrm{inst}}$ is defined via equipartition as $T_{\\mathrm{inst}} = \\frac{2K}{N_f k_B}$, where $K$ is the total kinetic energy and $k_B$ is the Boltzmann constant. At each MD time step, all velocities are scaled by a common factor $\\alpha$, and positions are advanced according to Newton’s equations of motion.\n\nAssume that the target temperature is $T_0$ and that the thermostat imposes a first-order relaxation of the kinetic temperature governed by the ordinary differential equation $\\frac{dT}{dt} = \\frac{1}{\\tau_T}\\left(T_0 - T\\right)$, where $\\tau_T$ is the thermostat time constant. Enforce consistency between the discrete velocity rescaling $v_i \\mapsto \\alpha v_i$ and a first-order forward-Euler integration of the relaxation equation for $T$ over one MD time step of duration $\\Delta t$.\n\nStarting from the equipartition-based definition of $T_{\\mathrm{inst}}$ and the effect of velocity rescaling on kinetic energy, derive the expression for $\\alpha$ that ensures the one-step discrete update of $T_{\\mathrm{inst}}$ matches the forward-Euler discretization of the relaxation equation. Then, for a single rescaling step with $\\tau_T = 0.1\\,\\mathrm{ps}$, $\\Delta t = 2\\,\\mathrm{fs}$, initial $T_{\\mathrm{inst}} = 320\\,\\mathrm{K}$, and target $T_0 = 300\\,\\mathrm{K}$, compute $\\alpha$ and predict the new instantaneous temperature immediately after rescaling.\n\nRound your numerical results to four significant figures. Express the final temperature in $\\mathrm{K}$. Provide your final answer as a row matrix containing $\\alpha$ and the updated $T_{\\mathrm{inst}}$ after one step.",
            "solution": "The user has provided a well-defined problem from the field of computational statistical mechanics, specifically regarding temperature control in Molecular Dynamics (MD) simulations using a Berendsen thermostat.\n\n### Step 1: Extract Givens\n- System description: Constant-number, constant-volume MD simulation with $N_f$ classical degrees of freedom.\n- Temperature control method: Berendsen-type velocity-rescaling weak-coupling thermostat.\n- Definition of instantaneous temperature: $T_{\\mathrm{inst}} = \\frac{2K}{N_f k_B}$, where $K$ is the total kinetic energy and $k_B$ is the Boltzmann constant.\n- Velocity update: At each time step, all velocities $v_i$ are scaled by a factor $\\alpha$, such that the new velocity is $v_i' = \\alpha v_i$.\n- Target temperature: $T_0$.\n- Relaxation dynamics: The thermostat imposes a first-order relaxation of the kinetic temperature $T$ according to the ordinary differential equation (ODE) $\\frac{dT}{dt} = \\frac{1}{\\tau_T}\\left(T_0 - T\\right)$, where $\\tau_T$ is the thermostat time constant.\n- Time step duration: $\\Delta t$.\n- Consistency requirement: The discrete velocity rescaling must be consistent with a first-order forward-Euler integration of the temperature relaxation ODE over one time step $\\Delta t$.\n- Numerical values for calculation:\n  - Time constant, $\\tau_T = 0.1\\,\\mathrm{ps}$.\n  - Time step, $\\Delta t = 2\\,\\mathrm{fs}$.\n  - Initial instantaneous temperature, $T_{\\mathrm{inst}} = 320\\,\\mathrm{K}$.\n  - Target temperature, $T_0 = 300\\,\\mathrm{K}$.\n- Required output:\n  1. An analytical expression for the scaling factor $\\alpha$.\n  2. The numerical value of $\\alpha$ and the new instantaneous temperature after one rescaling step, with results rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing the standard implementation of the Berendsen thermostat, a common algorithm in molecular simulations. The underlying principles—the equipartition theorem and first-order kinetics—are well-established. The problem is well-posed, providing all necessary definitions, equations, and parameters to derive a unique solution. The language is objective and precise. All provided numerical values are physically realistic for a biomolecular simulation. The problem is therefore deemed **valid**.\n\n### Step 3: Derivation and Calculation\n\n#### Part 1: Derivation of the Scaling Factor $\\alpha$\n\nWe are tasked with relating two different views of the temperature change over a single MD time step, $\\Delta t$.\n\nFirst, consider the effect of velocity rescaling on the instantaneous temperature. Let $T$ be the instantaneous temperature at the beginning of the time step. By definition, $T = \\frac{2K}{N_f k_B}$, where $K$ is the total kinetic energy of the system. The kinetic energy is given by $K = \\sum_i \\frac{1}{2} m_i v_i^2$.\n\nThe velocities are rescaled by a factor $\\alpha$, so the new velocities are $v_i' = \\alpha v_i$. The new kinetic energy, $K'$, is:\n$$K' = \\sum_i \\frac{1}{2} m_i (v_i')^2 = \\sum_i \\frac{1}{2} m_i (\\alpha v_i)^2 = \\alpha^2 \\left( \\sum_i \\frac{1}{2} m_i v_i^2 \\right) = \\alpha^2 K$$\nThe new instantaneous temperature, $T'$, is related to the new kinetic energy $K'$:\n$$T' = \\frac{2K'}{N_f k_B} = \\frac{2(\\alpha^2 K)}{N_f k_B} = \\alpha^2 \\left( \\frac{2K}{N_f k_B} \\right)$$\nThus, the temperature change due to velocity rescaling is:\n$$T' = \\alpha^2 T$$\n\nSecond, consider the change in temperature dictated by the relaxation equation, $\\frac{dT}{dt} = \\frac{1}{\\tau_T}(T_0 - T)$. We discretize this ODE using a first-order forward-Euler scheme over a time interval $\\Delta t$. The derivative $\\frac{dT}{dt}$ is approximated as $\\frac{T' - T}{\\Delta t}$, where $T'$ is the temperature at the end of the time step.\n$$\\frac{T' - T}{\\Delta t} \\approx \\frac{1}{\\tau_T}(T_0 - T)$$\nSolving for the new temperature $T'$ gives:\n$$T' \\approx T + \\frac{\\Delta t}{\\tau_T}(T_0 - T)$$\n\nTo ensure consistency, we equate the two expressions for the new temperature $T'$:\n$$\\alpha^2 T = T + \\frac{\\Delta t}{\\tau_T}(T_0 - T)$$\nTo solve for $\\alpha$, we divide by $T$ (assuming $T \\neq 0$, which is a valid physical assumption for a system at finite temperature):\n$$\\alpha^2 = 1 + \\frac{\\Delta t}{\\tau_T}\\left(\\frac{T_0 - T}{T}\\right) = 1 + \\frac{\\Delta t}{\\tau_T}\\left(\\frac{T_0}{T} - 1\\right)$$\nTaking the positive square root (as $\\alpha$ is a scaling factor, typically positive to preserve the direction of velocities) yields the final expression for $\\alpha$:\n$$\\alpha = \\sqrt{1 + \\frac{\\Delta t}{\\tau_T}\\left(\\frac{T_0}{T} - 1\\right)}$$\nThis completes the derivation.\n\n#### Part 2: Numerical Calculation\n\nWe are given the following values:\n- $\\tau_T = 0.1\\,\\mathrm{ps} = 0.1 \\times 10^{-12}\\,\\mathrm{s}$\n- $\\Delta t = 2\\,\\mathrm{fs} = 2 \\times 10^{-15}\\,\\mathrm{s}$\n- Initial temperature, $T = T_{\\mathrm{inst}} = 320\\,\\mathrm{K}$\n- Target temperature, $T_0 = 300\\,\\mathrm{K}$\n\nFirst, we compute the dimensionless ratio $\\frac{\\Delta t}{\\tau_T}$:\n$$\\frac{\\Delta t}{\\tau_T} = \\frac{2 \\times 10^{-15}\\,\\mathrm{s}}{0.1 \\times 10^{-12}\\,\\mathrm{s}} = \\frac{2 \\times 10^{-15}\\,\\mathrm{s}}{1 \\times 10^{-13}\\,\\mathrm{s}} = 2 \\times 10^{-2} = 0.02$$\nNow, substitute this and the temperatures into the expression for $\\alpha^2$:\n$$\\alpha^2 = 1 + 0.02 \\left(\\frac{300\\,\\mathrm{K}}{320\\,\\mathrm{K}} - 1\\right)$$\n$$\\alpha^2 = 1 + 0.02 \\left(0.9375 - 1\\right)$$\n$$\\alpha^2 = 1 + 0.02(-0.0625)$$\n$$\\alpha^2 = 1 - 0.00125$$\n$$\\alpha^2 = 0.99875$$\nNow we calculate $\\alpha$ by taking the square root:\n$$\\alpha = \\sqrt{0.99875} \\approx 0.999374811...$$\nRounding to four significant figures, we get:\n$$\\alpha \\approx 0.9994$$\n\nNext, we predict the new instantaneous temperature, $T'$, immediately after rescaling. We can use the forward-Euler expression for this calculation to avoid propagating rounding error from our calculated $\\alpha$.\n$$T' = T + \\frac{\\Delta t}{\\tau_T}(T_0 - T)$$\n$$T' = 320\\,\\mathrm{K} + 0.02(300\\,\\mathrm{K} - 320\\,\\mathrm{K})$$\n$$T' = 320\\,\\mathrm{K} + 0.02(-20\\,\\mathrm{K})$$\n$$T' = 320\\,\\mathrm{K} - 0.4\\,\\mathrm{K}$$\n$$T' = 319.6\\,\\mathrm{K}$$\nThis result already has four significant figures.\n\nThe two requested values are the scaling factor $\\alpha$ and the new instantaneous temperature $T'$.\n$\\alpha \\approx 0.9994$\n$T' = 319.6\\,\\mathrm{K}$\n\nWe present these results as a row matrix as requested.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.9994  319.6 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the concept of velocity scaling, this practice moves from a single calculation to a full implementation within a molecular dynamics simulation. You will write a program to integrate the motion of a simple harmonic oscillator using the velocity Verlet algorithm, a cornerstone of molecular simulation. This exercise provides a direct comparison between the ad-hoc Berendsen thermostat and the more rigorous, dynamics-preserving Nosé-Hoover thermostat, offering crucial insights into their algorithmic differences and the practical consequences for simulating a system's trajectory .",
            "id": "2466061",
            "problem": "You are given a single particle of mass $m$ moving in one spatial dimension $x$ in a harmonic potential with stiffness $k$. The potential energy is $U(x) = \\tfrac{1}{2} k x^2$ and the force is $F(x) = -\\tfrac{\\partial U}{\\partial x} = -k x$. The particle is to be propagated in reduced units (dimensionless) where $m = 1$, $k = 1$, and the Boltzmann constant $k_{\\mathrm{B}} = 1$. The single-particle number of quadratic degrees of freedom is $g = 1$. The instantaneous kinetic energy is $K = \\tfrac{1}{2} m v^2$, and the instantaneous kinetic temperature is defined by the equipartition relation $K = \\tfrac{g}{2} k_{\\mathrm{B}} T$, which in these reduced units gives $T = \\tfrac{2 K}{g}$.\n\nTwo temperature-control schemes are to be compared:\n\n1. The Berendsen weak-coupling thermostat: The kinetic temperature $T(t)$ relaxes toward a target temperature $T_0$ following the first-order relaxation equation $\\dfrac{\\mathrm{d}T}{\\mathrm{d}t} = \\dfrac{T_0 - T}{\\tau_{\\mathrm{B}}}$ with coupling time $\\tau_{\\mathrm{B}}  0$. At each discrete time step of size $\\Delta t$, implement a single rescaling of the particle velocity that achieves the discrete relaxation of $T$ implied by this continuous equation over the interval $\\Delta t$. The rescaling must be applied exactly once per time step and must occur after completing the full position update and both force-based half velocity updates.\n\n2. The Nosé–Hoover thermostat: Introduce a thermostat friction variable $\\xi$ with thermostat mass parameter $Q  0$. The coupled ordinary differential equations are\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = v,\\quad\n\\frac{\\mathrm{d}v}{\\mathrm{d}t} = \\frac{F(x)}{m} - \\xi\\, v,\\quad\n\\frac{\\mathrm{d}\\xi}{\\mathrm{d}t} = \\frac{2K - g k_{\\mathrm{B}} T_0}{Q}.\n$$\nIntegrate these equations using a symmetric, second-order, time-reversible splitting that reduces to the velocity Verlet scheme when the thermostat coupling is removed. Within each time step of size $\\Delta t$, the placement must be such that the thermostat variable $\\xi$ is advanced by a half step at the beginning and at the end of each step, and the multiplicative velocity scaling associated with $\\xi$ acts in half steps symmetrically around the force-based half velocity updates and the position update. Concretely, within each step: perform a thermostat half update of $\\xi$, then a half-step multiplicative velocity scaling by $\\exp(-\\xi \\Delta t/2)$, then the standard force half update of $v$, then the drift of $x$, then the second force half update of $v$, then the second half-step multiplicative velocity scaling by $\\exp(-\\xi \\Delta t/2)$, and finally the thermostat half update of $\\xi$. The kinetic energy $K$ used in the thermostat updates of $\\xi$ must be computed from the instantaneous $v$ at the moment of each thermostat half update.\n\nInitial conditions are fixed to $x(0) = x_0 = 1.0$, $v(0) = v_0 = 2.0$. For the Nosé–Hoover thermostat, the initial friction variable is $\\xi(0) = 0.0$. The target temperature is $T_0 = 1.0$ in reduced temperature units (dimensionless).\n\nYour task is to implement a program that integrates the dynamics for a specified number of time steps and then reports the final instantaneous kinetic temperature $T$ for each case in the test suite below. All temperatures must be expressed in reduced temperature units (dimensionless).\n\nTest suite (each item specifies the thermostat type, the time step $\\Delta t$, the number of steps $N$, and the thermostat parameter):\n\n- Test $1$ (Berendsen, fast coupling): $\\Delta t = 0.01$, $N = 5000$, $\\tau_{\\mathrm{B}} = 0.05$.\n- Test $2$ (Berendsen, weak coupling): $\\Delta t = 0.01$, $N = 5000$, $\\tau_{\\mathrm{B}} = 5.0$.\n- Test $3$ (Nosé–Hoover, moderate coupling): $\\Delta t = 0.002$, $N = 20000$, $Q = 1.0$.\n- Test $4$ (Nosé–Hoover, near microcanonical limit): $\\Delta t = 0.002$, $N = 20000$, $Q = 10^6$.\n- Test $5$ (No thermostat, microcanonical reference using velocity Verlet): $\\Delta t = 0.01$, $N = 5000$.\n\nFor Tests $1$ and $2$ you must implement the Berendsen temperature control by a single velocity rescaling per step that produces the discrete-time relaxation of $T$ over $\\Delta t$ implied by $\\dfrac{\\mathrm{d}T}{\\mathrm{d}t} = \\dfrac{T_0 - T}{\\tau_{\\mathrm{B}}}$, applied strictly after the completion of the standard velocity Verlet step (half force update of $v$, full drift of $x$, second half force update of $v$). For Tests $3$ and $4$ you must implement the Nosé–Hoover thermostat using the symmetric ordering specified above. For Test $5$ you must use the standard velocity Verlet integrator with no thermostat.\n\nYour program should produce a single line of output containing the final instantaneous kinetic temperatures for Tests $1$ through $5$ as a comma-separated list enclosed in square brackets, for example, \"[t1,t2,t3,t4,t5]\". Each $t_i$ must be a floating-point number in reduced temperature units (dimensionless).",
            "solution": "The problem requires the numerical integration of the equations of motion for a single particle in a one-dimensional harmonic potential, subject to different temperature control algorithms. The problem is well-defined, scientifically sound, and all necessary parameters and initial conditions are provided. We shall proceed with the derivation and description of the required numerical schemes before implementing them.\n\nThe system is defined by the following parameters in reduced units: particle mass $m=1$, harmonic potential stiffness $k=1$, and Boltzmann constant $k_{\\mathrm{B}}=1$. The potential energy is $U(x) = \\frac{1}{2} k x^2 = \\frac{1}{2} x^2$, and the corresponding force is $F(x) = -k x = -x$. The system has $g=1$ quadratic degree of freedom.\n\nThe instantaneous kinetic energy is $K = \\frac{1}{2} m v^2 = \\frac{1}{2} v^2$. The instantaneous kinetic temperature $T$ is defined via the equipartition theorem, $K = \\frac{g}{2} k_{\\mathrm{B}} T$. In the specified reduced units, this simplifies to $\\frac{1}{2} v^2 = \\frac{1}{2} (1) (1) T$, which yields $T = v^2$.\n\nThe initial conditions are $x(0) = 1.0$ and $v(0) = 2.0$. The target temperature for the thermostats is $T_0 = 1.0$.\n\nWe will now detail the numerical integration algorithms for the five specified test cases.\n\n**Test 5: Microcanonical Ensemble (NVE) using Velocity Verlet**\n\nThis test serves as a baseline without any thermostat. The total energy $E = K + U$ should be conserved. The integration is performed using the standard velocity Verlet algorithm, which is a symmetric, second-order symplectic integrator. For a time step $\\Delta t$, the update from time $t$ to $t+\\Delta t$ proceeds as:\n1.  Calculate the velocity at the midpoint of the time step: $v(t + \\Delta t/2) = v(t) + \\frac{F(x(t))}{m} \\frac{\\Delta t}{2}$.\n2.  Update the position using this midpoint velocity: $x(t + \\Delta t) = x(t) + v(t + \\Delta t/2) \\Delta t$.\n3.  Calculate the force at the new position: $F(x(t+\\Delta t))$.\n4.  Complete the velocity update to the end of the time step: $v(t + \\Delta t) = v(t + \\Delta t/2) + \\frac{F(x(t+\\Delta t))}{m} \\frac{\\Delta t}{2}$.\nIn our reduced units, this becomes:\n1.  $v_{mid} = v_{old} - x_{old} \\frac{\\Delta t}{2}$.\n2.  $x_{new} = x_{old} + v_{mid} \\Delta t$.\n3.  $v_{new} = v_{mid} - x_{new} \\frac{\\Delta t}{2}$.\n\n\n**Tests 1 and 2: Berendsen Thermostat**\n\nThe Berendsen thermostat weakly couples the system to an external heat bath, forcing the kinetic temperature $T$ to relax towards the target temperature $T_0$ according to the first-order differential equation:\n$$\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{T_0 - T}{\\tau_{\\mathrm{B}}}\n$$\nwhere $\\tau_{\\mathrm{B}}$ is the coupling time constant. To implement this numerically, we first perform a full velocity Verlet step as described above. Let the velocity after the Verlet step be $v_{Verlet}$, corresponding to a temperature $T_{Verlet} = v_{Verlet}^2$. We then rescale the velocity to obtain a new temperature $T_{new}$ that approximates the solution to the relaxation equation over the time step $\\Delta t$.\n\nA first-order finite difference approximation gives the target temperature for the next step:\n$$\nT_{new} = T_{Verlet} + \\frac{\\Delta t}{\\tau_{\\mathrm{B}}} (T_0 - T_{Verlet})\n$$\nThe velocity is rescaled by a factor $\\lambda$, such that $v_{new} = \\lambda v_{Verlet}$. The new temperature is then $T_{new} = v_{new}^2 = \\lambda^2 v_{Verlet}^2 = \\lambda^2 T_{Verlet}$. Equating the two expressions for $T_{new}$ gives:\n$$\n\\lambda^2 T_{Verlet} = T_{Verlet} + \\frac{\\Delta t}{\\tau_{\\mathrm{B}}} (T_0 - T_{Verlet})\n$$\nSolving for the scaling factor $\\lambda$, we obtain:\n$$\n\\lambda = \\sqrt{1 + \\frac{\\Delta t}{\\tau_{\\mathrm{B}}} \\left( \\frac{T_0}{T_{Verlet}} - 1 \\right)}\n$$\nThe procedure for each time step is:\n1.  Perform one full velocity Verlet step to get $x_{new}$ and $v_{Verlet}$.\n2.  Calculate the temperature $T_{Verlet} = v_{Verlet}^2$.\n3.  Calculate the scaling factor $\\lambda$ using the formula above. The argument of the square root must be non-negative, which is guaranteed for the given problem parameters.\n4.  Apply the scaling to the velocity: $v_{new} = \\lambda v_{Verlet}$.\nThe final state for the step is $(x_{new}, v_{new})$.\n\n**Tests 3 and 4: Nosé–Hoover Thermostat**\n\nThe Nosé–Hoover thermostat generates a canonical (NVT) ensemble by introducing an extended phase-space variable $\\xi$, which acts as a thermal reservoir. The equations of motion are given as:\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = v\n$$\n$$\n\\frac{\\mathrm{d}v}{\\mathrm{d}t} = \\frac{F(x)}{m} - \\xi v\n$$\n$$\n\\frac{\\mathrm{d}\\xi}{\\mathrm{d}t} = \\frac{2K - g k_{\\mathrm{B}} T_0}{Q} = \\frac{v^2 - T_0}{Q}\n$$\nThe problem specifies a symmetric, second-order, time-reversible splitting algorithm for integrating these equations. Let the state at the beginning of a step be $(x_n, v_n, \\xi_n)$. The state at the end of the step, $(x_{n+1}, v_{n+1}, \\xi_{n+1})$, is obtained via the following sequence:\n\n1.  **First half-update of thermostat variable**: Calculate kinetic energy $K_n = \\frac{1}{2} m v_n^2$. Update $\\xi$ for half a time step:\n    $$ \\xi_{n+1/2} = \\xi_n + \\frac{\\Delta t}{2} \\left( \\frac{2K_n - g k_{\\mathrm{B}} T_0}{Q} \\right) $$\n2.  **First half-update of velocity (thermostat part)**: Scale the velocity:\n    $$ v'_{n} = v_n \\exp\\left( -\\xi_{n+1/2} \\frac{\\Delta t}{2} \\right) $$\n3.  **First half-update of velocity (force part)**:\n    $$ v_{n+1/2} = v'_{n} + \\frac{\\Delta t}{2} \\frac{F(x_n)}{m} $$\n4.  **Full update of position**:\n    $$ x_{n+1} = x_n + v_{n+1/2} \\Delta t $$\n5.  **Second half-update of velocity (force part)**: Calculate force at new position, $F(x_{n+1})$:\n    $$ v'_{n+1} = v_{n+1/2} + \\frac{\\Delta t}{2} \\frac{F(x_{n+1})}{m} $$\n6.  **Second half-update of velocity (thermostat part)**: Scale the velocity again using the same intermediate $\\xi_{n+1/2}$:\n    $$ v_{n+1} = v'_{n+1} \\exp\\left( -\\xi_{n+1/2} \\frac{\\Delta t}{2} \\right) $$\n7.  **Second half-update of thermostat variable**: Calculate final kinetic energy $K_{n+1} = \\frac{1}{2} m v_{n+1}^2$. Complete the update for $\\xi$:\n    $$ \\xi_{n+1} = \\xi_{n+1/2} + \\frac{\\Delta t}{2} \\left( \\frac{2K_{n+1} - g k_{\\mathrm{B}} T_0}{Q} \\right) $$\n\nThis scheme is followed for all steps in Tests $3$ and $4$. For Test $4$, the large value of the thermostat mass $Q=10^6$ will result in very slow evolution of $\\xi$, making the dynamics nearly microcanonical, as the thermostat's influence is minimal over the simulation time.\n\nThe final output for each test will be the instantaneous kinetic temperature $T = v^2$ after the specified number of integration steps.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of simulating a 1D harmonic oscillator with different thermostats.\n    \"\"\"\n    \n    # Reduced unit constants from the problem statement\n    m = 1.0\n    k = 1.0\n    kb = 1.0\n    g = 1.0\n\n    # Initial conditions\n    x0 = 1.0\n    v0 = 2.0\n    xi0 = 0.0\n    \n    # Target temperature\n    T0 = 1.0\n    \n    # Test cases from the problem statement\n    test_cases = [\n        {'type': 'berendsen', 'dt': 0.01, 'N': 5000, 'params': {'tau_b': 0.05}},\n        {'type': 'berendsen', 'dt': 0.01, 'N': 5000, 'params': {'tau_b': 5.0}},\n        {'type': 'nose-hoover', 'dt': 0.002, 'N': 20000, 'params': {'Q': 1.0}},\n        {'type': 'nose-hoover', 'dt': 0.002, 'N': 20000, 'params': {'Q': 1e6}},\n        {'type': 'verlet', 'dt': 0.01, 'N': 5000, 'params': {}},\n    ]\n\n    results = []\n\n    # --- Integrator Implementations ---\n    \n    def force(x_val):\n        \"\"\"Calculates the force for the harmonic potential.\"\"\"\n        return -k * x_val\n    \n    def run_simulation(case):\n        \"\"\"\n        Runs a simulation for a given test case and returns the final temperature.\n        \"\"\"\n        sim_type = case['type']\n        dt = case['dt']\n        N = case['N']\n        params = case['params']\n        \n        x = x0\n        v = v0\n        \n        if sim_type == 'berendsen':\n            tau_b = params['tau_b']\n            for _ in range(N):\n                # Standard Velocity-Verlet step\n                v_mid = v + (force(x) / m) * (dt / 2.0)\n                x = x + v_mid * dt\n                v_verlet = v_mid + (force(x) / m) * (dt / 2.0)\n                \n                # Berendsen thermostat velocity scaling\n                T = m * v_verlet**2 / (g * kb)\n                \n                # Protect against T=0 and negative sqrt argument\n                if T == 0:\n                    lambda_val = 1.0\n                else:\n                    lambda_sq = 1.0 + (dt / tau_b) * (T0 / T - 1.0)\n                    if lambda_sq  0:\n                        lambda_sq = 0.0\n                    lambda_val = np.sqrt(lambda_sq)\n                \n                v = v_verlet * lambda_val\n\n        elif sim_type == 'nose-hoover':\n            Q = params['Q']\n            xi = xi0\n            for _ in range(N):\n                # 1. First half-update of thermostat variable xi\n                K_n = 0.5 * m * v**2\n                xi = xi + (dt / 2.0) * (2.0 * K_n - g * kb * T0) / Q\n                \n                # 2. First velocity scaling\n                scale_factor = np.exp(-xi * dt / 2.0)\n                v = v * scale_factor\n                \n                # 3. First half-update of velocity (force)\n                v = v + (dt / 2.0) * (force(x) / m)\n                v_mid = v\n\n                # 4. Full position update\n                x = x + v_mid * dt\n                \n                # 5. Second half-update of velocity (force)\n                v_prime_end = v_mid + (dt / 2.0) * (force(x) / m)\n                \n                # 6. Second velocity scaling\n                v = v_prime_end * scale_factor\n                \n                # 7. Second half-update of thermostat variable xi\n                K_n1 = 0.5 * m * v**2\n                xi = xi + (dt / 2.0) * (2.0 * K_n1 - g * kb * T0) / Q\n\n        elif sim_type == 'verlet':\n            for _ in range(N):\n                # Standard Velocity-Verlet step\n                v_mid = v + (force(x) / m) * (dt / 2.0)\n                x = x + v_mid * dt\n                v = v_mid + (force(x) / m) * (dt / 2.0)\n\n        # Calculate final instantaneous kinetic temperature\n        final_T = m * v**2 / (g * kb)\n        return final_T\n\n    # --- Main Execution Loop ---\n    \n    for case in test_cases:\n        final_temp = run_simulation(case)\n        results.append(final_temp)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "This advanced practice addresses the sophisticated challenges of ensuring both correct statistical sampling and robust numerical integration in complex simulations. You will implement an integrator for the Nosé-Hoover-Langevin (NHL) thermostat, a powerful hybrid method that guarantees ergodicity—a property the standard Nosé-Hoover thermostat can lack. Beyond implementation, this exercise emphasizes the critical importance of numerical stability, requiring you to derive and apply a stability criterion to prevent the simulation from becoming unreliable or divergent, a fundamental skill for any serious practitioner in the field .",
            "id": "3902227",
            "problem": "You are asked to construct a reversible, second-order numerical integrator for Nosé-Hoover-Langevin (NHL) dynamics and to determine conditions for numerical stability as functions of the time step $\\Delta t$ and thermostat parameters, within the context of computational catalysis and chemical engineering. Consider a single particle of mass $m$ in a one-dimensional harmonic potential with stiffness $k$, representing a coarse-grained catalytic site vibrational mode. The deterministic physical dynamics are governed by Hamilton’s equations, namely $dx/dt = p/m$ and $dp/dt = -\\partial U/\\partial x$ with $U(x) = \\tfrac{1}{2} k x^2$. The temperature control is achieved by coupling to a single Nosé-Hoover thermostat variable $\\xi$ with inertia parameter $Q$ and Langevin damping coefficient $\\gamma$, at target temperature $T$. The NHL stochastic thermostat follows the stochastic differential equation $d\\xi = [(p^2/m - k_B T)/Q] dt - \\gamma \\xi dt + \\sqrt{2 \\gamma k_B T/Q}\\, dW_t$, where $k_B$ is the Boltzmann constant and $W_t$ is a standard Wiener process. The thermostat couples to the physical momentum via $dp/dt = -\\partial U/\\partial x - \\xi p$. All quantities must be treated in the International System of Units (SI): $m$ in $\\mathrm{kg}$, $k$ in $\\mathrm{N/m}$, $T$ in $\\mathrm{K}$, $Q$ in $\\mathrm{J\\cdot s^2}$, $\\gamma$ in $\\mathrm{s^{-1}}$, and $\\Delta t$ in $\\mathrm{s}$. The angle unit is not applicable, and any fraction or decimal quantities should be treated numerically rather than as percentages.\n\nTask requirements:\n- Starting from the fundamental base of Hamilton’s equations, the definition of the harmonic potential, and the standard form of the Ornstein–Uhlenbeck process for the thermostat variable, derive a reversible, second-order weak integrator using a symmetric operator splitting for the combined physical and thermostat dynamics. The integrator must be time-symmetric in its deterministic parts and second-order accurate in the weak sense for the stochastic thermostat component.\n- Based on a principled linearization about thermal equilibrium scales, derive a quantitative, checkable condition for numerical stability in terms of the maximum allowable time step $\\Delta t$ as a function of $m$, $k$, $Q$, and $T$. Your stability criterion must be a clear inequality involving $\\Delta t$, and it must be verifiable numerically.\n- Implement the integrator and the stability criterion in a single, self-contained program. The program must simulate the system for each test case for a fixed number of steps to empirically assess stability by monitoring the boundedness of the mechanical energy $E = p^2/(2m) + \\tfrac{1}{2} k x^2$ and checking for numerical pathologies (for example, Not-a-Number values). Use a reproducible random number generator. The program must then combine the analytical stability check with the empirical boundedness assessment to output a boolean result for each test case, where a result is $\\mathrm{True}$ if and only if both the analytical condition and the empirical assessment indicate stability, and $\\mathrm{False}$ otherwise.\n- The final output format must be a single line containing the results as a comma-separated list enclosed in square brackets, for example, $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}]$.\n\nUse the following test suite, chosen to probe a typical scenario, near-boundary conditions, and significant edge cases. For all test cases, the number of integration steps is $20000$.\n\n- Test case $1$ (happy path): $m = 1.0 \\times 10^{-26}\\ \\mathrm{kg}$, $k = 10.0\\ \\mathrm{N/m}$, $T = 1000.0\\ \\mathrm{K}$, $Q = k_B T \\times (0.5 \\times 10^{-12}\\ \\mathrm{s})^2$, $\\gamma = 1.0 \\times 10^{12}\\ \\mathrm{s^{-1}}$, $\\Delta t = 1.0 \\times 10^{-15}\\ \\mathrm{s}$.\n- Test case $2$ (near oscillator stability boundary): $m = 1.0 \\times 10^{-26}\\ \\mathrm{kg}$, $k = 10.0\\ \\mathrm{N/m}$, $T = 1000.0\\ \\mathrm{K}$, $Q = k_B T \\times (0.5 \\times 10^{-12}\\ \\mathrm{s})^2$, $\\gamma = 1.0 \\times 10^{12}\\ \\mathrm{s^{-1}}$, $\\Delta t = 5.0 \\times 10^{-14}\\ \\mathrm{s}$.\n- Test case $3$ (above oscillator stability boundary): $m = 1.0 \\times 10^{-26}\\ \\mathrm{kg}$, $k = 10.0\\ \\mathrm{N/m}$, $T = 1000.0\\ \\mathrm{K}$, $Q = k_B T \\times (0.5 \\times 10^{-12}\\ \\mathrm{s})^2$, $\\gamma = 1.0 \\times 10^{12}\\ \\mathrm{s^{-1}}$, $\\Delta t = 1.0 \\times 10^{-13}\\ \\mathrm{s}$.\n- Test case $4$ (thermostat stiff, violating thermostat stability): $m = 1.0 \\times 10^{-26}\\ \\mathrm{kg}$, $k = 10.0\\ \\mathrm{N/m}$, $T = 1000.0\\ \\mathrm{K}$, $Q = k_B T \\times (0.01 \\times 10^{-12}\\ \\mathrm{s})^2$, $\\gamma = 1.0 \\times 10^{12}\\ \\mathrm{s^{-1}}$, $\\Delta t = 5.0 \\times 10^{-14}\\ \\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}]$).",
            "solution": "The problem requires the construction and analysis of a numerical integrator for a one-dimensional particle in a harmonic potential, thermostatted by a Nosé-Hoover-Langevin (NHL) scheme. This involves deriving the integrator, establishing a numerical stability criterion, and implementing a program to test these findings.\n\nThe equations of motion for the system are given for the position $x$, momentum $p$, and thermostat variable $\\xi$:\n$$\n\\begin{cases}\n    \\frac{dx}{dt} = \\frac{p}{m} \\\\\n    \\frac{dp}{dt} = -\\frac{\\partial U(x)}{\\partial x} - \\xi p = -kx - \\xi p \\\\\n    d\\xi = \\left[\\frac{p^2/m - k_B T}{Q}\\right] dt - \\gamma \\xi dt + \\sqrt{\\frac{2 \\gamma k_B T}{Q}} dW_t\n\\end{cases}\n$$\nwhere $m$ is the mass, $k$ is the potential stiffness, $U(x) = \\frac{1}{2}kx^2$ is the harmonic potential, $T$ is the target temperature, $Q$ is the thermostat inertia, $\\gamma$ is the Langevin damping coefficient, $k_B$ is the Boltzmann constant, and $W_t$ is a standard Wiener process.\n\n### Integrator Derivation\n\nTo derive a reversible, second-order integrator, we employ a symmetric operator splitting method (Trotter-Suzuki decomposition). The Liouvillian operator $\\mathcal{L}$ governing the evolution of the system's phase space density can be additively separated into components that can be solved analytically. A common and effective splitting for thermostatted systems is the `BAOAB` scheme. The Liouvillian is split into three parts:\n1.  $\\mathcal{L}_B$: evolution of momentum $p$ under the conservative force $F(x) = -kx$, i.e., $\\frac{dp}{dt} = -kx$.\n2.  $\\mathcal{L}_A$: evolution of position $x$ under the kinetic term, i.e., $\\frac{dx}{dt} = p/m$.\n3.  $\\mathcal{L}_O$: evolution of momentum $p$ and thermostat variable $\\xi$ under the NHL coupling.\n\nA symmetric composition of these operators over a time step $\\Delta t$ yields a second-order accurate integrator:\n$$\ne^{\\mathcal{L}\\Delta t} \\approx e^{\\mathcal{L}_B \\Delta t/2} e^{\\mathcal{L}_A \\Delta t/2} e^{\\mathcal{L}_O \\Delta t} e^{\\mathcal{L}_A \\Delta t/2} e^{\\mathcal{L}_B \\Delta t/2}\n$$\n\nThe `O` step, governed by $\\mathcal{L}_O$, involves the coupled equations:\n$$\n\\begin{cases}\n    \\frac{dp}{dt} = -\\xi p \\\\\n    d\\xi = \\left(\\frac{p^2/m - k_B T}{Q} - \\gamma \\xi\\right) dt + \\sqrt{\\frac{2 \\gamma k_B T}{Q}} dW_t\n\\end{cases}\n$$\nTo maintain symmetry and accuracy, the $\\mathcal{L}_O$ operator is itself split. We isolate the momentum update due to damping from the evolution of the thermostat variable $\\xi$. This sub-splitting is also chosen to be symmetric: a full step update for $\\xi$ is symmetrically flanked by half-step updates for $p$.\n\nThe evolution corresponding to $e^{\\mathcal{L}_O \\Delta t}$ is thus:\n1.  **Half-step momentum update**: Evolve $\\frac{dp}{dt} = -\\xi p$ for $\\Delta t/2$. Assuming $\\xi$ is constant over this half-step, the solution is $p(\\Delta t/2) = p(0) e^{-\\xi(0) \\Delta t/2}$.\n2.  **Full-step thermostat update**: Evolve the SDE for $\\xi$ for a full time step $\\Delta t$. This equation is of the Ornstein-Uhlenbeck form, $d\\xi_t = (A - \\gamma \\xi_t)dt + \\sigma dW_t$, with forcing $A = (p^2/m - k_B T)/Q$ and noise magnitude $\\sigma = \\sqrt{2\\gamma k_B T / Q}$. The value of $p$ is held constant at $p(\\Delta t/2)$ from the previous substep. The exact solution for the Ornstein-Uhlenbeck process over an interval $\\Delta t$ is:\n    $$\n    \\xi(\\Delta t) = \\xi(0) e^{-\\gamma \\Delta t} + \\frac{A}{\\gamma}(1 - e^{-\\gamma \\Delta t}) + \\sqrt{\\frac{\\sigma^2}{2\\gamma}(1 - e^{-2\\gamma \\Delta t})} \\mathcal{N}(0,1)\n    $$\n    where $\\mathcal{N}(0,1)$ is a standard normal random variable. Substituting the expressions for $A$ and $\\sigma$, the update rule for $\\xi$ is:\n    $$\n    \\xi_{\\text{new}} = \\xi_{\\text{old}} e^{-\\gamma \\Delta t} + \\frac{1}{Q\\gamma}\\left(\\frac{p_{\\text{mid}}^2}{m} - k_B T\\right)(1 - e^{-\\gamma \\Delta t}) + \\sqrt{\\frac{k_B T}{Q}(1 - e^{-2\\gamma \\Delta t})} \\mathcal{N}(0,1)\n    $$\n    This provides a second-order weak update for the stochastic component.\n3.  **Second half-step momentum update**: Evolve $\\frac{dp}{dt} = -\\xi p$ for another $\\Delta t/2$, using the newly computed $\\xi_{\\text{new}}$. The update is $p(\\Delta t) = p(\\Delta t/2) e^{-\\xi_{\\text{new}} \\Delta t/2}$.\n\nCombining these pieces yields the complete `g-BAOAB` algorithm for one time step $\\Delta t$:\nLet $(x_n, p_n, \\xi_n)$ be the state at time $t_n$.\n1.  **B-step**: Update momentum with force for $\\Delta t/2$: $p' = p_n - k x_n \\frac{\\Delta t}{2}$.\n2.  **A-step**: Update position with velocity for $\\Delta t/2$: $x' = x_n + \\frac{p'}{m} \\frac{\\Delta t}{2}$.\n3.  **O-step (thermostat)**:\n    a. First momentum half-update: $p'' = p' \\exp(-\\xi_n \\frac{\\Delta t}{2})$.\n    b. Evolve $\\xi$: $\\xi_{n+1} = \\xi_n e^{-\\gamma \\Delta t} + \\frac{1}{Q\\gamma}\\left(\\frac{(p'')^2}{m} - k_B T\\right)(1 - e^{-\\gamma \\Delta t}) + \\sqrt{\\frac{k_B T}{Q}(1 - e^{-2\\gamma \\Delta t})} \\mathcal{N}(0,1)$.\n    c. Second momentum half-update: $p''' = p'' \\exp(-\\xi_{n+1} \\frac{\\Delta t}{2})$.\n4.  **A-step**: Update position with velocity for $\\Delta t/2$: $x_{n+1} = x' + \\frac{p'''}{m} \\frac{\\Delta t}{2}$.\n5.  **B-step**: Update momentum with force for $\\Delta t/2$: $p_{n+1} = p''' - k x_{n+1} \\frac{\\Delta t}{2}$.\n\nThis scheme is explicitly time-reversible for its deterministic part and is second-order accurate.\n\n### Numerical Stability Condition\n\nNumerical stability of explicit integrators like this one is limited by the fastest frequencies in the system. We identify two primary oscillatory modes:\n1.  **Physical Oscillator**: The particle in the harmonic potential has a natural angular frequency $\\omega_0 = \\sqrt{k/m}$. For Verlet-type integrators, the time step $\\Delta t$ must resolve this oscillation. The standard stability limit is $\\omega_0 \\Delta t \\le 2$. This gives the first condition:\n    $$\n    \\Delta t \\le \\frac{2}{\\omega_0} = 2 \\sqrt{\\frac{m}{k}}\n    $$\n2.  **Thermostat Oscillator**: The Nosé-Hoover thermostat introduces its own dynamics. By linearizing the deterministic part of the equations for $p$ and $\\xi$ around thermal equilibrium ($p^2/m \\approx k_B T$, $\\xi \\approx 0$), we can find a characteristic frequency for the thermostat. This analysis yields an effective harmonic oscillator with angular frequency squared $\\omega_{th}^2 \\approx 2k_B T/Q$. Applying the same stability reasoning, we get a second condition on the time step:\n    $$\n    \\Delta t \\le \\frac{2}{\\omega_{th}} = 2 \\sqrt{\\frac{Q}{2k_B T}} = \\sqrt{\\frac{2Q}{k_B T}}\n    $$\n\nFor the numerical integration to be stable, the time step $\\Delta t$ must be small enough to resolve both of these motions simultaneously. Therefore, the combined criterion for numerical stability is that both inequalities must be satisfied:\n$$\n\\Delta t \\le 2 \\sqrt{\\frac{m}{k}} \\quad \\text{and} \\quad \\Delta t \\le \\sqrt{\\frac{2Q}{k_B T}}\n$$\n\n### Empirical Stability Assessment\n\nIn the implementation, we will supplement this analytical criterion with an empirical check. A simulation is deemed empirically unstable if, after a fixed number of steps, any of the state variables ($x, p, \\xi$) become non-finite (`NaN` or `infinity`), or if the mechanical energy $E = \\frac{p^2}{2m} + \\frac{1}{2}kx^2$ grows to an unphysically large value. A suitable threshold for \"unphysical\" is a large multiple of the expected thermal energy. For a one-dimensional harmonic oscillator, the average total energy is $k_B T$. We will use a threshold of $100 \\times k_B T$ for the final mechanical energy to detect divergence, which is a clear sign of numerical instability. A final result of `True` for a test case requires both the analytical stability condition and the empirical check to pass.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Nosé-Hoover-Langevin simulations and stability checks.\n    \"\"\"\n    \n    # Constants\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    N_STEPS = 20000     # Number of simulation steps\n    \n    # Test cases from the problem statement\n    # Each case is a dictionary of parameters\n    test_cases = [\n        {\n            \"m\": 1.0e-26, \"k\": 10.0, \"T\": 1000.0, \n            \"Q\": KB * 1000.0 * (0.5e-12)**2, \n            \"gamma\": 1.0e12, \"dt\": 1.0e-15,\n            \"label\": \"happy path\"\n        },\n        {\n            \"m\": 1.0e-26, \"k\": 10.0, \"T\": 1000.0, \n            \"Q\": KB * 1000.0 * (0.5e-12)**2, \n            \"gamma\": 1.0e12, \"dt\": 5.0e-14,\n            \"label\": \"near oscillator stability boundary\"\n        },\n        {\n            \"m\": 1.0e-26, \"k\": 10.0, \"T\": 1000.0, \n            \"Q\": KB * 1000.0 * (0.5e-12)**2, \n            \"gamma\": 1.0e12, \"dt\": 1.0e-13,\n            \"label\": \"above oscillator stability boundary\"\n        },\n        {\n            \"m\": 1.0e-26, \"k\": 10.0, \"T\": 1000.0, \n            \"Q\": KB * 1000.0 * (0.01e-12)**2, \n            \"gamma\": 1.0e12, \"dt\": 5.0e-14,\n            \"label\": \"thermostat stiff, violating thermostat stability\"\n        },\n    ]\n\n    results = []\n\n    # Use a fixed seed for the random number generator for reproducibility.\n    rng = np.random.default_rng(seed=42)\n\n    for case in test_cases:\n        m, k, T, Q, gamma, dt = case[\"m\"], case[\"k\"], case[\"T\"], case[\"Q\"], case[\"gamma\"], case[\"dt\"]\n\n        # --- Analytical Stability Check ---\n        omega0 = np.sqrt(k / m)\n        dt_max_physical = 2.0 / omega0\n        \n        # Avoid division by zero or sqrt of negative if T or Q is zero\n        if Q = 0 or T = 0:\n            dt_max_thermostat = 0.0\n        else:\n            omega_th_sq = 2 * KB * T / Q\n            dt_max_thermostat = np.sqrt(2.0/omega_th_sq)\n\n        is_analytically_stable = (dt = dt_max_physical) and (dt = dt_max_thermostat)\n\n        # --- Empirical Stability Simulation ---\n        # Initial conditions: start at equilibrium position with thermal momentum and zero thermostat drag\n        x = 0.0\n        # Draw momentum from Maxwell-Boltzmann distribution, variance = m*kB*T\n        p = rng.normal(0.0, np.sqrt(m * KB * T))\n        xi = 0.0\n\n        is_empirically_stable = True\n        for _ in range(N_STEPS):\n            # g-BAOAB Integrator\n            \n            # B-step (half)\n            p = p - k * x * dt / 2.0\n\n            # A-step (half)\n            x = x + p / m * dt / 2.0\n\n            # O-step (thermostat)\n            p_mid = p * np.exp(-xi * dt / 2.0)\n            \n            # Evolve xi\n            exp_gamma_dt = np.exp(-gamma * dt)\n            c1_xi = (1.0 / (Q * gamma)) * ((p_mid**2 / m) - KB * T) * (1.0 - exp_gamma_dt)\n            \n            # Handle case where gamma*dt is very small to avoid precision loss\n            # Although for the given parameters, direct computation is fine\n            if gamma*dt  1e-6:\n                var_xi = (KB*T/Q) * (2*gamma*dt - (2*gamma*dt)**2/2)\n            else:\n                var_xi = (KB*T/Q) * (1 - np.exp(-2*gamma*dt))\n\n            if var_xi  0: var_xi = 0 # Ensure variance is non-negative\n            \n            rand_force = np.sqrt(var_xi) * rng.normal(0.0, 1.0)\n            xi = xi * exp_gamma_dt + c1_xi + rand_force\n            \n            p = p_mid * np.exp(-xi * dt / 2.0)\n\n            # A-step (half)\n            x = x + p / m * dt / 2.0\n            \n            # B-step (half)\n            p = p - k * x * dt / 2.0\n            \n            # Check for numerical explosion during the simulation\n            if not (np.isfinite(x) and np.isfinite(p) and np.isfinite(xi)):\n                is_empirically_stable = False\n                break\n        \n        # After loop, perform final empirical check\n        if is_empirically_stable:\n            mechanical_energy = 0.5 * p**2 / m + 0.5 * k * x**2\n            # The expected total energy is kB*T. We check against a large multiple.\n            # Mechanical energy for a thermostatted system fluctuates, not conserved.\n            energy_threshold = 100 * KB * T \n            if mechanical_energy  energy_threshold:\n                is_empirically_stable = False\n\n        # Final result is True iff both analytical and empirical checks pass\n        final_stability = is_analytically_stable and is_empirically_stable\n        results.append(str(final_stability))\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}