{
    "hands_on_practices": [
        {
            "introduction": "任何可靠的计算研究，其第一步都是仔细选择模拟参数。在投影缀加波 (PAW) 方法中，选择缀加球半径 $r_c$ 是在计算效率和准确性之间进行关键权衡。较小的半径可以更准确地描述原子核附近快速变化的波函数，但这需要更高、计算成本也更昂贵的平面波能量截断。 这个练习将引导您完成真实世界中的决策过程，迫使您在物理约束（缀加球不重叠）、科学需求（包含半芯层电子以保证转移性）和计算预算之间找到平衡，这是建立一个稳健的密度泛函理论计算的实用范例。",
            "id": "3896836",
            "problem": "一个计算催化团队正在准备一项关于一氧化碳在金红石型二氧化钛表面吸附和氧化的平面波密度泛函理论 (DFT) 研究。该团队将使用投影缀加波 (PAW) 方法，并且必须为碳、氧和钛选择 PAW 缀加球面半径，分别表示为 $r_c(\\mathrm{C})$、$r_c(\\mathrm{O})$ 和 $r_c(\\mathrm{Ti})$。他们将模拟包含压缩过渡态的构型，因此他们采用了在反应路径上任何位置都可能出现的保守最短原子间距（中心到中心）：$d_{\\min}(\\mathrm{Ti}-\\mathrm{O}) = 1.85\\,\\mathrm{\\AA}$，$d_{\\min}(\\mathrm{O}-\\mathrm{O}) = 2.50\\,\\mathrm{\\AA}$，$d_{\\min}(\\mathrm{C}-\\mathrm{O}) = 1.15\\,\\mathrm{\\AA}$ 和 $d_{\\min}(\\mathrm{C}-\\mathrm{Ti}) = 2.00\\,\\mathrm{\\AA}$。他们通过要求 $r_c(i) + r_c(j) \\le \\gamma\\, d_{\\min}(i-j)$（其中 $\\gamma = 0.90$）来强制执行缀加球的非重叠余量，适用于所有相邻原子对 $i$ 和 $j$。\n\n由于该体系涉及早期过渡金属氧化物，团队决定钛必须使用半芯态 $3p$ 轨道作为价电子来描述，以确保在不同氧化态下的可移植性。计算资源限制要求平面波截断能满足 $E_{\\text{cut}} \\le 400\\,\\mathrm{eV}$，而精度目标要求强键合的轻元素碳和氧的 $r_c$ 足够小，以解析短键的曲率并避免鬼态。\n\n仅利用平面波表示的基本原理（实空间中尺寸为 $r_c$ 的特征的解析度）、缀加球几何学以及包含半芯态的物理意义，选择一个选项，该选项提供一个有效的决策流程和一组一致的最终 $r_c$ 值，这些值共同 (i) 满足反应路径上所有相关原子对的非重叠约束，(ii) 遵守平面波截断能限制，以及 (iii) 体现了为保证可移植性而需要包含钛半芯价态的需求。\n\n选项描述了一个决策流程，后跟建议的 $r_c$ 值：\n\n- A. 从最短的原子间距出发，将每个元素的 $r_c$ 设置为接近最小距离的一半以最小化截断能，不包括钛的半芯价态，最终确定 $r_c(\\mathrm{C}) = 0.45\\,\\mathrm{\\AA}$，$r_c(\\mathrm{O}) = 0.55\\,\\mathrm{\\AA}$，$r_c(\\mathrm{Ti}) = 0.90\\,\\mathrm{\\AA}$。\n\n- B. 通过最大化软度来优先考虑计算成本：选择大的半径，同时接受在压缩构型中可能出现的球面重叠，最终确定 $r_c(\\mathrm{C}) = 0.70\\,\\mathrm{\\AA}$，$r_c(\\mathrm{O}) = 0.80\\,\\mathrm{\\AA}$，$r_c(\\mathrm{Ti}) = 1.20\\,\\mathrm{\\AA}$，并忽略半芯态。\n\n- C. 强制简化和统一：基于典型的氧化物键长，对所有元素使用单一半径，设置 $r_c(\\mathrm{C}) = r_c(\\mathrm{O}) = r_c(\\mathrm{Ti}) = 1.00\\,\\mathrm{\\AA}$，不包括半芯态。\n\n- D. 通过对所有元素使用极小的半径以确保压缩键中的高可移植性来偏向最大精度，包括钛的半芯价态，最终确定 $r_c(\\mathrm{C}) = 0.35\\,\\mathrm{\\AA}$，$r_c(\\mathrm{O}) = 0.45\\,\\mathrm{\\AA}$，$r_c(\\mathrm{Ti}) = 0.75\\,\\mathrm{\\AA}$。\n\n- E. 根据最近邻几何和曲率需求构建特定于元素的半径：对所有原子对强制执行非重叠余量，为保证可移植性而包括钛的 $3p$ 半芯价态，为轻元素选择小半径以解析短键，同时将截断能保持在资源限制内，最终确定 $r_c(\\mathrm{C}) = 0.50\\,\\mathrm{\\AA}$，$r_c(\\mathrm{O}) = 0.50\\,\\mathrm{\\AA}$，$r_c(\\mathrm{Ti}) = 0.95\\,\\mathrm{\\AA}$。\n\n选择最能满足所有约束和目标的选项。",
            "solution": "问题要求为平面波密度泛函理论 (DFT) 计算选择一组投影缀加波 (PAW) 缀加球面半径 $r_c(\\mathrm{C})$、$r_c(\\mathrm{O})$ 和 $r_c(\\mathrm{Ti})$。该选择必须遵守一组特定的约束和目标。\n\n首先，让我们将问题陈述中给出的约束形式化。\n\n1.  **对钛的科学要求**：模拟必须在价电子构型中包含钛的半芯态 $3p$ 轨道。这对于确保赝势的可移植性至关重要，特别是对于像钛这样的过渡金属，其氧化态和化学环境可能发生显著变化。任何忽略这些半芯态的解决方案对于此问题都是根本上不正确的。\n\n2.  **缀加球非重叠约束**：任意两个相邻原子 $i$ 和 $j$ 的半径之和不得超过最小原子间距 $d_{\\min}(i-j)$ 的一个分数 $\\gamma = 0.90$。这由不等式表示：\n    $$r_c(i) + r_c(j) \\le \\gamma\\, d_{\\min}(i-j)$$\n    使用提供的数据，我们可以确定对半径的具体约束：\n    *   对于 C-O 对：$d_{\\min}(\\mathrm{C}-\\mathrm{O}) = 1.15\\,\\mathrm{\\AA}$。约束为 $r_c(\\mathrm{C}) + r_c(\\mathrm{O}) \\le 0.90 \\times 1.15\\,\\mathrm{\\AA} = 1.035\\,\\mathrm{\\AA}$。\n    *   对于 O-O 对：$d_{\\min}(\\mathrm{O}-\\mathrm{O}) = 2.50\\,\\mathrm{\\AA}$。约束为 $r_c(\\mathrm{O}) + r_c(\\mathrm{O}) \\le 0.90 \\times 2.50\\,\\mathrm{\\AA} = 2.25\\,\\mathrm{\\AA}$，可简化为 $r_c(\\mathrm{O}) \\le 1.125\\,\\mathrm{\\AA}$。\n    *   对于 Ti-O 对：$d_{\\min}(\\mathrm{Ti}-\\mathrm{O}) = 1.85\\,\\mathrm{\\AA}$。约束为 $r_c(\\mathrm{Ti}) + r_c(\\mathrm{O}) \\le 0.90 \\times 1.85\\,\\mathrm{\\AA} = 1.665\\,\\mathrm{\\AA}$。\n    *   对于 C-Ti 对：$d_{\\min}(\\mathrm{C}-\\mathrm{Ti}) = 2.00\\,\\mathrm{\\AA}$。约束为 $r_c(\\mathrm{C}) + r_c(\\mathrm{Ti}) \\le 0.90 \\times 2.00\\,\\mathrm{\\AA} = 1.80\\,\\mathrm{\\AA}$。\n\n3.  **计算资源约束**：平面波动能截断 $E_{\\text{cut}}$ 不得大于 $400\\,\\mathrm{eV}$，即 $E_{\\text{cut}} \\le 400\\,\\mathrm{eV}$。此约束与赝势的“硬度”有关。表示赝波函数最短波长特征所需的能量大致与 $E_{\\text{cut}} \\propto (1/r_c)^2$ 成比例。较小的半径 $r_c$ 会导致核附近波函数振荡更快（“更硬”的势），因此需要更高的 $E_{\\text{cut}}$ 才能收敛。包含半芯态也会使势变得更硬。因此，所选半径必须足够大，以将所需的 $E_{\\text{cut}}$ 保持在 $400\\,\\mathrm{eV}$ 的限制内。\n\n4.  **精度目标**：碳和氧的半径 $r_c(\\mathrm{C})$ 和 $r_c(\\mathrm{O})$ 应“足够小”。这对于准确表示短 C-O 键（$1.15\\,\\mathrm{\\AA}$）中波函数的强曲率以及防止像“鬼态”这样的赝象是必要的。这个目标与最小化 $E_{\\text{cut}}$ 的目标直接冲突，需要仔细权衡。\n\n现在，我们将根据这四个标准评估每个选项。\n\n**选项 A**\n决策流程指出：“...不包括钛的半芯价态...”。这直接违反了科学要求（约束 1），即钛的 $3p$ 半芯态必须被视为价态。对于所述问题，该选项在科学上是不合适的。\n**结论：不正确。**\n\n**选项 B**\n决策流程指出：“...接受在压缩构型中可能出现的球面重叠...忽略半芯态。”该选项违反了两个基本约束。首先，它明确允许球面重叠，这违反了非重叠约束（约束 2）。其次，它忽略了钛的半芯态，违反了科学要求（约束 1）。检查建议的半径（$r_c(\\mathrm{C}) = 0.70\\,\\mathrm{\\AA}$，$r_c(\\mathrm{O}) = 0.80\\,\\mathrm{\\AA}$，$r_c(\\mathrm{Ti}) = 1.20\\,\\mathrm{\\AA}$）证实了重叠违规：对于 C-O 对，$r_c(\\mathrm{C}) + r_c(\\mathrm{O}) = 0.70\\,\\mathrm{\\AA} + 0.80\\,\\mathrm{\\AA} = 1.50\\,\\mathrm{\\AA}$，大于 $1.035\\,\\mathrm{\\AA}$ 的限制。\n**结论：不正确。**\n\n**选项 C**\n决策流程指出：“...对所有元素使用单一半径...不包括半芯态。”该选项违反了对钛半芯态的科学要求（约束 1）。使用统一半径的理由在物理上也是不合理的，因为它忽略了碳、氧和钛元素独特的化学性质和尺寸。检查建议的半径（所有元素 $r_c = 1.00\\,\\mathrm{\\AA}$）显示严重违反非重叠约束：对于 C-O 对，$r_c(\\mathrm{C}) + r_c(\\mathrm{O}) = 1.00\\,\\mathrm{\\AA} + 1.00\\,\\mathrm{\\AA} = 2.00\\,\\mathrm{\\AA}$，远大于 $1.035\\,\\mathrm{\\AA}$ 的限制。\n**结论：不正确。**\n\n**选项 D**\n决策流程正确地指出“...包括钛的半芯价态...”。让我们检查建议半径的其他约束：$r_c(\\mathrm{C}) = 0.35\\,\\mathrm{\\AA}$，$r_c(\\mathrm{O}) = 0.45\\,\\mathrm{\\AA}$，$r_c(\\mathrm{Ti}) = 0.75\\,\\mathrm{\\AA}$。\n*   **非重叠（约束 2）：**\n    *   C-O: $0.35 + 0.45 = 0.80\\,\\mathrm{\\AA} \\le 1.035\\,\\mathrm{\\AA}$。（满足）\n    *   O-O: $2 \\times 0.45 = 0.90\\,\\mathrm{\\AA} \\le 2.25\\,\\mathrm{\\AA}$。（满足）\n    *   Ti-O: $0.75 + 0.45 = 1.20\\,\\mathrm{\\AA} \\le 1.665\\,\\mathrm{\\AA}$。（满足）\n    *   C-Ti: $0.75 + 0.35 = 1.10\\,\\mathrm{\\AA} \\le 1.80\\,\\mathrm{\\AA}$。（满足）\n    所有非重叠约束都得到满足。\n*   **截断能（约束 3）：** 决策流程旨在“通过使用极小的半径获得最大精度”。建议的半径确实非常小。一个碳的 PAW 势，其 $r_c(\\mathrm{C}) = 0.35\\,\\mathrm{\\AA}$，是极硬的。这样一个硬的势将需要一个远超 $400\\,\\mathrm{eV}$ 限制的平面波截断能 $E_{\\text{cut}}$，可能需要 $800\\,\\mathrm{eV}$ 或更高。因此，这个选择违反了计算资源约束。这种方法不平衡，为了理论上的精度而完全牺牲了计算上的可行性。\n**结论：不正确。**\n\n**选项 E**\n决策流程正确地概括了必要的折衷：“...强制执行非重叠余量...包括钛的 $3p$ 半芯价态...为轻元素选择小半径...同时将截断能保持在资源限制内...”。这个逻辑与所有陈述的要求完全一致。让我们检查建议的半径：$r_c(\\mathrm{C}) = 0.50\\,\\mathrm{\\AA}$，$r_c(\\mathrm{O}) = 0.50\\,\\mathrm{\\AA}$，$r_c(\\mathrm{Ti}) = 0.95\\,\\mathrm{\\AA}$。\n*   **半芯态（约束 1）：** 决策流程明确包括它们。（满足）\n*   **非重叠（约束 2）：**\n    *   C-O: $0.50 + 0.50 = 1.00\\,\\mathrm{\\AA} \\le 1.035\\,\\mathrm{\\AA}$。（满足）\n    *   O-O: $2 \\times 0.50 = 1.00\\,\\mathrm{\\AA} \\le 2.25\\,\\mathrm{\\AA}$。（满足）\n    *   Ti-O: $0.95 + 0.50 = 1.45\\,\\mathrm{\\AA} \\le 1.665\\,\\mathrm{\\AA}$。（满足）\n    *   C-Ti: $0.95 + 0.50 = 1.45\\,\\mathrm{\\AA} \\le 1.80\\,\\mathrm{\\AA}$。（满足）\n    所有非重叠约束都得到满足。\n*   **截断能（约束 3）：** 半径足够小以满足 C-O 键合的精度目标（约束 4），但不像选项 D 中那样“极”小。一套 PAW 势，其中 C/O 的 $r_c$ 值在 $0.5\\,\\mathrm{\\AA}$ 左右，以及一个 $r_c \\approx 0.95\\,\\mathrm{\\AA}$ 的 Ti_sv 势，在学术界被认为是一个“硬”但可控的设置。这种组合的推荐 $E_{\\text{cut}}$ 通常在 $400-500\\,\\mathrm{eV}$ 的范围内。因此，选择 $400\\,\\mathrm{eV}$ 的截断能对于这组半径来说是一个合理且一致的决定，满足了 $E_{\\text{cut}} \\le 400\\,\\mathrm{eV}$ 的约束。这个选项代表了在精度和计算成本之间一个经过深思熟虑的平衡。\n**结论：正确。**\n\n总而言之，选项 E 是唯一提供科学合理的决策过程并提出一组与问题的所有物理、几何和计算约束完全一致的参数的选择。",
            "answer": "$$\\boxed{E}$$"
        },
        {
            "introduction": "选择了初始参数后，我们不能想当然地认为结果就是准确的，因此必须进行系统的收敛性测试。变分原理保证了随着基组（由能量截断 $E_{\\text{cut}}$ 和缀加电荷截断 $\\Lambda$ 控制）趋于完备，计算出的总能量会单调地收敛到真实的基态能量。 这个练习利用此行为的数学模型，来建立一个协议，用以判断计算出的能量差（例如吸附能）是否在期望的容差范围内收敛。通过编写收敛协议，您将亲身体验计算科学中最基本和最关键的工作流程之一，从而确保研究结果的可靠性和可重复性。",
            "id": "3896849",
            "problem": "您的任务是设计并实现一个用于平面波电子结构计算中吸附能的收敛协议，该计算使用赝势 (Pseudopotentials) 和投影缀加波 (Projector Augmented-Wave, PAW) 方法。您的协议必须系统性地增加平面波动能截断和缀加电荷截断，同时确保吸附能达到目标容差。程序必须是完整且可运行的，并且应在一个数学上指定的代理模型下实现您的协议，该模型代表了 PAW 计算的收敛行为。\n\n基本原理和定义：\n\n- 吸附能由总能量差定义\n$$\nE_{\\text{ads}} = E_{\\text{slab+adsorbate}} - E_{\\text{slab}} - E_{\\text{adsorbate}},\n$$\n其中 $E_{\\text{slab+adsorbate}}$、$E_{\\text{slab}}$ 和 $E_{\\text{adsorbate}}$ 分别是相应体系的总能量。\n\n- 在使用赝势和投影缀加波 (PAW) 方法的平面波方法中，平面波动能截断 $E_{\\text{cut}}$ 控制光滑赝波函数表示的完备性，而缀加电荷截断 $\\Lambda$ 控制 PAW 球内局域缀加的完备性。根据 Rayleigh-Ritz 变分原理和基组的完备性，由于有限的 $E_{\\text{cut}}$ 和 $\\Lambda$ 引起的总能量误差会随着这些截断值的增加而单调减小。\n\n- 您的收敛准则必须基于一个界限，即当 $E_{\\text{cut}}$ 和 $\\Lambda$ 以固定的乘法比例因子增加时，$E_{\\text{ads}}$ 的变化量。如果仅增加 $E_{\\text{cut}}$ 导致 $E_{\\text{ads}}$ 的变化小于 $ \\frac{\\tau}{2} $，且仅增加 $\\Lambda$ 导致 $E_{\\text{ads}}$ 的变化小于 $ \\frac{\\tau}{2} $，那么根据三角不等式，同时增加两者所引起的变化将小于 $ \\tau $，此时可以认为当前截断值在容差 $ \\tau $ 内已收敛。\n\n用于可测试性的代理模型：\n\n对于每个体系 $i \\in \\{1,2,3\\}$（分别对应 $E_{\\text{slab+adsorbate}}$、$E_{\\text{slab}}$ 和 $E_{\\text{adsorbate}}$），在有限截断值下计算的总能量被建模为\n$$\nE_i(E_{\\text{cut}}, \\Lambda) = E_i^{\\text{true}} + A_{\\text{wf},i}\\,E_{\\text{cut}}^{-p_i} + A_{\\text{aug},i}\\,\\Lambda^{-q_i} + D_i\\,E_{\\text{cut}}^{-\\frac{p_i}{2}}\\,\\Lambda^{-\\frac{q_i}{2}},\n$$\n其中系数 $A_{\\text{wf},i}$、$A_{\\text{aug},i}$、$D_i$ 和指数 $p_i$、$q_i$ 均为正数。吸附能则为\n$$\nE_{\\text{ads}}(E_{\\text{cut}}, \\Lambda) = E_1(E_{\\text{cut}}, \\Lambda) - E_2(E_{\\text{cut}}, \\Lambda) - E_3(E_{\\text{cut}}, \\Lambda).\n$$\n\n需要实现的协议：\n\n- 从初始截断值 $E_{\\text{cut}}^{(0)}$ 和 $\\Lambda^{(0)}$ 开始。\n\n- 在每次迭代 $t$ 中，评估当前的吸附能 $E_{\\text{ads}}^{(t)} = E_{\\text{ads}}(E_{\\text{cut}}^{(t)}, \\Lambda^{(t)})$。\n\n- 构造两个试验点：$(s_E\\,E_{\\text{cut}}^{(t)}, \\Lambda^{(t)})$ 和 $(E_{\\text{cut}}^{(t)}, s_\\Lambda\\,\\Lambda^{(t)})$，其中乘法比例因子 $s_E  1$ 和 $s_\\Lambda  1$。\n\n- 在这两个试验点上计算 $E_{\\text{ads}}$，并测量绝对变化量 $\\Delta_E = \\left|E_{\\text{ads}}(s_E E_{\\text{cut}}^{(t)}, \\Lambda^{(t)}) - E_{\\text{ads}}^{(t)}\\right|$ 和 $\\Delta_\\Lambda = \\left|E_{\\text{ads}}(E_{\\text{cut}}^{(t)}, s_\\Lambda \\Lambda^{(t)}) - E_{\\text{ads}}^{(t)}\\right|$。\n\n- 收敛决策：如果 $\\Delta_E  \\frac{\\tau}{2}$ 且 $\\Delta_\\Lambda  \\frac{\\tau}{2}$ 都成立，则宣布在当前的 $E_{\\text{cut}}^{(t)}$ 和 $\\Lambda^{(t)}$ 下已收敛，因为同时增加两者会使 $E_{\\text{ads}}$ 的变化小于 $\\tau$。\n\n- 否则，增加产生较大变化的那个截断值（即，如果 $\\Delta_E \\ge \\Delta_\\Lambda$，则设置 $E_{\\text{cut}}^{(t+1)} = s_E\\,E_{\\text{cut}}^{(t)}$ 和 $\\Lambda^{(t+1)} = \\Lambda^{(t)}$；否则设置 $E_{\\text{cut}}^{(t+1)} = E_{\\text{cut}}^{(t)}$ 和 $\\Lambda^{(t+1)} = s_{\\Lambda}\\,\\Lambda^{(t)}$），然后重复。\n\n- 如果达到最大迭代次数，或任一截断值超过指定的最大界限，则终止；在这种情况下，返回最后计算的值。\n\n单位和输出要求：\n\n- 所有能量均以电子伏特 (eV) 表示。具体来说，返回的 $E_{\\text{ads}}$ 应为 $\\mathrm{eV}$ 单位的浮点数，四舍五入到 $6$ 位小数。\n\n- 截断值 $E_{\\text{cut}}$ 和 $\\Lambda$ 以 $\\mathrm{eV}$ 为单位表示，四舍五入到最近的整数。\n\n- 您的程序必须生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个测试用例的结果是一个包含三个值的列表 $[E_{\\text{cut}}^{*}, \\Lambda^{*}, E_{\\text{ads}}^{*}]$。\n\n测试套件：\n\n为以下测试用例实现该协议。每个测试用例提供了代理模型的所有参数、起始截断值、比例因子、最大截断值、容差和最大迭代次数。\n\n- 测试用例 1 (一般情况):\n  - $E_1^{\\text{true}} = -125.432$, $E_2^{\\text{true}} = -120.000$, $E_3^{\\text{true}} = -5.700$。\n  - $A_{\\text{wf},i} = [15.0, 12.0, 2.0]$, $p_i = [2.8, 2.5, 2.2]$。\n  - $A_{\\text{aug},i} = [6.0, 5.0, 1.0]$, $q_i = [3.0, 2.7, 2.5]$。\n  - $D_i = [1.5, 1.0, 0.3]$。\n  - 初始截断值: $E_{\\text{cut}}^{(0)} = 200$, $\\Lambda^{(0)} = 300$。\n  - 比例因子: $s_E = 1.2$, $s_\\Lambda = 1.3$。\n  - 最大截断值: $E_{\\text{cut}}^{\\max} = 700$, $\\Lambda^{\\max} = 1000$。\n  - 容差: $\\tau = 0.01$。\n  - 最大迭代次数: $200$。\n\n- 测试用例 2 (缀加主导情况):\n  - $E_1^{\\text{true}} = -48.250$, $E_2^{\\text{true}} = -45.900$, $E_3^{\\text{true}} = -2.000$。\n  - $A_{\\text{wf},i} = [5.0, 5.0, 3.0]$, $p_i = [3.5, 3.5, 3.0]$。\n  - $A_{\\text{aug},i} = [12.0, 9.0, 2.0]$, $q_i = [2.0, 2.0, 1.7]$。\n  - $D_i = [0.8, 0.7, 0.2]$。\n  - 初始截断值: $E_{\\text{cut}}^{(0)} = 150$, $\\Lambda^{(0)} = 200$。\n  - 比例因子: $s_E = 1.15$, $s_\\Lambda = 1.5$。\n  - 最大截断值: $E_{\\text{cut}}^{\\max} = 600$, $\\Lambda^{\\max} = 1200$。\n  - 容差: $\\tau = 0.005$。\n  - 最大迭代次数: $250$。\n\n- 测试用例 3 (初始即已收敛):\n  - $E_1^{\\text{true}} = -10.000$, $E_2^{\\text{true}} = -7.500$, $E_3^{\\text{true}} = -2.480$。\n  - $A_{\\text{wf},i} = [1.0, 1.0, 0.5]$, $p_i = [4.0, 4.0, 4.0]$。\n  - $A_{\\text{aug},i} = [0.8, 0.8, 0.4]$, $q_i = [3.5, 3.5, 3.5]$。\n  - $D_i = [0.1, 0.1, 0.05]$。\n  - 初始截断值: $E_{\\text{cut}}^{(0)} = 800$, $\\Lambda^{(0)} = 1100$。\n  - 比例因子: $s_E = 1.1$, $s_\\Lambda = 1.1$。\n  - 最大截断值: $E_{\\text{cut}}^{\\max} = 1200$, $\\Lambda^{\\max} = 1500$。\n  - 容差: $\\tau = 0.1$。\n  - 最大迭代次数: $100$。\n\n您的程序应为每个测试用例独立地计算并应用上述协议，并生成单行输出，其精确格式如下：\n- 一个表示包含三个列表的列表的字符串，每个测试用例一个列表，其中每个内部列表为 $[E_{\\text{cut}}^{*}, \\Lambda^{*}, E_{\\text{ads}}^{*}]$，$E_{\\text{cut}}^{*}$ 和 $\\Lambda^{*}$ 四舍五入到最近的整数（单位为 $\\mathrm{eV}$），$E_{\\text{ads}}^{*}$ 四舍五入到 $6$ 位小数（单位为 $\\mathrm{eV}$）。例如，输出可能看起来像 `[[210,273,0.123456],[...],[...]]`。",
            "solution": "该问题是有效的。它在计算化学工程领域内提出了一个具有科学依据且定义明确的任务。问题陈述基于平面波电子结构计算的既定原则，即总能量随基组完备性的收敛性，该收敛性受变分原理支配。使用能量收敛的代理数学模型是一种标准且有效的方法，用于设计和测试计算协议，而无需访问成熟的量子化学代码。所有参数、定义和算法步骤都以足够的精度指定，以允许一个唯一的、确定性的和可验证的解决方案。\n\n问题的核心是为一个计算出的物理量——吸附能 $E_{\\text{ads}}$——实现一个双参数收敛协议。该能量由三个不同体系的总能量确定，这是标准做法：\n$$\nE_{\\text{ads}} = E_{\\text{slab+adsorbate}} - E_{\\text{slab}} - E_{\\text{adsorbate}}\n$$\n索引 $i=1, 2, 3$ 分别对应于板层+吸附质、板层和吸附质体系。\n\n**1. 能量收敛的代理模型**\n\n该问题提供了一个代理模型来表示投影缀加波 (PAW) 计算的输出。每个体系 $i$ 的计算总能量 $E_i$ 依赖于平面波动能截断 $E_{\\text{cut}}$ 和缀加电荷截断 $\\Lambda$ 如下：\n\n$$\nE_i(E_{\\text{cut}}, \\Lambda) = E_i^{\\text{true}} + A_{\\text{wf},i}\\,E_{\\text{cut}}^{-p_i} + A_{\\text{aug},i}\\,\\Lambda^{-q_i} + D_i\\,E_{\\text{cut}}^{-\\frac{p_i}{2}}\\,\\Lambda^{-\\frac{q_i}{2}}\n$$\n\n在这里，$E_i^{\\text{true}}$ 是精确（完全收敛）的能量。随后的项模拟了由有限基组引入的误差。$A_{\\text{wf},i}$ 项模拟了来自赝波函数的平面波基组的误差，而 $A_{\\text{aug},i}$ 项模拟了来自缀加电荷的实空间网格的误差。还包括一个涉及 $D_i$ 的交叉项。正指数 $p_i$ 和 $q_i$ 确保当 $E_{\\text{cut}} \\to \\infty$ 和 $\\Lambda \\to \\infty$ 时，能量收敛到 $E_i^{\\text{true}}$，这与方法的变分性质一致。\n\n在有限截断值下的吸附能则是一个函数 $E_{\\text{ads}}(E_{\\text{cut}}, \\Lambda)$：\n$$\nE_{\\text{ads}}(E_{\\text{cut}}, \\Lambda) = E_1(E_{\\text{cut}}, \\Lambda) - E_2(E_{\\text{cut}}, \\Lambda) - E_3(E_{\\text{cut}}, \\Lambda)\n$$\n这个计算涉及显著的误差对消，这是该模型正确捕捉到的一个关键物理方面。\n\n**2. 收敛协议算法**\n\n目标是基于预定义的容差 $\\tau$ 找到一组“收敛的”截断值 $(E_{\\text{cut}}^{*}, \\Lambda^{*})$。该算法是迭代的，并按以下步骤进行：\n\n1.  **初始化**：算法从一对初始截断值 $(E_{\\text{cut}}^{(0)}, \\Lambda^{(0)})$ 和一个迭代计数器 $t=0$ 开始。\n\n2.  **迭代**：算法的核心是一个循环，直到满足终止条件为止。在每次迭代 $t$ 中：\n    a.  计算当前的吸附能 $E_{\\text{ads}}^{(t)} = E_{\\text{ads}}(E_{\\text{cut}}^{(t)}, \\Lambda^{(t)})$。\n    b.  通过计算两个新的试验点 $(s_E E_{\\text{cut}}^{(t)}, \\Lambda^{(t)})$ 和 $(E_{\\text{cut}}^{(t)}, s_\\Lambda \\Lambda^{(t)})$ 上的吸附能来评估增加每个截断值的潜在影响，其中 $s_E  1$ 和 $s_\\Lambda  1$ 是固定的比例因子。\n    c.  计算能量的绝对变化量 $\\Delta_E$ 和 $\\Delta_\\Lambda$：\n        $$\n        \\Delta_E = \\left| E_{\\text{ads}}(s_E E_{\\text{cut}}^{(t)}, \\Lambda^{(t)}) - E_{\\text{ads}}^{(t)} \\right|\n        $$\n        $$\n        \\Delta_\\Lambda = \\left| E_{\\text{ads}}(E_{\\text{cut}}^{(t)}, s_\\Lambda \\Lambda^{(t)}) - E_{\\text{ads}}^{(t)} \\right|\n        $$\n    d.  执行**收敛检查**。如果 $\\Delta_E  \\tau/2$ 和 $\\Delta_\\Lambda  \\tau/2$ 都成立，则认为当前的截断值 $(E_{\\text{cut}}^{(t)}, \\Lambda^{(t)})$ 已经收敛。该条件基于三角不等式，确保同时增加两个截断值很可能使 $E_{\\text{ads}}$ 的扰动小于 $\\tau$。如果满足收敛条件，则循环终止。\n    e.  如果未满足收敛准则，则执行**更新步骤**。增加引起较大能量变化的截断值，因为这是误差的主要来源。\n        -   如果 $\\Delta_E \\ge \\Delta_\\Lambda$，下一组截断值变为 $(E_{\\text{cut}}^{(t+1)}, \\Lambda^{(t+1)}) = (s_E E_{\\text{cut}}^{(t)}, \\Lambda^{(t)})$。\n        -   如果 $\\Delta_E  \\Delta_\\Lambda$，则更新为 $(E_{\\text{cut}}^{(t+1)}, \\Lambda^{(t+1)}) = (E_{\\text{cut}}^{(t)}, s_\\Lambda \\Lambda^{(t)})$。\n    f.  在最终确定更新之前，进行**边界检查**，确保新的截断值不超过其指定的最大值（$E_{\\text{cut}}^{\\max}$ 或 $\\Lambda^{\\max}$）。如果超过，则循环终止。\n\n3.  **终止**：迭代过程在以下三种事件之一发生时停止：\n    -   **收敛**：满足容差准则。返回的值是当前迭代开始时的截断值和能量，即 $(E_{\\text{cut}}^{(t)}, \\Lambda^{(t)}, E_{\\text{ads}}^{(t)})$。\n    -   **超出边界**：提议的截断值更新将违反最大边界。返回的值与收敛情况相同：最后一组有效的参数，即 $(E_{\\text{cut}}^{(t)}, \\Lambda^{(t)}, E_{\\text{ads}}^{(t)})$。\n    -   **达到最大迭代次数**：循环完成其允许的最大次数而未收敛。返回的值是最后一次成功更新后达到的最终截断值，以及在这些最终值下计算的吸附能。\n\n**3. 实现策略**\n\n实现将直接把所描述的算法转化为代码。将定义一个辅助函数，用于根据给定测试用例的代理模型参数计算 $E_{\\text{ads}}(E_{\\text{cut}}, \\Lambda)$。该函数将利用 NumPy 在三个体系上进行高效的向量化计算。主要的迭代逻辑将封装在另一个函数中，该函数处理单个测试用例，处理初始化、主循环、所有检查（收敛、边界）和更新步骤。一个主 `solve` 函数将遍历提供的测试套件，为每个用例调用协议函数，并将结果格式化为所需的字符串格式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run the convergence protocol for all test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"params\": {\n                \"E_true\": np.array([-125.432, -120.000, -5.700]),\n                \"A_wf\": np.array([15.0, 12.0, 2.0]), \"p\": np.array([2.8, 2.5, 2.2]),\n                \"A_aug\": np.array([6.0, 5.0, 1.0]), \"q\": np.array([3.0, 2.7, 2.5]),\n                \"D\": np.array([1.5, 1.0, 0.3])\n            },\n            \"initial_cutoffs\": (200, 300),\n            \"scale_factors\": (1.2, 1.3),\n            \"max_cutoffs\": (700, 1000),\n            \"tolerance\": 0.01,\n            \"max_iterations\": 200\n        },\n        # Test case 2 (augmentation-dominated)\n        {\n            \"params\": {\n                \"E_true\": np.array([-48.250, -45.900, -2.000]),\n                \"A_wf\": np.array([5.0, 5.0, 3.0]), \"p\": np.array([3.5, 3.5, 3.0]),\n                \"A_aug\": np.array([12.0, 9.0, 2.0]), \"q\": np.array([2.0, 2.0, 1.7]),\n                \"D\": np.array([0.8, 0.7, 0.2])\n            },\n            \"initial_cutoffs\": (150, 200),\n            \"scale_factors\": (1.15, 1.5),\n            \"max_cutoffs\": (600, 1200),\n            \"tolerance\": 0.005,\n            \"max_iterations\": 250\n        },\n        # Test case 3 (already converged at start)\n        {\n            \"params\": {\n                \"E_true\": np.array([-10.000, -7.500, -2.480]),\n                \"A_wf\": np.array([1.0, 1.0, 0.5]), \"p\": np.array([4.0, 4.0, 4.0]),\n                \"A_aug\": np.array([0.8, 0.8, 0.4]), \"q\": np.array([3.5, 3.5, 3.5]),\n                \"D\": np.array([0.1, 0.1, 0.05])\n            },\n            \"initial_cutoffs\": (800, 1100),\n            \"scale_factors\": (1.1, 1.1),\n            \"max_cutoffs\": (1200, 1500),\n            \"tolerance\": 0.1,\n            \"max_iterations\": 100\n        }\n    ]\n\n    results = [run_protocol(case) for case in test_cases]\n    \n    # Format the final output string exactly as specified\n    final_output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]) + \"]\"\n    print(final_output_str)\n\ndef calculate_e_ads(e_cut, lam, params):\n    \"\"\"\n    Calculates the adsorption energy using the surrogate model.\n    \n    Args:\n        e_cut (float): The plane-wave kinetic energy cutoff.\n        lam (float): The augmentation charge cutoff.\n        params (dict): A dictionary containing the surrogate model parameters.\n    \n    Returns:\n        float: The calculated adsorption energy.\n    \"\"\"\n    p = params\n    \n    # Calculate total energy error for each system i\n    e_cut_term = p[\"A_wf\"] * (e_cut ** -p[\"p\"])\n    lam_term = p[\"A_aug\"] * (lam ** -p[\"q\"])\n    cross_term = p[\"D\"] * (e_cut ** (-p[\"p\"] / 2.0)) * (lam ** (-p[\"q\"] / 2.0))\n    \n    total_energies = p[\"E_true\"] + e_cut_term + lam_term + cross_term\n    \n    # Adsorption energy E_ads = E_1 - E_2 - E_3\n    e_ads = total_energies[0] - total_energies[1] - total_energies[2]\n    return e_ads\n\ndef run_protocol(case):\n    \"\"\"\n    Executes the convergence protocol for a single test case.\n\n    Args:\n        case (dict): The dictionary containing all parameters for the test case.\n\n    Returns:\n        list: A list containing [converged_e_cut, converged_lam, converged_e_ads].\n    \"\"\"\n    e_cut, lam = case[\"initial_cutoffs\"]\n    s_e, s_lam = case[\"scale_factors\"]\n    e_cut_max, lam_max = case[\"max_cutoffs\"]\n    tau = case[\"tolerance\"]\n    max_iter = case[\"max_iterations\"]\n    params = case[\"params\"]\n\n    for _ in range(max_iter):\n        e_ads_current = calculate_e_ads(e_cut, lam, params)\n\n        # Define trial points\n        next_e_cut = s_e * e_cut\n        next_lam = s_lam * lam\n\n        # Calculate energies at trial points\n        e_ads_trial_e = calculate_e_ads(next_e_cut, lam, params)\n        e_ads_trial_l = calculate_e_ads(e_cut, next_lam, params)\n\n        # Calculate absolute changes\n        delta_e = abs(e_ads_trial_e - e_ads_current)\n        delta_l = abs(e_ads_trial_l - e_ads_current)\n\n        # 1. Convergence Check\n        if delta_e  tau / 2.0 and delta_l  tau / 2.0:\n            return _format_result(e_cut, lam, e_ads_current)\n\n        # 2. Update Step with Bounds Check\n        if delta_e = delta_l:\n            if next_e_cut  e_cut_max:\n                return _format_result(e_cut, lam, e_ads_current) # Bound exceeded\n            e_cut = next_e_cut\n        else: # delta_l  delta_e\n            if next_lam  lam_max:\n                return _format_result(e_cut, lam, e_ads_current) # Bound exceeded\n            lam = next_lam\n    \n    # 3. Max Iterations Reached\n    # Return the state after the final update\n    final_e_ads = calculate_e_ads(e_cut, lam, params)\n    return _format_result(e_cut, lam, final_e_ads)\n\ndef _format_result(e_cut, lam, e_ads):\n    \"\"\"Formats a single result according to the output requirements.\"\"\"\n    e_cut_out = int(round(e_cut))\n    lam_out = int(round(lam))\n    e_ads_out = round(e_ads, 6)\n    return [e_cut_out, lam_out, e_ads_out]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "即使经过仔细的参数设置和收敛性测试，基于赝势的计算有时也会产生被称为“鬼态”(ghost states) 的非物理结果。这个问题深入探讨了 PAW 方法的数学基础，以揭示这些赝像的诊断测试方法。通过应用 Hylleraas-Undheim-MacDonald 定理并检验 PAW 重叠矩阵 $S$ 的性质，您可以识别出鬼态的迹象，例如本征值的非变分行为或缀加基的病态。 理解如何诊断这些高级问题是专家级实践者的标志，这个练习为您提供了故障排除的理论工具，使您从“黑箱”式的使用者转变为对方法潜在陷阱有更深刻理解的研究者。",
            "id": "3896824",
            "problem": "在与计算催化中使用的电子结构模拟相关的一个冻结势测试中，考虑在给定晶体动量 $\\mathbf{k}$ 下的一个固定的 Kohn–Sham 有效哈密顿算符 $\\hat{H}$。在动能截断 $E_{\\mathrm{cut}}$ 处截断的平面波表示中，投影仪缀加波 (PAW) 方法导出一个形如下式的有限维广义厄米特征值问题\n$$\nH(E_{\\mathrm{cut}})\\, \\mathbf{c} \\;=\\; E\\, S(\\boldsymbol{\\theta})\\, \\mathbf{c},\n$$\n其中 $H(E_{\\mathrm{cut}})$ 和 $S(\\boldsymbol{\\theta})$ 是所选子空间中的哈密顿矩阵和交叠矩阵，$S(\\boldsymbol{\\theta})$ 是厄米正定的，而 $\\boldsymbol{\\theta}$ 表示内部 PAW 数据集参数（例如，角动量通道的投影仪参考能量）。由动能 $\\le E_{\\mathrm{cut}}$ 的平面波张成的子空间 $\\mathcal{V}(E_{\\mathrm{cut}})$ 是嵌套的，即如果 $E_{\\mathrm{cut}}^{(2)}  E_{\\mathrm{cut}}^{(1)}$，则 $\\mathcal{V}(E_{\\mathrm{cut}}^{(1)}) \\subset \\mathcal{V}(E_{\\mathrm{cut}}^{(2)})$。鬼态是由于赝势或 PAW 数据集中的缺陷而产生的虚假低能解，它们会污染能谱。\n\n仅从以下基本原理出发：\n- 对于正定的 $S$，广义瑞利商 $R(\\mathbf{c}) = \\dfrac{\\mathbf{c}^{\\ast} H \\mathbf{c}}{\\mathbf{c}^{\\ast} S \\mathbf{c}}$ 及其在嵌套子空间序列中对 Ritz 值的极小-极大刻画。\n- 只要 $S$ 是正定的，使用 $S^{1/2}$ 的合同变换可将广义特征问题映射为 $A = S^{-1/2} H S^{-1/2}$ 的普通厄米特征问题这一事实。\n- PAW 广义特征问题要成为适定问题，$S(\\boldsymbol{\\theta})$ 必须保持正定这一要求。\n\n推导当 $\\boldsymbol{\\theta}$ 保持不变（冻结势，固定数据集）时，近似特征值 $E_n(E_{\\mathrm{cut}})$ 随 $E_{\\mathrm{cut}}$ 增加的单调性。然后考虑改变给定角动量通道的单个 PAW 投影仪参考能量，该能量由标量 $\\delta$ 参数化，使得 $\\boldsymbol{\\theta}=\\boldsymbol{\\theta}(\\delta)$；这会在缀加区域内平滑地使 $S(\\delta)$ 和 $H(\\delta)$ 形变，而目标的全电子能谱保持不变。通过追踪特征值随 $E_{\\mathrm{cut}}$ 或 $\\delta$ 的变化，提出严格的、充分的检验来标记鬼态。\n\n从这些原理中选出所有可作为有效充分检测策略的陈述。\n\nA. 在冻结势设置中，固定 $\\boldsymbol{\\theta}$ 并增加 $E_{\\mathrm{cut}}$，如果任何 Ritz 特征值 $E_n(E_{\\mathrm{cut}})$ 在 $E_{\\mathrm{cut}}$ 提高时增加（超出数值噪声范围），这违反了极小-极大变分排序，并将相应状态标记为候选鬼态。\n\nB. 因为该问题是广义的，所以极小-极大原理对于扩大 $\\mathcal{V}(E_{\\mathrm{cut}})$ 没有任何单调性要求；因此，$E_n(E_{\\mathrm{cut}})$ 随 $E_{\\mathrm{cut}}$ 的向上或向下漂移都是可接受的，并且不能作为鬼态的诊断特征。\n\nC. 在固定的较大 $E_{\\mathrm{cut}}$下，通过扫描 $\\delta$ 来改变投影仪参考能量。如果在扫描过程中任何特征值 $E_n(\\delta)$ 发生了非零量的变化，那么必然存在鬼态，因为物理特征值必须对投影仪参数严格不变。\n\nD. 在扫描 $\\delta$ 时，监测交叠矩阵 $S(\\delta)$ 的最小特征值 $\\sigma_{\\min}(\\delta)$。如果在扫描中任何 $\\delta$ 值处 $\\sigma_{\\min}(\\delta)$ 接近零或变为负值，则广义特征问题失去正定性，并遇到病态或非物理的缀加空间；这是鬼态或即将出现的虚假解的一个严格警告信号。\n\nE. 对于任何固定的 $m$，前 $m$ 个最低广义特征值之和 $\\sum_{n=1}^{m} E_n(E_{\\mathrm{cut}})$ 在 $E_{\\mathrm{cut}}$ 增加时必须保持严格恒定；任何偏差都表示存在鬼态。\n\n选择正确的选项。",
            "solution": "问题陈述的严格验证如下。\n\n**第1步：提取已知条件**\n- 上下文是电子结构模拟中的冻结势测试。\n- 算符是在给定晶体动量 $\\mathbf{k}$ 下的固定 Kohn–Sham 有效哈密顿量 $\\hat{H}$。\n- 基组是在动能截断 $E_{\\mathrm{cut}}$ 处截断的平面波表示。\n- 投影仪缀加波 (PAW) 方法得到一个广义厄米特征值问题：$H(E_{\\mathrm{cut}})\\, \\mathbf{c} \\;=\\; E\\, S(\\boldsymbol{\\theta})\\, \\mathbf{c}$。\n- $H(E_{\\mathrm{cut}})$ 和 $S(\\boldsymbol{\\theta})$ 是在此基组中的哈密顿矩阵和交叠矩阵。\n- $S(\\boldsymbol{\\theta})$ 是厄米正定的。\n- $\\boldsymbol{\\theta}$ 是内部 PAW 数据集参数。\n- 基子空间是嵌套的：如果 $E_{\\mathrm{cut}}^{(2)}  E_{\\mathrm{cut}}^{(1)}$，则 $\\mathcal{V}(E_{\\mathrm{cut}}^{(1)}) \\subset \\mathcal{V}(E_{\\mathrm{cut}}^{(2)})$。\n- 鬼态被定义为由赝势或 PAW 数据集缺陷引起的虚假低能解。\n- 推导必须基于三个原理：\n    1. 对于正定 $S$ 的广义瑞利商 $R(\\mathbf{c}) = \\dfrac{\\mathbf{c}^{\\ast} H \\mathbf{c}}{\\mathbf{c}^{\\ast} S \\mathbf{c}}$ 及其极小-极大刻画。\n    2. 转换为普通厄米特征问题 $A = S^{-1/2} H S^{-1/2}$。\n    3. 问题要成为适定问题，$S(\\boldsymbol{\\theta})$ 必须是正定的。\n- 任务是：\n    1. 推导特征值 $E_n(E_{\\mathrm{cut}})$ 随 $E_{\\mathrm{cut}}$ 增加的单调性。\n    2. 通过追踪特征值随 $E_{\\mathrm{cut}}$ 或改变 $\\boldsymbol{\\theta}$ 的参数 $\\delta$ 的变化，提出严格的、充分的检验来标记鬼态。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学基础**：该问题牢固地植根于计算材料物理学的标准理论和实践，特别是使用 PAW 方法的密度泛函理论 (DFT) 计算。广义特征值问题的表述、能量截断的作用、鬼态的概念以及 PAW 交叠矩阵的性质都是标准的，并且得到了准确的表述。\n- **适定性**：该问题提供了一套明确的前提（三个基本原理），并要求推导其结果。问题具体，可在给定框架内回答。\n- **客观性**：语言技术性强且精确，没有任何主观或模棱两可的术语。\n\n**第3步：结论和行动**\n该问题是有效的。这是一个关于物理学和化学中广泛使用的计算方法的数学性质的、表述良好的问题。前提是合理的，并且足以进行所需的推导。可以开始求解过程。\n\n### 推导与分析\n\n该问题要求基于变分原理，为广义厄米特征值问题 $H\\mathbf{c} = E S\\mathbf{c}$ 推导性质，其中 $H$ 是厄米矩阵，$S$ 是厄米正定矩阵。特征值 $E_n$ 是广义瑞利商 $R(\\mathbf{c}) = \\frac{\\mathbf{c}^{\\ast} H \\mathbf{c}}{\\mathbf{c}^{\\ast} S \\mathbf{c}}$ 的驻值。\n\n**第1部分：关于能量截断 $E_{\\mathrm{cut}}$ 的单调性**\n设在维度为 $N(E_{\\mathrm{cut}})$ 的子空间 $\\mathcal{V}(E_{\\mathrm{cut}})$ 中计算的特征值记为 $E_1(E_{\\mathrm{cut}}) \\le E_2(E_{\\mathrm{cut}}) \\le \\dots \\le E_{N(E_{\\mathrm{cut}})}(E_{\\mathrm{cut}})$。根据广义特征值的极小-极大原理，第 $n$ 个特征值由下式给出：\n$$\nE_n(E_{\\mathrm{cut}}) = \\min_{\\mathcal{W}_n \\subseteq \\mathcal{V}(E_{\\mathrm{cut}})} \\max_{\\mathbf{c} \\in \\mathcal{W}_n, \\mathbf{c} \\ne \\mathbf{0}} \\frac{\\mathbf{c}^{\\ast} H(E_{\\mathrm{cut}}) \\mathbf{c}}{\\mathbf{c}^{\\ast} S(\\boldsymbol{\\theta}) \\mathbf{c}}\n$$\n其中，最小值取自当前基空间 $\\mathcal{V}(E_{\\mathrm{cut}})$ 的所有 $n$ 维子空间 $\\mathcal{W}_n$。\n\n现在，考虑两个截断值 $E_{\\mathrm{cut}}^{(1)}$ 和 $E_{\\mathrm{cut}}^{(2)}$，且 $E_{\\mathrm{cut}}^{(1)}  E_{\\mathrm{cut}}^{(2)}$。由于平面波基的嵌套性质，相应的子空间也是嵌套的：$\\mathcal{V}(E_{\\mathrm{cut}}^{(1)}) \\subset \\mathcal{V}(E_{\\mathrm{cut}}^{(2)})$。\n\n对于更高的截断值，第 $n$ 个特征值 $E_n(E_{\\mathrm{cut}}^{(2)})$ 是通过在 $\\mathcal{V}(E_{\\mathrm{cut}}^{(2)})$ 的所有 $n$ 维子空间上取最小值得到的。$\\mathcal{V}(E_{\\mathrm{cut}}^{(1)})$ 的所有 $n$ 维子空间的集合是 $\\mathcal{V}(E_{\\mathrm{cut}}^{(2)})$ 的 $n$ 维子空间的子集。\n因此，为求 $E_n(E_{\\mathrm{cut}}^{(2)})$ 而进行的最小化是在一个比为求 $E_n(E_{\\mathrm{cut}}^{(1)})$ 而进行的最小化更大的集合上执行的。这意味着所得的最小值必须小于或等于在较小集合上得到的最小值。\n$$\nE_n(E_{\\mathrm{cut}}^{(2)}) \\le E_n(E_{\\mathrm{cut}}^{(1)})\n$$\n这个结果被称为 Hylleraas-Undheim-MacDonald 定理。它确立了对于固定的哈密顿算符和正定的交叠算符，在一系列嵌套子空间中通过变分计算得到的近似特征值随着子空间大小的增加是单调非增的。它们为算符的真实特征值提供了上界。\n\n**第2部分：改变 PAW 参数 $\\delta$**\n问题描述了改变一个由 $\\delta$ 参数化的 PAW 参数，这会平滑地使矩阵 $H(\\delta)$ 和 $S(\\delta)$ 形变。一个关键的基本原理是，只有当 $S(\\delta)$ 保持正定时，问题才是适定的。这意味着 $S(\\delta)$ 的所有特征值都必须严格为正。设 $S(\\delta)$ 的最小特征值为 $\\sigma_{\\min}(\\delta)$。适定性的条件是 $\\sigma_{\\min}(\\delta)  0$。\n\n如果对于某个 $\\delta$ 值，$\\sigma_{\\min}(\\delta)$ 趋近于零，则矩阵 $S(\\delta)$ 变得近乎奇异。这会导致严重的数值不稳定性。转换为标准特征值问题涉及 $S^{-1/2}$，如果 $S$ 近乎奇异，该矩阵将具有非常大的元素。由此产生的矩阵 $A(\\delta) = S^{-1/2}(\\delta) H(\\delta) S^{-1/2}(\\delta)$ 可能具有不对应任何物理现实的、虚假的大特征值。这种正定性的丧失或近奇异性是 PAW 数据集构造中已知的一种病理现象，会导致鬼态的产生。因此，监测 $\\sigma_{\\min}(\\delta)$ 是对 PAW 缀加空间稳健性的直接探查。如果 $\\sigma_{\\min}(\\delta) \\le 0$，该方法的数学基础（正定交叠）就完全崩溃了。\n\n全电子问题的物理特征值与像 $\\delta$ 这样的 PAW 构造参数无关。然而，在有限的 $E_{\\mathrm{cut}}$ 下计算的近似特征值 $E_n(\\delta)$ 会表现出对 $\\delta$ 的一些依赖性。对于一个物理态，这种依赖性应该很弱，并在 $E_{\\mathrm{cut}} \\to \\infty$ 的极限下消失。鬼态作为 PAW 构造的人为产物，通常表现出对 $\\delta$ 的强烈、非物理的依赖性。\n\n### 逐项分析\n\n**A. 在冻结势设置中，固定 $\\boldsymbol{\\theta}$ 并增加 $E_{\\mathrm{cut}}$，如果任何 Ritz 特征值 $E_n(E_{\\mathrm{cut}})$ 在 $E_{\\mathrm{cut}}$ 提高时增加（超出数值噪声范围），这违反了极小-极大变分排序，并将相应状态标记为候选鬼态。**\n如第1部分所推导，作为极小-极大原理的直接结果，Hylleraas-Undheim-MacDonald 定理规定每个特征值 $E_n(E_{\\mathrm{cut}})$ 必须是 $E_{\\mathrm{cut}}$ 的单调非增函数。在扩大基组时特征值的增加直接违反了这一基本变分原理。这种非变分行为表明所讨论的状态不是底层固定哈密顿量的真实本征态，而是计算方法的人为产物。这是用于识别虚假解或鬼态的经典特征。\n**结论：正确**\n\n**B. 因为该问题是广义的，所以极小-极大原理对于扩大 $\\mathcal{V}(E_{\\mathrm{cut}})$ 没有任何单调性要求；因此，$E_n(E_{\\mathrm{cut}})$ 随 $E_{\\mathrm{cut}}$ 的向上或向下漂移都是可接受的，并且不能作为鬼态的诊断特征。**\n该陈述在事实上是错误的。极小-极大原理以及由此得出的关于单调收敛的 Hylleraas-Undheim-MacDonald 定理同样适用于标准厄米特征问题（$S=I$）和广义厄米特征问题（$H\\mathbf{c} = E S\\mathbf{c}$），只要 $S$ 是正定的。该陈述的前提是错误的，因此其结论也是错误的。向上漂移是不可接受的，并且确实是问题的诊断特征。\n**结论：错误**\n\n**C. 在固定的较大 $E_{\\mathrm{cut}}$下，通过扫描 $\\delta$ 来改变投影仪参考能量。如果在扫描过程中任何特征值 $E_n(\\delta)$ 发生了非零量的变化，那么必然存在鬼态，因为物理特征值必须对投影仪参数严格不变。**\n这个陈述过于绝对，因此是错误的。虽然真实的、全电子的特征值相对于 PAW 构造参数是不变的，但在有限基组（$E_{\\mathrm{cut}}  \\infty$）中计算的近似特征值通常会对这些参数（如 $\\delta$）存在残余依赖性。目标是使物理态的这种依赖性最小化。对于所有态，无论是物理态还是其他态，都预期会有“非零”的变化。鬼态通常由对 $\\delta$ 的非常“大”或不稳定的依赖性来指示，而不仅仅是任何非零的依赖性。所述的这个检验不是鬼态的充分条件，因为它也会错误地标记所有物理态。\n**结论：错误**\n\n**D. 在扫描 $\\delta$ 时，监测交叠矩阵 $S(\\delta)$ 的最小特征值 $\\sigma_{\\min}(\\delta)$。如果在扫描中任何 $\\delta$ 值处 $\\sigma_{\\min}(\\delta)$ 接近零或变为负值，则广义特征问题失去正定性，并遇到病态或非物理的缀加空间；这是鬼态或即将出现的虚假解的一个严格警告信号。**\n这个陈述是正确的，并指出了一个基本的失效模式。交叠矩阵 $S$ 的正定性是广义特征问题适定且具有物理意义的先决条件。$\\sigma_{\\min}(\\delta)$ 的值趋近或穿过零表明 PAW 缀加中使用的投影函数正在变得线性相关。这导致一个奇异或病态的 $S$ 矩阵，在求解 $H\\mathbf{c} = E S\\mathbf{c}$ 时可能产生虚假特征值。这是一个直接、严格的指标，表明 PAW 数据集存在病态，容易产生鬼态。\n**结论：正确**\n\n**E. 对于任何固定的 $m$，前 $m$ 个最低广义特征值之和 $\\sum_{n=1}^{m} E_n(E_{\\mathrm{cut}})$ 在 $E_{\\mathrm{cut}}$ 增加时必须保持严格恒定；任何偏差都表示存在鬼态。**\n这个陈述是错误的。从对选项A的分析中我们知道，每个 $E_n(E_{\\mathrm{cut}})$ 都是 $E_{\\mathrm{cut}}$ 的一个非增函数。因此，它们的和 $\\sum_{n=1}^{m} E_n(E_{\\mathrm{cut}})$ 也必须是一个非增函数。随着基组的改进和特征值从上方收敛到其真实值，这个和通常会减小。没有普遍原理要求这个和保持不变。只有在一种微不足道的情况下，即前 $m$ 个本征态已经能在较小的基组中完美表示时，和才会恒定，而这种情况在实践中几乎从未发生过。\n**结论：错误**",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}