{
    "hands_on_practices": [
        {
            "introduction": "在任何周期性电子结构计算中，首要任务之一是确定布里渊区的采样方案。这个选择对计算的准确性至关重要，一个“好的”$k$点网格既能保证结果收敛，又能避免不必要的计算开销。本练习将引导你掌握一项基本但核心的技能：如何根据晶体原胞的实空间尺寸和期望的倒易空间分辨率，推导出一个系统性的方法来确定Monkhorst-Pack $k$点网格的密度。",
            "id": "3870659",
            "problem": "在计算催化和化学工程领域中，对催化材料进行周期性电子结构模拟时，需要在波矢网格上进行布里渊区 (BZ) 采样，通常使用以 Gamma 点为中心的 Monkhorst-Pack (MP) 网格。考虑一个用于模拟密堆积催化表面的晶体板层，它由三个正格矢 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 描述，其长度分别为 $a$、$b$ 和 $c$，轴间角分别为 $\\alpha$（$\\mathbf{b}$ 和 $\\mathbf{c}$ 之间）、$\\beta$（$\\mathbf{a}$ 和 $\\mathbf{c}$ 之间）以及 $\\gamma$（$\\mathbf{a}$ 和 $\\mathbf{b}$ 之间）。倒格矢根据标准晶体学约定定义为 $\\mathbf{b}_1 = 2\\pi \\, \\frac{\\mathbf{b} \\times \\mathbf{c}}{V}$，$\\mathbf{b}_2 = 2\\pi \\, \\frac{\\mathbf{c} \\times \\mathbf{a}}{V}$ 和 $\\mathbf{b}_3 = 2\\pi \\, \\frac{\\mathbf{a} \\times \\mathbf{b}}{V}$，其中 $V$ 是正格矢晶胞的体积。\n\n从这些定义和正格矢的几何结构出发，请提出一个逻辑上合理的方案来选择以 Gamma 点为中心的 Monkhorst-Pack 网格的整数网格尺寸 $(N_x, N_y, N_z)$，以在每个倒易基矢方向上达到目标最大倒易空间分辨率 $\\Delta k$。推导一个从给定目标 $\\Delta k$ 到整数 $(N_x, N_y, N_z)$ 的通用映射关系，该关系需保证沿每个倒易基矢方向上相邻采样 $\\mathbf{k}$ 点之间的间距小于或等于 $\\Delta k$，同时保持以 Gamma 点为中心。您的方案必须强制使用满足分辨率目标的最小奇数，并且必须保证每个方向上至少有一个划分。\n\n然后，将您推导的映射关系应用于以下常用于表示密堆积催化剂表面的六方板层几何结构：\n- $a = 2.500$ $\\mathrm{\\AA}$，$b = 2.500$ $\\mathrm{\\AA}$，$c = 15.000$ $\\mathrm{\\AA}$。\n- $\\alpha = 90^\\circ$，$\\beta = 90^\\circ$，$\\gamma = 120^\\circ$。\n- 目标分辨率 $\\Delta k = 0.200$ $\\mathrm{\\AA}^{-1}$。\n角度以度为单位。将最终的网格尺寸 $(N_x, N_y, N_z)$ 表示为整数，使用与您的方案一致的最小奇数选择。最终答案必须是包含三个整数的单行矩阵，且最终的方框表达式中不带单位。",
            "solution": "首先根据科学正确性、逻辑一致性和完整性原则对问题进行验证。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- **正格矢：** 矢量 $\\mathbf{a}$、$\\mathbf{b}$、$\\mathbf{c}$，其长度为 $a$、$b$、$c$，轴间角为 $\\alpha$、$\\beta$、$\\gamma$。\n- **倒格矢：** $\\mathbf{b}_1 = 2\\pi \\, \\frac{\\mathbf{b} \\times \\mathbf{c}}{V}$，$\\mathbf{b}_2 = 2\\pi \\, \\frac{\\mathbf{c} \\times \\mathbf{a}}{V}$，$\\mathbf{b}_3 = 2\\pi \\, \\frac{\\mathbf{a} \\times \\mathbf{b}}{V}$，其中 $V = \\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{c})$ 是正格矢晶胞体积。\n- **采样方案：** 以 Gamma 点为中心的 Monkhorst-Pack (MP) 网格，整数网格尺寸为 $(N_x, N_y, N_z)$。\n- **分辨率约束：** 沿每个倒易基矢方向上相邻采样 $\\mathbf{k}$ 点之间的间距必须小于或等于目标分辨率 $\\Delta k$。\n- **整数选择方案：** 整数 $(N_x, N_y, N_z)$ 必须是满足分辨率目标的最小奇数，且必须至少为 $1$。\n- **特定几何结构：** 一个六方板层，其参数为 $a = 2.500$ $\\mathrm{\\AA}$，$b = 2.500$ $\\mathrm{\\AA}$，$c = 15.000$ $\\mathrm{\\AA}$，$\\alpha = 90^\\circ$，$\\beta = 90^\\circ$，以及 $\\gamma = 120^\\circ$。\n- **特定目标分辨率：** $\\Delta k = 0.200$ $\\mathrm{\\AA}^{-1}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题定义明确且科学上合理。\n- **科学依据：** 正格矢和倒格矢、晶胞体积以及使用 Monkhorst-Pack 网格进行布里渊区采样的概念，是固态物理学和计算材料科学中的基本原理。所提供的晶格数值对于表面板层模型是物理上合理的。\n- **良态问题：** 问题提供了推导唯一解所需的所有必要定义、约束和数据。对网格尺寸 $(N_x, N_y, N_z)$ 的要求（满足清晰不等式的最小奇数）是明确无误的。\n- **客观性：** 语言精确且定量。没有主观或基于观点的陈述。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解答\n解答分为两部分。首先，推导确定 Monkhorst-Pack 网格尺寸的通用方案。其次，将此方案应用于所提供的特定六方板层几何结构。\n\n**第一部分：通用方案的推导**\nMonkhorst-Pack 网格是用于在布里渊区采样的均匀 $\\mathbf{k}$ 点网格。对于一个沿倒格矢方向 $\\mathbf{b}_1$、$\\mathbf{b}_2$ 和 $\\mathbf{b}_3$ 分别有 $N_x$、$N_y$ 和 $N_z$ 个划分的网格，采样的 $\\mathbf{k}$ 点集是由沿这些矢量的分数坐标的线性组合生成的。\n\n沿倒格矢 $\\mathbf{b}_1$ 方向上相邻 $\\mathbf{k}$ 点之间的间距是矢量 $\\frac{1}{N_x}\\mathbf{b}_1$ 的模长，即 $\\frac{|\\mathbf{b}_1|}{N_x}$。设倒格矢的模长为 $b_1 = |\\mathbf{b}_1|$、$b_2 = |\\mathbf{b}_2|$ 和 $b_3 = |\\mathbf{b}_3|$。因此，间距分别为 $\\frac{b_1}{N_x}$、$\\frac{b_2}{N_y}$ 和 $\\frac{b_3}{N_z}$。\n\n问题要求此间距不大于目标分辨率 $\\Delta k$。这为整数网格尺寸 $N_x, N_y, N_z$ 带来了一组不等式：\n$$\n\\frac{b_1}{N_x} \\le \\Delta k \\implies N_x \\ge \\frac{b_1}{\\Delta k}\n$$\n$$\n\\frac{b_2}{N_y} \\le \\Delta k \\implies N_y \\ge \\frac{b_2}{\\Delta k}\n$$\n$$\n\\frac{b_3}{N_z} \\le \\Delta k \\implies N_z \\ge \\frac{b_3}{\\Delta k}\n$$\n问题进一步要求 $N_x$、$N_y$ 和 $N_z$ 必须是满足这些条件的最小正奇数。正整数的条件保证了至少有一个划分。\n\n确定每个整数 $N_i$（对于 $i \\in \\{x,y,z\\}$）的方案如下：\n1.  计算所需的最小值，$R_i = \\frac{b_i}{\\Delta k}$。\n2.  找到大于或等于 $R_i$ 的最小整数。这通过向上取整函数计算，$M_i = \\lceil R_i \\rceil$。\n3.  如果 $M_i$ 是奇数，则 $N_i = M_i$。\n4.  如果 $M_i$ 是偶数，则必须选择下一个奇数，因此 $N_i = M_i + 1$。\n\n该方案确保所有约束都得到满足。\n\n**第二部分：应用于六方板层几何结构**\n首先，我们必须根据给定的正格矢参数计算倒格矢的模长 ($b_1, b_2, b_3$)：$a = 2.500$ $\\mathrm{\\AA}$，$b = 2.500$ $\\mathrm{\\AA}$，$c = 15.000$ $\\mathrm{\\AA}$，$\\alpha = 90^\\circ$，$\\beta = 90^\\circ$，以及 $\\gamma = 120^\\circ$。\n\n正格矢晶胞的体积 $V$ 由以下公式给出：\n$$\nV = abc \\sqrt{1 - \\cos^2\\alpha - \\cos^2\\beta - \\cos^2\\gamma + 2\\cos\\alpha\\cos\\beta\\cos\\gamma}\n$$\n代入给定的角度，$\\cos(90^\\circ) = 0$ 和 $\\cos(120^\\circ) = -1/2$：\n$$\nV = (2.5)(2.5)(15.0) \\sqrt{1 - 0 - 0 - \\left(-\\frac{1}{2}\\right)^2 + 2(0)(0)\\left(-\\frac{1}{2}\\right)} = 93.75 \\sqrt{1 - \\frac{1}{4}} = 93.75 \\frac{\\sqrt{3}}{2} \\text{ } \\mathrm{\\AA}^3\n$$\n对于 $\\alpha=\\beta=90^\\circ$ 这些特定角度，体积公式简化为 $V = abc\\sin\\gamma$。\n\n倒格矢的模长由以下公式给出：\n$$\nb_1 = |\\mathbf{b}_1| = \\frac{2\\pi}{V} |\\mathbf{b} \\times \\mathbf{c}| = \\frac{2\\pi bc \\sin\\alpha}{V}\n$$\n$$\nb_2 = |\\mathbf{b}_2| = \\frac{2\\pi}{V} |\\mathbf{c} \\times \\mathbf{a}| = \\frac{2\\pi ca \\sin\\beta}{V}\n$$\n$$\nb_3 = |\\mathbf{b}_3| = \\frac{2\\pi}{V} |\\mathbf{a} \\times \\mathbf{b}| = \\frac{2\\pi ab \\sin\\gamma}{V}\n$$\n代入 $V = abc\\sin\\gamma$ 和给定的角度：\n$$\nb_1 = \\frac{2\\pi bc \\sin(90^\\circ)}{abc\\sin(120^\\circ)} = \\frac{2\\pi (1)}{a\\sin(120^\\circ)} = \\frac{2\\pi}{(2.5)(\\sqrt{3}/2)} = \\frac{4\\pi}{2.5\\sqrt{3}} = \\frac{8\\pi}{5\\sqrt{3}} = \\frac{8\\pi\\sqrt{3}}{15} \\text{ } \\mathrm{\\AA}^{-1}\n$$\n由于 $a=b$ 且 $\\alpha=\\beta$，模长 $b_2$ 与 $b_1$ 相同：\n$$\nb_2 = \\frac{2\\pi ca \\sin(90^\\circ)}{abc\\sin(120^\\circ)} = \\frac{2\\pi (1)}{b\\sin(120^\\circ)} = \\frac{8\\pi\\sqrt{3}}{15} \\text{ } \\mathrm{\\AA}^{-1}\n$$\n对于 $b_3$：\n$$\nb_3 = \\frac{2\\pi ab \\sin(120^\\circ)}{abc\\sin(120^\\circ)} = \\frac{2\\pi}{c} = \\frac{2\\pi}{15} \\text{ } \\mathrm{\\AA}^{-1}\n$$\n现在我们应用推导出的方案，目标分辨率为 $\\Delta k = 0.200 = 1/5$ $\\mathrm{\\AA}^{-1}$。\n\n对于 $N_x$：\n$$\nR_x = \\frac{b_1}{\\Delta k} = \\frac{8\\pi\\sqrt{3}/15}{1/5} = \\frac{8\\pi\\sqrt{3}}{3} \\approx 14.518\n$$\n大于或等于 $14.518$ 的最小整数是 $M_x = \\lceil 14.518 \\rceil = 15$。由于 $15$ 是奇数，我们设 $N_x = 15$。\n\n对于 $N_y$：\n$$\nR_y = \\frac{b_2}{\\Delta k} = \\frac{8\\pi\\sqrt{3}/15}{1/5} = \\frac{8\\pi\\sqrt{3}}{3} \\approx 14.518\n$$\n大于或等于 $14.518$ 的最小整数是 $M_y = \\lceil 14.518 \\rceil = 15$。由于 $15$ 是奇数，我们设 $N_y = 15$。\n\n对于 $N_z$：\n$$\nR_z = \\frac{b_3}{\\Delta k} = \\frac{2\\pi/15}{1/5} = \\frac{2\\pi}{3} \\approx 2.094\n$$\n大于或等于 $2.094$ 的最小整数是 $M_z = \\lceil 2.094 \\rceil = 3$。由于 $3$ 是奇数，我们设 $N_z = 3$。\n\n最终得到的 Monkhorst-Pack 网格尺寸为 $(N_x, N_y, N_z) = (15, 15, 3)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n15  15  3\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论上，增加$k$点密度总能提高计算精度，但在实践中，我们常常需要在精度和效率之间取得平衡。对于金属体系，不充分的$k$点采样会导致严重的数值问题，尤其是在进行几何优化时。本练习模拟了一个典型的催化研究场景，通过分析CO在Pt(111)表面吸附弛豫过程中的反常现象，帮助你学会识别费米面采样不足的“信号”（如力的振荡），并评估各种修正策略（如增加网格密度、引入展宽技术）的有效性。",
            "id": "3870674",
            "problem": "在一次周期性密度泛函理论 (DFT) 模拟中，研究一氧化碳在铂 $ (111) $ 板上的吸附，你优化了一个带有真空区的 $ (3 \\times 3) $ 表面超胞的几何结构。你使用了 $ 3 \\times 3 \\times 1 $ 的 Monkhorst–Pack $ \\mathbf{k} $ 点网格和 $ \\sigma = 0.05\\ \\mathrm{eV} $ 的金属性展宽。在准牛顿离子弛豫过程中，吸附物上的法向力在连续的离子步之间符号交替变化，而总能量几乎单调下降。当你将面内 $ \\mathbf{k} $ 网格加密到 $ 5 \\times 5 \\times 1 $ 时，力的振荡减小但并未消除。另外，当你保持粗糙的 $ \\mathbf{k} $ 网格并将展宽增加到 $ \\sigma = 0.20\\ \\mathrm{eV} $ 时，振荡基本消失，但相对于 $ \\sigma = 0.05\\ \\mathrm{eV} $ 的结果，弛豫后的吸附高度增加了 $ 0.10\\ \\mathrm{\\AA} $。你还观察到，弛豫后的吸附高度沿 $ \\Gamma \\rightarrow M $ 方向，对面内 $ \\mathbf{k} $ 点的数量表现出奇偶依赖性。\n\n考虑以下关于在吸附弛豫过程中，金属板层计算中费米面取样不足的诊断和补救措施的候选陈述。哪些陈述是正确的？\n\nA. 在粗糙的 $ \\mathbf{k} $ 点取样下，离子步之间吸附物法向力的符号和大小交替变化，且这与费米能级附近电子占据数的微小变化相关，这是费米面取样不足的一个标志。增加面内 $ \\mathbf{k} $ 点密度并在弛豫过程中采用中等的有限温展宽 $ \\sigma \\approx 0.10\\text{–}0.20\\ \\mathrm{eV} $ 是减少这种力振荡的恰当补救措施。\n\nB. 如果总能量随离子步平滑变化但力发生振荡，并且这种行为在增加平面波截断能后消失，同时对 $ \\mathbf{k} $ 网格加密和展宽变化不敏感，那么其根源是费米面取样不足；补救措施是降低平面波截断能以抑制基组 Pulay 力。\n\nC. 优化后的吸附高度沿某个与费米面相交的方向，对 $ \\mathbf{k} $ 点数量表现出奇偶依赖性，这与费米面积分不佳相符；在弛豫过程中，用带 Blöchl 修正的零温四面体方法代替有限温展宽，是治愈板层弛豫中金属性力振荡的推荐方法。\n\nD. 在固定的粗糙 $ \\mathbf{k} $ 网格下，弛豫后的几何结构对展宽宽度 $ \\sigma $ 有很强的依赖性，而当同时增加 $ N_k $ 和减小 $ \\sigma $ 并大致保持 $ N_k \\sigma $ 不变时这种依赖性消失，这表明费米面取样不足。一个合理的方案是，使力相对于 $ N_k $ 和 $ \\sigma $ 都收敛，在弛豫过程中于非零 $ \\sigma $ 下最小化有限温 Mermin 自由能，然后在固定的密集 $ \\mathbf{k} $ 网格下外推至 $ \\sigma \\rightarrow 0 $ 以获得最终的能量。\n\nE. 对于一个 $ (3 \\times 3) $ 表面单胞，从以 $ \\Gamma $ 点为中心的 $ 3 \\times 3 \\times 1 $ 网格切换到 Monkhorst–Pack $ 4 \\times 4 \\times 1 $ 网格，观察到吸附能有 $ 0.20\\ \\mathrm{eV} $ 的变化而表面应力几乎不变，这很可能是由 Pulay 应力引起的；正确的补救措施是在不改变 $ \\mathbf{k} $ 点的情况下减小电子混合参数。\n\nF. 在吸附过程中，当势随离子步发生变化时，最大的力振荡与费米面相对于离散 $ \\mathbf{k} $ 点的微小刚性平移同时发生。使用更密集的面内 $ \\mathbf{k} $ 网格（目标是在不同超胞尺寸间保持大致均匀的绝对 $ \\Delta k $ 间距），并采用中等 $ \\sigma $ 值的 Marzari–Vanderbilt 冷展宽，是对金属板层的有效缓解措施。\n\n选择所有正确的陈述。",
            "solution": "所提供的问题陈述描述了在金属体系的周期性密度泛函理论 (DFT) 计算中遇到的一个常见数值问题，特别是在离子弛豫过程中的力振荡现象。这个问题提得很好且有科学依据，详细描述了一氧化碳 (CO) 在铂 (Pt)($111$) 表面吸附的真实情景。我们将验证所提供的观察结果，然后评估每个候选陈述。\n\n关键的物理和数值原理如下：\n1.  在金属体系中，电子态被连续填充直至费米能 $E_F$。在倒易空间中，占据态和未占据态之间的边界就是费米面。\n2.  周期性 DFT 计算通过对有限 $ \\mathbf{k} $ 点集的离散求和来近似计算总能量等属性的连续布里渊区 (BZ) 积分。\n3.  原子上的力是通过总能量对原子位置的导数计算得出的，即 $ \\mathbf{F}_I = - \\frac{dE_{tot}}{d\\mathbf{R}_I} $。对于金属，由于费米面的存在，力的计算变得复杂。\n4.  在几何优化过程中，微小的原子位移会引起有效势的微小变化，这反过来又会使电子能带能量 $ \\epsilon_{n\\mathbf{k}} $ 发生移动。\n5.  如果 $ \\mathbf{k} $ 点网格太粗糙，某个能带可能会穿越费米能级，导致该态的占据数发生突变（从 $1$ 变为 $0$ 或反之）。这会导致总能量面出现不连续性，以及作为其导数的力出现大的波动或“噪音”。这是费米面取样不足的典型特征。\n6.  这种力噪音可能导致优化算法（如准牛顿法）过冲，从而引起原子位置和力的振荡，阻碍收敛。\n7.  为缓解此问题，采用了展宽技术。它们将 $E_F$ 处占据数的尖锐阶跃函数替换为平滑函数（例如，费米-狄拉克分布 $f(\\frac{\\epsilon - E_F}{\\sigma})$，其中 $ \\sigma $ 是展宽宽度）。这使得即使在粗糙的 $ \\mathbf{k} $ 网格下，能量和力也成为原子位置的连续函数。计算出的能量是对应于有限电子温度 $T_e$（其中 $ \\sigma \\approx k_B T_e $）的自由能。\n8.  较大的 $ \\sigma $ 可以稳定力，但也可能引入显著误差，因为体系是在一个很高的虚拟温度下弛豫的。优化后的几何结构和能量可能与真实的 $T=0\\ \\mathrm{K}$ 结果有很大差异。正确的物理结果是在无限 $ \\mathbf{k} $ 点 ($N_k \\rightarrow \\infty$) 和零展宽 ($ \\sigma \\rightarrow 0 $) 的双重极限下得到的。\n\n问题陈述中的观察结果是此问题的典型症状：\n-   力的振荡随 $ \\mathbf{k} $ 网格加密（从 $ 3 \\times 3 \\times 1 $ 到 $ 5 \\times 5 \\times 1 $）而减小。\n-   力的振荡随展宽增加（$ \\sigma $ 从 $ 0.05\\ \\mathrm{eV} $ 增加到 $ 0.20\\ \\mathrm{eV} $）而消失。\n-   弛豫后的几何结构随展宽增加而发生显著变化（高度变化 $ 0.10\\ \\mathrm{\\AA} $），表明存在较大的展宽引入误差。\n-   对 $ N_k $ 的奇偶依赖性，这是一个已知的、与是否包含 $ E_F $ 附近具有特殊态的高对称性点有关的人为效应。\n\n现在我们来评估每个陈述。\n\n**A. 在粗糙的 $ \\mathbf{k} $ 点取样下，离子步之间吸附物法向力的符号和大小交替变化，且这与费米能级附近电子占据数的微小变化相关，这是费米面取样不足的一个标志。增加面内 $ \\mathbf{k} $ 点密度并在弛豫过程中采用中等的有限温展宽 $ \\sigma \\approx 0.10\\text{–}0.20\\ \\mathrm{eV} $ 是减少这种力振荡的恰当补救措施。**\n这个陈述是该问题及其标准解决方案的教科书式定义。力的符号交替变化是原子位置更新时，粗糙 $ \\mathbf{k} $ 网格上占据数突变的直接后果，这正是费米面取样不足的定义。提出的补救措施——增加 $ \\mathbf{k} $ 点密度以改善布里渊区积分，以及使用中等展宽宽度以确保力的连续性——正是解决此问题的正确第一步。$ \\sigma \\approx 0.10\\text{–}0.20\\ \\mathrm{eV} $ 的范围是确保弛豫过程中平滑收敛的典型选择，尽管必须意识到由此对最终结构和能量造成的人为影响。\n**结论：正确。**\n\n**B. 如果总能量随离子步平滑变化但力发生振荡，并且这种行为在增加平面波截断能后消失，同时对 $ \\mathbf{k} $ 网格加密和展宽变化不敏感，那么其根源是费米面取样不足；补救措施是降低平面波截断能以抑制基组 Pulay 力。**\n这个陈述在多个方面都是不正确的。首先，所描述的情景（对 $ \\mathbf{k} $ 网格和展宽不敏感，对平面波截断能敏感）指向的是基组不完备性，而不是费米面取样问题。这些由不完备基组引起的力被称为 Pulay 力。其次，诊断是错误的；它将问题误判为费米面取样不足。第三，所提出的补救措施会适得其反。要减小 Pulay 力，必须*增加*平面波截断能直至基组收敛，而不是降低它。\n**结论：不正确。**\n\n**C. 优化后的吸附高度沿某个与费米面相交的方向，对 $ \\mathbf{k} $ 点数量表现出奇偶依赖性，这与费米面积分不佳相符；在弛豫过程中，用带 Blöchl 修正的零温四面体方法代替有限温展宽，是治愈板层弛豫中金属性力振荡的推荐方法。**\n陈述的第一部分是正确的：奇偶依赖性确实是布里渊区积分不佳的一个已知人为效应。然而，关于补救措施的第二部分是不正确的。虽然四面体方法（带 Blöchl 修正）对于固定几何结构的总能量计算非常准确，但它通常不适合用于几何弛豫。该方法提供了能带的分段线性插值，虽然积分能量是连续的，但当某个 $ \\mathbf{k} $ 点顶点的能级穿过费米能级时，其导数（力）可能不连续且有噪音。展宽方法是专门为提供平滑、连续的力而设计的，因此是金属中离子弛豫的标准选择。\n**结论：不正确。**\n\n**D. 在固定的粗糙 $ \\mathbf{k} $ 网格下，弛豫后的几何结构对展宽宽度 $ \\sigma $ 有很强的依赖性，而当同时增加 $ N_k $ 和减小 $ \\sigma $ 并大致保持 $ N_k \\sigma $ 不变时这种依赖性消失，这表明费米面取样不足。一个合理的方案是，使力相对于 $ N_k $ 和 $ \\sigma $ 都收敛，在弛豫过程中于非零 $ \\sigma $ 下最小化有限温 Mermin 自由能，然后在固定的密集 $ \\mathbf{k} $ 网格下外推至 $ \\sigma \\rightarrow 0 $ 以获得最终的能量。**\n这个陈述准确地描述了一个诊断测试和一个稳健的、先进的计算方案。对于粗糙的 $ \\mathbf{k} $ 网格，结果对 $ \\sigma $ 的依赖性是取样问题的明确迹象。一个合理的程序包括使用足够密集的 $ \\mathbf{k} $ 网格和合适的展宽 $ \\sigma $，通过最小化相应的自由能（例如，对于费米-狄拉克展宽，是 Mermin 自由能）来获得平滑收敛的几何结构。弛豫之后，为了获得准确的最终能量，必须消除展宽引起的误差。这通常通过在弛豫后的几何结构上使用非常密集的 $ \\mathbf{k} $ 网格进行静态计算，并将能量外推到 $ \\sigma \\rightarrow 0 $ 的极限来完成。整个方案确保了高效的弛豫和准确的最终结果。\n**结论：正确。**\n\n**E. 对于一个 $ (3 \\times 3) $ 表面单胞，从以 $ \\Gamma $ 点为中心的 $ 3 \\times 3 \\times 1 $ 网格切换到 Monkhorst–Pack $ 4 \\times 4 \\times 1 $ 网格，观察到吸附能有 $ 0.20\\ \\mathrm{eV} $ 的变化而表面应力几乎不变，这很可能是由 Pulay 应力引起的；正确的补救措施是在不改变 $ \\mathbf{k} $ 点的情况下减小电子混合参数。**\n这个陈述有根本性的缺陷。改变 $ \\mathbf{k} $ 网格导致能量发生巨大变化（$ 0.20\\ \\mathrm{eV} $），这是 $ \\mathbf{k} $ 点收敛性差的明确指标，是费米面取样不足的表现，而不是 Pulay 应力。Pulay 应力与平面波基组截断能有关，而与 $ \\mathbf{k} $ 点网格无关。提议的补救措施，即改变电子混合参数，也是不正确的。混合参数影响自洽场 (SCF) 循环的收敛速度，而不是收敛后的总能量。它是一个算法的数值参数，而不是用于纠正取样错误的物理参数。\n**结论：不正确。**\n\n**F. 在吸附过程中，当势随离子步发生变化时，最大的力振荡与费米面相对于离散 $ \\mathbf{k} $ 点的微小刚性平移同时发生。使用更密集的面内 $ \\mathbf{k} $ 网格（目标是在不同超胞尺寸间保持大致均匀的绝对 $ \\Delta k $ 间距），并采用中等 $ \\sigma $ 值的 Marzari–Vanderbilt 冷展宽，是对金属板层的有效缓解措施。**\n这个陈述对问题提供了富有物理洞察力的描述，并推荐了先进、有效的解决方案。将力振荡的起源归因于费米面与固定 $ \\mathbf{k} $ 网格之间的相对位移，这一描述是精确的。这些建议构成了最佳实践。保持恒定的 $ \\mathbf{k} $ 点间距 $ \\Delta k $ 可确保在比较不同超胞尺寸的计算时具有一致的精度。Marzari–Vanderbilt 冷展宽是一种精妙的方法，旨在最小化有限 $ \\sigma $ 下的自由能与真实 $T=0\\ \\mathrm{K}$ 总能量之间的误差，使其成为金属体系中进行精确稳定弛豫的绝佳选择。\n**结论：正确。**",
            "answer": "$$\\boxed{ADF}$$"
        },
        {
            "introduction": "在真实的计算任务中，$k$点网格的选择并非孤立存在，它与平面波截断能$E_{\\text{cut}}$等其他关键参数共同决定了计算的总精度和总成本。一个高效的计算策略必须协同优化这些参数。本练习提供了一个量化的框架，通过简化的误差和成本模型，让你探索如何在$k$点采样和基组完备性之间进行权衡，以在满足给定精度要求的前提下，找到计算成本最低的参数组合$(E_{\\text{cut}}, N_k)$ 。",
            "id": "3870671",
            "problem": "考虑一个在计算催化和化学工程中常用的周期性金属体系，其中每个晶胞的总能量使用平面波基组和布里渊区积分进行计算。以下经过充分检验的基本事实和定义适用：\n\n- 在周期性边界条件下，电子态由布洛赫函数描述，每个晶胞的总能量是对晶体动量 $k$ 的布里渊区积分。数值计算将该积分替换为对 $N_k$ 个离散 $k$ 点的求和，例如通过 Monkhorst-Pack 网格实现。对于采用有限温展宽的金属，布里渊区采样的求积误差随点数呈代数下降，表示为 $e_k(N_k) = B N_k^{-q}$，其中 $B$ 和 $q$ 是取决于材料和展宽细节的正常数。\n\n- 在平面波方法中，基组由一个能量截断 $E_{\\text{cut}}$（单位为 $\\mathrm{eV}$）来截断，这限制了所包含平面波的最大动能。诸如总能量等平滑可观测量的不完备性误差通常随着 $E_{\\text{cut}}$ 的增加按幂律 $e_{\\text{pw}}(E_{\\text{cut}}) = A E_{\\text{cut}}^{-p}$ 下降，其中 $A$ 和 $p$ 是正常数，这反映了光滑函数的傅里叶展开的收敛性质。\n\n- 总能量误差被建模为独立贡献之和 $e_{\\text{tot}}(E_{\\text{cut}}, N_k) = e_{\\text{pw}}(E_{\\text{cut}}) + e_k(N_k) = A E_{\\text{cut}}^{-p} + B N_k^{-q}$。\n\n- 计算成本主要由与平面波数量和 $k$ 点数量成比例的运算决定。平面波的数量与 $E_{\\text{cut}}^{3/2}$ 成正比，即 $N_{\\text{pw}} \\propto E_{\\text{cut}}^{3/2}$，因为由 $E_{\\text{cut}}$ 设定的半径球面内的倒易格矢数量随倒易空间的体积增长。忽略弱对数因子，一个简单且广泛使用的成本模型是 $C(E_{\\text{cut}}, N_k) = \\gamma N_k E_{\\text{cut}}^{s}$，其中 $s \\approx 3/2$，$\\gamma$ 是将操作计数转换为墙上时钟时间（以秒为单位）的比例常数。\n\n对于给定的参数 $(A, p, B, q, s, \\gamma)$、一个容差 $\\tau$（单位为 $\\mathrm{eV}$），以及 $E_{\\text{cut}}$ 和 $N_k$ 的有界离散搜索范围，您需要计算能够最小化计算成本 $C(E_{\\text{cut}}, N_k)$ 同时满足能量误差约束 $e_{\\text{tot}}(E_{\\text{cut}}, N_k) \\le \\tau$ 的联合参数选择 $(E_{\\text{cut}}, N_k)$。如果有界搜索空间中没有参数对满足容差，则返回使 $e_{\\text{tot}}(E_{\\text{cut}}, N_k)$ 最小的参数对（即，在边界内可达到的最接近的值），并将该情况标记为不可实现。\n\n算法要求：\n\n- 使用误差模型 $e_{\\text{tot}}(E_{\\text{cut}}, N_k) = A E_{\\text{cut}}^{-p} + B N_k^{-q}$。\n\n- 使用成本模型 $C(E_{\\text{cut}}, N_k) = \\gamma N_k E_{\\text{cut}}^{s}$。\n\n- 在 $E_{\\min}$ 和 $E_{\\max}$（含边界）之间，以步长 $\\Delta E_{\\text{cut}}$ 在以 $\\mathrm{eV}$ 为单位的整数网格上搜索 $E_{\\text{cut}}$。\n\n- 在 $N_{k,\\min}$ 和 $N_{k,\\max}$（含边界）之间的整数上搜索 $N_k$。\n\n- 如果多个参数对达到了相同的最小成本（在数值容差范围内），选择 $N_k$ 最小的那个；如果仍然相同，则选择 $E_{\\text{cut}}$ 最小的那个。\n\n单位和输出要求：\n\n- 所有能量必须以 $\\mathrm{eV}$ 为单位处理和报告。\n\n- 计算成本必须以秒为单位报告。\n\n- 对于每个测试案例，输出一个列表 $[\\text{achievable}, E_{\\text{cut}}^{\\star}, N_k^{\\star}, C^{\\star}]$，其中 $\\text{achievable}$ 是一个布尔值，指示是否满足了容差 $\\tau$，$E_{\\text{cut}}^{\\star}$ 是所选的截断能量（单位为 $\\mathrm{eV}$，整数），$N_k^{\\star}$ 是所选的 $k$ 点数（整数），$C^{\\star}$ 是计算成本（单位为秒，四舍五入到六位小数）。您的程序应生成一行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，$[ [\\text{True}, 500, 31, 1.733000], [\\text{False}, 900, 128, 4.321000] ]$）。\n\n测试套件：\n\n使用以下四个案例来检验算法：\n\n- 案例 1（均衡，中等容差）：\n  - $A = 0.5$, $p = 1.5$, $B = 0.3$, $q = 1.0$, $s = 1.5$, $\\gamma = 5 \\times 10^{-6}$, $\\tau = 0.01$。\n  - $E_{\\min} = 200$, $E_{\\max} = 800$, $\\Delta E_{\\text{cut}} = 10$。\n  - $N_{k,\\min} = 6$, $N_{k,\\max} = 60$。\n\n- 案例 2（容差严格，在边界内可能不可行）：\n  - $A = 0.8$, $p = 1.5$, $B = 0.5$, $q = 1.0$, $s = 1.5$, $\\gamma = 7 \\times 10^{-6}$, $\\tau = 0.001$。\n  - $E_{\\min} = 300$, $E_{\\max} = 900$, $\\Delta E_{\\text{cut}} = 10$。\n  - $N_{k,\\min} = 8$, $N_{k,\\max} = 128$。\n\n- 案例 3（容差宽松，基组误差相对于 $k$ 点采样误差较小）：\n  - $A = 1.0$, $p = 1.2$, $B = 0.2$, $q = 1.0$, $s = 1.5$, $\\gamma = 4 \\times 10^{-6}$, $\\tau = 0.05$。\n  - $E_{\\min} = 200$, $E_{\\max} = 600$, $\\Delta E_{\\text{cut}} = 10$。\n  - $N_{k,\\min} = 4$, $N_{k,\\max} = 20$。\n\n- 案例 4（$k$ 点误差占主导，且具有稍高的平滑指数）：\n  - $A = 0.1$, $p = 1.5$, $B = 1.0$, $q = 1.2$, $s = 1.5$, $\\gamma = 6 \\times 10^{-6}$, $\\tau = 0.02$。\n  - $E_{\\min} = 300$, $E_{\\max} = 800$, $\\Delta E_{\\text{cut}} = 10$。\n  - $N_{k,\\min} = 10$, $N_{k,\\max} = 100$。\n\n您的程序必须为每个案例实现上述搜索和选择策略，并按规定生成包含四个列表的单行聚合输出。所有数值报告必须遵守指定的单位，且 $C^{\\star}$ 必须四舍五入到六位小数。",
            "solution": "该问题已经过验证，并被确定为计算材料科学领域内一个定义明确、有科学依据且客观的优化任务。它没有任何使其无效的缺陷。\n\n任务是找到最优计算参数——平面波能量截断 $E_{\\text{cut}}$ 和 $k$ 点数量 $N_k$——以最小化计算成本 $C$，同时确保总能量误差 $e_{\\text{tot}}$ 保持在指定的容差 $\\tau$ 以下。问题为误差和成本提供了具有物理动机的代数模型，它们都是 $E_{\\text{cut}}$ 和 $N_k$ 的函数。\n\n总误差被建模为两个独立贡献之和：\n$$ e_{\\text{tot}}(E_{\\text{cut}}, N_k) = e_{\\text{pw}}(E_{\\text{cut}}) + e_k(N_k) = A E_{\\text{cut}}^{-p} + B N_k^{-q} $$\n其中 $e_{\\text{pw}}$ 是基组不完备性误差，$e_k$ 是布里渊区采样误差。参数 $A, p, B, q$ 是特定于材料体系的正常数。\n\n计算成本被建模为：\n$$ C(E_{\\text{cut}}, N_k) = \\gamma N_k E_{\\text{cut}}^{s} $$\n其中 $s \\approx 3/2$，$\\gamma$ 是一个比例常数。\n\n对最优参数对 $(E_{\\text{cut}}, N_k)$ 的搜索将在一个有限的离散网格上进行。$E_{\\text{cut}}$ 在从 $E_{\\min}$ 到 $E_{\\max}$ 的整数网格上搜索，步长为 $\\Delta E_{\\text{cut}}$。$N_k$ 在从 $N_{k,\\min}$ 到 $N_{k,\\max}$ 的整数范围内搜索。鉴于搜索空间是有限的，并且对于所提供的测试案例来说不是过大，全面的暴力网格搜索是最直接和稳健的算法。这种方法保证在离散空间中找到真正的最优解，避免了更复杂优化方案可能存在的陷阱，这些陷阱可能会受到考虑离散化效应时目标函数的非光滑或非单调性质的影响。\n\n对于每个测试案例，算法按以下步骤进行：\n1.  在指定的离散范围内生成所有可能的参数对 $(E_{\\text{cut}}, N_k)$。\n2.  对每个参数对，计算总误差 $e_{\\text{tot}}$ 和计算成本 $C$。\n3.  将结果解分为两组：\n    a. `valid_solutions`（有效解）：满足误差约束 $e_{\\text{tot}} \\le \\tau$ 的参数对。\n    b. `all_solutions`（所有解）：所有参数对，连同其计算出的误差和成本一起存储。该集合用于回退方案。\n4.  根据是否找到任何有效解来确定最终选择：\n    a. 如果 `valid_solutions` 不为空，则容差是可实现的。最优参数对通过对该列表进行排序以找到成本最小的一个来确定。问题指定了一个明确的决胜规则：如果成本相等，则优先选择 $N_k$ 较小的参数对；如果仍然相同，则选择 $E_{\\text{cut}}$ 较小的那个。这是通过以元组 $(C, N_k, E_{\\text{cut}})$ 作为键对有效解进行字典序排序来实现的。\n    b. 如果 `valid_solutions` 为空，则容差是不可实现的。在这种情况下，要求是返回使总误差 $e_{\\text{tot}}$ 最小的参数对。对于这种情况，一个合理且一致的决胜方案是（尽管未明确说明）从最小误差的参数对中选择成本最低的，其次是 $N_k$ 最低的，然后是 $E_{\\text{cut}}$ 最低的。这是通过以键 $(e_{\\text{tot}}, C, N_k, E_{\\text{cut}})$ 对 `all_solutions` 进行字典序排序来实现的。\n5.  然后构建该案例的最终结果 $[\\text{achievable}, E_{\\text{cut}}^{\\star}, N_k^{\\star}, C^{\\star}]$，其中成本 $C^{\\star}$ 按要求四舍五入到六位小数。在第一种情况下，布尔值 `achievable` 设置为 `True`，在第二种情况下设置为 `False`。\n此过程应用于每个测试案例，并将结果汇总为单个列表的列表作为最终输出。",
            "answer": "[[True, 410, 38, 1.733004], [False, 900, 128, 4.321382], [True, 200, 6, 0.431129], [True, 300, 56, 1.745422]]"
        }
    ]
}