{
    "hands_on_practices": [
        {
            "introduction": "计算材料的光学吸收光谱是含时密度泛函理论（TDDFT）最成功的应用之一，尤其是在光催化和光电材料领域。这个练习将指导你通过一个简化但物理意义明确的模型，来比较TDDFT和更精确的GW-BSE方法在预测半导体中激子束缚能方面的表现。通过这个练习，你将亲手实现一个模型，量化分析不同交换关联泛函（特别是长程校正泛函）如何弥补TDDFT在处理激子效应时的不足，从而深入理解其内在机理。",
            "id": "3902988",
            "problem": "您的任务是构建并分析一个简化的、但有科学依据的计算比较，用于比较含时密度泛函理论 (TDDFT) 与格林函数加屏蔽库仑 (GW) 方法结合 Bethe-Salpeter 方程 (BSE) 在与光催化相关的原型半导体中计算激子结合能的差异。目标是量化 TDDFT 中的长程修正 (LRC) 交换关联核如何能够部分弥合 TDDFT 与 GW-BSE 预测之间的差异。\n\n从以下基本依据出发，推导出必要的工作关系式：\n\n1.  对 Wannier-Mott 激子使用有效质量类氢模型。格林函数加屏蔽库仑 (GW) 准粒子带隙记为 $E_{g}^{\\mathrm{GW}}$，您将视其为给定输入。在 Wannier-Mott 近似下，三维空间中的 Bethe-Salpeter 方程 (BSE) 结合能由一个类氢里德堡标度乘以折合质量和屏蔽效应给出，其中折合质量为 $\\mu$（以电子质量 $m_{e}$ 为单位），相对介电常数为 $\\varepsilon_{r}$（无量纲），里德堡能量为 $R_{\\infty} = 13.605693$ 电子伏特。目标是仅使用这些物理输入，获得结合能 $E_{b}^{\\mathrm{BSE}}$（以电子伏特为单位）的显式表达式。\n\n2.  在线性响应含时密度泛函理论 (TDDFT) 中，使用单极点（单一主导跃迁）Casida 框架。设独立粒子跃迁频率为 $\\omega \\equiv E_{g}^{\\mathrm{GW}}$（以电子伏特为单位），总耦合为 $K_{\\text{tot}}$，它聚合了 Hartree 和交换关联效应。单极点 Casida 方程产生一个满足以下条件的共振频率 $\\Omega$：\n    $$\n    \\Omega^{2} = \\omega^{2} + 4 \\omega K_{\\text{tot}} .\n    $$\n    对于没有正确长程尾部的局域绝热核，假设在激子通道中的宏观吸引力可忽略不计，并证明为束缚激子估算设置 $K_{\\text{tot}} \\approx 0$ 是合理的，这意味着在这些条件下不存在束缚激子。\n\n3.  引入一个长程修正 (LRC) 核，其形式为 $f_{xc}^{\\mathrm{LRC}}(\\mathbf{q}) = -\\alpha / q^{2}$，其中 $\\alpha$ 是一个作为输入的无量纲强度参数，q 是波矢大小。在长波长下的单极点图像中，论证相应的耦合与 $\\alpha$ 呈线性关系。施加弱耦合一致性条件，即在小 $\\alpha$ 的极限下，TDDFT-LRC 结合能简化为 GW-BSE 结合能的一小部分 $\\alpha$。使用关于 $\\omega$ 的 $K_{\\text{tot}}$ 一阶展开，推导出 $K_{\\text{tot}}$ 关于 $\\alpha$ 和 $E_{b}^{\\mathrm{BSE}}$ 的显式工作关系式，然后写出有限 $\\alpha$ 下 TDDFT-LRC 结合能 $E_{b}^{\\mathrm{TDDFT-LRC}} = \\omega - \\Omega$ 的表达式。\n\n4.  科学真实性约束：\n    - 所有能量必须以电子伏特 (eV) 表示。\n    - 计算出的激发频率必须保持为实数值；确保参数集避免 $\\Omega$ 变为虚数。\n    - 陈述并使用您所做的任何假设（例如，对于所选的简化模型，在宏观激子通道中忽略局域场 Hartree 排斥）。\n\n程序要求：\n- 在一个单一的 Python 程序中实现推导出的表达式，该程序接受一个预定义的参数集测试套件，并为每种情况计算以下四个量：\n  - $E_{b}^{\\mathrm{BSE}}$，单位为 eV。\n  - $E_{b}^{\\mathrm{TDDFT-LDA}}$，单位为 eV，在假设使用没有正确长程尾部的局域绝热核的情况下。\n  - $E_{b}^{\\mathrm{TDDFT-LRC}}$，单位为 eV，使用给定的 $\\alpha$。\n  - 桥接比，定义为 $E_{b}^{\\mathrm{TDDFT-LRC}} / E_{b}^{\\mathrm{BSE}}$（一个无量纲小数）。\n- 所有能量均以电子伏特 (eV) 表示，并打印所有浮点数输出，四舍五入至六位小数。\n\n测试套件：\n使用以下四个测试用例，每个用例为一个元组 $(E_{g}^{\\mathrm{GW}}, \\mu, \\varepsilon_{r}, \\alpha)$，其中 $E_{g}^{\\mathrm{GW}}$ 以电子伏特为单位，$\\mu$ 以 $m_{e}$ 为单位，$\\varepsilon_{r}$ 无量纲：\n- 用例 1 (类氧化物，高屏蔽)：$(3.2, 0.7, 30.0, 0.5)$。\n- 用例 2 (聚合物半导体)：$(2.7, 0.25, 4.0, 0.4)$。\n- 用例 3 (宽带隙半导体)：$(3.4, 0.3, 8.0, 0.8)$。\n- 用例 4 (边界情况，无 LRC)：$(1.8, 0.2, 3.0, 0.0)$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由列表组成的列表，格式为逗号分隔，其中每个内部列表对应一个测试用例，并按以下顺序排列：\n$[E_{b}^{\\mathrm{BSE}}, E_{b}^{\\mathrm{TDDFT-LDA}}, E_{b}^{\\mathrm{TDDFT-LRC}}, E_{b}^{\\mathrm{TDDFT-LRC}} / E_{b}^{\\mathrm{BSE}}]$，\n所有浮点数格式化为六位小数，并用方括号括起来。例如：\n[[x11,x12,x13,x14],[x21,x22,x23,x24],...]",
            "solution": "该问题要求推导并实现公式，以比较通过 Bethe-Salpeter 方程 (BSE) 形式和含时密度泛函理论 (TDDFT) 计算的激子结合能。该分析基于一个针对半导体中 Wannier-Mott 激子的简化但物理上合理的模型。\n\n**1. GW-BSE 结合能 ($E_{b}^{\\mathrm{BSE}}$) 的推导**\n\nBethe-Salpeter 方程 (BSE) 为计算光学吸收谱（包括激子效应）提供了一个强大的框架。对于 Wannier-Mott 激子，即在半导体中典型的弱束缚、空间扩展的电子-空穴对，BSE 可以简化为一个有效质量薛定谔方程。该方程描述了一个类氢系统，其中电子和空穴是构成粒子。\n\n类氢系统在其基态 ($n=1$) 的结合能由 $E_b = R_{\\infty} \\mu_{rel} Z^2 / \\varepsilon_{eff}^2$ 给出，其中 $R_{\\infty}$ 是里德堡能量，$\\mu_{rel}$ 是双粒子系统相对于电子质量 $m_e$ 的折合质量，$Z$ 是有效核电荷，$\\varepsilon_{eff}$ 是介质的有效介电常数。\n\n对于激子，“原子核”是空穴，因此有效电荷为 $Z=1$。质量是电子-空穴的折合质量 $\\mu$，以自由电子质量 $m_e$ 为单位给出。电子和空穴之间的库仑相互作用被半导体的静态介电常数 $\\varepsilon_{r}$ 所屏蔽。因此，我们进行替换 $\\mu_{rel} \\to \\mu$ 和 $\\varepsilon_{eff} \\to \\varepsilon_{r}$。\n\n因此，激子基态的结合能（在此 Wannier-Mott 模型中对应于 BSE 的预测）为：\n$$ E_{b}^{\\mathrm{BSE}} = R_{\\infty} \\frac{\\mu}{\\varepsilon_{r}^{2}} $$\n这里，$R_{\\infty}$ 是里德堡能量，给定为 $13.605693$ eV，$\\mu$ 和 $\\varepsilon_{r}$ 分别是无量纲的折合质量（以 $m_e$ 为单位）和相对介电常数。\n\n**2. 采用局域核的绝热 TDDFT 分析 ($E_{b}^{\\mathrm{TDDFT-LDA}}$)**\n\n在线性响应 TDDFT 中，激发能 $\\Omega$ 是通过求解 Casida 方程得到的。对于一个简化的单极点（主导跃迁）模型，该方程的形式为：\n$$ \\Omega^{2} = \\omega^{2} + 4 \\omega K_{\\text{tot}} $$\n这里，$\\omega$ 是独立粒子跃迁频率，我们被指示将其等同于 GW 准粒子带隙，即 $\\omega = E_{g}^{\\mathrm{GW}}$。$K_{\\text{tot}}$ 项是耦合矩阵元，它包含了由 Hartree 和交换关联 (xc) 势引起的电子-空穴相互作用。\n\n标准的局域或半局域 xc 核，例如来自局域密度近似 (LDA) 或广义梯度近似 (GGA) 的核，存在一个众所周知的缺陷：它们缺乏形成束缚 Wannier-Mott 激子所需的正确的长程 $-1/r$ 吸引尾。在与这些激子相关的长波长极限 ($q \\to 0$) 下，这类局域核对 $K_{\\text{tot}}$ 吸引部分的贡献消失了。剩下的 Hartree 部分是排斥性的。问题要求我们忽略局域场效应，并论证为束缚激子通道设置总耦合为零是合理的。因此，对于 LDA 类型的核，我们设定 $K_{\\text{tot}} \\approx 0$。\n\n将 $K_{\\text{tot}} = 0$ 代入 Casida 方程，得到 $\\Omega^2 = \\omega^2$，或 $\\Omega = \\omega$。激子结合能定义为由于电子-空穴吸引而导致的激发能相对于非相互作用带隙 $\\omega$ 的降低量：\n$$ E_{b} = \\omega - \\Omega $$\n对于 LDA 的情况，这导致：\n$$ E_{b}^{\\mathrm{TDDFT-LDA}} = \\omega - \\omega = 0 \\text{ eV} $$\n这证实了标准的绝热 TDDFT 未能预测束缚的 Wannier-Mott 激子。\n\n**3. TDDFT-LRC 结合能 ($E_{b}^{\\mathrm{TDDFT-LRC}}$) 的推导**\n\n为弥补局域核的失败，引入了长程修正 (LRC) 核。问题指定了一个模型 LRC xc 核，其傅里叶变换为 $f_{xc}^{\\mathrm{LRC}}(\\mathbf{q}) = -\\alpha / q^{2}$。这种形式正确地模仿了库仑相互作用的长程行为，其中 $\\alpha$ 是一个控制其强度的无量纲参数。这导致了一个非零的、吸引性的（负的）耦合常数 $K_{\\text{tot}}$。\n\n我们通过在弱耦合极限（小 $K_{\\text{tot}}$ 或小 $\\alpha$）下强制执行一个一致性条件来推导 $K_{\\text{tot}}$ 的工作表达式。首先，我们将激发能 $\\Omega$ 对 $K_{\\text{tot}}$ 进行一阶展开：\n$$ \\Omega = \\sqrt{\\omega^2 + 4\\omega K_{\\text{tot}}} = \\omega \\left(1 + \\frac{4K_{\\text{tot}}}{\\omega}\\right)^{1/2} \\approx \\omega \\left(1 + \\frac{1}{2} \\frac{4K_{\\text{tot}}}{\\omega}\\right) = \\omega + 2K_{\\text{tot}} $$\n相应的近似结合能为：\n$$ E_{b}^{\\text{approx}} = \\omega - \\Omega \\approx \\omega - (\\omega + 2K_{\\text{tot}}) = -2K_{\\text{tot}} $$\n问题施加的条件是，在这个弱耦合极限下，TDDFT-LRC 结合能应为更准确的 BSE 结合能的一小部分 $\\alpha$：\n$$ E_{b}^{\\text{approx}} = \\alpha E_{b}^{\\mathrm{BSE}} $$\n将这两个近似结合能的表达式相等，我们得到耦合常数的关系式：\n$$ -2K_{\\text{tot}} = \\alpha E_{b}^{\\mathrm{BSE}} \\implies K_{\\text{tot}} = -\\frac{\\alpha E_{b}^{\\mathrm{BSE}}}{2} $$\n这证实了耦合常数与 $\\alpha$ 呈线性关系且是吸引性的 ($K_{\\text{tot}} < 0$)。\n\n现在，我们将这个 $K_{\\text{tot}}$ 的表达式代回到*完整*的、未经近似的单极点 Casida 方程中，以求出有限 $\\alpha$ 时的结合能：\n$$ E_{b}^{\\mathrm{TDDFT-LRC}} = \\omega - \\Omega = \\omega - \\sqrt{\\omega^2 + 4\\omega K_{\\text{tot}}} $$\n$$ E_{b}^{\\mathrm{TDDFT-LRC}} = \\omega - \\sqrt{\\omega^2 + 4\\omega \\left(-\\frac{\\alpha E_{b}^{\\mathrm{BSE}}}{2}\\right)} $$\n$$ E_{b}^{\\mathrm{TDDFT-LRC}} = \\omega - \\sqrt{\\omega^2 - 2\\omega \\alpha E_{b}^{\\mathrm{BSE}}} $$\n为使激发能 $\\Omega$ 为实数，平方根内的参数必须非负，这施加了一个稳定性条件：$\\omega^2 - 2\\omega \\alpha E_{b}^{\\mathrm{BSE}} \\ge 0$。由于 $\\omega = E_{g}^{\\mathrm{GW}} > 0$，这简化为 $\\omega \\ge 2\\alpha E_{b}^{\\mathrm{BSE}}$。\n\n**4. 计算公式总结**\n\n对于每个测试用例 $(E_{g}^{\\mathrm{GW}}, \\mu, \\varepsilon_{r}, \\alpha)$，将计算以下四个量，其中 $\\omega = E_{g}^{\\mathrm{GW}}$ 且 $R_{\\infty} = 13.605693$ eV：\n\n1.  **BSE 结合能**：\n    $$ E_{b}^{\\mathrm{BSE}} = R_{\\infty} \\frac{\\mu}{\\varepsilon_{r}^{2}} $$\n2.  **TDDFT-LDA 结合能**：\n    $$ E_{b}^{\\mathrm{TDDFT-LDA}} = 0.0 $$\n3.  **TDDFT-LRC 结合能**：\n    $$ E_{b}^{\\mathrm{TDDFT-LRC}} = \\omega - \\sqrt{\\omega^2 - 2\\omega \\alpha E_{b}^{\\mathrm{BSE}}} $$\n4.  **桥接比**：\n    $$ \\text{Ratio} = \\frac{E_{b}^{\\mathrm{TDDFT-LRC}}}{E_{b}^{\\mathrm{BSE}}} $$\n    如果 $E_{b}^{\\mathrm{BSE}} = 0$，此比率未定义，但对于给定的输入，$E_{b}^{\\mathrm{BSE}}$ 将为正数。如果 $E_{b}^{\\mathrm{TDDFT-LRC}} = 0$（例如，当 $\\alpha=0$ 时），则比率为 $0$。\n\n实现将把这些公式应用于提供的测试套件。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes exciton binding energies using simplified BSE and TDDFT models\n    for a given set of semiconductor parameters.\n    \"\"\"\n    # Define physical constants and test cases.\n    RYDBERG_EV = 13.605693  # Rydberg energy in electronvolts\n\n    # Test cases: tuples of (E_g_GW, mu, eps_r, alpha)\n    # E_g_GW in eV, mu in units of m_e, eps_r dimensionless, alpha dimensionless\n    test_cases = [\n        (3.2, 0.7, 30.0, 0.5),   # Case 1 (oxide-like)\n        (2.7, 0.25, 4.0, 0.4),   # Case 2 (polymeric semiconductor)\n        (3.4, 0.3, 8.0, 0.8),   # Case 3 (wide-gap semiconductor)\n        (1.8, 0.2, 3.0, 0.0),   # Case 4 (edge case, no LRC)\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        e_g_gw, mu, eps_r, alpha = case\n        omega = e_g_gw  # Independent-particle transition frequency\n\n        # 1. Calculate BSE binding energy using the Wannier-Mott model.\n        # E_b_BSE = R_inf * (mu / eps_r^2)\n        e_b_bse = RYDBERG_EV * mu / (eps_r**2)\n\n        # 2. Binding energy with local TDDFT kernel (e.g., LDA/GGA) is zero.\n        e_b_tddft_lda = 0.0\n\n        # 3. Calculate TDDFT-LRC binding energy.\n        # E_b_LRC = omega - sqrt(omega^2 - 2 * omega * alpha * E_b_BSE)\n        # Check for stability of the Casida equation in this model.\n        stability_term = omega**2 - 2 * omega * alpha * e_b_bse\n        if stability_term  0:\n            # This indicates an unphysical imaginary excitation energy.\n            # For the given test cases, this condition is not met.\n            # We would typically raise an error or handle as invalid.\n            e_b_tddft_lrc = np.nan\n        else:\n            e_b_tddft_lrc = omega - np.sqrt(stability_term)\n\n        # 4. Calculate the bridging ratio.\n        # Handle division by zero if e_b_bse could be zero.\n        if e_b_bse == 0:\n             # This won't happen for the given positive inputs.\n            bridging_ratio = np.nan if e_b_tddft_lrc != 0 else 0.0\n        else:\n            bridging_ratio = e_b_tddft_lrc / e_b_bse\n\n        case_results = [e_b_bse, e_b_tddft_lda, e_b_tddft_lrc, bridging_ratio]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists with 6 decimal places.\n    # e.g., [[x11,x12,x13,x14],[x21,x22,x23,x24],...]\n    formatted_cases = []\n    for res_list in all_results:\n        # Format each number in the list to a string with 6 decimal places.\n        formatted_numbers = [f\"{x:.6f}\" for x in res_list]\n        # Join the numbers into a string like \"[num1,num2,...]\"\n        formatted_cases.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    # Join all case strings into the final output format.\n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "虽然TDDFT在许多方面表现出色，但它在处理电荷转移（CT）激发时会遇到严重的困难，这主要是由常见交换关联泛函中的自相互作用误差（SIE）引起的。本练习将通过一个一维供体-受体模型，让你直面这一挑战，并将TDDFT的计算结果与约束密度泛函理论（cDFT）进行对比。通过计算和分析，你将理解为何标准的局域泛函会严重低估CT激发能，并认识到自相互作用误差在这一过程中的关键作用。",
            "id": "3903019",
            "problem": "题目要求您通过比较跃迁密度和能隙，在一个与计算催化和化学工程相关的简化一维给体-受体模型中，验证时间相关的密度泛函理论 (TDDFT) 的电荷转移激发与约束密度泛函理论 (cDFT) 的结果。请完全使用原子单位制，其中长度单位为玻尔 (Bohr)，能量单位为哈特里 (Hartree)，且不涉及角度。您的任务是计算 TDDFT 和 cDFT 跃迁密度之间的相关性度量，并量化由自相互作用误差引起的能隙差异。您程序的最终输出必须是单行打印，形式为方括号括起来的逗号分隔列表，按指定顺序汇总每个测试用例的结果。\n\n从以下基本概念开始：\n\n- 密度泛函理论 (DFT) 的 Kohn–Sham 公式假定无相互作用的电子在有效势场中运动，该势场能再现真实的基态密度。在最简单的双轨道给体-受体图像中，Kohn–Sham 能隙是 $ \\Delta \\varepsilon = \\varepsilon_{\\mathrm{A}} - \\varepsilon_{\\mathrm{D}} $ 的差值，其中 $ \\varepsilon_{\\mathrm{D}} $ 和 $ \\varepsilon_{\\mathrm{A}} $ 分别是给体和受体前线轨道的 Kohn–Sham 轨道能量。\n- 线性响应范围内的时间相关密度泛函理论 (TDDFT) 将激发能与响应核联系起来。在单极点（单对）近似中，激发能可以表示为 $ \\omega \\approx \\Delta \\varepsilon + K $，其中 $ K $ 包含了电子-空穴相互作用和交换相关核的贡献。\n- 对于良好分离的片段之间的长程电荷转移，物理上正确的核贡献包括转移电子与空穴之间的吸引库仑项，而在局域或半局域近似中，自相互作用误差 (SIE) 会带来虚假的排斥作用。在一个简单的软库仑正则化中，可以写作 $ K \\approx - J_{\\mathrm{DA}} + (1 - \\alpha) \\, U_{\\mathrm{SIE}} $，其中 $ J_{\\mathrm{DA}} $ 是给体和受体片段密度之间的电子-空穴库仑吸引力，$ U_{\\mathrm{SIE}} $ 是跃迁密度的自相互作用积分，$ \\alpha \\in [0,1] $ 参数化了精确交换的比例（其中 $ \\alpha = 0 $ 对应于纯局域泛函）。\n- 在约束密度泛函理论 (cDFT) 中，通过施加约束来强制实现电荷转移，从而在激发能中移除了大部分 SIE 贡献。在同样的简化图像中，激发能被建模为 $ \\omega_{\\mathrm{cDFT}} \\approx \\Delta \\varepsilon - J_{\\mathrm{DA}} $。\n\n您必须实现以下模型和定义：\n\n1. 在有限区间 $ [-L/2, L/2] $ 上使用一维坐标 $ x $，并进行均匀离散化。对于给体和受体轨道，使用归一化高斯函数，\n   $$ \\phi_{\\mathrm{D}}(x) = \\frac{1}{\\pi^{1/4} \\sqrt{\\sigma}} \\exp\\!\\left( - \\frac{(x - x_{\\mathrm{D}})^2}{2 \\sigma^2} \\right), \\quad \\phi_{\\mathrm{A}}(x) = \\frac{1}{\\pi^{1/4} \\sqrt{\\sigma}} \\exp\\!\\left( - \\frac{(x - x_{\\mathrm{A}})^2}{2 \\sigma^2} \\right), $$\n   其中心分别为 $ x_{\\mathrm{D}} = - R/2 $ 和 $ x_{\\mathrm{A}} = + R/2 $，其中 $ R $ 是给体-受体间距，$ \\sigma $ 是宽度参数。相应的密度为 $ \\rho_{\\mathrm{D}}(x) = |\\phi_{\\mathrm{D}}(x)|^2 $ 和 $ \\rho_{\\mathrm{A}}(x) = |\\phi_{\\mathrm{A}}(x)|^2 $。\n2. Tamm–Dancoff 近似 (TDA) 中的 TDDFT 跃迁密度被建模为\n   $$ \\rho_{\\mathrm{TDDFT}}(x) = \\phi_{\\mathrm{D}}(x) \\, \\phi_{\\mathrm{A}}(x). $$\n3. cDFT 跃迁密度（强制电荷转移后的密度变化）被建模为\n   $$ \\delta \\rho_{\\mathrm{cDFT}}(x) = \\rho_{\\mathrm{A}}(x) - \\rho_{\\mathrm{D}}(x). $$\n4. 使用软库仑核以避免一维中的奇异点，\n   $$ v_{\\beta}(x - x') = \\frac{1}{\\sqrt{(x - x')^2 + \\beta^2}}, $$\n   其中软化参数 $ \\beta  0 $。通过在网格上进行数值积分来计算以下相互作用积分：\n   $$ J_{\\mathrm{DA}} = \\iint \\rho_{\\mathrm{D}}(x) \\, v_{\\beta}(x - x') \\, \\rho_{\\mathrm{A}}(x') \\, \\mathrm{d}x \\, \\mathrm{d}x', $$\n   $$ U_{\\mathrm{SIE}} = \\iint \\rho_{\\mathrm{TDDFT}}(x) \\, v_{\\beta}(x - x') \\, \\rho_{\\mathrm{TDDFT}}(x') \\, \\mathrm{d}x \\, \\mathrm{d}x'. $$\n5. Kohn–Sham 能隙为 $ \\Delta \\varepsilon = \\varepsilon_{\\mathrm{A}} - \\varepsilon_{\\mathrm{D}} $。在此简化模型中，TDDFT 能隙为\n   $$ \\Delta E_{\\mathrm{TDDFT}} = \\Delta \\varepsilon - J_{\\mathrm{DA}} + (1 - \\alpha) U_{\\mathrm{SIE}}, $$\n   而 cDFT 能隙为\n   $$ \\Delta E_{\\mathrm{cDFT}} = \\Delta \\varepsilon - J_{\\mathrm{DA}}. $$\n   由自相互作用引起的差异为\n   $$ \\delta E = \\Delta E_{\\mathrm{TDDFT}} - \\Delta E_{\\mathrm{cDFT}} = (1 - \\alpha) U_{\\mathrm{SIE}}. $$\n6. 通过余弦相似度（相关系数）来量化跃迁密度之间的一致性，\n   $$ r = \\frac{\\int \\rho_{\\mathrm{TDDFT}}(x) \\, \\delta \\rho_{\\mathrm{cDFT}}(x) \\, \\mathrm{d}x}{\\sqrt{\\int \\rho_{\\mathrm{TDDFT}}(x)^2 \\, \\mathrm{d}x} \\, \\sqrt{\\int \\delta \\rho_{\\mathrm{cDFT}}(x)^2 \\, \\mathrm{d}x}}, $$\n   该值为无量纲，且在 $ [-1,1] $ 范围内。\n\n实现要求：\n\n- 使用原子单位制。所有能量以哈特里 (Hartree) 表示，长度以玻尔 (Bohr) 表示。所有能量量以哈特里报告，相关系数以无量纲浮点数报告。将所有报告的浮点数四舍五入到六位小数。\n- 用 $ N $ 个点的均匀网格离散化区间 $ [-L/2, L/2] $，对所有积分使用与网格间距一致的数值积分。您必须选择足够大的 $ L $ 和 $ N $，以确保所提供参数的高斯函数被良好地包含在内，并且积分在数值上是稳定的。\n- 不涉及角度；您无需指定角度单位。\n- 对于每个测试用例，计算并返回一个列表 $ [r, \\Delta E_{\\mathrm{TDDFT}}, \\Delta E_{\\mathrm{cDFT}}, \\delta E] $。\n\n测试套件：\n\n使用以下测试用例，每个用例由元组 $ (R, \\sigma, \\varepsilon_{\\mathrm{D}}, \\varepsilon_{\\mathrm{A}}, \\beta, \\alpha) $ 指定：\n\n- 用例 1 (通用正常路径，局域泛函): $ (R = 6.0, \\, \\sigma = 0.8, \\, \\varepsilon_{\\mathrm{D}} = -0.300, \\, \\varepsilon_{\\mathrm{A}} = -0.100, \\, \\beta = 0.5, \\, \\alpha = 0.0) $。\n- 用例 2 (长程分离，部分精确交换): $ (R = 12.0, \\, \\sigma = 0.8, \\, \\varepsilon_{\\mathrm{D}} = -0.250, \\, \\varepsilon_{\\mathrm{A}} = -0.050, \\, \\beta = 0.5, \\, \\alpha = 0.5) $。\n- 用例 3 (短程边缘情况，局域泛函): $ (R = 2.0, \\, \\sigma = 0.8, \\, \\varepsilon_{\\mathrm{D}} = -0.350, \\, \\varepsilon_{\\mathrm{A}} = -0.200, \\, \\beta = 0.5, \\, \\alpha = 0.0) $。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表被方括号括起来，每个测试用例的结果本身也是如上所述的列表。例如，您的输出必须类似于 $ [[r_1,\\Delta E_{\\mathrm{TDDFT},1},\\Delta E_{\\mathrm{cDFT},1},\\delta E_1],[r_2,\\Delta E_{\\mathrm{TDDFT},2},\\Delta E_{\\mathrm{cDFT},2},\\delta E_2],[r_3,\\Delta E_{\\mathrm{TDDFT},3},\\Delta E_{\\mathrm{cDFT},3},\\delta E_3]] $，其中所有浮点数均四舍五入到六位小数。",
            "solution": "问题陈述已经过验证，被认为是有效的。它提出了一个在计算化学领域中科学上合理、适定且客观的问题。这是一个用于比较时间相关密度泛函理论 (TDDFT) 和约束密度泛函理论 (cDFT) 在电荷转移激发方面的简化但概念上合理的模型。所有必要的定义、参数和约束都已提供，以计算出唯一且有意义的解。\n\n解决方案首先建立一个离散的数值框架，然后按规定执行计算。\n\n**1. 数值离散化**\n\n问题定义在一维连续域 $x \\in [-L/2, L/2]$ 上。为了进行数值计算，该域被离散化为一个包含 $N$ 个点的均匀网格。网格点为 $x_i = -L/2 + i \\cdot \\Delta x$，其中 $i=0, 1, \\dots, N-1$，网格间距为 $\\Delta x = L/(N-1)$。$L$ 和 $N$ 的选择必须确保高斯基函数得到良好表示，并且数值积分收敛。\n\n高斯函数 $\\phi_{\\mathrm{D}}(x)$ 和 $\\phi_{\\mathrm{A}}(x)$ 分别以 $x_{\\mathrm{D}} = -R/2$ 和 $x_{\\mathrm{A}} = R/2$ 为中心，宽度参数为 $\\sigma$。测试用例中的最大间距为 $R=12.0$ 玻尔，$\\sigma=0.8$ 玻尔。一个高斯函数 $\\exp(-x^2/(2\\sigma^2))$ 在几个标准差之外会显著衰减。从原点算起，$\\pm(R/2 + 5\\sigma)$ 的范围是一个安全的选择。对于 $R=12.0$ 和 $\\sigma=0.8$，这对应于 $\\pm(6.0 + 4.0) = \\pm 10.0$ 玻尔。为保守起见并最小化边界效应，我们选择一个更大的域，$L=40.0$ 玻尔（即 $x \\in [-20, 20]$）。为了数值精度，需要一个精细的网格。我们选择 $N=4096$ 个点，这在准确性和计算成本之间取得了平衡。\n\n**2. 轨道和密度定义**\n\n给定每个测试用例的参数 ($R, \\sigma, \\ldots$)，我们首先在离散网格上定义给体和受体轨道：\n$$ \\phi_{\\mathrm{D}}(x_i) = \\frac{1}{\\pi^{1/4} \\sqrt{\\sigma}} \\exp\\!\\left( - \\frac{(x_i + R/2)^2}{2 \\sigma^2} \\right) $$\n$$ \\phi_{\\mathrm{A}}(x_i) = \\frac{1}{\\pi^{1/4} \\sqrt{\\sigma}} \\exp\\!\\left( - \\frac{(x_i - R/2)^2}{2 \\sigma^2} \\right) $$\n由此，我们计算相应的密度和跃迁密度：\n- 基态片段密度：$\\rho_{\\mathrm{D}}(x_i) = |\\phi_{\\mathrm{D}}(x_i)|^2$ 和 $\\rho_{\\mathrm{A}}(x_i) = |\\phi_{\\mathrm{A}}(x_i)|^2$。\n- TDDFT 跃迁密度：$\\rho_{\\mathrm{TDDFT}}(x_i) = \\phi_{\\mathrm{D}}(x_i) \\phi_{\\mathrm{A}}(x_i)$。\n- cDFT 跃迁密度：$\\delta \\rho_{\\mathrm{cDFT}}(x_i) = \\rho_{\\mathrm{A}}(x_i) - \\rho_{\\mathrm{D}}(x_i)$。\n\n**3. 数值积分**\n\n积分使用梯形法则进行数值计算，对于均匀网格，该法则近似为 $\\int f(x) \\mathrm{d}x \\approx \\sum_i f(x_i) \\Delta x$。\n\n相关系数 $r$ 需要计算三个一维积分：\n$$ r = \\frac{\\int \\rho_{\\mathrm{TDDFT}}(x) \\, \\delta \\rho_{\\mathrm{cDFT}}(x) \\, \\mathrm{d}x}{\\sqrt{\\int \\rho_{\\mathrm{TDDFT}}(x)^2 \\, \\mathrm{d}x} \\, \\sqrt{\\int \\delta \\rho_{\\mathrm{cDFT}}(x)^2 \\, \\mathrm{d}x}} $$\n在数值上，分子计算为 $\\Delta x \\sum_i \\rho_{\\mathrm{TDDFT}}(x_i) \\delta\\rho_{\\mathrm{cDFT}}(x_i)$，分母中的项也类似计算。\n\n由于模型的对称性，$\\rho_{\\mathrm{TDDFT}}(x)$ 是 $x$ 的偶函数，而 $\\delta\\rho_{\\mathrm{cDFT}}(x)$ 是奇函数。因此，它们的乘积是奇函数。奇函数在对称区间 $[-L/2, L/2]$ 上的积分恰好为零。我们的数值积分方案将反映这一点，从而得到分子以及 $r$ 的值为零（或数值上与零无法区分）。\n\n相互作用积分 $J_{\\mathrm{DA}}$ 和 $U_{\\mathrm{SIE}}$ 是二维的：\n$$ J_{\\mathrm{DA}} = \\iint \\rho_{\\mathrm{D}}(x) \\, v_{\\beta}(x - x') \\, \\rho_{\\mathrm{A}}(x') \\, \\mathrm{d}x \\, \\mathrm{d}x' $$\n$$ U_{\\mathrm{SIE}} = \\iint \\rho_{\\mathrm{TDDFT}}(x) \\, v_{\\beta}(x - x') \\, \\rho_{\\mathrm{TDDFT}}(x') \\, \\mathrm{d}x \\, \\mathrm{d}x' $$\n这些通过在二维网格 $(x_i, x_j)$ 上直接求和来计算：\n$$ J_{\\mathrm{DA}} \\approx (\\Delta x)^2 \\sum_i \\sum_j \\rho_{\\mathrm{D}}(x_i) \\frac{1}{\\sqrt{(x_i - x_j)^2 + \\beta^2}} \\rho_{\\mathrm{A}}(x_j) $$\n$$ U_{\\mathrm{SIE}} \\approx (\\Delta x)^2 \\sum_i \\sum_j \\rho_{\\mathrm{TDDFT}}(x_i) \\frac{1}{\\sqrt{(x_i - x_j)^2 + \\beta^2}} \\rho_{\\mathrm{TDDFT}}(x_j) $$\n这些 $O(N^2)$ 的求和可以使用 NumPy 的广播功能高效实现。\n\n**4. 能量计算**\n\n一旦计算出积分 $J_{\\mathrm{DA}}$ 和 $U_{\\mathrm{SIE}}$，就可以使用提供的公式确定能隙。每个用例的输入参数为 $(R, \\sigma, \\varepsilon_{\\mathrm{D}}, \\varepsilon_{\\mathrm{A}}, \\beta, \\alpha)$。\n- Kohn-Sham 能隙：$\\Delta \\varepsilon = \\varepsilon_{\\mathrm{A}} - \\varepsilon_{\\mathrm{D}}$。\n- cDFT 激发能：$\\Delta E_{\\mathrm{cDFT}} = \\Delta \\varepsilon - J_{\\mathrm{DA}}$。\n- TDDFT 激发能：$\\Delta E_{\\mathrm{TDDFT}} = \\Delta E_{\\mathrm{cDFT}} + (1 - \\alpha) U_{\\mathrm{SIE}}$。\n- 自相互作用误差差异：$\\delta E = \\Delta E_{\\mathrm{TDDFT}} - \\Delta E_{\\mathrm{cDFT}} = (1 - \\alpha) U_{\\mathrm{SIE}}$。\n\n**5. 最终结果汇总**\n\n对于每个测试用例，计算四个量 $[r, \\Delta E_{\\mathrm{TDDFT}}, \\Delta E_{\\mathrm{cDFT}}, \\delta E]$。最终的浮点数值四舍五入到六位小数，并且所有测试用例的结果被汇总到一个列表的列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes TDDFT vs. cDFT comparison metrics for a 1D donor-acceptor model.\n    \"\"\"\n    # Grid parameters\n    L = 40.0  # Bohr\n    N = 4096  # Number of grid points\n\n    # Discretize the 1D space\n    x = np.linspace(-L / 2, L / 2, N)\n    dx = L / (N - 1)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (R, sigma, eps_D, eps_A, beta, alpha)\n        (6.0, 0.8, -0.300, -0.100, 0.5, 0.0),   # Case 1\n        (12.0, 0.8, -0.250, -0.050, 0.5, 0.5),  # Case 2\n        (2.0, 0.8, -0.350, -0.200, 0.5, 0.0),   # Case 3\n    ]\n\n    all_results = []\n    for case in test_cases:\n        R, sigma, eps_D, eps_A, beta, alpha = case\n\n        # Centers of the Gaussian orbitals\n        x_D = -R / 2\n        x_A = R / 2\n\n        # Normalization factor for the orbitals\n        norm_factor = 1.0 / (np.pi**0.25 * np.sqrt(sigma))\n\n        # 1. Define orbitals and densities on the grid\n        phi_D = norm_factor * np.exp(-((x - x_D)**2) / (2 * sigma**2))\n        phi_A = norm_factor * np.exp(-((x - x_A)**2) / (2 * sigma**2))\n\n        rho_D = phi_D**2\n        rho_A = phi_A**2\n\n        rho_tddft = phi_D * phi_A\n        delta_rho_cdft = rho_A - rho_D\n\n        # 2. Compute correlation coefficient 'r'\n        # Note: Numerator integrates an odd function over a symmetric interval, so it's 0.\n        numerator_r = np.sum(rho_tddft * delta_rho_cdft) * dx\n        \n        # Denominator terms calculation\n        den_term1_sq = np.sum(rho_tddft**2) * dx\n        den_term2_sq = np.sum(delta_rho_cdft**2) * dx\n        \n        # Avoid division by zero if norms are zero, though they won't be here\n        if den_term1_sq > 1e-15 and den_term2_sq > 1e-15:\n            r = numerator_r / np.sqrt(den_term1_sq * den_term2_sq)\n        else:\n            r = 0.0\n\n        # 3. Compute interaction integrals J_DA and U_SIE\n        # Using vectorized O(N^2) summation for the double integrals.\n        # This is memory-intensive but feasible for N=4096.\n        x_diff_matrix = x[:, np.newaxis] - x[np.newaxis, :]\n        v_beta_matrix = 1.0 / np.sqrt(x_diff_matrix**2 + beta**2)\n        \n        # J_DA calculation\n        integrand_J_DA = rho_D[:, np.newaxis] * v_beta_matrix * rho_A[np.newaxis, :]\n        J_DA = np.sum(integrand_J_DA) * dx**2\n        \n        # U_SIE calculation\n        integrand_U_SIE = rho_tddft[:, np.newaxis] * v_beta_matrix * rho_tddft[np.newaxis, :]\n        U_SIE = np.sum(integrand_U_SIE) * dx**2\n\n        # 4. Compute energy gaps\n        delta_eps = eps_A - eps_D\n        delta_E_cdft = delta_eps - J_DA\n        delta_E_tddft = delta_E_cdft + (1 - alpha) * U_SIE\n        delta_E_discrepancy = delta_E_tddft - delta_E_cdft\n\n        # 5. Store results for this case, rounded to six decimal places\n        case_results = [\n            round(r, 6),\n            round(delta_E_tddft, 6),\n            round(delta_E_cdft, 6),\n            round(delta_E_discrepancy, 6),\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\n\nsolve()\n```"
        },
        {
            "introduction": "将理论付诸实践，意味着我们不仅要理解物理模型，还必须掌握其数值实现。实时演化TDDFT计算的成败，关键在于能否选择一个稳定且高效的时间步长 $\\Delta t$。本练习将引导你推导一个常用的显式时间演化算法的数值稳定性条件，并将其与体系的哈密顿量谱宽 $W$ 联系起来。这项实践将为你提供进行可靠的实时TDDFT模拟所必需的核心数值技能，确保计算过程既准确又不会因数值不稳定性而崩溃。",
            "id": "3903005",
            "problem": "在应用于催化材料的激发态含时密度泛函理论中，单粒子 Kohn–Sham 轨道根据含时 Kohn–Sham 方程进行演化，该方程在原子单位下写作 $i\\,\\partial_{t}\\,\\phi_{i}(t)=\\hat{h}_{\\mathrm{KS}}(t)\\,\\phi_{i}(t)$。考虑一个金属催化剂平板模型，其中 Kohn–Sham 哈密顿算符 $\\hat{h}_{\\mathrm{KS}}$ 在与线性响应相关的短传播窗口内可视为不含时，并假设它是一个有界自伴算符，其谱包含在 $[\\varepsilon_{\\min},\\varepsilon_{\\max}]$ 内。\n\n您将分析一个显式的、时间反演对称的、二阶精确的时间步进格式的稳定性，该格式适用于强制时间反演对称 (ETRS) 类，其构造如下：在均匀网格 $t_{n}=t_{0}+n\\,\\Delta t$ 上离散化时间，用中心有限差分 $(\\phi(t_{n+1})-\\phi(t_{n-1}))/(2\\,\\Delta t)$ 近似时间导数，并在中心时间 $t_{n}$ 处计算哈密顿算符。完全在原子单位下进行计算。\n\n从这些要素出发，仅利用线性自伴算符的基本性质以及动力学在 $\\hat{h}_{\\mathrm{KS}}$ 上增加一个恒定能量平移下的不变性，推导该显式格式线性稳定性（冯·诺伊曼意义下）的充要条件，用时间步长 $\\Delta t$ 和谱宽 $W=\\varepsilon_{\\max}-\\varepsilon_{\\min}$ 表示。然后，通过优化选择一个不影响物理可观测量值的恒定能量平移，获得最大稳定时间步长 $\\Delta t_{\\max}$ 作为 $W$ 的函数。\n\n最后，对于 $W=1.8$ Hartree 的价流形带宽，估算 $\\Delta t_{\\max}$ 的值，并以原子时间单位报告 $\\Delta t_{\\max}$ 的数值。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导含时 Kohn-Sham 方程特定数值积分格式的稳定性条件，优化此条件，并进行最终的数值计算。该问题提法恰当且科学上合理，因此我们着手求解。\n\n含时 Kohn–Sham 方程在原子单位下给出为：\n$$i\\,\\frac{\\partial}{\\partial t}\\,\\phi(t)=\\hat{h}_{\\mathrm{KS}}\\,\\phi(t)$$\n此处，$\\hat{h}_{\\mathrm{KS}}$ 是不含时的 Kohn–Sham 哈密顿算符，它是一个有界自伴算符，其本征值 $\\varepsilon$ 的谱包含在区间 $[\\varepsilon_{\\min}, \\varepsilon_{\\max}]$ 内。\n\n问题指定了一个基于均匀时间网格 $t_n = t_0 + n\\,\\Delta t$ 的时间步进格式。时间导数使用中心有限差分近似，哈密顿算符在中心时间点 $t_n$ 计算。设 $\\phi_n \\equiv \\phi(t_n)$。离散化后的方程为：\n$$i\\,\\frac{\\phi_{n+1} - \\phi_{n-1}}{2\\,\\Delta t} = \\hat{h}_{\\mathrm{KS}}\\,\\phi_n$$\n这可以重排为一个显式的三层积分格式，通常称为蛙跳法：\n$$\\phi_{n+1} = \\phi_{n-1} - 2i\\,\\Delta t\\,\\hat{h}_{\\mathrm{KS}}\\,\\phi_n$$\n\n为了分析此格式的线性稳定性（冯·诺伊曼稳定性分析），我们考虑它作用于哈密顿算符的任意本征态 $\\psi_\\varepsilon$，其中 $\\hat{h}_{\\mathrm{KS}}\\,\\psi_\\varepsilon = \\varepsilon\\,\\psi_\\varepsilon$。我们将态 $\\phi_n$ 投影到该本征态上，使得 $\\phi_n = c_n\\,\\psi_\\varepsilon$，其中 $c_n$ 是在时间 $t_n$ 的复系数。将此代入离散方程得到：\n$$c_{n+1}\\,\\psi_\\varepsilon = c_{n-1}\\,\\psi_\\varepsilon - 2i\\,\\Delta t\\,\\hat{h}_{\\mathrm{KS}}(c_n\\,\\psi_\\varepsilon)$$\n$$c_{n+1}\\,\\psi_\\varepsilon = c_{n-1}\\,\\psi_\\varepsilon - 2i\\,\\Delta t\\,\\varepsilon\\,c_n\\,\\psi_\\varepsilon$$\n除以非零的本征态 $\\psi_\\varepsilon$，我们得到关于系数 $c_n$ 的线性递推关系：\n$$c_{n+1} + (2i\\,\\varepsilon\\,\\Delta t)\\,c_n - c_{n-1} = 0$$\n我们寻找形式为 $c_n = g^n$ 的解，其中 $g$ 是复数放大因子。将此假设代入递推关系得到特征方程：\n$$g^{n+1} + (2i\\,\\varepsilon\\,\\Delta t)\\,g^n - g^{n-1} = 0$$\n$$g^2 + (2i\\,\\varepsilon\\,\\Delta t)\\,g - 1 = 0$$\n格式的稳定性要求对于任何解，放大因子的模长都不能超过 1，即 $|g| \\le 1$。如果任何模式的 $|g|1$，该模式将呈指数增长，导致数值不稳定。这个关于 $g$ 的二次方程的根由下式给出：\n$$g = \\frac{-2i\\,\\varepsilon\\,\\Delta t \\pm \\sqrt{(2i\\,\\varepsilon\\,\\Delta t)^2 - 4(1)(-1)}}{2} = -i\\,\\varepsilon\\,\\Delta t \\pm \\sqrt{1 - (\\varepsilon\\,\\Delta t)^2}$$\n根的行为取决于实数量 $(\\varepsilon\\,\\Delta t)^2$ 的值。\n\n情况1：$|\\varepsilon\\,\\Delta t| \\le 1$。\n此时，$1 - (\\varepsilon\\,\\Delta t)^2 \\ge 0$，平方根为实数。根为 $g = -i\\,\\varepsilon\\,\\Delta t \\pm \\sqrt{1 - (\\varepsilon\\,\\Delta t)^2}$。这些复数根的模长平方为：\n$$|g|^2 = (-\\varepsilon\\,\\Delta t)^2 + \\left(\\pm\\sqrt{1 - (\\varepsilon\\,\\Delta t)^2}\\right)^2 = (\\varepsilon\\,\\Delta t)^2 + 1 - (\\varepsilon\\,\\Delta t)^2 = 1$$\n因此， $|g|=1$。对于此本征模式，该格式是稳定的且保范数的，这正是模拟量子动力学所期望的行为。\n\n情况2：$|\\varepsilon\\,\\Delta t|  1$。\n此时，$1 - (\\varepsilon\\,\\Delta t)^2  0$，平方根为纯虚数。\n$$g = -i\\,\\varepsilon\\,\\Delta t \\pm i\\sqrt{(\\varepsilon\\,\\Delta t)^2 - 1}$$\n两个根为 $g_{\\pm} = -i\\left( \\varepsilon\\,\\Delta t \\mp \\sqrt{(\\varepsilon\\,\\Delta t)^2 - 1} \\right)$。其模长为 $|g_{\\pm}| = |\\varepsilon\\,\\Delta t \\mp \\sqrt{(\\varepsilon\\,\\Delta t)^2 - 1}|$。其中一个根的模长将大于 1。例如，如果 $\\varepsilon\\,\\Delta t  1$，则 $|g_{-}| = \\varepsilon\\,\\Delta t + \\sqrt{(\\varepsilon\\,\\Delta t)^2 - 1}  1$。这会导致相应模式的指数增长，从而导致数值不稳定。\n\n该格式稳定的充要条件是所有本征模式都稳定。这要求对于 $\\hat{h}_{\\mathrm{KS}}$ 谱中（位于 $[\\varepsilon_{\\min}, \\varepsilon_{\\max}]$ 内）的所有本征值 $\\varepsilon$ 都满足 $|\\varepsilon\\,\\Delta t| \\le 1$。此条件必须对模长最大的本征值成立：\n$$\\Delta t \\cdot \\max_{\\varepsilon \\in [\\varepsilon_{\\min}, \\varepsilon_{\\max}]} |\\varepsilon| \\le 1 \\implies \\Delta t \\le \\frac{1}{\\max(|\\varepsilon_{\\min}|, |\\varepsilon_{\\max}|)}$$\n为了用谱宽 $W = \\varepsilon_{\\max} - \\varepsilon_{\\min}$ 表示此条件，我们引入谱中心 $C_0 = (\\varepsilon_{\\max} + \\varepsilon_{\\min})/2$。我们可以写出 $\\varepsilon_{\\min} = C_0 - W/2$ 和 $\\varepsilon_{\\max} = C_0 + W/2$。项 $\\max(|\\varepsilon_{\\min}|, |\\varepsilon_{\\max}|)$ 变为 $\\max(|C_0 - W/2|, |C_0 + W/2|)$。由于 $W/2 \\ge 0$，这等于 $|C_0| + W/2$。因此，稳定性的充要条件是：\n$$\\Delta t \\left( \\left|\\frac{\\varepsilon_{\\max}+\\varepsilon_{\\min}}{2}\\right| + \\frac{\\varepsilon_{\\max}-\\varepsilon_{\\min}}{2} \\right) \\le 1$$\n\n接下来，我们利用所述的动力学对于恒定能量平移的不变性来优化时间步长。我们可以将哈密顿算符 $\\hat{h}_{\\mathrm{KS}}$ 替换为平移后的哈密顿算符 $\\hat{h}'_{\\mathrm{KS}} = \\hat{h}_{\\mathrm{KS}} - C\\hat{I}$（对于某个常数 $C$），而不改变物理可观测量。$\\hat{h}'_{\\mathrm{KS}}$ 的本征值为 $\\varepsilon' = \\varepsilon - C$，其谱为 $[\\varepsilon_{\\min}-C, \\varepsilon_{\\max}-C]$。使用平移后哈密顿算符的动力学的稳定性条件是：\n$$\\Delta t \\le \\frac{1}{\\max_{\\varepsilon' \\in [\\varepsilon_{\\min}-C, \\varepsilon_{\\max}-C]} |\\varepsilon'|} = \\frac{1}{\\max_{\\varepsilon \\in [\\varepsilon_{\\min}, \\varepsilon_{\\max}]} |\\varepsilon - C|}$$\n为了获得最大稳定时间步长 $\\Delta t_{\\max}$，我们必须选择平移量 $C$ 以最小化 $\\max_{\\varepsilon \\in [\\varepsilon_{\\min}, \\varepsilon_{\\max}]} |\\varepsilon - C|$。这对应于在实数轴上找到点 $C$，使其到区间 $[\\varepsilon_{\\min}, \\varepsilon_{\\max}]$ 中任意点的最大距离最小化。$C$ 的最优选择是该区间的中点：\n$$C_{\\mathrm{opt}} = \\frac{\\varepsilon_{\\min} + \\varepsilon_{\\max}}{2}$$\n通过此最优平移，新的本征值谱 $\\varepsilon'$ 以零为中心，覆盖区间：\n$$\\left[\\varepsilon_{\\min} - \\frac{\\varepsilon_{\\min} + \\varepsilon_{\\max}}{2}, \\varepsilon_{\\max} - \\frac{\\varepsilon_{\\min} + \\varepsilon_{\\max}}{2}\\right] = \\left[-\\frac{\\varepsilon_{\\max} - \\varepsilon_{\\min}}{2}, \\frac{\\varepsilon_{\\max} - \\varepsilon_{\\min}}{2}\\right] = \\left[-\\frac{W}{2}, \\frac{W}{2}\\right]$$\n对于这个平移后的谱，最大绝对本征值为 $\\max|\\varepsilon'| = W/2$。优化后的稳定性条件变为：\n$$\\Delta t \\cdot \\frac{W}{2} \\le 1$$\n这给出了最大稳定时间步长作为谱宽 $W$ 的函数：\n$$\\Delta t_{\\max} = \\frac{2}{W}$$\n\n最后，我们为给定的价流形带宽 $W=1.8$ Hartree 计算 $\\Delta t_{\\max}$ 的数值。所有量均以原子单位给出。\n$$\\Delta t_{\\max} = \\frac{2}{1.8} = \\frac{20}{18} = \\frac{10}{9}$$\n以小数表示，这是 $1.1111...$ 原子时间单位。四舍五入到四位有效数字得到 $1.111$。",
            "answer": "$$\\boxed{1.111}$$"
        }
    ]
}