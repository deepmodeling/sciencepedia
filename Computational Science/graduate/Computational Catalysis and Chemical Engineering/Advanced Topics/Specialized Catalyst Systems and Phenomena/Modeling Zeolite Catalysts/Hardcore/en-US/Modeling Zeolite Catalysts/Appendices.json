{
    "hands_on_practices": [
        {
            "introduction": "A foundational step in modeling a zeolite catalyst is to determine the distribution of its active sites. This exercise guides you through combining quantum mechanical energies from Density Functional Theory (DFT) with principles of statistical mechanics to predict the equilibrium distribution of aluminum atoms over the various possible tetrahedral sites in the framework . By mastering this, you will be able to construct a realistic, temperature-dependent model of the catalyst's resting state, which is the starting point for any subsequent study of its reactivity.",
            "id": "3890429",
            "problem": "You are modeling aluminum substitution over inequivalent tetrahedral sites in a zeolite framework using periodic Kohn-Sham Density Functional Theory (DFT). Each site type $i$ corresponds to a distinct local environment for $\\mathrm{Al}$ substitution in the framework, with $i \\in \\{1,2,\\dots,N\\}$. A single aluminum atom replaces a silicon atom at one site type $i$ per model, producing $N$ separately optimized periodic models that share identical composition and the same compensating charge arrangement (for example, a proton or extra-framework cation). After full geometry relaxation at fixed periodic boundary conditions, you obtain total electronic energies $E_i$ for each model. Let $g_i$ denote the degeneracy, defined as the count of symmetry-equivalent positions for site type $i$ in the primitive cell. Assume all $E_i$ values are computed with the same exchange-correlation functional, basis, pseudopotentials, k-point sampling, and cell size, so that differences among $E_i$ reflect only the site-dependent environment of the aluminum substitution.\n\nStarting from first principles appropriate to equilibrium statistical mechanics and the canonical ensemble, determine how the equilibrium site-type occupancy probabilities arise when the system is in thermal contact with a reservoir at temperature $T$. Base your derivation on the principle of maximum entropy for discrete states with energy levels $E_i$, discrete degeneracy $g_i$, and constraints on normalization and average energy. You must begin from well-tested foundations such as the statistical definition of entropy $S$, constraints using Lagrange multipliers, and the thermodynamic requirement that average energy remains fixed. Do not rely on any pre-stated shortcut probability formulas in the problem statement. In the presence of degeneracy, show how site-type multiplicity enters the equilibrium probabilities. Explain how to treat the periodic DFT energies so that relative site preferences are extracted on a common reference, including any constant offsets that may be removed without altering probabilities.\n\nImplement an algorithm that, given lists of $E_i$ and $g_i$, and a temperature $T$, computes the Boltzmann-weighted site-type distribution. For numerical stability, normalize the energies to a common reference by subtracting a constant offset (for example, the minimum energy) before evaluating exponentials. Use the Boltzmann constant $k_\\mathrm{B}$ expressed in electronvolts per Kelvin, $k_\\mathrm{B} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$. All energies must be treated in electronvolts ($\\mathrm{eV}$), all temperatures must be treated in Kelvin ($\\mathrm{K}$), and the final site-type probabilities must be reported as decimals (not percentages). The computed probabilities must sum to $1$ within numerical precision for each test case.\n\nPhysical and numerical units requirement: express energies in $\\mathrm{eV}$, temperature in $\\mathrm{K}$, and report each probability as a decimal. Angles are not used in this problem. Use a canonical ensemble description appropriate for fixed number of particles, volume, and temperature.\n\nTest suite and answer specification: your program must evaluate the following test cases. Each test case consists of $([E_1,E_2,\\dots,E_N], [g_1,g_2,\\dots,g_N], T)$, where $E_i$ are periodic DFT total energies for $\\mathrm{Al}$ at site type $i$ (same composition across $i$), $g_i$ are degeneracies, and $T$ is the temperature.\n\n- Case $1$ (general case, moderate temperature): $([0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}, [8, 4, 12, 6], 700\\,\\mathrm{K})$.\n- Case $2$ (near-zero temperature limit): $([0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}, [8, 4, 12, 6], 1\\,\\mathrm{K})$.\n- Case $3$ (high-temperature limit): $([0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}, [8, 4, 12, 6], 5000\\,\\mathrm{K})$.\n- Case $4$ (equal energies, degeneracy-determined distribution): $([0.00, 0.00, 0.00, 0.00]\\,\\mathrm{eV}, [2, 2, 1, 3], 300\\,\\mathrm{K})$.\n- Case $5$ (two degenerate minima, low temperature): $([0.00, 0.00, 0.05, 0.10]\\,\\mathrm{eV}, [4, 4, 2, 2], 10\\,\\mathrm{K})$.\n\nFinal output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case in order and must itself be a list of decimals giving the site-type probabilities in the same order as the input energies and degeneracies. For example, the overall output must look like $[[p_{1,1},p_{1,2},\\dots],[p_{2,1},p_{2,2},\\dots],\\dots]$, printed on a single line. Round each decimal to $6$ places in the final printed output.",
            "solution": "The problem asks for a derivation of the equilibrium site-type occupancy probabilities for aluminum substitution in a zeolite framework, starting from the principle of maximum entropy in the canonical ensemble. Subsequently, an algorithm must be implemented to compute these probabilities for given sets of site energies $E_i$, degeneracies $g_i$, and temperature $T$.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Site types: $i \\in \\{1, 2, \\dots, N\\}$.\n-   Total electronic energy for a model with Al at site type $i$: $E_i$.\n-   Degeneracy (count of symmetry-equivalent positions) for site type $i$: $g_i$.\n-   System is in thermal contact with a reservoir at temperature $T$.\n-   The derivation must be based on the principle of maximum entropy for discrete states with energies $E_i$ and degeneracies $g_i$.\n-   Constraints: Normalization and fixed average energy.\n-   Method: Lagrange multipliers.\n-   Energies $E_i$ are given in electronvolts ($\\mathrm{eV}$).\n-   Temperature $T$ is given in Kelvin ($\\mathrm{K}$).\n-   Boltzmann constant: $k_\\mathrm{B} = 8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$.\n-   Test Cases:\n    1.  $E = [0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}$, $g = [8, 4, 12, 6]$, $T = 700\\,\\mathrm{K}$.\n    2.  $E = [0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}$, $g = [8, 4, 12, 6]$, $T = 1\\,\\mathrm{K}$.\n    3.  $E = [0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}$, $g = [8, 4, 12, 6]$, $T = 5000\\,\\mathrm{K}$.\n    4.  $E = [0.00, 0.00, 0.00, 0.00]\\,\\mathrm{eV}$, $g = [2, 2, 1, 3]$, $T = 300\\,\\mathrm{K}$.\n    5.  $E = [0.00, 0.00, 0.05, 0.10]\\,\\mathrm{eV}$, $g = [4, 4, 2, 2]$, $T = 10\\,\\mathrm{K}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It poses a standard, solvable problem in statistical mechanics and its application to computational materials science.\n-   **Scientific Grounding**: The use of DFT-calculated energies within a statistical mechanics framework (specifically, the canonical ensemble and Boltzmann statistics) to predict site occupancies is a well-established and valid a pproach in computational catalysis and materials science. The derivation requested is a fundamental exercise in statistical mechanics.\n-   **Well-Posedness**: The problem is clearly defined with all necessary inputs ($E_i$, $g_i$, $T$) and a well-defined output (probabilities $p_i$). A unique, stable solution exists and is derivable from the given principles.\n-   **Objectivity**: The problem is stated using precise, formal language and is free from subjective or ambiguous terminology.\n-   The problem does not violate any of the invalidity criteria. The data is consistent, the scenario is physically plausible, and the task is a formal derivation and implementation, not a subjective or trivial question.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\n### Derivation from First Principles\n\nWe model the system as a single aluminum atom able to occupy any of the available tetrahedral sites in the zeolite framework. The fundamental states of the system, or microstates, correspond to the Al atom occupying one specific crystallographic position. There are $N$ distinct types of sites, with the $i$-th type having $g_i$ equivalent positions (degeneracy) and an associated energy $E_i$.\n\nLet $P_j$ be the probability of the system being in a specific microstate $j$. The statistical definition of entropy (Gibbs entropy) is:\n$$ S = -k_\\mathrm{B} \\sum_j P_j \\ln P_j $$\nwhere the sum is over all accessible microstates.\n\nThe equilibrium distribution is the one that maximizes $S$ subject to the physical constraints of the system. In the canonical ensemble (fixed particle number, volume, and temperature), these constraints are:\n1.  **Normalization**: The probabilities must sum to unity.\n    $$ \\sum_j P_j = 1 $$\n2.  **Average Energy**: The average energy of the system is fixed at a value $U$. Let $E(j)$ be the energy of microstate $j$.\n    $$ \\langle E \\rangle = \\sum_j P_j E(j) = U $$\n\nWe use the method of Lagrange multipliers to find the distribution $\\{P_j\\}$ that maximizes $S$. We construct the Lagrangian function $\\mathcal{L}$, conventionally maximizing $S/k_\\mathrm{B}$ for simplicity:\n$$ \\mathcal{L}(\\{P_j\\}, \\alpha, \\beta) = \\frac{S}{k_\\mathrm{B}} - \\alpha \\left( \\sum_j P_j - 1 \\right) - \\beta \\left( \\sum_j P_j E(j) - U \\right) $$\n$$ \\mathcal{L} = -\\sum_j P_j \\ln P_j - \\alpha \\left( \\sum_j P_j - 1 \\right) - \\beta \\left( \\sum_j P_j E(j) - U \\right) $$\nTo find the maximum, we set the partial derivative of $\\mathcal{L}$ with respect to an arbitrary probability $P_k$ to zero:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial P_k} = -(\\ln P_k + P_k \\cdot \\frac{1}{P_k}) - \\alpha - \\beta E(k) = 0 $$\n$$ -\\ln P_k - 1 - \\alpha - \\beta E(k) = 0 $$\n$$ \\ln P_k = -(1+\\alpha) - \\beta E(k) $$\nThis gives the form of the probability for microstate $k$:\n$$ P_k = e^{-(1+\\alpha)} e^{-\\beta E(k)} $$\nThe term $e^{-(1+\\alpha)}$ is a normalization constant. We find its value by applying the normalization constraint:\n$$ \\sum_k P_k = \\sum_k e^{-(1+\\alpha)} e^{-\\beta E(k)} = e^{-(1+\\alpha)} \\sum_k e^{-\\beta E(k)} = 1 $$\n$$ e^{-(1+\\alpha)} = \\frac{1}{\\sum_k e^{-\\beta E(k)}} $$\nThe denominator is the canonical partition function, $Z = \\sum_k e^{-\\beta E(k)}$. Thus, the probability of finding the system in a specific microstate $k$ is:\n$$ P_k = \\frac{e^{-\\beta E(k)}}{Z} $$\nFrom the principles of thermodynamics, the Lagrange multiplier $\\beta$ is identified with the inverse temperature, $\\beta = 1/(k_\\mathrm{B} T)$.\n\nThe problem asks for the probability $p_i$ of finding the aluminum atom in any site of *type* $i$. This is obtained by summing the probabilities $P_k$ of all microstates $k$ that belong to site type $i$. There are $g_i$ such microstates, and they all share the same energy $E_i$.\n$$ p_i = \\sum_{k \\in \\text{type } i} P_k = \\sum_{k \\in \\text{type } i} \\frac{e^{-\\beta E_i}}{Z} $$\nSince the energy $E_i$ is constant for all $g_i$ sites of type $i$, the sum becomes:\n$$ p_i = g_i \\frac{e^{-\\beta E_i}}{Z} $$\nThe partition function $Z$ is the sum over all microstates. We can group the microstates by site type:\n$$ Z = \\sum_{j=1}^N \\sum_{k \\in \\text{type } j} e^{-\\beta E_j} = \\sum_{j=1}^N g_j e^{-\\beta E_j} $$\nSubstituting this expression for $Z$ gives the final formula for the site-type occupancy probability:\n$$ p_i = \\frac{g_i e^{-E_i / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-E_j / (k_\\mathrm{B} T)}} $$\nThis is the Boltzmann distribution for a system with discrete, degenerate energy levels.\n\n### Energy Referencing and Numerical Stability\n\nPeriodic DFT calculations yield large, negative total electronic energies. Directly computing $e^{-E_i / (k_\\mathrm{B} T)}$ can lead to numerical underflow if $E_i$ is a large positive number (relative to other sites) or overflow if it is very negative. However, the probabilities $p_i$ depend only on energy *differences*. We can prove this by shifting all energies by a constant offset $E_0$:\n$$ p_i = \\frac{g_i e^{-(E_i - E_0 + E_0) / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-(E_j - E_0 + E_0) / (k_\\mathrm{B} T)}} = \\frac{g_i e^{-(E_i - E_0) / (k_\\mathrm{B} T)} e^{-E_0 / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-(E_j - E_0) / (k_\\mathrm{B} T)} e^{-E_0 / (k_\\mathrm{B} T)}} $$\nThe term $e^{-E_0 / (k_\\mathrm{B} T)}$ is a common factor in the numerator and denominator and thus cancels:\n$$ p_i = \\frac{g_i e^{-(E_i - E_0) / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-(E_j - E_0) / (k_\\mathrm{B} T)}} $$\nFor numerical stability, it is conventional to choose $E_0 = E_{\\text{min}} = \\min_j(E_j)$. This sets the lowest relative energy to $0$ and all other relative energies to positive values, ensuring the largest exponential term is $e^0 = 1$ and preventing underflow for the most probable state(s).\n\n### Algorithm Design for Implementation\n\n1.  **Input**: A list of energies $E = [E_1, E_2, \\dots, E_N]$, a list of degeneracies $g = [g_1, g_2, \\dots, g_N]$, and a temperature $T$. The constant $k_\\mathrm{B}$ is also known.\n2.  **Energy Normalization**: Compute the minimum energy $E_{\\text{min}} = \\min(E)$. Calculate the relative energies $\\Delta E_i = E_i - E_{\\text{min}}$ for all $i$.\n3.  **Compute Boltzmann Weights**: For each site type $i$, calculate its statistical weight $w_i$. This is the product of the degeneracy and the Boltzmann factor. Let $\\beta = 1/(k_\\mathrm{B} T)$.\n    $$ w_i = g_i e^{-\\beta \\Delta E_i} $$\n4.  **Compute Partition Function**: Sum the weights to get the partition function $Z$.\n    $$ Z = \\sum_{i=1}^N w_i $$\n5.  **Compute Probabilities**: Normalize the individual weights by the partition function to obtain the probabilities.\n    $$ p_i = \\frac{w_i}{Z} $$\n6.  **Output**: Return the list of probabilities $[p_1, p_2, \\dots, p_N]$.\n\nThis algorithm will be applied to each test case provided in the problem statement. The use of NumPy arrays for these calculations will be efficient.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes site-type occupancy probabilities based on Boltzmann statistics\n    for a series of test cases.\n    \"\"\"\n    \n    # Constants\n    # Boltzmann constant in eV/K\n    KB = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general case, moderate temperature\n        ([0.12, 0.00, 0.08, 0.20], [8, 4, 12, 6], 700.0),\n        # Case 2: near-zero temperature limit\n        ([0.12, 0.00, 0.08, 0.20], [8, 4, 12, 6], 1.0),\n        # Case 3: high-temperature limit\n        ([0.12, 0.00, 0.08, 0.20], [8, 4, 12, 6], 5000.0),\n        # Case 4: equal energies, degeneracy-determined distribution\n        ([0.00, 0.00, 0.00, 0.00], [2, 2, 1, 3], 300.0),\n        # Case 5: two degenerate minima, low temperature\n        ([0.00, 0.00, 0.05, 0.10], [4, 4, 2, 2], 10.0),\n    ]\n\n    def calculate_probabilities(energies, degeneracies, temperature, k_b):\n        \"\"\"\n        Calculates the Boltzmann-weighted site-type distribution.\n\n        Args:\n            energies (list or np.ndarray): List of DFT total energies in eV.\n            degeneracies (list or np.ndarray): List of site degeneracies.\n            temperature (float): Temperature in K.\n            k_b (float): Boltzmann constant in eV/K.\n\n        Returns:\n            list: A list of site-type probabilities.\n        \"\"\"\n        energies_arr = np.array(energies, dtype=np.float64)\n        degeneracies_arr = np.array(degeneracies, dtype=np.float64)\n\n        # For numerical stability, normalize energies by subtracting the minimum energy.\n        # This makes all relative energies >= 0 and avoids underflow/overflow issues.\n        min_energy = np.min(energies_arr)\n        relative_energies = energies_arr - min_energy\n\n        # Calculate thermal energy\n        k_b_t = k_b * temperature\n        \n        # Handle the T -> 0 limit gracefully, though T=1K is used in test case.\n        # If k_b_t is extremely small or zero, only the ground state(s) are populated.\n        if np.isclose(k_b_t, 0.0):\n            # Find indices of minimum energy states\n            ground_state_indices = np.where(np.isclose(relative_energies, 0.0))[0]\n            \n            # Sum of degeneracies for ground states\n            total_ground_degeneracy = np.sum(degeneracies_arr[ground_state_indices])\n            \n            probabilities = np.zeros_like(energies_arr)\n            if total_ground_degeneracy > 0:\n                probabilities[ground_state_indices] = degeneracies_arr[ground_state_indices] / total_ground_degeneracy\n            \n            return probabilities.tolist()\n\n        # Calculate Boltzmann weights: g_i * exp(-E_i / k_B T)\n        # Using relative energies for numerical stability.\n        boltzmann_weights = degeneracies_arr * np.exp(-relative_energies / k_b_t)\n        \n        # The sum of weights is the partition function Z\n        partition_function = np.sum(boltzmann_weights)\n\n        # Probabilities are the individual weights divided by the partition function\n        if partition_function == 0.0:\n            # This can happen if all weights underflow to zero at extremely low T.\n            # In this case, apply the zero-temperature logic.\n            ground_state_indices = np.where(np.isclose(relative_energies, 0.0))[0]\n            total_ground_degeneracy = np.sum(degeneracies_arr[ground_state_indices])\n            probabilities = np.zeros_like(energies_arr)\n            if total_ground_degeneracy > 0:\n                probabilities[ground_state_indices] = degeneracies_arr[ground_state_indices] / total_ground_degeneracy\n        else:\n            probabilities = boltzmann_weights / partition_function\n\n        return probabilities.tolist()\n\n    all_results = []\n    for case in test_cases:\n        energies, degeneracies, temp = case\n        result_probabilities = calculate_probabilities(energies, degeneracies, temp, KB)\n        all_results.append(result_probabilities)\n    \n    # Format the final output string as specified: [[p1,p2,...],[p1,p2,...],...]\n    # Each probability is rounded to 6 decimal places.\n    inner_lists_str = []\n    for res_list in all_results:\n        formatted_nums = [f'{p:.6f}' for p in res_list]\n        inner_lists_str.append(f\"[{','.join(formatted_nums)}]\")\n    \n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Once the likely locations of active sites are known, the next crucial step is to understand how the local structure affects catalytic properties. This practice demonstrates how to build a quantitative structure-property relationship by using linear regression to connect geometric and chemical descriptors of a Brønsted acid site to its deprotonation energy (DPE), a key indicator of acid strength . This approach allows you to move beyond single-point calculations and develop predictive models for screening catalyst variants or understanding reactivity trends.",
            "id": "3890428",
            "problem": "You are modeling how framework aluminum siting in a zeolite influences the deprotonation energy (DPE) of a Brønsted acid site. A Brønsted acid site in a zeolite corresponds to a tetrahedral site where silicon is substituted by aluminum and a charge-compensating proton is bound to a neighboring oxygen. The deprotonation energy (DPE) is the energy required to remove the proton to infinity. In this problem, you will quantify the effect of aluminum siting descriptors on DPE by fitting an affine model using ordinary least squares and then using it to predict new cases.\n\nYou must start from the following fundamental bases:\n- Charge localization and local structure control the stability of the conjugate base; therefore, the deprotonation energy depends on local structural descriptors such as ring sizes and the presence of charge-bearing aluminum in the next-nearest neighbor shell. This is a well-tested concept in computational catalysis for zeolites.\n- In linear response modeling, an observable can be approximated as an affine function of a set of descriptors. You will assume an affine dependence of DPE on structural descriptors and determine the coefficients by minimizing the sum of squared residuals (ordinary least squares).\n- The least squares estimator minimizes the sum of squared differences between observed and predicted values over the training dataset.\n\nDefinitions and variables:\n- Deprotonation energy (DPE) is denoted by $y$ and must be expressed in kilojoules per mole (kJ/mol).\n- Each tetrahedral framework site (T-site) $i$ is represented by a descriptor vector $\\mathbf{x}_i \\in \\mathbb{R}^p$ containing:\n  - $r4$: membership indicator in a $4$-member ring (value in $\\{0,1\\}$).\n  - $r5$: membership indicator in a $5$-member ring (value in $\\{0,1\\}$).\n  - $r6$: membership indicator in a $6$-member ring (value in $\\{0,1\\}$).\n  - $r10$: membership indicator in a $10$-member ring (value in $\\{0,1\\}$).\n  - $n_{\\mathrm{NNN}}$: integer count of framework aluminum atoms in the next-nearest neighbor (second shell) around the site (value in $\\{0,1,2,3\\}$ here).\n  - $d_{\\min}$: minimum T–T distance to any next-nearest aluminum, in angstroms ($\\AA$). Distances must be entered as real numbers with units $\\AA$, but the program should treat them numerically without units.\n- Your model must include an intercept, so the affine model is $y = \\beta_0 + \\sum_{j=1}^p \\beta_j x_j + \\varepsilon$, where $\\varepsilon$ is the residual.\n\nTraining dataset:\nYou are given $N = 12$ labeled T-sites with descriptor vectors $\\mathbf{x}_i$ and corresponding DPE values $y_i$ (in kJ/mol). The descriptors are ordered as $[r4, r5, r6, r10, n_{\\mathrm{NNN}}, d_{\\min}]$.\n\n- Site $1$: $\\mathbf{x}_1 = [1, 0, 0, 0, 0, 8.0]$, $y_1 = 1356.0$.\n- Site $2$: $\\mathbf{x}_2 = [0, 1, 0, 0, 1, 7.5]$, $y_2 = 1320.0$.\n- Site $3$: $\\mathbf{x}_3 = [0, 0, 1, 0, 0, 7.0]$, $y_3 = 1320.7$.\n- Site $4$: $\\mathbf{x}_4 = [0, 0, 0, 1, 2, 7.8]$, $y_4 = 1275.2$.\n- Site $5$: $\\mathbf{x}_5 = [1, 1, 0, 0, 1, 6.8]$, $y_5 = 1351.0$.\n- Site $6$: $\\mathbf{x}_6 = [0, 1, 1, 0, 0, 8.2]$, $y_6 = 1341.3$.\n- Site $7$: $\\mathbf{x}_7 = [1, 0, 1, 0, 2, 7.2]$, $y_7 = 1331.8$.\n- Site $8$: $\\mathbf{x}_8 = [0, 0, 1, 1, 1, 8.8]$, $y_8 = 1297.6$.\n- Site $9$: $\\mathbf{x}_9 = [0, 0, 0, 0, 0, 9.0]$, $y_9 = 1324.6$.\n- Site $10$: $\\mathbf{x}_{10} = [0, 1, 0, 1, 3, 6.6]$, $y_{10} = 1272.1$.\n- Site $11$: $\\mathbf{x}_{11} = [1, 0, 0, 1, 1, 7.6]$, $y_{11} = 1320.7$.\n- Site $12$: $\\mathbf{x}_{12} = [0, 1, 0, 0, 2, 6.9]$, $y_{12} = 1306.0$.\n\nYour tasks:\n1. Fit an affine model $y = \\beta_0 + \\sum_{j=1}^p \\beta_j x_j$ to the training data by minimizing the sum of squared residuals.\n2. Use the fitted model to predict DPE values for the following four test T-sites, each given as a descriptor vector in the same order:\n   - Test A: $\\mathbf{x}_A = [1, 0, 0, 0, 2, 7.0]$.\n   - Test B: $\\mathbf{x}_B = [0, 1, 0, 1, 0, 8.5]$.\n   - Test C: $\\mathbf{x}_C = [0, 0, 1, 0, 1, 6.7]$.\n   - Test D: $\\mathbf{x}_D = [1, 1, 0, 0, 3, 6.6]$.\n3. Evaluate the effect of aluminum siting by reporting the signs of the estimated coefficients corresponding to $n_{\\mathrm{NNN}}$ and $d_{\\min}$, and the coefficient of $r4$. Specifically, produce boolean values for:\n   - Is the coefficient of $n_{\\mathrm{NNN}}$ negative?\n   - Is the coefficient of $r4$ positive?\n   - Is the coefficient of $d_{\\min}$ positive?\n\nNumerical and unit requirements:\n- All predicted DPE values must be expressed in kilojoules per mole (kJ/mol).\n- Round each predicted DPE to three decimal places.\n- Angles are not used; distances $d_{\\min}$ are in angstroms, but you should output only energies in kJ/mol.\n\nTest suite and final output specification:\n- Your program must compute and output, in order, the four predicted DPE values for Test A, Test B, Test C, and Test D, followed by the three boolean answers for the coefficient-sign questions.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces. The first four entries must be floats with three decimal places, and the last three entries must be boolean values. For example: $[\\text{val}_A,\\text{val}_B,\\text{val}_C,\\text{val}_D,\\text{bool}_1,\\text{bool}_2,\\text{bool}_3]$.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of computational catalysis and heterogeneous catalysis, where structure-property relationships are commonly established using linear models. The problem is well-posed, providing a complete dataset for an ordinary least squares (OLS) regression, a standard and solvable statistical method. The definitions are objective and the data is self-consistent and sufficient to proceed.\n\nThe task is to fit an affine model to a given dataset and use it for prediction. The model describes the deprotonation energy (DPE), $y$, as a linear function of $p=6$ structural descriptors, $\\mathbf{x} = [x_1, \\dots, x_p]^T$, plus an intercept term. The model equation is:\n$$y = \\beta_0 + \\sum_{j=1}^{p} \\beta_j x_j + \\varepsilon$$\nwhere $\\beta_0$ is the intercept, $\\{\\beta_j\\}_{j=1}^p$ are the model coefficients, and $\\varepsilon$ represents the residual error. The descriptors are $x_1=r4$, $x_2=r5$, $x_3=r6$, $x_4=r10$, $x_5=n_{\\mathrm{NNN}}$, and $x_6=d_{\\min}$.\n\nFor a training set of $N=12$ observations, this relationship can be expressed in matrix form as:\n$$\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}$$\nHere, $\\mathbf{y}$ is an $N \\times 1$ vector of the observed DPE values. $\\boldsymbol{\\beta}$ is a $(p+1) \\times 1$ vector of the coefficients to be determined: $\\boldsymbol{\\beta} = [\\beta_0, \\beta_1, \\dots, \\beta_p]^T$. $\\mathbf{X}$ is the $N \\times (p+1)$ design matrix, constructed by augmenting the $N \\times p$ matrix of descriptor data with a leading column of ones to account for the intercept $\\beta_0$.\n\nThe ordinary least squares (OLS) method finds the coefficient vector $\\hat{\\boldsymbol{\\beta}}$ that minimizes the sum of squared residuals, $S(\\boldsymbol{\\beta}) = \\sum_{i=1}^N \\varepsilon_i^2 = \\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|_2^2$. The solution to this minimization problem is found by solving the normal equations:\n$$(\\mathbf{X}^T\\mathbf{X})\\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T\\mathbf{y}$$\nThe OLS estimator for the coefficients is therefore:\n$$\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$$\nFor superior numerical stability, we will solve this system using a method based on QR decomposition, as is standard practice and implemented in libraries such as NumPy, rather than by explicitly computing the matrix inverse.\n\nThe first step is to construct the design matrix $\\mathbf{X}$ and the observation vector $\\mathbf{y}$ from the provided training data.\nThe vector of observations is:\n$$\\mathbf{y} = [1356.0, 1320.0, 1320.7, 1275.2, 1351.0, 1341.3, 1331.8, 1297.6, 1324.6, 1272.1, 1320.7, 1306.0]^T$$\nThe $12 \\times 7$ design matrix $\\mathbf{X}$ is:\n$$\n\\mathbf{X} =\n\\begin{pmatrix}\n1 & 1 & 0 & 0 & 0 & 0 & 8.0 \\\\\n1 & 0 & 1 & 0 & 0 & 1 & 7.5 \\\\\n1 & 0 & 0 & 1 & 0 & 0 & 7.0 \\\\\n1 & 0 & 0 & 0 & 1 & 2 & 7.8 \\\\\n1 & 1 & 1 & 0 & 0 & 1 & 6.8 \\\\\n1 & 0 & 1 & 1 & 0 & 0 & 8.2 \\\\\n1 & 1 & 0 & 1 & 0 & 2 & 7.2 \\\\\n1 & 0 & 0 & 1 & 1 & 1 & 8.8 \\\\\n1 & 0 & 0 & 0 & 0 & 0 & 9.0 \\\\\n1 & 0 & 1 & 0 & 1 & 3 & 6.6 \\\\\n1 & 1 & 0 & 0 & 1 & 1 & 7.6 \\\\\n1 & 0 & 1 & 0 & 0 & 2 & 6.9\n\\end{pmatrix}\n$$\nSolving the linear least squares problem for $\\hat{\\boldsymbol{\\beta}}$ yields the estimated coefficient vector:\n$$\\hat{\\boldsymbol{\\beta}} = [\\hat{\\beta}_0, \\hat{\\beta}_{r4}, \\hat{\\beta}_{r5}, \\hat{\\beta}_{r6}, \\hat{\\beta}_{r10}, \\hat{\\beta}_{n_{\\mathrm{NNN}}}, \\hat{\\beta}_{d_{\\min}}]^T$$\n\nOnce $\\hat{\\boldsymbol{\\beta}}$ is determined, we can predict the DPE for the four test sites. For each test descriptor vector $\\mathbf{x}_{\\text{test}}$, the predicted DPE, $y_{\\text{pred}}$, is calculated as:\n$$y_{\\text{pred}} = \\hat{\\beta}_0 + \\hat{\\beta}_{r4} x_{r4} + \\hat{\\beta}_{r5} x_{r5} + \\hat{\\beta}_{r6} x_{r6} + \\hat{\\beta}_{r10} x_{r10} + \\hat{\\beta}_{n_{\\mathrm{NNN}}} x_{n_{\\mathrm{NNN}}} + \\hat{\\beta}_{d_{\\min}} x_{d_{\\min}}$$\nThis is performed for each of the four test vectors, and the results are rounded to three decimal places.\n\nThe final task is to evaluate the signs of specific coefficients from the fitted model $\\hat{\\boldsymbol{\\beta}}$:\n1.  The sign of $\\hat{\\beta}_{n_{\\mathrm{NNN}}}$, the coefficient for the number of next-nearest neighbor aluminum atoms.\n2.  The sign of $\\hat{\\beta}_{r4}$, the coefficient for membership in a $4$-member ring.\n3.  The sign of $\\hat{\\beta}_{d_{\\min}}$, the coefficient for the minimum T-T distance to a next-nearest aluminum.\n\nThese checks are performed by direct inspection of the elements of the calculated $\\hat{\\boldsymbol{\\beta}}$ vector. The resulting four predicted DPE values and three boolean values are then formatted into the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits an affine model using ordinary least squares to predict deprotonation energy (DPE)\n    of Brønsted acid sites in a zeolite based on structural descriptors.\n    \"\"\"\n    # Define the training dataset from the problem statement.\n    # Descriptors are ordered as [r4, r5, r6, r10, n_NNN, d_min].\n    training_data = [\n        ([1, 0, 0, 0, 0, 8.0], 1356.0),\n        ([0, 1, 0, 0, 1, 7.5], 1320.0),\n        ([0, 0, 1, 0, 0, 7.0], 1320.7),\n        ([0, 0, 0, 1, 2, 7.8], 1275.2),\n        ([1, 1, 0, 0, 1, 6.8], 1351.0),\n        ([0, 1, 1, 0, 0, 8.2], 1341.3),\n        ([1, 0, 1, 0, 2, 7.2], 1331.8),\n        ([0, 0, 1, 1, 1, 8.8], 1297.6),\n        ([0, 0, 0, 0, 0, 9.0], 1324.6),\n        ([0, 1, 0, 1, 3, 6.6], 1272.1),\n        ([1, 0, 0, 1, 1, 7.6], 1320.7),\n        ([0, 1, 0, 0, 2, 6.9], 1306.0),\n    ]\n\n    # Unpack training data into descriptor matrix and DPE vector\n    X_train_data = np.array([item[0] for item in training_data])\n    y_train = np.array([item[1] for item in training_data])\n\n    # Construct the design matrix by adding a column of ones for the intercept\n    num_observations = X_train_data.shape[0]\n    X_train = np.hstack([np.ones((num_observations, 1)), X_train_data])\n\n    # Task 1: Fit the affine model using Ordinary Least Squares.\n    # np.linalg.lstsq provides a numerically stable solution to the normal equations.\n    # It returns the coefficient vector that minimizes the sum of squared residuals.\n    # The returned vector coeffs contains [beta_0, beta_r4, beta_r5, ...].\n    coeffs, _, _, _ = np.linalg.lstsq(X_train, y_train, rcond=None)\n\n    # Define the test cases for prediction.\n    test_cases = [\n        [1, 0, 0, 0, 2, 7.0],  # Test A\n        [0, 1, 0, 1, 0, 8.5],  # Test B\n        [0, 0, 1, 0, 1, 6.7],  # Test C\n        [1, 1, 0, 0, 3, 6.6],  # Test D\n    ]\n    \n    # Construct the design matrix for the test cases\n    X_test_data = np.array(test_cases)\n    X_test = np.hstack([np.ones((X_test_data.shape[0], 1)), X_test_data])\n\n    # Task 2: Use the fitted model to predict DPE values for test sites.\n    # y_pred = X_test @ coeffs\n    predicted_dpes = X_test.dot(coeffs)\n\n    # Round each predicted DPE to three decimal places.\n    rounded_dpes = [round(val, 3) for val in predicted_dpes]\n\n    # Task 3: Evaluate the signs of specific estimated coefficients.\n    # The descriptor order is [r4, r5, r6, r10, n_NNN, d_min].\n    # coeffs[0] is the intercept.\n    # coeffs[1] is for r4.\n    # coeffs[5] is for n_NNN.\n    # coeffs[6] is for d_min.\n    \n    # Is the coefficient of n_NNN negative?\n    is_n_nnn_coeff_negative = coeffs[5] < 0\n    # Is the coefficient of r4 positive?\n    is_r4_coeff_positive = coeffs[1] > 0\n    # Is the coefficient of d_min positive?\n    is_d_min_coeff_positive = coeffs[6] > 0\n\n    # Assemble the final results list\n    all_results = rounded_dpes + [is_n_nnn_coeff_negative, is_r4_coeff_positive, is_d_min_coeff_positive]\n\n    # Format the final output string as per the specification.\n    # Example: [val_A,val_B,val_C,val_D,bool_1,bool_2,bool_3] with no spaces.\n    # Python's bool __str__ method returns 'True' or 'False', which need to be lowercased.\n    output_str = f\"[{','.join(str(r) for r in all_results)}]\"\n    final_output = output_str.replace(\"True\", \"true\").replace(\"False\", \"false\")\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Catalysis rarely occurs in a vacuum; the presence of solvent or co-adsorbed molecules can significantly alter a catalyst's behavior. This hands-on problem explores how to quantify the influence of a co-adsorbed base molecule on the effective acidity of a zeolite's Brønsted site by calculating the change in its deprotonation energy ($\\Delta \\mathrm{DPE}$) . You will construct a complete thermodynamic cycle, incorporating both electronic energies and vibrational free energy corrections, to understand how solvation and hydrogen bonding modulate the intrinsic acid strength of the catalyst.",
            "id": "3890458",
            "problem": "You are modeling Brønsted acidity in aluminosilicate zeolites under co-adsorption. The objective is to determine how a hydrogen-bonded base molecule alters the effective acid strength by computing the change in Deprotonation Energy (DPE) in the presence of co-adsorbed species. The Deprotonation Energy (DPE) is the molar Gibbs free energy change for proton transfer from a zeolite hydroxyl group to a base molecule. The fundamental base for this problem is equilibrium thermodynamics, where the molar Gibbs free energy change of a reaction is defined by state functions and can be assembled from molecular contributions including the electronic energy and the vibrational Helmholtz free energy within the harmonic approximation. The co-adsorption effect is captured by comparing the proton transfer free energy for the hydrogen-bonded complex against the corresponding value in the absence of hydrogen bonding (vacuum-deprotonation reaction with isolated species).\n\nYou must compute the change in Deprotonation Energy, denoted as $\\Delta \\mathrm{DPE}$, as the difference between the in-pore complex proton transfer free energy and the vacuum reference proton transfer free energy. All free energies are to be evaluated at a specified absolute temperature using the harmonic oscillator model for vibrational contributions. Assume the following modeling approximations: adsorbed species (zeolite and complexes) contribute vibrational Helmholtz free energy only; translational and rotational contributions are neglected for all species in this assignment to ensure uniform treatment and to isolate vibrational and electronic effects. Use electronic energies provided for each state and add the vibrational Helmholtz free energy computed from the supplied wavenumber lists. The final results must be expressed in $\\mathrm{kJ/mol}$ and rounded to three decimal places.\n\nThermodynamic states to consider:\n- Protonated zeolite framework and isolated base: $\\mathrm{Z\\!-\\!H}$ and $\\mathrm{B}$.\n- Deprotonated framework and protonated base: $\\mathrm{Z^-}$ and $\\mathrm{BH^+}$.\n- Hydrogen-bonded reactant complex: $\\mathrm{Z\\!-\\!H\\cdots B}$.\n- Contact ion-pair product complex: $\\mathrm{Z^-\\cdots BH^+}$.\n\nFor each test case below, you are given:\n- Absolute temperature $T$ in $\\mathrm{K}$.\n- Electronic energies $E_{\\mathrm{elec}}$ for the six states in $\\mathrm{kJ/mol}$.\n- Lists of vibrational wavenumbers (in $\\mathrm{cm^{-1}}$) for the six states.\n\nCompute, for each test case, the quantity $\\Delta \\mathrm{DPE}$ in $\\mathrm{kJ/mol}$, rounded to three decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n\nTest Suite:\n- Case $1$ (ammonia co-adsorption, moderate product stabilization):\n  - $T = 298.15$ $\\mathrm{K}$.\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{B}) = -5000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -40000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -105500.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -104600.0$ $\\mathrm{kJ/mol}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{B}) = [\\,$ $3400$, $3300$, $3200$, $1600$, $1100$, $950$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3200$, $3100$, $3000$, $1500$, $1100$, $900$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $350$, $300$, $200$, $150$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $350$, $250$ $\\,]$ $\\mathrm{cm^{-1}}$.\n\n- Case $2$ (water co-adsorption, reactant complex stabilized more than product):\n  - $T = 298.15$ $\\mathrm{K}$.\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{B}) = -3000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -38000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -103200.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -101900.0$ $\\mathrm{kJ/mol}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{B}) = [\\,$ $3755$, $3657$, $1595$, $1200$, $800$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3550$, $3400$, $1690$, $1100$, $900$, $700$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $320$, $280$, $220$, $180$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3300$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $460$, $420$, $380$, $300$, $200$ $\\,]$ $\\mathrm{cm^{-1}}$.\n\n- Case $3$ (methylamine co-adsorption, balanced stabilization):\n  - $T = 298.15$ $\\mathrm{K}$.\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{B}) = -4500.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -39500.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -104700.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -103500.0$ $\\mathrm{kJ/mol}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{B}) = [\\,$ $3400$, $3300$, $3000$, $1600$, $1450$, $1100$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $950$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $300$, $250$, $200$, $100$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $350$, $250$, $120$ $\\,]$ $\\mathrm{cm^{-1}}$.\n\n- Case $4$ (pyridine co-adsorption, strong product stabilization, higher temperature):\n  - $T = 500.0$ $\\mathrm{K}$.\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{B}) = -8000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -42000.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -108100.0$ $\\mathrm{kJ/mol}$, $E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -106900.0$ $\\mathrm{kJ/mol}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{B}) = [\\,$ $3100$, $1600$, $1500$, $1200$, $1000$, $800$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3200$, $1600$, $1500$, $1200$, $1000$, $900$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $350$, $300$, $250$, $200$ $\\,]$ $\\mathrm{cm^{-1}}$.\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $300$, $250$ $\\,]$ $\\mathrm{cm^{-1}}$.\n\nImplementation requirements:\n- Use only the provided data and the harmonic oscillator model for vibrational Helmholtz free energy; do not add other contributions.\n- Express the final numerical answers in $\\mathrm{kJ/mol}$, rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no extra text.",
            "solution": "The problem is subjected to validation before proceeding with a solution.\n\n### Step 1: Extract Givens\n- **Objective**: Compute the change in Deprotonation Energy, $\\Delta \\mathrm{DPE}$, in $\\mathrm{kJ/mol}$, defined as the difference between the in-pore complex proton transfer free energy and the vacuum reference proton transfer free energy.\n- **Thermodynamic Model**: The molar Gibbs free energy change, DPE, is assembled from electronic energy ($E_{\\mathrm{elec}}$) and vibrational Helmholtz free energy ($A_{\\mathrm{vib}}$) using the harmonic oscillator model.\n- **Approximation**: Adsorbed species contribute only vibrational Helmholtz free energy. Translational and rotational contributions are neglected for all species.\n- **Thermodynamic States**:\n    - $\\mathrm{Z\\!-\\!H}$: Protonated zeolite framework\n    - $\\mathrm{B}$: Isolated base\n    - $\\mathrm{Z^-}$: Deprotonated framework\n    - $\\mathrm{BH^+}$: Protonated base\n    - $\\mathrm{Z\\!-\\!H\\cdots B}$: Hydrogen-bonded reactant complex\n    - $\\mathrm{Z^-\\cdots BH^+}$: Contact ion-pair product complex\n- **Data per Case**:\n    - Absolute temperature $T$ in $\\mathrm{K}$.\n    - Electronic energies $E_{\\mathrm{elec}}$ in $\\mathrm{kJ/mol}$ for all six species.\n    - Lists of vibrational wavenumbers $\\nu$ in $\\mathrm{cm^{-1}}$ for all six species.\n- **Test Cases**: Four distinct test cases are provided with specific values for $T$, $E_{\\mathrm{elec}}$, and $\\nu$ lists.\n- **Output Format**: A single line of output containing the results as a comma-separated list enclosed in square brackets, rounded to three decimal places.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on fundamental principles of statistical mechanics and computational chemistry. The calculation of Gibbs free energy changes from electronic energies and vibrational frequencies (using the harmonic oscillator approximation) is a standard and robust methodology in the field of computational catalysis.\n- **Well-Posed**: The problem is well-posed. The objective is clearly defined, and all necessary data (temperatures, electronic energies, vibrational frequencies) and the theoretical framework (harmonic oscillator model) are explicitly provided. This allows for the calculation of a unique, meaningful solution for each test case.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language. It is free from subjective claims or opinions.\n- **Flaw Checklist**: The problem does not violate any of the specified invalidity criteria. It is scientifically sound, formalizable, complete, realistic, and well-structured.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be developed.\n\n### Principle-Based Solution\nThe objective is to compute the change in Deprotonation Energy, $\\Delta \\mathrm{DPE}$, which quantifies the effect of co-adsorption on the acidity of a zeolite. This quantity is the difference between the Deprotonation Energy in the complexed state, $\\mathrm{DPE}_{\\text{complex}}$, and in the vacuum (isolated species) state, $\\mathrm{DPE}_{\\text{vacuum}}$.\n\nFirst, we define the DPE for the two relevant proton transfer reactions:\n\n1.  **Vacuum Proton Transfer**: The reaction between the isolated zeolite acid site ($\\mathrm{Z\\!-\\!H}$) and the base ($\\mathrm{B}$) is:\n    $$ \\mathrm{Z\\!-\\!H} + \\mathrm{B} \\rightarrow \\mathrm{Z^-} + \\mathrm{BH^+} $$\n    The corresponding Deprotonation Energy, which is the molar Gibbs free energy change of this reaction, is:\n    $$ \\mathrm{DPE}_{\\text{vacuum}} = (G_{\\mathrm{Z^-}} + G_{\\mathrm{BH^+}}) - (G_{\\mathrm{Z\\!-\\!H}} + G_{\\mathrm{B}}) $$\n\n2.  **In-Pore Complex Proton Transfer**: The reaction within the zeolite pore, from the hydrogen-bonded reactant complex ($\\mathrm{Z\\!-\\!H\\cdots B}$) to the contact ion-pair product ($\\mathrm{Z^-\\cdots BH^+}$), is:\n    $$ \\mathrm{Z\\!-\\!H\\cdots B} \\rightarrow \\mathrm{Z^-\\cdots BH^+} $$\n    The Deprotonation Energy for this process is:\n    $$ \\mathrm{DPE}_{\\text{complex}} = G_{\\mathrm{Z^-\\cdots BH^+}} - G_{\\mathrm{Z\\!-\\!H\\cdots B}} $$\n\nThe change in Deprotonation Energy, $\\Delta \\mathrm{DPE}$, is therefore:\n$$ \\Delta \\mathrm{DPE} = \\mathrm{DPE}_{\\text{complex}} - \\mathrm{DPE}_{\\text{vacuum}} $$\nSubstituting the expressions for the DPEs gives:\n$$ \\Delta \\mathrm{DPE} = (G_{\\mathrm{Z^-\\cdots BH^+}} - G_{\\mathrm{Z\\!-\\!H\\cdots B}}) - (G_{\\mathrm{Z^-}} + G_{\\mathrm{BH^+}} - G_{\\mathrm{Z\\!-\\!H}} - G_{\\mathrm{B}}) $$\n\nThe problem specifies that the molar Gibbs free energy, $G$, of each species is to be approximated as the sum of its electronic energy, $E_{\\mathrm{elec}}$, and its molar vibrational Helmholtz free energy, $A_{\\mathrm{vib}}$:\n$$ G_{\\text{species}} \\approx E_{\\mathrm{elec, species}} + A_{\\mathrm{vib, species}} $$\nThis is a common approximation for condensed-phase systems where pressure-volume work is negligible.\n\nSubstituting this into the expression for $\\Delta \\mathrm{DPE}$ allows us to separate the total change into electronic and vibrational contributions:\n$$ \\Delta \\mathrm{DPE} = \\Delta E_{\\mathrm{elec}} + \\Delta A_{\\mathrm{vib}} $$\nwhere:\n$$ \\Delta E_{\\mathrm{elec}} = (E_{\\mathrm{elec,Z^-\\cdots BH^+}} - E_{\\mathrm{elec,Z\\!-\\!H\\cdots B}}) - (E_{\\mathrm{elec,Z^-}} + E_{\\mathrm{elec,BH^+}} - E_{\\mathrm{elec,Z\\!-\\!H}} - E_{\\mathrm{elec,B}}) $$\n$$ \\Delta A_{\\mathrm{vib}} = (A_{\\mathrm{vib,Z^-\\cdots BH^+}} - A_{\\mathrm{vib,Z\\!-\\!H\\cdots B}}) - (A_{\\mathrm{vib,Z^-}} + A_{\\mathrm{vib,BH^+}} - A_{\\mathrm{vib,Z\\!-\\!H}} - A_{\\mathrm{vib,B}}) $$\n\nThe molar vibrational Helmholtz free energy, $A_{\\mathrm{vib}}$, is calculated using the harmonic oscillator model from statistical mechanics. For a molecule with $N$ vibrational modes, each with a wavenumber $\\tilde{\\nu}_i$ (in $\\mathrm{cm^{-1}}$), $A_{\\mathrm{vib}}$ at a given temperature $T$ is the sum of contributions from each mode:\n$$ A_{\\mathrm{vib}} = \\sum_{i=1}^{N} A_{\\mathrm{vib}, i} $$\nThe molar contribution of a single harmonic oscillator is:\n$$ A_{\\mathrm{vib},i} = N_A \\left( \\frac{1}{2}h c \\tilde{\\nu}_i + k_B T \\ln\\left(1 - e^{-hc\\tilde{\\nu}_i/k_BT}\\right) \\right) $$\nHere, $N_A$ is Avogadro's constant ($6.02214076 \\times 10^{23}$ $\\mathrm{mol^{-1}}$), $h$ is Planck's constant ($6.62607015 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$), $c$ is the speed of light ($2.99792458 \\times 10^{10}$ $\\mathrm{cm \\cdot s^{-1}}$), and $k_B$ is the Boltzmann constant ($1.380649 \\times 10^{-23}$ $\\mathrm{J \\cdot K^{-1}}$). The first term, $\\frac{1}{2}h c \\tilde{\\nu}_i$, is the zero-point vibrational energy (ZPVE) of the mode, and the second term is the thermal contribution to the free energy.\n\nThe computational procedure is as follows:\n1.  For each test case and for each of the six species, calculate the molar vibrational Helmholtz free energy, $A_{\\mathrm{vib}}$, in $\\mathrm{kJ/mol}$ using the provided list of vibrational wavenumbers and the specified temperature.\n2.  Calculate the change in electronic energy, $\\Delta E_{\\mathrm{elec}}$, from the provided $E_{\\mathrm{elec}}$ values.\n3.  Calculate the change in vibrational Helmholtz free energy, $\\Delta A_{\\mathrm{vib}}$, using the values computed in step $1$.\n4.  Sum these two contributions to find the total change in Deprotonation Energy: $\\Delta \\mathrm{DPE} = \\Delta E_{\\mathrm{elec}} + \\Delta A_{\\mathrm{vib}}$.\n5.  Round the final result for each case to three decimal places.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in Deprotonation Energy (Delta DPE) for several\n    zeolite co-adsorption scenarios.\n    \"\"\"\n\n    # Physical constants (CODATA 2018)\n    h = 6.62607015e-34    # Planck constant in J·s\n    c = 2.99792458e10     # Speed of light in cm/s\n    k_B = 1.380649e-23      # Boltzmann constant in J/K\n    N_A = 6.02214076e23     # Avogadro constant in 1/mol\n\n    def calculate_A_vib(wavenumbers_cm, T_K):\n        \"\"\"\n        Calculates the molar vibrational Helmholtz free energy (A_vib)\n        using the harmonic oscillator model.\n\n        Args:\n            wavenumbers_cm (list): List of vibrational wavenumbers in cm^-1.\n            T_K (float): Absolute temperature in Kelvin.\n\n        Returns:\n            float: Molar vibrational Helmholtz free energy in kJ/mol.\n        \"\"\"\n        nu = np.array(wavenumbers_cm, dtype=np.float64)\n        \n        if nu.size == 0:\n            return 0.0\n\n        # Argument of the exponential, a dimensionless quantity x = hcν̃ / k_B T\n        x = (h * c * nu) / (k_B * T_K)\n\n        # Molar vibrational Helmholtz energy in J/mol\n        # A_vib = N_A * Σ [ (1/2)hcν̃_i + k_B T ln(1 - exp(-x_i)) ]\n        # composed of Zero-Point Vibrational Energy (ZPVE) and a thermal term.\n        \n        # ZPVE part per mole in J/mol\n        zpve_per_mol = 0.5 * N_A * h * c * np.sum(nu)\n        \n        # Thermal contribution part per mole in J/mol.\n        # np.log1p is used for numerical stability, computing log(1 + (-exp(-x))).\n        thermal_contrib_per_mol = N_A * k_B * T_K * np.sum(np.log1p(-np.exp(-x)))\n        \n        A_vib_J_per_mol = zpve_per_mol + thermal_contrib_per_mol\n        \n        # Convert from J/mol to kJ/mol\n        return A_vib_J_per_mol / 1000.0\n\n    test_cases = [\n        # Case 1: Ammonia co-adsorption\n        {\n            \"T\": 298.15,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -5000.0, \"BH+\": -40000.0,\n                \"ZHB\": -105500.0, \"Z_BH+\": -104600.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3400, 3300, 3200, 1600, 1100, 950],\n                \"BH+\": [3200, 3100, 3000, 1500, 1100, 900],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 350, 300, 200, 150],\n                \"Z_BH+\": [3200, 3000, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 350, 250]\n            }\n        },\n        # Case 2: Water co-adsorption\n        {\n            \"T\": 298.15,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -3000.0, \"BH+\": -38000.0,\n                \"ZHB\": -103200.0, \"Z_BH+\": -101900.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3755, 3657, 1595, 1200, 800, 400],\n                \"BH+\": [3550, 3400, 1690, 1100, 900, 700],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 320, 280, 220, 180],\n                \"Z_BH+\": [3300, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 460, 420, 380, 300, 200]\n            }\n        },\n        # Case 3: Methylamine co-adsorption\n        {\n            \"T\": 298.15,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -4500.0, \"BH+\": -39500.0,\n                \"ZHB\": -104700.0, \"Z_BH+\": -103500.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3400, 3300, 3000, 1600, 1450, 1100],\n                \"BH+\": [3200, 3000, 1500, 1400, 1100, 950],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 300, 250, 200, 100],\n                \"Z_BH+\": [3200, 3000, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 350, 250, 120]\n            }\n        },\n        # Case 4: Pyridine co-adsorption\n        {\n            \"T\": 500.0,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -8000.0, \"BH+\": -42000.0,\n                \"ZHB\": -108100.0, \"Z_BH+\": -106900.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3100, 1600, 1500, 1200, 1000, 800],\n                \"BH+\": [3200, 1600, 1500, 1200, 1000, 900],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 350, 300, 250, 200],\n                \"Z_BH+\": [3200, 3000, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 300, 250]\n            }\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        E = case[\"energies\"]\n        nu = case[\"wavenumbers\"]\n\n        # Calculate A_vib for all six species\n        A = {key: calculate_A_vib(val, T) for key, val in nu.items()}\n\n        # Calculate Delta DPE = Delta E_elec + Delta A_vib\n        # Delta E_elec = DPE_elec(complex) - DPE_elec(vacuum)\n        dpe_elec_complex = E[\"Z_BH+\"] - E[\"ZHB\"]\n        dpe_elec_vacuum = (E[\"Z_\"] + E[\"BH+\"]) - (E[\"ZH\"] + E[\"B\"])\n        delta_E_elec = dpe_elec_complex - dpe_elec_vacuum\n\n        # Delta A_vib = DPE_vib(complex) - DPE_vib(vacuum)\n        dpe_vib_complex = A[\"Z_BH+\"] - A[\"ZHB\"]\n        dpe_vib_vacuum = (A[\"Z_\"] + A[\"BH+\"]) - (A[\"ZH\"] + A[\"B\"])\n        delta_A_vib = dpe_vib_complex - dpe_vib_vacuum\n        \n        delta_DPE = delta_E_elec + delta_A_vib\n        \n        results.append(round(delta_DPE, 3))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}