{
    "hands_on_practices": [
        {
            "introduction": "沸石催化剂的活性位通常与骨架中的铝原子有关，但铝原子在晶体学上不等价的T位点上的分布并非随机。本练习将第一性原理计算与统计力学相结合，通过应用玻尔兹曼分布来预测不同温度下铝原子的平衡占位概率。掌握这种方法是构建现实沸石模型并理解其构效关系的第一步。",
            "id": "3890429",
            "problem": "您正在使用周期性 Kohn-Sham 密度泛函理论 (DFT) 来模拟沸石骨架中不等价四面体位点上的铝取代。每个位点类型 $i$ 对应于骨架中 $\\mathrm{Al}$ 取代的一个独特的局域环境，其中 $i \\in \\{1,2,\\dots,N\\}$。在每个模型中，一个铝原子在一种位点类型 $i$ 上取代一个硅原子，从而产生 $N$ 个独立优化的周期性模型。这些模型具有相同的组成和相同的电荷补偿排列（例如，一个质子或骨架外阳离子）。在固定的周期性边界条件下进行完全几何弛豫后，您得到每个模型的总电子能量 $E_i$。令 $g_i$ 表示简并度，定义为原胞中位点类型 $i$ 的对称等价位置的数量。假设所有 $E_i$ 值都是使用相同的交换相关泛函、基组、赝势、k点采样和晶胞尺寸计算的，因此 $E_i$ 之间的差异仅反映铝取代的位点依赖环境。\n\n从适用于平衡统计力学和正则系综的第一性原理出发，当系统与温度为 $T$ 的热库处于热接触时，推导平衡位点占据概率是如何产生的。您的推导必须基于具有能级 $E_i$、离散简并度 $g_i$ 以及归一化和平均能量约束的离散态的最大熵原理。您必须从经过充分检验的基础出发，例如熵 $S$ 的统计定义、使用拉格朗日乘子的约束以及平均能量保持固定的热力学要求。不要依赖问题陈述中任何预先给出的简化概率公式。在存在简并度的情况下，说明位点类型的简并度如何影响平衡概率。解释如何处理周期性 DFT 能量，以便在共同参考基准上提取相对位点偏好，包括任何可以在不改变概率的情况下移除的恒定偏移。\n\n实现一个算法，在给定 $E_i$ 和 $g_i$ 列表以及温度 $T$ 的情况下，计算玻尔兹曼加权位点分布。为了数值稳定性，在计算指数之前，通过减去一个恒定偏移（例如，最小能量）将能量归一化到一个共同的参考基准。使用以电子伏特每开尔文表示的玻尔兹曼常数 $k_\\mathrm{B} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$。所有能量必须以电子伏特（$\\mathrm{eV}$）处理，所有温度必须以开尔文（$\\mathrm{K}$）处理，最终的位点概率必须以小数（而非百分比）报告。对于每个测试用例，计算出的概率之和必须在数值精度范围内等于 $1$。\n\n物理和数值单位要求：能量以 $\\mathrm{eV}$ 表示，温度以 $\\mathrm{K}$ 表示，每个概率以小数报告。本问题不使用角度。使用适用于固定粒子数、体积和温度的正则系综描述。\n\n测试套件和答案规范：您的程序必须评估以下测试用例。每个测试用例由 $([E_1,E_2,\\dots,E_N], [g_1,g_2,\\dots,g_N], T)$ 组成，其中 $E_i$ 是 $\\mathrm{Al}$ 在位点类型 $i$ 上的周期性 DFT 总能量（所有 $i$ 的组成相同），$g_i$ 是简并度， $T$ 是温度。\n\n- 用例1（一般情况，中等温度）：$([0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}, [8, 4, 12, 6], 700\\,\\mathrm{K})$。\n- 用例2（近零温度极限）：$([0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}, [8, 4, 12, 6], 1\\,\\mathrm{K})$。\n- 用例3（高温极限）：$([0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}, [8, 4, 12, 6], 5000\\,\\mathrm{K})$。\n- 用例4（能量相等，由简并度决定的分布）：$([0.00, 0.00, 0.00, 0.00]\\,\\mathrm{eV}, [2, 2, 1, 3], 300\\,\\mathrm{K})$。\n- 用例5（两个简并极小值，低温）：$([0.00, 0.00, 0.05, 0.10]\\,\\mathrm{eV}, [4, 4, 2, 2], 10\\,\\mathrm{K})$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素按顺序对应一个测试用例，并且本身必须是一个小数列表，给出与输入能量和简并度顺序相同的位点概率。例如，总体输出必须类似于 $[[p_{1,1},p_{1,2},\\dots],[p_{2,1},p_{2,2},\\dots],\\dots]$，打印在单行上。在最终打印输出中，将每个小数四舍五入到 $6$ 位。",
            "solution": "该问题要求从正则系综中的最大熵原理出发，推导沸石骨架中铝取代的平衡位点占据概率。随后，必须实现一个算法，用于根据给定的位点能量 $E_i$、简并度 $g_i$ 和温度 $T$ 集合来计算这些概率。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 位点类型：$i \\in \\{1, 2, \\dots, N\\}$。\n- Al在位点类型 $i$ 上的模型的总电子能量：$E_i$。\n- 位点类型 $i$ 的简并度（对称等价位置的数量）：$g_i$。\n- 系统与温度为 $T$ 的热库处于热接触状态。\n- 推导必须基于具有能量 $E_i$ 和简并度 $g_i$ 的离散态的最大熵原理。\n- 约束条件：归一化和固定的平均能量。\n- 方法：拉格朗日乘子。\n- 能量 $E_i$ 以电子伏特（$\\mathrm{eV}$）为单位。\n- 温度 $T$ 以开尔文（$\\mathrm{K}$）为单位。\n- 玻尔兹曼常数：$k_\\mathrm{B} = 8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$。\n- 测试用例：\n    1.  $E = [0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}$，$g = [8, 4, 12, 6]$，$T = 700\\,\\mathrm{K}$。\n    2.  $E = [0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}$，$g = [8, 4, 12, 6]$，$T = 1\\,\\mathrm{K}$。\n    3.  $E = [0.12, 0.00, 0.08, 0.20]\\,\\mathrm{eV}$，$g = [8, 4, 12, 6]$，$T = 5000\\,\\mathrm{K}$。\n    4.  $E = [0.00, 0.00, 0.00, 0.00]\\,\\mathrm{eV}$，$g = [2, 2, 1, 3]$，$T = 300\\,\\mathrm{K}$。\n    5.  $E = [0.00, 0.00, 0.05, 0.10]\\,\\mathrm{eV}$，$g = [4, 4, 2, 2]$，$T = 10\\,\\mathrm{K}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据、定义明确且客观。它提出了一个统计力学及其在计算材料科学中应用的标准可解问题。\n- **科学依据**：在统计力学框架（特别是正则系综和玻尔兹曼统计）内使用 DFT 计算的能量来预测位点占据率，是计算催化和材料科学中一种公认且有效的方法。所要求的推导是统计力学中的一个基本练习。\n- **问题的明确性**：该问题定义清晰，包含所有必要的输入（$E_i$, $g_i$, $T$）和一个明确定义的输出（概率 $p_i$）。存在唯一、稳定的解，并且可以从给定原理中推导出来。\n- **客观性**：该问题使用精确、正式的语言陈述，不含主观或模棱两可的术语。\n- 该问题不违反任何无效性标准。数据一致，情景物理上合理，任务是形式化的推导和实现，而非主观或琐碎的问题。\n\n**步骤3：结论与行动**\n该问题有效。我将继续进行解答。\n\n### 从第一性原理推导\n\n我们将系统建模为单个铝原子，能够占据沸石骨架中任何可用的四面体位点。系统的基本状态，或称微观态，对应于Al原子占据一个特定的晶体学位置。存在 $N$ 种不同类型的位点，第 $i$ 种类型有 $g_i$ 个等效位置（简并度），并具有相关能量 $E_i$。\n\n令 $P_j$ 为系统处于特定微观态 $j$ 的概率。熵的统计定义（吉布斯熵）为：\n$$ S = -k_\\mathrm{B} \\sum_j P_j \\ln P_j $$\n其中求和遍及所有可及的微观态。\n\n平衡分布是在系统物理约束条件下使 $S$ 最大化的分布。在正则系综（固定粒子数、体积和温度）中，这些约束是：\n1.  **归一化**：概率之和必须为1。\n    $$ \\sum_j P_j = 1 $$\n2.  **平均能量**：系统的平均能量固定为值 $U$。令 $E(j)$ 为微观态 $j$ 的能量。\n    $$ \\langle E \\rangle = \\sum_j P_j E(j) = U $$\n\n我们使用拉格朗日乘子法来找到使 $S$ 最大化的分布 $\\{P_j\\}$。我们构造拉格朗日函数 $\\mathcal{L}$，为简化起见，通常最大化 $S/k_\\mathrm{B}$：\n$$ \\mathcal{L}(\\{P_j\\}, \\alpha, \\beta) = \\frac{S}{k_\\mathrm{B}} - \\alpha \\left( \\sum_j P_j - 1 \\right) - \\beta \\left( \\sum_j P_j E(j) - U \\right) $$\n$$ \\mathcal{L} = -\\sum_j P_j \\ln P_j - \\alpha \\left( \\sum_j P_j - 1 \\right) - \\beta \\left( \\sum_j P_j E(j) - U \\right) $$\n为了找到最大值，我们将 $\\mathcal{L}$ 对任意概率 $P_k$ 的偏导数设为零：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial P_k} = -(\\ln P_k + P_k \\cdot \\frac{1}{P_k}) - \\alpha - \\beta E(k) = 0 $$\n$$ -\\ln P_k - 1 - \\alpha - \\beta E(k) = 0 $$\n$$ \\ln P_k = -(1+\\alpha) - \\beta E(k) $$\n这给出了微观态 $k$ 的概率形式：\n$$ P_k = e^{-(1+\\alpha)} e^{-\\beta E(k)} $$\n项 $e^{-(1+\\alpha)}$ 是一个归一化常数。我们通过应用归一化约束来找到它的值：\n$$ \\sum_k P_k = \\sum_k e^{-(1+\\alpha)} e^{-\\beta E(k)} = e^{-(1+\\alpha)} \\sum_k e^{-\\beta E(k)} = 1 $$\n$$ e^{-(1+\\alpha)} = \\frac{1}{\\sum_k e^{-\\beta E(k)}} $$\n分母是正则配分函数 $Z = \\sum_k e^{-\\beta E(k)}$。因此，发现系统处于特定微观态 $k$ 的概率是：\n$$ P_k = \\frac{e^{-\\beta E(k)}}{Z} $$\n根据热力学原理，拉格朗日乘子 $\\beta$ 被确定为逆温度，$\\beta = 1/(k_\\mathrm{B} T)$。\n\n问题要求的是找到铝原子在*类型*为 $i$ 的任何一个位点上的概率 $p_i$。这可以通过将所有属于位点类型 $i$ 的微观态 $k$ 的概率 $P_k$ 相加得到。存在 $g_i$ 个这样的微观态，它们都共享相同的能量 $E_i$。\n$$ p_i = \\sum_{k \\in \\text{type } i} P_k = \\sum_{k \\in \\text{type } i} \\frac{e^{-\\beta E_i}}{Z} $$\n由于对于类型 $i$ 的所有 $g_i$ 个位点，能量 $E_i$ 是恒定的，所以求和变为：\n$$ p_i = g_i \\frac{e^{-\\beta E_i}}{Z} $$\n配分函数 $Z$ 是对所有微观态的求和。我们可以按位点类型对微观态进行分组：\n$$ Z = \\sum_{j=1}^N \\sum_{k \\in \\text{type } j} e^{-\\beta E_j} = \\sum_{j=1}^N g_j e^{-\\beta E_j} $$\n将这个 $Z$ 的表达式代入，得到位点占据概率的最终公式：\n$$ p_i = \\frac{g_i e^{-E_i / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-E_j / (k_\\mathrm{B} T)}} $$\n这就是具有离散、简并能级的系统的玻尔兹曼分布。\n\n### 能量参考与数值稳定性\n\n周期性 DFT 计算产生大的负总电子能量。如果 $E_i$ 是一个大的正数（相对于其他位点），直接计算 $e^{-E_i / (k_\\mathrm{B} T)}$ 可能导致数值下溢；如果它是一个非常负的数，则可能导致上溢。然而，概率 $p_i$ 仅依赖于能量*差*。我们可以通过将所有能量移动一个恒定偏移 $E_0$ 来证明这一点：\n$$ p_i = \\frac{g_i e^{-(E_i - E_0 + E_0) / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-(E_j - E_0 + E_0) / (k_\\mathrm{B} T)}} = \\frac{g_i e^{-(E_i - E_0) / (k_\\mathrm{B} T)} e^{-E_0 / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-(E_j - E_0) / (k_\\mathrm{B} T)} e^{-E_0 / (k_\\mathrm{B} T)}} $$\n项 $e^{-E_0 / (k_\\mathrm{B} T)}$ 是分子和分母中的公因子，因此可以消去：\n$$ p_i = \\frac{g_i e^{-(E_i - E_0) / (k_\\mathrm{B} T)}}{\\sum_{j=1}^N g_j e^{-(E_j - E_0) / (k_\\mathrm{B} T)}} $$\n为了数值稳定性，通常选择 $E_0 = E_{\\text{min}} = \\min_j(E_j)$。这将最低的相对能量设置为 $0$，所有其他相对能量设置为正值，确保最大的指数项是 $e^0 = 1$，并防止最可能状态的下溢。\n\n### 实现算法设计\n\n1.  **输入**：能量列表 $E = [E_1, E_2, \\dots, E_N]$，简并度列表 $g = [g_1, g_2, \\dots, g_N]$，以及温度 $T$。常数 $k_\\mathrm{B}$ 也是已知的。\n2.  **能量归一化**：计算最小能量 $E_{\\text{min}} = \\min(E)$。计算所有 $i$ 的相对能量 $\\Delta E_i = E_i - E_{\\text{min}}$。\n3.  **计算玻尔兹曼权重**：对于每个位点类型 $i$，计算其统计权重 $w_i$。这是简并度与玻尔兹曼因子的乘积。令 $\\beta = 1/(k_\\mathrm{B} T)$。\n    $$ w_i = g_i e^{-\\beta \\Delta E_i} $$\n4.  **计算配分函数**：将权重相加以获得配分函数 $Z$。\n    $$ Z = \\sum_{i=1}^N w_i $$\n5.  **计算概率**：通过配分函数对单个权重进行归一化以获得概率。\n    $$ p_i = \\frac{w_i}{Z} $$\n6.  **输出**：返回概率列表 $[p_1, p_2, \\dots, p_N]$。\n\n该算法将应用于问题陈述中提供的每个测试用例。使用 NumPy 数组进行这些计算将是高效的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes site-type occupancy probabilities based on Boltzmann statistics\n    for a series of test cases.\n    \"\"\"\n    \n    # Constants\n    # Boltzmann constant in eV/K\n    KB = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general case, moderate temperature\n        ([0.12, 0.00, 0.08, 0.20], [8, 4, 12, 6], 700.0),\n        # Case 2: near-zero temperature limit\n        ([0.12, 0.00, 0.08, 0.20], [8, 4, 12, 6], 1.0),\n        # Case 3: high-temperature limit\n        ([0.12, 0.00, 0.08, 0.20], [8, 4, 12, 6], 5000.0),\n        # Case 4: equal energies, degeneracy-determined distribution\n        ([0.00, 0.00, 0.00, 0.00], [2, 2, 1, 3], 300.0),\n        # Case 5: two degenerate minima, low temperature\n        ([0.00, 0.00, 0.05, 0.10], [4, 4, 2, 2], 10.0),\n    ]\n\n    def calculate_probabilities(energies, degeneracies, temperature, k_b):\n        \"\"\"\n        Calculates the Boltzmann-weighted site-type distribution.\n\n        Args:\n            energies (list or np.ndarray): List of DFT total energies in eV.\n            degeneracies (list or np.ndarray): List of site degeneracies.\n            temperature (float): Temperature in K.\n            k_b (float): Boltzmann constant in eV/K.\n\n        Returns:\n            list: A list of site-type probabilities.\n        \"\"\"\n        energies_arr = np.array(energies, dtype=np.float64)\n        degeneracies_arr = np.array(degeneracies, dtype=np.float64)\n\n        # For numerical stability, normalize energies by subtracting the minimum energy.\n        # This makes all relative energies >= 0 and avoids underflow/overflow issues.\n        min_energy = np.min(energies_arr)\n        relative_energies = energies_arr - min_energy\n\n        # Calculate thermal energy\n        k_b_t = k_b * temperature\n        \n        # Handle the T -> 0 limit gracefully, though T=1K is used in test case.\n        # If k_b_t is extremely small or zero, only the ground state(s) are populated.\n        if np.isclose(k_b_t, 0.0):\n            # Find indices of minimum energy states\n            ground_state_indices = np.where(np.isclose(relative_energies, 0.0))[0]\n            \n            # Sum of degeneracies for ground states\n            total_ground_degeneracy = np.sum(degeneracies_arr[ground_state_indices])\n            \n            probabilities = np.zeros_like(energies_arr)\n            if total_ground_degeneracy > 0:\n                probabilities[ground_state_indices] = degeneracies_arr[ground_state_indices] / total_ground_degeneracy\n            \n            return probabilities.tolist()\n\n        # Calculate Boltzmann weights: g_i * exp(-E_i / k_B T)\n        # Using relative energies for numerical stability.\n        boltzmann_weights = degeneracies_arr * np.exp(-relative_energies / k_b_t)\n        \n        # The sum of weights is the partition function Z\n        partition_function = np.sum(boltzmann_weights)\n\n        # Probabilities are the individual weights divided by the partition function\n        if partition_function == 0.0:\n            # This can happen if all weights underflow to zero at extremely low T.\n            # In this case, apply the zero-temperature logic.\n            ground_state_indices = np.where(np.isclose(relative_energies, 0.0))[0]\n            total_ground_degeneracy = np.sum(degeneracies_arr[ground_state_indices])\n            probabilities = np.zeros_like(energies_arr)\n            if total_ground_degeneracy > 0:\n                probabilities[ground_state_indices] = degeneracies_arr[ground_state_indices] / total_ground_degeneracy\n        else:\n            probabilities = boltzmann_weights / partition_function\n\n        return probabilities.tolist()\n\n    all_results = []\n    for case in test_cases:\n        energies, degeneracies, temp = case\n        result_probabilities = calculate_probabilities(energies, degeneracies, temp, KB)\n        all_results.append(result_probabilities)\n    \n    # Format the final output string as specified: [[p1,p2,...],[p1,p2,...],...]\n    # Each probability is rounded to 6 decimal places.\n    inner_lists_str = []\n    for res_list in all_results:\n        formatted_nums = [f'{p:.6f}' for p in res_list]\n        inner_lists_str.append(f\"[{','.join(formatted_nums)}]\")\n    \n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "活性位的局部结构直接决定了其催化性质，例如布朗斯特酸强度，通常用脱质子能（Deprotonation Energy, DPE）来衡量。本练习旨在通过建立一个线性回归模型，将DPE与具体的结构描述符（如环尺寸、次近邻铝原子数）联系起来。通过这个实践，你将学会量化构效关系，这是催化剂理性设计中的一项核心技能。",
            "id": "3890428",
            "problem": "您正在模拟沸石骨架中铝的分布如何影响布朗斯特酸位的去质子化能 (DPE)。沸石中的布朗斯特酸位对应于一个四面体位，其中硅被铝取代，并且一个电荷补偿质子与相邻的氧结合。去质子化能 (DPE) 是将质子移至无穷远处所需的能量。在本问题中，您将通过使用普通最小二乘法拟合一个仿射模型，来量化铝分布描述符对DPE的影响，然后用该模型预测新情况。\n\n您必须从以下基本依据出发：\n- 电荷局域化和局部结构控制共轭碱的稳定性；因此，去质子化能取决于局部结构描述符，例如环的大小以及次近邻壳层中带电荷的铝的存在。这是沸石计算催化领域一个经过充分检验的概念。\n- 在线性响应模型中，一个可观测量可以近似为一组描述符的仿射函数。您将假设DPE对结构描述符具有仿射依赖性，并通过最小化残差平方和（普通最小二乘法）来确定系数。\n- 最小二乘估计量在训练数据集上最小化观测值与预测值之间的平方差之和。\n\n定义和变量：\n- 去质子化能 (DPE) 用 $y$ 表示，单位必须是千焦/摩尔 (kJ/mol)。\n- 每个四面体骨架位（T位）$i$ 由一个描述符向量 $\\mathbf{x}_i \\in \\mathbb{R}^p$ 表示，其中包含：\n  - $r4$：四元环成员指示符（值为 $\\{0,1\\}$）。\n  - $r5$：五元环成员指示符（值为 $\\{0,1\\}$）。\n  - $r6$：六元环成员指示符（值为 $\\{0,1\\}$）。\n  - $r10$：十元环成员指示符（值为 $\\{0,1\\}$）。\n  - $n_{\\mathrm{NNN}}$：T位周围次近邻（第二壳层）的骨架铝原子整数数量（此处值为 $\\{0,1,2,3\\}$）。\n  - $d_{\\min}$：到任意次近邻铝的最小T-T距离，单位为埃（$\\mathrm{\\AA}$），在问题中记为 $\\mathrm{\\AA}$。距离必须以单位 $\\mathrm{\\AA}$ 的实数形式输入，但程序应将其作为无单位的数值处理。\n- 您的模型必须包含一个截距，因此仿射模型为 $y = \\beta_0 + \\sum_{j=1}^p \\beta_j x_j + \\varepsilon$，其中 $\\varepsilon$ 是残差。\n\n训练数据集：\n给定 $N = 12$ 个已标记的T位，其描述符向量为 $\\mathbf{x}_i$，对应的DPE值为 $y_i$（单位为 kJ/mol）。描述符按 $[r4, r5, r6, r10, n_{\\mathrm{NNN}}, d_{\\min}]$ 的顺序排列。\n\n- 位点 $1$：$\\mathbf{x}_1 = [1, 0, 0, 0, 0, 8.0]$, $y_1 = 1356.0$。\n- 位点 $2$：$\\mathbf{x}_2 = [0, 1, 0, 0, 1, 7.5]$, $y_2 = 1320.0$。\n- 位点 $3$：$\\mathbf{x}_3 = [0, 0, 1, 0, 0, 7.0]$, $y_3 = 1320.7$。\n- 位点 $4$：$\\mathbf{x}_4 = [0, 0, 0, 1, 2, 7.8]$, $y_4 = 1275.2$。\n- 位点 $5$：$\\mathbf{x}_5 = [1, 1, 0, 0, 1, 6.8]$, $y_5 = 1351.0$。\n- 位点 $6$：$\\mathbf{x}_6 = [0, 1, 1, 0, 0, 8.2]$, $y_6 = 1341.3$。\n- 位点 $7$：$\\mathbf{x}_7 = [1, 0, 1, 0, 2, 7.2]$, $y_7 = 1331.8$。\n- 位点 $8$：$\\mathbf{x}_8 = [0, 0, 1, 1, 1, 8.8]$, $y_8 = 1297.6$。\n- 位点 $9$：$\\mathbf{x}_9 = [0, 0, 0, 0, 0, 9.0]$, $y_9 = 1324.6$。\n- 位点 $10$：$\\mathbf{x}_{10} = [0, 1, 0, 1, 3, 6.6]$, $y_{10} = 1272.1$。\n- 位点 $11$：$\\mathbf{x}_{11} = [1, 0, 0, 1, 1, 7.6]$, $y_{11} = 1320.7$。\n- 位点 $12$：$\\mathbf{x}_{12} = [0, 1, 0, 0, 2, 6.9]$, $y_{12} = 1306.0$。\n\n您的任务：\n1. 通过最小化残差平方和，将仿射模型 $y = \\beta_0 + \\sum_{j=1}^p \\beta_j x_j$ 拟合到训练数据。\n2. 使用拟合的模型预测以下四个测试T位的DPE值，每个T位都以相同的顺序给出描述符向量：\n   - 测试A：$\\mathbf{x}_A = [1, 0, 0, 0, 2, 7.0]$。\n   - 测试B：$\\mathbf{x}_B = [0, 1, 0, 1, 0, 8.5]$。\n   - 测试C：$\\mathbf{x}_C = [0, 0, 1, 0, 1, 6.7]$。\n   - 测试D：$\\mathbf{x}_D = [1, 1, 0, 0, 3, 6.6]$。\n3. 通过报告对应于 $n_{\\mathrm{NNN}}$ 和 $d_{\\min}$ 的估计系数的符号，以及 $r4$ 的系数，来评估铝分布的影响。具体来说，为以下问题生成布尔值：\n   - $n_{\\mathrm{NNN}}$ 的系数是否为负？\n   - $r4$ 的系数是否为正？\n   - $d_{\\min}$ 的系数是否为正？\n\n数值和单位要求：\n- 所有预测的DPE值必须以千焦/摩尔（kJ/mol）表示。\n- 将每个预测的DPE四舍五入到三位小数。\n- 不使用角度；距离 $d_{\\min}$ 的单位是埃，但您应只输出单位为 kJ/mol 的能量。\n\n测试套件和最终输出规范：\n- 您的程序必须按顺序计算并输出测试A、测试B、测试C和测试D的四个预测DPE值，然后是关于系数符号问题的三个布尔值答案。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，没有空格。前四个条目必须是保留三位小数的浮点数，后三个条目必须是布尔值。例如：$[\\text{val}_A,\\text{val}_B,\\text{val}_C,\\text{val}_D,\\text{bool}_1,\\text{bool}_2,\\text{bool}_3]$。",
            "solution": "所述问题是有效的。它在科学上基于计算催化和多相催化的原理，在这些领域中，结构-性质关系通常使用线性模型建立。该问题是适定的，为普通最小二乘法 (OLS) 回归提供了一个完整的数据集，这是一种标准且可解的统计方法。定义是客观的，数据是自洽且足以进行计算的。\n\n任务是根据给定的数据集拟合一个仿射模型，并用它进行预测。该模型将去质子化能 (DPE) $y$ 描述为 $p=6$ 个结构描述符 $\\mathbf{x} = [x_1, \\dots, x_p]^T$ 的线性函数，外加一个截距项。模型方程为：\n$$y = \\beta_0 + \\sum_{j=1}^{p} \\beta_j x_j + \\varepsilon$$\n其中 $\\beta_0$ 是截距，$\\{\\beta_j\\}_{j=1}^p$ 是模型系数，$\\varepsilon$ 表示残差。描述符为 $x_1=r4$, $x_2=r5$, $x_3=r6$, $x_4=r10$, $x_5=n_{\\mathrm{NNN}}$ 和 $x_6=d_{\\min}$。\n\n对于一个包含 $N=12$ 个观测值的训练集，这种关系可以用矩阵形式表示为：\n$$\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}$$\n这里，$\\mathbf{y}$ 是观测到的DPE值的 $N \\times 1$ 向量。$\\boldsymbol{\\beta}$ 是待确定的系数的 $(p+1) \\times 1$ 向量：$\\boldsymbol{\\beta} = [\\beta_0, \\beta_1, \\dots, \\beta_p]^T$。$\\mathbf{X}$ 是 $N \\times (p+1)$ 的设计矩阵，它是通过在 $N \\times p$ 的描述符数据矩阵前添加一列全为1的列来构造的，以考虑截距 $\\beta_0$。\n\n普通最小二乘法 (OLS) 找到系数向量 $\\hat{\\boldsymbol{\\beta}}$，该向量使残差平方和 $S(\\boldsymbol{\\beta}) = \\sum_{i=1}^N \\varepsilon_i^2 = ||\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}||_2^2$ 最小化。这个最小化问题的解可以通过求解正规方程组得到：\n$$(\\mathbf{X}^T\\mathbf{X})\\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T\\mathbf{y}$$\n因此，系数的OLS估计量为：\n$$\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$$\n为了获得更好的数值稳定性，我们将使用基于QR分解的方法来求解这个方程组，这是标准做法，并在NumPy等库中得到实现，而不是通过显式计算矩阵的逆。\n\n第一步是根据提供的训练数据构建设计矩阵 $\\mathbf{X}$ 和观测向量 $\\mathbf{y}$。\n观测向量为：\n$$\\mathbf{y} = [1356.0, 1320.0, 1320.7, 1275.2, 1351.0, 1341.3, 1331.8, 1297.6, 1324.6, 1272.1, 1320.7, 1306.0]^T$$\n$12 \\times 7$ 的设计矩阵 $\\mathbf{X}$ 是：\n$$\n\\mathbf{X} =\n\\begin{pmatrix}\n1  1  0  0  0  0  8.0 \\\\\n1  0  1  0  0  1  7.5 \\\\\n1  0  0  1  0  0  7.0 \\\\\n1  0  0  0  1  2  7.8 \\\\\n1  1  1  0  0  1  6.8 \\\\\n1  0  1  1  0  0  8.2 \\\\\n1  1  0  1  0  2  7.2 \\\\\n1  0  0  1  1  1  8.8 \\\\\n1  0  0  0  0  0  9.0 \\\\\n1  0  1  0  1  3  6.6 \\\\\n1  1  0  0  1  1  7.6 \\\\\n1  0  1  0  0  2  6.9\n\\end{pmatrix}\n$$\n求解 $\\hat{\\boldsymbol{\\beta}}$ 的线性最小二乘问题，得到估计的系数向量：\n$$\\hat{\\boldsymbol{\\beta}} = [\\hat{\\beta}_0, \\hat{\\beta}_{r4}, \\hat{\\beta}_{r5}, \\hat{\\beta}_{r6}, \\hat{\\beta}_{r10}, \\hat{\\beta}_{n_{\\mathrm{NNN}}}, \\hat{\\beta}_{d_{\\min}}]^T$$\n\n一旦确定了 $\\hat{\\boldsymbol{\\beta}}$，我们就可以预测四个测试位的DPE。对于每个测试描述符向量 $\\mathbf{x}_{\\text{test}}$，预测的DPE $y_{\\text{pred}}$ 计算如下：\n$$y_{\\text{pred}} = \\hat{\\beta}_0 + \\hat{\\beta}_{r4} x_{r4} + \\hat{\\beta}_{r5} x_{r5} + \\hat{\\beta}_{r6} x_{r6} + \\hat{\\beta}_{r10} x_{r10} + \\hat{\\beta}_{n_{\\mathrm{NNN}}} x_{n_{\\mathrm{NNN}}} + \\hat{\\beta}_{d_{\\min}} x_{d_{\\min}}$$\n对四个测试向量中的每一个都执行此操作，并将结果四舍五入到三位小数。\n\n最后的任务是评估拟合模型 $\\hat{\\boldsymbol{\\beta}}$ 中特定系数的符号：\n1.  $\\hat{\\beta}_{n_{\\mathrm{NNN}}}$ 的符号，即次近邻铝原子数的系数。\n2.  $\\hat{\\beta}_{r4}$ 的符号，即四元环成员的系数。\n3.  $\\hat{\\beta}_{d_{\\min}}$ 的符号，即到次近邻铝的最小T-T距离的系数。\n\n通过直接检查计算出的 $\\hat{\\boldsymbol{\\beta}}$ 向量的元素来执行这些检查。然后将得到的四个预测DPE值和三个布尔值格式化为所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits an affine model using ordinary least squares to predict deprotonation energy (DPE)\n    of Brønsted acid sites in a zeolite based on structural descriptors.\n    \"\"\"\n    # Define the training dataset from the problem statement.\n    # Descriptors are ordered as [r4, r5, r6, r10, n_NNN, d_min].\n    training_data = [\n        ([1, 0, 0, 0, 0, 8.0], 1356.0),\n        ([0, 1, 0, 0, 1, 7.5], 1320.0),\n        ([0, 0, 1, 0, 0, 7.0], 1320.7),\n        ([0, 0, 0, 1, 2, 7.8], 1275.2),\n        ([1, 1, 0, 0, 1, 6.8], 1351.0),\n        ([0, 1, 1, 0, 0, 8.2], 1341.3),\n        ([1, 0, 1, 0, 2, 7.2], 1331.8),\n        ([0, 0, 1, 1, 1, 8.8], 1297.6),\n        ([0, 0, 0, 0, 0, 9.0], 1324.6),\n        ([0, 1, 0, 1, 3, 6.6], 1272.1),\n        ([1, 0, 0, 1, 1, 7.6], 1320.7),\n        ([0, 1, 0, 0, 2, 6.9], 1306.0),\n    ]\n\n    # Unpack training data into descriptor matrix and DPE vector\n    X_train_data = np.array([item[0] for item in training_data])\n    y_train = np.array([item[1] for item in training_data])\n\n    # Construct the design matrix by adding a column of ones for the intercept\n    num_observations = X_train_data.shape[0]\n    X_train = np.hstack([np.ones((num_observations, 1)), X_train_data])\n\n    # Task 1: Fit the affine model using Ordinary Least Squares.\n    # np.linalg.lstsq provides a numerically stable solution to the normal equations.\n    # It returns the coefficient vector that minimizes the sum of squared residuals.\n    # The returned vector coeffs contains [beta_0, beta_r4, beta_r5, ...].\n    coeffs, _, _, _ = np.linalg.lstsq(X_train, y_train, rcond=None)\n\n    # Define the test cases for prediction.\n    test_cases = [\n        [1, 0, 0, 0, 2, 7.0],  # Test A\n        [0, 1, 0, 1, 0, 8.5],  # Test B\n        [0, 0, 1, 0, 1, 6.7],  # Test C\n        [1, 1, 0, 0, 3, 6.6],  # Test D\n    ]\n    \n    # Construct the design matrix for the test cases\n    X_test_data = np.array(test_cases)\n    X_test = np.hstack([np.ones((X_test_data.shape[0], 1)), X_test_data])\n\n    # Task 2: Use the fitted model to predict DPE values for test sites.\n    # y_pred = X_test @ coeffs\n    predicted_dpes = X_test.dot(coeffs)\n\n    # Round each predicted DPE to three decimal places.\n    rounded_dpes = [round(val, 3) for val in predicted_dpes]\n\n    # Task 3: Evaluate the signs of specific estimated coefficients.\n    # The descriptor order is [r4, r5, r6, r10, n_NNN, d_min].\n    # coeffs[0] is the intercept.\n    # coeffs[1] is for r4.\n    # coeffs[5] is for n_NNN.\n    # coeffs[6] is for d_min.\n    \n    # Is the coefficient of n_NNN negative?\n    is_n_nnn_coeff_negative = coeffs[5] < 0\n    # Is the coefficient of r4 positive?\n    is_r4_coeff_positive = coeffs[1] > 0\n    # Is the coefficient of d_min positive?\n    is_d_min_coeff_positive = coeffs[6] > 0\n\n    # Assemble the final results list\n    all_results = rounded_dpes + [is_n_nnn_coeff_negative, is_r4_coeff_positive, is_d_min_coeff_positive]\n\n    # Format the final output string as per the specification.\n    # Example: [val_A,val_B,val_C,val_D,bool_1,bool_2,bool_3] with no spaces.\n    # Python's bool __str__ method returns 'True' or 'False', which need to be lowercased.\n    output_str = f\"[{','.join(str(r) for r in all_results)}]\"\n    final_output = output_str.replace(\"True\", \"true\").replace(\"False\", \"false\")\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "催化反应很少在真空中发生，反应环境（如溶剂或共吸附物）会显著影响催化剂的表观性质。本练习将探讨共吸附的碱性分子如何通过氢键作用改变沸石的有效酸强度。你将通过构建热力学循环并考虑振动自由能校正，来计算脱质子能的变化，从而深入理解内在酸性与表观酸性之间的差异。",
            "id": "3890458",
            "problem": "您正在模拟共吸附条件下铝硅酸盐沸石的布朗斯特酸性。目标是通过计算在共吸附物种存在的情况下去质子化能 (DPE) 的变化，来确定氢键合的碱分子如何改变有效酸强度。去质子化能 (DPE) 是指质子从沸石羟基转移到碱分子过程的摩尔吉布斯自由能变。\n\n该问题的基本原理是平衡热力学，其中反应的摩尔吉布斯自由能变由状态函数定义，并可通过分子贡献（包括电子能量和在谐振子近似下的振动亥姆霍兹自由能）加和得到。通过将氢键配合物的质子转移自由能与没有氢键作用（孤立物种的真空去质子化反应）时的相应值进行比较，可以捕捉到共吸附效应。\n\n您必须计算去质子化能的变化量，记为 $\\Delta \\mathrm{DPE}$，其值是孔道内配合物质子转移自由能与真空参考质子转移自由能之间的差值。所有自由能都应在指定的绝对温度下，使用谐振子模型计算振动贡献。假设以下模型近似：吸附物种（沸石和配合物）仅贡献振动亥姆霍兹自由能；在本任务中，所有物种的平动和转动贡献均被忽略，以确保处理的一致性，并分离出振动和电子效应。使用为每个状态提供的电子能量，并加上根据提供的波数列表计算出的振动亥姆霍兹自由能。最终结果必须以 $\\mathrm{kJ/mol}$ 为单位表示，并四舍五入到三位小数。\n\n需要考虑的热力学状态：\n- 质子化的沸石骨架和孤立的碱：$\\mathrm{Z\\!-\\!H}$ 和 $\\mathrm{B}$。\n- 去质子化的骨架和质子化的碱：$\\mathrm{Z^-}$ 和 $\\mathrm{BH^+}$。\n- 氢键合的反应物配合物：$\\mathrm{Z\\!-\\!H\\cdots B}$。\n- 接触离子对产物配合物：$\\mathrm{Z^-\\cdots BH^+}$。\n\n对于下面的每个测试用例，您将获得：\n- 绝对温度 $T$（单位 $\\mathrm{K}$）。\n- 六个状态的电子能量 $E_{\\mathrm{elec}}$（单位 $\\mathrm{kJ/mol}$）。\n- 六个状态的振动波数列表（单位 $\\mathrm{cm^{-1}}$）。\n\n针对每个测试用例，计算 $\\Delta \\mathrm{DPE}$ 的值（单位 $\\mathrm{kJ/mol}$），并四舍五入到三位小数。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，\"[result1,result2,result3]\"）。\n\n测试套件：\n- 用例 $1$（氨共吸附，产物中度稳定）：\n  - $T = 298.15$ $\\mathrm{K}$。\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{B}) = -5000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -40000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -105500.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -104600.0$ $\\mathrm{kJ/mol}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{B}) = [\\,$ $3400$, $3300$, $3200$, $1600$, $1100$, $950$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3200$, $3100$, $3000$, $1500$, $1100$, $900$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $350$, $300$, $200$, $150$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $350$, $250$ $\\,]$ $\\mathrm{cm^{-1}}$。\n\n- 用例 $2$（水共吸附，反应物配合物的稳定性高于产物）：\n  - $T = 298.15$ $\\mathrm{K}$。\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{B}) = -3000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -38000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -103200.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -101900.0$ $\\mathrm{kJ/mol}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{B}) = [\\,$ $3755$, $3657$, $1595$, $1200$, $800$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3550$, $3400$, $1690$, $1100$, $900$, $700$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $320$, $280$, $220$, $180$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3300$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $460$, $420$, $380$, $300$, $200$ $\\,]$ $\\mathrm{cm^{-1}}$。\n\n- 用例 $3$（甲胺共吸附，稳定性平衡）：\n  - $T = 298.15$ $\\mathrm{K}$。\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{B}) = -4500.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -39500.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -104700.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -103500.0$ $\\mathrm{kJ/mol}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{B}) = [\\,$ $3400$, $3300$, $3000$, $1600$, $1450$, $1100$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $950$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $300$, $250$, $200$, $100$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $350$, $250$, $120$ $\\,]$ $\\mathrm{cm^{-1}}$。\n\n- 用例 $4$（吡啶共吸附，产物强稳定，温度较高）：\n  - $T = 500.0$ $\\mathrm{K}$。\n  - $E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H}) = -100000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-}) = -63800.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{B}) = -8000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{BH^+}) = -42000.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z\\!-\\!H\\cdots B}) = -108100.0$ $\\mathrm{kJ/mol}$，$E_{\\mathrm{elec}}(\\mathrm{Z^-\\cdots BH^+}) = -106900.0$ $\\mathrm{kJ/mol}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H}) = [\\,$ $3600$, $1400$, $1100$, $800$, $700$, $600$, $500$, $450$, $400$, $300$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-}) = [\\,$ $1100$, $900$, $800$, $700$, $600$, $500$, $450$, $400$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{B}) = [\\,$ $3100$, $1600$, $1500$, $1200$, $1000$, $800$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{BH^+}) = [\\,$ $3200$, $1600$, $1500$, $1200$, $1000$, $900$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z\\!-\\!H\\cdots B}) = [\\,$ $3600$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $350$, $300$, $250$, $200$ $\\,]$ $\\mathrm{cm^{-1}}$。\n  - $\\nu(\\mathrm{Z^-\\cdots BH^+}) = [\\,$ $3200$, $3000$, $1500$, $1400$, $1100$, $1000$, $900$, $800$, $700$, $600$, $500$, $450$, $400$, $300$, $250$ $\\,]$ $\\mathrm{cm^{-1}}$。\n\n实现要求：\n- 仅使用提供的数据和亥姆霍兹振动自由能的谐振子模型；不要添加其他贡献。\n- 最终数值答案以 $\\mathrm{kJ/mol}$ 表示，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，无额外文本。",
            "solution": "在进行求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **目标**：计算去质子化能的变化量 $\\Delta \\mathrm{DPE}$（单位 $\\mathrm{kJ/mol}$），其定义为孔道内配合物质子转移自由能与真空参考质子转移自由能之间的差值。\n- **热力学模型**：摩尔吉布斯自由能变 DPE 由电子能量（$E_{\\mathrm{elec}}$）和使用谐振子模型计算的振动亥姆霍兹自由能（$A_{\\mathrm{vib}}$）组成。\n- **近似**：吸附物种仅贡献振动亥姆霍兹自由能。所有物种的平动和转动贡献均被忽略。\n- **热力学状态**：\n    - $\\mathrm{Z\\!-\\!H}$：质子化的沸石骨架\n    - $\\mathrm{B}$：孤立的碱\n    - $\\mathrm{Z^-}$：去质子化的骨架\n    - $\\mathrm{BH^+}$：质子化的碱\n    - $\\mathrm{Z\\!-\\!H\\cdots B}$：氢键合的反应物配合物\n    - $\\mathrm{Z^-\\cdots BH^+}$：接触离子对产物配合物\n- **每个用例的数据**：\n    - 绝对温度 $T$（单位 $\\mathrm{K}$）。\n    - 所有六个物种的电子能量 $E_{\\mathrm{elec}}$（单位 $\\mathrm{kJ/mol}$）。\n    - 所有六个物种的振动波数列表 $\\nu$（单位 $\\mathrm{cm^{-1}}$）。\n- **测试用例**：提供了四个不同的测试用例，包含特定的 $T$、$E_{\\mathrm{elec}}$ 和 $\\nu$ 列表值。\n- **输出格式**：单行输出，包含用方括号括起来的、以逗号分隔的结果列表，四舍五入到三位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于统计力学和计算化学的基本原理。从电子能量和振动频率（使用谐振子近似）计算吉布斯自由能变是计算催化领域中一种标准且稳健的方法。\n- **适定性**：该问题是适定的。目标明确，所有必要数据（温度、电子能量、振动频率）和理论框架（谐振子模型）都已明确提供。这使得可以为每个测试用例计算出唯一且有意义的解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。它不含主观论断或意见。\n- **缺陷清单**：该问题未违反任何指定的无效性标准。它在科学上是合理的、可形式化的、完整的、现实的且结构良好。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将制定解决方案。\n\n### 基于原理的解决方案\n目标是计算去质子化能的变化量 $\\Delta \\mathrm{DPE}$，该值量化了共吸附对沸石酸性的影响。该量是配合物状态下的去质子化能 $\\mathrm{DPE}_{\\text{complex}}$ 与真空（孤立物种）状态下的去质子化能 $\\mathrm{DPE}_{\\text{vacuum}}$ 之间的差值。\n\n首先，我们为两个相关的质子转移反应定义 DPE：\n\n1.  **真空质子转移**：孤立的沸石酸位点（$\\mathrm{Z\\!-\\!H}$）和碱（$\\mathrm{B}$）之间的反应是：\n    $$ \\mathrm{Z\\!-\\!H} + \\mathrm{B} \\rightarrow \\mathrm{Z^-} + \\mathrm{BH^+} $$\n    相应的去质子化能，即该反应的摩尔吉布斯自由能变，是：\n    $$ \\mathrm{DPE}_{\\text{vacuum}} = (G_{\\mathrm{Z^-}} + G_{\\mathrm{BH^+}}) - (G_{\\mathrm{Z\\!-\\!H}} + G_{\\mathrm{B}}) $$\n\n2.  **孔道内配合物质子转移**：在沸石孔道内，从氢键合的反应物配合物（$\\mathrm{Z\\!-\\!H\\cdots B}$）到接触离子对产物（$\\mathrm{Z^-\\cdots BH^+}$）的反应是：\n    $$ \\mathrm{Z\\!-\\!H\\cdots B} \\rightarrow \\mathrm{Z^-\\cdots BH^+} $$\n    此过程的去质子化能是：\n    $$ \\mathrm{DPE}_{\\text{complex}} = G_{\\mathrm{Z^-\\cdots BH^+}} - G_{\\mathrm{Z\\!-\\!H\\cdots B}} $$\n\n因此，去质子化能的变化量 $\\Delta \\mathrm{DPE}$ 是：\n$$ \\Delta \\mathrm{DPE} = \\mathrm{DPE}_{\\text{complex}} - \\mathrm{DPE}_{\\text{vacuum}} $$\n代入 DPE 的表达式可得：\n$$ \\Delta \\mathrm{DPE} = (G_{\\mathrm{Z^-\\cdots BH^+}} - G_{\\mathrm{Z\\!-\\!H\\cdots B}}) - (G_{\\mathrm{Z^-}} + G_{\\mathrm{BH^+}} - G_{\\mathrm{Z\\!-\\!H}} - G_{\\mathrm{B}}) $$\n\n问题指定每个物种的摩尔吉布斯自由能 $G$ 近似为其电子能量 $E_{\\mathrm{elec}}$ 和其摩尔振动亥姆霍兹自由能 $A_{\\mathrm{vib}}$ 的总和：\n$$ G_{\\text{species}} \\approx E_{\\mathrm{elec, species}} + A_{\\mathrm{vib, species}} $$\n对于压强-体积功可忽略的凝聚相体系，这是一个常见的近似。\n\n将此代入 $\\Delta \\mathrm{DPE}$ 的表达式，我们可以将总变化分解为电子贡献和振动贡献：\n$$ \\Delta \\mathrm{DPE} = \\Delta E_{\\mathrm{elec}} + \\Delta A_{\\mathrm{vib}} $$\n其中：\n$$ \\Delta E_{\\mathrm{elec}} = (E_{\\mathrm{elec,Z^-\\cdots BH^+}} - E_{\\mathrm{elec,Z\\!-\\!H\\cdots B}}) - (E_{\\mathrm{elec,Z^-}} + E_{\\mathrm{elec,BH^+}} - E_{\\mathrm{elec,Z\\!-\\!H}} - E_{\\mathrm{elec,B}}) $$\n$$ \\Delta A_{\\mathrm{vib}} = (A_{\\mathrm{vib,Z^-\\cdots BH^+}} - A_{\\mathrm{vib,Z\\!-\\!H\\cdots B}}) - (A_{\\mathrm{vib,Z^-}} + A_{\\mathrm{vib,BH^+}} - A_{\\mathrm{vib,Z\\!-\\!H}} - A_{\\mathrm{vib,B}}) $$\n\n摩尔振动亥姆霍兹自由能 $A_{\\mathrm{vib}}$ 使用统计力学中的谐振子模型计算。对于一个具有 $N$ 个振动模式的分子，每个模式的波数为 $\\tilde{\\nu}_i$（单位 $\\mathrm{cm^{-1}}$），在给定温度 $T$ 下的 $A_{\\mathrm{vib}}$ 是每个模式贡献的总和：\n$$ A_{\\mathrm{vib}} = \\sum_{i=1}^{N} A_{\\mathrm{vib}, i} $$\n单个谐振子的摩尔贡献是：\n$$ A_{\\mathrm{vib},i} = N_A \\left( \\frac{1}{2}h c \\tilde{\\nu}_i + k_B T \\ln\\left(1 - e^{-hc\\tilde{\\nu}_i/k_BT}\\right) \\right) $$\n这里，$N_A$ 是阿伏伽德罗常数（$6.02214076 \\times 10^{23}$ $\\mathrm{mol^{-1}}$），$h$ 是普朗克常数（$6.62607015 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$），$c$ 是光速（$2.99792458 \\times 10^{10}$ $\\mathrm{cm \\cdot s^{-1}}$），$k_B$ 是玻尔兹曼常数（$1.380649 \\times 10^{-23}$ $\\mathrm{J \\cdot K^{-1}}$）。第一项 $\\frac{1}{2}h c \\tilde{\\nu}_i$ 是该模式的零点振动能（ZPVE），第二项是自由能的热贡献。\n\n计算步骤如下：\n1.  对于每个测试用例和六个物种中的每一个，使用提供的振动波数列表和指定温度，计算摩尔振动亥姆霍兹自由能 $A_{\\mathrm{vib}}$（单位 $\\mathrm{kJ/mol}$）。\n2.  根据提供的 $E_{\\mathrm{elec}}$ 值，计算电子能量的变化量 $\\Delta E_{\\mathrm{elec}}$。\n3.  使用步骤 1 中计算的值，计算振动亥姆霍兹自由能的变化量 $\\Delta A_{\\mathrm{vib}}$。\n4.  将这两个贡献相加，得到去质子化能的总变化量：$\\Delta \\mathrm{DPE} = \\Delta E_{\\mathrm{elec}} + \\Delta A_{\\mathrm{vib}}$。\n5.  将每个用例的最终结果四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in Deprotonation Energy (Delta DPE) for several\n    zeolite co-adsorption scenarios.\n    \"\"\"\n\n    # Physical constants (CODATA 2018)\n    h = 6.62607015e-34    # Planck constant in J·s\n    c = 2.99792458e10     # Speed of light in cm/s\n    k_B = 1.380649e-23      # Boltzmann constant in J/K\n    N_A = 6.02214076e23     # Avogadro constant in 1/mol\n\n    def calculate_A_vib(wavenumbers_cm, T_K):\n        \"\"\"\n        Calculates the molar vibrational Helmholtz free energy (A_vib)\n        using the harmonic oscillator model.\n\n        Args:\n            wavenumbers_cm (list): List of vibrational wavenumbers in cm^-1.\n            T_K (float): Absolute temperature in Kelvin.\n\n        Returns:\n            float: Molar vibrational Helmholtz free energy in kJ/mol.\n        \"\"\"\n        nu = np.array(wavenumbers_cm, dtype=np.float64)\n        \n        if nu.size == 0:\n            return 0.0\n\n        # Argument of the exponential, a dimensionless quantity x = hcν̃ / k_B T\n        x = (h * c * nu) / (k_B * T_K)\n\n        # Molar vibrational Helmholtz energy in J/mol\n        # A_vib = N_A * Σ [ (1/2)hcν̃_i + k_B T ln(1 - exp(-x_i)) ]\n        # composed of Zero-Point Vibrational Energy (ZPVE) and a thermal term.\n        \n        # ZPVE part per mole in J/mol\n        zpve_per_mol = 0.5 * N_A * h * c * np.sum(nu)\n        \n        # Thermal contribution part per mole in J/mol.\n        # np.log1p(-np.exp(-x)) is used for numerical stability, computing log(1 - exp(-x)).\n        thermal_contrib_per_mol = N_A * k_B * T_K * np.sum(np.log1p(-np.exp(-x)))\n        \n        A_vib_J_per_mol = zpve_per_mol + thermal_contrib_per_mol\n        \n        # Convert from J/mol to kJ/mol\n        return A_vib_J_per_mol / 1000.0\n\n    test_cases = [\n        # Case 1: Ammonia co-adsorption\n        {\n            \"T\": 298.15,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -5000.0, \"BH+\": -40000.0,\n                \"ZHB\": -105500.0, \"Z_BH+\": -104600.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3400, 3300, 3200, 1600, 1100, 950],\n                \"BH+\": [3200, 3100, 3000, 1500, 1100, 900],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 350, 300, 200, 150],\n                \"Z_BH+\": [3200, 3000, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 350, 250]\n            }\n        },\n        # Case 2: Water co-adsorption\n        {\n            \"T\": 298.15,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -3000.0, \"BH+\": -38000.0,\n                \"ZHB\": -103200.0, \"Z_BH+\": -101900.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3755, 3657, 1595, 1200, 800, 400],\n                \"BH+\": [3550, 3400, 1690, 1100, 900, 700],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 320, 280, 220, 180],\n                \"Z_BH+\": [3300, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 460, 420, 380, 300, 200]\n            }\n        },\n        # Case 3: Methylamine co-adsorption\n        {\n            \"T\": 298.15,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -4500.0, \"BH+\": -39500.0,\n                \"ZHB\": -104700.0, \"Z_BH+\": -103500.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3400, 3300, 3000, 1600, 1450, 1100],\n                \"BH+\": [3200, 3000, 1500, 1400, 1100, 950],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 300, 250, 200, 100],\n                \"Z_BH+\": [3200, 3000, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 350, 250, 120]\n            }\n        },\n        # Case 4: Pyridine co-adsorption\n        {\n            \"T\": 500.0,\n            \"energies\": {\n                \"ZH\": -100000.0, \"Z_\": -63800.0, \"B\": -8000.0, \"BH+\": -42000.0,\n                \"ZHB\": -108100.0, \"Z_BH+\": -106900.0\n            },\n            \"wavenumbers\": {\n                \"ZH\": [3600, 1400, 1100, 800, 700, 600, 500, 450, 400, 300],\n                \"Z_\": [1100, 900, 800, 700, 600, 500, 450, 400],\n                \"B\": [3100, 1600, 1500, 1200, 1000, 800],\n                \"BH+\": [3200, 1600, 1500, 1200, 1000, 900],\n                \"ZHB\": [3600, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 350, 300, 250, 200],\n                \"Z_BH+\": [3200, 3000, 1500, 1400, 1100, 1000, 900, 800, 700, 600, 500, 450, 400, 300, 250]\n            }\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        E = case[\"energies\"]\n        nu = case[\"wavenumbers\"]\n\n        # Calculate A_vib for all six species\n        A = {key: calculate_A_vib(val, T) for key, val in nu.items()}\n\n        # Calculate Delta DPE = Delta E_elec + Delta A_vib\n        # Delta E_elec = DPE_elec(complex) - DPE_elec(vacuum)\n        dpe_elec_complex = E[\"Z_BH+\"] - E[\"ZHB\"]\n        dpe_elec_vacuum = (E[\"Z_\"] + E[\"BH+\"]) - (E[\"ZH\"] + E[\"B\"])\n        delta_E_elec = dpe_elec_complex - dpe_elec_vacuum\n\n        # Delta A_vib = DPE_vib(complex) - DPE_vib(vacuum)\n        dpe_vib_complex = A[\"Z_BH+\"] - A[\"ZHB\"]\n        dpe_vib_vacuum = (A[\"Z_\"] + A[\"BH+\"]) - (A[\"ZH\"] + A[\"B\"])\n        delta_A_vib = dpe_vib_complex - dpe_vib_vacuum\n        \n        delta_DPE = delta_E_elec + delta_A_vib\n        \n        results.append(round(delta_DPE, 3))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}