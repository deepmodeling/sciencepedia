{
    "hands_on_practices": [
        {
            "introduction": "由于金属有机框架（MOF）具有周期性结构，对其进行精确建模在计算上要求很高。簇模型通过聚焦于局部活性位点，提供了一种实用的近似方法。本练习  将指导您构建这样一个模型，并使用经典势函数计算吸附能，从而让您深入理解计算成本与模型精度之间的权衡。",
            "id": "3889300",
            "problem": "您正在对金属有机框架 (MOF) HKUST-1 中的开放金属位点 (OMS) 的吸附进行建模，重点是铜基位点。从玻恩–奥本海默近似出发，吸附能定义为吸附物结合体系与分离的参考态之间的基态势能差。通过用局部化的封端基团替换延展的连接体，构建该位点的簇模型表示，并将吸附能近似为吸附物与簇之间的对相互作用之和，再加上与封端基团相关的形变惩罚。然后，针对一组情景，计算相对于给定周期性基准的吸附能变化。\n\n您的程序必须实现以下模型假设和常数，并以物理上和数值上一致的单位表示：\n\n- 簇模型代表一个铜桨轮结构，包含两个铜原子和四个赤道氧原子。将第一个铜原子置于 $(0,0,0)$，第二个铜原子沿 $z$ 轴置于 $(0,0,d_{\\mathrm{Cu{-}Cu}})$，其中 $d_{\\mathrm{Cu{-}Cu}} = 2.64\\,\\mathrm{\\AA}$。赤道氧原子位于 $(\\pm r_{\\mathrm{Cu{-}O}},0,z_{\\mathrm{eq}})$ 和 $(0,\\pm r_{\\mathrm{Cu{-}O}},z_{\\mathrm{eq}})$，其中 $r_{\\mathrm{Cu{-}O}} = 1.95\\,\\mathrm{\\AA}$ 且 $z_{\\mathrm{eq}} = 1.32\\,\\mathrm{\\AA}$。两个封端氧原子位于 $(x_{\\mathrm{cap}},0,z_{\\mathrm{eq}})$ 和 $(-x_{\\mathrm{cap}},0,z_{\\mathrm{eq}})$，其中 $x_{\\mathrm{cap}} = 5.00\\,\\mathrm{\\AA}$。\n- 吸附物为一氧化碳 (CO)，通过碳原子与第一个铜原子结合。将碳原子置于 $(r_{\\mathrm{Cu{-}C}},0,0)$，氧原子置于 $(r_{\\mathrm{Cu{-}C}} + \\ell_{\\mathrm{C{-}O}},0,0)$，其中 $\\ell_{\\mathrm{C{-}O}} = 1.128\\,\\mathrm{\\AA}$。\n- 原子部分电荷（以基本电荷 $e$ 为单位）为：铜 $+1.0$，赤道氧 $-0.5$，封端氧 $-0.8$，吸附物碳 $+0.2$，吸附物氧 $-0.2$。\n- 吸附物与簇之间的非键相互作用被建模为静电和范德华贡献之和。使用库仑常数 $k_{\\mathrm{e}} = 14.399645478\\,\\mathrm{eV}\\,\\mathrm{\\AA}\\,e^{-2}$ 和各原子类型的兰纳-琼斯参数 $(\\sigma,\\varepsilon)$，并采用洛伦兹-贝特洛混合规则：$\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$ 和 $\\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}$。兰纳-琼斯能量为 $U_{ij}^{\\mathrm{LJ}}(r) = 4\\varepsilon_{ij}\\left[(\\sigma_{ij}/r)^{12} - (\\sigma_{ij}/r)^6\\right]$。静电能量为 $U_{ij}^{\\mathrm{Coul}}(r) = k_{\\mathrm{e}}\\,q_i q_j / r$。\n- 兰纳-琼斯基本参数（单位为 $\\mathrm{\\AA}$ 和 $\\mathrm{eV}$）：铜 $\\sigma = 2.338$，$\\varepsilon = 0.010$；赤道氧 $\\sigma = 3.000$，$\\varepsilon = 0.008$；吸附物碳 $\\sigma = 3.550$，$\\varepsilon = 0.003$；吸附物氧 $\\sigma = 3.120$，$\\varepsilon = 0.006$。\n- 封端氧的兰纳-琼斯参数 $\\varepsilon$ 取决于封端基团：甲酸根 $\\varepsilon = 0.010$，乙酸根 $\\varepsilon = 0.012$，苯甲酸根 $\\varepsilon = 0.014$，所有情况下 $\\sigma = 3.000\\,\\mathrm{\\AA}$。\n- 形变惩罚 $E_{\\mathrm{def}}$ 用于说明簇模型与周期性体系力学响应之间的差异：甲酸根 $E_{\\mathrm{def}} = 0.050\\,\\mathrm{eV}$，乙酸根 $E_{\\mathrm{def}} = 0.080\\,\\mathrm{eV}$，苯甲酸根 $E_{\\mathrm{def}} = 0.120\\,\\mathrm{eV}$。\n\n从吸附能是在零温下的势能差（忽略零点能和熵项）这一基本定义出发，利用上述吸附物与簇原子之间的对相互作用构建吸附物结合态的簇能量，加上适当的形变惩罚，并定义簇相对于非相互作用参考态的吸附能。对于每种情景，给定一个周期性基准吸附能，计算其变化量 $\\Delta E_{\\mathrm{ads}} = E_{\\mathrm{ads}}^{\\mathrm{cluster}} - E_{\\mathrm{ads}}^{\\mathrm{periodic}}$。\n\n实现您的程序以评估以下测试集，其中每个案例都是一个元组，包含封端基团、铜-碳距离和周期性基准吸附能，所有单位均已指定：\n- 案例 1：封端基团“formate”，$r_{\\mathrm{Cu{-}C}} = 2.000\\,\\mathrm{\\AA}$，$E_{\\mathrm{ads}}^{\\mathrm{periodic}} = -0.450\\,\\mathrm{eV}$。\n- 案例 2：封端基团“acetate”，$r_{\\mathrm{Cu{-}C}} = 2.400\\,\\mathrm{\\AA}$，$E_{\\mathrm{ads}}^{\\mathrm{periodic}} = -0.300\\,\\mathrm{eV}$。\n- 案例 3：封端基团“benzoate”，$r_{\\mathrm{Cu{-}C}} = 3.500\\,\\mathrm{\\AA}$，$E_{\\mathrm{ads}}^{\\mathrm{periodic}} = -0.050\\,\\mathrm{eV}$。\n- 案例 4：封端基团“formate”，$r_{\\mathrm{Cu{-}C}} = 6.000\\,\\mathrm{\\AA}$，$E_{\\mathrm{ads}}^{\\mathrm{periodic}} = -0.010\\,\\mathrm{eV}$。\n\n您的程序应输出四个案例的 $\\Delta E_{\\mathrm{ads}}$ 值列表（单位为 $\\mathrm{eV}$），四舍五入到 $6$ 位小数，并以单行形式输出：一个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是一个具有 $6$ 位小数的浮点数，单位为 $\\mathrm{eV}$。",
            "solution": "该问题要求计算在 HKUST-$1$ 金属有机框架的铜位点上吸附一氧化碳 ($CO$) 时，一个简化的簇模型与周期性基准计算之间的吸附能变化量 $\\Delta E_{\\mathrm{ads}}$。\n在指定的簇模型中，吸附能 $E_{\\mathrm{ads}}^{\\mathrm{cluster}}$ 定义为吸附物 ($CO$) 与簇原子之间的总相互作用能，加上一个形变惩罚 $E_{\\mathrm{def}}$，该惩罚项取决于所选的封端基团。\n$$E_{\\mathrm{ads}}^{\\mathrm{cluster}} = E_{\\mathrm{interaction}} + E_{\\mathrm{def}}$$\n最终要计算的量是相对于给定周期性基准能量 $E_{\\mathrm{ads}}^{\\mathrm{periodic}}$ 的差值：\n$$\\Delta E_{\\mathrm{ads}} = E_{\\mathrm{ads}}^{\\mathrm{cluster}} - E_{\\mathrm{ads}}^{\\mathrm{periodic}}$$\n\n相互作用能 $E_{\\mathrm{interaction}}$ 是通过对所有吸附物原子 $i$ 和所有簇原子 $j$ 的对势进行求和计算得出的。每个对相互作用是库仑静电项和兰纳-琼斯 ($LJ$) 范德华项之和。\n$$E_{\\mathrm{interaction}} = \\sum_{i \\in \\text{adsorbate}} \\sum_{j \\in \\text{cluster}} \\left( U_{ij}^{\\mathrm{Coul}}(r_{ij}) + U_{ij}^{\\mathrm{LJ}}(r_{ij}) \\right)$$\n其中 $r_{ij}$ 是原子 $i$ 和 $j$ 之间的距离。\n\n库仑势由下式给出：\n$$U_{ij}^{\\mathrm{Coul}}(r_{ij}) = \\frac{k_{\\mathrm{e}} q_i q_j}{r_{ij}}$$\n其中库仑常数 $k_{\\mathrm{e}} = 14.399645478\\,\\mathrm{eV}\\,\\mathrm{\\AA}\\,e^{-2}$，$q_i, q_j$ 是以基本电荷 $e$ 为单位的部分电荷。\n\n兰纳-琼斯势由下式给出：\n$$U_{ij}^{\\mathrm{LJ}}(r_{ij}) = 4\\varepsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6}\\right]$$\n对于异核原子对，组合参数 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$ 是通过使用基本原子参数 $\\sigma_i, \\varepsilon_i$ 和 $\\sigma_j, \\varepsilon_j$ 的洛伦兹-贝特洛混合规则确定的：\n$$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}$$\n$$\\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}$$\n\n计算过程包括以下步骤：\n$1$. 为每个测试案例定义簇和吸附物中所有原子的笛卡尔坐标。\n$2$. 定义每种原子类型的物理参数（部分电荷、兰纳-琼斯 $\\sigma$ 和 $\\varepsilon$）。\n$3$. 对于每个测试案例，遍历所有 $2 \\times 8 = 16$ 对吸附物-簇原子。\n$4$. 对于每一对原子，计算原子间距离 $r_{ij}$ 并计算相应的 $U_{ij}^{\\mathrm{Coul}}$ 和 $U_{ij}^{\\mathrm{LJ}}$。\n$5$. 将这些能量相加，得到总的 $E_{\\mathrm{interaction}}$。\n$6$. 加上相应的形变惩罚 $E_{\\mathrm{def}}$ 以求得 $E_{\\mathrm{ads}}^{\\mathrm{cluster}}$。\n$7$. 减去提供的 $E_{\\mathrm{ads}}^{\\mathrm{periodic}}$ 以获得最终的 $\\Delta E_{\\mathrm{ads}}$。\n\n原子坐标以埃（$\\mathrm{\\AA}$）为单位指定。簇由 $8$ 个原子组成：\n-   两个铜原子 ($Cu$)：$Cu_1$ 位于 $(0,0,0)$，$Cu_2$ 位于 $(0,0,d_{\\mathrm{Cu{-}Cu}})$，其中 $d_{\\mathrm{Cu{-}Cu}} = 2.64\\,\\mathrm{\\AA}$。\n-   四个赤道氧原子 ($O_{\\mathrm{eq}}$)：位于 $(\\pm r_{\\mathrm{Cu{-}O}}, 0, z_{\\mathrm{eq}})$ 和 $(0, \\pm r_{\\mathrm{Cu{-}O}}, z_{\\mathrm{eq}})$，其中 $r_{\\mathrm{Cu{-}O}} = 1.95\\,\\mathrm{\\AA}$ 且 $z_{\\mathrm{eq}} = 1.32\\,\\mathrm{\\AA}$。\n-   两个封端氧原子 ($O_{\\mathrm{cap}}$)：位于 $(\\pm x_{\\mathrm{cap}}, 0, z_{\\mathrm{eq}})$，其中 $x_{\\mathrm{cap}} = 5.00\\,\\mathrm{\\AA}$。\n\n吸附物是一个一氧化碳分子 ($CO$)，由 $2$ 个原子组成：\n-   一个碳原子 ($C$)：位于 $(r_{\\mathrm{Cu{-}C}}, 0, 0)$。\n-   一个氧原子 ($O$)：位于 $(r_{\\mathrm{Cu{-}C}} + \\ell_{\\mathrm{C{-}O}}, 0, 0)$，其中 $\\ell_{\\mathrm{C{-}O}} = 1.128\\,\\mathrm{\\AA}$。\n距离 $r_{\\mathrm{Cu{-}C}}$ 是每个测试案例中指定的变量。\n\n计算参数如下：\n部分电荷（以 $e$ 为单位）：\n-   $q_{\\mathrm{Cu}} = +1.0$\n-   $q_{\\mathrm{O,eq}} = -0.5$\n-   $q_{\\mathrm{O,cap}} = -0.8$\n-   $q_{\\mathrm{C,ads}} = +0.2$\n-   $q_{\\mathrm{O,ads}} = -0.2$\n\n兰纳-琼斯基本参数（$\\sigma$ 单位为 $\\mathrm{\\AA}$，$\\varepsilon$ 单位为 $\\mathrm{eV}$）：\n-   铜 ($Cu$)：$\\sigma = 2.338$，$\\varepsilon = 0.010$\n-   赤道氧 ($O_{\\mathrm{eq}}$)：$\\sigma = 3.000$，$\\varepsilon = 0.008$\n-   吸附物碳 ($C_{\\mathrm{ads}}$)：$\\sigma = 3.550$，$\\varepsilon = 0.003$\n-   吸附物氧 ($O_{\\mathrm{ads}}$)：$\\sigma = 3.120$，$\\varepsilon = 0.006$\n-   封端氧 ($O_{\\mathrm{cap}}$)：所有基团的 $\\sigma = 3.000$。$\\varepsilon$ 参数取决于封端基团。\n\n封端基团相关参数（$\\varepsilon$ 单位为 $\\mathrm{eV}$，$E_{\\mathrm{def}}$ 单位为 $\\mathrm{eV}$）：\n-   甲酸根：$\\varepsilon_{\\mathrm{O,cap}} = 0.010$，$E_{\\mathrm{def}} = 0.050$\n-   乙酸根：$\\varepsilon_{\\mathrm{O,cap}} = 0.012$，$E_{\\mathrm{def}} = 0.080$\n-   苯甲酸根：$\\varepsilon_{\\mathrm{O,cap}} = 0.014$，$E_{\\mathrm{def}} = 0.120$\n\n该算法将被实现以处理提供的四个测试案例，为每个情景计算 $\\Delta E_{\\mathrm{ads}}$，并以指定格式呈现结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\nclass AdsorptionEnergyModel:\n    \"\"\"\n    Models the adsorption energy of CO on a copper-based MOF cluster.\n    \"\"\"\n    # Physical constants\n    K_E = 14.399645478  # eV * Angstrom / e^2\n\n    # Cluster geometry constants\n    D_CU_CU = 2.64\n    R_CU_O = 1.95\n    Z_EQ = 1.32\n    X_CAP = 5.00\n\n    # Adsorbate geometry constant\n    L_C_O = 1.128\n\n    # Base atomic parameters (charge q, LJ sigma, LJ epsilon)\n    PARAMS = {\n        'Cu': {'q': 1.0, 'sigma': 2.338, 'eps': 0.010},\n        'O_eq': {'q': -0.5, 'sigma': 3.000, 'eps': 0.008},\n        'C_ads': {'q': 0.2, 'sigma': 3.550, 'eps': 0.003},\n        'O_ads': {'q': -0.2, 'sigma': 3.120, 'eps': 0.006},\n    }\n\n    # Capping group dependent parameters\n    CAPPING_PARAMS = {\n        'formate': {'eps_cap': 0.010, 'E_def': 0.050},\n        'acetate': {'eps_cap': 0.012, 'E_def': 0.080},\n        'benzoate': {'eps_cap': 0.014, 'E_def': 0.120},\n    }\n    O_CAP_BASE_PARAMS = {'q': -0.8, 'sigma': 3.000}\n\n    def __init__(self, capping_group, r_cu_c):\n        \"\"\"\n        Initializes the model for a specific scenario.\n\n        Args:\n            capping_group (str): The name of the capping group.\n            r_cu_c (float): The distance between the binding Cu and adsorbate C.\n        \"\"\"\n        if capping_group not in self.CAPPING_PARAMS:\n            raise ValueError(f\"Unknown capping group: {capping_group}\")\n        self.capping_group = capping_group\n        self.r_cu_c = r_cu_c\n        \n        self.cluster_atoms = self._build_cluster()\n        self.adsorbate_atoms = self._build_adsorbate()\n        self.e_def = self.CAPPING_PARAMS[self.capping_group]['E_def']\n\n    def _build_cluster(self):\n        \"\"\"Constructs the list of atoms in the cluster.\"\"\"\n        cap_params = self.CAPPING_PARAMS[self.capping_group]\n        o_cap_eps = cap_params['eps_cap']\n        \n        atoms = [\n            {'params': self.PARAMS['Cu'], 'pos': np.array([0.0, 0.0, 0.0])},\n            {'params': self.PARAMS['Cu'], 'pos': np.array([0.0, 0.0, self.D_CU_CU])},\n            {'params': self.PARAMS['O_eq'], 'pos': np.array([self.R_CU_O, 0.0, self.Z_EQ])},\n            {'params': self.PARAMS['O_eq'], 'pos': np.array([-self.R_CU_O, 0.0, self.Z_EQ])},\n            {'params': self.PARAMS['O_eq'], 'pos': np.array([0.0, self.R_CU_O, self.Z_EQ])},\n            {'params': self.PARAMS['O_eq'], 'pos': np.array([0.0, -self.R_CU_O, self.Z_EQ])},\n            {'params': {**self.O_CAP_BASE_PARAMS, 'eps': o_cap_eps}, 'pos': np.array([self.X_CAP, 0.0, self.Z_EQ])},\n            {'params': {**self.O_CAP_BASE_PARAMS, 'eps': o_cap_eps}, 'pos': np.array([-self.X_CAP, 0.0, self.Z_EQ])},\n        ]\n        return atoms\n\n    def _build_adsorbate(self):\n        \"\"\"Constructs the list of atoms in the adsorbate.\"\"\"\n        atoms = [\n            {'params': self.PARAMS['C_ads'], 'pos': np.array([self.r_cu_c, 0.0, 0.0])},\n            {'params': self.PARAMS['O_ads'], 'pos': np.array([self.r_cu_c + self.L_C_O, 0.0, 0.0])},\n        ]\n        return atoms\n\n    def _calculate_pair_interaction(self, atom1, atom2):\n        \"\"\"Calculates the Coulomb and LJ interaction energy for a pair of atoms.\"\"\"\n        p1 = atom1['params']\n        p2 = atom2['params']\n        \n        dist = np.linalg.norm(atom1['pos'] - atom2['pos'])\n        \n        # Coulomb interaction\n        u_coulomb = self.K_E * p1['q'] * p2['q'] / dist\n        \n        # Lennard-Jones interaction with Lorentz-Berthelot mixing rules\n        sigma_ij = (p1['sigma'] + p2['sigma']) / 2.0\n        eps_ij = math.sqrt(p1['eps'] * p2['eps'])\n        \n        sigma_over_r = sigma_ij / dist\n        sigma_over_r_6 = sigma_over_r**6\n        sigma_over_r_12 = sigma_over_r_6**2\n        \n        u_lj = 4.0 * eps_ij * (sigma_over_r_12 - sigma_over_r_6)\n        \n        return u_coulomb + u_lj\n\n    def calculate_cluster_adsorption_energy(self):\n        \"\"\"Calculates the total adsorption energy for the cluster model.\"\"\"\n        e_interaction = 0.0\n        for ads_atom in self.adsorbate_atoms:\n            for clu_atom in self.cluster_atoms:\n                e_interaction += self._calculate_pair_interaction(ads_atom, clu_atom)\n                \n        e_ads_cluster = e_interaction + self.e_def\n        return e_ads_cluster\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (capping_group, r_Cu-C, E_ads_periodic).\n    test_cases = [\n        (\"formate\", 2.000, -0.450),\n        (\"acetate\", 2.400, -0.300),\n        (\"benzoate\", 3.500, -0.050),\n        (\"formate\", 6.000, -0.010),\n    ]\n\n    results = []\n    for capping_group, r_cu_c, e_ads_periodic in test_cases:\n        # Instantiate the model for the current case\n        model = AdsorptionEnergyModel(capping_group=capping_group, r_cu_c=r_cu_c)\n        \n        # Calculate cluster adsorption energy\n        e_ads_cluster = model.calculate_cluster_adsorption_energy()\n        \n        # Calculate the change relative to the periodic benchmark\n        delta_e_ads = e_ads_cluster - e_ads_periodic\n        \n        results.append(delta_e_ads)\n\n    # Format the output string as required\n    output_str = f\"[{','.join([f'{val:.6f}' for val in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "催化剂的性能不仅取决于反应能垒，还取决于其活性状态的稳定性，而催化剂的活化过程（例如脱溶剂）是一个热力学过程。该过程的可行性由吉布斯自由能变（$\\Delta G$）决定，它同时包含了焓（$\\Delta H$）和熵（$\\Delta S$）的贡献。在本练习  中，您将从统计力学的基本原理出发，计算这些热力学量，从而将微观的分子性质与宏观的热力学行为联系起来。",
            "id": "3889328",
            "problem": "您正在通过移除配位的溶剂配体来模拟金属有机框架（MOF）催化剂节点的活化过程。从一个完全溶剂化的节点开始，通过移除指定数量的配体来构建一个活化模型，并量化脱溶剂化自由能的变化。使用基于配分函数的统计力学框架以及亥姆霍兹自由能和吉布斯自由能的热力学定义，推导并计算对脱溶剂化自由能（记为 $\\Delta G$）的焓贡献和熵贡献。从第一性原理开始：玻尔兹曼分布、独立自由度的配分函数、内能和熵的定义，以及热力学势之间的关系。将结合配体的平动和转动自由度视为受约束（可忽略），并通过一个电子能量差参数来捕捉活化时MOF节点的电子能量变化。对于每种配体，使用在标准压力下对理想气体的科学合理近似，来模拟自由配体的平动、转动和振动贡献。除了从这些基本基础推导出的公式外，不要假设任何简化公式。移除 $m$ 个配体将系统在指定温度和压力下从一个溶剂化节点转变为一个活化节点加上 $m$ 个自由配体。目标量是每摩尔MOF节点的总 $\\Delta G$，以 $\\mathrm{kJ/mol}$ 为单位表示，并四舍五入到三位小数。\n\n物理建模假设：\n- 对在压力 $p$ 和温度 $T$ 下的自由配体的平动贡献使用理想气体近似。\n- 将配体旋转视作由主转动惯量和转动对称数指定的非线性刚性转子。\n- 使用提供的波数，在谐振子近似下处理配体振动。\n- 将MOF结合的配体振动模式视为具有不同波数的谐振子，代表在结合状态下的受约束振动。\n- 由于强约束，忽略结合配体的平动和转动贡献；显式地包括结合振动贡献。\n- 通过提供的每摩尔MOF节点的电子能量差参数，捕捉活化时MOF节点电子能量的所有剩余变化。\n\n每个测试用例的输入是：\n- 温度 $T$，单位为 $\\mathrm{K}$。\n- 压力 $p$，单位为 $\\mathrm{Pa}$。\n- 移除的配体数量 $m$（无单位整数）。\n- 配体摩尔质量 $M$，单位为 $\\mathrm{kg/mol}$。\n- 转动对称数 $\\sigma$（无单位整数）。\n- 主转动惯量 $I_A$、$I_B$、$I_C$，单位为 $\\mathrm{kg \\cdot m^2}$（每个分子）。\n- 自由配体振动波数 $\\{\\tilde{\\nu}_i^{\\mathrm{free}}\\}$，单位为 $\\mathrm{cm^{-1}}$。\n- 结合配体振动波数 $\\{\\tilde{\\nu}_j^{\\mathrm{bound}}\\}$，单位为 $\\mathrm{cm^{-1}}$。\n- 活化时的电子能量差 $\\Delta E_{\\mathrm{elect}}$，单位为 $\\mathrm{kJ/mol}$，定义为MOF节点的电子能量变化加上任何未被理想模式处理所捕捉的配体脱离的电子贡献。\n\n您的程序必须为每个测试用例计算：\n- 总焓变 $\\Delta H$，单位为 $\\mathrm{kJ/mol}$，其来自于：$m$ 个自由配体的平动、转动和振动贡献，减去结合配体的振动贡献，再加上 $\\Delta E_{\\mathrm{elect}}$。\n- 总熵变 $\\Delta S$，单位为 $\\mathrm{J/(mol \\cdot K)}$，其来自于：$m$ 个自由配体的平动、转动和振动贡献，减去结合配体的振动贡献。\n- 脱溶剂化自由能 $\\Delta G = \\Delta H - T \\Delta S$，单位为 $\\mathrm{kJ/mol}$。\n\n单位要求：\n- 以 $\\mathrm{kJ/mol}$ 为单位表示最终的脱溶剂化自由能 $\\Delta G$，并四舍五入到三位小数。\n\n不需要角度单位。\n\n测试套件：\n为以下参数集提供结果。所有数字均以上述指定的明确单位给出。\n1. 案例 A（正常路径）：$T = 298.15$, $p = 1.01325 \\times 10^5$, $m = 2$, $M = 0.07309$, $\\sigma = 1$, $I_A = 1.5 \\times 10^{-46}$, $I_B = 2.8 \\times 10^{-46}$, $I_C = 4.1 \\times 10^{-46}$, $\\{\\tilde{\\nu}_i^{\\mathrm{free}}\\} = [300, 480, 990, 1500, 1650, 2950, 3000, 3100]$, $\\{\\tilde{\\nu}_j^{\\mathrm{bound}}\\} = [320, 520, 1040, 1520, 1700, 2960, 3010, 3120]$, $\\Delta E_{\\mathrm{elect}} = 40.0$。\n2. 案例 B（小的、受约束的配体）：$T = 298.15$, $p = 1.01325 \\times 10^5$, $m = 1$, $M = 0.01801528$, $\\sigma = 2$, $I_A = 1.93 \\times 10^{-47}$, $I_B = 1.95 \\times 10^{-47}$, $I_C = 3.85 \\times 10^{-47}$, $\\{\\tilde{\\nu}_i^{\\mathrm{free}}\\} = [1595, 3657, 3756]$, $\\{\\tilde{\\nu}_j^{\\mathrm{bound}}\\} = [1700, 3500, 3600]$, $\\Delta E_{\\mathrm{elect}} = 10.0$。\n3. 案例 C（较高温度）：$T = 600.0$, $p = 1.01325 \\times 10^5$, $m = 3$, $M = 0.03204$, $\\sigma = 1$, $I_A = 3.0 \\times 10^{-47}$, $I_B = 5.5 \\times 10^{-47}$, $I_C = 8.4 \\times 10^{-47}$, $\\{\\tilde{\\nu}_i^{\\mathrm{free}}\\} = [1033, 1470, 2840, 2920, 2960, 3000, 3650]$, $\\{\\tilde{\\nu}_j^{\\mathrm{bound}}\\} = [1050, 1500, 2850, 2930, 2970, 3010, 3600]$, $\\Delta E_{\\mathrm{elect}} = 20.0$。\n4. 案例 D（边界情况，无移除）：$T = 298.15$, $p = 1.01325 \\times 10^5$, $m = 0$, $M = 0.05000$, $\\sigma = 1$, $I_A = 2.0 \\times 10^{-46}$, $I_B = 3.0 \\times 10^{-46}$, $I_C = 4.0 \\times 10^{-46}$, $\\{\\tilde{\\nu}_i^{\\mathrm{free}}\\} = [500, 1000]$, $\\{\\tilde{\\nu}_j^{\\mathrm{bound}}\\} = [500, 1000]$, $\\Delta E_{\\mathrm{elect}} = 0.0$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含四个测试用例的脱溶剂化自由能，形式为方括号内以逗号分隔的列表，例如 $\\texttt{[x_1,x_2,x_3,x_4]}$，其中每个 $x_i$ 是一个浮点数，代表以 $\\mathrm{kJ/mol}$ 为单位并四舍五入到三位小数的 $\\Delta G$。",
            "solution": "我们从统计力学和宏观热力学开始。脱溶剂化过程将在温度 $T$ 和压力 $p$ 下，把一个带有结合配体的溶剂化节点转变为一个活化节点加上 $m$ 个自由配体。每摩尔MOF节点的脱溶剂化自由能定义为 $\\Delta G = \\Delta H - T \\Delta S$，其中 $\\Delta H$ 是焓变，$\\Delta S$ 是熵变。\n\n我们援引配分函数的可分离性，对电子、平动、转动和振动自由度的独立贡献进行建模。我们将结合配体的平动和转动模式视为受约束（可忽略），但我们包括它们的振动贡献。活化时未被简单模式处理明确捕捉的电子能量变化，被归入每摩尔的电子能量差 $\\Delta E_{\\mathrm{elect}}$ 中。\n\n基本关系：\n- 吉布斯自由能为 $G = H - T S$。\n- 焓为 $H = U + p V$。\n- 对于具有配分函数 $q$ 的可分离自由度，熵可以通过摩尔配分函数 $Q$ 计算得出：$S = R \\left( \\ln Q + T \\left( \\frac{\\partial \\ln Q}{\\partial T} \\right)_p \\right)$，内能可以通过 $U = R T^2 \\left( \\frac{\\partial \\ln Q}{\\partial T} \\right)_V$ 计算得出。我们使用从这些基础推导出的理想平动、转动和谐振动模式的标准结果。\n\n在温度 $T$ 和压力 $p$ 下，理想气体（每摩尔配体）的平动贡献：\n- 平动配分函数为 $q_{\\mathrm{trans}} = \\left( \\frac{2 \\pi m k_B T}{h^2} \\right)^{3/2} V$，其中对于在压力 $p$ 下的一摩尔气体，$V = \\frac{R T}{p}$。此处 $m$ 是单个分子的质量，$k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数。\n- 摩尔平动熵为 $S_{\\mathrm{trans}} = R \\left[ \\ln \\left( \\left( \\frac{2 \\pi m k_B T}{h^2} \\right)^{3/2} \\frac{k_B T}{p} \\right) + \\frac{5}{2} \\right]$。\n- 平动内能为 $U_{\\mathrm{trans}} = \\frac{3}{2} R T$，因此平动焓为 $H_{\\mathrm{trans}} = U_{\\mathrm{trans}} + p V = \\frac{3}{2} R T + R T = \\frac{5}{2} R T$。\n\n非线性刚性转子（每摩尔配体）的转动贡献：\n- 摩尔转动配分函数为 $q_{\\mathrm{rot}} = \\frac{\\sqrt{\\pi}}{\\sigma} \\left( \\frac{8 \\pi^2 k_B T}{h^2} \\right)^{3/2} \\sqrt{ I_A I_B I_C }$，其中 $\\sigma$ 是转动对称数，$I_A$、$I_B$、$I_C$ 是每个分子的主转动惯量。\n- 摩尔转动熵为 $S_{\\mathrm{rot}} = R \\left[ \\ln \\left( q_{\\mathrm{rot}} \\right) + \\frac{3}{2} \\right]$。\n- 摩尔转动内能为 $U_{\\mathrm{rot}} = \\frac{3}{2} R T$，因此 $H_{\\mathrm{rot}} = U_{\\mathrm{rot}}$。\n\n谐振子近似下的振动贡献：\n- 对于波数为 $\\tilde{\\nu}$ 的振动模式，特征能量为 $h c \\tilde{\\nu}$，其中 $c$ 是光速，$\\tilde{\\nu}$ 的单位是长度的倒数。\n- 定义 $x = \\frac{h c \\tilde{\\nu}}{k_B T}$，其中 $\\tilde{\\nu}$ 通过乘以 $100$ 从 $\\mathrm{cm^{-1}}$ 转换为 $\\mathrm{m^{-1}}$。\n- 单个模式的摩尔振动熵为 $S_{\\mathrm{vib, mode}} = R \\left[ \\frac{x}{\\exp(x) - 1} - \\ln \\left( 1 - \\exp(-x) \\right) \\right]$。\n- 单个模式的摩尔振动焓为 $H_{\\mathrm{vib, mode}} = \\frac{1}{2} N_A h c \\tilde{\\nu} + N_A \\frac{h c \\tilde{\\nu}}{\\exp(x) - 1}$，其中 $N_A$ 是阿伏伽德罗常数。第一项是零点能，第二项是热振动能。对所有模式求和得到 $S_{\\mathrm{vib}}$ 和 $H_{\\mathrm{vib}}$。\n\n结合配体与自由配体：\n- 对于结合配体，由于约束，平动和转动贡献被忽略。振动贡献是根据提供的结合态波数 $\\{\\tilde{\\nu}_j^{\\mathrm{bound}}\\}$ 计算的。\n- 对于自由配体，平动、转动和振动贡献是根据提供的自由态波数 $\\{\\tilde{\\nu}_i^{\\mathrm{free}}\\}$、质量 $m$（每个分子）、转动惯量 $I_A$、$I_B$、$I_C$ 和 $\\sigma$ 计算的。\n\n电子能量差：\n- 参数 $\\Delta E_{\\mathrm{elect}}$ 代表MOF节点的摩尔电子能量变化，加上任何未被理想平动、转动和振动贡献所描述的配体脱离的剩余能量效应。\n\n移除 $m$ 个配体的总变化：\n- 每个配体的差异为 $\\Delta H_{\\mathrm{lig}} = H_{\\mathrm{trans}} + H_{\\mathrm{rot}} + H_{\\mathrm{vib}}^{\\mathrm{free}} - H_{\\mathrm{vib}}^{\\mathrm{bound}}$ 和 $\\Delta S_{\\mathrm{lig}} = S_{\\mathrm{trans}} + S_{\\mathrm{rot}} + S_{\\mathrm{vib}}^{\\mathrm{free}} - S_{\\mathrm{vib}}^{\\mathrm{bound}}$。\n- 总焓变为 $\\Delta H_{\\mathrm{total}} = \\Delta E_{\\mathrm{elect}} + m \\Delta H_{\\mathrm{lig}}$。\n- 总熵变为 $\\Delta S_{\\mathrm{total}} = m \\Delta S_{\\mathrm{lig}}$。\n- 脱溶剂化自由能为 $\\Delta G = \\Delta H_{\\mathrm{total}} - T \\Delta S_{\\mathrm{total}}$。\n\n算法步骤：\n1. 对于每个测试用例，解析 $T$、$p$、$m$、$M$、$\\sigma$、$I_A$、$I_B$、$I_C$、$\\{\\tilde{\\nu}_i^{\\mathrm{free}}\\}$、$\\{\\tilde{\\nu}_j^{\\mathrm{bound}}\\}$ 和 $\\Delta E_{\\mathrm{elect}}$。\n2. 将配体的摩尔质量 $M$ 转换为单个分子的质量 $m_{\\mathrm{mol}} = \\frac{M}{N_A}$。\n3. 使用理想气体关系，在 $T$、$p$ 和 $m_{\\mathrm{mol}}$下计算 $S_{\\mathrm{trans}}$ 和 $H_{\\mathrm{trans}}$。\n4. 使用 $I_A$、$I_B$、$I_C$、$\\sigma$ 和 $T$ 计算 $q_{\\mathrm{rot}}$，然后计算 $S_{\\mathrm{rot}}$ 和 $H_{\\mathrm{rot}}$。\n5. 对于提供的自由振动波数，将每个 $\\tilde{\\nu}$ 从 $\\mathrm{cm^{-1}}$ 转换为 $\\mathrm{m^{-1}}$ 并计算 $x$，然后求和得到 $S_{\\mathrm{vib}}^{\\mathrm{free}}$ 和 $H_{\\mathrm{vib}}^{\\mathrm{free}}$。\n6. 对于提供的结合振动波数，重复上述步骤计算 $S_{\\mathrm{vib}}^{\\mathrm{bound}}$ 和 $H_{\\mathrm{vib}}^{\\mathrm{bound}}$。\n7. 形成每个配体的 $\\Delta H_{\\mathrm{lig}}$ 和 $\\Delta S_{\\mathrm{lig}}$，然后计算指定 $m$ 的 $\\Delta H_{\\mathrm{total}}$ 和 $\\Delta S_{\\mathrm{total}}$。\n8. 计算 $\\Delta G = \\Delta H_{\\mathrm{total}} - T \\Delta S_{\\mathrm{total}}$。\n9. 将 $\\Delta G$ 转换为 $\\mathrm{kJ/mol}$ 并四舍五入到三位小数。\n10. 汇总所有测试用例的结果，并将其作为单个以逗号分隔的列表打印在方括号中。\n\n科学真实性和边界情况：\n- 案例 A 代表移除两个中等重量的配体，这些配体具有多个高频振动模式，产生显著的平动和转动熵增益以及正的电子焓成本。\n- 案例 B 代表移除一个具有非平凡对称数 $\\sigma$、适中转动惯量和三个振动模式的小配体，突显了对称性对转动熵的作用。\n- 案例 C 探讨了增加的温度 $T$，测试了振动热激发以及增加的平动和转动焓改变自由能平衡的机制。\n- 案例 D 断言 $m=0$，由于没有配体被移除且 $\\Delta E_{\\mathrm{elect}} = 0$，根据构造得到 $\\Delta G = 0$。\n\n该实现直接编码了推导出的公式和常数，确保了在整个测试套件中的单位一致性和数值稳定性。",
            "answer": "```python\n# Python 3.12 program to compute desolvation free energy for MOF activation cases\n# using statistical mechanical contributions for translational, rotational, and vibrational modes.\n# Allowed libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\n# Physical constants (SI units)\nk_B = 1.380649e-23            # Boltzmann constant, J/K\nh = 6.62607015e-34            # Planck constant, J*s\nNA = 6.02214076e23            # Avogadro constant, 1/mol\nR = NA * k_B                  # Ideal gas constant, J/(mol*K)\nc = 299792458.0               # Speed of light, m/s\npi = np.pi\n\ndef vibrational_contributions(wavenumbers_cm, T):\n    \"\"\"\n    Compute molar vibrational entropy (J/mol/K) and enthalpy (J/mol)\n    in the harmonic oscillator approximation for a set of wavenumbers (cm^-1) at temperature T (K).\n    \"\"\"\n    S_vib = 0.0\n    H_vib = 0.0\n    if not wavenumbers_cm:\n        return S_vib, H_vib\n    for nu_cm in wavenumbers_cm:\n        # convert from cm^-1 to m^-1\n        nu_m = nu_cm * 100.0\n        # characteristic energy\n        eps = h * c * nu_m  # J per molecule\n        x = eps / (k_B * T)\n        # vibrational entropy per mole\n        # S = R * [ x/(exp(x)-1) - ln(1 - exp(-x)) ]\n        # guard against numerical issues for large x by using stable computations\n        if x > 700: # np.exp(709) is ~inf, but np.exp(-709) is 0\n             S_mode = 0.0\n        else:\n             expx = np.exp(x)\n             S_mode = R * (x / (expx - 1.0) - np.log(1.0 - np.exp(-x)))\n        S_vib += S_mode\n        # vibrational enthalpy per mole: zero-point + thermal\n        # H = NA * [ 0.5*eps + eps/(exp(x) - 1) ]\n        if x > 700:\n            H_mode = NA * 0.5 * eps\n        else:\n            expx = np.exp(x)\n            H_mode = NA * (0.5 * eps + eps / (expx - 1.0))\n        H_vib += H_mode\n    return S_vib, H_vib\n\ndef translational_contributions(M_molar, T, p):\n    \"\"\"\n    Compute molar translational entropy (J/mol/K) and enthalpy (J/mol)\n    for an ideal gas at temperature T (K) and pressure p (Pa).\n    M_molar: ligand molar mass in kg/mol.\n    \"\"\"\n    m_per_molecule = M_molar / NA  # kg\n    # S_trans = R [ ln( (2*pi*m*k*T/h^2)^(3/2) * (k*T/p) ) + 5/2 ]\n    factor = (2.0 * pi * m_per_molecule * k_B * T) / (h ** 2)\n    S_trans = R * (np.log((factor ** 1.5) * (k_B * T / p)) + 2.5)\n    # H_trans = 5/2 R T\n    H_trans = 2.5 * R * T\n    return S_trans, H_trans\n\ndef rotational_contributions_nonlinear(Ia, Ib, Ic, sigma, T):\n    \"\"\"\n    Compute molar rotational entropy (J/mol/K) and enthalpy (J/mol)\n    for a nonlinear rigid rotor with principal moments Ia, Ib, Ic (kg*m^2 per molecule),\n    symmetry number sigma (dimensionless), at temperature T (K).\n    \"\"\"\n    # q_rot = sqrt(pi)/sigma * (8*pi^2*k*T/h^2)^(3/2) * sqrt(Ia*Ib*Ic)\n    pref = np.sqrt(pi) / sigma\n    factor = (8.0 * (pi ** 2) * k_B * T) / (h ** 2)\n    q_rot = pref * (factor ** 1.5) * np.sqrt(Ia * Ib * Ic)\n    # S_rot = R [ ln(q_rot) + 3/2 ]\n    S_rot = R * (np.log(q_rot) + 1.5)\n    # U_rot = 3/2 R T; H_rot = U_rot\n    H_rot = 1.5 * R * T\n    return S_rot, H_rot\n\ndef compute_delta_G_case(case):\n    \"\"\"\n    Compute desolvation free energy ΔG (kJ/mol) for a given case dictionary.\n    \"\"\"\n    T = case[\"T\"]\n    p = case[\"p\"]\n    m_count = case[\"m\"]\n    M_molar = case[\"M\"]\n    sigma = case[\"sigma\"]\n    Ia = case[\"I_A\"]\n    Ib = case[\"I_B\"]\n    Ic = case[\"I_C\"]\n    freqs_free = case[\"freqs_free_cm\"]\n    freqs_bound = case[\"freqs_bound_cm\"]\n    delta_elect_kJ = case[\"delta_elect_kJ\"]\n\n    if m_count == 0:\n        return 0.0\n\n    # Contributions for free ligand\n    S_trans, H_trans = translational_contributions(M_molar, T, p)\n    S_rot, H_rot = rotational_contributions_nonlinear(Ia, Ib, Ic, sigma, T)\n    S_vib_free, H_vib_free = vibrational_contributions(freqs_free, T)\n\n    # Contributions for bound ligand (vibrational only)\n    S_vib_bound, H_vib_bound = vibrational_contributions(freqs_bound, T)\n\n    # Per-ligand differences\n    delta_H_lig_J = H_trans + H_rot + H_vib_free - H_vib_bound\n    delta_S_lig_J_per_K = S_trans + S_rot + S_vib_free - S_vib_bound\n\n    # Total changes\n    delta_H_total_J = (delta_elect_kJ * 1000.0) + m_count * delta_H_lig_J\n    delta_S_total_J_per_K = m_count * delta_S_lig_J_per_K\n\n    # ΔG = ΔH - T ΔS\n    delta_G_J = delta_H_total_J - T * delta_S_total_J_per_K\n    delta_G_kJ = delta_G_J / 1000.0\n\n    return delta_G_kJ\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 298.15,\n            \"p\": 1.01325e5,\n            \"m\": 2,\n            \"M\": 0.07309,\n            \"sigma\": 1,\n            \"I_A\": 1.5e-46,\n            \"I_B\": 2.8e-46,\n            \"I_C\": 4.1e-46,\n            \"freqs_free_cm\": [300, 480, 990, 1500, 1650, 2950, 3000, 3100],\n            \"freqs_bound_cm\": [320, 520, 1040, 1520, 1700, 2960, 3010, 3120],\n            \"delta_elect_kJ\": 40.0,\n        },\n        {\n            \"T\": 298.15,\n            \"p\": 1.01325e5,\n            \"m\": 1,\n            \"M\": 0.01801528,\n            \"sigma\": 2,\n            \"I_A\": 1.93e-47,\n            \"I_B\": 1.95e-47,\n            \"I_C\": 3.85e-47,\n            \"freqs_free_cm\": [1595, 3657, 3756],\n            \"freqs_bound_cm\": [1700, 3500, 3600],\n            \"delta_elect_kJ\": 10.0,\n        },\n        {\n            \"T\": 600.0,\n            \"p\": 1.01325e5,\n            \"m\": 3,\n            \"M\": 0.03204,\n            \"sigma\": 1,\n            \"I_A\": 3.0e-47,\n            \"I_B\": 5.5e-47,\n            \"I_C\": 8.4e-47,\n            \"freqs_free_cm\": [1033, 1470, 2840, 2920, 2960, 3000, 3650],\n            \"freqs_bound_cm\": [1050, 1500, 2850, 2930, 2970, 3010, 3600],\n            \"delta_elect_kJ\": 20.0,\n        },\n        {\n            \"T\": 298.15,\n            \"p\": 1.01325e5,\n            \"m\": 0,\n            \"M\": 0.05000,\n            \"sigma\": 1,\n            \"I_A\": 2.0e-46,\n            \"I_B\": 3.0e-46,\n            \"I_C\": 4.0e-46,\n            \"freqs_free_cm\": [500, 1000],\n            \"freqs_bound_cm\": [500, 1000],\n            \"delta_elect_kJ\": 0.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_G_kJ = compute_delta_G_case(case)\n        # Round to three decimal places\n        results.append(f\"{delta_G_kJ:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "催化研究的一个核心目标是理解并预测一系列相关反应的活性趋势。诸如Brønsted–Evans–Polanyi（BEP）原理之类的线性自由能关系为此提供了一个强大的框架，它将活化能与反应能关联起来，而在MOF中，这种内在反应性会受到其独特孔道环境的调节。在本练习  中，您将学习如何从一组催化数据中发现这种关系，并建立一个简单的物理模型来解释限域效应引起的偏差。",
            "id": "3889362",
            "problem": "要求您实现一个程序，该程序针对一组在含镍金属有机框架（Nickel Metal-Organic Framework, Ni-MOF）内发生的氢化步骤，推断出反应能与活化能之间的线性映射关系，然后量化由孔道限制效应引起的偏差。其基本物理基础始于过渡态理论（Transition State Theory, TST），该理论将速率常数与活化自由能联系起来，以及催化领域的一个观察：相关基元步骤的活化势垒通常随反应能量近似呈线性变化。多孔催化剂中的限制效应可以改变活化络合物的自由能，这主要是通过减少其可及的平动熵来实现的。请仅使用所提供的数据和下述基本原理，构建一个可复现且数值上可检验的分析。\n\n推导的基本原理：\n- 假设活化能与反应能之间存在线性关系，该关系由一个待从数据中推断的未知斜率和截距参数化。设反应能表示为 $\\,\\Delta E\\,$，活化能（势垒）表示为 $\\,\\Delta E^{\\ddagger}\\,$，二者单位均为 $\\,\\mathrm{eV}\\,$。这种线性映射是同系反应中常见的经验行为，其动机可结合能量形貌考量和 Brønsted–Evans–Polanyi 思想来解释。\n- 采用过渡态理论的速率常数 $\\,k\\,$ 关系式，即 $\\,k = \\dfrac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\dfrac{\\Delta G^{\\ddagger}}{k_{\\mathrm{B}} T}\\right)\\,$，其中 $\\,\\Delta G^{\\ddagger}\\,$ 是活化自由能，$\\,k_{\\mathrm{B}}\\,$ 是玻尔兹曼常数，$\\,T\\,$ 是温度，$\\,h\\,$ 是普朗克常数。虽然此处不直接使用速率，但这为联系能垒和自由能变化提供了热力学框架。\n- 为模拟限制效应对势垒的影响，将因可及体积减少而导致的活化络合物自由能变化近似为 $\\,\\Delta G_{\\mathrm{conf}}(T) \\approx k_{\\mathrm{B}} T \\ln\\!\\left(\\dfrac{V_{\\mathrm{ref}}}{V_{\\mathrm{pore}}}\\right)\\,$，其中 $\\,V_{\\mathrm{pore}}\\,$ 是络合物的可及孔道体积，$\\,V_{\\mathrm{ref}}\\,$ 是一个参考体积。假设对于一个特征孔道半径 $\\,r\\,$，有 $\\,V_{\\mathrm{pore}} \\propto r^{3}\\,$，则可得到 $\\,\\Delta G_{\\mathrm{conf}}(T) \\approx 3\\,k_{\\mathrm{B}} T \\ln\\!\\left(\\dfrac{r_{\\mathrm{ref}}}{r}\\right)\\,$。使用单位为 $\\,\\mathrm{eV}\\,\\mathrm{K}^{-1}\\,$ 的玻尔兹曼常数，将 $\\,\\Delta G_{\\mathrm{conf}}\\,$ 表示为每个事件的 $\\,\\mathrm{eV}\\,$ 值。\n\n数据与单位：\n- 温度 $\\,T = 300\\,\\mathrm{K}\\,$。\n- 参考孔道半径 $\\,r_{\\mathrm{ref}} = 1.6\\,\\mathrm{nm}\\,$。\n- 能量单位为 $\\,\\mathrm{eV}\\,$，半径单位为 $\\,\\mathrm{nm}\\,$，温度单位为 $\\,\\mathrm{K}\\,$。\n- 数据集包含 $\\,10\\,$ 个氢化步骤，每个步骤以元组 $\\,(\\Delta E,\\ \\Delta E^{\\ddagger},\\ r)\\,$ 的形式给出：\n  1. $\\,(-0.85,\\ 0.561,\\ 1.7)\\,$\n  2. $\\,(-0.42,\\ 0.695,\\ 1.6)\\,$\n  3. $\\,(\\phantom{-}0.00,\\ 0.842,\\ 1.8)\\,$\n  4. $\\,(\\phantom{-}0.25,\\ 0.949,\\ 1.5)\\,$\n  5. $\\,(-0.60,\\ 0.670,\\ 1.2)\\,$\n  6. $\\,(\\phantom{-}0.10,\\ 0.913,\\ 1.2)\\,$\n  7. $\\,(-1.05,\\ 0.556,\\ 0.8)\\,$\n  8. $\\,(\\phantom{-}0.35,\\ 1.016,\\ 0.8)\\,$\n  9. $\\,(-0.20,\\ 0.871,\\ 0.6)\\,$\n  10. $\\,(\\phantom{-}0.00,\\ 0.921,\\ 0.6)\\,$\n\n计算任务：\n- 在由 $\\,r \\geq 1.5\\,\\mathrm{nm}\\,$ 的低限制效应数据点组成的训练子集上，使用普通最小二乘法（OLS）拟合 $\\,\\Delta E\\,$ 和 $\\,\\Delta E^{\\ddagger}\\,$ 之间的线性映射。仅从该训练子集推断线性模型的斜率 $\\,\\alpha\\,$ 和截距 $\\,\\beta\\,$。\n- 计算 OLS 拟合的训练集均方根误差（RMSE），单位为 $\\,\\mathrm{eV}\\,$。\n- 对于完整数据集中的每个数据点，计算观测偏差 $\\,\\delta_{\\mathrm{obs}} = \\Delta E^{\\ddagger} - (\\alpha\\,\\Delta E + \\beta)\\,$，单位为 $\\,\\mathrm{eV}\\,$。\n- 对于每个数据点，计算熵限制罚项 $\\,\\Delta G_{\\mathrm{conf}} = 3\\,k_{\\mathrm{B}} T \\ln\\!\\left(\\dfrac{r_{\\mathrm{ref}}}{r}\\right)\\,$，单位为 $\\,\\mathrm{eV}\\,$，其中 $\\,k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,\\mathrm{eV}\\,\\mathrm{K}^{-1}\\,$。\n- 定义高限制效应子集为那些满足 $\\,r \\leq 0.8\\,\\mathrm{nm}\\,$ 的数据点，并在此子集上计算平均绝对差异 $\\,\\overline{|d|}\\,$，其中 $\\,d = \\delta_{\\mathrm{obs}} - \\Delta G_{\\mathrm{conf}}\\,$，单位为 $\\,\\mathrm{eV}\\,$。\n- 找出 $\\,\\Delta E = 0.00\\,\\mathrm{eV}\\,$ 且 $\\,r = 0.6\\,\\mathrm{nm}\\,$ 的边界测试用例，并计算其如上定义的差异 $\\,d\\,$，单位为 $\\,\\mathrm{eV}\\,$。\n- 判断高限制效应子集中是否至少有一半的案例满足 $\\,|d| \\leq 0.03\\,\\mathrm{eV}\\,$。将此结果以布尔值形式报告。\n\n测试套件与输出规范：\n- 使用上述数据集作为完整的测试套件。\n- 您的程序必须生成单行输出，包含一个逗号分隔的 Python 列表，其顺序和单位如下：\n  - 拟合斜率 $\\,\\alpha\\,$（浮点数，无量纲，因为是 $\\,\\mathrm{eV}/\\mathrm{eV}\\,$）。\n  - 拟合截距 $\\,\\beta\\,$（浮点数，单位为 $\\,\\mathrm{eV}\\,$）。\n  - 训练集 RMSE（浮点数，单位为 $\\,\\mathrm{eV}\\,$）。\n  - 高限制效应子集上的平均绝对差异 $\\,\\overline{|d|}\\,$（浮点数，单位为 $\\,\\mathrm{eV}\\,$）。\n  - $\\,\\Delta E = 0.00\\,\\mathrm{eV}\\,$ 且 $\\,r=0.6\\,\\mathrm{nm}\\,$ 的边界测试用例差异 $\\,d\\,$（浮点数，单位为 $\\,\\mathrm{eV}\\,$）。\n  - 上述的布尔值。\n- 所需最终输出格式示例：$\\,\\left[\\alpha,\\beta,\\mathrm{RMSE},\\overline{|d|},d,\\mathrm{boolean}\\right]\\,$，以单行形式呈现，例如 $\\,\\left[0.35,0.85,0.01,0.02,-0.005,\\mathrm{True}\\right]\\,$。您的输出必须是根据指定数据集计算出的实际值，而不是示例值。",
            "solution": "该问题被评估为有效，因为其科学基础扎根于计算催化原理，问题设定良好，拥有完整且一致的数据和定义，并且其表述是客观的。该任务需要进行多步数值分析，包括线性回归和应用一个物理模型来处理限制效应。我们将通过逐步求解来完成。\n\n该分析基于 Brønsted–Evans–Polanyi (BEP) 原理，该原理假设对于一系列同系化学反应，活化能 $\\Delta E^{\\ddagger}$ 与反应能 $\\Delta E$ 之间存在线性关系。这种经验关系表示为：\n$$\n\\Delta E^{\\ddagger} = \\alpha \\Delta E + \\beta\n$$\n其中 $\\alpha$ 是斜率，$\\beta$ 是截距。这些参数代表了内在的催化特性，独立于如孔道限制等环境因素。\n\n所提供的数据集包含 $10$ 个元组，每个元组代表一个氢化步骤及其反应能 $\\Delta E$（单位 $\\mathrm{eV}$）、活化能 $\\Delta E^{\\ddagger}$（单位 $\\mathrm{eV}$）以及特征孔道半径 $r$（单位 $\\mathrm{nm}$）。\n\n**步骤1：推断内在线性标度关系**\n\n首先，我们必须确定内在的 BEP 参数 $\\alpha$ 和 $\\beta$。这些参数是从限制效应最小的数据子集中推断出来的。问题将这个“训练子集”定义为孔道半径 $r \\geq 1.5\\,\\mathrm{nm}$ 的数据点。通过检查数据集，我们为此子集确定了以下 $4$ 个点：\n1. $(\\Delta E_1, \\Delta E^{\\ddagger}_1, r_1) = (-0.85, 0.561, 1.7)$\n2. $(\\Delta E_2, \\Delta E^{\\ddagger}_2, r_2) = (-0.42, 0.695, 1.6)$\n3. $(\\Delta E_3, \\Delta E^{\\ddagger}_3, r_3) = (0.00, 0.842, 1.8)$\n4. $(\\Delta E_4, \\Delta E^{\\ddagger}_4, r_4) = (0.25, 0.949, 1.5)$\n\n我们对该训练集中的 $(\\Delta E, \\Delta E^{\\ddagger})$ 对进行普通最小二乘（OLS）回归。令 $\\boldsymbol{x} = \\{\\Delta E_i\\}$ 且 $\\boldsymbol{y} = \\{\\Delta E^{\\ddagger}_i\\}$，其中 $i \\in \\{1, 2, 3, 4\\}$。计算斜率 $\\alpha$ 和截距 $\\beta$ 以最小化残差平方和。使用标准线性回归公式，我们得到：\n$\\alpha \\approx 0.35002852$\n$\\beta \\approx 0.85100779$\n\n**步骤2：量化拟合质量**\n\n为了评估训练数据上线性拟合的质量，我们计算均方根误差（RMSE）。RMSE 定义为观测活化能 $\\Delta E^{\\ddagger}_i$ 与线性模型预测值 $\\Delta E^{\\ddagger}_{\\text{pred}, i} = \\alpha \\Delta E_i + \\beta$ 之间平方差均值的平方根。\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{N_{\\text{train}}} \\sum_{i=1}^{N_{\\text{train}}} (\\Delta E^{\\ddagger}_i - (\\alpha \\Delta E_i + \\beta))^2}\n$$\n对于这 $4$ 个训练点，计算结果为：\n$\\text{RMSE} \\approx 0.00396440\\,\\mathrm{eV}$\n\n**步骤3：模拟限制效应**\n\n据推测，金属有机框架（MOF）纳米孔内的限制效应会改变活化能。这主要是一种熵效应。过渡态作为一个特定的构型，在更紧密的孔道中相比于反应物会损失更多可及体积（从而损失平动熵）。这会使过渡态不稳定，从而有效增大了活化势垒。问题提供了一个基于简化的“箱中粒子”模型来计算此自由能罚项 $\\Delta G_{\\mathrm{conf}}$ 的公式：\n$$\n\\Delta G_{\\mathrm{conf}} = 3 k_{\\mathrm{B}} T \\ln\\left(\\frac{r_{\\mathrm{ref}}}{r}\\right)\n$$\n其中 $k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV}\\,\\mathrm{K}^{-1}$ 是玻尔兹曼常数，$T = 300\\,\\mathrm{K}$ 是温度，$r_{\\mathrm{ref}} = 1.6\\,\\mathrm{nm}$ 是参考孔道半径。在给定温度下，热能 $k_{\\mathrm{B}} T \\approx 0.025852\\,\\mathrm{eV}$。\n\n受限环境中的总活化势垒 $\\Delta E^{\\ddagger}_{\\text{obs}}$ 是内在本征电子势垒和限制罚项之和：\n$$\n\\Delta E^{\\ddagger}_{\\text{obs}} \\approx (\\alpha \\Delta E + \\beta) + \\Delta G_{\\mathrm{conf}}\n$$\n该模型预测，相较于内BEP线的观测偏差 $\\delta_{\\mathrm{obs}} = \\Delta E^{\\ddagger}_{\\text{obs}} - (\\alpha \\Delta E + \\beta)$ 应约等于限制罚项 $\\Delta G_{\\mathrm{conf}}$。\n\n**步骤4：评估限制模型**\n\n我们现在来检验这一假设。对于完整数据集中的每个点，我们计算观测偏差 $\\delta_{\\mathrm{obs}, j}$ 和理论限制罚项 $\\Delta G_{\\mathrm{conf}, j}$。差异 $d_j = \\delta_{\\mathrm{obs}, j} - \\Delta G_{\\mathrm{conf}, j}$ 衡量了我们的组合 BEP 与限制模型与观测数据的偏离程度。\n\n我们关注“高限制效应子集”，其定义为 $r \\leq 0.8\\,\\mathrm{nm}$。该子集包括以下 $4$ 个数据点：\n7. $(\\Delta E_7, \\Delta E^{\\ddagger}_7, r_7) = (-1.05, 0.556, 0.8)$\n8. $(\\Delta E_8, \\Delta E^{\\ddagger}_8, r_8) = (0.35, 1.016, 0.8)$\n9. $(\\Delta E_9, \\Delta E^{\\ddagger}_9, r_9) = (-0.20, 0.871, 0.6)$\n10. $(\\Delta E_{10}, \\Delta E^{\\ddagger}_{10}, r_{10}) = (0.00, 0.921, 0.6)$\n\n对于这些点，我们计算差异 $d_7, d_8, d_9, d_{10}$。然后我们计算该子集的平均绝对差异 $\\overline{|d|}$：\n$$\n\\overline{|d|} = \\frac{1}{N_{\\text{high}}} \\sum_{j \\in \\{7,8,9,10\\}} |d_j|\n$$\n计算得出 $\\overline{|d|} \\approx 0.01689239\\,\\mathrm{eV}$。这个较小的值表明，限制模型为内在的 BEP 关系提供了一个合理的修正。\n\n**步骤5：特定案例分析**\n\n问题要求对这个高限制效应子集进行两项特定分析。\n\n首先，我们找出 $\\Delta E = 0.00\\,\\mathrm{eV}$ 且 $r = 0.6\\,\\mathrm{nm}$ 的边界测试用例，它对应于数据点 10。我们计算其特定差异 $d_{10}$：\n对于此点：\n$\\delta_{\\mathrm{obs}, 10} = 0.921 - (\\alpha \\cdot 0.00 + \\beta) \\approx 0.921 - 0.85100779 = 0.06999221\\,\\mathrm{eV}$\n$\\Delta G_{\\mathrm{conf}, 10} = 3 k_{\\mathrm{B}} T \\ln(1.6 / 0.6) \\approx 0.07604543\\,\\mathrm{eV}$\n$d_{10} = \\delta_{\\mathrm{obs}, 10} - \\Delta G_{\\mathrm{conf}, 10} \\approx 0.06999221 - 0.07604543 = -0.00605322\\,\\mathrm{eV}$\n\n其次，我们必须确定高限制效应子集中是否至少有一半的案例满足条件 $|d_j| \\leq 0.03\\,\\mathrm{eV}$。高限制效应子集有 $N_{\\text{high}} = 4$ 个数据点，所以我们必须检查是否至少有 $2$ 个点满足该标准。计算出的绝对差异为：\n$|d_7| \\approx 0.013583\\,\\mathrm{eV}$\n$|d_8| \\approx 0.041880\\,\\mathrm{eV}$\n$|d_9| \\approx 0.006053\\,\\mathrm{eV}$\n$|d_{10}| \\approx 0.006053\\,\\mathrm{eV}$\n\n其中三个值（$|d_7|$、$|d_9|$ 和 $|d_{10}|$）小于或等于 $0.03\\,\\mathrm{eV}$。由于 $3 \\geq 2$，条件得以满足，结果为真（True）。\n\n**结果总结**\n\n针对指定任务的最终计算值为：\n- 斜率 $\\alpha \\approx 0.35002852$\n- 截距 $\\beta \\approx 0.85100779\\,\\mathrm{eV}$\n- 训练集 RMSE $\\approx 0.00396440\\,\\mathrm{eV}$\n- 平均绝对差异 $\\overline{|d|} \\approx 0.01689239\\,\\mathrm{eV}$\n- 边界测试用例差异 $d_{10} \\approx -0.00605322\\,\\mathrm{eV}$\n- 布尔值检查：True",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational catalysis problem by performing a linear fit,\n    calculating deviations, and evaluating a confinement model.\n    \"\"\"\n    # --- Givens ---\n    # Constants\n    T = 300.0  # K\n    R_REF = 1.6  # nm\n    K_B = 8.617333262e-5  # eV/K\n\n    # Dataset: (delta_E, delta_E_ddagger, r)\n    dataset = [\n        (-0.85, 0.561, 1.7),\n        (-0.42, 0.695, 1.6),\n        (0.00, 0.842, 1.8),\n        (0.25, 0.949, 1.5),\n        (-0.60, 0.670, 1.2),\n        (0.10, 0.913, 1.2),\n        (-1.05, 0.556, 0.8),\n        (0.35, 1.016, 0.8),\n        (-0.20, 0.871, 0.6),\n        (0.00, 0.921, 0.6),\n    ]\n\n    # --- Step 1: Linear Fit on Training Subset ---\n    # Training subset is defined by r >= 1.5 nm\n    training_set = [p for p in dataset if p[2] >= 1.5]\n    \n    # Extract reaction energies (x) and activation energies (y)\n    train_delta_E = np.array([p[0] for p in training_set])\n    train_delta_E_ddagger = np.array([p[1] for p in training_set])\n\n    # Perform Ordinary Least Squares (OLS) regression using np.polyfit for a degree 1 polynomial\n    alpha, beta = np.polyfit(train_delta_E, train_delta_E_ddagger, 1)\n\n    # --- Step 2: Training RMSE ---\n    # Predict activation energies for the training set\n    predicted_train_delta_E_ddagger = alpha * train_delta_E + beta\n    \n    # Calculate the Root Mean Square Error (RMSE)\n    training_rmse = np.sqrt(np.mean((train_delta_E_ddagger - predicted_train_delta_E_ddagger)**2))\n\n    # --- Step 3  4: Deviations and Confinement Penalties for All Points ---\n    discrepancies = []\n    \n    for point in dataset:\n        delta_E, delta_E_ddagger, r = point\n\n        # Observed deviation from the BEP line\n        delta_obs = delta_E_ddagger - (alpha * delta_E + beta)\n\n        # Entropic confinement penalty\n        if r > 0:\n            delta_G_conf = 3 * K_B * T * np.log(R_REF / r)\n        else:\n            delta_G_conf = np.inf \n\n        # Discrepancy between observation and theory\n        d = delta_obs - delta_G_conf\n        discrepancies.append(d)\n\n    # --- Step 5: Mean Absolute Discrepancy for High-Confinement Subset ---\n    # High-confinement subset is defined by r = 0.8 nm\n    high_confinement_indices = [i for i, p in enumerate(dataset) if p[2] = 0.8]\n    high_confinement_discrepancies = np.array([discrepancies[i] for i in high_confinement_indices])\n    \n    mean_abs_discrepancy = np.mean(np.abs(high_confinement_discrepancies))\n\n    # --- Step 6: Boundary Case Discrepancy ---\n    # Boundary case: delta_E = 0.00 eV and r = 0.6 nm\n    boundary_case_d = 0.0\n    for i, point in enumerate(dataset):\n        if point[0] == 0.00 and point[2] == 0.6:\n            boundary_case_d = discrepancies[i]\n            break\n\n    # --- Step 7: Boolean Check ---\n    # Check if at least half of high-confinement cases satisfy |d| = 0.03 eV\n    count_satisfying_condition = np.sum(np.abs(high_confinement_discrepancies) = 0.03)\n    is_condition_met = count_satisfying_condition >= (len(high_confinement_indices) / 2.0)\n\n    # --- Final Output Assembly ---\n    results = [\n        alpha,\n        beta,\n        training_rmse,\n        mean_abs_discrepancy,\n        boundary_case_d,\n        is_condition_met,\n    ]\n\n    # Print in the specified format\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]},{results[4]},{'True' if results[5] else 'False'}]\")\n\nsolve()\n```"
        }
    ]
}