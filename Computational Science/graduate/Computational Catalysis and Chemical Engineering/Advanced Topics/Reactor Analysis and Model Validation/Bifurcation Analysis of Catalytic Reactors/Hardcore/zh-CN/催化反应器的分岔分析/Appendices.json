{
    "hands_on_practices": [
        {
            "introduction": "在对催化反应器进行任何分析时，首要任务是确定其所有可能的稳态操作点并评估其稳定性。本练习将引导你掌握这一基本技能：首先，通过数值方法求解反应器的代数平衡方程以找到稳态解；然后，构建雅可比矩阵并计算其特征值，从而对每个稳态点进行线性稳定性分析。通过这项实践，你将能够预测反应器在受到微小扰动后是会返回稳定状态，还是会发生点火或熄火等剧烈变化。",
            "id": "3870179",
            "problem": "考虑一个典型的二维无量纲连续搅拌釜反应器（CSTR）模型，该反应器处理单一不可逆、放热、一级阿伦尼乌斯动力学反应，并向恒温冷却剂进行线性散热。令无量纲反应物浓度为 $x$，无量纲反应器温度为 $y$。定义无量纲参数 $D_a$（基于进料温度的丹姆科勒数）、$\\beta$（无量纲活化温度）、$\\kappa$（无量纲热移除系数）和 $\\theta_c$（由绝热温升标度的无量纲冷却剂与进料温差）。在恒定体积流量和完美混合条件下，无量纲质量和能量平衡方程为\n$$\n\\frac{dx}{ds} = 1 - x - D_a \\, r(y) \\, x,\n$$\n$$\n\\frac{dy}{ds} = -y - \\kappa \\left(y - \\theta_c\\right) + D_a \\, r(y) \\, x,\n$$\n其中 $s$ 是无量纲时间，$r(y)$ 是参考进料温度的无量纲阿伦尼乌斯因子，\n$$\nr(y) = \\exp\\!\\left(\\frac{\\beta \\, y}{1+y}\\right),\n$$\n在 $y  -1$ 时有效。\n\n一个稳态 $(x^\\ast, y^\\ast)$ 满足\n$$\n0 = 1 - x^\\ast - D_a \\, r(y^\\ast) \\, x^\\ast,\n$$\n$$\n0 = -y^\\ast - \\kappa \\left(y^\\ast - \\theta_c\\right) + D_a \\, r(y^\\ast) \\, x^\\ast.\n$$\n对于任何稳态，定义右侧向量场的雅可比矩阵 $J$，其元素为 $J_{ij} = \\partial f_i / \\partial z_j$，在 $(x^\\ast, y^\\ast)$ 处求值，其中 $f_1(x,y) = 1 - x - D_a r(y) x$, $f_2(x,y) = -y - \\kappa (y - \\theta_c) + D_a r(y) x$，且 $(z_1,z_2) = (x,y)$。稳态的线性稳定性和类型由 $J$ 的特征值决定。\n\n您的任务是：\n- 通过求解 $y^\\ast$ 在物理上允许的定义域 $y  -1$ 上的稳态方程，然后从质量平衡中获得 $x^\\ast$，为下面列出的每个参数集计算所有稳态 $(x^\\ast,y^\\ast)$。\n- 对于找到的每个稳态，构建 $J$ 并计算其特征值。使用以下整数代码对稳态进行分类：\n    - $0$: 稳定节点（两个特征值均为实数，且实部为负）。\n    - $1$: 不稳定节点（两个特征值均为实数，且实部为正）。\n    - $2$: 鞍点（实数特征值符号相反）。\n    - $3$: 稳定螺线点（共轭复数特征值，实部为负）。\n    - $4$: 不稳定螺线点（共轭复数特征值，实部为正）。\n- 在您的解决方案中，解释每种分类对反应器操作在点燃、熄灭和振荡瞬态方面的物理意义。\n\n使用数学上合理的数值方法。为确保覆盖全面，通过扫描标量稳态残差\n$$\nh(y) = -y - \\kappa (y - \\theta_c) + \\frac{D_a \\, r(y)}{1 + D_a \\, r(y)}\n$$\n在严格位于 $y \\in (-1, y_{\\max})$ 内的有限搜索区间（其中 $y_{\\max} = 6$）上的符号变化来定位稳态，并使用稳健的区间求解器精化每个被锁定的根。在分类输出前，按 $y^\\ast$ 递增顺序对稳态进行排序。\n\n所有变量都是无量纲的，因此不需要物理单位。如果出现任何三角函数，请使用弧度作为角度单位。\n\n测试套件参数集：\n1. $(D_a, \\beta, \\kappa, \\theta_c) = (0.15, 12.0, 1.0, -0.20)$。\n2. $(D_a, \\beta, \\kappa, \\theta_c) = (2.50, 22.0, 0.20, -0.05)$。\n3. $(D_a, \\beta, \\kappa, \\theta_c) = (4.00, 30.0, 0.60, -0.10)$。\n4. $(D_a, \\beta, \\kappa, \\theta_c) = (6.00, 25.0, 1.50, -0.30)$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含所有给定参数集的分类结果，格式为一个由整数列表组成的列表，以逗号分隔，并用方括号括起来。每个内部列表必须包含为该参数集找到的所有稳态的分类代码，按 $y^\\ast$ 的升序排列。例如，一个包含两个案例的有效输出可能看起来像 $[[0],[2,0,3]]$；您的确切输出将取决于为四个指定案例计算出的稳态及其分类。",
            "solution": "该问题陈述清晰且科学上合理，代表了化学反应工程中的一个典型问题。它基于连续搅拌釜反应器（CSTR）中已确立的质量和能量守恒定律以及二维动力系统的标准稳定性分析。所有必要的参数和方程都已提供。\n\n系统动力学由两个耦合的常微分方程描述，分别针对无量纲反应物浓度 $x$ 和无量纲反应器温度 $y$：\n$$\n\\frac{dx}{ds} = f_1(x,y) = 1 - x - D_a \\, r(y) \\, x\n$$\n$$\n\\frac{dy}{ds} = f_2(x,y) = -y - \\kappa \\left(y - \\theta_c\\right) + D_a \\, r(y) \\, x\n$$\n这里，$s$ 是无量纲时间。参数包括丹姆科勒数 $D_a$、无量纲活化温度 $\\beta$、无量纲热移除系数 $\\kappa$ 和无量纲冷却剂温度 $\\theta_c$。阿伦尼乌斯反应速率项由下式给出：\n$$\nr(y) = \\exp\\!\\left(\\frac{\\beta \\, y}{1+y}\\right)\n$$\n此形式在 $y  -1$ 时有效，这对应于绝对温度大于 $0\\,\\text{K}$。\n\n稳态 $(x^\\ast, y^\\ast)$ 是时间导数为零的点。令 $\\frac{dx}{ds} = 0$ 和 $\\frac{dy}{ds} = 0$ 得到一个包含两个代数方程的系统：\n$$\n1 - x^\\ast - D_a \\, r(y^\\ast) \\, x^\\ast = 0\n$$\n$$\n-y^\\ast - \\kappa \\left(y^\\ast - \\theta_c\\right) + D_a \\, r(y^\\ast) \\, x^\\ast = 0\n$$\n从第一个方程（质量平衡），我们可以用 $y^\\ast$ 表示 $x^\\ast$：\n$$\nx^\\ast(1 + D_a \\, r(y^\\ast)) = 1 \\implies x^\\ast = \\frac{1}{1 + D_a \\, r(y^\\ast)}\n$$\n将这个 $x^\\ast$ 的表达式代入第二个方程（能量平衡），得到一个关于 $y^\\ast$ 的标量方程：\n$$\n-y^\\ast - \\kappa \\left(y^\\ast - \\theta_c\\right) + D_a \\, r(y^\\ast) \\left(\\frac{1}{1 + D_a \\, r(y^\\ast)}\\right) = 0\n$$\n这个方程定义了残差函数 $h(y^\\ast)$，其根即为稳态温度。问题给出了其定义：\n$$\nh(y) = -y - \\kappa (y - \\theta_c) + \\frac{D_a \\, r(y)}{1 + D_a \\, r(y)}\n$$\n我们通过求解 $h(y) = 0$ 来找到稳态温度 $y^\\ast$。问题指定了一种数值方法：扫描区间 $y \\in (-1, 6)$ 中 $h(y)$ 的符号变化以确定根的区间，然后使用稳健的数值求解器精炼它们。对于找到的每个 $y^\\ast$，相应的 $x^\\ast$ 从质量平衡中计算得出。\n\n每个稳态 $(x^\\ast, y^\\ast)$ 的局部稳定性是通过在该点附近对系统进行线性化来确定的。这涉及计算向量场 $(f_1, f_2)$ 的雅可比矩阵 $J$：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x}  \\frac{\\partial f_1}{\\partial y} \\\\ \\frac{\\partial f_2}{\\partial x}  \\frac{\\partial f_2}{\\partial y} \\end{pmatrix}_{(x^\\ast, y^\\ast)}\n$$\n偏导数为：\n$$\n\\frac{\\partial f_1}{\\partial x} = -1 - D_a \\, r(y)\n$$\n$$\n\\frac{\\partial f_1}{\\partial y} = -D_a \\, x \\, r'(y)\n$$\n$$\n\\frac{\\partial f_2}{\\partial x} = D_a \\, r(y)\n$$\n$$\n\\frac{\\partial f_2}{\\partial y} = -1 - \\kappa + D_a \\, x \\, r'(y)\n$$\n其中 $r'(y)$ 是 $r(y)$ 关于 $y$ 的导数：\n$$\nr'(y) = \\frac{d}{dy}\\exp\\!\\left(\\frac{\\beta \\, y}{1+y}\\right) = \\exp\\!\\left(\\frac{\\beta \\, y}{1+y}\\right) \\cdot \\frac{d}{dy}\\left(\\frac{\\beta \\, y}{1+y}\\right) = r(y) \\frac{\\beta}{(1+y)^2}\n$$\n在稳态处求值的雅可比矩阵 $J$ 的特征值 $\\lambda$ 决定了其稳定性和类型。特征值是特征方程 $\\det(J - \\lambda I) = 0$ 的根，即 $\\lambda^2 - \\text{tr}(J)\\lambda + \\det(J) = 0$。解为：\n$$\n\\lambda_{1,2} = \\frac{\\text{tr}(J) \\pm \\sqrt{\\text{tr}(J)^2 - 4\\det(J)}}{2}\n$$\n其中 $\\text{tr}(J) = J_{11} + J_{22}$ 是迹，$\\det(J) = J_{11}J_{22} - J_{12}J_{21}$ 是雅可比矩阵的行列式。判别式 $\\Delta = \\text{tr}(J)^2 - 4\\det(J)$ 决定了特征值是实数还是复数。\n\n分类如下：\n- 如果 $\\Delta \\geq 0$，特征值为实数。\n    - 如果 $\\det(J)  0$，特征值符号相反，产生一个**鞍点**（代码 $2$）。\n    - 如果 $\\det(J)  0$，特征值符号相同。如果 $\\text{tr}(J)  0$，两者都为负，形成一个**稳定节点**（代码 $0$）。如果 $\\text{tr}(J)  0$，两者都为正，形成一个**不稳定节点**（代码 $1$）。\n- 如果 $\\Delta  0$，特征值为一对共轭复数。其实部为 $\\text{tr}(J)/2$。\n    - 如果 $\\text{tr}(J)  0$，实部为负，产生一个**稳定螺线点**（代码 $3$）。\n    - 如果 $\\text{tr}(J)  0$，实部为正，产生一个**不稳定螺线点**（代码 $4$）。\n\n这些分类的物理意义是：\n- **稳定节点 (0) 和稳定螺线点 (3)** 是物理上可实现的操作点。从这种状态受到扰动的反应器将返回到该状态，或者是单调地（节点），或者是伴随阻尼振荡地（螺线点）。低温稳定态对应于低转化率（“熄灭”态），而高温稳定态对应于高转化率（“点燃”态）。\n- **不稳定节点 (1)、不稳定螺线点 (4) 和鞍点 (2)** 是不稳定的稳态。任何微小的扰动都会导致反应器状态偏离。鞍点尤其重要，因为它通常分隔了两个稳定稳态（例如，点燃态和熄灭态）的吸引盆，定义了点燃的阈值。\n\n算法流程如下：\n1. 对于每个参数集 $(D_a, \\beta, \\kappa, \\theta_c)$：\n2. 使用给定的参数定义函数 $h(y)$。\n3. 通过区间法和精炼法，在区间 $(-1, 6)$ 内数值求解 $h(y)=0$ 的所有根 $y^\\ast$。\n4. 对于每个根 $y^\\ast$：\n    a. 计算相应的浓度 $x^\\ast = 1 / (1 + D_a r(y^\\ast))$。\n    b. 在 $(x^\\ast, y^\\ast)$ 处计算雅可比矩阵 $J$ 的所有四个分量。\n    c. 计算迹 $\\text{tr}(J)$ 和行列式 $\\det(J)$。\n    d. 基于 $\\text{tr}(J)$、$\\det(J)$ 和判别式 $\\Delta = \\text{tr}(J)^2 - 4\\det(J)$ 的符号对稳态进行分类。\n5. 收集当前参数集的分类代码，按 $y^\\ast$ 递增排序。\n6. 对所有参数集重复上述步骤，并按指定格式输出最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for and classifies steady states of a CSTR for given parameter sets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.15, 12.0, 1.0, -0.20),\n        (2.50, 22.0, 0.20, -0.05),\n        (4.00, 30.0, 0.60, -0.10),\n        (6.00, 25.0, 1.50, -0.30),\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        Da, beta, kappa, theta_c = params\n\n        # Define the Arrhenius rate term and its derivative\n        def r(y):\n            # The condition y > -1 is handled by the search interval\n            return np.exp(beta * y / (1.0 + y))\n\n        # Define the steady-state residual function h(y) = 0\n        def h(y):\n            ry = r(y)\n            # Heat generation term\n            gen = Da * ry / (1.0 + Da * ry)\n            # Heat removal term (rearranged)\n            rem = y + kappa * (y - theta_c)\n            return gen - rem\n\n        # --- Step 1: Find all steady state temperatures y* ---\n        roots = set()\n        y_search_domain = np.linspace(-1.0 + 1e-9, 6.0, 5001)\n        h_values = h(y_search_domain)\n\n        for i in range(len(y_search_domain) - 1):\n            # Check for a sign change, indicating a bracketed root\n            if np.sign(h_values[i]) != np.sign(h_values[i+1]):\n                try:\n                    y_star = brentq(h, y_search_domain[i], y_search_domain[i+1])\n                    # Add root to a set to avoid duplicates from adjacent intervals\n                    roots.add(y_star)\n                except (RuntimeError, ValueError):\n                    # brentq might fail if the function is not well-behaved\n                    # or if the sign change is at an asymptote.\n                    pass\n        \n        # Sort the unique roots by increasing temperature\n        sorted_y_stars = sorted(list(roots))\n\n        # --- Step 2: Classify each steady state ---\n        case_classifications = []\n        for y_star in sorted_y_stars:\n            # Calculate corresponding steady-state concentration x*\n            r_star = r(y_star)\n            x_star = 1.0 / (1.0 + Da * r_star)\n\n            # Calculate derivative of r(y) at y*\n            r_prime_star = r_star * beta / (1.0 + y_star)**2\n\n            # Construct the Jacobian matrix elements at (x*, y*)\n            J11 = -1.0 - Da * r_star\n            J12 = -Da * x_star * r_prime_star\n            J21 = Da * r_star\n            J22 = -1.0 - kappa + Da * x_star * r_prime_star\n\n            # Calculate trace, determinant, and discriminant\n            trace = J11 + J22\n            determinant = J11 * J22 - J12 * J21\n            discriminant = trace**2 - 4.0 * determinant\n\n            classification_code = -1 # Default/error code\n\n            if discriminant >= 0:  # Real eigenvalues\n                if determinant  0:\n                    classification_code = 2  # Saddle\n                else: # determinant >= 0\n                    if trace  0:\n                        classification_code = 0  # Stable node\n                    else: # trace >= 0\n                        classification_code = 1  # Unstable node\n            else:  # Complex conjugate eigenvalues\n                if trace  0:\n                    classification_code = 3  # Stable spiral\n                else: # trace >= 0\n                    classification_code = 4  # Unstable spiral\n\n            case_classifications.append(classification_code)\n\n        all_results.append(case_classifications)\n\n    # --- Final Output Formatting ---\n    # Format: [[c11,c12,...],[c21,c22,...],...] with no spaces\n    result_str = \",\".join([f\"[{','.join(map(str, res))}]\" for res in all_results])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了基本稳态分析之后，我们进一步探讨更真实的反应动力学模型。虽然简单的阿伦尼乌斯动力学已能导致稳态多重性，但诸如Langmuir-Hinshelwood (LH) 这类更复杂的机理，会因其固有的温度依赖性吸附和解吸过程而引入更丰富的非线性行为。本练习旨在让你通过一个包含LH动力学的非等温CSTR模型，探索这种复杂性如何影响稳态多重区域的形成与形态，并实践使用多起点求解器等更稳健的数值策略来确保找到所有可能的解。",
            "id": "3870186",
            "problem": "考虑一个连续搅拌釜反应器（CSTR），用于处理单一气相反应物，在等温进料和外部冷却条件下，其表面反应遵循Langmuir–Hinshelwood（LH）动力学。该反应器在稳态进料条件下运行，由于反应放热与温度依赖性吸附及动力学的耦合，可能会表现出多重稳态。您的任务是根据第一性原理建立稳态模型，实现一种计算算法以求解所有物理上允许的稳态，并报告在指定参数体系下存在多少个不同的稳态解。\n\n基本原理：\n- 从一个体积为$V$、体积流量为$F$的充分混合CSTR的宏观摩尔衡算和能量衡算开始。设$A$为反应物，其进料浓度为$C_{Af}$，进料温度为$T_f$。用$C_A$表示反应器出口浓度，用$T$表示反应器温度。停留时间为$\\tau = V/F$。\n- 假设反应物$A$在需要空位的催化剂上进行转化的单中心Langmuir–Hinshelwood机理，其体积速率表达式为\n$$\nr(C_A,T) = k(T)\\,\\frac{K_A(T)\\,C_A}{\\left(1 + K_A(T)\\,C_A\\right)^2},\n$$\n其中$k(T)$是随温度变化的动力学系数，$K_A(T)$是随温度变化的吸附平衡参数。\n- 动力学系数遵循Arrhenius依赖关系：\n$$\nk(T) = k_0 \\exp\\left(-\\frac{E_a}{R\\,T}\\right),\n$$\n其中$k_0$是指前因子，$E_a$是活化能，$R$是普适气体常数。\n- 吸附参数遵循围绕参考温度$T_{\\mathrm{ref}}$的van 't Hoff型温度依赖关系：\n$$\nK_A(T) = K_{\\mathrm{ref}}\\exp\\left(-\\frac{\\Delta H_{\\mathrm{ads}}}{R}\\left(\\frac{1}{T}-\\frac{1}{T_{\\mathrm{ref}}}\\right)\\right),\n$$\n其中$K_{\\mathrm{ref}}$是$T_{\\mathrm{ref}}$下的吸附参数，$\\Delta H_{\\mathrm{ads}}$是吸附焓（对于放热吸附为负值）。\n- 能量衡算包括进料-产物焓变、反应放热以及向温度为$T_c$的冷却剂排热（总传热系数乘以面积再除以体积为$(U A / V)$）。设混合物密度为$\\rho$，热容为$C_p$，则稳态衡算为：\n$$\n0 = \\frac{C_{Af} - C_A}{\\tau} - r(C_A,T),\n$$\n$$\n0 = \\frac{T_f - T}{\\tau} + \\frac{-\\Delta H_{\\mathrm{rxn}}}{\\rho C_p}\\,r(C_A,T) - \\beta\\,(T - T_c),\n$$\n其中$\\Delta H_{\\mathrm{rxn}}$是每摩尔$A$的（负值）反应热，$\\beta = \\frac{U A}{\\rho C_p V}$是体积排热系数。\n\n本问题中使用的定义和单位：\n- $C_A$和$C_{Af}$的单位为$\\mathrm{mol\\,m^{-3}}$。\n- $T$、$T_f$、$T_c$和$T_{\\mathrm{ref}}$的单位为$\\mathrm{K}$。\n- $r$的单位为$\\mathrm{mol\\,m^{-3}\\,s^{-1}}$。\n- $\\tau$的单位为$\\mathrm{s}$。\n- $k_0$的单位为$\\mathrm{mol\\,m^{-3}\\,s^{-1}}$。\n- $E_a$和$\\Delta H_{\\mathrm{ads}}$的单位为$\\mathrm{J\\,mol^{-1}}$。\n- $\\Delta H_{\\mathrm{rxn}}$的单位为$\\mathrm{J\\,mol^{-1}}$。\n- $K_{\\mathrm{ref}}$和$K_A(T)$的单位为$\\mathrm{m^{3}\\,mol^{-1}}$。\n- $\\rho$的单位为$\\mathrm{kg\\,m^{-3}}$，$C_p$的单位为$\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$\\beta$的单位为$\\mathrm{s^{-1}}$，$R$的单位为$\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n算法任务：\n- 对于每个给定的参数集，计算所有求解上述耦合非线性代数方程组的物理上允许的稳态$(C_A,T)$。一个物理上允许的解必须满足$C_A \\in [0, C_{Af}]$和$T \\in [250, 1200]$ $\\mathrm{K}$。\n- 使用鲁棒的多起点非线性求根方法来定位不同的解。不同的解通过$C_A$的欧几里得容差$10^{-6}$和$T$的欧几里得容差$10^{-5}$来识别。\n- 以整数形式报告为每个参数集找到的不同物理上允许的稳态数量。\n\n科学真实性要求：\n- 参数必须对于气相催化具有科学合理性。在所有测试案例中固定通用参数为$C_{Af} = 2.0$ $\\mathrm{mol\\,m^{-3}}$，$T_f = 350$ $\\mathrm{K}$，$T_c = 300$ $\\mathrm{K}$，$\\Delta H_{\\mathrm{rxn}} = -120000$ $\\mathrm{J\\,mol^{-1}}$，$\\rho = 1.0$ $\\mathrm{kg\\,m^{-3}}$，$C_p = 1000.0$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$R = 8.314$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$k_0 = 1.0$ $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$，$K_{\\mathrm{ref}} = 2.0$ $\\mathrm{m^{3}\\,mol^{-1}}$，$T_{\\mathrm{ref}} = 350$ $\\mathrm{K}$。\n\n测试套件：\n- 提供六个参数集$(E_a, \\Delta H_{\\mathrm{ads}}, \\tau, U A / V)$，单位分别为$\\mathrm{J\\,mol^{-1}}$、$\\mathrm{J\\,mol^{-1}}$、$\\mathrm{s}$和$\\mathrm{W\\,m^{-3}\\,K^{-1}}$。能量衡算中使用的排热系数为$\\beta = (U A / V)/(\\rho C_p)$：\n    1. 案例1（基准，中等活化和吸附）：$E_a = 75000$, $\\Delta H_{\\mathrm{ads}} = -60000$, $\\tau = 100$, $U A / V = 50$。\n    2. 案例2（高活化能和强吸附）：$E_a = 110000$, $\\Delta H_{\\mathrm{ads}} = -100000$, $\\tau = 150$, $U A / V = 30$。\n    3. 案例3（高活化能，弱吸附）：$E_a = 110000$, $\\Delta H_{\\mathrm{ads}} = -20000$, $\\tau = 150$, $U A / V = 30$。\n    4. 案例4（低活化能，强吸附）：$E_a = 60000$, $\\Delta H_{\\mathrm{ads}} = -100000$, $\\tau = 150$, $U A / V = 30$。\n    5. 案例5（高活化和强吸附，强冷却）：$E_a = 110000$, $\\Delta H_{\\mathrm{ads}} = -100000$, $\\tau = 80$, $U A / V = 150$。\n    6. 案例6（中高活化和吸附，长停留时间）：$E_a = 100000$, $\\Delta H_{\\mathrm{ads}} = -80000$, $\\tau = 200$, $U A / V = 40$。\n\n答案规范：\n- 对于六个案例中的每一个，计算不同物理上允许的稳态的整数数量。\n- 不涉及角度单位；所有温度必须以$\\mathrm{K}$为单位，能量以$\\mathrm{J\\,mol^{-1}}$为单位。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[n_1,n_2,n_3,n_4,n_5,n_6]$），其中每个$n_i$是按上述顺序列出的案例$i$的整数计数。",
            "solution": "该问题要求确定一个非等温连续搅拌釜反应器（CSTR）的不同、物理上允许的稳态数量，该反应器中的催化反应遵循Langmuir-Hinshelwood（LH）动力学。这是化学反应工程中的一个经典问题，展示了稳态多样性现象。解决方案涉及从第一性原理建立控制非线性代数方程，然后使用鲁棒的计算方法进行数值求解。\n\n首先，我们建立反应器在稳态下的数学模型。该系统由两个耦合的衡算方程描述：反应物摩尔衡算和总能量衡算。\n\n反应物$A$的稳态摩尔衡算将反应消耗反应物的速率与反应物进出反应器的净速率相等同：\n$$\n\\text{A的进入速率} - \\text{A的离开速率} - \\text{A的消耗速率} = 0\n$$\n$$\nF C_{Af} - F C_A - V r(C_A, T) = 0\n$$\n两边同除以体积流量$F$，并使用停留时间定义$\\tau = V/F$，我们得到第一个控制方程：\n$$\nF_1(C_A, T) = \\frac{C_{Af} - C_A}{\\tau} - r(C_A, T) = 0\n$$\n其中$C_A$是反应器中的反应物浓度，$C_{Af}$是进料浓度，$r(C_A, T)$是单位为$\\mathrm{mol\\,m^{-3}\\,s^{-1}}$的体积反应速率。\n\n稳态能量衡算将进入反应器的焓率与离开反应器的焓率相等同，同时考虑放热反应释放的热量和外部冷却系统移除的热量：\n$$\n\\rho C_p F (T_f - T_{\\text{ref,enthalpy}}) - \\rho C_p F (T - T_{\\text{ref,enthalpy}}) + (-\\Delta H_{\\mathrm{rxn}}) V r(C_A, T) - (UA)(T - T_c) = 0\n$$\n两边同除以反应器体积$V$和项$\\rho C_p$，并使用$\\tau=V/F$和$\\beta = \\frac{U A}{\\rho C_p V}$，我们得到第二个控制方程：\n$$\nF_2(C_A, T) = \\frac{T_f - T}{\\tau} + \\frac{-\\Delta H_{\\mathrm{rxn}}}{\\rho C_p} r(C_A, T) - \\beta (T - T_c) = 0\n$$\n这里，$T$是反应器温度，$T_f$是进料温度，$T_c$是冷却剂温度，$\\Delta H_{\\mathrm{rxn}}$是摩尔反应热（放热反应为负值），$\\rho$是流体密度，$C_p$是比热容，$\\beta$是体积传热系数。\n\n反应动力学由单中心Langmuir-Hinshelwood模型描述，该模型考虑了反应物$A$在催化剂表面的吸附：\n$$\nr(C_A, T) = k(T) \\frac{K_A(T) C_A}{(1 + K_A(T) C_A)^2}\n$$\n动力学系数$k(T)$和吸附平衡常数$K_A(T)$的温度依赖性引入了强烈的非线性。动力学系数遵循Arrhenius定律，随温度呈指数增长：\n$$\nk(T) = k_0 \\exp\\left(-\\frac{E_a}{R T}\\right)\n$$\n其中$E_a$是活化能，$k_0$是指前因子，$R$是普适气体常数。吸附参数遵循van 't Hoff型关系，对于放热吸附（$\\Delta H_{\\mathrm{ads}}  0$），通常随温度升高而减小：\n$$\nK_A(T) = K_{\\mathrm{ref}} \\exp\\left(-\\frac{\\Delta H_{\\mathrm{ads}}}{R} \\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right)\n$$\n其中$\\Delta H_{\\mathrm{ads}}$是吸附焓，$K_{\\mathrm{ref}}$是在参考温度$T_{\\mathrm{ref}}$下的吸附常数。\n\n反应器的稳态是同时满足两个非线性方程$F_1(C_A, T) = 0$和$F_2(C_A, T) = 0$的解对$(C_A, T)$。由于反应速率对温度的复杂非单调依赖性（增长的$k(T)$和减少的$K_A(T)$的乘积），对于同一组操作参数可能存在多个解。\n\n为了找到所有可能的解，单起点数值求解器是不够的，因为它容易只找到一个根，具体取决于初始猜测。需要采用多起点策略。计算算法如下：\n1.  生成一个覆盖物理上允许状态的整个域的$(C_A, T)$初始猜测网格，该域定义为$C_A \\in [0, C_{Af}]$和$T \\in [250, 1200]\\,\\mathrm{K}$。\n2.  对于每个初始猜测，采用数值求根算法（具体为`scipy.optimize.root`）来求解方程组$\\vec{F}(C_A, T) = [F_1, F_2]^T = \\vec{0}$。\n3.  对求解器的每个结果进行验证。只有当求解器成功收敛且得到的$(C_A, T)$对位于指定的物理边界内时，才接受该解。\n4.  维护一个唯一解的列表。将每个新找到的有效解与所有先前存储的唯一解进行比较。只有当它与列表中任何现有解的差异不在指定的欧几里得容差（$\\Delta C_A  10^{-6}$和$\\Delta T  10^{-5}$）之内时，才被视为一个新的、不同的解并添加到列表中。\n5.  在遍历所有初始猜测后，唯一解列表中的条目总数即为给定参数集的不同、物理上允许的稳态数量。\n\n对六个指定的测试案例重复此过程，这些案例改变了参数$E_a$、$\\Delta H_{\\mathrm{ads}}$、$\\tau$和$UA/V$。固定参数为$C_{Af} = 2.0\\,\\mathrm{mol\\,m^{-3}}$，$T_f = 350\\,\\mathrm{K}$，$T_c = 300\\,\\mathrm{K}$，$\\Delta H_{\\mathrm{rxn}} = -120000\\,\\mathrm{J\\,mol^{-1}}$，$\\rho = 1.0\\,\\mathrm{kg\\,m^{-3}}$，$C_p = 1000.0\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$k_0 = 1.0\\,\\mathrm{mol\\,m^{-3}\\,s^{-1}}$，$K_{\\mathrm{ref}} = 2.0\\,\\mathrm{m^{3}\\,mol^{-1}}$，以及$T_{\\mathrm{ref}} = 350\\,\\mathrm{K}$。对于每个案例，使用$\\beta = (U A / V)/(\\rho C_p)$计算体积排热系数$\\beta$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves for the number of steady states in a CSTR with Langmuir-Hinshelwood kinetics\n    for a series of test cases.\n    \"\"\"\n\n    # --- Fixed parameters as defined in the problem statement ---\n    C_Af = 2.0  # mol/m^3\n    T_f = 350.0  # K\n    T_c = 300.0  # K\n    dH_rxn = -120000.0  # J/mol\n    rho = 1.0  # kg/m^3\n    Cp = 1000.0  # J/kg/K\n    R = 8.314  # J/mol/K\n    k0 = 1.0  # mol/m^3/s\n    K_ref = 2.0  # m^3/mol\n    T_ref = 350.0  # K\n\n    # --- Algorithmic specifications ---\n    C_A_TOL = 1e-6\n    T_TOL = 1e-5\n    C_A_BOUNDS = [0.0, C_Af]\n    T_BOUNDS = [250.0, 1200.0]\n    \n    # --- Test cases ---\n    # (Ea, dH_ads, tau, UA/V)\n    test_cases = [\n        (75000, -60000, 100, 50),\n        (110000, -100000, 150, 30),\n        (110000, -20000, 150, 30),\n        (60000, -100000, 150, 30),\n        (110000, -100000, 80, 150),\n        (100000, -80000, 200, 40),\n    ]\n\n    def k_T(T, Ea):\n        \"\"\"Calculates the Arrhenius rate constant.\"\"\"\n        return k0 * np.exp(-Ea / (R * T))\n\n    def K_A_T(T, dH_ads):\n        \"\"\"Calculates the van 't Hoff adsorption constant.\"\"\"\n        return K_ref * np.exp(-dH_ads / R * (1.0 / T - 1.0 / T_ref))\n\n    def reaction_rate(C_A, T, Ea, dH_ads):\n        \"\"\"Calculates the Langmuir-Hinshelwood reaction rate.\"\"\"\n        # Pre-check for numerical stability and physical sense\n        if C_A  0 or T = 0:\n            return np.inf\n        \n        k = k_T(T, Ea)\n        K_A = K_A_T(T, dH_ads)\n        denominator = (1.0 + K_A * C_A)**2\n        \n        if denominator  1e-12:  # Avoid division by zero\n            return np.inf\n            \n        return k * K_A * C_A / denominator\n\n    def system_of_equations(x, Ea, dH_ads, tau, beta):\n        \"\"\"Defines the system of nonlinear equations F(x) = 0.\"\"\"\n        C_A, T = x\n        \n        r = reaction_rate(C_A, T, Ea, dH_ads)\n        \n        # Mole balance equation\n        f1 = (C_Af - C_A) / tau - r\n        \n        # Energy balance equation\n        f2 = (T_f - T) / tau + (-dH_rxn / (rho * Cp)) * r - beta * (T - T_c)\n        \n        return [f1, f2]\n\n    def find_steady_states(params):\n        \"\"\"Implements the multi-start root-finding algorithm.\"\"\"\n        Ea, dH_ads, tau, U_A_per_V = params\n        beta = U_A_per_V / (rho * Cp)\n        \n        found_solutions = []\n        \n        # Create a grid of initial guesses spanning the physical domain\n        n_guesses_C = 20\n        n_guesses_T = 20\n        C_A_guesses = np.linspace(C_A_BOUNDS[0] + 1e-4, C_A_BOUNDS[1] - 1e-4, n_guesses_C)\n        T_guesses = np.linspace(T_BOUNDS[0], T_BOUNDS[1], n_guesses_T)\n        \n        for C_A0 in C_A_guesses:\n            for T0 in T_guesses:\n                initial_guess = [C_A0, T0]\n                \n                # Use scipy's root finder\n                sol = root(system_of_equations, initial_guess, \n                           args=(Ea, dH_ads, tau, beta), method='hybr', tol=1e-9)\n                \n                if sol.success:\n                    C_A_sol, T_sol = sol.x\n                    \n                    # 1. Check for physical admissibility\n                    is_admissible = (C_A_BOUNDS[0] = C_A_sol = C_A_BOUNDS[1]) and \\\n                                    (T_BOUNDS[0] = T_sol = T_BOUNDS[1])\n                    \n                    if is_admissible:\n                        # 2. Check if the solution is distinct from found ones\n                        is_distinct = True\n                        for C_A_found, T_found in found_solutions:\n                            if abs(C_A_sol - C_A_found)  C_A_TOL and abs(T_sol - T_found)  T_TOL:\n                                is_distinct = False\n                                break\n                        \n                        if is_distinct:\n                            found_solutions.append([C_A_sol, T_sol])\n                            \n        return len(found_solutions)\n\n    results = []\n    for case in test_cases:\n        num_solutions = find_steady_states(case)\n        results.append(num_solutions)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在能够确定稳态点并理解其由折叠分岔（fold bifurcation）产生和消失之后，分岔分析的下一个高级阶段是在参数空间中绘制出这些多重性区域的边界。本练习将引导你定位尖点（cusp point），这是一种更高余维的分岔，它标志着两个折叠分岔曲线的合并点，是系统整体行为的组织中心。掌握尖点的计算方法对于精确界定反应器的安全、稳健操作窗口至关重要，代表了从状态分析到参数空间分析的认知飞跃。",
            "id": "3870196",
            "problem": "考虑一个空间均匀、放热、连续搅拌釜式反应器，其在稳态下由质量和能量守恒定律控制。令无量纲浓度为 $c$，无量纲温度为 $\\theta$。采用 Arrhenius 定律的 Frank-Kamenetskii 近似，因此反应速率为 $r(c,\\theta) = c \\exp(\\beta \\theta)$，其中 $\\beta  0$ 是一个无量纲活化参数。稳态平衡方程由下式给出\n$$\nf_1(c,\\theta;\\lambda_1,\\lambda_2) = (c_f - c) - \\lambda_1\\, c \\exp(\\beta \\theta) = 0,\n$$\n$$\nf_2(c,\\theta;\\lambda_1,\\lambda_2) = (\\theta_f - \\theta) + \\alpha\\, \\lambda_1\\, c \\exp(\\beta \\theta) - \\lambda_2\\, (\\theta - \\theta_c) = 0,\n$$\n其中 $c_f  0$ 是无量纲进料浓度，$\\theta_f$ 是无量纲进料温度，$\\theta_c$ 是无量纲冷却剂温度，$\\alpha  0$ 是单位转化率的无量纲绝热温升，$\\lambda_1$ 是 Damköhler 数，$\\lambda_2$ 是无量纲排热系数。\n\n定义矢量场 $\\mathbf{f}(u;\\lambda) = \\begin{bmatrix} f_1 \\\\ f_2 \\end{bmatrix}$，其状态为 $u = (c,\\theta)$，参数为 $\\lambda = (\\lambda_1,\\lambda_2)$。它关于状态的雅可比矩阵为 $J(u;\\lambda) = \\partial \\mathbf{f}/\\partial u$。折叠点的特征是 $J$ 是奇异的且具有一维零空间。尖点是一个余维为二的简并，其中两条折叠曲线合并。就稳态矢量场而言，尖点满足以下系统\n$$\n\\mathbf{f}(u;\\lambda) = \\mathbf{0}, \\quad \\det\\big(J(u;\\lambda)\\big) = 0, \\quad w^\\top \\left(D^2 \\mathbf{f}(u)[v,v]\\right) = 0,\n$$\n其中 $v$ 和 $w$ 分别是 $J$ 的单位右零矢量和左零矢量，满足 $J v = \\mathbf{0}$、$J^\\top w = \\mathbf{0}$ 和 $w^\\top v  0$。此处 $D^2 \\mathbf{f}(u)[v,v]$ 表示 $\\mathbf{f}$ 沿方向 $v$ 的二阶方向导数的矢量。\n\n从基本守恒定律和本构关系 $r(c,\\theta)$ 出发，通过将延拓扩展到两个参数 $(\\lambda_1,\\lambda_2)$，推导一个用于定位尖点的计算程序。使用从稳态平衡中得到的恒等式，以 $(c,\\theta)$ 表示 $(\\lambda_1,\\lambda_2)$ 来消去它们，\n$$\n\\lambda_1(c,\\theta) = \\frac{c_f - c}{c \\exp(\\beta \\theta)}, \\quad \\lambda_2(c,\\theta) = \\frac{\\theta_f - \\theta + \\alpha\\,(c_f - c)}{\\theta - \\theta_c},\n$$\n前提是 $c \\in (0,c_f)$ 且 $\\theta \\ne \\theta_c$。然后通过求解以下关于 $(c,\\theta)$ 的方程来施加折叠和尖点简并条件\n$$\n\\det\\big(J(c,\\theta;\\lambda_1(c,\\theta),\\lambda_2(c,\\theta))\\big) = 0,\n$$\n$$\nw(c,\\theta)^\\top \\left(D^2 \\mathbf{f}(c,\\theta;\\lambda_1(c,\\theta),\\lambda_2(c,\\theta))[v(c,\\theta),v(c,\\theta)]\\right) = 0,\n$$\n其中 $v(c,\\theta)$ 和 $w(c,\\theta)$ 由 $J$ 在 $(c,\\theta)$ 处的奇异值分解确定。\n\n所有量均为无量纲。您的程序必须：\n- 实现上述模型和条件。\n- 对于每个测试用例，计算一个尖点 $(c^\\star,\\theta^\\star)$ 并报告相应的参数对 $(\\lambda_1^\\star,\\lambda_2^\\star)$ 以及 $(c^\\star,\\theta^\\star)$。如果在指定的搜索域中未找到尖点，则返回列表 $[\\text{nan},\\text{nan},\\text{nan},\\text{nan}]$。\n\n使用以下常数组 $(c_f,\\theta_f,\\theta_c,\\alpha,\\beta)$ 的测试套件：\n- 测试用例 1：$c_f = 1.0$, $\\theta_f = 0.2$, $\\theta_c = 0.0$, $\\alpha = 15.0$, $\\beta = 8.0$。\n- 测试用例 2：$c_f = 1.0$, $\\theta_f = 0.0$, $\\theta_c = 0.0$, $\\alpha = 20.0$, $\\beta = 10.0$。\n- 测试用例 3：$c_f = 1.0$, $\\theta_f = 0.1$, $\\theta_c = -0.05$, $\\alpha = 12.0$, $\\beta = 9.0$。\n- 边界情况 4：$c_f = 1.0$, $\\theta_f = 0.0$, $\\theta_c = 0.0$, $\\alpha = 3.0$, $\\beta = 2.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素是对应测试用例的列表 $[\\lambda_1^\\star,\\lambda_2^\\star,c^\\star,\\theta^\\star]$，顺序与上文相同。例如：$[[\\lambda_{1,1},\\lambda_{2,1},c_1,\\theta_1],[\\lambda_{1,2},\\lambda_{2,2},c_2,\\theta_2],\\ldots]$。\n\n最终的数值答案必须是浮点数。由于公式是无量纲的，因此不需要物理单位。通过验证 $c^\\star \\in (0,c_f)$、$ \\theta^\\star \\ne \\theta_c$、$\\lambda_1^\\star  0$ 和 $\\lambda_2^\\star  0$ 来确保科学真实性；否则，对于该情况返回 $[\\text{nan},\\text{nan},\\text{nan},\\text{nan}]$。",
            "solution": "用户提供了一个关于连续搅拌釜式反应器 (CSTR) 模型中尖点分岔点定位的问题。第一个强制性步骤是对问题陈述进行严格验证。\n\n### 问题验证\n\n该问题是自洽的，提供了所有必要的控制方程、参数定义、测试用例的常数值以及明确的目标。该模型基于化学反应工程中质量和能量守恒的基本原理，而分岔条件（$\\det(J)=0$ 等）是动力系统理论中的标准定义。语言精确客观。在模型背景下，所有参数都具有物理意义。该问题具有科学依据、良态且客观。它不包含矛盾、歧义或伪科学主张。\n\n**结论：** 问题有效。可以继续进行求解过程。\n\n### 计算程序的推导\n\n目标是找到尖点，它是一个状态 $(c^\\star, \\theta^\\star)$ 和相应的参数集 $(\\lambda_1^\\star, \\lambda_2^\\star)$，满足三个条件：\n$$\n\\mathbf{f}(u;\\lambda) = \\mathbf{0} \\quad (1)\n$$\n$$\n\\det\\big(J(u;\\lambda)\\big) = 0 \\quad (2)\n$$\n$$\nw^\\top \\left(D^2 \\mathbf{f}(u)[v,v]\\right) = 0 \\quad (3)\n$$\n问题建议使用稳态条件 (1) 消去参数 $\\lambda_1$ 和 $\\lambda_2$，然后求解由条件 (2) 和 (3) 构成的方程组，以解出状态变量 $c$ 和 $\\theta$。\n\n稳态平衡方程由下式给出：\n$$\nf_1(c,\\theta;\\lambda_1,\\lambda_2) = (c_f - c) - \\lambda_1\\, c e^{\\beta \\theta} = 0\n$$\n$$\nf_2(c,\\theta;\\lambda_1,\\lambda_2) = (\\theta_f - \\theta) + \\alpha\\, \\lambda_1\\, c e^{\\beta \\theta} - \\lambda_2\\, (\\theta - \\theta_c) = 0\n$$\n从第一个方程，我们可以将反应项表示为 $R = \\lambda_1 c e^{\\beta \\theta} = c_f - c$。将其代入第二个方程得到 $f_2 = (\\theta_f - \\theta) + \\alpha (c_f - c) - \\lambda_2 (\\theta - \\theta_c) = 0$。这就得出了问题陈述中提供的 $\\lambda_1(c,\\theta)$ 和 $\\lambda_2(c,\\theta)$ 的表达式：\n$$\n\\lambda_1(c,\\theta) = \\frac{c_f - c}{c e^{\\beta \\theta}}\n$$\n$$\n\\lambda_2(c,\\theta) = \\frac{\\theta_f - \\theta + \\alpha(c_f - c)}{\\theta - \\theta_c}\n$$\n\n**1. 折叠条件：$\\det(J) = 0$**\n\n矢量场 $\\mathbf{f}$ 关于状态 $u=(c,\\theta)$ 的雅可比矩阵 $J$ 是：\n$$\nJ = \\begin{bmatrix} \\frac{\\partial f_1}{\\partial c}  \\frac{\\partial f_1}{\\partial \\theta} \\\\ \\frac{\\partial f_2}{\\partial c}  \\frac{\\partial f_2}{\\partial \\theta} \\end{bmatrix} = \\begin{bmatrix} -1 - \\lambda_1 e^{\\beta \\theta}  - \\lambda_1 c \\beta e^{\\beta \\theta} \\\\ \\alpha \\lambda_1 e^{\\beta \\theta}  -1 - \\lambda_2 + \\alpha \\lambda_1 c \\beta e^{\\beta \\theta} \\end{bmatrix}\n$$\n我们代入 $\\lambda_1 e^{\\beta \\theta} = (c_f-c)/c$ 和 $\\lambda_1 c e^{\\beta \\theta} = c_f-c$：\n$$\nJ(c,\\theta) = \\begin{bmatrix} -1 - \\frac{c_f-c}{c}  -\\beta (c_f-c) \\\\ \\alpha \\frac{c_f-c}{c}  -1 - \\lambda_2(c,\\theta) + \\alpha \\beta (c_f-c) \\end{bmatrix} = \\begin{bmatrix} -\\frac{c_f}{c}  -\\beta (c_f-c) \\\\ \\alpha \\frac{c_f-c}{c}  -1 - \\lambda_2(c,\\theta) + \\alpha \\beta (c_f-c) \\end{bmatrix}\n$$\n折叠条件是 $\\det(J)=0$：\n$$\n\\left(-\\frac{c_f}{c}\\right) \\left(-1 - \\lambda_2 + \\alpha \\beta (c_f-c)\\right) - \\left(-\\beta (c_f-c)\\right) \\left(\\alpha \\frac{c_f-c}{c}\\right) = 0\n$$\n乘以 $c$（假设 $c \\ne 0$）并化简：\n$$\nc_f(1 + \\lambda_2 - \\alpha \\beta (c_f-c)) + \\alpha \\beta (c_f-c)^2 = 0\n$$\n$$\nc_f + c_f\\lambda_2 - c_f \\alpha \\beta (c_f-c) + \\alpha \\beta(c_f-c)^2 = 0\n$$\n$$\nc_f + c_f\\lambda_2 - \\alpha \\beta (c_f-c) (c_f - (c_f-c)) = 0\n$$\n$$\nc_f + c_f\\lambda_2 - \\alpha \\beta c (c_f-c) = 0\n$$\n代入 $\\lambda_2(c,\\theta)$ 的表达式，得到我们方程组的第一个方程 $G_1(c,\\theta)=0$：\n$$\nG_1(c,\\theta) = c_f + c_f \\left( \\frac{\\theta_f - \\theta + \\alpha(c_f - c)}{\\theta - \\theta_c} \\right) - \\alpha \\beta c (c_f-c) = 0\n$$\n\n**2. 尖点条件：$w^\\top (D^2 \\mathbf{f}[v,v]) = 0$**\n\n首先，我们求出在折叠点处 $J$ 的右零矢量 $v$ 和左零矢量 $w$。由于 $\\det(J)=0$，行和列是线性相关的。\n右零矢量 $v = [v_c, v_\\theta]^\\top$ 满足 $Jv=0$。从第一行，$-\\frac{c_f}{c} v_c - \\beta(c_f-c)v_\\theta = 0$。一个有效的 $v$ 的选择是 $v \\propto [c\\beta(c_f-c), -c_f]^\\top$。\n左零矢量 $w=[w_c, w_\\theta]^\\top$ 满足 $J^\\top w=0$。从第一列，$-\\frac{c_f}{c} w_c + \\alpha\\frac{c_f-c}{c}w_\\theta = 0$。一个有效的 $w$ 的选择是 $w \\propto [\\alpha(c_f-c), c_f]^\\top$。\n\n接下来，我们计算二阶方向导数项 $D^2 \\mathbf{f}[v,v]$。其分量为 $v^\\top H_i v$，其中 $H_i$ 是 $f_i(c,\\theta)$ 的黑塞矩阵。$f_1$ 和 $f_2$ 关于 $(c,\\theta)$ 的二阶偏导数是：\n$$\n\\frac{\\partial^2 f_1}{\\partial c^2} = 0, \\quad \\frac{\\partial^2 f_1}{\\partial c \\partial \\theta} = -\\lambda_1 \\beta e^{\\beta \\theta}, \\quad \\frac{\\partial^2 f_1}{\\partial \\theta^2} = -\\lambda_1 c \\beta^2 e^{\\beta \\theta}\n$$\n$$\n\\frac{\\partial^2 f_2}{\\partial c^2} = 0, \\quad \\frac{\\partial^2 f_2}{\\partial c \\partial \\theta} = \\alpha \\lambda_1 \\beta e^{\\beta \\theta}, \\quad \\frac{\\partial^2 f_2}{\\partial \\theta^2} = \\alpha \\lambda_1 c \\beta^2 e^{\\beta \\theta}\n$$\n二次项 $w^\\top(D^2 \\mathbf{f}[v,v])$ 变为：\n$$\nw_c \\left( 2 v_c v_\\theta (-\\lambda_1 \\beta e^{\\beta \\theta}) + v_\\theta^2 (-\\lambda_1 c \\beta^2 e^{\\beta \\theta}) \\right) + w_\\theta \\left( 2 v_c v_\\theta (\\alpha\\lambda_1 \\beta e^{\\beta \\theta}) + v_\\theta^2 (\\alpha\\lambda_1 c \\beta^2 e^{\\beta \\theta}) \\right) = 0\n$$\n等等，这不正确。该矢量是 $D^2 \\mathbf{f}[v,v] = [v^T H_1 v, v^T H_2 v]^T$。表达式必须是 $w_c (v^T H_1 v) + w_\\theta (v^T H_2 v) = 0$。我们重新计算：\n$$\n(v^T H_1 v) = -(2 v_c v_\\theta \\lambda_1 \\beta e^{\\beta\\theta} + v_\\theta^2 \\lambda_1 c \\beta^2 e^{\\beta\\theta})\n$$\n$$\n(v^T H_2 v) = \\alpha (2 v_c v_\\theta \\lambda_1 \\beta e^{\\beta\\theta} + v_\\theta^2 \\lambda_1 c \\beta^2 e^{\\beta\\theta})\n$$\n尖点条件变为：\n$$\n-w_c (2 v_c v_\\theta \\lambda_1 \\beta e^{\\beta\\theta} + v_\\theta^2 \\lambda_1 c \\beta^2 e^{\\beta\\theta}) + w_\\theta \\alpha (2 v_c v_\\theta \\lambda_1 \\beta e^{\\beta\\theta} + v_\\theta^2 \\lambda_1 c \\beta^2 e^{\\beta\\theta}) = 0\n$$\n$$\n\\lambda_1 \\beta e^{\\beta\\theta} v_\\theta (2 v_c + c \\beta v_\\theta) (-w_c + \\alpha w_\\theta) = 0\n$$\n由于 $\\lambda_1, \\beta, e^{\\beta\\theta}$ 为正且 $v_\\theta = -c_f \\ne 0$，这简化为两个项的乘积为零：\n$$\n(2 v_c + c \\beta v_\\theta) (-w_c + \\alpha w_\\theta) = 0\n$$\n这意味着要么 $(2 v_c + c \\beta v_\\theta) = 0$，要么 $(-w_c + \\alpha w_\\theta) = 0$。\n代入我们的零矢量：\n情况 (a)：$2(c\\beta(c_f-c)) + c\\beta(-c_f) = 2c\\beta c_f - 2c^2\\beta - c^2\\beta c_f = c\\beta(c_f - 2c) = 0$。由于 $c,\\beta \\ne 0$，这给出 $c = c_f/2$。\n情况 (b)：$-\\alpha(c_f-c) + \\alpha(c_f) = -\\alpha c_f + \\alpha c + \\alpha c_f = \\alpha c = 0$。由于 $\\alpha0$，这给出 $c=0$，这超出了物理有效域 $(0, c_f)$。\n因此，尖点条件惊人地简化为 $c^\\star = c_f/2$。\n\n**3. 尖点的解析解**\n\n有了 $c^\\star = c_f/2$，我们可以使用折叠条件方程 $G_1(c_f/2, \\theta) = 0$ 来求解 $\\theta^\\star$：\n$$\nc_f + c_f\\lambda_2(c_f/2, \\theta) - \\alpha \\beta (c_f/2) (c_f-c_f/2) = 0\n$$\n$$\nc_f (1+\\lambda_2) - \\frac{\\alpha\\beta c_f^2}{4} = 0 \\implies 1 + \\lambda_2 = \\frac{\\alpha\\beta c_f}{4} \\implies \\lambda_2^\\star = \\frac{\\alpha\\beta c_f}{4} - 1\n$$\n为了使 $\\lambda_2^\\star$ 具有物理意义（为正），我们必须有 $\\frac{\\alpha\\beta c_f}{4}  1$，即 $\\alpha\\beta c_f  4$。如果不满足这个不等式，就不存在物理上现实的尖点。\n\n使用折叠条件方程的另一种形式来求解 $\\theta^\\star$：\n$$\nc_f + c_f \\left( \\frac{\\theta_f - \\theta + \\alpha(c_f/2)}{\\theta - \\theta_c} \\right) - \\alpha \\beta (c_f/2)(c_f/2) = 0\n$$\n$$\n1 + \\frac{\\theta_f - \\theta + \\alpha c_f/2}{\\theta - \\theta_c} = \\frac{\\alpha\\beta c_f}{4}\n$$\n$$\n\\theta_f - \\theta + \\frac{\\alpha c_f}{2} = \\left(\\frac{\\alpha\\beta c_f}{4} - 1\\right)(\\theta - \\theta_c)\n$$\n求解 $\\theta$：\n$$\n\\theta_f + \\frac{\\alpha c_f}{2} + \\theta_c\\left(\\frac{\\alpha\\beta c_f}{4} - 1\\right) = \\theta \\left(1 + \\frac{\\alpha\\beta c_f}{4} - 1\\right) = \\theta \\frac{\\alpha\\beta c_f}{4}\n$$\n$$\n\\theta^\\star = \\frac{4}{\\alpha\\beta c_f} \\left(\\theta_f + \\frac{\\alpha c_f}{2} + \\theta_c\\left(\\frac{\\alpha\\beta c_f}{4} - 1\\right)\\right) = \\frac{4\\theta_f}{\\alpha\\beta c_f} + \\frac{2}{\\beta} + \\theta_c - \\frac{4\\theta_c}{\\alpha\\beta c_f}\n$$\n$$\n\\theta^\\star = \\frac{2}{\\beta} + \\theta_c + \\frac{4(\\theta_f - \\theta_c)}{\\alpha\\beta c_f}\n$$\n最后，我们使用 $(c^\\star, \\theta^\\star)$ 从其定义中求出 $\\lambda_1^\\star$：\n$$\n\\lambda_1^\\star = \\frac{c_f - c_f/2}{(c_f/2) e^{\\beta \\theta^\\star}} = \\frac{1}{e^{\\beta \\theta^\\star}} = e^{-\\beta \\theta^\\star}\n$$\n\n**最终算法：**\n对于给定的参数集 $(c_f, \\theta_f, \\theta_c, \\alpha, \\beta)$：\n1. 验证存在性条件：$\\alpha\\beta c_f  4$。若不满足，则不存在有效的尖点。\n2. 计算尖点处的状态变量：\n   $c^\\star = c_f/2$\n   $\\theta^\\star = \\frac{2}{\\beta} + \\theta_c + \\frac{4(\\theta_f - \\theta_c)}{\\alpha \\beta c_f}$\n3. 验证非简并条件 $\\theta^\\star \\ne \\theta_c$，这是为了确保 $\\lambda_2$ 有良好定义。\n4. 如果 (1) 和 (3) 中的条件得到满足，计算分岔参数：\n   $\\lambda_1^\\star = e^{-\\beta \\theta^\\star}$\n   $\\lambda_2^\\star = \\frac{\\alpha \\beta c_f}{4} - 1$\n5. 结果是列表 $[\\lambda_1^\\star, \\lambda_2^\\star, c^\\star, \\theta^\\star]$。否则，返回 $[\\text{nan}, \\text{nan}, \\text{nan}, \\text{nan}]$。\n\n这个解析过程在计算上是精确且稳健的，并将在最终程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the cusp bifurcation point for a CSTR model for a given set of test cases.\n\n    The solution is based on an analytical derivation of the cusp conditions,\n    which simplifies to a direct formula for the cusp state (c*, θ*) and\n    bifurcation parameters (λ1*, λ2*).\n    \"\"\"\n\n    # Test suite of constant sets (c_f, θ_f, θ_c, α, β)\n    test_cases = [\n        # Test case 1\n        (1.0, 0.2, 0.0, 15.0, 8.0),\n        # Test case 2\n        (1.0, 0.0, 0.0, 20.0, 10.0),\n        # Test case 3\n        (1.0, 0.1, -0.05, 12.0, 9.0),\n        # Edge case 4\n        (1.0, 0.0, 0.0, 3.0, 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c_f, theta_f, theta_c, alpha, beta = case\n\n        # A physically meaningful cusp point exists only if α * β * c_f > 4.\n        # This ensures that λ2* > 0.\n        existence_product = alpha * beta * c_f\n        if existence_product = 4.0:\n            results.append([np.nan, np.nan, np.nan, np.nan])\n            continue\n\n        # Cusp condition simplifies to c* = c_f / 2\n        c_star = c_f / 2.0\n\n        # The fold condition then yields an explicit formula for θ*\n        theta_star = (2.0 / beta) + theta_c + (4.0 * (theta_f - theta_c)) / existence_product\n        \n        # Check validity constraints\n        # 1. c* must be in (0, c_f). c_star = c_f / 2 is always valid for c_f > 0.\n        # 2. θ* must not be equal to θ_c for λ2 to be defined.\n        if np.isclose(theta_star, theta_c):\n            results.append([np.nan, np.nan, np.nan, np.nan])\n            continue\n\n        # Calculate parameters λ1* and λ2* at the cusp point.\n        lambda_1_star = np.exp(-beta * theta_star)\n        lambda_2_star = (existence_product / 4.0) - 1.0\n\n        # 3. λ1* > 0. This is always true as it's an exponential of a real number.\n        # 4. λ2* > 0. This is guaranteed by the initial check `existence_product > 4`.\n\n        results.append([lambda_1_star, lambda_2_star, c_star, theta_star])\n\n    # Format the final output string\n    # Convert each inner list to a string representation\n    result_strings = []\n    for res in results:\n        # Format numbers to a reasonable precision for consistent output\n        formatted_res = [f\"{x:.12f}\" if not np.isnan(x) else 'nan' for x in res]\n        result_strings.append(f\"[{','.join(formatted_res)}]\")\n    \n    # a,b,c -> [[a],[b],[c]]\n    # Join the string representations of the inner lists\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}