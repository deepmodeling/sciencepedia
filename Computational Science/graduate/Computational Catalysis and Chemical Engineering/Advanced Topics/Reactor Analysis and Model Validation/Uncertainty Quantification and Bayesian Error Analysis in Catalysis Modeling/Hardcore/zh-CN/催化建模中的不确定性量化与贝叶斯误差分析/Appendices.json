{
    "hands_on_practices": [
        {
            "introduction": "在多相催化等领域的物理建模中，速率常数等参数必须为正值。贝叶斯方法中一个常见的技巧是通过对数变换（例如，$k = \\exp(\\eta)$）对此类参数进行重参数化，并在无约束的对数尺度上（$\\eta$）设定先验分布。此练习  将指导您从第一性原理出发，推导当对数变换后的参数服从高斯先验时，原始正值参数所对应的先验分布（对数正态分布）及其关键矩，这对于在分层模型中正确设定先验信念至关重要。",
            "id": "3904099",
            "problem": "在多相催化的微动力学建模 (MKM) 中，每个基元步骤都由一个必须为严格正值的速率常数表示。为了在强制施加正值的同时，能够进行不确定性量化 (UQ) 和贝叶斯误差分析，我们考虑重新参数化 $k=\\exp(\\eta)$，其中 $k$ 是一个速率常数，$\\eta$ 是一个无约束的潜变量。假设 $\\eta$ 的先验认知不确定性由一个高斯分布表示，即 $\\eta \\sim \\mathcal{N}(\\mu_{\\eta}, \\sigma_{\\eta}^{2})$，这反映了对数尺度上的加性模型误差。从概率密度的变量变换公式和矩的标准定义出发，推导 $k$ 的隐含先验密度以及用 $\\mu_{\\eta}$ 和 $\\sigma_{\\eta}^{2}$ 表示的前两阶矩的闭式表达式。您的推导必须从随机变量的变换法则开始，并且不得假设所得分布的任何预知形式。请将您的最终结果表示为先验密度 $p(k)$、均值 $\\mathbb{E}[k]$ 和方差 $\\operatorname{Var}(k)$ 关于 $\\mu_{\\eta}$ 和 $\\sigma_{\\eta}^{2}$ 的解析表达式。最终答案必须写成包含这三个表达式的单行矩阵。不需要进行数值计算。",
            "solution": "用户希望我解决以下问题：\n在多相催化的微动力学建模 (MKM) 中，每个基元步骤都由一个必须为严格正值的速率常数表示。为了在强制施加正值的同时，能够进行不确定性量化 (UQ) 和贝叶斯误差分析，我们考虑重新参数化 $k=\\exp(\\eta)$，其中 $k$ 是一个速率常数，$\\eta$ 是一个无约束的潜变量。假设 $\\eta$ 的先验认知不确定性由一个高斯分布表示，即 $\\eta \\sim \\mathcal{N}(\\mu_{\\eta}, \\sigma_{\\eta}^{2})$，这反映了对数尺度上的加性模型误差。从概率密度的变量变换公式和矩的标准定义出发，推导 $k$ 的隐含先验密度以及用 $\\mu_{\\eta}$ 和 $\\sigma_{\\eta}^{2}$ 表示的前两阶矩的闭式表达式。您的推导必须从随机变量的变换法则开始，并且不得假设所得分布的任何预知形式。请将您的最终结果表示为先验密度 $p(k)$、均值 $\\mathbb{E}[k]$ 和方差 $\\operatorname{Var}(k)$ 关于 $\\mu_{\\eta}$ 和 $\\sigma_{\\eta}^{2}$ 的解析表达式。最终答案必须写成包含这三个表达式的单行矩阵。不需要进行数值计算。\n该问题已经过验证，被认为是可解的。这是一个分步解答。\n\n该问题要求推导速率常数 $k$ 的概率密度函数 (PDF)、均值和方差，已知其对数 $\\eta = \\ln(k)$ 服从正态分布。\n\n### 第一步：问题陈述的验证\n\n问题陈述已经过验证，是有效的。\n- **已知条件：**\n    1. 速率常数 $k$ 必须严格为正，即 $k > 0$。\n    2. 定义重新参数化为 $k = \\exp(\\eta)$，其中 $\\eta$ 是一个潜变量。\n    3. $\\eta$ 的先验分布是高斯（正态）分布：$\\eta \\sim \\mathcal{N}(\\mu_{\\eta}, \\sigma_{\\eta}^{2})$。\n- **要求：**\n    1. 推导 $k$ 的先验密度，表示为 $p(k)$。\n    2. 推导 $k$ 的均值，$\\mathbb{E}[k]$。\n    3. 推导 $k$ 的方差，$\\operatorname{Var}(k)$。\n    4. 所有结果都用 $\\mu_{\\eta}$ 和 $\\sigma_{\\eta}^{2}$ 表示。\n    5. 推导必须从变量变换公式和矩的标准定义开始。\n- **结论：** 该问题具有科学依据，提法恰当，客观，并包含获得唯一数学解所需的所有信息。它代表了统计建模中的一个标准推导。\n\n### 第二步：概率密度函数 $p(k)$ 的推导\n\n推导从服从正态分布的变量 $\\eta$ 的概率密度函数开始。设 $p_{\\eta}(\\eta')$ 表示此 PDF，其中 $\\eta'$ 是随机变量 $\\eta$ 的一个特定值。\n$$p_{\\eta}(\\eta') = \\frac{1}{\\sigma_{\\eta}\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\eta' - \\mu_{\\eta})^2}{2\\sigma_{\\eta}^2}\\right)$$\n关联随机变量的变换是 $k = g(\\eta) = \\exp(\\eta)$。这个变换是从 $\\eta \\in (-\\infty, \\infty)$到 $k \\in (0, \\infty)$ 的一一映射。其逆变换是 $\\eta = g^{-1}(k) = \\ln(k)$。\n\n概率密度的变量变换公式指出，$k$ 的 PDF（表示为 $p_k(k)$）由下式给出：\n$$p_k(k) = p_{\\eta}(g^{-1}(k)) \\left| \\frac{d}{dk}g^{-1}(k) \\right|$$\n首先，我们计算逆变换相对于 $k$ 的导数：\n$$\\frac{d}{dk}g^{-1}(k) = \\frac{d}{dk}\\ln(k) = \\frac{1}{k}$$\n由于问题指出 $k$ 是速率常数且必须为严格正值 ($k > 0$)，其绝对值就是 $\\left| \\frac{1}{k} \\right| = \\frac{1}{k}$。\n\n现在，我们将 $g^{-1}(k) = \\ln(k)$ 和导数代入变量变换公式：\n$$p_k(k) = p_{\\eta}(\\ln(k)) \\cdot \\frac{1}{k}$$\n代入正态分布的 PDF $p_{\\eta}$ 的表达式：\n$$p_k(k) = \\left[ \\frac{1}{\\sigma_{\\eta}\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(k) - \\mu_{\\eta})^2}{2\\sigma_{\\eta}^2}\\right) \\right] \\cdot \\frac{1}{k}$$\n整理各项，得到 $k$ 的 PDF 的最终表达式，这就是对数正态分布的 PDF：\n$$p(k) = \\frac{1}{k\\sigma_{\\eta}\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(k) - \\mu_{\\eta})^2}{2\\sigma_{\\eta}^2}\\right) \\quad \\text{for } k > 0$$\n\n### 第三步：均值 $\\mathbb{E}[k]$ 的推导\n\n$k$ 的均值或期望值是一阶矩。我们可以使用随机变量函数的期望值定义（无意识统计学家法则）来计算，这通常比对 $k$ 的派生 PDF 进行积分更直接。\n$$\\mathbb{E}[k] = \\mathbb{E}[\\exp(\\eta)] = \\int_{-\\infty}^{\\infty} \\exp(\\eta') p_{\\eta}(\\eta') \\, d\\eta'$$\n代入 PDF $p_{\\eta}(\\eta')$：\n$$\\mathbb{E}[k] = \\int_{-\\infty}^{\\infty} \\exp(\\eta') \\frac{1}{\\sigma_{\\eta}\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\eta' - \\mu_{\\eta})^2}{2\\sigma_{\\eta}^2}\\right) \\, d\\eta'$$\n合并指数项：\n$$\\mathbb{E}[k] = \\frac{1}{\\sigma_{\\eta}\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(\\eta' - \\frac{(\\eta' - \\mu_{\\eta})^2}{2\\sigma_{\\eta}^2}\\right) \\, d\\eta'$$\n我们现在对指数的参数进行配方。设参数为 $A$：\n$$A = \\eta' - \\frac{\\eta'^2 - 2\\mu_{\\eta}\\eta' + \\mu_{\\eta}^2}{2\\sigma_{\\eta}^2} = \\frac{2\\sigma_{\\eta}^2\\eta' - \\eta'^2 + 2\\mu_{\\eta}\\eta' - \\mu_{\\eta}^2}{2\\sigma_{\\eta}^2}$$\n$$A = -\\frac{1}{2\\sigma_{\\eta}^2} \\left[ \\eta'^2 - 2(\\mu_{\\eta} + \\sigma_{\\eta}^2)\\eta' + \\mu_{\\eta}^2 \\right]$$\n为了对 $\\eta'^2 - 2(\\mu_{\\eta} + \\sigma_{\\eta}^2)\\eta'$ 这一项进行配方，我们加上并减去 $(\\mu_{\\eta} + \\sigma_{\\eta}^2)^2$：\n$$A = -\\frac{1}{2\\sigma_{\\eta}^2} \\left[ (\\eta' - (\\mu_{\\eta} + \\sigma_{\\eta}^2))^2 - (\\mu_{\\eta} + \\sigma_{\\eta}^2)^2 + \\mu_{\\eta}^2 \\right]$$\n$$A = -\\frac{1}{2\\sigma_{\\eta}^2} \\left[ (\\eta' - (\\mu_{\\eta} + \\sigma_{\\eta}^2))^2 - (\\mu_{\\eta}^2 + 2\\mu_{\\eta}\\sigma_{\\eta}^2 + \\sigma_{\\eta}^4) + \\mu_{\\eta}^2 \\right]$$\n$$A = -\\frac{(\\eta' - (\\mu_{\\eta} + \\sigma_{\\eta}^2))^2}{2\\sigma_{\\eta}^2} + \\frac{2\\mu_{\\eta}\\sigma_{\\eta}^2 + \\sigma_{\\eta}^4}{2\\sigma_{\\eta}^2} = -\\frac{(\\eta' - (\\mu_{\\eta} + \\sigma_{\\eta}^2))^2}{2\\sigma_{\\eta}^2} + \\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2}$$\n将此代回积分：\n$$\\mathbb{E}[k] = \\frac{1}{\\sigma_{\\eta}\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{(\\eta' - (\\mu_{\\eta} + \\sigma_{\\eta}^2))^2}{2\\sigma_{\\eta}^2} + \\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2} \\right) \\, d\\eta'$$\n项 $\\exp(\\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2})$ 相对于 $\\eta'$ 是常数，可以被提出来：\n$$\\mathbb{E}[k] = \\exp\\left(\\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2}\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sigma_{\\eta}\\sqrt{2\\pi}} \\exp\\left( -\\frac{(\\eta' - (\\mu_{\\eta} + \\sigma_{\\eta}^2))^2}{2\\sigma_{\\eta}^2} \\right) \\, d\\eta'$$\n该积分是均值为 $\\mu' = \\mu_{\\eta} + \\sigma_{\\eta}^2$、标准差为 $\\sigma_{\\eta}$ 的正态分布的 PDF 下的总面积。这个积分等于 $1$。\n因此，$k$ 的均值为：\n$$\\mathbb{E}[k] = \\exp\\left(\\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2}\\right)$$\n\n### 第四步：方差 $\\operatorname{Var}(k)$ 的推导\n\n方差的定义为 $\\operatorname{Var}(k) = \\mathbb{E}[k^2] - (\\mathbb{E}[k])^2$。我们已经求出了 $\\mathbb{E}[k]$，因此我们首先需要计算二阶矩 $\\mathbb{E}[k^2]$。\n使用与求均值相同的方法，我们有 $k^2 = (\\exp(\\eta))^2 = \\exp(2\\eta)$。\n$$\\mathbb{E}[k^2] = \\mathbb{E}[\\exp(2\\eta)] = \\int_{-\\infty}^{\\infty} \\exp(2\\eta') p_{\\eta}(\\eta') \\, d\\eta'$$\n这个计算等价于求正态分布 $\\eta \\sim \\mathcal{N}(\\mu_{\\eta}, \\sigma_{\\eta}^2)$ 的矩生成函数 (MGF) $M_{\\eta}(t) = \\exp(\\mu_{\\eta}t + \\frac{1}{2}\\sigma_{\\eta}^2t^2)$ 在 $t=2$ 处的值。\n$$\\mathbb{E}[k^2] = M_{\\eta}(2) = \\exp\\left(\\mu_{\\eta}(2) + \\frac{1}{2}\\sigma_{\\eta}^2(2)^2\\right) = \\exp(2\\mu_{\\eta} + 2\\sigma_{\\eta}^2)$$\n现在我们可以计算方差：\n$$\\operatorname{Var}(k) = \\mathbb{E}[k^2] - (\\mathbb{E}[k])^2$$\n$$\\operatorname{Var}(k) = \\exp(2\\mu_{\\eta} + 2\\sigma_{\\eta}^2) - \\left[\\exp\\left(\\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2}\\right)\\right]^2$$\n$$\\operatorname{Var}(k) = \\exp(2\\mu_{\\eta} + 2\\sigma_{\\eta}^2) - \\exp\\left(2\\mu_{\\eta} + \\sigma_{\\eta}^2\\right)$$\n提出公因式 $\\exp(2\\mu_{\\eta} + \\sigma_{\\eta}^2)$：\n$$\\operatorname{Var}(k) = \\exp(2\\mu_{\\eta} + \\sigma_{\\eta}^2) \\left[ \\exp(\\sigma_{\\eta}^2) - 1 \\right]$$\n这就是 $k$ 的方差的最终表达式。\n\n推导出的三个表达式是：\n1.  先验密度 $p(k) = \\frac{1}{k\\sigma_{\\eta}\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(k) - \\mu_{\\eta})^2}{2\\sigma_{\\eta}^2}\\right)$\n2.  均值 $\\mathbb{E}[k] = \\exp\\left(\\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2}\\right)$\n3.  方差 $\\operatorname{Var}(k) = \\left(\\exp(\\sigma_{\\eta}^2) - 1\\right) \\exp(2\\mu_{\\eta} + \\sigma_{\\eta}^2)$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{k\\sigma_{\\eta}\\sqrt{2\\pi}} \\exp\\left(-\\frac{\\left(\\ln(k) - \\mu_{\\eta}\\right)^2}{2\\sigma_{\\eta}^2}\\right)  \\exp\\left(\\mu_{\\eta} + \\frac{\\sigma_{\\eta}^2}{2}\\right)  \\left(\\exp(\\sigma_{\\eta}^2) - 1\\right) \\exp\\left(2\\mu_{\\eta} + \\sigma_{\\eta}^2\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从实验数据中估计阿伦尼乌斯（Arrhenius）参数（活化能 $E_a$ 和指前因子 $A$）是化学动力学中的一个核心任务。贝叶斯推断为此提供了一个严谨的框架，能够将先验知识（例如，来自密度泛函理论的计算结果）与实验证据相结合。在理想情况下，当似然函数和先验分布均为高斯分布时，我们可以得到后验分布的解析解。本练习  旨在引导您完整推导一个共轭模型中阿伦尼乌斯参数的后验分布，这有助于在深入学习更复杂的数值方法之前，建立对贝叶斯更新工作机制的坚实基础。",
            "id": "3904162",
            "problem": "考虑一个单基元表面反应步骤的微观动力学模型，其温度依赖性遵循阿伦尼乌斯定律。设在温度 $T_i$ 下测得的转换频率为 $r_i$（$i=1,\\dots,N$），其阿伦尼乌斯形式为 $r_i = A \\exp\\!\\left(-E_a/(R T_i)\\right)$，其中 $E_a$ 是活化能，$A$ 是指前因子，$R$ 是通用气体常数。定义变换后的观测值 $y_i = \\ln(r_i)$，并将测量误差建模为加性、独立同分布（i.i.d.）的高斯噪声：$y_i = \\ln A - E_a/(R T_i) + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 且噪声方差 $\\sigma^2$ 已知。\n\n设参数向量为 $\\theta = \\begin{pmatrix}E_a \\\\ \\ln A\\end{pmatrix}$。假设高斯先验 $\\theta \\sim \\mathcal{N}(\\mu_0,\\Sigma_0)$，其先验均值为 $\\mu_0 = \\begin{pmatrix}m_1 \\\\ m_2\\end{pmatrix}$，先验协方差 $\\Sigma_0$ 是对称正定的，并将其精度（逆协方差）表示为 $P_0 = \\Sigma_0^{-1} = \\begin{pmatrix}p_{11}  p_{12} \\\\ p_{12}  p_{22}\\end{pmatrix}$。定义设计矩阵 $X \\in \\mathbb{R}^{N \\times 2}$，其行向量为 $x_i^{\\top} = \\begin{pmatrix}-\\frac{1}{R T_i}  1\\end{pmatrix}$，因此有 $y = X \\theta + \\epsilon$，其中 $y = \\begin{pmatrix}y_1 \\\\ \\vdots \\\\ y_N\\end{pmatrix}$ 且 $\\epsilon \\sim \\mathcal{N}(0,\\sigma^2 I)$。\n\n从贝叶斯定理和上述定义出发，完成以下任务：\n- 推导负对数后验（忽略加性常数），并计算其关于 $\\theta$ 的梯度和海森矩阵。\n- 求解最小化负对数后验的后验众数 $\\widehat{\\theta}$。\n- 使用拉普拉斯近似（关于众数的二阶泰勒展开），获得 $p(\\theta \\mid D)$ 的高斯近似，其中 $D=\\{(T_i,r_i)\\}_{i=1}^N$ 是数据集，并确定近似的后验均值向量和协方差矩阵。\n\n为紧凑地表达结果，定义以下汇总统计量：\n- $S_{11} = \\sum_{i=1}^{N} \\left(\\frac{1}{R T_i}\\right)^2$，$S_{22} = \\sum_{i=1}^{N} 1 = N$，$S_{12} = \\sum_{i=1}^{N} \\left(-\\frac{1}{R T_i}\\right)$，\n- $U_1 = \\sum_{i=1}^{N} \\left(-\\frac{1}{R T_i}\\right) y_i$ 和 $U_2 = \\sum_{i=1}^{N} y_i$，\n- $H = P_0 + \\frac{1}{\\sigma^2} \\begin{pmatrix} S_{11}  S_{12} \\\\ S_{12}  S_{22} \\end{pmatrix}$，其元素为 $h_{11}$，$h_{12}$，$h_{22}$，\n- $b = P_0 \\mu_0 + \\frac{1}{\\sigma^2} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix}$，其元素为 $b_1$ 和 $b_2$，\n- $\\Delta = h_{11} h_{22} - h_{12}^2$。\n\n将您的最终结果表示为一个包含后验众数两个分量和近似后验协方差矩阵三个唯一元素的五元行矩阵：$\\left(\\widehat{E}_a, \\widehat{\\ln A}, \\Sigma_{11}, \\Sigma_{12}, \\Sigma_{22}\\right)$，其中 $\\Sigma = H^{-1}$。将最终答案表示为用上述定义的量表示的闭合形式解析表达式。最终答案中不要包含单位；但在整个推导过程中，请使用焦耳/摩尔作为 $E_a$ 的单位，开尔文作为 $T$ 的单位，焦耳/(摩尔·开尔文)作为 $R$ 的单位，并将 $\\ln A$ 视为无量纲量。",
            "solution": "该问题陈述经核实具有科学依据，提法恰当，客观且内部一致。它代表了贝叶斯线性回归在确定阿伦尼乌斯方程参数方面的标准应用。所有必要的信息和定义均已提供。\n\n目标是给定一组测量数据 $D = \\{(T_i, r_i)\\}_{i=1}^N$，求参数向量 $\\theta = \\begin{pmatrix} E_a \\\\ \\ln A \\end{pmatrix}$ 的后验分布。根据贝叶斯定理，后验概率密度函数 $p(\\theta \\mid D)$ 正比于似然 $p(D \\mid \\theta)$ 和先验 $p(\\theta)$ 的乘积：\n$$p(\\theta \\mid D) \\propto p(D \\mid \\theta) p(\\theta)$$\n\n模型以线性化形式给出：$y = X \\theta + \\epsilon$，其中 $y_i = \\ln(r_i)$，$X$ 是设计矩阵，$\\epsilon \\sim \\mathcal{N}(0, \\sigma^2 I)$ 是噪声向量。因此，给定参数 $\\theta$ 时数据的似然是一个多元高斯分布：\n$$p(D \\mid \\theta) = p(y \\mid X, \\theta) = \\frac{1}{(2\\pi\\sigma^2)^{N/2}} \\exp\\left( -\\frac{1}{2\\sigma^2} (y - X\\theta)^{\\top}(y - X\\theta) \\right)$$\n\n$\\theta$ 的先验分布也是一个多元高斯分布，$\\theta \\sim \\mathcal{N}(\\mu_0, \\Sigma_0)$，其概率密度为：\n$$p(\\theta) = \\frac{1}{(2\\pi)^{k/2} |\\Sigma_0|^{1/2}} \\exp\\left( -\\frac{1}{2} (\\theta - \\mu_0)^{\\top}\\Sigma_0^{-1}(\\theta - \\mu_0) \\right)$$\n其中 $k=2$ 是 $\\theta$ 的维度，$P_0 = \\Sigma_0^{-1}$ 是先验精度矩阵。\n\n后验分布正比于这两个表达式的乘积。我们关心的是负对数后验，$L(\\theta) = -\\ln p(\\theta \\mid D)$。忽略不依赖于 $\\theta$ 的项（这些项成为加性常数），我们得到：\n$$L(\\theta) = \\frac{1}{2\\sigma^2} (y - X\\theta)^{\\top}(y - X\\theta) + \\frac{1}{2} (\\theta - \\mu_0)^{\\top}P_0(\\theta - \\mu_0) + \\text{const.}$$\n展开二次型：\n$$(y - X\\theta)^{\\top}(y - X\\theta) = y^{\\top}y - 2\\theta^{\\top}X^{\\top}y + \\theta^{\\top}X^{\\top}X\\theta$$\n$$(\\theta - \\mu_0)^{\\top}P_0(\\theta - \\mu_0) = \\theta^{\\top}P_0\\theta - 2\\theta^{\\top}P_0\\mu_0 + \\mu_0^{\\top}P_0\\mu_0$$\n将这些代入 $L(\\theta)$ 的表达式，并再次舍去常数项（$y^{\\top}y$ 和 $\\mu_0^{\\top}P_0\\mu_0$）：\n$$L(\\theta) = \\frac{1}{2\\sigma^2} (\\theta^{\\top}X^{\\top}X\\theta - 2\\theta^{\\top}X^{\\top}y) + \\frac{1}{2} (\\theta^{\\top}P_0\\theta - 2\\theta^{\\top}P_0\\mu_0)$$\n$$L(\\theta) = \\frac{1}{2} \\theta^{\\top} \\left( P_0 + \\frac{1}{\\sigma^2}X^{\\top}X \\right) \\theta - \\theta^{\\top} \\left( P_0\\mu_0 + \\frac{1}{\\sigma^2}X^{\\top}y \\right)$$\n这就是负对数后验（忽略加性常数）。\n\n接下来，我们计算 $L(\\theta)$ 关于 $\\theta$ 的梯度和海森矩阵。梯度为：\n$$\\nabla_{\\theta} L(\\theta) = \\left( P_0 + \\frac{1}{\\sigma^2}X^{\\top}X \\right) \\theta - \\left( P_0\\mu_0 + \\frac{1}{\\sigma^2}X^{\\top}y \\right)$$\n海森矩阵是二阶导数矩阵：\n$$\\nabla_{\\theta}^2 L(\\theta) = P_0 + \\frac{1}{\\sigma^2}X^{\\top}X$$\n问题陈述中定义了汇总统计量，使我们能够紧凑地表达这些量。\n$X^{\\top}X = \\begin{pmatrix} S_{11}  S_{12} \\\\ S_{12}  S_{22} \\end{pmatrix}$ 和 $X^{\\top}y = \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix}$。\n海森矩阵与问题中定义的矩阵 $H$ 相同：\n$$H = \\nabla_{\\theta}^2 L(\\theta) = P_0 + \\frac{1}{\\sigma^2} \\begin{pmatrix} S_{11}  S_{12} \\\\ S_{12}  S_{22} \\end{pmatrix} = \\begin{pmatrix} h_{11}  h_{12} \\\\ h_{12}  h_{22} \\end{pmatrix}$$\n梯度中乘以 $\\theta$ 的项是 $\\left( P_0\\mu_0 + \\frac{1}{\\sigma^2}X^{\\top}y \\right)$，这与问题中定义的向量 $b$ 相同：\n$$b = P_0\\mu_0 + \\frac{1}{\\sigma^2} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$$\n所以梯度是 $\\nabla_{\\theta} L(\\theta) = H\\theta - b$。\n\n后验众数 $\\widehat{\\theta}$ 是使负对数后验 $L(\\theta)$ 最小化的 $\\theta$ 值。我们通过将梯度设为零来找到它：\n$$H \\widehat{\\theta} - b = 0 \\implies H \\widehat{\\theta} = b$$\n由于 $P_0$ 是对称正定的，而 $X^{\\top}X$ 是对称半正定的（对于非退化数据通常是正定的），因此 $H$ 是对称正定且可逆的。因此，后验众数是唯一的：\n$$\\widehat{\\theta} = H^{-1} b$$\n\n拉普拉斯近似包括用一个以其众数 $\\widehat{\\theta}$ 为中心的高斯分布来近似后验分布。该高斯分布的协方差由在众数处计算的负对数后验的海森矩阵的逆给出。\n在这里，负对数后验 $L(\\theta)$ 正好是 $\\theta$ 的一个二次函数。这意味着后验分布 $p(\\theta \\mid D)$ 恰好是一个高斯分布（而不是一个近似）。因此，拉普拉斯近似是精确的。\n后验分布为 $p(\\theta \\mid D) = \\mathcal{N}(\\mu_{\\text{post}}, \\Sigma_{\\text{post}})$，其中：\n- 后验均值即为众数：$\\mu_{\\text{post}} = \\widehat{\\theta} = H^{-1}b$。\n- 后验协方差是海森矩阵的逆：$\\Sigma_{\\text{post}} = H^{-1}$。\n\n问题定义了 $\\Sigma = H^{-1}$。我们需要计算 $\\widehat{\\theta}$ 和 $\\Sigma$ 的分量。\n$2 \\times 2$ 矩阵 $H$ 的逆是：\n$$\\Sigma = H^{-1} = \\frac{1}{h_{11}h_{22} - h_{12}^2} \\begin{pmatrix} h_{22}  -h_{12} \\\\ -h_{12}  h_{11} \\end{pmatrix} = \\frac{1}{\\Delta} \\begin{pmatrix} h_{22}  -h_{12} \\\\ -h_{12}  h_{11} \\end{pmatrix}$$\n其中 $\\Delta = \\det(H) = h_{11}h_{22} - h_{12}^2$。\n后验协方差矩阵 $\\Sigma$ 的分量是：\n$$\\Sigma_{11} = \\frac{h_{22}}{\\Delta}$$\n$$\\Sigma_{12} = \\Sigma_{21} = -\\frac{h_{12}}{\\Delta}$$\n$$\\Sigma_{22} = \\frac{h_{11}}{\\Delta}$$\n\n后验均值向量是 $\\widehat{\\theta} = \\begin{pmatrix} \\widehat{E}_a \\\\ \\widehat{\\ln A} \\end{pmatrix} = H^{-1} b$：\n$$\\begin{pmatrix} \\widehat{E}_a \\\\ \\widehat{\\ln A} \\end{pmatrix} = \\frac{1}{\\Delta} \\begin{pmatrix} h_{22}  -h_{12} \\\\ -h_{12}  h_{11} \\end{pmatrix} \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix} = \\frac{1}{\\Delta} \\begin{pmatrix} h_{22}b_1 - h_{12}b_2 \\\\ -h_{12}b_1 + h_{11}b_2 \\end{pmatrix}$$\n所以后验众数的分量是：\n$$\\widehat{E}_a = \\frac{h_{22}b_1 - h_{12}b_2}{\\Delta}$$\n$$\\widehat{\\ln A} = \\frac{h_{11}b_2 - h_{12}b_1}{\\Delta}$$\n\n最终结果是包含后验众数两个分量和后验协方差矩阵三个唯一元素的行矩阵：$(\\widehat{E}_a, \\widehat{\\ln A}, \\Sigma_{11}, \\Sigma_{12}, \\Sigma_{22})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{h_{22} b_1 - h_{12} b_2}{\\Delta}  \\frac{h_{11} b_2 - h_{12} b_1}{\\Delta}  \\frac{h_{22}}{\\Delta}  -\\frac{h_{12}}{\\Delta}  \\frac{h_{11}}{\\Delta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "所有模型都是对现实的近似。在不确定性量化领域，一个核心挑战是如何区分模型参数的不确定性与模型结构本身固有的误差，即“模型差异”（model discrepancy）。如果不加处理，这两种不确定性来源可能会相互混淆，导致参数估计有偏且不确定性评估不可信。本练习  挑战您批判性地评估一系列旨在缓解这种混淆问题的先进策略，掌握这些概念对于进行可靠的模型校准和做出具有可信度的预测至关重要。",
            "id": "3904144",
            "problem": "考虑一个多相催化反应的微观动力学模型的校准，其中在操作条件 $x \\in \\mathbb{R}^d$ 和参数向量 $\\theta \\in \\mathbb{R}^p$（例如，活化能和指前因子）下，预测的反应速率为 $r(x,\\theta)$。在 $n$ 个条件 $\\{x_i\\}_{i=1}^n$ 下的实验测量得到观测速率 $y_i$。一个基于统计原理的校准框架将此建模为\n$$\ny_i \\;=\\; r(x_i,\\theta) \\;+\\; \\delta(x_i) \\;+\\; \\epsilon_i,\n$$\n其中 $\\delta(\\cdot)$ 是一个捕捉结构性误差的模型差异函数，而 $\\epsilon_i$ 是测量噪声，满足 $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$，且对不同的 $i$ 独立。假设 $\\delta(\\cdot)$ 的先验是一个均值为零、协方差为 $k(\\cdot,\\cdot)$ 的高斯过程（Gaussian Process, GP），而 $\\theta$ 的先验反映了密度泛函理论的预测。\n\n一个普遍存在的可辨识性问题随之产生，因为 $\\theta$ 中的参数误差可以与模型差异 $\\delta(\\cdot)$ 相抵消来拟合 $\\{y_i\\}$，这可能会混淆推断过程。为分析此问题，在名义值 $\\theta^\\star$ 附近将模型线性化为\n$$\nr(x_i,\\theta) \\;\\approx\\; r(x_i,\\theta^\\star) \\;+\\; \\sum_{j=1}^p J_{ij}\\,(\\theta_j - \\theta^\\star_j),\n$$\n其中 $J_{ij} \\equiv \\left.\\frac{\\partial r(x_i,\\theta)}{\\partial \\theta_j}\\right|_{\\theta=\\theta^\\star}$ 是灵敏度（雅可比）矩阵。记 $w \\equiv \\theta - \\theta^\\star$，$r^\\star_i \\equiv r(x_i,\\theta^\\star)$，并将 $y$，$r^\\star$，$\\delta$ 和 $\\epsilon$ 表示为向量。则\n$$\ny \\;=\\; r^\\star \\;+\\; Jw \\;+\\; \\delta \\;+\\; \\epsilon.\n$$\n当 $\\delta$ 包含 $J$ 的列空间中的分量时，就会发生混淆，这使得在没有额外结构的情况下，无法从 $y$ 中辨识 $w$ 和 $\\delta$。在贝叶斯框架下，可以施加约束或先验来减轻混淆，同时保留 $\\theta$ 的物理可解释性，并通过 $\\delta(\\cdot)$ 承认结构性误差。\n\n在此校准框架中，下列哪些策略在科学上是合理的，并且能有效减轻参数误差和模型差异之间的混淆，同时又与计算催化中的不确定性量化和贝叶斯误差分析保持一致？\n\nA. 在训练输入上，对模型差异与参数灵敏度方向施加正交约束：对于所有 $j \\in \\{1,\\dots,p\\}$，\n$$\n\\sum_{i=1}^n \\delta(x_i)\\,J_{ij} \\;=\\; 0,\n$$\n并在 $\\{x_i\\}$ 上对 $\\delta(\\cdot)$ 使用零均值高斯过程先验。这可以通过将 $\\delta$ 的先验投影到训练点处 $J$ 的列空间的正交补上来实现。\n\nB. 在 $\\mathbb{R}^p$ 上使用无信息先验 $p(\\theta)\\propto 1$，并为 $\\delta(\\cdot)$ 使用具有非常大的边际方差和长长度尺度的高斯过程先验，理由是 $\\delta(\\cdot)$ 可以吸收所有结构性偏差，从而缓解混淆。\n\nC. 对模型差异的幅度设置分层收缩先验，例如，$\\delta(x)\\sim \\mathcal{GP}\\!\\left(0,\\lambda^2\\,k(x,x')\\right)$，其中对于小尺度 $s$，$\\lambda \\sim \\mathrm{Half\\text{-}Cauchy}(s)$，同时对 $\\theta$ 使用一个以密度泛函理论预测为中心、具有实际协方差的信息高斯先验。此外，在训练点上强制施加零均值约束，$\\sum_{i=1}^n \\delta(x_i)=0$。\n\nD. 通过先验地选择一个大的 $\\sigma^2$ 来指定 $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$，从而增大测量噪声方差，使得残差主要归因于 $\\epsilon$，以此减少对差异项的需求并提高 $\\theta$ 的可辨识性。\n\nE. 设计实验 $\\{x_i\\}$ 以最大化与线性化模型相关的费雪信息矩阵的行列式，例如 $\\det\\!\\left(J^\\top \\Sigma^{-1} J\\right)$ 其中 $\\Sigma=\\sigma^2 I_n$，并选择一个差异协方差核，其长度尺度 $\\ell$ 比 $r(x,\\theta)$ 在设计区域内变化的特征尺度更短，同时在训练输入上强制施加和为零约束 $\\sum_{i=1}^n \\delta(x_i)=0$，以减少 $\\delta$ 和参数灵敏度之间的对齐。\n\nF. 将模型差异恒等地设为零，即 $\\delta(\\cdot)\\equiv 0$，并完全依赖参数模型 $r(x,\\theta)$ 和测量噪声 $\\epsilon$ 来解释数据，理由是这通过消除不可辨识性的来源来消除混淆。\n\n选择所有适用项。",
            "solution": "所提出的问题关乎计算催化中微观动力学模型的校准，这是一个利用实验数据 $y_i$ 来推断模型参数 $\\theta$ 的场景。问题陈述正确地指出了现代不确定性量化中的一个关键问题：参数误差（$\\theta$ 中的不确定性）与结构性模型差异 $\\delta(\\cdot)$ 之间的混淆。统计模型由下式给出\n$$y_i = r(x_i, \\theta) + \\delta(x_i) + \\epsilon_i$$\n其中 $r(x_i, \\theta)$ 是基于物理的模型预测，$\\delta(x_i)$ 是模型差异，而 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 是测量噪声。这个问题有科学依据，是良定的，并使用了来自贝叶斯统计和化学工程领域的标准、精确的术语。模型的线性化，\n$$y \\approx r^\\star + Jw + \\delta + \\epsilon$$\n其中 $w = \\theta - \\theta^\\star$，是研究局部可辨识性的一个有效分析工具。混淆的产生是因为差异向量 $\\delta$（在训练点上）可能位于雅可比矩阵 $J$ 的列空间中，或在其上有显著的投影，这使得区分改变参数的效果（$Jw$）和模型差异的效果（$\\delta$）变得困难。我们被要求评估几种减轻这种混淆的策略。\n\n### 选项评估\n\n**选项 A：在训练输入上，对模型差异与参数灵敏度方向施加正交约束。**\n该策略建议强制执行约束 $\\sum_{i=1}^n \\delta(x_i) J_{ij} = 0$，对所有 $j=1, \\dots, p$ 成立。在向量表示法中，这是 $J^\\top \\delta = 0$，其中 $\\delta$ 是在 $n$ 个训练点上的差异值向量。这强制差异向量与在训练位置处的灵敏度矩阵 $J$ 的列空间正交。\n\n*   **理由**：这是一种直接且数学上严谨的解决可辨识性问题的方法。根据其构造，它将残差 $y - r^\\star$ 分解为两个正交分量：一个在 $J$ 的列空间中（归因于参数更新 $w$），另一个是正交分量（归因于模型差异 $\\delta$）。这种方法在计算机模型校准的背景下被开创，它确保了差异项只捕捉那些无法通过调整模型参数来表示的结构性模型误差。这最大程度上保留了参数 $\\theta$ 的物理可解释性。通过投影高斯过程（GP）先验来实现是贝叶斯计算中的一种标准技术。\n*   **结论**：**正确**。\n\n**选项 B：对 $\\theta$ 使用无信息先验，并为 $\\delta(\\cdot)$ 使用具有非常大的边际方差和长长度尺度的高斯过程先验。**\n该策略建议对参数和差异都使用模糊先验。无信息先验 $p(\\theta) \\propto 1$ 消除了任何有助于锚定参数的先验知识。为 $\\delta$ 设置一个具有非常大的边际方差的高斯过程先验，允许差异取较大的值，而长的长度尺度则意味着 $\\delta(\\cdot)$ 是一个非常平滑的函数。\n\n*   **理由**：这种方法会适得其反，并加剧混淆问题。移除关于 $\\theta$ 的先验信息会使参数更难辨识。$\\delta$ 的高斯过程先验中较长的长度尺度意味着差异函数可能是平滑的，类似于构成 $J$ 的列的函数（它们是通常平滑的模型响应面的导数）。这增加了 $\\delta$ 与 $J$ 的列空间对齐的先验可能性。允许 $\\delta$ 有一个大的方差使其具有灵活性，可以吸收数据中任何模型无法解释的部分，从而使其无法与参数误差区分开来。目标是分离 $Jw$ 和 $\\delta$，而不是创造一种 $\\delta$ 可以完美模仿 $Jw$ 的情况。\n*   **结论**：**不正确**。\n\n**选项 C：对模型差异的幅度设置分层收缩先验，对 $\\theta$ 使用信息高斯先验，并强制执行零均值约束。**\n这是一个包含通过先验进行“软”约束的多部分策略。关于 $\\theta$ 的信息先验（例如，来自密度泛函理论）将参数锚定在物理上合理的数值附近。对差异幅度的分层收缩先验（例如，$\\delta \\sim \\mathcal{GP}(0, \\lambda^2 k)$，其中对于小尺度 $s$，$\\lambda \\sim \\text{Half-Cauchy}(s)$）惩罚大的差异项，除非数据提供强有力的相反证据，否则偏好通过参数模型进行解释。零均值约束 $\\sum_i \\delta(x_i)=0$ 防止了常数偏移的权衡。\n\n*   **理由**：这是一种精巧且科学上合理的贝叶斯方法。关于 $\\theta$ 的信息先验提供了帮助辨识参数的关键信息。对 $\\lambda$ 的收缩先验起到一种自动正则化的作用，表达了对更简单模型（更小的差异）的偏好，从而抑制了混淆。零均值约束是一种温和的正交形式，它强制与常数向量正交，而常数向量通常是一个灵敏度方向（例如，对于全局指前因子）。这种技术组合提供了一种灵活而有原则的方法来正则化这个不适定反问题并提高可辨识性。\n*   **结论**：**正确**。\n\n**选项 D：先验地增大测量噪声方差 $\\sigma^2$。**\n该策略建议通过假设测量噪声远大于其实际值来解释残差。\n\n*   **理由**：这在根本上是不合理的。测量噪声方差 $\\sigma^2$ 是一个代表实验设备精度的物理量。它应该从数据中估计，或根据实验的先验知识来确定。任意增大 $\\sigma^2$ 会导致统计模型的错误指定。虽然这样做会减小 $\\delta$ 和参数 $\\theta$ 的后验方差（通过使它们回归到其先验），但这是以实际上抛弃数据中包含的信息为代价的。似然函数变得平坦，意味着数据不再为参数提供信息。这完全违背了模型校准的根本目的。\n*   **结论**：**不正确**。\n\n**选项 E：结合最优实验设计、为差异核设置短长度尺度以及和为零约束。**\n该策略结合了几种先进技术。最优设计（例如，D-最优性，即最大化 $\\det(J^\\top \\Sigma^{-1} J)$）旨在选择能使参数尽可能易于辨识的实验条件 $\\{x_i\\}$。为 $\\delta$ 的高斯过程核使用一个短的长度尺度 $\\ell$ 编码了一种先验信念，即模型差异在比模型的参数部分更短的尺度上变化。也包含了和为零约束。\n\n*   **理由**：这是一种强大且科学上有效的策略。最优实验设计是一种主动措施，旨在数据收集之前就改善矩阵的条件数并减少潜在的混淆。短长度尺度的假设实现了一种“尺度分离”的论点：它假定基于物理的模型 $r(x, \\theta)$ 捕捉了慢变的、大尺度的趋势，而差异 $\\delta$ 捕捉了快变的、局部的误差。由于 $J$ 的列通常是平滑的，一个具有短长度尺度的“摆动”的差异函数在 $J$ 的列空间上的投影会很小，从而减轻了混淆。在许多建模场景中，这是一种非常常见且物理上合理的方法。和为零约束提供了额外的、温和的防混淆措施。\n*   **结论**：**正确**。\n\n**选项 F：将模型差异恒等地设为零，即 $\\delta(\\cdot) \\equiv 0$。**\n该策略建议完全忽略模型差异，直接拟合模型 $y_i = r(x_i, \\theta) + \\epsilon_i$。\n\n*   **理由**：这种方法从根本上误解了问题。贝叶斯误差分析和 Kennedy-O'Hagan 框架的整个前提是确定性模型通常在结构上是不完美的。通过设置 $\\delta \\equiv 0$ 来忽略这个已知的误差来源并不能解决混淆问题；它仅仅是将其假设掉。如果模型差异真实存在，强制其为零将导致有偏的参数估计，因为参数 $\\theta$ 将被迫补偿模型的结构性缺陷。得到的参数值会失去其物理意义，并且对预测的不确定性量化将是不正确的和过于自信的。这是模型设定错误的经典案例。\n*   **结论**：**不正确**。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}