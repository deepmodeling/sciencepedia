{
    "hands_on_practices": [
        {
            "introduction": "几何优化算法的核心思想是利用势能面的局部二次模型来预测能量最低点。牛顿法是实现这一思想的黄金标准，它通过直接求解二次模型的最小值来确定最优的移动步长。本练习将通过一个具体的二维算例，让您亲手计算这一基础的牛顿步长及其对应的能量变化，从而深刻理解优化算法的基石。",
            "id": "2894209",
            "problem": "在以标度的、无量纲的内坐标进行的量子化学几何优化中，当前结构 $\\mathbf{q}_{0}$ 附近的电子能量 $E(\\mathbf{q})$ 由二阶泰勒模型近似：\n$$\nm(\\mathbf{s}) \\equiv E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s},\n$$\n其中 $\\mathbf{s} = \\mathbf{q} - \\mathbf{q}_{0}$ 是位移，$\\mathbf{g} = \\nabla E(\\mathbf{q}_{0})$ 是梯度，$\\mathbf{H} = \\nabla^{2} E(\\mathbf{q}_{0})$ 是Hessian矩阵。由于坐标根据构造是无量纲的，$\\mathbf{g}$ 和 $\\mathbf{H}$ 的单位都是能量。牛顿步定义为最小化该二次模型的位移。\n\n在 $\\mathbf{q}_{0}$ 处，假设梯度和Hessian矩阵为\n$$\n\\mathbf{g} =\n\\begin{pmatrix}\n0.06 \\\\\n-0.08\n\\end{pmatrix}\n\\ \\text{Hartree}, \n\\qquad\n\\mathbf{H} =\n\\begin{pmatrix}\n1.2  0.3 \\\\\n0.3  0.9\n\\end{pmatrix}\n\\ \\text{Hartree}.\n$$\n从二阶泰勒模型和极小值点的定义出发，推导用 $\\mathbf{g}$ 和 $\\mathbf{H}$ 表示的牛顿步 $\\mathbf{s}_{N}$ 的表达式，利用上述数据明确计算 $\\mathbf{s}_{N}$，然后评估预测的二次能量变化\n$$\n\\Delta E_{\\text{pred}} \\equiv m(\\mathbf{s}_{N}) - m(\\mathbf{0}).\n$$\n以Hartree为单位表示最终的能量变化，并将您的答案四舍五入到五位有效数字。最终的响应必须是一个实数。",
            "solution": "所述问题在科学上是合理的、适定的，并包含了求得唯一解所需的全部信息。Hessian矩阵是正定的，这保证了二次模型存在唯一的极小值。因此，我将继续进行求解。\n\n目标是找到能最小化电子能量二次模型的位移 $\\mathbf{s}$：\n$$\nm(\\mathbf{s}) = E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s}\n$$\n可微函数取极小值的必要条件是其梯度为零。我们必须计算 $m(\\mathbf{s})$ 相对于位移向量 $\\mathbf{s}$ 的梯度，并令其等于零向量。\n梯度由下式给出：\n$$\n\\nabla_{\\mathbf{s}} m(\\mathbf{s}) = \\nabla_{\\mathbf{s}} \\left( E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s} \\right)\n$$\n$E(\\mathbf{q}_{0})$ 项相对于 $\\mathbf{s}$ 是一个常数，所以其导数为零。线性项和二次项的导数是向量微积分中的标准结果：\n$$\n\\nabla_{\\mathbf{s}} (\\mathbf{g}^{\\top}\\mathbf{s}) = \\mathbf{g}\n$$\n$$\n\\nabla_{\\mathbf{s}} \\left(\\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s}\\right) = \\mathbf{H}\\mathbf{s}\n$$\n其中第二个结果假设Hessian矩阵 $\\mathbf{H}$ 是对称的，这对二阶导数矩阵是成立的。综合以上结果，模型的梯度为：\n$$\n\\nabla_{\\mathbf{s}} m(\\mathbf{s}) = \\mathbf{g} + \\mathbf{H}\\mathbf{s}\n$$\n牛顿步，记为 $\\mathbf{s}_{N}$，是使 $m(\\mathbf{s})$ 最小化的特定位移。为了求得它，我们将梯度设为零向量：\n$$\n\\mathbf{g} + \\mathbf{H}\\mathbf{s}_{N} = \\mathbf{0}\n$$\n解出 $\\mathbf{s}_{N}$ 即可得到牛顿步的表达式：\n$$\n\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}\n$$\n$$\n\\mathbf{s}_{N} = -\\mathbf{H}^{-1}\\mathbf{g}\n$$\n这要求Hessian矩阵 $\\mathbf{H}$ 是可逆的。给定Hessian矩阵的行列式为 $\\det(\\mathbf{H}) = (1.2)(0.9) - (0.3)(0.3) = 1.08 - 0.09 = 0.99$。由于 $\\det(\\mathbf{H}) \\neq 0$，逆矩阵存在，牛顿步是良定义的。\n\n现在，我们使用给定的数据计算 $\\mathbf{s}_{N}$：\n$$\n\\mathbf{g} =\n\\begin{pmatrix}\n0.06 \\\\\n-0.08\n\\end{pmatrix}\n, \\qquad\n\\mathbf{H} =\n\\begin{pmatrix}\n1.2  0.3 \\\\\n0.3  0.9\n\\end{pmatrix}\n$$\n我们求解线性方程组 $\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}$：\n$$\n\\begin{pmatrix}\n1.2  0.3 \\\\\n0.3  0.9\n\\end{pmatrix}\n\\begin{pmatrix}\ns_1 \\\\\ns_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-0.06 \\\\\n0.08\n\\end{pmatrix}\n$$\n这对应于以下方程组：\n1. $1.2s_1 + 0.3s_2 = -0.06$\n2. $0.3s_1 + 0.9s_2 = 0.08$\n\n将第一个方程乘以 $3$ 得到 $3.6s_1 + 0.9s_2 = -0.18$。从这个结果中减去第二个方程可以消去 $s_2$：\n$$\n(3.6s_1 - 0.3s_1) = -0.18 - 0.08\n$$\n$$\n3.3s_1 = -0.26 \\implies s_1 = -\\frac{0.26}{3.3} = -\\frac{26}{330} = -\\frac{13}{165}\n$$\n将 $s_1$ 代回第二个方程：\n$$\n0.3\\left(-\\frac{13}{165}\\right) + 0.9s_2 = 0.08\n$$\n$$\n-\\frac{3.9}{165} + 0.9s_2 = 0.08 \\implies -\\frac{13}{550} + 0.9s_2 = \\frac{8}{100} = \\frac{2}{25}\n$$\n$$\n0.9s_2 = \\frac{2}{25} + \\frac{13}{550} = \\frac{44}{550} + \\frac{13}{550} = \\frac{57}{550}\n$$\n$$\ns_2 = \\frac{57}{550 \\times 0.9} = \\frac{57}{495} = \\frac{19}{165}\n$$\n所以，牛顿步为 $\\mathbf{s}_{N} = \\begin{pmatrix} -13/165 \\\\ 19/165 \\end{pmatrix}$。\n\n接下来，我们计算预测的二次能量变化 $\\Delta E_{\\text{pred}}$：\n$$\n\\Delta E_{\\text{pred}} = m(\\mathbf{s}_{N}) - m(\\mathbf{0})\n$$\n代入 $m(\\mathbf{s})$ 的定义：\n$$\nm(\\mathbf{s}_{N}) = E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N}\n$$\n$$\nm(\\mathbf{0}) = E(\\mathbf{q}_{0})\n$$\n所以，\n$$\n\\Delta E_{\\text{pred}} = \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N}\n$$\n我们可以简化这个表达式。根据牛顿步的推导，我们有 $\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}$。将此代入二次项中：\n$$\n\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N} = \\mathbf{s}_{N}^{\\top}(-\\mathbf{g}) = - \\mathbf{s}_{N}^{\\top}\\mathbf{g}\n$$\n由于 $\\mathbf{s}_{N}^{\\top}\\mathbf{g}$ 是一个标量，它等于其自身的转置，即 $(\\mathbf{s}_{N}^{\\top}\\mathbf{g})^{\\top} = \\mathbf{g}^{\\top}\\mathbf{s}_{N}$。因此，$\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}^{\\top}\\mathbf{s}_{N}$。\n能量变化变为：\n$$\n\\Delta E_{\\text{pred}} = \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}(-\\mathbf{g}^{\\top}\\mathbf{s}_{N}) = \\frac{1}{2}\\mathbf{g}^{\\top}\\mathbf{s}_{N}\n$$\n现在，我们计算这个值：\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2}\n\\begin{pmatrix}\n0.06  -0.08\n\\end{pmatrix}\n\\begin{pmatrix}\n-13/165 \\\\\n19/165\n\\end{pmatrix}\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2} \\left[ (0.06)\\left(-\\frac{13}{165}\\right) + (-0.08)\\left(\\frac{19}{165}\\right) \\right]\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2 \\times 165} \\left[ (0.06)(-13) + (-0.08)(19) \\right]\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{330} \\left[ -0.78 - 1.52 \\right] = \\frac{-2.3}{330} = -\\frac{23}{3300}\n$$\n进行除法运算：\n$$\n\\Delta E_{\\text{pred}} = -\\frac{23}{3300} \\approx -0.00696969... \\ \\text{Hartree}\n$$\n问题要求将此值四舍五入到五位有效数字。第一个非零数字是千分位的 $6$。前五位有效数字是 $6$、$9$、$6$、$9$、$6$。第六位有效数字是 $9$，大于或等于 $5$，因此我们将第五位有效数字向上取整。\n$$\n-0.0069696 \\underline{9}... \\implies -0.0069697\n$$",
            "answer": "$$\\boxed{-0.0069697}$$"
        },
        {
            "introduction": "在实际的大规模计算中，精确计算和求逆Hessian矩阵的代价极为高昂，这使得纯粹的牛顿法难以应用。因此，诸如L-BFGS的拟牛顿法成为了主流选择，它们利用历次迭代的梯度信息来近似构造Hessian的逆。本练习将引导您手动执行L-BFGS算法著名的“双循环递归”过程，从而揭示这一高效算法在每一步中是如何生成搜索方向的。",
            "id": "2894174",
            "problem": "您正在使用准牛顿几何优化方法，在质量加权笛卡尔坐标中对一个小分子的玻恩-奥本海默势能面 (PES) $E(\\mathbf{R})$ 进行最小化。在当前迭代点 $\\mathbf{R}_{k+1}$，您已求得梯度 $\\mathbf{g}_{k+1} = \\nabla E(\\mathbf{R}_{k+1})$。限制内存的Broyden–Fletcher–Goldfarb–Shanno (L-BFGS) 方法通过应用一个隐式的逆Hessian近似 $H_{k+1}$ 来构建步长 $\\mathbf{p}_{k+1} = - H_{k+1} \\mathbf{g}_{k+1}$，该近似 $H_{k+1}$ 是由满足割线条件的过去位移和梯度差对构造的。假设在一个由两个内坐标（以原子单位计）张成的二维子空间中，最近的3对数据（从最旧到最新）为：\n$\\mathbf{s}_{0} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\,\\text{玻尔}$，$\\mathbf{y}_{0} = \\begin{pmatrix}2 \\\\ 0\\end{pmatrix}\\,\\text{哈特里}\\,\\text{玻尔}^{-1}$，\n$\\mathbf{s}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\,\\text{玻尔}$，$\\mathbf{y}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\,\\text{哈特里}\\,\\text{玻尔}^{-1}$，\n$\\mathbf{s}_{2} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}\\,\\text{玻尔}$，$\\mathbf{y}_{2} = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}\\,\\text{哈特里}\\,\\text{玻尔}^{-1}$。\n在 $\\mathbf{R}_{k+1}$ 处的梯度为\n$\\mathbf{g}_{k+1} = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix}\\,\\text{哈特里}\\,\\text{玻尔}^{-1}$。\n使用 L-BFGS 逆Hessian矩阵与向量乘积的标准双循环递归方法（内存 $m=3$），并使用标量乘以单位矩阵 $H_{0} = \\gamma I$（其中 $\\gamma = \\dfrac{\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2}}{\\mathbf{y}_{2}^{\\top} \\mathbf{y}_{2}}$）进行初始化，计算步长 $\\mathbf{p}_{k+1} = -H_{k+1}\\mathbf{g}_{k+1}$。然后，报告其欧几里得范数 $\\|\\mathbf{p}_{k+1}\\|_{2}$。\n将您的答案四舍五入到四位有效数字，并以玻尔为单位表示最终结果。\n您的最终答案必须是一个实数值。",
            "solution": "该问题要求使用限制内存的Broyden–Fletcher–Goldfarb–Shanno (L-BFGS) 算法，为几何优化计算一个搜索方向（或步长） $\\mathbf{p}_{k+1}$。步长由 $\\mathbf{p}_{k+1} = -H_{k+1}\\mathbf{g}_{k+1}$ 给出，其中 $H_{k+1}$ 是近似的逆Hessian矩阵，$\\mathbf{g}_{k+1}$ 是当前几何构型 $\\mathbf{R}_{k+1}$ 下的势能梯度。计算需使用标准的 L-BFGS 双循环递归方法。\n\n首先，我们验证一下问题陈述的有效性。问题提供了所有必要信息：梯度向量 $\\mathbf{g}_{k+1}$、内存大小 $m=3$、最近 $m$ 个位移向量 $\\mathbf{s}_i$ 和梯度差向量 $\\mathbf{y}_i$ 的历史记录，以及初始逆Hessian近似 $H_0$ 的具体公式。L-BFGS 方法要求内存中所有的向量对都满足曲率条件 $\\mathbf{s}_i^\\top \\mathbf{y}_i  0$，以确保Hessian近似矩阵保持正定。我们来检查给定数据是否满足此条件。\n对于 $i=0$：$\\mathbf{s}_{0}^{\\top} \\mathbf{y}_{0} = \\begin{pmatrix}1  0\\end{pmatrix} \\begin{pmatrix}2 \\\\ 0\\end{pmatrix} = 2  0$。\n对于 $i=1$：$\\mathbf{s}_{1}^{\\top} \\mathbf{y}_{1} = \\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = 1  0$。\n对于 $i=2$：$\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2} = \\begin{pmatrix}1  1\\end{pmatrix} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix} = (1)(2) + (1)(1) = 3  0$。\n所有向量对都满足曲率条件。该问题是良态的且科学上合理的。我们继续进行求解。\n\nL-BFGS 双循环递归在不显式构造矩阵 $H_{k+1}$ 的情况下计算乘积 $\\mathbf{r} = H_{k+1}\\mathbf{g}_{k+1}$。算法如下，根据问题的索引（$i=0, 1, 2$ 从最旧到最新）进行调整：\n\n令 $\\mathbf{g} = \\mathbf{g}_{k+1} = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix}$。\n历史数据对为：\n$\\mathbf{s}_{0} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，$\\mathbf{y}_{0} = \\begin{pmatrix}2 \\\\ 0\\end{pmatrix}$\n$\\mathbf{s}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，$\\mathbf{y}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$\n$\\mathbf{s}_{2} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，$\\mathbf{y}_{2} = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}$\n\n我们首先计算标量 $\\rho_i = 1 / (\\mathbf{y}_i^\\top \\mathbf{s}_i)$：\n$\\rho_0 = (\\mathbf{y}_0^\\top \\mathbf{s}_0)^{-1} = (2)^{-1} = \\frac{1}{2}$。\n$\\rho_1 = (\\mathbf{y}_1^\\top \\mathbf{s}_1)^{-1} = (1)^{-1} = 1$。\n$\\rho_2 = (\\mathbf{y}_2^\\top \\mathbf{s}_2)^{-1} = (3)^{-1} = \\frac{1}{3}$。\n\n双循环递归过程如下：\n初始化 $\\mathbf{q} = \\mathbf{g} = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix}$。\n\n**第一个循环（从 $i=2$ 向下到 $0$）：**\n对于 $i=2$：\n$\\alpha_2 = \\rho_2 \\mathbf{s}_2^\\top \\mathbf{q} = \\frac{1}{3} \\begin{pmatrix}1  1\\end{pmatrix} \\begin{pmatrix}3 \\\\ 2\\end{pmatrix} = \\frac{1}{3}(3+2) = \\frac{5}{3}$。\n$\\mathbf{q} \\leftarrow \\mathbf{q} - \\alpha_2 \\mathbf{y}_2 = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix} - \\frac{5}{3} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}3 - \\frac{10}{3} \\\\ 2 - \\frac{5}{3}\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{3} \\\\ \\frac{1}{3}\\end{pmatrix}$。\n\n对于 $i=1$：\n$\\alpha_1 = \\rho_1 \\mathbf{s}_1^\\top \\mathbf{q} = 1 \\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{3} \\\\ \\frac{1}{3}\\end{pmatrix} = \\frac{1}{3}$。\n$\\mathbf{q} \\leftarrow \\mathbf{q} - \\alpha_1 \\mathbf{y}_1 = \\begin{pmatrix}-\\frac{1}{3} \\\\ \\frac{1}{3}\\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{3} \\\\ 0\\end{pmatrix}$。\n\n对于 $i=0$：\n$\\alpha_0 = \\rho_0 \\mathbf{s}_0^\\top \\mathbf{q} = \\frac{1}{2} \\begin{pmatrix}1  0\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{3} \\\\ 0\\end{pmatrix} = -\\frac{1}{6}$。\n$\\mathbf{q} \\leftarrow \\mathbf{q} - \\alpha_0 \\mathbf{y}_0 = \\begin{pmatrix}-\\frac{1}{3} \\\\ 0\\end{pmatrix} - (-\\frac{1}{6}) \\begin{pmatrix}2 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{3} + \\frac{2}{6} \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n第一个循环结束后，向量 $\\mathbf{q}$ 为 $\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。计算出的系数为 $\\alpha_0 = -1/6$, $\\alpha_1 = 1/3$, $\\alpha_2 = 5/3$。\n\n**缩放和初始步长：**\n初始逆Hessian矩阵为 $H_0 = \\gamma I$，其中 $\\gamma = \\frac{\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2}}{\\mathbf{y}_{2}^{\\top} \\mathbf{y}_{2}}$。\n$\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2} = 3$。\n$\\mathbf{y}_{2}^{\\top} \\mathbf{y}_{2} = \\begin{pmatrix}2  1\\end{pmatrix} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix} = 2^2 + 1^2 = 5$。\n因此，$\\gamma = \\frac{3}{5}$。\n初始步长向量 $\\mathbf{r}$ 计算为 $\\mathbf{r} = H_0 \\mathbf{q} = \\frac{3}{5} I \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n**第二个循环（从 $i=0$ 向上到 $2$）：**\n初始化 $\\mathbf{r} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n对于 $i=0$：\n$\\beta_0 = \\rho_0 \\mathbf{y}_0^\\top \\mathbf{r} = \\frac{1}{2} \\begin{pmatrix}2  0\\end{pmatrix} \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} = 0$。\n$\\mathbf{r} \\leftarrow \\mathbf{r} + \\mathbf{s}_0 (\\alpha_0 - \\beta_0) = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} + \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} (-\\frac{1}{6} - 0) = \\begin{pmatrix}-\\frac{1}{6} \\\\ 0\\end{pmatrix}$。\n\n对于 $i=1$：\n$\\beta_1 = \\rho_1 \\mathbf{y}_1^\\top \\mathbf{r} = 1 \\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{6} \\\\ 0\\end{pmatrix} = 0$。\n$\\mathbf{r} \\leftarrow \\mathbf{r} + \\mathbf{s}_1 (\\alpha_1 - \\beta_1) = \\begin{pmatrix}-\\frac{1}{6} \\\\ 0\\end{pmatrix} + \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} (\\frac{1}{3} - 0) = \\begin{pmatrix}-\\frac{1}{6} \\\\ \\frac{1}{3}\\end{pmatrix}$。\n\n对于 $i=2$：\n$\\beta_2 = \\rho_2 \\mathbf{y}_2^\\top \\mathbf{r} = \\frac{1}{3} \\begin{pmatrix}2  1\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{6} \\\\ \\frac{1}{3}\\end{pmatrix} = \\frac{1}{3}(-\\frac{2}{6} + \\frac{1}{3}) = \\frac{1}{3}(-\\frac{1}{3} + \\frac{1}{3}) = 0$。\n$\\mathbf{r} \\leftarrow \\mathbf{r} + \\mathbf{s}_2 (\\alpha_2 - \\beta_2) = \\begin{pmatrix}-\\frac{1}{6} \\\\ \\frac{1}{3}\\end{pmatrix} + \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} (\\frac{5}{3} - 0) = \\begin{pmatrix}-\\frac{1}{6} + \\frac{5}{3} \\\\ \\frac{1}{3} + \\frac{5}{3}\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{6} + \\frac{10}{6} \\\\ \\frac{6}{3}\\end{pmatrix} = \\begin{pmatrix}\\frac{9}{6} \\\\ 2\\end{pmatrix} = \\begin{pmatrix}1.5 \\\\ 2\\end{pmatrix}$。\n\n双循环递归的结果是 $\\mathbf{r} = H_{k+1}\\mathbf{g}_{k+1} = \\begin{pmatrix}1.5 \\\\ 2\\end{pmatrix}$。\nL-BFGS 步长为 $\\mathbf{p}_{k+1} = -\\mathbf{r} = \\begin{pmatrix}-1.5 \\\\ -2\\end{pmatrix}$。该向量的单位是玻尔。\n\n最后的任务是计算该步长向量的欧几里得范数 $\\|\\mathbf{p}_{k+1}\\|_2$。\n$$\n\\|\\mathbf{p}_{k+1}\\|_2 = \\left\\| \\begin{pmatrix}-1.5 \\\\ -2\\end{pmatrix} \\right\\|_2 = \\sqrt{(-1.5)^2 + (-2)^2} = \\sqrt{2.25 + 4} = \\sqrt{6.25} = 2.5\n$$\n其值恰好为 $2.5$。问题要求将答案四舍五入到四位有效数字。因此，结果是 $2.500$。",
            "answer": "$$ \\boxed{2.500} $$"
        },
        {
            "introduction": "当优化算法宣布收敛后，我们如何确定找到的驻点确实是我们所寻找的稳定结构？本练习聚焦于几何优化流程中至关重要的最后一步：驻点性质的表征。它不仅强化了判断局部极小点的数学条件（梯度为零且Hessian矩阵正定），更强调了进行一系列严谨诊断检查的重要性，以确保所得结果在物理上真实可靠，而非数值计算的假象。",
            "id": "2894234",
            "problem": "在一个量子化学几何优化计算中，对一个非线性分子使用了一个维度为$3$的约化内坐标集（整体平动和转动已被投影出去）。计算获得了一个候选驻点，其梯度向量为$\\mathbf{g} = (0,0,0)^{T}$，并且对称Hessian矩阵在这些内坐标下的本征值为$(0.5,\\,1.2,\\,3.0)$（以适当的能量-曲率单位表示）。在接受该结构之前，哪个选项最能概括关于此驻点性质的正确理论结论，以及您应执行的额外诊断性检查以排除数值奇异性或坐标病态？\n\nA. 根据驻点的二阶表征（正定Hessian矩阵意味着在所有方向上均为正曲率），断定其为严格局部极小值。作为诊断性检查，确认外部模式的内坐标投影已正确应用；在质量加权坐标中进行振动分析，以验证所有非平庸模式（即，对于非线性分子，在映射回完整坐标系后有$3N-6$个）都具有实数正频率；检查Hessian矩阵的条件数$\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$以确保其不是病态的；并通过严格的自洽场（SCF）收敛进行交叉验证，如果可用，还可以对选定的Hessian矩阵元进行有限差分检验。\n\nB. 断定其为严格全局极小值，因为所有三个本征值均为正数，并且由于$\\mathbf{g}=\\mathbf{0}$保证了最优性，Hessian矩阵的正定性消除了任何数值问题，因此无需进一步检查。\n\nC. 使用行列式和迹作为决定性判据：由于$\\det(\\mathbf{H}) = 0.5\\times 1.2 \\times 3.0 = 1.8  0$ 且 $\\mathrm{tr}(\\mathbf{H}) = 0.5 + 1.2 + 3.0 = 4.7  0$，因此宣布其为局部极小值；本征值分析、外部模式的投影以及条件数检查都是不必要的。\n\nD. 拒绝该极小值，因为正确的表征需要在笛卡尔坐标中恰好有$6$个零本征值来对应整体的平动和转动；缺少这些零本征值表明Hessian矩阵存在数值奇异性，从而无法得出极小性的结论。",
            "solution": "对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 该体系是一个非线性分子。\n- 几何优化在一个维度为$3$的约化内坐标集中进行。\n- 整体的平动和转动自由度已从此坐标系中投影出去。\n- 已找到一个驻点，其特征是梯度向量$\\mathbf{g} = (0,0,0)^{T}$。\n- 该点的Hessian矩阵$\\mathbf{H}$是对称的。\n- $\\mathbf{H}$在这些内坐标下的本征值为$(\\lambda_1, \\lambda_2, \\lambda_3) = (0.5,\\,1.2,\\,3.0)$（以适当单位表示）。\n\n**第2步：使用提取的已知条件进行验证**\n该问题描述了计算量子化学中表征势能面（PES）上驻点的标准程序。已知条件如下：\n- **科学上合理：** PES、梯度、Hessian矩阵、本征值、内坐标以及外部模式的投影等概念是理论和计算化学的基础。该设定完全符合已建立的科学原理。\n- **适定性：** 问题提供了足够的信息（$\\mathbf{g} = \\mathbf{0}$和所有Hessian本征值），可以根据标准的多元微积分对驻点进行分类。坐标空间的维度（$3$）被精确指定，与梯度向量的维度和本征值的数量相对应。这可能代表一个三原子分子（$3N-6 = 3(3)-6=3$）的完整内坐标集，或者是一个更大分子在子空间中的约束优化。在任何一种情况下，数学分析都是明确定义的。\n- **客观性：** 问题的陈述是精确、定量且无歧义的。它不含任何主观性。\n\n**第3步：结论与行动**\n问题陈述是有效的。这是一个来自量子化学领域的、适定的、科学上合理的问题。将推导出一个解决方案。\n\n**推导与评估**\n\n势能面$E(\\mathbf{q})$上驻点的表征取决于能量相对于坐标$\\mathbf{q}$的一阶和二阶导数。\n驻点的一阶条件是梯度向量$\\mathbf{g} = \\nabla E$必须为零。问题陈述这已满足，因为$\\mathbf{g} = (0,0,0)^{T}$。\n\n二阶条件决定了驻点的性质，并取决于Hessian矩阵$\\mathbf{H}$，其矩阵元为$H_{ij} = \\frac{\\partial^2 E}{\\partial q_i \\partial q_j}$。点的性质由$\\mathbf{H}$的本征值的符号决定：\n- 严格局部极小值要求所有本征值均为正数（一个正定Hessian矩阵）。\n- 过渡态（一阶鞍点）恰好有一个负本征值。更高阶的鞍点有多个负本征值。\n- 局部极大值的所有本征值均为负数。\n\n问题指出，Hessian矩阵是在一个已移除平动和转动的$3$维内坐标集中计算的。本征值为$\\lambda_1 = 0.5$, $\\lambda_2 = 1.2$, $\\lambda_3 = 3.0$。由于所有三个本征值均为正数，Hessian矩阵是正定的。这满足了该驻点相对于这个三维坐标子空间是严格局部极小值的充分条件。\n\n然而，任何理论结论都必须通过实际验证来支持，以排除数值伪影或模型的局限性。在任何严谨的科学研究中，彻底的诊断程序都是强制性的。这些检查包括：\n1.  **振动分析：** 确认一个极小值的最终物理方法是进行振动频率分析。这涉及到在质量加权笛卡尔坐标中计算Hessian矩阵。对于一个真正的极小值，所有$3N-6$个振动频率（对于一个有$N$个原子的非线性分子）必须是实数且为正。内坐标Hessian矩阵的正定性应能保证这一点，但执行该分析可作为一项关键的交叉检查，并确认坐标变换处理正确。\n2.  **数值稳定性：** Hessian矩阵的条件数$\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$是衡量数值敏感性的指标。在此，$\\kappa = 3.0 / 0.5 = 6.0$，这是一个非常小的数，表明这是一个良态问题。一个非常大的$\\kappa$值可能暗示势能面在某个方向上近乎平坦，这可能导致数值精度问题。\n3.  **收敛水平：** 梯度和Hessian矩阵的可靠性取决于底层电子结构计算（例如，自洽场，SCF，程序）和几何优化算法本身的严格收敛。宽松的收敛标准可能导致虚假的驻点。\n4.  **坐标系有效性：** 必须确保所选的内坐标对于分子几何是合适的，并且不会引入奇异性。\n5.  **导数准确性：** 梯度或Hessian矩阵元的有限差分计算可用于验证解析导数代码的正确性，尽管这更多是一个代码验证步骤，而不是常规的诊断性检查。\n\n有了这个正式的背景，我们来评估所提供的选项。\n\n**逐项分析**\n\n**A. 根据驻点的二阶表征（正定Hessian矩阵意味着在所有方向上均为正曲率），断定其为严格局部极小值。作为诊断性检查，确认外部模式的内坐标投影已正确应用；在质量加权坐标中进行振动分析，以验证所有非平庸模式（即，对于非线性分子，在映射回完整坐标系后有$3N-6$个）都具有实数正频率；检查Hessian矩阵的条件数$\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$以确保其不是病态的；并通过严格的自洽场（SCF）收敛进行交叉验证，如果可用，还可以对选定的Hessian矩阵元进行有限差分检验。**\n这个选项基于正定的Hessian矩阵正确地得出该点是严格局部极小值的结论。然后，它列出了一套全面且专业严谨的诊断性检查，这是一个严谨的科学家必须执行的。列出的每一项诊断（振动分析、条件数检查、收敛性验证等）都是验证计算出的分子结构的标准做法。提及映射回$3N-6$个模式，正确地将结果置于完整分子系统的背景中。这个选项是完全正确的。\n**结论：正确**\n\n**B. 断定其为严格全局极小值，因为所有三个本征值均为正数，并且由于$\\mathbf{g}=\\mathbf{0}$保证了最优性，Hessian矩阵的正定性消除了任何数值问题，因此无需进一步检查。**\n这个选项有根本性的缺陷。首先，二阶条件只提供关于驻点*局部*邻域的信息；它们无法说明该点是否为*全局*极小值。其次，“无需进一步检查”的断言在科学上是鲁莽的。本征值的正性并不能消除潜在的数值问题，例如在另一种情况下可能出现的SCF收敛不佳或病态问题。$\\mathbf{g}=\\mathbf{0}$保证“最优性”的说法是含糊的，如果解释为全局最优性则是错误的。\n**结论：不正确**\n\n**C. 使用行列式和迹作为决定性判据：由于$\\det(\\mathbf{H}) = 0.5\\times 1.2 \\times 3.0 = 1.8  0$ 且 $\\mathrm{tr}(\\mathbf{H}) = 0.5 + 1.2 + 3.0 = 4.7  0$，因此宣布其为局部极小值；本征值分析、外部模式的投影以及条件数检查都是不必要的。**\n这个选项的推理在数学上是不充分的。虽然对于一个对称的$2 \\times 2$矩阵，正的行列式和迹确实意味着正的本征值，但这对于维度$n  2$的矩阵是不成立的。根据Sylvester判据，一个对称矩阵是正定的当且仅当其所有顺序主子式均为正。对于一个$3 \\times 3$矩阵，需要检查三个行列式，而不仅仅是迹和总行列式。最直接和确定的方法是本征值分析本身。将本征值分析和其他关键的诊断性检查视为“不必要”是错误的。\n**结论：不正确**\n\n**D. 拒绝该极小值，因为正确的表征需要在笛卡尔坐标中恰好有$6$个零本征值来对应整体的平动和转动；缺少这些零本征值表明Hessian矩阵存在数值奇异性，从而无法得出极小性的结论。**\n这个选项显示了对坐标系的严重误解。Hessian矩阵需要有$6$个零本征值（对于非线性分子）的要求仅适用于在完整的$3N$笛卡尔坐标中进行计算时。问题明确指出，使用的是“约化的内坐标集”，其中“整体平动和转动已被投影出去”。在这样的坐标系中，它只表示内自由度（$3N-6$），一个极小值的特征是*所有*本征值均为正。缺少零本征值不是一个缺陷；它是在这个坐标系中极小值的*预期*结果。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}