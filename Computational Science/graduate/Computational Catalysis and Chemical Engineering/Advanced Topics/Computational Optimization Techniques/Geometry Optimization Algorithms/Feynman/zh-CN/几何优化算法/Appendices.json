{
    "hands_on_practices": [
        {
            "introduction": "几何优化的核心是迭代地走向势能面的最低点。牛顿法（Newton's method）是理解这些算法的基石。通过将当前几何构型附近的势能面（PES）近似为一个二次函数，我们可以解析地计算出直接指向该二次模型最小点的步长，这被称为牛顿步长 。这个练习将通过一个二维的例子，让你亲手计算牛顿步长，从而直观地理解基于二阶信息的最优化是如何工作的。",
            "id": "2894209",
            "problem": "在一次使用标度化的无量纲内坐标进行的量子化学几何优化中，当前结构 $\\mathbf{q}_{0}$ 邻域内的电子能量 $E(\\mathbf{q})$ 由二阶泰勒模型近似：\n$$\nm(\\mathbf{s}) \\equiv E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s},\n$$\n其中 $\\mathbf{s} = \\mathbf{q} - \\mathbf{q}_{0}$ 是位移，$\\mathbf{g} = \\nabla E(\\mathbf{q}_{0})$ 是梯度，$\\mathbf{H} = \\nabla^{2} E(\\mathbf{q}_{0})$ 是Hessian矩阵。由于坐标在构建时是无量纲的，因此 $\\mathbf{g}$ 和 $\\mathbf{H}$ 的单位都是能量。牛顿步被定义为使该二次模型最小化的位移。\n\n假设在 $\\mathbf{q}_{0}$ 处，梯度和Hessian矩阵为：\n$$\n\\mathbf{g} =\n\\begin{pmatrix}\n0.06 \\\\\n-0.08\n\\end{pmatrix}\n\\ \\text{Hartree}, \n\\qquad\n\\mathbf{H} =\n\\begin{pmatrix}\n1.2  0.3 \\\\\n0.3  0.9\n\\end{pmatrix}\n\\ \\text{Hartree}.\n$$\n从二阶泰勒模型和极小值点的定义出发，推导用 $\\mathbf{g}$ 和 $\\mathbf{H}$ 表示的牛顿步 $\\mathbf{s}_{N}$ 的表达式，利用上述数据显式计算 $\\mathbf{s}_{N}$，然后评估预测的二次能量变化：\n$$\n\\Delta E_{\\text{pred}} \\equiv m(\\mathbf{s}_{N}) - m(\\mathbf{0}).\n$$\n以Hartree为单位表示最终的能量变化，并将您的答案四舍五入到五位有效数字。最终答案必须是单个实数。",
            "solution": "所述问题在科学上是合理的，提法恰当，并包含了唯一解所需的所有信息。Hessian矩阵是正定的，这保证了二次模型有唯一的极小值。因此，我将继续进行求解。\n\n目标是找到使电子能量的二次模型最小化的位移 $\\mathbf{s}$：\n$$\nm(\\mathbf{s}) = E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s}\n$$\n可微函数达到极小值的一个必要条件是其梯度为零。我们必须计算 $m(\\mathbf{s})$ 相对于位移矢量 $\\mathbf{s}$ 的梯度，并将其设为零矢量。\n梯度由下式给出：\n$$\n\\nabla_{\\mathbf{s}} m(\\mathbf{s}) = \\nabla_{\\mathbf{s}} \\left( E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s} \\right)\n$$\n项 $E(\\mathbf{q}_{0})$ 相对于 $\\mathbf{s}$ 是一个常数，所以它的导数为零。线性和二次项的导数是矢量微积分中的标准结果：\n$$\n\\nabla_{\\mathbf{s}} (\\mathbf{g}^{\\top}\\mathbf{s}) = \\mathbf{g}\n$$\n$$\n\\nabla_{\\mathbf{s}} \\left(\\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s}\\right) = \\mathbf{H}\\mathbf{s}\n$$\n其中第二个结果假设Hessian矩阵 $\\mathbf{H}$ 是对称的，这对于二阶导数矩阵是成立的。综合这些，模型的梯度为：\n$$\n\\nabla_{\\mathbf{s}} m(\\mathbf{s}) = \\mathbf{g} + \\mathbf{H}\\mathbf{s}\n$$\n牛顿步，记为 $\\mathbf{s}_{N}$，是使 $m(\\mathbf{s})$ 最小化的特定位移。为了找到它，我们将梯度设为零矢量：\n$$\n\\mathbf{g} + \\mathbf{H}\\mathbf{s}_{N} = \\mathbf{0}\n$$\n求解 $\\mathbf{s}_{N}$ 得到牛顿步的表达式：\n$$\n\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}\n$$\n$$\n\\mathbf{s}_{N} = -\\mathbf{H}^{-1}\\mathbf{g}\n$$\n这要求Hessian矩阵 $\\mathbf{H}$ 是可逆的。给定Hessian矩阵的行列式为 $\\det(\\mathbf{H}) = (1.2)(0.9) - (0.3)(0.3) = 1.08 - 0.09 = 0.99$。由于 $\\det(\\mathbf{H}) \\neq 0$，逆矩阵存在，牛顿步是良定义的。\n\n现在，我们使用所提供的数据计算 $\\mathbf{s}_{N}$：\n$$\n\\mathbf{g} =\n\\begin{pmatrix}\n0.06 \\\\\n-0.08\n\\end{pmatrix}\n, \\qquad\n\\mathbf{H} =\n\\begin{pmatrix}\n1.2  0.3 \\\\\n0.3  0.9\n\\end{pmatrix}\n$$\n我们求解线性系统 $\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}$：\n$$\n\\begin{pmatrix}\n1.2  0.3 \\\\\n0.3  0.9\n\\end{pmatrix}\n\\begin{pmatrix}\ns_1 \\\\\ns_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-0.06 \\\\\n0.08\n\\end{pmatrix}\n$$\n这对应于以下方程组：\n1. $1.2s_1 + 0.3s_2 = -0.06$\n2. $0.3s_1 + 0.9s_2 = 0.08$\n\n将第一个方程乘以 $3$ 得到 $3.6s_1 + 0.9s_2 = -0.18$。从该结果中减去第二个方程以消去 $s_2$：\n$$\n(3.6s_1 - 0.3s_1) = -0.18 - 0.08\n$$\n$$\n3.3s_1 = -0.26 \\implies s_1 = -\\frac{0.26}{3.3} = -\\frac{26}{330} = -\\frac{13}{165}\n$$\n将 $s_1$ 代回第二个方程：\n$$\n0.3\\left(-\\frac{13}{165}\\right) + 0.9s_2 = 0.08\n$$\n$$\n-\\frac{3.9}{165} + 0.9s_2 = 0.08 \\implies -\\frac{13}{550} + 0.9s_2 = \\frac{8}{100} = \\frac{2}{25}\n$$\n$$\n0.9s_2 = \\frac{2}{25} + \\frac{13}{550} = \\frac{44}{550} + \\frac{13}{550} = \\frac{57}{550}\n$$\n$$\ns_2 = \\frac{57}{550 \\times 0.9} = \\frac{57}{495} = \\frac{19}{165}\n$$\n所以，牛顿步为 $\\mathbf{s}_{N} = \\begin{pmatrix} -13/165 \\\\ 19/165 \\end{pmatrix}$。\n\n接下来，我们评估预测的二次能量变化 $\\Delta E_{\\text{pred}}$：\n$$\n\\Delta E_{\\text{pred}} = m(\\mathbf{s}_{N}) - m(\\mathbf{0})\n$$\n代入 $m(\\mathbf{s})$ 的定义：\n$$\nm(\\mathbf{s}_{N}) = E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N}\n$$\n$$\nm(\\mathbf{0}) = E(\\mathbf{q}_{0})\n$$\n所以，\n$$\n\\Delta E_{\\text{pred}} = \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N}\n$$\n我们可以简化这个表达式。从牛顿步的推导中，我们有 $\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}$。将此代入二次项：\n$$\n\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N} = \\mathbf{s}_{N}^{\\top}(-\\mathbf{g}) = - \\mathbf{s}_{N}^{\\top}\\mathbf{g}\n$$\n由于 $\\mathbf{s}_{N}^{\\top}\\mathbf{g}$ 是一个标量，它等于其自身的转置，$(\\mathbf{s}_{N}^{\\top}\\mathbf{g})^{\\top} = \\mathbf{g}^{\\top}\\mathbf{s}_{N}$。因此，$\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}^{\\top}\\mathbf{s}_{N}$。\n能量变化变为：\n$$\n\\Delta E_{\\text{pred}} = \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}(-\\mathbf{g}^{\\top}\\mathbf{s}_{N}) = \\frac{1}{2}\\mathbf{g}^{\\top}\\mathbf{s}_{N}\n$$\n现在，我们计算这个值：\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2}\n\\begin{pmatrix}\n0.06  -0.08\n\\end{pmatrix}\n\\begin{pmatrix}\n-13/165 \\\\\n19/165\n\\end{pmatrix}\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2} \\left[ (0.06)\\left(-\\frac{13}{165}\\right) + (-0.08)\\left(\\frac{19}{165}\\right) \\right]\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2 \\times 165} \\left[ (0.06)(-13) + (-0.08)(19) \\right]\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{330} \\left[ -0.78 - 1.52 \\right] = \\frac{-2.3}{330} = -\\frac{23}{3300}\n$$\n进行除法运算：\n$$\n\\Delta E_{\\text{pred}} = -\\frac{23}{3300} \\approx -0.00696969... \\ \\text{Hartree}\n$$\n问题要求将此值四舍五入到五位有效数字。第一个非零数字是千分位上的 $6$。前五位有效数字是 $6$、$9$、$6$、$9$、$6$。第六位有效数字是 $9$，大于或等于 $5$，所以我们将第五位数字向上取整。\n$$\n-0.0069696 \\underline{9}... \\implies -0.0069697\n$$",
            "answer": "$$\\boxed{-0.0069697}$$"
        },
        {
            "introduction": "虽然牛顿法在理论上是强大的，但在实践中，为大体系计算和求逆完整的Hessian矩阵通常计算成本过高。有限内存的Broyden–Fletcher–Goldfarb–Shanno（L-BFGS）算法是解决这一问题的优雅方案，它也是计算化学中最常用的准牛顿（quasi-Newton）方法之一 。这个练习将带你深入L-BFGS算法的内部，使用其著名的“双循环递归”方法，仅根据先前步骤的梯度信息来近似Hessian矩阵的逆，并计算出优化步长。",
            "id": "2894174",
            "problem": "您正在使用准牛顿几何优化方法，在质量加权笛卡尔坐标下最小化一个小分子的 Born–Oppenheimer 势能面 (PES) $E(\\mathbf{R})$。在当前迭代点 $\\mathbf{R}_{k+1}$，您已求得梯度 $\\mathbf{g}_{k+1} = \\nabla E(\\mathbf{R}_{k+1})$。有限内存 Broyden–Fletcher–Goldfarb–Shanno (L-BFGS) 方法通过应用一个隐式逆 Hessian 近似 $H_{k+1}$ 来构建步长 $\\mathbf{p}_{k+1} = - H_{k+1} \\mathbf{g}_{k+1}$，该近似由满足割线条件的过去位移和梯度差对构造。假设存在一个由两个内坐标（以原子单位计）张成的二维子空间，并且最近的 $3$ 组数据对（从最旧到最新）为：\n$\\mathbf{s}_{0} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\,\\text{bohr}$，$\\mathbf{y}_{0} = \\begin{pmatrix}2 \\\\ 0\\end{pmatrix}\\,\\text{Ha}\\,\\text{bohr}^{-1}$，\n$\\mathbf{s}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\,\\text{bohr}$，$\\mathbf{y}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\,\\text{Ha}\\,\\text{bohr}^{-1}$，\n$\\mathbf{s}_{2} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}\\,\\text{bohr}$，$\\mathbf{y}_{2} = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}\\,\\text{Ha}\\,\\text{bohr}^{-1}$。\n在 $\\mathbf{R}_{k+1}$ 处的梯度为\n$\\mathbf{g}_{k+1} = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix}\\,\\text{Ha}\\,\\text{bohr}^{-1}$。\n请使用 L-BFGS 逆 Hessian 乘积的标准双循环递归方法（内存 $m=3$），并用标量乘以单位矩阵 $H_{0} = \\gamma I$（其中 $\\gamma = \\dfrac{\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2}}{\\mathbf{y}_{2}^{\\top} \\mathbf{y}_{2}}$）进行初始化，来计算步长 $\\mathbf{p}_{k+1} = -H_{k+1}\\mathbf{g}_{k+1}$。然后，报告其欧几里得范数 $\\|\\mathbf{p}_{k+1}\\|_{2}$。\n将您的答案四舍五入到四位有效数字，并以玻尔（bohr）为单位表示最终结果。\n您的最终答案必须是一个实数值。",
            "solution": "该问题要求使用有限内存 Broyden–Fletcher–Goldfarb–Shanno (L-BFGS) 算法，为几何优化计算搜索方向（或步长）$\\mathbf{p}_{k+1}$。步长由 $\\mathbf{p}_{k+1} = -H_{k+1}\\mathbf{g}_{k+1}$ 给出，其中 $H_{k+1}$ 是近似逆 Hessian 矩阵，$\\mathbf{g}_{k+1}$ 是在当前几何构型 $\\mathbf{R}_{k+1}$ 处的势能梯度。计算需使用标准的 L-BFGS 双循环递归方法。\n\n首先，我们验证题目陈述的有效性。题目提供了所有必要信息：梯度向量 $\\mathbf{g}_{k+1}$，内存大小 $m=3$，最近 $m$ 个位移向量 $\\mathbf{s}_i$ 和梯度差向量 $\\mathbf{y}_i$ 的历史记录，以及初始逆 Hessian 近似 $H_0$ 的具体公式。L-BFGS 方法要求内存中所有的向量对都满足曲率条件 $\\mathbf{s}_i^\\top \\mathbf{y}_i > 0$，以确保 Hessian 近似保持正定。我们来检查给定数据的这个条件。\n对于 $i=0$：$\\mathbf{s}_{0}^{\\top} \\mathbf{y}_{0} = \\begin{pmatrix}1  0\\end{pmatrix} \\begin{pmatrix}2 \\\\ 0\\end{pmatrix} = 2 > 0$。\n对于 $i=1$：$\\mathbf{s}_{1}^{\\top} \\mathbf{y}_{1} = \\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = 1 > 0$。\n对于 $i=2$：$\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2} = \\begin{pmatrix}1  1\\end{pmatrix} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix} = (1)(2) + (1)(1) = 3 > 0$。\n所有数据对都满足曲率条件。该问题是适定的且科学上合理的。我们继续进行求解。\n\nL-BFGS 双循环递归在不显式构造矩阵 $H_{k+1}$ 的情况下计算乘积 $\\mathbf{r} = H_{k+1}\\mathbf{g}_{k+1}$。根据问题的索引（$i=0, 1, 2$ 从最旧到最新），算法如下：\n\n设 $\\mathbf{g} = \\mathbf{g}_{k+1} = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix}$。\n历史数据对为：\n$\\mathbf{s}_{0} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，$\\mathbf{y}_{0} = \\begin{pmatrix}2 \\\\ 0\\end{pmatrix}$\n$\\mathbf{s}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，$\\mathbf{y}_{1} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$\n$\\mathbf{s}_{2} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，$\\mathbf{y}_{2} = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}$\n\n我们首先计算标量 $\\rho_i = 1 / (\\mathbf{y}_i^\\top \\mathbf{s}_i)$:\n$\\rho_0 = (\\mathbf{y}_0^\\top \\mathbf{s}_0)^{-1} = (2)^{-1} = \\frac{1}{2}$。\n$\\rho_1 = (\\mathbf{y}_1^\\top \\mathbf{s}_1)^{-1} = (1)^{-1} = 1$。\n$\\rho_2 = (\\mathbf{y}_2^\\top \\mathbf{s}_2)^{-1} = (3)^{-1} = \\frac{1}{3}$。\n\n双循环递归过程如下：\n初始化 $\\mathbf{q} = \\mathbf{g} = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix}$。\n\n**第一个循环（从 $i=2$ 向下到 $0$）：**\n对于 $i=2$：\n$\\alpha_2 = \\rho_2 \\mathbf{s}_2^\\top \\mathbf{q} = \\frac{1}{3} \\begin{pmatrix}1  1\\end{pmatrix} \\begin{pmatrix}3 \\\\ 2\\end{pmatrix} = \\frac{1}{3}(3+2) = \\frac{5}{3}$。\n$\\mathbf{q} \\leftarrow \\mathbf{q} - \\alpha_2 \\mathbf{y}_2 = \\begin{pmatrix}3 \\\\ 2\\end{pmatrix} - \\frac{5}{3} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}3 - \\frac{10}{3} \\\\ 2 - \\frac{5}{3}\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{3} \\\\ \\frac{1}{3}\\end{pmatrix}$。\n\n对于 $i=1$：\n$\\alpha_1 = \\rho_1 \\mathbf{s}_1^\\top \\mathbf{q} = 1 \\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{3} \\\\ \\frac{1}{3}\\end{pmatrix} = \\frac{1}{3}$。\n$\\mathbf{q} \\leftarrow \\mathbf{q} - \\alpha_1 \\mathbf{y}_1 = \\begin{pmatrix}-\\frac{1}{3} \\\\ \\frac{1}{3}\\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{3} \\\\ 0\\end{pmatrix}$。\n\n对于 $i=0$：\n$\\alpha_0 = \\rho_0 \\mathbf{s}_0^\\top \\mathbf{q} = \\frac{1}{2} \\begin{pmatrix}1  0\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{3} \\\\ 0\\end{pmatrix} = -\\frac{1}{6}$。\n$\\mathbf{q} \\leftarrow \\mathbf{q} - \\alpha_0 \\mathbf{y}_0 = \\begin{pmatrix}-\\frac{1}{3} \\\\ 0\\end{pmatrix} - (-\\frac{1}{6}) \\begin{pmatrix}2 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{3} + \\frac{2}{6} \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n第一个循环结束后，向量 $\\mathbf{q}$ 是 $\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。计算出的系数为 $\\alpha_0 = -1/6$，$\\alpha_1 = 1/3$，$\\alpha_2 = 5/3$。\n\n**缩放和初始步长：**\n初始逆 Hessian 为 $H_0 = \\gamma I$，其中 $\\gamma = \\frac{\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2}}{\\mathbf{y}_{2}^{\\top} \\mathbf{y}_{2}}$。\n$\\mathbf{s}_{2}^{\\top} \\mathbf{y}_{2} = 3$。\n$\\mathbf{y}_{2}^{\\top} \\mathbf{y}_{2} = \\begin{pmatrix}2  1\\end{pmatrix} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix} = 2^2 + 1^2 = 5$。\n所以，$\\gamma = \\frac{3}{5}$。\n初始步长向量 $\\mathbf{r}$ 计算为 $\\mathbf{r} = H_0 \\mathbf{q} = \\frac{3}{5} I \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n**第二个循环（从 $i=0$ 向上到 $2$）：**\n初始化 $\\mathbf{r} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n对于 $i=0$：\n$\\beta_0 = \\rho_0 \\mathbf{y}_0^\\top \\mathbf{r} = \\frac{1}{2} \\begin{pmatrix}2  0\\end{pmatrix} \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} = 0$。\n$\\mathbf{r} \\leftarrow \\mathbf{r} + \\mathbf{s}_0 (\\alpha_0 - \\beta_0) = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} + \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} (-\\frac{1}{6} - 0) = \\begin{pmatrix}-\\frac{1}{6} \\\\ 0\\end{pmatrix}$。\n\n对于 $i=1$：\n$\\beta_1 = \\rho_1 \\mathbf{y}_1^\\top \\mathbf{r} = 1 \\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{6} \\\\ 0\\end{pmatrix} = 0$。\n$\\mathbf{r} \\leftarrow \\mathbf{r} + \\mathbf{s}_1 (\\alpha_1 - \\beta_1) = \\begin{pmatrix}-\\frac{1}{6} \\\\ 0\\end{pmatrix} + \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} (\\frac{1}{3} - 0) = \\begin{pmatrix}-\\frac{1}{6} \\\\ \\frac{1}{3}\\end{pmatrix}$。\n\n对于 $i=2$：\n$\\beta_2 = \\rho_2 \\mathbf{y}_2^\\top \\mathbf{r} = \\frac{1}{3} \\begin{pmatrix}2  1\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{6} \\\\ \\frac{1}{3}\\end{pmatrix} = \\frac{1}{3}(-\\frac{2}{6} + \\frac{1}{3}) = \\frac{1}{3}(-\\frac{1}{3} + \\frac{1}{3}) = 0$。\n$\\mathbf{r} \\leftarrow \\mathbf{r} + \\mathbf{s}_2 (\\alpha_2 - \\beta_2) = \\begin{pmatrix}-\\frac{1}{6} \\\\ \\frac{1}{3}\\end{pmatrix} + \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} (\\frac{5}{3} - 0) = \\begin{pmatrix}-\\frac{1}{6} + \\frac{5}{3} \\\\ \\frac{1}{3} + \\frac{5}{3}\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{6} + \\frac{10}{6} \\\\ \\frac{6}{3}\\end{pmatrix} = \\begin{pmatrix}\\frac{9}{6} \\\\ 2\\end{pmatrix} = \\begin{pmatrix}1.5 \\\\ 2\\end{pmatrix}$。\n\n双循环递归的结果是 $\\mathbf{r} = H_{k+1}\\mathbf{g}_{k+1} = \\begin{pmatrix}1.5 \\\\ 2\\end{pmatrix}$。\nL-BFGS 步长为 $\\mathbf{p}_{k+1} = -\\mathbf{r} = \\begin{pmatrix}-1.5 \\\\ -2\\end{pmatrix}$。该向量的单位是玻尔。\n\n最后的任务是计算该步长向量的欧几里得范数 $\\|\\mathbf{p}_{k+1}\\|_2$。\n$$\n\\|\\mathbf{p}_{k+1}\\|_2 = \\left\\| \\begin{pmatrix}-1.5 \\\\ -2\\end{pmatrix} \\right\\|_2 = \\sqrt{(-1.5)^2 + (-2)^2} = \\sqrt{2.25 + 4} = \\sqrt{6.25} = 2.5\n$$\n其值恰好为 $2.5$。题目要求将答案四舍五入到四位有效数字。因此，结果是 $2.500$。",
            "answer": "$$ \\boxed{2.500} $$"
        },
        {
            "introduction": "在催化研究中，寻找反应的过渡态（即势能面上的一阶鞍点）与寻找能量最低的稳定结构同等重要。然而，过渡态搜索算法有时会错误地收敛到更高阶的鞍点，这些点在化学上没有直接意义。这个练习模拟了这样一个常见挑战，即如何识别一个二阶鞍点，并设计一个有效的策略——特征向量跟随（eigenvector-following）——来“逃离”这个点，并最终定位到化学家真正关心的、作为反应瓶颈的一阶鞍点 。",
            "id": "3880270",
            "problem": "考虑一个催化表面反应，其由一个势能函数 $E(\\mathbf{q})$ 建模，该函数定义在广义坐标 $\\mathbf{q} \\in \\mathbb{R}^{3N}$ 上，其中 $N$ 是周期性平板中团簇区域的原子数。驻点 $\\mathbf{q}^\\star$ 满足 $\\nabla E(\\mathbf{q}^\\star) = \\mathbf{0}$。在计算催化的几何优化中，通过分析Hessian矩阵 $\\mathbf{H}(\\mathbf{q}^\\star) = \\nabla^2 E(\\mathbf{q}^\\star)$ 中编码的曲率来区分极小值点和鞍点，通常在质量加权坐标中进行此分析，以与振动分析保持一致。在投影掉刚体模式和任何受限自由度后，质量加权Hessian矩阵 $\\mathbf{H}_m$ 的本征值表示沿标准正交方向的曲率。\n\n一位研究人员使用密度泛函理论（DFT）在 $\\mathrm{Ni}$ 平板上定位了一个 $\\mathrm{C_2H_4}$ 吸附中间体的驻点。质量加权Hessian矩阵 $\\mathbf{H}_m$ 在一个包含 $M$ 个原子的局部团簇区域内构建，并且团簇的刚体平移和旋转被投影掉。在投影子空间中，$\\mathbf{H}_m$ 的最低6个本征值被数值估计为（单位一致）$\\{-0.12, -0.04, 0.02, 0.07, 0.13, 0.19\\}$。研究人员试图 (i) 可靠地检测该驻点是否为二阶鞍点，以及 (ii) 实施一个科学上合理的方案，从该二阶鞍点逃逸到附近与化学相关过渡态相关联的一阶鞍点，且该方案能扩展到大的 $M$ 值。\n\n从 $E$ 在 $\\mathbf{q}^\\star$ 周围的泰勒展开、梯度和Hessian矩阵的定义，以及质量加权坐标中曲率的标准性质出发，选择一个能够正确分类驻点，并概述一个合理、高效且不变的策略，以将鞍点指数从2降至1而不塌陷到极小值的方案。\n\n哪个选项最能同时满足检测和逃逸的要求？\n\nA. 在 $\\mathbf{q}^\\star$ 处构建质量加权Hessian矩阵 $\\mathbf{H}_m$，投影掉团簇的3个刚体平移和3个刚体旋转（以及任何受限的平板运动），然后使用迭代的Lanczos求解器计算最低的几个本征对。通过计算投影子空间中 $\\mathbf{H}_m$ 的负本征值数量来分类驻点的指数；若有2个负值，则判定为二阶鞍点。为逃逸到一阶鞍点，执行模式选择性本征向量跟随：在Hessian本征基 $\\{\\mathbf{v}_i\\}$ 中分解梯度，选择一个负曲率方向（例如，最负的 $\\mathbf{v}_1$）用于上升，方法是反转沿 $\\mathbf{v}_1$ 的牛顿分量的符号，并同时使用约束在与 $\\mathbf{v}_1$ 正交的子空间中的信赖域步长，沿另一个负模式 $\\mathbf{v}_2$ 和所有正模式进行最小化。周期性地重新对角化，并继续此过程，直到恰好只剩1个负本征值。\n\nB. 通过梯度大小 $\\|\\nabla E(\\mathbf{q}^\\star)\\|$ 检测鞍点阶数，当 $\\|\\nabla E(\\mathbf{q}^\\star)\\|$ 很小但不为零时，判定为二阶鞍点。为了逃逸，执行固定步长 $\\alpha$ 的最速下降步 $-\\alpha \\nabla E$，直到梯度范数增加，然后停止并将新点报告为一阶鞍点。\n\nC. 在未进行质量加权或刚体运动投影的原始笛卡尔Hessian矩阵上计算负本征值数量，如果在所有 $3M$ 个模式中有2个负本征值，则判定为二阶鞍点。为了逃逸，沿两个负本征向量方向采取相等的上坡步骤，即更新 $\\mathbf{q} \\leftarrow \\mathbf{q} + \\alpha \\mathbf{v}_1 + \\alpha \\mathbf{v}_2$，其中 $\\alpha > 0$，直到一个负本征值变为正值。\n\nD. 通过Hessian矩阵行列式的符号验证其为不定矩阵来识别二阶鞍点。为了逃逸，翻转Hessian矩阵的符号，使用 $-\\mathbf{H}^{-1}\\nabla E$ 而不是 $\\mathbf{H}^{-1}\\nabla E$ 构建更新步骤，这将两个负曲率方向转变为正曲率方向，并自动将动力学驱动到一阶鞍点。",
            "solution": "首先对问题陈述进行验证过程。\n\n### 步骤1：提取给定信息\n- **系统**：一个涉及在 $\\mathrm{Ni}$ 平板上的 $\\mathrm{C_2H_4}$ 吸附中间体的催化表面反应。\n- **模型**：一个定义在广义坐标 $\\mathbf{q} \\in \\mathbb{R}^{3N}$ 上的势能函数 $E(\\mathbf{q})$。分析在一个包含 $M$ 个原子的局部团簇区域上进行。\n- **驻点**：满足条件 $\\nabla E(\\mathbf{q}^\\star) = \\mathbf{0}$ 的点 $\\mathbf{q}^\\star$。\n- **分析方法**：在 $\\mathbf{q}^\\star$ 点对质量加权Hessian矩阵 $\\mathbf{H}_m$ 进行本征分析。团簇的刚体平移和旋转模式，以及任何其他受限运动，都被投影掉。\n- **数据**：投影后的质量加权Hessian矩阵 $\\mathbf{H}_m$ 的最低6个本征值给出为 $\\{-0.12, -0.04, 0.02, 0.07, 0.13, 0.19\\}$。\n- **任务**：\n    1.  `(i)` 可靠地检测该驻点是否为二阶鞍点。\n    2.  `(ii)` 实施一个科学上合理且可扩展的方案，从该点找到附近的一阶鞍点。\n- **约束**：该方案必须是高效的（能扩展到大的 $M$ 值）并且避免塌陷到极小值。\n\n### 步骤2：使用提取的给定信息进行验证\n- **科学依据**：该问题牢固地植根于计算化学和物理学的原理，特别是势能面（PES）上驻点的表征。使用梯度 $\\nabla E$ 和Hessian矩阵 $\\mathbf{H} = \\nabla^2 E$、质量加权、投影非内部模式以及解释Hessian本征值都是几何优化和过渡态理论中标准、成熟的做法。所描述的情景是催化反应机理模拟中常见的情况。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了具体的数据（本征值），并要求根据清晰、客观的标准（正确的检测、合理且高效的逃逸）来评估方案。可以在选项中确定唯一的最佳答案。\n- **客观性**：该问题使用精确、客观和标准的科学术语陈述。没有主观或基于意见的元素。\n\n### 步骤3：结论与行动\n问题陈述是有效的。它在科学上是合理的、适定的和客观的，描述了计算材料科学中的一个标准挑战。可以进行求解过程。\n\n### 推导与分析\n\n对势能面 $E(\\mathbf{q})$ 上的驻点 $\\mathbf{q}^\\star$ 的分析依赖于局部曲率，该曲率由Hessian矩阵 $\\mathbf{H}_{ij} = \\frac{\\partial^2 E}{\\partial q_i \\partial q_j}$ 描述。为了与振动模式对应，分析使用质量加权Hessian矩阵 $\\mathbf{H}_m$ 进行。在投影掉对应于刚体平移和旋转（其能量成本为零，因此对应于零本征值）的自由度后，$\\mathbf{H}_m$ 的剩余本征值决定了驻点的性质。\n\n驻点的*指数*定义为投影后Hessian矩阵的负本征值的数量。\n- 指数为 $0$（所有本征值为正）对应于局域极小值。\n- 指数为 $1$（一个负本征值，其余为正）对应于一阶鞍点，可被识别为化学反应的过渡态（TS）。\n- 指数为 $k > 1$ 对应于 $k$ 阶鞍点。这些通常不是物理上有意义的过渡态，但在搜索一阶鞍点时经常遇到。\n\n**第(i)部分：检测**\n问题提供了投影后的质量加权Hessian矩阵的最低6个本征值为 $\\{-0.12, -0.04, 0.02, 0.07, 0.13, 0.19\\}$。通过检查，可以发现恰好有两个负本征值，即 $-0.12$ 和 $-0.04$。因此，鞍点指数为 $2$。该驻点 $\\mathbf{q}^\\star$ 被正确地分类为**二阶鞍点**。对经过适当准备（质量加权和投影）的Hessian矩阵计算负本征值数量的方法是正确且可靠的检测方案。对于大体系（大的 $M$），计算整个Hessian矩阵并对其进行对角化在计算上是昂贵的（复杂度为 $O(M^3)$）。迭代方法，如Lanczos或Davidson算法，在寻找最低的几个本征对方面效率要高得多，复杂度接近 $O(M^2)$，是大规模计算的标准方法。\n\n**第(ii)部分：逃逸**\n目标是从二阶鞍点（指数为2）移动到一阶鞍点（指数为1）。二阶鞍点在对应于负本征值（$\\lambda_1  0, \\lambda_2  0$）的两个本征向量（$\\mathbf{v}_1$, $\\mathbf{v}_2$）的方向上是极大值，而在所有其他正交方向上是极小值。要找到附近的一阶鞍点，必须沿着一条能消除一个不稳定方向同时保留另一个不稳定方向的路径。\n\n这可以通过**本征向量跟随**（或模式跟随）算法实现。其过程如下：\n1. 选择其中一个不稳定模式，使其成为目标一阶鞍点的唯一虚频模式。一个常见的选择是具有最负本征值的模式，例如对应于 $\\lambda_1 = -0.12$ 的 $\\mathbf{v}_1$。\n2. 优化算法必须沿着所选方向 $\\mathbf{v}_1$ 最大化能量，同时在所有其他方向上最小化能量。这包括第二个不稳定模式方向 $\\mathbf{v}_2$ 和所有稳定模式方向（对应于正本征值）。\n3. 这是一个约束优化问题。计算一个准牛顿步长 $\\delta\\mathbf{q}$。在Hessian本征向量基 $\\{\\mathbf{v}_i\\}$ 中，该步长被设计为沿 $\\mathbf{v}_1$“上坡”，并沿所有其他 $i \\neq 1$ 的 $\\mathbf{v}_i$“下坡”。沿 $\\mathbf{v}_1$ 的上坡步骤可以通过在步长计算中有效地翻转其相应力常数（本征值）的符号来实现。例如，在有理函数优化（RFO）或信赖域框架中，优化器被指示沿特定模式上坡。\n4. 随着几何结构偏离 $\\mathbf{q}^\\star$，梯度 $\\nabla E$ 变得非零，Hessian矩阵及其本征基也会改变。必须周期性地重新计算（或更新）Hessian矩阵并重新对角化（或重新计算其最低的几个本征对），以更新最大化和最小化的方向。\n5. 持续此过程，直到找到一个新的驻点，其Hessian矩阵恰好有一个负本征值。\n\n该方案正确地识别了在势能面上的期望转变，并使用一种有针对性、高效的方法来实现它，满足了要求。\n\n### 逐项分析选项\n\n**A. 在 $\\mathbf{q}^\\star$ 处构建质量加权Hessian矩阵 $\\mathbf{H}_m$，投影掉团簇的3个刚体平移和3个刚体旋转（以及任何受限的平板运动），然后使用迭代的Lanczos求解器计算最低的几个本征对。通过计算投影子空间中 $\\mathbf{H}_m$ 的负本征值数量来分类驻点的指数；若有2个负值，则判定为二阶鞍点。为逃逸到一阶鞍点，执行模式选择性本征向量跟随：在Hessian本征基 $\\{\\mathbf{v}_i\\}$ 中分解梯度，选择一个负曲率方向（例如，最负的 $\\mathbf{v}_1$）用于上升，方法是反转沿 $\\mathbf{v}_1$ 的牛顿分量的符号，并同时使用约束在与 $\\mathbf{v}_1$ 正交的子空间中的信赖域步长，沿另一个负模式 $\\mathbf{v}_2$ 和所有正模式进行最小化。周期性地重新对角化，并继续此过程，直到恰好只剩1个负本征值。**\n\n- **结论：正确**。\n- **理由**：\n    - 检测部分正确地指明了质量加权、投影掉无关紧要的模式、使用可扩展的迭代求解器（Lanczos），以及通过计算负本征值数量进行分类。这是当前最先进的程序。\n    - 逃逸部分准确地描述了本征向量跟随方法，该方法正是为这项任务而设计的。它正确地指出了需要沿着一个选定的不稳定模式上升，同时沿着所有其他模式（包括另一个不稳定模式）下降，以将鞍点指数从2降至1。提及信赖域和周期性重新对角化突显了该实现的鲁棒性和实用性。\n\n**B. 通过梯度大小 $\\|\\nabla E(\\mathbf{q}^\\star)\\|$ 检测鞍点阶数，当 $\\|\\nabla E(\\mathbf{q}^\\star)\\|$ 很小但不为零时，判定为二阶鞍点。为了逃逸，执行固定步长 $\\alpha$ 的最速下降步 $-\\alpha \\nabla E$，直到梯度范数增加，然后停止并将新点报告为一阶鞍点。**\n\n- **结论：不正确**。\n- **理由**：\n    - 检测方法存在根本性缺陷。驻点由 $\\nabla E(\\mathbf{q}^\\star) = \\mathbf{0}$ 定义。梯度的大小（数值上应接近于零）不提供任何关于局部曲率（即Hessian本征值）的信息，因此无法区分极小值、一阶鞍点或更高阶鞍点。\n    - 逃逸方法也是不正确的。最速下降法 $-\\alpha \\nabla E$ 是一种最小化算法。从驻点开始，它要么什么都不做（如果 $\\nabla E = \\mathbf{0}$），要么向局域极小值移动。它不能用于定位鞍点。\n\n**C. 在未进行质量加权或刚体运动投影的原始笛卡尔Hessian矩阵上计算负本征值数量，如果在所有 $3M$ 个模式中有2个负本征值，则判定为二阶鞍点。为了逃逸，沿两个负本征向量方向采取相等的上坡步骤，即更新 $\\mathbf{q} \\leftarrow \\mathbf{q} + \\alpha \\mathbf{v}_1 + \\alpha \\mathbf{v}_2$，其中 $\\alpha > 0$，直到一个负本征值变为正值。**\n\n- **结论：不正确**。\n- **理由**：\n    - 检测方法有缺陷。不使用质量加权使得与物理振动的联系变得模糊不清。关键的是，不投影掉刚体运动意味着将存在6个（或5个）接近零的本征值，这些值在数值上可能略为正或负，从而破坏了对真实的内部负曲率模式的计数。该方案不鲁棒。\n    - 逃逸策略适得其反。沿*两个*不稳定方向（$\\mathbf{v}_1$ 和 $\\mathbf{v}_2$）同时采取上坡步骤，会将体系移向这两个模式所张成的子空间中的局域极大值。这不会将鞍点指数降至1；它会使体系离任何一阶鞍点更远。目标是沿一个不稳定模式下坡以“稳定”它。\n\n**D. 通过Hessian矩阵行列式的符号验证其为不定矩阵来识别二阶鞍点。为了逃逸，翻转Hessian矩阵的符号，使用 $-\\mathbf{H}^{-1}\\nabla E$ 而不是 $\\mathbf{H}^{-1}\\nabla E$ 构建更新步骤，这将两个负曲率方向转变为正曲率方向，并自动将动力学驱动到一阶鞍点。**\n\n- **结论：不正确**。\n- **理由**：\n    - 检测方法不充分。Hessian矩阵的行列式是其本征值的乘积，$\\det(\\mathbf{H}) = \\prod_i \\lambda_i$。对于二阶鞍点（两个负本征值），行列式为正。然而，局域极小值（零个负本征值）和任何其他偶数指数的鞍点也具有正行列式。因此，行列式的符号不能唯一地识别二阶鞍点。\n    - 逃逸方法毫无道理。翻转整个Hessian矩阵的符号（$\\mathbf{H} \\to -\\mathbf{H}$）会将所有稳定方向变为不稳定方向，反之亦然。在这个反转的势能面上进行最小化，会寻找原始势能面上的极大值，而不是一阶鞍点。关于更新步骤的陈述也很混乱；用于最小化的标准牛顿-拉夫逊步骤已经是 $-\\mathbf{H}^{-1}\\nabla E$。该方案不是一个公认或有效的鞍点优化方法。它是一种粗糙的方法，没有提供所需的选择性控制。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}