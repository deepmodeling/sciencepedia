{
    "hands_on_practices": [
        {
            "introduction": "贝叶斯优化的核心是构建一个能够量化不确定性的代理模型，而高斯过程（GP）正是实现这一目标的关键工具。本练习旨在通过一个具体的计算任务，帮助您深入理解高斯过程的内部工作机制。您将根据给定的训练数据和核函数值，从第一性原理出发，推导并计算在某个新测试点上的后验均值和方差，从而亲身体验GP模型是如何结合已有观测和先验知识来做出预测并评估其置信度的 。",
            "id": "3869839",
            "problem": "在用于催化剂发现的贝叶斯优化中，使用高斯过程（GP）代理模型来表示从催化剂描述符到可测量的性能指标（如归一化对数转换频率）的未知映射。高斯过程（GP）先验假设训练点和测试点的潜函数值服从一个由半正定核函数决定的联合多元正态分布。观测值被建模为受独立加性高斯噪声干扰的潜函数，其方差由一个噪声超参数控制。考虑两个催化剂，其描述符向量收集在集合 $X$ 中，以及一个新的测试催化剂描述符 $x_{\\ast}$。训练输出是测得的归一化对数转换频率 $y \\in \\mathbb{R}^{2}$，建模为 $y = f(X) + \\epsilon$，其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma_{n}^{2} I)$，$\\sigma_{n}^{2}$ 是观测噪声方差（噪声超参数），$I$ 是适当维度的单位矩阵。在这些点上计算的核函数值由 $2 \\times 2$ 矩阵 $K(X,X)$、$2 \\times 1$ 向量 $k(X,x_{\\ast})$ 和标量 $k(x_{\\ast},x_{\\ast})$ 给出：\n$$\nK(X,X) = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad k(X,x_{\\ast}) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad k(x_{\\ast},x_{\\ast}) = 2.\n$$\n假设观测输出为\n$$\ny = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}.\n$$\n从潜函数值的联合多元正态分布定义和观测模型 $y = f(X) + \\epsilon$（其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma_{n}^{2} I)$）出发，推导在测试点 $x_{\\ast}$ 处的高斯过程后验分布，并用噪声超参数 $\\sigma_{n}^{2}$ 显式计算后验均值 $\\mu_{\\ast}$ 和后验方差 $\\sigma_{\\ast}^{2}$。通过将 $\\sigma_{\\ast}^{2}$ 表示为 $\\sigma_{n}^{2}$ 的函数，说明噪声超参数如何影响不确定性。将最终答案以一个包含两个条目 $(\\mu_{\\ast}, \\sigma_{\\ast}^{2})$ 的行矩阵形式报告。无需四舍五入。将所有量视为无量纲。",
            "solution": "该问题是适定的、有科学依据的、客观的，并包含了获得唯一解所需的所有信息。提供的核矩阵 $K(X,X)$ 是对称且正定的，其特征值为 1 和 3，这证实了其作为协方差矩阵的有效性。因此，该问题是有效的，我们可以继续进行推导。\n\n高斯过程（GP）回归的核心是假设任何有限的函数值集合都服从联合多元正态分布。我们首先考虑训练点处的潜（未观测）函数值 $f(X)$ 和测试点处的潜函数值 $f(x_{\\ast})$。为简化符号，令 $f_{\\ast} = f(x_{\\ast})$。假设一个零均值高斯过程先验，其联合分布为：\n$$\n\\begin{pmatrix} f(X) \\\\ f_{\\ast} \\end{pmatrix} \\sim \\mathcal{N} \\left( \\mathbf{0}, \\begin{pmatrix} K(X,X)  k(X,x_{\\ast}) \\\\ k(X,x_{\\ast})^T  k(x_{\\ast},x_{\\ast}) \\end{pmatrix} \\right)\n$$\n其中 $\\mathcal{N}$ 表示多元正态分布，$\\mathbf{0}$ 是适当维度的零向量，分块矩阵是由核函数 $k$ 定义的协方差矩阵。\n\n问题陈述，观测值 $y$ 受到独立同分布的高斯噪声 $\\epsilon \\sim \\mathcal{N}(0, \\sigma_{n}^{2}I)$ 的干扰，其中 $I$ 是单位矩阵。观测模型为 $y = f(X) + \\epsilon$。这意味着观测向量 $y$ 也是一个高斯随机变量。$y$ 的分布是通过对随机变量 $f(X)$ 和 $\\epsilon$ 求和得到的。由于两者均为零均值，因此 $y$ 的均值也为零。$y$ 的协方差是协方差之和：$\\text{Cov}(y) = \\text{Cov}(f(X)) + \\text{Cov}(\\epsilon) = K(X,X) + \\sigma_{n}^{2}I$。噪声 $\\epsilon$ 与潜函数值无关，因此 $y$ 和 $f_{\\ast}$ 之间的协方差与 $f(X)$ 和 $f_{\\ast}$ 之间的协方差相同，即 $k(X,x_{\\ast})$。\n\n因此，观测到的训练输出 $y$ 和测试点处的潜函数值 $f_{\\ast}$ 的联合分布为：\n$$\n\\begin{pmatrix} y \\\\ f_{\\ast} \\end{pmatrix} \\sim \\mathcal{N} \\left( \\mathbf{0}, \\begin{pmatrix} K(X,X) + \\sigma_{n}^{2}I  k(X,x_{\\ast}) \\\\ k(X,x_{\\ast})^T  k(x_{\\ast},x_{\\ast}) \\end{pmatrix} \\right)\n$$\n目标是求给定观测数据 $y$ 时 $f_{\\ast}$ 的后验分布，即 $p(f_{\\ast} | y, X, x_{\\ast})$。对于一个分块多元正态分布 $\\begin{pmatrix} z_{1} \\\\ z_{2} \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{pmatrix}, \\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix} \\right)$，条件分布 $p(z_{2} | z_{1})$ 也是高斯的，其均值和协方差由以下公式给出：\n$$\n\\mu_{2|1} = \\mu_{2} + \\Sigma_{21} \\Sigma_{11}^{-1} (z_{1} - \\mu_{1})\n$$\n$$\n\\Sigma_{22|1} = \\Sigma_{22} - \\Sigma_{21} \\Sigma_{11}^{-1} \\Sigma_{12}\n$$\n通过映射我们的变量（$z_{1} \\to y$, $z_{2} \\to f_{\\ast}$）和参数（$\\mu_{1} \\to \\mathbf{0}$, $\\mu_{2} \\to 0$, $\\Sigma_{11} \\to K(X,X)+\\sigma_n^2 I$, $\\Sigma_{12} \\to k(X,x_{\\ast})$, $\\Sigma_{21} \\to k(X,x_{\\ast})^T$, $\\Sigma_{22} \\to k(x_{\\ast},x_{\\ast})$），我们得到 $f_{\\ast}$ 的后验均值 $\\mu_{\\ast}$ 和后验方差 $\\sigma_{\\ast}^{2}$：\n$$\n\\mu_{\\ast} = k(X,x_{\\ast})^T (K(X,X) + \\sigma_{n}^{2}I)^{-1} y\n$$\n$$\n\\sigma_{\\ast}^{2} = k(x_{\\ast},x_{\\ast}) - k(X,x_{\\ast})^T (K(X,X) + \\sigma_{n}^{2}I)^{-1} k(X,x_{\\ast})\n$$\n现在我们将给定的值代入这些表达式。输入如下：\n$$\nK(X,X) = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad k(X,x_{\\ast}) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad k(x_{\\ast},x_{\\ast}) = 2, \\quad y = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}\n$$\n首先，我们计算待求逆的矩阵，记为 $K_{y} = K(X,X) + \\sigma_{n}^{2}I$：\n$$\nK_{y} = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} + \\sigma_{n}^{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2+\\sigma_{n}^{2}  1 \\\\ 1  2+\\sigma_{n}^{2} \\end{pmatrix}\n$$\n该矩阵的行列式为 $\\det(K_{y}) = (2+\\sigma_{n}^{2})^{2} - 1^{2} = 4 + 4\\sigma_{n}^{2} + (\\sigma_{n}^{2})^{2} - 1 = (\\sigma_{n}^{2})^{2} + 4\\sigma_{n}^{2} + 3$。这可以因式分解为 $(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)$。\n其逆矩阵为：\n$$\nK_{y}^{-1} = \\frac{1}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} \\begin{pmatrix} 2+\\sigma_{n}^{2}  -1 \\\\ -1  2+\\sigma_{n}^{2} \\end{pmatrix}\n$$\n现在我们计算后验均值 $\\mu_{\\ast}$：\n$$\n\\mu_{\\ast} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\frac{1}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} \\begin{pmatrix} 2+\\sigma_{n}^{2}  -1 \\\\ -1  2+\\sigma_{n}^{2} \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}\n$$\n首先，将逆矩阵乘以向量 $y$：\n$$\n\\begin{pmatrix} 2+\\sigma_{n}^{2}  -1 \\\\ -1  2+\\sigma_{n}^{2} \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 3(2+\\sigma_{n}^{2}) - 1 \\\\ -3 + (2+\\sigma_{n}^{2}) \\end{pmatrix} = \\begin{pmatrix} 6+3\\sigma_{n}^{2}-1 \\\\ -1+\\sigma_{n}^{2} \\end{pmatrix} = \\begin{pmatrix} 5+3\\sigma_{n}^{2} \\\\ -1+\\sigma_{n}^{2} \\end{pmatrix}\n$$\n然后，左乘 $k(X,x_{\\ast})^T$：\n$$\n\\mu_{\\ast} = \\frac{1}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 5+3\\sigma_{n}^{2} \\\\ -1+\\sigma_{n}^{2} \\end{pmatrix} = \\frac{(5+3\\sigma_{n}^{2}) + (-1+\\sigma_{n}^{2})}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} = \\frac{4+4\\sigma_{n}^{2}}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)}\n$$\n简化该表达式可得：\n$$\n\\mu_{\\ast} = \\frac{4(\\sigma_{n}^{2}+1)}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} = \\frac{4}{\\sigma_{n}^{2}+3}\n$$\n接下来，我们计算后验方差 $\\sigma_{\\ast}^{2}$：\n$$\n\\sigma_{\\ast}^{2} = k(x_{\\ast},x_{\\ast}) - k(X,x_{\\ast})^T K_{y}^{-1} k(X,x_{\\ast}) = 2 - \\begin{pmatrix} 1  1 \\end{pmatrix} K_{y}^{-1} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n我们来计算二次型项。首先计算 $K_{y}^{-1} k(X,x_{\\ast})$：\n$$\nK_{y}^{-1} k(X,x_{\\ast}) = \\frac{1}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} \\begin{pmatrix} 2+\\sigma_{n}^{2}  -1 \\\\ -1  2+\\sigma_{n}^{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} \\begin{pmatrix} 1+\\sigma_{n}^{2} \\\\ 1+\\sigma_{n}^{2} \\end{pmatrix}\n$$\n然后，左乘 $k(X,x_{\\ast})^T$：\n$$\nk(X,x_{\\ast})^T K_{y}^{-1} k(X,x_{\\ast}) = \\frac{1}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1+\\sigma_{n}^{2} \\\\ 1+\\sigma_{n}^{2} \\end{pmatrix} = \\frac{2(1+\\sigma_{n}^{2})}{(\\sigma_{n}^{2}+1)(\\sigma_{n}^{2}+3)} = \\frac{2}{\\sigma_{n}^{2}+3}\n$$\n最后，我们将此结果代回 $\\sigma_{\\ast}^{2}$ 的表达式中：\n$$\n\\sigma_{\\ast}^{2} = 2 - \\frac{2}{\\sigma_{n}^{2}+3} = \\frac{2(\\sigma_{n}^{2}+3) - 2}{\\sigma_{n}^{2}+3} = \\frac{2\\sigma_{n}^{2}+6-2}{\\sigma_{n}^{2}+3} = \\frac{2\\sigma_{n}^{2}+4}{\\sigma_{n}^{2}+3} = \\frac{2(\\sigma_{n}^{2}+2)}{\\sigma_{n}^{2}+3}\n$$\n后验方差 $\\sigma_{\\ast}^{2}$ 明确地显示了它对噪声超参数 $\\sigma_{n}^{2}$ 的依赖性。当 $\\sigma_{n}^{2} \\to \\infty$ 时，观测噪声占主导地位，使得训练数据不具信息量。在此极限下，$\\mu_{\\ast} \\to 0$（先验均值），而 $\\sigma_{\\ast}^{2} \\to 2$（先验方差 $k(x_{\\ast},x_{\\ast})$）。相反，当 $\\sigma_{n}^{2} \\to 0$ 时，模型对无噪声的训练数据变得高度自信，得到 $\\mu_{\\ast} \\to 4/3$ 和 $\\sigma_{\\ast}^{2} \\to 4/3$。\n\n因此，后验均值和方差的最终结果是：\n$\\mu_{\\ast} = \\frac{4}{\\sigma_{n}^{2}+3}$\n$\\sigma_{\\ast}^{2} = \\frac{2(\\sigma_{n}^{2}+2)}{\\sigma_{n}^{2}+3}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4}{\\sigma_{n}^{2} + 3}  \\frac{2(\\sigma_{n}^{2} + 2)}{\\sigma_{n}^{2} + 3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "拥有了代理模型后，下一个关键问题是：“接下来应该测试哪个候选催化剂？” 这就需要采集函数（acquisition function）来指导实验的选择。本练习将聚焦于最经典的采集函数之一——期望提升（Expected Improvement, EI）。通过为几个具有不同预测均值（$\\mu$）和不确定性（$\\sigma$）的候选催化剂计算EI值，您将深刻理解贝叶斯优化是如何在“利用”（exploitation，选择高均值区域）和“探索”（exploration，探索高不确定性区域）之间做出权衡，从而实现高效的全局优化 。",
            "id": "3869785",
            "problem": "一个研究团队正在使用贝叶斯优化来加速发现一种在固定反应条件下能够最大化每个活性位点转换频率（单位为 $\\mathrm{s}^{-1}$）的多相催化剂。一个高斯过程（GP, Gaussian Process）代理模型已在现有数据上进行了训练。对于三种尚未测试的候选组分，其活性 $Y$ 的高斯过程后验预测分布被建模为均值为 $\\mu$、标准差为 $\\sigma$ 的正态分布：$Y \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。目前观测到的最佳活性为 $y^{\\star} = 1.75$ $\\mathrm{s}^{-1}$，三种候选材料具有以下预测参数：\n- 候选者 1：$\\mu_{1} = 1.80$ $\\mathrm{s}^{-1}$，$\\sigma_{1} = 0.20$ $\\mathrm{s}^{-1}$。\n- 候选者 2：$\\mu_{2} = 1.60$ $\\mathrm{s}^{-1}$，$\\sigma_{2} = 0.60$ $\\mathrm{s}^{-1}$。\n- 候选者 3：$\\mu_{3} = 2.00$ $\\mathrm{s}^{-1}$，$\\sigma_{3} = 0.05$ $\\mathrm{s}^{-1}$。\n\n将最大化目标的提升随机变量定义为 $I = \\max\\{0, Y - y^{\\star}\\}$。仅使用数学期望的定义、正态分布的性质和标准微积分，完成以下任务：\n\n1. 从 $I$ 的定义和 $Y \\sim \\mathcal{N}(\\mu,\\sigma^{2})$ 出发，推导期望提升 $\\mathbb{E}[I]$ 关于 $\\mu$、$\\sigma$ 和 $y^{\\star}$ 的解析表达式。\n2. 使用给定的 $(\\mu,\\sigma)$ 值为每个候选者数值计算期望提升。将每个期望提升以 $\\mathrm{s}^{-1}$ 为单位表示，并四舍五入到四位有效数字。\n3. 按期望提升对三个候选者进行降序排名，并确定下一个应选择的单个候选者。\n\n最终答案仅报告具有最高期望提升的候选者的索引（即 $1$、$2$ 或 $3$）。最终答案中不应包含任何其他信息。",
            "solution": "该问题已经过验证，具有科学依据、提法得当且客观。这是贝叶斯优化原理在计算科学中的一个标准应用。我们现在开始进行解答。\n\n该问题需要一个包含三部分的解答：首先，推导期望提升（$\\mathbb{E}[I]$）的解析表达式；其次，为三种候选催化剂计算其值；第三，对候选者进行排序并选择下一个要测试的。\n\n### 第1部分：期望提升表达式的推导\n\n对于最大化问题，提升随机变量 $I$ 定义为 $I = \\max\\{0, Y - y^{\\star}\\}$，其中 $Y$ 是预测的活性，$y^{\\star}$ 是目前观测到的最佳活性。候选者的活性 $Y$ 由高斯过程后验建模，这是一个正态分布 $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其概率密度函数 (PDF) 为：\n$$f_Y(y) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right)$$\n期望提升 $\\mathbb{E}[I]$ 是随机变量 $I$ 的期望。根据连续随机变量的数学期望定义，我们有：\n$$\\mathbb{E}[I] = \\int_{-\\infty}^{\\infty} I(y) f_Y(y) \\, dy = \\int_{-\\infty}^{\\infty} \\max\\{0, y - y^{\\star}\\} f_Y(y) \\, dy$$\n$\\max\\{0, y - y^{\\star}\\}$ 项仅在 $y  y^{\\star}$ 时非零。因此，积分下限可以从 $-\\infty$ 变为 $y^{\\star}$，被积函数变为 $y - y^{\\star}$：\n$$\\mathbb{E}[I] = \\int_{y^{\\star}}^{\\infty} (y - y^{\\star}) f_Y(y) \\, dy$$\n我们可以将这个积分分成两部分：\n$$\\mathbb{E}[I] = \\int_{y^{\\star}}^{\\infty} y f_Y(y) \\, dy - y^{\\star} \\int_{y^{\\star}}^{\\infty} f_Y(y) \\, dy$$\n为计算这些积分，我们进行变量替换，转换为标准正态分布。令 $z = \\frac{y - \\mu}{\\sigma}$。这意味着 $y = \\mu + \\sigma z$ 且 $dy = \\sigma dz$。标准正态分布的PDF是 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$。原始PDF可以写成 $f_Y(y)dy = \\frac{1}{\\sigma} \\phi\\left(\\frac{y-\\mu}{\\sigma}\\right) dy = \\phi(z) dz$。$y$ 的积分下限是 $y^{\\star}$，对应的标准化值为 $z_{std} = \\frac{y^{\\star} - \\mu}{\\sigma}$。上限 $y \\to \\infty$ 对应于 $z \\to \\infty$。\n\n将这些代入拆分后的积分表达式中：\n$$\\mathbb{E}[I] = \\int_{z_{std}}^{\\infty} (\\mu + \\sigma z) \\phi(z) \\, dz - y^{\\star} \\int_{z_{std}}^{\\infty} \\phi(z) \\, dz$$\n合并项：\n$$\\mathbb{E}[I] = \\int_{z_{std}}^{\\infty} (\\mu - y^{\\star} + \\sigma z) \\phi(z) \\, dz$$\n$$\\mathbb{E}[I] = (\\mu - y^{\\star}) \\int_{z_{std}}^{\\infty} \\phi(z) \\, dz + \\sigma \\int_{z_{std}}^{\\infty} z \\phi(z) \\, dz$$\n让我们来计算每一项。第一个积分是标准正态变量 $Z$ 大于 $z_{std}$ 的概率，即 $P(Z  z_{std})$。这可以用标准正态累积分布函数 (CDF) $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t) \\, dt$ 表示为 $1 - \\Phi(z_{std})$。\n第二个积分是：\n$$\\int_{z_{std}}^{\\infty} z \\phi(z) \\, dz = \\int_{z_{std}}^{\\infty} z \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) \\, dz$$\n这个积分可以通过认识到 $\\exp(-z^2/2)$ 关于 $z$ 的导数是 $-z \\exp(-z^2/2)$ 来求解。因此，$z \\exp(-z^2/2)$ 的一个原函数是 $-\\exp(-z^2/2)$。\n$$\\int_{z_{std}}^{\\infty} z \\phi(z) \\, dz = \\frac{1}{\\sqrt{2\\pi}} \\left[-\\exp\\left(-\\frac{z^2}{2}\\right)\\right]_{z_{std}}^{\\infty} = -\\frac{1}{\\sqrt{2\\pi}} \\left( \\lim_{z \\to \\infty} \\exp\\left(-\\frac{z^2}{2}\\right) - \\exp\\left(-\\frac{z_{std}^2}{2}\\right) \\right)$$\n$$= -\\frac{1}{\\sqrt{2\\pi}} \\left(0 - \\exp\\left(-\\frac{z_{std}^2}{2}\\right)\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z_{std}^2}{2}\\right) = \\phi(z_{std})$$\n将这些结果代回，我们得到期望提升的解析表达式：\n$$\\mathbb{E}[I] = (\\mu - y^{\\star})(1 - \\Phi(z_{std})) + \\sigma \\phi(z_{std})$$\n其中 $z_{std} = \\frac{y^{\\star} - \\mu}{\\sigma}$。这就是最终推导出的表达式。\n\n### 第2部分：对每个候选者进行数值计算\n\n给定 $y^{\\star} = 1.75$ $\\mathrm{s}^{-1}$。我们使用推导出的公式为三个候选者中的每一个计算 $\\mathbb{E}[I]$。我们将需要标准正态PDF $\\phi(z)$ 和 CDF $\\Phi(z)$ 的数值。\n\n**候选者 1：** $\\mu_{1} = 1.80$ $\\mathrm{s}^{-1}$，$\\sigma_{1} = 0.20$ $\\mathrm{s}^{-1}$。\n首先，我们计算标准化值 $z_{std,1}$：\n$$z_{std,1} = \\frac{y^{\\star} - \\mu_1}{\\sigma_1} = \\frac{1.75 - 1.80}{0.20} = -0.25$$\n现在我们查找 $\\phi(-0.25)$ 和 $\\Phi(-0.25)$ 的值。使用标准表格或计算器：$\\phi(-0.25) = \\phi(0.25) \\approx 0.38667$ 且 $\\Phi(-0.25) = 1 - \\Phi(0.25) \\approx 1 - 0.59871 = 0.40129$。\n将这些值代入 $\\mathbb{E}[I_1]$ 的表达式中：\n$$\\mathbb{E}[I_1] = (\\mu_1 - y^{\\star})(1 - \\Phi(z_{std,1})) + \\sigma_1 \\phi(z_{std,1})$$\n$$\\mathbb{E}[I_1] = (1.80 - 1.75)(1 - \\Phi(-0.25)) + (0.20)\\phi(-0.25)$$\n$$\\mathbb{E}[I_1] = (0.05)(\\Phi(0.25)) + (0.20)\\phi(0.25)$$\n$$\\mathbb{E}[I_1] \\approx (0.05)(0.59871) + (0.20)(0.38667) \\approx 0.0299355 + 0.077334 \\approx 0.1072695$$\n四舍五入到四位有效数字，$\\mathbb{E}[I_1] \\approx 0.1073$ $\\mathrm{s}^{-1}$。\n\n**候选者 2：** $\\mu_{2} = 1.60$ $\\mathrm{s}^{-1}$，$\\sigma_{2} = 0.60$ $\\mathrm{s}^{-1}$。\n标准化值 $z_{std,2}$：\n$$z_{std,2} = \\frac{y^{\\star} - \\mu_2}{\\sigma_2} = \\frac{1.75 - 1.60}{0.60} = \\frac{0.15}{0.60} = 0.25$$\n我们需要 $\\phi(0.25) \\approx 0.38667$ 和 $\\Phi(0.25) \\approx 0.59871$。\n代入 $\\mathbb{E}[I_2]$ 的表达式中：\n$$\\mathbb{E}[I_2] = (\\mu_2 - y^{\\star})(1 - \\Phi(z_{std,2})) + \\sigma_2 \\phi(z_{std,2})$$\n$$\\mathbb{E}[I_2] = (1.60 - 1.75)(1 - \\Phi(0.25)) + (0.60)\\phi(0.25)$$\n$$\\mathbb{E}[I_2] \\approx (-0.15)(1 - 0.59871) + (0.60)(0.38667)$$\n$$\\mathbb{E}[I_2] \\approx (-0.15)(0.40129) + 0.232002 \\approx -0.0601935 + 0.232002 \\approx 0.1718085$$\n四舍五入到四位有效数字，$\\mathbb{E}[I_2] \\approx 0.1718$ $\\mathrm{s}^{-1}$。\n\n**候选者 3：** $\\mu_{3} = 2.00$ $\\mathrm{s}^{-1}$，$\\sigma_{3} = 0.05$ $\\mathrm{s}^{-1}$。\n标准化值 $z_{std,3}$：\n$$z_{std,3} = \\frac{y^{\\star} - \\mu_3}{\\sigma_3} = \\frac{1.75 - 2.00}{0.05} = \\frac{-0.25}{0.05} = -5$$\n我们需要 $\\phi(-5)$ 和 $\\Phi(-5)$。对于大的负 $z$ 值，这些值变得非常小。\n$\\phi(-5) = \\phi(5) \\approx 1.4867 \\times 10^{-6}$。\n$\\Phi(-5) = 1 - \\Phi(5) \\approx 2.8665 \\times 10^{-7}$。\n代入 $\\mathbb{E}[I_3]$ 的表达式中：\n$$\\mathbb{E}[I_3] = (\\mu_3 - y^{\\star})(1 - \\Phi(z_{std,3})) + \\sigma_3 \\phi(z_{std,3})$$\n$$\\mathbb{E}[I_3] = (2.00 - 1.75)(1 - \\Phi(-5)) + (0.05)\\phi(-5)$$\n$$\\mathbb{E}[I_3] = (0.25)(\\Phi(5)) + (0.05)\\phi(5)$$\n$$\\mathbb{E}[I_3] \\approx (0.25)(1 - 2.8665 \\times 10^{-7}) + (0.05)(1.4867 \\times 10^{-6})$$\n$$\\mathbb{E}[I_3] \\approx (0.25 - 7.166 \\times 10^{-8}) + (7.4335 \\times 10^{-8}) \\approx 0.25000000267$$\n四舍五入到四位有效数字，$\\mathbb{E}[I_3] \\approx 0.2500$ $\\mathrm{s}^{-1}$。\n\n### 第3部分：排名与选择\n\n计算出的期望提升为：\n-   $\\mathbb{E}[I_1] \\approx 0.1073$ $\\mathrm{s}^{-1}$\n-   $\\mathbb{E}[I_2] \\approx 0.1718$ $\\mathrm{s}^{-1}$\n-   $\\mathbb{E}[I_3] \\approx 0.2500$ $\\mathrm{s}^{-1}$\n\n将这些值按降序排列：\n1.  候选者 3: $\\mathbb{E}[I_3] \\approx 0.2500$ $\\mathrm{s}^{-1}$\n2.  候选者 2: $\\mathbb{E}[I_2] \\approx 0.1718$ $\\mathrm{s}^{-1}$\n3.  候选者 1: $\\mathbb{E}[I_1] \\approx 0.1073$ $\\mathrm{s}^{-1}$\n\n在使用期望提升采集函数的贝叶斯优化中，策略是为下一个实验选择具有最大 $\\mathbb{E}[I]$ 值的候选者。在这种情况下，候选者 3 具有最高的期望提升。因此，它就是下一个应该被选择的单个候选者。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在真实的催化剂研发中，我们不仅要追求高活性，还必须满足如热稳定性、成本等一系列约束条件。本练习将引导您进入更贴近实际应用的带约束贝叶斯优化领域。您将学习如何使用高斯过程分类器来为约束条件（如稳定性）建模，并计算其“可行性概率”（Probability of Feasibility, PF）。通过将可行性概率与活性的期望提升（EI）相结合，您可以构建一个综合的采集函数，从而在多重限制下更智能地搜寻最优催化剂 。",
            "id": "3869775",
            "problem": "一个催化剂发现活动使用高斯过程（GP）回归来模拟归一化催化活性，并使用一个GP分类器来模拟一个捕捉反应条件下热稳定性的二元可行性约束。在一个位于成分-工艺空间中的候选点 $x_{\\mathrm{c}}$ 处，活性 $f(x)$ 的GP回归后验是高斯分布，其均值为 $\\mu_{f} = 1.05$，标准差为 $\\sigma_{f} = 0.20$，当前观测到的最佳活性为 $f^{\\star} = 0.95$。GP分类器对可行性标签采用概率单位（probit）链接函数，其中在 $x_{\\mathrm{c}}$ 处的潜变量 $h(x)$ 服从高斯分布，均值为 $\\mu_{h} = 0.70$，方差为 $\\sigma_{h}^{2} = 0.36$。\n\n从标准正态密度函数和累积分布函数的定义、高斯预测模型的期望提升（EI）以及GP分类中的概率单位似然出发，完成以下任务：\n\n- 推导可行性概率 $\\mathrm{PF}(x_{\\mathrm{c}})$，其为在 $x_{\\mathrm{c}}$ 处高斯潜变量预测分布下，概率单位链接函数的期望值。\n- 推导在 $x_{\\mathrm{c}}$ 处活性模型的期望提升 $\\mathrm{EI}(x_{\\mathrm{c}})$。\n- 在 $x_{\\mathrm{c}}$ 处目标和约束后验相互独立的普遍假设下，将两者结合起来，形成用于采集排序的约束采集值 $a_{\\mathrm{c}}(x_{\\mathrm{c}}) = \\mathrm{PF}(x_{\\mathrm{c}})\\cdot\\mathrm{EI}(x_{\\mathrm{c}})$。\n\n使用所提供的数值计算 $a_{\\mathrm{c}}(x_{\\mathrm{c}})$。将最终的约束采集值四舍五入到四位有效数字。将最终答案表示为无量纲量。",
            "solution": "用户提供的问题被评估为有效。它在材料科学的贝叶斯优化领域具有科学依据，问题设定良好，给出的条件完整且一致，并以客观、正式的语言表述。该问题要求推导和计算该领域的标准量，并提供了所有必要的信息。\n\n该问题要求计算在候选点 $x_{\\mathrm{c}}$ 处的约束采集值 $a_{\\mathrm{c}}(x_{\\mathrm{c}})$，定义为 $a_{\\mathrm{c}}(x_{\\mathrm{c}}) = \\mathrm{PF}(x_{\\mathrm{c}})\\cdot\\mathrm{EI}(x_{\\mathrm{c}})$。这需要推导和计算两个部分：可行性概率 $\\mathrm{PF}(x_{\\mathrm{c}})$ 和期望提升 $\\mathrm{EI}(x_{\\mathrm{c}})$。\n\n**1. 可行性概率 $\\mathrm{PF}(x_{\\mathrm{c}})$ 的推导与计算**\n\n热稳定性由一个二元可行性标签建模。问题指出，GP分类器使用概率单位（probit）链接函数。对于一个潜变量 $h(x)$，点 $x$ 是可行的（标签 $y=1$）的概率由 $P(y=1|h(x)) = \\Phi(h(x))$ 给出，其中 $\\Phi(\\cdot)$ 是标准正态累积分布函数（CDF）。\n\n在 $x_{\\mathrm{c}}$ 处的可行性概率 $\\mathrm{PF}(x_{\\mathrm{c}})$ 是该似然在潜变量 $h(x_{\\mathrm{c}})$ 的后验预测分布上的期望。$h(x_{\\mathrm{c}})$ 的后验被给定为高斯分布，$h(x_{\\mathrm{c}}) \\sim \\mathcal{N}(h; \\mu_{h}, \\sigma_{h}^{2})$。\n\n$$\n\\mathrm{PF}(x_{\\mathrm{c}}) = \\mathbb{E}_{h \\sim \\mathcal{N}(\\mu_h, \\sigma_h^2)}[\\Phi(h)] = \\int_{-\\infty}^{\\infty} \\Phi(h) \\, \\mathcal{N}(h; \\mu_{h}, \\sigma_{h}^{2}) \\, dh\n$$\n\n为了求解这个积分，我们可以将 $\\Phi(h)$ 表示为一个概率陈述。设 $z \\sim \\mathcal{N}(0, 1)$ 是一个独立于 $h$ 的标准正态变量。那么 $\\Phi(h) = P(z \\le h) = P(z - h \\le 0)$。因此，积分就变成了概率 $P(z-h \\le 0)$，其中概率是在 $z$ 和 $h$ 的联合分布上计算的。\n\n两个独立高斯变量的差也是一个高斯变量。令 $d = h - z$。\n$d$ 的均值为 $\\mathbb{E}[d] = \\mathbb{E}[h] - \\mathbb{E}[z] = \\mu_{h} - 0 = \\mu_{h}$。\n$d$ 的方差为 $\\mathrm{Var}[d] = \\mathrm{Var}[h] + \\mathrm{Var}[-z] = \\mathrm{Var}[h] + (-1)^2 \\mathrm{Var}[z] = \\sigma_{h}^{2} + 1$。\n因此，$d \\sim \\mathcal{N}(\\mu_{h}, 1 + \\sigma_{h}^{2})$。\n\n可行性概率为 $P(h \\ge z) = P(h-z \\ge 0) = P(d \\ge 0)$。对于一个高斯变量 $d$，这等于：\n$$\nP(d \\ge 0) = 1 - P(d  0) = 1 - \\Phi\\left(\\frac{0 - \\mu_{h}}{\\sqrt{1+\\sigma_{h}^{2}}}\\right) = 1 - \\Phi\\left(-\\frac{\\mu_{h}}{\\sqrt{1+\\sigma_{h}^{2}}}\\right)\n$$\n使用恒等式 $\\Phi(-x) = 1 - \\Phi(x)$，我们得到最终表达式：\n$$\n\\mathrm{PF}(x_{\\mathrm{c}}) = \\Phi\\left(\\frac{\\mu_{h}}{\\sqrt{1+\\sigma_{h}^{2}}}\\right)\n$$\n\n现在，我们代入给定的数值：$\\mu_{h} = 0.70$ 和 $\\sigma_{h}^{2} = 0.36$。\n$\\Phi$ 的参数是：\n$$\n\\frac{0.70}{\\sqrt{1+0.36}} = \\frac{0.70}{\\sqrt{1.36}} \\approx \\frac{0.70}{1.166190} \\approx 0.5999285\n$$\n所以，$\\mathrm{PF}(x_{\\mathrm{c}}) = \\Phi(0.5999285)$。使用标准正态CDF计算器，可得：\n$$\n\\mathrm{PF}(x_{\\mathrm{c}}) \\approx 0.725722\n$$\n\n**2. 期望提升 $\\mathrm{EI}(x_{\\mathrm{c}})$ 的推导与计算**\n\n提升函数 $I(f)$ 定义为超过当前观测到的最佳活性 $f^{\\star}$ 的提升量，由 $I(f) = \\max(0, f - f^{\\star})$ 给出。\n期望提升 $\\mathrm{EI}(x_{\\mathrm{c}})$ 是 $I(f)$ 在活性 $f(x_{\\mathrm{c}})$ 的GP后验预测分布下的期望，该分布为高斯分布：$f(x_{\\mathrm{c}}) \\sim \\mathcal{N}(f; \\mu_{f}, \\sigma_{f}^{2})$。\n\n$$\n\\mathrm{EI}(x_{\\mathrm{c}}) = \\mathbb{E}_{f \\sim \\mathcal{N}(\\mu_f, \\sigma_f^2)}[\\max(0, f - f^{\\star})] = \\int_{-\\infty}^{\\infty} \\max(0, f - f^{\\star}) \\, p(f) \\, df\n$$\n由于只有当 $f  f^{\\star}$ 时提升量才非零，积分变为：\n$$\n\\mathrm{EI}(x_{\\mathrm{c}}) = \\int_{f^{\\star}}^{\\infty} (f - f^{\\star}) \\, \\frac{1}{\\sigma_f\\sqrt{2\\pi}} \\exp\\left(-\\frac{(f-\\mu_f)^2}{2\\sigma_f^2}\\right) df\n$$\n让我们进行变量替换，$z = \\frac{f - \\mu_f}{\\sigma_f}$。那么 $f = \\mu_f + z\\sigma_f$ 且 $df = \\sigma_f dz$。积分下限变为 $\\frac{f^{\\star}-\\mu_f}{\\sigma_f}$。\n积分变换为：\n$$\n\\mathrm{EI}(x_{\\mathrm{c}}) = \\int_{\\frac{f^{\\star}-\\mu_f}{\\sigma_f}}^{\\infty} [(\\mu_f - f^{\\star}) + z\\sigma_f] \\, \\phi(z) \\, dz\n$$\n其中 $\\phi(z)$ 是标准正态概率密度函数（PDF）。将积分拆分：\n$$\n\\mathrm{EI}(x_{\\mathrm{c}}) = (\\mu_f - f^{\\star}) \\int_{\\frac{f^{\\star}-\\mu_f}{\\sigma_f}}^{\\infty} \\phi(z) \\, dz + \\sigma_f \\int_{\\frac{f^{\\star}-\\mu_f}{\\sigma_f}}^{\\infty} z \\, \\phi(z) \\, dz\n$$\n第一个积分是 $1 - \\Phi(\\frac{f^{\\star}-\\mu_f}{\\sigma_f}) = \\Phi(\\frac{\\mu_f-f^{\\star}}{\\sigma_f})$。\n第二个积分是 $\\int_{\\frac{f^{\\star}-\\mu_f}{\\sigma_f}}^{\\infty} z \\, \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^2}{2}\\right) dz$。它的计算结果为 $\\left[-\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^2}{2}\\right)\\right]_{\\frac{f^{\\star}-\\mu_f}{\\sigma_f}}^{\\infty} = 0 - \\left(-\\phi(\\frac{f^{\\star}-\\mu_f}{\\sigma_f})\\right) = \\phi(\\frac{f^{\\star}-\\mu_f}{\\sigma_f}) = \\phi(\\frac{\\mu_f-f^{\\star}}{\\sigma_f})$，因为 $\\phi(z)$ 是一个偶函数。\n合并各项，我们得到 EI 的标准公式：\n$$\n\\mathrm{EI}(x_{\\mathrm{c}}) = (\\mu_f - f^{\\star})\\Phi(\\gamma) + \\sigma_f\\phi(\\gamma)，\\text{其中} \\quad \\gamma = \\frac{\\mu_f - f^{\\star}}{\\sigma_f}\n$$\n现在，代入给定的数值：$\\mu_{f} = 1.05$，$\\sigma_{f} = 0.20$，以及 $f^{\\star} = 0.95$。\n$$\n\\gamma = \\frac{1.05 - 0.95}{0.20} = \\frac{0.10}{0.20} = 0.5\n$$\n我们需要计算 $\\Phi(0.5)$ 和 $\\phi(0.5)$。\n$$\n\\Phi(0.5) \\approx 0.691462\n$$\n$$\n\\phi(0.5) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{0.5^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.125) \\approx 0.352065\n$$\n将这些值代入 EI 公式：\n$$\n\\mathrm{EI}(x_{\\mathrm{c}}) = (1.05 - 0.95)\\Phi(0.5) + 0.20 \\cdot \\phi(0.5)\n$$\n$$\n\\mathrm{EI}(x_{\\mathrm{c}}) \\approx (0.10)(0.691462) + (0.20)(0.352065) \\approx 0.0691462 + 0.0704130 \\approx 0.139559\n$$\n\n**3. 约束采集值 $a_{\\mathrm{c}}(x_{\\mathrm{c}})$ 的计算**\n\n约束采集值是可行性概率和期望提升的乘积，其前提是假设活性和可行性的后验是独立的。\n$$\na_{\\mathrm{c}}(x_{\\mathrm{c}}) = \\mathrm{PF}(x_{\\mathrm{c}}) \\times \\mathrm{EI}(x_{\\mathrm{c}})\n$$\n使用计算出的值：\n$$\na_{\\mathrm{c}}(x_{\\mathrm{c}}) \\approx 0.725722 \\times 0.139559 \\approx 0.1012895\n$$\n问题要求将最终值四舍五入到四位有效数字。\n$$\na_{\\mathrm{c}}(x_{\\mathrm{c}}) \\approx 0.1013\n$$\n这个量是无量纲的，因为它是概率（$\\mathrm{PF}$）和与目标函数单位相同的量（$\\mathrm{EI}$）的乘积，而目标函数（归一化活性）本身就是无量纲的。",
            "answer": "$$\n\\boxed{0.1013}\n$$"
        }
    ]
}