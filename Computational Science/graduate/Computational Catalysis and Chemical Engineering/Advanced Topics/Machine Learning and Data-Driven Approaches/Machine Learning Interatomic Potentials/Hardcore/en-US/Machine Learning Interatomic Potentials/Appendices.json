{
    "hands_on_practices": [
        {
            "introduction": "A Machine Learning Interatomic Potential (MLIP) first translates the complex 3D geometry around an atom into a fixed-length numerical vector, or \"descriptor.\" This practice focuses on calculating one such descriptor, the Behler-Parrinello radial symmetry function, for a simple, idealized crystal structure. By working through this example , you will gain a concrete understanding of how these functions quantify the chemical environment in a way that is invariant to rotation, a critical first step in building robust MLIPs.",
            "id": "90953",
            "problem": "In the field of machine learning interatomic potentials, Behler-Parrinello symmetry functions are a cornerstone for creating robust and accurate models of atomic interactions. These functions describe the local chemical environment of an atom in a way that is invariant to rotation, translation, and permutation of like atoms.\n\nA common type of radial symmetry function, denoted as $G^i(\\eta, R_s)$, quantifies the radial distribution of neighboring atoms $j$ around a central atom $i$. It is defined as:\n$$\nG^i(\\eta, R_s) = \\sum_{j \\neq i} e^{-\\eta (R_{ij} - R_s)^2} f_c(R_{ij})\n$$\nHere, $R_{ij}$ is the distance between atoms $i$ and $j$. The parameter $\\eta$ controls the width of the Gaussian functions, and $R_s$ defines the radial distance at which the Gaussian is centered. The sum runs over all neighbors $j$ within a cutoff radius $R_c$. This cutoff is enforced by the cutoff function $f_c(R_{ij})$, which smoothly brings the contribution of each neighbor to zero as its distance approaches $R_c$. A frequently used form for $f_c(R_{ij})$ is the cosine cutoff function:\n$$\nf_c(R_{ij}) = \\begin{cases}\n\\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi R_{ij}}{R_c}\\right) + 1 \\right) & \\text{if } R_{ij} \\le R_c \\\\\n0 & \\text{if } R_{ij} > R_c\n\\end{cases}\n$$\n\nConsider a single atom of an element arranged in an ideal simple cubic (SC) crystal lattice with a lattice constant $a$. For the atom located at the origin of this lattice, derive an analytical expression for the value of the radial symmetry function $G^i(\\eta, R_s)$. Use a cutoff radius of $R_c = \\frac{7}{4}a$. Your final expression should be in terms of the lattice constant $a$ and the symmetry function parameters $\\eta$ and $R_s$.",
            "solution": "1. The radial symmetry function is defined by\n$$\nG^i(\\eta,R_s)=\\sum_{j\\neq i}e^{-\\eta\\bigl(R_{ij}-R_s\\bigr)^2}f_c(R_{ij})\\,,\n$$\nwith the cosine cutoff\n$$\nf_c(R)=\\begin{cases}\n\\frac12\\bigl(\\cos(\\pi R/R_c)+1\\bigr)&R\\le R_c,\\\\\n0&R>R_c.\n\\end{cases}\n$$\n\n2. In a simple cubic lattice of constant $a$, atom $i$ at the origin has neighbors at positions $(n_x,n_y,n_z)a$, for integers $n_x,n_y,n_z$ not all zero. Their distances are\n$$\nR_{n_x,n_y,n_z}=a\\sqrt{n_x^2+n_y^2+n_z^2}\\,.\n$$\n\n3. With cutoff $R_c=\\tfrac74a$, only shells with $n_x^2+n_y^2+n_z^2 \\le 3$ contribute:\n- $n^2=1$: 6 atoms at $R=a$,\n- $n^2=2$: 12 atoms at $R=a\\sqrt{2}$,\n- $n^2=3$: 8 atoms at $R=a\\sqrt{3}$.\n\n4. Thus,\n$$\nG^i=6\\,e^{-\\eta(a-R_s)^2}f_c(a)\n+12\\,e^{-\\eta(a\\sqrt{2}-R_s)^2}f_c(a\\sqrt{2})\n+8\\,e^{-\\eta(a\\sqrt{3}-R_s)^2}f_c(a\\sqrt{3}).\n$$\n\n5. Compute the cutoff factors, e.g.,\n$$\nf_c(a)=\\tfrac12\\bigl(\\cos(\\tfrac{\\pi a}{R_c})+1\\bigr)\n=\\tfrac12\\bigl(\\cos(\\tfrac{4\\pi}{7})+1\\bigr).\n$$\nSimilarly,\n$$\nf_c(a\\sqrt{2})=\\tfrac12\\bigl(\\cos(\\tfrac{4\\pi\\sqrt{2}}{7})+1\\bigr),\\quad\nf_c(a\\sqrt{3})=\\tfrac12\\bigl(\\cos(\\tfrac{4\\pi\\sqrt{3}}{7})+1\\bigr).\n$$\n\n6. Substituting and combining factors of $\\tfrac12$ gives\n$$\nG^i\n=3\\,e^{-\\eta(a-R_s)^2}\\bigl(\\cos(\\tfrac{4\\pi}{7})+1\\bigr)\n+6\\,e^{-\\eta(a\\sqrt{2}-R_s)^2}\\bigl(\\cos(\\tfrac{4\\pi\\sqrt{2}}{7})+1\\bigr)\n+4\\,e^{-\\eta(a\\sqrt{3}-R_s)^2}\\bigl(\\cos(\\tfrac{4\\pi\\sqrt{3}}{7})+1\\bigr).\n$$",
            "answer": "$$\\boxed{3\\,e^{-\\eta(a-R_s)^2}\\bigl(\\cos\\!\\tfrac{4\\pi}{7}+1\\bigr)\n+6\\,e^{-\\eta(a\\sqrt2-R_s)^2}\\bigl(\\cos\\!\\tfrac{4\\pi\\sqrt2}{7}+1\\bigr)\n+4\\,e^{-\\eta(a\\sqrt3-R_s)^2}\\bigl(\\cos\\!\\tfrac{4\\pi\\sqrt3}{7}+1\\bigr)}$$"
        },
        {
            "introduction": "A cornerstone of physics is that identical particles are indistinguishable, and any valid physical model must respect this symmetry. For MLIPs, this translates to the requirement of permutation invariance: swapping the labels of two identical atoms must not change the system's predicted energy. This exercise  powerfully illustrates this concept by asking you to quantify the unphysical errors that arise from a model that deliberately violates this rule, highlighting why symmetry-aware architectures are non-negotiable.",
            "id": "3886545",
            "problem": "You are asked to formalize and quantify the consequences of violating permutation invariance among identical atoms in Machine Learning (ML) interatomic potentials within computational catalysis and chemical engineering. The goal is to construct a scenario in which index-dependent features cause artificial energy splitting and to quantify the resulting prediction errors against a physically grounded reference. Start from a physically motivated, permutation-invariant reference energy and use it to analyze a deliberately permutation-variant surrogate model. Your program must produce a single line containing the aggregated numerical results for a test suite of configurations in dimensionless reduced units, rounded to eight decimal places.\n\nFundamental base:\n- Identical atoms are indistinguishable in classical mechanics and quantum mechanics; the total energy must be invariant under any permutation of atom labels. Formally, if there are $N$ identical atoms and a configuration is described by the set of pairwise distances $\\{r_{ij}\\}$, any permutation $\\pi$ in the symmetric group $S_N$ of indices must satisfy $E(\\{r_{ij}\\}) = E(\\{r_{\\pi(i)\\pi(j)}\\})$.\n- A standard, well-tested pairwise energy function for nonbonded interactions is the Lennard-Jones (LJ) potential. In reduced units where the characteristic energy and length scales are set to unity, the total energy for a configuration is computed as\n$$\nE_{\\text{LJ}}(\\mathbf{R}) = \\sum_{1 \\leq i < j \\leq N} 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma}{r_{ij}}\\right)^6\\right],\n$$\nwith $r_{ij} = \\|\\mathbf{r}_i - \\mathbf{r}_j\\|$, $\\varepsilon$ and $\\sigma$ the energy and length scales, and where the sum over unordered pairs ensures permutation invariance. Use reduced units with $\\varepsilon = 1$ and $\\sigma = 1$, so that energies and distances are dimensionless.\n\nIndex-dependent surrogate model:\n- Define per-atom descriptors that depend on local distances,\n$$\nd_i = \\sum_{\\substack{j=1 \\\\ j \\neq i}}^{N} \\exp\\left(-\\frac{r_{ij}}{\\sigma}\\right), \\quad e_i = \\sum_{\\substack{j=1 \\\\ j \\neq i}}^{N} \\frac{r_{ij}}{\\sigma}.\n$$\n- Construct a deliberately permutation-variant surrogate energy by using index-dependent weights,\n$$\nE_{\\text{bad}}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) = \\sum_{i=1}^{N} \\left[a_i \\, d_i + b_i \\, e_i\\right],\n$$\nwhere $\\mathbf{a} = (a_1, \\dots, a_N)$ and $\\mathbf{b} = (b_1, \\dots, b_N)$ depend on the atom index. Under a permutation $\\pi \\in S_N$ of labels, the predicted energy becomes\n$$\nE_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) = \\sum_{i=1}^{N} \\left[a_{\\pi(i)} \\, d_i + b_{\\pi(i)} \\, e_i\\right],\n$$\nwhich can differ for identical atoms if the $d_i$ and $e_i$ are not all equal.\n- For comparison, construct a permutation-invariant surrogate with shared weights,\n$$\nE_{\\text{good}}(\\mathbf{R}; a, b) = \\sum_{i=1}^{N} \\left[a \\, d_i + b \\, e_i\\right].\n$$\n\nQuantities to compute per test case:\n- Artificial energy splitting magnitude across a set of label permutations $\\mathcal{P}$,\n$$\n\\Delta_{\\text{split}} = \\max_{\\pi \\in \\mathcal{P}} E_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) - \\min_{\\pi \\in \\mathcal{P}} E_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}).\n$$\n- Maximum absolute prediction error of the index-dependent model across $\\mathcal{P}$, relative to the LJ energy,\n$$\n\\text{Err}_{\\text{bad,max}} = \\max_{\\pi \\in \\mathcal{P}} \\left|E_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) - E_{\\text{LJ}}(\\mathbf{R})\\right|.\n$$\n- Absolute prediction error of the permutation-invariant surrogate (shared weights),\n$$\n\\text{Err}_{\\text{good}} = \\left|E_{\\text{good}}(\\mathbf{R}; a, b) - E_{\\text{LJ}}(\\mathbf{R})\\right|.\n$$\n\nAngle units are irrelevant because only distances are used. All energies and distances must be expressed in dimensionless reduced units with $\\varepsilon = 1$ and $\\sigma = 1$. Round all outputs to eight decimal places.\n\nTest suite:\n- Use the following four configuration cases. Coordinates are given as Cartesian positions in $3$-dimensional space, in reduced units. Use $\\varepsilon = 1$ and $\\sigma = 1$. For each case, apply the set of permutations $\\mathcal{P}$ consisting of the identity and the reverse-index permutation. Shared weights are $a = 0.9$, $b = -0.15$.\n\nCase $1$ (non-symmetric linear triatomic, happy path):\n- $N = 3$,\n- positions: $\\left(0.0, 0.0, 0.0\\right)$, $\\left(1.2, 0.0, 0.0\\right)$, $\\left(2.5, 0.0, 0.0\\right)$,\n- index-dependent weights: $\\mathbf{a} = (0.8, 1.4, 0.5)$, $\\mathbf{b} = (-0.3, 0.2, 0.1)$.\n\nCase $2$ (equilateral triangle, symmetry boundary condition):\n- $N = 3$,\n- side length: $L = 1.6$,\n- positions: $\\left(0.0, 0.0, 0.0\\right)$, $\\left(L, 0.0, 0.0\\right)$, $\\left(\\frac{L}{2}, \\frac{\\sqrt{3}}{2} L, 0.0\\right)$,\n- index-dependent weights: $\\mathbf{a} = (0.8, 1.4, 0.5)$, $\\mathbf{b} = (-0.3, 0.2, 0.1)$.\n\nCase $3$ (diatomic pair, edge case):\n- $N = 2$,\n- positions: $\\left(0.0, 0.0, 0.0\\right)$, $\\left(1.1, 0.0, 0.0\\right)$,\n- index-dependent weights: $\\mathbf{a} = (1.2, 0.7)$, $\\mathbf{b} = (-0.25, 0.05)$.\n\nCase $4$ (four atoms in a non-symmetric rectangular layout):\n- $N = 4$,\n- positions: $\\left(0.0, 0.0, 0.0\\right)$, $\\left(1.4, 0.0, 0.0\\right)$, $\\left(0.0, 2.2, 0.0\\right)$, $\\left(2.1, 2.3, 0.0\\right)$,\n- index-dependent weights: $\\mathbf{a} = (0.7, 1.1, 0.6, 1.5)$, $\\mathbf{b} = (-0.2, 0.25, -0.05, 0.3)$.\n\nRequired final output format:\n- For each case, compute the triple $\\left[\\Delta_{\\text{split}}, \\text{Err}_{\\text{bad,max}}, \\text{Err}_{\\text{good}}\\right]$ as floats. Your program should produce a single line of output containing the list of these per-case triples, rounded to eight decimal places, as a comma-separated list of Python-style lists enclosed in square brackets, for example, $\\left[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots\\right]$.",
            "solution": "The core of the problem is to quantify the errors introduced by a machine learning model that fails to respect the physical indistinguishability of identical atoms. This principle, permutation invariance, dictates that the total energy of a system of $N$ identical atoms must remain unchanged regardless of how we label them. Mathematically, for any permutation $\\pi$ of the atom indices $\\{1, \\dots, N\\}$, the energy function $E$ must satisfy $E(\\{\\mathbf{r}_i\\}) = E(\\{\\mathbf{r}_{\\pi(i)}\\})$.\n\nThe solution is structured as follows:\n1.  A reference, physically correct energy is calculated using the Lennard-Jones (LJ) potential. This serves as the \"ground truth.\" In the specified reduced units where the characteristic energy $\\varepsilon=1$ and length $\\sigma=1$, the LJ potential is:\n    $$E_{\\text{LJ}}(\\mathbf{R}) = \\sum_{1 \\leq i < j \\leq N} 4 \\left(r_{ij}^{-12} - r_{ij}^{-6}\\right)$$\n    where $r_{ij} = \\|\\mathbf{r}_i - \\mathbf{r}_j\\|$ is the distance between atoms $i$ and $j$. This formulation, summing over unique pairs, is inherently permutation-invariant.\n\n2.  Two surrogate models are constructed based on local atomic environment descriptors. For each atom $i$, we define descriptors $d_i$ and $e_i$ that summarize its neighborhood:\n    $$d_i = \\sum_{j \\neq i} \\exp(-r_{ij})$$\n    $$e_i = \\sum_{j \\neq i} r_{ij}$$\n    These descriptors are themselves permutation-invariant in the sense that they are a property of the local geometry around a point in space, regardless of the label assigned to the atom at that point.\n\n3.  The first surrogate model, $E_{\\text{good}}$, is constructed to be permutation-invariant by assigning the same weights, $a$ and $b$, to the descriptors of every atom:\n    $$E_{\\text{good}}(\\mathbf{R}; a, b) = \\sum_{i=1}^{N} \\left(a \\, d_i + b \\, e_i\\right)$$\n    Under a permutation of atom labels, the set of descriptor values $\\{d_i, e_i\\}$ is merely reordered, but their sum over all atoms remains constant, ensuring $E_{\\text{good}}$ is invariant.\n\n4.  The second surrogate model, $E_{\\text{bad}}$, is deliberately constructed to violate permutation invariance by assigning index-dependent weights, $a_i$ and $b_i$:\n    $$E_{\\text{bad}}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) = \\sum_{i=1}^{N} \\left(a_i \\, d_i + b_i \\, e_i\\right)$$\n    If we permute the atom labels according to a permutation $\\pi$, atom $i$ (with its fixed descriptors $d_i, e_i$) is now assigned the label $\\pi(i)$ and thus receives weights $a_{\\pi(i)}$ and $b_{\\pi(i)}$. The energy under this new labeling, as defined in the problem, is:\n    $$E_{\\text{bad}}^{(\\pi)}(\\mathbf{R}; \\mathbf{a}, \\mathbf{b}) = \\sum_{i=1}^{N} \\left(a_{\\pi(i)} \\, d_i + b_{\\pi(i)} \\, e_i\\right)$$\n    If the atomic environments (and thus descriptors $d_i, e_i$) are not all identical, this energy will in general depend on the permutation $\\pi$, which is unphysical.\n\nThe algorithmic procedure for each test case is as follows:\nFirst, the $N \\times N$ matrix of pairwise distances $r_{ij}$ is computed from the given atomic coordinates. Using these distances, the reference energy $E_{\\text{LJ}}$ is calculated. Then, the descriptor vectors $\\mathbf{d}=(d_1, \\dots, d_N)$ and $\\mathbf{e}=(e_1, \\dots, e_N)$ are computed.\n\nTo quantify the violation, we consider two permutations: the identity ($\\pi_{id}(i) = i$) and the reverse-index permutation ($\\pi_{rev}(i) = N-1-i$ for $0$-based indices). The two corresponding energies, $E_{\\text{bad}}^{(\\pi_{id})}$ and $E_{\\text{bad}}^{(\\pi_{rev})}$, are calculated.\n\nFrom these values, we compute the required metrics:\n-   The artificial energy splitting, $\\Delta_{\\text{split}} = |E_{\\text{bad}}^{(\\pi_{id})} - E_{\\text{bad}}^{(\\pi_{rev})}|$. This directly measures the magnitude of the invariance violation. In symmetric configurations (e.g., a diatomic molecule or an equilateral trimer), the descriptors $\\{d_i, e_i\\}$ are identical for all atoms, causing $\\Delta_{\\text{split}}$ to be zero, as expected.\n-   The maximum absolute prediction error of the bad model, $\\text{Err}_{\\text{bad,max}} = \\max(|E_{\\text{bad}}^{(\\pi_{id})} - E_{\\text{LJ}}|, |E_{\\text{bad}}^{(\\pi_{rev})} - E_{\\text{LJ}}|)$. This reflects the worst-case error of the flawed model for the given labelings.\n-   The absolute prediction error of the good model, $\\text{Err}_{\\text{good}} = |E_{\\text{good}}(\\mathbf{R}; a, b) - E_{\\text{LJ}}|$. This isolates the model's intrinsic representational error from the error caused by broken symmetry.\n\nBy computing the triplet $[\\Delta_{\\text{split}}, \\text{Err}_{\\text{bad,max}}, \\text{Err}_{\\text{good}}]$ for each case, we systematically analyze and quantify the consequences of violating a core physical principle in a computational model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes metrics for permutation variance in ML interatomic potentials.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {   # Case 1\n            \"N\": 3,\n            \"positions\": np.array([\n                [0.0, 0.0, 0.0], \n                [1.2, 0.0, 0.0], \n                [2.5, 0.0, 0.0]\n            ]),\n            \"a_bad\": np.array([0.8, 1.4, 0.5]),\n            \"b_bad\": np.array([-0.3, 0.2, 0.1]),\n        },\n        {   # Case 2\n            \"N\": 3,\n            \"positions\": np.array([\n                [0.0, 0.0, 0.0], \n                [1.6, 0.0, 0.0], \n                [1.6/2, np.sqrt(3)/2 * 1.6, 0.0]\n            ]),\n            \"a_bad\": np.array([0.8, 1.4, 0.5]),\n            \"b_bad\": np.array([-0.3, 0.2, 0.1]),\n        },\n        {   # Case 3\n            \"N\": 2,\n            \"positions\": np.array([\n                [0.0, 0.0, 0.0], \n                [1.1, 0.0, 0.0]\n            ]),\n            \"a_bad\": np.array([1.2, 0.7]),\n            \"b_bad\": np.array([-0.25, 0.05]),\n        },\n        {   # Case 4\n            \"N\": 4,\n            \"positions\": np.array([\n                [0.0, 0.0, 0.0], \n                [1.4, 0.0, 0.0], \n                [0.0, 2.2, 0.0], \n                [2.1, 2.3, 0.0]\n            ]),\n            \"a_bad\": np.array([0.7, 1.1, 0.6, 1.5]),\n            \"b_bad\": np.array([-0.2, 0.25, -0.05, 0.3]),\n        },\n    ]\n\n    # Shared parameters\n    a_good = 0.9\n    b_good = -0.15\n    epsilon = 1.0\n    sigma = 1.0\n    \n    final_results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        positions = case[\"positions\"]\n        a_bad = case[\"a_bad\"]\n        b_bad = case[\"b_bad\"]\n\n        # 1. Calculate the-distance matrix\n        dist_matrix = np.zeros((N, N))\n        if N > 1:\n            for i in range(N):\n                for j in range(i + 1, N):\n                    dist = np.linalg.norm(positions[i] - positions[j])\n                    dist_matrix[i, j] = dist\n                    dist_matrix[j, i] = dist\n\n        # 2. Calculate Lennard-Jones reference energy (E_LJ)\n        e_lj = 0.0\n        if N > 1:\n            # np.triu_indices gives upper triangle indices to sum over pairs once\n            i_upper, j_upper = np.triu_indices(N, k=1)\n            r_ij = dist_matrix[i_upper, j_upper]\n            \n            # Filter out zero distances to prevent division by zero\n            r_ij_nonzero = r_ij[r_ij > 0]\n            if r_ij_nonzero.size > 0:\n                inv_r6 = (sigma / r_ij_nonzero)**6\n                inv_r12 = inv_r6**2\n                e_lj = np.sum(4 * epsilon * (inv_r12 - inv_r6))\n\n        # 3. Calculate per-atom descriptors\n        d = np.zeros(N)\n        e = np.zeros(N)\n        if N > 1:\n            for i in range(N):\n                # Distances from atom i to all other atoms j\n                r_i_others = dist_matrix[i, np.arange(N) != i]\n                d[i] = np.sum(np.exp(-r_i_others / sigma))\n                e[i] = np.sum(r_i_others / sigma)\n\n        # 4. Calculate E_bad for identity and reverse permutations\n        # Identity permutation\n        e_bad_id = np.sum(a_bad * d + b_bad * e)\n\n        # Reverse-index permutation\n        pi_rev_indices = np.arange(N - 1, -1, -1)\n        a_bad_rev = a_bad[pi_rev_indices]\n        b_bad_rev = b_bad[pi_rev_indices]\n        e_bad_rev = np.sum(a_bad_rev * d + b_bad_rev * e)\n        \n        e_bad_energies = np.array([e_bad_id, e_bad_rev])\n\n        # 5. Calculate artificial energy splitting (Delta_split)\n        delta_split = np.max(e_bad_energies) - np.min(e_bad_energies)\n\n        # 6. Calculate maximum absolute prediction error for E_bad\n        err_bad_max = np.max(np.abs(e_bad_energies - e_lj))\n\n        # 7. Calculate error for the permutation-invariant model (E_good)\n        e_good = a_good * np.sum(d) + b_good * np.sum(e)\n        err_good = np.abs(e_good - e_lj)\n\n        final_results.append([delta_split, err_bad_max, err_good])\n\n    # Format the final output string as specified\n    result_strings = []\n    for res in final_results:\n        # Create string for each sublist, e.g., \"[val1,val2,val3]\"\n        sublist_str = f\"[{res[0]:.8f},{res[1]:.8f},{res[2]:.8f}]\"\n        result_strings.append(sublist_str)\n    \n    # Join sublist strings and wrap in the final brackets\n    final_output_str = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The primary application of MLIPs is to perform large-scale molecular dynamics simulations, which requires knowing the forces acting on every atom. These forces are the negative gradient of the potential energy, $\\mathbf{F}_k = -\\nabla_{\\mathbf{R}_k} E_{\\mathrm{tot}}$. This exercise  provides direct, hands-on practice in deriving atomic forces from a given potential energy function for a simple multi-atom system, bridging the crucial gap between the static energy prediction of a model and the dynamical information needed to simulate how materials evolve over time.",
            "id": "3822117",
            "problem": "Consider a one-dimensional three-atom configuration used to illustrate a simple Machine Learning Interatomic Potential (MLIP). The per-atom energy is defined by\n$$\\varepsilon(\\mathcal{N}_i)=\\sum_{j\\in \\mathcal{N}_i} a \\exp(-b r_{ij}),$$\nwhere $r_{ij}$ is the Euclidean distance between atoms $i$ and $j$, $a$ and $b$ are positive constants, and $\\mathcal{N}_i$ is the neighbor set of atom $i$ containing all other atoms. The total energy of the system is the sum of per-atom energies over all atoms. The classical force on atom $k$ is defined as $\\mathbf{F}_k=-\\nabla_{\\mathbf{R}_k} E_{\\mathrm{tot}}$, where $\\mathbf{R}_k$ is the position of atom $k$ and $E_{\\mathrm{tot}}$ is the total energy.\n\nTake three atoms placed collinearly along the $x$-axis with positions $x_1=0\\,\\text{\\AA}$, $x_2=2.0\\,\\text{\\AA}$, and $x_3=3.5\\,\\text{\\AA}$. Use parameters $a=0.25\\,\\mathrm{eV}$ and $b=1.0\\,\\text{\\AA}^{-1}$. Assume $\\mathcal{N}_i=\\{j\\neq i\\}$ (that is, all other atoms are neighbors), and neglect any boundary conditions.\n\nCompute the total energy $E_{\\mathrm{tot}}$ and the forces on each atom along the $x$-direction, $F_{1x}$, $F_{2x}$, and $F_{3x}$. Express the final energy in electronvolts (eV) and the forces in electronvolts per ångström ($\\mathrm{eV}/\\text{\\AA}$). Round your final numerical values to four significant figures.",
            "solution": "The total energy of the three-atom system is the sum of the per-atom energies for atoms $1$, $2$, and $3$.\n$$E_{\\mathrm{tot}} = \\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3$$\nThe per-atom energy for atom $i$ is $\\varepsilon_i = \\sum_{j \\neq i} a \\exp(-b r_{ij})$.\n- For atom $1$, $\\varepsilon_1 = a \\exp(-b r_{12}) + a \\exp(-b r_{13})$.\n- For atom $2$, $\\varepsilon_2 = a \\exp(-b r_{21}) + a \\exp(-b r_{23})$.\n- For atom $3$, $\\varepsilon_3 = a \\exp(-b r_{31}) + a \\exp(-b r_{32})$.\n\nSince the distance $r_{ij} = r_{ji}$, the total energy is:\n$$E_{\\mathrm{tot}} = (a \\exp(-b r_{12}) + a \\exp(-b r_{13})) + (a \\exp(-b r_{12}) + a \\exp(-b r_{23})) + (a \\exp(-b r_{13}) + a \\exp(-b r_{23}))$$\n$$E_{\\mathrm{tot}} = 2a (\\exp(-b r_{12}) + \\exp(-b r_{13}) + \\exp(-b r_{23}))$$\nThis form correctly accounts for the contribution of each pair of atoms to the energy of both atoms in the pair.\n\nFirst, we calculate the pairwise distances $r_{ij} = |x_i - x_j|$ from the given positions $x_1=0\\,\\text{\\AA}$, $x_2=2.0\\,\\text{\\AA}$, and $x_3=3.5\\,\\text{\\AA}$.\n$$r_{12} = |x_1 - x_2| = |0 - 2.0| = 2.0\\,\\text{\\AA}$$\n$$r_{13} = |x_1 - x_3| = |0 - 3.5| = 3.5\\,\\text{\\AA}$$\n$$r_{23} = |x_2 - x_3| = |2.0 - 3.5| = 1.5\\,\\text{\\AA}$$\n\nNow, we can compute the total energy $E_{\\mathrm{tot}}$ using the given parameters $a=0.25\\,\\mathrm{eV}$ and $b=1.0\\,\\text{\\AA}^{-1}$.\n$$E_{\\mathrm{tot}} = 2(0.25\\,\\mathrm{eV}) (\\exp(-1.0 \\times 2.0) + \\exp(-1.0 \\times 3.5) + \\exp(-1.0 \\times 1.5))$$\n$$E_{\\mathrm{tot}} = 0.5 (\\exp(-2.0) + \\exp(-3.5) + \\exp(-1.5))\\,\\mathrm{eV}$$\nUsing a calculator for the exponential terms:\n$$E_{\\mathrm{tot}} \\approx 0.5 (0.135335 + 0.030197 + 0.223130)\\,\\mathrm{eV}$$\n$$E_{\\mathrm{tot}} \\approx 0.5 (0.388662)\\,\\mathrm{eV} \\approx 0.194331\\,\\mathrm{eV}$$\nRounding to four significant figures, $E_{\\mathrm{tot}} \\approx 0.1943\\,\\mathrm{eV}$.\n\nNext, we calculate the forces. Since the system is one-dimensional, the force on atom $k$ is $F_{kx} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_k}$. The total energy expressed in terms of coordinates is:\n$$E_{\\mathrm{tot}} = 2a (\\exp(-b|x_1-x_2|) + \\exp(-b|x_1-x_3|) + \\exp(-b|x_2-x_3|))$$\nWe use the chain rule and the fact that $\\frac{d|u|}{du} = \\mathrm{sgn}(u)$ for $u \\neq 0$:\n$\\frac{\\partial}{\\partial x_k} \\exp(-b|x_i-x_j|) = -b \\exp(-b|x_i-x_j|) \\frac{\\partial|x_i-x_j|}{\\partial x_k}$.\nThe derivative of the absolute value term is:\n$\\frac{\\partial|x_i-x_j|}{\\partial x_k} = \\begin{cases} \\mathrm{sgn}(x_i-x_j) & \\text{if } k=i \\\\ -\\mathrm{sgn}(x_i-x_j) & \\text{if } k=j \\\\ 0 & \\text{if } k \\neq i,j \\end{cases}$\n\nForce on atom $1$, $F_{1x}$:\n$$F_{1x} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_1} = -2a \\left[ \\frac{\\partial}{\\partial x_1}\\exp(-b|x_1-x_2|) + \\frac{\\partial}{\\partial x_1}\\exp(-b|x_1-x_3|) \\right]$$\n$$F_{1x} = -2a \\left[ -b \\exp(-b r_{12}) \\mathrm{sgn}(x_1-x_2) -b \\exp(-b r_{13}) \\mathrm{sgn}(x_1-x_3) \\right]$$\n$$F_{1x} = 2ab \\left[ \\mathrm{sgn}(x_1-x_2) \\exp(-b r_{12}) + \\mathrm{sgn}(x_1-x_3) \\exp(-b r_{13}) \\right]$$\nGiven $x_1<x_2$ and $x_1<x_3$, we have $\\mathrm{sgn}(x_1-x_2)=-1$ and $\\mathrm{sgn}(x_1-x_3)=-1$.\n$$F_{1x} = 2ab \\left[ -\\exp(-b r_{12}) - \\exp(-b r_{13}) \\right]$$\nSubstituting values $2ab = 2(0.25)(1.0) = 0.5\\,\\mathrm{eV}/\\text{\\AA}$:\n$$F_{1x} = -0.5 (\\exp(-2.0) + \\exp(-3.5)) \\approx -0.5(0.135335 + 0.030197) \\approx -0.5(0.165532) \\approx -0.082766\\,\\mathrm{eV}/\\text{\\AA}$$\nRounding to four significant figures, $F_{1x} \\approx -0.08277\\,\\mathrm{eV}/\\text{\\AA}$.\n\nForce on atom $2$, $F_{2x}$:\n$$F_{2x} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_2} = -2a \\left[ \\frac{\\partial}{\\partial x_2}\\exp(-b|x_1-x_2|) + \\frac{\\partial}{\\partial x_2}\\exp(-b|x_2-x_3|) \\right]$$\n$$F_{2x} = -2a \\left[ -b \\exp(-b r_{12})(-\\mathrm{sgn}(x_1-x_2)) -b \\exp(-b r_{23})\\mathrm{sgn}(x_2-x_3) \\right]$$\nSince $\\mathrm{sgn}(x_1-x_2) = -1$, $-\\mathrm{sgn}(x_1-x_2) = 1$. Since $x_2<x_3$, $\\mathrm{sgn}(x_2-x_3)=-1$.\n$$F_{2x} = 2ab \\left[ \\exp(-b r_{12}) - \\exp(-b r_{23}) \\right]$$\n$$F_{2x} = 0.5 (\\exp(-2.0) - \\exp(-1.5)) \\approx 0.5(0.135335 - 0.223130) \\approx 0.5(-0.087795) \\approx -0.0438975\\,\\mathrm{eV}/\\text{\\AA}$$\nRounding to four significant figures, $F_{2x} \\approx -0.04390\\,\\mathrm{eV}/\\text{\\AA}$.\n\nForce on atom $3$, $F_{3x}$:\n$$F_{3x} = -\\frac{\\partial E_{\\mathrm{tot}}}{\\partial x_3} = -2a \\left[ \\frac{\\partial}{\\partial x_3}\\exp(-b|x_1-x_3|) + \\frac{\\partial}{\\partial x_3}\\exp(-b|x_2-x_3|) \\right]$$\n$$F_{3x} = -2a \\left[ -b \\exp(-b r_{13})(-\\mathrm{sgn}(x_1-x_3)) -b \\exp(-b r_{23})(-\\mathrm{sgn}(x_2-x_3)) \\right]$$\nSince $\\mathrm{sgn}(x_1-x_3) = -1$ and $\\mathrm{sgn}(x_2-x_3) = -1$:\n$$F_{3x} = 2ab \\left[ \\exp(-b r_{13}) + \\exp(-b r_{23}) \\right]$$\n$$F_{3x} = 0.5 (\\exp(-3.5) + \\exp(-1.5)) \\approx 0.5(0.030197 + 0.223130) \\approx 0.5(0.253327) \\approx 0.1266635\\,\\mathrm{eV}/\\text{\\AA}$$\nRounding to four significant figures, $F_{3x} \\approx 0.1267\\,\\mathrm{eV}/\\text{\\AA}$.\n\nAs a check, the sum of internal forces on a closed system must be zero.\n$F_{1x} + F_{2x} + F_{3x} = 2ab [-\\exp(-b r_{12}) - \\exp(-b r_{13})] + 2ab [\\exp(-b r_{12}) - \\exp(-b r_{23})] + 2ab [\\exp(-b r_{13}) + \\exp(-b r_{23})]$\nThe terms cancel out pairwise, so the sum is zero, confirming the consistency of our calculations.\nNumerically (before rounding): $-0.082766 - 0.0438975 + 0.1266635 = 0$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1943 & -0.08277 & -0.04390 & 0.1267\n\\end{pmatrix}\n}\n$$"
        }
    ]
}