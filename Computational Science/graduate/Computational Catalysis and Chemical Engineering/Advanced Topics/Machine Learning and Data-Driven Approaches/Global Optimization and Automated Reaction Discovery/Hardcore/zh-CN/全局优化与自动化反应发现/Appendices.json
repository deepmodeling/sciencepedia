{
    "hands_on_practices": [
        {
            "introduction": "在自动化的反应发现中，搜索算法会探索高维的势能面（PES）以定位驻点。一个至关重要的后续步骤是对这些点进行分类，以确定它们是稳定的反应物/产物（极小值点）还是过渡态（鞍点）。本练习将通过分析Hessian矩阵，让你亲手实践这一分类过程，这是计算化学中的一项基本技能。",
            "id": "3881319",
            "problem": "在多相催化的自动化反应发现中，势能面由原子核坐标 $\\mathbf{q}$ 上的一个标量场 $U(\\mathbf{q})$ 表示。对于通过全局优化搜索找到的驻点 $\\mathbf{q}^{\\ast}$，通过分析由 Hessian 矩阵决定的泰勒展开的二阶项来进行局域表征。考虑一个在金属团簇表面上反应的吸附质，其中平动和转动已被移除，其运动用质量加权正交坐标表示。设在驻点处计算得到的 Hessian 矩阵，该矩阵由密度泛函理论 (DFT) 计算得出，并用于准牛顿信赖域步中，其形式如下：\n$$\nH \\;=\\;\n\\begin{pmatrix}\n-2.0  -3.0  0.0  0.0  0.0 \\\\\n-3.0  -2.0  0.0  0.0  0.0 \\\\\n0.0  0.0  4.0  1.0  0.0 \\\\\n0.0  0.0  1.0  3.0  0.0 \\\\\n0.0  0.0  0.0  0.0  2.0\n\\end{pmatrix},\n$$\n矩阵元的单位为电子伏特每平方埃，即 $\\mathrm{eV}\\,\\mathrm{\\AA}^{-2}$。使用基于 Hessian 矩阵特征值符号的驻点基本表征方法，确定莫尔斯指数（$H$ 的负特征值数量），并将该驻点分类为局域极小值点、一阶鞍点或高阶鞍点。\n\n对于最终报告的分类代码，请使用以下对应关系：\n- $0$ 表示局域极小值点，\n- $1$ 表示一阶鞍点，\n- $2$ 表示高阶鞍点（指数严格大于1）。\n\n以行矩阵的形式提供您的答案，其中包含两个数字，顺序为：莫尔斯指数和分类代码。最终答案不带单位。无需四舍五入。",
            "solution": "任务是通过分析其 Hessian 矩阵来表征势能面上的一个驻点。在计算化学和计算物理学中，势能面 $U(\\mathbf{q})$ 上驻点 $\\mathbf{q}^{\\ast}$ 的性质由 Hessian 矩阵 $H$ 的特征值符号确定。该矩阵包含能量对坐标的二阶偏导数，$H_{ij} = \\frac{\\partial^2 U}{\\partial q_i \\partial q_j}$，在 $\\mathbf{q}^{\\ast}$ 处求值。Hessian 矩阵的特征值对应于势能面沿简正模式方向的曲率。\n\n表征方法如下：\n- 如果所有特征值均为正，则该驻点为局域极小值点，对应于一个稳定结构。莫尔斯指数（负特征值的数量）为 $0$。\n- 如果恰好有一个负特征值，则该驻点为一阶鞍点，通常代表反应的过渡态。莫尔斯指数为 $1$。\n- 如果有一个以上的负特征值，则该驻点为高阶鞍点。莫尔斯指数大于 $1$。\n\n给定的 Hessian 矩阵为：\n$$\nH \\;=\\;\n\\begin{pmatrix}\n-2.0  -3.0  0.0  0.0  0.0 \\\\\n-3.0  -2.0  0.0  0.0  0.0 \\\\\n0.0  0.0  4.0  1.0  0.0 \\\\\n0.0  0.0  1.0  3.0  0.0 \\\\\n0.0  0.0  0.0  0.0  2.0\n\\end{pmatrix}\n$$\n为了确定莫尔斯指数，我们必须求出 $H$ 的特征值。我们观察到 $H$ 是一个块对角矩阵，这简化了特征值问题。该矩阵可以写成：\n$$\nH = \\begin{pmatrix} H_1  \\mathbf{0}  \\mathbf{0} \\\\ \\mathbf{0}  H_2  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{0}  H_3 \\end{pmatrix}\n$$\n其中各分块为：\n$$\nH_1 = \\begin{pmatrix} -2  -3 \\\\ -3  -2 \\end{pmatrix}, \\quad\nH_2 = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}, \\quad\nH_3 = \\begin{pmatrix} 2 \\end{pmatrix}\n$$\n块对角矩阵的特征值是其各组成块特征值的并集。\n\n首先，我们通过求解特征方程 $\\det(H_1 - \\lambda I) = 0$ 来求子矩阵 $H_1$ 的特征值：\n$$\n\\det \\begin{pmatrix} -2 - \\lambda  -3 \\\\ -3  -2 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-2 - \\lambda)^2 - (-3)^2 = 0\n$$\n$$\n(\\lambda + 2)^2 - 9 = 0\n$$\n$$\n\\lambda + 2 = \\pm \\sqrt{9} = \\pm 3\n$$\n这得到 $H_1$ 的两个特征值：\n$\\lambda_1 = 3 - 2 = 1$\n$\\lambda_2 = -3 - 2 = -5$\n\n接着，我们求子矩阵 $H_2$ 的特征值：\n$$\n\\det(H_2 - \\lambda I) = \\det \\begin{pmatrix} 4 - \\lambda  1 \\\\ 1  3 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(4 - \\lambda)(3 - \\lambda) - (1)(1) = 0\n$$\n$$\n\\lambda^2 - 7\\lambda + 12 - 1 = 0\n$$\n$$\n\\lambda^2 - 7\\lambda + 11 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda = \\frac{7 \\pm \\sqrt{(-7)^2 - 4(1)(11)}}{2 \\cdot 1} = \\frac{7 \\pm \\sqrt{49 - 44}}{2} = \\frac{7 \\pm \\sqrt{5}}{2}\n$$\n这得到 $H_2$ 的两个特征值：\n$\\lambda_3 = \\frac{7 + \\sqrt{5}}{2}$\n$\\lambda_4 = \\frac{7 - \\sqrt{5}}{2}$\n由于 $\\sqrt{5} \\approx 2.236$，我们有 $\\lambda_3 \\approx 4.618$ 和 $\\lambda_4 \\approx 2.382$。两个特征值均为正。\n\n最后，子矩阵 $H_3$ 是一个 $1 \\times 1$ 矩阵。其特征值就是该元素本身：\n$\\lambda_5 = 2$\n\nHessian 矩阵 $H$ 的完整特征值集合为 $\\left\\{ 1, -5, \\frac{7+\\sqrt{5}}{2}, \\frac{7-\\sqrt{5}}{2}, 2 \\right\\}$。\n\n莫尔斯指数是负特征值的数量。在这个集合中，只有一个特征值 $\\lambda_2 = -5$ 是负的。因此，莫尔斯指数为 $1$。\n\n根据问题的分类方案：\n- 莫尔斯指数为 $0$ 对应分类代码 $0$（局域极小值点）。\n- 莫尔斯指数为 $1$ 对应分类代码 $1$（一阶鞍点）。\n- 莫尔斯指数严格大于 $1$ 对应分类代码 $2$（高阶鞍点）。\n\n由于莫尔斯指数为 $1$，该驻点是一阶鞍点，其分类代码为 $1$。最终答案是包含莫尔斯指数和其后分类代码的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "前面的练习侧重于分析一个给定的驻点，而本实践则要解决一个更复杂的任务：实际去寻找一个驻点。你将从第一性原理出发，推导并实现一个基于牛顿法的本征向量跟随算法，这是一种定位过渡态的强大方法。这项实践揭示了许多自动化反应路径发现工具背后的核心计算引擎。",
            "id": "3881308",
            "problem": "你的任务是构建并实现一个基于牛顿法的、有数学原理支持的特征向量跟踪算法，从附近的初始猜测点出发，收敛到势能面上的一个过渡态。该问题设定在计算催化和化学工程领域，特别是在全局优化和自动化反应发现的范畴内。目标是到达一个一阶鞍点，该鞍点对应一个过渡态。这需要通过调整牛顿步长来实现，使得算法沿着反应坐标上升，同时沿着所有正交模式下降。你的推导和实现必须基于第一性原理，从势能面的二阶泰勒展开式开始，并审慎地使用梯度和Hessian矩阵。\n\n在此，过渡态被定义为一个驻点，其梯度为零，且其Hessian矩阵恰好有一个负特征值。该算法必须系统地处理Hessian矩阵的负特征值和近零曲率方向，确保数值稳定性，并采用信赖域策略来调节步长。\n\n推导的起点：\n- 使用一个二阶连续可微的标量势能面 $V(\\mathbf{x})$ 在点 $\\mathbf{x}$ 附近的二阶泰勒展开式：$V(\\mathbf{x} + \\mathbf{p}) \\approx V(\\mathbf{x}) + \\nabla V(\\mathbf{x})^{\\top} \\mathbf{p} + \\frac{1}{2} \\mathbf{p}^{\\top} \\nabla^{2} V(\\mathbf{x}) \\mathbf{p}$。\n- 使用牛顿方向的定义，即用梯度 $\\nabla V(\\mathbf{x})$ 和Hessian矩阵 $\\nabla^{2} V(\\mathbf{x})$ 表示。\n- 使用Hessian矩阵的谱分解来推理特定模式的曲率，以及如何系统地沿着反应坐标上升，同时沿着正交模式下降。\n\n你不能直接陈述或使用任何现成的过渡态算法公式。必须通过推导所需步骤从第一性原理解决此问题。\n\n你的实现目标是以下二维、二阶连续可微的势能面（无量纲单位）：\n$$\nV(x,y) = a(x^2 - b)^2 + c y^2 + d x y,\n$$\n参数为 $a = 1.0$，$b = 1.0$，$c = 0.5$ 和 $d = 0.3$。该势能面有两个极小值点和一个中心鞍点，该鞍点作为两个势阱之间的过渡态。所有量均为无量纲；请将任何数值输出表示为无单位的纯数字。\n\n对你的算法和程序的要求：\n- 推导并实现一个分步的、基于牛顿法的特征向量跟踪方案，该方案：\n  1. 计算当前迭代点 $\\mathbf{x} = (x,y)$ 处的 $V(x,y)$ 的梯度和Hessian矩阵。\n  2. 对Hessian矩阵进行特征分解以识别曲率模式。\n  3. 选择与最小特征值相关联的特征向量作为过渡态模式。如果所有特征值均为正，仍然选择与最小特征值相关联的模式作为临时的反应坐标。\n  4. 在模式坐标中构建一个修正的牛顿步，该步长沿着选定的过渡态模式上升，同时沿着其余模式下降。\n  5. 在存在负或近零特征值的情况下，使用基于你的推导的阻尼策略来稳定计算。\n  6. 对步长强制施加信赖域以避免发散，并引入基于梯度范数减小的接受准则，以决定是接受步长还是缩小信赖域。\n  7. 当梯度范数和步长低于指定容差时终止，然后如果Hessian矩阵恰好有一个负特征值，则将驻点分类为过渡态。\n- 你的程序必须是完全确定性的，并且不应需要任何用户输入。\n\n测试套件：\n使用上面给出的固定参数，对以下三个初始猜测点运行你的算法。每个案例必须由程序独立处理。\n1. 理想路径：$(x_0, y_0) = (0.2, 0.1)$。\n2. 靠近极小值点：$(x_0, y_0) = (1.1, -0.3)$。\n3. 靠近曲率平缓的类拐点区域：$(x_0, y_0) = \\left(\\sqrt{\\frac{b}{3}}, 0.0\\right)$，其数值约为 $(0.5773502691896258, 0.0)$。\n\n收敛和分类标准：\n- 当梯度范数 $\\lVert \\nabla V\\rVert$ 低于 $10^{-8}$ 且步长范数 $\\lVert \\mathbf{p} \\rVert$ 低于 $10^{-10}$ 时，或达到最大迭代次数 $200$ 次时收敛。\n- 终止后，当且仅当Hessian矩阵恰好有一个负特征值时，将最终点分类为过渡态。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个以方括号括起来的逗号分隔列表形式的结果。对于每个测试案例，返回一个包含四个元素的列表：最终的 $x$ 坐标、最终的 $y$ 坐标、最终的能量 $V(x,y)$ 以及一个布尔值，指示该点是否被分类为过渡态。因此，最终输出行必须如下所示：\n[[x1,y1,E1,TS1],[x2,y2,E2,TS2],[x3,y3,E3,TS3]]\n所有数字必须表示为纯小数，布尔值表示为 True 或 False。不应打印任何附加文本。",
            "solution": "目标是推导并实现一个基于牛顿法的特征向量跟踪算法，以在给定的势能面 $V(\\mathbf{x})$ 上定位一个一阶鞍点，该鞍点代表一个过渡态（TS）。过渡态是一个驻点，在该点上势能的梯度 $\\nabla V$ 为零，并且Hessian矩阵 $\\nabla^2 V$ 恰好拥有一个负特征值。\n\n该算法将从第一性原理出发进行开发，始于势能面 $V(\\mathbf{x})$ 在点 $\\mathbf{x}_k$ 附近的二阶泰勒展开：\n$$\nV(\\mathbf{x}_k + \\mathbf{p}) \\approx V(\\mathbf{x}_k) + \\mathbf{g}_k^\\top \\mathbf{p} + \\frac{1}{2}\\mathbf{p}_k^\\top \\mathbf{H}_k \\mathbf{p}\n$$\n其中 $\\mathbf{p}$ 是步长向量，$\\mathbf{g}_k = \\nabla V(\\mathbf{x}_k)$ 是梯度，$\\mathbf{H}_k = \\nabla^2 V(\\mathbf{x}_k)$ 是当前迭代点 $\\mathbf{x}_k$ 处的Hessian矩阵。\n\n首先，我们定义势能面及其导数。给定的势能面是：\n$$\nV(x,y) = a(x^2 - b)^2 + c y^2 + d x y\n$$\n参数为 $a = 1.0$，$b = 1.0$，$c = 0.5$ 和 $d = 0.3$。\n位置向量为 $\\mathbf{x} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$。\n\n梯度 $\\nabla V(\\mathbf{x})$ 是一阶偏导数向量：\n$$\n\\nabla V(\\mathbf{x}) = \\begin{pmatrix} \\frac{\\partial V}{\\partial x} \\\\ \\frac{\\partial V}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 2a(x^2 - b)(2x) + dy \\\\ 2cy + dx \\end{pmatrix} = \\begin{pmatrix} 4a(x^3 - bx) + dy \\\\ dx + 2cy \\end{pmatrix}\n$$\nHessian矩阵 $\\nabla^2 V(\\mathbf{x})$ 是二阶偏导数矩阵：\n$$\n\\mathbf{H}(\\mathbf{x}) = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2}  \\frac{\\partial^2 V}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 V}{\\partial y \\partial x}  \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix} = \\begin{pmatrix} 4a(3x^2 - b)  d \\\\ d  2c \\end{pmatrix}\n$$\n代入给定参数：\n$$\n\\nabla V(x,y) = \\begin{pmatrix} 4(x^3 - x) + 0.3y \\\\ 0.3x + y \\end{pmatrix}\n$$\n$$\n\\mathbf{H}(x,y) = \\begin{pmatrix} 4(3x^2 - 1)  0.3 \\\\ 0.3  1.0 \\end{pmatrix}\n$$\n\n用于寻找驻点的标准牛顿-拉夫逊步长是通过最小化 $V$ 的二次模型推导出来的，得到 $\\mathbf{p} = -\\mathbf{H}^{-1}\\mathbf{g}$。此步长旨在收敛到极小值点，其中 $\\mathbf{H}$ 是正定的。对于鞍点搜索，$\\mathbf{H}$ 是不定的（同时具有正负特征值），标准牛顿步长会沿着负曲率方向偏离鞍点。\n\n特征向量跟踪方法的核心是根据Hessian矩阵特征系统中编码的局部拓扑来修正步长。我们对对称的Hessian矩阵进行谱分解：\n$$\n\\mathbf{H} = \\mathbf{U} \\mathbf{\\Lambda} \\mathbf{U}^\\top\n$$\n其中 $\\mathbf{U}$ 是一个正交矩阵，其列是特征向量 $\\mathbf{u}_i$，$\\mathbf{\\Lambda}$ 是相应特征值 $\\lambda_i$ 组成的对角矩阵。我们可以将步长 $\\mathbf{p}$ 和梯度 $\\mathbf{g}$ 在特征向量基中表示：\n$$\n\\mathbf{p} = \\sum_{i=1}^n p'_i \\mathbf{u}_i \\quad \\text{and} \\quad \\mathbf{g} = \\sum_{i=1}^n g'_i \\mathbf{u}_i\n$$\n其中 $p'_i$ 和 $g'_i = \\mathbf{g}^\\top \\mathbf{u}_i$ 分别是步长和梯度沿着特征向量 $\\mathbf{u}_i$ 的分量。在此模式基中，二次能量模型变为：\n$$\nV(\\mathbf{x}_k + \\mathbf{p}) - V(\\mathbf{x}_k) \\approx \\sum_{i=1}^n \\left( g'_i p'_i + \\frac{1}{2} \\lambda_i (p'_i)^2 \\right)\n$$\n为了找到一阶鞍点，我们必须沿着具有负曲率的模式（反应坐标）上升，并沿着所有其他具有正曲率的模式下降。问题规定，要上升的模式对应于具有最小特征值的特征向量，我们将其表示为 $\\mathbf{u}_1$，其特征值为 $\\lambda_1$。\n\n对于下降模式（$i > 1$），我们寻求最小化能量贡献。最小化 $g'_i p'_i + \\frac{1}{2} \\lambda_i (p'_i)^2$ 的步长分量是标准牛顿步长分量：\n$$\np'_i = -\\frac{g'_i}{\\lambda_i} \\quad \\text{for } i=2, \\dots, n\n$$\n这要求 $\\lambda_i > 0$。如果我们不在满足此条件的区域（例如，在更高阶的鞍点或远离任何驻点），我们必须稳定步长。一个稳健的方法是使用阻尼步长，确保有效曲率为正：\n$$\np'_i = -\\frac{g'_i}{\\max(\\lambda_i, \\delta_d)} \\quad \\text{for } i=2, \\dots, n\n$$\n其中 $\\delta_d$ 是一个小的正常数阻尼常数。这确保了沿着这些模式的下降步长，即使它们的真实曲率为负或零。\n\n对于上升模式（$i=1$），我们寻求最大化能量贡献 $g'_1 p'_1 + \\frac{1}{2} \\lambda_1 (p'_1)^2$。一个沿着梯度分量 $g'_1$ 方向的步长将是上坡的。为了结合曲率信息并保持与牛顿步长相似的结构，我们可以构建一个“上坡”牛顿步长。步长应在 $g'_1$ 的方向上，其大小与曲率 $|\\lambda_1|$ 相关。我们将上升步长分量定义为：\n$$\np'_1 = +\\frac{g'_1}{\\max(|\\lambda_1|, \\delta_a)}\n$$\n其中 $\\delta_a$ 是另一个正的阻尼常数。正号确保了沿着该模式的梯度分量上升，而使用 $|\\lambda_1|$ 无论曲率当前是负（接近过渡态）还是正（接近极小值点），都能提供稳定的步长大小。\n\n结合这些分量，构建完整的原始步长向量：\n$$\n\\mathbf{p}_{\\text{raw}} = p'_1 \\mathbf{u}_1 + \\sum_{i=2}^n p'_i \\mathbf{u}_i = \\left(\\frac{g'_1}{\\max(|\\lambda_1|, \\delta_a)}\\right)\\mathbf{u}_1 - \\sum_{i=2}^n \\left(\\frac{g'_i}{\\max(\\lambda_i, \\delta_d)}\\right)\\mathbf{u}_i\n$$\n\n为防止在二次近似较差时发散，我们引入一个信赖域。步长 $\\mathbf{p}$ 被约束使其范数不大于信赖半径 $\\Delta$：$\\lVert\\mathbf{p}\\rVert \\le \\Delta$。如果原始步长 $\\mathbf{p}_{\\text{raw}}$ 超过此半径，则将其按比例缩小：\n$$\n\\mathbf{p}_k = \\begin{cases} \\mathbf{p}_{\\text{raw}}  \\text{if } \\lVert\\mathbf{p}_{\\text{raw}}\\rVert \\le \\Delta_k \\\\ \\mathbf{p}_{\\text{raw}} \\frac{\\Delta_k}{\\lVert\\mathbf{p}_{\\text{raw}}\\rVert}  \\text{if } \\lVert\\mathbf{p}_{\\text{raw}}\\rVert > \\Delta_k \\end{cases}\n$$\n新位置被提议为 $\\mathbf{x}_{\\text{trial}} = \\mathbf{x}_k + \\mathbf{p}_k$。根据问题规范，如果试验点的梯度范数小于当前点的梯度范数，即 $\\lVert \\nabla V(\\mathbf{x}_{\\text{trial}}) \\rVert  \\lVert \\nabla V(\\mathbf{x}_k) \\rVert$，则接受该步长。如果步长被接受，下一次迭代的信赖半径可以增加。如果被拒绝，则减小信赖半径，并从同一点 $\\mathbf{x}_k$ 以更小的步长约束重新评估步长。\n\n当梯度范数 $\\lVert \\mathbf{g} \\rVert$ 和上一步接受的步长范数 $\\lVert \\mathbf{p} \\rVert$ 低于预定义容差时，或达到最大迭代次数时，算法终止。\n\n最后，在收敛到驻点 $\\mathbf{x}^*$ 后，我们对其进行分类。我们计算Hessian矩阵 $\\mathbf{H}(\\mathbf{x}^*)$ 及其特征值。如果恰好有一个负特征值，则该点被分类为过渡态。\n\n完整的算法如下：\n1.  用 $\\mathbf{x}_0$ 和初始信赖半径 $\\Delta_0$ 进行初始化。\n2.  对于 $k=0, 1, 2, \\dots$ 直到最大迭代次数：\n    a.  在 $\\mathbf{x}_k$ 处计算梯度 $\\mathbf{g}_k$ 和Hessian矩阵 $\\mathbf{H}_k$。\n    b.  检查收敛性：如果 $\\lVert \\mathbf{g}_k \\rVert  \\epsilon_g$ 且 $\\lVert \\mathbf{p}_{k-1} \\rVert  \\epsilon_p$，则终止。\n    c.  对 $\\mathbf{H}_k$ 进行特征分解，得到按特征值排序的特征值 $\\{\\lambda_i\\}$ 和特征向量 $\\{\\mathbf{u}_i\\}$。\n    d.  使用推导的模式步长方程计算原始步长 $\\mathbf{p}_{\\text{raw}}$。\n    e.  将步长约束在信赖半径内：$\\mathbf{p}_k = \\text{scale}(\\mathbf{p}_{\\text{raw}}, \\Delta_k)$。\n    f.  提出试验点 $\\mathbf{x}_{\\text{trial}} = \\mathbf{x}_k + \\mathbf{p}_k$。\n    g.  评估梯度 $\\mathbf{g}_{\\text{trial}} = \\nabla V(\\mathbf{x}_{\\text{trial}})$。\n    h.  如果 $\\lVert \\mathbf{g}_{\\text{trial}} \\rVert  \\lVert \\mathbf{g}_k \\rVert$ (接受步长)：\n        i.  更新位置：$\\mathbf{x}_{k+1} = \\mathbf{x}_{\\text{trial}}$。\n        ii. 增加信赖半径：$\\Delta_{k+1} = \\min(\\Delta_{\\text{max}}, \\Delta_k \\cdot f_{\\text{grow}})$。\n    i.  否则 (拒绝步长)：\n        i.  不更新位置：$\\mathbf{x}_{k+1} = \\mathbf{x}_k$。\n        ii. 减小信赖半径：$\\Delta_{k+1} = \\Delta_k \\cdot f_{\\text{shrink}}$。\n3.  一旦终止，通过分析 $\\mathbf{H}(\\mathbf{x}_{\\text{final}})$ 的特征值来对最终点 $\\mathbf{x}_{\\text{final}}$ 进行分类。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the transition state search for all test cases.\n    \"\"\"\n    test_cases = [\n        (0.2, 0.1),\n        (1.1, -0.3),\n        (np.sqrt(1.0/3.0), 0.0),\n    ]\n\n    results = []\n    for x0, y0 in test_cases:\n        x_final, y_final, E_final, is_ts = find_transition_state(x0, y0)\n        results.append([x_final, y_final, E_final, is_ts])\n\n    # Format the final output string exactly as required\n    result_str = \"[\" + \",\".join([\n        f\"[{r[0]},{r[1]},{r[2]},{'True' if r[3] else 'False'}]\"\n        for r in results\n    ]) + \"]\"\n\n    print(result_str)\n\ndef find_transition_state(x0, y0):\n    \"\"\"\n    Implements the derived Newton-based eigenvector-following algorithm.\n    \"\"\"\n    # PES parameters\n    a = 1.0\n    b = 1.0\n    c = 0.5\n    d = 0.3\n\n    def V(pos):\n        x, y = pos\n        return a * (x**2 - b)**2 + c * y**2 + d * x * y\n\n    def grad_V(pos):\n        x, y = pos\n        gx = 4.0 * a * (x**3 - b * x) + d * y\n        gy = 2.0 * c * y + d * x\n        return np.array([gx, gy])\n\n    def hess_V(pos):\n        x, y = pos\n        h_xx = 4.0 * a * (3.0 * x**2 - b)\n        h_xy = d\n        h_yy = 2.0 * c\n        return np.array([[h_xx, h_xy], [h_xy, h_yy]])\n\n    # Algorithm hyperparameters\n    max_iter = 200\n    tol_g = 1e-8\n    tol_p = 1e-10\n    \n    trust_radius = 0.1\n    max_trust_radius = 0.3\n    grow_factor = 1.1\n    shrink_factor = 0.5\n    \n    damping_const = 0.05\n\n    x_current = np.array([x0, y0])\n    p_prev_norm = np.inf\n\n    for _ in range(max_iter):\n        g = grad_V(x_current)\n        g_norm = np.linalg.norm(g)\n        \n        if g_norm  tol_g and p_prev_norm  tol_p:\n            break\n\n        H = hess_V(x_current)\n        \n        # Eigen-decomposition. eigh returns eigenvalues in ascending order.\n        e_vals, e_vecs = np.linalg.eigh(H)\n        \n        # Project gradient onto eigenvector basis\n        g_prime = e_vecs.T @ g\n        \n        # Construct step in modal basis\n        p_prime = np.zeros_like(g_prime)\n        \n        # Ascent mode (mode 1, lowest eigenvalue)\n        p_prime[0] = g_prime[0] / max(abs(e_vals[0]), damping_const)\n        \n        # Descent modes (all others)\n        for i in range(1, len(e_vals)):\n            p_prime[i] = -g_prime[i] / max(e_vals[i], damping_const)\n        \n        # Reconstruct step in Cartesian coordinates\n        p_raw = e_vecs @ p_prime\n        \n        # Apply trust region constraint\n        p_raw_norm = np.linalg.norm(p_raw)\n        if p_raw_norm > trust_radius:\n            p = p_raw * (trust_radius / p_raw_norm)\n        else:\n            p = p_raw\n        \n        # Acceptance criterion\n        x_trial = x_current + p\n        g_trial = grad_V(x_trial)\n        \n        if np.linalg.norm(g_trial)  g_norm:  # Accept step\n            x_current = x_trial\n            p_prev_norm = np.linalg.norm(p)\n            trust_radius = min(max_trust_radius, trust_radius * grow_factor)\n        else:  # Reject step\n            p_prev_norm = 0.0 # Step was rejected, so its effective norm is 0\n            trust_radius *= shrink_factor\n\n            # If trust radius becomes too small, break to avoid infinite loop\n            if trust_radius  1e-12:\n                break\n    \n    x_final = x_current\n    \n    # Final analysis\n    V_final = V(x_final)\n    H_final = hess_V(x_final)\n    final_evals, _ = np.linalg.eigh(H_final)\n    \n    # Classify as transition state if exactly one eigenvalue is negative\n    num_negative_evals = np.sum(final_evals  -1e-6) # Use a small tolerance\n    is_ts = (num_negative_evals == 1)\n\n    return x_final[0], x_final[1], V_final, is_ts\n\n# Run the solver\nsolve()\n```"
        },
        {
            "introduction": "计算反应路径和过渡态的最终目标是预测和设计更好的催化剂。本练习通过指导你构建一个动力学“火山图”，在基础的势能面探索和实际应用之间架起了一座桥梁。你将推导催化剂的内在性质与其整体活性之间的关系，这是现代催化理论的核心概念。",
            "id": "3881327",
            "problem": "考虑一个单中心催化剂，它通过在一个空位 $*$ 上形成吸附中间体 $A^*$，将气相反应物 $A$ 转化为气相产物 $P$。基元步骤为 $A(\\mathrm{g}) + * \\rightleftharpoons A^*$ 和 $A^* \\rightarrow P(\\mathrm{g}) + *$。假设反应器为恒温、恒压、充分混合，无传质限制，产物吸附可忽略不计，且吸附物之间无横向相互作用。设该催化剂由一个标量描述符 $D$ 表征，定义为吸附吉布斯自由能的正值大小，因此吸附自由能变为 $-\\!D$。\n\n使用以下来自化学动力学和热力学的基本关系：\n- 阿伦尼乌斯/过渡态理论给出的基元速率常数表达式为 $k = \\nu \\exp(-E_{a}/(R T))$，其中 $E_{a}$ 是活化能垒，$R$ 是摩尔气体常数，$T$ 是温度，$\\nu$ 是指前因子。\n- Brønsted–Evans–Polanyi (BEP) 关系指出，表面反应 $A^* \\rightarrow P(\\mathrm{g}) + *$ 的活化能与其反应能呈线性关系：$E_{a}(D) = E_{0} + \\alpha E_{\\mathrm{rxn}}(D)$，其中 $0  \\alpha  1$ 且 $E_{0}  0$ 与 $D$ 无关。\n- 在吸附准平衡和朗缪尔吸附模型下，$A^*$ 的覆盖度为 $\\theta_{A}(D) = \\dfrac{K(D) p_{A}}{1 + K(D) p_{A}}$，其中 $p_{A}$ 是 $A$ 的分压，$K(D)$ 是吸附平衡常数，由 $K(D) = K^{\\circ} \\exp\\!\\left(\\dfrac{D}{R T}\\right)$ 给出，其中 $K^{\\circ}  0$ 是一个常数（单位为压力的倒数），包含了标准态和熵的贡献。\n\n假设表面反应 $A^* \\rightarrow P(\\mathrm{g}) + *$ 的反应能等于 $E_{\\mathrm{rxn}}(D) = D$，这与 $D$ 是吸附自由能的正值大小一致。定义 $k_{2,0} \\equiv \\nu \\exp(-E_{0}/(R T))$，则表面反应速率常数为 $k_{2}(D) = k_{2,0} \\exp\\!\\left(-\\dfrac{\\alpha D}{R T}\\right)$。每个位点的转换频率 (TOF) 为 $r(D) = k_{2}(D)\\,\\theta_{A}(D)$。\n\n任务：推导 $r(D)$ 的火山型解析表达式，并计算在 $D  0$ 范围内使 $r(D)$ 最大化的全局最优描述符 $D^{\\star}$，以 $R$、$T$、$\\alpha$、$p_{A}$ 和 $K^{\\circ}$ 的函数形式给出闭合表达式。将最终答案表示为 $D^{\\star}$ 的单一闭合形式解析表达式。不要进行数值计算。",
            "solution": "该问题已经过验证，被确定为化学动力学和催化理论中一个适定的、有科学依据的问题。\n\n目标是推导转换频率 $r$ 作为催化剂描述符 $D$ 的函数表达式，并找到使该速率最大化的描述符最优值 $D^{\\star}$。描述符 $D  0$ 被定义为吸附吉布斯自由能的正值大小。\n\n每个位点的转换频率 (TOF) $r(D)$ 由表面反应速率常数 $k_{2}(D)$ 与吸附中间体覆盖度 $\\theta_{A}(D)$ 的乘积给出。\n$$\nr(D) = k_{2}(D) \\theta_{A}(D)\n$$\n$k_{2}(D)$ 和 $\\theta_{A}(D)$ 的表达式已在问题描述中给出。\n表面反应速率常数由下式给出：\n$$\nk_{2}(D) = k_{2,0} \\exp\\left(-\\frac{\\alpha D}{R T}\\right)\n$$\n其中 $k_{2,0}$、$\\alpha$、$R$ 和 $T$ 是常数。此表达式表明，表面反应的速率随结合强度 $D$ 的增加而减小，因为根据斜率为正值 $\\alpha$ 的 Brønsted–Evans–Polanyi (BEP) 关系，更稳定的中间体 $A^*$ 在解吸为产物 $P$ 时面临更高的活化能垒。\n\n中间体的表面覆盖度 $\\theta_{A}(D)$ 由吸附准平衡条件下的朗缪尔等温线给出：\n$$\n\\theta_{A}(D) = \\frac{K(D) p_{A}}{1 + K(D) p_{A}}\n$$\n其中吸附平衡常数 $K(D)$ 为：\n$$\nK(D) = K^{\\circ} \\exp\\left(\\frac{D}{R T}\\right)\n$$\n此处，$p_{A}$ 和 $K^{\\circ}$ 是常数。此表达式表明，表面覆盖度 $\\theta_{A}(D)$ 随结合强度 $D$ 的增加而增加，并渐近地趋近于一个完整的单分子层（$\\theta_{A} \\to 1$）。\n\n结合这些表达式，转换频率的完整方程为：\n$$\nr(D) = k_{2,0} \\exp\\left(-\\frac{\\alpha D}{R T}\\right) \\frac{K^{\\circ} \\exp\\left(\\frac{D}{R T}\\right) p_{A}}{1 + K^{\\circ} \\exp\\left(\\frac{D}{R T}\\right) p_{A}}\n$$\n该表达式展示了 Sabatier 原理核心的经典火山型关系。\n对于较小的 $D$ 值（弱吸附），$K^{\\circ} p_{A} \\exp(D/(R T))$ 项很小。分母趋近于 $1$，且 $\\theta_{A}(D) \\approx K^{\\circ} p_{A} \\exp(D/(R T))$。因此，速率为：\n$$\nr(D) \\approx k_{2,0} \\exp\\left(-\\frac{\\alpha D}{R T}\\right) \\left[ K^{\\circ} p_{A} \\exp\\left(\\frac{D}{R T}\\right) \\right] = k_{2,0} K^{\\circ} p_{A} \\exp\\left(\\frac{(1-\\alpha)D}{R T}\\right)\n$$\n由于 $0  \\alpha  1$，指数 $(1-\\alpha)$ 为正，因此速率随 $D$ 呈指数增长。整个过程受限于吸附中间体 $A^*$ 的可用性。\n\n对于较大的 $D$ 值（强吸附），$K^{\\circ} p_{A} \\exp(D/(R T))$ 项很大。表面变得饱和，因此 $\\theta_{A}(D) \\to 1$。因此，速率为：\n$$\nr(D) \\approx k_{2,0} \\exp\\left(-\\frac{\\alpha D}{R T}\\right) \\times 1 = k_{2,0} \\exp\\left(-\\frac{\\alpha D}{R T}\\right)\n$$\n速率随 $D$ 呈指数下降。整个过程受限于非常稳定的中间体 $A^*$ 的缓慢表面反应。\n\n这两种相反趋势之间的竞争，在某个中间的最优描述符值 $D^{\\star}$ 处产生了一个最大速率。为了找到这个最大值，我们可以将 $r(D)$ 对 $D$ 的导数设为零。通常，处理速率的自然对数 $\\ln(r(D))$ 在数学上更简单，因为 $\\ln(x)$ 是一个单调递增函数，其最大值将与 $r(D)$ 的最大值出现在相同的 $D$ 值处。\n\n速率的自然对数为：\n$$\n\\ln(r(D)) = \\ln\\left(k_{2,0}\\right) + \\ln\\left(\\exp\\left(-\\frac{\\alpha D}{R T}\\right)\\right) + \\ln\\left(\\frac{K(D) p_{A}}{1 + K(D) p_{A}}\\right)\n$$\n$$\n\\ln(r(D)) = \\ln(k_{2,0}) - \\frac{\\alpha D}{R T} + \\ln(K(D) p_{A}) - \\ln(1 + K(D) p_{A})\n$$\n代入 $K(D) = K^{\\circ} \\exp(D/(R T))$：\n$$\n\\ln(r(D)) = \\ln(k_{2,0}) - \\frac{\\alpha D}{R T} + \\ln\\left(K^{\\circ}p_{A}\\right) + \\frac{D}{R T} - \\ln\\left(1 + K^{\\circ} p_{A} \\exp\\left(\\frac{D}{R T}\\right)\\right)\n$$\n$$\n\\ln(r(D)) = C + \\frac{(1-\\alpha)D}{R T} - \\ln\\left(1 + K^{\\circ} p_{A} \\exp\\left(\\frac{D}{R T}\\right)\\right)\n$$\n其中 $C = \\ln(k_{2,0}) + \\ln(K^{\\circ}p_{A})$ 是一个相对于 $D$ 的常数。\n\n现在，我们将 $\\ln(r(D))$ 对 $D$ 求导：\n$$\n\\frac{d}{dD} \\ln(r(D)) = \\frac{1-\\alpha}{R T} - \\frac{1}{1 + K^{\\circ} p_{A} \\exp\\left(\\frac{D}{R T}\\right)} \\cdot \\left(K^{\\circ} p_{A} \\exp\\left(\\frac{D}{R T}\\right) \\cdot \\frac{1}{R T}\\right)\n$$\n为了找到最优描述符 $D^{\\star}$，我们将此导数设为零：\n$$\n\\frac{1-\\alpha}{R T} = \\frac{K^{\\circ} p_{A} \\exp\\left(\\frac{D^{\\star}}{R T}\\right)}{1 + K^{\\circ} p_{A} \\exp\\left(\\frac{D^{\\star}}{R T}\\right)} \\cdot \\frac{1}{R T}\n$$\n方程两边的 $1/(R T)$ 项可以消去：\n$$\n1-\\alpha = \\frac{K^{\\circ} p_{A} \\exp\\left(\\frac{D^{\\star}}{R T}\\right)}{1 + K^{\\circ} p_{A} \\exp\\left(\\frac{D^{\\star}}{R T}\\right)}\n$$\n我们解此方程以求得 $D^{\\star}$。令 $X = K^{\\circ} p_{A} \\exp(D^{\\star}/(R T))$。方程变为：\n$$\n1-\\alpha = \\frac{X}{1+X}\n$$\n$$\n(1-\\alpha)(1+X) = X\n$$\n$$\n1-\\alpha + (1-\\alpha)X = X\n$$\n$$\n1-\\alpha = X - (1-\\alpha)X = X(1 - (1-\\alpha)) = X\\alpha\n$$\n解出 $X$：\n$$\nX = \\frac{1-\\alpha}{\\alpha}\n$$\n现在，我们将 $X$ 的表达式代回：\n$$\nK^{\\circ} p_{A} \\exp\\left(\\frac{D^{\\star}}{R T}\\right) = \\frac{1-\\alpha}{\\alpha}\n$$\n最后，我们通过对两边取自然对数来解出 $D^{\\star}$：\n$$\n\\exp\\left(\\frac{D^{\\star}}{R T}\\right) = \\frac{1-\\alpha}{\\alpha K^{\\circ} p_{A}}\n$$\n$$\n\\frac{D^{\\star}}{R T} = \\ln\\left(\\frac{1-\\alpha}{\\alpha K^{\\circ} p_{A}}\\right)\n$$\n$$\nD^{\\star} = R T \\ln\\left(\\frac{1-\\alpha}{\\alpha K^{\\circ} p_{A}}\\right)\n$$\n这就是使转换频率最大化的最优描述符 $D^{\\star}$ 的闭合形式解析表达式。要使 $D  0$ 存在最大值，要求对数的宗量（参数）大于 $1$。问题中“火山型表达式”的前提意味着在定义域内存在这样的一个最大值。",
            "answer": "$$\n\\boxed{R T \\ln\\left(\\frac{1-\\alpha}{\\alpha K^{\\circ} p_{A}}\\right)}\n$$"
        }
    ]
}