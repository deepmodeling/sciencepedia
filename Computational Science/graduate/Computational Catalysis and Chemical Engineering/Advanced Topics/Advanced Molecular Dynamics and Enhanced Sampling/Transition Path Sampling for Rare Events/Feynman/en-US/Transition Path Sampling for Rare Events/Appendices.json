{
    "hands_on_practices": [
        {
            "introduction": "The core motivation for developing sophisticated methods like Transition Path Sampling (TPS) is the so-called \"rare event problem.\" Before mastering the techniques of TPS, it is essential to have a quantitative feel for the immense timescale separation that defines a rare event. This first practice  grounds our discussion in fundamental chemical kinetics, asking you to calculate the mean waiting time for a typical catalytic reaction and articulate why a direct simulation of this process is computationally intractable.",
            "id": "3903464",
            "problem": "A surface-mediated elementary step in a heterogeneous catalyst is modeled as barrier crossing between two metastable basins separated by an Arrhenius barrier. Consider a rare-event transition from an adsorbed precursor state to an activated intermediate on a catalytic surface at temperature $T=500\\,\\text{K}$. The transition has an Arrhenius barrier $E^{\\ddagger}=0.8\\,\\text{eV}$ and a harmonic attempt frequency $\\nu=10^{13}\\,\\text{s}^{-1}$, characteristic of surface vibrational modes. Assume a memoryless (Poisson) sequence of barrier-crossing attempts consistent with a Markov jump process and that the rate constant follows the Arrhenius form under the assumptions of transition state theory and harmonic approximations for basin dynamics.\n\nUsing only fundamental relations and well-tested formulas, derive the mean waiting time for the next successful transition event. Then, explain from first principles of Transition Path Sampling (TPS) why, for direct atomistic simulation at fixed temperature, the observed trajectory segments are overwhelmingly nonreactive and how this motivates path-ensemble importance sampling.\n\nTake the Boltzmann constant as $k_{B}$ and do not substitute its numerical value until the final numerical evaluation. Express the final mean waiting time in seconds and round your answer to three significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Temperature: $T = 500\\,\\text{K}$\n- Arrhenius energy barrier: $E^{\\ddagger} = 0.8\\,\\text{eV}$\n- Harmonic attempt frequency: $\\nu = 10^{13}\\,\\text{s}^{-1}$\n- Process model: A memoryless (Poisson) sequence of barrier-crossing attempts, consistent with a Markov jump process.\n- Rate constant model: The rate constant $k$ follows the Arrhenius form, based on transition state theory (TST) and harmonic approximations.\n- Fundamental constant: Boltzmann constant is $k_B$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is firmly rooted in the principles of chemical kinetics, statistical mechanics, and computational chemistry. The Arrhenius equation is a fundamental concept for describing the temperature dependence of reaction rates. The use of transition state theory, harmonic approximations, and the modeling of reaction events as a Poisson process are standard, well-established frameworks in the study of chemical reactions, particularly in heterogeneous catalysis. The numerical values provided for the temperature, energy barrier, and attempt frequency are physically realistic for surface-mediated chemical reactions. The second part of the problem concerns Transition Path Sampling (TPS), a widely used and validated advanced simulation technique for studying rare events. All aspects are scientifically sound.\n- **Well-Posed**: The problem is clearly stated and contains all necessary information to calculate the mean waiting time. It requests a calculation followed by a conceptual explanation, both of which are well-defined tasks. The question regarding TPS is specific and asks for a justification based on first principles, leading to a unique conceptual answer.\n- **Objective**: The problem is expressed in precise, technical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, and objective. A full solution will be provided.\n\n### Part 1: Derivation of Mean Waiting Time\nThe problem posits a rare-event transition that can be described as a Poisson process. For a Poisson process, the waiting time between successive events is an exponential random variable. If the rate of an event is given by the rate constant $k$, the probability density function for the waiting time $\\tau$ is $p(\\tau) = k \\exp(-k\\tau)$. The mean waiting time, $\\langle\\tau\\rangle$, is the expected value of this distribution:\n$$\n\\langle\\tau\\rangle = \\int_0^{\\infty} \\tau p(\\tau) d\\tau = \\int_0^{\\infty} \\tau k \\exp(-k\\tau) d\\tau\n$$\nThis integral evaluates to $1/k$. Therefore, the mean waiting time is the reciprocal of the reaction rate constant.\n$$\n\\langle\\tau\\rangle = \\frac{1}{k}\n$$\nThe problem states that the rate constant $k$ follows the Arrhenius form, consistent with transition state theory (TST) under harmonic approximations. In this framework, the pre-exponential factor is identified with the attempt frequency $\\nu$. The Arrhenius equation is:\n$$\nk = \\nu \\exp\\left(-\\frac{E^{\\ddagger}}{k_B T}\\right)\n$$\nwhere $\\nu$ is the attempt frequency, $E^{\\ddagger}$ is the activation energy barrier, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nWe are given the following values:\n- $\\nu = 10^{13}\\,\\text{s}^{-1}$\n- $E^{\\ddagger} = 0.8\\,\\text{eV}$\n- $T = 500\\,\\text{K}$\n\nTo calculate the rate constant, we first evaluate the dimensionless term in the exponent, $E^{\\ddagger}/(k_B T)$. We use the Boltzmann constant in units of eV/K, which is $k_B \\approx 8.61733 \\times 10^{-5}\\,\\text{eV}\\cdot\\text{K}^{-1}$.\n$$\n\\frac{E^{\\ddagger}}{k_B T} = \\frac{0.8\\,\\text{eV}}{(8.61733 \\times 10^{-5}\\,\\text{eV}\\cdot\\text{K}^{-1}) \\times (500\\,\\text{K})} \\approx 18.568\n$$\nNow, we can compute the rate constant $k$:\n$$\nk = (10^{13}\\,\\text{s}^{-1}) \\times \\exp(-18.568) \\approx (10^{13}\\,\\text{s}^{-1}) \\times (8.629 \\times 10^{-9}) \\approx 8.629 \\times 10^4\\,\\text{s}^{-1}\n$$\nThe mean waiting time $\\langle\\tau\\rangle$ is the reciprocal of this rate constant:\n$$\n\\langle\\tau\\rangle = \\frac{1}{k} = \\frac{1}{8.629 \\times 10^4\\,\\text{s}^{-1}} \\approx 1.1589 \\times 10^{-5}\\,\\text{s}\n$$\nRounding to three significant figures as requested, the mean waiting time is $1.16 \\times 10^{-5}\\,\\text{s}$.\n\n### Part 2: Justification for Transition Path Sampling (TPS)\nFrom first principles, a direct atomistic simulation, such as Molecular Dynamics (MD), propagates the system's state by integrating Newton's equations of motion over very small time steps, typically on the order of femtoseconds ($1\\,\\text{fs} = 10^{-15}\\,\\text{s}$). The simulation generates a trajectory in phase space, representing the atomic motions over time.\n\nThe system is described as residing in a metastable basin (the adsorbed precursor state), separated from another basin (the activated intermediate) by an energy barrier $E^{\\ddagger}$. According to the equipartition theorem and statistical mechanics, the probability of the system having enough thermal energy to reach a configuration at the top of the barrier is proportional to the Boltzmann factor, $\\exp(-E^{\\ddagger}/k_B T)$. For the given problem, this factor is extremely small ($\\approx 8.6 \\times 10^{-9}$). This signifies that configurations near the transition state are visited exceedingly rarely.\n\nThis rarity manifests in a vast timescale separation. The characteristic time for atomic vibrations (the attempt frequency) is $\\nu^{-1} = 10^{-13}\\,\\text{s}$. However, the mean time to a successful reactive event, calculated above as $\\langle\\tau\\rangle \\approx 1.16 \\times 10^{-5}\\,\\text{s}$, is many orders of magnitude longer. Specifically, it is about $10^8$ times longer than the vibrational period.\n\nA direct MD simulation is computationally expensive. To observe a single reactive event on average, one would need to simulate a trajectory of length on the order of $\\langle\\tau\\rangle$. With a typical timestep of $1\\,\\text{fs}$, this would require approximately $(1.16 \\times 10^{-5}\\,\\text{s}) / (10^{-15}\\,\\text{s}) = 1.16 \\times 10^{10}$ integration steps. Such a simulation is computationally prohibitive.\n\nTherefore, if one runs a direct MD simulation for a computationally feasible duration (e.g., nanoseconds, or $10^6$ steps), the trajectory will almost certainly show the system merely vibrating and exploring the phase space within its initial metastable basin. It will not have sufficient time to spontaneously sample the high-energy fluctuation required to cross the barrier. These overwhelmingly common, computationally accessible trajectory segments are thus **nonreactive**. This is the essence of the \"rare event problem\" in molecular simulation.\n\nTransition Path Sampling (TPS) is an advanced method designed to circumvent this problem. Instead of wasting computational effort simulating the long, uneventful waiting periods, TPS focuses exclusively on the very short, but mechanistically crucial, trajectory segments that constitute the transition itself. TPS defines a path ensemble of trajectories of a fixed, short duration that connect the reactant state (A) to the product state (B). Because these reactive paths are exceedingly rare, they cannot be found by direct sampling.\n\nTPS overcomes this by using **path-ensemble importance sampling**. It employs a Monte Carlo procedure in the space of trajectories. Starting from a known (often guessed) reactive path, it generates new candidate paths by slightly perturbing the old one (e.g., via a \"shooting\" algorithm, which involves modifying momenta at a point on the path and re-integrating). A Metropolis-like acceptance criterion is used to accept or reject the new path, ensuring that a statistically correct sample of the path ensemble is generated. By focusing the sampling effort on the infinitesimal fraction of phase space corresponding to reactive pathways, TPS makes it possible to study the mechanism, dynamics, and rate constants of rare events without having to simulate the astronomically long waiting times.",
            "answer": "$$\n\\boxed{1.16 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "Having established the need for path sampling, the next practical challenge is to construct a valid simulation protocol. The statistical rigor of TPS relies on the underlying molecular dynamics engine generating trajectories that correctly sample the desired physical ensemble. In this exercise , you will act as a computational scientist designing a study, critically evaluating several proposed simulation setups to determine which are compatible with the fundamental assumptions of TPS, such as the use of a reactive potential and an appropriate thermostat.",
            "id": "3903446",
            "problem": "A catalytic rare event of interest is the proton transfer between a Brønsted acid site in a siliceous framework and an adsorbed alcohol in a zeolite environment, modeled as methanol at a Brønsted site in H-ZSM-5. The event involves bond making/breaking in the O–H group and occurs at elevated temperature (e.g., $600\\,\\mathrm{K}$) with system dynamics propagated in an isothermal ensemble. Transition Path Sampling (TPS) aims to sample the ensemble of reactive trajectories connecting basin $A$ (proton on framework oxygen) and basin $B$ (proton transferred to methanol oxygen) without biasing forces. For TPS to be valid and efficient, the following first-principles conditions must hold:\n- The dynamics follow well-defined equations of motion consistent with a stationary target ensemble (e.g., the canonical ensemble with probability density $\\rho(\\mathbf{x},\\mathbf{p}) \\propto \\exp\\left(-\\beta H(\\mathbf{x},\\mathbf{p})\\right)$, where $H$ is the Hamiltonian, $\\mathbf{x}$ are positions, $\\mathbf{p}$ are momenta, and $\\beta = 1/(k_{\\mathrm{B}} T)$).\n- For deterministic dynamics, microscopic reversibility and volume-preserving integration (e.g., velocity Verlet) ensure path weights and detailed balance in the path ensemble. For stochastic dynamics, a Markovian process with fluctuation-dissipation-consistent noise yields well-defined path probabilities that TPS can sample if noise histories are correctly handled.\n- The potential energy surface must support the rare event (reactivity), and the integration time step must resolve the fastest vibrational mode to avoid numerical artifacts. For the O–H stretch with wavenumber $\\tilde{\\nu} \\approx 3600\\,\\mathrm{cm}^{-1}$, the frequency is $\\nu = c \\tilde{\\nu}$ with $c \\approx 2.998 \\times 10^{10}\\,\\mathrm{cm\\,s}^{-1}$, giving $\\nu \\approx 1.079 \\times 10^{14}\\,\\mathrm{s}^{-1}$ and period $\\tau \\approx 9.27 \\times 10^{-15}\\,\\mathrm{s} = 9.27\\,\\mathrm{fs}$. A conservative stability/accuracy criterion for a second-order integrator is $\\Delta t \\lesssim 0.05\\,\\tau \\approx 0.46\\,\\mathrm{fs}$.\n\nConsider the following proposed molecular simulation setups for TPS of this proton transfer rare event. Select all options that are compatible with core TPS assumptions and likely to yield scientifically sound path sampling for this system:\n\nA. Machine-learning interatomic potential trained to Density Functional Theory (DFT) forces and energies for H-ZSM-5/methanol, isothermal–isobaric conditions reduced to constant volume for cell rigidity, constant-temperature dynamics via Nosé–Hoover chains, velocity Verlet integrator, timestep $\\Delta t = 0.25\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.\n\nB. Reactive force field (ReaxFF) parameterized for aluminosilicates and alcohols, constant-temperature dynamics via Langevin thermostat with friction coefficient $\\gamma = 1\\,\\mathrm{ps}^{-1}$, Gaussian white noise consistent with the fluctuation-dissipation theorem $\\langle \\eta_i(t)\\eta_j(t')\\rangle = 2 m_i \\gamma k_{\\mathrm{B}} T \\delta_{ij}\\delta(t-t')$, noise histories stored and correctly resampled during TPS shooting, timestep $\\Delta t = 0.25\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.\n\nC. Fixed-charge nonreactive silicate force field with constrained O–H bonds using SHAKE to permit a larger timestep, Berendsen thermostat with weak coupling to a heat bath, velocity Verlet integrator, timestep $\\Delta t = 2.0\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.\n\nD. Ab initio Born–Oppenheimer molecular dynamics on-the-fly with generalized gradient approximation (GGA) and dispersion correction (e.g., PBE-D3), constant-temperature dynamics via Nosé–Hoover chains, velocity Verlet integrator, timestep $\\Delta t = 0.50\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.\n\nE. Machine-learning potential as in option A, constant-temperature dynamics via a generalized Langevin equation with colored noise and memory kernel not explicitly incorporated into TPS path-weight calculations, timestep $\\Delta t = 0.25\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.\n\nIn your selection, base your reasoning on the following fundamental bases: Newton’s second law $\\mathbf{F}_i = m_i \\mathbf{a}_i$, the canonical ensemble $\\rho \\propto \\exp(-\\beta H)$, microscopic reversibility and volume preservation for deterministic integrators, the fluctuation–dissipation theorem for stochastic thermostats, and the harmonic approximation for estimating the fastest vibrational period to set $\\Delta t$. Do not assume any external biasing forces or collective-variable restraints are applied. Choose all that apply.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **System and Process**: A catalytic rare event, specifically proton transfer between a Brønsted acid site in H-ZSM-5 and an adsorbed methanol molecule.\n- **Thermodynamic Conditions**: Elevated temperature, $T = 600\\,\\mathrm{K}$, with system dynamics propagated in an isothermal ensemble.\n- **Methodology**: Transition Path Sampling (TPS) to sample reactive trajectories between state $A$ (proton on framework) and state $B$ (proton on methanol). No external biasing forces are applied.\n- **Core TPS Requirements**:\n    1.  Dynamics must be consistent with a stationary target ensemble, e.g., the canonical ensemble with probability density $\\rho(\\mathbf{x},\\mathbf{p}) \\propto \\exp\\left(-\\beta H(\\mathbf{x},\\mathbf{p})\\right)$.\n    2.  For deterministic dynamics, the integrator must ensure microscopic reversibility and be volume-preserving (e.g., velocity Verlet).\n    3.  For stochastic dynamics, the process must be Markovian with noise satisfying the fluctuation-dissipation theorem, and noise histories must be correctly handled in the sampling.\n    4.  The potential energy surface (PES) must be capable of describing the reaction (bond making/breaking).\n    5.  The integration timestep $\\Delta t$ must be small enough to resolve the fastest vibrational mode.\n- **Timestep Constraint**: For an O–H stretch with wavenumber $\\tilde{\\nu} \\approx 3600\\,\\mathrm{cm}^{-1}$, the period is $\\tau \\approx 9.27\\,\\mathrm{fs}$. A stated conservative criterion for a second-order integrator is $\\Delta t \\lesssim 0.05\\,\\tau \\approx 0.46\\,\\mathrm{fs}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in the principles of computational chemistry, statistical mechanics, and chemical engineering. Proton transfer in zeolites is a canonical problem, and TPS is a standard, rigorous method for studying such rare events. The physical constants, derived values ($\\tau$), and stability criteria are correct and standard in the field.\n- **Well-Posedness**: The task is to evaluate several proposed simulation setups against a clear and explicit set of physical and numerical criteria. This structure permits a unique and objective answer.\n- **Objectivity**: The language is technical and precise, free of subjective or ambiguous terminology.\n- **Flaw Assessment**: The problem statement does not violate any of the specified invalidity criteria. It is scientifically sound, formalizable, complete, feasible, and well-posed. The a priori information provided (e.g., the timestep criterion) constitutes a set of rules against which the options are to be judged.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived by analyzing each option against the established principles.\n\n### Solution Derivation\n\nThe validity of each proposed setup for Transition Path Sampling (TPS) hinges on three main requirements derived from the problem statement:\n1.  **Reactive Potential Energy Surface (PES)**: The model for interatomic forces must be able to describe the breaking of the original O–H bond and the formation of a new O–H bond, which is the essence of the proton transfer reaction.\n2.  **Correct Ensemble Dynamics**: The combination of the integrator and thermostat must generate trajectories that correctly sample the canonical ensemble ($NVT$). For TPS, this implies specific properties: for deterministic dynamics, the algorithm must be time-reversible and volume-preserving to ensure correct path probabilities. for stochastic dynamics, the noise must satisfy the fluctuation-dissipation theorem, and the path probability measure must correctly account for the specific noise history of each path.\n3.  **Numerical Stability**: The integration timestep, $\\Delta t$, must be sufficiently small to accurately integrate the equations of motion, particularly for the fastest degrees of freedom. The problem provides a conservative guideline of $\\Delta t \\lesssim 0.46\\,\\mathrm{fs}$.\n\nWe evaluate each option against these criteria.\n\n**A. Machine-learning interatomic potential trained to Density Functional Theory (DFT) forces and energies for H-ZSM-5/methanol, isothermal–isobaric conditions reduced to constant volume for cell rigidity, constant-temperature dynamics via Nosé–Hoover chains, velocity Verlet integrator, timestep $\\Delta t = 0.25\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.**\n\n1.  **PES**: A machine-learning potential trained on DFT data is designed to reproduce the quantum mechanical PES. DFT is capable of describing bond breaking and formation, so this potential is reactive and appropriate for the problem.\n2.  **Dynamics**: The combination of the velocity Verlet integrator and the Nosé–Hoover chains thermostat is a standard, deterministic method for generating the canonical ($NVT$) ensemble. This algorithm is time-reversible and symplectic (volume-preserving in the extended phase space), satisfying the core requirements for deterministic TPS. The phrase \"isothermal–isobaric conditions reduced to constant volume\" is simply a slightly convoluted statement for $NVT$ dynamics, which is correct.\n3.  **Timestep**: The proposed timestep $\\Delta t = 0.25\\,\\mathrm{fs}$ is well below the conservative stability limit of $\\approx 0.46\\,\\mathrm{fs}$. This ensures numerical accuracy and stability for the high-frequency O–H stretch.\n\nAll requirements are met. This setup is a sound and modern approach for TPS.\n**Verdict: Correct**\n\n**B. Reactive force field (ReaxFF) parameterized for aluminosilicates and alcohols, constant-temperature dynamics via Langevin thermostat with friction coefficient $\\gamma = 1\\,\\mathrm{ps}^{-1}$, Gaussian white noise consistent with the fluctuation-dissipation theorem $\\langle \\eta_i(t)\\eta_j(t')\\rangle = 2 m_i \\gamma k_{\\mathrm{B}} T \\delta_{ij}\\delta(t-t')$, noise histories stored and correctly resampled during TPS shooting, timestep $\\Delta t = 0.25\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.**\n\n1.  **PES**: A reactive force field (ReaxFF) is explicitly designed to model chemical reactions, including bond dissociation and formation, making it suitable for this reactive event.\n2.  **Dynamics**: The Langevin thermostat introduces stochastic dynamics. The problem correctly states that the noise must conform to the fluctuation-dissipation theorem to generate the canonical ensemble. Critically for TPS with stochastic dynamics, it also specifies that the \"noise histories [are] stored and correctly resampled during TPS shooting.\" This is the mandatory procedure to ensure that the path probabilities are correctly defined and that the sampling satisfies detailed balance.\n3.  **Timestep**: The timestep $\\Delta t = 0.25\\,\\mathrm{fs}$ is safely below the stability limit.\n\nAll requirements are met. This setup correctly describes a valid TPS simulation with stochastic dynamics.\n**Verdict: Correct**\n\n**C. Fixed-charge nonreactive silicate force field with constrained O–H bonds using SHAKE to permit a larger timestep, Berendsen thermostat with weak coupling to a heat bath, velocity Verlet integrator, timestep $\\Delta t = 2.0\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.**\n\nThis option has multiple fundamental flaws.\n1.  **PES**: A \"nonreactive\" force field cannot, by definition, describe the bond-breaking/forming event central to the problem. Furthermore, the use of the SHAKE algorithm to constrain O–H bonds explicitly prevents the proton transfer from occurring. The potential is unsuitable for the stated purpose.\n2.  **Dynamics**: The Berendsen thermostat is known to not rigorously generate the canonical ensemble. It rescales velocities to guide the system to the target temperature but does not produce the correct statistical fluctuations of the $NVT$ ensemble. Therefore, it is unsuitable for methods like TPS which rely on correct path probabilities derived from a specific statistical ensemble.\n3.  **Timestep**: A timestep of $\\Delta t = 2.0\\,\\mathrm{fs}$ is only plausible because the high-frequency O–H bonds are constrained. However, since constraining these bonds makes the simulation of the event impossible, this point is moot. If used with an unconstrained, reactive potential, this timestep would be far too large, violating the stability criterion $\\Delta t \\lesssim 0.46\\,\\mathrm{fs}$ by a factor of more than four, leading to numerical divergence.\n\nThis setup is invalid on several fundamental grounds.\n**Verdict: Incorrect**\n\n**D. Ab initio Born–Oppenheimer molecular dynamics on-the-fly with generalized gradient approximation (GGA) and dispersion correction (e.g., PBE-D3), constant-temperature dynamics via Nosé–Hoover chains, velocity Verlet integrator, timestep $\\Delta t = 0.50\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.**\n\n1.  **PES**: Ab initio molecular dynamics (AIMD) calculates forces directly from quantum mechanics (here, DFT at the PBE-D3 level) at each step. This provides a high-quality, inherently reactive PES.\n2.  **Dynamics**: As in option A, the Nosé–Hoover chains thermostat coupled with the velocity Verlet integrator provides a rigorous deterministic sampling of the canonical ensemble, which is compatible with TPS.\n3.  **Timestep**: The proposed timestep is $\\Delta t = 0.50\\,\\mathrm{fs}$. This value is slightly larger than the stated \"conservative\" criterion of $\\Delta t \\lesssim 0.46\\,\\mathrm{fs}$. However, the problem explicitly qualifies this criterion as \"conservative\". A timestep of $0.50\\,\\mathrm{fs}$ is a very common choice for AIMD simulations involving hydrogen atoms, corresponding to a discretization of the fastest vibrational period ($\\tau \\approx 9.27\\,\\mathrm{fs}$) by a factor of $\\approx 18.5$. While aggressive, it does not represent a fundamental methodological flaw but rather a choice of numerical parameter that requires verification (e.g., monitoring energy conservation). Given that the prompt asks for setups that are \"likely to yield scientifically sound path sampling,\" this choice, while pushing the boundary, is acceptable in the context of a high-quality simulation methodology.\n\nThe overall approach is sound, employing a first-principles potential and a rigorous thermostat. The timestep is on the edge of the recommended range but is a defensible choice in practice.\n**Verdict: Correct**\n\n**E. Machine-learning potential as in option A, constant-temperature dynamics via a generalized Langevin equation with colored noise and memory kernel not explicitly incorporated into TPS path-weight calculations, timestep $\\Delta t = 0.25\\,\\mathrm{fs}$, temperature $T = 600\\,\\mathrm{K}$.**\n\n1.  **PES**: The MLIP is a valid choice, as established in option A.\n2.  **Dynamics**: The use of a Generalized Langevin Equation (GLE) is a valid way to thermostat a system. However, the dynamics generated by a GLE with a memory kernel are non-Markovian. The probability of a given path depends on the specific history of the colored noise, which is determined by the memory kernel. The statement that the memory kernel is **\"not explicitly incorporated into TPS path-weight calculations\"** is a critical, fundamental flaw. For the TPS algorithm to satisfy detailed balance in the path ensemble, the path action used in the acceptance probability must correctly account for the probability of the path's driving noise. Ignoring the memory kernel leads to incorrect path probabilities and, consequently, incorrect sampling.\n3.  **Timestep**: The timestep $\\Delta t = 0.25\\,\\mathrm{fs}$ is valid.\n\nThe failure to properly account for the GLE dynamics in the TPS path weights invalidates this setup.\n**Verdict: Incorrect**\n\nIn summary, options A, B, and D describe setups that are compatible with the core assumptions of TPS and are likely to produce scientifically sound results for the specified problem. Options C and E contain fundamental methodological errors.",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "A crucial step in any Transition Path Sampling study is the precise definition of the reactant ($A$) and product ($B$) stable states. These definitions are not merely arbitrary boundaries; they can influence the efficiency of the sampling and the interpretation of the results. This final practice  offers a hands-on coding challenge to explore this concept. By working with a tractable one-dimensional potential, you will implement a procedure to define the basins and, more importantly, to assess the robustness of your conclusions by analyzing how the committor probability changes with small adjustments to these definitions.",
            "id": "3903440",
            "problem": "Consider a one-dimensional reduced model for a catalytic reaction coordinate used in Transition Path Sampling (TPS), where the configuration coordinate is denoted by $x$, the potential of mean force (free energy landscape) is modeled by $U(x) = \\alpha (x^2 - 1)^2 + \\varepsilon x$, and the dynamics is overdamped with constant diffusion. The quantities $\\alpha$ and $\\varepsilon$ are dimensionless parameters controlling the barrier height and the thermodynamic driving force (tilt), respectively. Work in reduced, dimensionless units where the thermal energy is $k_{\\mathrm{B}} T = 1$, and express all numerical answers as dimensionless numbers.\n\nIn TPS, one defines indicator functions for the reactant basin $\\mathcal{A}$ and product basin $\\mathcal{B}$ via thresholds on an order parameter. Let the order parameter be $\\lambda(x) = x$, and define $h_{\\mathcal{A}}(x)$ and $h_{\\mathcal{B}}(x)$ as\n$h_{\\mathcal{A}}(x) = 1$ if $x \\le x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $h_{\\mathcal{A}}(x) = 0$ otherwise, and\n$h_{\\mathcal{B}}(x) = 1$ if $x \\ge x_{\\mathcal{B}}^{\\mathrm{thr}}$ and $h_{\\mathcal{B}}(x) = 0$ otherwise, for suitably chosen thresholds $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$.\n\nConstruct concrete values of $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$ based on the following physically motivated criterion: for each basin minimum $x_{\\mathcal{A}}^{\\min}$ and $x_{\\mathcal{B}}^{\\min}$, choose the thresholds such that the local harmonic free energy rise relative to the minimum is equal to a specified dimensionless increment $\\Delta F$, i.e., $U(x) \\approx U(x^\\min) + \\tfrac{1}{2} U''(x^\\min) (x - x^\\min)^2$, and impose $\\tfrac{1}{2} U''(x_{\\mathcal{A}}^{\\min}) \\left(x_{\\mathcal{A}}^{\\mathrm{thr}} - x_{\\mathcal{A}}^{\\min}\\right)^2 = \\Delta F$ and $\\tfrac{1}{2} U''(x_{\\mathcal{B}}^{\\min}) \\left(x_{\\mathcal{B}}^{\\mathrm{thr}} - x_{\\mathcal{B}}^{\\min}\\right)^2 = \\Delta F$, with $x_{\\mathcal{A}}^{\\mathrm{thr}}$ displaced toward the barrier from $x_{\\mathcal{A}}^{\\min}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$ displaced toward the barrier from $x_{\\mathcal{B}}^{\\min}$.\n\nTo assess robustness relevant to rare-event path ensembles, use the committor function $q(x)$, defined for overdamped dynamics with constant diffusion and absorbing boundaries at $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$ as the probability that a trajectory starting at $x$ next reaches the product basin boundary before the reactant basin boundary. Evaluate $q(x^\\ddagger)$ at the barrier top $x^\\ddagger$ (the local maximum of $U(x)$) and quantify its sensitivity to small variations of the thresholds induced by varying $\\Delta F$ by multiplicative factors $(1 \\pm \\delta)$ for small $\\delta$. Use the maximum absolute deviation of $q(x^\\ddagger)$ across these variations as the robustness metric, and declare the thresholds robust if this deviation is less than or equal to a specified tolerance.\n\nStarting from the definitions of $U(x)$, $h_{\\mathcal{A}}(x)$, $h_{\\mathcal{B}}(x)$, and the overdamped dynamics with constant diffusion, derive an algorithm that\n- locates $x_{\\mathcal{A}}^{\\min}$, $x_{\\mathcal{B}}^{\\min}$, and $x^\\ddagger$ by solving $U'(x)=0$ and classifying stationary points via $U''(x)$,\n- constructs $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$ from $\\Delta F$ using the local harmonic approximation,\n- computes $q(x^\\ddagger)$ for given thresholds from first principles,\n- tests robustness by varying $\\Delta F \\mapsto \\Delta F (1 \\pm \\delta)$ for given $\\delta$ values and reporting the maximum deviation in $q(x^\\ddagger)$ relative to the baseline thresholds.\n\nUse the following test suite of parameter sets. Each test case consists of $(\\alpha,\\varepsilon,\\beta,\\Delta F,\\{\\delta\\},\\tau)$ where $\\beta$ is the inverse temperature (dimensionless and equal to $1/(k_{\\mathrm{B}} T)$ in reduced units), $\\{\\delta\\}$ is a set of small fractional variations, and $\\tau$ is the robustness tolerance. All numbers are dimensionless.\n- Test case $1$: $(\\alpha=10,\\ \\varepsilon=0,\\ \\beta=1,\\ \\Delta F=1.0,\\ \\{\\delta\\}=\\{0.05, 0.10\\},\\ \\tau=0.02)$,\n- Test case $2$: $(\\alpha=10,\\ \\varepsilon=-2.0,\\ \\beta=1,\\ \\Delta F=1.0,\\ \\{\\delta\\}=\\{0.05, 0.10\\},\\ \\tau=0.02)$,\n- Test case $3$: $(\\alpha=6,\\ \\varepsilon=1.5,\\ \\beta=1,\\ \\Delta F=0.6,\\ \\{\\delta\\}=\\{0.10, 0.20\\},\\ \\tau=0.02)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the list $[x_{\\mathcal{A}}^{\\mathrm{thr}}, x_{\\mathcal{B}}^{\\mathrm{thr}}, q(x^\\ddagger), \\Delta q_{\\max}, \\mathrm{robust}]$, where $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$ are floats, $q(x^\\ddagger)$ is a float, $\\Delta q_{\\max}$ is a float equal to the maximum absolute deviation across the specified $\\delta$ values, and $\\mathrm{robust}$ is a boolean indicating whether $\\Delta q_{\\max} \\le \\tau$. The final printed string must aggregate the three lists into a single top-level list, for example, in the format $[[\\ldots],[\\ldots],[\\ldots]]$.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It outlines a complete computational task based on standard principles of statistical mechanics and the study of rare events. We will now derive and implement the required algorithm.\n\nThe problem is solved by following these four main steps:\n1.  **Locate Stationary Points:** Find the minima and the transition state of the potential energy surface $U(x)$.\n2.  **Construct Thresholds:** Determine the basin boundaries $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$ based on a harmonic approximation.\n3.  **Compute Committor Probability:** Calculate the committor $q(x^\\ddagger)$ at the transition state using its definition for overdamped dynamics.\n4.  **Assess Robustness:** Evaluate the sensitivity of $q(x^\\ddagger)$ to small variations in the threshold definitions.\n\n### Step 1: Locating Stationary Points\nThe potential of mean force is given by $U(x) = \\alpha (x^2 - 1)^2 + \\varepsilon x$. Stationary points are locations where the force vanishes, i.e., $U'(x) = 0$. The first derivative is:\n$$U'(x) = \\frac{d}{dx} \\left[ \\alpha (x^4 - 2x^2 + 1) + \\varepsilon x \\right] = 4\\alpha x^3 - 4\\alpha x + \\varepsilon$$\nThe stationary points are the roots of the cubic equation $4\\alpha x^3 - 4\\alpha x + \\varepsilon = 0$. For the given parameters ($\\alpha > 0$ and small $\\varepsilon$), this equation has three distinct real roots. These roots must be found numerically.\n\nTo classify these stationary points, we use the second derivative:\n$$U''(x) = 12\\alpha x^2 - 4\\alpha$$\nA point $x_0$ is a local minimum if $U''(x_0) > 0$ and a local maximum if $U''(x_0) < 0$. For a double-well potential, we expect two minima and one maximum. Let the sorted real roots be $x_1 < x_2 < x_3$. For the given form of $U(x)$, $x_1$ and $x_3$ will be the minima, and $x_2$ will be the maximum (the barrier top). We thus identify:\n- Reactant basin minimum: $x_{\\mathcal{A}}^{\\min} = x_1$\n- Product basin minimum: $x_{\\mathcal{B}}^{\\min} = x_3$\n- Transition state (barrier top): $x^\\ddagger = x_2$\n\n### Step 2: Constructing Thresholds\nThe thresholds $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$ define the boundaries of the reactant and product basins. They are constructed based on a harmonic approximation of the potential around each minimum $x^{\\min}$:\n$$U(x) \\approx U(x^{\\min}) + \\frac{1}{2} U''(x^{\\min}) (x - x^{\\min})^2$$\nThe problem specifies that the thresholds are chosen such that the harmonic free energy rise is equal to a given value $\\Delta F$:\n$$\\frac{1}{2} U''(x^{\\min}) (x^{\\mathrm{thr}} - x^{\\min})^2 = \\Delta F$$\nSolving for the displacement $(x^{\\mathrm{thr}} - x^{\\min})$ yields:\n$$|x^{\\mathrm{thr}} - x^{\\min}| = \\sqrt{\\frac{2 \\Delta F}{U''(x^{\\min})}}$$\nThe problem states that the thresholds are displaced from their respective minima *toward* the barrier at $x^\\ddagger$. Since $x_{\\mathcal{A}}^{\\min} < x^\\ddagger < x_{\\mathcal{B}}^{\\min}$, the displacement for the reactant basin must be positive, and for the product basin, it must be negative.\n- Reactant threshold: $x_{\\mathcal{A}}^{\\mathrm{thr}} = x_{\\mathcal{A}}^{\\min} + \\sqrt{\\frac{2 \\Delta F}{U''(x_{\\mathcal{A}}^{\\min})}}$\n- Product threshold: $x_{\\mathcal{B}}^{\\mathrm{thr}} = x_{\\mathcal{B}}^{\\min} - \\sqrt{\\frac{2 \\Delta F}{U''(x_{\\mathcal{B}}^{\\min})}}$\nNote that since $x_{\\mathcal{A}}^{\\min}$ and $x_{\\mathcal{B}}^{\\min}$ are minima, $U''(x)$ is positive at these points, ensuring the arguments of the square roots are positive.\n\n### Step 3: Computing the Committor Probability\nThe committor $q(x)$ is the probability that a trajectory starting at $x$ will first reach the product basin (defined by $x \\ge x_{\\mathcal{B}}^{\\mathrm{thr}}$) before the reactant basin (defined by $x \\le x_{\\mathcal{A}}^{\\mathrm{thr}}$). For one-dimensional overdamped dynamics with constant diffusion, $q(x)$ satisfies the backward Kolmogorov equation:\n$$D \\frac{d^2q}{dx^2} - D \\beta U'(x) \\frac{dq}{dx} = 0$$\nwhere $D$ is the diffusion constant and $\\beta = 1/(k_B T)$ is the inverse temperature. Since $k_B T = 1$, we have $\\beta=1$. The constant $D$ cancels, yielding:\n$$\\frac{d^2q}{dx^2} - U'(x) \\frac{dq}{dx} = 0$$\nThis is a second-order ODE subject to the absorbing boundary conditions:\n- $q(x_{\\mathcal{A}}^{\\mathrm{thr}}) = 0$ (starting at the reactant boundary means it is not counted as a transition to product)\n- $q(x_{\\mathcal{B}}^{\\mathrm{thr}}) = 1$ (starting at the product boundary means success)\n\nThe general solution to this ODE is found by two successive integrations. Let $p(x) = dq/dx$. The ODE becomes $p' - U'p = 0$, with solution $p(x) = C_1 e^{U(x)}$. Integrating again gives $q(x) = C_1 \\int e^{U(y)} dy + C_2$. Applying the boundary conditions, we solve for the constants $C_1$ and $C_2$ to obtain the well-known formula for the 1D committor:\n$$q(x) = \\frac{\\displaystyle\\int_{x_{\\mathcal{A}}^{\\mathrm{thr}}}^{x} e^{\\beta U(y)} dy}{\\displaystyle\\int_{x_{\\mathcal{A}}^{\\mathrm{thr}}}^{x_{\\mathcal{B}}^{\\mathrm{thr}}} e^{\\beta U(y)} dy}$$\nWe need to evaluate this expression for $x = x^\\ddagger$. The integrals must be computed numerically. The term $e^{\\beta U(y)}$ can become very large, leading to numerical overflow. To ensure stability, we can subtract a constant from the potential in the exponent, as this does not change the ratio. A good choice is the maximum value of the potential in the integration range, which is approximately $U(x^\\ddagger)$.\n$$q(x) = \\frac{\\displaystyle\\int_{x_{\\mathcal{A}}^{\\mathrm{thr}}}^{x} e^{\\beta (U(y) - U(x^\\ddagger))} dy}{\\displaystyle\\int_{x_{\\mathcal{A}}^{\\mathrm{thr}}}^{x_{\\mathcal{B}}^{\\mathrm{thr}}} e^{\\beta (U(y) - U(x^\\ddagger))} dy}$$\n\n### Step 4: Assessing Robustness\nThe final step is to quantify the sensitivity of $q(x^\\ddagger)$ to the choice of $\\Delta F$.\n1.  Calculate the baseline value, $q_{\\text{base}}(x^\\ddagger)$, using the given $\\Delta F$ to determine the baseline thresholds $x_{\\mathcal{A}}^{\\mathrm{thr}}$ and $x_{\\mathcal{B}}^{\\mathrm{thr}}$.\n2.  For each fractional variation $\\delta$ provided, calculate two new sets of thresholds by replacing $\\Delta F$ with $\\Delta F' = \\Delta F(1+\\delta)$ and $\\Delta F'' = \\Delta F(1-\\delta)$.\n3.  Compute the corresponding perturbed committor values, $q_{+}(x^\\ddagger)$ and $q_{-}(x^\\ddagger)$.\n4.  The robustness metric, $\\Delta q_{\\max}$, is the maximum absolute deviation observed across all variations:\n    $$\\Delta q_{\\max} = \\max_{\\delta} \\left\\{ |q_{+}(x^\\ddagger) - q_{\\text{base}}(x^\\ddagger)|, \\; |q_{-}(x^\\ddagger) - q_{\\text{base}}(x^\\ddagger)| \\right\\}$$\n5.  The thresholds are deemed robust if $\\Delta q_{\\max} \\le \\tau$, where $\\tau$ is the specified tolerance.\n\nThis completes the derivation of the algorithm. The implementation will follow these steps for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, epsilon, beta, delta_F_base, deltas, tau)\n        (10.0, 0.0, 1.0, 1.0, (0.05, 0.10), 0.02),\n        (10.0, -2.0, 1.0, 1.0, (0.05, 0.10), 0.02),\n        (6.0, 1.5, 1.0, 0.6, (0.10, 0.20), 0.02)\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(*case)\n        all_results.append(result)\n\n    # Format the final output string as specified: [[...],[...],[...]]\n    inner_strings = []\n    for res in all_results:\n        # Convert all elements to string, including the boolean\n        str_res = [str(item) for item in res]\n        inner_strings.append(f\"[{','.join(str_res)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\ndef process_case(alpha, epsilon, beta, delta_F_base, deltas, tau):\n    \"\"\"\n    Processes a single test case according to the derived algorithm.\n    \"\"\"\n    # 1. Define potential and its derivatives\n    U = lambda x: alpha * (x**2 - 1)**2 + epsilon * x\n    U_prime = lambda x: 4 * alpha * (x**3 - x) + epsilon\n    U_double_prime = lambda x: 4 * alpha * (3 * x**2 - 1)\n\n    # 2. Find and classify stationary points\n    # Roots of 4*alpha*x^3 - 4*alpha*x + epsilon = 0\n    coeffs = [4 * alpha, 0, -4 * alpha, epsilon]\n    stat_points = np.roots(coeffs)\n    # Filter for real roots and sort them\n    real_stat_points = sorted([p.real for p in stat_points if np.isclose(p.imag, 0)])\n\n    # For a double-well potential, the sorted roots correspond to:\n    # minimum, maximum, minimum.\n    x_A_min, x_ddagger, x_B_min = real_stat_points[0], real_stat_points[1], real_stat_points[2]\n    \n    # Pre-calculate second derivatives at minima\n    U_pp_A = U_double_prime(x_A_min)\n    U_pp_B = U_double_prime(x_B_min)\n\n    # 3. Define helper functions for thresholds and committor\n    def calculate_thresholds(df):\n        \"\"\"Calculates basin thresholds for a given delta_F.\"\"\"\n        x_A_thr = x_A_min + np.sqrt(2 * df / U_pp_A)\n        x_B_thr = x_B_min - np.sqrt(2 * df / U_pp_B)\n        return x_A_thr, x_B_thr\n\n    # To improve numerical stability of integration, subtract a constant from the potential in the exponent.\n    # The max value of U(x) in the integration interval is approximately U(x_ddagger).\n    U_offset = U(x_ddagger)\n    stable_integrand = lambda y: np.exp(beta * (U(y) - U_offset))\n    \n    def calculate_committor(x, x_A_thr, x_B_thr):\n        \"\"\"Calculates the committor q(x) for given thresholds.\"\"\"\n        numerator, _ = quad(stable_integrand, x_A_thr, x)\n        denominator, _ = quad(stable_integrand, x_A_thr, x_B_thr)\n        \n        if denominator == 0:\n            # This case shouldn't happen with valid thresholds, but is a safeguard.\n            return np.nan\n        return numerator / denominator\n\n    # 4. Perform baseline calculation\n    x_A_thr_base, x_B_thr_base = calculate_thresholds(delta_F_base)\n    q_base = calculate_committor(x_ddagger, x_A_thr_base, x_B_thr_base)\n\n    # 5. Perform robustness analysis\n    deviations = []\n    for d in deltas:\n        # Case 1: delta_F' = delta_F * (1 + delta)\n        delta_F_p = delta_F_base * (1 + d)\n        x_A_thr_p, x_B_thr_p = calculate_thresholds(delta_F_p)\n        q_p = calculate_committor(x_ddagger, x_A_thr_p, x_B_thr_p)\n        deviations.append(abs(q_p - q_base))\n        \n        # Case 2: delta_F'' = delta_F * (1 - delta)\n        delta_F_m = delta_F_base * (1 - d)\n        x_A_thr_m, x_B_thr_m = calculate_thresholds(delta_F_m)\n        q_m = calculate_committor(x_ddagger, x_A_thr_m, x_B_thr_m)\n        deviations.append(abs(q_m - q_base))\n\n    delta_q_max = max(deviations) if deviations else 0.0\n    is_robust = delta_q_max <= tau\n    \n    return [x_A_thr_base, x_B_thr_base, q_base, delta_q_max, is_robust]\n\nsolve()\n```"
        }
    ]
}