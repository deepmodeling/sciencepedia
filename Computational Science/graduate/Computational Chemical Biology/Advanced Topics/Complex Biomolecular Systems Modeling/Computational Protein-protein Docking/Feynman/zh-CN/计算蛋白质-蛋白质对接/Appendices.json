{
    "hands_on_practices": [
        {
            "introduction": "计算对接不仅仅是将两个刚性蛋白质放在一起。高分辨率的预测需要对局部结构进行精细调整，特别是界面处柔性侧链的构象。本练习  模拟了一个关键的“重排-最小化”（repack-minimize）循环，让您亲身体验计算方法如何通过优化侧链构象来寻找能量上最有利的排列方式。",
            "id": "3839941",
            "problem": "您正在计算蛋白质-蛋白质对接的局部精修阶段对蛋白质-蛋白质界面进行建模。该方案使用依赖于主链的旋转异构体库进行离散的侧链重排，然后进行有限的基于梯度的能量最小化。考虑一个简化为两个相互作用残基对的界面：伴侣P上的一个精氨酸与伴侣Q上的一个天冬氨酸接触（将此对表示为 P1–Q1），以及伴侣P上的一个酪氨酸与伴侣Q上的一个苯丙氨酸接触（将此对表示为 P2–Q2）。在当前的主链几何结构下，P1–Q2 和 P2–Q1 之间的交叉相互作用可以忽略不计。\n\n假设以下基本条件：\n- 总势能近似为残基自身能量（残基内加上主链兼容性）与跨界面的成对残基间相互作用能量之和，这与包含静电、范德华（Lennard-Jones）项和氢键的标准物理动机附加力场一致。设总能量为这些给定项的总和，不含额外的耦合。\n- 残基-残基接触定义为界面上至少存在一对重原子，其间距小于或等于 $4.0 \\,\\text{\\AA}$ 的阈值。\n- 给定了初始的旋转异构体分配，重排步骤在给定的旋转异构体中搜索以最小化总能量。随后的局部最小化仅将特定成对相互作用能量中包含的正排斥分量减少一个因子 $\\alpha = 0.5$，所有其他项保持不变，这反映了一种小的弛豫，旨在缓解空间重叠同时保持定性的几何结构。\n\n对于 P1–Q1（精氨酸-天冬氨酸），每个残基有 $2$ 个旋转异构体：P1 有 $r \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{P1}}(1) = 0.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{P1}}(2) = 0.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$；Q1 有 $s \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{Q1}}(1) = 0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{Q1}}(2) = 0.8 \\,\\text{kcal}\\,\\text{mol}^{-1}$。成对相互作用能量（包括静电、适用时的氢键几何以及范德华力）和最小重原子距离如下：\n- $(r,s) = (1,1)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(1,1) = -3.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,1) = 2.7 \\,\\text{\\AA}$；此净能量包含因近距离接触产生的 $+0.6 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 的小排斥分量。\n- $(r,s) = (1,2)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(1,2) = -1.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,2) = 3.8 \\,\\text{\\AA}$；排斥可忽略。\n- $(r,s) = (2,1)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(2,1) = -0.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,1) = 3.6 \\,\\text{\\AA}$；排斥可忽略。\n- $(r,s) = (2,2)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(2,2) = -2.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,2) = 3.0 \\,\\text{\\AA}$；此净能量包含 $+0.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 的小排斥分量。\n\n对于 P2–Q2（酪氨酸-苯丙氨酸），每个残基有 $2$ 个旋转异构体：P2 有 $t \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{P2}}(1) = 0.4 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{P2}}(2) = 0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$；Q2 有 $u \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{Q2}}(1) = 0.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{Q2}}(2) = 0.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$。成对相互作用能量和最小距离如下：\n- $(t,u) = (1,1)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(1,1) = -1.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,1) = 3.5 \\,\\text{\\AA}$；排斥可忽略。\n- $(t,u) = (1,2)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(1,2) = -0.6 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,2) = 4.2 \\,\\text{\\AA}$；无接触。\n- $(t,u) = (2,1)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(2,1) = -0.7 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,1) = 4.0 \\,\\text{\\AA}$；接触阈值。\n- $(t,u) = (2,2)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(2,2) = -1.4 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,2) = 3.6 \\,\\text{\\AA}$；此净能量包含 $+0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 的小排斥分量。\n\n假设交叉对相互作用 P1–Q2 和 P2–Q1 为 $0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 且不产生接触。初始旋转异构体为 P1 $r=2$，Q1 $s=1$，P2 $t=1$，Q2 $u=2$。\n\n任务：\n- 使用附加模型，计算初始状态的总能量，然后独立确定每个对在侧链重排后能量最低的旋转异构体，并计算新的总能量。使用 $4.0 \\,\\text{\\AA}$ 阈值，确定重排前后的界面接触集（哪些残基对处于接触状态）。\n- 对选定的旋转异构体对，应用局部最小化规则，将识别出的正排斥分量乘以因子 $\\alpha = 0.5$，重新计算总能量，并说明接触集是否发生变化。\n- 基于迭代式重排-最小化循环的第一性原理，选择最能描述接触模式演变并提供基于能量景观优化和界面接触图稳定性的严格收敛标准的选项。\n\n哪个选项与这些计算和原理最一致？\n\nA. 重排后，P1–Q1 保持接触，P2–Q2 成为新的接触；最小化后，接触集不变。当总能量变化幅值满足 $\\lvert \\Delta E \\rvert  0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 且接触图与前一次迭代的 Jaccard 指数 $J = 1$ 至少连续 2 个重排-最小化循环，并且侧链二面角的能量梯度最大范数低于 $10^{-3} \\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{rad}^{-1}$ 时，达到收敛。\n\nB. 重排后，相对于初始状态，接触不变，因为成对能量不能克服自身能量；最小化引入了一个新的 P1–Q2 接触。当单次迭代中总能量的绝对变化低于 $1.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 时收敛，无论接触是否变化。\n\nC. 重排后，由于排斥弛豫，P1–Q1 接触丢失，但 P2–Q2 仍不接触；最小化后，两对都成为接触。当迭代间的侧链均方根偏差（RMSD）低于 $2.0 \\,\\text{\\AA}$ 时收敛，即使能量仍在下降且接触仍在变化。\n\nD. 重排后，P1–Q1 转变为非接触几何构型，而 P2–Q2 仍不接触；最小化后，P2–Q2 成为唯一的接触。当氢键数量在 1 次迭代中不再增加时收敛，无论总能量和非键接触如何。",
            "solution": "问题陈述是一个有效且定义明确的计算蛋白质-蛋白质对接练习。它提供了一个简化但有科学依据的重排-最小化循环模型，包含了所有必要的数据和清晰的计算规则。该问题是自洽、一致且客观的。\n\n解决方案分三个阶段进行：\n1.  初始状态分析。\n2.  侧链重排后状态分析。\n3.  局部能量最小化后状态分析。\n最后，基于这些结果和能量景观优化原理对每个选项进行评估。\n\n系统的总能量 $E_{\\text{total}}$ 是四个残基的自身能量与两个非共价相互作用对 P1–Q1 和 P2–Q2 的成对相互作用能量之和。\n$$E_{\\text{total}} = E_{\\text{self}}^{\\text{P1}}(r) + E_{\\text{self}}^{\\text{Q1}}(s) + E_{\\text{self}}^{\\text{P2}}(t) + E_{\\text{self}}^{\\text{Q2}}(u) + E_{\\text{pair}}^{\\text{P1-Q1}}(r,s) + E_{\\text{pair}}^{\\text{P2-Q2}}(t,u)$$\n如果最小重原子距离 $d_{\\min}$ 小于或等于 $4.0 \\,\\text{\\AA}$，则一对残基-残基处于接触状态。\n\n**1. 初始状态分析**\n\n初始旋转异构体给定为 P1($r=2$), Q1($s=1$), P2($t=1$), 和 Q2($u=2$)。\n\n初始总能量 $E_{\\text{init}}$ 为：\n$$E_{\\text{init}} = E_{\\text{self}}^{\\text{P1}}(2) + E_{\\text{self}}^{\\text{Q1}}(1) + E_{\\text{self}}^{\\text{P2}}(1) + E_{\\text{self}}^{\\text{Q2}}(2) + E_{\\text{pair}}^{\\text{P1-Q1}}(2,1) + E_{\\text{pair}}^{\\text{P2-Q2}}(1,2)$$\n代入给定值：\n$$E_{\\text{init}} = (0.2 + 0.3 + 0.4 + 0.2) + (-0.5) + (-0.6) \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n$$E_{\\text{init}} = 1.1 - 1.1 = 0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n\n初始接触集由所选旋转异构体对的最小距离确定：\n- 对于 P1–Q1，旋转异构体对为 $(r,s)=(2,1)$，其 $d_{\\min}(2,1) = 3.6 \\,\\text{\\AA}$。由于 $3.6 \\le 4.0$，P1–Q1 处于接触状态。\n- 对于 P2–Q2，旋转异构体对为 $(t,u)=(1,2)$，其 $d_{\\min}(1,2) = 4.2 \\,\\text{\\AA}$。由于 $4.2  4.0$，P2–Q2 不处于接触状态。\n初始接触集为 {P1–Q1}。\n\n**2. 侧链重排分析**\n\n侧链重排旨在找到使总能量最小化的旋转异构体组合。由于 P1–Q1 和 P2–Q2 这两对在能量上是独立的（交叉相互作用为零），我们可以分别对每一对的能量进行最小化。\n\n对于 P1–Q1 对（精氨酸-天冬氨酸）：\n每个旋转异构体组合 $(r,s)$ 的能量为 $E^{\\text{P1-Q1}}(r,s) = E_{\\text{self}}^{\\text{P1}}(r) + E_{\\text{self}}^{\\text{Q1}}(s) + E_{\\text{pair}}^{\\text{P1-Q1}}(r,s)$。\n- $E(1,1) = 0.5 + 0.3 + (-3.5) = -2.7 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(1,2) = 0.5 + 0.8 + (-1.0) = 0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,1) = 0.2 + 0.3 + (-0.5) = 0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,2) = 0.2 + 0.8 + (-2.2) = -1.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$\nP1–Q1 对的最小能量为 $-2.7 \\,\\text{kcal}\\,\\text{mol}^{-1}$，对应于旋转异构体 $(r,s)=(1,1)$。\n\n对于 P2–Q2 对（酪氨酸-苯丙氨酸）：\n每个旋转异构体组合 $(t,u)$ 的能量为 $E^{\\text{P2-Q2}}(t,u) = E_{\\text{self}}^{\\text{P2}}(t) + E_{\\text{self}}^{\\text{Q2}}(u) + E_{\\text{pair}}^{\\text{P2-Q2}}(t,u)$。\n- $E(1,1) = 0.4 + 0.5 + (-1.2) = -0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(1,2) = 0.4 + 0.2 + (-0.6) = 0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,1) = 0.1 + 0.5 + (-0.7) = -0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,2) = 0.1 + 0.2 + (-1.4) = -1.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$\nP2–Q2 对的最小能量为 $-1.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$，对应于旋转异构体 $(t,u)=(2,2)$。\n\n重排后的总能量 $E_{\\text{repack}}$ 是每对最小能量的总和：\n$$E_{\\text{repack}} = -2.7 + (-1.1) = -3.8 \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n\n重排后的接触集由新的最优旋转异构体确定：\n- 对于 P1–Q1，新的对为 $(r,s)=(1,1)$，其 $d_{\\min}(1,1) = 2.7 \\,\\text{\\AA}$。由于 $2.7 \\le 4.0$，P1–Q1 保持接触。\n- 对于 P2–Q2，新的对为 $(t,u)=(2,2)$，其 $d_{\\min}(2,2) = 3.6 \\,\\text{\\AA}$。由于 $3.6 \\le 4.0$，P2–Q2 成为一个接触。\n重排后的接触集是 {P1–Q1, P2–Q2}。相对于初始状态，P1–Q1 保持接触，而 P2–Q2 成为一个新的接触。\n\n**3. 能量最小化分析**\n\n此步骤应用于重排后找到的状态：旋转异构体 P1-Q1: $(1,1)$ 和 P2-Q2: $(2,2)$。规则是将任何正的排斥能量分量减少一个因子 $\\alpha=0.5$。总能量将减少 $(1-\\alpha)$ 倍的排斥能量。\n\n对于状态为 $(1,1)$ 的 P1–Q1 对，给定的排斥能量为 $E_{\\text{rep}} = +0.6 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n能量减少量为 $\\Delta E_{\\text{min,1}} = -(1-\\alpha) \\times E_{\\text{rep}} = -(1-0.5) \\times 0.6 = -0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n\n对于状态为 $(2,2)$ 的 P2–Q2 对，给定的排斥能量为 $E_{\\text{rep}} = +0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n能量减少量为 $\\Delta E_{\\text{min,2}} = -(1-\\alpha) \\times E_{\\text{rep}} = -(1-0.5) \\times 0.1 = -0.05 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n\n最小化后的总能量 $E_{\\text{final}}$ 为：\n$$E_{\\text{final}} = E_{\\text{repack}} + \\Delta E_{\\text{min,1}} + \\Delta E_{\\text{min,2}}$$\n$$E_{\\text{final}} = -3.8 - 0.3 - 0.05 = -4.15 \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n\n问题陈述中提到，最小化是“小的弛豫……保持定性的几何结构”，这意味着旋转异构体的身份和最小距离，因此接触集，在此步骤中不发生改变。\n最小化后的接触集是 {P1–Q1, P2–Q2}，与重排后的状态相比没有变化。\n\n**结果总结与选项评估**\n\n- **重排**：P1–Q1 保持接触，P2–Q2 成为接触。\n- **最小化**：接触集保持为 {P1–Q1, P2–Q2}。\n\n我们现在评估这些选项：\n\n**A. 重排后，P1–Q1 保持接触，P2–Q2 成为新的接触；最小化后，接触集不变。当总能量变化幅值满足 $\\lvert \\Delta E \\rvert  0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 且接触图与前一次迭代的 Jaccard 指数 $J = 1$ 至少连续 2 个重排-最小化循环，并且侧链二面角的能量梯度最大范数低于 $10^{-3} \\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{rad}^{-1}$ 时，达到收敛。**\n这个陈述的第一部分与我们的计算结果完全匹配。第二部分描述了一个稳健的、多方面的收敛标准，这是该领域的标准做法。它要求能量的稳定性（$\\lvert \\Delta E \\rvert$）、结构的稳定性（接触图 Jaccard 指数 $J=1$ 连续两个循环）以及达到局部能量最小值（低梯度范数）。这是一套全面且科学合理的标准。\n**结论：正确**\n\n**B. 重排后，相对于初始状态，接触不变，因为成对能量不能克服自身能量；最小化引入了一个新的 P1–Q2 接触。**\n第一个论断“接触不变”是错误的；P2-Q2 成为一个接触。其推理也是错误的；有利的成对能量确实克服了不太有利的自身能量。第二个论断“最小化引入了一个新的 P1–Q2 接触”是错误的，因为在此模型中最小化不改变接触集，且 P1-Q2 相互作用可忽略。仅基于一个宽松的能量阈值（$\\lvert \\Delta E \\rvert  1.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$）的收敛标准是不充分的。\n**结论：错误**\n\n**C. 重排后，由于排斥弛豫，P1–Q1 接触丢失，但 P2–Q2 仍不接触；最小化后，两对都成为接触。**\n“P1–Q1 接触丢失”的说法是错误的。“P2–Q2 仍不接触”的说法是错误的。“最小化后，两对都成为接触”的说法是错误的，因为它们在重排后已经是接触了。基于 RMSD 的收敛标准过于宽松（$2.0 \\,\\text{\\AA}$）并且不恰当地忽略了能量。\n**结论：错误**\n\n**D. 重排后，P1–Q1 转变为非接触几何构型，而 P2–Q2 仍不接触；最小化后，P2–Q2 成为唯一的接触。**\n关于重排后状态的两个说法都是错误的。关于最小化后接触集的说法是错误的。仅基于氢键的收敛标准过于简单，忽略了其他关键的能量项和整体结构稳定性。\n**结论：错误**\n\n唯一与计算结果一致并提出一套科学严谨原则的选项是 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "对接算法通常会生成许多候选构象。在处理对称蛋白质时，您可能会发现多个由对称性关联、看起来完全相同的构象，它们具有相同的能量。本练习  挑战您超越简单的能量评分，运用统计力学的基本原理来正确处理这种简并性，从而计算出更准确的自由能并对不同的结合模式进行合理排序。",
            "id": "3839949",
            "problem": "在计算蛋白质-蛋白质对接中，将配体刚性对接到对称受体上时，对称性会产生多个对称相关且因此能量简并的构象。假设一个环状三聚体受体（$C_3$ 对称性）与一个单体配体进行对接，使用一个基于能量的打分函数 $E(\\mathbf{R})$ 来近似计算取向 $\\mathbf{R}$ 的相互作用能。搜索过程产生了两种不同的结合模式（两种化学上不同的界面微观状态），分别表示为模式 $A$ 和模式 $B$。由于受体的对称性，每种独特的微观状态可能会以几种对称相关的构象出现，这些构象具有无法区分的界面几何形状和相同的分数（最多有微小的数值噪声）。对于一次特定的对接运行：\n- 模式 $A$ 以 $g_A$ 个对称相关的构象出现，每个构象报告的能量相同，为 $E_A = -9.5$ $\\mathrm{kcal\\,mol^{-1}}$，简并度 $g_A = 3$。\n- 模式 $B$ 以 $g_B$ 个对称相关的构象出现，每个构象报告的能量相同，为 $E_B = -10.0$ $\\mathrm{kcal\\,mol^{-1}}$，简并度 $g_B = 1$。\n假设温度 $T = 300$ $\\mathrm{K}$，玻尔兹曼常数 $k_B = 1.987\\times 10^{-3}$ $\\mathrm{kcal\\,mol^{-1}\\,K^{-1}}$。你希望 (i) 正确地将对称相关的构象聚合为与统计力学一致的每个模式的分数，以便排名能反映考虑了简并度的有效结合自由能，以及 (ii) 提出一个有原则的策略来进一步消除近简并模式的歧义，同时不重复计算对称相关的构象。\n哪个选项最好地实现了这两个目标？\n\nA. 按单个最有利构象的能量对模式进行排名，即每个模式 $i$ 内的 $\\min_j E_{ij}$，忽略简并度；如果需要，通过对称相关构象的数量 $g_i$ 来打破平局。\n\nB. 按每个模式中对称相关构象的算术平均能量对模式进行排名，即 $\\bar{E}_i = \\frac{1}{g_i}\\sum_{j=1}^{g_i} E_{ij}$。因为 $E_{ij}$ 是相同的，这等于 $E_i$；为消除歧义，优先选择具有较大 $g_i$ 的模式。\n\nC. 使用与玻尔兹曼一致的对数-求和-指数自由能 $F_i = -k_B T \\ln \\sum_{j=1}^{g_i} \\exp(-\\beta E_{ij})$ 来聚合每个模式 $i$ 内的对称相关构象，其中 $\\beta = 1/(k_B T)$。当 $E_{ij}$ 相等时，这简化为 $F_i = E_i - k_B T \\ln g_i$。使用给定的 $T = 300$ $\\mathrm{K}$ 和 $k_B$，数值计算得出 $F_A \\approx -10.16$ $\\mathrm{kcal\\,mol^{-1}}$ 和 $F_B \\approx -10.00$ $\\mathrm{kcal\\,mol^{-1}}$，因此模式 $A$ 更优。为了在对称性或数值噪声导致微小能量差异时进一步消除歧义，首先将诱饵构象分组到对称等价类（轨道）中，然后通过附加的约束能量 $E_{\\mathrm{rest}}(\\text{pose}) = -k_B T \\ln p(\\text{data}\\mid \\text{pose})$（或等效地，贝叶斯重加权）在进行相同的聚合之前，引入弱实验先验（例如，界面突变约束或低分辨率图谱）。\n\nD. 通过将能量乘以简并度来奖励简并度，$E_i' = g_i\\,E_i$，因此模式 $A$ 变为 $E_A' = 3\\times (-9.5) = -28.5$ $\\mathrm{kcal\\,mol^{-1}}$，这是更优的；通过选择最大的 $g_i$ 来消除歧义，即使模式内的 $E_i$ 有所不同。\n\nE. 通过从每个模式采样的诱饵构象数量 $n_i$ 进行簇大小加权来近似自由能，$F_i \\approx -k_B T \\ln n_i + \\min_j E_{ij}$，不进行显式对称性处理；通过将具有更多诱饵构象的模式排名为更稳定来消除歧义。",
            "solution": "### 解题推导\n\n主要目标是比较两种结合模式 $A$ 和 $B$ 的稳定性。在统计力学中，不同状态在恒定温度下的相对稳定性由它们的亥姆霍兹自由能 $F$ 决定。较低的自由能对应于更稳定、因此更可能的状态。\n\n一个结合“模式”是由一个或多个微观状态（构象）组成的宏观状态。宏观状态 $i$ 的自由能与其配分函数 $Z_i$ 通过以下方程相关联：\n$$F_i = -k_B T \\ln Z_i$$\n配分函数 $Z_i$ 是属于该宏观状态的所有微观状态 $j$ 的玻尔兹曼因子的总和：\n$$Z_i = \\sum_{j=1}^{g_i} \\exp\\left(-\\frac{E_{ij}}{k_B T}\\right) = \\sum_{j=1}^{g_i} \\exp(-\\beta E_{ij})$$\n其中 $g_i$ 是模式 $i$ 中的构象数（简并度），$E_{ij}$ 是模式 $i$ 中构象 $j$ 的能量，$\\beta = 1/(k_B T)$。\n\n问题陈述指出，对于给定模式，所有对称相关的构象具有相同的能量。因此，对于模式 $i$，$E_{ij} = E_i$ 对所有 $j = 1, \\dots, g_i$。模式 $i$ 的配分函数简化为：\n$$Z_i = \\sum_{j=1}^{g_i} \\exp(-\\beta E_i) = g_i \\exp(-\\beta E_i)$$\n将此代入自由能方程：\n$$F_i = -k_B T \\ln\\left(g_i \\exp(-\\beta E_i)\\right)$$\n$$F_i = -k_B T \\left(\\ln g_i + \\ln(\\exp(-\\beta E_i))\\right)$$\n$$F_i = -k_B T \\left(\\ln g_i - \\beta E_i\\right)$$\n$$F_i = -k_B T \\ln g_i + k_B T \\beta E_i$$\n由于 $k_B T \\beta = 1$，模式 $i$ 的自由能最终表达式为：\n$$F_i = E_i - k_B T \\ln g_i$$\n这个方程正确地结合了焓贡献（$E_i$）和熵贡献（$-T S_i$，其中来自简并度的熵为 $S_i = k_B \\ln g_i$）。自由能较低的模式是更优的模式。\n\n现在，让我们使用给定值计算模式 $A$ 和 $B$ 的自由能。\n首先，计算热能项 $k_B T$：\n$$k_B T = (1.987 \\times 10^{-3} \\, \\mathrm{kcal\\,mol^{-1}\\,K^{-1}}) \\times (300 \\, \\mathrm{K}) = 0.5961 \\, \\mathrm{kcal\\,mol^{-1}}$$\n\n对于 **模式 A**：\n-   $E_A = -9.5 \\, \\mathrm{kcal\\,mol^{-1}}$\n-   $g_A = 3$\n-   $F_A = E_A - k_B T \\ln g_A = -9.5 - (0.5961) \\ln(3)$\n-   使用 $\\ln(3) \\approx 1.0986$：\n-   $F_A \\approx -9.5 - (0.5961 \\times 1.0986) \\approx -9.5 - 0.6545 = -10.1545 \\, \\mathrm{kcal\\,mol^{-1}}$\n\n对于 **模式 B**：\n-   $E_B = -10.0 \\, \\mathrm{kcal\\,mol^{-1}}$\n-   $g_B = 1$\n-   $F_B = E_B - k_B T \\ln g_B = -10.0 - (0.5961) \\ln(1)$\n-   由于 $\\ln(1) = 0$：\n-   $F_B = -10.0 - 0 = -10.0 \\, \\mathrm{kcal\\,mol^{-1}}$\n\n比较自由能，$F_A \\approx -10.16 \\, \\mathrm{kcal\\,mol^{-1}}$ 和 $F_B = -10.0 \\, \\mathrm{kcal\\,mol^{-1}}$。由于 $F_A  F_B$，模式 $A$ 在热力学上比模式 $B$ 更有利，尽管其相互作用能较差（$E_A > E_B$）。模式 $A$ 的较高简并度（熵）使其稳定化。\n\n对于目标 (ii)，一个有原则的策略来消除近简并模式的歧义必须正确处理对称性并以物理上合理的方式整合额外信息。\n1.  **处理对称性**：第一步必须是识别所有对称相关的构象并将其分组到各自的等价类（或轨道）中。这可以防止重复计数，因为这些构象不是独立的，而是单个结合微观状态的表现形式。\n2.  **整合外部信息**：如果计算出的自由能非常接近，可以使用外部实验数据（例如，突变数据、交联、核磁共振位移、低分辨率电镜图谱）作为先验。一种严谨的方法是通过贝叶斯框架。给定数据下构象的概率 $p(\\text{pose}|\\text{data})$ 与给定构象下数据的似然 $p(\\text{data}|\\text{pose})$ 乘以构象的先验概率 $p(\\text{pose})$ 成正比。先验由玻尔兹曼分布给出，$p(\\text{pose}) \\propto \\exp(-\\beta E_{\\text{pose}})$。这可以表述为向原始能量添加一个约束能量项 $E_{\\text{rest}}$：\n    $$E'_{\\text{pose}} = E_{\\text{pose}} + E_{\\text{rest}}(\\text{pose})$$\n    其中约束能量定义为 $E_{\\text{rest}}(\\text{pose}) = -k_B T \\ln p(\\text{data}|\\text{pose})$。该项惩罚与实验数据不一致的构象。然后可以使用玻尔兹曼加权和对新能量 $E'_{ij}$ 求和，重新计算每个模式的新自由能。\n\n### 逐项分析选项\n\n**A. 按单个最有利构象的能量对模式进行排名……忽略简并度；如果需要，通过对称相关构象的数量 $g_i$ 来打破平局。**\n此方法会将模式 $B$（能量 $E_B = -10.0 \\, \\mathrm{kcal\\,mol^{-1}}$）排在模式 $A$（能量 $E_A = -9.5 \\, \\mathrm{kcal\\,mol^{-1}}$）之前。这在根本上是错误的，因为它忽略了来自简并度的熵贡献，而这对于确定热力学稳定性至关重要。打破平局的规则是一种特设的启发式方法，而不是统计力学的定量应用。\n**结论：错误。**\n\n**B. 按每个模式中对称相关构象的算術平均能量对模式进行排名……因为 $E_{ij}$ 是相同的，这等于 $E_i$；为消除歧义，优先选择具有较大 $g_i$ 的模式。**\n在能量相同的构象模式中，能量的算术平均值就是任意一个构象的能量 $E_i$。此方法在功能上与选项 A 相同，并有相同的缺陷：它忽略了熵对简并度的对数依赖关系。打破平局的方法同样是一种定性的、不严谨的启发式方法。\n**结论：错误。**\n\n**C. 使用与玻尔兹曼一致的对数-求和-指数自由能 $F_i = -k_B T \\ln \\sum_{j=1}^{g_i} \\exp(-\\beta E_{ij})$ 来聚合每个模式 $i$ 内的对称相关构象，当 $E_{ij}$ 相等时，这简化为 $F_i = E_i - k_B T \\ln g_i$。使用给定的 $T = 300 \\, \\mathrm{K}$ 和 $k_B$，数值计算得出 $F_A \\approx -10.16 \\, \\mathrm{kcal\\,mol^{-1}}$ 和 $F_B \\approx -10.00 \\, \\mathrm{kcal\\,mol^{-1}}$，因此模式 $A$ 更优。为了进一步消除歧义……首先将诱饵构象分组到对称等价类（轨道）中，然后通过附加的约束能量 $E_{\\mathrm{rest}}(\\text{pose}) = -k_B T \\ln p(\\text{data}\\mid \\text{pose})$（或等效地，贝叶斯重加权）在进行相同的聚合之前，引入弱实验先验……**\n该选项正确地将自由能 $F_i$ 确定为对模式进行排名的正确热力学量。提供的公式 $F_i = -k_B T \\ln \\sum_j \\exp(-\\beta E_{ij})$ 是根据配分函数定义的自由能，其对简并态简化为 $F_i = E_i - k_B T \\ln g_i$ 是正确的。数值计算（$F_A \\approx -10.16 \\, \\mathrm{kcal\\,mol^{-1}}$，$F_B = -10.0 \\, \\mathrm{kcal\\,mol^{-1}}$）以及由此得出的对模式 $A$ 的偏好与我的推导相符。所提出的消除歧义的策略也是有原则的：它正确地认识到需要首先按对称性分组，然后通过理论上合理的贝叶斯/约束形式体系使用实验数据。该选项正确满足了目标 (i) 和 (ii)。\n**结论：正确。**\n\n**D. 通过将能量乘以简并度来奖励简并度，$E_i' = g_i\\,E_i$，因此模式 $A$ 变为 $E_A' = 3\\times (-9.5) = -28.5 \\, \\mathrm{kcal\\,mol^{-1}}$，这是更优的……**\n这种方法没有物理依据。将能量乘以一个无量纲的简并度计数（$g_i E_i$）是一个任意的数学操作，不是一个用于比较稳定性的有效物理量。它在统计力学中没有基础。对自由能的熵项贡献是对数关系（$k_B T \\ln g_i$），而不是线性关系。\n**结论：错误。**\n\n**E. 通过从每个模式采样的诱饵构象数量 $n_i$ 进行簇大小加权来近似自由能，$F_i \\approx -k_B T \\ln n_i + \\min_j E_{ij}$，不进行显式对称性处理……**\n这个公式常用于通过将簇中的构象数（$n_i$）作为构象熵的代理来近似对接中的自由能。然而，这个问题处理的是由于几何对称性产生的精确简并度（$g_i$），而不是来自有限对接模拟的统计布居数（$n_i$）。将这两者混为一谈是一个概念性错误。来自对称性的熵项精确地是 $k_B \\ln g_i$。此外，“不进行显式对称性处理”的建议直接与问题的核心相矛盾，问题的核心恰恰是如何*正确*处理对称性。\n**结论：错误。**",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "一个评分函数的优劣取决于其区分正确（近天然）构象与不正确（诱饵）构象的能力。我们如何量化这一性能？本练习  将指导您实现标准的验证指标——受试者工作特征（ROC）曲线和精确率-召回率（PR）曲线，为您提供评估和基准测试任何对接评分函数的基本工具。",
            "id": "3839980",
            "problem": "给定一个实值对接打分函数，该函数为每个蛋白质-蛋白质构象分配一个标量分数，以及一个二元标签，用于指示该构象是近天然构象（$1$）还是诱饵构象（$0$）。请仅使用二元分类的基本定义，推导出作为分数阈值函数的受试者工作特征（ROC）曲线和精确率-召回率（PR）曲线，并使用离散梯形积分计算它们的曲线下面积。实现一个完整的程序，对于测试套件中提供的每个数据集，计算ROC曲线下面积（ROC-AUC）和PR曲线下面积（PR-AUC），并将两者都四舍五入到$6$位小数。\n\n基本原理和推导目标：\n- 将对接打分函数视为对构象的单调排序，其中较高的分数表示其为近天然构象的可信度更高。对于任意阈值 $t$，通过以下规则定义预测类别 $\\hat{y}$：如果分数 $s \\ge t$，则 $\\hat{y} = 1$，否则 $\\hat{y} = 0$。\n- 对于固定的阈值 $t$ 和标签为 $y \\in \\{0,1\\}$ 的数据集，定义计数：真阳性 $\\mathrm{TP}(t)$、假阳性 $\\mathrm{FP}(t)$、真阴性 $\\mathrm{TN}(t)$、假阴性 $\\mathrm{FN}(t)$。令正例总数为 $P = \\sum_i y_i$，负例总数为 $N = \\sum_i (1 - y_i)$，且 $P \\ge 1$，$N \\ge 1$。\n- 定义真阳性率（TPR）$=\\mathrm{TP}(t)/P$，假阳性率（FPR）$=\\mathrm{FP}(t)/N$，精确率（Precision）$=\\mathrm{TP}(t)/(\\mathrm{TP}(t)+\\mathrm{FP}(t))$（约定当 $\\mathrm{TP}(t)+\\mathrm{FP}(t)=0$ 时，精确率为 $1$），以及召回率（Recall）$=\\mathrm{TP}(t)/P$。\n- ROC曲线是当 $t$ 从 $+\\infty$ 扫描到 $-\\infty$ 期间遍历所有唯一分数水平时，点集 $(\\mathrm{FPR}(t), \\mathrm{TPR}(t))$ 的集合，包括端点 $(0,0)$ 和 $(1,1)$。PR曲线是在相同扫描范围内点集 $(\\mathrm{Recall}(t), \\mathrm{Precision}(t))$ 的集合，包括端点 $(0,1)$ 和 $(1,\\mathrm{TP}(t_{\\min})/(\\mathrm{TP}(t_{\\min})+\\mathrm{FP}(t_{\\min})))$，其中 $t_{\\min}$ 低于最低分数，使得所有样本都被预测为正例。\n- 每条曲线下的面积通过对有序曲线点进行离散梯形积分来定义：对于一个有序点序列 $(x_k, y_k)$，其中 $k = 0,1,\\dots,K$，面积为 $\\sum_{k=0}^{K-1} \\frac{(x_{k+1}-x_k)}{2}\\,(y_{k+1}+y_k)$。\n\n程序要求：\n- 对于测试套件中的每个测试用例，使用上述定义计算ROC-AUC和PR-AUC。通过在按降序排序的唯一分数值上设置阈值来构建离散的ROC和PR曲线，并对相同分数值进行分组，以便仅在分数值变化时才添加点。确保ROC曲线包含初始点 $(0,0)$，PR曲线包含初始点 $(0,1)$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，该列表必须按顺序包含ROC-AUC和PR-AUC，两者均四舍五入到$6$位小数。例如，对于 $M$ 个测试用例，输出列表将有 $2M$ 个条目：$[\\mathrm{ROC}\\text{-}\\mathrm{AUC}_1,\\mathrm{PR}\\text{-}\\mathrm{AUC}_1,\\dots,\\mathrm{ROC}\\text{-}\\mathrm{AUC}_M,\\mathrm{PR}\\text{-}\\mathrm{AUC}_M]$。\n\n测试套件：\n- 案例 $1$（平衡，近乎完美分离）：\n  - 分数：$[0.95, 0.92, 0.88, 0.85, 0.83, 0.80, 0.45, 0.40, 0.35, 0.30, 0.25, 0.15]$\n  - 标签：$[1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0]$\n- 案例 $2$（分离效果差，存在许多高分诱饵构象）：\n  - 分数：$[0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45]$\n  - 标签：$[0, 0, 0, 0, 0, 1, 1, 1, 0, 1]$\n- 案例 $3$（多个分数水平上存在相同值）：\n  - 分数：$[0.70, 0.70, 0.70, 0.50, 0.50, 0.50, 0.30, 0.30]$\n  - 标签：$[1, 0, 1, 0, 1, 0, 1, 0]$\n- 案例 $4$（高度不平衡且分数重叠）：\n  - 分数：$[0.95, 0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45, 0.40, 0.35, 0.30, 0.25, 0.20, 0.15, 0.10, 0.05, 0.01]$\n  - 标签：$[0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]$\n- 案例 $5$（所有分数相同）：\n  - 分数：$[0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50]$\n  - 标签：$[1, 1, 1, 1, 1, 0, 0, 0, 0, 0]$\n\n角度单位不适用。无需物理单位。最终输出必须是所有案例的面积的平铺列表，按顺序排列，每个值按上述要求四舍五入到$6$位小数。",
            "solution": "### 推导与算法设计\n\n问题的核心是从一组带分数和标签的数据点构建受试者工作特征（ROC）和精确率-召回率（PR）曲线，然后计算这些曲线下的面积。\n\n**1. 曲线构建策略**\n\n曲线是通过将分数阈值 $t$ 从 $+\\infty$ 变化到 $-\\infty$ 来定义的。随着阈值 $t$ 的降低，更多的样本被分类为正例。真阳性率（TPR）、假阳性率（FPR）、精确率和召回率的值仅在阈值 $t$ 越过数据中存在的分数值时才会改变。因此，我们可以通过将唯一的分数值作为阈值来构建曲线。\n\n最有效的算法包括以下步骤：\n- 将分数 $s_i$ 和标签 $y_i$ 组合成对 $(s_i, y_i)$。\n- 根据分数 $s_i$ 将这些对按降序排序。如果分数相同，标签的相对顺序不影响最终曲线，因为所有具有相同分数的样本都作为一个整体进行处理。\n- 预先计算正例总数 $P = \\sum y_i$ 和负例总数 $N = \\sum (1-y_i)$。\n- 初始化真阳性（$\\mathrm{TP}$）和假阳性（$\\mathrm{FP}$）的计数为 $0$。\n- ROC曲线从点 $(0,0)$ 开始，这对应于一个高于所有分数的阈值 $t$。在此阈值下，$\\mathrm{TP}=0$ 且 $\\mathrm{FP}=0$，因此 $\\mathrm{FPR} = 0/N = 0$ 且 $\\mathrm{TPR} = 0/P = 0$。\n- PR曲线从点 $(0,1)$ 开始。在最高阈值下，$\\mathrm{Recall} = \\mathrm{TP}/P = 0$。精确率的分母 $\\mathrm{TP}+\\mathrm{FP}$ 为 $0$。根据给定的约定，精确率为 $1$。\n\n**2. 迭代生成点**\n\n我们遍历已排序的数据。为了正确处理分数相同的情况，我们同时处理所有具有相同分数值的数据点。\n设排序后的唯一分数为 $t_1  t_2  \\dots  t_m$。\n- 对于每个唯一分数 $t_j$：\n    - 识别所有满足 $s_i = t_j$ 的样本 $(s_i, y_i)$。\n    - 计算这些样本中的正例数（$\\Delta \\mathrm{TP}$）和负例数（$\\Delta \\mathrm{FP}$）。\n    - 更新累计计数：$\\mathrm{TP} \\leftarrow \\mathrm{TP} + \\Delta \\mathrm{TP}$ 和 $\\mathrm{FP} \\leftarrow \\mathrm{FP} + \\Delta \\mathrm{FP}$。\n    - 更新计数后，在每条曲线上生成一个新点：\n        - **ROC点**：$(\\mathrm{FPR}, \\mathrm{TPR}) = (\\mathrm{FP}/N, \\mathrm{TP}/P)$。\n        - **PR点**：$(\\mathrm{Recall}, \\mathrm{Precision}) = (\\mathrm{TP}/P, \\mathrm{TP}/(\\mathrm{TP}+\\mathrm{FP}))$。\n\n这个过程为每条曲线生成一个点序列。在处理完所有样本后生成最后一个点，此时 $\\mathrm{TP}=P$ 且 $\\mathrm{FP}=N$，得到ROC点 $(1,1)$ 和PR点 $(1, P/(P+N))$。\n\n**3. 面积计算**\n\n曲线下面积按规定使用梯形法则计算。对于由有序点序列 $(x_0, y_0), (x_1, y_1), \\dots, (x_K, y_K)$ 定义的曲线，其中 $x$ 坐标非递减，面积由以下公式给出：\n$$\n\\mathrm{Area} = \\sum_{k=0}^{K-1} \\frac{(x_{k+1}-x_k)}{2}\\,(y_k + y_{k+1})\n$$\n此公式分别应用于为ROC曲线和PR曲线生成的点序列。对于ROC曲线，$x_k = \\mathrm{FPR}_k$ 且 $y_k = \\mathrm{TPR}_k$。对于PR曲线，$x_k = \\mathrm{Recall}_k$ 且 $y_k = \\mathrm{Precision}_k$。此计算得出ROC-AUC和PR-AUC。\n\n这一完整的方法论，从排序到点生成再到面积积分，为解决给定测试用例的问题提供了一个稳健且正确的方法。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_aucs(scores, labels):\n    \"\"\"\n    Computes the ROC-AUC and PR-AUC for a given set of scores and labels.\n\n    The function follows the derivation from first principles:\n    1. Sorts samples by score in descending order.\n    2. Iterates through unique score thresholds to generate points on the ROC and PR curves.\n       Ties in scores are handled by processing all tied samples as a single block.\n    3. Calculates the area under each curve using the trapezoidal rule.\n\n    Args:\n        scores (list of float): The predicted scores for each sample.\n        labels (list of int): The true binary labels (1 for positive, 0 for negative).\n\n    Returns:\n        tuple[float, float]: A tuple containing the ROC-AUC and PR-AUC.\n    \"\"\"\n    labels = np.array(labels)\n    P = np.sum(labels)\n    N = len(labels) - P\n\n    # According to the problem statement, P = 1 and N = 1, so no need for explicit checks.\n\n    # Combine scores and labels, then sort by score in descending order.\n    data = sorted(zip(scores, labels), key=lambda x: x[0], reverse=True)\n    \n    # Initialize counts and point lists for the curves.\n    tp, fp = 0.0, 0.0\n    # ROC curve starts at (0,0).\n    roc_points = [(0.0, 0.0)]\n    # PR curve starts at (Recall=0, Precision=1).\n    pr_points = [(0.0, 1.0)]\n\n    i = 0\n    while i  len(data):\n        current_score = data[i][0]\n        tp_step, fp_step = 0.0, 0.0\n\n        # Process all samples with the same score (handling ties).\n        j = i\n        while j  len(data) and data[j][0] == current_score:\n            if data[j][1] == 1:\n                tp_step += 1\n            else:\n                fp_step += 1\n            j += 1\n        \n        tp += tp_step\n        fp += fp_step\n        i = j # Move index to the next unique score block\n\n        # Calculate metrics for the new point on both curves.\n        # Add new ROC point: (FPR, TPR)\n        roc_points.append((fp / N, tp / P))\n        \n        # Add new PR point: (Recall, Precision)\n        recall = tp / P\n        # Handle the case where TP + FP = 0, though it only happens at the start.\n        precision = tp / (tp + fp) if (tp + fp) > 0 else 1.0\n        pr_points.append((recall, precision))\n\n    # Extract x and y coordinates from the point lists.\n    roc_x = np.array([p[0] for p in roc_points])\n    roc_y = np.array([p[1] for p in roc_points])\n    \n    pr_x = np.array([p[0] for p in pr_points])\n    pr_y = np.array([p[1] for p in pr_points])\n\n    # Calculate the area under each curve using the trapezoidal rule.\n    # np.trapz(y, x) implements the formula specified in the problem.\n    roc_auc = np.trapz(roc_y, roc_x)\n    pr_auc = np.trapz(pr_y, pr_x)\n    \n    return roc_auc, pr_auc\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results in the specified format.\n    \"\"\"\n    test_cases = [\n        # Case 1 (balanced, near-perfect separation)\n        (\n            [0.95, 0.92, 0.88, 0.85, 0.83, 0.80, 0.45, 0.40, 0.35, 0.30, 0.25, 0.15],\n            [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0]\n        ),\n        # Case 2 (poor separation, many high-scoring decoys)\n        (\n            [0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45],\n            [0, 0, 0, 0, 0, 1, 1, 1, 0, 1]\n        ),\n        # Case 3 (ties at multiple score levels)\n        (\n            [0.70, 0.70, 0.70, 0.50, 0.50, 0.50, 0.30, 0.30],\n            [1, 0, 1, 0, 1, 0, 1, 0]\n        ),\n        # Case 4 (highly imbalanced with overlapping scores)\n        (\n            [0.95, 0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45, 0.40, 0.35, 0.30, 0.25, 0.20, 0.15, 0.10, 0.05, 0.01],\n            [0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]\n        ),\n        # Case 5 (all scores identical)\n        (\n            [0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50],\n            [1, 1, 1, 1, 1, 0, 0, 0, 0, 0]\n        )\n    ]\n\n    results = []\n    for scores, labels in test_cases:\n        roc_auc, pr_auc = calculate_aucs(scores, labels)\n        results.append(f\"{roc_auc:.6f}\")\n        results.append(f\"{pr_auc:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}