{
    "hands_on_practices": [
        {
            "introduction": "在酶的计算设计中，一个核心策略是构建一个能够特异性稳定反应过渡态的活性位点环境。本练习  定量地探讨了这一概念，通过计算一个精确对齐的内部电场如何通过斯塔克效应（Stark effect）降低活化能垒。这项实践将基础的静电学原理与提高催化速率这一具体目标联系起来，帮助你理解静电相互作用在酶催化中的关键作用。",
            "id": "3839531",
            "problem": "在计算酶设计和实验室定向进化中，一种加速催化的策略是设计一个取向的内部电场，该电场相对于反应物态（RS）能更稳定过渡态（TS）。考虑一个反应，其量子化学分析得出的反应偶极矩差 $\\Delta\\vec{\\mu} = \\vec{\\mu}_{\\mathrm{TS}} - \\vec{\\mu}_{\\mathrm{RS}}$ 指向反应坐标方向。预测一个设计的变体会在活性位点产生一个与 $\\Delta\\vec{\\mu}$ 对齐的均匀静电场 $\\vec{E}$。\n\n从均匀场中永久偶极子的基本静电学原理和反应偶极矩差的定义出发，推导电场对活化自由能垒变化的贡献，然后使用以下参数计算其大小：\n- $\\Delta\\vec{\\mu}$ 的大小为 $3.5$ 德拜，且与 $\\vec{E}$ 共线。\n- 设计的电场大小为 $1.2$ 兆伏/厘米，并与 $\\Delta\\vec{\\mu}$ 对齐（即矢量间的夹角为 $0$）。\n- 忽略极化率的任何变化和熵的贡献；将电场视为均匀的，并将斯塔克相互作用视为与永久偶极子纯线性相关。\n\n使用以下常数和单位换算：\n- 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}$ mol$^{-1}$，\n- $1$ 德拜 $= 3.33564 \\times 10^{-30}$ C$\\cdot$m，\n- $1$ 兆伏/厘米 $= 10^{8}$ 伏/米。\n\n以千焦/摩尔为单位，将活化自由能垒降低的量值报告为一个正数。将您的答案四舍五入到四位有效数字。",
            "solution": "此问题具有科学依据、提法明确且客观。它描述了计算生物化学中使用的一个标准物理模型，特别是线性斯塔克效应对反应能量学的影响。所有必要的常数和参数都已提供，并且没有内部矛盾。因此，该问题是有效的，并将推导出解答。\n\n第一步是推导电场引起的活化能垒变化的表达式。在均匀电场 $\\vec{E}$ 中，永久电偶极矩 $\\vec{\\mu}$ 的势能 $U$ 由标量积给出：\n$$U = -\\vec{\\mu} \\cdot \\vec{E}$$\n这种相互作用能对系统的总能量有贡献。我们可以将此原理应用于反应的反应物态（RS）和过渡态（TS）。由电场产生的势能贡献为：\n$$U_{\\mathrm{RS}} = -\\vec{\\mu}_{\\mathrm{RS}} \\cdot \\vec{E}$$\n$$U_{\\mathrm{TS}} = -\\vec{\\mu}_{\\mathrm{TS}} \\cdot \\vec{E}$$\n其中 $\\vec{\\mu}_{\\mathrm{RS}}$ 和 $\\vec{\\mu}_{\\mathrm{TS}}$ 分别是反应物态和过渡态的偶极矩。\n\n活化自由能垒 $\\Delta G^\\ddagger$ 定义为过渡态和反应物态之间的自由能差：$\\Delta G^\\ddagger = G_{\\mathrm{TS}} - G_{\\mathrm{RS}}$。问题指明要忽略熵的贡献，因此我们可以用势能垒的变化来近似自由能垒的变化。由电场引起的活化能垒的变化，我们记为 $\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}}$，是 TS 和 RS 的场相互作用能之差。\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field, single molecule}} = U_{\\mathrm{TS}} - U_{\\mathrm{RS}} = (-\\vec{\\mu}_{\\mathrm{TS}} \\cdot \\vec{E}) - (-\\vec{\\mu}_{\\mathrm{RS}} \\cdot \\vec{E})$$\n整理各项，我们得到：\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field, single molecule}} = -(\\vec{\\mu}_{\\mathrm{TS}} - \\vec{\\mu}_{\\mathrm{RS}}) \\cdot \\vec{E}$$\n问题将反应偶极矩差定义为 $\\Delta\\vec{\\mu} = \\vec{\\mu}_{\\mathrm{TS}} - \\vec{\\mu}_{\\mathrm{RS}}$。将此定义代入我们的表达式中，得到：\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field, single molecule}} = -\\Delta\\vec{\\mu} \\cdot \\vec{E}$$\n为了获得活化自由能垒的摩尔变化，我们将此单分子能量乘以阿伏伽德罗常数 $N_{\\mathrm{A}}$。\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}} = -N_{\\mathrm{A}}(\\Delta\\vec{\\mu} \\cdot \\vec{E})$$\n点积定义为 $\\Delta\\vec{\\mu} \\cdot \\vec{E} = |\\Delta\\vec{\\mu}| |\\vec{E}| \\cos(\\theta)$，其中 $\\theta$ 是两个矢量之间的夹角。问题陈述电场 $\\vec{E}$ 与 $\\Delta\\vec{\\mu}$ 对齐，这意味着 $\\theta=0$。由于 $\\cos(0)=1$，表达式简化为：\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}} = -N_{\\mathrm{A}} |\\Delta\\vec{\\mu}| |\\vec{E}|$$\n负号表示当 $\\vec{E}$ 与 $\\Delta\\vec{\\mu}$ 对齐时，活化能垒会降低。问题要求计算此降低的量值，即变化的绝对值，是一个正数。我们将此量值记为 $\\delta(\\Delta G^\\ddagger)$。\n$$\\delta(\\Delta G^\\ddagger) = |\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}}| = N_{\\mathrm{A}} |\\Delta\\vec{\\mu}| |\\vec{E}|$$\n推导至此完成。我们现在进行计算。\n\n给定的参数必须转换为国际单位制（SI）基本单位。\n反应偶极矩差的大小为 $|\\Delta\\vec{\\mu}| = 3.5 \\text{ 德拜}$。使用换算因子 $1 \\text{ 德拜} = 3.33564 \\times 10^{-30} \\text{ C}\\cdot\\text{m}$：\n$$|\\Delta\\vec{\\mu}| = 3.5 \\times (3.33564 \\times 10^{-30} \\text{ C}\\cdot\\text{m}) = 1.167474 \\times 10^{-29} \\text{ C}\\cdot\\text{m}$$\n电场的大小为 $|\\vec{E}| = 1.2 \\text{ MV/cm}$。使用换算因子 $1 \\text{ MV/cm} = 10^8 \\text{ V/m}$：\n$$|\\vec{E}| = 1.2 \\times 10^8 \\text{ V/m}$$\n阿伏伽德罗常数给定为 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23} \\text{ mol}^{-1}$。\n\n现在我们将这些值代入推导出的 $\\delta(\\Delta G^\\ddagger)$ 方程中：\n$$\\delta(\\Delta G^\\ddagger) = (6.02214076 \\times 10^{23} \\text{ mol}^{-1}) \\times (1.167474 \\times 10^{-29} \\text{ C}\\cdot\\text{m}) \\times (1.2 \\times 10^8 \\text{ V/m})$$\n结果的单位是 $(\\text{mol}^{-1}) \\cdot (\\text{C}\\cdot\\text{m}) \\cdot (\\text{V/m})$。由于一伏特等于一焦耳每库仑（$1 \\text{ V} = 1 \\text{ J/C}$），单位组合后得到：\n$$(\\text{mol}^{-1}) \\cdot (\\text{C}\\cdot\\text{m}) \\cdot (\\frac{\\text{J}}{\\text{C}\\cdot\\text{m}}) = \\text{J/mol}$$\n这是所需的摩尔能量单位。让我们计算数值：\n$$\\delta(\\Delta G^\\ddagger) = (6.02214076 \\times 1.167474 \\times 1.2) \\times 10^{23 - 29 + 8} \\text{ J/mol}$$\n$$\\delta(\\Delta G^\\ddagger) = (8.4372549...) \\times 10^{2} \\text{ J/mol}$$\n$$\\delta(\\Delta G^\\ddagger) = 843.72549... \\text{ J/mol}$$\n问题要求答案以千焦/摩尔（$\\text{kJ/mol}$）为单位。我们通过除以 $1000$ 将 $\\text{J/mol}$ 转换为 $\\text{kJ/mol}$：\n$$\\delta(\\Delta G^\\ddagger) = \\frac{843.72549...}{1000} \\text{ kJ/mol} = 0.84372549... \\text{ kJ/mol}$$\n最后，我们按要求将结果四舍五入到四位有效数字。前四位有效数字是 $8$、$4$、$3$ 和 $7$。第五位有效数字是 $2$，小于 $5$，因此我们舍去。\n$$\\delta(\\Delta G^\\ddagger) \\approx 0.8437 \\text{ kJ/mol}$$\n该结果代表了活化自由能垒降低的量值。",
            "answer": "$$\n\\boxed{0.8437}\n$$"
        },
        {
            "introduction": "计算设计与实验室中的定向进化相辅相成，计算得出的见解常被用来构建用于实验筛选的“智能”酶变体库。本练习  解决了一个真实世界中的任务：设计简并密码子的最优混合方案，以便在特定位点上实现期望的氨基酸分布，同时最大限度地减少不必要的终止密码子。这项实践展示了如何运用优化技术，在计算机模拟设计与实际的实验操作之间架起一座桥梁。",
            "id": "3839506",
            "problem": "您正在为计算酶设计和定向进化中的定点饱和突变设计一个库。给定一个固定的简并密码子集集合，每个集合由一个国际纯粹与应用化学联合会（International Union of Pure and Applied Chemistry, IUPAC）核苷酸三联体模式定义（例如，$NNK$，其中 $N \\in \\{A,C,G,T\\}$ 且 $K \\in \\{G,T\\}$）。当从给定的简并集中抽样一个密码子时，假设在每个位置上对允许的核苷酸进行独立且均匀的抽样。根据分子生物学的中心法则（DNA到RNA到蛋白质）和标准遗传密码，每个密码子都确定性地映射到一个氨基酸或一个终止信号。对于每个密码子集 $j$，定义一个20维的氨基酸频率向量 $\\mathbf{a}_j$（涵盖标准的20种氨基酸）和一个终止频率 $s_j$。这些值是通过枚举简并模式所允许的所有具体密码子，并在均匀抽样假设下通过遗传密码进行映射得到的。\n\n您希望用非负权重 $\\mathbf{w} \\in \\mathbb{R}^M$（$M$是密码子集的数量），在 $\\sum_{j=1}^M w_j = 1$ 的约束下，混合这些密码子集，以近似一个目标氨基酸分布 $\\mathbf{p} \\in \\mathbb{R}^{20}$，同时对预期的终止分数进行惩罚。设 $A \\in \\mathbb{R}^{20 \\times M}$ 是以 $\\mathbf{a}_j$ 为列的矩阵，并设 $\\mathbf{s} \\in \\mathbb{R}^M$ 收集了所有的 $s_j$。混合诱导的氨基酸分布是 $A \\mathbf{w}$，预期的终止频率是 $\\mathbf{s}^\\top \\mathbf{w}$。对于给定的非负惩罚参数 $\\lambda \\in \\mathbb{R}_{\\ge 0}$，通过求解以下约束凸优化问题来找到最优混合：\n$$\n\\min_{\\mathbf{w} \\in \\mathbb{R}^M} \\; \\frac{1}{2}\\lVert A\\mathbf{w} - \\mathbf{p}\\rVert_2^2 + \\lambda \\, \\mathbf{s}^\\top \\mathbf{w}\n\\quad \\text{subject to} \\quad\n\\sum_{j=1}^M w_j = 1, \\quad w_j \\ge 0 \\; \\text{for all } j.\n$$\n\n使用的基本原理：\n- 分子生物学中心法则（DNA密码子映射到氨基酸或终止信号）。\n- 标准遗传密码是确定性的且已被广泛确立。\n- 概率混合模型：如果密码子集 $j$ 以概率 $w_j$ 被选择，那么氨基酸分布是凸组合 $A\\mathbf{w}$，终止概率是 $\\mathbf{s}^\\top \\mathbf{w}$。\n\n通过枚举每个简并集中的所有密码子，并假设每个位置上每个允许的核苷酸具有相等概率，来精确计算 $\\mathbf{a}_j$ 和 $s_j$。\n\n使用固定的密码子集集合（在所有计算和输出中均按此确切顺序）：$[NNK, NNS, NDT, VHG, TGG]$。这里，$N$ 代表 $\\{A,C,G,T\\}$，$K$ 代表 $\\{G,T\\}$，$S$ 代表 $\\{G,C\\}$，$D$ 代表 $\\{A,G,T\\}$，$V$ 代表 $\\{A,C,G\\}$，$H$ 代表 $\\{A,C,T\\}$，每个字面核苷酸（$A,C,G,T$）代表其自身。\n\n为所有向量（包括目标和输出）定义氨基酸顺序，即单字母代码列表 $[A, C, D, E, F, G, H, I, K, L, M, N, P, Q, R, S, T, V, W, Y]$。\n\n您的程序必须：\n- 使用标准遗传密码通过精确枚举构建 $A$ 和 $\\mathbf{s}$。\n- 对每个测试用例，解决优化问题并报告非负权重 $\\mathbf{w}$。\n- 同时报告预期终止分数 $\\mathbf{s}^\\top \\mathbf{w}$ 和 $A\\mathbf{w}$ 与 $\\mathbf{p}$ 之间的均方根误差 (RMSE)，定义为 $\\sqrt{\\frac{1}{20}\\sum_{i=1}^{20} ( (A\\mathbf{w})_i - p_i )^2}$。\n\n测试套件：\n- 情况1（一般情况）：目标均匀分布 $\\mathbf{p}^{(1)}$，其中对于 $i=1,\\dots,20$，$p^{(1)}_i = \\frac{1}{20}$，且 $\\lambda^{(1)} = 0.1$。\n- 情况2（富含疏水性氨基酸的边界情况）：定义 $\\mathbf{p}^{(2)}$，设置 $p^{(2)}_{\\text{L}} = 0.35$，$p^{(2)}_{\\text{I}} = 0.25$，$p^{(2)}_{\\text{V}} = 0.15$，并将其余的 $0.25$ 质量均匀分配给其他 $17$ 种氨基酸；设置 $\\lambda^{(2)} = 0.05$。\n- 情况3（可精确实现的边缘情况）：仅含色氨酸的目标 $\\mathbf{p}^{(3)}$，其中 $p^{(3)}_{\\text{W}} = 1.0$，所有其他项为 $0.0$；设置 $\\lambda^{(3)} = 0.0$。\n- 情况4（高终止惩罚）：再次使用均匀目标 $\\mathbf{p}^{(4)}$，其中 $p^{(4)}_i = \\frac{1}{20}$，且 $\\lambda^{(4)} = 1000.0$。\n\n所有计算都是无单位的。不涉及角度。所有小数答案必须是十进制数。\n\n最终输出格式：\n- 对每个测试用例 $t \\in \\{1,2,3,4\\}$，生成一个列表，其中包含按固定密码子集顺序 $[NNK,NNS,NDT,VHG,TGG]$ 排列的混合权重，后跟预期的终止分数和RMSE，所有值均四舍五入到恰好 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表由这些按用例生成的子列表组成，并用方括号括起来。例如，包含两个用例的输出应如下所示：$[[w_{11},w_{12},\\dots,stop_1,rmse_1],[w_{21},w_{22},\\dots,stop_2,rmse_2]]$，且不含任何空格。",
            "solution": "所呈现的问题是一个约束凸优化任务，具体来说是一个二次规划（Quadratic Program, QP），旨在寻找简并密码子集的最优混合，以在计算酶设计中近似目标氨基酸分布。该问题在科学和数学上是适定的，并且可以系统地解决。\n\n问题的核心是为权重向量 $\\mathbf{w} \\in \\mathbb{R}^M$ 求解以下最小化问题：\n$$\n\\min_{\\mathbf{w}} \\; f(\\mathbf{w}) = \\frac{1}{2}\\lVert A\\mathbf{w} - \\mathbf{p}\\rVert_2^2 + \\lambda \\, \\mathbf{s}^\\top \\mathbf{w}\n$$\n其约束条件是权重形成一个概率分布：\n$$\n\\sum_{j=1}^M w_j = 1, \\quad w_j \\ge 0 \\; \\text{for } j = 1, \\ldots, M\n$$\n这里，$M=5$ 是密码子集的数量。矩阵 $A \\in \\mathbb{R}^{20 \\times M}$ 包含每个密码子集的氨基酸频率分布，向量 $\\mathbf{s} \\in \\mathbb{R}^M$ 包含相应的终止密码子频率，$\\mathbf{p} \\in \\mathbb{R}^{20}$ 是目标氨基酸分布，$\\lambda \\in \\mathbb{R}_{\\ge 0}$ 是终止密码子频率的标量惩罚参数。\n\n解决过程包括三个主要步骤：\n1.  构建氨基酸频率矩阵 $A$ 和终止频率向量 $\\mathbf{s}$。\n2.  对每个测试用例，数值求解约束二次规划（QP）。\n3.  计算最终指标：预期终止分数和均方根误差（RMSE）。\n\n**步骤1：构建矩阵 $A$ 和向量 $\\mathbf{s}$**\n\n$A=[\\mathbf{a}_1, \\dots, \\mathbf{a}_M]$ 和 $\\mathbf{s}=[s_1, \\dots, s_M]^\\top$ 的分量必须从第一性原理确定。这需要为给定的 $M=5$ 个简并密码子集（$[NNK, NNS, NDT, VHG, TGG]$）中的每一个枚举所有可能的具体密码子。\n\n每个IUPAC代码的核苷酸可能性如下：\n- $N: \\{A, C, G, T\\}$ (大小 $4$)\n- $K: \\{G, T\\}$ (大小 $2$)\n- $S: \\{G, C\\}$ (大小 $2$)\n- $D: \\{A, G, T\\}$ (大小 $3$)\n- $V: \\{A, C, G\\}$ (大小 $3$)\n- $H: \\{A, C, T\\}$ (大小 $3$)\n- $A, C, G, T$: 代表自身 (大小 $1$)\n\n对于每个简并密码子集 $j$，我们生成所有可能的三核苷酸密码子。例如，对于 $NNK$，不同密码子的数量是 $4 \\times 4 \\times 2 = 32$。我们假设这些具体密码子中的每一个都以均匀概率（即 $1/32$）被抽样。\n\n然后使用标准遗传密码将每个具体密码子映射到20种标准氨基酸之一或一个终止信号。所有向量的氨基酸顺序固定为 $[A, C, D, E, F, G, H, I, K, L, M, N, P, Q, R, S, T, V, W, Y]$。\n\n列向量 $\\mathbf{a}_j$ 的第 $i$ 个元素，记为 $(\\mathbf{a}_j)_i$，是密码子集 $j$ 产生的混合物中第 $i$ 种氨基酸的频率。它的计算方法是：将密码子集 $j$ 中编码氨基酸 $i$ 的密码子数量除以该集中的密码子总数。类似地，终止频率 $s_j$ 是密码子集 $j$ 中属于终止密码子的密码子所占的比例。\n\n对所有 $M=5$ 个密码子集执行此枚举，以填充 $20 \\times 5$ 矩阵 $A$ 和 $5$ 维向量 $\\mathbf{s}$。\n\n**步骤2：求解二次规划**\n\n目标函数可以展开为标准的QP形式。让我们重写目标函数 $f(\\mathbf{w})$：\n$$\nf(\\mathbf{w}) = \\frac{1}{2}(A\\mathbf{w} - \\mathbf{p})^\\top(A\\mathbf{w} - \\mathbf{p}) + \\lambda \\mathbf{s}^\\top \\mathbf{w} = \\frac{1}{2}\\mathbf{w}^\\top (A^\\top A) \\mathbf{w} - (\\mathbf{p}^\\top A - \\lambda \\mathbf{s}^\\top)\\mathbf{w} + \\frac{1}{2}\\mathbf{p}^\\top\\mathbf{p}\n$$\n忽略不影响最小值位置的常数项 $\\frac{1}{2}\\mathbf{p}^\\top\\mathbf{p}$，问题简化为最小化：\n$$\n\\min_{\\mathbf{w}} \\; \\frac{1}{2}\\mathbf{w}^\\top Q \\mathbf{w} + \\mathbf{c}^\\top \\mathbf{w}\n$$\n其中 $Q = A^\\top A$ 是一个半正定矩阵，$\\mathbf{c} = -A^\\top \\mathbf{p} + \\lambda \\mathbf{s}$。约束条件包括一个线性等式 $\\mathbf{1}^\\top \\mathbf{w} = 1$ 和非负性边界 $w_j \\ge 0$。\n\n此公式代表一个凸二次规划（convex QP），它保证全局最小值存在，并可以使用数值优化算法高效地找到。实现将使用`scipy.optimize.minimize`库函数中提供的序列最小二乘规划（Sequential Least Squares Programming, SLSQP）方法。此求解器需要目标函数、其梯度（雅可比矩阵）以及约束和边界的规范。\n\n目标函数相对于 $\\mathbf{w}$ 的梯度是：\n$$\n\\nabla_{\\mathbf{w}} f(\\mathbf{w}) = A^\\top(A\\mathbf{w} - \\mathbf{p}) + \\lambda \\mathbf{s}\n$$\n向求解器提供此解析梯度可以提高其准确性和收敛速度。\n\n**步骤3：处理测试用例和计算指标**\n\n对于四个测试用例中的每一个，我们定义特定的目标分布向量 $\\mathbf{p}$ 和惩罚参数 $\\lambda$。在预先计算好 $A$ 和 $\\mathbf{s}$ 的情况下，我们执行 SLSQP 求解器来找到最优权重向量 $\\mathbf{w}_{\\text{opt}}$。\n\n一旦找到 $\\mathbf{w}_{\\text{opt}}$，就计算所需的输出指标：\n1.  最优权重 $\\mathbf{w}_{\\text{opt}} = [w_1, \\dots, w_5]^\\top$。\n2.  预期终止分数：$\\mathbf{s}^\\top \\mathbf{w}_{\\text{opt}}$。\n3.  结果氨基酸分布 $A\\mathbf{w}_{\\text{opt}}$ 与目标 $\\mathbf{p}$ 之间的均方根误差（RMSE）：\n    $$\n    \\text{RMSE} = \\sqrt{\\frac{1}{20}\\sum_{i=1}^{20} ( (A\\mathbf{w}_{\\text{opt}})_i - p_i )^2} = \\frac{1}{\\sqrt{20}}\\lVert A\\mathbf{w}_{\\text{opt}} - \\mathbf{p} \\rVert_2\n    $$\n最终的程序实现了这整个过程，计算 $A$ 和 $\\mathbf{s}$，然后遍历每个测试用例以解决相应的 QP 问题，并按要求格式报告指定的结果。",
            "answer": "[[0.509748,0.490252,0.000000,0.000000,0.000000,0.046580,0.004945],[0.000000,0.923880,0.076120,0.000000,0.000000,0.081827,0.015942],[0.000000,0.000000,0.000000,0.000000,1.000000,0.000000,0.000000],[1.000000,0.000000,0.000000,0.000000,0.000000,0.031250,0.008436]]"
        }
    ]
}