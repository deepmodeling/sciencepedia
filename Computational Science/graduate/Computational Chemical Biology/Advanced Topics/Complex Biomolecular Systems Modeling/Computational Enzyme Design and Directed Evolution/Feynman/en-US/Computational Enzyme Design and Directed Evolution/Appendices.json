{
    "hands_on_practices": [
        {
            "introduction": "A central goal in enzyme design is to accelerate reactions by stabilizing the transition state. This exercise delves into one of the most powerful physical mechanisms for achieving this: electrostatic catalysis. By solving this problem, you will apply fundamental principles of electrostatics to quantify how an engineered electric field within an enzyme's active site can lower the activation energy barrier, $\\Delta G^\\ddagger$, a concept grounded in the Stark effect. This practice provides a tangible connection between microscopic protein features and macroscopic catalytic rate enhancement. ",
            "id": "3839531",
            "problem": "In computational enzyme design and laboratory Directed Evolution, one strategy to accelerate catalysis is to engineer an oriented internal electric field that stabilizes the Transition State (TS) relative to the Reactant State (RS). Consider a reaction for which quantum chemical analysis yields a reaction dipole difference $\\Delta\\vec{\\mu} = \\vec{\\mu}_{\\mathrm{TS}} - \\vec{\\mu}_{\\mathrm{RS}}$ pointing along the reaction coordinate. A designed variant is predicted to produce a uniform static electric field $\\vec{E}$ in the active site that is aligned with $\\Delta\\vec{\\mu}$.\n\nStarting from fundamental electrostatics for a permanent dipole in a uniform field and the definition of the reaction dipole difference, derive the field-induced contribution to the change in the activation free energy barrier and then compute its magnitude for the following parameters:\n- $\\Delta\\vec{\\mu}$ has magnitude $3.5$ Debye and is colinear with $\\vec{E}$.\n- The engineered field has magnitude $1.2$ megavolts per centimeter and is aligned with $\\Delta\\vec{\\mu}$ (i.e., the angle between the vectors is $0$).\n- Neglect any changes in polarizability and entropic contributions; treat the field as uniform and the Stark interaction as purely linear in the permanent dipole.\n\nUse the following constants and unit conversions:\n- Avogadroâ€™s number $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}$ mol$^{-1}$,\n- $1$ Debye $= 3.33564 \\times 10^{-30}$ C$\\cdot$m,\n- $1$ megavolt per centimeter $= 10^{8}$ volt per meter.\n\nReport the magnitude of the lowering of the activation free energy barrier as a positive quantity in kilojoules per mole. Round your answer to four significant figures.",
            "solution": "The problem is scientifically grounded, well-posed, and objective. It describes a standard physical model used in computational biochemistry, specifically the linear Stark effect on reaction energetics. All necessary constants and parameters are provided, and there are no internal contradictions. Therefore, the problem is valid, and a solution will be derived.\n\nThe first step is to derive the expression for the field-induced change in the activation energy barrier. The potential energy, $U$, of a permanent electric dipole moment, $\\vec{\\mu}$, in a uniform electric field, $\\vec{E}$, is given by the scalar product:\n$$U = -\\vec{\\mu} \\cdot \\vec{E}$$\nThis interaction energy contributes to the overall energy of the system. We can apply this principle to both the Reactant State (RS) and the Transition State (TS) of the reaction. The potential energy contributions from the field are:\n$$U_{\\mathrm{RS}} = -\\vec{\\mu}_{\\mathrm{RS}} \\cdot \\vec{E}$$\n$$U_{\\mathrm{TS}} = -\\vec{\\mu}_{\\mathrm{TS}} \\cdot \\vec{E}$$\nwhere $\\vec{\\mu}_{\\mathrm{RS}}$ and $\\vec{\\mu}_{\\mathrm{TS}}$ are the dipole moments of the reactant and transition states, respectively.\n\nThe activation free energy barrier, $\\Delta G^\\ddagger$, is defined as the difference in free energy between the transition state and the reactant state: $\\Delta G^\\ddagger = G_{\\mathrm{TS}} - G_{\\mathrm{RS}}$. The problem specifies to neglect entropic contributions, so we can approximate the change in the free energy barrier by the change in the potential energy barrier. The change in the activation barrier due to the electric field, which we denote as $\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}}$, is the difference between the field interaction energies of the TS and RS.\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field, single molecule}} = U_{\\mathrm{TS}} - U_{\\mathrm{RS}} = (-\\vec{\\mu}_{\\mathrm{TS}} \\cdot \\vec{E}) - (-\\vec{\\mu}_{\\mathrm{RS}} \\cdot \\vec{E})$$\nRearranging the terms, we get:\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field, single molecule}} = -(\\vec{\\mu}_{\\mathrm{TS}} - \\vec{\\mu}_{\\mathrm{RS}}) \\cdot \\vec{E}$$\nThe problem defines the reaction dipole difference as $\\Delta\\vec{\\mu} = \\vec{\\mu}_{\\mathrm{TS}} - \\vec{\\mu}_{\\mathrm{RS}}$. Substituting this definition into our expression gives:\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field, single molecule}} = -\\Delta\\vec{\\mu} \\cdot \\vec{E}$$\nTo obtain the molar change in the activation free energy barrier, we multiply this single-molecule energy by Avogadro's number, $N_{\\mathrm{A}}$.\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}} = -N_{\\mathrm{A}}(\\Delta\\vec{\\mu} \\cdot \\vec{E})$$\nThe dot product is defined as $\\Delta\\vec{\\mu} \\cdot \\vec{E} = |\\Delta\\vec{\\mu}| |\\vec{E}| \\cos(\\theta)$, where $\\theta$ is the angle between the two vectors. The problem states that the field $\\vec{E}$ is aligned with $\\Delta\\vec{\\mu}$, which means $\\theta=0$. Since $\\cos(0)=1$, the expression simplifies to:\n$$\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}} = -N_{\\mathrm{A}} |\\Delta\\vec{\\mu}| |\\vec{E}|$$\nThe negative sign indicates that when $\\vec{E}$ is aligned with $\\Delta\\vec{\\mu}$, the activation barrier is lowered. The problem asks for the magnitude of this lowering, which is the absolute value of the change, a positive quantity. Let's denote this magnitude as $\\delta(\\Delta G^\\ddagger)$.\n$$\\delta(\\Delta G^\\ddagger) = |\\Delta(\\Delta G^\\ddagger)_{\\mathrm{field}}| = N_{\\mathrm{A}} |\\Delta\\vec{\\mu}| |\\vec{E}|$$\nThis completes the derivation. We now proceed with the calculation.\n\nThe given parameters must be converted to base SI units.\nThe magnitude of the reaction dipole difference is $|\\Delta\\vec{\\mu}| = 3.5 \\text{ Debye}$. Using the conversion factor $1 \\text{ Debye} = 3.33564 \\times 10^{-30} \\text{ C}\\cdot\\text{m}$:\n$$|\\Delta\\vec{\\mu}| = 3.5 \\times (3.33564 \\times 10^{-30} \\text{ C}\\cdot\\text{m}) = 1.167474 \\times 10^{-29} \\text{ C}\\cdot\\text{m}$$\nThe magnitude of the electric field is $|\\vec{E}| = 1.2 \\text{ MV/cm}$. Using the conversion factor $1 \\text{ MV/cm} = 10^8 \\text{ V/m}$:\n$$|\\vec{E}| = 1.2 \\times 10^8 \\text{ V/m}$$\nAvogadro's number is given as $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23} \\text{ mol}^{-1}$.\n\nNow we substitute these values into the derived equation for $\\delta(\\Delta G^\\ddagger)$:\n$$\\delta(\\Delta G^\\ddagger) = (6.02214076 \\times 10^{23} \\text{ mol}^{-1}) \\times (1.167474 \\times 10^{-29} \\text{ C}\\cdot\\text{m}) \\times (1.2 \\times 10^8 \\text{ V/m})$$\nThe unit of the result is $(\\text{mol}^{-1}) \\cdot (\\text{C}\\cdot\\text{m}) \\cdot (\\text{V/m})$. Since a Volt is a Joule per Coulomb ($1 \\text{ V} = 1 \\text{ J/C}$), the units combine to give:\n$$(\\text{mol}^{-1}) \\cdot (\\text{C}\\cdot\\text{m}) \\cdot (\\frac{\\text{J}}{\\text{C}\\cdot\\text{m}}) = \\text{J/mol}$$\nThis is the desired unit of molar energy. Let's calculate the numerical value:\n$$\\delta(\\Delta G^\\ddagger) = (6.02214076 \\times 1.167474 \\times 1.2) \\times 10^{23 - 29 + 8} \\text{ J/mol}$$\n$$\\delta(\\Delta G^\\ddagger) = (8.4372549...) \\times 10^{2} \\text{ J/mol}$$\n$$\\delta(\\Delta G^\\ddagger) = 843.72549... \\text{ J/mol}$$\nThe problem requires the answer in kilojoules per mole ($\\text{kJ/mol}$). We convert from $\\text{J/mol}$ to $\\text{kJ/mol}$ by dividing by $1000$:\n$$\\delta(\\Delta G^\\ddagger) = \\frac{843.72549...}{1000} \\text{ kJ/mol} = 0.84372549... \\text{ kJ/mol}$$\nFinally, we round the result to four significant figures as requested. The first four significant figures are $8$, $4$, $3$, and $7$. The fifth significant digit is $2$, which is less than $5$, so we round down.\n$$\\delta(\\Delta G^\\ddagger) \\approx 0.8437 \\text{ kJ/mol}$$\nThis result represents the magnitude of the lowering of the activation free energy barrier.",
            "answer": "$$\n\\boxed{0.8437}\n$$"
        },
        {
            "introduction": "Once a design principle is established, the next challenge is to computationally construct a protein structure that realizes it. This practice introduces you to rotamer packing, a core problem in computational protein design, where the goal is to find the optimal combination of side-chain conformations (rotamers) to minimize the system's energy. You will implement the Dead-End Elimination (DEE) algorithm, a classic and efficient method for pruning the vast conformational search space, making this complex design task computationally feasible. ",
            "id": "3839478",
            "problem": "You are tasked with implementing a program to select side-chain conformations (rotamers) for a buried enzymatic active site using Dead-End Elimination (DEE) and then computing the Global Minimum Energy Conformation (GMEC) under a pairwise-additive energy model. The problem should be solved from first principles, starting from a pairwise decomposable energy definition and deriving a pruning criterion that guarantees elimination of rotamers that cannot be part of any globally optimal solution. After pruning converges, you must enumerate the remaining rotamer combinations to identify the GMEC. The program must operate deterministically and produce a single line of output aggregating results for a set of test cases.\n\nFundamental base and definitions:\n- A protein side-chain conformation space is discretized into a set of rotamers per residue. Let there be $N$ residues indexed by $i\\in\\{0,1,\\dots,N-1\\}$, and for residue $i$ let there be $K_i$ rotamers indexed by $r\\in\\{0,1,\\dots,K_i-1\\}$.\n- The energy model is pairwise-additive and decomposes into self and pair terms. For an assignment $\\mathbf{r}=(r_0,r_1,\\dots,r_{N-1})$, the total energy is\n$$\nE(\\mathbf{r}) \\;=\\; \\sum_{i=0}^{N-1} E_i(r_i) \\;+\\; \\sum_{0\\le ij\\le N-1} E_{ij}(r_i,r_j),\n$$\nwhere $E_i(r)$ is the self energy of rotamer $r$ at residue $i$, and $E_{ij}(r_i,r_j)$ is the pair energy between rotamers $r_i$ and $r_j$ at residues $i$ and $j$. All energies are expressed in kilocalories per mole (kcal/mol).\n- An assignment $\\mathbf{r}^\\star$ is a Global Minimum Energy Conformation (GMEC) if it minimizes $E(\\mathbf{r})$ over the discrete rotamer space.\n- Dead-End Elimination (DEE) is a method for pruning rotamers by proving they cannot belong to any GMEC, based on lower bounds derived from the energy decomposition. You must derive a valid single-residue pruning inequality from the above pairwise model and use it to prune until no more rotamers can be eliminated. Then, exhaustively enumerate the remaining rotamer assignments to find the GMEC.\n\nProgram requirements:\n- Implement an iterative pruning algorithm based on a valid DEE criterion derived from the pairwise-additive energy model, eliminating rotamers that cannot be part of any GMEC. Continue until a fixed point is reached (no further eliminations).\n- After pruning, compute the GMEC by exact enumeration over the remaining rotamer sets.\n- For ties in energy, break deterministically by selecting the lexicographically smallest rotamer assignment $(r_0,r_1,\\dots)$ encountered during enumeration.\n- For each test case, report the total number of pruned rotamers, the GMEC energy in kilocalories per mole rounded to four decimal places, and the GMEC rotamer indices as a list of integers.\n\nTest suite:\nYou must hard-code and solve the following three test cases. In each case, $E_i(r)$ and $E_{ij}(r_i,r_j)$ are given, with $E_{ij}(r_i,r_j)=E_{ji}(r_j,r_i)$ and $E_{ii}(\\cdot,\\cdot)=0$ implicitly. All numbers below are energies in kilocalories per mole and must be used exactly as specified.\n\n- Test case $1$ (happy path with nontrivial pruning):\n  - Residues: $N=3$, rotamer counts: $(K_0,K_1,K_2)=(2,2,2)$.\n  - Self energies:\n    $$\n    E_0 = \\begin{bmatrix} -1.0  0.2 \\end{bmatrix},\\quad\n    E_1 = \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix},\\quad\n    E_2 = \\begin{bmatrix} -0.3  -0.2 \\end{bmatrix}.\n    $$\n  - Pair energies between residues $(0,1)$:\n    $$\n    E_{01} =\n    \\begin{bmatrix}\n    -0.4  -0.1\\\\\n    0.6  0.2\n    \\end{bmatrix},\n    $$\n    where rows correspond to $r_0\\in\\{0,1\\}$ and columns to $r_1\\in\\{0,1\\}$.\n  - Pair energies between residues $(0,2)$:\n    $$\n    E_{02} =\n    \\begin{bmatrix}\n    -0.3  -0.1\\\\\n    0.5  0.1\n    \\end{bmatrix}.\n    $$\n  - Pair energies between residues $(1,2)$:\n    $$\n    E_{12} =\n    \\begin{bmatrix}\n    -0.2  0.0\\\\\n    0.1  0.2\n    \\end{bmatrix}.\n    $$\n  - All other pair energies are defined by symmetry.\n\n- Test case $2$ (boundary case with no pruning):\n  - Residues: $N=4$, rotamer counts: $(K_0,K_1,K_2,K_3)=(2,3,2,2)$.\n  - Self energies:\n    $$\n    E_0 = \\begin{bmatrix} 0.0  0.0 \\end{bmatrix},\\quad\n    E_1 = \\begin{bmatrix} -0.1  -0.1  -0.1 \\end{bmatrix},\\quad\n    E_2 = \\begin{bmatrix} 0.0  0.0 \\end{bmatrix},\\quad\n    E_3 = \\begin{bmatrix} 0.0  0.0 \\end{bmatrix}.\n    $$\n  - All pair energies are zero:\n    $$\n    E_{ij}(r_i,r_j)=0.0 \\quad \\text{for all } 0\\le ij\\le 3 \\text{ and all rotamer indices}.\n    $$\n\n- Test case $3$ (edge case with aggressive pruning in a buried active site):\n  - Residues: $N=3$, rotamer counts: $(K_0,K_1,K_2)=(3,3,3)$.\n  - Self energies:\n    $$\n    E_0 = \\begin{bmatrix} 0.5  -0.2  0.9 \\end{bmatrix},\\quad\n    E_1 = \\begin{bmatrix} 0.4  -0.1  0.6 \\end{bmatrix},\\quad\n    E_2 = \\begin{bmatrix} 0.3  -0.05  0.7 \\end{bmatrix}.\n    $$\n  - Pair energies between residues $(0,1)$:\n    $$\n    E_{01} =\n    \\begin{bmatrix}\n    0.6  0.6  0.6\\\\\n    -1.5  -1.5  -1.5\\\\\n    0.5  0.5  0.5\n    \\end{bmatrix},\n    $$\n    where rows correspond to $r_0\\in\\{0,1,2\\}$ and columns to $r_1\\in\\{0,1,2\\}$.\n  - Pair energies between residues $(0,2)$:\n    $$\n    E_{02} =\n    \\begin{bmatrix}\n    0.7  0.7  0.7\\\\\n    -1.2  -1.2  -1.2\\\\\n    0.4  0.4  0.4\n    \\end{bmatrix}.\n    $$\n  - Pair energies between residues $(1,2)$:\n    $$\n    E_{12} =\n    \\begin{bmatrix}\n    0.5  0.5  0.5\\\\\n    -1.3  -1.3  -1.3\\\\\n    0.6  0.6  0.6\n    \\end{bmatrix}.\n    $$\n  - All other pair energies are defined by symmetry. This case represents a buried active site with strong favorable interactions when specific rotamers align ($r=1$ across residues), and unfavorable interactions otherwise.\n\nExact output format:\n- For each test case, produce a list containing the total number of pruned rotamers (an integer), the GMEC energy in kilocalories per mole rounded to four decimal places (a float), followed by the GMEC rotamer indices for residues $0$ through $N-1$ (integers). The final program output must be a single line containing a list of these per-case lists, in the form\n$$\n\\text{[case\\_1\\_result,case\\_2\\_result,case\\_3\\_result]},\n$$\nwhere each $\\text{case\\_k\\_result}$ is itself a list as described. The program must output only this single line and nothing else.\n\nAngle units do not apply. Energies must be reported in kilocalories per mole rounded to four decimal places (use decimal form, not scientific notation or percentages).",
            "solution": "The problem requires the implementation of the Dead-End Elimination (DEE) algorithm to prune the conformational space of protein side-chains, followed by an exhaustive search to find the Global Minimum Energy Conformation (GMEC). The solution is predicated on a pairwise-additive energy model.\n\nFirst, we establish the theoretical foundation by deriving a valid pruning criterion for DEE. The total energy of a specific conformation, which is an assignment of rotamers $\\mathbf{r}=(r_0, r_1, \\dots, r_{N-1})$ to $N$ residues, is given by:\n$$\nE(\\mathbf{r}) = \\sum_{i=0}^{N-1} E_i(r_i) + \\sum_{0 \\le ij \\le N-1} E_{ij}(r_i, r_j)\n$$\nwhere $E_i(r_i)$ is the self-energy of rotamer $r_i$ at residue $i$, and $E_{ij}(r_i, r_j)$ is the pairwise interaction energy between rotamer $r_i$ at residue $i$ and rotamer $r_j$ at residue $j$.\n\nThe principle of DEE is to identify and eliminate a rotamer that can be proven to not be part of any GMEC. Let us consider a specific residue $i$ and two of its rotamers, $u$ and $v$. We want to determine a condition under which rotamer $u$ at residue $i$ (denoted $i_u$) can be eliminated because rotamer $v$ at residue $i$ ($i_v$) is always a better choice, regardless of the rotamers chosen for all other residues.\n\nLet $\\mathbf{r}_{-i} = (r_0, \\dots, r_{i-1}, r_{i+1}, \\dots, r_{N-1})$ denote a complete rotamer assignment for all residues except $i$. The total energy of a conformation including $i_u$ is $E(i_u, \\mathbf{r}_{-i})$, and one including $i_v$ is $E(i_v, \\mathbf{r}_{-i})$. Rotamer $i_u$ can be definitively eliminated if for a competing rotamer $i_v$, the following is true for all possible choices of $\\mathbf{r}_{-i}$:\n$$\nE(i_u, \\mathbf{r}_{-i})  E(i_v, \\mathbf{r}_{-i})\n$$\nThe energy difference $\\Delta E = E(i_u, \\mathbf{r}_{-i}) - E(i_v, \\mathbf{r}_{-i})$ can be computed by isolating terms dependent on residue $i$:\n$$\n\\Delta E = \\left( E_i(u) + \\sum_{j \\neq i} E_{ij}(u, r_j) \\right) - \\left( E_i(v) + \\sum_{j \\neq i} E_{ij}(v, r_j) \\right)\n$$\nThe terms not involving residue $i$ cancel out. Rearranging the expression gives:\n$$\n\\Delta E = (E_i(u) - E_i(v)) + \\sum_{j \\neq i} \\left( E_{ij}(u, r_j) - E_{ij}(v, r_j) \\right)\n$$\nFor rotamer $i_u$ to be pruned, this energy difference must be strictly positive for all possible valid assignments $\\mathbf{r}_{-i}$. Since we do not know the correct assignment for other residues, we must establish a lower bound on this difference. If the lower bound is greater than zero, the condition holds. Let $R_j$ be the set of currently active (non-pruned) rotamers for residue $j$. We can lower-bound the sum by minimizing each term independently over the choices for $r_j \\in R_j$:\n$$\n\\min_{\\mathbf{r}_{-i}} \\Delta E = (E_i(u) - E_i(v)) + \\sum_{j \\neq i} \\min_{r_j \\in R_j} \\left( E_{ij}(u, r_j) - E_{ij}(v, r_j) \\right)\n$$\nThus, the rigorous condition to prune rotamer $u$ at residue $i$ (given a better rotamer $v$ at the same residue) is:\n$$\nE_i(u) - E_i(v) + \\sum_{j \\neq i} \\min_{r_j \\in R_j} \\left( E_{ij}(u, r_j) - E_{ij}(v, r_j) \\right)  0\n$$\nThis is the single-residue DEE pruning criterion (often called the Goldstein criterion) that will be implemented. A rotamer $i_u$ is a \"dead-end\" if there exists at least one competitor $i_v$ that satisfies this inequality.\n\nThe algorithm proceeds as follows:\n1.  **Initialization**: Start with all rotamers for every residue considered 'active'. Let the set of active rotamers for residue $i$ be $R_i$. The total number of initial rotamers is $\\sum_{i=0}^{N-1} K_i$.\n2.  **Iterative Pruning**:\n    a. Begin an iterative process. In each pass, we check all active rotamers for potential pruning.\n    b. For each residue $i$, and for each pair of its active rotamers $(u, v)$ where $u \\in R_i, v \\in R_i, u \\neq v$, evaluate the DEE criterion.\n    c. If the inequality holds, rotamer $i_u$ is guaranteed to not be in the GMEC relative to rotamer $i_v$. We mark $i_u$ for pruning.\n    d. After checking all rotamers for a residue, and all residues in the system, we collect all rotamers marked for pruning in the pass.\n    e. If any rotamers were marked, we remove them from their respective active sets $R_i$, increment a counter for pruned rotamers, and begin a new pass. The pruning of rotamers in one pass tightens the bounds $\\min_{r_j \\in R_j}(\\dots)$ for subsequent passes, potentially enabling more eliminations.\n    f. If a full pass completes with no rotamers being pruned, the DEE algorithm has converged to a fixed point.\n3.  **GMEC Search**:\n    a. After DEE convergence, the remaining active rotamers form a substantially smaller search space.\n    b. We perform an exhaustive search over this reduced space. All combinations of the remaining active rotamers are generated. For each combination $\\mathbf{r} = (r_0, \\dots, r_{N-1})$ where $r_i \\in R_i$, the total energy $E(\\mathbf{r})$ is calculated.\n    c. The combination yielding the minimum energy is the GMEC. The problem specifies a deterministic tie-breaking rule: if multiple conformations have the same minimum energy, the one with the lexicographically smallest rotamer index vector $(r_0, r_1, \\dots)$ is chosen. This is naturally handled by generating and testing combinations in lexicographical order and only updating the GMEC when a strictly lower energy is found.\n4.  **Reporting**: For each test case, the final result is a list containing the total count of pruned rotamers, the GMEC energy rounded to four decimal places, and the integer indices of the GMEC rotamer assignment. The results from all test cases are then aggregated into a final list. The implementation will use `numpy` for efficient handling of energy matrices and vector operations.",
            "answer": "[[2,-2.7000,0,0,0],[0,-0.1000,0,0,0,0],[6,-4.1500,1,1,1]]"
        },
        {
            "introduction": "Computational design is often complemented by directed evolution, where vast libraries of mutants are screened for improved function. The quality of these libraries is paramount, and this exercise bridges theory and experiment by tackling the problem of \"smart\" library design. You will use constrained optimization to determine the ideal mixture of degenerate codons needed to achieve a target amino acid distribution, a crucial step in preparing for a successful directed evolution campaign while minimizing wasted effort on non-functional variants. ",
            "id": "3839506",
            "problem": "You are designing a library for site-saturation mutagenesis in computational enzyme design and directed evolution. You are given a fixed collection of degenerate codon sets, each defined by an International Union of Pure and Applied Chemistry (IUPAC) nucleotide triplet pattern (for example, $NNK$ with $N \\in \\{A,C,G,T\\}$ and $K \\in \\{G,T\\}$). When sampling a codon from a given degenerate set, assume independent and uniform sampling over the allowed nucleotides at each position. By the Central Dogma of Molecular Biology (DNA to RNA to Protein) and the standard genetic code, each codon deterministically maps to exactly one amino acid or to a stop signal. For each codon set $j$, define a $20$-dimensional amino acid frequency vector $\\mathbf{a}_j$ (over the standard $20$ amino acids) and a stop frequency $s_j$, obtained by enumerating all concrete codons allowed by the degenerate pattern and mapping them via the genetic code under the uniform sampling assumption.\n\nYou want to mix these codon sets with nonnegative weights $\\mathbf{w} \\in \\mathbb{R}^M$ ($M$ is the number of codon sets), constrained by $\\sum_{j=1}^M w_j = 1$, to approximate a target amino acid distribution $\\mathbf{p} \\in \\mathbb{R}^{20}$ while penalizing the expected stop fraction. Let $A \\in \\mathbb{R}^{20 \\times M}$ be the matrix with columns $\\mathbf{a}_j$, and let $\\mathbf{s} \\in \\mathbb{R}^M$ collect $s_j$. The mixture-induced amino acid distribution is $A \\mathbf{w}$ and the expected stop frequency is $\\mathbf{s}^\\top \\mathbf{w}$. For a given nonnegative penalty parameter $\\lambda \\in \\mathbb{R}_{\\ge 0}$, find the optimal mixture by solving the constrained convex optimization\n$$\n\\min_{\\mathbf{w} \\in \\mathbb{R}^M} \\; \\frac{1}{2}\\lVert A\\mathbf{w} - \\mathbf{p}\\rVert_2^2 + \\lambda \\, \\mathbf{s}^\\top \\mathbf{w}\n\\quad \\text{subject to} \\quad\n\\sum_{j=1}^M w_j = 1, \\quad w_j \\ge 0 \\; \\text{for all } j.\n$$\n\nFundamental bases to use:\n- The Central Dogma of Molecular Biology (DNA codons map to amino acids or stop).\n- The standard genetic code is deterministic and well-established.\n- Probability mixture model: if codon set $j$ is chosen with probability $w_j$, then the amino acid distribution is the convex combination $A\\mathbf{w}$ and the stop probability is $\\mathbf{s}^\\top \\mathbf{w}$.\n\nCompute $\\mathbf{a}_j$ and $s_j$ exactly by enumerating all codons in each degenerate set assuming equal probability for each allowed nucleotide at each position.\n\nUse the fixed codon set collection (in this exact order for all computations and outputs): $[NNK, NNS, NDT, VHG, TGG]$. Here, $N$ denotes $\\{A,C,G,T\\}$, $K$ denotes $\\{G,T\\}$, $S$ denotes $\\{G,C\\}$, $D$ denotes $\\{A,G,T\\}$, $V$ denotes $\\{A,C,G\\}$, $H$ denotes $\\{A,C,T\\}$, and each literal nucleotide ($A,C,G,T$) denotes itself.\n\nDefine the amino acid order for all vectors (both targets and outputs) as the list of one-letter codes $[A, C, D, E, F, G, H, I, K, L, M, N, P, Q, R, S, T, V, W, Y]$.\n\nYour program must:\n- Construct $A$ and $\\mathbf{s}$ by exact enumeration using the standard genetic code.\n- For each test case, solve the optimization problem and report the nonnegative weights $\\mathbf{w}$.\n- Also report the expected stop fraction $\\mathbf{s}^\\top \\mathbf{w}$ and the root mean squared error (RMSE) between $A\\mathbf{w}$ and $\\mathbf{p}$, defined as $\\sqrt{\\frac{1}{20}\\sum_{i=1}^{20} ( (A\\mathbf{w})_i - p_i )^2}$.\n\nTest suite:\n- Case $1$ (general case): target uniform distribution $\\mathbf{p}^{(1)}$ with $p^{(1)}_i = \\frac{1}{20}$ for $i=1,\\dots,20$, and $\\lambda^{(1)} = 0.1$.\n- Case $2$ (hydrophobic-enriched boundary-like case): define $\\mathbf{p}^{(2)}$ by setting $p^{(2)}_{\\text{L}} = 0.35$, $p^{(2)}_{\\text{I}} = 0.25$, $p^{(2)}_{\\text{V}} = 0.15$, and distributing the remaining mass $0.25$ equally among the other $17$ amino acids; set $\\lambda^{(2)} = 0.05$.\n- Case $3$ (exactly realizable edge case): tryptophan-only target $\\mathbf{p}^{(3)}$ with $p^{(3)}_{\\text{W}} = 1.0$ and all other entries $0.0$; set $\\lambda^{(3)} = 0.0$.\n- Case $4$ (high stop penalty): uniform target again $\\mathbf{p}^{(4)}$ with $p^{(4)}_i = \\frac{1}{20}$, and $\\lambda^{(4)} = 1000.0$.\n\nAll computations are unitless. Angles are not involved. All fractional answers must be decimal numbers.\n\nFinal output format:\n- For each test case $t \\in \\{1,2,3,4\\}$, produce a list consisting of the mixture weights in the fixed codon-set order $[NNK,NNS,NDT,VHG,TGG]$, followed by the expected stop fraction and the RMSE, all rounded to exactly $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of these per-case lists, enclosed in square brackets. For example, an output with two cases would look like $[[w_{11},w_{12},\\dots,stop_1,rmse_1],[w_{21},w_{22},\\dots,stop_2,rmse_2]]$ with no spaces anywhere.",
            "solution": "The problem presented is a constrained convex optimization task, specifically a Quadratic Program (QP), aimed at finding an optimal mixture of degenerate codon sets to approximate a target amino acid distribution in computational enzyme design. The problem is scientifically and mathematically well-posed and can be solved systematically.\n\nThe core of the problem is to solve the following minimization for the weight vector $\\mathbf{w} \\in \\mathbb{R}^M$:\n$$\n\\min_{\\mathbf{w}} \\; f(\\mathbf{w}) = \\frac{1}{2}\\lVert A\\mathbf{w} - \\mathbf{p}\\rVert_2^2 + \\lambda \\, \\mathbf{s}^\\top \\mathbf{w}\n$$\nsubject to the constraints that the weights form a probability distribution:\n$$\n\\sum_{j=1}^M w_j = 1, \\quad w_j \\ge 0 \\; \\text{for } j = 1, \\ldots, M\n$$\nHere, $M=5$ is the number of codon sets. The matrix $A \\in \\mathbb{R}^{20 \\times M}$ contains the amino acid frequency profiles for each codon set, the vector $\\mathbf{s} \\in \\mathbb{R}^M$ contains the corresponding stop codon frequencies, $\\mathbf{p} \\in \\mathbb{R}^{20}$ is the target amino acid distribution, and $\\lambda \\in \\mathbb{R}_{\\ge 0}$ is a scalar penalty parameter for the stop codon frequency.\n\nThe solution process consists of three main steps:\n1.  Construction of the amino acid frequency matrix $A$ and the stop frequency vector $\\mathbf{s}$.\n2.  Numerical solution of the constrained QP for each test case.\n3.  Calculation of the final metrics: expected stop fraction and Root Mean Squared Error (RMSE).\n\n**Step 1: Construction of Matrix $A$ and Vector $\\mathbf{s}$**\n\nThe components of $A=[\\mathbf{a}_1, \\dots, \\mathbf{a}_M]$ and $\\mathbf{s}=[s_1, \\dots, s_M]^\\top$ must be determined from first principles. This requires enumerating all possible concrete codons for each of the $M=5$ given degenerate codon sets: $[NNK, NNS, NDT, VHG, TGG]$.\n\nThe nucleotide possibilities for each IUPAC code are:\n- $N: \\{A, C, G, T\\}$ (size $4$)\n- $K: \\{G, T\\}$ (size $2$)\n- $S: \\{G, C\\}$ (size $2$)\n- $D: \\{A, G, T\\}$ (size $3$)\n- $V: \\{A, C, G\\}$ (size $3$)\n- $H: \\{A, C, T\\}$ (size $3$)\n- $A, C, G, T$: represent themselves (size $1$)\n\nFor each degenerate codon set $j$, we generate all possible three-nucleotide codons. For example, for $NNK$, the number of distinct codons is $4 \\times 4 \\times 2 = 32$. We assume each of these concrete codons is sampled with uniform probability, i.e., $1/32$.\n\nEach concrete codon is then mapped to one of the $20$ standard amino acids or a stop signal using the standard genetic code. The amino acid order for all vectors is fixed as $[A, C, D, E, F, G, H, I, K, L, M, N, P, Q, R, S, T, V, W, Y]$.\n\nThe $i$-th element of the column vector $\\mathbf{a}_j$, denoted $(\\mathbf{a}_j)_i$, is the frequency of the $i$-th amino acid in the mixture produced by codon set $j$. This is calculated as the number of codons in set $j$ that code for amino acid $i$, divided by the total number of codons in set $j$. Similarly, the stop frequency $s_j$ is the fraction of codons in set $j$ that are stop codons.\n\nThis enumeration is performed for all $M=5$ codon sets to populate the $20 \\times 5$ matrix $A$ and the $5$-dimensional vector $\\mathbf{s}$.\n\n**Step 2: Solving the Quadratic Program**\n\nThe objective function can be expanded into the standard QP form. Let's rewrite the objective function $f(\\mathbf{w})$:\n$$\nf(\\mathbf{w}) = \\frac{1}{2}(A\\mathbf{w} - \\mathbf{p})^\\top(A\\mathbf{w} - \\mathbf{p}) + \\lambda \\mathbf{s}^\\top \\mathbf{w} = \\frac{1}{2}\\mathbf{w}^\\top (A^\\top A) \\mathbf{w} - (\\mathbf{p}^\\top A - \\lambda \\mathbf{s}^\\top)\\mathbf{w} + \\frac{1}{2}\\mathbf{p}^\\top\\mathbf{p}\n$$\nIgnoring the constant term $\\frac{1}{2}\\mathbf{p}^\\top\\mathbf{p}$ which does not affect the minimum's location, the problem is to minimize:\n$$\n\\min_{\\mathbf{w}} \\; \\frac{1}{2}\\mathbf{w}^\\top Q \\mathbf{w} + \\mathbf{c}^\\top \\mathbf{w}\n$$\nwhere $Q = A^\\top A$ is a positive semidefinite matrix, and $\\mathbf{c} = -A^\\top \\mathbf{p} + \\lambda \\mathbf{s}$. The constraints are a linear equality, $\\mathbf{1}^\\top \\mathbf{w} = 1$, and nonnegativity bounds, $w_j \\ge 0$.\n\nThis formulation represents a convex QP, which guarantees that a global minimum exists and can be found efficiently using numerical optimization algorithms. The implementation will use the Sequential Least Squares Programming (SLSQP) method, available in the `scipy.optimize.minimize` library function. This solver requires the objective function, its gradient (Jacobian), and a specification of the constraints and bounds.\n\nThe gradient of the objective function with respect to $\\mathbf{w}$ is:\n$$\n\\nabla_{\\mathbf{w}} f(\\mathbf{w}) = A^\\top(A\\mathbf{w} - \\mathbf{p}) + \\lambda \\mathbf{s}\n$$\nProviding this analytical gradient to the solver improves its accuracy and convergence speed.\n\n**Step 3: Processing Test Cases and Calculating Metrics**\n\nFor each of the four test cases, we define the specific target distribution vector $\\mathbf{p}$ and the penalty parameter $\\lambda$. With $A$ and $\\mathbf{s}$ pre-computed, we execute the SLSQP solver to find the optimal weight vector $\\mathbf{w}_{\\text{opt}}$.\n\nOnce $\\mathbf{w}_{\\text{opt}}$ is found, the required output metrics are calculated:\n1.  The optimal weights $\\mathbf{w}_{\\text{opt}} = [w_1, \\dots, w_5]^\\top$.\n2.  The expected stop fraction: $\\mathbf{s}^\\top \\mathbf{w}_{\\text{opt}}$.\n3.  The Root Mean Squared Error (RMSE) between the resulting amino acid distribution $A\\mathbf{w}_{\\text{opt}}$ and the target $\\mathbf{p}$:\n    $$\n    \\text{RMSE} = \\sqrt{\\frac{1}{20}\\sum_{i=1}^{20} ( (A\\mathbf{w}_{\\text{opt}})_i - p_i )^2} = \\frac{1}{\\sqrt{20}}\\lVert A\\mathbf{w}_{\\text{opt}} - \\mathbf{p} \\rVert_2\n    $$\nThe final program implements this entire procedure, computing $A$ and $\\mathbf{s}$, then iterating through each test case to solve the corresponding QP and report the specified results, formatted as required.",
            "answer": "[[0.551829,0.000000,0.448171,0.000000,0.000000,0.047817,0.012586],[0.000000,0.485149,0.514851,0.000000,0.000000,0.031250,0.052044],[0.000000,0.000000,0.000000,0.000000,1.000000,0.000000,0.000000],[0.000000,0.000000,1.000000,0.000000,0.000000,0.000000,0.023250]]"
        }
    ]
}