{
    "hands_on_practices": [
        {
            "introduction": "真核生物中DNA压缩的第一个层次，是将其缠绕在组蛋白八聚体上形成核小体，构成“串珠”结构。本练习要求您推导核小体重复长度（NRL）与这种10纳米纤维的线性包装密度之间的基本关系。通过这个简单的几何模型，您将对局部参数如何控制基因组的大尺度压缩获得定量的理解。",
            "id": "3853361",
            "problem": "考虑一个低离子强度下的染色质纤维的粗粒度“串珠”模型，其中核小体核心被近似为刚性、不可穿透的球体，而接头脱氧核糖核酸（DNA）片段则被建模为笔直的B型DNA。在此模型中，核小体核心颗粒精确包裹 $147$ 个碱基对（bp）的DNA，并沿纤维贡献一个等于其有效直径 $D$（单位为纳米）的固定几何跨度。B型DNA每碱基对的上升高度为 $r$（单位为纳米/碱基对），在所述条件下假定为常数。核小体重复长度（NRL）定义为每个核小体的平均碱基对数，包括包裹在核心上的 $147$ bp和连续核心之间的平均接头DNA。\n\n从这些定义和几何假设出发，推导平均接头DNA长度与核小体重复长度之间的关系。然后，利用此关系，推导染色质纤维线性包装密度的一个解析表达式。该密度定义为每纳米纤维轮廓长度的碱基对数，并表示为NRL、$D$和$r$的函数。将线性包装密度以碱基对/纳米为单位表示。\n\n你的最终答案必须是线性包装密度关于NRL、$D$和$r$的单个闭式表达式（无需进行数值计算）。不要在最终表达式中包含任何单位。",
            "solution": "该问题要求推导染色质纤维线性包装密度的一个解析表达式，该模型为“串珠”模型，表达式是关于核小体重复长度（NRL）、核小体核心颗粒的有效直径（$D$）以及B型脱氧核糖核酸（DNA）每碱基对的上升高度（$r$）的函数。\n\n该问题陈述已经过验证，被认为是具有科学依据、适定且内部一致的。它基于计算化学生物学和生物物理学中使用的一个标准的、尽管是简化的粗粒度模型。所有必要的参数和定义均已提供。\n\n推导过程分两个主要步骤进行。首先，我们建立给定参数之间的关系。其次，我们利用这些关系来构建线性包装密度的表达式。\n\n让我们根据问题陈述定义变量：\n-   $\\mathrm{NRL}$ 是核小体重复长度，即每个重复单元的总碱基对数（单位为bp）。\n-   $N_{core}$ 是包裹在核小体核心上的碱基对数。它被给定为一个常数，$N_{core} = 147$ bp。\n-   $N_{linker}$ 是一个接头DNA片段中的平均碱基对数。\n-   $D$ 是核小体核心颗粒的有效直径（单位为nm）。\n-   $r$ 是B型DNA每碱基对的上升高度（单位为nm/bp）。\n-   $\\rho$ 是染色质纤维的线性包装密度（单位为bp/nm）。\n\n第一步是将接头DNA的长度（以碱基对为单位）与NRL关联起来。根据定义，NRL是染色质纤维单个重复单元中的总碱基对数，该单元由一个核小体核心和一个接头DNA片段组成。因此，NRL是核心上的碱基对数与接头中的碱基对数之和。\n$$ \\mathrm{NRL} = N_{core} + N_{linker} $$\n鉴于 $N_{core} = 147$ bp，我们可以解出 $N_{linker}$：\n$$ N_{linker} = \\mathrm{NRL} - N_{core} = \\mathrm{NRL} - 147 $$\n这个方程给出了接头片段中平均碱基对数作为NRL的函数。\n\n第二步是推导线性包装密度 $\\rho$ 的表达式。包装密度定义为每单位纤维轮廓长度的总碱基对数。我们可以通过考虑单个重复单元来确定这个比率。\n$$ \\rho = \\frac{\\text{一个重复单元中的总碱基对数}}{\\text{一个重复单元的轮廓长度}} $$\n根据定义，一个重复单元中的总碱基对数是 $\\mathrm{NRL}$。\n$$ \\text{总碱基对数} = \\mathrm{NRL} $$\n一个重复单元的轮廓长度 $L_{unit}$ 是由核小体核心贡献的长度与接头DNA片段的长度之和。根据模型，核小体核心贡献的长度等于其有效直径 $D$。接头DNA被建模为直杆，因此其长度 $L_{linker}$ 是它所包含的碱基对数 $N_{linker}$ 与每碱基对上升高度 $r$ 的乘积。\n$$ L_{linker} = N_{linker} \\times r $$\n因此，该单元的总轮廓长度为：\n$$ L_{unit} = D + L_{linker} $$\n代入 $L_{linker}$ 的表达式：\n$$ L_{unit} = D + (N_{linker} \\times r) $$\n现在，我们代入先前推导的用 $\\mathrm{NRL}$ 表示的 $N_{linker}$ 的表达式：\n$$ L_{unit} = D + (\\mathrm{NRL} - 147)r $$\n最后，我们通过将总碱基对数除以重复单元的总轮廓长度来组合出线性包装密度 $\\rho$ 的表达式：\n$$ \\rho = \\frac{\\mathrm{NRL}}{L_{unit}} = \\frac{\\mathrm{NRL}}{D + (\\mathrm{NRL} - 147)r} $$\n这个最终表达式表示了线性包装密度，单位为碱基对/纳米，是所需变量 $\\mathrm{NRL}$、$D$ 和 $r$ 的函数。",
            "answer": "$$ \\boxed{\\frac{\\mathrm{NRL}}{D + (\\mathrm{NRL} - 147)r}} $$"
        },
        {
            "introduction": "染色质并非一种静态纤维；它被像黏连蛋白（cohesin）复合体这样的分子机器主动重塑，这些分子机器被认为通过一个称为环挤压（loop extrusion）的过程形成DNA环。本练习挑战您应用非平衡态热力学和酶动力学原理来为黏连蛋白马达建模。通过计算在能量和催化限制下的最大挤压速度，您将学习到基本的物理定律如何决定了组织我们基因组的分子引擎的性能。",
            "id": "3853306",
            "problem": "人们认为，黏连蛋白（Cohesin）复合体通过将三磷酸腺苷（ATP）的水解与沿脱氧核糖核酸（DNA）的定向运动耦合，来挤出染色质环。考虑一个机械化学循环，在每个循环中，该复合体沿DNA移动一段轮廓距离 $s$，同时水解 $n$ 个ATP分子。在生理条件下，每个ATP水解释放的自由能为 $|\\Delta G_{\\mathrm{ATP}}|$，并且只有这部分化学自由能的一部分 $\\eta$ 被转化为用于挤出的自由度上的有用机械功。该运动受到一个恒定的外部反向载荷 $F$（例如，由张力或蛋白质障碍物引起）和一个与速度线性相关的耗散力，其特征是有效摩擦系数 $\\gamma$，因此在瞬时速度为 $v$ 时，运动所受的总反向力为 $F+\\gamma v$。假设系统在稳态非平衡条件下运行，其中化学功率输入与克服载荷和摩擦所消耗的机械功率相平衡。此外，在ATP饱和的情况下，机械化学循环的催化转换受到最大循环频率 $k_{\\mathrm{cat}}$ 的限制。\n\n从稳态能量流的第一热力学定律、机械功率的定义 $P_{\\mathrm{mech}}=F_{\\mathrm{tot}}\\,v$ 以及循环频率 $f$ 和速度 $v=s\\,f$ 之间的关系出发，推导出与能量预算和催化速率限制均相符的最大稳态挤出速度 $v_{\\max}$ 的表达式。然后，使用以下在实验上合理的黏连蛋白在DNA上的参数值：\n- $|\\Delta G_{\\mathrm{ATP}}|=80\\,\\mathrm{pN}\\cdot\\mathrm{nm}$，\n- $n=2$，\n- $\\eta=0.40$，\n- $s=30\\,\\mathrm{nm}$ 每个机械化学循环，\n- $F=0.20\\,\\mathrm{pN}$，\n- $\\gamma=0.010\\,\\mathrm{pN}\\cdot\\mathrm{s}\\cdot\\mathrm{nm}^{-1}$，\n- $k_{\\mathrm{cat}}=15\\,\\mathrm{s}^{-1}$，\n\n计算 $v_{\\max}$ 并以千碱基对/秒（kb/s）为单位表示，使用轮廓长度转换关系 $1\\,\\mathrm{bp}=0.34\\,\\mathrm{nm}$。将您的答案四舍五入到三位有效数字。本问题不涉及角度单位。最终报告的值必须是单个实数，单位为 kb/s。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确、客观且内部一致的。它提出了一个分子马达的标准生物物理模型，提供了确定唯一解所需的所有必要参数和关系。\n\n问题要求找到最大稳态挤出速度 $v_{\\max}$。该速度受到两个独立的物理约束：由能量预算（功率平衡）施加的热力学极限，以及由酶的最大催化速率施加的动力学极限。实际的最大速度将是这两个约束所决定的两个速度中较小的一个。\n\n首先，我们建立热力学极限。应用于这个非平衡稳态系统的第一热力学定律规定，化学功率输入必须等于机械功率输出。\n\n化学功率输入 $P_{\\mathrm{in}}$ 是通过ATP水解提供可用化学自由能的速率。每个机械化学循环水解 $n$ 个ATP分子，释放总自由能 $n |\\Delta G_{\\mathrm{ATP}}|$。这部分能量的一部分 $\\eta$ 被转化为有用的机械功。如果循环以频率 $f$ 运行，则可用的功率输入为：\n$$ P_{\\mathrm{in}} = f \\cdot \\eta \\cdot n |\\Delta G_{\\mathrm{ATP}}| $$\n\n机械功率输出 $P_{\\mathrm{mech}}$ 是对抗总反向力 $F_{\\mathrm{tot}}$ 做功的速率。总力是恒定外部载荷 $F$ 和与速度相关的耗散（摩擦）力 $\\gamma v$ 的和。\n$$ F_{\\mathrm{tot}} = F + \\gamma v $$\n机械功率定义为 $P_{\\mathrm{mech}} = F_{\\mathrm{tot}} v$。\n$$ P_{\\mathrm{mech}} = (F + \\gamma v) v $$\n\n在稳态下，功率输入与功率输出相平衡：\n$$ P_{\\mathrm{in}} = P_{\\mathrm{mech}} $$\n$$ f \\eta n |\\Delta G_{\\mathrm{ATP}}| = (F + \\gamma v) v $$\n我们已知线速度 $v$ 和循环频率 $f$ 之间的关系：$v = s f$，其中 $s$ 是每个循环的移动距离。我们可以将 $f = v/s$ 代入能量平衡方程：\n$$ \\left(\\frac{v}{s}\\right) \\eta n |\\Delta G_{\\mathrm{ATP}}| = (F + \\gamma v) v $$\n假设挤出速度不为零（$v > 0$），我们可以将两边同除以 $v$：\n$$ \\frac{\\eta n |\\Delta G_{\\mathrm{ATP}}|}{s} = F + \\gamma v $$\n该方程定义了能量预算所能支持的最大速度 $v_{\\mathrm{thermo}}$。求解 $v$ 可得：\n$$ \\gamma v = \\frac{\\eta n |\\Delta G_{\\mathrm{ATP}}|}{s} - F $$\n$$ v_{\\mathrm{thermo}} = \\frac{1}{\\gamma} \\left( \\frac{\\eta n |\\Delta G_{\\mathrm{ATP}}|}{s} - F \\right) $$\n\n其次，我们建立动力学极限。马达的催化循环具有一个内在的最大频率 $k_{\\mathrm{cat}}$。这限制了循环频率 $f$ 使得 $f \\le k_{\\mathrm{cat}}$。这对速度施加了一个硬性限制 $v_{\\mathrm{kin}}$，它就是每个循环的移动距离乘以最大循环频率：\n$$ v_{\\mathrm{kin}} = s \\cdot k_{\\mathrm{cat}} $$\n\n真正的最大稳态速度 $v_{\\max}$ 必须同时满足热力学和动力学约束。因此，它是计算出的两个速度中的最小值：\n$$ v_{\\max} = \\min(v_{\\mathrm{thermo}}, v_{\\mathrm{kin}}) = \\min\\left( \\frac{1}{\\gamma} \\left( \\frac{\\eta n |\\Delta G_{\\mathrm{ATP}}|}{s} - F \\right), s k_{\\mathrm{cat}} \\right) $$\n\n现在，我们代入给定的数值：\n- $|\\Delta G_{\\mathrm{ATP}}| = 80\\,\\mathrm{pN}\\cdot\\mathrm{nm}$\n- $n = 2$\n- $\\eta = 0.40$\n- $s = 30\\,\\mathrm{nm}$\n- $F = 0.20\\,\\mathrm{pN}$\n- $\\gamma = 0.010\\,\\mathrm{pN}\\cdot\\mathrm{s}\\cdot\\mathrm{nm}^{-1}$\n- $k_{\\mathrm{cat}} = 15\\,\\mathrm{s}^{-1}$\n\n我们计算 $v_{\\mathrm{thermo}}$：\n$$ v_{\\mathrm{thermo}} = \\frac{1}{0.010} \\left( \\frac{0.40 \\cdot 2 \\cdot 80}{30} - 0.20 \\right) \\,\\frac{\\mathrm{nm}}{\\mathrm{s}} $$\n$$ v_{\\mathrm{thermo}} = 100 \\left( \\frac{64}{30} - 0.20 \\right) \\,\\frac{\\mathrm{nm}}{\\mathrm{s}} $$\n$$ v_{\\mathrm{thermo}} = 100 \\left( \\frac{32}{15} - \\frac{1}{5} \\right) \\,\\frac{\\mathrm{nm}}{\\mathrm{s}} = 100 \\left( \\frac{32 - 3}{15} \\right) \\,\\frac{\\mathrm{nm}}{\\mathrm{s}} $$\n$$ v_{\\mathrm{thermo}} = 100 \\left( \\frac{29}{15} \\right) \\,\\frac{\\mathrm{nm}}{\\mathrm{s}} = \\frac{2900}{15} \\,\\frac{\\mathrm{nm}}{\\mathrm{s}} = \\frac{580}{3} \\,\\frac{\\mathrm{nm}}{\\mathrm{s}} \\approx 193.33\\,\\frac{\\mathrm{nm}}{\\mathrm{s}} $$\n\n接下来，我们计算 $v_{\\mathrm{kin}}$：\n$$ v_{\\mathrm{kin}} = (30\\,\\mathrm{nm}) \\cdot (15\\,\\mathrm{s}^{-1}) = 450\\,\\frac{\\mathrm{nm}}{\\mathrm{s}} $$\n\n比较这两个极限：\n$$ v_{\\max} = \\min\\left( \\frac{580}{3}\\,\\frac{\\mathrm{nm}}{\\mathrm{s}}, 450\\,\\frac{\\mathrm{nm}}{\\mathrm{s}} \\right) = \\frac{580}{3}\\,\\frac{\\mathrm{nm}}{\\mathrm{s}} $$\n系统受限于热力学能量预算，而非催化转换率。\n\n最后一步是将这个速度从 $\\mathrm{nm}/\\mathrm{s}$ 转换为千碱基对/秒 (kb/s)。我们已知转换因子 $1\\,\\mathrm{bp} = 0.34\\,\\mathrm{nm}$，这意味着 $1\\,\\mathrm{nm} = \\frac{1}{0.34}\\,\\mathrm{bp}$。\n$$ v_{\\max} = \\frac{580}{3} \\frac{\\mathrm{nm}}{\\mathrm{s}} \\times \\frac{1\\,\\mathrm{bp}}{0.34\\,\\mathrm{nm}} = \\frac{580}{3 \\cdot 0.34} \\frac{\\mathrm{bp}}{\\mathrm{s}} = \\frac{580}{1.02} \\frac{\\mathrm{bp}}{\\mathrm{s}} \\approx 568.627\\,\\frac{\\mathrm{bp}}{\\mathrm{s}} $$\n要从 bp/s 转换为 kb/s，我们除以 $1000$：\n$$ v_{\\max} \\approx \\frac{568.627}{1000} \\frac{\\mathrm{kb}}{\\mathrm{s}} \\approx 0.568627\\,\\frac{\\mathrm{kb}}{\\mathrm{s}} $$\n将结果四舍五入到三位有效数字，得到 $0.569\\,\\mathrm{kb}/\\mathrm{s}$。",
            "answer": "$$\n\\boxed{0.569}\n$$"
        },
        {
            "introduction": "在兆碱基（megabase）尺度上，基因组被分割成称为拓扑关联结构域（TADs）的自我互作区域，这对于基因调控至关重要。这些结构域由限制跨域相互作用的边界隔开。本练习使用一个简化的概率模型来探索TAD边界的完整性如何影响基因组接触的模式。通过推导结构域内与结构域间接触比例作为边界“泄漏”程度的函数，您将深入了解基因组结构是如何被定量地编码在接触频率图谱（例如来自Hi-C实验的图谱）中的。",
            "id": "3853333",
            "problem": "考虑一个用于描述基因组区间之间染色质接触的粗粒度概率模型，该模型旨在捕捉两个拓扑关联域（TADs）之间边界减弱所产生的影响。设有 $2$ 个不相交的域 $A$ 和 $B$，它们分别包含 $n_A$ 和 $n_B$ 个区间，其中 $n_A \\geq 2$ 且 $n_B \\geq 2$。定义一个对称的预归一化接触倾向矩阵 $\\tilde{C}(\\lambda) \\in \\mathbb{R}^{N \\times N}$，其中 $N = n_A + n_B$，如下所示：\n- 对于同一域内的区间 $i$ 和 $j$（$i \\neq j$），设置 $\\tilde{C}_{ij}(\\lambda) = w$，其中 $w > 0$ 是一个基线域内亲和力。\n- 对于不同域内的区间 $i$ 和 $j$，设置 $\\tilde{C}_{ij}(\\lambda) = \\lambda w$，其中 $\\lambda \\in [0,1]$ 是一个可调泄漏参数，随着边界的减弱，该参数会增加域间倾向。\n- 对于 $i = j$ 的情况，设置 $\\tilde{C}_{ii}(\\lambda) = 0$ 以排除自我接触。\n\n假设每个位点的接触预算是守恒的，通过行归一化构建一个行随机接触概率矩阵 $P(\\lambda)$，\n$$\nP_{ij}(\\lambda) = \\frac{\\tilde{C}_{ij}(\\lambda)}{\\sum_{k \\neq i} \\tilde{C}_{ik}(\\lambda)}.\n$$\n将域内接触分数 $F_{\\mathrm{intra}}(\\lambda)$ 定义为发生在域内的总归一化接触占的比例，并对所有行取平均：\n$$\nF_{\\mathrm{intra}}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathbf{1}\\{\\text{$i$ 和 $j$ 在同一域内}\\} \\, P_{ij}(\\lambda).\n$$\n通过 $F_{\\mathrm{inter}}(\\lambda) = 1 - F_{\\mathrm{intra}}(\\lambda)$ 定义域间接触分数 $F_{\\mathrm{inter}}(\\lambda)$。仅使用概率守恒、构造的对称性以及上述定义，推导比率\n$$\nR(\\lambda) = \\frac{F_{\\mathrm{intra}}(\\lambda)}{F_{\\mathrm{inter}}(\\lambda)}\n$$\n作为 $n_A$、$n_B$ 和 $\\lambda$ 的函数的闭式解析表达式。以单一简化的解析表达式形式给出最终答案。不需要进行数值近似。",
            "solution": "用户希望我通过提供对问题陈述的形式化推导来解决该问题。\n\n### 步骤1：提取已知条件\n- **域**：$2$ 个不相交的域 $A$ 和 $B$。\n- **区间数量**：域 $A$ 中有 $n_A$ 个，域 $B$ 中有 $n_B$ 个。\n- **约束条件**：$n_A \\geq 2$，$n_B \\geq 2$。\n- **总区间数**：$N = n_A + n_B$。\n- **预归一化接触倾向矩阵**：$\\tilde{C}(\\lambda) \\in \\mathbb{R}^{N \\times N}$。\n  - 对于同一域中的 $i, j$ 且 $i \\neq j$：$\\tilde{C}_{ij}(\\lambda) = w$。\n  - 对于不同域中的 $i, j$：$\\tilde{C}_{ij}(\\lambda) = \\lambda w$。\n  - $\\tilde{C}_{ii}(\\lambda) = 0$。\n- **参数**：$w > 0$，$\\lambda \\in [0,1]$。\n- **归一化接触概率矩阵**：$P_{ij}(\\lambda) = \\frac{\\tilde{C}_{ij}(\\lambda)}{\\sum_{k \\neq i} \\tilde{C}_{ik}(\\lambda)}$。\n- **域内接触分数**：$F_{\\mathrm{intra}}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathbf{1}\\{\\text{$i$ 和 $j$ 在同一域内}\\} \\, P_{ij}(\\lambda)$。\n- **域间接触分数**：$F_{\\mathrm{inter}}(\\lambda) = 1 - F_{\\mathrm{intra}}(\\lambda)$。\n- **目标量**：比率 $R(\\lambda) = \\frac{F_{\\mathrm{intra}}(\\lambda)}{F_{\\mathrm{inter}}(\\lambda)}$。\n\n### 步骤2：使用提取的已知条件进行验证\n这是一个定义明确的数学练习，基于染色质组织的一个简化、粗粒度模型，这是计算生物学中的标准做法。拓扑关联域（TADs）、接触矩阵和归一化的概念在该领域是标准的。所有变量、参数和函数都得到了明确无歧义的定义。约束条件是一致的，整个设置是自洽的。该问题不违反科学原理（因为它是一个模型），不基于错误的前提，是可形式化的，并且并非微不足道。它需要基于所提供的定义进行系统推导。因此，该问题被认定为有效。\n\n### 步骤3：结论与行动\n该问题有效。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n我们的目标是推导 $R(\\lambda) = \\frac{F_{\\mathrm{intra}}(\\lambda)}{F_{\\mathrm{inter}}(\\lambda)}$ 的闭式表达式。我们将首先根据定义推导 $F_{\\mathrm{intra}}(\\lambda)$ 和 $F_{\\mathrm{inter}}(\\lambda)$ 的表达式。\n\n首先，我们计算 $P_{ij}(\\lambda)$ 归一化因子的分母，即预归一化矩阵 $\\tilde{C}(\\lambda)$ 第 $i$ 行的和。设这个和为 $S_i = \\sum_{k \\neq i} \\tilde{C}_{ik}(\\lambda)$。$S_i$ 的值取决于区间 $i$ 属于哪个域。\n\n如果区间 $i$ 在域 $A$ 中，它与域 $A$ 内的另外 $n_A-1$ 个区间有潜在接触（倾向为 $w$），与域 $B$ 内的 $n_B$ 个区间有潜在接触（倾向为 $\\lambda w$）。\n对于任何 $i \\in A$，行和为：\n$$\nS_A = \\sum_{k \\in A, k \\neq i} w + \\sum_{k \\in B} \\lambda w = (n_A - 1)w + n_B \\lambda w = w((n_A - 1) + n_B \\lambda)\n$$\n类似地，如果区间 $i$ 在域 $B$ 中，它与域 $B$ 内的另外 $n_B-1$ 个区间有潜在接触（倾向为 $w$），与域 $A$ 内的 $n_A$ 个区间有潜在接触（倾向为 $\\lambda w$）。\n对于任何 $i \\in B$，行和为：\n$$\nS_B = \\sum_{k \\in B, k \\neq i} w + \\sum_{k \\in A} \\lambda w = (n_B - 1)w + n_A \\lambda w = w((n_B - 1) + n_A \\lambda)\n$$\n现在，我们可以表示归一化矩阵 $P(\\lambda)$ 的元素。对于 $i \\neq j$：\n$$\nP_{ij}(\\lambda) =\n\\begin{cases}\nw/S_A = \\frac{1}{(n_A-1)+n_B\\lambda}  \\text{若 } i \\in A, j \\in A \\\\\n\\lambda w/S_A = \\frac{\\lambda}{(n_A-1)+n_B\\lambda}  \\text{若 } i \\in A, j \\in B \\\\\nw/S_B = \\frac{1}{(n_B-1)+n_A\\lambda}  \\text{若 } i \\in B, j \\in B \\\\\n\\lambda w/S_B = \\frac{\\lambda}{(n_B-1)+n_A\\lambda}  \\text{若 } i \\in B, j \\in A\n\\end{cases}\n$$\n接下来，我们计算 $F_{\\mathrm{intra}}(\\lambda)$。其定义为 $F_{\\mathrm{intra}}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^{N} \\sum_{j \\in \\text{domain}(i), j \\neq i} P_{ij}(\\lambda)$。我们将内层和表示为 $P_{\\mathrm{intra}}(i) = \\sum_{j \\in \\text{domain}(i), j \\neq i} P_{ij}(\\lambda)$。\n\n对于 $i \\in A$，这个和中有 $n_A-1$ 项，每一项都等于 $w/S_A$：\n$$\nP_{\\mathrm{intra}}(i \\in A) = (n_A - 1) \\frac{w}{S_A} = (n_A - 1) \\frac{w}{w((n_A-1)+n_B\\lambda)} = \\frac{n_A-1}{(n_A-1)+n_B\\lambda}\n$$\n对于 $i \\in B$，这个和中有 $n_B-1$ 项，每一项都等于 $w/S_B$：\n$$\nP_{\\mathrm{intra}}(i \\in B) = (n_B - 1) \\frac{w}{S_B} = (n_B - 1) \\frac{w}{w((n_B-1)+n_A\\lambda)} = \\frac{n_B-1}{(n_B-1)+n_A\\lambda}\n$$\n$F_{\\mathrm{intra}}(\\lambda)$ 是 $P_{\\mathrm{intra}}(i)$ 在所有 $N = n_A + n_B$ 个区间上的平均值。我们对域 $A$ 中的 $n_A$ 个区间和域 $B$ 中的 $n_B$ 个区间求和：\n$$\nF_{\\mathrm{intra}}(\\lambda) = \\frac{1}{n_A + n_B} \\left( \\sum_{i \\in A} P_{\\mathrm{intra}}(i \\in A) + \\sum_{i \\in B} P_{\\mathrm{intra}}(i \\in B) \\right)\n$$\n$$\nF_{\\mathrm{intra}}(\\lambda) = \\frac{1}{n_A + n_B} \\left( n_A \\left( \\frac{n_A-1}{(n_A-1)+n_B\\lambda} \\right) + n_B \\left( \\frac{n_B-1}{(n_B-1)+n_A\\lambda} \\right) \\right)\n$$\n类似地，我们计算 $F_{\\mathrm{inter}}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^{N} \\sum_{j \\notin \\text{domain}(i)} P_{ij}(\\lambda)$。设内层和为 $P_{\\mathrm{inter}}(i)$。\n\n对于 $i \\in A$，有 $n_B$ 项对应于 $j \\in B$，每一项都等于 $\\lambda w/S_A$：\n$$\nP_{\\mathrm{inter}}(i \\in A) = n_B \\frac{\\lambda w}{S_A} = n_B \\frac{\\lambda w}{w((n_A-1)+n_B\\lambda)} = \\frac{n_B\\lambda}{(n_A-1)+n_B\\lambda}\n$$\n对于 $i \\in B$，有 $n_A$ 项对应于 $j \\in A$，每一项都等于 $\\lambda w/S_B$：\n$$\nP_{\\mathrm{inter}}(i \\in B) = n_A \\frac{\\lambda w}{S_B} = n_A \\frac{\\lambda w}{w((n_B-1)+n_A\\lambda)} = \\frac{n_A\\lambda}{(n_B-1)+n_A\\lambda}\n$$\n注意，对于任何 $i$，$P_{\\mathrm{intra}}(i) + P_{\\mathrm{inter}}(i) = 1$，这证实了每一行的概率守恒。将 $P_{\\mathrm{inter}}(i)$ 对所有区间取平均：\n$$\nF_{\\mathrm{inter}}(\\lambda) = \\frac{1}{n_A + n_B} \\left( n_A \\left( \\frac{n_B\\lambda}{(n_A-1)+n_B\\lambda} \\right) + n_B \\left( \\frac{n_A\\lambda}{(n_B-1)+n_A\\lambda} \\right) \\right)\n$$\n现在我们可以计算比率 $R(\\lambda) = \\frac{F_{\\mathrm{intra}}(\\lambda)}{F_{\\mathrm{inter}}(\\lambda)}$。分子和分母中的因子 $\\frac{1}{n_A + n_B}$ 会消掉。\n$$\nR(\\lambda) = \\frac{n_A \\left( \\frac{n_A-1}{(n_A-1)+n_B\\lambda} \\right) + n_B \\left( \\frac{n_B-1}{(n_B-1)+n_A\\lambda} \\right)}{n_A \\left( \\frac{n_B\\lambda}{(n_A-1)+n_B\\lambda} \\right) + n_B \\left( \\frac{n_A\\lambda}{(n_B-1)+n_A\\lambda} \\right)}\n$$\n分母可以通过提取公因式 $n_A n_B \\lambda$ 来简化：\n$$\n\\text{Denominator} = n_A n_B \\lambda \\left( \\frac{1}{(n_A-1)+n_B\\lambda} + \\frac{1}{(n_B-1)+n_A\\lambda} \\right)\n$$\n为了简化整个分数，我们将分子和分母中的各项合并到一个公分母 $D = ((n_A-1)+n_B\\lambda)((n_B-1)+n_A\\lambda)$ 上。\n\n对于 $R(\\lambda)$ 的分子：\n$$\n\\text{Num}[R] = \\frac{n_A(n_A-1)((n_B-1)+n_A\\lambda) + n_B(n_B-1)((n_A-1)+n_B\\lambda)}{D}\n$$\n对于 $R(\\lambda)$ 的分母：\n$$\n\\text{Den}[R] = \\frac{n_A n_B \\lambda ((n_B-1)+n_A\\lambda) + n_B n_A \\lambda ((n_A-1)+n_B\\lambda)}{D}\n$$\n当我们取比率时，项 $D$ 被消掉了。\n$$\nR(\\lambda) = \\frac{n_A(n_A-1)((n_B-1)+n_A\\lambda) + n_B(n_B-1)((n_A-1)+n_B\\lambda)}{n_A n_B \\lambda ((n_B-1)+n_A\\lambda + (n_A-1)+n_B\\lambda)}\n$$\n简化总分母中括号内的项：\n$$\n(n_B-1)+n_A\\lambda + (n_A-1)+n_B\\lambda = (n_A+n_B-2) + (n_A+n_B)\\lambda\n$$\n将此代回，得到最终的闭式表达式：\n$$\nR(\\lambda) = \\frac{n_A(n_A-1)((n_B-1)+n_A\\lambda) + n_B(n_B-1)((n_A-1)+n_B\\lambda)}{n_A n_B \\lambda (n_A+n_B-2 + (n_A+n_B)\\lambda)}\n$$\n这个表达式是作为 $n_A$、$n_B$ 和 $\\lambda$ 的函数的完整解析结果。",
            "answer": "$$\n\\boxed{\\frac{n_A(n_A-1)((n_B-1)+n_A\\lambda) + n_B(n_B-1)((n_A-1)+n_B\\lambda)}{n_A n_B \\lambda (n_A+n_B-2 + (n_A+n_B)\\lambda)}}\n$$"
        }
    ]
}