{
    "hands_on_practices": [
        {
            "introduction": "伞形采样的成功在很大程度上取决于反应坐标的明智选择。一个好的反应坐标应能捕捉到过程中的慢自由度，并能明确区分反应物、过渡态和产物。本练习  旨在培养您对反应坐标选择的批判性思维，通过评估一个常见的坐标——均方根偏差 (RMSD)——在不同生物物理场景下的适用性，来深化您对这一核心概念的理解。",
            "id": "2466503",
            "problem": "您计划使用伞形采样来计算蛋白质构象过程沿一维反应坐标的平均力势。所提出的反应坐标是与给定天然结构的均方根偏差 (RMSD)，其定义为：在将构型 $\\mathbf{x}$ 与天然坐标 $\\{\\mathbf{r}_i^\\mathrm{nat}\\}_{i=1}^N$ 进行最佳刚体叠加后，\n$$\n\\mathrm{RMSD}(\\mathbf{x}) \\equiv \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left\\|\\mathbf{r}_i(\\mathbf{x})-\\mathbf{r}_i^\\mathrm{nat}\\right\\|^2},\n$$\n其中 $N$ 是选择用于比对的原子数。伞形采样将对以 $q=\\mathrm{RMSD}$ 的值 $q_0$ 为中心的窗口施加一个谐波偏置 $U_\\mathrm{bias}(q)=\\tfrac{1}{2}k\\,(q-q_0)^2$。哪个选项正确地将使用 $\\mathrm{RMSD}$ 作为绝佳反应坐标的情景与使用 $\\mathrm{RMSD}$ 作为糟糕反应坐标的情景配对？\n\nA. 绝佳：在水溶剂中一个小的、设计的、双态微型蛋白质的折叠，其折叠进程主要由天然主链氢键和天然接触的形成主导，并且在固定的 $\\mathrm{RMSD}$ 下，非天然侧链重排能快速平衡。糟糕：一个大的双结构域酶的变构开放↔闭合转变，涉及多个准刚体铰链旋转和环门控，其中不同的中间体与天然态有相似的 $\\mathrm{RMSD}$，且环的开放/闭合很慢。\n\nB. 绝佳：配体与球状蛋白的深口袋结合，使用蛋白质主链相对于配体结合构象的 $\\mathrm{RMSD}$ 作为反应坐标。糟糕：在隐式溶剂中一个孤立的α-螺旋肽的去折叠，使用主链 $C_\\alpha$ 相对于天然螺旋的 $\\mathrm{RMSD}$。\n\nC. 绝佳：在水中折叠一个β-发夹，其路径上链寄存移位和错位发夹很常见。糟糕：在一个紧密堆积的核心中，一个埋藏的侧链旋转异构体在两个 $\\chi_1$ 态之间的异构化，其主链运动可忽略不计。\n\nD. 绝佳：刚体配体结合，其中蛋白质基本保持天然样构象，只有配体平移和旋转进入口袋，使用蛋白质相对于配体结合构象的 $\\mathrm{RMSD}$ 作为坐标。糟糕：一个小肽中的单二面角异构化，其中一个主链二面角在两个极小值之间翻转，而其他自由度快速弛豫。",
            "solution": "首先将对问题陈述的科学合理性、清晰度和完整性进行验证。\n\n**步骤1：提取已知条件**\n\n*   **方法论：**使用伞形采样计算一维平均力势 (PMF)。\n*   **过程：**蛋白质构象过程。\n*   **反应坐标 ($q$)：**与给定天然结构的均方根偏差 (RMSD)，$q = \\mathrm{RMSD}$。\n*   **RMSD 定义：**$\\mathrm{RMSD}(\\mathbf{x}) \\equiv \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left\\|\\mathbf{r}_i(\\mathbf{x})-\\mathbf{r}_i^\\mathrm{nat}\\right\\|^2}$，在将构型 $\\mathbf{x}$ 与参考结构 $\\{\\mathbf{r}_i^\\mathrm{nat}\\}$ 进行最佳刚体叠加后计算得出。\n*   **伞形偏置势：**反应坐标的谐波函数，$U_\\mathrm{bias}(q)=\\tfrac{1}{2}k\\,(q-q_0)^2$。\n*   **目标：**确定哪个选项正确地将 RMSD 作为“绝佳”反应坐标的情景与作为“糟糕”反应坐标的情景配对。\n\n**步骤2：使用提取的已知条件进行验证**\n\n1.  **科学基础：**该问题牢固地定位于计算化学和生物物理学领域。伞形采样、平均力势、反应坐标和均方根偏差都是标准的、定义明确的概念。RMSD 的数学公式是正确的。所提出的偏置势是伞形采样中最常用的形式。该问题在科学上是合理的。\n2.  **良态性：**反应坐标的质量是稀有事件研究中的一个核心课题。一个“好”或“绝佳”的反应坐标通常被理解为能够捕捉过程中缓慢的、限速的运动，从反应物到产物单调递进，并且对于过渡态系综具有唯一值。一个“坏”或“糟糕”的坐标是未能满足这些标准的坐标，例如，通过简并（多个不同状态映射到相同的坐标值）或与实际的慢动力学正交。因此，这个问题是良态的，要求基于这些既定原则进行专家判断。\n3.  **客观性：**虽然“绝佳”和“糟糕”是定性术语，但在增强采样模拟的反应坐标分析背景下，它们具有精确、客观的含义。该问题不包含主观或基于观点的论断。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。它具有科学基础，是良态的、客观的，并包含足够的信息来进行严谨的分析。\n\n**反应坐标质量原则的推导**\n\n沿着反应坐标 $q$ 计算平均力势 $W(q)$ 的目标是理解构象转变的自由能形貌。$W(q)$ 的有效性关键取决于 $q$ 的选择。根据过渡态理论的描述，一个理想的反应坐标应该是穿过势能面上过渡态鞍点，并在该点与所有其他自由度正交的坐标。在实践中，对于复杂系统，一个“好”的反应坐标 $q$ 必须满足几个标准：\n\n1.  **状态区分：**它必须能清楚地区分反应物、过渡态和产物态。这些状态应对应于 $q$ 的不同取值范围。\n2.  **单调性：**该坐标在整个转变过程中应平均地单调递进。\n3.  **动力学相关性：**该坐标必须捕捉到过程中最慢的、限速的自由度。所有与 $q$ 正交的其他自由度必须在快得多的时间尺度上弛豫。如果存在其他未被 $q$ 描述的慢运动，采样效率会很低，并且模拟将表现出滞后现象，即前向和后向的 PMF 曲线不一致。这是一个坏反应坐标的标志。\n\n所提出的反应坐标的一个常见失败模式是**简并**，即结构上和机理上不同的状态对应于坐标 $q$ 的相同值。这导致在 PMF 中对这些状态进行人为平均，从而掩盖了真实的反应路径和能垒。\n\n如其定义，RMSD 是与单个参考态结构相似性的全局度量。其作为反应坐标的适宜性高度依赖于具体情境。当过程是简单地、协同地偏离（或接近）参考结构时，它是有效的。当过程复杂，涉及无法被全局度量很好捕捉的子部分运动，或者当不同中间体可以具有相似的 RMSD 值时，它就会失效。\n\n**逐项分析**\n\n**A. 绝佳：在水溶剂中一个小的、设计的、双态微型蛋白质的折叠，其折叠进程主要由天然主链氢键和天然接触的形成主导，并且在固定的 $\\mathrm{RMSD}$ 下，非天然侧链重排能快速平衡。糟糕：一个大的双结构域酶的变构开放↔闭合转变，涉及多个准刚体铰链旋转和环门控，其中不同的中间体与天然态有相似的 $\\mathrm{RMSD}$，且环的开放/闭合很慢。**\n\n*   **“绝佳”情景分析：**根据定义，一个小的、双态蛋白质的折叠没有显著的、长寿命的中间态。该过程可以理想化为从未折叠系综到天然态的直接转变。天然接触的逐步形成可以通过与天然结构之间减小的 RMSD 直接且单调地测量。明确指出其他自由度（“非天然侧链重排”）在固定 RMSD 值下能快速平衡的条件，恰恰是良好反应坐标的要求。因此，在这种理想化的情景下，RMSD 是一个绝佳的选择。\n*   **“糟糕”情景分析：**涉及铰链旋转的变构转变是全局 RMSD 失效的经典例子。其基本运动是两个准刚性结构域相对取向的变化，这可能不会引起全局 RMSD 的巨大变化。此外，问题陈述“不同的中间体与天然态有相似的 RMSD”，这是一个致命的简并。它还指出“环的开放/闭合很慢”，意味着至少存在另一个不受伞形势控制的慢自由度。这将导致严重的采样问题（滞后现象）。对于这个过程，全局 RMSD 是一个糟糕的坐标。\n*   **结论：**此选项正确地指出了 RMSD 作为反应坐标的理想用例和经典失败案例。**正确**。\n\n**B. 绝佳：配体与球状蛋白的深口袋结合，使用蛋白质主链相对于配体结合构象的 $\\mathrm{RMSD}$ 作为反应坐标。糟糕：在隐式溶剂中一个孤立的α-螺旋肽的去折叠，使用主链 $C_\\alpha$ 相对于天然螺旋的 $\\mathrm{RMSD}$。**\n\n*   **“绝佳”情景分析：**配体结合的主要过程是配体相对于蛋白质的位置和方向的变化。虽然蛋白质可能会发生构象变化（诱导契合），但仅使用蛋白质主链 RMSD 作为反应坐标是间接且低效的。关键的慢坐标是配体接近结合位点的过程。蛋白质的 RMSD 无法控制这一点。这是一个差的选择，而不是绝佳的选择。\n*   **“糟糕”情景分析：**对于像α-螺旋这样的简单结构单元的去折叠，与天然螺旋态的 RMSD 通常是一个合理但不完美的反应坐标。去折叠的过程（例如，从末端开始散开）通常与 RMSD 的增加相关。虽然其他坐标如天然氢键的数量可能更好，但 RMSD 并非一个“糟糕”的选择，并且在这类研究中经常被使用。\n*   **结论：**“绝佳”情景构思不佳，“糟糕”情景也未必糟糕。**不正确**。\n\n**C. 绝佳：在水中折叠一个β-发夹，其路径上链寄存移位和错位发夹很常见。糟糕：在一个紧密堆积的核心中，一个埋藏的侧链旋转异构体在两个 $\\chi_1$ 态之间的异构化，其主链运动可忽略不计。**\n\n*   **“绝佳”情景分析：**一个可以形成错位结构的β-发夹是 RMSD 失效的经典例子。一个错位发夹可以很紧凑，并且具有与部分形成的、正确配对的发夹相似的低 RMSD 值。这种简并性使 RMSD 成为一个差的坐标，因为它无法区分路径上状态和被捕获的脱靶状态。这种情景对于使用 RMSD 来说是糟糕的，而不是绝佳的。\n*   **“糟糕”情景分析：**单个侧链二面角 ($\\chi_1$) 的异构化是一个高度局域化的事件。由这单个翻转引起的蛋白质全局 RMSD 的变化将非常小，可能小于主链的热涨落。用全局 RMSD 坐标驱动这样一个过程效率极低，信噪比非常低。二面角本身是显而易见且正确的坐标。使用 RMSD 确实是一个糟糕的选择。\n*   **结论：**所描述的“绝佳”情景实际上是一个糟糕的情景。**不正确**。\n\n**D. 绝佳：刚体配体结合，其中蛋白质基本保持天然样构象，只有配体平移和旋转进入口袋，使用蛋白质相对于配体结合构象的 $\\mathrm{RMSD}$ 作为坐标。糟糕：一个小肽中的单二面角异构化，其中一个主链二面角在两个极小值之间翻转，而其他自由度快速弛豫。**\n\n*   **“绝佳”情景分析：**这个情景是荒谬的。如果蛋白质保持“基本天然样”，其相对于天然（配体结合）结构的 RMSD 将保持接近于零，并且在整个结合过程中不会改变。一个不变化的坐标无法描述一个过程。它没有动态范围，不能用来驱动系统从未结合态到结合态。这是一个不可能且糟糕的选择，而不是绝佳的选择。\n*   **“糟糕”情景分析：**与选项 C 中的情况类似，单个二面角翻转是一个局域化事件。全局 RMSD 坐标与此局部运动的耦合很差，用来采样该转变将非常低效。二面角本身才是合适的坐标。在这里使用全局 RMSD 是一个糟糕的选择。\n*   **结论：**“绝佳”情景存在根本性缺陷，描述了一个无效的反应坐标。**不正确**。\n\n**总结**\n\n只有选项 A 正确地将 RMSD 是一个合适且有效的反应坐标的情景与一个因简并性和存在正交慢自由度而存在根本缺陷的情景配对。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一旦选定了反应坐标，下一步就是设计具体的伞形窗口参数，以确保对整个坐标范围进行有效采样。这包括确定施加在每个窗口上的谐波偏置势的力常数 ($k$) 和相邻窗口中心之间的间距 ($\\Delta\\xi$)。这个计算练习  将指导您如何基于自由能面的局部曲率和期望的采样宽度来定量地确定这些关键参数，这是确保模拟效率和数据质量的根本步骤。",
            "id": "3827385",
            "problem": "在一维反应坐标 $\\xi$ 的伞形采样 (US) 中，在窗口中心 $\\xi_{0}$ 附近施加一个谐波偏置 $U_{b}(\\xi;\\xi_{0})=\\frac{1}{2}\\,k\\,(\\xi-\\xi_{0})^{2}$，以促进对平均力势 (PMF) 的采样。假设在温度 $T$ 下为正则系综，并且在 $\\xi_{0}$ 附近的无偏置 PMF 局部是二次的：$F(\\xi)\\approx F(\\xi_{0})+\\frac{1}{2}\\,\\kappa\\,(\\xi-\\xi_{0})^{2}$，其中 $\\kappa$ 是 PMF 相对于 $\\xi$ 的局域曲率（二阶导数）。忽略高于二次的项以及 $\\kappa$ 在窗口内的任何空间变化。将 $\\xi$ 视为单位为纳米的一维类笛卡尔坐标。\n\n你的任务是设计谐波偏置，以使 $\\xi$ 达到预设的窗口内采样宽度（标准差）$\\sigma$。具体而言：\n- 选择力常数 $k$，使得在偏置势下 $\\xi$ 的稳态分布在 $\\xi_{0}$ 附近的标准差为 $\\sigma$。\n- 为确保足够的窗口间重叠，选择相邻窗口中心之间的间距 $\\Delta \\xi$，使得在相邻窗口中心 $\\xi=\\xi_{0}+\\Delta\\xi$ 处的偏置概率密度与当前窗口中心 $\\xi=\\xi_{0}$ 处的偏置概率密度之比等于预设阈值 $r^{\\ast}$。\n\n使用以下数据：\n- 温度 $T=300\\,\\mathrm{K}$，\n- 目标宽度 $\\sigma=0.10\\,\\mathrm{nm}$，\n- 局部PMF曲率 $\\kappa=100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$，\n- 重叠阈值 $r^{\\ast}=0.30$。\n\n使用摩尔能量单位进行计算。使用气体常数 $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，并根据需要转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。将最终的 $k$ 以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$ 为单位表示，$\\Delta\\xi$ 以 $\\mathrm{nm}$ 为单位表示。将最终答案四舍五入至三位有效数字。以数对 $\\big(k,\\Delta\\xi\\big)$ 的形式提供最终答案。",
            "solution": "所述问题在科学上是合理的、提法是适定的，并包含了唯一解所需的所有信息。它描述了计算统计力学中设计伞形采样模拟的标准流程。因此，我们可以着手求解。\n\n目标是确定谐波偏置力常数 $k$ 和相邻伞形窗口之间的间距 $\\Delta\\xi$。\n\n首先，我们确定力常数 $k$。在给定的采样窗口内，系统经历的总平均力势 (PMF) 是固有的、无偏置的 PMF $F(\\xi)$ 与所施加的谐波偏置势 $U_b(\\xi;\\xi_0)$ 之和。问题给出了以下局部二次形式：\n$$F(\\xi) \\approx F(\\xi_{0}) + \\frac{1}{2}\\,\\kappa\\,(\\xi-\\xi_{0})^{2}$$\n$$U_{b}(\\xi;\\xi_{0}) = \\frac{1}{2}\\,k\\,(\\xi-\\xi_{0})^{2}$$\n偏置 PMF $F_b(\\xi)$ 是它们的和：\n$$F_b(\\xi) = F(\\xi) + U_b(\\xi;\\xi_{0}) \\approx \\left( F(\\xi_{0}) + \\frac{1}{2}\\,\\kappa\\,(\\xi-\\xi_{0})^{2} \\right) + \\frac{1}{2}\\,k\\,(\\xi-\\xi_{0})^{2}$$\n$$F_b(\\xi) \\approx F(\\xi_{0}) + \\frac{1}{2}\\,(\\kappa+k)\\,(\\xi-\\xi_{0})^{2}$$\n这表明，在局部二次近似下，偏置系统也具有一个以 $\\xi_0$ 为中心的二次 PMF，其有效弹簧常数为 $k_{\\text{eff}} = \\kappa+k$。\n\n在温度为 $T$ 的正则系综中，坐标 $\\xi$ 的概率分布由 PMF 的玻尔兹曼因子给出。对于偏置系综，这是：\n$$P_b(\\xi) \\propto \\exp\\left(-\\frac{F_b(\\xi)}{RT}\\right)$$\n其中 $R$ 是摩尔气体常数。代入 $F_b(\\xi)$ 的表达式：\n$$P_b(\\xi) \\propto \\exp\\left(-\\frac{F(\\xi_{0}) + \\frac{1}{2}\\,(\\kappa+k)\\,(\\xi-\\xi_{0})^{2}}{RT}\\right)$$\n项 $\\exp(-F(\\xi_0)/(RT))$ 是一个常数，可以并入归一化常数中。因此，分布的形状由以下公式确定：\n$$P_b(\\xi) \\propto \\exp\\left(-\\frac{(\\kappa+k)(\\xi-\\xi_{0})^{2}}{2RT}\\right)$$\n这是高斯（正态）分布的函数形式，$P(x) \\propto \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma_{\\text{dist}}^2}\\right)$，其均值为 $\\mu=\\xi_0$，方差为 $\\sigma_{\\text{dist}}^2$。通过比较指数部分，我们可以确定偏置分布的方差：\n$$\\frac{1}{2\\sigma_{\\text{dist}}^2} = \\frac{\\kappa+k}{2RT}$$\n这给出了方差：\n$$\\sigma_{\\text{dist}}^2 = \\frac{RT}{\\kappa+k}$$\n问题要求该分布的标准差 $\\sigma_{\\text{dist}}$ 等于指定的目标宽度 $\\sigma$。因此，$\\sigma_{\\text{dist}}^2 = \\sigma^2$。\n$$\\sigma^2 = \\frac{RT}{\\kappa+k}$$\n我们求解此方程以得到未知的偏置力常数 $k$：\n$$\\kappa+k = \\frac{RT}{\\sigma^2}$$\n$$k = \\frac{RT}{\\sigma^2} - \\kappa$$\n我们已知以下数值：$T=300\\,\\mathrm{K}$，$\\sigma=0.10\\,\\mathrm{nm}$，$\\kappa=100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$，以及 $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。我们首先将 $R$ 转换为所需的能量单位：$R = 0.008314462618\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n热能为：\n$$RT = (0.008314462618\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (300\\,\\mathrm{K}) \\approx 2.49434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\n现在，我们可以计算 $k$：\n$$k = \\frac{2.49434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}}{(0.10\\,\\mathrm{nm})^2} - 100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$$\n$$k = \\frac{2.49434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}}{0.010\\,\\mathrm{nm}^2} - 100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$$\n$$k = 249.434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2} - 100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2} = 149.434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$$\n四舍五入至三位有效数字，我们得到 $k = 149\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$。\n\n接下来，我们确定窗口间距 $\\Delta\\xi$。该间距由以下条件设定：在相邻窗口中心 $\\xi=\\xi_{0}+\\Delta\\xi$ 处的偏置概率密度与当前窗口中心 $\\xi=\\xi_{0}$ 处的密度之比等于阈值 $r^{\\ast}$。\n$$\\frac{P_b(\\xi_0 + \\Delta\\xi)}{P_b(\\xi_0)} = r^{\\ast}$$\n使用我们关于 $P_b(\\xi)$ 的表达式：\n$$P_b(\\xi_0) \\propto \\exp\\left(-\\frac{(\\kappa+k)(\\xi_0-\\xi_0)^2}{2RT}\\right) = \\exp(0) = 1$$\n$$P_b(\\xi_0 + \\Delta\\xi) \\propto \\exp\\left(-\\frac{(\\kappa+k)((\\xi_0+\\Delta\\xi)-\\xi_0)^2}{2RT}\\right) = \\exp\\left(-\\frac{(\\kappa+k)(\\Delta\\xi)^2}{2RT}\\right)$$\n因此，该比值为：\n$$\\exp\\left(-\\frac{(\\kappa+k)(\\Delta\\xi)^2}{2RT}\\right) = r^{\\ast}$$\n根据我们之前的推导，我们知道 $\\frac{\\kappa+k}{RT} = \\frac{1}{\\sigma^2}$。将此代入方程可大大简化：\n$$\\exp\\left(-\\frac{(\\Delta\\xi)^2}{2\\sigma^2}\\right) = r^{\\ast}$$\n现在我们求解 $\\Delta\\xi$。对两边取自然对数：\n$$-\\frac{(\\Delta\\xi)^2}{2\\sigma^2} = \\ln(r^{\\ast})$$\n$$(\\Delta\\xi)^2 = -2\\sigma^2 \\ln(r^{\\ast})$$\n由于 $\\Delta\\xi$ 是一个间距，我们取正平方根：\n$$\\Delta\\xi = \\sqrt{-2\\sigma^2 \\ln(r^{\\ast})} = \\sigma \\sqrt{-2 \\ln(r^{\\ast})}$$\n代入给定的数值 $\\sigma = 0.10\\,\\mathrm{nm}$ 和 $r^{\\ast}=0.30$：\n$$\\Delta\\xi = (0.10\\,\\mathrm{nm}) \\sqrt{-2 \\ln(0.30)}$$\n$$\\Delta\\xi \\approx (0.10\\,\\mathrm{nm}) \\sqrt{-2 \\times (-1.20397)}$$\n$$\\Delta\\xi \\approx (0.10\\,\\mathrm{nm}) \\sqrt{2.40794}$$\n$$\\Delta\\xi \\approx (0.10\\,\\mathrm{nm}) \\times 1.55175 \\approx 0.155175\\,\\mathrm{nm}$$\n四舍五入至三位有效数字，得到 $\\Delta\\xi = 0.155\\,\\mathrm{nm}$。\n\n最终所求的数对 $(k, \\Delta\\xi)$ 为 $(149\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}, 0.155\\,\\mathrm{nm})$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 149 & 0.155 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在完成一系列伞形采样模拟后，必须进行质量评估，然后才能将数据组合成最终的平均力势（PMF）。其中一个最关键的诊断步骤是检查相邻窗口采样数据的直方图之间是否存在足够的重叠。这个编程练习  将让您把理论付诸实践，通过编写一个自动化脚本来量化直方图重叠并识别采样不足的区域，这是任何严谨的伞形采样分析工作流程中不可或缺的一环。",
            "id": "2466495",
            "problem": "考虑沿一维反应坐标进行的伞形采样，该坐标被离散化为所有窗口共享的一组固定区间。对于窗口索引 $i \\in \\{0,1,\\dots,N-1\\}$ 和区间索引 $k \\in \\{0,1,\\dots,B-1\\}$，令 $c_{i,k} \\ge 0$ 表示窗口 $i$ 在区间 $k$ 中的观测计数。将窗口 $i$ 的总计数定义为 $s_i = \\sum_{k=0}^{B-1} c_{i,k}$。归一化直方图 $p_{i,k}$ 定义如下\n$p_{i,k} = \\begin{cases}\n\\dfrac{c_{i,k}}{s_i},  \\text{若 } s_i > 0,\\\\\n0,  \\text{若 } s_i = 0.\n\\end{cases}$\n对于每对相邻窗口 $(i,i+1)$，定义直方图重叠度\n$O_i = \\sum_{k=0}^{B-1} \\min\\!\\big(p_{i,k},\\,p_{i+1,k}\\big)$。\n给定阈值 $\\tau \\in [0,1]$，当且仅当 $O_i \\ge \\tau$ 时，相邻对 $(i,i+1)$ 被认为具有充分重叠。任何满足 $O_i  \\tau$ 的相邻对 $(i,i+1)$ 都是一个有问题的相邻区域。\n\n你的任务是编写一个程序，针对下方的每个测试用例，返回所有有问题的相邻对 $(i,i+1)$ 的起始索引 $i$ 的列表。如果 $N  2$，则列表为空。一个测试用例中的所有窗口共享相同的区间划分。最终输出必须将所有测试用例的列表聚合到单行上。\n\n测试套件：\n- 测试用例 1：\n  - 窗口数 $N = 4$，区间数 $B = 5$。\n  - 每个窗口的计数 (每个内部列表为 $[c_{i,0},c_{i,1},c_{i,2},c_{i,3},c_{i,4}]$):\n    - $i=0$: $[10,20,50,20,0]$\n    - $i=1$: $[0,10,40,40,10]$\n    - $i=2$: $[0,0,5,25,70]$\n    - $i=3$: $[0,0,0,10,90]$\n  - 阈值 $\\tau = 0.5$。\n- 测试用例 2：\n  - 窗口数 $N = 2$，区间数 $B = 4$。\n  - 计数：\n    - $i=0$: $[50,50,0,0]$\n    - $i=1$: $[50,0,50,0]$\n  - 阈值 $\\tau = 0.5$。\n- 测试用例 3：\n  - 窗口数 $N = 3$，区间数 $B = 3$。\n  - 计数：\n    - $i=0$: $[1,1,1]$\n    - $i=1$: $[0,0,0]$\n    - $i=2$: $[0,5,5]$\n  - 阈值 $\\tau = 0.2$。\n- 测试用例 4：\n  - 窗口数 $N = 5$，区间数 $B = 5$。\n  - 计数：\n    - $i=0$: $[100,0,0,0,0]$\n    - $i=1$: $[0,100,0,0,0]$\n    - $i=2$: $[0,0,100,0,0]$\n    - $i=3$: $[0,0,0,100,0]$\n    - $i=4$: $[0,0,0,0,100]$\n  - 阈值 $\\tau = 0.01$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含按顺序排列的 4 个测试用例的结果的类JSON列表。每个结果必须是一个整数列表（有问题的相邻对的起始索引 $i$）。打印的单行不得包含任何空白字符。例如，一个有效的格式是 $[[1],[0,2],[]]$。",
            "solution": "问题陈述已经过评估并被确定为有效。它在科学上基于计算统计力学的原理，特别是伞形采样模拟的分析。问题提法恰当，为计算唯一解提供了所有必要的数据和定义。所用术语客观且正式。因此，我们可以着手求解。\n\n目标是在一组伞形采样模拟中识别出有问题的相邻窗口对。如果一对窗口沿反应坐标的采样分布重叠度低于指定阈值 $\\tau$，则该对被视为“有问题的”。此分析对于确保重建的平均力势的质量和可靠性至关重要。\n\n对于一个拥有 $N$ 个窗口和沿反应坐标有 $B$ 个区间的系统，其步骤如下。\n\n首先，对于每个窗口 $i$（其中 $i \\in \\{0, 1, \\dots, N-1\\}$），我们给定每个区间 $k$（其中 $k \\in \\{0, 1, \\dots, B-1\\}$）的原始计数 $c_{i,k}$。这些计数代表在该特定模拟窗口内，系统在反应坐标的某一特定区段中被观测到的频率。\n\n其次，我们将这些原始计数归一化，以获得每个窗口的概率分布。这需要计算每个窗口 $i$ 的样本总数 $s_i$：\n$$s_i = \\sum_{k=0}^{B-1} c_{i,k}$$\n然后，窗口 $i$ 在区间 $k$ 的归一化概率分布（或直方图）$p_{i,k}$ 计算为该区间计数与总计数的比率：\n$$p_{i,k} = \\frac{c_{i,k}}{s_i}$$\n必须处理一种特殊情况：如果一个窗口 $i$ 的总样本数为零，即 $s_i = 0$，则其分布 $p_{i,k}$ 对所有区间 $k$ 都定义为 $0$。这是避免除以零的逻辑必然要求，并正确地表示一个没有数据的窗口在各处都具有零概率密度。\n\n第三，我们量化相邻窗口分布之间的相似性。对于每对相邻窗口 $(i, i+1)$（其中 $i$ 的范围从 $0$ 到 $N-2$），我们计算直方图重叠度 $O_i$。该度量定义为所有区间的最小概率值之和：\n$$O_i = \\sum_{k=0}^{B-1} \\min\\!\\big(p_{i,k},\\,p_{i+1,k}\\big)$$\n这个值 $O_i$ 代表两个归一化直方图的相交面积，其值界于区间 $[0, 1]$ 内。$O_i = 1$ 表示分布完全相同，而 $O_i = 0$ 表示分布完全不重叠。\n\n最后，我们应用指定的标准来识别有问题的区域。如果一对相邻窗口 $(i, i+1)$ 的重叠度 $O_i$ 小于给定的阈值 $\\tau \\in [0, 1]$，则将其归类为有问题的：\n$$O_i  \\tau$$\n对于给定的测试用例，最终输出是满足此条件的所有索引 $i$ 的列表。如果窗口总数 $N$ 小于 2，则不存在相邻对，因此有问题的索引列表为空。\n\n将此系统性步骤应用于每个测试用例，以生成所需的结果。整个过程是所提供定义的直接计算实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the umbrella sampling overlap problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"counts\": [\n                [10, 20, 50, 20, 0],\n                [0, 10, 40, 40, 10],\n                [0, 0, 5, 25, 70],\n                [0, 0, 0, 10, 90]\n            ],\n            \"tau\": 0.5\n        },\n        {\n            \"counts\": [\n                [50, 50, 0, 0],\n                [50, 0, 50, 0]\n            ],\n            \"tau\": 0.5\n        },\n        {\n            \"counts\": [\n                [1, 1, 1],\n                [0, 0, 0],\n                [0, 5, 5]\n            ],\n            \"tau\": 0.2\n        },\n        {\n            \"counts\": [\n                [100, 0, 0, 0, 0],\n                [0, 100, 0, 0, 0],\n                [0, 0, 100, 0, 0],\n                [0, 0, 0, 100, 0],\n                [0, 0, 0, 0, 100]\n            ],\n            \"tau\": 0.01\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        counts = np.array(case[\"counts\"], dtype=float)\n        tau = case[\"tau\"]\n        N = counts.shape[0]\n\n        if N  2:\n            results.append([])\n            continue\n\n        # Calculate total counts s_i for each window i\n        s = np.sum(counts, axis=1)\n\n        # Normalize histograms p_i,k\n        # Initialize p with zeros to handle s_i = 0 case\n        p = np.zeros_like(counts)\n        # Find windows where s_i > 0\n        non_zero_s_indices = np.where(s > 0)[0]\n        # Perform normalization only for these windows\n        # s[non_zero_s_indices, np.newaxis] ensures correct broadcasting for division\n        p[non_zero_s_indices] = counts[non_zero_s_indices] / s[non_zero_s_indices, np.newaxis]\n\n        problematic_indices = []\n        # Iterate through adjacent pairs (i, i+1)\n        for i in range(N - 1):\n            p_i = p[i]\n            p_i_plus_1 = p[i+1]\n            \n            # Calculate overlap O_i\n            overlap = np.sum(np.minimum(p_i, p_i_plus_1))\n            \n            # Check if the pair is problematic\n            if overlap  tau:\n                problematic_indices.append(i)\n        \n        results.append(problematic_indices)\n\n    # Format the final output string to exactly match the requirement (no whitespace)\n    result_strings = []\n    for res_list in results:\n        res_str = f\"[{','.join(map(str, res_list))}]\"\n        result_strings.append(res_str)\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}