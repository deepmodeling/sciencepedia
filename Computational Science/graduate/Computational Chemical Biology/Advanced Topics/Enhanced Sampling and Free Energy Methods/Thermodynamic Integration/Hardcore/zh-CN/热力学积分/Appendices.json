{
    "hands_on_practices": [
        {
            "introduction": "掌握一种新的理论工具，往往始于将其应用于一个可精确求解的简化模型。这个练习  就提供了这样一个机会，要求你为一个处于一维谐振子势阱中的粒子计算其自由能变化。通过解析地完成这个“玩具模型”，你可以在不涉及复杂分子模拟的情况下，巩固对热力学积分基本步骤的理解，并直观地感受势能函数的性质如何影响自由能的变化。",
            "id": "2465950",
            "problem": "一个质量为 $m$ 的经典粒子在一维空间中运动，并被约束在谐振子势中。在状态 $A$ 中，势为 $U_{A}(x) = \\frac{1}{2} k_{A} x^{2}$，在状态 $B$ 中，势为 $U_{B}(x) = \\frac{1}{2} k_{B} x^{2}$，其中 $k_{A} > 0$ 和 $k_{B} > 0$ 是力常数。系统处于绝对温度 $T$ 下的正则系综中。定义一个炼金术耦合参数 $\\lambda \\in [0,1]$ 和一条势能路径 $U_{\\lambda}(x) = (1-\\lambda) U_{A}(x) + \\lambda U_{B}(x)$。使用热力学积分 (TI)，确定亥姆霍兹自由能差 $\\Delta F_{A \\to B} = F_{B} - F_{A}$ 的精确解析表达式。假设经典统计，并注意动能贡献在状态 $A$ 和 $B$ 中是相同的，因此在自由能差中被抵消。用 $k_{A}$、$k_{B}$、玻尔兹曼常数 $k_{\\mathrm{B}}$ 和 $T$ 的符号将您的最终答案表示为单个闭合形式表达式。",
            "solution": "系统是经典的，并处于温度 $T$ 下的正则系综中。亥姆霍兹自由能由 $F = - k_{\\mathrm{B}} T \\ln Z$ 定义，其中 $Z$ 是配分函数。在热力学积分 (TI) 中，引入一个耦合参数 $\\lambda \\in [0,1]$，通过 $U_{\\lambda}(x) = (1-\\lambda) U_{A}(x) + \\lambda U_{B}(x)$ 将势从 $U_{A}$ 连续变换到 $U_{B}$。正则系综中的基本 TI 关系是\n$$\n\\Delta F_{A \\to B} \\equiv F_{B} - F_{A} = \\int_{0}^{1} \\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda,\n$$\n其中 $\\langle \\cdot \\rangle_{\\lambda}$ 表示相对于对应于 $U_{\\lambda}$ 的正则分布的系综平均。\n\n对于给定的路径，\n$$\nU_{\\lambda}(x) = \\frac{1}{2}\\left[(1-\\lambda)k_{A} + \\lambda k_{B}\\right] x^{2} \\equiv \\frac{1}{2} k(\\lambda) x^{2},\n$$\n其中 $k(\\lambda) = (1-\\lambda)k_{A} + \\lambda k_{B}$。将 $U_{\\lambda}$ 对 $\\lambda$ 求导得出\n$$\n\\frac{\\partial U_{\\lambda}}{\\partial \\lambda} = \\frac{1}{2}\\left(k_{B} - k_{A}\\right) x^{2}.\n$$\n因此，TI 被积函数为\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\frac{1}{2}\\left(k_{B} - k_{A}\\right) \\langle x^{2} \\rangle_{\\lambda}.\n$$\n\n我们现在计算力常数为 $k(\\lambda)$ 的一维谐振子势的 $\\langle x^{2} \\rangle_{\\lambda}$。在正则系综中，\n$$\n\\langle x^{2} \\rangle_{\\lambda} = \\frac{\\int_{-\\infty}^{\\infty} x^{2} \\exp\\!\\left[-\\beta \\frac{1}{2} k(\\lambda) x^{2}\\right] dx}{\\int_{-\\infty}^{\\infty} \\exp\\!\\left[-\\beta \\frac{1}{2} k(\\lambda) x^{2}\\right] dx},\n$$\n其中 $\\beta = \\frac{1}{k_{\\mathrm{B}} T}$。分子和分母都是高斯积分。使用此类矩的标准结果，可以得到\n$$\n\\langle x^{2} \\rangle_{\\lambda} = \\frac{1}{\\beta k(\\lambda)} = \\frac{k_{\\mathrm{B}} T}{k(\\lambda)}.\n$$\n因此，\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\frac{1}{2}\\left(k_{B} - k_{A}\\right) \\frac{k_{\\mathrm{B}} T}{k(\\lambda)}.\n$$\n\n代入 TI 积分得到\n$$\n\\Delta F_{A \\to B} = \\int_{0}^{1} \\frac{1}{2}\\left(k_{B} - k_{A}\\right) \\frac{k_{\\mathrm{B}} T}{(1-\\lambda)k_{A} + \\lambda k_{B}} \\, d\\lambda.\n$$\n这是一个初等积分。令 $a = k_{A}$ 和 $b = k_{B}$。那么\n$$\n\\Delta F_{A \\to B} = \\frac{1}{2} k_{\\mathrm{B}} T (b - a) \\int_{0}^{1} \\frac{d\\lambda}{a + \\lambda (b - a)}.\n$$\n计算该积分，\n$$\n\\int_{0}^{1} \\frac{d\\lambda}{a + \\lambda (b - a)} = \\frac{1}{b - a} \\left[ \\ln\\!\\left(a + \\lambda (b - a)\\right) \\right]_{0}^{1} = \\frac{1}{b - a} \\left( \\ln b - \\ln a \\right).\n$$\n因此，\n$$\n\\Delta F_{A \\to B} = \\frac{1}{2} k_{\\mathrm{B}} T \\left( \\ln b - \\ln a \\right) = \\frac{1}{2} k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{k_{B}}{k_{A}}\\right).\n$$\n\n此表达式是沿指定线性耦合路径的两个一维谐振子状态之间的精确经典构型自由能差，并且与直接的配分函数计算结果一致，注意到动能贡献在差值中被抵消。",
            "answer": "$$\\boxed{\\frac{1}{2}\\,k_{\\mathrm{B}}\\,T\\,\\ln\\!\\left(\\frac{k_{B}}{k_{A}}\\right)}$$"
        },
        {
            "introduction": "在实际应用中，热力学积分公式中的连续积分 $ \\int d\\lambda $ 被离散模拟窗口上的数值求和所取代。这个练习  要求你根据一组预先计算好的平均力 $ \\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} $ 数据来计算自由能差，从而弥合理论与计算之间的鸿沟。这将让你亲身体验数值积分的计算过程，这是分析真实模拟数据的一项核心技能。",
            "id": "3867550",
            "problem": "在一项与计算化学生物学相关的炼金术自由能计算中，一个配体在恒定温度 $T$ 下通过与参数 $\\lambda \\in [0,1]$ 耦合而转变为一个参考态。该系统在正则系综中进行模拟。在每个离散的 $\\lambda$ 值下，广义力 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 的系综平均值通过足够长的平衡分子动力学模拟进行估计，其中 $U(\\mathbf{x};\\lambda)$ 是构型 $\\mathbf{x}$ 在耦合参数 $\\lambda$ 下的势能。在均匀间隔的网格上获得了以下数值（为本练习之目的，假设这些值已统计收敛）：\n- $\\lambda = 0.0$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.000\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.1$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.229\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.2$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.512\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.3$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.843\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.4$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 2.216\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.5$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 2.625\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.6$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 3.064\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.7$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 3.527\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.8$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 4.008\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.9$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 4.501\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 1.0$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 5.000\\ \\mathrm{kJ\\,mol^{-1}}$\n\n请仅使用平衡统计力学的基本定义和数值积分方法，推导连接 Helmholtz 自由能差 $\\Delta F$ 与所提供的广义力数据的表达式，然后使用适用于均匀间隔网格的复合 Newton–Cotes 法则，计算 $\\lambda \\in [0,1]$ 范围内的 $\\Delta F$ 近似值。在计算中，请展示您使用的显式积分权重。最后，定性地简要讨论对于您选择的积分方法，离散化误差将如何随网格间距变化，以及 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 对 $\\lambda$ 的潜在依赖关系中的哪些特征控制着此误差。\n\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示 $\\Delta F$ 的最终数值，并将您的答案四舍五入至四位有效数字。",
            "solution": "该问题要求推导基本的热力学积分（TI）公式，使用数值积分将其应用于给定数据集，并讨论数值误差。\n\n**1. 热力学积分公式的推导**\n\n亥姆霍兹自由能 $F$ 由正则配分函数 $Z$ 定义：\n$$F(\\lambda) = -k_\\mathrm{B} T \\ln Z(\\lambda)$$\n其中 $k_\\mathrm{B}$ 是玻尔兹曼常数，$T$ 是温度，$\\lambda$ 是耦合参数。对于一个由 $N$ 个相同粒子组成的系统，其正则配分函数 $Z$ 由对所有可能的相空间坐标（位置 $\\mathbf{x}$ 和动量 $\\mathbf{p}$）的积分给出：\n$$Z(\\lambda) = \\frac{1}{N!h^{3N}} \\int \\int \\exp(-\\beta H(\\mathbf{x}, \\mathbf{p}; \\lambda)) \\,d\\mathbf{x}\\,d\\mathbf{p}$$\n此处，$\\beta = (k_\\mathrm{B} T)^{-1}$，$h$ 是普朗克常数，$H(\\mathbf{x}, \\mathbf{p}; \\lambda)$ 是系统的哈密顿量。哈密顿量是动能 $K(\\mathbf{p})$ 和势能 $U(\\mathbf{x}; \\lambda)$ 的和：$H(\\mathbf{x}, \\mathbf{p}; \\lambda) = K(\\mathbf{p}) + U(\\mathbf{x}; \\lambda)$。由于动能与 $\\lambda$ 无关，对动量的积分可以被因子分解出来。这导致自由能的简化表达式，其依赖于构型配分函数 $Q(\\lambda)$：\n$$F(\\lambda) = -k_\\mathrm{B} T \\ln Q(\\lambda) + C$$\n其中 $C$ 是一个与 $\\lambda$ 无关的常数，$Q(\\lambda)$ 由下式给出：\n$$Q(\\lambda) = \\int \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}$$\n为了找到 $F$ 与给定数据之间的关系，我们将 $F(\\lambda)$ 对 $\\lambda$ 求导：\n$$\\frac{\\partial F}{\\partial \\lambda} = -k_\\mathrm{B} T \\frac{1}{Q(\\lambda)} \\frac{\\partial Q(\\lambda)}{\\partial \\lambda}$$\n构型配分函数的导数是：\n$$\\frac{\\partial Q(\\lambda)}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\int \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x} = \\int \\left(-\\beta \\frac{\\partial U(\\mathbf{x}; \\lambda)}{\\partial \\lambda}\\right) \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}$$\n将此代回 $\\partial F / \\partial \\lambda$ 的表达式中：\n$$\\frac{\\partial F}{\\partial \\lambda} = -k_\\mathrm{B} T \\frac{1}{Q(\\lambda)} \\int \\left(-\\beta \\frac{\\partial U(\\mathbf{x}; \\lambda)}{\\partial \\lambda}\\right) \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}$$\n使用 $\\beta = (k_\\mathrm{B} T)^{-1}$，上式简化为：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\int \\frac{\\partial U(\\mathbf{x}; \\lambda)}{\\partial \\lambda} \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}}{\\int \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}}$$\n根据定义，右侧是在固定 $\\lambda$ 值下，正则系综中物理量 $\\partial U / \\partial \\lambda$ 的系综平均值。这被记为 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$。因此，我们得到了核心关系式：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda}$$\n为了求得总自由能差 $\\Delta F = F(\\lambda=1) - F(\\lambda=0)$，我们将此表达式从 $\\lambda=0$ 到 $\\lambda=1$ 的路径上积分：\n$$\\int_0^1 \\frac{\\partial F}{\\partial \\lambda} \\,d\\lambda = \\int_0^1 \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\,d\\lambda$$\n根据微积分基本定理，左侧为 $F(1) - F(0) = \\Delta F$。因此，最终表达式为：\n$$\\Delta F = \\int_0^1 \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\,d\\lambda$$\n这就是所要求的表达式。\n\n**2. $\\Delta F$ 的数值计算**\n\n问题提供了被积函数 $g(\\lambda) = \\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 在一个包含 11 个点的均匀间隔网格上的数据，这对应于 $n=10$ 个区间。由于 $n$ 是偶数，复合辛普森法则（Composite Simpson's rule）是合适且高精度的 Newton-Cotes 方法。对于 $n$ 个（$n$ 为偶数）宽度为 $h$ 的区间，复合辛普森法则的公式为：\n$$\\int_a^b g(\\lambda) \\,d\\lambda \\approx \\frac{h}{3} \\left[ g(\\lambda_0) + 4g(\\lambda_1) + 2g(\\lambda_2) + \\dots + 2g(\\lambda_{n-2}) + 4g(\\lambda_{n-1}) + g(\\lambda_n) \\right]$$\n在我们的例子中，积分区间是 $[0, 1]$，所以 $a=0$ 且 $b=1$。区间数量为 $n=10$，所以网格间距为 $h = (1-0)/10 = 0.1$。令 $g_i = \\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda_i}$，其中 $\\lambda_i = i \\times h$。\n数据点为：\n$g_0 = 1.000$；$g_1 = 1.229$；$g_2 = 1.512$；$g_3 = 1.843$；$g_4 = 2.216$；$g_5 = 2.625$；$g_6 = 3.064$；$g_7 = 3.527$；$g_8 = 4.008$；$g_9 = 4.501$；$g_{10} = 5.000$。（所有单位均为 $\\mathrm{kJ\\,mol^{-1}}$）。\n\n每个数据点 $g_i$ 的积分权重由 $w_i$ 给出。积分为 $\\sum_{i=0}^{10} w_i g_i$。对于辛普森法则，权重为：\n$w_0 = \\frac{h}{3}(1) = \\frac{0.1}{3}$；$w_1 = \\frac{h}{3}(4) = \\frac{0.4}{3}$；$w_2 = \\frac{h}{3}(2) = \\frac{0.2}{3}$；$w_3 = \\frac{h}{3}(4) = \\frac{0.4}{3}$；$w_4 = \\frac{h}{3}(2) = \\frac{0.2}{3}$；$w_5 = \\frac{h}{3}(4) = \\frac{0.4}{3}$；$w_6 = \\frac{h}{3}(2) = \\frac{0.2}{3}$；$w_7 = \\frac{h}{3}(4) = \\frac{0.4}{3}$；$w_8 = \\frac{h}{3}(2) = \\frac{0.2}{3}$；$w_9 = \\frac{h}{3}(4) = \\frac{0.4}{3}$；$w_{10} = \\frac{h}{3}(1) = \\frac{0.1}{3}$。\n\n应用该法则：\n$\\Delta F \\approx \\frac{0.1}{3} [g_0 + 4g_1 + 2g_2 + 4g_3 + 2g_4 + 4g_5 + 2g_6 + 4g_7 + 2g_8 + 4g_9 + g_{10}]$\n$\\Delta F \\approx \\frac{0.1}{3} [1.000 + 4(1.229) + 2(1.512) + 4(1.843) + 2(2.216) + 4(2.625) + 2(3.064) + 4(3.527) + 2(4.008) + 4(4.501) + 5.000]$\n$\\Delta F \\approx \\frac{0.1}{3} [1.000 + 4.916 + 3.024 + 7.372 + 4.432 + 10.500 + 6.128 + 14.108 + 8.016 + 18.004 + 5.000]$\n$\\Delta F \\approx \\frac{0.1}{3} [82.500]$\n$\\Delta F \\approx \\frac{8.250}{3} = 2.750 \\, \\mathrm{kJ\\,mol^{-1}}$\n\n**3. 离散化误差的讨论**\n\n使用复合辛普森法则在区间 $[a,b]$ 上对函数 $g(\\lambda)$ 进行积分的离散化误差 $E$（网格间距为 $h = (b-a)/n$）由下式给出：\n$$E = -\\frac{(b-a)h^4}{180} g^{(4)}(\\xi)$$\n对于某个 $\\xi \\in (a, b)$，其中 $g^{(4)}(\\lambda)$ 是被积函数的四阶导数。\n\n从这个公式中，我们可以得出两个关键的观察结果：\n1.  **随网格间距的变化关系**：误差与网格间距的四次方成正比，即 $E \\propto h^4$。这是一个高阶精度。如果网格间距 $h$ 减半，误差预计将减少 $2^4 = 16$ 倍。\n2.  **控制误差的特征**：误差的大小与被积函数 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 的四阶导数的量值成正比。如果该函数平滑且能被低次多项式很好地近似，则误差很小。如果函数表现出高频振荡或急剧变化的曲率，这对应于一个大的四阶导数，则误差会很大。\n\n在这个特定问题中，可以验证所提供的数据点完全符合三次多项式 $g(\\lambda) = -\\lambda^3 + 3\\lambda^2 + 2\\lambda + 1$。对于次数为 3 或更低的多项式，其四阶导数恒为零：\n$$g^{(4)}(\\lambda) = \\frac{d^4}{d\\lambda^4}(-\\lambda^3 + 3\\lambda^2 + 2\\lambda + 1) = 0$$\n因此，对于这个特定的数据集，复合辛普森法则的截断误差为零。计算出的值 $2.750 \\, \\mathrm{kJ\\,mol^{-1}}$ 不是一个近似值，而是生成这些数据点的函数积分的精确值。最终结果应按要求报告为四位有效数字。\n\n计算值为 $\\Delta F = 2.750 \\, \\mathrm{kJ\\,mol^{-1}}$。",
            "answer": "$$\\boxed{2.750}$$"
        },
        {
            "introduction": "从模拟中获得数值结果只是成功的一半，真正的挑战在于验证其物理意义的有效性。这个问题  提出了一个非常真实的场景，其中一次热力学积分计算得出了一个不符合物理直觉的结果。你的任务是扮演一名“计算侦探”，找出导致错误的模拟方案中那个微妙但关键的人为因素（artifact），这对任何严肃的实践者来说都是一项至关重要的批判性思维技能。",
            "id": "2465979",
            "problem": "一名学生进行热力学积分（TI）计算，以求得将一个电荷为 $+e$ 的单价阳离子从液态水中湮灭的自由能变化，即离子的“溶剂 $\\rightarrow$ 真空”过程。自由能定义为\n$$\n\\Delta G \\;=\\; \\int_{0}^{1} \\left\\langle \\frac{\\partial U(\\mathbf{r}^{N};\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda,\n$$\n其中 $\\lambda$ 将溶质-溶剂相互作用从 $\\lambda=1$ 时的完全开启连续缩放至 $\\lambda=0$ 时的完全关闭。模拟在立方盒子中使用周期性边界条件（PBC），采用粒子网格埃瓦尔德（PME）方法处理静电相互作用，并对 Lennard–Jones 和静电相互作用均使用软核势。温度和压力控制在 $T=298\\,\\mathrm{K}$ 和 $P=1\\,\\mathrm{bar}$。\n\n关键观察结果：\n- 在 $\\lambda=1$ 时，体系包含纯水和一个总电荷为 $+e$ 的阳离子。未添加显式抗衡离子。当 $\\lambda \\to 0$ 时，溶质的电荷和 Lennard–Jones 相互作用均被完全关闭，只留下体相水。\n- 当净电荷非零时，PME 的实现会应用常规的均匀中和背景。\n- 在边长为 $L=2.6\\,\\mathrm{nm}$ 的立方盒子中，该学生计算出离子“溶剂 $\\rightarrow$ 真空”湮灭过程的 $\\Delta G \\approx -220\\,\\mathrm{kJ\\,mol^{-1}}$。在边长为 $L=3.9\\,\\mathrm{nm}$ 的更大盒子中重复计算，得到 $\\Delta G \\approx -140\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 在真空中（无溶剂），通过相同的 $\\lambda$ 方案湮灭同一个离子，得到 $\\Delta G \\approx 0\\,\\mathrm{kJ\\,mol^{-1}}$（在统计不确定度范围内）。\n- 在两个盒子中，模拟的体相水密度均为 $\\rho \\approx 0.997\\,\\mathrm{g\\,cm^{-3}}$，且能量守恒、温度和压力等其他方面均正常。\n\n对于一个强溶剂化的阳离子，移除有利的离子-水相互作用应该需要做功；因此，“溶剂 $\\rightarrow$ 真空”自由能的符号预期为正。哪一个微妙的设置缺陷最可能解释该学生报告的那个巨大的、负的、且依赖于盒子尺寸的 $\\Delta G$ 值？\n\nA. 由于没有显式抗衡离子，体系的净电荷沿着炼金路径发生变化；在使用均匀中和背景的埃瓦尔德求和法下，这会引入一个依赖于盒子尺寸的自相互作用和偏移量，若不加以校正，可能会虚假地导致 $\\Delta G$ 为负。\n\nB. 控温器的选择（使用 Berendsen 而非 Nosé–Hoover）扰动了动能分布，产生了足以翻转 $\\Delta G$ 符号的系统性偏差。\n\nC. $\\lambda$ 方案对 $\\lambda$ 是线性的，而不是在端点附近密集取样，这导致了求积误差，对于该体系，这种误差可以轻易地反转 $\\Delta G$ 的符号。\n\nD. 对 Lennard–Jones 相互作用使用软核势但对静电相互作用不使用，导致了端点病态问题，这在水中进行离子湮灭时不可避免地会产生负的 $\\Delta G$。\n\nE. $2\\,\\mathrm{fs}$ 的时间步长引入了数值积分误差，该误差累积成一个大的负偏差，并表现出所观察到的 $\\Delta G$ 的 $1/L$ 标度关系。",
            "solution": "该问题的核心在于识别在周期性边界条件（PBC）下对带电体系进行炼金术计算时一个常见且重要的计算人为因素（artifact）。\n\n首先，我们分析物理预期与学生的计算结果。学生的目标是计算阳离子的湮灭自由能，即从水溶液中移除一个阳离子。这个过程需要克服离子与水分子之间有利的静电吸引和溶剂化作用，因此其自由能变化（$\\Delta G_{\\text{annih}}$）物理上预期为正值。然而，学生报告的积分 $\\Delta G = \\int_{0}^{1} \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda$ 计算的是相反的过程——离子的*生成*或*溶剂化*（从 $\\lambda=0$ 的“幽灵”粒子到 $\\lambda=1$ 的真实离子）。溶剂化自由能（$\\Delta G_{\\text{solv}}$）对于离子来说是大的负值。学生报告的大的负值（如 $-220\\,\\mathrm{kJ\\,mol^{-1}}$）与溶剂化过程的符号一致，但其数值和对盒子尺寸的强烈依赖性揭示了更深层次的问题。\n\n这个问题的根源在于，当使用埃瓦尔德求和方法（如PME）处理一个带有净电荷 $Q$ 的周期性体系时，为了维持电中性，算法会隐式地引入一个均匀的背景电荷。这导致体系的总能量中包含了一个非物理的、依赖于盒子尺寸的人为项。这个人为项源于净电荷与其所有周期性镜像及中和背景之间的相互作用。对于一个位于边长为 $L$ 的立方盒子中心、电荷为 $q$ 的离子，此人为能量项近似为：\n$$\nU_{\\text{art}}(q) = -\\frac{k_e \\xi q^2}{2 L}\n$$\n其中 $k_e$ 是库仑常数，$\\xi$ 是与晶格结构相关的马德隆常数（对于简单立方约为 2.8373）。\n\n在学生的炼金术计算中，离子的电荷随 $\\lambda$ 变化，$q(\\lambda) = \\lambda e$。因此，人为能量项也依赖于 $\\lambda$：\n$$\nU_{\\text{art}}(\\lambda) = -\\frac{k_e \\xi (\\lambda e)^2}{2 L} = -\\left(\\frac{k_e \\xi e^2}{2 L}\\right) \\lambda^2\n$$\n这个人为项对热力学积分被积函数的贡献是：\n$$\n\\frac{\\partial U_{\\text{art}}(\\lambda)}{\\partial \\lambda} = -\\left(\\frac{k_e \\xi e^2}{L}\\right) \\lambda\n$$\n由于该项不依赖于原子坐标，其系综平均值就是它本身。将此项对 $\\lambda$ 从0到1积分，得到对总自由能变化的人为贡献 $\\Delta G_{\\text{art}}$：\n$$\n\\Delta G_{\\text{art}} = \\int_{0}^{1} \\left( -\\frac{k_e \\xi e^2}{L} \\lambda \\right) d\\lambda = -\\frac{k_e \\xi e^2}{L} \\left[ \\frac{\\lambda^2}{2} \\right]_{0}^{1} = -\\frac{k_e \\xi e^2}{2 L}\n$$\n因此，学生计算出的总自由能 $\\Delta G_{\\text{comp}}(L)$ 是真实的物理溶剂化自由能 $\\Delta G_{\\text{true}}$ 与这个负的人为项之和：\n$$\n\\Delta G_{\\text{comp}}(L) = \\Delta G_{\\text{true}} + \\Delta G_{\\text{art}}(L) = \\Delta G_{\\text{true}} - \\frac{k_e \\xi e^2}{2 L}\n$$\n这个分析完美地解释了学生的观察结果：\n1.  **符号和大小**：$\\Delta G_{\\text{true}}$ 本身是一个大的负值。人为项 $\\Delta G_{\\text{art}}(L)$ 也是负的，这使得计算结果比真实的物理值*更加*负，从而解释了报告中的巨大负值。\n2.  **盒子尺寸依赖性**：人为项与 $1/L$ 成反比。当盒子尺寸 $L$ 从 $2.6\\,\\mathrm{nm}$ 增加到 $3.9\\,\\mathrm{nm}$ 时，负的人为项的绝对值减小，因此计算出的 $\\Delta G_{\\text{comp}}$ 变得不那么负（从 $-220$ 变为 $-140\\,\\mathrm{kJ\\,mol^{-1}}$），这与学生的报告完全吻合。\n3.  **真空对照**：在真空中，没有周期性的溶剂，PME方法不适用（或没有净电荷问题），因此不存在这个人为误差，计算结果 $\\Delta G_{\\text{vac}} \\approx 0$ 是正确的。\n\n现在我们评估各个选项：\n**A. ** 此选项精确地描述了上述问题：体系净电荷变化，与PME（埃瓦尔德求和）结合使用时，会引入一个依赖于盒子尺寸的自相互作用人为误差，若不加以校正，将导致计算出的自由能出现系统性偏差。**这是正确的解释。**\n\n**B. ** 控温器的选择（Berendsen vs. Nosé–Hoover）虽然会影响系综的精确性，但其导致的误差通常很小，不会产生数百$\\mathrm{kJ\\,mol^{-1}}$的偏差，也不会引入系统的 $1/L$ 依赖性。\n\n**C. ** $\\lambda$ 采样点不足会导致数值积分误差，但这种误差的符号和大小不确定，且不具有特定的 $1/L$ 标度律。\n\n**D. ** 问题陈述明确指出对静电和LJ相互作用*均*使用了软核势，所以此选项的前提是错误的。\n\n**E. ** 时间步长 ($2\\,\\mathrm{fs}$) 主要影响动力学积分的稳定性，而不是热力学平均值的系统性偏差，并且其误差与盒子尺寸 $L$ 无关。\n\n综上所述，选项A是唯一能完全解释所有观察现象的根本原因。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}