{
    "hands_on_practices": [
        {
            "introduction": "Understanding molecular recognition requires appreciating the delicate balance between favorable direct interactions and often unfavorable changes in solvation. This first practice uses a simplified physical model to deconstruct the binding contribution of a charged residue, allowing you to quantify the energetic trade-off between a strong electrostatic contact and the significant penalty of desolvating a charged group. By working through this exercise (), you will build crucial intuition for why even seemingly optimal interactions can be energetically costly.",
            "id": "3836686",
            "problem": "You will implement a rigorous, unit-consistent per-residue binding free energy decomposition for a single residue forming a contact upon binding. The model must be built from first principles and physically grounded, using the following foundational elements:\n\n1) Coulomb’s law for the interaction energy of two point charges in a homogeneous dielectric medium. For two point charges $q_i$ and $q_j$ (in units of elementary charge), separated by a fixed distance $r$ (in nanometers), in a medium with relative permittivity $\\varepsilon_\\mathrm{contact}$, the interaction energy is given by the Coulomb expression with an energy unit conversion constant $k_\\mathrm{c}$:\n$$\nU_\\mathrm{Coulomb} = \\frac{k_\\mathrm{c}\\, q_i q_j}{\\varepsilon_\\mathrm{contact}\\, r}.\n$$\nUse $k_c = 138.935456 \\text{ kJ mol}^{-1} \\text{ nm e}^{-2}$ so that computed energies are directly in kJ/mol.\n\n2) Born model for the polar solvation free energy of a single ion of charge $q$ and effective Born radius $R$ in a medium of relative permittivity $\\varepsilon$. The polar solvation free energy in a medium $\\varepsilon$ is:\n$$\nG_\\mathrm{polar}(\\varepsilon) = -\\frac{1}{2}\\, k_\\mathrm{c}\\, \\frac{q^2}{R} \\left(1 - \\frac{1}{\\varepsilon}\\right).\n$$\nThe change in polar solvation free energy for transferring a residue’s charge from water (relative permittivity $\\varepsilon_\\mathrm{w}$) to a protein-like interior (relative permittivity $\\varepsilon_\\mathrm{p}$) is obtained by the thermodynamic cycle difference:\n$$\n\\Delta G_\\mathrm{polar}^{\\mathrm{desolv}} = G_\\mathrm{polar}(\\varepsilon_\\mathrm{p}) - G_\\mathrm{polar}(\\varepsilon_\\mathrm{w}) = \\frac{1}{2}\\, k_\\mathrm{c}\\, \\frac{q^2}{R} \\left(\\frac{1}{\\varepsilon_\\mathrm{p}} - \\frac{1}{\\varepsilon_\\mathrm{w}}\\right).\n$$\n\n3) A linear nonpolar term proportional to the buried solvent-accessible surface area. Let $\\Delta A_\\mathrm{buried}$ be the buried area upon binding (in square Ångströms), assumed non-negative. The nonpolar contribution is modeled as\n$$\n\\Delta G_\\mathrm{nonpolar} = - \\gamma\\, \\Delta A_\\mathrm{buried},\n$$\nwith surface tension coefficient $\\gamma$ specified below.\n\nThe per-residue binding free energy contribution is then the sum of the energy gained from the direct contact and the change in solvation upon transferring from water to the protein interior:\n$$\n\\Delta G_\\mathrm{bind}^{(i)} = U_\\mathrm{Coulomb}^{(i)} + \\Delta G_\\mathrm{polar,\\,desolv}^{(i)} + \\Delta G_\\mathrm{nonpolar}^{(i)}.\n$$\n\nYour task is to construct a program that computes $\\Delta G_\\mathrm{bind}^{(i)}$ for a set of test cases that exemplify scenarios where a favorable direct interaction is offset by an unfavorable solvation change, and to quantify the net contribution in each case. All distances $r$ and radii $R$ are in nanometers, areas $\\Delta A_\\mathrm{buried}$ are in Å$^2$, and the final energy must be reported in kJ/mol.\n\nUse the following constants in all computations:\n- Coulomb energy prefactor: $k_c = 138.935456 \\text{ kJ mol}^{-1} \\text{ nm e}^{-2}$.\n- Water relative permittivity: $\\varepsilon_\\mathrm{w} = 80.0$.\n- Protein-interior effective relative permittivity: $\\varepsilon_\\mathrm{p} = 4.0$.\n- Nonpolar surface tension: $\\gamma = 0.022 \\text{ kJ mol}^{-1} \\text{ Å}^{-2}$.\n\nTest suite. For each case, the parameters are given as a tuple $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried})$:\n- Case 1 (strong contact, low-dielectric contact region): $(+1.0, -1.0, 0.30, 4.0, 0.16, 50.0)$.\n- Case 2 (same charges and radius, more hydrated contact with higher dielectric): $(+1.0, -1.0, 0.35, 20.0, 0.16, 30.0)$.\n- Case 3 (neutral residue; tests boundary where only nonpolar burial acts): $(0.0, 0.0, 0.35, 4.0, 0.20, 120.0)$.\n\nProgram requirements:\n- Implement the above physical model exactly as stated.\n- For each test case, compute $\\Delta G_\\mathrm{bind}^{(i)}$ in kJ/mol.\n- Round each result to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[\\text{result1},\\text{result2},\\text{result3}]$.\n\nScientific realism constraints:\n- Ensure no unit conversions are omitted. Use $r$ and $R$ in nanometers, $\\Delta A_\\mathrm{buried}$ in Å$^2$, and the specified constants as given.\n- The angle unit is not applicable here.\n- Express all final numerical outputs in kJ/mol, rounded to three decimals as specified.",
            "solution": "The problem statement has been critically evaluated and is deemed valid. It is scientifically grounded in established, albeit simplified, physical models (Coulomb's Law, the Born model, and a surface-area-based nonpolar model), is well-posed with a unique solution for each given set of parameters, and is free of ambiguity or contradiction. All necessary constants and parameters are provided. We may therefore proceed with the solution.\n\nThe objective is to compute the per-residue binding free energy contribution, $\\Delta G_\\mathrm{bind}^{(i)}$, for three distinct cases. This quantity is defined as the sum of three components: the direct electrostatic interaction energy upon contact ($U_\\mathrm{Coulomb}^{(i)}$), the change in polar solvation free energy due to the residue's transfer from a high-dielectric solvent to a low-dielectric protein environment ($\\Delta G_\\mathrm{polar,\\,desolv}^{(i)}$), and the nonpolar contribution from burying solvent-accessible surface area ($\\Delta G_\\mathrm{nonpolar}^{(i)}$).\n\nThe governing equation is:\n$$\n\\Delta G_\\mathrm{bind}^{(i)} = U_\\mathrm{Coulomb}^{(i)} + \\Delta G_\\mathrm{polar,\\,desolv}^{(i)} + \\Delta G_\\mathrm{nonpolar}^{(i)}\n$$\n\nThe models for each term are provided as:\n1.  Coulomb energy: $U_\\mathrm{Coulomb}^{(i)} = \\frac{k_\\mathrm{c}\\, q_i q_j}{\\varepsilon_\\mathrm{contact}\\, r}$\n2.  Polar desolvation energy: $\\Delta G_\\mathrm{polar,\\,desolv}^{(i)} = \\frac{1}{2}\\, k_\\mathrm{c}\\, \\frac{q_i^2}{R} \\left(\\frac{1}{\\varepsilon_\\mathrm{p}} - \\frac{1}{\\varepsilon_\\mathrm{w}}\\right)$\n3.  Nonpolar energy: $\\Delta G_\\mathrm{nonpolar}^{(i)} = - \\gamma\\, \\Delta A_\\mathrm{buried}$\n\nWe use the following physical constants:\n- Coulomb energy prefactor: $k_c = 138.935456 \\text{ kJ mol}^{-1} \\text{ nm e}^{-2}$\n- Water relative permittivity: $\\varepsilon_\\mathrm{w} = 80.0$\n- Protein interior relative permittivity: $\\varepsilon_\\mathrm{p} = 4.0$\n- Nonpolar surface tension coefficient: $\\gamma = 0.022 \\text{ kJ mol}^{-1} \\text{ Å}^{-2}$\n\nWe now compute $\\Delta G_\\mathrm{bind}^{(i)}$ for each test case.\n\n**Case 1: Strong contact, low-dielectric contact region**\nThe parameters are $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried}) = (+1.0, -1.0, 0.30, 4.0, 0.16, 50.0)$.\n\n- The direct electrostatic interaction energy is:\n$$\nU_\\mathrm{Coulomb}^{(1)} = \\frac{(138.935456) \\cdot (+1.0) \\cdot (-1.0)}{4.0 \\cdot 0.30} = \\frac{-138.935456}{1.2} \\approx -115.77955 \\text{ kJ/mol}\n$$\nThis term is strongly favorable due to the opposite charges at a close distance in a low-dielectric environment.\n\n- The polar desolvation energy is calculated for the charge $q_i = +1.0 \\,e$. This term represents the penalty for moving a charge from the highly polar water environment to the less polar protein interior.\n$$\n\\Delta G_\\mathrm{polar,\\,desolv}^{(1)} = \\frac{1}{2}\\,(138.935456)\\,\\frac{(+1.0)^2}{0.16} \\left(\\frac{1}{4.0} - \\frac{1}{80.0}\\right)\n$$\n$$\n= \\frac{138.935456}{0.32} (0.25 - 0.0125) = 434.1733 \\cdot (0.2375) \\approx +103.11827 \\text{ kJ/mol}\n$$\nThis term is strongly unfavorable, as expected for desolvating a full elementary charge.\n\n- The nonpolar contribution from burying surface area is:\n$$\n\\Delta G_\\mathrm{nonpolar}^{(1)} = -(0.022) \\cdot (50.0) = -1.1 \\text{ kJ/mol}\n$$\nThis is a small, favorable contribution.\n\n- The total binding free energy for residue $i$ in this case is the sum:\n$$\n\\Delta G_\\mathrm{bind}^{(1)} = -115.77955 + 103.11827 - 1.1 = -13.76128 \\text{ kJ/mol}\n$$\nAfter rounding to three decimal places, the result is $-13.761$ kJ/mol. The favorable direct contact energy more than compensates for the large desolvation penalty.\n\n**Case 2: More hydrated contact with higher dielectric**\nThe parameters are $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried}) = (+1.0, -1.0, 0.35, 20.0, 0.16, 30.0)$.\n\n- The direct electrostatic interaction is weakened by the increased distance ($r = 0.35$ nm) and the higher dielectric constant of the contact region ($\\varepsilon_\\mathrm{contact} = 20.0$).\n$$\nU_\\mathrm{Coulomb}^{(2)} = \\frac{(138.935456) \\cdot (+1.0) \\cdot (-1.0)}{20.0 \\cdot 0.35} = \\frac{-138.935456}{7.0} \\approx -19.84792 \\text{ kJ/mol}\n$$\n- The polar desolvation penalty depends on $q_i$ and $R$, which are unchanged from Case 1 ($q_i = +1.0 \\,e, R = 0.16$ nm). Therefore, the value is identical:\n$$\n\\Delta G_\\mathrm{polar,\\,desolv}^{(2)} \\approx +103.11827 \\text{ kJ/mol}\n$$\n- The nonpolar contribution is smaller due to less buried area:\n$$\n\\Delta G_\\mathrm{nonpolar}^{(2)} = -(0.022) \\cdot (30.0) = -0.66 \\text{ kJ/mol}\n$$\n- The total binding free energy contribution is:\n$$\n\\Delta G_\\mathrm{bind}^{(2)} = -19.84792 + 103.11827 - 0.66 = +82.61035 \\text{ kJ/mol}\n$$\nAfter rounding to three decimal places, the result is $+82.610$ kJ/mol. In this scenario, the weakened direct interaction is insufficient to overcome the large desolvation penalty, leading to a highly unfavorable net contribution.\n\n**Case 3: Neutral residue**\nThe parameters are $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried}) = (0.0, 0.0, 0.35, 4.0, 0.20, 120.0)$.\n\n- For a neutral residue, $q_i = 0.0 \\,e$. Both electrostatic terms are zero.\n$$\nU_\\mathrm{Coulomb}^{(3)} = \\frac{k_\\mathrm{c}\\,(0.0)\\,(0.0)}{\\varepsilon_\\mathrm{contact}\\,r} = 0.0 \\text{ kJ/mol}\n$$\n$$\n\\Delta G_\\mathrm{polar,\\,desolv}^{(3)} = \\frac{1}{2}\\,k_\\mathrm{c}\\,\\frac{(0.0)^2}{R}\\left(\\frac{1}{\\varepsilon_\\mathrm{p}} - \\frac{1}{\\varepsilon_\\mathrm{w}}\\right) = 0.0 \\text{ kJ/mol}\n$$\n- The only contribution is from the nonpolar term due to the burial of a significant surface area.\n$$\n\\Delta G_\\mathrm{nonpolar}^{(3)} = -(0.022) \\cdot (120.0) = -2.64 \\text{ kJ/mol}\n$$\n- The total binding free energy contribution is:\n$$\n\\Delta G_\\mathrm{bind}^{(3)} = 0.0 + 0.0 - 2.64 = -2.64 \\text{ kJ/mol}\n$$\nAfter rounding to three decimal places, the result is $-2.640$ kJ/mol. The interaction is purely driven by the hydrophobic effect.\n\nThe final computed values, rounded to three decimal places, for the three cases are: $-13.761$, $82.610$, and $-2.640$ kJ/mol.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes per-residue binding free energy contributions based on a simplified\n    physical model incorporating Coulomb, Born (polar solvation), and nonpolar terms.\n    \"\"\"\n\n    # Define physical constants as provided in the problem statement.\n    K_C = 138.935456  # Coulomb constant in kJ/mol * nm / e^2\n    EPSILON_W = 80.0    # Relative permittivity of water\n    EPSILON_P = 4.0     # Relative permittivity of protein interior\n    GAMMA = 0.022       # Nonpolar surface tension in kJ/mol / Angstrom^2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (q_i, q_j, r, epsilon_contact, R, delta_A_buried)\n    test_cases = [\n        (1.0, -1.0, 0.30, 4.0, 0.16, 50.0),   # Case 1\n        (1.0, -1.0, 0.35, 20.0, 0.16, 30.0),  # Case 2\n        (0.0, 0.0, 0.35, 4.0, 0.20, 120.0),   # Case 3\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        q_i, q_j, r, epsilon_contact, R, delta_A_buried = case\n\n        # 1. Calculate the Coulomb interaction energy term\n        # This term is non-zero only if both charges and the distance are non-zero.\n        # The equation holds as long as r is not zero.\n        if r > 0 and epsilon_contact > 0:\n            u_coulomb = (K_C * q_i * q_j) / (epsilon_contact * r)\n        else:\n            # Handle potential division by zero, although not expected in test cases.\n            u_coulomb = 0.0\n\n        # 2. Calculate the polar desolvation free energy term\n        # This term is non-zero only if the charge q_i and its Born radius R are non-zero.\n        if R > 0:\n            delta_g_polar = 0.5 * K_C * (q_i**2 / R) * (1/EPSILON_P - 1/EPSILON_W)\n        else:\n            delta_g_polar = 0.0\n\n        # 3. Calculate the nonpolar free energy term\n        delta_g_nonpolar = -GAMMA * delta_A_buried\n\n        # 4. Sum the components to get the total binding free energy contribution\n        delta_g_bind = u_coulomb + delta_g_polar + delta_g_nonpolar\n\n        # Round the final result to three decimal places as required.\n        results.append(round(delta_g_bind, 3))\n\n    # Format the final output string exactly as specified.\n    # Using np.format_float_positional to ensure trailing zeros are included for rounding.\n    formatted_results = [np.format_float_positional(res, precision=3, fractional=True, pad_right=3) for res in results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond polar interactions, the nonpolar contributions to binding free energy, often summarized as the hydrophobic effect, are critical drivers of complex formation. This exercise guides you to derive and apply a common model for the nonpolar solvation energy, separating it into a cavity formation term proportional to the solvent-accessible surface area ($SASA$) and a solute-solvent dispersion term. This practice () illuminates the physical principles behind the nonpolar components frequently used in methods like MM/GBSA and MM/PBSA.",
            "id": "3836702",
            "problem": "You are given a task grounded in statistical mechanics and physical chemistry to compute the change in nonpolar solvation free energy upon binding between a receptor and a ligand. The change in nonpolar solvation free energy upon binding is defined as the difference in nonpolar solvation free energy of the complex and the sum of those of the separated receptor and ligand. Begin from the following fundamental bases:\n\n- The change in free energy associated with coupling a solute to a solvent can be written in terms of a coupling parameter $\\lambda$ that scales the interaction Hamiltonian between the solute and the solvent from $\\lambda = 0$ (no interaction) to $\\lambda = 1$ (full interaction). The reversible work (free energy change) is given by the integral of the ensemble average of the derivative of the Hamiltonian with respect to $\\lambda$.\n- The nonpolar solvation free energy is decomposed into a cavity-formation contribution and a dispersion (van der Waals) contribution. The cavity term is modeled using solvent-accessible surface area (SASA) and a macroscopic surface tension coefficient.\n- The dispersion interaction energy between solute and solvent at full coupling is available as an ensemble average and may be treated within a linear response approximation where the ensemble average at intermediate $\\lambda$ scales linearly with $\\lambda$.\n\nUsing only these bases, derive an explicit, computable expression for the change in nonpolar solvation free energy upon binding in terms of:\n- The solvent-accessible surface areas of the receptor, ligand, and complex.\n- A surface tension coefficient.\n- The ensemble-averaged solute–solvent dispersion interaction energies of the receptor, ligand, and complex at full coupling.\n\nAssume the following modeling choices and data conventions for computation:\n- The cavity formation free energy for a solute is proportional to its solvent-accessible surface area, with proportionality coefficient equal to a surface tension parameter in the same units, and no constant offset term.\n- The dispersion contribution for a solute under a linear-response model is computed using a coupling parameter integral and a linear scaling of the ensemble average with the coupling parameter.\n- The change upon binding is computed as the free energy of the complex minus the sum of the free energies of the separated receptor and ligand.\n\nAll energies must be expressed in kilojoules per mole (kJ/mol). All surface areas must be expressed in square nanometers (nm$^2$). The surface tension coefficient must be expressed in kJ mol$^{-1}$ nm$^{-2}$. The final reported change in nonpolar solvation free energy upon binding for each test case must be reported in kJ/mol, rounded to three decimal places.\n\nImplement your derivation in a program that processes the following test suite. Each test case is a tuple containing:\n- Surface tension coefficient $\\gamma$ (in kJ mol$^{-1}$ nm$^{-2}$).\n- Solvent-accessible surface areas: $\\mathrm{SASA}_\\mathrm{R}$, $\\mathrm{SASA}_\\mathrm{L}$, $\\mathrm{SASA}_\\mathrm{C}$ (in nm$^2$).\n- Ensemble-averaged solute–solvent dispersion interaction energies at full coupling: $U_\\mathrm{R}$, $U_\\mathrm{L}$, $U_\\mathrm{C}$ (in kJ/mol).\n\nUse the following test suite with scientifically plausible values:\n- Case $1$: $\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 120.0$, $\\mathrm{SASA}_\\mathrm{L} = 15.0$, $\\mathrm{SASA}_\\mathrm{C} = 125.0$, $U_\\mathrm{R} = -800.0$, $U_\\mathrm{L} = -140.0$, $U_\\mathrm{C} = -870.0$.\n- Case $2$: $\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 100.0$, $\\mathrm{SASA}_\\mathrm{L} = 20.0$, $\\mathrm{SASA}_\\mathrm{C} = 105.0$, $U_\\mathrm{R} = -600.0$, $U_\\mathrm{L} = -150.0$, $U_\\mathrm{C} = -710.0$.\n- Case $3$: $\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 80.0$, $\\mathrm{SASA}_\\mathrm{L} = 10.0$, $\\mathrm{SASA}_\\mathrm{C} = 90.0$, $U_\\mathrm{R} = -500.0$, $U_\\mathrm{L} = -80.0$, $U_\\mathrm{C} = -560.0$.\n- Case $4$: $\\gamma = 0.00$, $\\mathrm{SASA}_\\mathrm{R} = 110.0$, $\\mathrm{SASA}_\\mathrm{L} = 12.0$, $\\mathrm{SASA}_\\mathrm{C} = 118.0$, $U_\\mathrm{R} = -700.0$, $U_\\mathrm{L} = -100.0$, $U_\\mathrm{C} = -790.0$.\n- Case $5$: $\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 90.0$, $\\mathrm{SASA}_\\mathrm{L} = 15.0$, $\\mathrm{SASA}_\\mathrm{C} = 105.0$, $U_\\mathrm{R} = -650.0$, $U_\\mathrm{L} = -120.0$, $U_\\mathrm{C} = -770.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4,x_5]$), where each $x_i$ is the computed change in nonpolar solvation free energy upon binding (in kJ/mol, rounded to three decimals) for the corresponding test case in the order listed above.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of statistical mechanics as applied to physical chemistry, specifically in the context of molecular simulation and free energy calculations. The problem is well-posed, objective, and internally consistent, providing all necessary definitions, variables, and data for a unique solution. The derivation proceeds from the fundamental principles provided.\n\nThe primary objective is to derive an expression for the change in nonpolar solvation free energy upon binding, denoted as $\\Delta\\Delta G_{\\mathrm{np}}$. This quantity is defined as the difference between the nonpolar solvation free energy of the receptor-ligand complex ($\\mathrm{C}$) and the sum of the nonpolar solvation free energies of the individual receptor ($\\mathrm{R}$) and ligand ($\\mathrm{L}$).\n$$\n\\Delta\\Delta G_{\\mathrm{np}} = \\Delta G_{\\mathrm{np}}(\\mathrm{C}) - \\left( \\Delta G_{\\mathrm{np}}(\\mathrm{R}) + \\Delta G_{\\mathrm{np}}(\\mathrm{L}) \\right)\n$$\n\nThe nonpolar solvation free energy, $\\Delta G_{\\mathrm{np}}$, for any given solute $X$ (where $X$ can be $\\mathrm{R}$, $\\mathrm{L}$, or $\\mathrm{C}$) is decomposed into two contributions: a cavity formation term, $\\Delta G_{\\mathrm{cav}}$, and a dispersion interaction term, $\\Delta G_{\\mathrm{disp}}$.\n$$\n\\Delta G_{\\mathrm{np}}(X) = \\Delta G_{\\mathrm{cav}}(X) + \\Delta G_{\\mathrm{disp}}(X)\n$$\n\nFirst, we derive the expression for the cavity formation term, $\\Delta G_{\\mathrm{cav}}(X)$. The problem states that this term is proportional to the solute's solvent-accessible surface area ($\\mathrm{SASA}_X$) with a proportionality coefficient equal to the surface tension, $\\gamma$.\n$$\n\\Delta G_{\\mathrm{cav}}(X) = \\gamma \\cdot \\mathrm{SASA}_X\n$$\n\nNext, we derive the expression for the dispersion term, $\\Delta G_{\\mathrm{disp}}(X)$. The problem provides the fundamental thermodynamic integration formula for a free energy change with respect to a coupling parameter $\\lambda$:\n$$\n\\Delta G_{\\mathrm{disp}}(X) = \\int_0^1 \\left\\langle \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\right\\rangle_\\lambda d\\lambda\n$$\nHere, $H(\\lambda)$ is the system Hamiltonian, and $\\lambda$ couples the solute-solvent dispersion interactions, scaling them from $0$ (no interaction) at $\\lambda=0$ to $1$ (full interaction) at $\\lambda=1$. The term $\\frac{\\partial H(\\lambda)}{\\partial \\lambda}$ represents the solute-solvent dispersion interaction potential. Its ensemble average at a given $\\lambda$ is denoted $\\langle U_{\\mathrm{disp},X}(\\lambda) \\rangle$. Thus, the expression becomes:\n$$\n\\Delta G_{\\mathrm{disp}}(X) = \\int_0^1 \\langle U_{\\mathrm{disp},X}(\\lambda) \\rangle d\\lambda\n$$\nThe problem specifies the use of a linear response approximation (LRA), which posits that the ensemble-averaged interaction energy scales linearly with the coupling parameter $\\lambda$. Let $U_X$ be the ensemble-averaged solute-solvent dispersion interaction energy at full coupling ($\\lambda=1$). The LRA model is thus:\n$$\n\\langle U_{\\mathrm{disp},X}(\\lambda) \\rangle = \\lambda \\cdot \\langle U_{\\mathrm{disp},X}(\\lambda=1) \\rangle = \\lambda U_X\n$$\nThis linear relationship holds because the interaction energy is zero at $\\lambda=0$. Substituting the LRA into the integral yields:\n$$\n\\Delta G_{\\mathrm{disp}}(X) = \\int_0^1 (\\lambda U_X) d\\lambda = U_X \\int_0^1 \\lambda d\\lambda = U_X \\left[ \\frac{\\lambda^2}{2} \\right]_0^1 = U_X \\left( \\frac{1^2}{2} - \\frac{0^2}{2} \\right) = \\frac{1}{2} U_X\n$$\n\nNow, we can write the complete expression for the nonpolar solvation free energy of a single solute $X$:\n$$\n\\Delta G_{\\mathrm{np}}(X) = \\gamma \\cdot \\mathrm{SASA}_X + \\frac{1}{2} U_X\n$$\n\nFinally, we substitute this expression back into the definition of the change upon binding, $\\Delta\\Delta G_{\\mathrm{np}}$:\n$$\n\\Delta\\Delta G_{\\mathrm{np}} = \\left(\\gamma \\cdot \\mathrm{SASA}_{\\mathrm{C}} + \\frac{1}{2} U_{\\mathrm{C}}\\right) - \\left[ \\left(\\gamma \\cdot \\mathrm{SASA}_{\\mathrm{R}} + \\frac{1}{2} U_{\\mathrm{R}}\\right) + \\left(\\gamma \\cdot \\mathrm{SASA}_{\\mathrm{L}} + \\frac{1}{2} U_{\\mathrm{L}}\\right) \\right]\n$$\nGrouping the terms by the surface tension coefficient $\\gamma$ and the dispersion energies $U_X$ gives the final, computable expression:\n$$\n\\Delta\\Delta G_{\\mathrm{np}} = \\gamma \\left( \\mathrm{SASA}_{\\mathrm{C}} - \\mathrm{SASA}_{\\mathrm{R}} - \\mathrm{SASA}_{\\mathrm{L}} \\right) + \\frac{1}{2} \\left( U_{\\mathrm{C}} - U_{\\mathrm{R}} - U_{\\mathrm{L}} \\right)\n$$\nThis equation is implemented to compute the required values for the provided test suite. The change in surface area, $\\Delta\\mathrm{SASA} = \\mathrm{SASA}_{\\mathrm{C}} - \\mathrm{SASA}_{\\mathrm{R}} - \\mathrm{SASA}_{\\mathrm{L}}$, is typically negative, representing the surface area buried upon complex formation. The change in dispersion interaction energy, $\\Delta U = U_{\\mathrm{C}} - U_{\\mathrm{R}} - U_{\\mathrm{L}}$, reflects the net change in van der Waals interactions between the solutes and the solvent.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in nonpolar solvation free energy upon binding\n    for a series of test cases based on a derived formula.\n    \"\"\"\n    \n    # Test suite from the problem statement.\n    # Each tuple contains:\n    # (gamma, sasa_r, sasa_l, sasa_c, u_r, u_l, u_c)\n    # gamma: surface tension coefficient (kJ mol^-1 nm^-2)\n    # sasa_x: solvent-accessible surface area (nm^2) for Receptor, Ligand, Complex\n    # u_x: ensemble-avg dispersion energy (kJ/mol) for Receptor, Ligand, Complex\n    test_cases = [\n        (2.20, 120.0, 15.0, 125.0, -800.0, -140.0, -870.0),\n        (2.20, 100.0, 20.0, 105.0, -600.0, -150.0, -710.0),\n        (2.20, 80.0, 10.0, 90.0, -500.0, -80.0, -560.0),\n        (0.00, 110.0, 12.0, 118.0, -700.0, -100.0, -790.0),\n        (2.20, 90.0, 15.0, 105.0, -650.0, -120.0, -770.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, sasa_r, sasa_l, sasa_c, u_r, u_l, u_c = case\n\n        # Calculate the change in solvent-accessible surface area upon binding.\n        # This is the surface area of the complex minus the sum for the separate molecules.\n        delta_sasa = sasa_c - (sasa_r + sasa_l)\n\n        # Calculate the change in the solute-solvent dispersion interaction energy.\n        delta_u = u_c - (u_r + u_l)\n\n        # The final formula for the change in nonpolar solvation free energy is:\n        # delta_delta_G_np = gamma * delta_sasa + 0.5 * delta_u\n        delta_delta_g_np = gamma * delta_sasa + 0.5 * delta_u\n        \n        # Format the result to three decimal places and add to the list.\n        results.append(f\"{delta_delta_g_np:.3f}\")\n\n    # Print the final results in the specified comma-separated list format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A primary goal of free energy decomposition is to pinpoint which specific residues are most critical for binding affinity, guiding efforts in drug design and protein engineering. This final practice integrates the concepts from the previous exercises into a comprehensive per-residue decomposition within the MM/GBSA framework, simulating a real-world analysis. By calculating individual residue contributions and comparing them to experimental mutagenesis data (), you will learn how to assess the predictive power of your computational model, a vital skill for any computational chemical biologist.",
            "id": "3836709",
            "problem": "You are tasked with implementing a principled per-residue binding free energy decomposition within the Molecular Mechanics/Generalized Born Surface Area (MM/GBSA) framework and evaluating its predictive power against experimental mutational free energy changes. The goal is to explicitly construct per-residue binding contributions from first principles based on pairwise-additive force fields and continuum solvation approximations, and then quantify the correlation between these decomposed energetic predictions and experimentally measured mutation-induced binding free energy changes.\n\nFundamental base and modeling assumptions:\n- From equilibrium statistical mechanics, the binding free energy between a receptor and a ligand is defined by the difference in Helmholtz free energies, and is related to the equilibrium association constant by $ \\Delta G_{\\text{bind}} = - k_{\\mathrm{B}} T \\ln K_{\\mathrm{a}} $, where $ k_{\\mathrm{B}} $ is the Boltzmann constant and $ T $ is temperature. In classical molecular mechanics with pairwise-additive potentials, the potential energy is the sum over interaction terms assigned to atoms and residues. In continuum electrostatics, the polar solvation contribution is modeled by Generalized Born theory, and the nonpolar term is approximated as proportional to solvent-accessible surface area.\n- In per-residue decomposition within MM/GBSA (Molecular Mechanics/Generalized Born Surface Area), the binding contribution of residue $ i $ is approximated by the difference between its energetic components in the bound state and those in the separated (unbound) state. The components considered here are molecular mechanics van der Waals, Coulombic electrostatics, Generalized Born polar solvation, and surface-area-based nonpolar solvation. Residue-level entropic terms are not included in this decomposition, and the reported energies are enthalpic components expressed in kilocalorie per mole (kcal/mol).\n\nProgram requirements:\n- For each residue $ i $, define the per-residue binding contribution as the sum over the four energetic components (van der Waals, Coulombic, polar solvation, nonpolar solvation) in the bound state minus the corresponding sum in the separated state. The result per residue must be returned in kilocalorie per mole (kcal/mol).\n- Predict the mutation-induced change in binding free energy per residue by assuming that mutation to alanine or to a residue that removes specific side-chain interactions approximately removes the residue’s binding contribution. Under this approximation, the predicted experimental mutational free energy change for residue $ i $ is $ \\widehat{\\Delta \\Delta G}_i = - \\Delta G^{\\text{res}}_i $, expressed in kilocalorie per mole (kcal/mol).\n- Evaluate the Pearson correlation coefficient between the predicted $ \\widehat{\\Delta \\Delta G}_i $ and the experimentally measured $ \\Delta \\Delta G^{\\text{exp}}_i $ across residues for each test case. The Pearson correlation is dimensionless. Angles, if any, are not applicable in this task.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the Pearson correlation coefficient (a float) for one test case in the order provided below, for a total of three values. No other text should be printed.\n\nTest suite (energies in kilocalorie per mole for each residue and component; arrays align by index; all numbers are given per residue):\n\nTest Case $1$ (happy path; strong positive correlation expected):\n- Bound-state van der Waals: $[-1.8, -0.5, -2.2, -0.9, -0.2, -1.0]$\n- Bound-state Coulombic: $[-1.2, 0.4, -0.8, -0.1, 0.3, -0.5]$\n- Bound-state Generalized Born (polar): $[0.9, -0.2, 0.6, 0.1, -0.1, 0.4]$\n- Bound-state surface-area (nonpolar): $[-0.2, -0.05, -0.15, -0.08, -0.02, -0.1]$\n- Separated-state van der Waals: $[-0.6, -0.2, -0.8, -0.4, -0.1, -0.3]$\n- Separated-state Coulombic: $[-0.5, 0.1, -0.2, 0.0, 0.1, -0.1]$\n- Separated-state Generalized Born (polar): $[0.4, -0.1, 0.3, 0.05, -0.05, 0.2]$\n- Separated-state surface-area (nonpolar): $[-0.08, -0.02, -0.05, -0.03, -0.01, -0.04]$\n- Experimental $ \\Delta \\Delta G $: $[1.6, 0.2, 1.7, 0.5, -0.1, 0.9]$\n\nTest Case $2$ (anticorrelation; large negative correlation expected):\n- Bound-state van der Waals: $[-0.7, -1.5, -0.3, -1.1, -0.4]$\n- Bound-state Coulombic: $[0.2, -0.6, 0.1, -0.3, -0.2]$\n- Bound-state Generalized Born (polar): $[-0.1, 0.5, -0.05, 0.2, 0.1]$\n- Bound-state surface-area (nonpolar): $[-0.05, -0.12, -0.02, -0.08, -0.03]$\n- Separated-state van der Waals: $[-0.5, -0.9, -0.2, -0.6, -0.3]$\n- Separated-state Coulombic: $[0.1, -0.3, 0.0, -0.1, -0.1]$\n- Separated-state Generalized Born (polar): $[-0.05, 0.2, -0.02, 0.1, 0.05]$\n- Separated-state surface-area (nonpolar): $[-0.02, -0.06, -0.01, -0.04, -0.02]$\n- Experimental $ \\Delta \\Delta G $: $[-0.15, -0.7, -0.05, -0.6, -0.2]$\n\nTest Case $3$ (edge case; near-zero correlation expected):\n- Bound-state van der Waals: $[-0.6, -0.2, -1.1, -0.05, -0.8, -0.3, -0.9]$\n- Bound-state Coulombic: $[-0.3, 0.05, -0.2, 0.0, -0.4, 0.1, -0.1]$\n- Bound-state Generalized Born (polar): $[0.25, -0.02, 0.3, 0.01, 0.35, -0.01, 0.2]$\n- Bound-state surface-area (nonpolar): $[-0.06, -0.01, -0.09, -0.005, -0.07, -0.02, -0.08]$\n- Separated-state van der Waals: $[-0.4, -0.1, -0.5, -0.02, -0.6, -0.2, -0.7]$\n- Separated-state Coulombic: $[-0.2, 0.02, -0.1, 0.0, -0.3, 0.05, -0.05]$\n- Separated-state Generalized Born (polar): $[0.1, -0.01, 0.15, 0.005, 0.2, -0.005, 0.1]$\n- Separated-state surface-area (nonpolar): $[-0.03, -0.005, -0.04, -0.002, -0.035, -0.01, -0.04]$\n- Experimental $ \\Delta \\Delta G $: $[0.3, -0.1, 0.2, 0.05, -0.05, 0.12, -0.08]$\n\nAnswer specification:\n- The final output must be a single line: a comma-separated list enclosed in square brackets, containing the Pearson correlation coefficients (floats) for Test Case $1$, Test Case $2$, and Test Case $3$ in that order, with no additional whitespace or text. The correlation coefficients are dimensionless. All energy computations must be carried out in kilocalorie per mole (kcal/mol).",
            "solution": "The problem requires the implementation of a per-residue binding free energy decomposition based on the Molecular Mechanics/Generalized Born Surface Area (MM/GBSA) framework. The predictive accuracy of this method is to be evaluated by comparing its predictions for mutational free energy changes to experimental data using the Pearson correlation coefficient. The problem is scientifically grounded, well-posed, and provides all necessary data and definitions for a unique solution.\n\nThe core of the task is to calculate, for each residue $i$ in a given system, its contribution to the binding free energy, and then to correlate these calculated contributions with experimentally measured changes in binding affinity upon mutation.\n\nThe per-residue binding contribution, denoted as $\\Delta G^{\\text{res}}_i$, is defined as the difference between the total energy of residue $i$ in the bound (complex) state and its total energy in the separated (unbound) state. The total energy for a residue is the sum of four components: van der Waals ($E^{\\text{vdW}}$), Coulombic ($E^{\\text{Coul}}$), polar solvation from Generalized Born theory ($E^{\\text{GB}}$), and nonpolar solvation from a surface area model ($E^{\\text{SA}}$). All energies are expressed in units of kilocalorie per mole (kcal/mol).\n\nFirst, for each residue $i$, we compute its total energy in the bound state, $E^{\\text{bound}}_i$, by summing the provided components:\n$$ E^{\\text{bound}}_i = E^{\\text{vdW}}_{\\text{bound}, i} + E^{\\text{Coul}}_{\\text{bound}, i} + E^{\\text{GB}}_{\\text{bound}, i} + E^{\\text{SA}}_{\\text{bound}, i} $$\n\nSimilarly, we compute its total energy in the separated state, $E^{\\text{sep}}_i$:\n$$ E^{\\text{sep}}_i = E^{\\text{vdW}}_{\\text{sep}, i} + E^{\\text{Coul}}_{\\text{sep}, i} + E^{\\text{GB}}_{\\text{sep}, i} + E^{\\text{SA}}_{\\text{sep}, i} $$\n\nThe per-residue binding contribution $\\Delta G^{\\text{res}}_i$ is then the difference between these two quantities. It represents the net energetic change for residue $i$ upon binding.\n$$ \\Delta G^{\\text{res}}_i = E^{\\text{bound}}_i - E^{\\text{sep}}_i $$\n\nThe problem posits a common approximation used in computational mutagenesis studies: the change in binding free energy upon mutating residue $i$ to a smaller residue like alanine ($\\Delta \\Delta G_i$) can be estimated as the negative of that residue's binding contribution. This assumes the mutation effectively \"removes\" the side chain's contribution without introducing other significant perturbations. The predicted mutational free energy change, $\\widehat{\\Delta \\Delta G}_i$, is therefore:\n$$ \\widehat{\\Delta \\Delta G}_i = - \\Delta G^{\\text{res}}_i $$\n\nFinally, to assess the quality of these predictions, we calculate the Pearson correlation coefficient, $r$, between the vector of predicted values, $\\widehat{\\mathbf{\\Delta \\Delta G}} = (\\widehat{\\Delta \\Delta G}_1, \\dots, \\widehat{\\Delta \\Delta G}_n)$, and the vector of experimentally measured values, $\\mathbf{\\Delta \\Delta G}^{\\text{exp}} = (\\Delta \\Delta G^{\\text{exp}}_1, \\dots, \\Delta \\Delta G^{\\text{exp}}_n)$. The formula for the Pearson correlation coefficient is:\n$$ r = \\frac{\\sum_{i=1}^{n} (\\widehat{\\Delta \\Delta G}_i - \\overline{\\widehat{\\Delta \\Delta G}}) (\\Delta \\Delta G^{\\text{exp}}_i - \\overline{\\Delta \\Delta G^{\\text{exp}}})}{\\sqrt{\\sum_{i=1}^{n} (\\widehat{\\Delta \\Delta G}_i - \\overline{\\widehat{\\Delta \\Delta G}})^2} \\sqrt{\\sum_{i=1}^{n} (\\Delta \\Delta G^{\\text{exp}}_i - \\overline{\\Delta \\Delta G^{\\text{exp}}})^2}} $$\nwhere $n$ is the number of residues, and the overbar denotes the arithmetic mean of the vector elements.\n\nThis calculation is repeated for each of the three test cases provided. The implementation will utilize the `numpy` library for efficient array manipulations. For each test case, the input data vectors will be combined to compute the $\\widehat{\\mathbf{\\Delta \\Delta G}}$ vector, and then `numpy.corrcoef` will be used to compute the correlation coefficient with the corresponding $\\mathbf{\\Delta \\Delta G}^{\\text{exp}}$ vector. The resulting correlation coefficients for the three test cases are collected and formatted into the required output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Pearson correlation coefficient between predicted and experimental\n    mutational free energy changes based on MM/GBSA per-residue energy decomposition.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            \"vdW_bound\": np.array([-1.8, -0.5, -2.2, -0.9, -0.2, -1.0]),\n            \"coul_bound\": np.array([-1.2, 0.4, -0.8, -0.1, 0.3, -0.5]),\n            \"gb_bound\": np.array([0.9, -0.2, 0.6, 0.1, -0.1, 0.4]),\n            \"sa_bound\": np.array([-0.2, -0.05, -0.15, -0.08, -0.02, -0.1]),\n            \"vdW_sep\": np.array([-0.6, -0.2, -0.8, -0.4, -0.1, -0.3]),\n            \"coul_sep\": np.array([-0.5, 0.1, -0.2, 0.0, 0.1, -0.1]),\n            \"gb_sep\": np.array([0.4, -0.1, 0.3, 0.05, -0.05, 0.2]),\n            \"sa_sep\": np.array([-0.08, -0.02, -0.05, -0.03, -0.01, -0.04]),\n            \"exp_ddG\": np.array([1.6, 0.2, 1.7, 0.5, -0.1, 0.9])\n        },\n        # Test Case 2\n        {\n            \"vdW_bound\": np.array([-0.7, -1.5, -0.3, -1.1, -0.4]),\n            \"coul_bound\": np.array([0.2, -0.6, 0.1, -0.3, -0.2]),\n            \"gb_bound\": np.array([-0.1, 0.5, -0.05, 0.2, 0.1]),\n            \"sa_bound\": np.array([-0.05, -0.12, -0.02, -0.08, -0.03]),\n            \"vdW_sep\": np.array([-0.5, -0.9, -0.2, -0.6, -0.3]),\n            \"coul_sep\": np.array([0.1, -0.3, 0.0, -0.1, -0.1]),\n            \"gb_sep\": np.array([-0.05, 0.2, -0.02, 0.1, 0.05]),\n            \"sa_sep\": np.array([-0.02, -0.06, -0.01, -0.04, -0.02]),\n            \"exp_ddG\": np.array([-0.15, -0.7, -0.05, -0.6, -0.2])\n        },\n        # Test Case 3\n        {\n            \"vdW_bound\": np.array([-0.6, -0.2, -1.1, -0.05, -0.8, -0.3, -0.9]),\n            \"coul_bound\": np.array([-0.3, 0.05, -0.2, 0.0, -0.4, 0.1, -0.1]),\n            \"gb_bound\": np.array([0.25, -0.02, 0.3, 0.01, 0.35, -0.01, 0.2]),\n            \"sa_bound\": np.array([-0.06, -0.01, -0.09, -0.005, -0.07, -0.02, -0.08]),\n            \"vdW_sep\": np.array([-0.4, -0.1, -0.5, -0.02, -0.6, -0.2, -0.7]),\n            \"coul_sep\": np.array([-0.2, 0.02, -0.1, 0.0, -0.3, 0.05, -0.05]),\n            \"gb_sep\": np.array([0.1, -0.01, 0.15, 0.005, 0.2, -0.005, 0.1]),\n            \"sa_sep\": np.array([-0.03, -0.005, -0.04, -0.002, -0.035, -0.01, -0.04]),\n            \"exp_ddG\": np.array([0.3, -0.1, 0.2, 0.05, -0.05, 0.12, -0.08])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate total energy per residue in the bound state\n        E_bound = (case[\"vdW_bound\"] + case[\"coul_bound\"] + \n                   case[\"gb_bound\"] + case[\"sa_bound\"])\n\n        # Calculate total energy per residue in the separated state\n        E_sep = (case[\"vdW_sep\"] + case[\"coul_sep\"] + \n                 case[\"gb_sep\"] + case[\"sa_sep\"])\n        \n        # Calculate per-residue binding contribution\n        # delta_G_res = E_bound - E_sep\n        delta_G_res = E_bound - E_sep\n        \n        # Calculate predicted mutational free energy change\n        # predicted_ddG = -delta_G_res\n        predicted_ddG = -delta_G_res\n        \n        # Calculate Pearson correlation coefficient between predicted and experimental ddG\n        # np.corrcoef returns a 2x2 matrix, the correlation is at [0, 1] or [1, 0]\n        correlation_matrix = np.corrcoef(predicted_ddG, case[\"exp_ddG\"])\n        correlation = correlation_matrix[0, 1]\n        \n        results.append(correlation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}