{
    "hands_on_practices": [
        {
            "introduction": "在构建任何机器学习势函数之前，首要任务是将原子坐标转化为一种能捕捉局部化学环境并遵守物理对称性的数值表示。这些表示，即描述符，是模型与物理世界之间的桥梁。本练习将引导您扮演模型开发者的角色，利用液态水等真实系统的结构数据（如径向分布函数），来为对称函数选择合适的超参数()。通过这个过程，您将学习如何将抽象的数学参数与具体的物理特征（如键长和配位壳层）联系起来，这是设计高精度势函数的基础。",
            "id": "3851748",
            "problem": "您的任务是为机器学习（ML）原子间势设计以原子为中心的描述符，以解析液态水中的氢键几何构型。考虑一个对称函数框架，其中径向特征由超参数 $(\\eta, r_s, r_c)$ 参数化，角向特征由控制方向敏感度的形状和锐度项参数化。您的设计必须基于液态水有物理依据的结构统计数据和窗函数的基本性质来证明其合理性。\n\n假设关于环境条件下液态水的以下结构事实已在实验和计算上得到充分证实：\n- 氧-氧径向分布函数（RDF），$g_{OO}(r)$，在 $r \\approx 2.8\\,\\mathrm{\\AA}$ 处有一个显著的第一峰，其近似峰宽（单西格玛尺度）为 $0.25\\,\\mathrm{\\AA}$；在 $r \\approx 4.5\\,\\mathrm{\\AA}$ 处有一个第二近邻峰，其近似宽度为 $0.30\\,\\mathrm{\\AA}$。\n- 氧-氢径向分布函数，$g_{OH}(r)$，在 $r \\approx 0.97\\,\\mathrm{\\AA}$ 处有一个非常尖銳的分子内峰，宽度约为 $0.05\\,\\mathrm{\\AA}$；并在 $r \\approx 1.8\\,\\mathrm{\\AA}$ 附近有一个较弱的分子间肩峰，宽度约为 $0.20\\,\\mathrm{\\AA}$。\n- 供体氢键几何构型的特征是供体氧-氢矢量与供体氧-受体氧矢量的对齐。将供体氧上的角相关函数 $C_{OHO}(\\theta)$ 定义为分子内矢量 $\\vec{r}_{OH}$ 与指向第一壳层近邻的矢量 $\\vec{r}_{OO}$ 之间的夹角 $\\theta$ 的分布。该相关性在 $\\theta \\approx 0^\\circ$ 处有强烈的峰值，典型展宽约为 $20^\\circ$，反映了强氢键中的近共线性。\n\n您将使用以下通用设计原则：\n- RDF $g_{\\alpha\\beta}(r)$ 编码了在距离类型为 $\\alpha$ 的参考原子 $r$ 处找到类型为 $\\beta$ 的近邻的概率密度。在数密度为 $\\rho_\\beta$ 的各向同性系统中，$g_{\\alpha\\beta}(r)$ 可以通过 $g_{\\alpha\\beta}(r) = \\frac{1}{4\\pi r^2 \\rho_\\beta} \\frac{dN_{\\alpha\\beta}(r)}{dr}$ 与期望的近邻数相关联，$g_{\\alpha\\beta}(r)$ 中的峰识别出配位壳层。\n- 一个以 $r_s$ 为中心、超参数为 $\\eta$ 的类高斯径向窗会衰减远离 $r_s$ 的贡献。对于形式为 $\\exp\\!\\left[-\\eta (r - r_s)^2\\right]$ 的窗，其振幅相对于峰值下降到 $e^{-1}$ 时的距离为 $\\Delta r = 1/\\sqrt{\\eta}$，这可作为 $r_s$ 周围的有效分辨率尺度。\n- 一个以供体氧为中心的角向三体项应增加 $\\vec{r}_{OH}$ 和 $\\vec{r}_{OO}$ 之间小角度的权重，以表示沿供体 O–H 方向的近线性氢键。应使用一个可调的锐度参数来匹配观测到的 $\\theta \\approx 0^\\circ$ 附近的角展宽。\n\n您的目标是为氧-氧和氧-氢径向通道选择 $(\\eta, r_s, r_c)$，以及合适的角向参数，以便描述符能够同时区分：\n- 第一和第二氧配位壳层，\n- 分子内氧-氢共价键，\n- 氢键特有的近共线的供体O–H到O–O排列。\n\n下面哪个选项在与所提供的结构统计数据保持物理一致性的同时，最佳地满足了这些要求？\n\nA. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用两个氧-氧径向窗，其 $(\\eta, r_s)$ 分别为 $\\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和 $\\left(11\\,\\mathrm{\\AA}^{-2}, 4.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子内窗，其 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 三元组的以氧为中心的角向项，该项使用“余弦位移幂”形式，其参数对应于对 $\\theta \\approx 0^\\circ$ 的偏好，锐度参数为 $\\zeta = 10$，从而强调 $\\vec{r}_{OH}$ 和 $\\vec{r}_{OO}$ 之间的小角度。\n\nB. 选择 $r_c = 3.0\\,\\mathrm{\\AA}$。使用一个氧-氧径向窗，其 $(\\eta, r_s) = \\left(8\\,\\mathrm{\\AA}^{-2}, 3.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子间窗，其 $(\\eta, r_s) = \\left(5\\,\\mathrm{\\AA}^{-2}, 1.8\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的以氧为中心的角向项，其参数对应于对 $\\theta \\approx 180^\\circ$ 的偏好，锐度参数为 $\\zeta = 4$。\n\nC. 选择 $r_c = 8.0\\,\\mathrm{\\AA}$。使用宽窗，氧-氧窗的 $(\\eta, r_s) = \\left(1\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$，氧-氢窗的 $(\\eta, r_s) = \\left(2\\,\\mathrm{\\AA}^{-2}, 1.0\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的以氧为中心的角向项，该项不强烈偏好任何角度，使用的是一个非常平缓的锐度参数 $\\zeta = 1$。\n\nD. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用氧-氧窗 $(\\eta, r_s) = \\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和氧-氢窗 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的以氧为中心的角向项，其参数对应于对 $\\theta \\approx 180^\\circ$ 的偏好，锐度参数为 $\\zeta = 10$。\n\n选择唯一的最佳选项。",
            "solution": "用户提供了一个问题，要求为一个专用于液态水模拟的机器学习势设计和选择原子中心描述符集的最优超参数。该问题需要在对称函数框架内解决。选择必须基于所提供的液态水结构统计数据来证明其合理性。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n\n- **系统**：液态水。\n- **目标**：为机器学习（ML）原子间势设计以原子为中心的描述符，以解析氢键几何构型。\n- **框架**：对称函数框架。\n- **径向特征**：由超参数 $(\\eta, r_s, r_c)$ 参数化。\n- **角向特征**：由形状和锐度项参数化。\n- **设计目标**：描述符必须区分：\n    1. 第一和第二氧配位壳层。\n    2. 分子内氧-氢共价键。\n    3. 近共线的供体O–H到O–O排列。\n- **结构数据**：\n    - **$g_{OO}(r)$**：第一峰位于 $r \\approx 2.8\\,\\mathrm{\\AA}$ (宽度 $\\approx 0.25\\,\\mathrm{\\AA}$)；第二峰位于 $r \\approx 4.5\\,\\mathrm{\\AA}$ (宽度 $\\approx 0.30\\,\\mathrm{\\AA}$)。\n    - **$g_{OH}(r)$**：分子内峰位于 $r \\approx 0.97\\,\\mathrm{\\AA}$ (宽度 $\\approx 0.05\\,\\mathrm{\\AA}$)；分子间肩峰位于 $r \\approx 1.8\\,\\mathrm{\\AA}$ (宽度 $\\approx 0.20\\,\\mathrm{\\AA}$)。\n    - **氢键角**：分子内矢量 $\\vec{r}_{OH}$ 与分子间矢量 $\\vec{r}_{OO}$（从供体O到受体O）之间的夹角 $\\theta$ 在 $\\theta \\approx 0^\\circ$ 处有强峰，展宽约为 $20^\\circ$。\n- **设计原则**：\n    - RDFs ($g_{\\alpha\\beta}(r)$) 中的峰对应配位壳层。\n    - 径向窗函数形式：$\\exp\\!\\left[-\\eta (r - r_s)^2\\right]$。\n    - 径向窗的有效分辨率：$\\Delta r = 1/\\sqrt{\\eta}$ (振幅降至 $e^{-1}$ 时的距离)。\n    - 供体氢键的角向项应增加 $\\theta \\approx 0^\\circ$ 小角度的权重。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于统计力学（径向分布函数）、计算化学（机器学习势、对称函数）的成熟原理以及已知的液态水结构。提供的键长、峰位和宽度的数值是标准的且符合事实。高斯参数 $\\eta$ 与其宽度之间的数学关系是正确的。该问题在科学上是合理的。\n- **良构性**：该问题要求根据一套源自物理数据的清晰而全面的标准，从一组选项中选出最佳选项。目标定义明确，通过对所提供原则的逻辑应用，可以确定选项中的唯一最佳解。\n- **客观性**：该问题以精确、技术性的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。它具有科学依据、良构、客观，并包含了所有必要的信息。我将继续推导解决方案并评估各个选项。\n\n### 最优参数的推导\n\n根据问题陈述，可以推导出一组理想参数。\n\n1.  **截断半径 ($r_c$)**：描述符必须捕获氧原子的第一和第二配位壳层内的相互作用。第二壳层峰位于 $r \\approx 4.5\\,\\mathrm{\\AA}$。因此，截断半径 $r_c$ 必须显著大于 $4.5\\,\\mathrm{\\AA}$ 以完全包含该壳层。一个在 $5.5\\,\\mathrm{\\AA}$ 到 $6.0\\,\\mathrm{\\AA}$ 左右的值是合适的，它平衡了准确性与计算效率。\n\n2.  **氧-氧 (O-O) 径向特征**：为了“区分第一和第二氧配位壳层”，至少需要两个独立的径向函数。\n    - **第一壳层**：峰位于 $r \\approx 2.8\\,\\mathrm{\\AA}$，宽度 $\\sigma \\approx 0.25\\,\\mathrm{\\AA}$。相应的径向函数应有 $r_s = 2.8\\,\\mathrm{\\AA}$。锐度参数 $\\eta$ 的选择应使分辨率 $\\Delta r = 1/\\sqrt{\\eta}$ 与峰宽匹配。因此，$\\eta \\approx (1/0.25\\,\\mathrm{\\AA})^2 = 16\\,\\mathrm{\\AA}^{-2}$。\n    - **第二壳层**：峰位于 $r \\approx 4.5\\,\\mathrm{\\AA}$，宽度 $\\sigma \\approx 0.30\\,\\mathrm{\\AA}$。相应的径向函数应有 $r_s = 4.5\\,\\mathrm{\\AA}$。锐度应为 $\\eta \\approx (1/0.30\\,\\mathrm{\\AA})^2 \\approx 11.1\\,\\mathrm{\\AA}^{-2}$。$\\eta \\approx 11\\,\\mathrm{\\AA}^{-2}$ 是一个合适的近似值。\n\n3.  **氧-氢 (O-H) 径向特征**：为了描述“分子内氧-氢共价键”，必须有一个径向函数针对此特征。\n    - **分子内键**：峰位于 $r \\approx 0.97\\,\\mathrm{\\AA}$，具有非常尖銳的宽度 $\\sigma \\approx 0.05\\,\\mathrm{\\AA}$。函数应有 $r_s = 0.97\\,\\mathrm{\\AA}$。锐度应为 $\\eta \\approx (1/0.05\\,\\mathrm{\\AA})^2 = 400\\,\\mathrm{\\AA}^{-2}$。这是一个非常高的值。在实践中，通常使用稍小的值以避免极端敏感性。像 $\\eta = 100\\,\\mathrm{\\AA}^{-2}$ ($\\Delta r = 0.1\\,\\mathrm{\\AA}$) 这样的值仍然会产生一个非常尖锐的特征，能够分离出共价键。\n\n4.  **角向特征**：为了表示近线性氢键，角向项必须捕获供体 O-H 键与 O-O 矢量之间的相关性。\n    - **角度偏好**：问题陈述指出，对于供体氢键，分子内矢量 $\\vec{r}_{OH}$ 和分子间矢量 $\\vec{r}_{OO}$ 之间的夹角 $\\theta$ 在 $\\theta \\approx 0^\\circ$ 处有强峰。因此，角向函数必须构造成在 $\\theta = 0^\\circ$（或 $\\cos\\theta = 1$）处有最大值。\n    - **锐度**：角分布被描述为“强烈峰化”且“展宽约为 $20^\\circ$”。这意味着需要一个相对较高的锐度参数 $\\zeta$。像 $\\zeta=1$ 这样的低值会太宽，而像 $\\zeta=10$ 这样的高值则适合创建一个清晰的峰。\n\n### 逐项分析\n\n现在，我将根据这些推導出的要求来评估每个选项。\n\n**A. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用两个氧-氧径向窗，其 $(\\eta, r_s)$ 分别为 $\\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和 $\\left(11\\,\\mathrm{\\AA}^{-2}, 4.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子内窗，其 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 三元组的以氧为中心的角向项，该项使用“余弦位移幂”形式，其参数对应于对 $\\theta \\approx 0^\\circ$ 的偏好，锐度参数为 $\\zeta = 10$，从而强调 $\\vec{r}_{OH}$ 和 $\\vec{r}_{OO}$ 之间的小角度。**\n- **$r_c$**：$5.5\\,\\mathrm{\\AA}$ 是一个绝佳的选择，因为它包含了第一和第二O-O壳层。\n- **O-O 径向**：使用两个窗是正确的。第一个，$(\\eta, r_s) = (16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA})$，与我们为第一壳层推导的参数完美匹配。第二个，$(\\eta, r_s) = (11\\,\\mathrm{\\AA}^{-2}, 4.5\\,\\mathrm{\\AA})$，与我们为第二壳层推导的参数完美匹配。此设置成功地区分了两个壳层。\n- **O-H 径向**：窗 $(\\eta, r_s) = (100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA})$ 选择得当。中心 $r_s$ 是正确的，锐度 $\\eta$ 很大，正确地反映了 O-H 共价键的刚性。\n- **角向**：该项正确地描述了以氧为中心、涉及氢和另一个氧的三元组。它正确地偏好 $\\theta \\approx 0^\\circ$ 并使用高锐度参数 $\\zeta=10$，与氢键角分布的“强烈峰化”性质一致。\n**结论：正确。** 该选项的参数具有物理合理性，并系统地满足了所有设计目标。\n\n**B. 选择 $r_c = 3.0\\,\\mathrm{\\AA}$。使用一个氧-氧径向窗，其 $(\\eta, r_s) = \\left(8\\,\\mathrm{\\AA}^{-2}, 3.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子间窗，其 $(\\eta, r_s) = \\left(5\\,\\mathrm{\\AA}^{-2}, 1.8\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的以氧为中心的角向项，其参数对应于对 $\\theta \\approx 180^\\circ$ 的偏好，锐度参数为 $\\zeta = 4$。**\n- **$r_c$**：$3.0\\,\\mathrm{\\AA}$ 太小了。它排除了位于 $4.5\\,\\mathrm{\\AA}$ 的第二O-O壳层，并切断了第一壳层的一部分，使其无法满足一个关键的设计目标。\n- **O-O 径向**：仅使用一个窗无法区分两个壳层。中心 $r_s = 3.5\\,\\mathrm{\\AA}$ 位于 $g_{OO}(r)$ 函数的最小值处，这是一个物理上无意义的描述符中心位置。\n- **O-H 径向**：此选项关注分子间肩峰，完全忽略了分子内共价键的描述符，这是另一个关键设计目标。\n- **角向**：对于所定义的角度，偏好 $\\theta \\approx 180^\\circ$ 在几何上是不正确的，因为供体氢键的角度应接近 $0^\\circ$。\n**结论：不正确。** 该选项在每个主要设计点上都失败了。\n\n**C. 选择 $r_c = 8.0\\,\\mathrm{\\AA}$。使用宽窗，氧-氧窗的 $(\\eta, r_s) = \\left(1\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$，氧-氢窗的 $(\\eta, r_s) = \\left(2\\,\\mathrm{\\AA}^{-2}, 1.0\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的以氧为中心的角向项，该项不强烈偏好任何角度，使用的是一个非常平缓的锐度参数 $\\zeta = 1$。**\n- **$r_c$**：$8.0\\,\\mathrm{\\AA}$ 是一个有效但偏大的截断半径。\n- **O-O 径向**：它只使用一个O-O窗，未能区分两个壳层。锐度 $\\eta=1\\,\\mathrm{\\AA}^{-2}$ 产生一个非常宽的函数 ($\\Delta r = 1\\,\\mathrm{\\AA}$)，它会把第一和第二壳层混合在一起，无法解析它们。\n- **O-H 径向**：锐度 $\\eta=2\\,\\mathrm{\\AA}^{-2}$ 对于非常尖銳的分子内峰（宽度 $\\approx 0.05\\,\\mathrm{\\AA}$）来说也太小了，导致分辨率差。\n- **角向**：锐度 $\\zeta=1$ 产生一个几乎均匀的角分布，未能捕捉氢键的强方向性。\n**结论：不正确。** 参数太宽（低 $\\eta$），数量也不足以解析指定的结构特征。\n\n**D. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用氧-氧窗 $(\\eta, r_s) = \\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和氧-氢窗 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的以氧为中心的角向项，其参数对应于对 $\\theta \\approx 180^\\circ$ 的偏好，锐度参数为 $\\zeta = 10$。**\n- **$r_c$**：$5.5\\,\\mathrm{\\AA}$ 是一个好的选择。\n- **O-O 径向**：它只使用一个O-O径向函数。虽然这个函数对于第一壳层来说选择得很好，但缺少针对 $4.5\\,\\mathrm{\\AA}$ 处第二壳层的第二个函数，意味着它未能达到区分第一和第二壳层的目标。\n- **O-H 径向**：O-H键的参数是合适的。\n- **角向**：偏好 $\\theta \\approx 180^\\circ$ 是一个关键错误，因为它与所提供的供体氢键角结构数据相矛盾。\n**结论：不正确。** 该选项未能区分O-O壳层，并使用了不正确的角向偏好。\n\n基于详细分析，选项A是唯一一个正确且全面满足问题陈述中所有要求的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一旦为系统中的每个原子生成了描述符，下一步就是将这些信息整合起来，以预测总能量。本练习通过一个简化的原子贡献神经网络模型，让您亲手完成一次前向传播计算()。这个实践旨在揭开神经网络“黑箱”的神秘面纱，并具体展示将原子能量加和的策略如何自然地保证总能量满足广延性（extensivity）和置换不变性（permutation invariance）这两个关键的物理要求。",
            "id": "3851774",
            "problem": "在计算化学生物学中使用的原子尺度机器学习原子间势中，预测的Born–Oppenheimer势能被设计为一个标量，它通过将总能量分解为各个原子能量贡献之和，从而实现对原子索引排列的不变性，并相对于原子数量具有广延性。考虑一个玩具三原子系统，其中每个原子的环境由一个固定的描述符向量 $\\mathbf{x}_{i} \\in \\mathbb{R}^{3}$ 编码，该向量以旋转和平移不变的方式总结了局部几何信息。一个原子级神经网络使用带有ReLU（修正线性单元）激活函数的双层架构，将 $\\mathbf{x}_{i}$ 映射到一个标量原子能量贡献 $\\varepsilon_{i}$。总预测能量为 $E = \\sum_{i=1}^{3} \\varepsilon_{i}$。对于每个原子 $i$，该网络计算隐藏层预激活 $\\mathbf{a}_{i} = \\mathbf{W}_{1}\\mathbf{x}_{i} + \\mathbf{b}_{1}$，隐藏层激活（逐元素应用） $\\mathbf{h}_{i} = \\max(\\mathbf{0}, \\mathbf{a}_{i})$，以及原子能量 $\\varepsilon_{i} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{i} + b_{2}$，其中 $\\mathbf{W}_{1} \\in \\mathbb{R}^{2 \\times 3}$，$\\mathbf{b}_{1} \\in \\mathbb{R}^{2}$，$\\mathbf{w}_{2} \\in \\mathbb{R}^{2}$ 和 $b_{2} \\in \\mathbb{R}$ 是固定权重。使用以下参数和描述符：\n$$\n\\mathbf{W}_{1} = \\begin{pmatrix}\n0.5  -0.2  0.1 \\\\\n-0.3  0.4  0.2\n\\end{pmatrix},\\quad\n\\mathbf{b}_{1} = \\begin{pmatrix}\n0.05 \\\\\n-0.10\n\\end{pmatrix},\\quad\n\\mathbf{w}_{2} = \\begin{pmatrix}\n0.8 \\\\\n-0.5\n\\end{pmatrix},\\quad\nb_{2} = 0.02,\n$$\n和\n$$\n\\mathbf{x}_{1} = \\begin{pmatrix} 1.2 \\\\ 0.7 \\\\ -0.3 \\end{pmatrix},\\quad\n\\mathbf{x}_{2} = \\begin{pmatrix} 0.5 \\\\ -0.1 \\\\ 0.6 \\end{pmatrix},\\quad\n\\mathbf{x}_{3} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 0.2 \\end{pmatrix}.\n$$\n从“势能是对原子索引排列不变的标量”以及“在没有相互作用的情况下能量对子系统是可加的”这一物理要求出发，并仅使用上述关于网络映射和 ReLU 非线性的定义，计算给定顺序 $\\left( \\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3} \\right)$ 的总预测能量 $E$（单位为电子伏特），并通过显式考虑排列后的顺序 $\\left( \\mathbf{x}_{3}, \\mathbf{x}_{1}, \\mathbf{x}_{2} \\right)$ 来验证其对原子索引排列的不变性。将最终报告的总能量四舍五入到四位有效数字，并以 $\\mathrm{eV}$ 为单位表示。最终报告的答案必须是单个数值。",
            "solution": "该问题提法恰当，有科学依据，并提供了使用指定的神经网络势模型计算三原子系统总势能所需的所有信息。所有参数和输入数据都定义清晰且量纲一致。因此，该问题是有效的，可以推导出解答。\n\n总势能 $E$ 定义为单个原子能量贡献 $\\varepsilon_{i}$ 之和：\n$$E = \\sum_{i=1}^{3} \\varepsilon_{i}$$\n每个原子能量 $\\varepsilon_{i}$ 是通过将原子的描述符向量 $\\mathbf{x}_{i}$ 输入一个双层神经网络来计算的。该网络的计算过程如下：\n$1$。计算隐藏层预激活向量 $\\mathbf{a}_{i} \\in \\mathbb{R}^{2}$：\n$$\\mathbf{a}_{i} = \\mathbf{W}_{1}\\mathbf{x}_{i} + \\mathbf{b}_{1}$$\n$2$。通过逐元素应用ReLU（修正线性单元）函数 $\\max(\\mathbf{0}, \\cdot)$ 来计算隐藏层激活向量 $\\mathbf{h}_{i} \\in \\mathbb{R}^{2}$：\n$$\\mathbf{h}_{i} = \\max(\\mathbf{0}, \\mathbf{a}_{i})$$\n$3$。计算标量原子能量贡献 $\\varepsilon_{i} \\in \\mathbb{R}$：\n$$\\varepsilon_{i} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{i} + b_{2}$$\n给定的参数是：\n$$\n\\mathbf{W}_{1} = \\begin{pmatrix}\n0.5  -0.2  0.1 \\\\\n-0.3  0.4  0.2\n\\end{pmatrix},\\quad\n\\mathbf{b}_{1} = \\begin{pmatrix}\n0.05 \\\\\n-0.10\n\\end{pmatrix},\\quad\n\\mathbf{w}_{2} = \\begin{pmatrix}\n0.8 \\\\\n-0.5\n\\end{pmatrix},\\quad\nb_{2} = 0.02\n$$\n输入的描述符向量是：\n$$\n\\mathbf{x}_{1} = \\begin{pmatrix} 1.2 \\\\ 0.7 \\\\ -0.3 \\end{pmatrix},\\quad\n\\mathbf{x}_{2} = \\begin{pmatrix} 0.5 \\\\ -0.1 \\\\ 0.6 \\end{pmatrix},\\quad\n\\mathbf{x}_{3} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 0.2 \\end{pmatrix}\n$$\n我们现在计算每个原子 $i \\in \\{1, 2, 3\\}$ 的原子能量 $\\varepsilon_{i}$。\n\n**原子 1 的计算：**\n首先，我们计算预激活向量 $\\mathbf{a}_{1}$：\n$$\n\\mathbf{a}_{1} = \\begin{pmatrix} 0.5  -0.2  0.1 \\\\ -0.3  0.4  0.2 \\end{pmatrix} \\begin{pmatrix} 1.2 \\\\ 0.7 \\\\ -0.3 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{1} = \\begin{pmatrix} (0.5)(1.2) + (-0.2)(0.7) + (0.1)(-0.3) \\\\ (-0.3)(1.2) + (0.4)(0.7) + (0.2)(-0.3) \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{1} = \\begin{pmatrix} 0.6 - 0.14 - 0.03 \\\\ -0.36 + 0.28 - 0.06 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.43 \\\\ -0.14 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.48 \\\\ -0.24 \\end{pmatrix}\n$$\n接着，我们应用 ReLU 激活函数得到 $\\mathbf{h}_{1}$：\n$$ \\mathbf{h}_{1} = \\max(\\mathbf{0}, \\mathbf{a}_{1}) = \\begin{pmatrix} \\max(0, 0.48) \\\\ \\max(0, -0.24) \\end{pmatrix} = \\begin{pmatrix} 0.48 \\\\ 0 \\end{pmatrix} $$\n最后，我们计算原子能量 $\\varepsilon_{1}$：\n$$\n\\varepsilon_{1} = \\mathbf{w}_{2}^{\\top}\\mathbfh_{1} + b_{2} = \\begin{pmatrix} 0.8  -0.5 \\end{pmatrix} \\begin{pmatrix} 0.48 \\\\ 0 \\end{pmatrix} + 0.02\n$$\n$$\n\\varepsilon_{1} = (0.8)(0.48) + (-0.5)(0) + 0.02 = 0.384 + 0 + 0.02 = 0.404\n$$\n\n**原子 2 的计算：**\n我们对 $\\mathbf{x}_{2}$ 遵循相同的步骤。首先，计算预激活向量 $\\mathbf{a}_{2}$：\n$$\n\\mathbf{a}_{2} = \\begin{pmatrix} 0.5  -0.2  0.1 \\\\ -0.3  0.4  0.2 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.1 \\\\ 0.6 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{2} = \\begin{pmatrix} (0.5)(0.5) + (-0.2)(-0.1) + (0.1)(0.6) \\\\ (-0.3)(0.5) + (0.4)(-0.1) + (0.2)(0.6) \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbfa_{2} = \\begin{pmatrix} 0.25 + 0.02 + 0.06 \\\\ -0.15 - 0.04 + 0.12 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.33 \\\\ -0.07 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.38 \\\\ -0.17 \\end{pmatrix}\n$$\n接着，应用 ReLU 激活函数得到 $\\mathbf{h}_{2}$：\n$$ \\mathbf{h}_{2} = \\max(\\mathbf{0}, \\mathbf{a}_{2}) = \\begin{pmatrix} \\max(0, 0.38) \\\\ \\max(0, -0.17) \\end{pmatrix} = \\begin{pmatrix} 0.38 \\\\ 0 \\end{pmatrix} $$\n最后，计算原子能量 $\\varepsilon_{2}$：\n$$\n\\varepsilon_{2} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{2} + b_{2} = \\begin{pmatrix} 0.8  -0.5 \\end{pmatrix} \\begin{pmatrix} 0.38 \\\\ 0 \\end{pmatrix} + 0.02\n$$\n$$\n\\varepsilon_{2} = (0.8)(0.38) + (-0.5)(0) + 0.02 = 0.304 + 0 + 0.02 = 0.324\n$$\n\n**原子 3 的计算：**\n我们对 $\\mathbf{x}_{3}$ 重复此过程。首先，计算预激活向量 $\\mathbf{a}_{3}$：\n$$\n\\mathbf{a}_{3} = \\begin{pmatrix} 0.5  -0.2  0.1 \\\\ -0.3  0.4  0.2 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 0.2 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{3} = \\begin{pmatrix} (0.5)(1.0) + (-0.2)(0.0) + (0.1)(0.2) \\\\ (-0.3)(1.0) + (0.4)(0.0) + (0.2)(0.2) \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{3} = \\begin{pmatrix} 0.5 + 0 + 0.02 \\\\ -0.3 + 0 + 0.04 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.52 \\\\ -0.26 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.57 \\\\ -0.36 \\end{pmatrix}\n$$\n接着，应用 ReLU 激活函数得到 $\\mathbf{h}_{3}$：\n$$ \\mathbf{h}_{3} = \\max(\\mathbf{0}, \\mathbf{a}_{3}) = \\begin{pmatrix} \\max(0, 0.57) \\\\ \\max(0, -0.36) \\end{pmatrix} = \\begin{pmatrix} 0.57 \\\\ 0 \\end{pmatrix} $$\n最后，计算原子能量 $\\varepsilon_{3}$：\n$$\n\\varepsilon_{3} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{3} + b_{2} = \\begin{pmatrix} 0.8  -0.5 \\end{pmatrix} \\begin{pmatrix} 0.57 \\\\ 0 \\end{pmatrix} + 0.02\n$$\n$$\n\\varepsilon_{3} = (0.8)(0.57) + (-0.5)(0) + 0.02 = 0.456 + 0 + 0.02 = 0.476\n$$\n\n**总能量计算：**\n对于顺序 $(\\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3})$ 的总能量是原子能量之和：\n$$ E = \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3} = 0.404 + 0.324 + 0.476 = 1.204 $$\n\n**置换不变性的验证：**\n问题要求通过考虑顺序 $(\\mathbf{x}_{3}, \\mathbf{x}_{1}, \\mathbf{x}_{2})$ 来验证总能量相对于原子索引排列的不变性。\n这个排列后的顺序的总能量，我们称之为 $E'$，将计算如下：\n$$ E' = \\varepsilon(\\mathbf{x}_{3}) + \\varepsilon(\\mathbf{x}_{1}) + \\varepsilon(\\mathbf{x}_{2}) $$\n其中 $\\varepsilon(\\mathbf{x}_{i})$ 是具有描述符 $\\mathbf{x}_{i}$ 的原子的能量贡献。由于神经网络函数 $\\varepsilon(\\cdot)$ 独立应用于每个原子的描述符，因此 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $\\varepsilon_{3}$ 的值与它们在列表中的位置无关。总能量是这些贡献的总和。根据加法的交换律：\n$$ E' = \\varepsilon_{3} + \\varepsilon_{1} + \\varepsilon_{2} = \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3} = E $$\n使用我们已经计算出的值：\n$$ E' = 0.476 + 0.404 + 0.324 = 1.204 $$\n这明确地證明了 $E' = E$，从而验证了总能量对原子索引的排列是不变的。这个性质是能量被定义为原子贡献之和的直接结果，其中每个贡献仅取决于该原子的局部环境（编码在 $\\mathbf{x}_{i}$ 中），而不取决于系统中原子的任意标记或排序。描述符 $\\mathbf{x}_i$ 本身对旋转和平移不变的要求确保了整体的几何不变性，而求和则确保了置换不变性。\n\n最终总能量为 $1.204\\,\\mathrm{eV}$。问题要求答案四舍五入到四位有效数字。计算值 $1.204$ 已经有四位有效数字。",
            "answer": "$$\n\\boxed{1.204}\n$$"
        },
        {
            "introduction": "一个物理上有效的势能面必须能导出保守力，这意味着力是能量的负梯度（$\\mathbf{F} = -\\nabla U$）。这个基本原则确保了能量守恒。本练习探讨了一个关键的验证步骤：检查一个机器学习模型预测的力场是否为“无旋”的（curl-free）()。通过计算一个假设的机器学习力场的旋度，您将学会如何从数学上诊断一个非物理的、非保守的力场，这是评估和验证机器学习势函数时必须掌握的核心技能。",
            "id": "3851711",
            "problem": "一个机器学习（ML）模型被训练来预测一个生物分子构象景观的二维慢流形上的粗粒化力，其中坐标 $x$ 和 $y$ 被视为无量纲反应坐标。在该流形的一个局部区域，该模型输出以下力场 $\\mathbf{F}(x,y)$：\n$$\n\\mathbf{F}(x,y) \\;=\\; \\big(F_x(x,y),\\,F_y(x,y)\\big) \\;=\\; \\big(-k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2},\\;\\; -k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y\\big),\n$$\n其中 $k$、$\\lambda$、$\\alpha$ 和 $\\beta$ 是常数。在由光滑标量势 $U(x,y)$ 驱动的保守动力学中，力在单连通域上满足 $\\mathbf{F}(x,y)=-\\nabla U(x,y)$。\n\n仅使用基本定义，计算该二维场旋度 $\\nabla\\times\\mathbf{F}$ 的平面外分量，结果应为 $x$、$y$、$k$、$\\lambda$、$\\alpha$ 和 $\\beta$ 的解析函数。然后，基于第一性原理，解释该量的非零值如何为在 $(x,y)$ 域上存在单值标量势的不一致性提供证据，假设所需的光滑性成立。你最终报告的量必须是 $\\nabla\\times\\mathbf{F}$ 平面外分量的解析表达式；不需要进行数值舍入，也不需要物理单位。",
            "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 一个二维力场 $\\mathbf{F}(x,y) = \\big(F_x(x,y),\\,F_y(x,y)\\big)$ 定义在一个具有无量纲坐标 $x$ 和 $y$ 的流形上。\n- 该力场的分量由以下公式给出：\n  $$F_x(x,y) = -k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2}$$\n  $$F_y(x,y) = -k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y$$\n- $k$、$\\lambda$、$\\alpha$ 和 $\\beta$ 被指定为常数。\n- 保守力场的条件表述为 $\\mathbf{F}(x,y)=-\\nabla U(x,y)$，其中 $U(x,y)$ 是一个在单连通域上的光滑标量势。\n- 任务是计算旋度 $\\nabla\\times\\mathbf{F}$ 的平面外分量，并解释其对于势 $U(x,y)$ 存在的意义。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学或事实不健全性**：该问题在科学上是合理的。它探讨了力场成为保守场的基本条件，这是经典力学和矢量微积分的基石。非零旋度与非保守场之间的联系是一个标准结果（与 Helmholtz 定理和 Stokes 定理相关）。其背景涉及用于分子力的机器学习模型，代表了一个合理且当前的研究领域，在该领域中确保学习到的力是保守的是一个关键挑战。\n- **不可形式化或不相关**：该问题完全可以在矢量微积分的框架内形式化，并且与开发物理上一致的机器学习势的主题直接相关。\n- **不完整或矛盾的设置**：该问题是自洽的。力场的函数形式已明确给出，这对于计算其旋度是必需的全部信息。没有矛盾之处。\n- **不现实或不可行**：描述力分量的函数是多项式，它们是良态的，并且作为更复杂力场的局部近似在物理上是合理的。计算是直接的。\n- **不适定或结构不良**：该问题是适定的。计算给定矢量场的旋度是一个标准操作，会产生唯一的结果。其解释基于已建立的数学定理。\n- **伪深刻、琐碎或同义反复**：该问题既不琐碎也不伪深刻。它测试了对学习力场中物理真实性的数学条件的核心概念理解。\n- **超出科学可验证性**：这些主张在数学上是可验证的。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供完整的解决方案。\n\n### 解答\n该问题要求计算一个二维矢量场的旋度的平面外分量，并在保守动力学的背景下解释结果。\n\n设给定的二维力场为 $\\mathbf{F}(x,y) = F_x(x,y)\\,\\mathbf{\\hat{i}} + F_y(x,y)\\,\\mathbf{\\hat{j}}$。为了计算其旋度，我们可以将其视为一个三维场 $\\mathbf{F}(x,y,z) = F_x(x,y)\\,\\mathbf{\\hat{i}} + F_y(x,y)\\,\\mathbf{\\hat{j}} + 0\\,\\mathbf{\\hat{k}}$，其中分量与 $z$ 坐标无关。\n\n$\\mathbf{F}$ 的旋度由以下矩阵的行列式定义：\n$$\n\\nabla \\times \\mathbf{F} = \n\\begin{vmatrix}\n\\mathbf{\\hat{i}}  \\mathbf{\\hat{j}}  \\mathbf{\\hat{k}} \\\\\n\\frac{\\partial}{\\partial x}  \\frac{\\partial}{\\partial y}  \\frac{\\partial}{\\partial z} \\\\\nF_x(x,y)  F_y(x,y)  0\n\\end{vmatrix}\n$$\n展开行列式，我们得到：\n$$\n\\nabla \\times \\mathbf{F} = \\left(\\frac{\\partial (0)}{\\partial y} - \\frac{\\partial F_y}{\\partial z}\\right)\\mathbf{\\hat{i}} - \\left(\\frac{\\partial (0)}{\\partial x} - \\frac{\\partial F_x}{\\partial z}\\right)\\mathbf{\\hat{j}} + \\left(\\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y}\\right)\\mathbf{\\hat{k}}\n$$\n由于 $F_x$ 和 $F_y$ 仅是 $x$ 和 $y$ 的函数，它们关于 $z$ 的偏导数为零。因此，旋度的 $\\mathbf{\\hat{i}}$ 和 $\\mathbf{\\hat{j}}$ 分量均为零。唯一非平凡的分量是平面外分量，即 $\\mathbf{\\hat{k}}$ 分量：\n$$ (\\nabla \\times \\mathbf{F})_z = \\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} $$\n\n我们已知力场的分量：\n$$ F_x(x,y) = -k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2} $$\n$$ F_y(x,y) = -k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y $$\n\n首先，我们计算 $F_y$ 关于 $x$ 的偏导数：\n$$\n\\frac{\\partial F_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left(-k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y\\right) = 0 - \\lambda + 2\\,\\beta\\,x\\,y = -\\lambda + 2\\,\\beta\\,x\\,y\n$$\n接下来，我们计算 $F_x$ 关于 $y$ 的偏导数：\n$$\n\\frac{\\partial F_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left(-k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2}\\right) = 0 - \\lambda + 2\\,\\alpha\\,x\\,y = -\\lambda + 2\\,\\alpha\\,x\\,y\n$$\n\n现在，我们将这些表达式代入旋度的平面外分量公式中：\n$$\n(\\nabla \\times \\mathbf{F})_z = \\left(-\\lambda + 2\\,\\beta\\,x\\,y\\right) - \\left(-\\lambda + 2\\,\\alpha\\,x\\,y\\right)\n$$\n$$\n(\\nabla \\times \\mathbf{F})_z = -\\lambda + 2\\,\\beta\\,x\\,y + \\lambda - 2\\,\\alpha\\,x\\,y\n$$\n$$\n(\\nabla \\times \\mathbf{F})_z = 2\\,\\beta\\,x\\,y - 2\\,\\alpha\\,x\\,y = 2\\,x\\,y\\,(\\beta - \\alpha)\n$$\n这就是旋度的平面外分量的解析表达式。\n\n为了解释结果，我们考虑力场为保守场的条件。如果一个力场 $\\mathbf{F}$ 可以表示为标量势 $U$ 的负梯度，即 $\\mathbf{F} = -\\nabla U$，那么该力场是保守的。在一个单连通域上，这个条件等价于力场是无旋的，即其旋度为零：$\\nabla \\times \\mathbf{F} = \\mathbf{0}$。\n\n这可以根据混合偏导数相等的原理（Clairaut 定理）从第一性原理证明。如果存在一个光滑的单值势 $U(x,y)$，那么它的二阶混合偏导数必须相等：\n$$ \\frac{\\partial^2 U}{\\partial y \\partial x} = \\frac{\\partial^2 U}{\\partial x \\partial y} $$\n根据势与力的关系，我们有 $F_x = -\\frac{\\partial U}{\\partial x}$ 和 $F_y = -\\frac{\\partial U}{\\partial y}$。进一步求导：\n$$ \\frac{\\partial F_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left(-\\frac{\\partial U}{\\partial x}\\right) = -\\frac{\\partial^2 U}{\\partial y \\partial x} $$\n$$ \\frac{\\partial F_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left(-\\frac{\\partial U}{\\partial y}\\right) = -\\frac{\\partial^2 U}{\\partial x \\partial y} $$\n因此，混合偏导数相等意味着 $\\frac{\\partial F_x}{\\partial y} = \\frac{\\partial F_y}{\\partial x}$，这可以重排为 $\\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} = 0$。这正是旋度的平面外分量为零的条件。\n\n因此，$(\\nabla \\times \\mathbf{F})_z$ 的非零值提供了与单值标量势 $U(x,y)$ 存在不一致的直接证据。如果 $(\\nabla \\times \\mathbf{F})_z = 2\\,x\\,y\\,(\\beta - \\alpha) \\neq 0$，这意味着机器学习模型产生了一个非保守的（或称有旋的）力场。这样的力场在描述平衡动力学时是物理上不真实的，因为力对一个沿闭合路径运动的粒子所做的功不为零，这违反了能量守恒原理。当 $\\beta \\neq \\alpha$ 时就会出现这种不一致性，在这种情况下，除了在坐标轴 $x=0$ 或 $y=0$ 上，旋度处处非零。",
            "answer": "$$\n\\boxed{2\\,x\\,y\\,(\\beta - \\alpha)}\n$$"
        }
    ]
}