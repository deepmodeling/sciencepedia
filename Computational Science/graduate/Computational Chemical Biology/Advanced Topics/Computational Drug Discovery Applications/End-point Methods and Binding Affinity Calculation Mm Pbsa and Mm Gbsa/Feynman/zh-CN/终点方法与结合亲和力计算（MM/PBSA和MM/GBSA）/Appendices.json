{
    "hands_on_practices": [
        {
            "introduction": "为有效运用终点法，首先必须掌握其核心数学基础。本练习直接应用了 MM/PBSA/GBSA 的基本公式，让您能够根据分子力学能量和溶剂化能等组分来计算结合自由能 $\\Delta G_{\\text{bind}}$。通过解决这个问题 ，您不仅能巩固对各能量组分如何影响最终亲和力的理解，还能探讨此计算中隐含的参考态这一重要概念。",
            "id": "3843912",
            "problem": "在温度为 $T$ 的水溶液中，一个蛋白质受体 $R$ 和一个配体 $L$ 结合形成复合物 $RL$。该结合过程是化学反应 $R + L \\rightarrow RL$。结合吉布斯自由能变 $\\Delta G_{\\text{bind}}$ 定义为在相同温度 $T$ 和压力下，该反应的产物自由能减去反应物自由能。在诸如分子力学/泊松-玻尔兹曼表面积 (MM/PBSA) 和分子力学/广义玻恩表面积 (MM/GBSA) 等终点法中，一个状态的自由能近似为分子力学 (MM) 能量与通过隐式溶剂模型计算的溶剂化自由能之和；根据近似程度的不同，构象熵可以分开处理或忽略不计。\n\n给定使用隐式溶剂模型，通过一致的单轨迹方案为三个终点态生成的轨迹平均组分值。对于每个状态 $X \\in \\{RL, R, L\\}$，分子力学能量为 $E_{\\text{MM}}(X)$，溶剂化自由能为 $G_{\\text{solv}}(X)$。数据（单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$）如下：\n- 复合物 $RL$：$E_{\\text{MM}}(RL) = -214.36$, $G_{\\text{solv}}(RL) = -123.48$。\n- 受体 $R$：$E_{\\text{MM}}(R) = -102.12$, $G_{\\text{solv}}(R) = -88.73$。\n- 配体 $L$：$E_{\\text{MM}}(L) = -47.46$, $G_{\\text{solv}}(L) = -20.41$。\n\n假设构象熵的贡献被忽略，并且没有应用显式的标准态校正。仅使用反应自由能的基本定义和所述的状态自由能分解，推导在此近似下结合自由能的适当表达式，并根据上述数据计算其数值。简要解释此终点计算所采用的隐式参考态。\n\n最终能量以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确、客观，并提供了基于计算化学中 MM/PBSA 和 MM/GBSA 方法标准原理求解所需的所有必要信息。\n\n对于反应 $R + L \\rightarrow RL$，结合吉布斯自由能 $\\Delta G_{\\text{bind}}$ 定义为产物的吉布斯自由能与反应物的吉布斯自由能之差：\n$$\n\\Delta G_{\\text{bind}} = G(RL) - (G(R) + G(L))\n$$\n问题指出，在终点法形式体系中，任何给定状态 $X$（其中 $X$ 可以是复合物 $RL$、受体 $R$ 或配体 $L$）的自由能近似为其分子力学 (MM) 能量 $E_{\\text{MM}}(X)$ 与其溶剂化自由能 $G_{\\text{solv}}(X)$ 的总和。构象熵的贡献被明确忽略。因此，我们有：\n$$\nG(X) \\approx E_{\\text{MM}}(X) + G_{\\text{solv}}(X)\n$$\n将此近似代入每种物质的 $\\Delta G_{\\text{bind}}$ 定义中，我们得到在此框架下结合自由能的表达式：\n$$\n\\Delta G_{\\text{bind}} \\approx \\left[ E_{\\text{MM}}(RL) + G_{\\text{solv}}(RL) \\right] - \\left[ (E_{\\text{MM}}(R) + G_{\\text{solv}}(R)) + (E_{\\text{MM}}(L) + G_{\\text{solv}}(L)) \\right]\n$$\n该表达式可以通过对分子力学项和溶剂化自由能项进行分组来重新排列：\n$$\n\\Delta G_{\\text{bind}} \\approx \\left[ E_{\\text{MM}}(RL) - E_{\\text{MM}}(R) - E_{\\text{MM}}(L) \\right] + \\left[ G_{\\text{solv}}(RL) - G_{\\text{solv}}(R) - G_{\\text{solv}}(L) \\right]\n$$\n这通常写成更紧凑的形式 $\\Delta G_{\\text{bind}} \\approx \\Delta E_{\\text{MM}} + \\Delta G_{\\text{solv}}$，其中 $\\Delta E_{\\text{MM}}$ 是结合时分子力学能量的变化，而 $\\Delta G_{\\text{solv}}$ 是溶剂化自由能的变化。这就是所要求的表达式。\n\n现在，我们使用所提供的数据（单位均为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$）计算数值：\n$E_{\\text{MM}}(RL) = -214.36$\n$G_{\\text{solv}}(RL) = -123.48$\n$E_{\\text{MM}}(R) = -102.12$\n$G_{\\text{solv}}(R) = -88.73$\n$E_{\\text{MM}}(L) = -47.46$\n$G_{\\text{solv}}(L) = -20.41$\n\n首先，我们计算分子力学能量的变化 $\\Delta E_{\\text{MM}}$：\n$$\n\\Delta E_{\\text{MM}} = E_{\\text{MM}}(RL) - E_{\\text{MM}}(R) - E_{\\text{MM}}(L) = (-214.36) - (-102.12) - (-47.46)\n$$\n$$\n\\Delta E_{\\text{MM}} = -214.36 + 102.12 + 47.46 = -214.36 + 149.58 = -64.78 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\n接下来，我们计算溶剂化自由能的变化 $\\Delta G_{\\text{solv}}$：\n$$\n\\Delta G_{\\text{solv}} = G_{\\text{solv}}(RL) - G_{\\text{solv}}(R) - G_{\\text{solv}}(L) = (-123.48) - (-88.73) - (-20.41)\n$$\n$$\n\\Delta G_{\\text{solv}} = -123.48 + 88.73 + 20.41 = -123.48 + 109.14 = -14.34 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\n在此近似下，总结合自由能是这两个组分的总和：\n$$\n\\Delta G_{\\text{bind}} \\approx \\Delta E_{\\text{MM}} + \\Delta G_{\\text{solv}} = -64.78 + (-14.34) = -79.12 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $-79.12$ 已包含四位有效数字。\n\n关于隐式参考态，标准结合吉布斯自由能 $\\Delta G_{\\text{bind}}^{\\circ}$ 与结合常数 $K_a$（或解离常数 $K_d$）相关，并且是为溶液中所有物质的标准浓度 $1\\,\\mathrm{M}$ 定义的。$\\Delta G_{\\text{bind}}^{\\circ}$ 的完整表达式包含一个熵项 $-T\\Delta S$，该项解释了结合时平动、转动和构象熵的变化。通过明确忽略熵的贡献，特别是当两个分子结合成一个分子时平动和转动自由度的显著损失，该计算省略了为调整标准态体积所需的校正项。因此，计算出的值不对应于标准的 $1\\,\\mathrm{M}$ 参考态。相反，它表示一个过程的自由能变化，即一个 $R$ 粒子和一个 $L$ 粒子在溶剂中无限分离，然后结合形成一个 $RL$ 粒子。这是一个假设的参考态，对应于单位摩尔分数，而非单位摩尔浓度。它描述了分子在溶剂环境中彼此间的内在亲和力，剥离了浓度的统计热力学效应。",
            "answer": "$$\n\\boxed{-79.12}\n$$"
        },
        {
            "introduction": "MM/PBSA/GBSA 方法虽然功能强大，但其内在的近似处理可能导致系统性误差，使得计算出的结合亲和力与实验值存在偏差。因此，在许多研究中，对这些预测进行统计分析和校正是至关重要的最后一步。这个高级练习  将指导您如何建立一个线性校正模型以改善与实验数据的相关性，更重要的是，它将教您如何严格评估这种校正是否具有统计学意义，以及是否能推广到新的、未见过的数据集上。这对于在药物设计等实际应用中开发具有真正预测能力的模型至关重要。",
            "id": "3843932",
            "problem": "您将获得来自若干假设的蛋白质-配体复合物的成对数据集，这些数据集包括通过分子力学/广义玻恩表面积 (MM/GBSA) 计算的终点结合自由能，以及在溶液中测量的实验结合自由能。诸如分子力学/泊松-玻尔兹曼表面积 (MM/PBSA) 和分子力学/广义玻恩表面积 (MM/GBSA) 等终点法，将结合自由能近似为分子力学能量加上溶剂化和非极性项的差值。在实践中，由于溶剂模型和熵贡献中的近似，计算值相对于实验值常常表现出系统性偏差。一个常见的后处理步骤是应用一个线性校正模型，将计算值映射到实验值。\n\n从第一性原理出发，考虑一个从计算值到实验值的线性映射，其模型形式为 $y = a + b x + \\varepsilon$，其中 $x$ 表示计算的 MM/GBSA 结合自由能，单位为 $\\mathrm{kcal/mol}$，$y$ 表示实验结合自由能，单位为 $\\mathrm{kcal/mol}$，$a$ 是截距，单位为 $\\mathrm{kcal/mol}$，$b$ 是无量纲的斜率，而 $\\varepsilon$ 是一个零均值随机误差。您必须通过最小化残差平方和来推导并实现普通最小二乘估计量，然后评估该线性校正相对于无需校正的原假设（即恒等映射 $y = x$）在统计上是否合理，最后评估学习到的校正模型是否可迁移到一个独立的测试集。\n\n科学和统计要求：\n- 在训练集上使用普通最小二乘法，通过最小化 $\\sum_i (y_i - (a + b x_i))^2$ 来估计 $a$ 和 $b$。\n- 为评估校正是否在统计上合理，需对线性约束 $a = 0$ 和 $b = 1$ 进行联合显著性检验。使用一个有效的模型比较方法，将无约束的线性拟合与受约束的恒等模型 $y = x$ 进行对比。使用 $\\alpha = 0.05$ 的显著性水平，并返回联合检验对应的 $p$ 值。\n- 为评估可迁移性，在一个留出的测试集上评估校正模型和恒等映射。计算两种映射在测试集上的均方根误差。然后，对测试集上校正映射和恒等映射的绝对预测误差之差进行单边配对检验。原假设为平均差值为 $0$，备择假设为校正映射具有更小的平均绝对误差。使用相同的显著性水平 $\\alpha = 0.05$。如果校正模型在测试集上取得了严格更小的均方根误差，并且单边检验在 $\\alpha$ 水平上显著，则宣布该校正具有可迁移性。\n\n所有自由能必须以 $\\mathrm{kcal/mol}$ 为单位处理和报告。最终程序必须对以下四个测试案例进行操作。每个测试案例包含一个训练集和一个测试集，均以计算值和实验值的并行列表形式提供。每个列表条目的单位均为 $\\mathrm{kcal/mol}$。\n\n案例 1 (具有系统性偏差的良好相关性)：\n- 训练集计算值：$x_\\text{train}^{(1)} = [-7.5, -6.1, -8.0, -5.2, -9.3, -7.1, -6.8, -5.9, -8.7, -7.9]$\n- 训练集实验值：$y_\\text{train}^{(1)} = [2 + 0.8(-7.5) + 0.15,\\; 2 + 0.8(-6.1) - 0.22,\\; 2 + 0.8(-8.0) + 0.05,\\; 2 + 0.8(-5.2) + 0.30,\\; 2 + 0.8(-9.3) - 0.10,\\; 2 + 0.8(-7.1) + 0.12,\\; 2 + 0.8(-6.8) - 0.05,\\; 2 + 0.8(-5.9) + 0.18,\\; 2 + 0.8(-8.7) - 0.20,\\; 2 + 0.8(-7.9) + 0.00]$\n- 测试集计算值：$x_\\text{test}^{(1)} = [-6.5, -5.0, -8.2, -7.0, -9.0, -5.5, -6.0]$\n- 测试集实验值：$y_\\text{test}^{(1)} = [2 + 0.8(-6.5) + 0.05,\\; 2 + 0.8(-5.0) - 0.10,\\; 2 + 0.8(-8.2) + 0.12,\\; 2 + 0.8(-7.0) - 0.08,\\; 2 + 0.8(-9.0) + 0.00,\\; 2 + 0.8(-5.5) + 0.20,\\; 2 + 0.8(-6.0) - 0.15]$\n\n案例 2 (恒等映射成立)：\n- 训练集计算值：$x_\\text{train}^{(2)} = [-7.0, -6.5, -8.0, -5.5, -9.2, -7.3, -6.0, -5.8]$\n- 训练集实验值：$y_\\text{train}^{(2)} = [-7.0 + 0.05,\\; -6.5 - 0.08,\\; -8.0 + 0.02,\\; -5.5 - 0.01,\\; -9.2 - 0.03,\\; -7.3 + 0.00,\\; -6.0 + 0.04,\\; -5.8 - 0.02]$\n- 测试集计算值：$x_\\text{test}^{(2)} = [-7.1, -6.2, -8.3, -5.2, -9.0]$\n- 测试集实验值：$y_\\text{test}^{(2)} = [-7.1 + 0.02,\\; -6.2 - 0.04,\\; -8.3 + 0.01,\\; -5.2 - 0.02,\\; -9.0 + 0.03]$\n\n案例 3 (小样本边界情况)：\n- 训练集计算值：$x_\\text{train}^{(3)} = [-7.0, -5.0, -9.0]$\n- 训练集实验值：$y_\\text{train}^{(3)} = [1.5 + 0.9(-7.0) + 0.4,\\; 1.5 + 0.9(-5.0) - 0.3,\\; 1.5 + 0.9(-9.0) + 0.1]$\n- 测试集计算值：$x_\\text{test}^{(3)} = [-6.0, -8.0]$\n- 测试集实验值：$y_\\text{test}^{(3)} = [1.5 + 0.9(-6.0) + 0.0,\\; 1.5 + 0.9(-8.0) + 0.2]$\n\n案例 4 (因分布偏移导致校正不可迁移)：\n- 训练集计算值：$x_\\text{train}^{(4)} = [-10.0, -8.5, -7.2, -6.8, -5.5, -9.1, -7.7]$\n- 训练集实验值：$y_\\text{train}^{(4)} = [2 + 0.8(-10.0) + 0.10,\\; 2 + 0.8(-8.5) - 0.05,\\; 2 + 0.8(-7.2) + 0.20,\\; 2 + 0.8(-6.8) - 0.10,\\; 2 + 0.8(-5.5) + 0.15,\\; 2 + 0.8(-9.1) - 0.08,\\; 2 + 0.8(-7.7) + 0.00]$\n- 测试集计算值：$x_\\text{test}^{(4)} = [-9.5, -8.0, -6.0, -5.0, -7.5]$\n- 测试集实验值：$y_\\text{test}^{(4)} = [-9.5 + 0.05,\\; -8.0 - 0.02,\\; -6.0 + 0.03,\\; -5.0 - 0.01,\\; -7.5 + 0.00]$\n\n算法任务：\n- 对每个案例，在训练集上使用普通最小二乘法估计 $a$ 和 $b$，对 $a = 0$ 和 $b = 1$ 与无约束线性模型进行联合检验以获得在 $\\alpha = 0.05$ 水平下的 $p$ 值，计算校正映射和恒等映射在测试集上的均方根误差，并对绝对误差之差进行单边配对检验以评估可迁移性。\n- 对于单边配对检验，使用备择假设，即校正映射产生更小的平均绝对误差。\n\n您的程序必须生成单行输出，其中包含每个案例的一个列表，并聚合在一个方括号列表中。每个案例的列表必须按以下顺序包含七个条目：\n$[b,\\; a,\\; p_\\text{joint},\\; \\text{justified},\\; \\text{RMSE}_\\text{corr},\\; \\text{RMSE}_\\text{ident},\\; \\text{transferable}]$\n其中 $b$ 和 $a$ 分别是斜率和截距，$p_\\text{joint}$ 是 $a = 0$ 和 $b = 1$ 联合检验的 $p$ 值，$\\text{justified}$ 和 $\\text{transferable}$ 是在 $\\alpha = 0.05$ 水平下确定的布尔值，$\\text{RMSE}_\\text{corr}$ 和 $\\text{RMSE}_\\text{ident}$ 分别是校正映射和恒等映射在测试集上的均方根误差。将浮点数 $b$、$a$ 和 $p_\\text{joint}$ 格式化为 $6$ 位小数，两个均方根误差格式化为 $3$ 位小数。最终输出应为单行文本，格式严格为：\n$[[\\text{case1}],[\\text{case2}],[\\text{case3}],[\\text{case4}]]$\n条目之间用逗号分隔，不含任何额外文本。所有能量单位均为 $\\mathrm{kcal/mol}$，输出中不应打印单位。",
            "solution": "该问题是有效的，因为它在计算生物物理学方面有科学依据，问题阐述清晰，并为获得唯一解提供了所有必要信息。我们将首先从第一性原理推导必要的统计公式，然后将它们应用于所提供的数据。\n\n总体目标是评估一个用于校正计算结合自由能的线性模型。该模型由下式给出：\n$$y = a + b x + \\varepsilon$$\n其中 $y$ 是实验结合自由能，$x$ 是计算结合自由能，$a$ 和 $b$ 是截距和斜率系数，$\\varepsilon$ 是零均值误差项。该分析包括三个主要步骤：参数估计、模型合理性论证和可迁移性评估。\n\n**1. 通过普通最小二乘法 (OLS) 进行参数估计**\n\n系数 $a$ 和 $b$ 是通过在包含 $n$ 个数据点 $\\{ (x_i, y_i) \\}_{i=1}^n$ 的训练集上最小化残差平方和 (SSR) 来估计的。SSR，记为 $S(a, b)$，其表达式为：\n$$S(a, b) = \\sum_{i=1}^{n} (y_i - (a + b x_i))^2$$\n为找到最小值，我们对 $S(a, b)$ 求关于 $a$ 和 $b$ 的偏导数，并令其为零。这得到正规方程组：\n$$\n\\frac{\\partial S}{\\partial a} = -2\\sum_{i=1}^{n}(y_i - a - b x_i) = 0 \\implies \\sum_{i=1}^{n} y_i = n a + b \\sum_{i=1}^{n} x_i\n$$\n$$\n\\frac{\\partial S}{\\partial b} = -2\\sum_{i=1}^{n} x_i(y_i - a - b x_i) = 0 \\implies \\sum_{i=1}^{n} x_i y_i = a \\sum_{i=1}^{n} x_i + b \\sum_{i=1}^{n} x_i^2\n$$\n将第一个方程两边除以 $n$，可以得到 OLS 估计量 $\\hat{a}$ 关于样本均值 $\\bar{y}$ 和 $\\bar{x}$ 的表达式：\n$$\\bar{y} = \\hat{a} + \\hat{b} \\bar{x} \\implies \\hat{a} = \\bar{y} - \\hat{b} \\bar{x}$$\n将此表达式代入第二个正规方程，求解 OLS 估计量 $\\hat{b}$ 可得：\n$$\n\\hat{b} = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2} = \\frac{\\text{Cov}(x, y)}{\\text{Var}(x)}\n$$\n这些公式为最小化 SSR 的斜率 $\\hat{b}$ 和截距 $\\hat{a}$ 提供了最优估计。\n\n**2. 用于统计合理性论证的联合假设检验**\n\n我们必须评估线性校正在统计上是否合理。这被构建为一个假设检验，其原假设 $H_0$ 是不需要校正，即对应于恒等映射 $y=x$。这意味着联合线性约束 $a=0$ 和 $b=1$。备择假设 $H_A$ 是这些约束中至少有一个不成立。\n\n我们使用 F 检验来比较无约束模型 ($y = a + b x$) 和受约束模型 ($y = x$)。F 统计量由两个模型的残差平方和构建：\n$$\nF = \\frac{(\\text{SSR}_R - \\text{SSR}_U) / q}{\\text{SSR}_U / (n - k_U)}\n$$\n其中：\n- $\\text{SSR}_U = \\sum_{i=1}^{n} (y_i - (\\hat{a} + \\hat{b} x_i))^2$ 是无约束模型的 SSR，其中 $\\hat{a}$ 和 $\\hat{b}$ 是 OLS 估计值。\n- $\\text{SSR}_R = \\sum_{i=1}^{n} (y_i - (0 + 1 \\cdot x_i))^2 = \\sum_{i=1}^{n} (y_i - x_i)^2$ 是受约束模型的 SSR。\n- $q=2$ 是线性约束的数量 ($a=0$, $b=1$)。\n- $k_U=2$ 是无约束模型中参数的数量 ($a$, $b$)。\n- $n$ 是训练集中的数据点数量。\n\n在原假设下，该统计量服从自由度为 $q$ 和 $n-k_U$ 的 F 分布，即 $F \\sim F(2, n-2)$。我们从此分布计算 $p$ 值。如果该 $p$ 值小于显著性水平 $\\alpha = 0.05$，则认为校正是合理的。\n\n**3. 在测试集上进行可迁移性评估**\n\n最后一步是评估学习到的校正模型是否能泛化到新数据。这是在一个包含 $m$ 个数据点 $\\{ (x_{\\text{test},j}, y_{\\text{test},j}) \\}_{j=1}^m$ 的留出测试集上进行评估的。\n\n首先，我们计算校正模型和恒等映射在测试集上的均方根误差 (RMSE)：\n$$\n\\text{RMSE}_\\text{corr} = \\sqrt{\\frac{1}{m} \\sum_{j=1}^{m} (y_{\\text{test},j} - (\\hat{a} + \\hat{b} x_{\\text{test},j}))^2}\n$$\n$$\n\\text{RMSE}_\\text{ident} = \\sqrt{\\frac{1}{m} \\sum_{j=1}^{m} (y_{\\text{test},j} - x_{\\text{test},j})^2}\n$$\n接下来，对绝对预测误差进行单边配对 t 检验。令 $d_j$ 为第 $j$ 个测试点的绝对误差之差：\n$$\nd_j = |y_{\\text{test}, j} - x_{\\text{test}, j}| - |y_{\\text{test}, j} - (\\hat{a} + \\hat{b} x_{\\text{test}, j})|\n$$\n原假设是 $H_0: \\mu_d = 0$，其中 $\\mu_d$ 是差值的均值。备择假设是 $H_A: \\mu_d > 0$，它假定校正模型具有更小的平均绝对误差。t 统计量为：\n$$\nt = \\frac{\\bar{d}}{s_d / \\sqrt{m}}\n$$\n其中 $\\bar{d}$ 和 $s_d$ 分别是差值 $d_j$ 的样本均值和样本标准差。该统计量服从自由度为 $m-1$ 的学生 t 分布。\n\n如果满足两个条件，则认为校正是可迁移的：\n1. 校正模型具有严格更小的测试 RMSE：$\\text{RMSE}_\\text{corr}  \\text{RMSE}_\\text{ident}$。\n2. 单边配对 t 检验在 $\\alpha = 0.05$ 水平上是显著的。\n\n下面的实现将对每个给定的案例执行这些计算。",
            "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the problem by processing four test cases related to the linear correction\n    of MM/GBSA binding free energies.\n    \"\"\"\n\n    # Data for the four test cases\n    test_cases_data = [\n        # Case 1 (good correlation with systematic bias)\n        {\n            \"x_train\": [-7.5, -6.1, -8.0, -5.2, -9.3, -7.1, -6.8, -5.9, -8.7, -7.9],\n            \"y_train_func\": lambda x: 2 + 0.8 * x,\n            \"y_train_noise\": [0.15, -0.22, 0.05, 0.30, -0.10, 0.12, -0.05, 0.18, -0.20, 0.00],\n            \"x_test\": [-6.5, -5.0, -8.2, -7.0, -9.0, -5.5, -6.0],\n            \"y_test_func\": lambda x: 2 + 0.8 * x,\n            \"y_test_noise\": [0.05, -0.10, 0.12, -0.08, 0.00, 0.20, -0.15],\n        },\n        # Case 2 (identity mapping holds)\n        {\n            \"x_train\": [-7.0, -6.5, -8.0, -5.5, -9.2, -7.3, -6.0, -5.8],\n            \"y_train_func\": lambda x: x,\n            \"y_train_noise\": [0.05, -0.08, 0.02, -0.01, -0.03, 0.00, 0.04, -0.02],\n            \"x_test\": [-7.1, -6.2, -8.3, -5.2, -9.0],\n            \"y_test_func\": lambda x: x,\n            \"y_test_noise\": [0.02, -0.04, 0.01, -0.02, 0.03],\n        },\n        # Case 3 (small-sample boundary)\n        {\n            \"x_train\": [-7.0, -5.0, -9.0],\n            \"y_train_func\": lambda x: 1.5 + 0.9 * x,\n            \"y_train_noise\": [0.4, -0.3, 0.1],\n            \"x_test\": [-6.0, -8.0],\n            \"y_test_func\": lambda x: 1.5 + 0.9 * x,\n            \"y_test_noise\": [0.0, 0.2],\n        },\n        # Case 4 (non-transferable correction due to distribution shift)\n        {\n            \"x_train\": [-10.0, -8.5, -7.2, -6.8, -5.5, -9.1, -7.7],\n            \"y_train_func\": lambda x: 2 + 0.8 * x,\n            \"y_train_noise\": [0.10, -0.05, 0.20, -0.10, 0.15, -0.08, 0.00],\n            \"x_test\": [-9.5, -8.0, -6.0, -5.0, -7.5],\n            \"y_test_func\": lambda x: x,\n            \"y_test_noise\": [0.05, -0.02, 0.03, -0.01, 0.00],\n        },\n    ]\n\n    def process_case(x_train, y_train, x_test, y_test):\n        \"\"\"\n        Performs OLS, joint hypothesis test, and transferability assessment for a single case.\n        \"\"\"\n        x_train, y_train = np.array(x_train), np.array(y_train)\n        x_test, y_test = np.array(x_test), np.array(y_test)\n        n_train, n_test = len(x_train), len(x_test)\n        alpha = 0.05\n\n        # 1. OLS Parameter Estimation\n        x_mean, y_mean = np.mean(x_train), np.mean(y_train)\n        b_hat = np.sum((x_train - x_mean) * (y_train - y_mean)) / np.sum((x_train - x_mean)**2)\n        a_hat = y_mean - b_hat * x_mean\n\n        # 2. Joint Hypothesis Test (a=0, b=1)\n        # SSR for unrestricted model (y = a + bx)\n        ssr_u = np.sum((y_train - (a_hat + b_hat * x_train))**2)\n        # SSR for restricted model (y = x)\n        ssr_r = np.sum((y_train - x_train)**2)\n\n        q = 2  # Number of restrictions\n        k_u = 2 # Number of parameters in unrestricted model\n        df1, df2 = q, n_train - k_u\n\n        p_joint = 1.0\n        if df2  0: # F-test is well-defined\n            f_stat = ((ssr_r - ssr_u) / df1) / (ssr_u / df2)\n            p_joint = stats.f.sf(f_stat, df1, df2) # Survival function (1 - CDF)\n        \n        justified = p_joint  alpha\n\n        # 3. Transferability Assessment\n        # Predictions on test set\n        y_pred_corr = a_hat + b_hat * x_test\n        y_pred_ident = x_test\n        \n        # RMSE calculation\n        rmse_corr = np.sqrt(np.mean((y_test - y_pred_corr)**2))\n        rmse_ident = np.sqrt(np.mean((y_test - y_pred_ident)**2))\n\n        p_transfer = 1.0\n        if n_test  1: # Paired t-test requires at least 2 samples\n            abs_err_corr = np.abs(y_test - y_pred_corr)\n            abs_err_ident = np.abs(y_test - y_pred_ident)\n            diff_abs_err = abs_err_ident - abs_err_corr\n            \n            # One-sided paired t-test: H_A is that corrected model error is smaller\n            # (i.e., mean of diff_abs_err is greater than 0)\n            res = stats.ttest_1samp(diff_abs_err, popmean=0, alternative='greater')\n            p_transfer = res.pvalue\n\n        transferable = (rmse_corr  rmse_ident) and (p_transfer  alpha)\n\n        return [b_hat, a_hat, p_joint, justified, rmse_corr, rmse_ident, transferable]\n\n    results = []\n    for case_data in test_cases_data:\n        x_train = np.array(case_data[\"x_train\"])\n        y_train = case_data[\"y_train_func\"](x_train) + np.array(case_data[\"y_train_noise\"])\n        x_test = np.array(case_data[\"x_test\"])\n        y_test = case_data[\"y_test_func\"](x_test) + np.array(case_data[\"y_test_noise\"])\n        \n        case_result = process_case(x_train, y_train, x_test, y_test)\n        results.append(case_result)\n\n    # Format the final output string\n    output_str = \"[\"\n    for i, res in enumerate(results):\n        b, a, p_j, just, rmse_c, rmse_i, trans = res\n        output_str += f\"[{b:0.6f},{a:0.6f},{p_j:0.6f},{just},{rmse_c:0.3f},{rmse_i:0.3f},{trans}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}