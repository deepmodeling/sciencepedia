{
    "hands_on_practices": [
        {
            "introduction": "This first practice bridges the gap between theoretical calculations and experimental reality. Computational models often yield a standard Gibbs free energy of binding ($\\Delta G^{\\circ}$), while experimental potency is typically reported as a dissociation constant ($K_D$). This exercise will guide you through the thermodynamic derivation that connects these two fundamental quantities, an essential skill for interpreting and comparing computational predictions with biophysical data. ",
            "id": "3847307",
            "problem": "A fragment-based ligand design simulation reports a standard binding free energy of a fragment to a kinase active site as $\\Delta G^{\\circ} = -5.0 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}$ at temperature $T = 298 \\ \\mathrm{K}$, computed using explicit-solvent alchemical free energy methods under the $1 \\ \\mathrm{M}$ standard state and assuming an ideal, dilute solution. Consider the binding reaction $\\mathrm{P} + \\mathrm{L} \\rightleftharpoons \\mathrm{PL}$ with $1{:}1$ stoichiometry. Starting from the core thermodynamic definitions of chemical potential and equilibrium for ideal solutions, derive the relationship between the standard Gibbs free energy change $\\Delta G^{\\circ}$ and the dissociation constant $K_{D}$, and then compute the numerical value of $K_{D}$ for the reported $\\Delta G^{\\circ}$. Use the gas constant $R = 0.001987 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. Express the final $K_{D}$ in molar ($\\mathrm{M}$) units and round your answer to two significant figures. Briefly assess, in your reasoning, whether this $K_{D}$ is plausible for being detectable by ligand-observed Nuclear Magnetic Resonance (NMR) under typical fragment screening conditions, but ensure that your final reported answer is only the numerical value of $K_{D}$.",
            "solution": "The problem is valid as it is scientifically grounded in fundamental chemical thermodynamics, is well-posed with all necessary information provided, and is stated objectively. We can therefore proceed with a solution.\n\nThe task requires the derivation of the relationship between the standard Gibbs free energy of binding, $\\Delta G^{\\circ}$, and the dissociation constant, $K_D$, followed by the calculation of $K_D$ from the given data.\n\nWe begin with the fundamental definition of the chemical potential, $\\mu_i$, for a species $i$ in an ideal, dilute solution:\n$$\n\\mu_i = \\mu_i^{\\circ} + RT \\ln\\left(\\frac{c_i}{c^{\\circ}}\\right)\n$$\nwhere $\\mu_i^{\\circ}$ is the standard chemical potential of species $i$ at the standard state concentration $c^{\\circ}$, $R$ is the ideal gas constant, $T$ is the absolute temperature, and $c_i$ is the molar concentration of species $i$. The problem specifies the standard state concentration as $c^{\\circ} = 1 \\ \\mathrm{M}$.\n\nThe binding reaction is given as a $1{:}1$ association between a protein $\\mathrm{P}$ and a ligand $\\mathrm{L}$ to form a complex $\\mathrm{PL}$:\n$$\n\\mathrm{P} + \\mathrm{L} \\rightleftharpoons \\mathrm{PL}\n$$\nAt chemical equilibrium, the Gibbs free energy change for the reaction is zero. This implies that the sum of the chemical potentials of the reactants equals the chemical potential of the product:\n$$\n\\mu_{\\mathrm{PL}} = \\mu_{\\mathrm{P}} + \\mu_{\\mathrm{L}}\n$$\nSubstituting the expression for chemical potential for each species at their equilibrium concentrations ($[c_i]_{eq}$):\n$$\n\\mu_{\\mathrm{PL}}^{\\circ} + RT \\ln\\left(\\frac{[c_{\\mathrm{PL}}]_{eq}}{c^{\\circ}}\\right) = \\left(\\mu_{\\mathrm{P}}^{\\circ} + RT \\ln\\left(\\frac{[c_{\\mathrm{P}}]_{eq}}{c^{\\circ}}\\right)\\right) + \\left(\\mu_{\\mathrm{L}}^{\\circ} + RT \\ln\\left(\\frac{[c_{\\mathrm{L}}]_{eq}}{c^{\\circ}}\\right)\\right)\n$$\nRearranging this equation to group the standard potential terms and the logarithmic terms gives:\n$$\n\\mu_{\\mathrm{PL}}^{\\circ} - \\mu_{\\mathrm{P}}^{\\circ} - \\mu_{\\mathrm{L}}^{\\circ} = -RT \\left[ \\ln\\left(\\frac{[c_{\\mathrm{PL}}]_{eq}}{c^{\\circ}}\\right) - \\ln\\left(\\frac{[c_{\\mathrm{P}}]_{eq}}{c^{\\circ}}\\right) - \\ln\\left(\\frac{[c_{\\mathrm{L}}]_{eq}}{c^{\\circ}}\\right) \\right]\n$$\nThe left side of the equation is the definition of the standard Gibbs free energy change for the reaction, $\\Delta G^{\\circ}$:\n$$\n\\Delta G^{\\circ} = \\mu_{\\mathrm{PL}}^{\\circ} - (\\mu_{\\mathrm{P}}^{\\circ} + \\mu_{\\mathrm{L}}^{\\circ})\n$$\nUsing the properties of logarithms, the right side can be simplified:\n$$\n\\Delta G^{\\circ} = -RT \\ln\\left( \\frac{[c_{\\mathrm{PL}}]_{eq}/c^{\\circ}}{([c_{\\mathrm{P}}]_{eq}/c^{\\circ})([c_{\\mathrm{L}}]_{eq}/c^{\\circ})} \\right)\n$$\nThe dimensionless quantity inside the logarithm is the thermodynamic equilibrium constant for the association reaction, $K_{eq}$:\n$$\nK_{eq} = \\frac{[c_{\\mathrm{PL}}]_{eq}/c^{\\circ}}{([c_{\\mathrm{P}}]_{eq}/c^{\\circ})([c_{\\mathrm{L}}]_{eq}/c^{\\circ})} = \\frac{[c_{\\mathrm{PL}}]_{eq}}{[c_{\\mathrm{P}}]_{eq}[c_{\\mathrm{L}}]_{eq}} c^{\\circ}\n$$\nThe dissociation constant, $K_D$, is defined for the reverse reaction, $\\mathrm{PL} \\rightleftharpoons \\mathrm{P} + \\mathrm{L}$:\n$$\nK_D = \\frac{[c_{\\mathrm{P}}]_{eq}[c_{\\mathrm{L}}]_{eq}}{[c_{\\mathrm{PL}}]_{eq}}\n$$\nNote that $K_D$ has units of concentration. The association constant, $K_A$, is the reciprocal of the dissociation constant, $K_A = \\frac{1}{K_D}$. Substituting this into the expression for $K_{eq}$:\n$$\nK_{eq} = K_A c^{\\circ} = \\frac{c^{\\circ}}{K_D}\n$$\nNow we can write the relationship between $\\Delta G^{\\circ}$ and $K_D$:\n$$\n\\Delta G^{\\circ} = -RT \\ln(K_{eq}) = -RT \\ln\\left(\\frac{c^{\\circ}}{K_D}\\right)\n$$\nTo solve for $K_D$, we rearrange this equation:\n$$\n-\\frac{\\Delta G^{\\circ}}{RT} = \\ln\\left(\\frac{c^{\\circ}}{K_D}\\right)\n$$\n$$\n\\exp\\left(-\\frac{\\Delta G^{\\circ}}{RT}\\right) = \\frac{c^{\\circ}}{K_D}\n$$\n$$\nK_D = c^{\\circ} \\exp\\left(\\frac{\\Delta G^{\\circ}}{RT}\\right)\n$$\nThis is the derived relationship. Now, we substitute the given values:\n$\\Delta G^{\\circ} = -5.0 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}$\n$T = 298 \\ \\mathrm{K}$\n$R = 0.001987 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n$c^{\\circ} = 1 \\ \\mathrm{M}$\n\nFirst, we compute the value of the thermal energy, $RT$:\n$$\nRT = (0.001987 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (298 \\ \\mathrm{K}) \\approx 0.592126 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\n$$\nNext, we compute the exponent:\n$$\n\\frac{\\Delta G^{\\circ}}{RT} = \\frac{-5.0 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}}{0.592126 \\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}} \\approx -8.4443\n$$\nFinally, we calculate $K_D$:\n$$\nK_D = (1 \\ \\mathrm{M}) \\times \\exp(-8.4443) \\approx 1 \\ \\mathrm{M} \\times 0.00021516\n$$\n$$\nK_D \\approx 2.1516 \\times 10^{-4} \\ \\mathrm{M}\n$$\nThe input value for $\\Delta G^{\\circ}$ is given with two significant figures ($-5.0$). Therefore, the final result must be rounded to two significant figures.\n$$\nK_D \\approx 2.2 \\times 10^{-4} \\ \\mathrm{M}\n$$\nThis dissociation constant, $2.2 \\times 10^{-4} \\ \\mathrm{M}$ or $220 \\ \\mu\\mathrm{M}$, is a weak to moderate affinity. This value is entirely plausible and readily detectable by common biophysical techniques used in fragment screening, such as ligand-observed Nuclear Magnetic Resonance (NMR) spectroscopy (e.g., Saturation Transfer Difference experiments, WaterLOGSY, or Chemical Shift Perturbation titrations). These methods are most sensitive to affinities in the micromolar to millimolar range, making a $K_D$ of $220 \\ \\mu\\mathrm{M}$ an ideal value for a fragment hit, indicating a promising starting point for further chemical optimization.",
            "answer": "$$\\boxed{2.2 \\times 10^{-4}}$$"
        },
        {
            "introduction": "In fragment-based design, a primary strategy for improving an initial hit is to 'grow' the fragment by adding new chemical groups that make additional favorable contacts. However, not all growth is equal; this practice introduces Group Efficiency ($GE$), a crucial metric for evaluating the 'return on investment' for each atom added. By calculating $GE$, you learn to quantitatively assess the effectiveness of a chemical modification, helping to prioritize the most promising optimization paths. ",
            "id": "3847325",
            "problem": "In fragment-based ligand design, a small fragment $A$ with $n$ heavy atoms binds to a protein with standard binding free energy $\\Delta G_{A}$ as defined by $\\Delta G^{\\circ} = +R T \\ln K_{d}$, where $R$ is the universal gas constant, $T$ is the absolute temperature, and $K_{d}$ is the dissociation constant. A chemically modified ligand $A'$ is obtained by growing $A$ through the addition of a chemical group that contributes $\\Delta N_{\\text{heavy}}$ new heavy atoms, yielding a new standard binding free energy $\\Delta G_{A\\to A'}$. Assuming that binding contributions are approximately additive at the level of incremental noncovalent contacts and that the change in binding free energy upon growth is captured by $\\Delta \\Delta G = \\Delta G_{A\\to A'} - \\Delta G_{A}$, define and derive the expression for the group efficiency $GE$ of the added group as the magnitude of the binding free energy improvement per added heavy atom. Then compute $GE$ given $\\Delta G_{A} = -4.0$ kcal/mol, $\\Delta G_{A\\to A'} = -6.5$ kcal/mol, and $\\Delta N_{\\text{heavy}} = 3$. Based on commonly cited fragment growth expectations (for example, improvements on the order of $0.3$ to $0.5$ kcal/mol per heavy atom are considered strong), interpret whether the added group is efficient. Express $GE$ in kcal/mol per heavy atom and round your numerical answer to four significant figures.",
            "solution": "The user has provided a problem from the field of computational chemical biology, specifically concerning fragment-based ligand design. The task is to define and derive an expression for group efficiency ($GE$), compute its value given specific data, and interpret the result.\n\nFirst, a validation of the problem statement is performed.\n\n### Step 1: Extract Givens\n- Initial fragment: $A$\n- Heavy atoms in fragment $A$: $n$\n- Standard binding free energy of $A$: $\\Delta G_{A}$\n- Definition of standard binding free energy: $\\Delta G^{\\circ} = +R T \\ln K_{d}$, where $R$ is the universal gas constant, $T$ is the absolute temperature, and $K_{d}$ is the dissociation constant.\n- Modified ligand: $A'$, formed by growing $A$.\n- Number of added heavy atoms: $\\Delta N_{\\text{heavy}}$\n- Standard binding free energy of $A'$: $\\Delta G_{A\\to A'}$\n- Change in binding free energy: $\\Delta \\Delta G = \\Delta G_{A\\to A'} - \\Delta G_{A}$\n- Definition of Group Efficiency ($GE$): \"the magnitude of the binding free energy improvement per added heavy atom\".\n- Numerical data for calculation: $\\Delta G_{A} = -4.0$ kcal/mol, $\\Delta G_{A\\to A'} = -6.5$ kcal/mol, $\\Delta N_{\\text{heavy}} = 3$.\n- Benchmark for interpretation: Improvements of $0.3$ to $0.5$ kcal/mol per heavy atom are considered \"strong\".\n- Required output format: Express $GE$ in kcal/mol per heavy atom, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of physical chemistry and medicinal chemistry. The concepts of binding free energy, fragment-based drug design, and ligand efficiency metrics like group efficiency are standard and well-established. The provided relationship for $\\Delta G^{\\circ}$ is a fundamental equation in thermodynamics. The numerical values for binding energies and the number of atoms are realistic for typical small-molecule ligands. The problem is well-posed, with a clear objective and sufficient data to reach a unique solution. The language is objective and precise. The problem is directly relevant to the topic of *fragment-based ligand design principles* and is free from any scientific flaws, ambiguities, or contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will now proceed.\n\nThe solution consists of three parts as requested: derivation of the $GE$ expression, calculation of its value, and interpretation of the result.\n\n**1. Definition and Derivation of Group Efficiency ($GE$)**\n\nGroup efficiency, $GE$, is defined in the problem as \"the magnitude of the binding free energy improvement per added heavy atom.\" We formalize this definition.\n\nThe binding free energy of a ligand is a measure of its binding affinity to a target. A more negative value of the standard binding free energy, $\\Delta G^{\\circ}$, corresponds to stronger binding. Therefore, a \"binding free energy improvement\" signifies a decrease in its value.\n\nLet the initial binding free energy be $\\Delta G_{A}$ and the final binding free energy after growing the fragment be $\\Delta G_{A\\to A'}$. The change in free energy is given as $\\Delta \\Delta G = \\Delta G_{A\\to A'} - \\Delta G_{A}$.\n\nFor an improvement in binding, we must have $\\Delta G_{A\\to A'}  \\Delta G_{A}$, which means that $\\Delta \\Delta G$ will be a negative quantity.\n\nThe \"improvement\" itself is a positive value that quantifies the magnitude of this energy decrease. Let's call this improvement $I$. It is calculated as the initial energy minus the final energy:\n$$ I = \\Delta G_{A} - \\Delta G_{A\\to A'} $$\nBy substituting the definition of $\\Delta \\Delta G$, we can express the improvement as:\n$$ I = -(\\Delta G_{A\\to A'} - \\Delta G_{A}) = -\\Delta \\Delta G $$\nSince $I$ is a positive value for an improvement, it is its own magnitude. Thus, \"the magnitude of the binding free energy improvement\" is $I = -\\Delta \\Delta G$.\n\nGroup efficiency, $GE$, is this improvement normalized by the number of added heavy atoms, $\\Delta N_{\\text{heavy}}$. Therefore, the derived expression for $GE$ is:\n$$ GE = \\frac{I}{\\Delta N_{\\text{heavy}}} = \\frac{-\\Delta \\Delta G}{\\Delta N_{\\text{heavy}}} = \\frac{\\Delta G_{A} - \\Delta G_{A\\to A'}}{\\Delta N_{\\text{heavy}}} $$\n\n**2. Calculation of $GE$**\n\nThe problem provides the necessary values:\n- $\\Delta G_{A} = -4.0$ kcal/mol\n- $\\Delta G_{A\\to A'} = -6.5$ kcal/mol\n- $\\Delta N_{\\text{heavy}} = 3$\n\nWe substitute these values into our derived formula for $GE$:\n$$ GE = \\frac{(-4.0 \\, \\text{kcal/mol}) - (-6.5 \\, \\text{kcal/mol})}{3} $$\n$$ GE = \\frac{-4.0 + 6.5}{3} \\, \\frac{\\text{kcal/mol}}{\\text{heavy atom}} $$\n$$ GE = \\frac{2.5}{3} \\, \\frac{\\text{kcal/mol}}{\\text{heavy atom}} $$\n$$ GE \\approx 0.83333... \\, \\frac{\\text{kcal/mol}}{\\text{heavy atom}} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ GE \\approx 0.8333 \\, \\frac{\\text{kcal/mol}}{\\text{heavy atom}} $$\n\n**3. Interpretation of the Result**\n\nThe calculated group efficiency is $GE \\approx 0.8333$ kcal/mol per heavy atom. The problem provides a benchmark for interpretation: \"improvements on the order of $0.3$ to $0.5$ kcal/mol per heavy atom are considered strong.\"\n\nComparing our calculated value to this benchmark, we find that $0.8333$ is substantially greater than the upper limit of the \"strong\" range, which is $0.5$. This indicates that the added chemical group is exceptionally efficient. It provides a very high return in binding affinity for the number of heavy atoms it adds to the parent fragment. In the context of drug design, such a high $GE$ value would make the modification highly desirable, as it indicates an optimal extension that productively interacts with the protein binding site without introducing undue size or unfavorable properties.",
            "answer": "$$\n\\boxed{0.8333}\n$$"
        },
        {
            "introduction": "Moving beyond macroscopic thermodynamics, this advanced practice delves into the structural origins of binding affinity. You will implement a foundational computational chemistry algorithm to estimate the hydrophobic effect, a major driving force in molecular recognition, by calculating the Solvent Accessible Surface Area ($SASA$) buried upon binding. This exercise provides a hands-on understanding of how we can connect a molecule's 3D structure to its energetic contributions, a core principle in structure-based drug design. ",
            "id": "3847336",
            "problem": "You are to implement a program that, given simplified atomistic models of a protein and a fragment, computes the change in Solvent Accessible Surface Area (SASA) upon binding and relates the nonpolar burial to the hydrophobic contribution to the standard Gibbs free energy change of binding. The program must compute the nonpolar SASA for the protein alone, the fragment alone, and the complex (protein + fragment), using a probe-based surface definition consistent with the Shrake–Rupley algorithm, and then estimate the hydrophobic contribution to the binding free energy via a linear empirical correlation.\n\nBegin from the following fundamental base:\n- Solvent Accessible Surface Area (SASA) is defined as the area traced by the center of a spherical solvent probe of radius $r_p$ as it rolls over the van der Waals surface of the molecule. For an atom $i$ with van der Waals radius $r_i$, the accessible surface is approximated by sampling $P$ approximately uniformly distributed directions on the unit sphere, generating points at radius $R_i = r_i + r_p$, and counting the fraction of directions where the point is not occluded by any neighboring atom $j$ with expanded radius $R_j = r_j + r_p$.\n- For a set of atoms, the SASA is the sum over atoms of their accessible area, which, under uniform sampling, can be approximated by $A_i \\approx 4\\pi R_i^2 \\cdot \\frac{n_i^{\\text{acc}}}{P}$, where $n_i^{\\text{acc}}$ is the number of accessible sample points for atom $i$.\n- The hydrophobic contribution to the standard Gibbs free energy change of binding is correlated to the buried nonpolar surface area by an empirical linear relation of the form $\\Delta G_{\\text{hydrophobic}} \\approx -\\gamma \\cdot \\Delta A_{\\text{nonpolar}}$, where $\\gamma$ is an empirical coefficient and $\\Delta A_{\\text{nonpolar}}$ is the nonpolar surface area buried upon binding.\n\nYour program must implement the following computational definitions and conventions:\n- Use probe radius $r_p = 1.4$ Å and $P = 960$ sample directions per atom.\n- Use van der Waals radii (in Å): carbon $r_{\\mathrm{C}} = 1.70$, nitrogen $r_{\\mathrm{N}} = 1.55$, oxygen $r_{\\mathrm{O}} = 1.52$, sulfur $r_{\\mathrm{S}} = 1.80$, hydrogen $r_{\\mathrm{H}} = 1.20$.\n- Classify atoms as nonpolar if and only if they are carbon or sulfur. All other elements in this problem are considered polar.\n- When computing SASA for any assembly (protein alone, fragment alone, or complex), occlusion must consider all atoms present in that assembly.\n- Compute the nonpolar SASA $A_{\\text{np}}$ for the protein alone, the fragment alone, and the complex. The buried nonpolar area is $\\Delta A_{\\text{nonpolar}} = A_{\\text{np}}(\\text{protein}) + A_{\\text{np}}(\\text{fragment}) - A_{\\text{np}}(\\text{complex})$.\n- Use $\\gamma = 0.00542$ kcal mol$^{-1}$ Å$^{-2}$.\n- The hydrophobic free energy contribution is $\\Delta G_{\\text{hydrophobic}} = -\\gamma \\cdot \\Delta A_{\\text{nonpolar}}$ in kcal/mol.\n\nAngles, if any, are not required. All lengths must be treated in Ångströms. Areas must be in Å$^2$. Energies must be in kcal/mol.\n\nTest Suite:\nEach test case below provides two lists of atoms: one for the protein and one for the fragment. Each atom is specified by an element symbol and Cartesian coordinates in Å as a tuple $(\\text{element}, x, y, z)$. For all cases, use the common parameters listed above.\n\n- Test Case 1 (hydrophobic contact present):\n  - Protein atoms:\n    - $\\left(\\mathrm{C}, 0.0, 0.0, 0.0\\right)$\n    - $\\left(\\mathrm{C}, 3.0, 0.0, 0.0\\right)$\n    - $\\left(\\mathrm{C}, 0.0, 3.0, 0.0\\right)$\n    - $\\left(\\mathrm{N}, 1.5, -2.5, 0.0\\right)$\n  - Fragment atoms:\n    - $\\left(\\mathrm{C}, 1.5, 1.5, 0.0\\right)$\n    - $\\left(\\mathrm{C}, 1.5, 1.5, 1.5\\right)$\n\n- Test Case 2 (no contact; distant fragment):\n  - Protein atoms: same as Test Case $1$.\n  - Fragment atoms:\n    - $\\left(\\mathrm{C}, 20.0, 20.0, 20.0\\right)$\n    - $\\left(\\mathrm{C}, 22.0, 22.0, 22.0\\right)$\n\n- Test Case 3 (fragment deeply surrounded by hydrophobic atoms):\n  - Protein atoms:\n    - $\\left(\\mathrm{C}, 3.0, 0.0, 0.0\\right)$\n    - $\\left(\\mathrm{C}, -3.0, 0.0, 0.0\\right)$\n    - $\\left(\\mathrm{C}, 0.0, 3.0, 0.0\\right)$\n    - $\\left(\\mathrm{C}, 0.0, -3.0, 0.0\\right)$\n    - $\\left(\\mathrm{C}, 0.0, 0.0, 3.0\\right)$\n    - $\\left(\\mathrm{C}, 0.0, 0.0, -3.0\\right)$\n  - Fragment atoms:\n    - $\\left(\\mathrm{C}, 0.0, 0.0, 0.0\\right)$\n    - $\\left(\\mathrm{C}, 0.5, 0.5, 0.5\\right)$\n\n- Test Case 4 (all atoms polar; no nonpolar burial expected even if SASA changes overall):\n  - Protein atoms:\n    - $\\left(\\mathrm{O}, 0.0, 0.0, 0.0\\right)$\n    - $\\left(\\mathrm{N}, 3.0, 0.0, 0.0\\right)$\n    - $\\left(\\mathrm{O}, 0.0, 3.0, 0.0\\right)$\n  - Fragment atoms:\n    - $\\left(\\mathrm{O}, 1.5, 1.5, 0.0\\right)$\n    - $\\left(\\mathrm{N}, 1.5, 1.5, 1.5\\right)$\n\n- Test Case 5 (minimal system; single-atom hydrophobic contact):\n  - Protein atoms:\n    - $\\left(\\mathrm{C}, 0.0, 0.0, 0.0\\right)$\n  - Fragment atoms:\n    - $\\left(\\mathrm{C}, 2.0, 0.0, 0.0\\right)$\n\nYour task:\n- Implement the Shrake–Rupley approximation to compute nonpolar SASA for each assembly as defined above.\n- For each test case, compute $\\Delta A_{\\text{nonpolar}}$ and then $\\Delta G_{\\text{hydrophobic}}$ in kcal/mol, using $\\gamma = 0.00542$ kcal mol$^{-1}$ Å$^{-2}$.\n- Report, for the five test cases in order, the values of $\\Delta G_{\\text{hydrophobic}}$ in kcal/mol, rounded to three decimals.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\dots\\right]$). Each result must be a floating-point number rounded to three decimals, representing $\\Delta G_{\\text{hydrophobic}}$ in kcal/mol for the corresponding test case.",
            "solution": "The problem is valid. It presents a scientifically grounded, well-posed, and objective computational task. The methodology is based on the established Shrake–Rupley algorithm for calculating Solvent Accessible Surface Area (SASA) and a widely used linear empirical model to relate buried nonpolar surface area to the hydrophobic contribution to binding free energy. All parameters, constants, and atomic coordinates are explicitly provided, allowing for a unique and verifiable solution.\n\nThe solution proceeds by implementing a program to compute the hydrophobic contribution to the Gibbs free energy of binding, $\\Delta G_{\\text{hydrophobic}}$, for several molecular systems. This is achieved through a multi-step process for each test case.\n\nFirst, the core algorithm for calculating SASA is implemented based on the provided Shrake–Rupley approximation. The accessible surface of an atom $i$ with van der Waals radius $r_i$ is probed using a conceptual solvent sphere of radius $r_p = 1.4$ Å. This defines an expanded sphere for atom $i$ of radius $R_i = r_i + r_p$. The surface of this expanded sphere is sampled with $P=960$ approximately uniformly distributed points. These points are generated using a Fibonacci sphere algorithm, which provides an efficient and high-quality distribution of unit vectors.\n\nThe total SASA for an atom $i$ is then approximated by the formula:\n$$\nA_i \\approx 4\\pi R_i^2 \\cdot \\frac{n_i^{\\text{acc}}}{P}\n$$\nwhere $n_i^{\\text{acc}}$ is the number of sample points on the expanded sphere of atom $i$ that are \"accessible,\" meaning they are not occluded by any other atom in the system.\n\nThe critical step is the occlusion check. A sample point $\\vec{p}$ on the surface of the expanded sphere of atom $i$ (centered at $\\vec{c}_i$) is considered occluded by a neighboring atom $j$ (centered at $\\vec{c}_j$) if the distance between $\\vec{p}$ and $\\vec{c}_j$ is less than the expanded radius of atom $j$, $R_j = r_j + r_p$. Mathematically, occlusion occurs if:\n$$\n||\\vec{p} - \\vec{c}_j||  R_j\n$$\nFor each sample point on a given atom $i$, the algorithm iterates through all other atoms $j$ in the molecular system to check for this condition. If any atom $j$ occludes the point, it is marked as inaccessible, and the algorithm proceeds to the next sample point.\n\nThe problem requires the calculation of the *nonpolar* SASA. Based on the given definition, atoms are classified as nonpolar if they are Carbon (C) or Sulfur (S). The program calculates the SASA contribution only for these nonpolar atoms, while still considering all atoms (polar and nonpolar) as potential occluders.\n\nFor each test case, the following sequence of calculations is performed:\n1.  Three molecular systems are defined: the protein alone, the fragment alone, and the protein-fragment complex (which includes all atoms from both the protein and the fragment).\n2.  The nonpolar SASA is computed for each of these three systems: $A_{\\text{np}}(\\text{protein})$, $A_{\\text{np}}(\\text{fragment})$, and $A_{\\text{np}}(\\text{complex})$.\n3.  The change in nonpolar accessible surface area upon binding, $\\Delta A_{\\text{nonpolar}}$, is determined. This represents the nonpolar surface area that becomes buried and inaccessible to the solvent when the fragment binds to the protein. It is calculated as:\n    $$\n    \\Delta A_{\\text{nonpolar}} = A_{\\text{np}}(\\text{protein}) + A_{\\text{np}}(\\text{fragment}) - A_{\\text{np}}(\\text{complex})\n    $$\n4.  Finally, the hydrophobic contribution to the standard Gibbs free energy change of binding is estimated using the provided empirical linear relationship:\n    $$\n    \\Delta G_{\\text{hydrophobic}} = -\\gamma \\cdot \\Delta A_{\\text{nonpolar}}\n    $$\n    Here, the empirical coefficient is given as $\\gamma = 0.00542$ kcal mol$^{-1}$ Å$^{-2}$. A positive $\\Delta A_{\\text{nonpolar}}$ (indicating burial of hydrophobic surfaces) results in a negative and thus favorable contribution to the binding free energy.\n\nThe implemented Python program encapsulates this entire logic. It processes each test case, calculates the respective $\\Delta G_{\\text{hydrophobic}}$ value, and formats the output as a comma-separated list of floating-point numbers rounded to three decimal places, as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in Solvent Accessible Surface Area (SASA) upon binding\n    and the hydrophobic contribution to the Gibbs free energy of binding.\n    \"\"\"\n    # Define problem constants and parameters\n    PROBE_RADIUS = 1.4  # in Å\n    P = 960  # Number of sample points per atom\n    G_FACTOR = 0.00542  # in kcal mol⁻¹ Å⁻²\n    VDW_RADII = {'C': 1.70, 'N': 1.55, 'O': 1.52, 'S': 1.80, 'H': 1.20}  # in Å\n    NONPOLAR_ATOMS = {'C', 'S'}\n\n    def generate_fibonacci_sphere_points(samples):\n        \"\"\"\n        Generates approximately uniform points on a unit sphere using the Fibonacci lattice method.\n        \"\"\"\n        points = np.zeros((samples, 3))\n        phi = np.pi * (3. - np.sqrt(5.))  # Golden angle in radians\n\n        for i in range(samples):\n            y = 1 - (i / float(samples - 1)) * 2  # y goes from 1 to -1\n            radius = np.sqrt(max(0, 1 - y * y))  # radius at y\n            theta = phi * i  # Golden angle increment\n\n            x = np.cos(theta) * radius\n            z = np.sin(theta) * radius\n            points[i] = [x, y, z]\n        return points\n\n    # Pre-calculate the sphere points for efficiency\n    SPHERE_POINTS = generate_fibonacci_sphere_points(P)\n\n    def process_raw_atoms(raw_atoms):\n        \"\"\"\n        Converts the raw atom data (element, x, y, z) into a more usable\n        list of dictionaries containing processed information like radii.\n        \"\"\"\n        processed = []\n        for elem, x, y, z in raw_atoms:\n            r_i = VDW_RADII[elem]\n            processed.append({\n                'elem': elem,\n                'coord': np.array([x, y, z]),\n                'R': r_i + PROBE_RADIUS, # Expanded radius\n                'is_np': elem in NONPOLAR_ATOMS\n            })\n        return processed\n\n    def calculate_nonpolar_sasa(atoms):\n        \"\"\"\n        Calculates the nonpolar Solvent Accessible Surface Area for a given list of atoms.\n        \"\"\"\n        total_np_sasa = 0.0\n\n        for i, atom_i in enumerate(atoms):\n            # We only need to calculate the SASA for nonpolar atoms\n            if not atom_i['is_np']:\n                continue\n\n            coord_i = atom_i['coord']\n            R_i = atom_i['R']\n            accessible_count = 0\n\n            # Iterate over each sample point on the expanded sphere of atom_i\n            for point_vec in SPHERE_POINTS:\n                sample_point = coord_i + R_i * point_vec\n                is_occluded = False\n\n                # Check for occlusion by any other atom in the system\n                for j, atom_j in enumerate(atoms):\n                    if i == j:\n                        continue\n\n                    coord_j = atom_j['coord']\n                    R_j = atom_j['R']\n\n                    # An atom is occluded if the distance from the sample point to the\n                    # center of a neighbor is less than the neighbor's expanded radius.\n                    dist_sq = np.sum((sample_point - coord_j)**2)\n                    if dist_sq  R_j**2:\n                        is_occluded = True\n                        break  # Point is occluded, no need to check other atoms\n\n                if not is_occluded:\n                    accessible_count += 1\n            \n            # Add this atom's contribution to the total nonpolar SASA\n            sasa_i = (4.0 * np.pi * R_i**2) * (accessible_count / P)\n            total_np_sasa += sasa_i\n\n        return total_np_sasa\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Test Case 1: hydrophobic contact present\n        (\n            [('C', 0.0, 0.0, 0.0), ('C', 3.0, 0.0, 0.0), ('C', 0.0, 3.0, 0.0), ('N', 1.5, -2.5, 0.0)],\n            [('C', 1.5, 1.5, 0.0), ('C', 1.5, 1.5, 1.5)]\n        ),\n        # Test Case 2: no contact; distant fragment\n        (\n            [('C', 0.0, 0.0, 0.0), ('C', 3.0, 0.0, 0.0), ('C', 0.0, 3.0, 0.0), ('N', 1.5, -2.5, 0.0)],\n            [('C', 20.0, 20.0, 20.0), ('C', 22.0, 22.0, 22.0)]\n        ),\n        # Test Case 3: fragment deeply surrounded by hydrophobic atoms\n        (\n            [('C', 3.0, 0.0, 0.0), ('C', -3.0, 0.0, 0.0), ('C', 0.0, 3.0, 0.0), ('C', 0.0, -3.0, 0.0), ('C', 0.0, 0.0, 3.0), ('C', 0.0, 0.0, -3.0)],\n            [('C', 0.0, 0.0, 0.0), ('C', 0.5, 0.5, 0.5)]\n        ),\n        # Test Case 4: all atoms polar\n        (\n            [('O', 0.0, 0.0, 0.0), ('N', 3.0, 0.0, 0.0), ('O', 0.0, 3.0, 0.0)],\n            [('O', 1.5, 1.5, 0.0), ('N', 1.5, 1.5, 1.5)]\n        ),\n        # Test Case 5: minimal system; single-atom hydrophobic contact\n        (\n            [('C', 0.0, 0.0, 0.0)],\n            [('C', 2.0, 0.0, 0.0)]\n        )\n    ]\n\n    results = []\n    for prot_raw, frag_raw in test_cases:\n        protein_atoms = process_raw_atoms(prot_raw)\n        fragment_atoms = process_raw_atoms(frag_raw)\n        complex_atoms = protein_atoms + fragment_atoms\n\n        # Calculate nonpolar SASA for each component and the complex\n        sasa_prot_np = calculate_nonpolar_sasa(protein_atoms)\n        sasa_frag_np = calculate_nonpolar_sasa(fragment_atoms)\n        sasa_comp_np = calculate_nonpolar_sasa(complex_atoms)\n\n        # Calculate buried nonpolar area\n        delta_a_np = sasa_prot_np + sasa_frag_np - sasa_comp_np\n\n        # Calculate hydrophobic contribution to binding free energy\n        delta_g_hydrophobic = -G_FACTOR * delta_a_np\n        results.append(delta_g_hydrophobic)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}