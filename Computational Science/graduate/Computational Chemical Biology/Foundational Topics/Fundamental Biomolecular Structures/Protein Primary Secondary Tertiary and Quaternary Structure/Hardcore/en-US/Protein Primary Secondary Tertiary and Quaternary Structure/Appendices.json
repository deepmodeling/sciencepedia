{
    "hands_on_practices": [
        {
            "introduction": "The stability of protein secondary and tertiary structures is fundamentally reliant on a network of non-covalent interactions, with the hydrogen bond being paramount. This exercise provides a practical application of first principles to quantify the energetic contribution of these bonds. By dissecting the hydrogen bond into a simplified yet physically meaningful electrostatic model, you will use Coulomb's law to calculate the stabilization energy of a $\\beta$-sheet, gaining a quantitative appreciation for how this critical interaction is modeled in computational chemistry .",
            "id": "3859736",
            "problem": "A protein segment forming an antiparallel $\\beta$-sheet presents a set of interstrand hydrogen bonds between backbone donors and acceptors. In a coarse-grained electrostatic model consistent with molecular mechanics, a hydrogen bond is treated as an interaction between a donor hydrogen partial charge and an acceptor carbonyl oxygen partial charge embedded in a medium of effective relative permittivity. The fundamental starting point is Coulomb’s law and the observation that hydrogen bond directionality arises because only the component of the donor $\\text{N}-\\text{H}$ vector colinear with the $\\text{H}\\cdots\\text{O}$ axis efficiently stabilizes the interaction. Accordingly, the stabilizing interaction scales with the square of the directional cosine between the $\\text{N}-\\text{H}$ bond and the $\\text{H}\\cdots\\text{O}$ axis, derived as a projection factor from basic vector geometry.\n\nAssume the following physically justified modeling choices:\n- Coulomb’s law governs the interaction of partial charges: donor hydrogen $q_{\\text{H}}$ and acceptor oxygen $q_{\\text{O}}$ separated by distance $r_{\\text{H}\\text{O}}$, screened by an effective relative permittivity $\\varepsilon_{r}$ appropriate for a protein interior.\n- Directionality is introduced as the square of the cosine between the $\\text{N}-\\text{H}$ vector and the $\\text{H}\\cdots\\text{O}$ vector. The hydrogen bond angle is provided as the donor-hydrogen-acceptor angle $\\theta$ (linear at $\\theta = 180^\\circ$). Use the projection factor $\\cos^{2}(\\theta)$ with $\\theta$ converted to radians when evaluating trigonometric functions.\n- Use the biomolecular Coulomb constant $k_{c}$ in kilojoule per mole, nanometer, and squared elementary charge units.\n\nParameters:\n- Partial charges (in units of the elementary charge): $q_{\\text{H}} = +0.33$ and $q_{\\text{O}} = -0.51$.\n- Effective relative permittivity: $\\varepsilon_{r} = 4$.\n- Coulomb constant: $k_{c} = 138.935456$ (kilojoule per mole nanometer per squared elementary charge).\n- Five interstrand hydrogen bonds with hydrogen-acceptor distances $r_{\\text{H}\\text{O}}$ (in nanometers) and donor-hydrogen-acceptor angles $\\theta$ (in degrees):\n  - Bond $1$: $r_{\\text{H}\\text{O}} = 0.193$, $\\theta = 171$.\n  - Bond $2$: $r_{\\text{H}\\text{O}} = 0.198$, $\\theta = 165$.\n  - Bond $3$: $r_{\\text{H}\\text{O}} = 0.205$, $\\theta = 160$.\n  - Bond $4$: $r_{\\text{H}\\text{O}} = 0.190$, $\\theta = 176$.\n  - Bond $5$: $r_{\\text{H}\\text{O}} = 0.202$, $\\theta = 168$.\n\nStarting only from Coulomb’s law and the directional projection principle described above, compute the total hydrogen bonding energy by summing the contributions of the five bonds. Convert each $\\theta$ from degrees to radians before applying the cosine. Express the final answer in kilojoules per mole and round to four significant figures.",
            "solution": "The problem requires the calculation of the total hydrogen bonding energy for a set of five interstrand hydrogen bonds in an antiparallel $\\beta$-sheet. The calculation is to be performed using a specified coarse-grained electrostatic model.\n\nThe model defines the potential energy, $E_i$, of a single hydrogen bond $i$ based on Coulomb's law, modified to account for the dielectric screening of the protein environment and the geometric directionality of the bond. The formula for the energy of a single bond is given by the product of the screened Coulombic interaction and a directional scaling factor.\n\nThe screened Coulombic interaction energy between the donor hydrogen partial charge, $q_{\\text{H}}$, and the acceptor oxygen partial charge, $q_{\\text{O}}$, separated by a distance $r_{\\text{H}\\text{O}}$, is given by:\n$$U_{\\text{Coulomb}} = k_{c} \\frac{q_{\\text{H}} q_{\\text{O}}}{\\varepsilon_{r} r_{\\text{H}\\text{O}}}$$\nwhere $k_{c}$ is the biomolecular Coulomb constant and $\\varepsilon_{r}$ is the effective relative permittivity of the medium.\n\nThe problem states that the directionality of the hydrogen bond is accounted for by a factor of $\\cos^2(\\theta)$, where $\\theta$ is the donor-hydrogen-acceptor angle. This factor modulates the strength of the interaction, with the maximum strength occurring at a linear geometry ($\\theta = 180^\\circ$ or $\\pi$ radians).\n\nCombining these principles, the energy for a single hydrogen bond $i$ is formulated as:\n$$E_i = k_{c} \\frac{q_{\\text{H}} q_{\\text{O}}}{\\varepsilon_{r} r_i} \\cos^2(\\theta_i)$$\nThe angles $\\theta_i$ are provided in degrees and must be converted to radians for the evaluation of the cosine function, using the conversion $\\theta_{\\text{rad}} = \\theta_{\\text{deg}} \\times \\frac{\\pi}{180}$.\n\nThe total hydrogen bonding energy, $E_{\\text{total}}$, is the sum of the energies of the five individual bonds:\n$$E_{\\text{total}} = \\sum_{i=1}^{5} E_i = \\sum_{i=1}^{5} k_{c} \\frac{q_{\\text{H}} q_{\\text{O}}}{\\varepsilon_{r} r_i} \\cos^2(\\theta_i)$$\n\nWe can factor out the constant terms:\n$$E_{\\text{total}} = k_{c} \\frac{q_{\\text{H}} q_{\\text{O}}}{\\varepsilon_{r}} \\sum_{i=1}^{5} \\frac{\\cos^2(\\theta_i)}{r_i}$$\n\nThe given parameters are:\n- $k_{c} = 138.935456 \\, \\text{kJ} \\cdot \\text{mol}^{-1} \\cdot \\text{nm} \\cdot e^{-2}$\n- $q_{\\text{H}} = +0.33 \\, e$\n- $q_{\\text{O}} = -0.51 \\, e$\n- $\\varepsilon_{r} = 4$\n\nFirst, let's calculate the constant pre-factor:\n$$k_{c} \\frac{q_{\\text{H}} q_{\\text{O}}}{\\varepsilon_{r}} = 138.935456 \\frac{(0.33) \\times (-0.51)}{4} = 138.935456 \\frac{-0.1683}{4}$$\n$$k_{c} \\frac{q_{\\text{H}} q_{\\text{O}}}{\\varepsilon_{r}} = -5.8465063008 \\, \\text{kJ} \\cdot \\text{mol}^{-1} \\cdot \\text{nm}$$\nThe negative sign indicates a stabilizing (attractive) interaction, which is expected for a hydrogen bond.\n\nNext, we calculate the term $\\frac{\\cos^2(\\theta_i)}{r_i}$ for each of the five bonds. The angles must be converted from degrees to radians.\n\n- **Bond 1**: $r_1 = 0.193$ nm, $\\theta_1 = 171^\\circ$\n  $$\\frac{\\cos^2(171^\\circ)}{0.193 \\, \\text{nm}} = \\frac{\\cos^2(171 \\times \\frac{\\pi}{180})}{0.193} \\approx \\frac{0.975528}{0.193} \\, \\text{nm}^{-1} \\approx 5.054549 \\, \\text{nm}^{-1}$$\n\n- **Bond 2**: $r_2 = 0.198$ nm, $\\theta_2 = 165^\\circ$\n  $$\\frac{\\cos^2(165^\\circ)}{0.198 \\, \\text{nm}} = \\frac{\\cos^2(165 \\times \\frac{\\pi}{180})}{0.198} \\approx \\frac{0.933013}{0.198} \\, \\text{nm}^{-1} \\approx 4.712185 \\, \\text{nm}^{-1}$$\n\n- **Bond 3**: $r_3 = 0.205$ nm, $\\theta_3 = 160^\\circ$\n  $$\\frac{\\cos^2(160^\\circ)}{0.205 \\, \\text{nm}} = \\frac{\\cos^2(160 \\times \\frac{\\pi}{180})}{0.205} \\approx \\frac{0.883022}{0.205} \\, \\text{nm}^{-1} \\approx 4.307425 \\, \\text{nm}^{-1}$$\n\n- **Bond 4**: $r_4 = 0.190$ nm, $\\theta_4 = 176^\\circ$\n  $$\\frac{\\cos^2(176^\\circ)}{0.190 \\, \\text{nm}} = \\frac{\\cos^2(176 \\times \\frac{\\pi}{180})}{0.190} \\approx \\frac{0.995134}{0.190} \\, \\text{nm}^{-1} \\approx 5.237546 \\, \\text{nm}^{-1}$$\n\n- **Bond 5**: $r_5 = 0.202$ nm, $\\theta_5 = 168^\\circ$\n  $$\\frac{\\cos^2(168^\\circ)}{0.202 \\, \\text{nm}} = \\frac{\\cos^2(168 \\times \\frac{\\pi}{180})}{0.202} \\approx \\frac{0.956773}{0.202} \\, \\text{nm}^{-1} \\approx 4.736501 \\, \\text{nm}^{-1}$$\n\nNow, we sum these values:\n$$\\sum_{i=1}^{5} \\frac{\\cos^2(\\theta_i)}{r_i} \\approx (5.054549 + 4.712185 + 4.307425 + 5.237546 + 4.736501) \\, \\text{nm}^{-1}$$\n$$\\sum_{i=1}^{5} \\frac{\\cos^2(\\theta_i)}{r_i} \\approx 24.048206 \\, \\text{nm}^{-1}$$\n\nFinally, we multiply this sum by the constant pre-factor to get the total energy:\n$$E_{\\text{total}} \\approx (-5.8465063008 \\, \\text{kJ} \\cdot \\text{mol}^{-1} \\cdot \\text{nm}) \\times (24.048206 \\, \\text{nm}^{-1})$$\n$$E_{\\text{total}} \\approx -140.5985 \\, \\text{kJ} \\cdot \\text{mol}^{-1}$$\n\nThe problem requires the final answer to be rounded to four significant figures.\n$$E_{\\text{total}} \\approx -140.6 \\, \\text{kJ} \\cdot \\text{mol}^{-1}$$\nThis represents the total stabilization energy contributed by the five specified hydrogen bonds within the antiparallel $\\beta$-sheet structure.",
            "answer": "$$\\boxed{-140.6}$$"
        },
        {
            "introduction": "While understanding a single interaction like the hydrogen bond is crucial, a protein's complete conformational energy landscape is a composite of numerous forces. This practice scales up from a single interaction to the entire system by tasking you with implementing a classical molecular mechanics potential energy function, or \"force field.\" By coding the various bonded and non-bonded energy terms, you will construct the computational engine that drives molecular simulations, providing a foundational understanding of how a protein's structure is defined and evaluated energetically .",
            "id": "3859789",
            "problem": "Consider a peptide-like atomic fragment modeled using classical molecular mechanics. The total potential energy $U$ is defined as the sum of five physically motivated terms over all relevant atoms and interactions: bond stretching, angle bending, dihedral torsion, Lennard–Jones (van der Waals), and electrostatic (Coulombic) interactions. The computation should use positions expressed in nanometers (nm), angles in radians, and energies in kilojoules per mole (kJ/mol). The dielectric constant is modeled by a relative permittivity $\\epsilon_r$. The program must compute $U$ for each provided test case and return the results as specified.\n\nFoundational base, definitions, and formulas to be implemented:\n\n- Bond stretching energy: for each bonded pair $(i,j)$,\n$$\nU_{\\text{bond}} = \\sum_{\\text{bonds}} \\frac{1}{2} k_b \\left(r_{ij} - r_0\\right)^2,\n$$\nwhere $k_b$ is the bond force constant in $\\text{kJ/mol/nm}^2$, $r_{ij}$ is the actual distance in $\\text{nm}$, and $r_0$ is the equilibrium bond length in $\\text{nm}$.\n\n- Angle bending energy: for each angle triplet $(i,j,k)$,\n$$\nU_{\\text{angle}} = \\sum_{\\text{angles}} \\frac{1}{2} k_{\\theta} \\left(\\theta - \\theta_0\\right)^2,\n$$\nwhere $k_{\\theta}$ is the angle force constant in $\\text{kJ/mol/rad}^2$, $\\theta$ is the actual angle in $\\text{rad}$, and $\\theta_0$ is the equilibrium angle in $\\text{rad}$.\n\n- Dihedral torsion energy: for each dihedral quartet $(i,j,k,\\ell)$,\n$$\nU_{\\text{dihedral}} = \\sum_{\\text{dihedrals}} k_{\\phi} \\left(1 + \\cos\\left(n \\phi - \\delta\\right)\\right),\n$$\nwhere $k_{\\phi}$ is in $\\text{kJ/mol}$, $\\phi$ is the dihedral angle in $\\text{rad}$ computed from positions, $n$ is an integer multiplicity, and $\\delta$ is the phase in $\\text{rad}$.\n\n- Lennard–Jones energy: for each nonbonded pair $(i,j)$,\n$$\nU_{\\text{LJ}} = \\sum_{\\substack{ij \\\\ \\text{nonbonded}}} s_{ij} \\cdot 4 \\epsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^6 \\right],\n$$\nwith mixing rules\n$$\n\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}, \\quad \\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2},\n$$\nwhere $\\epsilon_i$ and $\\sigma_i$ are per-atom Lennard–Jones parameters, $\\epsilon_{ij}$ in $\\text{kJ/mol}$ and $\\sigma_{ij}$ in $\\text{nm}$. The scaling factor $s_{ij}$ equals $1$ for general nonbonded interactions, and equals a specified $s_{1-4}$ for $1$-$4$ interactions (atoms separated by three bonds).\n\n- Electrostatic energy: for each nonbonded pair $(i,j)$,\n$$\nU_{\\text{elec}} = \\sum_{\\substack{ij \\\\ \\text{nonbonded}}} s_{ij} \\cdot \\frac{1}{4\\pi\\epsilon_0} \\cdot \\frac{q_i q_j}{\\epsilon_r r_{ij}},\n$$\nconverted to $\\text{kJ/mol}$ with charges $q$ in units of the elementary charge $e$, and distances $r$ in $\\text{nm}$. This yields a convenient constant\n$$\nK_{\\text{C}} = \\frac{N_A e^2}{4 \\pi \\epsilon_0} \\cdot \\frac{10^9}{10^3} \\approx 138.935456 \\ \\text{kJ/mol} \\cdot \\text{nm} \\cdot e^{-2},\n$$\nso that\n$$\nU_{\\text{elec}} = \\sum_{\\substack{ij \\\\ \\text{nonbonded}}} s_{ij} \\cdot \\frac{K_{\\text{C}}}{\\epsilon_r} \\cdot \\frac{q_i q_j}{r_{ij}}.\n$$\n\nGeometric computations:\n\n- Distances: for atoms at positions $\\mathbf{r}_i$ and $\\mathbf{r}_j$ in $\\text{nm}$,\n$$\nr_{ij} = \\left\\| \\mathbf{r}_i - \\mathbf{r}_j \\right\\|.\n$$\n\n- Angles: for atoms $(i,j,k)$,\n$$\n\\theta = \\arccos\\left( \\frac{ (\\mathbf{r}_i - \\mathbf{r}_j) \\cdot (\\mathbf{r}_k - \\mathbf{r}_j) }{ \\left\\| \\mathbf{r}_i - \\mathbf{r}_j \\right\\| \\left\\| \\mathbf{r}_k - \\mathbf{r}_j \\right\\| } \\right),\n$$\nwith the argument of $\\arccos$ numerically clamped to $[-1,1]$.\n\n- Dihedral angle: for atoms $(i,j,k,\\ell)$ with bond vectors $\\mathbf{b}_0 = \\mathbf{r}_j - \\mathbf{r}_i$, $\\mathbf{b}_1 = \\mathbf{r}_k - \\mathbf{r}_j$, $\\mathbf{b}_2 = \\mathbf{r}_\\ell - \\mathbf{r}_k$, define $\\hat{\\mathbf{b}}_1 = \\mathbf{b}_1 / \\left\\| \\mathbf{b}_1 \\right\\|$, and the vectors\n$$\n\\mathbf{v} = \\mathbf{b}_0 - \\left( \\mathbf{b}_0 \\cdot \\hat{\\mathbf{b}}_1 \\right) \\hat{\\mathbf{b}}_1, \\quad \\mathbf{w} = \\mathbf{b}_2 - \\left( \\mathbf{b}_2 \\cdot \\hat{\\mathbf{b}}_1 \\right) \\hat{\\mathbf{b}}_1.\n$$\nThen compute\n$$\n\\phi = \\operatorname{atan2} \\left( \\left( \\hat{\\mathbf{b}}_1 \\times \\mathbf{v} \\right) \\cdot \\mathbf{w}, \\ \\mathbf{v} \\cdot \\mathbf{w} \\right).\n$$\nThis expression is robust even when the angle is near linear configurations.\n\nNonbonded interaction conventions:\n\n- Exclude $(1$-$2)$ bonded pairs and $(1$-$3)$ angle pairs from the nonbonded sums.\n- Include $(1$-$4)$ dihedral-separated pairs with scaling factor $s_{1-4}$ for both Lennard–Jones and electrostatics.\n- All other pairs are included with scaling factor $s_{ij} = 1$.\n\nScientific rationale and relevance to protein structural levels:\n\n- Primary structure (sequence) sets the identities and partial charges $\\{q_i\\}$ and Lennard–Jones parameters $\\{\\epsilon_i,\\sigma_i\\}$.\n- Secondary and tertiary structures are sterically and energetically constrained by the bond, angle, and torsion terms, particularly the dihedral form controlling backbone $\\phi$ and $\\psi$ preferences.\n- Quaternary interactions are mediated by nonbonded Lennard–Jones and electrostatic terms across subunit interfaces.\n\nRequired output format:\n\n- Your program must output a single line containing a list of the total energies for the provided test cases, expressed in $\\text{kJ/mol}$ and rounded to six decimal places, as a comma-separated list enclosed in square brackets, for example, $\\left[1.234567,2.345678,3.456789\\right]$.\n\nAngle unit specification:\n\n- All angles are in radians.\n\nTest suite:\n\n- Test case $1$ (general case with all terms active):\n  - Positions in $\\text{nm}$: $\\left[ [0.000, 0.000, 0.000], [0.154, 0.000, 0.000], [0.308, 0.090, 0.000], [0.462, 0.090, 0.120] \\right]$.\n  - Bonds: $\\left(0,1,k_b=10000.0,r_0=0.154\\right)$, $\\left(1,2,k_b=10000.0,r_0=0.154\\right)$, $\\left(2,3,k_b=10000.0,r_0=0.154\\right)$.\n  - Angles: $\\left(0,1,2,k_{\\theta}=300.0,\\theta_0=1.910\\right)$, $\\left(1,2,3,k_{\\theta}=300.0,\\theta_0=1.910\\right)$.\n  - Dihedrals: $\\left(0,1,2,3,k_{\\phi}=2.0,n=3,\\delta=0.0\\right)$.\n  - Lennard–Jones per atom: $\\epsilon=\\left[0.36,0.36,0.36,0.36\\right]$, $\\sigma=\\left[0.34,0.34,0.34,0.34\\right]$.\n  - Charges in $e$: $\\left[0.3,-0.3,0.3,-0.3\\right]$.\n  - Relative permittivity: $\\epsilon_r = 1.0$.\n  - $1$-$4$ scaling: $s_{1-4} = 0.5$.\n\n- Test case $2$ (boundary case with colinear geometry and zero charges):\n  - Positions in $\\text{nm}$: $\\left[ [0.000, 0.000, 0.000], [0.150, 0.000, 0.000], [0.300, 0.000, 0.000], [0.450, 0.000, 0.000] \\right]$.\n  - Bonds: $\\left(0,1,k_b=10000.0,r_0=0.150\\right)$, $\\left(1,2,k_b=10000.0,r_0=0.150\\right)$, $\\left(2,3,k_b=10000.0,r_0=0.150\\right)$.\n  - Angles: $\\left(0,1,2,k_{\\theta}=500.0,\\theta_0=\\pi\\right)$, $\\left(1,2,3,k_{\\theta}=500.0,\\theta_0=\\pi\\right)$.\n  - Dihedrals: $\\left(0,1,2,3,k_{\\phi}=0.5,n=2,\\delta=0.0\\right)$.\n  - Lennard–Jones per atom: $\\epsilon=\\left[0.20,0.20,0.20,0.20\\right]$, $\\sigma=\\left[0.30,0.30,0.30,0.30\\right]$.\n  - Charges in $e$: $\\left[0.0,0.0,0.0,0.0\\right]$.\n  - Relative permittivity: $\\epsilon_r = 1.0$.\n  - $1$-$4$ scaling: $s_{1-4} = 0.5$.\n\n- Test case $3$ (edge case with strong short-range repulsion competing with electrostatics):\n  - Positions in $\\text{nm}$: $\\left[ [0.000, 0.000, 0.000], [0.100, 0.000, 0.000], [0.200, 0.000, 0.000], [0.210, 0.000, 0.000] \\right]$.\n  - Bonds: $\\left(0,1,k_b=10000.0,r_0=0.100\\right)$, $\\left(1,2,k_b=10000.0,r_0=0.100\\right)$, $\\left(2,3,k_b=10000.0,r_0=0.100\\right)$.\n  - Angles: $\\left(0,1,2,k_{\\theta}=400.0,\\theta_0=2.500\\right)$, $\\left(1,2,3,k_{\\theta}=400.0,\\theta_0=2.500\\right)$.\n  - Dihedrals: $\\left(0,1,2,3,k_{\\phi}=3.0,n=3,\\delta=\\pi\\right)$.\n  - Lennard–Jones per atom: $\\epsilon=\\left[0.36,0.36,0.36,0.36\\right]$, $\\sigma=\\left[0.34,0.34,0.34,0.34\\right]$.\n  - Charges in $e$: $\\left[0.5,0.0,0.0,-0.5\\right]$.\n  - Relative permittivity: $\\epsilon_r = 1.0$.\n  - $1$-$4$ scaling: $s_{1-4} = 0.5$.\n\nImplementation requirements:\n\n- Use the provided positions and parameters.\n- Apply the exclusion rules: exclude $(1$-$2)$ bonds and $(1$-$3)$ angle pairs from nonbonded interactions; include $(1$-$4)$ pairs with $s_{1-4}$ for both Lennard–Jones and electrostatics; all other nonbonded pairs have $s_{ij}=1$.\n- Compute and sum $U_{\\text{bond}}$, $U_{\\text{angle}}$, $U_{\\text{dihedral}}$, $U_{\\text{LJ}}$, and $U_{\\text{elec}}$ to obtain $U$ for each test case.\n- Express the final energies in $\\text{kJ/mol}$, rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $\\left[U_1,U_2,U_3\\right]$.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of classical molecular mechanics, well-posed with a complete set of parameters and clear definitions, and objective in its formulation. The provided formulas for potential energy terms and geometric calculations are standard in the field of computational chemistry. We may therefore proceed with a principled solution.\n\nThe total potential energy $U$ of the atomic system is the sum of five distinct energy terms: bond stretching ($U_{\\text{bond}}$), angle bending ($U_{\\text{angle}}$), dihedral torsion ($U_{\\text{dihedral}}$), Lennard-Jones interactions ($U_{\\text{LJ}}$), and electrostatic interactions ($U_{\\text{elec}}$).\n\n$$\nU = U_{\\text{bond}} + U_{\\text{angle}} + U_{\\text{dihedral}} + U_{\\text{LJ}} + U_{\\text{elec}}\n$$\n\nThe algorithmic approach involves systematically calculating each of these energy components for the provided atomic coordinates and force field parameters, and then summing them to find the total energy for each test case. The implementation will rely on vector algebra, primarily using the `numpy` library for efficiency and correctness.\n\nFirst, we define helper functions to compute the fundamental geometric quantities from the atomic positions $\\mathbf{r}_i \\in \\mathbb{R}^3$, given in units of nanometers ($\\text{nm}$).\n\nThe distance $r_{ij}$ between two atoms $i$ and $j$ is the Euclidean norm of the vector connecting them:\n$$\nr_{ij} = \\left\\| \\mathbf{r}_i - \\mathbf{r}_j \\right\\|\n$$\n\nThe angle $\\theta$ formed by a triplet of atoms $(i,j,k)$ centered at atom $j$ is calculated from the dot product of the normalized bond vectors $\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$ and $\\mathbf{r}_{kj} = \\mathbf{r}_k - \\mathbf{r}_j$:\n$$\n\\theta = \\arccos\\left( \\frac{ \\mathbf{r}_{ij} \\cdot \\mathbf{r}_{kj} }{ \\left\\| \\mathbf{r}_{ij} \\right\\| \\left\\| \\mathbf{r}_{kj} \\right\\| } \\right)\n$$\nTo prevent numerical domain errors from floating-point inaccuracies, the argument of the arccosine function is clamped to the interval $[-1, 1]$.\n\nThe dihedral angle $\\phi$ for a quartet of atoms $(i,j,k,\\ell)$ is computed using the robust formula provided, which avoids singularities in linear geometries. It involves projecting the outer bond vectors onto the plane normal to the central bond vector. Let $\\mathbf{b}_0 = \\mathbf{r}_j - \\mathbf{r}_i$, $\\mathbf{b}_1 = \\mathbf{r}_k - \\mathbf{r}_j$, and $\\mathbf{b}_2 = \\mathbf{r}_\\ell - \\mathbf{r}_k$. The angle $\\phi$ is then given by:\n$$\n\\phi = \\operatorname{atan2} \\left( \\left( \\hat{\\mathbf{b}}_1 \\times \\mathbf{v} \\right) \\cdot \\mathbf{w}, \\ \\mathbf{v} \\cdot \\mathbf{w} \\right)\n$$\nwhere $\\hat{\\mathbf{b}}_1 = \\mathbf{b}_1 / \\left\\| \\mathbf{b}_1 \\right\\|$, and $\\mathbf{v} = \\mathbf{b}_0 - \\left( \\mathbf{b}_0 \\cdot \\hat{\\mathbf{b}}_1 \\right) \\hat{\\mathbf{b}}_1$, $\\mathbf{w} = \\mathbf{b}_2 - \\left( \\mathbf{b}_2 \\cdot \\hat{\\mathbf{b}}_1 \\right) \\hat{\\mathbf{b}}_1$. If atoms $i, j, k$ or $j, k, l$ become collinear, this formulation remains well-defined, yielding $\\phi=0$ if all four atoms are collinear.\n\nWith these geometric functions, we can calculate each energy component.\n\n1.  **Bonded Energy Terms**: These terms depend on the defined molecular connectivity.\n    -   $U_{\\text{bond}}$: For each defined bond $(i,j)$ with force constant $k_b$ and equilibrium length $r_0$, we calculate the current distance $r_{ij}$ and apply the harmonic potential formula: $U_{\\text{bond}, ij} = \\frac{1}{2} k_b (r_{ij} - r_0)^2$. The total bond energy is the sum over all such bonds.\n    -   $U_{\\text{angle}}$: For each angle triplet $(i,j,k)$ with force constant $k_{\\theta}$ and equilibrium angle $\\theta_0$, we compute the current angle $\\theta$ and apply the harmonic potential: $U_{\\text{angle}, ijk} = \\frac{1}{2} k_{\\theta} (\\theta - \\theta_0)^2$. The total angle energy is the sum over all defined angles.\n    -   $U_{\\text{dihedral}}$: For each dihedral quartet $(i,j,k,\\ell)$ with parameters $k_{\\phi}$, $n$, and $\\delta$, we compute the current dihedral angle $\\phi$ and apply the periodic potential: $U_{\\text{dihedral}, ijk\\ell} = k_{\\phi} (1 + \\cos(n \\phi - \\delta))$. The total dihedral energy is the sum over all defined dihedrals.\n\n2.  **Nonbonded Energy Terms**: These terms are calculated for pairs of atoms that are not directly bonded. The calculation requires a systematic approach to identify and scale interactions correctly.\n    -   First, we establish sets of atom pairs corresponding to $1-2$ (bonds), $1-3$ (angles), and $1-4$ (dihedrals) relationships based on the provided connectivity lists.\n    -   Then, we iterate through all unique pairs of atoms $(i,j)$ with $ij$.\n    -   For each pair, we determine a scaling factor $s_{ij}$:\n        -   If $(i,j)$ is a $1-2$ or $1-3$ pair, the interaction is excluded ($s_{ij} = 0$).\n        -   If $(i,j)$ is a $1-4$ pair, $s_{ij}$ is set to the provided value $s_{1-4}$.\n        -   For all other pairs (separated by more than three bonds), $s_{ij} = 1$.\n    -   If $s_{ij}  0$, we calculate the Lennard-Jones and electrostatic contributions:\n        -   $U_{\\text{LJ}}$: The per-atom parameters $\\epsilon_i, \\sigma_i$ are combined using the standard mixing rules: $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$ and $\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$. The energy is then calculated as $U_{\\text{LJ}, ij} = s_{ij} \\cdot 4 \\epsilon_{ij} [(\\frac{\\sigma_{ij}}{r_{ij}})^{12} - (\\frac{\\sigma_{ij}}{r_{ij}})^6]$.\n        -   $U_{\\text{elec}}$: Using the given pre-computed constant $K_{\\text{C}} \\approx 138.935456 \\ \\text{kJ/mol} \\cdot \\text{nm} \\cdot e^{-2}$, the electrostatic energy for the pair is calculated as $U_{\\text{elec}, ij} = s_{ij} \\cdot \\frac{K_{\\text{C}}}{\\epsilon_r} \\cdot \\frac{q_i q_j}{r_{ij}}$.\n    -   The total nonbonded energies, $U_{\\text{LJ}}$ and $U_{\\text{elec}}$, are the sums of these contributions over all interacting pairs.\n\nFinally, the total potential energy $U$ for a given configuration is the sum of all five calculated components. This entire process is repeated for each of the provided test cases. The final results are rounded to six decimal places as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the total potential energy of a peptide-like atomic fragment\n    for a series of test cases based on a classical molecular mechanics model.\n    \"\"\"\n    \n    # Coulomb's constant in specified units (kJ/mol * nm / e^2)\n    K_C = 138.935456\n\n    # --- Geometric Helper Functions ---\n    def get_distance(p1, p2):\n        return np.linalg.norm(p1 - p2)\n\n    def get_angle(p_i, p_j, p_k):\n        v_ji = p_i - p_j\n        v_jk = p_k - p_j\n        cos_theta = np.dot(v_ji, v_jk) / (np.linalg.norm(v_ji) * np.linalg.norm(v_jk))\n        # Clamp to avoid numerical errors with arccos\n        cos_theta = np.clip(cos_theta, -1.0, 1.0)\n        return np.arccos(cos_theta)\n\n    def get_dihedral(p_i, p_j, p_k, p_l):\n        b0 = p_j - p_i\n        b1 = p_k - p_j\n        b2 = p_l - p_k\n\n        norm_b1 = np.linalg.norm(b1)\n        if np.isclose(norm_b1, 0):\n            return 0.0 # Undefined, return a default value\n        \n        b1_hat = b1 / norm_b1\n\n        v = b0 - np.dot(b0, b1_hat) * b1_hat\n        w = b2 - np.dot(b2, b1_hat) * b1_hat\n        \n        norm_v = np.linalg.norm(v)\n        norm_w = np.linalg.norm(w)\n        if np.isclose(norm_v, 0) or np.isclose(norm_w, 0):\n            return 0.0 # Collinear cases lead to zero vectors v or w\n\n        y = np.dot(np.cross(b1_hat, v), w)\n        x = np.dot(v, w)\n        \n        return np.arctan2(y, x)\n\n    def calculate_total_energy(case):\n        positions = np.array(case[\"positions\"])\n        charges = np.array(case[\"charges\"])\n        epsilons = np.array(case[\"epsilons\"])\n        sigmas = np.array(case[\"sigmas\"])\n        epsilon_r = case[\"epsilon_r\"]\n        s_1_4 = case[\"s_1_4\"]\n        \n        total_energy = 0.0\n\n        # --- 1. Bond Energy ---\n        u_bond = 0.0\n        for i, j, k_b, r0 in case[\"bonds\"]:\n            r_ij = get_distance(positions[i], positions[j])\n            u_bond += 0.5 * k_b * (r_ij - r0)**2\n        total_energy += u_bond\n\n        # --- 2. Angle Energy ---\n        u_angle = 0.0\n        for i, j, k, k_theta, theta0 in case[\"angles\"]:\n            theta = get_angle(positions[i], positions[j], positions[k])\n            u_angle += 0.5 * k_theta * (theta - theta0)**2\n        total_energy += u_angle\n\n        # --- 3. Dihedral Energy ---\n        u_dihedral = 0.0\n        for i, j, k, l, k_phi, n, delta in case[\"dihedrals\"]:\n            phi = get_dihedral(positions[i], positions[j], positions[k], positions[l])\n            u_dihedral += k_phi * (1 + np.cos(n * phi - delta))\n        total_energy += u_dihedral\n\n        # --- 4. Nonbonded Energy (Lennard-Jones and Electrostatics) ---\n        num_atoms = len(positions)\n        u_lj = 0.0\n        u_elec = 0.0\n\n        # Build sets of excluded pairs\n        pairs_1_2 = {tuple(sorted((b[0], b[1]))) for b in case[\"bonds\"]}\n        pairs_1_3 = {tuple(sorted((a[0], a[2]))) for a in case[\"angles\"]}\n        pairs_1_4 = {tuple(sorted((d[0], d[3]))) for d in case[\"dihedrals\"]}\n\n        for i in range(num_atoms):\n            for j in range(i + 1, num_atoms):\n                pair = (i, j)\n                s_ij = 0.0 # Scaling factor\n\n                if pair in pairs_1_2 or pair in pairs_1_3:\n                    continue # Excluded\n                elif pair in pairs_1_4:\n                    s_ij = s_1_4\n                else: # General non-bonded interaction\n                    s_ij = 1.0\n\n                r_ij = get_distance(positions[i], positions[j])\n\n                # Lennard-Jones\n                epsilon_ij = np.sqrt(epsilons[i] * epsilons[j])\n                sigma_ij = (sigmas[i] + sigmas[j]) / 2.0\n                term = (sigma_ij / r_ij)**6\n                u_lj += s_ij * 4.0 * epsilon_ij * (term**2 - term)\n                \n                # Electrostatics\n                u_elec += s_ij * (K_C / epsilon_r) * (charges[i] * charges[j] / r_ij)\n        \n        total_energy += u_lj\n        total_energy += u_elec\n        \n        return total_energy\n\n    test_cases = [\n        {\n            \"positions\": [[0.000, 0.000, 0.000], [0.154, 0.000, 0.000], [0.308, 0.090, 0.000], [0.462, 0.090, 0.120]],\n            \"bonds\": [(0, 1, 10000.0, 0.154), (1, 2, 10000.0, 0.154), (2, 3, 10000.0, 0.154)],\n            \"angles\": [(0, 1, 2, 300.0, 1.910), (1, 2, 3, 300.0, 1.910)],\n            \"dihedrals\": [(0, 1, 2, 3, 2.0, 3, 0.0)],\n            \"epsilons\": [0.36, 0.36, 0.36, 0.36],\n            \"sigmas\": [0.34, 0.34, 0.34, 0.34],\n            \"charges\": [0.3, -0.3, 0.3, -0.3],\n            \"epsilon_r\": 1.0,\n            \"s_1_4\": 0.5\n        },\n        {\n            \"positions\": [[0.000, 0.000, 0.000], [0.150, 0.000, 0.000], [0.300, 0.000, 0.000], [0.450, 0.000, 0.000]],\n            \"bonds\": [(0, 1, 10000.0, 0.150), (1, 2, 10000.0, 0.150), (2, 3, 10000.0, 0.150)],\n            \"angles\": [(0, 1, 2, 500.0, np.pi), (1, 2, 3, 500.0, np.pi)],\n            \"dihedrals\": [(0, 1, 2, 3, 0.5, 2, 0.0)],\n            \"epsilons\": [0.20, 0.20, 0.20, 0.20],\n            \"sigmas\": [0.30, 0.30, 0.30, 0.30],\n            \"charges\": [0.0, 0.0, 0.0, 0.0],\n            \"epsilon_r\": 1.0,\n            \"s_1_4\": 0.5\n        },\n        {\n            \"positions\": [[0.000, 0.000, 0.000], [0.100, 0.000, 0.000], [0.200, 0.000, 0.000], [0.210, 0.000, 0.000]],\n            \"bonds\": [(0, 1, 10000.0, 0.100), (1, 2, 10000.0, 0.100), (2, 3, 10000.0, 0.100)],\n            \"angles\": [(0, 1, 2, 400.0, 2.500), (1, 2, 3, 400.0, 2.500)],\n            \"dihedrals\": [(0, 1, 2, 3, 3.0, 3, np.pi)],\n            \"epsilons\": [0.36, 0.36, 0.36, 0.36],\n            \"sigmas\": [0.34, 0.34, 0.34, 0.34],\n            \"charges\": [0.5, 0.0, 0.0, -0.5],\n            \"epsilon_r\": 1.0,\n            \"s_1_4\": 0.5\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        energy = calculate_total_energy(case)\n        results.append(energy)\n\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once we can model and simulate protein structures, the next essential task is to compare them quantitatively. This practice introduces two of the most fundamental metrics in structural biology: the Root-Mean-Square Deviation (RMSD) and the Template-Modeling (TM) score. By implementing and applying these metrics to carefully designed scenarios, you will develop an intuition for their respective sensitivities to local versus global structural deviations, a critical skill for interpreting data from molecular dynamics simulations, structural predictions, or experimental structure determination .",
            "id": "3859702",
            "problem": "You are given two three-dimensional protein structures represented by aligned Cartesian coordinates of corresponding residues, expressed in $\\text{\\AA}$ (Angstroms). The goal is to compute two structural similarity metrics and analyze their sensitivity to local versus global deviations in the context of tertiary and quaternary protein structure in computational chemical biology. Your implementation must follow a mathematically defined procedure based on fundamental definitions.\n\nFoundational base to use:\n- Let the aligned structures be sequences of points $\\{ \\mathbf{a}_i \\}_{i=1}^L$ and $\\{ \\mathbf{b}_i \\}_{i=1}^L$ in $\\mathbb{R}^3$, where $L$ is the number of aligned residues, and each $\\mathbf{a}_i = (x_i^{(a)}, y_i^{(a)}, z_i^{(a)})$ and $\\mathbf{b}_i = (x_i^{(b)}, y_i^{(b)}, z_i^{(b)})$ are expressed in $\\text{\\AA}$.\n- The Euclidean norm in $\\mathbb{R}^3$ is defined as $\\lVert \\mathbf{x} \\rVert_2 = \\sqrt{x_1^2 + x_2^2 + x_3^2}$. The squared Euclidean distance between aligned residues is $d_i^2 = \\lVert \\mathbf{a}_i - \\mathbf{b}_i \\rVert_2^2$.\n- The root-mean-square deviation (RMSD) is defined as the square root of the mean of $d_i^2$ over the aligned residues.\n- The Template Modeling score (TM-score) is defined as the mean over aligned residues of a bounded decreasing function of residue-wise distances that incorporates a length-dependent normalization factor $d_0(L)$. Use the widely accepted parameterization $d_0(L) = \\max\\left(0.5,\\ 1.24\\,(L - 15)^{1/3} - 1.8\\right)$ with $L$ in residues, and the per-residue contribution $f(d_i) = \\dfrac{1}{1 + \\left(\\dfrac{d_i}{d_0(L)}\\right)^2}$.\n\nTasks:\n1. For each test case below, generate the aligned coordinate sets $(\\mathbf{a}_i)_{i=1}^L$ and $(\\mathbf{b}_i)_{i=1}^L$ deterministically from the given parameters, then compute:\n   - The root-mean-square deviation (RMSD) in $\\text{\\AA}$.\n   - The Template Modeling score (TM-score), which is dimensionless.\n2. Round each reported float result to $6$ decimal places.\n3. Aggregate the results from all test cases in the specified final output format.\n\nTest suite definition (all coordinates are in $\\text{\\AA}$):\n- Case $1$ (happy path, identical structures): $L = 5$. Let $\\mathbf{a}_i = (i, 0, 0)$ for $i = 0, 1, 2, 3, 4$. Let $\\mathbf{b}_i = \\mathbf{a}_i$ for all $i$.\n- Case $2$ (local deviation edge case): $L = 5$. Let $\\mathbf{a}_i = (i, 0, 0)$ for $i = 0, 1, 2, 3, 4$. Let $\\mathbf{b}_i = \\mathbf{a}_i$ for all $i \\neq 2$, and for $i = 2$ set $\\mathbf{b}_2 = (2, 0, 8)$.\n- Case $3$ (global deviation with small length): $L = 10$. Let $\\mathbf{a}_i = (i, 0, 0)$ for $i = 0, 1, \\dots, 9$. Let $\\mathbf{b}_i = \\mathbf{a}_i + (3, 0, 0)$ for all $i$.\n- Case $4$ (global deviation with large length): $L = 50$. Let $\\mathbf{a}_i = (i, 0, 0)$ for $i = 0, 1, \\dots, 49$. Let $\\mathbf{b}_i = \\mathbf{a}_i + (3, 0, 0)$ for all $i$.\n- Case $5$ (mixed deviations): $L = 12$. Let $\\mathbf{a}_i = (i, 0, 0)$ for $i = 0, 1, \\dots, 11$. Let $\\mathbf{b}_i = \\mathbf{a}_i + (0, 0, 0.5)$ for $i = 0, 1, \\dots, 5$ and $\\mathbf{b}_i = \\mathbf{a}_i + (0, 0, 10)$ for $i = 6, 7, \\dots, 11$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a two-element list $[\\text{RMSD}, \\text{TM}]$ with both entries as floats rounded to $6$ decimal places. For example: $[[r_1, t_1],[r_2, t_2],\\dots]$.\n- Express RMSD in $\\text{\\AA}$ and TM-score as a dimensionless number, both rounded to $6$ decimal places.",
            "solution": "The problem requires the computation of two standard protein structure similarity metrics, the Root-Mean-Square Deviation (RMSD) and the Template Modeling score (TM-score), for five defined test cases. The validation confirms that the problem is scientifically sound, well-posed, and all definitions and parameters are consistent with established conventions in computational chemical biology. We shall now proceed with a formal solution.\n\nThe core of the problem lies in comparing two sets of $L$ corresponding points in three-dimensional space, $\\{ \\mathbf{a}_i \\}_{i=0}^{L-1}$ and $\\{ \\mathbf{b}_i \\}_{i=0}^{L-1}$, where each point represents a residue in a protein structure. For consistency with computational implementations, we adopt zero-based indexing from $i=0$ to $L-1$.\n\nThe fundamental quantity is the squared Euclidean distance between the $i$-th pair of residues:\n$$d_i^2 = \\lVert \\mathbf{a}_i - \\mathbf{b}_i \\rVert_2^2$$\nwhere $\\mathbf{a}_i, \\mathbf{b}_i \\in \\mathbb{R}^3$.\n\nThe first metric, RMSD, is defined as the square root of the arithmetic mean of these squared distances. It provides a measure of the average distance between corresponding atoms. Its formulation is:\n$$\\text{RMSD} = \\sqrt{\\frac{1}{L} \\sum_{i=0}^{L-1} d_i^2}$$\nThe RMSD is measured in the same units as the coordinates, which are Angstroms ($\\text{\\AA}$) in this problem. A key property of RMSD is its sensitivity to large deviations; a single large $d_i$ can significantly inflate the RMSD value, potentially masking good similarity across the rest of the structure.\n\nThe second metric, the TM-score, is designed to be a more nuanced measure of similarity, less sensitive to local errors and more indicative of global topological similarity. It is defined as:\n$$\\text{TM-score} = \\frac{1}{L} \\sum_{i=0}^{L-1} \\frac{1}{1 + \\left(\\frac{d_i}{d_0(L)}\\right)^2}$$\nThis score transforms each distance $d_i = \\sqrt{d_i^2}$ into a value between $0$ and $1$ using a sigmoidal-like function. The term $d_0(L)$ is a length-dependent normalization factor that makes the score's magnitude relatively independent of the protein's size $L$. The formula for $d_0(L)$ is:\n$$d_0(L) = \\max\\left(0.5,\\ 1.24\\sqrt[3]{L - 15} - 1.8\\right)$$\nDeviations much larger than $d_0(L)$ contribute very little to the final score, while deviations smaller than $d_0(L)$ contribute significantly. A TM-score close to $1$ indicates a near-perfect match, while a score below $0.2$ typically signifies unrelated structures.\n\nWe will now compute these two metrics for each of the five test cases.\n\n**Case 1: Identical Structures**\n$L = 5$. The coordinates are $\\mathbf{a}_i = (i, 0, 0)$ and $\\mathbf{b}_i = \\mathbf{a}_i$ for $i \\in \\{0, 1, 2, 3, 4\\}$.\nThe distance vector $\\mathbf{a}_i - \\mathbf{b}_i$ is the zero vector for all $i$.\nThus, $d_i^2 = 0$ for all $i$.\nThe sum of squared distances is $\\sum_{i=0}^{4} d_i^2 = 0$.\n$\\text{RMSD} = \\sqrt{\\frac{0}{5}} = 0.0\\ \\text{\\AA}$.\nFor the TM-score, we first compute $d_0(5)$. As $5  15$, the term $\\sqrt[3]{L-15}$ is negative.\n$d_0(5) = \\max(0.5, 1.24\\sqrt[3]{5 - 15} - 1.8) = \\max(0.5, 1.24\\sqrt[3]{-10} - 1.8) \\approx \\max(0.5, 1.24(-2.1544) - 1.8) = \\max(0.5, -4.4715) = 0.5\\ \\text{\\AA}$.\nSince all $d_i=0$, the TM-score is:\n$\\text{TM-score} = \\frac{1}{5} \\sum_{i=0}^{4} \\frac{1}{1 + \\left(\\frac{0}{0.5}\\right)^2} = \\frac{1}{5} \\sum_{i=0}^{4} 1 = 1.0$.\nResult: $[\\text{RMSD}, \\text{TM-score}] = [0.0, 1.0]$.\n\n**Case 2: Local Deviation**\n$L = 5$. Coordinates are $\\mathbf{a}_i = (i, 0, 0)$. The structure $\\mathbf{b}$ is identical except for residue $i=2$, where $\\mathbf{b}_2 = \\mathbf{a}_2 + (0, 0, 8) = (2, 0, 8)$.\nThe only non-zero distance is for $i=2$: $d_2^2 = \\lVert(2,0,0) - (2,0,8)\\rVert_2^2 = \\lVert(0,0,-8)\\rVert_2^2 = 64\\ \\text{\\AA}^2$.\nAll other $d_i^2=0$.\nThe sum of squared distances is $\\sum_{i=0}^{4} d_i^2 = 64$.\n$\\text{RMSD} = \\sqrt{\\frac{64}{5}} = \\sqrt{12.8} \\approx 3.577709\\ \\text{\\AA}$.\nThe normalization factor $d_0(5)$ is the same as in Case 1: $d_0(5) = 0.5\\ \\text{\\AA}$.\nFor the TM-score, we have $d_2 = \\sqrt{64} = 8\\ \\text{\\AA}$ and $d_i=0$ for $i \\neq 2$.\n$\\text{TM-score} = \\frac{1}{5} \\left( \\sum_{i \\in \\{0,1,3,4\\}} \\frac{1}{1 + \\left(\\frac{0}{0.5}\\right)^2} + \\frac{1}{1 + \\left(\\frac{8}{0.5}\\right)^2} \\right) = \\frac{1}{5} \\left( 4 \\times 1 + \\frac{1}{1 + 16^2} \\right) = \\frac{1}{5} \\left( 4 + \\frac{1}{257} \\right) \\approx \\frac{4.003891}{5} \\approx 0.800778$.\nResult: $[\\text{RMSD}, \\text{TM-score}] = [3.577709, 0.800778]$.\n\n**Case 3: Global Deviation, Short Chain**\n$L = 10$. $\\mathbf{a}_i = (i, 0, 0)$ and $\\mathbf{b}_i = \\mathbf{a}_i + (3, 0, 0)$ for all $i \\in \\{0, \\dots, 9\\}$.\nThis is a uniform translation. The distance vector is constant: $\\mathbf{a}_i - \\mathbf{b}_i = (-3, 0, 0)$.\n$d_i^2 = \\lVert(-3,0,0)\\rVert_2^2 = 9\\ \\text{\\AA}^2$ for all $i$.\nThe sum of squared distances is $\\sum_{i=0}^{9} d_i^2 = 10 \\times 9 = 90$.\n$\\text{RMSD} = \\sqrt{\\frac{90}{10}} = \\sqrt{9} = 3.0\\ \\text{\\AA}$.\nFor the TM-score, we compute $d_0(10)$:\n$d_0(10) = \\max(0.5, 1.24\\sqrt[3]{10 - 15} - 1.8) = \\max(0.5, 1.24\\sqrt[3]{-5} - 1.8) \\approx \\max(0.5, 1.24(-1.7100) - 1.8) = \\max(0.5, -3.9204) = 0.5\\ \\text{\\AA}$.\nThe distance $d_i = \\sqrt{9} = 3\\ \\text{\\AA}$ for all $i$.\n$\\text{TM-score} = \\frac{1}{10} \\sum_{i=0}^{9} \\frac{1}{1 + \\left(\\frac{3}{0.5}\\right)^2} = \\frac{1}{10} \\sum_{i=0}^{9} \\frac{1}{1 + 6^2} = \\frac{1}{10} \\times 10 \\times \\frac{1}{37} = \\frac{1}{37} \\approx 0.027027$.\nResult: $[\\text{RMSD}, \\text{TM-score}] = [3.0, 0.027027]$.\n\n**Case 4: Global Deviation, Long Chain**\n$L = 50$. $\\mathbf{a}_i = (i, 0, 0)$ and $\\mathbf{b}_i = \\mathbf{a}_i + (3, 0, 0)$ for all $i \\in \\{0, \\dots, 49\\}$.\nThe deviation is identical to Case 3, a uniform translation. Thus, $d_i^2 = 9\\ \\text{\\AA}^2$ for all $i$.\n$\\text{RMSD} = \\sqrt{\\frac{1}{50} \\sum_{i=0}^{49} 9} = \\sqrt{\\frac{50 \\times 9}{50}} = \\sqrt{9} = 3.0\\ \\text{\\AA}$.\nThe RMSD is insensitive to protein length for a uniform deviation.\nFor the TM-score, we compute $d_0(50)$:\n$d_0(50) = \\max(0.5, 1.24\\sqrt[3]{50 - 15} - 1.8) = \\max(0.5, 1.24\\sqrt[3]{35} - 1.8) \\approx \\max(0.5, 1.24(3.2711) - 1.8) = \\max(0.5, 2.2561) = 2.2561\\ \\text{\\AA}$.\nThe distance $d_i = 3\\ \\text{\\AA}$ for all $i$.\n$\\text{TM-score} = \\frac{1}{50} \\sum_{i=0}^{49} \\frac{1}{1 + \\left(\\frac{3}{2.2561}\\right)^2} \\approx \\frac{1}{1 + (1.3297)^2} \\approx \\frac{1}{1 + 1.7681} = \\frac{1}{2.7681} \\approx 0.361254$.\nResult: $[\\text{RMSD}, \\text{TM-score}] = [3.0, 0.361254]$. This result highlights how the length-dependent $d_0(L)$ makes the TM-score more tolerant of the same absolute deviation for longer proteins.\n\n**Case 5: Mixed Deviations**\n$L = 12$. $\\mathbf{a}_i = (i, 0, 0)$. The structure $\\mathbf{b}$ has two segments of different deviations.\nFor $i \\in \\{0, \\dots, 5\\}$ ($6$ residues): $\\mathbf{b}_i = \\mathbf{a}_i + (0, 0, 0.5)$. So $\\mathbf{a}_i - \\mathbf{b}_i = (0, 0, -0.5)$, and $d_i^2 = 0.25\\ \\text{\\AA}^2$.\nFor $i \\in \\{6, \\dots, 11\\}$ ($6$ residues): $\\mathbf{b}_i = \\mathbf{a}_i + (0, 0, 10)$. So $\\mathbf{a}_i - \\mathbf{b}_i = (0, 0, -10)$, and $d_i^2 = 100\\ \\text{\\AA}^2$.\nThe sum of squared distances is $\\sum d_i^2 = 6 \\times 0.25 + 6 \\times 100 = 1.5 + 600 = 601.5$.\n$\\text{RMSD} = \\sqrt{\\frac{601.5}{12}} = \\sqrt{50.125} \\approx 7.079900\\ \\text{\\AA}$. The large deviations in the second half dominate the RMSD.\nFor the TM-score, we compute $d_0(12)$:\n$d_0(12) = \\max(0.5, 1.24\\sqrt[3]{12 - 15} - 1.8) = \\max(0.5, 1.24\\sqrt[3]{-3} - 1.8) \\approx \\max(0.5, 1.24(-1.4422) - 1.8) = \\max(0.5, -3.5884) = 0.5\\ \\text{\\AA}$.\nFor the first half ($i \\in \\{0, \\dots, 5\\}$), $d_i = \\sqrt{0.25} = 0.5\\ \\text{\\AA}$. The per-residue score is $\\frac{1}{1 + (0.5/0.5)^2} = \\frac{1}{2}$.\nFor the second half ($i \\in \\{6, \\dots, 11\\}$), $d_i = \\sqrt{100} = 10\\ \\text{\\AA}$. The per-residue score is $\\frac{1}{1 + (10/0.5)^2} = \\frac{1}{1+20^2} = \\frac{1}{401}$.\nThe final TM-score is the average of these scores:\n$\\text{TM-score} = \\frac{1}{12} \\left( 6 \\times \\frac{1}{2} + 6 \\times \\frac{1}{401} \\right) = \\frac{1}{12} \\left( 3 + \\frac{6}{401} \\right) \\approx \\frac{3.01496}{12} \\approx 0.251247$.\nThe first half of the structure contributes significantly to the TM-score, while the poorly aligned second half contributes very little, demonstrating the score's focus on regions of good structural alignment.\nResult: $[\\text{RMSD}, \\text{TM-score}] = [7.079900, 0.251247]$.\n\nThe final aggregated results, rounded to $6$ decimal places, are:\nCase 1: $[0.0, 1.0]$\nCase 2: $[3.577709, 0.800778]$\nCase 3: $[3.0, 0.027027]$\nCase 4: $[3.0, 0.361254]$\nCase 5: $[7.079900, 0.251247]$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes RMSD and TM-score for five protein structure comparison test cases.\n    \"\"\"\n\n    test_cases = [\n        {'id': 1, 'L': 5, 'type': 'identical'},\n        {'id': 2, 'L': 5, 'type': 'local_dev'},\n        {'id': 3, 'L': 10, 'type': 'global_dev'},\n        {'id': 4, 'L': 50, 'type': 'global_dev'},\n        {'id': 5, 'L': 12, 'type': 'mixed_dev'}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L = case['L']\n        \n        # Generate coordinates for structure 'a'\n        a_coords = np.array([[float(i), 0.0, 0.0] for i in range(L)])\n        \n        # Generate coordinates for structure 'b' based on the test case\n        if case['type'] == 'identical':\n            b_coords = np.copy(a_coords)\n            \n        elif case['type'] == 'local_dev':\n            b_coords = np.copy(a_coords)\n            # Apply deviation at specific residue i=2\n            b_coords[2] += np.array([0.0, 0.0, 8.0])\n            \n        elif case['type'] == 'global_dev':\n            deviation = np.array([3.0, 0.0, 0.0])\n            b_coords = a_coords + deviation\n            \n        elif case['type'] == 'mixed_dev':\n            b_coords = np.copy(a_coords)\n            # First half deviation\n            b_coords[0:6] += np.array([0.0, 0.0, 0.5])\n            # Second half deviation\n            b_coords[6:12] += np.array([0.0, 0.0, 10.0])\n        \n        # Calculate squared distances d_i^2\n        diff_sq = (a_coords - b_coords)**2\n        d_i_sq = np.sum(diff_sq, axis=1)\n        \n        # 1. Compute RMSD\n        rmsd = np.sqrt(np.mean(d_i_sq))\n        \n        # 2. Compute TM-score\n        # Calculate d0(L)\n        if L = 15:\n            # np.cbrt handles negative arguments correctly for real roots\n            d0_L_val = 1.24 * np.cbrt(L - 15) - 1.8\n        else:\n            d0_L_val = 1.24 * np.cbrt(L - 15) - 1.8\n            \n        d0_L = max(0.5, d0_L_val)\n\n        # Calculate per-residue scores\n        d_i = np.sqrt(d_i_sq)\n        tm_terms = 1.0 / (1.0 + (d_i / d0_L)**2)\n        tm_score = np.mean(tm_terms)\n        \n        # Round results and append\n        rounded_rmsd = round(rmsd, 6)\n        rounded_tm_score = round(tm_score, 6)\n        results.append([rounded_rmsd, rounded_tm_score])\n\n    # Final print statement in the exact required format.\n    # Using str() and replace() to ensure format is exact without spaces.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}