{
    "hands_on_practices": [
        {
            "introduction": "The electrostatic character of amino acids and peptides is dominated by their titratable groups, which can exist in protonated or deprotonated states depending on the solution's $\\mathrm{pH}$. Before we can calculate the net charge of a molecule, we must first establish the fundamental relationship governing these protonation states. This practice guides you through the derivation of the core equation for the fraction of protonated species, starting from the law of mass action, providing the theoretical foundation for all electrostatic calculations in biophysics .",
            "id": "3835956",
            "problem": "A monoprotic, ionizable amino acid group in a peptide can be modeled by the equilibrium $\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+}$, where $\\mathrm{HA}$ denotes the protonated form and $\\mathrm{A}^{-}$ the deprotonated form of the group. In computational chemical biology, the state populations of such groups are often inferred from equilibrium thermodynamics using activities rather than concentrations. Starting from the law of mass action written in terms of activities $a_{X}$ and the definitions of potential of hydrogen ($\\mathrm{pH}$) and acid dissociation constant ($K_\\text{a}$), namely $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$ and $\\mathrm{p}K_\\text{a} = -\\log_{10}(K_\\text{a})$, derive an expression that relates $\\mathrm{pH}$, $\\mathrm{p}K_\\text{a}$, and the ratio of the deprotonated to protonated activities for this monoprotic group. Then, using this relationship and an explicit definition of the fraction protonated $f$ in terms of species populations, obtain a closed-form expression for $f$ in terms of $\\mathrm{pH}$ and $\\mathrm{p}K_\\text{a}$ under the assumption that the activity coefficients of the conjugate pair are equal in the buffered medium. Finally, evaluate the fraction protonated for an N-terminal amino group with $\\mathrm{p}K_\\text{a} = 8.00$ in a buffered aqueous solution at $25\\,^{\\circ}\\mathrm{C}$ and $\\mathrm{pH} = 7.00$, where the activity coefficients of $\\mathrm{HA}$ and $\\mathrm{A}^{-}$ can be treated as equal. Round your final numerical answer to five significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of chemical equilibrium, well-posed with sufficient information, and objective in its formulation. We will proceed with a step-by-step derivation and calculation.\n\nThe problem describes the acid-base equilibrium of a monoprotic group in a peptide, represented by the reaction:\n$$\n\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+}\n$$\nwhere $\\mathrm{HA}$ is the protonated form and $\\mathrm{A}^{-}$ is the deprotonated form.\n\nThe first task is to derive a relationship between $\\mathrm{pH}$, $\\mathrm{p}K_\\text{a}$, and the ratio of activities of the deprotonated to protonated forms. The law of mass action defines the acid dissociation constant, $K_\\text{a}$, in terms of the activities ($a$) of the species at equilibrium:\n$$\nK_\\text{a} = \\frac{a_{\\mathrm{A}^{-}} a_{\\mathrm{H}^{+}}}{a_{\\mathrm{HA}}}\n$$\nTo introduce $\\mathrm{pH}$ and $\\mathrm{p}K_\\text{a}$, we take the negative base-$10$ logarithm of both sides of this equation:\n$$\n-\\log_{10}(K_\\text{a}) = -\\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}} a_{\\mathrm{H}^{+}}}{a_{\\mathrm{HA}}} \\right)\n$$\nUsing the properties of logarithms, $\\log(xy) = \\log(x) + \\log(y)$ and $\\log(x/y) = \\log(x) - \\log(y)$, we can expand the right-hand side:\n$$\n-\\log_{10}(K_\\text{a}) = -\\log_{10}(a_{\\mathrm{H}^{+}}) - \\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} \\right)\n$$\nBy definition, $\\mathrm{p}K_\\text{a} = -\\log_{10}(K_\\text{a})$ and $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$. Substituting these definitions into the equation yields:\n$$\n\\mathrm{p}K_\\text{a} = \\mathrm{pH} - \\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} \\right)\n$$\nRearranging this equation to solve for $\\mathrm{pH}$ gives the desired relationship, which is a form of the Henderson-Hasselbalch equation written in terms of activities:\n$$\n\\mathrm{pH} = \\mathrm{p}K_\\text{a} + \\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} \\right)\n$$\nThe second task is to derive a closed-form expression for the fraction protonated, $f$. The fraction protonated is defined as the population of the protonated species divided by the total population of both protonated and deprotonated species. In a solution, population is proportional to molar concentration ($[\\cdot]$), so we can write:\n$$\nf = \\frac{[\\text{HA}]}{[\\text{HA}] + [\\text{A}^{-}]}\n$$\nThe activity $a_X$ of a species $X$ is related to its concentration $[X]$ by its activity coefficient $\\gamma_X$ through the equation $a_X = \\gamma_X [X]$. The problem provides the crucial assumption that the activity coefficients of the conjugate acid-base pair are equal, i.e., $\\gamma_{\\mathrm{HA}} = \\gamma_{\\mathrm{A}^{-}}$. This allows us to equate the ratio of activities to the ratio of concentrations:\n$$\n\\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} = \\frac{\\gamma_{\\mathrm{A}^{-}}[\\text{A}^{-}]}{\\gamma_{\\mathrm{HA}}[\\text{HA}]} = \\frac{[\\text{A}^{-}]}{[\\text{HA}]}\n$$\nWe can now substitute this concentration ratio into the activity-based relationship derived earlier:\n$$\n\\mathrm{pH} = \\mathrm{p}K_\\text{a} + \\log_{10}\\left( \\frac{[\\text{A}^{-}]}{[\\text{HA}]} \\right)\n$$\nTo find $f$, we first solve this equation for the concentration ratio $\\frac{[\\text{A}^{-}]}{[\\text{HA}]}$:\n$$\n\\mathrm{pH} - \\mathrm{p}K_\\text{a} = \\log_{10}\\left( \\frac{[\\text{A}^{-}]}{[\\text{HA}]} \\right)\n$$\nExponentiating both sides with base $10$ gives:\n$$\n10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})} = \\frac{[\\text{A}^{-}]}{[\\text{HA}]}\n$$\nNow, we return to the definition of $f$ and divide the numerator and the denominator by $[\\text{HA}]$:\n$$\nf = \\frac{\\frac{[\\text{HA}]}{[\\text{HA}]}}{\\frac{[\\text{HA}]}{[\\text{HA}]} + \\frac{[\\text{A}^{-}]}{[\\text{HA}]}} = \\frac{1}{1 + \\frac{[\\text{A}^{-}]}{[\\text{HA}]}}\n$$\nSubstituting the expression for the concentration ratio gives the final closed-form expression for the fraction protonated, $f$, in terms of $\\mathrm{pH}$ and $\\mathrm{p}K_\\text{a}$:\n$$\nf = \\frac{1}{1 + 10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})}}\n$$\nThe final task is to evaluate $f$ for an N-terminal amino group with a $\\mathrm{p}K_\\text{a}$ of $8.00$ in a solution buffered at a $\\mathrm{pH}$ of $7.00$. The temperature of $25\\,^{\\circ}\\mathrm{C}$ is a standard condition for reporting $\\mathrm{p}K_\\text{a}$ values and is consistent with the problem setup, but does not enter the final calculation.\nSubstituting the given values into the expression for $f$:\n$$\nf = \\frac{1}{1 + 10^{(7.00 - 8.00)}} = \\frac{1}{1 + 10^{(-1.00)}}\n$$\nCalculating the value of $10^{-1.00}$:\n$$\n10^{-1.00} = 0.1\n$$\nThus, the fraction protonated is:\n$$\nf = \\frac{1}{1 + 0.1} = \\frac{1}{1.1}\n$$\nPerforming the division gives:\n$$\nf \\approx 0.90909090...\n$$\nRounding this result to five significant figures as requested yields:\n$$\nf = 0.90909\n$$\nThis result indicates that at a $\\mathrm{pH}$ one unit below the $\\mathrm{p}K_\\text{a}$, the group is approximately $90.9\\%$ protonated.",
            "answer": "$$\\boxed{0.90909}$$"
        },
        {
            "introduction": "With the foundational equation in hand, we can now apply it to a practical and common task in computational biology: determining the net charge of a peptide at a specific physiological $\\mathrm{pH}$. Accurately assigning protonation states is a critical step in preparing molecular systems for simulation, as it governs electrostatic interactions that dictate structure and function. This exercise challenges you to integrate the properties of multiple independent titratable groups within a tripeptide to compute its overall charge, a skill essential for building realistic biomolecular models .",
            "id": "3836012",
            "problem": "In computational chemical biology, modeling electrostatic interactions often requires estimating the average net charge of peptides at a specified hydrogen ion concentration. Consider the tripeptide Lys-Gly-Glu in aqueous solution at $\\mathrm{pH} = 7.0$. Treat each titratable site as an independent monoprotic acid or base and assume no inter-site coupling or significant activity coefficient deviations. The titratable groups and the well-tested site-specific values to use are: the N-terminal $\\alpha$-amino group (on Lys) with $\\mathrm{p}K_\\text{a} = 8.0$, the Lys $\\varepsilon$-amino side chain with $\\mathrm{p}K_\\text{a} = 10.5$, the Glu $\\gamma$-carboxyl side chain with $\\mathrm{p}K_\\text{a} = 4.1$, and the C-terminal $\\alpha$-carboxyl group with $\\mathrm{p}K_\\text{a} = 3.6$. Starting from the law of mass action for acid-base equilibria and the Henderson–Hasselbalch (HH) equation, derive the fractional protonation or deprotonation appropriate for each site and compute the expected net charge of the peptide at $\\mathrm{pH} = 7.0$ by summing the average charges contributed by all titratable groups. Report the final net charge as a pure number, rounded to four significant figures.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information to compute a unique solution. It is a standard problem in biochemistry and computational biology. Therefore, the problem is valid, and I will proceed with its solution.\n\nThe objective is to calculate the expected net charge of the tripeptide Lys-Gly-Glu at a $\\mathrm{pH}$ of $7.0$. The net charge, $Q_\\text{net}$, is the sum of the average charges of all its titratable functional groups. The problem specifies four such groups and provides their site-specific $\\mathrm{p}K_\\text{a}$ values. We will model each group as an independent titratable site.\n\nThe average charge of a titratable group depends on its fractional protonation, which can be determined using the Henderson-Hasselbalch (HH) equation. The HH equation relates $\\mathrm{pH}$, $\\mathrm{p}K_\\text{a}$, and the ratio of the concentrations of the deprotonated (base) form, $[\\text{A}^-]$, to the protonated (acid) form, $[\\text{HA}]$:\n$$ \\mathrm{pH} = \\mathrm{p}K_\\text{a} + \\log_{10}\\left(\\frac{[\\text{A}^-]}{[\\text{HA}]}\\right) $$\nFrom this, we can express the ratio of the base to the acid form as:\n$$ \\frac{[\\text{A}^-]}{[\\text{HA}]} = 10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})} $$\n\nWe must consider two types of titratable groups: acidic groups (carboxyls) and basic groups (amines).\n\nFor an acidic group, represented by the equilibrium $R\\text{-COOH} \\rightleftharpoons R\\text{-COO}^- + \\text{H}^+$, the protonated form ($R\\text{-COOH}$) has a charge of $0$, and the deprotonated form ($R\\text{-COO}^-$) has a charge of $-1$. The average charge, $q_\\text{acidic}$, is the charge of the deprotonated form multiplied by its fractional abundance, $f_\\text{deprot}$:\n$$ q_\\text{acidic} = (-1) \\times f_\\text{deprot} = (-1) \\times \\frac{[R\\text{-COO}^-]}{[R\\text{-COOH}] + [R\\text{-COO}^-]} $$\nBy dividing the numerator and denominator by $[R\\text{-COOH}]$, and using the HH ratio:\n$$ q_\\text{acidic} = -\\frac{\\frac{[R\\text{-COO}^-]}{[R\\text{-COOH}]}}{1 + \\frac{[R\\text{-COO}^-]}{[R\\text{-COOH}]}} = -\\frac{10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})}}{1 + 10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})}} $$\nAn equivalent and computationally stable form is:\n$$ q_\\text{acidic} = -\\frac{1}{1 + 10^{(\\mathrm{p}K_\\text{a} - \\mathrm{pH})}} $$\n\nFor a basic group, represented by the equilibrium of its conjugate acid $R\\text{-NH}_3^+ \\rightleftharpoons R\\text{-NH}_2 + \\text{H}^+$, the protonated form ($R\\text{-NH}_3^+$) has a charge of $+1$, and the deprotonated form ($R\\text{-NH}_2$) has a charge of $0$. The average charge, $q_\\text{basic}$, is the charge of the protonated form multiplied by its fractional abundance, $f_\\text{prot}$:\n$$ q_\\text{basic} = (+1) \\times f_\\text{prot} = (+1) \\times \\frac{[R\\text{-NH}_3^+]}{[R\\text{-NH}_2] + [R\\text{-NH}_3^+]} $$\nBy dividing the numerator and denominator by $[R\\text{-NH}_3^+]$:\n$$ q_\\text{basic} = \\frac{1}{\\frac{[R\\text{-NH}_2]}{[R\\text{-NH}_3^+]} + 1} = \\frac{1}{10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})} + 1} $$\n\nThe tripeptide Lys-Gly-Glu has four titratable groups:\n1. The N-terminal $\\alpha$-amino group of Lysine (a basic group) with $\\mathrm{p}K_\\text{a} = 8.0$.\n2. The side-chain $\\varepsilon$-amino group of Lysine (a basic group) with $\\mathrm{p}K_\\text{a} = 10.5$.\n3. The side-chain $\\gamma$-carboxyl group of Glutamic acid (an acidic group) with $\\mathrm{p}K_\\text{a} = 4.1$.\n4. The C-terminal $\\alpha$-carboxyl group of Glutamic acid (an acidic group) with $\\mathrm{p}K_\\text{a} = 3.6$.\n\nWe now apply the derived formulas to calculate the average charge of each group at $\\mathrm{pH} = 7.0$.\n\n1. N-terminal $\\alpha$-amino group ($q_1$):\nThis is a basic group with $\\mathrm{p}K_\\text{a} = 8.0$.\n$$ q_1 = \\frac{1}{1 + 10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})}} = \\frac{1}{1 + 10^{(7.0 - 8.0)}} = \\frac{1}{1 + 10^{-1.0}} = \\frac{1}{1 + 0.1} = \\frac{1}{1.1} $$\n$$ q_1 \\approx +0.909091 $$\n\n2. Lysine $\\varepsilon$-amino side chain ($q_2$):\nThis is a basic group with $\\mathrm{p}K_\\text{a} = 10.5$.\n$$ q_2 = \\frac{1}{1 + 10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})}} = \\frac{1}{1 + 10^{(7.0 - 10.5)}} = \\frac{1}{1 + 10^{-3.5}} $$\n$$ q_2 \\approx +0.999684 $$\n\n3. Glutamate $\\gamma$-carboxyl side chain ($q_3$):\nThis is an acidic group with $\\mathrm{p}K_\\text{a} = 4.1$.\n$$ q_3 = -\\frac{1}{1 + 10^{(\\mathrm{p}K_\\text{a} - \\mathrm{pH})}} = -\\frac{1}{1 + 10^{(4.1 - 7.0)}} = -\\frac{1}{1 + 10^{-2.9}} $$\n$$ q_3 \\approx -0.998743 $$\n\n4. C-terminal $\\alpha$-carboxyl group ($q_4$):\nThis is an acidic group with $\\mathrm{p}K_\\text{a} = 3.6$.\n$$ q_4 = -\\frac{1}{1 + 10^{(\\mathrm{p}K_\\text{a} - \\mathrm{pH})}} = -\\frac{1}{1 + 10^{(3.6 - 7.0)}} = -\\frac{1}{1 + 10^{-3.4}} $$\n$$ q_4 \\approx -0.999602 $$\n\nThe total net charge $Q_\\text{net}$ is the sum of these individual average charges:\n$$ Q_\\text{net} = q_1 + q_2 + q_3 + q_4 $$\n$$ Q_\\text{net} \\approx 0.909091 + 0.999684 - 0.998743 - 0.999602 $$\n$$ Q_\\text{net} \\approx -0.089570 $$\n\nThe problem requires the answer to be rounded to four significant figures. The first non-zero digit is $8$ in the hundredths place. Counting four significant figures gives $-0.08957$.\n$$ Q_\\text{net} \\approx -0.08957 $$\nThis is the expected net charge of the tripeptide Lys-Gly-Glu at $\\mathrm{pH} = 7.0$ under the given assumptions.",
            "answer": "$$ \\boxed{-0.08957} $$"
        },
        {
            "introduction": "Our first two practices focused on *using* known $\\mathrm{p}K_\\text{a}$ values to predict charge. But where do these values come from, especially for residues in complex protein environments? This advanced practice bridges theory and modern computational methods by asking you to analyze data from a simulated constant pH molecular dynamics (MD) titration. By fitting the Henderson–Hasselbalch model to simulation output, you will learn how to extract an effective $\\mathrm{p}K_\\text{a}$ for a residue, a key parameter that reflects the influence of the local microenvironment on its acid-base properties .",
            "id": "3836002",
            "problem": "A constant pH Molecular Dynamics (MD) simulation of a histidine side chain in a peptide yields a titration curve, i.e., a series of sample points $(\\mathrm{pH}_i, \\theta_i)$, where $\\theta_i$ denotes the fraction of the protonated species at $\\mathrm{pH}_i$. From first principles of acid-base equilibria, the acid dissociation constant $K_\\text{a}$ is defined by the law of mass action, and $\\mathrm{p}K_\\text{a}$ is defined by $\\mathrm{p}K_\\text{a} = -\\log_{10}(K_\\text{a})$. The Henderson–Hasselbalch (HH) relation connects $\\mathrm{p}K_\\text{a}$ and protonation fractions, and a Hill-like generalization introduces a phenomenological cooperativity parameter. Your task is to derive a fitting model for $\\theta(\\mathrm{pH})$ based on these principles and implement a program that estimates $\\mathrm{p}K_\\text{a}$ for histidine in a peptide from the provided titration curves.\n\nStarting from the law of mass action, analytically derive a two-parameter model that relates the fraction protonated $\\theta$ to $\\mathrm{pH}$ in terms of unknown $\\mathrm{p}K_\\text{a}$ and, when applicable, a cooperativity parameter $n_{\\mathrm{H}}$. Then, design an algorithm that, given a set of $(\\mathrm{pH}_i, \\theta_i)$ values, computes:\n- An estimated $\\mathrm{p}K_\\text{a}$ by fitting the Henderson–Hasselbalch model (with fixed $n_{\\mathrm{H}} = 1$).\n- An estimated $\\mathrm{p}K_\\text{a}$ and an estimated $n_{\\mathrm{H}}$ by fitting the Hill-like generalized model (with $n_{\\mathrm{H}}$ free).\n\nYou must use nonlinear least squares to fit your derived models to the data by minimizing the sum of squared residuals between observed $\\theta_i$ and predicted values. Because $\\mathrm{pH}$ and $\\mathrm{p}K_\\text{a}$ are dimensionless quantities, report all numeric results without physical units. The final output must be a single line containing all estimated parameters for the provided test suite in a flat list, in the following order: for each test case, output the Henderson–Hasselbalch $\\mathrm{p}K_\\text{a}$, the Hill-like $\\mathrm{p}K_\\text{a}$, and the Hill-like $n_{\\mathrm{H}}$, all rounded to three decimal places. The output should be a single line of text formatted as a comma-separated list enclosed in square brackets, for example, $[\\dots]$.\n\nUse the following test suite of titration curves, given as $\\mathrm{pH}$ sample points and corresponding observed protonation fractions $\\theta$:\n\n- Test case $1$ (canonical histidine-like behavior, wide range):\n  - $\\mathrm{pH}$ points: $[3.0, 4.0, 5.0, 5.5, 6.0, 6.5, 7.0, 8.0, 9.0]$\n  - $\\theta$ points: $[0.999001, 0.990099, 0.909091, 0.759746, 0.500000, 0.240253, 0.090909, 0.009901, 0.000999]$\n- Test case $2$ (cooperative-like steepness, shifted midpoint):\n  - $\\mathrm{pH}$ points: $[4.5, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0]$\n  - $\\theta$ points: $[0.997488, 0.952269, 0.816271, 0.500000, 0.182993, 0.047744, 0.011095]$\n- Test case $3$ (sparse points near transition):\n  - $\\mathrm{pH}$ points: $[6.0, 6.1, 6.2, 6.3, 6.4]$\n  - $\\theta$ points: $[0.613813, 0.557521, 0.500000, 0.442479, 0.386186]$\n- Test case $4$ (midpoint outside much of sampling range):\n  - $\\mathrm{pH}$ points: $[5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0]$\n  - $\\theta$ points: $[0.999900, 0.999001, 0.990099, 0.909091, 0.500000, 0.090909, 0.009901]$\n\nAlgorithmic and numerical requirements:\n- Derive the model equations from the law of mass action and the definition of $\\mathrm{p}K_\\text{a}$.\n- Implement nonlinear least squares fitting for both the Henderson–Hasselbalch model and the Hill-like model. Constrain parameters to physically reasonable domains, for example, $\\mathrm{p}K_\\text{a} \\in [-2, 14]$ and $n_{\\mathrm{H}} \\in [0.1, 5.0]$.\n- Use robust initial guesses that do not assume prior knowledge of the true parameters and that can handle data sets which may be nearly saturated (e.g., $\\theta \\approx 0$ or $\\theta \\approx 1$ over much of the range). If you use any transformation, justify it from the derived model.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output three floating-point numbers: the Henderson–Hasselbalch $\\mathrm{p}K_\\text{a}$, the Hill-like $\\mathrm{p}K_\\text{a}$, and the Hill-like $n_{\\mathrm{H}}$, all rounded to three decimal places.\n\nDesign for coverage:\n- The test suite includes a general wide-range case (test case $1$), a cooperative-like steep case (test case $2$), a boundary near-transition case with sparse points (test case $3$), and a case where the midpoint is partially outside the sampling range (test case $4$). This ensures your algorithm handles varied steepness, sampling density, and saturation behavior.\n\nYour final program must be self-contained, require no user input, and strictly follow the specified output format.",
            "solution": "The problem requires the derivation of a mathematical model for a titration curve and the implementation of a numerical fitting procedure to estimate the parameters $\\mathrm{p}K_\\text{a}$ and a cooperativity coefficient $n_{\\mathrm{H}}$ from experimental data. The derivation begins from the fundamental principles of acid-base chemical equilibrium.\n\n### Model Derivation\n\nLet us consider the reversible dissociation of a generic monoprotic acid, which for the histidine side chain (imidazole) can be represented as the equilibrium between its protonated form ($\\text{HisH}^+$) and its deprotonated form ($\\text{His}$):\n$$\n\\text{HisH}^+ \\rightleftharpoons \\text{His} + \\text{H}^+\n$$\nAccording to the law of mass action, the acid dissociation constant, $K_\\text{a}$, is defined as:\n$$\nK_\\text{a} = \\frac{[\\text{His}][\\text{H}^+]}{[\\text{HisH}^+]}\n$$\nwhere $[\\cdot]$ denotes the molar concentration of a species. The problem defines $\\theta$ as the fraction of the protonated species. This is expressed as the ratio of the concentration of the protonated form to the total concentration of the species:\n$$\n\\theta = \\frac{[\\text{HisH}^+]}{[\\text{His}]_{\\text{total}}} = \\frac{[\\text{HisH}^+]}{[\\text{HisH}^+] + [\\text{His}]}\n$$\nTo express $\\theta$ as a function of $[\\text{H}^+]$ and $K_\\text{a}$, we first rearrange the $K_\\text{a}$ expression to find $[\\text{His}]$:\n$$\n[\\text{His}] = K_\\text{a} \\frac{[\\text{HisH}^+]}{[\\text{H}^+]}\n$$\nSubstituting this into the equation for $\\theta$:\n$$\n\\theta = \\frac{[\\text{HisH}^+]}{[\\text{HisH}^+] + K_\\text{a} \\frac{[\\text{HisH}^+]}{[\\text{H}^+]}}\n$$\nAssuming a non-zero concentration of the protonated species, we can divide the numerator and denominator by $[\\text{HisH}^+]$:\n$$\n\\theta = \\frac{1}{1 + \\frac{K_\\text{a}}{[\\text{H}^+]}} = \\frac{[\\text{H}^+]}{[\\text{H}^+] + K_\\text{a}}\n$$\nBy definition, $\\mathrm{pH} = -\\log_{10}([\\text{H}^+])$ and $\\mathrm{p}K_\\text{a} = -\\log_{10}(K_\\text{a})$, which implies $[\\text{H}^+] = 10^{-\\mathrm{pH}}$ and $K_\\text{a} = 10^{-\\mathrm{p}K_\\text{a}}$. Substituting these logarithmic forms into the equation for $\\theta$ yields the Henderson-Hasselbalch model for the protonation fraction:\n$$\n\\theta(\\mathrm{pH}, \\mathrm{p}K_\\text{a}) = \\frac{10^{-\\mathrm{pH}}}{10^{-\\mathrm{pH}} + 10^{-\\mathrm{p}K_\\text{a}}}\n$$\nMultiplying the numerator and denominator by $10^{\\mathrm{pH}}$ gives a more convenient form:\n$$\n\\theta(\\mathrm{pH}, \\mathrm{p}K_\\text{a}) = \\frac{1}{1 + 10^{\\mathrm{pH}} \\cdot 10^{-\\mathrm{p}K_\\text{a}}} = \\frac{1}{1 + 10^{(\\mathrm{pH} - \\mathrm{p}K_\\text{a})}}\n$$\nThis equation represents the standard, non-cooperative titration model, which corresponds to the case where the Hill coefficient $n_{\\mathrm{H}} = 1$.\n\nThe problem asks for a generalized two-parameter model including a cooperativity parameter $n_{\\mathrm{H}}$. This is achieved by generalizing the derived model, which is mathematically equivalent to the Hill equation for ligand binding. The term $(\\mathrm{pH} - \\mathrm{p}K_\\text{a})$ in the exponent is multiplied by the Hill coefficient $n_{\\mathrm{H}}$:\n$$\n\\theta(\\mathrm{pH}, \\mathrm{p}K_\\text{a}, n_{\\mathrm{H}}) = \\frac{1}{1 + 10^{n_{\\mathrm{H}}(\\mathrm{pH} - \\mathrm{p}K_\\text{a})}}\n$$\nThis is the general fitting model. When $n_{\\mathrm{H}}=1$, it reduces to the standard Henderson-Hasselbalch model. When $n_{\\mathrm{H}}>1$, the transition from the protonated to the deprotonated state is steeper (cooperative), and when $n_{\\mathrm{H}}<1$, it is broader (anti-cooperative).\n\n### Algorithmic Design for Parameter Fitting\n\nThe goal is to estimate the parameters ($\\mathrm{p}K_\\text{a}$ for the first model, and both $\\mathrm{p}K_\\text{a}$ and $n_{\\mathrm{H}}$ for the second) by fitting the derived models to the provided $(\\mathrm{pH}_i, \\theta_i)$ data points. The method specified is nonlinear least squares, which involves minimizing the sum of squared residuals (SSR) between the observed data $\\theta_i^{\\text{obs}}$ and the values predicted by the model $\\theta(\\mathrm{pH}_i, \\text{params})$:\n$$\n\\mathrm{SSR}(\\text{params}) = \\sum_{i=1}^{N} \\left( \\theta_i^{\\text{obs}} - \\theta(\\mathrm{pH}_i, \\text{params}) \\right)^2\n$$\nThe `scipy.optimize.curve_fit` function is an appropriate tool for this task. It implements the Levenberg-Marquardt algorithm for nonlinear least squares optimization.\n\nThe implementation will proceed as follows for each test case:\n1.  **Define Model Functions**: Two Python functions will be defined, corresponding to the two models:\n    -   Henderson-Hasselbalch model: `hh_model(ph, pka)` which computes $\\theta$ using the formula with $n_{\\mathrm{H}}=1$.\n    -   Hill-like model: `hill_model(ph, pka, n_h)` which computes $\\theta$ using the general formula.\n\n2.  **Initial Guesses**: Robust initial parameter guesses are crucial for the convergence of the optimization algorithm.\n    -   For $\\mathrm{p}K_\\text{a}$, a logical initial guess is the $\\mathrm{pH}$ value at which the system is half-protonated, i.e., $\\theta=0.5$. We can estimate this by finding the $\\mathrm{pH}_i$ from the input data that corresponds to the $\\theta_i$ value closest to $0.5$.\n    -   For $n_{\\mathrm{H}}$, a neutral initial guess is $1.0$, which assumes no cooperativity.\n\n3.  **Parameter Constraints**: The problem specifies physical and numerical constraints on the parameters, which will be enforced using the `bounds` argument in `curve_fit`.\n    -   For the Henderson-Hasselbalch fit: $\\mathrm{p}K_\\text{a} \\in [-2, 14]$. The bounds tuple will be `([-2], [14])`.\n    -   For the Hill-like fit: $\\mathrm{p}K_\\text{a} \\in [-2, 14]$ and $n_{\\mathrm{H}} \\in [0.1, 5.0]$. The bounds tuple will be `([-2, 0.1], [14, 5.0])`.\n\n4.  **Fitting Procedure**: For each test case's data:\n    -   First, `curve_fit` will be called with the `hh_model` function, the data, the initial guess for $\\mathrm{p}K_\\text{a}$, and the corresponding bounds. The optimized $\\mathrm{p}K_\\text{a}$ will be extracted.\n    -   Second, `curve_fit` will be called with the `hill_model` function, the data, the initial guesses for $\\mathrm{p}K_\\text{a}$ and $n_{\\mathrm{H}}$, and the two-parameter bounds. The optimized $\\mathrm{p}K_\\text{a}$ and $n_{\\mathrm{H}}$ will be extracted.\n\n5.  **Output Formatting**: The three resulting parameters (HH $\\mathrm{p}K_\\text{a}$, Hill $\\mathrm{p}K_\\text{a}$, Hill $n_{\\mathrm{H}}$) for each test case will be rounded to three decimal places and collected into a single list, which will then be formatted into the required string output. This process is repeated for all test cases provided in the suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting titration curves to estimate pKa and Hill coefficients.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"ph\": [3.0, 4.0, 5.0, 5.5, 6.0, 6.5, 7.0, 8.0, 9.0],\n            \"theta\": [0.999001, 0.990099, 0.909091, 0.759746, 0.500000, 0.240253, 0.090909, 0.009901, 0.000999]\n        },\n        {\n            \"ph\": [4.5, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0],\n            \"theta\": [0.997488, 0.952269, 0.816271, 0.500000, 0.182993, 0.047744, 0.011095]\n        },\n        {\n            \"ph\": [6.0, 6.1, 6.2, 6.3, 6.4],\n            \"theta\": [0.613813, 0.557521, 0.500000, 0.442479, 0.386186]\n        },\n        {\n            \"ph\": [5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0],\n            \"theta\": [0.999900, 0.999001, 0.990099, 0.909091, 0.500000, 0.090909, 0.009901]\n        }\n    ]\n\n    # Model definitions\n    def hh_model(ph, pka):\n        \"\"\"Henderson-Hasselbalch model (Hill coefficient n_H = 1).\"\"\"\n        return 1.0 / (1.0 + 10**(ph - pka))\n\n    def hill_model(ph, pka, n_h):\n        \"\"\"Generalized Hill-like model.\"\"\"\n        return 1.0 / (1.0 + 10**(n_h * (ph - pka)))\n\n    results = []\n\n    for case in test_cases:\n        ph_data = np.array(case[\"ph\"])\n        theta_data = np.array(case[\"theta\"])\n\n        # Robust initial guess for pKa: pH where theta is closest to 0.5\n        idx_pka_guess = np.argmin(np.abs(theta_data - 0.5))\n        pka_guess = ph_data[idx_pka_guess]\n\n        # --- Fit 1: Henderson-Hasselbalch model (n_H fixed to 1) ---\n        p0_hh = [pka_guess]\n        bounds_hh = ([-2.0], [14.0])\n        \n        try:\n            params_hh, _ = curve_fit(hh_model, ph_data, theta_data, p0=p0_hh, bounds=bounds_hh)\n            pka_hh = params_hh[0]\n        except RuntimeError:\n            pka_hh = np.nan # Failed fit\n\n        # --- Fit 2: Hill-like model (n_H is a free parameter) ---\n        p0_hill = [pka_guess, 1.0] # Initial guess for n_H is 1.0\n        bounds_hill = ([-2.0, 0.1], [14.0, 5.0])\n\n        try:\n            params_hill, _ = curve_fit(hill_model, ph_data, theta_data, p0=p0_hill, bounds=bounds_hill)\n            pka_hill, n_h_hill = params_hill\n        except RuntimeError:\n            pka_hill, n_h_hill = np.nan, np.nan # Failed fit\n\n        results.append(f\"{pka_hh:.3f}\")\n        results.append(f\"{pka_hill:.3f}\")\n        results.append(f\"{n_h_hill:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}