{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing any chemical process on a potential energy surface (PES) is to identify its key features: the stable states and the barriers between them. This exercise  provides foundational practice in this task by asking you to locate all critical points of a representative two-dimensional PES. By computing the gradient to find where the forces are zero and then analyzing the Hessian matrix at these points, you will learn to distinguish between energy minima (reactants, products) and the first-order saddle points that represent transition states.",
            "id": "3858756",
            "problem": "In computational chemical biology, reduced-dimensional potential energy surfaces are often used to analyze conformational subspaces of macromolecules. Consider a two-dimensional reduced potential energy surface in dimensionless form given by the function $V(x,y) = x^{4} + y^{2} - 2 x^{2}$, where $x$ models a soft torsional coordinate and $y$ models a small-amplitude orthogonal deformation.\n\nStarting from the core definitions that the gradient $\\nabla V$ is the vector of first partial derivatives of $V$ with respect to its coordinates and that the Hessian $H$ is the matrix of second partial derivatives of $V$, proceed as follows:\n- Compute the gradient $\\nabla V$ and the Hessian $H$.\n- Determine all critical points by solving $\\nabla V = \\mathbf{0}$.\n- For each critical point, compute the eigenvalues of the Hessian $H$ at that point and use them to classify the critical point as a local minimum, a local maximum, or an index-$k$ saddle, justifying your classification by the definiteness of $H$.\n- Identify the global minimum among the critical points by comparing the values of $V$ at those points.\n\nProvide as your final answer the exact value of $V$ at the global minimum as a single real number. Do not round. No units are required since $V$ is dimensionless in this reduced model.",
            "solution": "The problem asks for analysis of a potential energy surface defined by $V(x,y) = x^{4} + y^{2} - 2 x^{2}$ using first and second derivatives.\n\nBy definition, the gradient $\\nabla V$ is the vector of first partial derivatives of $V$,\n$$\n\\nabla V(x,y) = \\begin{pmatrix} \\frac{\\partial V}{\\partial x} \\\\[4pt] \\frac{\\partial V}{\\partial y} \\end{pmatrix}.\n$$\nWe compute\n$$\n\\frac{\\partial V}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(x^{4} + y^{2} - 2 x^{2}\\right) = 4 x^{3} - 4 x = 4 x \\left(x^{2} - 1\\right),\n$$\n$$\n\\frac{\\partial V}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(x^{4} + y^{2} - 2 x^{2}\\right) = 2 y.\n$$\nTherefore,\n$$\n\\nabla V(x,y) = \\begin{pmatrix} 4 x \\left(x^{2} - 1\\right) \\\\[4pt] 2 y \\end{pmatrix}.\n$$\n\nBy definition, the Hessian $H$ is the matrix of second partial derivatives,\n$$\nH(x,y) = \\begin{pmatrix}\n\\frac{\\partial^{2} V}{\\partial x^{2}}  \\frac{\\partial^{2} V}{\\partial x \\partial y} \\\\\n\\frac{\\partial^{2} V}{\\partial y \\partial x}  \\frac{\\partial^{2} V}{\\partial y^{2}}\n\\end{pmatrix}.\n$$\nWe compute\n$$\n\\frac{\\partial^{2} V}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}\\left(4 x^{3} - 4 x\\right) = 12 x^{2} - 4,\n$$\n$$\n\\frac{\\partial^{2} V}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}\\left(2 y\\right) = 2,\n$$\nand the mixed partial derivatives\n$$\n\\frac{\\partial^{2} V}{\\partial x \\partial y} = \\frac{\\partial}{\\partial y}\\left(4 x^{3} - 4 x\\right) = 0, \\quad \\frac{\\partial^{2} V}{\\partial y \\partial x} = \\frac{\\partial}{\\partial x}\\left(2 y\\right) = 0.\n$$\nThus,\n$$\nH(x,y) = \\begin{pmatrix}\n12 x^{2} - 4  0 \\\\\n0  2\n\\end{pmatrix}.\n$$\n\nCritical points are those $(x,y)$ for which $\\nabla V(x,y) = \\mathbf{0}$. This gives the system\n$$\n4 x \\left(x^{2} - 1\\right) = 0, \\quad 2 y = 0.\n$$\nThe second equation yields $y = 0$. The first equation yields $x = 0$ or $x^{2} = 1$, i.e., $x = \\pm 1$. Therefore, the critical points are\n$$\n(x,y) \\in \\{(0,0), (1,0), (-1,0)\\}.\n$$\n\nTo classify each critical point, we evaluate the Hessian at each point and inspect its eigenvalues. Because $H(x,y)$ is diagonal, its eigenvalues are simply the diagonal entries, $\\lambda_{1}(x) = 12 x^{2} - 4$ and $\\lambda_{2} = 2$.\n\n- At $(0,0)$: we have $x = 0$, so\n$$\n\\lambda_{1} = 12 \\cdot 0^{2} - 4 = -4, \\quad \\lambda_{2} = 2.\n$$\nOne eigenvalue is negative and one is positive, so $H$ is indefinite. This classifies $(0,0)$ as an index-$1$ saddle point (one negative curvature direction and one positive curvature direction).\n\n- At $(1,0)$: we have $x = 1$, so\n$$\n\\lambda_{1} = 12 \\cdot 1^{2} - 4 = 8, \\quad \\lambda_{2} = 2.\n$$\nBoth eigenvalues are positive, so $H$ is positive definite. This classifies $(1,0)$ as a strict local minimum.\n\n- At $(-1,0)$: we have $x = -1$, so\n$$\n\\lambda_{1} = 12 \\cdot (-1)^{2} - 4 = 8, \\quad \\lambda_{2} = 2.\n$$\nAgain both eigenvalues are positive, so $H$ is positive definite. This classifies $(-1,0)$ as a strict local minimum.\n\nTo determine the global minimum among the critical points, evaluate $V$ at each:\n$$\nV(0,0) = 0^{4} + 0^{2} - 2 \\cdot 0^{2} = 0,\n$$\n$$\nV(1,0) = 1^{4} + 0^{2} - 2 \\cdot 1^{2} = 1 - 2 = -1,\n$$\n$$\nV(-1,0) = (-1)^{4} + 0^{2} - 2 \\cdot (-1)^{2} = 1 - 2 = -1.\n$$\nThe smallest value among these is $-1$, achieved at $(1,0)$ and $(-1,0)$. Therefore, the global minimum value of $V$ is $-1$.\n\nThe final required answer is the exact value of $V$ at the global minimum, which is $-1$.",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "After locating a minimum on the PES, it is crucial to understand its physical significance within a quantum mechanical framework. A molecule does not rest statically at the bottom of a potential well; due to the uncertainty principle, it possesses a minimum vibrational energy known as the zero-point energy (ZPE). This practice  bridges classical and quantum descriptions by showing how the curvature of the PES at a minimum, captured by the eigenvalues of the mass-weighted Hessian, directly determines the molecule's vibrational frequencies and its ZPE.",
            "id": "3858747",
            "problem": "Consider a non-linear triatomic molecule (for example, a water molecule bound in an enzyme active site) whose nuclear configuration corresponds to a local minimum on the potential energy surface (PES). Within the Born–Oppenheimer approximation, treat the nuclei as moving on a PES defined by the electronic energy. Near the minimum, adopt the harmonic approximation and perform a normal-mode analysis in mass-weighted coordinates so that vibrational motions decouple into independent modes. Suppose the mass-weighted Hessian matrix (the matrix of second derivatives of the PES with respect to mass-weighted Cartesian displacements) has three strictly positive eigenvalues $\\{\\lambda_{1},\\lambda_{2},\\lambda_{3}\\}$ associated with the vibrational subspace, with all translational and rotational modes removed. The eigenvalues $\\lambda_{k}$ are given in units consistent with angular frequency squared, so that $\\lambda_{k}$ has units of $\\mathrm{s}^{-2}$.\n\nStarting from first principles appropriate to this setting, derive an expression for the zero-point energy of the triatomic molecule at this minimum in terms of $\\{\\lambda_{1},\\lambda_{2},\\lambda_{3}\\}$ and fundamental constants, and then evaluate it symbolically. Express the final energy in Joules. Provide your final answer as a single closed-form analytic expression. No numerical rounding is required.",
            "solution": "The problem asks for the zero-point energy of a non-linear triatomic molecule, treated within the Born-Oppenheimer and harmonic approximations. The derivation must start from first principles using the provided eigenvalues from a normal-mode analysis.\n\nFirst, we begin with the classical description of the molecule's nuclear motion. The potential energy, $V$, of the system is a function of the nuclear coordinates. For a configuration near a local minimum on the potential energy surface (PES), we can expand $V$ in a Taylor series around the equilibrium geometry. Let the displacement from the equilibrium coordinates be denoted by a set of generalized coordinates. For a system of $N$ atoms, there are $3N$ Cartesian displacement coordinates.\n\nIn the harmonic approximation, we truncate the Taylor series an expansion of the potential energy $V$ about the equilibrium geometry. At a minimum, the first derivatives of the potential (the forces) are zero. Setting the potential at the minimum to be the zero of energy, we have:\n$V \\approx \\frac{1}{2} \\sum_{i,j=1}^{3N} F_{ij} \\xi_i \\xi_j$\nwhere $\\xi_i$ are the Cartesian displacement coordinates, and $F_{ij} = \\left(\\frac{\\partial^2 V}{\\partial \\xi_i \\partial \\xi_j}\\right)_0$ is the Hessian matrix of force constants evaluated at the equilibrium geometry.\n\nTo simplify the kinetic energy term, we introduce mass-weighted Cartesian coordinates, $q_i$, defined as $q_i = \\sqrt{m_k} \\xi_i$, where $m_k$ is the mass of the atom associated with the $i$-th displacement coordinate. The kinetic energy $T$ takes a simple diagonal form in these coordinates:\n$T = \\frac{1}{2} \\sum_{i=1}^{3N} \\dot{q}_i^2$\n\nThe potential energy in mass-weighted coordinates becomes:\n$V = \\frac{1}{2} \\sum_{i,j=1}^{3N} H_{ij} q_i q_j$\nwhere $H_{ij} = \\frac{F_{ij}}{\\sqrt{m_i m_j}}$ are the elements of the mass-weighted Hessian matrix $\\mathbf{H}$. The problem states that the eigenvalues of this matrix for the vibrational subspace are $\\{\\lambda_1, \\lambda_2, \\lambda_3\\}$.\n\nThe classical equations of motion, derived from the Lagrangian $L = T-V$, are a set of coupled second-order differential equations. To decouple them, we perform a normal-mode analysis. This involves finding an orthogonal transformation from the mass-weighted coordinates $q_i$ to a new set of coordinates, the normal coordinates $Q_k$, which diagonalizes the Hessian matrix $\\mathbf{H}$. In this basis of normal coordinates, the potential and kinetic energies become sums over uncoupled terms:\n$T = \\frac{1}{2} \\sum_{k=1}^{3N-6} \\dot{Q}_k^2$\n$V = \\frac{1}{2} \\sum_{k=1}^{3N-6} \\lambda_k Q_k^2$\nFor a non-linear triatomic molecule, $N=3$, so there are $3N-6 = 3(3)-6 = 3$ vibrational modes. The problem correctly provides three eigenvalues $\\{\\lambda_1, \\lambda_2, \\lambda_3\\}$ for this vibrational subspace, after having separated out the 3 translational and 3 rotational modes.\n\nThe total classical Hamiltonian for the vibrational motion is the sum of the kinetic and potential energies:\n$H_{\\text{vib}} = T + V = \\sum_{k=1}^{3} \\left( \\frac{1}{2}\\dot{Q}_k^2 + \\frac{1}{2}\\lambda_k Q_k^2 \\right)$\nThis is the Hamiltonian of three independent simple harmonic oscillators. The classical equation of motion for each normal mode $k$ is $\\ddot{Q}_k + \\lambda_k Q_k = 0$. This describes simple harmonic motion with an angular frequency $\\omega_k$ given by $\\omega_k^2 = \\lambda_k$, or $\\omega_k = \\sqrt{\\lambda_k}$.\n\nWe now move to the quantum mechanical description. The system is described by a quantum Hamiltonian operator $\\hat{H}_{\\text{vib}}$, which is a sum of Hamiltonians for each independent quantum harmonic oscillator:\n$\\hat{H}_{\\text{vib}} = \\sum_{k=1}^{3} \\hat{H}_k = \\sum_{k=1}^{3} \\left( -\\frac{\\hbar^2}{2} \\frac{\\partial^2}{\\partial Q_k^2} + \\frac{1}{2}\\lambda_k Q_k^2 \\right)$\nwhere $\\hbar$ is the reduced Planck constant. The energy eigenvalues for a single quantum harmonic oscillator with angular frequency $\\omega_k$ are given by:\n$E_{n_k} = \\hbar \\omega_k \\left(n_k + \\frac{1}{2}\\right)$\nwhere $n_k \\in \\{0, 1, 2, \\dots\\}$ is the vibrational quantum number for mode $k$.\n\nThe total vibrational energy of the molecule is the sum of the energies of the individual modes:\n$E_{\\text{vib}} = \\sum_{k=1}^{3} E_{n_k} = \\sum_{k=1}^{3} \\hbar \\omega_k \\left(n_k + \\frac{1}{2}\\right)$\n\nThe zero-point energy ($E_{ZPE}$) is the minimum possible energy of the system, which corresponds to the vibrational ground state where all oscillators are in their lowest energy level, i.e., $n_k=0$ for all $k=1, 2, 3$.\n$E_{ZPE} = \\sum_{k=1}^{3} \\hbar \\omega_k \\left(0 + \\frac{1}{2}\\right) = \\frac{1}{2} \\sum_{k=1}^{3} \\hbar \\omega_k$\n\nSubstituting the relationship $\\omega_k = \\sqrt{\\lambda_k}$ into this expression, we obtain the zero-point energy in terms of the given eigenvalues of the mass-weighted Hessian matrix:\n$E_{ZPE} = \\frac{1}{2} \\sum_{k=1}^{3} \\hbar \\sqrt{\\lambda_k}$\n\nThis can be written explicitly as a single closed-form expression:\n$E_{ZPE} = \\frac{\\hbar}{2} \\left( \\sqrt{\\lambda_1} + \\sqrt{\\lambda_2} + \\sqrt{\\lambda_3} \\right)$\n\nThe problem specifies that $\\lambda_k$ has units of $\\mathrm{s}^{-2}$, so $\\sqrt{\\lambda_k}$ has units of $\\mathrm{s}^{-1}$. The reduced Planck constant $\\hbar$ has units of Joules-seconds (J$\\cdot$s). Therefore, the resulting energy $E_{ZPE}$ has units of (J$\\cdot$s)($\\mathrm{s}^{-1}$) = J, which is consistent with the requirement that the final energy be in Joules.",
            "answer": "$$\\boxed{\\frac{\\hbar}{2} \\left(\\sqrt{\\lambda_1} + \\sqrt{\\lambda_2} + \\sqrt{\\lambda_3}\\right)}$$"
        },
        {
            "introduction": "Identifying a transition state is a major achievement, but its true value is realized only when we confirm which stable states it connects. The Intrinsic Reaction Coordinate (IRC) provides the theoretical answer, defining the minimum energy path that links a saddle point to its adjacent reactant and product minima. This advanced computational exercise  moves beyond static point analysis to path-finding, challenging you to implement a numerical integrator that follows the steepest descent path away from a saddle point, thereby tracing the complete reaction coordinate and validating the connections across the energy landscape.",
            "id": "3858758",
            "problem": "Consider the two-dimensional potential energy surface $V(x,y)$ defined by $V(x,y)=\\frac{1}{4}(x^2-1)^2+\\frac{1}{2}y^2+0.2\\,x\\,y$, where all quantities are expressed in dimensionless units. In computational chemical biology, the Intrinsic Reaction Coordinate (IRC) provides a minimum-energy path connecting reactant and product wells through a first-order saddle point. Starting from the saddle point at $(x,y)=(0,0)$, the IRC is obtained by following the steepest descent of the potential energy surface under a physically meaningful geometry defined by a mass metric. Your task is to derive, implement, and test an IRC integrator that:\n- Starts at the saddle point and displaces infinitesimally along the unique unstable mode (the negative curvature eigenvector), producing two branches corresponding to the two possible directions.\n- Advances each branch according to the steepest descent in mass-weighted coordinates with an arc-length parametrization.\n- Terminates when a stationary point (a well) is reached, and identifies which well was reached and whether the path connects the saddle to the reactant or product basin.\n\nBegin from the following fundamental base:\n- The potential energy surface $V(x,y)$ is differentiable. The gradient is $\\nabla V(x,y) = \\left(\\frac{\\partial V}{\\partial x}, \\frac{\\partial V}{\\partial y}\\right)$, and the Hessian is the matrix $H(x,y)$ with components $H_{ij}=\\frac{\\partial^2 V}{\\partial q_i \\partial q_j}$ for $q_1=x$, $q_2=y$.\n- A symmetric positive definite mass matrix $M$ defines the kinetic metric and the notion of arc length. The steepest descent direction of $V$ with respect to the mass metric is uniquely determined at each point by the combination of $M$ and $\\nabla V$.\n- A first-order saddle at $(x,y)=(0,0)$ has one negative and one positive curvature direction with respect to $M$. The initial IRC directions are given by the unstable mode eigenvector of the generalized eigenproblem $H(0,0)\\,v=\\lambda\\,M\\,v$ associated with the negative eigenvalue.\n\nDerive from these principles the appropriate ordinary differential equation for the IRC in mass-weighted coordinates and the correct initial conditions from the saddle. Then implement a numerical integrator that:\n- Uses an explicit fixed-step scheme for arc-length parametrization $s$ along the path such that the step size is a prescribed constant $ds$ in the mass metric.\n- Initializes two branches by displacements $\\pm\\varepsilon\\,v$ from $(0,0)$, where $v$ is the normalized unstable mode under the mass metric and $\\varepsilon0$ is small.\n- Advances each branch until a termination condition is met: the norm of the projected descent direction measured in the mass metric is below a tolerance $tol$, or a maximum number of steps $N_{\\max}$ is reached.\n- Identifies, for each branch, whether the endpoint lies within the basin of the reactant well (the minimum with $x0$) or the product well (the minimum with $x0$), and reports quantitative proximity to the target well.\n\nYou must implement a complete, runnable program that performs the IRC integration for the following test suite of parameter values. Each test case specifies the diagonal entries of the mass matrix $M=\\operatorname{diag}(m_x,m_y)$, the arc-length step size $ds$, the initial displacement magnitude $\\varepsilon$, the tolerance $tol$, and the maximum number of steps $N_{\\max}$:\n- Test Case $1$ (general case): $(m_x,m_y)=(1,1)$, $ds=0.02$, $\\varepsilon=10^{-3}$, $tol=10^{-8}$, $N_{\\max}=20000$.\n- Test Case $2$ (boundary case with smaller step and displacement): $(m_x,m_y)=(1,1)$, $ds=0.005$, $\\varepsilon=10^{-6}$, $tol=10^{-10}$, $N_{\\max}=40000$.\n- Test Case $3$ (edge case with anisotropic mass): $(m_x,m_y)=(1,4)$, $ds=0.02$, $\\varepsilon=5\\times 10^{-4}$, $tol=10^{-8}$, $N_{\\max}=30000$.\n\nYour program must:\n- Compute the generalized unstable eigenvector at the saddle using the Hessian $H(0,0)$ and the mass matrix $M$ for each test case.\n- Integrate two IRC branches using mass-weighted steepest descent with arc-length parameterization.\n- Identify the analytically determined reactant and product wells by solving $\\nabla V(x,y)=0$ and selecting the minima with $x0$ and $x0$ respectively.\n- For each test case, return the following eight-item list for the pair of branches in the order shown:\n  $[b_{+},b_{-},d_{+},d_{-},E_{+},E_{-},s_{+},s_{-}]$, where:\n  - $b_{+}$ is a boolean indicating whether the “$+$” branch connects the saddle to the product well (the minimum with $x0$).\n  - $b_{-}$ is a boolean indicating whether the “$-$” branch connects the saddle to the reactant well (the minimum with $x0$).\n  - $d_{+}$ is the Euclidean distance from the “$+$” branch endpoint to the product well minimum.\n  - $d_{-}$ is the Euclidean distance from the “$-$” branch endpoint to the reactant well minimum.\n  - $E_{+}$ is the potential energy $V$ at the “$+$” branch endpoint.\n  - $E_{-}$ is the potential energy $V$ at the “$-$” branch endpoint.\n  - $s_{+}$ is the total arc length traveled along the “$+$” branch (i.e., $s_{+}=n_{+}\\,ds$, where $n_{+}$ is the number of steps taken).\n  - $s_{-}$ is the total arc length traveled along the “$-$” branch (i.e., $s_{-}=n_{-}\\,ds$, where $n_{-}$ is the number of steps taken).\n- Aggregate the three test-case results into a single line of output containing a comma-separated list of three bracketed lists. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[[...],[...],[...]]\".\n\nAll computations are in dimensionless units. Angles are not involved. The final output must strictly follow the specified format and contain only fundamental types (booleans, integers, floats, or lists of these), with no additional text.",
            "solution": "The user has provided a problem that is scientifically sound, well-posed, and contains all necessary information for a unique solution. The task is to compute the Intrinsic Reaction Coordinate (IRC) for a given two-dimensional potential energy surface, starting from a saddle point. This involves deriving the governing differential equation, determining the initial conditions from an eigenvalue problem, implementing a numerical integrator, and analyzing the resulting paths. The problem is valid, and a detailed solution follows.\n\n### I. Mathematical Formulation\n\nThe core of the problem lies in formulating and solving the equation of motion for the IRC. Let the system's configuration be described by the coordinate vector $\\mathbf{q} = (x, y)^T$.\n\n**1. Potential Energy Surface and its Derivatives**\nThe potential energy surface (PES) is given by:\n$$ V(x,y) = \\frac{1}{4}(x^2-1)^2 + \\frac{1}{2}y^2 + 0.2xy $$\nThe force on the system is the negative gradient of the potential, $\\mathbf{F} = -\\nabla V$. The gradient vector, denoted $\\mathbf{g}$, is:\n$$ \\mathbf{g}(\\mathbf{q}) = \\nabla V(\\mathbf{q}) = \\begin{pmatrix} \\frac{\\partial V}{\\partial x} \\\\ \\frac{\\partial V}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} x(x^2-1) + 0.2y \\\\ y + 0.2x \\end{pmatrix} $$\nThe local curvature of the PES is described by the Hessian matrix, $H$:\n$$ H(\\mathbf{q}) = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2}  \\frac{\\partial^2 V}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 V}{\\partial y \\partial x}  \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix} = \\begin{pmatrix} 3x^2-1  0.2 \\\\ 0.2  1 \\end{pmatrix} $$\n\n**2. Stationary Points**\nStationary points are found where the gradient is zero, $\\mathbf{g}(\\mathbf{q}) = \\mathbf{0}$.\nFrom the second component, $y + 0.2x = 0$, we have $y = -0.2x$. Substituting this into the first component:\n$x(x^2-1) + 0.2(-0.2x) = 0 \\implies x(x^2 - 1 - 0.04) = 0 \\implies x(x^2 - 1.04) = 0$.\nThe solutions are $x=0$, $x=\\sqrt{1.04}$, and $x=-\\sqrt{1.04}$.\n\n*   For $x=0$, $y=0$. The point $(0,0)$ is a stationary point. The Hessian at this point is $H(0,0) = \\begin{pmatrix} -1  0.2 \\\\ 0.2  1 \\end{pmatrix}$. Its eigenvalues are $\\lambda = \\pm\\sqrt{1.04}$, one positive and one negative, confirming it is a first-order saddle point.\n*   For $x^2=1.04$, the Hessian is $H = \\begin{pmatrix} 3(1.04)-1  0.2 \\\\ 0.2  1 \\end{pmatrix} = \\begin{pmatrix} 2.12  0.2 \\\\ 0.2  1 \\end{pmatrix}$. Its determinant is $2.12 - 0.04 = 2.08  0$ and its trace is $3.12  0$, so both eigenvalues are positive, indicating these points are minima (wells).\n    *   **Product Well ($\\mathbf{q}_P$)**: The minimum with $x0$ is at $x_P = \\sqrt{1.04}$ and $y_P = -0.2\\sqrt{1.04}$.\n    *   **Reactant Well ($\\mathbf{q}_R$)**: The minimum with $x0$ is at $x_R = -\\sqrt{1.04}$ and $y_R = 0.2\\sqrt{1.04}$.\n\n**3. The Intrinsic Reaction Coordinate (IRC) Equation**\nThe IRC is the path of steepest descent in mass-weighted coordinates, parametrized by arc length $s$. The infinitesimal arc length is defined by the mass matrix $M$ as $ds^2 = d\\mathbf{q}^T M d\\mathbf{q}$. The direction of steepest descent is given by $-M^{-1}\\mathbf{g}$. To satisfy the arc-length parametrization, this direction vector must be normalized in the mass metric. The normalized path tangent $\\frac{d\\mathbf{q}}{ds}$ is:\n$$ \\frac{d\\mathbf{q}}{ds} = - \\frac{M^{-1}\\mathbf{g}}{\\|\\mathbf{v}\\|_M} $$\nwhere $\\mathbf{v} = M^{-1}\\mathbf{g}$ and the mass-metric norm is $\\|\\mathbf{v}\\|_M = \\sqrt{\\mathbf{v}^T M \\mathbf{v}}$.\nSubstituting $\\mathbf{v}$, we get:\n$$ \\|\\mathbf{v}\\|_M = \\sqrt{(M^{-1}\\mathbf{g})^T M (M^{-1}\\mathbf{g})} = \\sqrt{\\mathbf{g}^T M^{-T} M M^{-1} \\mathbf{g}} = \\sqrt{\\mathbf{g}^T M^{-1} \\mathbf{g}} $$\nsince $M$ is symmetric. Thus, the governing ODE for the IRC is:\n$$ \\frac{d\\mathbf{q}}{ds} = - \\frac{M^{-1}\\mathbf{g}(\\mathbf{q})}{\\sqrt{\\mathbf{g}(\\mathbf{q})^T M^{-1} \\mathbf{g}(\\mathbf{q})}} $$\n\n**4. Initial Conditions at the Saddle Point**\nThe IRC starts at the saddle point $\\mathbf{q}_s = (0,0)$ and follows the unique direction of negative curvature. This direction is given by the eigenvector $\\mathbf{v}_-$ corresponding to the negative eigenvalue $\\lambda_-$ of the generalized eigenvalue problem $H(\\mathbf{q}_s)\\mathbf{v} = \\lambda M \\mathbf{v}$. The eigenvector must be normalized with respect to the mass metric, i.e., $\\mathbf{v}_-^T M \\mathbf{v}_- = 1$. The two IRC branches start from initial points displaced infinitesimally along this eigenvector:\n$$ \\mathbf{q}_{init, \\pm} = \\mathbf{q}_s \\pm \\varepsilon \\mathbf{v}_- = \\pm \\varepsilon \\mathbf{v}_- $$\nwhere $\\varepsilon$ is a small positive constant.\n\n### II. Numerical Implementation Algorithm\n\nThe IRC path is found by numerically integrating the ODE derived above.\n\n**1. Pre-computation**\nFor each test case with parameters $(m_x, m_y, ds, \\varepsilon, tol, N_{\\max})$:\n*   Define the coordinate vectors for the analytically determined reactant and product wells, $\\mathbf{q}_R$ and $\\mathbf{q}_P$.\n*   Construct the mass matrix $M = \\begin{pmatrix} m_x  0 \\\\ 0  m_y \\end{pmatrix}$ and its inverse $M^{-1}$.\n*   Construct the Hessian at the saddle point, $H_0 = H(0,0)$.\n\n**2. Finding the Initial Direction**\n*   Solve the generalized eigenvalue problem $H_0 \\mathbf{v} = \\lambda M \\mathbf{v}$ to find all eigenvalues $\\lambda$ and corresponding eigenvectors $\\mathbf{v}$. A numerical library function like `scipy.linalg.eigh(H0, M)` is ideal, as it handles both the solution and the mass-metric normalization ($\\mathbf{v}^T M \\mathbf{v} = 1$).\n*   Identify the unique negative eigenvalue $\\lambda_-$ and its corresponding normalized eigenvector $\\mathbf{v}_-$.\n*   Determine the initial positions for the two branches: $\\mathbf{q}_{init,+} = \\varepsilon \\mathbf{v}_-$ and $\\mathbf{q}_{init,-} = -\\varepsilon \\mathbf{v}_-$.\n\n**3. Numerical Integration**\nAn explicit fixed-step integrator (Forward Euler) is used to advance the position along the IRC path. For each branch, starting from $\\mathbf{q}_0 = \\mathbf{q}_{init, \\pm}$:\n*   Iterate for $k = 0, 1, 2, \\dots, N_{\\max}-1$:\n    1.  Let the current position be $\\mathbf{q}_k$.\n    2.  Calculate the gradient $\\mathbf{g}_k = \\mathbf{g}(\\mathbf{q}_k)$.\n    3.  Calculate the norm of the mass-weighted gradient: $N_g = \\sqrt{\\mathbf{g}_k^T M^{-1} \\mathbf{g}_k}$.\n    4.  Check for termination: If $N_g  tol$, the path has reached a stationary point, so the integration stops.\n    5.  Compute the step direction: $\\Delta\\mathbf{q}_k = - \\frac{M^{-1}\\mathbf{g}_k}{N_g}$.\n    6.  Update the position: $\\mathbf{q}_{k+1} = \\mathbf{q}_k + ds \\cdot \\Delta\\mathbf{q}_k$.\n*   If the loop finishes due to reaching $N_{\\max}$, the integration also terminates. The final position is $\\mathbf{q}_{end}$ and the number of steps taken is $n_{steps}$.\n\n**4. Analysis and Output**\nFor each of the two completed branches (\"$+$\" and \"$-$\"):\n*   Let the endpoint be $\\mathbf{q}_{end}$ and the number of steps be $n$.\n*   The total arc length is $s = n \\cdot ds$.\n*   The potential energy at the endpoint is $E = V(\\mathbf{q}_{end})$.\n*   For the \"$+$\" branch, determine if it reached the product basin: $b_+ = (\\mathbf{q}_{end,+}[0]  0)$. Calculate the Euclidean distance to the product well: $d_+ = \\sqrt{(x_{end,+} - x_P)^2 + (y_{end,+} - y_P)^2}$.\n*   For the \"$-$\" branch, determine if it reached the reactant basin: $b_- = (\\mathbf{q}_{end,-}[0]  0)$. Calculate the Euclidean distance to the reactant well: $d_- = \\sqrt{(x_{end,-} - x_R)^2 + (y_{end,-} - y_R)^2}$.\n*   Assemble the eight results $[b_+, b_-, d_+, d_-, E_+, E_-, s_+, s_-]$ for the test case. Note that the final list contains items from both branches.\n\nThis procedure is repeated for all test cases, and the final results are aggregated into a single output list.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the IRC calculations for all test cases.\n    \"\"\"\n\n    # Analytically determined stationary points\n    x_well_abs = np.sqrt(1.04)\n    q_prod = np.array([x_well_abs, -0.2 * x_well_abs])\n    q_react = np.array([-x_well_abs, 0.2 * x_well_abs])\n    \n    # Hessian at the saddle point (0,0)\n    H0 = np.array([[-1.0, 0.2], [0.2, 1.0]])\n\n    def V(q):\n        \"\"\"Potential energy V(x,y).\"\"\"\n        x, y = q\n        return 0.25 * (x**2 - 1)**2 + 0.5 * y**2 + 0.2 * x * y\n\n    def grad_V(q):\n        \"\"\"Gradient of the potential V(x,y).\"\"\"\n        x, y = q\n        return np.array([x * (x**2 - 1) + 0.2 * y, y + 0.2 * x])\n\n    def integrate_branch(q_init, M_inv, ds, tol, N_max):\n        \"\"\"\n        Integrates a single IRC branch using a fixed-step arc-length scheme.\n\n        Args:\n            q_init (np.ndarray): Initial coordinates.\n            M_inv (np.ndarray): Inverse of the mass matrix.\n            ds (float): Arc-length step size.\n            tol (float): Gradient norm tolerance for termination.\n            N_max (int): Maximum number of integration steps.\n\n        Returns:\n            tuple: (final coordinates, number of steps).\n        \"\"\"\n        q = q_init.copy()\n        for n_steps in range(1, N_max + 1):\n            g = grad_V(q)\n            \n            # Norm of mass-weighted gradient for termination check and normalization\n            g_M_inv_g = g.T @ M_inv @ g\n            if g_M_inv_g  0: # Should not happen with positive definite M\n                break\n            grad_norm_mass_weighted = np.sqrt(g_M_inv_g)\n\n            if grad_norm_mass_weighted  tol:\n                return q, n_steps - 1\n\n            # IRC update step: move along -M_inv*g, normalized in the M-metric.\n            # The normalization factor is grad_norm_mass_weighted.\n            step_direction = -M_inv @ g / grad_norm_mass_weighted\n            q += ds * step_direction\n        \n        return q, N_max\n\n    def run_irc_case(params):\n        \"\"\"\n        Runs the full IRC calculation for a single test case.\n        \"\"\"\n        m_x, m_y, ds, epsilon, tol, N_max = params\n        \n        M = np.diag([m_x, m_y])\n        M_inv = np.diag([1./m_x, 1./m_y])\n\n        # Solve generalized eigenproblem H0*v = lambda*M*v\n        # scipy.linalg.eigh returns eigenvectors normalized s.t. v.T @ M @ v = 1\n        eigenvalues, eigenvectors = eigh(H0, M)\n        \n        # Find the unstable mode (eigenvector with negative eigenvalue)\n        unstable_idx = np.argmin(eigenvalues)\n        v_unstable = eigenvectors[:, unstable_idx]\n        \n        # Initial displacements for the two branches\n        q_init_p = epsilon * v_unstable\n        q_init_n = -epsilon * v_unstable\n\n        # Integrate both branches\n        q_end_p, n_steps_p = integrate_branch(q_init_p, M_inv, ds, tol, N_max)\n        q_end_n, n_steps_n = integrate_branch(q_init_n, M_inv, ds, tol, N_max)\n        \n        # Post-processing and analysis\n        s_p = n_steps_p * ds\n        s_n = n_steps_n * ds\n        \n        # Check if '+' branch leads to product well (x  0)\n        b_p = q_end_p[0]  0\n        # Check if '-' branch leads to reactant well (x  0)\n        b_n = q_end_n[0]  0\n\n        d_p = np.linalg.norm(q_end_p - q_prod)\n        d_n = np.linalg.norm(q_end_n - q_react)\n\n        E_p = V(q_end_p)\n        E_n = V(q_end_n)\n\n        # Ensure correct orientation of v_unstable\n        # The '+' displacement should point towards the product well (positive x)\n        if v_unstable[0]  0:\n            return [b_n, b_p, d_n, d_p, E_n, E_p, s_n, s_p]\n        else:\n            return [b_p, b_n, d_p, d_n, E_p, E_n, s_p, s_n]\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (m_x, m_y), ds, epsilon, tol, N_max\n        (1.0, 1.0, 0.02, 1e-3, 1e-8, 20000),\n        (1.0, 1.0, 0.005, 1e-6, 1e-10, 40000),\n        (1.0, 4.0, 0.02, 5e-4, 1e-8, 30000),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_irc_case(case)\n        results.append(result)\n\n    # Format the final output string as a list of lists.\n    # str(list) produces a string '[item1, item2, ...]'\n    # We join these strings with commas and wrap the whole thing in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}