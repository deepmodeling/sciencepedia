{
    "hands_on_practices": [
        {
            "introduction": "Our first practice starts with the cornerstone of electrostatics: calculating the potential $\\phi(\\mathbf{r})$ from a discrete set of point charges. This exercise  bridges fundamental theory with practical application by having you implement the superposition principle for a cluster of charges representing amino acid sidechains. It also introduces the critical concept of parameter sensitivity, demonstrating how different partial charge assignments—a common variable between molecular force fields—can impact the predicted electrostatic landscape.",
            "id": "3843128",
            "problem": "A small cluster of charged amino acid sidechains in a protein can be modeled as a finite set of point charges embedded in a dielectric medium that represents the combined response of solvent and polarizable surroundings. Using a reference frame fixed to the protein, the cluster geometry is specified in Cartesian coordinates, and two alternative partial charge assignments are provided for the same geometry (for example, different force field parameterizations). The task is to quantify the sensitivity of the electrostatic potential to these alternative charge assignments at a set of specified observation points.\n\nStarting from fundamental principles that are appropriate for electrostatics in computational chemical biology, use the definition of electric potential and the law of superposition in conjunction with the electric field of a point charge as given by Coulomb's law. Treat the medium as a homogeneous linear dielectric characterized by a relative permittivity. Use International System of Units (SI) throughout the computation. The electric potential must be reported in volts, and the final sensitivity metric is dimensionless. All numerical evaluation must be performed using the constants stated below.\n\nConstants and unit conversions to be used:\n- Elementary charge: $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$.\n- Vacuum permittivity: $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$.\n- Length conversion: $1\\,\\mathrm{\\AA} = 1\\times 10^{-10}\\,\\mathrm{m}$.\n- Relative permittivity: a dimensionless scalar, specified per test case.\n\nFor a given test case, let the point charge locations be $\\{\\mathbf{r}_i\\}_{i=1}^{N}$ in angstroms and the two charge sets be $\\{q_i^{(A)}\\}_{i=1}^{N}$ and $\\{q_i^{(B)}\\}_{i=1}^{N}$ in units of the elementary charge $e$. Let the observation points be $\\{\\mathbf{R}_j\\}_{j=1}^{M}$ in angstroms. For each test case, you must:\n- Derive and implement a physically justified expression for the electrostatic potential $\\phi(\\mathbf{R}_j)$ produced by $\\{q_i\\}$ at each observation point $\\mathbf{R}_j$, using a homogeneous dielectric medium with the given relative permittivity.\n- Compute two sets of potentials at the observation points, $\\{\\phi^{(A)}(\\mathbf{R}_j)\\}_{j=1}^{M}$ and $\\{\\phi^{(B)}(\\mathbf{R}_j)\\}_{j=1}^{M}$, in volts.\n- Compute a dimensionless sensitivity metric $S$ that quantifies the change from set $A$ to set $B$ as follows:\n  $$S = \\frac{\\sqrt{\\sum_{j=1}^{M}\\left(\\phi^{(B)}(\\mathbf{R}_j)-\\phi^{(A)}(\\mathbf{R}_j)\\right)^2}}{\\max\\left(\\sqrt{\\sum_{j=1}^{M}\\left(\\phi^{(A)}(\\mathbf{R}_j)\\right)^2},\\,1\\,\\mathrm{V}\\right)}.$$\n  The numerator and denominator must both be computed in volts so that $S$ is dimensionless. The use of the maximum with $1\\,\\mathrm{V}$ ensures a well-defined normalization even in the event that the reference potentials are very small at all observation points.\n\nScientific and numerical constraints:\n- Treat each sidechain atom center as a point charge.\n- Do not introduce any distance cutoffs or ad hoc damping; handle near-field behavior by avoiding zero separation in the provided test suite.\n- Use double-precision floating point arithmetic.\n- Express potentials in volts and the final sensitivity values as dimensionless real numbers, each rounded to $6$ decimal places.\n\nTest suite specification. For each test case, a geometry in angstroms, two charge sets in units of $e$, a relative permittivity, and observation points in angstroms are given:\n\n- Test case $1$ (aqueous environment, moderate distances):\n  - Relative permittivity: $\\varepsilon_r = 80.0$.\n  - Charge positions (in $\\mathrm{\\AA}$): $\\mathbf{r}_1=(0.0,\\,0.0,\\,0.0)$, $\\mathbf{r}_2=(2.0,\\,0.0,\\,0.0)$, $\\mathbf{r}_3=(0.0,\\,2.0,\\,0.0)$, $\\mathbf{r}_4=(0.0,\\,0.0,\\,2.5)$.\n  - Charge set $A$ (in $e$): $q_1^{(A)}=+0.4$, $q_2^{(A)}=-0.3$, $q_3^{(A)}=-0.3$, $q_4^{(A)}=+0.2$.\n  - Charge set $B$ (in $e$): $q_1^{(B)}=+0.45$, $q_2^{(B)}=-0.35$, $q_3^{(B)}=-0.25$, $q_4^{(B)}=+0.15$.\n  - Observation points (in $\\mathrm{\\AA}$): $\\mathbf{R}_1=(5.0,\\,0.0,\\,0.0)$, $\\mathbf{R}_2=(0.0,\\,5.0,\\,0.0)$, $\\mathbf{R}_3=(0.0,\\,0.0,\\,5.0)$, $\\mathbf{R}_4=(3.0,\\,3.0,\\,3.0)$, $\\mathbf{R}_5=(1.0,\\,1.0,\\,1.0)$.\n\n- Test case $2$ (protein interior, near-field points included but non-singular):\n  - Relative permittivity: $\\varepsilon_r = 4.0$.\n  - Charge positions (in $\\mathrm{\\AA}$): $\\mathbf{r}_1=(0.0,\\,0.0,\\,0.0)$, $\\mathbf{r}_2=(1.5,\\,0.0,\\,0.0)$, $\\mathbf{r}_3=(0.0,\\,1.5,\\,0.0)$.\n  - Charge set $A$ (in $e$): $q_1^{(A)}=+0.7$, $q_2^{(A)}=-0.5$, $q_3^{(A)}=-0.2$.\n  - Charge set $B$ (in $e$): $q_1^{(B)}=+0.65$, $q_2^{(B)}=-0.45$, $q_3^{(B)}=-0.2$.\n  - Observation points (in $\\mathrm{\\AA}$): $\\mathbf{R}_1=(0.1,\\,0.0,\\,0.0)$, $\\mathbf{R}_2=(1.5,\\,0.1,\\,0.0)$, $\\mathbf{R}_3=(0.1,\\,1.5,\\,0.0)$, $\\mathbf{R}_4=(2.0,\\,2.0,\\,2.0)$.\n\n- Test case $3$ (vacuum dipole-like pair, far-field and symmetry point included):\n  - Relative permittivity: $\\varepsilon_r = 1.0$.\n  - Charge positions (in $\\mathrm{\\AA}$): $\\mathbf{r}_1=(0.0,\\,0.0,\\,0.0)$, $\\mathbf{r}_2=(2.8,\\,0.0,\\,0.0)$.\n  - Charge set $A$ (in $e$): $q_1^{(A)}=+1.0$, $q_2^{(A)}=-1.0$.\n  - Charge set $B$ (in $e$): $q_1^{(B)}=+0.9$, $q_2^{(B)}=-0.9$.\n  - Observation points (in $\\mathrm{\\AA}$): $\\mathbf{R}_1=(1.4,\\,0.0,\\,0.0)$, $\\mathbf{R}_2=(5.0,\\,0.0,\\,0.0)$, $\\mathbf{R}_3=(0.0,\\,5.0,\\,0.0)$, $\\mathbf{R}_4=(3.0,\\,3.0,\\,0.0)$.\n\nProgram output specification:\n- Your program must compute the sensitivity $S$ for each test case, using the constants and method described above.\n- Round each sensitivity to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of test cases $1$, $2$, $3$ (for example, $[s_1,s_2,s_3]$ where each $s_k$ is a real number rounded to $6$ decimal places).",
            "solution": "We begin from the electrostatic principles pertinent to molecular systems in computational chemical biology, where fixed partial charges approximate the electron density distribution and polarization is treated at the continuum level via a homogeneous linear dielectric with relative permittivity $\\varepsilon_r$.\n\nFoundational laws and definitions:\n- Coulomb's law for the electric field of a point charge in a homogeneous linear dielectric medium: a point charge with value $q$ (in coulombs) located at $\\mathbf{r}_0$ produces an electric field at position $\\mathbf{r}$ given by\n  $$\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{q\\,(\\mathbf{r}-\\mathbf{r}_0)}{\\lVert \\mathbf{r}-\\mathbf{r}_0\\rVert^3}.$$\n- Definition of electric potential relative to infinity: for electrostatics with the reference potential zero at infinity, the potential satisfies\n  $$\\phi(\\mathbf{r}) = -\\int_{\\infty}^{\\mathbf{r}}\\mathbf{E}\\cdot d\\mathbf{\\ell}.$$\n- Superposition principle: for multiple sources in a linear medium, fields and potentials add linearly.\n\nDerivation of the potential from a single point charge:\n- Inserting the Coulomb field into the line integral and using the radial symmetry, one obtains the well-established result for the potential of a single point charge at distance $R=\\lVert \\mathbf{r}-\\mathbf{r}_0\\rVert$,\n  $$\\phi(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{q}{R}.$$\n  This follows because the integral of the radial field from $\\infty$ to $R$ equals $\\int_{\\infty}^{R} \\left( \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\frac{q}{r^2} \\right) dr = \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r} \\frac{q}{R}$.\n\nExtension to multiple point charges by superposition:\n- For $N$ point charges with values $\\{q_i\\}$ at positions $\\{\\mathbf{r}_i\\}$, the potential at $\\mathbf{R}$ is the sum\n  $$\\phi(\\mathbf{R}) = \\sum_{i=1}^{N} \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{q_i}{\\lVert \\mathbf{R}-\\mathbf{r}_i\\rVert}.$$\n\nUnit conversion and parameterization relevant to chemical systems:\n- The given partial charges are in units of the elementary charge $e$, so we must convert to coulombs by $q_i^{\\mathrm{(C)}} = q_i^{\\mathrm{(e)}}\\times e$.\n- Coordinates are given in angstroms, so distances must be converted to meters: if vectors are in $\\mathrm{\\AA}$, then $\\lVert \\mathbf{R}-\\mathbf{r}_i\\rVert_{\\mathrm{m}} = \\lVert \\mathbf{R}-\\mathbf{r}_i\\rVert_{\\mathrm{\\AA}}\\times 10^{-10}\\,\\mathrm{m}/\\mathrm{\\AA}$.\n- The vacuum permittivity is $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$, and the dimensionless relative permittivity $\\varepsilon_r$ is specified per test case. The potential computed from the above expression is in volts.\n\nAlgorithmic procedure for each test case:\n1. Read $\\varepsilon_r$, the list of $N$ positions $\\{\\mathbf{r}_i\\}$ in $\\mathrm{\\AA}$, and two charge lists $\\{q_i^{(A)}\\}$ and $\\{q_i^{(B)}\\}$ in units of $e$. Read the $M$ observation points $\\{\\mathbf{R}_j\\}$ in $\\mathrm{\\AA}$.\n2. For each observation point $\\mathbf{R}_j$, compute distances $R_{ij} = \\lVert \\mathbf{R}_j - \\mathbf{r}_i \\rVert_{\\mathrm{\\AA}}$ using the Euclidean norm. Convert $R_{ij}$ to meters by $R_{ij}^{\\mathrm{(m)}} = R_{ij}\\times 10^{-10}$.\n3. Convert the partial charges to coulombs: $q_i^{(A,\\mathrm{C})} = q_i^{(A)}\\times e$ and $q_i^{(B,\\mathrm{C})} = q_i^{(B)}\\times e$.\n4. Compute the potentials at each $\\mathbf{R}_j$ for both charge sets using\n   $$\\phi^{(A)}(\\mathbf{R}_j) = \\sum_{i=1}^{N} \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{q_i^{(A,\\mathrm{C})}}{R_{ij}^{\\mathrm{(m)}}},\\quad \\phi^{(B)}(\\mathbf{R}_j) = \\sum_{i=1}^{N} \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{q_i^{(B,\\mathrm{C})}}{R_{ij}^{\\mathrm{(m)}}}.$$\n5. Assemble the vectors $\\boldsymbol{\\phi}^{(A)}\\in\\mathbb{R}^M$ and $\\boldsymbol{\\phi}^{(B)}\\in\\mathbb{R}^M$. Compute the sensitivity metric\n   $$S = \\frac{\\left\\lVert \\boldsymbol{\\phi}^{(B)} - \\boldsymbol{\\phi}^{(A)} \\right\\rVert_2}{\\max\\left(\\left\\lVert \\boldsymbol{\\phi}^{(A)} \\right\\rVert_2,\\,1\\,\\mathrm{V}\\right)}.$$\n   This metric interprets sensitivity as a relative change measured in the Euclidean norm, with a lower bound in the denominator set by $1\\,\\mathrm{V}$ to avoid division by an extremely small reference magnitude. The metric is dimensionless, because both numerator and denominator are homogeneous in volts.\n\nNumerical stability and edge cases:\n- Zero-distance singularities are avoided by the provided test points; for completeness, an implementation should guard against $R_{ij}^{\\mathrm{(m)}}=0$ by not evaluating such cases. The test suite does not contain any zero separations.\n- The normalization includes $\\max(\\cdot,1\\,\\mathrm{V})$; in the unlikely event that $\\left\\lVert \\boldsymbol{\\phi}^{(A)} \\right\\rVert_2 = 0$, the denominator becomes $1\\,\\mathrm{V}$, yielding an absolute change measured in units of volts relative to unity.\n\nApplication to the test suite:\n- Test case $1$ uses $\\varepsilon_r=80.0$ and a neutral cluster with four point charges at moderate distances; observation points are placed several angstroms away, capturing solvent-screened potentials.\n- Test case $2$ uses $\\varepsilon_r=4.0$, representative of a low-dielectric protein interior; observation points include near-field evaluations at $0.1\\,\\mathrm{\\AA}$ offsets, producing large but finite potentials that probe sensitivity in the near field.\n- Test case $3$ uses $\\varepsilon_r=1.0$ (vacuum), with a dipole-like pair; observation points include the midpoint on the internuclear axis, where the potential for equal and opposite charges cancels, and far-field points to probe the decay and sensitivity away from the source.\n\nImplementation details:\n- Use double-precision floating point operations to compute distances, potentials, and norms.\n- Round the final $S$ for each test case to $6$ decimal places.\n- Output a single line with the list $[S_1,S_2,S_3]$ in that order, as required.\n\nThe accompanying program implements the above derivation precisely, adheres to the unit conversions, and computes the requested sensitivities for the three specified test cases. The final output is a single line with three dimensionless real numbers rounded to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nE_CHARGE_C = 1.602176634e-19       # Coulomb\nEPS0 = 8.8541878128e-12            # F/m\nANGSTROM_TO_M = 1e-10              # m per angstrom\nFOUR_PI = 4.0 * np.pi\n\ndef potential_at_points(positions_Ang, charges_e, eps_r, obs_points_Ang):\n    \"\"\"\n    Compute electrostatic potential at observation points due to point charges\n    in a homogeneous dielectric medium.\n\n    positions_Ang: (N,3) array of charge positions in angstroms\n    charges_e: (N,) array of charges in units of elementary charge e\n    eps_r: relative permittivity (dimensionless)\n    obs_points_Ang: (M,3) array of observation points in angstroms\n\n    Returns: (M,) array of potentials in volts\n    \"\"\"\n    positions_m = positions_Ang * ANGSTROM_TO_M\n    obs_m = obs_points_Ang * ANGSTROM_TO_M\n    charges_C = charges_e * E_CHARGE_C\n\n    # Precompute Coulomb prefactor\n    prefac = 1.0 / (FOUR_PI * EPS0 * eps_r)  # in SI\n\n    # Compute pairwise distances R_ij between obs points and charges\n    # obs_m shape (M,1,3), positions_m shape (1,N,3), broadcast difference to (M,N,3)\n    diff = obs_m[:, None, :] - positions_m[None, :, :]\n    dists = np.linalg.norm(diff, axis=2)  # shape (M,N)\n\n    # Avoid division by zero: although test suite avoids exact zeros, protect anyway\n    # Replace any exact zeros with np.nan and handle by setting contribution to inf (physically undefined).\n    # Here we will safely set contributions where distance is zero to 0 (since not present in test cases).\n    # Alternatively, raise an error; but we'll mask to keep robustness.\n    with np.errstate(divide='ignore', invalid='ignore'):\n        inv_d = 1.0 / dists  # (M,N), inf if any zero distances\n    inv_d[~np.isfinite(inv_d)] = 0.0\n\n    # Sum contributions: phi_j = prefac * sum_i q_i / R_ij\n    phi = prefac * np.dot(inv_d, charges_C)  # (M,)\n    return phi\n\ndef sensitivity_metric(phi_A, phi_B):\n    \"\"\"\n    Compute dimensionless sensitivity S = ||phi_B - phi_A||_2 / max(||phi_A||_2, 1 V).\n    \"\"\"\n    num = np.linalg.norm(phi_B - phi_A)\n    denom = max(np.linalg.norm(phi_A), 1.0)  # volts\n    return num / denom\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Test case 1\n    eps_r_1 = 80.0\n    positions_1 = np.array([\n        [0.0, 0.0, 0.0],\n        [2.0, 0.0, 0.0],\n        [0.0, 2.0, 0.0],\n        [0.0, 0.0, 2.5],\n    ], dtype=float)\n    charges_A_1 = np.array([+0.4, -0.3, -0.3, +0.2], dtype=float)\n    charges_B_1 = np.array([+0.45, -0.35, -0.25, +0.15], dtype=float)\n    obs_1 = np.array([\n        [5.0, 0.0, 0.0],\n        [0.0, 5.0, 0.0],\n        [0.0, 0.0, 5.0],\n        [3.0, 3.0, 3.0],\n        [1.0, 1.0, 1.0],\n    ], dtype=float)\n\n    # Test case 2\n    eps_r_2 = 4.0\n    positions_2 = np.array([\n        [0.0, 0.0, 0.0],\n        [1.5, 0.0, 0.0],\n        [0.0, 1.5, 0.0],\n    ], dtype=float)\n    charges_A_2 = np.array([+0.7, -0.5, -0.2], dtype=float)\n    charges_B_2 = np.array([+0.65, -0.45, -0.2], dtype=float)\n    obs_2 = np.array([\n        [0.1, 0.0, 0.0],\n        [1.5, 0.1, 0.0],\n        [0.1, 1.5, 0.0],\n        [2.0, 2.0, 2.0],\n    ], dtype=float)\n\n    # Test case 3\n    eps_r_3 = 1.0\n    positions_3 = np.array([\n        [0.0, 0.0, 0.0],\n        [2.8, 0.0, 0.0],\n    ], dtype=float)\n    charges_A_3 = np.array([+1.0, -1.0], dtype=float)\n    charges_B_3 = np.array([+0.9, -0.9], dtype=float)\n    obs_3 = np.array([\n        [1.4, 0.0, 0.0],\n        [5.0, 0.0, 0.0],\n        [0.0, 5.0, 0.0],\n        [3.0, 3.0, 0.0],\n    ], dtype=float)\n\n    test_cases = [\n        (positions_1, charges_A_1, charges_B_1, eps_r_1, obs_1),\n        (positions_2, charges_A_2, charges_B_2, eps_r_2, obs_2),\n        (positions_3, charges_A_3, charges_B_3, eps_r_3, obs_3),\n    ]\n\n    results = []\n    for positions, qA, qB, eps_r, obs in test_cases:\n        phi_A = potential_at_points(positions, qA, eps_r, obs)\n        phi_B = potential_at_points(positions, qB, eps_r, obs)\n        S = sensitivity_metric(phi_A, phi_B)\n        # Round to 6 decimal places\n        results.append(f\"{S:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Having established the basics of potential calculation, we now explore how the surrounding environment alters electrostatic interactions. This practice  focuses on the phenomenon of dielectric polarization that occurs at the boundary between two media with different permittivities, such as a protein or membrane in water. By employing the elegant method of images, you will derive the potential and interaction free energy for an ion near an interface, gaining insight into the energetic cost or benefit of placing charges near low-dielectric regions.",
            "id": "3843095",
            "problem": "Consider a point ion of charge $q$ located in an aqueous phase with absolute permittivity $\\epsilon_{1}$ at position $\\mathbf{r}_{0}=(0,0,d)$, a distance $d>0$ from a planar membrane interface at $z=0$. The membrane interior occupies $z<0$ and has absolute permittivity $\\epsilon_{2}\\neq \\epsilon_{1}$. There are no mobile ions (no screening), the media are linear, isotropic dielectrics, and the interface is infinite and perfectly planar. In computational chemical biology, such continuum-electrostatics models are used to estimate how polarization at dielectric boundaries alters ionic free energies near biomembranes.\n\nStarting from first principles in electrostatics, use the method of images to construct a representation of the electrostatic potential in the aqueous region $z>0$ that satisfies the dielectric boundary conditions at $z=0$. Then, from this construction, determine the induced potential at the ion’s location, defined as the contribution to the total potential at $\\mathbf{r}_{0}$ arising solely from polarization charges in the membrane induced by the presence of the ion. Using linear response and thermodynamic integration arguments appropriate for linear dielectrics, derive an analytical expression for the change in the ion’s electrostatic free energy relative to bulk aqueous phase (far from the interface), attributable to the interface-induced polarization.\n\nExpress the final free energy change per ion in Joules as a single closed-form analytical expression in terms of $q$, $d$, $\\epsilon_{1}$, and $\\epsilon_{2}$. Do not perform any numerical evaluation. The final answer must be a single expression.",
            "solution": "The problem requires the derivation of the electrostatic free energy change for an ion near a planar dielectric interface. The derivation will proceed in three stages as requested: first, constructing the electrostatic potential using the method of images; second, identifying the induced potential at the ion's location; and third, calculating the free energy change using a thermodynamic argument.\n\nThe system consists of two semi-infinite, linear, isotropic dielectric media. Region 1, for $z>0$, has permittivity $\\epsilon_{1}$. Region 2, for $z<0$, has permittivity $\\epsilon_{2}$. A point charge $q$ is located at $\\mathbf{r}_{0}=(0,0,d)$ in region 1, where $d>0$. The interface is at the plane $z=0$. There are no free charges other than $q$.\n\nThe electrostatic potential $\\Phi$ must satisfy Poisson's equation in region 1 and Laplace's equation in region 2:\n$$\n\\nabla^2 \\Phi_1 = -\\frac{q}{\\epsilon_1} \\delta(\\mathbf{r} - \\mathbf{r}_0) \\quad \\text{for } z>0\n$$\n$$\n\\nabla^2 \\Phi_2 = 0 \\quad \\text{for } z<0\n$$\nwhere $\\delta(\\mathbf{r} - \\mathbf{r}_0)$ is the three-dimensional Dirac delta function.\n\nAt the interface $z=0$, the potential and the normal component of the electric displacement field $\\mathbf{D}=-\\epsilon\\nabla\\Phi$ must be continuous:\n1. $\\Phi_1(x,y,0) = \\Phi_2(x,y,0)$\n2. $\\epsilon_1 \\frac{\\partial \\Phi_1}{\\partial z} \\Big|_{z=0} = \\epsilon_2 \\frac{\\partial \\Phi_2}{\\partial z} \\Big|_{z=0}$\n\nWe employ the method of images.\nFor the potential in region 1 ($z>0$), we represent the effect of the induced polarization at the interface by placing an image charge $q'$ at position $\\mathbf{r}'=(0,0,-d)$. The potential $\\Phi_1$ is the superposition of the potential from the real charge $q$ and the image charge $q'$, both considered to be in a uniform medium of permittivity $\\epsilon_{1}$:\n$$\n\\Phi_1(\\mathbf{r}) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{|\\mathbf{r} - \\mathbf{r}_0|} + \\frac{q'}{|\\mathbf{r} - \\mathbf{r}'|} \\right)\n$$\nFor a point $\\mathbf{r}=(x,y,z)$, this is:\n$$\n\\Phi_1(x,y,z) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{x^2 + y^2 + (z-d)^2}} + \\frac{q'}{\\sqrt{x^2 + y^2 + (z+d)^2}} \\right)\n$$\n\nFor the potential in region 2 ($z<0$), we place a different image charge $q''$ at the position of the original charge, $\\mathbf{r}_0=(0,0,d)$. The potential $\\Phi_2$ is that of this single charge in a uniform medium of permittivity $\\epsilon_2$:\n$$\n\\Phi_2(\\mathbf{r}) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''}{|\\mathbf{r} - \\mathbf{r}_0|}\n$$\nFor a point $\\mathbf{r}=(x,y,z)$, this is:\n$$\n\\Phi_2(x,y,z) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''}{\\sqrt{x^2 + y^2 + (z-d)^2}}\n$$\nThis construction satisfies the required Poisson/Laplace equations in each region. We now enforce the boundary conditions at $z=0$ to find the values of $q'$ and $q''$.\n\nBoundary condition 1 (continuity of $\\Phi$ at $z=0$):\nAt $z=0$, $\\sqrt{x^2 + y^2 + (0-d)^2} = \\sqrt{x^2 + y^2 + (0+d)^2} = \\sqrt{x^2 + y^2 + d^2}$.\n$$\n\\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{x^2+y^2+d^2}} + \\frac{q'}{\\sqrt{x^2+y^2+d^2}} \\right) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''}{\\sqrt{x^2+y^2+d^2}}\n$$\nThis simplifies to:\n$$\n\\frac{q+q'}{\\epsilon_1} = \\frac{q''}{\\epsilon_2} \\quad \\text{(1)}\n$$\n\nBoundary condition 2 (continuity of $D_z$ at $z=0$):\nFirst, we compute the partial derivatives with respect to $z$:\n$$\n\\frac{\\partial \\Phi_1}{\\partial z} = \\frac{1}{4\\pi\\epsilon_1} \\left[ q \\frac{-(z-d)}{(\\dots)^{3/2}} + q' \\frac{-(z+d)}{(\\dots)^{3/2}} \\right] \\implies \\frac{\\partial \\Phi_1}{\\partial z}\\Big|_{z=0} = \\frac{1}{4\\pi\\epsilon_1} \\frac{d(q-q')}{(x^2+y^2+d^2)^{3/2}}\n$$\n$$\n\\frac{\\partial \\Phi_2}{\\partial z} = \\frac{1}{4\\pi\\epsilon_2} \\left[ q'' \\frac{-(z-d)}{(\\dots)^{3/2}} \\right] \\implies \\frac{\\partial \\Phi_2}{\\partial z}\\Big|_{z=0} = \\frac{1}{4\\pi\\epsilon_2} \\frac{d q''}{(x^2+y^2+d^2)^{3/2}}\n$$\nApplying $\\epsilon_1 \\frac{\\partial \\Phi_1}{\\partial z} = \\epsilon_2 \\frac{\\partial \\Phi_2}{\\partial z}$ at $z=0$:\n$$\n\\epsilon_1 \\left( \\frac{d(q-q')}{4\\pi\\epsilon_1(\\dots)^{3/2}} \\right) = \\epsilon_2 \\left( \\frac{d q''}{4\\pi\\epsilon_2(\\dots)^{3/2}} \\right)\n$$\nThis simplifies to:\n$$\nq - q' = q'' \\quad \\text{(2)}\n$$\n\nWe now solve the system of linear equations (1) and (2) for $q'$ and $q''$:\nSubstitute (2) into (1):\n$$\n\\frac{q+q'}{\\epsilon_1} = \\frac{q-q'}{\\epsilon_2} \\implies \\epsilon_2(q+q') = \\epsilon_1(q-q')\n$$\n$$\n\\epsilon_2 q + \\epsilon_2 q' = \\epsilon_1 q - \\epsilon_1 q' \\implies q'(\\epsilon_1 + \\epsilon_2) = q(\\epsilon_1 - \\epsilon_2)\n$$\n$$\nq' = q \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right)\n$$\nThis completes the setup for the potential in region 1.\n\nThe problem asks for the induced potential at the ion's location, $\\mathbf{r}_0$. The total potential $\\Phi_1(\\mathbf{r})$ is the sum of the potential from the source charge $q$ itself in a uniform medium, $\\Phi_{\\text{source}}(\\mathbf{r}) = \\frac{q}{4\\pi\\epsilon_1 |\\mathbf{r} - \\mathbf{r}_0|}$, and the potential due to the induced polarization charges at the interface. The method of images provides this induced potential as the potential generated by the image charge $q'$:\n$$\n\\Phi_{\\text{induced}}(\\mathbf{r}) = \\frac{q'}{4\\pi\\epsilon_1 |\\mathbf{r} - \\mathbf{r}'|}\n$$\nWe evaluate this induced potential at the ion's position $\\mathbf{r}_0 = (0,0,d)$. The distance from the ion to its image is $|\\mathbf{r}_0 - \\mathbf{r}'| = |(0,0,d) - (0,0,-d)| = 2d$.\n$$\n\\Phi_{\\text{induced}}(\\mathbf{r}_0) = \\frac{q'}{4\\pi\\epsilon_1 (2d)} = \\frac{q'}{8\\pi\\epsilon_1 d}\n$$\nSubstituting the expression for $q'$:\n$$\n\\Phi_{\\text{induced}}(\\mathbf{r}_0) = \\frac{1}{8\\pi\\epsilon_1 d} \\left[ q \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right) \\right] = \\frac{q}{8\\pi\\epsilon_1 d} \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right)\n$$\n\nFinally, we derive the change in the ion's electrostatic free energy, $\\Delta G$, relative to its state in the bulk aqueous phase (i.e., infinitely far from the interface, $d \\to \\infty$). This energy corresponds to the work done to create the polarization in the dielectric media when the ion is brought from $d=\\infty$ to its final position. For a linear dielectric, this work can be calculated using a thermodynamic charging process. We imagine building the charge of the ion from $0$ to its final value $q$. Let the instantaneous charge be $\\lambda q$, where $\\lambda$ is a charging parameter from $0$ to $1$.\n\nThe induced potential is linear in the source charge, so for an instantaneous charge $\\lambda q$, the induced potential at the ion's location is $\\lambda \\Phi_{\\text{induced}}(\\mathbf{r}_0)$. The incremental work $d(\\Delta G)$ done to add an infinitesimal amount of charge $d(\\lambda q) = q d\\lambda$ is:\n$$\nd(\\Delta G) = (\\lambda \\Phi_{\\text{induced}}(\\mathbf{r}_0)) (q d\\lambda)\n$$\nThe total free energy change is the integral of this work from $\\lambda=0$ to $\\lambda=1$:\n$$\n\\Delta G = \\int_0^1 q \\Phi_{\\text{induced}}(\\mathbf{r}_0) \\lambda \\, d\\lambda = q \\Phi_{\\text{induced}}(\\mathbf{r}_0) \\int_0^1 \\lambda \\, d\\lambda\n$$\n$$\n\\Delta G = q \\Phi_{\\text{induced}}(\\mathbf{r}_0) \\left[ \\frac{\\lambda^2}{2} \\right]_0^1 = \\frac{1}{2} q \\Phi_{\\text{induced}}(\\mathbf{r}_0)\n$$\nThis factor of $1/2$ is a general result for the energy of interaction of a charge with a linear polarizable medium it induces.\n\nSubstituting our expression for $\\Phi_{\\text{induced}}(\\mathbf{r}_0)$:\n$$\n\\Delta G = \\frac{1}{2} q \\left[ \\frac{q}{8\\pi\\epsilon_1 d} \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right) \\right]\n$$\n$$\n\\Delta G = \\frac{q^2}{16\\pi\\epsilon_1 d} \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right)\n$$\nThis is the final analytical expression for the change in the ion's electrostatic free energy due to the interface-induced polarization, relative to the bulk phase where this interaction energy is zero.",
            "answer": "$$\n\\boxed{\\frac{q^2}{16 \\pi \\epsilon_{1} d} \\left( \\frac{\\epsilon_{1} - \\epsilon_{2}}{\\epsilon_{1} + \\epsilon_{2}} \\right)}\n$$"
        },
        {
            "introduction": "Our final exercise addresses another essential environmental effect: the screening of electrostatic interactions by mobile ions in solution. This practice  delves into the foundational Debye-Hückel theory, which emerges from the linearized Poisson-Boltzmann equation. You will derive the characteristic Debye length $\\lambda_{D}$ and use it to quantify how physiological salt concentrations dramatically attenuate the Coulomb force, a crucial factor governing the strength and range of interactions between biomolecules.",
            "id": "3843158",
            "problem": "In computational chemical biology, a widely used mean-field model for electrostatic screening in aqueous electrolyte is based on the linearized Poisson–Boltzmann (PB) equation for small electrostatic potentials. Consider an aqueous solution of sodium chloride (NaCl) at concentration $150\\,\\mathrm{mM}$ and temperature $T=298\\,\\mathrm{K}$. Assume water has relative permittivity $\\varepsilon_{r}=78.5$ at $T=298\\,\\mathrm{K}$, and treat NaCl as an ideal $1{:}1$ electrolyte with ionic strength $I$. Two localized protein surface patches are approximated as point charges with $q_{1}=+e$ and $q_{2}=-e$ separated by a center-to-center distance $r$. Using the linearized PB framework and the definition of ionic strength, start from fundamental electrostatics and statistical mechanics to derive the Debye screening length $\\lambda_{D}$ and the screened Coulomb interaction energy $U(r)$ between the two charges. Then, for $r_{1}=1\\,\\mathrm{nm}$ and $r_{2}=5\\,\\mathrm{nm}$, evaluate the dimensionless screened energies $U(r_{1})/(k_{B}T)$ and $U(r_{2})/(k_{B}T)$.\n\nTake the following constants as known: Boltzmann constant $k_{B}$, vacuum permittivity $\\varepsilon_{0}$, elementary charge $e$, and Avogadro’s number $N_{A}$. Express the final Debye length in nanometers and the energies in units of $k_{B}T$ (dimensionless). Round each reported value to three significant figures. Report your final answer as a single row matrix in the order $\\big[\\lambda_{D}\\ \\text{(nm)},\\ U(r_{1})/(k_{B}T),\\ U(r_{2})/(k_{B}T)\\big]$.",
            "solution": "The problem requires the derivation of the Debye screening length and the screened Coulomb interaction energy within the linearized Poisson–Boltzmann (PB) framework, followed by numerical evaluation for a specific system.\n\n**1. Theoretical Framework: Poisson-Boltzmann Equation**\n\nThe electrostatic potential $\\phi(\\mathbf{r})$ in a continuous medium with permittivity $\\varepsilon$ is governed by the Poisson equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho(\\mathbf{r})}{\\varepsilon} $$\nwhere $\\rho(\\mathbf{r})$ is the total charge density. In an electrolyte, $\\rho(\\mathbf{r})$ consists of the charge density of fixed charges, $\\rho_{\\text{fix}}(\\mathbf{r})$, and the charge density of mobile ions in the solution, $\\rho_{\\text{ion}}(\\mathbf{r})$.\n$$ \\rho(\\mathbf{r}) = \\rho_{\\text{fix}}(\\mathbf{r}) + \\rho_{\\text{ion}}(\\mathbf{r}) $$\nThe mobile ion charge density is a sum over all ion species $i$:\n$$ \\rho_{\\text{ion}}(\\mathbf{r}) = \\sum_i z_i e n_i(\\mathbf{r}) $$\nwhere $z_i$ is the valence of ion species $i$, $e$ is the elementary charge, and $n_i(\\mathbf{r})$ is the local number density of ion species $i$.\n\nAccording to statistical mechanics, the local ion density follows the Boltzmann distribution, which relates the local density $n_i(\\mathbf{r})$ to the bulk density $n_{i,0}$ and the local electrostatic potential energy $z_i e \\phi(\\mathbf{r})$:\n$$ n_i(\\mathbf{r}) = n_{i,0} \\exp\\left(-\\frac{z_i e \\phi(\\mathbf{r})}{k_B T}\\right) $$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nSubstituting this into the Poisson equation yields the full, non-linear Poisson-Boltzmann equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\left( \\rho_{\\text{fix}}(\\mathbf{r}) + \\sum_i z_i e n_{i,0} \\exp\\left(-\\frac{z_i e \\phi(\\mathbf{r})}{k_B T}\\right) \\right) $$\n\n**2. Linearization and the Debye-Hückel Equation**\n\nThe problem specifies using the linearized PB framework, which is valid for small potentials where the electrostatic energy is much smaller than the thermal energy, i.e., $|z_i e \\phi(\\mathbf{r})| \\ll k_B T$. We can then linearize the exponential term using a Taylor expansion, $\\exp(-x) \\approx 1-x$ for small $x$:\n$$ \\rho_{\\text{ion}}(\\mathbf{r}) \\approx \\sum_i z_i e n_{i,0} \\left( 1 - \\frac{z_i e \\phi(\\mathbf{r})}{k_B T} \\right) = \\sum_i z_i e n_{i,0} - \\left( \\frac{e^2}{k_B T} \\sum_i z_i^2 n_{i,0} \\right) \\phi(\\mathbf{r}) $$\nThe first term, $\\sum_i z_i e n_{i,0}$, represents the net charge density in the bulk solution, which is zero due to overall electroneutrality. Thus, the linearized ion density is:\n$$ \\rho_{\\text{ion}}(\\mathbf{r}) \\approx -\\left( \\frac{e^2}{k_B T} \\sum_i z_i^2 n_{i,0} \\right) \\phi(\\mathbf{r}) $$\nSubstituting this into the Poisson equation gives the linearized Poisson-Boltzmann equation, also known as the Debye-Hückel equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) - \\left( \\frac{e^2}{\\varepsilon k_B T} \\sum_i z_i^2 n_{i,0} \\right) \\phi(\\mathbf{r}) = -\\frac{\\rho_{\\text{fix}}(\\mathbf{r})}{\\varepsilon} $$\nThis can be written more compactly as:\n$$ \\nabla^2 \\phi(\\mathbf{r}) - \\kappa^2 \\phi(\\mathbf{r}) = -\\frac{\\rho_{\\text{fix}}(\\mathbf{r})}{\\varepsilon} $$\nwhere $\\kappa^2$ is the screening parameter, defined as:\n$$ \\kappa^2 = \\frac{e^2}{\\varepsilon k_B T} \\sum_i z_i^2 n_{i,0} $$\n\n**3. Derivation of the Debye Length, $\\lambda_D$**\n\nThe Debye length, $\\lambda_D$, is defined as the inverse of the screening parameter, $\\lambda_D = 1/\\kappa$. It represents the characteristic length scale for electrostatic screening in an electrolyte.\n$$ \\lambda_D = \\frac{1}{\\kappa} = \\sqrt{\\frac{\\varepsilon k_B T}{e^2 \\sum_i z_i^2 n_{i,0}}} $$\nFor the given system, an aqueous solution of NaCl, we have a $1{:}1$ electrolyte with Na$^+$ ($z_1 = +1$) and Cl$^-$ ($z_2 = -1$). The permittivity is $\\varepsilon = \\varepsilon_0 \\varepsilon_r$. The bulk number density $n_{i,0}$ is related to the molar concentration $C_{salt}$ (in SI units of $\\mathrm{mol/m^3}$) by $n_{i,0} = C_{salt} N_A$, where $N_A$ is Avogadro's number. For a $1{:}1$ electrolyte, $n_{\\text{Na}^+,0} = n_{\\text{Cl}^-,0} = C_{salt} N_A$.\nThe sum becomes:\n$$ \\sum_i z_i^2 n_{i,0} = (+1)^2 (C_{salt} N_A) + (-1)^2 (C_{salt} N_A) = 2 C_{salt} N_A $$\nSubstituting this into the expression for $\\lambda_D$ gives the final form for a $1{:}1$ electrolyte:\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon_0 \\varepsilon_r k_B T}{2 e^2 N_A C_{salt}}} $$\n\n**4. Derivation of the Screened Interaction Energy, $U(r)$**\n\nTo find the interaction energy between the two charges, we first find the potential $\\phi_1(r)$ generated by one of the charges, say $q_1 = +e$, located at the origin. For a point charge, $\\rho_{\\text{fix}}(\\mathbf{r}) = q_1 \\delta(\\mathbf{r})$, where $\\delta(\\mathbf{r})$ is the Dirac delta function. For $r > 0$, the Debye-Hückel equation is homogeneous:\n$$ \\nabla^2 \\phi_1(r) - \\kappa^2 \\phi_1(r) = 0 $$\nAssuming spherical symmetry, the equation becomes $\\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{d\\phi_1}{dr}\\right) - \\kappa^2 \\phi_1 = 0$. The general solution that vanishes as $r \\to \\infty$ is:\n$$ \\phi_1(r) = A \\frac{\\exp(-\\kappa r)}{r} $$\nThe constant $A$ is determined by matching the potential to the standard Coulomb potential in the limit $r \\to 0$, which is $\\phi_{Coulomb}(r) = \\frac{q_1}{4\\pi\\varepsilon r}$. This gives $A = \\frac{q_1}{4\\pi\\varepsilon}$.\nTherefore, the screened potential from charge $q_1 = +e$ is:\n$$ \\phi_1(r) = \\frac{e}{4\\pi\\varepsilon_0 \\varepsilon_r r} \\exp(-r/\\lambda_D) $$\nThis is known as the Debye-Hückel or Yukawa potential. The interaction energy $U(r)$ between this charge and a second charge $q_2 = -e$ at a distance $r$ is given by $U(r) = q_2 \\phi_1(r)$:\n$$ U(r) = (-e) \\left( \\frac{e}{4\\pi\\varepsilon_0 \\varepsilon_r r} \\exp(-r/\\lambda_D) \\right) = -\\frac{e^2}{4\\pi\\varepsilon_0 \\varepsilon_r r} \\exp(-r/\\lambda_D) $$\nThis is the required expression for the screened Coulomb interaction energy between the two charges.\n\n**5. Numerical Calculations**\n\nWe are given the following parameters:\n- $T = 298\\,\\mathrm{K}$\n- $\\varepsilon_r = 78.5$\n- $c = 150\\,\\mathrm{mM} = 0.150\\,\\mathrm{mol/L}$. In SI units, $C_{salt} = 150\\,\\mathrm{mol/m^3}$.\n- $r_1 = 1\\,\\mathrm{nm} = 1 \\times 10^{-9}\\,\\mathrm{m}$\n- $r_2 = 5\\,\\mathrm{nm} = 5 \\times 10^{-9}\\,\\mathrm{m}$\nAnd the fundamental constants:\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n- $\\varepsilon_0 = 8.854187 \\times 10^{-12}\\,\\mathrm{F/m}$\n- $e = 1.602177 \\times 10^{-19}\\,\\mathrm{C}$\n- $N_A = 6.022141 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n\na) **Debye Length $\\lambda_D$**:\n$$ \\lambda_D = \\sqrt{\\frac{(8.854 \\times 10^{-12}) \\times 78.5 \\times (1.381 \\times 10^{-23}) \\times 298}{2 \\times (1.602 \\times 10^{-19})^2 \\times (6.022 \\times 10^{23}) \\times 150}} $$\n$$ \\lambda_D = \\sqrt{\\frac{2.862 \\times 10^{-30}}{4.633 \\times 10^{-12}}} \\,\\mathrm{m} = \\sqrt{6.179 \\times 10^{-19}} \\,\\mathrm{m} $$\n$$ \\lambda_D = 7.861 \\times 10^{-10} \\,\\mathrm{m} = 0.7861 \\,\\mathrm{nm} $$\nRounded to three significant figures, $\\lambda_D = 0.786\\,\\mathrm{nm}$.\n\nb) **Dimensionless Screened Energies $U(r)/(k_B T)$**:\nThe dimensionless energy is:\n$$ \\frac{U(r)}{k_B T} = -\\frac{e^2}{4\\pi\\varepsilon_0 \\varepsilon_r k_B T r} \\exp(-r/\\lambda_D) $$\nThe prefactor $\\frac{e^2}{4\\pi\\varepsilon_0 \\varepsilon_r k_B T}$ is the Bjerrum length, $l_B$, for this medium.\n$$ l_B = \\frac{(1.602 \\times 10^{-19})^2}{4\\pi \\times (8.854 \\times 10^{-12}) \\times 78.5 \\times (1.381 \\times 10^{-23}) \\times 298} = 7.144 \\times 10^{-10}\\,\\mathrm{m} = 0.7144\\,\\mathrm{nm} $$\nSo the expression simplifies to $\\frac{U(r)}{k_B T} = -\\frac{l_B}{r} \\exp(-r/\\lambda_D)$.\n\nFor $r_1 = 1\\,\\mathrm{nm}$:\n$$ \\frac{U(r_1)}{k_B T} = -\\frac{0.7144\\,\\mathrm{nm}}{1\\,\\mathrm{nm}} \\exp\\left(-\\frac{1\\,\\mathrm{nm}}{0.7861\\,\\mathrm{nm}}\\right) = -0.7144 \\times \\exp(-1.272) = -0.7144 \\times 0.2798 = -0.1999 $$\nRounded to three significant figures, $\\frac{U(r_1)}{k_B T} = -0.200$.\n\nFor $r_2 = 5\\,\\mathrm{nm}$:\n$$ \\frac{U(r_2)}{k_B T} = -\\frac{0.7144\\,\\mathrm{nm}}{5\\,\\mathrm{nm}} \\exp\\left(-\\frac{5\\,\\mathrm{nm}}{0.7861\\,\\mathrm{nm}}\\right) = -0.1429 \\times \\exp(-6.360) = -0.1429 \\times 0.001729 $$\n$$ \\frac{U(r_2)}{k_B T} = -0.0002470 $$\nRounded to three significant figures, $\\frac{U(r_2)}{k_B T} = -2.47 \\times 10^{-4}$.\n\nThe final results are $\\lambda_D = 0.786\\,\\mathrm{nm}$, $U(r_1)/(k_B T) = -0.200$, and $U(r_2)/(k_B T) = -2.47 \\times 10^{-4}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.786 & -0.200 & -2.47 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}