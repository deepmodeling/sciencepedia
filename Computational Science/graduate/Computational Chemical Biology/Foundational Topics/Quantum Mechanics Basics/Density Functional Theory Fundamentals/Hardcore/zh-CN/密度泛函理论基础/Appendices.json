{
    "hands_on_practices": [
        {
            "introduction": "Kohn-Sham能量泛函由几个不同的部分组成：无相互作用动能、外势能、经典的Hartree排斥能以及神秘的交换相关能。为了真正掌握这些概念，研究一个每个能量项都能被精确计算的体系是极具价值的。这个练习将引导你分析一个精确可解的双电子模型，让你能够剖析总能量，并精确地观察每个组分如何贡献，从而揭示交换相关能作为补全整个图像的“余项”的本质。",
            "id": "2384996",
            "problem": "考虑一个一维、自旋补偿的双电子体系，采用原子单位制（哈特里原子单位制，其中电子质量、基本电荷和约化普朗克常数均设为1）。该体系的外势为谐振子势，电子-电子相互作用为谐性排斥势。哈密顿量为\n$$\n\\hat{H} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} + \\frac{1}{2}\\omega^2 \\left(x_1^2 + x_2^2\\right) + \\frac{k}{2}\\left(x_1 - x_2\\right)^2,\n$$\n其中参数 $\\omega \\gt 0$ 且 $k \\ge 0$。请在密度泛函理论（DFT; density functional theory）的框架下，将精确的基态总能量分解为以下几项：\n- 无相互作用的 Kohn–Sham（KS; Kohn–Sham）动能 $T_s$。\n- 外势能 $E_{ext}$。\n- 对应于给定电子-电子相互作用的哈特里（Hartree）能量 $E_H$。\n- 交换关联能 $E_{xc}$。\n\n您的任务是从第一性原理出发，推导如何精确计算该模型中各项能量贡献，并将其实现为一个程序。\n\n仅使用以下基本出发点和定义：\n- 将双体哈密顿量分离为质心坐标和相对坐标，以获得精确的基态能量 $E_{tot}$ 和精确的单电子密度 $n(x)$。\n- 对于占据单一空间轨道的自旋补偿双电子体系，其精确的 Kohn–Sham 动能等于 Weizsäcker 动能泛函\n$$\nT_s[n] = \\frac{1}{8}\\int_{-\\infty}^{\\infty} \\frac{\\left(\\frac{dn}{dx}\\right)^2}{n(x)}\\,dx.\n$$\n- 外势能为\n$$\nE_{ext}[n] = \\int_{-\\infty}^{\\infty} n(x)\\, v_{ext}(x)\\, dx, \\quad v_{ext}(x) = \\frac{1}{2}\\omega^2 x^2.\n$$\n- 对于给定的对势，哈特里（Hartree）能量为\n$$\nE_H[n] = \\frac{1}{2}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} n(x)\\, n(x')\\, w(x-x')\\, dx\\, dx', \\quad w(x-x') = \\frac{k}{2}(x-x')^2.\n$$\n- 交换关联能由下式剩余定义\n$$\nE_{xc} = E_{tot} - T_s - E_{ext} - E_H,\n$$\n其中 $E_{tot}$ 是 $\\hat{H}$ 的精确基态能量。\n\n所有能量以哈特里（Hartree）为单位表示。报告的每项能量均四舍五入至八位小数。\n\n测试组：\n- 情况1（理想情况，无相互作用极限）：$\\omega = 1.0$, $k = 0.0$。\n- 情况2（中等相互作用）：$\\omega = 1.0$, $k = 0.5$。\n- 情况3（弱束缚，强相互作用）：$\\omega = 0.5$, $k = 2.0$。\n- 情况4（强束缚，强相互作用）：$\\omega = 2.0$, $k = 5.0$。\n\n您的程序必须为每个测试用例计算并返回一个包含五个浮点数的列表\n$$\n\\left[ T_s,\\; E_{ext},\\; E_H,\\; E_{xc},\\; E_{tot} \\right]\n$$\n每项均四舍五入至八位小数，单位为哈特里（Hartree）。最终输出必须是单行文本，包含一个由四个用例列表组成的顶层列表，且不含空格。例如，格式必须为\n$$\n\\left[\\left[T_s^{(1)},E_{ext}^{(1)},E_H^{(1)},E_{xc}^{(1)},E_{tot}^{(1)}\\right],\\ldots,\\left[T_s^{(4)},E_{ext}^{(4)},E_H^{(4)},E_{xc}^{(4)},E_{tot}^{(4)}\\right]\\right]\n$$\n但需用实际数值代替符号，且不含任何空白字符。程序不应读取任何用户输入；它必须能直接运行，并仅打印这单行输出。",
            "solution": "该问题要求为一个具有谐性束缚和和谐性电子-电子排斥的一维双电子体系，计算其密度泛函理论（DFT）的能量分量。解法必须从第一性原理推导得出。\n\n出发点是原子单位制（$\\hbar=m_e=e=1$）下的哈密顿量：\n$$\n\\hat{H} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} + \\frac{1}{2}\\omega^2 \\left(x_1^2 + x_2^2\\right) + \\frac{k}{2}\\left(x_1 - x_2\\right)^2\n$$\n\n**第1步：薛定谔方程的精确解**\n\n为求得精确的基态能量 $E_{tot}$ 和单电子密度 $n(x)$，我们求解双体薛定谔方程 $\\hat{H}\\Psi(x_1, x_2) = E\\Psi(x_1, x_2)$。这通过变换到质心坐标（$R$）和相对坐标（$r$）来实现：\n$$\nR = \\frac{x_1 + x_2}{2}, \\quad r = x_1 - x_2\n$$\n动能算符变换为：\n$$\n-\\frac{1}{2}\\left(\\frac{\\partial^2}{\\partial x_1^2} + \\frac{\\partial^2}{\\partial x_2^2}\\right) = -\\frac{1}{2}\\left(\\frac{1}{2}\\frac{\\partial^2}{\\partial R^2} + 2\\frac{\\partial^2}{\\partial r^2}\\right) = -\\frac{1}{2(2)}\\frac{\\partial^2}{\\partial R^2} - \\frac{1}{2(1/2)}\\frac{\\partial^2}{\\partial r^2}\n$$\n这代表了两个粒子：一个质量为 $M=2$ 的质心粒子和一个约化质量为 $\\mu=1/2$ 的相对粒子。势能项变换为：\n$$\n\\frac{1}{2}\\omega^2(x_1^2 + x_2^2) = \\frac{1}{2}\\omega^2 \\left(2R^2 + \\frac{r^2}{2}\\right) = \\omega^2 R^2 + \\frac{\\omega^2}{4}r^2\n$$\n相互作用势即为 $\\frac{k}{2}r^2$。哈密顿量可分离为两个独立的部分，$\\hat{H} = \\hat{H}_R + \\hat{H}_r$：\n$$\n\\hat{H}_R = -\\frac{1}{4}\\frac{\\partial^2}{\\partial R^2} + \\omega^2 R^2 = -\\frac{1}{2(2)}\\frac{\\partial^2}{\\partial R^2} + \\frac{1}{2}(2)\\omega^2 R^2\n$$\n$$\n\\hat{H}_r = -\\frac{\\partial^2}{\\partial r^2} + \\frac{\\omega^2}{4}r^2 + \\frac{k}{2}r^2 = -\\frac{1}{2(1/2)}\\frac{\\partial^2}{\\partial r^2} + \\frac{1}{2}\\left(\\frac{1}{2}\\right)(\\omega^2+2k)r^2\n$$\n$\\hat{H}_R$ 和 $\\hat{H}_r$ 都是标准的量子谐振子（QHO）哈密顿量。\n对于质心运动，质量为 $M=2$，频率为 $\\Omega_R=\\omega$。基态能量为 $E_R^{(0)} = \\frac{1}{2}\\Omega_R = \\frac{1}{2}\\omega$。\n对于相对运动，质量为 $\\mu=1/2$，频率为 $\\Omega_r=\\sqrt{\\omega^2+2k}$。基态能量为 $E_r^{(0)} = \\frac{1}{2}\\Omega_r = \\frac{1}{2}\\sqrt{\\omega^2+2k}$。\n\n精确的基态总能量是这两部分能量之和：\n$$\nE_{tot} = E_R^{(0)} + E_r^{(0)} = \\frac{1}{2}\\omega + \\frac{1}{2}\\sqrt{\\omega^2+2k}\n$$\n\n**第2步：精确单电子密度的推导**\n\n基态波函数是每种模式下量子谐振子基态波函数的乘积：$\\Psi_0(R, r) = \\Phi_R^{(0)}(R) \\Phi_r^{(0)}(r)$。单电子密度 $n(x)$ 可通过将双电子概率密度对其中一个电子的坐标进行积分，再乘以电子数（$N=2$）得到：\n$$\nn(x_1) = 2 \\int_{-\\infty}^{\\infty} |\\Psi_0(\\frac{x_1+x_2}{2}, x_1-x_2)|^2 dx_2\n$$\n基态概率密度是高斯函数：$|\\Phi_R^{(0)}(R)|^2 \\propto e^{-2\\omega R^2}$ 和 $|\\Phi_r^{(0)}(r)|^2 \\propto e^{-\\frac{1}{2}\\sqrt{\\omega^2+2k} r^2}$。对 $x_2$ 进行高斯积分，得到单电子密度 $n(x)$，它也是一个高斯函数：\n$$\nn(x) = C e^{-\\alpha x^2}\n$$\n其中衰减常数 $\\alpha$ 被求得为：\n$$\n\\alpha = \\frac{2\\omega\\sqrt{\\omega^2+2k}}{\\omega+\\sqrt{\\omega^2+2k}}\n$$\n归一化常数 $C$ 由条件 $\\int_{-\\infty}^{\\infty} n(x)dx=2$ 确定，得出 $C = 2\\sqrt{\\alpha/\\pi}$。\n\n**第3步：DFT 能量分量的计算**\n\n有了精确密度 $n(x)$，我们现在可以使用给定的定义来计算 DFT 的能量分量。\n\n**Kohn-Sham 动能 ($T_s$)**：对于此双电子体系，$T_s$ 由 Weizsäcker 泛函给出。\n$$\nT_s[n] = \\frac{1}{8}\\int_{-\\infty}^{\\infty} \\frac{\\left(\\frac{dn}{dx}\\right)^2}{n(x)}\\,dx\n$$\n我们有 $\\frac{dn}{dx} = -2\\alpha x \\cdot n(x)$。将其代入积分：\n$$\nT_s = \\frac{1}{8}\\int \\frac{4\\alpha^2 x^2 (n(x))^2}{n(x)} dx = \\frac{\\alpha^2}{2}\\int x^2 n(x) dx\n$$\n密度的二阶矩为 $\\int x^2 n(x)dx = 1/\\alpha$。\n$$\nT_s = \\frac{\\alpha^2}{2} \\left(\\frac{1}{\\alpha}\\right) = \\frac{\\alpha}{2}\n$$\n\n**外势能 ($E_{ext}$)**：\n$$\nE_{ext}[n] = \\int_{-\\infty}^{\\infty} n(x) v_{ext}(x) dx = \\int_{-\\infty}^{\\infty} n(x)\\left(\\frac{1}{2}\\omega^2 x^2\\right) dx = \\frac{\\omega^2}{2}\\int x^2 n(x) dx\n$$\n再次使用 $\\int x^2 n(x)dx = 1/\\alpha$：\n$$\nE_{ext} = \\frac{\\omega^2}{2\\alpha}\n$$\n\n**哈特里能量 ($E_H$)**：对于给定的相互作用 $w(x-x') = \\frac{k}{2}(x-x')^2$ 的定义为：\n$$\nE_H[n] = \\frac{1}{2}\\iint n(x)n(x') \\frac{k}{2}(x-x')^2 dx dx' = \\frac{k}{4} \\iint n(x)n(x')(x^2 - 2xx' + x'^2) dx dx'\n$$\n展开并使用密度的各阶矩：$\\int n(x)dx = 2$，$\\int xn(x)dx = 0$（由对称性可知），以及 $\\int x^2 n(x)dx = 1/\\alpha$：\n$$\nE_H = \\frac{k}{4} \\left[ \\left(\\int n(x')dx'\\right)\\left(\\int x^2n(x)dx\\right) - 2\\left(\\int xn(x)dx\\right)^2 + \\left(\\int n(x)dx\\right)\\left(\\int x'^2n(x')dx'\\right) \\right]\n$$\n$$\nE_H = \\frac{k}{4} \\left[ (2)\\left(\\frac{1}{\\alpha}\\right) - 2(0)^2 + (2)\\left(\\frac{1}{\\alpha}\\right) \\right] = \\frac{k}{4}\\left(\\frac{4}{\\alpha}\\right) = \\frac{k}{\\alpha}\n$$\n\n**交换关联能 ($E_{xc}$)**：此项被定义为总能量的剩余部分：\n$$\nE_{xc} = E_{tot} - T_s - E_{ext} - E_H\n$$\n代入各项的推导表达式即可进行数值计算。\n\n**公式总结**：\n对于给定的参数对 $(\\omega, k)$：\n1. 定义一个辅助频率：$\\Omega_r = \\sqrt{\\omega^2 + 2k}$。\n2. 定义密度参数：$\\alpha = \\frac{2\\omega\\Omega_r}{\\omega+\\Omega_r}$。\n3. 总能量为：$E_{tot} = \\frac{1}{2}(\\omega + \\Omega_r)$。\n4. KS 动能为：$T_s = \\frac{\\alpha}{2}$。\n5. 外势能为：$E_{ext} = \\frac{\\omega^2}{2\\alpha}$。\n6. 哈特里能量为：$E_H = \\frac{k}{\\alpha}$。\n7. 交换关联能为：$E_{xc} = E_{tot} - T_s - E_{ext} - E_H$。\n这些公式在所提供的程序中得以实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a 1D two-electron system with harmonic confinement and interaction.\n\n    The problem asks to calculate DFT energy components (Ts, Eext, EH, Exc) and the\n    exact total energy (Etot) for a model system described by the Hamiltonian:\n    H = -1/2 * d^2/dx1^2 - 1/2 * d^2/dx2^2 + 1/2*w^2*(x1^2+x2^2) + k/2*(x1-x2)^2\n\n    The derivations in the solution lead to the following analytical formulas:\n    1. Helper frequency for relative motion: Omega_r = sqrt(w^2 + 2k)\n    2. Density decay parameter: alpha = (2 * w * Omega_r) / (w + Omega_r)\n    3. Total energy: Etot = 1/2 * (w + Omega_r)\n    4. KS kinetic energy: Ts = alpha / 2\n    5. External potential energy: Eext = w^2 / (2 * alpha)\n    6. Hartree energy: EH = k / alpha\n    7. Exchange-correlation energy: Exc = Etot - Ts - Eext - EH\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    test_cases = [\n        (1.0, 0.0),  # Case 1: noninteracting limit\n        (1.0, 0.5),  # Case 2: moderate interaction\n        (0.5, 2.0),  # Case 3: weak trap, strong interaction\n        (2.0, 5.0),  # Case 4: strong trap, strong interaction\n    ]\n\n    all_results = []\n    \n    for omega, k in test_cases:\n        # Step 1: Calculate the helper frequency for the relative coordinate.\n        # Omega_r = sqrt(omega^2 + 2*k)\n        omega_r = np.sqrt(omega**2 + 2 * k)\n\n        # Step 2: Calculate the density parameter alpha.\n        # This parameter defines the Gaussian shape of the one-electron density n(x).\n        # alpha = (2 * omega * omega_r) / (omega + omega_r)\n        alpha = (2 * omega * omega_r) / (omega + omega_r)\n\n        # Step 3: Calculate the total ground-state energy E_tot.\n        # E_tot is the sum of the ground-state energies of the center-of-mass and relative oscillators.\n        e_tot = 0.5 * (omega + omega_r)\n\n        # Step 4: Calculate the non-interacting Kohn-Sham kinetic energy T_s.\n        # For this 2-electron system, T_s is exactly the Weizsäcker kinetic energy.\n        t_s = alpha / 2.0\n\n        # Step 5: Calculate the external potential energy E_ext.\n        e_ext = (omega**2) / (2.0 * alpha)\n\n        # Step 6: Calculate the Hartree energy E_H for the harmonic repulsion.\n        # For k=0, alpha  0, so EH is 0. If k  0, EH is positive.\n        e_h = k / alpha\n\n        # Step 7: Calculate the exchange-correlation energy E_xc residually.\n        # E_xc is defined as what's left after subtracting the other components from the exact total energy.\n        e_xc = e_tot - t_s - e_ext - e_h\n\n        # Collect the results for the current case, rounded to 8 decimal places.\n        case_results = [\n            round(t_s, 8),\n            round(e_ext, 8),\n            round(e_h, 8),\n            round(e_xc, 8),\n            round(e_tot, 8),\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists, without any spaces.\n    # e.g., [[-1.0,-1.0],[-2.0,-2.0]]\n    result_str_list = []\n    for res_list in all_results:\n        # Format each number to 8 decimal places\n        formatted_nums = [f\"{x:.8f}\" for x in res_list]\n        result_str_list.append(f\"[{','.join(formatted_nums)}]\")\n    \n    final_output = f\"[{','.join(result_str_list)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "密度泛函理论(DFT)的主要目标之一是预测化学性质。这项实践通过关注电子亲和能，在理论计算和实验可观测量之间架起了一座桥梁。你将使用基于总能量差的严格定义来计算此性质，并将其与从Kohn-Sham轨道能量推导出的一个常用近似值进行比较。这个比较不仅仅是一个数值练习，它为了解近似交换相关泛函的一个微妙但重要的缺陷——即所谓的“导数不连续性”问题——提供了一个直接的窗口。",
            "id": "2384969",
            "problem": "你需要实现一个完整、可运行的程序，根据提供的总能量计算氧原子的电子亲和能，并将其与最低未占分子轨道 (LUMO) 的科恩-尚特征值的负值进行比较。该任务必须在密度泛函理论 (DFT) 的框架内，采用第一性原理方法来完成。\n\n给定以下基础作为有效的出发点：\n- 霍恩伯格-科恩定理建立了基态密度与外势之间的一一对应关系，因此基态总能量是电子密度的泛函。\n- 在科恩-尚密度泛函理论 (KS-DFT) 中，使用一个具有相同基态密度的无相互作用参考体系来定义科恩-尚轨道和特征值。\n- 电子亲和能定义为在固定原子核位置的情况下增加一个电子时基态能量的变化。如果中性体系有 $N$ 个电子，阴离子有 $N+1$ 个电子，则电子亲和能定义为 $A = E(N) - E(N+1)$，其中 $E(N)$ 和 $E(N+1)$ 分别是中性体系和阴离子的基态总能量。\n- 最低未占分子轨道的科恩-尚特征值，记为 $\\epsilon_{\\mathrm{LUMO}}$，是中性 $N$ 电子科恩-尚体系的一个性质。在精确的 KS-DFT 中，$-\\epsilon_{\\mathrm{HOMO}}$ 等于电离能，但对于电子亲和能， $A$ 和 $-\\epsilon_{\\mathrm{LUMO}}$ 之间的关系涉及到交换相关导数不连续性，因此在使用近似泛函时，$-\\epsilon_{\\mathrm{LUMO}}$通常与 $A$ 不同。\n\n你必须为每个测试用例计算以下内容：\n- 以电子伏特为单位的电子亲和能 $A$，定义为 $A = E(N) - E(N+1)$，其中 $E(N)$ 和 $E(N+1)$ 以哈特里 (Hartree) 为单位给出。\n- 以电子伏特为单位的量 $-\\epsilon_{\\mathrm{LUMO}}$，其中 $\\epsilon_{\\mathrm{LUMO}}$ 由 $N$ 电子科恩-尚计算以哈特里 (Hartree) 为单位给出。\n- 上述两个量之间以电子伏特为单位的绝对差值。\n\n使用换算因子 $1$ 哈特里 $= 27.211386245988$ 电子伏特。所有输出都必须以电子伏特表示，并四舍五入到小数点后六位。\n\n实现程序以使用以下测试套件（每个元组为 $(E(N), E(N+1), \\epsilon_{\\mathrm{LUMO}})$，单位为哈特里）：\n- 测试用例 1：$(-75.000000, -75.053700, +0.010000)$。\n- 测试用例 2：$(-75.100000, -75.150000, -0.020000)$。\n- 测试用例 3：$(-74.900000, -74.910000, +0.050000)$。\n- 测试用例 4：$(-75.020000, -75.019000, +0.020000)$。\n\n你的程序应该：\n- 对于每个测试用例，计算 $A_{\\mathrm{eV}} = \\left(E(N) - E(N+1)\\right) \\times 27.211386245988$，$(-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}} = -\\epsilon_{\\mathrm{LUMO}} \\times 27.211386245988$，以及 $\\Delta_{\\mathrm{eV}} = \\left|A_{\\mathrm{eV}} - (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}\\right|$。\n- 将 $A_{\\mathrm{eV}}$、$(-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}$ 和 $\\Delta_{\\mathrm{eV}}$ 四舍五入到小数点后六位。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个列表的列表，每个内部列表对应一个测试用例，其中包含三个浮点数，顺序为 $[A_{\\mathrm{eV}}, (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}, \\Delta_{\\mathrm{eV}}]$，所有数值都四舍五入到小数点后六位。例如：$[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$。\n\n程序没有用户输入。所有数值常量和测试数据都必须嵌入到程序中。所有最终数值输出都以电子伏特表示，并四舍五入到小数点后六位。",
            "solution": "所述问题是有效的。它在科学上基于密度泛函理论 (DFT) 的原理，自成体系，包含了所有必要的数据和定义，并且在算法上是适定的。不存在矛盾、歧义或事实不准确之处。因此，我们可以直接进行求解。\n\n目标是计算一个体系的电子亲和能 ($A$)，将其与科恩-尚 (KS) 最低未占分子轨道 (LUMO) 特征值的负值 ($-\\epsilon_{\\mathrm{LUMO}}$) 进行比较，并量化它们的差异。这些量在计算物理和计算化学中是解释原子和分子电子结构的基础。\n\n其理论基础源于 DFT。一个 $N$ 电子体系的基态总能量 $E(N)$ 是基态电子密度 $\\rho(\\mathbf{r})$ 的唯一泛函。在 KS-DFT 中，这个能量是通过一个能再现 $\\rho(\\mathbf{r})$ 的无相互作用参考体系来计算的，从而得到一组 KS 轨道 $\\phi_i$ 及其对应的特征值 $\\epsilon_i$。\n\n电子亲和能 $A$ 是一个热力学量，定义为中性 $N$ 电子体系与其对应的含 $N+1$ 个电子的阴离子之间的能量差。$E(N)$ 和 $E(N+1)$ 这两个能量都必须是各自电子数下的基态总能量。其定义为：\n$$\nA = E(N) - E(N+1)\n$$\n正值的 $A$ 表示阴离子在能量上比中性物种更稳定。所提供的能量以哈特里原子单位给出，必须转换为电子伏特 ($\\mathrm{eV}$)。\n\n第二个量 $-\\epsilon_{\\mathrm{LUMO}}$ 源自中性 $N$ 电子体系的 KS 特征值谱。LUMO 是在 $N$ 电子基态中未被占据的能量最低的 KS 轨道。根据雅纳克定理，KS 特征值 $\\epsilon_i$ 是总能量对轨道占据数 $n_i$ 的偏导数，即 $\\epsilon_i = \\partial E / \\partial n_i$。对于一个 $N$ 电子体系的 LUMO，$-\\epsilon_{\\mathrm{LUMO}}$ 可以被解释为对电子亲和能的一阶近似。然而，在任何近似的 DFT 泛函中，这种关系都不是精确的。$A$ 和 $-\\epsilon_{\\mathrm{LUMO}}$ 之间的差异是一个已知问题，主要归因于交换相关泛函的导数不连续性，而标准的连续泛函无法捕捉到这一点。本问题要求我们计算的正是这个差异。\n\n对于每个测试用例，给定以哈特里为单位的输入 $(E(N), E(N+1), \\epsilon_{\\mathrm{LUMO}})$，计算过程如下。我们使用换算因子 $C_{\\mathrm{conv}} = 27.211386245988 \\, \\mathrm{eV}/\\mathrm{Hartree}$。\n\n1.  **计算以 $\\mathrm{eV}$ 为单位的电子亲和能**：首先计算以哈特里为单位的电子亲和能 $A_{\\mathrm{Ha}}$。\n    $$\n    A_{\\mathrm{Ha}} = E(N) - E(N+1)\n    $$\n    然后将其转换为电子伏特：\n    $$\n    A_{\\mathrm{eV}} = A_{\\mathrm{Ha}} \\times C_{\\mathrm{conv}}\n    $$\n\n2.  **计算以 $\\mathrm{eV}$ 为单位的负 LUMO 能量**：LUMO 特征值 $\\epsilon_{\\mathrm{LUMO}}$ 以哈特里为单位给出。我们计算其负值并转换为电子伏特：\n    $$\n    (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}} = -\\epsilon_{\\mathrm{LUMO}} \\times C_{\\mathrm{conv}}\n    $$\n\n3.  **计算以 $\\mathrm{eV}$ 为单位的绝对差值**：电子亲和能与负 LUMO 能量之间的绝对差值 $\\Delta_{\\mathrm{eV}}$ 是根据未四舍五入的 $\\mathrm{eV}$ 值计算的，以保持精度。\n    $$\n    \\Delta_{\\mathrm{eV}} = |A_{\\mathrm{eV}} - (-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}|\n    $$\n\n4.  **四舍五入**：最后，将得到的三个值 $A_{\\mathrm{eV}}$、$(-\\epsilon_{\\mathrm{LUMO}})_{\\mathrm{eV}}$ 和 $\\Delta_{\\mathrm{eV}}$ 按要求四舍五入到小数点后六位。\n\n该过程将系统地应用于问题陈述中提供的所有测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron affinity, negative LUMO energy, and their difference\n    based on provided DFT total energies and Kohn-Sham eigenvalues.\n    \"\"\"\n    # Define the conversion factor from Hartree to electronvolts.\n    HARTREE_TO_EV = 27.211386245988\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (E(N), E(N+1), epsilon_LUMO) in Hartree.\n    test_cases = [\n        (-75.000000, -75.053700, 0.010000),\n        (-75.100000, -75.150000, -0.020000),\n        (-74.900000, -74.910000, 0.050000),\n        (-75.020000, -75.019000, 0.020000),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        e_n, e_n_plus_1, eps_lumo = case\n\n        # 1. Calculate Electron Affinity (A) in eV\n        # A = E(N) - E(N+1)\n        a_hartree = e_n - e_n_plus_1\n        a_ev = a_hartree * HARTREE_TO_EV\n\n        # 2. Calculate the negative LUMO energy in eV\n        # This is -epsilon_LUMO\n        neg_eps_lumo_ev = -eps_lumo * HARTREE_TO_EV\n\n        # 3. Calculate the absolute difference in eV\n        # Delta = |A_eV - (-epsilon_LUMO)_eV|\n        delta_ev = abs(a_ev - neg_eps_lumo_ev)\n\n        # 4. Round all results to six decimal places\n        a_ev_rounded = round(a_ev, 6)\n        neg_eps_lumo_ev_rounded = round(neg_eps_lumo_ev, 6)\n        delta_ev_rounded = round(delta_ev, 6)\n\n        # Store the results for this test case\n        all_results.append([a_ev_rounded, neg_eps_lumo_ev_rounded, delta_ev_rounded])\n\n    # Format the final output string to match the required format: [[a1,b1,c1],[a2,b2,c2],...]\n    # This construction avoids extra spaces that str(list) would introduce.\n    output_parts = []\n    for res_list in all_results:\n        # Format a, b, c as floats to ensure decimal point is present even for whole numbers.\n        part = f\"[{res_list[0]},{res_list[1]},{res_list[2]}]\"\n        output_parts.append(part)\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\n# Execute the solver function.\nsolve()\n```"
        },
        {
            "introduction": "任何DFT计算的准确性都取决于交换相关泛函的质量。局域密度近似(LDA)是最简单、最基础的近似方法。这个练习旨在挑战你批判性地思考其有效范围及其最著名的缺陷。通过分析其在两个极端情况——均匀电子气和单个孤立电子——中的表现，你将巩固对LDA为何对其母系统是精确的，但却会产生非物理性的自相互作用误差这一问题的理解，而后者正是推动更复杂泛函发展的关键驱动力。",
            "id": "2385007",
            "problem": "考虑 Kohn–Sham 密度泛函理论 (DFT) 框架下的两个体系：(i) 一个三维均匀电子气 (UEG)，其电子密度为常数 $n_{0}$，并被均匀正背景电荷中和，以及 (ii) 一个被限制在边长为 $L$ 的三维无限深势阱（立方盒子）中的单电子。在 Kohn–Sham DFT 中，总能量泛函写作 $E[n] = T_{s}[n] + \\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r} + E_{H}[n] + E_{xc}[n]$，其中 $T_{s}[n]$ 是无相互作用动能，$v_{\\mathrm{ext}}(\\mathbf{r})$ 是外势，$E_{H}[n]$ 是 Hartree 能量，$E_{xc}[n]$ 是交换相关能。Hartree 能量定义为\n$$\nE_{H}[n] = \\frac{1}{2}\\int\\!\\!\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'。\n$$\n在局域密度近似 (LDA) 中，交换相关 (XC) 能近似为\n$$\nE_{xc}^{\\mathrm{LDA}}[n] = \\int n(\\mathbf{r})\\,\\varepsilon_{xc}^{\\mathrm{unif}}(n(\\mathbf{r}))\\,d\\mathbf{r},\n$$\n其中 $\\varepsilon_{xc}^{\\mathrm{unif}}(n)$ 是密度为 $n$ 的均匀电子气中每个粒子的 XC 能量。\n\n仅使用上述定义以及关于精确交换相关空穴和密度均匀坐标标度的普遍接受的性质，回答以下问题。选择所有正确的陈述。\n\nA. 在均匀电子气中，由于 $n(\\mathbf{r}) = n_{0}$ 是一个常数，局域密度近似可以精确地计算 $E_{xc}[n]$，因为精确的交换相关能量密度具有平移不变性，并且仅依赖于 $n_{0}$。\n\nB. 对于任何单电子体系，精确的交换相关泛函满足 $E_{xc}[n] = -E_{H}[n]$，因此 $E_{H}[n] + E_{xc}[n] = 0$，而通常情况下 $E_{H}[n] + E_{xc}^{\\mathrm{LDA}}[n] \\neq 0$（自相互作用误差）。\n\nC. 局域密度近似对单电子体系失效的主要原因是，在整数粒子数处交换相关势的导数不连续性的缺失。\n\nD. 对于立方无限深势阱中的单个电子，如果将其建模为自旋非极化的，那么 $E_{xc}^{\\mathrm{LDA}}[n]$ 会精确地抵消 $E_{H}[n]$。\n\nE. 对于边长为 $L$ 的立方盒子中的归一化单电子密度，在均匀坐标标度 $n_{L}(\\mathbf{r}) = L^{-3} n(\\mathbf{r}/L)$ 下，$E_{H}[n_{L}]$ 和 LDA 交换能 $E_{x}^{\\mathrm{LDA}}[n_{L}]$ 都与 $L^{-1}$ 成比例，因此绝对自相互作用误差在 $L \\to \\infty$ 时衰减至零，但在任何有限的 $L$ 值下都不会消失。",
            "solution": "问题陈述经核实是科学上合理的、问题定义良好的和客观的。它包含了密度泛函理论中的标准定义和概念。我们将继续分析每个陈述。\n\n在 Kohn-Sham DFT 中，总能量泛函由 $E[n] = T_{s}[n] + E_{\\text{ext}}[n] + E_{H}[n] + E_{xc}[n]$ 给出，其中 $E_{\\text{ext}}[n] = \\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r}$。\n\nA. 在均匀电子气中，由于 $n(\\mathbf{r}) = n_{0}$ 是一个常数，局域密度近似可以精确地计算 $E_{xc}[n]$，因为精确的交换相关能量密度具有平移不变性，并且仅依赖于 $n_{0}$。\n\n该陈述是正确的。交换相关能的局域密度近似 (LDA) 定义为 $E_{xc}^{\\mathrm{LDA}}[n] = \\int n(\\mathbf{r})\\,\\varepsilon_{xc}^{\\mathrm{unif}}(n(\\mathbf{r}))\\,d\\mathbf{r}$，其中 $\\varepsilon_{xc}^{\\mathrm{unif}}(n)$ 是密度为 $n$ 的均匀电子气 (UEG) 中每个粒子的交换相关能。根据其构造方式，LDA 就是为使其参数来源的体系（即 UEG）而设计的精确方法。\n对于 UEG，电子密度是常数，$n(\\mathbf{r}) = n_{0}$。将 LDA 公式应用于该体系，得到：\n$$\nE_{xc}^{\\mathrm{LDA}}[n_0] = \\int n_0 \\, \\varepsilon_{xc}^{\\mathrm{unif}}(n_0) \\, d\\mathbf{r} = n_0 \\, \\varepsilon_{xc}^{\\mathrm{unif}}(n_0) \\int d\\mathbf{r} = n_0 \\, \\varepsilon_{xc}^{\\mathrm{unif}}(n_0) \\, V\n$$\n其中 $V$ 是体系的体积。总电子数是 $N = n_0 V$。因此，$E_{xc}^{\\mathrm{LDA}}[n_0] = N \\varepsilon_{xc}^{\\mathrm{unif}}(n_0)$。这恰好是 UEG 总交换相关能的定义。关于能量密度具有平移不变性的推理也是正确的；在均匀体系中，局域性质与全局性质相同，这使得局域近似变得精确。\n结论：**正确**。\n\nB. 对于任何单电子体系，精确的交换相关泛函满足 $E_{xc}[n] = -E_{H}[n]$，因此 $E_{H}[n] + E_{xc}[n] = 0$，而通常情况下 $E_{H}[n] + E_{xc}^{\\mathrm{LDA}}[n] \\neq 0$（自相互作用误差）。\n\n该陈述也是正确的。在单电子体系中，不存在电子-电子相互作用。总能量只是电子动能及其与外势相互作用之和，$E_{\\text{exact}} = T + V_{\\text{ext}}$。在 Kohn-Sham 形式体系中，多体效应被划分为 Hartree 能量 $E_{H}[n]$ 和交换相关能 $E_{xc}[n]$。Hartree 能量 $E_{H}[n] = \\frac{1}{2}\\int\\!\\!\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'$，代表电荷密度 $n(\\mathbf{r})$ 与自身的经典静电排斥。对于单个电子，这是一种虚假的自相互作用。为了使 Kohn-Sham 总能量等于精确能量，这个虚假的项必须被抵消。因此，精确的交换相关泛函必须满足 $E_{H}[n] + E_{xc}^{\\mathrm{exact}}[n] = 0$。这意味着 $E_{xc}^{\\mathrm{exact}}[n] = -E_{H}[n]$。注意，对于单电子体系，交换能精确地抵消了 Hartree 能量，而相关能为零。\n然而，像 LDA 这样的近似泛函不满足此条件。对于典型的单电子密度，$E_{H}[n]$ 和 $E_{xc}^{\\mathrm{LDA}}[n]$ 都非零，它们的和也非零：$E_{H}[n] + E_{xc}^{\\mathrm{LDA}}[n] \\neq 0$。这种不抵消就是众所周知的 LDA 的自相互作用误差。\n结论：**正确**。\n\nC. 局域密度近似对单电子体系失效的主要原因是，在整数粒子数处交换相关势的导数不连续性的缺失。\n\n该陈述是错误的。虽然导数不连续性的缺失是 LDA 的一个显著失败之处，但它不是其在单电子体系中失败的“主要原因”。主要且最直接的失败是自相互作用误差，如陈述 B 所述。电子不与自身相互作用，然而在 LDA 计算中，单电子密度会产生一个作用于该电子的虚假 Hartree 势，而 LDA 交换相关势并不能完全抵消这种非物理效应。这是一个存在于固定整数电子数（$N=1$）体系的单次计算中的基本错误。\nXC 势的导数不连续性，$\\Delta_{xc} = \\lim_{\\delta \\to 0^+} [v_{xc}^{N+\\delta}(\\mathbf{r}) - v_{xc}^{N-\\delta}(\\mathbf{r})]$，是与粒子数 $N$ 穿过整数时能量变化相关的一个性质。在 LDA 中缺少这一点会导致严重低估带隙、对电荷转移的描述不正确以及对电子亲和能的预测不佳。这些问题涉及具有不同粒子数的体系之间的能量差异（例如 $E(N+1)-E(N)$）。自相互作用误差是一个更根本的问题，它内在于对 $N=1$ 体系本身的描述中。\n结论：**错误**。\n\nD. 对于立方无限深势阱中的单个电子，如果将其建模为自旋非极化的，那么 $E_{xc}^{\\mathrm{LDA}}[n]$ 会精确地抵消 $E_{H}[n]$。\n\n该陈述是错误的。首先，单个电子本质上是一个完全自旋极化的体系。将其建模为“自旋非极化”的（$n_\\uparrow = n_\\downarrow = n/2$）是一种非物理的构造。其次，即使进行这种非物理计算，也没有理由会发生精确抵消。Hartree 能量 $E_H[n]$ 是密度 $n(\\mathbf{r})$ 的非局域泛函。非极化的 LDA 交换相关能是一个局域泛函，$E_{xc}^{\\mathrm{LDA}}[n] = \\int f(n(\\mathbf{r})) d\\mathbf{r}$（例如，对于纯交换情况，$f(n) \\propto n^{4/3}$）。$E_H[n]$ 和 $E_{xc}^{\\mathrm{LDA}}[n]$ 的数学形式完全不同。对于像箱中粒子这样特定的非平凡密度分布，发生精确抵消将是一个非同寻常的巧合，而不是一个普遍性质。这种情况不会发生。\n结论：**错误**。\n\nE. 对于边长为 $L$ 的立方盒子中的归一化单电子密度，在均匀坐标标度 $n_{L}(\\mathbf{r}) = L^{-3} n(\\mathbf{r}/L)$ 下，$E_{H}[n_{L}]$ 和 LDA 交换能 $E_{x}^{\\mathrm{LDA}}[n_{L}]$ 都与 $L^{-1}$ 成比例，因此绝对自相互作用误差在 $L \\to \\infty$ 时衰减至零，但在任何有限的 $L$ 值下都不会消失。\n\n该陈述是正确的。让我们分析其标度行为。标度变换为 $n_L(\\mathbf{r}) = L^{-3} n_1(\\mathbf{r}/L)$，其中 $n_1$ 是边长 $L=1$ 的盒子中的密度。这正确地描述了边长为 $L$ 的盒子中粒子的基态密度。\n让我们找出 Hartree 能量 $E_H[n_L]$ 的标度：\n$$\nE_H[n_L] = \\frac{1}{2}\\iint \\frac{n_L(\\mathbf{r})n_L(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}' = \\frac{1}{2}\\iint \\frac{L^{-6} n_1(\\mathbf{r}/L)n_1(\\mathbf{r}'/L)}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}'\n$$\n使用代换 $\\mathbf{u} = \\mathbf{r}/L$ 和 $\\mathbf{v} = \\mathbf{r}'/L$，我们有 $d\\mathbf{r}=L^3 d\\mathbf{u}$ 和 $d\\mathbf{r}'=L^3 d\\mathbf{v}$。\n$$\nE_H[n_L] = \\frac{1}{2}\\iint \\frac{L^{-6} n_1(\\mathbf{u})n_1(\\mathbf{v})}{|L\\mathbf{u}-L\\mathbf{v}|}(L^3 d\\mathbf{u})(L^3 d\\mathbf{v}) = \\frac{L^{-6}L^6}{L} \\left(\\frac{1}{2}\\iint \\frac{n_1(\\mathbf{u})n_1(\\mathbf{v})}{|\\mathbf{u}-\\mathbf{v}|}d\\mathbf{u}d\\mathbf{v}\\right) = \\frac{1}{L} E_H[n_1]\n$$\n所以，$E_H[n_L]$ 与 $L^{-1}$ 成比例。\n现在，让我们分析 LDA 交换能 $E_x^{\\mathrm{LDA}}[n_L]$。其泛函形式为 $E_x^{\\mathrm{LDA}}[n] = C_x \\int n(\\mathbf{r})^{4/3} d\\mathbf{r}$，其中 $C_x$ 为某个常数。\n$$\nE_x^{\\mathrm{LDA}}[n_L] = C_x \\int (n_L(\\mathbf{r}))^{4/3} d\\mathbf{r} = C_x \\int (L^{-3} n_1(\\mathbf{r}/L))^{4/3} d\\mathbf{r} = C_x L^{-4} \\int (n_1(\\mathbf{r}/L))^{4/3} d\\mathbf{r}\n$$\n使用代换 $\\mathbf{u} = \\mathbf{r}/L$：\n$$\nE_x^{\\mathrm{LDA}}[n_L] = C_x L^{-4} \\int (n_1(\\mathbf{u}))^{4/3} (L^3 d\\mathbf{u}) = \\frac{1}{L} \\left(C_x \\int (n_1(\\mathbf{u}))^{4/3} d\\mathbf{u}\\right) = \\frac{1}{L} E_x^{\\mathrm{LDA}}[n_1]\n$$\n所以，$E_x^{\\mathrm{LDA}}[n_L]$ 也与 $L^{-1}$ 成比例。在 $L \\to \\infty$ 的低密度极限下，同样的标度关系也适用于 LDA 相关能。绝对自相互作用误差为 $|E_H[n_L] + E_{xc}^{\\mathrm{LDA}}[n_L]|$。由于所有项都与 $L^{-1}$ 成比例，误差为 $|L^{-1}(E_H[n_1] + E_{xc}^{\\mathrm{LDA}}[n_1])| = L^{-1}|E_H[n_1] + E_{xc}^{\\mathrm{LDA}}[n_1]|$。正如在 B 中所确立的，当 $L=1$ 时误差不为零。因此，当 $L \\to \\infty$ 时误差按 $L^{-1}$ 衰减，并且在任何有限的 $L$ 值下都不为零。\n结论：**正确**。",
            "answer": "$$\\boxed{ABE}$$"
        }
    ]
}