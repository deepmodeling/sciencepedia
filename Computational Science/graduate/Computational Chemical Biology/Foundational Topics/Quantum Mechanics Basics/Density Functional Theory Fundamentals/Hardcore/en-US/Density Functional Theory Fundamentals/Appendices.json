{
    "hands_on_practices": [
        {
            "introduction": "To truly understand the components of the Kohn-Sham energy functional, it is invaluable to study a system where they can be determined exactly, free from any approximations. This practice explores such a system—a harmonically confined two-electron model—for which the Schrödinger equation is analytically solvable . By first finding the exact total energy ($E_{tot}$) and electron density ($n(x)$), you will then decompose $E_{tot}$ into its constituent DFT parts: the non-interacting kinetic energy ($T_s$), the external potential energy ($E_{ext}$), the classical Hartree repulsion ($E_H$), and, most importantly, the residual exchange-correlation energy ($E_{xc}$). This exercise provides a concrete, quantitative look at the magnitude and behavior of these fundamental quantities.",
            "id": "2384996",
            "problem": "Consider a one-dimensional, spin-compensated, two-electron system in atomic units (Hartree atomic units where the electron mass, elementary charge, and reduced Planck constant are set to unity). The external potential is harmonic, and the electron-electron interaction is a harmonic repulsion. The Hamiltonian is\n$$\n\\hat{H} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} + \\frac{1}{2}\\omega^2 \\left(x_1^2 + x_2^2\\right) + \\frac{k}{2}\\left(x_1 - x_2\\right)^2,\n$$\nwith parameters $\\omega \\gt 0$ and $k \\ge 0$. Work in the framework of density functional theory and decompose the exact ground-state total energy into the following terms:\n- The noninteracting Kohn–Sham kinetic energy $T_s$.\n- The external potential energy $E_{ext}$.\n- The Hartree energy $E_H$ for the given electron-electron interaction.\n- The exchange–correlation energy $E_{xc}$.\n\nYour task is to derive, from first principles, how to compute each energy contribution exactly for this model and implement it as a program.\n\nUse only the following fundamental starting points and definitions:\n- Separation of the two-body Hamiltonian into center-of-mass and relative coordinates to obtain the exact ground-state energy $E_{tot}$ and the exact one-electron density $n(x)$.\n- For a spin-compensated two-electron system occupying a single spatial orbital, the exact Kohn–Sham kinetic energy equals the Weizsäcker kinetic energy functional\n$$\nT_s[n] = \\frac{1}{8}\\int_{-\\infty}^{\\infty} \\frac{\\left(\\frac{dn}{dx}\\right)^2}{n(x)}\\,dx.\n$$\n- The external potential energy is\n$$\nE_{ext}[n] = \\int_{-\\infty}^{\\infty} n(x)\\, v_{ext}(x)\\, dx, \\quad v_{ext}(x) = \\frac{1}{2}\\omega^2 x^2.\n$$\n- The Hartree energy for the given pair potential is\n$$\nE_H[n] = \\frac{1}{2}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} n(x)\\, n(x')\\, w(x-x')\\, dx\\, dx', \\quad w(x-x') = \\frac{k}{2}(x-x')^2.\n$$\n- The exchange–correlation energy is defined residually by\n$$\nE_{xc} = E_{tot} - T_s - E_{ext} - E_H,\n$$\nwhere $E_{tot}$ is the exact ground-state energy of $\\hat{H}$.\n\nExpress all energies in Hartree. Report each energy rounded to eight decimal places.\n\nTest suite:\n- Case 1 (happy path, noninteracting limit): $\\omega = 1.0$, $k = 0.0$.\n- Case 2 (moderate interaction): $\\omega = 1.0$, $k = 0.5$.\n- Case 3 (weak trap, strong interaction): $\\omega = 0.5$, $k = 2.0$.\n- Case 4 (strong trap, strong interaction): $\\omega = 2.0$, $k = 5.0$.\n\nYour program must, for each test case, compute and return a list of five floats\n$$\n\\left[ T_s,\\; E_{ext},\\; E_H,\\; E_{xc},\\; E_{tot} \\right]\n$$\neach rounded to eight decimal places, in Hartree. The final output must be a single line containing a top-level list of the four per-case lists, with no spaces. For example, the format must be\n$$\n\\left[\\left[T_s^{(1)},E_{ext}^{(1)},E_H^{(1)},E_{xc}^{(1)},E_{tot}^{(1)}\\right],\\ldots,\\left[T_s^{(4)},E_{ext}^{(4)},E_H^{(4)},E_{xc}^{(4)},E_{tot}^{(4)}\\right]\\right]\n$$\nbut with the actual numerical values in place of the symbols and with no whitespace. No user input should be read; the program must run as-is and print only this single line.",
            "solution": "The problem requires the calculation of density functional theory (DFT) energy components for a one-dimensional two-electron system with harmonic confinement and harmonic electron-electron repulsion. The solution must be derived from first principles.\n\nThe starting point is the Hamiltonian in atomic units ($\\hbar=m_e=e=1$):\n$$\n\\hat{H} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} + \\frac{1}{2}\\omega^2 \\left(x_1^2 + x_2^2\\right) + \\frac{k}{2}\\left(x_1 - x_2\\right)^2\n$$\n\n**Step 1: Exact Solution of the Schrödinger Equation**\n\nTo find the exact ground-state energy $E_{tot}$ and the one-electron density $n(x)$, we solve the two-body Schrödinger equation $\\hat{H}\\Psi(x_1, x_2) = E\\Psi(x_1, x_2)$. This is achieved by transforming to center-of-mass ($R$) and relative ($r$) coordinates:\n$$\nR = \\frac{x_1 + x_2}{2}, \\quad r = x_1 - x_2\n$$\nThe kinetic energy operator transforms to:\n$$\n-\\frac{1}{2}\\left(\\frac{\\partial^2}{\\partial x_1^2} + \\frac{\\partial^2}{\\partial x_2^2}\\right) = -\\frac{1}{2}\\left(\\frac{1}{2}\\frac{\\partial^2}{\\partial R^2} + 2\\frac{\\partial^2}{\\partial r^2}\\right) = -\\frac{1}{2(2)}\\frac{\\partial^2}{\\partial R^2} - \\frac{1}{2(1/2)}\\frac{\\partial^2}{\\partial r^2}\n$$\nThis represents two particles: a center-of-mass particle with mass $M=2$ and a relative particle with reduced mass $\\mu=1/2$. The potential energy terms transform to:\n$$\n\\frac{1}{2}\\omega^2(x_1^2 + x_2^2) = \\frac{1}{2}\\omega^2 \\left(2R^2 + \\frac{r^2}{2}\\right) = \\omega^2 R^2 + \\frac{\\omega^2}{4}r^2\n$$\nThe interaction potential is simply $\\frac{k}{2}r^2$. The Hamiltonian separates into two independent parts, $\\hat{H} = \\hat{H}_R + \\hat{H}_r$:\n$$\n\\hat{H}_R = -\\frac{1}{4}\\frac{\\partial^2}{\\partial R^2} + \\omega^2 R^2 = -\\frac{1}{2(2)}\\frac{\\partial^2}{\\partial R^2} + \\frac{1}{2}(2)\\omega^2 R^2\n$$\n$$\n\\hat{H}_r = -\\frac{\\partial^2}{\\partial r^2} + \\frac{\\omega^2}{4}r^2 + \\frac{k}{2}r^2 = -\\frac{1}{2(1/2)}\\frac{\\partial^2}{\\partial r^2} + \\frac{1}{2}\\left(\\frac{1}{2}\\right)(\\omega^2+2k)r^2\n$$\nBoth $\\hat{H}_R$ and $\\hat{H}_r$ are standard quantum harmonic oscillator (QHO) Hamiltonians.\nFor the center-of-mass motion, the mass is $M=2$ and the frequency is $\\Omega_R=\\omega$. The ground-state energy is $E_R^{(0)} = \\frac{1}{2}\\Omega_R = \\frac{1}{2}\\omega$.\nFor the relative motion, the mass is $\\mu=1/2$ and the frequency is $\\Omega_r=\\sqrt{\\omega^2+2k}$. The ground-state energy is $E_r^{(0)} = \\frac{1}{2}\\Omega_r = \\frac{1}{2}\\sqrt{\\omega^2+2k}$.\n\nThe exact total ground-state energy is the sum of these two energies:\n$$\nE_{tot} = E_R^{(0)} + E_r^{(0)} = \\frac{1}{2}\\omega + \\frac{1}{2}\\sqrt{\\omega^2+2k}\n$$\n\n**Step 2: Derivation of the Exact One-Electron Density**\n\nThe ground-state wavefunction is the product of the QHO ground-state wavefunctions for each mode: $\\Psi_0(R, r) = \\Phi_R^{(0)}(R) \\Phi_r^{(0)}(r)$. The one-electron density $n(x)$ is found by integrating the two-electron probability density over the coordinates of one electron, multiplied by the number of electrons ($N=2$):\n$$\nn(x_1) = 2 \\int_{-\\infty}^{\\infty} |\\Psi_0(\\frac{x_1+x_2}{2}, x_1-x_2)|^2 dx_2\n$$\nThe ground-state probability densities are Gaussians: $|\\Phi_R^{(0)}(R)|^2 \\propto e^{-2\\omega R^2}$ and $|\\Phi_r^{(0)}(r)|^2 \\propto e^{-\\frac{1}{2}\\sqrt{\\omega^2+2k} r^2}$. Performing the Gaussian integral over $x_2$ yields the one-electron density $n(x)$, which is also a Gaussian:\n$$\nn(x) = C e^{-\\alpha x^2}\n$$\nwhere the decay constant $\\alpha$ is found to be:\n$$\n\\alpha = \\frac{2\\omega\\sqrt{\\omega^2+2k}}{\\omega+\\sqrt{\\omega^2+2k}}\n$$\nThe normalization constant $C$ is determined by the condition $\\int_{-\\infty}^{\\infty} n(x)dx=2$, which gives $C = 2\\sqrt{\\alpha/\\pi}$.\n\n**Step 3: Calculation of DFT Energy Components**\n\nWith the exact density $n(x)$, we can now compute the DFT energy components using the provided definitions.\n\n**Kohn-Sham Kinetic Energy ($T_s$)**: For this two-electron system, $T_s$ is given by the Weizsäcker functional.\n$$\nT_s[n] = \\frac{1}{8}\\int_{-\\infty}^{\\infty} \\frac{\\left(\\frac{dn}{dx}\\right)^2}{n(x)}\\,dx\n$$\nWe have $\\frac{dn}{dx} = -2\\alpha x \\cdot n(x)$. Substituting this into the integral:\n$$\nT_s = \\frac{1}{8}\\int \\frac{4\\alpha^2 x^2 (n(x))^2}{n(x)} dx = \\frac{\\alpha^2}{2}\\int x^2 n(x) dx\n$$\nThe second moment of the density is $\\int x^2 n(x)dx = 1/\\alpha$.\n$$\nT_s = \\frac{\\alpha^2}{2} \\left(\\frac{1}{\\alpha}\\right) = \\frac{\\alpha}{2}\n$$\n\n**External Potential Energy ($E_{ext}$)**:\n$$\nE_{ext}[n] = \\int_{-\\infty}^{\\infty} n(x) v_{ext}(x) dx = \\int_{-\\infty}^{\\infty} n(x)\\left(\\frac{1}{2}\\omega^2 x^2\\right) dx = \\frac{\\omega^2}{2}\\int x^2 n(x) dx\n$$\nUsing $\\int x^2 n(x)dx = 1/\\alpha$ again:\n$$\nE_{ext} = \\frac{\\omega^2}{2\\alpha}\n$$\n\n**Hartree Energy ($E_H$)**: The definition for the specified interaction $w(x-x') = \\frac{k}{2}(x-x')^2$ is:\n$$\nE_H[n] = \\frac{1}{2}\\iint n(x)n(x') \\frac{k}{2}(x-x')^2 dx dx' = \\frac{k}{4} \\iint n(x)n(x')(x^2 - 2xx' + x'^2) dx dx'\n$$\nExpanding and using moments of the density: $\\int n(x)dx = 2$, $\\int xn(x)dx = 0$ (by symmetry), and $\\int x^2 n(x)dx = 1/\\alpha$:\n$$\nE_H = \\frac{k}{4} \\left[ \\left(\\int n(x')dx'\\right)\\left(\\int x^2n(x)dx\\right) - 2\\left(\\int xn(x)dx\\right)^2 + \\left(\\int n(x)dx\\right)\\left(\\int x'^2n(x')dx'\\right) \\right]\n$$\n$$\nE_H = \\frac{k}{4} \\left[ (2)\\left(\\frac{1}{\\alpha}\\right) - 2(0)^2 + (2)\\left(\\frac{1}{\\alpha}\\right) \\right] = \\frac{k}{4}\\left(\\frac{4}{\\alpha}\\right) = \\frac{k}{\\alpha}\n$$\n\n**Exchange-Correlation Energy ($E_{xc}$)**: This is defined as the remaining portion of the total energy:\n$$\nE_{xc} = E_{tot} - T_s - E_{ext} - E_H\n$$\nSubstituting the derived expressions for each term allows for its numerical computation.\n\n**Summary of Formulas**:\nFor a given pair of parameters $(\\omega, k)$:\n1. Define a helper frequency: $\\Omega_r = \\sqrt{\\omega^2 + 2k}$.\n2. Define the density parameter: $\\alpha = \\frac{2\\omega\\Omega_r}{\\omega+\\Omega_r}$.\n3. The total energy is: $E_{tot} = \\frac{1}{2}(\\omega + \\Omega_r)$.\n4. The KS kinetic energy is: $T_s = \\frac{\\alpha}{2}$.\n5. The external potential energy is: $E_{ext} = \\frac{\\omega^2}{2\\alpha}$.\n6. The Hartree energy is: $E_H = \\frac{k}{\\alpha}$.\n7. The exchange-correlation energy is: $E_{xc} = E_{tot} - T_s - E_{ext} - E_H$.\nThese formulas are implemented in the provided program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a 1D two-electron system with harmonic confinement and interaction.\n\n    The problem asks to calculate DFT energy components (Ts, Eext, EH, Exc) and the\n    exact total energy (Etot) for a model system described by the Hamiltonian:\n    H = -1/2 * d^2/dx1^2 - 1/2 * d^2/dx2^2 + 1/2*w^2*(x1^2+x2^2) + k/2*(x1-x2)^2\n\n    The derivations in the solution lead to the following analytical formulas:\n    1. Helper frequency for relative motion: Omega_r = sqrt(w^2 + 2k)\n    2. Density decay parameter: alpha = (2 * w * Omega_r) / (w + Omega_r)\n    3. Total energy: Etot = 1/2 * (w + Omega_r)\n    4. KS kinetic energy: Ts = alpha / 2\n    5. External potential energy: Eext = w^2 / (2 * alpha)\n    6. Hartree energy: EH = k / alpha\n    7. Exchange-correlation energy: Exc = Etot - Ts - Eext - EH\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    test_cases = [\n        (1.0, 0.0),  # Case 1: noninteracting limit\n        (1.0, 0.5),  # Case 2: moderate interaction\n        (0.5, 2.0),  # Case 3: weak trap, strong interaction\n        (2.0, 5.0),  # Case 4: strong trap, strong interaction\n    ]\n\n    all_results = []\n    \n    for omega, k in test_cases:\n        # Step 1: Calculate the helper frequency for the relative coordinate.\n        # Omega_r = sqrt(omega^2 + 2*k)\n        omega_r = np.sqrt(omega**2 + 2 * k)\n\n        # Step 2: Calculate the density parameter alpha.\n        # This parameter defines the Gaussian shape of the one-electron density n(x).\n        # alpha = (2 * omega * omega_r) / (omega + omega_r)\n        alpha = (2 * omega * omega_r) / (omega + omega_r)\n\n        # Step 3: Calculate the total ground-state energy E_tot.\n        # E_tot is the sum of the ground-state energies of the center-of-mass and relative oscillators.\n        e_tot = 0.5 * (omega + omega_r)\n\n        # Step 4: Calculate the non-interacting Kohn-Sham kinetic energy T_s.\n        # For this 2-electron system, T_s is exactly the Weizsäcker kinetic energy.\n        t_s = alpha / 2.0\n\n        # Step 5: Calculate the external potential energy E_ext.\n        e_ext = (omega**2) / (2.0 * alpha)\n\n        # Step 6: Calculate the Hartree energy E_H for the harmonic repulsion.\n        # For k=0, alpha  0, so EH is 0. If k  0, EH is positive.\n        e_h = k / alpha\n\n        # Step 7: Calculate the exchange-correlation energy E_xc residually.\n        # E_xc is defined as what's left after subtracting the other components from the exact total energy.\n        e_xc = e_tot - t_s - e_ext - e_h\n\n        # Collect the results for the current case, rounded to 8 decimal places.\n        case_results = [\n            round(t_s, 8),\n            round(e_ext, 8),\n            round(e_h, 8),\n            round(e_xc, 8),\n            round(e_tot, 8),\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists, without any spaces.\n    # e.g., [[1.00000000,0.50000000,...],[...]]\n    result_str_list = []\n    for res_list in all_results:\n        # Format each number to 8 decimal places\n        formatted_nums = [f\"{x:.8f}\" for x in res_list]\n        result_str_list.append(f\"[{','.join(formatted_nums)}]\")\n    \n    final_output = f\"[{','.join(result_str_list)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "After examining the exact energy components, we now turn to the practical world of approximate functionals. The Local Density Approximation (LDA) is the foundation upon which most modern functionals are built, yet its conceptual limitations are crucial to grasp for any practitioner. This exercise probes the core strengths and weaknesses of LDA, focusing on the notorious self-interaction error . You will analyze why LDA is exact for its parent system, the uniform electron gas, but incorrectly allows a single electron to interact with itself in a confined system, a failure that propagates through more complex functionals.",
            "id": "2385007",
            "problem": "Consider two systems within the Kohn–Sham formulation of Density Functional Theory (DFT): (i) a three-dimensional uniform electron gas (UEG) with constant electron density $n_{0}$ neutralized by a uniform positive background, and (ii) a single electron confined in a three-dimensional infinite potential well (a cubic box) of side $L$. In Kohn–Sham DFT, the total energy functional is written as $E[n] = T_{s}[n] + \\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r} + E_{H}[n] + E_{xc}[n]$, where $T_{s}[n]$ is the noninteracting kinetic energy, $v_{\\mathrm{ext}}(\\mathbf{r})$ is the external potential, $E_{H}[n]$ is the Hartree energy, and $E_{xc}[n]$ is the exchange–correlation energy. The Hartree energy is defined by\n$$\nE_{H}[n] = \\frac{1}{2}\\int\\!\\!\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'.\n$$\nIn the Local Density Approximation (LDA), the exchange–correlation (XC) energy is approximated as\n$$\nE_{xc}^{\\mathrm{LDA}}[n] = \\int n(\\mathbf{r})\\,\\varepsilon_{xc}^{\\mathrm{unif}}(n(\\mathbf{r}))\\,d\\mathbf{r},\n$$\nwhere $\\varepsilon_{xc}^{\\mathrm{unif}}(n)$ is the XC energy per particle of the uniform electron gas at density $n$.\n\nUsing only the above definitions and universally accepted properties of the exact exchange–correlation hole and of uniform coordinate scaling of densities, answer the following. Select all statements that are correct.\n\nA. In the uniform electron gas, where $n(\\mathbf{r}) = n_{0}$ is constant, the Local Density Approximation evaluates $E_{xc}[n]$ exactly, because the exact exchange–correlation energy density is translationally invariant and depends only on $n_{0}$.\n\nB. For any one-electron system, the exact exchange–correlation functional satisfies $E_{xc}[n] = -E_{H}[n]$, so that $E_{H}[n] + E_{xc}[n] = 0$, while generally $E_{H}[n] + E_{xc}^{\\mathrm{LDA}}[n] \\neq 0$ (self-interaction error).\n\nC. The primary reason the Local Density Approximation fails for a single electron is the absence of the derivative discontinuity of the exchange–correlation potential at integer particle numbers.\n\nD. For a single electron in a cubic infinite well, modeling the electron as spin-unpolarized makes $E_{xc}^{\\mathrm{LDA}}[n]$ cancel $E_{H}[n]$ exactly.\n\nE. Under uniform coordinate scaling $n_{L}(\\mathbf{r}) = L^{-3} n(\\mathbf{r}/L)$ of a normalized one-electron density in a cubic box of side $L$, both $E_{H}[n_{L}]$ and the LDA exchange energy $E_{x}^{\\mathrm{LDA}}[n_{L}]$ scale as $L^{-1}$, so the absolute self-interaction error decays to zero as $L \\to \\infty$ but does not vanish at any finite $L$.",
            "solution": "The problem statement is validated as scientifically sound, well-posed, and objective. It consists of standard definitions and concepts from density functional theory. We shall proceed with the analysis of each statement.\n\nThe total energy functional in Kohn-Sham DFT is given by $E[n] = T_{s}[n] + E_{\\text{ext}}[n] + E_{H}[n] + E_{xc}[n]$, where $E_{\\text{ext}}[n] = \\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r}$.\n\nA. In the uniform electron gas, where $n(\\mathbf{r}) = n_{0}$ is constant, the Local Density Approximation evaluates $E_{xc}[n]$ exactly, because the exact exchange–correlation energy density is translationally invariant and depends only on $n_{0}$.\n\nThis statement is correct. The Local Density Approximation (LDA) for the exchange-correlation energy is defined as $E_{xc}^{\\mathrm{LDA}}[n] = \\int n(\\mathbf{r})\\,\\varepsilon_{xc}^{\\mathrm{unif}}(n(\\mathbf{r}))\\,d\\mathbf{r}$, where $\\varepsilon_{xc}^{\\mathrm{unif}}(n)$ is the exchange-correlation energy per particle of a uniform electron gas (UEG) of density $n$. By its very construction, the LDA is designed to be exact for the system from which its parameters are derived, which is the UEG.\nFor a UEG, the electron density is constant, $n(\\mathbf{r}) = n_{0}$. Applying the LDA formula to this system gives:\n$$\nE_{xc}^{\\mathrm{LDA}}[n_0] = \\int n_0 \\, \\varepsilon_{xc}^{\\mathrm{unif}}(n_0) \\, d\\mathbf{r} = n_0 \\, \\varepsilon_{xc}^{\\mathrm{unif}}(n_0) \\int d\\mathbf{r} = n_0 \\, \\varepsilon_{xc}^{\\mathrm{unif}}(n_0) \\, V\n$$\nwhere $V$ is the volume of the system. The total number of electrons is $N = n_0 V$. Thus, $E_{xc}^{\\mathrm{LDA}}[n_0] = N \\varepsilon_{xc}^{\\mathrm{unif}}(n_0)$. This is precisely the definition of the total exchange-correlation energy of the UEG. The reasoning that the energy density is translationally invariant is also correct; in a uniform system, local properties are identical to global properties, making a local approximation exact.\nVerdict: **Correct**.\n\nB. For any one-electron system, the exact exchange–correlation functional satisfies $E_{xc}[n] = -E_{H}[n]$, so that $E_{H}[n] + E_{xc}[n] = 0$, while generally $E_{H}[n] + E_{xc}^{\\mathrm{LDA}}[n] \\neq 0$ (self-interaction error).\n\nThis statement is also correct. In a one-electron system, there are no electron-electron interactions. The total energy is simply the sum of the kinetic energy of the electron and its interaction with the external potential, $E_{\\text{exact}} = T + V_{\\text{ext}}$. In the Kohn-Sham formalism, the many-body effects are partitioned into the Hartree energy $E_{H}[n]$ and the exchange-correlation energy $E_{xc}[n]$. The Hartree energy, $E_{H}[n] = \\frac{1}{2}\\int\\!\\!\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'$, represents the classical electrostatic repulsion of the charge density $n(\\mathbf{r})$ with itself. For a single electron, this is a fictitious self-interaction. For the Kohn-Sham total energy to equal the exact energy, this spurious term must be canceled. Therefore, the exact exchange-correlation functional must satisfy $E_{H}[n] + E_{xc}^{\\mathrm{exact}}[n] = 0$. This implies $E_{xc}^{\\mathrm{exact}}[n] = -E_{H}[n]$. Note that for a one-electron system, the exchange energy exactly cancels the Hartree energy, and the correlation energy is zero.\nHowever, approximate functionals like LDA do not satisfy this condition. For a typical one-electron density, both $E_{H}[n]$ and $E_{xc}^{\\mathrm{LDA}}[n]$ are non-zero, and their sum is also non-zero: $E_{H}[n] + E_{xc}^{\\mathrm{LDA}}[n] \\neq 0$. This non-cancellation is the well-known self-interaction error of LDA.\nVerdict: **Correct**.\n\nC. The primary reason the Local Density Approximation fails for a single electron is the absence of the derivative discontinuity of the exchange–correlation potential at integer particle numbers.\n\nThis statement is incorrect. While the absence of the derivative discontinuity is a significant failure of LDA, it is not the \"primary reason\" for its failure for a single electron system. The primary and most direct failure is the self-interaction error, as described in statement B. An electron does not interact with itself, yet in an LDA calculation, the one-electron density creates a spurious Hartree potential that acts on the electron, and the LDA exchange-correlation potential does not fully cancel this unphysical effect. This is a fundamental error that exists in a single calculation for a system with a fixed integer number of electrons ($N=1$).\nThe derivative discontinuity of the XC potential, $\\Delta_{xc} = \\lim_{\\delta \\to 0^+} [v_{xc}^{N+\\delta}(\\mathbf{r}) - v_{xc}^{N-\\delta}(\\mathbf{r})]$, is a property related to the change in energy as the particle number $N$ crosses an integer. Its absence in LDA leads to severe underestimation of band gaps, incorrect description of charge transfer, and poor prediction of electron affinities. These problems concern energy differences between systems with different particle numbers (e.g., $E(N+1)-E(N)$). The self-interaction error is a more fundamental problem inherent in the description of the $N=1$ system itself.\nVerdict: **Incorrect**.\n\nD. For a single electron in a cubic infinite well, modeling the electron as spin-unpolarized makes $E_{xc}^{\\mathrm{LDA}}[n]$ cancel $E_{H}[n]$ exactly.\n\nThis statement is incorrect. First, a single electron is intrinsically a fully spin-polarized system. Modeling it as \"spin-unpolarized\" ($n_\\uparrow = n_\\downarrow = n/2$) is an unphysical construct. Second, even if one were to perform this unphysical calculation, there is no reason for exact cancellation. The Hartree energy $E_H[n]$ is a non-local functional of the density $n(\\mathbf{r})$. The unpolarized LDA exchange-correlation energy is a local functional, $E_{xc}^{\\mathrm{LDA}}[n] = \\int f(n(\\mathbf{r})) d\\mathbf{r}$ (e.g., for exchange-only, $f(n) \\propto n^{4/3}$). The mathematical forms of $E_H[n]$ and $E_{xc}^{\\mathrm{LDA}}[n]$ are entirely different. An exact cancellation for a specific non-trivial density profile like that of a particle in a box would be an extraordinary coincidence, not a general property. No such cancellation occurs.\nVerdict: **Incorrect**.\n\nE. Under uniform coordinate scaling $n_{L}(\\mathbf{r}) = L^{-3} n(\\mathbf{r}/L)$ of a normalized one-electron density in a cubic box of side $L$, both $E_{H}[n_{L}]$ and the LDA exchange energy $E_{x}^{\\mathrm{LDA}}[n_{L}]$ scale as $L^{-1}$, so the absolute self-interaction error decays to zero as $L \\to \\infty$ but does not vanish at any finite $L$.\n\nThis statement is correct. Let us analyze the scaling behavior. The scaling transformation is $n_L(\\mathbf{r}) = L^{-3} n_1(\\mathbf{r}/L)$, where $n_1$ is the density for a box of side $L=1$. This correctly describes the ground-state density of a particle in a box of side $L$.\nLet's find the scaling of the Hartree energy $E_H[n_L]$:\n$$\nE_H[n_L] = \\frac{1}{2}\\iint \\frac{n_L(\\mathbf{r})n_L(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}' = \\frac{1}{2}\\iint \\frac{L^{-6} n_1(\\mathbf{r}/L)n_1(\\mathbf{r}'/L)}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}'\n$$\nUsing the substitution $\\mathbf{u} = \\mathbf{r}/L$ and $\\mathbf{v} = \\mathbf{r}'/L$, we have $d\\mathbf{r}=L^3 d\\mathbf{u}$ and $d\\mathbf{r}'=L^3 d\\mathbf{v}$.\n$$\nE_H[n_L] = \\frac{1}{2}\\iint \\frac{L^{-6} n_1(\\mathbf{u})n_1(\\mathbf{v})}{|L\\mathbf{u}-L\\mathbf{v}|}(L^3 d\\mathbf{u})(L^3 d\\mathbf{v}) = \\frac{L^{-6}L^6}{L} \\left(\\frac{1}{2}\\iint \\frac{n_1(\\mathbf{u})n_1(\\mathbf{v})}{|\\mathbf{u}-\\mathbf{v}|}d\\mathbf{u}d\\mathbf{v}\\right) = \\frac{1}{L} E_H[n_1]\n$$\nSo, $E_H[n_L]$ scales as $L^{-1}$.\nNow, let's analyze the LDA exchange energy $E_x^{\\mathrm{LDA}}[n_L]$. The functional form is $E_x^{\\mathrm{LDA}}[n] = C_x \\int n(\\mathbf{r})^{4/3} d\\mathbf{r}$ for some constant $C_x$.\n$$\nE_x^{\\mathrm{LDA}}[n_L] = C_x \\int (n_L(\\mathbf{r}))^{4/3} d\\mathbf{r} = C_x \\int (L^{-3} n_1(\\mathbf{r}/L))^{4/3} d\\mathbf{r} = C_x L^{-4} \\int (n_1(\\mathbf{r}/L))^{4/3} d\\mathbf{r}\n$$\nUsing the substitution $\\mathbf{u} = \\mathbf{r}/L$:\n$$\nE_x^{\\mathrm{LDA}}[n_L] = C_x L^{-4} \\int (n_1(\\mathbf{u}))^{4/3} (L^3 d\\mathbf{u}) = \\frac{1}{L} \\left(C_x \\int (n_1(\\mathbf{u}))^{4/3} d\\mathbf{u}\\right) = \\frac{1}{L} E_x^{\\mathrm{LDA}}[n_1]\n$$\nSo, $E_x^{\\mathrm{LDA}}[n_L]$ also scales as $L^{-1}$. The same scaling holds for the LDA correlation energy in the low-density limit relevant for $L \\to \\infty$. The absolute self-interaction error is $|E_H[n_L] + E_{xc}^{\\mathrm{LDA}}[n_L]|$. Since all terms scale as $L^{-1}$, the error is $|L^{-1}(E_H[n_1] + E_{xc}^{\\mathrm{LDA}}[n_1])| = L^{-1}|E_H[n_1] + E_{xc}^{\\mathrm{LDA}}[n_1]|$. As established in B, the error for $L=1$ is non-zero. Thus, the error decays as $L^{-1}$ for $L \\to \\infty$ and is non-zero for any finite $L$.\nVerdict: **Correct**.",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "A primary application of DFT in chemical biology is determining the stable three-dimensional structures of molecules, a process driven by calculating the forces on atomic nuclei. This practice delves into the theoretical underpinnings of force calculations, revealing that the total force is more than just the classical electrostatic repulsion and attraction described by the Hellmann-Feynman theorem . You will derive and compute the Pulay force, a crucial correction term that arises because our finite basis sets move with the atoms, and quantify how incomplete self-consistent field (SCF) convergence can introduce errors. This provides essential insight into the mechanics of geometry optimization and molecular dynamics simulations.",
            "id": "3842529",
            "problem": "Consider the force on nucleus $A$ along the internuclear axis in a two-center one-electron model that serves as a minimal illustrative fragment relevant to computational chemical biology (for example, a small ligand bound to a proton-like site), treated within Kohn–Sham Density Functional Theory (DFT) under the Born–Oppenheimer approximation. The electronic structure is represented in a finite Gaussian-Type Orbital (GTO) basis $\\{\\phi_{A},\\phi_{B}\\}$ that depends parametrically on the nuclear positions, so the basis overlap matrix $S$ and Hamiltonian matrix $H$ depend on the nuclear coordinate $R_{A}$. The occupied Kohn–Sham orbital is expanded as $\\psi = c_{A} \\phi_{A} + c_{B} \\phi_{B}$ with column coefficient vector $c = \\begin{pmatrix} c_{A} \\\\ c_{B} \\end{pmatrix}$ constrained by the generalized normalization $c^{\\top} S c = 1$. The total energy for this one-electron pure-external-potential case is $E_{\\text{tot}}(R_{A}) = \\varepsilon(R_{A}) + E_{\\text{nn}}(R)$, where $\\varepsilon$ is the occupied Kohn–Sham eigenvalue, $E_{\\text{nn}}(R)=Z_{A} Z_{B}/R$ is the Coulomb repulsion between nuclei with charges $Z_{A}$ and $Z_{B}$, and $R = |R_{A}-R_{B}|$ is the internuclear separation.\n\nStarting from first principles—namely, the variational stationarity of the Kohn–Sham energy with respect to orbital coefficients under the normalization constraint and the definition of the force as the negative gradient of the energy with respect to nuclear coordinates—derive the expression for the total force on nucleus $A$ along the internuclear axis that combines the explicit derivative of the electronic Hamiltonian (Hellmann–Feynman contribution), the term arising from the parametric dependence of the basis (Pulay contribution), and the nucleus–nucleus contribution. Then evaluate the numerical value of this force using the data below. Finally, assess the additive error in the force introduced by incomplete Self-Consistent Field (SCF) convergence by quantifying the correction incurred when, in the generalized eigenproblem constraint, the Lagrange multiplier $\\lambda$ differs from the converged eigenvalue $\\varepsilon$.\n\nAll quantities are given in atomic units. Use the following data at the geometry of interest:\n- Nuclear charges: $Z_{A} = 1$, $Z_{B} = 1$.\n- Internuclear separation: $R = 1.4$.\n- Basis overlap matrix $S$ is symmetric with elements $S_{AA} = 1$, $S_{BB} = 1$, and $S_{AB} = S_{BA} = s$, with $s = 0.4$. Its derivative with respect to $R_{A}$ is nonzero only for the off-diagonal elements: $\\frac{\\partial S_{AB}}{\\partial R_{A}} = \\frac{\\partial S_{BA}}{\\partial R_{A}} = ds$, with $ds = -0.25$; $\\frac{\\partial S_{AA}}{\\partial R_{A}} = \\frac{\\partial S_{BB}}{\\partial R_{A}} = 0$.\n- The derivative of the electronic Hamiltonian matrix with respect to $R_{A}$ has elements $\\frac{\\partial H_{AA}}{\\partial R_{A}} = -0.30$, $\\frac{\\partial H_{AB}}{\\partial R_{A}} = -0.10$, and $\\frac{\\partial H_{BB}}{\\partial R_{A}} = -0.02$.\n- The occupied orbital coefficients are $c_{A} = 0.8$, $c_{B} = 0.36$, and satisfy $c^{\\top} S c = 1$ at the given geometry.\n- The occupied Kohn–Sham eigenvalue is $\\varepsilon = -0.6$.\n- The Lagrange multiplier associated with the generalized normalization constraint at the last SCF micro-iteration (not fully converged) is $\\lambda = -0.58$.\n\nCompute:\n1. The total force $F_{\\text{tot}}$ on nucleus $A$ combining the electronic Hellmann–Feynman and Pulay terms with the nucleus–nucleus contribution.\n2. The additive SCF-incompleteness correction $\\delta F_{\\text{SCF}}$ to the force that arises solely from using $\\lambda$ instead of $\\varepsilon$ in the Pulay-type term.\n\nExpress the final answer as a row vector $\\left(F_{\\text{tot}} \\ \\delta F_{\\text{SCF}}\\right)$ in Hartree per Bohr, rounded to four significant figures. Do not include units in the final boxed answer.",
            "solution": "The problem is found to be scientifically grounded, well-posed, objective, and self-contained. It is a valid problem of computational chemistry, dealing with the fundamental concepts of forces in quantum mechanical calculations.\n\nThe total force on nucleus $A$, $F_{\\text{tot}}$, is the negative gradient of the total energy $E_{\\text{tot}}$ with respect to the nuclear coordinate $R_{A}$. As the problem is defined along the internuclear axis, this is a one-dimensional derivative:\n$$F_{\\text{tot}} = -\\frac{d E_{\\text{tot}}}{d R_{A}}$$\nThe total energy is given by $E_{\\text{tot}}(R_{A}) = \\varepsilon(R_{A}) + E_{\\text{nn}}(R)$, where $\\varepsilon$ is the occupied Kohn-Sham eigenvalue and $E_{\\text{nn}}(R)$ is the nuclear-nuclear repulsion energy. The force is therefore the sum of the electronic force and the nuclear-nuclear force:\n$$F_{\\text{tot}} = -\\frac{d\\varepsilon}{dR_{A}} - \\frac{dE_{\\text{nn}}}{dR_{A}}$$\n\nLet's analyze each term.\n\nFirst, the nuclear-nuclear repulsion term. The energy is $E_{\\text{nn}}(R) = \\frac{Z_{A} Z_{B}}{R}$. Assuming nucleus $B$ is at the origin and nucleus $A$ is at a distance $R$ along the axis, we have $R_{A} = R$. The derivative is:\n$$\\frac{dE_{\\text{nn}}}{dR_{A}} = \\frac{d}{dR}\\left(\\frac{Z_{A} Z_{B}}{R}\\right) = -\\frac{Z_{A} Z_{B}}{R^2}$$\nThe corresponding force contribution is $F_{\\text{nn}} = - \\frac{dE_{\\text{nn}}}{dR_{A}} = \\frac{Z_{A} Z_{B}}{R^2}$.\n\nSecond, the electronic term, which depends on the derivative of the Kohn-Sham eigenvalue $\\varepsilon$. The eigenvalue is obtained from the generalized eigenvalue equation $H c = \\varepsilon S c$. It can be expressed as a Rayleigh quotient:\n$$\\varepsilon = \\frac{c^{\\top} H c}{c^{\\top} S c}$$\nSince the orbital is normalized, $c^{\\top} S c = 1$, which simplifies the expression to $\\varepsilon = c^{\\top} H c$. To find the derivative of $\\varepsilon$ with respect to $R_A$, we apply the chain rule, acknowledging that $c$, $H$, and $S$ all depend on $R_A$:\n$$\\frac{d\\varepsilon}{dR_{A}} = \\frac{d}{dR_{A}}(c^{\\top} H c) = \\frac{dc^{\\top}}{dR_{A}} H c + c^{\\top} \\frac{dH}{dR_{A}} c + c^{\\top} H \\frac{dc}{dR_{A}}$$\nThe coefficients $c$ are determined variationally by minimizing the energy, which at convergence leads to the Kohn-Sham equations $H c = \\varepsilon S c$. Since $H$ and $S$ are symmetric matrices, the transpose relation $c^{\\top} H = \\varepsilon c^{\\top} S$ also holds. Substituting this into the derivative expression:\n$$\\frac{d\\varepsilon}{dR_{A}} = \\frac{dc^{\\top}}{dR_{A}} (\\varepsilon S c) + c^{\\top} \\frac{dH}{dR_{A}} c + (\\varepsilon c^{\\top} S) \\frac{dc}{dR_{A}}$$\n$$\\frac{d\\varepsilon}{dR_{A}} = c^{\\top} \\frac{dH}{dR_{A}} c + \\varepsilon \\left( \\frac{dc^{\\top}}{dR_{A}} S c + c^{\\top} S \\frac{dc}{dR_{A}} \\right)$$\nThe term in the parenthesis can be found by differentiating the normalization condition $c^{\\top} S c = 1$:\n$$\\frac{d}{dR_{A}}(c^{\\top} S c) = \\frac{dc^{\\top}}{dR_{A}} S c + c^{\\top} \\frac{dS}{dR_{A}} c + c^{\\top} S \\frac{dc}{dR_{A}} = \\frac{d(1)}{dR_{A}} = 0$$\nRearranging gives:\n$$\\frac{dc^{\\top}}{dR_{A}} S c + c^{\\top} S \\frac{dc}{dR_{A}} = -c^{\\top} \\frac{dS}{dR_{A}} c$$\nSubstituting this back into the expression for $\\frac{d\\varepsilon}{dR_A}$:\n$$\\frac{d\\varepsilon}{dR_{A}} = c^{\\top} \\frac{dH}{dR_{A}} c - \\varepsilon \\left( c^{\\top} \\frac{dS}{dR_{A}} c \\right)$$\nThe total force on nucleus $A$ is then:\n$$F_{\\text{tot}} = -\\frac{d\\varepsilon}{dR_{A}} + F_{\\text{nn}} = - \\left( c^{\\top} \\frac{dH}{dR_{A}} c - \\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c \\right) + \\frac{Z_{A} Z_{B}}{R^2}$$\n$$F_{\\text{tot}} = \\underbrace{-c^{\\top} \\frac{dH}{dR_{A}} c}_{\\text{Hellmann-Feynman force}} + \\underbrace{\\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c}_{\\text{Pulay force}} + \\underbrace{\\frac{Z_{A} Z_{B}}{R^2}}_{\\text{Nuclear force}}$$\n\nNow, we compute the numerical value of $F_{\\text{tot}}$ using the provided data in atomic units.\nThe data is: $Z_{A} = 1$, $Z_{B} = 1$, $R = 1.4$.\n$c = \\begin{pmatrix} 0.8 \\\\ 0.36 \\end{pmatrix}$, $\\varepsilon = -0.6$.\nThe derivative matrices are:\n$\\frac{dH}{dR_{A}} = \\begin{pmatrix} -0.30  -0.10 \\\\ -0.10  -0.02 \\end{pmatrix}$, $\\frac{dS}{dR_{A}} = \\begin{pmatrix} 0  -0.25 \\\\ -0.25  0 \\end{pmatrix}$.\n\n1.  Nuclear force:\n    $F_{\\text{nn}} = \\frac{1 \\times 1}{(1.4)^2} = \\frac{1}{1.96} \\approx 0.510204$ a.u.\n\n2.  Hellmann-Feynman term: $-c^{\\top} \\frac{dH}{dR_{A}} c$\n    $c^{\\top} \\frac{dH}{dR_{A}} c = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.30  -0.10 \\\\ -0.10  -0.02 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0.36 \\end{pmatrix}$\n    $= \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} (-0.30)(0.8) + (-0.10)(0.36) \\\\ (-0.10)(0.8) + (-0.02)(0.36) \\end{pmatrix}$\n    $= \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.24 - 0.036 \\\\ -0.08 - 0.0072 \\end{pmatrix} = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.276 \\\\ -0.0872 \\end{pmatrix}$\n    $= (0.8)(-0.276) + (0.36)(-0.0872) = -0.2208 - 0.031392 = -0.252192$\n    The Hellmann-Feynman force is $-(-0.252192) = 0.252192$ a.u.\n\n3.  Pulay term: $\\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c$\n    $c^{\\top} \\frac{dS}{dR_{A}} c = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} 0  -0.25 \\\\ -0.25  0 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0.36 \\end{pmatrix}$\n    $= \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} (0)(0.8) + (-0.25)(0.36) \\\\ (-0.25)(0.8) + (0)(0.36) \\end{pmatrix} = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.09 \\\\ -0.20 \\end{pmatrix}$\n    $= (0.8)(-0.09) + (0.36)(-0.20) = -0.072 - 0.072 = -0.144$\n    The Pulay force is $\\varepsilon(-0.144) = (-0.6)(-0.144) = 0.0864$ a.u.\n\nTotal force:\n$F_{\\text{tot}} = 0.252192 + 0.0864 + 0.510204 = 0.848796$ a.u.\nRounding to four significant figures, $F_{\\text{tot}} = 0.8488$ a.u.\n\nNext, we evaluate the additive SCF-incompleteness correction, $\\delta F_{\\text{SCF}}$. This correction arises because the Self-Consistent Field (SCF) procedure is not fully converged, meaning the Lagrange multiplier $\\lambda$ from the variational procedure is not equal to the final eigenvalue $\\varepsilon$. The variational condition that holds at the last iteration is $Hc = \\lambda Sc$, not $Hc = \\varepsilon Sc$.\nThe force expression derived under this unconverged condition, $F_{\\text{unconv}}$, uses $\\lambda$ in place of $\\varepsilon$ in the Pulay term:\n$$F_{\\text{unconv}} = -c^{\\top} \\frac{dH}{dR_{A}} c + \\lambda c^{\\top} \\frac{dS}{dR_{A}} c + \\frac{Z_{A} Z_{B}}{R^2}$$\nThe converged force, $F_{\\text{conv}}$, is the one we calculated previously, which we now denote $F_{\\text{tot}}$ for clarity.\n$$F_{\\text{conv}} = -c^{\\top} \\frac{dH}{dR_{A}} c + \\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c + \\frac{Z_{A} Z_{B}}{R^2}$$\nThe additive correction $\\delta F_{\\text{SCF}}$ is the difference between the force calculated with the unconverged Lagrange multiplier and the force calculated with the true eigenvalue:\n$$\\delta F_{\\text{SCF}} = F_{\\text{unconv}} - F_{\\text{conv}}$$\n$$\\delta F_{\\text{SCF}} = \\left( -c^{\\top} \\frac{dH}{dR_{A}} c + \\lambda c^{\\top} \\frac{dS}{dR_{A}} c + F_{\\text{nn}} \\right) - \\left( -c^{\\top} \\frac{dH}{dR_{A}} c + \\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c + F_{\\text{nn}} \\right)$$\n$$\\delta F_{\\text{SCF}} = (\\lambda - \\varepsilon) c^{\\top} \\frac{dS}{dR_{A}} c$$\nUsing the provided data: $\\lambda = -0.58$, $\\varepsilon = -0.6$, and the previously computed value $c^{\\top} \\frac{dS}{dR_{A}} c = -0.144$.\n$$\\delta F_{\\text{SCF}} = ((-0.58) - (-0.6)) \\times (-0.144) = (0.02) \\times (-0.144) = -0.00288$$\nRounding to four significant figures, $\\delta F_{\\text{SCF}} = -0.002880$ a.u.\n\nThe required values are $F_{\\text{tot}} \\approx 0.8488$ and $\\delta F_{\\text{SCF}} = -0.002880$.",
            "answer": "$$\n\\boxed{\n(0.8488 \\quad -0.002880)\n}\n$$"
        }
    ]
}