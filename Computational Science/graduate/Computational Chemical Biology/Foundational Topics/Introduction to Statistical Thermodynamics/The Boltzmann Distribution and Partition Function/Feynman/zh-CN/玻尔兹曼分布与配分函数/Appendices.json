{
    "hands_on_practices": [
        {
            "introduction": "本练习将抽象的统计力学概念与生物分子构象变化的具体能量差联系起来。通过计算玻尔兹曼因子 $\\exp(-\\beta \\Delta E)$，你将亲身体验温度和能隙如何共同决定不同状态的布居概率。这项基础计算是理解和量化分子系统中热力学平衡的关键一步 。",
            "id": "3865281",
            "problem": "在一个计算化学生物学工作流程中，一个蛋白质子系统在温度$T$下被视为一个正则系综，与一个大的溶剂热库处于弱热接触状态。从基于小系统与热库交换能量的正则系综构建出发，利用热库的温度热力学定义，引入逆热能参数$\\beta$，该参数控制平衡时微观状态能量的相对权重。然后，对于子系统两个微观状态之间能量差为$\\Delta E$的构象变化，较高能量状态的相对权重涉及玻尔兹曼因子$\\exp(-\\beta \\,\\Delta E)$。\n\n基于此物理基础：\n- 使用提供的估计值$k_{B}T \\approx 0.593\\,\\mathrm{kcal/mol}$，在$T=310\\,\\mathrm{K}$下计算$\\beta$。将$\\beta$以$(\\mathrm{kcal/mol})^{-1}$为单位表示。\n- 当$\\Delta E = 5\\,\\mathrm{kcal/mol}$时，计算玻尔兹曼因子$\\exp(-\\beta \\,\\Delta E)$。\n\n将最终的玻尔兹曼因子四舍五入至四位有效数字。最终答案只报告$\\exp(-\\beta \\,\\Delta E)$的值，且不包含单位。",
            "solution": "所述问题是有效的。它在科学上基于统计力学的原理，特别是正则系综和玻尔兹曼分布。该问题提法恰当、客观，并包含足够的信息以得出一个唯一的、有意义的解。所述温度$T=310\\,\\mathrm{K}$与所提供的热能值$k_{B}T$之间的微小不一致，通过明确指示使用给定的数值来解决，这是在习题集中为了标准化计算而采取的常见做法。\n\n我们首先按照要求，建立逆热能参数$\\beta$的物理基础。我们考虑一个具有离散能级$E_i$的小系统(S)，它与一个大的热库(R)处于热接触状态。组合系统(S+R)是孤立的，因此它们的总能量$E_{tot} = E_S + E_R$是恒定的。\n\n找到系统S处于能量为$E_i$的特定微观状态$i$的概率$P(E_i)$，与系统S能量为$E_i$时热库可及的微观状态数$\\Omega_R$成正比。在这种情况下，热库的能量是$E_R = E_{tot} - E_i$。因此，\n$$\nP(E_i) \\propto \\Omega_R(E_{tot} - E_i)\n$$\n热库的熵的统计定义是$S_R = k_B \\ln \\Omega_R$，其中$k_B$是玻尔兹曼常数。因此我们可以写成$\\Omega_R = \\exp(S_R/k_B)$。概率变为：\n$$\nP(E_i) \\propto \\exp\\left(\\frac{S_R(E_{tot} - E_i)}{k_B}\\right)\n$$\n由于热库远大于系统，系统的能量$E_i$远小于总能量$E_{tot}$（即$E_i \\ll E_{tot}$）。这使我们能够对热库的熵$S_R$在总能量$E_{tot}$附近进行泰勒级数展开：\n$$\nS_R(E_{tot} - E_i) \\approx S_R(E_{tot}) - E_i \\left( \\frac{\\partial S_R}{\\partial E_R} \\right)_{E_R=E_{tot}} + \\dots\n$$\n问题要求我们使用热库的温度热力学定义，其表达式为：\n$$\n\\frac{1}{T} = \\left( \\frac{\\partial S_R}{\\partial E_R} \\right)_{N,V}\n$$\n将此定义代入熵的展开式，我们得到：\n$$\nS_R(E_{tot} - E_i) \\approx S_R(E_{tot}) - \\frac{E_i}{T}\n$$\n将其代回概率$P(E_i)$的表达式中：\n$$\nP(E_i) \\propto \\exp\\left(\\frac{S_R(E_{tot}) - E_i/T}{k_B}\\right) = \\exp\\left(\\frac{S_R(E_{tot})}{k_B}\\right) \\exp\\left(-\\frac{E_i}{k_B T}\\right)\n$$\n项$\\exp(S_R(E_{tot})/k_B)$是一个仅取决于热库性质的常数。因此，系统处于微观状态$i$的概率与玻尔兹曼因子成正比：\n$$\nP(E_i) \\propto \\exp\\left(-\\frac{E_i}{k_B T}\\right)\n$$\n这个推导引入了项$\\frac{1}{k_B T}$，它被定义为逆热能，$\\beta$。\n$$\n\\beta \\equiv \\frac{1}{k_B T}\n$$\n因此，正则系综的概率分布为$P(E_i) \\propto \\exp(-\\beta E_i)$。对于能量分别为$E_1$和$E_2$的两个微观状态之间的构象变化，它们的相对布居数将通过其概率之比来关联：\n$$\n\\frac{P(E_2)}{P(E_1)} = \\frac{\\exp(-\\beta E_2)}{\\exp(-\\beta E_1)} = \\exp(-\\beta (E_2 - E_1)) = \\exp(-\\beta \\Delta E)\n$$\n其中$\\Delta E = E_2 - E_1$。这就是问题中提到的相对权重因子。\n\n现在，我们进行计算。\n首先，我们计算$\\beta$。问题提供了用于计算的热能乘积$k_B T$的值。\n已知：$k_B T = 0.593\\,\\mathrm{kcal/mol}$。\n使用$\\beta$的定义：\n$$\n\\beta = \\frac{1}{k_B T} = \\frac{1}{0.593\\,\\mathrm{kcal/mol}}\n$$\n$$\n\\beta \\approx 1.68634064\\, (\\mathrm{kcal/mol})^{-1}\n$$\n单位与问题的要求一致。\n\n接下来，我们计算给定能量差$\\Delta E = 5\\,\\mathrm{kcal/mol}$时的玻尔兹曼因子$\\exp(-\\beta \\Delta E)$。\n指数的参数是无量纲的，正如所预期的：\n$$\n-\\beta \\Delta E = -\\left(\\frac{1}{0.593\\,\\mathrm{kcal/mol}}\\right) \\times (5\\,\\mathrm{kcal/mol}) = -\\frac{5}{0.593}\n$$\n$$\n-\\beta \\Delta E \\approx -8.4317032\n$$\n因此，玻尔兹曼因子为：\n$$\n\\exp(-\\beta \\Delta E) = \\exp\\left(-\\frac{5}{0.593}\\right) \\approx \\exp(-8.4317032)\n$$\n$$\n\\exp(-\\beta \\Delta E) \\approx 0.0002178229\n$$\n问题要求将此值四舍五入到四位有效数字。前四位有效数字是$2$、$1$、$7$和$8$。随后的数字是$2$，所以我们向下舍入（截断）。\n结果值为$0.0002178$。用科学记数法可以更正式地表示为：\n$$\n\\exp(-\\beta \\Delta E) \\approx 2.178 \\times 10^{-4}\n$$\n这是最终的数值答案。",
            "answer": "$$\n\\boxed{2.178 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "在掌握了单个状态的概率后，我们更进一步，学习如何描述整个系统的宏观性质。本练习将引导你使用配分函数 $Z$——统计力学中的核心工具——来推导一个模型系统的平均能量 $\\langle E \\rangle$ 及其涨落（方差）。这个经典问题展示了配分函数的强大功能，它概括了系统的所有热力学信息，并架起了微观状态与宏观可观测量之间的桥梁 。",
            "id": "3865272",
            "problem": "一个大分子在正则系综中被建模为一个双态构象系综。能量较低的宏观态（记为 $A$）的能量为 $E_A = 0$，简并度为 $g_A$，代表一组折叠的微观态。能量较高的宏观态（记为 $B$）的能量为 $E_B = \\Delta$（其中 $\\Delta > 0$），简并度为 $g_B$，代表一组展开的微观态。该系统与温度为 $T$ 的热库耦合，逆热能为 $\\beta = \\frac{1}{k_B T}$，其中 $k_B$ 是玻尔兹曼常数（$k_B$）。\n\n从正则系综的基本原理出发，即一个微观态的概率与 $\\exp(-\\beta E)$ 成正比，且所有可及微观态的概率必须归一化，推导该双态系统的平均能量 $\\langle E \\rangle$ 和能量方差 $\\mathrm{Var}(E)$ 作为 $\\beta$、$\\Delta$、$g_A$ 和 $g_B$ 的函数的闭式解析表达式。然后，利用此二能级模型中能谱有上界的特性，分析当 $\\Delta > 0$ 且 $g_A, g_B$ 为有限值时，$\\beta$ 的符号如何影响 $A$ 和 $B$ 的相对布居数，并说明在 $\\beta > 0$ 和 $\\beta  0$ 时，哪个宏观态更占优势。\n\n将最终答案表示为 $\\langle E \\rangle$ 和 $\\mathrm{Var}(E)$ 的闭式表达式。不需要数值近似或四舍五入。最终答案中不要包含单位；能量的解释是相对于 $E_A = 0$。",
            "solution": "问题要求推导正则系综中一个双态系统的平均能量 $\\langle E \\rangle$ 和能量方差 $\\mathrm{Var}(E)$，并分析态布居数作为逆温度 $\\beta$ 符号的函数。推导从正则系综的基本原理开始。\n\n正则配分函数 $Z$ 是系统所有可及微观态 $i$ 的 Boltzmann 因子 $\\exp(-\\beta E_i)$ 的总和。\n$$Z = \\sum_{i} \\exp(-\\beta E_i)$$\n所描述的系统有两个宏观态 $A$ 和 $B$。宏观态 $A$ 由 $g_A$ 个微观态组成，每个微观态的能量为 $E_A = 0$。宏观态 $B$ 由 $g_B$ 个微观态组成，每个微观态的能量为 $E_B = \\Delta$。配分函数是对两个宏观态中所有微观态求和：\n$$Z = \\sum_{i \\in A} \\exp(-\\beta E_A) + \\sum_{j \\in B} \\exp(-\\beta E_B)$$\n由于给定宏观态内的所有微观态都是等能的，我们可以将此和写为：\n$$Z = g_A \\exp(-\\beta E_A) + g_B \\exp(-\\beta E_B)$$\n代入给定的能量值 $E_A = 0$ 和 $E_B = \\Delta$：\n$$Z = g_A \\exp(-\\beta \\cdot 0) + g_B \\exp(-\\beta \\Delta) = g_A + g_B \\exp(-\\beta \\Delta)$$\n\n系统处于能量为 $E_i$ 的任意特定微观态 $i$ 的概率由下式给出：\n$$P_i = \\frac{\\exp(-\\beta E_i)}{Z}$$\n系统处于某个宏观态的概率是其所有组成微观态的概率之和。\n处于宏观态 $A$ 的概率 $P(A)$ 是对其 $g_A$ 个微观态求和：\n$$P(A) = g_A \\cdot \\frac{\\exp(-\\beta E_A)}{Z} = \\frac{g_A \\exp(0)}{Z} = \\frac{g_A}{g_A + g_B \\exp(-\\beta \\Delta)}$$\n类似地，处于宏观态 $B$ 的概率 $P(B)$ 为：\n$$P(B) = g_B \\cdot \\frac{\\exp(-\\beta E_B)}{Z} = \\frac{g_B \\exp(-\\beta \\Delta)}{g_A + g_B \\exp(-\\beta \\Delta)}$$\n作为检验，概率和为 1：$P(A) + P(B) = \\frac{g_A + g_B \\exp(-\\beta \\Delta)}{g_A + g_B \\exp(-\\beta \\Delta)} = 1$。\n\n平均能量 $\\langle E \\rangle$ 是能量的期望值，计算方法为每个宏观态的能量乘以其概率，然后求和：\n$$\\langle E \\rangle = E_A P(A) + E_B P(B)$$\n代入能量和概率：\n$$\\langle E \\rangle = (0) \\cdot P(A) + (\\Delta) \\cdot P(B) = \\Delta P(B)$$\n$$\\langle E \\rangle = \\frac{\\Delta g_B \\exp(-\\beta \\Delta)}{g_A + g_B \\exp(-\\beta \\Delta)}$$\n这是平均能量的闭式表达式。\n\n能量方差 $\\mathrm{Var}(E)$ 定义为 $\\mathrm{Var}(E) = \\langle E^2 \\rangle - \\langle E \\rangle^2$。首先，我们计算能量的均方值 $\\langle E^2 \\rangle$：\n$$\\langle E^2 \\rangle = E_A^2 P(A) + E_B^2 P(B)$$\n$$\\langle E^2 \\rangle = (0)^2 \\cdot P(A) + (\\Delta)^2 \\cdot P(B) = \\Delta^2 P(B)$$\n$$\\langle E^2 \\rangle = \\frac{\\Delta^2 g_B \\exp(-\\beta \\Delta)}{g_A + g_B \\exp(-\\beta \\Delta)}$$\n现在，我们可以计算方差：\n$$\\mathrm{Var}(E) = \\langle E^2 \\rangle - \\langle E \\rangle^2 = \\frac{\\Delta^2 g_B \\exp(-\\beta \\Delta)}{g_A + g_B \\exp(-\\beta \\Delta)} - \\left( \\frac{\\Delta g_B \\exp(-\\beta \\Delta)}{g_A + g_B \\exp(-\\beta \\Delta)} \\right)^2$$\n为简化起见，令 $Z = g_A + g_B \\exp(-\\beta \\Delta)$。\n$$\\mathrm{Var}(E) = \\frac{\\Delta^2 g_B \\exp(-\\beta \\Delta)}{Z} - \\frac{\\Delta^2 g_B^2 \\exp(-2\\beta \\Delta)}{Z^2}$$\n将各项通分到共同的分母 $Z^2$ 上：\n$$\\mathrm{Var}(E) = \\frac{\\Delta^2 g_B \\exp(-\\beta \\Delta) Z - \\Delta^2 g_B^2 \\exp(-2\\beta \\Delta)}{Z^2}$$\n代入 $Z = g_A + g_B \\exp(-\\beta \\Delta)$：\n$$\\mathrm{Var}(E) = \\frac{\\Delta^2 g_B \\exp(-\\beta \\Delta) (g_A + g_B \\exp(-\\beta \\Delta)) - \\Delta^2 g_B^2 \\exp(-2\\beta \\Delta)}{Z^2}$$\n展开分子：\n$$\\mathrm{Var}(E) = \\frac{\\Delta^2 g_A g_B \\exp(-\\beta \\Delta) + \\Delta^2 g_B^2 \\exp(-2\\beta \\Delta) - \\Delta^2 g_B^2 \\exp(-2\\beta \\Delta)}{Z^2}$$\n分子中的第二项和第三项相互抵消，得到方差的简化表达式：\n$$\\mathrm{Var}(E) = \\frac{\\Delta^2 g_A g_B \\exp(-\\beta \\Delta)}{(g_A + g_B \\exp(-\\beta \\Delta))^2}$$\n这是能量方差的闭式表达式。\n\n最后，我们分析 $\\beta$ 的符号对宏观态 $A$ 和 $B$ 相对布居数的影响。相对布居数可以通过它们概率的比值来检验：\n$$\\frac{P(B)}{P(A)} = \\frac{g_B \\exp(-\\beta \\Delta) / Z}{g_A / Z} = \\frac{g_B}{g_A} \\exp(-\\beta \\Delta)$$\n\n情况 1：$\\beta > 0$（正温度，$T > 0$）。\n在这种情况下，由于 $\\Delta > 0$，指数的自变量 $-\\beta \\Delta$ 为负。这意味着 $0  \\exp(-\\beta \\Delta)  1$。Boltzmann 因子充当占据高能态 $B$ 的惩罚项。低能宏观态 $A$ 更占优势。当温度 $T \\to 0^+$ 时，$\\beta \\to +\\infty$，$\\exp(-\\beta \\Delta) \\to 0$，系统完全布居在态 $A$。当 $T \\to +\\infty$ 时，$\\beta \\to 0^+$，$\\exp(-\\beta \\Delta) \\to 1$，布居数由简并度的比值决定，$P(B)/P(A) \\to g_B/g_A$。对于所有正温度，能量惩罚使得高能态 $B$ 不占优势。\n\n情况 2：$\\beta  0$（负绝对温度，$T  0$）。\n这对于能谱有有限上界的系统具有物理意义，而该双态模型就具备此特性。令 $\\beta = -|\\beta|$，其中 $|\\beta| > 0$。指数的自变量 $-\\beta \\Delta = -(-|\\beta|) \\Delta = |\\beta| \\Delta$ 为正。这意味着 $\\exp(-\\beta \\Delta) > 1$。此时，Boltzmann 因子增强了高能态 $B$ 的布居数。这种现象被称为粒子数反转。高能宏观态 $B$ 更占优势。当温度 $T \\to 0^-$ 时，$\\beta \\to -\\infty$，$\\exp(-\\beta \\Delta) \\to +\\infty$，系统完全布居在最高能量态 $B$。负温度悖论性地比任何正温度都“更热”，因为它们驱使系统布居在其最高能级上。",
            "answer": "$$\n\\langle E \\rangle = \\boxed{\\frac{\\Delta g_B \\exp(-\\beta \\Delta)}{g_A + g_B \\exp(-\\beta \\Delta)}}\n$$\n$$\n\\mathrm{Var}(E) = \\boxed{\\frac{\\Delta^2 g_A g_B \\exp(-\\beta \\Delta)}{(g_A + g_B \\exp(-\\beta \\Delta))^2}}\n$$"
        },
        {
            "introduction": "现在，让我们挑战一个更真实、更复杂的场景：蛋白质结合口袋中的离子布居。本练习要求你将正则系综推广到巨正则系综 ($\\Xi$)，以处理粒子数可变的系统，并在此过程中考虑组合简并度和相互作用能。这项高级实践将理论推导与计算实现相结合，是计算化学生物学领域的一项核心技能，它展示了统计力学如何为模拟和预测分子结合现象提供坚实的理论基础 。",
            "id": "3865251",
            "problem": "一个大分子上的单个结合口袋包含$K$个等效亚位点，这些亚位点可被不可区分的单价离子（每个带$+1e$电荷）占据。微观态能量由一个粗粒化模型决定。在该模型中，每个结合的离子贡献一个单粒子结合能，口袋内的每一对不同离子贡献一个成对库仑相互作用能，该相互作用能已在位点几何构型和溶剂屏蔽效应下进行了有效平均。计算目标是为此结合口袋构建巨配分函数，并使用巨正则系综（GCE）计算其占据数分布。\n\n仅从统计力学和热力学的基本原理和定义出发，推导该口袋的巨配分函数表达式，该表达式需考虑以下因素：\n- 分布在$K$个等效亚位点上的不可区分离子（组合简并度），\n- 每个离子的单粒子结合能，\n- 口袋中任意两个离子之间的成对库仑排斥。\n\n在整个推导过程中统一使用摩尔单位：每个离子的结合能（单位为 $\\mathrm{kJ\\,mol^{-1}}$）、每对的成对相互作用能（单位为 $\\mathrm{kJ\\,mol^{-1}}$）、化学势（单位为 $\\mathrm{kJ\\,mol^{-1}}$）以及温度 $T$（单位为 $\\mathrm{K}$）。使用摩尔气体常数 $R$，单位为 $\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n\n然后，编写一个完整、可运行的程序，实现所推导的公式，以计算占据概率分布 $P(n)$，其中 $n \\in \\{0, 1, \\dots, K\\}$，$P(n)$ 是口袋中恰好包含 $n$ 个离子的概率（以小数表示，而非百分比）。您的程序必须精确处理 $K$ 个等效亚位点的简并度，并且必须将粗粒化的成对库仑相互作用作为每对的常数项包含在内。程序必须使用指定的精确单位，为以下测试用例集生成结果：\n\n- 测试用例1（存在排斥和有利结合的一般情况）：\n  - $K = 4$\n  - 单粒子结合能 $\\epsilon = -10\\,\\mathrm{kJ\\,mol^{-1}}$\n  - 每对的成对库仑能量 $J = 3\\,\\mathrm{kJ\\,mol^{-1}}$\n  - 化学势 $\\mu = -8\\,\\mathrm{kJ\\,mol^{-1}}$\n  - 温度 $T = 300\\,\\mathrm{K}$\n\n- 测试用例2（边界情况：无库仑相互作用）：\n  - $K = 4$\n  - $\\epsilon = -5\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $J = 0\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $\\mu = -5\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $T = 300\\,\\mathrm{K}$\n\n- 测试用例3（边缘情况：极高的化学势导致接近饱和）：\n  - $K = 4$\n  - $\\epsilon = -5\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $J = 3\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $\\mu = 20\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $T = 310\\,\\mathrm{K}$\n\n- 测试用例4（边缘情况：低温，伴随强排斥和不利的化学势）：\n  - $K = 3$\n  - $\\epsilon = -2\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $J = 6\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $\\mu = -4\\,\\mathrm{kJ\\,mol^{-1}}$\n  - $T = 50\\,\\mathrm{K}$\n\n对于每个测试用例，您的程序应计算列表 $\\left[P(0), P(1), \\dots, P(K)\\right]$，并以四舍五入到六位小数的十进制浮点数形式返回概率。最终输出格式必须是单行文本，包含一个由这些列表组成的、以逗号分隔的列表，并用方括号括起来，例如 $\\left[[p_{0}^{(1)},\\dots,p_{K}^{(1)}],[p_{0}^{(2)},\\dots,p_{K}^{(2)}],\\dots\\right]$。\n\n必须使用的假设：\n- 离子是不可区分的，亚位点是等效的。\n- 每对的粗粒化成对库仑能量 $J$ 是一个常数，反映了溶剂和位点几何构型的有效屏蔽效应。\n- 简并度源于在粗粒化模型下，从 $K$ 个亚位点中选择 $n$ 个被占据的亚位点（所有这些选择在能量上是等效的）的方式数。\n\n您的程序必须是完全自包含的，无需外部输入，并且必须使用 $R = 0.008314462618\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。所有概率都必须是小数（不带百分号）。不涉及角度。",
            "solution": "问题陈述已经过严格评估，并被确定为有效。它在科学上基于统计力学原理，提法恰当，具有一套完整且一致的参数，并以客观、正式的语言进行表述。因此，我们可以进行严谨的推导和求解。\n\n该问题要求使用巨正则系综（GCE）计算大分子结合口袋中离子的占据概率分布。GCE 是一个合适的框架，因为结合口袋（系统）与其周围环境（本体溶液）是开放的，可以进行粒子（离子）和能量的交换，而周围环境可视为一个具有恒定温度 $T$ 和化学势 $\\mu$ 的热浴和粒子浴。\n\nGCE的基石是巨配分函数，记为 $\\Xi$。它被定义为对系统可能容纳的所有粒子数 $n$ 的求和，并且对于每个 $n$，再对系统在该粒子数下可及的所有不同量子或经典状态（微观态）$i$ 进行求和。其一般形式为：\n$$\n\\Xi = \\sum_{n=0}^{\\infty} \\sum_{i} e^{-\\beta (E_{n,i} - n\\mu)}\n$$\n在我们的系统中，最大离子数受亚位点数 $K$ 的限制。因此，对 $n$ 的求和范围是从 $0$ 到 $K$。项 $\\beta$ 是逆热能，定义为 $\\beta = \\frac{1}{k_B T}$，其中 $k_B$ 是玻尔兹曼常数。由于问题指定能量使用摩尔单位，我们必须使用摩尔气体常数 $R$ 代替 $k_B$，因此 $\\beta = \\frac{1}{RT}$。\n\n推导的核心是定义能量 $E_{n,i}$，并计算由 $n$ 定义的给定宏观态的微观态数目。\n\n首先，我们定义一个由恰好 $n$ 个结合离子表征的单一微观态的能量。问题指定了一个粗粒化模型，其中所有 $K$ 个亚位点都是等效的。这带来一个关键推论：微观态的能量仅取决于粒子数 $n$，而与它们占据哪些具体亚位点无关。因此，对于给定的 $n$，所有微观态具有相同的能量，我们将其记为 $E_n$。该能量是两部分贡献的总和：\n1.  **单粒子结合能**：$n$ 个离子中的每一个都贡献能量 $\\epsilon$。$n$ 个离子的总贡献为 $n\\epsilon$。\n2.  **成对相互作用能**：口袋内每一对不同的离子之间存在排斥能 $J$。$n$ 个粒子中不同离子对的数量由二项式系数 $\\binom{n}{2} = \\frac{n(n-1)}{2}$ 给出。因此，总相互作用能为 $\\binom{n}{2}J$。\n\n综合这些项，任何具有 $n$ 个离子的微观态的总能量为：\n$$\nE_n = n\\epsilon + \\frac{n(n-1)}{2} J\n$$\n该公式对于空口袋正确地得出 $E_0 = 0$，对于含单个离子的口袋得出 $E_1 = \\epsilon$，因为当 $n2$ 时，成对项为零。\n\n接下来，我们必须确定与 $n$ 个结合离子对应的宏观态的简并度 $\\Omega(n)$。由于离子是不可区分的，且亚位点是等效的，简并度是从总共 $K$ 个可用亚位点中选择 $n$ 个被占据的亚位点的方式数。这是一个标准的组合问题，其解由二项式系数给出：\n$$\n\\Omega(n) = \\binom{K}{n} = \\frac{K!}{n!(K-n)!}\n$$\n\n在定义了每个宏观态的能量 $E_n$ 和简并度 $\\Omega(n)$ 之后，我们可以重写巨配分函数。对于一个固定的 $n$，对微观态 $i$ 的求和变成了一个简单的与简并度 $\\Omega(n)$ 的乘积，因为所有这些状态具有相同的玻尔兹曼因子：\n$$\n\\Xi = \\sum_{n=0}^{K} \\Omega(n) e^{-\\beta (E_n - n\\mu)}\n$$\n代入我们关于 $\\Omega(n)$ 和 $E_n$ 的表达式，我们得到该系统巨配分函数的完整表达式：\n$$\n\\Xi = \\sum_{n=0}^{K} \\binom{K}{n} \\exp\\left[-\\frac{1}{RT} \\left( n\\epsilon + \\frac{n(n-1)}{2} J - n\\mu \\right)\\right]\n$$\n该表达式对结合口袋所有可能的宏观态（由占据数 $n$ 定义）的统计权重进行求和。\n\n最后，在具有恰好 $n$ 个离子的宏观态中找到系统的概率 $P(n)$ 是该宏观态的统计权重与所有这些权重之和（即巨配分函数 $\\Xi$）的比值：\n$$\nP(n) = \\frac{\\binom{K}{n} \\exp\\left[-\\frac{1}{RT} \\left( n\\epsilon + \\frac{n(n-1)}{2} J - n\\mu \\right)\\right]}{\\Xi}\n$$\n\n计算占据数分布 $\\{P(0), P(1), \\dots, P(K)\\}$ 的计算算法如下：\n1.  定义常数 $K$、$\\epsilon$、$J$、$\\mu$、$T$ 和 $R=0.008314462618\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n2.  计算逆热能因子 $\\beta = \\frac{1}{RT}$。\n3.  创建一个数组或列表，用于存储从 $0$ 到 $K$ 的每个占据态 $n$ 的未归一化统计权重，我们称之为 $Z_n$。\n4.  从 $0$ 到 $K$ 遍历 $n$。在每次迭代中，计算：\n   a. 简并度 $\\Omega(n) = \\binom{K}{n}$。\n   b. 能量项 $E_n' = n\\epsilon + \\frac{n(n-1)}{2} J - n\\mu$。\n   c. 权重 $Z_n = \\Omega(n) \\exp(-\\beta E_n')$。\n5.  将所有权重求和以计算巨配分函数：$\\Xi = \\sum_{n=0}^{K} Z_n$。\n6.  通过归一化其权重来计算每个状态的概率：$P(n) = Z_n / \\Xi$。\n7.  将概率 $\\{P(0), P(1), \\dots, P(K)\\}$ 收集到一个列表中，并格式化到所需精度。对所提供的每个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import comb\n\n# language: Python\n# version: 3.12\n# libraries:\n#   - name: numpy\n#     version: 1.23.5\n#   - name: scipy\n#     version: 1.11.4\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating ion occupancy probabilities in a binding pocket\n    using the Grand Canonical Ensemble for the provided test cases.\n    \"\"\"\n    # Molar gas constant in kJ mol^{-1} K^{-1}\n    R_CONSTANT = 0.008314462618\n\n    # Define the test cases from the problem statement.\n    # Format: (K, epsilon, J, mu, T)\n    test_cases = [\n        # Test Case 1: general case\n        (4, -10.0, 3.0, -8.0, 300.0),\n        # Test Case 2: no Coulomb interactions\n        (4, -5.0, 0.0, -5.0, 300.0),\n        # Test Case 3: high chemical potential\n        (4, -5.0, 3.0, 20.0, 310.0),\n        # Test Case 4: low temperature\n        (3, -2.0, 6.0, -4.0, 50.0),\n    ]\n\n    all_results = []\n\n    for k_sites, epsilon, j_interaction, mu, temp in test_cases:\n        \n        # Calculate inverse thermal energy beta in (kJ/mol)^{-1}\n        beta = 1.0 / (R_CONSTANT * temp)\n        \n        # List to store the unnormalized statistical weights Z_n\n        zn_terms = []\n        \n        # Iterate over all possible occupancies n from 0 to K\n        for n in range(k_sites + 1):\n            # Calculate combinatorial degeneracy Omega(n)\n            # Use exact=False to ensure float output for compatibility with np.exp\n            degeneracy = comb(k_sites, n, exact=False)\n            \n            # Calculate the number of ion pairs\n            num_pairs = comb(n, 2, exact=False)\n            \n            # Calculate the energy of the macrostate with n ions\n            energy_n = n * epsilon + num_pairs * j_interaction\n            \n            # Calculate the grand canonical energy term (E_n - n*mu)\n            gce_energy = energy_n - n * mu\n            \n            # Calculate the unnormalized statistical weight Z_n\n            zn = degeneracy * np.exp(-beta * gce_energy)\n            zn_terms.append(zn)\n            \n        # The grand partition function is the sum of all weights\n        grand_partition_function = np.sum(zn_terms)\n        \n        # Calculate the probability distribution P(n) by normalizing\n        probabilities = [zn / grand_partition_function for zn in zn_terms]\n        \n        all_results.append(probabilities)\n\n    # Format the final output according to the problem specification.\n    # Create a list of strings, where each string is a list of probabilities.\n    # Probabilities are formatted to six decimal places.\n    # e.g., [\"[0.123456,0.876544]\", \"[0.500000,0.500000]\"]\n    formatted_results = []\n    for prob_list in all_results:\n        prob_strings = [f\"{p:.6f}\" for p in prob_list]\n        formatted_results.append(f\"[{','.join(prob_strings)}]\")\n\n    # Join the inner list strings and enclose in outer brackets.\n    # e.g., \"[[0.123456,0.876544],[0.500000,0.500000]]\"\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}