{
    "hands_on_practices": [
        {
            "introduction": "分子对接的核心挑战在于在巨大的构象空间中找到能量最低的结合模式。为了体会这一挑战的规模，这个练习将引导你对一个具有多个可旋转键的配体进行构象数量的简单计算。通过这个计算，你将亲身感受到为何穷举搜索在实际应用中是不可行的，并理解为何高效的启发式搜索算法是必不可少的 。",
            "id": "3854741",
            "problem": "在计算化学生物学中，分子对接算法通过搜索配体构象和受体排布来识别低能量的结合姿态。考虑一个具有$7$个可旋转单键（扭转自由度）的小分子配体。每个扭转角被离散化为$12$个等间距的角度，范围从$0^{\\circ}$到$330^{\\circ}$，增量为$30^{\\circ}$，并且受体被视为刚性，因此只改变配体的内扭转。所有其他配体自由度都固定在单个刚体位置上，以隔离内扭转的枚举。在穷举搜索中离散化扭转的标准独立性假设下，确定必须评估的不同配体构象的总数$N_{\\text{conf}}$。将$N_{\\text{conf}}$表示为一个精确的整数；无需四舍五入。\n\n然后，基于关于搜索空间增长的第一性原理推理，简要评论穷举枚举相对于典型对接搜索算法的可行性，以及引入受体柔性（例如，侧链旋转异构态）如何改变搜索空间的尺度变化。您的评论应该是定性的；不要提供运行时间的数值估计。",
            "solution": "该问题是有效的。它在科学上基于计算化学生物学中构象分析的原理，提法得当，提供了所有必要信息，并以客观、无歧义的语言表述。\n\n主要任务是基于扭转自由度的离散枚举，计算不同配体构象的总数，记为$N_{\\text{conf}}$。该系统由一个具有特定数量可旋转键的配体和一个刚性受体定义，从而将构象搜索隔离到配体的内坐标上。\n\n从问题陈述中提取的已知条件是：\n- 可旋转键（扭转自由度）的数量，$k = 7$。\n- 每个扭转的离散角度状态数量，$m = 12$。\n- 受体被视为刚性，这意味着它对整个系统构型只贡献一种状态。\n- 自由度被假定为独立的，这是此类组合计算的标准起点。\n\n在假设$k$个扭转自由度中的每一个都相互独立的情况下，可能的构象总数是每个自由度可用状态数的乘积。这是组合学中乘法原理的一个基本应用。如果有$k$个独立的选择要做，且第$i$个选择有$m_i$个选项，则总的组合数是乘积$\\prod_{i=1}^{k} m_i$。在这个问题中，所有扭转的状态数都相同，所以对于从$1$到$k$的所有$i$，$m_i = m = 12$。\n\n因此，总构象数$N_{\\text{conf}}$由以下表达式给出：\n$$N_{\\text{conf}} = m^k$$\n代入给定的值$m = 12$和$k = 7$：\n$$N_{\\text{conf}} = 12^7$$\n我们计算其精确整数值：\n$$N_{\\text{conf}} = 12 \\times 12 \\times 12 \\times 12 \\times 12 \\times 12 \\times 12 = 144 \\times 144 \\times 144 \\times 12 = 20736 \\times 1728 = 35,831,808$$\n所以，在穷举搜索中必须评估总共$35,831,808$个不同的配体构象。\n\n问题的第二部分要求对这种方法的可行性以及受体柔性的影响进行定性评论。\n计算出的构象数，接近$3600$万，是相当大的。穷举枚举，或称网格搜索，将需要通过打分函数生成并评估这些构象中的每一个的能量。即使使用计算高效的打分函数，这个过程也非常耗时，并且对于常规对接计算通常被认为是不可行的。搜索空间随自由度数量线性增加而发生的这种快速指数级增长是组合爆炸的典型例子。正是这一挑战推动了启发式搜索算法（例如，遗传算法、蒙特卡洛方法）的发展，这些算法通过选择性地采样有希望的区域，而不是试图访问每个可能的状态，来更有效地导航这个巨大的空间。\n\n引入受体柔性会极大地加剧这个问题。如果受体不再是刚性的，并且其一组$j$个侧链被允许是柔性的，每个侧链都有自己的一组$n_i$个离散的旋转状态（旋转异构体），那么受体的构象空间大小变为$N_{\\text{receptor}} = \\prod_{i=1}^{j} n_i$。由于配体和受体的自由度在一阶近似中通常也被视为独立的，因此柔性受体系统的总搜索空间大小$N_{\\text{total}}$成为各个状态数的乘积：\n$$N_{\\text{total}} = N_{\\text{conf}} \\times N_{\\text{receptor}} = (m^k) \\times \\left(\\prod_{i=1}^{j} n_i\\right)$$\n因此，尺度变化是乘性的。无论是配体还是受体上的每一个额外的柔性元素，都会为搜索问题增加一个新的维度，导致总搜索空间呈指数级增长。这种现象被称为“维度灾难”。即使只允许少数几个侧链具有柔性（例如，$3$个侧链，每个有$10$个旋转异构体，会使搜索空间乘以$10^3 = 1000$倍），也可能使穷举枚举完全不可行。这就需要使用更复杂的方法，如系综对接或诱导契合对接方案，这些方法旨在处理蛋白质-配体结合的巨大复杂性，其中两个伙伴都可以调整各自的构象。",
            "answer": "$$\\boxed{35831808}$$"
        },
        {
            "introduction": "既然我们知道无法对整个搜索空间进行详尽的探索，那么如何才能有效地引导搜索算法走向更有可能性的区域呢？一个关键策略是引入化学约束，例如强制执行特定的键长或相互作用几何。本练习探讨了如何在基于蒙特卡洛的随机搜索算法中实施“硬约束”，并分析其对构象接受概率的影响，从而加深你对算法如何结合物理化学知识进行优化的理解 。",
            "id": "3854817",
            "problem": "一个对接引擎评估配体在含有二价金属离子的蛋白质活性位点中的构象。为反映配位化学，该模型包含了一个金属与特定配体供体原子之间的硬距离约束。目标金属-供体距离为 $d_0 = 2.1\\,\\text{\\AA}$，对称容差为 $\\tau = 0.2\\,\\text{\\AA}$。搜索使用基于平衡统计力学中Metropolis准则的随机采样器，并通过联合采样离散的侧链旋转异构体、配体内部坐标和刚体自由度来支持受体柔性。一次试探性移动提出了一个构象，其中瞬时金属-供体距离为 $d = 2.35\\,\\text{\\AA}$。在评分和接受过程中，硬约束作为不可协商的可行性条件被强制执行。\n\n根据第一性原理——即硬约束的定义（排除可行集之外的状态）、Metropolis采样中接受规则的玻尔兹曼形式，以及移动是根据其最终提出的状态进行评估的概念——确定哪些陈述是正确的。\n\nA. $d = 2.35\\,\\text{\\AA}$ 处的构象满足约束，因为对于金属配位，容差应在 $d_0$ 的较长一侧不对称地应用，因此最长可接受的距离为 $2.4\\,\\text{\\AA}$；在实践中，所谓的硬约束是作为陡峭但有限的谐波势罚实现的，允许根据温度偶尔接受。\n\nB. $d = 2.35\\,\\text{\\AA}$ 处的构象违反了约束，因为可接受的区间是 $[d_0 - \\tau,\\, d_0 + \\tau] = [1.9\\,\\text{\\AA},\\, 2.3\\,\\text{\\AA}]$；当通过排除此区间外的状态（等效于在此处分配无限能量）来强制执行硬约束时，在任何温度下，这种违规移动的Metropolis接受概率都为 $0$。\n\nC. $d = 2.35\\,\\text{\\AA}$ 处的构象违反了约束，但在模拟退火中，在足够高的温度下，违反硬约束的移动仍可能以概率 $p = \\exp(-\\beta \\Delta E)$ 被接受，因为在实践中没有能量壁垒是真正无限的。\n\nD. 在联合采样侧链旋转异构体的柔性受体对接中，以 $d = 2.35\\,\\text{\\AA}$ 结束的单步提议在硬约束下被拒绝；然而，一个同时调整侧链和配体以达到例如 $d = 2.25\\,\\text{\\AA}$ 的复合提议将是可接受的，并且如果其他方面有利，则可以被接受。硬约束通过从考虑中消除所有 $d \\notin [1.9\\,\\text{\\AA},\\, 2.3\\,\\text{\\AA}]$ 的状态来减少可及的搜索空间。",
            "solution": "问题陈述经评估有效。它在计算化学生物学领域内提出了一个科学上合理且定义明确的情景，使用了标准术语和现实的物理参数。该问题是客观的，并包含足够的信息，可以根据指定的第一性原理推导出唯一答案。\n\n我们首先根据所提供的第一性原理将问题形式化。\n\n1.  **可行状态空间**：问题定义了一个硬距离约束，目标距离 $d_0 = 2.1\\,\\text{\\AA}$，对称容差 $\\tau = 0.2\\,\\text{\\AA}$。“硬约束”被定义为“排除可行集之外的状态”。因此，只有当金属-供体距离 $d$ 位于区间 $[d_0 - \\tau, d_0 + \\tau]$ 内时，配体构象才被认为是可行的。\n    代入给定值，可接受的距离范围是：\n    $$ [2.1\\,\\text{\\AA} - 0.2\\,\\text{\\AA}, 2.1\\,\\text{\\AA} + 0.2\\,\\text{\\AA}] = [1.9\\,\\text{\\AA}, 2.3\\,\\text{\\AA}] $$\n    问题描述了一次试探性移动，提出了一个距离为 $d = 2.35\\,\\text{\\AA}$ 的构象。由于 $2.35\\,\\text{\\AA} > 2.3\\,\\text{\\AA}$，这个被提出的状态位于可行集之外，因此违反了硬约束。\n\n2.  **Metropolis准则与硬约束**：从状态 $i$ 移动到状态 $j$ 的Metropolis接受概率 $P_{\\text{acc}}$ 由下式给出：\n    $$ P_{\\text{acc}}(i \\to j) = \\min\\left(1, \\exp\\left(-\\frac{\\Delta E}{k_B T}\\right)\\right) = \\min(1, e^{-\\beta \\Delta E}) $$\n    其中 $\\Delta E = E_j - E_i$ 是系统能量的变化，而 $\\beta = 1/(k_B T)$。硬约束被解释为“排除状态”，在统计力学框架中，通过为所有不可行状态分配无限的势能来正式实现。\n    如果状态 $j$ 是所提出的 $d = 2.35\\,\\text{\\AA}$ 的构象，它是一个不可行状态。因此，其能量为 $E_j = \\infty$。假设初始状态 $i$ 是一个可行状态（这是模拟得以进行的必要条件），其能量 $E_i$ 是有限的。能量变化为：\n    $$ \\Delta E = E_j - E_i = \\infty - E_i = \\infty $$\n    因此，这次移动的接受概率为：\n    $$ P_{\\text{acc}} = \\min(1, e^{-\\beta \\cdot \\infty}) = \\min(1, 0) = 0 $$\n    这个结果对于任何有限温度 $T > 0$（因此，任何有限的正 $\\beta$）都成立。概率为 $0$ 意味着该移动总是被拒绝。\n\n3.  **评估所提出的移动**：问题指出，移动是根据其最终提出的状态进行评估的。最终状态的 $d = 2.35\\,\\text{\\AA}$，这是不可行的。因此，对接引擎必须直接拒绝这次移动。\n\n在此框架建立后，我们评估每个选项。\n\n**A. $d = 2.35\\,\\text{\\AA}$ 处的构象满足约束，因为对于金属配位，容差应在 $d_0$ 的较长一侧不对称地应用，因此最长可接受的距离为 $2.4\\,\\text{\\AA}$；在实践中，所谓的硬约束是作为陡峭但有限的谐波势罚实现的，允许根据温度偶尔接受。**\n这个陈述不正确，主要有两个原因。首先，它声称容差“应不对称地应用”，这直接与问题中明确说明容差 $\\tau$ 是**对称的**相矛盾。其次，它将“硬约束”重新定义为“陡峭但有限的谐波势罚”。这描述的是*软*约束，而非硬约束。问题明确将硬约束定义为“不可协商的可行性条件”和“排除状态”，这对应于无限的能量惩罚，而不是有限的能量惩罚。\n**结论：不正确。**\n\n**B. $d = 2.35\\,\\text{\\AA}$ 处的构象违反了约束，因为可接受的区间是 $[d_0 - \\tau,\\, d_0 + \\tau] = [1.9\\,\\text{\\AA},\\, 2.3\\,\\text{\\AA}]$；当通过排除此区间外的状态（等效于在此处分配无限能量）来强制执行硬约束时，在任何温度下，这种违规移动的Metropolis接受概率都为 $0$。**\n这个陈述完全正确。它正确地计算了可行区间 $[1.9\\,\\text{\\AA}, 2.3\\,\\text{\\AA}]$，并指出了 $d = 2.35\\,\\text{\\AA}$ 处的构象违反了约束。然后，它正确地将硬约束的概念与无限能量惩罚联系起来，并从Metropolis准则中正确推断出，对于任何非零的有限温度，此类移动的接受概率恰好为 $0$。这个分析是所指定第一性原理的直接应用。\n**结论：正确。**\n\n**C. $d = 2.35\\,\\text{\\AA}$ 处的构象违反了约束，但在模拟退火中，在足够高的温度下，违反硬约束的移动仍可能以概率 $p = \\exp(-\\beta \\Delta E)$ 被接受，因为在实践中没有能量壁垒是真正无限的。**\n这个陈述不正确。虽然高温（小的 $\\beta$）会增加接受能量上不利移动的概率，但它无法克服无限的能量壁垒。如上所述，如果 $\\Delta E = \\infty$，则对于任何 $\\beta > 0$（即任何有限温度 $T$），接受概率为 $e^{-\\beta \\cdot \\infty} = 0$。认为“在实践中没有能量壁垒是真正无限的”这一论点是关于物理世界的一个形而上学的主张，与分析指定的**计算模型**无关，在该模型中，无限壁垒是明确定义并用于执行硬约束的。\n**结论：不正确。**\n\n**D. 在联合采样侧链旋转异构体的柔性受体对接中，以 $d = 2.35\\,\\text{\\AA}$ 结束的单步提议在硬约束下被拒绝；然而，一个同时调整侧链和配体以达到例如 $d = 2.25\\,\\text{\\AA}$ 的复合提议将是可接受的，并且如果其他方面有利，则可以被接受。硬约束通过从考虑中消除所有 $d \\notin [1.9\\,\\text{\\AA},\\, 2.3\\,\\text{\\AA}]$ 的状态来减少可及的搜索空间。**\n这个陈述是三个正确断言的集合，它们准确地描述了对接过程。\n1.  初始的断言，即以 $d = 2.35\\,\\text{\\AA}$ 结束的提议被拒绝是正确的，原因在选项B的分析中已详细说明。\n2.  达到 $d = 2.25\\,\\text{\\AA}$ 的复合移动的对比示例也是正确的。由于 $2.25\\,\\text{\\AA}$ 在可行区间 $[1.9\\,\\text{\\AA}, 2.3\\,\\text{\\AA}]$ 内，这样的移动是“可接受的”。它是否被接受取决于有限的能量变化 $\\Delta E$ 和Metropolis准则。提及“复合提议”正确地将此逻辑与问题中柔性受体对接和联合采样的背景联系起来。\n3.  最后一句，指出硬约束通过消除可行区间外的状态来减少可及的搜索空间，是对问题提示中给出的排除原则的正确重述。\n该陈述的所有部分都与第一性原理和问题描述一致。\n**结论：正确。**\n\n选项B和D都是从前提中得出的正确陈述。选项B提供了基于统计力学的严谨、低层次的解释。选项D提供了对算法行为及其对搜索的影响的正确、高层次的描述，并正确地结合了问题中提到的柔性对接的具体背景。由于问题要求确定哪些陈述是正确的，并且B和D都经得起推敲，因此两者都必须被选中。",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "在真实的生物系统中，受体蛋白并非静止不动，其柔性对配体结合起着至关重要的作用。本练习将介绍一种处理受体柔性的高级方法——系综对接，它利用统计力学的原理来更准确地评估结合亲和力。你将学习如何通过玻尔兹曼分布对不同受体构象的结合能进行加权平均，并理解为何系综平均能比单一构象提供更真实、更可靠的能量评估 。",
            "id": "3854780",
            "problem": "在考虑受体柔性的分子对接中，可以使用一个受体构象系综，通过在正则系综中对构象进行平均，来估计配体的有效结合能。考虑三种受体构象异构体，它们与一个固定配体的有效结合能分别为 $E_1=-7.0$、$E_2=-8.5$ 和 $E_3=-6.5$（单位均为千卡/摩尔）。温度为 $T=300$（开尔文）。从正则系综和玻尔兹曼分布出发，推导系综平均结合能 $E_{\\text{ens}}$ 的适当表达式，并根据给定数据计算其值。使用摩尔气体常数 $R=1.987204258\\times 10^{-3}$，单位为千卡/摩尔/开尔文。最终能量以千卡/摩尔为单位表示，并将您的答案四舍五入到四位有效数字。在您的推理过程中，将 $E_{\\text{ens}}$ 与集合中的最低能量进行比较，以评估系综平均的益处。",
            "solution": "用户提供的问题已经过分析，被认为是有效的。该问题在科学上基于应用于计算化学生物学的统计力学原理，问题表述清晰（适定），数据充分且一致，并以客观语言表达。因此，我们可以着手解决。\n\n问题要求计算配体与包含三种受体构象的系综相互作用时的系综平均结合能 $E_{\\text{ens}}$。该系统由一个处于恒定温度 $T$ 下的正则系综描述。\n\n根据统计力学原理，在热平衡状态下，系统处于能量为 $E_i$ 的特定微观态 $i$ 的概率 $p_i$ 由玻尔兹曼分布给出。对于一个离散的状态集（在本例中为受体构象），系统处于构象状态 $i$ 的概率为：\n$$\np_i = \\frac{\\exp\\left(-\\frac{E_i}{RT}\\right)}{Q}\n$$\n其中 $E_i$ 是第 $i$ 个构象的能量，$R$ 是摩尔气体常数，$T$ 是绝对温度。项 $Q$ 是正则配分函数，它作为归一化常数，定义为所有可能状态的玻尔兹曼因子之和：\n$$\nQ = \\sum_{j} \\exp\\left(-\\frac{E_j}{RT}\\right)\n$$\n系综平均结合能 $E_{\\text{ens}}$ 是能量的期望值，通过将每个状态的能量 $E_i$ 按其相应概率 $p_i$ 加权求和得到：\n$$\nE_{\\text{ens}} = \\langle E \\rangle = \\sum_{i} p_i E_i\n$$\n将 $p_i$ 和 $Q$ 的表达式代入此方程，得到系综平均能量的通用公式：\n$$\nE_{\\text{ens}} = \\sum_{i} \\left( \\frac{\\exp\\left(-\\frac{E_i}{RT}\\right)}{Q} \\right) E_i = \\frac{\\sum_{i} E_i \\exp\\left(-\\frac{E_i}{RT}\\right)}{\\sum_{i} \\exp\\left(-\\frac{E_i}{RT}\\right)}\n$$\n这就是所求的表达式。现在，我们将使用提供的数据计算其值。\n\n给定的参数是：\n- 受体构象结合能：$E_1 = -7.0~\\text{kcal/mol}$，$E_2 = -8.5~\\text{kcal/mol}$，以及 $E_3 = -6.5~\\text{kcal/mol}$。\n- 温度：$T = 300~\\text{K}$。\n- 摩尔气体常数：$R = 1.987204258 \\times 10^{-3}~\\text{kcal mol}^{-1}~\\text{K}^{-1}$。\n\n首先，我们计算热能项 $RT$：\n$$\nRT = (1.987204258 \\times 10^{-3}~\\text{kcal mol}^{-1}~\\text{K}^{-1}) \\times (300~\\text{K}) = 0.5961612774~\\text{kcal/mol}\n$$\n接下来，我们计算每个构象的未归一化统计权重，即玻尔兹曼因子 $w_i = \\exp(-E_i / RT)$：\n$$\nw_1 = \\exp\\left(-\\frac{-7.0}{0.5961612774}\\right) = \\exp(11.74170) \\approx 125695.55 \\\\\nw_2 = \\exp\\left(-\\frac{-8.5}{0.5961612774}\\right) = \\exp(14.25793) \\approx 1556426.6 \\\\\nw_3 = \\exp\\left(-\\frac{-6.5}{0.5961612774}\\right) = \\exp(10.90314) \\approx 54336.56\n$$\n配分函数 $Q$ 是这些权重的总和：\n$$\nQ = w_1 + w_2 + w_3 \\approx 125695.55 + 1556426.6 + 54336.56 \\approx 1736458.71\n$$\n现在，我们计算 $E_{\\text{ens}}$ 表达式的分子，即由其玻尔兹曼因子加权的能量之和：\n$$\n\\sum_{i} E_i w_i = (E_1 \\times w_1) + (E_2 \\times w_2) + (E_3 \\times w_3) \\\\\n\\approx (-7.0 \\times 125695.55) + (-8.5 \\times 1556426.6) + (-6.5 \\times 54336.56) \\\\\n\\approx -879868.85 - 13229626.1 - 353187.64 \\approx -14462682.6\n$$\n最后，我们计算 $E_{\\text{ens}}$：\n$$\nE_{\\text{ens}} = \\frac{\\sum_{i} E_i w_i}{Q} \\approx \\frac{-14462682.6}{1736458.71} \\approx -8.3287785~\\text{kcal/mol}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nE_{\\text{ens}} \\approx -8.329~\\text{kcal/mol}\n$$\n问题的最后一部分要求将 $E_{\\text{ens}}$ 与集合中的最低能量进行比较。最低能量为 $E_{\\min} = E_2 = -8.5~\\text{kcal/mol}$。我们观察到 $E_{\\text{ens}} = -8.329~\\text{kcal/mol} > E_2 = -8.5~\\text{kcal/mol}$。系综平均能量的负值较小（即能量更高，表明有效结合更弱），高于最稳定构象的最低能量。\n\n这个结果在物理上是符合预期的，并凸显了系综平均的益处。一个简化的模型可能只考虑单个最有利的构象（$E_2$），从而得出估计的结合能为 $-8.5~\\text{kcal/mol}$。然而，系统是动态的，在有限温度下可以访问其他不太稳定的构象（$E_1$ 和 $E_3$），尽管概率较低。系综平均 $E_{\\text{ens}}$ 正确地考虑了这些高能态的热布居。这些状态的存在提供了一种熵的贡献，有效地将整个系统的能量从可能的最低值提高。因此，$E_{\\text{ens}}$ 提供了一个比任何单一构象的能量更符合热力学实际、通常也更准确的有效结合亲和力估计。通过这种方式考虑受体柔性，可以避免高估配体的结合强度。",
            "answer": "$$\n\\boxed{-8.329}\n$$"
        }
    ]
}