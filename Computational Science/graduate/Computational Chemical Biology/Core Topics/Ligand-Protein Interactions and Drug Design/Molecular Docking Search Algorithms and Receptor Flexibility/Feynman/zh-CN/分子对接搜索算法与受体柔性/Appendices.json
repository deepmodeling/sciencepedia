{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的搜索算法之前，我们首先需要量化我们所面临的挑战的规模。分子对接的核心是探索一个巨大的构象空间，而这个空间的大小会随着分子自由度的增加而呈指数级增长。这项练习  通过一个简单的例子，具体计算一个配体的构象数量，让您亲身体会“组合爆炸”问题，并理解为何蛮力枚举法在实际应用中是不可行的。",
            "id": "3854741",
            "problem": "在计算化学生物学中，分子对接算法通过搜索配体构象和受体排列来识别低能量的结合姿态。考虑一个具有 $7$ 个可旋转单键（扭转自由度）的小分子配体。每个扭转角被离散化为 $12$ 个等间距的角度，范围从 $0^{\\circ}$ 到 $330^{\\circ}$，增量为 $30^{\\circ}$。受体被视为刚性，因此只有配体的内部扭转角会发生变化。所有其他配体自由度都固定在单一的刚体位置上，以隔离对内部扭转角的枚举。在穷举搜索中，根据离散化扭转角的标准独立性假设，确定必须评估的不同配体构象的总数 $N_{\\text{conf}}$。将 $N_{\\text{conf}}$ 表示为一个精确整数；无需四舍五入。\n\n然后，基于关于搜索空间增长的第一性原理推理，简要评论在典型对接搜索算法背景下穷举枚举的可行性，以及引入受体柔性（例如，侧链旋转异构态）如何改变搜索空间的尺度变化。您的评论应为定性评论；不要提供运行时间的数值估计。",
            "solution": "该问题是有效的。它在科学上基于计算化学生物学中构象分析的原理，问题陈述清晰，提供了所有必要信息，并以客观、明确的语言表达。\n\n主要任务是基于扭转自由度的离散枚举，计算不同配体构象的总数，记为 $N_{\\text{conf}}$。该系统由一个具有特定数量可旋转键的配体和一个刚性受体定义，从而将构象搜索隔离到配体的内部坐标上。\n\n从问题陈述中提取的已知条件是：\n- 可旋转键（扭转自由度）的数量，$k = 7$。\n- 每个扭转角的离散角状态数，$m = 12$。\n- 受体被视为刚性，这意味着它对整个系统构型只贡献一个状态。\n- 自由度被假设为相互独立的，这是此类组合计算的标准起点。\n\n在假设 $k$ 个扭转自由度中的每一个都与其他自由度相互独立的情况下，可能的构象总数是每个自由度可用状态数的乘积。这是组合数学中乘法原理的一个基本应用。如果有 $k$ 个独立的选择要做，且第 $i$ 个选择有 $m_i$ 个选项，那么总的组合数就是乘积 $\\prod_{i=1}^{k} m_i$。在这个问题中，所有扭转角的状态数都相同，因此对于从 $1$ 到 $k$ 的所有 $i$，$m_i = m = 12$。\n\n因此，构象总数 $N_{\\text{conf}}$ 由以下表达式给出：\n$$N_{\\text{conf}} = m^k$$\n代入给定的值 $m = 12$ 和 $k = 7$：\n$$N_{\\text{conf}} = 12^7$$\n我们计算精确的整数值：\n$$N_{\\text{conf}} = 12 \\times 12 \\times 12 \\times 12 \\times 12 \\times 12 \\times 12 = 144 \\times 144 \\times 144 \\times 12 = 20736 \\times 1728 = 35,831,808$$\n因此，在穷举搜索中，总共必须评估 $35,831,808$ 个不同的配体构象。\n\n问题的第二部分要求对这种方法的可行性以及受体柔性的影响进行定性评论。\n计算出的构象数，接近 $3600$ 万，是相当大的。穷举枚举（或网格搜索）需要通过打分函数生成并评估这些构象中每一个的能量。即使使用计算高效的打分函数，这个过程也非常耗时，对于常规的对接计算通常被认为是不可行的。搜索空间随自由度数量线性增加而呈指数级快速增长，是组合爆炸的典型例子。正是这一挑战推动了启发式搜索算法（例如，遗传算法、蒙特卡洛方法）的发展，这些算法可以通过选择性地对有希望的区域进行采样，从而更有效地导航这个巨大的空间，而不是试图访问所有可能的状态。\n\n引入受体柔性会极大地加剧这个问题。如果受体不再是刚性的，并且其一组 $j$ 个侧链被允许是柔性的，每个侧链都有自己的一组 $n_i$ 个离散的旋转状态（旋转异构体），那么受体的构象空间大小就变为 $N_{\\text{receptor}} = \\prod_{i=1}^{j} n_i$。由于配体和受体的自由度在初步近似中通常也被视为独立的，因此柔性受体系统的总搜索空间大小 $N_{\\text{total}}$ 成为各个状态数的乘积：\n$$N_{\\text{total}} = N_{\\text{conf}} \\times N_{\\text{receptor}} = (m^k) \\times \\left(\\prod_{i=1}^{j} n_i\\right)$$\n因此，尺度变化是乘性的。每一个额外的柔性元素，无论是在配体上还是在受体上，都会给搜索问题增加一个新的维度，导致总搜索空间呈指数级增长。这种现象被称为“维度灾难”。即使只允许少数几个侧链具有柔性（例如， $3$ 个侧链各有 $10$ 个旋转异构体，就会使搜索空间乘以 $10^3 = 1000$ 倍），也可能使穷举枚举变得完全不可行。这就需要使用更复杂的方法，如系综对接或诱导契合对接协议，这些方法旨在处理蛋白质-配体结合的巨大复杂性，其中结合双方都可以调整其构象。",
            "answer": "$$\\boxed{35831808}$$"
        },
        {
            "introduction": "当对接算法成功找到一个潜在的结合姿态后，我们如何客观地评估其准确性？在计算化学中，均方根偏差（Root Mean Square Deviation, RMSD）是比较预测结构与实验（如晶体学）结构之间几何差异的黄金标准。本练习  将指导您完成从原子间距离的平方和计算 RMSD 的基本过程，这是验证对接结果和评估算法性能的一项必备技能。",
            "id": "3854765",
            "problem": "在考虑受体柔性的基于结构的分子对接中，通常使用受体构象系综来近似模拟侧链和骨架的重排。考虑这样一个方案：使用带有局部优化的多起点全局搜索（例如，带有基于梯度的局部搜索的遗传算法(GA)）将配体对接到构象系综中，然后从系综中选取得分最高的构象，并与晶体学参考配体进行几何评估。通过最小二乘法拟合（例如，Kabsch算法）进行最佳刚体叠合后，可以得到匹配重原子对之间的距离平方和。请仅使用三维基本欧几里得距离和均方根偏差（RMSD）的定义，推导出从匹配原子间的距离平方和计算RMSD所需的表达式。\n\n已知匹配原子数为 $N=10$，最佳比对后的距离平方和为 $S=12.5\\ \\text{\\AA}^{2}$。请计算此构象的RMSD，并根据构象复现常用的成功标准 $2.0\\ \\text{\\AA}$，判断对接是否成功。\n\n将您的RMSD最终数值答案四舍五入至四位有效数字，并以埃为单位表示。您最终报告的值必须仅为RMSD。",
            "solution": "该问题要求推导均方根偏差（RMSD）的表达式，并根据所提供的数据进行后续计算。验证过程确认，该问题陈述在科学上是合理的、提法明确、客观，并包含了获得唯一解所需的所有信息。因此，我们可以进行推导和计算。\n\n设待比较的两组原子坐标由位置向量表示。设对接配体构象的 $N$ 个坐标集合为 $\\{\\mathbf{p}_1, \\mathbf{p}_2, \\ldots, \\mathbf{p}_N\\}$，晶体学参考配体的 $N$ 个坐标集合为 $\\{\\mathbf{q}_1, \\mathbf{q}_2, \\ldots, \\mathbf{q}_N\\}$。问题陈述中提到，已经执行了最佳刚体叠合，这意味着其中一组坐标（例如 $\\{\\mathbf{p}_i\\}$）已经过平移和旋转，以最小化其与另一组坐标 $\\{\\mathbf{q}_i\\}$ 之间的距离平方和。\n\n第 $i$ 对匹配原子之间的欧几里得距离平方 $d_i^2$ 由其位置向量之差的模的平方给出：\n$$d_i^2 = \\|\\mathbf{p}_i - \\mathbf{q}_i\\|^2$$\n问题将量 $S$ 定义为所有 $N$ 个匹配原子对的距离平方之和。我们可以将其正式表示为：\n$$S = \\sum_{i=1}^{N} d_i^2 = \\sum_{i=1}^{N} \\|\\mathbf{p}_i - \\mathbf{q}_i\\|^2$$\n根据定义，均方根偏差（RMSD）是距离平方均值的平方根。距离平方的均值是通过将距离平方和 $S$ 除以测量次数（即匹配的原子数 $N$）得到的。\n\n因此，均方距离（MSD）为：\n$$\\text{MSD} = \\frac{1}{N} \\sum_{i=1}^{N} d_i^2$$\n将给定的量 $S$ 代入此表达式，我们得到：\n$$\\text{MSD} = \\frac{S}{N}$$\nRMSD 是 MSD 的平方根。因此，用 $S$ 和 $N$ 表示的 RMSD 的推导表达式为：\n$$\\text{RMSD} = \\sqrt{\\text{MSD}} = \\sqrt{\\frac{S}{N}}$$\n这就是问题所要求的表达式。\n\n我们已知以下数值：\n匹配的原子数，$N = 10$。\n距离平方和，$S = 12.5\\ \\text{\\AA}^{2}$。\n\n将这些数值代入推导出的 RMSD 表达式：\n$$\\text{RMSD} = \\sqrt{\\frac{12.5\\ \\text{\\AA}^{2}}{10}}$$\n$$\\text{RMSD} = \\sqrt{1.25\\ \\text{\\AA}^{2}}$$\n计算其数值：\n$$\\text{RMSD} = \\sqrt{1.25}\\ \\text{\\AA} \\approx 1.1180339887\\ldots\\ \\text{\\AA}$$\n问题要求将答案四舍五入到四位有效数字。\n$$\\text{RMSD} \\approx 1.118\\ \\text{\\AA}$$\n问题还要求根据构象复现的成功标准（即 RMSD 小于或等于 $2.0\\ \\text{\\AA}$）来评估此结果。我们计算出的值为 $\\text{RMSD} \\approx 1.118\\ \\text{\\AA}$。将其与标准进行比较：\n$$1.118\\ \\text{\\AA} \\leq 2.0\\ \\text{\\AA}$$\n此不等式成立。因此，根据指定的标准，该对接被认为是成功的。然而，问题只要求在最终答案中给出 RMSD 值。",
            "answer": "$$\\boxed{1.118}$$"
        },
        {
            "introduction": "将受体视为刚性是分子对接中一个常见的简化假设，但蛋白质在现实中是柔性的。为了构建更精确的模型，我们可以使用受体构象集合来考虑其柔性，但这需要我们从统计力学的角度来分析问题。此练习  运用玻尔兹曼分布来计算系综平均结合能 $E_{\\text{ens}}$，展示了如何超越寻找单一最低能量构象的简单思维，从而获得对结合亲和力更具热力学真实性的评估。",
            "id": "3854780",
            "problem": "在考虑受体柔性的分子对接中，可以通过对正则系综中的构象进行平均，来估算配体的有效结合能。考虑三个受体构象，其对于一个固定配体的有效结合能分别为 $E_1=-7.0$、$E_2=-8.5$ 和 $E_3=-6.5$（单位均为千卡/摩尔）。温度为 $T=300$（开尔文）。从正则系综和玻尔兹曼分布出发，推导系综平均结合能 $E_{\\text{ens}}$ 的恰当表达式，并根据给定数据计算其值。使用摩尔气体常数 $R=1.987204258 \\times 10^{-3}$，单位为千卡/摩尔/开尔文。最终能量以千卡/摩尔为单位表示，并将答案四舍五入至四位有效数字。在你的推理中，将 $E_{\\text{ens}}$ 与集合中的最低能量进行比较，以评估系综平均的优势。",
            "solution": "用户提供的问题已经过分析，被认为是有效的。该问题科学上基于应用于计算化学生物学的统计力学原理，问题阐述清晰，数据充分且一致，并以客观语言表述。因此，我们可以开始进行解答。\n\n该问题要求计算配体与包含三个受体构象的系综相互作用时的系综平均结合能 $E_{\\text{ens}}$。该体系由一个处于恒定温度 $T$ 下的正则系综描述。\n\n根据统计力学原理，系统在热平衡时处于具有能量 $E_i$ 的特定微观态 $i$ 的概率 $p_i$ 由玻尔兹曼分布给出。对于一个离散的状态集合（在此情况下为受体构象），系统处于构象态 $i$ 的概率为：\n$$\np_i = \\frac{\\exp\\left(-\\frac{E_i}{RT}\\right)}{Q}\n$$\n其中 $E_i$ 是第 $i$ 个构象的能量，$R$ 是摩尔气体常数，$T$ 是绝对温度。$Q$ 项是正则配分函数，它作为归一化常数，定义为所有可能状态的玻尔兹曼因子之和：\n$$\nQ = \\sum_{j} \\exp\\left(-\\frac{E_j}{RT}\\right)\n$$\n系综平均结合能 $E_{\\text{ens}}$ 是能量的期望值，通过将每个状态的能量 $E_i$ 按其相应概率 $p_i$ 加权求和计算得出：\n$$\nE_{\\text{ens}} = \\langle E \\rangle = \\sum_{i} p_i E_i\n$$\n将 $p_i$ 和 $Q$ 的表达式代入此方程，可得到系综平均能量的通用公式：\n$$\nE_{\\text{ens}} = \\sum_{i} \\left( \\frac{\\exp\\left(-\\frac{E_i}{RT}\\right)}{Q} \\right) E_i = \\frac{\\sum_{i} E_i \\exp\\left(-\\frac{E_i}{RT}\\right)}{\\sum_{i} \\exp\\left(-\\frac{E_i}{RT}\\right)}\n$$\n这就是所要求的表达式。现在，我们将使用所提供的数据来计算它的值。\n\n给定的参数为：\n- 受体构象结合能：$E_1 = -7.0~\\text{kcal/mol}$、$E_2 = -8.5~\\text{kcal/mol}$ 和 $E_3 = -6.5~\\text{kcal/mol}$。\n- 温度：$T = 300~\\text{K}$。\n- 摩尔气体常数：$R = 1.987204258 \\times 10^{-3}~\\text{kcal mol}^{-1}~\\text{K}^{-1}$。\n\n首先，我们计算热能项 $RT$：\n$$\nRT = (1.987204258 \\times 10^{-3}~\\text{kcal mol}^{-1}~\\text{K}^{-1}) \\times (300~\\text{K}) = 0.5961612774~\\text{kcal/mol}\n$$\n接下来，我们计算每个构象的未归一化统计权重，即玻尔兹曼因子 $w_i = \\exp(-E_i / RT)$：\n$$\nw_1 = \\exp\\left(-\\frac{-7.0}{0.5961612774}\\right) = \\exp(11.74170) \\approx 125695.55 \\\\\nw_2 = \\exp\\left(-\\frac{-8.5}{0.5961612774}\\right) = \\exp(14.25793) \\approx 1556426.6 \\\\\nw_3 = \\exp\\left(-\\frac{-6.5}{0.5961612774}\\right) = \\exp(10.90314) \\approx 54336.56\n$$\n配分函数 $Q$ 是这些权重之和：\n$$\nQ = w_1 + w_2 + w_3 \\approx 125695.55 + 1556426.6 + 54336.56 \\approx 1736458.71\n$$\n现在，我们计算 $E_{\\text{ens}}$ 表达式的分子，即由其玻尔兹曼因子加权的能量之和：\n$$\n\\sum_{i} E_i w_i = (E_1 \\times w_1) + (E_2 \\times w_2) + (E_3 \\times w_3) \\\\\n\\approx (-7.0 \\times 125695.55) + (-8.5 \\times 1556426.6) + (-6.5 \\times 54336.56) \\\\\n\\approx -879868.85 - 13229626.1 - 353187.64 \\approx -14462682.6\n$$\n最后，我们计算 $E_{\\text{ens}}$：\n$$\nE_{\\text{ens}} = \\frac{\\sum_{i} E_i w_i}{Q} \\approx \\frac{-14462682.6}{1736458.71} \\approx -8.3287785~\\text{kcal/mol}\n$$\n题目要求答案四舍五入至四位有效数字。\n$$\nE_{\\text{ens}} \\approx -8.329~\\text{kcal/mol}\n$$\n问题的最后一部分要求将 $E_{\\text{ens}}$ 与集合中的最低能量进行比较。最低能量是 $E_{\\min} = E_2 = -8.5~\\text{kcal/mol}$。我们观察到 $E_{\\text{ens}} = -8.329~\\text{kcal/mol} > E_2 = -8.5~\\text{kcal/mol}$。系综平均能量的负值比最稳定构象的最低能量要小（即能量更高，表示有效结合更弱）。\n\n这个结果在物理上是符合预期的，并突显了系综平均的优势。一个简化的模型可能只考虑单个最有利的构象（$E_2$），从而得出 $-8.5~\\text{kcal/mol}$ 的估算结合能。然而，在有限的温度下，系统是动态的，可以访问其他不太稳定的构象（$E_1$ 和 $E_3$），尽管概率较低。系综平均值 $E_{\\text{ens}}$ 正确地考虑了这些较高能量状态的热占据率。这些状态的存在提供了一个熵的贡献，有效地将整个系统的能量从可能的最低值提高。因此，与任何单个构象的能量相比，$E_{\\text{ens}}$ 提供了一个在热力学上更真实、通常也更准确的有效结合亲和力估算。通过以这种方式考虑受体的柔性，可以避免高估配体的结合强度。",
            "answer": "$$\n\\boxed{-8.329}\n$$"
        }
    ]
}