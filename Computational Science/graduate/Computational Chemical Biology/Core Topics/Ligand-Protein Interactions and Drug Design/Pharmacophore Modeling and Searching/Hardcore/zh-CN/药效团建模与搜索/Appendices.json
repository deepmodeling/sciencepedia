{
    "hands_on_practices": [
        {
            "introduction": "要确定候选分子与药效团模型的匹配程度，我们需要一个定量的评分函数。本练习介绍了一种基于统计学原理的常用方法，其中匹配质量与观察到几何构型偏离理想模型的概率相关。通过从第一性原理计算匹配分数，您将更深入地理解虚拟筛选工具如何对潜在配体进行排序。",
            "id": "3857956",
            "problem": "药效团（pharmacophore）是产生生物活性所必需的分子特征的抽象表示，通常编码为对特征对（距离）和特征三元组（角度）的几何约束。在计算化学生物学中，一种标准方法是将与药效团理想几何构型的偏差视为独立的、服从正态分布的测量或建模误差。具体来说，假设每个约束的偏差被建模为一个随机变量，该随机变量服从均值为零、标准差已知的高斯分布，并且假设不同约束之间的偏差是相互独立的。\n\n考虑一个具有三个特征间成对距离约束和一个角度约束的药效团：一个氢键供体（$D$）、一个氢键受体（$A$）和一个芳香环中心（$\\mathrm{Ar}$）。设计约束（理想几何构型）如下：\n- 理想供体-受体距离：$d_{DA}^{\\ast} = 2.80\\,\\mathrm{\\AA}$，标准差 $\\sigma_{DA} = 0.20\\,\\mathrm{\\AA}$。\n- 理想供体-芳香环中心距离：$d_{D\\mathrm{Ar}}^{\\ast} = 5.00\\,\\mathrm{\\AA}$，标准差 $\\sigma_{D\\mathrm{Ar}} = 0.30\\,\\mathrm{\\AA}$。\n- 理想受体-芳香环中心距离：$d_{A\\mathrm{Ar}}^{\\ast} = 6.20\\,\\mathrm{\\AA}$，标准差 $\\sigma_{A\\mathrm{Ar}} = 0.25\\,\\mathrm{\\AA}$。\n- 受体处的理想角度（由有序三元组 $D$–$A$–$\\mathrm{Ar}$ 形成）：$\\theta^{\\ast} = 120\\,\\mathrm{degrees}$，标准差 $\\sigma_{\\theta} = 10\\,\\mathrm{degrees}$。角度以度为单位。\n\n一个候选配体将其特征映射到药效团上，得到如下测量几何构型：\n- 测量的供体-受体距离：$d_{DA} = 2.95\\,\\mathrm{\\AA}$。\n- 测量的供体-芳香环中心距离：$d_{D\\mathrm{Ar}} = 5.18\\,\\mathrm{\\AA}$。\n- 测量的受体-芳香环中心距离：$d_{A\\mathrm{Ar}} = 6.05\\,\\mathrm{\\AA}$。\n- 测量的受体处角度：$\\theta = 113\\,\\mathrm{degrees}$。\n\n在偏差的独立性假设和高斯建模下，将匹配分数 $S$ 定义为联合似然函数的负对数，这不包括一个与候选几何构型无关的加性常数。也就是说，$S$ 是所有约束项的标准化偏差平方和。具体而言，如果 $\\Delta_{i}$ 表示约束 $i$ 的偏差，$\\sigma_{i}$ 表示其标准差，那么 $S = \\sum_{i} \\left(\\Delta_{i}/\\sigma_{i}\\right)^{2}$。\n\n计算上述候选配体的匹配分数 $S$。将最终分数表示为一个无量纲实数，并四舍五入到 $4$ 位有效数字。此外，在您的解题过程中，请从第一性原理出发论证该评分函数的合理性，并用偏导数的形式讨论 $S$ 对标准差 $\\sigma_{i}$ 和偏差 $\\Delta_{i}$ 的敏感性，但不要将这些讨论包含在最终的数值答案中。",
            "solution": "问题陈述经评估有效。其科学基础在于统计力学和计算化学的原理，问题提法得当，目标明确，数据充分，且无歧义或矛盾。因此，我们可以进行完整解答。\n\n该问题要求计算一个候选配体的药效团匹配分数 $S$。该分数定义为与理想几何约束的偏差平方之和，并由各自的标准差进行归一化。我们还被要求从第一性原理出发论证该评分函数的合理性。\n\n首先，我们来论证评分函数 $S$ 形式的合理性。问题陈述指出，每个约束的偏差 $\\Delta_{i}$ 被建模为一个独立的随机变量，服从均值为零、标准差为 $\\sigma_{i}$ 的高斯（正态）分布。因此，单个偏差 $\\Delta_{i}$ 的概率密度函数（PDF）由下式给出：\n$$P(\\Delta_i | \\sigma_i) = \\frac{1}{\\sigma_i \\sqrt{2\\pi}} \\exp\\left(-\\frac{\\Delta_i^2}{2\\sigma_i^2}\\right)$$\n由于假设偏差是相互独立的，对于 $N$ 个约束，观测到一组特定偏差 $\\{\\Delta_1, \\Delta_2, \\ldots, \\Delta_N\\}$ 的联合概率是它们各自概率的乘积。这个联合概率就是似然函数 $L$：\n$$L(\\{\\Delta_i\\}) = \\prod_{i=1}^{N} P(\\Delta_i | \\sigma_i) = \\prod_{i=1}^{N} \\frac{1}{\\sigma_i \\sqrt{2\\pi}} \\exp\\left(-\\frac{\\Delta_i^2}{2\\sigma_i^2}\\right)$$\n在统计分析中，处理似然函数的对数（即对数似然 $\\ln(L)$）通常更为方便。最大化似然函数等价于最大化对数似然函数。\n$$\\ln(L) = \\ln\\left( \\prod_{i=1}^{N} \\frac{1}{\\sigma_i \\sqrt{2\\pi}} \\exp\\left(-\\frac{\\Delta_i^2}{2\\sigma_i^2}\\right) \\right) = \\sum_{i=1}^{N} \\ln\\left( \\frac{1}{\\sigma_i \\sqrt{2\\pi}} \\exp\\left(-\\frac{\\Delta_i^2}{2\\sigma_i^2}\\right) \\right)$$\n$$\\ln(L) = \\sum_{i=1}^{N} \\left( -\\ln(\\sigma_i \\sqrt{2\\pi}) - \\frac{\\Delta_i^2}{2\\sigma_i^2} \\right) = -\\frac{1}{2} \\sum_{i=1}^{N} \\frac{\\Delta_i^2}{\\sigma_i^2} - \\sum_{i=1}^{N} \\ln(\\sigma_i \\sqrt{2\\pi})$$\n好的匹配对应于高的似然值，反之，差的匹配对应于低的似然值。评分函数通常被设计成较低的分数表示更好的匹配。一个常见的选择是负对数似然函数 $-\\ln(L)$。最小化这个分数等价于最大化似然函数。\n$$-\\ln(L) = \\frac{1}{2} \\sum_{i=1}^{N} \\frac{\\Delta_i^2}{\\sigma_i^2} + \\sum_{i=1}^{N} \\ln(\\sigma_i \\sqrt{2\\pi})$$\n对于一个给定的药效团模型，由于 $\\sigma_i$ 值是固定的，项 $\\sum_{i=1}^{N} \\ln(\\sigma_i \\sqrt{2\\pi})$ 是一个常数。分数 $S$ 的定义是“在不考虑一个加性常数的情况下”，这使我们可以忽略这一项。问题将 $S$ 定义为 $S = \\sum_{i} (\\Delta_{i}/\\sigma_{i})^{2}$。这恰好是负对数似然函数可变部分的两倍。因此，最小化 $S$ 等价于最大化拟合的似然性，这证明了其可作为“拟合劣度”分数的合理性。每一项 $(\\Delta_{i}/\\sigma_{i})$ 是标准化偏差，或称z-score，$S$ 则是它们的平方和。\n\n现在，我们为给定的候选配体计算分数 $S$。我们首先计算四个约束中每一个的偏差 $\\Delta_i$。\n偏差定义为 $\\Delta_i = (\\text{测量值})_i - (\\text{理想值})_i$。\n\n1.  供体-受体距离 ($DA$):\n    - 理想值：$d_{DA}^{\\ast} = 2.80\\,\\mathrm{\\AA}$\n    - 测量值：$d_{DA} = 2.95\\,\\mathrm{\\AA}$\n    - 偏差：$\\Delta_{DA} = 2.95 - 2.80 = 0.15\\,\\mathrm{\\AA}$\n    - 标准差：$\\sigma_{DA} = 0.20\\,\\mathrm{\\AA}$\n\n2.  供体-芳香环中心距离 ($D\\mathrm{Ar}$):\n    - 理想值：$d_{D\\mathrm{Ar}}^{\\ast} = 5.00\\,\\mathrm{\\AA}$\n    - 测量值：$d_{D\\mathrm{Ar}} = 5.18\\,\\mathrm{\\AA}$\n    - 偏差：$\\Delta_{D\\mathrm{Ar}} = 5.18 - 5.00 = 0.18\\,\\mathrm{\\AA}$\n    - 标准差：$\\sigma_{D\\mathrm{Ar}} = 0.30\\,\\mathrm{\\AA}$\n\n3.  受体-芳香环中心距离 ($A\\mathrm{Ar}$):\n    - 理想值：$d_{A\\mathrm{Ar}}^{\\ast} = 6.20\\,\\mathrm{\\AA}$\n    - 测量值：$d_{A\\mathrm{Ar}} = 6.05\\,\\mathrm{\\AA}$\n    - 偏差：$\\Delta_{A\\mathrm{Ar}} = 6.05 - 6.20 = -0.15\\,\\mathrm{\\AA}$\n    - 标准差：$\\sigma_{A\\mathrm{Ar}} = 0.25\\,\\mathrm{\\AA}$\n\n4.  角度 ($D$–$A$–$\\mathrm{Ar}$):\n    - 理想值：$\\theta^{\\ast} = 120\\,\\mathrm{degrees}$\n    - 测量值：$\\theta = 113\\,\\mathrm{degrees}$\n    - 偏差：$\\Delta_{\\theta} = 113 - 120 = -7\\,\\mathrm{degrees}$\n    - 标准差：$\\sigma_{\\theta} = 10\\,\\mathrm{degrees}$\n\n总分 $S$ 是标准化偏差的平方和：\n$$S = \\left(\\frac{\\Delta_{DA}}{\\sigma_{DA}}\\right)^{2} + \\left(\\frac{\\Delta_{D\\mathrm{Ar}}}{\\sigma_{D\\mathrm{Ar}}}\\right)^{2} + \\left(\\frac{\\Delta_{A\\mathrm{Ar}}}{\\sigma_{A\\mathrm{Ar}}}\\right)^{2} + \\left(\\frac{\\Delta_{\\theta}}{\\sigma_{\\theta}}\\right)^{2}$$\n代入计算出的值：\n$$S = \\left(\\frac{0.15}{0.20}\\right)^{2} + \\left(\\frac{0.18}{0.30}\\right)^{2} + \\left(\\frac{-0.15}{0.25}\\right)^{2} + \\left(\\frac{-7}{10}\\right)^{2}$$\n$$S = (0.75)^{2} + (0.6)^{2} + (-0.6)^{2} + (-0.7)^{2}$$\n$$S = 0.5625 + 0.36 + 0.36 + 0.49$$\n$$S = 1.7725$$\n问题要求将答案四舍五入到 $4$ 位有效数字。将 $1.7725$ 四舍五入到 $4$ 位有效数字得到 $1.773$。\n\n最后，我们讨论分数 $S$ 对偏差 $\\Delta_i$ 和标准差 $\\sigma_i$ 的敏感性。分数由公式 $S = \\sum_{i} \\frac{\\Delta_{i}^{2}}{\\sigma_{i}^{2}}$ 给出。\n$S$ 关于特定偏差 $\\Delta_j$ 的敏感性由偏导数给出：\n$$\\frac{\\partial S}{\\partial \\Delta_j} = \\frac{\\partial}{\\partial \\Delta_j}\\left( \\frac{\\Delta_{j}^{2}}{\\sigma_{j}^{2}} \\right) = \\frac{2\\Delta_j}{\\sigma_j^2}$$\n这表明分数对偏差的敏感性与偏差本身的大小成正比。更大的不匹配导致成比例更大的梯度，意味着分数对大偏差的惩罚超过线性关系。敏感性也与方差 $\\sigma_j^2$ 成反比，这意味着对于具有小标准差（即紧约束）的约束，分数对任何给定的偏差都更为敏感。\n\n$S$ 关于标准差 $\\sigma_j$ 的敏感性是：\n$$\\frac{\\partial S}{\\partial \\sigma_j} = \\frac{\\partial}{\\partial \\sigma_j}\\left( \\frac{\\Delta_{j}^{2}}{\\sigma_{j}^{2}} \\right) = \\Delta_j^2 \\left(-2\\sigma_j^{-3}\\right) = -\\frac{2\\Delta_j^2}{\\sigma_j^3}$$\n该导数始终为非正值（因为 $\\Delta_j^2 \\ge 0$ 且 $\\sigma_j  0$）。这证实了一个直观的认识，即增加一个约束的标准差（使其更“松散”或更“宽容”）对于给定的偏差只会减少或保持惩罚分数不变。敏感性与 $\\sigma_j^{-3}$ 成比例，这表明当 $\\sigma_j$ 很小时，分数对 $\\sigma_j$ 值的变化极其敏感。这凸显了在药效团模型中精确参数化标准差的至关重要性。",
            "answer": "$$\\boxed{1.773}$$"
        },
        {
            "introduction": "筛选数百万种化合物需要计算高效的策略，而不是对每个分子进行完整的三维比对，我们可以使用快速的“预过滤器”来淘汰不匹配的候选物。本练习将演示如何从药效团的内蕴几何结构中构建一个旋转不变的描述符，这项技术对于加速大规模虚拟筛选至关重要。",
            "id": "3858049",
            "problem": "在药效团建模中，一个药效团三角形由三维空间中的三个不同特征点构成，这些点被视为 $p_{1}, p_{2}, p_{3} \\in \\mathbb{R}^{3}$。特征 $i$ 和 $j$ 之间的欧几里得距离为 $d_{ij} = \\|p_{i} - p_{j}\\|$，其中 $\\|\\cdot\\|$ 表示欧几里得范数。空间刚体运动（旋转和平移）作用于点的方式为 $x \\mapsto R x + t$，其中 $R \\in \\mathrm{SO}(3)$（三维特殊正交群），$t \\in \\mathbb{R}^{3}$。药效团搜索常常寻求旋转不变的预过滤器，以避免不必要的完全对齐。\n\n从欧几里得范数在正交变换下的不变性以及差值的平移不变性出发，使用药效团三角形的边长 $d_{12}$、$d_{23}$、$d_{13}$ 推导出其旋转不变的表征，并解释如何通过将多重集 $\\{d_{12}, d_{23}, d_{13}\\}$ 映射到一个规范表示来确保在特征标签置换下的不变性。为使后续计算明确，请使用通过将三条边长按非递减大小排序定义的规范表示。\n\n提出一种无量纲的预过滤度量，仅通过这些规范边长向量来比较两个药效团三角形，该度量适用于在进行完全三维对齐之前排除非全等的候选对象。对于后续计算，将此度量定义为候选对象的规范边长向量与模型的规范边長向量之间逐分量相对偏差的上确界。\n\n给定一个模型三角形，其距离为 $d^{\\text{model}}_{12} = 3.45\\,\\text{\\AA}$、$d^{\\text{model}}_{23} = 5.78\\,\\text{\\AA}$ 和 $d^{\\text{model}}_{13} = 7.12\\,\\text{\\AA}$，以及一个候选三角形，其测量距离为 $d^{\\text{cand}}_{12} = 5.80\\,\\text{\\AA}$、$d^{\\text{cand}}_{23} = 7.10\\,\\text{\\AA}$ 和 $d^{\\text{cand}}_{13} = 3.44\\,\\text{\\AA}$，计算所选预过滤度量的值。将您的答案四舍五入至四位有效数字，并以无量纲数的形式表示结果。",
            "solution": "首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 药效团三角形由三个不同的点 $p_{1}, p_{2}, p_{3} \\in \\mathbb{R}^{3}$ 构成。\n- 特征 $i$ 和 $j$ 之间的欧几里得距离为 $d_{ij} = \\|p_{i} - p_{j}\\|$。\n- 刚体运动定义为 $x \\mapsto R x + t$，其中 $R \\in \\mathrm{SO}(3)$ 且 $t \\in \\mathbb{R}^{3}$。\n- 需要使用边长 $d_{12}$、$d_{23}$、$d_{13}$ 推导出一个旋转不变的表征。\n- 通过将多重集 $\\{d_{12}, d_{23}, d_{13}\\}$ 映射到规范表示来实现特征标签置換下的不变性。\n- 指定的规范表示是按非递减大小排列的三条边长。\n- 需要提出一个无量纲预过滤度量，并且为了计算，它被定义为候选对象的规范边长向量与模型的规范边長向量之间逐分量相对偏差的上确界。\n- 模型三角形的距离：$d^{\\text{model}}_{12} = 3.45\\,\\text{\\AA}$，$d^{\\text{model}}_{23} = 5.78\\,\\text{\\AA}$，$d^{\\text{model}}_{13} = 7.12\\,\\text{\\AA}$。\n- 候选三角形的距离：$d^{\\text{cand}}_{12} = 5.80\\,\\text{\\AA}$，$d^{\\text{cand}}_{23} = 7.10\\,\\text{\\AA}$，$d^{\\text{cand}}_{13} = 3.44\\,\\text{\\AA}$。\n- 最终计算必须四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题在欧几里得几何、群论（$SO(3)$）及其在计算化学生物学（特别是药效团建模）中的应用方面有坚实的科学基础。所有概念都是标准的，并且在事实上是合理的。\n- **良态问题：** 问题陈述清晰，提供了所有必要的定义、数据和约束，以得到唯一的数值解。目标定义明确。给定距离必须满足三角不等式才能表示欧几里得空间中的一个有效三角形。\n  - 对于模型：$3.45 + 5.78 = 9.23  7.12$。此不等式及所有其他置換都成立。\n  - 对于候选对象：$3.44 + 5.80 = 9.24  7.10$。此不等式及所有其他置換都成立。\n  两组距离都构成有效的三角形。\n- **客观性：** 语言形式化且精确，没有主观或模糊的陈述。\n- 该问题是自洽的、一致的且科学上可信的。它不违反任何无效标准。\n\n### 步骤 3：结论与行动\n问题被判定为 **有效**。将提供解答。\n\n### 解答推导\n\n解答过程分为三部分：证明不变性、定义规范表示和度量、以及执行计算。\n\n**1. 刚体运动下边长的不变性**\n$\\mathbb{R}^3$中的一次刚体运动将点 $p$ 变换为 $p' = R p + t$，其中 $R \\in \\mathrm{SO}(3)$ 是一个旋转矩阵，$t \\in \\mathbb{R}^3$ 是一个平移向量。考虑药效团三角形的两个点 $p_i$ 和 $p_j$。它们变换后的对应点是 $p'_i = R p_i + t$ 和 $p'_j = R p_j + t$。\n\n连接变换后各点的向量是：\n$$ p'_i - p'_j = (R p_i + t) - (R p_j + t) = R p_i - R p_j = R(p_i - p_j) $$\n变换后各点之间的距离 $d'_{ij}$ 是这个向量的欧几里得范数：\n$$ d'_{ij} = \\|p'_i - p'_j\\| = \\|R(p_i - p_j)\\| $$\n由于 $R$ 是一个正交矩阵（$R \\in \\mathrm{SO}(3) \\subset \\mathrm{O}(3)$），它保持欧几里得范数不变。也就是说，对于任何向量 $v \\in \\mathbb{R}^3$，都有 $\\|Rv\\| = \\|v\\|$。因此：\n$$ d'_{ij} = \\|p_i - p_j\\| = d_{ij} $$\n这表明距离 $d_{12}$、$d_{23}$ 和 $d_{13}$ 在旋转和平移下是不变的。因此，边长集合 $\\{d_{12}, d_{23}, d_{13}\\}$ 提供了一种与三角形在空间中的位置和方向无关的表征。两个三角形全等当且仅当它们的对应边长相等。\n\n**2. 规范表示和预过滤度量**\n三角形的同一性与其顶点 $p_1, p_2, p_3$ 的任意标记无关。标签的置換会置換距离多重集中的元素。例如，交换标签 1 和 2 会将距离 $(d_{12}, d_{23}, d_{13})$ 变为 $(d_{21}, d_{13}, d_{23})$，这等价于 $(d_{12}, d_{13}, d_{23})$。为确保一个独立于此标记的唯一表示，我们定义一种规范形式。按照规定，这是通过按非递减顺序排列边长来实现的。\n\n设边长的多重集为 $S = \\{d_{12}, d_{23}, d_{13}\\}$。规范表示是一个有序向量 $D = (s_1, s_2, s_3)$，其中 $s_1, s_2, s_3$ 是 $S$ 中的元素，经过排序以使 $s_1 \\le s_2 \\le s_3$。这个向量 $D$ 对刚体运动和顶点置換都是不变的。\n\n为了比较候选三角形（cand）和模型三角形（model），我们比较它们的规范边长向量 $D^{\\text{cand}}$ 和 $D^{\\text{model}}$。问题规定用于此比较的度量是逐分量相对偏差的上确界。设 $D^{\\text{model}} = (s^{\\text{model}}_1, s^{\\text{model}}_2, s^{\\text{model}}_3)$ 和 $D^{\\text{cand}} = (s^{\\text{cand}}_1, s^{\\text{cand}}_2, s^{\\text{cand}}_3)$。度量 $M$ 定义为：\n$$ M = \\sup_{k \\in \\{1,2,3\\}} \\left\\{ \\frac{|s^{\\text{cand}}_k - s^{\\text{model}}_k|}{s^{\\text{model}}_k} \\right\\} $$\n由于集合是有限的，上确界等价于最大值：\n$$ M = \\max\\left( \\frac{|s^{\\text{cand}}_1 - s^{\\text{model}}_1|}{s^{\\text{model}}_1}, \\frac{|s^{\\text{cand}}_2 - s^{\\text{model}}_2|}{s^{\\text{model}}_2}, \\frac{|s^{\\text{cand}}_3 - s^{\\text{model}}_3|}{s^{\\text{model}}_3} \\right) $$\n该度量是无量纲的，并提供了一种差异性度量，其中 $M=0$ 表示全等。\n\n**3. 计算**\n首先，我们确定模型三角形和候选三角形的规范边长向量。\n\n对于模型三角形，距离为 $\\{3.45, 5.78, 7.12\\}\\,\\text{\\AA}$。对其进行排序得到：\n$$ s^{\\text{model}}_1 = 3.45, \\quad s^{\\text{model}}_2 = 5.78, \\quad s^{\\text{model}}_3 = 7.12 $$\n所以，规范向量是 $D^{\\text{model}} = (3.45, 5.78, 7.12)$。\n\n对于候选三角形，距离为 $\\{5.80, 7.10, 3.44\\}\\,\\text{\\AA}$。对其进行排序得到：\n$$ s^{\\text{cand}}_1 = 3.44, \\quad s^{\\text{cand}}_2 = 5.80, \\quad s^{\\text{cand}}_3 = 7.10 $$\n所以，规范向量是 $D^{\\text{cand}} = (3.44, 5.80, 7.10)$。\n\n接下来，我们计算逐分量的相对偏差。\n设 $\\delta_k = \\frac{|s^{\\text{cand}}_k - s^{\\text{model}}_k|}{s^{\\text{model}}_k}$。\n\n对于 $k=1$：\n$$ \\delta_1 = \\frac{|3.44 - 3.45|}{3.45} = \\frac{0.01}{3.45} \\approx 0.00289855... $$\n\n对于 $k=2$：\n$$ \\delta_2 = \\frac{|5.80 - 5.78|}{5.78} = \\frac{0.02}{5.78} \\approx 0.00346020... $$\n\n对于 $k=3$：\n$$ \\delta_3 = \\frac{|7.10 - 7.12|}{7.12} = \\frac{0.02}{7.12} \\approx 0.00280898... $$\n\n度量 $M$ 是这三个值的最大值：\n$$ M = \\max(\\delta_1, \\delta_2, \\delta_3) = \\max(0.00289855..., 0.00346020..., 0.00280898...) $$\n$$ M = 0.00346020... $$\n\n最后，我们将结果四舍五入到四位有效数字。\n$$ M \\approx 0.003460 $$\n末尾的零是有效数字，必须包括在内。",
            "answer": "$$\\boxed{0.003460}$$"
        },
        {
            "introduction": "虚拟筛选完成后，我们如何衡量其成功与否？富集因子（Enrichment Factor, EF）是评估药效团模型是否成功地将活性化合物优先于非活性化合物的标准指标。推导 EF 的公式将巩固您对如何批判性地评估和报告虚拟筛选流程性能的理解。",
            "id": "3858033",
            "problem": "计算化学生物学中的一个虚拟筛选工作流程会生成一个候选分子的排序列表，这些分子根据其与靶标的药效团匹配度进行评分。设 $N$ 表示筛选分子的总数，$A$ 表示在这 $N$ 个分子中经实验验证的活性分子的总数。库中活性分子的基线流行率定义为活性分子的比例，根据第一性原理计算为活性分子与总数的比率，而顶部选集定义为排序列表中得分最高、且对应于列表大小特定比例的子集。考虑排序列表顶部 $x$ 百分比的部分，并定义 $f = \\frac{x}{100}$，其中 $0  f \\leq 1$。设 $N_f$ 表示列表顶部比例 $f$ 部分中的分子数量，取为大于或等于 $fN$ 的最小整数，并设 $H_f$ 表示这个顶部 $N_f$ 子集内经实验验证的活性分子数量。顶部 $x$ 百分比的富集因子（Enrichment Factor, EF），记作 $EF_{x\\text{ percent}}$，在概念上定义为顶部比例中观察到的命中率与整个库中基线流行率的比值。仅从基线流行率作为计数比率和截断排序列表内命中率作为计数比率的定义出发，推导出一个用 $N$、$A$、$H_f$ 和 $f$ 表示的 $EF_{x\\text{ percent}}$ 的解析表达式。以单一闭合形式表达式提供最终答案。无需四舍五入，也不应包含单位。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- `$N$`: 筛选分子的总数。\n- `$A$`: 在这 `$N$` 个分子中经实验验证的活性分子的总数。\n- `活性分子的基线流行率`: 活性分子的比例，根据第一性原理计算为活性分子与总数的比率。\n- `顶部选集`: 排序列表中得分最高、且对应于列表大小特定比例的子集。\n- `$x$`: 一个百分比，用于定义排序列表的顶部比例。\n- `$f = \\frac{x}{100}$`: 对应于顶部 `$x$` 百分比的比例，其中 `$0  f \\leq 1$`。\n- `$N_f$`: 列表顶部比例 `$f$` 部分中的分子数量，定义为大于或等于 `$fN$` 的最小整数。\n- `$H_f$`: 顶部 `$N_f$` 子集内经实验验证的活性分子数量。\n- `顶部 $x$ 百分比的富集因子（Enrichment Factor, EF），记作 $EF_{x\\text{ percent}}$`: 在概念上定义为顶部比例中观察到的命中率与整个库中基线流行率的比值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了计算化学生物学领域的一个标准指标（富集因子）。术语和设置与虚拟筛选中的既定实践相符。该问题提法得当，为所有量提供了清晰且数学上精确的定义。具体来说，`$N_f$` 定义为“大于或等于 `$fN$` 的最小整数”，这是对向上取整函数 `$N_f = \\lceil fN \\rceil$` 的明确定义。该问题是客观的，使用了不含主观语言的正式定义。问题没有内部矛盾、信息缺失或伪科学主张。任务是从一组明确陈述的定义中进行直接的数学推导。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。现在将根据所给定义进行严格推导。\n\n目标是推导富集因子（记作 `$EF_{x\\text{ percent}}$` 或简称 `$EF$`）的解析表达式，用 `$N$`、`$A$`、`$H_f$` 和 `$f$` 表示。推导将直接从所提供的概念性定义开始。\n\n富集因子定义为排序列表顶部比例中观察到的命中率与整个库中活性分子基线流行率的比值。\n$$\nEF = \\frac{\\text{顶部比例中的命中率}}{\\text{基线流行率}}\n$$\n\n首先，我们将分子形式化：“顶部比例中的命中率”。这是所选顶部子集中活性分子的密度。它计算为此子集中找到的活性分子数 `$H_f$` 除以该子集中的分子总数 `$N_f$`。\n$$\n\\text{顶部比例中的命中率} = \\frac{H_f}{N_f}\n$$\n\n接下来，我们将分母形式化：“基线流行率”。这代表了从整个库中随机选择分子所期望的命中率。它计算为库中活性分子总数 `$A$` 除以筛选的分子总数 `$N$`。\n$$\n\\text{基线流行率} = \\frac{A}{N}\n$$\n\n现在，我们将这两个表达式代入富集因子的定义中：\n$$\nEF = \\frac{\\frac{H_f}{N_f}}{\\frac{A}{N}}\n$$\n\n这个复合分数可以通过将分子乘以分母的倒数来简化：\n$$\nEF = \\frac{H_f}{N_f} \\times \\frac{N}{A} = \\frac{H_f N}{N_f A}\n$$\n\n问题要求最终表达式用 `$N$`、`$A$`、`$H_f$` 和 `$f$` 表示。我们当前的表达式包含 `$N_f$`。问题为 `$N_f$` 提供了关于 `$f$` 和 `$N$` 的精确定义：`$N_f$` 是“大于或等于 `$fN$` 的最小整数”。这是数学中的向上取整函数 `$\\lceil \\cdot \\rceil$` 的定义。\n$$\nN_f = \\lceil fN \\rceil\n$$\n\n我们必须将这个定义代入我们的 `$EF$` 表达式中，以满足问题的约束条件。\n$$\nEF = \\frac{H_f N}{A \\lceil fN \\rceil}\n$$\n\n这个表达式是仅从问题陈述中提供的定义推导出的富集因子的严格解析形式。它用所需的变量 `$N$`、`$A$`、`$H_f$` 和 `$f$` 表示。需要注意的是，虽然在实践中，对于非常大的 `$N$`，通常使用近似 `$\\lceil fN \\rceil \\approx fN$`，从而得到简化表达式 `$EF \\approx \\frac{H_f}{fA}$`，但这样的近似并没有得到问题陈述的支持，并且会违反从给定前提进行严格推导的原则。在所提供的定义下，推导出的包含向上取整函数的表达式是精确和正确的。",
            "answer": "$$\n\\boxed{\\frac{H_f N}{A \\lceil fN \\rceil}}\n$$"
        }
    ]
}