{
    "hands_on_practices": [
        {
            "introduction": "Hansch 分析是经典定量构效关系（QSAR）的基石，它假设生物活性可以用物理化学性质的组合来解释。本练习将指导您从基本原理出发构建一个 Hansch 模型，您将计算取代基的疏水性常数（$\\pi$）和电子效应常数（$\\sigma$），并使用它们通过多元线性回归来预测活性。这项实践将巩固您从描述符生成到模型构建和评估的整个 QSAR 核心工作流程的理解。",
            "id": "3860378",
            "problem": "在定量构效关系 (QSAR) 的一个场景中，假设取代基的疏水性和电子效应共同影响在对数尺度上测量的生物活性。其基本依据是：辛醇-水分配系数 $P$ 及其对数 $\\log_{10} P$（疏水性）的定义，以及将取代基电子效应与反应或平衡常数相关联的 Hammett 方程。对于取代基 $i$，其疏水性常数 $\\pi_i$ 定义为在同一芳香骨架上，相对于母体（氢）取代基的 $\\log_{10} P$ 变化量；电子常数 $\\sigma_i$ 则通过 Hammett 关系式定义，其中涉及反应常数 $\\rho$ 和通过 $pK_a$ 表示的酸解离常数 $K_a$。\n\n从这些基础出发：\n- 辛醇-水分配系数 $P_i$ 是辛醇相和水相中平衡浓度的比值，疏水性由 $x_i = \\log_{10} P_i$（无量纲）量化。\n- 取代基疏水性常数为 $ \\pi_i = x_i - x_H $，其中 $x_H = \\log_{10} P_H$ 是母体疏水性（无量纲）。\n- Hammett 关系式为 $ \\log_{10}(K_i / K_0) = \\rho \\sigma_i $，其中 $K_i = 10^{-pK_{a,i}}$ 且 $K_0 = 10^{-pK_{a,0}}$。这意味着 $ \\sigma_i = -\\dfrac{pK_{a,i} - pK_{a,0}}{\\rho} $（无量纲）。\n\n您必须：\n1. 对于每个测试用例，根据提供的 $\\log_{10} P_i$、$\\log_{10} P_H$、$pK_{a,i}$、$pK_{a,0}$ 和 $\\rho$，计算系列中每个取代基的 $ \\pi_i $ 和 $ \\sigma_i $。\n2. 对提供的活性值 $A_i$（无量纲，对数尺度）拟合一个多元线性回归模型，其形式为\n$$\nA_i = \\beta_0 + \\beta_{\\pi} \\pi_i + \\beta_{\\sigma} \\sigma_i + \\varepsilon_i,\n$$\n其中 $ \\beta_0 $、$ \\beta_{\\pi} $ 和 $ \\beta_{\\sigma} $ 是回归系数，$ \\varepsilon_i $ 是残差。使用普通最小二乘法估计 $ \\beta_0 $、$ \\beta_{\\pi} $ 和 $ \\beta_{\\sigma} $。计算决定系数\n$$\nR^2 = 1 - \\frac{\\sum_i (A_i - \\hat{A}_i)^2}{\\sum_i (A_i - \\bar{A})^2},\n$$\n其中 $ \\hat{A}_i $ 是拟合值，$ \\bar{A} $ 是 $A_i$ 的平均值。\n\n3. 对于每个测试用例，输出列表 $[\\beta_0, \\beta_{\\pi}, \\beta_{\\sigma}, R^2]$，每个值四舍五入到六位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例对应一个包含四个元素的方括号列表。例如，输出应如下所示：\n[[_case1_b0_,_case1_bpi_,_case1_bsigma_,_case1_R2_],[_case2_b0_,_case2_bpi_,_case2_bsigma_,_case2_R2_],[_case3_b0_,_case3_bpi_,_case3_bsigma_,_case3_R2_]]\n用数值替换且不含空格。\n\n使用以下测试套件。所有量均为无量纲。\n\n测试用例 1 (一般情况)：\n- 母体疏水性 $ x_H = \\log_{10} P_H = 2.13 $。\n- 母体酸度 $ pK_{a,0} = 4.20 $。\n- 反应常数 $ \\rho = 1.00 $。\n- 取代基数据数组：\n    - $ x_i = [2.73, 2.18, 2.84, 2.11, 0.90, 3.00, 1.46] $。\n    - $ pK_{a,i} = [4.34, 3.45, 3.98, 4.47, 4.80, 3.60, 4.54] $。\n    - $ A_i = [0.812, 1.44, 1.332, 0.16, -1.204, 1.916, -0.444] $。\n\n测试用例 2 (边界条件包括一个 $ \\pi_i = 0 $ 的情况)：\n- 母体疏水性 $ x_H = \\log_{10} P_H = 2.13 $。\n- 母体酸度 $ pK_{a,0} = 4.20 $。\n- 反应常数 $ \\rho = 0.90 $。\n- 取代基数据数组：\n    - $ x_i = [2.73, 2.13, 2.84, 2.11, 0.90, 2.95, 1.46] $。\n    - $ pK_{a,i} = [4.30, 3.50, 4.00, 4.50, 4.85, 3.70, 4.52] $。\n    - $ A_i = [0.8288888889, 1.1777777778, 1.2612222222, 0.0486666667, -1.4292222222, 1.6935555556, -0.5585555556] $。\n\n测试用例 3 (边缘情况，具有更强的电子权重和混合的疏水性极值)：\n- 母体疏水性 $ x_H = \\log_{10} P_H = 2.13 $。\n- 母体酸度 $ pK_{a,0} = 4.20 $。\n- 反应常数 $ \\rho = 1.20 $。\n- 取代基数据数组：\n    - $ x_i = [2.73, 2.13, 3.05, 0.90, 1.46, 2.70] $。\n    - $ pK_{a,i} = [4.36, 3.40, 3.60, 4.86, 4.60, 3.95] $。\n    - $ A_i = [0.84, 0.9, 1.762, -1.548, -0.737, 1.1145] $。\n\n最终输出格式要求：\n- 您的程序必须精确打印一行：一个包含三个方括号列表的单一列表，每个测试用例一个，每个列表包含 $[\\beta_0, \\beta_{\\pi}, \\beta_{\\sigma}, R^2]$，四舍五入到六位小数，用逗号分隔且不含空格。",
            "solution": "该问题是有效的，因为它科学地基于定量构效关系（QSAR）的原理，特别是 Hansch 分析。它定义明确、客观，并提供了计算唯一解所需的所有必要信息。\n\n该问题要求对三个不同的测试用例进行多元线性回归分析。对于每个用例，我们需要确定一个线性模型的系数及其决定系数 $R^2$。该模型将生物活性 $A_i$ 与分子取代基的两个物理化学性质相关联：疏水性常数 $\\pi_i$ 和电子常数 $\\sigma_i$。\n\n步骤如下：\n首先，对于给定测试系列中的每个取代基 $i$，我们必须根据所提供的数据计算自变量（描述符）$\\pi_i$ 和 $\\sigma_i$。\n\n取代基疏水性常数 $\\pi_i$ 定义为取代分子的辛醇-水分配系数的对数值 $x_i = \\log_{10} P_i$ 与母体化合物的相应值 $x_H = \\log_{10} P_H$ 之间的差值。其公式为：\n$$\n\\pi_i = x_i - x_H\n$$\n\n取代基电子常数 $\\sigma_i$ 源自 Hammett 方程，该方程关联了取代芳香族化合物的反应速率和平衡常数。所提供的定义是：\n$$\n\\sigma_i = -\\frac{pK_{a,i} - pK_{a,0}}{\\rho}\n$$\n其中 $pK_{a,i}$ 是取代化合物酸解离常数的负常用对数，$pK_{a,0}$ 是母体化合物的相应值，而 $\\rho$ 是表征反应对电子效应敏感性的反应常数。\n\n其次，在为每个取代基计算出描述符 $\\pi_i$ 和 $\\sigma_i$ 后，我们拟合指定的线性模型：\n$$\nA_i = \\beta_0 + \\beta_{\\pi} \\pi_i + \\beta_{\\sigma} \\sigma_i + \\varepsilon_i\n$$\n在此， $A_i$ 是测得的生物活性，$\\beta_0$ 是截距，$\\beta_{\\pi}$ 和 $\\beta_{\\sigma}$ 分别是疏水性和电子效应的回归系数，而 $\\varepsilon_i$ 是残差。\n\n为了求得这些系数，我们使用普通最小二乘法 (OLS)。该问题可以用矩阵形式表示为 $\\mathbf{y} = \\mathbf{X}\\mathbf{\\beta} + \\mathbf{\\varepsilon}$，其中：\n- $\\mathbf{y}$ 是观测活性值 $A_i$ 的一个 $n \\times 1$ 列向量。\n- $\\mathbf{X}$ 是 $n \\times 3$ 的设计矩阵，其中第 $i$ 行为 $[1, \\pi_i, \\sigma_i]$。第一列全为 1，对应于截距项 $\\beta_0$。\n- $\\mathbf{\\beta}$ 是待估计系数的 $3 \\times 1$ 列向量：$[\\beta_0, \\beta_{\\pi}, \\beta_{\\sigma}]^T$。\n- $\\mathbf{\\varepsilon}$ 是残差的 $n \\times 1$ 列向量。\n\n使残差平方和 $\\sum_i \\varepsilon_i^2$ 最小化的 $\\mathbf{\\beta}$ 的 OLS 估计值由正规方程给出：\n$$\n\\mathbf{\\hat{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}\n$$\n其中 $\\mathbf{\\hat{\\beta}}$ 是估计系数的向量。对每个测试用例，该方程组将被数值求解。\n\n第三，在估计系数后，我们使用决定系数 $R^2$ 来评估模型的拟合优度。首先，我们使用拟合模型计算每个取代基的预测活性值 $\\hat{A}_i$：\n$$\n\\hat{A}_i = \\hat{\\beta}_0 + \\hat{\\beta}_{\\pi} \\pi_i + \\hat{\\beta}_{\\sigma} \\sigma_i\n$$\n这可以写成矩阵形式 $\\mathbf{\\hat{y}} = \\mathbf{X}\\mathbf{\\hat{\\beta}}$。\n\n然后 $R^2$ 计算如下：\n$$\nR^2 = 1 - \\frac{\\text{SSR}}{\\text{SST}}\n$$\n其中：\n- 残差平方和 (SSR) 是观测活性与预测活性之间差异的平方和：$\\text{SSR} = \\sum_{i=1}^{n} (A_i - \\hat{A}_i)^2$。\n- 总平方和 (SST) 是观测活性与其平均值 $\\bar{A} = \\frac{1}{n}\\sum_{i=1}^{n} A_i$ 之间差异的平方和：$\\text{SST} = \\sum_{i=1}^{n} (A_i - \\bar{A})^2$。\n\n最后，对于每个测试用例，将所得结果 $[\\hat{\\beta}_0, \\hat{\\beta}_{\\pi}, \\hat{\\beta}_{\\sigma}, R^2]$ 四舍五入到六位小数，并按规定格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the QSAR problem for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            \"x_H\": 2.13,\n            \"pKa_0\": 4.20,\n            \"rho\": 1.00,\n            \"x_i\": np.array([2.73, 2.18, 2.84, 2.11, 0.90, 3.00, 1.46]),\n            \"pKa_i\": np.array([4.34, 3.45, 3.98, 4.47, 4.80, 3.60, 4.54]),\n            \"A_i\": np.array([0.812, 1.44, 1.332, 0.16, -1.204, 1.916, -0.444]),\n        },\n        # Test Case 2\n        {\n            \"x_H\": 2.13,\n            \"pKa_0\": 4.20,\n            \"rho\": 0.90,\n            \"x_i\": np.array([2.73, 2.13, 2.84, 2.11, 0.90, 2.95, 1.46]),\n            \"pKa_i\": np.array([4.30, 3.50, 4.00, 4.50, 4.85, 3.70, 4.52]),\n            \"A_i\": np.array([0.8288888889, 1.1777777778, 1.2612222222, 0.0486666667, -1.4292222222, 1.6935555556, -0.5585555556]),\n        },\n        # Test Case 3\n        {\n            \"x_H\": 2.13,\n            \"pKa_0\": 4.20,\n            \"rho\": 1.20,\n            \"x_i\": np.array([2.73, 2.13, 3.05, 0.90, 1.46, 2.70]),\n            \"pKa_i\": np.array([4.36, 3.40, 3.60, 4.86, 4.60, 3.95]),\n            \"A_i\": np.array([0.84, 0.9, 1.762, -1.548, -0.737, 1.1145]),\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract data for the current case\n        x_H = case[\"x_H\"]\n        pKa_0 = case[\"pKa_0\"]\n        rho = case[\"rho\"]\n        x_i = case[\"x_i\"]\n        pKa_i = case[\"pKa_i\"]\n        A_i = case[\"A_i\"]\n\n        # 1. Compute pi and sigma descriptors\n        pi_vals = x_i - x_H\n        sigma_vals = -(pKa_i - pKa_0) / rho\n\n        # 2. Fit a multiple linear regression model\n        # Construct the design matrix X\n        n_obs = len(A_i)\n        X = np.c_[np.ones(n_obs), pi_vals, sigma_vals]\n        \n        # Use ordinary least squares to estimate beta coefficients\n        # lstsq solves X * beta = A_i\n        beta, residuals, rank, s = np.linalg.lstsq(X, A_i, rcond=None)\n        beta_0, beta_pi, beta_sigma = beta[0], beta[1], beta[2]\n\n        # 3. Compute the coefficient of determination R^2\n        # Calculate predicted activities A_hat\n        A_hat = X @ beta\n        \n        # Calculate Total Sum of Squares (SST)\n        A_mean = np.mean(A_i)\n        sst = np.sum((A_i - A_mean)**2)\n        \n        # The 'residuals' output from lstsq is the Residual Sum of Squares (SSR)\n        # It's a 1-element array, so we access it with [0]\n        # This is valid only if sst > 0, which is true for non-constant A_i\n        ssr = residuals[0]\n        \n        # Handle the case where sst is zero (all A_i values are the same)\n        if sst == 0:\n            # If ssr is also zero, the fit is perfect. If ssr>0, the fit is meaningless.\n            # Conventionally, R^2 is set to 1.0 if SSR is also 0, otherwise undefined or 0.\n            R2 = 1.0 if ssr  1e-9 else 0.0\n        else:\n            R2 = 1 - (ssr / sst)\n\n        # Format results for the current case\n        case_result_str = f\"[{beta_0:.6f},{beta_pi:.6f},{beta_sigma:.6f},{R2:.6f}]\"\n        all_results.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在现代药物发现中，分子描述符对于构建预测模型至关重要，而拓扑极性表面积（Topological Polar Surface Area, TPSA）是预测诸如细胞渗透性等性质的关键描述符之一。本练习涉及基于片段加和性原理计算 TPSA，即总值是预定义原子贡献的总和。通过这个例子，您不仅将学会计算方法，还将批判性地评估这种广泛使用的二维描述符的内在假设和局限性，特别是当应用于构象复杂的分子时。",
            "id": "3860360",
            "problem": "在定量构效关系 (QSAR) 中，一个广泛使用的描述符是拓扑极性表面积 (TPSA)，它利用分子图（原子和键）和极性片段类型来近似溶剂可及表面积的极性部分。其概念基础是，许多加和性物理化学性质可以表示为在分子图上定义的局部贡献的总和，这与化学信息学中的线性自由能关系和片段加和性相一致。在 TPSA 中，极性表面积被近似为与杂原子环境相关的预定义片段贡献的总和。这种方法假设片段贡献具有严格的加和性，并忽略了三维构象、分子内氢键以及极性原子的动态遮蔽。\n\n考虑以下大环骨架，它包含下面列出的极性片段。给定每个片段的数量及其对 TPSA 的片段贡献，这些贡献是在分子图上定义的，不参考三维构象。该化合物构象受限，并已知会形成分子内氢键，但对于 TPSA 而言，这些因素不会改变片段的定义，因为 TPSA 纯粹是拓扑的。\n\n片段及其数量与贡献：\n- 酰胺或内酰胺中的羰基氧：数量 = 2，每个片段的贡献 $=17.07\\,\\mathrm{\\AA^2}$。\n- 仲酰胺氮（氢键供体）：数量 = 1，每个片段的贡献 $=12.03\\,\\mathrm{\\AA^2}$。\n- 芳香环氮（类吡啶，氢键受体）：数量 = 1，每个片段的贡献 $=25.78\\,\\mathrm{\\AA^2}$。\n- 咪唑中类吡咯啉氮（氢键供体）：数量 = 1，每个片段的贡献 $=12.03\\,\\mathrm{\\AA^2}$。\n- 叔羟基氧（氢键受体）：数量 = 1，每个片段的贡献 $=12.53\\,\\mathrm{\\AA^2}$。\n\n仅使用分子图上的加和性假设，根据给定的片段贡献计算该大环的 TPSA。讨论片段加和性背后的假设以及 TPSA 对构象受限分子的局限性，但不要在计算中引入任何经验性遮蔽或校正因子。将最终数值答案四舍五入到四位有效数字。最终 TPSA 以 $\\mathrm{\\AA^2}$ 为单位表示。",
            "solution": "问题陈述具有科学依据、提法恰当、客观，并包含了求解所需的所有信息。它正确地描述了拓扑极性表面积 (TPSA) 的概念，即一种用于定量构效关系 (QSAR) 的基于片段的加和性属性。所提供的数据完整且与任务一致。因此，该问题是有效的。\n\n中心任务是利用片段加和性原理计算大环骨架的 TPSA。问题明确指出，TPSA 被近似为预定义片段贡献的总和，这种方法基于一个假设，即分子性质可以被分解为其组成部分贡献的总和。这种方法纯粹是拓扑的，不考虑分子的三维构象。\n\n总 TPSA 是所有已识别极性片段贡献的总和。设 $C_i$ 为片段类型 $i$ 的贡献，设 $n_i$ 为该片段在分子中的数量。总 TPSA 由以下公式给出：\n$$\n\\text{TPSA} = \\sum_{i} n_i C_i\n$$\n\n问题提供了以下片段数量 ($n_i$) 及其各自的贡献 ($C_i$)：\n1.  酰胺或内酰胺中的羰基氧：$n_1 = 2$, $C_1 = 17.07\\,\\mathrm{\\AA^2}$\n2.  仲酰胺氮（氢键供体）：$n_2 = 1$, $C_2 = 12.03\\,\\mathrm{\\AA^2}$\n3.  芳香环氮（类吡啶）：$n_3 = 1$, $C_3 = 25.78\\,\\mathrm{\\AA^2}$\n4.  咪唑中类吡咯啉氮（氢键供体）：$n_4 = 1$, $C_4 = 12.03\\,\\mathrm{\\AA^2}$\n5.  叔羟基氧：$n_5 = 1$, $C_5 = 12.53\\,\\mathrm{\\AA^2}$\n\n现在我们可以通过将数量与其各自贡献的乘积相加来计算总 TPSA：\n$$\n\\text{TPSA} = (n_1 \\times C_1) + (n_2 \\times C_2) + (n_3 \\times C_3) + (n_4 \\times C_4) + (n_5 \\times C_5)\n$$\n代入给定值：\n$$\n\\text{TPSA} = (2 \\times 17.07\\,\\mathrm{\\AA^2}) + (1 \\times 12.03\\,\\mathrm{\\AA^2}) + (1 \\times 25.78\\,\\mathrm{\\AA^2}) + (1 \\times 12.03\\,\\mathrm{\\AA^2}) + (1 \\times 12.53\\,\\mathrm{\\AA^2})\n$$\n$$\n\\text{TPSA} = 34.14\\,\\mathrm{\\AA^2} + 12.03\\,\\mathrm{\\AA^2} + 25.78\\,\\mathrm{\\AA^2} + 12.03\\,\\mathrm{\\AA^2} + 12.53\\,\\mathrm{\\AA^2}\n$$\n$$\n\\text{TPSA} = 96.51\\,\\mathrm{\\AA^2}\n$$\n问题要求最终答案四舍五入到四位有效数字。计算值 $96.51$ 已经有四位有效数字，因此无需进一步四舍五入。\n\n根据要求，分析的一个关键部分是讨论此方法的假设和局限性，特别是针对指定的分子环境。\n\n**片段加和性背后的假设：**\n任何片段加和性方案（包括 TPSA）的基本假设是，一个整体分子性质可以表示为其片段的预先计算的、恒定的贡献的简单总和。这意味着任何单个片段的贡献都独立于其在更广泛分子结构中的环境。对于 TPSA 而言，这意味着例如一个羰基的极性表面积贡献被假定为是相同的，无论附近有什么其他官能团，分子采取何种构象，或者该基团是否受到空间位阻。这是一个强大的简化，可以实现快速计算，但忽略了分子内电子和空间相互作用的复杂性。\n\n**TPSA 对构象受限分子的局限性：**\n问题指定了一个构象受限的大环，已知它会形成分子内氢键 (IMHBs)。这种背景鲜明地揭示了拓扑 TPSA 方法的局限性。\n1.  **忽略三维构象和空间遮蔽：** TPSA 是根据分子图（二维连接性）计算的。它固有地假设所有极性片段都完全暴露于溶剂中。在像大环这样的真实、折叠的三维结构中，许多极性原子可能被埋藏在分子内部，使它们无法接触到溶剂。这些极性原子的实际、物理上相关的溶剂可及表面积 (SASA) 将会显著降低，甚至为零。TPSA 值 $96.51\\,\\mathrm{\\AA^2}$ 代表了一个理论上的最大值，对于极性基团被遮蔽的受限骨架来说，这个值在物理上是无法达到的。\n2.  **忽略分子内氢键 (IMHB)：** 问题指出该分子形成 IMHB。当一个氢键供体（如仲酰胺 N-H 或咪唑 N-H）与同一分子内的受体（如羰基氧）相互作用时，就会发生 IMHB。当这种情况发生时，所涉及的原子是“内部满足”的，不再能与外部水分子相互作用。根据其定义，TPSA 忽略了这一点。它将供体和受体的全部片段贡献都加了进去，就好像它们都完全可用于分子间相互作用一样。这导致对与溶剂化和膜渗透等性质相关的表面积的系统性高估。对于给定的分子，氢键供体（$n_2$、$n_4$）中的一个或多个很可能与一个受体（例如 $n_1$）成键，但计算中仍包含了它们的全部贡献。\n\n总之，虽然 TPSA 在药物发现中是一个有价值且快速的计算过滤器，但对于像所描述的那样构象刚性且内部存在氢键的分子，其值最好被解释为真实极性表面积的一个粗略上限。对于这类分子，其值与物理现实的偏差可能相当大。然而，计算本身必须严格遵循所执行的加和性、拓扑定义。",
            "answer": "$$\n\\boxed{96.51}\n$$"
        },
        {
            "introduction": "先导化合物优化的核心任务是理解结构-活性关系（SAR）的“地貌”，特别是识别那些微小结构变化导致活性急剧下降的“活性悬崖”。结构-活性地貌指数（Structure-Activity Landscape Index, SALI）通过将活性变化与结构距离相关联，为这一现象提供了定量度量。本练习要求您从分子相似性的基本定义出发推导出 SALI，并应用它来量化局部 SAR 的陡峭程度，这是导航和利用 SAR 地貌的一项关键技能。",
            "id": "3860335",
            "problem": "考虑定量构效关系（QSAR）的建模，其中分子由高维二元指纹表示，生物活性为实值响应。活性悬崖通俗地理解为一对结构上非常相似但在生物活性上表现出巨大差异的分子。为了量化局部构效关系的陡峭程度，请从第一性原理出发，构建一个指数来捕捉指纹空间中活性变化与结构距离的比率，并使用以下基础：将二元分子指纹视为“开”位（on-bits）的集合，两个集合之间的雅卡尔（Jaccard）或谷本（Tanimoto）相似性，以及在分子表示空间中导出的距离概念。\n\n使用以下基本基础，不要引入任何非由此推导出的快捷公式：\n- 二元指纹作为集合：每个分子被映射到一个特征（“开”位）集合。设分子 $i$ 有集合 $F_{i}$，分子 $j$ 有集合 $F_{j}$。\n- 两个集合 $F_{i}$ 和 $F_{j}$ 之间的谷本（Tanimoto）（或雅卡尔 Jaccard）相似性为 $S_{ij}$，定义为集合交集的大小与并集大小的比率。\n- 表示空间中的距离可以通过从1中减去相似性来导出。\n\n从这些基本要素出发，推导一个指数，该指数衡量两个分子之间活性景观的局部陡峭程度，作为活性相对于指纹距离的离散梯度，并写出最终的表达式。然后将你推导出的指数应用于以下分子对：\n- 分子 $i$ 的扩展连接性指纹（ECFP）有 $a = 128$ 个“开”位。\n- 分子 $j$ 的ECFP有 $b = 142$ 个“开”位。\n- “开”位交集的大小为 $c = 110$。\n- 活性是抑制浓度的负常用对数，$pIC_{50}$，它是无量纲的。测得的活性为 $A_{i} = 7.4$ 和 $A_{j} = 5.8$。\n\n计算该分子对的指数值。将你的答案四舍五入到四位有效数字。将最终答案表示为无量纲量。",
            "solution": "该问题要求从第一性原理出发构建一个指数，用以量化构效关系的局部陡峭程度，然后将其应用于一对特定的分子。该指数定义为生物活性变化与指纹空间中结构距离的比率。\n\n设两个分子分别用 $i$ 和 $j$ 表示。它们测得的生物活性分别为 $A_i$ 和 $A_j$。活性变化是这些值的绝对差，即 $|\\Delta A| = |A_i - A_j|$。\n\n分子由二元指纹表示，这些指纹是“开”位的集合，记作 $F_i$ 和 $F_j$。它们之间的结构关系首先通过谷本（Tanimoto）相似性 $S_{ij}$ 来量化。根据问题陈述，这被定义为集合 $F_i$ 和 $F_j$ 之间的雅卡尔（Jaccard）相似性：\n$$S_{ij} = \\frac{|F_i \\cap F_j|}{|F_i \\cup F_j|}$$\n其中 $|...|$ 表示集合的基数（大小）。\n\n两个集合的并集大小可以用容斥原理表示：\n$$|F_i \\cup F_j| = |F_i| + |F_j| - |F_i \\cap F_j|$$\n将此代入谷本（Tanimoto）相似性的表达式中，得到：\n$$S_{ij} = \\frac{|F_i \\cap F_j|}{|F_i| + |F_j| - |F_i \\cap F_j|}$$\n\n结构距离 $D_{ij}$ 是通过从1中减去相似性导出的：\n$$D_{ij} = 1 - S_{ij}$$\n代入 $S_{ij}$ 的表达式：\n$$D_{ij} = 1 - \\frac{|F_i \\cap F_j|}{|F_i| + |F_j| - |F_i \\cap F_j|}$$\n为简化起见，我们进行通分：\n$$D_{ij} = \\frac{(|F_i| + |F_j| - |F_i \\cap F_j|) - |F_i \\cap F_j|}{|F_i| + |F_j| - |F_i \\cap F_j|} = \\frac{|F_i| + |F_j| - 2|F_i \\cap F_j|}{|F_i| + |F_j| - |F_i \\cap F_j|}$$\n这个 $D_{ij}$ 的表达式也称为雅卡尔距离（Jaccard distance）。\n\n活性景观局部陡峭程度的指数，我们记为 $I_{ij}$，是定义为活性变化与结构距离之比的离散梯度：\n$$I_{ij} = \\frac{|A_i - A_j|}{D_{ij}}$$\n代入推导出的 $D_{ij}$ 表达式：\n$$I_{ij} = \\frac{|A_i - A_j|}{1 - S_{ij}} = \\frac{|A_i - A_j|}{1 - \\frac{|F_i \\cap F_j|}{|F_i| + |F_j| - |F_i \\cap F_j|}}$$\n这就是从给定的第一性原理推导出的所需指数。它是构效景观指数（SALI）的一种形式。\n\n现在，我们将此指数应用于所提供的数据：\n-   分子 $i$ 的“开”位大小：$|F_i| = a = 128$\n-   分子 $j$ 的“开”位大小：$|F_j| = b = 142$\n-   “开”位交集的大小：$|F_i \\cap F_j| = c = 110$\n-   分子 $i$ 的活性：$A_i = 7.4$\n-   分子 $j$ 的活性：$A_j = 5.8$\n\n首先，我们计算结构距离 $D_{ij}$。我们先计算谷本（Tanimoto）相似性 $S_{ij}$。指纹集合的并集大小为：\n$$|F_i \\cup F_j| = |F_i| + |F_j| - |F_i \\cap F_j| = a + b - c = 128 + 142 - 110 = 270 - 110 = 160$$\n谷本（Tanimoto）相似性为：\n$$S_{ij} = \\frac{|F_i \\cap F_j|}{|F_i \\cup F_j|} = \\frac{c}{160} = \\frac{110}{160} = \\frac{11}{16} = 0.6875$$\n因此，结构距离为：\n$$D_{ij} = 1 - S_{ij} = 1 - 0.6875 = 0.3125$$\n\n接下来，我们计算活性的绝对差：\n$$|A_i - A_j| = |7.4 - 5.8| = 1.6$$\n\n最后，我们计算指数 $I_{ij}$：\n$$I_{ij} = \\frac{|A_i - A_j|}{D_{ij}} = \\frac{1.6}{0.3125}$$\n进行除法运算：\n$$I_{ij} = \\frac{1.6}{0.3125} = \\frac{1.6}{1/3.2} = 1.6 \\times 3.2 = 5.12$$\n或者，使用分数：\n$$D_{ij} = 0.3125 = \\frac{3125}{10000} = \\frac{5}{16}$$\n$$I_{ij} = \\frac{1.6}{5/16} = \\frac{16 \\times 1.6}{5} = \\frac{25.6}{5} = 5.12$$\n\n问题要求答案四舍五入到四位有效数字。计算出的值 $5.12$ 有三位有效数字。为了用四位有效数字表示，我们将其写为 $5.120$。",
            "answer": "$$\\boxed{5.120}$$"
        }
    ]
}