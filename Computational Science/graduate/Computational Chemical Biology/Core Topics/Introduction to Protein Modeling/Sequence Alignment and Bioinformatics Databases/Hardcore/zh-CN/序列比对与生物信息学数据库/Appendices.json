{
    "hands_on_practices": [
        {
            "introduction": "局部序列比对是生物信息学中的一项基本技术，用于在两条序列中识别出最相似的片段。通过一个具体的计算实例，你将练习使用Smith-Waterman动态规划算法，这对于理解BLAST等常用数据库搜索工具的底层机制至关重要。这项练习不仅能让你掌握动态规划矩阵的填充方法，还能加深你对评分方案和零重置（zero-reset）机制的理解，后者是区分局部比对与全局比对的关键所在。",
            "id": "3863057",
            "problem": "在计算化学生物学中，局部序列比对是生物信息学数据库（如美国国家生物技术信息中心 (NCBI) 和通用蛋白质资源 (UniProt)）中搜索和检索任务的基础。局部比对根据基于生物学信息的评分方案，识别出两个生物聚合物之间得分最高的子序列。其动态规划实现使用零重置，以防止低分区域拉低原本有意义的局部匹配的得分。\n\n考虑两个以核苷酸编码的短脱氧核糖核酸 (DNA) 序列：\n$$\nX = (\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}),\n\\quad\nY = (\\mathrm{G}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{C}, \\mathrm{T}).\n$$\n使用一个基于核苷酸化学类别的生物学驱动的评分函数：腺嘌呤和鸟嘌呤是嘌呤，胞嘧啶和胸腺嘧啶是嘧啶。为任意 $\\alpha,\\beta \\in \\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}\\}$ 定义替换得分 $s(\\alpha,\\beta)$ 如下：\n- 相同核苷酸：$s(\\alpha,\\alpha) = +3$，\n- 转换（嘌呤 $\\leftrightarrow$ 嘌呤，$\\mathrm{A} \\leftrightarrow \\mathrm{G}$；嘧啶 $\\leftrightarrow$ 嘧啶，$\\mathrm{C} \\leftrightarrow \\mathrm{T}$）：对于 $\\alpha \\neq \\beta$，$s(\\alpha,\\beta) = -1$，\n- 颠换（嘌呤 $\\leftrightarrow$ 嘧啶，所有其他错配）：$s(\\alpha,\\beta) = -3$，\n并对插入或删除使用线性空位罚分 $d = -2$。\n\n应用动态规划和零重置的局部比对原理，计算出 $X$ 和 $Y$ 之间一个高分局部比对的具体示例，并解释在计算中零重置在何处以及为何发生，从而能够检测到否则会被低分侧翼区域所掩盖的高分子序列。在此评分方案下，将最大局部比对得分作为你的最终答案。无需四舍五入。将最终答案表示为一个不带单位的实数。",
            "solution": "该问题要求使用 Smith-Waterman 动态规划算法计算两个脱氧核糖核酸 (DNA) 序列 $X$ 和 $Y$ 之间的最大局部比对得分。该算法是生物信息学中寻找序列间相似区域的基础。\n\n首先，我们确定给定的参数。两个序列是：\n$$\nX = (\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}) \\quad \\text{长度为 } m=7\n$$\n$$\nY = (\\mathrm{G}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{C}, \\mathrm{T}) \\quad \\text{长度为 } n=7\n$$\n评分方案基于核苷酸的化学类别。腺嘌呤 (A) 和鸟嘌呤 (G) 是嘌呤。胞嘧啶 (C) 和胸腺嘧啶 (T) 是嘧啶。替换得分 $s(\\alpha, \\beta)$ 定义如下：\n- 对于相同核苷酸，$s(\\alpha, \\alpha) = +3$。\n- 对于转换（嘌呤 $\\leftrightarrow$ 嘌呤，嘧啶 $\\leftrightarrow$ 嘧啶），当 $\\alpha \\neq \\beta$ 时，$s(\\alpha, \\beta) = -1$。\n- 对于颠换（嘌呤 $\\leftrightarrow$ 嘧啶），$s(\\alpha, \\beta) = -3$。\n线性空位罚分为 $d = -2$。\n\n基于这些规则，我们可以构建替换得分矩阵，记为 $S$：\n$$\nS =\n\\bordermatrix{ & \\mathrm{A} & \\mathrm{C} & \\mathrm{G} & \\mathrm{T} \\cr\n\\mathrm{A} & +3 & -3 & -1 & -3 \\cr\n\\mathrm{C} & -3 & +3 & -3 & -1 \\cr\n\\mathrm{G} & -1 & -3 & +3 & -3 \\cr\n\\mathrm{T} & -3 & -1 & -3 & +3 \\cr\n}\n$$\n\nSmith-Waterman 算法使用一个动态规划矩阵，我们称之为 $H$，其大小为 $(n+1) \\times (m+1)$，在本例中为 $8 \\times 8$。元素 $H_{i,j}$ 存储了任何以序列 $Y$ 的位置 $i$ 和序列 $X$ 的位置 $j$ 结尾的比对的最大得分。矩阵初始化为：对于 $i \\in [0, n]$，$H_{i,0} = 0$；对于 $j \\in [0, m]$，$H_{0,j} = 0$。\n\n对于 $i > 0$ 和 $j > 0$，每个单元格 $H_{i,j}$ 使用以下递推关系计算，该关系包含关键的零重置：\n$$\nH_{i,j} = \\max\n\\begin{cases}\n    0  \\text{(开始新比对)} \\\\\n    H_{i-1, j-1} + s(Y_i, X_j)  \\text{(匹配/错配)} \\\\\n    H_{i-1, j} + d  \\text{(在X中删除，X中出现空位)} \\\\\n    H_{i, j-1} + d  \\text{(在X中插入，Y中出现空位)}\n\\end{cases}\n$$\n其中 $X_j$ 是 $X$ 的第 $j$ 个核苷酸，$Y_i$ 是 $Y$ 的第 $i$ 个核苷酸。\n\n我们现在填充矩阵 $H$。列对应序列 $X$，行对应序列 $Y$。\n\n$$\nH =\n\\bordermatrix{\n& \\emptyset & \\mathrm{A}_{1} & \\mathrm{C}_{2} & \\mathrm{G}_{3} & \\mathrm{T}_{4} & \\mathrm{A}_{5} & \\mathrm{G}_{6} & \\mathrm{T}_{7} \\cr\n\\emptyset & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\cr\n\\mathrm{G}_{1} & 0 & 0 & 0 & 3 & 1 & 0 & 3 & 1 \\cr\n\\mathrm{A}_{2} & 0 & 3 & 1 & 1 & 0 & 4 & 2 & 0 \\cr\n\\mathrm{G}_{3} & 0 & 1 & 0 & 4 & 2 & 2 & 7 & 5 \\cr\n\\mathrm{T}_{4} & 0 & 0 & 0 & 2 & 7 & 5 & 5 & 10 \\cr\n\\mathrm{A}_{5} & 0 & 3 & 1 & 0 & 5 & 10 & 8 & 8 \\cr\n\\mathrm{C}_{6} & 0 & 1 & 6 & 4 & 3 & 8 & 7 & 7 \\cr\n\\mathrm{T}_{7} & 0 & 0 & 4 & 3 & 7 & 6 & 5 & 10 \\cr\n}\n$$\n\n矩阵 $H$ 中的最大得分即为最大局部比对得分。检查矩阵，我们发现最大值为 $10$。该得分出现在三个位置：$H_{4,7}$、$H_{5,5}$ 和 $H_{7,7}$。这表明至少存在三种不同的局部比对可以达到这个最大得分。\n\n问题要求给出一个高分局部比对的具体示例。我们可以通过从其中一个最高分单元格（例如 $H_{5,5} = 10$）开始进行回溯来找到一个。\n1.  从 $H_{5,5} = 10$ 开始。该得分由 $H_{4,4} + s(Y_5, X_5) = H_{4,4} + s(\\mathrm{A}, \\mathrm{A}) = 7 + 3 = 10$ 得到。这对应于一个对角线移动，将 $Y_5=\\mathrm{A}$ 与 $X_5=\\mathrm{A}$ 对齐。我们移动到 $H_{4,4}$。\n2.  从 $H_{4,4} = 7$ 开始。该得分来自 $H_{3,3} + s(Y_4, X_4) = H_{3,3} + s(\\mathrm{T}, \\mathrm{T}) = 4 + 3 = 7$。这是一个对角线移动，将 $Y_4=\\mathrm{T}$ 与 $X_4=\\mathrm{T}$ 对齐。我们移动到 $H_{3,3}$。\n3.  从 $H_{3,3} = 4$ 开始。该得分来自 $H_{2,2} + s(Y_3, X_3) = H_{2,2} + s(\\mathrm{G}, \\mathrm{G}) = 1 + 3 = 4$。这是一个对角线移动，将 $Y_3=\\mathrm{G}$ 与 $X_3=\\mathrm{G}$ 对齐。我们移动到 $H_{2,2}$。\n4.  从 $H_{2,2} = 1$ 开始。该得分来自 $H_{2,1} + d = 3 - 2 = 1$。这是一个向左移动，对应于将 $X_2=\\mathrm{C}$ 与序列 $Y$ 中的一个空位对齐。我们移动到 $H_{2,1}$。\n5.  从 $H_{2,1} = 3$ 开始。该得分来自 $H_{1,0} + s(Y_2, X_1) = H_{1,0} + s(\\mathrm{A}, \\mathrm{A}) = 0 + 3 = 3$。这是一个对角线移动，将 $Y_2=\\mathrm{A}$ 与 $X_1=\\mathrm{A}$ 对齐。我们移动到 $H_{1,0}$。\n6.  回溯在 $H_{1,0} = 0$ 处终止。\n\n根据回溯（按逆序）重建比对：\n$$\n\\begin{array}{cccccc}\n\\text{X:} & \\mathrm{A} & \\mathrm{C} & \\mathrm{G} & \\mathrm{T} & \\mathrm{A} \\\\\n\\text{Y:} & \\mathrm{A} & - & \\mathrm{G} & \\mathrm{T} & \\mathrm{A}\n\\end{array}\n$$\n该比对的得分为 $s(\\mathrm{A},\\mathrm{A}) + d + s(\\mathrm{G},\\mathrm{G}) + s(\\mathrm{T},\\mathrm{T}) + s(\\mathrm{A},\\mathrm{A}) = 3 + (-2) + 3 + 3 + 3 = 10$，这证实了我们的计算。该比对涉及子序列 $X[1..5] = (\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A})$ 和 $Y[2..5] = (\\mathrm{A}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A})$。\n\n零重置是区分局部比对和全局比对的关键特征。当从先前比对延伸（对角线、上方或左方）得到的所有得分都为负时，就会发生零重置。在这种情况下，算法会“忘记”低分的延伸，并从该点开始一个新的潜在局部比对，得分为 $0$。\n\n在单元格 $H_{1,1}$ 处可以观察到一个零重置的例子。\n$$\nH_{1,1} = \\max \\begin{cases}\n    0 \\\\\n    H_{0,0} + s(Y_1, X_1) = 0 + s(\\mathrm{G}, \\mathrm{A}) = -1 \\\\\n    H_{0,1} + d = 0 - 2 = -2 \\\\\n    H_{1,0} + d = 0 - 2 = -2\n\\end{cases}\n= \\max\\{0, -1, -2, -2\\} = 0\n$$\n在这里，比对前缀 $X[1]=\\mathrm{A}$ 和 $Y[1]=\\mathrm{G}$ 得到负分（$s(\\mathrm{A},\\mathrm{G}) = -1$），以空位开始也是负分（$d=-2$）。因为所有延伸到该单元格的比对的可能性都会导致负的累积分数，所以算法将得分重置为 $0$。这种机制防止了低分的初始区域（如序列开始处的A/G错配）对后续可能出现的高分局部比对产生罚分并将其掩盖，而我们找到的那个从 $X_1$ 和 $Y_2$ 开始的比对正是这种情况。\n\n最大局部比对得分是在矩阵 $H$ 中找到的最高值。\n$$\nS_{\\text{max}} = \\max_{i,j} H_{i,j} = 10\n$$",
            "answer": "$$\n\\boxed{10}\n$$"
        },
        {
            "introduction": "在真核生物中，基因的表达涉及到一个关键过程：剪接，即内含子被切除，外显子被连接起来。因此，将成熟的信使RNA（以cDNA形式存在）与其基因组位点进行比对，需要一种能够跨越内含子的“剪接比对”算法。本练习将引导你为一个剪接比对场景构建一个符合生物学原理的评分方案，并用它来计算一个具体的比对得分，该方案需要合理地区分剪接事件和更罕见的框移突变。 通过这个过程，你将学会如何将生物学知识量化为算法参数，这是基因结构注释和功能基因组学研究的核心技能。",
            "id": "3863059",
            "problem": "一个源自成熟信使RNA的互补DNA (cDNA) 序列，与其包含一个内含子和两个外显子的基因组位点进行比对。该比对应该反映出cDNA缺少内含子，而基因组区域包含内含子，并且编码序列中的单核苷酸插入或缺失会导致移码，而移码比经典剪接要罕见得多。从分子生物学中心法则（DNA转录为RNA，并以长度为$3$的密码子进行翻译）和剪接比对的定义（cDNA与基因组DNA的外显子片段比对，内含子片段作为单个事件被跳过）出发，并利用这些原则来证明一个对内含子和移码进行区别对待的、生物学上合理的评分方案的正确性。然后，在指定的方案下计算最优剪接比对得分。\n\n基因组区域 $G$ (外显子–内含子–外显子，按 $5'$ 到 $3'$ 方向书写)：\n- 外显子 $1$：ATGGAA\n- 内含子：GTACCAAG\n- 外显子 $2$：CTTTAA\n\n因此 $G = \\text{ATGGAA}\\,\\text{GTACCAAG}\\,\\text{CTTTAA}$。\n\ncDNA序列 $C$ (外显子 $1$ 后面跟着外显子 $2$，且外显子 $2$ 中有一个单核苷酸插入)：\n- $C = \\text{ATGGAACCTTTAA}$\n\n对 $C$ 与 $G$ 的剪接比对采用以下评分规则：\n- 外显子区域的碱基-碱基比对：匹配 $+2$，错配 $-1$。\n- 外显子区域内的空位（相对于编码序列的插入缺失）：\n  - 如果空位长度 $L$ 满足 $L \\equiv 0 \\pmod{3}$（密码子保守），罚分为空位起始 $-5$ 加上每个空位核苷酸的空位延伸 $-2$。\n  - 如果 $L \\not\\equiv 0 \\pmod{3}$（移码），罚分为空位起始 $-9$ 加上每个空位核苷酸的空位延伸 $-2$。\n- 内含子跳过（将cDNA的一个空位跨过$G$中一个连续的内含子进行比对）：内含子起始 $-3$，每个内含子核苷酸的内含子延伸 $0$，并且当且仅当内含子是经典的“GT…AG”（以GT开始，以AG结束）时，有剪接位点奖励 $+3$；否则奖励为 $0$。\n\n根据密码子结构和剪接的普遍性，简要说明为什么内含子跳过的罚分应少于移码。然后，使用上述方案计算 $C$ 和 $G$ 之间的最优剪接比对得分。仅报告最优总比对得分，结果为一个精确整数（无单位）。",
            "solution": "该问题是有效的，因为它基于分子生物学和生物信息学的原理，具有科学依据，定义明确，目标清晰，规则完整，且没有矛盾或歧义。\n\n解决方案包括两部分：对评分方案的合理解释和最优比对得分的计算。\n\n**评分方案的合理解释**\n\n分子生物学中心法则指出，遗传信息从DNA流向RNA，再流向蛋白质。在真核生物中，这个过程涉及与本问题相关的几个关键步骤。\n$1$. **转录**：基因组DNA中的一个基因，由外显子（编码区）和内含子（非编码区）组成，被转录成一个前体信使RNA (pre-mRNA) 分子，该分子是整个基因的拷贝，包括内含子。\n$2$. **剪接**：pre-mRNA经历一个称为剪接的关键加工步骤，其中内含子被精确切除，外显子被连接在一起，形成一个成熟的信使RNA (mRNA)。这个过程是真核生物基因表达的一个基本且非常普遍的环节。最终的mRNA包含一个连续的编码序列。\n$3$. **翻译**：成熟的mRNA随后被翻译成蛋白质。核糖体以连续、不重叠的三个核苷酸为一组（称为密码子）读取mRNA序列。每个密码子指定一个特定的氨基酸。因此，密码子的序列决定了最终蛋白质中的氨基酸序列，而氨基酸序列又决定了蛋白质的结构和功能。\n\n一个互补DNA (cDNA) 序列（它是成熟mRNA的DNA拷贝）与其对应的基因组DNA位点的比对，必须考虑到内含子的存在。比对模型通过允许在基因组序列中“跳过”内含子区域来实现这一点。这种跳过不是突变，而是生物剪接事件的表示。由于剪接是产生功能性蛋白质的常见且必要的过程，一个生物学上合理的评分方案应该对这一事件给予相对较低的罚分。给定的方案中，内含子起始罚分为 $-3$，内含子延伸罚分为 $0$，这正反映了这一点。对于经典的“GT...AG”剪接位点给予 $+3$ 的奖励进一步完善了这个模型，因为这些信号序列是高度保守的，有助于正确的剪接。\n\n相比之下，移码突变是编码序列中核苷酸数量不能被三整除的插入或缺失 (indel)。这种突变会改变所有下游密码子的三联体阅读框。例如，如果序列 `AUG|GAA|CUU|...` 在第一个密码子后插入一个单核苷酸 `C`，它会变成 `AUG|CGA|ACU|U...`。这会改变随后的每一个密码子，导致氨基酸序列发生巨大变化，并通常产生一个提前终止密码子，从而生成一个截短且无功能的蛋白质。移码突变是罕见的随机事件，几乎总是对生物体极具危害性。因此，评分方案应该对它们施以重罚，以反映其较低的生物学概率和严重的功能影响。给定的方案正确地实现了这一点，通过对移码插入缺失（其中长度 $L \\not\\equiv 0 \\pmod 3$）指定了高达 $-9$ 的空位起始罚分，这比密码子保守的插入缺失（$L \\equiv 0 \\pmod 3$）或内含子跳过的罚分要严厉得多。\n\n总之，对内含子跳过和移码进行差异化罚分是合理的，因为前者代表了一个常见且必要的生物过程（剪接），而后者代表了一个罕见的、灾难性的突变事件。\n\n**最优剪接比对得分的计算**\n\n比对是在基因组序列 $G$ 和cDNA序列 $C$ 之间进行的。\n$G = \\text{ATGGAA}\\,\\text{GTACCAAG}\\,\\text{CTTTAA}$\n$C = \\text{ATGGAACCTTTAA}$\n\n剪接比对的结构假设 $C$ 的外显子部分与 $G$ 的外显子部分比对，并且 $G$ 中的内含子被跳过。我们计算遵循此外显子-内含子-外显子结构的最优比对的得分。\n\n$1$. **外显子1的比对：**\n$C$ 的第一部分是 `ATGGAA`，$G$ 的外显子 $1$ 是 `ATGGAA`。它们完全相同。\n该比对是 $6$ 个核苷酸的完美匹配。\n`G: A T G G A A`\n`C: A T G G A A`\n这部分的得分：$6 \\text{ 个匹配} \\times (\\text{每个匹配 }+2) = +12$。\n\n$2$. **内含子跳过：**\n$G$ 中的内含子是 `GTACCAAG`。其长度为 $8$ 个核苷酸。cDNA源自成熟mRNA，不包含此序列。因此，比对必须“跳过”$G$ 中的这个区域。\n内含子跳过的评分规则是：内含子起始罚分 $-3$，加上每个核苷酸的内含子延伸罚分 $0$。\n基础罚分 = $-3 + (8 \\times 0) = -3$。\n题目规定，如果内含子是经典的，即以 `GT` 开始并以 `AG` 结束，则有 $+3$ 的奖励。内含子 `GTACCAAG` 满足这个条件。\n奖励 = $+3$。\n内含子跳过的总得分 = (基础罚分) + (奖励) = $-3 + 3 = 0$。\n\n$3$. **外显子2的比对：**\n$C$ 的第二部分是 `CCTTTAA`，$G$ 的外显子 $2$ 是 `CTTTAA`。我们需要找到这两个序列之间的最优比对。题目说明 $C$ 在外显子 $2$ 中包含一个单核苷酸插入，这与序列是一致的。因此，比对必须在基因组序列片段中包含一个长度为 $1$ 的空位。\n最优比对是：\n`C: C C T T T A A`\n`G: - C T T T A A`\n这个比对包含一个空位和 $6$ 个匹配。我们来计算它的得分。\n- **空位得分**：空位长度 $L=1$。由于 $1 \\not\\equiv 0 \\pmod 3$，这是一个移码插入缺失。\n罚分为：空位起始 $-9$ 加上每个核苷酸的空位延伸 $-2$。\n空位罚分 = $-9 + (-2 \\times 1) = -11$。\n- **匹配得分**：有 $6$ 个匹配（`C`-`C`, `T`-`T`, `T`-`T`, `T`-`T`, `A`-`A`, `A`-`A`）。\n匹配得分 = $6 \\times (+2) = +12$。\n外显子 $2$ 比对的总得分 = (空位罚分) + (匹配得分) = $-11 + 12 = +1$。\n\n**最优总比对得分：**\n总得分是这三部分得分的总和。\n总得分 = (外显子 $1$ 得分) + (内含子跳过得分) + (外显子 $2$ 得分)\n总得分 = $12 + 0 + 1 = 13$。",
            "answer": "$$\\boxed{13}$$"
        },
        {
            "introduction": "高通量测序技术彻底改变了生物学研究，但其原始数据并非完美无瑕，每个碱基的测序都伴随着一个错误概率。Phred质量分（$Q$分）是评估这种可靠性的行业标准，它将微小的错误概率 $p$ 转换为一个更易于人类解读的对数尺度。本练习将从第一性原理出发，让你推导出 $Q$ 分与 $p$ 之间的关系，并将其应用于一个真实的测序读长（read）样本，计算在进行质量剪切（quality trimming）前后预期会发生的错误数。 这项实践将使你深刻理解质量控制在确保生物信息学分析（如序列比对或变异检测）准确性方面的关键作用。",
            "id": "3863083",
            "problem": "一台新一代测序 (NGS) 仪器输出带有相关 Phred 质量分数的碱基检出，旨在量化碱基检出错误的概率。考虑一个单端 DNA 测序片段，它将被比对到一个从经审编的生物信息学数据库中检索到的参考基因组。您将从第一性原理推导出错误概率到质量分数的映射关系，然后使用此映射关系计算末端质量修剪前后碱基检出错误的预期数量。\n\n从以下基本前提开始：\n- Phred 质量分数 $Q$ 是碱基检出错误概率 $p \\in (0,1]$ 的一个单调转换，其选择反映了经验观察，即在以 10 为底的对数尺度上，$p$ 的乘性变化对应于 $Q$ 的加性变化。具体来说，将 $p$ 减小 10 倍会使 $Q$ 增加 10。\n- 该映射是连续的，对 $p$ 严格递减，并进行了归一化，使得一个确定是错误的碱基检出具有 $p=1$ 并映射到 $Q=0$。\n- 沿着一个测序片段的单个碱基检出错误可以被建模为具有特定位置错误概率 $\\{p_i\\}$ 的独立伯努利试验，根据期望的线性性质，总错误数的期望值是和 $\\sum_i p_i$。\n\n任务：\n1. 推导与上述前提一致的 Phred 质量分数 $Q$ 和错误概率 $p$ 之间的函数关系。\n2. 考虑一个长度为 20 个碱基的测序片段，其沿测序片段（从 $5'$ 端到 $3'$ 端）的 Phred 质量分数由向量给出\n$$\n(35,\\,35,\\,30,\\,30,\\,28,\\,28,\\,25,\\,25,\\,22,\\,22,\\,20,\\,18,\\,18,\\,15,\\,15,\\,12,\\,12,\\,10,\\,10,\\,8).\n$$\n使用您推导的关系，计算完整测序片段的碱基检出错误的预期数量，记为 $E_{\\mathrm{full}}$。\n3. 将阈值为 $Q_{\\mathrm{thr}}$ 的末端质量修剪定义为从 $3'$ 端移除碱基，直到最后一个保留的碱基满足 $Q \\ge Q_{\\mathrm{thr}}$。对于阈值 $Q_{\\mathrm{thr}}=20$，计算修剪后测序片段的碱基检出错误的预期数量，记为 $E_{\\mathrm{trim}}$。\n4. 报告因修剪而导致的预期错误减少量，$\\Delta E = E_{\\mathrm{full}} - E_{\\mathrm{trim}}$。将您的答案四舍五入到四位有效数字。将 $\\Delta E$ 的最终值表示为小数。",
            "solution": "该问题被验证为具有科学依据、提法得当且客观。它基于生物信息学（Phred 质量分数）和概率论的标准原理。所有必要信息均已提供，问题明确。\n\n解答按照问题陈述的要求分四个部分进行。\n\n**1. Phred 质量分数关系的推导**\n\nPhred 质量分数 $Q$ 被定义为碱基检出错误概率 $p \\in (0,1]$ 的函数。设此函数为 $Q(p)$。问题为此函数指定了三个性质：\n- A. $p$ 的乘性变化对应于 $Q$ 的加性变化。具体来说，$Q(p/10) = Q(p) + 10$。\n- B. 函数被归一化，使得 $Q(1) = 0$。\n- C. 函数在 $p \\in (0,1]$ 上是连续且严格递减的。\n\n性质 A 表明存在对数关系。让我们基于以 10 为底的对数提出一个通用形式，$Q(p) = A \\log_{10}(p) + B$，其中 $A$ 和 $B$ 是待定常数。\n\n使用性质 A：\n$$\nQ(p/10) = A \\log_{10}(p/10) + B\n$$\n根据对数的性质，$\\log_{10}(p/10) = \\log_{10}(p) - \\log_{10}(10) = \\log_{10}(p) - 1$。\n$$\nQ(p/10) = A (\\log_{10}(p) - 1) + B = A \\log_{10}(p) - A + B\n$$\n我们已知 $Q(p/10) = Q(p) + 10$。代入所提出的函数形式：\n$$\nA \\log_{10}(p) - A + B = (A \\log_{10}(p) + B) + 10\n$$\n$$\n-A = 10 \\implies A = -10\n$$\n所以，函数的形式为 $Q(p) = -10 \\log_{10}(p) + B$。\n\n接下来，我们使用归一化条件（性质 B），$Q(1) = 0$。\n$$\nQ(1) = -10 \\log_{10}(1) + B = 0\n$$\n由于 $\\log_{10}(1) = 0$，这简化为 $B = 0$。\n\n因此，$Q$ 和 $p$ 之间的函数关系是：\n$$\nQ(p) = -10 \\log_{10}(p)\n$$\n这个关系也满足性质 C。该函数在 $p \\in (0,1]$ 上是连续的。其导数 $\\frac{dQ}{dp} = \\frac{-10}{p \\ln(10)}$ 对所有 $p > 0$ 均为负，证实了 $Q(p)$ 是 $p$ 的严格递减函数。\n\n对于后续计算，有必要将错误概率 $p$ 表示为质量分数 $Q$ 的函数。重新整理方程：\n$$\n-\\frac{Q}{10} = \\log_{10}(p)\n$$\n$$\np(Q) = 10^{-Q/10}\n$$\n\n**2. 完整测序片段的预期错误数 ($E_{\\mathrm{full}}$)**\n\n一个测序片段的预期错误数是每个碱基的错误概率之和，$E = \\sum_i p_i$。该测序片段长度为 $L=20$ 个碱基，其质量分数由以下向量给出：\n$$\n\\mathbf{Q} = (35, 35, 30, 30, 28, 28, 25, 25, 22, 22, 20, 18, 18, 15, 15, 12, 12, 10, 10, 8)\n$$\n完整测序片段的预期错误数 $E_{\\mathrm{full}}$ 是对应于每个质量分数的错误概率之和：\n$$\nE_{\\mathrm{full}} = \\sum_{i=1}^{20} p_i = \\sum_{i=1}^{20} 10^{-Q_i/10}\n$$\n可以通过将相同的质量分数分组来计算总和：\n$$\nE_{\\mathrm{full}} = 2 \\times 10^{-35/10} + 2 \\times 10^{-30/10} + 2 \\times 10^{-28/10} + 2 \\times 10^{-25/10} + 2 \\times 10^{-22/10} + 1 \\times 10^{-20/10} + 2 \\times 10^{-18/10} + 2 \\times 10^{-15/10} + 2 \\times 10^{-12/10} + 2 \\times 10^{-10/10} + 1 \\times 10^{-8/10}\n$$\n$$\nE_{\\mathrm{full}} = 2 \\times 10^{-3.5} + 2 \\times 10^{-3.0} + 2 \\times 10^{-2.8} + 2 \\times 10^{-2.5} + 2 \\times 10^{-2.2} + 10^{-2.0} + 2 \\times 10^{-1.8} + 2 \\times 10^{-1.5} + 2 \\times 10^{-1.2} + 2 \\times 10^{-1.0} + 10^{-0.8}\n$$\n计算各项并将它们相加得到：\n$$\nE_{\\mathrm{full}} \\approx 0.00063246 + 0.002 + 0.00316979 + 0.00632456 + 0.01261915 + 0.01 + 0.03169786 + 0.06324555 + 0.12619147 + 0.2 + 0.15848932 \\approx 0.61437015\n$$\n\n**3. 修剪后测序片段的预期错误数 ($E_{\\mathrm{trim}}$)**\n\n使用阈值 $Q_{\\mathrm{thr}} = 20$ 进行末端质量修剪。其过程是从 $3'$ 端移除碱基，直到最后一个保留的碱基的质量分数 $Q \\ge Q_{\\mathrm{thr}}$。\n我们从右到左（从索引 20 向下到 1）检查质量分数向量 $\\mathbf{Q}$。\n- $Q_{20}=8 < 20$\n- $Q_{19}=10 < 20$\n- $Q_{18}=10 < 20$\n- ...\n- $Q_{12}=18 < 20$\n- $Q_{11}=20 \\ge 20$\n\n满足条件的最后一个碱基位于索引 11 处。因此，所有从索引 12 到 20 的碱基都被修剪掉。修剪后的测序片段由前 11 个碱基组成，其质量分数为：\n$$\n\\mathbf{Q}_{\\mathrm{trim}} = (35, 35, 30, 30, 28, 28, 25, 25, 22, 22, 20)\n$$\n修剪后测序片段的预期错误数 $E_{\\mathrm{trim}}$ 是这 11 个碱基的错误概率之和：\n$$\nE_{\\mathrm{trim}} = \\sum_{i=1}^{11} 10^{-Q_i/10}\n$$\n$$\nE_{\\mathrm{trim}} = 2 \\times 10^{-3.5} + 2 \\times 10^{-3.0} + 2 \\times 10^{-2.8} + 2 \\times 10^{-2.5} + 2 \\times 10^{-2.2} + 10^{-2.0}\n$$\n计算此和：\n$$\nE_{\\mathrm{trim}} \\approx 0.00063246 + 0.002 + 0.00316979 + 0.00632456 + 0.01261915 + 0.01 \\approx 0.03474594\n$$\n\n**4. 预期错误的减少量 ($\\Delta E$)**\n\n因修剪而导致的预期错误减少量是完整测序片段和修剪后测序片段的预期错误数之差：\n$$\n\\Delta E = E_{\\mathrm{full}} - E_{\\mathrm{trim}}\n$$\n此值等价于被修剪掉的碱基的错误概率之和。被修剪的碱基是从索引 12 到 20 的那些，其质量分数为 $(18, 18, 15, 15, 12, 12, 10, 10, 8)$。\n$$\n\\Delta E = \\sum_{i=12}^{20} 10^{-Q_i/10} = 2 \\times 10^{-1.8} + 2 \\times 10^{-1.5} + 2 \\times 10^{-1.2} + 2 \\times 10^{-1.0} + 10^{-0.8}\n$$\n使用前面计算的值：\n$$\n\\Delta E = E_{\\mathrm{full}} - E_{\\mathrm{trim}} \\approx 0.61437015 - 0.03474594 \\approx 0.57962421\n$$\n问题要求将此值四舍五入到四位有效数字。前四位有效数字是 $5, 7, 9, 6$。第五位数字是 $2$，所以我们向下舍入。\n$$\n\\Delta E \\approx 0.5796\n$$\n这是通过修剪测序片段的低质量末端所实现的测序预期错误数的减少量。",
            "answer": "$$\n\\boxed{0.5796}\n$$"
        }
    ]
}