{
    "hands_on_practices": [
        {
            "introduction": "序列比对是模板识别的核心，但我们如何从数值上判断一个比对优于另一个呢？这需要一个精确的评分系统，该系统奖励匹配、惩罚错配和空位。本练习将带您亲手计算序列比对得分，帮助您深入理解在使用标准替换矩阵和仿射空位罚分时，在错配和引入空位之间需要做出的权衡。",
            "id": "3848787",
            "problem": "一个用于同源建模的计算化学生物学工作流程始于通过序列同源性鉴定一个合适的结构模板，然后构建查询序列与候选模板之间可靠的序列比对。在模板鉴定中，使用氨基酸替换矩阵和仿射空位罚分对比对进行评分。考虑查询序列 $Q =$ \"M A D K G\" 和候选模板序列 $T =$ \"M A K D G\"。一个动态规划算法提出了两种可能的全局比对：\n- 无空位比对 $U$：比对位置为 $(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (\\mathrm{D}/\\mathrm{K}), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$。\n- 有空位比对 $V$：比对位置为 $(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (-/\\mathrm{K}), (\\mathrm{D}/-), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$，其中 $-$ 表示一个空位字符。$V$ 中的空位模式包含两个独立的单残基空位片段（一个在 $Q$ 中，一个在 $T$ 中），每个片段的长度为 $L=1$。\n\n使用限于以下配对的Blocks Substitution Matrix (BLOSUM62)条目：\n$s(\\mathrm{M},\\mathrm{M})=5$, $s(\\mathrm{A},\\mathrm{A})=4$, $s(\\mathrm{G},\\mathrm{G})=6$, $s(\\mathrm{K},\\mathrm{K})=5$, and $s(\\mathrm{D},\\mathrm{K})=s(\\mathrm{K},\\mathrm{D})=-1$。\n假设使用仿射空位罚分，其中长度为 $L$ 的单个连续空位片段的成本为 $g+(L-1)e$，$g>0$ 是空位开放罚分，$e\\ge 0$ 是空位延伸罚分。总比对得分是所有比对上的残基对的替换得分之和，减去所有空位片段的空位成本之和。\n\n任务：\n1. 使用指定的BLOSUM62条目和仿射空位罚分定义，计算比对 $U$ 和 $V$ 的得分，将其表示为 $g$ 和 $e$ 的函数。\n2. 确定 $g^{*}$ 的精确值（一个实数），使得对于符合给定定义的任何 $e$ 值，两个比对 $U$ 和 $V$ 的总得分相等。无需四舍五入。\n\n在最终答案中仅提供数值 $g^{*}$。",
            "solution": "该问题要求确定空位开放罚分的一个特定值，记为 $g^{*}$，在该值下，两个蛋白质序列的两种不同比对——一种无空位（$U$）和一种有空位（$V$）——获得相同的总得分。总得分使用替换矩阵和仿射空位罚分模型计算。\n\n首先，我们计算无空位比对 $S_U$ 的总比对得分。\n比对 $U$ 以比对对序列的形式给出：$(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (\\mathrm{D}/\\mathrm{K}), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$。\n由于此比对中没有空位，总得分纯粹是每对比对的替换得分之和。提供的BLOSUM62替换得分为 $s(\\mathrm{M},\\mathrm{M})=5$，$s(\\mathrm{A},\\mathrm{A})=4$，$s(\\mathrm{D},\\mathrm{K})=-1$，$s(\\mathrm{K},\\mathrm{D})=-1$ 和 $s(\\mathrm{G},\\mathrm{G})=6$。\n因此，得分 $S_U$ 为：\n$$S_U = s(\\mathrm{M},\\mathrm{M}) + s(\\mathrm{A},\\mathrm{A}) + s(\\mathrm{D},\\mathrm{K}) + s(\\mathrm{K},\\mathrm{D}) + s(\\mathrm{G},\\mathrm{G})$$\n代入给定值：\n$$S_U = 5 + 4 + (-1) + (-1) + 6 = 13$$\n得分 $S_U$ 是一个常数值 $13$。\n\n接下来，我们计算有空位比对 $S_V$ 的总比对得分。\n比对 $V$ 给出为：$(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (-/\\mathrm{K}), (\\mathrm{D}/-), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$。\n总得分 $S_V$ 是比对上的残基的替换得分之和减去空位的总成本。\n\n$S_V$ 的替换得分部分是非空位对的得分之和：$(\\mathrm{M}/\\mathrm{M})$, $(\\mathrm{A}/\\mathrm{A})$, $(\\mathrm{K}/\\mathrm{D})$ 和 $(\\mathrm{G}/\\mathrm{G})$。\n$$S_{V, \\text{subst}} = s(\\mathrm{M},\\mathrm{M}) + s(\\mathrm{A},\\mathrm{A}) + s(\\mathrm{K},\\mathrm{D}) + s(\\mathrm{G},\\mathrm{G})$$\n代入给定值：\n$$S_{V, \\text{subst}} = 5 + 4 + (-1) + 6 = 14$$\n\n空位罚分部分必须根据仿射空位罚分模型计算，其中长度为 $L$ 的单个连续空位的成本为 $g + (L-1)e$。比对 $V$ 包含两个独立的空位片段：\n1. 查询序列 $Q$ 中的一个空位，对应于 $(-/\\mathrm{K})$。这是一个长度为 $L_1 = 1$ 的空位片段。\n2. 模板序列 $T$ 中的一个空位，对应于 $(\\mathrm{D}/-)$。这是一个长度为 $L_2 = 1$ 的空位片段。\n\n第一个长度为 $L_1=1$ 的空位的成本为：\n$$C_1 = g + (L_1 - 1)e = g + (1-1)e = g$$\n第二个长度为 $L_2=1$ 的空位的成本为：\n$$C_2 = g + (L_2 - 1)e = g + (1-1)e = g$$\n比对 $V$ 的总空位罚分 $P_V$ 是这两个独立空位片段的成本之和：\n$$P_V = C_1 + C_2 = g + g = 2g$$\n\n比对 $V$ 的总得分是替换得分减去总空位罚分：\n$$S_V = S_{V, \\text{subst}} - P_V = 14 - 2g$$\n值得注意的是，得分 $S_V$ 仅取决于 $g$ 而与 $e$ 无关，因为两个空位的长度都为 $L=1$，这使得依赖于 $e$ 的项为零。\n\n最后一步是找到使 $S_U = S_V$ 的值 $g=g^{*}$。问题要求对于空位延伸罚分 $e \\ge 0$ 的任何有效选择，此等式都成立。由于我们已经证明 $S_U$ 和 $S_V$ 都不依赖于 $e$，因此如果我们能找到一个使得分相等的值 $g$，这个条件就得到满足。\n令两个得分相等：\n$$S_U = S_V$$\n$$13 = 14 - 2g$$\n我们现在求解这个关于 $g$ 的线性方程：\n$$2g = 14 - 13$$\n$$2g = 1$$\n$$g = \\frac{1}{2} = 0.5$$\n值 $g=0.5$ 满足给定的约束 $g>0$。因此，值 $g^{*}$ 是 $0.5$。",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "在实际研究中，我们往往会找到许多潜在的同源序列，而非仅仅一个。如何从一个相关的序列家族中提炼出关键信息，是构建高质量模型的下一步。我们通常使用多重序列比对（MSA）来构建统计模型，但必须对高度相似的冗余序列进行降权，以真实反映序列多样性。本练习将演示经典的Henikoff-Henikoff序列加权方案，这是从多重序列比对构建位置特异性评分矩阵（PSSM）时，校正序列偏倚的关键一步。",
            "id": "3848841",
            "problem": "在用于模板识别的同源建模中，一个核心任务是从多序列比对（MSA）构建一个位置特异性概况，该概况能适当地降低冗余序列的权重。位置特异性评分矩阵（PSSM）通常包含序列权重，以使由高度相似序列主导的列不会压倒整个概况。Henikoff-Henikoff加权策略被广泛用于从第一性原理分配序列权重：在每个比对列内，权重首先在不同的残基类别之间分配，然后分配给携带这些残基的序列，从而抵消冗余并强调多样性。全局序列权重通过汇总每列的贡献获得，然后将这组权重归一化到一个定义的总和，以便它们可以被解释为有效计数。\n\n考虑一个由$M=6$个同源序列在$L=5$个位置上比对的MSA，这些位置对应于一个用于模板识别的保守基序。在每个位置$i \\in \\{1,2,3,4,5\\}$的比对残基如下：\n\n- 第 $i=1$ 列：$A, A, A, G, G, -$ （其中 $-$ 表示空位）。\n- 第 $i=2$ 列：$L, L, V, V, V, V$。\n- 第 $i=3$ 列：$K, K, K, K, -, -$。\n- 第 $i=4$ 列：$D, E, D, E, D, E$。\n- 第 $i=5$ 列：$W, W, W, W, W, W$。\n\n序列 $S_{1}$ 到 $S_{6}$ 在这 $L=5$ 个位置上携带以下残基：\n- $S_{1}$: $(A, L, K, D, W)$\n- $S_{2}$: $(A, L, K, E, W)$\n- $S_{3}$: $(A, V, K, D, W)$\n- $S_{4}$: $(G, V, K, E, W)$\n- $S_{5}$: $(G, V, -, D, W)$\n- $S_{6}$: $(-, V, -, E, W)$\n\n使用上述的Henikoff-Henikoff序列加权方法，首先通过汇总比对残基的每列贡献（忽略空位）来计算每个序列的原始权重。然后将这组序列权重归一化，使得所有序列的总权重等于 $M=6$。将在第 $i$ 列的有效序列数定义为在该列携带非空位残基的所有序列的归一化权重之和。\n\n计算在第 $i=3$ 列的有效序列数。请以一个实数形式给出最终答案。如果进行任何近似计算，请将最终答案四舍五入到四位有效数字。不需要单位。",
            "solution": "该问题旨在通过应用Henikoff-Henikoff序列加权方法，计算一个多序列比对（MSA）中特定列的有效序列数。该过程包括计算每个序列的原始权重，对这些权重进行归一化，然后对指定列中包含非空位残基的序列的归一化权重求和。\n\n**阶段 1：计算每列中每种残基类型的贡献权重**\n\n对于MSA中的每一列 $j$，我们计算每种残基类型 $k$ 的权重贡献。该贡献为 $w_{j,k} = \\frac{1}{r_j \\cdot n_{j,k}}$，其中 $r_j$ 是列 $j$ 中不同非空位残基类型的数量，$n_{j,k}$ 是列 $j$ 中残基类型 $k$ 的出现次数。\n\n-   **第1列** ($A,A,A,G,G,-$): $r_1=2$ (A, G)。$n_{1,A}=3, n_{1,G}=2$。\n    -   $w_{1,A} = 1/(2 \\cdot 3) = 1/6$\n    -   $w_{1,G} = 1/(2 \\cdot 2) = 1/4$\n-   **第2列** ($L,L,V,V,V,V$): $r_2=2$ (L, V)。$n_{2,L}=2, n_{2,V}=4$。\n    -   $w_{2,L} = 1/(2 \\cdot 2) = 1/4$\n    -   $w_{2,V} = 1/(2 \\cdot 4) = 1/8$\n-   **第3列** ($K,K,K,K,-,-$): $r_3=1$ (K)。$n_{3,K}=4$。\n    -   $w_{3,K} = 1/(1 \\cdot 4) = 1/4$\n-   **第4列** ($D,E,D,E,D,E$): $r_4=2$ (D, E)。$n_{4,D}=3, n_{4,E}=3$。\n    -   $w_{4,D} = 1/(2 \\cdot 3) = 1/6$\n    -   $w_{4,E} = 1/(2 \\cdot 3) = 1/6$\n-   **第5列** ($W,W,W,W,W,W$): $r_5=1$ (W)。$n_{5,W}=6$。\n    -   $w_{5,W} = 1/(1 \\cdot 6) = 1/6$\n\n**阶段 2：计算每个序列的原始权重**\n\n每个序列的原始权重 $W_s^{\\text{raw}}$ 是其在所有列的贡献之和（空位贡献为0）。\n\n-   $W_1^{\\text{raw}}$ (A,L,K,D,W): $1/6 + 1/4 + 1/4 + 1/6 + 1/6 = 3/6 + 2/4 = 1/2 + 1/2 = 1$\n-   $W_2^{\\text{raw}}$ (A,L,K,E,W): $1/6 + 1/4 + 1/4 + 1/6 + 1/6 = 1$\n-   $W_3^{\\text{raw}}$ (A,V,K,D,W): $1/6 + 1/8 + 1/4 + 1/6 + 1/6 = 3/6 + 3/8 = 1/2 + 3/8 = 7/8$\n-   $W_4^{\\text{raw}}$ (G,V,K,E,W): $1/4 + 1/8 + 1/4 + 1/6 + 1/6 = 2/4 + 1/8 + 2/6 = 1/2 + 1/8 + 1/3 = 12/24 + 3/24 + 8/24 = 23/24$\n-   $W_5^{\\text{raw}}$ (G,V,-,D,W): $1/4 + 1/8 + 0 + 1/6 + 1/6 = 1/4 + 1/8 + 1/3 = 6/24 + 3/24 + 8/24 = 17/24$\n-   $W_6^{\\text{raw}}$ (-,V,-,E,W): $0 + 1/8 + 0 + 1/6 + 1/6 = 1/8 + 1/3 = 3/24 + 8/24 = 11/24$\n\n**阶段 3：归一化序列权重**\n\n首先，计算所有原始权重的总和 $W_{\\text{total}}^{\\text{raw}}$。\n$$ W_{\\text{total}}^{\\text{raw}} = 1 + 1 + \\frac{7}{8} + \\frac{23}{24} + \\frac{17}{24} + \\frac{11}{24} = \\frac{24}{24} + \\frac{24}{24} + \\frac{21}{24} + \\frac{23}{24} + \\frac{17}{24} + \\frac{11}{24} = \\frac{120}{24} = 5 $$\n归一化常数 $C$ 是目标总权重 $M=6$ 除以原始总权重：\n$$ C = \\frac{M}{W_{\\text{total}}^{\\text{raw}}} = \\frac{6}{5} = 1.2 $$\n每个序列的归一化权重 $W_s^{\\text{norm}} = C \\cdot W_s^{\\text{raw}}$。\n-   $W_1^{\\text{norm}} = 1.2 \\cdot 1 = 1.2$\n-   $W_2^{\\text{norm}} = 1.2 \\cdot 1 = 1.2$\n-   $W_3^{\\text{norm}} = 1.2 \\cdot (7/8) = 8.4/8 = 1.05$\n-   $W_4^{\\text{norm}} = 1.2 \\cdot (23/24) = 27.6/24 = 1.15$\n-   $W_5^{\\text{norm}} = 1.2 \\cdot (17/24) = 20.4/24 = 0.85$\n-   $W_6^{\\text{norm}} = 1.2 \\cdot (11/24) = 13.2/24 = 0.55$\n\n**阶段 4：计算第3列的有效序列数**\n\n第3列的有效序列数 $N_{\\text{eff}, 3}$ 是在该列具有非空位残基的序列（$S_1, S_2, S_3, S_4$）的归一化权重之和。\n$$ N_{\\text{eff}, 3} = W_1^{\\text{norm}} + W_2^{\\text{norm}} + W_3^{\\text{norm}} + W_4^{\\text{norm}} $$\n$$ N_{\\text{eff}, 3} = 1.2 + 1.2 + 1.05 + 1.15 = 4.6 $$\n第3列的有效序列数为4.6。该计算是精确的，无需四舍五入。",
            "answer": "$$\n\\boxed{4.6}\n$$"
        },
        {
            "introduction": "单纯追求数学上的最高比对分数，并不总能反映生物学上的真实情况。在同源建模中，保留已知的关键功能位点（如催化中心）的正确对应关系，其重要性有时会超过在其它区域获得更高的局部比对分数。本练习引入了生物学先验知识作为指导比对过程的约束，挑战您量化保留一个保守催化基序的价值，并展示如何将结构和功能知识整合到比对评分中，从而产生更具生物学意义的结果。",
            "id": "3848800",
            "problem": "丝氨酸/苏氨酸蛋白激酶的一个标志性特征是在其催化环中存在保守的组氨酸-精氨酸-天冬氨酸基序（“HRD”）。在同源建模中，于基于模板的比对里保持此类催化基序的配准是一个强有力的结构先验，其重要性可以超过其他位置的局部得分差异。考虑一个激酶样查询序列与一个激酶模板之间的全局比对。在该比对中，模板的 HRD 基序位于位置 $7$–$9$，而查询序列在该基序正前方有一个插入，导致其 HRD 基序移至位置 $8$–$10$。\n\n给定以下序列（单字母氨基酸代码）：\n- 模板 $T$: V A I K V L H R D L K P E N G （位置 $1$ 至 $15$；HRD 在 $7$–$9$）\n- 查询 $Q$: V A I K V L Q H R D L K P E N （位置 $1$ 至 $15$；HRD 在 $8$–$10$）\n\n假设使用以下比对计分规则，该规则与序列比对中使用的基于对数几率的替换计分法一致：\n- 替换得分 $s(a,b)$：如果 $a=b$（相同），则为 $+1$；如果 $a \\neq b$（错配），则为 $0$。\n- 缺口罚分：每个缺口符号贡献 $-10$ 分。\n- 基序配准先验：当且仅当查询序列中的 HRD 基序与模板中的 HRD 基序实现配准比对时（即，在模板基序位置 $7$–$9$ 处，$H$ 与 $H$ 比对，$R$ 与 $R$ 比对，$D$ 与 $D$ 比对），总比对得分才会加上一个额外的权重 $W$，否则不添加基序先验。\n\n考虑两种特定的全局比对：\n- 比对 $\\mathcal{A}$：在模板基序的正前方（模板位置 $6$ 和 $7$ 之间）插入一个缺口，使得 $Q$ 在位置 $7$ 的额外残基与一个缺口比对，并且查询序列位置 $8$–$10$ 的 HRD 与模板位置 $7$–$9$ 的 HRD 实现配准比对。由于两条序列等长，完成全局比对需要在查询序列的末端引入一个平衡的末端缺口，以匹配模板的最后一个残基。\n- 比对 $\\mathcal{B}$：进行直接的、无缺口的按位置全局比对，这导致查询序列的 HRD（位置 $8$–$10$）相对于模板的 HRD（位置 $7$–$9$）发生错位配准。\n\n从序列比对计分的基本定义以及“保守的催化基序编码了同源建模中使用的强大进化约束”这一基本原理出发，推导出当比对 $\\mathcal{A}$ 的总分等于比对 $\\mathcal{B}$ 的总分时的临界基序权重 $W^{*}$ 的表达式，并根据上述序列和计分方案计算其精确值。将 $W^{*}$ 报告为单个实数。无需四舍五入。最终答案不带单位。",
            "solution": "该问题要求确定一个临界基序权重，记为 $W^{*}$，在该权重下，两种不同的全局比对 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的总比对得分相等。我们已知两个蛋白质序列（一个模板 $T$ 和一个查询 $Q$）以及一个特定的计分系统。\n\n序列如下：\n模板 $T$: $\\text{V A I K V L H R D L K P E N G}$\n查询 $Q$: $\\text{V A I K V L Q H R D L K P E N}$\n两条序列的长度均为 $15$ 个残基。保守的 HRD 基序在 $T$ 中位于位置 $7$–$9$，在 $Q$ 中位于位置 $8$–$10$。\n\n计分函数的定义如下：\n- 替换得分 $s(a, b)$，对于相同（$a=b$）为 $+1$，对于错配（$a \\neq b$）为 $0$。\n- 每个缺口符号的缺口罚分为 $-10$。\n- 基序配准先验 $W$，当且仅当 $Q$ 的 HRD 基序与 $T$ 的 HRD 基序实现配准比对时，该权重才会被加到得分中。\n\n首先，我们计算比对 $\\mathcal{A}$ 的得分，记为 $S(\\mathcal{A})$。此比对的构建旨在保持 HRD 基序的配准。这需要在模板序列中引入一个缺口，以容纳查询序列位置 $7$ 处的额外残基 'Q'。由于两条序列等长，因此在查询序列的末端引入一个平衡缺口。\n\n比对 $\\mathcal{A}$ 如下所示：\n$T$: V A I K V L - H R D L K P E N G\n$Q$: V A I K V L Q H R D L K P E N -\n\n得分 $S(\\mathcal{A})$ 是替换得分、缺口罚分和基序先验的总和。\n1.  **替换得分**：我们对每一对比对的残基的得分求和。\n    -   比对列 $1$–$6$ 的残基对均为相同（$\\text{V/V, A/A, I/I, K/K, V/V, L/L}$）。这部分贡献 $6 \\times (+1) = 6$。\n    -   比对列 $8$–$10$ 的残基对比对了 HRD 基序（$\\text{H/H, R/R, D/D}$）。这是 $3$ 个相同，贡献 $3 \\times (+1) = 3$。\n    -   比对列 $11$–$15$ 的残基对也均为相同（$\\text{L/L, K/K, P/P, E/E, N/N}$）。这是 $5$ 个相同，贡献 $5 \\times (+1) = 5$。\n    -   相同的总数为 $6 + 3 + 5 = 14$。替换得分为 $14 \\times (+1) = 14$。\n\n2.  **缺口罚分**：该比对中有两个缺口。\n    -   一个缺口在序列 $T$ 的第 $7$ 列。\n    -   一个缺口在序列 $Q$ 的第 $16$ 列。\n    -   总缺口罚分为 $2 \\times (-10) = -20$。\n\n3.  **基序配准先验**：根据构建方式，HRD 基序是配准比对的。因此，总分中要加上权重 $W$。\n\n比对 $\\mathcal{A}$ 的总分为：\n$$S(\\mathcal{A}) = 14 + (-20) + W = W - 6$$\n\n接下来，我们计算比对 $\\mathcal{B}$ 的得分，记为 $S(\\mathcal{B})$。这是一个没有缺口的直接按位置比对。\n\n比对 $\\mathcal{B}$ 如下所示：\n$T$: V A I K V L H R D L K P E N G\n$Q$: V A I K V L Q H R D L K P E N\n\n得分 $S(\\mathcal{B})$ 计算如下：\n1.  **替换得分**：我们比较每个位置 $i=1, \\dots, 15$ 的残基。\n    -   位置 $1$–$6$ 的残基对是相同的，贡献 $6 \\times (+1) = 6$。\n    -   从位置 $7$ 到 $15$ 的所有其他残基对都是错配：$\\text{H/Q, R/H, D/R, L/D, K/L, P/K, E/P, N/E, G/N}$。共有 $9$ 个错配，每个贡献得分为 $0$。\n    -   总替换得分为 $6 + (9 \\times 0) = 6$。\n\n2.  **缺口罚分**：此比对中没有缺口。贡献为 $0$。\n\n3.  **基序配准先验**：$Q$ 中的 HRD 基序（位置 $8$–$10$）与 $T$ 中位置 $8$–$10$ 的残基（$\\text{R, D, L}$）进行比对。这与 $T$ 在位置 $7$–$9$ 的 HRD 基序没有形成配准比对。因此，不添加基序先验 $W$。贡献为 $0$。\n\n比对 $\\mathcal{B}$ 的总分为：\n$$S(\\mathcal{B}) = 6 + 0 + 0 = 6$$\n\n问题要求解出两个得分相等时的临界权重 $W^{*}$。我们令 $S(\\mathcal{A}) = S(\\mathcal{B})$，并求解 $W=W^{*}$：\n$$W^{*} - 6 = 6$$\n$$W^{*} = 12$$\n\n因此，当基序配准比对的得分等于无缺口、错位配准比对的得分时，临界基序权重为 $12$。",
            "answer": "$$\\boxed{12}$$"
        }
    ]
}