{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental question when comparing two structures is: how similar are they? The Root-Mean-Square Deviation (RMSD) provides the classic answer by averaging distances between corresponding atoms after optimal superposition. This practice guides you through the foundational calculation of RMSD from scratch and powerfully illustrates its sensitivity to localized, large-scale errors—a crucial consideration when evaluating computational models. ",
            "id": "3836349",
            "problem": "A central question in assessing protein model quality is how closely a predicted structure matches a trusted reference. Consider a small peptide fragment whose reference conformation and predicted model have been pre-aligned by an optimal rigid-body superposition that minimizes the sum of squared inter-atomic distances (rotation and translation only). Assume one-to-one atom correspondence. Use the following coordinates, in angstroms, where $\\mathbf{r}_i^{(R)}$ denotes the reference coordinates and $\\mathbf{r}_i^{(M)}$ denotes the model coordinates for atom $i$:\n- Atom $1$: $\\mathbf{r}_1^{(R)} = (0.0, 0.0, 0.0)$; $\\mathbf{r}_1^{(M)} = (0.1, -0.1, 0.0)$\n- Atom $2$: $\\mathbf{r}_2^{(R)} = (1.0, 0.0, 0.0)$; $\\mathbf{r}_2^{(M)} = (1.2, -0.2, 0.1)$\n- Atom $3$: $\\mathbf{r}_3^{(R)} = (2.0, 0.5, 0.0)$; $\\mathbf{r}_3^{(M)} = (1.8, 0.6, -0.1)$\n- Atom $4$: $\\mathbf{r}_4^{(R)} = (3.0, 1.0, 0.5)$; $\\mathbf{r}_4^{(M)} = (8.0, 1.0, 0.5)$\n- Atom $5$: $\\mathbf{r}_5^{(R)} = (4.0, 1.5, 1.0)$; $\\mathbf{r}_5^{(M)} = (4.1, 1.6, 1.2)$\n- Atom $6$: $\\mathbf{r}_6^{(R)} = (5.0, 2.0, 1.5)$; $\\mathbf{r}_6^{(M)} = (5.2, 2.1, 1.4)$\n\nStart from first principles: the Euclidean distance between two points in three-dimensional space is defined by the magnitude of their difference vector. Let $\\Delta x_i = x_i^{(M)} - x_i^{(R)}$, $\\Delta y_i = y_i^{(M)} - y_i^{(R)}$, and $\\Delta z_i = z_i^{(M)} - z_i^{(R)}$ denote component-wise differences for atom $i$, and let the inter-atomic distance be the nonnegative quantity given by the length of that difference vector.\n\nTask:\n1. Using the definition above, compute the root-mean-square deviation (RMSD) between the model and reference over all $N = 6$ atoms.\n2. Recompute the RMSD after removing the single most discordant atom (i.e., the atom whose individual distance is largest) and using the remaining $N = 5$ atoms.\n\nRound each RMSD to four significant figures. Express your answers in angstroms. Provide both values as a single final answer, with the first entry being the $N = 6$ value and the second entry being the $N = 5$ value.",
            "solution": "The problem is assessed as valid as it is scientifically grounded, well-posed, and objective. It provides a complete and consistent set of data for a standard calculation in computational chemical biology.\n\nThe root-mean-square deviation (RMSD) is a measure of the average distance between a set of corresponding atoms in two superimposed molecular structures. It is defined as the square root of the mean of the squared Euclidean distances between the atoms.\n\nLet $\\mathbf{r}_i^{(R)}$ be the coordinate vector of atom $i$ in the reference structure and $\\mathbf{r}_i^{(M)}$ be the coordinate vector of the corresponding atom $i$ in the model structure. The number of atoms is $N$. The squared Euclidean distance $d_i^2$ for atom $i$ is given by:\n$$d_i^2 = ||\\mathbf{r}_i^{(M)} - \\mathbf{r}_i^{(R)}||^2 = (x_i^{(M)} - x_i^{(R)})^2 + (y_i^{(M)} - y_i^{(R)})^2 + (z_i^{(M)} - z_i^{(R)})^2$$\nThe RMSD is then calculated as:\n$$\\text{RMSD} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} d_i^2}$$\n\nFirst, we calculate the squared distance $d_i^2$ for each of the $N=6$ atoms, with all coordinates in angstroms ($\\text{Å}$).\n\nFor atom $i=1$:\n$\\Delta\\mathbf{r}_1 = \\mathbf{r}_1^{(M)} - \\mathbf{r}_1^{(R)} = (0.1, -0.1, 0.0) - (0.0, 0.0, 0.0) = (0.1, -0.1, 0.0)$\n$d_1^2 = (0.1)^2 + (-0.1)^2 + (0.0)^2 = 0.01 + 0.01 + 0 = 0.02$\n\nFor atom $i=2$:\n$\\Delta\\mathbf{r}_2 = \\mathbf{r}_2^{(M)} - \\mathbf{r}_2^{(R)} = (1.2, -0.2, 0.1) - (1.0, 0.0, 0.0) = (0.2, -0.2, 0.1)$\n$d_2^2 = (0.2)^2 + (-0.2)^2 + (0.1)^2 = 0.04 + 0.04 + 0.01 = 0.09$\n\nFor atom $i=3$:\n$\\Delta\\mathbf{r}_3 = \\mathbf{r}_3^{(M)} - \\mathbf{r}_3^{(R)} = (1.8, 0.6, -0.1) - (2.0, 0.5, 0.0) = (-0.2, 0.1, -0.1)$\n$d_3^2 = (-0.2)^2 + (0.1)^2 + (-0.1)^2 = 0.04 + 0.01 + 0.01 = 0.06$\n\nFor atom $i=4$:\n$\\Delta\\mathbf{r}_4 = \\mathbf{r}_4^{(M)} - \\mathbf{r}_4^{(R)} = (8.0, 1.0, 0.5) - (3.0, 1.0, 0.5) = (5.0, 0.0, 0.0)$\n$d_4^2 = (5.0)^2 + (0.0)^2 + (0.0)^2 = 25.0$\n\nFor atom $i=5$:\n$\\Delta\\mathbf{r}_5 = \\mathbf{r}_5^{(M)} - \\mathbf{r}_5^{(R)} = (4.1, 1.6, 1.2) - (4.0, 1.5, 1.0) = (0.1, 0.1, 0.2)$\n$d_5^2 = (0.1)^2 + (0.1)^2 + (0.2)^2 = 0.01 + 0.01 + 0.04 = 0.06$\n\nFor atom $i=6$:\n$\\Delta\\mathbf{r}_6 = \\mathbf{r}_6^{(M)} - \\mathbf{r}_6^{(R)} = (5.2, 2.1, 1.4) - (5.0, 2.0, 1.5) = (0.2, 0.1, -0.1)$\n$d_6^2 = (0.2)^2 + (0.1)^2 + (-0.1)^2 = 0.04 + 0.01 + 0.01 = 0.06$\n\nAll squared distances are in units of $\\text{Å}^2$. The values are: $d_1^2 = 0.02$, $d_2^2 = 0.09$, $d_3^2 = 0.06$, $d_4^2 = 25.0$, $d_5^2 = 0.06$, $d_6^2 = 0.06$.\n\n**Task 1: Compute RMSD for all $N=6$ atoms.**\nThe sum of the squared distances is:\n$$\\sum_{i=1}^{6} d_i^2 = 0.02 + 0.09 + 0.06 + 25.0 + 0.06 + 0.06 = 25.29\\,\\text{Å}^2$$\nThe mean squared distance is:\n$$\\frac{1}{6} \\sum_{i=1}^{6} d_i^2 = \\frac{25.29}{6} = 4.215\\,\\text{Å}^2$$\nThe RMSD for $N=6$ atoms is:\n$$\\text{RMSD}_{N=6} = \\sqrt{4.215} \\approx 2.0530465...\\,\\text{Å}$$\nRounding to four significant figures, we get $\\text{RMSD}_{N=6} = 2.053\\,\\text{Å}$.\n\n**Task 2: Recompute RMSD after removing the most discordant atom.**\nThe \"most discordant atom\" is the one with the largest individual distance $d_i$, which corresponds to the largest squared distance $d_i^2$. Comparing the calculated values, $d_4^2 = 25.0\\,\\text{Å}^2$ is by far the largest. Thus, atom $4$ is the most discordant atom.\n\nWe recompute the RMSD for the remaining $N = 5$ atoms (atoms $1$, $2$, $3$, $5$, and $6$).\nThe new sum of squared distances is:\n$$\\sum_{i \\in \\{1,2,3,5,6\\}} d_i^2 = d_1^2 + d_2^2 + d_3^2 + d_5^2 + d_6^2 = 0.02 + 0.09 + 0.06 + 0.06 + 0.06 = 0.29\\,\\text{Å}^2$$\nThe new mean squared distance, with $N=5$, is:\n$$\\frac{1}{5} \\sum_{i \\in \\{1,2,3,5,6\\}} d_i^2 = \\frac{0.29}{5} = 0.058\\,\\text{Å}^2$$\nThe RMSD for $N=5$ atoms is:\n$$\\text{RMSD}_{N=5} = \\sqrt{0.058} \\approx 0.2408318...\\,\\text{Å}$$\nRounding to four significant figures, we get $\\text{RMSD}_{N=5} = 0.2408\\,\\text{Å}$.\n\nThe two requested values are the RMSD for $N=6$ atoms and the RMSD for $N=5$ atoms after removing the major outlier.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.053 & 0.2408\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A model that is globally similar to a reference is not necessarily physically plausible; it might contain impossible atomic arrangements. This practice shifts our focus from reference-based comparison to intrinsic stereochemical quality by implementing a clash score, a key metric for identifying severe steric overlaps. By translating the physical concept of van der Waals radii into a computational algorithm, you will develop a tool to quantify a model's realism and learn to handle complexities like covalent bond exclusions. ",
            "id": "3836346",
            "problem": "You are tasked with implementing a program to assess protein model quality by computing the clash score for a set of atoms. The clash score is defined as the number of serious steric overlaps per $1000$ atoms. The assessment must be grounded in physical principles and must avoid heuristic shortcut formulas. Begin from the following bases: (i) the definition of non-bonded steric repulsion modeled by the Lennard-Jones (LJ) potential, and (ii) the interpretation of van der Waals (vdW) radii as effective hard-sphere radii encoding contact distances for non-bonded atoms.\n\nStarting point for derivation: The Lennard-Jones potential energy function for two interacting neutral atoms is given by $U(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$, where $r$ is the center-to-center separation, $\\varepsilon$ is a depth parameter, and $\\sigma$ sets the length scale at which the potential is zero. The potential minimum occurs at a separation where repulsion and attraction balance. For pairs of atoms, a widely used representation of steric size is the van der Waals radius $r_{\\mathrm{vdW}}$, which approximates half the equilibrium separation for identical species and, more generally, the contact distance for dissimilar species can be approximated by the sum of their van der Waals radii. Serious steric overlaps are defined operationally by a threshold beyond the contact distance: if two non-bonded atoms are closer than the contact distance minus a fixed tolerance, then their spatial overlap is considered serious.\n\nDefine the following elements:\n- The van der Waals radii (in Ångström) to be used are constant and given by the Bondi set: Hydrogen $\\mathrm{H}$: $1.20$, Carbon $\\mathrm{C}$: $1.70$, Nitrogen $\\mathrm{N}$: $1.55$, Oxygen $\\mathrm{O}$: $1.52$, Sulfur $\\mathrm{S}$: $1.80$.\n- The serious overlap tolerance $\\tau$ (in Ångström) is $0.40$.\n- A pair of atoms is considered only if the pair is not directly bonded and not a $1$-$3$ pair (separated by two bonds along a path in the bond graph). Counting must be performed over unique unordered pairs.\n- The number of serious steric overlaps must be normalized per atom and reported as the clash score, defined as the number of serious steric overlaps divided by the number of atoms, multiplied by $1000$.\n\nYour program must:\n- Derive the operative distance-based criterion for serious steric overlap from the Lennard-Jones potential contact distance logic and the van der Waals radii definition. From this derivation, implement a computation of the clash score for each test case.\n- Use the Euclidean metric for distances between atom centers. All coordinates are provided in Ångström, and all distances and radii are in Ångström.\n- Exclude directly bonded pairs and $1$-$3$ pairs from overlap consideration based on the provided bond list for each test case.\n- Express each result as a float rounded to $3$ decimal places.\n\nTest suite specification:\n- Use the following van der Waals radii mapping (Ångström): $\\mathrm{H}=1.20$, $\\mathrm{C}=1.70$, $\\mathrm{N}=1.55$, $\\mathrm{O}=1.52$, $\\mathrm{S}=1.80$.\n- Use $\\tau = 0.40$ Ångström for serious overlap tolerance.\n- Coordinates are in Ångström. Bonds are given as pairs of zero-based indices.\n\nProvide the following test cases as hard-coded inputs in your program:\n\n- Test case $1$ (general case): Atoms\n  - $\\mathrm{C}$ at $(0.0, 0.0, 0.0)$,\n  - $\\mathrm{N}$ at $(1.0, 0.0, 0.0)$,\n  - $\\mathrm{O}$ at $(2.9, 0.0, 0.0)$,\n  - $\\mathrm{H}$ at $(10.0, 0.0, 0.0)$;\n  Bonds: none.\n- Test case $2$ (boundary equality at tolerance): Atoms\n  - $\\mathrm{C}$ at $(0.0, 0.0, 0.0)$,\n  - $\\mathrm{C}$ at $(3.0, 0.0, 0.0)$;\n  Bonds: none.\n- Test case $3$ (edge case with coincident atoms and a distant atom): Atoms\n  - $\\mathrm{H}$ at $(0.0, 0.0, 0.0)$,\n  - $\\mathrm{H}$ at $(0.0, 0.0, 0.0)$,\n  - $\\mathrm{O}$ at $(5.0, 5.0, 5.0)$;\n  Bonds: none.\n- Test case $4$ (exclusion of bonded and $1$-$3$ pairs): Atoms\n  - index $0$: $\\mathrm{C}$ at $(0.0, 0.0, 0.0)$,\n  - index $1$: $\\mathrm{N}$ at $(3.0, 0.0, 0.0)$,\n  - index $2$: $\\mathrm{C}$ at $(7.0, 0.0, 0.0)$,\n  - index $3$: $\\mathrm{O}$ at $(3.2, 0.0, 0.0)$;\n  Bonds: $(0,1)$ and $(1,2)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the clash scores for the four test cases as a comma-separated list enclosed in square brackets, with each value rounded to $3$ decimal places (e.g., $[x_1,x_2,x_3,x_4]$).",
            "solution": "The problem requires the implementation of a program to compute the clash score for a given set of atoms. A clash score quantifies the severity of steric overlaps in a molecular structure. The derivation and computation must be grounded in the physical principles of interatomic interactions, specifically the Lennard-Jones potential and the concept of van der Waals radii.\n\n### 1. Derivation of the Steric Clash Criterion\n\nThe foundation of non-bonded atomic interactions is the Lennard-Jones (LJ) potential, which describes the potential energy $U$ as a function of the separation distance $r$ between two neutral atoms:\n$$U(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$$\nHere, the term proportional to $r^{-12}$ represents the strong, short-range Pauli repulsion arising from overlapping electron orbitals, while the term proportional to $r^{-6}$ represents the weaker, long-range London dispersion attraction. The parameter $\\varepsilon$ is the depth of the potential well, and $\\sigma$ is the finite distance at which the inter-particle potential is zero.\n\nThe equilibrium distance between two atoms, $r_{min}$, occurs at the minimum of this potential, where the net force is zero. This distance corresponds to the ideal contact distance. In practice, the van der Waals radius, $r_{\\mathrm{vdW}}$, is used as an effective hard-sphere radius for an atom. For a pair of non-bonded atoms $i$ and $j$, the sum of their van der Waals radii, $r_{\\mathrm{vdW},i} + r_{\\mathrm{vdW},j}$, provides a reliable approximation of their equilibrium separation distance, or contact distance, $d_{\\mathrm{contact}, ij}$.\n$$d_{\\mathrm{contact}, ij} = r_{\\mathrm{vdW}, i} + r_{\\mathrm{vdW}, j}$$\n\nA \"serious steric overlap,\" or a clash, is defined as a situation where two atoms are forced significantly closer than this contact distance. The problem specifies an operational definition for such an event: a clash occurs if the measured center-to-center distance, $d_{ij}$, is less than the contact distance minus a fixed tolerance, $\\tau$. This gives the quantitative criterion for a clash between atoms $i$ and $j$:\n$$d_{ij} < (r_{\\mathrm{vdW}, i} + r_{\\mathrm{vdW}, j} - \\tau)$$\nFor this problem, the tolerance is given as $\\tau = 0.40$ Ångström.\n\n### 2. Algorithmic Procedure for Clash Score Calculation\n\nThe clash score is defined as the number of serious steric overlaps per $1000$ atoms. The algorithm to compute this score for a given molecular system is as follows:\n\n1.  **Input Data Representation**: For each test case, we are provided with a list of atoms, specifying their element type and Cartesian coordinates $(x, y, z)$, and a list of bonds between pairs of atoms, identified by their zero-based indices. The van der Waals radii for the relevant elements ($\\mathrm{H}$, $\\mathrm{C}$, $\\mathrm{N}$, $\\mathrm{O}$, $\\mathrm{S}$) are provided as constants.\n\n2.  **Exclusion of Covalently-Linked Pairs**: Steric clashes are only considered between atoms that are not in close proximity due to the covalent bond structure. Standard practice, as specified, is to exclude pairs of atoms that are directly bonded (a $1$-$2$ relationship) and pairs that are separated by two bonds (a $1$-$3$ or geminal relationship).\n    -   A set of excluded pairs is constructed by first adding all directly bonded pairs from the input bond list.\n    -   Next, $1$-$3$ pairs are identified. For each atom $i$, we find its bonded neighbors $j$. For each neighbor $j$, we find its neighbors $k$. Any pair $(i, k)$ where $i \\neq k$ is a $1$-$3$ pair and is added to the exclusion set. To handle unordered pairs consistently, pairs are stored in a canonical form, e.g., `(min(i, j), max(i, j))`.\n\n3.  **Iterative Pairwise Analysis**: The algorithm iterates through all unique, unordered pairs of atoms $(i, j)$ in the system, where $i < j$.\n    -   For each pair, it first checks if the pair $(i, j)$ is in the exclusion set. If it is, the pair is skipped.\n\n4.  **Clash Detection**: For each non-excluded pair $(i, j)$:\n    -   Calculate the Euclidean distance, $d_{ij}$, between their centers using their coordinates $(x_i, y_i, z_i)$ and $(x_j, y_j, z_j)$:\n        $$d_{ij} = \\sqrt{(x_i - x_j)^2 + (y_i - y_j)^2 + (z_i - z_j)^2}$$\n    -   Retrieve the van der Waals radii, $r_{\\mathrm{vdW}, i}$ and $r_{\\mathrm{vdW}, j}$, corresponding to the element types of atoms $i$ and $j$.\n    -   Apply the clash criterion: if $d_{ij} < r_{\\mathrm{vdW}, i} + r_{\\mathrm{vdW}, j} - \\tau$, increment a counter for the total number of clashes, $N_{\\text{clashes}}$.\n\n5.  **Clash Score Normalization**: After examining all valid pairs, the final clash score is calculated. Let $N_{\\text{atoms}}$ be the total number of atoms in the system. The score is given by:\n    $$\\text{Clash Score} = \\frac{N_{\\text{clashes}}}{N_{\\text{atoms}}} \\times 1000$$\n    The result is then rounded to $3$ decimal places as required. This procedure is applied independently to each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the clash score problem for a series of pre-defined test cases.\n    \"\"\"\n\n    # --- Problem Constants ---\n    VDW_RADII = {\n        'H': 1.20,\n        'C': 1.70,\n        'N': 1.55,\n        'O': 1.52,\n        'S': 1.80,\n    }\n    TOLERANCE = 0.40\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {\n            \"atoms\": [\n                {'type': 'C', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'N', 'coords': (1.0, 0.0, 0.0)},\n                {'type': 'O', 'coords': (2.9, 0.0, 0.0)},\n                {'type': 'H', 'coords': (10.0, 0.0, 0.0)},\n            ],\n            \"bonds\": []\n        },\n        {\n            \"atoms\": [\n                {'type': 'C', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'C', 'coords': (3.0, 0.0, 0.0)},\n            ],\n            \"bonds\": []\n        },\n        {\n            \"atoms\": [\n                {'type': 'H', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'H', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'O', 'coords': (5.0, 5.0, 5.0)},\n            ],\n            \"bonds\": []\n        },\n        {\n            \"atoms\": [\n                {'type': 'C', 'coords': (0.0, 0.0, 0.0)},  # index 0\n                {'type': 'N', 'coords': (3.0, 0.0, 0.0)},  # index 1\n                {'type': 'C', 'coords': (7.0, 0.0, 0.0)},  # index 2\n                {'type': 'O', 'coords': (3.2, 0.0, 0.0)},  # index 3\n            ],\n            \"bonds\": [(0, 1), (1, 2)]\n        }\n    ]\n\n    def calculate_clash_score(atoms, bonds):\n        \"\"\"\n        Calculates the clash score for a single molecular system.\n        \"\"\"\n        n_atoms = len(atoms)\n        if n_atoms  2:\n            return 0.0\n\n        # Build adjacency list to represent the bond graph\n        adj = {i: [] for i in range(n_atoms)}\n        for u, v in bonds:\n            adj[u].append(v)\n            adj[v].append(u)\n\n        # Build a set of excluded pairs (1-2 and 1-3 relationships)\n        # Pairs are stored as sorted tuples for canonical representation.\n        excluded_pairs = set()\n\n        # Add 1-2 pairs (direct bonds)\n        for u, v in bonds:\n            excluded_pairs.add(tuple(sorted((u, v))))\n\n        # Add 1-3 pairs (geminal)\n        for i in range(n_atoms):\n            # For each neighbor j of i\n            for j in adj[i]:\n                # For each neighbor k of j\n                for k in adj[j]:\n                    if i != k:\n                        excluded_pairs.add(tuple(sorted((i, k))))\n\n        clash_count = 0\n        atom_data = [{'type': atom['type'], 'pos': np.array(atom['coords'])} for atom in atoms]\n\n        # Iterate over all unique, unordered pairs of atoms\n        for i in range(n_atoms):\n            for j in range(i + 1, n_atoms):\n                # Skip if the pair is excluded\n                if tuple(sorted((i, j))) in excluded_pairs:\n                    continue\n\n                atom_i = atom_data[i]\n                atom_j = atom_data[j]\n\n                # Calculate Euclidean distance\n                distance = np.linalg.norm(atom_i['pos'] - atom_j['pos'])\n                \n                # Get van der Waals radii\n                r_vdw_i = VDW_RADII[atom_i['type']]\n                r_vdw_j = VDW_RADII[atom_j['type']]\n                \n                # Define clash threshold based on the sum of radii and tolerance\n                clash_threshold = r_vdw_i + r_vdw_j - TOLERANCE\n\n                # Check for clash\n                if distance  clash_threshold:\n                    clash_count += 1\n        \n        # Normalize and calculate final score\n        clash_score = (clash_count / n_atoms) * 1000\n        return clash_score\n\n    results = []\n    for case in test_cases:\n        score = calculate_clash_score(case[\"atoms\"], case[\"bonds\"])\n        # Format to 3 decimal places\n        results.append(f\"{score:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Global metrics like RMSD can be misleading, as a single poorly modeled loop or domain can inflate the score, masking an otherwise excellent prediction. The local Distance Difference Test (lDDT) offers a more modern, residue-level assessment by evaluating how well the local atomic environment around each residue is preserved. This exercise will walk you through the calculation of an lDDT score, demonstrating how its use of multiple distance tolerance bands provides a nuanced and robust measure of local model quality. ",
            "id": "3836334",
            "problem": "In computational chemical biology, a central goal in assessing protein model quality is to quantify how faithfully a model preserves experimentally observed inter-residue distances. One widely used per-residue metric is the local Distance Difference Test (lDDT), which evaluates, for a given residue $i$, the agreement between model and target distances to nearby residues.\n\nConsider a residue $i$ for which a set of candidate residues indexed by $j \\in \\{1,2,3,4,5,6,7,8\\}$ has been identified. For each pair $(i,j)$, the experimentally determined (target) inter-residue distance $d_{ij}^{\\mathrm{target}}$ and the corresponding model inter-residue distance $d_{ij}^{\\mathrm{model}}$ (both measured between $\\mathrm{C}_\\alpha$ atoms) are provided below. Distances are given in $\\text{\\AA}$:\n- $j=1$: $d_{ij}^{\\mathrm{target}} = 3.8$, $d_{ij}^{\\mathrm{model}} = 3.6$.\n- $j=2$: $d_{ij}^{\\mathrm{target}} = 6.2$, $d_{ij}^{\\mathrm{model}} = 7.0$.\n- $j=3$: $d_{ij}^{\\mathrm{target}} = 8.9$, $d_{ij}^{\\mathrm{model}} = 12.8$.\n- $j=4$: $d_{ij}^{\\mathrm{target}} = 10.5$, $d_{ij}^{\\mathrm{model}} = 10.8$.\n- $j=5$: $d_{ij}^{\\mathrm{target}} = 9.7$, $d_{ij}^{\\mathrm{model}} = 11.5$.\n- $j=6$: $d_{ij}^{\\mathrm{target}} = 12.0$, $d_{ij}^{\\mathrm{model}} = 15.1$.\n- $j=7$: $d_{ij}^{\\mathrm{target}} = 5.0$, $d_{ij}^{\\mathrm{model}} = 5.4$.\n- $j=8$: $d_{ij}^{\\mathrm{target}} = 10.0$, $d_{ij}^{\\mathrm{model}} = 14.5$.\n\nDefine the neighbor set $N_i$ as all indices $j$ such that $d_{ij}^{\\mathrm{target}} \\leq c$, with cutoff $c = 10$ \\,\\text{\\AA}. For each $j \\in N_i$, define the absolute discrepancy $\\Delta_{ij} = \\left| d_{ij}^{\\mathrm{model}} - d_{ij}^{\\mathrm{target}} \\right|$.\n\nUsing the tolerance bands of $\\pm 0.5$, $\\pm 1$, $\\pm 2$, and $\\pm 4$ \\,\\text{\\AA}, compute the per-residue local Distance Difference Test (lDDT) score for residue $i$ by averaging, over these four tolerance bands, the fraction of neighbors in $N_i$ whose absolute discrepancy $\\Delta_{ij}$ is less than or equal to the respective band half-width. Express the final lDDT score as a single number without units. No rounding is required.",
            "solution": "The problem requires the calculation of the per-residue local Distance Difference Test (lDDT) score for a residue $i$ based on a given set of model and target distances to neighboring residues. The calculation follows a specified procedure involving neighbor identification, discrepancy calculation, and averaging over tolerance bands.\n\nFirst, we must identify the set of neighbors $N_i$ for residue $i$. The problem defines $N_i$ as the set of all indices $j$ for which the experimentally determined (target) inter-residue distance $d_{ij}^{\\mathrm{target}}$ is less than or equal to a cutoff $c = 10\\,\\text{\\AA}$. We examine each of the $8$ candidate residues:\n\n- For $j=1$: $d_{i1}^{\\mathrm{target}} = 3.8\\,\\text{\\AA} \\leq 10\\,\\text{\\AA}$. Thus, $1 \\in N_i$.\n- For $j=2$: $d_{i2}^{\\mathrm{target}} = 6.2\\,\\text{\\AA} \\leq 10\\,\\text{\\AA}$. Thus, $2 \\in N_i$.\n- For $j=3$: $d_{i3}^{\\mathrm{target}} = 8.9\\,\\text{\\AA} \\leq 10\\,\\text{\\AA}$. Thus, $3 \\in N_i$.\n- For $j=4$: $d_{i4}^{\\mathrm{target}} = 10.5\\,\\text{\\AA}  10\\,\\text{\\AA}$. Thus, $4 \\notin N_i$.\n- For $j=5$: $d_{i5}^{\\mathrm{target}} = 9.7\\,\\text{\\AA} \\leq 10\\,\\text{\\AA}$. Thus, $5 \\in N_i$.\n- For $j=6$: $d_{i6}^{\\mathrm{target}} = 12.0\\,\\text{\\AA}  10\\,\\text{\\AA}$. Thus, $6 \\notin N_i$.\n- For $j=7$: $d_{i7}^{\\mathrm{target}} = 5.0\\,\\text{\\AA} \\leq 10\\,\\text{\\AA}$. Thus, $7 \\in N_i$.\n- For $j=8$: $d_{i8}^{\\mathrm{target}} = 10.0\\,\\text{\\AA} \\leq 10\\,\\text{\\AA}$. Thus, $8 \\in N_i$.\n\nThe resulting neighbor set is $N_i = \\{1, 2, 3, 5, 7, 8\\}$. The total number of neighbors is $|N_i| = 6$.\n\nNext, we calculate the absolute discrepancy $\\Delta_{ij} = | d_{ij}^{\\mathrm{model}} - d_{ij}^{\\mathrm{target}} |$ for each neighbor $j \\in N_i$:\n\n- For $j=1$: $\\Delta_{i1} = |3.6 - 3.8| = |-0.2| = 0.2\\,\\text{\\AA}$.\n- For $j=2$: $\\Delta_{i2} = |7.0 - 6.2| = |0.8| = 0.8\\,\\text{\\AA}$.\n- For $j=3$: $\\Delta_{i3} = |12.8 - 8.9| = |3.9| = 3.9\\,\\text{\\AA}$.\n- For $j=5$: $\\Delta_{i5} = |11.5 - 9.7| = |1.8| = 1.8\\,\\text{\\AA}$.\n- For $j=7$: $\\Delta_{i7} = |5.4 - 5.0| = |0.4| = 0.4\\,\\text{\\AA}$.\n- For $j=8$: $\\Delta_{i8} = |14.5 - 10.0| = |4.5| = 4.5\\,\\text{\\AA}$.\n\nThe set of discrepancies for the neighbors in $N_i$ is $\\{0.2, 0.8, 3.9, 1.8, 0.4, 4.5\\}$.\n\nThe lDDT score is the average of the fractions of preserved distances over four tolerance bands. Let the tolerance band half-widths be $T_1 = 0.5\\,\\text{\\AA}$, $T_2 = 1.0\\,\\text{\\AA}$, $T_3 = 2.0\\,\\text{\\AA}$, and $T_4 = 4.0\\,\\text{\\AA}$. For each tolerance $T_k$, we compute the fraction $f_k$ of neighbors in $N_i$ for which the discrepancy $\\Delta_{ij}$ is less than or equal to $T_k$.\n\n1.  For the tolerance $T_1 = 0.5\\,\\text{\\AA}$:\n    We count the number of neighbors with $\\Delta_{ij} \\leq 0.5$. These are $j=1$ ($\\Delta_{i1}=0.2$) and $j=7$ ($\\Delta_{i7}=0.4$).\n    There are $2$ such neighbors. The fraction is $f_1 = \\frac{2}{6} = \\frac{1}{3}$.\n\n2.  For the tolerance $T_2 = 1.0\\,\\text{\\AA}$:\n    We count the number of neighbors with $\\Delta_{ij} \\leq 1.0$. These are $j=1$ ($\\Delta_{i1}=0.2$), $j=2$ ($\\Delta_{i2}=0.8$), and $j=7$ ($\\Delta_{i7}=0.4$).\n    There are $3$ such neighbors. The fraction is $f_2 = \\frac{3}{6} = \\frac{1}{2}$.\n\n3.  For the tolerance $T_3 = 2.0\\,\\text{\\AA}$:\n    We count the number of neighbors with $\\Delta_{ij} \\leq 2.0$. These are $j=1$ ($\\Delta_{i1}=0.2$), $j=2$ ($\\Delta_{i2}=0.8$), $j=5$ ($\\Delta_{i5}=1.8$), and $j=7$ ($\\Delta_{i7}=0.4$).\n    There are $4$ such neighbors. The fraction is $f_3 = \\frac{4}{6} = \\frac{2}{3}$.\n\n4.  For the tolerance $T_4 = 4.0\\,\\text{\\AA}$:\n    We count the number of neighbors with $\\Delta_{ij} \\leq 4.0$. These are $j=1$ ($\\Delta_{i1}=0.2$), $j=2$ ($\\Delta_{i2}=0.8$), $j=3$ ($\\Delta_{i3}=3.9$), $j=5$ ($\\Delta_{i5}=1.8$), and $j=7$ ($\\Delta_{i7}=0.4$).\n    There are $5$ such neighbors. The fraction is $f_4 = \\frac{5}{6}$.\n\nFinally, the lDDT score is the average of these four fractions:\n$$ \\text{lDDT} = \\frac{f_1 + f_2 + f_3 + f_4}{4} $$\nSubstituting the computed values:\n$$ \\text{lDDT} = \\frac{1}{4} \\left( \\frac{1}{3} + \\frac{1}{2} + \\frac{2}{3} + \\frac{5}{6} \\right) $$\nTo sum the fractions, we use a common denominator of $6$:\n$$ \\text{lDDT} = \\frac{1}{4} \\left( \\frac{2}{6} + \\frac{3}{6} + \\frac{4}{6} + \\frac{5}{6} \\right) = \\frac{1}{4} \\left( \\frac{2+3+4+5}{6} \\right) = \\frac{1}{4} \\left( \\frac{14}{6} \\right) $$\nSimplifying the expression:\n$$ \\text{lDDT} = \\frac{14}{24} = \\frac{7}{12} $$\nThe final lDDT score is $\\frac{7}{12}$.",
            "answer": "$$\\boxed{\\frac{7}{12}}$$"
        }
    ]
}