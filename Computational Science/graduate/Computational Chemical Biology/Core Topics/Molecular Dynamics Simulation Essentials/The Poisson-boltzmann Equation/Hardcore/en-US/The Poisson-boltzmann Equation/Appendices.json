{
    "hands_on_practices": [
        {
            "introduction": "The Debye length, $\\lambda_D$, is the cornerstone of Poisson-Boltzmann theory, representing the characteristic distance over which electrostatic interactions are effectively screened by mobile ions in an electrolyte. This fundamental exercise provides direct practice in calculating $\\lambda_D$ for a realistic, mixed-salt buffer, engaging with how ionic strength and, critically, ion valence determine the screening environment around a biomolecule. By working through this calculation , you will gain a tangible understanding of why multivalent ions like $\\text{Ca}^{2+}$ or $\\text{Mg}^{2+}$ have such a disproportionately strong effect on electrostatic screening.",
            "id": "3866634",
            "problem": "An aqueous buffer used for biomolecular electrostatics contains sodium chloride and calcium chloride, fully dissociated and ideal, at temperature $T = 298\\,\\text{K}$ in liquid water treated as a uniform dielectric continuum. The composition is $0.10\\,\\text{M}$ sodium chloride $(\\text{NaCl})$ and $0.05\\,\\text{M}$ calcium chloride $(\\text{CaCl}_2)$. Assume point-like ions, bulk electroneutrality, and the validity of the linear response regime for small electrostatic potentials. Starting only from the Poisson equation coupled to the Boltzmann distribution for mobile ions, and invoking the linearization appropriate for small potentials, derive the screening relation that identifies the Debye screening length for a multicomponent electrolyte. Then evaluate the Debye length for this buffer.\n\nUse water’s relative permittivity $\\varepsilon_{r} = 78.37$ at $T = 298\\,\\text{K}$, vacuum permittivity $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\text{F m}^{-1}$, the elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$, the Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J K}^{-1}$, and Avogadro’s number $N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$. Treat molar concentrations $c_{i}$ in $\\text{mol L}^{-1}$ and convert to number densities via $n_{i} = N_{A} \\times 1000 \\times c_{i}$ in $\\text{m}^{-3}$.\n\nExpress the final numerical value of the Debye length in nanometers, rounded to three significant figures. In your working, briefly explain how the presence of divalent calcium modifies the screening length relative to a solution containing only monovalent salt at otherwise comparable conditions. The requested final answer is the single numerical value of the Debye length in nanometers.",
            "solution": "The problem asks for the derivation of the Debye screening length for a multicomponent electrolyte and its subsequent calculation for a specific aqueous buffer. The derivation begins with the fundamental equations governing electrostatics in an ionic medium.\n\nThe electrostatic potential $\\phi(\\mathbf{r})$ at a position $\\mathbf{r}$ in a continuous medium with uniform permittivity $\\varepsilon$ is related to the local charge density $\\rho(\\mathbf{r})$ by the Poisson equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho(\\mathbf{r})}{\\varepsilon} $$\nThe total permittivity of the medium is $\\varepsilon = \\varepsilon_r \\varepsilon_0$, where $\\varepsilon_r$ is the relative permittivity of the solvent (water) and $\\varepsilon_0$ is the vacuum permittivity. The charge density $\\rho(\\mathbf{r})$ arises from the distribution of mobile ions in the electrolyte. For a system with multiple ion species, this is given by the sum over all species $i$:\n$$ \\rho(\\mathbf{r}) = \\sum_{i} q_i n_i(\\mathbf{r}) $$\nwhere $q_i$ is the charge of an ion of species $i$ and $n_i(\\mathbf{r})$ is its local number density.\n\nUnder conditions of thermal equilibrium, the local number density of each ion species follows the Boltzmann distribution:\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{W_i(\\mathbf{r})}{k_B T}\\right) $$\nHere, $n_i^0$ is the bulk number density of species $i$ (far from any local charge source), $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. The potential energy of an ion of species $i$ at position $\\mathbf{r}$ is $W_i(\\mathbf{r}) = q_i \\phi(\\mathbf{r})$. Substituting this into the distribution gives:\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\nCombining the Poisson equation with the Boltzmann distribution for the charge density yields the Poisson-Boltzmann equation (PBE):\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\exp\\left(-\\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\nThe problem specifies that we are in the linear response regime, where the electrostatic potential is small, meaning the electrostatic energy is much smaller than the thermal energy: $|q_i \\phi(\\mathbf{r})| \\ll k_B T$. This allows for the linearization of the exponential term using a Taylor series expansion, $\\exp(-x) \\approx 1 - x$ for small $x$:\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\left(1 - \\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\nDistributing the terms in the summation gives:\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\left( \\sum_{i} q_i n_i^0 - \\frac{\\phi(\\mathbf{r})}{k_B T} \\sum_{i} q_i^2 n_i^0 \\right) $$\nThe first term in the parenthesis, $\\sum_i q_i n_i^0$, represents the net charge density in the bulk solution. A fundamental property of a bulk electrolyte is overall electroneutrality, so this term is zero:\n$$ \\sum_{i} q_i n_i^0 = 0 $$\nThe linearized PBE thus simplifies to the Debye-Hückel equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) = \\left( \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 \\right) \\phi(\\mathbf{r}) $$\nThis equation is of the form $\\nabla^2 \\phi(\\mathbf{r}) = \\kappa^2 \\phi(\\mathbf{r})$, where $\\kappa$ is the inverse Debye screening length. By comparing the two forms, we identify the screening parameter $\\kappa^2$ as:\n$$ \\kappa^2 = \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 $$\nThe Debye screening length, $\\lambda_D$, is defined as $\\lambda_D = 1/\\kappa$. Therefore, the screening relation for a multicomponent electrolyte is:\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{\\sum_{i} n_i^0 q_i^2}} $$\nThe term $\\sum_i n_i^0 q_i^2$ quantifies the screening capacity of the ionic solution. The presence of the charge squared, $q_i^2$, in this sum is crucial. It indicates that multivalent ions contribute disproportionately more to screening than monovalent ions. For instance, a divalent ion (charge $2e$) contributes $(2e)^2 = 4e^2$ to the sum, four times more than a monovalent ion (charge $e$) of the same concentration, which contributes $e^2$. The presence of divalent calcium in the specified buffer will therefore significantly increase the screening effect (i.e., decrease the Debye length) compared to a solution containing only monovalent salts at a similar molar concentration.\n\nNow we evaluate $\\lambda_D$ for the given buffer. The ion species are sodium ($\\text{Na}^{+}$), calcium ($\\text{Ca}^{2+}$), and chloride ($\\text{Cl}^{-}$). Their charges are $q_{\\text{Na}^+} = +e$, $q_{\\text{Ca}^{2+}} = +2e$, and $q_{\\text{Cl}^-} = -e$, where $e$ is the elementary charge.\nThe molar concentrations ($c_i$) are given:\n$c_{\\text{NaCl}} = 0.10\\,\\text{M}$\n$c_{\\text{CaCl}_2} = 0.05\\,\\text{M}$\nAssuming full dissociation, the concentrations of the individual ions are:\n$c_{\\text{Na}^{+}} = 0.10\\,\\text{M}$\n$c_{\\text{Ca}^{2+}} = 0.05\\,\\text{M}$\n$c_{\\text{Cl}^{-}} = c_{\\text{from NaCl}} + c_{\\text{from CaCl}_2} = 0.10\\,\\text{M} + 2 \\times 0.05\\,\\text{M} = 0.20\\,\\text{M}$\n\nThe sum $\\sum_i n_i^0 q_i^2$ can be expressed in terms of molar concentrations. Since $n_i^0 = c_i N_A \\times 1000$ (for $c_i$ in $\\text{mol/L}$ and $n_i^0$ in $\\text{m}^{-3}$) and $q_i = z_i e$ (where $z_i$ is the valence), the sum becomes:\n$$ \\sum_{i} n_i^0 q_i^2 = \\sum_{i} (c_i N_A \\times 1000) (z_i e)^2 = e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2 $$\nLet's calculate the term $\\sum_i c_i z_i^2$:\n$$ \\sum_{i} c_i z_i^2 = c_{\\text{Na}^{+}} (z_{\\text{Na}^{+}})^2 + c_{\\text{Ca}^{2+}} (z_{\\text{Ca}^{2+}})^2 + c_{\\text{Cl}^{-}} (z_{\\text{Cl}^{-}})^2 $$\n$$ \\sum_{i} c_i z_i^2 = (0.10)(+1)^2 + (0.05)(+2)^2 + (0.20)(-1)^2 $$\n$$ \\sum_{i} c_i z_i^2 = 0.10 \\times 1 + 0.05 \\times 4 + 0.20 \\times 1 = 0.10 + 0.20 + 0.20 = 0.50\\,\\text{mol L}^{-1} $$\nNow, we can write the expression for the Debye length as:\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon_r \\varepsilon_0 k_B T}{e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2}} $$\nWe substitute the given physical constants and calculated values:\n$T = 298\\,\\text{K}$\n$\\varepsilon_r = 78.37$\n$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\text{F m}^{-1}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\text{J K}^{-1}$\n$e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n$N_A = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$\n$\\sum_i c_i z_i^2 = 0.50\\,\\text{mol L}^{-1}$\n\nNumerator: $\\varepsilon_r \\varepsilon_0 k_B T$\n$ = (78.37)(8.8541878128 \\times 10^{-12}\\,\\text{F m}^{-1})(1.380649 \\times 10^{-23}\\,\\text{J K}^{-1})(298\\,\\text{K}) $\n$ \\approx 2.85483 \\times 10^{-30}\\,\\text{F J m}^{-1} $\n\nDenominator: $e^2 N_A \\times 1000 \\sum_i c_i z_i^2$\n$ = (1.602176634 \\times 10^{-19}\\,\\text{C})^2 (6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}) (1000\\,\\text{L m}^{-3}) (0.50\\,\\text{mol L}^{-1}) $\n$ \\approx 7.72836 \\times 10^{-12}\\,\\text{C}^2 \\text{m}^{-3} $\nNote that the units of the numerator, $\\text{F J m}^{-1}$, are equivalent to $\\text{C}^2 \\text{m}^{-1}$, since $J = C \\cdot V$ and $F = C/V$, so $F \\cdot J = C^2$.\n\nNow, we calculate $\\lambda_D^2$:\n$$ \\lambda_D^2 = \\frac{2.85483 \\times 10^{-30}\\,\\text{C}^2 \\text{m}^{-1}}{7.72836 \\times 10^{-12}\\,\\text{C}^2 \\text{m}^{-3}} \\approx 3.6939 \\times 10^{-19}\\,\\text{m}^2 $$\nTaking the square root to find $\\lambda_D$:\n$$ \\lambda_D = \\sqrt{3.6939 \\times 10^{-19}\\,\\text{m}^2} \\approx 6.0778 \\times 10^{-10}\\,\\text{m} $$\nThe problem requests the answer in nanometers. Since $1\\,\\text{nm} = 10^{-9}\\,\\text{m}$:\n$$ \\lambda_D \\approx 0.60778\\,\\text{nm} $$\nRounding to three significant figures, we get:\n$$ \\lambda_D \\approx 0.608\\,\\text{nm} $$\nThis value represents the characteristic length scale over which electrostatic interactions are screened by the mobile ions in the given buffer.",
            "answer": "$$\n\\boxed{0.608}\n$$"
        },
        {
            "introduction": "While powerful, the full nonlinear Poisson-Boltzmann equation can be computationally demanding, leading to the widespread use of its linearized approximation. However, this simplification is only valid under specific conditions of low electrostatic potential. This practice  directly confronts the limits of this crucial approximation by comparing solutions from both the nonlinear and linear PBE models for a charged planar surface, a classic proxy for biomolecular membranes. By quantifying the error, you will develop a clear intuition for when the simpler linear model is sufficient and when the full nonlinear treatment is non-negotiable, particularly near highly charged surfaces.",
            "id": "3866522",
            "problem": "Consider a symmetric monovalent electrolyte adjacent to a uniformly charged, infinite planar surface. The solvent is treated as a continuum dielectric with relative permittivity $\\epsilon$, absolute permittivity $\\epsilon\\epsilon_0$, and temperature $T$. Let the surface at position $x=0$ carry a uniform free surface charge density $\\sigma$, and the electrolyte occupy the half-space $x>0$ with bulk number concentration $n_0$ of cations and $n_0$ of anions (so that the bulk salt concentration is $c_0=n_0/N_A$ in $\\text{mol m}^{-3}$). Assume equilibrium and no fluid flow.\n\nStarting from first principles valid in computational chemical biology and electrostatics, specifically:\n- Gauss’s law in differential form (Poisson’s equation) $\\nabla\\cdot(\\epsilon\\epsilon_0\\nabla\\psi)=-\\rho$,\n- Boltzmann distributions $c_\\pm(x)=n_0\\exp\\left(\\mp \\frac{e\\psi(x)}{k_B T}\\right)$ for monovalent ions in an electrostatic potential $\\psi(x)$,\n- The definition of the Debye screening parameter under small-potential linearization, and\n- Appropriate boundary conditions $\\psi(\\infty)=0$, $-\\epsilon\\epsilon_0\\psi'(0)=\\sigma$,\n\nderive, from these bases and without invoking any shortcut formulas, the relationship between surface charge density $\\sigma$ and surface potential $\\psi_0=\\psi(0)$ for both:\n1. The full nonlinear Poisson–Boltzmann (PB) description, and\n2. The linearized PB (Debye–Hückel) description in the small-potential regime.\n\nThen, implement a program that:\n- Uses the derived relationships to compute the surface potential predicted by the nonlinear PB, $\\psi_0^{\\mathrm{NL}}$, and by the linearized PB, $\\psi_0^{\\mathrm{LIN}}$, for each provided test case.\n- Quantifies the absolute relative error in the linear prediction with respect to the nonlinear prediction as the decimal fraction\n$$\\text{err}=\\frac{|\\psi_0^{\\mathrm{LIN}}-\\psi_0^{\\mathrm{NL}}|}{|\\psi_0^{\\mathrm{NL}}|}.$$\n- Expresses all potentials in $\\mathrm{V}$ and the error as a unitless decimal fraction.\n\nUse the following physical constants precisely:\n- Elementary charge $e=1.602176634\\times 10^{-19}\\,\\text{C}$,\n- Boltzmann constant $k_B=1.380649\\times 10^{-23}\\,\\text{J K}^{-1}$,\n- Vacuum permittivity $\\epsilon_0=8.8541878128\\times 10^{-12}\\,\\text{F m}^{-1}$,\n- Avogadro constant $N_A=6.02214076\\times 10^{23}\\,\\text{mol}^{-1}$,\n- Temperature $T=298\\,\\text{K}$.\n\nYour program must treat the given bulk salt concentrations $c_0$ in $\\text{mol m}^{-3}$ by converting them to number density $n_0=N_A c_0$ in $\\text{m}^{-3}$. For the linearized PB, use the planar solution consistent with the boundary condition to relate $\\sigma$ and $\\psi_0$ via the Debye screening parameter $\\kappa$, where $\\kappa^2=\\frac{2 e^2 n_0}{\\epsilon\\epsilon_0 k_B T}$ for a symmetric monovalent electrolyte.\n\nTest suite. For coverage across regimes, use the following parameter sets $(\\sigma, c_0, \\epsilon)$, with $\\sigma$ in $\\text{C m}^{-2}$, $c_0$ in $\\text{mol m}^{-3}$, and $\\epsilon$ dimensionless:\n- Case A (typical aqueous, moderate charge, moderate salt): $\\sigma=-2.0\\times 10^{-2},\\;c_0=100,\\;\\epsilon=78.5$.\n- Case B (small charge, low salt): $\\sigma=-1.0\\times 10^{-4},\\;c_0=1,\\;\\epsilon=78.5$.\n- Case C (large charge, reduced permittivity, moderate salt): $\\sigma=-2.0\\times 10^{-1},\\;c_0=10,\\;\\epsilon=40$.\n- Case D (moderate charge, high salt): $\\sigma=-1.0\\times 10^{-2},\\;c_0=1000,\\;\\epsilon=78.5$.\n- Case E (zero charge boundary case): $\\sigma=0.0,\\;c_0=100,\\;\\epsilon=78.5$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list ordered as $[\\psi_0^{\\mathrm{NL}},\\ \\psi_0^{\\mathrm{LIN}},\\ \\mathrm{err}]$ for the corresponding test case, for example $[[a_1,b_1,e_1],[a_2,b_2,e_2],\\dots]$. All $\\psi_0$ values must be in $\\mathrm{V}$ and all errors must be decimal fractions.",
            "solution": "The user-provided problem is evaluated as valid according to the specified criteria. It is scientifically grounded in the principles of electrostatics and statistical mechanics, well-posed with sufficient information for a unique solution, and stated in objective, formal language. The problem requires the derivation and application of the Poisson-Boltzmann (PB) model, which is a standard and central topic in computational chemical biology.\n\nThe derivation and solution proceed as follows.\n\nThe system consists of an infinite planar surface with uniform surface charge density $\\sigma$ at $x=0$, and a symmetric monovalent electrolyte in the half-space $x0$. The solvent is a continuum dielectric with relative permittivity $\\epsilon$ at temperature $T$. The electrolyte has a bulk ion number concentration of $n_0$.\n\nThe fundamental relationship between the electrostatic potential $\\psi$ and the charge density $\\rho$ is given by Poisson's equation. For a one-dimensional system where the potential $\\psi$ varies only with the distance $x$ from the surface, this is:\n$$\n\\frac{d}{dx}\\left(\\epsilon\\epsilon_0 \\frac{d\\psi}{dx}\\right) = -\\rho(x)\n$$\nAssuming a uniform dielectric, $\\epsilon$ is constant, and the equation simplifies to:\n$$\n\\frac{d^2\\psi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon\\epsilon_0}\n$$\nThe charge density $\\rho(x)$ arises from the mobile ions in the electrolyte. For a symmetric $1:1$ electrolyte, the number concentrations of cations, $n_+(x)$, and anions, $n_-(x)$, are given by the Boltzmann distribution:\n$$\nn_+(x) = n_0 \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_0 \\exp\\left(+\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nwhere $e$ is the elementary charge, $k_B$ is the Boltzmann constant, and $n_0$ is the bulk number concentration of each ionic species. The net charge density is the sum of the charge contributions from cations (charge $+e$) and anions (charge $-e$):\n$$\n\\rho(x) = e n_+(x) - e n_-(x) = e n_0 \\left[ \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right) - \\exp\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\right]\n$$\nUsing the identity $2\\sinh(y) = e^y - e^{-y}$, the charge density can be expressed as:\n$$\n\\rho(x) = -2en_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nSubstituting this into Poisson's equation gives the full one-dimensional nonlinear Poisson-Boltzmann (PB) equation:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nTo solve this equation for the relationship between surface charge $\\sigma$ and surface potential $\\psi_0 = \\psi(0)$, we use an integration technique. Multiplying both sides by $2\\frac{d\\psi}{dx}$:\n$$\n2\\frac{d\\psi}{dx}\\frac{d^2\\psi}{dx^2} = \\frac{4en_0}{\\epsilon\\epsilon_0} \\frac{d\\psi}{dx} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nThe left side is the derivative of $(\\frac{d\\psi}{dx})^2$ with respect to $x$. The right side can also be expressed as a derivative. We can write:\n$$\n\\frac{d}{dx}\\left(\\left(\\frac{d\\psi}{dx}\\right)^2\\right) = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\frac{k_B T}{e}\\right) \\frac{d}{dx}\\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\nIntegrating from a position $x$ to infinity, and applying the boundary conditions that the potential and its gradient vanish far from the surface, i.e., $\\psi(\\infty)=0$ and $(\\frac{d\\psi}{dx})_{x\\to\\infty}=0$:\n$$\n\\int_x^\\infty \\frac{d}{dx'}\\left(\\left(\\frac{d\\psi}{dx'}\\right)^2\\right) dx' = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\int_x^\\infty \\frac{d}{dx'}\\left(\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right) dx'\n$$\n$$\n\\left[\\left(\\frac{d\\psi}{dx'}\\right)^2\\right]_x^\\infty = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left[\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right]_x^\\infty\n$$\n$$\n0 - \\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh(0) - \\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right) - 1\\right)\n$$\nUsing the identity $\\cosh(y) - 1 = 2\\sinh^2(y/2)$, we obtain:\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{8n_0 k_B T}{\\epsilon\\epsilon_0} \\sinh^2\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\nTaking the square root gives the electric field:\n$$\n\\frac{d\\psi}{dx} = -\\text{sgn}(\\psi_0) \\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\left|\\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\\right|\n$$\nA simpler way to handle the sign is to recognize that for $\\psi_00$, $\\psi(x)$ decreases, so $\\psi'  0$. For $\\psi_00$, $\\psi(x)$ increases, so $\\psi'  0$. And $\\sinh(y)$ has the same sign as $y$. This means the product $\\psi' \\cdot \\sinh(e\\psi/2k_BT)$ is always non-positive. We thus take the negative root:\n$$\n\\frac{d\\psi}{dx} = -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\nThe boundary condition at the charged surface is derived from Gauss's law for a planar surface: $-\\epsilon\\epsilon_0 \\left(\\frac{d\\psi}{dx}\\right)_{x=0} = \\sigma$. Substituting our expression for the derivative at $x=0$:\n$$\n-\\epsilon\\epsilon_0 \\left( -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right) \\right) = \\sigma\n$$\nThis simplifies to the Grahame equation, which relates the surface charge density $\\sigma$ to the surface potential $\\psi_0$:\n$$\n\\sigma = \\sqrt{8n_0 k_B T \\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right)\n$$\nTo find the surface potential $\\psi_0^{\\mathrm{NL}}$ for the full nonlinear PB model, we solve for $\\psi_0$:\n$$\n\\sinh\\left(\\frac{e\\psi_0^{\\mathrm{NL}}}{2k_B T}\\right) = \\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\n$$\n$$\n\\psi_0^{\\mathrm{NL}} = \\frac{2k_B T}{e} \\text{arsinh}\\left(\\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\\right)\n$$\n\nFor the linearized PB (Debye-Hückel) description, we assume the potential is small, i.e., $|e\\psi(x)| \\ll k_B T$. This allows the linearization $\\sinh(y) \\approx y$. The PB equation becomes:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\left(\\frac{e\\psi(x)}{k_B T}\\right) = \\left(\\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\\right) \\psi(x)\n$$\nThis is the linearized Poisson-Boltzmann equation. The term in parenthesis is the square of the Debye screening parameter, $\\kappa$:\n$$\n\\kappa^2 = \\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\n$$\nThe equation is now $\\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi$. The general solution is $\\psi(x) = A e^{-\\kappa x} + B e^{\\kappa x}$. Applying the boundary condition $\\psi(\\infty)=0$ requires $B=0$. The solution is $\\psi(x) = A e^{-\\kappa x}$. At the surface, $\\psi(0) = \\psi_0 = A$, so $\\psi(x) = \\psi_0 e^{-\\kappa x}$.\n\nTo find the relationship between $\\sigma$ and $\\psi_0$, we use the second boundary condition, $-\\epsilon\\epsilon_0 \\psi'(0) = \\sigma$. The derivative is $\\psi'(x) = -\\kappa\\psi_0 e^{-\\kappa x}$, so $\\psi'(0) = -\\kappa\\psi_0$.\n$$\n-\\epsilon\\epsilon_0(-\\kappa \\psi_0) = \\sigma\n$$\n$$\n\\epsilon\\epsilon_0 \\kappa \\psi_0 = \\sigma\n$$\nSolving for the surface potential $\\psi_0^{\\mathrm{LIN}}$ in the linearized approximation yields:\n$$\n\\psi_0^{\\mathrm{LIN}} = \\frac{\\sigma}{\\epsilon\\epsilon_0 \\kappa}\n$$\nThe program will compute $\\psi_0^{\\mathrm{NL}}$ and $\\psi_0^{\\mathrm{LIN}}$ using these derived expressions and then calculate the relative error $\\mathrm{err} = |\\psi_0^{\\mathrm{LIN}} - \\psi_0^{\\mathrm{NL}}| / |\\psi_0^{\\mathrm{NL}}|$. For the special case $\\sigma=0$, both $\\psi_0^{\\mathrm{NL}}$ and $\\psi_0^{\\mathrm{LIN}}$ are $0$, and the error is defined as $0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates surface potentials for a charged planar surface\n    in an electrolyte using both nonlinear and linearized Poisson-Boltzmann theory.\n    \"\"\"\n\n    # Define physical constants\n    E = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23     # Boltzmann constant in J/K\n    EPS_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    NA = 6.02214076e23   # Avogadro constant in mol^-1\n    T = 298.0              # Temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (sigma, c0, epsilon)\n    # sigma: surface charge density in C/m^2\n    # c0: bulk salt concentration in mol/m^3\n    # epsilon: relative permittivity (dimensionless)\n    test_cases = [\n        (-2.0e-2, 100.0, 78.5),   # Case A\n        (-1.0e-4, 1.0, 78.5),     # Case B\n        (-2.0e-1, 10.0, 40.0),    # Case C\n        (-1.0e-2, 1000.0, 78.5),  # Case D\n        (0.0, 100.0, 78.5),       # Case E\n    ]\n\n    results = []\n    for sigma, c0, epsilon in test_cases:\n        # Convert bulk concentration c0 (mol/m^3) to number density n0 (m^-3)\n        n0 = c0 * NA\n        \n        # Handle the special case where surface charge is zero\n        if sigma == 0.0:\n            psi0_nl = 0.0\n            psi0_lin = 0.0\n            err = 0.0\n            results.append([psi0_nl, psi0_lin, err])\n            continue\n            \n        # --- Nonlinear Poisson-Boltzmann (NL) calculation ---\n        # Formula: psi0_nl = (2 * kB * T / e) * arsinh(sigma / sqrt(8 * n0 * kB * T * epsilon * epsilon0))\n        denom_nl = np.sqrt(8 * n0 * KB * T * epsilon * EPS_0)\n        arg_arsinh = sigma / denom_nl\n        psi0_nl = (2 * KB * T / E) * np.arcsinh(arg_arsinh)\n\n        # --- Linearized Poisson-Boltzmann (LIN) calculation ---\n        # Formula: psi0_lin = sigma / (epsilon * epsilon0 * kappa)\n        # where kappa = sqrt(2 * e^2 * n0 / (epsilon * epsilon0 * kB * T))\n        kappa_sq = (2 * E**2 * n0) / (epsilon * EPS_0 * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        psi0_lin = sigma / (epsilon * EPS_0 * kappa)\n\n        # --- Error Calculation ---\n        # Formula: err = |psi0_lin - psi0_nl| / |psi0_nl|\n        # The case psi0_nl = 0 (i.e., sigma = 0) is handled above.\n        err = np.abs(psi0_lin - psi0_nl) / np.abs(psi0_nl)\n\n        results.append([psi0_nl, psi0_lin, err])\n\n    # Final print statement in the exact required format.\n    # Format each inner list to a string '[v1,v2,v3]' and join them.\n    formatted_results = [\n        f\"[{','.join(f'{val:.8e}' for val in res)}]\" for res in results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Translating the continuous mathematics of the Poisson-Boltzmann equation into a solvable computational problem requires discretizing the system onto a grid. The choice of grid spacing, $h$, is a critical first step that profoundly impacts both the accuracy of the result and the computational cost. This exercise  guides you through the practical reasoning required to select an appropriate grid spacing for a protein simulation, balancing the need to resolve physical phenomena like the Debye length with the need to accurately represent the molecule's geometric features. It illuminates the essential trade-offs that bridge the gap between abstract theory and the practical art of computational modeling.",
            "id": "3866598",
            "problem": "A globular protein with hydrodynamic diameter $5$ nanometers is to be modeled in an implicit solvent using the Poisson–Boltzmann equation (PBE). The solvent is aqueous and contains a symmetric monovalent electrolyte at bulk concentration $0.15$ moles per liter at temperature $298$ kelvin. You will design a uniform Cartesian finite-difference grid for a three-dimensional domain that encloses the protein and a solvent buffer sufficient to capture electrostatic screening. Your task is to determine a single grid spacing that simultaneously resolves (i) the electrostatic screening length (Debye length) and (ii) the smallest relevant molecular surface features. Then, justify the trade-offs between resolution and computational cost implied by your choice.\n\nStart from fundamental electrostatics and statistical mechanics to derive the characteristic screening length in a dilute symmetric electrolyte by linearizing the Poisson–Boltzmann equation around zero potential. Treat the dielectric response as homogeneous with the relative permittivity of water. Proceed as follows:\n\n1. From the linearized Poisson–Boltzmann equation for a symmetric $1:1$ electrolyte, derive the screening parameter $\\kappa$ and the corresponding Debye length $\\lambda_{D}$ in terms of the ionic strength $I$, temperature $T$, Boltzmann constant $k_{B}$, elementary charge $e$, Avogadro’s number $N_{A}$, vacuum permittivity $\\varepsilon_{0}$, and the relative permittivity of water $\\varepsilon_{r}$.\n\n2. Evaluate the Debye length numerically for the given conditions using:\n   - $T = 298$ kelvin,\n   - $I = 0.15$ moles per liter,\n   - $\\varepsilon_{r} = 78.5$ (liquid water at $298$ kelvin),\n   - $k_{B} = 1.380\\,649 \\times 10^{-23}$ joules per kelvin,\n   - $e = 1.602\\,176\\,634 \\times 10^{-19}$ coulombs,\n   - $N_{A} = 6.022\\,140\\,76 \\times 10^{23}$ per mole,\n   - $\\varepsilon_{0} = 8.854\\,187\\,817 \\times 10^{-12}$ farads per meter,\n   and note that 1 mole per liter equals $10^3$ moles per cubic meter.\n\n3. Impose conservative resolution criteria:\n   - To resolve screening accurately with a second-order finite-difference scheme, require at least $10$ grid points per Debye length; that is, the grid spacing $h$ must satisfy $h \\leq \\lambda_{D}/10$.\n   - To resolve the sharpest molecular geometric features on the solvent-excluded surface, take the smallest curvature scale to be the water probe radius $0.14$ nanometers and require at least $4$ grid points across this radius; that is, $h \\leq 0.14/4$ nanometers.\n\nChoose a single grid spacing $h$ that satisfies both criteria. Round your final grid spacing to three significant figures and express it in nanometers.\n\nIn your reasoning, justify how these criteria emerge from the structure of the linearized Poisson–Boltzmann equation and second-order finite-difference truncation error, and briefly discuss the trade-off between reducing $h$ to improve accuracy versus the growth of the three-dimensional grid size and computational cost. Your final answer must be the single chosen $h$.",
            "solution": "The problem requires the determination of a suitable grid spacing, $h$, for a finite-difference solution of the Poisson-Boltzmann equation (PBE) for a globular protein in an electrolyte solution. The choice of $h$ must satisfy constraints related to both the physical screening length of the electrolyte and the geometric features of the protein surface.\n\nPart 1: Derivation of the Debye Length\n\nThe PBE describes the electrostatic potential, $\\phi(\\mathbf{r})$, in a medium containing fixed charges and mobile ions. In the bulk solvent region, far from the protein's fixed charges, the PBE is given by:\n$$\n\\nabla \\cdot (\\varepsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r})) = -\\rho_{mobile}(\\mathbf{r})\n$$\nwhere $\\varepsilon(\\mathbf{r})$ is the dielectric permittivity and $\\rho_{mobile}$ is the charge density of the mobile ions. For a homogeneous dielectric medium, $\\varepsilon(\\mathbf{r}) = \\varepsilon = \\varepsilon_0 \\varepsilon_r$, where $\\varepsilon_0$ is the vacuum permittivity and $\\varepsilon_r$ is the relative permittivity. The mobile charge density is given by a Boltzmann distribution for each ion species $i$:\n$$\n\\rho_{mobile}(\\mathbf{r}) = \\sum_i c_i^0 z_i e \\exp\\left(-\\frac{z_i e \\phi(\\mathbf{r})}{k_B T}\\right)\n$$\nHere, $c_i^0$ is the bulk number concentration of ion species $i$, $z_i$ is its valence, $e$ is the elementary charge, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nThe problem specifies a symmetric $1:1$ electrolyte, meaning we have two ion species: cations with $z_1 = +1$ and anions with $z_2 = -1$. Their bulk concentrations are equal, $c_1^0 = c_2^0 = c_0$. The PBE becomes:\n$$\n\\varepsilon \\nabla^2 \\phi = - \\left( c_0 e \\exp\\left(-\\frac{e \\phi}{k_B T}\\right) - c_0 e \\exp\\left(+\\frac{e \\phi}{k_B T}\\right) \\right)\n$$\nUsing the identity $\\sinh(x) = (\\exp(x) - \\exp(-x))/2$, we can rewrite this as:\n$$\n\\nabla^2 \\phi = \\frac{2 c_0 e}{\\varepsilon} \\sinh\\left(\\frac{e \\phi}{k_B T}\\right)\n$$\nFor small potentials ($|e\\phi| \\ll k_B T$), we can linearize the hyperbolic sine function using its first-order Taylor expansion, $\\sinh(x) \\approx x$. This yields the linearized Poisson-Boltzmann equation (LPBE):\n$$\n\\nabla^2 \\phi \\approx \\frac{2 c_0 e}{\\varepsilon} \\left(\\frac{e \\phi}{k_B T}\\right) = \\left(\\frac{2 c_0 e^2}{\\varepsilon k_B T}\\right) \\phi\n$$\nThis is a Helmholtz-type equation, $\\nabla^2 \\phi = \\kappa^2 \\phi$, where the screening parameter $\\kappa$ is defined as:\n$$\n\\kappa^2 = \\frac{2 c_0 e^2}{\\varepsilon k_B T} = \\frac{2 c_0 e^2}{\\varepsilon_0 \\varepsilon_r k_B T}\n$$\nThe problem provides the ionic strength, $I$, in molar units (moles per liter). The ionic strength is defined as $I = \\frac{1}{2} \\sum_i C_i z_i^2$, where $C_i$ are the molar concentrations. For a $1:1$ electrolyte with molar concentration $C$, we have $C_1 = C_2 = C$, so $I = \\frac{1}{2}(C(+1)^2 + C(-1)^2) = C$. Thus, the molar concentration of the salt is equal to the ionic strength.\n\nTo use this in our expression for $\\kappa^2$, we must relate the number concentration $c_0$ (in units of $\\text{m}^{-3}$) to the ionic strength $I$ (in units of $\\text{mol/L}$).\n$$\nc_0\\ [\\text{m}^{-3}] = C\\ [\\text{mol/m}^3] \\times N_A\\ [\\text{mol}^{-1}] = I\\ [\\text{mol/L}] \\times 10^3\\ [\\text{L/m}^3] \\times N_A\\ [\\text{mol}^{-1}]\n$$\nSubstituting this into the expression for $\\kappa^2$:\n$$\n\\kappa^2 = \\frac{2 \\times (10^3 I N_A) e^2}{\\varepsilon_0 \\varepsilon_r k_B T}\n$$\nThe Debye length, $\\lambda_D$, is the characteristic length scale of electrostatic screening and is defined as the reciprocal of the screening parameter, $\\lambda_D = 1/\\kappa$. Therefore, the expression for the Debye length is:\n$$\n\\lambda_D = \\sqrt{\\frac{\\varepsilon_0 \\varepsilon_r k_B T}{2 \\times 10^3 N_A e^2 I}}\n$$\n\nPart 2: Numerical Evaluation of the Debye Length\n\nWe now evaluate $\\lambda_D$ using the provided constants and parameters. First, we convert the ionic strength into SI units of $\\text{mol/m}^3$:\n$I_{\\text{SI}} = 0.15 \\text{ mol/L} \\times 1000 \\text{ L/m}^3 = 150 \\text{ mol/m}^3$.\nFor a $1:1$ electrolyte, the concentration of each ionic species is $C_{ion} = I_{\\text{SI}} = 150 \\text{ mol/m}^3$.\n\nThe numerator of the expression for $\\lambda_D^2$ is $\\varepsilon_0 \\varepsilon_r k_B T$:\n$$\n\\varepsilon_0 \\varepsilon_r k_B T = (8.854187817 \\times 10^{-12} \\text{ F/m}) \\times 78.5 \\times (1.380649 \\times 10^{-23} \\text{ J/K}) \\times 298 \\text{ K} \\approx 2.8601 \\times 10^{-30} \\text{ J F/m}\n$$\nThe denominator is $2 N_A e^2 C_{ion} = 2 N_A e^2 I_{\\text{SI}}$ (using $I$ from the formula to mean molar concentration in SI, which is $I_{\\text{SI}}$), but the derived formula uses $I$ in mol/L, so we use $2 \\times 10^3 N_A e^2 I$:\n$$\n2 \\times 10^3 N_A e^2 I = 2 \\times 1000 \\times (6.02214076 \\times 10^{23} \\text{ mol}^{-1}) \\times (1.602176634 \\times 10^{-19} \\text{ C})^2 \\times 0.15 \\text{ mol/L} \\approx 4.6415 \\times 10^9 \\text{ C}^2\\text{m}^{-3}\\text{L/mol}\n$$\nLet's use the explicit SI concentration $I_{\\text{SI}}$ to avoid unit confusion. The formula for $\\kappa^2$ using SI units throughout is $\\kappa^2 = \\frac{2 N_A e^2 I_{\\text{SI}}}{\\varepsilon_0 \\varepsilon_r k_B T}$.\n$$\n\\kappa^2 = \\frac{2 \\times (6.02214076 \\times 10^{23}) \\times (1.602176634 \\times 10^{-19})^2 \\times 150}{ (8.854187817 \\times 10^{-12}) \\times 78.5 \\times (1.380649 \\times 10^{-23}) \\times 298 } \\approx 1.6228 \\times 10^{18} \\text{ m}^{-2}\n$$\nThe Debye length is then:\n$$\n\\lambda_D = \\frac{1}{\\kappa} = \\frac{1}{\\sqrt{1.6228 \\times 10^{18} \\text{ m}^{-2}}} \\approx 7.850 \\times 10^{-10} \\text{ m}\n$$\nConverting to nanometers:\n$$\n\\lambda_D \\approx 0.785 \\text{ nm}\n$$\n\nPart 3: Determination of the Grid Spacing $h$\n\nThe problem specifies two criteria that the grid spacing $h$ must satisfy.\n\nCriterion 1 (Electrostatic Resolution): To resolve the electrostatic screening, the grid must have at least $10$ points per Debye length.\n$$\nh \\leq \\frac{\\lambda_D}{10} = \\frac{0.785 \\text{ nm}}{10} = 0.0785 \\text{ nm}\n$$\n\nCriterion 2 (Geometric Resolution): To resolve the smallest molecular surface features, characterized by the water probe radius of $0.14$ nm, the grid must have at least $4$ points across this radius.\n$$\nh \\leq \\frac{0.14 \\text{ nm}}{4} = 0.035 \\text{ nm}\n$$\n\nTo satisfy both criteria simultaneously, the grid spacing $h$ must be less than or equal to the minimum of the two upper bounds:\n$$\nh \\leq \\min(0.0785 \\text{ nm}, 0.035 \\text{ nm}) = 0.035 \\text{ nm}\n$$\nThe problem asks for a single choice for $h$. The most computationally efficient (i.e., largest) value of $h$ that satisfies the constraints is the upper bound itself. We choose $h = 0.035$ nm. Rounding to three significant figures gives $h = 0.0350$ nm.\n\nJustification and Trade-Offs\n\nThe resolution criteria are heuristics designed to control numerical errors.\nThe truncation error of a second-order finite-difference scheme for the Laplacian operator scales as $O(h^2)$. For the LPBE, $\\nabla^2\\phi - \\kappa^2\\phi = 0$, the error term is proportional to $h^2$ times higher-order derivatives of $\\phi$. Since solutions decay like $\\exp(-\\kappa r)$, these derivatives introduce powers of $\\kappa=1/\\lambda_D$. The error thus scales with $(h/\\lambda_D)^2$. Requiring $h/\\lambda_D \\leq 1/10$ ensures this ratio is small, keeping the error in approximating the exponential decay manageable.\nThe geometric criterion addresses the staircase approximation of the smooth molecular surface on a Cartesian grid. If $h$ is comparable to or larger than the smallest radius of curvature on the surface (here, $0.14$ nm), the grid cannot accurately represent the shape of the surface, leading to significant errors in applying the boundary conditions for the PBE. Requiring several grid points (e.g., $4$) across this feature size ensures a reasonable representation of surface geometry.\n\nThe choice of $h$ represents a fundamental trade-off between accuracy and computational cost.\n- **Accuracy:** A smaller $h$ leads to lower discretization error and a better geometric representation, yielding a more accurate computed potential $\\phi$.\n- **Computational Cost:** The cost grows rapidly as $h$ decreases. For a cubic domain of side length $L$, the number of grid points is $N = (L/h)^3$.\n    - **Memory:** The memory required to store the grid potential and the matrix representation of the PBE operator scales as $O(N) = O(h^{-3})$.\n    - **CPU Time:** The time to solve the system of linear equations using iterative methods scales worse than linearly with $N$. A typical scaling is $O(N\\log N)$ or even $O(N^{4/3})$, which translates to a dependence of $O(h^{-3}\\log(h^{-1}))$ or $O(h^{-4})$.\nHalving the grid spacing ($h \\to h/2$) increases the number of grid points by a factor of $8$, and can increase the computation time by a factor of $16$ or more. Therefore, one must choose the largest $h$ that meets the minimum accuracy requirements dictated by the physics and geometry of the problem. In this case, the geometric constraint ($h \\leq 0.035 \\text{ nm}$) is more restrictive than the physical screening constraint ($h \\leq 0.0785 \\text{ nm}$), so the final choice is dictated by the need to resolve the molecular surface.\n\nThe chosen grid spacing is $h = 0.0350$ nm.",
            "answer": "$$\\boxed{0.0350}$$"
        }
    ]
}