{
    "hands_on_practices": [
        {
            "introduction": "德拜长度（$\\lambda_D$）是泊松-玻尔兹曼理论中的一个基石概念，它定义了移动离子屏蔽静电相互作用的特征尺度。第一个实践将超越简单的1:1电解质，进入一个更真实的混合离子环境，要求你推导并计算包含单价和二价离子的溶液的 $\\lambda_D$。通过这个计算 ，你将对多价离子如何不成比例地增强屏蔽效应获得定量的理解，这在生物系统中是一个至关重要的效应。",
            "id": "3866634",
            "problem": "一种用于生物分子静电学研究的水性缓冲液，在温度 $T = 298$ $\\mathrm{K}$ 时含有氯化钠和氯化钙，它们在被视为均匀介电连续体的液态水中完全解离且表现理想。其组分为 $0.10$ $\\mathrm{M}$ 的氯化钠（$\\mathrm{NaCl}$）和 $0.05$ $\\mathrm{M}$ 的氯化钙（$\\mathrm{CaCl}_{2}$）。假设离子为点状离子，体系满足宏观电中性，并且对于小静电势，线性响应机制成立。请仅从泊松方程与移动离子的玻尔兹曼分布耦合出发，并引用适用于小电势的线性化方法，推导确定多组分电解质德拜屏蔽长度的屏蔽关系。然后计算该缓冲液的德拜长度。\n\n使用水在 $T = 298$ $\\mathrm{K}$ 时的相对介电常数 $\\varepsilon_{r} = 78.37$，真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}$ $\\mathrm{F}\\,\\mathrm{m}^{-1}$，基本电荷 $e = 1.602176634 \\times 10^{-19}$ $\\mathrm{C}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}$ $\\mathrm{J}\\,\\mathrm{K}^{-1}$，以及阿伏伽德罗常数 $N_{A} = 6.02214076 \\times 10^{23}$ $\\mathrm{mol}^{-1}$。将摩尔浓度 $c_{i}$（单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$）通过 $n_{i} = N_{A} \\times 1000 \\times c_{i}$ 转换为数密度（单位为 $\\mathrm{m}^{-3}$）。\n\n将德拜长度的最终数值以纳米为单位表示，并四舍五入到三位有效数字。在您的计算过程中，简要解释在其他条件相当的情况下，与只含单价盐的溶液相比，二价钙离子的存在如何改变屏蔽长度。要求的最终答案是德拜长度的单个数值，以纳米为单位。",
            "solution": "该问题要求推导多组分电解质的德拜屏蔽长度，并随后为一种特定的水性缓冲液计算其值。推导从控制离子介质中静电学的基本方程开始。\n\n在具有均匀介电常数 $\\varepsilon$ 的连续介质中，位置 $\\mathbf{r}$ 处的静电势 $\\phi(\\mathbf{r})$ 通过泊松方程与局部电荷密度 $\\rho(\\mathbf{r})$ 相关联：\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho(\\mathbf{r})}{\\varepsilon} $$\n介质的总介电常数为 $\\varepsilon = \\varepsilon_r \\varepsilon_0$，其中 $\\varepsilon_r$ 是溶剂（水）的相对介电常数，$\\varepsilon_0$ 是真空介电常数。电荷密度 $\\rho(\\mathbf{r})$ 源于电解质中移动离子的分布。对于具有多种离子的体系，这由对所有离子种类 $i$ 的求和给出：\n$$ \\rho(\\mathbf{r}) = \\sum_{i} q_i n_i(\\mathbf{r}) $$\n其中 $q_i$ 是离子种类 $i$ 的电荷， $n_i(\\mathbf{r})$ 是其局部数密度。\n\n在热平衡条件下，每种离子的局部数密度遵循玻尔兹曼分布：\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{W_i(\\mathbf{r})}{k_B T}\\right) $$\n此处，$n_i^0$ 是离子种类 $i$ 的宏观数密度（远离任何局部电荷源），$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。一个种类 $i$ 的离子在位置 $\\mathbf{r}$ 的势能是 $W_i(\\mathbf{r}) = q_i \\phi(\\mathbf{r})$。将此代入分布函数中得到：\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\n将泊松方程与电荷密度的玻尔兹曼分布相结合，得到泊松-玻尔兹曼方程 (PBE)：\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\exp\\left(-\\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\n问题指明我们处于线性响应机制中，其中静电势很小，意味着静电能远小于热能：$|q_i \\phi(\\mathbf{r})| \\ll k_B T$。这允许使用泰勒级数展开对指数项进行线性化，对于小的 $x$ 有 $\\exp(-x) \\approx 1 - x$：\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\left(1 - \\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\n将求和中的各项展开，得到：\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\left( \\sum_{i} q_i n_i^0 - \\frac{\\phi(\\mathbf{r})}{k_B T} \\sum_{i} q_i^2 n_i^0 \\right) $$\n括号中的第一项 $\\sum_i q_i n_i^0$ 代表宏观溶液中的净电荷密度。宏观电解质的一个基本性质是整体电中性，因此该项为零：\n$$ \\sum_{i} q_i n_i^0 = 0 $$\n因此，线性化的PBE简化为德拜-休克尔方程：\n$$ \\nabla^2 \\phi(\\mathbf{r}) = \\left( \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 \\right) \\phi(\\mathbf{r}) $$\n这个方程的形式是 $\\nabla^2 \\phi(\\mathbf{r}) = \\kappa^2 \\phi(\\mathbf{r})$，其中 $\\kappa$ 是德拜屏蔽长度的倒数。通过比较这两种形式，我们确定屏蔽参数 $\\kappa^2$ 为：\n$$ \\kappa^2 = \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 $$\n德拜屏蔽长度 $\\lambda_D$ 定义为 $\\lambda_D = 1/\\kappa$。因此，多组分电解质的屏蔽关系是：\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{\\sum_{i} n_i^0 q_i^2}} $$\n项 $\\sum_i n_i^0 q_i^2$ 量化了离子溶液的屏蔽能力。在此求和中，电荷平方项 $q_i^2$ 的存在至关重要。它表明多价离子对屏蔽的贡献比单价离子不成比例地大。例如，一个二价离子（电荷为 $2e$）对求和的贡献是 $(2e)^2 = 4e^2$，是相同浓度的单价离子（电荷为 $e$）贡献 $e^2$ 的四倍。因此，与仅含有相似摩尔浓度的单价盐的溶液相比，指定缓冲液中二价钙离子的存在将显著增强屏蔽效应（即减小德拜长度）。\n\n现在我们为给定的缓冲液计算 $\\lambda_D$。离子种类有钠离子($\\mathrm{Na}^{+}$)、钙离子($\\mathrm{Ca}^{2+}$)和氯离子($\\mathrm{Cl}^{-}$)。它们的电荷分别是 $q_{\\mathrm{Na}^+} = +e$，$q_{\\mathrm{Ca}^{2+}} = +2e$ 和 $q_{\\mathrm{Cl}^-} = -e$，其中 $e$ 是基本电荷。\n给定的摩尔浓度($c_i$)是：\n$c_{\\mathrm{NaCl}} = 0.10$ M\n$c_{\\mathrm{CaCl}_2} = 0.05$ M\n假设完全解离，各个离子的浓度是：\n$c_{\\mathrm{Na}^{+}} = 0.10$ M\n$c_{\\mathrm{Ca}^{2+}} = 0.05$ M\n$c_{\\mathrm{Cl}^{-}} = c_{\\text{from NaCl}} + c_{\\text{from CaCl}_2} = 0.10\\ \\mathrm{M} + 2 \\times 0.05\\ \\mathrm{M} = 0.20$ M\n\n求和项 $\\sum_i n_i^0 q_i^2$ 可以用摩尔浓度表示。因为 $n_i^0 = c_i N_A \\times 1000$ （当 $c_i$ 的单位是 $\\mathrm{mol/L}$ 时，$n_i^0$ 的单位是 $\\mathrm{m}^{-3}$）且 $q_i = z_i e$ （其中 $z_i$ 是化合价），该求和项变为：\n$$ \\sum_{i} n_i^0 q_i^2 = \\sum_{i} (c_i N_A \\times 1000) (z_i e)^2 = e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2 $$\n我们来计算 $\\sum_i c_i z_i^2$ 这一项：\n$$ \\sum_{i} c_i z_i^2 = c_{\\mathrm{Na}^{+}} (z_{\\mathrm{Na}^{+}})^2 + c_{\\mathrm{Ca}^{2+}} (z_{\\mathrm{Ca}^{2+}})^2 + c_{\\mathrm{Cl}^{-}} (z_{\\mathrm{Cl}^{-}})^2 $$\n$$ \\sum_{i} c_i z_i^2 = (0.10)(+1)^2 + (0.05)(+2)^2 + (0.20)(-1)^2 $$\n$$ \\sum_{i} c_i z_i^2 = 0.10 \\times 1 + 0.05 \\times 4 + 0.20 \\times 1 = 0.10 + 0.20 + 0.20 = 0.50 \\ \\mathrm{mol\\,L}^{-1} $$\n现在，我们可以写出德拜长度的表达式为：\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon_r \\varepsilon_0 k_B T}{e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2}} $$\n我们代入给定的物理常数和计算出的值：\n$T = 298$ $\\mathrm{K}$\n$\\varepsilon_r = 78.37$\n$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}$ $\\mathrm{F\\,m}^{-1}$\n$k_B = 1.380649 \\times 10^{-23}$ $\\mathrm{J\\,K}^{-1}$\n$e = 1.602176634 \\times 10^{-19}$ $\\mathrm{C}$\n$N_A = 6.02214076 \\times 10^{23}$ $\\mathrm{mol}^{-1}$\n$\\sum_i c_i z_i^2 = 0.50$ $\\mathrm{mol\\,L}^{-1}$\n\n分子：$\\varepsilon_r \\varepsilon_0 k_B T$\n$ = (78.37)(8.8541878128 \\times 10^{-12}\\ \\mathrm{F\\,m}^{-1})(1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1})(298\\ \\mathrm{K}) $\n$ \\approx 2.85483 \\times 10^{-30} \\ \\mathrm{F\\,J\\,m}^{-1} $\n\n分母：$e^2 N_A \\times 1000 \\sum_i c_i z_i^2$\n$ = (1.602176634 \\times 10^{-19}\\ \\mathrm{C})^2 (6.02214076 \\times 10^{23}\\ \\mathrm{mol}^{-1}) (1000\\ \\mathrm{L\\,m}^{-3}) (0.50\\ \\mathrm{mol\\,L}^{-1}) $\n$ \\approx 7.72836 \\times 10^{-12} \\ \\mathrm{C}^2\\mathrm{m}^{-3} $\n注意分子的单位 $\\mathrm{F\\,J\\,m}^{-1}$ 等效于 $\\mathrm{C}^2\\mathrm{m}^{-1}$，因为 $J = C \\cdot V$ 且 $F = C/V$，所以 $F \\cdot J = C^2$。\n\n现在，我们计算 $\\lambda_D^2$：\n$$ \\lambda_D^2 = \\frac{2.85483 \\times 10^{-30}\\ \\mathrm{C}^2\\mathrm{m}^{-1}}{7.72836 \\times 10^{-12}\\ \\mathrm{C}^2\\mathrm{m}^{-3}} \\approx 3.6939 \\times 10^{-19}\\ \\mathrm{m}^2 $$\n取平方根求得 $\\lambda_D$：\n$$ \\lambda_D = \\sqrt{3.6939 \\times 10^{-19}\\ \\mathrm{m}^2} \\approx 6.0778 \\times 10^{-10}\\ \\mathrm{m} $$\n问题要求答案以纳米为单位。因为 $1\\ \\mathrm{nm} = 10^{-9}\\ \\mathrm{m}$：\n$$ \\lambda_D \\approx 0.60778\\ \\mathrm{nm} $$\n四舍五入到三位有效数字，我们得到：\n$$ \\lambda_D \\approx 0.608\\ \\mathrm{nm} $$\n这个值代表了在给定缓冲液中，静电相互作用被移动离子屏蔽的特征长度尺度。",
            "answer": "$$\n\\boxed{0.608}\n$$"
        },
        {
            "introduction": "完整的非线性泊松-玻尔兹曼方程虽然为离子氛提供了严格的平均场描述，但通常难以获得解析解。这促使了其线性化形式——德拜-休克尔方程的广泛使用。这个计算练习  将引导你探索这一关键近似的适用边界，通过比较线性和非线性模型对带电表面的预测。通过量化不同物理条件下的误差，你将培养出一种批判性的直觉，以判断何时简化的线性模型是可靠的，以及何时必须采用完整的非线性处理。",
            "id": "3866522",
            "problem": "考虑一个与均匀带电的无限大平面相邻的对称单价电解质。溶剂被视为连续介电质，其相对介电常数为 $\\,\\epsilon\\,$，绝对介电常数为 $\\,\\epsilon\\epsilon_0\\,$，温度为 $\\,T\\,$。设位于 $\\,x=0\\,$ 处的表面带有均匀的自由表面电荷密度 $\\,\\sigma\\,$，电解质占据 $\\,x0\\,$ 的半空间，其中阳离子和阴离子的体数浓度均为 $\\,n_0\\,$（因此，本体鹽浓度为 $\\,c_0=n_0/N_A\\,$，单位为 $\\mathrm{mol\\,m^{-3}}$）。假设系统处于平衡状态且无流体流动。\n\n从计算化学生物学和静电学中的第一性原理出发，具体包括：\n- 微分形式的高斯定律（Poisson 方程）$\\,\\nabla\\cdot\\left(\\epsilon\\epsilon_0\\nabla\\psi\\right)=-\\rho\\,$，\n- 静电势 $\\,\\psi(x)\\,$ 中单价离子的 Boltzmann 分布 $\\,c_\\pm(x)=n_0\\exp\\!\\left(\\mp \\dfrac{e\\psi(x)}{k_B T}\\right)\\,$，\n- 小电势线性化条件下的 Debye 屏蔽参数的定义，以及\n- 适当的边界条件 $\\,\\psi(\\infty)=0\\,$，$-\\epsilon\\epsilon_0\\,\\psi'(0)=\\sigma\\,$，\n\n基于以上原理，且不使用任何快捷公式，推导表面电荷密度 $\\,\\sigma\\,$ 和表面电势 $\\,\\psi_0=\\psi(0)\\,$ 之间的关系，并应用于以下两种情况：\n1. 完整的非线性 Poisson–Boltzmann (PB) 模型，以及\n2. 小电势区域内的线性化 PB (Debye–Hückel) 模型。\n\n然后，实现一个程序，该程序能够：\n- 使用推导出的关系，为每个给定的测试用例计算非线性 PB 模型预测的表面电势 $\\,\\psi_0^{\\mathrm{NL}}\\,$ 和线性化 PB 模型预测的表面电势 $\\,\\psi_0^{\\mathrm{LIN}}\\,$。\n- 量化线性预测相对于非线性预测的绝对相对误差，其小数形式为\n$$\\mathrm{err}=\\dfrac{\\left|\\psi_0^{\\mathrm{LIN}}-\\psi_0^{\\mathrm{NL}}\\right|}{\\left|\\psi_0^{\\mathrm{NL}}\\right|}.$$\n- 所有电势以 $\\mathrm{V}$ 为单位表示，误差以无单位的小数表示。\n\n精确使用以下物理常数：\n- 基本电荷 $\\,e=1.602176634\\times 10^{-19}\\,\\mathrm{C}\\,$，\n- Boltzmann 常数 $\\,k_B=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}\\,$，\n- 真空介电常数 $\\,\\epsilon_0=8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}\\,$，\n- Avogadro 常数 $\\,N_A=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}\\,$，\n- 温度 $\\,T=298\\,\\mathrm{K}\\,$。\n\n您的程序必须处理给定的本体鹽浓度 $\\,c_0\\,$（单位 $\\mathrm{mol\\,m^{-3}}$），将其转换为数密度 $\\,n_0=N_A c_0\\,$（单位 $\\mathrm{m^{-3}}$）。对于线性化的 PB 模型，使用与边界条件一致的平面解，通过 Debye 屏蔽参数 $\\,\\kappa\\,$ 将 $\\,\\sigma\\,$ 和 $\\,\\psi_0\\,$ 关联起来，其中对于对称单价电解质，$\\,\\kappa^2=\\dfrac{2 e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\\,$。\n\n测试套件。为覆盖不同情况，请使用以下参数集 $(\\sigma, c_0, \\epsilon)$，其中 $\\,\\sigma\\,$ 的单位为 $\\mathrm{C\\,m^{-2}}$，$\\,c_0\\,$ 的单位为 $\\mathrm{mol\\,m^{-3}}$，$\\,\\epsilon\\,$ 为无量纲量：\n- A例（典型水溶液，中等电荷，中等盐浓度）：$\\,\\sigma=-2.0\\times 10^{-2}\\,,\\;c_0=100\\,,\\;\\epsilon=78.5\\,$。\n- B例（小电荷，低盐浓度）：$\\,\\sigma=-1.0\\times 10^{-4}\\,,\\;c_0=1\\,,\\;\\epsilon=78.5\\,$。\n- C例（大电荷，介电常数降低，中等盐浓度）：$\\,\\sigma=-2.0\\times 10^{-1}\\,,\\;c_0=10\\,,\\;\\epsilon=40\\,$。\n- D例（中等电荷，高盐浓度）：$\\,\\sigma=-1.0\\times 10^{-2}\\,,\\;c_0=1000\\,,\\;\\epsilon=78.5\\,$。\n- E例（零电荷边界情况）：$\\,\\sigma=0.0\\,,\\;c_0=100\\,,\\;\\epsilon=78.5\\,$。\n\n最终输出格式。您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，每个内部列表按 $[\\psi_0^{\\mathrm{NL}},\\ \\psi_0^{\\mathrm{LIN}},\\ \\mathrm{err}]$ 的顺序排列，对应相应的测试用例，例如 $[[a_1,b_1,e_1],[a_2,b_2,e_2],\\dots]$。所有 $\\psi_0$ 值必须以 $\\mathrm{V}$ 为单位，所有误差必须是小数形式。",
            "solution": "根据指定标准，用户提供的问题被评估为有效。它在科学上基于静电学和统计力学的原理，问题设定良好，信息充分，可得出唯一解，并以客观、正式的语言陈述。该问题要求推导和应用 Poisson-Boltzmann (PB) 模型，这是计算化学生物学中的一个标准核心课题。\n\n推导和求解过程如下。\n\n该系统由一个位于 $x=0$ 的无限大平面（带有均匀表面电荷密度 $\\sigma$）和一个占据 $x0$ 半空间的对称单价电解质组成。溶剂是在温度 $T$ 下的连续介电质，相对介电常数为 $\\epsilon$。电解质的本体离子数浓度为 $n_0$。\n\n静电势 $\\psi$ 和电荷密度 $\\rho$ 之间的基本关系由 Poisson 方程给出。对于电势 $\\psi$ 仅随距表面距离 $x$ 变化的一维系统，该方程为：\n$$\n\\frac{d}{dx}\\left(\\epsilon\\epsilon_0 \\frac{d\\psi}{dx}\\right) = -\\rho(x)\n$$\n假设介电质是均匀的，$\\epsilon$ 为常数，方程简化为：\n$$\n\\frac{d^2\\psi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon\\epsilon_0}\n$$\n电荷密度 $\\rho(x)$ 来自电解质中的可移动离子。对于对称的 $1:1$ 电解质，阳离子数浓度 $n_+(x)$ 和阴离子数浓度 $n_-(x)$ 由 Boltzmann 分布给出：\n$$\nn_+(x) = n_0 \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_0 \\exp\\left(+\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n其中 $e$ 是基本电荷， $k_B$ 是 Boltzmann 常数，$n_0$ 是每种离子物质的本体数浓度。净电荷密度是阳离子（电荷 $+e$）和阴离子（电荷 $-e$）电荷贡献的总和：\n$$\n\\rho(x) = e n_+(x) - e n_-(x) = e n_0 \\left[ \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right) - \\exp\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\right]\n$$\n使用恒等式 $2\\sinh(y) = e^y - e^{-y}$，电荷密度可以表示为：\n$$\n\\rho(x) = -2en_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n将此代入 Poisson 方程，得到完整的一维非线性 Poisson-Boltzmann (PB) 方程：\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n为求解此方程以得到表面电荷 $\\sigma$ 和表面电势 $\\psi_0 = \\psi(0)$ 之间的关系，我们使用一种积分技巧。将方程两边同乘以 $2\\frac{d\\psi}{dx}$：\n$$\n2\\frac{d\\psi}{dx}\\frac{d^2\\psi}{dx^2} = \\frac{4en_0}{\\epsilon\\epsilon_0} \\frac{d\\psi}{dx} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n左边是 $(\\frac{d\\psi}{dx})^2$ 对 $x$ 的导数。右边也可以表示为一个导数。我们可以写成：\n$$\n\\frac{d}{dx}\\left(\\left(\\frac{d\\psi}{dx}\\right)^2\\right) = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\frac{d}{dx}\\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\n从位置 $x$ 积分到无穷大，并应用边界条件，即电势及其梯度在远离表面处消失，即 $\\psi(\\infty)=0$ 和 $(\\frac{d\\psi}{dx})_{x\\to\\infty}=0$：\n$$\n\\int_x^\\infty \\frac{d}{dx'}\\left(\\left(\\frac{d\\psi}{dx'}\\right)^2\\right) dx' = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\int_x^\\infty \\frac{d}{dx'}\\left(\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right) dx'\n$$\n$$\n\\left[\\left(\\frac{d\\psi}{dx'}\\right)^2\\right]_x^\\infty = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left[\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right]_x^\\infty\n$$\n$$\n0 - \\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh(0) - \\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right) - 1\\right)\n$$\n使用恒等式 $\\cosh(y) - 1 = 2\\sinh^2(y/2)$，我们得到：\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{8n_0 k_B T}{\\epsilon\\epsilon_0} \\sinh^2\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\n取平方根得到电场：\n$$\n\\frac{d\\psi}{dx} = -\\text{sgn}(\\psi_0) \\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\left|\\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\\right|\n$$\n一个更简单的处理符号的方法是认识到，对于 $\\psi_00$，$\\psi(x)$ 减小，因此 $\\psi'  0$。对于 $\\psi_00$，$\\psi(x)$ 增大，因此 $\\psi'  0$。而 $\\sinh(y)$ 的符号与 $y$ 相同。这意味着乘积 $\\psi' \\cdot \\sinh(e\\psi/2k_BT)$ 总是非正的。因此我们取负根：\n$$\n\\frac{d\\psi}{dx} = -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\n带电表面的边界条件由平面表面的高斯定律导出：$-\\epsilon\\epsilon_0 \\left(\\frac{d\\psi}{dx}\\right)_{x=0} = \\sigma$。代入我们在 $x=0$ 处的导数表达式：\n$$\n-\\epsilon\\epsilon_0 \\left( -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right) \\right) = \\sigma\n$$\n这简化为 Grahame 方程，它将表面电荷密度 $\\sigma$ 与表面电势 $\\psi_0$ 联系起来：\n$$\n\\sigma = \\sqrt{8n_0 k_B T \\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right)\n$$\n为了找到完整非线性 PB 模型的表面电势 $\\psi_0^{\\mathrm{NL}}$，我们求解 $\\psi_0$：\n$$\n\\sinh\\left(\\frac{e\\psi_0^{\\mathrm{NL}}}{2k_B T}\\right) = \\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\n$$\n$$\n\\psi_0^{\\mathrm{NL}} = \\frac{2k_B T}{e} \\text{arsinh}\\left(\\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\\right)\n$$\n\n对于线性化的 PB (Debye-Hückel) 模型，我们假设电势很小，即 $|e\\psi(x)| \\ll k_B T$。这允许我们进行线性化 $\\sinh(y) \\approx y$。PB 方程变为：\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\left(\\frac{e\\psi(x)}{k_B T}\\right) = \\left(\\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\\right) \\psi(x)\n$$\n这就是线性化的 Poisson-Boltzmann 方程。括号中的项是 Debye 屏蔽参数 $\\kappa$ 的平方：\n$$\n\\kappa^2 = \\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\n$$\n方程现在是 $\\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi$。通解是 $\\psi(x) = A e^{-\\kappa x} + B e^{\\kappa x}$。应用边界条件 $\\psi(\\infty)=0$ 要求 $B=0$。解为 $\\psi(x) = A e^{-\\kappa x}$。在表面处，$\\psi(0) = \\psi_0 = A$，所以 $\\psi(x) = \\psi_0 e^{-\\kappa x}$。\n\n为了找到 $\\sigma$ 和 $\\psi_0$ 之间的关系，我们使用第二个边界条件 $-\\epsilon\\epsilon_0 \\psi'(0) = \\sigma$。导数是 $\\psi'(x) = -\\kappa\\psi_0 e^{-\\kappa x}$，因此 $\\psi'(0) = -\\kappa\\psi_0$。\n$$\n-\\epsilon\\epsilon_0(-\\kappa \\psi_0) = \\sigma\n$$\n$$\n\\epsilon\\epsilon_0 \\kappa \\psi_0 = \\sigma\n$$\n求解线性化近似中的表面电势 $\\psi_0^{\\mathrm{LIN}}$ 得到：\n$$\n\\psi_0^{\\mathrm{LIN}} = \\frac{\\sigma}{\\epsilon\\epsilon_0 \\kappa}\n$$\n程序将使用这些推导出的表达式计算 $\\psi_0^{\\mathrm{NL}}$ 和 $\\psi_0^{\\mathrm{LIN}}$，然后计算相对误差 $\\mathrm{err} = |\\psi_0^{\\mathrm{LIN}} - \\psi_0^{\\mathrm{NL}}| / |\\psi_0^{\\mathrm{NL}}|$。对于 $\\sigma=0$ 的特殊情况，$\\psi_0^{\\mathrm{NL}}$ 和 $\\psi_0^{\\mathrm{LIN}}$ 均为 $0$，误差定义为 $0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates surface potentials for a charged planar surface\n    in an electrolyte using both nonlinear and linearized Poisson-Boltzmann theory.\n    \"\"\"\n\n    # Define physical constants\n    E = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23     # Boltzmann constant in J/K\n    EPS_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    NA = 6.02214076e23   # Avogadro constant in mol^-1\n    T = 298.0              # Temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (sigma, c0, epsilon)\n    # sigma: surface charge density in C/m^2\n    # c0: bulk salt concentration in mol/m^3\n    # epsilon: relative permittivity (dimensionless)\n    test_cases = [\n        (-2.0e-2, 100.0, 78.5),   # Case A\n        (-1.0e-4, 1.0, 78.5),     # Case B\n        (-2.0e-1, 10.0, 40.0),    # Case C\n        (-1.0e-2, 1000.0, 78.5),  # Case D\n        (0.0, 100.0, 78.5),       # Case E\n    ]\n\n    results = []\n    for sigma, c0, epsilon in test_cases:\n        # Convert bulk concentration c0 (mol/m^3) to number density n0 (m^-3)\n        n0 = c0 * NA\n        \n        # Handle the special case where surface charge is zero\n        if sigma == 0.0:\n            psi0_nl = 0.0\n            psi0_lin = 0.0\n            err = 0.0\n            results.append([psi0_nl, psi0_lin, err])\n            continue\n            \n        # --- Nonlinear Poisson-Boltzmann (NL) calculation ---\n        # Formula: psi0_nl = (2 * kB * T / e) * arsinh(sigma / sqrt(8 * n0 * kB * T * epsilon * epsilon0))\n        denom_nl = np.sqrt(8 * n0 * KB * T * epsilon * EPS_0)\n        arg_arsinh = sigma / denom_nl\n        psi0_nl = (2 * KB * T / E) * np.arcsinh(arg_arsinh)\n\n        # --- Linearized Poisson-Boltzmann (LIN) calculation ---\n        # Formula: psi0_lin = sigma / (epsilon * epsilon0 * kappa)\n        # where kappa = sqrt(2 * e^2 * n0 / (epsilon * epsilon0 * kB * T))\n        kappa_sq = (2 * E**2 * n0) / (epsilon * EPS_0 * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        psi0_lin = sigma / (epsilon * EPS_0 * kappa)\n\n        # --- Error Calculation ---\n        # Formula: err = |psi0_lin - psi0_nl| / |psi0_nl|\n        # The case psi0_nl = 0 (i.e., sigma = 0) is handled above.\n        err = np.abs(psi0_lin - psi0_nl) / np.abs(psi0_nl)\n\n        results.append([psi0_nl, psi0_lin, err])\n\n    # Final print statement in the exact required format.\n    # Format each inner list to a string '[v1,v2,v3]' and join them.\n    formatted_results = [\n        f\"[{','.join(f'{val:.8e}' for val in res)}]\" for res in results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "泊松-玻尔兹曼模型在计算生物学中的一个主要应用是计算静电溶剂化自由能（$\\Delta G_{\\text{elec}}$），这对于理解蛋白质稳定性和结合至关重要。然而，这些计算的准确性对模型中使用的输入参数很敏感，特别是定义溶质-溶剂边界的原子半径。这个高级实践  将指导你完成一次灵敏度分析，以量化原子半径的微小扰动如何影响计算出的溶剂化能。该练习阐明了参数化的重要性，并提供了评估计算预测稳健性的实践经验。",
            "id": "3866531",
            "problem": "要求您在泊松-玻尔兹曼方程的框架下，通过基于基础静电学的严谨推导，分析静电溶剂化自由能对原子半径微扰的敏感性。目标是推导、实现和评估因原子半径发生微小变化而导致的静电溶剂化自由能变化的计算。在此模型中，原子被建模为中心带有相应点电荷的球形空腔。\n\n从以下基础出发：\n- 物质中Maxwell方程组的静电极限给出了静电势的泊松方程，即 $\\nabla \\cdot \\left( \\varepsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r}) \\right) = -\\rho_{\\mathrm{free}}(\\mathbf{r})$，其中 $\\varepsilon(\\mathbf{r})$ 是绝对介电常数，$\\rho_{\\mathrm{free}}(\\mathbf{r})$ 是自由电荷密度。\n- 在电解质中，线性化泊松-玻尔兹曼方程在溶质区域外成立：$\\nabla \\cdot \\left( \\varepsilon_{\\mathrm{out}} \\nabla \\phi(\\mathbf{r}) \\right) - \\varepsilon_{\\mathrm{out}} \\kappa^{2} \\phi(\\mathbf{r}) = 0$，其德拜屏蔽参数 $\\kappa$ 对于对称的 $z:z$ 价电解质由 $\\kappa = \\sqrt{\\dfrac{2 z^{2} e^{2} N_{\\mathrm{A}} I}{\\varepsilon_{0} \\varepsilon_{\\mathrm{r,out}} k_{\\mathrm{B}} T}}$ 给出，其中 $I$ 是离子强度，以 $\\mathrm{mol}/\\mathrm{L}$ 为单位表示，但在公式中以 $\\mathrm{mol}/\\mathrm{m}^{3}$ 为单位使用。此处 $e$ 是元电荷，$N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\varepsilon_{0}$ 是真空介电常数，$\\varepsilon_{\\mathrm{r,out}}$ 是溶剂的相对介电常数，$T$ 是绝对温度。\n\n为便于计算和敏感性分析所做的模型假设：\n- 每个原子被建模为半径为 $a_{i}$ 的球形空腔，其内部绝对介电常数为 $\\varepsilon_{\\mathrm{in}} = \\varepsilon_{0} \\varepsilon_{\\mathrm{r,in}}$（代表溶质内部），并嵌入在绝对介电常数为 $\\varepsilon_{\\mathrm{out}} = \\varepsilon_{0} \\varepsilon_{\\mathrm{r,out}}$、德拜屏蔽参数 $\\kappa$ 由离子强度计算得出的溶剂中。一个大小为 $q_{i}$（以元电荷 $e$ 为单位）的点电荷位于每个球体的中心。为了研究对半径变化的局部敏感性，忽略了原子间的静电耦合，因此总静电溶剂化自由能近似为各独立球形贡献之和。这种近似是敏感性基线分析的标准做法，并且对于小微扰而言更为准确。\n- 单个原子的静电溶剂化自由能定义为 $\\Delta G_{\\mathrm{elec},i} = \\dfrac{1}{2} q_{i} \\phi_{\\mathrm{reaction},i}(0)$，其中 $\\phi_{\\mathrm{reaction},i}(0)$ 是电荷位置处的反应势，通过求解一个边值问题得到。该问题包含空腔内部的泊松方程和外部的线性化泊松-玻尔兹曼方程，并满足在 $r=a_{i}$ 处电势和电位移场法向分量的连续性条件。总静电溶剂化自由能为 $\\Delta G_{\\mathrm{elec}} = \\sum_{i} \\Delta G_{\\mathrm{elec},i}$。\n\n您的任务：\n- 根据上述基础，为单个球形空腔（中心有点电荷，置于电解质中）推导出 $\\phi_{\\mathrm{reaction},i}(0)$ 的显式表达式，并由此推导出 $\\Delta G_{\\mathrm{elec},i}$ 作为 $q_{i}$、$a_{i}$、$\\varepsilon_{\\mathrm{in}}$、$\\varepsilon_{\\mathrm{out}}$ 和 $\\kappa$ 的函数。\n- 实现一个程序，对于给定的原子集和环境参数，计算基线半径集和微扰后半径集下的 $\\Delta G_{\\mathrm{elec}}$。报告敏感性 $\\Delta \\Delta G_{\\mathrm{elec}} = \\Delta G_{\\mathrm{elec}}^{\\mathrm{perturbed}} - \\Delta G_{\\mathrm{elec}}^{\\mathrm{baseline}}$。\n- 所有能量必须以 $\\mathrm{kJ}/\\mathrm{mol}$ 为单位表示，并四舍五入到 $6$ 位小数。半径以 $\\mathrm{nm}$ 为单位指定，内部计算时必须转换为 $\\mathrm{m}$。离子强度以 $\\mathrm{mol}/\\mathrm{L}$ 为单位指定，内部计算时必须转换为 $\\mathrm{mol}/\\mathrm{m}^{3}$。温度单位为 $\\mathrm{K}$。电荷 $q_{i}$ 以元电荷 $e$ 为单位指定，内部计算时必须转换为 $\\mathrm{C}$。\n\n使用的常数：\n- 真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F}/\\mathrm{m}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}/\\mathrm{K}$。\n- 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。\n- 元电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n- 对于所有测试用例，均采用 $z=1$ 的单价电解质。\n\n测试套件：\n实现您的程序，以评估以下五个测试用例的 $\\Delta \\Delta G_{\\mathrm{elec}}$。在每个案例中，基线半径通过对所有半径加上一个统一的偏移量 $\\delta a$（$\\delta a$ 可以是正数或负数）来进行微扰，每个案例的环境参数保持不变。\n\n- 案例 1（典型案例）：$3$ 个原子，电荷为 $\\left[-0.8, +0.4, +0.4\\right]$（单位 $e$）；基线半径为 $\\left[0.16, 0.14, 0.14\\right]\\,\\mathrm{nm}$；微扰 $\\delta a = +0.02\\,\\mathrm{nm}$；温度 $T = 298\\,\\mathrm{K}$；相对介电常数 $\\varepsilon_{\\mathrm{r,in}} = 4$，$\\varepsilon_{\\mathrm{r,out}} = 78.5$；离子强度 $I = 0.15\\,\\mathrm{mol}/\\mathrm{L}$。\n- 案例 2（边界情况，无屏蔽）：与案例 1 相同的原子和基线；微扰 $\\delta a = +0.02\\,\\mathrm{nm}$；$T = 298\\,\\mathrm{K}$；$\\varepsilon_{\\mathrm{r,in}} = 4$，$\\varepsilon_{\\mathrm{r,out}} = 78.5$；离子强度 $I = 0.0\\,\\mathrm{mol}/\\mathrm{L}$。\n- 案例 3（边缘情况，零电荷）：$1$ 个原子，电荷为 $\\left[0.0\\right]$；基线半径为 $\\left[0.20\\right]\\,\\mathrm{nm}$；微扰 $\\delta a = +0.05\\,\\mathrm{nm}$；$T = 298\\,\\mathrm{K}$；$\\varepsilon_{\\mathrm{r,in}} = 4$，$\\varepsilon_{\\mathrm{r,out}} = 78.5$；离子强度 $I = 0.15\\,\\mathrm{mol}/\\mathrm{L}$。\n- 案例 4（高盐浓度，负微扰）：$3$ 个原子，电荷为 $\\left[-0.8, +0.4, +0.4\\right]$；基线半径为 $\\left[0.16, 0.14, 0.14\\right]\\,\\mathrm{nm}$；微扰 $\\delta a = -0.02\\,\\mathrm{nm}$；$T = 298\\,\\mathrm{K}$；$\\varepsilon_{\\mathrm{r,in}} = 4$，$\\varepsilon_{\\mathrm{r,out}} = 78.5$；离子强度 $I = 1.0\\,\\mathrm{mol}/\\mathrm{L}$。\n- 案例 5（小半径，单价离子）：$1$ 个原子，电荷为 $\\left[+1.0\\right]$；基线半径为 $\\left[0.10\\right]\\,\\mathrm{nm}$；微扰 $\\delta a = +0.01\\,\\mathrm{nm}$；$T = 298\\,\\mathrm{K}$；$\\varepsilon_{\\mathrm{r,in}} = 4$，$\\varepsilon_{\\mathrm{r,out}} = 78.5$；离子强度 $I = 0.10\\,\\mathrm{mol}/\\mathrm{L}$。\n\n您的程序应生成单行输出，其中包含按案例 1 到 5 顺序排列的结果，格式为方括号内的逗号分隔列表，例如 $\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4},\\text{result}_{5}\\right]$，其中每个 $\\text{result}_{k}$ 是以 $\\mathrm{kJ}/\\mathrm{mol}$ 为单位且四舍五入到 $6$ 位小数的 $\\Delta \\Delta G_{\\mathrm{elec}}$ 值。",
            "solution": "该问题要求推导并实现一种方法，用于计算静电溶剂化自由能 $\\Delta G_{\\mathrm{elec}}$ 对原子半径变化的敏感性。该问题通过将原子处理为带电球形空腔并使用线性化泊松-玻尔兹曼方程进行建模。总能量是个体、无相互作用原子的能量之和。主要任务是推导单离子溶剂化自由能，然后计算几个测试用例的总能量变化 $\\Delta \\Delta G_{\\mathrm{elec}}$。\n\n### 基于原理的推导\n\n我们首先求解单个球形空腔的静电问题，该空腔半径为 $a_i$，中心有一个点电荷 $q_i$。该空腔具有均匀的内部绝对介电常数 $\\varepsilon_{\\mathrm{in}}$，并浸没在绝对介电常数为 $\\varepsilon_{\\mathrm{out}}$、德拜屏蔽参数为 $\\kappa$ 的电解质中。\n\n**1. 控制方程与通解**\n\n静电势 $\\phi(\\mathbf{r})$ 必须满足相应的静电方程。由于问题的球对称性，电势 $\\phi$ 仅是径向距离 $r = |\\mathbf{r}|$ 的函数。\n\n- **空腔内部 ($r  a_i$)**：电势 $\\phi_{\\mathrm{in}}(r)$ 由泊松方程决定。电荷密度是位于原点的点电荷，$\\rho_{\\mathrm{free}}(\\mathbf{r}) = q_i \\delta(\\mathbf{r})$。电势是在介电常数为 $\\varepsilon_{\\mathrm{in}}$ 的均匀介质中由电荷产生的直接库仑势与在原点处有限的拉普拉斯方程 $\\nabla^2 \\phi = 0$ 的解之和。通解为：\n$$ \\phi_{\\mathrm{in}}(r) = \\frac{q_i}{4 \\pi \\varepsilon_{\\mathrm{in}} r} + C_1 $$\n常数 $C_1$ 代表由介电边界引起的恒定电势偏移，并且是原点处的反应势。\n\n- **空腔外部 ($r > a_i$)**：电势 $\\phi_{\\mathrm{out}}(r)$ 由线性化泊松-玻尔兹曼方程（LPBE）决定：$\\nabla^2 \\phi_{\\mathrm{out}}(r) - \\kappa^2 \\phi_{\\mathrm{out}}(r) = 0$。球对称通解是 $\\frac{e^{-\\kappa r}}{r}$ 和 $\\frac{e^{\\kappa r}}{r}$ 的线性组合。物理边界条件要求电势在无穷远处必须为零，即当 $r \\to \\infty$ 时 $\\phi_{\\mathrm{out}}(r) \\to 0$，这要求我们舍弃指数增长项。因此，解具有屏蔽库仑势的形式：\n$$ \\phi_{\\mathrm{out}}(r) = C_2 \\frac{e^{-\\kappa r}}{r} $$\n\n**2. 边界条件的应用**\n\n常数 $C_1$ 和 $C_2$ 通过在球形界面 $r = a_i$ 处应用边界条件来确定：\n1.  静电势的连续性：$\\phi_{\\mathrm{in}}(a_i) = \\phi_{\\mathrm{out}}(a_i)$。\n2.  电位移场 $\\mathbf{D} = -\\varepsilon \\nabla \\phi$ 法向分量的连续性：$\\varepsilon_{\\mathrm{in}} \\left. \\frac{d\\phi_{\\mathrm{in}}}{dr} \\right|_{r=a_i} = \\varepsilon_{\\mathrm{out}} \\left. \\frac{d\\phi_{\\mathrm{out}}}{dr} \\right|_{r=a_i}$。\n\n应用第一个条件：\n$$ \\frac{q_i}{4 \\pi \\varepsilon_{\\mathrm{in}} a_i} + C_1 = C_2 \\frac{e^{-\\kappa a_i}}{a_i} \\quad (1)$$\n\n对于第二个条件，我们首先求导数：\n$$ \\frac{d\\phi_{\\mathrm{in}}}{dr} = -\\frac{q_i}{4 \\pi \\varepsilon_{\\mathrm{in}} r^2} $$\n$$ \\frac{d\\phi_{\\mathrm{out}}}{dr} = C_2 \\left( -\\frac{e^{-\\kappa r}}{r^2} - \\frac{\\kappa e^{-\\kappa r}}{r} \\right) = -C_2 \\frac{e^{-\\kappa r}}{r^2} (1 + \\kappa r) $$\n在 $r=a_i$ 处应用该条件：\n$$ \\varepsilon_{\\mathrm{in}} \\left( -\\frac{q_i}{4 \\pi \\varepsilon_{\\mathrm{in}} a_i^2} \\right) = \\varepsilon_{\\mathrm{out}} \\left( -C_2 \\frac{e^{-\\kappa a_i}}{a_i^2} (1 + \\kappa a_i) \\right) $$\n$$ -\\frac{q_i}{4 \\pi} = - \\varepsilon_{\\mathrm{out}} C_2 e^{-\\kappa a_i} (1 + \\kappa a_i) $$\n求解 $C_2$：\n$$ C_2 = \\frac{q_i}{4 \\pi \\varepsilon_{\\mathrm{out}} (1 + \\kappa a_i) e^{-\\kappa a_i}} $$\n\n现在，我们将 $C_2$ 代回方程 $(1)$以求解 $C_1$：\n$$ \\frac{q_i}{4 \\pi \\varepsilon_{\\mathrm{in}} a_i} + C_1 = \\left( \\frac{q_i}{4 \\pi \\varepsilon_{\\mathrm{out}} (1 + \\kappa a_i) e^{-\\kappa a_i}} \\right) \\frac{e^{-\\kappa a_i}}{a_i} $$\n$$ C_1 = \\frac{q_i}{4 \\pi a_i \\varepsilon_{\\mathrm{out}} (1 + \\kappa a_i)} - \\frac{q_i}{4 \\pi a_i \\varepsilon_{\\mathrm{in}}} $$\n$$ C_1 = \\frac{q_i}{4 \\pi a_i} \\left( \\frac{1}{\\varepsilon_{\\mathrm{out}} (1 + \\kappa a_i)} - \\frac{1}{\\varepsilon_{\\mathrm{in}}} \\right) $$\n\n**3. 静电溶剂化自由能**\n\n问题将原子 $i$ 的静电溶剂化自由能定义为 $\\Delta G_{\\mathrm{elec},i} = \\frac{1}{2} q_i \\phi_{\\mathrm{reaction},i}(0)$。原点处的反应势 $\\phi_{\\mathrm{reaction},i}(0)$ 正是上面推导出的常数 $C_1$。因此：\n$$ \\Delta G_{\\mathrm{elec},i} = \\frac{1}{2} q_i C_1 = \\frac{q_i^2}{8 \\pi a_i} \\left( \\frac{1}{\\varepsilon_{\\mathrm{out}} (1 + \\kappa a_i)} - \\frac{1}{\\varepsilon_{\\mathrm{in}}} \\right) $$\n使用相对介电常数 $\\varepsilon_{\\mathrm{r,in}}$ 和 $\\varepsilon_{\\mathrm{r,out}}$，其中 $\\varepsilon = \\varepsilon_r \\varepsilon_0$，我们可以将表达式重写为：\n$$ \\Delta G_{\\mathrm{elec},i} = \\frac{q_i^2}{8 \\pi \\varepsilon_0 a_i} \\left( \\frac{1}{\\varepsilon_{\\mathrm{r,out}} (1 + \\kappa a_i)} - \\frac{1}{\\varepsilon_{\\mathrm{r,in}}} \\right) $$\n此表达式给出了单个离子的能量，单位为焦耳。\n\n### 计算策略\n\n总静电溶剂化自由能 $\\Delta G_{\\mathrm{elec}}$ 是忽略原子间相互作用的各个贡献之和：\n$$ \\Delta G_{\\mathrm{elec}} = \\sum_i \\Delta G_{\\mathrm{elec},i} $$\n敏感性分析需要计算 $\\Delta \\Delta G_{\\mathrm{elec}} = \\Delta G_{\\mathrm{elec}}^{\\mathrm{perturbed}} - \\Delta G_{\\mathrm{elec}}^{\\mathrm{baseline}}$。\n\n实现过程需要仔细处理单位，以确保计算过程中所有量都采用国际单位制（SI）。\n- 半径 $a_i$ 必须从 $\\mathrm{nm}$ 转换为 $\\mathrm{m}$（$1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m}$）。\n- 电荷 $q_i$ 以元电荷 $e$ 为单位给出，必须通过乘以 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$ 转换为库仑。\n- 离子强度 $I$ 以 $\\mathrm{mol/L}$ 为单位给出，必须通过乘以 $1000$ 转换为 $\\mathrm{mol/m}^3$。\n\n德拜屏蔽参数 $\\kappa$（单位为 $\\mathrm{m}^{-1}$）使用为 $z=1$ 的 $z:z$ 对称电解质提供的公式计算：\n$$ \\kappa = \\sqrt{\\frac{2 z^2 e^2 N_{\\mathrm{A}} I_{\\mathrm{m}^{-3}}}{\\varepsilon_0 \\varepsilon_{\\mathrm{r,out}} k_{\\mathrm{B}} T}} $$\n其中 $I_{\\mathrm{m}^{-3}}$ 是以 $\\mathrm{mol/m}^3$ 为单位的离子强度。\n\n分子系统的最终能量以焦耳计算，然后通过乘以阿伏伽德罗常数 $N_A$ 和因子 $1/1000$ 转换为 $\\mathrm{kJ/mol}$：\n$$ \\Delta G_{\\mathrm{elec}} [\\mathrm{kJ/mol}] = \\left( \\sum_i \\Delta G_{\\mathrm{elec},i} [\\mathrm{J}] \\right) \\times N_{\\mathrm{A}} \\times 10^{-3} $$\n\n对于每个测试用例，我们计算基线半径和微扰后半径（$a_i^{\\mathrm{pert}} = a_i^{\\mathrm{base}} + \\delta a$）下的 $\\Delta G_{\\mathrm{elec}}$，然后求出它们的差值。",
            "answer": "```python\nimport numpy as np\n\n# Physical constants in SI units\nEPS_0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\nK_B = 1.380649e-23        # Boltzmann constant (J/K)\nN_A = 6.02214076e23       # Avogadro's number (mol^-1)\nE_CHARGE = 1.602176634e-19 # Elementary charge (C)\n\ndef compute_total_solvation_energy(charges, radii_nm, temp, eps_r_in, eps_r_out, ionic_strength_M):\n    \"\"\"\n    Computes the total electrostatic solvation free energy for a set of atoms.\n\n    Args:\n        charges (np.ndarray): Array of atomic charges in units of elementary charge e.\n        radii_nm (np.ndarray): Array of atomic radii in nm.\n        temp (float): Temperature in Kelvin.\n        eps_r_in (float): Relative permittivity of the solute interior.\n        eps_r_out (float): Relative permittivity of the solvent.\n        ionic_strength_M (float): Ionic strength in mol/L.\n\n    Returns:\n        float: Total electrostatic solvation free energy in kJ/mol.\n    \"\"\"\n    # Unit conversions to SI\n    radii_m = radii_nm * 1e-9  # nm to m\n    charges_C = charges * E_CHARGE  # e to C\n    ionic_strength_m3 = ionic_strength_M * 1000  # mol/L to mol/m^3\n\n    # Calculate Debye screening parameter kappa (1/m)\n    # For a symmetric z:z monovalent electrolyte, z=1\n    z_val = 1\n    if ionic_strength_m3 == 0:\n        kappa = 0.0\n    else:\n        # Denominator of kappa^2 expression\n        kappa_denom = EPS_0 * eps_r_out * K_B * temp\n        # Numerator of kappa^2 expression\n        kappa_num = 2 * (z_val**2) * (E_CHARGE**2) * N_A * ionic_strength_m3\n        kappa = np.sqrt(kappa_num / kappa_denom)\n\n    # Calculate energy contribution from each atom\n    total_G_joules = 0.0\n    for i in range(len(charges)):\n        q_i = charges_C[i]\n        a_i = radii_m[i]\n\n        if q_i == 0:\n            continue\n\n        # Derived formula for single-ion energy in Joules\n        # delta_G_i = (q_i^2 / (8*pi*eps0*a_i)) * [ (1 / (eps_r_out*(1+kappa*a_i))) - (1 / eps_r_in) ]\n        \n        factor = (q_i**2) / (8 * np.pi * EPS_0 * a_i)\n        \n        term_out = 1 / (eps_r_out * (1 + kappa * a_i))\n        term_in = 1 / eps_r_in\n        \n        delta_G_i_joules = factor * (term_out - term_in)\n        total_G_joules += delta_G_i_joules\n\n    # Convert total energy from Joules per molecule set to kJ/mol\n    total_G_kJ_per_mol = total_G_joules * N_A / 1000\n\n    return total_G_kJ_per_mol\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the formatted result.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path)\n        {'charges': np.array([-0.8, 0.4, 0.4]), 'radii_nm': np.array([0.16, 0.14, 0.14]),\n         'delta_a_nm': 0.02, 'temp': 298.0, 'eps_r_in': 4.0, 'eps_r_out': 78.5, 'I_M': 0.15},\n        # Case 2 (boundary, no screening)\n        {'charges': np.array([-0.8, 0.4, 0.4]), 'radii_nm': np.array([0.16, 0.14, 0.14]),\n         'delta_a_nm': 0.02, 'temp': 298.0, 'eps_r_in': 4.0, 'eps_r_out': 78.5, 'I_M': 0.0},\n        # Case 3 (edge, zero charge)\n        {'charges': np.array([0.0]), 'radii_nm': np.array([0.20]),\n         'delta_a_nm': 0.05, 'temp': 298.0, 'eps_r_in': 4.0, 'eps_r_out': 78.5, 'I_M': 0.15},\n        # Case 4 (high salt, negative perturbation)\n        {'charges': np.array([-0.8, 0.4, 0.4]), 'radii_nm': np.array([0.16, 0.14, 0.14]),\n         'delta_a_nm': -0.02, 'temp': 298.0, 'eps_r_in': 4.0, 'eps_r_out': 78.5, 'I_M': 1.0},\n        # Case 5 (small radius, monovalent ion)\n        {'charges': np.array([1.0]), 'radii_nm': np.array([0.10]),\n         'delta_a_nm': 0.01, 'temp': 298.0, 'eps_r_in': 4.0, 'eps_r_out': 78.5, 'I_M': 0.10}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Baseline energy calculation\n        G_baseline = compute_total_solvation_energy(\n            charges=case['charges'],\n            radii_nm=case['radii_nm'],\n            temp=case['temp'],\n            eps_r_in=case['eps_r_in'],\n            eps_r_out=case['eps_r_out'],\n            ionic_strength_M=case['I_M']\n        )\n        \n        # Perturbed energy calculation\n        perturbed_radii_nm = case['radii_nm'] + case['delta_a_nm']\n        G_perturbed = compute_total_solvation_energy(\n            charges=case['charges'],\n            radii_nm=perturbed_radii_nm,\n            temp=case['temp'],\n            eps_r_in=case['eps_r_in'],\n            eps_r_out=case['eps_r_out'],\n            ionic_strength_M=case['I_M']\n        )\n        \n        # Compute the difference and round to 6 decimal places\n        delta_delta_G = G_perturbed - G_baseline\n        results.append(round(delta_delta_G, 6))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}