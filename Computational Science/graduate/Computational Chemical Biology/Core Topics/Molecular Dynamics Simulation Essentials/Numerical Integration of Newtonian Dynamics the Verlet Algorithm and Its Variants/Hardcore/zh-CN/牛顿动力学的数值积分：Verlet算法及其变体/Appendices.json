{
    "hands_on_practices": [
        {
            "introduction": "在任何分子动力学模拟中，首要的关键决策是选择积分时间步长 $\\Delta t$。这个参数决定了计算效率与数值稳定性之间的权衡。本练习  提供了 Verlet 积分算法稳定性理论的一个具体应用，指导你通过识别一个真实生物分子系统中最快的振动模式，来计算允许的最大时间步长。",
            "id": "3857340",
            "problem": "一个嵌入在显式液态水中的膜蛋白，使用分子动力学（MD）和一个速度Verlet积分器进行模拟。所有涉及氢的共价键都被约束，但键角没有被约束。在势能最小值附近的谐波小振动近似下，每个简正模的动力学由牛顿第二定律支配，而最快的模式决定了时间积分器的线性稳定性要求。为确保一个目标稳定裕度，施加约束 $\\omega_{\\max}\\,\\Delta t \\le \\beta$，其中 $\\beta \\le 2$。对于这个对涉及氢的键进行约束的蛋白质-水系统，假设剩余的最高振动波数是 $1650\\,\\mathrm{cm}^{-1}$ 的肽羰基伸缩振动和 $1595\\,\\mathrm{cm}^{-1}$ 的水弯曲模式。取光速为 $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}$，并设定目标裕度参数为 $\\beta = 1.3$。使用基于第一性原理的物理上合理的推理，确定满足该裕度的最大允许时间步长 $\\Delta t$。以飞秒为单位表示你的最终答案，并将答案四舍五入到三位有效数字。",
            "solution": "问题陈述已经过验证，并被确定为计算化学生物学领域中一个适定、有科学依据的问题。所有必要的数据都已提供，前提与分子动力学模拟和数值分析的既定原则一致，且目标明确。\n\n问题的核心在于速度Verlet积分器应用于谐振子时的线性稳定性分析。对于运动方程为 $\\ddot{x} = -\\omega^2 x$ 的一维谐振子，速度Verlet算法是稳定的，当且仅当角频率 $\\omega$ 和时间步长 $\\Delta t$ 的乘积满足条件 $\\omega \\Delta t \\le 2$。问题提供了一个带有目标裕度参数 $\\beta$ 的更严格的稳定性条件：\n$$\n\\omega_{\\max}\\,\\Delta t \\le \\beta\n$$\n这里，$\\omega_{\\max}$ 是动力学系统中存在的最高角频率。目标是找到最大允许时间步长 $\\Delta t_{\\max}$，它对应于极限情况下的等式：\n$$\n\\Delta t_{\\max} = \\frac{\\beta}{\\omega_{\\max}}\n$$\n角频率 $\\omega$（单位为弧度/秒）通过 $\\omega = 2\\pi\\nu$ 与频率 $\\nu$（单位为赫兹，或 $\\mathrm{s}^{-1}$）相关。频率 $\\nu$ 通过关系式 $\\nu = c\\tilde{\\nu}$ 与波数 $\\tilde{\\nu}$（单位为 $\\mathrm{cm}^{-1}$）和光速 $c$（单位为 $\\mathrm{cm/s}$）相关。结合这些，我们得到角频率和波数之间的直接关系：\n$$\n\\omega = 2\\pi c \\tilde{\\nu}\n$$\n稳定性条件由系统中最快的振动模式决定，该模式对应于最高角频率 $\\omega_{\\max}$，因此也对应于最高波数 $\\tilde{\\nu}_{\\max}$。问题陈述所有涉及氢原子的共价键都被约束。这种分子动力学模拟中的标准技术（例如，使用像SHAKE或LINCS这样的算法）有效地从系统中移除了最高频率的运动，即涉及轻氢原子的键伸缩振动（通常波数大于 $3000\\,\\mathrm{cm}^{-1}$）。\n\n应用这些约束后，问题指明剩余的最高振动波数来自肽羰基（C=O）的伸缩振动，$\\tilde{\\nu}_1 = 1650\\,\\mathrm{cm}^{-1}$，以及水分子的弯曲模式，$\\tilde{\\nu}_2 = 1595\\,\\mathrm{cm}^{-1}$。时间步长的限制因素是这两个波数中较大的一个。\n$$\n\\tilde{\\nu}_{\\max} = \\max(\\tilde{\\nu}_1, \\tilde{\\nu}_2) = \\max(1650\\,\\mathrm{cm}^{-1}, 1595\\,\\mathrm{cm}^{-1}) = 1650\\,\\mathrm{cm}^{-1}\n$$\n因此，系统中最高的角频率是：\n$$\n\\omega_{\\max} = 2\\pi c \\tilde{\\nu}_{\\max}\n$$\n将 $\\omega_{\\max}$ 的这个表达式代入 $\\Delta t_{\\max}$ 的方程中，得到：\n$$\n\\Delta t_{\\max} = \\frac{\\beta}{2\\pi c \\tilde{\\nu}_{\\max}}\n$$\n我们已知以下值：\n\\begin{itemize}\n    \\item 目标裕度参数：$\\beta = 1.3$\n    \\item 光速：$c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}$\n    \\item 最大波数：$\\tilde{\\nu}_{\\max} = 1650\\,\\mathrm{cm}^{-1}$\n\\end{itemize}\n将这些值代入 $\\Delta t_{\\max}$ 的方程中：\n$$\n\\Delta t_{\\max} = \\frac{1.3}{2\\pi (2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}) (1650\\,\\mathrm{cm}^{-1})}\n$$\n分母中的单位是 $(\\mathrm{cm/s}) \\cdot (\\mathrm{cm}^{-1}) = \\mathrm{s}^{-1}$，所以 $\\Delta t_{\\max}$ 的结果单位将是秒，符合预期。\n$$\n\\Delta t_{\\max} = \\frac{1.3}{2\\pi (2.99792458 \\times 10^{10}) (1650)}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} \\approx \\frac{1.3}{3.1090604 \\times 10^{14}}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} \\approx 4.181205 \\times 10^{-15}\\,\\mathrm{s}\n$$\n问题要求答案以飞秒（$1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$）表示。因此，\n$$\n\\Delta t_{\\max} \\approx 4.181205\\,\\mathrm{fs}\n$$\n最后，我们必须将答案四舍五入到三位有效数字。\n$$\n\\Delta t_{\\max} \\approx 4.18\\,\\mathrm{fs}\n$$\n对于约束了与氢原子相关的键的生物分子动力学模拟，这个值是一个物理上合理的时间步长。此类模拟通常使用 $2\\,\\mathrm{fs}$ 的时间步长。计算出的 $4.18\\,\\mathrm{fs}$ 值代表了基于最快未约束模式和指定安全裕度的理论上限，而不是一个推荐的实用值，后者还需要考虑能量守恒精度等其他因素。",
            "answer": "$$\\boxed{4.18}$$"
        },
        {
            "introduction": "为了加速模拟，诸如可逆参考系统传播算法 (r-RESPA) 等先进方法采用了多时间步长方案。然而，这种效率的提升是以引入新的数值误差为代价的。本练习  将让你通过推导计算加速比和主导阶误差，来量化这种基本的权衡关系，从而让你从第一性原理的层面理解如何分析多时间步长方案。",
            "id": "3857311",
            "problem": "考虑一个全原子溶剂化蛋白质体系，其遵循经典牛顿动力学，其中每个原子上的总确定性力分解为由键合和短程非键相互作用引起的快速变化分量，以及由通过粒子网格埃瓦尔德（PME）方法计算的长程静电相互作用引起的缓慢变化分量。设 $M$ 表示蛋白质主链上一个主要的低频笛卡尔简正模的代表性原子质量，并设该模式的慢静电贡献在局部近似为一个有效曲率为 $k_{s}$ 的谐振回复力，因此一维模式坐标 $x$ 上的慢力为 $F_{s}(x) \\approx -k_{s} x$。假设快力贡献由内层积分器精确处理。\n\n采用双层参考系统传播算法（RESPA），其中快力使用内层时间步长 $h$，慢力使用宏观步长 $H = m h$。慢力仅每 $m$ 个内层步长计算一次，并在慢力更新之间保持恒定。假设温度为 $T$，且代表性模式处于热平衡状态，因此初始速度 $v_{0}$ 从麦克斯韦-玻尔兹曼分布中抽取。使用牛顿第二定律和真实轨迹 $x(t)$ 在宏观步长开始处的一阶局域展开，来量化在宏观步长内保持慢力恒定所带来的主导阶效应。\n\n给定条件如下：\n- 内层时间步长 $h = 2 \\times 10^{-15} \\ \\mathrm{s}$ 和慢力步幅 $m = 5$，因此 $H = m h$。\n- 代表性模式质量 $M = 14 \\ \\mathrm{amu}$。\n- 慢力曲率 $k_{s} = 8 \\ \\mathrm{N} \\ \\mathrm{m}^{-1}$。\n- 温度 $T = 300 \\ \\mathrm{K}$。\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J} \\ \\mathrm{K}^{-1}$。\n- 原子质量单位换算 $1 \\ \\mathrm{amu} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$。\n- 每次评估的计算成本：快力成本 $c_{f} = 1.2$（每个内层步长的任意时间单位），慢力成本 $c_{s} = 9.0$（每次评估的相同单位）。\n\n从牛顿第二定律和定义 $v = dx/dt$ 出发，并使用一阶泰勒展开来近似单个宏观步长上的 $x(t)$，完成以下任务：\n1. 推导并计算加速因子 $S$。其定义为：在每个内层步长都评估快力和慢力的每个宏观步长的总成本，与慢力仅在每个宏观步长评估一次并在其间保持恒定的每个宏观步长的总成本之比。\n2. 推导在单个宏观步长 $H$ 内累积的主导阶期望均方根位置误差 $\\Delta x_{\\mathrm{rms}}$ 的表达式，该误差仅由在宏观步长内使用过时的慢力引起。将慢力误差建模为真实慢加速度 $a_{s}(t)$ 与在宏观步长开始时固定的恒定近似值 $a_{s}^{\\mathrm{approx}}$ 之间的差值，并使用热均方根速度 $v_{\\mathrm{rms}} = \\sqrt{k_{B} T / M}$ 来获得对初始速度的期望值。计算 $\\Delta x_{\\mathrm{rms}}$ 的数值。\n\n将加速因子 $S$ 表示为无量纲数，位置误差 $\\Delta x_{\\mathrm{rms}}$ 以纳米为单位。将 $S$ 和 $\\Delta x_{\\mathrm{rms}}$ 均四舍五入到三位有效数字。您的最终答案必须是一个单行矩阵，按顺序包含 $S$ 和 $\\Delta x_{\\mathrm{rms}}$。",
            "solution": "该问题要求计算与在分子动力学模拟中使用 RESPA 多时间步长算法相关的两个量：计算加速因子 $S$ 和单个宏观步长内的均方根位置误差 $\\Delta x_{\\mathrm{rms}}$。\n\n### 第 1 部分：加速因子 $S$ 的推导与计算\n\n加速因子 $S$ 定义为在持续时间为 $H$ 的单个宏观步长内，不使用 RESPA 的计算成本与使用 RESPA 的计算成本之比。宏观步长由 $m$ 个持续时间为 $h$ 的内层时间步长组成，因此 $H = m h$。\n\n每次评估的计算成本给定为快力 $c_f$ 和慢力 $c_s$。\n\n1.  **不使用 RESPA 的成本（单时间步长）：**\n    如果对所有力都使用单个时间步长 $h$，则必须在每个步长计算快力和慢力。在一个宏观步长（$H=mh$）的时间段内，有 $m$ 个内层步长。\n    这样一个步长的成本是 $c_f + c_s$。\n    对应于一个宏观步长持续时间的 $m$ 个步长的总成本是：\n    $$C_{\\text{no-RESPA}} = m (c_f + c_s)$$\n\n2.  **使用 RESPA 的成本：**\n    在所述的双层 RESPA 方案中，快力在每个内层步长 $h$ 进行评估，而慢力仅在每个宏观步长 $H$ 评估一次。\n    在一个宏观步长内，快力计算 $m$ 次，慢力计算一次。\n    每个宏观步长的总成本是：\n    $$C_{\\text{RESPA}} = m c_f + c_s$$\n\n3.  **加速因子 $S$：**\n    加速因子 $S$ 是这两个成本的比率：\n    $$S = \\frac{C_{\\text{no-RESPA}}}{C_{\\text{RESPA}}} = \\frac{m(c_f + c_s)}{m c_f + c_s}$$\n    代入给定的数值：$m = 5$，$c_f = 1.2$，$c_s = 9.0$（任意单位）。\n    $$S = \\frac{5(1.2 + 9.0)}{5(1.2) + 9.0} = \\frac{5(10.2)}{6.0 + 9.0} = \\frac{51}{15} = 3.4$$\n    四舍五入到三位有效数字，加速因子为 $S = 3.40$。\n\n### 第 2 部分：RMS 位置误差 $\\Delta x_{\\mathrm{rms}}$ 的推导与计算\n\n误差源于在宏观步长 $H$ 内保持慢力恒定。慢力由 $F_s(x) = -k_s x$ 给出。\n\n1.  **动力学和加速度误差：**\n    根据牛顿第二定律，慢加速度分量为 $a_s(t) = \\frac{F_s(x(t))}{M} = -\\frac{k_s}{M} x(t)$。\n    在 RESPA 方案中，慢加速度在区间 $t \\in [0, H]$ 内被近似为常数，基于宏观步长开始时的位置 $x_0 = x(0)$：\n    $$a_s^{\\mathrm{approx}} = a_s(0) = -\\frac{k_s}{M} x_0$$\n    在宏观步长内 $t$ 时刻的慢加速度误差是真实加速度与近似加速度之间的差值：\n    $$\\Delta a_s(t) = a_s(t) - a_s^{\\mathrm{approx}} = -\\frac{k_s}{M} x(t) - \\left(-\\frac{k_s}{M} x_0\\right) = -\\frac{k_s}{M} (x(t) - x_0)$$\n    问题指定使用轨迹 $x(t)$ 的一阶泰勒展开来找到主导阶误差。我们在 $t=0$ 处展开 $x(t)$：\n    $$x(t) \\approx x_0 + v_0 t$$\n    其中 $v_0 = v(0)$ 是初始速度。将其代入加速度误差表达式，得到主导阶误差：\n    $$\\Delta a_s(t) \\approx -\\frac{k_s}{M} ( (x_0 + v_0 t) - x_0 ) = -\\frac{k_s v_0}{M} t$$\n\n2.  **位置误差累积：**\n    位置误差 $\\Delta x(t)$ 由于加速度误差而累积。假设初始位置和速度误差为零，我们可以通过将加速度误差对时间从 $t=0$ 到 $t=H$ 积分两次，来找到宏观步长结束时的位置误差 $\\Delta x(H)$：\n    $$\\Delta \\dot{x}(t) = \\int_0^t \\Delta a_s(\\tau) d\\tau = \\int_0^t \\left(-\\frac{k_s v_0}{M} \\tau\\right) d\\tau = -\\frac{k_s v_0}{2M} t^2$$\n    $$\\Delta x(H) = \\int_0^H \\Delta \\dot{x}(t) dt = \\int_0^H \\left(-\\frac{k_s v_0}{2M} t^2\\right) dt = -\\frac{k_s v_0}{2M} \\left[\\frac{t^3}{3}\\right]_0^H = -\\frac{k_s v_0 H^3}{6M}$$\n\n3.  **均方根（RMS）误差：**\n    位置误差 $\\Delta x(H)$ 取决于初始速度 $v_0$。我们需要通过对 $v_0$ 的热分布进行平均来找到均方根误差。RMS 误差为 $\\Delta x_{\\mathrm{rms}} = \\sqrt{\\langle (\\Delta x(H))^2 \\rangle}$。\n    $$\\langle (\\Delta x(H))^2 \\rangle = \\left\\langle \\left(-\\frac{k_s H^3}{6M} v_0\\right)^2 \\right\\rangle = \\left(\\frac{k_s H^3}{6M}\\right)^2 \\langle v_0^2 \\rangle$$\n    系统处于热平衡状态，因此速度遵循麦克斯韦-玻尔兹曼分布。对于一维模式，平均速度 $\\langle v_0 \\rangle = 0$。均方速度由 $\\langle v_0^2 \\rangle = v_{\\mathrm{rms}}^2$ 给出，其中 $v_{\\mathrm{rms}} = \\sqrt{k_B T / M}$ 是热均方根速度。\n    因此，$\\langle v_0^2 \\rangle = \\frac{k_B T}{M}$。\n    将此代入均方误差的表达式：\n    $$\\langle (\\Delta x(H))^2 \\rangle = \\left(\\frac{k_s H^3}{6M}\\right)^2 \\frac{k_B T}{M} = \\frac{k_s^2 H^6 k_B T}{36 M^3}$$\n    取平方根得到 RMS 位置误差：\n    $$\\Delta x_{\\mathrm{rms}} = \\sqrt{\\frac{k_s^2 H^6 k_B T}{36 M^3}} = \\frac{k_s H^3 \\sqrt{k_B T}}{6 M^{3/2}}$$\n\n4.  **数值计算：**\n    首先，我们将所有给定值转换为国际单位制（SI）基本单位。\n    - $k_s = 8 \\ \\mathrm{N} \\ \\mathrm{m}^{-1} = 8 \\ \\mathrm{kg} \\cdot \\mathrm{s}^{-2}$。\n    - $H = m h = 5 \\times (2 \\times 10^{-15} \\ \\mathrm{s}) = 10^{-14} \\ \\mathrm{s}$。\n    - $M = 14 \\ \\mathrm{amu} = 14 \\times 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg} = 2.32475469324 \\times 10^{-26} \\ \\mathrm{kg}$。\n    - $k_B T = (1.380649 \\times 10^{-23} \\ \\mathrm{J} \\ \\mathrm{K}^{-1}) \\times (300 \\ \\mathrm{K}) = 4.141947 \\times 10^{-21} \\ \\mathrm{J}$。\n    \n    现在，我们计算 $\\Delta x_{\\mathrm{rms}}$ 表达式中的各项：\n    - $k_s H^3 = (8 \\ \\mathrm{kg} \\cdot \\mathrm{s}^{-2}) \\times (10^{-14} \\ \\mathrm{s})^3 = 8 \\times 10^{-42} \\ \\mathrm{kg} \\cdot \\mathrm{s}$。\n    - $\\sqrt{k_B T} = \\sqrt{4.141947 \\times 10^{-21} \\ \\mathrm{J}} \\approx 6.435796 \\times 10^{-11} \\ \\mathrm{J}^{1/2}$。\n    - $M^{3/2} = (2.32475469324 \\times 10^{-26} \\ \\mathrm{kg})^{3/2} \\approx 1.120700 \\times 10^{-37} \\ \\mathrm{kg}^{3/2}$。\n    - $6 M^{3/2} \\approx 6 \\times 1.120700 \\times 10^{-37} \\ \\mathrm{kg}^{3/2} = 6.724200 \\times 10^{-37} \\ \\mathrm{kg}^{3/2}$。\n\n    将这些值代入 $\\Delta x_{\\mathrm{rms}}$ 的公式中：\n    $$\\Delta x_{\\mathrm{rms}} = \\frac{(8 \\times 10^{-42} \\ \\mathrm{kg} \\cdot \\mathrm{s}) \\times (6.435796 \\times 10^{-11} \\ \\mathrm{J}^{1/2})}{6.724200 \\times 10^{-37} \\ \\mathrm{kg}^{3/2}}$$\n    回想一下，$1 \\ \\mathrm{J} = 1 \\ \\mathrm{kg} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{s}^{-2}$，所以 $1 \\ \\mathrm{J}^{1/2} = 1 \\ \\mathrm{kg}^{1/2} \\cdot \\mathrm{m} \\cdot \\mathrm{s}^{-1}$：\n    $$\\Delta x_{\\mathrm{rms}} = \\frac{5.148637 \\times 10^{-52} \\ \\mathrm{kg}^{3/2} \\cdot \\mathrm{m}}{6.724200 \\times 10^{-37} \\ \\mathrm{kg}^{3/2}} \\approx 0.76568 \\times 10^{-15} \\ \\mathrm{m}$$\n    呃，有必要使用 $v_{\\mathrm{rms}}$ 对推导过程进行复核。\n    $\\Delta x_{\\mathrm{rms}} = \\frac{k_s H^3}{6M} v_{\\mathrm{rms}}$。\n    $v_{\\mathrm{rms}} = \\sqrt{k_B T / M} = \\sqrt{(4.141947 \\times 10^{-21}) / (2.32475... \\times 10^{-26})} \\approx 422.10 \\ \\mathrm{m/s}$。\n    $\\frac{k_s H^3}{6M} = \\frac{8 \\times (10^{-14})^3}{6 \\times 2.32475... \\times 10^{-26}} = \\frac{8 \\times 10^{-42}}{1.39485... \\times 10^{-25}} \\approx 5.7356... \\times 10^{-17} \\ \\mathrm{s}$。\n    $\\Delta x_{\\mathrm{rms}} = (5.7356... \\times 10^{-17} \\ \\mathrm{s}) \\times (422.10 \\ \\mathrm{m/s}) \\approx 2.4208 \\times 10^{-14} \\ \\mathrm{m}$。\n    \n    问题要求误差以纳米（$1 \\ \\mathrm{nm} = 10^{-9} \\ \\mathrm{m}$）为单位。\n    $$\\Delta x_{\\mathrm{rms}} = 2.4208 \\times 10^{-14} \\ \\mathrm{m} \\times \\frac{1 \\ \\mathrm{nm}}{10^{-9} \\ \\mathrm{m}} = 2.4208 \\times 10^{-5} \\ \\mathrm{nm}$$\n    四舍五入到三位有效数字，得到 $\\Delta x_{\\mathrm{rms}} = 2.42 \\times 10^{-5} \\ \\mathrm{nm}$。\n\n最终结果总结：\n- 加速因子 $S$，四舍五入到三位有效数字：$3.40$。\n- RMS 位置误差 $\\Delta x_{\\mathrm{rms}}$，以纳米为单位，四舍五入到三位有效数字：$2.42 \\times 10^{-5}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 3.40 & 2.42 \\times 10^{-5} \\end{pmatrix} } $$"
        },
        {
            "introduction": "一个稳定的模拟并不自动保证能得到物理上准确的结果，特别是对于动力学性质而言。本练习  探讨了一个微妙但至关重要的事实：由于其“影子哈密顿量”的特性，Verlet 积分会在诸如扩散系数等性质的计算中引入系统性的、依赖于 $\\Delta t$ 的偏差。你将学会识别这种效应，并应用严谨的外推方案来获得能够反映物理模型真实连续时间动力学的结果。",
            "id": "3857341",
            "problem": "一项计算化学生物学研究旨在从使用速度Verlet积分器在固定粒子数、体积和温度（恒定$N$、$V$、$T$）下生成的分子动力学轨迹中确定块体水的自扩散常数$D$，该条件被称为正则系综（NVT系综）。研究团队注意到，即使所有其他设置（力场、截断方案、约束、恒温器参数）保持不变，且轨迹足够长以减少统计不确定性，基于爱因斯坦关系式和格林-久保关系式对$D$的估计值仍会随着积分器时间步长$\\Delta t$系统地变化。\n\n哪个选项最能解释这种敏感性的来源，并概述一个科学上合理的方法，以在使用基于Verlet的轨迹时，在$\\Delta t \\to 0$的极限下获得$D$的一致估计值？\n\nA. 诸如$D$之类的输运系数仅取决于平衡构型采样，而NVT系综无论$\\Delta t$如何都能提供这种采样。观察到的对$\\Delta t$的依赖性纯粹是统计性的。正确的方案是在任何稳定的$\\Delta t$下运行单次模拟，并通过增加轨迹长度来减少误差；不需要外推。\n\nB. 速度Verlet是牛顿动力学的一种二阶、辛、时间可逆的离散化方法，它通过遵循一个依赖于$\\Delta t$的影子哈密顿量来改变短时微观动力学。因为$D$由速度自相关函数的积分和均方位移的长时间斜率决定，而这两者都受短时动力学控制，所以$D$会因离散化和离散时间求积而获得一个主要的$\\mathcal{O}(\\Delta t^2)$偏差。一个一致的方案是保持系综和所有参数固定，计算几个不同$\\Delta t$值下的$D(\\Delta t)$（例如，使用格林-久保积分和一个精确的离散求积法，或使用爱因斯坦关系式和仔细的长时间线性拟合），然后通过将$D(\\Delta t)$拟合到$D_0 + c_2 \\Delta t^2 + c_4 \\Delta t^4$来进行理查森式外推，并将$D_0$作为$\\Delta t \\to 0$的估计值报告。\n\nC. 这种敏感性是因为Verlet积分器低估了瞬时速率，这可以通过在每一步将速度乘以一个因子$f(\\Delta t)$来校正。方案是在一个方便的$\\Delta t$下执行单次模拟，计算$D$，然后将其乘以一个由恒温器设置决定的线性校正因子$1 - \\alpha \\Delta t$。\n\nD. 对于Verlet积分器，$D$中的主要离散化误差与$\\Delta t$成线性关系，因此使用两次模拟进行$\\Delta t$的线性外推就足够了。为了抑制相关性赝象，应使用强耦合恒温器，这消除了考虑短时动力学的需要。\n\nE. Verlet积分器的影子哈密顿量特性使得能量在离散时间内精确守恒，因此输运系数与$\\Delta t$无关。正确的方案是切换到非辛积分器，如显式欧拉法，以避免影子哈密顿量，从而无需外推即可消除$\\Delta t$敏感性。",
            "solution": "经典分子模拟中的控制动力学遵循牛顿第二定律，$m \\,\\ddot{\\mathbf{r}}(t) = \\mathbf{F}(\\mathbf{r}(t))$，以及运动学定义$\\mathbf{v}(t) = \\dot{\\mathbf{r}}(t)$和$\\dot{\\mathbf{v}}(t) = \\mathbf{a}(t)$。在$d$个空间维度中，一个标记粒子的自扩散常数$D$可以通过两个基本关系式等效地定义：\n\n1. 爱因斯坦关系式：\n$$\nD \\;=\\; \\lim_{t \\to \\infty} \\frac{1}{2 d} \\frac{d}{dt}\\,\\left\\langle \\big\\lvert \\mathbf{r}(t) - \\mathbf{r}(0) \\big\\rvert^2 \\right\\rangle,\n$$\n其中$\\langle \\cdot \\rangle$表示系综平均或时间平均。\n\n2. 格林-久保关系式：\n$$\nD \\;=\\; \\int_{0}^{\\infty} \\left\\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\right\\rangle \\, dt,\n$$\n其中被积函数是速度自相关函数。\n\n这两个表达式都表明，$D$由粒子速度及其随时间的关联决定。特别是，$D$的积分主要由$\\langle \\mathbf{v}(0)\\cdot\\mathbf{v}(t)\\rangle$的短时行为决定，而离散化对轨迹的影响在这一部分最强。\n\n速度Verlet离散化通过一个有限的时间步长$\\Delta t$来推进位置和速度。对$\\mathbf{r}(t)$和$\\mathbf{v}(t)$在时间$t$附近进行泰勒展开，可以发现对于平滑的力，位置的局部截断误差为$\\mathcal{O}(\\Delta t^3)$，轨迹的全局误差为$\\mathcal{O}(\\Delta t^2)$。此外，速度Verlet是辛的且时间可逆的，这意味着它精确地演化一个邻近的“影子”哈密顿量，\n$$\nH_{\\mathrm{sh}} \\;=\\; H \\;+\\; \\Delta t^2\\, H_2 \\;+\\; \\mathcal{O}(\\Delta t^4),\n$$\n其中$H$是物理哈密顿量，$H_2$则包含了对微观动力学的系统性$\\Delta t^2$修正（例如，轻微偏移的振动频率）。当$\\Delta t \\to 0$时，这些修正是可以忽略的，但在有限的$\\Delta t$下它们不为零。因此，任何依赖于动力学关联的性质——速度自相关函数的积分或均方位移的时间导数——都会获得一个对于二阶积分器而言按$\\mathcal{O}(\\Delta t^2)$标度的系统性偏差。\n\n另外，当数值计算格林-久保积分时，人们会用离散求积法（如在间距为$\\Delta t$的网格上使用梯形法则）来代替时间积分。对于足够平滑的自相关函数，梯形法则的误差也按$\\mathcal{O}(\\Delta t^2)$标度。同样地，当从离散时间数据估计爱因斯坦关系式中的斜率时，在考虑统计不确定性之前，有限差分近似会引入$\\mathcal{O}(\\Delta t^2)$的偏差。因此，存在两个$\\mathcal{O}(\\Delta t^2)$误差源：由影子哈密顿量引起的改变了的动力学，以及离散时间的求积或微分。\n\n这些考虑催生了一种在$\\Delta t \\to 0$极限下获得$D$的方案：\n\n- 保持物理模型和系综在所有运行中固定不变，包括力场、截断方案、约束和恒温器参数。可以使用弱耦合恒温器在恒定粒子数、体积、温度（NVT）下维持温度，同时对动力学扰动最小；或者，可以采用微正则系综（NVE），其中初始速度从麦克斯韦-玻尔兹曼分布中抽取，以实现纯粹的哈密顿动力学。\n\n- 选择几个在稳定范围内且小到足以进行精确积分的时间步长$\\Delta t$（例如，对于水，根据约束条件，通常使用$0.5$到$2.0$ $\\mathrm{fs}$量级的$\\Delta t$）。对于每个$\\Delta t$，生成足够长的轨迹以减少统计不确定性。\n\n- 对所有$\\Delta t$值，以一致的方式计算$D(\\Delta t)$，可以使用以下任一方法：\n  • 格林-久保关系式：估计$\\left\\langle \\mathbf{v}(0)\\cdot\\mathbf{v}(t)\\right\\rangle$并用精确的离散求积法（例如，梯形法则）对其进行积分，直到自相关函数衰减到可以忽略的值。\n  • 爱因斯坦关系式：估计$\\left\\langle \\lvert \\mathbf{r}(t)-\\mathbf{r}(0)\\rvert^2 \\right\\rangle$并在扩散区域对其增长进行线性拟合以提取斜率。\n  在两种情况下，都应使用多个时间原点并消除任何残余的质心漂移以避免偏差。\n\n- 将$D(\\Delta t)$拟合到一个关于$\\Delta t$的偶次多项式，这与Verlet积分器的二阶性质和时间可逆性一致：\n$$\nD(\\Delta t) \\;=\\; D_0 \\;+\\; c_2\\, \\Delta t^2 \\;+\\; c_4\\, \\Delta t^4,\n$$\n并提取$D_0$作为$D$在$\\Delta t \\to 0$时的估计值。这是一种针对预期误差结构量身定制的理查森式外推。\n\n- 如果需要有限尺寸流体动力学校正（例如，为了在周期性边界条件下与实验进行比较），应在$\\Delta t \\to 0$外推之后将它们应用于$D_0$，而不是分别应用于每个$D(\\Delta t)$，以避免混合离散化偏差和有限尺寸偏差。\n\n通过这种有原则的方法，可以将离散化引起的偏差与统计不确定性以及真实的物理校正分离开来，从而得到一个稳健的$D$估计值。\n\n逐项分析：\n\nA. 该选项声称$D$仅取决于构型采样，与$\\Delta t$无关。这与格林-久保和爱因斯坦的定义相矛盾，因为这些定义依赖于速度及其时间关联。在实践中，辛离散化通过影子哈密顿量改变了短时动力学，而离散求积增加了$\\mathcal{O}(\\Delta t^2)$的偏差。将系统的$\\Delta t$依赖性视为“纯粹是统计性的”是错误的。结论：错误。\n\nB. 该选项认识到速度Verlet是二阶、辛、时间可逆的，并正确地指出了输运性质中系统性$\\mathcal{O}(\\Delta t^2)$偏差的来源，这些偏差既来自于改变了的微观动力学，也来自于离散时间的数值计算。它给出了一个合理的方案：固定的系综和参数，通过任一基本定义计算$D(\\Delta t)$，并对$\\Delta t$的偶数次幂进行理查森式外推以获得$D_0$。结论：正确。\n\nC. 该选项建议通过一个因子$f(\\Delta t)$进行临时的速度重标定，并进行线性校正$1 - \\alpha \\Delta t$。不存在一个普适的、与恒温器无关的标量重标定可以恢复连续时间动力学；输运系数不能通过简单的速率重标定来校正，因为受影响的是时间关联，而不仅仅是瞬时速率。所提出的与$\\Delta t$成线性的校正与二阶、时间可逆积分器的预期偶次幂误差结构相矛盾。结论：错误。\n\nD. 该选项断言主导误差为$\\mathcal{O}(\\Delta t)$，并建议使用强耦合恒温器来“抑制关联”。对于像Verlet这样的辛、时间可逆的二阶方法，主导误差是$\\Delta t$的偶数次幂，通常为$\\mathcal{O}(\\Delta t^2)$。强耦合恒温器会改变物理的动力学关联，并可能使测得的$D$依赖于恒温器，从而破坏了向牛顿动力学进行有意义外推的基础。结论：错误。\n\nE. 该选项认为影子哈密顿量使得能量在“离散时间内精确守恒”，这意味着输运系数与$\\Delta t$无关，并建议切换到非辛积分器以消除$\\Delta t$敏感性。影子哈密顿量意味着一个修正的哈密顿量的近似守恒，而不是物理哈密顿量；它们不保证输运性质与$\\Delta t$无关。非辛积分器（如显式欧拉法）的稳定性和准确性更差，通常会引入而不是消除更大的偏差。结论：错误。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}