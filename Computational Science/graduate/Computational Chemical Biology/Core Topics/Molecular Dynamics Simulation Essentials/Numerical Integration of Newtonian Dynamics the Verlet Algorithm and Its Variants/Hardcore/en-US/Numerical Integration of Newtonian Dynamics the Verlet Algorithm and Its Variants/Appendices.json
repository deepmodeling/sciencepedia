{
    "hands_on_practices": [
        {
            "introduction": "The stability of any numerical integrator, including the Verlet algorithm, is fundamentally limited by the fastest motions present in the physical system being simulated. This exercise provides a direct, hands-on application of the linear stability condition that governs the velocity Verlet integrator. By calculating the maximum permissible time step, $\\Delta t$, for a realistic biomolecular system where high-frequency motions are constrained, you will gain a concrete understanding of how molecular properties dictate essential simulation parameters .",
            "id": "3857340",
            "problem": "A membrane protein embedded in explicit liquid water is simulated using Molecular Dynamics (MD) with a velocity Verlet integrator. All covalent bonds involving hydrogen are constrained, but angles are not constrained. Under the harmonic small-oscillation approximation around a potential energy minimum, the dynamics of each normal mode is governed by Newton’s second law, and the fastest mode controls the linear stability requirement of the time integrator. To ensure a target stability margin, impose the constraint $\\,\\omega_{\\max}\\,\\Delta t < \\beta\\,$ with $\\,\\beta < 2\\,$. For this protein–water system with constraints on bonds to hydrogen, assume the highest remaining vibrational wavenumbers are the peptide carbonyl stretch at $1650\\,\\mathrm{cm}^{-1}$ and the water bending mode at $1595\\,\\mathrm{cm}^{-1}$. Take the speed of light to be $\\,c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}\\,$ and set the target margin parameter to $\\,\\beta = 1.3\\,$. Using physically justified reasoning from first principles, determine the maximum allowable time step $\\,\\Delta t\\,$ that satisfies the margin. Express your final answer in femtoseconds, and round your answer to three significant figures.",
            "solution": "The problem statement has been validated and is determined to be a well-posed, scientifically grounded problem in the field of computational chemical biology. All necessary data are provided, the premises are consistent with established principles of molecular dynamics simulations and numerical analysis, and the objective is clearly defined.\n\nThe core of the problem lies in the linear stability analysis of the velocity Verlet integrator when applied to a harmonic oscillator. For a one-dimensional harmonic oscillator with equation of motion $\\ddot{x} = -\\omega^2 x$, the velocity Verlet algorithm is stable if and only if the product of the angular frequency $\\omega$ and the time step $\\Delta t$ satisfies the condition $\\omega \\Delta t \\le 2$. The problem provides a more stringent stability condition with a target margin parameter $\\beta$:\n$$\n\\omega_{\\max}\\,\\Delta t < \\beta\n$$\nHere, $\\omega_{\\max}$ is the highest angular frequency present in the dynamical system. The goal is to find the maximum allowable time step, $\\Delta t_{\\max}$, which corresponds to the equality in the limiting case:\n$$\n\\Delta t_{\\max} = \\frac{\\beta}{\\omega_{\\max}}\n$$\nThe angular frequency $\\omega$ (in radians per second) is related to the frequency $\\nu$ (in Hertz, or $\\mathrm{s}^{-1}$) by $\\omega = 2\\pi\\nu$. The frequency $\\nu$ is related to the wavenumber $\\tilde{\\nu}$ (in $\\mathrm{cm}^{-1}$) and the speed of light $c$ (in $\\mathrm{cm/s}$) by the relation $\\nu = c\\tilde{\\nu}$. Combining these, we obtain the direct relationship between angular frequency and wavenumber:\n$$\n\\omega = 2\\pi c \\tilde{\\nu}\n$$\nThe stability condition is determined by the fastest vibrational mode in the system, which corresponds to the mode with the highest angular frequency, $\\omega_{\\max}$, and thus the highest wavenumber, $\\tilde{\\nu}_{\\max}$. The problem states that all covalent bonds involving hydrogen atoms are constrained. This standard technique in molecular dynamics simulations (e.g., using algorithms like SHAKE or LINCS) effectively removes the highest-frequency motions from the system, which are the bond-stretching vibrations involving the light hydrogen atom (typically with wavenumbers greater than $3000\\,\\mathrm{cm}^{-1}$).\n\nAfter applying these constraints, the problem specifies that the highest remaining vibrational wavenumbers are from the peptide carbonyl (C=O) stretch, $\\tilde{\\nu}_1 = 1650\\,\\mathrm{cm}^{-1}$, and the water molecule's bending mode, $\\tilde{\\nu}_2 = 1595\\,\\mathrm{cm}^{-1}$. The limiting factor for the time step is the larger of these two wavenumbers.\n$$\n\\tilde{\\nu}_{\\max} = \\max(\\tilde{\\nu}_1, \\tilde{\\nu}_2) = \\max(1650\\,\\mathrm{cm}^{-1}, 1595\\,\\mathrm{cm}^{-1}) = 1650\\,\\mathrm{cm}^{-1}\n$$\nThe highest angular frequency in the system is therefore:\n$$\n\\omega_{\\max} = 2\\pi c \\tilde{\\nu}_{\\max}\n$$\nSubstituting this expression for $\\omega_{\\max}$ into the equation for $\\Delta t_{\\max}$ gives:\n$$\n\\Delta t_{\\max} = \\frac{\\beta}{2\\pi c \\tilde{\\nu}_{\\max}}\n$$\nWe are given the following values:\n\\begin{itemize}\n    \\item Target margin parameter: $\\beta = 1.3$\n    \\item Speed of light: $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}$\n    \\item Maximum wavenumber: $\\tilde{\\nu}_{\\max} = 1650\\,\\mathrm{cm}^{-1}$\n\\end{itemize}\nSubstituting these values into the equation for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{1.3}{2\\pi (2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}) (1650\\,\\mathrm{cm}^{-1})}\n$$\nThe units in the denominator are $(\\mathrm{cm/s}) \\cdot (\\mathrm{cm}^{-1}) = \\mathrm{s}^{-1}$, so the resulting unit for $\\Delta t_{\\max}$ will be seconds, as expected.\n$$\n\\Delta t_{\\max} = \\frac{1.3}{2\\pi (2.99792458 \\times 10^{10}) (1650)}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} \\approx \\frac{1.3}{3.1090604 \\times 10^{14}}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} \\approx 4.181205 \\times 10^{-15}\\,\\mathrm{s}\n$$\nThe problem requires the answer to be expressed in femtoseconds ($1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$). Therefore,\n$$\n\\Delta t_{\\max} \\approx 4.181205\\,\\mathrm{fs}\n$$\nFinally, we must round the answer to three significant figures.\n$$\n\\Delta t_{\\max} \\approx 4.18\\,\\mathrm{fs}\n$$\nThis value is a physically reasonable time step for molecular dynamics simulations of biomolecules where bonds to hydrogen are constrained. Such simulations commonly use a time step of $2\\,\\mathrm{fs}$. The calculated value of $4.18\\,\\mathrm{fs}$ represents a theoretical upper limit based on the fastest unconstrained mode and a specified safety margin, not a recommended practical value, which would also consider other factors like energy conservation accuracy.",
            "answer": "$$\\boxed{4.18}$$"
        },
        {
            "introduction": "To overcome the stringent time step limitations imposed by fast forces, advanced methods like the Reference System Propagator Algorithm (RESPA) employ a multiple-time-stepping strategy. This practice delves into the fundamental trade-off of such methods: the balance between computational speedup and the introduction of numerical error. You will derive and quantify both the efficiency gain and the leading-order position error for a model system, providing a clear, quantitative picture of the costs and benefits of this powerful integration technique .",
            "id": "3857311",
            "problem": "Consider an all-atom solvated protein system undergoing classical Newtonian dynamics, where the total deterministic force on each atom is decomposed into a rapidly varying component due to bonded and short-range nonbonded interactions and a slowly varying component due to long-range electrostatics computed with Particle-Mesh Ewald (PME). Let $M$ denote a representative atomic mass for a dominant low-frequency Cartesian normal mode of the protein backbone, and let the slow electrostatic contribution to the mode be approximated locally as a harmonic restoring force with effective curvature $k_{s}$, so that the slow force on the one-dimensional mode coordinate $x$ is $F_{s}(x) \\approx -k_{s} x$. The fast contribution is assumed to be handled accurately by the inner integrator.\n\nA two-level Reference System Propagator Algorithm (RESPA) is used with an inner time step $h$ for fast forces and a macrostep $H = m h$ for slow forces, where slow forces are evaluated only once every $m$ inner steps and held constant between slow updates. Assume the temperature is $T$, and that the representative mode is in thermal equilibrium so that the initial velocity $v_{0}$ is drawn from the Maxwell-Boltzmann distribution. Use Newton’s second law and a first-order local expansion of the true trajectory $x(t)$ about the beginning of a macrostep to quantify the leading-order effect of holding the slow force constant within a macrostep.\n\nYou are given:\n- Inner time step $h = 2 \\times 10^{-15} \\ \\mathrm{s}$ and slow-force stride $m = 5$, so $H = m h$.\n- Representative mode mass $M = 14 \\ \\mathrm{amu}$.\n- Slow curvature $k_{s} = 8 \\ \\mathrm{N} \\ \\mathrm{m}^{-1}$.\n- Temperature $T = 300 \\ \\mathrm{K}$.\n- Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J} \\ \\mathrm{K}^{-1}$.\n- Atomic mass unit conversion $1 \\ \\mathrm{amu} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$.\n- Per-evaluation computational costs: fast forces cost $c_{f} = 1.2$ (arbitrary time units per inner step) and slow forces cost $c_{s} = 9.0$ (same units per evaluation).\n\nStarting from Newton’s second law and the definition $v = dx/dt$, and using a first-order Taylor expansion to approximate $x(t)$ over a single macrostep, do the following:\n1. Derive and compute the speedup factor $S$ defined as the ratio of the total cost per macrostep for evaluating both fast and slow forces every inner step to the total cost per macrostep when slow forces are evaluated only once per macrostep and held constant in between.\n2. Derive an expression for the leading-order expected root-mean-square position error $\\Delta x_{\\mathrm{rms}}$ accumulated over a single macrostep $H$ arising solely from using a stale slow force within the macrostep. Model the slow-force error as the difference between the true slow acceleration $a_{s}(t)$ and the constant approximation $a_{s}^{\\mathrm{approx}}$ frozen at the macrostep start, and use the thermal root-mean-square velocity $v_{\\mathrm{rms}} = \\sqrt{k_{B} T / M}$ to obtain an expectation over the initial velocity. Compute the numerical value of $\\Delta x_{\\mathrm{rms}}$.\n\nExpress the speedup factor $S$ as a dimensionless number and the position error $\\Delta x_{\\mathrm{rms}}$ in nanometers. Round both $S$ and $\\Delta x_{\\mathrm{rms}}$ to three significant figures. Your final answer must be a single row matrix containing $S$ and $\\Delta x_{\\mathrm{rms}}$ in that order.",
            "solution": "The problem asks for two quantities related to the use of a RESPA multiple-time-stepping algorithm in a molecular dynamics simulation: the computational speedup factor $S$ and the root-mean-square position error $\\Delta x_{\\mathrm{rms}}$ over a single macrostep.\n\n### Part 1: Derivation and Computation of the Speedup Factor $S$\n\nThe speedup factor $S$ is defined as the ratio of the computational cost without RESPA to the cost with RESPA, over a single macrostep of duration $H$. The macrostep consists of $m$ inner time steps of duration $h$, so $H = m h$.\n\nThe computational costs per evaluation are given as $c_f$ for fast forces and $c_s$ for slow forces.\n\n1.  **Cost without RESPA (Single Time Step):**\n    If a single time step $h$ is used for all forces, both fast and slow forces must be computed at every step. Over a period equivalent to one macrostep ($H=mh$), there are $m$ inner steps.\n    The cost for one such step is $c_f + c_s$.\n    The total cost for $m$ steps, which corresponds to the duration of one macrostep, is:\n    $$C_{\\text{no-RESPA}} = m (c_f + c_s)$$\n\n2.  **Cost with RESPA:**\n    In the two-level RESPA scheme described, fast forces are evaluated at every inner step $h$, while slow forces are evaluated only once per macrostep $H$.\n    Over one macrostep, the fast forces are computed $m$ times, and the slow forces are computed once.\n    The total cost per macrostep is:\n    $$C_{\\text{RESPA}} = m c_f + c_s$$\n\n3.  **Speedup Factor $S$:**\n    The speedup factor $S$ is the ratio of these two costs:\n    $$S = \\frac{C_{\\text{no-RESPA}}}{C_{\\text{RESPA}}} = \\frac{m(c_f + c_s)}{m c_f + c_s}$$\n    Substituting the given numerical values: $m = 5$, $c_f = 1.2$, and $c_s = 9.0$ (in arbitrary units).\n    $$S = \\frac{5(1.2 + 9.0)}{5(1.2) + 9.0} = \\frac{5(10.2)}{6.0 + 9.0} = \\frac{51}{15} = 3.4$$\n    Rounding to three significant figures, the speedup factor is $S = 3.40$.\n\n### Part 2: Derivation and Computation of the RMS Position Error $\\Delta x_{\\mathrm{rms}}$\n\nThe error arises from holding the slow force constant over the macrostep $H$. The slow force is given by $F_s(x) = -k_s x$.\n\n1.  **Dynamics and Acceleration Error:**\n    According to Newton's second law, the slow component of acceleration is $a_s(t) = \\frac{F_s(x(t))}{M} = -\\frac{k_s}{M} x(t)$.\n    In the RESPA scheme, the slow acceleration is approximated as constant over the interval $t \\in [0, H]$, based on the position $x_0 = x(0)$ at the start of the macrostep:\n    $$a_s^{\\mathrm{approx}} = a_s(0) = -\\frac{k_s}{M} x_0$$\n    The error in the slow acceleration at time $t$ within the macrostep is the difference between the true and approximate accelerations:\n    $$\\Delta a_s(t) = a_s(t) - a_s^{\\mathrm{approx}} = -\\frac{k_s}{M} x(t) - \\left(-\\frac{k_s}{M} x_0\\right) = -\\frac{k_s}{M} (x(t) - x_0)$$\n    The problem specifies using a first-order Taylor expansion for the trajectory $x(t)$ to find the leading-order error. We expand $x(t)$ about $t=0$:\n    $$x(t) \\approx x_0 + v_0 t$$\n    where $v_0 = v(0)$ is the initial velocity. Substituting this into the acceleration error expression gives the leading-order error:\n    $$\\Delta a_s(t) \\approx -\\frac{k_s}{M} ( (x_0 + v_0 t) - x_0 ) = -\\frac{k_s v_0}{M} t$$\n\n2.  **Position Error Accumulation:**\n    The error in position, $\\Delta x(t)$, accumulates due to this error in acceleration. Assuming zero initial error in position and velocity, we can find the position error at the end of the macrostep, $\\Delta x(H)$, by integrating the acceleration error twice with respect to time from $t=0$ to $t=H$:\n    $$\\Delta \\dot{x}(t) = \\int_0^t \\Delta a_s(\\tau) d\\tau = \\int_0^t \\left(-\\frac{k_s v_0}{M} \\tau\\right) d\\tau = -\\frac{k_s v_0}{2M} t^2$$\n    $$\\Delta x(H) = \\int_0^H \\Delta \\dot{x}(t) dt = \\int_0^H \\left(-\\frac{k_s v_0}{2M} t^2\\right) dt = -\\frac{k_s v_0}{2M} \\left[\\frac{t^3}{3}\\right]_0^H = -\\frac{k_s v_0 H^3}{6M}$$\n\n3.  **Root-Mean-Square (RMS) Error:**\n    The position error $\\Delta x(H)$ depends on the initial velocity $v_0$. We need to find the root-mean-square error by averaging over the thermal distribution of $v_0$. The RMS error is $\\Delta x_{\\mathrm{rms}} = \\sqrt{\\langle (\\Delta x(H))^2 \\rangle}$.\n    $$\\langle (\\Delta x(H))^2 \\rangle = \\left\\langle \\left(-\\frac{k_s H^3}{6M} v_0\\right)^2 \\right\\rangle = \\left(\\frac{k_s H^3}{6M}\\right)^2 \\langle v_0^2 \\rangle$$\n    The system is in thermal equilibrium, so the velocities follow the Maxwell-Boltzmann distribution. For a one-dimensional mode, the mean velocity $\\langle v_0 \\rangle = 0$. The mean-square velocity is given by $\\langle v_0^2 \\rangle = v_{\\mathrm{rms}}^2$, where $v_{\\mathrm{rms}} = \\sqrt{k_B T / M}$ is the thermal root-mean-square velocity.\n    Thus, $\\langle v_0^2 \\rangle = \\frac{k_B T}{M}$.\n    The RMS error can be expressed as:\n    $$\\Delta x_{\\mathrm{rms}} = \\left| -\\frac{k_s H^3}{6M} \\right| \\sqrt{\\langle v_0^2 \\rangle} = \\frac{k_s H^3}{6M} v_{\\mathrm{rms}}$$\n\n4.  **Numerical Calculation:**\n    First, we convert all given values to base SI units.\n    - $k_s = 8 \\ \\mathrm{N} \\ \\mathrm{m}^{-1} = 8 \\ \\mathrm{kg} \\cdot \\mathrm{s}^{-2}$.\n    - $H = m h = 5 \\times (2 \\times 10^{-15} \\ \\mathrm{s}) = 10^{-14} \\ \\mathrm{s}$.\n    - $M = 14 \\ \\mathrm{amu} = 14 \\times 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg} \\approx 2.32475 \\times 10^{-26} \\ \\mathrm{kg}$.\n    - $k_B T = (1.380649 \\times 10^{-23} \\ \\mathrm{J} \\ \\mathrm{K}^{-1}) \\times (300 \\ \\mathrm{K}) \\approx 4.14195 \\times 10^{-21} \\ \\mathrm{J}$.\n    \n    We can calculate the RMS velocity first:\n    $$v_{\\mathrm{rms}} = \\sqrt{\\frac{k_B T}{M}} = \\sqrt{\\frac{4.14195 \\times 10^{-21} \\ \\mathrm{J}}{2.32475 \\times 10^{-26} \\ \\mathrm{kg}}} \\approx 422.1 \\ \\mathrm{m/s}$$\n    Next, we calculate the prefactor:\n    $$\\frac{k_s H^3}{6M} = \\frac{(8 \\ \\mathrm{kg} \\cdot \\mathrm{s}^{-2}) (10^{-14} \\ \\mathrm{s})^3}{6 (2.32475 \\times 10^{-26} \\ \\mathrm{kg})} = \\frac{8 \\times 10^{-42} \\ \\mathrm{kg} \\cdot \\mathrm{s}^3}{1.39485 \\times 10^{-25} \\ \\mathrm{kg}} \\approx 5.7356 \\times 10^{-17} \\ \\mathrm{s}$$\n    The RMS position error is the product of these two terms:\n    $$\\Delta x_{\\mathrm{rms}} \\approx (5.7356 \\times 10^{-17} \\ \\mathrm{s}) \\times (422.1 \\ \\mathrm{m/s}) \\approx 2.4208 \\times 10^{-14} \\ \\mathrm{m}$$\n    \n    The problem asks for the error in nanometers ($1 \\ \\mathrm{nm} = 10^{-9} \\ \\mathrm{m}$).\n    $$\\Delta x_{\\mathrm{rms}} = 2.4208 \\times 10^{-14} \\ \\mathrm{m} \\times \\frac{1 \\ \\mathrm{nm}}{10^{-9} \\ \\mathrm{m}} = 2.4208 \\times 10^{-5} \\ \\mathrm{nm}$$\n    Rounding to three significant figures gives $\\Delta x_{\\mathrm{rms}} = 2.42 \\times 10^{-5} \\ \\mathrm{nm}$.\n\nFinal summary of results:\n- Speedup factor $S$, rounded to three significant figures: $3.40$.\n- RMS position error $\\Delta x_{\\mathrm{rms}}$, in nanometers, rounded to three significant figures: $2.42 \\times 10^{-5}$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 3.40 & 2.42 \\times 10^{-5} \\end{pmatrix} } $$"
        },
        {
            "introduction": "A key feature of symplectic integrators like Verlet is that they do not perfectly replicate the original Newtonian dynamics, but rather exactly follow a nearby \"shadow\" trajectory with slightly altered properties. This advanced exercise involves a rigorous analytical derivation to uncover a systematic bias in a critical observable: the kinetic temperature, as estimated from a discrete leapfrog trajectory. By deriving the exact bias factor, you will develop a deeper appreciation for the subtle but important artifacts of numerical integration and understand how physical observables can be affected by the choice of algorithm .",
            "id": "3857354",
            "problem": "In computational molecular dynamics (MD), the kinetic temperature is typically defined by the equipartition theorem as $T = \\frac{2 \\langle K \\rangle}{f k_{B}}$, where $\\langle K \\rangle$ is the time (or ensemble) average kinetic energy, $f$ is the number of quadratic degrees of freedom, and $k_{B}$ is the Boltzmann constant. Consider a single classical particle of mass $m$ moving in one dimension in a harmonic potential $U(x) = \\frac{1}{2} m \\omega^{2} x^{2}$, so that Newton’s second law gives $m \\frac{d^{2} x}{d t^{2}} = - \\frac{d U}{d x} = - m \\omega^{2} x$. The position is integrated in time using the Störmer–Verlet (leapfrog) scheme with time step $h$, whose position update can be written as $x_{n+1} = 2 x_{n} - x_{n-1} + h^{2} a(x_{n})$, where $a(x) = - \\omega^{2} x$. Define the leapfrog “half-step” velocity estimator by $v_{n+\\frac{1}{2}} = \\frac{x_{n+1} - x_{n}}{h}$ and the corresponding one-dimensional kinetic temperature estimator by $T_{\\text{LF}} = \\frac{m \\langle v_{n+\\frac{1}{2}}^{2} \\rangle}{k_{B}}$ with $f=1$.\n\nStarting only from the foregoing fundamentals (Newton’s second law, the harmonic force, the Störmer–Verlet update, and the definition of the kinetic temperature), derive the exact multiplicative bias factor $B_{1/2}(\\omega h)$ by which $T_{\\text{LF}}$ differs from the kinetic temperature associated with the continuous-time velocity of the discrete trajectory’s sinusoidal motion, that is, the “shadow” kinetic temperature defined using the exact time derivative of the discrete sinusoid with its modified angular frequency. Express your final result as a closed-form analytic expression in terms of $\\omega h$, valid for $0 < \\omega h < 2$.\n\nAs part of your derivation, you should explicitly:\n- Solve the linear difference equation for $x_{n}$ and identify the per-step phase $\\theta$ as a function of $\\omega h$.\n- Relate the amplitude of $v_{n+\\frac{1}{2}}$ to that of the exact time derivative of the discrete sinusoid and compute the long-time averages needed for the temperature ratio.\n- State clearly the multiplicative bias factor $B_{1/2}(\\omega h)$ that satisfies $T_{\\text{LF}} = B_{1/2}(\\omega h) \\, T_{\\text{shadow}}$.\n\nYour final answer must be a single closed-form analytic expression for $B_{1/2}(\\omega h)$. No numerical rounding is required, and no physical units should be included in the final boxed answer.",
            "solution": "We begin by analyzing the discrete trajectory generated by the Störmer-Verlet integrator for the harmonic oscillator.\n\nThe position update rule is $x_{n+1} = 2 x_{n} - x_{n-1} + h^{2} a(x_{n})$. With the acceleration for the harmonic oscillator, $a(x_{n}) = -\\omega^{2} x_{n}$, the update rule becomes a linear difference equation:\n$$x_{n+1} = 2 x_{n} - x_{n-1} - h^{2} \\omega^{2} x_{n}$$\nRearranging the terms, we get:\n$$x_{n+1} - \\left(2 - (\\omega h)^{2}\\right) x_{n} + x_{n-1} = 0$$\nThis is a second-order linear homogeneous difference equation. We seek a solution of the form $x_{n} = C \\rho^{n}$. Substituting this into the equation yields the characteristic equation for $\\rho$:\n$$\\rho^{2} - \\left(2 - (\\omega h)^{2}\\right) \\rho + 1 = 0$$\nThe problem specifies the stability condition $0 < \\omega h < 2$. For this range, we have $-2 < 2 - (\\omega h)^2 < 2$. This implies the roots of the quadratic equation for $\\rho$ are a pair of complex conjugates on the unit circle. Let the roots be $e^{\\pm i\\theta}$, where $\\theta$ is the numerical phase advance per time step. The sum of the roots is $2 \\cos(\\theta)$, which must equal the coefficient of the linear term. Thus, we identify:\n$$2 \\cos(\\theta) = 2 - (\\omega h)^{2} \\implies \\cos(\\theta) = 1 - \\frac{(\\omega h)^{2}}{2}$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2 \\sin^{2}\\left(\\frac{\\theta}{2}\\right)$, we find:\n$$2 \\sin^{2}\\left(\\frac{\\theta}{2}\\right) = \\frac{(\\omega h)^{2}}{2} \\implies \\sin^{2}\\left(\\frac{\\theta}{2}\\right) = \\frac{(\\omega h)^{2}}{4}$$\nFor $0 < \\omega h < 2$, we have $0 < \\frac{\\omega h}{2} < 1$, which means $\\frac{\\theta}{2}$ is in the interval $(0, \\frac{\\pi}{2})$, so we can take the positive square root:\n$$\\sin\\left(\\frac{\\theta}{2}\\right) = \\frac{\\omega h}{2}$$\nThis gives the per-step phase as $\\theta = 2 \\arcsin\\left(\\frac{\\omega h}{2}\\right)$. The general real solution for the discrete position is a sinusoid:\n$$x_{n} = A \\cos(n\\theta + \\phi)$$\nwhere $A$ is the amplitude and $\\phi$ is a phase constant.\n\nThe \"shadow\" trajectory is the continuous sinusoid $x(t) = A \\cos(\\tilde{\\omega} t + \\phi)$ that passes through the discrete points $x_{n}$ at times $t = nh$. Comparing the arguments, we have $n\\theta = \\tilde{\\omega}(nh)$, which implies that the modified angular frequency of the shadow trajectory is:\n$$\\tilde{\\omega} = \\frac{\\theta}{h} = \\frac{2}{h} \\arcsin\\left(\\frac{\\omega h}{2}\\right)$$\n\nNext, we calculate the leapfrog temperature estimator $T_{\\text{LF}}$. It is defined using the half-step velocity $v_{n+\\frac{1}{2}} = \\frac{x_{n+1} - x_{n}}{h}$. Substituting the solution for $x_n$:\n$$v_{n+\\frac{1}{2}} = \\frac{A \\cos((n+1)\\theta + \\phi) - A \\cos(n\\theta + \\phi)}{h}$$\nUsing the trigonometric identity $\\cos(P) - \\cos(Q) = -2 \\sin\\left(\\frac{P+Q}{2}\\right) \\sin\\left(\\frac{P-Q}{2}\\right)$, we get:\n$$v_{n+\\frac{1}{2}} = \\frac{A}{h} \\left[ -2 \\sin\\left(n\\theta + \\frac{\\theta}{2} + \\phi\\right) \\sin\\left(\\frac{\\theta}{2}\\right) \\right]$$\nSubstituting $\\sin(\\frac{\\theta}{2}) = \\frac{\\omega h}{2}$:\n$$v_{n+\\frac{1}{2}} = \\frac{A}{h} \\left[ -2 \\sin\\left(n\\theta + \\frac{\\theta}{2} + \\phi\\right) \\left(\\frac{\\omega h}{2}\\right) \\right] = -A\\omega \\sin\\left(n\\theta + \\frac{\\theta}{2} + \\phi\\right)$$\nThe estimator $T_{\\text{LF}} = \\frac{m \\langle v_{n+\\frac{1}{2}}^{2} \\rangle}{k_{B}}$ requires the long-time average of $v_{n+\\frac{1}{2}}^{2}$.\n$$\\langle v_{n+\\frac{1}{2}}^{2} \\rangle = \\langle \\left(-A\\omega \\sin\\left(n\\theta + \\frac{\\theta}{2} + \\phi\\right)\\right)^{2} \\rangle = (A\\omega)^{2} \\langle \\sin^{2}\\left(n\\theta + \\frac{\\theta}{2} + \\phi\\right) \\rangle$$\nThe long-time average of $\\sin^{2}(\\cdot)$ is $\\frac{1}{2}$. Therefore:\n$$\\langle v_{n+\\frac{1}{2}}^{2} \\rangle = \\frac{1}{2} (A\\omega)^{2}$$\nSo, the leapfrog temperature estimator is:\n$$T_{\\text{LF}} = \\frac{m}{k_{B}} \\left( \\frac{1}{2} (A\\omega)^{2} \\right) = \\frac{m (A\\omega)^{2}}{2 k_{B}}$$\n\nNow we determine the shadow temperature, $T_{\\text{shadow}}$. This is based on the exact time derivative of the shadow trajectory $x(t) = A \\cos(\\tilde{\\omega} t + \\phi)$. The shadow velocity is:\n$$v_{\\text{shadow}}(t) = \\frac{d x(t)}{d t} = -A\\tilde{\\omega} \\sin(\\tilde{\\omega} t + \\phi)$$\nThe time average of the squared shadow velocity is:\n$$\\langle v_{\\text{shadow}}^{2} \\rangle = \\langle (-A\\tilde{\\omega} \\sin(\\tilde{\\omega} t + \\phi))^{2} \\rangle = (A\\tilde{\\omega})^{2} \\langle \\sin^{2}(\\tilde{\\omega} t + \\phi) \\rangle = \\frac{1}{2} (A\\tilde{\\omega})^{2}$$\nThe shadow temperature is defined by the same equipartition principle:\n$$T_{\\text{shadow}} = \\frac{m \\langle v_{\\text{shadow}}^{2} \\rangle}{k_{B}} = \\frac{m}{k_{B}} \\left( \\frac{1}{2} (A\\tilde{\\omega})^{2} \\right) = \\frac{m(A\\tilde{\\omega})^{2}}{2 k_{B}}$$\n\nFinally, we compute the multiplicative bias factor $B_{1/2}(\\omega h)$ from the relation $T_{\\text{LF}} = B_{1/2}(\\omega h) \\, T_{\\text{shadow}}$.\n$$B_{1/2}(\\omega h) = \\frac{T_{\\text{LF}}}{T_{\\text{shadow}}} = \\frac{\\frac{m (A\\omega)^{2}}{2 k_{B}}}{\\frac{m(A\\tilde{\\omega})^{2}}{2 k_{B}}} = \\left(\\frac{\\omega}{\\tilde{\\omega}}\\right)^{2}$$\nSubstituting the expression for the modified frequency $\\tilde{\\omega} = \\frac{2}{h} \\arcsin\\left(\\frac{\\omega h}{2}\\right)$:\n$$B_{1/2}(\\omega h) = \\left( \\frac{\\omega}{\\frac{2}{h} \\arcsin\\left(\\frac{\\omega h}{2}\\right)} \\right)^{2} = \\left( \\frac{\\omega h}{2 \\arcsin\\left(\\frac{\\omega h}{2}\\right)} \\right)^{2}$$\nThis can be written more cleanly as:\n$$B_{1/2}(\\omega h) = \\left( \\frac{\\frac{\\omega h}{2}}{\\arcsin\\left(\\frac{\\omega h}{2}\\right)} \\right)^{2}$$\nThis is the final expression for the multiplicative bias factor for the specified leapfrog velocity estimator. As a check, in the limit $h \\to 0$, we have $\\frac{\\omega h}{2} \\to 0$. Since $\\arcsin(z) \\approx z$ for small $z$, the ratio inside the parentheses approaches $1$, and thus $B_{1/2}(\\omega h) \\to 1$, which is the correct behavior for an exact integrator.",
            "answer": "$$\\boxed{\\left( \\frac{\\frac{\\omega h}{2}}{\\arcsin\\left(\\frac{\\omega h}{2}\\right)} \\right)^{2}}$$"
        }
    ]
}