{
    "hands_on_practices": [
        {
            "introduction": "求解耦合的非线性方程组（如泊松-能斯特-普朗克方程组）时，隐式方法是保证数值稳定性的关键。本练习将指导你推导这些方程组在有限差分离散后所得到的雅可比矩阵的各个项，这是构建牛顿法等强大求解器的核心步骤。通过这个实践，你将深刻理解浓度 $c$ 和电势 $\\phi$ 之间复杂的耦合关系如何在离散层面体现。",
            "id": "4245958",
            "problem": "考虑一个一维二元电解质模型，用于描述长度为 $L$ 的平板中价态为 $z$、浓度为 $c(x,t)$、静电势为 $\\phi(x,t)$ 的单一离子种类。离子输运由质量守恒与 Nernst–Planck 通量耦合控制，静电势满足 Poisson 方程。基本方程组如下：\n- 质量守恒：$\\frac{\\partial c}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0$。\n- Nernst–Planck 通量（扩散加迁移）：$J = - D \\frac{\\partial c}{\\partial x} - z u\\, c\\, \\frac{\\partial \\phi}{\\partial x}$，其中 $D$ 是扩散系数，$u$ 是离子迁移率。\n- Poisson 方程：$- \\varepsilon \\frac{\\partial^{2} \\phi}{\\partial x^{2}} = q z c + \\rho_{f}(x)$，其中 $\\varepsilon$ 是介电常数，$q$ 是基本电荷量，$\\rho_{f}(x)$ 是给定的固定电荷密度。\n\n在间距为 $h$、节点索引为 $k \\in \\{1,2,\\ldots,N\\}$ 的均匀网格上对区域进行离散化。使用一个从时间层 $n$ 到 $n+1$ 的全隐式后向欧拉步，并将时间 $n+1$ 的未知量定义为 $c_{k}$ 和 $\\phi_{k}$。使用中心差分和算术平均的两点界面通量：\n- 界面浓度：$c_{k+1/2} = \\frac{c_{k+1} + c_{k}}{2}$ 和 $c_{k-1/2} = \\frac{c_{k} + c_{k-1}}{2}$。\n- 界面电势差：$\\Delta \\phi_{k+1/2} = \\phi_{k+1} - \\phi_{k}$ 和 $\\Delta \\phi_{k-1/2} = \\phi_{k} - \\phi_{k-1}$。\n- 离散通量：\n$$\nJ_{k+1/2} = - D \\frac{c_{k+1} - c_{k}}{h} - z u\\, c_{k+1/2}\\, \\frac{\\Delta \\phi_{k+1/2}}{h}, \\quad\nJ_{k-1/2} = - D \\frac{c_{k} - c_{k-1}}{h} - z u\\, c_{k-1/2}\\, \\frac{\\Delta \\phi_{k-1/2}}{h}.\n$$\n将内部节点 $k$ 处的残差定义为\n$$\nR_{k}(c,\\phi) = \\frac{c_{k} - c_{k}^{n}}{\\Delta t} + \\frac{J_{k+1/2} - J_{k-1/2}}{h}, \\qquad\nP_{k}(c,\\phi) = - \\varepsilon \\frac{\\phi_{k+1} - 2 \\phi_{k} + \\phi_{k-1}}{h^{2}} - q z c_{k} - \\rho_{f,k}.\n$$\n\n您将组装耦合系统的牛顿线性化。从给定的控制定律和所述的离散格式出发，推导界面通量中迁移贡献项关于相邻节点上的 $c$ 和 $\\phi$ 的解析偏导数，然后组装 $R_{k}$ 关于 $c_{k-1}$、$c_{k}$、$c_{k+1}$、$\\phi_{k-1}$、$\\phi_{k}$ 和 $\\phi_{k+1}$ 的雅可比矩阵元。同时确定 $P_{k}$ 关于 $c_{k}$、$\\phi_{k-1}$、$\\phi_{k}$ 和 $\\phi_{k+1}$ 的雅可比矩阵元。\n\n最后，提供雅可比矩阵元 $\\frac{\\partial R_{k}}{\\partial \\phi_{k}}$ 关于 $z$、$u$、$h$、$c_{k-1}$、$c_{k}$ 和 $c_{k+1}$ 的显式闭合形式表达式。将您的最终答案表示为单个解析表达式。无需进行数值计算或四舍五入。",
            "solution": "出发点是单一离子种类的质量守恒与 Nernst-Planck 通量耦合以及 Poisson 方程。对于间距为 $h$ 的均匀网格，内部节点 $k$ 处的全隐式残差为\n$$\nR_{k}(c,\\phi) = \\frac{c_{k} - c_{k}^{n}}{\\Delta t} + \\frac{J_{k+1/2} - J_{k-1/2}}{h},\n$$\n$$\nP_{k}(c,\\phi) = - \\varepsilon \\frac{\\phi_{k+1} - 2 \\phi_{k} + \\phi_{k-1}}{h^{2}} - q z c_{k} - \\rho_{f,k}.\n$$\n离散界面通量包括扩散和迁移：\n$$\nJ_{k+1/2} = - D \\frac{c_{k+1} - c_{k}}{h} - z u\\, c_{k+1/2}\\, \\frac{\\Delta \\phi_{k+1/2}}{h}, \\quad c_{k+1/2} = \\frac{c_{k+1} + c_{k}}{2}, \\quad \\Delta \\phi_{k+1/2} = \\phi_{k+1} - \\phi_{k},\n$$\n$$\nJ_{k-1/2} = - D \\frac{c_{k} - c_{k-1}}{h} - z u\\, c_{k-1/2}\\, \\frac{\\Delta \\phi_{k-1/2}}{h}, \\quad c_{k-1/2} = \\frac{c_{k} + c_{k-1}}{2}, \\quad \\Delta \\phi_{k-1/2} = \\phi_{k} - \\phi_{k-1}.\n$$\n\n我们首先计算界面通量中迁移贡献项关于 $c$ 和 $\\phi$ 的偏导数。将迁移部分表示为\n$$\nJ_{k+1/2}^{\\text{mig}} = - z u\\, c_{k+1/2}\\, \\frac{\\Delta \\phi_{k+1/2}}{h}, \\qquad\nJ_{k-1/2}^{\\text{mig}} = - z u\\, c_{k-1/2}\\, \\frac{\\Delta \\phi_{k-1/2}}{h}.\n$$\n\n$J_{k+1/2}^{\\text{mig}}$ 关于 $c_{k}$ 和 $c_{k+1}$ 的导数使用 $\\frac{\\partial c_{k+1/2}}{\\partial c_{k}} = \\frac{1}{2}$ 和 $\\frac{\\partial c_{k+1/2}}{\\partial c_{k+1}} = \\frac{1}{2}$，且 $\\Delta \\phi_{k+1/2}$ 与 $c$ 无关：\n$$\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial c_{k}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k+1/2}}{h}, \\qquad\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial c_{k+1}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k+1/2}}{h}.\n$$\n类似地，关于 $\\phi_{k}$ 和 $\\phi_{k+1}$ 的导数将 $c_{k+1/2}$ 视为常数并使用 $\\frac{\\partial \\Delta \\phi_{k+1/2}}{\\partial \\phi_{k}} = -1$，$\\frac{\\partial \\Delta \\phi_{k+1/2}}{\\partial \\phi_{k+1}} = 1$：\n$$\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial \\phi_{k}} = - z u\\, c_{k+1/2}\\, \\frac{(-1)}{h} = \\frac{z u}{h} c_{k+1/2}, \\qquad\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial \\phi_{k+1}} = - z u\\, c_{k+1/2}\\, \\frac{(1)}{h} = - \\frac{z u}{h} c_{k+1/2}.\n$$\n\n对于左侧界面：\n$$\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial c_{k}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k-1/2}}{h}, \\qquad\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial c_{k-1}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k-1/2}}{h},\n$$\n并使用 $\\frac{\\partial \\Delta \\phi_{k-1/2}}{\\partial \\phi_{k}} = 1$，$\\frac{\\partial \\Delta \\phi_{k-1/2}}{\\partial \\phi_{k-1}} = -1$：\n$$\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial \\phi_{k}} = - z u\\, c_{k-1/2}\\, \\frac{(1)}{h} = - \\frac{z u}{h} c_{k-1/2}, \\qquad\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial \\phi_{k-1}} = - z u\\, c_{k-1/2}\\, \\frac{(-1)}{h} = \\frac{z u}{h} c_{k-1/2}.\n$$\n\n为完整起见，包括界面通量导数的扩散贡献项，其仅依赖于 $c$：\n$$\n\\frac{\\partial}{\\partial c_{k}} \\left(- D \\frac{c_{k+1} - c_{k}}{h} \\right) = \\frac{D}{h}, \\quad\n\\frac{\\partial}{\\partial c_{k+1}} \\left(- D \\frac{c_{k+1} - c_{k}}{h} \\right) = - \\frac{D}{h},\n$$\n$$\n\\frac{\\partial}{\\partial c_{k}} \\left(- D \\frac{c_{k} - c_{k-1}}{h} \\right) = - \\frac{D}{h}, \\quad\n\\frac{\\partial}{\\partial c_{k-1}} \\left(- D \\frac{c_{k} - c_{k-1}}{h} \\right) = \\frac{D}{h},\n$$\n且关于 $\\phi$ 为零。\n\n现在组装 $R_{k}$ 关于局部模板 $\\{c_{k-1}, c_{k}, c_{k+1}, \\phi_{k-1}, \\phi_{k}, \\phi_{k+1}\\}$ 的雅可比矩阵元。根据定义，\n$$\nR_{k} = \\frac{c_{k} - c_{k}^{n}}{\\Delta t} + \\frac{1}{h} \\left(J_{k+1/2} - J_{k-1/2}\\right).\n$$\n因此，对于任意变量 $\\xi$，\n$$\n\\frac{\\partial R_{k}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{c_{k} - c_{k}^{n}}{\\Delta t} \\right) + \\frac{1}{h} \\left( \\frac{\\partial J_{k+1/2}}{\\partial \\xi} - \\frac{\\partial J_{k-1/2}}{\\partial \\xi} \\right).\n$$\n从时间项中，只有 $\\frac{\\partial R_{k}}{\\partial c_{k}}$ 增加了 $\\frac{1}{\\Delta t}$ 这一项。通量导数根据上述公式贡献。特别地，为满足包含关于 $c$ 和 $\\phi$ 的迁移导数的要求，我们明确指出，例如，\n$$\n\\frac{\\partial R_{k}}{\\partial c_{k}} \\supset \\frac{1}{h} \\left( - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k+1/2}}{h} - \\left[- z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k-1/2}}{h}\\right] \\right) = - \\frac{z u}{2 h^{2}} \\left( \\Delta \\phi_{k+1/2} - \\Delta \\phi_{k-1/2} \\right),\n$$\n并且，对于电势的依赖关系，\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{1}{h} \\left( \\frac{\\partial J_{k+1/2}}{\\partial \\phi_{k}} - \\frac{\\partial J_{k-1/2}}{\\partial \\phi_{k}} \\right),\n$$\n只有迁移部分有贡献：\n$$\n\\frac{\\partial J_{k+1/2}}{\\partial \\phi_{k}} = \\frac{z u}{h} c_{k+1/2}, \\qquad \\frac{\\partial J_{k-1/2}}{\\partial \\phi_{k}} = - \\frac{z u}{h} c_{k-1/2}.\n$$\n因此，\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{1}{h} \\left( \\frac{z u}{h} c_{k+1/2} - \\left[ - \\frac{z u}{h} c_{k-1/2} \\right] \\right) = \\frac{z u}{h^{2}} \\left( c_{k+1/2} + c_{k-1/2} \\right).\n$$\n用节点值表示界面浓度，\n$$\nc_{k+1/2} = \\frac{c_{k+1} + c_{k}}{2}, \\qquad c_{k-1/2} = \\frac{c_{k} + c_{k-1}}{2},\n$$\n得出\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{z u}{h^{2}} \\left( \\frac{c_{k+1} + c_{k}}{2} + \\frac{c_{k} + c_{k-1}}{2} \\right) = \\frac{z u}{2 h^{2}} \\left( c_{k+1} + 2 c_{k} + c_{k-1} \\right).\n$$\n\n为完整起见，Poisson 残差的雅可比矩阵元直接从 $P_{k}$ 得出：\n$$\n\\frac{\\partial P_{k}}{\\partial \\phi_{k-1}} = - \\varepsilon \\left( \\frac{1}{h^{2}} \\right), \\quad\n\\frac{\\partial P_{k}}{\\partial \\phi_{k}} = - \\varepsilon \\left( \\frac{-2}{h^{2}} \\right) = \\frac{2 \\varepsilon}{h^{2}}, \\quad\n\\frac{\\partial P_{k}}{\\partial \\phi_{k+1}} = - \\varepsilon \\left( \\frac{1}{h^{2}} \\right), \\quad\n\\frac{\\partial P_{k}}{\\partial c_{k}} = - q z,\n$$\n并且当 $j \\neq k$ 时 $\\frac{\\partial P_{k}}{\\partial c_{j}} = 0$，当 $j \\notin \\{k-1,k,k+1\\}$ 时 $\\frac{\\partial P_{k}}{\\partial \\phi_{j}} = 0$。\n\n因此，所要求的雅可比矩阵元 $\\frac{\\partial R_{k}}{\\partial \\phi_{k}}$ 关于 $z$、$u$、$h$、$c_{k-1}$、$c_{k}$ 和 $c_{k+1}$ 的显式闭合形式表达式为\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{z u}{2 h^{2}} \\left( c_{k+1} + 2 c_{k} + c_{k-1} \\right).\n$$",
            "answer": "$$\\boxed{\\frac{z\\,u}{2\\,h^{2}}\\left(c_{k+1}+2c_{k}+c_{k-1}\\right)}$$"
        },
        {
            "introduction": "在电化学输运模型中，边界层是普遍存在的现象，其内部物理量梯度极大，对数值精度构成挑战。本练习要求你通过编程解决一个典型的对流-扩散问题，并比较均匀网格与在边界层附近加密的分级网格的求解精度。这个实践将让你掌握通过优化网格分布来高效提升计算准确性的重要技巧。",
            "id": "4245976",
            "problem": "考虑在平面电化学电池中，单一反应物的一维、稳态、无量纲对流-扩散输运过程，该过程在区间 $[0,1]$ 上由以下常微分方程建模：\n$$\\varepsilon\\,\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} - \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0,$$\n边界条件为狄利克雷边界条件 $u(0)=0$ 和 $u(1)=1$。此处，$u(x)$ 表示反应物的无量纲浓度，$\\varepsilon0$ 是一个无量纲参数，代表扩散输运强度与对流输运强度之比。当 $\\varepsilon$ 很小时，在 $x=1$ 附近会形成一个边界层。\n\n从基本的质量守恒和通量平衡原理出发，不使用任何快捷公式，在一个 $x_0=0$ 且 $x_N=1$ 的通用非均匀网格 $\\{x_i\\}_{i=0}^N$ 上，实现上述边值问题的有限差分格式。在每个内部节点 $x_i$（$i=1,\\dots,N-1$），使用三点格式在非均匀网格上近似 $\\mathrm{d}^2 u/\\mathrm{d}x^2$，并对 $\\mathrm{d}u/\\mathrm{d}x$ 使用与对流项符号一致的一阶迎风（后向）差分。求解得到的线性系统，以获得数值近似解 $\\{u_i\\}_{i=0}^N$。\n\n为了量化网格效应，请将由 $x_i = i/N$（$i=0,\\dots,N$）定义的均匀网格与一个在 $x=1$ 边界层附近加密的分级网格进行比较，该分级网格定义为\n$$x_i = 1 - \\left(1 - \\frac{i}{N}\\right)^\\beta,$$\n其中 $\\beta1$ 是分级指数。对于每个测试用例，计算最大绝对误差\n$$E = \\max_{0\\le i \\le N} \\left|u_i - u_{\\text{exact}}(x_i)\\right|,$$\n其中精确解为\n$$u_{\\text{exact}}(x) = \\frac{\\exp\\!\\left(\\frac{x}{\\varepsilon}\\right) - 1}{\\exp\\!\\left(\\frac{1}{\\varepsilon}\\right) - 1}.$$\n以比率 $E_{\\text{uniform}}/E_{\\text{graded}}$ 的形式报告由网格分级带来的改进因子。\n\n所有量均为无量纲；没有需要报告的物理或数值单位。不涉及角度。你的程序必须为以下测试套件实现离散化和误差计算，每个测试用例由 $(\\varepsilon, N, \\beta)$ 指定：\n\n- 测试 1：$(\\varepsilon, N, \\beta) = (0.05, 64, 2.0)$，中等边界层厚度，中等分辨率。\n- 测试 2：$(\\varepsilon, N, \\beta) = (0.01, 64, 3.0)$，相同分辨率下更陡峭的边界层。\n- 测试 3：$(\\varepsilon, N, \\beta) = (0.50, 64, 2.0)$，弱边界层，网格分级预期提供有限的改进。\n- 测试 4：$(\\varepsilon, N, \\beta) = (0.02, 32, 4.0)$，粗分辨率，强分级。\n\n您的程序应生成单行输出，其中包含测试 1 到 4 的改进因子，形式为方括号括起来的逗号分隔列表（例如 $\\texttt{[f_1,f_2,f_3,f_4]}$），其中每个 $f_k$ 是一个浮点数，等于按上述规定为测试 $k$ 计算的 $E_{\\text{uniform}}/E_{\\text{graded}}$。",
            "solution": "用户希望求解一个一维稳态对流-扩散边值问题，并分析网格分级对数值误差的影响。\n\n### 第 1 步：提取已知条件\n- **控制方程**：$\\varepsilon\\,\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} - \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0$，对于 $x \\in [0,1]$。\n- **边界条件**：$u(0)=0$ 和 $u(1)=1$。\n- **参数**：$\\varepsilon  0$，一个无量纲参数。\n- **数值网格**：一个通用的非均匀网格 $\\{x_i\\}_{i=0}^N$，其中 $x_0=0$ 和 $x_N=1$。\n- **离散化方案**：\n    - **扩散项 ($\\mathrm{d}^2 u/\\mathrm{d}x^2$)**：在非均匀网格上的三点格式。\n    - **对流项 ($\\mathrm{d}u/\\mathrm{d}x$)**：一阶迎风（后向）差分。\n- **网格定义**：\n    - **均匀网格**：$x_i = i/N$，对于 $i=0,\\dots,N$。\n    - **分级网格**：$x_i = 1 - (1 - i/N)^\\beta$，对于 $i=0,\\dots,N$，分级指数 $\\beta1$。\n- **误差度量**：最大绝对误差 $E = \\max_{0\\le i \\le N} |u_i - u_{\\text{exact}}(x_i)|$。\n- **精确解**：$u_{\\text{exact}}(x) = (\\exp(x/\\varepsilon) - 1) / (\\exp(1/\\varepsilon) - 1)$。\n- **输出度量**：改进因子 $E_{\\text{uniform}}/E_{\\text{graded}}$。\n- **测试用例 $(\\varepsilon, N, \\beta)$**：\n    1. $(0.05, 64, 2.0)$\n    2. $(0.01, 64, 3.0)$\n    3. $(0.50, 64, 2.0)$\n    4. $(0.02, 32, 4.0)$\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了稳态对流-扩散方程，这是输运现象中的一个基本模型。方程、边界条件以及提供的精确解在数学和物理上都是正确的。所提出的有限差分法是一种标准且合适的数值技术。该问题是合理的。\n2.  **适定性**：该问题是一个带有两个狄利克雷边界条件的二阶线性常微分方程。这构成了一个适定的边值问题，所提供的唯一精确解的存在证实了这一点。\n3.  **客观性**：该问题以精确、客观的数学语言陈述。\n4.  **完整性**：所有必要信息都已提供：模型方程、边界条件、网格生成公式、离散化说明、误差度量以及特定的测试参数。该问题是自包含的。\n5.  **其他缺陷**：该问题并非无关紧要、循环论证、模棱两可或基于任何其他谬误。它提出了一个数值分析和计算物理领域的标准练习。\n\n### 第 3 步：结论与行动\n问题有效。我将继续进行详细的推导和实现。\n\n### 基于原理的推导与求解设计\n\n问题的核心是在非均匀网格上离散化控制常微分方程 (ODE)，并求解得到的线性系统。推导过程必须遵循对每一项指定的方法。\n\n**1. 扩散项的离散化**\n\n我们被要求使用三点格式在非均匀网格的内部节点 $x_i$ 处近似二阶导数 $\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2}$。令 $u_i = u(x_i)$，网格间距为 $h_i = x_i - x_{i-1}$ 和 $h_{i+1} = x_{i+1} - x_i$。我们对 $u_{i+1}$ 和 $u_{i-1}$ 在 $x_i$ 周围使用泰勒级数展开：\n$$u_{i+1} = u_i + h_{i+1} u'(x_i) + \\frac{h_{i+1}^2}{2} u''(x_i) + O(h_{i+1}^3)$$\n$$u_{i-1} = u_i - h_i u'(x_i) + \\frac{h_i^2}{2} u''(x_i) + O(h_i^3)$$\n为了找到 $u''(x_i)$ 的表达式，我们必须消去 $u'(x_i)$ 项。我们将第一个方程乘以 $h_i$，第二个方程乘以 $h_{i+1}$，然后相加：\n$$h_i u_{i+1} + h_{i+1} u_{i-1} = (h_i+h_{i+1})u_i + \\frac{h_i h_{i+1}^2 + h_{i+1} h_i^2}{2}u''(x_i) + \\dots$$\n求解 $u''(x_i)$ 得到非均匀网格上的二阶精确中心差分公式：\n$$\\left(\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2}\\right)_i \\approx \\frac{2}{h_i h_{i+1} (h_i+h_{i+1})} \\left( h_i u_{i+1} - (h_i+h_{i+1})u_i + h_{i+1}u_{i-1} \\right)$$\n重新整理各项，我们得到格式的系数：\n$$\\left(\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2}\\right)_i \\approx \\left(\\frac{2}{h_{i+1}(h_i+h_{i+1})}\\right) u_{i+1} - \\left(\\frac{2}{h_i h_{i+1}}\\right) u_i + \\left(\\frac{2}{h_i(h_i+h_{i+1})}\\right) u_{i-1}$$\n\n**2. 对流项的离散化**\n\n问题指定对对流项 $\\frac{\\mathrm{d}u}{\\mathrm{d}x}$ 使用一阶迎风差分。控制方程为 $\\varepsilon u'' - u' = 0$。对流项是 $-u'$，系数为 $-1$。这意味着对流速度为正，流向 $x$ 增大的方向。因此，“迎风”格式必须从上游方向（较小的 $x$）获取信息。这对应于一阶后向差分：\n$$\\left(\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)_i \\approx \\frac{u_i - u_{i-1}}{x_i - x_{i-1}} = \\frac{u_i - u_{i-1}}{h_i}$$\n\n**3. 组合离散方程**\n\n对于每个内部节点 $i = 1, \\dots, N-1$，我们将导数的近似值代入控制 ODE $\\varepsilon u'' - u' = 0$ 中：\n$$\\varepsilon \\left[ \\left(\\frac{2}{h_{i+1}(h_i+h_{i+1})}\\right) u_{i+1} - \\left(\\frac{2}{h_i h_{i+1}}\\right) u_i + \\left(\\frac{2}{h_i(h_i+h_{i+1})}\\right) u_{i-1} \\right] - \\left[ \\frac{u_i - u_{i-1}}{h_i} \\right] = 0$$\n为了形成一个线性系统，我们按未知数 $u_{i-1}$、$u_i$ 和 $u_{i+1}$ 对各项进行分组：\n$$A_i u_{i-1} + B_i u_i + C_i u_{i+1} = 0$$\n其中系数为：\n$$A_i = \\frac{2\\varepsilon}{h_i(h_i+h_{i+1})} + \\frac{1}{h_i}$$\n$$B_i = -\\frac{2\\varepsilon}{h_i h_{i+1}} - \\frac{1}{h_i}$$\n$$C_i = \\frac{2\\varepsilon}{h_{i+1}(h_i+h_{i+1})}$$\n\n**4. 构建线性系统**\n\n这组关于 $N-1$ 个内部未知数 $\\{u_i\\}_{i=1}^{N-1}$ 的 $N-1$ 个线性方程可以写成矩阵形式 $\\mathbf{M}\\mathbf{u}_{\\text{internal}} = \\mathbf{b}$。边界条件 $u_0=0$ 和 $u_N=1$ 按如下方式并入：\n\n- 对于第一个内部节点 ($i=1$): $A_1 u_0 + B_1 u_1 + C_1 u_2 = 0$。由于 $u_0=0$，方程变为 $B_1 u_1 + C_1 u_2 = 0$。这定义了矩阵 $\\mathbf{M}$ 的第一行和右侧向量 $\\mathbf{b}$。\n\n- 对于一个通用内部节点 ($1  i  N-1$): $A_i u_{i-1} + B_i u_i + C_i u_{i+1} = 0$。这定义了三对角系统中的一个通用行。\n\n- 对于最后一个内部节点 ($i=N-1$): $A_{N-1} u_{N-2} + B_{N-1} u_{N-1} + C_{N-1} u_N = 0$。由于 $u_N=1$，方程变为 $A_{N-1} u_{N-2} + B_{N-1} u_{N-1} = -C_{N-1}$。这定义了系统的最后一行。\n\n得到的矩阵 $\\mathbf{M}$ 是三对角的：\n$$\\mathbf{M} = \\begin{pmatrix}\nB_1  C_1  0  \\dots  0 \\\\\nA_2  B_2  C_2  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  A_{N-2}  B_{N-2}  C_{N-2} \\\\\n0  \\dots  0  A_{N-1}  B_{N-1}\n\\end{pmatrix}$$\n右侧向量 $\\mathbf{b}$ 是：\n$$\\mathbf{b} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ -C_{N-1} \\end{pmatrix}$$\n\n**5. 算法实现**\n\n对于每个测试用例，以下步骤将执行两次：一次用于均匀网格 ($\\beta=1$)，一次用于指定的分级网格 ($\\beta > 1$)。\n\n1.  **生成网格**：使用适当的公式创建节点坐标数组 $\\{x_i\\}_{i=0}^N$。\n2.  **计算间距**：计算区间宽度 $h_i = x_i - x_{i-1}$ (对于 $i=1, \\dots, N$)。\n3.  **组合系统**：通过从 $i=1$ 到 $N-1$ 迭代并计算系数 $A_i, B_i, C_i$，构建 $(N-1) \\times (N-1)$ 的三对角矩阵 $\\mathbf{M}$ 和 $(N-1) \\times 1$ 的向量 $\\mathbf{b}$。\n4.  **求解系统**：求解线性系统 $\\mathbf{M}\\mathbf{u}_{\\text{internal}} = \\mathbf{b}$ 以得到内部节点值 $\\mathbf{u}_{\\text{internal}} = [u_1, \\dots, u_{N-1}]^T$。\n5.  **计算误差**：结合边界值和计算出的内部值，形成完整的数值解 $\\{u_i\\}_{i=0}^N$。在每个节点计算精确解 $u_{\\text{exact}}(x_i)$，并找出最大绝对误差 $E = \\max_{i} |u_i - u_{\\text{exact}}(x_i)|$。\n6.  **计算改进因子**：在计算了均匀网格 ($E_{\\text{uniform}}$) 和分级网格 ($E_{\\text{graded}}$) 的误差后，将改进因子计算为比率 $E_{\\text{uniform}} / E_{\\text{graded}}$。\n\n最终输出将是所有测试用例的这些改进因子的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the advection-diffusion problem for a series of test cases and\n    computes the error improvement factor from using a graded mesh.\n    \"\"\"\n\n    def get_exact_solution(x, eps):\n        \"\"\"\n        Computes the exact solution of the BVP.\n        u(x) = (exp(x/eps) - 1) / (exp(1/eps) - 1)\n        \"\"\"\n        numerator = np.exp(x / eps) - 1.0\n        denominator = np.exp(1.0 / eps) - 1.0\n        # This form is numerically stable for the given eps values\n        return numerator / denominator\n\n    def solve_bvp(eps, N, beta):\n        \"\"\"\n        Discretizes and solves the BVP on a potentially nonuniform mesh.\n\n        Args:\n            eps (float): The dimensionless diffusion/advection ratio.\n            N (int): The number of intervals in the mesh.\n            beta (float): The mesh grading exponent. beta=1.0 for a uniform mesh.\n\n        Returns:\n            float: The maximum absolute error against the exact solution.\n        \"\"\"\n        # 1. Generate mesh coordinates\n        i_vals = np.arange(N + 1)\n        if beta == 1.0:\n            # Uniform mesh\n            x = i_vals / N\n        else:\n            # Graded mesh clustered at x=1\n            x = 1.0 - (1.0 - i_vals / N)**beta\n\n        # 2. Calculate grid spacings h[k] = x_{k+1} - x_k\n        h = np.diff(x)  # h has size N. h[i-1] corresponds to our h_i notation.\n\n        # 3. Assemble the (N-1)x(N-1) linear system M*u = b\n        num_unknowns = N - 1\n        A_coeffs = np.zeros(num_unknowns)\n        B_coeffs = np.zeros(num_unknowns)\n        C_coeffs = np.zeros(num_unknowns)\n        b = np.zeros(num_unknowns)\n\n        # Loop over interior nodes i = 1, ..., N-1\n        # which corresponds to matrix rows j = 0, ..., N-2\n        for i in range(1, N):\n            j = i - 1  # Matrix/vector index\n            \n            # Grid spacings around node i\n            h_i = h[i - 1]  # spacing x_i - x_{i-1}\n            h_i_plus_1 = h[i] # spacing x_{i+1} - x_i\n            \n            # Coefficients of the discrete equation: A_i*u_{i-1} + B_i*u_i + C_i*u_{i+1} = 0\n            # Derived from epsilon*u'' - u' = 0\n            A_coeffs[j] = eps * 2.0 / (h_i * (h_i + h_i_plus_1)) + 1.0 / h_i\n            B_coeffs[j] = -eps * 2.0 / (h_i * h_i_plus_1) - 1.0 / h_i\n            C_coeffs[j] = eps * 2.0 / (h_i_plus_1 * (h_i + h_i_plus_1))\n\n        # Build the tridiagonal matrix M\n        M = np.diag(B_coeffs) + np.diag(C_coeffs[:-1], k=1) + np.diag(A_coeffs[1:], k=-1)\n        \n        # Apply boundary conditions\n        # u_0 = 0 is handled implicitly as A_1*u_0 does not contribute to the RHS\n        # u_N = 1 modifies the last equation\n        # A_{N-1}*u_{N-2} + B_{N-1}*u_{N-1} + C_{N-1}*u_N = 0\n        # becomes A_{N-1}*u_{N-2} + B_{N-1}*u_{N-1} = -C_{N-1}\n        b[-1] = -C_coeffs[-1]\n\n        # 4. Solve the linear system\n        u_internal = np.linalg.solve(M, b)\n\n        # 5. Construct full solution and compute error\n        u_numerical = np.concatenate(([0.0], u_internal, [1.0]))\n        u_exact = get_exact_solution(x, eps)\n        \n        error = np.max(np.abs(u_numerical - u_exact))\n        \n        return error\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (epsilon, N, beta)\n        (0.05, 64, 2.0),\n        (0.01, 64, 3.0),\n        (0.50, 64, 2.0),\n        (0.02, 32, 4.0),\n    ]\n\n    results = []\n    for eps, N, beta in test_cases:\n        # Calculate error on a uniform mesh (beta=1.0)\n        error_uniform = solve_bvp(eps, N, 1.0)\n        \n        # Calculate error on the specified graded mesh\n        error_graded = solve_bvp(eps, N, beta)\n        \n        # Compute improvement factor and append to results\n        improvement_factor = error_uniform / error_graded\n        results.append(improvement_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "数值模拟不仅要得出结果，更要能正确地解释物理现象，并识别由离散化带来的误差。本练习模拟一个电极反应过程，要求你分析计算得到的电流-过电位曲线，并与理想的塔菲尔行为进行比较。你将通过这个过程学会如何辨别粗糙网格下数值误差所导致的非物理性偏差，这是计算科学家必须具备的批判性分析能力。",
            "id": "4245957",
            "problem": "一个位于 $x=0$ 位置的单平面等温电极与一个静止的一维电解质区域 $x \\in [0,L]$ 相接触。电解质中本体浓度为 $c_b$ 的单一电活性物质 $\\mathrm{A}$ 在电极上发生阴极反应。电解质含有大量过剩的支持电解质，因此迁移可以忽略不计，且电中性成立；输运仅由扩散控制。$\\mathrm{A}$ 的稳态扩散满足 Fick 第一定律和连续性方程：摩尔通量为 $J_{\\mathrm{A}}(x) = -D\\,\\frac{dc}{dx}$，稳态连续性方程为 $\\frac{dJ_{\\mathrm{A}}}{dx} = 0$，这意味着 $\\frac{d^2 c}{dx^2} = 0$。远场边界条件为 $c(L) = c_b$。\n\n在电极处，界面反应由阴极主导下的 Butler–Volmer 关系描述，因此电流密度为 $j(\\eta) = n F k_0\\,c(0)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)$，其中 $n$ 为电子数，$F$ 为法拉第常数，$k_0$ 为标准非均相速率常数，$\\alpha$ 为电荷转移系数，$R$ 为通用气体常数，$T$ 为温度，$\\eta$ 为过电位，定义为阴极方向为正。电极处的质量守恒将扩散通量与界面反应速率联系起来，得到 Robin 边界条件 $-D\\,\\left.\\frac{dc}{dx}\\right|_{x=0} = \\frac{j(\\eta)}{nF} = k_0\\,c(0)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)$。\n\n在动力学控制下，当表面浓度 $c(0)$ 近似等于本体浓度 $c_b$ 时，Tafel 行为预测 $\\log_{10} j$ 随 $\\eta$ 线性变化，斜率为 $S_{\\mathrm{T}} = \\frac{\\alpha n F}{R T\\,\\ln(10)}$。如果在数值模拟中，即使选择了旨在最小化传质限制的物理参数，输运方程的有限差分离散化引入了误差，也可能导致偏离这种理想的 Tafel 行为。\n\n您的任务是，在一个包含 $N$ 个节点、间距为 $\\Delta x = \\frac{L}{N-1}$ 的均匀网格上，实现 $c(x)$ 稳态扩散方程的二阶有限差分离散化，包括 $x=0$ 处的 Robin 边界条件和 $x=L$ 处的 Dirichlet 条件。对电极处的导数使用以下单侧二阶近似：\n$$\n\\left.\\frac{dc}{dx}\\right|_{x=0} \\approx \\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x},\n$$\n其中 $c_i$ 表示 $c(x_i)$ 的近似值，$x_i = i\\,\\Delta x$，且 $i \\in \\{0,1,\\dots,N-1\\}$。\n\n对于内部节点 $i=1,2,\\dots,N-2$，施加离散拉普拉斯方程\n$$\nc_{i-1} - 2c_i + c_{i+1} = 0.\n$$\n在右边界，强制 $c_{N-1} = c_b$。在左边界，强制施加 Robin 条件\n$$\n-D\\,\\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x} = k_0\\,c_0\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right).\n$$\n\n对于每个过电位值 $\\eta$，求解得到的线性系统以获得 $c_0(\\eta)$，然后计算电流密度\n$$\nj_{\\mathrm{num}}(\\eta) = n F k_0\\,c_0(\\eta)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right).\n$$\n在指定范围内构建过电位-电流曲线 $\\{\\eta, j_{\\mathrm{num}}(\\eta)\\}$，并通过对 $\\log_{10} j_{\\mathrm{num}}(\\eta)$ 与 $\\eta$ 进行线性回归来估计其 Tafel 斜率 $S_{\\mathrm{num}}$。最后，将离散化引起的、偏离动力学控制 Tafel 行为的偏差量化为绝对相对误差\n$$\nE = \\left|\\frac{S_{\\mathrm{num}} - S_{\\mathrm{T}}}{S_{\\mathrm{T}}}\\right|.\n$$\n报告每个测试用例的 $E$。\n\n在国际单位制（SI 单位）中使用以下物理上现实的参数值：\n- $n = 1$ (无量纲),\n- $F = 96485\\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$,\n- $R = 8.314\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$,\n- $T = 298\\ \\mathrm{K}$,\n- $\\alpha = \\frac{1}{2}$ (无量纲),\n- $D = 1\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n- $L = 1\\times 10^{-6}\\ \\mathrm{m}$,\n- $k_0 = 1\\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- $c_b = 1\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\n使用一组 $M=10$ 个在区间 $\\eta \\in [\\eta_{\\min}, \\eta_{\\max}]$ 内均匀分布的过电位，其中 $\\eta_{\\min} = 0.01\\ \\mathrm{V}$ 且 $\\eta_{\\max} = 0.10\\ \\mathrm{V}$。对于每个过电位，计算 $j_{\\mathrm{num}}(\\eta)$，执行线性回归以获得 $S_{\\mathrm{num}}$，并计算 $E$。\n\n测试套件：\n- 情况 1 (正常路径): $N = 101$ 个节点。\n- 情况 2 (粗网格): $N = 5$ 个节点。\n- 情况 3 (边缘情况，允许二阶左导数的最小网格): $N = 3$ 个节点。\n\n答案规格：\n- 对于每种情况，程序必须输出单一浮点数 $E$，作为一个无量纲的小数。\n- 最终输出必须是单行，包含上述三种情况的三个结果，形式为用方括号括起来的逗号分隔列表，例如 $[E_1,E_2,E_3]$。\n\n角度单位不适用于此问题。不得使用百分比；所有误差均以小数形式表示。所有物理单位已为参数明确指定。通过使用所述参数和离散化，确保数值稳定性和科学真实性。您的程序必须是自包含的，并且不需要任何输入。",
            "solution": "该问题要求分析在电化学稳态扩散-反应问题中，由有限差分离散化引入的数值误差。具体来说，我们必须量化数值计算的 Tafel 斜率与其理论值的偏差。求解过程首先建立由离散化产生的线性方程组，然后概述计算步骤，以求解浓度分布、计算电流、执行 Tafel 分析，并最终确定误差。\n\n该物理系统由一维稳态扩散方程描述，物种浓度为 $c(x)$：\n$$\n\\frac{d^2 c}{dx^2} = 0, \\quad x \\in [0, L]\n$$\n该方程受制于远场边界 $x=L$ 处的 Dirichlet 边界条件和电极表面 $x=0$ 处的 Robin 边界条件。\n$$\nc(L) = c_b\n$$\n$$\n-D\\,\\left.\\frac{dc}{dx}\\right|_{x=0} = k_0\\,c(0)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)\n$$\n其中 $D$ 是扩散系数，$k_0$ 是标准非均相速率常数，$\\eta$ 是阴极过电位，其他符号代表其标准电化学常数。\n\n为了数值求解该系统，我们将空间域 $[0, L]$ 离散化为一个包含 $N$ 个节点的均匀网格，$x_i = i\\,\\Delta x$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$，网格间距为 $\\Delta x = L/(N-1)$。每个节点上的浓度表示为 $c_i \\approx c(x_i)$。\n\n控制偏微分方程和边界条件使用有限差分公式进行近似：\n\n1.  对于内部节点 $i \\in \\{1, 2, \\dots, N-2\\}$，二阶导数 $\\frac{d^2 c}{dx^2}=0$ 使用二阶中心差分格式进行近似：\n    $$\n    \\frac{c_{i-1} - 2c_i + c_{i+1}}{\\Delta x^2} = 0 \\implies c_{i-1} - 2c_i + c_{i+1} = 0\n    $$\n\n2.  在右边界 $i = N-1$ 处，直接施加 Dirichlet 条件：\n    $$\n    c_{N-1} = c_b\n    $$\n\n3.  在左边界 $i = 0$ 处，Robin 条件涉及一个导数，该导数使用指定的二阶单侧差分公式进行近似：\n    $$\n    \\left.\\frac{dc}{dx}\\right|_{x=0} \\approx \\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x}\n    $$\n    将此代入 Robin 边界条件可得：\n    $$\n    -D \\left( \\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x} \\right) = k_f(\\eta) \\, c_0\n    $$\n    其中我们定义了与电位相关的速率常数 $k_f(\\eta) = k_0\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)$。重新整理此方程以组合涉及未知浓度 $\\{c_i\\}$ 的项，得到：\n    $$\n    D(3c_0 - 4c_1 + c_2) = 2\\,\\Delta x\\,k_f(\\eta)\\,c_0\n    $$\n    $$\n    (3D - 2\\,\\Delta x\\,k_f(\\eta))\\,c_0 - 4D\\,c_1 + D\\,c_2 = 0\n    $$\n    此方程对 $N \\ge 3$ 有效，所有测试用例均满足此条件。\n\n这 $N$ 个离散方程构成了一个关于浓度向量 $\\mathbf{c} = [c_0, c_1, \\dots, c_{N-1}]^T$ 的线性方程组 $\\mathbf{A}\\mathbf{c} = \\mathbf{b}$。$N \\times N$ 矩阵 $\\mathbf{A}$ 和 $N \\times 1$ 向量 $\\mathbf{b}$ 的构造如下：\n\n-   **第 0 行 (来自 $i=0$ 处的 Robin 边界条件):**\n    $$ A_{0,0} = 3D - 2\\,\\Delta x\\,k_f(\\eta), \\quad A_{0,1} = -4D, \\quad A_{0,2} = D $$\n    该行中的所有其他元素均为零。右侧向量中对应的元素为 $b_0 = 0$。\n\n-   **第 $i=1, \\dots, N-2$ 行 (来自内部扩散方程):**\n    $$ A_{i, i-1} = 1, \\quad A_{i, i} = -2, \\quad A_{i, i+1} = 1 $$\n    这些行中的所有其他元素均为零。右侧向量中对应的元素为 $b_i = 0$。\n\n-   **第 $N-1$ 行 (来自 $i=N-1$ 处的 Dirichlet 边界条件):**\n    $$ A_{N-1, N-1} = 1 $$\n    该行中的所有其他元素均为零。右侧向量中对应的元素为 $b_{N-1} = c_b$。\n\n矩阵 $\\mathbf{A}$ 通过其第一行中的项 $k_f(\\eta)$ 依赖于过电位 $\\eta$。因此，对于每个 $\\eta$ 值，都必须求解一个新的线性系统。\n\n每个测试用例（由一个 $N$ 值定义）的计算过程如下：\n1.  定义物理和数值参数。计算理论 Tafel 斜率 $S_{\\mathrm{T}} = \\frac{\\alpha n F}{R T\\,\\ln(10)}$。\n2.  在 $[\\eta_{\\min}, \\eta_{\\max}]$ 范围内生成一组 $M=10$ 个均匀间隔的过电位 $\\eta_k$。\n3.  对于每个 $\\eta_k$：\n    a. 如上所述构造矩阵 $\\mathbf{A}(\\eta_k)$ 和向量 $\\mathbf{b}$。\n    b. 求解线性系统 $\\mathbf{A}(\\eta_k)\\mathbf{c} = \\mathbf{b}$ 以获得浓度向量 $\\mathbf{c}$。这可以使用标准的线性代数库例程来完成。\n    c. 提取表面浓度 $c_0 = \\mathbf{c}[0]$。\n    d. 计算数值电流密度 $j_{\\mathrm{num}}(\\eta_k) = n F k_f(\\eta_k) c_0$。\n4.  在计算完所有过电位的电流后，对点集 $(\\eta_k, \\log_{10} j_{\\mathrm{num}}(\\eta_k))$ 进行线性回归。所得直线的斜率即为数值 Tafel 斜率 $S_{\\mathrm{num}}$。\n5.  最后，计算绝对相对误差 $E = \\left|\\frac{S_{\\mathrm{num}} - S_{\\mathrm{T}}}{S_{\\mathrm{T}}}\\right|$。\n\n对测试套件中给出的每个 $N$ 值（$N=101, 5, 3$）重复此过程，以获得所需的误差值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the computational electrochemistry problem for the given test cases.\n    \"\"\"\n    \n    # --- Physical and numerical parameters ---\n    # Physical constants (SI units)\n    n = 1.0  # Number of electrons\n    F = 96485.0  # Faraday constant (C/mol)\n    R = 8.314  # Universal gas constant (J/(mol*K))\n    T = 298.0  # Temperature (K)\n    alpha = 0.5  # Charge transfer coefficient\n    \n    # System parameters (SI units)\n    D = 1e-9  # Diffusion coefficient (m^2/s)\n    L = 1e-6  # Domain length (m)\n    k0 = 1e-5  # Standard heterogeneous rate constant (m/s)\n    cb = 1.0  # Bulk concentration (mol/m^3)\n    \n    # Numerical parameters\n    M = 10  # Number of overpotential points\n    eta_min = 0.01  # Minimum overpotential (V)\n    eta_max = 0.10  # Maximum overpotential (V)\n    \n    # Test cases for the number of grid nodes\n    test_cases = [101, 5, 3]\n    \n    # Generate the array of overpotentials\n    etas = np.linspace(eta_min, eta_max, M)\n\n    # --- Pre-calculate constant terms ---\n    # Theoretical Tafel slope\n    st_theoretical = (alpha * n * F) / (R * T * np.log(10))\n    # Exponent factor for k_f\n    exp_factor = (alpha * n * F) / (R * T)\n\n    results = []\n    \n    for N in test_cases:\n        # Calculate grid spacing for the current case\n        if N > 1:\n            dx = L / (N - 1)\n        else: # Should not happen based on problem, but good practice\n            dx = L\n\n        log_j_nums = []\n\n        for eta in etas:\n            # --- Assemble the linear system A*c = b ---\n            A = np.zeros((N, N))\n            b = np.zeros(N)\n            \n            # Calculate potential-dependent rate constant\n            k_f = k0 * np.exp(exp_factor * eta)\n\n            # Equation for node i=0 (Robin BC)\n            # (3D - 2*dx*k_f)*c0 - 4D*c1 + D*c2 = 0\n            A[0, 0] = 3.0 * D - 2.0 * dx * k_f\n            A[0, 1] = -4.0 * D\n            A[0, 2] = 1.0 * D\n            \n            # Equations for interior nodes i=1 to N-2\n            # c_{i-1} - 2*c_i + c_{i+1} = 0\n            for i in range(1, N - 1):\n                A[i, i - 1] = 1.0\n                A[i, i] = -2.0\n                A[i, i + 1] = 1.0\n                \n            # Equation for node i=N-1 (Dirichlet BC)\n            # c_{N-1} = cb\n            A[N - 1, N - 1] = 1.0\n            b[N - 1] = cb\n            \n            # Solve the linear system for the concentration vector c\n            c = np.linalg.solve(A, b)\n            c0 = c[0]\n            \n            # Calculate numerical current density\n            j_num = n * F * k_f * c0\n            log_j_nums.append(np.log10(j_num))\n            \n        # --- Perform linear regression to find numerical Tafel slope ---\n        # scipy.stats.linregress(x, y) returns a result object\n        # The slope is the first element\n        regression_result = stats.linregress(etas, log_j_nums)\n        st_numerical = regression_result.slope\n        \n        # Calculate the absolute relative error\n        error = np.abs((st_numerical - st_theoretical) / st_theoretical)\n        results.append(error)\n        \n    # --- Final print statement in the exact required format ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}