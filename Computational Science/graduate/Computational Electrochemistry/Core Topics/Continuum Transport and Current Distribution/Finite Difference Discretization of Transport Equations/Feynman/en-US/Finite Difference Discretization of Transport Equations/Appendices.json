{
    "hands_on_practices": [
        {
            "introduction": "To begin our exploration of discretizing transport equations, we start with a foundational problem in electrochemistry: diffusion to a reactive surface. This exercise bridges numerical implementation with classic electrochemical theory by modeling the steady-state diffusion of a species undergoing a reaction governed by Butler-Volmer kinetics. By implementing a finite difference scheme that includes a second-order accurate Robin boundary condition, you will compute an overpotential-current curve and compare its Tafel slope to the theoretical prediction, providing direct insight into how discretization choices impact the accuracy of physically meaningful quantities .",
            "id": "4245957",
            "problem": "A single, planar, isothermal electrode at position $x=0$ is in contact with a stagnant, one-dimensional electrolyte domain $x \\in [0,L]$. A single electroactive species $\\mathrm{A}$ with bulk concentration $c_b$ in the electrolyte undergoes a cathodic reaction at the electrode. The electrolyte contains a large excess of supporting salt, so migration is negligible and electroneutrality holds; transport is governed by diffusion only. The steady-state diffusion of $\\mathrm{A}$ satisfies Fick's first law and continuity: the molar flux is $J_{\\mathrm{A}}(x) = -D\\,\\frac{dc}{dx}$, and the steady-state continuity equation is $\\frac{dJ_{\\mathrm{A}}}{dx} = 0$, which implies $\\frac{d^2 c}{dx^2} = 0$. The far-field boundary condition is $c(L) = c_b$.\n\nAt the electrode, the interfacial reaction is described by the Butler–Volmer relation under cathodic dominance, so that the current density is $j(\\eta) = n F k_0\\,c(0)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)$, where $n$ is the number of electrons, $F$ is the Faraday constant, $k_0$ is the standard heterogeneous rate constant, $\\alpha$ is the charge transfer coefficient, $R$ is the universal gas constant, $T$ is the temperature, and $\\eta$ is the overpotential defined to be positive for the cathodic direction. Conservation of mass at the electrode relates the diffusive flux to the interfacial reaction rate, giving the Robin boundary condition $-D\\,\\left.\\frac{dc}{dx}\\right|_{x=0} = \\frac{j(\\eta)}{nF} = k_0\\,c(0)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)$.\n\nUnder kinetic control, the Tafel behavior predicts that $\\log_{10} j$ varies linearly with $\\eta$ with slope $S_{\\mathrm{T}} = \\frac{\\alpha n F}{R T\\,\\ln(10)}$ when the surface concentration $c(0)$ is approximately equal to the bulk concentration $c_b$. Deviations from this ideal Tafel behavior can arise in numerical simulations if the finite difference discretization of the transport equation introduces error, even when physical parameters are chosen to minimize mass-transport limitations.\n\nYour task is to implement a second-order finite difference discretization of the steady diffusion equation for $c(x)$ on a uniform grid of $N$ nodes with spacing $\\Delta x = \\frac{L}{N-1}$, including the Robin boundary condition at $x=0$ and the Dirichlet condition at $x=L$. Use the following one-sided second-order approximation for the derivative at the electrode:\n$$\n\\left.\\frac{dc}{dx}\\right|_{x=0} \\approx \\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x},\n$$\nwhere $c_i$ denotes the approximation to $c(x_i)$, $x_i = i\\,\\Delta x$, and $i \\in \\{0,1,\\dots,N-1\\}$.\n\nFor interior nodes $i=1,2,\\dots,N-2$, impose the discrete Laplace equation\n$$\nc_{i-1} - 2c_i + c_{i+1} = 0.\n$$\nAt the right boundary, enforce $c_{N-1} = c_b$. At the left boundary, enforce the Robin condition\n$$\n-D\\,\\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x} = k_0\\,c_0\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right).\n$$\n\nFor each overpotential value $\\eta$, solve the resulting linear system to obtain $c_0(\\eta)$, then compute the current density\n$$\nj_{\\mathrm{num}}(\\eta) = n F k_0\\,c_0(\\eta)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right).\n$$\nConstruct the overpotential–current curve $\\{\\eta, j_{\\mathrm{num}}(\\eta)\\}$ over a specified range and estimate its Tafel slope $S_{\\mathrm{num}}$ by linear regression of $\\log_{10} j_{\\mathrm{num}}(\\eta)$ versus $\\eta$. Finally, quantify the discretization-induced deviation from kinetic-control Tafel behavior as the absolute relative error\n$$\nE = \\left|\\frac{S_{\\mathrm{num}} - S_{\\mathrm{T}}}{S_{\\mathrm{T}}}\\right|.\n$$\nReport $E$ for each test case.\n\nUse the following physically realistic parameter values in International System of Units (SI units):\n- $n = 1$ (dimensionless),\n- $F = 96485\\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$,\n- $R = 8.314\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$,\n- $T = 298\\ \\mathrm{K}$,\n- $\\alpha = \\frac{1}{2}$ (dimensionless),\n- $D = 1\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n- $L = 1\\times 10^{-6}\\ \\mathrm{m}$,\n- $k_0 = 1\\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- $c_b = 1\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nUse a set of $M=10$ overpotentials uniformly spaced in the interval $\\eta \\in [\\eta_{\\min}, \\eta_{\\max}]$ with $\\eta_{\\min} = 0.01\\ \\mathrm{V}$ and $\\eta_{\\max} = 0.10\\ \\mathrm{V}$. For each overpotential, compute $j_{\\mathrm{num}}(\\eta)$, perform the linear regression to obtain $S_{\\mathrm{num}}$, and compute $E$.\n\nTest Suite:\n- Case $1$ (happy path): $N = 101$ nodes.\n- Case $2$ (coarse grid): $N = 5$ nodes.\n- Case $3$ (edge case, minimal grid to allow second-order left derivative): $N = 3$ nodes.\n\nAnswer specification:\n- For each case, the program must output the single float $E$ as a dimensionless decimal number.\n- The final output must be a single line containing the three results for the above cases as a comma-separated list enclosed in square brackets, for example $[E_1,E_2,E_3]$.\n\nAngle units do not apply in this problem. Percentages must not be used; express all errors as decimal fractions. All physical units have been specified explicitly for parameters. Ensure numerical stability and scientific realism by using the stated parameters and discretization. Your program must be self-contained and require no input.",
            "solution": "The problem requires an analysis of the numerical error introduced by a finite difference discretization of a steady-state diffusion-reaction problem in electrochemistry. Specifically, we must quantify the deviation of the numerically computed Tafel slope from its theoretical value. The solution proceeds by first establishing the system of linear equations that results from the discretization, and then outlining the computational procedure to solve for the concentration profile, calculate the current, perform a Tafel analysis, and finally determine the error.\n\nThe physical system is described by the one-dimensional steady-state diffusion equation for a species with concentration $c(x)$:\n$$\n\\frac{d^2 c}{dx^2} = 0, \\quad x \\in [0, L]\n$$\nThis is subject to a Dirichlet boundary condition at the far-field boundary, $x=L$, and a Robin boundary condition at the electrode surface, $x=0$.\n$$\nc(L) = c_b\n$$\n$$\n-D\\,\\left.\\frac{dc}{dx}\\right|_{x=0} = k_0\\,c(0)\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)\n$$\nwhere $D$ is the diffusion coefficient, $k_0$ is the standard heterogeneous rate constant, $\\eta$ is the cathodic overpotential, and the other symbols represent their standard electrochemical constants.\n\nTo solve this system numerically, we discretize the spatial domain $[0, L]$ into a uniform grid of $N$ nodes, $x_i = i\\,\\Delta x$ for $i \\in \\{0, 1, \\dots, N-1\\}$, where the grid spacing is $\\Delta x = L/(N-1)$. The concentration at each node is denoted by $c_i \\approx c(x_i)$.\n\nThe governing partial differential equation and boundary conditions are approximated using finite difference formulas:\n\n1.  For the interior nodes, $i \\in \\{1, 2, \\dots, N-2\\}$, the second derivative $\\frac{d^2 c}{dx^2}=0$ is approximated using a second-order central difference scheme:\n    $$\n    \\frac{c_{i-1} - 2c_i + c_{i+1}}{\\Delta x^2} = 0 \\implies c_{i-1} - 2c_i + c_{i+1} = 0\n    $$\n\n2.  At the right boundary, $i = N-1$, the Dirichlet condition is imposed directly:\n    $$\n    c_{N-1} = c_b\n    $$\n\n3.  At the left boundary, $i = 0$, the Robin condition involves a derivative, which is approximated using the specified second-order one-sided difference formula:\n    $$\n    \\left.\\frac{dc}{dx}\\right|_{x=0} \\approx \\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x}\n    $$\n    Substituting this into the Robin boundary condition gives:\n    $$\n    -D \\left( \\frac{-3c_0 + 4c_1 - c_2}{2\\,\\Delta x} \\right) = k_f(\\eta) \\, c_0\n    $$\n    where we have defined the potential-dependent rate constant $k_f(\\eta) = k_0\\,\\exp\\!\\left(\\frac{\\alpha n F}{R T}\\,\\eta\\right)$. Rearranging this equation to group terms involving the unknown concentrations $\\{c_i\\}$ yields:\n    $$\n    D(3c_0 - 4c_1 + c_2) = 2\\,\\Delta x\\,k_f(\\eta)\\,c_0\n    $$\n    $$\n    (3D - 2\\,\\Delta x\\,k_f(\\eta))\\,c_0 - 4D\\,c_1 + D\\,c_2 = 0\n    $$\n    This equation is valid for $N \\ge 3$, which is satisfied by all test cases.\n\nThese $N$ discrete equations form a system of linear equations, $\\mathbf{A}\\mathbf{c} = \\mathbf{b}$, for the vector of concentrations $\\mathbf{c} = [c_0, c_1, \\dots, c_{N-1}]^T$. The $N \\times N$ matrix $\\mathbf{A}$ and the $N \\times 1$ vector $\\mathbf{b}$ are constructed as follows:\n\n-   **Row 0 (from the Robin BC at $i=0$):**\n    $$ A_{0,0} = 3D - 2\\,\\Delta x\\,k_f(\\eta), \\quad A_{0,1} = -4D, \\quad A_{0,2} = D $$\n    All other elements in this row are zero. The corresponding element in the right-hand side vector is $b_0 = 0$.\n\n-   **Rows $i=1, \\dots, N-2$ (from the interior diffusion equation):**\n    $$ A_{i, i-1} = 1, \\quad A_{i, i} = -2, \\quad A_{i, i+1} = 1 $$\n    All other elements in these rows are zero. The corresponding elements in the right-hand side vector are $b_i = 0$.\n\n-   **Row $N-1$ (from the Dirichlet BC at $i=N-1$):**\n    $$ A_{N-1, N-1} = 1 $$\n    All other elements in this row are zero. The corresponding element in the right-hand side vector is $b_{N-1} = c_b$.\n\nThe matrix $\\mathbf{A}$ depends on the overpotential $\\eta$ through the term $k_f(\\eta)$ in its first row. Thus, for each value of $\\eta$, a new linear system must be solved.\n\nThe computational procedure for each test case (defined by a value of $N$) is as follows:\n1.  Define the physical and numerical parameters. Calculate the theoretical Tafel slope, $S_{\\mathrm{T}} = \\frac{\\alpha n F}{R T\\,\\ln(10)}$.\n2.  Generate a set of $M=10$ uniformly spaced overpotentials $\\eta_k$ in the range $[\\eta_{\\min}, \\eta_{\\max}]$.\n3.  For each $\\eta_k$:\n    a. Construct the matrix $\\mathbf{A}(\\eta_k)$ and vector $\\mathbf{b}$ as described above.\n    b. Solve the linear system $\\mathbf{A}(\\eta_k)\\mathbf{c} = \\mathbf{b}$ for the concentration vector $\\mathbf{c}$. This can be done using a standard linear algebra library routine.\n    c. Extract the surface concentration, $c_0 = \\mathbf{c}[0]$.\n    d. Calculate the numerical current density, $j_{\\mathrm{num}}(\\eta_k) = n F k_f(\\eta_k) c_0$.\n4.  After computing the current for all overpotentials, perform a linear regression on the set of points $(\\eta_k, \\log_{10} j_{\\mathrm{num}}(\\eta_k))$. The slope of the resulting line is the numerical Tafel slope, $S_{\\mathrm{num}}$.\n5.  Finally, compute the absolute relative error $E = \\left|\\frac{S_{\\mathrm{num}} - S_{\\mathrm{T}}}{S_{\\mathrm{T}}}\\right|$.\n\nThis procedure is repeated for each value of $N$ given in the test suite ($N=101, 5, 3$) to obtain the required error values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the computational electrochemistry problem for the given test cases.\n    \"\"\"\n    \n    # --- Physical and numerical parameters ---\n    # Physical constants (SI units)\n    n = 1.0  # Number of electrons\n    F = 96485.0  # Faraday constant (C/mol)\n    R = 8.314  # Universal gas constant (J/(mol*K))\n    T = 298.0  # Temperature (K)\n    alpha = 0.5  # Charge transfer coefficient\n    \n    # System parameters (SI units)\n    D = 1e-9  # Diffusion coefficient (m^2/s)\n    L = 1e-6  # Domain length (m)\n    k0 = 1e-5  # Standard heterogeneous rate constant (m/s)\n    cb = 1.0  # Bulk concentration (mol/m^3)\n    \n    # Numerical parameters\n    M = 10  # Number of overpotential points\n    eta_min = 0.01  # Minimum overpotential (V)\n    eta_max = 0.10  # Maximum overpotential (V)\n    \n    # Test cases for the number of grid nodes\n    test_cases = [101, 5, 3]\n    \n    # Generate the array of overpotentials\n    etas = np.linspace(eta_min, eta_max, M)\n\n    # --- Pre-calculate constant terms ---\n    # Theoretical Tafel slope\n    st_theoretical = (alpha * n * F) / (R * T * np.log(10))\n    # Exponent factor for k_f\n    exp_factor = (alpha * n * F) / (R * T)\n\n    results = []\n    \n    for N in test_cases:\n        # Calculate grid spacing for the current case\n        if N > 1:\n            dx = L / (N - 1)\n        else: # Should not happen based on problem, but good practice\n            dx = L\n\n        log_j_nums = []\n\n        for eta in etas:\n            # --- Assemble the linear system A*c = b ---\n            A = np.zeros((N, N))\n            b = np.zeros(N)\n            \n            # Calculate potential-dependent rate constant\n            k_f = k0 * np.exp(exp_factor * eta)\n\n            # Equation for node i=0 (Robin BC)\n            # (3D - 2*dx*k_f)*c0 - 4D*c1 + D*c2 = 0\n            A[0, 0] = 3.0 * D - 2.0 * dx * k_f\n            A[0, 1] = -4.0 * D\n            A[0, 2] = 1.0 * D\n            \n            # Equations for interior nodes i=1 to N-2\n            # c_{i-1} - 2*c_i + c_{i+1} = 0\n            for i in range(1, N - 1):\n                A[i, i - 1] = 1.0\n                A[i, i] = -2.0\n                A[i, i + 1] = 1.0\n                \n            # Equation for node i=N-1 (Dirichlet BC)\n            # c_{N-1} = cb\n            A[N - 1, N - 1] = 1.0\n            b[N - 1] = cb\n            \n            # Solve the linear system for the concentration vector c\n            c = np.linalg.solve(A, b)\n            c0 = c[0]\n            \n            # Calculate numerical current density\n            j_num = n * F * k_f * c0\n            log_j_nums.append(np.log10(j_num))\n            \n        # --- Perform linear regression to find numerical Tafel slope ---\n        # scipy.stats.linregress(x, y) returns a result object\n        # The slope is the first element\n        regression_result = stats.linregress(etas, log_j_nums)\n        st_numerical = regression_result.slope\n        \n        # Calculate the absolute relative error\n        error = np.abs((st_numerical - st_theoretical) / st_theoretical)\n        results.append(error)\n        \n    # --- Final print statement in the exact required format ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Many transport phenomena in electrochemical systems are characterized by thin boundary layers where concentrations or potentials change dramatically. This practice addresses the challenge of resolving these sharp gradients efficiently by focusing on the canonical advection-diffusion equation. You will implement a finite difference solver on both a uniform grid and a nonuniform, graded mesh designed to cluster points within the boundary layer, allowing for a quantitative comparison of their accuracy and demonstrating the power of mesh grading as an essential tool for practical computational modeling .",
            "id": "4245976",
            "problem": "Consider the one-dimensional, steady-state, dimensionless advection-diffusion transport of a single reactant in a planar electrochemical cell, modeled on the interval $[0,1]$ by the ordinary differential equation\n$$\\varepsilon\\,\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} - \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0,$$\nwith Dirichlet boundary conditions $u(0)=0$ and $u(1)=1$. Here, $u(x)$ denotes the dimensionless concentration of the reactant, and $\\varepsilon>0$ is a dimensionless parameter representing the ratio of diffusive to advective transport strength. For small $\\varepsilon$, a boundary layer forms near $x=1$.\n\nStarting from fundamental conservation of mass and flux balance principles, and without using any shortcut formulas, implement a finite difference discretization of the above boundary value problem on a general nonuniform mesh $\\{x_i\\}_{i=0}^N$ with $x_0=0$ and $x_N=1$. Use a three-point stencil at each interior node $x_i$ for $i=1,\\dots,N-1$ to approximate $\\mathrm{d}^2 u/\\mathrm{d}x^2$ on a nonuniform grid, and a first-order upwind (backward) difference for $\\mathrm{d}u/\\mathrm{d}x$ consistent with the sign of the advective term. Solve the resulting linear system to obtain the numerical approximation $\\{u_i\\}_{i=0}^N$.\n\nTo quantify mesh effects, compare a uniform mesh defined by $x_i = i/N$ for $i=0,\\dots,N$ with a graded mesh clustered near the boundary layer at $x=1$, defined by\n$$x_i = 1 - \\left(1 - \\frac{i}{N}\\right)^\\beta,$$\nwhere $\\beta>1$ is the grading exponent. For each test case, compute the maximum absolute error\n$$E = \\max_{0\\le i \\le N} \\left|u_i - u_{\\text{exact}}(x_i)\\right|,$$\nwhere the exact solution is\n$$u_{\\text{exact}}(x) = \\frac{\\exp\\!\\left(\\frac{x}{\\varepsilon}\\right) - 1}{\\exp\\!\\left(\\frac{1}{\\varepsilon}\\right) - 1}.$$\nReport the improvement factor from grading as the ratio $E_{\\text{uniform}}/E_{\\text{graded}}$.\n\nAll quantities are dimensionless; there are no physical or numerical units to report. Angles are not involved. Your program must implement the discretization and error computation for the following test suite, each specified by $(\\varepsilon, N, \\beta)$:\n\n- Test $1$: $(\\varepsilon, N, \\beta) = (0.05, 64, 2.0)$, a moderate boundary layer thickness with medium resolution.\n- Test $2$: $(\\varepsilon, N, \\beta) = (0.01, 64, 3.0)$, a sharper boundary layer at the same resolution.\n- Test $3$: $(\\varepsilon, N, \\beta) = (0.50, 64, 2.0)$, weak boundary layer where grading should offer limited improvement.\n- Test $4$: $(\\varepsilon, N, \\beta) = (0.02, 32, 4.0)$, coarse resolution with strong grading.\n\nYour program should produce a single line of output containing the improvement factors for Tests $1$ through $4$ as a comma-separated list enclosed in square brackets (for example, $\\texttt{[f_1,f_2,f_3,f_4]}$), where each $f_k$ is a floating-point number equal to $E_{\\text{uniform}}/E_{\\text{graded}}$ for Test $k$ computed as specified above.",
            "solution": "The user wants to solve a one-dimensional, steady-state advection-diffusion boundary value problem and analyze the effect of mesh grading on the numerical error.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $\\varepsilon\\,\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} - \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0$ for $x \\in [0,1]$.\n- **Boundary Conditions**: $u(0)=0$ and $u(1)=1$.\n- **Parameter**: $\\varepsilon > 0$, a dimensionless parameter.\n- **Numerical Mesh**: A general nonuniform mesh $\\{x_i\\}_{i=0}^N$ with $x_0=0$ and $x_N=1$.\n- **Discretization Scheme**:\n    - **Diffusion Term ($\\mathrm{d}^2 u/\\mathrm{d}x^2$)**: Three-point stencil on a nonuniform grid.\n    - **Advection Term ($\\mathrm{d}u/\\mathrm{d}x$)**: First-order upwind (backward) difference.\n- **Mesh Definitions**:\n    - **Uniform Mesh**: $x_i = i/N$ for $i=0,\\dots,N$.\n    - **Graded Mesh**: $x_i = 1 - (1 - i/N)^\\beta$ for $i=0,\\dots,N$, with grading exponent $\\beta>1$.\n- **Error Metric**: Maximum absolute error $E = \\max_{0\\le i \\le N} |u_i - u_{\\text{exact}}(x_i)|$.\n- **Exact Solution**: $u_{\\text{exact}}(x) = (\\exp(x/\\varepsilon) - 1) / (\\exp(1/\\varepsilon) - 1)$.\n- **Output Metric**: Improvement factor $E_{\\text{uniform}}/E_{\\text{graded}}$.\n- **Test Cases $(\\varepsilon, N, \\beta)$**:\n    1. $(0.05, 64, 2.0)$\n    2. $(0.01, 64, 3.0)$\n    3. $(0.50, 64, 2.0)$\n    4. $(0.02, 32, 4.0)$\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes the steady-state advection-diffusion equation, a fundamental model in transport phenomena. The equation, boundary conditions, and the provided exact solution are mathematically and physically correct. The proposed finite difference method is a standard and appropriate numerical technique. The problem is sound.\n2.  **Well-Posed**: The problem is a second-order linear ordinary differential equation with two Dirichlet boundary conditions. This constitutes a well-posed boundary value problem, which is confirmed by the existence of the unique exact solution provided.\n3.  **Objective**: The problem is stated in precise, objective mathematical language.\n4.  **Completeness**: All necessary information is provided: the model equation, boundary conditions, mesh generation formulas, discretization instructions, error metric, and specific test parameters. The problem is self-contained.\n5.  **Other Flaws**: The problem is not trivial, circular, ambiguous, or based on any other fallacies. It presents a standard exercise in numerical analysis and computational physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the detailed derivation and implementation.\n\n### Principle-Based Derivation and Solution Design\n\nThe core of the problem is to discretize the governing ordinary differential equation (ODE) on a nonuniform mesh and solve the resulting linear system. The derivation must adhere to the specified methods for each term.\n\n**1. Discretization of the Diffusion Term**\n\nWe are asked to use a three-point stencil to approximate the second derivative, $\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2}$, at an interior node $x_i$ on a nonuniform mesh. Let $u_i = u(x_i)$, and let the grid spacings be $h_i = x_i - x_{i-1}$ and $h_{i+1} = x_{i+1} - x_i$. We use Taylor series expansions around $x_i$ for $u_{i+1}$ and $u_{i-1}$:\n$$u_{i+1} = u_i + h_{i+1} u'(x_i) + \\frac{h_{i+1}^2}{2} u''(x_i) + O(h_{i+1}^3)$$\n$$u_{i-1} = u_i - h_i u'(x_i) + \\frac{h_i^2}{2} u''(x_i) + O(h_i^3)$$\nTo find an expression for $u''(x_i)$, we must eliminate the $u'(x_i)$ term. We multiply the first equation by $h_i$ and the second by $h_{i+1}$ and add them:\n$$h_i u_{i+1} + h_{i+1} u_{i-1} = (h_i+h_{i+1})u_i + \\frac{h_i h_{i+1}^2 + h_{i+1} h_i^2}{2}u''(x_i) + \\dots$$\nSolving for $u''(x_i)$ yields the second-order accurate central difference formula on a nonuniform grid:\n$$\\left(\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2}\\right)_i \\approx \\frac{2}{h_i h_{i+1} (h_i+h_{i+1})} \\left( h_i u_{i+1} - (h_i+h_{i+1})u_i + h_{i+1}u_{i-1} \\right)$$\nRearranging terms, we get the stencil coefficients:\n$$\\left(\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2}\\right)_i \\approx \\left(\\frac{2}{h_{i+1}(h_i+h_{i+1})}\\right) u_{i+1} - \\left(\\frac{2}{h_i h_{i+1}}\\right) u_i + \\left(\\frac{2}{h_i(h_i+h_{i+1})}\\right) u_{i-1}$$\n\n**2. Discretization of the Advection Term**\n\nThe problem specifies a first-order upwind difference for the advection term, $\\frac{\\mathrm{d}u}{\\mathrm{d}x}$. The governing equation is $\\varepsilon u'' - u' = 0$. The advection term is $-u'$, with a coefficient of $-1$. This implies the advective velocity is positive, flowing in the direction of increasing $x$. An \"upwind\" scheme, therefore, must draw information from the upstream direction (smaller $x$). This corresponds to a first-order backward difference:\n$$\\left(\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)_i \\approx \\frac{u_i - u_{i-1}}{x_i - x_{i-1}} = \\frac{u_i - u_{i-1}}{h_i}$$\n\n**3. Assembling the Discretized Equation**\n\nWe substitute the approximations for the derivatives into the governing ODE, $\\varepsilon u'' - u' = 0$, for each interior node $i = 1, \\dots, N-1$:\n$$\\varepsilon \\left[ \\left(\\frac{2}{h_{i+1}(h_i+h_{i+1})}\\right) u_{i+1} - \\left(\\frac{2}{h_i h_{i+1}}\\right) u_i + \\left(\\frac{2}{h_i(h_i+h_{i+1})}\\right) u_{i-1} \\right] - \\left[ \\frac{u_i - u_{i-1}}{h_i} \\right] = 0$$\nTo form a linear system, we group terms by the unknown values $u_{i-1}$, $u_i$, and $u_{i+1}$:\n$$A_i u_{i-1} + B_i u_i + C_i u_{i+1} = 0$$\nwhere the coefficients are:\n$$A_i = \\frac{2\\varepsilon}{h_i(h_i+h_{i+1})} + \\frac{1}{h_i}$$\n$$B_i = -\\frac{2\\varepsilon}{h_i h_{i+1}} - \\frac{1}{h_i}$$\n$$C_i = \\frac{2\\varepsilon}{h_{i+1}(h_i+h_{i+1})}$$\n\n**4. Constructing the Linear System**\n\nThis set of $N-1$ linear equations for the $N-1$ interior unknowns $\\{u_i\\}_{i=1}^{N-1}$ can be written in matrix form $\\mathbf{M}\\mathbf{u}_{\\text{internal}} = \\mathbf{b}$. The boundary conditions $u_0=0$ and $u_N=1$ are incorporated as follows:\n\n- For the first interior node ($i=1$):\n  $A_1 u_0 + B_1 u_1 + C_1 u_2 = 0$. Since $u_0=0$, the equation becomes $B_1 u_1 + C_1 u_2 = 0$. This defines the first row of the matrix $\\mathbf{M}$ and the right-hand side vector $\\mathbf{b}$.\n\n- For a general interior node ($1 < i < N-1$):\n  $A_i u_{i-1} + B_i u_i + C_i u_{i+1} = 0$. This defines a generic row in the tridiagonal system.\n\n- For the last interior node ($i=N-1$):\n  $A_{N-1} u_{N-2} + B_{N-1} u_{N-1} + C_{N-1} u_N = 0$. Since $u_N=1$, the equation becomes $A_{N-1} u_{N-2} + B_{N-1} u_{N-1} = -C_{N-1}$. This defines the last row of the system.\n\nThe resulting matrix $\\mathbf{M}$ is tridiagonal:\n$$\\mathbf{M} = \\begin{pmatrix}\nB_1 & C_1 & 0 & \\dots & 0 \\\\\nA_2 & B_2 & C_2 & \\dots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n0 & \\dots & A_{N-2} & B_{N-2} & C_{N-2} \\\\\n0 & \\dots & 0 & A_{N-1} & B_{N-1}\n\\end{pmatrix}$$\nThe right-hand side vector $\\mathbf{b}$ is:\n$$\\mathbf{b} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ -C_{N-1} \\end{pmatrix}$$\n\n**5. Algorithm Implementation**\n\nFor each test case, the following steps are performed twice: once for a uniform mesh ($\\beta=1$) and once for the specified graded mesh ($\\beta > 1$).\n\n1.  **Generate Mesh**: Create the array of node coordinates $\\{x_i\\}_{i=0}^N$ using the appropriate formula.\n2.  **Calculate Spacings**: Compute the interval widths $h_i = x_i - x_{i-1}$ for $i=1, \\dots, N$.\n3.  **Assemble System**: Construct the $(N-1) \\times (N-1)$ tridiagonal matrix $\\mathbf{M}$ and the $(N-1) \\times 1$ vector $\\mathbf{b}$ by iterating from $i=1$ to $N-1$ and calculating the coefficients $A_i, B_i, C_i$.\n4.  **Solve System**: Solve the linear system $\\mathbf{M}\\mathbf{u}_{\\text{internal}} = \\mathbf{b}$ for the interior nodal values $\\mathbf{u}_{\\text{internal}} = [u_1, \\dots, u_{N-1}]^T$.\n5.  **Compute Error**: Combine the boundary values and the computed interior values to form the full numerical solution $\\{u_i\\}_{i=0}^N$. Calculate the exact solution $u_{\\text{exact}}(x_i)$ at each node and find the maximum absolute error $E = \\max_{i} |u_i - u_{\\text{exact}}(x_i)|$.\n6.  **Calculate Improvement**: After computing the errors for both uniform ($E_{\\text{uniform}}$) and graded ($E_{\\text{graded}}$) meshes, the improvement factor is calculated as the ratio $E_{\\text{uniform}} / E_{\\text{graded}}$.\n\nThe final output will be a list of these improvement factors for all test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the advection-diffusion problem for a series of test cases and\n    computes the error improvement factor from using a graded mesh.\n    \"\"\"\n\n    def get_exact_solution(x, eps):\n        \"\"\"\n        Computes the exact solution of the BVP.\n        u(x) = (exp(x/eps) - 1) / (exp(1/eps) - 1)\n        \"\"\"\n        numerator = np.exp(x / eps) - 1.0\n        denominator = np.exp(1.0 / eps) - 1.0\n        # This form is numerically stable for the given eps values\n        return numerator / denominator\n\n    def solve_bvp(eps, N, beta):\n        \"\"\"\n        Discretizes and solves the BVP on a potentially nonuniform mesh.\n\n        Args:\n            eps (float): The dimensionless diffusion/advection ratio.\n            N (int): The number of intervals in the mesh.\n            beta (float): The mesh grading exponent. beta=1.0 for a uniform mesh.\n\n        Returns:\n            float: The maximum absolute error against the exact solution.\n        \"\"\"\n        # 1. Generate mesh coordinates\n        i_vals = np.arange(N + 1)\n        if beta == 1.0:\n            # Uniform mesh\n            x = i_vals / N\n        else:\n            # Graded mesh clustered at x=1\n            x = 1.0 - (1.0 - i_vals / N)**beta\n\n        # 2. Calculate grid spacings h[k] = x_{k+1} - x_k\n        h = np.diff(x)  # h has size N. h[i-1] corresponds to our h_i notation.\n\n        # 3. Assemble the (N-1)x(N-1) linear system M*u = b\n        num_unknowns = N - 1\n        A_coeffs = np.zeros(num_unknowns)\n        B_coeffs = np.zeros(num_unknowns)\n        C_coeffs = np.zeros(num_unknowns)\n        b = np.zeros(num_unknowns)\n\n        # Loop over interior nodes i = 1, ..., N-1\n        # which corresponds to matrix rows j = 0, ..., N-2\n        for i in range(1, N):\n            j = i - 1  # Matrix/vector index\n            \n            # Grid spacings around node i\n            h_i = h[i - 1]  # spacing x_i - x_{i-1}\n            h_i_plus_1 = h[i] # spacing x_{i+1} - x_i\n            \n            # Coefficients of the discrete equation: A_i*u_{i-1} + B_i*u_i + C_i*u_{i+1} = 0\n            # Derived from epsilon*u'' - u' = 0\n            A_coeffs[j] = eps * 2.0 / (h_i * (h_i + h_i_plus_1)) + 1.0 / h_i\n            B_coeffs[j] = -eps * 2.0 / (h_i * h_i_plus_1) - 1.0 / h_i\n            C_coeffs[j] = eps * 2.0 / (h_i_plus_1 * (h_i + h_i_plus_1))\n\n        # Build the tridiagonal matrix M\n        M = np.diag(B_coeffs) + np.diag(C_coeffs[:-1], k=1) + np.diag(A_coeffs[1:], k=-1)\n        \n        # Apply boundary conditions\n        # u_0 = 0 is handled implicitly as A_1*u_0 does not contribute to the RHS\n        # u_N = 1 modifies the last equation\n        # A_{N-1}*u_{N-2} + B_{N-1}*u_{N-1} + C_{N-1}*u_N = 0\n        # becomes A_{N-1}*u_{N-2} + B_{N-1}*u_{N-1} = -C_{N-1}\n        b[-1] = -C_coeffs[-1]\n\n        # 4. Solve the linear system\n        u_internal = np.linalg.solve(M, b)\n\n        # 5. Construct full solution and compute error\n        u_numerical = np.concatenate(([0.0], u_internal, [1.0]))\n        u_exact = get_exact_solution(x, eps)\n        \n        error = np.max(np.abs(u_numerical - u_exact))\n        \n        return error\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (epsilon, N, beta)\n        (0.05, 64, 2.0),\n        (0.01, 64, 3.0),\n        (0.50, 64, 2.0),\n        (0.02, 32, 4.0),\n    ]\n\n    results = []\n    for eps, N, beta in test_cases:\n        # Calculate error on a uniform mesh (beta=1.0)\n        error_uniform = solve_bvp(eps, N, 1.0)\n        \n        # Calculate error on the specified graded mesh\n        error_graded = solve_bvp(eps, N, beta)\n        \n        # Compute improvement factor and append to results\n        improvement_factor = error_uniform / error_graded\n        results.append(improvement_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Advanced electrochemical models often involve tightly coupled, nonlinear partial differential equations that are computationally challenging to solve. This final practice moves from direct simulation to the theoretical groundwork required for building robust, implicit solvers for such systems, focusing on the Poisson-Nernst-Planck equations. Your task is to perform the analytical derivation of the Jacobian matrix entries for a Newton-Raphson linearization, a critical skill for implementing implicit methods that can overcome the severe time-step limitations of explicit schemes when dealing with stiff problems like charge relaxation in electrolytes .",
            "id": "4245958",
            "problem": "Consider a one-dimensional binary electrolyte model for a single ionic species with valence $z$, concentration $c(x,t)$, and electrostatic potential $\\phi(x,t)$ in a slab of length $L$. The ion transport is governed by mass conservation coupled to the Nernst–Planck flux and the electrostatic potential satisfies the Poisson equation. The governing equations are:\n- Mass conservation: $\\frac{\\partial c}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0$.\n- Nernst–Planck flux (diffusion plus migration): $J = - D \\frac{\\partial c}{\\partial x} - z u\\, c\\, \\frac{\\partial \\phi}{\\partial x}$, where $D$ is the diffusion coefficient and $u$ is the ionic mobility.\n- Poisson equation: $- \\varepsilon \\frac{\\partial^{2} \\phi}{\\partial x^{2}} = q z c + \\rho_{f}(x)$, where $\\varepsilon$ is the permittivity, $q$ is the elementary charge magnitude, and $\\rho_{f}(x)$ is a given fixed charge density.\n\nDiscretize the domain on a uniform grid with spacing $h$ and nodes indexed by $k \\in \\{1,2,\\ldots,N\\}$. Use a fully implicit backward Euler step from time level $n$ to $n+1$, and define unknowns at time $n+1$ as $c_{k}$ and $\\phi_{k}$. Use two-point face fluxes with central differences and arithmetic averaging:\n- Face concentration: $c_{k+1/2} = \\frac{c_{k+1} + c_{k}}{2}$ and $c_{k-1/2} = \\frac{c_{k} + c_{k-1}}{2}$.\n- Face potential differences: $\\Delta \\phi_{k+1/2} = \\phi_{k+1} - \\phi_{k}$ and $\\Delta \\phi_{k-1/2} = \\phi_{k} - \\phi_{k-1}$.\n- Discrete fluxes:\n$$\nJ_{k+1/2} = - D \\frac{c_{k+1} - c_{k}}{h} - z u\\, c_{k+1/2}\\, \\frac{\\Delta \\phi_{k+1/2}}{h}, \\quad\nJ_{k-1/2} = - D \\frac{c_{k} - c_{k-1}}{h} - z u\\, c_{k-1/2}\\, \\frac{\\Delta \\phi_{k-1/2}}{h}.\n$$\nDefine the residuals at an interior node $k$ as\n$$\nR_{k}(c,\\phi) = \\frac{c_{k} - c_{k}^{n}}{\\Delta t} + \\frac{J_{k+1/2} - J_{k-1/2}}{h}, \\qquad\nP_{k}(c,\\phi) = - \\varepsilon \\frac{\\phi_{k+1} - 2 \\phi_{k} + \\phi_{k-1}}{h^{2}} - q z c_{k} - \\rho_{f,k}.\n$$\n\nYou will assemble a Newton linearization of the coupled system. Starting from the given governing laws and the stated discretization, derive the analytic partial derivatives of the migration contribution to the face fluxes with respect to both $c$ and $\\phi$ at the neighboring nodes, and then assemble the Jacobian entries for $R_{k}$ with respect to $c_{k-1}$, $c_{k}$, $c_{k+1}$, $\\phi_{k-1}$, $\\phi_{k}$, and $\\phi_{k+1}$. Also identify the Jacobian entries for $P_{k}$ with respect to $c_{k}$, $\\phi_{k-1}$, $\\phi_{k}$, and $\\phi_{k+1}$.\n\nFinally, provide the explicit closed-form expression for the Jacobian entry $\\frac{\\partial R_{k}}{\\partial \\phi_{k}}$ in terms of $z$, $u$, $h$, $c_{k-1}$, $c_{k}$, and $c_{k+1}$. Express your final answer as a single analytic expression. No numerical evaluation or rounding is required.",
            "solution": "The starting point is mass conservation coupled with the Nernst–Planck flux for a single ionic species and the Poisson equation. For a uniform grid with spacing $h$, the fully implicit residuals at an interior node $k$ are\n$$\nR_{k}(c,\\phi) = \\frac{c_{k} - c_{k}^{n}}{\\Delta t} + \\frac{J_{k+1/2} - J_{k-1/2}}{h},\n$$\n$$\nP_{k}(c,\\phi) = - \\varepsilon \\frac{\\phi_{k+1} - 2 \\phi_{k} + \\phi_{k-1}}{h^{2}} - q z c_{k} - \\rho_{f,k}.\n$$\nThe discrete face fluxes comprise diffusion and migration:\n$$\nJ_{k+1/2} = - D \\frac{c_{k+1} - c_{k}}{h} - z u\\, c_{k+1/2}\\, \\frac{\\Delta \\phi_{k+1/2}}{h}, \\quad c_{k+1/2} = \\frac{c_{k+1} + c_{k}}{2}, \\quad \\Delta \\phi_{k+1/2} = \\phi_{k+1} - \\phi_{k},\n$$\n$$\nJ_{k-1/2} = - D \\frac{c_{k} - c_{k-1}}{h} - z u\\, c_{k-1/2}\\, \\frac{\\Delta \\phi_{k-1/2}}{h}, \\quad c_{k-1/2} = \\frac{c_{k} + c_{k-1}}{2}, \\quad \\Delta \\phi_{k-1/2} = \\phi_{k} - \\phi_{k-1}.\n$$\n\nWe first compute the partial derivatives of the migration contributions of the face fluxes with respect to $c$ and $\\phi$. Denote the migration parts as\n$$\nJ_{k+1/2}^{\\text{mig}} = - z u\\, c_{k+1/2}\\, \\frac{\\Delta \\phi_{k+1/2}}{h}, \\qquad\nJ_{k-1/2}^{\\text{mig}} = - z u\\, c_{k-1/2}\\, \\frac{\\Delta \\phi_{k-1/2}}{h}.\n$$\n\nDerivatives of $J_{k+1/2}^{\\text{mig}}$ with respect to $c_{k}$ and $c_{k+1}$ use $\\frac{\\partial c_{k+1/2}}{\\partial c_{k}} = \\frac{1}{2}$ and $\\frac{\\partial c_{k+1/2}}{\\partial c_{k+1}} = \\frac{1}{2}$, and $\\Delta \\phi_{k+1/2}$ is independent of $c$:\n$$\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial c_{k}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k+1/2}}{h}, \\qquad\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial c_{k+1}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k+1/2}}{h}.\n$$\nSimilarly, derivatives with respect to $\\phi_{k}$ and $\\phi_{k+1}$ treat $c_{k+1/2}$ as constant and use $\\frac{\\partial \\Delta \\phi_{k+1/2}}{\\partial \\phi_{k}} = -1$, $\\frac{\\partial \\Delta \\phi_{k+1/2}}{\\partial \\phi_{k+1}} = 1$:\n$$\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial \\phi_{k}} = - z u\\, c_{k+1/2}\\, \\frac{(-1)}{h} = \\frac{z u}{h} c_{k+1/2}, \\qquad\n\\frac{\\partial J_{k+1/2}^{\\text{mig}}}{\\partial \\phi_{k+1}} = - z u\\, c_{k+1/2}\\, \\frac{(1)}{h} = - \\frac{z u}{h} c_{k+1/2}.\n$$\n\nFor the left face:\n$$\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial c_{k}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k-1/2}}{h}, \\qquad\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial c_{k-1}} = - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k-1/2}}{h},\n$$\nand using $\\frac{\\partial \\Delta \\phi_{k-1/2}}{\\partial \\phi_{k}} = 1$, $\\frac{\\partial \\Delta \\phi_{k-1/2}}{\\partial \\phi_{k-1}} = -1$:\n$$\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial \\phi_{k}} = - z u\\, c_{k-1/2}\\, \\frac{(1)}{h} = - \\frac{z u}{h} c_{k-1/2}, \\qquad\n\\frac{\\partial J_{k-1/2}^{\\text{mig}}}{\\partial \\phi_{k-1}} = - z u\\, c_{k-1/2}\\, \\frac{(-1)}{h} = \\frac{z u}{h} c_{k-1/2}.\n$$\n\nFor completeness, include the diffusion contributions of the face flux derivatives, which depend only on $c$:\n$$\n\\frac{\\partial}{\\partial c_{k}} \\left(- D \\frac{c_{k+1} - c_{k}}{h} \\right) = \\frac{D}{h}, \\quad\n\\frac{\\partial}{\\partial c_{k+1}} \\left(- D \\frac{c_{k+1} - c_{k}}{h} \\right) = - \\frac{D}{h},\n$$\n$$\n\\frac{\\partial}{\\partial c_{k}} \\left(- D \\frac{c_{k} - c_{k-1}}{h} \\right) = - \\frac{D}{h}, \\quad\n\\frac{\\partial}{\\partial c_{k-1}} \\left(- D \\frac{c_{k} - c_{k-1}}{h} \\right) = \\frac{D}{h},\n$$\nand zero with respect to $\\phi$.\n\nNow assemble Jacobian entries of $R_{k}$ with respect to the local stencil $\\{c_{k-1}, c_{k}, c_{k+1}, \\phi_{k-1}, \\phi_{k}, \\phi_{k+1}\\}$. By definition,\n$$\nR_{k} = \\frac{c_{k} - c_{k}^{n}}{\\Delta t} + \\frac{1}{h} \\left(J_{k+1/2} - J_{k-1/2}\\right).\n$$\nHence, for any variable $\\xi$,\n$$\n\\frac{\\partial R_{k}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{c_{k} - c_{k}^{n}}{\\Delta t} \\right) + \\frac{1}{h} \\left( \\frac{\\partial J_{k+1/2}}{\\partial \\xi} - \\frac{\\partial J_{k-1/2}}{\\partial \\xi} \\right).\n$$\nFrom the time term, only $\\frac{\\partial R_{k}}{\\partial c_{k}}$ gains $\\frac{1}{\\Delta t}$. The flux derivatives contribute according to the formulas above. In particular, to satisfy the requirement to include migration derivatives with respect to both $c$ and $\\phi$, we note explicitly that, for example,\n$$\n\\frac{\\partial R_{k}}{\\partial c_{k}} \\supset \\frac{1}{h} \\left( - z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k+1/2}}{h} - \\left[- z u \\left(\\frac{1}{2}\\right) \\frac{\\Delta \\phi_{k-1/2}}{h}\\right] \\right) = - \\frac{z u}{2 h^{2}} \\left( \\Delta \\phi_{k+1/2} - \\Delta \\phi_{k-1/2} \\right),\n$$\nand, for the potential dependence,\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{1}{h} \\left( \\frac{\\partial J_{k+1/2}}{\\partial \\phi_{k}} - \\frac{\\partial J_{k-1/2}}{\\partial \\phi_{k}} \\right),\n$$\nwith only the migration parts contributing:\n$$\n\\frac{\\partial J_{k+1/2}}{\\partial \\phi_{k}} = \\frac{z u}{h} c_{k+1/2}, \\qquad \\frac{\\partial J_{k-1/2}}{\\partial \\phi_{k}} = - \\frac{z u}{h} c_{k-1/2}.\n$$\nThus,\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{1}{h} \\left( \\frac{z u}{h} c_{k+1/2} - \\left[ - \\frac{z u}{h} c_{k-1/2} \\right] \\right) = \\frac{z u}{h^{2}} \\left( c_{k+1/2} + c_{k-1/2} \\right).\n$$\nExpressing the face concentrations in terms of nodal values,\n$$\nc_{k+1/2} = \\frac{c_{k+1} + c_{k}}{2}, \\qquad c_{k-1/2} = \\frac{c_{k} + c_{k-1}}{2},\n$$\nyields\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{z u}{h^{2}} \\left( \\frac{c_{k+1} + c_{k}}{2} + \\frac{c_{k} + c_{k-1}}{2} \\right) = \\frac{z u}{2 h^{2}} \\left( c_{k+1} + 2 c_{k} + c_{k-1} \\right).\n$$\n\nFor completeness, the Poisson residual Jacobian entries follow directly from $P_{k}$:\n$$\n\\frac{\\partial P_{k}}{\\partial \\phi_{k-1}} = - \\varepsilon \\left( \\frac{1}{h^{2}} \\right), \\quad\n\\frac{\\partial P_{k}}{\\partial \\phi_{k}} = - \\varepsilon \\left( \\frac{-2}{h^{2}} \\right) = \\frac{2 \\varepsilon}{h^{2}}, \\quad\n\\frac{\\partial P_{k}}{\\partial \\phi_{k+1}} = - \\varepsilon \\left( \\frac{1}{h^{2}} \\right), \\quad\n\\frac{\\partial P_{k}}{\\partial c_{k}} = - q z,\n$$\nand $\\frac{\\partial P_{k}}{\\partial c_{j}} = 0$ for $j \\neq k$, $\\frac{\\partial P_{k}}{\\partial \\phi_{j}} = 0$ for $j \\notin \\{k-1,k,k+1\\}$.\n\nThe requested explicit closed-form expression for the Jacobian entry $\\frac{\\partial R_{k}}{\\partial \\phi_{k}}$ in terms of $z$, $u$, $h$, $c_{k-1}$, $c_{k}$, and $c_{k+1}$ is therefore\n$$\n\\frac{\\partial R_{k}}{\\partial \\phi_{k}} = \\frac{z u}{2 h^{2}} \\left( c_{k+1} + 2 c_{k} + c_{k-1} \\right).\n$$",
            "answer": "$$\\boxed{\\frac{z\\,u}{2\\,h^{2}}\\left(c_{k+1}+2c_{k}+c_{k-1}\\right)}$$"
        }
    ]
}