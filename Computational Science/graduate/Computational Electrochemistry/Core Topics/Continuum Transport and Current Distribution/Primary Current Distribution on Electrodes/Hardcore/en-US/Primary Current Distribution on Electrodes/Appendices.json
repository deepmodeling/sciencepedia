{
    "hands_on_practices": [
        {
            "introduction": "Before writing code to solve a physical problem, it's crucial to understand the nature of its governing equations and boundary conditions. This exercise  explores the distinction between potential-controlled (Dirichlet) and current-controlled (Neumann) boundary conditions for the governing Laplace equation. Mastering this helps clarify the mathematical well-posedness of a problem, revealing profound implications for the existence and uniqueness of the potential field solution, $\\phi$.",
            "id": "4255413",
            "problem": "Consider an electrolyte-filled domain $\\Omega \\subset \\mathbb{R}^3$ of constant conductivity $\\kappa0$ in steady state, where the primary current distribution is modeled by Ohmic conduction and charge conservation. Let the electric potential be $\\phi(\\mathbf{x})$ and the current density be $\\mathbf{j}(\\mathbf{x})$. Under the assumptions of primary current distribution (negligible activation overpotential and concentration gradients, homogeneous electrolyte), the governing equations are the constitutive relation $\\mathbf{j} = -\\kappa \\nabla \\phi$ and local conservation of charge $\\nabla \\cdot \\mathbf{j} = 0$. The latter implies the Laplace equation $\\nabla^2 \\phi = 0$ in $\\Omega$. The boundary $\\partial \\Omega$ is partitioned into the working electrode $\\Gamma_{\\mathrm{W}}$, the counter electrode $\\Gamma_{\\mathrm{C}}$, and insulating walls $\\Gamma_{\\mathrm{I}}$. The outward unit normal on $\\partial \\Omega$ is $\\mathbf{n}$.\n\nTwo operating modes are considered:\n\nCase $1$ (potential-controlled): the electrode potentials are prescribed, with $\\phi = V_{\\mathrm{W}}$ on $\\Gamma_{\\mathrm{W}}$ and $\\phi = V_{\\mathrm{C}}$ on $\\Gamma_{\\mathrm{C}}$, and insulation on $\\Gamma_{\\mathrm{I}}$.\n\nCase $2$ (current-controlled): the normal current density is prescribed on electrode surfaces, with $\\mathbf{j} \\cdot \\mathbf{n} = i_{\\mathrm{W}}(\\mathbf{x})$ on $\\Gamma_{\\mathrm{W}}$ and $\\mathbf{j} \\cdot \\mathbf{n} = i_{\\mathrm{C}}(\\mathbf{x})$ on $\\Gamma_{\\mathrm{C}}$, and insulation on $\\Gamma_{\\mathrm{I}}$ (i.e., $\\mathbf{j}\\cdot \\mathbf{n} = 0$ on $\\Gamma_{\\mathrm{I}}$). Assume there are no volumetric sources or sinks of current in $\\Omega$.\n\nBased on the above fundamental laws and definitions, choose all statements that are correct regarding the mathematical character and well-posedness of primary current distribution in $\\Omega$ under these boundary conditions.\n\nA. In Case $1$, the solution $\\phi$ in $\\Omega$ is uniquely determined by the boundary data.\n\nB. In Case $2$, if $\\mathbf{j}\\cdot \\mathbf{n}$ is prescribed everywhere on $\\partial \\Omega$ and obeys global charge conservation, then the solution $\\phi$ in $\\Omega$ is unique up to an additive constant; fixing a single reference potential (for example, at one point or as an average) resolves this nonuniqueness.\n\nC. In Case $2$, prescribing $\\mathbf{j}\\cdot \\mathbf{n}$ only on $\\Gamma_{\\mathrm{W}}$ and imposing insulation on $\\Gamma_{\\mathrm{C}} \\cup \\Gamma_{\\mathrm{I}}$ yields a unique solution for $\\phi$ without any further constraints.\n\nD. In Case $2$, a necessary compatibility condition for existence is that $\\displaystyle \\int_{\\partial \\Omega} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S = 0$; violating this condition leads to nonexistence of a steady solution.\n\nE. In Case $1$, the solution $\\phi$ is unique only up to an additive constant unless the net current is $0$.\n\nF. In Case $2$, prescribing the total current $\\displaystyle I = \\int_{\\Gamma_{\\mathrm{W}}} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S$ suffices to determine $\\phi$ everywhere with no need to fix any reference potential.",
            "solution": "The problem statement is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Domain: Electrolyte-filled $\\Omega \\subset \\mathbb{R}^3$ with constant conductivity $\\kappa  0$.\n-   State: Steady state.\n-   Model: Primary current distribution.\n-   Governing Equations:\n    -   Constitutive relation: $\\mathbf{j} = -\\kappa \\nabla \\phi$.\n    -   Charge conservation: $\\nabla \\cdot \\mathbf{j} = 0$.\n    -   Combined equation: $\\nabla^2 \\phi = 0$ in $\\Omega$.\n-   Boundary: $\\partial \\Omega = \\Gamma_{\\mathrm{W}} \\cup \\Gamma_{\\mathrm{C}} \\cup \\Gamma_{\\mathrm{I}}$.\n-   Outward unit normal: $\\mathbf{n}$.\n-   Case $1$ (potential-controlled):\n    -   $\\phi = V_{\\mathrm{W}}$ on $\\Gamma_{\\mathrm{W}}$.\n    -   $\\phi = V_{\\mathrm{C}}$ on $\\Gamma_{\\mathrm{C}}$.\n    -   Insulation on $\\Gamma_{\\mathrm{I}}$ (which implies $\\mathbf{j} \\cdot \\mathbf{n} = -\\kappa \\frac{\\partial \\phi}{\\partial n} = 0$).\n-   Case $2$ (current-controlled):\n    -   $\\mathbf{j} \\cdot \\mathbf{n} = i_{\\mathrm{W}}(\\mathbf{x})$ on $\\Gamma_{\\mathrm{W}}$.\n    -   $\\mathbf{j} \\cdot \\mathbf{n} = i_{\\mathrm{C}}(\\mathbf{x})$ on $\\Gamma_{\\mathrm{C}}$.\n    -   Insulation on $\\Gamma_{\\mathrm{I}}$ ($\\mathbf{j} \\cdot \\mathbf{n} = 0$).\n-   Constraint: No volumetric sources or sinks of current in $\\Omega$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement describes the standard mathematical model for primary current distribution in an electrochemical cell. This is a classical application of potential theory.\n-   **Scientifically Grounded:** The problem uses the Laplace equation, $\\nabla^2 \\phi = 0$, derived from Ohm's law ($\\mathbf{j} = -\\kappa \\nabla \\phi$) and steady-state charge conservation ($\\nabla \\cdot \\mathbf{j} = 0$). These are fundamental and well-established principles in physics and electrochemistry.\n-   **Well-Posed:** The problem defines two standard boundary value problems for the Laplace equation. Case $1$ is a mixed Dirichlet-Neumann problem, and Case $2$ is a pure Neumann problem. The questions in the options concern the existence and uniqueness of solutions to these problems, which are central topics in the theory of partial differential equations.\n-   **Objective:** The language is formal, mathematical, and unambiguous. All terms are standard in the field.\nThe problem is free of scientific flaws, inconsistencies, or ambiguities. It is a well-posed and scientifically sound problem statement.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The analysis will proceed.\n\n### Solution Derivation\n\nThe governing partial differential equation for the electric potential $\\phi$ in the electrolyte domain $\\Omega$ is the Laplace equation:\n$$ \\nabla^2 \\phi = 0 $$\nThe properties of the solution $\\phi$ depend critically on the boundary conditions imposed on $\\partial \\Omega$.\n\n**Analysis of Case $1$ (Potential-Controlled)**\nThe boundary conditions are:\n-   $\\phi = V_{\\mathrm{W}}$ on $\\Gamma_{\\mathrm{W}}$ (Dirichlet condition)\n-   $\\phi = V_{\\mathrm{C}}$ on $\\Gamma_{\\mathrm{C}}$ (Dirichlet condition)\n-   $\\frac{\\partial \\phi}{\\partial n} = 0$ on $\\Gamma_{\\mathrm{I}}$ (Neumann condition)\nThis constitutes a mixed boundary value problem. A fundamental theorem for elliptic partial differential equations, such as the Laplace equation, states that a solution is unique if Dirichlet boundary conditions are specified on at least a part of the boundary with a non-zero measure. In this case, the potential $\\phi$ is fixed on the electrode surfaces $\\Gamma_{\\mathrm{W}} \\cup \\Gamma_{\\mathrm{C}}$. Assuming these are physical electrodes, this portion of the boundary has a non-zero measure. Therefore, the solution $\\phi(\\mathbf{x})$ is uniquely determined everywhere in $\\Omega$. An arbitrary additive constant cannot be added to the solution, as it would violate the prescribed potential values $V_{\\mathrm{W}}$ and $V_{\\mathrm{C}}$.\n\n**Analysis of Case $2$ (Current-Controlled)**\nThe boundary conditions are:\n-   $\\mathbf{j} \\cdot \\mathbf{n} = -\\kappa \\frac{\\partial \\phi}{\\partial n} = i_{\\mathrm{W}}(\\mathbf{x})$ on $\\Gamma_{\\mathrm{W}}$ (Neumann condition)\n-   $\\mathbf{j} \\cdot \\mathbf{n} = -\\kappa \\frac{\\partial \\phi}{\\partial n} = i_{\\mathrm{C}}(\\mathbf{x})$ on $\\Gamma_{\\mathrm{C}}$ (Neumann condition)\n-   $\\mathbf{j} \\cdot \\mathbf{n} = -\\kappa \\frac{\\partial \\phi}{\\partial n} = 0$ on $\\Gamma_{\\mathrm{I}}$ (Neumann condition)\nThis is a pure Neumann problem, as the normal derivative of the potential, $\\frac{\\partial \\phi}{\\partial n}$, is specified (up to a constant factor $-\\kappa$) over the entire boundary $\\partial \\Omega$.\n\nTwo key properties of the Neumann problem for the Laplace equation are relevant:\n$1$. **Existence:** A solution exists only if the boundary data satisfy a compatibility condition. Integrating the governing equation $\\nabla \\cdot \\mathbf{j} = 0$ over the domain $\\Omega$ and applying the divergence theorem gives:\n$$ \\int_{\\Omega} (\\nabla \\cdot \\mathbf{j}) \\, \\mathrm{d}V = \\int_{\\partial \\Omega} \\mathbf{j} \\cdot \\mathbf{n} \\, \\mathrm{d}S = 0 $$\nThis means the net current flux across the entire boundary must be zero. This is a statement of global charge conservation for the steady state.\n$2$. **Uniqueness:** If $\\phi(\\mathbf{x})$ is a solution, then $\\phi(\\mathbf{x}) + C$ for any arbitrary constant $C$ is also a solution. This is because $\\nabla(\\phi + C) = \\nabla \\phi$, so the current density $\\mathbf{j}$ and the normal derivative $\\frac{\\partial (\\phi+C)}{\\partial n}$ are unchanged. Thus, the solution is unique only up to an additive constant. To obtain a fully unique solution, the potential must be fixed at a reference point (e.g., $\\phi(\\mathbf{x}_0)=\\phi_{ref}$) or its average value specified (e.g., $\\int_{\\Omega} \\phi \\, \\mathrm{d}V = 0$).\n\n### Option-by-Option Analysis\n\n**A. In Case $1$, the solution $\\phi$ in $\\Omega$ is uniquely determined by the boundary data.**\nThis statement concerns the uniqueness of the solution to the mixed boundary value problem described in Case $1$. As established in the analysis, because the potential $\\phi$ is specified on a part of the boundary with positive measure ($\\Gamma_{\\mathrm{W}} \\cup \\Gamma_{\\mathrm{C}}$), the uniqueness theorem for the Laplace equation guarantees that the solution is unique.\n**Verdict: Correct.**\n\n**B. In Case $2$, if $\\mathbf{j}\\cdot \\mathbf{n}$ is prescribed everywhere on $\\partial \\Omega$ and obeys global charge conservation, then the solution $\\phi$ in $\\Omega$ is unique up to an additive constant; fixing a single reference potential (for example, at one point or as an average) resolves this nonuniqueness.**\nThis statement correctly describes the properties of the pure Neumann problem in Case $2$. Global charge conservation ($\\int_{\\partial \\Omega} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S = 0$) is the necessary condition for existence. If it is met, a solution exists, but it is unique only up to an additive constant $C$. Fixing the potential at a point or setting its average value serves to determine this constant $C$, thereby rendering the solution unique.\n**Verdict: Correct.**\n\n**C. In Case $2$, prescribing $\\mathbf{j}\\cdot \\mathbf{n}$ only on $\\Gamma_{\\mathrm{W}}$ and imposing insulation on $\\Gamma_{\\mathrm{C}} \\cup \\Gamma_{\\mathrm{I}}$ yields a unique solution for $\\phi$ without any further constraints.**\nThis scenario is a pure Neumann problem, as the normal current density (and thus $\\frac{\\partial \\phi}{\\partial n}$) is specified on the entire boundary $\\partial \\Omega$. The statement has two flaws. First, for a solution to exist, a \"further constraint\" is required: the compatibility condition $\\int_{\\partial \\Omega} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S = 0$. This simplifies to $\\int_{\\Gamma_{\\mathrm{W}}} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S = 0$, meaning the total current on the working electrode must be zero. Second, even if this condition holds, the solution is unique only up to an additive constant, not absolutely unique. The statement claims a \"unique solution\" \"without any further constraints,\" both of which are false.\n**Verdict: Incorrect.**\n\n**D. In Case $2$, a necessary compatibility condition for existence is that $\\displaystyle \\int_{\\partial \\Omega} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S = 0$; violating this condition leads to nonexistence of a steady solution.**\nThis is the solvability condition for the Neumann problem derived from the divergence theorem. If $\\int_{\\partial \\Omega} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S \\neq 0$, it would imply from the divergence theorem that $\\int_{\\Omega} \\nabla \\cdot \\mathbf{j} \\, \\mathrm{d}V \\neq 0$. This contradicts the fundamental assumption of steady-state charge conservation, $\\nabla \\cdot \\mathbf{j} = 0$. Therefore, no steady-state solution $\\phi$ can exist if this global charge balance is violated.\n**Verdict: Correct.**\n\n**E. In Case 1, the solution $\\phi$ is unique only up to an additive constant unless the net current is $0$.**\nThis statement is false. It incorrectly applies the uniqueness property of a pure Neumann problem to a mixed Dirichlet-Neumann problem. As explained for option A, the Dirichlet conditions $\\phi=V_{\\mathrm{W}}$ and $\\phi=V_{\\mathrm{C}}$ are sufficient to ensure a unique solution for $\\phi$ in Case $1$, regardless of the value of the net current. The solution is always unique, not unique up to an additive constant.\n**Verdict: Incorrect.**\n\n**F. In Case $2$, prescribing the total current $\\displaystyle I = \\int_{\\Gamma_{\\mathrm{W}}} \\mathbf{j}\\cdot \\mathbf{n}\\,\\mathrm{d}S$ suffices to determine $\\phi$ everywhere with no need to fix any reference potential.**\nThis statement is incorrect for two reasons. First, specifying only the total current $I$ on an electrode is insufficient information to define the Neumann boundary condition; the local distribution of the current density, $\\mathbf{j}\\cdot \\mathbf{n} = i_{\\mathrm{W}}(\\mathbf{x})$, must be prescribed over the entire surface $\\Gamma_{\\mathrm{W}}$. Second, even if a specific distribution is assumed (e.g., uniform current density), the problem remains a pure Neumann problem (Case $2$). As established, the solution to such a problem is inherently non-unique and contains an arbitrary additive constant. A reference potential must be fixed to resolve this ambiguity.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "Moving from a continuous partial differential equation (PDE) to a discrete, computable model is the heart of computational science. This practice  guides you through this process by developing a resistor-network approximation for a 2D electrolyte domain. By starting from the first principles of charge conservation, you will learn how to correctly map continuous material properties, like conductivity $\\kappa$, onto discrete conductances, a technique central to the finite volume method.",
            "id": "4255414",
            "problem": "Consider a two-dimensional electrolyte domain of dimensions $L_x \\times L_y$ and out-of-plane thickness $b$, with spatially varying isotropic conductivity $\\kappa(x,y)$, in which primary current distribution holds. The governing equation is $\\nabla \\cdot \\left(\\kappa \\nabla \\phi\\right) = 0$ for the electrolyte potential $\\phi(x,y)$, where the current density is $\\mathbf{j} = -\\kappa \\nabla \\phi$. An electrode at $x=0$ imposes a specified potential $\\phi = \\phi_e$ (Dirichlet boundary), and the opposite wall at $x = L_x$ is insulating, i.e., $j_n = 0$ (Neumann boundary). The boundaries at $y=0$ and $y=L_y$ are also insulating. You aim to construct a resistor-network approximation by discretizing the domain into a uniform structured grid with spacings $\\Delta x$ and $\\Delta y$, placing nodes at cell centers $(i,j)$, and connecting adjacent nodes with resistors so that Kirchhoff’s Current Law (KCL) holds at each internal node.\n\nStarting from the conservation statement $\\int_{\\Omega_{ij}} \\nabla \\cdot \\left(\\kappa \\nabla \\phi\\right)\\, dA = 0$ over a rectangular control volume $\\Omega_{ij}$ of area $\\Delta x \\Delta y$, use first principles to justify how the continuous conductivity $\\kappa$ maps to discrete inter-nodal conductances $G$ in the resistor network such that the resulting discrete currents $I = G\\,(\\phi_{\\text{left}} - \\phi_{\\text{right}})$ across faces are consistent with the face fluxes $-\\kappa \\,\\partial \\phi/\\partial n$ integrated over the face area $A_{\\text{face}} = b \\times$ (face length). In particular, determine how to treat faces separating cells with different $\\kappa$ values and how to model the Dirichlet and Neumann boundaries in the resistor network so that the discrete equations are a conservative, physically faithful approximation of the primary current distribution.\n\nWhich option correctly specifies the mapping rules for the inter-nodal conductances and boundary treatments?\n\nA. For any interior face between $(i,j)$ and $(i+1,j)$, use $G_{i+\\frac{1}{2},j} = \\dfrac{b\\,\\Delta y}{\\Delta x}\\,\\dfrac{\\kappa_{i,j} + \\kappa_{i+1,j}}{2}$, and similarly in $y$. At the Dirichlet boundary at $x=0$, connect $(1,j)$ to a fixed-potential node at $\\phi_e$ with $G_{\\text{b},j} = \\dfrac{b\\,\\Delta y\\,\\kappa_{1,j}}{\\Delta x/2}$; at the Neumann boundary at $x=L_x$, leave the node $(N_x,j)$ unconnected outward.\n\nB. For any interior face between $(i,j)$ and $(i+1,j)$, use $G_{i+\\frac{1}{2},j} = \\dfrac{b\\,\\Delta y}{\\Delta x}\\,\\dfrac{2\\,\\kappa_{i,j}\\,\\kappa_{i+1,j}}{\\kappa_{i,j} + \\kappa_{i+1,j}}$, and similarly $G_{i,j+\\frac{1}{2}} = \\dfrac{b\\,\\Delta x}{\\Delta y}\\,\\dfrac{2\\,\\kappa_{i,j}\\,\\kappa_{i,j+1}}{\\kappa_{i,j} + \\kappa_{i,j+1}}$ in $y$. At the Dirichlet boundary at $x=0$, connect $(1,j)$ to a fixed-potential node at $\\phi_e$ with $G_{\\text{b},j} = \\dfrac{2\\,b\\,\\Delta y\\,\\kappa_{1,j}}{\\Delta x}$; at the Neumann boundary at $x=L_x$, do not connect $(N_x,j)$ outward so that the outward current is zero.\n\nC. For any interior face between $(i,j)$ and $(i+1,j)$, use $G_{i+\\frac{1}{2},j} = \\dfrac{b\\,\\Delta y}{\\Delta x}\\,\\sqrt{\\kappa_{i,j}\\,\\kappa_{i+1,j}}$, and similarly in $y$. At the Dirichlet boundary, connect $(1,j)$ to $\\phi_e$ with $G_{\\text{b},j} = \\dfrac{b\\,\\Delta y\\,\\kappa_{1,j}}{\\Delta x}$ to maintain consistency with interior faces; at the Neumann boundary, enforce $j_n=0$ by connecting $(N_x,j)$ to a ghost node with equal potential using a large but finite conductance.\n\nD. For any interior face, use the harmonic mean for $G$ as in Option B. At the Dirichlet boundary, connect $(1,j)$ to $\\phi_e$ with $G_{\\text{b},j} = \\dfrac{b\\,\\Delta y\\,\\kappa_{1,j}}{\\Delta x}$, matching the interior distance; at the Neumann boundary, approximate $j_n=0$ by adding a negative conductance that cancels the outgoing current from $(N_x,j)$.",
            "solution": "The problem statement is a standard exercise in the finite volume discretization of an elliptic partial differential equation with variable coefficients and mixed boundary conditions. It is scientifically grounded, well-posed, and objective. Therefore, the problem is valid, and we may proceed with a solution.\n\nThe task is to derive the discrete conductances $G$ for a resistor network that approximates the continuous equation $\\nabla \\cdot (\\kappa \\nabla \\phi) = 0$ on a cell-centered grid. The derivation starts from the integral conservation law over a control volume $\\Omega_{ij}$ centered at a node $(i,j)$. The control volume is a rectangle of size $\\Delta x \\times \\Delta y$.\n\nThe integral form of the governing equation is:\n$$\n\\int_{\\Omega_{ij}} \\nabla \\cdot (\\kappa \\nabla \\phi) \\, dA = 0\n$$\nApplying the divergence theorem, we convert the area integral of the divergence into a line integral of the flux over the boundary $\\partial \\Omega_{ij}$ of the control volume. The current density is $\\mathbf{j} = -\\kappa \\nabla \\phi$, so the conservation of charge (which is what $\\nabla \\cdot \\mathbf{j} = 0$ represents in steady state) implies that the net current flowing out of the control volume is zero.\n$$\n\\oint_{\\partial \\Omega_{ij}} \\mathbf{j} \\cdot \\mathbf{n} \\, ds = \\oint_{\\partial \\Omega_{ij}} (-\\kappa \\nabla \\phi) \\cdot \\mathbf{n} \\, ds = 0\n$$\nThis is Kirchhoff's Current Law (KCL) for the control volume. The integral can be broken down into the sum of currents through the four faces of the rectangular control volume (east, west, north, south):\n$$\nI_{\\text{east}} + I_{\\text{west}} + I_{\\text{north}} + I_{\\text{south}} = 0\n$$\nHere, each term represents the total current leaving the control volume through that face. Let's analyze the current $I_{i+1/2, j}$ flowing from node $(i,j)$ to node $(i+1,j)$ through the face at $x_{i+1/2} = x_i + \\Delta x/2$. The area of this face is $A_{\\text{face}} = b \\Delta y$. The current is given by integrating the normal component of the current density over the face area.\n$$\nI_{i+1/2, j} = \\int_{\\text{face}} j_x \\, dS = \\int_{y_j-\\Delta y/2}^{y_j+\\Delta y/2} \\left(-\\kappa \\frac{\\partial \\phi}{\\partial x}\\right)_{x_{i+1/2}} (b \\, dy)\n$$\nAssuming the integrand is approximately constant over the face, we get:\n$$\nI_{i+1/2, j} \\approx \\left(-\\kappa \\frac{\\partial \\phi}{\\partial x}\\right)_{x_{i+1/2}, y_j} (b \\Delta y)\n$$\nThe potential gradient at the face is approximated using a central difference between the adjacent node potentials $\\phi_{i,j}$ and $\\phi_{i+1,j}$:\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{x_{i+1/2}, y_j} \\approx \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x}\n$$\nSubstituting this into the expression for the current:\n$$\nI_{i+1/2, j} \\approx - \\kappa_{i+1/2,j} \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x} (b \\Delta y) = \\kappa_{i+1/2,j} \\frac{b \\Delta y}{\\Delta x} (\\phi_{i,j} - \\phi_{i+1,j})\n$$\nThe problem defines the discrete current as $I = G(\\phi_{\\text{left}} - \\phi_{\\text{right}})$. Comparing forms, we find the inter-nodal conductance is $G_{i+1/2, j} = \\kappa_{i+1/2,j} \\frac{b \\Delta y}{\\Delta x}$. The main task is to determine the effective conductivity at the interface, $\\kappa_{i+1/2,j}$.\n\n**Interior Conductance:**\nTo ensure flux continuity, the current density must be continuous across the interface between two cells. The total potential drop from node $i$ to node $i+1$ is the sum of the potential drops over the two half-cells. This is equivalent to two resistors in series. The resistance of a block of material is $R = \\frac{\\text{length}}{\\kappa \\times \\text{Area}}$.\nThe resistance of the left half-cell (from $x_i$ to $x_{i+1/2}$) is $R_{\\text{left}} = \\frac{\\Delta x / 2}{\\kappa_{i,j} (b \\Delta y)}$.\nThe resistance of the right half-cell (from $x_{i+1/2}$ to $x_{i+1}$) is $R_{\\text{right}} = \\frac{\\Delta x / 2}{\\kappa_{i+1,j} (b \\Delta y)}$.\nThe total resistance between nodes $(i,j)$ and $(i+1,j)$ is $R_{\\text{total}} = R_{\\text{left}} + R_{\\text{right}}$:\n$$\nR_{\\text{total}} = \\frac{\\Delta x}{2 b \\Delta y} \\left( \\frac{1}{\\kappa_{i,j}} + \\frac{1}{\\kappa_{i+1,j}} \\right) = \\frac{\\Delta x}{2 b \\Delta y} \\left( \\frac{\\kappa_{i,j} + \\kappa_{i+1,j}}{\\kappa_{i,j} \\kappa_{i+1,j}} \\right)\n$$\nThe conductance $G_{i+1/2,j}$ is the reciprocal of the total resistance:\n$$\nG_{i+1/2,j} = \\frac{1}{R_{\\text{total}}} = \\frac{2 b \\Delta y}{\\Delta x} \\left( \\frac{\\kappa_{i,j} \\kappa_{i+1,j}}{\\kappa_{i,j} + \\kappa_{i+1,j}} \\right) = \\frac{b \\Delta y}{\\Delta x} \\left( \\frac{2 \\kappa_{i,j} \\kappa_{i+1,j}}{\\kappa_{i,j} + \\kappa_{i+1,j}} \\right)\n$$\nThis shows that the effective conductivity $\\kappa_{i+1/2,j}$ is the harmonic mean of the conductivities of the adjacent cells. A similar derivation for the $y$-direction yields $G_{i,j+1/2} = \\frac{b \\Delta x}{\\Delta y} \\left( \\frac{2 \\kappa_{i,j} \\kappa_{i,j+1}}{\\kappa_{i,j} + \\kappa_{i,j+1}} \\right)$.\n\n**Dirichlet Boundary at $x=0$:**\nThe boundary is at $x=0$ with a specified potential $\\phi = \\phi_e$. The first column of cell centers is at $x_1 = \\Delta x / 2$. We need to find the conductance $G_{\\text{b},j}$ between the boundary and the node $(1,j)$. The physical distance is just that of one half-cell, $\\Delta x / 2$. The resistance of this segment is:\n$$\nR_{\\text{boundary}} = \\frac{\\text{distance}}{\\kappa \\times \\text{Area}} = \\frac{\\Delta x / 2}{\\kappa_{1,j} (b \\Delta y)}\n$$\nThe conductance is the reciprocal:\n$$\nG_{\\text{b},j} = \\frac{1}{R_{\\text{boundary}}} = \\frac{\\kappa_{1,j} b \\Delta y}{\\Delta x / 2} = \\frac{2 b \\Delta y \\kappa_{1,j}}{\\Delta x}\n$$\n\n**Neumann Boundary at $x=L_x$:**\nThe boundary condition is insulating, meaning the normal component of the current density is zero: $j_n = j_x = 0$. The total current flowing out of the domain through the face of a boundary cell $(N_x, j)$ at $x=L_x$ is therefore zero. In the resistor network analogy, a zero current between two points is achieved by having an infinite resistance, which corresponds to a zero conductance. Thus, the node $(N_x, j)$ should have no outward connection in the $x$-direction.\n\n**Evaluation of Options:**\n\n**A.** The interior conductance formula, $G_{i+\\frac{1}{2},j} = \\dfrac{b\\,\\Delta y}{\\Delta x}\\,\\dfrac{\\kappa_{i,j} + \\kappa_{i+1,j}}{2}$, uses the arithmetic mean of conductivity. This is incorrect for ensuring current continuity; the harmonic mean is required. While the boundary treatments are correctly described, the failure on the interior formula makes the option incorrect. **Incorrect.**\n\n**B.** The interior conductance formula, $G_{i+\\frac{1}{2},j} = \\dfrac{b\\,\\Delta y}{\\Delta x}\\,\\dfrac{2\\,\\kappa_{i,j}\\,\\kappa_{i+1,j}}{\\kappa_{i,j} + \\kappa_{i+1,j}}$, correctly uses the harmonic mean. The Dirichlet boundary conductance, $G_{\\text{b},j} = \\dfrac{2\\,b\\,\\Delta y\\,\\kappa_{1,j}}{\\Delta x}$, correctly accounts for the half-cell distance $\\Delta x/2$. The Neumann boundary treatment, \"do not connect $(N_x,j)$ outward so that the outward current is zero\", is the correct network representation of an insulating boundary. All parts are consistent with the derivation from first principles. **Correct.**\n\n**C.** The interior conductance formula, $G_{i+\\frac{1}{2},j} = \\dfrac{b\\,\\Delta y}{\\Delta x}\\,\\sqrt{\\kappa_{i,j}\\,\\kappa_{i+1,j}}$, uses the geometric mean. This is incorrect. The Dirichlet boundary conductance, $G_{\\text{b},j} = \\dfrac{b\\,\\Delta y\\,\\kappa_{1,j}}{\\Delta x}$, is incorrect as it uses the full cell width $\\Delta x$ instead of the half-cell width $\\Delta x/2$. The Neumann boundary treatment involving a ghost node is a valid numerical technique, but describing it as a connection via a \"large but finite conductance\" is peculiar and less direct than simply having no connection ($G=0$). The option is incorrect on multiple grounds. **Incorrect.**\n\n**D.** This option correctly identifies the harmonic mean for interior conductance. However, its formula for the Dirichlet boundary conductance, $G_{\\text{b},j} = \\dfrac{b\\,\\Delta y\\,\\kappa_{1,j}}{\\Delta x}$, is incorrect for the same reason as in Option C (it fails to use the half-cell distance $\\Delta x/2$). The proposed Neumann boundary treatment, adding a \"negative conductance,\" is physically nonsensical and computationally unstable. Negative resistance/conductance implies a source of energy, not an insulating wall. **Incorrect.**\n\nBased on the rigorous derivation, only Option B provides the correct set of rules for constructing the conservative, physically faithful resistor-network approximation.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "A numerical solution is only as good as its verification. This exercise  provides a complete workflow for validating a numerical solver by comparing its output against a known analytical solution, a process known as a convergence study. By implementing a finite difference solver and measuring how the error decreases as the grid is refined, you will quantitatively confirm the theoretical accuracy of the numerical scheme, a critical skill for developing reliable scientific software.",
            "id": "4255445",
            "problem": "You are asked to rigorously compare a resistor-network discretization to the continuum solution for the primary current distribution in an electrolyte modeled on a rectangular domain. The primary current distribution assumes negligible interfacial kinetics and concentration variations, so that the electrolyte potential field is governed by Laplace’s equation. Start from the fundamental conservation of charge and Ohm’s law to derive the governing Partial Differential Equation (PDE) and the resistor-network discrete equations, then quantify and verify the truncation error scaling with grid spacing.\n\nMathematical and physical setting:\n- Governing PDE (Laplace’s equation for primary distribution): the electrolyte potential $\\phi(x,y)$ satisfies\n$$\n\\nabla^2 \\phi \\equiv \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} = 0\n$$\nin a rectangle $\\Omega = \\{(x,y)\\,|\\, 0 \\le x \\le L_x,\\, 0 \\le y \\le L_y\\}$.\n- Boundary conditions (Dirichlet): prescribe \n$$\n\\phi(x,0) = 0,\\quad \\phi(x,L_y) = \\sin\\!\\big(\\pi\\, x/L_x\\big),\\quad \\phi(0,y)=0,\\quad \\phi(L_x,y)=0,\n$$\nwith angles in radians and potential in volts (V). These boundary conditions represent a top electrode held at a sinusoidal potential and the other boundaries held at zero potential.\n- Analytical solution: by separation of variables, the continuum solution is\n$$\n\\phi_{\\text{exact}}(x,y) = \\sin\\!\\big(\\pi\\, x/L_x\\big)\\,\\frac{\\sinh\\!\\big(\\pi\\, y/L_x\\big)}{\\sinh\\!\\big(\\pi\\, L_y/L_x\\big)}.\n$$\n\nDiscrete resistor-network model:\n- Discretize the domain with a rectangular grid of $N_x \\times N_y$ nodes, including boundaries, with spacings $h_x = L_x/(N_x-1)$ and $h_y = L_y/(N_y-1)$.\n- Interior nodes satisfy a node-balance derived from Kirchhoff’s current law and Ohm’s law (equivalently, a five-point finite difference approximation to the Laplacian):\n$$\n\\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h_x^2} \\;+\\; \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h_y^2} \\;=\\; 0,\n$$\nwith Dirichlet boundary nodes fixed by the boundary conditions. This discrete equation is identical to a resistor-network node equation with conductances proportional to $1/h_x^2$ and $1/h_y^2$ in the $x$ and $y$ directions, respectively.\n\nTruncation error analysis:\n- Using Taylor expansions about $(x_i,y_j)$, show that applying the discrete operator to the exact solution yields a local truncation error\n$$\n\\tau_{i,j} \\;=\\; \\frac{h_x^2}{12}\\,\\frac{\\partial^4 \\phi}{\\partial x^4}(x_i,y_j) \\;+\\; \\frac{h_y^2}{12}\\,\\frac{\\partial^4 \\phi}{\\partial y^4}(x_i,y_j) \\;+\\; \\mathcal{O}\\!\\big(h_x^4 + h_y^4\\big).\n$$\nConsequently, the scheme is second-order accurate in space, and the global error in a suitable norm is expected to scale like $\\mathcal{O}(h^2)$ where $h$ denotes a representative grid spacing such as $\\max(h_x,h_y)$.\n\nComputational task:\n- Implement a program that:\n  1. Assembles and solves the resistor-network linear system for the interior-node potentials $\\phi_{i,j}$ for specified $(L_x,L_y,N_x,N_y)$.\n  2. Evaluates the exact solution $\\phi_{\\text{exact}}(x_i,y_j)$ at the same nodes.\n  3. Computes the infinity-norm error over interior nodes,\n     $$\n     e_{\\infty} \\;=\\; \\max_{1 \\le i \\le N_x-2}\\,\\max_{1 \\le j \\le N_y-2}\\, \\big|\\phi_{i,j} - \\phi_{\\text{exact}}(x_i,y_j)\\big|,\n     $$\n     which has units of volts (V).\n  4. For a pair of grids $(h_{\\text{coarse}},h_{\\text{fine}})$ compute the observed order of accuracy\n     $$\n     p \\;=\\; \\frac{\\ln\\!\\big(e_{\\infty}^{(\\text{coarse})} / e_{\\infty}^{(\\text{fine})}\\big)}{\\ln\\!\\big(h_{\\text{coarse}} / h_{\\text{fine}}\\big)},\n     $$\n     where $h = \\max(h_x,h_y)$, which is dimensionless.\n\nTest suite:\nUse the following three grid-pair comparisons to probe accuracy, anisotropy, and refinement behavior. All lengths must be in meters and potentials in volts.\n\n- Case A (square, moderate refinement): \n  - $(L_x,L_y)=(1.0,1.0)$ with $(N_x,N_y)=(17,17)$ for the coarse grid and $(N_x,N_y)=(33,33)$ for the fine grid.\n- Case B (square, further refinement):\n  - $(L_x,L_y)=(1.0,1.0)$ with $(N_x,N_y)=(33,33)$ for the coarse grid and $(N_x,N_y)=(65,65)$ for the fine grid.\n- Case C (rectangular, anisotropic resolution):\n  - $(L_x,L_y)=(2.0,1.0)$ with $(N_x,N_y)=(33,17)$ for the coarse grid and $(N_x,N_y)=(65,33)$ for the fine grid.\n\nRequired final output format:\n- Your program should produce a single line of output containing the observed orders of accuracy for Cases A, B, and C, as a comma-separated list enclosed in square brackets, for example \n$$\n[\\;p_A,p_B,p_C\\;].\n$$\n- The three reported values are dimensionless. Angles in the sine function must be in radians. Ensure that the internal error computations are carried out in volts (V), but only the dimensionless orders are printed.",
            "solution": "The problem requires a rigorous numerical verification of the convergence order for a finite difference (or equivalent resistor-network) approximation of the Laplace equation governing the primary current distribution in a rectangular electrolytic cell. We will first outline the methodology for discretizing the governing equation, constructing the corresponding linear system, and then compute the error against the provided analytical solution to determine the observed order of accuracy.\n\nThe physical system is an electrolyte in a rectangular domain $\\Omega = \\{(x,y)\\,|\\, 0 \\le x \\le L_x,\\, 0 \\le y \\le L_y\\}$. The primary current distribution assumes a uniform electrolyte conductivity, negligible activation overpotentials, and no concentration gradients. Under these assumptions, the conservation of charge, $\\nabla \\cdot \\mathbf{j} = 0$, combined with Ohm's law, $\\mathbf{j} = -\\sigma \\nabla\\phi$ (where $\\sigma$ is the constant conductivity), leads to the governing partial differential equation (PDE) for the electric potential $\\phi(x,y)$, which is Laplace's equation:\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} = 0\n$$\nThe potential field is subject to the specified Dirichlet boundary conditions:\n$$\n\\phi(x,0) = 0,\\quad \\phi(x,L_y) = \\sin(\\pi x/L_x),\\quad \\phi(0,y)=0,\\quad \\phi(L_x,y)=0\n$$\n\nTo solve this PDE numerically, we discretize the domain $\\Omega$ using a grid with $N_x$ points in the $x$-direction and $N_y$ points in the $y$-direction. The grid spacings are $h_x = L_x/(N_x-1)$ and $h_y = L_y/(N_y-1)$. A potential value $\\phi_{i,j}$ is associated with each grid node $(x_i, y_j) = (i h_x, j h_y)$, where $i \\in \\{0, 1, \\dots, N_x-1\\}$ and $j \\in \\{0, 1, \\dots, N_y-1\\}$.\n\nThe second-order partial derivatives are approximated using central finite differences:\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2}\\bigg|_{(x_i,y_j)} \\approx \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h_x^2}\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial y^2}\\bigg|_{(x_i,y_j)} \\approx \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h_y^2}\n$$\nSubstituting these approximations into Laplace's equation for each interior node ($1 \\le i \\le N_x-2$, $1 \\le j \\le N_y-2$) yields a system of linear algebraic equations:\n$$\n\\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h_x^2} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h_y^2} = 0\n$$\nThis is the five-point stencil for the Laplacian and is equivalent to applying Kirchhoff's current law to a network of resistors, where the potential at each node is $\\phi_{i,j}$ and the conductances between nodes are proportional to $1/h_x$ and $1/h_y$ (the equation uses factors proportional to $1/h_x^2$ and $1/h_y^2$ after multiplying by element dimensions).\n\nTo solve for the unknown potentials at the interior nodes, we rearrange the discrete equations into a standard matrix form, $A\\mathbf{\\Phi} = \\mathbf{b}$. The vector $\\mathbf{\\Phi}$ contains the unknown potentials $\\phi_{i,j}$ at the $M = (N_x-2)(N_y-2)$ interior nodes. We map the 2D grid indices $(i,j)$ to a 1D vector index $k$ using a row-major ordering: $k = (j-1)(N_x-2) + (i-1)$.\n\nRearranging the discrete equation, we have:\n$$\n\\left(\\frac{2}{h_x^2} + \\frac{2}{h_y^2}\\right)\\phi_{i,j} - \\frac{1}{h_x^2}\\phi_{i+1,j} - \\frac{1}{h_x^2}\\phi_{i-1,j} - \\frac{1}{h_y^2}\\phi_{i,j+1} - \\frac{1}{h_y^2}\\phi_{i,j-1} = 0\n$$\nThe coefficients of the neighbor potentials $\\phi_{i\\pm1, j}$ and $\\phi_{i, j\\pm1}$ form the off-diagonal entries of the matrix $A$, while the coefficient of $\\phi_{i,j}$ forms the diagonal entry $A_{k,k}$. When a neighboring node lies on the boundary, its potential is known. The corresponding term is moved to the right-hand side, contributing to the vector $\\mathbf{b}$.\n\nGiven the boundary conditions:\n- $\\phi_{i,0} = 0$\n- $\\phi_{0,j} = 0$\n- $\\phi_{N_x-1,j} = 0$\n- $\\phi_{i, N_y-1} = \\sin(\\pi x_i/L_x) = \\sin(\\pi i h_x/L_x)$\n\nOnly the nodes adjacent to the top boundary (i.e., where $j=N_y-2$) will have a non-zero contribution to $\\mathbf{b}$. For a node $(i, N_y-2)$, the term involving its top neighbor $\\phi_{i, N_y-1}$ is known. The equation for this node becomes:\n$$\n\\left(\\frac{2}{h_x^2} + \\frac{2}{h_y^2}\\right)\\phi_{i,N_y-2} - \\dots = \\frac{1}{h_y^2}\\phi_{i,N_y-1} = \\frac{1}{h_y^2}\\sin(\\pi i h_x/L_x)\n$$\nThus, for the 1D index $k$ corresponding to node $(i, N_y-2)$, the entry $b_k$ will be $\\frac{1}{h_y^2}\\sin(\\pi i h_x/L_x)$. All other entries of $\\mathbf{b}$ are zero. The resulting matrix $A$ is sparse, symmetric, positive-definite, and diagonally dominant, ensuring a unique solution for $\\mathbf{\\Phi}$, which can be found using a standard linear solver.\n\nOnce the numerical solution $\\phi_{i,j}$ is obtained at all interior nodes, we compute the error by comparing it to the exact analytical solution evaluated at the same nodes:\n$$\n\\phi_{\\text{exact}}(x_i,y_j) = \\sin\\left(\\frac{\\pi x_i}{L_x}\\right)\\frac{\\sinh\\left(\\frac{\\pi y_j}{L_x}\\right)}{\\sinh\\left(\\frac{\\pi L_y}{L_x}\\right)}\n$$\nThe error is quantified using the infinity norm over the set of interior nodes:\n$$\ne_{\\infty} = \\max_{1 \\le i \\le N_x-2}\\,\\max_{1 \\le j \\le N_y-2}\\, |\\phi_{i,j} - \\phi_{\\text{exact}}(x_i,y_j)|\n$$\nFinally, to verify the second-order accuracy of the scheme, we compute the observed order of accuracy, $p$, using the errors from two different grid resolutions, one coarse and one fine:\n$$\np = \\frac{\\ln(e_{\\infty}^{(\\text{coarse})} / e_{\\infty}^{(\\text{fine})})}{\\ln(h_{\\text{coarse}} / h_{\\text{fine}})}\n$$\nwhere $h = \\max(h_x, h_y)$ is the representative grid spacing. For a second-order scheme where the grid spacing is halved ($h_{\\text{coarse}} / h_{\\text{fine}} = 2$), the error is expected to decrease by a factor of four, yielding an observed order $p \\approx \\log_2(4) = 2$. The computational task is to calculate $p$ for the three specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef calculate_error(Lx, Ly, Nx, Ny):\n    \"\"\"\n    Assembles and solves the finite difference system for Laplace's equation\n    and returns the infinity-norm error against the exact solution.\n    \"\"\"\n    # Grid spacings\n    hx = Lx / (Nx - 1)\n    hy = Ly / (Ny - 1)\n\n    # Number of interior nodes\n    num_interior_x = Nx - 2\n    num_interior_y = Ny - 2\n    num_unknowns = num_interior_x * num_interior_y\n\n    if num_unknowns == 0:\n        return 0.0\n\n    # Initialize the matrix A and vector b for the system A*phi = b\n    A = np.zeros((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    # Coefficients from the finite difference stencil\n    cx = 1.0 / hx**2\n    cy = 1.0 / hy**2\n    cdiag = 2.0 * (cx + cy)\n\n    # Populate the matrix A and vector b\n    for j in range(1, Ny - 1):       # y-index of interior nodes\n        for i in range(1, Nx - 1):   # x-index of interior nodes\n            # Map 2D grid indices (i,j) to 1D vector index k (row-major)\n            k = (j - 1) * num_interior_x + (i - 1)\n\n            # Diagonal element\n            A[k, k] = cdiag\n\n            # Off-diagonal elements (connections to neighbors)\n            # West neighbor (i-1, j)\n            if i > 1:\n                A[k, k - 1] = -cx\n            else: # Boundary node phi(0,y)=0, no contribution to b\n                pass \n            \n            # East neighbor (i+1, j)\n            if i  Nx - 2:\n                A[k, k + 1] = -cx\n            else: # Boundary node phi(Lx,y)=0, no contribution to b\n                pass\n            \n            # South neighbor (i, j-1)\n            if j > 1:\n                A[k, k - num_interior_x] = -cy\n            else: # Boundary node phi(x,0)=0, no contribution to b\n                pass\n            \n            # North neighbor (i, j+1)\n            if j  Ny - 2:\n                A[k, k + num_interior_x] = -cy\n            else: # Boundary node phi(x,Ly)=sin(pi*x/Lx)\n                x = i * hx\n                phi_boundary = np.sin(np.pi * x / Lx)\n                b[k] += cy * phi_boundary\n\n    # Solve the linear system\n    try:\n        phi_vec = np.linalg.solve(A, b)\n    except np.linalg.LinAlgError:\n        # This should not happen for a well-posed problem\n        return np.inf\n\n    # Reshape solution vector back to a 2D grid\n    phi_numerical = phi_vec.reshape((num_interior_y, num_interior_x))\n    \n    # Calculate the exact solution at interior nodes\n    x_coords = np.linspace(hx, Lx - hx, num_interior_x)\n    y_coords = np.linspace(hy, Ly - hy, num_interior_y)\n    xx, yy = np.meshgrid(x_coords, y_coords)\n    \n    k_pi_Lx = np.pi / Lx\n    sinh_term_denom = np.sinh(k_pi_Lx * Ly)\n\n    # Avoid division by zero if sinh is too small (not relevant for test cases)\n    if sinh_term_denom == 0:\n        phi_exact = np.zeros_like(xx) \n    else:\n        phi_exact = np.sin(k_pi_Lx * xx) * np.sinh(k_pi_Lx * yy) / sinh_term_denom\n\n    # Compute the infinity-norm of the error\n    error = np.max(np.abs(phi_numerical - phi_exact))\n    \n    return error\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Lx, Ly, Nx_coarse, Ny_coarse, Nx_fine, Ny_fine)\n    test_cases = [\n        # Case A\n        (1.0, 1.0, 17, 17, 33, 33),\n        # Case B\n        (1.0, 1.0, 33, 33, 65, 65),\n        # Case C\n        (2.0, 1.0, 33, 17, 65, 33),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, Nx_c, Ny_c, Nx_f, Ny_f = case\n        \n        # Calculate errors for coarse and fine grids\n        e_coarse = calculate_error(Lx, Ly, Nx_c, Ny_c)\n        e_fine = calculate_error(Lx, Ly, Nx_f, Ny_f)\n        \n        # Calculate representative grid spacings\n        h_coarse = max(Lx / (Nx_c - 1), Ly / (Ny_c - 1))\n        h_fine = max(Lx / (Nx_f - 1), Ly / (Ny_f - 1))\n        \n        # Calculate the observed order of accuracy\n        # Check for non-positive errors or h_ratio = 1 to avoid math domain errors\n        if e_coarse = 0 or e_fine = 0 or h_coarse / h_fine = 1:\n            p = np.nan # Should not happen in these well-defined test cases\n        else:\n            p = np.log(e_coarse / e_fine) / np.log(h_coarse / h_fine)\n\n        results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}