{
    "hands_on_practices": [
        {
            "introduction": "In electrochemical systems, the observed current is often a result of a delicate balance between the intrinsic rate of the reaction at the electrode surface and the rate at which reactants are transported from the bulk solution. This practice guides you through a fundamental derivation to mathematically describe this interplay under mixed kinetic-transport control . By starting from first principles of flux conservation, you will derive the classic equation that connects the measured current to the purely kinetic ($i_k$) and mass-transport-limited ($i_L$) currents, providing a cornerstone for analyzing experimental voltammetry.",
            "id": "4256489",
            "problem": "A single-electron reduction of a dissolved species is performed at a Rotating Disk Electrode (RDE). The hydrodynamic flow is laminar and steady, yielding a quasi-steady concentration boundary layer. Let $n$ be the number of electrons transferred, $F$ the Faraday constant, $A$ the electrode area, $C_b$ the bulk concentration of the reactant, and $C_s$ its concentration at the electrode surface. The total molar flux of reactant to the surface, $J$, is governed by both interfacial electron-transfer kinetics and mass transport. Assume:\n\n- Interfacial kinetics are first-order with respect to the surface concentration, so that the interfacial consumption flux is $J_{\\text{kin}} = k_s C_s$, where $k_s$ is the potential-dependent rate constant.\n- Mass transport across the hydrodynamic boundary layer is characterized by a mass-transfer coefficient $k_m$, so that the diffusive-convective supply flux is $J_{\\text{mt}} = k_m\\left(C_b - C_s\\right)$.\n\nAt steady state, conservation of species at the interface implies $J = J_{\\text{kin}} = J_{\\text{mt}}$. The measurable current is $i = n F A J$. Define the kinetic current $i_k$ as the hypothetical current when $C_s = C_b$ (no mass transport limitation), and the limiting current $i_L$ as the hypothetical current when $C_s = 0$ (infinitely fast interfacial kinetics).\n\nUsing only these foundations (species conservation at the interface, first-order interfacial kinetics, and boundary-layer mass transport), derive a closed-form analytic expression for the mixed-control current $i$ in terms of $i_k$ and $i_L$ only. Your final answer must be a single symbolic expression. No numerical values are required or allowed, and no “shortcut” or previously known mixed-control formulas may be used directly. Do not include any units in your final expression.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **System**: A single-electron reduction at a Rotating Disk Electrode (RDE).\n- **Assumptions**: Laminar and steady hydrodynamic flow; quasi-steady concentration boundary layer.\n- **Variables and Constants**:\n    - $n$: number of electrons transferred.\n    - $F$: Faraday constant.\n    - $A$: electrode area.\n    - $C_b$: bulk concentration of the reactant.\n    - $C_s$: surface concentration of the reactant.\n    - $J$: total molar flux to the surface.\n- **Flux Definitions**:\n    - Interfacial kinetic flux: $J_{\\text{kin}} = k_s C_s$, where $k_s$ is the potential-dependent rate constant.\n    - Mass transport flux: $J_{\\text{mt}} = k_m\\left(C_b - C_s\\right)$, where $k_m$ is the mass-transfer coefficient.\n- **Governing Equations**:\n    - Steady-state conservation of species: $J = J_{\\text{kin}} = J_{\\text{mt}}$.\n    - Current-flux relationship: $i = n F A J$.\n- **Hypothetical Currents**:\n    - Kinetic current, $i_k$: the current when $C_s = C_b$.\n    - Limiting current, $i_L$: the current when $C_s = 0$.\n- **Objective**: Derive an expression for the mixed-control current $i$ solely in terms of $i_k$ and $i_L$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard and fundamental model in electrochemistry for mixed kinetic and mass-transport control. The concepts presented (flux, mass-transfer coefficient, first-order kinetics, Faraday's law) are cornerstones of the field. The problem is well-posed, providing a complete and consistent set of definitions and equations that permit a unique analytical solution. All terms are defined objectively and precisely. The derivation is a standard exercise to test fundamental understanding, not a trivial or ill-posed task. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived from the provided first principles.\n\n### Derivation\nThe derivation begins with the steady-state condition for the conservation of the reactant species at the electrode surface. This condition states that the rate of consumption by the interfacial reaction, $J_{\\text{kin}}$, must equal the rate of supply by mass transport, $J_{\\text{mt}}$. The total flux $J$ is equal to both.\n\n$$J = J_{\\text{kin}} = J_{\\text{mt}}$$\n\nSubstituting the given expressions for the fluxes:\n$$k_s C_s = k_m(C_b - C_s)$$\n\nThe goal is to find the overall current $i$, which depends on the total flux $J$. To find $J$, we must first solve for the surface concentration $C_s$ in terms of the bulk concentration $C_b$ and the rate/mass-transfer coefficients $k_s$ and $k_m$. We rearrange the equation to isolate $C_s$:\n\n$$k_s C_s + k_m C_s = k_m C_b$$\n$$C_s (k_s + k_m) = k_m C_b$$\n$$C_s = \\frac{k_m C_b}{k_s + k_m}$$\n\nNow we can express the total flux $J$ by substituting this expression for $C_s$ back into the formula for either $J_{\\text{kin}}$ or $J_{\\text{mt}}$. Using $J = J_{\\text{kin}} = k_s C_s$:\n\n$$J = k_s \\left( \\frac{k_m C_b}{k_s + k_m} \\right) = \\frac{k_s k_m C_b}{k_s + k_m}$$\n\nThe measured current $i$ is related to the total flux $J$ by Faraday's law: $i = n F A J$.\n\n$$i = n F A \\left( \\frac{k_s k_m C_b}{k_s + k_m} \\right)$$\n\nThis expression gives the current $i$ under mixed control, but it is not yet in terms of the defined hypothetical currents $i_k$ and $i_L$. We must now derive expressions for $i_k$ and $i_L$ from their definitions.\n\nThe kinetic current, $i_k$, is defined as the current that would flow if mass transport were infinitely fast, meaning there are no concentration gradients and the surface concentration equals the bulk concentration, $C_s = C_b$. In this scenario, the flux is purely determined by the kinetic rate:\n\n$$J_k = J_{\\text{kin}}|_{C_s=C_b} = k_s C_b$$\nThus, the kinetic current is:\n$$i_k = n F A J_k = n F A k_s C_b$$\n\nThe limiting current, $i_L$, is defined as the current that would flow if the interfacial kinetics were infinitely fast. This high rate of reaction consumes the reactant at the surface so effectively that its concentration drops to zero, $C_s = 0$. In this scenario, the flux is purely limited by the rate of mass transport:\n\n$$J_L = J_{\\text{mt}}|_{C_s=0} = k_m(C_b - 0) = k_m C_b$$\nThus, the limiting current is:\n$$i_L = n F A J_L = n F A k_m C_b$$\n\nNow we must rearrange the expression for the mixed-control current $i$ to contain only $i_k$ and $i_L$. A common and effective method is to consider the reciprocal of the current $i$:\n\n$$\\frac{1}{i} = \\frac{1}{n F A} \\left( \\frac{k_s + k_m}{k_s k_m C_b} \\right)$$\n\nWe can separate the fraction into two terms:\n$$\\frac{1}{i} = \\frac{k_s}{n F A k_s k_m C_b} + \\frac{k_m}{n F A k_s k_m C_b}$$\n\nSimplifying each term by canceling the common factors:\n$$\\frac{1}{i} = \\frac{1}{n F A k_m C_b} + \\frac{1}{n F A k_s C_b}$$\n\nNow we can recognize the expressions for the reciprocals of $i_L$ and $i_k$:\n$$\\frac{1}{i_L} = \\frac{1}{n F A k_m C_b}$$\n$$\\frac{1}{i_k} = \\frac{1}{n F A k_s C_b}$$\n\nSubstituting these into the equation for $\\frac{1}{i}$:\n$$\\frac{1}{i} = \\frac{1}{i_L} + \\frac{1}{i_k}$$\n\nThis additive relationship for the reciprocal currents is a well-known result (related to the Koutecký–Levich equation). To obtain the final expression for $i$, we solve for it algebraically:\n\n$$\\frac{1}{i} = \\frac{i_k + i_L}{i_k i_L}$$\n$$i = \\frac{i_k i_L}{i_k + i_L}$$\n\nThis final expression for the mixed-control current $i$ is given exclusively in terms of the kinetic current $i_k$ and the limiting current $i_L$, as required by the problem statement.",
            "answer": "$$\\boxed{\\frac{i_k i_L}{i_k + i_L}}$$"
        },
        {
            "introduction": "The theoretical models of mass transport are most powerful when they connect directly to experimental measurements. This practice focuses on the mass-transport-limited regime, using the Levich equation to analyze a set of simulated experimental data . You will perform a linear regression on limiting current versus the square root of rotation speed to extract the diffusion coefficient, a key material property, and learn to propagate experimental uncertainties into your final result.",
            "id": "4256529",
            "problem": "Design and implement a program that estimates the diffusion coefficient $D$ from steady-state limiting current data $i_L(\\omega)$ measured at a Rotating Disk Electrode (RDE), using a linear regression of $i_L$ versus $\\omega^{1/2}$ and uncertainty propagation in the kinematic viscosity $\\nu$ and bulk concentration $c_\\infty$. Base your approach on the following fundamental laws and definitions: (i) steady-state convective-diffusive transport, (ii) boundary layer theory for laminar flow over a rotating disk, and (iii) the definition of limiting current as the product of Faraday's constant, stoichiometric electron number, electrode area, and the limiting flux. The widely observed consequence of these principles is that, under diffusion-controlled conditions and laminar flow, the limiting current $i_L$ scales linearly with $\\omega^{1/2}$, where $\\omega$ is the angular rotation rate. Your algorithm must estimate $D$ by fitting the slope of this linear relation, and then express $D$ in terms of known physical parameters. You must also propagate the standard uncertainties in $\\nu$ and $c_\\infty$ into the uncertainty of $D$ under the assumption of mutual independence of all uncertain quantities.\n\nAlgorithmic requirements:\n- Compute the regressor $x = \\omega^{1/2}$ and perform ordinary least squares linear regression of $y = i_L$ on $x$ with a free intercept to obtain an estimated slope $\\hat{s}$ and its standard uncertainty $u_s$.\n- Using the physical parameters (electron number $n$, Faraday constant $F$, electrode area $A$, kinematic viscosity $\\nu$, and bulk concentration $c_\\infty$), express the estimated diffusion coefficient $\\hat{D}$ as a function of $\\hat{s}$ and these parameters, derived from first principles of rotating-disk mass transport.\n- Propagate uncertainties using first-order Taylor series (Gaussian) propagation, combining $u_s$, $u_\\nu$, and $u_{c_\\infty}$ to obtain the relative standard uncertainty of $\\hat{D}$ expressed as a decimal fraction.\n\nTesting requirements:\n- Use the four test cases provided below. In each case, use the given arrays of angular velocities and measured limiting currents, along with the specified parameters and their standard uncertainties.\n- Units: The output diffusion coefficient must be reported in $\\mathrm{m^2/s}$. The relative standard uncertainty must be reported as a unitless decimal fraction. Round the diffusion coefficient to six significant figures and the relative uncertainty to four significant figures.\n- Final output format: Your program should produce a single line of output containing all results aggregated into a comma-separated list enclosed in square brackets, in the order $[\\hat{D}_1, u_{\\mathrm{rel},1}, \\hat{D}_2, u_{\\mathrm{rel},2}, \\hat{D}_3, u_{\\mathrm{rel},3}, \\hat{D}_4, u_{\\mathrm{rel},4}]$.\n\nConstants available to you for all cases:\n- Faraday constant $F = 96485\\,\\mathrm{C/mol}$.\n\nTest suite:\n- Case 1 (happy path, aqueous solution):\n  - Angular speeds (in $\\mathrm{rad/s}$): $[50.0, 100.0, 200.0, 400.0]$.\n  - Measured limiting currents (in $\\mathrm{A}$): $[3.36\\times 10^{-4}, 4.70\\times 10^{-4}, 6.64\\times 10^{-4}, 9.40\\times 10^{-4}]$.\n  - Parameters: $n = 1$, $A = 1.00\\times 10^{-4}\\,\\mathrm{m^2}$, $c_\\infty = 1.00\\,\\mathrm{mol/m^3}$, $\\nu = 1.00\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n  - Standard uncertainties: $u_{c_\\infty} = 0.02\\,\\mathrm{mol/m^3}$, $u_\\nu = 0.05\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n- Case 2 (higher viscosity):\n  - Angular speeds (in $\\mathrm{rad/s}$): $[25.0, 100.0, 225.0, 400.0]$.\n  - Measured limiting currents (in $\\mathrm{A}$): $[2.50\\times 10^{-4}, 4.98\\times 10^{-4}, 7.42\\times 10^{-4}, 9.90\\times 10^{-4}]$.\n  - Parameters: $n = 1$, $A = 1.00\\times 10^{-4}\\,\\mathrm{m^2}$, $c_\\infty = 2.00\\,\\mathrm{mol/m^3}$, $\\nu = 5.00\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n  - Standard uncertainties: $u_{c_\\infty} = 0.04\\,\\mathrm{mol/m^3}$, $u_\\nu = 0.20\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n- Case 3 (negligible concentration uncertainty, moderate viscosity uncertainty):\n  - Angular speeds (in $\\mathrm{rad/s}$): $[100.0, 400.0, 900.0, 1600.0]$.\n  - Measured limiting currents (in $\\mathrm{A}$): $[3.40\\times 10^{-4}, 6.90\\times 10^{-4}, 1.07\\times 10^{-3}, 1.41\\times 10^{-3}]$.\n  - Parameters: $n = 1$, $A = 1.00\\times 10^{-4}\\,\\mathrm{m^2}$, $c_\\infty = 0.50\\,\\mathrm{mol/m^3}$, $\\nu = 0.80\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n  - Standard uncertainties: $u_{c_\\infty} = 0.00\\,\\mathrm{mol/m^3}$, $u_\\nu = 0.08\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n- Case 4 (broader $\\omega$ coverage, small measurement noise):\n  - Angular speeds (in $\\mathrm{rad/s}$): $[50.0, 150.0, 300.0, 600.0, 900.0, 1200.0]$.\n  - Measured limiting currents (in $\\mathrm{A}$): $[2.95\\times 10^{-4}, 5.08\\times 10^{-4}, 7.22\\times 10^{-4}, 1.02\\times 10^{-3}, 1.25\\times 10^{-3}, 1.44\\times 10^{-3}]$.\n  - Parameters: $n = 1$, $A = 1.00\\times 10^{-4}\\,\\mathrm{m^2}$, $c_\\infty = 0.80\\,\\mathrm{mol/m^3}$, $\\nu = 1.50\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n  - Standard uncertainties: $u_{c_\\infty} = 0.008\\,\\mathrm{mol/m^3}$, $u_\\nu = 0.07\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the values ordered as $[\\hat{D}_1,u_{\\mathrm{rel},1},\\hat{D}_2,u_{\\mathrm{rel},2},\\hat{D}_3,u_{\\mathrm{rel},3},\\hat{D}_4,u_{\\mathrm{rel},4}]$, where each $\\hat{D}_i$ is in $\\mathrm{m^2/s}$ rounded to six significant figures, and each $u_{\\mathrm{rel},i}$ is a decimal fraction rounded to four significant figures.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the established theory of mass transport to a rotating disk electrode, is well-posed, objective, and provides a complete and consistent set of data and constraints for a meaningful solution. The task is to determine the diffusion coefficient $D$ and its relative uncertainty from experimental data, which is a standard procedure in physical electrochemistry.\n\nThe solution proceeds in three main stages: first, the derivation of the governing physical equation relating the diffusion coefficient to measurable quantities; second, the formulation of the statistical method for parameter estimation and uncertainty propagation; and third, the application of this methodology to the provided test cases.\n\n**1. Theoretical Foundation: The Levich Equation**\n\nThe mass transport of an electroactive species to the surface of a rotating disk electrode (RDE) under steady-state, laminar flow conditions is described by the convective-diffusion equation. For a transport-limited reaction, where the concentration of the reactant at the electrode surface is effectively zero, the resulting limiting current $i_L$ is given by the Levich equation:\n\n$$\ni_L = 0.620 n F A D^{2/3} \\nu^{-1/6} c_\\infty \\omega^{1/2}\n$$\n\nwhere:\n- $i_L$ is the limiting current in Amperes ($A$).\n- $n$ is the number of electrons transferred in the electrode reaction.\n- $F$ is the Faraday constant, $96485\\,\\mathrm{C/mol}$.\n- $A$ is the electrode area in $\\mathrm{m^2}$.\n- $D$ is the diffusion coefficient of the electroactive species in $\\mathrm{m^2/s}$.\n- $\\nu$ is the kinematic viscosity of the solution in $\\mathrm{m^2/s}$.\n- $c_\\infty$ is the bulk concentration of the species in $\\mathrm{mol/m^3}$.\n- $\\omega$ is the angular rotation rate of the electrode in $\\mathrm{rad/s}$.\n\nThe Levich equation predicts a linear relationship between the limiting current $i_L$ and the square root of the angular rotation rate, $\\omega^{1/2}$. We can write this relation in the form of a linear equation, $y = sx + b$:\n\n$$\ni_L = s \\cdot \\omega^{1/2} + b\n$$\n\nHere, $y = i_L$ and $x = \\omega^{1/2}$. The theoretical slope, $s$, is given by:\n\n$$\ns = 0.620 n F A c_\\infty D^{2/3} \\nu^{-1/6}\n$$\n\nThe intercept, $b$, is theoretically zero but is retained in the regression model to account for any background currents or instrumental offsets, which is a sound experimental practice.\n\nTo determine the diffusion coefficient $D$ from the experimentally measured slope, we rearrange the equation for the slope. Let $\\hat{s}$ be the estimated slope from a linear regression of $i_L$ versus $\\omega^{1/2}$. The estimated diffusion coefficient, $\\hat{D}$, can be expressed by isolating $D$:\n\n$$\n\\hat{D}^{2/3} = \\frac{\\hat{s}}{0.620 n F A c_\\infty \\nu^{-1/6}} = \\frac{\\hat{s} \\nu^{1/6}}{0.620 n F A c_\\infty}\n$$\n\nRaising both sides to the power of $3/2$ yields the final expression for $\\hat{D}$:\n\n$$\n\\hat{D} = \\left( \\frac{\\hat{s} \\nu^{1/6}}{0.620 n F A c_\\infty} \\right)^{3/2} = \\left( \\frac{\\hat{s}}{0.620 n F A c_\\infty} \\right)^{3/2} \\nu^{1/4}\n$$\n\nThis equation forms the basis for calculating the diffusion coefficient from the estimated slope of the Levich plot.\n\n**2. Statistical Analysis and Uncertainty Propagation**\n\nThe experimental data consist of pairs of $(\\omega_i, i_{L,i})$. We first transform the independent variable to $x_i = \\omega_i^{1/2}$ and perform an ordinary least squares (OLS) linear regression of $y_i = i_{L,i}$ on $x_i$. This procedure yields an estimate for the slope, $\\hat{s}$, and its standard uncertainty, $u_s$.\n\nThe next step is to propagate the uncertainties from the input quantities to the final calculated value of $\\hat{D}$. The problem states that the quantities with uncertainty are the estimated slope $\\hat{s}$, the kinematic viscosity $\\nu$, and the bulk concentration $c_\\infty$. Their respective standard uncertainties are $u_s$, $u_\\nu$, and $u_{c_\\infty}$. We assume these quantities are mutually independent.\n\nThe propagation of uncertainty is based on a first-order Taylor series expansion of the function for $\\hat{D}$. For a function $f(z_1, z_2, ..., z_k)$ where the variables $z_i$ are independent, the squared standard uncertainty of the result, $u_f^2$, is given by:\n\n$$\nu_f^2 = \\sum_{i=1}^{k} \\left( \\frac{\\partial f}{\\partial z_i} \\right)^2 u_{z_i}^2\n$$\n\nThe function for our diffusion coefficient is $\\hat{D} = f(\\hat{s}, \\nu, c_\\infty)$. For convenience, we can write it in a product of powers form:\n\n$$\n\\hat{D} = K \\cdot \\hat{s}^{3/2} \\cdot \\nu^{1/4} \\cdot c_\\infty^{-3/2}\n$$\n\nwhere $K = (0.620 n F A)^{-3/2}$ is a constant term incorporating all parameters assumed to be known exactly.\n\nFor a function of this form, $f = K \\prod_i z_i^{p_i}$, the squared relative uncertainty $(\\frac{u_f}{f})^2$ is given by a simpler rule:\n\n$$\n\\left(\\frac{u_f}{f}\\right)^2 = \\sum_{i=1}^{k} \\left( p_i \\frac{u_{z_i}}{z_i} \\right)^2\n$$\n\nApplying this to our function for $\\hat{D}$, with powers $p_s = 3/2$, $p_\\nu = 1/4$, and $p_c = -3/2$, we get the squared relative uncertainty of the diffusion coefficient, $u_{\\mathrm{rel},D}^2$:\n\n$$\nu_{\\mathrm{rel},D}^2 = \\left(\\frac{u_D}{\\hat{D}}\\right)^2 = \\left( \\frac{3}{2} \\frac{u_s}{\\hat{s}} \\right)^2 + \\left( \\frac{1}{4} \\frac{u_\\nu}{\\nu} \\right)^2 + \\left( -\\frac{3}{2} \\frac{u_{c_\\infty}}{c_\\infty} \\right)^2\n$$\n\nThis simplifies to:\n\n$$\nu_{\\mathrm{rel},D}^2 = \\frac{9}{4} \\left(\\frac{u_s}{\\hat{s}}\\right)^2 + \\frac{1}{16} \\left(\\frac{u_\\nu}{\\nu}\\right)^2 + \\frac{9}{4} \\left(\\frac{u_{c_\\infty}}{c_\\infty}\\right)^2\n$$\n\nThe final relative standard uncertainty is $u_{\\mathrm{rel},D} = \\sqrt{u_{\\mathrm{rel},D}^2}$.\n\n**3. Algorithmic Implementation**\n\nThe algorithm is executed for each of the four test cases provided.\n\n1.  **Data Preparation**: For a given set of angular speeds $\\omega$ and limiting currents $i_L$, the regressor variable $x = \\omega^{1/2}$ is computed.\n2.  **Linear Regression**: An OLS linear regression of $i_L$ versus $x$ is performed to find the estimated slope $\\hat{s}$ and its standard uncertainty $u_s$.\n3.  **Diffusion Coefficient Calculation**: The estimated diffusion coefficient $\\hat{D}$ is calculated using the derived formula:\n    $$\n    \\hat{D} = \\left( \\frac{\\hat{s}}{0.620 n F A c_\\infty} \\right)^{3/2} \\nu^{1/4}\n    $$\n4.  **Uncertainty Calculation**: The relative standard uncertainty $u_{\\mathrm{rel},D}$ is calculated using the derived propagation formula, substituting the values of $\\hat{s}$, $u_s$, $\\nu$, $u_\\nu$, $c_\\infty$, and $u_{c_\\infty}$.\n5.  **Formatting**: The calculated value of $\\hat{D}$ is rounded and formatted to six significant figures, and $u_{\\mathrm{rel},D}$ is rounded and formatted to four significant figures. The results are aggregated and printed in the specified format. All calculations employ SI units.\n\nThis systematic approach, founded on core principles of electrochemistry and statistical analysis, ensures a rigorous and correct solution to the problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef format_to_sig_figs(value, sig_figs):\n    \"\"\"\n    Formats a number to a specified number of significant figures in scientific notation.\n    Example: format_to_sig_figs(0.035946, 4) -> '3.595e-02'\n    \"\"\"\n    if value == 0:\n        return f'0.0e+00'\n    # Use 'e' format specifier which inherently rounds and formats to significant figures.\n    # The precision for 'e' format is the number of digits after the decimal.\n    # For n significant figures, we need n-1 digits after the decimal point.\n    return f\"{value:.{sig_figs-1}e}\"\n\ndef solve():\n    \"\"\"\n    Solves the RDE problem by calculating the diffusion coefficient and its\n    relative uncertainty for a series of test cases.\n    \"\"\"\n    # Define the universal constant\n    F = 96485.0  # Faraday constant in C/mol\n\n    # Define the test cases from the problem statement.\n    # Structure: (omega, i_L, n, A, c_inf, nu, u_c_inf, u_nu)\n    test_cases = [\n        # Case 1\n        (\n            np.array([50.0, 100.0, 200.0, 400.0]),\n            np.array([3.36e-4, 4.70e-4, 6.64e-4, 9.40e-4]),\n            1, 1.00e-4, 1.00, 1.00e-6, 0.02, 0.05e-6\n        ),\n        # Case 2\n        (\n            np.array([25.0, 100.0, 225.0, 400.0]),\n            np.array([2.50e-4, 4.98e-4, 7.42e-4, 9.90e-4]),\n            1, 1.00e-4, 2.00, 5.00e-6, 0.04, 0.20e-6\n        ),\n        # Case 3\n        (\n            np.array([100.0, 400.0, 900.0, 1600.0]),\n            np.array([3.40e-4, 6.90e-4, 1.07e-3, 1.41e-3]),\n            1, 1.00e-4, 0.50, 0.80e-6, 0.00, 0.08e-6\n        ),\n        # Case 4\n        (\n            np.array([50.0, 150.0, 300.0, 600.0, 900.0, 1200.0]),\n            np.array([2.95e-4, 5.08e-4, 7.22e-4, 1.02e-3, 1.25e-3, 1.44e-3]),\n            1, 1.00e-4, 0.80, 1.50e-6, 0.008, 0.07e-6\n        )\n    ]\n\n    results = []\n    for case in test_cases:\n        omega, i_L, n, A, c_inf, nu, u_c_inf, u_nu = case\n\n        # Step 1: Compute regressor x = omega^(1/2)\n        x = np.sqrt(omega)\n        y = i_L\n\n        # Step 2: Perform OLS linear regression to get slope (s_hat) and its uncertainty (u_s)\n        # linregress returns: slope, intercept, r_value, p_value, stderr\n        regression_result = linregress(x, y)\n        s_hat = regression_result.slope\n        u_s = regression_result.stderr\n\n        # Step 3: Calculate the estimated diffusion coefficient (D_hat)\n        # D = (s / (0.620 * n * F * A * c_inf))^(3/2) * nu^(1/4)\n        levich_const = 0.620\n        term_in_parens = s_hat / (levich_const * n * F * A * c_inf)\n        D_hat = (term_in_parens)**(3/2) * nu**(1/4)\n\n        # Step 4: Propagate uncertainties to find relative standard uncertainty of D\n        # (u_rel_D)^2 = (9/4)*(u_s/s)^2 + (1/16)*(u_nu/nu)^2 + (9/4)*(u_c/c)^2\n        \n        # Calculate relative uncertainties of inputs, handling potential division by zero\n        rel_u_s_sq = (u_s / s_hat)**2 if s_hat != 0 else 0\n        rel_u_nu_sq = (u_nu / nu)**2 if nu != 0 else 0\n        rel_u_c_inf_sq = (u_c_inf / c_inf)**2 if c_inf != 0 else 0\n        \n        u_rel_D_sq = (9/4) * rel_u_s_sq + (1/16) * rel_u_nu_sq + (9/4) * rel_u_c_inf_sq\n        u_rel_D = np.sqrt(u_rel_D_sq)\n\n        # Step 5: Format results to required significant figures\n        D_hat_formatted = format_to_sig_figs(D_hat, 6)\n        u_rel_D_formatted = format_to_sig_figs(u_rel_D, 4)\n        \n        results.append(D_hat_formatted)\n        results.append(u_rel_D_formatted)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "A cornerstone of computational science is verifying that numerical algorithms accurately represent the mathematical models they are meant to solve. This exercise introduces the Method of Manufactured Solutions to verify a finite difference scheme for calculating diffusive flux at the electrode surface . By comparing your numerical results against a known analytical solution, you will confirm the scheme's theoretical order of accuracy, a fundamental practice for building trust in any custom-built simulation code.",
            "id": "4256519",
            "problem": "You are tasked with implementing and verifying a second-order accurate numerical scheme for estimating the normal concentration gradient at a rotating disk electrode surface to compute the diffusive flux. The context is steady-state mass transport in a Rotating Disk Electrode (RDE), governed by the convection–diffusion balance near the disk. The verification must be performed against the Levich analytic limiting flux for diffusion-limited conditions.\n\nBegin from the following foundational base:\n- The one-dimensional steady convection–diffusion equation normal to the disk takes the form $u_z(z)\\,\\partial c/\\partial z = D\\,\\partial^2 c/\\partial z^2$ under axisymmetric, steady conditions, where $z$ is the coordinate normal to the disk surface pointing into the electrolyte, $c(z)$ is the concentration of the reacting species, $D$ is the diffusion coefficient, and $u_z(z)$ is the axial velocity induced by the hydrodynamic flow above the rotating disk.\n- Under diffusion-limited reaction, the boundary conditions are $c(0) = 0$ and $c(z) \\to c^\\ast$ as $z \\to \\infty$, where $c^\\ast$ is the bulk concentration.\n- The Levich correlation for the limiting mass-transfer coefficient for a Rotating Disk Electrode is $k_L = 0.62\\,D^{2/3}\\,\\nu^{-1/6}\\,\\omega^{1/2}$, where $\\nu$ is the kinematic viscosity and $\\omega$ is the angular rotation rate. The corresponding limiting diffusive flux magnitude is $|J_L| = k_L\\,c^\\ast$ with units of $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$.\n\nYou will implement a second-order accurate one-sided finite difference approximation to estimate $-\\partial c/\\partial z\\big|_{z=0}$ from discrete values of $c(z)$ at grid points $z_0=0$, $z_1=h$, and $z_2=2h$. The scheme to be implemented is\n$$\n-\\left.\\frac{\\partial c}{\\partial z}\\right|_{z=0} \\approx \\frac{3c(z_0) - 4c(z_1) + c(z_2)}{2h},\n$$\nwhich has a truncation error of order $\\mathcal{O}(h^2)$ under sufficient smoothness of $c(z)$.\n\nTo make the verification self-contained and focus purely on the numerical accuracy of the derivative scheme, use the manufactured solution\n$$\nc(z) = c^\\ast\\left(1 - e^{-\\alpha z}\\right),\n$$\nwhere the decay rate $\\alpha$ is chosen such that the exact surface flux magnitude matches the Levich analytic value. Specifically, set $\\alpha = k_L/D$, so that the exact magnitude of the diffusive flux at the surface is $|J| = \\left|-D\\,\\partial c/\\partial z\\big|_{z=0}\\right| = k_L\\,c^\\ast$.\n\nYour program must:\n1. For each test case, compute $k_L$, set $\\alpha = k_L/D$, construct $c(z)$ as above, apply the second-order one-sided scheme at $z=0$ with three successively refined grid spacings $h_1$, $h_2$, $h_3$ (each halved from the previous), compute the numerical flux magnitude $|J_{\\text{num}}| = \\left|-D\\,\\left(\\partial c/\\partial z\\right)_{\\text{approx}}\\right|$, and evaluate the relative errors $e_i = \\left||J_{\\text{num},i}| - |J_L|\\right|/|J_L|$ for $i=1,2,3$.\n2. Estimate the observed order of accuracy for the derivative approximation using the pairwise error ratios:\n$$\np_{12} = \\frac{\\ln(e_1/e_2)}{\\ln(h_1/h_2)},\\quad p_{23} = \\frac{\\ln(e_2/e_3)}{\\ln(h_2/h_3)},\n$$\nand report the average $p = (p_{12}+p_{23})/2$ for each test case.\n\nUse the characteristic mass-transfer boundary-layer thickness scaling\n$$\n\\delta_m = \\frac{D}{k_L} = \\frac{D^{1/3}\\,\\nu^{1/6}}{0.62\\,\\omega^{1/2}}\n$$\nto define grid spacings for each case as $h_1 = \\delta_m/200$, $h_2 = \\delta_m/400$, and $h_3 = \\delta_m/800$. This scaling ensures that the grid resolves the near-surface gradients consistently across different physical parameters.\n\nTest Suite:\nProvide the following four test cases, each specified by $(D,\\nu,\\omega,c^\\ast)$:\n- Case A (typical aqueous): $(1.0\\times 10^{-9}\\ \\mathrm{m^2/s},\\ 1.0\\times 10^{-6}\\ \\mathrm{m^2/s},\\ 100\\ \\mathrm{rad/s},\\ 1.0\\ \\mathrm{mol/m^3})$.\n- Case B (higher rotation, lower viscosity): $(1.5\\times 10^{-9}\\ \\mathrm{m^2/s},\\ 8.0\\times 10^{-7}\\ \\mathrm{m^2/s},\\ 500\\ \\mathrm{rad/s},\\ 0.2\\ \\mathrm{mol/m^3})$.\n- Case C (moderate rotation, higher concentration): $(0.8\\times 10^{-9}\\ \\mathrm{m^2/s},\\ 1.1\\times 10^{-6}\\ \\mathrm{m^2/s},\\ 50\\ \\mathrm{rad/s},\\ 2.5\\ \\mathrm{mol/m^3})$.\n- Case D (very high rotation): $(2.0\\times 10^{-9}\\ \\mathrm{m^2/s},\\ 1.0\\times 10^{-6}\\ \\mathrm{m^2/s},\\ 1000\\ \\mathrm{rad/s},\\ 0.05\\ \\mathrm{mol/m^3})$.\n\nAnswer specification:\n- The flux $|J|$ must be computed internally in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ using the above units. The final output, however, must consist of the observed orders of accuracy $p$ (dimensionless) for the four test cases.\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, in the order of the test cases A, B, C, D (e.g., \"[p_A,p_B,p_C,p_D]\").",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of electrochemical mass transport and numerical analysis, specifically the method of manufactured solutions for code verification. The problem is well-posed, with all necessary parameters, equations, and boundary conditions provided to ensure a unique, deterministic solution. The setup is internally consistent, objective, and computationally feasible.\n\nThe task is to verify the convergence order of a second-order accurate finite difference scheme for the concentration gradient at the surface of a rotating disk electrode (RDE). The verification will be performed against an analytical solution by computing the observed order of accuracy for successively refined computational grids.\n\nThe core of the methodology is the Method of Manufactured Solutions. Instead of numerically solving the full convection-diffusion equation, which would introduce its own discretization errors, we use a pre-defined, analytical function for the concentration profile, $c(z)$, that is designed to satisfy the problem's boundary conditions and produce a known surface flux. This allows for the isolation and assessment of the error stemming solely from the finite difference approximation of the gradient.\n\nFirst, we define the key analytical quantities based on the provided parameters for each test case: the diffusion coefficient ($D$), kinematic viscosity ($\\nu$), angular rotation rate ($\\omega$), and bulk concentration ($c^\\ast$).\n\nThe Levich equation provides the mass-transfer coefficient, $k_L$, under diffusion-limited conditions:\n$$\nk_L = 0.62\\,D^{2/3}\\,\\nu^{-1/6}\\,\\omega^{1/2}\n$$\nThe magnitude of the corresponding exact, limiting diffusive flux at the electrode surface ($z=0$) is given by:\n$$\n|J_L| = k_L\\,c^\\ast\n$$\nThis quantity, $|J_L|$, serves as the exact reference value against which our numerical approximation will be compared.\n\nNext, we employ the specified manufactured solution for the concentration profile:\n$$\nc(z) = c^\\ast\\left(1 - e^{-\\alpha z}\\right)\n$$\nThis function correctly satisfies the boundary conditions: $c(0) = c^\\ast(1-e^0) = 0$ and $c(z) \\to c^\\ast$ as $z \\to \\infty$. To ensure the manufactured solution is consistent with the RDE physics being modeled, the decay parameter $\\alpha$ is chosen such that the analytical flux derived from $c(z)$ exactly matches the Levich flux, $|J_L|$. The flux is defined by Fick's first law, $J = -D\\,\\frac{\\partial c}{\\partial z}$. The gradient of the manufactured solution is:\n$$\n\\frac{\\partial c}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[ c^\\ast\\left(1 - e^{-\\alpha z}\\right) \\right] = c^\\ast \\alpha e^{-\\alpha z}\n$$\nAt the surface ($z=0$), the gradient is $\\left.\\frac{\\partial c}{\\partial z}\\right|_{z=0} = c^\\ast \\alpha$. The magnitude of the exact flux is therefore:\n$$\n|J| = \\left|-D \\left.\\frac{\\partial c}{\\partial z}\\right|_{z=0}\\right| = D c^\\ast \\alpha\n$$\nBy setting this equal to the Levich flux, $|J_L| = k_L c^\\ast$, we find the required value for $\\alpha$:\n$$\nD c^\\ast \\alpha = k_L c^\\ast \\implies \\alpha = \\frac{k_L}{D}\n$$\nThis ensures that the manufactured solution has the correct physical properties at the boundary. The characteristic length scale of the concentration boundary layer, $\\delta_m$, is the inverse of this decay rate: $\\delta_m = 1/\\alpha = D/k_L$.\n\nWe now turn to the numerical approximation of the flux. The problem provides a second-order accurate, one-sided finite difference formula for the negative of the gradient at the surface:\n$$\n-\\left.\\frac{\\partial c}{\\partial z}\\right|_{z=0} \\approx \\frac{3c(z_0) - 4c(z_1) + c(z_2)}{2h}\n$$\nwhere $z_0=0$, $z_1=h$, and $z_2=2h$. We evaluate $c(z)$ at these points using our manufactured solution:\n- $c(z_0) = c(0) = c^\\ast(1 - e^0) = 0$\n- $c(z_1) = c(h) = c^\\ast(1 - e^{-\\alpha h})$\n- $c(z_2) = c(2h) = c^\\ast(1 - e^{-2\\alpha h})$\n\nSubstituting these into the formula yields the numerical approximation for the negative gradient:\n$$\n-\\left(\\frac{\\partial c}{\\partial z}\\right)_{\\text{approx}} = \\frac{3(0) - 4c^\\ast(1 - e^{-\\alpha h}) + c^\\ast(1 - e^{-2\\alpha h})}{2h} = \\frac{c^\\ast(-3 + 4e^{-\\alpha h} - e^{-2\\alpha h})}{2h}\n$$\nThe magnitude of the numerical flux, $|J_{\\text{num}}|$, is then $D$ times the magnitude of the approximated gradient:\n$$\n|J_{\\text{num}}| = \\left|-D \\left(\\frac{\\partial c}{\\partial z}\\right)_{\\text{approx}}\\right| = D \\left|-\\left(\\frac{\\partial c}{\\partial z}\\right)_{\\text{approx}}\\right| = D \\left| \\frac{c^\\ast(-3 + 4e^{-\\alpha h} - e^{-2\\alpha h})}{2h} \\right|\n$$\nSince for small positive $h$, the term $e^{-\\alpha h} \\approx 1-\\alpha h$, the numerator is approximately $c^\\ast(-3 + 4(1-\\alpha h) - (1-2\\alpha h)) = c^\\ast(-2\\alpha h)$, which is negative. Thus, we take the absolute value:\n$$\n|J_{\\text{num}}| = D \\left( \\frac{c^\\ast(3 - 4e^{-\\alpha h} + e^{-2\\alpha h})}{2h} \\right)\n$$\nTo verify the order of accuracy, we compute $|J_{\\text{num},i}|$ for three successively refined grid spacings: $h_1 = \\delta_m/200$, $h_2 = \\delta_m/400 = h_1/2$, and $h_3 = \\delta_m/800 = h_2/2$. For each grid spacing $h_i$, the relative error $e_i$ is calculated:\n$$\ne_i = \\frac{\\left||J_{\\text{num},i}| - |J_L|\\right|}{|J_L|}\n$$\nThe theoretical error for a numerical method of order $p$ behaves as $e \\approx C h^p$ for some constant $C$. Given two error measurements $e_1$ and $e_2$ corresponding to grid spacings $h_1$ and $h_2$, the order $p$ can be estimated by:\n$$\n\\frac{e_1}{e_2} \\approx \\frac{C h_1^p}{C h_2^p} = \\left(\\frac{h_1}{h_2}\\right)^p \\implies p = \\frac{\\ln(e_1/e_2)}{\\ln(h_1/h_2)}\n$$\nWe compute two such estimates, $p_{12}$ from $(h_1, h_2)$ and $p_{23}$ from $(h_2, h_3)$. Since our grid refinement factor is constant ($h_i/h_{i+1} = 2$), the formulas are:\n$$\np_{12} = \\frac{\\ln(e_1/e_2)}{\\ln(2)}, \\quad p_{23} = \\frac{\\ln(e_2/e_3)}{\\ln(2)}\n$$\nThe final reported order of accuracy, $p$, is the average of these two estimates:\n$$\np = \\frac{p_{12} + p_{23}}{2}\n$$\nFor a second-order accurate scheme as specified, the value of $p$ is expected to be very close to $2$. The algorithm proceeds by applying this entire calculation to each of the four test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and verifies a second-order accurate numerical scheme for \n    estimating the concentration gradient at a rotating disk electrode surface.\n    \"\"\"\n    \n    # Test cases are defined as tuples of (D, nu, omega, c_star)\n    # D: diffusion coefficient (m^2/s)\n    # nu: kinematic viscosity (m^2/s)\n    # omega: angular rotation rate (rad/s)\n    # c_star: bulk concentration (mol/m^3)\n    test_cases = [\n        # Case A (typical aqueous)\n        (1.0e-9, 1.0e-6, 100.0, 1.0),\n        # Case B (higher rotation, lower viscosity)\n        (1.5e-9, 8.0e-7, 500.0, 0.2),\n        # Case C (moderate rotation, higher concentration)\n        (0.8e-9, 1.1e-6, 50.0, 2.5),\n        # Case D (very high rotation)\n        (2.0e-9, 1.0e-6, 1000.0, 0.05),\n    ]\n\n    results = []\n    \n    for D, nu, omega, c_star in test_cases:\n        # Step 1: Calculate the Levich mass-transfer coefficient, k_L.\n        k_L = 0.62 * (D**(2.0/3.0)) * (nu**(-1.0/6.0)) * (omega**(1.0/2.0))\n\n        # Step 2: Calculate the analytical limiting flux magnitude, |J_L|.\n        J_L = k_L * c_star\n        \n        # Step 3: Determine the decay parameter 'alpha' for the manufactured solution.\n        alpha = k_L / D\n        \n        # Step 4: Define grid spacings based on the mass-transfer boundary-layer thickness.\n        delta_m = D / k_L  # which is equivalent to 1.0 / alpha\n        h_values = [\n            delta_m / 200.0,  # h1\n            delta_m / 400.0,  # h2\n            delta_m / 800.0   # h3\n        ]\n        \n        errors = []\n        for h in h_values:\n            # Step 5: Compute the numerical flux magnitude |J_num| using the 3-point one-sided scheme.\n            # The formula is |J_num| = D * c_star * (3 - 4*exp(-alpha*h) + exp(-2*alpha*h)) / (2*h).\n            \n            # Use np.expm1 for higher precision with small arguments (exp(x)-1).\n            # 3 - 4*exp(-ah) + exp(-2ah) = 3 - 4*(1+expm1(-ah)) + (1+expm1(-2ah))\n            # = 3 - 4 - 4*expm1(-ah) + 1 + expm1(-2ah)\n            # = -4*expm1(-ah) + expm1(-2ah)\n            # This avoids catastrophic cancellation from subtracting nearly equal numbers.\n            numerator_term = -4.0 * np.expm1(-alpha * h) + np.expm1(-2.0 * alpha * h)\n            J_num = D * c_star * numerator_term / (2.0 * h)\n\n            # Step 6: Calculate the relative error.\n            relative_error = np.abs(J_num - J_L) / J_L\n            errors.append(relative_error)\n\n        # Step 7: Estimate the observed order of accuracy, p.\n        e1, e2, e3 = errors[0], errors[1], errors[2]\n        h_ratio = 2.0  # h1/h2 = h2/h3 = 2.0\n        \n        # Calculate pairwise orders of accuracy.\n        p12 = np.log(e1 / e2) / np.log(h_ratio)\n        p23 = np.log(e2 / e3) / np.log(h_ratio)\n        \n        # Average the two estimates for a more robust result.\n        p_avg = (p12 + p23) / 2.0\n        results.append(p_avg)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}