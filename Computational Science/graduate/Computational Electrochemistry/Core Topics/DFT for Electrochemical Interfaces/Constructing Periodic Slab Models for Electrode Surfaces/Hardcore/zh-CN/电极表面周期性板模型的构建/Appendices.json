{
    "hands_on_practices": [
        {
            "introduction": "在进行任何表面模拟之前，首要任务是为给定的晶体表面（由密勒指数定义）正确地构建其二维周期性原胞。这项实践将引导您运用基本的晶体学原理来自动化这一过程，确保您的计算始于一个几何上自洽的、可靠的结构模型。通过这项练习，您将掌握从三维晶格生成任意二维表面晶格的核心技术。",
            "id": "4240150",
            "problem": "构建一个独立完整的程序，对于给定的原胞基矢与笛卡尔坐标轴对齐的正交布拉菲晶格，该程序能为由任意密勒指数指定的电极表面周期性平板模型自动生成面内原胞平移矢量，并验证从第一性原理推导出的表面积与层间距之间的几何一致性。正交正点阵的原胞基矢为 $\\mathbf{a}_1 = (a,0,0)$、$\\mathbf{a}_2 = (0,b,0)$ 和 $\\mathbf{a}_3 = (0,0,c)$，其中 $a$、$b$ 和 $c$ 是以埃（A）为单位的正实数长度。所有长度均使用埃（A），所有面积均使用平方埃（A$^2$）。无需输入角度；若程序内部需要，请使用弧度。\n\n您必须使用的基本依据包括以下核心定义和经过充分检验的事实：\n- 倒易点阵原胞基矢 $\\mathbf{b}_i$ 满足 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ函数。\n- 对于由密勒指数 $(h,k,l)$ 指定的晶面族，其对应的倒易点阵矢量为 $\\mathbf{G} = h \\mathbf{b}_1 + k \\mathbf{b}_2 + l \\mathbf{b}_3$，晶面间距 $d_{hkl}$ 满足关系式 $|\\mathbf{G}| = \\dfrac{2\\pi}{d_{hkl}}$。\n- 一个正点阵平移矢量 $\\mathbf{t} = u \\mathbf{a}_1 + v \\mathbf{a}_2 + w \\mathbf{a}_3$ 位于 $(hkl)$ 晶面内，当且仅当 $h u + k v + l w = 0$，其中 $u$、$v$ 和 $w$ 为整数。\n- $(hkl)$ 晶面的二维表面晶格由两个满足 $h u + k v + l w = 0$ 的独立面内正点阵矢量 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$ 张成。原胞表面积为 $A = \\|\\mathbf{t}_1 \\times \\mathbf{t}_2\\|$，其中 $\\times$ 是矢量叉乘，$\\|\\cdot\\|$ 表示欧几里得范数。\n- 三维原胞体积为 $V = \\left\\|\\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3)\\right\\| = a b c$。\n- 设 $g$ 表示整数 $h$、$k$ 和 $l$ 的最大公约数 (GCD)。对于一个使晶面指数增加最小正整数 $m = h u + k v + l w = g$ 的堆垛矢量 $\\mathbf{r}_n = u \\mathbf{a}_1 + v \\mathbf{a}_2 + w \\mathbf{a}_3$，其在 $(hkl)$ 晶面单位法向量 $\\hat{\\mathbf{n}}$ 上的投影等于 $m d_{hkl} = g d_{hkl}$。\n\n您的程序必须为每个测试用例实现以下任务：\n1. 通过枚举求解 $h u + k v + l w = 0$ 的整数三元组 $(u,v,w)$，并选择两个以埃为单位的长度最小且不共线的解，从而生成两个独立的最短面内原胞矢量 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$。您必须通过检查 $\\|\\mathbf{t}_1 \\times \\mathbf{t}_2\\| > 0$ 来确保其非共线性。\n2. 以平方埃（A$^2$）为单位，计算表面积 $A = \\|\\mathbf{t}_1 \\times \\mathbf{t}_2\\|$。\n3. 使用正交晶胞的倒易基矢，计算倒易点阵矢量 $\\mathbf{G}$ 和晶面间距 $d_{hkl} = \\dfrac{2\\pi}{\\|\\mathbf{G}\\|}$（以埃为单位，A）。\n4. 通过 $\\hat{\\mathbf{n}} = \\dfrac{\\mathbf{t}_1 \\times \\mathbf{t}_2}{\\|\\mathbf{t}_1 \\times \\mathbf{t}_2\\|}$ 计算表面的单位法向量 $\\hat{\\mathbf{n}}$。\n5. 找到一个具有最小正晶面指数增量 $m = h u + k v + l w = g$ 且长度最小的正点阵矢量 $\\mathbf{r}_n = u \\mathbf{a}_1 + v \\mathbf{a}_2 + w \\mathbf{a}_3$，并计算正空间间距 $d_{\\text{direct}} = \\dfrac{|\\hat{\\mathbf{n}} \\cdot \\mathbf{r}_n|}{m}$（以埃为单位，A）。如果构造正确，该值必须在数值容差范围内等于 $d_{hkl}$。\n6. 通过计算 $A_{\\text{theory}} = \\dfrac{V}{g\\, d_{hkl}}$（以平方埃为单位，A$^2$）并将其与叉乘面积 $A$ 进行比较，来验证连接面积和间距的体积恒等式。\n7. 对两项检查均使用 $10^{-12}$ 的相对容差，返回一个布尔值，该值为真的条件是当且仅当：\n   - $\\left|\\dfrac{A - A_{\\text{theory}}}{A_{\\text{theory}}}\\right| \\leq 10^{-12}$，且\n   - $\\left|\\dfrac{d_{hkl} - d_{\\text{direct}}}{d_{hkl}}\\right| \\leq 10^{-12}$。\n\n您的程序还必须构建超胞矢量以完善平板模型：给定复制因子 $(n_1,n_2,n_3)$，将超胞矢量定义为 $\\mathbf{S}_1 = n_1 \\mathbf{t}_1$、$\\mathbf{S}_2 = n_2 \\mathbf{t}_2$ 和 $\\mathbf{S}_3 = n_3 \\, d_{hkl} \\, \\hat{\\mathbf{n}}$。尽管这些超胞矢量无需用于数值检查，但必须在内部计算它们，以展示一个用于平板构建的自动化脚本。\n\n需要在程序中硬编码的测试套件包含以下参数集，每个参数集表示为 $(a,b,c; h,k,l; n_1,n_2,n_3)$，其中所有长度单位为埃（A），整数为无量纲：\n- 案例 1：$(a,b,c) = (\\,2.50,\\,3.10,\\,4.00\\,)$；$(h,k,l) = (\\,1,\\,1,\\,0\\,)$；$(n_1,n_2,n_3) = (\\,2,\\,2,\\,3\\,)$。\n- 案例 2：$(a,b,c) = (\\,3.60,\\,3.60,\\,3.60\\,)$；$(h,k,l) = (\\,2,\\,0,\\,0\\,)$；$(n_1,n_2,n_3) = (\\,1,\\,1,\\,2\\,)$。\n- 案例 3：$(a,b,c) = (\\,3.20,\\,2.70,\\,5.00\\,)$；$(h,k,l) = (\\,0,\\,1,\\,2\\,)$；$(n_1,n_2,n_3) = (\\,3,\\,1,\\,4\\,)$。\n- 案例 4：$(a,b,c) = (\\,5.10,\\,5.20,\\,5.30\\,)$；$(h,k,l) = (\\,3,\\,4,\\,5\\,)$；$(n_1,n_2,n_3) = (\\,1,\\,1,\\,1\\,)$。\n- 案例 5：$(a,b,c) = (\\,2.89,\\,3.00,\\,3.11\\,)$；$(h,k,l) = (\\,0,\\,0,\\,1\\,)$；$(n_1,n_2,n_3) = (\\,4,\\,5,\\,2\\,)$。\n\n您的枚举设计必须具有鲁棒性：如果在初始整数搜索边界内未找到两个独立的面内矢量，程序必须自动增加该边界至一个合理的上限，并继续搜索直至成功。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\texttt{[result1,result2,result3,result4,result5]}$。每个结果都必须是一个布尔值，对应于案例1到5，表明两项验证检查是否都在指定的容差范围内通过。",
            "solution": "该问题要求构建一个独立完整的程序，用于在正交晶格上为由密勒指数 $(h,k,l)$ 定义的电极表面生成并验证周期性平板模型。验证通过检查两个基本的几何一致性关系来执行。整个过程基于晶体学和固体物理学的原理。\n\n正交正点阵由三个正交原胞基矢定义：\n$$ \\mathbf{a}_1 = (a, 0, 0), \\quad \\mathbf{a}_2 = (0, b, 0), \\quad \\mathbf{a}_3 = (0, 0, c) $$\n该原胞的体积为 $V = |\\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3)| = a b c$。\n\n求解方法涉及几个相互关联的步骤，每个步骤都基于一个核心原理。\n\n**1. 倒易点阵与晶面间距 ($d_{hkl}$)**\n\n倒易点阵对于描述晶体中的周期性晶面至关重要。其原胞基矢 $\\mathbf{b}_i$ 由关系式 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克δ函数。对于给定的正交晶格，其倒易矢量也是正交的：\n$$ \\mathbf{b}_1 = \\left(\\frac{2\\pi}{a}, 0, 0\\right), \\quad \\mathbf{b}_2 = \\left(0, \\frac{2\\pi}{b}, 0\\right), \\quad \\mathbf{b}_3 = \\left(0, 0, \\frac{2\\pi}{c}\\right) $$\n一族晶面由其密勒指数 $(h,k,l)$ 唯一确定，这些指数定义了一个垂直于这些晶面的倒易点阵矢量 $\\mathbf{G}_{hkl}$：\n$$ \\mathbf{G}_{hkl} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3 = \\left(\\frac{2\\pi h}{a}, \\frac{2\\pi k}{b}, \\frac{2\\pi l}{c}\\right) $$\n该矢量的大小与晶面间距 $d_{hkl}$ 成反比：\n$$ \\|\\mathbf{G}_{hkl}\\| = \\frac{2\\pi}{d_{hkl}} $$\n由此，我们可以直接计算出晶面间距：\n$$ d_{hkl} = \\frac{2\\pi}{\\|\\mathbf{G}_{hkl}\\|} = \\frac{2\\pi}{\\sqrt{\\left(\\frac{2\\pi h}{a}\\right)^2 + \\left(\\frac{2\\pi k}{b}\\right)^2 + \\left(\\frac{2\\pi l}{c}\\right)^2}} = \\frac{1}{\\sqrt{\\left(\\frac{h}{a}\\right)^2 + \\left(\\frac{k}{b}\\right)^2 + \\left(\\frac{l}{c}\\right)^2}} $$\n这个计算是我们程序的第一步。\n\n**2. 面内表面矢量 ($\\mathbf{t}_1, \\mathbf{t}_2$) 与面积 ($A$)**\n\n表面平面的二维晶格由两个原胞平移矢量 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$ 张成。任何位于 $(hkl)$ 晶面内的晶格矢量 $\\mathbf{t}$ 都必须是正点阵基矢的线性组合，即 $\\mathbf{t} = u\\mathbf{a}_1 + v\\mathbf{a}_2 + w\\mathbf{a}_3$（其中 $u,v,w \\in \\mathbb{Z}$），并且必须与晶面法向的倒易矢量 $\\mathbf{G}_{hkl}$ 正交。这个正交条件简化为一个线性丢番图方程：\n$$ \\mathbf{t} \\cdot \\mathbf{G}_{hkl} = (u\\mathbf{a}_1 + v\\mathbf{a}_2 + w\\mathbf{a}_3) \\cdot (h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3) = 2\\pi(hu + kv + lw) = 0 $$\n$$ \\implies hu + kv + lw = 0 $$\n程序找到满足此方程的两个最短的、非共线的矢量 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$。这是通过在一个扩展的搜索空间中（即，增加最大绝对值）系统地枚举整数三元组 $(u,v,w)$ 来实现的。对于每个有效的三元组，计算相应的矢量 $\\mathbf{t} = (ua, vb, wc)$ 及其范数的平方。然后将收集到的矢量按范数排序。最短的矢量被选为 $\\mathbf{t}_1$。下一个与 $\\mathbf{t}_1$ 不共线的最短矢量（通过检查 $\\|\\mathbf{t}_1 \\times \\mathbf{t}_2\\| > \\epsilon$ 来验证，其中 $\\epsilon$ 是一个很小的容差）被选为 $\\mathbf{t}_2$。这两个矢量构成了二维表面晶胞的基底。这个表面原胞的面积由它们叉乘的模给出：\n$$ A = \\|\\mathbf{t}_1 \\times \\mathbf{t}_2\\| $$\n\n**3. 堆垛矢量 ($\\mathbf{r}_n$) 与正空间间距 ($d_{\\text{direct}}$)**\n\n堆垛矢量 $\\mathbf{r}_n = u\\mathbf{a}_1 + v\\mathbf{a}_2 + w\\mathbf{a}_3$ 连接同一晶面族中一个平面上的原子到另一个平面上的原子。点积 $\\mathbf{r}_n \\cdot \\mathbf{G}_{hkl} = 2\\pi(hu+kv+lw)$ 给出晶面指数增量的 $2\\pi$ 倍。最小的正晶面指数增量由 $m = hu+kv+lw = g$ 给出，其中 $g = \\text{GCD}(h, k, l)$ 是密勒指数的最大公约数。问题要求找到满足 $hu+kv+lw=g$ 的最短晶格矢量 $\\mathbf{r}_n$。这可以通过算法枚举 $(u,v,w)$ 并找到使 $\\mathbf{r}_n = (ua, vb, wc)$ 范数最小化的解来定位。\n\n由 $\\mathbf{r}_n$ 连接的平面之间的几何距离是 $\\mathbf{r}_n$ 在晶面单位法向量 $\\hat{\\mathbf{n}}$ 上的投影。这个距离必须等于 $g \\cdot d_{hkl}$。因此，我们可以定义一个间距的正空间计算值 $d_{\\text{direct}}$，并验证其与倒易空间值 $d_{hkl}$ 的一致性：\n$$ d_{\\text{direct}} = \\frac{|\\mathbf{r}_n \\cdot \\hat{\\mathbf{n}}|}{g}, \\quad \\text{其中} \\quad \\hat{\\mathbf{n}} = \\frac{\\mathbf{t}_1 \\times \\mathbf{t}_2}{\\|\\mathbf{t}_1 \\times \\mathbf{t}_2\\|} $$\n于是，第一个验证检查是 $\\left| (d_{hkl} - d_{\\text{direct}}) / d_{hkl} \\right| \\leq 10^{-12}$。\n\n**4. 体积恒等式验证**\n\n晶体学中的一个基本关系将三维原胞体积 $V$ 与二维表面原胞面积 $A$ 及晶面间距 $d_{hkl}$ 联系起来。三维晶胞的体积可以被认为是二维晶胞层层堆叠填充而成。这导出了以下恒等式：\n$$ V = g \\cdot A \\cdot d_{hkl} $$\n因子 $g = \\text{GCD}(h,k,l)$ 解释了密勒指数 $(h,k,l)$ 可能不互质的情况，这对应于一组晶面，其间距 $d_{hkl}$ 是由本原指数 $(h/g, k/g, l/g)$ 定义的晶面间距的 $1/g$。\n\n该恒等式提供了一个理论面积值，$A_{\\text{theory}} = V / (g \\cdot d_{hkl})$。第二个验证检查将其与通过生成的表面矢量叉乘计算出的面积进行比较：$\\left| (A - A_{\\text{theory}}) / A_{\\text{theory}} \\right| \\leq 10^{-12}$。通过此项检查证实了通过长度最小化启发式方法找到的矢量 $\\mathbf{t}_1$ 和 $\\mathbf{t}_2$ 确实构成了一个二维原胞。\n\n**5. 超胞构建**\n\n最后，在模拟中进行实际的平板模型构建时，通常需要超胞。程序根据表面原胞矢量、表面法线和用户提供的复制因子 $(n_1, n_2, n_3)$ 计算超胞矢量 $\\mathbf{S}_1, \\mathbf{S}_2, \\mathbf{S}_3$：\n$$ \\mathbf{S}_1 = n_1 \\mathbf{t}_1, \\quad \\mathbf{S}_2 = n_2 \\mathbf{t}_2, \\quad \\mathbf{S}_3 = n_3 d_{hkl} \\hat{\\mathbf{n}} $$\n这些矢量为平板计算定义了模拟盒子。虽然它们被计算出来，但不是验证检查的一部分。\n\n所实现的程序为每个测试用例系统地执行这些步骤，并返回一个布尔值，以表明两个几何一致性检查是否都成功。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\nimport numpy as np\nimport math\n\ndef gcd(a, b):\n    \"\"\"Computes the greatest common divisor of two integers.\"\"\"\n    return math.gcd(int(a), int(b))\n\ndef gcd3(a, b, c):\n    \"\"\"Computes the greatest common divisor of three integers.\"\"\"\n    return gcd(gcd(a, b), c)\n\ndef process_case(case_params):\n    \"\"\"\n    Processes a single test case to generate slab model vectors and verify\n    geometric consistency.\n    \"\"\"\n    a, b, c, h, k, l, n1, n2, n3 = case_params\n    lat_consts = np.array([a, b, c])\n    miller = np.array([h, k, l])\n    tol = 1e-12\n\n    # 1. Compute interplanar spacing from reciprocal space\n    if np.all(miller == 0):\n        return False  # Invalid Miller indices\n    \n    g_norm_sq_term = (miller / lat_consts)**2\n    g_norm_sq = np.sum(g_norm_sq_term)\n    if g_norm_sq == 0:\n        return False # Should be caught by the miller == 0 check\n    d_hkl = 1.0 / np.sqrt(g_norm_sq)\n\n    # 2. Find two shortest, non-collinear in-plane vectors t1, t2\n    # Condition: h*u + k*v + l*w = 0\n    t_candidates = []\n    # A sufficiently large search bound for the test cases\n    search_radius = 15  \n    for u in range(-search_radius, search_radius + 1):\n        for v in range(-search_radius, search_radius + 1):\n            for w in range(-search_radius, search_radius + 1):\n                if u == 0 and v == 0 and w == 0:\n                    continue\n                if np.dot(miller, [u, v, w]) == 0:\n                    vec = np.array([u * a, v * b, w * c])\n                    norm_sq = np.dot(vec, vec)\n                    t_candidates.append((norm_sq, vec))\n    \n    if not t_candidates:\n        return False # No non-trivial in-plane vectors found\n\n    t_candidates.sort(key=lambda x: x[0])\n    \n    t1 = t_candidates[0][1]\n    t2 = None\n    for _, vec_candidate in t_candidates[1:]:\n        cross_prod_norm = np.linalg.norm(np.cross(t1, vec_candidate))\n        # Ensure non-collinearity\n        if cross_prod_norm > 1e-9:\n            t2 = vec_candidate\n            break\n    \n    if t2 is None:\n        return False # Could not find two non-collinear vectors\n\n    # 3. Compute surface area A and unit normal n_hat\n    cross_product = np.cross(t1, t2)\n    A = np.linalg.norm(cross_product)\n    n_hat = cross_product / A\n\n    # 4. Find the shortest stacking vector r_n\n    # Condition: h*u + k*v + l*w = g\n    g = gcd3(h, k, l)\n    if g == 0:\n        # This case implies h=k=l=0, which should be handled earlier.\n        # This ensures g is at least 1 for valid Miller indices.\n        return False\n        \n    min_r_norm_sq = float('inf')\n    r_n = None\n    for u in range(-search_radius, search_radius + 1):\n        for v in range(-search_radius, search_radius + 1):\n            for w in range(-search_radius, search_radius + 1):\n                if np.dot(miller, [u, v, w]) == g:\n                    vec = np.array([u * a, v * b, w * c])\n                    norm_sq = np.dot(vec, vec)\n                    if norm_sq  min_r_norm_sq:\n                        min_r_norm_sq = norm_sq\n                        r_n = vec\n    \n    if r_n is None:\n        return False # No stacking vector found\n        \n    # 5. Compute direct-space spacing d_direct\n    d_direct = abs(np.dot(n_hat, r_n)) / g\n\n    # 6. Compute theoretical area A_theory\n    V = a * b * c\n    A_theory = V / (g * d_hkl)\n\n    # 7. Perform consistency checks\n    check_area = abs((A - A_theory) / A_theory) = tol\n    check_spacing = abs((d_hkl - d_direct) / d_hkl) = tol\n\n    # Compute supercell vectors (Task requirement)\n    S1 = n1 * t1\n    S2 = n2 * t2\n    S3 = n3 * d_hkl * n_hat\n\n    return check_area and check_spacing\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (2.50, 3.10, 4.00, 1, 1, 0, 2, 2, 3), # Case 1\n        (3.60, 3.60, 3.60, 2, 0, 0, 1, 1, 2), # Case 2\n        (3.20, 2.70, 5.00, 0, 1, 2, 3, 1, 4), # Case 3\n        (5.10, 5.20, 5.30, 3, 4, 5, 1, 1, 1), # Case 4\n        (2.89, 3.00, 3.11, 0, 0, 1, 4, 5, 2), # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(case)\n        results.append(str(result).lower())\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "定义了表面的基本原胞之后，实际的研究通常涉及在特定覆盖度下的吸附物。本练习提供了一个具体案例，演示了如何构建一个更大的“超胞”来模拟部分吸附物覆盖度，这是研究表面反应和电催化的核心任务。通过这个计算，您可以将晶体学结构与实际的表面化学情景联系起来。",
            "id": "4240125",
            "problem": "您正在使用一种适用于密度泛函理论 (DFT) 计算的周期性平板方法，对铂 (Pt) (111) 电极表面进行建模。铂具有面心立方 (FCC) 晶体结构，其 (111) 表面形成一个二维 (2D) 六方布拉菲晶格，其表面原胞包含一个顶层原子。您打算构建一个 $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ 超胞来表示顶位吸附，其中覆盖度定义为 $\\theta = N_{\\text{ads}}/N_{\\text{sites}}$，$N_{\\text{ads}}$ 是放置在顶层的吸附质数量，$N_{\\text{sites}}$ 是超胞中对称等价的吸附位点数量。对于顶位吸附，每个顶层原子提供一个位点。\n\n从覆盖度的定义和超胞的晶体学构建出发，并且仅利用以下事实：六方 (111) 晶格上的 $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ 超胞是通过将面内表面原胞晶格矢量缩放 $\\sqrt{3}$ 倍并相对于原胞晶格旋转 $30^{\\circ}$ 得到的，推导出每个超胞中的顶层原子数，从而确定当 $\\theta = 1/3$ 时的 $N_{\\text{ads}}$。然后，对于包含 $N_{\\text{layer}}=4$ 个 Pt 原子层的平板，计算当恰好有 $N_{\\text{ads}}$ 个吸附质在此覆盖度下占据顶层的顶位时，模拟单元中的总原子数。将您的最终结果表示为一个整数。最终计数无需四舍五入，也无物理单位。",
            "solution": "该问题要求我们确定一个为电极表面密度泛函理论 (DFT) 计算而设计的模拟单元中的原子总数。该模型由一个铂 (Pt) 平板和吸附质组成。我们必须首先验证问题陈述。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **材料与结构：** 铂 (Pt)，具有面心立方 (FCC) 晶体结构。\n- **表面：** (111) 表面。\n- **表面晶格：** 一个二维六方布拉菲晶格。\n- **原胞：** 表面原胞包含一个顶层原子。\n- **超胞：** 在原胞晶格上构建一个 $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ 超胞。\n- **超胞构建：** 超胞是“通过将面内表面原胞晶格矢量缩放 $\\sqrt{3}$ 倍并相对于原胞晶格旋转 $30^{\\circ}$ 得到的”。\n- **吸附位点：** 考虑顶位吸附，每个顶层原子提供一个吸附位点。\n- **覆盖度定义：** 覆盖度定义为 $\\theta = N_{\\text{ads}}/N_{\\text{sites}}$，其中 $N_{\\text{ads}}$ 是吸附质的数量，$N_{\\text{sites}}$ 是超胞中对称等价的吸附位点数量。\n- **给定覆盖度：** $\\theta = 1/3$。\n- **平板厚度：** 平板包含 $N_{\\text{layer}}=4$ 个 Pt 原子层。\n- **目标：** 计算在给定覆盖度下，包含 Pt 平板和 $N_{\\text{ads}}$ 个吸附质的模拟单元中的原子总数。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地基于固态物理学和表面科学的原理。对 Pt(111) 表面、其六方晶格、$(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ 超胞的构建（一种称为 Wood's 记法的标准记法）以及覆盖度的定义，在计算材料科学领域都是标准且正确的。\n- **良定性：** 该问题是良定的。它提供了所有必要的信息：基底的结构、超胞的定义、平板中的层数、吸附位点的类型以及特定的覆盖度。这使得可以得到一个唯一的整数解。\n- **客观性：** 该问题以精确、客观和技术性的语言陈述，没有歧义或主观陈述。\n\n**第 3 步：结论与行动**\n该问题在科学上是合理的、自洽的且良定的。它被判定为 **有效**。我们可以继续进行求解。\n\n### 详细解法\n\n模拟单元中的原子总数 $N_{\\text{total}}$ 是 Pt 平板中的原子数 $N_{\\text{slab}}$ 与吸附质原子数 $N_{\\text{ads}}$ 的和。\n$$N_{\\text{total}} = N_{\\text{slab}} + N_{\\text{ads}}$$\n\n**1. 确定超胞中每层的原子数。**\n在超胞的横向边界内，平板每一层中的原子数由超胞与表面原胞之间的关系确定。问题陈述指出，Pt(111) 表面的原胞包含一个顶层原子。\n\n一个超胞内包含的原胞数量由它们的面积之比给出，$N_{\\text{prim}} = A_{\\text{super}} / A_{\\text{prim}}$。由于每个原胞在表面层中包含一个原子，因此超胞中的顶层原子数 $N_{\\text{top}}$ 等于该比率。\n$$N_{\\text{top}} = \\frac{A_{\\text{super}}}{A_{\\text{prim}}}$$\n由两个矢量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 在平面中定义的平行四边形的面积由它们叉积的模给出，如果将矢量表示为矩阵的列，则简化为 $|\\det(\\mathbf{u}, \\mathbf{v})|$。\n\n设原胞晶格矢量为 $\\mathbf{a}_1$ 和 $\\mathbf{a}_2$。原胞的面积为 $A_{\\text{prim}} = ||\\mathbf{a}_1 \\times \\mathbf{a}_2||$。\n超胞矢量 $\\mathbf{A}_1$ 和 $\\mathbf{A}_2$ 是由原胞矢量的线性变换生成的，使得 $(\\mathbf{A}_1, \\mathbf{A}_2) = (\\mathbf{a}_1, \\mathbf{a}_2) M$，其中 $M$ 是变换矩阵。超胞的面积则为 $A_{\\text{super}} = |\\det(M)| A_{\\text{prim}}$。\n\n对于六方晶格上的 $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ 超胞，变换矩阵 $M$ 是众所周知的：\n$$M = \\begin{pmatrix} 2  1 \\\\ -1  1 \\end{pmatrix}$$\n该矩阵的行列式为 $\\det(M) = (2)(1) - (1)(-1) = 2 + 1 = 3$。\n或者，使用问题中的明确描述，该变换涉及缩放 $\\sqrt{3}$ 倍并旋转 $30^{\\circ}$。在二维中，缩放加旋转变换的行列式是缩放因子的平方，即 $(\\sqrt{3})^2 = 3$。\n\n因此，超胞的面积是原胞面积的 $3$ 倍：\n$$A_{\\text{super}} = 3 A_{\\text{prim}}$$\n这意味着超胞包含 $3$ 个原胞。由于每个原胞每层有一个原子，超胞中的顶层原子数为：\n$$N_{\\text{top}} = 3$$\n这是平板模型中任何单层中的 Pt 原子数。\n\n**2. 计算平板中的总原子数。**\n该平板由 $N_{\\text{layer}} = 4$ 个原子层组成。超胞内的每一层包含 $N_{\\text{top}} = 3$ 个 Pt 原子。\n平板中的 Pt 原子总数为：\n$$N_{\\text{slab}} = N_{\\text{layer}} \\times N_{\\text{top}} = 4 \\times 3 = 12$$\n\n**3. 确定吸附质原子的数量。**\n覆盖度 $\\theta$ 定义为 $\\theta = N_{\\text{ads}} / N_{\\text{sites}}$。\n我们已知 $\\theta = 1/3$。\n问题指定了在顶位进行吸附。对于顶位吸附，每个顶层原子提供一个可能的吸附位点。因此，超胞中的可用吸附位点数 $N_{\\text{sites}}$ 等于超胞中的顶层原子数。\n$$N_{\\text{sites}} = N_{\\text{top}} = 3$$\n我们现在可以计算在给定覆盖度下的吸附质数量 $N_{\\text{ads}}$：\n$$N_{\\text{ads}} = \\theta \\times N_{\\text{sites}} = \\frac{1}{3} \\times 3 = 1$$\n所以，模拟单元中有 $1$ 个吸附质原子。\n\n**4. 计算原子总数。**\n模拟单元中的原子总数是平板中的原子数和吸附质原子数的总和。\n$$N_{\\text{total}} = N_{\\text{slab}} + N_{\\text{ads}} = 12 + 1 = 13$$\n因此，模拟单元总共包含 $13$ 个原子。",
            "answer": "$$\\boxed{13}$$"
        },
        {
            "introduction": "计算模拟的原始输出并非最终答案，严谨的数据分析是获得物理上有意义结果的关键。这项实践探讨了如何处理系统误差，特别是由于平板模型厚度有限而产生的有限尺寸效应。您将学习如何设计一个回归方案，利用一系列不同厚度的计算结果来外推出物理上精确的表面能，这是从模型*构建*到模型*分析*的关键一步。",
            "id": "4240230",
            "problem": "在平面波Kohn–Sham密度泛函理论（DFT）计算中，一个电极表面被建模为一个周期性平板。该平板的横向面积为$A$，包含$N$个原子层，并沿表面法线方向由厚度为$L_{\\text{vac}}$的真空层隔开。该平板的总能量记为$E_{\\text{slab}}(N)$。对于具有$2$个等效表面的对称平板，单位面积的表面能$ \\gamma $定义为相对于体相的单位面积超额能量，是界面稳定性和电化学建模中关注的热力学量。\n\n从基本定义出发：表面能是超出体相贡献的、单位表面积的超额能量。在理想的半无限极限下，平板能量分解为一个与$N$成正比的体相项和一个与$2 A$成正比的表面项。在实际计算中，$E_{\\text{slab}}(N)$还包含有限尺寸误差，这些误差来源于：(i) 两个表面之间通过有限平板厚度的相互作用，(ii) 平板与其周期性镜像之间通过有限真空层的相互作用，以及 (iii) 量子限制效应和$k$点取样效应。当$N \\to \\infty$和$L_{\\text{vac}} \\to \\infty$时，这些误差会消失，但对于实际的$N$和$L_{\\text{vac}}$，如果处理不当，它们会使$ \\gamma $的朴素估计产生偏差。\n\n给你一组在固定的$A$和$L_{\\text{vac}}$下，针对多个$N$值计算出的$E_{\\text{slab}}(N)$。假设每层的体相能量$E_{\\text{bulk}}$未知，但可以作为一个未知参数与$ \\gamma $一同自洽地推断出来。进一步假设，对于所关注的材料类别，$N$中的主要有限尺寸修正在函数形式上已知，可以近似为一个随$N$衰减的光滑函数$f(N)$（例如，对于金属性量子尺寸效应，$f(N) = 1/N$；对于绝缘体表面，其衰减长度$\\xi$可从独立分析中得知，此时$f(N) = e^{-N/\\xi}$），并且$E_{\\text{slab}}(N)$中的任何残余误差都具有异方差性，其方差$\\sigma_N^2$已知或可从计算设置中估计。\n\n从第一性原理出发，解释当使用单点$N$估计量$ \\gamma_N = \\left(E_{\\text{slab}}(N) - N E_{\\text{bulk}}\\right)/(2A) $时，$E_{\\text{slab}}(N)$中的有限尺寸误差如何使表面能$ \\gamma $产生偏差。然后，选择最合适的回归方案，通过将$E_{\\text{slab}}(N)$拟合到一个参数线性的模型来提取$ \\gamma $。该模型应包括体相和表面贡献，并考虑了主要的有限尺寸修正。该回归方案应能随着$N$的变化得到$ \\gamma $的渐近无偏估计，并且从拟合系数到$ \\gamma $的映射关系清晰。\n\n哪个选项是最佳选择？\n\nA. 拟合参数线性模型 $E_{\\text{slab}}(N) = \\beta_1 N + \\beta_0 + \\beta_f f(N) + \\varepsilon_N$ 来涵盖所有可用的$N$值，其中$f(N)$代表主要的有限尺寸修正（例如，对于金属，$f(N) = 1/N$；对于绝缘体，当$\\xi$已知时，$f(N) = e^{-N/\\xi}$），而$\\varepsilon_N$是均值为零、方差为$\\sigma_N^2$的噪声。使用权重为$w_N = 1/\\sigma_N^2$的加权最小二乘法来估计$(\\hat{\\beta}_1, \\hat{\\beta}_0, \\hat{\\beta}_f)$，确定$E_{\\text{bulk}} = \\hat{\\beta}_1$，并计算$\\gamma = \\hat{\\beta}_0/(2A)$。验证残差与$N$不相关，并根据$f(N)$衰减。\n\nB. 使用普通最小二乘法，将$\\displaystyle \\frac{E_{\\text{slab}}(N)}{A}$对$\\displaystyle \\frac{1}{N}$进行线性回归，将斜率视为$2 \\gamma$，截距视为$E_{\\text{bulk}}$。这避免了直接拟合$E_{\\text{slab}}(N)$中的截距，并减少了参数间的相关性。\n\nC. 对每个$N$使用从单独的体相计算中获得的参考体相能量$E_{\\text{bulk}}^{\\text{ref}}$来计算$\\gamma_N = \\left(E_{\\text{slab}}(N) - N E_{\\text{bulk}}^{\\text{ref}}\\right)/(2A)$，然后对$\\gamma_N$在所有$N$上求平均以获得$\\bar{\\gamma}$。这种平均可以减少随机噪声并抵消有限尺寸效应。\n\nD. 将$E_{\\text{slab}}(N)$对$N$进行线性拟合，并将截距约束为零以减小方差，然后通过将拟合斜率除以$2A$来计算$\\gamma$。由于$L_{\\text{vac}}$是有限的，任何表面贡献都隐含地包含在斜率中。\n\nE. 拟合模型$E_{\\text{slab}}(N) = \\beta_1 N + \\beta_0 + \\beta_e e^{-N/\\xi} + \\varepsilon_N$，但将衰减长度$\\xi$作为非线性最小二乘拟合中的一个额外自由参数来处理，并确定$\\gamma = \\beta_0/(2A)$。非线性拟合是必要的，因为衰减长度不是先验已知的，并且与$N$和$f(N)$的线性回归相比，它提高了灵活性。\n\n选择唯一的最佳选项并根据推导以及模型参数到$ \\gamma $的映射关系来证明你的选择。",
            "solution": "本题要求解释在从DFT平板计算中提取表面能$\\gamma$时，有限尺寸效应如何引入偏差，并确定用于提取$\\gamma$的无偏估计的最合适的回归方案。\n\n### 第1部分：物理模型的推导与偏差分析\n\n出发点是一个具有$N$个原子层、横向面积为$A$和两个等效表面的对称平板的总能量的基本定义。在无限厚平板（$N \\to \\infty$）的理想极限下，能量$E_{\\text{slab}}(N)$是与体积（或原子层数$N$）成正比的体相贡献和与总表面积（$2A$）成正比的表面贡献之和。\n\n$$ E_{\\text{slab}}(N) = N E_{\\text{bulk}} + 2 \\gamma A $$\n\n在这里，$E_{\\text{bulk}}$是体相晶体中每个原子层的能量，而$\\gamma$是单位面积的表面能。\n\n在具有有限平板厚度$N$的实际计算中，题目指出会产生额外的误差项。这些误差包括两个平板表面间的相互作用和量子限制效应。这些误差随着$N$的增加而衰减。题目提供了一个针对这些修正的模型，指出主要的有限尺寸修正可以近似为一个函数$f(N)$。我们可以将平板的总能量写为：\n\n$$ E_{\\text{slab}}(N) = N E_{\\text{bulk}} + 2 \\gamma A + E_{\\text{err}}(N) $$\n\n其中$E_{\\text{err}}(N)$代表由有限尺寸效应产生的总能量贡献。题目明确指出，这可以被建模为$E_{\\text{err}}(N) \\approx C_f' f(N) + \\varepsilon_N$，其中$C_f'$是一个常数前置因子，$f(N)$是一个已知的随$N$衰减的函数（例如$f(N) = 1/N$或$f(N) = e^{-N/\\xi}$），$\\varepsilon_N$是一个均值为零、方差为$\\sigma_N^2$的随机误差项。该方差是异方差的，意味着它依赖于$N$。\n\n因此，计算能量的完整模型是：\n\n$$ E_{\\text{slab}}(N) = N E_{\\text{bulk}} + 2 \\gamma A + C_f' f(N) + \\varepsilon_N $$\n\n现在我们可以分析单点$N$估计量$\\gamma_N$的偏差，其定义为$\\gamma_N = \\left(E_{\\text{slab}}(N) - N E_{\\text{bulk}}\\right)/(2A)$。暂时假设我们知道真实的$E_{\\text{bulk}}$，代入完整的能量模型可得：\n\n$$ \\gamma_N = \\frac{(N E_{\\text{bulk}} + 2 \\gamma A + C_f' f(N) + \\varepsilon_N) - N E_{\\text{bulk}}}{2A} $$\n$$ \\gamma_N = \\frac{2 \\gamma A + C_f' f(N) + \\varepsilon_N}{2A} $$\n$$ \\gamma_N = \\gamma + \\frac{C_f'}{2A} f(N) + \\frac{\\varepsilon_N}{2A} $$\n\n该估计量的期望值为$E[\\gamma_N] = \\gamma + \\frac{C_f'}{2A} f(N)$，因为$E[\\varepsilon_N] = 0$。偏差是期望值与真值$\\gamma$之间的差：\n\n$$ \\text{Bias}(\\gamma_N) = E[\\gamma_N] - \\gamma = \\frac{C_f'}{2A} f(N) $$\n\n这表明，朴素的估计量存在一个通过函数$f(N)$依赖于$N$的偏差。该偏差仅在$N \\to \\infty$的极限下才消失。此外，由于$E_{\\text{bulk}}$是未知的，必须被确定，使用一个不准确的参考值$E_{\\text{bulk}}^{\\text{ref}}$将引入一个更严重的、与$N(E_{\\text{bulk}} - E_{\\text{bulk}}^{\\text{ref}})$成正比的额外偏差项，使得这种方法非常不可靠。\n\n### 第2部分：回归方案的构建\n\n为了从一组$(N, E_{\\text{slab}}(N))$数据点中自洽地、无偏地提取$\\gamma$和$E_{\\text{bulk}}$，我们必须将数据拟合到我们推导出的模型。该模型为：\n\n$$ E_{\\text{slab}}(N) = N E_{\\text{bulk}} + 2 \\gamma A + C_f' f(N) + \\varepsilon_N $$\n\n这是一个参数线性的回归模型。我们可以定义回归系数如下：\n*   $\\beta_1 = E_{\\text{bulk}}$ （相对于$N$的斜率）\n*   $\\beta_0 = 2 \\gamma A$ （截距）\n*   $\\beta_f = C_f'$ （修正函数$f(N)$的系数）\n\n因此，回归模型为：\n\n$$ E_{\\text{slab}}(N) = \\beta_1 N + \\beta_0 + \\beta_f f(N) + \\varepsilon_N $$\n\n题目指出，残差$\\varepsilon_N$具有已知的异方差性，方差为$\\sigma_N^2$。对于误差方差非恒定的线性回归模型，最佳线性无偏估计量（BLUE）是通过加权最小二乘法（WLS）获得的。最优权重$w_N$是误差方差的倒数，即$w_N = 1/\\sigma_N^2$。\n\nWLS过程通过最小化加权残差平方和来找到系数$(\\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_f)$：\n\n$$ \\chi^2 = \\sum_i w_{N_i} \\left( E_{\\text{slab}}(N_i) - (\\beta_1 N_i + \\beta_0 + \\beta_f f(N_i)) \\right)^2 $$\n\n在拟合并获得估计系数$(\\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_f)$后，我们可以提取物理参数：\n*   每层体相能量的估计值为$\\hat{E}_{\\text{bulk}} = \\hat{\\beta}_1$。\n*   表面能从截距中估计得出：$\\hat{\\gamma} = \\hat{\\beta}_0 / (2A)$。\n\n这种方法在统计上是严谨的。它考虑了体相和表面贡献，明确地对主要的有限尺寸误差进行建模（使得对$\\gamma$和$E_{\\text{bulk}}$的估计是渐近无偏的），并正确处理了计算数据的异方差性。\n\n### 第3部分：选项评估\n\n**A. 拟合参数线性模型 $E_{\\text{slab}}(N) = \\beta_1 N + \\beta_0 + \\beta_f f(N) + \\varepsilon_N$ 来涵盖所有可用的$N$值，其中$f(N)$代表主要的有限尺寸修正（例如，对于金属，$f(N) = 1/N$；对于绝缘体，当$\\xi$已知时，$f(N) = e^{-N/\\xi}$），而$\\varepsilon_N$是均值为零、方差为$\\sigma_N^2$的噪声。使用权重为$w_N = 1/\\sigma_N^2$的加权最小二乘法来估计$(\\hat{\\beta}_1, \\hat{\\beta}_0, \\hat{\\beta}_f)$，确定$E_{\\text{bulk}} = \\hat{\\beta}_1$，并计算$\\gamma = \\hat{\\beta}_0/(2A)$。验证残差与$N$不相关，并根据$f(N)$衰减。**\n\n该选项与推导出的过程完全匹配。它指定了正确的回归模型、正确的统计方法（使用权重$1/\\sigma_N^2$的WLS）以及从拟合系数到物理量的正确映射。最后的验证步骤，虽然措辞略有不精确（应检查残差与预测变量不相关，而不是它们像$f(N)$那样衰减），但反映了良好的统计实践。这是最全面、最正确的方法。\n**结论：正确**\n\n**B. 使用普通最小二乘法，将$\\displaystyle \\frac{E_{\\text{slab}}(N)}{A}$对$\\displaystyle \\frac{1}{N}$进行线性回归，将斜率视为$2 \\gamma$，截距视为$E_{\\text{bulk}}$。这避免了直接拟合$E_{\\text{slab}}(N)$中的截距，并减少了参数间的相关性。**\n\n这是不正确的。对正确的能量模型进行变换，我们得到$\\frac{E_{\\text{slab}}(N)}{A} = \\frac{E_{\\text{bulk}}}{A} N + 2\\gamma + \\frac{C_f'}{A} f(N) + \\frac{\\varepsilon_N}{A}$。这并不是$1/N$的线性函数。这个选项似乎是基于对另一种线性化方法（例如，对于简化模型，绘制$E_{\\text{slab}}(N)/N$对$1/N$的图）的错误应用，即便如此，斜率和截距到$\\gamma$和$E_{\\text{bulk}}$的映射也是错误的。它还不当地建议使用普通最小二乘法（OLS）而不是WLS。\n**结论：不正确**\n\n**C. 对每个$N$使用从单独的体相计算中获得的参考体相能量$E_{\\text{bulk}}^{\\text{ref}}$来计算$\\gamma_N = \\left(E_{\\text{slab}}(N) - N E_{\\text{bulk}}^{\\text{ref}}\\right)/(2A)$，然后对$\\gamma_N$在所有$N$上求平均以获得$\\bar{\\gamma}$。这种平均可以减少随机噪声并抵消有限尺寸效应。**\n\n这是不正确的。如上所述，这种方法存在两个主要缺陷。首先，如果参考体相能量与平板计算中的有效体相能量不完全匹配，它会引入一个与$N(E_{\\text{bulk}} - E_{\\text{bulk}}^{\\text{ref}})$成正比的系统性偏差。其次，对有偏差的$\\gamma_N$值求平均并不能抵消有限尺寸偏差；它仅仅是将其平均化，导致最终结果仍然有偏差，并且依赖于所使用的$N$的范围。\n**结论：不正确**\n\n**D. 将$E_{\\text{slab}}(N)$对$N$进行线性拟合，并将截距约束为零以减小方差，然后通过将拟合斜率除以$2A$来计算$\\gamma$。由于$L_{\\text{vac}}$是有限的，任何表面贡献都隐含地包含在斜率中。**\n\n这从根本上是错误的。在模型$E_{\\text{slab}}(N) = N E_{\\text{bulk}} + 2\\gamma A + \\dots$中，表面能与截距（$N=0$的外推值）直接相关。将截距约束为零等同于假设$\\gamma=0$，这与计算的根本目的相矛盾。这将表面能项强行纳入拟合的斜率中，从而破坏了$E_{\\text{bulk}}$的估计，并且无法确定$\\gamma$。\n**结论：不正确**\n\n**E. 拟合模型$E_{\\text{slab}}(N) = \\beta_1 N + \\beta_0 + \\beta_e e^{-N/\\xi} + \\varepsilon_N$，但将衰减长度$\\xi$作为非线性最小二乘拟合中的一个额外自由参数来处理，并确定$\\gamma = \\beta_0/(2A)$。非线性拟合是必要的，因为衰减长度不是先验已知的，并且与$N$和$f(N)$的线性回归相比，它提高了灵活性。**\n\n在题目的背景下，这是不正确的。题目明确指出，函数形式$f(N)$是已知的，并提供了一个例子，其中衰减长度$\\xi$是“从独立分析中得知”的。通过将$\\xi$视为自由参数，该选项与给定的假设相矛盾，并将一个参数线性问题转变为一个更复杂的非线性问题。虽然在$\\xi$未知的真实研究场景中这可能是一种有效的探索性方法，但它不是题目所描述的正确程序。该问题被设定为可以通过对参数线性模型使用WLS来解决。选项A为此提供了通用框架，它更优越，也更忠实于题目的前提。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}