{
    "hands_on_practices": [
        {
            "introduction": "The simplest and most intuitive van der Waals corrections are based on a pairwise sum of atom-atom interactions, typically following a $-C_6 R^{-6}$ form. This exercise guides you through the fundamental process of computing the total dispersion energy between an adsorbate and a periodic surface by performing a direct, real-space summation over lattice images . By implementing this yourself and testing for convergence, you will gain a concrete understanding of how these corrections work and the importance of numerical parameters like the cutoff radius.",
            "id": "4261665",
            "problem": "You are modeling long-range interactions between a single adsorbate and a two-dimensional periodic lattice representing an electrode surface. In computational electrochemistry, the dispersion interaction (sometimes added as a correction to Density Functional Theory calculations) is modeled by a pairwise energy that decays as a power law consistent with the London dispersion interaction. Assume one substrate atom per unit cell located at the origin of each lattice cell, and an infinitely extended two-dimensional lattice generated by periodic boundary conditions.\n\nFundamental base:\n- The pairwise dispersion energy between two species separated by a distance $r$ is modeled as $-C_6 r^{-6}$, where $C_6$ is a constant with units of energy times length to the sixth power.\n- A two-dimensional periodic lattice with lattice parameters $L_x$ and $L_y$ has image positions at $(i L_x, j L_y, 0)$ for integers $i$ and $j$.\n- The adsorbate is at a fixed Cartesian position $(x_0, y_0, z_0)$ above the lattice plane.\n\nDefinitions required for the computation:\n- For each image indexed by integers $i$ and $j$, the separation between the adsorbate and the substrate atom at that image is\n$$\nr_{ij} = \\sqrt{(x_0 - i L_x)^2 + (y_0 - j L_y)^2 + z_0^2}.\n$$\n- The dispersion correction energy at a finite real-space cutoff $r_c$ is the truncated sum\n$$\nE_{\\mathrm{disp}}(r_c) = - \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} \\frac{C_6}{r_{ij}^6}.\n$$\n- Convergence with respect to the cutoff is assessed by comparing energies at successive cutoffs. Using a tolerance $\\varepsilon$ (in energy units), define\n$$\n\\Delta E = \\left| E_{\\mathrm{disp}}(r_c^{(n)}) - E_{\\mathrm{disp}}(r_c^{(n-1)}) \\right|.\n$$\nThe energy is considered converged at the largest cutoff $r_c^{(n)}$ if $\\Delta E < \\varepsilon$.\n\nAlgorithmic constraints:\n- Distances must be in ångström ($\\mathrm{\\AA}$).\n- Energies must be in electron-volts ($\\mathrm{eV}$).\n- The constant $C_6$ must be specified in $\\mathrm{eV}\\,\\mathrm{\\AA}^6$.\n- Use a real-space cutoff $r_c$ to include only images with $r_{ij} \\le r_c$.\n- To ensure coverage of images, you may bound indices by $i \\in [-N_x, N_x]$ and $j \\in [-N_y, N_y]$, where $N_x = \\lceil r_c / L_x \\rceil + 1$ and $N_y = \\lceil r_c / L_y \\rceil + 1$, then filter by $r_{ij} \\le r_c$.\n- If a test case provides fewer than two cutoff values, treat the convergence flag as false, since the difference $\\Delta E$ cannot be evaluated.\n\nYour task is to write a complete, runnable program that:\n1. Computes $E_{\\mathrm{disp}}(r_c)$ for each provided cutoff in a test case.\n2. Returns, for each test case, a two-element list containing the energy at the largest cutoff and a boolean indicating whether the energy is converged according to the criterion above.\n\nTest suite:\n- Case $1$ (happy path):\n  - $L_x = 2.5\\,\\mathrm{\\AA}$, $L_y = 2.5\\,\\mathrm{\\AA}$.\n  - $x_0 = 0.0\\,\\mathrm{\\AA}$, $y_0 = 0.0\\,\\mathrm{\\AA}$, $z_0 = 3.0\\,\\mathrm{\\AA}$.\n  - $C_6 = 12.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$.\n  - Cutoffs $[6.0\\,\\mathrm{\\AA}, 10.0\\,\\mathrm{\\AA}, 14.0\\,\\mathrm{\\AA}, 20.0\\,\\mathrm{\\AA}]$.\n  - Tolerance $\\varepsilon = 1.0 \\times 10^{-5}\\,\\mathrm{eV}$.\n\n- Case $2$ (boundary where the smallest cutoff excludes the nearest image):\n  - $L_x = 3.0\\,\\mathrm{\\AA}$, $L_y = 3.0\\,\\mathrm{\\AA}$.\n  - $x_0 = 0.0\\,\\mathrm{\\AA}$, $y_0 = 0.0\\,\\mathrm{\\AA}$, $z_0 = 5.0\\,\\mathrm{\\AA}$.\n  - $C_6 = 20.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$.\n  - Cutoffs $[3.0\\,\\mathrm{\\AA}, 5.0\\,\\mathrm{\\AA}, 9.0\\,\\mathrm{\\AA}]$.\n  - Tolerance $\\varepsilon = 1.0 \\times 10^{-6}\\,\\mathrm{eV}$.\n\n- Case $3$ (offset adsorbate over an anisotropic lattice):\n  - $L_x = 4.0\\,\\mathrm{\\AA}$, $L_y = 3.0\\,\\mathrm{\\AA}$.\n  - $x_0 = 2.0\\,\\mathrm{\\AA}$, $y_0 = 1.5\\,\\mathrm{\\AA}$, $z_0 = 2.5\\,\\mathrm{\\AA}$.\n  - $C_6 = 8.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$.\n  - Cutoffs $[8.0\\,\\mathrm{\\AA}, 16.0\\,\\mathrm{\\AA}, 24.0\\,\\mathrm{\\AA}]$.\n  - Tolerance $\\varepsilon = 1.0 \\times 10^{-5}\\,\\mathrm{eV}$.\n\n- Case $4$ (larger cell, stringent convergence check):\n  - $L_x = 5.0\\,\\mathrm{\\AA}$, $L_y = 7.0\\,\\mathrm{\\AA}$.\n  - $x_0 = 1.25\\,\\mathrm{\\AA}$, $y_0 = 3.5\\,\\mathrm{\\AA}$, $z_0 = 3.5\\,\\mathrm{\\AA}$.\n  - $C_6 = 15.0\\,\\mathrm{eV}\\,\\mathrm{\\AA}^6$.\n  - Cutoffs $[10.0\\,\\mathrm{\\AA}, 20.0\\,\\mathrm{\\AA}, 30.0\\,\\mathrm{\\AA}, 40.0\\,\\mathrm{\\AA}]$.\n  - Tolerance $\\varepsilon = 1.0 \\times 10^{-7}\\,\\mathrm{eV}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The element corresponding to each test case must be a two-element list in the form $[E, \\mathrm{converged}]$, where $E$ is the energy at the largest cutoff in $\\mathrm{eV}$ as a floating-point number, and $\\mathrm{converged}$ is a boolean.\n- For example, the output should have the form $[[E_1,\\mathrm{True}],[E_2,\\mathrm{False}],\\dots]$.",
            "solution": "The problem posed is to calculate the van der Waals dispersion energy between a single adsorbate molecule and a two-dimensional periodic lattice, representing a surface. The analysis must be performed for several cutoff radii and a judgment on the convergence of the energy must be made.\n\n### 1. Problem Validation\nThe problem is first validated against the specified criteria.\n\n-   **Givens Extracted:**\n    -   Pairwise dispersion energy: $E_{pair} = -C_6 r^{-6}$.\n    -   Lattice image positions: $(i L_x, j L_y, 0)$ for $i, j \\in \\mathbb{Z}$.\n    -   Lattice parameters: $L_x, L_y$.\n    -   Adsorbate position: $(x_0, y_0, z_0)$.\n    -   Adsorbate-image distance: $r_{ij} = \\sqrt{(x_0 - i L_x)^2 + (y_0 - j L_y)^2 + z_0^2}$.\n    -   Truncated dispersion energy: $E_{\\mathrm{disp}}(r_c) = - \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} \\frac{C_6}{r_{ij}^6}$.\n    -   Convergence criterion: $\\Delta E = \\left| E_{\\mathrm{disp}}(r_c^{(n)}) - E_{\\mathrm{disp}}(r_c^{(n-1)}) \\right| < \\varepsilon$.\n    -   Algorithmic constraint for index range: $i \\in [-N_x, N_x], j \\in [-N_y, N_y]$ where $N_x = \\lceil r_c / L_x \\rceil + 1, N_y = \\lceil r_c / L_y \\rceil + 1$.\n    -   Rule for convergence flag: `False` if fewer than two cutoff values are provided.\n    -   Units: Distances in ångström ($\\mathrm{\\AA}$), energies in electron-volts ($\\mathrm{eV}$), $C_6$ in $\\mathrm{eV}\\,\\mathrm{\\AA}^6$.\n    -   Test cases with all necessary parameters are provided.\n\n-   **Validation Verdict:**\n    -   **Scientifically Grounded:** The problem uses the standard $r^{-6}$ form for London dispersion forces, a cornerstone of intermolecular interaction theory. The model of a periodic surface and a real-space cutoff sum is a standard technique in computational materials science and surface science (e.g., in DFT+D methods). The problem is scientifically sound.\n    -   **Well-Posed:** The problem provides unambiguous mathematical definitions for all quantities to be computed ($r_{ij}$, $E_{\\mathrm{disp}}(r_c)$) and a clear, objective criterion for convergence ($\\Delta E < \\varepsilon$). All necessary input parameters are provided for each test case, ensuring a unique solution exists.\n    -   **Objective:** The problem is stated in precise, quantitative terms, free of any subjective or ambiguous language.\n\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, objective, and provides a complete and consistent set of information and instructions.\n\n### 2. Solution Methodology\n\nThe solution involves a direct, real-space summation of pairwise interaction energies over a periodic lattice, truncated at a specified cutoff radius $r_c$.\n\n**Principle-Based Design:**\n\nThe fundamental principle is that the long-range dispersion energy between the adsorbate and the entire infinite surface can be approximated by summing the pairwise interactions between the adsorbate and each surface atom up to a certain distance. The sum is given by:\n$$\nE_{\\mathrm{disp}}(r_c) = \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} E_{pair}(r_{ij}) = -C_6 \\sum_{\\substack{i,j \\in \\mathbb{Z} \\\\ r_{ij} \\le r_c}} \\frac{1}{r_{ij}^6}\n$$\nwhere $r_{ij}$ is the distance between the adsorbate at $(x_0, y_0, z_0)$ and the lattice image atom at $(i L_x, j L_y, 0)$. The quality of this approximation depends on the cutoff radius $r_c$; a larger $r_c$ includes more interaction terms and yields a more accurate result.\n\n**Algorithmic Implementation:**\n\nTo perform the summation, we must iterate over the integer indices $(i, j)$. An infinite search is impossible. The problem specifies a safe, finite search domain for the indices: $i \\in [-N_x, N_x]$ and $j \\in [-N_y, N_y]$. The bounds $N_x$ and $N_y$ are chosen to be large enough to encompass the sphere of radius $r_c$ centered at the adsorbate's $(x,y)$ projection. The specified formulae, $N_x = \\lceil r_c / L_x \\rceil + 1$ and $N_y = \\lceil r_c / L_y \\rceil + 1$, provide such a safe bounding box. The additional `+1` term ensures that even for adsorbate positions near a cell boundary, all atoms within the cutoff radius are considered.\n\nFor each test case, the following steps are executed:\n1.  A list of energies, one for each provided cutoff value, is computed.\n2.  To compute the energy $E_{\\mathrm{disp}}(r_c)$ for a single cutoff $r_c$:\n    a. The integer index bounds $N_x$ and $N_y$ are determined from $r_c$, $L_x$, and $L_y$.\n    b. A two-dimensional grid of indices $(i, j)$ is generated over the ranges $[-N_x, N_x]$ and $[-N_y, N_y]$. This is efficiently achieved using `numpy.meshgrid`.\n    c. For each grid point $(i, j)$, the distance $r_{ij}$ is calculated. This is vectorized for performance, computing all distances in a single operation.\n    d. A boolean mask is created to identify which distances satisfy the cutoff condition, $r_{ij} \\le r_c$. A check for $r_{ij} > 0$ is implicitly handled since the problem states $z_0 > 0$, ensuring no division by zero.\n    e. The energy terms $(-C_6 / r_{ij}^6)$ are calculated for the distances that pass the filter.\n    f. These terms are summed to yield the total truncated dispersion energy, $E_{\\mathrm{disp}}(r_c)$.\n3.  After computing the energies for all cutoffs in a test case, the final energy is taken as the one corresponding to the largest cutoff, $r_c^{(n)}$.\n4.  The convergence is assessed by comparing this final energy, $E_{\\mathrm{disp}}(r_c^{(n)})$, with the energy at the second-largest cutoff, $E_{\\mathrm{disp}}(r_c^{(n-1)})$. If $|\\Delta E| < \\varepsilon$, the energy is considered converged. If fewer than two cutoffs are available, convergence is defined as `False`.\n5.  The final result for the test case is a list containing the final energy and the boolean convergence flag.\n\nThis numerical procedure is implemented in Python using the `NumPy` library for its efficient handling of array operations, which is ideal for this grid-based calculation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the dispersion correction energy and checks for convergence\n    for a series of test cases.\n    \"\"\"\n    # Test suite definition as per the problem statement.\n    test_cases = [\n        {\n            \"Lx\": 2.5, \"Ly\": 2.5,\n            \"x0\": 0.0, \"y0\": 0.0, \"z0\": 3.0,\n            \"C6\": 12.0,\n            \"cutoffs\": [6.0, 10.0, 14.0, 20.0],\n            \"epsilon\": 1.0e-5\n        },\n        {\n            \"Lx\": 3.0, \"Ly\": 3.0,\n            \"x0\": 0.0, \"y0\": 0.0, \"z0\": 5.0,\n            \"C6\": 20.0,\n            \"cutoffs\": [3.0, 5.0, 9.0],\n            \"epsilon\": 1.0e-6\n        },\n        {\n            \"Lx\": 4.0, \"Ly\": 3.0,\n            \"x0\": 2.0, \"y0\": 1.5, \"z0\": 2.5,\n            \"C6\": 8.0,\n            \"cutoffs\": [8.0, 16.0, 24.0],\n            \"epsilon\": 1.0e-5\n        },\n        {\n            \"Lx\": 5.0, \"Ly\": 7.0,\n            \"x0\": 1.25, \"y0\": 3.5, \"z0\": 3.5,\n            \"C6\": 15.0,\n            \"cutoffs\": [10.0, 20.0, 30.0, 40.0],\n            \"epsilon\": 1.0e-7\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        Lx, Ly = case[\"Lx\"], case[\"Ly\"]\n        x0, y0, z0 = case[\"x0\"], case[\"y0\"], case[\"z0\"]\n        C6 = case[\"C6\"]\n        cutoffs = case[\"cutoffs\"]\n        epsilon = case[\"epsilon\"]\n\n        energies = []\n        for rc in cutoffs:\n            # Calculate integer index ranges based on the cutoff radius.\n            Nx = int(np.ceil(rc / Lx)) + 1\n            Ny = int(np.ceil(rc / Ly)) + 1\n\n            # Create grids of integer indices i and j.\n            i_vals = np.arange(-Nx, Nx + 1)\n            j_vals = np.arange(-Ny, Ny + 1)\n            i_grid, j_grid = np.meshgrid(i_vals, j_vals)\n\n            # Calculate the positions of the lattice images.\n            x_img = i_grid * Lx\n            y_img = j_grid * Ly\n\n            # Calculate the square of the distance from the adsorbate to each image.\n            # r_ij^2 = (x0 - i*Lx)^2 + (y0 - j*Ly)^2 + z0^2\n            r_sq = (x0 - x_img)**2 + (y0 - y_img)**2 + z0**2\n\n            # Calculate distances, avoiding division by zero by filtering later.\n            # Since z0 > 0, r will never be zero.\n            r = np.sqrt(r_sq)\n\n            # Apply the spherical cutoff condition r_ij <= rc.\n            mask = r <= rc\n            \n            # Since z0 > 0 in all test cases, r is never zero, so checking\n            # r > 0 is not strictly necessary but is good practice.\n            # The calculation 1/r**6 would fail if r=0.\n            relevant_r = r[mask]\n            \n            # Sum the pairwise dispersion energies.\n            if relevant_r.size > 0:\n                energy_sum = -C6 * np.sum(1.0 / relevant_r**6)\n            else:\n                energy_sum = 0.0\n            \n            energies.append(energy_sum)\n\n        is_converged = False\n        final_energy = 0.0\n\n        if len(cutoffs) >= 1:\n            final_energy = energies[-1]\n            if len(cutoffs) >= 2:\n                # Check convergence criterion using the last two cutoffs.\n                delta_E = abs(energies[-1] - energies[-2])\n                if delta_E < epsilon:\n                    is_converged = True\n        \n        # Format result as a list [energy, boolean].\n        all_results.append(f\"[{final_energy},{str(is_converged)}]\")\n\n    # Print the final output in the required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The total adsorption energy is a delicate balance of short-range Pauli repulsion, chemical bonding, and long-range van der Waals attraction. This practice uses a simplified but physically rich model to map the potential energy surface (PES) for an adsorbate on a crystalline surface . By calculating the PES with and without the vdW contribution, you will directly visualize how the long-range attraction modifies the overall energy landscape and its corrugation, a key factor governing surface diffusion barriers.",
            "id": "4261653",
            "problem": "You are asked to design and implement a complete program that constructs a two-dimensional computational grid representing one primitive surface unit cell of copper (Cu) in the $(111)$ orientation and uses it to map the adsorption energy of benzene as a function of lateral registry (i.e., the in-plane position within the unit cell). The goal is to quantify the corrugation amplitude of the adsorption energy landscape with and without van der Waals (vdW) dispersion interactions.\n\nBegin from the following standard, context-appropriate base:\n- The $(111)$ surface of face-centered cubic copper has a two-dimensional triangular lattice. The copper bulk lattice parameter is $a_0 = 3.615 \\ \\mathrm{\\AA}$, and the surface lattice parameter is $a_s = a_0 / \\sqrt{2}$.\n- The primitive real-space lattice vectors for a triangular lattice can be taken as $\\mathbf{a}_1 = a_s (1, 0)$ and $\\mathbf{a}_2 = a_s \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$ in the $(x,y)$ plane.\n- The first star of reciprocal lattice vectors has magnitude $|\\mathbf{G}| = \\frac{4 \\pi}{\\sqrt{3} \\, a_s}$ and directions $\\mathbf{G}_1 = |\\mathbf{G}| (1, 0)$, $\\mathbf{G}_2 = |\\mathbf{G}| \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$, and $\\mathbf{G}_3 = |\\mathbf{G}| \\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)$.\n\nAssume the following physically motivated, simplified energy model for a flat-lying benzene molecule at fixed adsorption height $z$:\n- The lateral corrugation of the adsorption energy originating from the periodic surface potential is represented by the lowest-order Fourier sum,\n$$\nS(\\mathbf{r}) = \\frac{1}{3} \\sum_{i=1}^{3} \\cos(\\mathbf{G}_i \\cdot \\mathbf{r}),\n$$\nand a baseline corrugation energy\n$$\nV_{\\mathrm{corr}}(\\mathbf{r}) = A_0 \\, S(\\mathbf{r}),\n$$\nwhere $A_0$ is an energy amplitude parameter in electronvolts (eV).\n- Short-range Pauli repulsion decays approximately exponentially with the adsorption height and is stronger at registries where electronic overlap is larger. Model this by letting\n$$\nB(\\mathbf{r}) = B_0 \\left(1 + \\beta \\, S(\\mathbf{r})\\right),\n$$\nand\n$$\nV_{\\mathrm{rep}}(z,\\mathbf{r}) = B(\\mathbf{r}) \\, \\exp(-\\alpha \\, z),\n$$\nwhere $B_0$ is an energy scale (in eV), $\\beta$ is a dimensionless lateral modulation factor, and $\\alpha$ is an inverse length parameter (in $\\mathrm{\\AA}^{-1}$).\n- The van der Waals (vdW) dispersion interaction between a molecule and a metallic surface asymptotically scales as $z^{-3}$, which can be modeled as\n$$\nE_{\\mathrm{vdW}}(z) = -\\frac{C_3}{z^3},\n$$\nwhere $C_3$ is an interaction coefficient (in $\\mathrm{eV} \\cdot \\mathrm{\\AA}^3$).\n\nUnder these assumptions, define the total adsorption energy at registry $\\mathbf{r}$ as:\n- Without dispersion,\n$$\nE_{\\mathrm{no\\_vdW}}(\\mathbf{r}) = E_0 + V_{\\mathrm{corr}}(\\mathbf{r}) + V_{\\mathrm{rep}}(z_{\\mathrm{no}},\\mathbf{r}),\n$$\n- With dispersion,\n$$\nE_{\\mathrm{with\\_vdW}}(\\mathbf{r}) = E_0 + V_{\\mathrm{corr}}(\\mathbf{r}) + V_{\\mathrm{rep}}(z_{\\mathrm{with}},\\mathbf{r}) + E_{\\mathrm{vdW}}(z_{\\mathrm{with}}),\n$$\nwhere $E_0$ is a constant reference energy (in eV), and $z_{\\mathrm{no}}$ and $z_{\\mathrm{with}}$ are the fixed adsorption heights (in $\\mathrm{\\AA}$) used for the non-dispersion and dispersion cases, respectively.\n\nYour program must:\n1. Construct a uniform grid of $N_x \\times N_y$ points over one primitive unit cell using fractional coordinates $(u,v)$ with $u \\in [0,1)$ and $v \\in [0,1)$, converted to Cartesian coordinates by $\\mathbf{r}(u,v) = u \\, \\mathbf{a}_1 + v \\, \\mathbf{a}_2$.\n2. Compute $S(\\mathbf{r})$, $V_{\\mathrm{corr}}(\\mathbf{r})$, $V_{\\mathrm{rep}}(z,\\mathbf{r})$, and both $E_{\\mathrm{no\\_vdW}}(\\mathbf{r})$ and $E_{\\mathrm{with\\_vdW}}(\\mathbf{r})$ across the grid.\n3. Quantify the corrugation amplitudes as the energy range over the grid:\n$$\n\\Delta E_{\\mathrm{no}} = \\max_{\\mathbf{r}} E_{\\mathrm{no\\_vdW}}(\\mathbf{r}) - \\min_{\\mathbf{r}} E_{\\mathrm{no\\_vdW}}(\\mathbf{r}),\n$$\n$$\n\\Delta E_{\\mathrm{with}} = \\max_{\\mathbf{r}} E_{\\mathrm{with\\_vdW}}(\\mathbf{r}) - \\min_{\\mathbf{r}} E_{\\mathrm{with\\_vdW}}(\\mathbf{r}).\n$$\nReport also the difference\n$$\n\\Delta E_{\\mathrm{diff}} = \\Delta E_{\\mathrm{with}} - \\Delta E_{\\mathrm{no}}.\n$$\n\nUse the following test suite of parameter sets. For each case, compute and return the three floats $(\\Delta E_{\\mathrm{no}}, \\Delta E_{\\mathrm{with}}, \\Delta E_{\\mathrm{diff}})$, all in electronvolts (eV), rounded to six decimal places:\n- Case 1 (general case with moderate modulation): $N_x = 25$, $N_y = 25$, $A_0 = 0.02 \\ \\mathrm{eV}$, $B_0 = 1.0 \\ \\mathrm{eV}$, $\\beta = 0.5$, $\\alpha = 1.5 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.4 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 3.0 \\ \\mathrm{\\AA}$, $C_3 = 8.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$.\n- Case 2 (boundary case with no short-range modulation): $N_x = 25$, $N_y = 25$, $A_0 = 0.02 \\ \\mathrm{eV}$, $B_0 = 0.0 \\ \\mathrm{eV}$, $\\beta = 0.5$, $\\alpha = 1.5 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.4 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 3.0 \\ \\mathrm{\\AA}$, $C_3 = 8.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$.\n- Case 3 (edge case with coarse grid and stronger parameters): $N_x = 3$, $N_y = 3$, $A_0 = 0.05 \\ \\mathrm{eV}$, $B_0 = 2.0 \\ \\mathrm{eV}$, $\\beta = 0.5$, $\\alpha = 1.8 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.6 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 2.8 \\ \\mathrm{\\AA}$, $C_3 = 12.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$.\n- Case 4 (high lateral modulation sensitivity): $N_x = 64$, $N_y = 64$, $A_0 = 0.01 \\ \\mathrm{eV}$, $B_0 = 1.5 \\ \\mathrm{eV}$, $\\beta = 1.0$, $\\alpha = 1.2 \\ \\mathrm{\\AA}^{-1}$, $z_{\\mathrm{no}} = 3.3 \\ \\mathrm{\\AA}$, $z_{\\mathrm{with}} = 2.7 \\ \\mathrm{\\AA}$, $C_3 = 10.0 \\ \\mathrm{eV} \\cdot \\mathrm{\\AA}^3$, $E_0 = 0.0 \\ \\mathrm{eV}$.\n\nFinal output format: Your program should produce a single line of output containing the results for the four test cases as a comma-separated list of lists, each inner list being the three floats $(\\Delta E_{\\mathrm{no}}, \\Delta E_{\\mathrm{with}}, \\Delta E_{\\mathrm{diff}})$, enclosed in square brackets. For example, a valid output would look like\n$$\n\\texttt{[[x\\_1,y\\_1,z\\_1],[x\\_2,y\\_2,z\\_2],[x\\_3,y\\_3,z\\_3],[x\\_4,y\\_4,z\\_4]]}\n$$\nwhere each $x_i$, $y_i$, and $z_i$ are floats in electronvolts (eV) rounded to six decimal places.",
            "solution": "The user has submitted a problem that is **valid**. It is scientifically grounded in the principles of surface science, well-posed with a clear computational objective, and objectively stated with all necessary parameters and definitions provided. The problem asks for the implementation of a simplified, yet physically motivated, model for the adsorption energy of benzene on a Cu(111) surface, and to use this model to quantify the effect of van der Waals interactions on the potential energy surface corrugation.\n\nThe solution proceeds by first defining the geometry of the system, then constructing the computational grid, evaluating the energy components across this grid, and finally calculating the required corrugation amplitudes.\n\n**1. Geometric and Lattice Definitions**\n\nThe problem specifies a face-centered cubic (fcc) copper crystal with a bulk lattice parameter $a_0 = 3.615 \\ \\mathrm{\\AA}$. The $(111)$ surface forms a two-dimensional triangular lattice. The distance between nearest-neighbor atoms on this surface, which defines the surface lattice parameter $a_s$, is given by $a_s = a_0 / \\sqrt{2}$.\n\nNumerically, $a_s = 3.615 / \\sqrt{2} \\approx 2.556 \\ \\mathrm{\\AA}$.\n\nThe primitive real-space lattice vectors, defining the unit cell in the $(x,y)$ plane, are given as:\n$$\n\\mathbf{a}_1 = a_s (1, 0)\n$$\n$$\n\\mathbf{a}_2 = a_s \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)\n$$\nThe periodic potential of the surface is most naturally described in reciprocal space. The problem provides the first star of reciprocal lattice vectors, which are the shortest non-zero vectors in the reciprocal lattice that respect the threefold symmetry of the surface. Their magnitude is:\n$$\n|\\mathbf{G}| = \\frac{4 \\pi}{\\sqrt{3} \\, a_s}\n$$\nAnd the three vectors are:\n$$\n\\mathbf{G}_1 = |\\mathbf{G}| (1, 0)\n$$\n$$\n\\mathbf{G}_2 = |\\mathbf{G}| \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)\n$$\n$$\n\\mathbf{G}_3 = |\\mathbf{G}| \\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)\n$$\nThese vectors form the basis for the lowest-order Fourier expansion of the surface potential.\n\n**2. Grid Construction**\n\nA uniform computational grid of $N_x \\times N_y$ points is constructed to sample the potential energy within one primitive unit cell. The grid points are generated using fractional coordinates $(u,v)$, where $u \\in [0, 1)$ and $v \\in [0, 1)$. Specifically, we use $u_i = i/N_x$ for $i \\in \\{0, 1, ..., N_x-1\\}$ and $v_j = j/N_y$ for $j \\in \\{0, 1, ..., N_y-1\\}$.\n\nEach point in fractional coordinates $(u,v)$ is mapped to Cartesian coordinates $\\mathbf{r}=(x,y)$ via the linear combination of the real-space lattice vectors:\n$$\n\\mathbf{r}(u,v) = u \\, \\mathbf{a}_1 + v \\, \\mathbf{a}_2 = \\left( u a_s + v \\frac{a_s}{2}, v \\frac{a_s\\sqrt{3}}{2} \\right)\n$$\nThis procedure generates an $N_x \\times N_y$ grid of Cartesian points covering the parallelogram-shaped primitive unit cell.\n\n**3. Energy Evaluation**\n\nAt each grid point $\\mathbf{r}$, the total adsorption energy is computed based on the provided model. The core component is the lateral corrugation function $S(\\mathbf{r})$, defined as a sum over the first star of reciprocal lattice vectors:\n$$\nS(\\mathbf{r}) = \\frac{1}{3} \\sum_{k=1}^{3} \\cos(\\mathbf{G}_k \\cdot \\mathbf{r})\n$$\nThe dot product $\\mathbf{G}_k \\cdot \\mathbf{r}$ for each $k$ is calculated for every grid point. This function $S(\\mathbf{r})$ captures the periodicity and symmetry of the surface potential, with a range from $-0.5$ to $1.0$.\n\nThe total adsorption energy is composed of several terms:\n- A baseline corrugation potential, $V_{\\mathrm{corr}}(\\mathbf{r}) = A_0 \\, S(\\mathbf{r})$.\n- A short-range Pauli repulsive potential, $V_{\\mathrm{rep}}(z,\\mathbf{r}) = B(\\mathbf{r}) \\, \\exp(-\\alpha \\, z)$, where the prefactor $B(\\mathbf{r}) = B_0 (1 + \\beta \\, S(\\mathbf{r}))$ depends on the lateral position to model site-dependent repulsion.\n- A van der Waals (vdW) dispersion attraction, $E_{\\mathrm{vdW}}(z) = -C_3/z^3$.\n- A constant energy offset, $E_0$.\n\nTwo scenarios are considered:\n1.  **Without vdW dispersion:** The adsorption energy is calculated at a fixed height $z_{\\mathrm{no}}$:\n    $$\n    E_{\\mathrm{no\\_vdW}}(\\mathbf{r}) = E_0 + A_0 S(\\mathbf{r}) + B_0(1 + \\beta S(\\mathbf{r})) \\exp(-\\alpha z_{\\mathrm{no}})\n    $$\n2.  **With vdW dispersion:** The energy is calculated at a different fixed height $z_{\\mathrm{with}}$ and includes the vdW term:\n    $$\n    E_{\\mathrm{with\\_vdW}}(\\mathbf{r}) = E_0 + A_0 S(\\mathbf{r}) + B_0(1 + \\beta S(\\mathbf{r})) \\exp(-\\alpha z_{\\mathrm{with}}) - \\frac{C_3}{z_{\\mathrm{with}}^3}\n    $$\n**4. Calculation of Corrugation Amplitudes**\n\nThe corrugation amplitude, $\\Delta E$, is defined as the difference between the maximum and minimum energy values over the entire unit cell grid.\n$$\n\\Delta E = \\max_{\\mathbf{r} \\in \\text{grid}} E(\\mathbf{r}) - \\min_{\\mathbf{r} \\in \\text{grid}} E(\\mathbf{r})\n$$\nWe can simplify the expressions for the energies by collecting terms multiplying $S(\\mathbf{r})$ and constant terms. For a given height $z$, the energy can be written as:\n$$\nE(\\mathbf{r}, z) = \\text{Constant}(z) + \\left[ A_0 + B_0 \\beta \\exp(-\\alpha z) \\right] S(\\mathbf{r})\n$$\nSince $\\Delta E$ is the range of $E(\\mathbf{r},z)$, the constant terms cancel out. The amplitude is therefore:\n$$\n\\Delta E(z) = (\\max_{\\mathbf{r}} S(\\mathbf{r}) - \\min_{\\mathbf{r}} S(\\mathbf{r})) \\times \\left| A_0 + B_0 \\beta \\exp(-\\alpha z) \\right|\n$$\nThis allows us to compute the required quantities:\n$$\n\\Delta E_{\\mathrm{no}} = (\\max S - \\min S) \\times |A_0 + B_0 \\beta \\exp(-\\alpha z_{\\mathrm{no}})|\n$$\n$$\n\\Delta E_{\\mathrm{with}} = (\\max S - \\min S) \\times |A_0 + B_0 \\beta \\exp(-\\alpha z_{\\mathrm{with}})|\n$$\nThe value of $(\\max S - \\min S)$ is determined by finding the maximum and minimum of the computed $S(\\mathbf{r})$ array over the grid for each case. The difference $\\Delta E_{\\mathrm{diff}} = \\Delta E_{\\mathrm{with}} - \\Delta E_{\\mathrm{no}}$ is then calculated directly.\n\nThe programmatic implementation will follow this logic for each parameter set provided in the test suite. The core of the algorithm involves vectorized operations using `numpy` for efficient computation over the 2D grid.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the adsorption energy corrugation amplitude for benzene on Cu(111)\n    with and without van der Waals interactions.\n    \"\"\"\n    \n    # Each tuple contains parameters for a test case:\n    # (Nx, Ny, A0, B0, beta, alpha, z_no, z_with, C3, E0)\n    test_cases = [\n        # Case 1: General case with moderate modulation\n        (25, 25, 0.02, 1.0, 0.5, 1.5, 3.4, 3.0, 8.0, 0.0),\n        # Case 2: Boundary case with no short-range modulation (B0=0)\n        (25, 25, 0.02, 0.0, 0.5, 1.5, 3.4, 3.0, 8.0, 0.0),\n        # Case 3: Edge case with coarse grid and stronger parameters\n        (3, 3, 0.05, 2.0, 0.5, 1.8, 3.6, 2.8, 12.0, 0.0),\n        # Case 4: High lateral modulation sensitivity\n        (64, 64, 0.01, 1.5, 1.0, 1.2, 3.3, 2.7, 10.0, 0.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        Nx, Ny, A0, B0, beta, alpha, z_no, z_with, C3, E0 = case\n\n        # 1. Define Geometry and Constants\n        a0 = 3.615  # Bulk lattice parameter in Angstrom\n        a_s = a0 / np.sqrt(2.0)  # Surface lattice parameter\n\n        # Real-space primitive lattice vectors\n        a1 = a_s * np.array([1.0, 0.0])\n        a2 = a_s * np.array([0.5, np.sqrt(3.0) / 2.0])\n\n        # First star of reciprocal lattice vectors\n        G_mag = 4.0 * np.pi / (np.sqrt(3.0) * a_s)\n        G1 = G_mag * np.array([1.0, 0.0])\n        G2 = G_mag * np.array([-0.5, np.sqrt(3.0) / 2.0])\n        G3 = G_mag * np.array([-0.5, -np.sqrt(3.0) / 2.0])\n\n        # 2. Construct Computational Grid\n        # Fractional coordinates u, v in [0, 1)\n        u_vals = np.linspace(0, 1, Nx, endpoint=False)\n        v_vals = np.linspace(0, 1, Ny, endpoint=False)\n        u_grid, v_grid = np.meshgrid(u_vals, v_vals)\n\n        # Convert fractional coordinates to Cartesian coordinates r = (x, y)\n        # r(u,v) = u * a1 + v * a2\n        r_x = u_grid * a1[0] + v_grid * a2[0]\n        r_y = u_grid * a1[1] + v_grid * a2[1]\n\n        # 3. Compute Surface Corrugation Function S(r)\n        # Calculate dot products G_i . r for the entire grid\n        G1_dot_r = G1[0] * r_x + G1[1] * r_y\n        G2_dot_r = G2[0] * r_x + G2[1] * r_y\n        G3_dot_r = G3[0] * r_x + G3[1] * r_y\n        \n        S_grid = (np.cos(G1_dot_r) + np.cos(G2_dot_r) + np.cos(G3_dot_r)) / 3.0\n\n        # 4. Calculate Total Energies and Corrugation Amplitudes\n        # The total energy E(r) can be simplified as E(r) = C + F * S(r),\n        # where C is a constant offset and F is a factor.\n        # The corrugation amplitude Delta E = max(E) - min(E) is then\n        # |F| * (max(S) - min(S)).\n\n        S_range = np.max(S_grid) - np.min(S_grid)\n        \n        # Case 'no_vdW'\n        # E_no_vdW(r) = E0 + V_corr(r) + V_rep(z_no, r)\n        # The r-dependent part is (A0 + B0 * beta * exp(-alpha * z_no)) * S(r)\n        factor_no_vdw = A0 + B0 * beta * np.exp(-alpha * z_no)\n        delta_E_no = np.abs(factor_no_vdw) * S_range\n\n        # Case 'with_vdW'\n        # E_with_vdW(r) = E0 + V_corr(r) + V_rep(z_with, r) + E_vdW(z_with)\n        # The r-dependent part is (A0 + B0 * beta * exp(-alpha * z_with)) * S(r)\n        factor_with_vdw = A0 + B0 * beta * np.exp(-alpha * z_with)\n        delta_E_with = np.abs(factor_with_vdw) * S_range\n\n        # Difference in corrugation amplitudes\n        delta_E_diff = delta_E_with - delta_E_no\n\n        results.append([round(delta_E_no, 6), round(delta_E_with, 6), round(delta_E_diff, 6)])\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to string and remove spaces for compact output.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "Van der Waals forces are not just a small correction; they can fundamentally alter predictions of chemical reactivity. This exercise explores the impact of vdW interactions on the Brønsted-Evans-Polanyi (BEP) relationship, a key linear scaling law in heterogeneous catalysis . By applying a vdW correction to a model BEP dataset, you will quantify how dispersion can change the predicted reaction barriers and even challenge the linearity of the scaling relation itself, a critical consideration when modeling catalysis for molecules of varying sizes.",
            "id": "4261662",
            "problem": "You are given a physically motivated minimal model to assess how van der Waals (vdW) dispersion corrections perturb Brønsted-Evans-Polanyi (BEP) relationships for surface reactions in computational electrochemistry. The goal is to quantify how the apparent BEP linearity between activation energy and reaction energy changes as a function of adsorbate size and polarizability.\n\nStart from the following well-tested scientific bases:\n\n1) The Brønsted-Evans-Polanyi (BEP) relationship: For a family of reactions on a given catalytic surface, there is a statistically robust linear correlation between the activation barrier and the reaction energy. In a baseline (no-vdW) dataset, the activation energy $E_{\\mathrm{a},0}$ and the reaction energy $\\Delta E_0$ obey the linear relation $E_{\\mathrm{a},0} = a_0 \\,\\Delta E_0 + b_0$, with known slope $a_0$ and intercept $b_0$.\n\n2) London dispersion (vdW) interaction between a polarizable adsorbate and a conducting surface: In a non-retarded regime and in the absence of damping complications, integrating the atom-surface $C_6/R^6$ form over a continuum half-space yields an attractive potential of the form $U(z) = -C_3 / z^3$, where $z$ is the surface-adsorbate separation and $C_3$ is proportional to the adsorbate static polarizability. It is reasonable to model $C_3 = k_{C_3}\\,\\alpha$, where $\\alpha$ is the adsorbate polarizability.\n\n3) Hammond-like structure-reactivity trend: The transition state geometry shifts smoothly between reactant-like and product-like character as a function of the driving force $\\Delta E_0$. A simple proxy is to interpolate the transition-state distance between the initial-state and final-state distances using a sensitivity parameter.\n\nUse the following self-consistent and explicit model definitions and parameter values:\n\n- Baseline BEP parameters: $a_0 = 0.50$ (dimensionless), $b_0 = 0.80$ in $\\mathrm{eV}$.\n- Baseline reaction-energy set (no vdW): $\\Delta E_0 \\in \\{-1.00,-0.60,-0.20,0.00,0.20,0.60,1.00\\}$ in $\\mathrm{eV}$.\n- For each $\\Delta E_0$ above, the corresponding baseline activation energy is $E_{\\mathrm{a},0} = a_0\\,\\Delta E_0 + b_0$ in $\\mathrm{eV}$.\n- vdW model constant: $k_{C_3} = 0.10$ in $\\mathrm{eV}\\,\\text{\\AA}^3$ per $\\text{\\AA}^3$ of polarizability, so that $C_3 = k_{C_3}\\,\\alpha$ in $\\mathrm{eV}\\,\\text{\\AA}^3$.\n- Distance model as a function of adsorbate size $\\sigma$ (in $\\text{\\AA}$):\n  - Initial-state separation: $z_{\\mathrm{IS}} = z_{\\mathrm{base}} + c_{\\sigma}\\,\\sigma$ with $z_{\\mathrm{base}} = 1.80$ in $\\text{\\AA}$ and $c_{\\sigma} = 0.20$ (dimensionless).\n  - Final-state separation: $z_{\\mathrm{FS}} = z_{\\mathrm{IS}} + z_{\\mathrm{shift}}$ with $z_{\\mathrm{shift}} = 0.30$ in $\\text{\\AA}$.\n- Transition-state separation interpolation:\n  - Let $\\Delta E_0^{\\min} = -1.00$ in $\\mathrm{eV}$ and $\\Delta E_0^{\\max} = 1.00$ in $\\mathrm{eV}$. Define the normalized driving force $\\mu = \\dfrac{\\Delta E_0 - (\\Delta E_0^{\\min} + \\Delta E_0^{\\max})/2}{\\Delta E_0^{\\max} - \\Delta E_0^{\\min}} \\in [-1,1]$.\n  - With Hammond sensitivity $s_{\\mathrm{H}} = 0.70$ (dimensionless), set $z_{\\mathrm{TS}}(\\Delta E_0) = z_{\\mathrm{IS}} + s_{\\mathrm{H}}\\,\\mu\\,(z_{\\mathrm{FS}} - z_{\\mathrm{IS}})$ in $\\text{\\AA}$.\n- vdW energy correction for a state at distance $z$: $U(z) = -\\dfrac{C_3}{z^3}$ in $\\mathrm{eV}$.\n- Total energies with vdW for each data point:\n  - Reaction energy: $\\Delta E = \\Delta E_0 + \\left[U\\!\\left(z_{\\mathrm{FS}}\\right) - U\\!\\left(z_{\\mathrm{IS}}\\right)\\right]$ in $\\mathrm{eV}$.\n  - Activation energy: $E_{\\mathrm{a}} = E_{\\mathrm{a},0} + \\left[U\\!\\left(z_{\\mathrm{TS}}(\\Delta E_0)\\right) - U\\!\\left(z_{\\mathrm{IS}}\\right)\\right]$ in $\\mathrm{eV}$.\n\nFor a given adsorbate characterized by size $\\sigma$ in $\\text{\\AA}$ and polarizability $\\alpha$ in $\\text{\\AA}^3$, compute the perturbed dataset $\\{(\\Delta E, E_{\\mathrm{a}})\\}$ across the specified $\\Delta E_0$ values and then perform an ordinary least squares fit of $E_{\\mathrm{a}}$ versus $\\Delta E$ to obtain a best-fit line $E_{\\mathrm{a}} \\approx a\\,\\Delta E + b$. Quantify the vdW impact on the BEP relationship using the following metrics:\n\n- Slope change: $\\Delta a = a - a_0$ (dimensionless).\n- Intercept change: $\\Delta b = b - b_0$ in $\\mathrm{eV}$.\n- Root-mean-square error (RMSE) of the linear fit in $\\mathrm{eV}$: $\\mathrm{RMSE} = \\sqrt{\\dfrac{1}{N}\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - (a\\,\\Delta E_i + b)\\right)^2}$.\n- Coefficient of determination: $R^2 = 1 - \\dfrac{\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - \\hat{E}_{\\mathrm{a},i}\\right)^2}{\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - \\bar{E}_{\\mathrm{a}}\\right)^2}$, where $\\hat{E}_{\\mathrm{a},i} = a\\,\\Delta E_i + b$ and $\\bar{E}_{\\mathrm{a}}$ is the mean of $E_{\\mathrm{a},i}$.\n\nTest suite (each case is a pair $(\\sigma,\\alpha)$ with $\\sigma$ in $\\text{\\AA}$ and $\\alpha$ in $\\text{\\AA}^3$):\n\n1) $(\\sigma,\\alpha) = (2.50, 0.00)$\n2) $(\\sigma,\\alpha) = (1.50, 1.00)$\n3) $(\\sigma,\\alpha) = (2.50, 5.00)$\n4) $(\\sigma,\\alpha) = (3.50, 12.00)$\n5) $(\\sigma,\\alpha) = (4.00, 0.50)$\n6) $(\\sigma,\\alpha) = (4.00, 20.00)$\n\nYour task:\n\n- Implement a program that constructs the perturbed dataset for each test case as specified, fits the linear model $E_{\\mathrm{a}}$ versus $\\Delta E$, and computes the metrics $\\Delta a$, $\\Delta b$, $\\mathrm{RMSE}$, and $R^2$.\n- All energies must be treated in $\\mathrm{eV}$, and all distances must be treated in $\\text{\\AA}$. There are no angles in this problem.\n- For numerical stability and to make grading deterministic, round each reported metric to $6$ decimal places.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- For each test case in the order listed above, output the four rounded floats in the order $[\\Delta a,\\Delta b,\\mathrm{RMSE},R^2]$.\n- Concatenate the outputs for all test cases into a single flat list. For example, the output should look like $[\\Delta a_1,\\Delta b_1,\\mathrm{RMSE}_1,R^2_1,\\Delta a_2,\\Delta b_2,\\mathrm{RMSE}_2,R^2_2,\\dots]$ with each number rounded to $6$ decimal places.",
            "solution": "The user has provided a detailed, self-contained computational problem grounded in the principles of physical chemistry and computational electrochemistry. The task is to implement a specific model to study the effect of van der Waals (vdW) dispersion corrections on Brønsted-Evans-Polanyi (BEP) relationships for surface reactions. The problem statement is validated as scientifically grounded, well-posed, objective, and computationally tractable. No inconsistencies or fallacies were detected. I will now proceed with a complete and reasoned solution.\n\nThe core of the problem is to quantify how a physically-motivated perturbation—the vdW interaction between an adsorbate and a surface—alters an established linear free-energy relationship. The solution involves a two-stage computational process for each adsorbate, which is characterized by its size $\\sigma$ and polarizability $\\alpha$.\n\nFirst, for a given adsorbate, we must generate a new, vdW-perturbed dataset of activation energies ($E_{\\mathrm{a}}$) and reaction energies ($\\Delta E$) from a baseline (unperturbed) dataset. The baseline data consists of a set of reaction energies $\\Delta E_0$ and corresponding activation energies $E_{\\mathrm{a},0}$ which obey the perfect linear BEP relationship $E_{\\mathrm{a},0} = a_0 \\Delta E_0 + b_0$.\n\nThe vdW correction is modeled as an attractive potential $U(z) = -C_3/z^3$, where $z$ is the adsorbate-surface separation. The strength of this interaction is determined by the coefficient $C_3$, which is directly proportional to the adsorbate's static polarizability $\\alpha$ via the constant $k_{C_3}$, i.e., $C_3 = k_{C_3} \\alpha$.\n\nThe separations $z$ for the initial state (IS), final state (FS), and transition state (TS) are defined by a geometric model.\n- The initial state separation, $z_{\\mathrm{IS}}$, increases linearly with adsorbate size $\\sigma$: $z_{\\mathrm{IS}} = z_{\\mathrm{base}} + c_{\\sigma} \\sigma$.\n- The final state separation, $z_{\\mathrm{FS}}$, is a fixed distance further from the surface than the initial state: $z_{\\mathrm{FS}} = z_{\\mathrm{IS}} + z_{\\mathrm{shift}}$.\n- The transition state separation, $z_{\\mathrm{TS}}$, is modeled based on a Hammond-like principle. It interpolates between the reactant-like ($z_{\\mathrm{IS}}$) and product-like ($z_{\\mathrm{FS}}$) geometries. The position of the TS along the reaction coordinate (approximated by the surface-normal distance $z$) depends on the reaction's driving force, $\\Delta E_0$. The problem provides an explicit formula for $z_{\\mathrm{TS}}$ as a function of $\\Delta E_0$:\n$$z_{\\mathrm{TS}}(\\Delta E_0) = z_{\\mathrm{IS}} + s_{\\mathrm{H}}\\,\\mu\\,(z_{\\mathrm{FS}} - z_{\\mathrm{IS}})$$\nwhere $\\mu$ is a normalized reaction energy, $\\mu = \\frac{\\Delta E_0 - (\\Delta E_0^{\\min} + \\Delta E_0^{\\max})/2}{\\Delta E_0^{\\max} - \\Delta E_0^{\\min}}$, and $s_{\\mathrm{H}}$ is the Hammond sensitivity parameter.\n\nWith these definitions, the vdW energy correction for any state (IS, TS, or FS) at separation $z$ is $U(z)$. The total, vdW-perturbed energies for each point in the dataset are then calculated by adding the relevant vdW energy differences to the baseline energies:\n- The perturbed reaction energy is $\\Delta E = \\Delta E_0 + [U(z_{\\mathrm{FS}}) - U(z_{\\mathrm{IS}})]$. The term in brackets is the change in vdW stabilization from the initial state to the final state.\n- The perturbed activation energy is $E_{\\mathrm{a}} = E_{\\mathrm{a},0} + [U(z_{\\mathrm{TS}}) - U(z_{\\mathrm{IS}})]$. The term in brackets is the change in vdW stabilization from the initial state to the transition state.\n\nThis procedure is repeated for every baseline reaction energy $\\Delta E_0$ in the provided set $\\{-1.00, -0.60, -0.20, 0.00, 0.20, 0.60, 1.00\\}$ eV, yielding a new dataset of $N=7$ pairs, $\\{(\\Delta E_i, E_{\\mathrm{a},i})\\}_{i=1}^N$.\n\nThe second stage of the process is to analyze this new dataset. Since the vdW correction for the activation energy, $U(z_{\\mathrm{TS}})$, depends non-linearly on $\\Delta E_0$ (and thus on $\\Delta E$), the new dataset will not, in general, lie on a perfect line. We perform an ordinary least squares (OLS) linear regression to find the best-fit line $E_{\\mathrm{a}} \\approx a \\Delta E + b$. The OLS regression coefficients $a$ (slope) and $b$ (intercept) are calculated using the standard formulas:\n$$a = \\frac{N \\sum (\\Delta E_i E_{\\mathrm{a},i}) - (\\sum \\Delta E_i)(\\sum E_{\\mathrm{a},i})}{N \\sum (\\Delta E_i^2) - (\\sum \\Delta E_i)^2}$$\n$$b = \\bar{E}_{\\mathrm{a}} - a \\bar{\\Delta E}$$\nwhere $\\bar{E}_{\\mathrm{a}}$ and $\\bar{\\Delta E}$ are the sample means of the respective variables.\n\nFinally, we compute four metrics to quantify the impact of the vdW corrections on the BEP relationship for the given adsorbate:\n1.  Slope change: $\\Delta a = a - a_0$.\n2.  Intercept change: $\\Delta b = b - b_0$.\n3.  Root-Mean-Square Error (RMSE) of the fit: This measures the typical deviation of the data points from the fitted line.\n    $$\\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(E_{\\mathrm{a},i} - (a\\Delta E_i + b)\\right)^2}$$\n4.  Coefficient of Determination ($R^2$): This measures the proportion of the variance in the dependent variable ($E_{\\mathrm{a}}$) that is predictable from the independent variable ($\\Delta E$).\n    $$R^2 = 1 - \\frac{\\sum_{i=1}^{N}(E_{\\mathrm{a},i} - \\hat{E}_{\\mathrm{a},i})^2}{\\sum_{i=1}^{N}(E_{\\mathrm{a},i} - \\bar{E}_{\\mathrm{a}})^2}$$\n    where $\\hat{E}_{\\mathrm{a},i} = a\\Delta E_i + b$ are the predicted values from the linear model.\n\nThis entire procedure is implemented for each $(\\sigma, \\alpha)$ pair specified in the test suite, and the resulting four metrics are collected and formatted as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes vdW-perturbed BEP metrics for a series of adsorbates.\n    \"\"\"\n\n    # --- Problem Constants and Definitions ---\n    # Baseline BEP parameters\n    A0 = 0.50  # dimensionless\n    B0 = 0.80  # eV\n\n    # Baseline reaction-energy set (no vdW)\n    DELTA_E0_SET = np.array([-1.00, -0.60, -0.20, 0.00, 0.20, 0.60, 1.00])  # eV\n\n    # vdW model constant\n    K_C3 = 0.10  # eV*A^3 / A^3 of polarizability\n\n    # Distance model constants\n    Z_BASE = 1.80  # Angstrom\n    C_SIGMA = 0.20  # dimensionless\n    Z_SHIFT = 0.30  # Angstrom\n\n    # Transition-state interpolation constants\n    DELTA_E0_MIN = -1.00  # eV\n    DELTA_E0_MAX = 1.00  # eV\n    S_H = 0.70  # Hammond sensitivity, dimensionless\n    \n    # Test suite: list of (sigma in Angstrom, alpha in Angstrom^3)\n    test_cases = [\n        (2.50, 0.00),\n        (1.50, 1.00),\n        (2.50, 5.00),\n        (3.50, 12.00),\n        (4.00, 0.50),\n        (4.00, 20.00),\n    ]\n\n    all_results = []\n\n    for sigma, alpha in test_cases:\n        # --- Stage 1: Generate vdW-perturbed dataset ---\n        \n        # Calculate adsorbate-specific parameters\n        c3 = K_C3 * alpha\n        z_is = Z_BASE + C_SIGMA * sigma\n        z_fs = z_is + Z_SHIFT\n\n        # Calculate vdW energy corrections for IS and FS\n        # Handle c3=0 case to avoid division by zero if z=0 (not possible here, but good practice)\n        u_is = -c3 / z_is**3 if c3 != 0 else 0.0\n        u_fs = -c3 / z_fs**3 if c3 != 0 else 0.0\n        \n        # Calculate vdW correction to reaction energy (constant for all points in a case)\n        delta_u_rxn = u_fs - u_is\n\n        # Perturbed reaction energies\n        delta_e_perturbed = DELTA_E0_SET + delta_u_rxn\n\n        # Calculate perturbed activation energies for each point\n        e_a_perturbed = []\n        for dE0 in DELTA_E0_SET:\n            # Baseline activation energy\n            e_a0 = A0 * dE0 + B0\n\n            # Normalized driving force\n            mu_numerator = dE0 - (DELTA_E0_MIN + DELTA_E0_MAX) / 2\n            mu_denominator = DELTA_E0_MAX - DELTA_E0_MIN\n            mu = mu_numerator / mu_denominator\n            \n            # Transition-state separation\n            z_ts = z_is + S_H * mu * (z_fs - z_is)\n\n            # vdW energy correction for TS\n            u_ts = -c3 / z_ts**3 if c3 != 0 else 0.0\n\n            # vdW correction to activation energy\n            delta_u_act = u_ts - u_is\n\n            # Total perturbed activation energy\n            e_a_perturbed.append(e_a0 + delta_u_act)\n\n        e_a_perturbed = np.array(e_a_perturbed)\n\n        # --- Stage 2: Linear Regression and Metrics ---\n\n        if alpha == 0.0:\n            # For alpha=0, c3=0, all corrections are zero.\n            # The fit is perfect and identical to the baseline.\n            a_fit, b_fit = A0, B0\n            rmse, r2 = 0.0, 1.0\n        else:\n            x_data = delta_e_perturbed\n            y_data = e_a_perturbed\n            n = len(x_data)\n\n            # OLS linear regression: y = a*x + b\n            sum_x, sum_y = np.sum(x_data), np.sum(y_data)\n            sum_xy, sum_x2 = np.sum(x_data * y_data), np.sum(x_data**2)\n\n            a_fit = (n * sum_xy - sum_x * sum_y) / (n * sum_x2 - sum_x**2)\n            b_fit = (sum_y - a_fit * sum_x) / n\n\n            # Calculate metrics\n            y_pred = a_fit * x_data + b_fit\n            residuals = y_data - y_pred\n            \n            rmse = np.sqrt(np.mean(residuals**2))\n            \n            ss_res = np.sum(residuals**2)\n            ss_tot = np.sum((y_data - np.mean(y_data))**2)\n            \n            # Handle case where all y values are the same to avoid division by zero\n            r2 = 1.0 - (ss_res / ss_tot) if ss_tot > 0 else 1.0\n\n        # Calculate change from baseline\n        delta_a = a_fit - A0\n        delta_b = b_fit - B0\n\n        # Append results for this case, rounded to 6 decimal places\n        all_results.extend([delta_a, delta_b, rmse, r2])\n\n    # --- Final Output Formatting ---\n    # Use format specifier to ensure 6 decimal places, e.g., 1.0 -> 1.000000\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}