{
    "hands_on_practices": [
        {
            "introduction": "力场参数化的核心在于精确描述粒子间的相互作用。本练习将从最基本的 Lennard-Jones (LJ) 势能入手，运用标准的 Lorentz-Berthelot 混合规则来计算离子与水分子之间的初始非键相互作用参数。通过这个计算，您将亲身体会到，通用混合规则得到的参数往往需要进一步修正才能精确再现实验中的结构特性，例如离子-氧的接触距离，这正是引入如 NBFIX 等特定校正方法的根本原因 。",
            "id": "4246428",
            "problem": "您正在对经典 Lennard-Jones (LJ) 12-6 描述下的单价阳离子 $i$ 与一个简单的三点水模型的氧原子位点 $j$ 之间的非键相互作用进行参数化。LJ 势定义为 $V_{ij}(r) = 4 \\varepsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$，其中 $r$ 是分离距离，$\\sigma_{ij}$ 是混合直径，$\\varepsilon_{ij}$ 是混合势阱深度。该离子的参数为 $\\sigma_i = 0.220 \\ \\mathrm{nm}$ 和 $\\varepsilon_i = 0.500 \\ \\mathrm{kJ \\ mol^{-1}}$，水分子的氧原子参数为 $\\sigma_j = 0.315 \\ \\mathrm{nm}$ 和 $\\varepsilon_j = 0.650 \\ \\mathrm{kJ \\ mol^{-1}}$。使用 Lorentz–Berthelot 组合规则来获得混合参数 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$。然后，为了在 LJ 势的最小值点强制实现一个目标离子-氧接触距离 $r^{\\ast} = 0.240 \\ \\mathrm{nm}$，请提出一个非键参数覆盖 (NBFIX) 校正，该校正仅修改混合直径而保持混合势阱深度不变；也就是说，选择 $\\sigma_{ij}^{\\mathrm{NBFIX}}$ 使得 LJ 势的最小值点位置等于 $r^{\\ast}$，并设置 $\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij}$。计算并按 $\\sigma_{ij}$、$\\varepsilon_{ij}$、$\\sigma_{ij}^{\\mathrm{NBFIX}}$、$\\varepsilon_{ij}^{\\mathrm{NBFIX}}$ 的顺序报告这四个量。将每个量四舍五入到四位有效数字。$\\sigma$ 值以 $\\mathrm{nm}$ 为单位，$\\varepsilon$ 值以 $\\mathrm{kJ \\ mol^{-1}}$ 为单位表示。",
            "solution": "该问题要求确定描述单价阳离子 $i$ 和水氧原子位点 $j$ 之间非键相互作用的 Lennard-Jones (LJ) 势的相互作用参数。分析分两个阶段进行：首先，应用标准组合规则；其次，应用一个特定的校正 (NBFIX) 以匹配一个实验目标值。\n\nLennard-Jones 势给出如下：\n$$V_{ij}(r) = 4 \\varepsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$$\n各个位点的参数如下：\n离子 $i$：$\\sigma_i = 0.220 \\ \\mathrm{nm}$，$\\varepsilon_i = 0.500 \\ \\mathrm{kJ \\ mol^{-1}}$\n水的氧原子 $j$：$\\sigma_j = 0.315 \\ \\mathrm{nm}$，$\\varepsilon_j = 0.650 \\ \\mathrm{kJ \\ mol^{-1}}$\n\n首先，我们使用 Lorentz–Berthelot 组合规则计算混合相互作用参数 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$。Lorentz 规则（直径的算术平均）是：\n$$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}$$\n代入给定值：\n$$\\sigma_{ij} = \\frac{0.220 \\ \\mathrm{nm} + 0.315 \\ \\mathrm{nm}}{2} = \\frac{0.535 \\ \\mathrm{nm}}{2} = 0.2675 \\ \\mathrm{nm}$$\nBerthelot 规则（势阱深度的几何平均）是：\n$$\\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}$$\n代入给定值：\n$$\\varepsilon_{ij} = \\sqrt{(0.500 \\ \\mathrm{kJ \\ mol^{-1}}) \\times (0.650 \\ \\mathrm{kJ \\ mol^{-1}})} = \\sqrt{0.325} \\ \\mathrm{kJ \\ mol^{-1}}$$\n计算数值：\n$$\\varepsilon_{ij} \\approx 0.5700877... \\ \\mathrm{kJ \\ mol^{-1}}$$\n\n接下来，我们处理非键参数覆盖 (NBFIX) 校正。该校正旨在调整参数，以在 LJ 势的最小值点强制实现一个目标离子-氧接触距离 $r^{\\ast} = 0.240 \\ \\mathrm{nm}$。我们必须找到实现此目标的新参数 $\\sigma_{ij}^{\\mathrm{NBFIX}}$，同时保持势阱深度不变，即 $\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij}$。\n\n为此，我们必须首先找到 LJ 势达到其最小值时的距离 $r_{min}$ 的一般表达式。这可以通过求 $V_{ij}(r)$ 对 $r$ 的一阶导数并令其为零来找到。\n$$\\frac{dV_{ij}}{dr} = \\frac{d}{dr} \\left[ 4 \\varepsilon_{ij} \\left( \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6} \\right) \\right] = 4 \\varepsilon_{ij} \\left[ \\sigma_{ij}^{12}(-12r^{-13}) - \\sigma_{ij}^{6}(-6r^{-7}) \\right]$$\n当 $r \\neq 0$ 时，令导数为零：\n$$4 \\varepsilon_{ij} \\left[ -12 \\frac{\\sigma_{ij}^{12}}{r^{13}} + 6 \\frac{\\sigma_{ij}^{6}}{r^{7}} \\right] = 0$$\n由于 $4\\varepsilon_{ij} \\neq 0$，括号中的项必须为零：\n$$6 \\frac{\\sigma_{ij}^{6}}{r^{7}} = 12 \\frac{\\sigma_{ij}^{12}}{r^{13}}$$\n$$r^6 = 2 \\sigma_{ij}^{6}$$\n求解 $r$，我们得到势能最小值的位置：\n$$r_{min} = 2^{1/6} \\sigma_{ij}$$\nNBFIX 校正要求对于由 $\\sigma_{ij}^{\\mathrm{NBFIX}}$ 定义的势，该最小值位于 $r^{\\ast} = 0.240 \\ \\mathrm{nm}$ 处。因此：\n$$r^{\\ast} = 2^{1/6} \\sigma_{ij}^{\\mathrm{NBFIX}}$$\n我们求解 $\\sigma_{ij}^{\\mathrm{NBFIX}}$：\n$$\\sigma_{ij}^{\\mathrm{NBFIX}} = \\frac{r^{\\ast}}{2^{1/6}} = \\frac{0.240 \\ \\mathrm{nm}}{2^{1/6}}$$\n计算数值：\n$$\\sigma_{ij}^{\\mathrm{NBFIX}} \\approx \\frac{0.240 \\ \\mathrm{nm}}{1.122462...} \\approx 0.213810... \\ \\mathrm{nm}$$\n如指定的那样，势阱深度不被此次覆盖修改：\n$$\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij} = \\sqrt{0.325} \\ \\mathrm{kJ \\ mol^{-1}} \\approx 0.5700877... \\ \\mathrm{kJ \\ mol^{-1}}$$\n\n最后，我们报告所需的四个量，四舍五入到四位有效数字：\n1.  $\\sigma_{ij} = 0.2675 \\ \\mathrm{nm}$\n2.  $\\varepsilon_{ij} \\approx 0.5701 \\ \\mathrm{kJ \\ mol^{-1}}$\n3.  $\\sigma_{ij}^{\\mathrm{NBFIX}} \\approx 0.2138 \\ \\mathrm{nm}$\n4.  $\\varepsilon_{ij}^{\\mathrm{NBFIX}} = \\varepsilon_{ij} \\approx 0.5701 \\ \\mathrm{kJ \\ mol^{-1}}$\n\n按要求的顺序（$\\sigma_{ij}$、$\\varepsilon_{ij}$、$\\sigma_{ij}^{\\mathrm{NBFIX}}$、$\\varepsilon_{ij}^{\\mathrm{NBFIX}}$），这四个量是 $0.2675$、$0.5701$、$0.2138$ 和 $0.5701$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2675 & 0.5701 & 0.2138 & 0.5701 \\end{pmatrix}}$$"
        },
        {
            "introduction": "力场参数并非孤立存在，而是与模型的其它部分（尤其是溶剂模型）紧密关联。本练习旨在揭示参数的“模型依赖性”：为一个水模型（如 TIP3P）优化的离子参数，在另一个水模型（如 SPC/E）中可能无法得到相同的结果。通过计算在不同水模型下为达到相同的离子-氧径向分布函数峰位所需的离子 LJ 尺寸参数变化，您将深入理解力场参数的不可转移性，以及在参数化过程中保持模型一致性的重要性 。",
            "id": "4246433",
            "problem": "一个单价阳离子需要针对三种刚性不可极化水模型进行参数化：三点可转移分子间势 (TIP3P)、扩展简单点电荷 (SPC/E) 和 四点可转移分子间势2005年修订版 (TIP4P/2005)。离子-氧非键相互作用通过使用 Lorentz-Berthelot 混合规则的 Lennard-Jones 势进行建模。具体而言，离子 ($I$) 和水氧位点 ($O$) 之间的交叉相互作用为\n$$\nU_{IO}(r)=4\\,\\varepsilon_{IO}\\left[\\left(\\frac{\\sigma_{IO}}{r}\\right)^{12}-\\left(\\frac{\\sigma_{IO}}{r}\\right)^{6}\\right],\n$$\n其中\n$$\n\\sigma_{IO}=\\frac{\\sigma_{I}+\\sigma_{O}}{2},\\qquad \\varepsilon_{IO}=\\sqrt{\\varepsilon_{I}\\,\\varepsilon_{O}}.\n$$\n假设对于所有三种模型，块体水的数密度均相同，并且对于液态水中的该单价阳离子，静电贡献不会使离子-氧径向分布函数的第一个最大值位置相对于离子-氧对的 Lennard-Jones 势的最小值发生偏移。再进一步假设，在所采用的参数化方案中，匹配第一个峰值位置 $r^{\\star}$ 会唯一地确定水合数 $n^{\\star}$，因为控制 $n$ 的第一水合层半径与 $r^{\\star}$ 成正比，且比例系数与模型无关。\n\n给定每种模型的水-氧 Lennard-Jones 尺寸参数：对于 TIP3P，$\\sigma_{O}^{\\mathrm{TIP3P}}=3.1506$ Å；对于 SPC/E，$\\sigma_{O}^{\\mathrm{SPCE}}=3.1660$ Å；以及对于 TIP4P/2005，$\\sigma_{O}^{\\mathrm{T4P2005}}=3.1589$ Å。你的目标是在所有三种模型中都得到相同的离子-氧径向分布函数第一峰值位置 $r^{\\star}=2.800$ Å 和水合数 $n^{\\star}$。\n\n仅使用以上信息和所述假设，确定为了匹配相同的 $r^{\\star}$（并因此得到相同的 $n^{\\star}$），SPC/E 和 TIP4P/2005 模型相对于 TIP3P 模型所需的离子 Lennard–Jones 尺寸参数 $\\Delta\\sigma_{I}$ 的变化。以双分量行向量 $\\left[\\Delta\\sigma_{I}^{\\mathrm{SPCE}},\\,\\Delta\\sigma_{I}^{\\mathrm{T4P2005}}\\right]$ 的形式报告你的答案，单位为 Å，并四舍五入至四位有效数字。",
            "solution": "该问题要求确定当一个单价阳离子针对两种不同的水模型（SPC/E 和 TIP4P/2005）相对于参考模型（TIP3P）进行参数化时，Lennard-Jones (LJ) 尺寸参数 $\\sigma_{I}$ 的变化量。核心约束是，离子-氧径向分布函数的第一个峰值位置 $r^{\\star}$ 在所有三种模型中必须相同。\n\n问题陈述了一个关键假设：离子-氧径向分布函数的第一个最大值位置 $r^{\\star}$ 与离子-氧对的 Lennard-Jones 势 $U_{IO}(r)$ 的最小值位置重合。该势由下式给出：\n$$\nU_{IO}(r)=4\\,\\varepsilon_{IO}\\left[\\left(\\frac{\\sigma_{IO}}{r}\\right)^{12}-\\left(\\frac{\\sigma_{IO}}{r}\\right)^{6}\\right]\n$$\n为了找到最小值的位置 $r_{min}$，我们必须找到势对 $r$ 的一阶导数为零时的 $r$ 值。\n$$\n\\frac{dU_{IO}(r)}{dr} = 4\\varepsilon_{IO} \\frac{d}{dr} \\left[ \\sigma_{IO}^{12}r^{-12} - \\sigma_{IO}^{6}r^{-6} \\right]\n$$\n$$\n\\frac{dU_{IO}(r)}{dr} = 4\\varepsilon_{IO} \\left[ -12\\sigma_{IO}^{12}r^{-13} + 6\\sigma_{IO}^{6}r^{-7} \\right]\n$$\n将导数设为零以求最小值：\n$$\n4\\varepsilon_{IO} \\left[ -12\\sigma_{IO}^{12}r^{-13} + 6\\sigma_{IO}^{6}r^{-7} \\right] = 0\n$$\n假设 $\\varepsilon_{IO} \\neq 0$ 且 $r \\neq 0$，我们可以简化为：\n$$\n6\\sigma_{IO}^{6}r^{-7} = 12\\sigma_{IO}^{12}r^{-13}\n$$\n$$\nr^{6} = \\frac{12\\sigma_{IO}^{12}}{6\\sigma_{IO}^{6}} = 2\\sigma_{IO}^{6}\n$$\n对两边取六次方根，得到势的最小值位置：\n$$\nr_{min} = 2^{1/6}\\sigma_{IO}\n$$\n根据问题的核心假设，$r^{\\star} = r_{min}$。因此，我们有如下关系：\n$$\nr^{\\star} = 2^{1/6}\\sigma_{IO}\n$$\n问题使用了 Lorentz-Berthelot 混合规则，其中 $\\sigma_{IO} = \\frac{\\sigma_{I}+\\sigma_{O}}{2}$。将此代入 $r^{\\star}$ 的方程中：\n$$\nr^{\\star} = 2^{1/6} \\left(\\frac{\\sigma_{I} + \\sigma_{O}}{2}\\right)\n$$\n我们需要找到对于每个水模型，为达到目标峰值位置 $r^{\\star}$ 所需的离子尺寸参数 $\\sigma_{I}$。让我们求解 $\\sigma_{I}$：\n$$\n\\frac{2r^{\\star}}{2^{1/6}} = \\sigma_{I} + \\sigma_{O}\n$$\n$$\n\\sigma_{I} = \\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}\n$$\n该方程对每个水模型 $M \\in \\{\\text{TIP3P, SPCE, T4P2005}\\}$ 都成立。设 $\\sigma_I^M$ 和 $\\sigma_O^M$ 为特定模型 $M$ 的参数。目标 $r^{\\star}$ 对所有模型都是常数。\n$$\n\\sigma_{I}^{M} = \\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{M}\n$$\n我们被要求计算 SPC/E 和 TIP4P/2005 相对于 TIP3P 的离子尺寸参数变化。这个变化表示为 $\\Delta\\sigma_{I}^{M} = \\sigma_{I}^{M} - \\sigma_{I}^{\\mathrm{TIP3P}}$。\n\n对于 SPC/E 模型，变化量为：\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPCE}} = \\sigma_{I}^{\\mathrm{SPCE}} - \\sigma_{I}^{\\mathrm{TIP3P}}\n$$\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPCE}} = \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{SPCE}}\\right) - \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{TIP3P}}\\right)\n$$\n包含 $r^{\\star}$ 的项相互抵消：\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPCE}} = \\sigma_{O}^{\\mathrm{TIP3P}} - \\sigma_{O}^{\\mathrm{SPCE}}\n$$\n使用给定值：$\\sigma_{O}^{\\mathrm{TIP3P}}=3.1506$ Å 和 $\\sigma_{O}^{\\mathrm{SPCE}}=3.1660$ Å。\n$$\n\\Delta\\sigma_{I}^{\\mathrm{SPCE}} = 3.1506 - 3.1660 = -0.0154 \\text{ Å}\n$$\n类似地，对于 TIP4P/2005 模型，变化量为：\n$$\n\\Delta\\sigma_{I}^{\\mathrm{T4P2005}} = \\sigma_{I}^{\\mathrm{T4P2005}} - \\sigma_{I}^{\\mathrm{TIP3P}}\n$$\n$$\n\\Delta\\sigma_{I}^{\\mathrm{T4P2005}} = \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{T4P2005}}\\right) - \\left(\\frac{2r^{\\star}}{2^{1/6}} - \\sigma_{O}^{\\mathrm{TIP3P}}\\right)\n$$\n$$\n\\Delta\\sigma_{I}^{\\mathrm{T4P2005}} = \\sigma_{O}^{\\mathrm{TIP3P}} - \\sigma_{O}^{\\mathrm{T4P2005}}\n$$\n使用给定值：$\\sigma_{O}^{\\mathrm{TIP3P}}=3.1506$ Å 和 $\\sigma_{O}^{\\mathrm{T4P2005}}=3.1589$ Å。\n$$\n\\Delta\\sigma_{I}^{\\mathrm{T4P2005}} = 3.1506 - 3.1589 = -0.0083 \\text{ Å}\n$$\n问题要求结果四舍五入到四位有效数字。\n- 对于 SPC/E，$\\Delta\\sigma_{I}^{\\mathrm{SPCE}} = -0.0154$ Å。为了用四位有效数字表示，我们写作 $-0.01540$ Å。\n- 对于 TIP4P/2005，$\\Delta\\sigma_{I}^{\\mathrm{T4P2005}} = -0.0083$ Å。为了用四位有效数字表示，我们写作 $-0.008300$ Å。\n\n最终答案应以双分量行向量 $\\left[\\Delta\\sigma_{I}^{\\mathrm{SPCE}},\\,\\Delta\\sigma_{I}^{\\mathrm{T4P2005}}\\right]$ 的形式呈现。\n该向量为 $\\begin{pmatrix} -0.01540 & -0.008300 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.01540 & -0.008300 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实的力场参数化过程往往是一个多目标的优化问题，需要在多种物理性质的准确性之间做出权衡。本练习将引导您超越单一性质的拟合，通过构建一个简化的理论模型来量化结构准确性（离子-氧距离）与能量准确性（水合自由能）之间的平衡。您将通过计算一个综合性的“权衡度量”$E$，学会如何评估一组参数在同时满足不同实验目标时的整体表现，这是现代力场开发中的一个核心思想 。",
            "id": "4246415",
            "problem": "您的任务是构建一个基于基本原理的最小模型，以评估范德华参数和电荷缩放如何共同影响水合自由能的再现，同时在计算电化学中保持准确的离子-氧结构度量。在环境条件下，使用体相水中的逐对离子-氧相互作用模型，该模型基于以下基本且经过充分检验的公式。\n\n首先，总的离子-氧对势 $U(r)$ 被建模为 Lennard–Jones 项和屏蔽库仑项之和：\n$$\nU(r) \\;=\\; 4\\,\\epsilon_{\\mathrm{LJ}} \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] \\;-\\; \\frac{k_c\\,s\\,z\\,q_O}{\\varepsilon_r\\,r}\n$$\n其中 $r$ 是以 $\\mathrm{nm}$ 为单位的离子-氧间距，$\\epsilon_{\\mathrm{LJ}}$ 和 $\\sigma$ 分别是以 $\\mathrm{kJ\\,mol^{-1}}$ 和 $\\mathrm{nm}$ 为单位的 Lennard–Jones 参数，$z$ 是离子价态（无单位），$s$ 是应用于离子电荷的无量纲电荷缩放因子，$q_O$ 是以基本电荷 $\\mathrm{e}$ 为单位的水氧部分电荷的大小，$\\varepsilon_r$ 是水的相对介电常数，$k_c$ 是以模拟单位表示的库仑常数。屏蔽库仑相互作用是由水的宏观介电响应来证明其合理性的。\n\n使用 Born 连续介质静电学近似，从有效半径估算水合自由能：\n$$\n\\Delta G_{\\mathrm{hyd}}^{\\mathrm{model}} \\;=\\; -\\frac{1}{2}\\,k_c\\,\\frac{(s\\,z)^2}{r_{\\mathrm{eff}}}\\,\\left(1 - \\frac{1}{\\varepsilon_r}\\right)\n$$\n单位为 $\\mathrm{kJ\\,mol^{-1}}$，其中 $r_{\\mathrm{eff}}$ 是用于溶剂化的有效离子半径。在此简化评估中，用 $U(r)$ 最小值处的离子-氧间距来近似 $r_{\\mathrm{eff}}$：\n$$\nr_{\\mathrm{eff}} \\;\\equiv\\; r^\\* \\;=\\; \\operatorname*{arg\\,min}_{r \\in [0.15,\\,0.50]\\,\\mathrm{nm}} U(r)\n$$\n这个选择通过势能最小值的位置，将范德华参数与结构度量耦合起来。\n\n定义一个无量纲的权衡度量，用以平衡水合自由能的准确性与结构保真度：\n$$\nE \\;=\\; \\sqrt{ \\left(\\frac{\\Delta G_{\\mathrm{hyd}}^{\\mathrm{model}} - \\Delta G_{\\mathrm{hyd}}^{\\mathrm{ref}}}{\\Delta G_{\\mathrm{tol}}}\\right)^2 \\;+\\; \\left(\\frac{r^\\* - r_{\\mathrm{ref}}}{r_{\\mathrm{tol}}}\\right)^2 }\n$$\n其中 $\\Delta G_{\\mathrm{hyd}}^{\\mathrm{ref}}$ 是以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的目标参考水合自由能，$r_{\\mathrm{ref}}$ 是以 $\\mathrm{nm}$ 为单位的目标离子-氧间距（例如，第一壳层结构度量），而 $\\Delta G_{\\mathrm{tol}}$ 和 $r_{\\mathrm{tol}}$ 是设定能量与结构相对权重的容差。较小的 $E$ 值表示更好的权衡。\n\n使用的常量和固定输入：\n- $k_c = 138.935456\\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$，\n- $q_O = 0.847\\,\\mathrm{e}$，\n- $\\varepsilon_r = 78.4$（环境条件下）。\n\n对于下面的每个测试用例，计算以 $\\mathrm{nm}$ 为单位的 $r^\\*$，以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 $\\Delta G_{\\mathrm{hyd}}^{\\mathrm{model}}$，以及定义的无量纲权衡度量 $E$。您的程序必须只输出所有测试用例的 $E$ 值列表，四舍五入到小数点后 $3$ 位，以单行逗号分隔列表的形式，并用方括号括起来。\n\n测试套件（每个元组为 $(z, \\Delta G_{\\mathrm{hyd}}^{\\mathrm{ref}}, r_{\\mathrm{ref}}, \\epsilon_{\\mathrm{LJ}}, \\sigma, s, \\Delta G_{\\mathrm{tol}}, r_{\\mathrm{tol}})$）：\n- 用例 $1$（单价，中等电荷缩放）：$(+1, -365.0, 0.240, 0.300, 0.255, 0.85, 15.0, 0.010)$，\n- 用例 $2$（单价，全电荷，较大的 $\\sigma$）：$(+1, -295.0, 0.275, 0.200, 0.295, 1.00, 15.0, 0.015)$，\n- 用例 $3$（二价，减小电荷缩放）：$(+2, -1600.0, 0.235, 0.450, 0.245, 0.75, 30.0, 0.010)$，\n- 用例 $4$（边界情况，无静电作用）：$(+1, -365.0, 0.240, 0.100, 0.240, 0.00, 15.0, 0.010)$。\n\n科学和数值要求：\n- 所有能量必须以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位计算和报告。\n- 所有距离必须以 $\\mathrm{nm}$ 为单位计算和报告。\n- $U(r)$ 的最小化必须在闭区间 $[0.15, 0.50]\\,\\mathrm{nm}$ 上进行。\n- 您的程序应生成单行输出，其中包含以逗号分隔的列表形式的结果，并用方括号括起来（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$），其中每个 $\\text{result}_i$ 是四舍五入到小数点后 $3$ 位的无量纲 $E$ 值。",
            "solution": "该问题的目标是为四个独立的测试用例计算一个权衡度量 $E$。此度量评估了一组给定的力场参数 $(\\epsilon_{\\mathrm{LJ}}, \\sigma, s)$ 在同时再现一个目标水合自由能和一个目标结构（离子-氧距离）方面的表现。计算过程遵循以下步骤：\n\n1.  **构建势能函数**：对于每个测试用例，我们使用给定的参数 $(z, \\epsilon_{\\mathrm{LJ}}, \\sigma, s)$ 和常数 $(k_c, q_O, \\varepsilon_r)$ 来定义离子-氧对的相互作用势 $U(r)$：\n    $$\n    U(r) \\;=\\; 4\\,\\epsilon_{\\mathrm{LJ}} \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] \\;-\\; \\frac{k_c\\,s\\,z\\,q_O}{\\varepsilon_r\\,r}\n    $$\n\n2.  **确定平衡距离 $r^\\*$**：通过数值优化方法，在指定的区间 $[0.15, 0.50]\\,\\mathrm{nm}$ 内找到使势能 $U(r)$ 达到最小值的距离 $r^\\*$。\n    $$\n    r^\\* \\;=\\; \\operatorname*{arg\\,min}_{r \\in [0.15,\\,0.50]\\,\\mathrm{nm}} U(r)\n    $$\n    这个 $r^\\*$ 被用作模型的结构预测值，并作为有效离子半径 $r_{\\mathrm{eff}}$。\n\n3.  **计算模型水合自由能**：使用 $r^\\*$ 作为有效半径 $r_{\\mathrm{eff}}$，我们应用 Born 模型来计算模型预测的水合自由能 $\\Delta G_{\\mathrm{hyd}}^{\\mathrm{model}}$：\n    $$\n    \\Delta G_{\\mathrm{hyd}}^{\\mathrm{model}} \\;=\\; -\\frac{1}{2}\\,k_c\\,\\frac{(s\\,z)^2}{r_{\\mathrm{eff}}}\\,\\left(1 - \\frac{1}{\\varepsilon_r}\\right)\n    $$\n\n4.  **计算权衡度量 $E$**：最后，我们计算模型预测值与参考值之间的归一化误差。权衡度量 $E$ 是能量误差和结构误差的二次方和的平方根：\n    $$\n    E \\;=\\; \\sqrt{ \\left(\\frac{\\Delta G_{\\mathrm{hyd}}^{\\mathrm{model}} - \\Delta G_{\\mathrm{hyd}}^{\\mathrm{ref}}}{\\Delta G_{\\mathrm{tol}}}\\right)^2 \\;+\\; \\left(\\frac{r^\\* - r_{\\mathrm{ref}}}{r_{\\mathrm{tol}}}\\right)^2 }\n    $$\n    其中，参考值 $(\\Delta G_{\\mathrm{hyd}}^{\\mathrm{ref}}, r_{\\mathrm{ref}})$ 和容差 $(\\Delta G_{\\mathrm{tol}}, r_{\\mathrm{tol}})$ 均由每个测试用例提供。\n\n对所有四个测试用例重复此过程，将得到的 $E$ 值四舍五入到小数点后三位，并整理成一个列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating a trade-off metric for force field\n    parametrization in computational electrochemistry.\n    \"\"\"\n\n    # Define the physical and model constants as specified in the problem statement.\n    # k_c is the Coulomb constant in kJ mol^-1 nm e^-2.\n    KC = 138.935456\n    # q_O is the magnitude of the water oxygen partial charge in elementary charges (e).\n    QO = 0.847\n    # epsilon_r is the relative permittivity of water.\n    EPSILON_R = 78.4\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (z, dG_ref, r_ref, eps_lj, sigma, s, dG_tol, r_tol)\n    test_cases = [\n        # Case 1 (monovalent, moderate charge scaling)\n        (1.0, -365.0, 0.240, 0.300, 0.255, 0.85, 15.0, 0.010),\n        # Case 2 (monovalent, full charge, larger sigma)\n        (1.0, -295.0, 0.275, 0.200, 0.295, 1.00, 15.0, 0.015),\n        # Case 3 (divalent, reduced charge scaling)\n        (2.0, -1600.0, 0.235, 0.450, 0.245, 0.75, 30.0, 0.010),\n        # Case 4 (edge case, no electrostatics)\n        (1.0, -365.0, 0.240, 0.100, 0.240, 0.00, 15.0, 0.010),\n    ]\n\n    results = []\n    # The search interval for the potential minimum.\n    r_bounds = (0.15, 0.50)\n\n    for case in test_cases:\n        z, dG_ref, r_ref, eps_lj, sigma, s, dG_tol, r_tol = case\n\n        # Define the total ion–oxygen pair potential U(r).\n        # This function captures the parameters for the current test case from the loop scope.\n        def potential(r: float) -> float:\n            # Lennard-Jones term\n            lj_term = 4.0 * eps_lj * ((sigma / r)**12 - (sigma / r)**6)\n            # Screened Coulomb term\n            coulomb_term = - (KC * s * z * QO) / (EPSILON_R * r)\n            return lj_term + coulomb_term\n\n        # Find r*, the ion-oxygen separation at the minimum of U(r).\n        # We use a bounded scalar minimizer as required by the problem.\n        opt_result = minimize_scalar(\n            potential,\n            bounds=r_bounds,\n            method='bounded'\n        )\n        r_star = opt_result.x\n\n        # Calculate the model hydration free energy using the Born approximation.\n        # The effective ionic radius r_eff is defined as r*.\n        r_eff = r_star\n        dG_model = -0.5 * KC * (s * z)**2 / r_eff * (1.0 - 1.0 / EPSILON_R)\n\n        # Calculate the dimensionless trade-off metric E.\n        energy_error_sq = ((dG_model - dG_ref) / dG_tol)**2\n        structure_error_sq = ((r_star - r_ref) / r_tol)**2\n        E = np.sqrt(energy_error_sq + structure_error_sq)\n\n        results.append(E)\n\n    # Final print statement in the exact required format.\n    # The results are rounded to 3 decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function.\nsolve()\n```"
        }
    ]
}