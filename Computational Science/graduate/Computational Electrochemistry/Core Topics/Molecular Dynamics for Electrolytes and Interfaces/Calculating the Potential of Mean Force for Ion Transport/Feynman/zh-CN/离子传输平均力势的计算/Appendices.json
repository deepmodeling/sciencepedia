{
    "hands_on_practices": [
        {
            "introduction": "在任何平均力势（PMF）的计算中，一个关键的初始步骤是定义一个稳健的反应坐标。本练习  将探讨为何简单的笛卡尔坐标在周期性体系中会失效，以及如何构建一个数学上合理、能够避免非物理不连续性的坐标。这对于获得有意义的自由能形貌至关重要。",
            "id": "4237573",
            "problem": "在一个电化学平板中离子输运的分子动力学模拟中，您在一个尺寸为 $L_x \\times L_y \\times L_z$ 的矩形盒子中模拟一个单价离子，并在所有方向上应用周期性边界条件 (PBC)。该平板横跨 $x$–$y$ 平面，名义上以 $z_{\\mathrm{slab}}$ 为中心，沿 $z$ 方向有真空填充但仍受 PBC 约束。您的目标是计算离子沿法线方向穿过平板的平均力势 (PMF)，使用一个一维反应坐标（也称为集体变量，CV）$\\xi(\\mathbf{R})$，该坐标取决于瞬时位置 $\\mathbf{R}$。\n\nPMF $W(\\xi)$ 由平衡边际概率密度 $P(\\xi)$ 定义，在相差一个可加常数的情况下，表达式为 $W(\\xi) = -k_{\\mathrm{B}} T \\ln P(\\xi) + C$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$C$ 是一个与 $\\xi$ 无关的常数。在一个沿 $z$ 方向具有 PBC 的平板几何结构中，对于离子的 $z$ 坐标 $z_i$，朴素地选择坐标 $z_i - z_{\\mathrm{slab}}$ 会在离子穿过周期性边界时产生不连续性，这反过来会破坏直方图 $P(\\xi)$ 和最终的 PMF。\n\n您的目标是选择一个 $\\xi$ 的定义，该定义是瞬时位置的单值函数，在沿 $z$ 方向的 PBC 下能感知周期性，并在整个允许的 $z$ 域上避免不连续性，同时能得出一个用于描述穿过平板输运过程的有效 PMF。请考虑以下候选定义，其中 $L_z$ 是盒子沿 $z$ 方向的长度：\n\nA. $\\xi_A(\\mathbf{R}) = z_i - z_{\\mathrm{slab}}$，其中 $z_i$ 和 $z_{\\mathrm{slab}}$ 是主模拟盒子中的折叠位置。\n\nB. $\\xi_B(\\mathbf{R}) = \\mathrm{wrap}_{(-L_z/2,\\,L_z/2]}\\!\\left(z_i - z_{\\mathrm{slab}}\\right)$，即 $z_i$ 和 $z_{\\mathrm{slab}}$ 之间带符号的最小镜像差，映射到区间 $(-L_z/2,\\,L_z/2]$。\n\nC. $\\xi_C(\\mathbf{R}; t)$ 等于 $z_i - z_{\\mathrm{slab}}$，但通过在离子沿轨迹穿过周期性边界时加上或减去 $L_z$ 的整数倍而在时间上“展开”，因此 $\\xi_C$ 的取值可以超出 $(-L_z/2,\\,L_z/2]$ 并取决于穿越历史。\n\nD. 定义角度变量 $\\theta(\\mathbf{R}) = \\frac{2\\pi}{L_z}\\left[z_i - z_{\\mathrm{slab}}\\right]$ 和双分量 CV\n$\\boldsymbol{\\xi}_D(\\mathbf{R}) = \\big(\\cos \\theta(\\mathbf{R}),\\, \\sin \\theta(\\mathbf{R})\\big)$。通过其分量将 $\\boldsymbol{\\xi}_D$ 约束到目标角度 $\\theta_0$ 来进行采样和施加偏置，然后将 PMF 重建为 $\\theta$ 的函数；PMF 作为 $z$ 的函数可通过线性映射 $z = z_{\\mathrm{slab}} + \\frac{L_z}{2\\pi}\\theta$ 得到。\n\n哪个选项提供了在 $\\mathbf{R}$ 中是单值的、能感知周期性、在 PBC 下的整个允许范围内避免不连续性，并且能（在相差一个可加常数的情况下）得出有效离子输运 PMF 的定义？请选择所有适用的选项。",
            "solution": "问题要求选择一个集体变量 (CV)，记为 $\\xi(\\mathbf{R})$，用于计算在沿输运方向 $z$ 具有周期性边界条件 (PBC) 的模拟中，离子穿过平板的平均力势 (PMF)。PMF $W(\\xi)$ 与平衡概率密度 $P(\\xi)$ 的关系为 $W(\\xi) = -k_{\\mathrm{B}} T \\ln P(\\xi) + C$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$C$ 是一个任意常数。\n\n一个有效的 CV $\\xi(\\mathbf{R})$ 必须满足几个关键属性：\n1. 它必须是瞬时原子位置 $\\mathbf{R}$ 的单值函数。PMF 是一个取决于构型空间的平衡性质，而不是轨迹的历史。\n2. 它必须相对于粒子运动是连续的。由于模拟盒子在 $z$ 方向是周期性的，物理空间具有圆柱体 ($S^1 \\times \\mathbb{R}^2$) 的拓扑结构。在 $z = z_0$ 处的点与在 $z = z_0 + n L_z$ 处的点在物理上是相同的（对于任何整数 $n$），其中 $L_z$ 是盒子长度。当粒子穿过这个周期性边界时，如果一个 CV 表现出不连续性，将导致对概率分布 $P(\\xi)$ 的不正确采样，从而产生一个虚假的 PMF。\n3. 它必须能“感知周期性”，意味着它能正确处理系统的周期性。\n\n我们现在将根据这些标准评估每个提议的 $\\xi$ 定义。\n\nA. $\\xi_A(\\mathbf{R}) = z_i - z_{\\mathrm{slab}}$，其中 $z_i$ 和 $z_{\\mathrm{slab}}$ 是主模拟盒子中的折叠位置。设主盒子定义为 $z \\in [-L_z/2, L_z/2)$。离子的位置 $z_i$ 总是被映射到这个区间内。当离子连续地穿过周期性边界时，例如从位置 $z_i = L_z/2 - \\epsilon$ 移动到 $z_i' = -L_z/2 + \\epsilon$（其中 $\\epsilon$ 是一个小的正位移），$\\xi_A$ 的值从 $\\xi_A \\approx L_z/2 - z_{\\mathrm{slab}}$ 跳变到 $\\xi_A' \\approx -L_z/2 - z_{\\mathrm{slab}}$。对于一个无穷小的物理位移，这是一个大的、非物理的反应坐标不连续性。这种不连续性会通过严重耗尽对应于边界值的测量概率密度 $P(\\xi)$，在计算出的 PMF 中产生人为的势垒。因此，这个定义是不合适的。\n**结论：不正确。**\n\nB. $\\xi_B(\\mathbf{R}) = \\mathrm{wrap}_{(-L_z/2,\\,L_z/2]}\\!\\left(z_i - z_{\\mathrm{slab}}\\right)$。这是带符号的最小镜像差。该函数计算考虑所有周期性镜像后，离子在 $z_i$ 与平板中心在 $z_{\\mathrm{slab}}$ 之间的最短矢量。虽然这是 MD 模拟中计算力的标准操作，但它不适合作为跨越整个盒子的 PMF 计算的 CV。`wrap` 函数本身会引入不连续性。当自变量 $z_i - z_{\\mathrm{slab}}$ 连续地越过值 $L_z/2$ 时，$\\xi_B$ 的输出会从 $L_z/2$ 跳变到 $-L_z/2$。物理上，离子处于离平板中心最远的点，CV 范围的两端 $-L_z/2$ 和 $L_z/2$ 对应于同一个物理位置。然而，它们在反应坐标轴上被当作是不同且相距很远的点。这产生了与选项 A 相同的问题：一个破坏 PMF 计算的不连续性。\n**结论：不正确。**\n\nC. $\\xi_C(\\mathbf{R}; t)$ 是“展开”坐标，通过在边界穿越时加上或减去 $L_z$ 的整数倍来使其在时间上连续。例如，如果离子在主盒子中从 $z_i(t_1) = L_z - \\epsilon$ 移动到 $z_i(t_2) = \\epsilon$，展开坐标将从 $\\xi_C(t_1) \\approx z_{\\mathrm{ref}} + L_z - \\epsilon$ 变为 $\\xi_C(t_2) \\approx z_{\\mathrm{ref}} + L_z + \\epsilon$，其中 $z_{\\mathrm{ref}}$ 是某个参考。这里的关键问题是 $\\xi_C$ 不仅仅是瞬时构型 $\\mathbf{R}$ 的函数。它的值取决于轨迹历史——具体来说，是离子在某个方向上穿过周期性边界的净次数。一个单一的构型 $\\mathbf{R}$（例如，离子在特定的 $z_i$）可以对应于多个不同的 $\\xi_C$ 值（例如，$z_i - z_{\\mathrm{slab}}$、$z_i - z_{\\mathrm{slab}} + L_z$、$z_i - z_{\\mathrm{slab}} - L_z$ 等）。PMF 是从构型相空间上的平衡概率分布 $P(\\mathbf{R})$ 定义的，并要求 CV 是状态的唯一函数 $\\xi(\\mathbf{R})$。因为 $\\xi_C$ 依赖于历史，它违反了这一基本要求。\n**结论：不正确。**\n\nD. $\\boldsymbol{\\xi}_D(\\mathbf{R}) = \\big(\\cos \\theta(\\mathbf{R}),\\, \\sin \\theta(\\mathbf{R})\\big)$，其中 $\\theta(\\mathbf{R}) = \\frac{2\\pi}{L_z}\\left[z_i - z_{\\mathrm{slab}}\\right]$。这个定义将一维周期性坐标 $z_i$ 映射到二维空间中的单位圆上。\n1. **$\\mathbf{R}$ 的单值函数**：对于任何瞬时位置 $z_i$，角度 $\\theta$ 在模 $2\\pi$ 的意义下是唯一确定的，这反过来又唯一地确定了 $\\cos\\theta$ 和 $\\sin\\theta$ 的值。因此，双分量 CV $\\boldsymbol{\\xi}_D$ 是构型 $\\mathbf{R}$ 的单值函数。\n2. **连续性和周期性感知**：让我们检查在周期性边界处的行为。考虑与之前相同的边界穿越，其中 $z_i - z_{\\mathrm{slab}}$ 从 $L_z/2 - \\epsilon$ 变为 $-L_z/2 + \\epsilon$。相应的角度 $\\theta$ 从 $\\pi - \\delta$ 变为 $-\\pi + \\delta$，其中 $\\delta = 2\\pi\\epsilon/L_z$。CV $\\boldsymbol{\\xi}_D$ 从 $(\\cos(\\pi-\\delta), \\sin(\\pi-\\delta))$ 过渡到 $(\\cos(-\\pi+\\delta), \\sin(-\\pi+\\delta))$。当 $\\delta \\to 0$ 时，这两点都连续地趋近于 $(\\cos(\\pi), \\sin(\\pi)) = (-1, 0)$ 和 $(\\cos(-\\pi), \\sin(-\\pi)) = (-1, 0)$。从物理位置 $z_i$ 到圆上点 $(\\cos\\theta, \\sin\\theta)$ 的映射处处都是完美连续的。线性坐标的不连续性通过正确表示周期性拓扑结构而得到解决。\n3. **有效的 PMF**：高级采样方法可以对这两个分量施加偏置或约束，这是一种成熟且稳健的技术。例如，可以使用基于弦距离的谐波势将角度 $\\theta$ 约束到目标值 $\\theta_0$：$V(\\theta) = \\frac{1}{2} k [(\\cos\\theta - \\cos\\theta_0)^2 + (\\sin\\theta - \\sin\\theta_0)^2]$。从采样的分布中，可以构建一个作为角度函数的 PMF，$W(\\theta)$。由于角度 $\\theta$ 与单个周期性镜像内的物理距离 $z_i - z_{\\mathrm{slab}}$ 存在一对一的线性映射关系，$W(\\theta)$ 等价于所期望的 $W(z)$，只差一个 x 轴的平凡缩放和一个可加常数。这种方法正确地处理了问题的周期性，并满足了所有陈述的要求。\n**结论：正确。**",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "模拟运行结束后，必须正确处理原始数据才能得到平均力势（PMF）。本练习  聚焦于“热力学积分”方法，即通过对平均约束力进行积分来重构 PMF。我们将重点讨论对分子动力学产生的时间相关数据进行正确统计误差分析的极端重要性，这是确保结果可靠性的核心环节。",
            "id": "4237554",
            "problem": "一个单价离子在恒定温度 $T$ 下，沿着浸没在液态水中的一个圆柱形纳米孔的轴线传输。反应坐标 $\\xi$ 被定义为离子相对于孔隙中平面的轴向位置，在分子动力学 (MD) 模拟过程中，通过一个拉格朗日乘子 $\\lambda(t)$ 施加了一个完整约束 $\\xi(\\mathbf{q})=\\xi_0$。该约束在质量加权度量中具有单位梯度，并产生一个沿 $\\xi$ 方向的瞬时约束力。系统通过恒温器控制，以对正则系综进行采样。您在一组离散位置 $\\{\\xi_i\\}_{i=0}^M$ 上运行约束分子动力学模拟，每个位置在平衡后都进行一段生产时间 $T_i$ 的模拟，并记录每个窗口中的时间序列 $\\lambda_i(t)$。在所述假设下，对自由能梯度的度量修正可忽略不计。您希望通过数值积分将测得的约束力的时间平均值转换为平均力势 (PMF) $W(\\xi)$，并报告在每个 $\\xi$ 处具有统计学意义的误差棒。\n\n哪个选项正确地概述了一个科学上合理的过程，该过程能够 (i) 测量每个约束 MD 窗口中约束力的时间平均值，(ii) 考虑时间相关性来估计其统计不确定性，(iii) 进行数值积分以获得相对于选定参考点 $\\xi_0$ 的 $W(\\xi)$，以及 (iv) 传播不确定性以获得 $W(\\xi)$ 的误差棒？\n\nA. 在每个窗口 $i$ 中，收集平衡后的拉格朗日乘子时间序列 $\\lambda_i(t)$。估计时间平均值 $\\langle \\lambda \\rangle_i$ 和 $\\lambda_i(t)$ 的积分自相关时间 $\\tau_i$；然后计算平均值的标准误差为 $\\sigma_{\\bar{\\lambda},i} \\approx \\sqrt{\\frac{2\\,\\tau_i}{T_i}}\\,s_{\\lambda,i}$，其中 $s_{\\lambda,i}$ 是 $\\lambda_i(t)$ 在长度为 $T_i$ 的生产轨迹上的标准差。通过梯形积分构建 PMF，\n$$\nW(\\xi_j)-W(\\xi_0)\\approx \\sum_{i=0}^{j-1}\\frac{\\Delta \\xi_i}{2}\\left(\\langle \\lambda \\rangle_{i+1}+\\langle \\lambda \\rangle_{i}\\right),\n$$\n其中 $\\Delta \\xi_i=\\xi_{i+1}-\\xi_i$，并设置 $W(\\xi_0)=0$ 或任何方便的参考值。假设不同窗口之间统计独立，将不确定性传播为\n$$\n\\sigma_{W}^2(\\xi_j)\\approx \\sum_{i=0}^{j-1}\\frac{\\Delta \\xi_i^2}{4}\\left(\\sigma_{\\bar{\\lambda},i+1}^2+\\sigma_{\\bar{\\lambda},i}^2\\right).\n$$\n通过检查前向和后向积分的一致性以及相邻窗口间的重叠来进行验证。\n\nB. 在每个窗口中，计算离子上总物理力沿 $z$ 轴的瞬时投影 $f_{z}(t)$，并对其进行平均以获得 $\\langle f_{z} \\rangle_i$。假设样本独立，将误差估计为 $\\sigma_{\\bar{f},i}=s_{f,i}/\\sqrt{N_i}$，其中 $s_{f,i}$ 是标准差，$N_i$ 是保存的帧数。使用辛普森法则进行积分，\n$$\nW(\\xi_j)-W(\\xi_0)\\approx -\\sum_{i=0}^{j-1}\\frac{\\Delta \\xi_i}{6}\\left(\\langle f_{z} \\rangle_{i}+4\\langle f_{z} \\rangle_{i+\\frac{1}{2}}+\\langle f_{z} \\rangle_{i+1}\\right),\n$$\n其中中点 $i+\\tfrac{1}{2}$ 通过插值获得。通过线性求和标准差来报告误差棒，$\\sigma_W(\\xi_j)\\approx \\sum_{i=0}^{j-1}\\sigma_{\\bar{f},i}$。\n\nC. 在以 $\\xi_i$ 为中心的窗口中运行伞形采样，使用谐波偏置 $U_{\\mathrm{bias}}(\\xi)=\\tfrac{1}{2}k(\\xi-\\xi_i)^2$，收集 $\\xi$ 的有偏直方图，通过除以 $\\exp[-U_{\\mathrm{bias}}(\\xi)/k_{\\mathrm{B}}T]$ 对其进行去偏，并估计 PMF 为 $W(\\xi)=-k_{\\mathrm{B}}T\\ln P(\\xi)+\\text{const}$。从直方图计数统计中将误差估计为 $\\sqrt{P(\\xi)}$。不需要约束力或平均力的积分。\n\nD. 在每个约束窗口中记录 $\\lambda_i(t)$ 并计算 $\\langle \\lambda \\rangle_i$。因为度量是恒定的，所以将平均值的误差设置为 $\\sigma_{\\bar{\\lambda},i}=s_{\\lambda,i}/\\sqrt{N_i}$，而不考虑自相关。通过对左黎曼和的贡献求和来获得 $W(\\xi)$，\n$$\nW(\\xi_j)-W(\\xi_0)\\approx \\sum_{i=0}^{j-1}\\Delta \\xi_i\\,\\langle \\lambda \\rangle_i,\n$$\n并通过线性地添加窗口标准误差来传播不确定性，\n$$\n\\sigma_W(\\xi_j)\\approx \\sum_{i=0}^{j-1}\\Delta \\xi_i\\,\\sigma_{\\bar{\\lambda},i}.\n$$",
            "solution": "问题陈述描述了使用约束分子动力学 (MD) 计算离子穿过纳米孔的平均力势 (PMF) 的过程，这是计算化学和生物物理学中一种标准且重要的技术。对问题陈述的验证如下。\n\n**问题验证**\n\n**第 1 步：提取已知条件**\n- 系统：一个单价离子在恒定温度 $T$ 下，沿着浸没在液态水中的一个圆柱形纳米孔的轴线传输。\n- 反应坐标：$\\xi$ 是离子相对于孔隙中平面的轴向位置。\n- 模拟方法：施加完整约束 $\\xi(\\mathbf{q})=\\xi_0$ 的约束分子动力学。\n- 约束细节：约束的梯度在质量加权度量中具有单位大小。\n- 约束施加：一个拉格朗日乘子 $\\lambda(t)$ 产生约束力。\n- 系综：正则系综，通过恒温器进行采样。\n- 协议：在一系列离散位置 $\\{\\xi_i\\}_{i=0}^M$ 上运行一系列约束 MD 模拟。\n- 收集的数据：在每个窗口 $i$ 中，在生产时间 $T_i$ 内记录下拉格朗日乘子 $\\lambda_i(t)$ 的时间序列。\n- 假设：对自由能梯度的度量修正可忽略不计。\n- 目标：确定一个通过对平均约束力进行数值积分来计算 PMF $W(\\xi)$ 的过程，并计算相关的统计误差棒。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题坚实地基于统计力学原理。PMF $W(\\xi)$ 与平均力之间的关系是基础性的。对于一个在反应坐标 $\\xi$ 的特定值上被约束的系统，PMF 相对于该坐标的导数等于维持该约束所需的平均力。该平均力由约束算法提供，并报告为拉格朗日乘子的时间平均值 $\\langle \\lambda \\rangle$。问题陈述指出度量修正可忽略不计，这将关系简化为 $\\frac{dW(\\xi)}{d\\xi} = \\langle \\lambda \\rangle_{\\xi}$。这是使用约束进行热力学积分的标准公式。\n- **适定性**：该问题是适定的。它提供了一个清晰的物理场景，指明了模拟方法和获得的数据，并要求一个有效的数据分析程序来计算一个明确定义的物理量 ($W(\\xi)$) 及其不确定性。一个唯一的解（在 PMF 的参考常数范围内）是存在的，并且获得它的方法是标准的。\n- **客观性**：语言精确、技术性强，没有歧义或主观陈述。\n\n**第 3 步：结论与行动**\n问题陈述是有效的。它描述了一个基于可靠科学原理的、具有物理意义和计算相关性的任务。我将继续推导正确的过程并评估每个选项。\n\n**正确过程的推导**\n\n1.  **来自拉格朗日乘子的平均力**：根据统计力学的第一性原理，PMF 沿反应坐标 $\\xi$ 的导数是沿该坐标的平均广义力的负值。在约束 MD 模拟中，这个力被约束力所平衡。在问题假设度量修正可忽略不计的情况下，关系是直接的：\n    $$ \\frac{dW(\\xi)}{d\\xi} \\bigg|_{\\xi=\\xi_i} = \\langle \\lambda \\rangle_i $$\n    其中 $\\langle \\lambda \\rangle_i$ 是在施加约束 $\\xi=\\xi_i$ 的模拟窗口中拉格朗日乘子的系综平均值。这可以通过足够长的轨迹的时间平均值来估计。\n\n2.  **平均值和统计误差的估计**：从 MD 模拟中获得的时间序列 $\\lambda_i(t)$ 是自相关的。对平均值标准误差的天真计算 $s_{\\lambda,i}/\\sqrt{N_i}$（其中 $s_{\\lambda,i}$ 是标准差，$N_i$ 是数据点数）假设样本独立，这将严重低估真实的统计不确定性。正确的方法必须考虑这种相关性。一个标准方法是计算时间序列的积分自相关时间 $\\tau_i$。样本均值 $\\bar{\\lambda}_i$ 的方差则由下式给出：\n    $$ \\sigma^2_{\\bar{\\lambda},i} = \\frac{2\\tau_i}{T_i} s_{\\lambda,i}^2 $$\n    其中 $T_i$ 是时间序列的总长度。标准误差是该值的平方根。另一种渐近等效的方法是分块平均法。\n\n3.  **数值积分**：为了获得 PMF $W(\\xi)$，必须对平均力值进行数值积分：\n    $$ W(\\xi_j) - W(\\xi_0) = \\int_{\\xi_0}^{\\xi_j} \\langle \\lambda(\\xi') \\rangle d\\xi' $$\n    给定在离散点 $\\{\\xi_i\\}$ 上的 $\\langle \\lambda \\rangle_i$ 值，必须使用数值求积法则。梯形法则是常用且稳健的选择：\n    $$ W(\\xi_j) - W(\\xi_0) \\approx \\sum_{i=0}^{j-1} \\frac{\\xi_{i+1}-\\xi_i}{2} \\left( \\langle \\lambda \\rangle_{i+1} + \\langle \\lambda \\rangle_i \\right) $$\n    PMF 的定义可相差一个任意的加法常数，因此可以设置 $W(\\xi_0)=0$ 来定义一个参考。\n\n4.  **误差传播**：单个平均力估计中的不确定性 $\\sigma_{\\bar{\\lambda},i}$ 必须通过数值积分进行传播。由于不同窗口中的模拟是独立的，因此估计值 $\\langle \\lambda \\rangle_i$ 是不相关的随机变量。在点 $\\xi_j$ 处积分得到的 PMF 的方差 $\\sigma_W^2(\\xi_j)$，是通过将每个 $\\langle \\lambda \\rangle_k$ 的贡献进行正交相加得到的，并用它们在积分和中系数的平方进行加权。对于梯形法则，方差的精确传播是：\n    $$ \\sigma_W^2(\\xi_j) = \\text{Var}\\left( \\sum_{i=0}^{j-1} \\frac{\\Delta \\xi_i}{2} (\\langle \\lambda \\rangle_i + \\langle \\lambda \\rangle_{i+1}) \\right) $$\n    $$ \\sigma_W^2(\\xi_j) = \\left(\\frac{\\Delta \\xi_0}{2}\\right)^2\\sigma_{\\bar{\\lambda},0}^2 + \\sum_{k=1}^{j-1} \\left(\\frac{\\Delta \\xi_{k-1}+\\Delta \\xi_k}{2}\\right)^2\\sigma_{\\bar{\\lambda},k}^2 + \\left(\\frac{\\Delta \\xi_{j-1}}{2}\\right)^2\\sigma_{\\bar{\\lambda},j}^2 $$\n    其中 $\\Delta\\xi_i = \\xi_{i+1} - \\xi_i$。\n\n**逐项分析**\n\n**A. 在每个窗口 $i$ 中，收集平衡后的拉格朗日乘子时间序列 $\\lambda_i(t)$。估计时间平均值 $\\langle \\lambda \\rangle_i$ 和 $\\lambda_i(t)$ 的积分自相关时间 $\\tau_i$；然后计算平均值的标准误差为 $\\sigma_{\\bar{\\lambda},i} \\approx \\sqrt{\\frac{2\\,\\tau_i}{T_i}}\\,s_{\\lambda,i}$，其中 $s_{\\lambda,i}$ 是 $\\lambda_i(t)$ 在长度为 $T_i$ 的生产轨迹上的标准差。通过梯形积分构建 PMF，... 并设置 $W(\\xi_0)=0$ 或任何方便的参考值。假设不同窗口之间统计独立，将不确定性传播为 $\\sigma_{W}^2(\\xi_j)\\approx \\sum_{i=0}^{j-1}\\frac{\\Delta \\xi_i^2}{4}\\left(\\sigma_{\\bar{\\lambda},i+1}^2+\\sigma_{\\bar{\\lambda},i}^2\\right)$。通过检查前向和后向积分的一致性以及相邻窗口间的重叠来进行验证。**\n\n该选项正确地指出了要分析的数据 ($\\lambda_i(t)$) 和物理关系 $\\frac{dW}{d\\xi} = \\langle\\lambda\\rangle$。至关重要的是，它规定了通过使用积分自相关时间 $\\tau_i$ 从相关时间序列估计平均值误差的正确统计处理方法。它使用了一种标准的数值积分方法（梯形法则）。提议的验证步骤是合理的实践。尽管误差传播公式是一个简化的近似值（它忽略了由于共享积分点而导致的项之间的协方差），但在所有提供的选项中，这是迄今为止最科学严谨和实践上最合理的过程。\n\n**结论：正确。**\n\n**B. 在每个窗口中，计算离子上总物理力沿 $z$ 轴的瞬时投影 $f_{z}(t)$，并对其进行平均以获得 $\\langle f_{z} \\rangle_i$。假设样本独立，将误差估计为 $\\sigma_{\\bar{f},i}=s_{f,i}/\\sqrt{N_i}$，其中 $s_{f,i}$ 是标准差，$N_i$ 是保存的帧数。使用辛普森法则进行积分，... 通过线性求和标准差来报告误差棒，$\\sigma_W(\\xi_j)\\approx \\sum_{i=0}^{j-1}\\sigma_{\\bar{f},i}$。**\n\n该选项包含多个严重错误。\n1.  **平均值误差**：它明确假设样本独立（$\\sigma_{\\bar{f},i}=s_{f,i}/\\sqrt{N_i}$），忽略了 MD 轨迹固有的时间相关性。这是一个根本性错误，会导致对统计不确定性的严重低估。\n2.  **误差传播**：它提出了标准差的线性求和，$\\sigma_W \\approx \\sum \\sigma_{\\bar{f}}$。这在数学上是不正确的。对于独立变量，是方差相加，而不是标准差相加。\n3.  **积分方法**：它提出了辛普森法则，该法则需要在未进行模拟的中间区间的数据点，这需要一个额外的插值步骤，从而不必要地使过程和误差分析复杂化。\n4.  **力的来源**：它建议使用物理力 $f_z(t)$ 而不是提供的拉格朗日乘子 $\\lambda(t)$，这是一种不太直接的方法。\n\n**结论：不正确。**\n\n**C. 在以 $\\xi_i$ 为中心的窗口中运行伞形采样，使用谐波偏置 $U_{\\mathrm{bias}}(\\xi)=\\tfrac{1}{2}k(\\xi-\\xi_i)^2$，收集 $\\xi$ 的有偏直方图，通过除以 $\\exp[-U_{\\mathrm{bias}}(\\xi)/k_{\\mathrm{B}}T]$ 对其进行去偏，并估计 PMF 为 $W(\\xi)=-k_{\\mathrm{B}}T\\ln P(\\xi)+\\text{const}$。从直方图计数统计中将误差估计为 $\\sqrt{P(\\xi)}$。不需要约束力或平均力的积分。**\n\n该选项描述了一种完全不同且有效的方法（伞形采样）来计算 PMF。然而，问题明确指出运行的是约束 MD 模拟，并收集了拉格朗日乘子时间序列 $\\lambda_i(t)$。任务是分析*这些特定的数据*。此选项根本没有使用所提供的数据或方法。\n\n**结论：不正确。**该过程与所提问题无关。\n\n**D. 在每个约束窗口中记录 $\\lambda_i(t)$ 并计算 $\\langle \\lambda \\rangle_i$。因为度量是恒定的，所以将平均值的误差设置为 $\\sigma_{\\bar{\\lambda},i}=s_{\\lambda,i}/\\sqrt{N_i}$，而不考虑自相关。通过对左黎曼和的贡献求和来获得 $W(\\xi)$，... 并通过线性地添加窗口标准误差来传播不确定性，$\\sigma_W(\\xi_j)\\approx \\sum_{i=0}^{j-1}\\Delta \\xi_i\\,\\sigma_{\\bar{\\lambda},i}$。**\n\n该选项与选项 B 一样，包含关键缺陷。\n1.  **平均值误差**：它与选项 B 出于相同的原因，通过忽略自相关来错误地计算平均值的标准误差。关于“恒定度量”的陈述并不能成为忽略可观测量 $\\lambda(t)$ 时间相关性的理由。\n2.  **误差传播**：它提出了标准误差的加权线性求和。与选项 B 一样，这是对误差传播的根本误解。\n使用左黎曼和是一种有效但精度较低的积分方法，但这并不能弥补统计分析中的致命缺陷。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "平均力势（PMF）的一个关键应用是理解和预测其所描述过程的动力学。本练习  演示了如何利用已知的 PMF 剖面来确定离子穿过能垒所需的平均时间。它将热力学景观（$W(z)$）与一个可直接观测的动力学量——平均首过时间（MFPT）联系起来，深刻揭示了 PMF 的物理应用价值。",
            "id": "4237593",
            "problem": "一个离子在过阻尼极限下，在一个长度为 $L$ 的纳米孔中沿着一维坐标 $z$ 扩散，其运动受到一个位置依赖的平均力势 (PMF) $W(z)$ 的驱动。该动力学过程由斯莫鲁霍夫斯基描述建模，在绝对温度 $T$ 下具有恒定的扩散系数 $D$，在 $z=0$ 处有一个反射边界，在 $z=L$ 处有一个吸收边界。在时间 $t=0$ 时，离子位于 $z_0=0$。平均力势是一个线性斜坡，\n$$\nW(z) \\;=\\; \\frac{\\Delta W}{L}\\, z,\n$$\n其中势垒高度 $\\Delta W = 8\\,k_B T$，$k_B$ 是玻尔兹曼常数。系统参数为 $L=3.0\\times 10^{-9}\\,\\mathrm{m}$ 和 $D=1.5\\times 10^{-10}\\,\\mathrm{m^2\\,s^{-1}}$。\n\n从适用于平均力势中离子过阻尼随机动力学的第一性原理（即一维斯莫鲁霍夫斯基描述及相应的平均首达时间伴随公式）出发，推导在给定边界条件（在 $z=0$ 处反射，在 $z=L$ 处吸收）下，从 $z_0=0$ 到达 $z=L$ 处吸收边界的平均首达时间的表达式，并对上述给定的 $W(z)$ 进行求值。将最终的平均首达时间以微秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "我们将离子的坐标 $z(t)$ 建模为在绝对温度 $T$ 下、具有恒定扩散系数 $D$、在平均力势 $W(z)$ 中的过阻尼扩散。令 $p(z,t\\,|\\,z_0)$ 表示在给定初始位置 $z_0$ 的情况下，于时刻 $t$ 处于位置 $z$ 的概率密度。一维斯莫鲁霍夫斯基（正向福克-普朗克）方程为\n$$\n\\frac{\\partial}{\\partial t}\\,p(z,t\\,|\\,z_0) \\;=\\; \\frac{\\partial}{\\partial z}\\Bigg\\{ D \\bigg[ \\frac{\\partial}{\\partial z} p(z,t\\,|\\,z_0) \\;+\\; \\beta\\,W'(z)\\,p(z,t\\,|\\,z_0) \\bigg] \\Bigg\\},\n$$\n其中 $\\beta \\equiv 1/(k_B T)$ 且 $W'(z)\\equiv \\frac{dW}{dz}$。$z=0$ 处的反射边界要求概率流为零，\n$$\nJ(0,t\\,|\\,z_0) \\;=\\; -D\\Big[ \\partial_z p(z,t\\,|\\,z_0) + \\beta W'(z)\\,p(z,t\\,|\\,z_0) \\Big]_{z=0} \\;=\\; 0,\n$$\n而 $z=L$ 处的吸收边界要求\n$$\np(L,t\\,|\\,z_0) \\;=\\; 0.\n$$\n\n定义平均首达时间 (MFPT) $T(z_0)$ 为从 $z_0$ 出发，在 $z=0$ 处反射，首次到达 $z=L$ 的期望时间。标准的伴随（反向）公式表明 $T(z)$ 满足以下常微分方程\n$$\nD\\,\\exp\\!\\big(\\beta W(z)\\big)\\,\\frac{d}{dz}\\!\\left[ \\exp\\!\\big(-\\beta W(z)\\big)\\,\\frac{d}{dz} T(z) \\right] \\;=\\; -1,\n$$\n该方程服从以下边界条件\n$$\n\\left.\\frac{d}{dz}T(z)\\right|_{z=0} \\;=\\; 0 \\quad \\text{(反射)}, \\qquad T(L) \\;=\\; 0 \\quad \\text{(吸收)}.\n$$\n为推导此方程，我们从作用于初始位置 $z$ 的函数的生成元（反向算符）$\\mathcal{L}^\\dagger$ 出发，其表达式为\n$$\n\\mathcal{L}^\\dagger f(z) \\;=\\; D\\left[ \\frac{d^2 f}{dz^2} - \\beta W'(z)\\,\\frac{d f}{dz} \\right],\n$$\n并且 MFPT 满足 $-1 = \\mathcal{L}^\\dagger T(z)$ 以及所述的边界条件。将该微分方程乘以 $\\exp(-\\beta W(z))$ 并定义 $u(z) = \\exp(-\\beta W(z))\\,\\frac{d}{dz}T(z)$，可得\n$$\nD\\,\\frac{d}{dz} u(z) \\;=\\; -\\exp\\!\\big(-\\beta W(z)\\big).\n$$\n从 $0$ 积分到 $y$，并利用反射边界条件 $\\left.\\frac{d}{dz}T(z)\\right|_{z=0}=0$（这意味着 $u(0)=0$），可得\n$$\nu(y) \\;=\\; -\\frac{1}{D}\\int_{0}^{y} \\exp\\!\\big(-\\beta W(z)\\big)\\,dz.\n$$\n因此，\n$$\n\\frac{d}{dy}T(y) \\;=\\; \\exp\\!\\big(\\beta W(y)\\big)\\,u(y) \\;=\\; -\\frac{1}{D}\\,\\exp\\!\\big(\\beta W(y)\\big)\\,\\int_{0}^{y} \\exp\\!\\big(-\\beta W(z)\\big)\\,dz.\n$$\n从 $z_0$ 积分到 $L$，并应用吸收边界条件 $T(L)=0$，可得\n$$\nT(z_0) \\;=\\; \\frac{1}{D}\\int_{z_0}^{L} \\exp\\!\\big(\\beta W(y)\\big)\\left[ \\int_{0}^{y} \\exp\\!\\big(-\\beta W(z)\\big)\\,dz \\right] dy.\n$$\n\n对于本题的情况，我们需要求解 $W(z) = (\\Delta W/L) z$ 且 $\\Delta W = 8\\,k_B T$ 时的 $T(0)$。定义无量纲势垒高度 $A \\equiv \\beta \\Delta W = 8$。则\n$$\n\\beta W(z) \\;=\\; \\beta\\,\\frac{\\Delta W}{L}\\,z \\;=\\; \\frac{A}{L}\\,z.\n$$\n我们计算内层积分：\n$$\n\\int_{0}^{y} \\exp\\!\\left(-\\beta W(z)\\right)\\,dz \\;=\\; \\int_{0}^{y} \\exp\\!\\left(-\\frac{A}{L}\\,z\\right)\\,dz \\;=\\; \\frac{L}{A}\\left[ 1 - \\exp\\!\\left(-\\frac{A}{L}\\,y\\right) \\right].\n$$\n代入求 $T(0)$ 的外层积分中可得\n$$\nT(0) \\;=\\; \\frac{1}{D}\\int_{0}^{L} \\exp\\!\\left(\\frac{A}{L}\\,y\\right)\\,\\frac{L}{A}\\left[ 1 - \\exp\\!\\left(-\\frac{A}{L}\\,y\\right) \\right] dy \\;=\\; \\frac{L}{A D} \\int_{0}^{L} \\left[ \\exp\\!\\left(\\frac{A}{L}\\,y\\right) - 1 \\right] dy.\n$$\n剩下的积分是初等的：\n$$\n\\int_{0}^{L} \\exp\\!\\left(\\frac{A}{L}\\,y\\right) dy \\;=\\; \\frac{L}{A}\\left[ \\exp(A) - 1 \\right], \\qquad \\int_{0}^{L} 1\\,dy \\;=\\; L.\n$$\n因此，\n$$\nT(0) \\;=\\; \\frac{L}{A D} \\left[ \\frac{L}{A}\\left( \\exp(A) - 1 \\right) - L \\right] \\;=\\; \\frac{L^{2}}{D}\\left[ \\frac{\\exp(A) - 1}{A^{2}} - \\frac{1}{A} \\right].\n$$\n代入 $A=8$，$L=3.0\\times 10^{-9}\\,\\mathrm{m}$ 和 $D=1.5\\times 10^{-10}\\,\\mathrm{m^2\\,s^{-1}}$，我们计算\n$$\n\\frac{L^{2}}{D} \\;=\\; \\frac{(3.0\\times 10^{-9})^{2}}{1.5\\times 10^{-10}} \\;\\mathrm{s} \\;=\\; \\frac{9.0\\times 10^{-18}}{1.5\\times 10^{-10}} \\;\\mathrm{s} \\;=\\; 6.0\\times 10^{-8}\\;\\mathrm{s},\n$$\n以及\n$$\n\\left[ \\frac{\\exp(8) - 1}{8^{2}} - \\frac{1}{8} \\right] \\;=\\; \\left[ \\frac{\\exp(8) - 1}{64} - 0.125 \\right].\n$$\n使用 $\\exp(8) \\approx 2980.957987$，我们发现\n$$\n\\frac{\\exp(8) - 1}{64} \\;\\approx\\; \\frac{2979.957987}{64} \\;\\approx\\; 46.561843,\\quad \\text{所以}\\quad \\left[ \\cdots \\right] \\;\\approx\\; 46.561843 - 0.125 \\;=\\; 46.436843.\n$$\n因此，\n$$\nT(0) \\;\\approx\\; \\left(6.0\\times 10^{-8}\\right)\\times 46.436843 \\;\\mathrm{s} \\;=\\; 2.7862106\\times 10^{-6}\\;\\mathrm{s}.\n$$\n以微秒表示，即为\n$$\n2.7862106\\;\\mu\\mathrm{s}.\n$$\n四舍五入到四位有效数字，得到\n$$\n2.786\\;\\mu\\mathrm{s}.\n$$",
            "answer": "$$\\boxed{2.786}$$"
        }
    ]
}