{
    "hands_on_practices": [
        {
            "introduction": "A primary goal in computational electrochemistry is to predict catalyst performance from first principles. This exercise  introduces the foundational thermodynamic approach to this challenge by defining the limiting potential, $U_L$, as the minimum potential required to make all elementary steps in a reaction pathway exergonic (i.e., $\\Delta G_i \\le 0$). The step that dictates this potential is the thermodynamic potential-determining step (PDS), and from it, we can calculate the overpotential $\\eta = U_L - U_{\\mathrm{eq}}$, a crucial metric for catalytic efficiency. This practice solidifies the direct link between the thermodynamics of elementary steps and the predicted performance of a catalyst.",
            "id": "4248384",
            "problem": "An oxide electrocatalyst for the oxygen evolution reaction is studied within the Computational Hydrogen Electrode (CHE) framework. Consider the canonical four-step mechanism on a single active site, where asterisks denote surface-bound intermediates:\n(1) $\\ast + \\mathrm{H_2O(l)} \\rightarrow \\ast\\mathrm{OH} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$\n(2) $\\ast\\mathrm{OH} \\rightarrow \\ast\\mathrm{O} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$\n(3) $\\ast\\mathrm{O} + \\mathrm{H_2O(l)} \\rightarrow \\ast\\mathrm{OOH} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$\n(4) $\\ast\\mathrm{OOH} \\rightarrow \\ast + \\mathrm{O_2(g)} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$.\n\nAt an electrode potential of $U=0$ relative to the Reversible Hydrogen Electrode (RHE), first-principles calculations provide the following standard-state step free energies (including zero-point energy and entropic corrections), each expressed as $\\Delta G_{i}(0)$ in electronvolts: $\\Delta G_{1}(0)=1.62$, $\\Delta G_{2}(0)=1.79$, $\\Delta G_{3}(0)=2.05$, $\\Delta G_{4}(0)=1.26$. Assume that each elementary step transfers $n_{i}=1$ electron and that the CHE description applies, so that the free energy of any step depends linearly on the electrode potential $U$ relative to RHE. The overall equilibrium potential for the oxygen evolution reaction under these conditions is $U_{\\mathrm{eq}}=1.23$ volts relative to RHE.\n\nUsing only fundamental thermodynamic reasoning appropriate to electrochemical systems, determine the smallest applied potential $U_{\\mathrm{L}}$ (in volts relative to RHE) that renders all four elementary steps exergonic (downhill in free energy). Then, define the thermodynamic overpotential as $\\eta=U_{\\mathrm{L}}-U_{\\mathrm{eq}}$ and compute its value. Identify which specific elementary step is the potential-determining step that sets $\\eta$. Report the overpotential in volts and round your numerical answer to four significant figures.",
            "solution": "The problem is first subjected to validation.\n\nStep 1: Extracted Givens\n-   **Catalytic System**: An oxide electrocatalyst for the oxygen evolution reaction (OER).\n-   **Framework**: Computational Hydrogen Electrode (CHE).\n-   **Mechanism**: A canonical four-step mechanism on a single active site ($\\ast$).\n    1.  $\\ast + \\mathrm{H_2O(l)} \\rightarrow \\ast\\mathrm{OH} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$\n    2.  $\\ast\\mathrm{OH} \\rightarrow \\ast\\mathrm{O} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$\n    3.  $\\ast\\mathrm{O} + \\mathrm{H_2O(l)} \\rightarrow \\ast\\mathrm{OOH} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$\n    4.  $\\ast\\mathrm{OOH} \\rightarrow \\ast + \\mathrm{O_2(g)} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$\n-   **Step Free Energies at $U=0$ V vs RHE**:\n    -   $\\Delta G_{1}(0) = 1.62$ eV\n    -   $\\Delta G_{2}(0) = 1.79$ eV\n    -   $\\Delta G_{3}(0) = 2.05$ eV\n    -   $\\Delta G_{4}(0) = 1.26$ eV\n-   **Electron Transfer**: $n_{i}=1$ electron for each step $i$.\n-   **Potential Dependence**: The free energy of each step depends linearly on the electrode potential $U$ relative to RHE.\n-   **Equilibrium Potential**: The overall equilibrium potential for OER is $U_{\\mathrm{eq}} = 1.23$ V vs RHE.\n-   **Tasks**:\n    1.  Determine the smallest applied potential $U_{\\mathrm{L}}$ that renders all four steps exergonic.\n    2.  Compute the thermodynamic overpotential $\\eta=U_{\\mathrm{L}}-U_{\\mathrm{eq}}$.\n    3.  Identify the potential-determining step.\n    4.  Report $\\eta$ rounded to four significant figures.\n\nStep 2: Validation Using Extracted Givens\nThe problem is scientifically grounded, employing the standard CHE model for analyzing electrocatalytic reaction mechanisms. The four-step OER pathway is a canonical model, and the use of first-principles free energies is a cornerstone of computational electrochemistry. The problem is well-posed and objective.\n\nA self-consistency check on the provided thermodynamic data is necessary. The overall OER, $2\\mathrm{H_2O(l)} \\rightarrow \\mathrm{O_2(g)} + 4\\mathrm{H}^{+} + 4\\mathrm{e}^{-}$, is the summation of the four elementary steps. Therefore, the overall free energy change at zero potential, $\\Delta G_{\\mathrm{overall}}(0)$, must equal the sum of the step free energies, $\\sum_{i=1}^{4} \\Delta G_{i}(0)$. From the data, this sum is $1.62 + 1.79 + 2.05 + 1.26 = 6.72$ eV. The overall free energy change is also related to the equilibrium potential $U_{\\mathrm{eq}}$ by the fundamental thermodynamic relation $\\Delta G_{\\mathrm{overall}}(0) = 4eU_{\\mathrm{eq}}$. Using the provided value $U_{\\mathrm{eq}} = 1.23$ V, we find $\\Delta G_{\\mathrm{overall}}(0) = 4 \\times e \\times 1.23\\text{ V} = 4.92$ eV.\n\nThe value derived from the sum of step energies ($6.72$ eV) is inconsistent with the value derived from the provided equilibrium potential ($4.92$ eV). This is not, however, a flaw that invalidates the problem. It reflects a common and realistic scenario in computational materials science, where the employed theoretical method (e.g., a specific DFT functional) generates step energies that, when summed, do not perfectly reproduce the experimentally known overall reaction thermodynamics. The problem is thus a valid exercise in evaluating the performance of a given computational model, specifically calculating the limiting potential and overpotential predicted by that model with reference to the correct thermodynamic benchmark. The inputs are self-consistent *within the context of this evaluation procedure*.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\nThe free energy change of each elementary step $i$, which involves the transfer of one proton and one electron ($n_{i}=1$), depends on the electrode potential $U$ relative to the RHE according to the Computational Hydrogen Electrode (CHE) model:\n$$ \\Delta G_{i}(U) = \\Delta G_{i}(0) - eU $$\nwhere $\\Delta G_{i}(0)$ is the standard free energy change at $U=0$ V vs. RHE, and $e$ is the elementary charge.\n\nFor a reaction to proceed spontaneously, all of its elementary steps must be exergonic, meaning their free energy change must be non-positive:\n$$ \\Delta G_{i}(U) \\le 0 $$\nSubstituting the expression for $\\Delta G_{i}(U)$ into this inequality yields a condition on the minimum required potential for each step:\n$$ \\Delta G_{i}(0) - eU \\le 0 \\implies U \\ge \\frac{\\Delta G_{i}(0)}{e} $$\nSince the free energies $\\Delta G_{i}(0)$ are provided in units of electronvolts (eV), the required potential in volts (V) is numerically equivalent to the free energy value in eV. We apply this condition to each of the four steps:\nFor step 1: $U \\ge \\frac{1.62 \\text{ eV}}{e} = 1.62 \\text{ V}$\nFor step 2: $U \\ge \\frac{1.79 \\text{ eV}}{e} = 1.79 \\text{ V}$\nFor step 3: $U \\ge \\frac{2.05 \\text{ eV}}{e} = 2.05 \\text{ V}$\nFor step 4: $U \\ge \\frac{1.26 \\text{ eV}}{e} = 1.26 \\text{ V}$\n\nTo ensure that all four steps are simultaneously exergonic, the applied potential $U$ must be at least as large as the maximum of these individual potential requirements. This potential is defined as the thermodynamic limiting potential, $U_{\\mathrm{L}}$:\n$$ U_{\\mathrm{L}} = \\max\\left(\\frac{\\Delta G_{1}(0)}{e}, \\frac{\\Delta G_{2}(0)}{e}, \\frac{\\Delta G_{3}(0)}{e}, \\frac{\\Delta G_{4}(0)}{e}\\right) $$\n$$ U_{\\mathrm{L}} = \\max(1.62, 1.79, 2.05, 1.26) \\text{ V} = 2.05 \\text{ V} $$\n\nThe elementary step that necessitates this highest potential is the one that limits the overall process from a thermodynamic standpoint. Here, that is step (3), which has the largest reaction free energy at zero potential, $\\Delta G_{3}(0)=2.05$ eV. Therefore, the reaction $\\ast\\mathrm{O} + \\mathrm{H_2O(l)} \\rightarrow \\ast\\mathrm{OOH} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$ is the potential-determining step (PDS).\n\nThe thermodynamic overpotential, $\\eta$, is the excess potential required above the thermodynamic equilibrium potential, $U_{\\mathrm{eq}}$, to drive all elementary steps of the reaction downhill in free energy. It is calculated as the difference between the limiting potential, $U_{\\mathrm{L}}$, and the equilibrium potential, $U_{\\mathrm{eq}}$:\n$$ \\eta = U_{\\mathrm{L}} - U_{\\mathrm{eq}} $$\nUsing the calculated value $U_{\\mathrm{L}} = 2.05$ V and the given value $U_{\\mathrm{eq}} = 1.23$ V:\n$$ \\eta = 2.05 \\text{ V} - 1.23 \\text{ V} = 0.82 \\text{ V} $$\nThe problem requests the final answer to be rounded to four significant figures. The calculated value $0.82$ is exact based on the input data. To express this with four significant figures, we write:\n$$ \\eta = 0.8200 \\text{ V} $$\nThe potential-determining step is step (3).",
            "answer": "$$\\boxed{0.8200}$$"
        },
        {
            "introduction": "The identity of the potential-determining step is not necessarily fixed but can shift as experimental conditions like applied potential ($U$) and acidity ($\\mathrm{pH}$) are varied, particularly for proton-coupled electron transfer (PCET) reactions. This practice  moves beyond a single-condition analysis to explore the dynamic nature of the PDS. You will construct a two-dimensional \"PDS map\" over a grid of potential and $\\mathrm{pH}$ values, providing a powerful visual tool analogous to a Pourbaix diagram that reveals which reaction step is the bottleneck under different electrochemical environments.",
            "id": "4248330",
            "problem": "You are given a three-step sequence of Proton-Coupled Electron Transfer (PCET) elementary reactions on a single, non-interacting active site at temperature $T = 298.15\\,\\mathrm{K}$. Each step $i \\in \\{1,2,3\\}$ has a standard reaction free energy $\\Delta G_i^0$ (in $\\mathrm{eV}$) defined at reference potential $U_{\\mathrm{ref}} = 0\\,\\mathrm{V}$ versus the Standard Hydrogen Electrode (SHE) and reference acidity $\\mathrm{pH}_{\\mathrm{ref}} = 0$. The step $i$ consumes $n_{e,i}$ electrons and $n_{H,i}$ protons, where $n_{e,i}$ and $n_{H,i}$ are nonnegative integers. Assume ideal solution behavior and the Computational Hydrogen Electrode (CHE) convention: the electrochemical potential of the proton–electron pair is given by the equilibrium with molecular hydrogen and depends linearly on the electrode potential and acidity. Under CHE, the reaction free energy shift for a step with stoichiometries $n_{e,i}$ and $n_{H,i}$ at electrode potential $U$ (in $\\mathrm{V}$ vs SHE) and acidity $\\mathrm{pH}$ is given by\n$$\n\\Delta G_i(U,\\mathrm{pH}) \\;=\\; \\Delta G_i^0 \\;-\\; n_{e,i}\\, U \\;-\\; n_{H,i}\\, \\lambda\\, \\mathrm{pH},\n$$\nwhere $\\lambda = k_{\\mathrm{B}} T \\ln 10$ expressed in $\\mathrm{eV}$, $k_{\\mathrm{B}}$ is the Boltzmann constant, and the electron charge is already absorbed by using $\\mathrm{eV}$ as the energy unit.\n\nDefine the Potential-Determining Step (PDS) at given $(U,\\mathrm{pH})$ as follows:\n- Compute $\\Delta G_i(U,\\mathrm{pH})$ for $i=1,2,3$.\n- Identify the set of uphill steps $\\mathcal{U} = \\{\\, i \\mid \\Delta G_i(U,\\mathrm{pH}) > 0 \\,\\}$.\n- If $\\mathcal{U}$ is empty, there is no PDS because all steps are downhill; denote this case as the category \"all-downhill.\"\n- Otherwise, find $M = \\max_{i \\in \\mathcal{U}} \\Delta G_i(U,\\mathrm{pH})$. If a unique index $i^\\star \\in \\mathcal{U}$ achieves $M$, then $i^\\star$ is the PDS. If multiple indices in $\\mathcal{U}$ achieve $M$ within an energy tolerance $\\epsilon$ (in $\\mathrm{eV}$), denote this case as the category \"tie\" for the PDS.\n\nYour task is to implement a program that sweeps a grid of $(U,\\mathrm{pH})$ values, identifies the PDS category at each grid point, and summarizes the fraction of grid points belonging to each category: step $1$ as PDS, step $2$ as PDS, step $3$ as PDS, tie, and all-downhill. Fractions must be reported as decimals. Use $\\epsilon = 10^{-12}\\,\\mathrm{eV}$ for tie detection.\n\nFundamental base to be used:\n- The Computational Hydrogen Electrode (CHE) relation for the proton–electron pair: $G(\\mathrm{H}^+ + e^-) = \\tfrac{1}{2}G(\\mathrm{H}_2) - e U - k_{\\mathrm{B}} T \\ln 10 \\cdot \\mathrm{pH}$, with energies expressed in $\\mathrm{eV}$ so that $e$ is absorbed.\n- The microkinetic viewpoint that the potential-dependence of thermodynamic driving forces $\\,\\Delta G_i(U,\\mathrm{pH})\\,$ determines the potential-determining step through the largest uphill free energy among elementary steps.\n\nUnits and numerical requirements:\n- Energies $\\Delta G$ and $\\Delta G^0$ must be in $\\mathrm{eV}$.\n- Electrode potential $U$ must be in $\\mathrm{V}$ versus SHE.\n- Acidity $\\mathrm{pH}$ is dimensionless.\n- Temperature $T$ is in $\\mathrm{K}$ and fixed at $T = 298.15\\,\\mathrm{K}$.\n- Report the final fractions as decimals rounded to three decimal places.\n\nSweep definition:\n- Use a rectangular grid with $U \\in [0.0, 1.0]\\,\\mathrm{V}$ in increments of $0.1\\,\\mathrm{V}$ and $\\mathrm{pH} \\in [0, 14]$ in increments of $1$.\n\nTest suite:\nProvide results for the following three parameter sets. In all cases, let $\\lambda = k_{\\mathrm{B}} T \\ln 10$ be computed internally (in $\\mathrm{eV}$) from $k_{\\mathrm{B}}$ and $T$.\n\n1. Baseline PCET with identical stoichiometries:\n   - $\\Delta G^0 = [1.00,\\,0.90,\\,1.20]\\,\\mathrm{eV}$,\n   - $n_e = [1,\\,1,\\,1]$,\n   - $n_H = [1,\\,1,\\,1]$.\n\n2. Mixed proton stoichiometries to induce $\\mathrm{pH}$-dependent PDS changes:\n   - $\\Delta G^0 = [0.80,\\,0.90,\\,0.85]\\,\\mathrm{eV}$,\n   - $n_e = [1,\\,1,\\,1]$,\n   - $n_H = [1,\\,0,\\,2]$.\n\n3. Constructed degeneracy to produce explicit tie regions at $\\mathrm{pH} = 5$:\n   - $\\Delta G^0 = [0.50 + 5\\lambda,\\,0.50,\\,0.60]\\,\\mathrm{eV}$,\n   - $n_e = [1,\\,1,\\,1]$,\n   - $n_H = [1,\\,0,\\,1]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list of five decimals $[f_1,f_2,f_3,f_{\\mathrm{tie}},f_{\\mathrm{all}}]$, where $f_1$ is the fraction of grid points where step $1$ is the PDS, $f_2$ for step $2$, $f_3$ for step $3$, $f_{\\mathrm{tie}}$ where ties occur, and $f_{\\mathrm{all}}$ where all steps are downhill. The overall output, aggregating all test cases, must be a list of these lists, for example: $[[f_1,f_2,f_3,f_{\\mathrm{tie}},f_{\\mathrm{all}}],\\,[\\cdots],\\,[\\cdots]]$.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It presents a standard exercise in the field of computational electrochemistry, specifically the analysis of reaction mechanisms using the Computational Hydrogen Electrode (CHE) model. All necessary parameters, definitions, and constraints are provided, and no contradictions or ambiguities are present. Therefore, I will proceed with a full solution.\n\nThe objective is to categorize each point on a grid of electrode potential ($U$) and acidity ($\\mathrm{pH}$) according to the potential-determining step (PDS) of a three-step Proton-Coupled Electron Transfer (PCET) reaction. The fractions of grid points belonging to each category are then computed for three distinct parameter sets.\n\nThe core of the problem lies in the CHE model, which provides a framework for calculating the free energy change, $\\Delta G_i$, of an elementary reaction step $i$ as a function of $U$ and $\\mathrm{pH}$. A reaction step given by\n$$ \\text{Reactants}_i \\rightarrow \\text{Products}_i + n_{e,i} e^- + n_{H,i} \\mathrm{H}^+ $$\nhas a reaction free energy defined as:\n$$ \\Delta G_i(U,\\mathrm{pH}) = \\Delta G_i^0 - n_{e,i} U - n_{H,i} \\lambda \\mathrm{pH} $$\nwhere $\\Delta G_i^0$ is the standard free energy change at the reference state ($U=0\\,\\mathrm{V}$, $\\mathrm{pH}=0$), $n_{e,i}$ is the number of electrons released, $n_{H,i}$ is the number of protons released, and $\\lambda$ is a thermodynamic factor. The problem statement uses a convention where $n_{e,i}$ and $n_{H,i}$ represent consumed species, which is equivalent to a sign change, but the provided formula $\\Delta G_i(U,\\mathrm{pH}) = \\Delta G_i^0 - n_{e,i} U - n_{H,i} \\lambda \\mathrm{pH}$ is the standard form when considering the work done on the system by the potentiostat and the chemical potential of protons. The factor $\\lambda$ is given by:\n$$ \\lambda = k_{\\mathrm{B}} T \\ln(10) $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant (in $\\mathrm{eV/K}$) and $T$ is the temperature in Kelvin. At $T = 298.15\\,\\mathrm{K}$ and using $k_{\\mathrm{B}} \\approx 8.617333 \\times 10^{-5}\\,\\mathrm{eV/K}$, we can compute $\\lambda \\approx 0.05916\\,\\mathrm{eV}$. This value quantifies the change in free energy per unit of $\\mathrm{pH}$.\n\nThe PDS is defined based on the thermodynamic landscape. An elementary step is energetically unfavorable, or \"uphill,\" if its reaction free energy is positive, i.e., $\\Delta G_i > 0$. The PDS is the most unfavorable step, corresponding to the one with the largest positive free energy. This represents the largest thermodynamic barrier in the reaction sequence under the simplifying assumption that activation barriers scale with reaction thermodynamics.\n\nThe algorithmic procedure to solve this problem is as follows:\n\n1.  **Define Constants and Grid**:\n    -   The Boltzmann constant, $k_{\\mathrm{B}}$, is set to its value in $\\mathrm{eV/K}$.\n    -   The temperature, $T$, is fixed at $298.15\\,\\mathrm{K}$.\n    -   The factor $\\lambda$ is computed.\n    -   A two-dimensional grid is constructed for the electrode potential, $U$, spanning $[0.0, 1.0]\\,\\mathrm{V}$ with increments of $0.1\\,\\mathrm{V}$ ($11$ points), and for the acidity, $\\mathrm{pH}$, spanning $[0, 14]$ with increments of $1$ ($15$ points). This results in a total of $11 \\times 15 = 165$ grid points.\n\n2.  **Iterate Through Test Cases**: The main logic is executed for each of the three provided parameter sets ($\\Delta G^0$, $n_e$, $n_H$).\n\n3.  **Calculate Free Energies**: For each test case, we compute the free energy $\\Delta G_i(U, \\mathrm{pH})$ for each step $i \\in \\{1, 2, 3\\}$ at every point $(U, \\mathrm{pH})$ on the grid. This is efficiently done using vectorized operations on the grid matrices. For each step $i$, a matrix of $\\Delta G_i$ values is generated, where the matrix dimensions correspond to the $\\mathrm{pH}$ and $U$ axes.\n\n4.  **Identify PDS Category at Each Grid Point**: At each $(U, \\mathrm{pH})$ point, we apply the rules for PDS determination:\n    a.  Identify the set of uphill steps, $\\mathcal{U} = \\{ i \\mid \\Delta G_i(U, \\mathrm{pH}) > 0 \\}$.\n    b.  **All-Downhill Case**: If $\\mathcal{U}$ is empty (all $\\Delta G_i \\le 0$), the point is classified as \"all-downhill\".\n    c.  **Uphill Case**: If $\\mathcal{U}$ is not empty, we find the maximum free energy among the uphill steps, $M = \\max_{i \\in \\mathcal{U}} \\Delta G_i$.\n    d.  We then identify all steps in $\\mathcal{U}$ whose free energy is within a small tolerance $\\epsilon = 10^{-12}\\,\\mathrm{eV}$ of this maximum, $M$.\n    e.  **Unique PDS**: If exactly one step $i^\\star$ satisfies this condition, it is designated as the PDS. The point is classified as \"PDS $i^\\star$\".\n    f.  **Tie Case**: If two or more steps satisfy the condition, the point is classified as a \"tie\".\n\n5.  **Compute and Report Fractions**: After classifying all $165$ grid points for a given test case, we count the number of points in each of the five categories (PDS 1, PDS 2, PDS 3, tie, all-downhill). These counts are then divided by the total number of grid points ($165$) to obtain the fraction for each category. The fractions are rounded to three decimal places.\n\nThis procedure is deterministic and computationally straightforward. The use of vectorized numerical libraries like NumPy is critical for an efficient and concise implementation, avoiding explicit loops over the grid points. The final output is an aggregation of the computed fraction lists for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Potential-Determining Step (PDS) distribution for a 3-step\n    PCET reaction sequence over a grid of electrode potential (U) and acidity (pH).\n    \"\"\"\n\n    # Physical constants and problem parameters\n    K_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    T = 298.15  # Temperature in K\n    LAMBDA = K_B * T * np.log(10)  # pH energy factor in eV\n    TOLERANCE = 1e-12  # Energy tolerance for tie detection in eV\n\n    # Grid definition\n    u_grid = np.arange(0.0, 1.01, 0.1)\n    ph_grid = np.arange(0, 15, 1)\n    total_grid_points = len(u_grid) * len(ph_grid)\n    \n    # Create a meshgrid for vectorized calculations\n    U_mesh, pH_mesh = np.meshgrid(u_grid, ph_grid)\n\n    # Test suite from the problem statement\n    test_cases = [\n        {\n            \"dg0\": np.array([1.00, 0.90, 1.20]),\n            \"ne\": np.array([1, 1, 1]),\n            \"nh\": np.array([1, 1, 1]),\n        },\n        {\n            \"dg0\": np.array([0.80, 0.90, 0.85]),\n            \"ne\": np.array([1, 1, 1]),\n            \"nh\": np.array([1, 0, 2]),\n        },\n        {\n            \"dg0\": np.array([0.50 + 5 * LAMBDA, 0.50, 0.60]),\n            \"ne\": np.array([1, 1, 1]),\n            \"nh\": np.array([1, 0, 1]),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        dg0_vals = case[\"dg0\"]\n        ne_vals = case[\"ne\"]\n        nh_vals = case[\"nh\"]\n\n        # Calculate Delta G for each step across the entire (U, pH) grid\n        # Shape of each delta_g matrix will be (len(ph_grid), len(u_grid))\n        delta_g1 = dg0_vals[0] - ne_vals[0] * U_mesh - nh_vals[0] * LAMBDA * pH_mesh\n        delta_g2 = dg0_vals[1] - ne_vals[1] * U_mesh - nh_vals[1] * LAMBDA * pH_mesh\n        delta_g3 = dg0_vals[2] - ne_vals[2] * U_mesh - nh_vals[2] * LAMBDA * pH_mesh\n\n        # Stack the three Delta G matrices for unified processing\n        # Shape of delta_g_stack will be (3, len(ph_grid), len(u_grid))\n        delta_g_stack = np.array([delta_g1, delta_g2, delta_g3])\n\n        # Identify uphill steps (Delta G > 0)\n        uphill_mask = delta_g_stack > 0\n\n        # Mask non-uphill steps with -inf to exclude them from max finding\n        masked_delta_g = np.where(uphill_mask, delta_g_stack, -np.inf)\n\n        # Find the maximum uphill Delta G at each grid point\n        max_g_per_point = np.max(masked_delta_g, axis=0)\n\n        # Check for all-downhill case (where max_g will be -inf)\n        is_all_downhill = np.isneginf(max_g_per_point)\n\n        # Check for ties: count how many steps are within TOLERANCE of the maximum\n        # is_max will be a boolean array of the same shape as delta_g_stack\n        is_max = (max_g_per_point - masked_delta_g) <= TOLERANCE\n        # tie_count_per_point will be a 2D array\n        tie_count_per_point = np.sum(is_max, axis=0)\n\n        # Identify the index of the PDS (0, 1, or 2)\n        pds_index_map = np.argmax(masked_delta_g, axis=0)\n        \n        # Define category indices: 0:PDS1, 1:PDS2, 2:PDS3, 3:tie, 4:all-downhill\n        category_map = np.full(U_mesh.shape, -1, dtype=int)\n\n        # Apply classification rules\n        # 1. All-downhill case\n        category_map[is_all_downhill] = 4\n        # 2. Tie case\n        category_map[~is_all_downhill & (tie_count_per_point > 1)] = 3\n        # 3. Unique PDS case\n        category_map[~is_all_downhill & (tie_count_per_point == 1)] = pds_index_map[~is_all_downhill & (tie_count_per_point == 1)]\n\n        # Count occurrences of each category\n        # minlength=5 ensures bins for all 5 categories, even if some don't occur\n        counts = np.bincount(category_map.flatten(), minlength=5)\n\n        # Calculate fractions and round to 3 decimal places\n        fractions = np.round(counts / total_grid_points, 3)\n\n        all_results.append(fractions.tolist())\n\n    # Format output string to match the required format precisely\n    # e.g., [[d.ddd,d.ddd,...],[...],...] with no spaces\n    result_strs = [f\"[{','.join(f'{f:.3f}' for f in res)}]\" for res in all_results]\n    final_output = f\"[{','.join(result_strs)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "While the thermodynamic PDS, identified by the highest free energy barrier, is a powerful and widely used approximation, a more rigorous understanding of reaction control comes from kinetics. This exercise  introduces the concept of the Degree of Rate Control (DRC), which formally quantifies how sensitive the overall reaction rate is to a change in the rate constant of a specific elementary step. By deriving and implementing a microkinetic model to calculate DRC values, you will learn to distinguish thermodynamic bottlenecks from the true kinetic rate-controlling steps, achieving a more sophisticated and accurate view of the reaction mechanism.",
            "id": "4248280",
            "problem": "Consider a minimal microkinetic model for an electrochemical sequence occurring on a uniform catalytic surface with a single type of site. The sequence consists of two irreversible elementary steps in series that share a single surface intermediate. The steps are: (1) formation of the surface intermediate by an anodic electron-transfer step that requires an empty site, and (2) chemical consumption of the intermediate that frees a site. Let the steps be\n$S + * \\xrightarrow{\\text{step }1} I$ and $I \\xrightarrow{\\text{step }2} P + *$, where $*$ denotes an empty site, $I$ a surface intermediate, and $S$ and $P$ are solution-phase species at fixed activities. Assume $S$ has unit activity and $P$ is removed as formed. Let the fractional coverages satisfy the site balance $ \\theta_* + \\theta_I = 1 $, and impose the steady-state condition that the net rate through both steps is equal.\n\nUse the following fundamental bases:\n- Arrhenius law: the temperature dependence of chemical step rate constants is given by $ k_{\\text{arr}}(T) = A \\exp\\!\\left(-\\dfrac{E_a}{R T}\\right) $, where $A$ is a pre-exponential factor, $E_a$ is an activation energy, $R$ is the ideal gas constant, and $T$ is the absolute temperature.\n- Butler–Volmer kinetics (specialized to a single-direction anodic electron transfer): the forward electron-transfer rate constant depends on electrode potential as $ k_{\\text{bv}}(U,T) = k_0 \\exp\\!\\left(\\dfrac{\\alpha F (U - U_{\\text{eq}})}{R T}\\right) $, where $k_0$ is a potential-independent prefactor, $\\alpha$ is the charge-transfer coefficient, $F$ is Faraday’s constant, $U$ is the electrode potential, $U_{\\text{eq}}$ is the equilibrium potential of the step, and $R$ and $T$ are as defined above.\n\nLet the elementary rate expressions be first order in the appropriate surface species:\n- Step $1$: $ r_1(U,T) = k_1(U,T)\\,\\theta_* $ with $ k_1(U,T) = k_0 \\exp\\!\\left(\\dfrac{\\alpha F (U - U_{\\text{eq}})}{R T}\\right) $.\n- Step $2$: $ r_2(T) = k_2(T)\\,\\theta_I $ with $ k_2(T) = A \\exp\\!\\left(-\\dfrac{E_a}{R T}\\right) $.\n\nAt steady state, the net rate $ r(U,T) $ satisfies $ r(U,T) = r_1(U,T) = r_2(T) $, and the site balance $ \\theta_* + \\theta_I = 1 $ holds. The current density is $ j(U,T) = n F\\, r(U,T) $ with $ n = 1 $ electron transferred in step $1$. Define the Degree of Rate Control (DRC) for step $i$ at potential $U$ as $ \\mathrm{DRC}_i(U) = \\dfrac{\\partial \\ln j(U)}{\\partial \\ln k_i(U)} $ evaluated with all other parameters held fixed. Because $ j(U,T) $ is proportional to $ r(U,T) $ with proportionality $ n F $, the DRCs computed with respect to $ j(U,T) $ are identical to those computed with respect to $ r(U,T) $.\n\nTasks:\n1. Starting from the fundamental bases above, derive the steady-state net rate $ r(U,T) $ in terms of $ k_1(U,T) $ and $ k_2(T) $, and then derive expressions for $ \\mathrm{DRC}_1(U) $ and $ \\mathrm{DRC}_2(U) $ in terms of $ k_1(U,T) $ and $ k_2(T) $ only. Do not assume any specific numerical values during the derivation.\n2. Implement a program that, for a discrete set of potentials $U$ within an operating window $[U_{\\min}, U_{\\max}]$, computes $ \\mathrm{DRC}_1(U) $ and $ \\mathrm{DRC}_2(U) $ for each $U$, then determines the potential-determining step over the window as the step whose average DRC over the sampled potentials is larger. If the average DRCs are equal within a numerical tolerance of $ \\varepsilon = 10^{-9} $, report no unique potential-determining step.\n3. Your program must use the constants $ R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $, $ F = 96485\\,\\mathrm{C\\,mol^{-1}} $, and compute at $ T = 298\\,\\mathrm{K} $ unless otherwise specified. Potentials $U$ must be in volts. DRCs are dimensionless. The output for each test case must be a list containing three values: the integer code for the identified potential-determining step ($1$ for step $1$, $2$ for step $2$, or $0$ for no unique step), followed by the average $ \\mathrm{DRC}_1 $ over the window (as a float) and the average $ \\mathrm{DRC}_2 $ over the window (as a float).\n4. Sample three potentials per operating window: $ U_{\\min} $, $ U_{\\text{mid}} = \\dfrac{U_{\\min} + U_{\\max}}{2} $, and $ U_{\\max} $.\n\nTest suite:\nProvide four scientifically distinct parameter sets to exercise different regimes. For each, compute the requested outputs at $ T = 298\\,\\mathrm{K} $:\n- Case $1$ (chemical step strongly limiting across the window): $ k_0 = 100\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.5 $, $ U_{\\text{eq}} = 0.6\\,\\mathrm{V} $, $ A = 10^{13}\\,\\mathrm{s^{-1}} $, $ E_a = 86000\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.6\\,\\mathrm{V} $, $ U_{\\max} = 0.9\\,\\mathrm{V} $.\n- Case $2$ (transition from electron-transfer limited to balanced at high potential): $ k_0 = 100\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.5 $, $ U_{\\text{eq}} = 0.6\\,\\mathrm{V} $, $ A = 2\\times 10^{13}\\,\\mathrm{s^{-1}} $, $ E_a = 50000\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.6\\,\\mathrm{V} $, $ U_{\\max} = 0.9\\,\\mathrm{V} $.\n- Case $3$ (electron-transfer step limiting across the window): $ k_0 = 10^{-3}\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.4 $, $ U_{\\text{eq}} = 0.7\\,\\mathrm{V} $, $ A = 10^{13}\\,\\mathrm{s^{-1}} $, $ E_a = 68685\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.6\\,\\mathrm{V} $, $ U_{\\max} = 0.9\\,\\mathrm{V} $.\n- Case $4$ (edge case: identical average DRCs across the window due to potential-independent electron-transfer kinetics): $ k_0 = 0.524\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.0 $, $ U_{\\text{eq}} = 0.7\\,\\mathrm{V} $, $ A = 10^{12}\\,\\mathrm{s^{-1}} $, $ E_a = 70000\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.4\\,\\mathrm{V} $, $ U_{\\max} = 1.0\\,\\mathrm{V} $.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, where each test case’s result is itself a bracketed comma-separated list in the order $[\\text{PDS\\_code}, \\overline{\\mathrm{DRC}_1}, \\overline{\\mathrm{DRC}_2}]$. For example, an output line of the correct shape is $[[1,0.75,0.25],[2,0.1,0.9],[1,0.95,0.05],[0,0.5,0.5]]$. All numbers in the output are unitless floats except the integer codes.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\n**Reaction Sequence:**\n- Step $1$ (anodic electron transfer): $S + * \\xrightarrow{\\text{step }1} I$\n- Step $2$ (chemical consumption): $I \\xrightarrow{\\text{step }2} P + *$\n\n**Assumptions and Conditions:**\n- Uniform catalytic surface with a single site type.\n- Two irreversible elementary steps in series.\n- Single surface intermediate $I$.\n- Solution-phase species $S$ and $P$ at fixed activities. Activity of $S$ is $1$.\n- Site balance: $ \\theta_* + \\theta_I = 1 $.\n- Steady-state condition: $ r = r_1 = r_2 $.\n- $n=1$ electron transferred in step $1$.\n\n**Rate Expressions:**\n- Step $1$: $ r_1(U,T) = k_1(U,T)\\,\\theta_* $\n- Step $2$: $ r_2(T) = k_2(T)\\,\\theta_I $\n\n**Rate Constant Expressions:**\n- $k_1(U,T) = k_0 \\exp\\!\\left(\\dfrac{\\alpha F (U - U_{\\text{eq}})}{R T}\\right) $ (Butler-Volmer)\n- $k_2(T) = A \\exp\\!\\left(-\\dfrac{E_a}{R T}\\right) $ (Arrhenius)\n\n**Definitions:**\n- Current density: $ j(U,T) = n F\\, r(U,T) $ with $ n=1 $.\n- Degree of Rate Control (DRC): $ \\mathrm{DRC}_i(U) = \\dfrac{\\partial \\ln j(U)}{\\partial \\ln k_i(U)} = \\dfrac{\\partial \\ln r(U)}{\\partial \\ln k_i(U)} $.\n\n**Numerical Constants and Conditions:**\n- $ R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $\n- $ F = 96485\\,\\mathrm{C\\,mol^{-1}} $\n- $ T = 298\\,\\mathrm{K} $\n- Potential sampling: $U_{\\min}$, $U_{\\text{mid}} = \\dfrac{U_{\\min} + U_{\\max}}{2}$, $U_{\\max}$.\n- Potential-Determining Step (PDS) criterion: The step with the larger average DRC over the sampled potentials.\n- Tolerance for equal average DRCs: $ \\varepsilon = 10^{-9} $.\n- PDS codes: $1$ for step $1$, $2$ for step $2$, $0$ for no unique step.\n\n**Test Cases ($T = 298\\,\\mathrm{K}$):**\n- Case $1$: $ k_0 = 100\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.5 $, $ U_{\\text{eq}} = 0.6\\,\\mathrm{V} $, $ A = 10^{13}\\,\\mathrm{s^{-1}} $, $ E_a = 86000\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.6\\,\\mathrm{V} $, $ U_{\\max} = 0.9\\,\\mathrm{V} $.\n- Case $2$: $ k_0 = 100\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.5 $, $ U_{\\text{eq}} = 0.6\\,\\mathrm{V} $, $ A = 2\\times 10^{13}\\,\\mathrm{s^{-1}} $, $ E_a = 50000\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.6\\,\\mathrm{V} $, $ U_{\\max} = 0.9\\,\\mathrm{V} $.\n- Case $3$: $ k_0 = 10^{-3}\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.4 $, $ U_{\\text{eq}} = 0.7\\,\\mathrm{V} $, $ A = 10^{13}\\,\\mathrm{s^{-1}} $, $ E_a = 68685\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.6\\,\\mathrm{V} $, $ U_{\\max} = 0.9\\,\\mathrm{V} $.\n- Case $4$: $ k_0 = 0.524\\,\\mathrm{s^{-1}} $, $ \\alpha = 0.0 $, $ U_{\\text{eq}} = 0.7\\,\\mathrm{V} $, $ A = 10^{12}\\,\\mathrm{s^{-1}} $, $ E_a = 70000\\,\\mathrm{J\\,mol^{-1}} $, $ U_{\\min} = 0.4\\,\\mathrm{V} $, $ U_{\\max} = 1.0\\,\\mathrm{V} $.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is built upon fundamental principles of chemical kinetics and electrochemistry, namely the Arrhenius law, Butler-Volmer kinetics, the steady-state approximation, and the concept of Degree of Rate Control. These are standard, well-established models in the field.\n- **Well-Posed**: The problem sets up a system of algebraic equations for which a unique analytical solution for the rate and DRCs can be derived. The subsequent numerical task is clearly defined with all necessary parameters provided, ensuring a single, stable solution for each test case. The criterion for identifying the potential-determining step is unambiguous.\n- **Objective**: The problem is stated in precise mathematical language, free from subjective or qualitative judgments.\n- **Incomplete or Contradictory Setup**: The problem is self-contained. All variables, constants, and functional forms required for both the analytical derivation and the numerical computation are explicitly provided. While the textual description for Case $4$ (\"identical average DRCs\") does not strictly match the outcome of a calculation with the provided parameters, this does not constitute a formal contradiction invalidating the problem. The numerical parameters and the computational rules are the definitive instructions, and they are consistent and complete, leading to a unique answer. The text is illustrative context, subordinate to the formal specification.\n- **Other Flaws**: The problem is formalizable, relevant to its stated topic, scientifically realistic within the context of a simplified model, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution Derivation and Algorithmic Design\n\n**Task 1: Derivation of the Steady-State Rate and Degree of Rate Control Expressions**\n\nFirst, we derive an expression for the steady-state net rate, $r$, as a function of the elementary rate constants $k_1$ and $k_2$. The system is governed by the following equations:\n1.  Steady-state condition: The net rates of the two steps are equal to the overall rate $r$.\n    $$r = r_1 = r_2$$\n2.  Elementary rate laws:\n    $$r_1 = k_1(U,T)\\,\\theta_*$$\n    $$r_2 = k_2(T)\\,\\theta_I$$\n3.  Site balance: The sum of fractional coverages of the empty site, $\\theta_*$, and the intermediate, $\\theta_I$, is unity.\n    $$\\theta_* + \\theta_I = 1$$\n\nFrom the rate laws and steady-state condition, we can express the coverages in terms of the rate $r$ and the rate constants:\n$$\\theta_* = \\frac{r}{k_1}$$\n$$\\theta_I = \\frac{r}{k_2}$$\n\nSubstituting these expressions into the site balance equation yields:\n$$\\frac{r}{k_1} + \\frac{r}{k_2} = 1$$\n\nFactoring out $r$ gives:\n$$r \\left( \\frac{1}{k_1} + \\frac{1}{k_2} \\right) = 1$$\n\nSolving for the steady-state rate $r$ results in:\n$$r = \\frac{1}{\\frac{1}{k_1} + \\frac{1}{k_2}} = \\frac{1}{\\frac{k_2 + k_1}{k_1 k_2}}$$\n$$r(U,T) = \\frac{k_1(U,T) \\, k_2(T)}{k_1(U,T) + k_2(T)}$$\n\nNext, we derive the expressions for the Degree of Rate Control (DRC) for each step. The DRC for step $i$ is defined as $\\mathrm{DRC}_i = \\frac{\\partial \\ln r}{\\partial \\ln k_i}$. Using the chain rule, this can be expressed as:\n$$\\mathrm{DRC}_i = \\frac{\\partial \\ln r}{\\partial k_i} \\frac{\\partial k_i}{\\partial \\ln k_i} = \\frac{1}{r} \\frac{\\partial r}{\\partial k_i} \\cdot k_i = \\frac{k_i}{r} \\frac{\\partial r}{\\partial k_i}$$\n\nTo find $\\mathrm{DRC}_1$, we first compute the partial derivative of $r$ with respect to $k_1$:\n$$\\frac{\\partial r}{\\partial k_1} = \\frac{\\partial}{\\partial k_1} \\left( \\frac{k_1 k_2}{k_1 + k_2} \\right) = \\frac{k_2(k_1 + k_2) - k_1 k_2 (1)}{(k_1 + k_2)^2} = \\frac{k_1 k_2 + k_2^2 - k_1 k_2}{(k_1 + k_2)^2} = \\frac{k_2^2}{(k_1 + k_2)^2}$$\nNow, we substitute this into the expression for $\\mathrm{DRC}_1$:\n$$\\mathrm{DRC}_1 = \\frac{k_1}{r} \\frac{\\partial r}{\\partial k_1} = \\frac{k_1}{\\frac{k_1 k_2}{k_1 + k_2}} \\cdot \\frac{k_2^2}{(k_1 + k_2)^2} = \\frac{k_1 (k_1 + k_2)}{k_1 k_2} \\cdot \\frac{k_2^2}{(k_1 + k_2)^2}$$\nSimplifying this expression yields the final form for $\\mathrm{DRC}_1$:\n$$\\mathrm{DRC}_1(U) = \\frac{k_2(T)}{k_1(U,T) + k_2(T)}$$\n\nTo find $\\mathrm{DRC}_2$, we follow the same procedure. The expression for $r$ is symmetric with respect to $k_1$ and $k_2$, so by analogy:\n$$\\frac{\\partial r}{\\partial k_2} = \\frac{k_1^2}{(k_1 + k_2)^2}$$\nSubstituting this into the expression for $\\mathrm{DRC}_2$:\n$$\\mathrm{DRC}_2 = \\frac{k_2}{r} \\frac{\\partial r}{\\partial k_2} = \\frac{k_2}{\\frac{k_1 k_2}{k_1 + k_2}} \\cdot \\frac{k_1^2}{(k_1 + k_2)^2} = \\frac{k_2 (k_1 + k_2)}{k_1 k_2} \\cdot \\frac{k_1^2}{(k_1 + k_2)^2}$$\nSimplifying this expression yields the final form for $\\mathrm{DRC}_2$:\n$$\\mathrm{DRC}_2(U) = \\frac{k_1(U,T)}{k_1(U,T) + k_2(T)}$$\n\nAs a check, we can verify that the derived DRCs satisfy the summation theorem, which states that for this system, $\\sum_i \\mathrm{DRC}_i = 1$.\n$$\\mathrm{DRC}_1 + \\mathrm{DRC}_2 = \\frac{k_2}{k_1 + k_2} + \\frac{k_1}{k_1 + k_2} = \\frac{k_1 + k_2}{k_1 + k_2} = 1$$\nThe derivation is consistent.\n\n**Tasks 2, 3, 4: Algorithmic Design for Numerical Computation**\n\nThe program will be structured to solve the problem for the four provided test cases.\n\n1.  **Constants and Parameters**: Global constants for $R$ and $F$ will be defined. The four test cases, each containing the set of parameters $\\{k_0, \\alpha, U_{\\text{eq}}, A, E_a, U_{\\min}, U_{\\max}\\}$, will be stored in a list. The temperature $T$ is fixed at $298\\,\\mathrm{K}$.\n\n2.  **Main Loop**: The program will iterate through each test case. For each case:\n    a.  **Potential Sampling**: A set of three potentials, $\\{U_{\\min}, (U_{\\min}+U_{\\max})/2, U_{\\max}\\}$, will be generated.\n    b.  **Rate Constant Calculation**: A loop will iterate through the sampled potentials.\n        i.  The rate constant $k_2$ is independent of potential $U$ and will be calculated once per test case using the Arrhenius equation: $k_2(T) = A \\exp(-E_a / (RT))$.\n        ii. For each potential $U$ in the sample set, the rate constant $k_1$ will be calculated using the Butler-Volmer equation: $k_1(U,T) = k_0 \\exp(\\alpha F (U - U_{\\text{eq}}) / (RT))$.\n    c.  **DRC Calculation**: For each potential $U$, the values of $\\mathrm{DRC}_1(U)$ and $\\mathrm{DRC}_2(U)$ will be calculated using the formulas derived in Task $1$:\n        $$\\mathrm{DRC}_1(U) = \\frac{k_2}{k_1(U,T) + k_2}$$\n        $$\\mathrm{DRC}_2(U) = \\frac{k_1(U,T)}{k_1(U,T) + k_2}$$\n        The calculated DRCs for each potential will be stored in separate lists.\n    d.  **Averaging and PDS Determination**:\n        i.  The average DRCs, $\\overline{\\mathrm{DRC}_1}$ and $\\overline{\\mathrm{DRC}_2}$, will be computed by taking the arithmetic mean of the stored DRC values.\n        ii. The potential-determining step (PDS) will be identified by comparing the average DRCs. Let $\\Delta = \\overline{\\mathrm{DRC}_1} - \\overline{\\mathrm{DRC}_2}$.\n            - If $\\Delta > \\varepsilon$, step $1$ is the PDS (code $1$).\n            - If $\\Delta < -\\varepsilon$, step $2$ is the PDS (code $2$).\n            - If $|\\Delta| \\le \\varepsilon = 10^{-9}$, there is no unique PDS (code $0$).\n    e.  **Storage**: The results for the current case—the PDS code, $\\overline{\\mathrm{DRC}_1}$, and $\\overline{\\mathrm{DRC}_2}$—will be stored in a list.\n\n3.  **Output Formatting**: After processing all test cases, the final list of results will be formatted into a single string as specified: `[[code1, avg_drc1, avg_drc2], [code2, ...], ...]`, and printed to standard output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a computational electrochemistry problem to identify the \n    potential-determining step (PDS) in a two-step reaction sequence.\n    \"\"\"\n    \n    # Constants\n    R = 8.314  # J mol^-1 K^-1\n    F = 96485  # C mol^-1\n    T = 298.0  # K\n    TOLERANCE = 1e-9\n\n    # Pre-calculate the thermal energy in J/mol\n    RT = R * T\n\n    # Test cases: (k0, alpha, U_eq, A, Ea, U_min, U_max)\n    # k0 in s^-1, U in V, A in s^-1, Ea in J/mol\n    test_cases = [\n        (100.0, 0.5, 0.6, 1e13, 86000.0, 0.6, 0.9),  # Case 1\n        (100.0, 0.5, 0.6, 2e13, 50000.0, 0.6, 0.9),  # Case 2\n        (1e-3, 0.4, 0.7, 1e13, 68685.0, 0.6, 0.9),  # Case 3\n        (0.524, 0.0, 0.7, 1e12, 70000.0, 0.4, 1.0),  # Case 4\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        k0, alpha, U_eq, A, Ea, U_min, U_max = case\n\n        # Generate the three sample potentials\n        U_mid = (U_min + U_max) / 2.0\n        potentials = [U_min, U_mid, U_max]\n\n        # Calculate k2 (constant for a given case as T is fixed)\n        # k2 = A * exp(-Ea / (R * T))\n        k2 = A * np.exp(-Ea / RT)\n\n        drc1_values = []\n        drc2_values = []\n\n        for U in potentials:\n            # Calculate k1 for the current potential U\n            # k1 = k0 * exp(alpha * F * (U - U_eq) / (R * T))\n            exponent_k1 = alpha * F * (U - U_eq) / RT\n            k1 = k0 * np.exp(exponent_k1)\n\n            # Calculate DRCs using the derived expressions\n            # DRC1 = k2 / (k1 + k2)\n            # DRC2 = k1 / (k1 + k2)\n            denominator = k1 + k2\n            drc1 = k2 / denominator\n            drc2 = k1 / denominator\n            \n            drc1_values.append(drc1)\n            drc2_values.append(drc2)\n\n        # Calculate average DRCs over the potential window\n        avg_drc1 = np.mean(drc1_values)\n        avg_drc2 = np.mean(drc2_values)\n\n        # Determine the Potential-Determining Step (PDS)\n        pds_code = 0  # Default to no unique PDS\n        if avg_drc1 > avg_drc2 + TOLERANCE:\n            pds_code = 1\n        elif avg_drc2 > avg_drc1 + TOLERANCE:\n            pds_code = 2\n            \n        case_result = [pds_code, avg_drc1, avg_drc2]\n        all_results.append(case_result)\n\n    # Format the final output string\n    # e.g., [[1, 0.9, 0.1], [2, 0.2, 0.8]]\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}