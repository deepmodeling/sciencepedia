{
    "hands_on_practices": [
        {
            "introduction": "过渡态理论的速率方程包含多个组成部分。透射系数 $\\kappa$ 是一个关键但常被简化的因子，它用于修正过渡态重穿越等动力学效应。本练习旨在揭示该系数的显著影响，并量化当采用 $\\kappa=1$ 这一常见但非普适的假设时所引入的计算误差 。",
            "id": "4261331",
            "problem": "考虑一个在恒定温度和恒定界面活度下的单步外层电化学电子转移反应，该反应在过渡态理论 (TST; Transition State Theory) 框架内进行分析。对过渡态穿越的动力学校正由透射系数 $\\kappa$ 描述。对该反应的显示分子动力学模拟表明 $\\kappa = 0.2$，而在常规实践中的简化计算流程则通过假设设定 $\\kappa = 1$。两种分析都使用相同的能垒自由能 $\\Delta G^{\\ddagger}$、相同的逆热能 $\\beta = 1/(k_{B}T)$，以及在电化学电流密度的机理表达式中，伴随 TST 速率常数的所有指前因子和热力学活度也均采用相同的值。\n\n从速率过程的过渡态理论公认基本原理以及基于基元电荷转移步骤速率常数的电流密度定义出发，推导在所述条件下电化学电流密度如何依赖于透射系数 $\\kappa$，然后确定因假设 $\\kappa = 1$ 而非采用显示动力学值 $\\kappa = 0.2$ 所导致的电流密度估算中的相对误差。将定义为 $(i_{\\mathrm{assumed}} - i_{\\mathrm{true}})/i_{\\mathrm{true}}$ 的相对误差以无量纲小数形式报告。无需四舍五入。",
            "solution": "该问题要求在过渡态理论 (TST) 框架内分析透射系数 $\\kappa$ 对电化学电流密度 $i$ 的影响。目标是首先推导 $i$ 对 $\\kappa$ 的依赖关系，然后计算当使用一个假设的 $\\kappa$ 值而非更精确的值时，$i$ 的相对误差。\n\n根据过渡态理论，基元反应步骤的广义速率常数 $k$ 由以下表达式给出：\n$$\nk = \\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{k_B T}\\right)\n$$\n在此方程中，$\\kappa$ 是透射系数，它校正了因过渡态的动力学重穿越而导致的 TST 速率。$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$h$ 是普朗克常数，$\\Delta G^{\\ddagger}$ 是反应步骤的活化吉布斯自由能。项 $\\beta = 1/(k_B T)$ 是逆热能。\n\n对于单步电化学电荷转移反应，电流密度 $i$ 与反应速率成正比，因此与速率常数 $k$ 成正比。例如，对于单电子还原反应 ($z=1$)，其阴极电流密度 $i_c$ 表示为：\n$$\ni_c = F c_{\\text{ox}} k_c\n$$\n其中 $F$ 是法拉第常数，$c_{\\text{ox}}$ 是电极界面处反应物种的活度，$k_c$ 是还原反应的电化学速率常数。阳极电流密度也存在类似的线性关系。\n\n题目说明，在所比较的两种情景之间，除了 $\\kappa$ 之外的所有因素都保持不变。这包括电流密度表达式中的指前因子（如 $F$ 和 $c_{\\text{ox}}$）以及 TST 表达式中除 $\\kappa$ 以外的各项（即 $k_B$、$T$、$h$ 和 $\\Delta G^{\\ddagger}$）。因此，我们可以将所有这些常数项归为一个比例常数 $C$：\n$$\nC = (\\text{prefactors for current}) \\times \\left( \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{k_B T}\\right) \\right)\n$$\n根据这个定义，电流密度 $i$ 与速率常数 $k$ 之间的关系变为 $i = (\\text{电流指前因子}) \\times k$。将 $k$ 的 TST 表达式代入，我们得到 $i$ 对 $\\kappa$ 的依赖关系：\n$$\ni = C \\kappa\n$$\n此推导表明，在指定条件下，电化学电流密度与透射系数成正比。\n\n接下来，我们计算电流密度估算值的相对误差。题目将此误差定义为 $\\frac{i_{\\mathrm{assumed}} - i_{\\mathrm{true}}}{i_{\\mathrm{true}}}$。\n\n“真实”电流密度 $i_{\\mathrm{true}}$ 对应于透射系数取自显示动力学模拟的情况，因此 $\\kappa_{\\mathrm{true}} = 0.2$。使用我们推导的关系式：\n$$\ni_{\\mathrm{true}} = C \\cdot \\kappa_{\\mathrm{true}} = C \\cdot 0.2\n$$\n\n“假设”电流密度 $i_{\\mathrm{assumed}}$ 对应于简化模型，其中透射系数被假设为理想值，因此 $\\kappa_{\\mathrm{assumed}} = 1$：\n$$\ni_{\\mathrm{assumed}} = C \\cdot \\kappa_{\\mathrm{assumed}} = C \\cdot 1\n$$\n\n现在我们将这些表达式代入相对误差的公式中：\n$$\n\\text{Fractional Error} = \\frac{i_{\\mathrm{assumed}} - i_{\\mathrm{true}}}{i_{\\mathrm{true}}} = \\frac{C \\cdot \\kappa_{\\mathrm{assumed}} - C \\cdot \\kappa_{\\mathrm{true}}}{C \\cdot \\kappa_{\\mathrm{true}}}\n$$\n比例常数 $C$ 从分子和分母中约去，表达式简化为：\n$$\n\\text{Fractional Error} = \\frac{\\kappa_{\\mathrm{assumed}} - \\kappa_{\\mathrm{true}}}{\\kappa_{\\mathrm{true}}}\n$$\n最后，我们代入给定的数值 $\\kappa_{\\mathrm{assumed}} = 1$ 和 $\\kappa_{\\mathrm{true}} = 0.2$：\n$$\n\\text{Fractional Error} = \\frac{1 - 0.2}{0.2} = \\frac{0.8}{0.2} = 4\n$$\n相对误差是一个无量纲值 $4$。这表示，与使用更精确的透射系数计算的值相比，$\\kappa=1$ 的简化假设导致电流密度被高估了 $400\\%$。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "计算电化学的一个主要应用是从第一性原理计算中预测反应速率。本练习提供了一个计算交换电流密度 $i_0$ 的完整工作流程，从密度泛函理论（DFT）能量出发，并包含所有必需的热化学修正（零点能、焓和熵），以构建活化吉布斯自由能 $\\Delta G^\\ddagger$ 。通过本练习，您将把量子化学计算的输出与宏观电化学的关键可观测量联系起来。",
            "id": "4261289",
            "problem": "给定一组来自密度泛函理论(DFT)计算的、依赖于电势的能量，该能量数据是针对在金属电极上发生的、包含吸附反应物、吸附过渡态和吸附产物的单电子表面电化学反应。您的任务是，对于所提供的测试套件中的每种情况，使用过渡态理论(TST)计算交换电流密度 $i_0$，并明确地将零点能、焓和熵的贡献包含在活化自由能垒 $\\Delta G^\\ddagger(U)$ 中。\n\n使用以下科学基础作为出发点：\n- 过渡态理论(TST)的 Eyring 公式将速率常数与活化自由能垒及基本常数联系起来。\n- 将DFT能量与热化学量相结合时，需要在电子伏特和焦耳之间进行转换。\n- 对于多相表面反应，通过使用基本电荷化学计量数和法拉第常数，将单位面积的反应速率转换为单位面积的电流密度。\n\n为每个测试用例计算：\n1. 由依赖于电势的DFT能量和热化学修正构建的活化自由能垒 $\\Delta G^\\ddagger(U)$。\n2. 在温度 $T$ 下，使用物理上一致的单位计算出的正向 TST 速率常数。\n3. 假设透射系数为 $\\kappa$、转移电子数为 $n$，使用吸附反应物的覆盖度和位点密度计算正向反应的交换电流密度 $i_0$。\n\n所有DFT能量均以每个分子的电子伏特为单位给出，零点能和焓修正在以每个分子的电子伏特为单位给出，熵差以每摩尔的焦耳每开尔文为单位给出。温度以开尔文为单位给出。表面覆盖度是无量纲的，位点密度以摩尔每平方米为单位给出。以安培每平方米为单位计算最终的交换电流密度。将每个最终数值答案以安培每平方米(A/m$^2$)表示，并四舍五入到六位小数。\n\n使用的常数：\n- 玻尔兹曼常数：$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ J/K。\n- 普朗克常数：$h = 6.62607015 \\times 10^{-34}$ J·s。\n- 法拉第常数：$F = 96485.33212$ C/mol。\n- 用于将电子伏特转换为焦耳的基本电荷：$1$ eV $= 1.602176634 \\times 10^{-19}$ J。\n- 阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}$ mol$^{-1}$。\n\n本问题的定义：\n- 电势 $U$ 下的活化自由能垒：$\\Delta G^\\ddagger(U)$ 是过渡态和反应物自由能之间的差值，包括在温度 $T$ 下给定的零点能差、焓差和熵差贡献。\n- 正向速率常数：$k_f(U)$ 是使用 $\\Delta G^\\ddagger(U)$ 计算的 TST 速率常数。\n- 交换电流密度：$i_0(U)$ 是根据平衡覆盖度下的正向速率和表面反应物布居计算得出，并通过法拉第常数和电子化学计量数转换为电流。\n\n单位和转换：\n- 在计算 $\\Delta G^\\ddagger(U)$ 时，将所有能量项统一以焦耳/分子为单位进行组合。\n- 使用 $N_{\\mathrm{A}}$ 将熵差从焦耳/摩尔/开尔文转换为焦耳/分子/开尔文。\n- 最终输出必须是以 A/m$^2$ 为单位的交换电流密度。\n\n您的程序应处理以下测试套件。每个元组包含：\n- 电势 $U$ (伏特)，\n- 反应物能量 $E_{\\mathrm{R}}(U)$ (eV)，\n- 过渡态能量 $E_{\\mathrm{TS}}(U)$ (eV)，\n- 产物能量 $E_{\\mathrm{P}}(U)$ (eV)，\n- 零点能差 $\\Delta \\mathrm{ZPE}^\\ddagger$ (eV)，\n- 焓差 $\\Delta H^\\ddagger$ (eV)，\n- 熵差 $\\Delta S^\\ddagger$ (J/(mol·K))，\n- 温度 $T$ (K)，\n- 反应物覆盖度 $\\theta_{\\mathrm{R}}$ (无量纲)，\n- 位点密度 $\\Gamma_{\\max}$ (mol/m$^2$)，\n- 透射系数 $\\kappa$ (无量纲)，\n- 转移电子数 $n$ (无量纲)。\n\n测试套件：\n- 情况1：$U = 0.00$ V, $E_{\\mathrm{R}}(U) = -5.10$ eV, $E_{\\mathrm{TS}}(U) = -4.50$ eV, $E_{\\mathrm{P}}(U) = -5.40$ eV, $\\Delta \\mathrm{ZPE}^\\ddagger = 0.05$ eV, $\\Delta H^\\ddagger = 0.02$ eV, $\\Delta S^\\ddagger = -15$ J/(mol·K), $T = 298$ K, $\\theta_{\\mathrm{R}} = 0.50$, $\\Gamma_{\\max} = 2.50 \\times 10^{-5}$ mol/m$^2$, $\\kappa = 1.00$, $n = 1$。\n- 情况2：$U = 0.20$ V, $E_{\\mathrm{R}}(U) = -5.05$ eV, $E_{\\mathrm{TS}}(U) = -4.55$ eV, $E_{\\mathrm{P}}(U) = -5.35$ eV, $\\Delta \\mathrm{ZPE}^\\ddagger = 0.04$ eV, $\\Delta H^\\ddagger = 0.01$ eV, $\\Delta S^\\ddagger = -12$ J/(mol·K), $T = 298$ K, $\\theta_{\\mathrm{R}} = 0.30$, $\\Gamma_{\\max} = 2.50 \\times 10^{-5}$ mol/m$^2$, $\\kappa = 1.00$, $n = 1$。\n- 情况3：$U = -0.20$ V, $E_{\\mathrm{R}}(U) = -5.20$ eV, $E_{\\mathrm{TS}}(U) = -4.60$ eV, $E_{\\mathrm{P}}(U) = -5.25$ eV, $\\Delta \\mathrm{ZPE}^\\ddagger = 0.03$ eV, $\\Delta H^\\ddagger = 0.00$ eV, $\\Delta S^\\ddagger = +5$ J/(mol·K), $T = 298$ K, $\\theta_{\\mathrm{R}} = 0.90$, $\\Gamma_{\\max} = 2.50 \\times 10^{-5}$ mol/m$^2$, $\\kappa = 1.00$, $n = 1$。\n- 情况4（覆盖度接近零且能垒高的边缘情况）：$U = 0.10$ V, $E_{\\mathrm{R}}(U) = -5.00$ eV, $E_{\\mathrm{TS}}(U) = -4.00$ eV, $E_{\\mathrm{P}}(U) = -5.10$ eV, $\\Delta \\mathrm{ZPE}^\\ddagger = 0.02$ eV, $\\Delta H^\\ddagger = 0.00$ eV, $\\Delta S^\\ddagger = -20$ J/(mol·K), $T = 298$ K, $\\theta_{\\mathrm{R}} = 0.01$, $\\Gamma_{\\max} = 2.50 \\times 10^{-5}$ mol/m$^2$, $\\kappa = 1.00$, $n = 1$。\n\n您的程序应生成单行输出，其中包含所有测试用例的交换电流密度，格式为逗号分隔的列表，并用方括号括起来，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是一个浮点数，格式化为六位小数，单位为 A/m$^2$。",
            "solution": "该问题要求计算单电子表面电化学反应的交换电流密度，记为 $i_0$。计算需要基于过渡态理论(TST)以及源自密度泛函理论(DFT)计算的数据，并辅以热化学修正。有必要基于物理化学和电化学的基本原理进行系统、分步的推导。问题提供了产物态能量 $E_{\\mathrm{P}}(U)$，但在计算正向反应速率（即指定任务）时并未使用到它。该值与分析逆向反应速率或反应自由能相关。\n\n计算过程主要分为三个阶段：\n1.  确定活化吉布斯自由能 $\\Delta G^\\ddagger(U)$。\n2.  通过 Eyring-Polanyi 方程计算正向速率常数 $k_f(U)$。\n3.  将反应速率转换为电流密度 $i_0$。\n\n**1. 活化自由能垒 $\\Delta G^\\ddagger(U)$**\n\n活化吉布斯自由能 $\\Delta G^\\ddagger(U)$ 是过渡态的吉布斯自由能 $G^\\ddagger(U)$ 与反应物态的吉布斯自由能 $G_R(U)$ 之差。在统计力学和计算化学的框架内，吸附物种的吉布斯自由能近似为其总电子能、零点振动能(ZPE)、其他焓贡献($H_{corr}$)和熵贡献($-TS$)的总和。\n\n因此，活化能垒为：\n$$\n\\Delta G^\\ddagger(U) = G^\\ddagger(U) - G_R(U)\n$$\n展开此表达式：\n$$\n\\Delta G^\\ddagger(U) = (E_{\\mathrm{TS}}(U) + \\mathrm{ZPE}_{\\mathrm{TS}} + H_{corr, \\mathrm{TS}}) - T S_{\\mathrm{TS}} - (E_{\\mathrm{R}}(U) + \\mathrm{ZPE}_{\\mathrm{R}} + H_{corr, \\mathrm{R}} - T S_{\\mathrm{R}})\n$$\n这可以按过渡态和反应物态之间的差异进行分组：\n$$\n\\Delta G^\\ddagger(U) = (E_{\\mathrm{TS}}(U) - E_{\\mathrm{R}}(U)) + (\\mathrm{ZPE}_{\\mathrm{TS}} - \\mathrm{ZPE}_{\\mathrm{R}}) + (H_{corr, \\mathrm{TS}} - H_{corr, \\mathrm{R}}) - T(S_{\\mathrm{TS}} - S_{\\mathrm{R}})\n$$\n使用问题陈述中提供的符号：\n$$\n\\Delta G^\\ddagger(U) = \\Delta E_{el}^\\ddagger(U) + \\Delta \\mathrm{ZPE}^\\ddagger + \\Delta H^\\ddagger - T\\Delta S^\\ddagger\n$$\n这里，$\\Delta E_{el}^\\ddagger(U) = E_{\\mathrm{TS}}(U) - E_{\\mathrm{R}}(U)$ 是与电势相关的电子能垒。为确保量纲一致性，所有能量项必须转换为统一单位，我们选择焦耳/分子。DFT能量、$\\Delta \\mathrm{ZPE}^\\ddagger$ 和 $\\Delta H^\\ddagger$ 以电子伏特(eV)给出，而熵差 $\\Delta S^\\ddagger$ 以 J/(mol·K) 给出。我们使用提供的转换常数：$e_{conv} = 1.602176634 \\times 10^{-19}$ J/eV 和阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}$ mol$^{-1}$。\n\n能垒的焓部分，单位为焦耳：\n$$\n\\Delta H_{total}^\\ddagger = [ (E_{\\mathrm{TS}}(U) - E_{\\mathrm{R}}(U)) + \\Delta \\mathrm{ZPE}^\\ddagger + \\Delta H^\\ddagger ] \\times e_{conv}\n$$\n能垒的熵部分，单位为焦耳：\n$$\n-T\\Delta S^\\ddagger_{molecule} = -T \\frac{\\Delta S^\\ddagger_{molar}}{N_{\\mathrm{A}}}\n$$\n每个分子活化自由能垒的完整表达式（单位为焦耳）是：\n$$\n\\Delta G^\\ddagger(U) = \\left[ (E_{\\mathrm{TS}}(U) - E_{\\mathrm{R}}(U)) + \\Delta \\mathrm{ZPE}^\\ddagger + \\Delta H^\\ddagger \\right] \\times e_{conv} - T \\frac{\\Delta S^\\ddagger}{N_{\\mathrmA}}}\n$$\n\n**2. 正向速率常数 $k_f(U)$**\n\n源自TST的 Eyring-Polanyi 方程将反应速率常数与其活化自由能关联起来：\n$$\nk_f(U) = \\kappa \\frac{k_{\\mathrm{B}} T}{h} \\exp\\left( - \\frac{\\Delta G^\\ddagger(U)}{k_{\\mathrm{B}} T} \\right)\n$$\n在此方程中：\n- $k_f(U)$ 是一级速率常数，单位为 s$^{-1}$。\n- $\\kappa$ 是透射系数，给定为 $1.00$。\n- $k_{\\mathrm{B}}$ 是玻尔兹曼常数 ($1.380649 \\times 10^{-23}$ J/K)。\n- $T$ 是绝对温度，单位为开尔文。\n- $h$ 是普朗克常数 ($6.62607015 \\times 10^{-34}$ J·s)。\n- $\\Delta G^\\ddagger(U)$ 是每个分子的活化自由能，如上所述。\n\n项 $k_{\\mathrm{B}}T/h$ 代表越过能垒的特征频率。指数项是拥有足够热能以克服能垒的概率。\n\n**3. 交换电流密度 $i_0$**\n\n问题要求计算正向电流密度，并将其称为 $i_0$。这是根据正向反应的速率计算的。单位面积的反应速率 $v_f$ 是速率常数 $k_f$ 和反应物的表面浓度 $\\Gamma_R$ 的乘积。\n\n反应物的表面浓度（单位为 mol/m$^2$）由以下公式给出：\n$$\n\\Gamma_R = \\theta_R \\Gamma_{max}\n$$\n其中 $\\theta_R$ 是反应物的无量纲表面覆盖度，$\\Gamma_{max}$ 是最大位点密度，单位为 mol/m$^2$。\n\n因此，单位面积的反应速率（单位为 mol m$^{-2}$ s$^{-1}$）是：\n$$\nv_f = k_f(U) \\cdot \\Gamma_R = k_f(U) \\cdot \\theta_R \\cdot \\Gamma_{max}\n$$\n每个反应事件涉及 $n$ 个电子的转移。每摩尔反应通过的总电荷是 $n \\times F$，其中 $F$ 是法拉第常数 ($96485.33212$ C/mol)。电流密度 $i_0$（单位为 A/m$^2$，等同于 C s$^{-1}$ m$^{-2}$）则为：\n$$\ni_0 = n F v_f = n F k_f(U) \\theta_R \\Gamma_{max}\n$$\n代入 $k_f(U)$ 的表达式，我们得到用于实现的最终公式：\n$$\ni_0 = n F \\left( \\kappa \\frac{k_{\\mathrm{B}} T}{h} \\exp\\left( - \\frac{\\Delta G^\\ddagger(U)}{k_{\\mathrm{B}} T} \\right) \\right) \\theta_R \\Gamma_{max}\n$$\n这个综合公式概括了 TST 和电化学的原理，允许从提供的参数直接计算电流密度。以下 Python 程序实现了该公式，以解决给定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the exchange current density for a series of electrochemical\n    reaction cases using Transition State Theory.\n    \"\"\"\n    # Define physical and mathematical constants with high precision.\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    H = 6.62607015e-34   # Planck constant in J·s\n    F_CONST = 96485.33212 # Faraday constant in C/mol\n    EV_TO_J = 1.602176634e-19 # Conversion factor from electronvolts to Joules\n    NA = 6.02214076e23   # Avogadro constant in mol^-1\n\n    def calculate_exchange_current_density(U, E_R, E_TS, E_P, dZPE, dH, dS, T, theta_R, Gamma_max, kappa, n):\n        \"\"\"\n        Calculates the exchange current density for a single case.\n\n        The problem defines this as the forward current density, computed from the\n        forward reaction rate.\n\n        Args:\n            U (float): Potential in volts.\n            E_R (float): Reactant energy at U in eV.\n            E_TS (float): Transition state energy at U in eV.\n            E_P (float): Product energy at U in eV (unused for forward rate).\n            dZPE (float): Zero-point energy difference (TS - R) in eV.\n            dH (float): Enthalpy difference (TS - R) in eV.\n            dS (float): Entropy difference (TS - R) in J/(mol·K).\n            T (float): Temperature in Kelvin.\n            theta_R (float): Reactant coverage (dimensionless).\n            Gamma_max (float): Site density in mol/m^2.\n            kappa (float): Transmission coefficient (dimensionless).\n            n (int): Number of electrons transferred.\n\n        Returns:\n            float: The calculated exchange current density in A/m^2.\n        \"\"\"\n        # Step 1: Calculate the activation free energy barrier ΔG‡(U) per molecule in Joules.\n        # The barrier is given by ΔG‡ = ΔE_el + ΔZPE + ΔH - TΔS.\n\n        # Electronic energy barrier from DFT energies (TS - R) in eV.\n        dE_el_eV = E_TS - E_R\n        \n        # Enthalpic part of the barrier (ΔE_el + ΔZPE + ΔH), converted to Joules per molecule.\n        dG_enthalpy_part_J = (dE_el_eV + dZPE + dH) * EV_TO_J\n        \n        # Entropic part of the barrier (-TΔS).\n        # dS is given in J/(mol·K), so convert to J/(molecule·K) by dividing by NA.\n        dS_molecule = dS / NA\n        dG_entropy_part_J = -T * dS_molecule\n        \n        # Total activation free energy barrier per molecule in Joules.\n        dG_barrier_J = dG_enthalpy_part_J + dG_entropy_part_J\n\n        # Step 2: Calculate the forward TST rate constant k_f(U).\n        # The Eyring-Polanyi equation is k_f = κ * (kB * T / h) * exp(-ΔG‡ / (kB * T)).\n\n        # Thermal energy term\n        kb_T_J = KB * T\n        \n        # Pre-exponential factor from TST in s^-1.\n        pre_exp = kappa * kb_T_J / H\n        \n        # Argument for the exponential term.\n        exp_arg = -dG_barrier_J / kb_T_J\n        \n        # Calculate the rate constant k_f in s^-1.\n        k_f = pre_exp * np.exp(exp_arg)\n        \n        # Step 3: Calculate the exchange current density i_0.\n        # i_0 = n * F * k_f * θ_R * Γ_max\n        # Units: (C/mol) * (s^-1) * (mol/m^2) = C / (s * m^2) = A/m^2\n        \n        i_0 = n * F_CONST * k_f * theta_R * Gamma_max\n        \n        return i_0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (U, E_R, E_TS, E_P, dZPE, dH, dS, T, theta_R, Gamma_max, kappa, n)\n        (0.00, -5.10, -4.50, -5.40, 0.05, 0.02, -15, 298, 0.50, 2.50e-5, 1.00, 1),\n        (0.20, -5.05, -4.55, -5.35, 0.04, 0.01, -12, 298, 0.30, 2.50e-5, 1.00, 1),\n        (-0.20, -5.20, -4.60, -5.25, 0.03, 0.00, 5, 298, 0.90, 2.50e-5, 1.00, 1),\n        (0.10, -5.00, -4.00, -5.10, 0.02, 0.00, -20, 298, 0.01, 2.50e-5, 1.00, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        i_0 = calculate_exchange_current_density(*case)\n        results.append(f\"{i_0:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "电化学反应速率对电极电势高度敏感，这种依赖关系由电荷转移系数 $\\alpha$ 来描述。最后一个练习将指导您设计一个方案，使用有限差分法直接从依赖于电势的能垒计算中求得 $\\alpha$ 。更重要的是，本练习还将介绍一项关键的研究技能：如何将原始模拟数据中的数值不确定性传播到最终派生的物理参数中。",
            "id": "4261330",
            "problem": "您被要求设计并实现一个协议，用于在巨正则系综条件下，根据过渡态理论（TST）从依赖于电势的过渡态势垒 $ \\Delta \\Omega^\\ddagger(\\phi) $ 计算电化学反应的电化学传递系数 $ \\alpha $。该协议必须从一个有效的基础原理出发，并且其推导过程不能依赖于简化公式。设计中必须包含一个基于有限差分法的 $ \\alpha $ 原则性估算量，该方法使用在两个相近电极电势下的计算结果；同时，还需要包含一个由 $ \\Delta \\Omega^\\ddagger $ 中的数值噪声引起的不确定度估计，该不确定度通过重复计算来估算。\n\n使用的基本原理：\n- 过渡态理论（TST）和巨正则系综意味着速率常数 $ k(\\phi) $ 通过 Eyring–Polanyi 形式呈指数依赖于巨势垒 $ \\Delta \\Omega^\\ddagger(\\phi) $，$ k(\\phi) \\propto \\exp\\left( - \\Delta \\Omega^\\ddagger(\\phi) / (k_\\mathrm{B} T) \\right) $，其中 $ k_\\mathrm{B} $ 是玻尔兹曼常数，$ T $ 是绝对温度。\n- 电化学传递系数 $ \\alpha $ 在概念上定义为势垒 $ \\Delta \\Omega^\\ddagger(\\phi) $ 对电子电化学能 $ e \\phi $ 的敏感度，即 $ \\alpha = - \\frac{\\partial \\Delta \\Omega^\\ddagger}{\\partial (e \\phi)} $，其中 $ e $ 是元电荷，$ \\phi $ 是电极电势。\n- 电子伏特和伏特的单位转换原则：$ 1 \\ \\mathrm{eV} = e \\times 1 \\ \\mathrm{V} $，这意味着对于单个电子，以电子伏特表示的 $ e \\phi $ 差异在数值上等于以伏特表示的 $ \\phi $ 差异。\n\n要求：\n1. 从上述基本原理出发，推导一个 $ \\alpha $ 的估算量。该估算量使用两个相近电势以及在每个电势下的重复势垒值来估计 $ \\Delta \\Omega^\\ddagger(\\phi) $ 及其数值不确定度。\n2. 将该协议实现为一个完整的程序，该程序接收一个提供的包含电势和势垒重复值的测试集，为每种情况计算 $ \\alpha $，并输出 $ \\alpha $ 及其不确定度估计。将不同电势下的数值噪声视为独立的，并使用重复值的变化来估计每个电势下平均势垒的不确定度。使用 $ \\Delta \\Omega^\\ddagger $ 以电子伏特（$ \\mathrm{eV} $）给出、$ \\phi $ 以伏特（$ \\mathrm{V} $）给出的约定。将 $ \\alpha $ 表示为无量纲数。不确定度必须表示为与 $ \\alpha $ 相同单位的浮点数。\n3. 估算量必须是鲁棒的，并且能从基本原理得到科学合理的解释。不确定度传播必须与独立的数值噪声和重复计算的均值标准误相一致。\n\n数据与单位：\n- 势垒能量 $ \\Delta \\Omega^\\ddagger $ 以 $ \\mathrm{eV} $ 为单位提供。\n- 电势 $ \\phi $ 以 $ \\mathrm{V} $ 为单位提供。\n- 输出的 $ \\alpha $ 必须是无量纲的。$ \\alpha $ 的不确定度也必须是无量纲的。\n- 不涉及角度或百分比。\n- 不需要温度和指前因子，因为只要求势垒对电势的敏感度。\n\n测试集：\n对于每个测试用例，给定 $ \\phi_1 $、$ \\phi_2 $、在 $ \\phi_1 $ 处的一系列重复势垒值，以及在 $ \\phi_2 $ 处的一系列重复势垒值。\n\n- 案例1（理想情况，中等 $ \\Delta \\phi $，低噪声）：\n  $ \\phi_1 = 0.50 \\ \\mathrm{V} $，$ \\phi_2 = 0.55 \\ \\mathrm{V} $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_1) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.800, 0.802, 0.799, 0.801, 0.800] $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_2) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.775, 0.776, 0.774, 0.775, 0.775] $。\n\n- 案例2（接近零的斜率，中等 $ \\Delta \\phi $，中等噪声）：\n  $ \\phi_1 = -0.20 \\ \\mathrm{V} $，$ \\phi_2 = -0.25 \\ \\mathrm{V} $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_1) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.649, 0.651, 0.652, 0.650, 0.648] $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_2) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.650, 0.651, 0.649, 0.650, 0.651] $。\n\n- 案例3（极小的 $ \\Delta \\phi $，低噪声但放大的不确定度）：\n  $ \\phi_1 = 0.500 \\ \\mathrm{V} $，$ \\phi_2 = 0.501 \\ \\mathrm{V} $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_1) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.8000, 0.8005, 0.7995, 0.8001, 0.7999] $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_2) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.7994, 0.7996, 0.7992, 0.7995, 0.7997] $。\n\n- 案例4（接近1的大斜率，较大的 $ \\Delta \\phi $，低噪声）：\n  $ \\phi_1 = 0.10 \\ \\mathrm{V} $，$ \\phi_2 = 0.18 \\ \\mathrm{V} $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_1) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.5005, 0.4998, 0.5002, 0.5000, 0.4995] $，\n  $ \\Delta \\Omega^\\ddagger(\\phi_2) $ 的重复值（单位 $ \\mathrm{eV} $）：$ [0.4284, 0.4279, 0.4282, 0.4281, 0.4280] $。\n\n最终输出规格：\n- 对于每种情况，计算并返回一个列表 $ [\\alpha, \\sigma_\\alpha] $，其中 $ \\alpha $ 是估计的传递系数，$ \\sigma_\\alpha $ 是其由数值噪声引起的不确定度估计，两者均四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个案例由其自己的方括号列表表示。例如：$ [[\\alpha_1,\\sigma_{\\alpha,1}],[\\alpha_2,\\sigma_{\\alpha,2}],\\dots] $。\n\n注意：\n- 对于给定案例，您不得假设两个电势之间的数值噪声存在任何相关性；应将其视为独立的。\n- 您的推导和实现必须仅依赖于所述的基本原理和定义，不得引入额外的简化公式。",
            "solution": "该问题是有效的。它在科学上基于过渡态理论应用于电化学的原理，其提法是恰当的，具有一套完整且一致的定义和数据，并且表述客观。可以基于所提供的信息推导并实现一个严谨的解决方案。\n\n目标是制定并实现一个协议，用于从数值数据中计算电化学传递系数 $ \\alpha $ 及其相关不确定度 $ \\sigma_\\alpha $。该协议从基本原理推导而来。\n\n**1. 传递系数 $ \\alpha $ 估算量的推导**\n\n传递系数 $ \\alpha $ 定义为巨势活化能垒 $ \\Delta \\Omega^\\ddagger $ 对电子电化学能 $ e \\phi $ 的敏感度，其中 $ e $ 是元电荷，$ \\phi $ 是电极电势。在数学上，这表示为一个偏导数：\n$$\n\\alpha = - \\frac{\\partial \\Delta \\Omega^\\ddagger}{\\partial (e \\phi)}\n$$\n问题要求基于在两个相近电势 $ \\phi_1 $ 和 $ \\phi_2 $ 下的计算来估算 $ \\alpha $。导数可以用有限差分公式来近似。对于函数 $ f(x) $，在 $ x_1 $ 和 $ x_2 $ 之间的某一点的导数 $ \\frac{df}{dx} $ 可由割线的斜率近似：\n$$\n\\frac{df}{dx} \\approx \\frac{f(x_2) - f(x_1)}{x_2 - x_1}\n$$\n将此近似应用于 $ \\alpha $ 的定义，我们将 $ f $ 对应于 $ \\Delta \\Omega^\\ddagger $，$ x $ 对应于 $ e \\phi $。这得到：\n$$\n\\alpha \\approx - \\frac{\\Delta \\Omega^\\ddagger(\\phi_2) - \\Delta \\Omega^\\ddagger(\\phi_1)}{e \\phi_2 - e \\phi_1} = - \\frac{\\Delta \\Omega^\\ddagger(\\phi_2) - \\Delta \\Omega^\\ddagger(\\phi_1)}{e (\\phi_2 - \\phi_1)}\n$$\n问题规定势垒能量 $ \\Delta \\Omega^\\ddagger $ 以电子伏特（$ \\mathrm{eV} $）给出，电势 $ \\phi $ 以伏特（$ \\mathrm{V} $）给出。根据提供的单位转换原则，$ 1 \\ \\mathrm{eV} = e \\times 1 \\ \\mathrm{V} $。这意味着以焦耳为单位的能量差 $ e \\times \\Delta \\phi $ 在以 $ \\mathrm{eV} $ 为单位表示时，其数值等于 $ \\Delta \\phi $。因此，如果电势差 $ \\phi_2 - \\phi_1 $ 以伏特表示，则分母 $ e(\\phi_2 - \\phi_1) $ 的数值在 $ \\mathrm{eV} $ 单位下为 $ (\\phi_2 - \\phi_1) $。由于分子 $ \\Delta \\Omega^\\ddagger(\\phi_2) - \\Delta \\Omega^\\ddagger(\\phi_1) $ 也以 $ \\mathrm{eV} $ 为单位，单位相互抵消，使得 $ \\alpha $ 成为无量纲数，符合要求。数值计算简化为：\n$$\n\\alpha \\approx - \\frac{(\\Delta \\Omega^\\ddagger_2)_{\\mathrm{in \\ eV}} - (\\Delta \\Omega^\\ddagger_1)_{\\mathrm{in \\ eV}}}{(\\phi_2)_{\\mathrm{in \\ V}} - (\\phi_1)_{\\mathrm{in \\ V}}} = \\frac{\\Delta \\Omega^\\ddagger_1 - \\Delta \\Omega^\\ddagger_2}{\\phi_2 - \\phi_1}\n$$\n问题在每个电势下提供了多个势垒的重复值，这反映了数值噪声。真实势垒 $ \\Delta \\Omega^\\ddagger(\\phi_i) $ 的最佳估计是其 $ N_i $ 个重复值 $ \\{ \\Delta \\Omega^\\ddagger_{i,j} \\}_{j=1}^{N_i} $ 的样本均值：\n$$\n\\overline{\\Delta \\Omega_i^\\ddagger} = \\frac{1}{N_i} \\sum_{j=1}^{N_i} \\Delta \\Omega^\\ddagger_{i,j}\n$$\n将这些平均值代入 $ \\alpha $ 的近似公式中，我们得到最终的估算量：\n$$\n\\alpha_{est} = \\frac{\\overline{\\Delta \\Omega_1^\\ddagger} - \\overline{\\Delta \\Omega_2^\\ddagger}}{\\phi_2 - \\phi_1}\n$$\n\n**2. $ \\sigma_\\alpha $ 不确定度估算量的推导**\n\n$ \\alpha_{est} $ 的不确定度源于估计的平均势垒 $ \\overline{\\Delta \\Omega_1^\\ddagger} $ 和 $ \\overline{\\Delta \\Omega_2^\\ddagger} $ 的不确定度。电势 $ \\phi_1 $ 和 $ \\phi_2 $ 被视为精确参数。一组重复值的均值不确定度由均值标准误（SEM）给出。对于电势 $ \\phi_i $ 下的势垒集合，SEM 表示为 $ \\sigma_{\\overline{\\Delta \\Omega_i^\\ddagger}} $，计算如下：\n$$\n\\sigma_{\\overline{\\Delta \\Omega_i^\\ddagger}} = \\frac{s_i}{\\sqrt{N_i}}\n$$\n其中 $ s_i $ 是样本标准差（在分母中使用 $ N_i-1 $ 的 Bessel 校正），这是从样本估计总体标准差的合适估算量：\n$$\ns_i = \\sqrt{\\frac{1}{N_i - 1} \\sum_{j=1}^{N_i} (\\Delta \\Omega^\\ddagger_{i,j} - \\overline{\\Delta \\Omega_i^\\ddagger})^2}\n$$\n$ \\alpha_{est} $ 的表达式是两个变量 $ \\overline{\\Delta \\Omega_1^\\ddagger} $ 和 $ \\overline{\\Delta \\Omega_2^\\ddagger} $ 的函数。问题指出两个电势下的数值噪声是独立的。因此，它们均值的不确定度是不相关的。对于独立变量的函数 $ f(x_1, x_2, \\dots) $，不确定度传播由下式给出：\n$$\n\\sigma_f^2 = \\sum_k \\left( \\frac{\\partial f}{\\partial x_k} \\right)^2 \\sigma_{x_k}^2\n$$\n在我们的情况中，$ f = \\alpha_{est}(\\overline{\\Delta \\Omega_1^\\ddagger}, \\overline{\\Delta \\Omega_2^\\ddagger}) $。偏导数为：\n$$\n\\frac{\\partial \\alpha_{est}}{\\partial \\overline{\\Delta \\Omega_1^\\ddagger}} = \\frac{1}{\\phi_2 - \\phi_1} \\quad \\text{和} \\quad \\frac{\\partial \\alpha_{est}}{\\partial \\overline{\\Delta \\Omega_2^\\ddagger}} = -\\frac{1}{\\phi_2 - \\phi_1}\n$$\n将这些代入传播公式，$ \\alpha_{est} $ 的方差（表示为 $ \\sigma_\\alpha^2 $）是：\n$$\n\\sigma_\\alpha^2 = \\left( \\frac{1}{\\phi_2 - \\phi_1} \\right)^2 \\sigma_{\\overline{\\Delta \\Omega_1^\\ddagger}}^2 + \\left( -\\frac{1}{\\phi_2 - \\phi_1} \\right)^2 \\sigma_{\\overline{\\Delta \\Omega_2^\\ddagger}}^2 = \\frac{\\sigma_{\\overline{\\Delta \\Omega_1^\\ddagger}}^2 + \\sigma_{\\overline{\\Delta \\Omega_2^\\ddagger}}^2}{(\\phi_2 - \\phi_1)^2}\n$$\n不确定度 $ \\sigma_\\alpha $ 是方差的平方根：\n$$\n\\sigma_\\alpha = \\frac{\\sqrt{\\sigma_{\\overline{\\Delta \\Omega_1^\\ddagger}}^2 + \\sigma_{\\overline{\\Delta \\Omega_2^\\ddagger}}^2}}{|\\phi_2 - \\phi_1|}\n$$\n\n**3. 算法协议**\n\n对于给定的电势对 $ (\\phi_1, \\phi_2) $ 及其对应的势垒重复值，计算 $ \\alpha_{est} $ 及其不确定度 $ \\sigma_\\alpha $ 的完整协议如下：\n\n1.  对于每个电势 $ \\phi_i $（其中 $ i=1, 2 $），给定 $ N_i $ 个重复势垒值 $ \\{ \\Delta \\Omega^\\ddagger_{i,j} \\} $：\n    a. 计算样本均值势垒 $ \\overline{\\Delta \\Omega_i^\\ddagger} $。\n    b. 使用分母为 $ (N_i - 1) $ 计算样本标准差 $ s_i $。\n    c. 计算均值标准误 $ \\sigma_{\\overline{\\Delta \\Omega_i^\\ddagger}} = s_i / \\sqrt{N_i} $。\n2.  使用平均势垒计算估计的传递系数：\n    $$\n    \\alpha_{est} = \\frac{\\overline{\\Delta \\Omega_1^\\ddagger} - \\overline{\\Delta \\Omega_2^\\ddagger}}{\\phi_2 - \\phi_1}\n    $$\n3.  使用均值标准误计算传递系数的不确定度：\n    $$\n    \\sigma_\\alpha = \\frac{\\sqrt{\\sigma_{\\overline{\\Delta \\Omega_1^\\ddagger}}^2 + \\sigma_{\\overline{\\Delta \\Omega_2^\\ddagger}}^2}}{|\\phi_2 - \\phi_1|}\n    $$\n4.  按照最终输出要求，将 $ \\alpha_{est} $ 和 $ \\sigma_\\alpha $ 均四舍五入到六位小数。该协议在以下程序中实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the electrochemical transfer coefficient and its uncertainty\n    based on computational electrochemistry data for several test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"phi1\": 0.50, \"phi2\": 0.55,\n            \"barriers1_eV\": [0.800, 0.802, 0.799, 0.801, 0.800],\n            \"barriers2_eV\": [0.775, 0.776, 0.774, 0.775, 0.775],\n        },\n        {\n            \"phi1\": -0.20, \"phi2\": -0.25,\n            \"barriers1_eV\": [0.649, 0.651, 0.652, 0.650, 0.648],\n            \"barriers2_eV\": [0.650, 0.651, 0.649, 0.650, 0.651],\n        },\n        {\n            \"phi1\": 0.500, \"phi2\": 0.501,\n            \"barriers1_eV\": [0.8000, 0.8005, 0.7995, 0.8001, 0.7999],\n            \"barriers2_eV\": [0.7994, 0.7996, 0.7992, 0.7995, 0.7997],\n        },\n        {\n            \"phi1\": 0.10, \"phi2\": 0.18,\n            \"barriers1_eV\": [0.5005, 0.4998, 0.5002, 0.5000, 0.4995],\n            \"barriers2_eV\": [0.4284, 0.4279, 0.4282, 0.4281, 0.4280],\n        },\n    ]\n\n    def calculate_alpha_and_uncertainty(phi1, barriers1, phi2, barriers2):\n        \"\"\"\n        Computes the transfer coefficient and its uncertainty.\n\n        Args:\n            phi1 (float): First electrode potential in Volts.\n            barriers1 (list or np.ndarray): Replicate barrier energies at phi1 in eV.\n            phi2 (float): Second electrode potential in Volts.\n            barriers2 (list or np.ndarray): Replicate barrier energies at phi2 in eV.\n\n        Returns:\n            tuple: A tuple containing the estimated transfer coefficient (alpha)\n                   and its uncertainty (sigma_alpha), both dimensionless.\n        \"\"\"\n        barriers1 = np.asarray(barriers1)\n        barriers2 = np.asarray(barriers2)\n        \n        n1 = len(barriers1)\n        n2 = len(barriers2)\n        \n        # Calculate mean barrier energies\n        mean1 = np.mean(barriers1)\n        mean2 = np.mean(barriers2)\n        \n        # Calculate standard error of the mean (SEM) for each set of barriers\n        # ddof=1 for sample standard deviation (Bessel's correction)\n        std1 = np.std(barriers1, ddof=1)\n        std2 = np.std(barriers2, ddof=1)\n        \n        sem1 = std1 / np.sqrt(n1)\n        sem2 = std2 / np.sqrt(n2)\n        \n        # Potential difference\n        delta_phi = phi2 - phi1\n\n        # Check for division by zero\n        if np.isclose(delta_phi, 0):\n             # For a zero potential difference, the derivative is ill-defined.\n             # Return nan for both values as a scientifically sound indicator of this issue.\n             return (np.nan, np.nan)\n        \n        # Estimate alpha using the finite difference approximation\n        # alpha = - (mean2 - mean1) / (phi2 - phi1)\n        alpha = (mean1 - mean2) / delta_phi\n        \n        # Propagate uncertainty\n        # sigma_alpha^2 = (sem1^2 + sem2^2) / delta_phi^2\n        sigma_alpha_sq = (sem1**2 + sem2**2) / (delta_phi**2)\n        sigma_alpha = np.sqrt(sigma_alpha_sq)\n        \n        return alpha, sigma_alpha\n\n    results = []\n    for case in test_cases:\n        alpha, sigma_alpha = calculate_alpha_and_uncertainty(\n            case[\"phi1\"], case[\"barriers1_eV\"],\n            case[\"phi2\"], case[\"barriers2_eV\"]\n        )\n        results.append((alpha, sigma_alpha))\n\n    # Format the final output string as specified: [[alpha1,sigma1],[alpha2,sigma2],...]\n    # with each value rounded to six decimal places.\n    formatted_results = []\n    for alpha, sigma_alpha in results:\n        formatted_pair = f\"[{alpha:.6f},{sigma_alpha:.6f}]\"\n        formatted_results.append(formatted_pair)\n        \n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}