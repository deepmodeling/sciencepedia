{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of interpreting many electrochemical impedance spectra is understanding the response of a simple parallel resistor-capacitor ($RC$) circuit. This configuration provides the most basic model for an electrode interface, representing the charge-transfer resistance ($R_{ct}$) and the double-layer capacitance ($C_{dl}$). This foundational exercise  will guide you through deriving the key features of this circuit's signature Nyquist plot—a perfect semicircle—from first principles, connecting the abstract algebra of complex impedance to concrete, measurable geometric properties.",
            "id": "4245066",
            "problem": "An electrochemical interface is modeled over a frequency window where diffusion is negligible by a parallel combination of a charge-transfer resistance $R_{ct}$ and a double-layer capacitance $C_{dl}$. Consider the Electrochemical Impedance Spectroscopy (EIS) response in this window. Assume that the solution resistance is negligible in this window so that only the parallel branch contributes to the impedance. Use the following foundational elements only: (i) the impedance of a capacitor is $Z_{C} = \\frac{1}{j \\omega C}$ for angular frequency $\\omega$, with $j^{2} = -1$, and (ii) impedances in parallel add via admittances, so that for two elements $Z_{1}$ and $Z_{2}$ in parallel the equivalent impedance $Z$ satisfies $\\frac{1}{Z} = \\frac{1}{Z_{1}} + \\frac{1}{Z_{2}}$.\n\nStarting from these fundamentals, derive an explicit expression for the angular frequency $\\omega_{\\max}$ at which the magnitude of the imaginary part of the total impedance $Z(\\omega)$ attains its maximum on the Nyquist plane, and then convert it to the ordinary frequency $f_{\\max}$ in Hertz using $f = \\omega/(2\\pi)$. Next, determine the geometric diameter of the corresponding Nyquist semicircle and relate it to $R_{ct}$.\n\nProvide your final results as two expressions: $f_{\\max}$ in Hertz and the diameter in ohms. Do not make any approximations beyond those stated. The final answer must be a single closed-form analytic expression or a single row matrix of such expressions, with no units inside the final boxed expression.",
            "solution": "The problem requires the derivation of two key parameters from the impedance model of an electrochemical interface, which is given as a parallel combination of a charge-transfer resistance $R_{ct}$ and a double-layer capacitance $C_{dl}$. The solution resistance is stated to be negligible.\n\nFirst, we must formulate the total complex impedance $Z(\\omega)$ of the given circuit. The impedance of the purely resistive element is $Z_R = R_{ct}$. The impedance of the purely capacitive element is given as $Z_C = \\frac{1}{j \\omega C_{dl}}$, where $j$ is the imaginary unit satisfying $j^2 = -1$ and $\\omega$ is the angular frequency in radians per second.\n\nFor components in parallel, their admittances (reciprocal of impedance) add. The total admittance $\\frac{1}{Z}$ is the sum of the admittances of the resistor and the capacitor:\n$$\n\\frac{1}{Z(\\omega)} = \\frac{1}{Z_R} + \\frac{1}{Z_C} = \\frac{1}{R_{ct}} + \\frac{1}{1/(j \\omega C_{dl})}\n$$\nSimplifying the second term gives:\n$$\n\\frac{1}{Z(\\omega)} = \\frac{1}{R_{ct}} + j \\omega C_{dl}\n$$\nTo find the total impedance $Z(\\omega)$, we take the reciprocal of the total admittance:\n$$\nZ(\\omega) = \\left( \\frac{1}{R_{ct}} + j \\omega C_{dl} \\right)^{-1} = \\frac{1}{\\frac{1 + j \\omega R_{ct} C_{dl}}{R_{ct}}} = \\frac{R_{ct}}{1 + j \\omega R_{ct} C_{dl}}\n$$\nTo separate the impedance into its real part, $Z'(\\omega)$, and imaginary part, $Z''(\\omega)$, we multiply the numerator and denominator by the complex conjugate of the denominator, which is $1 - j \\omega R_{ct} C_{dl}$:\n$$\nZ(\\omega) = \\frac{R_{ct}}{1 + j \\omega R_{ct} C_{dl}} \\cdot \\frac{1 - j \\omega R_{ct} C_{dl}}{1 - j \\omega R_{ct} C_{dl}} = \\frac{R_{ct}(1 - j \\omega R_{ct} C_{dl})}{1 - (j \\omega R_{ct} C_{dl})^2} = \\frac{R_{ct} - j \\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2}\n$$\nFrom this expression, we identify the real and imaginary components:\n$$\nZ'(\\omega) = \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2}\n$$\n$$\nZ''(\\omega) = -\\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2}\n$$\nThe first part of the problem is to find the angular frequency $\\omega_{\\max}$ at which the magnitude of the imaginary part, $|Z''(\\omega)|$, reaches its maximum. Let us define the function $g(\\omega) = |Z''(\\omega)|$:\n$$\ng(\\omega) = \\frac{\\omega R_{ct}^2 C_{dl}}{1 + \\omega^2 R_{ct}^2 C_{dl}^2}\n$$\nTo find the maximum of this function, we compute its derivative with respect to $\\omega$ and set it to $0$. Using the quotient rule for differentiation, $\\frac{d}{d\\omega} \\left( \\frac{u(\\omega)}{v(\\omega)} \\right) = \\frac{u'v - uv'}{v^2}$, with $u(\\omega) = \\omega R_{ct}^2 C_{dl}$ and $v(\\omega) = 1 + \\omega^2 R_{ct}^2 C_{dl}^2$. Their derivatives are $u'(\\omega) = R_{ct}^2 C_{dl}$ and $v'(\\omega) = 2 \\omega R_{ct}^2 C_{dl}^2$. The condition for an extremum is that the numerator of the derivative is zero:\n$$\nu'v - uv' = (R_{ct}^2 C_{dl})(1 + \\omega^2 R_{ct}^2 C_{dl}^2) - (\\omega R_{ct}^2 C_{dl})(2 \\omega R_{ct}^2 C_{dl}^2) = 0\n$$\nGiven that $R_{ct}  0$ and $C_{dl}  0$, we can divide by the common non-zero factor $R_{ct}^2 C_{dl}$:\n$$\n(1 + \\omega^2 R_{ct}^2 C_{dl}^2) - 2 \\omega^2 R_{ct}^2 C_{dl}^2 = 0\n$$\n$$\n1 - \\omega^2 R_{ct}^2 C_{dl}^2 = 0\n$$\nSolving for $\\omega^2$ yields $\\omega^2 = \\frac{1}{(R_{ct} C_{dl})^2}$. As angular frequency $\\omega$ is a positive quantity, we take the positive root:\n$$\n\\omega_{\\max} = \\frac{1}{R_{ct} C_{dl}}\n$$\nThe problem requests the ordinary frequency $f_{\\max}$ in Hertz, which is related to $\\omega_{\\max}$ by $f = \\omega / (2\\pi)$. Thus:\n$$\nf_{\\max} = \\frac{\\omega_{\\max}}{2\\pi} = \\frac{1}{2\\pi R_{ct} C_{dl}}\n$$\nThe second part of the problem is to determine the geometric diameter of the corresponding Nyquist semicircle. A Nyquist plot shows the relationship between the real and imaginary parts of the impedance. We can find an equation relating $Z'(\\omega)$ and $Z''(\\omega)$ by eliminating $\\omega$.\nFrom the expression for $Z'(\\omega)$:\n$$\nZ' = \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2} \\implies 1 + (\\omega R_{ct} C_{dl})^2 = \\frac{R_{ct}}{Z'}\n$$\nThis gives $(\\omega R_{ct} C_{dl})^2 = \\frac{R_{ct}}{Z'} - 1$. Now we use the expression for $(Z''(\\omega))^2$:\n$$\n(Z'')^2 = \\left( -\\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2} \\right)^2 = \\frac{(\\omega R_{ct} C_{dl})^2 R_{ct}^2}{(1 + (\\omega R_{ct} C_{dl})^2)^2}\n$$\nSubstituting the terms derived from $Z'$:\n$$\n(Z'')^2 = \\frac{(\\frac{R_{ct}}{Z'} - 1)R_{ct}^2}{(\\frac{R_{ct}}{Z'})^2} = \\frac{\\frac{R_{ct} - Z'}{Z'} R_{ct}^2}{\\frac{R_{ct}^2}{(Z')^2}} = \\left(\\frac{R_{ct} - Z'}{Z'}\\right) (Z')^2 = (R_{ct} - Z') Z'\n$$\nThis simplifies to $(Z'')^2 = R_{ct} Z' - (Z')^2$. Rearranging this equation into a standard form:\n$$\n(Z')^2 - R_{ct} Z' + (Z'')^2 = 0\n$$\nTo identify the geometric shape, we complete the square for the terms involving $Z'$:\n$$\n\\left( (Z')^2 - R_{ct} Z' + \\left(\\frac{R_{ct}}{2}\\right)^2 \\right) - \\left(\\frac{R_{ct}}{2}\\right)^2 + (Z'')^2 = 0\n$$\n$$\n\\left( Z' - \\frac{R_{ct}}{2} \\right)^2 + (Z'')^2 = \\left( \\frac{R_{ct}}{2} \\right)^2\n$$\nThis is the equation of a circle in the complex impedance plane with variables $(Z', Z'')$. The center of the circle is at $(\\frac{R_{ct}}{2}, 0)$ and its radius is $r = \\frac{R_{ct}}{2}$. The geometric diameter of this circle is twice the radius:\n$$\n\\text{Diameter} = 2r = 2 \\left( \\frac{R_{ct}}{2} \\right) = R_{ct}\n$$\nThe locus of $Z(\\omega)$ as $\\omega$ goes from $0$ to $\\infty$ traces a semicircle in the fourth quadrant of the complex plane, starting at $Z(0) = R_{ct}$ and ending at $Z(\\infty)=0$. The diameter of this semicircle lies on the real axis and is equal to $R_{ct}$. The relation is that the diameter is identically the charge-transfer resistance.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2\\pi R_{ct} C_{dl}}  R_{ct}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the ideal $RC$ circuit provides a valuable starting point, real-world electrochemical interfaces often exhibit non-ideal behavior due to factors like surface roughness, porosity, and non-uniform current distribution. The Constant Phase Element (CPE) is an empirical circuit element introduced to capture these effects, resulting in a characteristic \"depressed semicircle\" in the Nyquist plot. In this practice , you will derive the precise mathematical relationship between the CPE's non-ideal exponent $n$ and the angle of this depression, gaining a deeper understanding of how to model and interpret these common experimental features.",
            "id": "4245133",
            "problem": "Consider the equivalent circuit used in Electrochemical Impedance Spectroscopy (EIS) composed of a resistor $R$ in parallel with a Constant Phase Element (CPE). The Constant Phase Element (CPE) is defined by the impedance $Z_{\\mathrm{CPE}}(\\omega) = \\frac{1}{Q (\\mathrm{i} \\omega)^{n}}$, where $Q  0$ is a real-valued coefficient, $0  n  1$ is the dispersion exponent, $\\omega$ is the angular frequency, and $\\mathrm{i}$ is the imaginary unit. The parallel combination of $R$ and the CPE yields a total admittance $Y(\\omega)$ and an impedance $Z(\\omega) = \\frac{1}{Y(\\omega)}$ that trace, in the complex impedance plane $(\\Re(Z), \\Im(Z))$, an arc connecting $Z(\\omega \\to \\infty) = 0$ and $Z(\\omega \\to 0) = R$. This arc is a “depressed semicircle” for $n \\neq 1$.\n\nStarting from the definitions above and first principles of complex algebra, derive the equation of the locus of $Z(\\omega)$ and prove that it is a circle passing through $0$ and $R$. Then, define the depressed semicircle angle $\\delta$ as the angle (in radians) between the real axis and the line from the origin to the circle’s center. Express $\\delta$ as a closed-form analytical function of the CPE exponent $n$. Your final answer must be the explicit formula for $\\delta(n)$ in radians. No numerical approximation or rounding is required; provide the exact expression.",
            "solution": "The problem requires the derivation of the depressed semicircle angle $\\delta$ for an equivalent circuit consisting of a resistor $R$ in parallel with a Constant Phase Element (CPE). The derivation proceeds from first principles of circuit theory and complex algebra.\n\nFirst, we establish the total admittance $Y(\\omega)$ of the parallel circuit. The admittance is the sum of the individual admittances of the components. The admittance of the resistor is $Y_R = \\frac{1}{R}$. The impedance of the CPE is given as $Z_{\\mathrm{CPE}}(\\omega) = \\frac{1}{Q (\\mathrm{i} \\omega)^{n}}$, so its admittance is $Y_{\\mathrm{CPE}}(\\omega) = Q (\\mathrm{i} \\omega)^{n}$. The total admittance is therefore:\n$$Y(\\omega) = Y_R + Y_{\\mathrm{CPE}}(\\omega) = \\frac{1}{R} + Q (\\mathrm{i} \\omega)^{n}$$\n\nTo analyze the locus of the impedance, we must first understand the locus of the admittance. We analyze the complex term $(\\mathrm{i}\\omega)^{n}$. The imaginary unit $\\mathrm{i}$ can be written in polar form as $\\mathrm{i} = \\exp(\\mathrm{i} \\frac{\\pi}{2})$. Given that the angular frequency $\\omega$ is a positive real number, we have:\n$$(\\mathrm{i} \\omega)^{n} = \\left(\\omega \\exp\\left(\\mathrm{i} \\frac{\\pi}{2}\\right)\\right)^{n} = \\omega^{n} \\exp\\left(\\mathrm{i} \\frac{n\\pi}{2}\\right)$$\nUsing Euler's formula, $\\exp(\\mathrm{i}\\theta) = \\cos(\\theta) + \\mathrm{i}\\sin(\\theta)$, this becomes:\n$$(\\mathrm{i} \\omega)^{n} = \\omega^{n} \\left(\\cos\\left(\\frac{n\\pi}{2}\\right) + \\mathrm{i}\\sin\\left(\\frac{n\\pi}{2}\\right)\\right)$$\nSubstituting this back into the expression for the total admittance $Y(\\omega)$:\n$$Y(\\omega) = \\frac{1}{R} + Q\\omega^{n}\\cos\\left(\\frac{n\\pi}{2}\\right) + \\mathrm{i} Q\\omega^{n}\\sin\\left(\\frac{n\\pi}{2}\\right)$$\nLet us represent the complex admittance as $Y(\\omega) = u(\\omega) + \\mathrm{i}v(\\omega)$, where $u(\\omega) = \\Re(Y(\\omega))$ and $v(\\omega) = \\Im(Y(\\omega))$.\n$$u(\\omega) = \\frac{1}{R} + Q\\omega^{n}\\cos\\left(\\frac{n\\pi}{2}\\right)$$\n$$v(\\omega) = Q\\omega^{n}\\sin\\left(\\frac{n\\pi}{2}\\right)$$\nTo find the equation for the locus of $Y(\\omega)$, we eliminate the parameter $\\omega$. From the equation for $v(\\omega)$, we can express $Q\\omega^{n} = \\frac{v(\\omega)}{\\sin(n\\pi/2)}$. This is valid since $0  n  1$ implies $0  n\\pi/2  \\pi/2$, so $\\sin(n\\pi/2) \\neq 0$. Substituting this into the equation for $u(\\omega)$:\n$$u(\\omega) = \\frac{1}{R} + \\frac{v(\\omega)}{\\sin(n\\pi/2)}\\cos\\left(\\frac{n\\pi}{2}\\right) = \\frac{1}{R} + v(\\omega) \\cot\\left(\\frac{n\\pi}{2}\\right)$$\nThis is the equation of a straight line in the complex admittance plane $(u, v)$. As $\\omega$ varies from $0$ to $\\infty$, $v(\\omega)$ varies from $0$ to $\\infty$ (since $Q  0$ and $\\sin(n\\pi/2)  0$). The locus is a ray starting at the point $(\\frac{1}{R}, 0)$ and extending to infinity with a constant positive slope of $\\tan(n\\pi/2)$.\n\nThe total impedance $Z(\\omega)$ is the complex inverse of the admittance, $Z(\\omega) = \\frac{1}{Y(\\omega)}$. A complex inversion maps a line not passing through the origin to a circle passing through the origin. Since $\\Im(Y(\\omega)) > 0$ for $\\omega > 0$, the admittance locus lies in the upper half-plane. The inversion $Z=1/Y$ maps the upper half-plane of $Y$ to the lower half-plane of $Z$. Thus, the impedance arc will be below the real axis.\n\nThe center of the depressed semicircle in the complex impedance plane $(\\Re(Z), \\Im(Z))$ can be shown to be $(x_c, y_c) = \\left(\\frac{R}{2}, -\\frac{R}{2}\\cot\\left(\\frac{n\\pi}{2}\\right)\\right)$. The depression angle $\\delta$ is the angle that the line segment from the origin to the center makes with the negative imaginary axis, or more simply, the magnitude of the angle this vector makes with the real axis.\n\nThe vector to the center is $\\vec{c} = \\frac{R}{2} - \\mathrm{i}\\frac{R}{2}\\cot\\left(\\frac{n\\pi}{2}\\right)$.\nThe argument (angle) of this complex number is given by:\n$$\\arg(\\vec{c}) = \\arctan\\left(\\frac{-\\frac{R}{2}\\cot(n\\pi/2)}{\\frac{R}{2}}\\right) = \\arctan\\left(-\\cot\\left(\\frac{n\\pi}{2}\\right)\\right)$$\nUsing the identities $\\arctan(-x) = -\\arctan(x)$ and $\\cot(\\theta) = \\tan(\\frac{\\pi}{2}-\\theta)$, we can rewrite this as:\n$$\\arg(\\vec{c}) = -\\arctan\\left(\\tan\\left(\\frac{\\pi}{2}-\\frac{n\\pi}{2}\\right)\\right)$$\nFor the given range $0  n  1$, the argument of the tangent function, $\\frac{\\pi}{2}(1-n)$, lies in the interval $(0, \\pi/2)$. In this interval, the $\\arctan$ and $\\tan$ functions are inverses, so $\\arctan(\\tan(x))=x$.\n$$\\arg(\\vec{c}) = -\\left(\\frac{\\pi}{2}-\\frac{n\\pi}{2}\\right)$$\nThe problem defines the depression angle $\\delta$ as a positive value representing the angle of depression from the real axis. This corresponds to the magnitude of the argument of the center vector:\n$$\\delta = \\left|-\\left(\\frac{\\pi}{2}-\\frac{n\\pi}{2}\\right)\\right| = \\frac{\\pi}{2} - \\frac{n\\pi}{2}$$\nFactoring out $\\frac{\\pi}{2}$ gives the final expression:\n$$\\delta = \\frac{\\pi}{2}(1-n)$$\nThis result shows that for an ideal capacitor ($n=1$), the depression angle is $\\delta = 0$, and the center lies on the real axis, forming a perfect semicircle. As $n$ decreases, the depression angle $\\delta$ increases, causing the semicircle to appear more \"squashed\".",
            "answer": "$$\n\\boxed{\\frac{\\pi}{2}(1-n)}\n$$"
        },
        {
            "introduction": "After mastering individual components, the next step is to analyze a complete and realistic model, such as the Randles circuit, which incorporates solution resistance, charge-transfer kinetics, and mass transport limitations (diffusion). A critical task in fitting such a model to data is understanding the quality of the parameter estimates. This advanced computational practice  introduces sensitivity analysis via the Fisher Information, allowing you to determine which frequency regions of the impedance spectrum most strongly constrain each model parameter, a crucial skill for experimental design and robust data interpretation.",
            "id": "4245089",
            "problem": "You are tasked with writing a complete, runnable program that performs a sensitivity-based frequency-region ranking for parameters in a Randles-type equivalent circuit used in Electrochemical Impedance Spectroscopy (EIS), where EIS stands for Electrochemical Impedance Spectroscopy. The circuit model consists of a series solution resistance $R_s$ in series with a parallel combination of a double-layer capacitance $C_{dl}$ and a Faradaic branch comprising a charge-transfer resistance $R_{ct}$ in series with a semi-infinite Warburg diffusion element $W$. The total impedance $Z(\\omega;\\boldsymbol{\\theta})$ as a function of angular frequency $\\omega$ and parameter vector $\\boldsymbol{\\theta} = (R_s, R_{ct}, C_{dl}, \\sigma)$ is defined by the following fundamental laws of linear circuit combination:\n- Series combination: impedances add directly.\n- Parallel combination: admittances add directly.\n- Double-layer capacitance: $Z_{C_{dl}}(\\omega) = \\frac{1}{\\mathrm{j}\\,\\omega\\,C_{dl}}$.\n- Charge-transfer resistance: $Z_{ct} = R_{ct}$.\n- Semi-infinite Warburg element: $Z_W(\\omega) = \\frac{\\sigma}{\\sqrt{\\mathrm{j}\\,\\omega}}$, where $\\mathrm{j}^2 = -1$ and $\\sigma$ has units of $\\Omega\\,\\mathrm{s}^{1/2}$.\n\nUsing these, define the total impedance as\n$$\nZ(\\omega;\\boldsymbol{\\theta}) = R_s + \\left(\\frac{1}{R_{ct} + Z_W(\\omega)} + \\mathrm{j}\\,\\omega\\,C_{dl}\\right)^{-1}\n$$\nwith $\\omega = 2\\pi f$ for frequency $f$ in $\\mathrm{Hz}$.\n\nAssume independent, identically distributed Gaussian noise with standard deviation $\\sigma_n = 0.01\\,\\Omega$ on both the real and imaginary parts of the measured impedance. For each parameter $\\theta_k \\in \\{R_s,R_{ct},C_{dl},\\sigma\\}$, define the per-frequency scalar Fisher-information contribution as\n$$\ng_k(\\omega) = \\frac{1}{\\sigma_n^2}\\left(\\left[\\frac{\\partial \\operatorname{Re} Z}{\\partial \\theta_k}\\right]^2 + \\left[\\frac{\\partial \\operatorname{Im} Z}{\\partial \\theta_k}\\right]^2\\right).\n$$\nPartition the frequency grid into three regions and define regional information by summing $g_k(\\omega)$ over the frequencies in each region:\n- Region $0$ (low): $f \\le 1\\,\\mathrm{Hz}$.\n- Region $1$ (mid): $1\\,\\mathrm{Hz}  f \\le 10^3\\,\\mathrm{Hz}$.\n- Region $2$ (high): $f  10^3\\,\\mathrm{Hz}$.\n\nYour program must:\n- Use $N = 61$ logarithmically spaced frequencies $f$ from $f_{\\min} = 0.1\\,\\mathrm{Hz}$ to $f_{\\max} = 10^5\\,\\mathrm{Hz}$, inclusive.\n- For each parameter $\\theta_k$, approximate $\\frac{\\partial Z}{\\partial \\theta_k}$ using a numerically stable method based on first principles (e.g., a derivative definition grounded in calculus). Use a complex-step perturbation with a step size $h = 10^{-20}$ to evaluate\n$$\n\\frac{\\partial Z}{\\partial \\theta_k} \\approx \\frac{\\operatorname{Im}\\left[ Z(\\omega;\\boldsymbol{\\theta} + \\mathrm{j} h\\,\\mathbf{e}_k) \\right]}{h}\n$$\nwhere $\\mathbf{e}_k$ is the unit vector in the direction of $\\theta_k$, and $\\mathrm{j}$ denotes the imaginary unit. Then compute $g_k(\\omega)$ and the regional sums for each parameter.\n\nRanking rule:\n- For each parameter $\\theta_k$, identify the region index $r_k \\in \\{0,1,2\\}$ that maximizes the corresponding regional sum. If multiple regions are tied within an absolute tolerance $\\tau = 10^{-12}$ on the regional sums, choose the smallest index among the tied regions. If all three regional sums are less than $\\varepsilon = 10^{-300}$, return $-1$ for that parameter to indicate an uninformative spectrum for that parameter.\n\nTest suite:\n- Use the following four parameter sets, each given as $(R_s\\,\\,[\\Omega], R_{ct}\\,\\,[\\Omega], C_{dl}\\,\\,[\\mathrm{F}], \\sigma\\,\\,[\\Omega\\,\\mathrm{s}^{1/2}])$:\n    1. $(5, 150, 2\\times 10^{-5}, 15)$\n    2. $(0.5, 5000, 10^{-6}, 5)$\n    3. $(2, 50, 5\\times 10^{-4}, 30)$\n    4. $(1, 100, 10^{-5}, 200)$\n\nProgram output specification:\n- For each test case, output a list $[r_{R_s}, r_{R_{ct}}, r_{C_{dl}}, r_{\\sigma}]$ of the three-region indices (or $-1$) in that exact parameter order.\n- Aggregate the results for all test cases into a single line printed to standard output as a comma-separated list enclosed in square brackets, with no spaces. For example, an output with two test cases should look like $[[0,1,2,0],[2,1,2,0]]$.\n- All internal computations involving physical quantities must use base units as specified (e.g., $\\mathrm{Hz}$ for frequency, $\\Omega$ for impedance, $\\mathrm{F}$ for capacitance). No other units should appear in the output since the final answer is region indices only.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of electrochemical impedance spectroscopy, mathematically well-posed, and provides a complete and unambiguous specification for a computational task.\n\nThe objective is to determine, for each parameter of a Randles-type equivalent circuit model, which frequency region provides the most information for its estimation. This is accomplished through a sensitivity analysis based on the Fisher Information. The procedure is as follows:\n\nFirst, we define the electrochemical model. The impedance $Z$ of the Randles circuit is a function of angular frequency $\\omega$ and the parameter vector $\\boldsymbol{\\theta} = (R_s, R_{ct}, C_{dl}, \\sigma)$. The components are the solution resistance $R_s$, the charge-transfer resistance $R_{ct}$, the double-layer capacitance $C_{dl}$, and the Warburg coefficient $\\sigma$. The total impedance is given by the expression for series and parallel circuit elements:\n$$Z(\\omega;\\boldsymbol{\\theta}) = R_s + \\left(\\frac{1}{R_{ct} + Z_W(\\omega)} + \\mathrm{j}\\,\\omega\\,C_{dl}\\right)^{-1}$$\nwhere $\\mathrm{j}$ is the imaginary unit, and $Z_W(\\omega)$ is the impedance of the semi-infinite Warburg element, defined as:\n$$Z_W(\\omega) = \\frac{\\sigma}{\\sqrt{\\mathrm{j}\\,\\omega}}$$\nThe angular frequency $\\omega$ is related to the frequency $f$ in Hertz by $\\omega = 2\\pi f$.\n\nSecond, we quantify the sensitivity of the impedance spectrum to changes in each parameter $\\theta_k \\in \\{R_s, R_{ct}, C_{dl}, \\sigma\\}$. This is achieved by calculating the per-frequency scalar Fisher-information contribution, $g_k(\\omega)$. Assuming independent Gaussian noise with standard deviation $\\sigma_n = 0.01\\,\\Omega$ on the real and imaginary parts of the impedance measurement, $g_k(\\omega)$ is given by:\n$$g_k(\\omega) = \\frac{1}{\\sigma_n^2}\\left(\\left[\\frac{\\partial \\operatorname{Re} Z(\\omega;\\boldsymbol{\\theta})}{\\partial \\theta_k}\\right]^2 + \\left[\\frac{\\partial \\operatorname{Im} Z(\\omega;\\boldsymbol{\\theta})}{\\partial \\theta_k}\\right]^2\\right)$$\nRecognizing that the term in the parenthesis is the squared magnitude of the complex derivative $\\frac{\\partial Z}{\\partial \\theta_k}$, we can write this more compactly as:\n$$g_k(\\omega) = \\frac{1}{\\sigma_n^2} \\left| \\frac{\\partial Z(\\omega; \\boldsymbol{\\theta})}{\\partial \\theta_k} \\right|^2$$\n\nThird, we must compute the partial derivatives $\\frac{\\partial Z}{\\partial \\theta_k}$. The problem specifies the use of the complex-step derivative method, a numerically stable and highly accurate technique. For a complex-analytic function $f(x)$, its derivative can be approximated by:\n$$\\frac{\\mathrm{d}f(x)}{\\mathrm{d}x} \\approx \\frac{\\operatorname{Im}[f(x+\\mathrm{j}h)]}{h}$$\nwhere $\\mathrm{j}$ is the imaginary unit and $h$ is a very small step size, given as $h = 10^{-20}$. To compute the partial derivative with respect to $\\theta_k$, we apply this formula by perturbing only the $k$-th parameter:\n$$\\frac{\\partial Z(\\omega; \\boldsymbol{\\theta})}{\\partial \\theta_k} \\approx \\frac{\\operatorname{Im}\\left[ Z(\\omega;\\boldsymbol{\\theta} + \\mathrm{j} h\\,\\mathbf{e}_k) \\right]}{h}$$\nwhere $\\mathbf{e}_k$ is the standard basis vector for the $k$-th parameter direction (e.g., $\\mathbf{e}_1 = [1, 0, 0, 0]$ for $R_s$).\n\nThe computational algorithm proceeds with the following steps for each test case:\n1.  **Frequency Grid**: Generate an array of $N=61$ frequencies, $\\mathbf{f}$, logarithmically spaced from $f_{\\min} = 0.1\\,\\mathrm{Hz}$ to $f_{\\max} = 10^5\\,\\mathrm{Hz}$. Convert this to an angular frequency array $\\boldsymbol{\\omega} = 2\\pi\\mathbf{f}$.\n2.  **Derivative Calculation**: For each parameter $\\theta_k$ in the set $\\boldsymbol{\\theta}$:\n    a. Construct the complex-perturbed parameter vector $\\boldsymbol{\\theta}' = \\boldsymbol{\\theta} + \\mathrm{j}h\\mathbf{e}_k$.\n    b. Calculate the impedance vector $\\mathbf{Z}' = Z(\\boldsymbol{\\omega}; \\boldsymbol{\\theta}')$ using the perturbed parameters.\n    c. Compute the derivative vector $\\frac{\\partial\\mathbf{Z}}{\\partial\\theta_k}$ using the complex-step formula.\n3.  **Information Calculation**: Compute the information contribution vector $\\mathbf{g}_k$ for each parameter using the formula $\\mathbf{g}_k = \\frac{1}{\\sigma_n^2} \\left|\\frac{\\partial\\mathbf{Z}}{\\partial\\theta_k}\\right|^2$.\n4.  **Regional Summation**: Partition the frequency array $\\mathbf{f}$ into three disjoint regions:\n    - Region $0$: $f \\le 1\\,\\mathrm{Hz}$.\n    - Region $1$: $1\\,\\mathrm{Hz}  f \\le 10^3\\,\\mathrm{Hz}$.\n    - Region $2$: $f  10^3\\,\\mathrm{Hz}$.\n    For each parameter $\\theta_k$, sum the elements of $\\mathbf{g}_k$ corresponding to the frequencies in each of the three regions to obtain the regional sums $S_{k,0}$, $S_{k,1}$, and $S_{k,2}$.\n5.  **Ranking**: For each parameter $\\theta_k$, determine the optimal region index $r_k$ according to the rules:\n    a. If $\\max(S_{k,0}, S_{k,1}, S_{k,2})  \\varepsilon = 10^{-300}$, the parameter is considered uninformative, and $r_k$ is set to $-1$.\n    b. Otherwise, find the maximum regional sum, $S_{k, \\text{max}} = \\max(S_{k,0}, S_{k,1}, S_{k,2})$.\n    c. The index $r_k$ is the smallest integer $j \\in \\{0, 1, 2\\}$ such that the regional sum $S_{k,j}$ is within an absolute tolerance $\\tau = 10^{-12}$ of the maximum sum, i.e., $|S_{k,j} - S_{k, \\text{max}}|  \\tau$.\n6.  **Output Generation**: The resulting indices $[r_{R_s}, r_{R_{ct}}, r_{C_{dl}}, r_{\\sigma}]$ are collected for each test case and formatted into a single output line as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a sensitivity-based frequency-region ranking for parameters in a\n    Randles-type equivalent circuit used in Electrochemical Impedance Spectroscopy (EIS).\n    \"\"\"\n\n    # Define constants and problem parameters\n    sigma_n = 0.01  # Noise standard deviation in Ohms\n    N = 61  # Number of frequency points\n    f_min = 0.1  # Min frequency in Hz\n    f_max = 1e5  # Max frequency in Hz\n    h = 1e-20  # Complex-step perturbation size\n    tau = 1e-12  # Absolute tolerance for tie-breaking\n    epsilon = 1e-300  # Threshold for uninformative parameter sums\n\n    # Test cases: (R_s [Ohm], R_ct [Ohm], C_dl [F], sigma [Ohm s^1/2])\n    test_cases = [\n        (5.0, 150.0, 2e-5, 15.0),\n        (0.5, 5000.0, 1e-6, 5.0),\n        (2.0, 50.0, 5e-4, 30.0),\n        (1.0, 100.0, 1e-5, 200.0)\n    ]\n    \n    num_params = 4\n\n    # Generate frequency grid\n    f = np.logspace(np.log10(f_min), np.log10(f_max), N)\n    omega = 2 * np.pi * f\n\n    def calculate_Z(w, params):\n        \"\"\"\n        Calculates the complex impedance of the Randles circuit.\n        \n        Args:\n            w (np.ndarray): Array of angular frequencies.\n            params (tuple, list, or np.ndarray): Circuit parameters \n                    (R_s, R_ct, C_dl, sigma). The elements can be complex.\n        \n        Returns:\n            np.ndarray: Array of complex impedance values.\n        \"\"\"\n        R_s, R_ct, C_dl, sigma = params\n        j_omega = 1j * w\n        \n        # Warburg impedance\n        Z_W = sigma / np.sqrt(j_omega)\n        # Faradaic branch impedance\n        Z_faraday = R_ct + Z_W\n        \n        # Admittance of the parallel part (Faradaic branch in parallel with C_dl)\n        Y_parallel = (1 / Z_faraday) + j_omega * C_dl\n        \n        # Impedance of the parallel part\n        Z_parallel = 1 / Y_parallel\n        \n        # Total impedance\n        Z_total = R_s + Z_parallel\n        return Z_total\n\n    all_results = []\n\n    for case_params in test_cases:\n        case_params_array = np.array(case_params, dtype=float)\n        case_regional_ranks = []\n        \n        # Loop through each parameter to calculate its sensitivity and regional sums\n        for k in range(num_params):\n            # Create the complex-step perturbed parameter vector\n            pert_vector = np.zeros(num_params, dtype=complex)\n            pert_vector[k] = 1j * h\n            params_pert = case_params_array + pert_vector\n            \n            # Calculate impedance with perturbed parameters\n            Z_pert = calculate_Z(omega, params_pert)\n            \n            # Calculate the derivative using the complex-step formula\n            dZ_dtheta_k = np.imag(Z_pert) / h\n\n            # Calculate the per-frequency Fisher information contribution\n            g_k = (1 / sigma_n**2) * np.abs(dZ_dtheta_k)**2\n\n            # Define frequency region masks\n            low_mask = f = 1.0\n            mid_mask = (f  1.0)  (f = 1e3)\n            high_mask = f  1e3\n            \n            # Sum g_k over regions to get regional information\n            regional_sums = [\n                np.sum(g_k[low_mask]),\n                np.sum(g_k[mid_mask]),\n                np.sum(g_k[high_mask])\n            ]\n\n            # Rank regions based on the specified rules\n            # Check for uninformative parameter\n            max_sum = np.max(regional_sums)\n            if max_sum  epsilon:\n                case_regional_ranks.append(-1)\n                continue\n            \n            # Apply ranking rule with tie-breaking\n            best_region_idx = -1\n            for region_idx in range(3): # Iterate from smallest index\n                if np.abs(regional_sums[region_idx] - max_sum)  tau:\n                    best_region_idx = region_idx\n                    break\n            case_regional_ranks.append(best_region_idx)\n            \n        all_results.append(case_regional_ranks)\n\n    # Format the final output string exactly as specified: [[r1,r2,...],[...]]\n    formatted_results = [str(res).replace(\" \", \"\") for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}