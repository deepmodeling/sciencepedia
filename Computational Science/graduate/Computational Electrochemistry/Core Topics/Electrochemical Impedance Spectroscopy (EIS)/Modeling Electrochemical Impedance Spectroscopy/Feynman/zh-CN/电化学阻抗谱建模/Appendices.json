{
    "hands_on_practices": [
        {
            "introduction": "我们从电化学阻抗谱（EIS）建模的基石——理想的Randles电路开始。这项练习旨在通过推导一个简单电路的阻抗，并将其参数与奈奎斯特（Nyquist）图上半圆弧的顶点这一关键图形特征联系起来，来建立对电路元件如何影响阻抗谱的基本直觉。掌握这项基本功，是理解更复杂模型的第一步。",
            "id": "4252778",
            "problem": "一个简单电极过程的电化学阻抗谱（EIS）测量由一个兰德斯电路建模，该电路由一个溶液电阻 $R_{s}$ 与一个电荷转移电阻 $R_{\\text{ct}}$ 和一个双电层电容 $C_{\\text{dl}}$ 的并联组合串联而成。假设元件是理想的，没有扩散（瓦伯格）贡献。仅使用电阻的阻抗基本定义 $Z_{R} = R$ 和电容的阻抗基本定义 $Z_{C} = \\frac{1}{j \\omega C}$，结合串并联组合规则，推导电路的角频率相关复阻抗 $Z(\\omega)$，并确定奈奎斯特半圆达到其顶点的角频率。顶点对应于奈奎斯特图上虚部 $Z''(\\omega)$ 的最负值。\n\n已知 $R_{s} = 2.50\\,\\Omega$，$R_{\\text{ct}} = 75.0\\,\\Omega$，以及 $C_{\\text{dl}} = 150.0\\,\\mu\\mathrm{F}$，计算：\n- 顶点频率 $f_{\\text{apex}}$（单位为 $\\mathrm{Hz}$），其中 $f_{\\text{apex}} = \\frac{\\omega_{\\text{apex}}}{2\\pi}$，以及\n- 相应的最小虚部值 $Z''_{\\min}$（单位为 $\\Omega$）。\n\n将两个数值答案四舍五入至四位有效数字。频率以 $\\mathrm{Hz}$ 表示，虚部值以 $\\Omega$ 表示。",
            "solution": "该问题是有效的，因为它科学地基于电路理论和电化学原理，提法恰当，有足够的信息得到唯一解，并且陈述客观。我们开始求解。\n\n该电化学系统由一个兰德斯电路建模。总阻抗 $Z(\\omega)$ 由一个溶液电阻 $R_s$ 与一个电荷转移电阻 $R_{\\text{ct}}$ 和一个双电层电容 $C_{\\text{dl}}$ 的并联组合串联而成。\n\n电阻 $R$ 的阻抗为 $Z_R = R$，电容 $C$ 的阻抗为 $Z_C = \\frac{1}{j \\omega C}$，其中 $j = \\sqrt{-1}$ 是虚数单位，$\\omega$ 是角频率。\n\n首先，我们确定电路并联部分 $Z_p$ 的阻抗，它由 $R_{\\text{ct}}$ 和 $C_{\\text{dl}}$ 组成。对于并联元件，总阻抗的倒数是各个阻抗倒数的总和：\n$$ \\frac{1}{Z_p(\\omega)} = \\frac{1}{Z_{R_{\\text{ct}}}} + \\frac{1}{Z_{C_{\\text{dl}}}} $$\n代入阻抗的定义，我们得到：\n$$ \\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\text{ct}}} + \\frac{1}{1/(j \\omega C_{\\text{dl}})} = \\frac{1}{R_{\\text{ct}}} + j \\omega C_{\\text{dl}} $$\n为了求解 $Z_p(\\omega)$，我们取其倒数：\n$$ Z_p(\\omega) = \\left( \\frac{1}{R_{\\text{ct}}} + j \\omega C_{\\text{dl}} \\right)^{-1} = \\left( \\frac{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}}{R_{\\text{ct}}} \\right)^{-1} = \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n\n电路的总阻抗 $Z(\\omega)$ 是串联元件 $R_s$ 和 $Z_p(\\omega)$ 的和。\n$$ Z(\\omega) = R_s + Z_p(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n为了将总阻抗分离成其实部 $Z'(\\omega)$ 和虚部 $Z''(\\omega)$，我们将第二项的分子和分母同乘以其分母的复共轭 $1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}$：\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} \\times \\frac{1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}}{1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}} (1 - j \\omega R_{\\text{ct}} C_{\\text{dl}})}{1^2 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} - j \\frac{\\omega R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega R_{\\text{ct}} C_{\\text_dl})^2} $$\n从这个表达式中，我们确定实部和虚部：\n$$ Z'(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n$$ Z''(\\omega) = - \\frac{\\omega R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n\n奈奎斯特半圆的顶点对应于虚部 $Z''(\\omega)$ 的极值（最小值）。为了找到出现该极值的角频率 $\\omega_{\\text{apex}}$，我们将 $Z''(\\omega)$ 对 $\\omega$ 求导，并令其为零。我们将电荷转移过程的特征时间常数定义为 $\\tau = R_{\\text{ct}} C_{\\text{dl}}$。\n$$ Z''(\\omega) = - \\frac{\\omega R_{\\text{ct}} \\tau}{1 + (\\omega \\tau)^2} $$\n使用微分的商法则 $\\frac{d}{dx}(\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$，其中 $u = \\omega$，$v = 1 + (\\omega \\tau)^2$：\n$$ \\frac{dZ''}{d\\omega} = -R_{\\text{ct}}\\tau \\frac{d}{d\\omega} \\left( \\frac{\\omega}{1 + (\\omega\\tau)^2} \\right) = -R_{\\text{ct}}\\tau \\left[ \\frac{(1)(1 + (\\omega\\tau)^2) - (\\omega)(2\\omega\\tau^2)}{(1 + (\\omega\\tau)^2)^2} \\right] $$\n$$ \\frac{dZ''}{d\\omega} = -R_{\\text{ct}}\\tau \\left[ \\frac{1 + \\omega^2\\tau^2 - 2\\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} \\right] = -R_{\\text{ct}}\\tau \\frac{1 - \\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} $$\n将导数设为零以求极值：\n$$ \\frac{1 - \\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} = 0 $$\n当分子为零时，此条件得到满足。由于 $\\omega$ 必须为正，我们有：\n$$ 1 - \\omega^2\\tau^2 = 0 \\implies \\omega^2\\tau^2 = 1 \\implies \\omega_{\\text{apex}} = \\frac{1}{\\tau} $$\n将 $\\tau = R_{\\text{ct}} C_{\\text{dl}}$ 代回，我们得到顶点的角频率：\n$$ \\omega_{\\text{apex}} = \\frac{1}{R_{\\text{ct}} C_{\\text{dl}}} $$\n现在我们可以通过将 $\\omega_{\\text{apex}}$ 代入 $Z''(\\omega)$ 的表达式来计算虚部的最小值 $Z''_{\\min}$：\n$$ Z''_{\\min} = Z''(\\omega_{\\text{apex}}) = - \\frac{\\omega_{\\text{apex}} R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega_{\\text{apex}} R_{\\text{ct}} C_{\\text{dl}})^2} $$\n因为 $\\omega_{\\text{apex}} R_{\\text{ct}} C_{\\text{dl}} = (\\frac{1}{R_{\\text{ct}} C_{\\text{dl}}}) R_{\\text{ct}} C_{\\text{dl}} = 1$：\n$$ Z''_{\\min} = - \\frac{(\\frac{1}{R_{\\text{ct}} C_{\\text{dl}}}) R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + 1^2} = - \\frac{R_{\\text{ct}}}{2} $$\n\n现在，我们使用给定的数据计算数值：$R_{\\text{ct}} = 75.0\\,\\Omega$ 和 $C_{\\text{dl}} = 150.0\\,\\mu\\mathrm{F} = 150.0 \\times 10^{-6}\\,\\mathrm{F}$。\n\n首先，我们计算顶点角频率 $\\omega_{\\text{apex}}$：\n$$ \\omega_{\\text{apex}} = \\frac{1}{(75.0\\,\\Omega) \\times (150.0 \\times 10^{-6}\\,\\mathrm{F})} = \\frac{1}{0.01125\\,\\mathrm{s}} \\approx 88.888... \\,\\mathrm{rad/s} $$\n题目要求以 $\\mathrm{Hz}$ 为单位的频率 $f_{\\text{apex}}$，它与角频率的关系为 $f = \\frac{\\omega}{2\\pi}$：\n$$ f_{\\text{apex}} = \\frac{\\omega_{\\text{apex}}}{2\\pi} = \\frac{1}{2\\pi R_{\\text{ct}} C_{\\text{dl}}} = \\frac{1}{2\\pi \\times 0.01125\\,\\mathrm{s}} \\approx 14.1444\\,\\mathrm{Hz} $$\n四舍五入到四位有效数字，我们得到 $f_{\\text{apex}} = 14.14\\,\\mathrm{Hz}$。\n\n接下来，我们计算最小虚部值 $Z''_{\\min}$：\n$$ Z''_{\\min} = - \\frac{R_{\\text{ct}}}{2} = - \\frac{75.0\\,\\Omega}{2} = -37.5\\,\\Omega $$\n为表示为四位有效数字，我们写成 $Z''_{\\min} = -37.50\\,\\Omega$。\n\n所求的值是顶点频率 $f_{\\text{apex}}$ 和最小虚部 $Z''_{\\min}$。\n$f_{\\text{apex}} \\approx 14.14\\,\\mathrm{Hz}$\n$Z''_{\\min} = -37.50\\,\\Omega$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 14.14  -37.50 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了基础知识之后，这项练习将我们带入计算电化学家的核心任务：构建更真实的模型并进行验证。您将实现一个包含扩散效应（Warburg元件）的完整Randles电路，模拟其阻抗谱，并通过计算与合成的“测量”数据之间的残差来评估拟合优度。这项练习为连接理论方程与实际数据分析架起了桥梁。",
            "id": "4252755",
            "problem": "您的任务是基于线性电路理论的第一性原理，构建并验证一个兰德尔斯（Randles）电路的电化学阻抗谱（EIS）数据仿真。Randles电路由一个串联的溶液电阻与一个并联网络组成，该并联网络包含一个容性双电层和一个法拉第支路，法拉第支路又由电荷转移电阻和半无限扩散元件构成。您必须推导电路的阻抗，在多个频率数量级上仿真复阻抗，通过确定性扰动合成测量数据，并评估仿真模型与测量数据在实部和虚部上的残差。\n\n您的推导和计算必须仅基于以下基本要素：\n- 基于线性响应理论和欧姆定律的频域阻抗定义。\n- 对于电阻器，阻抗是恒定的实数。\n- 对于电容器，阻抗由 $Z_{C}(\\omega) = \\dfrac{1}{j \\, \\omega \\, C}$ 给出，其中 $j = \\sqrt{-1}$，$\\omega$ 是角频率。\n- 对于半无限扩散，Warburg阻抗由 $Z_{W}(\\omega) = \\dfrac{\\sigma \\, (1 - j)}{\\sqrt{\\omega}}$ 给出，其中 $\\sigma$ 是Warburg系数。\n- 阻抗的串并联组合规则：串联时，阻抗相加；并联时，$Z_{\\mathrm{parallel}} = \\left(\\sum_{k} \\dfrac{1}{Z_{k}}\\right)^{-1}$。\n\n需要建模的电路拓扑结构：\n- 一个溶液电阻 $R_{s}$ 与一个并联网络串联，该并联网络由双电层电容 $C_{\\mathrm{dl}}$ 和一个法拉第支路并联构成，法拉第支路则由电荷转移电阻 $R_{\\mathrm{ct}}$ 与Warburg元件 $Z_{W}(\\omega)$ 串联组成。\n\n任务：\n1. 从上述定义出发，推导所述Randles电路的总复阻抗 $Z(\\omega)$ 的数学表达式。不要使用或引用任何现成的 $Z(\\omega)$ 目标表达式；通过正确的串并联简化方法从基本定义中推导出来。\n2. 实现一个程序，该程序能够：\n   - 通过 $\\omega = 2\\pi f$ 将以赫兹为单位的频率转换为角频率。\n   - 对于给定的参数集 $\\{R_{s}, R_{\\mathrm{ct}}, C_{\\mathrm{dl}}, \\sigma\\}$，在一系列指定频率上计算模型预测值 $Z_{\\mathrm{model}}(\\omega)$。\n   - 通过使用一组“基准真相”参数集计算 $Z(\\omega)$，并加上下面指定的实部和虚部确定性扰动 $\\delta Z(\\omega)$，来合成测量数据集 $Z_{\\mathrm{meas}}(\\omega)$。\n   - 在所有频率 $k$ 上计算残差 $r^{\\prime}_{k} = Z^{\\prime}_{\\mathrm{meas}}(\\omega_{k}) - Z^{\\prime}_{\\mathrm{model}}(\\omega_{k})$ 和 $r^{\\prime\\prime}_{k} = Z^{\\prime\\prime}_{\\mathrm{meas}}(\\omega_{k}) - Z^{\\prime\\prime}_{\\mathrm{model}}(\\omega_{k})$。\n   - 每个测试用例报告三个指标：实部残差的均方根误差（RMSE），虚部残差的RMSE，以及由 $\\sqrt{(r^{\\prime}_{k})^{2} + (r^{\\prime\\prime}_{k})^{2}}$ 定义并在所有 $k$ 上平均的复数幅值的RMSE。所有指标都必须以欧姆为单位，并且是四舍五入到六位小数的浮点数。\n\n频率和单位：\n- 使用以赫兹为单位的频率列表 $f$：$[\\,0.1,\\,1,\\,10,\\,100,\\,1000,\\,10000\\,]$。\n- 角频率为 $\\omega = 2\\pi f$，单位为弧度/秒。\n- 电阻单位为欧姆 $\\Omega$，电容单位为法拉 $\\mathrm{F}$，Warburg系数参数 $\\sigma$ 的单位应使 $Z_{W}(\\omega)$ 的单位为欧姆 $\\Omega$，输出的残差指标必须以欧姆 $\\Omega$ 表示并四舍五入到六位小数。\n\n测试套件：\n实现您的程序以评估以下三个测试用例。在每个用例中，按如下方式构建测量数据\n$$\nZ_{\\mathrm{meas}}(\\omega_{k}) \\;=\\; Z\\big(\\omega_{k}; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast}\\big) \\;+\\; \\big(\\delta Z^{\\prime}_{k}\\big) \\;+\\; j\\,\\big(\\delta Z^{\\prime\\prime}_{k}\\big),\n$$\n其中，带星号的参数表示用于生成合成测量值的基准真相集，而 $\\delta Z^{\\prime}_{k}$、$\\delta Z^{\\prime\\prime}_{k}$ 是在频率索引 $k$ 处的实部和虚部的确定性扰动。\n\n- 情况1（理想路径，中等扩散）：\n  - 基准真相参数：$R_{s}^{\\ast} = 5$, $R_{\\mathrm{ct}}^{\\ast} = 100$, $C_{\\mathrm{dl}}^{\\ast} = 2\\times 10^{-5}$, $\\sigma^{\\ast} = 10$。\n  - 候选参数（用于 $Z_{\\mathrm{model}}$）：$R_{s} = 5$, $R_{\\mathrm{ct}} = 100$, $C_{\\mathrm{dl}} = 2\\times 10^{-5}$, $\\sigma = 10$。\n  - 确定性扰动（单位：欧姆）：\n    - 实部：$\\big[\\,0.05,\\,-0.03,\\,0.02,\\,-0.01,\\,0.00,\\,0.01\\,\\big]$，\n    - 虚部：$\\big[\\,-0.04,\\,0.02,\\,-0.01,\\,0.00,\\,0.01,\\,-0.02\\,\\big]$。\n\n- 情况2（参数不匹配，残差较强）：\n  - 基准真相参数：$R_{s}^{\\ast} = 3$, $R_{\\mathrm{ct}}^{\\ast} = 150$, $C_{\\mathrm{dl}}^{\\ast} = 1\\times 10^{-5}$, $\\sigma^{\\ast} = 8$。\n  - 候选参数（用于 $Z_{\\mathrm{model}}$）：$R_{s} = 3$, $R_{\\mathrm{ct}} = 130$, $C_{\\mathrm{dl}} = 1.2\\times 10^{-5}$, $\\sigma = 5$。\n  - 确定性扰动（单位：欧姆）：\n    - 实部：$\\big[\\,0.20,\\,-0.10,\\,0.10,\\,-0.10,\\,0.05,\\,-0.05\\,\\big]$，\n    - 虚部：$\\big[\\,-0.15,\\,0.10,\\,-0.05,\\,0.00,\\,0.05,\\,-0.10\\,\\big]$。\n\n- 情况3（边界条件，无扩散）：\n  - 基准真相参数：$R_{s}^{\\ast} = 2$, $R_{\\mathrm{ct}}^{\\ast} = 200$, $C_{\\mathrm{dl}}^{\\ast} = 5\\times 10^{-6}$, $\\sigma^{\\ast} = 0$。\n  - 候选参数（用于 $Z_{\\mathrm{model}}$）：$R_{s} = 2$, $R_{\\mathrm{ct}} = 200$, $C_{\\mathrm{dl}} = 5\\times 10^{-6}$, $\\sigma = 0$。\n  - 确定性扰动（单位：欧姆）：\n    - 实部：$\\big[\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,\\big]$，\n    - 虚部：$\\big[\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,\\big]$。\n\n输出规格：\n- 对于每个测试用例，计算三个以欧姆为单位的浮点数：$\\mathrm{RMSE}_{\\mathrm{real}}$、$\\mathrm{RMSE}_{\\mathrm{imag}}$ 和 $\\mathrm{RMSE}_{\\mathrm{mag}}$，每个都四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含所有九个结果，这些结果以平铺的、逗号分隔的列表形式包含在方括号中，按测试用例排序，并在每个用例内按指标顺序 $\\big(\\mathrm{RMSE}_{\\mathrm{real}}, \\mathrm{RMSE}_{\\mathrm{imag}}, \\mathrm{RMSE}_{\\mathrm{mag}}\\big)$ 排列。例如，输出格式必须是\n$$\n\\big[\\mathrm{RMSE}^{(1)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(1)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(1)}_{\\mathrm{mag}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{mag}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{mag}}\\big],\n$$\n其中每个条目的单位均为欧姆 $\\Omega$。",
            "solution": "该问题已经过验证，被认为是具有科学依据、适定且自洽的。所有提供的信息都是一致且充分的，足以推导出唯一、可验证的解。其基本原理是线性电路理论和电化学中的标准内容。我们现在开始求解。\n\n主要任务是为Randles电路的阻抗建模，并分析模型预测与人工合成数据之间的残差。这包括两个主要部分：首先，对总电路阻抗进行解析推导；其次，对模型和残差分析进行计算实现。\n\n**1. 总复阻抗 $Z(\\omega)$ 的推导**\n\n问题指定了一个具有特定拓扑结构的Randles电路。我们将利用所提供的串并联规则，通过系统地组合其组成元件的阻抗，来推导其总阻抗 $Z(\\omega)$ 的表达式。\n\n该电路由一个溶液电阻 $R_s$ 与一个并联子网络串联而成。该子网络包含两个并联支路：\n- 支路1：一个电容为 $C_{\\mathrm{dl}}$ 的双电层电容器。\n- 支路2：一个法拉第支路，其本身由一个电荷转移电阻 $R_{\\mathrm{ct}}$ 与一个Warburg元件 $Z_W$ 串联而成。\n\n让我们在频域中定义每个独立元件的阻抗，其中 $\\omega$ 是角频率，$j = \\sqrt{-1}$ 是虚数单位。\n- 溶液电阻的阻抗是纯实数：$Z_{R_s} = R_s$。\n- 电荷转移电阻的阻抗也是纯实数：$Z_{R_{\\mathrm{ct}}} = R_{\\mathrm{ct}}$。\n- 双电层电容器的阻抗由 $Z_{C_{\\mathrm{dl}}}(\\omega) = \\dfrac{1}{j \\omega C_{\\mathrm{dl}}}$ 给出。\n- Warburg元件的阻抗由 $Z_W(\\omega) = \\dfrac{\\sigma (1 - j)}{\\sqrt{\\omega}}$ 给出，可写作 $Z_W(\\omega) = \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}$。\n\n首先，我们求法拉第支路 $Z_F(\\omega)$ 的阻抗，它是 $R_{\\mathrm{ct}}$ 和 $Z_W(\\omega)$ 的串联组合。根据串联加法规则 $Z_{\\mathrm{series}} = \\sum_k Z_k$：\n$$\nZ_F(\\omega) = Z_{R_{\\mathrm{ct}}} + Z_W(\\omega) = R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}\n$$\n\n接下来，我们求并联子网络 $Z_p(\\omega)$ 的阻抗。该网络由法拉第支路 $Z_F(\\omega)$ 与双电层电容器 $Z_{C_{\\mathrm{dl}}}(\\omega)$ 并联构成。根据并联组合规则 $Z_{\\mathrm{parallel}} = \\left(\\sum_k \\frac{1}{Z_k}\\right)^{-1}$：\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{Z_F(\\omega)} + \\frac{1}{Z_{C_{\\mathrm{dl}}}(\\omega)}\n$$\n代入 $Z_F(\\omega)$ 和 $Z_{C_{\\mathrm{dl}}}(\\omega)$ 的表达式：\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + \\frac{1}{(1 / (j \\omega C_{\\mathrm{dl}}))}\n$$\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}}\n$$\n因此，并联子网络的阻抗为：\n$$\nZ_p(\\omega) = \\left( \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}} \\right)^{-1}\n$$\n\n最后，Randles电路的总阻抗 $Z(\\omega)$ 是溶液电阻 $R_s$ 与并联子网络 $Z_p(\\omega)$ 的串联组合。再次应用串联加法规则：\n$$\nZ(\\omega) = Z_{R_s} + Z_p(\\omega)\n$$\n代入 $Z_p(\\omega)$ 的表达式，我们得到从第一性原理推导出的总复阻抗的最终表达式：\n$$\nZ(\\omega) = R_s + \\left( \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}} \\right)^{-1}\n$$\n\n**2. 计算方法与残差分析**\n\n程序将实现推导出的表达式来计算阻抗值，并对三个测试用例中的每一个执行所需的分析。\n\n对于给定的参数集 $\\{R_s, R_{\\mathrm{ct}}, C_{\\mathrm{dl}}, \\sigma\\}$ 和频率列表 $f_k$，模型阻抗 $Z_{\\mathrm{model}}(\\omega_k)$ 的计算方法如下：\n- 对于给定列表 $[\\,0.1,\\,1,\\,10,\\,100,\\,1000,\\,10000\\,]\\ \\mathrm{Hz}$ 中的每个频率 $f_k$，角频率计算为 $\\omega_k = 2\\pi f_k$。\n- 使用推导出的公式计算复阻抗 $Z_{\\mathrm{model}}(\\omega_k)$。在计算中，这涉及复数算术。例如，在Python中，$j$ 表示为 `1j`。表达式变为 `Rs + 1.0 / (1.0 / (Rct + sigma * omega**-0.5 - 1j * sigma * omega**-0.5) + 1j * omega * Cdl)`。\n\n接下来，为每个测试用例生成合成的“测量”数据 $Z_{\\mathrm{meas}}(\\omega_k)$。这是通过首先使用基准真相参数计算基准真相阻抗 $Z(\\omega_k; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast})$，然后分别对实部和虚部加上指定的确定性扰动 $\\delta Z^{\\prime}_{k}$ 和 $\\delta Z^{\\prime\\prime}_{k}$ 来完成的：\n$$\nZ_{\\mathrm{meas}}(\\omega_{k}) = Z\\big(\\omega_{k}; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast}\\big) + \\delta Z^{\\prime}_{k} + j\\,\\delta Z^{\\prime\\prime}_{k}\n$$\n\n在所有 $N$ 个频率上计算出 $Z_{\\mathrm{model}}(\\omega_k)$ 和 $Z_{\\mathrm{meas}}(\\omega_k)$ 后，通过相减得到复数残差 $r_k$：\n$$\nr_k = Z_{\\mathrm{meas}}(\\omega_k) - Z_{\\mathrm{model}}(\\omega_k)\n$$\n提取残差的实部 $r'_k$ 和虚部 $r''_k$：\n$$\nr'_k = \\mathrm{Re}(r_k) = Z'_{\\mathrm{meas}}(\\omega_k) - Z'_{\\mathrm{model}}(\\omega_k)\n$$\n$$\nr''_k = \\mathrm{Im}(r_k) = Z''_{\\mathrm{meas}}(\\omega_k) - Z''_{\\mathrm{model}}(\\omega_k)\n$$\n\n最后，计算所需的三个均方根误差（RMSE）指标：\n1.  残差实部的RMSE：\n    $$\n    \\mathrm{RMSE}_{\\mathrm{real}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} (r'_k)^2}\n    $$\n2.  残差虚部的RMSE：\n    $$\n    \\mathrm{RMSE}_{\\mathrm{imag}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} (r''_k)^2}\n    $$\n3.  复数残差幅值的RMSE。单个复数残差的幅值为 $|r_k| = \\sqrt{(r'_k)^2 + (r''_k)^2}$。该量的RMSE为 $\\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} |r_k|^2}$。这可简化如下：\n    $$\n    \\mathrm{RMSE}_{\\mathrm{mag}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} \\left( (r'_k)^2 + (r''_k)^2 \\right)} = \\sqrt{\\left(\\frac{1}{N} \\sum_{k=1}^{N} (r'_k)^2\\right) + \\left(\\frac{1}{N} \\sum_{k=1}^{N} (r''_k)^2\\right)} = \\sqrt{\\mathrm{RMSE}_{\\mathrm{real}}^2 + \\mathrm{RMSE}_{\\mathrm{imag}}^2}\n    $$\n这个最终关系因其计算稳定性和数学上的简洁性而被使用。对于问题陈述中指定的三个测试用例中的每一个，所有三个指标都以欧姆（$\\Omega$）为单位报告，并四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the EIS modeling problem by deriving impedance, synthesizing data,\n    and calculating residuals and RMSE metrics for three test cases.\n    \"\"\"\n\n    # Frequencies in Hz as specified in the problem.\n    frequencies_hz = np.array([0.1, 1, 10, 100, 1000, 10000])\n    \n    # Angular frequencies in rad/s.\n    angular_frequencies = 2 * np.pi * frequencies_hz\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate diffusion)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 5.0, \n                \"Rct\": 100.0, \n                \"Cdl\": 2e-5, \n                \"sigma\": 10.0\n            },\n            \"model_params\": {\n                \"Rs\": 5.0, \n                \"Rct\": 100.0, \n                \"Cdl\": 2e-5, \n                \"sigma\": 10.0\n            },\n            \"perturb_real\": np.array([0.05, -0.03, 0.02, -0.01, 0.00, 0.01]),\n            \"perturb_imag\": np.array([-0.04, 0.02, -0.01, 0.00, 0.01, -0.02])\n        },\n        # Case 2 (parameter mismatch, stronger residuals)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 3.0, \n                \"Rct\": 150.0, \n                \"Cdl\": 1e-5, \n                \"sigma\": 8.0\n            },\n            \"model_params\": {\n                \"Rs\": 3.0, \n                \"Rct\": 130.0, \n                \"Cdl\": 1.2e-5, \n                \"sigma\": 5.0\n            },\n            \"perturb_real\": np.array([0.20, -0.10, 0.10, -0.10, 0.05, -0.05]),\n            \"perturb_imag\": np.array([-0.15, 0.10, -0.05, 0.00, 0.05, -0.10])\n        },\n        # Case 3 (boundary condition, no diffusion)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 2.0, \n                \"Rct\": 200.0, \n                \"Cdl\": 5e-6, \n                \"sigma\": 0.0\n            },\n            \"model_params\": {\n                \"Rs\": 2.0, \n                \"Rct\": 200.0, \n                \"Cdl\": 5e-6, \n                \"sigma\": 0.0\n            },\n            \"perturb_real\": np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"perturb_imag\": np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0])\n        }\n    ]\n\n    def calculate_impedance(params, omega):\n        \"\"\"\n        Calculates the complex impedance of the Randles circuit.\n\n        Args:\n            params (dict): Dictionary with keys 'Rs', 'Rct', 'Cdl', 'sigma'.\n            omega (np.ndarray): Array of angular frequencies.\n\n        Returns:\n            np.ndarray: Array of complex impedance values.\n        \"\"\"\n        Rs = params[\"Rs\"]\n        Rct = params[\"Rct\"]\n        Cdl = params[\"Cdl\"]\n        sigma = params[\"sigma\"]\n        \n        # Ensure omega is an array for vectorized operations\n        omega = np.asarray(omega)\n        \n        # Warburg impedance Z_W = sigma * (1-j) / sqrt(omega)\n        # Handle omega=0 if it occurred, though not in this problem's frequency list.\n        # This implementation with arrays avoids division by zero warnings if omega contains 0\n        # by checking sigma first.\n        if sigma == 0.0:\n            Z_W = np.zeros_like(omega, dtype=complex)\n        else:\n            # We use a small epsilon to avoid division by zero if omega ever contains 0\n            # Although problem frequencies are  0.\n            omega_safe = np.maximum(omega, 1e-12) \n            Z_W = sigma * (1 - 1j) * omega_safe**(-0.5)\n\n        # Faradaic impedance (R_ct in series with Z_W)\n        Z_F = Rct + Z_W\n        \n        # Admittance of the parallel part\n        # Y_p = 1/Z_F + 1/Z_Cdl = 1/Z_F + j*omega*Cdl\n        Y_p = 1.0 / Z_F + 1j * omega * Cdl\n        \n        # Impedance of the parallel part\n        Z_p = 1.0 / Y_p\n        \n        # Total impedance (R_s in series with Z_p)\n        Z_total = Rs + Z_p\n        \n        return Z_total\n\n    results = []\n    \n    for case in test_cases:\n        # 1. Compute ground-truth impedance\n        Z_truth = calculate_impedance(case[\"ground_truth_params\"], angular_frequencies)\n        \n        # 2. Synthesize measured data by adding perturbations\n        perturbations = case[\"perturb_real\"] + 1j * case[\"perturb_imag\"]\n        Z_meas = Z_truth + perturbations\n        \n        # 3. Compute model impedance\n        Z_model = calculate_impedance(case[\"model_params\"], angular_frequencies)\n        \n        # 4. Calculate residuals\n        residuals = Z_meas - Z_model\n        res_real = residuals.real\n        res_imag = residuals.imag\n        \n        # 5. Compute RMSE metrics\n        N = len(frequencies_hz)\n        \n        rmse_real = np.sqrt(np.sum(res_real**2) / N)\n        rmse_imag = np.sqrt(np.sum(res_imag**2) / N)\n        \n        # RMSE of magnitude can be calculated directly from the other two\n        rmse_mag = np.sqrt(rmse_real**2 + rmse_imag**2)\n        \n        # Append rounded results\n        results.append(round(rmse_real, 6))\n        results.append(round(rmse_imag, 6))\n        results.append(round(rmse_mag, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际研究中，通常有多个不同的模型可以用来描述同一组数据，但其准确性各不相同。最后一项练习引入了一个强大的统计工具——赤池信息准则（Akaike Information Criterion, AIC），用于客观地选择最佳模型。通过学习如何在模型的复杂性与拟合优度之间进行权衡，您将能够做出更严谨、更具说服力的建模决策，这是科学研究中的一项关键技能。",
            "id": "4252689",
            "problem": "您需要使用赤池信息准则 (AIC) 为电化学阻抗谱 (EIS) 模型实现一个模型选择程序。我们考虑两个候选模型：Randles电路模型和带有常相位角元件 (CPE) 的Randles模型。在此任务中，您必须从基本概率建模假设出发，推导出比较这些模型所需的计算公式。然后，实现该计算过程，并为每个提供的测试用例返回所选的模型。\n\n需要使用的基本依据如下：\n- 假设在每个采样频率下的独立测量噪声是具有未知方差的同分布高斯随机变量。残差定义为模型阻抗与测量阻抗（将实部和虚部堆叠）之间的差值，单位为欧姆。\n- 赤池信息准则 (AIC) 是根据最大似然定义的，模型选择通过选取具有较小AIC值的模型来执行。\n\n您的程序必须：\n- 在具有未知方差的高斯噪声假设下，仅使用最大似然框架中的基本步骤，推导出适用于此设置的AIC表达式。\n- 对于每个模型，根据给定的残差及其参数数量计算AIC。残差是以欧姆为单位的差值，数据点数 $n$ 等于所提供的残差向量的长度。\n- 比较AIC值，并选择AIC较小的模型。如果AIC值在微小的数值容差 $\\epsilon = 10^{-9}$ 内相等，则通过选择参数数量 $k$ 较小的模型来打破僵局。\n- 输出一行包含整数列表的内容，该列表按给定顺序编码了每个测试用例所选的模型：$0$ 代表Randles模型，$1$ 代表带有常相位角元件 (CPE) 的Randles模型。\n\n物理单位：\n- 残差单位为欧姆。请确保测试套件中提供的所有残差都以欧姆为单位处理。最终输出仅包含整数，无单位。\n\n测试套件：\n对于所有情况，Randles模型的参数数量为 $k_{\\mathrm{R}} = 3$，带有常相位角元件的Randles模型的参数数量为 $k_{\\mathrm{RCPE}} = 4$。\n\n- 情况1（一般情况，添加CPE后拟合有明显改善）：\n  - Randles模型残差（欧姆）：$\\left[\\,0.6,\\,-0.2,\\,0.1,\\,-0.3,\\,0.4,\\,-0.5,\\,0.2,\\,-0.1,\\,0.3,\\,-0.2\\,\\right]$。\n  - 带有CPE的Randles模型残差（欧姆）：$\\left[\\,0.3,\\,-0.1,\\,0.05,\\,-0.15,\\,0.2,\\,-0.25,\\,0.1,\\,-0.05,\\,0.12,\\,-0.08\\,\\right]$。\n\n- 情况2（边界情况，拟合质量几乎相同，倾向于更简单的模型）：\n  - Randles模型残差（欧姆）：$\\left[\\, -0.05,\\,0.05,\\,-0.02,\\,0.01,\\,-0.03,\\,0.02,\\,-0.01,\\,0.03 \\,\\right]$。\n  - 带有CPE的Randles模型残差（欧姆）：$\\left[\\, 0.05,\\,-0.05,\\,0.02,\\,-0.01,\\,0.03,\\,-0.02,\\,0.01,\\,-0.03 \\,\\right]$。\n\n- 情况3（样本量非常小的边缘情况，构造此情况以产生AIC平局，从而需要选择更简单的模型）：\n  - Randles模型残差（欧姆）：$\\left[\\, 0.27,\\,-0.17,\\,0.05,\\,-0.03 \\,\\right]$。\n  - 带有CPE的Randles模型残差（欧姆），经过缩放以在高斯假设下产生AIC平局：$\\left[\\, 0.21027621142927932,\\,-0.13239613312213882,\\,0.038940039153570245,\\,-0.023364023492142147 \\,\\right]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$），其中每个 $\\text{result}_i$ 是一个整数代码，表示按上述规定为第 $i$ 个情况选择的模型。",
            "solution": "任务是使用赤池信息准则 (AIC) 为两个电化学阻抗谱 (EIS) 模型实现一个模型选择程序。该选择将基于一个假设高斯噪声的基本概率框架。解决方案要求在此特定背景下严格推导AIC的计算公式，然后通过实现该公式来比较Randles模型和带有常相位角元件 (CPE) 的Randles模型在一组给定测试用例上的表现。\n\n推导过程从最大似然原理开始。假设一个给定模型有 $k$ 个可调参数，一个拟合程序产生了一组 $n$ 个残差 $\\mathbf{r} = \\{r_1, r_2, \\dots, r_n\\}$，这些残差是模型的预测值与测量数据点（在本例中，是阻抗的实部和虚部堆叠，单位为欧姆）之间的差值。\n\n核心假设是残差 $r_i$ 是从均值为零、方差 $\\sigma^2$ 未知的高斯分布中抽取的独立同分布 (i.i.d.) 随机变量。因此，单个残差 $r_i$ 的概率密度函数 (PDF) 为：\n$$ p(r_i | \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{r_i^2}{2\\sigma^2}\\right) $$\n由于残差的独立性，观测到整个残差集 $\\mathbf{r}$ 的似然函数 $L$ 是它们各自概率的乘积：\n$$ L(\\sigma^2 | \\mathbf{r}) = \\prod_{i=1}^{n} p(r_i | \\sigma^2) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{r_i^2}{2\\sigma^2}\\right) $$\n该表达式可以合并为：\n$$ L(\\sigma^2 | \\mathbf{r}) = \\left(2\\pi\\sigma^2\\right)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} r_i^2\\right) $$\n为了找到方差 $\\hat{\\sigma}^2$ 的最大似然估计 (MLE)，使用似然函数的自然对数，即对数似然 $\\ln L$，会更为方便：\n$$ \\ln L(\\sigma^2 | \\mathbf{r}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} r_i^2 $$\n令 $RSS = \\sum_{i=1}^{n} r_i^2$ 表示残差平方和。则对数似然为：\n$$ \\ln L(\\sigma^2 | \\mathbf{r}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^2) - \\frac{RSS}{2\\sigma^2} $$\n为了使该函数相对于 $\\sigma^2$ 最大化，我们计算其导数并将其设为零：\n$$ \\frac{\\partial (\\ln L)}{\\partial (\\sigma^2)} = -\\frac{n}{2\\sigma^2} + \\frac{RSS}{2(\\sigma^2)^2} $$\n将此导数设为零以求得最大似然估计 $\\hat{\\sigma}^2$：\n$$ -\\frac{n}{2\\hat{\\sigma}^2} + \\frac{RSS}{2(\\hat{\\sigma}^2)^2} = 0 \\implies \\frac{n}{\\hat{\\sigma}^2} = \\frac{RSS}{(\\hat{\\sigma}^2)^2} \\implies \\hat{\\sigma}^2 = \\frac{RSS}{n} $$\n此表达式即为残差方差的最大似然估计。\n\n接下来，我们将此估计值 $\\hat{\\sigma}^2$ 代入对数似然函数，以获得最大化的对数似然 $\\ln(\\hat{L})$：\n$$ \\ln(\\hat{L}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln\\left(\\frac{RSS}{n}\\right) - \\frac{RSS}{2(RSS/n)} $$\n$$ \\ln(\\hat{L}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln\\left(\\frac{RSS}{n}\\right) - \\frac{n}{2} $$\n$$ \\ln(\\hat{L}) = -\\frac{n}{2}\\left[\\ln\\left(\\frac{RSS}{n}\\right) + \\ln(2\\pi) + 1\\right] $$\n赤池信息准则定义为 $AIC = -2\\ln(\\hat{L}) + 2K$，其中 $K$ 是概率模型中估计参数的总数。在此回归背景下，这些参数包括确定性模型的 $k$ 个参数（例如电阻、电容）以及噪声的方差 $\\sigma^2$。因此，估计参数的总数为 $K = k+1$。\n将我们的 $\\ln(\\hat{L})$ 表达式和 $K=k+1$ 代入 AIC 定义：\n$$ AIC = -2 \\left(-\\frac{n}{2}\\left[\\ln\\left(\\frac{RSS}{n}\\right) + \\ln(2\\pi) + 1\\right]\\right) + 2(k+1) $$\n$$ AIC = n\\left[\\ln\\left(\\frac{RSS}{n}\\right) + \\ln(2\\pi) + 1\\right] + 2k + 2 $$\n$$ AIC = n\\ln\\left(\\frac{RSS}{n}\\right) + 2k + n(\\ln(2\\pi) + 1) + 2 $$\n当为同一数据集（即固定的 $n$）比较不同模型时，项 $n(\\ln(2\\pi) + 1) + 2$ 对所有模型来说都是一个常数。由于模型选择仅取决于AIC的相对值，而非其绝对大小，我们可以省略此常数项而不影响结果。这样就得出了一个用于模型比较的简化但等效的计算公式：\n$$ AIC_{\\text{comp}} = n\\ln\\left(\\frac{RSS}{n}\\right) + 2k $$\n这就是需要实现的公式。对于每个模型，我们计算该值，并选择具有最小 $AIC_{\\text{comp}}$ 的模型。\n\n模型选择的算法如下：\n1. 对于每个测试用例，考虑两个模型：Randles ($k_R=3$) 和 Randles+CPE ($k_{RCPE}=4$) 。\n2. 对于每个模型，获取残差向量并确定数据点数 $n$。\n3. 计算残差平方和 $RSS = \\sum_{i=1}^{n} r_i^2$。\n4. 使用公式 $AIC = n \\ln(RSS/n) + 2k$ 计算AIC值。\n5. 比较AIC值，$AIC_R$ 和 $AIC_{RCPE}$。\n6. 如果 $|AIC_R - AIC_{RCPE}|  10^{-9}$，则视为平局。平局决胜规则规定选择参数数量较小的模型，即Randles模型 ($k_R=3$)。所选模型的代码为 $0$。\n7. 否则，如果 $AIC_R  AIC_{RCPE}$，则选择Randles模型（代码 $0$）。\n8. 如果 $AIC_{RCPE}  AIC_R$，则选择Randles+CPE模型（代码 $1$）。\n此程序将应用于所有提供的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements model selection for EIS models using the Akaike Information Criterion (AIC).\n    The function computes AIC for two models (Randles and Randles+CPE) for three test cases,\n    selects the best model for each case, and prints the results.\n    \"\"\"\n\n    # Test suite provided in the problem statement.\n    # Each entry is a tuple: (randles_residuals, randles_cpe_residuals)\n    test_cases = [\n        (\n            [0.6, -0.2, 0.1, -0.3, 0.4, -0.5, 0.2, -0.1, 0.3, -0.2],\n            [0.3, -0.1, 0.05, -0.15, 0.2, -0.25, 0.1, -0.05, 0.12, -0.08]\n        ),\n        (\n            [-0.05, 0.05, -0.02, 0.01, -0.03, 0.02, -0.01, 0.03],\n            [0.05, -0.05, 0.02, -0.01, 0.03, -0.02, 0.01, -0.03]\n        ),\n        (\n            [0.27, -0.17, 0.05, -0.03],\n            [0.21027621142927932, -0.13239613312213882, 0.038940039153570245, -0.023364023492142147]\n        )\n    ]\n\n    # Parameter counts for the models\n    k_randles = 3\n    k_randles_cpe = 4\n\n    # Numerical tolerance for tie-breaking\n    epsilon = 1e-9\n\n    results = []\n\n    def calculate_aic(residuals, k):\n        \"\"\"\n        Calculates the AIC value based on the derived computational formula.\n\n        Args:\n            residuals (list[float]): A list of residuals from a model fit.\n            k (int): The number of parameters in the model.\n\n        Returns:\n            float: The calculated AIC value.\n        \"\"\"\n        n = len(residuals)\n        if n == 0:\n            # Avoid division by zero and log of zero/negative in edge cases.\n            return np.inf \n        \n        rss = np.sum(np.square(residuals))\n        \n        # In case RSS is zero or negative (due to numerical precision issues)\n        if rss = 0:\n            return -np.inf\n\n        # Derived computational formula for AIC: n*ln(RSS/n) + 2*k\n        aic_value = n * np.log(rss / n) + 2 * k\n        return aic_value\n\n    for residuals_r, residuals_rcpe in test_cases:\n        # Ensure that the number of data points is consistent for both models in a case\n        if len(residuals_r) != len(residuals_rcpe):\n            raise ValueError(\"Residual vectors must have the same length for a given case.\")\n            \n        # Calculate AIC for both models\n        aic_r = calculate_aic(residuals_r, k_randles)\n        aic_rcpe = calculate_aic(residuals_rcpe, k_randles_cpe)\n\n        # Compare AIC values and select the model\n        # Model 0: Randles, Model 1: Randles+CPE\n        if abs(aic_r - aic_rcpe)  epsilon:\n            # Tie-breaking rule: choose model with smaller k\n            if k_randles  k_randles_cpe:\n                results.append(0)\n            else:\n                # This else branch is general, but in this problem k_randles is always smaller\n                results.append(1) \n        elif aic_r  aic_rcpe:\n            results.append(0)  # Randles model is better\n        else:\n            results.append(1)  # Randles+CPE model is better\n            \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}