{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation in impedance modeling, we begin with the cornerstone of EIS analysis: the Randles circuit. This exercise grounds the abstract theory of complex impedance in a tangible calculation by connecting the circuit's physical components—solution resistance $R_s$, charge-transfer resistance $R_{\\text{ct}}$, and double-layer capacitance $C_{\\text{dl}}$—to a key visual feature of the Nyquist plot. By deriving the frequency at which the iconic semicircle reaches its apex, you will develop a firsthand understanding of how kinetic and capacitive properties of an electrode interface govern its frequency response . This practice is fundamental for learning to interpret impedance spectra visually and quantitatively.",
            "id": "4252778",
            "problem": "An Electrochemical Impedance Spectroscopy (EIS) measurement of a simple electrode process is modeled by a Randles circuit consisting of a solution resistance $R_{s}$ in series with a parallel combination of a charge-transfer resistance $R_{\\text{ct}}$ and a double-layer capacitance $C_{\\text{dl}}$. Assume ideal elements with no diffusive (Warburg) contribution. Using only the fundamental definitions of impedance for a resistor, $Z_{R} = R$, and for a capacitor, $Z_{C} = \\frac{1}{j \\omega C}$, together with series and parallel composition rules, derive the angular-frequency-dependent complex impedance $Z(\\omega)$ of the circuit and determine the angular frequency at which the Nyquist semicircle attains its apex. The apex corresponds to the most negative value of the imaginary part $Z''(\\omega)$ on the Nyquist plot.\n\nGiven $R_{s} = 2.50\\,\\Omega$, $R_{\\text{ct}} = 75.0\\,\\Omega$, and $C_{\\text{dl}} = 150.0\\,\\mu\\mathrm{F}$, compute:\n- the apex frequency $f_{\\text{apex}}$ in $\\mathrm{Hz}$, where $f_{\\text{apex}} = \\frac{\\omega_{\\text{apex}}}{2\\pi}$, and\n- the corresponding minimum imaginary-part value $Z''_{\\min}$ in $\\Omega$.\n\nRound both numeric answers to four significant figures. Express the frequency in $\\mathrm{Hz}$ and the imaginary-part value in $\\Omega$.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of circuit theory and electrochemistry, is well-posed with sufficient information for a unique solution, and is stated objectively. We proceed with the solution.\n\nThe electrochemical system is modeled by a Randles circuit. The total impedance, $Z(\\omega)$, is composed of a solution resistance, $R_s$, in series with a parallel combination of the charge-transfer resistance, $R_{\\text{ct}}$, and the double-layer capacitance, $C_{\\text{dl}}$.\n\nThe impedance of a resistor $R$ is $Z_R = R$, and the impedance of a capacitor $C$ is $Z_C = \\frac{1}{j \\omega C}$, where $j = \\sqrt{-1}$ is the imaginary unit and $\\omega$ is the angular frequency.\n\nFirst, we determine the impedance of the parallel part of the circuit, $Z_p$, which consists of $R_{\\text{ct}}$ and $C_{\\text{dl}}$. For parallel components, the reciprocal of the total impedance is the sum of the reciprocals of the individual impedances:\n$$ \\frac{1}{Z_p(\\omega)} = \\frac{1}{Z_{R_{\\text{ct}}}} + \\frac{1}{Z_{C_{\\text{dl}}}} $$\nSubstituting the impedance definitions, we get:\n$$ \\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\text{ct}}} + \\frac{1}{1/(j \\omega C_{\\text{dl}})} = \\frac{1}{R_{\\text{ct}}} + j \\omega C_{\\text{dl}} $$\nTo solve for $Z_p(\\omega)$, we take the reciprocal:\n$$ Z_p(\\omega) = \\left( \\frac{1}{R_{\\text{ct}}} + j \\omega C_{\\text{dl}} \\right)^{-1} = \\left( \\frac{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}}{R_{\\text{ct}}} \\right)^{-1} = \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n\nThe total impedance of the circuit, $Z(\\omega)$, is the sum of the series components: $R_s$ and $Z_p(\\omega)$.\n$$ Z(\\omega) = R_s + Z_p(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\nTo separate the total impedance into its real part, $Z'(\\omega)$, and imaginary part, $Z''(\\omega)$, we multiply the numerator and denominator of the second term by the complex conjugate of its denominator, which is $1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}$:\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + j \\omega R_{\\text{ct}} C_{\\text{dl}}} \\times \\frac{1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}}{1 - j \\omega R_{\\text{ct}} C_{\\text{dl}}} $$\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}} (1 - j \\omega R_{\\text{ct}} C_{\\text{dl}})}{1^2 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n$$ Z(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} - j \\frac{\\omega R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega R_{\\text_dl})^2} $$\nFrom this expression, we identify the real and imaginary parts:\n$$ Z'(\\omega) = R_s + \\frac{R_{\\text{ct}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n$$ Z''(\\omega) = - \\frac{\\omega R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega R_{\\text{ct}} C_{\\text{dl}})^2} $$\n\nThe apex of the Nyquist semicircle corresponds to the extremum (minimum value) of the imaginary part, $Z''(\\omega)$. To find the angular frequency $\\omega_{\\text{apex}}$ at which this occurs, we take the derivative of $Z''(\\omega)$ with respect to $\\omega$ and set it to zero. Let's define the characteristic time constant of the charge-transfer process as $\\tau = R_{\\text{ct}} C_{\\text{dl}}$.\n$$ Z''(\\omega) = - \\frac{\\omega R_{\\text{ct}} \\tau}{1 + (\\omega \\tau)^2} $$\nUsing the quotient rule for differentiation, $\\frac{d}{dx}(\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$, with $u = \\omega$ and $v = 1 + (\\omega \\tau)^2$:\n$$ \\frac{dZ''}{d\\omega} = -R_{\\text{ct}}\\tau \\frac{d}{d\\omega} \\left( \\frac{\\omega}{1 + (\\omega\\tau)^2} \\right) = -R_{\\text{ct}}\\tau \\left[ \\frac{(1)(1 + (\\omega\\tau)^2) - (\\omega)(2\\omega\\tau^2)}{(1 + (\\omega\\tau)^2)^2} \\right] $$\n$$ \\frac{dZ''}{d\\omega} = -R_{\\text{ct}}\\tau \\left[ \\frac{1 + \\omega^2\\tau^2 - 2\\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} \\right] = -R_{\\text{ct}}\\tau \\frac{1 - \\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} $$\nSetting the derivative to zero to find the extremum:\n$$ \\frac{1 - \\omega^2\\tau^2}{(1 + (\\omega\\tau)^2)^2} = 0 $$\nThis condition is met when the numerator is zero. Since $\\omega$ must be positive, we have:\n$$ 1 - \\omega^2\\tau^2 = 0 \\implies \\omega^2\\tau^2 = 1 \\implies \\omega_{\\text{apex}} = \\frac{1}{\\tau} $$\nSubstituting $\\tau = R_{\\text{ct}} C_{\\text{dl}}$ back, we find the angular frequency at the apex:\n$$ \\omega_{\\text{apex}} = \\frac{1}{R_{\\text{ct}} C_{\\text{dl}}} $$\nNow we can compute the minimum value of the imaginary part, $Z''_{\\min}$, by substituting $\\omega_{\\text{apex}}$ into the expression for $Z''(\\omega)$:\n$$ Z''_{\\min} = Z''(\\omega_{\\text{apex}}) = - \\frac{\\omega_{\\text{apex}} R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + (\\omega_{\\text{apex}} R_{\\text{ct}} C_{\\text{dl}})^2} $$\nSince $\\omega_{\\text{apex}} R_{\\text{ct}} C_{\\text{dl}} = (\\frac{1}{R_{\\text{ct}} C_{\\text{dl}}}) R_{\\text{ct}} C_{\\text{dl}} = 1$:\n$$ Z''_{\\min} = - \\frac{(\\frac{1}{R_{\\text{ct}} C_{\\text{dl}}}) R_{\\text{ct}}^2 C_{\\text{dl}}}{1 + 1^2} = - \\frac{R_{\\text{ct}}}{2} $$\n\nNow, we compute the numerical values using the given data: $R_{\\text{ct}} = 75.0\\,\\Omega$ and $C_{\\text{dl}} = 150.0\\,\\mu\\mathrm{F} = 150.0 \\times 10^{-6}\\,\\mathrm{F}$.\n\nFirst, we calculate the apex angular frequency $\\omega_{\\text{apex}}$:\n$$ \\omega_{\\text{apex}} = \\frac{1}{(75.0\\,\\Omega) \\times (150.0 \\times 10^{-6}\\,\\mathrm{F})} = \\frac{1}{0.01125\\,\\mathrm{s}} \\approx 88.888... \\,\\mathrm{rad/s} $$\nThe problem asks for the frequency $f_{\\text{apex}}$ in $\\mathrm{Hz}$, which is related to the angular frequency by $f = \\frac{\\omega}{2\\pi}$:\n$$ f_{\\text{apex}} = \\frac{\\omega_{\\text{apex}}}{2\\pi} = \\frac{1}{2\\pi R_{\\text{ct}} C_{\\text{dl}}} = \\frac{1}{2\\pi \\times 0.01125\\,\\mathrm{s}} \\approx 14.1444\\,\\mathrm{Hz} $$\nRounding to four significant figures, we get $f_{\\text{apex}} = 14.14\\,\\mathrm{Hz}$.\n\nNext, we calculate the minimum imaginary-part value $Z''_{\\min}$:\n$$ Z''_{\\min} = - \\frac{R_{\\text{ct}}}{2} = - \\frac{75.0\\,\\Omega}{2} = -37.5\\,\\Omega $$\nTo express this to four significant figures, we write $Z''_{\\min} = -37.50\\,\\Omega$.\n\nThe requested values are the apex frequency $f_{\\text{apex}}$ and the minimum imaginary part $Z''_{\\min}$.\n$f_{\\text{apex}} \\approx 14.14\\,\\mathrm{Hz}$\n$Z''_{\\min} = -37.50\\,\\Omega$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 14.14  -37.50 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from simple circuits to more realistic scenarios, this practice introduces the Warburg element to account for mass-transport limitations, a common phenomenon in electrochemical systems. Here, you will transition from analytical derivation to computational implementation, a core skill for modern electrochemical modeling. You are tasked with coding the full Randles-Warburg model, simulating its impedance spectrum, and critically evaluating its fit against a synthetic dataset by analyzing the residuals . This exercise mirrors the essential workflow of model validation, teaching you how to quantify the agreement between a theoretical model and experimental data.",
            "id": "4252755",
            "problem": "You are tasked with constructing and validating a simulation of Electrochemical Impedance Spectroscopy (EIS) data for a Randles circuit using first principles from linear circuit theory. The Randles circuit consists of a series solution resistance and a parallel combination of a capacitive double layer and a Faradaic branch that includes charge-transfer resistance and semi-infinite diffusion. You must derive the impedance of the circuit, simulate the complex impedance over decades of frequency, synthesize measured data via a deterministic perturbation, and assess the residuals between the simulated model and the measured data in both the real and imaginary parts.\n\nBase your derivation and computation on the following foundational elements only:\n- The definition of impedance in the frequency domain based on linear response theory and Ohm’s law.\n- For a resistor, the impedance is constant and real.\n- For a capacitor, the impedance is given by $Z_{C}(\\omega) = \\dfrac{1}{j \\, \\omega \\, C}$, where $j = \\sqrt{-1}$ and $\\omega$ is the angular frequency.\n- For semi-infinite diffusion, the Warburg impedance is given by $Z_{W}(\\omega) = \\dfrac{\\sigma \\, (1 - j)}{\\sqrt{\\omega}}$, where $\\sigma$ is the Warburg coefficient.\n- Series and parallel combination rules for impedances: for series, impedances add; for parallel, $Z_{\\mathrm{parallel}} = \\left(\\sum_{k} \\dfrac{1}{Z_{k}}\\right)^{-1}$.\n\nCircuit topology to be modeled:\n- A solution resistance $R_{s}$ in series with a parallel network of a double-layer capacitance $C_{\\mathrm{dl}}$ and a Faradaic branch composed of a charge-transfer resistance $R_{\\mathrm{ct}}$ in series with a Warburg element $Z_{W}(\\omega)$.\n\nTasks:\n1. Starting from the definitions given above, derive the mathematical expression for the total complex impedance $Z(\\omega)$ of the described Randles circuit. Do not use or cite any pre-packaged target expressions for $Z(\\omega)$; derive it via correct series-parallel reduction from the base definitions.\n2. Implement a program that:\n   - Converts frequency in hertz to angular frequency via $\\omega = 2\\pi f$.\n   - Computes the model prediction $Z_{\\mathrm{model}}(\\omega)$ for a given parameter set $\\{R_{s}, R_{\\mathrm{ct}}, C_{\\mathrm{dl}}, \\sigma\\}$ across a specified list of frequencies.\n   - Synthesizes a measured dataset $Z_{\\mathrm{meas}}(\\omega)$ by taking a “ground-truth” parameter set, computing $Z(\\omega)$ from it, and adding a deterministic perturbation $\\delta Z(\\omega)$ whose real and imaginary parts are specified below.\n   - Computes residuals $r^{\\prime}_{k} = Z^{\\prime}_{\\mathrm{meas}}(\\omega_{k}) - Z^{\\prime}_{\\mathrm{model}}(\\omega_{k})$ and $r^{\\prime\\prime}_{k} = Z^{\\prime\\prime}_{\\mathrm{meas}}(\\omega_{k}) - Z^{\\prime\\prime}_{\\mathrm{model}}(\\omega_{k})$ over all frequencies $k$.\n   - Reports three metrics per test case: the root-mean-square error (RMSE) of the real residuals, the RMSE of the imaginary residuals, and the RMSE of the complex magnitude defined by $\\sqrt{(r^{\\prime}_{k})^{2} + (r^{\\prime\\prime}_{k})^{2}}$ averaged over $k$. All metrics must be expressed in ohms and should be floats rounded to six decimal places.\n\nFrequencies and units:\n- Use the frequency list $f$ in hertz: $[\\,0.1,\\,1,\\,10,\\,100,\\,1000,\\,10000\\,]$.\n- Angular frequency is $\\omega = 2\\pi f$ in radians per second.\n- Resistances are in ohms $\\Omega$, capacitance in farads $\\mathrm{F}$, the Warburg coefficient parameter $\\sigma$ has units such that $Z_{W}(\\omega)$ is in ohms $\\Omega$, and the output residual metrics must be expressed in ohms $\\Omega$ and rounded to six decimal places.\n\nTest suite:\nImplement your program to evaluate the following three test cases. In each case, construct the measured data as\n$$\nZ_{\\mathrm{meas}}(\\omega_{k}) \\;=\\; Z\\big(\\omega_{k}; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast}\\big) \\;+\\; \\big(\\delta Z^{\\prime}_{k}\\big) \\;+\\; j\\,\\big(\\delta Z^{\\prime\\prime}_{k}\\big),\n$$\nwhere the starred parameters indicate the ground truth set used to generate the synthetic measurement and $\\delta Z^{\\prime}_{k}$, $\\delta Z^{\\prime\\prime}_{k}$ are the deterministic perturbations for the real and imaginary parts at frequency index $k$.\n\n- Case $1$ (happy path, moderate diffusion):\n  - Ground-truth parameters: $R_{s}^{\\ast} = 5$, $R_{\\mathrm{ct}}^{\\ast} = 100$, $C_{\\mathrm{dl}}^{\\ast} = 2\\times 10^{-5}$, $\\sigma^{\\ast} = 10$.\n  - Candidate parameters (for $Z_{\\mathrm{model}}$): $R_{s} = 5$, $R_{\\mathrm{ct}} = 100$, $C_{\\mathrm{dl}} = 2\\times 10^{-5}$, $\\sigma = 10$.\n  - Deterministic perturbations in ohms:\n    - Real part: $\\big[\\,0.05,\\,-0.03,\\,0.02,\\,-0.01,\\,0.00,\\,0.01\\,\\big]$,\n    - Imaginary part: $\\big[\\,-0.04,\\,0.02,\\,-0.01,\\,0.00,\\,0.01,\\,-0.02\\,\\big]$.\n\n- Case $2$ (parameter mismatch, stronger residuals):\n  - Ground-truth parameters: $R_{s}^{\\ast} = 3$, $R_{\\mathrm{ct}}^{\\ast} = 150$, $C_{\\mathrm{dl}}^{\\ast} = 1\\times 10^{-5}$, $\\sigma^{\\ast} = 8$.\n  - Candidate parameters (for $Z_{\\mathrm{model}}$): $R_{s} = 3$, $R_{\\mathrm{ct}} = 130$, $C_{\\mathrm{dl}} = 1.2\\times 10^{-5}$, $\\sigma = 5$.\n  - Deterministic perturbations in ohms:\n    - Real part: $\\big[\\,0.20,\\,-0.10,\\,0.10,\\,-0.10,\\,0.05,\\,-0.05\\,\\big]$,\n    - Imaginary part: $\\big[\\,-0.15,\\,0.10,\\,-0.05,\\,0.00,\\,0.05,\\,-0.10\\,\\big]$.\n\n- Case $3$ (boundary condition, no diffusion):\n  - Ground-truth parameters: $R_{s}^{\\ast} = 2$, $R_{\\mathrm{ct}}^{\\ast} = 200$, $C_{\\mathrm{dl}}^{\\ast} = 5\\times 10^{-6}$, $\\sigma^{\\ast} = 0$.\n  - Candidate parameters (for $Z_{\\mathrm{model}}$): $R_{s} = 2$, $R_{\\mathrm{ct}} = 200$, $C_{\\mathrm{dl}} = 5\\times 10^{-6}$, $\\sigma = 0$.\n  - Deterministic perturbations in ohms:\n    - Real part: $\\big[\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,\\big]$,\n    - Imaginary part: $\\big[\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,\\big]$.\n\nOutput specification:\n- For each test case, compute three floats in ohms: $\\mathrm{RMSE}_{\\mathrm{real}}$, $\\mathrm{RMSE}_{\\mathrm{imag}}$, and $\\mathrm{RMSE}_{\\mathrm{mag}}$, each rounded to six decimal places.\n- Your program should produce a single line of output containing all nine results in a flat, comma-separated list enclosed in square brackets, ordered by test case and within each case by the metric in the order $\\big(\\mathrm{RMSE}_{\\mathrm{real}}, \\mathrm{RMSE}_{\\mathrm{imag}}, \\mathrm{RMSE}_{\\mathrm{mag}}\\big)$. For example, the output format must be\n$$\n\\big[\\mathrm{RMSE}^{(1)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(1)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(1)}_{\\mathrm{mag}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(2)}_{\\mathrm{mag}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{real}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{imag}},\\,\\mathrm{RMSE}^{(3)}_{\\mathrm{mag}}\\big],\n$$\nwith each entry in ohms $\\Omega$.",
            "solution": "The problem has been validated and is deemed to be scientifically grounded, well-posed, and self-contained. All provided information is consistent and sufficient to derive a unique, verifiable solution. The underlying principles are standard in linear circuit theory and electrochemistry. We now proceed with the solution.\n\nThe primary task is to model the impedance of a Randles circuit and analyze the residuals between a model prediction and synthetically generated data. This involves two main parts: first, the analytical derivation of the total circuit impedance, and second, the computational implementation of the model and residual analysis.\n\n**1. Derivation of the Total Complex Impedance $Z(\\omega)$**\n\nThe problem specifies a Randles circuit with a particular topology. We will derive the expression for its total impedance, $Z(\\omega)$, by systematically combining the impedances of its constituent components using the provided series and parallel rules.\n\nThe circuit consists of a solution resistance, $R_s$, in series with a parallel sub-network. This sub-network comprises two parallel branches:\n- Branch 1: A double-layer capacitor with capacitance $C_{\\mathrm{dl}}$.\n- Branch 2: A Faradaic branch, which itself consists of a charge-transfer resistance, $R_{\\mathrm{ct}}$, in series with a Warburg element, $Z_W$.\n\nLet us define the impedance of each individual component in the frequency domain, where $\\omega$ is the angular frequency and $j = \\sqrt{-1}$ is the imaginary unit.\n- The impedance of the solution resistor is purely real: $Z_{R_s} = R_s$.\n- The impedance of the charge-transfer resistor is also purely real: $Z_{R_{\\mathrm{ct}}} = R_{\\mathrm{ct}}$.\n- The impedance of the double-layer capacitor is given by $Z_{C_{\\mathrm{dl}}}(\\omega) = \\dfrac{1}{j \\omega C_{\\mathrm{dl}}}$.\n- The impedance of the Warburg element is given by $Z_W(\\omega) = \\dfrac{\\sigma (1 - j)}{\\sqrt{\\omega}}$, which can be written as $Z_W(\\omega) = \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}$.\n\nFirst, we find the impedance of the Faradaic branch, $Z_F(\\omega)$, which is the series combination of $R_{\\mathrm{ct}}$ and $Z_W(\\omega)$. Using the series addition rule, $Z_{\\mathrm{series}} = \\sum_k Z_k$:\n$$\nZ_F(\\omega) = Z_{R_{\\mathrm{ct}}} + Z_W(\\omega) = R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}\n$$\n\nNext, we find the impedance of the parallel sub-network, $Z_p(\\omega)$. This network consists of the Faradaic branch, $Z_F(\\omega)$, in parallel with the double-layer capacitor, $Z_{C_{\\mathrm{dl}}}(\\omega)$. Using the parallel combination rule, $Z_{\\mathrm{parallel}} = \\left(\\sum_k \\frac{1}{Z_k}\\right)^{-1}$:\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{Z_F(\\omega)} + \\frac{1}{Z_{C_{\\mathrm{dl}}}(\\omega)}\n$$\nSubstituting the expressions for $Z_F(\\omega)$ and $Z_{C_{\\mathrm{dl}}}(\\omega)$:\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + \\frac{1}{(1 / (j \\omega C_{\\mathrm{dl}}))}\n$$\n$$\n\\frac{1}{Z_p(\\omega)} = \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}}\n$$\nTherefore, the impedance of the parallel sub-network is:\n$$\nZ_p(\\omega) = \\left( \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}} \\right)^{-1}\n$$\n\nFinally, the total impedance of the Randles circuit, $Z(\\omega)$, is the series combination of the solution resistance, $R_s$, and the parallel sub-network, $Z_p(\\omega)$. Applying the series addition rule once more:\n$$\nZ(\\omega) = Z_{R_s} + Z_p(\\omega)\n$$\nSubstituting the expression for $Z_p(\\omega)$, we arrive at the final expression for the total complex impedance derived from first principles:\n$$\nZ(\\omega) = R_s + \\left( \\frac{1}{R_{\\mathrm{ct}} + \\sigma \\omega^{-1/2} - j \\sigma \\omega^{-1/2}} + j \\omega C_{\\mathrm{dl}} \\right)^{-1}\n$$\n\n**2. Computational Method and Residual Analysis**\n\nThe program will implement the derived expression to compute impedance values and perform the required analysis for each of the three test cases.\n\nFor a given set of parameters $\\{R_s, R_{\\mathrm{ct}}, C_{\\mathrm{dl}}, \\sigma\\}$ and a list of frequencies $f_k$, the model impedance $Z_{\\mathrm{model}}(\\omega_k)$ is calculated as follows:\n- For each frequency $f_k$ in the given list $[\\,0.1,\\,1,\\,10,\\,100,\\,1000,\\,10000\\,]\\ \\mathrm{Hz}$, the angular frequency is computed as $\\omega_k = 2\\pi f_k$.\n- The complex impedance $Z_{\\mathrm{model}}(\\omega_k)$ is calculated using the derived formula. In computation, this involves complex number arithmetic. For example, in Python, $j$ is represented as `1j`. The expression becomes `Rs + 1.0 / (1.0 / (Rct + sigma * omega**-0.5 - 1j * sigma * omega**-0.5) + 1j * omega * Cdl)`.\n\nNext, the synthetic \"measured\" data, $Z_{\\mathrm{meas}}(\\omega_k)$, is generated for each test case. This is done by first computing the ground-truth impedance $Z(\\omega_k; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast})$ using the ground-truth parameters, and then adding the specified deterministic perturbations, $\\delta Z^{\\prime}_{k}$ and $\\delta Z^{\\prime\\prime}_{k}$, for the real and imaginary parts, respectively:\n$$\nZ_{\\mathrm{meas}}(\\omega_{k}) = Z\\big(\\omega_{k}; R_{s}^{\\ast}, R_{\\mathrm{ct}}^{\\ast}, C_{\\mathrm{dl}}^{\\ast}, \\sigma^{\\ast}\\big) + \\delta Z^{\\prime}_{k} + j\\,\\delta Z^{\\prime\\prime}_{k}\n$$\n\nWith both $Z_{\\mathrm{model}}(\\omega_k)$ and $Z_{\\mathrm{meas}}(\\omega_k)$ computed for all $N$ frequencies, the complex residuals $r_k$ are found by subtraction:\n$$\nr_k = Z_{\\mathrm{meas}}(\\omega_k) - Z_{\\mathrm{model}}(\\omega_k)\n$$\nThe real and imaginary parts of the residuals, $r'_k$ and $r''_k$, are extracted:\n$$\nr'_k = \\mathrm{Re}(r_k) = Z'_{\\mathrm{meas}}(\\omega_k) - Z'_{\\mathrm{model}}(\\omega_k)\n$$\n$$\nr''_k = \\mathrm{Im}(r_k) = Z''_{\\mathrm{meas}}(\\omega_k) - Z''_{\\mathrm{model}}(\\omega_k)\n$$\n\nFinally, the three required root-mean-square error (RMSE) metrics are calculated:\n1.  The RMSE of the real part of the residuals:\n    $$\n    \\mathrm{RMSE}_{\\mathrm{real}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} (r'_k)^2}\n    $$\n2.  The RMSE of the imaginary part of the residuals:\n    $$\n    \\mathrm{RMSE}_{\\mathrm{imag}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} (r''_k)^2}\n    $$\n3.  The RMSE of the magnitude of the complex residuals. The magnitude of a single complex residual is $|r_k| = \\sqrt{(r'_k)^2 + (r''_k)^2}$. The RMSE of this quantity is $\\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} |r_k|^2}$. This simplifies as follows:\n    $$\n    \\mathrm{RMSE}_{\\mathrm{mag}} = \\sqrt{\\frac{1}{N} \\sum_{k=1}^{N} \\left( (r'_k)^2 + (r''_k)^2 \\right)} = \\sqrt{\\left(\\frac{1}{N} \\sum_{k=1}^{N} (r'_k)^2\\right) + \\left(\\frac{1}{N} \\sum_{k=1}^{N} (r''_k)^2\\right)} = \\sqrt{\\mathrm{RMSE}_{\\mathrm{real}}^2 + \\mathrm{RMSE}_{\\mathrm{imag}}^2}\n    $$\nThis final relationship is used for its computational stability and mathematical elegance. All three metrics are reported in ohms ($\\Omega$), rounded to six decimal places, for each of the three test cases specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the EIS modeling problem by deriving impedance, synthesizing data,\n    and calculating residuals and RMSE metrics for three test cases.\n    \"\"\"\n\n    # Frequencies in Hz as specified in the problem.\n    frequencies_hz = np.array([0.1, 1, 10, 100, 1000, 10000])\n    \n    # Angular frequencies in rad/s.\n    angular_frequencies = 2 * np.pi * frequencies_hz\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate diffusion)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 5.0, \n                \"Rct\": 100.0, \n                \"Cdl\": 2e-5, \n                \"sigma\": 10.0\n            },\n            \"model_params\": {\n                \"Rs\": 5.0, \n                \"Rct\": 100.0, \n                \"Cdl\": 2e-5, \n                \"sigma\": 10.0\n            },\n            \"perturb_real\": np.array([0.05, -0.03, 0.02, -0.01, 0.00, 0.01]),\n            \"perturb_imag\": np.array([-0.04, 0.02, -0.01, 0.00, 0.01, -0.02])\n        },\n        # Case 2 (parameter mismatch, stronger residuals)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 3.0, \n                \"Rct\": 150.0, \n                \"Cdl\": 1e-5, \n                \"sigma\": 8.0\n            },\n            \"model_params\": {\n                \"Rs\": 3.0, \n                \"Rct\": 130.0, \n                \"Cdl\": 1.2e-5, \n                \"sigma\": 5.0\n            },\n            \"perturb_real\": np.array([0.20, -0.10, 0.10, -0.10, 0.05, -0.05]),\n            \"perturb_imag\": np.array([-0.15, 0.10, -0.05, 0.00, 0.05, -0.10])\n        },\n        # Case 3 (boundary condition, no diffusion)\n        {\n            \"ground_truth_params\": {\n                \"Rs\": 2.0, \n                \"Rct\": 200.0, \n                \"Cdl\": 5e-6, \n                \"sigma\": 0.0\n            },\n            \"model_params\": {\n                \"Rs\": 2.0, \n                \"Rct\": 200.0, \n                \"Cdl\": 5e-6, \n                \"sigma\": 0.0\n            },\n            \"perturb_real\": np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),\n            \"perturb_imag\": np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0])\n        }\n    ]\n\n    def calculate_impedance(params, omega):\n        \"\"\"\n        Calculates the complex impedance of the Randles circuit.\n\n        Args:\n            params (dict): Dictionary with keys 'Rs', 'Rct', 'Cdl', 'sigma'.\n            omega (np.ndarray): Array of angular frequencies.\n\n        Returns:\n            np.ndarray: Array of complex impedance values.\n        \"\"\"\n        Rs = params[\"Rs\"]\n        Rct = params[\"Rct\"]\n        Cdl = params[\"Cdl\"]\n        sigma = params[\"sigma\"]\n        \n        # Ensure omega is an array for vectorized operations\n        omega = np.asarray(omega)\n        \n        # Warburg impedance Z_W = sigma * (1-j) / sqrt(omega)\n        # Handle omega=0 if it occurred, though not in this problem's frequency list.\n        # This implementation with arrays avoids division by zero warnings if omega contains 0\n        # by checking sigma first.\n        if sigma == 0.0:\n            Z_W = np.zeros_like(omega, dtype=complex)\n        else:\n            # We use a small epsilon to avoid division by zero if omega ever contains 0\n            # Although problem frequencies are  0.\n            omega_safe = np.maximum(omega, 1e-12) \n            Z_W = sigma * (1 - 1j) * omega_safe**(-0.5)\n\n        # Faradaic impedance (R_ct in series with Z_W)\n        Z_F = Rct + Z_W\n        \n        # Admittance of the parallel part\n        # Y_p = 1/Z_F + 1/Z_Cdl = 1/Z_F + j*omega*Cdl\n        Y_p = 1.0 / Z_F + 1j * omega * Cdl\n        \n        # Impedance of the parallel part\n        Z_p = 1.0 / Y_p\n        \n        # Total impedance (R_s in series with Z_p)\n        Z_total = Rs + Z_p\n        \n        return Z_total\n\n    results = []\n    \n    for case in test_cases:\n        # 1. Compute ground-truth impedance\n        Z_truth = calculate_impedance(case[\"ground_truth_params\"], angular_frequencies)\n        \n        # 2. Synthesize measured data by adding perturbations\n        perturbations = case[\"perturb_real\"] + 1j * case[\"perturb_imag\"]\n        Z_meas = Z_truth + perturbations\n        \n        # 3. Compute model impedance\n        Z_model = calculate_impedance(case[\"model_params\"], angular_frequencies)\n        \n        # 4. Calculate residuals\n        residuals = Z_meas - Z_model\n        res_real = residuals.real\n        res_imag = residuals.imag\n        \n        # 5. Compute RMSE metrics\n        N = len(frequencies_hz)\n        \n        rmse_real = np.sqrt(np.sum(res_real**2) / N)\n        rmse_imag = np.sqrt(np.sum(res_imag**2) / N)\n        \n        # RMSE of magnitude can be calculated directly from the other two\n        rmse_mag = np.sqrt(rmse_real**2 + rmse_imag**2)\n        \n        # Append rounded results\n        results.append(round(rmse_real, 6))\n        results.append(round(rmse_imag, 6))\n        results.append(round(rmse_mag, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The final practice addresses a sophisticated and crucial question in scientific modeling: given a set of data, how do we select the best model? Simply adding more parameters often yields a better fit, but this can lead to overfitting and a less predictive model. This exercise introduces the Akaike Information Criterion (AIC), a powerful tool from information theory that formalizes the principle of parsimony, balancing goodness-of-fit with model complexity . By deriving the AIC from the principle of maximum likelihood and applying it to choose between a simple Randles circuit and a more complex model incorporating a Constant Phase Element (CPE), you will learn to make objective, statistically sound decisions about model validity.",
            "id": "4252689",
            "problem": "You are to implement a model selection procedure for Electrochemical Impedance Spectroscopy (EIS) models using the Akaike Information Criterion (AIC). Two candidate models are considered: the Randles circuit model and the Randles plus Constant Phase Element (CPE) model. In this task, you must start from the fundamental probabilistic modeling assumption and derive the computational formula needed to compare the models. Then, implement the computation and return the chosen model for each provided test case.\n\nThe fundamental base to use is the following:\n- Independent measurement noise at each sampled frequency is assumed to be an identically distributed Gaussian random variable with unknown variance. Let the residuals be the differences between the modeled and measured impedance (stacking the real and imaginary parts), expressed in ohms.\n- The Akaike Information Criterion (AIC) is defined in terms of maximum likelihood, and model selection is performed by choosing the model with the smaller AIC.\n\nYour program must:\n- Derive the expression for the AIC appropriate to this setting under the Gaussian noise assumption with unknown variance, using only principle-based steps from the maximum likelihood framework.\n- For each model, compute the AIC from the given residuals and its parameter count. The residuals are differences in ohms, and the number of data points $n$ equals the length of the provided residual vector.\n- Compare the AIC values and select the model with the smaller AIC. If the AIC values are equal within a small numerical tolerance $\\epsilon = 10^{-9}$, break ties by choosing the model with the smaller parameter count $k$.\n- Output a single line containing a list of integers that encodes the selected model for each test case, in the order given: $0$ for the Randles model and $1$ for the Randles plus Constant Phase Element (CPE) model.\n\nPhysical units:\n- Residuals are in ohms. Ensure that all residuals provided in the test suite are treated as ohms. The final output consists only of integers and is unitless.\n\nTest suite:\nFor all cases, the parameter counts are $k_{\\mathrm{R}} = 3$ for the Randles model and $k_{\\mathrm{RCPE}} = 4$ for the Randles plus Constant Phase Element model.\n\n- Case 1 (general case, noticeable fit improvement with added CPE):\n  - Randles residuals (ohms): $\\left[\\,0.6,\\,-0.2,\\,0.1,\\,-0.3,\\,0.4,\\,-0.5,\\,0.2,\\,-0.1,\\,0.3,\\,-0.2\\,\\right]$.\n  - Randles plus CPE residuals (ohms): $\\left[\\,0.3,\\,-0.1,\\,0.05,\\,-0.15,\\,0.2,\\,-0.25,\\,0.1,\\,-0.05,\\,0.12,\\,-0.08\\,\\right]$.\n\n- Case 2 (boundary case with nearly identical fit quality, favor simpler model):\n  - Randles residuals (ohms): $\\left[\\, -0.05,\\,0.05,\\,-0.02,\\,0.01,\\,-0.03,\\,0.02,\\,-0.01,\\,0.03 \\,\\right]$.\n  - Randles plus CPE residuals (ohms): $\\left[\\, 0.05,\\,-0.05,\\,0.02,\\,-0.01,\\,0.03,\\,-0.02,\\,0.01,\\,-0.03 \\,\\right]$.\n\n- Case 3 (edge case with very small sample size, constructed to yield an AIC tie requiring the simpler model to be chosen):\n  - Randles residuals (ohms): $\\left[\\, 0.27,\\,-0.17,\\,0.05,\\,-0.03 \\,\\right]$.\n  - Randles plus CPE residuals (ohms), scaled to produce an AIC tie under the Gaussian assumption: $\\left[\\, 0.21027621142927932,\\,-0.13239613312213882,\\,0.038940039153570245,\\,-0.023364023492142147 \\,\\right]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$), where each $\\text{result}_i$ is an integer code indicating the selected model for the $i$-th case as specified above.",
            "solution": "The task is to implement a model selection procedure for two electrochemical impedance spectroscopy (EIS) models using the Akaike Information Criterion (AIC). The selection is to be based on a fundamental probabilistic framework assuming Gaussian noise. The solution requires a rigorous derivation of the computational formula for AIC in this specific context, followed by its implementation to compare the Randles model and the Randles plus Constant Phase Element (CPE) model for a given set of test cases.\n\nThe derivation proceeds from the maximum likelihood principle. Let a given model have $k$ adjustable parameters, and let a fitting procedure produce a set of $n$ residuals, $\\mathbf{r} = \\{r_1, r_2, \\dots, r_n\\}$, which are the differences between the model's predictions and the measured data points (in this case, the stacked real and imaginary parts of the impedance in ohms).\n\nThe core assumption is that the residuals $r_i$ are independent and identically distributed (i.i.d.) random variables drawn from a Gaussian distribution with a mean of zero and an unknown variance $\\sigma^2$. The probability density function (PDF) for a single residual $r_i$ is therefore:\n$$ p(r_i | \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{r_i^2}{2\\sigma^2}\\right) $$\nDue to the independence of the residuals, the likelihood function $L$ for observing the entire set of residuals $\\mathbf{r}$ is the product of their individual probabilities:\n$$ L(\\sigma^2 | \\mathbf{r}) = \\prod_{i=1}^{n} p(r_i | \\sigma^2) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{r_i^2}{2\\sigma^2}\\right) $$\nThis expression can be consolidated as:\n$$ L(\\sigma^2 | \\mathbf{r}) = \\left(2\\pi\\sigma^2\\right)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} r_i^2\\right) $$\nTo find the maximum likelihood estimate (MLE) of the variance, $\\hat{\\sigma}^2$, it is more convenient to work with the natural logarithm of the likelihood function, the log-likelihood $\\ln L$:\n$$ \\ln L(\\sigma^2 | \\mathbf{r}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} r_i^2 $$\nLet $RSS = \\sum_{i=1}^{n} r_i^2$ denote the Residual Sum of Squares. The log-likelihood is then:\n$$ \\ln L(\\sigma^2 | \\mathbf{r}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^2) - \\frac{RSS}{2\\sigma^2} $$\nTo maximize this function with respect to $\\sigma^2$, we compute its derivative and set it to zero:\n$$ \\frac{\\partial (\\ln L)}{\\partial (\\sigma^2)} = -\\frac{n}{2\\sigma^2} + \\frac{RSS}{2(\\sigma^2)^2} $$\nSetting this derivative to zero to find the MLE $\\hat{\\sigma}^2$:\n$$ -\\frac{n}{2\\hat{\\sigma}^2} + \\frac{RSS}{2(\\hat{\\sigma}^2)^2} = 0 \\implies \\frac{n}{\\hat{\\sigma}^2} = \\frac{RSS}{(\\hat{\\sigma}^2)^2} \\implies \\hat{\\sigma}^2 = \\frac{RSS}{n} $$\nThis expression is the maximum likelihood estimate for the variance of the residuals.\n\nNext, we substitute this estimate $\\hat{\\sigma}^2$ back into the log-likelihood function to obtain the maximized log-likelihood, $\\ln(\\hat{L})$:\n$$ \\ln(\\hat{L}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln\\left(\\frac{RSS}{n}\\right) - \\frac{RSS}{2(RSS/n)} $$\n$$ \\ln(\\hat{L}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln\\left(\\frac{RSS}{n}\\right) - \\frac{n}{2} $$\n$$ \\ln(\\hat{L}) = -\\frac{n}{2}\\left[\\ln\\left(\\frac{RSS}{n}\\right) + \\ln(2\\pi) + 1\\right] $$\nThe Akaike Information Criterion is defined as $AIC = -2\\ln(\\hat{L}) + 2K$, where $K$ is the total number of estimated parameters in the probabilistic model. In this regression context, the parameters are the $k$ parameters of the deterministic model (e.g., resistances, capacitances) and the variance $\\sigma^2$ of the noise. Thus, the total number of estimated parameters is $K = k+1$.\nSubstituting our expression for $\\ln(\\hat{L})$ and $K=k+1$ into the AIC definition:\n$$ AIC = -2 \\left(-\\frac{n}{2}\\left[\\ln\\left(\\frac{RSS}{n}\\right) + \\ln(2\\pi) + 1\\right]\\right) + 2(k+1) $$\n$$ AIC = n\\left[\\ln\\left(\\frac{RSS}{n}\\right) + \\ln(2\\pi) + 1\\right] + 2k + 2 $$\n$$ AIC = n\\ln\\left(\\frac{RSS}{n}\\right) + 2k + n(\\ln(2\\pi) + 1) + 2 $$\nWhen comparing different models for the same dataset (i.e., for a fixed $n$), the term $n(\\ln(2\\pi) + 1) + 2$ is a constant across all models. Since model selection depends only on the relative values of AIC, not their absolute magnitudes, we can drop this constant term without affecting the outcome. This yields a simplified, but equivalent, computational formula for model comparison:\n$$ AIC_{\\text{comp}} = n\\ln\\left(\\frac{RSS}{n}\\right) + 2k $$\nThis is the formula to be implemented. For each model, we calculate this value and select the model with the minimum $AIC_{\\text{comp}}$.\n\nThe algorithm for model selection is as follows:\n1. For each test case, consider the two models: Randles ($k_R=3$) and Randles+CPE ($k_{RCPE}=4$).\n2. For each model, retrieve the vector of residuals and determine the number of data points, $n$.\n3. Calculate the Residual Sum of Squares, $RSS = \\sum_{i=1}^{n} r_i^2$.\n4. Compute the AIC value using the formula $AIC = n \\ln(RSS/n) + 2k$.\n5. Compare the AIC values, $AIC_R$ and $AIC_{RCPE}$.\n6. If $|AIC_R - AIC_{RCPE}|  10^{-9}$, a tie is declared. The tie-breaking rule dictates selecting the model with the smaller parameter count, which is the Randles model ($k_R=3$). The selected model code is $0$.\n7. Otherwise, if $AIC_R  AIC_{RCPE}$, select the Randles model (code $0$).\n8. If $AIC_{RCPE}  AIC_R$, select the Randles+CPE model (code $1$).\nThis procedure will be applied to all test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements model selection for EIS models using the Akaike Information Criterion (AIC).\n    The function computes AIC for two models (Randles and Randles+CPE) for three test cases,\n    selects the best model for each case, and prints the results.\n    \"\"\"\n\n    # Test suite provided in the problem statement.\n    # Each entry is a tuple: (randles_residuals, randles_cpe_residuals)\n    test_cases = [\n        (\n            [0.6, -0.2, 0.1, -0.3, 0.4, -0.5, 0.2, -0.1, 0.3, -0.2],\n            [0.3, -0.1, 0.05, -0.15, 0.2, -0.25, 0.1, -0.05, 0.12, -0.08]\n        ),\n        (\n            [-0.05, 0.05, -0.02, 0.01, -0.03, 0.02, -0.01, 0.03],\n            [0.05, -0.05, 0.02, -0.01, 0.03, -0.02, 0.01, -0.03]\n        ),\n        (\n            [0.27, -0.17, 0.05, -0.03],\n            [0.21027621142927932, -0.13239613312213882, 0.038940039153570245, -0.023364023492142147]\n        )\n    ]\n\n    # Parameter counts for the models\n    k_randles = 3\n    k_randles_cpe = 4\n\n    # Numerical tolerance for tie-breaking\n    epsilon = 1e-9\n\n    results = []\n\n    def calculate_aic(residuals, k):\n        \"\"\"\n        Calculates the AIC value based on the derived computational formula.\n\n        Args:\n            residuals (list[float]): A list of residuals from a model fit.\n            k (int): The number of parameters in the model.\n\n        Returns:\n            float: The calculated AIC value.\n        \"\"\"\n        n = len(residuals)\n        if n == 0:\n            # Avoid division by zero and log of zero/negative in edge cases.\n            return np.inf \n        \n        rss = np.sum(np.square(residuals))\n        \n        # In case RSS is zero or negative (due to numerical precision issues)\n        if rss = 0:\n            return -np.inf\n\n        # Derived computational formula for AIC: n*ln(RSS/n) + 2*k\n        aic_value = n * np.log(rss / n) + 2 * k\n        return aic_value\n\n    for residuals_r, residuals_rcpe in test_cases:\n        # Ensure that the number of data points is consistent for both models in a case\n        if len(residuals_r) != len(residuals_rcpe):\n            raise ValueError(\"Residual vectors must have the same length for a given case.\")\n            \n        # Calculate AIC for both models\n        aic_r = calculate_aic(residuals_r, k_randles)\n        aic_rcpe = calculate_aic(residuals_rcpe, k_randles_cpe)\n\n        # Compare AIC values and select the model\n        # Model 0: Randles, Model 1: Randles+CPE\n        if abs(aic_r - aic_rcpe)  epsilon:\n            # Tie-breaking rule: choose model with smaller k\n            if k_randles  k_randles_cpe:\n                results.append(0)\n            else:\n                # This else branch is general, but in this problem k_randles is always smaller\n                results.append(1) \n        elif aic_r  aic_rcpe:\n            results.append(0)  # Randles model is better\n        else:\n            results.append(1)  # Randles+CPE model is better\n            \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}