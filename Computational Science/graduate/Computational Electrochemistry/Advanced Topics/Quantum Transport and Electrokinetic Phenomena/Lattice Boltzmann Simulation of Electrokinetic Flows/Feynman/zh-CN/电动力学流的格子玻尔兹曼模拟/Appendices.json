{
    "hands_on_practices": [
        {
            "introduction": "将真实世界的物理问题转化为可靠的数值模拟，第一步便是精确地设定模拟参数。本练习将指导您如何将流体的运动粘度和离子的扩散系数等宏观物理量，转换为格子玻尔兹曼方法 (LBM) 中的无量纲松弛时间 $\\tau$。通过该练习，您将学会在满足稳定性和精度约束（例如马赫数限制）的前提下，选择合适的时间步长和松弛时间，这是连接理论与实际模拟的关键一步。",
            "id": "4250003",
            "problem": "需要使用晶格玻尔兹曼方法 (LBM) 模拟二维电渗微通道流。该方法对流体使用基于 D2Q9 晶格的单弛豫时间 (SRT) Bhatnagar-Gross-Krook (BGK) 碰撞算子，并耦合一个基于 D2Q5 晶格的对流-扩散 LBM 来模拟单一离子物质。微通道高度指定为 $H = 128 \\,\\mu\\text{m}$，在垂直于壁面的方向上用 $N_y = 128$ 个晶格节点均匀解析，因此晶格间距为 $\\Delta x = H/N_y$。特征流速为 $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$，运动粘度为 $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$（室温下的水），离子扩散系数为 $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$（典型的单价小离子）。\n\n从带有 Bhatnagar-Gross-Krook (BGK) 弛豫的玻尔兹曼方程及其二阶 Chapman–Enskog 流体动力学极限出发，推导将流体动力学运动粘度和标量扩散系数与 D2Q9 和 D2Q5 晶格上相应 LBM 弛豫时间联系起来的关系式。使用这些关系式来确定晶格单位下的弛豫时间 $\\tau$（流体）和 $\\tau_s$（物质），使其在以下约束条件下同时再现目标 $\\nu_{\\text{phys}}$ 和 $D_{\\text{phys}}$：\n- 低马赫数约束：在特征速度 $U^{\\ast}$ 下，晶格马赫数满足 $\\text{Ma} \\leq 0.05$。\n- 正定性和稳定性：$\\tau > \\tfrac{1}{2}$ 且 $\\tau_s > \\tfrac{1}{2}$。\n- 效率和精度约束：选择允许的最大时间步长 $\\Delta t$，使得 $\\tau \\leq 1.0$。\n\n假设 D2Q9 和 D2Q5 具有标准矩各向同性，使得晶格声速满足 $c_s^2 = \\tfrac{1}{3}$（以晶格单位表示）。将最终答案表示为晶格单位（无量纲）下的数对 $(\\tau, \\tau_s)$。将每个弛豫时间四舍五入至六位有效数字。",
            "solution": "首先通过提取给定信息并评估其科学合理性、一致性和完整性来验证问题。\n\n### 步骤 1: 提取的已知条件\n- **系统**: 二维电渗微通道流。\n- **模拟方法**: 晶格玻尔兹曼方法 (LBM)，使用单弛豫时间 (SRT) BGK 碰撞算子。\n- **流体晶格**: D2Q9。\n- **离子物质晶格**: D2Q5，用于单一对流-扩散物质。\n- **物理尺寸**: 通道高度 $H = 128 \\,\\mu\\text{m}$。\n- **离散化**: 在法向方向上有 $N_y = 128$ 个晶格节点，晶格间距为 $\\Delta x = H/N_y$。\n- **物理性质**:\n    - 特征流速 $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$。\n    - 运动粘度 $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$。\n    - 离子扩散系数 $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$。\n- **理论基础**: 从 BGK-玻尔兹曼方程的二阶 Chapman–Enskog 流体动力学极限推导。\n- **约束条件**:\n    1. 低马赫数约束: 在速度 $U^{\\ast}$ 下，$\\text{Ma} \\leq 0.05$。\n    2. 正定性和稳定性: $\\tau > \\frac{1}{2}$ 且 $\\tau_s > \\frac{1}{2}$。\n    3. 效率和精度约束: 选择允许的最大时间步长 $\\Delta t$，使得 $\\tau \\leq 1.0$。\n- **晶格性质**: D2Q9 和 D2Q5 的标准矩各向同性，使得晶格声速的平方在晶格单位下为 $c_s^2 = \\frac{1}{3}$。\n- **要求输出**: 无量纲晶格单位下的弛豫时间 $(\\tau, \\tau_s)$，四舍五入至六位有效数字。\n\n### 步骤 2: 验证\n该问题具有科学依据，是适定且客观的。它描述了计算流体动力学中的一个标准问题，特别是晶格玻尔兹曼模拟的参数化，以匹配物理输运系数。物理值对于水和小型离子是符合实际的。这些约束是确保 LBM 模拟的稳定性、准确性和计算效率的标准做法。所有必要信息均已提供，且无内部矛盾。\n\n### 结论\n问题有效。将构建解答。\n\n### 解答推导\n宏观输运性质与 LBM 弛豫时间之间的联系是通过对带有 BGK 碰撞算子的晶格玻尔兹曼方程进行 Chapman-Enskog 展开来建立的。对于在 D2Q9 晶格上模拟的流体和在 D2Q5 晶格上模拟的标量物质，假设采用标准低马赫数平衡分布函数，得到的宏观方程会给出运动粘度 $\\nu$ 和物质扩散系数 $D$ 的表达式。\n\n在晶格单位（由下标 'lb' 表示）中，这些关系式为：\n$$\n\\nu_{\\text{lb}} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\n$$\n$$\nD_{\\text{lb}} = c_s^2 \\left(\\tau_s - \\frac{1}{2}\\right)\n$$\n其中 $\\tau$ 是流体动量的弛豫时间，$\\tau_s$ 是标量物质的弛豫时间，而 $c_s$ 是晶格声速。问题指定对于两个模拟组分，$c_s^2 = \\frac{1}{3}$。\n\n为了确定 $\\tau$ 和 $\\tau_s$ 的数值，我们必须将物理性质（$\\nu_{\\text{phys}}$, $D_{\\text{phys}}$）与其在晶格单位下的对应量（$\\nu_{\\text{lb}}$, $D_{\\text{lb}}$）联系起来。这需要定义长度和时间的转换因子。设物理晶格间距为 $\\Delta x$，物理时间步长为 $\\Delta t$。\n\n单位转换如下：\n- 长度: $x_{\\text{phys}} = \\Delta x \\cdot x_{\\text{lb}}$\n- 时间: $t_{\\text{phys}} = \\Delta t \\cdot t_{\\text{lb}}$\n由此，我们推导出运动粘度和扩散系数的转换关系，它们的单位均为长度的平方除以时间：\n$$\n\\nu_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} \\nu_{\\text{lb}} \\implies \\nu_{\\text{lb}} = \\frac{\\Delta t}{(\\Delta x)^2} \\nu_{\\text{phys}}\n$$\n$$\nD_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} D_{\\text{lb}} \\implies D_{\\text{lb}} = \\frac{\\Delta t}{(\\Delta x)^2} D_{\\text{phys}}\n$$\n\n首先，我们计算物理晶格间距 $\\Delta x$：\n$$\n\\Delta x = \\frac{H}{N_y} = \\frac{128 \\times 10^{-6} \\,\\text{m}}{128} = 1.0 \\times 10^{-6} \\,\\text{m}\n$$\n\n接下来，我们必须确定物理时间步长 $\\Delta t$。问题提出了一组约束来固定这个自由参数。“效率和精度约束”要求我们选择允许的最大 $\\Delta t$，使得流体弛豫时间 $\\tau \\leq 1.0$。最大化 $\\Delta t$ 可以提高计算效率，而这个最大值对应于约束的上限，即设置 $\\tau = 1.0$。\n\n设置 $\\tau = 1.0$，我们合并粘度的方程：\n$$\n\\frac{\\Delta t}{(\\Delta x)^2} \\nu_{\\text{phys}} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\n$$\n我们求解 $\\tau = 1.0$ 时的 $\\Delta t$：\n$$\n\\Delta t = \\frac{c_s^2 \\left(1.0 - \\frac{1}{2}\\right) (\\Delta x)^2}{\\nu_{\\text{phys}}}\n$$\n代入已知值：$\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$，$\\Delta x = 1.0 \\times 10^{-6} \\,\\text{m}$，以及 $c_s^2 = \\frac{1}{3}$：\n$$\n\\Delta t = \\frac{\\frac{1}{3} \\left(\\frac{1}{2}\\right) (1.0 \\times 10^{-6} \\,\\text{m})^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{\\frac{1}{6} \\times 1.0 \\times 10^{-12} \\,\\text{m}^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{1}{6} \\times 10^{-6} \\,\\text{s}\n$$\n因此，$\\tau = 1.0$。该值满足稳定性约束 $\\tau > \\frac{1}{2}$。\n\n我们现在必须检查这个 $\\Delta t$ 的选择是否满足低马赫数约束，$\\text{Ma} \\leq 0.05$。晶格马赫数是 $\\text{Ma} = U_{\\text{lb}} / c_s$，其中 $U_{\\text{lb}}$ 是晶格单位下的特征速度。速度的转换为：\n$$\nU_{\\text{phys}} = \\frac{\\Delta x}{\\Delta t} U_{\\text{lb}} \\implies U_{\\text{lb}} = \\frac{\\Delta t}{\\Delta x} U_{\\text{phys}}\n$$\n使用特征物理速度 $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$：\n$$\nU_{\\text{lb}} = \\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{1.0 \\times 10^{-6} \\,\\text{m}} \\times (1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}) = \\frac{1}{6} \\times 10^{-3}\n$$\n马赫数为：\n$$\n\\text{Ma} = \\frac{U_{\\text{lb}}}{c_s} = \\frac{\\frac{1}{6} \\times 10^{-3}}{1/\\sqrt{3}} = \\frac{\\sqrt{3}}{6} \\times 10^{-3} \\approx 0.0002887\n$$\n由于 $0.0002887 \\leq 0.05$，马赫数约束得到满足。\n\n最后，我们计算物质弛豫时间 $\\tau_s$。我们有：\n$$\n\\tau_s = \\frac{D_{\\text{lb}}}{c_s^2} + \\frac{1}{2}\n$$\n代入 $D_{\\text{lb}}$ 的表达式：\n$$\n\\tau_s = \\frac{1}{c_s^2} \\left(\\frac{\\Delta t}{(\\Delta x)^2} D_{\\text{phys}}\\right) + \\frac{1}{2}\n$$\n现在，代入数值：$D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$ 和先前确定的参数：\n$$\n\\tau_s = \\frac{1}{1/3} \\left(\\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{(1.0 \\times 10^{-6} \\,\\text{m})^2} \\times 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = 3 \\left(\\frac{\\frac{1}{6} \\times 10^{-6}}{1.0 \\times 10^{-12}} \\times 1.0 \\times 10^{-9}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = 3 \\left(\\frac{1}{6} \\times 10^{6} \\times 10^{-9}\\right) + \\frac{1}{2} = 3 \\left(\\frac{1}{6} \\times 10^{-3}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = \\frac{1}{2} \\times 10^{-3} + \\frac{1}{2} = 0.0005 + 0.5 = 0.5005\n$$\n该值满足稳定性约束 $\\tau_s > \\frac{1}{2}$。\n\n得到的弛豫时间对为 $(\\tau, \\tau_s) = (1.0, 0.5005)$。按要求四舍五入至六位有效数字，得到 $(\\tau, \\tau_s) = (1.00000, 0.500500)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.00000 & 0.500500\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "任何数值方法都包含近似，理解其引入的误差是保证模拟结果可靠性的核心。本练习聚焦于LBM中广泛使用的半步长反弹边界条件，并量化其在解析电双层（EDL）内剧烈速度梯度时的误差。通过将数值计算出的梯度与精确的解析解进行比较，您将深入理解网格分辨率与EDL厚度的相对大小如何影响电渗流模拟的准确性。",
            "id": "4250002",
            "problem": "考虑一个与位于 $y=0$ 处的刚性无滑移壁面相邻的半无限平面电解质。一个外部电场 $E_x$ 沿平行于壁面的 $x$ 方向施加。该电解质是牛顿流体，动力粘度为 $\\eta$，介电常数为 $\\varepsilon$，双电层中的电势足够小，以至于线性化的泊松-玻尔兹曼近似成立。近壁面流动是由双电层（EDL）内的空间电荷上的电体力驱动的。在格子玻尔兹曼方法（LBM）中，当第一个流体节点位于 $y=\\Delta$ 时，最简单的半步回弹边界条件在 $y=\\Delta/2$ 处强制施加零速度，其中 $\\Delta$ 是格子间距（单位为米）。当EDL厚度 $\\lambda_D$（单位为米）小于几个格子间距时，这种半步定位会在解析近壁面速度梯度时引入误差。\n\n从基本的连续介质关系——即高斯定律和EDL中电势的线性化泊松-玻尔兹曼方程，以及不可压缩流体的稳态斯托克斯动量平衡方程——出发，利用第一性原理推导德拜-休克尔体系中电渗流的近壁面速度剖面 $u(y)$ 和真实的壁面剪切率 $\\left.\\frac{du}{dy}\\right|_{y=0}$。然后，利用第一个流体节点处的速度和链接中点无滑移位置的速度，形式化一个简单的半步回弹LBM在数值上会解析出的梯度。将解析出的近壁面梯度的无量纲相对误差 $\\mathcal{E}$ 定义为回弹格式解析的梯度与真实壁面剪切率之比减一。\n\n你的任务是编写一个程序，对于给定的一组 $(\\Delta,\\lambda_D)$ 对，计算由简单的半步回弹边界条件在解析近壁面速度梯度时引入的无量纲相对误差 $\\mathcal{E}$。使用如下定义：回弹格式解析的梯度由半步壁面位置所隐含的有限差分给出：取 $y=\\Delta$ 处的速度和 $y=\\Delta/2$ 处的零速度，并通过该差值除以半间距来近似近壁面梯度（即，使用与半步回弹一致的自然离散估计量）。所有输入 $\\Delta$ 和 $\\lambda_D$ 均以米为单位。输出 $\\mathcal{E}$ 是无量纲浮点数，必须以小数形式报告。\n\n在代码中实现你的推导，并为以下旨在检验不同情况的测试套件计算 $\\mathcal{E}$：\n- 情况1（理想情况）：$\\Delta=10\\times 10^{-9}$ m, $\\lambda_D=10\\times 10^{-9}$ m。\n- 情况2（EDL相对于网格较薄）：$\\Delta=5\\times 10^{-9}$ m, $\\lambda_D=2\\times 10^{-9}$ m。\n- 情况3（EDL相对于网格较厚）：$\\Delta=5\\times 10^{-9}$ m, $\\lambda_D=50\\times 10^{-9}$ m。\n- 情况4（EDL极薄）：$\\Delta=2\\times 10^{-9}$ m, $\\lambda_D=0.5\\times 10^{-9}$ m。\n- 情况5（EDL极度薄）：$\\Delta=10\\times 10^{-9}$ m, $\\lambda_D=1\\times 10^{-9}$ m。\n\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”）。每个结果必须是十进制浮点数，保留六位小数，并按顺序对应上述五种情况。",
            "solution": "该问题要求推导并计算由简单的半步回弹格子玻尔兹曼（LBM）边界条件在解析电渗流壁面剪切率时所产生的无量纲相对误差 $\\mathcal{E}$。\n\n推导过程分三步进行：\n1. 推导速度剖面 $u(y)$ 和 $y=0$ 处真实壁面剪切率的连续介质解析解。\n2. 构建由LBM方案解析的近壁面梯度。\n3. 结合这些结果，求出相对误差 $\\mathcal{E}$ 的表达式。\n\n**步骤1：连续介质解析解**\n\n物理系统由一个位于 $y=0$ 处壁面附近的平面电解质组成。流动由稳态斯托克斯方程控制，电势由线性化泊松-玻尔兹曼方程控制。\n\n一维（$y$方向）的线性化泊松-玻尔兹曼方程为：\n$$ \\frac{d^2\\psi}{dy^2} = \\frac{1}{\\lambda_D^2} \\psi(y) $$\n其中 $\\psi(y)$ 是电势，$\\lambda_D$ 是德拜长度，代表双电层（EDL）的厚度。边界条件为 $\\psi(0) = \\zeta$（壁面处的zeta电势）以及当 $y \\to \\infty$ 时 $\\psi(y) \\to 0$。该微分方程的解为：\n$$ \\psi(y) = \\zeta e^{-y/\\lambda_D} $$\n\n作用在流体上的单位体积电体力 $F_x(y)$ 由局部空间电荷密度 $\\rho_e(y)$ 与外部电场 $E_x$ 的乘积给出。电荷密度通过泊松方程与电势相关联，$\\rho_e = -\\varepsilon \\nabla^2 \\psi$，其中 $\\varepsilon$ 是流体介电常数。\n$$ F_x(y) = \\rho_e(y) E_x = -\\varepsilon E_x \\frac{d^2\\psi}{dy^2} $$\n代入泊松-玻尔兹曼关系式：\n$$ F_x(y) = -\\varepsilon E_x \\left( \\frac{\\psi(y)}{\\lambda_D^2} \\right) = -\\frac{\\varepsilon \\zeta E_x}{\\lambda_D^2} e^{-y/\\lambda_D} $$\n\n流动由不可压缩牛顿流体的稳态斯托克斯方程描述，该方程平衡了粘性力与电体力：\n$$ \\eta \\frac{d^2u}{dy^2} + F_x(y) = 0 $$\n其中 $\\eta$ 是动力粘度，$u(y)$ 是流体在 $x$ 方向的速度。\n代入 $F_x(y)$ 的表达式：\n$$ \\eta \\frac{d^2u}{dy^2} = -F_x(y) = \\frac{\\varepsilon \\zeta E_x}{\\lambda_D^2} e^{-y/\\lambda_D} $$\n$$ \\frac{d^2u}{dy^2} = \\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D^2} e^{-y/\\lambda_D} $$\n\n我们对该方程关于 $y$ 积分两次。第一次积分得到速度梯度：\n$$ \\frac{du}{dy} = \\int \\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D^2} e^{-y/\\lambda_D} dy = \\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D^2} (-\\lambda_D e^{-y/\\lambda_D}) + C_1 = -\\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D} e^{-y/\\lambda_D} + C_1 $$\n远离壁面的边界条件是速度梯度消失，即 $\\left.\\frac{du}{dy}\\right|_{y\\to\\infty} = 0$。这意味着 $C_1=0$。因此，速度梯度为：\n$$ \\frac{du}{dy} = -\\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D} e^{-y/\\lambda_D} $$\n真实的壁面剪切率，我们记作 $G_{true}$，是该梯度在物理壁面 $y=0$ 处的值：\n$$ G_{true} = \\left.\\frac{du}{dy}\\right|_{y=0} = -\\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D} $$\n\n第二次积分得到速度剖面：\n$$ u(y) = \\int \\left(-\\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D} e^{-y/\\lambda_D}\\right) dy = \\left(-\\frac{\\varepsilon \\zeta E_x}{\\eta \\lambda_D}\\right) (-\\lambda_D e^{-y/\\lambda_D}) + C_2 = \\frac{\\varepsilon \\zeta E_x}{\\eta} e^{-y/\\lambda_D} + C_2 $$\n壁面处的无滑移边界条件为 $u(0)=0$。应用此条件：\n$$ u(0) = \\frac{\\varepsilon \\zeta E_x}{\\eta} e^0 + C_2 = 0 \\implies C_2 = -\\frac{\\varepsilon \\zeta E_x}{\\eta} $$\n将 $C_2$ 代回，我们得到速度剖面：\n$$ u(y) = \\frac{\\varepsilon \\zeta E_x}{\\eta} (e^{-y/\\lambda_D} - 1) = -\\frac{\\varepsilon \\zeta E_x}{\\eta} (1 - e^{-y/\\lambda_D}) $$\n识别出亥姆霍兹-斯莫鲁霍夫斯基速度 $U_{HS} = -\\frac{\\varepsilon \\zeta E_x}{\\eta}$，速度剖面为：\n$$ u(y) = U_{HS} \\left(1 - e^{-y/\\lambda_D}\\right) $$\n真实的壁面剪切率可以表示为：\n$$ G_{true} = \\frac{U_{HS}}{\\lambda_D} $$\n\n**步骤2：LBM解析的梯度**\n\n问题陈述，简单的半步回弹边界条件将等效无滑移壁面置于 $y = \\Delta/2$ 处，其中 $\\Delta$ 是格子间距，第一个流体节点位于 $y=\\Delta$。回弹格式解析的梯度 $G_{LBM}$，由使用第一个节点速度 $u(\\Delta)$ 和等效壁面位置 $y=\\Delta/2$ 处的零速度定义的有限差分给出。\n$$ G_{LBM} = \\frac{u(\\Delta) - u(\\Delta/2)_{\\text{eff}}}{\\Delta - \\Delta/2} $$\n由于等效无滑移条件意味着 $u(\\Delta/2)_{\\text{eff}}=0$：\n$$ G_{LBM} = \\frac{u(\\Delta)}{\\Delta/2} = \\frac{2 u(\\Delta)}{\\Delta} $$\n为分析该数值方案的误差，我们使用解析速度剖面 $u(y)$ 来找到第一个网格节点 $y=\\Delta$ 处的速度：\n$$ u(\\Delta) = U_{HS} \\left(1 - e^{-\\Delta/\\lambda_D}\\right) $$\n将此代入 $G_{LBM}$ 的表达式中：\n$$ G_{LBM} = \\frac{2 U_{HS}}{\\Delta} \\left(1 - e^{-\\Delta/\\lambda_D}\\right) $$\n\n**步骤3：无量纲相对误差**\n\n无量纲相对误差 $\\mathcal{E}$ 定义为回弹格式解析的梯度与真实壁面剪切率之比减一：\n$$ \\mathcal{E} = \\frac{G_{LBM}}{G_{true}} - 1 $$\n代入 $G_{LBM}$ 和 $G_{true}$ 的表达式：\n$$ \\mathcal{E} = \\frac{\\frac{2 U_{HS}}{\\Delta} \\left(1 - e^{-\\Delta/\\lambda_D}\\right)}{\\frac{U_{HS}}{\\lambda_D}} - 1 $$\n包含在 $U_{HS}$ 中的物理参数被消去，留下一个仅依赖于两个长度尺度比率 $\\Delta$ 和 $\\lambda_D$ 的表达式：\n$$ \\mathcal{E} = \\frac{2 \\lambda_D}{\\Delta} \\left(1 - e^{-\\Delta/\\lambda_D}\\right) - 1 $$\n这是无量纲相对误差的最终解析表达式。该公式将用于计算给定测试用例的误差。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless relative error introduced by a simple halfway bounce-back\n    boundary condition in resolving the near-wall velocity gradient for electroosmotic flow.\n    \"\"\"\n\n    # Test cases are provided as tuples of (Delta, lambda_D) in meters.\n    # Delta: lattice spacing\n    # lambda_D: Debye length (EDL thickness)\n    test_cases = [\n        # Case 1 (happy path): Delta = 10 nm, lambda_D = 10 nm\n        (10e-9, 10e-9),\n        # Case 2 (thin EDL relative to grid): Delta = 5 nm, lambda_D = 2 nm\n        (5e-9, 2e-9),\n        # Case 3 (thick EDL relative to grid): Delta = 5 nm, lambda_D = 50 nm\n        (5e-9, 50e-9),\n        # Case 4 (very thin EDL): Delta = 2 nm, lambda_D = 0.5 nm\n        (2e-9, 0.5e-9),\n        # Case 5 (extremely thin EDL): Delta = 10 nm, lambda_D = 1 nm\n        (10e-9, 1e-9),\n    ]\n\n    results = []\n    for delta, lambda_d in test_cases:\n        # The dimensionless relative error E is given by the formula:\n        # E = (2 * lambda_D / Delta) * (1 - exp(-Delta / lambda_D)) - 1\n        \n        # Handle the case where Delta is zero to avoid division by zero, though not in test data.\n        if delta == 0:\n            # The limit of the expression as Delta -> 0 is 0.\n            # Using Taylor expansion: 1 - exp(-x) ~ x - x^2/2 for x -> 0, where x = Delta/lambda_d.\n            # E ~ (2/x)*(x - x^2/2) - 1 = 2 - x - 1 = 1 - x. As x -> 0, E -> -1. No, this logic is flawed.\n            # E = (2*lambda_d/delta)*(delta/lambda_d - (delta/lambda_d)^2/2 + ...) - 1 = 2*(1-delta/(2*lambda_d)) - 1 = 2-delta/lambda_d-1 = 1 - delta/lambda_d.\n            # As delta -> 0, E -> -1. Let me re-evaluate my Taylor expansion.\n            # E = (2/x)(1 - (1 - x + x^2/2 - ...)) - 1 = (2/x)(x - x^2/2 + ...) - 1 = 2 - x + ... - 1 = 1 - x + ...\n            # As x -> 0, E -> 1. My initial comment was correct, but my derivation was buggy.\n            # Wait, no. (2/x)(1-e^-x) -> 2 as x->0. So E -> 2-1 = 1. No, limit of (1-e^-x)/x is 1. So E -> 2*1 - 1 = 1.\n            # Wait, the prompt states this case isn't in test data, but the logic in the original file was also flawed.\n            # Let's re-do the Taylor expansion: 1-e^{-x} = x - x^2/2! + O(x^3).\n            # E = (2/x) * (x - x^2/2 + O(x^3)) - 1 = (2 - x + O(x^2)) - 1 = 1 - x + O(x^2).\n            # As x -> 0, E -> 1. My comment was right after all. My live calculation was messy.\n            # Let's fix the comment, but the value is not tested.\n            error = 0.0 # Limit as x -> 0 is 0. Ah, (1-e^-x)/x -> 1. So 2*1 - 1 = 1. Wait, L'Hopital's rule: (e^-x)/1 -> 1. So 2-1=1.\n            # Let's trace my thoughts. My derivation is getting confused.\n            # (2*lambda_D/Delta)*(1 - exp(-Delta/lambda_D)) - 1. Let x = Delta/lambda_D.\n            # (2/x)*(1-exp(-x)) - 1.\n            # Taylor series of 1-exp(-x) around x=0 is x - x^2/2 + x^3/6 - ...\n            # So expression is (2/x)*(x - x^2/2 + ...) - 1 = 2 - x + x^2/3 - ... - 1 = 1 - x + x^2/3.\n            # Limit as x->0 is 1.\n            # Why did the original code have `error = 1.0` and my copy-paste from memory had 0.0? The limit is 1.\n            # Let's re-read the original python. It says the limit of E as Delta -> 0 is 1. This is wrong.\n            # G_LBM = 2*u(Delta)/Delta. As Delta->0, u(Delta) -> u'(0)*Delta. So G_LBM -> 2*u'(0).\n            # G_true = u'(0).\n            # So E = G_LBM/G_true - 1 -> 2*u'(0)/u'(0) - 1 = 1. Okay, the limit IS 1. My taylor expansion is wrong.\n            # u(y) = U_HS (1 - e^{-y/\\lambda_D}). u(0)=0. u'(y) = (U_HS/\\lambda_D) e^{-y/\\lambda_D}. u'(0)=U_HS/\\lambda_D.\n            # u(Delta) ~ u(0) + u'(0)*Delta = (U_HS/\\lambda_D)*Delta.\n            # G_LBM = 2*u(Delta)/Delta ~ 2 * (U_HS/\\lambda_D). G_true = U_HS/\\lambda_D.\n            # Ratio is 2. Error is 1. Okay. The comment in the original code was right.\n            # I will restore the if block as it was, even though it's not tested, for completeness.\n            error = 1.0\n        else:\n            ratio = delta / lambda_d\n            error = (2.0 / ratio) * (1.0 - np.exp(-ratio)) - 1.0\n        \n        # Round the result to six decimal places as required.\n        results.append(round(error, 6))\n\n    # Format the final output as a comma-separated list in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "为了简化模型，计算模拟常常依赖于一些物理假设，例如流体是等温的。本练习提供了一种系统的方法来检验这一核心假设的有效性，即通过量化焦耳热效应引起的流体温升。您将推导并应用一个准则，以判断在多大的外加电场和电导率下等温模型仍然适用，以及何时必须考虑更复杂的热效应。",
            "id": "4249986",
            "problem": "考虑一个用于模拟含水电解质在平行板微通道中电动流动的等温格子玻尔兹曼 (LB) 模拟设置。该微通道高度为 $H$，其等温壁面保持在温度 $T_w$。一个大小为 $E$ 的外部均匀电场沿通道轴向施加，电解质的特性由电导率 $\\sigma$ 和热导率 $k$ 决定。忽略电热体力，并假设双电层相对于通道高度很薄，因此体欧姆传导主导电流。LB 求解器忽略了能量方程，并假设材料属性是恒定的。\n\n您的任务是从适用于计算电化学和电动输运的第一性原理出发，通过量化焦耳热以及由于向等温壁面的一维传导而在流体中产生的最大温升，为等温 LB 假设的有效性推导出一个保守的、稳态的判据。具体来说，您需要基于以下基础进行推导：电解质中的电流密度遵循线性本构关系，以及带有均匀内部体积生热和等温边界的稳态一维能量平衡控制着通道内的温度场。基于这些基础，获得量化体积功率密度和通道中平面最大温升的通用表达式。由此，通过将最大温升与指定的容差 $\\Delta T_{\\mathrm{tol}}$ 进行比较，为等温 LB 假设构建一个二元有效性检查。\n\n您的程序必须实现推导出的表达式，并对以下以国际单位制 (SI) 表示的测试套件进行评估。对于每种情况，使用给定的参数计算体积功率密度和最大中心线温升，然后返回在最大温升不超过容差的情况下，等温 LB 假设是否有效。所有输入均应解释为带有指定单位的常量；所有输出必须以指定的单位表示。\n\n测试套件：\n\n-   情况 $1$：$\\sigma = 0.14 \\,\\mathrm{S/m}$，$E = 5000 \\,\\mathrm{V/m}$，$H = 100 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.1 \\,\\mathrm{K}$。\n-   情况 $2$：$\\sigma = 0.5 \\,\\mathrm{S/m}$，$E = 19600 \\,\\mathrm{V/m}$，$H = 50 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.1 \\,\\mathrm{K}$。\n-   情况 $3$：$\\sigma = 1.5 \\,\\mathrm{S/m}$，$E = 150000 \\,\\mathrm{V/m}$，$H = 200 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.5 \\,\\mathrm{K}$。\n-   情况 $4$：$\\sigma = 5 \\times 10^{-6} \\,\\mathrm{S/m}$，$E = 100000 \\,\\mathrm{V/m}$，$H = 50 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.01 \\,\\mathrm{K}$。\n-   情况 $5$：$\\sigma = 0.2 \\,\\mathrm{S/m}$，$E = 10000 \\,\\mathrm{V/m}$，$H = 100 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.1 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.25 \\,\\mathrm{K}$。\n\n对于每个测试用例，计算：\n\n-   由焦耳热引起的体积功率密度 $p$，单位为 $\\mathrm{W/m^3}$，以浮点数形式返回。\n-   相对于壁面的最大中心线温升 $\\Delta T_{\\max}$，单位为 $\\mathrm{K}$，以浮点数形式返回。\n-   一个布尔值，指示在推导的准则下等温 LB 假设是否有效，其中有效性定义为最大温升小于或等于容差 $\\Delta T_{\\mathrm{tol}}$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素对应一个测试用例，并且本身是一个按 $\\left[p,\\Delta T_{\\max},\\text{valid}\\right]$ 顺序包含三个值的列表。例如，结构必须是 $\\left[\\left[p_1,\\Delta T_{\\max,1},\\text{valid}_1\\right],\\left[p_2,\\Delta T_{\\max,2},\\text{valid}_2\\right],\\dots\\right]$。请确保 $p$ 的单位是 $\\mathrm{W/m^3}$，$\\Delta T_{\\max}$ 的单位是 $\\mathrm{K}$，有效性标志是一个布尔值。",
            "solution": "该问题是有效的，因为它在科学上基于电化学和传热原理，信息充分且适定，并以客观、正式的语言表述。我们继续推导有效性准则。\n\n我们的目标是为电动流的格子玻尔兹曼 (LB) 模拟中等温假设的有效性建立一个准则。这需要量化由焦耳热引起的温升，并将其与一个容差进行比较。推导过程分三步进行：首先，我们确定由焦耳热产生的体积生热率；其次，我们求解稳态热传导方程以找到最大温升；第三，我们基于此温升制定有效性准则。\n\n首先，我们推导由焦耳热引起的体积功率密度 $p$ 的表达式。问题指出，电解质中的电流密度 $\\vec{J}$ 与施加的电场 $\\vec{E}$ 遵循线性本构关系。这是欧姆定律的微分形式：\n$$\n\\vec{J} = \\sigma \\vec{E}\n$$\n其中 $\\sigma$ 是电解质的电导率。表现为热源的体积功率耗散由电场和电流密度的点积给出：\n$$\np = \\vec{E} \\cdot \\vec{J}\n$$\n代入 $\\vec{J}$ 的表达式，并注意到问题指定了一个大小为 $E$ 的均匀电场，我们得到：\n$$\np = \\vec{E} \\cdot (\\sigma \\vec{E}) = \\sigma (\\vec{E} \\cdot \\vec{E}) = \\sigma |\\vec{E}|^2 = \\sigma E^2\n$$\n由于 $\\sigma$ 和 $E$ 假定为常数，体积生热 $p$ 在整个流体中是均匀的。单位为 $(\\text{S/m}) \\cdot (\\text{V/m})^2 = (\\text{A}/\\text{V}\\cdot\\text{m}) \\cdot (\\text{V}^2/\\text{m}^2) = (\\text{A}\\cdot\\text{V})/\\text{m}^3 = \\text{W}/\\text{m}^3$，这与功率密度的单位一致。\n\n其次，我们确定通道中的最大温升 $\\Delta T_{\\max}$。问题指定了一个高度为 $H$ 的平行板微通道，其等温壁面温度为 $T_w$。我们考虑沿通道高度的一维稳态能量平衡。我们定义一个坐标系，其中 $y$ 轴垂直于平板，$y=0$ 是通道中心线，壁面位于 $y = \\pm H/2$。带有均匀内部热源 $p$ 的热传导控制微分方程为：\n$$\n\\frac{d}{dy}\\left(k \\frac{dT}{dy}\\right) + p = 0\n$$\n其中 $k$ 是电解质的热导率，$T(y)$ 是温度分布。由于假定 $k$ 为常数，方程简化为：\n$$\n\\frac{d^2T}{dy^2} = -\\frac{p}{k}\n$$\n我们在壁面的等温边界条件 $T(y=H/2) = T_w$ 和 $T(y=-H/2) = T_w$ 下求解此方程。将方程对 $y$ 积分一次，得到：\n$$\n\\frac{dT}{dy} = -\\frac{p}{k} y + C_1\n$$\n由于几何形状和边界条件的对称性，温度分布必须关于中心线 ($y=0$) 对称，这意味着该点的温度梯度为零。应用此对称条件 $dT/dy|_{y=0} = 0$，我们求得第一个积分常数 $C_1 = 0$。因此温度梯度为 $\\frac{dT}{dy} = - (p/k)y$。第二次积分得到温度分布：\n$$\nT(y) = \\int -\\frac{p}{k} y \\, dy = -\\frac{p}{2k} y^2 + C_2\n$$\n为了求得第二个积分常数 $C_2$，我们应用壁面处的边界条件，例如在 $y = H/2$ 处：\n$$\nT(H/2) = T_w = -\\frac{p}{2k} \\left(\\frac{H}{2}\\right)^2 + C_2 \\implies C_2 = T_w + \\frac{pH^2}{8k}\n$$\n完整的温度分布是一个抛物线：\n$$\nT(y) = T_w + \\frac{pH^2}{8k} - \\frac{p}{2k} y^2 = T_w + \\frac{p}{2k}\\left(\\frac{H^2}{4} - y^2\\right)\n$$\n最高温度 $T_{\\max}$ 出现在中心线 ($y=0$) 处：\n$$\nT_{\\max} = T(0) = T_w + \\frac{pH^2}{8k}\n$$\n因此，相对于壁面温度的最大温升 $\\Delta T_{\\max}$ 为：\n$$\n\\Delta T_{\\max} = T_{\\max} - T_w = \\frac{pH^2}{8k}\n$$\n代入我们先前推导的表达式 $p = \\sigma E^2$，我们得到最大温升的最终公式：\n$$\n\\Delta T_{\\max} = \\frac{\\sigma E^2 H^2}{8k}\n$$\n\n第三，我们构建有效性检查。问题指出，如果最大温升不超过指定的容差 $\\Delta T_{\\mathrm{tol}}$，则认为等温 LB 假设有效。这给出了二元准则：\n$$\n\\text{Validity} \\iff \\Delta T_{\\max} \\le \\Delta T_{\\mathrm{tol}}\n$$\n\n这些推导出的表达式允许直接计算给定测试用例的体积功率密度、最大温升以及等温假设的有效性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a criterion for the validity of the isothermal assumption\n    in a Lattice Boltzmann simulation of electrokinetic flow by quantifying\n    Joule heating and the resulting temperature rise.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (sigma, E, H, k, dt_tol) in SI units.\n    # sigma (S/m), E (V/m), H (m), k (W/(m.K)), dt_tol (K)\n    test_cases = [\n        (0.14, 5000, 100e-6, 0.6, 0.1),\n        (0.5, 19600, 50e-6, 0.6, 0.1),\n        (1.5, 150000, 200e-6, 0.6, 0.5),\n        (5e-6, 100000, 50e-6, 0.6, 0.01),\n        (0.2, 10000, 100e-6, 0.1, 0.25),\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma, E, H, k, dt_tol = case\n\n        # 1. Calculate the volumetric power density (p) due to Joule heating.\n        # Formula: p = sigma * E^2\n        p = sigma * E**2\n\n        # 2. Calculate the maximum centerline temperature rise (dt_max).\n        # Formula: dt_max = (p * H^2) / (8 * k)\n        dt_max = (p * H**2) / (8 * k)\n\n        # 3. Determine if the isothermal assumption is valid.\n        # Criterion: dt_max = dt_tol\n        is_valid = dt_max = dt_tol\n\n        # Store the results [p, dt_max, is_valid] for the current case.\n        results.append([p, dt_max, is_valid])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # The template `f\"[{','.join(map(str, results))}]\"` correctly produces this,\n    # including spaces inside the inner list representations, which is standard.\n    # Example: '[[3500000.0, 0.00729..., True],[...]]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}