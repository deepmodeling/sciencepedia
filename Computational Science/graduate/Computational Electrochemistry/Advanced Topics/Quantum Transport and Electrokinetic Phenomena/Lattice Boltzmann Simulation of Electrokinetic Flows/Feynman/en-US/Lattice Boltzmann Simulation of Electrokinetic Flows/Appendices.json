{
    "hands_on_practices": [
        {
            "introduction": "Mastering the Lattice Boltzmann Method requires understanding how its microscopic rules give rise to macroscopic fluid behavior. This foundational exercise connects the discrete simulation world to continuum physics by deriving the relationship between the fluid's kinematic viscosity, $\\nu$, and the LBM's relaxation time, $\\tau$. By applying the Chapman-Enskog multiscale expansion, you will see how the Navier-Stokes equations emerge from the LBE, a critical insight for any serious practitioner. ",
            "id": "4249960",
            "problem": "Consider the fluid solver used in a coupled electrokinetic simulation of an isothermal electrolyte, where the hydrodynamics is evolved by the Lattice Boltzmann Method (LBM) with a single-relaxation-time Bhatnagar–Gross–Krook (BGK) collision operator. The discrete velocity set is assumed to satisfy standard second- and fourth-order isotropy. The solvent density and momentum are defined by $f_{i}$-moments, $ \\rho = \\sum_{i} f_{i}$ and $ \\rho u_{\\alpha} = \\sum_{i} c_{i\\alpha} f_{i}$, where $c_{i\\alpha}$ are the Cartesian components of the discrete velocities. The update rule for the particle populations is\n$$\nf_{i}(\\mathbf{x}+\\mathbf{c}_{i}\\,\\Delta t, t+\\Delta t) - f_{i}(\\mathbf{x}, t)\n= -\\frac{1}{\\tau}\\Big(f_{i}(\\mathbf{x}, t) - f_{i}^{\\mathrm{eq}}(\\rho, \\mathbf{u})\\Big) + \\Delta t\\,\\Phi_{i},\n$$\nwhere $\\tau$ is a dimensionless relaxation time measured in time steps, $\\Delta t$ is the physical time step, and $\\Phi_{i}$ is a forcing term representing smooth body forces such as the electrostatic force density. The isothermal equilibrium distribution, valid for low Mach number, is the second-order Hermite expansion\n$$\nf_{i}^{\\mathrm{eq}}(\\rho,\\mathbf{u}) = w_{i}\\,\\rho\\left[1 + \\frac{c_{i\\alpha} u_{\\alpha}}{c_{s}^{2}} + \\frac{(c_{i\\alpha} u_{\\alpha})(c_{i\\beta} u_{\\beta})}{2 c_{s}^{4}} - \\frac{u_{\\alpha} u_{\\alpha}}{2 c_{s}^{2}} \\right],\n$$\nwith lattice weights $w_{i}$ obeying the isotropy constraints\n$$\n\\sum_{i} w_{i} = 1,\\quad \\sum_{i} w_{i}\\,c_{i\\alpha} = 0,\\quad \\sum_{i} w_{i}\\,c_{i\\alpha} c_{i\\beta} = c_{s}^{2}\\,\\delta_{\\alpha\\beta},\n$$\n$$\n\\sum_{i} w_{i}\\,c_{i\\alpha} c_{i\\beta} c_{i\\gamma} = 0,\\quad\n\\sum_{i} w_{i}\\,c_{i\\alpha} c_{i\\beta} c_{i\\gamma} c_{i\\delta} = c_{s}^{4}\\left(\\delta_{\\alpha\\beta}\\delta_{\\gamma\\delta} + \\delta_{\\alpha\\gamma}\\delta_{\\beta\\delta} + \\delta_{\\alpha\\delta}\\delta_{\\beta\\gamma}\\right),\n$$\nwhere $c_{s}$ is the lattice speed of sound and $\\delta_{\\alpha\\beta}$ is the Kronecker delta. Assume smooth fields, low Mach number, and small Knudsen number. To isolate the constitutive relation, set $\\Phi_{i} = 0$; this does not alter the shear viscosity coefficient at leading order.\n\nUsing only the above definitions and a Chapman–Enskog multiscale expansion consistent with second-order accuracy in the time step and gradients, derive the continuum momentum equation and identify the Newtonian viscous stress. From this, determine an explicit symbolic expression for the kinematic viscosity in terms of $c_{s}$, $\\tau$, and $\\Delta t$. Provide your final answer as a single algebraic expression in these symbols. No numerical evaluation is required, and no units need to be reported with the final expression.",
            "solution": "We start from the discrete-time BGK Lattice Boltzmann equation (with the force term set to zero for the viscosity derivation):\n$$\nf_{i}(\\mathbf{x}+\\mathbf{c}_{i}\\,\\Delta t, t+\\Delta t) - f_{i}(\\mathbf{x}, t)\n= -\\frac{1}{\\tau}\\Big(f_{i}(\\mathbf{x}, t) - f_{i}^{\\mathrm{eq}}(\\rho, \\mathbf{u})\\Big).\n$$\nWe perform a Taylor expansion of the left-hand side about $(\\mathbf{x}, t)$ up to second order in $\\Delta t$:\n$$\n\\Delta t\\left(\\partial_{t} + c_{i\\alpha}\\partial_{\\alpha}\\right) f_{i}\n+ \\frac{\\Delta t^{2}}{2}\\left(\\partial_{t} + c_{i\\alpha}\\partial_{\\alpha}\\right)^{2} f_{i}\n+ \\mathcal{O}(\\Delta t^{3})\n= -\\frac{1}{\\tau}\\left(f_{i} - f_{i}^{\\mathrm{eq}}\\right).\n$$\nWe carry out a Chapman–Enskog expansion, introducing a formal small parameter $\\epsilon$ to order space-time derivatives and non-equilibrium contributions:\n$$\n\\partial_{t} = \\epsilon\\,\\partial_{t_{1}} + \\epsilon^{2}\\,\\partial_{t_{2}},\\qquad\n\\partial_{\\alpha} = \\epsilon\\,\\partial_{\\alpha},\\qquad\nf_{i} = f_{i}^{(0)} + \\epsilon\\,f_{i}^{(1)} + \\epsilon^{2}\\,f_{i}^{(2)} + \\cdots.\n$$\nMatching terms at each order of $\\epsilon$ gives a hierarchy of equations. At zeroth order, we find that the distribution is at local equilibrium: $f_{i}^{(0)} = f_{i}^{\\mathrm{eq}}$.\n\nTaking moments of the expanded LBE at different orders allows us to recover the macroscopic equations. At order $\\epsilon$, we recover the Euler equations (inviscid fluid dynamics):\n$$\n\\partial_{t_{1}} \\rho + \\partial_{\\alpha}(\\rho u_{\\alpha}) = 0\n$$\n$$\n\\partial_{t_{1}}(\\rho u_{\\beta}) + \\partial_{\\alpha}(\\rho u_{\\alpha} u_{\\beta} + \\rho c_s^2 \\delta_{\\alpha\\beta}) = 0\n$$\nAt order $\\epsilon^2$, the viscous terms appear. The key insight of the Chapman-Enskog analysis for LBE is that the viscosity arises from the non-equilibrium part of the pressure tensor, which must account for both the first-order non-equilibrium distribution $f_i^{(1)}$ and the second-order temporal discretization error from the Taylor expansion.\n\nThe total pressure tensor is $\\Pi_{\\alpha\\beta} = \\sum_i c_{i\\alpha} c_{i\\beta} f_i$. Its non-equilibrium part, $\\Pi_{\\alpha\\beta}^{\\mathrm{neq}} = \\Pi_{\\alpha\\beta} - \\Pi_{\\alpha\\beta}^{\\mathrm{eq}}$, acts as the viscous stress tensor in the recovered Navier-Stokes equations. A full analysis of the discrete lattice equation shows that this tensor is given by:\n$$\n\\Pi_{\\alpha\\beta}^{\\mathrm{neq}} = -\\rho c_s^2 (\\tau - 1/2)\\Delta t \\left( \\partial_\\alpha u_\\beta + \\partial_\\beta u_\\alpha - \\frac{2}{d}\\delta_{\\alpha\\beta}\\partial_\\gamma u_\\gamma \\right) + \\mathcal{O}(\\Delta t^2)\n$$\nwhere $d$ is the spatial dimension. This result comes from relating the dimensionless relaxation time $\\tau$ used in the discrete update rule to a physical relaxation time $\\tau_{\\mathrm{phys}} = \\tau \\Delta t$ and including the necessary correction of $-\\Delta t/2$ that arises from the discrete time-stepping.\n\nCombining the moments of the expanded LBE across the different time scales yields the macroscopic momentum equation:\n$$\n\\partial_{t}(\\rho u_{\\beta}) + \\partial_{\\alpha}(\\rho u_{\\alpha} u_{\\beta}) = -\\partial_{\\beta} p + \\partial_{\\alpha} \\Pi_{\\alpha\\beta}^{\\mathrm{neq}}\n$$\nwhere $p = \\rho c_{s}^{2}$ is the fluid pressure. This is the compressible Navier-Stokes equation. By comparing the expression for $\\Pi_{\\alpha\\beta}^{\\mathrm{neq}}$ with the standard Newtonian constitutive relation for the viscous stress tensor, $\\sigma_{\\alpha\\beta} = \\mu \\left( \\partial_\\alpha u_\\beta + \\partial_\\beta u_\\alpha - \\frac{2}{d}\\delta_{\\alpha\\beta}\\partial_\\gamma u_\\gamma \\right)$, we can identify the dynamic viscosity $\\mu$:\n$$\n\\mu = \\rho c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\\Delta t\n$$\nDividing by the density $\\rho$ gives the kinematic viscosity $\\nu$:\n$$\n\\nu = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\\Delta t\n$$\nThis is the desired relationship between the kinematic viscosity, the lattice speed of sound, the dimensionless relaxation time, and the time step.",
            "answer": "$$\\boxed{c_{s}^{2}\\left(\\tau - \\frac{1}{2}\\right)\\Delta t}$$"
        },
        {
            "introduction": "Moving from theory to a functional simulation involves a crucial parameterization step where physical properties are mapped onto dimensionless lattice units. This practice walks you through the essential task of setting up a coupled LBM simulation for an electrokinetic system, balancing physical accuracy with numerical constraints. You will learn how to choose relaxation times $\\tau$ and $\\tau_s$ to correctly reproduce the kinematic viscosity $\\nu$ and ionic diffusivity $D$ of an electrolyte, while ensuring the simulation remains stable and computationally efficient. ",
            "id": "4250003",
            "problem": "A two-dimensional electroosmotic microchannel flow is to be simulated using the Lattice Boltzmann Method (LBM) with a Single Relaxation Time (SRT) Bhatnagar-Gross-Krook (BGK) collision operator for the fluid on a D2Q9 lattice, coupled to an advection-diffusion LBM for a single ionic species on a D2Q5 lattice. The microchannel height is specified as $H = 128 \\,\\mu\\text{m}$, resolved uniformly with $N_y = 128$ lattice nodes in the wall-normal direction, so that the lattice spacing is $\\Delta x = H/N_y$. The characteristic fluid speed is $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$, the kinematic viscosity is $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$ (water at room temperature), and the ionic diffusivity is $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$ (a typical small monovalent ion).\n\nStarting from the Boltzmann equation with Bhatnagar-Gross-Krook (BGK) relaxation and its second-order Chapman–Enskog hydrodynamic limit, derive the relations that connect the hydrodynamic kinematic viscosity and the scalar diffusivity to the corresponding LBM relaxation times on the D2Q9 and D2Q5 lattices, respectively. Use these relations to determine the relaxation times $\\tau$ (fluid) and $\\tau_s$ (species) in lattice units that simultaneously reproduce the target $\\nu_{\\text{phys}}$ and $D_{\\text{phys}}$ under the following constraints:\n- Low-Mach constraint: the lattice Mach number satisfies $\\text{Ma} \\leq 0.05$ at the characteristic speed $U^{\\ast}$.\n- Positivity and stability: $\\tau  \\tfrac{1}{2}$ and $\\tau_s  \\tfrac{1}{2}$.\n- Efficiency and accuracy constraint: choose the largest permissible time step $\\Delta t$ such that $\\tau \\leq 1.0$.\n\nAssume standard moment isotropy for D2Q9 and D2Q5 such that the lattice speed of sound satisfies $c_s^2 = \\tfrac{1}{3}$ in lattice units. Express the final answer as the pair $(\\tau, \\tau_s)$ in lattice units (dimensionless). Round each relaxation time to six significant figures.",
            "solution": "The connection between macroscopic transport coefficients and LBM relaxation times is established through the Chapman-Enskog expansion. In dimensionless lattice units (where $\\Delta x=1, \\Delta t=1$), the kinematic viscosity $\\nu_{\\text{lb}}$ and species diffusivity $D_{\\text{lb}}$ are given by:\n$$\n\\nu_{\\text{lb}} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\n$$\n$$\nD_{\\text{lb}} = c_s^2 \\left(\\tau_s - \\frac{1}{2}\\right)\n$$\nwhere $\\tau$ and $\\tau_s$ are the dimensionless relaxation times for the fluid and species, respectively, and $c_s^2 = 1/3$ is the square of the lattice speed of sound.\n\nTo find the numerical values of $\\tau$ and $\\tau_s$, we relate physical properties to their lattice counterparts using conversion factors for length ($\\Delta x$) and time ($\\Delta t$). The conversion relations for viscosity and diffusivity are:\n$$\n\\nu_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} \\nu_{\\text{lb}} \\quad \\text{and} \\quad D_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} D_{\\text{lb}}\n$$\nFirst, we determine the physical lattice spacing:\n$$\n\\Delta x = \\frac{H}{N_y} = \\frac{128 \\times 10^{-6} \\,\\text{m}}{128} = 1.0 \\times 10^{-6} \\,\\text{m}\n$$\nNext, we determine the physical time step $\\Delta t$. The problem constraints guide this choice. The efficiency constraint suggests maximizing $\\Delta t$ by setting the fluid relaxation time to its upper bound, $\\tau = 1.0$. This choice also satisfies the stability constraint $\\tau  1/2$.\n\nWith $\\tau = 1.0$, the lattice viscosity is $\\nu_{\\text{lb}} = c_s^2(1.0 - 0.5) = \\frac{1}{3} \\cdot \\frac{1}{2} = \\frac{1}{6}$. We can now solve for $\\Delta t$ using the viscosity relation:\n$$\n\\Delta t = \\frac{(\\Delta x)^2}{\\nu_{\\text{phys}}} \\nu_{\\text{lb}} = \\frac{(1.0 \\times 10^{-6} \\,\\text{m})^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} \\left(\\frac{1}{6}\\right) = \\frac{1.0 \\times 10^{-12} \\,\\text{m}^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} \\left(\\frac{1}{6}\\right) = \\frac{1}{6} \\times 10^{-6} \\,\\text{s}\n$$\nWe must verify that this choice of $\\Delta t$ satisfies the low-Mach number constraint. The characteristic velocity in lattice units, $U_{\\text{lb}}$, is:\n$$\nU_{\\text{lb}} = \\frac{\\Delta t}{\\Delta x} U^{\\ast} = \\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{1.0 \\times 10^{-6} \\,\\text{m}} (1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}) = \\frac{1}{6} \\times 10^{-3}\n$$\nThe Mach number is then:\n$$\n\\text{Ma} = \\frac{U_{\\text{lb}}}{c_s} = \\frac{\\frac{1}{6} \\times 10^{-3}}{1/\\sqrt{3}} = \\frac{\\sqrt{3}}{6} \\times 10^{-3} \\approx 0.0002887\n$$\nSince $0.0002887 \\leq 0.05$, the Mach number constraint is satisfied.\n\nFinally, we calculate the species relaxation time $\\tau_s$. First, we find the lattice diffusivity $D_{\\text{lb}}$:\n$$\nD_{\\text{lb}} = \\frac{\\Delta t}{(\\Delta x)^2} D_{\\text{phys}} = \\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{(1.0 \\times 10^{-6} \\,\\text{m})^2} (1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}) = \\frac{1}{6} \\times 10^{-3}\n$$\nNow we solve for $\\tau_s$:\n$$\n\\tau_s = \\frac{D_{\\text{lb}}}{c_s^2} + \\frac{1}{2} = \\frac{\\frac{1}{6} \\times 10^{-3}}{1/3} + \\frac{1}{2} = \\frac{3}{6} \\times 10^{-3} + \\frac{1}{2} = 0.0005 + 0.5 = 0.5005\n$$\nThis value satisfies the stability constraint $\\tau_s  1/2$.\nThe resulting pair of relaxation times, rounded to six significant figures, is $(\\tau, \\tau_s) = (1.00000, 0.500500)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.00000  0.500500\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A numerical model for complex multiphysics phenomena is only as good as its validation against known results. This final practice addresses this critical step, showing how to benchmark a coupled LB-PNP solver using canonical analytical solutions from electrokinetics. You will compare the simulated electrophoretic mobility of a particle against the classic Hückel and Smoluchowski limits, which depend on the dimensionless parameter $\\kappa a$, ensuring your solver is physically correct in well-understood regimes. ",
            "id": "4250048",
            "problem": "Consider the validation of a Lattice Boltzmann–Poisson–Nernst–Planck (LB–PNP) solver for electrokinetic flows by comparing its predicted electrophoretic mobility of a spherical particle in a liquid to well-established asymptotic limits. The LB–PNP solver advances a discrete-velocity kinetic model for hydrodynamics while coupling to electrostatics and ionic transport through the Poisson equation and the Nernst–Planck equations. The electrophoretic mobility is defined as $ \\mu = U/E $, where $ U $ is the steady particle velocity and $ E $ is the applied electric field magnitude.\n\nFundamental base:\n- The electrostatic potential $ \\phi $ obeys the Poisson equation $ -\\nabla \\cdot \\left( \\varepsilon \\nabla \\phi \\right) = \\rho_e $, where $ \\varepsilon $ is the permittivity and $ \\rho_e $ is the free charge density.\n- Ionic species of valence $ z $ and bulk concentration $ c_0 $ are transported by diffusion and migration according to the Nernst–Planck equation $ \\partial_t c + \\nabla \\cdot \\left( -D \\nabla c - \\mu_i z e c \\nabla \\phi + c \\mathbf{u} \\right) = 0 $, where $ D $ is the diffusion coefficient, $ \\mu_i $ is the ionic mobility, $ e $ is the elementary charge, and $ \\mathbf{u} $ is the fluid velocity.\n- In the creeping-flow regime, incompressible hydrodynamics are governed by the Stokes equations $ -\\nabla p + \\eta \\nabla^2 \\mathbf{u} + \\rho_e \\nabla \\phi = \\mathbf{0} $, $ \\nabla \\cdot \\mathbf{u} = 0 $, where $ p $ is pressure and $ \\eta $ is viscosity. The electrohydrodynamic body force is $ \\rho_e \\nabla \\phi $.\n\nUnder dilute-solution conditions with symmetric monovalent electrolyte and small $ |\\zeta| $ (zeta potential), linearization leads to the Debye–Hückel screening with inverse Debye length $ \\kappa $ defined by\n$$\n\\kappa^2 = \\frac{2 z^2 e^2 N_A I}{\\varepsilon k_B T},\n$$\nwhere $ z $ is the ionic valence, $ e $ is the elementary charge, $ N_A $ is Avogadro's number, $ I $ is the ionic strength in $ \\mathrm{mol/m^3} $, $ k_B $ is the Boltzmann constant, and $ T $ is temperature. The asymptotic limits for electrophoretic mobility of a sphere of radius $ a $ are:\n- Hückel limit ($ \\kappa a \\ll 1 $): $$ \\mu_{\\mathrm{H}} = \\frac{2 \\varepsilon \\zeta}{3 \\eta}. $$\n- Smoluchowski limit ($ \\kappa a \\gg 1 $): $$ \\mu_{\\mathrm{S}} = \\frac{\\varepsilon \\zeta}{\\eta}. $$\n\nFor validation across regimes, a practical interpolation consistent with both limits is to define a Henry-type function $ H(\\kappa a) $ satisfying $ H(0)=1 $ and $ H(\\infty)=\\frac{3}{2} $, and set\n$$\n\\mu_{\\mathrm{interp}}(\\kappa a) = \\frac{2 \\varepsilon \\zeta}{3 \\eta} \\, H(\\kappa a).\n$$\nA simple rational choice that preserves the correct limits is\n$$\nH(\\kappa a) = 1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}.\n$$\n\nYour task is to design and compute a validation metric for three test cases. For each case, compute the ionic strength $ I $ required to achieve the specified $ \\kappa a $ using the Debye relation above (with $ z=1 $), then compute:\n1. The Hückel-limit mobility $ \\mu_{\\mathrm{H}} $ and the Smoluchowski-limit mobility $ \\mu_{\\mathrm{S}} $,\n2. The interpolated mobility $ \\mu_{\\mathrm{interp}} $ using the $ H(\\kappa a) $ given,\n3. The relative errors in the near-limit cases:\n   - For the small-$ \\kappa a $ case, $ \\mathrm{err}_{\\mathrm{H}} = \\left| \\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{H}} \\right| / \\left| \\mu_{\\mathrm{H}} \\right| $,\n   - For the large-$ \\kappa a $ case, $ \\mathrm{err}_{\\mathrm{S}} = \\left| \\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{S}} \\right| / \\left| \\mu_{\\mathrm{S}} \\right| $.\n\nReport the following outputs:\n- For the small-$ \\kappa a $ case: the decimal $ \\mathrm{err}_{\\mathrm{H}} $ (dimensionless).\n- For the intermediate case: the signed $ \\mu_{\\mathrm{interp}} $ in $ \\mathrm{m^2/(V\\cdot s)} $.\n- For the large-$ \\kappa a $ case: the decimal $ \\mathrm{err}_{\\mathrm{S}} $ (dimensionless).\n\nAll computations must use the International System of Units (SI). Express mobility values in $ \\mathrm{m^2/(V\\cdot s)} $ and errors as decimals. Use $ \\varepsilon = \\varepsilon_r \\varepsilon_0 $ with $ \\varepsilon_0 $ as the vacuum permittivity and $ \\varepsilon_r $ the relative permittivity.\n\nTest suite parameter values:\n- Case A (near Hückel): $ a = 1.0 \\times 10^{-7} \\,\\mathrm{m} $, $ \\zeta = -25.0 \\times 10^{-3} \\,\\mathrm{V} $, $ \\varepsilon_r = 78.5 $, $ \\eta = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s} $, $ T = 298 \\,\\mathrm{K} $, $ z = 1 $, target $ \\kappa a = 10^{-2} $.\n- Case B (intermediate): $ a = 1.0 \\times 10^{-7} \\,\\mathrm{m} $, $ \\zeta = -25.0 \\times 10^{-3} \\,\\mathrm{V} $, $ \\varepsilon_r = 78.5 $, $ \\eta = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s} $, $ T = 298 \\,\\mathrm{K} $, $ z = 1 $, target $ \\kappa a = 1 $.\n- Case C (near Smoluchowski): $ a = 1.0 \\times 10^{-7} \\,\\mathrm{m} $, $ \\zeta = -25.0 \\times 10^{-3} \\,\\mathrm{V} $, $ \\varepsilon_r = 78.5 $, $ \\eta = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s} $, $ T = 298 \\,\\mathrm{K} $, $ z = 1 $, target $ \\kappa a = 100 $.\n\nYour program should compute $ I $ for each case from the specified target $ \\kappa a $ and given $ a $, then compute $ \\mu_{\\mathrm{H}} $, $ \\mu_{\\mathrm{S}} $, $ \\mu_{\\mathrm{interp}} $, and the errors as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order $ [\\mathrm{err}_{\\mathrm{H}}, \\mu_{\\mathrm{interp}}^{\\mathrm{(Case\\ B)}}, \\mathrm{err}_{\\mathrm{S}}] $. The units are $ \\mathrm{m^2/(V\\cdot s)} $ for the mobility value and decimals (unitless) for the errors.",
            "solution": "The solution proceeds by first defining the physical constants and calculating the parameters common to all test cases. Then, each case is analyzed individually to compute the required output. All calculations are performed in SI units.\n\nThe fundamental physical constants used are:\n- Vacuum permittivity, $\\varepsilon_0 \\approx 8.854 \\times 10^{-12} \\, \\mathrm{F/m}$\n\nThe parameters common to all three test cases are:\n- Zeta potential, $\\zeta = -25.0 \\times 10^{-3} \\, \\mathrm{V}$\n- Relative permittivity of the medium, $\\varepsilon_r = 78.5$\n- Dynamic viscosity of the medium, $\\eta = 1.0 \\times 10^{-3} \\, \\mathrm{Pa \\cdot s}$\n\nFirst, the permittivity of the medium $\\varepsilon$ is calculated:\n$$\n\\varepsilon = \\varepsilon_r \\varepsilon_0 = 78.5 \\times 8.854 \\times 10^{-12} \\, \\mathrm{F/m} \\approx 6.95 \\times 10^{-10} \\, \\mathrm{F/m}\n$$\nNext, the asymptotic mobility limits are calculated. The Hückel mobility limit ($\\kappa a \\ll 1$) is:\n$$\n\\mu_{\\mathrm{H}} = \\frac{2 \\varepsilon \\zeta}{3 \\eta} = \\frac{2 \\cdot (6.95 \\times 10^{-10}) \\cdot (-25.0 \\times 10^{-3})}{3 \\cdot (1.0 \\times 10^{-3})} \\approx -1.158 \\times 10^{-8} \\, \\mathrm{m^2/(V \\cdot s)}\n$$\nThe Smoluchowski mobility limit ($\\kappa a \\gg 1$) is:\n$$\n\\mu_{\\mathrm{S}} = \\frac{\\varepsilon \\zeta}{\\eta} = \\frac{3}{2}\\mu_{\\mathrm{H}} \\approx -1.737 \\times 10^{-8} \\, \\mathrm{m^2/(V \\cdot s)}\n$$\nThe interpolated mobility is given by $\\mu_{\\mathrm{interp}}(\\kappa a) = \\mu_{\\mathrm{H}} \\cdot H(\\kappa a)$, where the Henry-type function is $H(\\kappa a) = 1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}$.\n\nNow, we evaluate each test case.\n\n**Case A: Near-Hückel limit ($ \\kappa a = 10^{-2} $) **\nThe required output is the relative error $\\mathrm{err}_{\\mathrm{H}} = |\\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{H}}| / |\\mu_{\\mathrm{H}}| = |H(\\kappa a) - 1|$.\n$$\n\\mathrm{err}_{\\mathrm{H}} = \\left| \\left(1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}\\right) - 1 \\right| = \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}\n$$\nFor $\\kappa a = 0.01$:\n$$\n\\mathrm{err}_{\\mathrm{H}} = \\frac{1}{2} \\frac{0.01}{1 + 0.01} = \\frac{0.005}{1.01} \\approx 0.0049505\n$$\n\n**Case B: Intermediate regime ($ \\kappa a = 1 $) **\nThe required output is the interpolated mobility, $\\mu_{\\mathrm{interp}}$. First, we calculate the Henry function:\n$$\nH(1) = 1 + \\frac{1}{2} \\frac{1}{1 + 1} = 1 + \\frac{1}{4} = 1.25\n$$\nThen, we compute the mobility:\n$$\n\\mu_{\\mathrm{interp}} = \\mu_{\\mathrm{H}} \\cdot H(1) \\approx (-1.158 \\times 10^{-8}) \\cdot 1.25 \\approx -1.448 \\times 10^{-8} \\, \\mathrm{m^2/(V \\cdot s)}\n$$\n\n**Case C: Near-Smoluchowski limit ($ \\kappa a = 100 $) **\nThe required output is the relative error $\\mathrm{err}_{\\mathrm{S}} = |\\mu_{\\mathrm{interp}} - \\mu_{\\mathrm{S}}| / |\\mu_{\\mathrm{S}}|$.\n$$\n\\mathrm{err}_{\\mathrm{S}} = \\frac{|\\mu_{\\mathrm{H}} H(\\kappa a) - \\frac{3}{2}\\mu_{\\mathrm{H}}|}{|\\frac{3}{2}\\mu_{\\mathrm{H}}|} = \\frac{|H(\\kappa a) - \\frac{3}{2}|}{3/2}\n$$\nThe term in the numerator is $H(\\kappa a) - \\frac{3}{2} = (1 + \\frac{1}{2} \\frac{\\kappa a}{1 + \\kappa a}) - \\frac{3}{2} = - \\frac{1}{2(1 + \\kappa a)}$.\nThe error is therefore:\n$$\n\\mathrm{err}_{\\mathrm{S}} = \\frac{|- \\frac{1}{2(1 + \\kappa a)}|}{3/2} = \\frac{1}{3(1 + \\kappa a)}\n$$\nFor $\\kappa a = 100$:\n$$\n\\mathrm{err}_{\\mathrm{S}} = \\frac{1}{3(1 + 100)} = \\frac{1}{303} \\approx 0.0033003\n$$\nThe final results are compiled into the required list format.",
            "answer": "[0.0049504950495049505,-1.4480284457788476e-08,0.0033003300330033004]"
        }
    ]
}