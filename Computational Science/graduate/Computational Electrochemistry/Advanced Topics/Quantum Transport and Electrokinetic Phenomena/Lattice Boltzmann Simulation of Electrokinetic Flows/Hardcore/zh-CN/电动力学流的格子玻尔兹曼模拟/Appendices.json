{
    "hands_on_practices": [
        {
            "introduction": "要掌握格子玻尔兹曼方法（LBM），首先必须理解其微观参数如何映射到宏观流体性质。本实践将引导您完成一项基础性的理论推导：运用Chapman-Enskog展开分析，从带有BGK碰撞算子的格子玻尔兹曼方程出发，推导出流体的运动黏度$ \\nu $与无量纲弛豫时间$ \\tau $之间的关系。完成这项推导不仅能加深您对LBM如何模拟流体动力学的理解，更是正确设置任何LBM仿真参数的理论基石。",
            "id": "4249960",
            "problem": "考虑一个用于等温电解质耦合电动模拟的流体求解器，其中流体动力学通过采用单松弛时间 Bhatnagar–Gross–Krook (BGK) 碰撞算子的格子玻尔兹曼方法 (LBM) 进行演化。假设离散速度集满足标准的二阶和四阶各向同性。溶剂的密度和动量由 $f_i$ 的矩定义，$ \\rho = \\sum_{i} f_{i}$ 和 $ \\rho u_{\\alpha} = \\sum_{i} c_{i\\alpha} f_{i}$，其中 $c_{i\\alpha}$ 是离散速度的笛卡尔分量。粒子布居数的更新规则为\n$$\nf_{i}(\\mathbf{x}+\\mathbf{c}_{i}\\,\\Delta t, t+\\Delta t) - f_{i}(\\mathbf{x}, t)\n= -\\frac{1}{\\tau}\\Big(f_{i}(\\mathbf{x}, t) - f_{i}^{\\mathrm{eq}}(\\rho, \\mathbf{u})\\Big) + \\Delta t\\,\\Phi_{i},\n$$\n其中 $\\tau$ 是以时间步长为单位的无量纲松弛时间，$\\Delta t$ 是物理时间步长，$\\Phi_{i}$ 是一个力项，代表光滑的体积力，例如静电力密度。在低马赫数下有效的等温平衡分布函数是二阶 Hermite 展开式\n$$\nf_{i}^{\\mathrm{eq}}(\\rho,\\mathbf{u}) = w_{i}\\,\\rho\\left[1 + \\frac{c_{i\\alpha} u_{\\alpha}}{c_{s}^{2}} + \\frac{(c_{i\\alpha} u_{\\alpha})(c_{i\\beta} u_{\\beta})}{2 c_{s}^{4}} - \\frac{u_{\\alpha} u_{\\alpha}}{2 c_{s}^{2}} \\right],\n$$\n其中格子权重 $w_i$ 遵循各向同性约束\n$$\n\\sum_{i} w_{i} = 1,\\quad \\sum_{i} w_{i}\\,c_{i\\alpha} = 0,\\quad \\sum_{i} w_{i}\\,c_{i\\alpha} c_{i\\beta} = c_{s}^{2}\\,\\delta_{\\alpha\\beta},\n$$\n$$\n\\sum_{i} w_{i}\\,c_{i\\alpha} c_{i\\beta} c_{i\\gamma} = 0,\\quad\n\\sum_{i} w_{i}\\,c_{i\\alpha} c_{i\\beta} c_{i\\gamma} c_{i\\delta} = c_{s}^{4}\\left(\\delta_{\\alpha\\beta}\\delta_{\\gamma\\delta} + \\delta_{\\alpha\\gamma}\\delta_{\\beta\\delta} + \\delta_{\\alpha\\delta}\\delta_{\\beta\\gamma}\\right),\n$$\n其中 $c_s$ 是格子声速，$\\delta_{\\alpha\\beta}$ 是克罗内克 δ 符号。假设场是光滑的、马赫数较低且克努森数较小。为分离出本构关系，设 $\\Phi_{i} = 0$；这在主导阶上不改变剪切粘度系数。\n\n仅使用上述定义和一个与时间步长和梯度的二阶精度一致的 Chapman–Enskog 多尺度展开，推导连续介质动量方程，并确定牛顿粘性应力。据此，确定运动粘度关于 $c_{s}$、$\\tau$ 和 $\\Delta t$ 的显式符号表达式。以这些符号的单个代数表达式形式给出最终答案。无需进行数值计算，最终表达式也无需报告单位。",
            "solution": "我们从离散时间的 BGK 格子玻尔兹曼方程开始\n$$\nf_{i}(\\mathbf{x}+\\mathbf{c}_{i}\\,\\Delta t, t+\\Delta t) - f_{i}(\\mathbf{x}, t)\n= -\\frac{1}{\\tau}\\Big(f_{i}(\\mathbf{x}, t) - f_{i}^{\\mathrm{eq}}(\\rho, \\mathbf{u})\\Big),\n$$\n为清晰起见，将力项设为零。我们将方程左侧在 $(\\mathbf{x}, t)$ 处对 $\\Delta t$ 进行泰勒展开至二阶：\n$$\n\\Delta t\\left(\\partial_{t} + c_{i\\alpha}\\partial_{\\alpha}\\right) f_{i}\n+ \\frac{\\Delta t^{2}}{2}\\left(\\partial_{t} + c_{i\\alpha}\\partial_{\\alpha}\\right)^{2} f_{i}\n= -\\frac{1}{\\tau}\\left(f_{i} - f_{i}^{\\mathrm{eq}}\\right) + \\mathcal{O}(\\Delta t^{3}).\n$$\n我们对小克努森数和低马赫数情况进行 Chapman–Enskog 展开。引入一个形式小参数 $\\epsilon$ 来对时空导数和非平衡贡献进行分阶：\n$$\n\\partial_{t} = \\epsilon\\,\\partial_{t_{1}} + \\epsilon^{2}\\,\\partial_{t_{2}},\\qquad\n\\partial_{\\alpha} = \\epsilon\\,\\partial_{\\alpha},\\qquad\nf_{i} = f_{i}^{(0)} + \\epsilon\\,f_{i}^{(1)} + \\epsilon^{2}\\,f_{i}^{(2)} + \\cdots,\n$$\n其中 $\\mathbf{u} = \\mathcal{O}(\\epsilon)$，因此 $f_{i}^{\\mathrm{eq}}$ 在速度上一致地展开到二阶。\n\n将泰勒展开后的方程除以 $\\Delta t$ 并收集 $\\epsilon$ 的各阶项，得到以下方程组：\n$$\n\\epsilon^{0}:\\quad 0 = -\\frac{1}{\\tau \\Delta t}\\left(f_{i}^{(0)} - f_{i}^{\\mathrm{eq}}\\right) \\;\\Rightarrow\\; f_{i}^{(0)} = f_{i}^{\\mathrm{eq}}.\n$$\n在一阶，\n$$\n\\epsilon^{1}:\\quad \\left(\\partial_{t_{1}} + c_{i\\alpha}\\partial_{\\alpha}\\right) f_{i}^{(0)} = -\\frac{1}{\\tau \\Delta t} f_{i}^{(1)} \\;\\Rightarrow\\; f_{i}^{(1)} = -\\tau \\Delta t \\left(\\partial_{t_{1}} + c_{i\\alpha}\\partial_{\\alpha}\\right) f_{i}^{(0)}.\n$$\n在二阶，\n$$\n\\epsilon^{2}:\\quad \\partial_{t_{2}} f_{i}^{(0)} + \\left(\\partial_{t_{1}} + c_{i\\alpha}\\partial_{\\alpha}\\right) f_{i}^{(1)} + \\frac{\\Delta t}{2}\\left(\\partial_{t_{1}} + c_{i\\alpha}\\partial_{\\alpha}\\right)^{2} f_{i}^{(0)} = -\\frac{1}{\\tau \\Delta t} f_{i}^{(2)}.\n$$\n\n定义每一阶的流体动力学矩。在零阶，守恒矩给出：\n$$\n\\rho = \\sum_{i} f_{i} = \\sum_{i} f_{i}^{(0)} + \\mathcal{O}(\\epsilon) = \\sum_{i} f_{i}^{\\mathrm{eq}},\n\\qquad\n\\rho u_{\\beta} = \\sum_{i} c_{i\\beta} f_{i} = \\sum_{i} c_{i\\beta} f_{i}^{(0)} + \\mathcal{O}(\\epsilon).\n$$\n使用平衡分布，零阶压力张量（平衡动量通量）为\n$$\n\\Pi_{\\alpha\\beta}^{(0)} \\equiv \\sum_{i} c_{i\\alpha} c_{i\\beta} f_{i}^{(0)} = \\sum_{i} c_{i\\alpha} c_{i\\beta} f_{i}^{\\mathrm{eq}}\n= \\rho c_{s}^{2}\\,\\delta_{\\alpha\\beta} + \\rho u_{\\alpha} u_{\\beta},\n$$\n这里我们使用了各向同性关系，并保留了直到 $\\mathbf{u}$ 的二次项。\n\n对一阶方程取零阶矩和一阶矩，得到欧拉级别的方程。对 $i$ 求和，\n$$\n\\sum_{i}\\left(\\partial_{t_{1}} + c_{i\\alpha}\\partial_{\\alpha}\\right) f_{i}^{(0)} = \\partial_{t_{1}} \\rho + \\partial_{\\alpha}(\\rho u_{\\alpha}) = 0.\n$$\n乘以 $c_{i\\beta}$ 并求和，\n$$\n\\partial_{t_{1}}(\\rho u_{\\beta}) + \\partial_{\\alpha}\\Pi_{\\alpha\\beta}^{(0)} = 0\n\\;\\;\\Rightarrow\\;\\;\n\\partial_{t_{1}}(\\rho u_{\\beta}) + \\partial_{\\beta}(\\rho c_{s}^{2}) + \\partial_{\\alpha}(\\rho u_{\\alpha} u_{\\beta}) = 0.\n$$\n将一阶和二阶时间尺度 $\\partial_{t} = \\epsilon\\,\\partial_{t_{1}} + \\epsilon^{2}\\,\\partial_{t_{2}}$ 上的动量方程相加，可以恢复包含粘性项的纳维-斯托克斯方程。总动量方程的形式为：\n$$\n\\partial_{t}(\\rho u_{\\beta}) + \\partial_{\\alpha}(\\rho u_{\\alpha} u_{\\beta}) = -\\partial_{\\beta}p + \\partial_{\\alpha}\\left[\\mu\\left(\\partial_{\\alpha} u_{\\beta} + \\partial_{\\beta} u_{\\alpha} - \\frac{2}{d}\\,\\delta_{\\alpha\\beta}\\,\\partial_{\\gamma} u_{\\gamma}\\right)\\right],\n$$\n其中 $p = \\rho c_s^2$ 是压力。通过查普曼-恩斯科展开，可以证明宏观动力粘度 $\\mu$ 与物理弛豫时间 $\\tau_{\\text{phys}}$ 的关系为：\n$$\n\\mu = \\rho c_s^2 \\left(\\tau_{\\text{phys}} - \\frac{\\Delta t}{2}\\right).\n$$\n运动粘度 $\\nu = \\mu/\\rho$ 为：\n$$\n\\nu = c_s^2 \\left(\\tau_{\\text{phys}} - \\frac{\\Delta t}{2}\\right).\n$$\n根据问题定义，$\\tau$ 是以时间步长 $\\Delta t$ 为单位的无量纲松弛时间，因此物理弛豫时间与无量纲弛豫时间的关系是 $\\tau_{\\text{phys}} = \\tau \\Delta t$。将此关系代入运动粘度的表达式中，我们得到：\n$$\n\\nu = c_s^2 \\left(\\tau \\Delta t - \\frac{1}{2}\\Delta t\\right) = c_s^2\\left(\\tau - \\frac{1}{2}\\right)\\Delta t.\n$$\n这就是对于标准的等温 BGK 格子玻尔兹曼流体，运动粘度、格子声速、松弛时间和时间步长之间所求的关系。",
            "answer": "$$\\boxed{c_{s}^{2}\\left(\\tau - \\frac{1}{2}\\right)\\Delta t}$$"
        },
        {
            "introduction": "在掌握了连接LBM参数与物理性质的理论关系之后，下一步便是将其应用于实际的仿真设置中。本练习旨在模拟一个真实的电渗流微通道系统，指导您如何选择合适的晶格间距、时间步长以及弛豫时间，以便精确匹配电解质溶液的物理黏度和离子扩散系数。这项实践要求您在满足马赫数限制、数值稳定性以及计算效率等多重约束条件下，完成从物理单位到晶格单位的转换和参数整定，是将在理论知识转化为仿真能力的关键一步。",
            "id": "4250003",
            "problem": "一个二维电渗微通道流将使用晶格玻尔兹曼方法（LBM）进行模拟。流体部分采用 D2Q9 晶格上的单松弛时间（SRT）Bhatnagar-Gross-Krook（BGK）碰撞算子，并与 D2Q5 晶格上用于单一离子种类的平流-扩散 LBM 相耦合。微通道高度指定为 $H = 128 \\,\\mu\\text{m}$，在垂直于壁面的方向上用 $N_y = 128$ 个晶格节点均匀解析，因此晶格间距为 $\\Delta x = H/N_y$。特征流体速度为 $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$，运动粘度为 $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$（室温下的水），离子扩散系数为 $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$（一种典型的小单价离子）。\n\n从带有 Bhatnagar-Gross-Krook (BGK) 松弛的玻尔兹曼方程及其二阶 Chapman–Enskog 流体动力学极限出发，推导将流体动力学运动粘度和标量扩散系数与 D2Q9 和 D2Q5 晶格上相应的 LBM 松弛时间联系起来的关系式。使用这些关系式，在以下约束条件下，确定以晶格单位表示的松弛时间 $\\tau$（流体）和 $\\tau_s$（种类），以同时再现目标 $\\nu_{\\text{phys}}$ 和 $D_{\\text{phys}}$：\n- 低马赫数约束：在特征速度 $U^{\\ast}$ 下，晶格马赫数满足 $\\text{Ma} \\leq 0.05$。\n- 正定性和稳定性：$\\tau > \\tfrac{1}{2}$ 和 $\\tau_s > \\tfrac{1}{2}$。\n- 效率和精度约束：选择允许的最大时间步长 $\\Delta t$，使得 $\\tau \\leq 1.0$。\n\n假设 D2Q9 和 D2Q5 满足标准矩各向同性，使得晶格声速在晶格单位下满足 $c_s^2 = \\tfrac{1}{3}$。将最终答案表示为以晶格单位（无量纲）表示的数对 $(\\tau, \\tau_s)$。将每个松弛时间四舍五入到六位有效数字。",
            "solution": "首先通过提取给定信息并评估其科学合理性、一致性和完整性来验证问题。\n\n### 步骤 1: 提取的已知条件\n- **系统**：二维电渗微通道流。\n- **模拟方法**：采用单松弛时间（SRT）BGK 碰撞算子的晶格玻尔兹曼方法（LBM）。\n- **流体晶格**：D2Q9。\n- **离子种类晶格**：D2Q5，用于单一平流-扩散种类。\n- **物理尺寸**：通道高度 $H = 128 \\,\\mu\\text{m}$。\n- **离散化**：垂直于壁面方向有 $N_y = 128$ 个晶格节点，晶格间距为 $\\Delta x = H/N_y$。\n- **物理性质**：\n    - 特征流体速度 $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$。\n    - 运动粘度 $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$。\n    - 离子扩散系数 $D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$。\n- **理论基础**：从 BGK-玻尔兹曼方程的二阶 Chapman–Enskog 流体动力学极限推导。\n- **约束条件**：\n    1. 低马赫数约束：在速度 $U^{\\ast}$ 下，$\\text{Ma} \\leq 0.05$。\n    2. 正定性和稳定性：$\\tau > \\frac{1}{2}$ 和 $\\tau_s > \\frac{1}{2}$。\n    3. 效率和精度约束：选择允许的最大时间步长 $\\Delta t$，使得 $\\tau \\leq 1.0$。\n- **晶格性质**：D2Q9 和 D2Q5 的标准矩各向同性，使得晶格声速的平方在晶格单位下为 $c_s^2 = \\frac{1}{3}$。\n- **要求输出**：无量纲晶格单位下的松弛时间 $(\\tau, \\tau_s)$，四舍五入到六位有效数字。\n\n### 步骤 2: 验证\n该问题具有科学依据，提法恰当且客观。它描述了计算流体动力学中的一个标准问题，特别是参数化晶格玻尔兹曼模拟以匹配物理输运系数。物理数值对于水和小离子是符合实际的。这些约束是确保 LBM 模拟中的稳定性、准确性和计算效率的标准约束。所有必要信息均已提供，且无内部矛盾。\n\n### 结论\n问题有效。将构建一个解决方案。\n\n### 解答推导\n宏观输运性质与 LBM 松弛时间之间的联系是通过对带有 BGK 碰撞算子的晶格玻尔兹曼方程进行 Chapman-Enskog 展开来建立的。对于在 D2Q9 晶格上模拟的流体和在 D2Q5 晶格上的标量种类，假设采用标准的低马赫数平衡分布函数，得到的宏观方程给出了运动粘度 $\\nu$ 和种类扩散系数 $D$ 的表达式。\n\n在晶格单位（用下标 'lb' 表示，并设 $\\Delta t=1$）下，这些关系是：\n$$\n\\nu_{\\text{lb}} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\n$$\n$$\nD_{\\text{lb}} = c_s^2 \\left(\\tau_s - \\frac{1}{2}\\right)\n$$\n其中 $\\tau$ 是流体动量的松弛时间，$\\tau_s$ 是标量种类的松弛时间，而 $c_s$ 是晶格声速。问题指定两个模拟部分的 $c_s^2 = \\frac{1}{3}$。\n\n为了确定 $\\tau$ 和 $\\tau_s$ 的数值，我们必须将物理性质（$\\nu_{\\text{phys}}$，$D_{\\text{phys}}$）与其晶格对应量（$\\nu_{\\text{lb}}$，$D_{\\text{lb}}$）联系起来。这需要定义长度和时间的转换因子。设物理晶格间距为 $\\Delta x$，物理时间步长为 $\\Delta t$。\n\n单位转换如下：\n- 长度：$x_{\\text{phys}} = \\Delta x \\cdot x_{\\text{lb}}$\n- 时间：$t_{\\text{phys}} = \\Delta t \\cdot t_{\\text{lb}}$\n由此，我们推导出运动粘度和扩散系数的转换关系，它们的单位都是长度的平方除以时间：\n$$\n\\nu_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} \\nu_{\\text{lb}} \\implies \\nu_{\\text{lb}} = \\frac{\\Delta t}{(\\Delta x)^2} \\nu_{\\text{phys}}\n$$\n$$\nD_{\\text{phys}} = \\frac{(\\Delta x)^2}{\\Delta t} D_{\\text{lb}} \\implies D_{\\text{lb}} = \\frac{\\Delta t}{(\\Delta x)^2} D_{\\text{phys}}\n$$\n\n首先，我们计算物理晶格间距 $\\Delta x$：\n$$\n\\Delta x = \\frac{H}{N_y} = \\frac{128 \\times 10^{-6} \\,\\text{m}}{128} = 1.0 \\times 10^{-6} \\,\\text{m}\n$$\n\n接下来，我们必须确定物理时间步长 $\\Delta t$。问题提出了一组约束来固定这个自由参数。“效率和精度约束”指示我们选择允许的最大 $\\Delta t$，使得流体松弛时间 $\\tau \\leq 1.0$。最大化 $\\Delta t$ 可以提高计算效率，而这个最大值对应于约束的上限，即设置 $\\tau = 1.0$。\n\n设置 $\\tau = 1.0$，我们合并粘度的方程：\n$$\n\\frac{\\Delta t}{(\\Delta x)^2} \\nu_{\\text{phys}} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right)\n$$\n我们用 $\\tau = 1.0$ 求解 $\\Delta t$：\n$$\n\\Delta t = \\frac{c_s^2 \\left(1.0 - \\frac{1}{2}\\right) (\\Delta x)^2}{\\nu_{\\text{phys}}}\n$$\n代入已知值：$\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}$，$\\Delta x = 1.0 \\times 10^{-6} \\,\\text{m}$，以及 $c_s^2 = \\frac{1}{3}$：\n$$\n\\Delta t = \\frac{\\frac{1}{3} \\left(\\frac{1}{2}\\right) (1.0 \\times 10^{-6} \\,\\text{m})^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{\\frac{1}{6} \\times 1.0 \\times 10^{-12} \\,\\text{m}^2}{1.0 \\times 10^{-6} \\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{1}{6} \\times 10^{-6} \\,\\text{s}\n$$\n因此，$\\tau = 1.0$。这个值满足稳定性约束 $\\tau > \\frac{1}{2}$。\n\n现在我们必须检查这个 $\\Delta t$ 的选择是否满足低马赫数约束 $\\text{Ma} \\leq 0.05$。晶格马赫数是 $\\text{Ma} = U_{\\text{lb}} / c_s$，其中 $U_{\\text{lb}}$ 是晶格单位下的特征速度。速度的转换关系是：\n$$\nU_{\\text{phys}} = \\frac{\\Delta x}{\\Delta t} U_{\\text{lb}} \\implies U_{\\text{lb}} = \\frac{\\Delta t}{\\Delta x} U_{\\text{phys}}\n$$\n使用特征物理速度 $U^{\\ast} = 1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}$：\n$$\nU_{\\text{lb}} = \\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{1.0 \\times 10^{-6} \\,\\text{m}} \\times (1.0 \\times 10^{-3} \\,\\text{m}\\,\\text{s}^{-1}) = \\frac{1}{6} \\times 10^{-3}\n$$\n马赫数是：\n$$\n\\text{Ma} = \\frac{U_{\\text{lb}}}{c_s} = \\frac{\\frac{1}{6} \\times 10^{-3}}{1/\\sqrt{3}} = \\frac{\\sqrt{3}}{6} \\times 10^{-3} \\approx 0.0002887\n$$\n由于 $0.0002887 \\leq 0.05$，马赫数约束得到满足。\n\n最后，我们计算种类松弛时间 $\\tau_s$。我们有：\n$$\n\\tau_s = \\frac{D_{\\text{lb}}}{c_s^2} + \\frac{1}{2}\n$$\n代入 $D_{\\text{lb}}$ 的表达式：\n$$\n\\tau_s = \\frac{1}{c_s^2} \\left(\\frac{\\Delta t}{(\\Delta x)^2} D_{\\text{phys}}\\right) + \\frac{1}{2}\n$$\n现在，代入数值：$D_{\\text{phys}} = 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}$ 和先前确定的参数：\n$$\n\\tau_s = \\frac{1}{1/3} \\left(\\frac{\\frac{1}{6} \\times 10^{-6} \\,\\text{s}}{(1.0 \\times 10^{-6} \\,\\text{m})^2} \\times 1.0 \\times 10^{-9} \\,\\text{m}^2\\,\\text{s}^{-1}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = 3 \\left(\\frac{\\frac{1}{6} \\times 10^{-6}}{1.0 \\times 10^{-12}} \\times 1.0 \\times 10^{-9}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = 3 \\left(\\frac{1}{6} \\times 10^{6} \\times 10^{-9}\\right) + \\frac{1}{2} = 3 \\left(\\frac{1}{6} \\times 10^{-3}\\right) + \\frac{1}{2}\n$$\n$$\n\\tau_s = \\frac{1}{2} \\times 10^{-3} + \\frac{1}{2} = 0.0005 + 0.5 = 0.5005\n$$\n这个值满足稳定性约束 $\\tau_s > \\frac{1}{2}$。\n\n得到的松弛时间对为 $(\\tau, \\tau_s) = (1.0, 0.5005)$。按要求四舍五入到六位有效数字，得到 $(\\tau, \\tau_s) = (1.00000, 0.500500)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.00000 & 0.500500\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "建立模型后，批判性地评估其核心假设是计算科学研究中至关重要的一环。许多用于电动流的LBM仿真为简化问题而采用等温假设，但在强电场下，焦耳热效应可能导致显著的温度变化，从而使该假设失效。本练习要求您从第一性原理出发，量化焦耳热的功率密度以及在通道中产生的最大温升。通过将计算出的温升与可容忍的阈值进行比较，您将学会建立一个明确的准则，用以判断何时可以安全地使用等温模型，以及何时必须考虑更复杂的热-格子玻尔兹曼耦合方法。",
            "id": "4249986",
            "problem": "考虑一个用于模拟电解质水溶液在平行板微通道中动电流动的等温格子玻尔兹曼 (LB) 模拟设置。该微通道高度为 $H$，其等温壁面保持在温度 $T_w$。一个大小为 $E$ 的外部均匀电场沿通道轴向施加，电解质的特性由电导率 $\\sigma$ 和热导率 $k$ 决定。忽略电热体力，并假设双电层相对于通道高度很薄，因此体欧姆传导在电流中占主导地位。LB 求解器忽略能量方程，并假设材料属性恒定。\n\n您的任务是从适用于计算电化学和动电输运的第一性原理出发，通过量化焦耳热以及由于向等温壁面的一维传导而在流体中引起的最大温升，为等温 LB 假设的有效性推导出一个保守的稳态判据。具体来说，从以下基础出发：电流密度在电解质中遵循线性本构关系；具有均匀内部体积生热和等温边界的稳态一维能量平衡控制着整个通道的温度场。基于这些基础，获得量化体积功率密度和通道中平面处最大温升的通用表达式。由此，通过将最大温升与指定的容差 $\\Delta T_{\\mathrm{tol}}$ 进行比较，为等温 LB 假设构建一个二元有效性检验。\n\n您的程序必须实现推导出的表达式，并对以下以国际单位制 (SI) 表示的测试套件进行评估。对于每种情况，使用给定的参数计算体积功率密度和中心线最大温升，然后当最大温升不超过容差时，返回等温 LB 假設是否有效。所有输入均应被解释为带有标明单位的常数；所有输出必须以指定的单位表示。\n\n测试套件：\n\n- 情况 $1$：$\\sigma = 0.14 \\,\\mathrm{S/m}$，$E = 5000 \\,\\mathrm{V/m}$，$H = 100 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.1 \\,\\mathrm{K}$。\n- 情况 $2$：$\\sigma = 0.5 \\,\\mathrm{S/m}$，$E = 19600 \\,\\mathrm{V/m}$，$H = 50 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.1 \\,\\mathrm{K}$。\n- 情况 $3$：$\\sigma = 1.5 \\,\\mathrm{S/m}$，$E = 150000 \\,\\mathrm{V/m}$，$H = 200 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.5 \\,\\mathrm{K}$。\n- 情况 $4$：$\\sigma = 5 \\times 10^{-6} \\,\\mathrm{S/m}$，$E = 100000 \\,\\mathrm{V/m}$，$H = 50 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.6 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.01 \\,\\mathrm{K}$。\n- 情况 $5$：$\\sigma = 0.2 \\,\\mathrm{S/m}$，$E = 10000 \\,\\mathrm{V/m}$，$H = 100 \\times 10^{-6} \\,\\mathrm{m}$，$k = 0.1 \\,\\mathrm{W/(m\\cdot K)}$，$\\Delta T_{\\mathrm{tol}} = 0.25 \\,\\mathrm{K}$。\n\n对于每个测试用例，计算：\n\n- 由焦耳热引起的体积功率密度，单位为 $\\mathrm{W/m^3}$，以浮点数形式返回。\n- 相对于壁面的最大中心线温升，单位为 $\\mathrm{K}$，以浮点数形式返回。\n- 一个布尔值，指示在推导的判据下等温 LB 假设是否有效，其中有效性定义为最大温升小于或等于容差 $\\Delta T_{\\mathrm{tol}}$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是按 $\\left[p,\\Delta T_{\\max},\\text{valid}\\right]$ 顺序排列的包含三个值的列表。例如，结构必须是 $\\left[\\left[p_1,\\Delta T_{\\max,1},\\text{valid}_1\\right],\\left[p_2,\\Delta T_{\\max,2},\\text{valid}_2\\right],\\dots\\right]$。请确保 $p$ 的单位是 $\\mathrm{W/m^3}$，$\\Delta T_{\\max}$ 的单位是 $\\mathrm{K}$，并且有效性标志是一个布尔值。",
            "solution": "该问题是有效的，因为它以电化学和传热学原理为科学基础，信息充分、问题适定，并以客观、正式的语言表述。我们继续推导有效性判据。\n\n我们的目标是为动电流动的格子玻尔兹曼 (LB) 模拟中的等温假设建立一个有效性判据。这需要量化由焦耳热引起的温升，并将其与一个容差进行比较。推导过程分三步进行：首先，我们确定由焦耳热产生的体积生热率；其次，我们求解稳态热传导方程以找到最大温升；第三，我们基于此温升制定有效性判据。\n\n首先，我们推导由焦耳热引起的体积功率密度 $p$ 的表达式。问题陈述，电解质中的电流密度 $\\vec{J}$ 与施加的电场 $\\vec{E}$ 遵循线性本构关系。这是微分形式的欧姆定律：\n$$\n\\vec{J} = \\sigma \\vec{E}\n$$\n其中 $\\sigma$ 是电解质的电导率。体积功率耗散表现为热源，由电场与电流密度的点积给出：\n$$\np = \\vec{E} \\cdot \\vec{J}\n$$\n代入 $\\vec{J}$ 的表达式，并注意到问题指定了一个大小为 $E$ 的均匀电场，我们得到：\n$$\np = \\vec{E} \\cdot (\\sigma \\vec{E}) = \\sigma (\\vec{E} \\cdot \\vec{E}) = \\sigma |\\vec{E}|^2 = \\sigma E^2\n$$\n由于假设 $\\sigma$ 和 $E$ 是常数，因此体积生热 $p$ 在整个流体中是均匀的。其单位为 $(\\text{S/m}) \\cdot (\\text{V/m})^2 = (\\text{A}/\\text{V}\\cdot\\text{m}) \\cdot (\\text{V}^2/\\text{m}^2) = (\\text{A}\\cdot\\text{V})/\\text{m}^3 = \\text{W}/\\text{m}^3$，这与功率密度的单位一致。\n\n其次，我们确定通道中的最大温升 $\\Delta T_{\\max}$。问题指定了一个高度为 $H$、等温壁面温度为 $T_w$ 的平行板微通道。我们考虑沿通道高度的一维稳态能量平衡。让我们定义一个坐标系，其 $y$ 轴垂直于平板，其中 $y=0$ 是通道中心线，壁面位于 $y = \\pm H/2$。具有均匀内部热源 $p$ 的热传导控制微分方程为：\n$$\n\\frac{d}{dy}\\left(k \\frac{dT}{dy}\\right) + p = 0\n$$\n其中 $k$ 是电解质的热导率，$T(y)$ 是温度分布。由于假设 $k$ 为常数，方程简化为：\n$$\n\\frac{d^2T}{dy^2} = -\\frac{p}{k}\n$$\n我们在壁面处等温边界条件 $T(y=H/2) = T_w$ 和 $T(y=-H/2) = T_w$ 下求解此方程。对该方程关于 $y$ 积分一次，得到：\n$$\n\\frac{dT}{dy} = -\\frac{p}{k} y + C_1\n$$\n由于几何和边界条件的对称性，温度分布必须关于中心线 ($y=0$) 对称，这意味着该点的温度梯度为零。应用此对称条件 $dT/dy|_{y=0} = 0$，我们发现第一个积分常数 $C_1 = 0$。因此温度梯度为 $\\frac{dT}{dy} = - (p/k)y$。第二次积分给出温度分布：\n$$\nT(y) = \\int -\\frac{p}{k} y \\, dy = -\\frac{p}{2k} y^2 + C_2\n$$\n为了求出第二个积分常数 $C_2$，我们应用壁面处的边界条件，例如在 $y = H/2$ 处：\n$$\nT(H/2) = T_w = -\\frac{p}{2k} \\left(\\frac{H}{2}\\right)^2 + C_2 \\implies C_2 = T_w + \\frac{pH^2}{8k}\n$$\n完整的温度分布是一个抛物线：\n$$\nT(y) = T_w + \\frac{pH^2}{8k} - \\frac{p}{2k} y^2 = T_w + \\frac{p}{2k}\\left(\\frac{H^2}{4} - y^2\\right)\n$$\n最高温度 $T_{\\max}$ 出现在中心线 ($y=0$) 处：\n$$\nT_{\\max} = T(0) = T_w + \\frac{pH^2}{8k}\n$$\n因此，相对于壁面温度的最大温升 $\\Delta T_{\\max}$ 为：\n$$\n\\Delta T_{\\max} = T_{\\max} - T_w = \\frac{pH^2}{8k}\n$$\n代入我们先前推导的表达式 $p = \\sigma E^2$，我们得到最大温升的最终公式：\n$$\n\\Delta T_{\\max} = \\frac{\\sigma E^2 H^2}{8k}\n$$\n\n第三，我们构建有效性检验。问题陈述，如果最大温升不超过指定的容差 $\\Delta T_{\\mathrm{tol}}$，则认为等温 LB 假設是有效的。这给出了二元判据：\n$$\n\\text{有效性} \\iff \\Delta T_{\\max} \\le \\Delta T_{\\mathrm{tol}}\n$$\n\n这些推导出的表达式允许对给定的测试用例直接计算体积功率密度、最大温升以及等温假设的有效性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a criterion for the validity of the isothermal assumption\n    in a Lattice Boltzmann simulation of electrokinetic flow by quantifying\n    Joule heating and the resulting temperature rise.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (sigma, E, H, k, dt_tol) in SI units.\n    # sigma (S/m), E (V/m), H (m), k (W/(m.K)), dt_tol (K)\n    test_cases = [\n        (0.14, 5000, 100e-6, 0.6, 0.1),\n        (0.5, 19600, 50e-6, 0.6, 0.1),\n        (1.5, 150000, 200e-6, 0.6, 0.5),\n        (5e-6, 100000, 50e-6, 0.6, 0.01),\n        (0.2, 10000, 100e-6, 0.1, 0.25),\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma, E, H, k, dt_tol = case\n\n        # 1. Calculate the volumetric power density (p) due to Joule heating.\n        # Formula: p = sigma * E^2\n        p = sigma * E**2\n\n        # 2. Calculate the maximum centerline temperature rise (dt_max).\n        # Formula: dt_max = (p * H^2) / (8 * k)\n        dt_max = (p * H**2) / (8 * k)\n\n        # 3. Determine if the isothermal assumption is valid.\n        # Criterion: dt_max = dt_tol\n        is_valid = dt_max = dt_tol\n\n        # Store the results [p, dt_max, is_valid] for the current case.\n        results.append([p, dt_max, is_valid])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # To precisely match the required output format `[[...],[...]]`, we manually\n    # construct the string representation.\n    output_str = \"[\" + \",\".join([str(r) for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}