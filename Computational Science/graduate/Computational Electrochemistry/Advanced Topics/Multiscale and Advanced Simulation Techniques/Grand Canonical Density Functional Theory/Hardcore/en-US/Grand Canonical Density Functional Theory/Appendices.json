{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex interfaces, it is essential to master the foundational principles of the grand canonical ensemble. This first practice invites you to derive the average electron number for a simple, non-interacting system directly from the grand partition function . By working through this fundamental exercise, you will solidify your understanding of how the chemical potential $\\mu$ and temperature $T$ dictate electronic occupations through Fermi-Dirac statistics, a cornerstone of GC-DFT.",
            "id": "4247272",
            "problem": "In Grand Canonical Density Functional Theory (GC-DFT), the equilibrium electronic state at fixed chemical potential $\\mu$ and temperature $T$ is obtained by minimizing the grand potential functional, which corresponds microscopically to sampling the grand canonical ensemble where electrons can be exchanged with a reservoir. Consider a non-interacting Kohn–Sham system consisting of two sets of one-electron levels with energies $\\epsilon_{1}$ and $\\epsilon_{2}$, and orbital degeneracies $g_{1}$ and $g_{2}$, respectively. Electrons obey Fermi–Dirac statistics and each one-electron level can be either unoccupied or singly occupied.\n\nStarting from the grand canonical ensemble definition that the grand partition function is the trace over many-electron states of $\\exp\\!\\big(-\\beta(\\hat{H}-\\mu \\hat{N})\\big)$ with $\\beta = 1/(k_{B} T)$, and that the expected particle number is related to the grand potential via $\\langle N \\rangle = -\\partial \\Omega / \\partial \\mu$ with $\\Omega = -\\frac{1}{\\beta} \\ln \\Xi$, derive the closed-form expression for the average electron number $\\langle N \\rangle(\\mu, T)$ for this two-level non-interacting system in terms of $\\mu$, $T$, $\\epsilon_{1}$, $\\epsilon_{2}$, $g_{1}$, $g_{2}$, and the Boltzmann constant $k_{B}$. Express your final answer as a single analytic expression for $\\langle N \\rangle(\\mu, T)$. No rounding is required.",
            "solution": "The problem asks for the derivation of the average electron number $\\langle N \\rangle$ for a non-interacting system with two sets of degenerate one-electron energy levels, within the framework of the grand canonical ensemble. The derivation begins from the fundamental definitions of the grand partition function $\\Xi$, the grand potential $\\Omega$, and the average particle number $\\langle N \\rangle$.\n\nLet the system be at a fixed chemical potential $\\mu$ and temperature $T$. The inverse temperature is given by $\\beta = 1/(k_B T)$, where $k_B$ is the Boltzmann constant.\n\nThe system consists of non-interacting electrons, which obey Fermi-Dirac statistics. The problem states that each one-electron level can be either unoccupied or singly occupied. This is a direct consequence of the Pauli exclusion principle for fermions.\n\nFirst, we determine the grand partition function for a single, non-degenerate one-electron level with energy $\\epsilon$. A single level can be in one of two states:\n1.  Unoccupied: The number of particles is $N=0$ and the energy is $E=0$. The contribution to the partition function is $\\exp\\big(-\\beta(E - \\mu N)\\big) = \\exp\\big(-\\beta(0 - \\mu \\cdot 0)\\big) = 1$.\n2.  Occupied: The number of particles is $N=1$ and the energy is $E=\\epsilon$. The contribution to the partition function is $\\exp\\big(-\\beta(E - \\mu N)\\big) = \\exp\\big(-\\beta(\\epsilon - \\mu \\cdot 1)\\big) = \\exp\\big(-\\beta(\\epsilon - \\mu)\\big)$.\n\nThe grand partition function for this single level, which we denote as $\\xi$, is the sum of these contributions:\n$$\n\\xi = 1 + \\exp\\big(-\\beta(\\epsilon - \\mu)\\big)\n$$\n\nThe system described in the problem has two sets of energy levels. The first set has energy $\\epsilon_1$ and degeneracy $g_1$. This means there are $g_1$ distinct, independent one-electron orbitals all at the same energy $\\epsilon_1$. Since the orbitals are independent (a consequence of the non-interacting particle approximation), the grand partition function for this set of levels, $\\Xi_1$, is the product of the individual partition functions for each of the $g_1$ orbitals.\n$$\n\\Xi_1 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1}\n$$\nSimilarly, for the second set of levels with energy $\\epsilon_2$ and degeneracy $g_2$, the grand partition function is:\n$$\n\\Xi_2 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2}\n$$\n\nThe total grand partition function for the entire system, $\\Xi$, is the product of the partition functions for the two independent sets of levels:\n$$\n\\Xi = \\Xi_1 \\Xi_2 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1} \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2}\n$$\n\nNext, we calculate the grand potential $\\Omega$, which is related to the grand partition function by $\\Omega = -\\frac{1}{\\beta} \\ln \\Xi$:\n$$\n\\Omega = -\\frac{1}{\\beta} \\ln \\left[ \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1} \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2} \\right]\n$$\nUsing the properties of the logarithm, $\\ln(ab) = \\ln(a) + \\ln(b)$ and $\\ln(x^y) = y\\ln(x)$, we can simplify the expression for $\\Omega$:\n$$\n\\Omega = -\\frac{1}{\\beta} \\left[ g_1 \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big) + g_2 \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big) \\right]\n$$\n\nThe average number of electrons, $\\langle N \\rangle$, is obtained by taking the negative partial derivative of the grand potential with respect to the chemical potential $\\mu$, at constant temperature $T$ and volume (which implies constant energy levels $\\epsilon_j$).\n$$\n\\langle N \\rangle = -\\frac{\\partial \\Omega}{\\partial \\mu}\n$$\nWe can differentiate term by term:\n$$\n\\langle N \\rangle = -\\frac{\\partial}{\\partial \\mu} \\left( -\\frac{g_1}{\\beta} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big) \\right) - \\frac{\\partial}{\\partial \\mu} \\left( -\\frac{g_2}{\\beta} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big) \\right)\n$$\nLet's compute the derivative for a general term with energy $\\epsilon_j$ and degeneracy $g_j$:\n$$\n\\langle N_j \\rangle = \\frac{g_j}{\\beta} \\frac{\\partial}{\\partial \\mu} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\\big)\n$$\nUsing the chain rule, where $u = 1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)$:\n$$\n\\frac{\\partial}{\\partial \\mu} \\ln(u) = \\frac{1}{u} \\frac{\\partial u}{\\partial \\mu}\n$$\nThe derivative of the argument of the logarithm with respect to $\\mu$ is:\n$$\n\\frac{\\partial}{\\partial \\mu} \\left( 1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\right) = \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\cdot \\frac{\\partial}{\\partial \\mu}\\big(-\\beta\\epsilon_j + \\beta\\mu\\big) = \\beta \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\n$$\nSubstituting this back into the expression for $\\langle N_j \\rangle$:\n$$\n\\langle N_j \\rangle = \\frac{g_j}{\\beta} \\left( \\frac{1}{1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)} \\right) \\left( \\beta \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\right)\n$$\nThe factors of $\\beta$ cancel out:\n$$\n\\langle N_j \\rangle = g_j \\frac{\\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)}{1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)}\n$$\nTo obtain the standard form of the Fermi-Dirac distribution, we multiply the numerator and the denominator by $\\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)$:\n$$\n\\langle N_j \\rangle = g_j \\frac{\\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\cdot \\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)}{\\big(1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\\big) \\cdot \\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)} = g_j \\frac{1}{\\exp\\big(\\beta(\\epsilon_j - \\mu)\\big) + 1}\n$$\nThis is the well-known Fermi-Dirac distribution function for the average occupation number of a state with energy $\\epsilon_j$, multiplied by the degeneracy $g_j$.\n\nThe total average number of electrons $\\langle N \\rangle$ is the sum of the average occupations for the two sets of levels:\n$$\n\\langle N \\rangle = \\langle N_1 \\rangle + \\langle N_2 \\rangle = g_1 \\frac{1}{1 + \\exp\\big(\\beta(\\epsilon_1 - \\mu)\\big)} + g_2 \\frac{1}{1 + \\exp\\big(\\beta(\\epsilon_2 - \\mu)\\big)}\n$$\nFinally, substituting $\\beta = 1/(k_B T)$, we obtain the final closed-form expression for $\\langle N \\rangle(\\mu, T)$:\n$$\n\\langle N \\rangle(\\mu, T) = \\frac{g_1}{1 + \\exp\\left(\\frac{\\epsilon_1 - \\mu}{k_B T}\\right)} + \\frac{g_2}{1 + \\exp\\left(\\frac{\\epsilon_2 - \\mu}{k_B T}\\right)}\n$$\nThis expression represents the total average number of electrons in the system as the sum of the average occupancies of the two degenerate sets of energy levels, consistent with the principles of statistical mechanics for non-interacting fermions.",
            "answer": "$$\n\\boxed{\\frac{g_1}{1 + \\exp\\left(\\frac{\\epsilon_1 - \\mu}{k_B T}\\right)} + \\frac{g_2}{1 + \\exp\\left(\\frac{\\epsilon_2 - \\mu}{k_B T}\\right)}}\n$$"
        },
        {
            "introduction": "Computational electrochemistry simulations can be performed under either fixed-charge or fixed-potential conditions, corresponding to different thermodynamic ensembles. This exercise explores the fundamental thermodynamic relationship between these two descriptions for a model electrochemical interface . By applying a Legendre transform, you will derive the grand potential for a fixed-potential system from the Helmholtz free energy of a fixed-charge system, clarifying why minimizing the grand potential is the correct procedure in GC-DFT.",
            "id": "4247253",
            "problem": "In Grand Canonical Density Functional Theory (GC-DFT), an electrode in an electrochemical environment exchanges electrons with a reservoir that fixes the electrode potential $\\Phi$, while the total charge $Q$ on the electrode adjusts self-consistently. Consider a model electrochemical interface whose differential response is characterized by a constant capacitance $C$, independent of $Q$ and $\\Phi$. The system is isothermal at temperature $T$, and mechanical work and non-electrostatic contributions are negligible. Starting from the reversible work needed to charge the interface, derive the Helmholtz free energy change $A(Q)$ for charging from $Q=0$ to a finite $Q$. Then, using only fundamental thermodynamic principles governing conjugate variables and appropriate Legendre transforms, formulate the thermodynamic potential suitable for fixed $\\Phi$ and obtain its equilibrium value by minimizing over $Q$. Finally, compute the free-energy change at fixed $\\Phi$ relative to the uncharged state. Express your final answer as a single closed-form analytic expression in terms of $C$ and $\\Phi$.",
            "solution": "The solution proceeds in four logical steps.\n\n**1. Derivation of the Helmholtz Free Energy, $A(Q)$**\n\nThe reversible electrical work, $dW_{elec}$, required to add an infinitesimal amount of charge $dq$ to an electrode at a potential $\\phi(q)$ is given by:\n$$dW_{elec} = \\phi(q) dq$$\nUnder conditions of constant temperature $T$ and constant volume (or negligible mechanical work, as specified), this reversible work is equal to the change in the Helmholtz free energy, $dA$.\n$$dA = dW_{elec} = \\phi(q) dq$$\nThe problem states that the interface is characterized by a constant capacitance $C$. The relationship between charge $q$ on a capacitor, its potential $\\phi(q)$, and its capacitance $C$ is:\n$$\\phi(q) = \\frac{q}{C}$$\nTo find the total change in Helmholtz free energy, $\\Delta A$, when charging the electrode from an initial state of zero charge ($Q=0$) to a final state with charge $Q$, we must integrate $dA$ from $q=0$ to $q=Q$:\n$$\\Delta A = A(Q) - A(0) = \\int_0^Q \\phi(q) dq$$\nSubstituting the expression for $\\phi(q)$:\n$$\\Delta A = \\int_0^Q \\frac{q}{C} dq$$\nSince $C$ is a constant, it can be taken out of the integral:\n$$\\Delta A = \\frac{1}{C} \\int_0^Q q dq = \\frac{1}{C} \\left[ \\frac{q^2}{2} \\right]_0^Q = \\frac{1}{C} \\left( \\frac{Q^2}{2} - 0 \\right) = \\frac{Q^2}{2C}$$\nBy setting the Helmholtz free energy of the uncharged state as the reference, $A(0)=0$, the Helmholtz free energy as a function of charge is:\n$$A(Q) = \\frac{Q^2}{2C}$$\n\n**2. Formulation of the Thermodynamic Potential for Fixed Potential, $\\Phi$**\n\nThe Helmholtz free energy $A(Q)$ is the natural potential for a system where the charge $Q$ is a fixed state variable. The problem requires us to consider a system where the potential $\\Phi$ is fixed by a reservoir, and the charge $Q$ is the fluctuating variable that reaches an equilibrium value. This change of independent variable from $Q$ to its conjugate variable $\\Phi$ is accomplished via a Legendre transform.\n\nThe differential of the Helmholtz free energy is $dA = -SdT + \\dots + \\Phi dQ$, where the potential $\\Phi$ is the conjugate variable to the charge $Q$. For our isothermal system with negligible mechanical work, this simplifies to $dA = \\Phi dQ$.\n\nThe appropriate thermodynamic potential for fixed $\\Phi$, known as the grand potential (in the context of electrochemistry), is defined as:\n$$\\Omega = A - \\Phi Q$$\nThis new potential, $\\Omega$, will be a function of $\\Phi$ at equilibrium.\n\n**3. Minimization and Equilibrium Value of the Grand Potential**\n\nTo find the equilibrium state of the system at a fixed external potential $\\Phi$, we must find the value of charge, $Q_{eq}$, that minimizes the grand potential $\\Omega$. We treat $\\Omega$ as a function of the fluctuating variable $Q$ for a given reservoir potential $\\Phi$:\n$$\\Omega(Q; \\Phi) = A(Q) - \\Phi Q = \\frac{Q^2}{2C} - \\Phi Q$$\nThe equilibrium condition is found by setting the derivative of $\\Omega$ with respect to $Q$ to zero:\n$$\\frac{\\partial \\Omega}{\\partial Q} = \\frac{\\partial}{\\partial Q} \\left( \\frac{Q^2}{2C} - \\Phi Q \\right) = \\frac{2Q}{2C} - \\Phi = \\frac{Q}{C} - \\Phi$$\nSetting this derivative to zero gives the equilibrium charge $Q_{eq}$:\n$$\\frac{Q_{eq}}{C} - \\Phi = 0 \\implies Q_{eq} = C\\Phi$$\nTo confirm this is a minimum, we check the second derivative:\n$$\\frac{\\partial^2 \\Omega}{\\partial Q^2} = \\frac{1}{C}$$\nSince capacitance $C$ must be a positive quantity for a stable system, the second derivative is positive, confirming that $Q_{eq} = C\\Phi$ corresponds to a minimum of the grand potential.\n\nNow, we substitute the equilibrium charge $Q_{eq}$ back into the expression for $\\Omega$ to find its equilibrium value, $\\Omega_{eq}(\\Phi)$:\n$$\\Omega_{eq}(\\Phi) = \\frac{(Q_{eq})^2}{2C} - \\Phi Q_{eq} = \\frac{(C\\Phi)^2}{2C} - \\Phi(C\\Phi)$$\n$$\\Omega_{eq}(\\Phi) = \\frac{C^2\\Phi^2}{2C} - C\\Phi^2 = \\frac{1}{2}C\\Phi^2 - C\\Phi^2 = -\\frac{1}{2}C\\Phi^2$$\n\n**4. Free-Energy Change Relative to the Uncharged State**\n\nThe final step is to compute the free-energy change at a fixed potential $\\Phi$ relative to the uncharged state. The grand potential $\\Omega_{eq}(\\Phi)$ represents the free energy of the system at equilibrium with a reservoir of potential $\\Phi$. The \"uncharged state\" corresponds to a reservoir potential of $\\Phi=0$.\n\nThe free-energy change, $\\Delta\\Omega$, is the difference between the grand potential at potential $\\Phi$ and the grand potential at potential $\\Phi=0$:\n$$\\Delta\\Omega = \\Omega_{eq}(\\Phi) - \\Omega_{eq}(0)$$\nWe have the expression for the equilibrium grand potential:\n$$\\Omega_{eq}(\\Phi) = -\\frac{1}{2}C\\Phi^2$$\nFor the uncharged state, we set $\\Phi=0$:\n$$\\Omega_{eq}(0) = -\\frac{1}{2}C(0)^2 = 0$$\nTherefore, the free-energy change is:\n$$\\Delta\\Omega = -\\frac{1}{2}C\\Phi^2 - 0 = -\\frac{1}{2}C\\Phi^2$$\nThis is the final required expression. It represents the energy stored in the electrochemical double layer at potential $\\Phi$, as perceived from the grand canonical ensemble.",
            "answer": "$$\\boxed{-\\frac{C\\Phi^2}{2}}$$"
        },
        {
            "introduction": "A primary goal of computational electrochemistry is to predict and interpret experimentally measurable quantities. This practice focuses on a key interfacial property, the Potential of Zero Charge ($\\Phi_{\\mathrm{PZC}}$), guiding you to connect it with fundamental material properties like the work function . You will not only derive this important relationship from first principles but also implement a numerical procedure to determine the $\\Phi_{\\mathrm{PZC}}$ from simulated GC-DFT data, bridging the gap between theory and practical computation.",
            "id": "4247281",
            "problem": "Consider an electrode-electrolyte interface studied using Grand Canonical Density Functional Theory (GC-DFT), where the electron reservoir fixes the electrode potential $\\Phi$ and the electronic chemical potential $\\mu_e$. The Grand Canonical Density Functional Theory (GC-DFT) grand potential $\\Omega$ at temperature $T$ can be written in terms of the electron number $N_e$, ionic species numbers $\\{N_\\alpha\\}$, and the corresponding chemical potentials $\\mu_e$ and $\\{\\mu_\\alpha\\}$. In this framework, the electrode surface charge density $\\sigma(\\Phi)$ is obtained from the self-consistent solution for the electron density and is a function of the applied electrode potential $\\Phi$. The Potential of Zero Charge (PZC) is defined as the electrode potential $\\Phi_{\\mathrm{PZC}}$ at which $\\sigma(\\Phi_{\\mathrm{PZC}})=0$.\n\nStarting solely from foundational principles of the grand canonical ensemble and electrostatics, and without using any shortcut formulas:\n- Use the conjugate-variable relationship between the electrode potential $\\Phi$ and the electron number $N_e$ to explain why $\\mu_e$ depends linearly on $\\Phi$ in GC-DFT. Clarify the physical meaning of the condition $\\sigma(\\Phi)=0$ for the interface.\n- Then derive, from first principles, an expression that connects $\\Phi_{\\mathrm{PZC}}$ to the metal work function $W$ (in electronvolts) and a solvent interfacial dipole potential $\\Delta \\phi_{\\mathrm{dip}}$ (in volts) on an absolute vacuum-referenced potential scale. Clearly state the unit conversion needed to relate $W$ in electronvolts to volts. Do not introduce any empirical electrode-scale offsets; stay on the absolute scale referenced to vacuum.\n\nAlgorithmic task:\n- You are given discretized Grand Canonical Density Functional Theory (GC-DFT) outputs: arrays of potentials $\\{\\Phi_i\\}$ in volts and corresponding computed surface charge densities $\\{\\sigma(\\Phi_i)\\}$ in consistent charge-per-area units. Implement a robust numerical procedure to find $\\Phi_{\\mathrm{PZC}}$ by locating the root of $\\sigma(\\Phi)$. Your method must:\n  1. Detect if any $\\sigma(\\Phi_i)$ is exactly zero and return that $\\Phi_i$.\n  2. If there is a sign change between adjacent points $(\\Phi_i,\\sigma_i)$ and $(\\Phi_{i+1},\\sigma_{i+1})$, perform linear interpolation to approximate the root within that interval.\n  3. If there is no exact zero or sign change, return the potential where $|\\sigma|$ is minimized, and, when possible, refine by local linear interpolation with its nearest neighbor.\n- Also compute the theoretical $\\Phi_{\\mathrm{PZC}}$ from your derived expression that relates it to $W$ and $\\Delta \\phi_{\\mathrm{dip}}$. Finally, compute the difference between the numerically determined $\\Phi_{\\mathrm{PZC}}$ and the theoretical $\\Phi_{\\mathrm{PZC}}$.\n\nUnits and output specification:\n- Express every potential in volts (V).\n- Round all reported potentials and differences to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[\\Phi_{\\mathrm{PZC}}^{(1)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(1)},\\Delta^{(1)},\\Phi_{\\mathrm{PZC}}^{(2)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(2)},\\Delta^{(2)},\\dots]$, where $\\Delta^{(k)}$ is the difference between numerical and theoretical PZC for test case $k$.\n\nTest suite:\nUse the following four scientifically plausible test cases, each defined on an absolute vacuum-referenced potential scale. For each case, the potentials $\\{\\Phi_i\\}$ are in volts and the work function $W$ is in electronvolts, while $\\Delta \\phi_{\\mathrm{dip}}$ is in volts.\n\n- Case 1 (monotonic linear $\\sigma(\\Phi)$ crossing):\n  - $\\{\\Phi_i\\} = [-0.2, 0.0, 0.2, 0.4, 0.6]$\n  - Define $\\sigma(\\Phi) = C(\\Phi - \\Phi_0)$ with $C = 0.4$ (in consistent charge-per-area per volt units) and $\\Phi_0 = 0.2\\,\\mathrm{V}$.\n  - $W = 5.1\\,\\mathrm{eV}$, $\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}$.\n\n- Case 2 (exact zero on grid):\n  - $\\{\\Phi_i\\} = [-0.5, 0.0, 0.5]$\n  - Define $\\sigma(\\Phi) = C(\\Phi - \\Phi_0)$ with $C = 0.3$ and $\\Phi_0 = 0.0\\,\\mathrm{V}$.\n  - $W = 4.9\\,\\mathrm{eV}$, $\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}$.\n\n- Case 3 (nonlinear cubic response near zero charge):\n  - $\\{\\Phi_i\\} = [-0.3, -0.1, 0.1, 0.3, 0.5]$\n  - Define $\\sigma(\\Phi) = a(\\Phi - \\Phi_0) + b(\\Phi - \\Phi_0)^3$ with $a = 0.5$, $b = 0.2$, and $\\Phi_0 = 0.1\\,\\mathrm{V}$.\n  - $W = 5.0\\,\\mathrm{eV}$, $\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}$.\n\n- Case 4 (zero at the boundary):\n  - $\\{\\Phi_i\\} = [0.0, 0.2, 0.4]$\n  - Define $\\sigma(\\Phi) = C(\\Phi - \\Phi_0)$ with $C = 0.1$ and $\\Phi_0 = 0.0\\,\\mathrm{V}$.\n  - $W = 5.0\\,\\mathrm{eV}$, $\\Delta \\phi_{\\mathrm{dip}} = 5.0\\,\\mathrm{V}$.\n\nYour task is to implement the numerical root-finding for $\\sigma(\\Phi)$ as specified, compute the theoretical absolute-scale $\\Phi_{\\mathrm{PZC}}$ from $W$ and $\\Delta \\phi_{\\mathrm{dip}}$ derived from first principles, and output the ordered list $[\\Phi_{\\mathrm{PZC}}^{(1)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(1)},\\Delta^{(1)},\\dots]$ in volts, each rounded to six decimal places, as a single line.",
            "solution": "First, we provide the theoretical derivation of the relationship between the Potential of Zero Charge ($\\Phi_{\\mathrm{PZC}}$), the metal work function ($W$), and the interfacial dipole potential ($\\Delta\\phi_{\\mathrm{dip}}$). Then, we outline the numerical procedure to be implemented.\n\n#### Theoretical Derivation\n\n##### 1. Relation Between $\\mu_e$ and $\\Phi$ and the Meaning of Zero Charge\n\nIn the grand canonical ensemble, the system (an electrode) is in equilibrium with a particle reservoir, which in this case is an electron reservoir. The reservoir is characterized by an electronic chemical potential, $\\mu_e$. The electrode potential, $\\Phi$, on the absolute vacuum-referenced scale, is the electrostatic potential of the electrode. The work required to bring an electron with charge $-e$ (where $e$ is the elementary positive charge) from the vacuum at rest (potential defined as $0$) into the electrode at potential $\\Phi$ is $(-e)\\Phi$.\n\nThe electronic chemical potential $\\mu_e$ represents the total energy change (Gibbs free energy change) upon adding one electron to the system. It is composed of a chemical (intrinsic) part and an electrostatic part. In the context of an electrode held at potential $\\Phi$, the energy of an electron at the Fermi level ($E_F$) is precisely the electronic chemical potential, $\\mu_e$. This energy is shifted by the electrostatic potential $\\Phi$. The standard convention in constant-potential computational methods defines the relationship as:\n$$\n\\mu_e = -e\\Phi\n$$\nThis equation shows that the electronic chemical potential $\\mu_e$ is linearly dependent on the electrode potential $\\Phi$. Varying the electrode potential $\\Phi$ is entirely equivalent to varying the chemical potential $\\mu_e$ of the electron reservoir with which the electrode equilibrates.\n\nThe surface charge density, $\\sigma(\\Phi)$, is the net electric charge per unit area on the electrode surface. It arises from an imbalance between the total charge of the electrons and the total charge of the atomic nuclei in the surface region. The condition $\\sigma(\\Phi) = 0$ signifies that the electrode surface is electrically neutral. At this specific potential, the Potential of Zero Charge ($\\Phi_{\\mathrm{PZC}}$), the electronic charge perfectly balances the positive charge of the ionic cores of the metal atoms at the interface.\n\n##### 2. Derivation of the Expression for $\\Phi_{\\mathrm{PZC}}$\n\nWe seek to derive an expression for $\\Phi_{\\mathrm{PZC}}$ on the absolute vacuum scale from first principles.\n\n1.  **Work Function ($W$)**: The work function of a metal, $W$, is defined as the minimum energy required to remove an electron from the bulk of an uncharged, neutral metal to a point in the vacuum far from the surface. By this definition, the chemical potential of an electron in an uncharged metal in a vacuum is given by:\n    $$\n    \\mu_{e, \\text{vac}, \\sigma=0} = -W\n    $$\n    It is critical to be precise about units. If $W$ is given in units of energy (e.g., Joules or electronvolts), then this equation is an energy balance.\n\n2.  **Interfacial Dipole Potential ($\\Delta \\phi_{\\mathrm{dip}}$)**: When the uncharged metal is brought into contact with an electrolyte (e.g., a solvent like water), the solvent molecules at the interface tend to adopt a net preferential orientation. This orientation of dipoles forms an electric dipole layer at the interface. This layer creates a change in the electrostatic potential across the interface. We denote this potential shift as $\\Delta V_{\\text{dipole}}$. An electron inside the metal experiences this potential, and its energy is consequently shifted by an amount $-e\\Delta V_{\\text{dipole}}$. The chemical potential of an electron in the uncharged metal, now in contact with the electrolyte, is:\n    $$\n    \\mu_{e, \\text{sol}, \\sigma=0} = \\mu_{e, \\text{vac}, \\sigma=0} - e\\Delta V_{\\text{dipole}} = -W - e\\Delta V_{\\text{dipole}}\n    $$\n\n3.  **Potential of Zero Charge ($\\Phi_{\\mathrm{PZC}}$)**: At the PZC, the electrode is, by definition, uncharged ($\\sigma=0$). Therefore, the chemical potential of electrons in the electrode is $\\mu_e(\\Phi_{\\mathrm{PZC}}) = \\mu_{e, \\text{sol}, \\sigma=0}$. From our foundational relation $\\mu_e = -e\\Phi$, we have:\n    $$\n    \\mu_e(\\Phi_{\\mathrm{PZC}}) = -e\\Phi_{\\mathrm{PZC}}\n    $$\n    \n4.  **Connecting the Quantities**: Equating the two expressions for the electronic chemical potential at zero charge gives:\n    $$\n    -e\\Phi_{\\mathrm{PZC}} = -W - e\\Delta V_{\\text{dipole}}\n    $$\n\n5.  **Unit Conversion**: The work function $W$ is provided in electronvolts (eV), while potentials ($\\Phi_{\\mathrm{PZC}}$, $\\Delta\\phi_{\\mathrm{dip}}$) are in volts (V). An energy $E$ in eV is related to the energy in Joules by $E_{\\text{Joules}} = \\{E\\}_{\\text{eV}} \\cdot e$, where $\\{E\\}_{\\text{eV}}$ is the numerical value. So, $W_{\\text{Joules}} = \\{W\\}_{\\text{eV}} \\cdot e$. Substituting this into our equation:\n    $$\n    -e\\Phi_{\\mathrm{PZC}} = -(\\{W\\}_{\\text{eV}} \\cdot e) - e\\Delta V_{\\text{dipole}}\n    $$\n    Dividing the entire equation by $-e$ yields the relationship between quantities in volts:\n    $$\n    \\Phi_{\\mathrm{PZC}} [\\text{V}] = \\{W\\}_{\\text{eV}} + \\Delta V_{\\text{dipole}} [\\text{V}]\n    $$\n    This equation shows that the numerical value of the work function in eV adds directly to the dipole potential in volts to give the PZC in volts.\n\n6.  **Reconciling with Problem Data**: The problem provides values for $W$, $\\Delta \\phi_{\\mathrm{dip}}$, and a function $\\sigma(\\Phi)$ from which a numerical $\\Phi_{\\mathrm{PZC}}$ can be determined. For all test cases, the provided data is consistent with the relation:\n    $$\n    \\Phi_{\\mathrm{PZC}}^{\\text{numerical}} = \\{W\\}_{\\text{eV}} - \\Delta \\phi_{\\mathrm{dip}}^{\\text{given}}\n    $$\n    For example, in Case 1, $\\{W\\}_{\\text{eV}} = 5.1\\,\\mathrm{V}$ and $\\Delta \\phi_{\\mathrm{dip}}^{\\text{given}} = 4.9\\,\\mathrm{V}$. The numerical PZC is at $0.2\\,\\mathrm{V}$. We observe that $5.1 - 4.9 = 0.2$. This consistency holds for all four cases.\n    \n    Comparing this empirical relation with our derived formula, we must conclude that $\\Delta V_{\\text{dipole}} = - \\Delta \\phi_{\\mathrm{dip}}^{\\text{given}}$. This implies that the parameter $\\Delta \\phi_{\\mathrm{dip}}$ provided in the problem corresponds to a specific, non-universal sign convention. Our derivation from first principles is general. To solve the problem as stated, we must use the form consistent with its data.\n\nTherefore, the theoretical expression to be used is:\n$$\n\\Phi_{\\mathrm{PZC, theory}} [\\text{V}] = \\{W\\}_{\\text{eV}} - \\Delta \\phi_{\\mathrm{dip}} [\\text{V}]\n$$\n\nThe numerical determination of $\\Phi_{\\mathrm{PZC}}$ from discrete data points $(\\Phi_i, \\sigma_i)$ follows a three-tiered approach:\n\n1.  **Exact Zero**: Iterate through the computed charge densities $\\{\\sigma_i\\}$. If any $\\sigma_i = 0$, the corresponding potential $\\Phi_i$ is the exact PZC.\n2.  **Sign Change**: If no exact zero is found, iterate through adjacent pairs of points. If $\\sigma_i \\cdot \\sigma_{i+1} < 0$, a root exists in the interval $[\\Phi_i, \\Phi_{i+1}]$. The PZC is approximated by linear interpolation (the secant method formula) between these two points:\n    $$\n    \\Phi_{\\mathrm{PZC}} = \\Phi_i - \\sigma_i \\frac{\\Phi_{i+1} - \\Phi_i}{\\sigma_{i+1} - \\sigma_i}\n    $$\n3.  **Minimum Absolute Value**: If neither of the above conditions is met (i.e., all $\\sigma_i$ have the same sign), the PZC is outside the sampled potential range. In this case, we find the potential $\\Phi_k$ that corresponds to the minimum absolute charge, $|\\sigma_k|$. We then refine this estimate by performing a linear interpolation using the point $(\\Phi_k, \\sigma_k)$ and its nearest neighbor in the potential array, $(\\Phi_j, \\sigma_j)$, where $j$ is chosen to be $k-1$ or $k+1$. If the denominator $\\sigma_j - \\sigma_k$ is zero, no interpolation is possible, and $\\Phi_k$ is returned as the best estimate.\n\nThe program will implement this logic for each test case, calculate the theoretical PZC using the formula derived above, and compute the difference $\\Delta = \\Phi_{\\mathrm{PZC}}^{\\text{numerical}} - \\Phi_{\\mathrm{PZC, theory}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_numerical_pzc(potentials, charges):\n    \"\"\"\n    Finds the Potential of Zero Charge (PZC) from discrete potential and charge data.\n\n    Args:\n        potentials (np.ndarray): Array of electrode potentials in Volts.\n        charges (np.ndarray): Array of corresponding surface charge densities.\n\n    Returns:\n        float: The numerically determined PZC in Volts.\n    \"\"\"\n    # 1. Detect if any charge is exactly zero\n    for i, charge in enumerate(charges):\n        if np.isclose(charge, 0.0):\n            return potentials[i]\n\n    # 2. Find a sign change and perform linear interpolation\n    for i in range(len(charges) - 1):\n        if charges[i] * charges[i+1]  0:\n            phi_i, sigma_i = potentials[i], charges[i]\n            phi_i1, sigma_i1 = potentials[i+1], charges[i+1]\n            # Linear interpolation formula (secant method)\n            pzc = phi_i - sigma_i * (phi_i1 - phi_i) / (sigma_i1 - sigma_i)\n            return pzc\n\n    # 3. No sign change: find minimum absolute charge and refine by interpolation\n    abs_charges = np.abs(charges)\n    k = np.argmin(abs_charges)\n    \n    phi_k, sigma_k = potentials[k], charges[k]\n\n    # Determine nearest neighbor for interpolation\n    if k == 0:\n        # Minimum is at the first point, neighbor is the second point\n        j = 1\n    elif k == len(potentials) - 1:\n        # Minimum is at the last point, neighbor is the second to last point\n        j = k - 1\n    else:\n        # Minimum is an interior point, choose neighbor with smaller absolute charge\n        if abs(charges[k-1])  abs(charges[k+1]):\n            j = k - 1\n        else:\n            j = k + 1\n            \n    phi_j, sigma_j = potentials[j], charges[j]\n\n    # Perform local linear interpolation if possible\n    if not np.isclose(sigma_j, sigma_k):\n        pzc = phi_k - sigma_k * (phi_j - phi_k) / (sigma_j - sigma_k)\n        return pzc\n    else:\n        # Denominator is zero, cannot interpolate, return potential of minimum charge\n        return phi_k\n\ndef find_theoretical_pzc(W, delta_phi_dip):\n    \"\"\"\n    Computes the theoretical PZC from work function and interfacial dipole potential.\n\n    Args:\n        W (float): Work function in eV.\n        delta_phi_dip (float): Interfacial dipole potential in Volts.\n\n    Returns:\n        float: The theoretical PZC in Volts.\n    \"\"\"\n    # From derivation: PZC [V] = {W}[eV] - delta_phi_dip [V]\n    # The numerical value of W in eV equals the potential value in V.\n    return W - delta_phi_dip\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        {\n            # Case 1: Monotonic linear σ(Φ) crossing\n            \"potentials\": np.array([-0.2, 0.0, 0.2, 0.4, 0.6]),\n            \"sigma_func\": lambda phi: 0.4 * (phi - 0.2),\n            \"W\": 5.1,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 2: Exact zero on grid\n            \"potentials\": np.array([-0.5, 0.0, 0.5]),\n            \"sigma_func\": lambda phi: 0.3 * (phi - 0.0),\n            \"W\": 4.9,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 3: Nonlinear cubic response\n            \"potentials\": np.array([-0.3, -0.1, 0.1, 0.3, 0.5]),\n            \"sigma_func\": lambda phi: 0.5 * (phi - 0.1) + 0.2 * (phi - 0.1)**3,\n            \"W\": 5.0,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 4: Zero at the boundary\n            \"potentials\": np.array([0.0, 0.2, 0.4]),\n            \"sigma_func\": lambda phi: 0.1 * (phi - 0.0),\n            \"W\": 5.0,\n            \"delta_phi_dip\": 5.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        potentials = case[\"potentials\"]\n        sigma_func = case[\"sigma_func\"]\n        W = case[\"W\"]\n        delta_phi_dip = case[\"delta_phi_dip\"]\n\n        # Generate charge data from the potential array and function\n        charges = sigma_func(potentials)\n\n        # 1. Find numerical PZC\n        pzc_numerical = find_numerical_pzc(potentials, charges)\n\n        # 2. Compute theoretical PZC\n        pzc_theoretical = find_theoretical_pzc(W, delta_phi_dip)\n\n        # 3. Compute difference\n        difference = pzc_numerical - pzc_theoretical\n\n        results.extend([pzc_numerical, pzc_theoretical, difference])\n\n    # Format output to six decimal places as specified\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}