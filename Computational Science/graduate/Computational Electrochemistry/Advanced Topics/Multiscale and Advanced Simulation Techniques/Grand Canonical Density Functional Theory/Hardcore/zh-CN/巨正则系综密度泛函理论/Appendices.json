{
    "hands_on_practices": [
        {
            "introduction": "为了模拟电化学界面，我们首先必须理解其热力学原理。这个基础练习将指导你推导一个简单的电容器模型的自由能，该模型代表了电极-电解质双电层。你将通过勒让德变换，从固定电荷下的亥姆霍兹自由能 $A(Q)$ 切换到固定电势下的巨势 $\\Omega(\\Phi)$，这是支撑整个电化学巨正则系综方法的核心理论步骤 。",
            "id": "4247253",
            "problem": "在巨正则密度泛函理论（GC-DFT）中，电化学环境中的电极与一个电子库交换电子，该电子库固定了电极电势 $\\Phi$，而电极上的总电荷 $Q$ 则自洽地进行调整。考虑一个模型电化学界面，其微分响应由一个恒定电容 $C$ 来表征，该电容不依赖于 $Q$ 和 $\\Phi$。系统在温度 $T$ 下是等温的，且机械功和非静电贡献可以忽略不计。从为界面充电所需的可逆功出发，推导从 $Q=0$ 充电到有限电荷 $Q$ 时的亥姆霍兹自由能变化 $A(Q)$。然后，仅使用控制共轭变量的基本热力学原理和适当的勒让德变换，构建适用于固定 $\\Phi$ 的热力学势，并通过对 $Q$ 进行最小化来获得其平衡值。最后，计算在固定 $\\Phi$ 下相对于不带电状态的自由能变化。将你的最终答案表示为仅含 $C$ 和 $\\Phi$ 的单个闭式解析表达式。",
            "solution": "首先根据要求验证问题。\n\n### 步骤 1：提取已知条件\n- **系统**：电化学环境中的一个电极。\n- **系综描述**：电极与一个电子库交换电子，该电子库将电极电势固定在 $\\Phi$。电极上的总电荷 $Q$ 是一个自洽调整的涨落变量。这对应于电荷的巨正则系综。\n- **系统性质**：微分响应由一个恒定电容 $C$ 表征，该电容不依赖于电荷 $Q$ 和电势 $\\Phi$。\n- **热力学条件**：系统在温度 $T$ 下是等温的。机械功和对能量的非静电贡献可以忽略不计。\n- **目标**：\n    1. 推导将界面从 $Q=0$ 充电到最终电荷 $Q$ 时的亥姆霍兹自由能变化 $A(Q)$。\n    2. 通过勒让德变换构建适用于固定电势 $\\Phi$ 的系统的热力学势。\n    3. 通过对 $Q$ 进行最小化，求出该势的平衡值。\n    4. 计算在固定 $\\Phi$ 下相对于不带电状态（$\\Phi=0$）的最终自由能变化。\n- **最终答案格式**：一个仅含 $C$ 和 $\\Phi$ 的单个闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、提法明确且客观。它提出了一个电化学界面热力学中的标准基础问题，这是计算电化学和GC-DFT中的核心概念。恒定电容模型是一个有效且常见的物理近似（例如，一个简单的平行板电容器）。使用勒让德变换和最小化原理的指令是统计力学和热力学中的标准程序。问题是自洽的，没有矛盾或缺失信息。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 求解推导\n\n求解过程按照问题陈述中概述的四个逻辑步骤进行。\n\n**1. 亥姆霍兹自由能 $A(Q)$ 的推导**\n\n将无穷小量的电荷 $dq$ 添加到电势为 $\\phi(q)$ 的电极上所需的可逆电功 $dW_{elec}$ 由下式给出：\n$$dW_{elec} = \\phi(q) dq$$\n在恒温 $T$ 和恒容（或如题所述，机械功可忽略）的条件下，此可逆功等于亥姆霍兹自由能的变化 $dA$。\n$$dA = dW_{elec} = \\phi(q) dq$$\n问题指出，界面由一个恒定电容 $C$ 表征。电容器上的电荷 $q$、其电势 $\\phi(q)$ 及其电容 $C$ 之间的关系是：\n$$\\phi(q) = \\frac{q}{C}$$\n为了求出将电极从初始零电荷状态（$Q=0$）充电到最终电荷为 $Q$ 的状态时亥姆霍兹自由能的总变化 $\\Delta A$，我们必须将 $dA$ 从 $q=0$ 积分到 $q=Q$：\n$$\\Delta A = A(Q) - A(0) = \\int_0^Q \\phi(q) dq$$\n代入 $\\phi(q)$ 的表达式：\n$$\\Delta A = \\int_0^Q \\frac{q}{C} dq$$\n由于 $C$ 是常数，可以将其从积分中提出：\n$$\\Delta A = \\frac{1}{C} \\int_0^Q q dq = \\frac{1}{C} \\left[ \\frac{q^2}{2} \\right]_0^Q = \\frac{1}{C} \\left( \\frac{Q^2}{2} - 0 \\right) = \\frac{Q^2}{2C}$$\n通过将不带电状态的亥姆霍兹自由能设为参考，$A(0)=0$，亥姆霍兹自由能作为电荷的函数为：\n$$A(Q) = \\frac{Q^2}{2C}$$\n\n**2. 适用于固定电势 $\\Phi$ 的热力学势的构建**\n\n亥姆霍兹自由能 $A(Q)$ 是电荷 $Q$ 为固定状态变量的系统的自然势。问题要求我们考虑一个系统，其中电势 $\\Phi$ 由一个电子库固定，而电荷 $Q$ 是达到平衡值的涨落变量。这种从自变量 $Q$ 到其共轭变量 $\\Phi$ 的转换是通过勒让德变换完成的。\n\n亥姆霍兹自由能的微分是 $dA = -SdT + \\dots + \\Phi dQ$，其中电势 $\\Phi$ 是电荷 $Q$ 的共轭变量。对于我们这个机械功可忽略的等温系统，这简化为 $dA = \\Phi dQ$。\n\n适用于固定 $\\Phi$ 的热力学势，在电化学背景下称为巨势，定义为：\n$$\\Omega = A - \\Phi Q$$\n这个新的势 $\\Omega$ 在平衡时将是 $\\Phi$ 的函数。\n\n**3. 巨势的最小化与平衡值**\n\n为了找到系统在固定外部电势 $\\Phi$ 下的平衡态，我们必须找到使巨势 $\\Omega$ 最小化的电荷值 $Q_{eq}$。我们将 $\\Omega$ 视为对于给定的电子库电势 $\\Phi$ 的涨落变量 $Q$ 的函数：\n$$\\Omega(Q; \\Phi) = A(Q) - \\Phi Q = \\frac{Q^2}{2C} - \\Phi Q$$\n通过将 $\\Omega$ 对 $Q$ 的导数设为零来找到平衡条件：\n$$\\frac{\\partial \\Omega}{\\partial Q} = \\frac{\\partial}{\\partial Q} \\left( \\frac{Q^2}{2C} - \\Phi Q \\right) = \\frac{2Q}{2C} - \\Phi = \\frac{Q}{C} - \\Phi$$\n将此导数设为零，得到平衡电荷 $Q_{eq}$：\n$$\\frac{Q_{eq}}{C} - \\Phi = 0 \\implies Q_{eq} = C\\Phi$$\n为了确认这是一个最小值，我们检查二阶导数：\n$$\\frac{\\partial^2 \\Omega}{\\partial Q^2} = \\frac{1}{C}$$\n由于对于稳定系统，电容 $C$ 必须是正值，所以二阶导数为正，确认 $Q_{eq} = C\\Phi$ 对应于巨势的最小值。\n\n现在，我们将平衡电荷 $Q_{eq}$ 代回 $\\Omega$ 的表达式中，以求其平衡值 $\\Omega_{eq}(\\Phi)$：\n$$\\Omega_{eq}(\\Phi) = \\frac{(Q_{eq})^2}{2C} - \\Phi Q_{eq} = \\frac{(C\\Phi)^2}{2C} - \\Phi(C\\Phi)$$\n$$\\Omega_{eq}(\\Phi) = \\frac{C^2\\Phi^2}{2C} - C\\Phi^2 = \\frac{1}{2}C\\Phi^2 - C\\Phi^2 = -\\frac{1}{2}C\\Phi^2$$\n\n**4. 相对于不带电状态的自由能变化**\n\n最后一步是计算在固定电势 $\\Phi$ 下相对于不带电状态的自由能变化。巨势 $\\Omega_{eq}(\\Phi)$ 代表了系统与电势为 $\\Phi$ 的电子库达到平衡时的自由能。“不带电状态”对应于电子库电势为 $\\Phi=0$。\n\n自由能变化 $\\Delta\\Omega$ 是电势为 $\\Phi$ 时的巨势与电势为 $\\Phi=0$ 时的巨势之差：\n$$\\Delta\\Omega = \\Omega_{eq}(\\Phi) - \\Omega_{eq}(0)$$\n我们有平衡巨势的表达式：\n$$\\Omega_{eq}(\\Phi) = -\\frac{1}{2}C\\Phi^2$$\n对于不带电状态，我们设 $\\Phi=0$：\n$$\\Omega_{eq}(0) = -\\frac{1}{2}C(0)^2 = 0$$\n因此，自由能变化是：\n$$\\Delta\\Omega = -\\frac{1}{2}C\\Phi^2 - 0 = -\\frac{1}{2}C\\Phi^2$$\n这是最终要求的表达式。它代表了从巨正则系综的角度看，在电势 $\\Phi$ 下存储在电化学双电层中的能量。",
            "answer": "$$\\boxed{-\\frac{C\\Phi^2}{2}}$$"
        },
        {
            "introduction": "虽然恒定电容模型具有指导意义，但真实界面的行为更为复杂，其性质依赖于电势。本练习建立在先前的热力学框架之上，要求你处理一个非恒定的电容函数 $C(\\Phi)$ 。通过对基本热力学关系 $d\\Omega = -Q \\, d\\Phi$ 进行积分，你将计算出巨势的变化，从而在模拟更真实的电化学系统方面获得实践经验。",
            "id": "4247230",
            "problem": "考虑一个在巨正则密度泛函理论 (GC-DFT) 框架下处理的平面电极-电解质界面，其中温度 $T$、体积 $V$ 以及可移动物种的化学势是固定的，并且电极相对于零电荷点被控制在静电势 $ \\Phi $。单位面积的巨正则势 $ \\Omega(\\Phi) $ 是一个通过对共轭对 $(\\Phi, Q)$ 进行勒让德变换得到的热力学势，其中 $Q(\\Phi)$ 是单位面积的净界面电荷。零电荷点出现在 $ \\Phi = 0 $ 处，根据定义有 $ Q(0) = 0 $。\n\n现给定通过实验测定的单位面积微分电容作为电势的函数：\n$$\nC(\\Phi) = C_0 + C_2 \\, \\Phi^2,\n$$\n其中 $ C_0 = 0.20 \\ \\mathrm{F}\\,\\mathrm{m}^{-2} $ 且 $ C_2 = 0.10 \\ \\mathrm{F}\\,\\mathrm{m}^{-2}\\,\\mathrm{V}^{-2} $。在零电荷点处，单位面积的基准巨正则势为 $ \\Omega(0) = 1.50 \\ \\mathrm{J}\\,\\mathrm{m}^{-2} $。假设为等温条件，并且 $C(\\Phi)$ 的计算是在所有物种化学势固定的条件下进行的，这与巨正则系综的设定一致。\n\n从巨正则势的第一性原理定义出发，并仅使用适用于 GC-DFT 的核心热力学关系，推导出一个用 $ C(\\Phi) $ 表示 $ \\Omega(\\Phi) $ 的表达式，并计算在 $ \\Phi^* = 0.80 \\ \\mathrm{V} $ 时 $ \\Omega(\\Phi^*) $ 的值。将最终数值答案四舍五入至四位有效数字，并以 $ \\mathrm{J}\\,\\mathrm{m}^{-2} $ 为单位表示。",
            "solution": "该问题陈述被评估为有效。其科学基础在于应用于计算电化学领域的巨正则密度泛函理论 (GC-DFT) 的成熟热力学框架。所提出的概念——巨正则势、电极电势、界面电荷和微分电容——均为该领域的标准概念。该问题是适定的，提供了推导唯一解所需的所有必要数据和定义（$C(\\Phi)$、$C_0$、$C_2$、$\\Omega(0)$）。其语言客观，数据在量纲上保持一致。\n\n问题的核心在于巨正则系综中控制电化学界面的热力学关系。在温度 $T$、体积 $V$ 和可移动物种的化学势 $\\mu_i$ 恒定的条件下，巨正则势 $\\Omega$ 的微分通过关系式 $d\\Omega = -Q d\\Phi$ 与电极电势 $\\Phi$ 和总电荷 $Q$ 相关联。问题指明 $\\Omega(\\Phi)$ 和 $Q(\\Phi)$ 是单位面积的量。因此，基本关系式为：\n$$\nd\\Omega(\\Phi) = -Q(\\Phi) d\\Phi\n$$\n单位面积的微分电容 $C(\\Phi)$ 定义为单位面积电荷对电势的变化率：\n$$\nC(\\Phi) = \\frac{dQ(\\Phi)}{d\\Phi}\n$$\n为了求得单位面积电荷 $Q(\\Phi)$，我们必须对电容进行积分。积分从零电荷点（给定在 $\\Phi = 0$ 处）开始，根据定义，在该点有 $Q(0) = 0$。\n$$\nQ(\\Phi) - Q(0) = \\int_0^\\Phi C(\\Phi') d\\Phi'\n$$\n$$\nQ(\\Phi) = \\int_0^\\Phi C(\\Phi') d\\Phi'\n$$\n我们已知电容的函数形式：\n$$\nC(\\Phi) = C_0 + C_2 \\Phi^2\n$$\n将此式代入电荷的积分式中，得到：\n$$\nQ(\\Phi) = \\int_0^\\Phi (C_0 + C_2 (\\Phi')^2) d\\Phi'\n$$\n执行积分，得到：\n$$\nQ(\\Phi) = \\left[ C_0 \\Phi' + \\frac{C_2}{3}(\\Phi')^3 \\right]_0^\\Phi = C_0 \\Phi + \\frac{1}{3} C_2 \\Phi^3\n$$\n现在，我们可以通过对基本关系式 $d\\Omega(\\Phi) = -Q(\\Phi) d\\Phi$ 进行积分来确定单位面积的巨正则势 $\\Omega(\\Phi)$。我们从参考电势 $\\Phi = 0$ 积分到一个通用电势 $\\Phi$：\n$$\n\\Omega(\\Phi) - \\Omega(0) = \\int_0^\\Phi -Q(\\Phi') d\\Phi'\n$$\n因此，$\\Omega(\\Phi)$ 的表达式为：\n$$\n\\Omega(\\Phi) = \\Omega(0) - \\int_0^\\Phi Q(\\Phi') d\\Phi'\n$$\n代入推导出的 $Q(\\Phi')$ 表达式：\n$$\n\\Omega(\\Phi) = \\Omega(0) - \\int_0^\\Phi \\left( C_0 \\Phi' + \\frac{1}{3} C_2 (\\Phi')^3 \\right) d\\Phi'\n$$\n执行这第二次积分，得到 $\\Omega(\\Phi)$ 的最终符号表达式：\n$$\n\\Omega(\\Phi) = \\Omega(0) - \\left[ \\frac{1}{2} C_0 (\\Phi')^2 + \\frac{1}{3} C_2 \\frac{(\\Phi')^4}{4} \\right]_0^\\Phi\n$$\n$$\n\\Omega(\\Phi) = \\Omega(0) - \\frac{1}{2} C_0 \\Phi^2 - \\frac{1}{12} C_2 \\Phi^4\n$$\n这就是推导出的单位面积巨正则势作为电极电势函数的表达式。\n\n问题要求计算在 $\\Phi^* = 0.80 \\ \\mathrm{V}$ 时 $\\Omega(\\Phi^*)$ 的值。我们已知以下数值：\n$\\Omega(0) = 1.50 \\ \\mathrm{J}\\,\\mathrm{m}^{-2}$\n$C_0 = 0.20 \\ \\mathrm{F}\\,\\mathrm{m}^{-2}$\n$C_2 = 0.10 \\ \\mathrm{F}\\,\\mathrm{m}^{-2}\\,\\mathrm{V}^{-2}$\n$\\Phi^* = 0.80 \\ \\mathrm{V}$\n\n将这些数值代入推导出的表达式中：\n$$\n\\Omega(\\Phi^*) = \\Omega(0.80) = 1.50 - \\frac{1}{2} (0.20) (0.80)^2 - \\frac{1}{12} (0.10) (0.80)^4\n$$\n让我们来计算这些项。修正项的单位是 $(\\mathrm{F}\\,\\mathrm{m}^{-2}) \\cdot \\mathrm{V}^2 = (\\mathrm{C}\\,\\mathrm{V}^{-1}\\,\\mathrm{m}^{-2}) \\cdot \\mathrm{V}^2 = \\mathrm{C}\\,\\mathrm{V}\\,\\mathrm{m}^{-2} = \\mathrm{J}\\,\\mathrm{m}^{-2}$ 和 $(\\mathrm{F}\\,\\mathrm{m}^{-2}\\,\\mathrm{V}^{-2}) \\cdot \\mathrm{V}^4 = \\mathrm{F}\\,\\mathrm{V}^2\\,\\mathrm{m}^{-2} = \\mathrm{J}\\,\\mathrm{m}^{-2}$，这与 $\\Omega(0)$ 的单位是一致的。\n\n$$\n\\Omega(0.80) = 1.50 - (0.10) (0.64) - \\left(\\frac{0.10}{12}\\right) (0.4096)\n$$\n$$\n\\Omega(0.80) = 1.50 - 0.064 - \\frac{0.04096}{12}\n$$\n$$\n\\Omega(0.80) = 1.436 - 0.00341333...\n$$\n$$\n\\Omega(0.80) = 1.43258666... \\ \\mathrm{J}\\,\\mathrm{m}^{-2}\n$$\n问题要求将最终答案四舍五入至四位有效数字。第五位有效数字是 5，因此我们将第四位数字向上取整。\n$$\n\\Omega(0.80) \\approx 1.433 \\ \\mathrm{J}\\,\\mathrm{m}^{-2}\n$$",
            "answer": "$$\\boxed{1.433}$$"
        },
        {
            "introduction": "巨正则密度泛函理论（GC-DFT）的最终目标通常是预测和理解关键的实验可观测量。本练习模拟了计算电化学中的一项核心任务：从模拟数据中确定零电荷电势（PZC）。你不仅需要开发一个数值算法，通过分析电荷-电势曲线来找到PZC，还需要从第一性原理推导PZC、材料功函数以及界面溶剂效应之间的基本联系。",
            "id": "4247281",
            "problem": "考虑一个使用大正则密度泛函理论(GC-DFT)研究的电极-电解质界面，其中电子库固定了电极电势$\\,\\Phi\\,$和电子化学势$\\,\\mu_e\\,$。在温度$\\,T\\,$下，大正则密度泛函理论(GC-DFT)的大势$\\,\\Omega\\,$可以用电子数$\\,N_e\\,$、离子物种数$\\,\\{N_\\alpha\\}\\,$以及相应的化学势$\\,\\mu_e\\,$和$\\,\\{\\mu_\\alpha\\}\\,$来表示。在此框架中，电极表面电荷密度$\\,\\sigma(\\Phi)\\,$是通过求解电子密度的自洽解得到的，并且是外加电极电势$\\,\\Phi\\,$的函数。零电荷电势(PZC)定义为使得$\\,\\sigma(\\Phi_{\\mathrm{PZC}})=0\\,$成立的电极电势$\\,\\Phi_{\\mathrm{PZC}}\\,$。\n\n仅从大正则系综和静电学的基本原理出发，不使用任何简化公式：\n- 利用电极电势$\\,\\Phi\\,$和电子数$\\,N_e\\,$之间的共轭变量关系，解释在GC-DFT中为何$\\,\\mu_e\\,$线性依赖于$\\,\\Phi\\,$。阐明条件$\\,\\sigma(\\Phi)=0\\,$对界面的物理意义。\n- 然后，从第一性原理出发，在绝对真空参考电势标度上，推导一个将$\\,\\Phi_{\\mathrm{PZC}}\\,$与金属功函数$\\,W\\,$（单位为电子伏特）和一个溶剂界面偶极电势$\\,\\Delta \\phi_{\\mathrm{dip}}\\,$（单位为伏特）联系起来的表达式。明确说明将以电子伏特为单位的$\\,W\\,$关联到伏特所需的单位转换。不要引入任何经验性的电极标度偏移；保持在参考真空的绝对标度上。\n\n算法任务：\n- 给定离散化的大正则密度泛函理论(GC-DFT)输出：以伏特为单位的电势数组$\\,\\{\\Phi_i\\}\\,$和以一致的电荷/面积单位表示的相应计算出的表面电荷密度$\\,\\{\\sigma(\\Phi_i)\\}\\,$。通过定位$\\,\\sigma(\\Phi)\\,$的根，实现一个稳健的数值程序来找到$\\,\\Phi_{\\mathrm{PZC}}\\,$。您的方法必须：\n  1. 检测是否有任何$\\,\\sigma(\\Phi_i)\\,$恰好为零，若有则返回对应的$\\,\\Phi_i\\,$。\n  2. 如果在相邻点$\\,(\\Phi_i,\\sigma_i)\\,$和$\\,(\\Phi_{i+1},\\sigma_{i+1})\\,$之间存在符号变化，则在该区间内执行线性插值来近似根的位置。\n  3. 如果没有精确的零点或符号变化，返回$\\,|\\sigma|\\,$最小处的电势，并在可能的情况下，通过与其最近邻点进行局部线性插值来精化结果。\n- 同样，根据您推导的与$\\,W\\,$和$\\,\\Delta \\phi_{\\mathrm{dip}}\\,$相关的表达式计算理论$\\,\\Phi_{\\mathrm{PZC}}\\,$。最后，计算数值确定的$\\,\\Phi_{\\mathrm{PZC}}\\,$与理论$\\,\\Phi_{\\mathrm{PZC}}\\,$之间的差值。\n\n单位和输出规范：\n- 以伏特(V)表示所有电势。\n- 将所有报告的电势和差值四舍五入到六位小数。\n- 您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序为 $[\\Phi_{\\mathrm{PZC}}^{(1)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(1)},\\Delta^{(1)},\\Phi_{\\mathrm{PZC}}^{(2)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(2)},\\Delta^{(2)},\\dots]$，其中$\\,\\Delta^{(k)}\\,$是测试用例$\\,k\\,$的数值PZC和理论PZC之间的差值。\n\n测试套件：\n使用以下四个科学上合理的测试用例，每个用例都在绝对真空参考电势标度上定义。对于每个用例，电势$\\,\\{\\Phi_i\\}\\,$的单位是伏特，功函数$\\,W\\,$的单位是电子伏特，而$\\,\\Delta \\phi_{\\mathrm{dip}}\\,$的单位是伏特。\n\n- 案例1（单调线性$\\,\\sigma(\\Phi)\\,$过零）：\n  - $\\,\\{\\Phi_i\\} = [-0.2, 0.0, 0.2, 0.4, 0.6]\\,$\n  - 定义$\\,\\sigma(\\Phi) = C\\,(\\Phi - \\Phi_0)\\,$，其中$\\,C = 0.4\\,$（单位为一致的电荷/面积/伏特）且$\\,\\Phi_0 = 0.2\\,\\mathrm{V}\\,$。\n  - $\\,W = 5.1\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}\\,$.\n\n- 案例2（网格上的精确零点）：\n  - $\\,\\{\\Phi_i\\} = [-0.5, 0.0, 0.5]\\,$\n  - 定义$\\,\\sigma(\\Phi) = C\\,(\\Phi - \\Phi_0)\\,$，其中$\\,C = 0.3\\,$且$\\,\\Phi_0 = 0.0\\,\\mathrm{V}\\,$。\n  - $\\,W = 4.9\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}\\,$.\n\n- 案例3（零电荷附近的非线性三次响应）：\n  - $\\,\\{\\Phi_i\\} = [-0.3, -0.1, 0.1, 0.3, 0.5]\\,$\n  - 定义$\\,\\sigma(\\Phi) = a\\,(\\Phi - \\Phi_0) + b\\,(\\Phi - \\Phi_0)^3\\,$，其中$\\,a = 0.5\\,$，$\\,b = 0.2\\,$，且$\\,\\Phi_0 = 0.1\\,\\mathrm{V}\\,$。\n  - $\\,W = 5.0\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 4.9\\,\\mathrm{V}\\,$.\n\n- 案例4（边界上的零点）：\n  - $\\,\\{\\Phi_i\\} = [0.0, 0.2, 0.4]\\,$\n  - 定义$\\,\\sigma(\\Phi) = C\\,(\\Phi - \\Phi_0)\\,$，其中$\\,C = 0.1\\,$且$\\,\\Phi_0 = 0.0\\,\\mathrm{V}\\,$。\n  - $\\,W = 5.0\\,\\mathrm{eV}\\,$, $\\,\\Delta \\phi_{\\mathrm{dip}} = 5.0\\,\\mathrm{V}\\,$.\n\n您的任务是按照规定实现$\\,\\sigma(\\Phi)\\,$的数值求根，从第一性原理推导出的$\\,W\\,$和$\\,\\Delta \\phi_{\\mathrm{dip}}\\,$计算理论绝对标度$\\,\\Phi_{\\mathrm{PZC}}\\,$，并以单行形式输出有序列表$[\\Phi_{\\mathrm{PZC}}^{(1)},\\Phi_{\\mathrm{PZC,\\ theory}}^{(1)},\\Delta^{(1)},\\dots]$，单位为伏特，每个值四舍五入到六位小数。",
            "solution": "该问题被验证为科学上可靠、定义明确且客观。它基于大正则密度泛函理论(GC-DFT)框架内计算电化学的标准原理。所提供的数据和函数形式在一种特定的、可推导的符号约定下是内部一致且物理上合理的。算法任务定义清晰。\n\n在此，我们首先提供零电荷电势($\\Phi_{\\mathrm{PZC}}$)、金属功函数($W$)和界面偶极电势($\\Delta\\phi_{\\mathrm{dip}}$)之间关系的理论推导。然后，我们概述要实现的数值步骤。\n\n### 理论推导\n\n#### 1. $\\mu_e$与$\\Phi$的关系以及零电荷的意义\n\n在大正则系综中，系统（一个电极）与一个粒子库处于平衡状态，在此情况下，粒子库是一个电子库。该电子库由电子化学势$\\mu_e$表征。在绝对真空参考标度上，电极电势$\\Phi$是电极的静电势。将一个带电荷$-e$（其中$e$是基本正电荷）的电子从静止的真空中（电势定义为0）带入电势为$\\Phi$的电极中所需的功为$(-e)\\Phi$。\n\n电子化学势$\\mu_e$表示向系统中添加一个电子时总能量的变化（吉布斯自由能变化）。它由一个化学（内在）部分和一个静电部分组成。在电势保持为$\\Phi$的电极背景下，费米能级($E_F$)上电子的能量恰好是电子化学势$\\mu_e$。这个能量因静电势$\\Phi$而发生移动。在恒定电势计算方法中，标准约定将此关系定义为：\n$$\n\\mu_e = -e\\Phi\n$$\n该方程表明，电子化学势$\\mu_e$线性依赖于电极电势$\\Phi$。改变电极电势$\\Phi$完全等同于改变与电极达到平衡的电子库的化学势$\\mu_e$。\n\n表面电荷密度$\\sigma(\\Phi)$是电极表面单位面积上的净电荷。它源于表面区域电子总电荷与原子核总电荷之间的不平衡。条件$\\sigma(\\Phi) = 0$表示电极表面是电中性的。在这个特定的电势，即零电荷电势($\\Phi_{\\mathrm{PZC}}$)下，电子电荷与界面处金属原子的离子实的正电荷完全平衡。\n\n#### 2. $\\Phi_{\\mathrm{PZC}}$表达式的推导\n\n我们旨在从第一性原理出发，推导绝对真空标度上$\\Phi_{\\mathrm{PZC}}$的表达式。\n\n1.  **功函数($W$)**：金属的功函数$W$定义为将一个电子从未充电的中性金属内部移到远离表面的真空中某点所需的最小能量。根据此定义，在真空中未充电金属中电子的化学势由下式给出：\n    $$\n    \\mu_{e, \\text{vac}, \\sigma=0} = -W\n    $$\n    对单位保持精确至关重要。如果$W$以能量单位（如焦耳或电子伏特）给出，那么此方程是一个能量平衡方程。\n\n2.  **界面偶极电势($\\Delta \\phi_{\\mathrm{dip}}$)**：当未充电的金属与电解质（例如，像水一样的溶剂）接触时，界面处的溶剂分子倾向于采取一种净的优先取向。这种偶极子的取向在界面处形成一个电偶极层。该层在界面上产生一个静电势的变化。我们将此电势位移表示为$\\Delta V_{\\text{dipole}}$。金属内部的电子会经历这个电势，其能量因此移动了$-e\\Delta V_{\\text{dipole}}$。现在与电解质接触的未充电金属中电子的化学势为：\n    $$\n    \\mu_{e, \\text{sol}, \\sigma=0} = \\mu_{e, \\text{vac}, \\sigma=0} - e\\Delta V_{\\text{dipole}} = -W - e\\Delta V_{\\text{dipole}}\n    $$\n\n3.  **零电荷电势($\\Phi_{\\mathrm{PZC}}$)**：在零电荷电势点，根据定义，电极不带电($\\sigma=0$)。因此，电极中电子的化学势为$\\mu_e(\\Phi_{\\mathrm{PZC}}) = \\mu_{e, \\text{sol}, \\sigma=0}$。从我们的基本关系$\\mu_e = -e\\Phi$，我们有：\n    $$\n    \\mu_e(\\Phi_{\\mathrm{PZC}}) = -e\\Phi_{\\mathrm{PZC}}\n    $$\n    \n4.  **关联各物理量**：将零电荷时电子化学势的两个表达式相等，可得：\n    $$\n    -e\\Phi_{\\mathrm{PZC}} = -W - e\\Delta V_{\\text{dipole}}\n    $$\n\n5.  **单位转换**：功函数$W$以电子伏特(eV)为单位，而电势($\\Phi_{\\mathrm{PZC}}$, $\\Delta\\phi_{\\mathrm{dip}}$)以伏特(V)为单位。以eV为单位的能量$E$通过$E_{\\text{Joules}} = \\{E\\}_{\\text{eV}} \\cdot e$与以焦耳为单位的能量相关联，其中$\\{E\\}_{\\text{eV}}$是数值。所以，$W_{\\text{Joules}} = \\{W\\}_{\\text{eV}} \\cdot e$。将此代入我们的方程：\n    $$\n    -e\\Phi_{\\mathrm{PZC}} = -(\\{W\\}_{\\text{eV}} \\cdot e) - e\\Delta V_{\\text{dipole}}\n    $$\n    将整个方程除以$-e$得到以伏特为单位的各量之间的关系：\n    $$\n    \\Phi_{\\mathrm{PZC}} [\\text{V}] = \\{W\\}_{\\text{eV}} + \\Delta V_{\\text{dipole}} [\\text{V}]\n    $$\n    这个方程表明，以eV为单位的功函数的数值直接加到以伏特为单位的偶极电势上，就得到了以伏特为单位的PZC。\n\n6.  **与问题数据协调**：问题提供了$W$、$\\Delta \\phi_{\\mathrm{dip}}$的值，以及一个函数$\\sigma(\\Phi)$，从中可以确定数值上的$\\Phi_{\\mathrm{PZC}}$。对于所有测试用例，所提供的数据与以下关系一致：\n    $$\n    \\Phi_{\\mathrm{PZC}}^{\\text{numerical}} = \\{W\\}_{\\text{eV}} - \\Delta \\phi_{\\mathrm{dip}}^{\\text{given}}\n    $$\n    例如，在案例1中，$\\{W\\}_{\\text{eV}} = 5.1\\,\\mathrm{V}$且$\\Delta \\phi_{\\mathrm{dip}}^{\\text{given}} = 4.9\\,\\mathrm{V}$。数值PZC位于$0.2\\,\\mathrm{V}$。我们观察到$5.1 - 4.9 = 0.2$。这种一致性在所有四个案例中都成立。\n    \n    将这个经验关系与我们推导的公式进行比较，我们必须得出结论：$\\Delta V_{\\text{dipole}} = - \\Delta \\phi_{\\mathrm{dip}}^{\\text{given}}$。这意味着问题中提供的参数$\\Delta \\phi_{\\mathrm{dip}}$对应于一个特定的、非普适的符号约定。我们的第一性原理推导是普适的。为了按要求解决问题，我们必须使用与其数据一致的形式。\n\n因此，要使用的理论表达式是：\n$$\n\\Phi_{\\mathrm{PZC, theory}} [\\text{V}] = \\{W\\}_{\\text{eV}} - \\Delta \\phi_{\\mathrm{dip}} [\\text{V}]\n$$\n\n### 算法设计\n\n从离散数据点$(\\Phi_i, \\sigma_i)$数值确定$\\Phi_{\\mathrm{PZC}}$遵循一个三层方法：\n\n1.  **精确零点**：遍历计算出的电荷密度$\\{\\sigma_i\\}$。如果任何$\\sigma_i = 0$，则对应的电势$\\Phi_i$就是精确的PZC。\n2.  **符号变化**：如果没有找到精确零点，则遍历相邻的点对。如果$\\sigma_i \\cdot \\sigma_{i+1}  0$，则在区间$[\\Phi_i, \\Phi_{i+1}]$内存在一个根。PZC通过这两点之间的线性插值（割线法公式）来近似：\n    $$\n    \\Phi_{\\mathrm{PZC}} = \\Phi_i - \\sigma_i \\frac{\\Phi_{i+1} - \\Phi_i}{\\sigma_{i+1} - \\sigma_i}\n    $$\n3.  **最小绝对值**：如果以上两个条件都不满足（即，所有$\\sigma_i$符号相同），则PZC在采样的电势范围之外。在这种情况下，我们找到对应于最小绝对电荷$|\\sigma_k|$的电势$\\Phi_k$。然后，我们通过使用点$(\\Phi_k, \\sigma_k)$及其在电势数组中的最近邻点$(\\Phi_j, \\sigma_j)$（其中$j$选择为$k-1$或$k+1$）进行线性插值来精化此估计。如果分母$\\sigma_j - \\sigma_k$为零，则无法进行插值，返回$\\Phi_k$作为最佳估计。\n\n程序将为每个测试用例实现此逻辑，使用上面推导的公式计算理论PZC，并计算差值$\\Delta = \\Phi_{\\mathrm{PZC}}^{\\text{numerical}} - \\Phi_{\\mathrm{PZC, theory}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_numerical_pzc(potentials, charges):\n    \"\"\"\n    Finds the Potential of Zero Charge (PZC) from discrete potential and charge data.\n\n    Args:\n        potentials (np.ndarray): Array of electrode potentials in Volts.\n        charges (np.ndarray): Array of corresponding surface charge densities.\n\n    Returns:\n        float: The numerically determined PZC in Volts.\n    \"\"\"\n    # 1. Detect if any charge is exactly zero\n    for i, charge in enumerate(charges):\n        if np.isclose(charge, 0.0):\n            return potentials[i]\n\n    # 2. Find a sign change and perform linear interpolation\n    for i in range(len(charges) - 1):\n        if charges[i] * charges[i+1]  0:\n            phi_i, sigma_i = potentials[i], charges[i]\n            phi_i1, sigma_i1 = potentials[i+1], charges[i+1]\n            # Linear interpolation formula (secant method)\n            pzc = phi_i - sigma_i * (phi_i1 - phi_i) / (sigma_i1 - sigma_i)\n            return pzc\n\n    # 3. No sign change: find minimum absolute charge and refine by interpolation\n    abs_charges = np.abs(charges)\n    k = np.argmin(abs_charges)\n    \n    phi_k, sigma_k = potentials[k], charges[k]\n\n    # Determine nearest neighbor for interpolation\n    if k == 0:\n        # Minimum is at the first point, neighbor is the second point\n        j = 1\n    elif k == len(potentials) - 1:\n        # Minimum is at the last point, neighbor is the second to last point\n        j = k - 1\n    else:\n        # Minimum is an interior point, choose neighbor with smaller absolute charge\n        if abs(charges[k-1])  abs(charges[k+1]):\n            j = k - 1\n        else:\n            j = k + 1\n            \n    phi_j, sigma_j = potentials[j], charges[j]\n\n    # Perform local linear interpolation if possible\n    if not np.isclose(sigma_j, sigma_k):\n        pzc = phi_k - sigma_k * (phi_j - phi_k) / (sigma_j - sigma_k)\n        return pzc\n    else:\n        # Denominator is zero, cannot interpolate, return potential of minimum charge\n        return phi_k\n\ndef find_theoretical_pzc(W, delta_phi_dip):\n    \"\"\"\n    Computes the theoretical PZC from work function and interfacial dipole potential.\n\n    Args:\n        W (float): Work function in eV.\n        delta_phi_dip (float): Interfacial dipole potential in Volts.\n\n    Returns:\n        float: The theoretical PZC in Volts.\n    \"\"\"\n    # From derivation: PZC [V] = {W}[eV] - delta_phi_dip [V]\n    # The numerical value of W in eV equals the potential value in V.\n    return W - delta_phi_dip\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        {\n            # Case 1: Monotonic linear σ(Φ) crossing\n            \"potentials\": np.array([-0.2, 0.0, 0.2, 0.4, 0.6]),\n            \"sigma_func\": lambda phi: 0.4 * (phi - 0.2),\n            \"W\": 5.1,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 2: Exact zero on grid\n            \"potentials\": np.array([-0.5, 0.0, 0.5]),\n            \"sigma_func\": lambda phi: 0.3 * (phi - 0.0),\n            \"W\": 4.9,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 3: Nonlinear cubic response\n            \"potentials\": np.array([-0.3, -0.1, 0.1, 0.3, 0.5]),\n            \"sigma_func\": lambda phi: 0.5 * (phi - 0.1) + 0.2 * (phi - 0.1)**3,\n            \"W\": 5.0,\n            \"delta_phi_dip\": 4.9,\n        },\n        {\n            # Case 4: Zero at the boundary\n            \"potentials\": np.array([0.0, 0.2, 0.4]),\n            \"sigma_func\": lambda phi: 0.1 * (phi - 0.0),\n            \"W\": 5.0,\n            \"delta_phi_dip\": 5.0,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        potentials = case[\"potentials\"]\n        sigma_func = case[\"sigma_func\"]\n        W = case[\"W\"]\n        delta_phi_dip = case[\"delta_phi_dip\"]\n\n        # Generate charge data from the potential array and function\n        charges = sigma_func(potentials)\n\n        # 1. Find numerical PZC\n        pzc_numerical = find_numerical_pzc(potentials, charges)\n\n        # 2. Compute theoretical PZC\n        pzc_theoretical = find_theoretical_pzc(W, delta_phi_dip)\n\n        # 3. Compute difference\n        difference = pzc_numerical - pzc_theoretical\n\n        results.extend([pzc_numerical, pzc_theoretical, difference])\n\n    # Format output to six decimal places as specified\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}