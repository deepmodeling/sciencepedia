{
    "hands_on_practices": [
        {
            "introduction": "To master Grand Canonical DFT, we must first build a solid foundation in its underlying statistical mechanics. This exercise takes us back to first principles by considering a simple, non-interacting electronic system with just two energy levels. By deriving the average electron number $\\langle N \\rangle$ directly from the grand partition function, you will develop a core intuition for how the electron chemical potential $\\mu$ and temperature $T$ govern the population of electronic states.",
            "id": "4247272",
            "problem": "In Grand Canonical Density Functional Theory (GC-DFT), the equilibrium electronic state at fixed chemical potential $\\mu$ and temperature $T$ is obtained by minimizing the grand potential functional, which corresponds microscopically to sampling the grand canonical ensemble where electrons can be exchanged with a reservoir. Consider a non-interacting Kohn–Sham system consisting of two sets of one-electron levels with energies $\\epsilon_{1}$ and $\\epsilon_{2}$, and orbital degeneracies $g_{1}$ and $g_{2}$, respectively. Electrons obey Fermi–Dirac statistics and each one-electron level can be either unoccupied or singly occupied.\n\nStarting from the grand canonical ensemble definition that the grand partition function is the trace over many-electron states of $\\exp\\!\\big(-\\beta(\\hat{H}-\\mu \\hat{N})\\big)$ with $\\beta = 1/(k_{B} T)$, and that the expected particle number is related to the grand potential via $\\langle N \\rangle = -\\partial \\Omega / \\partial \\mu$ with $\\Omega = -\\frac{1}{\\beta} \\ln \\Xi$, derive the closed-form expression for the average electron number $\\langle N \\rangle(\\mu, T)$ for this two-level non-interacting system in terms of $\\mu$, $T$, $\\epsilon_{1}$, $\\epsilon_{2}$, $g_{1}$, $g_{2}$, and the Boltzmann constant $k_{B}$. Express your final answer as a single analytic expression for $\\langle N \\rangle(\\mu, T)$. No rounding is required.",
            "solution": "The problem asks for the derivation of the average electron number $\\langle N \\rangle$ for a non-interacting system with two sets of degenerate one-electron energy levels, within the framework of the grand canonical ensemble. The derivation begins from the fundamental definitions of the grand partition function $\\Xi$, the grand potential $\\Omega$, and the average particle number $\\langle N \\rangle$.\n\nLet the system be at a fixed chemical potential $\\mu$ and temperature $T$. The inverse temperature is given by $\\beta = 1/(k_B T)$, where $k_B$ is the Boltzmann constant.\n\nThe system consists of non-interacting electrons, which obey Fermi-Dirac statistics. The problem states that each one-electron level can be either unoccupied or singly occupied. This is a direct consequence of the Pauli exclusion principle for fermions.\n\nFirst, we determine the grand partition function for a single, non-degenerate one-electron level with energy $\\epsilon$. A single level can be in one of two states:\n1.  Unoccupied: The number of particles is $N=0$ and the energy is $E=0$. The contribution to the partition function is $\\exp\\big(-\\beta(E - \\mu N)\\big) = \\exp\\big(-\\beta(0 - \\mu \\cdot 0)\\big) = 1$.\n2.  Occupied: The number of particles is $N=1$ and the energy is $E=\\epsilon$. The contribution to the partition function is $\\exp\\big(-\\beta(E - \\mu N)\\big) = \\exp\\big(-\\beta(\\epsilon - \\mu \\cdot 1)\\big) = \\exp\\big(-\\beta(\\epsilon - \\mu)\\big)$.\n\nThe grand partition function for this single level, which we denote as $\\xi$, is the sum of these contributions:\n$$\n\\xi = 1 + \\exp\\big(-\\beta(\\epsilon - \\mu)\\big)\n$$\n\nThe system described in the problem has two sets of energy levels. The first set has energy $\\epsilon_1$ and degeneracy $g_1$. This means there are $g_1$ distinct, independent one-electron orbitals all at the same energy $\\epsilon_1$. Since the orbitals are independent (a consequence of the non-interacting particle approximation), the grand partition function for this set of levels, $\\Xi_1$, is the product of the individual partition functions for each of the $g_1$ orbitals.\n$$\n\\Xi_1 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1}\n$$\nSimilarly, for the second set of levels with energy $\\epsilon_2$ and degeneracy $g_2$, the grand partition function is:\n$$\n\\Xi_2 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2}\n$$\n\nThe total grand partition function for the entire system, $\\Xi$, is the product of the partition functions for the two independent sets of levels:\n$$\n\\Xi = \\Xi_1 \\Xi_2 = \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1} \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2}\n$$\n\nNext, we calculate the grand potential $\\Omega$, which is related to the grand partition function by $\\Omega = -\\frac{1}{\\beta} \\ln \\Xi$:\n$$\n\\Omega = -\\frac{1}{\\beta} \\ln \\left[ \\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big)^{g_1} \\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big)^{g_2} \\right]\n$$\nUsing the properties of the logarithm, $\\ln(ab) = \\ln(a) + \\ln(b)$ and $\\ln(x^y) = y\\ln(x)$, we can simplify the expression for $\\Omega$:\n$$\n\\Omega = -\\frac{1}{\\beta} \\left[ g_1 \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big) + g_2 \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big) \\right]\n$$\n\nThe average number of electrons, $\\langle N \\rangle$, is obtained by taking the negative partial derivative of the grand potential with respect to the chemical potential $\\mu$, at constant temperature $T$ and volume (which implies constant energy levels $\\epsilon_j$).\n$$\n\\langle N \\rangle = -\\frac{\\partial \\Omega}{\\partial \\mu}\n$$\nWe can differentiate term by term:\n$$\n\\langle N \\rangle = -\\frac{\\partial}{\\partial \\mu} \\left( -\\frac{g_1}{\\beta} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_1 - \\mu)\\big)\\big) \\right) - \\frac{\\partial}{\\partial \\mu} \\left( -\\frac{g_2}{\\beta} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_2 - \\mu)\\big)\\big) \\right)\n$$\nLet's compute the derivative for a general term with energy $\\epsilon_j$ and degeneracy $g_j$:\n$$\n\\langle N_j \\rangle = \\frac{g_j}{\\beta} \\frac{\\partial}{\\partial \\mu} \\ln\\big(1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\\big)\n$$\nUsing the chain rule, where $u = 1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)$:\n$$\n\\frac{\\partial}{\\partial \\mu} \\ln(u) = \\frac{1}{u} \\frac{\\partial u}{\\partial \\mu}\n$$\nThe derivative of the argument of the logarithm with respect to $\\mu$ is:\n$$\n\\frac{\\partial}{\\partial \\mu} \\left( 1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\right) = \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\cdot \\frac{\\partial}{\\partial \\mu}\\big(-\\beta\\epsilon_j + \\beta\\mu\\big) = \\beta \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\n$$\nSubstituting this back into the expression for $\\langle N_j \\rangle$:\n$$\n\\langle N_j \\rangle = \\frac{g_j}{\\beta} \\left( \\frac{1}{1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)} \\right) \\left( \\beta \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\right)\n$$\nThe factors of $\\beta$ cancel out:\n$$\n\\langle N_j \\rangle = g_j \\frac{\\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)}{1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)}\n$$\nTo obtain the standard form of the Fermi-Dirac distribution, we multiply the numerator and the denominator by $\\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)$:\n$$\n\\langle N_j \\rangle = g_j \\frac{\\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big) \\cdot \\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)}{\\big(1 + \\exp\\big(-\\beta(\\epsilon_j - \\mu)\\big)\\big) \\cdot \\exp\\big(\\beta(\\epsilon_j - \\mu)\\big)} = g_j \\frac{1}{\\exp\\big(\\beta(\\epsilon_j - \\mu)\\big) + 1}\n$$\nThis is the well-known Fermi-Dirac distribution function for the average occupation number of a state with energy $\\epsilon_j$, multiplied by the degeneracy $g_j$.\n\nThe total average number of electrons $\\langle N \\rangle$ is the sum of the average occupations for the two sets of levels:\n$$\n\\langle N \\rangle = \\langle N_1 \\rangle + \\langle N_2 \\rangle = g_1 \\frac{1}{1 + \\exp\\big(\\beta(\\epsilon_1 - \\mu)\\big)} + g_2 \\frac{1}{1 + \\exp\\big(\\beta(\\epsilon_2 - \\mu)\\big)}\n$$\nFinally, substituting $\\beta = 1/(k_B T)$, we obtain the final closed-form expression for $\\langle N \\rangle(\\mu, T)$:\n$$\n\\langle N \\rangle(\\mu, T) = \\frac{g_1}{1 + \\exp\\left(\\frac{\\epsilon_1 - \\mu}{k_B T}\\right)} + \\frac{g_2}{1 + \\exp\\left(\\frac{\\epsilon_2 - \\mu}{k_B T}\\right)}\n$$\nThis expression represents the total average number of electrons in the system as the sum of the average occupancies of the two degenerate sets of energy levels, consistent with the principles of statistical mechanics for non-interacting fermions.",
            "answer": "$$\n\\boxed{\\frac{g_1}{1 + \\exp\\left(\\frac{\\epsilon_1 - \\mu}{k_B T}\\right)} + \\frac{g_2}{1 + \\exp\\left(\\frac{\\epsilon_2 - \\mu}{k_B T}\\right)}}\n$$"
        },
        {
            "introduction": "Real electrodes are not simple two-level systems; their electronic structure is described by a continuous Density of States (DOS). This practice bridges the gap between simple models and realistic materials by asking you to calculate the electron number for a metallic slab with a given DOS. This exercise not only extends the principles from the previous problem  to a continuum but also introduces crucial practical considerations for numerical calculations, such as energy cutoffs and integration grids.",
            "id": "4247261",
            "problem": "In Grand Canonical Density Functional Theory (GC-DFT), an electrode is modeled as an open electronic system in contact with a particle reservoir at chemical potential $\\mu$ and temperature $T$, which sets the average electron number through the grand canonical ensemble. The electron occupation follows the Fermi–Dirac distribution $f(\\epsilon,\\mu,T)$, and the electronic structure enters through the Density of States (DOS) $D(\\epsilon)$. Consider a metallic slab with quantum confinement along the surface normal that yields two in-plane parabolic subbands with minima at energies $\\epsilon_{1}=0$ and $\\epsilon_{2}=\\Delta$, respectively. Each subband is two-dimensional and has a constant per-area DOS $g$ for $\\epsilon$ above its minimum, arising from the parabolic dispersion with an effective mass. Neglect spin–orbit splitting and assume both subbands share the same $g$. Work within the continuum limit for the spectrum.\n\nStarting from the grand canonical formalism and first principles of statistical mechanics, derive the average electron number per unit area $N(\\mu,T)/A$ in terms of the model parameters $g$, $\\mu$, $\\Delta$, $k_{B}$, and $T$. Your derivation must begin from the definition of the grand potential and the Fermi–Dirac distribution, and proceed to an analytic evaluation consistent with a GC-DFT treatment. Assume the DOS is given by\n$$\nD(\\epsilon)=g\\left[\\Theta(\\epsilon-\\epsilon_{1})+\\Theta(\\epsilon-\\epsilon_{2})\\right],\n$$\nwhere $\\Theta(\\cdot)$ is the Heaviside step function and $\\epsilon_{1}=0$, $\\epsilon_{2}=\\Delta > 0$. Treat the continuum upper bound of energy as $+\\infty$ and assume the model DOS outside the subband thresholds is zero.\n\nProvide the final answer as a single closed-form analytic expression for $N(\\mu,T)/A$ in terms of $g$, $\\mu$, $\\Delta$, $k_{B}$, and $T$. Do not insert numerical values. Do not include units in the final answer. Separately in your solution, discuss numerical convergence of energy integrals used to evaluate $N(\\mu,T)/A$ in practice by:\n\n- Deriving an explicit upper bound for the absolute truncation error incurred when the energy integration is truncated at an upper cutoff $\\epsilon=E_{\\max}$.\n- Giving a formula that guarantees the absolute truncation error is below a prescribed tolerance $\\delta>0$.\n- Commenting on how the characteristic energy scale $k_{B}T$ informs the choice of energy grid spacing for quadrature to converge the integral.\n\nExpress any numerical bounds you derive symbolically. If physical units are required for any intermediate quantities, use Joules for energy and Kelvin for temperature; however, the final closed-form answer must be unitless as an expression.",
            "solution": "The problem requires the derivation of the average electron number per unit area, $N(\\mu,T)/A$, for a simplified model of a metallic electrode within the framework of Grand Canonical-Density Functional Theory (GC-DFT). The derivation will be followed by an analysis of the numerical convergence of the integral involved.\n\n**Part 1: Derivation of the Average Electron Number per Unit Area**\n\nIn the grand canonical ensemble, for a system of non-interacting fermions, the average number of particles $\\langle N \\rangle$ is given by the integral over all energy states of the product of the Density of States (DOS) $D_{\\text{total}}(\\epsilon)$ and the mean occupation number, which is the Fermi-Dirac distribution $f(\\epsilon, \\mu, T)$.\n$$\n\\langle N \\rangle = \\int_{-\\infty}^{\\infty} D_{\\text{total}}(\\epsilon) f(\\epsilon, \\mu, T) d\\epsilon\n$$\nThe problem provides the DOS per unit area, which we denote as $D(\\epsilon)$. Therefore, the quantity we will compute is the average number of electrons per unit area, $n_s = \\langle N \\rangle / A$.\n$$\nn_s = \\frac{N}{A} = \\int_{-\\infty}^{\\infty} D(\\epsilon) f(\\epsilon, \\mu, T) d\\epsilon\n$$\nThe Fermi-Dirac distribution is given by:\n$$\nf(\\epsilon, \\mu, T) = \\frac{1}{\\exp\\left(\\frac{\\epsilon - \\mu}{k_B T}\\right) + 1}\n$$\nwhere $\\mu$ is the electron chemical potential, $T$ is the temperature, and $k_B$ is the Boltzmann constant.\n\nThe model DOS per unit area is specified as:\n$$\nD(\\epsilon) = g \\left[ \\Theta(\\epsilon - \\epsilon_1) + \\Theta(\\epsilon - \\epsilon_2) \\right]\n$$\nwith $\\epsilon_1=0$ and $\\epsilon_2=\\Delta > 0$. $\\Theta(\\cdot)$ is the Heaviside step function. This DOS describes two subbands with a constant DOS $g$ starting at energies $0$ and $\\Delta$, respectively. Thus, for $\\epsilon \\ge \\Delta$, the total DOS is $2g$. The integral for $n_s$ is non-zero only for $\\epsilon \\ge 0$.\n$$\n\\frac{N}{A} = \\int_{0}^{\\infty} g \\left[ \\Theta(\\epsilon) + \\Theta(\\epsilon - \\Delta) \\right] f(\\epsilon, \\mu, T) d\\epsilon\n$$\nWe can split the integral based on the definition of the Heaviside functions. The term $\\Theta(\\epsilon)$ contributes for $\\epsilon \\ge 0$ and the term $\\Theta(\\epsilon - \\Delta)$ contributes for $\\epsilon \\ge \\Delta$.\n$$\n\\frac{N}{A} = g \\int_{0}^{\\infty} f(\\epsilon, \\mu, T) d\\epsilon + g \\int_{\\Delta}^{\\infty} f(\\epsilon, \\mu, T) d\\epsilon\n$$\nTo evaluate these integrals, we consider the general form:\n$$\nI(\\epsilon_{\\min}) = \\int_{\\epsilon_{\\min}}^{\\infty} \\frac{d\\epsilon}{\\exp\\left(\\frac{\\epsilon - \\mu}{k_B T}\\right) + 1}\n$$\nLet us perform a substitution with the dimensionless variable $x = (\\epsilon - \\mu)/(k_B T)$. This gives $d\\epsilon = k_B T dx$. The lower limit of integration becomes $x_{\\min} = (\\epsilon_{\\min} - \\mu)/(k_B T)$, and the upper limit remains $\\infty$.\n$$\nI(\\epsilon_{\\min}) = k_B T \\int_{(\\epsilon_{\\min} - \\mu)/(k_B T)}^{\\infty} \\frac{dx}{e^x + 1}\n$$\nThe indefinite integral of the denominator is found by writing $\\frac{1}{e^x+1} = \\frac{e^{-x}}{1+e^{-x}}$.\n$$\n\\int \\frac{dx}{e^x + 1} = \\int \\frac{e^{-x}}{1+e^{-x}} dx = -\\ln(1 + e^{-x}) + C\n$$\nEvaluating the definite integral from a lower limit $a$ to $\\infty$:\n$$\n\\int_{a}^{\\infty} \\frac{dx}{e^x + 1} = \\left[ -\\ln(1+e^{-x}) \\right]_a^\\infty = -\\ln(1+e^{-\\infty}) - (-\\ln(1+e^{-a})) = 0 + \\ln(1+e^{-a})\n$$\nApplying this result to our two integrals:\nFor the first integral, $\\epsilon_{\\min}=0$, so $a = (0 - \\mu)/(k_B T) = -\\mu/(k_B T)$.\n$$\n\\int_{0}^{\\infty} f(\\epsilon, \\mu, T) d\\epsilon = k_B T \\ln\\left(1 + \\exp\\left(-\\frac{-\\mu}{k_B T}\\right)\\right) = k_B T \\ln\\left(1 + \\exp\\left(\\frac{\\mu}{k_B T}\\right)\\right)\n$$\nFor the second integral, $\\epsilon_{\\min}=\\Delta$, so $a = (\\Delta - \\mu)/(k_B T)$.\n$$\n\\int_{\\Delta}^{\\infty} f(\\epsilon, \\mu, T) d\\epsilon = k_B T \\ln\\left(1 + \\exp\\left(-\\frac{\\Delta - \\mu}{k_B T}\\right)\\right) = k_B T \\ln\\left(1 + \\exp\\left(\\frac{\\mu - \\Delta}{k_B T}\\right)\\right)\n$$\nCombining these results gives the final expression for the electron number per unit area:\n$$\n\\frac{N}{A} = g \\left[ k_B T \\ln\\left(1 + \\exp\\left(\\frac{\\mu}{k_B T}\\right)\\right) + k_B T \\ln\\left(1 + \\exp\\left(\\frac{\\mu - \\Delta}{k_B T}\\right)\\right) \\right]\n$$\nThis simplifies to:\n$$\n\\frac{N}{A} = g k_B T \\left[ \\ln\\left(1 + \\exp\\left(\\frac{\\mu}{k_B T}\\right)\\right) + \\ln\\left(1 + \\exp\\left(\\frac{\\mu - \\Delta}{k_B T}\\right)\\right) \\right]\n$$\nThis derivation is consistent with starting from the grand potential $\\Omega = -k_B T \\int D(\\epsilon) \\ln(1 + \\exp((\\mu-\\epsilon)/k_B T)) d\\epsilon$ and using the thermodynamic relation $N = -(\\partial\\Omega/\\partial\\mu)_T$, which provides a rigorous justification for the initial formula used.\n\n**Part 2: Numerical Convergence Analysis**\n\nIn practice, the integral for $N/A$ is truncated at a finite upper energy cutoff $E_{\\max}$. We analyze the associated errors.\n\n**Upper bound for absolute truncation error**\nThe absolute truncation error, $E_{\\text{err}}$, is the value of the integral from $E_{\\max}$ to $\\infty$.\n$$\nE_{\\text{err}}(E_{\\max}) = \\int_{E_{\\max}}^{\\infty} D(\\epsilon) f(\\epsilon, \\mu, T) d\\epsilon\n$$\nAssuming the cutoff $E_{\\max}$ is chosen to be greater than the highest energy threshold, i.e., $E_{\\max} > \\Delta$, the DOS for $\\epsilon > E_{\\max}$ is $D(\\epsilon) = g[\\Theta(\\epsilon) + \\Theta(\\epsilon-\\Delta)] = g(1+1) = 2g$.\n$$\nE_{\\text{err}}(E_{\\max}) = \\int_{E_{\\max}}^{\\infty} 2g f(\\epsilon, \\mu, T) d\\epsilon = 2g \\int_{E_{\\max}}^{\\infty} \\frac{d\\epsilon}{\\exp\\left(\\frac{\\epsilon - \\mu}{k_B T}\\right) + 1}\n$$\nUsing the integral solved previously, with $\\epsilon_{\\min} = E_{\\max}$:\n$$\nE_{\\text{err}}(E_{\\max}) = 2g k_B T \\ln\\left(1 + \\exp\\left(\\frac{\\mu - E_{\\max}}{k_B T}\\right)\\right)\n$$\nThis is the exact expression for the error. To find a simpler upper bound, we use the inequality $\\ln(1+x) \\le x$ for $x \\ge 0$. Let $x = \\exp((\\mu - E_{\\max})/(k_B T))$. For typical calculations, $E_{\\max} \\gg \\mu$, so $x$ is small and positive.\n$$\nE_{\\text{err}}(E_{\\max}) \\le 2g k_B T \\exp\\left(\\frac{\\mu - E_{\\max}}{k_B T}\\right)\n$$\nThis provides an explicit upper bound for the absolute truncation error.\n\n**Formula for Cutoff Energy**\nTo guarantee that the absolute truncation error is below a prescribed tolerance $\\delta > 0$, we require $E_{\\text{err}}(E_{\\max}) \\le \\delta$. It is sufficient to enforce this condition on our derived upper bound:\n$$\n2g k_B T \\exp\\left(\\frac{\\mu - E_{\\max}}{k_B T}\\right) \\le \\delta\n$$\nSolving for $E_{\\max}$:\n$$\n\\exp\\left(\\frac{\\mu - E_{\\max}}{k_B T}\\right) \\le \\frac{\\delta}{2g k_B T}\n$$\nTaking the natural logarithm of both sides:\n$$\n\\frac{\\mu - E_{\\max}}{k_B T} \\le \\ln\\left(\\frac{\\delta}{2g k_B T}\\right)\n$$\n$$\nE_{\\max} \\ge \\mu - k_B T \\ln\\left(\\frac{\\delta}{2g k_B T}\\right) = \\mu + k_B T \\ln\\left(\\frac{2g k_B T}{\\delta}\\right)\n$$\nThus, selecting an energy cutoff satisfying the following condition guarantees the error is below $\\delta$:\n$$\nE_{\\max} \\ge \\mu + k_B T \\ln\\left(\\frac{2g k_B T}{\\delta}\\right)\n$$\n\n**Comment on Energy Grid Spacing for Quadrature**\nThe numerical evaluation of the integral for $N/A$ involves approximating the continuous integral with a discrete sum (quadrature). The choice of energy grid points and their spacing is critical for convergence. The integrand is $I(\\epsilon) = D(\\epsilon)f(\\epsilon, \\mu, T)$.\nThe key features of this integrand are:\n$1$. The DOS term $D(\\epsilon)$ introduces step discontinuities at $\\epsilon = 0$ and $\\epsilon = \\Delta$. To handle these correctly, it is standard practice to partition the integration domain at these points, i.e., compute $\\int_0^\\Delta + \\int_\\Delta^{E_{\\max}}$, as the integrand is smooth within each partition.\n$2$. The Fermi-Dirac function $f(\\epsilon, \\mu, T)$ exhibits a sharp change from $1$ to $0$ over an energy range of a few $k_B T$ centered at $\\epsilon = \\mu$. The function's rate of change is maximal at $\\epsilon=\\mu$, with a characteristic width proportional to $k_B T$.\n\nTo accurately capture this rapid variation, the energy grid spacing, $\\Delta\\epsilon_{\\text{grid}}$, must be significantly smaller than the energy scale over which the function varies. Therefore, the characteristic energy scale $k_B T$ dictates the necessary grid fineness. A uniform grid would require $\\Delta\\epsilon_{\\text{grid}} \\ll k_B T$ everywhere, especially in the vicinity of $\\epsilon = \\mu$, to achieve convergence. More efficient, adaptive quadrature schemes would automatically increase the density of grid points around $\\epsilon = \\mu$, where the integrand's derivative is large. In summary, for any numerical quadrature to converge, the grid resolution must be fine enough to resolve the thermal smearing of the Fermi edge, implying a grid spacing that is a small fraction of $k_B T$.",
            "answer": "$$\\boxed{g k_{B} T \\left[ \\ln\\left(1 + \\exp\\left(\\frac{\\mu}{k_{B} T}\\right)\\right) + \\ln\\left(1 + \\exp\\left(\\frac{\\mu - \\Delta}{k_{B} T}\\right)\\right) \\right]}$$"
        },
        {
            "introduction": "Having explored the statistical mechanics of electron counting, we now turn to the thermodynamic motivation for using the grand canonical ensemble in electrochemistry. This exercise explores the fundamental energetic difference between charging a capacitor at fixed charge versus fixed potential. By performing a Legendre transform, you will derive the appropriate thermodynamic potential for a constant-potential electrode and uncover a cornerstone result for the energy of an electrochemical interface.",
            "id": "4247253",
            "problem": "In Grand Canonical Density Functional Theory (GC-DFT), an electrode in an electrochemical environment exchanges electrons with a reservoir that fixes the electrode potential $\\Phi$, while the total charge $Q$ on the electrode adjusts self-consistently. Consider a model electrochemical interface whose differential response is characterized by a constant capacitance $C$, independent of $Q$ and $\\Phi$. The system is isothermal at temperature $T$, and mechanical work and non-electrostatic contributions are negligible. Starting from the reversible work needed to charge the interface, derive the Helmholtz free energy change $A(Q)$ for charging from $Q=0$ to a finite $Q$. Then, using only fundamental thermodynamic principles governing conjugate variables and appropriate Legendre transforms, formulate the thermodynamic potential suitable for fixed $\\Phi$ and obtain its equilibrium value by minimizing over $Q$. Finally, compute the free-energy change at fixed $\\Phi$ relative to the uncharged state. Express your final answer as a single closed-form analytic expression in terms of $C$ and $\\Phi$.",
            "solution": "The solution is derived by following the logical steps requested in the problem.\n\n**1. Derivation of the Helmholtz Free Energy, $A(Q)$**\n\nThe reversible electrical work, $dW_{\\text{elec}}$, required to add an infinitesimal amount of charge $dq$ to an electrode at a potential $\\phi(q)$ is given by:\n$$dW_{\\text{elec}} = \\phi(q) dq$$\nUnder conditions of constant temperature $T$ and constant volume (or negligible mechanical work, as specified), this reversible work is equal to the change in the Helmholtz free energy, $dA$.\n$$dA = dW_{\\text{elec}} = \\phi(q) dq$$\nThe problem states that the interface is characterized by a constant capacitance $C$. The relationship between charge $q$ on a capacitor, its potential $\\phi(q)$, and its capacitance $C$ is:\n$$\\phi(q) = \\frac{q}{C}$$\nTo find the total change in Helmholtz free energy, $\\Delta A$, when charging the electrode from an initial state of zero charge ($Q=0$) to a final state with charge $Q$, we must integrate $dA$ from $q=0$ to $q=Q$:\n$$\\Delta A = A(Q) - A(0) = \\int_0^Q \\phi(q) dq$$\nSubstituting the expression for $\\phi(q)$:\n$$\\Delta A = \\int_0^Q \\frac{q}{C} dq$$\nSince $C$ is a constant, it can be taken out of the integral:\n$$\\Delta A = \\frac{1}{C} \\int_0^Q q dq = \\frac{1}{C} \\left[ \\frac{q^2}{2} \\right]_0^Q = \\frac{1}{C} \\left( \\frac{Q^2}{2} - 0 \\right) = \\frac{Q^2}{2C}$$\nBy setting the Helmholtz free energy of the uncharged state as the reference, $A(0)=0$, the Helmholtz free energy as a function of charge is:\n$$A(Q) = \\frac{Q^2}{2C}$$\n\n**2. Formulation of the Thermodynamic Potential for Fixed Potential, $\\Phi$**\n\nThe Helmholtz free energy $A(Q)$ is the natural potential for a system where the charge $Q$ is a fixed state variable. The problem requires us to consider a system where the potential $\\Phi$ is fixed by a reservoir, and the charge $Q$ is the fluctuating variable that reaches an equilibrium value. This change of independent variable from $Q$ to its conjugate variable $\\Phi$ is accomplished via a Legendre transform.\n\nThe differential of the Helmholtz free energy is $dA = -SdT + \\dots + \\Phi dQ$, where the potential $\\Phi$ is the conjugate variable to the charge $Q$. For our isothermal system with negligible mechanical work, this simplifies to $dA = \\Phi dQ$.\n\nThe appropriate thermodynamic potential for fixed $\\Phi$, known as the grand potential (in the context of electrochemistry), is defined as:\n$$\\Omega = A - \\Phi Q$$\nThis new potential, $\\Omega$, will be a function of $\\Phi$ at equilibrium.\n\n**3. Minimization and Equilibrium Value of the Grand Potential**\n\nTo find the equilibrium state of the system at a fixed external potential $\\Phi$, we must find the value of charge, $Q_{eq}$, that minimizes the grand potential $\\Omega$. We treat $\\Omega$ as a function of the fluctuating variable $Q$ for a given reservoir potential $\\Phi$:\n$$\\Omega(Q; \\Phi) = A(Q) - \\Phi Q = \\frac{Q^2}{2C} - \\Phi Q$$\nThe equilibrium condition is found by setting the derivative of $\\Omega$ with respect to $Q$ to zero:\n$$\\frac{\\partial \\Omega}{\\partial Q} = \\frac{\\partial}{\\partial Q} \\left( \\frac{Q^2}{2C} - \\Phi Q \\right) = \\frac{2Q}{2C} - \\Phi = \\frac{Q}{C} - \\Phi$$\nSetting this derivative to zero gives the equilibrium charge $Q_{eq}$:\n$$\\frac{Q_{eq}}{C} - \\Phi = 0 \\implies Q_{eq} = C\\Phi$$\nTo confirm this is a minimum, we check the second derivative:\n$$\\frac{\\partial^2 \\Omega}{\\partial Q^2} = \\frac{1}{C}$$\nSince capacitance $C$ must be a positive quantity for a stable system, the second derivative is positive, confirming that $Q_{eq} = C\\Phi$ corresponds to a minimum of the grand potential.\n\nNow, we substitute the equilibrium charge $Q_{eq}$ back into the expression for $\\Omega$ to find its equilibrium value, $\\Omega_{eq}(\\Phi)$:\n$$\\Omega_{eq}(\\Phi) = \\frac{(Q_{eq})^2}{2C} - \\Phi Q_{eq} = \\frac{(C\\Phi)^2}{2C} - \\Phi(C\\Phi)$$\n$$\\Omega_{eq}(\\Phi) = \\frac{C^2\\Phi^2}{2C} - C\\Phi^2 = \\frac{1}{2}C\\Phi^2 - C\\Phi^2 = -\\frac{1}{2}C\\Phi^2$$\n\n**4. Free-Energy Change Relative to the Uncharged State**\n\nThe final step is to compute the free-energy change at a fixed potential $\\Phi$ relative to the uncharged state. The grand potential $\\Omega_{eq}(\\Phi)$ represents the free energy of the system at equilibrium with a reservoir of potential $\\Phi$. The \"uncharged state\" corresponds to a reservoir potential of $\\Phi=0$.\n\nThe free-energy change, $\\Delta\\Omega$, is the difference between the grand potential at potential $\\Phi$ and the grand potential at potential $\\Phi=0$:\n$$\\Delta\\Omega = \\Omega_{eq}(\\Phi) - \\Omega_{eq}(0)$$\nWe have the expression for the equilibrium grand potential:\n$$\\Omega_{eq}(\\Phi) = -\\frac{1}{2}C\\Phi^2$$\nFor the uncharged state, we set $\\Phi=0$:\n$$\\Omega_{eq}(0) = -\\frac{1}{2}C(0)^2 = 0$$\nTherefore, the free-energy change is:\n$$\\Delta\\Omega = -\\frac{1}{2}C\\Phi^2 - 0 = -\\frac{1}{2}C\\Phi^2$$\nThis is the final required expression. It represents the energy stored in the electrochemical double layer at potential $\\Phi$, as perceived from the grand canonical ensemble.",
            "answer": "$$\\boxed{-\\frac{C\\Phi^2}{2}}$$"
        }
    ]
}