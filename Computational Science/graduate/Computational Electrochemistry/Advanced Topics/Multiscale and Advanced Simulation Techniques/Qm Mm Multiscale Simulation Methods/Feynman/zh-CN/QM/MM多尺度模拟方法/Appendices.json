{
    "hands_on_practices": [
        {
            "introduction": "QM/MM模拟的核心在于如何将高精度量子化学计算与高效的分子力学计算结合起来。本练习将引导您实践两种最基本的能量组合方案：加和方案与减法方案（如ONIOM方法）()。通过对一个简化的模型体系进行具体计算，您将清晰地理解不同能量项如何构成总能量，并验证这两种方案在逻辑上的一致性，这是解读任何QM/MM计算结果的基础。",
            "id": "4255659",
            "problem": "考虑一个应用于简单电化学玩具系统的机械嵌入式量子力学/分子力学 (QM/MM) 划分，该系统代表一个与小电解质簇相邻的双原子氧化还原中心。量子力学/分子力学 (QM/MM) 划分将系统分为一个包含两个原子 $\\mathrm{A}_1$ 和 $\\mathrm{A}_2$（氧化还原中心）的量子区域，以及一个包含三个原子 $\\mathrm{B}_1$、$\\mathrm{B}_2$ 和 $\\mathrm{B}_3$（电解质物种）的分子力学区域。在 Born–Oppenheimer 近似下，总势能可以分解为量子和经典子系统的区域内贡献以及区域间非键相互作用。在机械嵌入中，量子计算不直接感受经典静电作用；区域间的耦合通过范德华相互作用等非键项在分子力学层面上表示。从这个分解出发，推导与机械嵌入一致的加和方案与减去方案的表达式，使用以下数据通过每种方案计算总能量，并协调这两个总值。\n\n您已获得来自独立计算或表格的以下能量学数据：\n- $\\mathrm{A}_1\\text{–}\\mathrm{A}_2$ 二聚体的量子区域内能量：$E_{\\mathrm{QM}} = -128.750$ $\\mathrm{kJ\\,mol^{-1}}$。\n- 分子力学区域（三原子簇）的经典区域内能量：$E_{\\mathrm{MM}}^{\\mathrm{MM\\text{-}only}} = 9.320$ $\\mathrm{kJ\\,mol^{-1}}$。\n- 当量子区域由分子力学力场表示时（模型系统）的经典区域内能量：$E_{\\mathrm{MM}}^{\\mathrm{QM\\text{-}only}} = 3.480$ $\\mathrm{kJ\\,mol^{-1}}$。\n- 量子和经典原子之间的成对范德华相互作用能（例如，Lennard–Jones 型）：\n  $\\mathrm{A}_1\\text{–}\\mathrm{B}_1$：$-0.650$ $\\mathrm{kJ\\,mol^{-1}}$，\n  $\\mathrm{A}_1\\text{–}\\mathrm{B}_2$：$-0.420$ $\\mathrm{kJ\\,mol^{-1}}$，\n  $\\mathrm{A}_1\\text{–}\\mathrm{B}_3$：$0.120$ $\\mathrm{kJ\\,mol^{-1}}$，\n  $\\mathrm{A}_2\\text{–}\\mathrm{B}_1$：$-0.780$ $\\mathrm{kJ\\,mol^{-1}}$，\n  $\\mathrm{A}_2\\text{–}\\mathrm{B}_2$：$-0.310$ $\\mathrm{kJ\\,mol^{-1}}$，\n  $\\mathrm{A}_2\\text{–}\\mathrm{B}_3$：$0.090$ $\\mathrm{kJ\\,mol^{-1}}$。\n\n使用势能的第一性原理划分为区域内量子、区域内经典和区域间非键相互作用，计算：\n1. 与机械嵌入一致的加和方案下的总能量。\n2. 与我们自己N层积分分子轨道和分子力学 (ONIOM) 方案一致的减去方案下的总能量。\n\n提供总能量的协调单一值（如果划分一致，两种方案应吻合）。将您的最终结果四舍五入到四位有效数字，并以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示能量。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统划分**：系统被划分为一个量子力学 (QM) 区域和一个分子力学 (MM) 区域。\n  - QM 区域：原子 $\\mathrm{A}_1$, $\\mathrm{A}_2$。\n  - MM 区域：原子 $\\mathrm{B}_1$, $\\mathrm{B}_2$, $\\mathrm{B}_3$。\n- **嵌入方案**：指定了机械嵌入，其中 QM 区域的电子结构是孤立计算的，其与 MM 区域的相互作用由经典 (MM) 势描述。\n- **能量分量 ($\\mathrm{kJ\\,mol^{-1}}$)**：\n  - QM 区域的量子能量：$E_{\\mathrm{QM}} = -128.750$。\n  - MM 区域的 MM 能量：$E_{\\mathrm{MM}}^{\\mathrm{MM\\text{-}only}} = 9.320$。\n  - QM 区域的 MM 能量（作为模型系统）：$E_{\\mathrm{MM}}^{\\mathrm{QM\\text{-}only}} = 3.480$。\n  - 成对 QM-MM 范德华相互作用能：\n    - $E_{\\mathrm{A}_1\\text{–}\\mathrm{B}_1} = -0.650$\n    - $E_{\\mathrm{A}_1\\text{–}\\mathrm{B}_2} = -0.420$\n    - $E_{\\mathrm{A}_1\\text{–}\\mathrm{B}_3} = 0.120$\n    - $E_{\\mathrm{A}_2\\text{–}\\mathrm{B}_1} = -0.780$\n    - $E_{\\mathrm{A}_2\\text{–}\\mathrm{B}_2} = -0.310$\n    - $E_{\\mathrm{A}_2\\text{–}\\mathrm{B}_3} = 0.090$\n- **任务**：\n  1. 推导加和与减去 QM/MM 方案的表达式。\n  2. 使用两种方案计算总能量。\n  3. 协调结果并提供一个四舍五入到四位有效数字的单一值。\n\n### 步骤2：使用提取的已知条件进行验证\n根据预定义标准评估问题。\n\n- **科学依据**：该问题基于成熟的量子力学/分子力学 (QM/MM) 理论，特别是机械嵌入和 ONIOM (我们自己N层积分分子轨道和分子力学) 减去方案。这些是计算化学中的标准方法。能量分解是该领域的一个基本概念。\n- **问题明确**：提供了使用指定方案计算总能量所需的所有数值数据和概念定义。问题是自洽的，并允许唯一解。\n- **客观性**：问题以精确、技术性的语言陈述，不含主观或基于意见的内容。\n\n### 步骤3：结论与行动\n问题有效。这是一个应用 QM/MM 理论基本能量表达式的明确定义的练习。将提供解答。\n\n---\n\n在机械嵌入方案下，一个划分为 QM 区域和 MM 区域的系统的总能量 $E_{\\text{total}}$ 可以用两种常见的方式表示：加和方案和减去方案。我们将推导两者并证明其等价性。\n\n令 QM 区域表示为 $Q$，MM 区域表示为 $M$。整个系统为 $Q+M$。\n\n**区域间相互作用能**\n\n首先，我们计算总的区域间相互作用能，在这个机械嵌入模型中，它由 QM 区域中的原子与 MM 区域中的原子之间的范德华 (vdW) 相互作用之和给出。\n$$E_{\\text{inter}} = E_{\\mathrm{MM}(Q\\text{-}M)}$$\n问题提供了成对的 vdW 贡献。将它们相加得到：\n$$E_{\\text{inter}} = E_{\\mathrm{A}_1\\text{–}\\mathrm{B}_1} + E_{\\mathrm{A}_1\\text{–}\\mathrm{B}_2} + E_{\\mathrm{A}_1\\text{–}\\mathrm{B}_3} + E_{\\mathrm{A}_2\\text{–}\\mathrm{B}_1} + E_{\\mathrm{A}_2\\text{–}\\mathrm{B}_2} + E_{\\mathrm{A}_2\\text{–}\\mathrm{B}_3}$$\n$$E_{\\text{inter}} = (-0.650) + (-0.420) + (0.120) + (-0.780) + (-0.310) + (0.090) \\, \\mathrm{kJ\\,mol^{-1}}$$\n$$E_{\\text{inter}} = -1.950 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n**1. 加和方案**\n\n加和方案通过将各个部分及其相互作用的能量相加来计算总能量。对于机械嵌入，分解如下：\n$$E_{\\text{additive}} = E_{\\mathrm{QM}(Q)} + E_{\\mathrm{MM}(M)} + E_{\\mathrm{MM}(Q\\text{-}M)}$$\n这里：\n- $E_{\\mathrm{QM}(Q)}$ 是用量子力学计算的孤立 QM 区域的能量。给定值为 $E_{\\mathrm{QM}} = -128.750 \\, \\mathrm{kJ\\,mol^{-1}}$。\n- $E_{\\mathrm{MM}(M)}$ 是用分子力学计算的 MM 区域的内能。给定值为 $E_{\\mathrm{MM}}^{\\mathrm{MM\\text{-}only}} = 9.320 \\, \\mathrm{kJ\\,mol^{-1}}$。\n- $E_{\\mathrm{MM}(Q\\text{-}M)}$ 是用分子力学计算的 QM 和 MM 区域之间的相互作用能。我们计算出此值为 $E_{\\text{inter}} = -1.950 \\, \\mathrm{kJ\\,mol^{-1}}$。\n\n将这些值代入加和方案公式：\n$$E_{\\text{additive}} = -128.750 \\, \\mathrm{kJ\\,mol^{-1}} + 9.320 \\, \\mathrm{kJ\\,mol^{-1}} + (-1.950) \\, \\mathrm{kJ\\,mol^{-1}}$$\n$$E_{\\text{additive}} = -121.380 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n**2. 减去方案 (ONIOM)**\n\n减去方案，以双层 ONIOM 方法为例，利用容斥原理计算总能量以避免重复计算。通用公式为：\n$$E_{\\text{ONIOM}} = E_{\\text{low}}(\\text{real}) - E_{\\text{low}}(\\text{model}) + E_{\\text{high}}(\\text{model})$$\n在我们的情境中：\n- “真实”系统是整个系统 $Q+M$。\n- “模型”系统是 QM 区域 $Q$。\n- “高”层理论是 QM。\n- “低”层理论是 MM。\n\n公式变为：\n$$E_{\\text{subtractive}} = E_{\\mathrm{MM}(Q+M)} - E_{\\mathrm{MM}(Q)} + E_{\\mathrm{QM}(Q)}$$\n让我们从已知条件中确定每一项：\n- $E_{\\mathrm{QM}(Q)}$ 是模型系统 $Q$ 在高 (QM) 层的能量，给定值为 $E_{\\mathrm{QM}} = -128.750 \\, \\mathrm{kJ\\,mol^{-1}}$。\n- $E_{\\mathrm{MM}(Q)}$ 是模型系统 $Q$ 在低 (MM) 层的能量。这作为 QM 区域的经典能量提供，即 $E_{\\mathrm{MM}}^{\\mathrm{QM\\text{-}only}} = 3.480 \\, \\mathrm{kJ\\,mol^{-1}}$。\n- $E_{\\mathrm{MM}(Q+M)}$ 是真实系统 $Q+M$ 在低 (MM) 层的能量。此项代表整个系统的能量，如同它完全由 MM 力场描述一样。它可以分解为区域内和区域间的贡献：\n  $$E_{\\mathrm{MM}(Q+M)} = E_{\\mathrm{MM}(Q)} + E_{\\mathrm{MM}(M)} + E_{\\mathrm{MM}(Q\\text{-}M)}$$\n  使用提供的变量名：\n  $$E_{\\mathrm{MM}(Q+M)} = E_{\\mathrm{MM}}^{\\mathrm{QM\\text{-}only}} + E_{\\mathrm{MM}}^{\\mathrm{MM\\text{-}only}} + E_{\\text{inter}}$$\n  $$E_{\\mathrm{MM}(Q+M)} = 3.480 \\, \\mathrm{kJ\\,mol^{-1}} + 9.320 \\, \\mathrm{kJ\\,mol^{-1}} + (-1.950) \\, \\mathrm{kJ\\,mol^{-1}} = 10.850 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n现在，我们将这些分量代入减去方案公式：\n$$E_{\\text{subtractive}} = (10.850) \\, \\mathrm{kJ\\,mol^{-1}} - (3.480) \\, \\mathrm{kJ\\,mol^{-1}} + (-128.750) \\, \\mathrm{kJ\\,mol^{-1}}$$\n$$E_{\\text{subtractive}} = 7.370 \\, \\mathrm{kJ\\,mol^{-1}} - 128.750 \\, \\mathrm{kJ\\,mol^{-1}}$$\n$$E_{\\text{subtractive}} = -121.380 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n**协调**\n\n对于一致的划分，加和方案和减去方案必须得出相同的结果。让我们用代数方法证明这一点。\n从减去方案的表达式开始：\n$$E_{\\text{subtractive}} = E_{\\mathrm{MM}(Q+M)} - E_{\\mathrm{MM}(Q)} + E_{\\mathrm{QM}(Q)}$$\n代入 $E_{\\mathrm{MM}(Q+M)}$ 的分解式：\n$$E_{\\text{subtractive}} = (E_{\\mathrm{MM}(Q)} + E_{\\mathrm{MM}(M)} + E_{\\mathrm{MM}(Q\\text{-}M)}) - E_{\\mathrm{MM}(Q)} + E_{\\mathrm{QM}(Q)}$$\n$E_{\\mathrm{MM}(Q)}$ 项被消去：\n$$E_{\\text{subtractive}} = E_{\\mathrm{MM}(M)} + E_{\\mathrm{MM}(Q\\text{-}M)} + E_{\\mathrm{QM}(Q)}$$\n这正是加和方案 $E_{\\text{additive}}$ 的表达式。\n$$E_{\\text{additive}} = E_{\\mathrm{QM}(Q)} + E_{\\mathrm{MM}(M)} + E_{\\mathrm{MM}(Q\\text{-}M)}$$\n因此，两种方案在代数上是等价的。两种计算都得出总能量为 $E_{\\text{total}} = -121.380 \\, \\mathrm{kJ\\,mol^{-1}}$。\n\n问题要求将最终结果四舍五入到四位有效数字。\n$$E_{\\text{total}} = -121.380 \\approx -121.4 \\, \\mathrm{kJ\\,mol^{-1}}$$\n协调后的总能量单一值为 $-121.4 \\, \\mathrm{kJ\\,mol^{-1}}$。",
            "answer": "$$\\boxed{-121.4}$$"
        },
        {
            "introduction": "在QM/MM模拟中，最关键的设计决策莫过于如何划分量子力学（QM）区域和分子力学（MM）区域。这一划分并非随意而为，而是必须根据所研究的物理化学过程来精确确定。本练习 () 提供了一个复杂的电化学界面场景，要求您像一名计算化学家一样思考，以确定一个能够准确捕捉成键/断键、电荷转移和金属屏蔽等关键量子效应的最小QM区域，从而锻炼您构建物理意义清晰的模拟模型的能力。",
            "id": "4255704",
            "problem": "一个溶剂化的氧化还原活性分子被置于金表面附近。环境为水性电解质，温度 $T = 298 \\ \\text{K}$，离子强度 $I = 1 \\ \\text{M}$。该分子的最低未占分子轨道的排列方式使得，当电极处于接近该分子形式氧化还原电位的电势时，可以发生从金属到分子的绝热电子转移。分子与金属之间的平均质心距离为 $d \\approx 5 \\ \\text{Å}$。一个水分子在分子与一个配位不饱和的表面位点之间形成氢键桥，一个单价抗衡离子占据了内亥姆霍兹层，距离氧化还原分子的带电部分在 $r \\approx 4 \\ \\text{Å}$ 以内。反应通道涉及分子内的一个不稳定键，该键在还原时可能断裂，并可能与附近水分子的质子转移相耦合。你将构建一个量子力学/分子力学 (QM/MM) 划分方案来研究界面反应性。\n\n根据第一性原理，回顾以下几点：\n- 量子力学/分子力学 (QM/MM) 划分应在量子力学区域中包含任何需要用显式电子密度来描述电子重组、键形成或键断裂、或直接电荷转移的原子。其余部分如果其作用主要是结构性或介电性的，则可以用分子力学来描述。\n- 分子和金属之间的电子转移要求供体和受体的电子态都在同一个量子力学描述中处理，以正确捕捉费米能级 $\\,\\epsilon_{\\mathrm{F}}$ 处的占据数变化和界面电子耦合。\n- 金属屏蔽和镜像电荷效应源于金属中传导电子的非局域、集体响应，并由泊松方程 $\\nabla \\cdot \\left( \\epsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r}) \\right) = - \\rho(\\mathbf{r})$ 所描述的静电学以及在金属表面的适当边界条件所支配。在连续介质极限下，距离完美导体为 $z$ 的点电荷会在 $-z$ 处感应出一个镜像电荷，但在原子模拟中，需要几个表面层才能实现金属响应。\n- 溶剂重组和短程特定相互作用（氢键和离子对）对重组能和反应路径有重要贡献；这些相互作用局域在第一溶剂化层的尺度上，而电解质中的静电屏蔽发生在德拜长度尺度 $\\lambda_{\\mathrm{D}}$ 上，对于在 $T = 298 \\ \\text{K}$ 的水中 $I \\approx 1 \\ \\text{M}$ 的情况，其数量级为 $\\lambda_{\\mathrm{D}} \\sim 3 \\ \\text{Å}$。\n\n哪个选项指定了最具物理动机的最小量子力学区域，该区域足以捕捉氧化还原分子中的键断裂、界面电荷转移和金属镜像电荷效应，同时将其余部分留给分子力学处理？\n\nA. 仅将氧化还原分子的反应子结构（形成不稳定键的原子）包含在量子力学区域中；分子的其余部分、所有溶剂、离子以及整个金属表面用分子力学中的固定点电荷处理。\n\nB. 将整个氧化还原分子包含在量子力学区域中；将其第一溶剂化层中直接与反应位点形成氢键的所有溶剂分子以及任何桥接分子与金属的水分子包含在内；将内亥姆霍兹层中形成接触离子对或以其他方式直接与分子配位的任何抗衡离子包含在内；并将金表面的顶部 $3$ 个金属层作为周期性平板包含在量子力学区域中，以表示金属屏蔽并允许电荷转移。将其余的体相溶剂、更远的离子和更深层的金属作为分子力学处理，并采用适当的静电嵌入方案。\n\nC. 将氧化还原分子及其第一溶剂化层包含在量子力学区域中；用经典的、可极化的德鲁德模型和固定的边界电位来表示金属；所有离子和其余溶剂用分子力学处理。\n\nD. 将整个金属平板包含在量子力学区域中以捕捉镜像电荷和电荷转移；为降低计算成本，将氧化还原分子、溶剂和离子完全用分子力学处理。\n\nE. 将氧化还原分子和顶部 $1$ 个金属层包含在量子力学区域中；所有溶剂和离子用分子力学处理，并通过在 QM/MM 边界处的固定电荷来约束金属电位。",
            "solution": "用户希望我扮演一位严谨的STEM教授，首先验证问题陈述，如果有效，则通过第一性原理推导出答案并评估每个选项来解决问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题陈述提供了以下信息和原则：\n\n- **系统：** 一个靠近金表面的溶剂化氧化还原活性分子。\n- **环境：** 水性电解质，温度 $T = 298 \\ \\text{K}$，离子强度 $I = 1 \\ \\text{M}$。\n- **几何与相互作用：**\n    - 平均分子-金属距离：$d \\approx 5 \\ \\text{Å}$。\n    - 一个水分子在分子和金属表面之间形成氢键桥。\n    - 一个单价抗衡离子位于内亥姆霍兹层，距离分子的带电部分在 $r \\approx 4 \\ \\text{Å}$ 以内。\n- **反应过程：**\n    - 可能发生从金属到分子的最低未占分子轨道 (LUMO) 的绝热电子转移。\n    - 分子内的一个不稳定键在还原时可能断裂。\n    - 该反应可能与附近水分子的质子转移相耦合。\n- **任务：** 构建一个量子力学/分子力学 (QM/MM) 划分方案来研究界面反应性。目标是确定最具物理动机的、足以捕捉所有指定现象的最小 QM 区域。\n- **提供的第一性原理：**\n    1.  QM 区域必须包含经历电子重组、键形成/断裂或直接电荷转移的原子。其余部分如果其作用主要是结构性或介电性的，则可以是 MM。\n    2.  分子和金属之间的电子转移要求两者都在同一个 QM 描述中，以捕捉费米能级 $\\epsilon_{\\mathrm{F}}$ 处的占据数变化和界面耦合。\n    3.  金属屏蔽和镜像电荷效应需要对金属的几个表面层进行原子级建模，以再现其集体电子响应，这在连续介质极限下由泊松方程 $\\nabla \\cdot \\left( \\epsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r}) \\right) = - \\rho(\\mathbf{r})$ 支配。\n    4.  短程特定相互作用（氢键、离子对）和溶剂重组非常重要。电解质中的静电屏蔽发生在德拜长度尺度上，对于 $I \\approx 1 \\ \\text{M}$ 和 $T = 298 \\ \\text{K}$ 的情况，$\\lambda_{\\mathrm{D}} \\sim 3 \\ \\text{Å}$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题描述了计算电化学中的一个典型场景。所列出的现象（电子转移、键断裂、溶剂化、镜像电荷）是该领域的核心。所提供的“第一性原理”是正确的，反映了此类界面 QM/MM 模拟的标准最佳实践。德拜长度 $\\lambda_{\\mathrm{D}} \\sim 3 \\ \\text{Å}$ 在 $I = 1 \\ \\text{M}$ 时的值在物理上是准确的。整个设置在科学上是合理的。\n- **定义明确：** 问题要求找到能够捕捉一系列特定物理效应的“最具物理动机的最小量子力学区域”。这是一个计算化学中定义明确的概念性问题，根据所提供的原则有明确的答案。\n- **客观性：** 语言技术性强且精确。对充分的 QM 区域的标准有明确的陈述（捕捉键断裂、电荷转移和镜像效应）。没有歧义或主观性。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。它在科学上是合理的、定义明确且客观的，提供了得出合理结论所需的所有必要信息和原则。我将继续进行求解。\n\n### 正确 QM/MM 划分的推导\n\n问题要求 QM/MM 划分足以模拟三个关键现象：\n1.  **氧化还原分子中的键断裂：** 键的断裂和形成是根本的电子过程，涉及电子密度的重组和共价键的断裂。根据提供的第一条原则，发生这种情况的任何区域都必须用量子力学 (QM) 处理。问题指出“分子内的一个不稳定键”在还原时可能断裂。这要求至少涉及该键的原子必须在 QM 区域中。然而，还原过程涉及向整个分子的 LUMO 添加一个电子，这将引起整个分子的电子重组。为避免在共轭或电子耦合体系内设置 QM/MM 边界所带来的伪影，最稳健和标准的方法是将整个氧化还原分子包含在 QM 区域中。\n\n2.  **界面电荷转移：** 该过程涉及电子从金属移动到分子。第二条原则对此有明确说明：“分子和金属之间的电子转移要求供体和受体的电子态都在同一个量子力学描述中处理”。因此，氧化还原分子（受体）和金属（供体）都必须是同一个 QM 区域的一部分。这允许电子波函数在界面上离域，从而能够计算电子耦合，并使金属电子态（相对于费米能级 $\\epsilon_{\\mathrm{F}}$）和分子轨道的占据数能够自洽地改变。金属的经典 (MM) 表示，例如使用固定电荷甚至像德鲁德振子模型那样的可极化模型，都缺乏电荷转移所需的显式电子结构（即能带和费米能级）。\n\n3.  **金属镜像电荷效应：** 导体附近的电荷会引起导体中移动电荷的极化，从而产生一个等效于“镜像电荷”的电场。这是稳定带电物质在金属表面附近的一个关键静电相互作用。第三条原则指出，这是一种“传导电子的非局域、集体响应”，并且“在原子模拟中，需要几个表面层才能实现金属响应”。仅对单个金属层进行 QM 描述通常不足以正确再现块体金属表面的屏蔽性质和功函数，因此无法准确捕捉镜像电荷效应。由多层（通常为 $3$ 到 $5$ 层）组成的 QM 平板模型是在原子尺度上捕捉此效应的标准方法。\n\n结合这三个要求，最小 QM 区域必须包含：\n- 整个氧化还原活性分子。\n- 金表面的多层平板。\n\n此外，问题还强调了特定短程相互作用的重要性：\n- 形成“氢键桥”的水分子。这样的桥可以是电子转移的主要路径，并可能具有显著的共价特性，因此值得将其包含在 QM 区域中。\n- 可能与“附近水分子发生质子转移”。任何直接参与键断裂/形成（包括质子转移）的分子都必须在 QM 区域中。\n- 与分子形成紧密接触对的“单价抗衡离子”。该离子与氧化还原分子变化的电荷密度之间存在强的、局域化的静电相互作用，最好通过将该离子包含在 QM 区域中来描述，从而使其影响能够被 QM 电子结构自洽地感受到。\n\n因此，最具物理动机的最小 QM 区域应包括整个氧化还原分子、一个多层金属平板，以及任何直接参与反应机理或与反应中心有强烈的、特定的短程相互作用的溶剂分子或离子。其余的体相溶剂和电解质，其影响主要是长程和介电性的，可以用分子力学 (MM) 处理，通常使用静电嵌入方案，其中 MM 部分电荷被包含在 QM 哈密顿量中。\n\n### 评估选项\n\n**A. 仅将氧化还原分子的反应子结构（形成不稳定键的原子）包含在量子力学区域中；分子的其余部分、所有溶剂、离子以及整个金属表面用分子力学中的固定点电荷处理。**\n- **评论：** 这种划分有根本性缺陷。通过用固定点电荷 (MM) 处理金属表面，它使得电子转移变得不可能，因为 MM 区域中没有供体电子态。这违反了第二条指导原则。金属的固定电荷模型也无法捕捉镜像电荷效应。在氧化还原分子内部设置 QM/MM 边界也通常是有问题的。\n- **结论：** **不正确**。\n\n**B. 将整个氧化还原分子包含在量子力学区域中；将其第一溶剂化层中直接与反应位点形成氢键的所有溶剂分子以及任何桥接分子与金属的水分子包含在内；将内亥姆霍兹层中形成接触离子对或以其他方式直接与分子配位的任何抗衡离子包含在内；并将金表面的顶部 $3$ 个金属层作为周期性平板包含在量子力学区域中，以表示金属屏蔽并允许电荷转移。将其余的体相溶剂、更远的离子和更深层的金属作为分子力学处理，并采用适当的静电嵌入方案。**\n- **评论：** 这个选项正确地确定了 QM 区域所有必要的组成部分。\n    - **分子：** 整个分子是 QM，允许键断裂和电子重组。\n    - **金属：** 一个 $3$ 层的平板是 QM，满足了电荷转移（原则2）和对金属屏蔽/镜像效应的合理描述（原则3）的要求。\n    - **特定相互作用：** 它明确地将桥接水分子、形成氢键的溶剂和附近的抗衡离子包含在 QM 区域中，捕捉了问题描述和原则4中提到的关键短程相互作用。\n    - **划分：** 系统的其余部分通过静电嵌入以 MM 处理，这是处理长程环境的标准和正确方法。这个设置代表了解决此问题的、最先进的、具有物理动机的模型。\n- **结论：** **正确**。\n\n**C. 将氧化还原分子及其第一溶剂化层包含在量子力学区域中；用经典的、可极化的德鲁德模型和固定的边界电位来表示金属；所有离子和其余溶剂用分子力学处理。**\n- **评论：** 该模型无法实现电子转移。经典的德鲁德模型虽然是可极化的，因此能在一定程度上模拟镜像效应，但它没有显式的电子结构（没有量子化的能级，没有费米能级）。如原则2所述，供体和受体都必须在 QM 区域中才能进行电荷转移。这种划分违反了这一核心要求。\n- **结论：** **不正确**。\n\n**D. 将整个金属平板包含在量子力学区域中以捕捉镜像电荷和电荷转移；为降低计算成本，将氧化还原分子、溶剂和离子完全用分子力学处理。**\n- **评论：** 这种划分与关键化学过程的要求正好相反。用 MM 处理氧化还原分子使其无法模拟还原时发生的键断裂。此外，它违反了电荷转移原则（原则2），该原则要求*供体*和*受体*都在同一个 QM 区域中。\n- **结论：** **不正确**。\n\n**E. 将氧化还原分子和顶部 $1$ 个金属层包含在量子力学区域中；所有溶剂和离子用分子力学处理，并通过在 QM/MM 边界处的固定电荷来约束金属电位。**\n- **评论：** 这个选项有两个显著的弱点。首先，如原则3所述，单个金属层通常不足以正确模拟金属的集体电子响应，这意味着镜像电荷效应的描述会很差。其次，通过将所有溶剂和离子都放在 MM 区域，它未能捕捉氢键桥的特定量子性质和附近抗衡离子的强极化效应，而这些对于反应能量和路径可能至关重要。选项B提供了更物理上完备的描述。\n- **结论：** **不正确**。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在设计了QM/MM划分方案之后，一个至关重要的步骤是验证其设置的合理性。本项高级练习旨在解决一个实际问题：如何确定QM区域是否“足够大”以获得收敛的结果 ()。它指导您从物理第一性原理出发，推导并实现一个用于检验QM区域大小是否充分的系统性协议。通过建立收敛性判据，您将学会如何量化和控制由QM/MM边界截断所带来的误差，从而保证模拟结果的可靠性和可重复性。",
            "id": "4255648",
            "problem": "您的任务是为计算电化学中的界面反应，形式化并实现一个用于量子力学/分子力学 (QM/MM) 多尺度模拟的定量收敛协议。考虑一个在固-电解质边界发生的界面氧化还原反应，其中量子力学/分子力学 (QM/MM) 的划分方法是选择一个以反应位点为中心、半径为 $R$ 的球形量子力学 (QM) 区域，而外部则由分子力学 (MM) 处理。在玻恩-奥本海默近似下，反应能被定义为产物态和反应物态之间（原子核固定时）的电子基态势能之差。由于长程极化和静电耦合的截断（这些效应只能由 MM 嵌入近似地捕捉），计算出的反应能的准确性取决于 QM 区域的大小 $R$。\n\n从以下基本基础出发：\n- 玻恩-奥本海默近似以及将反应能定义为固定原子核位置下势能之差。\n- 电解质的线性响应理论，其中由局域电荷重新分布引起的诱导电势在屏蔽作用下随距离衰减。\n- 用于长程静电相互作用的多极展开，其中分离良好的贡献可以由前导多极矩来近似。\n- 截断误差主要由被忽略的、由反应引起的电荷重新分布与环境之间的相互作用所主导的原则。\n\n您必须：\n1. 从第一性原理出发，在线性介电屏蔽和多极展开下，推导截断误差关于 QM 区域半径 $R$ 的渐近表达式。您的推导必须使用正常数 $\\alpha$、$\\beta$ 和屏蔽长度 $\\lambda$ 来表示领头阶贡献，并且必须与物理衰减定律一致。明确定义您引入的任何中间物理量，例如反应引起的净电荷变化和偶极矩。最终的渐近形式必须适合在给定 $\\alpha$、$\\beta$、$\\lambda$ 和 $R$ 的情况下进行数值评估。\n2. 定义定量收敛度量，以证明 QM 区域足够大。这些度量必须包括：\n   - 一个能量差度量 $m_E(R_k)$，用于比较在连续半径 $R_{k-1}$ 和 $R_k$ 处估算的反应能。\n   - 一个边界敏感度度量 $m_F(R_k)$，它使用截断误差在 $R_k$ 处对 $R$ 的导数大小。\n   - 一个电荷溢出度量 $m_Q(R_k)$，它使用一个带有参数 $Q_0$ 和屏蔽长度 $\\lambda$ 的屏蔽衰减模型来衡量超出半径 $R_k$ 的剩余的反应引起的电荷影响。\n   每个度量都必须以与第 1 部分推导逻辑一致的方式，用 $R$、$\\alpha$、$\\beta$、$\\lambda$ 和 $Q_0$ 表示。\n3. 设计一个算法，该算法在给定候选半径的离散列表 $\\{R_k\\}$ 和阈值 $\\varepsilon_E$、$\\varepsilon_F$ 和 $\\varepsilon_Q$ 的情况下，选择使所有度量同时满足的最小 $R_k$，使用的条件是 $m_E(R_k) \\le \\varepsilon_E$、 $m_F(R_k) \\le \\varepsilon_F$ 和 $m_Q(R_k) \\le \\varepsilon_Q$。如果没有半径满足所有三个标准，算法必须返回 $-1$。\n4. 将该算法实现为一个完整的、可运行的程序。对于下面的每个测试用例，程序必须计算出所选的 QM 半径。能量必须以电子伏特 (eV) 处理，半径以埃 (Å) 处理，电荷溢出参数 $Q_0$ 以基本电荷为单位。最终的程序输出必须是单行文本，其中包含所有测试用例的所选半径，形式为用方括号括起来的逗号分隔列表。如果某个测试用例没有收敛，则在其位置输出整数 $-1$。输出中的所有半径必须四舍五入到三位小数。\n\n使用以下测试套件。对于每个测试用例，参数按以下顺序给出：真实反应能 $E_{\\mathrm{true}}$ (单位 eV)，耦合常数 $\\alpha$ (单位 eV·Å)，多极常数 $\\beta$ (单位 eV·Å$^3$)，屏蔽长度 $\\lambda$ (单位 Å)，溢出参数 $Q_0$ (单位基本电荷)，候选半径列表 (单位 Å)，以及阈值 $\\varepsilon_E$ (单位 eV)、$\\varepsilon_F$ (单位 eV/Å)、$\\varepsilon_Q$ (无量纲)。\n- 测试用例 1：$E_{\\mathrm{true}}=-0.500$ eV, $\\alpha=1.2$ eV·Å, $\\beta=10.0$ eV·Å$^3$, $\\lambda=5.0$ Å, $Q_0=1.0$, 候选半径 $[4.0,6.0,8.0,10.0,12.0,15.0]$ Å, 阈值 $\\varepsilon_E=0.010$ eV, $\\varepsilon_F=0.003$ eV/Å, $\\varepsilon_Q=0.050$。\n- 测试用例 2：$E_{\\mathrm{true}}=-0.800$ eV, $\\alpha=0.5$ eV·Å, $\\beta=3.0$ eV·Å$^3$, $\\lambda=50.0$ Å, $Q_0=1.0$, 候选半径 $[10.0,15.0,20.0,25.0,30.0]$ Å, 阈值 $\\varepsilon_E=0.010$ eV, $\\varepsilon_F=0.003$ eV/Å, $\\varepsilon_Q=0.050$。\n- 测试用例 3：$E_{\\mathrm{true}}=-0.300$ eV, $\\alpha=0.8$ eV·Å, $\\beta=4.0$ eV·Å$^3$, $\\lambda=5.0$ Å, $Q_0=0.6$, 候选半径 $[6.0,8.0,10.0,12.0]$ Å, 阈值 $\\varepsilon_E=0.015$ eV, $\\varepsilon_F=0.00325$ eV/Å, $\\varepsilon_Q=0.0812$。\n- 测试用例 4：$E_{\\mathrm{true}}=-0.650$ eV, $\\alpha=0.8$ eV·Å, $\\beta=1.5$ eV·Å$^3$, $\\lambda=8.0$ Å, $Q_0=0.3$, 候选半径 $[5.0,7.0,9.0,11.0,13.0]$ Å, 阈值 $\\varepsilon_E=0.0068$ eV, $\\varepsilon_F=0.0027$ eV/Å, $\\varepsilon_Q=0.060$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[9.000,12.000,-1,15.000]$）。报告每个选定的半径（单位 Å），四舍五入到三位小数，如果相应测试用例未达到收敛，则报告 $-1$。",
            "solution": "问题陈述已经过严格验证，并被确定为科学上合理、适定且客观。它在计算化学的既定框架内提出了一个可解决的挑战，没有矛盾或含糊之处。\n\n本文将从问题所要求的第一性原理出发，构建一个完整的解决方案。该方案分为三部分：渐近误差模型的推导、收敛度量的形式化定义以及算法收敛协议的设计。\n\n### 1. 渐近截断误差表达式的推导\n\n该问题关注在量子力学/分子力学 (QM/MM) 模拟中，计算的反应能相对于 QM 球体半径 $R$ 的收敛性。总计算反应能 $E(R)$ 是真实的玻恩-奥本海默反应能 $E_{\\mathrm{true}}$ 加上一个截断误差 $\\Delta E_{\\mathrm{err}}(R)$，该误差在 $R \\to \\infty$ 时趋于零。\n\n$$E(R) = E_{\\mathrm{true}} + \\Delta E_{\\mathrm{err}}(R)$$\n\n截断误差 $\\Delta E_{\\mathrm{err}}(R)$ 源于忽略了 QM 球体内由反应引起的电荷重新分布与由 MM 力场处理的环境部分（特别是半径为 $R$ 的球体之外的部分）之间的显式量子力学相互作用。\n\n我们基于基本静电学原理对此误差进行建模。反应引起电荷密度 $\\Delta\\rho(\\mathbf{r}) = \\rho_{\\mathrm{product}}(\\mathbf{r}) - \\rho_{\\mathrm{reactant}}(\\mathbf{r})$ 的变化，该变化局域于反应中心（原点）附近。对于大的 $R$，这种电荷重新分布与远处 MM 环境的相互作用可以使用由 $\\Delta\\rho(\\mathbf{r})$ 产生的电势的多极展开来分析。MM 环境被建模为一个线性介电介质，其特征是屏蔽长度 $\\lambda$，这解释了静电相互作用的衰减，例如，通过电解质的德拜-休克尔理论。\n\n多极展开的前导项是单极矩和偶极矩：\n- 净电荷变化（单极矩）：$\\Delta Q = \\int \\Delta\\rho(\\mathbf{r}) d^3\\mathbf{r}$。\n- 偶极矩的变化：$\\Delta\\mathbf{p} = \\int \\mathbf{r}\\Delta\\rho(\\mathbf{r}) d^3\\mathbf{r}$。\n\n如果 $\\Delta Q \\neq 0$，最长程的相互作用是单极矩项。这个净电荷变化与 QM 球体外部的屏蔽环境之间的相互作用能，预计将遵循屏蔽库仑势的形式。在屏蔽介质中，距离电荷 $R$ 处的电势以 $\\frac{e^{-R/\\lambda}}{R}$ 的形式衰减。相互作用能将与该电势成正比，从而对误差产生一个形式为 $C_1 \\frac{e^{-R/\\lambda}}{R}$ 的贡献。我们将这个依赖于 $\\Delta Q$ 和介质性质的比例常数封装在参数 $\\alpha$ 中。\n\n如果 $\\Delta Q = 0$，或者作为更高阶的修正，主导相互作用是由于偶极矩变化 $\\Delta\\mathbf{p}$。偶极子与周围介质的相互作用能随距离的衰减比单极子快。在非屏蔽环境中，偶极-介质相互作用能超出半径 $R$ 的部分，其标度为 $R^{-3}$。计入由屏蔽引起的指数衰减，这将产生一个形式为 $C_2 \\frac{e^{-R/\\lambda}}{R^3}$ 的贡献。这个依赖于 $|\\Delta\\mathbf{p}|$ 和介质性质的比例常数被封装在参数 $\\beta$ 中。\n\n结合这两个领头阶贡献，我们得到截断误差的渐近表达式：\n\n$$\n\\Delta E_{\\mathrm{err}}(R) = \\alpha \\frac{e^{-R/\\lambda}}{R} + \\beta \\frac{e^{-R/\\lambda}}{R^3}\n$$\n\n这里，$\\alpha$ 是与单极矩相关的耦合常数，单位为能量·长度 (eV·Å)；$\\beta$ 是与偶极矩相关的多极常数，单位为能量·长度$^3$ (eV·Å$^3$)；$\\lambda$ 是屏蔽长度 (Å)；$R$ 是 QM 半径 (Å)。$\\alpha$ 和 $\\beta$ 都被定义为正常数，代表相应相互作用的大小。\n\n### 2. 定量收敛度量的定义\n\n为了证明收敛，我们基于推导出的误差模型定义了三个度量。这些度量必须低于指定的阈值 $\\varepsilon_E$、$\\varepsilon_F$ 和 $\\varepsilon_Q$。检查是针对一系列递增的半径 $\\{R_0, R_1, \\dots, R_k, \\dots\\}$ 进行的。\n\n**A. 能量差度量，$m_E(R_k)$**\n\n该度量量化了随着 QM 半径增加，计算出的反应能的稳定性。它被定义为在两个连续半径 $R_{k-1}$ 和 $R_k$ 处计算的能量的绝对差。\n\n$$\nm_E(R_k) = |E(R_k) - E(R_{k-1})| = |(E_{\\mathrm{true}} + \\Delta E_{\\mathrm{err}}(R_k)) - (E_{\\mathrm{true}} + \\Delta E_{\\mathrm{err}}(R_{k-1}))|\n$$\n$$\nm_E(R_k) = |\\Delta E_{\\mathrm{err}}(R_k) - \\Delta E_{\\mathrm{err}}(R_{k-1})|\n$$\n\n该度量对于 $k \\ge 1$ 是可评估的。一个较小的值表明扩展 QM 区域对计算能量的改善作用递减。收敛标准是 $m_E(R_k) \\le \\varepsilon_E$。\n\n**B. 边界敏感度度量，$m_F(R_k)$**\n\n该度量测量计算能量对 QM 半径无穷小变化的敏感度，这可以被解释为由 QM/MM 边界施加的广义“力”。它被定义为截断误差对 $R$ 的导数的大小。\n\n$$\nm_F(R_k) = \\left| \\frac{d}{dR} \\Delta E_{\\mathrm{err}}(R) \\right|_{R=R_k}\n$$\n\n我们计算导数：\n$$\n\\frac{d}{dR} \\Delta E_{\\mathrm{err}}(R) = \\frac{d}{dR} \\left( \\alpha \\frac{e^{-R/\\lambda}}{R} + \\beta \\frac{e^{-R/\\lambda}}{R^3} \\right) = -\\alpha e^{-R/\\lambda} \\left( \\frac{1}{R^2} + \\frac{1}{\\lambda R} \\right) - \\beta e^{-R/\\lambda} \\left( \\frac{3}{R^4} + \\frac{1}{\\lambda R^3} \\right)\n$$\n由于 $\\alpha$、$\\beta$、$\\lambda$ 和 $R$ 均为正值，该表达式始终为负。其大小为：\n$$\nm_F(R_k) = \\alpha e^{-R_k/\\lambda} \\left( \\frac{1}{R_k^2} + \\frac{1}{\\lambda R_k} \\right) + \\beta e^{-R_k/\\lambda} \\left( \\frac{3}{R_k^4} + \\frac{1}{\\lambda R_k^3} \\right)\n$$\n一个较小的 $m_F$ 值表明对边界的确切位置依赖性较弱。收敛标准是 $m_F(R_k) \\le \\varepsilon_F$。\n\n**C. 电荷溢出度量，$m_Q(R_k)$**\n\n该度量提供了对反应引起的电荷效应约束的独立检查。它模拟了一个通用“电荷影响”的衰减，并量化了在 QM 边界处的残余影响。根据问题描述，我们为此影响采用一个简单的屏蔽衰减模型。参数 $Q_0$ (单位为基本电荷) 代表在原点处的影响大小，$\\lambda$ 是屏蔽长度。该度量定义为：\n\n$$\nm_Q(R_k) = Q_0 e^{-R_k/\\lambda}\n$$\n\n参数 $Q_0$ 在公式中被视为一个无量纲的数值，这与其提供的单位以及阈值 $\\varepsilon_Q$ 的无量纲性质相一致。该度量确保了产生误差的电荷效应在边界处已充分衰减。收敛标准是 $m_Q(R_k) \\le \\varepsilon_Q$。\n\n### 3. 收敛的算法协议\n\n该算法系统地从给定的离散集合中确定同时满足所有三个收敛标准的最小 QM 半径。\n\n**输入：**\n- 模型参数：$\\alpha$ (eV·Å), $\\beta$ (eV·Å$^3$), $\\lambda$ (Å), $Q_0$ (基本电荷)。\n- 一个已排序的候选半径列表：$R_{list} = [R_0, R_1, \\dots, R_N]$ (Å)。\n- 收敛阈值：$\\varepsilon_E$ (eV), $\\varepsilon_F$ (eV/Å), $\\varepsilon_Q$ (无量纲)。\n\n**步骤：**\n1.  初始化一个变量 `converged_radius` 为 $-1$。\n2.  从第二个元素 $R_1$ 开始，遍历 `candidate_radii` 列表。设当前半径为 $R_k$，前一个为 $R_{k-1}$，其中 $k$ 从 $1$ 到 $N$。\n3.  对于每个 $R_k$：\n    a. 计算能量差度量 $m_E(R_k) = |\\Delta E_{\\mathrm{err}}(R_k) - \\Delta E_{\\mathrm{err}}(R_{k-1})|$。\n    b. 计算边界敏感度度量 $m_F(R_k)$。\n    c. 计算电荷溢出度量 $m_Q(R_k)$。\n    d. 检查是否所有三个条件都得到满足：\n       $m_E(R_k) \\le \\varepsilon_E$ 并且\n       $m_F(R_k) \\le \\varepsilon_F$ 并且\n       $m_Q(R_k) \\le \\varepsilon_Q$。\n    e. 如果所有条件都满足，将 `converged_radius` 设置为 $R_k$ 并终止循环。\n4.  返回 `converged_radius` 的最终值。如果循环完成而未满足标准，则返回初始值 $-1$。\n\n此过程保证所选半径是给定列表中使系统根据指定度量和阈值被视为收敛的最小半径。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the given problem. It iterates through test cases,\n    applies the convergence algorithm, and prints the results in the required format.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (E_true, alpha, beta, lambda, Q0, radii, eps_E, eps_F, eps_Q)\n    test_cases = [\n        (-0.500, 1.2, 10.0, 5.0, 1.0, [4.0, 6.0, 8.0, 10.0, 12.0, 15.0], 0.010, 0.003, 0.050),\n        (-0.800, 0.5, 3.0, 50.0, 1.0, [10.0, 15.0, 20.0, 25.0, 30.0], 0.010, 0.003, 0.050),\n        (-0.300, 0.8, 4.0, 5.0, 0.6, [6.0, 8.0, 10.0, 12.0], 0.015, 0.00325, 0.0812),\n        (-0.650, 0.8, 1.5, 8.0, 0.3, [5.0, 7.0, 9.0, 11.0, 13.0], 0.0068, 0.0027, 0.060),\n    ]\n\n    # --- Helper functions for calculating metrics ---\n\n    def calculate_delta_e_err(R, alpha, beta, lam):\n        \"\"\"Calculates the truncation error Delta E_err(R).\"\"\"\n        if R == 0:\n            return float('inf')\n        exp_term = np.exp(-R / lam)\n        term1 = alpha * exp_term / R\n        term2 = beta * exp_term / (R**3)\n        return term1 + term2\n\n    def calculate_m_f(R, alpha, beta, lam):\n        \"\"\"Calculates the boundary sensitivity metric m_F(R).\"\"\"\n        if R == 0:\n            return float('inf')\n        exp_term = np.exp(-R / lam)\n        term1 = alpha * exp_term * (1 / (R**2) + 1 / (lam * R))\n        term2 = beta * exp_term * (3 / (R**4) + 1 / (lam * R**3))\n        return term1 + term2\n\n    def calculate_m_q(R, Q0, lam):\n        \"\"\"Calculates the charge spill metric m_Q(R).\"\"\"\n        return Q0 * np.exp(-R / lam)\n\n    def find_converged_radius(params):\n        \"\"\"\n        Implements the convergence algorithm for a single test case.\n        \"\"\"\n        _E_true, alpha, beta, lam, Q0, radii, eps_E, eps_F, eps_Q = params\n        \n        # The loop starts from the second radius, as m_E requires a previous radius.\n        for i in range(1, len(radii)):\n            R_k = radii[i]\n            R_prev = radii[i - 1]\n\n            # Calculate the metrics for the current radius R_k\n            \n            # Metric m_E: Energy difference\n            delta_e_k = calculate_delta_e_err(R_k, alpha, beta, lam)\n            delta_e_prev = calculate_delta_e_err(R_prev, alpha, beta, lam)\n            m_E = abs(delta_e_k - delta_e_prev)\n            \n            # Metric m_F: Boundary sensitivity\n            m_F = calculate_m_f(R_k, alpha, beta, lam)\n            \n            # Metric m_Q: Charge spill\n            m_Q = calculate_m_q(R_k, Q0, lam)\n            \n            # Check if all convergence criteria are met\n            if m_E = eps_E and m_F = eps_F and m_Q = eps_Q:\n                return R_k\n\n        # If the loop completes without finding a suitable radius, return -1\n        return -1\n\n    results = []\n    for case in test_cases:\n        result = find_converged_radius(case)\n        results.append(result)\n\n    # Format the final output string as specified.\n    # Radii are rounded to 3 decimal places, non-converged cases are -1.\n    output_str = f\"[{','.join(f'{r:.3f}' if r != -1 else '-1' for r in results)}]\"\n\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}