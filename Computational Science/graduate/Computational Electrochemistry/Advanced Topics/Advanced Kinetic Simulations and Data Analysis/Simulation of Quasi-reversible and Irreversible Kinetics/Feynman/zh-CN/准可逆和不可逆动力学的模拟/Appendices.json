{
    "hands_on_practices": [
        {
            "introduction": "在处理复杂的动力学模型之前，构建并验证一个能够解决基本传质问题的数值求解器是至关重要的。本练习将指导您为一个扩散受限的电位阶跃实验，实现一个有限差分模拟。通过将您的数值结果与解析的科特雷尔（Cottrell）方程进行比较，您将学习如何量化离散误差，并对您的计算框架建立信心——这是任何基于模拟的研究中的一项基本技能 。",
            "id": "4257928",
            "problem": "考虑一个溶解的电活性物质在平面电极上经历一个瞬时、不可逆的电子转移，在电位阶跃后发生的一维扩散过程。控制方程是关于反应物浓度$c(x,t)$的Fick第二扩散定律，定义在半无限域 $x \\in [0,\\infty)$ 上：\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2},\n$$\n其中扩散系数 $D0$。在时间 $t=0^+$ 时，电极电位阶跃至一个使表面反应达到扩散限制（即反应物瞬时消耗的不可逆）的值，因此在电极表面 $x=0$ 处的边界条件为\n$$\nc(0,t) = 0, \\quad t0,\n$$\n初始条件为均匀的本体浓度\n$$\nc(x,0) = c_{\\mathrm{bulk}}, \\quad x0,\n$$\n而远场边界条件维持本体浓度，\n$$\n\\lim_{x\\to\\infty} c(x,t) = c_{\\mathrm{bulk}}, \\quad t \\ge 0.\n$$\n在这些条件下，该扩散问题存在一个成熟的解析解，以及在不可逆极限下电极上扩散限制电流瞬态 $i(t)$ 的相关闭式表达式。你的任务是通过该解析解来验证一个数值模拟，并量化其在时间和空间上的离散化误差。\n\n从上述控制偏微分方程（PDE）和边界/初始条件出发，在一个截断域 $x \\in [0,L]$ 上实现一个瞬态扩散问题的求解器，其中 $L$ 需足够大以近似半无限介质。使用与以下条件一致的有限差分法：\n- 间距为 $\\Delta x$ 的均匀空间网格，\n- 均匀的时间步长 $\\Delta t$，\n- Dirichlet边界条件 $c(0,t)=0$ 和 $c(L,t)=c_{\\mathrm{bulk}}$，\n- 对表面通量 $J(0,t) = -D \\,\\partial c/\\partial x \\vert_{x=0}$ 的数值近似，在电极处具有至少二阶的空间精度。\n\n从数值通量 $J(0,t)$ 出发，通过以下公式计算以安培为单位的电流 $i_{\\mathrm{num}}(t)$：\n$$\ni_{\\mathrm{num}}(t) = n F A \\, \\left(-J(0,t)\\right),\n$$\n其中 $n$ 是转移的电子数，$F$ 是法拉第常数，$A$ 是平面电极的几何面积。将 $i_{\\mathrm{num}}(t)$ 与不可逆极限下的解析电流 $i_{\\mathrm{ana}}(t)$ 进行比较，并通过在模拟时间窗口内的均方根误差来量化其差异，\n$$\n\\mathrm{RMSE} = \\left( \\frac{1}{N_t} \\sum_{k=1}^{N_t} \\left[i_{\\mathrm{num}}(t_k) - i_{\\mathrm{ana}}(t_k)\\right]^2 \\right)^{1/2},\n$$\n其中 $t_k$ 是严格大于0的离散时间点，$N_t$ 是其数量。以安培为单位表示RMSE。\n\n使用以下物理上合理的参数，所有量均以国际单位制（SI）表示：\n- $D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}$ (扩散系数)，\n- $c_{\\mathrm{bulk}} = 1.0\\ \\mathrm{mol/m^3}$ (本体浓度)，\n- $n = 1$ (转移电子数)，\n- $F = 96485\\ \\mathrm{C/mol}$ (法拉第常数)，\n- $A = 1.0\\times 10^{-4}\\ \\mathrm{m^2}$ (电极面积)，\n- $T_{\\mathrm{end}} = 1.0\\ \\mathrm{s}$ (最终模拟时间)。\n\n设计你的求解器，使其能够评估不同 $(\\Delta x, \\Delta t, L)$ 三元组的RMSE。数值方法必须在科学上是合理的，并且域截断长度 $L$ 必须足够大，以近似半无限行为，除非有意引入边缘案例以测试灵敏度。\n\n提供一个包含以下七个案例的测试套件，每个案例都是一个元组 $(\\Delta x, \\Delta t, L)$：\n1. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $5.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)，\n2. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $2.5\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)，\n3. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $1.25\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)，\n4. ($5.0\\times 10^{-6}\\ \\mathrm{m}$, $1.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)，\n5. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $1.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)，\n6. ($1.25\\times 10^{-6}\\ \\mathrm{m}$, $1.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)，\n7. ($1.0\\times 10^{-5}\\ \\mathrm{m}$, $2.0\\times 10^{-2}\\ \\mathrm{s}$, $5.0\\times 10^{-4}\\ \\mathrm{m}$)。\n\n解释指南：\n- 案例1–3在固定空间分辨率下探究时间步长的细化。\n- 案例4–6在固定时间步长下探究空间的细化。\n- 案例7是一个边缘案例，具有相对较粗的离散化和较小的域，用于检验对截断和粗网格效应的灵敏度。\n\n你的程序应产生单行输出，其中包含七个RMSE值，每个值都以安培为单位，形式为用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4,r5,r6,r7]”）。不应打印任何额外文本。所有数值答案必须以安培为单位。",
            "solution": "该问题要求实现一个在平面电极上恒电位条件下的一维扩散过程的数值模拟，并对照已知的解析解来量化其精度。验证和求解过程如下。\n\n### 第一步：提取已知条件\n\n**控制方程：**\nFick第二定律：$\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}$，其中 $x \\in [0, \\infty)$，$t>0$。\n\n**初始和边界条件：**\n- 初始条件：$c(x,0) = c_{\\mathrm{bulk}}$，其中 $x>0$。\n- 电极表面（$x=0$）的边界条件：$c(0,t) = 0$，其中 $t>0$。\n- 远场边界条件：$\\lim_{x\\to\\infty} c(x,t) = c_{\\mathrm{bulk}}$，其中 $t \\ge 0$。\n\n**物理和模拟参数：**\n- 扩散系数：$D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}$。\n- 本体浓度：$c_{\\mathrm{bulk}} = 1.0\\ \\mathrm{mol/m^3}$。\n- 转移电子数：$n = 1$。\n- 法拉第常数：$F = 96485\\ \\mathrm{C/mol}$。\n- 电极面积：$A = 1.0\\times 10^{-4}\\ \\mathrm{m^2}$。\n- 最终模拟时间：$T_{\\mathrm{end}} = 1.0\\ \\mathrm{s}$。\n\n**数值方法要求：**\n- 在截断域 $x \\in [0,L]$ 上的有限差分法。\n- 均匀空间网格间距 $\\Delta x$。\n- 均匀时间步长 $\\Delta t$。\n- Dirichlet边界条件：$c(0,t)=0$ 和 $c(L,t)=c_{\\mathrm{bulk}}$。\n- 表面通量 $J(0,t) = -D \\,\\partial c/\\partial x \\vert_{x=0}$ 至少为二阶精度的数值近似。\n\n**输出计算：**\n- 数值电流：$i_{\\mathrm{num}}(t) = n F A \\, \\left(-J(0,t)\\right)$。\n- 误差度量：$\\mathrm{RMSE} = \\left( \\frac{1}{N_t} \\sum_{k=1}^{N_t} \\left[i_{\\mathrm{num}}(t_k) - i_{\\mathrm{ana}}(t_k)\\right]^2 \\right)^{1/2}$。\n\n**测试案例 $(\\Delta x, \\Delta t, L)$：**\n1. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $5.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)\n2. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $2.5\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)\n3. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $1.25\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)\n4. ($5.0\\times 10^{-6}\\ \\mathrm{m}$, $1.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)\n5. ($2.5\\times 10^{-6}\\ \\mathrm{m}$, $1.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)\n6. ($1.25\\times 10^{-6}\\ \\mathrm{m}$, $1.0\\times 10^{-3}\\ \\mathrm{s}$, $1.0\\times 10^{-3}\\ \\mathrm{m}$)\n7. ($1.0\\times 10^{-5}\\ \\mathrm{m}$, $2.0\\times 10^{-2}\\ \\mathrm{s}$, $5.0\\times 10^{-4}\\ \\mathrm{m}$)\n\n### 第二步：使用提取的已知条件进行验证\n\n- **科学依据：** 该问题基于Fick第二扩散定律，这是物理化学和输运现象中的一个基本原理。边界条件描述了一个标准的计时电流法实验（Cottrell实验），通量与电流之间的关系是电化学的基石。所有参数在物理上都是现实的。该问题在科学上是合理的。\n- **适定性：** 该偏微分方程以及指定的初始和边界条件构成了一个适定的初边值问题。实现数值求解器并计算一个明确定义的误差度量（RMSE）的任务是明确的。测试案例的域截断长度 $L$（$L \\ge 5.0 \\times 10^{-4}\\ \\mathrm{m}$）与在 $T_{\\mathrm{end}}=1.0\\ \\mathrm{s}$ 时的最大扩散层厚度（约为 $6\\sqrt{DT_{\\mathrm{end}}} \\approx 6\\sqrt{10^{-9} \\cdot 1.0} \\approx 1.9 \\times 10^{-4}\\ \\mathrm{m}$）相比足够大，从而验证了对半无限域的近似是有效的。所选的离散化参数可以确保模拟在数值上是稳定且无振荡的。\n- **客观性：** 问题以精确的数学术语、成熟的科学形式体系和客观量进行陈述。它没有歧义或主观论断。\n\n### 第三步：结论与行动\n该问题是有效的。下面是一个合理的解决方案。\n\n### 解决方案\n\n该解决方案需要为给定的扩散问题构建一个数值模型，并将其输出与已有的解析解进行比较。\n\n**1. 解析解 (Cottrell方程)**\n指定扩散问题的浓度分布 $c(x,t)$ 的解析解由误差函数 $\\mathrm{erf}$ 给出：\n$$\nc_{\\mathrm{ana}}(x,t) = c_{\\mathrm{bulk}} \\cdot \\mathrm{erf}\\left( \\frac{x}{2\\sqrt{Dt}} \\right)\n$$\n电极表面（$x=0$）的摩尔通量 $J(0,t)$ 可通过将此表达式对 $x$ 求导并在 $x=0$ 处求值得到：\n$$\nJ(0,t) = -D \\left. \\frac{\\partial c_{\\mathrm{ana}}}{\\partial x} \\right|_{x=0} = -D \\left. \\left( c_{\\mathrm{bulk}} \\frac{e^{-x^2/(4Dt)}}{\\sqrt{\\pi Dt}} \\right) \\right|_{x=0} = -c_{\\mathrm{bulk}}\\sqrt{\\frac{D}{\\pi t}}\n$$\n电流 $i(t)$ 与通量的关系为 $i(t) = -nFAJ(0,t)$。代入通量的表达式，得到解析电流，即著名的Cottrell方程：\n$$\ni_{\\mathrm{ana}}(t) = n F A c_{\\mathrm{bulk}} \\sqrt{\\frac{D}{\\pi t}}\n$$\n该方程作为验证数值模拟的基准。请注意，当 $t \\to 0^+$ 时，$i_{\\mathrm{ana}}(t) \\to \\infty$，因此误差分析必须在 $t > 0$ 时进行。\n\n**2. 数值格式：Crank-Nicolson方法**\n为了数值求解控制偏微分方程，我们采用有限差分法。选择Crank-Nicolson格式是因为它具有无条件稳定性和在时间与空间上均为二阶的精度（$O(\\Delta t^2, \\Delta x^2)$）。\n\n将域离散化为空间网格 $x_j = j\\Delta x$（其中 $j=0, 1, \\dots, N_x$，$L=N_x\\Delta x$）和时间网格 $t_k = k\\Delta t$（其中 $k=0, 1, \\dots, N_t$，$T_{\\mathrm{end}}=N_t\\Delta t$）。令 $c_j^k \\approx c(x_j, t_k)$。\n\nPDE的Crank-Nicolson离散化形式为：\n$$\n\\frac{c_j^{k+1} - c_j^k}{\\Delta t} = \\frac{D}{2} \\left( \\frac{c_{j+1}^{k+1} - 2c_j^{k+1} + c_{j-1}^{k+1}}{(\\Delta x)^2} + \\frac{c_{j+1}^k - 2c_j^k + c_{j-1}^k}{(\\Delta x)^2} \\right)\n$$\n令 $\\lambda = D\\Delta t / (\\Delta x)^2$。对于每个内部节点 $j=1, 2, \\ldots, N_x-1$，重排方程，将时间步 $k+1$ 的未知浓度（左侧）与时间步 $k$ 的已知浓度（右侧）分开：\n$$\n-\\frac{\\lambda}{2} c_{j-1}^{k+1} + (1+\\lambda) c_j^{k+1} - \\frac{\\lambda}{2} c_{j+1}^{k+1} = \\frac{\\lambda}{2} c_{j-1}^k + (1-\\lambda) c_j^k + \\frac{\\lambda}{2} c_{j+1}^k\n$$\n这代表了一个关于内部节点未知浓度 $c_j^{k+1}$ 的 $N_x-1$ 个线性方程组。该系统可以写成矩阵形式 $\\mathbf{A}\\mathbf{c}^{k+1} = \\mathbf{b}^k$，其中 $\\mathbf{A}$ 是一个三对角矩阵。\n\n**3. 系统实现**\n用于内部节点的三对角矩阵 $\\mathbf{A}$ 在整个模拟过程中保持不变：\n$$\n\\mathbf{A} = \n\\begin{pmatrix}\n1+\\lambda  -\\frac{\\lambda}{2}  0  \\cdots  0 \\\\\n-\\frac{\\lambda}{2}  1+\\lambda  -\\frac{\\lambda}{2}  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots   -\\frac{\\lambda}{2}  1+\\lambda  -\\frac{\\lambda}{2} \\\\\n0  \\cdots  0  -\\frac{\\lambda}{2}  1+\\lambda\n\\end{pmatrix}\n$$\n右侧向量 $\\mathbf{b}^k$ 由时间 $k$ 的已知浓度构建。对于所有 $k0$ 的边界条件 $c_0^k = 0$ 和 $c_{N_x}^k = c_{\\mathrm{bulk}}$ 按如下方式引入：\n- 对于第一个内部节点（$j=1$）：涉及 $c_0^{k+1}$ 的项移到右侧，但由于 $c_0^{k+1}=0$，该项消失。因为 $c_0^k=0$，右侧元素为 $b_1^k = (1-\\lambda)c_1^k + \\frac{\\lambda}{2}c_2^k$。\n- 对于最后一个内部节点（$j=N_x-1$）：项 $-\\frac{\\lambda}{2}c_{N_x}^{k+1}$ 移到右侧。由于 $c_{N_x}^{k+1} = c_{\\mathrm{bulk}}$，这会给右侧增加一个项 $\\frac{\\lambda}{2}c_{\\mathrm{bulk}}$。右侧元素变为 $b_{N_x-1}^k = \\frac{\\lambda}{2}c_{N_x-2}^k + (1-\\lambda)c_{N_x-1}^k + \\frac{\\lambda}{2}c_{N_x}^k + \\frac{\\lambda}{2}c_{\\mathrm{bulk}} = \\frac{\\lambda}{2}c_{N_x-2}^k + (1-\\lambda)c_{N_x-1}^k + \\lambda c_{\\mathrm{bulk}}$。\n\n在每个时间步，使用专用算法（例如`scipy.linalg.solve_banded`提供的算法）高效地求解此三对角系统以得到 $\\mathbf{c}^{k+1}$。\n\n**4. 数值电流和误差计算**\n问题要求电极处的通量计算具有至少二阶精度。使用三点前向有限差分公式计算一阶导数：\n$$\n\\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0, t=t_k} \\approx \\frac{-3c_0^k + 4c_1^k - c_2^k}{2\\Delta x}\n$$\n由于边界条件规定 $c_0^k = 0$，上式简化为：\n$$\n\\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0, t=t_k} \\approx \\frac{4c_1^k - c_2^k}{2\\Delta x}\n$$\n数值通量为 $J_{\\mathrm{num}}(0,t_k) = -D \\left(\\frac{4c_1^k - c_2^k}{2\\Delta x}\\right)$，数值电流为：\n$$\ni_{\\mathrm{num}}(t_k) = nFA \\cdot D \\left(\\frac{4c_1^k - c_2^k}{2\\Delta x}\\right)\n$$\n然后，根据指定公式，对所有时间步 $t_k$（$k=1, \\dots, N_t$）计算均方根误差（RMSE）：\n$$\n\\mathrm{RMSE} = \\left( \\frac{1}{N_t} \\sum_{k=1}^{N_t} \\left[i_{\\mathrm{num}}(t_k) - i_{\\mathrm{ana}}(t_k)\\right]^2 \\right)^{1/2}\n$$\n以下程序为七个测试案例中的每一个实现了这整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D diffusion problem for a series of test cases\n    and reports the Root-Mean-Square Error (RMSE) against the\n    analytical Cottrell equation.\n    \"\"\"\n\n    test_cases = [\n        # (delta_x, delta_t, L) in SI units (m, s, m)\n        (2.5e-6, 5.0e-3, 1.0e-3),\n        (2.5e-6, 2.5e-3, 1.0e-3),\n        (2.5e-6, 1.25e-3, 1.0e-3),\n        (5.0e-6, 1.0e-3, 1.0e-3),\n        (2.5e-6, 1.0e-3, 1.0e-3),\n        (1.25e-6, 1.0e-3, 1.0e-3),\n        (1.0e-5, 2.0e-2, 5.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        dx, dt, L = case\n        rmse = run_simulation(dx, dt, L)\n        results.append(f\"{rmse:.10e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(dx, dt, L):\n    \"\"\"\n    Performs a single finite-difference simulation for a given\n    set of discretization parameters.\n\n    Args:\n        dx (float): Spatial step size (m).\n        dt (float): Time step size (s).\n        L (float): Domain length (m).\n\n    Returns:\n        float: The RMSE of the numerical current vs. analytical current in Amperes.\n    \"\"\"\n    # Physical and simulation parameters\n    D = 1.0e-9        # Diffusion coefficient (m^2/s)\n    C_BULK = 1.0      # Bulk concentration (mol/m^3)\n    N_E = 1           # Number of electrons\n    F = 96485.0       # Faraday constant (C/mol)\n    A = 1.0e-4        # Electrode area (m^2)\n    T_END = 1.0       # Final simulation time (s)\n\n    # Grid setup\n    # The problem is designed such that L/dx and T_END/dt are integers.\n    Nx = int(round(L / dx))\n    Nt = int(round(T_END / dt))\n\n    # --- Initial and Boundary Conditions ---\n    # c(x,0) = c_bulk for x > 0; c(0, t) = 0\n    c = np.full(Nx + 1, C_BULK, dtype=np.float64)\n    c[0] = 0.0\n\n    # --- Crank-Nicolson Method Setup ---\n    lambda_val = D * dt / (dx**2)\n    \n    # Setup tridiagonal matrix A for the system A*c_new = B\n    # Banded format for scipy.linalg.solve_banded:\n    # ab[0,:] = super-diagonal (u=1)\n    # ab[1,:] = main-diagonal\n    # ab[2,:] = sub-diagonal (l=1)\n    ab = np.zeros((3, Nx - 1), dtype=np.float64)\n    ab[0, 1:] = -lambda_val / 2.0\n    ab[1, :] = 1.0 + lambda_val\n    ab[2, :-1] = -lambda_val / 2.0\n    \n    sum_sq_err = 0.0\n\n    # --- Time-stepping loop ---\n    for k in range(Nt):\n        # Construct the right-hand side vector B\n        # B = M*c_old, where c_old are concentrations at the current step\n        b_vec = (lambda_val / 2.0) * c[:-2] + \\\n                (1.0 - lambda_val) * c[1:-1] + \\\n                (lambda_val / 2.0) * c[2:]\n\n        # Apply boundary condition at x=L (Dirichlet c(L,t) = c_bulk).\n        # This adds a term from the LHS matrix to the RHS vector.\n        b_vec[-1] += (lambda_val / 2.0) * C_BULK\n        \n        # Solve the tridiagonal system for internal nodes at the next time step\n        c_internal_new = solve_banded((1, 1), ab, b_vec)\n        \n        # Update concentration profile\n        c[1:-1] = c_internal_new\n        \n        # --- Calculate error for this time step ---\n        current_t = (k + 1) * dt\n        \n        # Numerical current (using a second-order accurate 3-point forward difference for the flux)\n        # dcdx @ x=0 approx. (4*c_1 - c_2) / (2*dx) since c_0 = 0\n        dcdx_num = (4.0 * c[1] - c[2]) / (2.0 * dx) # Order O(dx^2)\n        i_num = N_E * F * A * D * dcdx_num\n\n        # Analytical current (Cottrell equation)\n        i_ana = N_E * F * A * C_BULK * np.sqrt(D / (np.pi * current_t))\n        \n        sum_sq_err += (i_num - i_ana)**2\n\n    rmse = np.sqrt(sum_sq_err / Nt)\n    return rmse\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了数值扩散的模拟后，我们现在转向动力学本身。本练习将使用解析方法，探讨具有有限、不可逆电子转移动力学系统的行为。通过推导和计算随时间变化的表面浓度，您将对动力学受限系统如何偏离纯粹由扩散控制（可逆）的极限情况建立清晰的物理直觉，并突显标准速率常数 $k^0$ 的重要性 。",
            "id": "4257997",
            "problem": "在计算电化学中，考虑一个平面半无限扩散体系，其中发生氧化态物种 $O$ 到还原态物种 $R$ 的单电子转移反应，即 $O + e^- \\rightarrow R$。氧化态物种 $O$ 的本体浓度为 $C_O^*$，扩散系数为 $D_O$。在时间 $t=0$ 时，电极电位从形式电位 $E^0$ 阶跃至一个阴极电位值 $E_2$（相对于 $E^0$ 为一个负过电位），电极位于 $x=0$ 处，溶液延伸至 $x \\ge 0$ 的区域。问题要求以物理上和计算上严谨的方式，通过计算随时间变化的表面浓度 $C_O(0,t)$ 并解释由有限的标准非均相速率常数 $k^0$ 引起的偏差，来比较不可逆瞬态与可逆阶跃。\n\n基本依据是 Fick 扩散第二定律，适用于一维、半无限域和平面几何中的物种 $O$：\n$$\\frac{\\partial C_O(x,t)}{\\partial t} = D_O \\frac{\\partial^2 C_O(x,t)}{\\partial x^2}, \\quad x \\ge 0, \\ t  0,$$\n初始条件和远场条件为\n$$C_O(x,0) = C_O^*, \\quad \\lim_{x \\to \\infty} C_O(x,t) = C_O^*.$$\n\n在电极表面 $x=0$ 处，边界条件由界面电荷转移动力学决定。对于逆向反应可忽略的不可逆阴极电位阶跃，动力学通量对氧化态物种 $O$ 呈一级：\n$$-D_O \\left.\\frac{\\partial C_O(x,t)}{\\partial x}\\right|_{x=0} = k_{\\text{red}} C_O(0,t),$$\n其中有效还原速率常数 $k_{\\text{red}}$ 取决于标准非均相速率常数 $k^0$、电荷转移系数 $\\alpha$、过电位 $\\eta = E_2 - E^0$（单位为伏特）以及热因子 $f = F/(RT)$，其中 $F$ 为法拉第常数，$R$ 为气体常数，$T$ 为绝对温度。关系式为\n$$k_{\\text{red}} = k^0 \\exp\\left(-\\alpha f \\eta\\right).$$\n使用 $F = 96485.33212 \\ \\mathrm{C \\ mol^{-1}}$、$R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} K^{-1}}$ 和 $T = 298.15 \\ \\mathrm{K}$，因此 $f$ 的数值是确定的。假设在 $t=0$ 时，氧化态物种 $O$ 是唯一初始存在的电活性物种，而 $R$ 初始时不存在。\n\n对于阶跃到足够负电位的可逆阶跃极限（非均相动力学速率等效于无限大），边界表现为吸收界面，物种 $O$ 的表面浓度在 $t  0$ 时变为零，即\n$$C_O^{\\text{rev}}(0,t) = 0.$$\n这个可逆吸收边界作为与有限速率动力学进行比较的参考。\n\n您的任务是：\n- 从上述基本依据和边界条件出发，推导具有有限动力学的不可逆阴极阶跃下随时间变化的表面浓度 $C_O(0,t)$，并以对所有相关参数值都数值稳定的形式表示结果。\n- 实现一个程序，对于下面定义的测试套件中的每个测试用例，计算不可逆情况下的无量纲比率 $C_O(0,t)/C_O^*$，并解释其与可逆吸收边界参考的偏差。该解释由计算出的无量纲比率本身来量化，因为可逆参考比率 $C_O^{\\text{rev}}(0,t)/C_O^* = 0$。\n\n您的计算的所有输入都明确指定了物理单位。输出必须是无量纲数。不涉及角度。程序必须按照下面描述的精确最终输出格式生成结果。\n\n使用以下参数集测试套件，每个元组的顺序为 ($D_O$ [$\\mathrm{m^2/s}$], $k^0$ [$\\mathrm{m/s}$], $\\alpha$ [-], $\\eta$ [V], $t$ [s], $C_O^*$ [$\\mathrm{mol/m^3}$])：\n1. ($1.0 \\times 10^{-9}$, $1.0 \\times 10^{-7}$, 0.50, -0.30, $1.0 \\times 10^{-3}$, 1.0)\n2. ($1.0 \\times 10^{-9}$, $1.0 \\times 10^{-7}$, 0.50, -0.30, $1.0 \\times 10^{-1}$, 1.0)\n3. ($1.0 \\times 10^{-9}$, $1.0 \\times 10^{-3}$, 0.50, -0.30, 1.0, 1.0)\n4. ($1.0 \\times 10^{-9}$, $1.0 \\times 10^{-9}$, 0.50, -0.05, $1.0 \\times 10^{-3}$, 1.0)\n5. ($5.0 \\times 10^{-10}$, $1.0 \\times 10^{-5}$, 0.30, -0.20, $1.0 \\times 10^{-2}$, 1.0)\n6. ($1.5 \\times 10^{-9}$, $1.0 \\times 10^{-4}$, 0.60, -0.15, $5.0 \\times 10^{-1}$, 1.0)\n\n对于每个测试用例，计算上述不可逆动力学模型的无量纲结果\n$$\\frac{C_O(0,t)}{C_O^*}$$\n。将这些结果表示为浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,...]”）。这些值是无量纲的，不需要单位标签。请设计计算过程，使其在测试套件的所有情况下都保持数值稳定。",
            "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于电化学动力学和质量传输的原理，在数学上作为具有适当边界条件的线性偏微分方程是适定的，并且是客观且自包含的。所有提供的物理常数都是正确的，量纲分析证实了方程的一致性。\n\n该问题要求推导和计算在引发不可逆电化学反应的电位阶跃影响下，电活性物种在电极表面（$x=0$）随时间变化的浓度 $C_O(x,t)$。该体系由一维半无限域中的 Fick 扩散第二定律控制：\n$$\n\\frac{\\partial C_O(x,t)}{\\partial t} = D_O \\frac{\\partial^2 C_O(x,t)}{\\partial x^2}, \\quad \\text{for } x \\ge 0, t  0\n$$\n该问题受以下初始条件和边界条件的约束：\n1.  初始条件：对于所有 $x \\ge 0$，$C_O(x,0) = C_O^*$。在电位阶跃之前，浓度是均匀的，等于本体浓度 $C_O^*$。\n2.  远场边界条件：对于所有 $t  0$，$\\lim_{x \\to \\infty} C_O(x,t) = C_O^*$。远离电极处，浓度保持其本体值。\n3.  表面边界条件（$x=0$ 处）：$-D_O \\left.\\frac{\\partial C_O(x,t)}{\\partial x}\\right|_{x=0} = k_{\\text{red}} C_O(0,t)$。此条件将物种 $O$ 到达电极表面的扩散通量与一级非均相电子转移反应对其的消耗速率等同起来。\n\n有效速率常数 $k_{\\text{red}}$ 由大阴极过电位下的 Butler-Volmer 动力学表达式给出：\n$$\nk_{\\text{red}} = k^0 \\exp(-\\alpha f \\eta)\n$$\n其中 $k^0$ 是标准非均相速率常数，$\\alpha$ 是电荷转移系数，$\\eta$ 是过电位，而 $f = F/(RT)$ 是热电压因子。\n\n求解此偏微分方程及给定条件的标准方法是拉普拉斯变换。令 $\\bar{c}(x,s) = \\mathcal{L}\\{C_O(x,t)\\}$ 为 $C_O(x,t)$ 关于时间 $t$ 的拉普拉斯变换。对扩散方程应用该变换，得到一个关于空间变量 $x$ 的常微分方程：\n$$\ns \\bar{c}(x,s) - C_O(x,0) = D_O \\frac{d^2 \\bar{c}(x,s)}{dx^2}\n$$\n代入初始条件 $C_O(x,0) = C_O^*$ 得：\n$$\n\\frac{d^2 \\bar{c}}{dx^2} - \\frac{s}{D_O} \\bar{c}(x,s) = -\\frac{C_O^*}{D_O}\n$$\n这个非齐次常微分方程的通解是一个特解 $\\bar{c}_p = C_O^*/s$ 和补函数之和。解的形式为：\n$$\n\\bar{c}(x,s) = A(s) \\exp\\left(-\\sqrt{\\frac{s}{D_O}}x\\right) + B(s) \\exp\\left(+\\sqrt{\\frac{s}{D_O}}x\\right) + \\frac{C_O^*}{s}\n$$\n远场边界条件 $\\lim_{x \\to \\infty} C_O(x,t) = C_O^*$ 变换为 $\\lim_{x \\to \\infty} \\bar{c}(x,s) = C_O^*/s$。为使此式成立，指数增长项的系数必须为零，因此 $B(s)=0$。解简化为：\n$$\n\\bar{c}(x,s) = A(s) \\exp\\left(-\\sqrt{\\frac{s}{D_O}}x\\right) + \\frac{C_O^*}{s}\n$$\n表面边界条件也被变换：\n$$\n-D_O \\frac{d\\bar{c}}{dx}(0,s) = k_{\\text{red}} \\bar{c}(0,s)\n$$\n从解的形式，我们找到导数 $\\frac{d\\bar{c}}{dx}(x,s) = -A(s)\\sqrt{s/D_O}\\exp(-\\sqrt{s/D_O}x)$。在表面 $x=0$ 处，我们有 $\\bar{c}(0,s) = A(s) + C_O^*/s$ 和 $\\frac{d\\bar{c}}{dx}(0,s) = -A(s)\\sqrt{s/D_O}$。将这些代入变换后的边界条件，得到：\n$$\n-D_O \\left(-A(s)\\sqrt{\\frac{s}{D_O}}\\right) = k_{\\text{red}} \\left(A(s) + \\frac{C_O^*}{s}\\right)\n$$\n$$\nA(s) \\sqrt{sD_O} = k_{\\text{red}} A(s) + \\frac{k_{\\text{red}} C_O^*}{s}\n$$\n求解系数 $A(s)$：\n$$\nA(s) \\left(\\sqrt{sD_O} - k_{\\text{red}}\\right) \\rightarrow A(s)\\left(\\sqrt{sD_O} + k_{\\text{red}}\\right) = -k_{\\text{red}} \\frac{C_O^*}{s}\n$$\n初始问题陈述的边界条件中存在一个符号错误，传统上写作 $D_O(\\partial C_O/\\partial x)|_{x=0} = k_{\\text{red}}C_O(0,t)$，表示离开电极的通量等于消耗。按照问题陈述的原样继续：$-D_O \\frac{\\partial C_O}{\\partial x}|_{x=0} = k_{\\text{red}} C_O(0,t)$，我们得到 $A(s)(\\sqrt{sD_O} - k_{\\text{red}}) = \\frac{k_{\\text{red}}C_O^*}{s}$。这会导致右半平面出现极点。一个物理上真实的边界条件要求朝向电极的扩散通量（即 $-D_O \\partial C_O/\\partial x$）等于动力学消耗速率 $k_{\\text{red}}C_O$。原方程陈述是正确的。重新评估代数：$A(s) \\sqrt{sD_O} = k_{\\text{red}} A(s) + k_{\\text{red}}C_O^*/s$，这给出 $A(s)(\\sqrt{sD_O} - k_{\\text{red}}) = k_{\\text{red}}C_O^*/s$。让我们使用另一种标准的符号约定：$D_O \\frac{\\partial C_O}{\\partial x}|_{x=0} = k_{red} C_O(0,t)$。这导致：\n$D_O \\left(-A(s)\\sqrt{s/D_O}\\right) = k_{\\text{red}} \\left(A(s) + C_O^*/s\\right)$，所以 $-A(s)\\sqrt{sD_O} = k_{\\text{red}}A(s) + k_{\\text{red}}C_O^*/s$，导出 $A(s) = -\\frac{k_{\\text{red}} C_O^*}{s(\\sqrt{sD_O} + k_{\\text{red}})}$。\n拉普拉斯域中的表面浓度为 $\\bar{c}(0,s) = A(s) + C_O^*/s$：\n$$\n\\bar{c}(0,s) = -\\frac{k_{\\text{red}} C_O^*}{s(\\sqrt{sD_O} + k_{\\text{red}})} + \\frac{C_O^*}{s} = \\frac{C_O^*}{s}\\left(1 - \\frac{k_{\\text{red}}}{\\sqrt{sD_O} + k_{\\text{red}}}\\right) = \\frac{C_O^*\\sqrt{sD_O}}{s(\\sqrt{sD_O} + k_{\\text{red}})}\n$$\n需要计算的量是无量纲比率 $C_O(0,t)/C_O^*$。其拉普拉斯变换为：\n$$\n\\mathcal{L}\\left\\{\\frac{C_O(0,t)}{C_O^*}\\right\\} = \\frac{\\bar{c}(0,s)}{C_O^*} = \\frac{\\sqrt{D_O}}{\\sqrt{s}(\\sqrt{sD_O} + k_{\\text{red}})} = \\frac{1}{\\sqrt{s}\\left(\\sqrt{s} + \\frac{k_{\\text{red}}}{\\sqrt{D_O}}\\right)}\n$$\n这是一个标准的拉普拉斯变换对。令 $z = k_{\\text{red}}\\sqrt{t/D_O}$，其逆变换由下式给出：\n$$\n\\frac{C_O(0,t)}{C_O^*} = \\exp\\left(\\left(\\frac{k_{\\text{red}}}{\\sqrt{D_O}}\\right)^2 t\\right) \\text{erfc}\\left(\\frac{k_{\\text{red}}}{\\sqrt{D_O}}\\sqrt{t}\\right) = \\exp\\left(\\frac{k_{\\text{red}}^2 t}{D_O}\\right) \\text{erfc}\\left(k_{\\text{red}}\\sqrt{\\frac{t}{D_O}}\\right)\n$$\n此表达式的形式为 $\\exp(z^2)\\text{erfc}(z)$，其中 $z = k_{\\text{red}}\\sqrt{t/D_O}$。当自变量 $z$ 的值很大时，直接计算 $\\exp(z^2)$ 和 $\\text{erfc}(z)$ 可能导致数值不稳定性（分别为上溢和下溢）。一种数值稳健的方法是使用缩放互补误差函数 $\\text{erfcx}(z) = \\exp(z^2)\\text{erfc}(z)$，该函数专门为在所有非负 $z$ 值上进行稳定计算而设计。此函数在标准科学计算库中可用，例如 Python 中的 `scipy.special.erfcx`。\n\n计算步骤如下：\n1.  使用提供的物理常数计算热因子 $f = F/(RT)$。\n2.  对于每个测试用例，计算有效速率常数 $k_{\\text{red}} = k^0 \\exp(-\\alpha f \\eta)$。\n3.  计算无量纲自变量 $z = k_{\\text{red}}\\sqrt{t/D_O}$。\n4.  计算所需比率 $C_O(0,t)/C_O^*$，即 $\\text{erfcx}(z)$。结果是一个介于 0 和 1 之间的无量纲数。接近 0 的值表示行为接近可逆极限（动力学非常快，表面完全耗尽），而接近 1 的值表示动力学非常慢，表面浓度与本体值相比几乎没有变化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfcx\n\ndef solve():\n    \"\"\"\n    Solves the electrochemical diffusion problem for the given test cases.\n    \"\"\"\n    \n    # Define physical constants\n    F = 96485.33212  # Faraday constant in C/mol\n    R = 8.314462618  # Gas constant in J/(mol*K)\n    T = 298.15       # Temperature in K\n    \n    # Pre-calculate the thermal factor f = F/(RT)\n    f_val = F / (R * T)\n    \n    # Test suite of parameter sets (D_O [m^2/s], k^0 [m/s], alpha [-], eta [V], t [s], C_O* [mol/m^3])\n    test_cases = [\n        (1.0e-9, 1.0e-7, 0.50, -0.30, 1.0e-3, 1.0),\n        (1.0e-9, 1.0e-7, 0.50, -0.30, 1.0e-1, 1.0),\n        (1.0e-9, 1.0e-3, 0.50, -0.30, 1.0, 1.0),\n        (1.0e-9, 1.0e-9, 0.50, -0.05, 1.0e-3, 1.0),\n        (5.0e-10, 1.0e-5, 0.30, -0.20, 1.0e-2, 1.0),\n        (1.5e-9, 1.0e-4, 0.60, -0.15, 5.0e-1, 1.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current test case\n        D_O, k0, alpha, eta, t, _ = case\n        \n        # Step 1: Calculate the effective reduction rate constant k_red\n        # k_red = k^0 * exp(-alpha * f * eta)\n        k_red = k0 * np.exp(-alpha * f_val * eta)\n        \n        # Step 2: Calculate the dimensionless argument z for erfcx\n        # z = k_red * sqrt(t / D_O)\n        z = k_red * np.sqrt(t / D_O)\n        \n        # Step 3: Compute the dimensionless surface concentration ratio\n        # C_O(0,t)/C_O* = exp(z^2) * erfc(z) = erfcx(z)\n        # The scipy.special.erfcx function is used for numerical stability.\n        concentration_ratio = erfcx(z)\n        \n        results.append(concentration_ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实的电化学系统常常涉及导致非线性行为的耦合现象，例如未补偿电阻 ($R_u$) 的影响。这项高级练习将挑战您通过求解一组关于表面浓度和电流的耦合非线性方程组，来为此类系统建模。您将实现一个带有精确雅可比矩阵的牛顿-拉弗森（Newton-Raphson）求解器，这是一种功能强大且广泛适用于解决复杂、现实电化学模拟问题的技术 。",
            "id": "4257957",
            "problem": "考虑一个单电子、平面的扩散-动力学模型，用于描述在含有过量支持电解质的二元电解质中，电极上发生的非均相氧化还原反应 $\\mathrm{O} + \\mathrm{e}^{-} \\leftrightarrow \\mathrm{R}$。在每个时间步施加外加电势 $E_{\\mathrm{app}}$，但有效表面电势 $E_{\\mathrm{s}}$ 通过关系式 $E_{\\mathrm{s}} = E_{\\mathrm{app}} - i R_{\\mathrm{u}}$ 依赖于未补偿溶液电阻，其中 $i$ 是法拉第电流密度。界面动力学遵循 Butler–Volmer 形式的阴极（还原）和阳极（氧化）速率常数，\n$$\nk_{\\mathrm{c}}(E_{\\mathrm{s}}) = k_{0}\\,\\exp\\!\\left(-\\alpha\\,\\frac{F}{R T}\\,\\big(E_{\\mathrm{s}} - E^{0}\\big)\\right),\\qquad\nk_{\\mathrm{a}}(E_{\\mathrm{s}}) = k_{0}\\,\\exp\\!\\left(\\big(1-\\alpha\\big)\\,\\frac{F}{R T}\\,\\big(E_{\\mathrm{s}} - E^{0}\\big)\\right),\n$$\n其中 $k_{0}$ 是标准非均相速率常数，$\\alpha$ 是电荷转移系数，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是温度，$E^{0}$ 是形式电势。近电极传输由厚度为 $\\delta$ 的静态扩散膜近似，物种 $\\mathrm{O}$ 和 $\\mathrm{R}$ 具有共同的扩散系数 $D$。扩散通量通过 Fick 第一定律在膜上近似为：\n$$\nJ_{\\mathrm{O}} = \\frac{D}{\\delta}\\,\\big(c_{\\mathrm{O,bulk}} - c_{\\mathrm{O}}(0)\\big),\\qquad\nJ_{\\mathrm{R}} = \\frac{D}{\\delta}\\,\\big(c_{\\mathrm{R}}(0) - c_{\\mathrm{R,bulk}}\\big),\n$$\n其中 $c_{\\mathrm{O}}(0)$ 和 $c_{\\mathrm{R}}(0)$ 是 $x=0$ 处的界面浓度，$c_{\\mathrm{O,bulk}}$ 和 $c_{\\mathrm{R,bulk}}$ 是膜外边缘处的体相浓度。界面质量平衡将反应速率与扩散通量等同起来：\n$$\n\\frac{D}{\\delta}\\,\\big(c_{\\mathrm{O,bulk}} - c_{\\mathrm{O}}(0)\\big) = k_{\\mathrm{c}}(E_{\\mathrm{s}})\\,c_{\\mathrm{O}}(0) - k_{\\mathrm{a}}(E_{\\mathrm{s}})\\,c_{\\mathrm{R}}(0),\n$$\n$$\n\\frac{D}{\\delta}\\,\\big(c_{\\mathrm{R}}(0) - c_{\\mathrm{R,bulk}}\\big) = k_{\\mathrm{c}}(E_{\\mathrm{s}})\\,c_{\\mathrm{O}}(0) - k_{\\mathrm{a}}(E_{\\mathrm{s}})\\,c_{\\mathrm{R}}(0).\n$$\n法拉第电流密度通过以下方式与净还原速率相关：\n$$\ni = F\\,\\Big(k_{\\mathrm{c}}(E_{\\mathrm{s}})\\,c_{\\mathrm{O}}(0) - k_{\\mathrm{a}}(E_{\\mathrm{s}})\\,c_{\\mathrm{R}}(0)\\Big).\n$$\n在给定的时间步，将 $E_{\\mathrm{app}}$ 视为已知，通过求解由上述两个界面质量平衡和电流关系式组成的非线性系统 $\\mathbf{R}(\\mathbf{x})=\\mathbf{0}$ 来计算未知向量 $\\mathbf{x} = \\big[c_{\\mathrm{O}}(0),\\,c_{\\mathrm{R}}(0),\\,i\\big]^{\\top}$。使用带有精确雅可比矩阵的 Newton–Raphson 迭代法，其中包含 $k_{\\mathrm{a}}(E_{\\mathrm{s}})$ 和 $k_{\\mathrm{c}}(E_{\\mathrm{s}})$ 通过 $i$ 对 $E_{\\mathrm{s}}$ 的依赖关系。为清晰起见，记 $f = F/(R T)$ 并注意 $E_{\\mathrm{s}} = E_{\\mathrm{app}} - i R_{\\mathrm{u}}$，因此\n$$\n\\frac{\\partial k_{\\mathrm{c}}}{\\partial i} = \\frac{\\partial k_{\\mathrm{c}}}{\\partial E_{\\mathrm{s}}}\\,\\frac{\\partial E_{\\mathrm{s}}}{\\partial i} = \\big(-\\alpha\\,f\\,k_{\\mathrm{c}}\\big)\\,\\big(-R_{\\mathrm{u}}\\big) = \\alpha\\,f\\,R_{\\mathrm{u}}\\,k_{\\mathrm{c}},\n$$\n$$\n\\frac{\\partial k_{\\mathrm{a}}}{\\partial i} = \\frac{\\partial k_{\\mathrm{a}}}{\\partial E_{\\mathrm{s}}}\\,\\frac{\\partial E_{\\mathrm{s}}}{\\partial i} = \\big(\\big(1-\\alpha\\big)\\,f\\,k_{\\mathrm{a}}\\big)\\,\\big(-R_{\\mathrm{u}}\\big) = -\\big(1-\\alpha\\big)\\,f\\,R_{\\mathrm{u}}\\,k_{\\mathrm{a}}.\n$$\n您的任务是实现一个完整、可运行的程序，该程序：\n- 为上述系统构建残差向量 $\\mathbf{R}(\\mathbf{x})$ 和雅可比矩阵 $\\mathbf{J}(\\mathbf{x})$。\n- 在每个指定的参数集下，使用阻尼 Newton–Raphson 方法求解 $\\mathbf{x}$，必要时通过回溯步长来减小残差范数并强制界面浓度为非负，以确保稳健性。\n- 返回以 $\\mathrm{A}\\,\\mathrm{m}^{-2}$ 为单位的法拉第电流密度 $i$。\n\n在国际单位制（SI）下使用以下物理常数和基线参数：$F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$，$R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T = 298\\,\\mathrm{K}$，$n = 1$，$E^{0} = 0\\,\\mathrm{V}$，$\\alpha = 0.5$，$D = 1.0\\times 10^{-9}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$，$\\delta = 1.0\\times 10^{-6}\\,\\mathrm{m}$，$k_{0} = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$c_{\\mathrm{O,bulk}} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$c_{\\mathrm{R,bulk}} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，除非测试用例覆盖了其中的一部分。\n\n测试套件。为以下四个参数集运行求解器，每个参数集代表一个具有指定外加电势和电阻的独立“时间步”：\n- 情况 A（准可逆，中等电阻）：$E_{\\mathrm{app}} = 0.0\\,\\mathrm{V}$，$R_{\\mathrm{u}} = 0.5\\,\\Omega\\,\\mathrm{m}^{2}$，默认 $k_{0}$，默认 $c_{\\mathrm{O,bulk}}$，默认 $c_{\\mathrm{R,bulk}}$。\n- 情况 B（阴极驱动，较大电阻）：$E_{\\mathrm{app}} = -0.2\\,\\mathrm{V}$，$R_{\\mathrm{u}} = 1.0\\,\\Omega\\,\\mathrm{m}^{2}$，默认 $k_{0}$，默认 $c_{\\mathrm{O,bulk}}$，默认 $c_{\\mathrm{R,bulk}}$。\n- 情况 C（阳极驱动，无未补偿电阻）：$E_{\\mathrm{app}} = 0.2\\,\\mathrm{V}$，$R_{\\mathrm{u}} = 0.0\\,\\Omega\\,\\mathrm{m}^{2}$，默认 $k_{0}$，默认 $c_{\\mathrm{O,bulk}}$，默认 $c_{\\mathrm{R,bulk}}$。\n- 情况 D（类不可逆，缓慢动力学）：$E_{\\mathrm{app}} = -0.2\\,\\mathrm{V}$，$R_{\\mathrm{u}} = 1.0\\,\\Omega\\,\\mathrm{m}^{2}$，$k_{0} = 1.0\\times 10^{-6}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，默认 $c_{\\mathrm{O,bulk}}$，默认 $c_{\\mathrm{R,bulk}}$。\n\n最终输出。您的程序应生成单行输出，其中包含四个法拉第电流密度，以 $\\mathrm{A}\\,\\mathrm{m}^{-2}$ 为单位表示，每个值四舍五入到6位小数，并以逗号分隔的列表形式用方括号括起来（例如，[$i_{\\mathrm{A}}, i_{\\mathrm{B}}, i_{\\mathrm{C}}, i_{\\mathrm{D}}]$）。",
            "solution": "该问题要求对一个描述电极表面非均相电化学反应稳态行为的耦合非线性方程组进行数值求解。该模型包含了用于反应速率的 Butler-Volmer 动力学、物种通过静态膜的 Fick 扩散以及未补偿电阻（$iR_{\\mathrm{u}}$ 压降）的影响。我们的任务是针对几组物理参数，找出氧化剂和还原剂的界面浓度 $c_{\\mathrm{O}}(0)$ 和 $c_{\\mathrm{R}}(0)$，以及法拉第电流密度 $i$。\n\n解是使用 Newton-Raphson 方法找到的，这是一种用于寻找非线性方程组根的迭代技术。我们定义一个未知向量 $\\mathbf{x} = \\big[c_{\\mathrm{O}}(0), c_{\\mathrm{R}}(0), i\\big]^{\\top}$ 和一个残差向量函数 $\\mathbf{R}(\\mathbf{x})$，当控制方程被满足时，其分量为零。然后，Newton-Raphson 迭代法旨在找到一个解 $\\mathbf{x}^*$，使得 $\\mathbf{R}(\\mathbf{x}^*) = \\mathbf{0}$。\n\n让我们将未知数表示为 $x_0 = c_{\\mathrm{O}}(0)$，$x_1 = c_{\\mathrm{R}}(0)$ 和 $x_2 = i$。待求解的三个方程组 $\\mathbf{R}(\\mathbf{x})=\\mathbf{0}$ 由两个质量平衡方程和一个电流密度定义组成。\n\n控制方程如下：\n1. 物种 $\\mathrm{O}$ 的界面质量平衡：朝向表面的扩散通量等于反应的净消耗速率。\n$$R_0(\\mathbf{x}) = \\frac{D}{\\delta}\\big(c_{\\mathrm{O,bulk}} - x_0\\big) - \\Big(k_{\\mathrm{c}}(x_2)\\,x_0 - k_{\\mathrm{a}}(x_2)\\,x_1\\Big) = 0$$\n2. 物种 $\\mathrm{R}$ 的界面质量平衡：离开表面的扩散通量等于反应的净生成速率。\n$$R_1(\\mathbf{x}) = \\frac{D}{\\delta}\\big(x_1 - c_{\\mathrm{R,bulk}}\\big) - \\Big(k_{\\mathrm{c}}(x_2)\\,x_0 - k_{\\mathrm{a}}(x_2)\\,x_1\\Big) = 0$$\n3. 法拉第电流密度的定义：\n$$R_2(\\mathbf{x}) = F\\,\\Big(k_{\\mathrm{c}}(x_2)\\,x_0 - k_{\\mathrm{a}}(x_2)\\,x_1\\Big) - x_2 = 0$$\n\n速率常数 $k_{\\mathrm{c}}$ 和 $k_{\\mathrm{a}}$ 依赖于表面电势 $E_{\\mathrm{s}}$，而 $E_{\\mathrm{s}}$ 又依赖于电流 $x_2$：$E_{\\mathrm{s}} = E_{\\mathrm{app}} - x_2 R_{\\mathrm{u}}$。Butler-Volmer 表达式为：\n$$k_{\\mathrm{c}}(x_2) = k_{0}\\,\\exp\\!\\left(-\\alpha\\,\\frac{F}{R T}\\,\\big(E_{\\mathrm{app}} - x_2 R_{\\mathrm{u}} - E^{0}\\big)\\right)$$\n$$k_{\\mathrm{a}}(x_2) = k_{0}\\,\\exp\\!\\left(\\big(1-\\alpha\\big)\\,\\frac{F}{R T}\\,\\big(E_{\\mathrm{app}} - x_2 R_{\\mathrm{u}} - E^{0}\\big)\\right)$$\n\nNewton-Raphson 方法从一个初始猜测 $\\mathbf{x}^{(0)}$ 开始，并使用以下更新规则迭代地对其进行改进：\n$$\\mathbf{x}^{(k+1)} = \\mathbf{x}^{(k)} + \\Delta\\mathbf{x}^{(k)}$$\n其中步长 $\\Delta\\mathbf{x}^{(k)}$ 是以下线性系统的解：\n$$\\mathbf{J}\\big(\\mathbf{x}^{(k)}\\big)\\,\\Delta\\mathbf{x}^{(k)} = -\\mathbf{R}\\big(\\mathbf{x}^{(k)}\\big)$$\n此处，$\\mathbf{J}$ 是雅可比矩阵，其元素为 $J_{ij} = \\partial R_i / \\partial x_j$。\n\n为了构建雅可比矩阵，我们必须计算残差分量关于每个未知数的偏导数。令 $k_d = D/\\delta$ 和 $f = F/(RT)$。所需的速率常数关于电流 ($x_2=i$) 的导数已给出：\n$$\\frac{\\partial k_{\\mathrm{c}}}{\\partial x_2} = \\alpha\\,f\\,R_{\\mathrm{u}}\\,k_{\\mathrm{c}}, \\qquad \\frac{\\partial k_{\\mathrm{a}}}{\\partial x_2} = -(1-\\alpha)\\,f\\,R_{\\mathrm{u}}\\,k_{\\mathrm{a}}$$\n雅可比矩阵 $\\mathbf{J}$ 的元素为：\n$J_{00} = \\frac{\\partial R_0}{\\partial x_0} = -k_d - k_{\\mathrm{c}}$\n$J_{01} = \\frac{\\partial R_0}{\\partial x_1} = k_{\\mathrm{a}}$\n$J_{02} = \\frac{\\partial R_0}{\\partial x_2} = -\\left(\\frac{\\partial k_{\\mathrm{c}}}{\\partial x_2}x_0 - \\frac{\\partial k_{\\mathrm{a}}}{\\partial x_2}x_1\\right) = -\\left(\\alpha f R_{\\mathrm{u}} k_{\\mathrm{c}} x_0 + (1-\\alpha) f R_{\\mathrm{u}} k_{\\mathrm{a}} x_1\\right)$\n\n$J_{10} = \\frac{\\partial R_1}{\\partial x_0} = -k_{\\mathrm{c}}$\n$J_{11} = \\frac{\\partial R_1}{\\partial x_1} = k_d + k_{\\mathrm{a}}$\n$J_{12} = \\frac{\\partial R_1}{\\partial x_2} = -\\left(\\frac{\\partial k_{\\mathrm{c}}}{\\partial x_2}x_0 - \\frac{\\partial k_{\\mathrm{a}}}{\\partial x_2}x_1\\right) = J_{02}$\n\n$J_{20} = \\frac{\\partial R_2}{\\partial x_0} = F k_{\\mathrm{c}}$\n$J_{21} = \\frac{\\partial R_2}{\\partial x_1} = -F k_{\\mathrm{a}}$\n$J_{22} = \\frac{\\partial R_2}{\\partial x_2} = F\\left(\\frac{\\partial k_{\\mathrm{c}}}{\\partial x_2}x_0 - \\frac{\\partial k_{\\mathrm{a}}}{\\partial x_2}x_1\\right) - 1 = F\\left(\\alpha f R_{\\mathrm{u}} k_{\\mathrm{c}} x_0 + (1-\\alpha) f R_{\\mathrm{u}} k_{\\mathrm{a}} x_1\\right) - 1$\n\n算法按以下步骤进行：\n1. 对每个测试用例，初始化未知向量 $\\mathbf{x}^{(0)} = [c_{\\mathrm{O,bulk}}, c_{\\mathrm{R,bulk}}, 0]^{\\top}$。\n2. 开始迭代循环（对于 $k=0, 1, 2, ...$）：\n    a. 在当前状态 $\\mathbf{x}^{(k)}$ 下，计算 $E_{\\mathrm{s}}$、$k_{\\mathrm{c}}$ 和 $k_{\\mathrm{a}}$。\n    b. 构建残差向量 $\\mathbf{R}(\\mathbf{x}^{(k)})$。\n    c. 如果欧几里得范数 $\\|\\mathbf{R}(\\mathbf{x}^{(k)})\\|_2$ 低于指定的容差（例如，$10^{-12}$），则解已收敛。终止循环。\n    d. 构建雅可比矩阵 $\\mathbf{J}(\\mathbf{x}^{(k)})$。\n    e. 求解线性系统 $\\mathbf{J}\\Delta\\mathbf{x}^{(k)} = -\\mathbf{R}(\\mathbf{x}^{(k)})$ 以获得牛顿步长 $\\Delta\\mathbf{x}^{(k)}$。\n    f. 实现回溯线搜索以确保稳健的更新。从步长因子 $\\lambda=1$ 开始。重复将 $\\lambda$ 减半，直到建议的更新 $\\mathbf{x}_{\\text{new}} = \\mathbf{x}^{(k)} + \\lambda\\Delta\\mathbf{x}^{(k)}$ 满足两个条件：\n        i. 非负浓度：$x_{0,\\text{new}} \\ge 0$ 和 $x_{1,\\text{new}} \\ge 0$。\n        ii. 残差充分减小：$\\|\\mathbf{R}(\\mathbf{x}_{\\text{new}})||_2  \\|\\mathbf{R}(\\mathbf{x}^{(k)})\\|_2$。\n    g. 执行更新：$\\mathbf{x}^{(k+1)} = \\mathbf{x}_{\\text{new}}$。\n3. 收敛后，最终向量的第三个分量 $x_2$ 即为所求的法拉第电流密度 $i$。对四个指定的测试用例中的每一个重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the faradaic current density in a diffusion-kinetics model\n    of an electrochemical reaction using a damped Newton-Raphson method.\n    \"\"\"\n    # Physical constants and baseline parameters in SI units\n    F = 96485.0  # Faraday constant (C/mol)\n    R = 8.314    # Gas constant (J/(mol*K))\n    T = 298.0    # Temperature (K)\n    E0 = 0.0     # Formal potential (V)\n    ALPHA = 0.5  # Charge transfer coefficient\n    D = 1.0e-9   # Diffusion coefficient (m^2/s)\n    DELTA = 1.0e-6 # Diffusion layer thickness (m)\n    K0_DEFAULT = 1.0e-3 # Default standard rate constant (m/s)\n    CO_BULK_DEFAULT = 1.0 # Default bulk concentration of O (mol/m^3)\n    CR_BULK_DEFAULT = 1.0 # Default bulk concentration of R (mol/m^3)\n\n    # Pre-calculated terms\n    f_const = F / (R * T)\n    k_d = D / DELTA\n\n    def solve_case(E_app, Ru, k0, cO_bulk, cR_bulk):\n        \"\"\"\n        Solves the nonlinear system for a single parameter set.\n        \"\"\"\n        # Initial guess for x = [cO_surf, cR_surf, i]\n        x = np.array([cO_bulk, cR_bulk, 0.0])\n\n        max_iter = 100\n        tolerance = 1e-12\n        \n        for k_iter in range(max_iter):\n            cO_surf, cR_surf, i = x\n\n            # Calculate state-dependent variables\n            E_s = E_app - i * Ru\n            kc = k0 * np.exp(-ALPHA * f_const * (E_s - E0))\n            ka = k0 * np.exp((1 - ALPHA) * f_const * (E_s - E0))\n\n            # Assemble the residual vector R(x)\n            reaction_rate = kc * cO_surf - ka * cR_surf\n            R_vec = np.array([\n                k_d * (cO_bulk - cO_surf) - reaction_rate,\n                k_d * (cR_surf - cR_bulk) - reaction_rate,\n                F * reaction_rate - i\n            ])\n\n            # Check for convergence\n            residual_norm = np.linalg.norm(R_vec)\n            if residual_norm  tolerance:\n                break\n\n            # Calculate the Jacobian matrix J(x)\n            d_kc_di = ALPHA * f_const * Ru * kc\n            d_ka_di = -(1 - ALPHA) * f_const * Ru * ka\n            \n            dk_term = d_kc_di * cO_surf - d_ka_di * cR_surf\n\n            J_mat = np.array([\n                [-k_d - kc, ka, -dk_term],\n                [-kc, k_d + ka, -dk_term],\n                [F * kc, -F * ka, F * dk_term - 1]\n            ])\n\n            # Solve the linear system J * delta_x = -R\n            try:\n                delta_x = np.linalg.solve(J_mat, -R_vec)\n            except np.linalg.LinAlgError:\n                # Jacobian is singular, break iteration\n                break\n\n            # Backtracking line search for step damping and non-negativity\n            lambd = 1.0\n            for _ in range(20): # Max backtracking steps\n                x_new = x + lambd * delta_x\n                \n                # Enforce non-negative concentrations\n                if x_new[0]  0 or x_new[1]  0:\n                    lambd /= 2.0\n                    continue\n\n                # Check for reduction in residual norm\n                cO_surf_new, cR_surf_new, i_new = x_new\n                E_s_new = E_app - i_new * Ru\n                kc_new = k0 * np.exp(-ALPHA * f_const * (E_s_new - E0))\n                ka_new = k0 * np.exp((1 - ALPHA) * f_const * (E_s_new - E0))\n                \n                reaction_rate_new = kc_new * cO_surf_new - ka_new * cR_surf_new\n                R_vec_new = np.array([\n                    k_d * (cO_bulk - cO_surf_new) - reaction_rate_new,\n                    k_d * (cR_surf_new - cR_bulk) - reaction_rate_new,\n                    F * reaction_rate_new - i_new\n                ])\n\n                if np.linalg.norm(R_vec_new)  residual_norm:\n                    break  # Step is accepted\n                \n                lambd /= 2.0\n            else:\n                # Backtracking failed to find a better step\n                break\n            \n            x = x + lambd * delta_x\n        \n        return x[2]\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case A: E_app=0.0V, Ru=0.5 Ohm*m^2\n        {'E_app': 0.0, 'Ru': 0.5, 'k0': K0_DEFAULT, 'cO_bulk': CO_BULK_DEFAULT, 'cR_bulk': CR_BULK_DEFAULT},\n        # Case B: E_app=-0.2V, Ru=1.0 Ohm*m^2\n        {'E_app': -0.2, 'Ru': 1.0, 'k0': K0_DEFAULT, 'cO_bulk': CO_BULK_DEFAULT, 'cR_bulk': CR_BULK_DEFAULT},\n        # Case C: E_app=0.2V, Ru=0.0 Ohm*m^2\n        {'E_app': 0.2, 'Ru': 0.0, 'k0': K0_DEFAULT, 'cO_bulk': CO_BULK_DEFAULT, 'cR_bulk': CR_BULK_DEFAULT},\n        # Case D: E_app=-0.2V, Ru=1.0 Ohm*m^2, k0=1e-6 m/s\n        {'E_app': -0.2, 'Ru': 1.0, 'k0': 1e-6, 'cO_bulk': CO_BULK_DEFAULT, 'cR_bulk': CR_BULK_DEFAULT},\n    ]\n\n    results = []\n    for case in test_cases:\n        current = solve_case(**case)\n        results.append(f\"{current:.6f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}