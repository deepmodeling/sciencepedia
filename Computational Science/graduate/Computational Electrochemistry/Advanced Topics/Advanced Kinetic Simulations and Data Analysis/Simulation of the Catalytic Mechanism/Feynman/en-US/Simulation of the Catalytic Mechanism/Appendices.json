{
    "hands_on_practices": [
        {
            "introduction": "Before constructing a full-scale numerical simulation, it is invaluable to perform a scaling analysis to understand the fundamental physical dimensions of the system. This practice guides you through the derivation of the characteristic reaction penetration depth, $\\delta_c$, for an EC' mechanism by balancing reaction and diffusion rates . Calculating this length provides crucial intuition about how far the catalytic process extends from the electrode, defining the \"action zone\" that your simulation grid must resolve.",
            "id": "4258100",
            "problem": "A planar electrode at $x=0$ is immersed in a semi-infinite electrolyte ($x>0$) containing an excess of a chemical substrate. The electrocatalytic cycle follows an Electrochemical–Chemical regeneration (EC') mechanism: the electrode generates a reactive mediator species $R$ at $x=0$, and $R$ diffuses into the solution while undergoing a bimolecular chemical reaction with the substrate $B$ that regenerates the oxidized mediator $O$. The chemical step is second order with rate constant $k$ and bulk substrate concentration $C_{b}$ that remains effectively constant in the diffusion layer due to large excess. The mediator has diffusion coefficient $D$.\n\nUnder steady-state conditions and assuming one-dimensional transport normal to the electrode, derive a scaling expression for the characteristic reaction penetration depth $\\delta_{c}$ of the reactive zone by starting from the reaction–diffusion balance for $R$ and the pseudo-first-order reduction of the bimolecular rate in the presence of excess $B$. Then, using the provided parameters, compute the numerical value of $\\delta_{c}$.\n\nUse the following data:\n- $k = 2.0 \\times 10^{6}$ in units of molarity inverse per second (M$^{-1}$ s$^{-1}$).\n- $C_{b} = 0.50$ millimolar (mM).\n- $D = 8.0 \\times 10^{-6}$ square centimeters per second (cm$^{2}$ s$^{-1}$).\n\nInstructions:\n- Express the final numerical value of $\\delta_{c}$ in micrometers.\n- Round your final answer to three significant figures.\n- The reported answer must be a single real-valued number.",
            "solution": "The problem requires the derivation of a scaling expression for the characteristic reaction penetration depth, denoted $\\delta_c$, for a species $R$ involved in an EC' catalytic mechanism. This depth is determined by the balance between diffusion and chemical reaction under steady-state conditions.\n\nLet $C_R(x)$ represent the concentration of the reactive mediator species $R$ at a distance $x$ from the planar electrode surface at $x=0$. The process is governed by a one-dimensional, steady-state reaction-diffusion equation. The general form of this equation is:\n$$ (\\text{Net rate of change of } C_R) = (\\text{Diffusion}) - (\\text{Reaction}) $$\nUnder steady-state conditions, the net rate of change is zero, leading to a balance between the diffusion and reaction terms:\n$$ D \\frac{d^2 C_R}{dx^2} - R_{chem} = 0 $$\nwhere $D$ is the diffusion coefficient of $R$ and $R_{chem}$ is the rate of consumption of $R$ by the chemical reaction.\n\nThe problem states that the chemical step is a second-order bimolecular reaction between the mediator $R$ and the substrate $B$, with a rate constant $k$. The reaction rate is given by:\n$$ R_{chem} = k C_R C_B $$\nwhere $C_B$ is the concentration of the substrate. A crucial condition is that the substrate $B$ is present in large excess, which implies that its concentration in the diffusion layer remains effectively constant and equal to its bulk concentration, $C_b$. This allows the simplification of the second-order kinetics to a pseudo-first-order process with respect to $R$:\n$$ R_{chem} \\approx k C_R C_b = k' C_R $$\nHere, $k' = k C_b$ is the pseudo-first-order rate constant.\n\nSubstituting this pseudo-first-order rate expression into the steady-state diffusion equation yields the governing ordinary differential equation for $C_R(x)$:\n$$ D \\frac{d^2 C_R}{dx^2} - (k C_b) C_R = 0 $$\nTo find the characteristic reaction penetration depth, $\\delta_c$, we perform a scaling analysis. This length scale represents the distance over which the concentration of $R$ decays significantly due to the reaction. We balance the magnitude of the diffusion term with the reaction term. Let $C_{R,0}$ be a characteristic concentration of $R$ (e.g., at the electrode surface). The terms are scaled as follows:\n$$ \\text{Diffusion Term: } D \\frac{d^2 C_R}{dx^2} \\sim D \\frac{C_{R,0}}{\\delta_c^2} $$\n$$ \\text{Reaction Term: } (k C_b) C_R \\sim (k C_b) C_{R,0} $$\nAt the characteristic length $\\delta_c$, these two terms are of the same order of magnitude:\n$$ D \\frac{C_{R,0}}{\\delta_c^2} \\sim (k C_b) C_{R,0} $$\nThe characteristic concentration $C_{R,0}$ cancels from both sides, leaving a relationship for $\\delta_c$:\n$$ \\frac{D}{\\delta_c^2} \\sim k C_b $$\nSolving for $\\delta_c$ gives the scaling expression for the reaction penetration depth:\n$$ \\delta_c = \\sqrt{\\frac{D}{k C_b}} $$\nThis expression defines the length scale where the characteristic time for diffusion, $\\tau_d \\sim \\delta_c^2/D$, is comparable to the characteristic time for reaction, $\\tau_r \\sim 1/(k C_b)$.\n\nNext, we compute the numerical value of $\\delta_c$ using the provided data. It is imperative to work with a consistent set of units. Let us use centimeters (cm), moles (mol), and seconds (s).\n\nThe given parameters are:\n- $D = 8.0 \\times 10^{-6}$ cm$^{2}$ s$^{-1}$\n- $k = 2.0 \\times 10^{6}$ M$^{-1}$ s$^{-1}$\n- $C_{b} = 0.50$ mM\n\nWe must convert the units for $k$ and $C_b$ to be consistent with $D$.\nThe unit of molarity, M, is mol L$^{-1}$.\nThe rate constant $k$ is $2.0 \\times 10^{6}$ L mol$^{-1}$ s$^{-1}$. Since $1 \\text{ L} = 1000 \\text{ cm}^3$, we convert $k$:\n$$ k = 2.0 \\times 10^{6} \\frac{\\text{L}}{\\text{mol} \\cdot \\text{s}} \\times \\frac{1000 \\text{ cm}^3}{1 \\text{ L}} = 2.0 \\times 10^{9} \\text{ cm}^3 \\text{ mol}^{-1} \\text{ s}^{-1} $$\nThe bulk concentration $C_b$ is $0.50$ mM, which is $0.50 \\times 10^{-3}$ M or $0.50 \\times 10^{-3}$ mol L$^{-1}$. We convert this to mol cm$^{-3}$:\n$$ C_b = 0.50 \\times 10^{-3} \\frac{\\text{mol}}{\\text{L}} \\times \\frac{1 \\text{ L}}{1000 \\text{ cm}^3} = 0.50 \\times 10^{-6} \\text{ mol cm}^{-3} = 5.0 \\times 10^{-7} \\text{ mol cm}^{-3} $$\nNow, we can calculate the product $k C_b$, which is the pseudo-first-order rate constant $k'$:\n$$ k' = k C_b = (2.0 \\times 10^{9} \\text{ cm}^3 \\text{ mol}^{-1} \\text{ s}^{-1}) \\times (5.0 \\times 10^{-7} \\text{ mol cm}^{-3}) = 1.0 \\times 10^3 \\text{ s}^{-1} $$\nThe units of $k'$ are inverse seconds, s$^{-1}$, as expected for a first-order rate constant.\n\nWe substitute the values of $D$ and $k C_b$ into the expression for $\\delta_c$:\n$$ \\delta_c = \\sqrt{\\frac{D}{k C_b}} = \\sqrt{\\frac{8.0 \\times 10^{-6} \\text{ cm}^2 \\text{ s}^{-1}}{1.0 \\times 10^3 \\text{ s}^{-1}}} $$\n$$ \\delta_c = \\sqrt{8.0 \\times 10^{-9} \\text{ cm}^2} $$\nTo simplify the calculation of the square root, we can write this as:\n$$ \\delta_c = \\sqrt{80 \\times 10^{-10} \\text{ cm}^2} = \\sqrt{80} \\times 10^{-5} \\text{ cm} $$\nThe value of $\\sqrt{80}$ is approximately $8.94427$.\n$$ \\delta_c \\approx 8.94427 \\times 10^{-5} \\text{ cm} $$\nThe problem asks for the final answer in micrometers ($\\mu$m). We use the conversion factor $1 \\text{ cm} = 10^4 \\text{ } \\mu\\text{m}$:\n$$ \\delta_c \\approx (8.94427 \\times 10^{-5} \\text{ cm}) \\times \\frac{10^4 \\text{ } \\mu\\text{m}}{1 \\text{ cm}} = 8.94427 \\times 10^{-1} \\text{ } \\mu\\text{m} = 0.894427 \\text{ } \\mu\\text{m} $$\nFinally, we round the result to three significant figures as instructed:\n$$ \\delta_c \\approx 0.894 \\text{ } \\mu\\text{m} $$",
            "answer": "$$\n\\boxed{0.894}\n$$"
        },
        {
            "introduction": "The competition between chemical reaction and mass transport is not static; it is highly dependent on the timescale of the electrochemical experiment. This exercise explores this dynamic interplay through the lens of the chemical Damköhler number, $\\mathrm{Da}_{chem}$, a dimensionless group that compares the rate of catalysis to the rate of diffusion . By analyzing the system's behavior in the limits of high and low $\\mathrm{Da}_{chem}$, you will learn to predict how a cyclic voltammogram transitions from a classic diffusion-controlled peak to a signature catalytic plateau, a crucial skill for interpreting experimental data.",
            "id": "4258143",
            "problem": "Consider a planar macroelectrode immersed in a solution containing an oxidized electroactive species $O$ at bulk concentration $C_{O,b}$ (with reduced species $R$ initially absent) and a substrate $S$ at uniform bulk concentration $C_S$. The electrochemical mechanism is electron transfer (E) followed by a catalytic chemical reaction (C′), denoted EC′, with steps\n$$\nO + e^- \\rightleftharpoons R \\quad \\text{(reversible at the electrode)}\n$$\n$$\nR + S \\xrightarrow{k} O + P \\quad \\text{(homogeneous catalysis in solution, pseudo-first-order in $R$)}\n$$\nAssume semi-infinite planar diffusion, $D_O = D_R = D$ (with $D$ constant), and that the electron transfer is reversible so that the surface concentrations of $O$ and $R$ adjust quasi-instantaneously to the applied potential $E(t)$ under cyclic voltammetry with scan rate $v$. The homogeneous catalytic step is modeled as pseudo-first-order in $R$ with effective rate $k' = k\\,C_S$, where $k$ is the bimolecular rate constant.\n\nThe spatiotemporal evolution of concentrations obeys Fick’s second law with source terms:\n$$\n\\frac{\\partial C_O}{\\partial t} = D \\frac{\\partial^2 C_O}{\\partial x^2} + k' C_R, \\qquad \\frac{\\partial C_R}{\\partial t} = D \\frac{\\partial^2 C_R}{\\partial x^2} - k' C_R,\n$$\nwith semi-infinite boundary conditions as $x \\to \\infty$, and reversible interfacial electron transfer relating $C_O(0,t)$ and $C_R(0,t)$ via the Nernst condition. The faradaic current $i(t)$ is proportional to the interfacial flux of $O$ reduced to $R$.\n\nDefine the chemical Damköhler number (Da), which compares the rate of homogeneous catalysis to diffusive transport over a characteristic diffusion-layer thickness, as\n$$\n\\mathrm{Da}_{chem} = \\frac{k' \\,\\delta^2}{D},\n$$\nwith $\\delta$ the characteristic diffusion-layer thickness established during the voltammetric excursion around the formal potential (you may assume $\\delta$ is set by diffusion over the characteristic timescale set by $v$). Analyze the two limiting regimes $\\mathrm{Da}_{chem} \\ll 1$ and $\\mathrm{Da}_{chem} \\gg 1$, and predict qualitative changes in the current magnitude and the voltammogram waveform shape as the system transitions between these regimes.\n\nWhich statement best describes the expected behavior?\n\nA. When $\\mathrm{Da}_{chem} \\ll 1$, the current waveform is peak-shaped and the peak current scales with $\\sqrt{v}$; when $\\mathrm{Da}_{chem} \\gg 1$, the current rises to a catalytic plateau that is approximately independent of $v$, producing an $S$-shaped voltammogram with a suppressed reverse peak.\n\nB. When $\\mathrm{Da}_{chem} \\ll 1$, the current is scan-rate-independent and exhibits a plateau due to diffusion control; when $\\mathrm{Da}_{chem} \\gg 1$, the current returns to a peak-shaped waveform with peak magnitude scaling like $\\sqrt{v}$.\n\nC. When $\\mathrm{Da}_{chem} \\ll 1$, homogeneous catalysis depletes $O$ in the bulk so the current vanishes; when $\\mathrm{Da}_{chem} \\gg 1$, feedback from rapid catalysis causes oscillatory voltammograms around the formal potential.\n\nD. When $\\mathrm{Da}_{chem} \\ll 1$, the faradaic current scales linearly with $v$ because the electron transfer step is rate limiting, yielding a sharp peak; when $\\mathrm{Da}_{chem} \\gg 1$, the current shows a plateau but decreases with $v$ approximately as $1/\\sqrt{v}$, producing a distorted peak.",
            "solution": "### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem statement provides the following information:\n- **System:** A planar macroelectrode immersed in a solution.\n- **Species:** Oxidized species $O$ with bulk concentration $C_{O,b}$, reduced species $R$ (initially absent), substrate $S$ with uniform bulk concentration $C_S$.\n- **Mechanism:** An electron transfer (E) followed by a catalytic chemical reaction (C'), denoted EC'.\n  $$\n  O + e^- \\rightleftharpoons R \\quad \\text{(reversible at the electrode)}\n  $$\n  $$\n  R + S \\xrightarrow{k} O + P \\quad \\text{(homogeneous catalysis in solution, pseudo-first-order in $R$)}\n  $$\n- **Assumptions:**\n  1. Semi-infinite planar diffusion.\n  2. Equal diffusion coefficients: $D_O = D_R = D$, with $D$ constant.\n  3. Reversible electron transfer, with surface concentrations $C_O(0,t)$ and $C_R(0,t)$ governed by the Nernst condition for the applied potential $E(t)$.\n  4. The catalytic step is pseudo-first-order in $R$ with an effective rate constant $k' = k\\,C_S$.\n- **Experiment:** Cyclic voltammetry with scan rate $v$.\n- **Governing Equations:**\n  $$\n  \\frac{\\partial C_O}{\\partial t} = D \\frac{\\partial^2 C_O}{\\partial x^2} + k' C_R\n  $$\n  $$\n  \\frac{\\partial C_R}{\\partial t} = D \\frac{\\partial^2 C_R}{\\partial x^2} - k' C_R\n  $$\n- **Boundary Conditions:** Semi-infinite conditions as $x \\to \\infty$.\n- **Measured Quantity:** Faradaic current $i(t)$ proportional to the interfacial flux of $O$.\n- **Definition:** Chemical Damköhler number $\\mathrm{Da}_{chem} = \\frac{k' \\,\\delta^2}{D}$, where $\\delta$ is the characteristic diffusion-layer thickness set by the voltammetric timescale.\n- **Question:** Analyze the limiting regimes $\\mathrm{Da}_{chem} \\ll 1$ and $\\mathrm{Da}_{chem} \\gg 1$ to predict qualitative changes in the current magnitude and voltammogram shape.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is evaluated against the validation criteria:\n- **Scientifically Grounded:** The problem describes the EC' mechanism, a canonical model in electrochemistry. The governing equations are the standard reaction-diffusion equations (Fick's second law with source/sink terms). The assumptions of planar diffusion, reversible electron transfer, and equal diffusion coefficients are standard for developing an analytical or semi-analytical understanding of such systems. The physics and chemistry are sound.\n- **Well-Posed:** The problem provides a set of partial differential equations with specified physical processes and asks for a qualitative analysis of the behavior in two limiting cases of a defined dimensionless number. This is a well-posed physical problem that admits a clear, unique, and meaningful qualitative solution.\n- **Objective:** The language is formal, precise, and devoid of ambiguity or subjectivity. It uses established terminology from the field of electrochemistry.\n\nThe problem does not exhibit any of the flaws listed in the instructions. It is scientifically sound, well-posed, and objective.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation of Solution\n\nThe problem requires an analysis of the behavior of an EC' catalytic mechanism in cyclic voltammetry, focusing on the limiting cases defined by the chemical Damköhler number, $\\mathrm{Da}_{chem}$.\n\nFirst, we must understand the physical meaning of the Damköhler number in this context. The characteristic timescale of the voltammetric experiment is related to the scan rate, $v$. A common definition for this timescale is $\\tau_{CV} = \\frac{RT}{Fv}$, which represents the time required to scan through a potential range of $\\frac{RT}{F}$ (approximately $25.7\\,\\mathrm{mV}$ at $298\\,\\mathrm{K}$). The diffusion layer thickness, $\\delta$, that develops over this timescale is given by the Einstein-Smoluchowski relation, $\\delta \\approx \\sqrt{D \\tau_{CV}}$.\n\nSubstituting this into the definition of the Damköhler number:\n$$\n\\mathrm{Da}_{chem} = \\frac{k' \\delta^2}{D} \\approx \\frac{k' (D \\tau_{CV})}{D} = k' \\tau_{CV} = \\frac{k' RT}{Fv}\n$$\nThe Damköhler number $\\mathrm{Da}_{chem}$ can be interpreted as the ratio of the characteristic timescale of diffusion (or the experiment, $\\tau_{CV}$) to the characteristic timescale of the chemical reaction, $\\tau_{rxn} = 1/k'$. Thus, $\\mathrm{Da}_{chem} = \\tau_{CV} / \\tau_{rxn}$. This relationship shows that $\\mathrm{Da}_{chem}$ is inversely proportional to the scan rate $v$.\n- A high scan rate ($v \\to \\infty$) corresponds to $\\mathrm{Da}_{chem} \\to 0$.\n- A low scan rate ($v \\to 0$) corresponds to $\\mathrm{Da}_{chem} \\to \\infty$.\n\nWe now analyze the two limiting regimes.\n\n**Regime 1: $\\mathrm{Da}_{chem} \\ll 1$ (Fast Scan Rate)**\n\nIn this limit, $\\tau_{CV} \\ll \\tau_{rxn}$, meaning the experiment is very fast compared to the chemical reaction. The reduced species $R$, produced at the electrode surface via $O + e^- \\to R$, does not have sufficient time to react with the substrate $S$ before the potential scan is reversed. The catalytic step, $R + S \\to O + P$, is kinetically insignificant on the timescale of the measurement.\n\nConsequently, the system behaves as if the chemical step is absent. The mechanism effectively reduces to a simple, reversible one-electron transfer:\n$$\nO + e^- \\rightleftharpoons R\n$$\nFor a reversible electron transfer with semi-infinite diffusion, the cyclic voltammogram is well-known. It exhibits a peak-shaped wave on the forward scan. According to the Randles-Sevcik equation, the peak current, $i_p$, is proportional to the square root of the scan rate:\n$$\ni_p = (2.69 \\times 10^5) n^{3/2} A D^{1/2} C_{O,b} v^{1/2}\n$$\nwhere $n=1$. Thus, $i_p \\propto \\sqrt{v}$. On the reverse scan, a corresponding peak for the re-oxidation of $R$ to $O$ appears, with a peak current ratio $|i_{pa}/i_{pc}|$ close to $1$. The voltammetry is under diffusion control.\n\n**Regime 2: $\\mathrm{Da}_{chem} \\gg 1$ (Slow Scan Rate)**\n\nIn this limit, $\\tau_{CV} \\gg \\tau_{rxn}$, meaning the chemical reaction is very fast compared to the experimental timescale. As soon as the species $R$ is formed at the electrode, it is rapidly consumed by the catalytic reaction, regenerating the starting species $O$:\n$$\nR + S \\xrightarrow{\\text{fast}} O + P\n$$\nThis catalytic cycle ($O \\to R \\to O$) effectively increases the flux of $O$ towards the electrode surface, leading to a significant enhancement of the current compared to the diffusion-only case. The rapid regeneration of $O$ and consumption of $R$ establishes a steady-state reaction layer near the electrode.\n\nThis steady-state behavior fundamentally changes the shape of the voltammogram. Instead of a peak (which results from depletion of the reactant near the electrode), the current rises to a limiting plateau value, $i_{cat}$, as the potential becomes sufficiently negative. The shape of the voltammogram becomes sigmoidal, or 'S'-shaped. The magnitude of this catalytic plateau current is determined by the balance between diffusion of $O$ from the bulk and the rate of the catalytic reaction. For a planar electrode, the limiting catalytic current is given by:\n$$\ni_{cat} = n F A C_{O,b} \\sqrt{D k'}\n$$\nCrucially, this expression for $i_{cat}$ is **independent of the scan rate $v$**. Furthermore, because $R$ is rapidly consumed in the catalytic step, its concentration near the electrode is very low, leaving little to be re-oxidized on the reverse scan. As a result, the reverse peak is strongly suppressed or completely absent.\n\n### Evaluation of Options\n\n**A. When $\\mathrm{Da}_{chem} \\ll 1$, the current waveform is peak-shaped and the peak current scales with $\\sqrt{v}$; when $\\mathrm{Da}_{chem} \\gg 1$, the current rises to a catalytic plateau that is approximately independent of $v$, producing an $S$-shaped voltammogram with a suppressed reverse peak.**\n\nThis statement accurately captures the behavior in both limiting regimes as derived above.\n- For $\\mathrm{Da}_{chem} \\ll 1$ (fast scan), it correctly identifies the peak-shaped, diffusion-controlled response with $i_p \\propto \\sqrt{v}$.\n- For $\\mathrm{Da}_{chem} \\gg 1$ (slow scan), it correctly describes the catalytic plateau current (independent of $v$), the S-shaped waveform, and the suppression of the reverse peak.\n**Verdict: Correct.**\n\n**B. When $\\mathrm{Da}_{chem} \\ll 1$, the current is scan-rate-independent and exhibits a plateau due to diffusion control; when $\\mathrm{Da}_{chem} \\gg 1$, the current returns to a peak-shaped waveform with peak magnitude scaling like $\\sqrt{v}$.**\n\nThis statement incorrectly reverses the characteristics of the two regimes. The $\\mathrm{Da}_{chem} \\ll 1$ limit is diffusion-controlled and thus scan-rate dependent ($i_p \\propto \\sqrt{v}$) with a peak shape. The $\\mathrm{Da}_{chem} \\gg 1$ limit is the catalytic regime, which exhibits a plateau and is scan-rate independent.\n**Verdict: Incorrect.**\n\n**C. When $\\mathrm{Da}_{chem} \\ll 1$, homogeneous catalysis depletes $O$ in the bulk so the current vanishes; when $\\mathrm{Da}_{chem} \\gg 1$, feedback from rapid catalysis causes oscillatory voltammograms around the formal potential.**\n\nThis statement is factually incorrect. In the $\\mathrm{Da}_{chem} \\ll 1$ limit, the catalysis is too slow to have a major effect, and it regenerates $O$, not depletes it. The current does not vanish; it follows the Randles-Sevcik equation. In the $\\mathrm{Da}_{chem} \\gg 1$ limit, the standard EC' mechanism leads to a stable catalytic plateau, not oscillations.\n**Verdict: Incorrect.**\n\n**D. When $\\mathrm{Da}_{chem} \\ll 1$, the faradaic current scales linearly with $v$ because the electron transfer step is rate limiting, yielding a sharp peak; when $\\mathrm{Da}_{chem} \\gg 1$, the current shows a plateau but decreases with $v$ approximately as $1/\\sqrt{v}$, producing a distorted peak.**\n\nThis statement contains multiple errors. In the $\\mathrm{Da}_{chem} \\ll 1$ limit, a diffusion-controlled current scales with $\\sqrt{v}$, not $v$. A linear dependence on $v$ is typical for surface-adsorbed species. The problem states the electron transfer is reversible, not rate-limiting. In the $\\mathrm{Da}_{chem} \\gg 1$ limit, the ideal catalytic plateau current is independent of $v$, it does not decrease with $1/\\sqrt{v}$.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A computational model is only as reliable as its implementation is correct, making code verification an indispensable step in simulation. This practice guides you through this foundational process by testing a numerical solver against a known analytical solution in a limiting case . You will confirm that your model for the EC' mechanism correctly reproduces the Cottrell equation when the catalytic rate is set to zero, and you will quantify the convergence of the numerical error through a grid refinement study, a cornerstone of good scientific computing practice.",
            "id": "4258190",
            "problem": "Consider the catalytic electron transfer followed by chemical reaction (EC' mechanism) under planar chronoamperometry following a potential step at time $t=0$ to a transport-limited condition. The electrogenerated species $B$ catalyzes regeneration of $A$ via a homogeneous first-order reaction with pseudo-first-order rate constant $k'$. In the limit $k'=0$, the coupled system reduces to pure diffusion of $A$ with $B$ remaining nonreactive. Use the one-dimensional, planar, semi-infinite diffusion model with coordinate $x \\ge 0$ and the following governing equations, initial conditions, and boundary conditions derived from the conservation of mass and Fick's laws of diffusion.\n\nFundamental base:\n- Fick's second law for species $A$: $$\\frac{\\partial C_A(x,t)}{\\partial t} = D_A \\frac{\\partial^2 C_A(x,t)}{\\partial x^2} + k' C_B(x,t).$$\n- Fick's second law for species $B$: $$\\frac{\\partial C_B(x,t)}{\\partial t} = D_B \\frac{\\partial^2 C_B(x,t)}{\\partial x^2} - k' C_B(x,t).$$\n- Initial conditions: $$C_A(x,0)=C_A^\\ast,\\quad C_B(x,0)=0.$$\n- Electrode boundary at $x=0$ for a transport-limited potential step ($t>0$): $$C_A(0,t)=0.$$ Mass conservation at the interface dictates equality of fluxes with stoichiometry $A + e^- \\to B$: $$-D_A \\left.\\frac{\\partial C_A}{\\partial x}\\right|_{x=0} = -D_B \\left.\\frac{\\partial C_B}{\\partial x}\\right|_{x=0}.$$\n- Semi-infinite bulk boundary at $x \\to \\infty$ (numerically approximated by a finite domain $x \\in [0,L]$ with sufficiently large $L$): $$C_A(L,t)=C_A^\\ast,\\quad C_B(L,t)=0.$$\n- Faraday's law gives the chronoamperometric current for $n$ electrons transferred per molecule at electrode area $A_{\\mathrm{el}}$: $$i(t) = n F A_{\\mathrm{el}}\\, j_A(t),\\quad j_A(t) = -D_A \\left.\\frac{\\partial C_A}{\\partial x}\\right|_{x=0}.$$\n\nValidation target in the limit $k'=0$:\n- When $k'=0$ and the electrode boundary condition is $C_A(0,t)=0$ with $C_A(x,0)=C_A^\\ast$, the analytical current is the Cottrell equation, a well-tested formula: $$i_{\\mathrm{Cottrell}}(t) = n F A_{\\mathrm{el}}\\, C_A^\\ast\\, \\sqrt{\\frac{D_A}{\\pi t}}.$$\n\nYour task is to implement a numerical solver that, in the limit $k'=0$, solves the diffusion of $A$ under the stated conditions, computes the time-dependent current $i_{\\mathrm{num}}(t)$, and validates it against $i_{\\mathrm{Cottrell}}(t)$ by performing a grid refinement study. You must use a second-order accurate method in both space and time for the diffusion equation and a second-order one-sided approximation of the derivative at $x=0$ to compute the flux. The numerical domain is truncated to $x \\in [0,L]$ with Dirichlet boundary conditions at $x=L$ consistent with the bulk. Quantify the numerical error as the maximum absolute relative error over the time interval $t \\in (0,t_{\\max}]$:\n$$\\varepsilon = \\max_{t \\in \\mathcal{T}} \\left| \\frac{i_{\\mathrm{num}}(t) - i_{\\mathrm{Cottrell}}(t)}{i_{\\mathrm{Cottrell}}(t)} \\right|,$$\nwhere $\\mathcal{T}$ is the discrete set of time points used by your numerical scheme, excluding $t=0$.\n\nPhysical units and constants:\n- Diffusion coefficient $D_A$ in $\\mathrm{m^2/s}$.\n- Bulk concentration $C_A^\\ast$ in $\\mathrm{mol/m^3}$.\n- Electrode area $A_{\\mathrm{el}}$ in $\\mathrm{m^2}$.\n- Faraday constant $F$ in $\\mathrm{C/mol}$.\n- Time $t$ in $\\mathrm{s}$.\nAll currents $i$ must be computed in $\\mathrm{A}$, and report the error $\\varepsilon$ as a unitless decimal.\n\nNumerical method requirements:\n- Spatial discretization must be second-order accurate using a uniform grid $x_i = i\\,\\Delta x$ for $i=0,1,\\dots,N-1$ with $\\Delta x = L/(N-1)$ and Dirichlet boundaries enforced at $x=0$ and $x=L$.\n- Time stepping must be second-order accurate and unconditionally stable for diffusion (e.g., Crank–Nicolson method).\n- The surface flux must be computed using the second-order forward difference at $x=0$: $$\\left.\\frac{\\partial C_A}{\\partial x}\\right|_{x=0} \\approx \\frac{-3 C_A(0,t) + 4 C_A(\\Delta x,t) - C_A(2\\Delta x,t)}{2\\Delta x}.$$\n- The numerical domain length $L$ must be large enough compared to the diffusion length $\\sqrt{D_A t_{\\max}}$ for accurate approximation of the semi-infinite boundary, except in the edge-case test.\n\nTest suite:\nUse the following physically consistent parameters for $k'=0$. In all cases take $n=1$, $F=96485$ $\\mathrm{C/mol}$, $A_{\\mathrm{el}}=10^{-4}$ $\\mathrm{m^2}$, $C_A^\\ast=1$ $\\mathrm{mol/m^3}$, $D_A=10^{-9}$ $\\mathrm{m^2/s}$. The time step and number of steps define $t_{\\max} = \\Delta t \\times N_t$.\n- Case $1$ (coarse grid, adequate domain): $L=10^{-3}$ $\\mathrm{m}$, $N=64$, $\\Delta t=10^{-4}$ $\\mathrm{s}$, $N_t=1000$.\n- Case $2$ (medium grid, adequate domain): $L=10^{-3}$ $\\mathrm{m}$, $N=128$, $\\Delta t=10^{-4}$ $\\mathrm{s}$, $N_t=1000$.\n- Case $3$ (fine grid, adequate domain): $L=10^{-3}$ $\\mathrm{m}$, $N=256$, $\\Delta t=10^{-4}$ $\\mathrm{s}$, $N_t=1000$.\n- Case $4$ (edge-case domain truncation to challenge semi-infinite assumption): $L=2\\times 10^{-5}$ $\\mathrm{m}$, $N=256$, $\\Delta t=10^{-4}$ $\\mathrm{s}$, $N_t=1000$.\n\nFinal output format:\nYour program should produce a single line of output containing the maximum absolute relative errors $\\varepsilon$ for the four cases, as a comma-separated list enclosed in square brackets, for example, $\\left[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4\\right]$, where each $\\varepsilon_i$ is a decimal in standard Python float format.",
            "solution": "The problem requires the numerical simulation of a one-dimensional diffusion process under chronoamperometric conditions and validation against an analytical solution. The governing partial differential equation (PDE) is derived from Fick's second law. The provided system describes a catalytic (EC') mechanism, but the task is to solve it in the limit where the catalytic rate constant $k'$ is zero.\n\nThe governing equations for species $A$ and $B$ are:\n$$ \\frac{\\partial C_A(x,t)}{\\partial t} = D_A \\frac{\\partial^2 C_A(x,t)}{\\partial x^2} + k' C_B(x,t) $$\n$$ \\frac{\\partial C_B(x,t)}{\\partial t} = D_B \\frac{\\partial^2 C_B(x,t)}{\\partial x^2} - k' C_B(x,t) $$\n\nFor the specified task, we set $k'=0$. The equation for species $A$ decouples from species $B$ and simplifies to the standard one-dimensional diffusion equation:\n$$ \\frac{\\partial C_A(x,t)}{\\partial t} = D_A \\frac{\\partial^2 C_A(x,t)}{\\partial x^2} $$\nLet's denote $C_A(x,t)$ by $C(x,t)$ and $D_A$ by $D$ for simplicity. The problem is thus to solve:\n$$ \\frac{\\partial C(x,t)}{\\partial t} = D \\frac{\\partial^2 C(x,t)}{\\partial x^2} $$\non the domain $x \\in [0, L]$ and $t \\in [0, t_{\\max}]$, with the following initial and boundary conditions:\n- Initial condition: $C(x,0) = C_A^\\ast$\n- Boundary conditions ($t>0$): $C(0,t) = 0$ and $C(L,t) = C_A^\\ast$\n\nTo solve this PDE numerically, we employ the Crank-Nicolson method, which is second-order accurate in both space and time and is unconditionally stable. We discretize the spatial domain into $N$ points, $x_i = i\\,\\Delta x$ for $i=0, 1, \\dots, N-1$, where $\\Delta x = L/(N-1)$. Time is discretized into steps of size $\\Delta t$, $t_j = j\\,\\Delta t$. Let $C_i^j$ be the numerical approximation of $C(x_i, t_j)$.\n\nThe Crank-Nicolson discretization of the PDE is:\n$$ \\frac{C_i^{j+1} - C_i^j}{\\Delta t} = \\frac{D}{2} \\left( \\frac{C_{i+1}^{j+1} - 2C_i^{j+1} + C_{i-1}^{j+1}}{(\\Delta x)^2} + \\frac{C_{i+1}^{j} - 2C_i^{j} + C_{i-1}^{j}}{(\\Delta x)^2} \\right) $$\nThis equation applies to the interior nodes of the spatial grid, i.e., for $i=1, 2, \\dots, N-2$.\nWe introduce the dimensionless parameter $\\alpha = \\frac{D \\Delta t}{2(\\Delta x)^2}$. Rearranging the equation to separate the unknown terms at time step $j+1$ (on the left-hand side) from the known terms at time step $j$ (on the right-hand side) yields:\n$$ -\\alpha C_{i-1}^{j+1} + (1+2\\alpha) C_i^{j+1} - \\alpha C_{i+1}^{j+1} = \\alpha C_{i-1}^{j} + (1-2\\alpha) C_i^{j} + \\alpha C_{i+1}^{j} $$\n\nThis set of equations for the interior nodes $i=1, \\dots, N-2$ forms a system of linear equations for the unknown concentrations $\\mathbf{c}^{j+1} = [C_1^{j+1}, C_2^{j+1}, \\dots, C_{N-2}^{j+1}]^T$. The system can be written in matrix form as:\n$$ \\mathbf{A} \\mathbf{c}^{j+1} = \\mathbf{d}^j $$\nwhere $\\mathbf{A}$ is a symmetric, tridiagonal $(N-2) \\times (N-2)$ matrix:\n$$ \\mathbf{A} = \\begin{pmatrix}\n1+2\\alpha & -\\alpha & 0 & \\dots & 0 \\\\\n-\\alpha & 1+2\\alpha & -\\alpha & \\dots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n0 & \\dots & -\\alpha & 1+2\\alpha & -\\alpha \\\\\n0 & \\dots & 0 & -\\alpha & 1+2\\alpha\n\\end{pmatrix} $$\nThe right-hand side vector $\\mathbf{d}^j$ is constructed from the known concentrations at time step $j$ and incorporates the boundary conditions at step $j+1$. The boundary conditions are $C_0^{j+1} = 0$ and $C_{N-1}^{j+1} = C_A^\\ast$.\nThe elements of $\\mathbf{d}^j$ are given by:\n$$ d_1^j = (\\alpha C_{0}^{j} + (1-2\\alpha)C_1^{j} + \\alpha C_{2}^{j}) + \\alpha C_0^{j+1} $$\n$$ d_i^j = \\alpha C_{i-1}^{j} + (1-2\\alpha)C_i^{j} + \\alpha C_{i+1}^{j} \\quad \\text{for } i \\in [2, N-3] $$\n$$ d_{N-2}^j = (\\alpha C_{N-3}^{j} + (1-2\\alpha)C_{N-2}^{j} + \\alpha C_{N-1}^{j}) + \\alpha C_{N-1}^{j+1} $$\nSubstituting the boundary values $C_0^{j+1}=0$ and $C_{N-1}^{j+1}=C_A^\\ast$:\n$$ d_1^j = \\alpha C_{0}^{j} + (1-2\\alpha)C_1^{j} + \\alpha C_{2}^{j} $$\n$$ d_{N-2}^j = \\alpha C_{N-3}^{j} + (1-2\\alpha)C_{N-2}^{j} + \\alpha C_{N-1}^{j} + \\alpha C_A^\\ast $$\nThe initial condition $C(x,0) = C_A^\\ast$ with the boundary condition $C(0,t>0)=0$ creates a discontinuity at $(x=0, t=0)$. We handle this numerically by setting the initial concentration vector $\\mathbf{C}^0$ as $C_0^0 = 0$ and $C_i^0 = C_A^\\ast$ for $i=1, \\dots, N-1$.\n\nAt each time step, the tridiagonal system $\\mathbf{A} \\mathbf{c}^{j+1} = \\mathbf{d}^j$ is solved for $\\mathbf{c}^{j+1}$. This can be done efficiently using an algorithm like the Thomas algorithm, available in `scipy.linalg.solve_banded`.\n\nAfter computing the concentration profile $C_i^{j+1}$ at time $t_{j+1}$, we calculate the faradaic current $i(t_{j+1})$. The current is proportional to the flux of species $A$ at the electrode surface ($x=0$):\n$$ i(t) = n F A_{\\mathrm{el}} \\left(-D \\left.\\frac{\\partial C}{\\partial x}\\right|_{x=0}\\right) $$\nThe problem requires a second-order forward difference approximation for the gradient at $x=0$:\n$$ \\left.\\frac{\\partial C}{\\partial x}\\right|_{x=0} \\approx \\frac{-3C(0,t) + 4C(\\Delta x,t) - C(2\\Delta x,t)}{2\\Delta x} $$\nSince the boundary condition sets $C(0,t)=0$, this simplifies to:\n$$ \\left.\\frac{\\partial C}{\\partial x}\\right|_{x=0} \\approx \\frac{4C_1^{j+1} - C_2^{j+1}}{2\\Delta x} $$\nThe numerical current $i_{\\mathrm{num}}(t_{j+1})$ is then:\n$$ i_{\\mathrm{num}}(t_{j+1}) = -n F A_{\\mathrm{el}} D \\left(\\frac{4C_1^{j+1} - C_2^{j+1}}{2\\Delta x}\\right) $$\nThis numerical result is compared against the analytical solution for this problem, the Cottrell equation:\n$$ i_{\\mathrm{Cottrell}}(t) = n F A_{\\mathrm{el}} C_A^\\ast \\sqrt{\\frac{D}{\\pi t}} $$\nThe error is quantified by the maximum absolute relative error over the simulation time, excluding $t=0$:\n$$ \\varepsilon = \\max_{j=0, \\dots, N_t-1} \\left| \\frac{i_{\\mathrm{num}}(t_{j+1}) - i_{\\mathrm{Cottrell}}(t_{j+1})}{i_{\\mathrm{Cottrell}}(t_{j+1})} \\right| $$\n\nThe overall algorithm proceeds as follows:\n1. Initialize constants and numerical parameters for a given test case.\n2. Set up the initial concentration vector $\\mathbf{C}^0$ incorporating the boundary conditions at $t=0$.\n3. Construct the tridiagonal matrix $\\mathbf{A}$ for the Crank-Nicolson scheme.\n4. Iterate through time steps from $j=0$ to $N_t-1$:\n    a. Construct the right-hand side vector $\\mathbf{d}^j$ using the concentrations from step $j$ and the boundary conditions.\n    b. Solve the linear system $\\mathbf{A} \\mathbf{c}^{j+1} = \\mathbf{d}^j$ to find the interior concentrations at step $j+1$.\n    c. Update the full concentration vector $\\mathbf{C}^{j+1}$.\n    d. Calculate and store both $i_{\\mathrm{num}}(t_{j+1})$ and $i_{\\mathrm{Cottrell}}(t_{j+1})$.\n5. After the time loop completes, calculate the maximum absolute relative error $\\varepsilon$ between the numerical and analytical current arrays.\nThis procedure is repeated for each of the four test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef simulate_diffusion(L, N, dt, Nt, D_A, C_A_star, n, F, A_el):\n    \"\"\"\n    Simulates 1D diffusion using Crank-Nicolson and calculates chronoamperometric current.\n\n    This function solves the diffusion equation for a species A under potential-step\n    chronoamperometry conditions, where the concentration at the electrode surface is\n    held at zero. It compares the numerically calculated current to the analytical\n    Cottrell equation and returns the maximum relative error.\n    \"\"\"\n    # 1. Setup numerical grid and parameters\n    dx = L / (N - 1)\n    # alpha is the dimensionless diffusion number for the Crank-Nicolson scheme\n    alpha = (D_A * dt) / (2 * dx**2)\n\n    # 2. Initialization\n    # Initial concentration profile C(x, 0) = C_A*, with C(0, 0) = 0 for consistency with BC\n    C = np.full(N, C_A_star)\n    C[0] = 0.0\n    \n    # Time vector (excluding t=0)\n    time_points = np.arange(1, Nt + 1) * dt\n    \n    i_num_history = np.zeros(Nt)\n    i_cottrell_history = np.zeros(Nt)\n\n    # 3. Matrix setup for Crank-Nicolson\n    # We solve a tridiagonal system A*c_new = d for the N-2 interior points.\n    # The matrix A is represented in banded form for `solve_banded`.\n    # It has shape (3, N-2) with diagonals in rows 0 (upper), 1 (main), 2 (lower).\n    ab = np.zeros((3, N - 2))\n    ab[0, 1:] = -alpha  # Super-diagonal\n    ab[1, :] = 1 + 2 * alpha  # Main diagonal\n    ab[2, :-1] = -alpha  # Sub-diagonal\n    \n    # 4. Time marching loop\n    for j in range(Nt):\n        # a. Construct the right-hand side (RHS) vector `d`\n        # `d` corresponds to the explicit part of the Crank-Nicolson scheme.\n        d = alpha * (C[:-2] + C[2:]) + (1 - 2 * alpha) * C[1:-1]\n\n        # b. Add implicit boundary condition terms to `d`\n        # The term for C(0, t) can be ignored as C(0, t+dt) = 0.\n        # The term for C(L, t) = C_A_star must be added.\n        d[-1] += alpha * C_A_star\n        \n        # c. Solve the linear system for interior nodes\n        C_new_interior = solve_banded((1, 1), ab, d)\n        \n        # d. Update the concentration vector C for the next time step\n        C[1:-1] = C_new_interior\n        # Boundary conditions are already set and remain constant.\n        # C[0] = 0.0\n        # C[-1] = C_A_star\n\n        # e. Calculate numerical and analytical currents\n        t_current = time_points[j]\n        \n        # Numerical current from 2nd-order forward difference flux\n        # grad_C = (-3*C[0] + 4*C[1] - C[2]) / (2*dx). Since C[0]=0, it simplifies.\n        grad_C_at_0 = (4 * C[1] - C[2]) / (2 * dx)\n        j_A_num = -D_A * grad_C_at_0\n        i_num = n * F * A_el * j_A_num\n        i_num_history[j] = i_num\n        \n        # Analytical current (Cottrell equation)\n        i_cottrell = (n * F * A_el * C_A_star * np.sqrt(D_A / (np.pi * t_current)))\n        i_cottrell_history[j] = i_cottrell\n\n    # 5. Error calculation\n    relative_error = np.abs((i_num_history - i_cottrell_history) / i_cottrell_history)\n    max_relative_error = np.max(relative_error)\n    \n    return max_relative_error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Physical constants and parameters\n    n = 1.0  # mol\n    F = 96485.0  # C/mol\n    A_el = 1e-4  # m^2\n    C_A_star = 1.0  # mol/m^3\n    D_A = 1e-9  # m^2/s\n\n    # Test suite\n    test_cases = [\n        # Case 1: Coarse grid\n        {'L': 1e-3, 'N': 64, 'dt': 1e-4, 'Nt': 1000},\n        # Case 2: Medium grid (grid refinement)\n        {'L': 1e-3, 'N': 128, 'dt': 1e-4, 'Nt': 1000},\n        # Case 3: Fine grid (grid refinement)\n        {'L': 1e-3, 'N': 256, 'dt': 1e-4, 'Nt': 1000},\n        # Case 4: Edge-case with small domain L\n        {'L': 2e-5, 'N': 256, 'dt': 1e-4, 'Nt': 1000},\n    ]\n\n    results = []\n    for case in test_cases:\n        error = simulate_diffusion(\n            L=case['L'],\n            N=case['N'],\n            dt=case['dt'],\n            Nt=case['Nt'],\n            D_A=D_A,\n            C_A_star=C_A_star,\n            n=n,\n            F=F,\n            A_el=A_el\n        )\n        results.append(error)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}