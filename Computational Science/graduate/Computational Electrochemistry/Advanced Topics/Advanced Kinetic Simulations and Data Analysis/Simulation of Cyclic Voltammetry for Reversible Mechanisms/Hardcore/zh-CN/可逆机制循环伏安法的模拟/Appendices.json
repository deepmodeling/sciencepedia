{
    "hands_on_practices": [
        {
            "introduction": "高效的数值模拟通常始于无量纲化，这一过程可以简化控制方程，并揭示控制系统行为的关键无量纲数群。第一个实践练习将重点关注循环伏安法中电位扫描的归一化。通过推导恰当的时间比例因子，你将学会如何将无量纲扫描速率设置为单位1，这是许多模拟代码中一个标准且方便的选择。",
            "id": "4257098",
            "problem": "一个平面电极在循环伏安法（CV, cyclic voltammetry）下，由一个峰峰振幅为 $\\Delta E$、恒定扫描速率为 $\\nu$ 的对称三角电位波形驱动，使得施加的电极电位 $E(t)$ 满足分段恒定斜率条件：在正向扫描期间 $dE/dt=+\\nu$，在反向扫描期间 $dE/dt=-\\nu$。考虑一种可逆电子转移机理（E），在该机理下界面热力学瞬时平衡；您正在为 $E(t)$ 构建一个基于以下离散更新的时间步进程序：\n$$\nE_{k+1}=E_k+s_k\\,\\nu\\,\\Delta t,\n$$\n其中 $k$ 是时间步的索引，$\\Delta t$ 是时间步长，$s_k\\in\\{+1,-1\\}$ 是一个分段恒定的符号，仅在转折电位 $E=E_{\\min}$ 和 $E=E_{\\max}$ 处翻转。\n\n为了计算而分析和归一化波形，定义一个无量纲电位\n$$\n\\theta=\\frac{F}{R\\,T}\\left(E-E^{\\ast}\\right),\n$$\n其中 $F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度，$E^{\\ast}$ 是一个固定参考电位。定义一个无量纲时间\n$$\n\\tau=\\frac{t}{\\alpha_t},\n$$\n其中 $\\alpha_t$ 是一个待选择的正时间尺度。\n\n仅从这些定义和 $E(t)$ 的分段恒定斜率出发，不使用任何预先推导的归一化捷径，完成以下操作：\n\n- 确定 $\\alpha_t$ 必须满足的条件（用 $F$、$R$、$T$ 和 $\\nu$ 表示），该条件使得在每个半周期内，无量纲扫描速率 $d\\theta/d\\tau$ 的大小等于1。\n- 使用所选的 $\\alpha_t$，分别确定在正向和反向扫描期间 $d\\theta/d\\tau$ 的有序数值对。\n\n将您的最终答案表示为一个单行矩阵，其中包含按（正向，反向）顺序排列的两个值。无需四舍五入。最终答案中不要包含单位。",
            "solution": "该问题要求推导时间尺度因子 $\\alpha_t$ 需满足的条件，并随后在循环伏安模拟中确定无量纲扫描速率。推导必须仅使用所给定义从第一性原理出发。\n\n所给出的无量纲电位 $\\theta$ 和无量纲时间 $\\tau$ 的定义为：\n$$\n\\theta = \\frac{F}{R\\,T}\\left(E - E^{\\ast}\\right)\n$$\n$$\n\\tau = \\frac{t}{\\alpha_t}\n$$\n其中 $F$、$R$、$T$、$E^{\\ast}$ 和 $\\alpha_t$ 是相对于时间 $t$ 的常数。施加的电位 $E$ 是时间的函数，即 $E(t)$。\n\n我们主要关心的量是无量纲扫描速率 $d\\theta/d\\tau$。为求此导数，我们使用链式法则，将关于 $\\tau$ 的导数与关于 $t$ 的导数联系起来：\n$$\n\\frac{d\\theta}{d\\tau} = \\frac{d\\theta}{dt} \\frac{dt}{d\\tau}\n$$\n\n首先，我们计算导数 $d\\theta/dt$。将 $\\theta$ 的表达式对 $t$ 求导得到：\n$$\n\\frac{d\\theta}{dt} = \\frac{d}{dt} \\left[ \\frac{F}{R\\,T}\\left(E(t) - E^{\\ast}\\right) \\right]\n$$\n由于 $F$、$R$、$T$ 和 $E^{\\ast}$ 是常数，我们可以写出：\n$$\n\\frac{d\\theta}{dt} = \\frac{F}{R\\,T} \\frac{dE}{dt}\n$$\n\n接着，我们计算导数 $dt/d\\tau$。根据定义 $\\tau = t/\\alpha_t$，我们可以将 $t$ 表示为 $\\tau$ 的函数：\n$$\nt = \\alpha_t \\tau\n$$\n将 $t$ 对 $\\tau$ 求导得出：\n$$\n\\frac{dt}{d\\tau} = \\frac{d}{d\\tau} (\\alpha_t \\tau) = \\alpha_t\n$$\n因为 $\\alpha_t$ 是一个常数。\n\n现在，我们将这两个导数代回链式法则的表达式中：\n$$\n\\frac{d\\theta}{d\\tau} = \\left( \\frac{F}{R\\,T} \\frac{dE}{dt} \\right) (\\alpha_t) = \\frac{F \\alpha_t}{R\\,T} \\frac{dE}{dt}\n$$\n\n题目指出扫描速率 $dE/dt$ 是分段恒定的。在正向扫描期间，$dE/dt = +\\nu$，在反向扫描期间，$dE/dt = -\\nu$。我们可以将其紧凑地写为 $dE/dt = s \\nu$，其中，对于正向扫描 $s=+1$，对于反向扫描 $s=-1$。将此代入我们关于 $d\\theta/d\\tau$ 的表达式中：\n$$\n\\frac{d\\theta}{d\\tau} = s \\left( \\frac{F \\nu \\alpha_t}{R\\,T} \\right)\n$$\n\n问题的第一部分要求找出 $\\alpha_t$ 必须满足的条件，该条件使得无量纲扫描速率的大小等于 1，即 $|d\\theta/d\\tau| = 1$。应用此条件：\n$$\n\\left| s \\left( \\frac{F \\nu \\alpha_t}{R\\,T} \\right) \\right| = 1\n$$\n由于 $|s| = 1$ 且所有其他参数（$F, \\nu, \\alpha_t, R, T$）都是正的物理常数，对于这组常数，绝对值是多余的：\n$$\n\\frac{F \\nu \\alpha_t}{R\\,T} = 1\n$$\n对该方程求解 $\\alpha_t$，得到所要求的条件：\n$$\n\\alpha_t = \\frac{R\\,T}{F \\nu}\n$$\n这就是对时间尺度 $\\alpha_t$ 的特定选择，它使得扫描速率被归一化。\n\n问题的第二部分要求在给定 $\\alpha_t$ 的此选择下，求出在正向和反向扫描期间 $d\\theta/d\\tau$ 的有序数值对。我们使用无量纲扫描速率的一般表达式：\n$$\n\\frac{d\\theta}{d\\tau} = s \\left( \\frac{F \\nu \\alpha_t}{R\\,T} \\right)\n$$\n并代入我们刚刚推导出的 $\\alpha_t$ 的表达式：\n$$\n\\frac{d\\theta}{d\\tau} = s \\left( \\frac{F \\nu}{R\\,T} \\cdot \\frac{R\\,T}{F \\nu} \\right)\n$$\n括号中的项相消为 1：\n$$\n\\frac{d\\theta}{d\\tau} = s \\cdot 1 = s\n$$\n因此，无量纲扫描速率的值就是符号因子 $s$。\n\n- 在正向扫描期间，$s = +1$。因此，无量纲扫描速率为 $d\\theta/d\\tau_{\\text{forward}} = +1$。\n- 在反向扫描期间，$s = -1$。因此，无量纲扫描速率为 $d\\theta/d\\tau_{\\text{reverse}} = -1$。\n\n题目要求提供有序数值对 $(d\\theta/d\\tau_{\\text{forward}}, d\\theta/d\\tau_{\\text{reverse}})$。这个数值对是 $(1, -1)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为了在计算机上模拟半无限空间中的扩散过程，我们必须将计算域截断为有限长度 $L$，但这会引入潜在的误差。本练习将指导你基于预设的误差容限 $\\varepsilon$ 推导出一个稳健的准则来选择 $L$。这项实践对于在确保模拟准确性的同时，避免在不必要的巨大计算域上浪费计算资源至关重要。",
            "id": "4257031",
            "problem": "考虑循环伏安法 (CV) 中可逆电子转移机理（E 机理）的一维平面扩散模型。设 $x$ 表示垂直于电极表面的空间坐标，电极位于 $x=0$ 处，电解质占据半无限域 $x \\ge 0$。两种电活性物质的浓度分别为 $c_A(x,t)$ 和 $c_B(x,t)$，它们通过扩散进行演化，扩散系数为 $D$（为简化起见，假设两种物质的扩散系数相等）。由于可逆的电子转移，电极表面的浓度瞬时满足能斯特平衡。为模拟此类系统，数值方法通常将半无限域截断为有限区间 $x \\in [0,L]$，并在 $x=L$ 处施加一个近似本体溶液的远场边界条件。如果在实验时间范围内扩散前沿到达 $x=L$，则不充分的截断长度 $L$ 会干扰模拟。\n\n您的任务是推导、论证并实现一个选择截断长度 $L$ 的准则，以确保 $x=L$ 处的浓度偏差保持在规定的容差之下。\n\n使用以下基本依据：\n\n- 菲克第二定律，用于一维扩散，应用于一个扩散物质的通用浓度场 $c(x,t)$，其扩散系数为 $D$：\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2},\n$$\n初始条件为 $c(x,0) = c_b$（对于 $x \\ge 0$），其中 $c_b$ 是均匀的本体浓度。\n\n- 一个经过充分检验的标度关系是，扩散层厚度与 $\\sqrt{D t}$ 成比例增长，并且扩散方程的基本解表明，远离边界扰动处的浓度呈现互补误差函数形式的衰减。\n\n假设在 $x=L$ 处的远场偏差容差被指定为一个无量纲界限 $\\varepsilon \\in (0,1)$，该界限是相对于边界扰动的特征浓度标度的归一化偏差。设 $t_{\\max}$ 表示单个 CV 半循环内的最大模拟时间。假设您选择形式为\n$$\nL = \\alpha \\sqrt{D t_{\\max}},\n$$\n的截断，其中无量纲数 $\\alpha > 0$。请推导一个数学上可靠的表达式，用于计算最小的 $\\alpha$，以保证在任何时间 $t \\in [0, t_{\\max}]$ 内，$x=L$ 处的归一化偏差不超过 $\\varepsilon$。\n\n在您的推导中，从菲克第二定律出发，使用半无限域格林函数或误差函数解来界定 $x=0$ 处边界扰动的远场效应，并论证为何在与 CV 相关的可逆（E 机理）边界驱动下，在 $t = t_{\\max}$ 处评估该界限足以控制所有更早时间的偏差。\n\n然后，实现一个程序，为每个测试用例 $(D, t_{\\max}, \\varepsilon)$ 计算所需的 $\\alpha$（无量纲）。不要计算或打印 $L$；仅计算并打印 $\\alpha$。\n\n单位和数值规范：\n\n- 扩散系数 $D$ 必须以 $\\mathrm{m^2\\,s^{-1}}$ 为单位。\n- 时间 $t_{\\max}$ 必须以 $\\mathrm{s}$ 为单位。\n- 无量纲容差 $\\varepsilon$ 必须严格介于 $0$ 和 $1$ 之间。\n- 输出值 $\\alpha$ 是无量纲浮点数。最终数值输出请表示为六位小数。\n\n测试套件：\n\n为以下参数集计算 $\\alpha$：\n1. $D = 1.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $t_{\\max} = 1.0\\ \\mathrm{s}$, $\\varepsilon = 1.0 \\times 10^{-6}$。\n2. $D = 1.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $t_{\\max} = 0.2\\ \\mathrm{s}$, $\\varepsilon = 1.0 \\times 10^{-3}$。\n3. $D = 5.0 \\times 10^{-10}\\ \\mathrm{m^2\\,s^{-1}}$, $t_{\\max} = 2.0\\ \\mathrm{s}$, $\\varepsilon = 5.0 \\times 10^{-2}$。\n4. $D = 1.0 \\times 10^{-11}\\ \\mathrm{m^2\\,s^{-1}}$, $t_{\\max} = 10.0\\ \\mathrm{s}$, $\\varepsilon = 1.0 \\times 10^{-12}$。\n5. $D = 2.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $t_{\\max} = 0.5\\ \\mathrm{s}$, $\\varepsilon = 5.0 \\times 10^{-1}$。\n6. $D = 1.0 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}$, $t_{\\max} = 1.0 \\times 10^{-3}\\ \\mathrm{s}$, $\\varepsilon = 1.0 \\times 10^{-1}$。\n\n最终输出格式：\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个 $\\alpha$ 值都四舍五入到六位小数（例如，$\\left[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4,\\alpha_5,\\alpha_6\\right]$）。",
            "solution": "任务是推导并实现一个准则，用于选择一个无量纲标度因子 $\\alpha$，该因子用于确定模拟平面扩散过程的合适计算域截断长度 $L = \\alpha \\sqrt{D t_{\\max}}$。该准则必须确保在整个模拟时间 $t \\in [0, t_{\\max}]$ 内，远场边界 $x=L$ 处的归一化浓度偏差保持在规定的容差 $\\varepsilon$ 以下。\n\n控制物理定律是一维菲克第二定律，对于浓度为 $c(x,t)$、扩散系数为 $D$ 的物质：\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}\n$$\n系统定义在半无限域 $x \\ge 0$ 上，初始浓度均匀，为 $c(x,0) = c_b$。电极表面 $x=0$ 处的电化学反应使浓度偏离其本体值。目标是为 $L$ 找到一个稳健的界限，该界限对可逆（E）机理中典型的任何边界浓度变化都有效。\n\n为了建立一个保守且通用的准则，我们分析系统对最严重可能扰动的响应：即在 $t=0$ 时边界浓度发生瞬时、持续的变化。这种情况代表了电位阶跃（Cottrell）实验，它将表面浓度在所有 $t > 0$ 时设置为一个新的恒定值 $c(0,t) = c_0$。这种阶跃变化会产生传播最快、穿透最深的扩散前沿。任何更渐进的表面浓度变化，例如由循环伏安法中的线性电位扫描驱动的变化，在任何给定时间 $t$ 都将导致一个对远场扰动程度较小的浓度分布。因此，在其他条件相似的情况下，对于阶跃变化情况足够大的截断长度 $L$，也必定对于 CV 模拟是足够的。\n\n为了将其形式化，我们定义浓度与本体值之差为 $u(x,t) = c(x,t) - c_b$。问题转换为：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2}\n$$\n初始条件为 $u(x,0) = 0$（对于 $x > 0$），边界条件为：\n1. 在电极处（$x=0$）：$u(0,t) = c_0 - c_b_ \\text{ for } t > 0$。\n2. 在无穷远处（$x \\to \\infty$）：$u(x,t) \\to 0$。\n\n这个半无限域上标准一维扩散问题的解可以用互补误差函数 $\\mathrm{erfc}$ 表示：\n$$\nu(x,t) = (c_0 - c_b) \\cdot \\mathrm{erfc}\\left( \\frac{x}{2\\sqrt{Dt}} \\right)\n$$\n其中 $\\mathrm{erfc}(z) = 1 - \\mathrm{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_z^\\infty e^{-s^2} ds$。\n\n问题指出，在 $x=L$ 处的归一化偏差必须以 $\\varepsilon$ 为界。归一化是相对于边界扰动的特征标度进行的。对于任何可逆过程，物质的浓度都界于其本体浓度和零之间。因此，最大浓度变化为 $c_b$ 本身。这对应于我们阶跃变化模型中的 $|c_0 - c_b|$（例如，如果 $c_0=0$）。因此，归一化偏差为 $\\frac{|c(x,t) - c_b|}{|c_0 - c_b|}$。我们必须满足以下条件：\n$$\n\\frac{|c(L,t) - c_b|}{|c_0 - c_b|} \\le \\varepsilon \\quad \\text{for all } t \\in [0, t_{\\max}]\n$$\n代入我们的解 $u(L,t) = c(L,t) - c_b$，该不等式变为：\n$$\n\\mathrm{erfc}\\left( \\frac{L}{2\\sqrt{Dt}} \\right) \\le \\varepsilon \\quad \\text{for all } t \\in [0, t_{\\max}]\n$$\n我们现在必须论证在 $t = t_{\\max}$ 时评估此条件的合理性。互补误差函数的自变量 $z(t) = \\frac{L}{2\\sqrt{Dt}}$ 是一个关于时间 $t$ 的正的单调递减函数。互补误差函数 $\\mathrm{erfc}(z)$ 在 $z \\ge 0$ 时是其自变量 $z$ 的单调递减函数。因此，复合函数 $\\mathrm{erfc}(z(t))$ 是一个关于时间 $t$ 的单调 *递增* 函数。这意味着在固定位置 $L$ 处，最大偏差发生在最长时间 $t_{\\max}$ 时。因此，为确保该条件在整个区间 $t \\in [0, t_{\\max}]$ 内成立，只需在 $t=t_{\\max}$ 时强制执行它即可：\n$$\n\\mathrm{erfc}\\left( \\frac{L}{2\\sqrt{D t_{\\max}}} \\right) \\le \\varepsilon\n$$\n为找到保证这一点的最小长度 $L$，我们求解等式：\n$$\n\\mathrm{erfc}\\left( \\frac{L}{2\\sqrt{D t_{\\max}}} \\right) = \\varepsilon\n$$\n对两边应用反互补误差函数 $\\mathrm{erfcinv}$，得到：\n$$\n\\frac{L}{2\\sqrt{D t_{\\max}}} = \\mathrm{erfcinv}(\\varepsilon)\n$$\n求解 $L$ 得到所需的最小截断长度：\n$$\nL = 2 \\cdot \\mathrm{erfcinv}(\\varepsilon) \\cdot \\sqrt{D t_{\\max}}\n$$\n问题陈述假设截断长度的形式为 $L = \\alpha \\sqrt{D t_{\\max}}$。通过将我们推导出的 $L$ 表达式与给定形式直接比较，我们确定了无量纲因子 $\\alpha$ 所需的最小值：\n$$\n\\alpha = 2 \\cdot \\mathrm{erfcinv}(\\varepsilon)\n$$\n这个基本结果表明，$\\alpha$ 仅是无量纲容差 $\\varepsilon$ 的函数。参数 $D$ 和 $t_{\\max}$ 定义了特征扩散长度标度 $\\sqrt{D t_{\\max}}$，而 $\\alpha$ 则确定了为满足误差容差所需的该标度的倍数。下面的程序将通过数值计算该表达式，为每个给定的测试用例计算 $\\alpha$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erfcinv\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless scaling factor alpha for domain truncation\n    in diffusion simulations based on a specified tolerance epsilon.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (D in m^2/s, t_max in s, epsilon dimensionless).\n    test_cases = [\n        (1.0e-9, 1.0, 1.0e-6),\n        (1.0e-9, 0.2, 1.0e-3),\n        (5.0e-10, 2.0, 5.0e-2),\n        (1.0e-11, 10.0, 1.0e-12),\n        (2.0e-9, 0.5, 5.0e-1),\n        (1.0e-9, 1.0e-3, 1.0e-1),\n    ]\n\n    alpha_results = []\n    for case in test_cases:\n        # Unpack the case parameters. Note that D and t_max are not needed\n        # for the calculation of alpha, as shown in the derivation.\n        _D, _t_max, epsilon = case\n\n        # The derived formula for alpha depends only on the tolerance epsilon.\n        # alpha = 2 * erfcinv(epsilon)\n        # Using 2.0 to ensure float arithmetic.\n        alpha = 2.0 * erfcinv(epsilon)\n        alpha_results.append(alpha)\n\n    # Format the final results as a comma-separated string with each value\n    # rounded to six decimal places, enclosed in square brackets.\n    # The lambda function formats each float result 'r' into a string\n    # with the specified precision.\n    formatted_results = \",\".join(map(lambda r: f\"{r:.6f}\", alpha_results))\n    print(f\"[{formatted_results}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "模拟可逆电化学系统的核心在于求解每个时间步下电极-电解质界面的非线性方程组。这项高级实践要求你实现一个牛顿-拉弗森迭代求解器，以确定在扩散系数不相等情况下的表面浓度。掌握此项技术对于精确模拟非理想体系并计算相应的法拉第电流至关重要。",
            "id": "4257037",
            "problem": "您需要实现一个牛顿-拉夫逊迭代，以求解在模拟可逆电子转移机理的循环伏安法（CV）中，每个时间步长出现的非线性界面边界条件。该可逆机理在电极表面遵循能斯特方程，电解质中的扩散被建模为一维平面扩散。您必须处理氧化态和还原态物种的扩散系数不相等的情况。\n\n考虑一个二元氧化还原电对，其中氧化态物种 $O$ 和还原态物种 $R$ 在半无限域 $x \\ge 0$ 中扩散，其浓度分别为 $c_O(x,t)$ 和 $c_R(x,t)$。扩散的控制方程由菲克第二定律给出：\n$$\n\\frac{\\partial c_O}{\\partial t} = D_O \\frac{\\partial^2 c_O}{\\partial x^2}, \\quad \\frac{\\partial c_R}{\\partial t} = D_R \\frac{\\partial^2 c_R}{\\partial x^2},\n$$\n其中 $D_O$ 和 $D_R$ 分别是 $O$ 和 $R$ 的扩散系数，且通常 $D_O \\ne D_R$。在电极表面 $x=0$ 处，可逆电子转移对表面浓度 $c_O^s(t) \\equiv c_O(0,t)$ 和 $c_R^s(t) \\equiv c_R(0,t)$ 施加了能斯特关系：\n$$\nE(t) = E^0 + \\frac{R T}{n F} \\ln \\left( \\frac{c_O^s(t)}{c_R^s(t)} \\right),\n$$\n其中 $E(t)$ 是时间 $t$ 时施加的电极电势，$E^0$ 是标准电势，$R$ 是普适气体常数，$T$ 是绝对温度，$n$ 是转移的电子数，$F$ 是法拉第常数。\n\n对于可逆反应 $O + n e^- \\rightleftharpoons R$，界面处的质量守恒要求流入电极的 $O$ 的摩尔通量等于流出电极的 $R$ 的摩尔通量，且符号相反。使用位于 $x=h$ 的第一个内部节点的浓度（表示为 $c_O^1(t) \\equiv c_O(h,t)$ 和 $c_R^1(t) \\equiv c_R(h,t)$），通过表面的一阶有限差分来近似界面通量，通量平衡得出\n$$\nj_O(t) = - D_O \\frac{c_O^1(t) - c_O^s(t)}{h}, \\quad j_R(t) = - D_R \\frac{c_R^1(t) - c_R^s(t)}{h}, \\quad - j_O(t) = j_R(t).\n$$\n此处 $h$ 是空间网格间距。将通量表达式与化学计量约束相结合，得到 $c_O^s(t)$ 和 $c_R^s(t)$ 之间的第二个关系式：\n$$\nD_O \\left( c_O^1(t) - c_O^s(t) \\right) + D_R \\left( c_R^1(t) - c_R^s(t) \\right) = 0.\n$$\n\n在每个时间步长，给定 $E(t)$ 和内部节点浓度 $c_O^1(t)$ 与 $c_R^1(t)$，您必须求解以下非线性系统以获得表面浓度 $c_O^s(t)$ 和 $c_R^s(t)$：\n$$\n\\begin{aligned}\nr_1(c_O^s, c_R^s) \\equiv E^0 + \\frac{R T}{n F} \\ln \\left( \\frac{c_O^s}{c_R^s} \\right) - E(t) = 0, \\\\\nr_2(c_O^s, c_R^s) \\equiv D_O \\left( c_O^1(t) - c_O^s \\right) + D_R \\left( c_R^1(t) - c_R^s \\right) = 0.\n\\end{aligned}\n$$\n使用牛顿-拉夫逊方法求解 $c_O^s$ 和 $c_R^s$，并满足两个浓度都保持为正的物理约束。提供收敛所需的雅可比矩阵项。\n\n一旦获得表面浓度 $c_O^s$ 和 $c_R^s$，使用氧化态物种的界面通量计算电流密度 $i(t)$（单位为 $\\mathrm{A}/\\mathrm{m}^2$）：\n$$\nj_O(t) = - D_O \\frac{c_O^1(t) - c_O^s(t)}{h}, \\qquad i(t) = n F \\, j_O(t).\n$$\n\n实现一个程序，对于每个指定的测试用例，使用牛顿-拉夫逊迭代法找到 $c_O^s$ 和 $c_R^s$，并输出相应的电流密度。牛顿-拉夫逊迭代必须对初始猜测值具有鲁棒性，并强制 $c_O^s$ 和 $c_R^s$ 的正值（例如，通过阻尼）。\n\n您必须将最终的电流密度以 $\\mathrm{A}/\\mathrm{m}^2$ 为单位表示为浮点数。\n\n测试套件：\n对于以下每个参数集，计算电流密度 $i$ 并按要求的格式报告结果。\n\n- 测试用例1（$D_O > D_R$ 的一般情况）：\n  - $D_O = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $D_R = 0.5 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $h = 5.0 \\times 10^{-6}\\ \\mathrm{m}$\n  - $n = 1$\n  - $T = 298.15\\ \\mathrm{K}$\n  - $R = 8.314462618\\ \\mathrm{J}/(\\mathrm{mol}\\,\\mathrm{K})$\n  - $F = 96485.33212\\ \\mathrm{C}/\\mathrm{mol}$\n  - $E^0 = 0.0\\ \\mathrm{V}$\n  - $E(t) = 0.100\\ \\mathrm{V}$\n  - $c_O^1(t) = 1.000\\ \\mathrm{mol}/\\mathrm{m}^3$\n  - $c_R^1(t) = 0.000\\ \\mathrm{mol}/\\mathrm{m}^3$\n\n- 测试用例2（$D_O  D_R$ 且电势为负的一般情况）：\n  - $D_O = 0.5 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $D_R = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $h = 5.0 \\times 10^{-6}\\ \\mathrm{m}$\n  - $n = 1$\n  - $T = 298.15\\ \\mathrm{K}$\n  - $R = 8.314462618\\ \\mathrm{J}/(\\mathrm{mol}\\,\\mathrm{K})$\n  - $F = 96485.33212\\ \\mathrm{C}/\\mathrm{mol}$\n  - $E^0 = 0.0\\ \\mathrm{V}$\n  - $E(t) = -0.100\\ \\mathrm{V}$\n  - $c_O^1(t) = 1.000\\ \\mathrm{mol}/\\mathrm{m}^3$\n  - $c_R^1(t) = 0.000\\ \\mathrm{mol}/\\mathrm{m}^3$\n\n- 测试用例3（$E = E^0$ 时 $D_O = D_R$ 的边界情况）：\n  - $D_O = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $D_R = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $h = 5.0 \\times 10^{-6}\\ \\mathrm{m}$\n  - $n = 1$\n  - $T = 298.15\\ \\mathrm{K}$\n  - $R = 8.314462618\\ \\mathrm{J}/(\\mathrm{mol}\\,\\mathrm{K})$\n  - $F = 96485.33212\\ \\mathrm{C}/\\mathrm{mol}$\n  - $E^0 = 0.0\\ \\mathrm{V}$\n  - $E(t) = 0.000\\ \\mathrm{V}$\n  - $c_O^1(t) = 1.000\\ \\mathrm{mol}/\\mathrm{m}^3$\n  - $c_R^1(t) = 0.000\\ \\mathrm{mol}/\\mathrm{m}^3$\n\n- 测试用例4（内部成分混合的边缘情况）：\n  - $D_O = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $D_R = 2.0 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n  - $h = 5.0 \\times 10^{-6}\\ \\mathrm{m}$\n  - $n = 1$\n  - $T = 298.15\\ \\mathrm{K}$\n  - $R = 8.314462618\\ \\mathrm{J}/(\\mathrm{mol}\\,\\mathrm{K})$\n  - $F = 96485.33212\\ \\mathrm{C}/\\mathrm{mol}$\n  - $E^0 = 0.0\\ \\mathrm{V}$\n  - $E(t) = 0.050\\ \\mathrm{V}$\n  - $c_O^1(t) = 0.200\\ \\mathrm{mol}/\\mathrm{m}^3$\n  - $c_R^1(t) = 0.800\\ \\mathrm{mol}/\\mathrm{m}^3$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按上述测试用例顺序排列的结果，形式为方括号括起来的逗号分隔列表。例如，输出必须如下所示：\n$$\n[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}]\n$$\n其中每个条目是以 $\\mathrm{A}/\\mathrm{m}^2$ 为单位的电流密度 $i$，表示为浮点数。",
            "solution": "在尝试解决方案之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n问题提供了以下信息，用于模拟电极表面的可逆电化学反应 $O + n e^- \\rightleftharpoons R$：\n\n**控制方程和条件：**\n- **扩散：** $\\frac{\\partial c_O}{\\partial t} = D_O \\frac{\\partial^2 c_O}{\\partial x^2}$ 和 $\\frac{\\partial c_R}{\\partial t} = D_R \\frac{\\partial^2 c_R}{\\partial x^2}$ 对于 $x \\ge 0$。\n- **能斯特方程（在 $x=0$ 处）：** $E(t) = E^0 + \\frac{R T}{n F} \\ln \\left( \\frac{c_O^s(t)}{c_R^s(t)} \\right)$，其中 $c_O^s(t) \\equiv c_O(0,t)$ 和 $c_R^s(t) \\equiv c_R(0,t)$。\n- **通量平衡（在 $x=0$ 处）：** 使用空间步长为 $h$ 和内部节点浓度为 $c_O^1(t)$ 和 $c_R^1(t)$ 的一阶有限差分近似，通量条件 $-j_O(t) = j_R(t)$ 导向 $D_O \\left( c_O^1(t) - c_O^s(t) \\right) + D_R \\left( c_R^1(t) - c_R^s(t) \\right) = 0$。\n\n**表面浓度的非线性系统：**\n任务是通过找到向量函数 $\\mathbf{r}(c_O^s, c_R^s) = [r_1, r_2]^T = \\mathbf{0}$ 的根来求解表面浓度 $c_O^s$ 和 $c_R^s$：\n$$\n\\begin{aligned}\nr_1(c_O^s, c_R^s) \\equiv E^0 + \\frac{R T}{n F} \\ln \\left( \\frac{c_O^s}{c_R^s} \\right) - E(t) = 0 \\\\\nr_2(c_O^s, c_R^s) \\equiv D_O \\left( c_O^1(t) - c_O^s \\right) + D_R \\left( c_R^1(t) - c_R^s \\right) = 0\n\\end{aligned}\n$$\n\n**方法和约束：**\n- **方法：** 牛顿-拉夫逊迭代。\n- **约束：** 浓度必须为正，$c_O^s > 0$ 和 $c_R^s > 0$。\n\n**电流密度计算：**\n- **通量：** $j_O(t) = - D_O \\frac{c_O^1(t) - c_O^s(t)}{h}$。\n- **电流密度：** $i(t) = n F \\, j_O(t)$。\n\n**测试套件数据：**\n提供了四个测试用例，其中包含 $D_O$、$D_R$、$h$、$n$、$T$、$R$、$F$、$E^0$、$E(t)$、$c_O^1(t)$ 和 $c_R^1(t)$ 的具体值。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是计算电化学中的一个标准练习。菲克定律、用于可逆动力学的能斯特方程、通量守恒以及有限差分近似的使用都是该领域已确立的基本原理。所有提供的常数和参数在物理上都是现实的。\n- **适定性：** 该问题为两个未知数定义了一个由两个独立的非线性方程组成的系统。鉴于物理背景和方程的性质，对于给定的参数集，预计会有一个唯一的、稳定的、有意义的解。设置是自洽和完整的。\n- **客观性：** 问题使用精确的数学和化学术语陈述，没有歧义或主观因素。\n\n问题没有表现出验证清单中列出的任何缺陷。它在科学上是合理的、适定的、客观的、完整的，并且直接关系到指定的主题。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供解决方案。\n\n### 解决方案\n目标是通过求解一个包含两个非线性方程的系统，来确定电极上氧化态和还原态物种的表面浓度 $c_O^s$ 和 $c_R^s$。所提供的方法是牛顿-拉夫逊迭代，它非常适合解决此类问题。一旦找到 $c_O^s$ 和 $c_R^s$，就可以计算出电流密度 $i(t)$。\n\n设未知表面浓度的向量为 $\\mathbf{c}^s = \\begin{pmatrix} c_O^s \\\\ c_R^s \\end{pmatrix}$。要求解的方程组为 $\\mathbf{r}(\\mathbf{c}^s) = \\mathbf{0}$，其中 $\\mathbf{r} = \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix}$，其分量由以下公式给出：\n$$\nr_1(c_O^s, c_R^s) = E^0 + \\frac{R T}{n F} \\left( \\ln(c_O^s) - \\ln(c_R^s) \\right) - E = 0\n$$\n$$\nr_2(c_O^s, c_R^s) = D_O \\left( c_O^1 - c_O^s \\right) + D_R \\left( c_R^1 - c_R^s \\right) = 0\n$$\n为简化表达式，省略了 $E$、$c_O^1$ 和 $c_R^1$ 的显式时间依赖性。\n\n牛顿-拉夫逊方法是一个迭代过程。从一个初始猜测值 $\\mathbf{c}^s_0$ 开始，通过求解以下线性系统来找到连续的近似值 $\\mathbf{c}^s_{k+1}$：\n$$\n\\mathbf{J}(\\mathbf{c}^s_k) \\Delta \\mathbf{c}^s_k = -\\mathbf{r}(\\mathbf{c}^s_k)\n$$\n其中 $\\Delta \\mathbf{c}^s_k = \\mathbf{c}^s_{k+1} - \\mathbf{c}^s_k$ 是更新步长，$\\mathbf{J}$ 是 $\\mathbf{r}$ 相对于 $\\mathbf{c}^s$ 的雅可比矩阵。然后解按 $\\mathbf{c}^s_{k+1} = \\mathbf{c}^s_k + \\alpha \\Delta \\mathbf{c}^s_k$ 进行更新。\n\n该方法的核心在于雅可比矩阵的构建，$\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial r_1}{\\partial c_O^s}  \\frac{\\partial r_1}{\\partial c_R^s} \\\\ \\frac{\\partial r_2}{\\partial c_O^s}  \\frac{\\partial r_2}{\\partial c_R^s} \\end{pmatrix}$。所需的偏导数计算如下：\n\n对于 $r_1$：\n$$\n\\frac{\\partial r_1}{\\partial c_O^s} = \\frac{\\partial}{\\partial c_O^s} \\left[ E^0 + \\frac{R T}{n F} \\ln \\left( \\frac{c_O^s}{c_R^s} \\right) - E \\right] = \\frac{R T}{n F} \\frac{1}{c_O^s}\n$$\n$$\n\\frac{\\partial r_1}{\\partial c_R^s} = \\frac{\\partial}{\\partial c_R^s} \\left[ E^0 + \\frac{R T}{n F} \\ln \\left( \\frac{c_O^s}{c_R^s} \\right) - E \\right] = - \\frac{R T}{n F} \\frac{1}{c_R^s}\n$$\n\n对于 $r_2$：\n$$\n\\frac{\\partial r_2}{\\partial c_O^s} = \\frac{\\partial}{\\partial c_O^s} \\left[ D_O (c_O^1 - c_O^s) + D_R (c_R^1 - c_R^s) \\right] = -D_O\n$$\n$$\n\\frac{\\partial r_2}{\\partial c_R^s} = \\frac{\\partial}{\\partial c_R^s} \\left[ D_O (c_O^1 - c_O^s) + D_R (c_R^1 - c_R^s) \\right] = -D_R\n$$\n\n因此，雅可比矩阵为：\n$$\n\\mathbf{J}(c_O^s, c_R^s) = \\begin{pmatrix} \\frac{RT}{nF c_O^s}  -\\frac{RT}{nF c_R^s} \\\\ -D_O  -D_R \\end{pmatrix}\n$$\n\n迭代算法的步骤如下：\n1.  初始化表面浓度的猜测值 $\\mathbf{c}^s_0$。一个合理的选择是使用近电极浓度的平均值，以避免零浓度问题：$c_{O,0}^s = c_{R,0}^s = (c_O^1 + c_R^1)/2$。\n2.  对于迭代 $k=0, 1, 2, ...$：\n    a. 计算残差向量 $\\mathbf{r}_k = \\mathbf{r}(\\mathbf{c}^s_k)$。\n    b. 检查收敛性。如果残差的范数 $||\\mathbf{r}_k||$ 低于指定的容差（例如 $10^{-10}$），则终止迭代。\n    c. 计算雅可比矩阵 $\\mathbf{J}_k = \\mathbf{J}(\\mathbf{c}^s_k)$。\n    d. 求解 $2 \\times 2$ 线性系统 $\\mathbf{J}_k \\Delta \\mathbf{c}^s_k = -\\mathbf{r}_k$ 以获得更新向量 $\\Delta \\mathbf{c}^s_k$。\n    e. 应用带阻尼的更新以确保正值。找到一个阻尼因子 $\\alpha \\in (0, 1]$，使得新的浓度 $\\mathbf{c}^s_{k+1} = \\mathbf{c}^s_k + \\alpha \\Delta \\mathbf{c}^s_k$ 均为正。这可以通过从 $\\alpha = 1$ 开始，并将其减半直到满足正值约束来实现。\n3.  一旦找到收敛解 $\\mathbf{c}^s = (c_O^s, c_R^s)$，就使用提供的公式计算电流密度 $i$：\n$$\ni = n F j_O = n F \\left( -D_O \\frac{c_O^1 - c_O^s}{h} \\right) = \\frac{n F D_O}{h} (c_O^s - c_O^1)\n$$\n负电流密度对应于净还原（阴极电流），正值对应于净氧化（阳极电流）。\n\n为每个测试用例实现此算法，以计算相应的电流密度。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes test cases for a cyclic voltammetry simulation problem.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"D_O\": 1.0e-9, \"D_R\": 0.5e-9, \"h\": 5.0e-6, \"n\": 1, \"T\": 298.15,\n            \"R\": 8.314462618, \"F\": 96485.33212, \"E0\": 0.0, \"E\": 0.100,\n            \"c_O1\": 1.000, \"c_R1\": 0.000\n        },\n        {\n            \"D_O\": 0.5e-9, \"D_R\": 1.0e-9, \"h\": 5.0e-6, \"n\": 1, \"T\": 298.15,\n            \"R\": 8.314462618, \"F\": 96485.33212, \"E0\": 0.0, \"E\": -0.100,\n            \"c_O1\": 1.000, \"c_R1\": 0.000\n        },\n        {\n            \"D_O\": 1.0e-9, \"D_R\": 1.0e-9, \"h\": 5.0e-6, \"n\": 1, \"T\": 298.15,\n            \"R\": 8.314462618, \"F\": 96485.33212, \"E0\": 0.0, \"E\": 0.000,\n            \"c_O1\": 1.000, \"c_R1\": 0.000\n        },\n        {\n            \"D_O\": 1.0e-9, \"D_R\": 2.0e-9, \"h\": 5.0e-6, \"n\": 1, \"T\": 298.15,\n            \"R\": 8.314462618, \"F\": 96485.33212, \"E0\": 0.0, \"E\": 0.050,\n            \"c_O1\": 0.200, \"c_R1\": 0.800\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        current_density = compute_current_density(params)\n        results.append(current_density)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef compute_current_density(params):\n    \"\"\"\n    Computes the surface concentrations and current density using Newton-Raphson.\n\n    Args:\n        params (dict): A dictionary of physical and simulation parameters.\n\n    Returns:\n        float: The calculated current density in A/m^2.\n    \"\"\"\n    D_O, D_R = params[\"D_O\"], params[\"D_R\"]\n    h, n = params[\"h\"], params[\"n\"]\n    T, R, F = params[\"T\"], params[\"R\"], params[\"F\"]\n    E0, E = params[\"E0\"], params[\"E\"]\n    c_O1, c_R1 = params[\"c_O1\"], params[\"c_R1\"]\n\n    # Thermal voltage factor\n    V_T_n = R * T / (n * F)\n\n    # --- Newton-Raphson Iteration ---\n    # Initial guess for surface concentrations [c_O^s, c_R^s]\n    # A robust guess is the average of bulk concentrations, ensuring positivity\n    c_total_1 = c_O1 + c_R1\n    if c_total_1 == 0:\n        c_s = np.array([1e-12, 1e-12])\n    else:\n        c_s = np.array([c_total_1 / 2.0, c_total_1 / 2.0])\n\n    # Iteration parameters\n    tolerance = 1e-10\n    max_iterations = 50\n    min_alpha = 1e-8\n\n    for i in range(max_iterations):\n        c_Os, c_Rs = c_s[0], c_s[1]\n\n        # Check for non-physical concentrations (should be handled by damping)\n        if c_Os = 0 or c_Rs = 0:\n            raise RuntimeError(\"Concentration became non-positive during iteration.\")\n\n        # 1. Calculate the residual vector r = [r1, r2]\n        r1 = E0 + V_T_n * np.log(c_Os / c_Rs) - E\n        r2 = D_O * (c_O1 - c_Os) + D_R * (c_R1 - c_Rs)\n        r = np.array([r1, r2])\n\n        # 2. Check for convergence\n        if np.linalg.norm(r)  tolerance:\n            break\n\n        # 3. Calculate the Jacobian matrix J\n        J11 = V_T_n / c_Os\n        J12 = -V_T_n / c_Rs\n        J21 = -D_O\n        J22 = -D_R\n        J = np.array([[J11, J12], [J21, J22]])\n\n        # 4. Solve the linear system J * delta_c = -r for the update step delta_c\n        delta_c = np.linalg.solve(J, -r)\n\n        # 5. Apply update with damping to ensure positivity\n        alpha = 1.0\n        while alpha > min_alpha:\n            c_s_new = c_s + alpha * delta_c\n            if c_s_new[0] > 0 and c_s_new[1] > 0:\n                c_s = c_s_new\n                break\n            alpha /= 2.0\n        else:\n            raise RuntimeError(\"Newton-Raphson failed to converge (damping factor became too small).\")\n\n    else: # This else clause belongs to the for loop, executes if loop finishes without break\n        raise RuntimeError(f\"Newton-Raphson failed to converge within {max_iterations} iterations.\")\n\n    # --- Current Calculation ---\n    c_Os_final = c_s[0]\n    current = n * F * D_O * (c_Os_final - c_O1) / h\n\n    return current\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}