{
    "hands_on_practices": [
        {
            "introduction": "在编写任何模拟代码之前，理解其基本约束至关重要。第一个实践练习聚焦于显式有限差分法的稳定性条件，这是一个关键概念，它将空间网格、时间步长和系统的物理性质联系在一起。通过这个计算()，你将亲身体验如何选择合适的模拟参数，以确保数值解的稳定性和有效性。",
            "id": "4242524",
            "problem": "位于 $x=0$ 处的平面电极在 $t=0$ 时刻经历一个瞬时电位阶跃，该阶跃驱动了占据 $x>0$ 空间的半无限电解质中，体相浓度为 $c^{\\ast}$ 的单一电活性物质发生扩散限制的还原反应。沿一维法向方向 $x$ 的浓度场 $c(x,t)$ 遵循 Fick 第二定律，$$\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^{2} c}{\\partial x^{2}},$$ 初始条件为 $c(x,0)=c^{\\ast}$，电极处的边界条件为 $c(0,t)=0$，且当 $x\\to\\infty$ 时 $c(x,t)\\to c^{\\ast}$。您将使用空间步长为 $\\Delta x$ 的均匀网格，采用向前时间中心空间（FTCS）显式有限差分格式对计时安培法进行数字模拟。\n\n为精确捕捉电流响应的早期 Cottrell $t^{-1/2}$ 行为区域，您计划模拟从 $t=0$ 到上限时间 $t_{\\min}$ 的过程，该上限时间标志着您的体系中严格由 $t^{-1/2}$ 主导区域的结束。为在保持数值稳定性的同时最小化计算量，您将选择由离散扩散算子的线性傅里叶模态（von Neumann）分析得出的显式FTCS稳定性条件所允许的最大时间步长 $\\Delta t$。\n\n给定参数 $D = 9.0 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$，$\\Delta x = 5.0 \\times 10^{-8}\\ \\mathrm{m}$ 和 $t_{\\min} = 2.0 \\times 10^{-3}\\ \\mathrm{s}$，请确定使用最大稳定 $\\Delta t$ 达到 $t_{\\min}$ 所需的最少时间步数。将您的最终答案表示为单个无量纲整数。由于答案由稳定性极限和覆盖 $t_{\\min}$ 的要求精确确定，因此无需四舍五入。",
            "solution": "该问题要求计算在使用显式有限差分格式和最大可能稳定时间步长的情况下，对计时安培法进行数字模拟直至时间 $t_{\\min}$ 所需的最少时间步数。\n\n该物理过程由一维 Fick 第二定律控制：\n$$\n\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^{2} c}{\\partial x^{2}}\n$$\n其中 $c(x,t)$ 是电活性物质的浓度，$D$ 是扩散系数，$x$ 是垂直于电极的空间坐标，$t$ 是时间。\n\n指定的数值方法是向前时间中心空间（FTCS）显式有限差分格式。我们将连续域 $(x,t)$ 离散化为一个网格，网格点为 $(x_j, t_n)$，其中 $x_j = j \\Delta x$ 且 $t_n = n \\Delta t$。令 $c_j^n$ 表示 $c(x_j, t_n)$ 的数值近似。\n\n控制方程的FTCS离散化形式为：\n$$\n\\frac{c_j^{n+1} - c_j^n}{\\Delta t} = D \\frac{c_{j+1}^n - 2c_j^n + c_{j-1}^n}{(\\Delta x)^2}\n$$\n这是一个显式格式，因为新时间步的浓度 $c_j^{n+1}$ 可以直接由当前时间步的浓度 $c^n_j$ 计算得出。更新方程为：\n$$\nc_j^{n+1} = c_j^n + \\frac{D \\Delta t}{(\\Delta x)^2} (c_{j+1}^n - 2c_j^n + c_{j-1}^n)\n$$\n该格式的稳定性由无量纲扩散数控制，我们将其记为 $r$：\n$$\nr = \\frac{D \\Delta t}{(\\Delta x)^2}\n$$\n对应用于一维扩散方程的FTCS格式进行的 von Neumann 稳定性分析表明，该格式是条件稳定的。稳定性条件是：\n$$\nr \\le \\frac{1}{2}\n$$\n或等价地，\n$$\n\\frac{D \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}\n$$\n为了最小化时间步数，从而降低计算成本，我们必须使用满足此条件的最大可能时间步长 $\\Delta t$。这个最大稳定时间步长 $\\Delta t_{\\max}$ 是通过将表达式设为其极限值得到的：\n$$\n\\frac{D \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\n求解 $\\Delta t_{\\max}$ 可得：\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2D}\n$$\n问题给出了以下数值：\n- 扩散系数, $D = 9.0 \\times 10^{-10}\\ \\mathrm{m^{2}\\,s^{-1}}$\n- 空间步长, $\\Delta x = 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n- 总模拟时间, $t_{\\min} = 2.0 \\times 10^{-3}\\ \\mathrm{s}$\n\n现在我们可以计算 $\\Delta t_{\\max}$ 的数值：\n$$\n\\Delta t_{\\max} = \\frac{(5.0 \\times 10^{-8}\\ \\mathrm{m})^2}{2 \\times (9.0 \\times 10^{-10}\\ \\mathrm{m^2\\,s^{-1}})} = \\frac{25.0 \\times 10^{-16}\\ \\mathrm{m^2}}{1.8 \\times 10^{-9}\\ \\mathrm{m^2\\,s^{-1}}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{25.0}{1.8} \\times 10^{-7}\\ \\mathrm{s} = \\frac{250}{18} \\times 10^{-8}\\ \\mathrm{s} = \\frac{125}{9} \\times 10^{-8}\\ \\mathrm{s}\n$$\n为清晰起见，我们用分数来表示这个值：\n$$\n\\Delta t_{\\max} = \\frac{25 \\times 10^{-16}}{18 \\times 10^{-10}}\\ \\mathrm{s} = \\frac{25}{18} \\times 10^{-6}\\ \\mathrm{s}\n$$\n达到总模拟时间 $t_{\\min}$ 所需的最少时间步数 $N$，是总时间除以单个时间步长 $\\Delta t_{\\max}$。如果该比率不是整数，我们必须对结果向上取整，以确保总模拟时长至少为 $t_{\\min}$。\n$$\nN = \\left\\lceil \\frac{t_{\\min}}{\\Delta t_{\\max}} \\right\\rceil\n$$\n代入数值：\n$$\nN = \\left\\lceil \\frac{2.0 \\times 10^{-3}\\ \\mathrm{s}}{\\frac{25}{18} \\times 10^{-6}\\ \\mathrm{s}} \\right\\rceil\n$$\n$$\nN = \\left\\lceil \\frac{2.0 \\times 10^{-3} \\times 18}{25 \\times 10^{-6}} \\right\\rceil = \\left\\lceil \\frac{36.0}{25.0} \\times 10^3 \\right\\rceil\n$$\n$$\nN = \\lceil 1.44 \\times 10^3 \\rceil = \\lceil 1440 \\rceil\n$$\n由于除法的结果是一个精确的整数，向上取整函数不改变其值。最少时间步数精确为 $1440$。",
            "answer": "$$\\boxed{1440}$$"
        },
        {
            "introduction": "在理解了稳定性的要求后，下一步便是构建模拟本身。本实践()将指导你实现前向时间中心空间（FTCS）显式格式，这是求解扩散方程的基础算法。更重要的是，你将学习一项基本技能：通过将数值代码的输出与著名的Cottrell方程的解析解进行比较来验证代码，从而量化模拟的准确性。",
            "id": "4242489",
            "problem": "考虑一个可还原物质在一维半无限平面上向电极的扩散。在时间 $t=0$ 时，一个电位阶跃瞬时将电极表面浓度设为零。该物质的本体浓度为 $c^\\ast$，扩散系数为 $D$。其控制方程为一维菲克第二定律，可写作 $ \\partial c / \\partial t = D \\, \\partial^2 c / \\partial x^2 $，其中 $x \\ge 0$ 且 $t > 0$。该方程受以下条件约束：初始条件 $ c(x,0) = c^\\ast $，电极表面边界条件 $ c(0,t) = 0 $ (对于所有 $t > 0$)，以及远场边界条件 $ c(\\infty,t) = c^\\ast $。可测量的电流由电极表面的扩散通量给出，$ i(t) = n \\, F \\, A \\, \\left( - D \\, \\left. \\partial c / \\partial x \\right|_{x=0} \\right) $，其中 $n$ 是每个分子转移的电子数，$F$ 是法拉第常数，$A$ 是电极面积。\n\n用于验证早期行为的成熟基准是 Cottrell 关系式，$ i_C(t) = n \\, F \\, A \\, c^\\ast \\, \\sqrt{ D / (\\pi \\, t) } $，它在所述边界和初始条件下对半无限扩散成立。\n\n您将使用前向时间、中心空间（显式）有限差分格式，在具有 $N$ 个均匀间隔网格点和狄利克雷边界条件 $ c(0,t) = 0 $ 与 $ c(L,t) = c^\\ast $ 的截断域 $ [0, L] $ 上，实现计时电流法的数字模拟。将空间步长记为 $ \\Delta x = L/(N-1) $，时间步长记为 $ \\Delta t $。定义无量纲参数 $ \\lambda = D \\, \\Delta t / \\Delta x^2 $。内部节点 $ j = 1,2,\\ldots,N-2 $ 的离散更新公式为\n$$ c_j^{n+1} = c_j^n + \\lambda \\left( c_{j+1}^n - 2 \\, c_j^n + c_{j-1}^n \\right), $$\n对于所有时间索引 $n$，$ c_0^n = 0 $ 且 $ c_{N-1}^n = c^\\ast $。使用二阶单边有限差分近似表面梯度\n$$ \\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0} \\approx \\frac{-3 \\, c_0^n + 4 \\, c_1^n - c_2^n}{2 \\, \\Delta x}. $$\n用此公式在离散时间 $ t_n = n \\, \\Delta t $ (其中 $n \\ge 1$) 计算模拟电流 $ i_{\\text{sim}}(t_n) $，并与 $ i_C(t_n) $进行比较。\n\n您的任务是通过计算前 $k_{\\max}$ 个时间步内的最大相对误差，来量化早期离散化误差作为 $ \\lambda $ 的函数。其中，时间 $ t_n $ 的相对误差定义为\n$$ \\varepsilon_n = \\frac{ \\left| i_{\\text{sim}}(t_n) - i_C(t_n) \\right| }{ i_C(t_n) }, \\quad \\text{且} \\quad \\varepsilon(\\lambda) = \\max_{1 \\le n \\le k_{\\max}} \\varepsilon_n. $$\n\n使用以下符合科学实际的参数值和单位来实现模拟：\n- $ D = 1 \\times 10^{-9} $，单位为 $\\text{m}^2/\\text{s}$，\n- $ c^\\ast = 1 \\times 10^{-3} $，单位为 $\\text{mol}/\\text{m}^3$，\n- $ A = 1 \\times 10^{-4} $，单位为 $\\text{m}^2$，\n- $ n = 1 $ (无量纲)，\n- $ F = 96485.33212 $，单位为 $\\text{C}/\\text{mol}$，\n- $ L = 5 \\times 10^{-4} $，单位为 $\\text{m}$，\n- $ N = 801 $ (无量纲)，\n- $ k_{\\max} = 5 $ (无量纲)。\n\n测试集是五个 $ \\lambda $ 值：\n- $ \\lambda = 0.05 $,\n- $ \\lambda = 0.10 $,\n- $ \\lambda = 0.25 $,\n- $ \\lambda = 0.45 $,\n- $ \\lambda = 0.50 $.\n\n对于测试集中的每个 $ \\lambda $，计算如上定义的 $ \\varepsilon(\\lambda) $。最终输出是代表每个测试用例最大相对误差的无量纲浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$ [r_1, r_2, r_3, r_4, r_5] $）。输出中不需要单位，因为相对误差是无量纲的。请确保正确应用有限差分格式，遵守显式格式的稳定性限制 $ \\lambda \\le 0.5 $，并强制执行在 $ x = L $ 处的狄利克雷远场边界条件。程序必须是自包含的，不需要用户输入，并且能在任何支持数值数组的标准环境中运行。",
            "solution": "该问题已经过验证，被确定为是合理的、适定的和有科学依据的。它提出了计算电化学中的一个标准任务：根据已知的解析解来验证数值方案。\n\n目标是实现半无限平面扩散控制下计时电流法的数字模拟，并量化显式有限差分格式的早期精度与无量纲参数 $\\lambda$ 的函数关系。该模拟在有限空间域 $[0, L]$ 上对菲克第二定律 $\\partial c / \\partial t = D \\, \\partial^2 c / \\partial x^2$ 进行建模，其初始浓度为 $c(x, 0) = c^\\ast$，边界条件为 $c(0, t) = 0$ 和 $c(L, t) = c^\\ast$。\n\n首先，我们为模拟建立离散框架。长度为 $L = 5 \\times 10^{-4} \\, \\text{m}$ 的空间域被离散为 $N = 801$ 个均匀间隔的点，索引为 $j = 0, 1, \\dots, N-1$。相邻点之间的距离，即空间步长 $\\Delta x$，由下式给出：\n$$ \\Delta x = \\frac{L}{N-1} = \\frac{5 \\times 10^{-4} \\, \\text{m}}{801-1} = 6.25 \\times 10^{-7} \\, \\text{m} $$\n时间域被离散为大小为 $\\Delta t$ 的步长。这个时间步长在不同测试用例中不是恒定的；它取决于给定的无量纲扩散参数 $\\lambda = D \\Delta t / \\Delta x^2$。对于每个给定的 $\\lambda$ 值，相应的时间步长计算如下：\n$$ \\Delta t = \\frac{\\lambda \\, \\Delta x^2}{D} $$\n其中 $D = 1 \\times 10^{-9} \\, \\text{m}^2/\\text{s}$ 是扩散系数。\n\n模拟从时间 $t=0$ 开始，对应于时间索引 $n=0$。初始条件是物质在整个域中都处于其本体浓度 $c^\\ast = 1 \\times 10^{-3} \\, \\text{mol}/\\text{m}^3$。电位阶跃在 $t=0$ 时施加，瞬时耗尽电极表面的物质。在离散模型中，这通过将第一个网格点的浓度设置为零来表示。因此，模拟的初始浓度分布（在时间索引 $n=0$ 时）为：\n$$ c_j^0 = \\begin{cases} 0 & \\text{若 } j=0 \\\\ c^\\ast & \\text{若 } j=1, 2, \\dots, N-1 \\end{cases} $$\n在所有后续时间步 $n > 0$ 中，边界条件都得以维持：表面浓度 $c_0^n$ 保持为 $0$，远场浓度 $c_{N-1}^n$ 保持在 $c^\\ast$。所选的 $L$ 值足够大，使得在短暂的模拟持续时间内，$x=L$ 处的浓度不受影响，这使其成为半无限域的有效近似。\n\n浓度分布随时间的演化由前向时间、中心空间 (FTCS) 有限差分格式控制。对于每个时间步，下一个时间层级的浓度 $c_j^{n+1}$ 是通过对所有内部节点 ($j=1, 2, \\dots, N-2$) 使用显式更新规则，从当前层级的分布 $c_j^n$ 计算得出的：\n$$ c_j^{n+1} = c_j^n + \\lambda \\left( c_{j+1}^n - 2c_j^n + c_{j-1}^n \\right) $$\n这个计算会迭代进行，总共 $k_{\\max}=5$ 个时间步。\n\n在每个离散时间 $t_n = n \\Delta t$（其中 $n \\in \\{1, 2, \\dots, k_{\\max}\\}$），我们计算电流。电流与电极表面的通量成正比，而通量又取决于浓度梯度 $\\left. \\partial c / \\partial x \\right|_{x=0}$。问题指定了使用时间 $n$ 的浓度，通过二阶精度的单边有限差分来近似这个梯度：\n$$ \\left. \\frac{\\partial c}{\\partial x} \\right|_{x=0, t=t_n} \\approx \\frac{-3c_0^n + 4c_1^n - c_2^n}{2\\Delta x} $$\n由于对于所有 $n \\ge 1$，$c_0^n = 0$，这可以简化为 $(4c_1^n - c_2^n)/(2\\Delta x)$。模拟电流的大小 $|i_{\\text{sim}}(t_n)|$ 于是为：\n$$ |i_{\\text{sim}}(t_n)| = nFA D \\left| \\frac{4c_1^n - c_2^n}{2\\Delta x} \\right| $$\n其中 $n=1$ 是电子数，$F = 96485.33212 \\, \\text{C}/\\text{mol}$ 是法拉第常数，$A = 1 \\times 10^{-4} \\, \\text{m}^2$ 是电极面积。\n\n将此模拟电流与该问题的解析解，即 Cottrell 方程进行比较，该方程给出了理论电流大小 $i_C(t_n)$：\n$$ i_C(t_n) = \\frac{n F A c^\\ast \\sqrt{D}}{\\sqrt{\\pi t_n}} $$\n每个时间步的相对误差 $\\varepsilon_n$ 定义为：\n$$ \\varepsilon_n = \\frac{| \\, |i_{\\text{sim}}(t_n)| - i_C(t_n) \\, |}{i_C(t_n)} $$\n注意，常数因子 $nFA$ 在分子和分母中被消去，从而将计算简化为通量项的比较。\n对于测试集中的每个 $\\lambda$ 值，模拟运行 $k_{\\max}=5$ 步，生成一组误差 $\\{\\varepsilon_1, \\varepsilon_2, \\varepsilon_3, \\varepsilon_4, \\varepsilon_5\\}$。每个测试用例最终报告的值 $\\varepsilon(\\lambda)$ 是这五个误差值中的最大值：\n$$ \\varepsilon(\\lambda) = \\max_{1 \\le n \\le k_{\\max}} \\varepsilon_n $$\n总体算法如下：对于每个 $\\lambda$，初始化浓度分布，然后从 $n=1$ 循环到 $k_{\\max}$。在每次迭代中，将模拟推进一个时间步以找到浓度分布 $c^n$，然后计算 $\\varepsilon_n$。循环结束后，在计算出的值中找到最大误差。对所有指定的 $\\lambda$ 值重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a digital simulation of chronoamperometry to quantify the\n    early-time discretization error of an explicit finite-difference scheme.\n    \"\"\"\n\n    # --- Scientific and Physical Constants ---\n    # Diffusion coefficient (m^2/s)\n    D = 1.0e-9\n    # Bulk concentration (mol/m^3)\n    C_STAR = 1.0e-3\n    # Electrode area (m^2)\n    A = 1.0e-4\n    # Number of electrons transferred\n    N_ELECTRONS = 1\n    # Faraday constant (C/mol)\n    F = 96485.33212\n\n    # --- Simulation Domain and Discretization Parameters ---\n    # Truncated domain length (m)\n    L = 5.0e-4\n    # Number of spatial grid points\n    N_POINTS = 801\n    # Maximum number of time steps to check for error\n    K_MAX = 5\n\n    # --- Test Suite ---\n    # Dimensionless diffusion parameter values to test\n    lambda_test_suite = [0.05, 0.10, 0.25, 0.45, 0.50]\n\n    # --- Calculations ---\n    # Spatial step size (m)\n    delta_x = L / (N_POINTS - 1)\n\n    results = []\n    for lambda_val in lambda_test_suite:\n        # Time step (s), dependent on lambda\n        delta_t = (lambda_val * delta_x**2) / D\n\n        # Initialize the concentration array for time t=0.\n        # c[0] is at the electrode surface (x=0).\n        # The potential step sets c[0] to 0 instantaneously.\n        c = np.full(N_POINTS, C_STAR)\n        c[0] = 0.0\n\n        relative_errors = []\n        # Time-stepping loop from n=1 to k_max\n        for n_step in range(1, K_MAX + 1):\n            # Store the concentration profile from the previous time step\n            c_old = c.copy()\n\n            # Evolve concentration for interior nodes using the FTCS scheme\n            # c[1:-1] corresponds to j = 1, ..., N-2\n            # c_old[2:]     corresponds to c_{j+1}\n            # c_old[1:-1]   corresponds to c_{j}\n            # c_old[0:-2]   corresponds to c_{j-1}\n            c[1:-1] = c_old[1:-1] + lambda_val * (c_old[2:] - 2 * c_old[1:-1] + c_old[0:-2])\n            \n            # Boundary conditions c[0]=0 and c[-1]=c_star are maintained\n            # throughout the simulation. c[0] is never updated, and c[-1] is\n            # not part of the interior node slice.\n\n            # Current time t_n = n * delta_t\n            t = n_step * delta_t\n\n            # --- Calculate Simulated vs. Analytical Current (Flux) ---\n            # The factor n*F*A is common to both and cancels in relative error.\n            # We only need to compare the flux terms for efficiency.\n            \n            # Simulated flux magnitude, J_sim = D * |grad c_sim|\n            # Gradient is approximated by the second-order one-sided formula.\n            # grad_c = (-3*c[0] + 4*c[1] - c[2]) / (2*delta_x). Since c[0]=0,\n            # this simplifies to (4*c[1] - c[2]) / (2*delta_x).\n            flux_sim = D * (4 * c[1] - c[2]) / (2 * delta_x)\n\n            # Analytical (Cottrell) flux magnitude, J_C = c* * sqrt(D / (pi*t))\n            flux_cottrell = C_STAR * np.sqrt(D / (np.pi * t))\n\n            # Calculate relative error for this time step\n            error = np.abs(flux_sim - flux_cottrell) / flux_cottrell\n            relative_errors.append(error)\n\n        # Find the maximum relative error over the first k_max steps\n        max_error = np.max(relative_errors)\n        results.append(max_error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然显式方法易于实现，但其严格的稳定性条件可能带来限制。最后一个实践练习()将介绍更为稳健的全隐式方法，该方法无条件稳定，允许使用更大的时间步长。你将实现这一格式，它需要在每个时间步使用高效的Thomas算法求解一个三对角线性方程组，并分析其计算成本，从而更深入地理解不同数值方法之间的权衡。",
            "id": "4242498",
            "problem": "您的任务是使用完全隐式数值格式，为平面电极上的一维扩散限制电位阶跃构建计时电流法的数字模拟。该计算模型必须从 Fick 第二扩散定律出发，通过在每个时间步使用 Thomas 算法求解一个三对角线性系统，来生成指定时间的电流。此外，您必须估算三对角求解器每个时间步的计算成本（包括边界更新），并证明其与空间点数成线性关系。\n\n基本原理包括以下要素：\n- Fick 第二定律：$$\\frac{\\partial c(x,t)}{\\partial t} = D \\frac{\\partial^2 c(x,t)}{\\partial x^2},$$ 其中 $c(x,t)$ 是浓度（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$），$D$ 是扩散系数（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）。\n- 代表在 $x=0$ 处的平面电极上进行扩散限制电位阶跃计时电流法实验的边界条件：对于 $t \\ge 0$，$$c(0,t) = 0$$，以及在 $x=L$ 处的远端边界，该处维持本体浓度：$$c(L,t) = c^\\ast.$$\n- 初始条件：$$c(x,0) = c^\\ast.$$\n- 电极处的通量：$$j(t) = -D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0^+},$$ 单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- 由通量计算电流：$$i(t) = n F A\\, j(t),$$ 其中 $n$ 是转移的电子数，$F$ 是法拉第常数（单位为 $\\mathrm{C}\\,\\mathrm{mol}^{-1}$），$A$ 是电极面积（单位为 $\\mathrm{m}^2$）。\n\n实现以下内容：\n- 使用 $N$ 个均匀间隔的网格点对空间域 $[0,L]$ 进行离散化，间距为 $$\\Delta x = \\frac{L}{N-1}.$$ 使用时间步长为 $$\\Delta t$$ 的完全隐式（后向欧拉法，Backward Euler）进行时间步进。离散未知数为内部浓度 $$c_i^{n} \\approx c(x_i, t_n)$$，其中 $i=1,\\dots,N-2$，$$x_i = i\\,\\Delta x.$$\n- 在每个时间步，Fick 第二定律的隐式离散化会为新时间层级的内部浓度生成一个三对角线性系统。使用 Thomas 算法求解此系统。将 $x=0$ 和 $x=L$ 处的 Dirichlet 边界值适当地并入右侧项。\n- 使用 $x=0$ 处梯度的单边有限差分近似计算电极电流：$$\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0^+} \\approx \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x},$$ 其中 $$c_0^{n+1} = 0.$$ 报告代数电流 $$i(t_{n+1})$$（单位为安培），对于电极上阴极的扩散限制消耗，该值将为负。\n\n此外，请估算将 Thomas 算法应用于大小为 $$M = N-2$$（内部点数）的三对角系统时，每个时间步的算术运算次数。估算必须包括：\n- 用于三对角系统的 Thomas 算法的前向消元和回代步骤。\n- 由 $x=0$ 和 $x=L$ 处的 Dirichlet 条件引起的边界更新。\n- 电极通量的计算及到电流的转换。\n\n将估算的每时间步成本表示为 $$N$$ 的函数，并证明其标度为 $$O(N)$$。\n\n物理单位：\n- 长度单位必须是米 ($\\mathrm{m}$)，时间单位是秒 ($\\mathrm{s}$)，浓度单位是 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，扩散系数单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，电流单位是安培 ($\\mathrm{A}$)。\n- 不使用角度。\n- 此问题不涉及百分比。\n\n测试套件：\n使用以下三组参数集，每组在最终时间产生一个电流值和每个时间步的一个整数运算计数。对于所有情况，假设 $$n=1,$$ $$F=96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1},$$ 和 $$c^\\ast=1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}.$$\n1. 情况 A（正常路径）：\n   - $$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,$$\n   - $$L = 5.0 \\times 10^{-4}\\,\\mathrm{m},\\quad N = 101,$$\n   - $$\\Delta t = 1.0 \\times 10^{-2}\\,\\mathrm{s},\\quad T_{\\text{end}} = 2.0 \\times 10^{-1}\\,\\mathrm{s}.$$\n2. 情况 B（具有最少内部点的边界大小边缘情况）：\n   - $$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,$$\n   - $$L = 5.0 \\times 10^{-4}\\,\\mathrm{m},\\quad N = 3,$$\n   - $$\\Delta t = 1.0 \\times 10^{-1}\\,\\mathrm{s},\\quad T_{\\text{end}} = 2.0 \\times 10^{-1}\\,\\mathrm{s}.$$\n3. 情况 C（用于测试线性标度的大型系统）：\n   - $$D = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,$$\n   - $$L = 5.0 \\times 10^{-4}\\,\\mathrm{m},\\quad N = 1001,$$\n   - $$\\Delta t = 5.0 \\times 10^{-5}\\,\\mathrm{s},\\quad T_{\\text{end}} = 1.0 \\times 10^{-2}\\,\\mathrm{s}.$$\n\n程序输出规范：\n- 您的程序应独立模拟每种情况，计算在 $$T_{\\text{end}}$$ 时的电流（单位为安培）和作为 $$N$$ 的函数的每个时间步的估算整数运算次数，并将六个结果汇总到一个列表中。\n- 最终输出必须是单行，形式为方括号内以逗号分隔的列表，顺序为：$$[i_A,\\,\\text{cost}_A,\\,i_B,\\,\\text{cost}_B,\\,i_C,\\,\\text{cost}_C],$$ 其中 $$i_A, i_B, i_C$$ 是以安培为单位的浮点电流值，而 $$\\text{cost}_A, \\text{cost}_B, \\text{cost}_C$$ 是代表每个时间步估算运算次数的整数。",
            "solution": "该问题要求基于 Fick 第二扩散定律，为平面电极上的计时电流法构建数字模拟。解决方案必须采用完全隐式有限差分格式，在每个时间步使用 Thomas 算法求解所得的三对角系统，并提供计算成本的估算。\n\n首先，我们对控制偏微分方程，即 Fick 第二定律进行离散化：\n$$\n\\frac{\\partial c(x,t)}{\\partial t} = D \\frac{\\partial^2 c(x,t)}{\\partial x^2}\n$$\n空间域 $[0, L]$ 被离散化为 $N$ 个点 $x_i = i \\Delta x$（$i=0, 1, \\dots, N-1$），均匀网格间距为 $\\Delta x = L/(N-1)$。时间以恒定的步长 $\\Delta t$ 离散化，使得 $t_n = n \\Delta t$。在网格点 $x_i$ 和时间 $t_n$ 的浓度表示为 $c_i^n \\approx c(x_i, t_n)$。\n\n使用完全隐式（后向欧拉法，Backward Euler）格式，时间导数在时间层级 $n+1$ 处近似为：\n$$\n\\frac{\\partial c}{\\partial t} \\approx \\frac{c_i^{n+1} - c_i^n}{\\Delta t}\n$$\n空间二阶导数也使用中心差分近似在新时间层级 $n+1$ 处进行评估：\n$$\n\\frac{\\partial^2 c}{\\partial x^2} \\approx \\frac{c_{i-1}^{n+1} - 2c_i^{n+1} + c_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n将这些近似代入 Fick 定律，得到每个内部网格点 $i = 1, 2, \\dots, N-2$ 的有限差分方程：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = D \\frac{c_{i-1}^{n+1} - 2c_i^{n+1} + c_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n我们定义一个无量纲参数 $\\lambda = D \\Delta t / (\\Delta x)^2$。重新整理方程，将时间层级 $n+1$ 的未知浓度组合在左侧，将时间层级 $n$ 的已知浓度放在右侧，得到：\n$$\n-\\lambda c_{i-1}^{n+1} + (1 + 2\\lambda) c_i^{n+1} - \\lambda c_{i+1}^{n+1} = c_i^n\n$$\n这组针对 $i = 1, \\dots, N-2$ 的线性方程构成一个大小为 $M \\times M$ 的三对角系统，其中 $M = N-2$ 是内部点的数量。该系统可以写成矩阵形式 $\\mathbf{A} \\mathbf{c}^{n+1} = \\mathbf{d}^n$。\n\n边界条件为 $c(0,t) = 0$ 和 $c(L,t) = c^\\ast$。在我们的离散系统中，这意味着对于所有 $n \\ge 0$，$c_0^{n+1} = 0$ 和 $c_{N-1}^{n+1} = c^\\ast$。这些已知值被并入系统中。\n\n对于第一个内部点（$i=1$）：\n$$\n-\\lambda c_{0}^{n+1} + (1 + 2\\lambda) c_1^{n+1} - \\lambda c_2^{n+1} = c_1^n\n$$\n由于 $c_0^{n+1} = 0$，方程变为：\n$$\n(1 + 2\\lambda) c_1^{n+1} - \\lambda c_2^{n+1} = c_1^n\n$$\n对于最后一个内部点（$i=N-2$）：\n$$\n-\\lambda c_{N-3}^{n+1} + (1 + 2\\lambda) c_{N-2}^{n+1} - \\lambda c_{N-1}^{n+1} = c_{N-2}^n\n$$\n由于 $c_{N-1}^{n+1} = c^\\ast$，我们将这个已知项移到右侧：\n$$\n-\\lambda c_{N-3}^{n+1} + (1 + 2\\lambda) c_{N-2}^{n+1} = c_{N-2}^n + \\lambda c^\\ast\n$$\n对于大小为 $M=N-2$ 的系统，三对角矩阵 $\\mathbf{A}$ 具有以下结构：\n次对角线：$a_i = -\\lambda$，$i=1, \\dots, M-1$。\n主对角线：$b_i = 1+2\\lambda$，$i=1, \\dots, M$。\n超对角线：$c_i = -\\lambda$，$i=1, \\dots, M-1$。\n\n右侧向量 $\\mathbf{d}$ 由前一个时间步的浓度构成：$d_i = c_i^n$，$i=1, \\dots, M-1$，以及 $d_M = c_{N-2}^n + \\lambda c^\\ast$。\n\n这个系统可以使用 Thomas 算法（三对角矩阵算法或 TDMA）高效求解，该算法是高斯消去法的一种应用。该算法包括两个阶段：前向消元扫描和回代扫描。\n\n在求解得到新浓度 $\\mathbf{c}^{n+1} = (c_1^{n+1}, \\dots, c_{N-2}^{n+1})$ 后，计算电流 $i(t_{n+1})$。电极（$x=0$）处的通量 $j(t)$ 由 $j(t) = -D (\\partial c / \\partial x)|_{x=0}$ 给出。我们使用单边有限差分来近似梯度：\n$$\n\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} \\approx \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x} = \\frac{c_1^{n+1}}{\\Delta x}\n$$\n通量则为 $j(t_{n+1}) = -D \\frac{c_1^{n+1}}{\\Delta x}$。电流通过法拉第电解定律 $i(t) = n F A j(t)$ 获得：\n$$\ni(t_{n+1}) = n F A \\left(-D \\frac{c_1^{n+1}}{\\Delta x}\\right) = -\\frac{n F A D}{\\Delta x} c_1^{n+1}\n$$\n\n接下来，我们估算每个时间步的计算成本，作为 $N$ 的函数。成本包括建立系统、求解系统和计算电流。\n1.  **参数计算**：在每一步，可能需要重新计算 $\\lambda = D \\Delta t / (\\Delta x)^2$。假设 $\\Delta x$ 已预先计算，这需要 1 次乘法（用于 $(\\Delta x)^2$），1 次乘法（$D \\Delta t$），和 1 次除法，共 3 次运算。我们包括一次 $\\Delta x = L/(N-1)$ 的计算，增加 1 次除法。总共：4 次运算。\n2.  **右侧项 (RHS) 更新**：向量 $\\mathbf{d}$ 主要是旧浓度的副本。唯一的算术运算是针对最后一个元素：$d_M = c_{M+1}^n + \\lambda c^\\ast$。这需要 1 次乘法和 1 次加法，共 2 次运算。\n3.  **Thomas 算法 (TDMA)**：对于一个大小为 $M$ 的系统，Thomas 算法的一个标准的非破坏性实现大约需要 $8M - 7$ 次浮点运算（对于 $M>1$）。当 $M=N-2$ 时，这是 $8(N-2) - 7 = 8N - 16 - 7 = 8N - 23$ 次运算。\n4.  **电流计算**：计算 $i = -(nFAD/\\Delta x) c_1^{n+1}$ 涉及 3 次乘法和 1 次除法来计算预乘因子，以及与 $c_1^{n+1}$ 的 1 次最终乘法。总共：5 次运算。\n\n每个时间步的总估算成本是这些贡献的总和：\n$$\n\\text{Cost}(N) = \\text{Cost}_{\\lambda} + \\text{Cost}_{\\text{RHS}} + \\text{Cost}_{\\text{TDMA}} + \\text{Cost}_{\\text{current}}\n$$\n$$\n\\text{Cost}(N) = 4 + 2 + (8N - 23) + 5 = 8N - 12\n$$\n对于边缘情况 $N=3$，则 $M=1$。对于一个 $1 \\times 1$ 系统 $b_1 x_1 = d_1$，TDMA 算法简化为 $x_1 = d_1 / b_1$。方程是 $(1+2\\lambda)c_1^{n+1} = c_1^n + \\lambda c^\\ast$。求解的成本是：分母 $(1+2\\lambda)$ 需要 1 次乘法和 1 次加法，还有 1 次除法。总共 3 次运算。因此对于 $N=3$，总成本是 $4 (\\lambda) + 2 (\\text{RHS}) + 3 (\\text{solve}) + 5 (\\text{current}) = 14$。通用公式 $8N-12$ 得出 $8(3)-12=12$，这是一个合理的近似，与线性标度一致。我们将对所有情况使用公式 $\\text{Cost}(N) = 8N - 12$，因为它正确地捕捉了主要的 $O(N)$ 行为。这种线性标度是 Thomas 算法用于三对角系统的一个关键优势。\n\n模拟从初始条件 $c(x,0) = c^\\ast$ 开始。我们从 $t=0$ 开始应用边界条件 $c(0,t)=0$，因此初始浓度分布为 $c(0,0)=0$ 和 $c(x_i, 0)=c^\\ast$（对于 $i > 0$）。模拟通过在每个时间步迭代求解浓度分布，直到 $t=T_{\\text{end}}$ 为止。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef thomas_algorithm(a, b, c, d):\n    \"\"\"\n    Solves a tridiagonal system of equations Ax=d.\n    a: sub-diagonal vector (length M-1)\n    b: main-diagonal vector (length M)\n    c: super-diagonal vector (length M-1)\n    d: right-hand side vector (length M)\n    Returns the solution vector x (length M).\n    \"\"\"\n    M = len(d)\n    if M == 0:\n        return np.array([])\n    if M == 1:\n        return np.array([d[0] / b[0]])\n\n    # Create copies to avoid modifying the original arrays\n    c_prime = np.zeros(M)\n    d_prime = np.zeros(M)\n    \n    # Forward elimination\n    c_prime[0] = c[0] / b[0]\n    d_prime[0] = d[0] / b[0]\n    for i in range(1, M):\n        denominator = b[i] - a[i-1] * c_prime[i-1]\n        if i < M - 1:\n            c_prime[i] = c[i] / denominator\n        d_prime[i] = (d[i] - a[i-1] * d_prime[i-1]) / denominator\n\n    # Backward substitution\n    x = np.zeros(M)\n    x[M-1] = d_prime[M-1]\n    for i in range(M-2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i+1]\n        \n    return x\n\ndef solve():\n    \"\"\"\n    Main function to run chronoamperometry simulations for the given test cases.\n    \"\"\"\n    # Physical and electrochemical constants\n    n_electrons = 1.0\n    F_const = 96485.33212  # C/mol\n    c_star = 1.0  # mol/m^3\n\n    test_cases = [\n        # Case A: Happy path\n        {'D': 1.0e-9, 'A': 1.0e-4, 'L': 5.0e-4, 'N': 101, 'dt': 1.0e-2, 'T_end': 2.0e-1},\n        # Case B: Boundary-size edge case\n        {'D': 1.0e-9, 'A': 1.0e-4, 'L': 5.0e-4, 'N': 3, 'dt': 1.0e-1, 'T_end': 2.0e-1},\n        # Case C: Large system\n        {'D': 1.0e-9, 'A': 1.0e-4, 'L': 5.0e-4, 'N': 1001, 'dt': 5.0e-5, 'T_end': 1.0e-2},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        D = case['D']\n        A = case['A']\n        L = case['L']\n        N = case['N']\n        dt = case['dt']\n        T_end = case['T_end']\n\n        # Discretization parameters\n        dx = L / (N - 1)\n        lambda_val = D * dt / (dx**2)\n        \n        # Initial condition\n        c = np.full(N, c_star)\n        c[0] = 0.0 # At t=0, potential is stepped, c(0,0)=0\n        \n        # Number of interior points\n        M = N - 2\n\n        # Set up the constant tridiagonal matrix coefficients\n        if M > 0:\n            diag_b = np.full(M, 1.0 + 2.0 * lambda_val)\n            sub_a = np.full(M - 1, -lambda_val)\n            super_c = np.full(M - 1, -lambda_val)\n\n        # Time-stepping loop\n        num_steps = int(round(T_end / dt))\n        for _ in range(num_steps):\n            if M > 0:\n                # Set up the right-hand side vector d\n                d = c[1:-1].copy()\n                d[-1] += lambda_val * c_star\n                \n                # Solve the tridiagonal system for the new interior concentrations\n                c_interior_new = thomas_algorithm(sub_a, diag_b, super_c, d)\n                \n                # Update the concentration profile\n                c[1:-1] = c_interior_new\n\n        # Calculate final current at T_end\n        gradient_at_electrode = (c[1] - c[0]) / dx\n        flux = -D * gradient_at_electrode\n        current = n_electrons * F_const * A * flux\n        \n        # Estimate computational cost per time step\n        # Cost = 8N - 12 (derived from 4 ops for lambda, 2 for RHS, 8(N-2)-7 for TDMA, 5 for current)\n        cost = 8 * N - 12\n        \n        results.append(current)\n        results.append(int(cost))\n        \n    print(f\"[{','.join(f'{x:.8f}' if isinstance(x, float) else str(x) for x in results)}]\")\n\nsolve()\n```"
        }
    ]
}