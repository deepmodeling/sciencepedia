{
    "hands_on_practices": [
        {
            "introduction": "贝叶斯推断的核心在于结合先验知识与实验数据来更新我们对模型参数的认知。这个练习提供了一个基础性的分析视角来审视这一过程。通过在高斯分布的框架下进行推导，我们可以得出一个关于后验分布的封闭解，从而清晰地揭示后验均值是如何成为先验均值和数据估计值的精度加权平均值的，这是贝叶斯学习中的一个中心思想。",
            "id": "4237021",
            "problem": "考虑一个计算电化学推断任务，其中从电化学阻抗谱 (EIS) 推断出的电荷转移反应的交换电流密度 $i_{0}$ 被建模为对数正态分布。定义 $\\theta \\equiv \\ln i_{0}$。$\\theta$ 的先验是均值为 $\\mu_{0}$、方差为 $\\sigma_{0}^{2}$ 的高斯分布，即 $\\theta \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$，这等价于 $i_{0}$ 的对数正态先验。一个 EIS 数据集 $y$ 通过非线性最小二乘法拟合到一个机理阻抗模型，得到的 $\\theta$ 的对数似然在其最大似然估计 $\\hat{\\theta}_{L}$ 附近是局部高斯的，观测曲率为 $\\kappa>0$，这意味着二阶泰勒展开得出\n$$\n\\ln p(y \\mid \\theta) \\approx \\ln p(y \\mid \\hat{\\theta}_{L}) - \\frac{1}{2}\\,\\kappa\\,(\\theta - \\hat{\\theta}_{L})^{2}.\n$$\n使用贝叶斯定理和关于最大后验 (MAP) 估计的拉普拉斯近似，推导后验 $p(\\theta \\mid y)$ 的高斯近似，并报告：\n- 近似后验均值（在拉普拉斯近似下等于MAP），以及\n- 近似后验方差（在MAP处对数后验的负二阶导数的倒数），\n以 $\\mu_{0}$、$\\sigma_{0}^{2}$、$\\hat{\\theta}_{L}$ 和 $\\kappa$ 的闭式解析表达式形式。将您的最终答案表示为一个行矩阵，按顺序包含均值和方差。不需要进行数值评估。最终答案必须是无单位的单个解析表达式。",
            "solution": "该问题要求后验概率分布 $p(\\theta \\mid y)$ 的高斯近似的均值和方差，其中 $\\theta \\equiv \\ln i_{0}$ 且 $i_{0}$ 是交换电流密度。推导将基于贝叶斯定理以及为先验和似然提供的高斯近似。\n\n验证问题陈述是第一个关键步骤。\n给定条件如下：\n1.  感兴趣的参数是 $\\theta \\equiv \\ln i_{0}$。\n2.  先验分布是高斯的：$p(\\theta) = \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$。\n3.  对数似然函数由一个二次型近似：$\\ln p(y \\mid \\theta) \\approx \\ln p(y \\mid \\hat{\\theta}_{L}) - \\frac{1}{2}\\kappa(\\theta - \\hat{\\theta}_{L})^{2}$，其中 $\\kappa > 0$。\n\n该问题在科学上和数学上是合理的。它描述了一个标准的贝叶斯推断任务，这是计算电化学中用于参数估计和不确定性量化的常见应用。对对数变换后的参数使用高斯先验（这意味着对原始的严格正参数 $i_0$ 使用对数正态先验）是一种标准且有效的方法。对数似然的二次近似（拉普拉斯近似）是统计学中用于近似后验分布的成熟方法。所有术语都定义清晰，问题是自洽且适定的，存在唯一的解析解。因此，该问题被认为是有效的，并将制定一个解决方案。\n\n根据贝叶斯定理，后验概率密度函数 $p(\\theta \\mid y)$ 与似然 $p(y \\mid \\theta)$ 和先验 $p(\\theta)$ 的乘积成正比：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) p(\\theta)\n$$\n处理后验的对数，即对数后验，更为方便：\n$$\n\\ln p(\\theta \\mid y) = \\ln p(y \\mid \\theta) + \\ln p(\\theta) + C\n$$\n其中 $C$ 是一个不依赖于 $\\theta$ 的比例常数。\n\n$\\theta$ 的先验分布是高斯分布，$\\theta \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$。其概率密度函数是：\n$$\np(\\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma_{0}^{2}}} \\exp\\left(-\\frac{(\\theta - \\mu_{0})^{2}}{2\\sigma_{0}^{2}}\\right)\n$$\n因此，对数先验是：\n$$\n\\ln p(\\theta) = -\\frac{1}{2}\\ln(2\\pi\\sigma_{0}^{2}) - \\frac{(\\theta - \\mu_{0})^{2}}{2\\sigma_{0}^{2}} = C_{\\text{prior}} - \\frac{(\\theta - \\mu_{0})^{2}}{2\\sigma_{0}^{2}}\n$$\n其中 $C_{\\text{prior}}$ 是一个常数。\n\n问题提供了对数似然近似：\n$$\n\\ln p(y \\mid \\theta) \\approx \\ln p(y \\mid \\hat{\\theta}_{L}) - \\frac{1}{2}\\kappa(\\theta - \\hat{\\theta}_{L})^{2} = C_{\\text{like}} - \\frac{1}{2}\\kappa(\\theta - \\hat{\\theta}_{L})^{2}\n$$\n其中 $C_{\\text{like}}$ 是一个相对于 $\\theta$ 的常数。\n\n结合这些，对数后验 $L(\\theta) = \\ln p(\\theta \\mid y)$ 是：\n$$\nL(\\theta) \\approx \\left(C_{\\text{prior}} + C_{\\text{like}}\\right) - \\frac{(\\theta - \\mu_{0})^{2}}{2\\sigma_{0}^{2}} - \\frac{\\kappa}{2}(\\theta - \\hat{\\theta}_{L})^{2}\n$$\n这个表达式是 $\\theta$ 的二次函数。一个其对数为二次函数的概率分布是高斯分布。因此，得到的后验近似是高斯的，我们可以通过分析这个二次型来找到它的均值和方差。\n\n拉普拉斯近似指出，后验可以由一个以最大后验（MAP）估计 $\\hat{\\theta}_{\\text{MAP}}$ 为中心的高斯分布来近似。MAP估计是使 $L(\\theta)$ 最大化的 $\\theta$ 值。我们通过将 $L(\\theta)$ 关于 $\\theta$ 的一阶导数设为零来找到它：\n$$\n\\frac{dL}{d\\theta} = -\\frac{\\theta - \\mu_{0}}{\\sigma_{0}^{2}} - \\kappa(\\theta - \\hat{\\theta}_{L}) = 0\n$$\n求解 $\\theta$ 得到MAP估计，我们将其表示为 $\\mu_{\\text{post}}$：\n$$\n-\\frac{\\mu_{\\text{post}}}{\\sigma_{0}^{2}} + \\frac{\\mu_{0}}{\\sigma_{0}^{2}} - \\kappa\\mu_{\\text{post}} + \\kappa\\hat{\\theta}_{L} = 0\n$$\n$$\n\\mu_{\\text{post}}\\left(\\frac{1}{\\sigma_{0}^{2}} + \\kappa\\right) = \\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\kappa\\hat{\\theta}_{L}\n$$\n$$\n\\mu_{\\text{post}} = \\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\kappa\\hat{\\theta}_{L}}{\\frac{1}{\\sigma_{0}^{2}} + \\kappa}\n$$\n将分子和分母乘以 $\\sigma_{0}^{2}$，得到后验均值的最终表达式：\n$$\n\\mu_{\\text{post}} = \\frac{\\mu_{0} + \\kappa \\sigma_{0}^{2} \\hat{\\theta}_{L}}{1 + \\kappa \\sigma_{0}^{2}}\n$$\n这表明后验均值是先验均值 $\\mu_{0}$ 和最大似然估计 $\\hat{\\theta}_{L}$ 的精度加权平均。先验精度是 $1/\\sigma_{0}^{2}$，似然精度（来自数据）是 $\\kappa$。\n\n高斯近似的方差 $\\sigma_{\\text{post}}^{2}$，由在MAP估计处评估的对数后验的负二阶导数的倒数给出。让我们计算 $L(\\theta)$ 的二阶导数：\n$$\n\\frac{d^{2}L}{d\\theta^{2}} = \\frac{d}{d\\theta}\\left(-\\frac{\\theta - \\mu_{0}}{\\sigma_{0}^{2}} - \\kappa(\\theta - \\hat{\\theta}_{L})\\right) = -\\frac{1}{\\sigma_{0}^{2}} - \\kappa\n$$\n由于二阶导数是常数，我们不需要在 $\\mu_{\\text{post}}$ 处对其进行评估。二阶导数的负数是后验精度：\n$$\n\\frac{1}{\\sigma_{\\text{post}}^{2}} = -\\frac{d^{2}L}{d\\theta^{2}} = \\frac{1}{\\sigma_{0}^{2}} + \\kappa\n$$\n这表明后验精度是先验精度和似然精度之和。后验方差 $\\sigma_{\\text{post}}^{2}$ 是这个量的倒数：\n$$\n\\sigma_{\\text{post}}^{2} = \\left(\\frac{1}{\\sigma_{0}^{2}} + \\kappa\\right)^{-1} = \\frac{1}{\\frac{1 + \\kappa\\sigma_{0}^{2}}{\\sigma_{0}^{2}}} = \\frac{\\sigma_{0}^{2}}{1 + \\kappa\\sigma_{0}^{2}}\n$$\n因此，近似的后验分布是 $p(\\theta \\mid y) \\approx \\mathcal{N}(\\mu_{\\text{post}}, \\sigma_{\\text{post}}^{2})$。所需的量是后验均值 $\\mu_{\\text{post}}$ 和后验方差 $\\sigma_{\\text{post}}^{2}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\mu_{0} + \\kappa \\sigma_{0}^{2} \\hat{\\theta}_{L}}{1 + \\kappa \\sigma_{0}^{2}} & \\frac{\\sigma_{0}^{2}}{1 + \\kappa \\sigma_{0}^{2}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "电化学中的许多物理参数，如交换电流密度，是严格为正的。在建模实践中，一个常用的技巧是处理这些参数的对数值，以保证其正定性并改善数值稳定性。本练习将演示当进行此类变量变换时，为确保得到的后验概率密度函数的正确性，必须进行的一项关键数学调整——雅可比行列式（Jacobian）调整。",
            "id": "4237097",
            "problem": "一个基于Butler-Volmer关系的电化学动力学模型被用于解释单电子外球氧化还原电对的计时电流法实验中的瞬态电流数据。交换电流密度 $i_0$ 和扩散系数 $D$ 仅通过似然函数进入模型，并且已知是严格为正的物理参数。使用数据向量 $\\mathbf{y}$、似然函数 $L(\\mathbf{y}\\mid i_0, D)$ 以及在 $(0,\\infty)\\times(0,\\infty)$ 上有支撑的正常联合先验密度 $p(i_0, D)$ 来构建贝叶斯校准。在原始参数化下的后验密度为\n$$\n\\pi_{I_0,D}(i_0,D\\mid \\mathbf{y}) \\propto L(\\mathbf{y}\\mid i_0, D)\\,p(i_0, D).\n$$\n为了在马尔可夫链蒙特卡洛（MCMC）中强制参数为正并提高数值稳定性，您引入了对数变换 $(\\xi,\\eta) = (\\ln i_0, \\ln D)$，并转而在 $(\\xi,\\eta)\\in \\mathbb{R}^2$ 中进行推断。仅以概率密度的变量替换定理为基本出发点，推导必须应用的精确乘性雅可比调整项，以便在变换后的变量中正确表示后验密度。将您的最终答案表示为此雅可比调整项的单个闭式解析表达式，该表达式仅为 $(\\xi,\\eta)$ 的函数。不要包含任何单位。如果您推导了中间表达式，您仍必须报告一个单一的最终表达式。无需四舍五入。",
            "solution": "所述问题具有科学依据、良定、客观，并包含足够的信息以获得唯一且有意义的解。其背景是一个电化学模型的贝叶斯参数估计的标准应用，任务要求推导变量替换的雅可比调整项，这是概率论中的一个基本过程。因此，我将开始推导。\n\n问题要求推导将后验概率密度从原始参数化 $(i_0, D)$ 变换到对数变换后的参数化 $(\\xi, \\eta)$ 时的乘性雅可比调整项。出发点是多元概率密度的变量替换定理。\n\n设原始随机变量由向量 $\\mathbf{v} = \\begin{pmatrix} i_0 \\\\ D \\end{pmatrix}$ 表示，变换后的变量由向量 $\\mathbf{u} = \\begin{pmatrix} \\xi \\\\ \\eta \\end{pmatrix}$ 表示。变换由下式给出：\n$$\n\\mathbf{u} = g(\\mathbf{v}) \\implies \\begin{pmatrix} \\xi \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} \\ln i_0 \\\\ \\ln D \\end{pmatrix}\n$$\n原始参数的定义域为 $(i_0, D) \\in (0, \\infty) \\times (0, \\infty)$，变换后参数的定义域为 $(\\xi, \\eta) \\in \\mathbb{R}^2$。各自的后验密度表示为 $\\pi_{I_0,D}(i_0, D \\mid \\mathbf{y})$ 和 $\\pi_{\\Xi,\\text{H}}(\\xi, \\eta \\mid \\mathbf{y})$。\n\n变量替换定理指出，新变量中的密度与旧变量中的密度关系如下：\n$$\n\\pi_{\\Xi,\\text{H}}(\\mathbf{u} \\mid \\mathbf{y}) = \\pi_{I_0,D}(g^{-1}(\\mathbf{u}) \\mid \\mathbf{y}) \\left| \\det(J_{g^{-1}}(\\mathbf{u})) \\right|\n$$\n其中 $g^{-1}$ 是逆变换，$J_{g^{-1}}(\\mathbf{u})$ 是逆变换在 $\\mathbf{u}$ 处求值的雅可比矩阵。项 $\\left| \\det(J_{g^{-1}}(\\mathbf{u})) \\right|$ 就是我们必须找到的乘性雅可比调整项。\n\n首先，我们确定将 $(\\xi, \\eta)$ 映射回 $(i_0, D)$ 的逆变换 $g^{-1}$。\n从正向变换，我们有：\n$$\n\\xi = \\ln i_0 \\implies i_0 = \\exp(\\xi)\n$$\n$$\n\\eta = \\ln D \\implies D = \\exp(\\eta)\n$$\n因此，逆变换 $\\mathbf{v} = g^{-1}(\\mathbf{u})$ 为：\n$$\n\\begin{pmatrix} i_0 \\\\ D \\end{pmatrix} = \\begin{pmatrix} \\exp(\\xi) \\\\ \\exp(\\eta) \\end{pmatrix}\n$$\n\n接下来，我们计算这个逆变换的雅可比矩阵 $J_{g^{-1}}$。该矩阵的元素是 $g^{-1}$ 的分量相对于 $\\mathbf{u}$ 的分量的偏导数：\n$$\nJ_{g^{-1}}(\\xi, \\eta) = \\frac{\\partial(i_0, D)}{\\partial(\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial i_0}{\\partial \\xi} & \\frac{\\partial i_0}{\\partial \\eta} \\\\ \\frac{\\partial D}{\\partial \\xi} & \\frac{\\partial D}{\\partial \\eta} \\end{pmatrix}\n$$\n我们计算各个偏导数：\n$$\n\\frac{\\partial i_0}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\exp(\\xi) \\right) = \\exp(\\xi)\n$$\n$$\n\\frac{\\partial i_0}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\exp(\\xi) \\right) = 0\n$$\n$$\n\\frac{\\partial D}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\exp(\\eta) \\right) = 0\n$$\n$$\n\\frac{\\partial D}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\exp(\\eta) \\right) = \\exp(\\eta)\n$$\n将这些代入雅可比矩阵，得到：\n$$\nJ_{g^{-1}}(\\xi, \\eta) = \\begin{pmatrix} \\exp(\\xi) & 0 \\\\ 0 & \\exp(\\eta) \\end{pmatrix}\n$$\n\n现在，我们计算该矩阵的行列式：\n$$\n\\det(J_{g^{-1}}(\\xi, \\eta)) = \\left( \\exp(\\xi) \\right) \\left( \\exp(\\eta) \\right) - (0)(0) = \\exp(\\xi)\\exp(\\eta)\n$$\n\n最后，雅可比调整因子是该行列式的绝对值。由于指数函数 $\\exp(x)$ 对于任何实数参数 $x$ 都严格为正，所以 $\\exp(\\xi)$ 和 $\\exp(\\eta)$ 均为正。因此，它们的乘积也严格为正。\n$$\n\\left| \\det(J_{g^{-1}}(\\xi, \\eta)) \\right| = \\left| \\exp(\\xi)\\exp(\\eta) \\right| = \\exp(\\xi)\\exp(\\eta)\n$$\n这可以写成更紧凑的形式 $\\exp(\\xi + \\eta)$。\n\n这个表达式就是所求的乘性雅可比调整项。如要求所述，它只是变换后变量 $(\\xi, \\eta)$ 的函数。在变换空间中，后验密度的完整表达式为：\n$$\n\\pi_{\\Xi,\\text{H}}(\\xi, \\eta \\mid \\mathbf{y}) \\propto L(\\mathbf{y} \\mid i_0=\\exp(\\xi), D=\\exp(\\eta)) \\, p(i_0=\\exp(\\xi), D=\\exp(\\eta)) \\, \\exp(\\xi+\\eta)\n$$",
            "answer": "$$\\boxed{\\exp(\\xi+\\eta)}$$"
        },
        {
            "introduction": "在掌握了参数估计的基础后，我们可以将其应用于更高级的分析任务：评估参数的可辨识性。这个动手编程练习将探究不同的实验设计如何影响我们区分多个参数（如此处的曲折度和电导率）的能力。通过分析后验分布的几何形状，我们可以量化参数间的相关性，进而指导设计信息量更大的实验，这是不确定性量化框架的一个关键优势。",
            "id": "4237034",
            "problem": "在计算电化学中，考虑一个在一维（1D）稳态恒电流实验下的多孔电极-电解质系统。多孔结构中电解质的有效离子传导通过曲折度校正的欧姆定律和一个简单的扩散时间标度来建模。设未知参数为多孔电极的曲折度 $\\tau$（无量纲）和体电解质电导率 $\\kappa$（单位为 $\\mathrm{S}/\\mathrm{m}$）。多孔介质中的有效离子电导率为 $\\kappa_{\\mathrm{eff}} = \\kappa / \\tau$。电解质厚度为 $L$（单位为 $\\mathrm{m}$），施加的电流密度为 $j$（单位为 $\\mathrm{A}/\\mathrm{m}^2$）。\n\n基本原理：\n- 一维欧姆定律意味着电解质两端的电势降 $V$（单位为 $\\mathrm{V}$）满足 $V = (L/\\kappa_{\\mathrm{eff}})\\, j$。使用 $\\kappa_{\\mathrm{eff}} = \\kappa/\\tau$，这变为 $V = L\\, (\\tau/\\kappa)\\, j$。\n- 用于多孔介质中浓度弛豫的简单扩散时间标度意味着特征时间 $T$（单位为 $\\mathrm{s}$）的形式为 $T = (\\tau L^2)/D$，其中 $D$（单位为 $\\mathrm{m}^2/\\mathrm{s}$）是视为已知的有效电解质扩散系数。\n\n贝叶斯不确定性量化设置：\n- 定义变换后的参数 $s = \\ln \\tau$ 和 $r = \\ln \\kappa$。\n- 假设 $s$ 和 $r$ 服从独立的高斯先验：$s \\sim \\mathcal{N}(\\mu_s,\\sigma_s^2)$ 和 $r \\sim \\mathcal{N}(\\mu_r,\\sigma_r^2)$。\n- 测量值使用独立的高斯噪声建模。对于电流密度为 $j_k$ 时的电压测量值 $V_k$，其似然为 $V_k \\sim \\mathcal{N}(f_V(s,r;j_k),\\sigma_V^2)$，其中 $f_V(s,r;j) = L\\, e^{s-r}\\, j$。对于扩散时间测量值 $T$，其似然为 $T \\sim \\mathcal{N}(f_T(s),\\sigma_T^2)$，其中 $f_T(s) = e^{s}\\, L^2/D$。\n\n局部灵敏度和可辨识性：\n- 白化灵敏度（雅可比）矩阵 $\\mathbf{J}_w$ 是通过将每个测量值相对于 $(s,r)$ 的梯度（每个梯度除以其噪声标准差）堆叠而形成的。对于在 $j_k$ 处的电压测量，梯度行为 $\\left[\\partial f_V/\\partial s,\\, \\partial f_V/\\partial r\\right]/\\sigma_V = \\left[f_V(s,r;j_k),\\, -f_V(s,r;j_k)\\right]/\\sigma_V$。对于扩散时间测量，梯度行为 $\\left[\\partial f_T/\\partial s,\\, \\partial f_T/\\partial r\\right]/\\sigma_T = \\left[f_T(s),\\, 0\\right]/\\sigma_T$。\n- 数据费雪信息矩阵为 $\\mathbf{F} = \\mathbf{J}_w^\\top \\mathbf{J}_w$。在最大后验点周围对后验分布进行拉普拉斯近似，会加上先验精度，得到一个Hessian矩阵 $\\mathbf{H} = \\mathbf{F} + \\boldsymbol{\\Lambda}$，其中在 $(s,r)$ 坐标系中 $\\boldsymbol{\\Lambda} = \\mathrm{diag}(1/\\sigma_s^2, 1/\\sigma_r^2)$。近似的后验协方差为 $\\boldsymbol{\\Sigma} \\approx \\mathbf{H}^{-1}$。\n- 可辨识性可以通过以下方式探究：(i) $\\mathbf{J}_w$ 的最小奇异值，这是一个无量纲数，当其接近零时表示秩亏；以及 (ii) $s$ 和 $r$ 之间的后验相关系数，计算公式为 $\\rho = \\boldsymbol{\\Sigma}_{sr}/\\sqrt{\\boldsymbol{\\Sigma}_{ss}\\,\\boldsymbol{\\Sigma}_{rr}}$，它也是无量纲的，在强不可辨识性情况下会趋近于 $\\pm 1$。\n\n任务：\n- 使用上述基础，在三种实验设计下建立 $(s,r)$ 的联合后验分布。对于所有设计，使用相同的真实参数 $\\tau_{\\mathrm{true}}$ 和 $\\kappa_{\\mathrm{true}}$，并在点 $(s,r) = (\\ln \\tau_{\\mathrm{true}}, \\ln \\kappa_{\\mathrm{true}})$ 处构建灵敏度和后验度量。\n- 使用以下固定的物理常数和先验：\n  - $L = 1.0\\times 10^{-4}\\ \\mathrm{m}$，$D = 1.5\\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$。\n  - $\\tau_{\\mathrm{true}} = 2.5$（无量纲），$\\kappa_{\\mathrm{true}} = 1.0\\ \\mathrm{S}/\\mathrm{m}$。\n  - $s$ 和 $r$ 的先验：$\\mu_s = \\ln(2.5)$，$\\mu_r = \\ln(1.0)$，以及 $\\sigma_s = 2.0$ 和 $\\sigma_r = 2.0$。\n- 实验设计（每个都是一个测试用例）：\n  1. 仅欧姆设计：在电流密度 $j = [100, 200, 300]\\ \\mathrm{A}/\\mathrm{m}^2$ 下进行三次电压测量，电压噪声标准差为 $\\sigma_V = 1.0\\times 10^{-3}\\ \\mathrm{V}$。无扩散时间测量。\n  2. 组合设计：与测试用例1相同的三次电压测量，$\\sigma_V = 1.0\\times 10^{-3}\\ \\mathrm{V}$，外加一次扩散时间测量，$\\sigma_T = 1.0\\times 10^{-2}\\ \\mathrm{s}$。\n  3. 弱时间信息设计：与之前相同的电压测量，$\\sigma_V = 1.0\\times 10^{-3}\\ \\mathrm{V}$，外加一次扩散时间测量，但噪声较大，为 $\\sigma_T = 1.0\\ \\mathrm{s}$。\n- 对于每个测试用例，计算：\n  - $s$ 与 $r$ 之间的后验相关系数 $\\rho$（无量纲）。\n  - 白化灵敏度矩阵 $\\mathbf{J}_w$ 的最小奇异值 $s_{\\min}$（无量纲）。\n- 要求的最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3]”）。在此问题中，单行输出必须是“[\\rho_1,s_{\\min,1},\\rho_2,s_{\\min,2},\\rho_3,s_{\\min,3}]”，其中索引1、2、3对应于测试用例1、2和3。所有输出均为浮点数。此问题中不涉及角度和百分比。\n\n通过使用指定的单位确保科学真实性：$L$ 单位为 $\\mathrm{m}$，$D$ 单位为 $\\mathrm{m}^2/\\mathrm{s}$，$\\kappa$ 单位为 $\\mathrm{S}/\\mathrm{m}$，$\\tau$ 无量纲，$j$ 单位为 $\\mathrm{A}/\\mathrm{m}^2$，$V$ 单位为 $\\mathrm{V}$，$T$ 单位为 $\\mathrm{s}$。计算出的度量 $\\rho$ 和 $s_{\\min}$ 是无单位的浮点数。您的程序必须是自包含的，并且不能要求任何输入。它应该完全按照规定汇总三个测试用例的结果。",
            "solution": "该问题被评估为有效。它在科学上是合理的、自包含且适定的，提供了在计算电化学背景下执行所要求的参数可辨识性分析所需的所有必要物理常数、数学模型和实验条件。\n\n目标是量化一个简化的多孔电极模型在三种不同实验设计下的参数可辨识性。未知参数是曲折度 $\\tau$ 和体电解质电导率 $\\kappa$。我们使用它们的自然对数 $s = \\ln \\tau$ 和 $r = \\ln \\kappa$ 进行处理。分析以真实参数值为中心，这些值与先验均值重合。我们将为每种设计计算两个度量：白化灵敏度矩阵 $\\mathbf{J}_w$ 的最小奇异值 $s_{\\min}$，以及从拉普拉斯近似导出的 $s$ 和 $r$ 之间的后验相关系数 $\\rho$。\n\n首先，我们确定常数和真实值。\n物理常数为：\n- 电解质厚度，$L = 1.0 \\times 10^{-4}\\ \\mathrm{m}$\n- 有效电解质扩散系数，$D = 1.5 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}$\n\n真实参数为：\n- 曲折度，$\\tau_{\\mathrm{true}} = 2.5$\n- 电导率，$\\kappa_{\\mathrm{true}} = 1.0\\ \\mathrm{S}/\\mathrm{m}$\n\n分析在相应的变换后参数点上进行：\n- $s_{\\mathrm{true}} = \\ln(\\tau_{\\mathrm{true}}) = \\ln(2.5)$\n- $r_{\\mathrm{true}} = \\ln(\\kappa_{\\mathrm{true}}) = \\ln(1.0) = 0$\n\n$s$ 和 $r$ 的独立高斯先验由 $\\mu_s = \\ln(2.5)$、$\\mu_r = \\ln(1.0)$ 以及标准差 $\\sigma_s = 2.0$ 和 $\\sigma_r = 2.0$ 给出。先验精度矩阵 $\\boldsymbol{\\Lambda}$ 是对角矩阵，其对角元素为 $1/\\sigma^2$，对于所有测试用例都是恒定的：\n$$\n\\boldsymbol{\\Lambda} = \\begin{pmatrix} 1/\\sigma_s^2 & 0 \\\\ 0 & 1/\\sigma_r^2 \\end{pmatrix} = \\begin{pmatrix} 1/2.0^2 & 0 \\\\ 0 & 1/2.0^2 \\end{pmatrix} = \\begin{pmatrix} 0.25 & 0 \\\\ 0 & 0.25 \\end{pmatrix}\n$$\n\n在真实点 $(s_{\\mathrm{true}}, r_{\\mathrm{true}})$ 评估的模型函数为：\n- 电压模型：$f_V(s,r;j) = L e^{s-r} j$。在真实值点上，$f_V(s_{\\mathrm{true}}, r_{\\mathrm{true}}; j) = L e^{s_{\\mathrm{true}}-r_{\\mathrm{true}}} j = L (\\tau_{\\mathrm{true}}/\\kappa_{\\mathrm{true}}) j = (1.0 \\times 10^{-4}\\ \\mathrm{m}) (2.5 / 1.0\\ \\mathrm{S}/\\mathrm{m}) j = (2.5 \\times 10^{-4})\\, j$。\n- 时间模型：$f_T(s) = (L^2/D) e^s$。在真实值点上，$f_T(s_{\\mathrm{true}}) = (L^2/D) e^{s_{\\mathrm{true}}} = (L^2/D) \\tau_{\\mathrm{true}} = \\frac{(1.0 \\times 10^{-4}\\ \\mathrm{m})^2}{1.5 \\times 10^{-9}\\ \\mathrm{m}^2/\\mathrm{s}} \\times 2.5 = \\frac{1.0 \\times 10^{-8}}{1.5 \\times 10^{-9}} \\times 2.5\\ \\mathrm{s} = \\frac{10}{1.5} \\times 2.5\\ \\mathrm{s} = \\frac{50}{3}\\ \\mathrm{s}$。\n\n白化灵敏度矩阵 $\\mathbf{J}_w$ 的梯度行由模型函数导出：\n- 对于电流密度为 $j_k$ 的电压测量值 $V_k$：\n$$\n\\mathbf{g}_{V,k} = \\frac{1}{\\sigma_V} \\left[ \\frac{\\partial f_V}{\\partial s}, \\frac{\\partial f_V}{\\partial r} \\right] = \\frac{1}{\\sigma_V} [f_V, -f_V]\n$$\n- 对于扩散时间测量值 $T$：\n$$\n\\mathbf{g}_{T} = \\frac{1}{\\sigma_T} \\left[ \\frac{\\partial f_T}{\\partial s}, \\frac{\\partial f_T}{\\partial r} \\right] = \\frac{1}{\\sigma_T} [f_T, 0]\n$$\n\n我们现在对每个测试用例进行处理。\n\n**测试用例1：仅欧姆设计**\n此设计包括在 $j = [100, 200, 300]\\ \\mathrm{A}/\\mathrm{m}^2$ 下的三次电压测量，其中 $\\sigma_V = 1.0 \\times 10^{-3}\\ \\mathrm{V}$。没有扩散时间测量。\n\n模型预测值 $f_V(j_k)$ 为：\n- $f_V(100) = (2.5 \\times 10^{-4}) \\times 100 = 0.025\\ \\mathrm{V}$\n- $f_V(200) = (2.5 \\times 10^{-4}) \\times 200 = 0.050\\ \\mathrm{V}$\n- $f_V(300) = (2.5 \\times 10^{-4}) \\times 300 = 0.075\\ \\mathrm{V}$\n\n白化灵敏度矩阵 $\\mathbf{J}_w$ 的行为：\n- $\\mathbf{g}_{V,1} = \\frac{1}{1.0 \\times 10^{-3}} [0.025, -0.025] = [25, -25]$\n- $\\mathbf{g}_{V,2} = \\frac{1}{1.0 \\times 10^{-3}} [0.050, -0.050] = [50, -50]$\n- $\\mathbf{g}_{V,3} = \\frac{1}{1.0 \\times 10^{-3}} [0.075, -0.075] = [75, -75]$\n\n因此，灵敏度矩阵为：\n$$\n\\mathbf{J}_{w,1} = \\begin{pmatrix} 25 & -25 \\\\ 50 & -50 \\\\ 75 & -75 \\end{pmatrix}\n$$\n$\\mathbf{J}_{w,1}$ 的列是线性相关的，意味着该矩阵是秩亏的（秩为1）。因此，其最小奇异值为 $s_{\\min,1} = 0$。这表明仅从电压数据来看，参数 $s$ 和 $r$ 是不可辨识的，因为它们仅通过组合 $s-r$ 影响测量。\n\n数据费雪信息矩阵（FIM）为 $\\mathbf{F}_1 = \\mathbf{J}_{w,1}^\\top \\mathbf{J}_{w,1}$：\n$$\n\\mathbf{F}_1 = \\begin{pmatrix} 25 & 50 & 75 \\\\ -25 & -50 & -75 \\end{pmatrix} \\begin{pmatrix} 25 & -25 \\\\ 50 & -50 \\\\ 75 & -75 \\end{pmatrix} = \\begin{pmatrix} 8750 & -8750 \\\\ -8750 & 8750 \\end{pmatrix}\n$$\nHessian矩阵为 $\\mathbf{H}_1 = \\mathbf{F}_1 + \\boldsymbol{\\Lambda}$：\n$$\n\\mathbf{H}_1 = \\begin{pmatrix} 8750 & -8750 \\\\ -8750 & 8750 \\end{pmatrix} + \\begin{pmatrix} 0.25 & 0 \\\\ 0 & 0.25 \\end{pmatrix} = \\begin{pmatrix} 8750.25 & -8750 \\\\ -8750 & 8750.25 \\end{pmatrix}\n$$\n后验协方差为 $\\boldsymbol{\\Sigma}_1 = \\mathbf{H}_1^{-1}$：\n$$\n\\boldsymbol{\\Sigma}_1 = \\frac{1}{8750.25^2 - (-8750)^2} \\begin{pmatrix} 8750.25 & 8750 \\\\ 8750 & 8750.25 \\end{pmatrix} \\approx \\frac{1}{4375.125} \\begin{pmatrix} 8750.25 & 8750 \\\\ 8750 & 8750.25 \\end{pmatrix}\n$$\n后验相关系数为 $\\rho_1 = \\boldsymbol{\\Sigma}_{1,sr} / \\sqrt{\\boldsymbol{\\Sigma}_{1,ss} \\boldsymbol{\\Sigma}_{1,rr}}$：\n$$\n\\rho_1 = \\frac{8750 / 4375.125}{\\sqrt{(8750.25 / 4375.125) \\times (8750.25 / 4375.125)}} = \\frac{8750}{8750.25} \\approx 0.999971\n$$\n这个值非常接近1，证实了强的不可辨识性。它不完全等于1的唯一原因是先验的正则化效应。\n\n**测试用例2：组合设计**\n此设计在测试用例1的测量基础上，增加了一次扩散时间测量，其中 $\\sigma_T = 1.0 \\times 10^{-2}\\ \\mathrm{s}$。\n时间的模型预测值为 $f_T = 50/3\\ \\mathrm{s}$。相应的梯度行为：\n$$\n\\mathbf{g}_{T} = \\frac{1}{1.0 \\times 10^{-2}} [50/3, 0] = [5000/3, 0] \\approx [1666.67, 0]\n$$\n新的灵敏度矩阵 $\\mathbf{J}_{w,2}$ 增加了一行：\n$$\n\\mathbf{J}_{w,2} = \\begin{pmatrix} 25 & -25 \\\\ 50 & -50 \\\\ 75 & -75 \\\\ 5000/3 & 0 \\end{pmatrix}\n$$\n由于新行打破了列之间的线性依赖关系，该矩阵现在是满秩的（秩为2）。最小奇异值 $s_{\\min,2}$ 将为非零。\nFIM为 $\\mathbf{F}_2 = \\mathbf{J}_{w,2}^\\top \\mathbf{J}_{w,2} = \\mathbf{F}_1 + \\mathbf{g}_{T}^\\top \\mathbf{g}_{T}$：\n$$\n\\mathbf{F}_2 = \\begin{pmatrix} 8750 & -8750 \\\\ -8750 & 8750 \\end{pmatrix} + \\begin{pmatrix} (5000/3)^2 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 8750 + 25000000/9 & -8750 \\\\ -8750 & 8750 \\end{pmatrix}\n$$\nHessian矩阵为 $\\mathbf{H}_2 = \\mathbf{F}_2 + \\boldsymbol{\\Lambda}$：\n$$\n\\mathbf{H}_2 = \\begin{pmatrix} 8750.25 + 25000000/9 & -8750 \\\\ -8750 & 8750.25 \\end{pmatrix} \\approx \\begin{pmatrix} 2786528.03 & -8750 \\\\ -8750 & 8750.25 \\end{pmatrix}\n$$\n将 $\\mathbf{H}_2$ 求逆得到 $\\boldsymbol{\\Sigma}_2$，然后计算 $\\rho_2 = \\boldsymbol{\\Sigma}_{2,sr} / \\sqrt{\\boldsymbol{\\Sigma}_{2,ss} \\boldsymbol{\\Sigma}_{2,rr}}$，将会得到一个显著更低的相关性，因为时间测量提供了关于 $s$ 的独特信息。\n\n**测试用例3：弱时间信息设计**\n此情况与测试用例2相同，但时间测量的噪声要大得多：$\\sigma_T = 1.0\\ \\mathrm{s}$。\n现在时间测量的梯度行为：\n$$\n\\mathbf{g}_{T} = \\frac{1}{1.0} [50/3, 0] = [50/3, 0] \\approx [16.67, 0]\n$$\n灵敏度矩阵为：\n$$\n\\mathbf{J}_{w,3} = \\begin{pmatrix} 25 & -25 \\\\ 50 & -50 \\\\ 75 & -75 \\\\ 50/3 & 0 \\end{pmatrix}\n$$\n该矩阵仍然是满秩的，但新行的幅度远小于测试用例2中的情况，这意味着它为区分 $s$ 和 $r$ 提供了较少的信息。因此，我们预期 $s_{\\min,3}$ 会小于 $s_{\\min,2}$ 但大于 $s_{\\min,1}$。\nFIM为 $\\mathbf{F}_3 = \\mathbf{F}_1 + \\mathbf{g}_{T}^\\top \\mathbf{g}_{T}$：\n$$\n\\mathbf{F}_3 = \\begin{pmatrix} 8750 & -8750 \\\\ -8750 & 8750 \\end{pmatrix} + \\begin{pmatrix} (50/3)^2 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 8750 + 2500/9 & -8750 \\\\ -8750 & 8750 \\end{pmatrix}\n$$\nHessian矩阵为 $\\mathbf{H}_3 = \\mathbf{F}_3 + \\boldsymbol{\\Lambda}$：\n$$\n\\mathbf{H}_3 = \\begin{pmatrix} 8750.25 + 2500/9 & -8750 \\\\ -8750 & 8750.25 \\end{pmatrix} \\approx \\begin{pmatrix} 9028.03 & -8750 \\\\ -8750 & 8750.25 \\end{pmatrix}\n$$\n由于增加的信息较弱，我们预期得到的相关性 $\\rho_3$ 会低于 $\\rho_1$ 但显著高于 $\\rho_2$。\n\n最终的数值将由执行程序计算得出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes parameter identifiability metrics for a porous electrode model\n    under three different experimental designs.\n    \"\"\"\n    # Define fixed physical constants and ground-truth parameters\n    L = 1.0e-4  # m\n    D = 1.5e-9  # m^2/s\n    tau_true = 2.5  # dimensionless\n    kappa_true = 1.0  # S/m\n\n    # Define prior distribution parameters\n    sigma_s = 2.0\n    sigma_r = 2.0\n\n    # Test cases representing the three experimental designs\n    test_cases = [\n        {\n            \"name\": \"Ohmic-only\",\n            \"j_values\": np.array([100.0, 200.0, 300.0]),\n            \"sigma_V\": 1.0e-3,\n            \"sigma_T\": None  # No diffusion time measurement\n        },\n        {\n            \"name\": \"Combined\",\n            \"j_values\": np.array([100.0, 200.0, 300.0]),\n            \"sigma_V\": 1.0e-3,\n            \"sigma_T\": 1.0e-2\n        },\n        {\n            \"name\": \"Weak time-information\",\n            \"j_values\": np.array([100.0, 200.0, 300.0]),\n            \"sigma_V\": 1.0e-3,\n            \"sigma_T\": 1.0\n        }\n    ]\n\n    results = []\n\n    # Transformed ground-truth parameters\n    s_true = np.log(tau_true)\n    r_true = np.log(kappa_true)\n\n    # Prior precision matrix (same for all cases)\n    prior_precision = np.diag([1.0/sigma_s**2, 1.0/sigma_r**2])\n\n    for case in test_cases:\n        # --- Step 1: Construct the whitened sensitivity matrix J_w ---\n        \n        jw_rows = []\n\n        # Add rows for voltage measurements\n        if case[\"j_values\"] is not None and case[\"sigma_V\"] is not None:\n            sigma_V = case[\"sigma_V\"]\n            for j in case[\"j_values\"]:\n                # Model function for voltage\n                f_V = L * np.exp(s_true - r_true) * j\n                # Whitened gradient row: [dfV/ds, dfV/dr] / sigma_V\n                grad_row_v = np.array([f_V, -f_V]) / sigma_V\n                jw_rows.append(grad_row_v)\n\n        # Add row for diffusion time measurement\n        if case[\"sigma_T\"] is not None:\n            sigma_T = case[\"sigma_T\"]\n            # Model function for time\n            f_T = (L**2 / D) * np.exp(s_true)\n            # Whitened gradient row: [dfT/ds, dfT/dr] / sigma_T\n            grad_row_t = np.array([f_T, 0.0]) / sigma_T\n            jw_rows.append(grad_row_t)\n\n        J_w = np.array(jw_rows)\n\n        # --- Step 2: Compute the smallest singular value of J_w ---\n        \n        if J_w.shape[0]  J_w.shape[1]:\n            # This case won't happen here, but for completeness\n            # pad with zero rows to make it square or tall\n            zero_padding = np.zeros((J_w.shape[1] - J_w.shape[0], J_w.shape[1]))\n            J_w_svd = np.vstack((J_w, zero_padding))\n        else:\n            J_w_svd = J_w\n\n        singular_values = np.linalg.svd(J_w_svd, compute_uv=False)\n        s_min = np.min(singular_values)\n\n        # --- Step 3: Compute the posterior correlation coefficient rho ---\n\n        # Data Fisher Information Matrix\n        F = J_w.T @ J_w\n        \n        # Hessian of the negative log-posterior\n        H = F + prior_precision\n\n        # Posterior covariance matrix (inverse of Hessian)\n        Sigma = np.linalg.inv(H)\n\n        Sigma_ss = Sigma[0, 0]\n        Sigma_rr = Sigma[1, 1]\n        Sigma_sr = Sigma[0, 1]\n        \n        # Posterior correlation coefficient\n        rho = Sigma_sr / np.sqrt(Sigma_ss * Sigma_rr)\n\n        results.extend([rho, s_min])\n    \n    # Format and print the final output string\n    print(f\"[{','.join(f'{x:.8f}' for x in results)}]\")\n\nsolve()\n```"
        }
    ]
}