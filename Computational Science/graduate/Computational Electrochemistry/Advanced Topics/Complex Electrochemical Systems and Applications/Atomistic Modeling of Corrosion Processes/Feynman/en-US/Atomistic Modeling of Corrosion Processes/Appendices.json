{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of modeling corrosion is understanding how the electrochemical environment dictates the chemistry at a material's surface. This exercise introduces the Computational Hydrogen Electrode (CHE) model, a powerful theoretical framework that connects the results of quantum mechanical simulations to the experimentally controllable variables of electrode potential ($U$) and pH. By working through this problem, you will learn to predict how the surface coverage of a critical corrosion intermediate, the hydroxyl radical, changes with electrochemical conditions, and to evaluate the importance of solvation effects in refining these predictions. ",
            "id": "4236890",
            "problem": "You are asked to model the electrochemical adsorption of hydroxyl ($\\mathrm{OH}^{*}$) on nickel ($\\mathrm{Ni}$) surface sites in the context of atomistic modeling of corrosion processes. Starting from first principles appropriate to computational electrochemistry and atomistic modeling, your program must derive the coverage of hydroxyl as a function of electrode potential and potential of hydrogen (pH), then quantify how an explicit solvation correction alters the predicted coverage. The program must implement the derivation and produce numerical outputs for a specified test suite.\n\nBegin from the following fundamental base:\n\n- The process of hydroxyl adsorption is represented by the surface reaction $\\mathrm{*} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{OH}^{*} + \\mathrm{H}^{+} + \\mathrm{e}^{-}$, where $\\mathrm{*}$ denotes a vacant $\\mathrm{Ni}$ site and $\\mathrm{OH}^{*}$ denotes an adsorbed hydroxyl. The corresponding equilibrium thermodynamics can be treated via chemical potentials and the Computational Hydrogen Electrode (CHE) formalism.\n- The relationship between the chemical potentials of $\\mathrm{H}^{+}$ and $\\mathrm{e}^{-}$ and molecular hydrogen in the CHE is $\\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}} = \\tfrac{1}{2}\\mu_{\\mathrm{H_{2}}} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}}$, where $U$ is the electrode potential versus the Standard Hydrogen Electrode (SHE), $e$ is the elementary charge, $T$ is temperature, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $a_{\\mathrm{H}^{+}}$ is the activity of the proton. The activity is related to the potential of hydrogen (pH) by $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$.\n- At equilibrium, for a single noninteracting site type, the adsorbate coverage $\\theta$ satisfies mass action through a Langmuir-type isotherm derived from minimizing the grand potential with respect to site occupation, where the equilibrium constant is determined by the reaction free energy $\\Delta G(U,\\mathrm{pH})$.\n\nUse the following scientifically realistic constants and parameters:\n\n- Temperature $T = 298.15\\,\\mathrm{K}$.\n- Energetic units are in $\\mathrm{eV}$, and potential $U$ is in $\\mathrm{V}$ versus $\\mathrm{SHE}$. Use the identity $e \\cdot \\mathrm{V} = \\mathrm{eV}$ to express $e U$ in $\\mathrm{eV}$.\n- Boltzmann constant in $\\mathrm{eV}/\\mathrm{K}$: $k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$.\n- Natural logarithm base relation for decimal logarithms: $\\ln(10)$.\n- The standard-state reaction free energy at $U = 0\\,\\mathrm{V}$ and $\\mathrm{pH} = 0$ for $\\mathrm{OH}^{*}$ formation on $\\mathrm{Ni}$, derived from atomistic calculations (including zero-point energy and vibrational entropy corrections), is $\\Delta G^{\\circ} = 0.62\\,\\mathrm{eV}$.\n- An explicit solvation correction to the $\\mathrm{OH}^{*}$ formation free energy intended to mimic stabilization by liquid water is $\\delta G_{\\mathrm{solv}} = -0.25\\,\\mathrm{eV}$.\n\nYour tasks:\n\n1. Derive, from the stated base, the expression for the reaction free energy $\\Delta G(U,\\mathrm{pH})$ under the CHE formalism as a function of the electrode potential $U$ (in $\\mathrm{V}$) and $\\mathrm{pH}$ (dimensionless), referencing the relation between $\\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}}$ and $\\mu_{\\mathrm{H_{2}}}$. Carefully eliminate chemical potentials to arrive at an expression in terms of $\\Delta G^{\\circ}$, $U$, $T$, and $\\mathrm{pH}$.\n2. From the derived $\\Delta G(U,\\mathrm{pH})$, obtain the corresponding $\\mathrm{OH}^{*}$ coverage $\\theta(U,\\mathrm{pH})$ for a single noninteracting site using a rigorous equilibrium argument based on the Langmuir isotherm and the Boltzmann factor, expressed in terms of $k_{\\mathrm{B}} T$ and $\\Delta G(U,\\mathrm{pH})$.\n3. Incorporate the explicit solvation correction as an additive modification to the reaction free energy and compute a corrected coverage $\\theta_{\\mathrm{corr}}(U,\\mathrm{pH})$.\n4. For each test case, compute the absolute difference $\\Delta \\theta = \\left|\\theta_{\\mathrm{CHE}} - \\theta_{\\mathrm{corr}}\\right|$ to quantify the solvation-induced change in predicted coverage and thereby assess the accuracy of the CHE approximation relative to the corrected model in a qualitative sense.\n\nUnits and numerical output requirements:\n\n- Energies must be handled internally in $\\mathrm{eV}$, potentials in $\\mathrm{V}$ versus $\\mathrm{SHE}$, temperature in $\\mathrm{K}$, and coverage is dimensionless in $[0,1]$.\n- Use $T = 298.15\\,\\mathrm{K}$, $k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$, and $\\ln(10)$ as specified.\n- The final numerical outputs must be the values of $\\Delta \\theta$ for each test case, rounded to six decimal places.\n\nTest suite:\n\n- Case $1$: $U = 0.60\\,\\mathrm{V}$, $\\mathrm{pH} = 13$.\n- Case $2$: $U = 0.00\\,\\mathrm{V}$, $\\mathrm{pH} = 0$.\n- Case $3$: $U = 0.25\\,\\mathrm{V}$, $\\mathrm{pH} = 7$.\n- Case $4$: $U = 1.00\\,\\mathrm{V}$, $\\mathrm{pH} = 14$.\n- Case $5$: $U = -0.10\\,\\mathrm{V}$, $\\mathrm{pH} = 1$.\n- Case $6$: $U = 0.50\\,\\mathrm{V}$, $\\mathrm{pH} = 2$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, followed by a seventh entry that is the arithmetic mean of the six $\\Delta \\theta$ values, all rounded to six decimal places (e.g., $\\left[\\text{case1},\\text{case2},\\ldots,\\text{case6},\\text{mean}\\right]$).",
            "solution": "The problem requires the derivation of adsorbate coverage for hydroxyl ($\\mathrm{OH}^{*}$) on a nickel ($\\mathrm{Ni}$) surface as a function of electrode potential and $\\mathrm{pH}$, and to quantify the effect of a solvation correction. The problem is scientifically grounded in the principles of computational electrochemistry, specifically the Computational Hydrogen Electrode (CHE) model and Langmuir adsorption theory. All necessary parameters are provided, and the problem is well-posed.\n\nThe solution is developed in four sequential steps as stipulated by the problem statement.\n\nStep 1: Derivation of the reaction free energy $\\Delta G(U, \\mathrm{pH})$\n\nThe electrochemical adsorption of hydroxyl is given by the reaction:\n$$ \\mathrm{*} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{OH}^{*} + \\mathrm{H}^{+} + \\mathrm{e}^{-} $$\nwhere $\\mathrm{*}$ denotes a vacant surface site. The Gibbs free energy of this reaction, $\\Delta G$, is the difference between the chemical potentials ($\\mu$) of the products and reactants:\n$$ \\Delta G = (\\mu_{\\mathrm{OH}^{*}} + \\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}}) - (\\mu_{*} + \\mu_{\\mathrm{H_{2}O}}) $$\nThe Computational Hydrogen Electrode (CHE) model posits that the chemical potential of a proton-electron pair in solution is in equilibrium with gaseous hydrogen at a given electrode potential $U$ versus the Standard Hydrogen Electrode (SHE). The explicit relation is provided:\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}} = \\frac{1}{2}\\mu_{\\mathrm{H_{2}}} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}} $$\nHere, $\\mu_{\\mathrm{H_{2}}}$ is the chemical potential of hydrogen gas, $e$ is the elementary charge, $U$ is the electrode potential, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the temperature, and $a_{\\mathrm{H}^{+}}$ is the proton activity.\n\nSubstituting this expression for $\\mu_{\\mathrm{H}^{+}} + \\mu_{\\mathrm{e}^{-}}$ into the equation for $\\Delta G$ gives:\n$$ \\Delta G = \\mu_{\\mathrm{OH}^{*}} - \\mu_{*} - \\mu_{\\mathrm{H_{2}O}} + \\left(\\frac{1}{2}\\mu_{\\mathrm{H_{2}}} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}}\\right) $$\nRearranging the terms to group the chemical potentials yields:\n$$ \\Delta G = \\left( \\mu_{\\mathrm{OH}^{*}} + \\frac{1}{2}\\mu_{\\mathrm{H_{2}}} - \\mu_{*} - \\mu_{\\mathrm{H_{2}O}} \\right) - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}} $$\nThe term in parentheses represents the free energy change for the reference reaction $\\mathrm{*} + \\mathrm{H_{2}O} \\rightleftharpoons \\mathrm{OH}^{*} + \\frac{1}{2}\\mathrm{H_{2}}$ under standard conditions ($U = 0\\,\\mathrm{V}$ versus SHE, $\\mathrm{pH} = 0$, and all species in their standard states). This is the standard-state reaction free energy, $\\Delta G^{\\circ}$, which is given as $\\Delta G^{\\circ} = 0.62\\,\\mathrm{eV}$.\n\nThe expression for $\\Delta G$ thus becomes:\n$$ \\Delta G = \\Delta G^{\\circ} - e U + k_{\\mathrm{B}} T \\ln a_{\\mathrm{H}^{+}} $$\nThe proton activity $a_{\\mathrm{H}^{+}}$ is related to the $\\mathrm{pH}$ by the definition $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$. Substituting this gives:\n$$ \\Delta G = \\Delta G^{\\circ} - e U + k_{\\mathrm{B}} T \\ln(10^{-\\mathrm{pH}}) $$\nUsing the logarithmic identity $\\ln(x^y) = y \\ln(x)$, we arrive at the final expression for the reaction free energy as a function of potential $U$ and $\\mathrm{pH}$:\n$$ \\Delta G(U, \\mathrm{pH}) = \\Delta G^{\\circ} - e U - k_{\\mathrm{B}} T \\ln(10) \\cdot \\mathrm{pH} $$\nSince energies are in $\\mathrm{eV}$ and potential $U$ is in $\\mathrm{V}$, the term $e U$ has units of $\\mathrm{eV}$, maintaining dimensional consistency.\n\nStep 2: Derivation of the hydroxyl coverage $\\theta(U, \\mathrm{pH})$\n\nThe problem specifies a single type of noninteracting site, for which the Langmuir isotherm is the appropriate equilibrium model. The isotherm relates the fractional coverage of adsorbed species, $\\theta$, to the fraction of vacant sites, $1-\\theta$. The ratio of these fractions at equilibrium is determined by the Boltzmann factor of the adsorption free energy, $\\Delta G(U, \\mathrm{pH})$.\n$$ \\frac{\\theta}{1-\\theta} = \\exp\\left(-\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right) $$\nSolving this equation for $\\theta$ yields the expression for the coverage:\n$$ \\theta = \\frac{\\exp\\left(-\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)}{1 + \\exp\\left(-\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)} $$\nThis can be algebraically rearranged into the form of a Fermi-Dirac distribution by multiplying the numerator and denominator by $\\exp\\left(\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)$:\n$$ \\theta(U, \\mathrm{pH}) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)} $$\nThis is the expression for the coverage, denoted $\\theta_{\\mathrm{CHE}}$.\n\nStep 3: Incorporation of the explicit solvation correction\n\nAn explicit solvation correction, $\\delta G_{\\mathrm{solv}} = -0.25\\,\\mathrm{eV}$, is introduced as an additive term to the free energy of the adsorbed $\\mathrm{OH}^{*}$. This modifies the standard reaction free energy:\n$$ \\Delta G^{\\circ}_{\\mathrm{corr}} = \\Delta G^{\\circ} + \\delta G_{\\mathrm{solv}} $$\nSubstituting the given values:\n$$ \\Delta G^{\\circ}_{\\mathrm{corr}} = 0.62\\,\\mathrm{eV} - 0.25\\,\\mathrm{eV} = 0.37\\,\\mathrm{eV} $$\nThe corrected potential- and pH-dependent free energy, $\\Delta G_{\\mathrm{corr}}(U, \\mathrm{pH})$, is obtained by using $\\Delta G^{\\circ}_{\\mathrm{corr}}$ in the expression derived in Step 1:\n$$ \\Delta G_{\\mathrm{corr}}(U, \\mathrm{pH}) = \\Delta G^{\\circ}_{\\mathrm{corr}} - e U - k_{\\mathrm{B}} T \\ln(10) \\cdot \\mathrm{pH} $$\nThe corresponding corrected coverage, $\\theta_{\\mathrm{corr}}(U, \\mathrm{pH})$, is calculated using the Langmuir isotherm form from Step 2 with this corrected free energy:\n$$ \\theta_{\\mathrm{corr}}(U, \\mathrm{pH}) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G_{\\mathrm{corr}}(U, \\mathrm{pH})}{k_{\\mathrm{B}} T}\\right)} $$\n\nStep 4: Calculation of the absolute difference in coverage $\\Delta \\theta$\n\nThe quantitative impact of the solvation correction is assessed by computing the absolute difference between the coverage predicted by the standard CHE model ($\\theta_{\\mathrm{CHE}}$) and the corrected model ($\\theta_{\\mathrm{corr}}$):\n$$ \\Delta \\theta = \\left|\\theta_{\\mathrm{CHE}}(U, \\mathrm{pH}) - \\theta_{\\mathrm{corr}}(U, \\mathrm{pH})\\right| $$\nThis calculation will be performed for each test case using the derived formulas and the provided physical constants: $T = 298.15\\,\\mathrm{K}$, $k_{\\mathrm{B}} = 8.617333262\\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$, $\\Delta G^{\\circ} = 0.62\\,\\mathrm{eV}$, and $\\delta G_{\\mathrm{solv}} = -0.25\\,\\mathrm{eV}$. The numerical implementation will compute the value $\\ln(10)$ and the product $k_{\\mathrm{B}}T$ for use in the calculations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the absolute difference in OH* coverage on a Ni surface\n    between a standard CHE model and a model with an explicit solvation correction.\n    \"\"\"\n\n    # Define scientifically realistic constants and parameters.\n    # Temperature in Kelvin.\n    T = 298.15  # K\n    # Boltzmann constant in eV/K.\n    KB = 8.617333262e-5  # eV/K\n    # Standard-state reaction free energy for OH* formation in eV.\n    DELTA_G_ZERO = 0.62  # eV\n    # Explicit solvation correction to the OH* formation free energy in eV.\n    DELTA_G_SOLV = -0.25  # eV\n\n    # Pre-calculate common terms for efficiency and clarity.\n    # Thermal energy in eV.\n    KBT = KB * T\n    # Conversion factor from pH to energy in eV.\n    PH_TO_EV = KBT * np.log(10)\n\n    def calculate_coverage(U, pH, delta_g_correction):\n        \"\"\"\n        Calculates OH* coverage using the Langmuir isotherm.\n\n        Args:\n            U (float): Electrode potential in V vs. SHE.\n            pH (float): Potential of hydrogen (dimensionless).\n            delta_g_correction (float): Additive correction to the standard\n                                        free energy in eV.\n\n        Returns:\n            float: Adsorbate coverage theta, a dimensionless value in [0, 1].\n        \"\"\"\n        # Calculate the standard free energy including any corrections.\n        delta_g_zero_effective = DELTA_G_ZERO + delta_g_correction\n\n        # Calculate the potential- and pH-dependent reaction free energy.\n        # The term eU in eV is numerically equal to U in V.\n        delta_g = delta_g_zero_effective - U - PH_TO_EV * pH\n\n        # Calculate the argument for the exponential function.\n        # Handle potential numerical overflow by clipping the argument.\n        # A large positive delta_g/(kBT) makes exp() very large, so theta - 0.\n        # A large negative delta_g/(kBT) makes exp() - 0, so theta - 1.\n        exponent_arg = delta_g / KBT\n        # Clip the argument to avoid overflow in np.exp\n        exponent_arg = np.clip(exponent_arg, -700, 700)\n        \n        # Calculate coverage using the Langmuir isotherm expression.\n        theta = 1.0 / (1.0 + np.exp(exponent_arg))\n        \n        return theta\n\n    # Define the test suite from the problem statement.\n    # Each case is a tuple of (U in V, pH).\n    test_cases = [\n        (0.60, 13),\n        (0.00, 0),\n        (0.25, 7),\n        (1.00, 14),\n        (-0.10, 1),\n        (0.50, 2),\n    ]\n\n    results = []\n    for U_val, pH_val in test_cases:\n        # Calculate coverage for the standard CHE model (no correction).\n        theta_che = calculate_coverage(U_val, pH_val, 0.0)\n        \n        # Calculate coverage for the model with explicit solvation correction.\n        theta_corr = calculate_coverage(U_val, pH_val, DELTA_G_SOLV)\n        \n        # Calculate the absolute difference in coverage.\n        delta_theta = abs(theta_che - theta_corr)\n        \n        results.append(delta_theta)\n\n    # Calculate the arithmetic mean of the six delta_theta values.\n    mean_delta_theta = sum(results) / len(results)\n    \n    # Append the mean to the list of results.\n    results.append(mean_delta_theta)\n\n    # Format the final output as specified: a comma-separated list\n    # in brackets, with each value rounded to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "To accurately simulate electrochemical interfaces, it is essential to mimic the experimental condition of constant electrode potential. This practice delves into the mechanics of a constant potential algorithm, revealing how a simulation dynamically maintains a target potential. You will construct a model that accounts for the capacitive properties of the metal and the electrolyte, and calculate the charge response required to counteract the potential shift induced by adsorbing species.  This exercise provides a clear, practical understanding of the computational techniques that enable realistic atomistic simulations of corrosion.",
            "id": "4236755",
            "problem": "Consider an atomistic model of a metallic slab interfacing an electrolyte, represented by a rectangular slab of area $A$ and thickness $t$, with a spatially uniform, adjustable background volumetric charge density $\\rho_b$ confined to the slab volume. The goal is to implement a constant potential algorithm that, for any given adsorption event introducing a set of surface-normal dipole moments, adjusts $\\rho_b$ to maintain a prescribed target electrode potential $E_{\\mathrm{target}}$ relative to a fixed reference.\n\nUse the following physically motivated base relationships, suitable for planar systems in computational electrochemistry:\n- The double layer region behaves as an Electrical Double Layer (EDL) with areal capacitance $C_{\\mathrm{dl}}^{A}$; small changes in surface charge density $d\\sigma$ produce a change in potential $d\\phi_{\\mathrm{dl}}$ given by $d\\phi_{\\mathrm{dl}} = \\dfrac{d\\sigma}{C_{\\mathrm{dl}}^{A}}$.\n- The finite Density of States (DOS) of the metallic slab can be captured by a quantum capacitance per area $C_{\\mathrm{q}}^{A}$; small changes in surface charge density $d\\sigma$ produce an additional change in electronic potential $d\\phi_{\\mathrm{q}} = \\dfrac{d\\sigma}{C_{\\mathrm{q}}^{A}}$. The two capacitances are in series in the sense that the potential change due to charge is the sum $d\\phi_{\\mathrm{charge}} = d\\phi_{\\mathrm{dl}} + d\\phi_{\\mathrm{q}} = d\\sigma\\left(\\dfrac{1}{C_{\\mathrm{dl}}^{A}} + \\dfrac{1}{C_{\\mathrm{q}}^{A}}\\right)$.\n- An adsorbate layer with total surface-normal dipole moment $\\sum_i p_{z,i}$ distributed over area $A$ induces a dipole sheet potential shift $\\Delta\\phi_{\\mathrm{dip}} = -\\dfrac{\\mu_{\\mathrm{areal}}}{\\epsilon_0}$, where $\\mu_{\\mathrm{areal}} = \\dfrac{\\sum_i p_{z,i}}{A}$ and $\\epsilon_0$ is the vacuum permittivity. Use $\\epsilon_0 = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$.\n- A uniform volumetric background charge density $\\rho_b$ within thickness $t$ yields a surface charge density $\\sigma$ given by $\\sigma = \\rho_b \\, t$.\n\nLet $E_0$ denote the baseline electrode potential (relative to the same reference) at zero background charge and without adsorbates. Under a background charge $\\rho_b$ and adsorbates with dipole moments $\\{p_{z,i}\\}$, the potential becomes $E = E_0 + \\Delta\\phi_{\\mathrm{charge}} + \\Delta\\phi_{\\mathrm{dip}}$. The constant potential algorithm requires choosing $\\rho_b$ such that $E = E_{\\mathrm{target}}$.\n\nYour program must, for each test case, compute the value of $\\rho_b$ (in $\\mathrm{C/m^3}$) required to maintain $E_{\\mathrm{target}}$ under the given adsorption event and capacitances. Assume linear response and spatially uniform $\\rho_b$ across the slab thickness. If $C_{\\mathrm{q}}^{A}$ is effectively infinite, treat $\\dfrac{1}{C_{\\mathrm{q}}^{A}}$ as $0$.\n\nAll inputs must be treated using the following units:\n- $A$ in $\\mathrm{m^2}$,\n- $t$ in $\\mathrm{m}$,\n- $E_{\\mathrm{target}}$ and $E_0$ in $\\mathrm{V}$,\n- $C_{\\mathrm{dl}}^{A}$ and $C_{\\mathrm{q}}^{A}$ in $\\mathrm{F/m^2}$,\n- $p_{z,i}$ in $\\mathrm{C \\cdot m}$,\n- $\\rho_b$ in $\\mathrm{C/m^3}$.\n\nImplement the algorithm to compute $\\rho_b$ for the following test suite of parameter sets, each specified as a tuple $(A, t, C_{\\mathrm{dl}}^{A}, C_{\\mathrm{q}}^{A}, E_0, E_{\\mathrm{target}}, \\{p_{z,i}\\})$:\n- Test case 1 (general case with finite quantum capacitance and significant adsorption): $(9.0 \\times 10^{-18}, 2.0 \\times 10^{-9}, 0.2, 10.0, 0.0, 0.5, \\{1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}, 1.2 \\times 10^{-29}\\})$.\n- Test case 2 (ideal metal limit and no adsorption): $(9.0 \\times 10^{-18}, 2.0 \\times 10^{-9}, 0.2, +\\infty, 0.0, 0.0, \\{\\})$.\n- Test case 3 (negative dipole orientation and mixed capacitances): $(16.0 \\times 10^{-18}, 1.5 \\times 10^{-9}, 0.15, 2.0, 0.0, 1.0, \\{-0.8 \\times 10^{-29}, -0.8 \\times 10^{-29}, -0.8 \\times 10^{-29}, -0.8 \\times 10^{-29}, -0.8 \\times 10^{-29}\\})$.\n- Test case 4 (small double layer capacitance, large quantum capacitance, single adsorbate, nonzero baseline): $(25.0 \\times 10^{-18}, 3.0 \\times 10^{-9}, 0.05, 50.0, 0.1, -0.2, \\{3.0 \\times 10^{-29}\\})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_k$ is the computed $\\rho_b$ (in $\\mathrm{C/m^3}$) for test case $k$ as a floating-point number.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. It presents a simplified but physically meaningful model used in the atomistic modeling of electrochemical interfaces under constant potential conditions. All required parameters, constants, and relationships are provided, and the units are consistent. The problem is therefore deemed **valid**, and a solution can be formulated.\n\nThe objective is to determine the volumetric background charge density, $\\rho_b$, required to maintain a target electrode potential, $E_{\\mathrm{target}}$, for a metallic slab in an electrolyte. The potential is affected by both the charge on the slab and the presence of adsorbed species with dipole moments.\n\nThe total electrode potential, $E$, is given as a linear superposition of three components:\n$$E = E_0 + \\Delta\\phi_{\\mathrm{charge}} + \\Delta\\phi_{\\mathrm{dip}}$$\nwhere $E_0$ is the baseline potential of the uncharged, adsorbate-free system, $\\Delta\\phi_{\\mathrm{charge}}$ is the potential shift due to added charge, and $\\Delta\\phi_{\\mathrm{dip}}$ is the potential shift due to an adsorbate layer. The constant potential condition requires that we set $E = E_{\\mathrm{target}}$.\n\nLet us derive the expressions for $\\Delta\\phi_{\\mathrm{charge}}$ and $\\Delta\\phi_{\\mathrm{dip}}$.\n\nThe potential shift due to the adsorbate layer, $\\Delta\\phi_{\\mathrm{dip}}$, is caused by the sheet of surface-normal dipoles. Given a set of individual dipole moments $\\{p_{z,i}\\}$ distributed over an area $A$, the areal dipole density is $\\mu_{\\mathrm{areal}} = \\frac{\\sum_i p_{z,i}}{A}$. The resulting potential shift is given by:\n$$\\Delta\\phi_{\\mathrm{dip}} = -\\frac{\\mu_{\\mathrm{areal}}}{\\epsilon_0} = -\\frac{\\sum_i p_{z,i}}{A \\epsilon_0}$$\nwhere $\\epsilon_0$ is the vacuum permittivity.\n\nThe potential shift due to charge, $\\Delta\\phi_{\\mathrm{charge}}$, arises from charging the slab. The model includes two contributions to the capacitance, which act in series: the electrical double layer capacitance, $C_{\\mathrm{dl}}^{A}$, and the quantum capacitance of the metal, $C_{\\mathrm{q}}^{A}$. The total inverse capacitance per unit area is the sum of the individual inverse capacitances:\n$$\\frac{1}{C_{\\mathrm{total}}^{A}} = \\frac{1}{C_{\\mathrm{dl}}^{A}} + \\frac{1}{C_{\\mathrm{q}}^{A}}$$\nThe potential shift is related to the surface charge density, $\\sigma$, through this total capacitance. Based on the provided linear response relation $d\\phi = d\\sigma / C^A$, for a finite change we have:\n$$\\Delta\\phi_{\\mathrm{charge}} = \\sigma \\left(\\frac{1}{C_{\\mathrm{dl}}^{A}} + \\frac{1}{C_{\\mathrm{q}}^{A}}\\right)$$\nThe surface charge density $\\sigma$ is generated by the uniform volumetric background charge density $\\rho_b$ integrated through the slab thickness $t$:\n$$\\sigma = \\rho_b t$$\nSubstituting this into the expression for $\\Delta\\phi_{\\mathrm{charge}}$ yields:\n$$\\Delta\\phi_{\\mathrm{charge}} = (\\rho_b t) \\left(\\frac{1}{C_{\\mathrm{dl}}^{A}} + \\frac{1}{C_{\\mathrm{q}}^{A}}\\right)$$\n\nNow, we enforce the constant potential condition, $E = E_{\\mathrm{target}}$, by substituting the expressions for the potential shifts into the primary equation:\n$$E_{\\mathrm{target}} = E_0 + (\\rho_b t) \\left(\\frac{1}{C_{\\mathrm{dl}}^{A}} + \\frac{1}{C_{\\mathrm{q}}^{A}}\\right) - \\frac{\\sum_i p_{z,i}}{A \\epsilon_0}$$\nOur goal is to solve this equation for $\\rho_b$. Rearranging the terms to isolate $\\rho_b$:\n$$E_{\\mathrm{target}} - E_0 + \\frac{\\sum_i p_{z,i}}{A \\epsilon_0} = (\\rho_b t) \\left(\\frac{1}{C_{\\mathrm{dl}}^{A}} + \\frac{1}{C_{\\mathrm{q}}^{A}}\\right)$$\nFinally, dividing by the terms multiplying $\\rho_b$, we arrive at the analytical expression for the required background charge density:\n$$\\rho_b = \\frac{E_{\\mathrm{target}} - E_0 + \\frac{\\sum_i p_{z,i}}{A \\epsilon_0}}{t \\left(\\frac{1}{C_{\\mathrm{dl}}^{A}} + \\frac{1}{C_{\\mathrm{q}}^{A}}\\right)}$$\nThis equation is valid provided that the denominator is non-zero. Since the thickness $t$ and the capacitances $C_{\\mathrm{dl}}^{A}$ and $C_{\\mathrm{q}}^{A}$ are physical quantities that must be positive, the denominator is always positive. The special case of an ideal metal corresponds to an infinite quantum capacitance, $C_{\\mathrm{q}}^{A} \\to \\infty$. In this limit, the term $\\frac{1}{C_{\\mathrm{q}}^{A}}$ becomes $0$, as specified in the problem statement.\n\nThe algorithm to be implemented will compute $\\rho_b$ for each test case by direct evaluation of this derived formula.\n\nThe procedure is as follows:\n1.  Define the physical constant $\\epsilon_0 = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$.\n2.  For each test case tuple $(A, t, C_{\\mathrm{dl}}^{A}, C_{\\mathrm{q}}^{A}, E_0, E_{\\mathrm{target}}, \\{p_{z,i}\\})$:\n    a. Calculate the total surface-normal dipole moment, $P_z = \\sum_i p_{z,i}$. If the set of dipoles is empty, this sum is $0$.\n    b. Calculate the dipole potential contribution term: $\\Delta V_{\\mathrm{dipole}} = \\frac{P_z}{A \\epsilon_0}$.\n    c. Calculate the numerator of the expression for $\\rho_b$: $N = E_{\\mathrm{target}} - E_0 + \\Delta V_{\\mathrm{dipole}}$.\n    d. Calculate the inverse capacitance term. If $C_{\\mathrm{q}}^{A}$ is infinite, $\\frac{1}{C_{\\mathrm{q}}^{A}}$ is treated as $0$. Otherwise, it is computed directly. Let $C_{\\mathrm{inv\\_sum}} = \\frac{1}{C_{\\mathrm{dl}}^{A}} + \\frac{1}{C_{\\mathrm{q}}^{A}}$.\n    e. Calculate the denominator: $D = t \\times C_{\\mathrm{inv\\_sum}}$.\n    f. Compute the final result: $\\rho_b = N / D$.\n3.  Store the computed $\\rho_b$ for each case.\n4.  Format the collected results into the specified output string `[r_1,r_2,r_3,r_4]`.\n\nThis procedure will be encoded into a Python program adhering to the specified environment and formatting constraints.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the required background charge density rho_b to maintain a\n    constant electrode potential based on a simplified electrochemical model.\n    \"\"\"\n    # Define physical constants\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in F/m\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, t, C_dl_A, C_q_A, E_0, E_target, pz_list)\n    # Units: A (m^2), t (m), C (F/m^2), E (V), pz (C*m)\n    test_cases = [\n        # Test case 1\n        (9.0e-18, 2.0e-9, 0.2, 10.0, 0.0, 0.5, [1.2e-29] * 10),\n        # Test case 2\n        (9.0e-18, 2.0e-9, 0.2, np.inf, 0.0, 0.0, []),\n        # Test case 3\n        (16.0e-18, 1.5e-9, 0.15, 2.0, 0.0, 1.0, [-0.8e-29] * 5),\n        # Test case 4\n        (25.0e-18, 3.0e-9, 0.05, 50.0, 0.1, -0.2, [3.0e-29]),\n    ]\n\n    results = []\n\n    def calculate_rho_b(A, t, C_dl_A, C_q_A, E_0, E_target, pz_list):\n        \"\"\"\n        Calculates rho_b for a single set of parameters.\n\n        The formula used is:\n        rho_b = (E_target - E_0 + (sum(pz) / (A * EPSILON_0))) / (t * (1/C_dl_A + 1/C_q_A))\n        \"\"\"\n        # Sum of surface-normal dipole moments\n        sum_pz = np.sum(pz_list)\n\n        # Numerator of the expression for rho_b\n        # This represents the total potential difference to be compensated by charge.\n        numerator = E_target - E_0 + (sum_pz / (A * EPSILON_0))\n\n        # Inverse of the total series capacitance per area\n        # Note: 1/np.inf correctly evaluates to 0.0 in floating-point arithmetic.\n        inv_C_total_A = (1 / C_dl_A) + (1 / C_q_A)\n\n        # Denominator of the expression for rho_b\n        denominator = t * inv_C_total_A\n\n        # Handle the case where the denominator might be zero, although\n        # physically it should be positive.\n        if denominator == 0:\n            # This would only happen if t=0 or both capacitances are infinite,\n            # and may indicate an ill-posed physical scenario not covered here.\n            # If the numerator is also zero, the result is indeterminate (e.g., 0).\n            # If numerator is non-zero, it is an impossible condition (inf).\n            return 0.0 if numerator == 0 else np.inf\n\n        rho_b = numerator / denominator\n        return rho_b\n\n    for case in test_cases:\n        result = calculate_rho_b(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The predictive power of atomistic simulations relies on correctly accounting for systematic errors that arise from computational constraints, such as the finite size of the simulated system. This practice addresses the critical issue of finite-size effects in the calculation of electrochemical properties like capacitance. You will implement a charge equilibration model for a discretized electrode and perform calculations for several system sizes.  The key takeaway is learning how to perform a finite-size scaling analysis to extrapolate your results to the infinite-area limit, a vital skill for obtaining physically meaningful and reliable data from any atomistic simulation.",
            "id": "4236813",
            "problem": "Consider a planar metallic electrode interfaced with an electrolyte. In atomistic models of corrosion processes, the metallic electrode is discretized into $N$ atomic sites arranged on a square lattice with lateral dimensions $L_x = L_y = L$ and lattice constant $a$. Each site $i$ carries an induced charge $q_i$ in response to an applied electrode potential $V$, and the electrolyte screens electrostatic interactions with a Debye screening length $\\lambda_D$. Assume interactions are pairwise additive and governed by a screened Coulomb (Yukawa) kernel. The electrostatic energy of a charge configuration $\\{q_i\\}$ under constant applied potential is modeled as\n$$\nU(\\{q_i\\};V) = \\frac{1}{2}\\sum_{i=1}^{N} \\eta\\, q_i^2 + \\frac{1}{2}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N} \\frac{1}{4\\pi\\varepsilon_0 \\varepsilon_r} \\frac{q_i q_j}{r_{ij}} e^{-r_{ij}/\\lambda_D} - V \\sum_{i=1}^{N} q_i,\n$$\nwhere $r_{ij}$ is the in-plane distance between sites $i$ and $j$, $\\varepsilon_0$ is the vacuum permittivity, $\\varepsilon_r$ is the relative permittivity of the electrolyte, and $\\eta$ is a local quadratic \"electronic hardness\" coefficient that regularizes the response of each site. The electrode is a square of area $A = L^2$, populated by $N = n^2$ sites at positions $\\mathbf{r}_i$ on an $n\\times n$ lattice with spacing $a$, so that $L = n a$. The total induced charge is $Q(V) = \\sum_{i=1}^{N} q_i(V)$, and the differential capacitance $C$ at small applied potentials is defined by the linear response relation $Q(V) \\approx C V$ for $|V| \\to 0$. The intensive quantity of interest is the capacitance per area $C/A$ in $\\mathrm{F}/\\mathrm{m}^2$.\n\nYour task is to write a program that, for a given set of physically plausible parameters $(a, \\varepsilon_r, \\lambda_D, \\eta)$ and a sequence of lateral sizes $L$ (obtained by varying $n$ while keeping $a$ fixed), does all of the following:\n- Constructs the square lattice of $N = n^2$ sites and computes the pairwise distances $r_{ij}$ between all site pairs $(i,j)$ in meters. Use strictly two-dimensional distances within a single periodic cell without summing over images; that is, treat the electrode as a finite patch with open lateral boundaries.\n- Minimizes the energy $U(\\{q_i\\};V)$ with respect to $\\{q_i\\}$ at two small potentials $V = +\\Delta V$ and $V = -\\Delta V$, using a deterministic numerical approach. From these two solutions, estimate the differential capacitance $C(L)$ for that lateral size via a centered finite difference approximation of $dQ/dV$ as $C(L) \\approx \\left(Q(+\\Delta V) - Q(-\\Delta V)\\right) / \\left(2 \\Delta V\\right)$, where $Q(V) = \\sum_i q_i(V)$.\n- Converts $C(L)$ to $C(L)/A$ in $\\mathrm{F}/\\mathrm{m}^2$ for each $L$.\n- Quantifies finite-size effects by fitting the $L$-dependence of $C(L)/A$ to a polynomial in $1/L$ of degree two, $C(L)/A \\approx c_0 + c_1/L + c_2/L^2$, and reports the extrapolated infinite-area limit $c_0$ (in $\\mathrm{F}/\\mathrm{m}^2$).\n\nUse the following fixed constants and units in your program:\n- Vacuum permittivity $\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F}/\\mathrm{m}$.\n- Elementary charge $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$ (only for sanity checks if needed; it is not required in the computation).\n- Potential step $\\Delta V = 10^{-3}\\,\\mathrm{V}$.\n\nExpress all physical distances in meters, potentials in volts, charges in coulombs, energies in joules, and report capacitance per unit area in $\\mathrm{F}/\\mathrm{m}^2$. Angles are not involved in this problem.\n\nTest Suite:\nFor each parameter set, run the calculations for four lateral sizes obtained by $n \\in \\{6,8,10,12\\}$, so $L = n a$ and $A = L^2$. Use the following four scientifically plausible parameter sets, each specified with consistent units:\n1. Case A (happy path):\n   - $a = 0.25\\,\\mathrm{nm}$,\n   - $\\varepsilon_r = 78.4$,\n   - $\\lambda_D = 0.5\\,\\mathrm{nm}$,\n   - $\\eta = 1.0\\times 10^{19}\\,\\mathrm{J}/\\mathrm{C}^2$.\n2. Case B (longer screening length):\n   - $a = 0.25\\,\\mathrm{nm}$,\n   - $\\varepsilon_r = 78.4$,\n   - $\\lambda_D = 2.0\\,\\mathrm{nm}$,\n   - $\\eta = 1.0\\times 10^{19}\\,\\mathrm{J}/\\mathrm{C}^2$.\n3. Case C (lower permittivity):\n   - $a = 0.25\\,\\mathrm{nm}$,\n   - $\\varepsilon_r = 10.0$,\n   - $\\lambda_D = 0.5\\,\\mathrm{nm}$,\n   - $\\eta = 1.0\\times 10^{19}\\,\\mathrm{J}/\\mathrm{C}^2$.\n4. Case D (softer electronic hardness):\n   - $a = 0.25\\,\\mathrm{nm}$,\n   - $\\varepsilon_r = 78.4$,\n   - $\\lambda_D = 0.5\\,\\mathrm{nm}$,\n   - $\\eta = 5.0\\times 10^{18}\\,\\mathrm{J}/\\mathrm{C}^2$.\n\nFor each case, fit $C(L)/A$ versus $1/L$ using the four $L$ values and extract the coefficient $c_0$ corresponding to the infinite-area limit. Your program should produce a single line of output containing the four $c_0$ values for Cases Aâ€“D, in order, as a comma-separated Python list enclosed in square brackets (e.g., \"[$c_0^\\mathrm{A},c_0^\\mathrm{B},c_0^\\mathrm{C},c_0^\\mathrm{D}$]\"). Each value must be a float in $\\mathrm{F}/\\mathrm{m}^2$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and provides all necessary information for a unique and meaningful solution. It describes a standard constant-potential charge equilibration model for a discretized electrode-electrolyte interface, a common task in computational electrochemistry. The physical parameters are plausible, and the computational tasks are well-defined and feasible. Therefore, the problem is deemed valid, and a full solution is presented below.\n\nThe core of the problem is to find the equilibrium charge distribution $\\{q_i\\}$ on a set of $N$ discrete atomic sites that minimizes the specified electrostatic energy functional $U(\\{q_i\\}; V)$ at a constant applied potential $V$. The energy functional is given by:\n$$\nU(\\{q_i\\};V) = \\frac{1}{2}\\sum_{i=1}^{N} \\eta\\, q_i^2 + \\frac{1}{2}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N} J_{ij} q_i q_j - V \\sum_{i=1}^{N} q_i\n$$\nwhere $J_{ij}$ represents the screened Coulomb interaction between sites $i$ and $j$:\n$$\nJ_{ij} = \\frac{1}{4\\pi\\varepsilon_0 \\varepsilon_r} \\frac{e^{-r_{ij}/\\lambda_D}}{r_{ij}}\n$$\nThis energy functional $U$ is a quadratic function of the charges $\\{q_i\\}$. The unique minimum of such a function can be found by setting the gradient with respect to each charge $q_k$ to zero. The condition $\\partial U / \\partial q_k = 0$ for all $k \\in \\{1, \\dots, N\\}$ yields a system of $N$ linear equations:\n$$\n\\frac{\\partial U}{\\partial q_k} = \\eta q_k + \\sum_{\\substack{j=1 \\\\ j\\neq k}}^{N} J_{kj} q_j - V = 0\n$$\nThis system can be written in matrix form as:\n$$\n\\mathbf{H} \\mathbf{q} = V \\mathbf{1}\n$$\nHere, $\\mathbf{q}$ is the column vector of the charges $[q_1, q_2, \\dots, q_N]^T$, $\\mathbf{1}$ is a column vector of ones of length $N$, and $\\mathbf{H}$ is the $N \\times N$ symmetric Hessian matrix of the quadratic part of the energy. Its elements are:\n$$\nH_{ij} = \\frac{\\partial^2 U}{\\partial q_i \\partial q_j} =\n\\begin{cases}\n\\eta  \\text{if } i=j \\\\\nJ_{ij}  \\text{if } i\\neq j\n\\end{cases}\n$$\nThe value of the electronic hardness parameter $\\eta$ is positive and sufficiently large compared to the off-diagonal interaction terms $J_{ij}$, which ensures that the Hessian matrix $\\mathbf{H}$ is positive definite. This guarantees that the linear system has a unique solution, corresponding to the unique minimum of the energy functional.\n\nThe solution proceeds through the following steps for each of the four parameter cases:\n\n1.  **Lattice Generation**: For each given grid size parameter $n \\in \\{6, 8, 10, 12\\}$, we construct a $2$D square lattice of $N = n^2$ sites. The sites are placed at coordinates $(i \\cdot a, j \\cdot a)$ for $i, j \\in \\{0, 1, \\dots, n-1\\}$. The lateral dimension of the system is $L = n a$. We then compute the full $N \\times N$ matrix of pairwise Euclidean distances $r_{ij}$ between all sites.\n\n2.  **Hessian Matrix Construction**: Using the computed distances $r_{ij}$ and the given parameters $(\\varepsilon_r, \\lambda_D, \\eta)$, the Hessian matrix $\\mathbf{H}$ is assembled. The diagonal elements are set to $\\eta$, and the off-diagonal elements are calculated using the screened Coulomb interaction kernel $J_{ij}$. All parameters are converted to base SI units (meters, Farads, Joules, Coulombs).\n\n3.  **Capacitance Calculation**: The problem requires the differential capacitance $C$, estimated via a centered finite difference. The charge vector $\\mathbf{q}(V)$ is found by solving the linear system $\\mathbf{H} \\mathbf{q}(V) = V \\mathbf{1}$. Since the system is linear, $\\mathbf{q}(V) = V \\cdot (\\mathbf{H}^{-1}\\mathbf{1})$, which implies that the total charge $Q(V) = \\sum_i q_i(V)$ is linear in $V$. Specifically, $Q(-V) = -Q(+V)$. The finite difference formula for capacitance thus simplifies significantly:\n    $$\n    C(L) = \\frac{Q(+\\Delta V) - Q(-\\Delta V)}{2\\Delta V} = \\frac{Q(+\\Delta V) - (-Q(+\\Delta V))}{2\\Delta V} = \\frac{2 Q(+\\Delta V)}{2\\Delta V} = \\frac{Q(+\\Delta V)}{\\Delta V}\n    $$\n    Therefore, for each lattice size $L$, we solve the linear system once for $V = +\\Delta V = 10^{-3}\\,\\mathrm{V}$ to find the charge vector $\\mathbf{q}(+\\Delta V)$, compute the total charge $Q(+\\Delta V) = \\sum_i q_i$, and obtain the capacitance $C(L)$. This is then normalized by the electrode area $A = L^2$ to get the capacitance per unit area, $C(L)/A$.\n\n4.  **Finite-Size Extrapolation**: The procedure above is repeated for the four lattice sizes corresponding to $n \\in \\{6, 8, 10, 12\\}$. This yields four data points of $(1/L, C/A)$. These points are then fitted to a quadratic polynomial in $1/L$:\n    $$\n    \\frac{C(L)}{A} \\approx c_0 + c_1 \\frac{1}{L} + c_2 \\frac{1}{L^2}\n    $$\n    This fit is performed using a standard linear least-squares method (`numpy.polyfit`). The resulting coefficient $c_0$ represents the extrapolated capacitance per unit area for an infinitely large electrode ($L \\to \\infty$), which is the desired result.\n\nThe provided Python code implements this entire workflow. It iterates through the four specified test cases, performs the calculations for the four lattice sizes in each case, executes the polynomial fit, and extracts the $c_0$ parameter. The final output is a list of the four $c_0$ values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the infinite-area capacitance per unit area for an atomistic \n    electrode model under different physical parameters.\n    \"\"\"\n\n    # --- Fixed Constants in SI units ---\n    # Vacuum permittivity in F/m\n    EPS0 = 8.854187817e-12\n    # Potential step for finite difference in V\n    DELTA_V = 1.0e-3\n    \n    # --- Test Cases ---\n    test_cases = [\n        # Case A (happy path)\n        {'a': 0.25e-9, 'eps_r': 78.4, 'lambda_d': 0.5e-9, 'eta': 1.0e19},\n        # Case B (longer screening length)\n        {'a': 0.25e-9, 'eps_r': 78.4, 'lambda_d': 2.0e-9, 'eta': 1.0e19},\n        # Case C (lower permittivity)\n        {'a': 0.25e-9, 'eps_r': 10.0, 'lambda_d': 0.5e-9, 'eta': 1.0e19},\n        # Case D (softer electronic hardness)\n        {'a': 0.25e-9, 'eps_r': 78.4, 'lambda_d': 0.5e-9, 'eta': 5.0e18},\n    ]\n\n    # --- Lattice Sizes ---\n    n_values = [6, 8, 10, 12]\n    \n    results = []\n\n    for case_params in test_cases:\n        a = case_params['a']\n        eps_r = case_params['eps_r']\n        lambda_d = case_params['lambda_d']\n        eta = case_params['eta']\n        \n        # Lists to store results for finite-size analysis\n        inverse_L_vals = []\n        cap_per_area_vals = []\n        \n        k_const = 1.0 / (4.0 * np.pi * EPS0 * eps_r)\n\n        for n in n_values:\n            N = n * n\n            L = n * a\n            \n            # 1. Construct lattice and compute pairwise distances\n            coords = np.array([[i * a, j * a] for i in range(n) for j in range(n)])\n            \n            # Using broadcasting for efficient distance calculation\n            diffs = coords[:, np.newaxis, :] - coords[np.newaxis, :, :]\n            dist_matrix = np.sqrt(np.sum(diffs**2, axis=-1))\n\n            # 2. Construct the Hessian matrix H\n            H = np.zeros((N, N))\n            \n            # Off-diagonal elements (i != j)\n            # Create a mask to avoid division by zero for diagonal elements\n            off_diagonal_mask = (dist_matrix  0)\n            r_ij = dist_matrix[off_diagonal_mask]\n            \n            interaction_values = k_const * np.exp(-r_ij / lambda_d) / r_ij\n            H[off_diagonal_mask] = interaction_values\n            \n            # Diagonal elements (i == j)\n            np.fill_diagonal(H, eta)\n\n            # 3. Solve the linear system for charges\n            # We solve H*q = V*1 for V = DELTA_V\n            V_vector = np.full(N, DELTA_V)\n            q_vector = np.linalg.solve(H, V_vector)\n\n            # 4. Calculate capacitance per area\n            # Total charge Q = sum(q_i)\n            Q_total = np.sum(q_vector)\n            \n            # Capacitance C = Q(DELTA_V) / DELTA_V\n            capacitance = Q_total / DELTA_V\n            \n            # Area A = L^2\n            area = L * L\n            \n            # Capacitance per unit area in F/m^2\n            cap_per_area = capacitance / area\n            \n            # Store values for fitting\n            inverse_L_vals.append(1.0 / L)\n            cap_per_area_vals.append(cap_per_area)\n\n        # 5. Fit to polynomial and extract c0\n        # Fit C/A = c0 + c1*(1/L) + c2*(1/L)^2\n        # numpy.polyfit returns coefficients [c2, c1, c0] for descending powers\n        coeffs = np.polyfit(inverse_L_vals, cap_per_area_vals, 2)\n        c0 = coeffs[2]\n        \n        results.append(c0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}