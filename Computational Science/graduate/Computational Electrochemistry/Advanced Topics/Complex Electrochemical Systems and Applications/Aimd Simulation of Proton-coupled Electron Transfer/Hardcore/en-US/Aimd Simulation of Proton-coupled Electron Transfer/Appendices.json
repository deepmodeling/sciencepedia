{
    "hands_on_practices": [
        {
            "introduction": "Before embarking on complex Ab Initio Molecular Dynamics (AIMD) simulations, it is crucial to assess the validity of our underlying physical models. In the context of proton-coupled electron transfer (PCET), one of the most significant modeling decisions is how to treat the proton. This first practice explores this fundamental question by comparing the kinetic energy of a proton, estimated from a simple quantum mechanical model, against its classical counterpart derived from the equipartition theorem. By performing this calculation for a typical O–H stretch, you will gain a quantitative appreciation for why nuclear quantum effects are often non-negligible for hydrogen and understand the potential limitations of a purely classical treatment of nuclei in AIMD .",
            "id": "4236281",
            "problem": "In Ab Initio Molecular Dynamics (AIMD) simulations of Proton-Coupled Electron Transfer (PCET), a central modeling decision is whether to treat the proton as a classical particle or to include nuclear quantum effects. Consider the one-dimensional O–H stretching mode along the hydrogen bond as a harmonic oscillator governing the dominant component of proton motion near the reactant minimum. Starting from the time-independent Schrödinger equation for a one-dimensional harmonic potential, with Hamiltonian $H = \\frac{p^{2}}{2\\mu} + \\frac{1}{2}\\mu \\omega^{2} x^{2}$, derive the expectation value of the kinetic energy in the ground vibrational state and express it in terms of $\\hbar$ and $\\omega$. Then, for a solvated O–H stretch characterized by a wavenumber $\\tilde{\\nu} = 3400\\,\\mathrm{cm}^{-1}$ at temperature $T = 300\\,\\mathrm{K}$, compute the dimensionless ratio\n$$R = \\frac{\\text{quantum ground-state kinetic energy of the O–H mode}}{\\text{classical equipartition kinetic energy for one quadratic degree of freedom}}.$$\nUse the relations between wavenumber and angular frequency appropriate for harmonic motion, and fundamental constants $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$, $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$. Report $R$ as a pure number (dimensionless) and round your answer to three significant figures.",
            "solution": "The problem asks for two tasks: first, to derive the expectation value of the kinetic energy for the ground state of a one-dimensional quantum harmonic oscillator (QHO), and second, to compute the ratio of this quantum kinetic energy to the classical thermal kinetic energy for a specific O–H stretching mode.\n\nFirst, we derive the quantum kinetic energy. The Hamiltonian for the one-dimensional harmonic oscillator is given as:\n$$\nH = \\frac{p^{2}}{2\\mu} + \\frac{1}{2}\\mu \\omega^{2} x^{2}\n$$\nThis can be written as the sum of a kinetic energy operator, $T = \\frac{p^{2}}{2\\mu}$, and a potential energy operator, $V = \\frac{1}{2}\\mu \\omega^{2} x^{2}$.\n\nThe energy eigenvalues for the QHO are given by $E_n = \\left(n + \\frac{1}{2}\\right)\\hbar\\omega$, where $n$ is the vibrational quantum number ($n = 0, 1, 2, \\dots$). For the ground vibrational state, $n=0$, and the total energy is:\n$$\nE_0 = \\frac{1}{2}\\hbar\\omega\n$$\nTo find the expectation value of the kinetic energy, $\\langle T \\rangle$, we can invoke the virial theorem. For a potential of the form $V(x) \\propto x^k$, the virial theorem states that $2\\langle T \\rangle = k \\langle V \\rangle$. The harmonic oscillator potential has $k=2$, so the theorem simplifies to $2\\langle T \\rangle = 2\\langle V \\rangle$, which means $\\langle T \\rangle = \\langle V \\rangle$.\n\nThe total energy of the system in any eigenstate $|n\\rangle$ is the sum of the expectation values of the kinetic and potential energies:\n$$\nE_n = \\langle H \\rangle_n = \\langle T \\rangle_n + \\langle V \\rangle_n\n$$\nUsing the result from the virial theorem, $\\langle V \\rangle_n = \\langle T \\rangle_n$, we can write:\n$$\nE_n = \\langle T \\rangle_n + \\langle T \\rangle_n = 2\\langle T \\rangle_n\n$$\nTherefore, the expectation value of the kinetic energy is half the total energy:\n$$\n\\langle T \\rangle_n = \\frac{1}{2} E_n\n$$\nFor the ground state ($n=0$), the quantum kinetic energy, which we denote $\\langle T \\rangle_{\\text{quantum}}$, is:\n$$\n\\langle T \\rangle_{\\text{quantum}} = \\langle T \\rangle_0 = \\frac{1}{2} E_0 = \\frac{1}{2} \\left(\\frac{1}{2}\\hbar\\omega\\right) = \\frac{1}{4}\\hbar\\omega\n$$\nThis expression is in terms of $\\hbar$ and $\\omega$, as required.\n\nNext, we determine the classical kinetic energy for one quadratic degree of freedom. According to the classical equipartition theorem, for a system in thermal equilibrium at temperature $T$, every quadratic degree of freedom in the Hamiltonian contributes an average energy of $\\frac{1}{2}k_B T$. The kinetic energy for one-dimensional motion, $\\frac{p^2}{2\\mu}$, is a single quadratic term in the momentum $p$. Therefore, the classical average kinetic energy, denoted $\\langle T \\rangle_{\\text{classical}}$, is:\n$$\n\\langle T \\rangle_{\\text{classical}} = \\frac{1}{2}k_B T\n$$\nNow, we can compute the dimensionless ratio $R$:\n$$\nR = \\frac{\\text{quantum ground-state kinetic energy}}{\\text{classical equipartition kinetic energy}} = \\frac{\\langle T \\rangle_{\\text{quantum}}}{\\langle T \\rangle_{\\text{classical}}} = \\frac{\\frac{1}{4}\\hbar\\omega}{\\frac{1}{2}k_B T} = \\frac{\\hbar\\omega}{2k_B T}\n$$\nTo perform the numerical calculation, we must express $\\hbar\\omega$ in terms of the given wavenumber $\\tilde{\\nu}$. The angular frequency $\\omega$ is related to the frequency $f$ by $\\omega = 2\\pi f$. The frequency is related to the wavenumber $\\tilde{\\nu}$ and the speed of light $c$ by $f = c\\tilde{\\nu}$. Thus, $\\omega = 2\\pi c \\tilde{\\nu}$. The reduced Planck constant is $\\hbar = \\frac{h}{2\\pi}$. Substituting these into the expression for $R$:\n$$\nR = \\frac{\\left(\\frac{h}{2\\pi}\\right)(2\\pi c \\tilde{\\nu})}{2k_B T} = \\frac{h c \\tilde{\\nu}}{2k_B T}\n$$\nWe can now substitute the given numerical values:\n$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n$c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$\n$\\tilde{\\nu} = 3400\\,\\mathrm{cm}^{-1}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n$T = 300\\,\\mathrm{K}$\n\nPlugging these values into the expression for $R$:\n$$\nR = \\frac{(6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}) (2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}) (3400\\,\\mathrm{cm}^{-1})}{2 (1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) (300\\,\\mathrm{K})}\n$$\nThe units of $\\mathrm{cm^{-1}}$ and $\\mathrm{cm}$ in the numerator cancel, leaving units of $\\mathrm{J\\cdot s \\cdot s^{-1} = J}$. The units in the denominator are $\\mathrm{J\\cdot K^{-1} \\cdot K = J}$. The ratio is dimensionless, as expected.\n\nCalculating the numerator:\n$h c \\tilde{\\nu} = (6.62607015 \\times 10^{-34}) \\times (2.99792458 \\times 10^{10}) \\times 3400 \\approx 6.754059 \\times 10^{-20}\\,\\mathrm{J}$\n\nCalculating the denominator:\n$2 k_B T = 2 \\times (1.380649 \\times 10^{-23}) \\times 300 \\approx 8.283894 \\times 10^{-21}\\,\\mathrm{J}$\n\nComputing the ratio:\n$$\nR = \\frac{6.754059 \\times 10^{-20}}{8.283894 \\times 10^{-21}} \\approx 8.153406\n$$\nRounding the result to three significant figures gives $8.15$. The substantial deviation of this ratio from $1$ underscores the importance of including nuclear quantum effects for high-frequency modes like the O–H stretch, even at room temperature.",
            "answer": "$$\n\\boxed{8.15}\n$$"
        },
        {
            "introduction": "Once AIMD simulations have been used to map the free energy landscape of a reaction, the resulting barrier height provides a crucial piece of the kinetic puzzle. However, the free energy barrier, $F^\\ddagger$, alone tells an incomplete story. A deeper chemical understanding requires decomposing this barrier into its constituent enthalpic ($\\Delta H^\\ddagger$) and entropic ($\\Delta S^\\ddagger$) contributions. This exercise demonstrates how to perform this decomposition using the fundamental thermodynamic relationship $F^\\ddagger(T) = \\Delta H^\\ddagger - T\\Delta S^\\ddagger$. By applying weighted least-squares fitting to hypothetical simulation data, you will learn a standard analysis technique to determine whether a reaction barrier is dominated by energetic costs ($\\Delta H^\\ddagger$) or by a loss of molecular disorder ($\\Delta S^\\ddagger$) at the transition state .",
            "id": "4236263",
            "problem": "You are studying Proton-Coupled Electron Transfer (PCET) barriers using Ab Initio Molecular Dynamics (AIMD) simulations. In this setting, the barrier free energy is defined via classical statistical mechanics by the canonical partition function $Z$ and the Gibbs free energy $G$, where $G = H - T S$ and $F^\\ddagger(T)$ is the free energy barrier computed as the Gibbs free energy difference between the transition state ensemble and the reactant basin. Under a scientifically reasonable and widely used approximation for a narrow temperature window (namely, that the change in heat capacity across the barrier is negligible, so that the barrier’s enthalpy and entropy are temperature-independent over that window), the temperature dependence of the barrier free energy can be treated as linear in $T$, with an intercept equal to the enthalpic contribution and a slope related to the entropic contribution.\n\nFrom first principles, assume:\n- Canonical ensemble thermodynamics with the partition function $Z$ and $G = -k_\\mathrm{B} T \\ln Z$ for each constrained ensemble along the reaction coordinate, where $k_\\mathrm{B}$ is the Boltzmann constant.\n- The barrier free energy $F^\\ddagger(T)$ is a temperature-dependent observable computed independently at each temperature from the Potential of Mean Force (PMF).\n- Over the specified temperature ranges, the barrier’s enthalpy and entropy contributions are effectively constant, leading to a linear relation in $T$ whose intercept equals the enthalpic contribution $\\Delta H^\\ddagger$ (in $\\mathrm{kJ/mol}$) and whose slope (in $\\mathrm{kJ/mol/K}$) is the negative of the entropic contribution per kelvin, which should be reported in $\\mathrm{J/mol/K}$ by appropriate unit conversion.\n\nYour task is to:\n- For each provided dataset, perform a weighted least-squares linear fit of barrier free energy versus temperature, using weights $w_i = 1/\\sigma_i^2$, where $\\sigma_i$ is the standard deviation of the barrier estimate at temperature $T_i$ (both $F^\\ddagger$ and $\\sigma$ in $\\mathrm{kJ/mol}$, $T$ in $\\mathrm{K}$).\n- Extract the enthalpic contribution $\\Delta H^\\ddagger$ (the intercept, in $\\mathrm{kJ/mol}$) and the entropic contribution $\\Delta S^\\ddagger$ (equal to the negative of the slope, converted to $\\mathrm{J/mol/K}$).\n- Compute the barrier free energy at the reference temperature $T_\\mathrm{ref} = 298\\ \\mathrm{K}$ as $F^\\ddagger(298\\ \\mathrm{K})$ in $\\mathrm{kJ/mol}$ by evaluating the fitted linear relation at $T = 298\\ \\mathrm{K}$.\n\nExpress $\\Delta H^\\ddagger$ in $\\mathrm{kJ/mol}$, $\\Delta S^\\ddagger$ in $\\mathrm{J/mol/K}$, and $F^\\ddagger(298\\ \\mathrm{K})$ in $\\mathrm{kJ/mol}$. Round $\\Delta H^\\ddagger$ and $F^\\ddagger(298\\ \\mathrm{K})$ to $3$ decimal places, and round $\\Delta S^\\ddagger$ to $1$ decimal place.\n\nUse the following test suite of datasets, each consisting of temperatures $T_i$ (in $\\mathrm{K}$), barrier free energies $F^\\ddagger(T_i)$ (in $\\mathrm{kJ/mol}$), and uncertainties $\\sigma_i$ (in $\\mathrm{kJ/mol}$):\n\n- Dataset $1$ (balanced PCET, moderate positive entropy):\n  - $T$: $[280, 300, 320, 340]$\n  - $F^\\ddagger$: $[39.4, 39.0, 38.6, 38.2]$\n  - $\\sigma$: $[0.2, 0.15, 0.2, 0.25]$\n\n- Dataset $2$ (entropically unfavorable, negative entropy):\n  - $T$: $[250, 300, 350]$\n  - $F^\\ddagger$: $[40.0, 42.0, 44.0]$\n  - $\\sigma$: $[0.1, 0.1, 0.1]$\n\n- Dataset $3$ (small temperature window, weak positive entropy):\n  - $T$: $[295, 300, 305]$\n  - $F^\\ddagger$: $[53.525, 53.5, 53.475]$\n  - $\\sigma$: $[0.05, 0.2, 0.05]$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order for each dataset: $\\Delta H^\\ddagger$ (in $\\mathrm{kJ/mol}$, $3$ decimals), $\\Delta S^\\ddagger$ (in $\\mathrm{J/mol/K}$, $1$ decimal), and $F^\\ddagger_1(298\\ \\mathrm{K})$ (in $\\mathrm{kJ/mol}$, $3$ decimals). Thus, for three datasets, the output must be of the form:\n$[\\Delta H^\\ddagger_1,\\Delta S^\\ddagger_1,F^\\ddagger_1(298\\ \\mathrm{K}),\\Delta H^\\ddagger_2,\\Delta S^\\ddagger_2,F^\\ddagger_2(298\\ \\mathrm{K}),\\Delta H^\\ddagger_3,\\Delta S^\\ddagger_3,F^\\ddagger_3(298\\ \\mathrm{K})]$.",
            "solution": "The problem requires the determination of the enthalpic ($\\Delta H^\\ddagger$), entropic ($\\Delta S^\\ddagger$), and free energy barrier at a reference temperature ($F^\\ddagger(298\\ \\mathrm{K})$) for a proton-coupled electron transfer (PCET) process, based on simulated data. The data consists of barrier free energies, $F^\\ddagger(T_i)$, and their standard deviations, $\\sigma_i$, at several temperatures, $T_i$.\n\nThe core physical assumption is that over the narrow temperature range of the simulations, the change in heat capacity upon reaching the transition state is negligible. This implies that the enthalpic contribution, $\\Delta H^\\ddagger$, and entropic contribution, $\\Delta S^\\ddagger$, to the free energy barrier are effectively constant. The Gibbs free energy barrier, $F^\\ddagger(T)$, is thus a linear function of temperature, $T$:\n$$ F^\\ddagger(T) = \\Delta H^\\ddagger - T \\Delta S^\\ddagger $$\nThis equation is in the form of a linear model, $y = c + mx$, where:\n- The dependent variable is the free energy barrier, $y = F^\\ddagger(T)$.\n- The independent variable is the temperature, $x = T$.\n- The intercept is the enthalpic contribution, $c = \\Delta H^\\ddagger$.\n- The slope is the negative of the entropic contribution, $m = -\\Delta S^\\ddagger$.\n\nTo determine the best-fit values for the parameters $\\Delta H^\\ddagger$ and $\\Delta S^\\ddagger$ from the provided data points $(T_i, F^\\ddagger(T_i))$ with associated uncertainties $\\sigma_i$, we employ the method of weighted least-squares (WLS) linear regression. This method minimizes the weighted sum of the squares of the residuals, $\\chi^2$, where each point's contribution to the sum is inversely proportional to the variance of its measurement, $\\sigma_i^2$. The weights, $w_i$, are therefore defined as $w_i = 1/\\sigma_i^2$.\n\nThe quantity to be minimized is:\n$$ \\chi^2(c, m) = \\sum_{i=1}^{N} w_i (y_i - (c + m x_i))^2 $$\nTo find the values of $c$ and $m$ that minimize $\\chi^2$, we take the partial derivatives of $\\chi^2$ with respect to $c$ and $m$ and set them to zero. This yields the following system of linear equations, known as the normal equations:\n$$ \\frac{\\partial \\chi^2}{\\partial c} = -2 \\sum_{i=1}^{N} w_i (y_i - c - m x_i) = 0 \\implies c \\left(\\sum w_i\\right) + m \\left(\\sum w_i x_i\\right) = \\sum w_i y_i $$\n$$ \\frac{\\partial \\chi^2}{\\partial m} = -2 \\sum_{i=1}^{N} w_i x_i (y_i - c - m x_i) = 0 \\implies c \\left(\\sum w_i x_i\\right) + m \\left(\\sum w_i x_i^2\\right) = \\sum w_i x_i y_i $$\n\nFor notational convenience, let's define the following sums:\n$S_w = \\sum w_i$, $S_{wx} = \\sum w_i x_i$, $S_{wy} = \\sum w_i y_i$, $S_{wxx} = \\sum w_i x_i^2$, and $S_{wxy} = \\sum w_i x_i y_i$.\n\nThe solution to this $2 \\times 2$ linear system gives the explicit formulas for the slope $m$ and intercept $c$:\n$$ m = \\frac{S_w S_{wxy} - S_{wx} S_{wy}}{S_w S_{wxx} - (S_{wx})^2} $$\n$$ c = \\frac{S_{wxx} S_{wy} - S_{wx} S_{wxy}}{S_w S_{wxx} - (S_{wx})^2} $$\n\nOnce $c$ and $m$ are determined from the fit, the physical quantities are extracted as follows:\n- Enthalpic contribution: $\\Delta H^\\ddagger = c$ (in units of $\\mathrm{kJ/mol}$).\n- Entropic contribution: $\\Delta S^\\ddagger = -m$. The slope $m$ has units of $\\mathrm{kJ/mol/K}$, so we must convert to the required units of $\\mathrm{J/mol/K}$ by multiplying by $1000$: $\\Delta S^\\ddagger (\\mathrm{J/mol/K}) = -m \\times 1000$.\n- Barrier at reference temperature: $F^\\ddagger(298\\ \\mathrm{K}) = c + m \\times 298$ (in units of $\\mathrm{kJ/mol}$).\n\nA specific feature of the provided test datasets is that the data points $(T_i, F^\\ddagger(T_i))$ for each set are perfectly collinear. In such an ideal case, the WLS fit will precisely recover the parameters of the line on which the points lie, regardless of the weights, and the minimized $\\chi^2$ value will be zero. While numerical calculations with standard floating-point arithmetic may introduce negligible precision errors, the analytical solution is exact. We will thus proceed by implementing the general WLS procedure, which correctly handles this special case.\n\n**Dataset 1:**\n- $T$: $[280, 300, 320, 340]\\ \\mathrm{K}$\n- $F^\\ddagger$: $[39.4, 39.0, 38.6, 38.2]\\ \\mathrm{kJ/mol}$\n- $\\sigma$: $[0.2, 0.15, 0.2, 0.25]\\ \\mathrm{kJ/mol}$\nThe data points lie on a line. The slope is $m = (39.0 - 39.4) / (300 - 280) = -0.4 / 20 = -0.02\\ \\mathrm{kJ/mol/K}$.\nThe intercept is $c = F^\\ddagger(T) - m T = 39.4 - (-0.02 \\times 280) = 39.4 + 5.6 = 45.0\\ \\mathrm{kJ/mol}$.\nPerforming the WLS fit yields $m = -0.02\\ \\mathrm{kJ/mol/K}$ and $c = 45.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta H^\\ddagger = c = 45.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta S^\\ddagger = -m \\times 1000 = -(-0.02) \\times 1000 = 20.0\\ \\mathrm{J/mol/K}$.\n- $F^\\ddagger(298\\ \\mathrm{K}) = 45.0 + (-0.02) \\times 298 = 45.0 - 5.96 = 39.04\\ \\mathrm{kJ/mol}$.\n\n**Dataset 2:**\n- $T$: $[250, 300, 350]\\ \\mathrm{K}$\n- $F^\\ddagger$: $[40.0, 42.0, 44.0]\\ \\mathrm{kJ/mol}$\n- $\\sigma$: $[0.1, 0.1, 0.1]\\ \\mathrm{kJ/mol}$\nThe data points are collinear, and the weights are uniform. The slope is $m = (42.0 - 40.0) / (300 - 250) = 2.0 / 50 = 0.04\\ \\mathrm{kJ/mol/K}$.\nThe intercept is $c = F^\\ddagger(T) - m T = 40.0 - (0.04 \\times 250) = 40.0 - 10.0 = 30.0\\ \\mathrm{kJ/mol}$.\nThe WLS fit yields $m = 0.04\\ \\mathrm{kJ/mol/K}$ and $c = 30.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta H^\\ddagger = c = 30.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta S^\\ddagger = -m \\times 1000 = -0.04 \\times 1000 = -40.0\\ \\mathrm{J/mol/K}$.\n- $F^\\ddagger(298\\ \\mathrm{K}) = 30.0 + 0.04 \\times 298 = 30.0 + 11.92 = 41.92\\ \\mathrm{kJ/mol}$.\n\n**Dataset 3:**\n- $T$: $[295, 300, 305]\\ \\mathrm{K}$\n- $F^\\ddagger$: $[53.525, 53.5, 53.475]\\ \\mathrm{kJ/mol}$\n- $\\sigma$: $[0.05, 0.2, 0.05]\\ \\mathrm{kJ/mol}$\nThe data points are again perfectly collinear. The slope is $m = (53.5 - 53.525) / (300 - 295) = -0.025 / 5 = -0.005\\ \\mathrm{kJ/mol/K}$.\nThe intercept is $c = F^\\ddagger(T) - m T = 53.525 - (-0.005 \\times 295) = 53.525 + 1.475 = 55.0\\ \\mathrm{kJ/mol}$.\nThe WLS fit yields $m = -0.005\\ \\mathrm{kJ/mol/K}$ and $c = 55.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta H^\\ddagger = c = 55.0\\ \\mathrm{kJ/mol}$.\n- $\\Delta S^\\ddagger = -m \\times 1000 = -(-0.005) \\times 1000 = 5.0\\ \\mathrm{J/mol/K}$.\n- $F^\\ddagger(298\\ \\mathrm{K}) = 55.0 + (-0.005) \\times 298 = 55.0 - 1.49 = 53.51\\ \\mathrm{kJ/mol}$.\n\nThe final values, rounded as specified ($3$ decimal places for energies, $1$ for entropy), are:\n- Dataset 1: $\\Delta H^\\ddagger = 45.000\\ \\mathrm{kJ/mol}$, $\\Delta S^\\ddagger = 20.0\\ \\mathrm{J/mol/K}$, $F^\\ddagger(298\\ \\mathrm{K}) = 39.040\\ \\mathrm{kJ/mol}$.\n- Dataset 2: $\\Delta H^\\ddagger = 30.000\\ \\mathrm{kJ/mol}$, $\\Delta S^\\ddagger = -40.0\\ \\mathrm{J/mol/K}$, $F^\\ddagger(298\\ \\mathrm{K}) = 41.920\\ \\mathrm{kJ/mol}$.\n- Dataset 3: $\\Delta H^\\ddagger = 55.000\\ \\mathrm{kJ/mol}$, $\\Delta S^\\ddagger = 5.0\\ \\mathrm{J/mol/K}$, $F^\\ddagger(298\\ \\mathrm{K}) = 53.510\\ \\mathrm{kJ/mol}$.\nThe program below will implement this procedure to generate the required output string.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs weighted least-squares analysis on PCET simulation data\n    to extract thermodynamic parameters.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"T\": [280, 300, 320, 340],\n            \"F_barrier\": [39.4, 39.0, 38.6, 38.2],\n            \"sigma\": [0.2, 0.15, 0.2, 0.25]\n        },\n        {\n            \"T\": [250, 300, 350],\n            \"F_barrier\": [40.0, 42.0, 44.0],\n            \"sigma\": [0.1, 0.1, 0.1]\n        },\n        {\n            \"T\": [295, 300, 305],\n            \"F_barrier\": [53.525, 53.5, 53.475],\n            \"sigma\": [0.05, 0.2, 0.05]\n        }\n    ]\n\n    T_ref = 298.0  # Reference temperature in K\n    results = []\n\n    for case in test_cases:\n        T = np.array(case[\"T\"])\n        F_barrier = np.array(case[\"F_barrier\"])\n        sigma = np.array(case[\"sigma\"])\n\n        # The model is F_barrier = delta_H - T * delta_S\n        # This is a linear model y = c + m*x, where:\n        # y = F_barrier\n        # x = T\n        # c = delta_H (intercept)\n        # m = -delta_S (slope)\n\n        # Weights for the WLS fit are w = 1/sigma^2\n        weights = 1.0 / sigma**2\n\n        # Perform weighted least-squares linear regression to find slope (m) and intercept (c).\n        # numpy.polyfit returns coefficients of a polynomial, highest power first.\n        # For a degree 1 polynomial (line), this is [slope, intercept].\n        m, c = np.polyfit(T, F_barrier, 1, w=weights)\n\n        # Extract thermodynamic quantities\n        # delta_H is the intercept, in kJ/mol\n        delta_H = c\n        # delta_S is the negative of the slope, converted from kJ/mol/K to J/mol/K\n        delta_S = -m * 1000.0\n\n        # Calculate the free energy barrier at the reference temperature\n        F_barrier_ref = c + m * T_ref\n\n        # Format results according to the problem specification\n        # delta_H and F_barrier_ref to 3 decimal places\n        # delta_S to 1 decimal place\n        formatted_delta_H = f\"{delta_H:.3f}\"\n        formatted_delta_S = f\"{delta_S:.1f}\"\n        formatted_F_ref = f\"{F_barrier_ref:.3f}\"\n\n        results.extend([formatted_delta_H, formatted_delta_S, formatted_F_ref])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A primary goal of computational electrochemistry is to predict experimentally measurable quantities, such as redox potentials, with high accuracy. This advanced task requires constructing a complete thermodynamic cycle that connects the simulated system to a standard experimental reference. This final practice guides you through the assembly of such a calculation, starting from the output of a hypothetical thermodynamic integration (TI) and systematically incorporating essential theoretical corrections. These adjustments account for the change in standard states, artifacts from finite simulation size, and quantum zero-point energy effects. By assembling these diverse energetic contributions, you will master the workflow for transforming a raw free energy difference from a simulation into an absolute redox potential relative to the Standard Hydrogen Electrode (SHE) .",
            "id": "4236306",
            "problem": "You are asked to implement a program that computes the Helmholtz free energy change for a solvated electron–proton pair relative to molecular hydrogen using a model of Ab Initio Molecular Dynamics (AIMD) thermodynamic integration, and then converts this free energy into a redox potential versus the Standard Hydrogen Electrode (SHE). The underlying physical process is Proton-Coupled Electron Transfer (PCET), but the computation must be framed purely in mathematical terms consistent with statistical mechanics and electrochemistry.\n\nThe fundamental base you must use is:\n- Canonical-ensemble statistical mechanics with Helmholtz free energy defined by $A = -k_{\\mathrm{B}} T \\ln Z$, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $Z$ is the canonical partition function.\n- Thermodynamic integration (TI) for a coupling parameter $\\lambda$, which gives the free energy difference between two states as\n$$\n\\Delta A = \\int_{0}^{1} \\left\\langle \\frac{\\partial U(\\mathbf{R};\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda,\n$$\nwhere $U(\\mathbf{R};\\lambda)$ is the potential energy function of atomic coordinates $\\mathbf{R}$ parameterized by $\\lambda$, and $\\langle \\cdot \\rangle_{\\lambda}$ denotes an ensemble average at fixed $\\lambda$.\n- The electrochemical work relation connecting Gibbs free energy and electrode potential,\n$$\n\\Delta G = - n F E,\n$$\nwhere $\\Delta G$ is the Gibbs free energy change per mole, $n$ is the number of electrons transferred, $F$ is the Faraday constant, and $E$ is the electrode potential in volts. For isothermal, isochoric AIMD at fixed volume, you may equate $\\Delta A$ and $\\Delta G$ for the purpose of this calculation, up to explicit corrections specified below.\n- Standard-state conversion for a gaseous reference species from a gas-phase standard state at $p^\\circ = 1\\,\\mathrm{bar}$ to a solution-phase standard state at $c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$, which introduces a correction\n$$\n\\Delta G_{\\mathrm{ss}} = \\nu \\, R T \\ln\\left( \\frac{c^\\circ R_{\\mathrm{bar}} T}{p^\\circ} \\right),\n$$\nwhere $R$ is the gas constant expressed in $\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$, $R_{\\mathrm{bar}}$ is the gas constant expressed in $\\mathrm{L\\,bar\\,mol^{-1}\\,K^{-1}}$, $T$ is the absolute temperature, $p^\\circ$ is the standard pressure, $c^\\circ$ is the standard concentration, and $\\nu$ is the stoichiometric factor for the gaseous reference species in the reaction mapping to the solution standard state (for $1/2\\,\\mathrm{H_2}$, $\\nu = 0.5$).\n\nYour program must implement the following mathematical model for the thermodynamic integration integrand, representing the ensemble average derivative:\n$$\ng(\\lambda) = a \\lambda^2 + b \\lambda + c + d \\sin(\\pi \\lambda),\n$$\nwith $\\lambda \\in [0,1]$ and all parameters $a$, $b$, $c$, and $d$ expressed in $\\mathrm{kJ\\,mol^{-1}}$. The angle in the sine function must be interpreted in radians.\n\nFor each test case, compute:\n1. The thermodynamic integration contribution,\n$$\n\\Delta A_{\\mathrm{TI}} = \\int_{0}^{1} g(\\lambda) \\, d\\lambda,\n$$\nin $\\mathrm{kJ\\,mol^{-1}}$.\n2. The standard-state correction $\\Delta G_{\\mathrm{ss}}$ in $\\mathrm{kJ\\,mol^{-1}}$ using the formula above, with $p^\\circ = 1\\,\\mathrm{bar}$ and $c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$.\n3. Add the following explicit corrections (each provided per test case, in $\\mathrm{kJ\\,mol^{-1}}$):\n   - A finite-size correction $\\Delta G_{\\mathrm{fs}}$,\n   - A zero-point energy correction $\\Delta G_{\\mathrm{zpe}}$,\n   - A finite-temperature enthalpy correction $\\Delta H_{\\mathrm{th}}$.\n4. Form the total free energy change in $\\mathrm{kJ\\,mol^{-1}}$,\n$$\n\\Delta G_{\\mathrm{tot}} = \\Delta A_{\\mathrm{TI}} + \\Delta G_{\\mathrm{ss}} + \\Delta G_{\\mathrm{fs}} + \\Delta G_{\\mathrm{zpe}} + \\Delta H_{\\mathrm{th}}.\n$$\n5. Convert $\\Delta G_{\\mathrm{tot}}$ to $\\mathrm{J\\,mol^{-1}}$ and then compute the electrode potential versus the Standard Hydrogen Electrode (SHE),\n$$\nE = -\\frac{\\Delta G_{\\mathrm{tot}}\\, (\\mathrm{J\\,mol^{-1}})}{n F},\n$$\nwith $n = 1$ and $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$. Report $E$ in volts.\n\nPhysical unit requirements:\n- Report $\\Delta G_{\\mathrm{tot}}$ in $\\mathrm{J\\,mol^{-1}}$.\n- Report $E$ in volts (V).\n- Angles are in radians.\n- Use $R = 0.008314462618\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$ and $R_{\\mathrm{bar}} = 0.08314\\,\\mathrm{L\\,bar\\,mol^{-1}\\,K^{-1}}$ consistently.\n- Use $p^\\circ = 1\\,\\mathrm{bar}$ and $c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$.\n\nTest suite:\nFor each tuple $(a,b,c,d,T,\\nu,\\Delta G_{\\mathrm{fs}},\\Delta G_{\\mathrm{zpe}},\\Delta H_{\\mathrm{th}})$, compute and report the pair $[\\Delta G_{\\mathrm{tot}}\\,(\\mathrm{J\\,mol^{-1}}), E\\,(\\mathrm{V})]$.\n\n- Case 1 (general happy path): $(10.0,-5.0,2.0,3.0,298.15,0.5,0.5,0.2,-0.1)$\n- Case 2 (strongly negative integrand, small positive corrections): $(-20.0,0.0,-1.0,-4.0,298.15,0.5,0.2,0.0,0.1)$\n- Case 3 (zero integrand, standard-state correction only): $(0.0,0.0,0.0,0.0,298.15,0.5,0.0,0.0,0.0)$\n- Case 4 (large positive integrand, mixed-sign corrections, different temperature): $(30.0,10.0,1.5,0.0,310.0,0.5,-1.2,0.5,-0.8)$\n\nAlgorithmic requirements:\n- Perform the integral for $\\Delta A_{\\mathrm{TI}}$ numerically using a high-accuracy quadrature rule over $\\lambda \\in [0,1]$.\n- Use consistent units at every step and ensure the final electrode potential obeys the sign convention given.\n- Do not use any external inputs; all values are specified in the test suite.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element in the list corresponds to a test case and must itself be a list with two floats in the order $[\\Delta G_{\\mathrm{tot}}\\,(\\mathrm{J\\,mol^{-1}}), E\\,(\\mathrm{V})]$. For example, the output should look like:\n\"[[G1,E1],[G2,E2],[G3,E3],[G4,E4]]\"",
            "solution": "The objective is to compute the total Gibbs free energy change, $\\Delta G_{\\mathrm{tot}}$, for a solvated electron-proton pair relative to a molecular hydrogen reference, and subsequently determine the corresponding electrode potential, $E$, versus the Standard Hydrogen Electrode (SHE). The calculation proceeds in five distinct steps, as outlined in the problem.\n\nStep 1: Thermodynamic Integration Contribution ($\\Delta A_{\\mathrm{TI}}$)\n\nThe first component is the free energy change obtained from thermodynamic integration, $\\Delta A_{\\mathrm{TI}}$. This quantity is calculated by integrating the ensemble-averaged derivative of the potential energy with respect to a coupling parameter, $\\lambda$, over the interval $\\lambda \\in [0, 1]$. The problem provides a model for this integrand:\n$$\ng(\\lambda) = \\left\\langle \\frac{\\partial U(\\mathbf{R};\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} = a \\lambda^2 + b \\lambda + c + d \\sin(\\pi \\lambda)\n$$\nwhere the parameters $a$, $b$, $c$, and $d$ are given in units of $\\mathrm{kJ\\,mol^{-1}}$. The thermodynamic integration contribution is thus the definite integral:\n$$\n\\Delta A_{\\mathrm{TI}} = \\int_{0}^{1} g(\\lambda) \\, d\\lambda = \\int_{0}^{1} \\left( a \\lambda^2 + b \\lambda + c + d \\sin(\\pi \\lambda) \\right) d\\lambda\n$$\nWhile the problem specifies the use of numerical quadrature, this integral can be solved analytically to verify the methodology. The indefinite integral is:\n$$\n\\int g(\\lambda) \\, d\\lambda = \\frac{a}{3}\\lambda^3 + \\frac{b}{2}\\lambda^2 + c\\lambda - \\frac{d}{\\pi}\\cos(\\pi\\lambda) + C\n$$\nEvaluating the definite integral from $\\lambda=0$ to $\\lambda=1$:\n$$\n\\Delta A_{\\mathrm{TI}} = \\left[ \\frac{a}{3}\\lambda^3 + \\frac{b}{2}\\lambda^2 + c\\lambda - \\frac{d}{\\pi}\\cos(\\pi\\lambda) \\right]_{0}^{1}\n$$\n$$\n\\Delta A_{\\mathrm{TI}} = \\left( \\frac{a}{3} + \\frac{b}{2} + c - \\frac{d}{\\pi}\\cos(\\pi) \\right) - \\left( 0 + 0 + 0 - \\frac{d}{\\pi}\\cos(0) \\right)\n$$\n$$\n\\Delta A_{\\mathrm{TI}} = \\left( \\frac{a}{3} + \\frac{b}{2} + c + \\frac{d}{\\pi} \\right) - \\left( -\\frac{d}{\\pi} \\right) = \\frac{a}{3} + \\frac{b}{2} + c + \\frac{2d}{\\pi}\n$$\nFor the implementation, a high-accuracy numerical quadrature routine will be employed as required. The result is in $\\mathrm{kJ\\,mol^{-1}}$.\n\nStep 2: Standard-State Correction ($\\Delta G_{\\mathrm{ss}}$)\n\nThe second component, $\\Delta G_{\\mathrm{ss}}$, corrects for the change in standard state from a gas phase species (molecular hydrogen, $\\mathrm{H_2}$) at standard pressure ($p^\\circ = 1\\,\\mathrm{bar}$) to a solvated species at standard concentration ($c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$). The formula is given as:\n$$\n\\Delta G_{\\mathrm{ss}} = \\nu \\, R T \\ln\\left( \\frac{c^\\circ R_{\\mathrm{bar}} T}{p^\\circ} \\right)\n$$\nHere, $\\nu$ is the stoichiometric factor for the gaseous reference (for $\\frac{1}{2}\\,\\mathrm{H_2}$, $\\nu=0.5$), $T$ is the absolute temperature in Kelvin, $R$ is the gas constant in $\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$ ($0.008314462618$), and $R_{\\mathrm{bar}}$ is the gas constant in $\\mathrm{L\\,bar\\,mol^{-1}\\,K^{-1}}$ ($0.08314$). The units must be handled consistently; the argument of the logarithm is dimensionless as required. This term is also calculated in $\\mathrm{kJ\\,mol^{-1}}$.\n\nStep 3: Summation of Explicit Corrections\n\nThe problem provides three additional energy terms for each case, all in units of $\\mathrm{kJ\\,mol^{-1}}$:\n- $\\Delta G_{\\mathrm{fs}}$: A finite-size correction, accounting for artifacts from periodic boundary conditions in the simulation cell.\n- $\\Delta G_{\\mathrm{zpe}}$: A zero-point energy correction, accounting for quantum nuclear effects not captured by classical AIMD trajectories.\n- $\\Delta H_{\\mathrm{th}}$: A finite-temperature enthalpy correction, related to changes in thermal energy between the states.\n\nStep 4: Total Free Energy Change ($\\Delta G_{\\mathrm{tot}}$)\n\nThe total Gibbs free energy change is the sum of all five components. The initial free energy from TI, $\\Delta A_{\\mathrm{TI}}$, computed for an isothermal, isochoric (NVT) ensemble, is taken as the base, to which all other corrections are added.\n$$\n\\Delta G_{\\mathrm{tot}} = \\Delta A_{\\mathrm{TI}} + \\Delta G_{\\mathrm{ss}} + \\Delta G_{\\mathrm{fs}} + \\Delta G_{\\mathrm{zpe}} + \\Delta H_{\\mathrm{th}}\n$$\nSince all components are calculated in $\\mathrm{kJ\\,mol^{-1}}$, this is a direct summation. The resulting $\\Delta G_{\\mathrm{tot}}$ is in $\\mathrm{kJ\\,mol^{-1}}$. For the final computation, this value must be converted to $\\mathrm{J\\,mol^{-1}}$ by multiplying by $1000$.\n\nStep 5: Electrode Potential Calculation ($E$)\n\nFinally, the total free energy change per mole is related to the electrode potential, $E$, through the fundamental electrochemical equation:\n$$\n\\Delta G = -nFE\n$$\nwhere $n$ is the number of electrons transferred in the redox half-reaction (given as $n=1$), and $F$ is the Faraday constant ($96485.33212\\,\\mathrm{C\\,mol^{-1}}$). Rearranging for $E$ and ensuring $\\Delta G_{\\mathrm{tot}}$ is in units of $\\mathrm{J\\,mol^{-1}}$ gives:\n$$\nE = -\\frac{\\Delta G_{\\mathrm{tot}}\\, (\\mathrm{J\\,mol^{-1}})}{n F}\n$$\nThe resulting potential $E$ will be in Volts, as $1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$. The sign convention is explicitly defined by this formula. A positive $\\Delta G_{\\mathrm{tot}}$ corresponds to a non-spontaneous reaction under standard conditions and yields a negative potential, while a negative $\\Delta G_{\\mathrm{tot}}$ corresponds to a spontaneous reaction and a positive potential.\n\nThe algorithm will be applied to each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the Helmholtz free energy change for a solvated electron-proton pair\n    and converts it to a redox potential versus SHE based on a simplified AIMD\n    thermodynamic integration model.\n    \"\"\"\n    \n    # Define physical and chemical constants as specified in the problem.\n    F = 96485.33212  # Faraday constant in C/mol\n    R_KJ = 0.008314462618  # Gas constant in kJ/(mol*K)\n    R_BAR = 0.08314  # Gas constant in L*bar/(mol*K)\n    P_STD = 1.0  # Standard pressure in bar\n    C_STD = 1.0  # Standard concentration in mol/L\n    N_ELECTRONS = 1.0 # Number of electrons transferred\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (a, b, c, d, T, nu, dG_fs, dG_zpe, dH_th)\n    # where energy terms are in kJ/mol and T is in K.\n    test_cases = [\n        (10.0, -5.0, 2.0, 3.0, 298.15, 0.5, 0.5, 0.2, -0.1),\n        (-20.0, 0.0, -1.0, -4.0, 298.15, 0.5, 0.2, 0.0, 0.1),\n        (0.0, 0.0, 0.0, 0.0, 298.15, 0.5, 0.0, 0.0, 0.0),\n        (30.0, 10.0, 1.5, 0.0, 310.0, 0.5, -1.2, 0.5, -0.8),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a, b, c, d, T, nu, dG_fs, dG_zpe, dH_th = case\n        \n        # 1. Compute the thermodynamic integration contribution (delta_A_TI)\n        # Define the integrand g(lambda)\n        def g(lmd):\n            return a * lmd**2 + b * lmd + c + d * np.sin(np.pi * lmd)\n            \n        # Perform numerical integration over lambda from 0 to 1.\n        # quad returns (integral_value, error_estimate)\n        delta_A_TI, _ = integrate.quad(g, 0, 1)\n        \n        # 2. Compute the standard-state correction (delta_G_ss)\n        log_arg = (C_STD * R_BAR * T) / P_STD\n        delta_G_ss = nu * R_KJ * T * np.log(log_arg)\n        \n        # 3. Sum all energy contributions to get the total free energy change.\n        # The explicit corrections dG_fs, dG_zpe, dH_th are already given.\n        # The sum is in kJ/mol.\n        delta_G_tot_kj = delta_A_TI + delta_G_ss + dG_fs + dG_zpe + dH_th\n        \n        # 4. Convert delta_G_tot to J/mol for the potential calculation.\n        delta_G_tot_j = delta_G_tot_kj * 1000.0\n        \n        # 5. Compute the electrode potential E vs SHE in Volts.\n        E_potential = -delta_G_tot_j / (N_ELECTRONS * F)\n        \n        results.append([delta_G_tot_j, E_potential])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}