{
    "hands_on_practices": [
        {
            "introduction": "The Computational Hydrogen Electrode (CHE) model is a cornerstone of modern computational electrochemistry, providing a powerful framework for calculating the free energies of reaction steps involving protons and electrons. This first practice focuses on the most fundamental application of the CHE model: determining the Gibbs free energy change, $\\Delta G$, for the adsorption of a hydrogen atom onto a catalyst surface. Mastering this core calculation is essential, as it forms the basis for evaluating catalyst performance for reactions like the hydrogen evolution reaction (HER) .",
            "id": "4260050",
            "problem": "You are asked to implement a complete, runnable program that computes the Gibbs free energy change for the adsorption of hydrogen, denoted by $H^*$, on a metal surface within the Computational Hydrogen Electrode (CHE) model. The adsorption reaction is $H^+ + e^- + * \\rightarrow H^*$, where $*$ represents a vacant surface site. The goal is to evaluate the free energy change $\\Delta G$ for this adsorption process at $T=298$ K by combining Density Functional Theory (DFT) electronic energies with vibrational zero-point energy and entropy corrections, and by referencing the electrochemical proton-electron reservoir via the CHE framework.\n\nFundamental base:\n- The Gibbs free energy $G$ for a given state is given by $G = U + pV - T S$, where $U$ is the internal energy, $p$ the pressure, $V$ the volume, $T$ the temperature, and $S$ the entropy. In standard DFT-based solid-state calculations, $pV$ can be neglected for the solid phases, and $U$ is approximated by the computed electronic energy $E_{\\mathrm{DFT}}$ plus the vibrational zero-point energy. Therefore, for a state $X$, we write $G_X \\approx E_X + \\mathrm{ZPE}_X - T S_X$ with all quantities expressed consistently per particle.\n- The free energy change for the adsorption reaction is defined by the reaction stoichiometry: $\\Delta G = G_{H^*} - G_{*} - \\mu_{H^+} - \\mu_{e^-}$, where $\\mu_{H^+}$ and $\\mu_{e^-}$ are the chemical potentials of the proton and electron, respectively.\n- The Computational Hydrogen Electrode (CHE) model equates the combined chemical potential of the proton-electron pair to the chemical potential of molecular hydrogen subject to the electrode potential and solution acidity. Using the Nernst relation for the proton activity $a_{H^+}$ and the definition of electrode potential $U$ referenced to the Standard Hydrogen Electrode (SHE), the CHE relation is $\\mu_{H^+} + \\mu_{e^-} = \\tfrac{1}{2} \\mu_{H_2}(T,p_{H_2}) - e U - k_B T \\ln(10)\\,\\mathrm{pH}$, where $e$ is the elementary charge, $k_B$ is the Boltzmann constant, and $p_{H_2}=1$ bar under standard conditions. The molecular hydrogen chemical potential is $\\mu_{H_2} \\equiv G_{H_2} \\approx E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}$.\n\nProgram requirements:\n- For each test case, you are given the following parameters:\n    - $E_{\\mathrm{surf}}$ (in eV): the DFT electronic energy of the clean surface.\n    - $E_{\\mathrm{surf}+H}$ (in eV): the DFT electronic energy of the surface with adsorbed hydrogen.\n    - $E_{H_2}$ (in eV): the DFT electronic energy of the gas-phase hydrogen molecule.\n    - $\\mathrm{ZPE}_{H^*}$ (in eV): the vibrational zero-point energy of adsorbed hydrogen.\n    - $\\mathrm{ZPE}_{H_2}$ (in eV): the vibrational zero-point energy of molecular hydrogen.\n    - $S_{H^*}$ (in eV/K): the vibrational entropy contribution of the adsorbed hydrogen at temperature $T$.\n    - $S_{H_2}$ (in eV/K): the entropy of molecular hydrogen at temperature $T$ and $p_{H_2}=1$ bar.\n    - $T$ (in K): the temperature.\n    - $U$ (in V): the electrode potential referenced to the Standard Hydrogen Electrode (SHE).\n    - $\\mathrm{pH}$ (dimensionless): the solution acidity on the $\\mathrm{pH}$ scale.\n- All energies must be treated per elementary reaction event (per adsorbed hydrogen atom) and expressed in electronvolts (eV). Entropies are given in eV/K per molecule or adsorbate. The final free energy change $\\Delta G$ must be computed in eV.\n\nAlgorithmic tasks your program must perform for each test case:\n1. Compute the free energy difference between the adsorbed and clean surface, $G_{H^*} - G_{*}$, by combining the provided $E_{\\mathrm{surf}+H}$, $E_{\\mathrm{surf}}$, $\\mathrm{ZPE}_{H^*}$, and $S_{H^*}$ at the given $T$.\n2. Compute the combined chemical potential of the proton-electron pair via the CHE relation using the given $E_{H_2}$, $\\mathrm{ZPE}_{H_2}$, $S_{H_2}$, $T$, $U$, and $\\mathrm{pH}$.\n3. Combine the results to obtain $\\Delta G$ for the adsorption reaction as defined above.\n\nUnits and constants:\n- Express all energies in eV, entropies in eV/K, temperature in K, and potential in V.\n- Use $k_B = 8.617333262145 \\times 10^{-5}$ eV/K and $\\ln(10)$ for the acidity term. The electron charge $e$ is accounted for by the fact that $e U$ equals $U$ in eV when $U$ is in volts.\n\nTest suite:\nProvide results for the following four test cases. Each case is specified as the tuple\n$(E_{\\mathrm{surf}}, E_{\\mathrm{surf}+H}, E_{H_2}, \\mathrm{ZPE}_{H^*}, \\mathrm{ZPE}_{H_2}, S_{H^*}, S_{H_2}, T, U, \\mathrm{pH})$ with values:\n\n- Case 1 (baseline, neutral): $(-100.000,\\,-103.600,\\,-6.800,\\,0.160,\\,0.270,\\,0.00000,\\,0.001345,\\,298.0,\\,0.0,\\,0.0)$\n- Case 2 (positive potential): $(-100.000,\\,-103.600,\\,-6.800,\\,0.160,\\,0.270,\\,0.00000,\\,0.001345,\\,298.0,\\,0.20,\\,0.0)$\n- Case 3 (negative potential, nonzero adsorbate entropy): $(-250.000,\\,-253.450,\\,-6.800,\\,0.140,\\,0.270,\\,0.00010,\\,0.001345,\\,298.0,\\,-0.10,\\,0.0)$\n- Case 4 (strongly basic solution): $(-100.000,\\,-103.600,\\,-6.800,\\,0.160,\\,0.270,\\,0.00000,\\,0.001345,\\,298.0,\\,0.0,\\,14.0)$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each entry must be a float in eV corresponding to $\\Delta G$ for the respective test case, in the same order as listed above.",
            "solution": "The problem has been validated and is determined to be a well-posed, scientifically grounded problem in computational electrochemistry. The task is to compute the Gibbs free energy change, $\\Delta G$, for the hydrogen adsorption reaction $H^+ + e^- + * \\rightarrow H^*$ on a metal surface, using the computational hydrogen electrode (CHE) model.\n\nThe fundamental relationship for the Gibbs free energy change of this reaction is given by the difference in the free energies of the products and reactants:\n$$\n\\Delta G = G_{H^*} - G_{*} - (\\mu_{H^+} + \\mu_{e^-})\n$$\nwhere $G_{H^*}$ is the Gibbs free energy of the surface with an adsorbed hydrogen atom, $G_{*}$ is the free energy of the clean surface site, and $\\mu_{H^+}$ and $\\mu_{e^-}$ are the chemical potentials of the proton and the electron in the solution, respectively.\n\nThe calculation is systematically performed by adhering to the three algorithmic tasks specified.\n\n**1. Computation of the Surface Free Energy Difference ($G_{H^*} - G_{*}$)**\n\nFor condensed phases, the Gibbs free energy $G$ of a state $X$ is approximated by combining its DFT-calculated electronic energy $E_X$ with the vibrational zero-point energy $\\mathrm{ZPE}_X$ and the vibrational entropy term $T S_X$, neglecting the pressure-volume ($pV$) contribution.\n$$\nG_X \\approx E_X + \\mathrm{ZPE}_X - T S_X\n$$\nThe change in free energy upon adsorption of a hydrogen atom onto a surface site $*$ is the difference between the free energy of the surface with the adsorbate ($H^*$) and the free energy of the clean surface ($*$).\nThe state $H^*$ corresponds to the entire `surf+H` system, so its energy is $E_{\\mathrm{surf}+H}$, and it includes the vibrational contributions of the adsorbate, $\\mathrm{ZPE}_{H^*}$ and $S_{H^*}$. The state $*$ corresponds to the clean `surf` system, with energy $E_{\\mathrm{surf}}$. The vibrational contributions from the clean site itself are considered part of the constant background and are thus taken as zero for this differential calculation.\nTherefore, the free energy difference is:\n$$\nG_{H^*} - G_{*} \\approx (E_{\\mathrm{surf}+H} - E_{\\mathrm{surf}}) + \\mathrm{ZPE}_{H^*} - T S_{H^*}\n$$\nThis term represents the change in the surface's free energy due to the adsorption event.\n\n**2. Computation of the Proton-Electron Pair Chemical Potential ($\\mu_{H^+} + \\mu_{e^-}$)**\n\nThe CHE model provides a way to express the chemical potential of the solvated proton-electron pair, $\\mu_{H^+} + \\mu_{e^-}$, by relating it to the chemical potential of gas-phase molecular hydrogen, $\\mu_{H_2}$. This establishes an equilibrium with the hydrogen evolution reaction, $2H^+ + 2e^- \\leftrightarrow H_2$. The relation is dependent on the electrode potential $U$ and the solution's $\\mathrm{pH}$.\n\nThe CHE relation is:\n$$\n\\mu_{H^+} + \\mu_{e^-} = \\frac{1}{2} \\mu_{H_2}(T, p_{H_2}) - eU - k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\nHere, $e$ is the elementary charge, $k_B$ is the Boltzmann constant, and the chemical potential of molecular hydrogen is taken at a standard pressure $p_{H_2} = 1~\\text{bar}$. The term $eU$ represents the energy change of an electron moving through a potential $U$; when $U$ is in Volts (V), this energy is numerically equal to $U$ in electron-volts (eV). The term involving $\\mathrm{pH}$ accounts for the concentration of $H^+$ ions in the solution relative to standard conditions ($\\mathrm{pH}=0$).\n\nThe chemical potential of molecular hydrogen, $\\mu_{H_2}$, is calculated similarly to the solid-state free energies:\n$$\n\\mu_{H_2} \\equiv G_{H_2} \\approx E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}\n$$\nSubstituting this into the CHE relation yields the full expression for the reactant chemical potentials:\n$$\n\\mu_{H^+} + \\mu_{e^-} \\approx \\frac{1}{2} (E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}) - eU - k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\n\n**3. Final Combination for $\\Delta G$**\n\nBy substituting the expressions from steps 1 and 2 into the primary equation for $\\Delta G$, we obtain the complete formula for the Gibbs free energy change of hydrogen adsorption:\n$$\n\\Delta G \\approx \\left[ (E_{\\mathrm{surf}+H} - E_{\\mathrm{surf}}) + \\mathrm{ZPE}_{H^*} - T S_{H^*} \\right] - \\left[ \\frac{1}{2} (E_{H_2} + \\mathrm{ZPE}_{H_2} - T S_{H_2}) - eU - k_B T \\ln(10) \\cdot \\mathrm{pH} \\right]\n$$\nThis equation can be rearranged to group terms by their physical origin:\n$$\n\\Delta G \\approx \\underbrace{(E_{\\mathrm{surf}+H} - E_{\\mathrm{surf}} - \\frac{1}{2} E_{H_2})}_{\\Delta E} + \\underbrace{(\\mathrm{ZPE}_{H^*} - \\frac{1}{2} \\mathrm{ZPE}_{H_2})}_{\\Delta \\mathrm{ZPE}} - \\underbrace{T(S_{H^*} - \\frac{1}{2} S_{H_2})}_{-T\\Delta S} + eU + k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\nThe first term, $\\Delta E$, is the differential electronic adsorption energy. The aformentioned formula is implemented in the provided program to compute $\\Delta G$ for each test case using the given parameters and constants: $k_B = 8.617333262145 \\times 10^{-5}~\\text{eV/K}$ and the natural logarithm of $10$, $\\ln(10)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Gibbs free energy change for hydrogen adsorption using the CHE model.\n    \"\"\"\n    \n    # Define constants as specified in the problem statement.\n    # Boltzmann constant in eV/K.\n    k_B = 8.617333262145e-5\n    # Natural logarithm of 10 for the pH term.\n    ln_10 = np.log(10)\n\n    # Test cases as tuples:\n    # (E_surf, E_surf_H, E_H2, ZPE_H_star, ZPE_H2, S_H_star, S_H2, T, U, pH)\n    test_cases = [\n        # Case 1 (baseline, neutral)\n        (-100.000, -103.600, -6.800, 0.160, 0.270, 0.00000, 0.001345, 298.0, 0.0, 0.0),\n        # Case 2 (positive potential)\n        (-100.000, -103.600, -6.800, 0.160, 0.270, 0.00000, 0.001345, 298.0, 0.20, 0.0),\n        # Case 3 (negative potential, nonzero adsorbate entropy)\n        (-250.000, -253.450, -6.800, 0.140, 0.270, 0.00010, 0.001345, 298.0, -0.10, 0.0),\n        # Case 4 (strongly basic solution)\n        (-100.000, -103.600, -6.800, 0.160, 0.270, 0.00000, 0.001345, 298.0, 0.0, 14.0)\n    ]\n\n    results = []\n\n    def calculate_delta_g(params):\n        \"\"\"\n        Calculates delta G for a single test case.\n        \n        The formula for Delta G is:\n        Delta_G = (G_H* - G_*) - (mu_H+ + mu_e-)\n        \n        Where:\n        G_H* - G_* = (E_surf+H - E_surf) + ZPE_H* - T * S_H*\n        mu_H+ + mu_e- = 0.5 * G_H2 - eU - k_B*T*ln(10)*pH\n        G_H2 = E_H2 + ZPE_H2 - T * S_H2\n        \"\"\"\n        E_surf, E_surf_H, E_H2, ZPE_H_star, ZPE_H2, S_H_star, S_H2, T, U, pH = params\n        \n        # Algorithmic Task 1: Compute the free energy difference on the surface.\n        # G_H* - G_*\n        delta_g_surf = (E_surf_H - E_surf) + ZPE_H_star - T * S_H_star\n        \n        # Algorithmic Task 2: Compute the combined chemical potential of the proton-electron pair.\n        # First, compute the free energy of molecular hydrogen, G_H2.\n        g_h2 = E_H2 + ZPE_H2 - T * S_H2\n        \n        # Then, compute the chemical potential of the proton-electron pair.\n        # The term eU (energy) is numerically equal to U (potential in V) in units of eV.\n        mu_h_plus_e = 0.5 * g_h2 - U - k_B * T * ln_10 * pH\n        \n        # Algorithmic Task 3: Combine the results to get the final Delta G.\n        delta_g_adsorption = delta_g_surf - mu_h_plus_e\n        \n        return delta_g_adsorption\n\n    # Process each test case\n    for case in test_cases:\n        result = calculate_delta_g(case)\n        results.append(result)\n\n    # Format the final output string as required.\n    # The map(str, ...) converts each float result to its string representation.\n    output_string = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "While calculating the adsorption free energy for a single material is insightful, the true power of the CHE model lies in its ability to predict trends across different materials. The adsorption free energy of hydrogen, $\\Delta G_{H^*}$, serves as an excellent descriptor for the activity of hydrogen evolution catalysts, leading to the well-known \"volcano plot\". This exercise demonstrates how to use the calculated $\\Delta G_{H^*}$ to build such a predictive model, analyze how the ideal catalyst (the volcano apex) shifts with environmental conditions like $pH$, and ultimately connect fundamental thermodynamics to kinetic activity predictions .",
            "id": "4260019",
            "problem": "You are given periodic supercell total energies from first-principles calculations of a metal slab with and without an adsorbed hydrogen atom, sampled at several square in-plane cell lengths. Finite-size periodic-image interactions, especially from slab dipoles, bias these total energies away from their infinite-area values. Your task is to design a program that removes these biases and then evaluates the Gibbs free-energy change for a hydrogen adsorption step using the Computational Hydrogen Electrode (CHE) model.\n\nBegin from fundamental thermodynamic definitions of chemical potential and Gibbs free energy, and from the ideal, reversible definition of the Standard Hydrogen Electrode (SHE). Do not start from any specialized shortcut formulas. Use the following physically plausible constraints and facts:\n- Periodic-image interactions for slab systems manifest as a leading-order term that scales with inverse area, so the energy of a state can be modeled as an affine function of $1/A$ at fixed geometry, where $A$ is the in-plane area.\n- The Gibbs free energy $G$ of a state at temperature $T$ is the sum of its internal energy and appropriate thermal corrections, including zero-point energy and $T$ times entropy, and any solvation corrections when relevant.\n- The CHE model equates the electrochemical potential of a proton–electron pair to half the chemical potential of molecular hydrogen at the same temperature, shifted by the applied electrode potential and the pH-dependent proton chemical activity.\n\nYou must implement two correction strategies for periodic-image interactions:\n- A cell-size extrapolation method: fit the total energy versus $1/A$ and take the intercept as the infinite-area energy.\n- An analytic correction scheme: subtract a known, species-specific, positive coefficient divided by area from each raw energy and then average the corrected energies across the provided cell sizes to estimate the infinite-area energy.\n\nThen, combine the corrected infinite-area energies with thermal and solvation corrections and evaluate the hydrogen adsorption free energy change under the CHE framework. Also compute the same adsorption free energy without any periodic-image correction (use the largest cell in each set as a proxy for “uncorrected”). All energies must be expressed in electronvolts. The temperature $T$ is in kelvins, the electrode potential $U$ is in volts versus the Standard Hydrogen Electrode, and the pH is dimensionless. Angles do not appear, so no angle unit is needed.\n\nYour program must process the following four test cases. In each case, the slab is square with in-plane length list $[L_1,L_2,L_3]$ in ångströms, area $A_i = L_i^2$ in square ångströms, and raw energies for the bare slab ($\\ast$) and the hydrogen-adsorbed slab ($\\ast\\mathrm{H}$). The analytic correction coefficients are given as $\\alpha_{\\ast}$ and $\\alpha_{\\ast\\mathrm{H}}$ in units of $\\mathrm{eV}\\cdot\\text{\\AA}^2$. Thermal and solvation corrections are provided as zero-point energies $\\mathrm{ZPE}$, entropic terms $T S$ at the stated $T$, and solvation free-energy corrections $\\Delta G_{\\mathrm{solv}}$. For molecular hydrogen, assume a large-cell calculation with negligible periodic-image interaction.\n\nUse the following parameter sets:\n- Case $1$ (happy path, moderate cells):\n  - $[L_1,L_2,L_3] = [8,10,12]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-9.9873,-9.9921,-9.99439]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.304225,-10.31008,-10.3129556]$\n  - $\\alpha_{\\ast} = 0.8$, $\\alpha_{\\ast\\mathrm{H}} = 1.0$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = 0.0$, $\\mathrm{pH} = 0$\n- Case $2$ (small cells, strong interactions):\n  - $[L_1,L_2,L_3] = [6,7,8]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-9.9663667,-9.9757102,-9.98115]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.2696,-10.2833653,-10.291675]$\n  - $\\alpha_{\\ast} = 1.2$, $\\alpha_{\\ast\\mathrm{H}} = 1.8$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = 0.1$, $\\mathrm{pH} = 1$\n- Case $3$ (large cells, weak interactions, alkaline conditions):\n  - $[L_1,L_2,L_3] = [20,24,28]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-9.99845,-9.9989883,-9.9992147]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.31779,-10.3184075,-10.318862]$\n  - $\\alpha_{\\ast} = 0.6$, $\\alpha_{\\ast\\mathrm{H}} = 0.9$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = -0.05$, $\\mathrm{pH} = 13$\n- Case $4$ (no periodic interaction, check neutrality):\n  - $[L_1,L_2,L_3] = [8,10,12]$\n  - $E_{\\ast}^{\\mathrm{raw}} = [-10.0002,-9.9999,-10.00005]$\n  - $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}} = [-10.3201,-10.3199,-10.32005]$\n  - $\\alpha_{\\ast} = 0.0$, $\\alpha_{\\ast\\mathrm{H}} = 0.0$\n  - $E_{\\mathrm{H}_2} = -6.800$\n  - $\\mathrm{ZPE}_{\\ast} = 0.050$, $T S_{\\ast} = 0.010$, $\\Delta G_{\\mathrm{solv},\\ast} = 0.000$\n  - $\\mathrm{ZPE}_{\\ast\\mathrm{H}} = 0.200$, $T S_{\\ast\\mathrm{H}} = 0.020$, $\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} = -0.250$\n  - $\\mathrm{ZPE}_{\\mathrm{H}_2} = 0.270$, $T S_{\\mathrm{H}_2} = 0.410$\n  - $T = 298$, $U = 0.5$, $\\mathrm{pH} = 0$\n\nYour program must, for each case, compute three quantities:\n- The CHE adsorption free-energy change $\\Delta G$ using the largest-cell raw energies without any periodic-image correction.\n- The CHE adsorption free-energy change $\\Delta G$ using infinite-area energies obtained by $1/A$ extrapolation for both $\\ast$ and $\\ast\\mathrm{H}$.\n- The CHE adsorption free-energy change $\\Delta G$ using infinite-area energies estimated by the analytic correction scheme for both $\\ast$ and $\\ast\\mathrm{H}$.\n\nExpress all three outputs for each case in electronvolts, rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list of lists, one list per case, each inner list ordered as $[\\Delta G_{\\mathrm{uncorr}}, \\Delta G_{\\mathrm{extrap}}, \\Delta G_{\\mathrm{analytic}}]$. For example, your printout must look like $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$ where each $x_i,y_i,z_i$ is a float.",
            "solution": "The objective is to determine the Gibbs free energy change, $\\Delta G$, for the electrochemical adsorption of a hydrogen atom onto a metal surface. The reaction is given by $\\ast + (\\mathrm{H}^+ + \\mathrm{e}^-) \\rightarrow \\ast\\mathrm{H}$, where $\\ast$ denotes a site on the bare metal slab and $\\ast\\mathrm{H}$ denotes the state with one hydrogen atom adsorbed.\n\nThe Gibbs free energy change for this process is defined by the difference in the Gibbs free energies of the products and reactants:\n$$\n\\Delta G = G_{\\ast\\mathrm{H}} - (G_{\\ast} + \\mu_{\\mathrm{H}^+ + \\mathrm{e}^-})\n$$\nHere, $G_{\\ast\\mathrm{H}}$ and $G_{\\ast}$ are the Gibbs free energies of the hydrogen-adsorbed slab and the bare slab, respectively. The term $\\mu_{\\mathrm{H}^+ + \\mathrm{e}^-}$ represents the electrochemical potential of a proton-electron pair in the electrochemical environment.\n\nThe Gibbs free energy $G_X$ for any species $X$ (e.g., $X = \\ast, \\ast\\mathrm{H}, \\mathrm{H}_2$) is constructed from its calculated total electronic energy $E_X$ and includes corrections for zero-point vibrational energy ($\\mathrm{ZPE}_X$), thermal entropy ($-T S_X$), and solvation effects ($\\Delta G_{\\mathrm{solv},X}$):\n$$\nG_X = E_X + \\mathrm{ZPE}_X - T S_X + \\Delta G_{\\mathrm{solv},X}\n$$\nThe problem provides the values for $\\mathrm{ZPE}_X$, $T S_X$, and $\\Delta G_{\\mathrm{solv},X}$. The central task is to find the most accurate value for the electronic energy $E_X$ from the provided periodic DFT calculations.\n\nThe Computational Hydrogen Electrode (CHE) model provides a framework for evaluating $\\mu_{\\mathrm{H}^+ + \\mathrm{e}^-}$. The problem specifies that the potential $U$ is applied versus the Standard Hydrogen Electrode (SHE). Therefore, we must account for the effects of both the applied potential $U$ and the solution pH on the chemical potential of the proton-electron pair. The energy of an electron is shifted by $-eU$ under an applied potential $U$. The chemical potential of a solvated proton includes an activity-dependent term, $\\mu_{\\mathrm{H}^+} = \\mu_{\\mathrm{H}^+}^{\\circ} + k_B T \\ln a_{\\mathrm{H}^+}$. Since $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$, this introduces a pH-dependent energy shift of $-k_B T \\ln(10) \\cdot \\mathrm{pH}$. The CHE model on the SHE scale combines these effects with the reference chemical potential of hydrogen gas:\n$$\n\\mu_{\\mathrm{H}^+ + \\mathrm{e}^-} = \\frac{1}{2} G_{\\mathrm{H}_2} - eU - k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\nIn this expression, we use the Gibbs free energy of molecular hydrogen, $G_{\\mathrm{H}_2} = E_{\\mathrm{H}_2} + \\mathrm{ZPE}_{\\mathrm{H}_2} - T S_{\\mathrm{H}_2}$, as the reference. We take the elementary charge $e$ as $1$ when energies are in electronvolts (eV) and potential $U$ is in volts (V).\n\nCombining these definitions, the overall expression for the hydrogen adsorption free energy becomes:\n$$\n\\Delta G = (G_{\\ast\\mathrm{H}} - G_{\\ast}) - \\left( \\frac{1}{2} G_{\\mathrm{H}_2} - U - k_B T \\ln(10) \\cdot \\mathrm{pH} \\right)\n$$\nSubstituting the expressions for $G_X$:\n$$\n\\Delta G = (E_{\\ast\\mathrm{H}} - E_{\\ast}) + (\\mathrm{ZPE}_{\\ast\\mathrm{H}} - \\mathrm{ZPE}_{\\ast}) - (T S_{\\ast\\mathrm{H}} - T S_{\\ast}) + (\\Delta G_{\\mathrm{solv},\\ast\\mathrm{H}} - \\Delta G_{\\mathrm{solv},\\ast}) - \\frac{1}{2}(E_{\\mathrm{H}_2} + \\mathrm{ZPE}_{\\mathrm{H}_2} - T S_{\\mathrm{H}_2}) + U + k_B T \\ln(10) \\cdot \\mathrm{pH}\n$$\nThe primary challenge is that the raw electronic energies, $E_{\\ast}^{\\mathrm{raw}}$ and $E_{\\ast\\mathrm{H}}^{\\mathrm{raw}}$, are computed in periodic supercells of finite area $A$ and are thus contaminated by spurious interactions with their periodic images. For systems with a net dipole moment perpendicular to the slab, such as $\\ast\\mathrm{H}$, these interactions decay slowly with cell size, introducing a bias that scales as $1/A$. The \"true\" electronic energy corresponds to the infinite-area limit, $E^{\\infty} = \\lim_{A \\to \\infty} E(A)$. The problem prescribes a model for this finite-size effect:\n$$\nE^{\\mathrm{raw}}(A) = E^{\\infty} + \\frac{\\alpha}{A}\n$$\nwhere $E^{\\infty}$ is the desired infinite-area energy and $\\alpha$ is a species-specific interaction coefficient. Our task is to estimate $E_{\\ast}^{\\infty}$ and $E_{\\ast\\mathrm{H}}^{\\infty}$ using three distinct methods.\n\n1.  **Uncorrected Method:** This approach serves as a baseline. It ignores the finite-size error and takes the energy from the calculation with the largest supercell area ($A_{\\mathrm{max}}$) as a proxy for $E^{\\infty}$.\n    $$E_X^{\\infty, \\mathrm{uncorr}} = E_X^{\\mathrm{raw}}(A_{\\mathrm{max}})$$\n\n2.  **Extrapolation Method:** This method directly utilizes the affine model $E^{\\mathrm{raw}} = E^{\\infty} + \\alpha (1/A)$. The energies $E^{\\mathrm{raw}}$ are plotted against the inverse area $1/A$. A linear least-squares regression is performed on the data points $(1/A_i, E_i^{\\mathrm{raw}})$. The intercept of this fit corresponds to the $A \\to \\infty$ (i.e., $1/A \\to 0$) limit, thus providing an estimate for $E^{\\infty}$.\n    $$E_X^{\\infty, \\mathrm{extrap}} = \\mathrm{intercept of } E_X^{\\mathrm{raw}} \\text{ vs. } 1/A \\text{ fit}$$\n\n3.  **Analytic Correction Method:** This method assumes the interaction coefficient $\\alpha$ is known a priori. For each species $X$, a corrected energy is computed for each cell size $A_i$ by explicitly subtracting the modeled interaction term:\n    $$E_{X, i}^{\\mathrm{corr}} = E_{X, i}^{\\mathrm{raw}} - \\frac{\\alpha_X}{A_i}$$\n    Each of these corrected energies $E_{X, i}^{\\mathrm{corr}}$ is an estimate of $E_X^{\\infty}$. To obtain a single, robust estimate, we take the average of these corrected energies over the available cell sizes.\n    $$E_X^{\\infty, \\mathrm{analytic}} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( E_{X, i}^{\\mathrm{raw}} - \\frac{\\alpha_X}{A_i} \\right)$$\n\nFor each test case, we will compute the pair of infinite-area energies $(E_{\\ast}^{\\infty}, E_{\\ast\\mathrm{H}}^{\\infty})$ using each of the three methods. Subsequently, for each pair, we will calculate the final adsorption free energy $\\Delta G$ using the master equation derived above. This yields the three required values: $\\Delta G_{\\mathrm{uncorr}}$, $\\Delta G_{\\mathrm{extrap}}$, and $\\Delta G_{\\mathrm{analytic}}$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.constants import k, e\n\ndef solve():\n    \"\"\"\n    Computes the Gibbs free-energy change for hydrogen adsorption on a metal slab\n    using the Computational Hydrogen Electrode (CHE) model, with three different\n    schemes for correcting finite-size errors in the total energies.\n    \"\"\"\n    # Boltzmann constant in eV/K\n    k_B = k / e\n\n    # Natural logarithm of 10\n    ln10 = np.log(10)\n\n    test_cases = [\n        # Case 1 (happy path, moderate cells)\n        {\n            \"L\": np.array([8, 10, 12]),\n            \"E_star_raw\": np.array([-9.9873, -9.9921, -9.99439]),\n            \"E_starH_raw\": np.array([-10.304225, -10.31008, -10.3129556]),\n            \"alpha_star\": 0.8, \"alpha_starH\": 1.0,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": 0.0, \"pH\": 0\n        },\n        # Case 2 (small cells, strong interactions)\n        {\n            \"L\": np.array([6, 7, 8]),\n            \"E_star_raw\": np.array([-9.9663667, -9.9757102, -9.98115]),\n            \"E_starH_raw\": np.array([-10.2696, -10.2833653, -10.291675]),\n            \"alpha_star\": 1.2, \"alpha_starH\": 1.8,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": 0.1, \"pH\": 1\n        },\n        # Case 3 (large cells, weak interactions, alkaline conditions)\n        {\n            \"L\": np.array([20, 24, 28]),\n            \"E_star_raw\": np.array([-9.99845, -9.9989883, -9.9992147]),\n            \"E_starH_raw\": np.array([-10.31779, -10.3184075, -10.318862]),\n            \"alpha_star\": 0.6, \"alpha_starH\": 0.9,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": -0.05, \"pH\": 13\n        },\n        # Case 4 (no periodic interaction, check neutrality)\n        {\n            \"L\": np.array([8, 10, 12]),\n            \"E_star_raw\": np.array([-10.0002, -9.9999, -10.00005]),\n            \"E_starH_raw\": np.array([-10.3201, -10.3199, -10.32005]),\n            \"alpha_star\": 0.0, \"alpha_starH\": 0.0,\n            \"E_H2\": -6.800,\n            \"ZPE_star\": 0.050, \"TS_star\": 0.010, \"dG_solv_star\": 0.000,\n            \"ZPE_starH\": 0.200, \"TS_starH\": 0.020, \"dG_solv_starH\": -0.250,\n            \"ZPE_H2\": 0.270, \"TS_H2\": 0.410,\n            \"T\": 298, \"U\": 0.5, \"pH\": 0\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        A = L**2\n        inv_A = 1.0 / A\n\n        # Environmental and thermal contributions\n        G_H2 = case[\"E_H2\"] + case[\"ZPE_H2\"] - case[\"TS_H2\"]\n        \n        dG_corr = (case[\"ZPE_starH\"] - case[\"ZPE_star\"]) - \\\n                  (case[\"TS_starH\"] - case[\"TS_star\"]) + \\\n                  (case[\"dG_solv_starH\"] - case[\"dG_solv_star\"])\n        \n        dG_U_pH = case[\"U\"] + k_B * case[\"T\"] * ln10 * case[\"pH\"]\n\n        def calculate_delta_G(E_star_inf, E_starH_inf):\n            dE_inf = E_starH_inf - E_star_inf\n            delta_G = dE_inf + dG_corr - 0.5 * G_H2 + dG_U_pH\n            return delta_G\n\n        # Method 1: Uncorrected (largest cell)\n        E_star_inf_uncorr = case[\"E_star_raw\"][-1]\n        E_starH_inf_uncorr = case[\"E_starH_raw\"][-1]\n        dG_uncorr = calculate_delta_G(E_star_inf_uncorr, E_starH_inf_uncorr)\n\n        # Method 2: 1/A Extrapolation\n        _, E_star_inf_extrap = np.polyfit(inv_A, case[\"E_star_raw\"], 1)\n        _, E_starH_inf_extrap = np.polyfit(inv_A, case[\"E_starH_raw\"], 1)\n        dG_extrap = calculate_delta_G(E_star_inf_extrap, E_starH_inf_extrap)\n\n        # Method 3: Analytic Correction\n        E_star_corr = case[\"E_star_raw\"] - case[\"alpha_star\"] * inv_A\n        E_star_inf_analytic = np.mean(E_star_corr)\n        \n        E_starH_corr = case[\"E_starH_raw\"] - case[\"alpha_starH\"] * inv_A\n        E_starH_inf_analytic = np.mean(E_starH_corr)\n        \n        dG_analytic = calculate_delta_G(E_star_inf_analytic, E_starH_inf_analytic)\n\n        case_results = [\n            round(dG_uncorr, 6),\n            round(dG_extrap, 6),\n            round(dG_analytic, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "While calculating the adsorption free energy for a single material is insightful, the true power of the CHE model lies in its ability to predict trends across different materials. The adsorption free energy of hydrogen, $\\Delta G_{H^*}$, serves as an excellent descriptor for the activity of hydrogen evolution catalysts, leading to the well-known \"volcano plot\". This exercise demonstrates how to use the calculated $\\Delta G_{H^*}$ to build such a predictive model, analyze how the ideal catalyst (the volcano apex) shifts with environmental conditions like $pH$, and ultimately connect fundamental thermodynamics to kinetic activity predictions .",
            "id": "4260006",
            "problem": "You are studying the sensitivity of the descriptor-based hydrogen evolution reaction activity volcano to entropic corrections and hydrogen ion activity within the Computational Hydrogen Electrode (CHE) framework on the Standard Hydrogen Electrode (SHE) scale. Starting from fundamental thermodynamics and electrochemical potentials, derive and implement a procedure to recompute the Gibbs free energy change for adsorbed hydrogen formation and quantify how the predicted activity and the volcano apex position shift under different thermochemical models and $pH$.\n\nAssumptions and fundamental bases you must use:\n\n- The relevant elementary step is the formation of adsorbed hydrogen, written as $H^+ + e^- + * \\rightarrow H^*$, where $*$ denotes an empty surface site and $H^*$ denotes the adsorbed hydrogen intermediate. The Gibbs free energy change for this step is given by the difference in chemical potentials of products and reactants. Use the thermodynamic identity that for any species $i$, the chemical potential is $\\mu_i = \\mu_i^\\circ + k_B T \\ln a_i + z_i e \\phi$, where $k_B$ is Boltzmann’s constant, $T$ is temperature, $a_i$ is activity, $z_i$ is the charge number, $e$ is the elementary charge, and $\\phi$ is the electrostatic potential.\n- The Computational Hydrogen Electrode (CHE) on the Standard Hydrogen Electrode (SHE) scale relates the combined chemical potential of the proton and electron to molecular hydrogen. The dependence on $pH$ arises from the proton activity term. Work on the SHE scale with electrode potential $U$ expressed in volts. Use the identity $a_{H^+} = 10^{-pH}$.\n- The density functional theory adsorption descriptor $ \\Delta E_{H^*} $ is the electronic energy change for forming $H^*$ from $\\tfrac{1}{2}H_2(g)$, neglecting zero-point energy and entropic terms. The corresponding Gibbs free energy change includes zero-point and entropic corrections that you will model thermochemically.\n- For predicted relative activity, assume a symmetric, descriptor-based volcano in which the rate-determining barrier is approximated by the absolute deviation of the free energy driving force from thermoneutrality. Under transition state theory, take the predicted relative activity to scale as $\\exp\\!\\left(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T)\\right)$, where $\\Delta G_{\\text{eff}}$ is the effective free energy change of $H^*$ formation at the specified conditions.\n\nThermochemical models to compare:\n\n- Model $\\mathrm{M1}$ (“standard”): include a zero-point energy correction of $\\Delta \\mathrm{ZPE} = 0.04$ eV to $ \\Delta E_{H^*}$. Include an entropic penalty $-T \\Delta S$ of $0.20$ eV at $T = 298.15$ K, proportional to $T$ (i.e., scale linearly with $T$).\n- Model $\\mathrm{M2}$ (“vibrational entropy included”): $\\Delta \\mathrm{ZPE} = 0.04$ eV and $-T \\Delta S = 0.16$ eV at $T = 298.15$ K, proportional to $T$.\n- Model $\\mathrm{M3}$ (“low hydrogen pressure” at $p_{H_2} = 0.1$ bar): $\\Delta \\mathrm{ZPE} = 0.04$ eV and $-T \\Delta S = 0.23$ eV at $T = 298.15$ K, proportional to $T$.\n\nAll energies must be in electronvolts. Treat $eU$ in electronvolts by noting that $1$ eV corresponds to $1$ V times the elementary charge. Use $k_B = 8.617333262145 \\times 10^{-5}$ eV/K. Use $\\ln(10) = 2.302585093$.\n\nTasks your program must perform for each test case:\n\n- Compute the effective free energy change $\\Delta G_{\\text{eff}}$ for $H^*$ formation at given $ \\Delta E_{H^*}$, thermochemical model, $T$, $pH$, and $U$ on the SHE scale, using only the fundamental relations above.\n- Compute the predicted relative activity $A = \\exp\\!\\left(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T)\\right)$.\n- Define a baseline activity $A_0$ for the same $ \\Delta E_{H^*}$, $T$, and $U$ but at $pH = 0$ using Model $\\mathrm{M1}$. Compute the activity ratio $r = A / A_0$ (dimensionless, to be reported as a decimal).\n- Determine the volcano apex position on the descriptor axis, namely the value of $ \\Delta E_{H^*}$ at which $\\Delta G_{\\text{eff}} = 0$ for the specified thermochemical model, $T$, $pH$, and $U$. Report this apex location in eV.\n\nPhysical units and formatting:\n\n- Report the volcano apex location in eV, rounded to $6$ decimal places.\n- Report the activity ratio $r$ as a decimal number (no percent sign), rounded to $6$ decimal places.\n\nTest suite to implement and evaluate:\n\nEach test case is a tuple $(\\mathrm{model}, \\Delta E_{H^*}\\text{ in eV}, T\\text{ in K}, pH, U\\text{ in V vs SHE})$.\n\n- Test case $1$: $(\\mathrm{M1}, -0.10, 298.15, 0, 0.0)$\n- Test case $2$: $(\\mathrm{M1}, -0.10, 298.15, 14, 0.0)$\n- Test case $3$: $(\\mathrm{M2}, -0.10, 298.15, 0, 0.0)$\n- Test case $4$: $(\\mathrm{M3}, -0.10, 298.15, 0, 0.0)$\n- Test case $5$: $(\\mathrm{M3}, 0.00, 298.15, 14, 0.0)$\n- Test case $6$: $(\\mathrm{M2}, 0.20, 350.00, 7, 0.0)$\n\nFinal output format:\n\nYour program should produce a single line of output containing a list of per-test-case results, where each result is a two-element list $[\\Delta E_{\\text{apex}}\\text{ (eV)}, r]$ with both entries rounded as specified. The entire output must be a single bracketed list of these two-element lists, for example: $[[x_1,y_1],[x_2,y_2],\\dots]$ with numeric entries.\n\nNo input is read; all constants and the test suite values are hard-coded as specified above. The program must be self-contained and runnable as provided.",
            "solution": "The problem statement has been critically examined and is determined to be **valid**. It is scientifically grounded in the principles of computational electrochemistry and thermodynamics, well-posed with a clear objective and sufficient data, and free from internal contradictions or ambiguities.\n\nHerein, a detailed derivation and algorithmic procedure are presented to solve the problem.\n\nThe fundamental reaction under consideration is the formation of an adsorbed hydrogen atom on a catalytic surface, which is an elementary step in the hydrogen evolution reaction (HER):\n$$ H^+ + e^- + * \\rightarrow H^* $$\nwhere $H^+$ denotes a proton in solution, $e^-$ is an electron from the electrode, $*$ is an unoccupied surface active site, and $H^*$ is a hydrogen atom adsorbed onto a site.\n\nThe Gibbs free energy change for this reaction, which we denote as $\\Delta G_{\\text{eff}}$, is given by the difference in chemical potentials between the products and reactants:\n$$ \\Delta G_{\\text{eff}} = \\mu_{H^*} - (\\mu_{*} + \\mu_{H^+} + \\mu_{e^-}) $$\nThis expression can be rearranged to group surface-related and solution/electrode-related terms:\n$$ \\Delta G_{\\text{eff}} = (\\mu_{H^*} - \\mu_{*}) - (\\mu_{H^+} + \\mu_{e^-}) $$\n\nThe core of the problem lies in expressing these two parenthetical terms as functions of the given parameters: the electronic energy descriptor $\\Delta E_{H^*}$, temperature $T$, $pH$, and electrode potential $U$.\n\n**1. The Chemical Potential of the Proton-Electron Pair $(\\mu_{H^+} + \\mu_{e^-})$**\n\nThe Computational Hydrogen Electrode (CHE) model provides a framework for relating the chemical potential of a proton-electron pair in an electrochemical environment to the chemical potential of gaseous hydrogen, $H_2(g)$. The reference equilibrium is:\n$$ H^+ + e^- \\rightleftharpoons \\frac{1}{2} H_2(g) $$\nUnder standard hydrogen electrode (SHE) conditions ($U = 0$ V, $pH=0$ which means $a_{H^+} = 1$, and $p_{H_2} = 1$ bar at a given temperature $T$), this equilibrium dictates that the chemical potential of the pair is equal to half the chemical potential of a hydrogen molecule:\n$$ \\mu_{H^+} + \\mu_{e^-} = \\frac{1}{2} \\mu_{H_2(g)} \\quad (\\text{at SHE conditions}) $$\nNow, we introduce the effects of non-standard $pH$ and potential $U$. The chemical potential of a species $i$ is given by $\\mu_i = \\mu_i^\\circ + k_B T \\ln a_i + z_i e \\phi$.\nFor a proton ($z_i = +1$), its potential depends on its activity $a_{H^+} = 10^{-pH}$:\n$$ \\mu_{H^+} = \\mu_{H^+}^\\circ + k_B T \\ln(10^{-pH}) = \\mu_{H^+}^\\circ - k_B T \\ln(10) \\cdot pH $$\nFor an electron ($z_i = -1$) in an electrode at potential $U$ relative to the SHE, its chemical potential is shifted by $-eU$:\n$$ \\mu_{e^-} = \\mu_{e^-, \\text{SHE}} - eU $$\nCombining these, the chemical potential of the pair at arbitrary $(pH, U)$ is:\n$$ \\mu_{H^+} + \\mu_{e^-} = (\\mu_{H^+}^\\circ + \\mu_{e^-, \\text{SHE}}) - k_B T \\ln(10) \\cdot pH - eU $$\nRecognizing that $(\\mu_{H^+}^\\circ + \\mu_{e^-, \\text{SHE}})$ is the pair's potential under standard conditions, we substitute the CHE equilibrium condition:\n$$ \\mu_{H^+} + \\mu_{e^-} = \\frac{1}{2}\\mu_{H_2(g)}^\\circ - k_B T \\ln(10) \\cdot pH - eU $$\nwhere $\\mu_{H_2(g)}^\\circ$ is the chemical potential of $H_2(g)$ at $p_{H_2} = 1$ bar. The problem specifies that the term $eU$ can be written simply as $U$ with units of electronvolts (eV) when $U$ is in Volts.\n\n**2. The Chemical Potential of Adsorbed Hydrogen $(\\mu_{H^*} - \\mu_{*})$**\n\nThis term represents the free energy of the adsorbed hydrogen atom relative to the bare surface. We relate this to the given DFT descriptor $\\Delta E_{H^*}$. The descriptor is defined for the reaction $* + \\frac{1}{2}H_2(g) \\rightarrow H^*$, representing the electronic energy change. The corresponding Gibbs free energy change for this process, $\\Delta G_{H^*}$, includes thermochemical corrections for zero-point energy ($\\Delta \\text{ZPE}$) and entropy ($\\Delta S$):\n$$ \\Delta G_{H^*} = \\Delta E_{H^*} + \\Delta G_{corr} = \\Delta E_{H^*} + \\Delta \\text{ZPE} - T \\Delta S $$\nAlso by definition, $\\Delta G_{H^*}$ is the difference in chemical potential:\n$$ \\Delta G_{H^*} = (\\mu_{H^*} - \\mu_{*}) - \\frac{1}{2}\\mu_{H_2(g)}^\\circ $$\nFrom this, we can express the surface term as:\n$$ \\mu_{H^*} - \\mu_{*} = \\Delta G_{H^*} + \\frac{1}{2}\\mu_{H_2(g)}^\\circ = (\\Delta E_{H^*} + \\Delta G_{corr}) + \\frac{1}{2}\\mu_{H_2(g)}^\\circ $$\n\nThe problem specifies that the entropic contribution, $-T \\Delta S$, is proportional to temperature $T$. Given a reference value $(-T \\Delta S)_{ref}$ at a reference temperature $T_{ref} = 298.15$ K, the value at any temperature $T$ is:\n$$ -T \\Delta S = (-T_{ref} \\Delta S) \\frac{T}{T_{ref}} $$\nLet $C_{ref} = (-T \\Delta S)_{ref}$. The total thermochemical correction is:\n$$ \\Delta G_{corr}(T) = \\Delta \\text{ZPE} + C_{ref} \\frac{T}{T_{ref}} $$\n\n**3. The Final Expression for $\\Delta G_{\\text{eff}}$**\n\nSubstituting the expressions for both parenthetical terms back into the equation for $\\Delta G_{\\text{eff}}$:\n$$ \\Delta G_{\\text{eff}} = \\left( (\\Delta E_{H^*} + \\Delta G_{corr}) + \\frac{1}{2}\\mu_{H_2(g)}^\\circ \\right) - \\left( \\frac{1}{2}\\mu_{H_2(g)}^\\circ - k_B T \\ln(10) \\cdot pH - eU \\right) $$\nThe $\\frac{1}{2}\\mu_{H_2(g)}^\\circ$ terms cancel, yielding the final working equation. Using the convention that $eU$ in eV is numerically equal to $U$ in Volts:\n$$ \\Delta G_{\\text{eff}} = \\Delta E_{H^*} + \\Delta G_{corr} + k_B T \\ln(10) \\cdot pH + U $$\n$$ \\Delta G_{\\text{eff}} = \\Delta E_{H^*} + \\left(\\Delta \\text{ZPE} + C_{ref} \\frac{T}{298.15~\\text{K}}\\right) + k_B T \\ln(10) \\cdot pH + U $$\n\n**4. Calculation of Required Quantities**\n\n- **Volcano Apex Position ($\\Delta E_{\\text{apex}}$)**: The activity volcano apex corresponds to the most favorable condition, where the driving force is thermoneutral, i.e., $\\Delta G_{\\text{eff}} = 0$. We solve for the descriptor value, $\\Delta E_{H^*} = \\Delta E_{\\text{apex}}$, that satisfies this condition:\n  $$ 0 = \\Delta E_{\\text{apex}} + \\Delta G_{corr} + k_B T \\ln(10) \\cdot pH + U $$\n  $$ \\Delta E_{\\text{apex}} = -(\\Delta G_{corr} + k_B T \\ln(10) \\cdot pH + U) $$\n\n- **Activity Ratio ($r$)**: The predicted relative activity $A$ is given by $A = \\exp(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T))$. The ratio $r$ is defined as $r = A/A_0$, where $A_0$ is the activity under baseline conditions (same $\\Delta E_{H^*}, T, U$, but with Model $\\mathrm{M1}$ and $pH=0$).\n  First, we compute $\\Delta G_{\\text{eff}}$ for the specified test case conditions.\n  Second, we compute $\\Delta G_{\\text{eff}, 0}$ for the baseline conditions. The $pH$ term becomes zero, and $\\Delta G_{corr, 0}$ is calculated using Model $\\mathrm{M1}$ parameters:\n  $$ \\Delta G_{\\text{eff}, 0} = \\Delta E_{H^*} + \\left(\\Delta \\text{ZPE}_{\\mathrm{M1}} + C_{ref, \\mathrm{M1}} \\frac{T}{298.15~\\text{K}}\\right) + U $$\n  The activity ratio $r$ is then:\n  $$ r = \\frac{A}{A_0} = \\frac{\\exp(-\\left|\\Delta G_{\\text{eff}}\\right|/(k_B T))}{\\exp(-\\left|\\Delta G_{\\text{eff}, 0}\\right|/(k_B T))} = \\exp\\left( \\frac{\\left|\\Delta G_{\\text{eff}, 0}\\right| - \\left|\\Delta G_{\\text{eff}}\\right|}{k_B T} \\right) $$\n\nThese derived formulae are implemented in the following Python code to process the specified test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the volcano apex and activity ratio based on the Computational\n    Hydrogen Electrode (CHE) model.\n    \"\"\"\n\n    # --- Define Constants and Models ---\n    # Physical Constants\n    KB_EV_K = 8.617333262145e-5  # Boltzmann constant in eV/K\n    LN_10 = 2.302585093          # Natural logarithm of 10\n    T_REF = 298.15               # Reference temperature in K\n\n    # Thermochemical Models\n    # Structure: {model_name: {'dZPE': value_in_eV, 'TdS_ref': value_in_eV}}\n    # The 'TdS_ref' key corresponds to the value of -T*DeltaS at T_REF\n    models = {\n        'M1': {'dZPE': 0.04, 'TdS_ref': 0.20}, # \"standard\"\n        'M2': {'dZPE': 0.04, 'TdS_ref': 0.16}, # \"vibrational entropy included\"\n        'M3': {'dZPE': 0.04, 'TdS_ref': 0.23}, # \"low hydrogen pressure\"\n    }\n\n    # --- Test Suite ---\n    # Each case is a tuple: (model_name, dE_H_star_eV, T_K, pH, U_V)\n    test_cases = [\n        ('M1', -0.10, 298.15, 0, 0.0),\n        ('M1', -0.10, 298.15, 14, 0.0),\n        ('M2', -0.10, 298.15, 0, 0.0),\n        ('M3', -0.10, 298.15, 0, 0.0),\n        ('M3', 0.00, 298.15, 14, 0.0),\n        ('M2', 0.20, 350.00, 7, 0.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        model_name, dE_H, T, pH, U = case\n\n        # --- Calculate quantities for the current test case ---\n\n        # 1. Thermochemical correction term (dG_corr)\n        model_params = models[model_name]\n        dZPE = model_params['dZPE']\n        C_ref = model_params['TdS_ref'] # This is (-T*dS)_ref\n        dG_corr = dZPE + C_ref * (T / T_REF)\n\n        # 2. pH-dependent energy term\n        pH_term = KB_EV_K * T * LN_10 * pH\n\n        # 3. Calculate volcano apex position (dE_apex)\n        # dE_apex is the value of dE_H where dG_eff = 0\n        dE_apex = -(dG_corr + pH_term + U)\n\n        # 4. Calculate effective Gibbs free energy (dG_eff) for the given dE_H\n        dG_eff = dE_H + dG_corr + pH_term + U\n\n        # --- Calculate quantities for the baseline case (A0) ---\n\n        # Baseline conditions: same dE_H, T, U but with Model M1 and pH = 0\n        baseline_model_params = models['M1']\n        dZPE_0 = baseline_model_params['dZPE']\n        C_ref_0 = baseline_model_params['TdS_ref']\n        dG_corr_0 = dZPE_0 + C_ref_0 * (T / T_REF)\n        \n        # pH term for baseline is zero\n        pH_term_0 = 0.0\n        \n        # dG_eff for the baseline case\n        dG_eff_0 = dE_H + dG_corr_0 + pH_term_0 + U\n\n        # --- Calculate activity ratio (r) ---\n        kBT = KB_EV_K * T\n        \n        # The exponent in r = exp((|dG_eff_0| - |dG_eff|) / kBT)\n        # Use np.abs for absolute value\n        exponent = (np.abs(dG_eff_0) - np.abs(dG_eff)) / kBT\n        \n        # The ratio r = A/A0\n        r = np.exp(exponent)\n\n        # --- Store and format results ---\n        # Round to 6 decimal places as required\n        rounded_dE_apex = round(dE_apex, 6)\n        rounded_r = round(r, 6)\n        \n        results.append(f\"[{rounded_dE_apex:.6f},{rounded_r:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}