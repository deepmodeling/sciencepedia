{
    "hands_on_practices": [
        {
            "introduction": "理解SEI内部的电场和电势分布是掌握离子输运和反应机理的基础。本练习  提供了通过数值方法求解泊松方程的实践机会，这是静电学建模的基石。通过该练习，您将学会如何处理非均匀介电常数等复杂情况，并计算出决定SEI功能特性的电势降。",
            "id": "4253476",
            "problem": "考虑一个占据域 $x\\in[0,L]$ 的平面固体电解质界面（SEI）层。从物质中的麦克斯韦方程组出发，相关关系式为 $\\nabla\\cdot\\mathbf{D}=\\rho$、$\\mathbf{D}=\\epsilon\\mathbf{E}$ 和 $\\mathbf{E}=-\\nabla\\phi$，其中 $\\mathbf{D}$ 是电位移场，$\\rho$ 是体电荷密度，$\\epsilon$ 是随空间变化的介电常数，$\\mathbf{E}$ 是电场，$\\phi$ 是静电势。在一维（平面几何）中，这些关系式可推导出控制方程 $\\frac{d}{dx}\\left(\\epsilon(x)\\frac{d\\phi}{dx}\\right)=-\\rho(x)$，其位移边界条件与界面处的高斯定律一致：$\\mathbf{D}(0)=\\sigma_0$ 和 $\\mathbf{D}(L)=\\sigma_L$，其中 $\\sigma_0$ 和 $\\sigma_L$ 分别是 $x=0$ 和 $x=L$ 处的面电荷密度。假设相容性条件成立，即 $\\sigma_L-\\sigma_0=\\int_{0}^{L}\\rho(x)\\,dx$。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n- 严格从上述基本陈述出发，为SEI膜实现一个数值求解器，用于求解具有空间变化介电常数 $\\epsilon(x)$ 和给定体电荷密度 $\\rho(x)$ 的一维泊松方程。该求解器必须通过以下方式计算穿过膜的电势降 $\\Delta\\phi=\\phi(L)-\\phi(0)$（单位为伏特）：从 $x=0$ 处的边界条件构建电位移场 $\\mathbf{D}(x)$，并利用关系式 $\\frac{d\\mathbf{D}}{dx}=\\rho(x)$，然后对电场进行一致的线积分评估。\n- 使用真空介电常数 $\\epsilon_0=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。\n- 以伏特为单位生成答案，每个答案四舍五入到六位小数。\n\n使用 $[0,L]$ 上的均匀网格和复合梯形求积法来计算所有需要的积分，以实现您的求解器。您的程序不得读取任何输入；它必须在内部定义并求解以下包含四个案例的测试套件。所有参数在物理上都是合理的且自洽的。在每个案例中，内部验证相容性条件在合理的数值公差范围内成立。\n\n测试套件（每个案例指定 $L$、$\\epsilon(x)$、$\\rho(x)$、$\\sigma_0$ 和 $\\sigma_L$）：\n1. 具有恒定介电常数和恒定体电荷的理想情况：\n   - $L=1.0\\times 10^{-8}\\,\\mathrm{m}$，\n   - $\\epsilon(x)=10\\,\\epsilon_0$，\n   - $\\rho(x)=1.0\\times 10^{5}\\,\\mathrm{C/m^3}$，\n   - $\\sigma_0=1.0\\times 10^{-3}\\,\\mathrm{C/m^2}$，\n   - $\\sigma_L=2.0\\times 10^{-3}\\,\\mathrm{C/m^2}$。\n2. 具有线性变化介电常数和恒定体电荷的情况：\n   - $L=2.0\\times 10^{-8}\\,\\mathrm{m}$，\n   - $\\epsilon(x)=\\epsilon_0\\left(5+5\\,\\frac{x}{L}\\right)$，\n   - $\\rho(x)=5.0\\times 10^{4}\\,\\mathrm{C/m^3}$，\n   - $\\sigma_0=0$，\n   - $\\sigma_L=1.0\\times 10^{-3}\\,\\mathrm{C/m^2}$。\n3. 具有分段恒定介电常数和零体电荷的双层SEI：\n   - $L=1.5\\times 10^{-8}\\,\\mathrm{m}$，\n   - $\\epsilon(x)=\\begin{cases} 3\\,\\epsilon_0  \\text{for } 0\\le x  \\frac{L}{2}, \\\\ 9\\,\\epsilon_0  \\text{for } \\frac{L}{2}\\le x\\le L, \\end{cases}$\n   - $\\rho(x)=0$，\n   - $\\sigma_0=2.0\\times 10^{-4}\\,\\mathrm{C/m^2}$，\n   - $\\sigma_L=2.0\\times 10^{-4}\\,\\mathrm{C/m^2}$。\n4. 具有恒定介电常数和零净电荷的正弦体电荷的情况：\n   - $L=1.0\\times 10^{-8}\\,\\mathrm{m}$，\n   - $\\epsilon(x)=7\\,\\epsilon_0$，\n   - $\\rho(x)=1.0\\times 10^{5}\\,\\sin\\!\\left(2\\pi\\,\\frac{x}{L}\\right)\\,\\mathrm{C/m^3}$，\n   - $\\sigma_0=1.0\\times 10^{-4}\\,\\mathrm{C/m^2}$，\n   - $\\sigma_L=1.0\\times 10^{-4}\\,\\mathrm{C/m^2}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目是对应案例的电势降 $\\Delta\\phi$（单位为伏特），并四舍五入到六位小数（例如，$[\\Delta\\phi_1,\\Delta\\phi_2,\\Delta\\phi_3,\\Delta\\phi_4]$）。",
            "solution": "该问题要求对具有空间变化介电常数的一维泊松方程 $\\frac{d}{dx}\\left(\\epsilon(x)\\frac{d\\phi}{dx}\\right)=-\\rho(x)$ 进行数值求解，以确定域 $x \\in [0,L]$ 上的电势降 $\\Delta\\phi = \\phi(L) - \\phi(0)$。如题目所述，求解方法源于静电学的第一性原理。\n\n题目中提供的基本关系式是电位移场 $\\mathbf{D}$ 的高斯定律 $\\nabla\\cdot\\mathbf{D}=\\rho$、本构关系 $\\mathbf{D}=\\epsilon\\mathbf{E}$，以及电场 $\\mathbf{E}$ 与静电势 $\\phi$ 之间的关系 $\\mathbf{E}=-\\nabla\\phi$。在所考虑的一维平面几何中，这些矢量方程简化为标量微分方程。\n\n位移场的散度变为 $\\frac{dD}{dx} = \\rho(x)$，其中 $D(x)$ 是位移场矢量的单个分量。问题在一个边界上提供了位移场的边界条件，$D(0) = \\sigma_0$，其中 $\\sigma_0$ 是 $x=0$ 处的面电荷密度。我们可以通过对体电荷密度 $\\rho(x')$ 从边界 $x'=0$ 到点 $x$ 进行积分，来确定域内任意点 $x$ 处的位移场 $D(x)$：\n$$D(x) - D(0) = \\int_{0}^{x} \\frac{dD}{dx'} dx' = \\int_{0}^{x} \\rho(x') dx'$$\n代入边界条件 $D(0) = \\sigma_0$，得到位移场的显式表达式：\n$$D(x) = \\sigma_0 + \\int_{0}^{x} \\rho(x') dx'$$\n解存在的必要相容性条件是，体积内的总电荷 $\\int_0^L \\rho(x) dx$ 必须等于通过边界进入的净电荷，这与给定的条件 $\\sigma_L - \\sigma_0 = \\int_0^L \\rho(x) dx$ 一致，其中 $D(L) = \\sigma_L$。\n\n接下来，我们使用随空间变化的介电常数 $\\epsilon(x)$ 将位移场 $D(x)$ 与电场 $E(x)$ 联系起来：\n$$E(x) = \\frac{D(x)}{\\epsilon(x)}$$\n代入 $D(x)$ 的表达式，我们得到作为位置函数的电场：\n$$E(x) = \\frac{1}{\\epsilon(x)} \\left( \\sigma_0 + \\int_{0}^{x} \\rho(x') dx' \\right)$$\n穿过膜的电势降 $\\Delta\\phi = \\phi(L) - \\phi(0)$ 是待计算的量。根据微积分基本定理，这通过线积分与电场 $E(x) = -\\frac{d\\phi}{dx}$ 相关：\n$$\\Delta\\phi = \\phi(L) - \\phi(0) = \\int_{0}^{L} \\frac{d\\phi}{dx} dx = -\\int_{0}^{L} E(x) dx$$\n结合 $E(x)$ 和 $\\Delta\\phi$ 的表达式，我们得到电势降的最终积分方程：\n$$\\Delta\\phi = -\\int_{0}^{L} \\frac{1}{\\epsilon(x)} \\left( \\sigma_0 + \\int_{0}^{x} \\rho(x') dx' \\right) dx$$\n该方程构成了我们数值算法的基础。求解过程涉及一个嵌套积分，将通过数值方法处理。\n\n数值实现过程如下：\n1.  将连续域 $[0,L]$ 离散化为一个由 $N+1$ 个点组成的均匀网格，记为 $x_i = i \\cdot h$，$i=0, 1, \\dots, N$，其中 $h = L/N$ 是步长。选择一个足够大的 $N$ 值以确保数值精度。\n2.  在每个网格点 $x_i$ 上计算函数 $\\rho(x)$ 和 $\\epsilon(x)$，以获得值数组 $\\rho(x_i)$ 和 $\\epsilon(x_i)$。\n3.  对每个网格点 $x_i$ 计算内层积分 $I(x_i) = \\int_0^{x_i} \\rho(x') dx'$。这通过使用累积复合梯形法则来执行，该法则能高效地得出从域的起点到每个点的积分值。\n4.  然后计算每个网格点处的位移场，公式为 $D(x_i) = \\sigma_0 + I(x_i)$。\n5.  使用本构关系计算每个网格点处的电场：$E(x_i) = D(x_i) / \\epsilon(x_i)$。\n6.  最后，使用复合梯形法则对电场值数组 $E(x_i)$ 进行计算，得到外层积分 $\\Delta\\phi = -\\int_0^L E(x) dx$。\n7.  作为每个案例的强制性预备步骤，数值验证相容性条件 $\\int_{0}^{L}\\rho(x)\\,dx = \\sigma_L-\\sigma_0$，以确保所提供参数的物理自洽性。真空介电常数的值取为 $\\epsilon_0=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。\n根据要求，每个测试案例的最终结果四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the 1D Poisson equation for four test cases of an SEI layer\n    and prints the potential drop for each case.\n    \"\"\"\n    # Define physical constants\n    EPSILON_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n\n    def solve_case(L, eps_func, rho_func, sigma_0, sigma_L, N=20000):\n        \"\"\"\n        Solves the 1D Poisson equation for a single case.\n\n        This function implements a numerical solver based on the direct integration\n        of Gauss's law in one dimension.\n\n        Args:\n            L (float): Thickness of the SEI layer in meters.\n            eps_func (callable): Function for permittivity epsilon(x, L, e0).\n            rho_func (callable): Function for charge density rho(x, L).\n            sigma_0 (float): Surface charge density at x=0 in C/m^2.\n            sigma_L (float): Surface charge density at x=L in C/m^2.\n            N (int): Number of grid intervals for the numerical integration.\n\n        Returns:\n            float: The potential drop delta_phi = phi(L) - phi(0) in volts.\n        \"\"\"\n        # 1. Set up the uniform spatial grid\n        x_grid = np.linspace(0, L, N + 1)\n\n        # 2. Evaluate rho(x) and epsilon(x) on the grid\n        rho_x = rho_func(x_grid, L)\n        eps_x = eps_func(x_grid, L, EPSILON_0)\n\n        # 3. Verify the compatibility condition numerically\n        # integral from 0 to L of rho(x) dx should equal sigma_L - sigma_0\n        total_charge_density = np.trapz(rho_x, x_grid)\n        surface_charge_diff = sigma_L - sigma_0\n        if not np.isclose(total_charge_density, surface_charge_diff, rtol=1e-6, atol=1e-9):\n            # This check is for robustness; the problem guarantees validity.\n            # In a real scenario, one might raise an error here.\n            # print(f\"Warning: Compatibility condition not met for L={L}. \"\n            #       f\"Integral={total_charge_density}, Diff={surface_charge_diff}\")\n            pass\n\n        # 4. Construct the displacement field D(x)\n        # D(x) = sigma_0 + integral from 0 to x of rho(x') dx'\n        # The cumulative trapezoidal rule is used for the integral.\n        integral_rho_cumulative = cumulative_trapezoid(rho_x, x_grid, initial=0)\n        D_x = sigma_0 + integral_rho_cumulative\n\n        # 5. Construct the electric field E(x)\n        # E(x) = D(x) / epsilon(x)\n        E_x = D_x / eps_x\n\n        # 6. Compute the potential drop delta_phi\n        # delta_phi = - integral from 0 to L of E(x) dx\n        # The trapezoidal rule is used for the final integration.\n        delta_phi = -np.trapz(E_x, x_grid)\n\n        return delta_phi\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Constant permittivity and constant volumetric charge\n        {\n            \"L\": 1.0e-8,\n            \"eps_func\": lambda x, L, e0: np.full_like(x, 10 * e0),\n            \"rho_func\": lambda x, L: np.full_like(x, 1.0e5),\n            \"sigma_0\": 1.0e-3,\n            \"sigma_L\": 2.0e-3,\n        },\n        # Case 2: Linearly varying permittivity and constant volumetric charge\n        {\n            \"L\": 2.0e-8,\n            \"eps_func\": lambda x, L, e0: e0 * (5 + 5 * x / L) if L > 0 else e0 * 5,\n            \"rho_func\": lambda x, L: np.full_like(x, 5.0e4),\n            \"sigma_0\": 0.0,\n            \"sigma_L\": 1.0e-3,\n        },\n        # Case 3: Piecewise constant permittivity and zero volumetric charge\n        {\n            \"L\": 1.5e-8,\n            \"eps_func\": lambda x, L, e0: np.where(x  L / 2, 3 * e0, 9 * e0),\n            \"rho_func\": lambda x, L: np.zeros_like(x),\n            \"sigma_0\": 2.0e-4,\n            \"sigma_L\": 2.0e-4,\n        },\n        # Case 4: Constant permittivity and sinusoidal volumetric charge\n        {\n            \"L\": 1.0e-8,\n            \"eps_func\": lambda x, L, e0: np.full_like(x, 7 * e0),\n            \"rho_func\": lambda x, L: 1.0e5 * np.sin(2 * np.pi * x / L) if L > 0 else np.zeros_like(x),\n            \"sigma_0\": 1.0e-4,\n            \"sigma_L\": 1.0e-4,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_phi = solve_case(\n            L=case[\"L\"],\n            eps_func=case[\"eps_func\"],\n            rho_func=case[\"rho_func\"],\n            sigma_0=case[\"sigma_0\"],\n            sigma_L=case[\"sigma_L\"],\n        )\n        # Round the final answer to six decimal places as required.\n        results.append(round(delta_phi, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了电场分布的基本计算后，下一步自然是探究其如何影响离子的运动。本练习  要求您运用能斯特-普朗克方程，推导出离子通量的解析解。该方程巧妙地结合了浓度梯度引起的扩散和电场引起的漂移这两种驱动力，从而加深您对SEI内耦合输运现象的理解。",
            "id": "4253529",
            "problem": "考虑一个一维的固态电解质界面相（SEI）片段，其厚度为 $L$，分隔了 $x=0$（靠近负极）和 $x=L$（面向电解质）。在等温条件下，一个电荷数为 $z_i$、浓度为 $c_i(x)$ 的单一离子种类 $i$ 在SEI内部传输。假设如下：(i) 无对流，(ii) 扩散系数 $D_i$ 和电泳迁移率 $u_i$ 为常数，(iii) SEI内部没有物种的均匀生成或消耗，以及 (iv) 在SEI上存在一个由恒定电势降 $\\Delta \\phi = \\phi(L)-\\phi(0)$ 产生的均匀电场。\n\n从质量守恒以及扩散传输和电场下线性电泳漂移的本构定律出发，推导物种 $i$ 穿过SEI的稳态通量 $J_i$。将问题视为一维空间问题，并施加边界条件 $c_i(0)=c_{i,0}$ 和 $c_i(L)=c_{i,L}$。将恒定稳态通量 $J_i$ 的最终答案表示为包含 $D_i$、$u_i$、$z_i$、$c_{i,0}$、$c_{i,L}$、$L$ 和 $\\Delta \\phi$ 的封闭形式解析表达式。您的答案必须是单一表达式；最终方框内的答案不要包含单位。如果引入任何中间变量，请在最终表达式中将其消去，以便只出现指定的参数。无需四舍五入。",
            "solution": "该问题要求计算离子物种通过一维固态电解质界面相（SEI）层的稳态通量。我将首先建立控制输运方程，然后在给定的边界条件下求解它。\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n- **系统：** 厚度为 $L$ 的一维SEI，范围从 $x=0$ 到 $x=L$。\n- **物种：** 电荷数为 $z_i$、浓度为 $c_i(x)$ 的单一离子种类 $i$。\n- **输运性质：** 恒定的扩散系数 $D_i$，恒定的电泳迁移率 $u_i$。\n- **假设：**\n    1.  等温条件。\n    2.  无对流。\n    3.  稳态 ($\\frac{\\partial c_i}{\\partial t}=0$)。\n    4.  SEI内部无均匀反应。\n    5.  由恒定电势降 $\\Delta \\phi = \\phi(L)-\\phi(0)$ 产生的均匀电场。\n- **边界条件：** $c_i(0)=c_{i,0}$ 和 $c_i(L)=c_{i,L}$。\n- **目标：** 推导以 $D_i$、$u_i$、$z_i$、$c_{i,0}$、$c_{i,L}$、$L$ 和 $\\Delta \\phi$ 表示的稳态通量 $J_i$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了离子的扩散和漂移输运，这是一个由能斯特-普朗克方程控制的过程。这些假设是创建可解析求解模型的标准假设。该问题是适定的，提供了一个具有足够边界条件的微分方程，以获得唯一解。语言是客观的，设定是自洽且内部一致的，前提是采用对迁移率的特定解释以满足所有约束。问题将 $u_i$ 和 $z_i$ 列为最终表达式中的独立参数。标准的电泳迁移率是一个已包含电荷信息的有符号量。为了得到一个按要求明确包含 $z_i$ 的表达式，我将把漂移速度分量定义为 $v_{drift} = z_i u_i E$，其中 $u_i$ 是一个与电荷符号无关的迁移率系数。这种解释使得问题完全一致。\n\n**步骤3：结论与行动**\n问题被认为是有效的。我现在将进行推导。\n\n对于一维稳态系统中无均匀反应的物种 $i$，其质量守恒由下式给出：\n$$\n\\frac{dJ_i}{dx} = 0\n$$\n这意味着在区域 $[0, L]$ 内，总通量 $J_i$ 对所有 $x$ 都是恒定的。\n\n总通量 $J_i$ 是扩散通量 ($J_{diff}$) 和漂移通量 ($J_{drift}$) 的和。\n扩散通量由菲克第一定律描述：\n$$\nJ_{diff} = -D_i \\frac{dc_i}{dx}\n$$\n漂移通量是由于带电物种在电场 $E$ 中的运动引起的。漂移速度与电场成正比。如验证阶段所述，为确保最终表达式包含独立的参数 $z_i$，我们将漂移速度定义为 $v_{drift} = z_i u_i E$。相应的漂移通量为：\n$$\nJ_{drift} = c_i(x) v_{drift} = c_i(x) z_i u_i E\n$$\n问题陈述了一个均匀电场，它是由厚度为 $L$ 的区域上恒定的电势降 $\\Delta \\phi = \\phi(L) - \\phi(0)$ 产生的。在一维情况下，电场 $E$ 与电势 $\\phi$ 的关系为 $E = -\\frac{d\\phi}{dx}$。对于均匀场，这简化为：\n$$\nE = -\\frac{\\phi(L) - \\phi(0)}{L - 0} = -\\frac{\\Delta \\phi}{L}\n$$\n将此代入漂移通量的表达式中，得到：\n$$\nJ_{drift} = -c_i(x) \\frac{z_i u_i \\Delta \\phi}{L}\n$$\n结合扩散和漂移分量，得到总通量 $J_i$ 的能斯特-普朗克方程：\n$$\nJ_i = J_{diff} + J_{drift} = -D_i \\frac{dc_i}{dx} - c_i(x) \\frac{z_i u_i \\Delta \\phi}{L}\n$$\n由于 $J_i$ 是一个常数，这是一个关于浓度分布 $c_i(x)$ 的一阶线性常微分方程。我们将其重排为标准形式 $\\frac{dy}{dx} + P(x) y = Q(x)$：\n$$\n\\frac{dc_i}{dx} + \\left(\\frac{z_i u_i \\Delta \\phi}{L D_i}\\right) c_i(x) = -\\frac{J_i}{D_i}\n$$\n该方程具有常数系数。为清晰起见，我们定义两个常数 $\\alpha$ 和 $\\beta$：\n$$\n\\alpha = \\frac{z_i u_i \\Delta \\phi}{L D_i} \\quad \\text{和} \\quad \\beta = -\\frac{J_i}{D_i}\n$$\n微分方程变为：\n$$\n\\frac{dc_i}{dx} + \\alpha c_i = \\beta\n$$\n可以使用积分因子 $I(x) = \\exp\\left(\\int \\alpha dx\\right) = \\exp(\\alpha x)$ 求解。将常微分方程乘以 $I(x)$：\n$$\n\\exp(\\alpha x) \\frac{dc_i}{dx} + \\alpha \\exp(\\alpha x) c_i = \\beta \\exp(\\alpha x)\n$$\n左边是一个乘积的导数：\n$$\n\\frac{d}{dx}\\left(c_i(x) \\exp(\\alpha x)\\right) = \\beta \\exp(\\alpha x)\n$$\n对两边关于 $x$ 积分：\n$$\nc_i(x) \\exp(\\alpha x) = \\int \\beta \\exp(\\alpha x) dx = \\frac{\\beta}{\\alpha} \\exp(\\alpha x) + C\n$$\n其中 $C$ 是积分常数。求解 $c_i(x)$：\n$$\nc_i(x) = \\frac{\\beta}{\\alpha} + C \\exp(-\\alpha x)\n$$\n将 $\\alpha$ 和 $\\beta$ 的表达式代回：\n$$\nc_i(x) = \\frac{-J_i/D_i}{(z_i u_i \\Delta \\phi)/(L D_i)} + C \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{L D_i} x\\right)\n$$\n$$\nc_i(x) = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + C \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{L D_i} x\\right)\n$$\n这是浓度分布的通解。我们现在应用边界条件来确定常数 $C$ 和 $J_i$。\n\n在 $x=0$ 处，$c_i(0) = c_{i,0}$：\n$$\nc_{i,0} = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + C \\exp(0) = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + C\n$$\n求解 $C$：\n$$\nC = c_{i,0} + \\frac{J_i L}{z_i u_i \\Delta \\phi}\n$$\n在 $x=L$ 处，$c_i(L) = c_{i,L}$。我们将 $C$ 的表达式代入通解，并在 $x=L$ 处求值：\n$$\nc_{i,L} = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + \\left(c_{i,0} + \\frac{J_i L}{z_i u_i \\Delta \\phi}\\right) \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right)\n$$\n现在，我们求解这个方程以得到未知通量 $J_i$。首先，我们将包含 $J_i$ 和不包含 $J_i$ 的项分组：\n$$\nc_{i,L} = -\\frac{J_i L}{z_i u_i \\Delta \\phi} + c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) + \\frac{J_i L}{z_i u_i \\Delta \\phi} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right)\n$$\n$$\nc_{i,L} - c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) = J_i \\left( \\frac{L}{z_i u_i \\Delta \\phi} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - \\frac{L}{z_i u_i \\Delta \\phi} \\right)\n$$\n提取出右侧的公因子：\n$$\nc_{i,L} - c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) = J_i \\frac{L}{z_i u_i \\Delta \\phi} \\left( \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - 1 \\right)\n$$\n最后，分离出 $J_i$：\n$$\nJ_i = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ c_{i,L} - c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }{ \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - 1 }\n$$\n为了以更简洁的形式呈现表达式，我们可以将分数的分子和分母同乘以 $\\exp\\left(\\frac{z_i u_i \\Delta \\phi}{D_i}\\right)$：\n$$\nJ_i = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ \\left(c_{i,L} - c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right)\\right) \\exp\\left(\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }{ \\left(\\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - 1\\right) \\exp\\left(\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }\n$$\n$$\nJ_i = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ c_{i,L} \\exp\\left(\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - c_{i,0} }{ 1 - \\exp\\left(\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }\n$$\n这种形式是等价的。另一种方便的形式是通过将 $J_i$ 初始解的分子和分母同乘以 $-1$ 得到：\n$$\nJ_i = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ -(c_{i,L} - c_{i,0} \\exp(-\\frac{z_i u_i \\Delta \\phi}{D_i})) }{ -( \\exp(-\\frac{z_i u_i \\Delta \\phi}{D_i}) - 1) } = \\frac{z_i u_i \\Delta \\phi}{L} \\frac{ c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - c_{i,L} }{ 1 - \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }\n$$\n这个最终表达式以所有指定参数的形式给出了稳态通量 $J_i$。",
            "answer": "$$\n\\boxed{\\frac{z_i u_i \\Delta \\phi}{L} \\frac{ c_{i,0} \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) - c_{i,L} }{ 1 - \\exp\\left(-\\frac{z_i u_i \\Delta \\phi}{D_i}\\right) }}\n$$"
        },
        {
            "introduction": "作为本章的综合性实践，我们将超越静态图像，转向动态模拟SEI的实际形成过程。本练习  通过一系列基元反应步骤，从头开始构建一个微观动力学模型。通过这项实践，您将深入了解电极电势和温度等操作条件如何影响这一关键界面层的生长和最终组分。",
            "id": "4253505",
            "problem": "您的任务是构建并数值求解一个用于锂离子电池中固体电解质界面相（SEI）形成的微观动力学模型，重点关注碳酸亚乙酯的还原。SEI 是固体电解质界面相（Solid Electrolyte Interphase）。从基本定律和经过充分检验的公式出发，推导导致二碳酸亚乙酯锂和碳酸锂形成的基元步骤的常微分方程组，其中速率常数依赖于温度和覆盖度引起的势垒位移。将该模型实现为一个完整的、可运行的程序，该程序计算表面覆盖度的时间演化，并为指定的测试组返回最终的稳态覆盖度。\n\n从以下基础开始：\n- 质量守恒和位点平衡：所有表面覆盖度之和加上自由位点分数等于1。\n- 吸附、解吸和化学反应的质量作用动力学。\n- 化学反应速率对温度依赖性的 Arrhenius 定律。\n- 电子转移步骤的 Butler–Volmer 型电势依赖性。\n\n在具有单一类型位点的均匀表面上定义以下基元步骤，其中星号表示一个表面位点：\n1. 碳酸亚乙酯的吸附和解吸：\n   $\\mathrm{EC(sol)} + * \\rightleftharpoons \\mathrm{EC*}.$\n2. 吸附态碳酸亚乙酯的单电子还原：\n   $\\mathrm{EC*} + e^- \\rightarrow \\mathrm{R*}.$\n3. 锂与还原中间体的结合：\n   $\\mathrm{R*} + \\mathrm{Li^+} \\rightarrow \\mathrm{I*}.$\n4. 生成二碳酸亚乙酯锂（表面产物）的路径：\n   $\\mathrm{I*} + \\mathrm{EC(sol)} \\rightarrow \\mathrm{LEDC*}.$\n5. 生成碳酸锂（表面产物）的路径：\n   $\\mathrm{I*} + \\mathrm{Li^+} \\rightarrow \\mathrm{Li_2CO_3*}.$\n\n令表面覆盖度表示为：\n- $\\theta_{\\mathrm{EC}}$ 表示 $\\mathrm{EC*},$\n- $\\theta_{\\mathrm{R}}$ 表示 $\\mathrm{R*},$\n- $\\theta_{\\mathrm{I}}$ 表示 $\\mathrm{I*},$\n- $\\theta_{\\mathrm{LEDC}}$ 表示 $\\mathrm{LEDC*},$\n- $\\theta_{\\mathrm{Li_2CO_3}}$ 表示 $\\mathrm{Li_2CO_3*}.$\n\n将 SEI 覆盖度定义为：\n$\\theta_{\\mathrm{SEI}} = \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}.$\n通过位点平衡定义自由位点的分数：\n$\\theta_* = 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right),$\n并约束 $\\theta_* \\ge 0.$\n\n令电解质中的浓度（假设恒定）为：\n- $C_{\\mathrm{EC}}$ 单位为 $\\mathrm{mol\\,m^{-3}}$,\n- $C_{\\mathrm{Li}}$ 单位为 $\\mathrm{mol\\,m^{-3}}.$\n\n将温度定义为 $T$（单位：开尔文），电极电势（相对于锂/锂离子）定义为 $E$（单位：伏特）。基元步骤的速率为：\n- 正向吸附速率：\n  $r_{1,\\mathrm{f}} = k_{1,\\mathrm{f}}(T)\\, C_{\\mathrm{EC}}\\, \\theta_*.$\n- 逆向吸附（解吸）速率：\n  $r_{1,\\mathrm{r}} = k_{1,\\mathrm{r}}(T)\\, \\theta_{\\mathrm{EC}}.$\n- 电子转移还原速率：\n  $r_{2} = k_{2}(T,E,\\theta_{\\mathrm{SEI}})\\, \\theta_{\\mathrm{EC}}.$\n- 锂结合速率：\n  $r_{3} = k_{3}(T,\\theta_{\\mathrm{SEI}})\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{R}}.$\n- 二碳酸亚乙酯锂生成速率：\n  $r_{4} = k_{4}(T,\\theta_{\\mathrm{SEI}})\\, C_{\\mathrm{EC}}\\, \\theta_{\\mathrm{I}}.$\n- 碳酸锂生成速率：\n  $r_{5} = k_{5}(T,\\theta_{\\mathrm{SEI}})\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{I}}.$\n\n对化学步骤使用 Arrhenius 定律，并包含与覆盖度相关的势垒位移：\n- 正向吸附：\n  $k_{1,\\mathrm{f}}(T) = A_{1,\\mathrm{f}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{f}}}{R T}\\right).$\n- 解吸：\n  $k_{1,\\mathrm{r}}(T) = A_{1,\\mathrm{r}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{r}}}{R T}\\right).$\n- 具有 Butler–Volmer 型依赖性和覆盖度相关势垒的电子转移：\n  $$E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,2,0} + \\gamma_{2}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{2}(T,E,\\theta_{\\mathrm{SEI}}) = A_{2}\\, \\exp\\!\\left(-\\frac{E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right)\\, \\exp\\!\\left(-\\frac{\\alpha_{2} F \\left(E - E_{0,2}\\right)}{R T}\\right).$$\n- 锂结合：\n  $$E_{a,3}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,3,0} + \\gamma_{3}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{3}(T,\\theta_{\\mathrm{SEI}}) = A_{3}\\, \\exp\\!\\left(-\\frac{E_{a,3}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right).$$\n- 二碳酸亚乙酯锂生成：\n  $$E_{a,4}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,4,0} + \\gamma_{4}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{4}(T,\\theta_{\\mathrm{SEI}}) = A_{4}\\, \\exp\\!\\left(-\\frac{E_{a,4}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right).$$\n- 碳酸锂生成：\n  $$E_{a,5}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,5,0} + \\gamma_{5}\\, \\theta_{\\mathrm{SEI}},$$\n  $$k_{5}(T,\\theta_{\\mathrm{SEI}}) = A_{5}\\, \\exp\\!\\left(-\\frac{E_{a,5}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right).$$\n\n常数：\n- 通用气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}.$\n- 法拉第常数 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}.$\n\n参数（所有参数均具有科学合理性，并在所有测试用例中保持不变）：\n- 指前因子和活化能：\n  $A_{1,\\mathrm{f}} = 10^{-3}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,1,\\mathrm{f}} = 5000\\,\\mathrm{J\\,mol^{-1}}.$\n  $A_{1,\\mathrm{r}} = 10^{2}\\,\\mathrm{s^{-1}},\\quad E_{a,1,\\mathrm{r}} = 30000\\,\\mathrm{J\\,mol^{-1}}.$\n  $A_{2} = 10^{2}\\,\\mathrm{s^{-1}},\\quad E_{a,2,0} = 50000\\,\\mathrm{J\\,mol^{-1}},\\quad \\alpha_{2} = 0.5,\\quad E_{0,2} = 0.2\\,\\mathrm{V},\\quad \\gamma_{2} = 20000\\,\\mathrm{J\\,mol^{-1}}.$\n  $A_{3} = 10^{-3}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,3,0} = 20000\\,\\mathrm{J\\,mol^{-1}},\\quad \\gamma_{3} = 5000\\,\\mathrm{J\\,mol^{-1}}.$\n  $A_{4} = 10^{0}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,4,0} = 25000\\,\\mathrm{J\\,mol^{-1}},\\quad \\gamma_{4} = 10000\\,\\mathrm{J\\,mol^{-1}}.$\n  $A_{5} = 10^{0}\\,\\mathrm{m^3\\,mol^{-1}\\,s^{-1}},\\quad E_{a,5,0} = 28000\\,\\mathrm{J\\,mol^{-1}},\\quad \\gamma_{5} = 15000\\,\\mathrm{J\\,mol^{-1}}.$\n\n通过应用化学计量和质量作用速率，推导覆盖度的常微分方程：\n- $\\frac{d\\theta_{\\mathrm{EC}}}{dt} = r_{1,\\mathrm{f}} - r_{1,\\mathrm{r}} - r_{2}.$\n- $\\frac{d\\theta_{\\mathrm{R}}}{dt} = r_{2} - r_{3}.$\n- $\\frac{d\\theta_{\\mathrm{I}}}{dt} = r_{3} - r_{4} - r_{5}.$\n- $\\frac{d\\theta_{\\mathrm{LEDC}}}{dt} = r_{4}.$\n- $\\frac{d\\theta_{\\mathrm{Li_2CO_3}}}{dt} = r_{5}.$\n\n从 $t=0\\,\\mathrm{s}$ 到 $t=t_{\\mathrm{end}}=1000\\,\\mathrm{s}$ 对该系统进行数值积分。在模拟中通过取 $\\theta_* = \\max\\!\\left(0, 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right)\\right)$ 来强制执行 $\\theta_* \\ge 0$。通过在积分后对最终值进行裁剪，确保所有覆盖度保持在 $[0,1]$ 范围内。输出量为最终表面覆盖度 $\\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}})$ 和 $\\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}})$（无量纲、无单位的量）。将每个值四舍五入到三位小数。\n\n测试组（以指定单位提供所有值）：\n- 情况 $1$（一般情况）：$T=298\\,\\mathrm{K},\\ E=-0.5\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$，初始覆盖度为 $\\theta_{\\mathrm{EC}}(0)=0,\\ \\theta_{\\mathrm{R}}(0)=0,\\ \\theta_{\\mathrm{I}}(0)=0,\\ \\theta_{\\mathrm{LEDC}}(0)=0,\\ \\theta_{\\mathrm{Li_2CO_3}}(0)=0.$\n- 情况 $2$（低温）：$T=250\\,\\mathrm{K},\\ E=-0.5\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$，初始覆盖度与情况 $1$ 相同。\n- 情况 $3$（较低的还原电势）：$T=298\\,\\mathrm{K},\\ E=-0.1\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$，初始覆盖度与情况 $1$ 相同。\n- 情况 $4$（预钝化表面）：$T=298\\,\\mathrm{K},\\ E=-0.5\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$，初始覆盖度为 $\\theta_{\\mathrm{EC}}(0)=0,\\ \\theta_{\\mathrm{R}}(0)=0,\\ \\theta_{\\mathrm{I}}(0)=0,\\ \\theta_{\\mathrm{LEDC}}(0)=0.2,\\ \\theta_{\\mathrm{Li_2CO_3}}(0)=0.2.$\n- 情况 $5$（强还原电势）：$T=298\\,\\mathrm{K},\\ E=-1.0\\,\\mathrm{V},\\ C_{\\mathrm{EC}}=1000\\,\\mathrm{mol\\,m^{-3}},\\ C_{\\mathrm{Li}}=1000\\,\\mathrm{mol\\,m^{-3}}$，初始覆盖度与情况 $1$ 相同。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个元素对应一个测试用例，本身是一个包含两个浮点数 $[\\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}}), \\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}})]$ 的列表，四舍五入到三位小数。例如：\n$$ \\left[ [x_{1}, y_{1}], [x_{2}, y_{2}], [x_{3}, y_{3}], [x_{4}, y_{4}], [x_{5}, y_{5}] \\right] $$\n其中每个 $x_{i}$ 和 $y_{i}$ 均表示为四舍五入到三位小数的无量纲浮点数。",
            "solution": "我们从质量守恒和基本动力学定律出发。固体电解质界面相 (SEI) 占据表面位点，从而减少了可用于吸附的自由位点。我们对具有位点守恒的单位点表面进行建模。总覆盖度必须满足：\n$$\\theta_* + \\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}} = 1.$$\n因此，\n$$\\theta_* = 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right),$$\n并且我们在整个演化过程中通过取 $\\theta_* = \\max\\!\\left(0, \\cdots \\right)$ 来强制执行 $\\theta_* \\ge 0$。\n\n对于速率，我们应用具有 Arrhenius 温度依赖性和覆盖度调制势垒的质量作用动力学。从溶液中的吸附（正向）对溶液浓度和自由位点均为一级反应：\n$$r_{1,\\mathrm{f}} = k_{1,\\mathrm{f}}(T)\\, C_{\\mathrm{EC}}\\, \\theta_*,$$\n其中\n$$k_{1,\\mathrm{f}}(T) = A_{1,\\mathrm{f}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{f}}}{R T}\\right).$$\n解吸对吸附覆盖度为一级反应：\n$$r_{1,\\mathrm{r}} = k_{1,\\mathrm{r}}(T)\\, \\theta_{\\mathrm{EC}},$$\n其中\n$$k_{1,\\mathrm{r}}(T) = A_{1,\\mathrm{r}}\\, \\exp\\!\\left(-\\frac{E_{a,1,\\mathrm{r}}}{R T}\\right).$$\n\n电子转移由一个类 Arrhenius 指前因子和一个 Butler–Volmer 型的超电势指数项控制，并通过势垒位移受到 SEI 覆盖度的修正：\n$$E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,2,0} + \\gamma_{2}\\, \\theta_{\\mathrm{SEI}},$$\n$$k_{2}(T,E,\\theta_{\\mathrm{SEI}}) = A_{2}\\, \\exp\\!\\left(-\\frac{E_{a,2}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}})}{R T}\\right)\\, \\exp\\!\\left(-\\frac{\\alpha_{2} F \\left(E - E_{0,2}\\right)}{R T}\\right),$$\n还原速率为\n$$r_{2} = k_{2}(T,E,\\theta_{\\mathrm{SEI}})\\, \\theta_{\\mathrm{EC}}.$$\n当 $E  E_{0,2},$ 时，项 $\\exp\\!\\left(-\\frac{\\alpha_{2} F \\left(E - E_{0,2}\\right)}{R T}\\right)$ 会增加（因为指数变为正值），导致更高的还原速率，这与物理直觉一致。\n\n锂结合和产物生成步骤是化学反应，其势垒位移与 SEI 覆盖度成正比：\n$$E_{a,3}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,3,0} + \\gamma_{3}\\, \\theta_{\\mathrm{SEI}},\\quad k_{3} = A_{3}\\, \\exp\\!\\left(-\\frac{E_{a,3}^{\\mathrm{eff}}}{R T}\\right),\\quad r_{3} = k_{3}\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{R}}.$$\n$$E_{a,4}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,4,0} + \\gamma_{4}\\, \\theta_{\\mathrm{SEI}},\\quad k_{4} = A_{4}\\, \\exp\\!\\left(-\\frac{E_{a,4}^{\\mathrm{eff}}}{R T}\\right),\\quad r_{4} = k_{4}\\, C_{\\mathrm{EC}}\\, \\theta_{\\mathrm{I}}.$$\n$$E_{a,5}^{\\mathrm{eff}}(\\theta_{\\mathrm{SEI}}) = E_{a,5,0} + \\gamma_{5}\\, \\theta_{\\mathrm{SEI}},\\quad k_{5} = A_{5}\\, \\exp\\!\\left(-\\frac{E_{a,5}^{\\mathrm{eff}}}{R T}\\right),\\quad r_{5} = k_{5}\\, C_{\\mathrm{Li}}\\, \\theta_{\\mathrm{I}}.$$\n\n应用化学计量将速率转换为覆盖度演化：\n- 吸附步骤增加 $\\theta_{\\mathrm{EC}}$ 而解吸步骤减少它；电子转移消耗 $\\theta_{\\mathrm{EC}}.$ 因此，\n  $$\\frac{d\\theta_{\\mathrm{EC}}}{dt} = r_{1,\\mathrm{f}} - r_{1,\\mathrm{r}} - r_{2}.$$\n- 电子转移步骤生成 $\\theta_{\\mathrm{R}}$ 而锂结合步骤消耗它：\n  $$\\frac{d\\theta_{\\mathrm{R}}}{dt} = r_{2} - r_{3}.$$\n- 中间体 $\\theta_{\\mathrm{I}}$ 由 $r_{3}$ 生成，并被产物生成步骤 $r_{4}$ 和 $r_{5}$ 消耗：\n  $$\\frac{d\\theta_{\\mathrm{I}}}{dt} = r_{3} - r_{4} - r_{5}.$$\n- 产物覆盖度不可逆地累积：\n  $$\\frac{d\\theta_{\\mathrm{LEDC}}}{dt} = r_{4},\\quad \\frac{d\\theta_{\\mathrm{Li_2CO_3}}}{dt} = r_{5}.$$\n\n算法设计：\n1. 对于每个测试用例，定义 $T,$ $E,$ $C_{\\mathrm{EC}},$ $C_{\\mathrm{Li}},$ 和初始覆盖度。\n2. 在每个时间步（在一个鲁棒的数值积分器内），通过在零处裁剪的位点平衡来计算 $\\theta_{\\mathrm{SEI}} = \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}$ 和 $\\theta_*$：\n   $$\\theta_* = \\max\\!\\left(0, 1 - \\left(\\theta_{\\mathrm{EC}} + \\theta_{\\mathrm{R}} + \\theta_{\\mathrm{I}} + \\theta_{\\mathrm{LEDC}} + \\theta_{\\mathrm{Li_2CO_3}}\\right)\\right).$$\n3. 使用提供的 Arrhenius 和 Butler–Volmer 型表达式计算有效活化能和速率常数。\n4. 评估速率 $r_{1,\\mathrm{f}}, r_{1,\\mathrm{r}}, r_{2}, r_{3}, r_{4}, r_{5}.$ \n5. 组装右侧向量 $\\left[\\frac{d\\theta_{\\mathrm{EC}}}{dt}, \\frac{d\\theta_{\\mathrm{R}}}{dt}, \\frac{d\\theta_{\\mathrm{I}}}{dt}, \\frac{d\\theta_{\\mathrm{LEDC}}}{dt}, \\frac{d\\theta_{\\mathrm{Li_2CO_3}}}{dt}\\right].$\n6. 使用适合潜在刚性动力学的稳定求解器从 $t=0\\,\\mathrm{s}$ 积分到 $t=1000\\,\\mathrm{s}$；积分后，将最终覆盖度裁剪到 $[0,1].$\n7. 记录 $\\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}})$ 和 $\\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}}),$ 将它们四舍五入到三位小数，并汇总结果。\n\n物理一致性考虑：\n- $k_{2}$ 中的电势依赖性确保了在更负的 $E$ 值下有更高的还原速率，这与电子转移动力学一致，其中 $\\alpha_{2}$ 是转移系数， $E_{0,2}$ 是参考电势。\n- 与覆盖度相关的势垒位移 $\\gamma_{i}\\, \\theta_{\\mathrm{SEI}}$ 模拟了 SEI 的钝化效应，随着 SEI 的增长，会减慢进一步的反应。\n- 吸附取决于自由位点的可用性，从而确保位点守恒得到遵守。\n\n最终程序实现了这个微观动力学模型，为每个测试用例积分该系统，并输出一行包含结果列表 $\\left[ [x_{1}, y_{1}], \\ldots, [x_{5}, y_{5}] \\right]$ 的结果，其中 $x_{i} = \\theta_{\\mathrm{LEDC}}(t_{\\mathrm{end}})$ 和 $y_{i} = \\theta_{\\mathrm{Li_2CO_3}}(t_{\\mathrm{end}})$ 四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Constants\nR = 8.314462618  # J/mol/K\nF = 96485.33212  # C/mol\n\n# Fixed kinetic parameters (globally used)\nA1f = 1e-3        # m^3/(mol*s)\nEa1f = 5000.0     # J/mol\nA1r = 1e2         # 1/s\nEa1r = 30000.0    # J/mol\n\nA2 = 1e2          # 1/s\nEa20 = 50000.0    # J/mol\nalpha2 = 0.5\nE02 = 0.2         # V\ngamma2 = 20000.0  # J/mol\n\nA3 = 1e-3         # m^3/(mol*s)\nEa30 = 20000.0    # J/mol\ngamma3 = 5000.0   # J/mol\n\nA4 = 1.0          # m^3/(mol*s)\nEa40 = 25000.0    # J/mol\ngamma4 = 10000.0  # J/mol\n\nA5 = 1.0          # m^3/(mol*s)\nEa50 = 28000.0    # J/mol\ngamma5 = 15000.0  # J/mol\n\nt_end = 1000.0    # s\n\ndef microkinetic_rhs(t, y, T, E, C_EC, C_Li):\n    # Unpack coverages: theta_EC, theta_R, theta_I, theta_LEDC, theta_Li2CO3\n    theta_EC, theta_R, theta_I, theta_LEDC, theta_Li2CO3 = y\n    # SEI coverage\n    theta_SEI = theta_LEDC + theta_Li2CO3\n    # Free sites (ensure non-negative)\n    theta_total = theta_EC + theta_R + theta_I + theta_LEDC + theta_Li2CO3\n    theta_free = max(0.0, 1.0 - theta_total)\n\n    # Effective activation energies with coverage dependence\n    Ea2_eff = Ea20 + gamma2 * theta_SEI\n    Ea3_eff = Ea30 + gamma3 * theta_SEI\n    Ea4_eff = Ea40 + gamma4 * theta_SEI\n    Ea5_eff = Ea50 + gamma5 * theta_SEI\n\n    # Rate constants\n    k1f = A1f * np.exp(-Ea1f / (R * T))               # m^3/(mol*s)\n    k1r = A1r * np.exp(-Ea1r / (R * T))               # 1/s\n\n    k2 = A2 * np.exp(-Ea2_eff / (R * T)) * np.exp(-alpha2 * F * (E - E02) / (R * T))  # 1/s\n\n    k3 = A3 * np.exp(-Ea3_eff / (R * T))              # m^3/(mol*s)\n    k4 = A4 * np.exp(-Ea4_eff / (R * T))              # m^3/(mol*s)\n    k5 = A5 * np.exp(-Ea5_eff / (R * T))              # m^3/(mol*s)\n\n    # Elementary step rates\n    r1f = k1f * C_EC * theta_free\n    r1r = k1r * theta_EC\n    r2 = k2 * theta_EC\n    r3 = k3 * C_Li * theta_R\n    r4 = k4 * C_EC * theta_I\n    r5 = k5 * C_Li * theta_I\n\n    # ODEs\n    dtheta_EC = r1f - r1r - r2\n    dtheta_R = r2 - r3\n    dtheta_I = r3 - r4 - r5\n    dtheta_LEDC = r4\n    dtheta_Li2CO3 = r5\n\n    return [dtheta_EC, dtheta_R, dtheta_I, dtheta_LEDC, dtheta_Li2CO3]\n\ndef integrate_case(T, E, C_EC, C_Li, y0):\n    # Solve the ODE system; use a stiff solver for robustness\n    sol = solve_ivp(\n        fun=lambda t, y: microkinetic_rhs(t, y, T, E, C_EC, C_Li),\n        t_span=(0.0, t_end),\n        y0=y0,\n        method='BDF',\n        rtol=1e-9,\n        atol=1e-12,\n        dense_output=False\n    )\n    y_final = sol.y[:, -1]\n    # Clip final coverages to [0,1]\n    y_final = np.clip(y_final, 0.0, 1.0)\n    # Return LEDC and Li2CO3 final coverages\n    theta_LEDC_f = float(y_final[3])\n    theta_Li2CO3_f = float(y_final[4])\n    return theta_LEDC_f, theta_Li2CO3_f\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: General case\n        (298.0, -0.5, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case 2: Low temperature\n        (250.0, -0.5, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case 3: Less reducing potential\n        (298.0, -0.1, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case 4: Pre-passivated surface\n        (298.0, -0.5, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.2, 0.2]),\n        # Case 5: Strongly reducing potential\n        (298.0, -1.0, 1000.0, 1000.0, [0.0, 0.0, 0.0, 0.0, 0.0]),\n    ]\n\n    results = []\n    for T, E, C_EC, C_Li, y0 in test_cases:\n        theta_LEDC_f, theta_Li2CO3_f = integrate_case(T, E, C_EC, C_Li, y0)\n        results.append([theta_LEDC_f, theta_Li2CO3_f])\n\n    # Format the output: each inner list values rounded to three decimals\n    formatted_cases = []\n    for pair in results:\n        formatted_cases.append(\"[\" + \",\".join(f\"{x:.3f}\" for x in pair) + \"]\")\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```"
        }
    ]
}