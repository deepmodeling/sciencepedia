{
    "hands_on_practices": [
        {
            "introduction": "Before simulating the dynamic behavior of a battery, it is crucial to define a physically consistent starting point. This exercise guides you through establishing the initial conditions for a single-particle model that is at equilibrium, corresponding to a state of zero applied current. By applying first principles of diffusion and electrochemistry, you will determine the concentration profiles and overpotentials, reinforcing the fundamental link between the model's mathematical state and its physical meaning at rest .",
            "id": "4258880",
            "problem": "Consider a single-particle model for both the positive and negative electrodes in a lithium-ion cell. Let the solid-phase lithium concentration in the spherical active particles of the positive and negative electrodes be denoted by $c_{s,p}(r,t)$ and $c_{s,n}(r,t)$, respectively, where $r$ is the radial coordinate and $t$ is time. The volume-averaged solid concentrations are $\\bar{c}_{s,p}(t)$ and $\\bar{c}_{s,n}(t)$, and the corresponding stoichiometries are defined by $\\theta_{p}(t) = \\bar{c}_{s,p}(t)/c_{s,\\max,p}$ and $\\theta_{n}(t) = \\bar{c}_{s,n}(t)/c_{s,\\max,n}$, where $c_{s,\\max,p}$ and $c_{s,\\max,n}$ are the maximum site concentrations in the positive and negative electrode particles. The interfacial overpotentials at the positive and negative electrodes are $\\eta_{p}(t)$ and $\\eta_{n}(t)$.\n\nAssume the following physically realistic parameters at time $t=0$:\n- Positive electrode maximum concentration $c_{s,\\max,p} = 2.5 \\times 10^{4}$ in $\\mathrm{mol\\,m^{-3}}$.\n- Negative electrode maximum concentration $c_{s,\\max,n} = 3.1 \\times 10^{4}$ in $\\mathrm{mol\\,m^{-3}}$.\n- Initial stoichiometries $\\theta_{p}(0) = 0.55$ and $\\theta_{n}(0) = 0.80$.\n- Particle radii $R_{p} = 2.0 \\times 10^{-6}$ in $\\mathrm{m}$ and $R_{n} = 5.0 \\times 10^{-6}$ in $\\mathrm{m}$.\n- Temperature $T$ is constant and finite, exchange current densities are finite and nonzero at $t=0$, and electrolyte and solid ohmic resistances are finite.\n\nYou are told that the externally applied current satisfies $I(0) = 0$ and the measured cell voltage satisfies $V(0) = U_{p}(\\theta_{p}(0)) - U_{n}(\\theta_{n}(0))$, where $U_{p}(\\cdot)$ and $U_{n}(\\cdot)$ denote the open-circuit equilibrium potentials of the positive and negative electrodes as functions of stoichiometry.\n\nUsing first principles appropriate to the single-particle model (spherical diffusion in the solid phase, no-flux boundary condition under zero interfacial molar flux, and standard charge-transfer kinetics at the interface), construct initial conditions that are strictly consistent with $I(0) = 0$ and $V(0) = U_{p}(\\theta_{p}(0)) - U_{n}(\\theta_{n}(0))$. Specifically, determine:\n- The initial solid concentration fields $c_{s,p}(r,0)$ and $c_{s,n}(r,0)$ over $0 \\le r \\le R_{p}$ and $0 \\le r \\le R_{n}$.\n- The corresponding volume-averaged concentrations $\\bar{c}_{s,p}(0)$ and $\\bar{c}_{s,n}(0)$.\n- The interfacial overpotentials $\\eta_{p}(0)$ and $\\eta_{n}(0)$.\n\nProvide the final answer in the ordered row matrix $\\big[c_{s,p}(r,0),\\ c_{s,n}(r,0),\\ \\bar{c}_{s,p}(0),\\ \\bar{c}_{s,n}(0),\\ \\eta_{p}(0),\\ \\eta_{n}(0)\\big]$. Express concentrations in $\\mathrm{mol\\,m^{-3}}$ and overpotentials in volts. Round all numerical values in your final answer to four significant figures.",
            "solution": "The problem asks for the initial conditions of a single-particle model for a lithium-ion cell at time $t=0$, given that the externally applied current is zero, $I(0)=0$, and the cell voltage is at its open-circuit value, $V(0) = U_{p}(\\theta_{p}(0)) - U_{n}(\\theta_{n}(0))$. These conditions signify that the cell is in a state of electrochemical equilibrium at $t=0$. We will deduce the values of the requested quantities from the physical implications of this equilibrium state.\n\nFirst, we determine the solid-phase concentration profiles, $c_{s,p}(r,0)$ and $c_{s,n}(r,0)$.\nThe transport of lithium within the spherical active material particles is governed by Fick's second law of diffusion in spherical coordinates:\n$$ \\frac{\\partial c_s(r,t)}{\\partial t} = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}\\left( D_s r^2 \\frac{\\partial c_s(r,t)}{\\partial r} \\right) $$\nwhere $D_s$ is the solid-phase diffusion coefficient. The boundary conditions are:\n1.  Symmetry at the particle center ($r=0$): $\\frac{\\partial c_s}{\\partial r}\\Big|_{r=0} = 0$.\n2.  Flux at the particle surface ($r=R$): $-D_s \\frac{\\partial c_s}{\\partial r}\\Big|_{r=R} = j_n(t)$, where $j_n(t)$ is the molar flux of lithium ions across the solid-electrolyte interface.\n\nThe total applied current $I(t)$ is directly proportional to the total interfacial flux integrated over the electrode area. In the context of the single-particle model, a zero applied current, $I(0)=0$, implies that the local molar flux at the particle surface is zero for both electrodes at $t=0$. That is, $j_{n,p}(0)=0$ and $j_{n,n}(0)=0$.\n\nApplying this to the surface boundary condition gives, for both positive and negative electrode particles:\n$$ \\frac{\\partial c_s}{\\partial r}\\Big|_{r=R} = 0 \\quad \\text{at } t=0 $$\nA system described by the diffusion equation with no-flux conditions at all boundaries ($r=0$ and $r=R$) can only be in a steady state if the concentration profile is spatially uniform. Any existing gradient would cause diffusive flux, relaxing the system toward uniformity. Since the system is at equilibrium at $t=0$, there can be no internal fluxes, which implies there are no concentration gradients. Thus, the concentration profile must be flat:\n$$ \\frac{\\partial c_s(r,0)}{\\partial r} = 0 \\quad \\text{for } 0 \\le r \\le R $$\nThis means that the initial concentration is constant with respect to the radial position $r$ in each electrode particle. Let these constants be $C_p$ and $C_n$, so $c_{s,p}(r,0) = C_p$ and $c_{s,n}(r,0) = C_n$.\n\nNext, we relate these uniform concentration profiles to the given volume-averaged stoichiometries. The volume-averaged concentration, $\\bar{c}_{s}(t)$, is defined as:\n$$ \\bar{c}_{s}(t) = \\frac{\\int_0^R c_s(r,t) 4\\pi r^2 dr}{\\int_0^R 4\\pi r^2 dr} = \\frac{3}{R^3} \\int_0^R c_s(r,t) r^2 dr $$\nIf $c_s(r,0)$ is a constant, say $C$, then the average concentration is:\n$$ \\bar{c}_{s}(0) = \\frac{3}{R^3} \\int_0^R C r^2 dr = \\frac{3C}{R^3} \\left[ \\frac{r^3}{3} \\right]_0^R = C $$\nTherefore, the initial uniform concentration in each particle is equal to the initial volume-averaged concentration. We can calculate these from the given initial stoichiometries, $\\theta_{p}(0)$ and $\\theta_{n}(0)$:\n$$ \\bar{c}_{s,p}(0) = \\theta_{p}(0) \\times c_{s,\\max,p} = 0.55 \\times (2.5 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}) = 13750 \\, \\mathrm{mol\\,m^{-3}} $$\n$$ \\bar{c}_{s,n}(0) = \\theta_{n}(0) \\times c_{s,\\max,n} = 0.80 \\times (3.1 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}) = 24800 \\, \\mathrm{mol\\,m^{-3}} $$\nThus, we have:\n$c_{s,p}(r,0) = \\bar{c}_{s,p}(0) = 1.375 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}$.\n$c_{s,n}(r,0) = \\bar{c}_{s,n}(0) = 2.480 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}$.\nThe values are expressed to four significant figures as requested for the final answer.\n\nNow, we determine the initial interfacial overpotentials, $\\eta_p(0)$ and $\\eta_n(0)$. The charge-transfer reaction at the particle-electrolyte interface is driven by the overpotential, $\\eta$. The relationship is described by the Butler-Volmer equation for the local current density, $i_{loc}$, which is proportional to the molar flux $j_n$:\n$$ i_{loc} = F j_n = i_0 \\left( \\exp\\left(\\frac{\\alpha_a F \\eta}{RT}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta}{RT}\\right) \\right) $$\nHere, $F$ is the Faraday constant, $R$ is the gas constant, $T$ is temperature, $\\alpha_a$ and $\\alpha_c$ are transfer coefficients, and $i_0$ is the exchange current density. We are given that at $t=0$, the temperature $T$ is finite and the exchange current densities $i_{0,p}$ and $i_{0,n}$ are finite and non-zero.\nAs established, $I(0)=0$ implies $j_n(0)=0$, which in turn means $i_{loc}(0)=0$ for both electrodes. The Butler-Volmer equation becomes:\n$$ 0 = i_0 \\left( \\exp\\left(\\frac{\\alpha_a F \\eta(0)}{RT}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta(0)}{RT}\\right) \\right) $$\nSince $i_0 \\ne 0$, the term in the parenthesis must be zero:\n$$ \\exp\\left(\\frac{\\alpha_a F \\eta(0)}{RT}\\right) = \\exp\\left(-\\frac{\\alpha_c F \\eta(0)}{RT}\\right) $$\nThis equality holds if and only if the exponents are equal. Assuming $\\alpha_a + \\alpha_c \\ne 0$ (which is always true, typically $\\alpha_a + \\alpha_c = 1$), this requires the overpotential to be zero.\nTherefore, for both electrodes:\n$$ \\eta_p(0) = 0 \\ \\mathrm{V} $$\n$$ \\eta_n(0) = 0 \\ \\mathrm{V} $$\n\nFinally, we check for consistency with the given cell voltage. The general expression for the cell voltage in the single-particle model is:\n$$ V(t) = U_p(c_{s,p,surf}(t)) - U_n(c_{s,n,surf}(t)) + \\eta_p(t) - \\eta_n(t) $$\nAt $t=0$, we have found that $\\eta_p(0)=0$ and $\\eta_n(0)=0$. Also, due to the uniform concentration profiles, the surface concentrations are equal to the average concentrations: $c_{s,p,surf}(0) = \\bar{c}_{s,p}(0)$ and $c_{s,n,surf}(0) = \\bar{c}_{s,n}(0)$. Consequently, the equilibrium potentials, which are functions of surface stoichiometry, can be evaluated using the average stoichiometries: $U_p(c_{s,p,surf}(0)) = U_p(\\theta_p(0))$ and $U_n(c_{s,n,surf}(0)) = U_n(\\theta_n(0))$.\nSubstituting these into the voltage equation at $t=0$ gives:\n$$ V(0) = U_p(\\theta_p(0)) - U_n(\\theta_n(0)) + 0 - 0 = U_p(\\theta_p(0)) - U_n(\\theta_n(0)) $$\nThis matches the initial condition provided in the problem statement, confirming that our derived initial state is correct and consistent. The provided particle radii $R_p$ and $R_n$ are not needed for this particular calculation but are essential parameters for transient simulations where $I(t) \\ne 0$.\n\nThe requested initial conditions are:\n- $c_{s,p}(r,0) = 1.375 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}$\n- $c_{s,n}(r,0) = 2.480 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}$\n- $\\bar{c}_{s,p}(0) = 1.375 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}$\n- $\\bar{c}_{s,n}(0) = 2.480 \\times 10^4 \\, \\mathrm{mol\\,m^{-3}}$\n- $\\eta_p(0) = 0 \\ \\mathrm{V}$\n- $\\eta_n(0) = 0 \\ \\mathrm{V}$\n\nWe assemble these values into the specified row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.375 \\times 10^{4}  2.480 \\times 10^{4}  1.375 \\times 10^{4}  2.480 \\times 10^{4}  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Translating the continuous physics of diffusion into a discrete numerical simulation requires careful implementation to preserve fundamental laws like mass conservation. This hands-on coding practice challenges you to compare a naive finite-difference scheme with a conservative finite-volume method for solving the SPM's diffusion equation. By analyzing the mass conservation error in each approach, you will gain a practical understanding of why flux-based conservative schemes are essential for building robust and accurate physics-based battery models .",
            "id": "4258857",
            "problem": "Consider the Single Particle Model (SPM) for intercalation in a spherical active material particle, which is governed by Fickian diffusion under spherical symmetry. The fundamental base consists of Fick's first law and the species continuity equation. In spherical symmetry, let $c_s(r,t)$ denote the solid-phase lithium concentration in $\\mathrm{mol\\,m^{-3}}$, $D_s$ the solid-phase diffusion coefficient in $\\mathrm{m}^2/\\mathrm{s}$, $r$ the radial coordinate in $\\mathrm{m}$ with $0 \\le r \\le R$, and $t$ the time in $\\mathrm{s}$. The governing equation is the species continuity equation with Fick's law, written in spherical coordinates as\n$$\\frac{\\partial c_s}{\\partial t} = \\frac{D_s}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial c_s}{\\partial r}\\right), \\quad 0  r  R, \\quad t  0.$$\nThe boundary conditions are symmetry at the center,\n$$\\frac{\\partial c_s}{\\partial r}\\bigg|_{r=0} = 0,$$\nand an applied surface molar flux at the particle radius,\n$$-D_s \\frac{\\partial c_s}{\\partial r}\\bigg|_{r=R} = j(t),$$\nwhere $j(t)$ has units $\\mathrm{mol}/(\\mathrm{m}^2\\cdot\\mathrm{s})$ and is defined as positive when directed outward from the solid.\n\nDefine the total moles of lithium within the particle as\n$$m(t) = \\int_0^R c_s(r,t)\\,4\\pi r^2\\,dr.$$\nFrom the fundamental laws, the exact continuum evolution of $m(t)$ must satisfy\n$$\\frac{d m(t)}{dt} = -4\\pi R^2\\,j(t).$$\nIn numerical discretizations, naive pointwise finite differences of the spherical Laplacian can violate this exact mass balance due to non-conservative treatment of fluxes, particularly near $r=0$ and $r=R$.\n\nYour task is to write a complete, runnable program that:\n- Implements two explicit time-marching discretizations on a uniform radial grid:\n  1. A naive centered finite difference scheme for the spherical Laplacian $\\frac{\\partial^2 c_s}{\\partial r^2} + \\frac{2}{r}\\frac{\\partial c_s}{\\partial r}$ evaluated at radial nodes, enforcing $\\frac{\\partial c_s}{\\partial r}\\big|_{r=0}=0$ via a ghost cell and imposing the Neumann boundary condition at $r=R$ via a ghost cell that enforces $-D_s \\frac{\\partial c_s}{\\partial r}\\big|_{r=R} = j(t)$ at the boundary face using a first-order difference. This scheme updates pointwise values $c_s(r_i,t)$.\n  2. A conservative finite volume scheme that evolves cell averages $\\bar{c}_i(t)$ over spherical shells with faces at $r_{f,i}$ and centers at $r_i$, using fluxes $F_{i+1/2}(t)$ across faces computed by $F_{i+1/2}(t) = -D_s\\,A_{i+1/2}\\,\\frac{\\bar{c}_{i+1}-\\bar{c}_i}{\\Delta r}$ for interior faces, $F_{1/2}(t)=0$ at $r=0$, and $F_{N+1/2}(t)=A_R\\,j(t)$ at $r=R$, where $A_{i+1/2}=4\\pi r_{f,i+1/2}^2$ and $A_R=4\\pi R^2$. Update the cell averages via\n  $$\\bar{c}_i^{n+1} = \\bar{c}_i^n + \\Delta t \\frac{F_{i-1/2}^n - F_{i+1/2}^n}{V_i},$$\n  with $V_i = \\frac{4\\pi}{3}\\left(r_{f,i+1/2}^3 - r_{f,i-1/2}^3\\right)$ the shell volume.\n- For each scheme, computes the numerical total moles $m_{\\text{num}}(T)$ at final time $T$ via a shell-volume-weighted sum,\n  $$m_{\\text{num}}(T) \\approx \\sum_i \\bar{c}_i(T)\\,V_i,$$\n  using the same shell volumes $V_i$ for both schemes (with point values treated as approximations to shell averages in the naive scheme for the purpose of integration).\n- Computes the exact mass change induced by the applied flux using the discrete-time integral of $j(t)$ over the simulation,\n  $$m_{\\text{exact}}(T) = m(0) - 4\\pi R^2 \\sum_{n} j(t_n)\\,\\Delta t.$$\n- Reports the absolute mass conservation error for each scheme at $t=T$ as\n  $$e_{\\text{naive}} = \\left|m_{\\text{num,naive}}(T) - m_{\\text{exact}}(T)\\right|, \\quad e_{\\text{cons}} = \\left|m_{\\text{num,cons}}(T) - m_{\\text{exact}}(T)\\right|.$$\n\nUse the following scientifically realistic test suite. All physical units must be strictly adhered to as specified.\n\n- Test case $1$ (general case, moderate resolution):\n  - Particle radius $R = 5 \\times 10^{-6}\\,\\mathrm{m}$.\n  - Diffusion coefficient $D_s = 1 \\times 10^{-13}\\,\\mathrm{m}^2/\\mathrm{s}$.\n  - Number of radial control volumes $N = 21$.\n  - Time step $\\Delta t = 1 \\times 10^{-3}\\,\\mathrm{s}$.\n  - Final time $T = 0.2\\,\\mathrm{s}$.\n  - Initial concentration $c_s(r,0) = c_0 = 2.0 \\times 10^{4}\\,\\mathrm{mol\\,m^{-3}}$ uniform.\n  - Applied flux $j(t) = j_0$ constant with $j_0 = 1.0 \\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot\\mathrm{s})$.\n\n- Test case $2$ (edge case, coarse spatial resolution):\n  - Particle radius $R = 5 \\times 10^{-6}\\,\\mathrm{m}$.\n  - Diffusion coefficient $D_s = 1 \\times 10^{-13}\\,\\mathrm{m}^2/\\mathrm{s}$.\n  - Number of radial control volumes $N = 5$.\n  - Time step $\\Delta t = 2 \\times 10^{-3}\\,\\mathrm{s}$.\n  - Final time $T = 0.2\\,\\mathrm{s}$.\n  - Initial concentration $c_s(r,0) = c_0 = 2.0 \\times 10^{4}\\,\\mathrm{mol\\,m^{-3}}$ uniform.\n  - Applied flux $j(t) = j_0$ constant with $j_0 = 1.0 \\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot\\mathrm{s})$.\n\n- Test case $3$ (time-varying flux, zero net over integral number of periods):\n  - Particle radius $R = 5 \\times 10^{-6}\\,\\mathrm{m}$.\n  - Diffusion coefficient $D_s = 1 \\times 10^{-13}\\,\\mathrm{m}^2/\\mathrm{s}$.\n  - Number of radial control volumes $N = 21$.\n  - Time step $\\Delta t = 5 \\times 10^{-4}\\,\\mathrm{s}$.\n  - Final time $T = 0.2\\,\\mathrm{s}$.\n  - Initial concentration $c_s(r,0) = c_0 = 2.0 \\times 10^{4}\\,\\mathrm{mol\\,m^{-3}}$ uniform.\n  - Applied flux $j(t) = j_0 \\sin\\left(2\\pi t / \\tau\\right)$ with $j_0 = 1.0 \\times 10^{-5}\\,\\mathrm{mol}/(\\mathrm{m}^2\\cdot\\mathrm{s})$ and $\\tau = 5.0 \\times 10^{-2}\\,\\mathrm{s}$.\n\nYour program must:\n- Use an explicit Euler time integrator for both schemes on a uniform radial mesh defined by faces $r_{f,i} = i \\Delta r$ for $i = 0,1,\\dots,N$, with $\\Delta r = R/N$, and cell centers $r_i = (r_{f,i} + r_{f,i+1})/2$.\n- For the naive scheme, treat the point values at the same $r_i$ as in the conservative scheme and compute the spherical Laplacian via discrete approximations to $\\frac{\\partial^2 c_s}{\\partial r^2}$ and $\\frac{2}{r}\\frac{\\partial c_s}{\\partial r}$, using ghost values to implement the boundary conditions.\n- Aggregate the results for all test cases into a single line of output containing the $6$ floating-point errors $[e_{\\text{naive},1},e_{\\text{cons},1},e_{\\text{naive},2},e_{\\text{cons},2},e_{\\text{naive},3},e_{\\text{cons},3}]$ as a comma-separated list enclosed in square brackets. Express all errors in $\\mathrm{mol}$ as decimal floats.\n\nThe program must be completely self-contained, require no user input, and adhere to the specified units and output format.",
            "solution": "We begin from the fundamental laws of diffusion and mass conservation. Fick's first law states that the molar flux density is $\\mathbf{N} = -D_s \\nabla c_s$, and the species continuity equation is $\\frac{\\partial c_s}{\\partial t} + \\nabla \\cdot \\mathbf{N} = 0$. Under spherical symmetry, the divergence in spherical coordinates reduces to\n$$\\nabla \\cdot \\mathbf{N} = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 N_r\\right) = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}\\left(-D_s r^2 \\frac{\\partial c_s}{\\partial r}\\right),$$\nso the governing partial differential equation is\n$$\\frac{\\partial c_s}{\\partial t} = \\frac{D_s}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial c_s}{\\partial r}\\right), \\quad 0  r  R.$$\nAt the center, symmetry implies $\\frac{\\partial c_s}{\\partial r}\\big|_{r=0} = 0$. At the surface, the Neumann boundary condition relates the outward molar flux to the gradient, $-D_s \\frac{\\partial c_s}{\\partial r}\\big|_{r=R} = j(t)$.\n\nDefine the total moles in the particle:\n$$m(t) = \\int_0^R c_s(r,t)\\,4\\pi r^2\\,dr.$$\nDifferentiate with respect to time and substitute the governing equation:\n$$\\frac{d m}{dt} = \\int_0^R \\frac{\\partial c_s}{\\partial t}\\,4\\pi r^2\\,dr = \\int_0^R 4\\pi D_s \\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial c_s}{\\partial r}\\right)\\,dr.$$\nBy the fundamental theorem of calculus,\n$$\\frac{d m}{dt} = 4\\pi D_s \\left[r^2 \\frac{\\partial c_s}{\\partial r}\\right]_{r=0}^{r=R}.$$\nUsing the center symmetry condition, $r^2 \\frac{\\partial c_s}{\\partial r}\\big|_{r=0} = 0$, and the surface flux condition, $-D_s \\frac{\\partial c_s}{\\partial r}\\big|_{r=R} = j(t)$, we obtain the exact mass balance:\n$$\\frac{d m}{dt} = -4\\pi R^2 j(t).$$\nThis identity expresses mass conservation in integral form and shows that internal diffusion redistributes concentration but does not alter the total mass; only the applied surface flux changes $m(t)$.\n\nA naive discretization of the spherical Laplacian uses pointwise finite differences for $\\frac{\\partial^2 c_s}{\\partial r^2}$ and $(2/r)\\frac{\\partial c_s}{\\partial r}$:\n$$\\left.\\frac{\\partial^2 c_s}{\\partial r^2}\\right|_{r=r_i} \\approx \\frac{c_{i+1} - 2 c_i + c_{i-1}}{\\Delta r^2}, \\quad \\left.\\frac{\\partial c_s}{\\partial r}\\right|_{r=r_i} \\approx \\frac{c_{i+1} - c_{i-1}}{2 \\Delta r},$$\nwith $r_i$ uniformly spaced, $\\Delta r = R/N$, and ghost nodes used to impose $\\frac{\\partial c_s}{\\partial r}\\big|_{r=0}=0$ and $-D_s \\frac{\\partial c_s}{\\partial r}\\big|_{r=R}=j(t)$. The explicit Euler update at each point is then\n$$c_i^{n+1} = c_i^n + \\Delta t\\,D_s\\left(\\frac{c_{i+1}^n - 2 c_i^n + c_{i-1}^n}{\\Delta r^2} + \\frac{2}{r_i}\\frac{c_{i+1}^n - c_{i-1}^n}{2\\Delta r}\\right),$$\nwith appropriate ghost values. While consistent for the differential equation in the continuum limit, this \"naive\" pointwise approach does not ensure that the shell-volume-weighted sum $\\sum_i c_i^n V_i$ evolves in lockstep with the applied boundary flux, because the discrete operator is not constructed as a divergence of fluxes across control-volume faces. Specifically, when summing $D_s\\left(\\frac{c_{i+1}-2c_i+c_{i-1}}{\\Delta r^2} + \\frac{2}{r_i}\\frac{c_{i+1}-c_{i-1}}{2\\Delta r}\\right)$ weighted by the shell volumes $V_i$, the terms do not telescope to yield the net boundary flux multiplied by $4\\pi R^2$. This creates a discrete mass conservation error that accumulates over time, particularly for coarse spatial grids or when the $(2/r)$ term is handled crudely near $r=0$.\n\nThe principle-based correction is to discretize the conservation law in flux form via the finite volume method. Partition the particle into $N$ spherical shells with faces at $r_{f,i} = i\\Delta r$ for $i=0,1,\\dots,N$, and centers at $r_i = (r_{f,i} + r_{f,i+1})/2$. Define the shell volume $V_i = \\frac{4\\pi}{3}\\left(r_{f,i+1}^3 - r_{f,i}^3\\right)$ and the face area $A_{i+1/2} = 4\\pi r_{f,i+1}^2$. The finite volume update for the cell-average concentration $\\bar{c}_i$ uses the discrete divergence of face fluxes:\n$$\\bar{c}_i^{n+1} = \\bar{c}_i^n + \\Delta t\\,\\frac{F_i^n - F_{i+1}^n}{V_i},$$\nwhere $F_j^n$ is the outward molar flux across face $j$ at time step $n$. For interior faces $j=1,2,\\dots,N-1$, we use a centered gradient,\n$$F_j^n = -D_s\\,A_j\\,\\frac{\\bar{c}_{i+1}^n - \\bar{c}_i^n}{\\Delta r},$$\nwith $i=j-1$ and $A_j = 4\\pi r_{f,j}^2$. At the inner face, symmetry dictates $F_0^n = 0$ (or equivalently $A_0 = 0$). At the outer face, the applied boundary condition prescribes $F_N^n = A_R\\,j(t_n)$ with $A_R = 4\\pi R^2$. Summing the updates over all shells yields\n$$\\sum_i V_i \\left(\\bar{c}_i^{n+1} - \\bar{c}_i^n\\right) = \\Delta t \\sum_i \\left(F_i^n - F_{i+1}^n\\right) = \\Delta t\\left(F_0^n - F_N^n\\right) = -\\Delta t\\,A_R\\,j(t_n),$$\nwhich telescopes exactly. Therefore, the discrete total mass $m^n = \\sum_i \\bar{c}_i^n V_i$ obeys\n$$m^{n+1} - m^n = -\\Delta t\\,A_R\\,j(t_n),$$\nand by accumulation,\n$$m^{N_t} = m^0 - A_R \\sum_{n=0}^{N_t-1} j(t_n)\\,\\Delta t,$$\nmatching the exact integral relation derived from the fundamental laws, up to machine precision.\n\nAlgorithmic design:\n- Use a uniform mesh for both schemes to allow direct comparison and use the same shell volumes $V_i$ to approximate the integral $\\int_0^R c_s(r,t)\\,4\\pi r^2\\,dr$ for both schemes.\n- Implement the naive centered finite difference update with ghost nodes:\n  - At $r=0$, impose $\\frac{\\partial c_s}{\\partial r}=0$ via a mirrored ghost $c_{-1} = c_0$.\n  - At $r=R$, impose $-D_s \\frac{\\partial c_s}{\\partial r}=j(t)$ via a ghost $c_{N} = c_{N-1} - \\frac{j(t)\\Delta r}{D_s}$, approximating $\\frac{\\partial c_s}{\\partial r}\\big|_{r=R} \\approx \\frac{c_N - c_{N-1}}{\\Delta r}$.\n  - Update $c_i$ using $D_s\\left(\\frac{c_{i+1}-2c_i+c_{i-1}}{\\Delta r^2} + \\frac{2}{r_i}\\frac{c_{i+1}-c_{i-1}}{2\\Delta r}\\right)$ at each center $r_i$.\n- Implement the conservative finite volume update using face fluxes $F_j$ as described; at interior faces use centered gradients, at $r=0$ set $F_0=0$, and at $r=R$ set $F_N=A_R\\,j(t)$.\n- Integrate in time using explicit Euler with the specified $\\Delta t$ and $T$, computing the discrete-time integral of $j(t)$ via $\\sum_n j(t_n)\\Delta t$ to form $m_{\\text{exact}}(T)=m(0) - A_R \\sum_n j(t_n)\\Delta t$.\n- For each test case, compute error metrics $e_{\\text{naive}}$ and $e_{\\text{cons}}$ as absolute differences between $m_{\\text{num}}(T)$ and $m_{\\text{exact}}(T)$, in $\\mathrm{mol}$.\n\nThe test suite covers:\n- A general case with moderate resolution and constant flux to show the naive scheme's accumulation of mass error versus the conservative scheme's exact balance.\n- An edge case with coarse resolution where the naive scheme's violation is magnified, demonstrating sensitivity to spatial discretization.\n- A time-varying flux over an integer number of periods with zero net mass change, highlighting that the conservative scheme produces near-zero error while the naive scheme can drift.\n\nThe final output must be a single line containing the six errors for the three cases in the exact format $[e_{\\text{naive},1},e_{\\text{cons},1},e_{\\text{naive},2},e_{\\text{cons},2},e_{\\text{naive},3},e_{\\text{cons},3}]$, with each value expressed in $\\mathrm{mol}$ as a decimal float.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef make_geometry(R, N):\n    \"\"\"\n    Construct uniform spherical shell geometry:\n    - Faces at r_f[i] = i*dr, i=0..N\n    - Centers at r_c[i] = (r_f[i] + r_f[i+1])/2, i=0..N-1\n    - Volumes V_i = 4/3*pi*(r_f[i+1]^3 - r_f[i]^3)\n    - Face areas A_j = 4*pi*r_f[j]^2\n    \"\"\"\n    dr = R / N\n    r_f = np.linspace(0.0, R, N + 1)                        # face radii\n    r_c = 0.5 * (r_f[:-1] + r_f[1:])                        # cell centers\n    V = (4.0 * np.pi / 3.0) * (r_f[1:]**3 - r_f[:-1]**3)    # shell volumes\n    A_faces = 4.0 * np.pi * r_f**2                          # face areas\n    A_R = A_faces[-1]\n    return dr, r_f, r_c, V, A_faces, A_R\n\ndef simulate_naive(R, D, N, dt, T, c0, j_func):\n    \"\"\"\n    Naive centered finite difference on spherical Laplacian:\n    c_t = D*(c_rr + (2/r)*c_r)\n    Points located at centers r_c.\n    Ghosts:\n      - at r=0: c_-1 = c_0 to enforce dc/dr=0\n      - at r=R: enforce -D * (c_N - c_{N-1})/dr = j(t) - c_N = c_{N-1} - (j*dr)/D\n    \"\"\"\n    dr, r_f, r_c, V, A_faces, A_R = make_geometry(R, N)\n    c = np.full(N, c0, dtype=float)\n    steps = int(round(T / dt))\n    # Accumulate discrete integral of j(t)\n    j_int = 0.0\n    for n in range(steps):\n        t = n * dt\n        j = j_func(t)\n        # Build ghost values\n        c_left_ghost = c[0]  # dc/dr=0 at r=0 - mirrored\n        c_right_ghost = c[-1] - (j * dr) / D  # enforce boundary flux at r=R\n        # Prepare next state\n        c_new = c.copy()\n        # Update loop\n        for i in range(N):\n            # Neighbors including ghosts\n            if i == 0:\n                c_im1 = c_left_ghost\n                c_ip1 = c[i+1]\n            elif i == N - 1:\n                c_im1 = c[i-1]\n                c_ip1 = c_right_ghost\n            else:\n                c_im1 = c[i-1]\n                c_ip1 = c[i+1]\n            # Center radius; avoid division by zero by using r_c[i] (strictly  0)\n            ri = r_c[i]\n            # Second derivative and first derivative approximations\n            d2c = (c_ip1 - 2.0*c[i] + c_im1) / (dr**2)\n            dcdr = (c_ip1 - c_im1) / (2.0*dr)\n            rhs = D * (d2c + (2.0/ri) * dcdr)\n            c_new[i] = c[i] + dt * rhs\n        c = c_new\n        j_int += j * dt\n    # Compute numerical total moles using shell volumes V\n    m_num = float(np.dot(c, V))\n    # Compute exact mass change from boundary flux integral\n    m0 = c0 * (4.0 * np.pi / 3.0) * (R**3)  # initial total moles\n    m_exact = m0 - A_R * j_int\n    err = abs(m_num - m_exact)\n    return err\n\ndef simulate_fv(R, D, N, dt, T, c0, j_func):\n    \"\"\"\n    Conservative finite volume scheme:\n    c_i^{n+1} = c_i^n + dt * (F_i - F_{i+1}) / V_i\n    Fluxes:\n      F_0 = 0 (symmetry)\n      F_j = -D * A_j * (c_{i+1} - c_i) / dr, j=1..N-1\n      F_N = A_R * j(t)\n    \"\"\"\n    dr, r_f, r_c, V, A_faces, A_R = make_geometry(R, N)\n    c = np.full(N, c0, dtype=float)\n    steps = int(round(T / dt))\n    j_int = 0.0\n    for n in range(steps):\n        t = n * dt\n        j = j_func(t)\n        # Compute face fluxes\n        F = np.zeros(N + 1, dtype=float)\n        F[0] = 0.0  # symmetry at center\n        # Interior faces\n        # Using centered gradient between cell centers across face j\n        # Here, r_c spacing equals dr for uniform mesh\n        for j_idx in range(1, N):\n            i_left = j_idx - 1\n            i_right = j_idx\n            grad = (c[i_right] - c[i_left]) / dr\n            F[j_idx] = -D * A_faces[j_idx] * grad\n        # Outer face imposed flux\n        F[N] = A_R * j\n        # Update concentrations\n        c += dt * (F[:-1] - F[1:]) / V\n        j_int += j * dt\n    m_num = float(np.dot(c, V))\n    m0 = c0 * (4.0 * np.pi / 3.0) * (R**3)\n    m_exact = m0 - A_R * j_int\n    err = abs(m_num - m_exact)\n    return err\n\ndef solve():\n    # Define test cases per problem statement\n    # Each case: (R, D, N, dt, T, c0, j_type, params)\n    def j_const(j0):\n        return lambda t: j0\n    def j_sine(j0, tau):\n        return lambda t: j0 * np.sin(2.0 * np.pi * t / tau)\n\n    test_cases = [\n        # Test 1: general case, constant flux\n        (5.0e-6, 1.0e-13, 21, 1.0e-3, 0.2, 2.0e4, 'const', {'j0': 1.0e-5}),\n        # Test 2: coarse resolution, constant flux\n        (5.0e-6, 1.0e-13, 5, 2.0e-3, 0.2, 2.0e4, 'const', {'j0': 1.0e-5}),\n        # Test 3: time-varying flux over integer periods\n        (5.0e-6, 1.0e-13, 21, 5.0e-4, 0.2, 2.0e4, 'sine', {'j0': 1.0e-5, 'tau': 5.0e-2}),\n    ]\n\n    results = []\n    for (R, D, N, dt, T, c0, j_type, params) in test_cases:\n        if j_type == 'const':\n            j_func = j_const(params['j0'])\n        elif j_type == 'sine':\n            j_func = j_sine(params['j0'], params['tau'])\n        else:\n            # Should not happen; default to zero flux\n            j_func = lambda t: 0.0\n\n        err_naive = simulate_naive(R, D, N, dt, T, c0, j_func)\n        err_cons = simulate_fv(R, D, N, dt, T, c0, j_func)\n        results.append(err_naive)\n        results.append(err_cons)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "While detailed PDE models like the SPM are powerful for understanding physics, they are often too computationally expensive for real-time applications like in a Battery Management System (BMS). This practice bridges the gap between detailed simulation and control-oriented modeling by having you analyze a reduced-order state-space model of the SPM. You will assess the model's fundamental properties of controllability and observability, which determine whether the battery's internal states can be effectively controlled by the current and estimated from voltage measurements .",
            "id": "4258910",
            "problem": "Consider a single-particle model for a porous battery electrode in which lithium intercalates into spherical solid particles of radius $R$. The solid-state concentration $c_{s}(r,t)$ obeys spherical diffusion with constant diffusivity $D_{s}$:\n$$\n\\frac{\\partial c_{s}}{\\partial t}(r,t) \\;=\\; D_{s}\\,\\frac{1}{r^{2}}\\,\\frac{\\partial}{\\partial r}\\!\\left(r^{2}\\,\\frac{\\partial c_{s}}{\\partial r}(r,t)\\right), \\quad 0 \\le r \\le R,\n$$\nwith regularity at the center, $\\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=0}=0$, and an imposed interfacial molar flux $J_{s}(t)$ at the surface,\n$$\n-\\,D_{s}\\,\\left.\\frac{\\partial c_{s}}{\\partial r}\\right|_{r=R} \\;=\\; J_{s}(t).\n$$\nThe applied electrode current $I(t)$ acts uniformly on the population of identical particles so that the flux per particle satisfies $J_{s}(t)=\\kappa_{I}\\,I(t)$, where $\\kappa_{I}0$ is a constant that collects geometric factors and the Faraday constant. Define the average and surface concentrations as $c_{s,\\mathrm{avg}}(t) \\equiv \\frac{3}{R^{3}}\\int_{0}^{R} c_{s}(r,t)\\,r^{2}\\,dr$ and $c_{s,\\mathrm{surf}}(t)\\equiv c_{s}(R,t)$.\n\nThe open-circuit potential $U(c_{s,\\mathrm{surf}})$, the charge-transfer overpotential $\\eta_{\\mathrm{ct}}$, and an ohmic drop $I\\,R_{\\Omega}$ determine the terminal voltage $V(t)$ via\n$$\nV(t) \\;=\\; U\\!\\left(c_{s,\\mathrm{surf}}(t)\\right)\\;+\\;\\eta_{\\mathrm{ct}}\\!\\left(J_{s}(t),\\,c_{s,\\mathrm{surf}}(t),\\,t\\right)\\;+\\;I(t)\\,R_{\\Omega}.\n$$\nAssume the Butler–Volmer kinetics are linearizable along a known feasible trajectory $\\big(c_{s,\\mathrm{surf}}(t),J_{s}(t)\\big)=\\big(\\bar{c}_{s,\\mathrm{surf}}(t),\\bar{J}_{s}(t)\\big)$ so that there exists a finite time-varying charge-transfer resistance $R_{\\mathrm{ct}}(t)0$ with small-signal relation $\\delta \\eta_{\\mathrm{ct}}(t)\\approx R_{\\mathrm{ct}}(t)\\,\\delta J_{s}(t)$ about that trajectory. Also, assume $U$ is differentiable and denote $U'\\big(\\bar{c}_{s,\\mathrm{surf}}(t)\\big)$ as the derivative along the trajectory.\n\nFor control-oriented reduced modeling, consider a two-state small-signal representation obtained from a rational (Padé-type) approximation of spherical diffusion that preserves mass balance and approximates the surface dynamics. Let the state be $x(t)\\equiv\\begin{pmatrix}x_{1}(t)\\\\ x_{2}(t)\\end{pmatrix}$ with $x_{1}(t)\\equiv \\delta c_{s,\\mathrm{avg}}(t)$ and $x_{2}(t)\\equiv \\delta\\chi(t)$ defined so that the surface deviation satisfies $\\delta c_{s,\\mathrm{surf}}(t)=x_{1}(t)+x_{2}(t)$. The input is the current deviation $u(t)\\equiv \\delta I(t)$ and the output is the voltage deviation $y(t)\\equiv \\delta V(t)$. The reduced small-signal dynamics take the form\n$$\n\\dot{x}_{1}(t) \\;=\\; -\\,b_{1}\\,u(t), \\qquad \\dot{x}_{2}(t)\\;=\\; -\\,k\\,x_{2}(t)\\;-\\;b_{2}\\,u(t),\n$$\nwhere $b_{1} \\equiv \\frac{3\\,\\kappa_{I}}{R}$ by mass conservation, and $k\\equiv \\alpha\\,\\frac{D_{s}}{R^{2}}$ and $b_{2}\\equiv \\gamma\\,\\kappa_{I}$ for some fixed dimensionless constants $\\alpha0$ and $\\gamma0$ determined by the chosen rational approximation. The small-signal output relation obtained by linearizing $V(t)$ along the trajectory is\n$$\ny(t)\\;=\\;U'\\!\\left(\\bar{c}_{s,\\mathrm{surf}}(t)\\right)\\,\\big(x_{1}(t)+x_{2}(t)\\big)\\;+\\;\\big(R_{\\Omega}+R_{\\mathrm{ct}}(t)\\big)\\,\\kappa_{I}\\,u(t).\n$$\n\nTasks:\n- Starting only from the diffusion law in a sphere, interfacial flux boundary condition, and differentiability of $U$, write the linear time-varying (LTV) state-space model around the trajectory in the form $\\dot{x}(t)=A(t)\\,x(t)+B(t)\\,u(t)$ and $y(t)=C(t)\\,x(t)+D(t)\\,u(t)$, explicitly identifying $A(t)$, $B(t)$, $C(t)$, and $D(t)$ in terms of $b_{1}$, $b_{2}$, $k$, $\\kappa_{I}$, $U'\\!\\left(\\bar{c}_{s,\\mathrm{surf}}(t)\\right)$, $R_{\\Omega}$, and $R_{\\mathrm{ct}}(t)$.\n- Evaluate the instantaneous controllability matrix $\\mathcal{C}(t_{0})\\equiv\\big[B(t_{0})\\;\\;A(t_{0})B(t_{0})\\big]$ and the instantaneous observability matrix $\\mathcal{O}(t_{0})\\equiv\\begin{pmatrix} C(t_{0})\\\\ C(t_{0})A(t_{0})\\end{pmatrix}$ at a time $t_{0}$ on the trajectory where $U'\\!\\left(\\bar{c}_{s,\\mathrm{surf}}(t_{0})\\right)\\neq 0$, $R_{\\mathrm{ct}}(t_{0})0$, and $b_{1}0$, $b_{2}0$, $k0$.\n- Compute the single scalar quantity equal to the product of the ranks of $\\mathcal{C}(t_{0})$ and $\\mathcal{O}(t_{0})$. Express your final answer as a single number with no units. No rounding is required.",
            "solution": "The problem asks us to formulate the given reduced-order dynamics into a standard linear time-varying (LTV) state-space model, and then analyze its controllability and observability.\n\n**Part 1: LTV State-Space Representation**\n\nThe system is described by the state vector $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$, input $u(t) = \\delta I(t)$, and output $y(t) = \\delta V(t)$. The standard LTV state-space form is:\n$$ \\dot{x}(t) = A(t)x(t) + B(t)u(t) $$\n$$ y(t) = C(t)x(t) + D(t)u(t) $$\nThe given state dynamics are:\n$$ \\dot{x}_{1}(t) = -b_{1}u(t) = 0 \\cdot x_1(t) + 0 \\cdot x_2(t) - b_1 u(t) $$\n$$ \\dot{x}_{2}(t) = -k x_{2}(t) - b_{2}u(t) = 0 \\cdot x_1(t) - k \\cdot x_2(t) - b_2 u(t) $$\nWriting these in matrix form gives:\n$$ \\begin{pmatrix} \\dot{x}_{1}(t) \\\\ \\dot{x}_{2}(t) \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  -k \\end{pmatrix} \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix} + \\begin{pmatrix} -b_{1} \\\\ -b_{2} \\end{pmatrix} u(t) $$\nFrom this, we identify the state matrix $A(t)$ and the input matrix $B(t)$. Since the parameters $k$, $b_{1}$, and $b_{2}$ are constants, these matrices are time-invariant:\n$$ A(t) = A = \\begin{pmatrix} 0  0 \\\\ 0  -k \\end{pmatrix}, \\quad B(t) = B = \\begin{pmatrix} -b_{1} \\\\ -b_{2} \\end{pmatrix} $$\nThe given output equation is:\n$$ y(t) = U'(\\bar{c}_{s,\\mathrm{surf}}(t))\\,(x_{1}(t)+x_{2}(t)) + (R_{\\Omega}+R_{\\mathrm{ct}}(t))\\,\\kappa_{I}\\,u(t) $$\nWriting this in matrix form:\n$$ y(t) = \\begin{pmatrix} U'(\\bar{c}_{s,\\mathrm{surf}}(t))  U'(\\bar{c}_{s,\\mathrm{surf}}(t)) \\end{pmatrix} \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix} + \\left( (R_{\\Omega}+R_{\\mathrm{ct}}(t))\\,\\kappa_{I} \\right) u(t) $$\nFrom this, we identify the time-varying output matrix $C(t)$ and feedthrough matrix $D(t)$:\n$$ C(t) = \\begin{pmatrix} U'(\\bar{c}_{s,\\mathrm{surf}}(t))  U'(\\bar{c}_{s,\\mathrm{surf}}(t)) \\end{pmatrix}, \\quad D(t) = (R_{\\Omega}+R_{\\mathrm{ct}}(t))\\kappa_{I} $$\n\n**Part 2: Controllability and Observability Matrices**\n\nWe evaluate the instantaneous controllability matrix $\\mathcal{C}(t_{0}) = \\begin{bmatrix} B(t_{0})  A(t_{0})B(t_{0}) \\end{bmatrix}$ and observability matrix $\\mathcal{O}(t_{0}) = \\begin{pmatrix} C(t_{0}) \\\\ C(t_{0})A(t_{0}) \\end{pmatrix}$.\nFirst, calculate the product $AB$:\n$$ AB = \\begin{pmatrix} 0  0 \\\\ 0  -k \\end{pmatrix} \\begin{pmatrix} -b_{1} \\\\ -b_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ kb_{2} \\end{pmatrix} $$\nThe controllability matrix (which is time-invariant) is:\n$$ \\mathcal{C}(t_{0}) = \\mathcal{C} = \\begin{pmatrix} -b_{1}  0 \\\\ -b_{2}  kb_{2} \\end{pmatrix} $$\nNext, calculate the product $C(t_{0})A(t_{0})$. Let $U'_{0} \\equiv U'(\\bar{c}_{s,\\mathrm{surf}}(t_0))$.\n$$ C(t_{0})A = \\begin{pmatrix} U'_{0}  U'_{0} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  -k \\end{pmatrix} = \\begin{pmatrix} 0  -kU'_{0} \\end{pmatrix} $$\nThe observability matrix at $t_0$ is:\n$$ \\mathcal{O}(t_{0}) = \\begin{pmatrix} U'_{0}  U'_{0} \\\\ 0  -kU'_{0} \\end{pmatrix} $$\n\n**Part 3: Product of Ranks**\n\nThe rank of a square matrix is its dimension if its determinant is non-zero.\nFor the $2 \\times 2$ controllability matrix $\\mathcal{C}$:\n$$ \\det(\\mathcal{C}) = (-b_{1})(kb_{2}) - (0)(-b_{2}) = -kb_{1}b_{2} $$\nGiven that $k>0$, $b_{1}>0$, and $b_{2}>0$ at $t_{0}$, the determinant is non-zero. Thus, the matrix is full rank:\n$$ \\mathrm{rank}(\\mathcal{C}(t_{0})) = 2 $$\nFor the $2 \\times 2$ observability matrix $\\mathcal{O}(t_0)$:\n$$ \\det(\\mathcal{O}(t_{0})) = (U'_{0})(-kU'_{0}) - (U'_{0})(0) = -k(U'_{0})^{2} $$\nGiven that $k>0$ and $U'_{0} \\neq 0$ at $t_{0}$, the determinant is non-zero. Thus, this matrix is also full rank:\n$$ \\mathrm{rank}(\\mathcal{O}(t_{0})) = 2 $$\nThe product of the ranks is:\n$$ \\mathrm{rank}(\\mathcal{C}(t_{0})) \\times \\mathrm{rank}(\\mathcal{O}(t_{0})) = 2 \\times 2 = 4 $$",
            "answer": "$$\n\\boxed{4}\n$$"
        }
    ]
}