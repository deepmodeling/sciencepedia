{
    "hands_on_practices": [
        {
            "introduction": "泊松-玻尔兹曼理论的核心是静电屏蔽的概念，它由德拜长度（$\\lambda_D$）来量化。这个练习将通过一个包含多种离子的实际电解质缓冲液，来巩固您对德拜长度的理解。通过从基本原理出发推导并计算混合盐溶液中的$\\lambda_D$，您将亲身体会到多价离子是如何对静电屏蔽产生不成比例的巨大影响的 。",
            "id": "3866634",
            "problem": "一种用于生物分子静电学的水性缓冲液，在温度 $T = 298\\,\\mathrm{K}$ 下，含有完全解离且理想的氯化钠（$\\mathrm{NaCl}$）和氯化钙（$\\mathrm{CaCl}_{2}$），其中液态水被视为均匀的介电连续体。其组成为 $0.10\\,\\mathrm{M}$ 氯化钠和 $0.05\\,\\mathrm{M}$ 氯化钙。假设离子为点状离子，宏观电中性，并且对于小静电势，线性响应机制成立。仅从泊松方程和移动离子的玻尔兹曼分布出发，并利用适用于小电势的线性化方法，推导出确定多组分电解质德拜屏蔽长度的屏蔽关系式。然后计算该缓冲液的德拜长度。\n\n使用水的相对介电常数 $\\varepsilon_{r} = 78.37$（在 $T = 298\\,\\mathrm{K}$ 时），真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$，元电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，以及阿伏伽德罗常数 $N_{A} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。将摩尔浓度 $c_{i}$（单位为 $\\mathrm{mol\\,L}^{-1}$）通过 $n_{i} = N_{A} \\times 1000 \\times c_{i}$ 转换为数密度（单位为 $\\mathrm{m}^{-3}$）。\n\n将德拜长度的最终数值以纳米为单位表示，并四舍五入至三位有效数字。在您的计算过程中，简要解释在其他可比条件下，与仅含单价盐的溶液相比，二价钙的存在如何改变屏蔽长度。要求的最终答案是德拜长度的单一数值（以纳米为单位）。",
            "solution": "题目要求推导多组分电解质的德拜屏蔽长度，并随后针对特定的水性缓冲液进行计算。推导从控制离子介质中静电学的基本方程开始。\n\n在具有均匀介电常数 $\\varepsilon$ 的连续介质中，位置 $\\mathbf{r}$ 处的静电势 $\\phi(\\mathbf{r})$ 通过泊松方程与局部电荷密度 $\\rho(\\mathbf{r})$ 相关联：\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho(\\mathbf{r})}{\\varepsilon} $$\n介质的总介电常数是 $\\varepsilon = \\varepsilon_r \\varepsilon_0$，其中 $\\varepsilon_r$ 是溶剂（水）的相对介电常数，$\\varepsilon_0$ 是真空介电常数。电荷密度 $\\rho(\\mathbf{r})$ 来自电解质中移动离子的分布。对于具有多种离子种类的体系，这由对所有种类 $i$ 的求和给出：\n$$ \\rho(\\mathbf{r}) = \\sum_{i} q_i n_i(\\mathbf{r}) $$\n其中 $q_i$ 是种类 $i$ 离子的电荷， $n_i(\\mathbf{r})$ 是其局域数密度。\n\n在热平衡条件下，每种离子种类的局域数密度遵循玻尔兹曼分布：\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{W_i(\\mathbf{r})}{k_B T}\\right) $$\n此处，$n_i^0$ 是种类 $i$ 的体相数密度（远离任何局部电荷源），$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。在位置 $\\mathbf{r}$ 处种类 $i$ 离子的势能为 $W_i(\\mathbf{r}) = q_i \\phi(\\mathbf{r})$。将其代入分布公式可得：\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\n将泊松方程与电荷密度的玻尔兹曼分布相结合，得到泊松-玻尔兹曼方程 (PBE)：\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\exp\\left(-\\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\n题目指定我们处于线性响应机制，其中静电势很小，意味着静电能远小于热能：$|q_i \\phi(\\mathbf{r})| \\ll k_B T$。这允许我们使用泰勒级数展开对指数项进行线性化，对于小 $x$ 有 $\\exp(-x) \\approx 1 - x$：\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\left(1 - \\frac{q_i \\phi(\\mathbf{r})}{k_B T}\\right) $$\n将求和项展开得到：\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\left( \\sum_{i} q_i n_i^0 - \\frac{\\phi(\\mathbf{r})}{k_B T} \\sum_{i} q_i^2 n_i^0 \\right) $$\n括号中的第一项 $\\sum_i q_i n_i^0$ 代表体相溶液中的净电荷密度。体相电解质的一个基本性质是整体电中性，因此该项为零：\n$$ \\sum_{i} q_i n_i^0 = 0 $$\n因此，线性化的PBE简化为德拜-休克尔方程：\n$$ \\nabla^2 \\phi(\\mathbf{r}) = \\left( \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 \\right) \\phi(\\mathbf{r}) $$\n该方程的形式为 $\\nabla^2 \\phi(\\mathbf{r}) = \\kappa^2 \\phi(\\mathbf{r})$，其中 $\\kappa$ 是德拜屏蔽长度的倒数。通过比较这两种形式，我们确定屏蔽参数 $\\kappa^2$ 为：\n$$ \\kappa^2 = \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 $$\n德拜屏蔽长度 $\\lambda_D$ 定义为 $\\lambda_D = 1/\\kappa$。因此，多组分电解质的屏蔽关系式为：\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{\\sum_{i} n_i^0 q_i^2}} $$\n项 $\\sum_i n_i^0 q_i^2$ 量化了离子溶液的屏蔽能力。此和中电荷的平方 $q_i^2$ 的存在至关重要。它表明多价离子对屏蔽的贡献比单价离子不成比例地大。例如，一个二价离子（电荷为 $2e$）对该和的贡献为 $(2e)^2 = 4e^2$，是相同浓度的单价离子（电荷为 $e$）贡献 $e^2$ 的四倍。因此，与仅含单价盐且摩尔浓度相似的溶液相比，指定缓冲液中二价钙的存在将显著增强屏蔽效应（即减小德拜长度）。\n\n现在我们计算给定缓冲液的 $\\lambda_D$。离子种类为钠离子($\\mathrm{Na}^{+}$)、钙离子($\\mathrm{Ca}^{2+}$)和氯离子($\\mathrm{Cl}^{-}$)。它们的电荷分别为 $q_{\\mathrm{Na}^+} = +e$、$q_{\\mathrm{Ca}^{2+}} = +2e$ 和 $q_{\\mathrm{Cl}^-} = -e$，其中 $e$ 是元电荷。\n摩尔浓度 ($c_i$) 已给出：\n$c_{\\mathrm{NaCl}} = 0.10\\,\\mathrm{M}$\n$c_{\\mathrm{CaCl}_2} = 0.05\\,\\mathrm{M}$\n假设完全解离，各离子的浓度为：\n$c_{\\mathrm{Na}^{+}} = 0.10\\,\\mathrm{M}$\n$c_{\\mathrm{Ca}^{2+}} = 0.05\\,\\mathrm{M}$\n$$\nc_{\\mathrm{Cl}^{-}} = c_{\\text{来自 NaCl}} + c_{\\text{来自 CaCl}_2} = 0.10\\,\\mathrm{M} + 2 \\times 0.05\\,\\mathrm{M} = 0.20\\,\\mathrm{M}\n$$\n\n和 $\\sum_i n_i^0 q_i^2$ 可以用摩尔浓度表示。由于 $n_i^0 = c_i N_A \\times 1000$（其中 $c_i$ 的单位为 mol/L，$n_i^0$ 的单位为 m⁻³）且 $q_i = z_i e$（其中 $z_i$ 是化合价），该和变为：\n$$ \\sum_{i} n_i^0 q_i^2 = \\sum_{i} (c_i N_A \\times 1000) (z_i e)^2 = e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2 $$\n我们来计算 $\\sum_i c_i z_i^2$ 这一项：\n$$\n\\sum_{i} c_i z_i^2 = c_{\\mathrm{Na}^{+}} (z_{\\mathrm{Na}^{+}})^2 + c_{\\mathrm{Ca}^{2+}} (z_{\\mathrm{Ca}^{2+}})^2 + c_{\\mathrm{Cl}^{-}} (z_{\\mathrm{Cl}^{-}})^2\n$$\n$$\n\\sum_{i} c_i z_i^2 = (0.10)(+1)^2 + (0.05)(+2)^2 + (0.20)(-1)^2\n$$\n$$\n\\sum_{i} c_i z_i^2 = 0.10 \\times 1 + 0.05 \\times 4 + 0.20 \\times 1 = 0.10 + 0.20 + 0.20 = 0.50\\,\\mathrm{mol\\,L}^{-1}\n$$\n现在，我们可以将德拜长度的表达式写为：\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon_r \\varepsilon_0 k_B T}{e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2}} $$\n我们代入给定的物理常数和计算值：\n$T = 298\\,\\mathrm{K}$\n$\\varepsilon_r = 78.37$\n$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m}^{-1}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$\n$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n$N_A = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n$\\sum_i c_i z_i^2 = 0.50\\,\\mathrm{mol\\,L}^{-1}$\n\n分子： $\\varepsilon_r \\varepsilon_0 k_B T$\n$ = (78.37)(8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m}^{-1})(1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1})(298\\,\\mathrm{K}) $\n$ \\approx 2.85483 \\times 10^{-30}\\,\\mathrm{F\\,J\\,m}^{-1} $\n\n分母： $e^2 N_A \\times 1000 \\sum_i c_i z_i^2$\n$ = (1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2 (6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}) (1000\\,\\mathrm{L\\,m}^{-3}) (0.50\\,\\mathrm{mol\\,L}^{-1}) $\n$ \\approx 7.72836 \\times 10^{-12}\\,\\mathrm{C}^2\\mathrm{m}^{-3} $\n注意分子的单位 F J m⁻¹ 等价于 C² m⁻¹，因为 $J = C \\cdot V$ 且 $F = C/V$，所以 $F \\cdot J = C^2$。\n\n现在，我们计算 $\\lambda_D^2$：\n$$ \\lambda_D^2 = \\frac{2.85483 \\times 10^{-30}\\,\\mathrm{C}^2\\mathrm{m}^{-1}}{7.72836 \\times 10^{-12}\\,\\mathrm{C}^2\\mathrm{m}^{-3}} \\approx 3.6939 \\times 10^{-19}\\,\\mathrm{m}^2 $$\n取平方根求得 $\\lambda_D$：\n$$ \\lambda_D = \\sqrt{3.6939 \\times 10^{-19}\\,\\mathrm{m}^2} \\approx 6.0778 \\times 10^{-10}\\,\\mathrm{m} $$\n题目要求答案以纳米为单位。由于 $1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m}$：\n$$ \\lambda_D \\approx 0.60778\\,\\mathrm{nm} $$\n四舍五入到三位有效数字，我们得到：\n$$ \\lambda_D \\approx 0.608\\,\\mathrm{nm} $$\n该值表示在给定缓冲液中，静电相互作用被移动离子屏蔽的特征长度尺度。",
            "answer": "$$\n\\boxed{0.608}\n$$"
        },
        {
            "introduction": "线性化的泊松-玻尔兹曼方程（或德拜-休克尔理论）为我们提供了一个简洁的解析解，但这只是在小电位情况下的一个近似。这个实践练习旨在通过编程来直接比较线性化模型与完整的非线性泊松-玻尔兹曼模型的预测结果。通过计算不同物理条件下（例如不同表面电荷密度和盐浓度）的表面电位，您将量化线性近似的误差，从而深刻理解其适用范围和局限性 。",
            "id": "3866522",
            "problem": "考虑一个与均匀带电的无限大平面相邻的对称单价电解质。溶剂被视为连续介电质，其相对介电常数为 $\\,\\epsilon\\,$，绝对介电常数为 $\\,\\epsilon\\epsilon_0\\,$，温度为 $\\,T\\,$。设位于 $\\,x=0\\,$ 处的表面带有均匀的自由表面电荷密度 $\\,\\sigma\\,$，电解质占据 $\\,x>0\\,$ 的半空间，其中阳离子和阴离子的体相数浓度均为 $\\,n_0\\,$（因此体相盐浓度为 $\\,c_0=n_0/N_A\\,$，单位为 $\\mathrm{mol\\,m^{-3}}$）。假设系统处于平衡状态且无流体流动。\n\n从计算化学生物学和静电学中的第一性原理出发，具体包括：\n- 高斯定律的微分形式（泊松方程）$\\,\\nabla\\cdot\\left(\\epsilon\\epsilon_0\\nabla\\psi\\right)=-\\rho\\,$，\n- 在静电势 $\\,\\psi(x)\\,$ 中，单价离子的玻尔兹曼分布 $\\,c_\\pm(x)=n_0\\exp\\!\\left(\\mp \\dfrac{e\\psi(x)}{k_B T}\\right)\\,$，\n- 小电势线性化条件下的德拜屏蔽参数的定义，以及\n- 适当的边界条件 $\\,\\psi(\\infty)=0\\,$ 和 $-\\epsilon\\epsilon_0\\,\\psi'(0)=\\sigma\\,$，\n\n请基于这些原理，且不使用任何快捷公式，推导出表面电荷密度 $\\,\\sigma\\,$ 和表面电势 $\\,\\psi_0=\\psi(0)\\,$ 之间的关系，并应用于以下两种情况：\n1. 完整的非线性泊松-玻尔兹曼 (PB) 描述，以及\n2. 小电势范围内的线性化 PB (Debye–Hückel) 描述。\n\n然后，实现一个程序，该程序能够：\n- 使用推导出的关系，为每个给定的测试用例计算非线性 PB 预测的表面电势 $\\,\\psi_0^{\\mathrm{NL}}\\,$ 和线性化 PB 预测的表面电势 $\\,\\psi_0^{\\mathrm{LIN}}\\,$。\n- 将线性预测相对于非线性预测的绝对相对误差量化为小数形式\n$$\\mathrm{err}=\\dfrac{\\left|\\psi_0^{\\mathrm{LIN}}-\\psi_0^{\\mathrm{NL}}\\right|}{\\left|\\psi_0^{\\mathrm{NL}}\\right|}.$$\n- 以 $\\mathrm{V}$ 为单位表示所有电势，并将误差表示为无量纲的小数。\n\n请精确使用以下物理常数：\n- 基本电荷 $\\,e=1.602176634\\times 10^{-19}\\,\\mathrm{C}\\,$，\n- 玻尔兹曼常数 $\\,k_B=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}\\,$，\n- 真空介电常数 $\\,\\epsilon_0=8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}\\,$，\n- 阿伏伽德罗常数 $\\,N_A=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}\\,$，\n- 温度 $\\,T=298\\,\\mathrm{K}\\,$。\n\n您的程序必须处理给定的体相盐浓度 $\\,c_0\\,$（单位 $\\mathrm{mol\\,m^{-3}}$），通过公式 $\\,n_0=N_A c_0\\,$ 将其转换为数浓度 $\\,n_0\\,$（单位 $\\mathrm{m^{-3}}$）。对于线性化的 PB，使用与边界条件一致的平面解，通过德拜屏蔽参数 $\\,\\kappa\\,$ 关联 $\\,\\sigma\\,$ 和 $\\,\\psi_0\\,$，其中对于对称单价电解质，$\\,\\kappa^2=\\dfrac{2 e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\\,$。\n\n测试套件。为覆盖不同范围，请使用以下参数集 $(\\sigma, c_0, \\epsilon)$，其中 $\\,\\sigma\\,$ 单位为 $\\mathrm{C\\,m^{-2}}$，$\\,c_0\\,$ 单位为 $\\mathrm{mol\\,m^{-3}}$，$\\,\\epsilon\\,$ 为无量纲：\n- A 例（典型水溶液，中等电荷，中等盐浓度）：$\\,\\sigma=-2.0\\times 10^{-2}\\,,\\;c_0=100\\,,\\;\\epsilon=78.5\\,$。\n- B 例（小电荷，低盐浓度）：$\\,\\sigma=-1.0\\times 10^{-4}\\,,\\;c_0=1\\,,\\;\\epsilon=78.5\\,$。\n- C 例（大电荷，介电常数降低，中等盐浓度）：$\\,\\sigma=-2.0\\times 10^{-1}\\,,\\;c_0=10\\,,\\;\\epsilon=40\\,$。\n- D 例（中等电荷，高盐浓度）：$\\,\\sigma=-1.0\\times 10^{-2}\\,,\\;c_0=1000\\,,\\;\\epsilon=78.5\\,$。\n- E 例（零电荷边界情况）：$\\,\\sigma=0.0\\,,\\;c_0=100\\,,\\;\\epsilon=78.5\\,$。\n\n最终输出格式。您的程序应生成单行输出，包含一个由列表组成的列表，以逗号分隔。每个内部列表按 $[\\psi_0^{\\mathrm{NL}},\\ \\psi_0^{\\mathrm{LIN}},\\ \\mathrm{err}]$ 的顺序排列，对应相应的测试用例，例如 $[[a_1,b_1,e_1],[a_2,b_2,e_2],\\dots]$。所有 $\\psi_0$ 值必须以 $\\mathrm{V}$ 为单位，所有误差必须是小数形式。",
            "solution": "根据指定标准，用户提供的问题被评估为有效。它在科学上基于静电学和统计力学原理，问题陈述清晰，信息充分，可得出唯一解，并以客观、正式的语言表述。该问题要求推导和应用泊松-玻尔兹曼 (PB) 模型，这是计算化学生物学中的一个标准核心课题。\n\n推导和求解过程如下。\n\n该系统由一个位于 $x=0$ 处、具有均匀表面电荷密度 $\\sigma$ 的无限大平面，以及占据 $x>0$ 半空间的对称单价电解质组成。溶剂是连续介电质，在温度 $T$ 下的相对介电常数为 $\\epsilon$。电解质的体相离子数浓度为 $n_0$。\n\n静电势 $\\psi$ 和电荷密度 $\\rho$ 之间的基本关系由泊松方程给出。对于电势 $\\psi$ 仅随距表面距离 $x$ 变化的一维系统，该方程为：\n$$\n\\frac{d}{dx}\\left(\\varepsilon\\varepsilon_0 \\frac{d\\psi}{dx}\\right) = -\\rho(x)\n$$\n假设介电质是均匀的，$\\varepsilon$ 为常数，方程简化为：\n$$\n\\frac{d^2\\psi}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon\\varepsilon_0}\n$$\n电荷密度 $\\rho(x)$ 来自电解质中的可移动离子。对于对称的 $1:1$ 电解质，阳离子数浓度 $n_+(x)$ 和阴离子数浓度 $n_-(x)$ 由玻尔兹曼分布给出：\n$$\nn_+(x) = n_0 \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_0 \\exp\\left(+\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n其中 $e$ 是基本电荷， $k_B$ 是玻尔兹曼常数， $n_0$ 是每种离子物质的体相数浓度。净电荷密度是阳离子（电荷 $+e$）和阴离子（电荷 $-e$）的电荷贡献之和：\n$$\n\\rho(x) = e n_+(x) - e n_-(x) = e n_0 \\left[ \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right) - \\exp\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\right]\n$$\n使用恒等式 $2\\sinh(y) = e^y - e^{-y}$，电荷密度可以表示为：\n$$\n\\rho(x) = -2en_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n将此代入泊松方程，得到完整的一维非线性泊松-玻尔兹曼 (PB) 方程：\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\varepsilon\\varepsilon_0} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n为了求解该方程以获得表面电荷 $\\sigma$ 与表面电势 $\\psi_0 = \\psi(0)$ 之间的关系，我们使用一种积分技巧。将方程两边同乘以 $2\\frac{d\\psi}{dx}$：\n$$\n2\\frac{d\\psi}{dx}\\frac{d^2\\psi}{dx^2} = \\frac{4en_0}{\\varepsilon\\varepsilon_0} \\frac{d\\psi}{dx} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n方程左边是 $\\left(\\frac{d\\psi}{dx}\\right)^2$ 对 $x$ 的导数。右边也可以表示为一个导数。我们可以写成：\n$$\n\\frac{d}{dx}\\left(\\left(\\frac{d\\psi}{dx}\\right)^2\\right) = \\frac{4n_0 k_B T}{\\varepsilon\\varepsilon_0} \\frac{d}{dx}\\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\n从位置 $x$ 到无穷远处进行积分，并应用在远离表面处电势及其梯度均为零的边界条件，即 $\\psi(\\infty)=0$ 和 $\\left(\\frac{d\\psi}{dx}\\right)_{x\\to\\infty}=0$：\n$$\n\\int_x^\\infty \\frac{d}{dx'}\\left(\\left(\\frac{d\\psi}{dx'}\\right)^2\\right) dx' = \\frac{4n_0 k_B T}{\\varepsilon\\varepsilon_0} \\int_x^\\infty \\frac{d}{dx'}\\left(\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right) dx'\n$$\n$$\n\\left[\\left(\\frac{d\\psi}{dx'}\\right)^2\\right]_x^\\infty = \\frac{4n_0 k_B T}{\\varepsilon\\varepsilon_0} \\left[\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right]_x^\\infty\n$$\n$$\n0 - \\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\varepsilon\\varepsilon_0} \\left(\\cosh(0) - \\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\varepsilon\\varepsilon_0} \\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right) - 1\\right)\n$$\n使用恒等式 $\\cosh(y) - 1 = 2\\sinh^2(y/2)$，我们得到：\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{8n_0 k_B T}{\\varepsilon\\varepsilon_0} \\sinh^2\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\n取平方根得到电场：\n$$\n\\frac{d\\psi}{dx} = -\\text{sgn}(\\psi_0) \\sqrt{\\frac{8n_0 k_B T}{\\varepsilon\\varepsilon_0}} \\left|\\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\\right|\n$$\n一个更简单的处理符号的方法是认识到：当 $\\psi_0>0$ 时，$\\psi(x)$ 减小，因此 $\\psi'  0$；当 $\\psi_00$ 时，$\\psi(x)$ 增大，因此 $\\psi' > 0$。而 $\\sinh(y)$ 与 $y$ 的符号相同。这意味着乘积 $\\psi' \\cdot \\sinh(e\\psi/2k_BT)$ 总是非正的。因此我们取负根：\n$$\n\\frac{d\\psi}{dx} = -\\sqrt{\\frac{8n_0 k_B T}{\\varepsilon\\varepsilon_0}} \\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\n带电表面的边界条件由平面高斯定律导出：$-\\varepsilon\\varepsilon_0 \\left(\\frac{d\\psi}{dx}\\right)_{x=0} = \\sigma$。代入我们在 $x=0$ 处的导数表达式：\n$$\n-\\varepsilon\\varepsilon_0 \\left( -\\sqrt{\\frac{8n_0 k_B T}{\\varepsilon\\varepsilon_0}} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right) \\right) = \\sigma\n$$\n这可以简化为 Grahame 方程，它将表面电荷密度 $\\sigma$ 与表面电势 $\\psi_0$ 联系起来：\n$$\n\\sigma = \\sqrt{8n_0 k_B T \\varepsilon\\varepsilon_0} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right)\n$$\n为了求得完整非线性 PB 模型的表面电势 $\\psi_0^{\\mathrm{NL}}$，我们求解 $\\psi_0$：\n$$\n\\sinh\\left(\\frac{e\\psi_0^{\\mathrm{NL}}}{2k_B T}\\right) = \\frac{\\sigma}{\\sqrt{8n_0 k_B T \\varepsilon\\varepsilon_0}}\n$$\n$$\n\\psi_0^{\\mathrm{NL}} = \\frac{2k_B T}{e} \\text{arsinh}\\left(\\frac{\\sigma}{\\sqrt{8n_0 k_B T \\varepsilon\\varepsilon_0}}\\right)\n$$\n\n对于线性化的 PB (Debye-Hückel) 描述，我们假设电势很小，即 $|e\\psi(x)| \\ll k_B T$。这允许我们进行线性化 $\\sinh(y) \\approx y$。PB 方程变为：\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\varepsilon\\varepsilon_0} \\left(\\frac{e\\psi(x)}{k_B T}\\right) = \\left(\\frac{2e^2 n_0}{\\varepsilon\\varepsilon_0 k_B T}\\right) \\psi(x)\n$$\n这就是线性化的泊松-玻尔兹曼方程。括号中的项是德拜屏蔽参数 $\\kappa$ 的平方：\n$$\n\\kappa^2 = \\frac{2e^2 n_0}{\\varepsilon\\varepsilon_0 k_B T}\n$$\n方程现在是 $\\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi$。其通解为 $\\psi(x) = A e^{-\\kappa x} + B e^{\\kappa x}$。应用边界条件 $\\psi(\\infty)=0$ 要求 $B=0$。因此解为 $\\psi(x) = A e^{-\\kappa x}$。在表面处，$\\psi(0) = \\psi_0 = A$，所以 $\\psi(x) = \\psi_0 e^{-\\kappa x}$。\n\n为了找到 $\\sigma$ 和 $\\psi_0$ 之间的关系，我们使用第二个边界条件 $-\\varepsilon\\varepsilon_0 \\psi'(0) = \\sigma$。导数为 $\\psi'(x) = -\\kappa\\psi_0 e^{-\\kappa x}$，因此 $\\psi'(0) = -\\kappa\\psi_0$。\n$$\n-\\varepsilon\\varepsilon_0(-\\kappa \\psi_0) = \\sigma\n$$\n$$\n\\varepsilon\\varepsilon_0 \\kappa \\psi_0 = \\sigma\n$$\n求解线性化近似下的表面电势 $\\psi_0^{\\mathrm{LIN}}$ 可得：\n$$\n\\psi_0^{\\mathrm{LIN}} = \\frac{\\sigma}{\\varepsilon\\varepsilon_0 \\kappa}\n$$\n程序将使用这些推导出的表达式计算 $\\psi_0^{\\mathrm{NL}}$ 和 $\\psi_0^{\\mathrm{LIN}}$，然后计算相对误差 $\\mathrm{err} = |\\psi_0^{\\mathrm{LIN}} - \\psi_0^{\\mathrm{NL}}| / |\\psi_0^{\\mathrm{NL}}|$。对于 $\\sigma=0$ 的特殊情况，$\\psi_0^{\\mathrm{NL}}$ 和 $\\psi_0^{\\mathrm{LIN}}$ 均为 $0$，误差定义为 $0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates surface potentials for a charged planar surface\n    in an electrolyte using both nonlinear and linearized Poisson-Boltzmann theory.\n    \"\"\"\n\n    # Define physical constants\n    E = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23     # Boltzmann constant in J/K\n    EPS_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    NA = 6.02214076e23   # Avogadro constant in mol^-1\n    T = 298.0              # Temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (sigma, c0, epsilon)\n    # sigma: surface charge density in C/m^2\n    # c0: bulk salt concentration in mol/m^3\n    # epsilon: relative permittivity (dimensionless)\n    test_cases = [\n        (-2.0e-2, 100.0, 78.5),   # Case A\n        (-1.0e-4, 1.0, 78.5),     # Case B\n        (-2.0e-1, 10.0, 40.0),    # Case C\n        (-1.0e-2, 1000.0, 78.5),  # Case D\n        (0.0, 100.0, 78.5),       # Case E\n    ]\n\n    results = []\n    for sigma, c0, epsilon in test_cases:\n        # Convert bulk concentration c0 (mol/m^3) to number density n0 (m^-3)\n        n0 = c0 * NA\n        \n        # Handle the special case where surface charge is zero\n        if sigma == 0.0:\n            psi0_nl = 0.0\n            psi0_lin = 0.0\n            err = 0.0\n            results.append([psi0_nl, psi0_lin, err])\n            continue\n            \n        # --- Nonlinear Poisson-Boltzmann (NL) calculation ---\n        # Formula: psi0_nl = (2 * kB * T / e) * arsinh(sigma / sqrt(8 * n0 * kB * T * epsilon * epsilon0))\n        denom_nl = np.sqrt(8 * n0 * KB * T * epsilon * EPS_0)\n        arg_arsinh = sigma / denom_nl\n        psi0_nl = (2 * KB * T / E) * np.arcsinh(arg_arsinh)\n\n        # --- Linearized Poisson-Boltzmann (LIN) calculation ---\n        # Formula: psi0_lin = sigma / (epsilon * epsilon0 * kappa)\n        # where kappa = sqrt(2 * e^2 * n0 / (epsilon * epsilon0 * kB * T))\n        kappa_sq = (2 * E**2 * n0) / (epsilon * EPS_0 * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        psi0_lin = sigma / (epsilon * EPS_0 * kappa)\n\n        # --- Error Calculation ---\n        # Formula: err = |psi0_lin - psi0_nl| / |psi0_nl|\n        # The case psi0_nl = 0 (i.e., sigma = 0) is handled above.\n        err = np.abs(psi0_lin - psi0_nl) / np.abs(psi0_nl)\n\n        results.append([psi0_nl, psi0_lin, err])\n\n    # Final print statement in the exact required format.\n    # Format each inner list to a string '[v1,v2,v3]' and join them.\n    formatted_results = [\n        f\"[{','.join(f'{val:.8e}' for val in res)}]\" for res in results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然解析解对于理论理解至关重要，但解决现实世界中复杂的静电问题通常需要依赖数值方法。本练习将带您走进计算电化学的核心，要求您为一维泊松-玻尔兹曼方程构建一个有限差分格式。特别地，您将推导在非均匀网格上的离散化方案，这是一种在实际计算中为了提高靠近带电表面的区域的计算精度而广泛使用的技术 。",
            "id": "4260769",
            "problem": "考虑一个对称的 $z:z$ 电解质，它邻近一个位于 $x=0$ 的完美平面、非反应性壁面，以及一个位于 $x=L$ 的体相储库。静电势用 $\\psi(x)$ 表示，元电荷用 $e$ 表示，绝对温度用 $T$ 表示，玻尔兹曼常数用 $k_B$ 表示，介质的相对介电常数用 $\\epsilon$ 表示，体相离子数密度用 $c_{\\infty}$ 表示。定义无量纲电势 $y(x)=\\dfrac{z e \\psi(x)}{k_B T}$ 和德拜屏蔽长度的倒数 $\\kappa$，其关系式为 $\\kappa^2=\\dfrac{2 z^2 e^2 c_{\\infty}}{\\epsilon k_B T}$。一维平面泊松-玻尔兹曼方程为 $y''(x)=\\kappa^2 \\sinh(y(x))$，定义在区间 $x\\in[0,L]$上，并服从狄利克雷边界条件 $y(0)=y_w$ 和 $y(L)=0$。其中，$y_w$ 是给定的壁面电势，$L$ 的长度为若干个屏蔽长度，因此 $y(L)=0$ 是一个合适的设定。\n\n您的任务是构建一个有限差分格式，该格式在壁面附近聚集网格点。设一个非均匀网格的节点位置由 $x_0=0  x_1  \\dots  x_N=L$ 定义。令 $y_i=y(x_i)$ 为在节点 $x_i$ 处的无量纲电势，而 $h_i = x_i - x_{i-1}$。请使用控制体方法推导内部节点 $x_i$ 处的守恒有限差分格式，并给出求解非线性代数方程组所需的残差项 $R_i$ 的表达式，该表达式以 $y_{i-1}, y_i, y_{i+1}, h_i, h_{i+1}$ 和 $\\kappa$ 表示。",
            "solution": "该问题陈述经评估有效。它在科学上基于已建立的泊松-玻尔兹曼理论，是适定的、客观的，并为推导所要求的有限差分格式提供了一套完整且一致的定义和约束。其中没有矛盾、歧义或事实不准确之处。\n\n目标是在非均匀网格上推导一维泊松-玻尔兹曼方程 $y''(x) = \\kappa^2 \\sinh(y(x))$ 的守恒有限差分格式。该方法基于控制体方法，它能确保相关物理量（在此情况下为电场通量）的守恒。\n\n我们考虑一个通用内部节点 $x_i$，$i \\in \\{1, 2, \\ldots, N-1\\}$。我们定义一个围绕该节点的控制体 $V_i$。该控制体的边界位于相邻节点之间的中点。因此，$V_i = [x_{i-1/2}, x_{i+1/2}]$，其中 $x_{i-1/2} = \\frac{x_{i-1} + x_i}{2}$，$x_{i+1/2} = \\frac{x_i + x_{i+1}}{2}$。\n\n局部网格间距由 $h_i = x_i - x_{i-1}$ 和 $h_{i+1} = x_{i+1} - x_i$ 给出。控制体 $V_i$ 的长度为：\n$$\n|V_i| = x_{i+1/2} - x_{i-1/2} = \\frac{x_i + x_{i+1}}{2} - \\frac{x_{i-1} + x_i}{2} = \\frac{x_{i+1} - x_{i-1}}{2} = \\frac{(x_{i+1} - x_i) + (x_i - x_{i-1})}{2} = \\frac{h_{i+1} + h_i}{2}\n$$\n\n问题要求首先推导二阶导数 $y''(x)$ 的守恒有限差分公式。二阶导数可以写成 $y''(x) = \\frac{d}{dx}(y'(x))$。我们通过控制体 $V_i$ 上的平均值来近似节点 $x_i$ 处的 $y''$ 值，记为 $y_i''$：\n$$\ny_i'' \\approx \\frac{1}{|V_i|} \\int_{x_{i-1/2}}^{x_{i+1/2}} y''(x) dx\n$$\n将微积分基本定理应用于该积分，得到：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} y''(x) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}(y'(x)) dx = y'(x_{i+1/2}) - y'(x_{i-1/2})\n$$\n下一步是在控制体的界面上近似一阶导数 $y'(x)$。我们使用中点处的二阶精度中心差分近似来计算导数：\n在右侧界面 $x_{i+1/2}$：\n$$\ny'(x_{i+1/2}) \\approx \\frac{y(x_{i+1}) - y(x_i)}{x_{i+1} - x_i} = \\frac{y_{i+1} - y_i}{h_{i+1}}\n$$\n在左侧界面 $x_{i-1/2}$：\n$$\ny'(x_{i-1/2}) \\approx \\frac{y(x_i) - y(x_{i-1})}{x_i - x_{i-1}} = \\frac{y_i - y_{i-1}}{h_i}\n$$\n将这些近似值代回积分表达式：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} y''(x) dx \\approx \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i}\n$$\n现在，通过除以体积 $|V_i| = \\frac{h_i + h_{i+1}}{2}$，我们可以写出二阶导数的公式：\n$$\ny_i'' \\approx \\frac{1}{\\frac{h_i + h_{i+1}}{2}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) = \\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right)\n$$\n这就是非均匀网格上二阶导数的守恒有限差分公式。\n\n最后一步是使用此公式在内部节点 $x_i$ 处离散化泊松-玻尔兹曼方程 $y''(x) = \\kappa^2 \\sinh(y(x))$。我们代入 $y_i''$ 的有限差分近似，并在 $y_i$ 处计算右侧项：\n$$\n\\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) = \\kappa^2 \\sinh(y_i)\n$$\n问题要求非线性代数系统的残差。节点 $i$ 处的残差，记为 $R_i$，是为满足该方程而必须等于零的表达式。我们通过将所有项移到方程的一侧来得到它：\n$$\nR_i = \\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) - \\kappa^2 \\sinh(y_i)\n$$\n该表达式代表了需要为每个内部未知数 $y_i$（$i=1, \\ldots, N-1$）求解的方程，构成了一个包含 $N-1$ 个非线性代数方程的方程组。该表达式用所要求的变量 $y_{i-1}$、$y_i$、$y_{i+1}$、$h_i$、$h_{i+1}$ 和 $\\kappa$ 表示，没有中间变量。",
            "answer": "$$\n\\boxed{\\frac{2}{h_i + h_{i+1}} \\left( \\frac{y_{i+1} - y_i}{h_{i+1}} - \\frac{y_i - y_{i-1}}{h_i} \\right) - \\kappa^2 \\sinh(y_i)}\n$$"
        }
    ]
}