{
    "hands_on_practices": [
        {
            "introduction": "The Debye length, $\\lambda_D$, is a cornerstone of the Poisson-Boltzmann theory, quantifying the characteristic length scale over which electrostatic interactions are screened by mobile ions. This exercise guides you to derive the formula for $\\lambda_D$ from first principles for a solution containing multiple ion types, revealing how multivalent ions contribute disproportionately to screening. Mastering this calculation solidifies the physical meaning of electrostatic screening and provides a practical tool for estimating interaction ranges in complex biological buffers .",
            "id": "3866634",
            "problem": "An aqueous buffer used for biomolecular electrostatics contains sodium chloride and calcium chloride, fully dissociated and ideal, at temperature $T = 298$ $\\mathrm{K}$ in liquid water treated as a uniform dielectric continuum. The composition is $0.10$ $\\mathrm{M}$ sodium chloride $\\left(\\mathrm{NaCl}\\right)$ and $0.05$ $\\mathrm{M}$ calcium chloride $\\left(\\mathrm{CaCl}_{2}\\right)$. Assume point-like ions, bulk electroneutrality, and the validity of the linear response regime for small electrostatic potentials. Starting only from the Poisson equation coupled to the Boltzmann distribution for mobile ions, and invoking the linearization appropriate for small potentials, derive the screening relation that identifies the Debye screening length for a multicomponent electrolyte. Then evaluate the Debye length for this buffer.\n\nUse water’s relative permittivity $\\varepsilon_{r} = 78.37$ at $T = 298$ $\\mathrm{K}$, vacuum permittivity $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}$ $\\mathrm{F}\\,\\mathrm{m}^{-1}$, the elementary charge $e = 1.602176634 \\times 10^{-19}$ $\\mathrm{C}$, the Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}$ $\\mathrm{J}\\,\\mathrm{K}^{-1}$, and Avogadro’s number $N_{A} = 6.02214076 \\times 10^{23}$ $\\mathrm{mol}^{-1}$. Treat molar concentrations $c_{i}$ in $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ and convert to number densities via $n_{i} = N_{A} \\times 1000 \\times c_{i}$ in $\\mathrm{m}^{-3}$.\n\nExpress the final numerical value of the Debye length in nanometers, rounded to three significant figures. In your working, briefly explain how the presence of divalent calcium modifies the screening length relative to a solution containing only monovalent salt at otherwise comparable conditions. The requested final answer is the single numerical value of the Debye length in nanometers.",
            "solution": "The problem asks for the derivation of the Debye screening length for a multicomponent electrolyte and its subsequent calculation for a specific aqueous buffer. The derivation begins with the fundamental equations governing electrostatics in an ionic medium.\n\nThe electrostatic potential $\\psi(\\mathbf{r})$ at a position $\\mathbf{r}$ in a continuous medium with uniform permittivity $\\varepsilon$ is related to the local charge density $\\rho(\\mathbf{r})$ by the Poisson equation:\n$$ \\nabla^2 \\psi(\\mathbf{r}) = -\\frac{\\rho(\\mathbf{r})}{\\varepsilon} $$\nThe total permittivity of the medium is $\\varepsilon = \\varepsilon_r \\varepsilon_0$, where $\\varepsilon_r$ is the relative permittivity of the solvent (water) and $\\varepsilon_0$ is the vacuum permittivity. The charge density $\\rho(\\mathbf{r})$ arises from the distribution of mobile ions in the electrolyte. For a system with multiple ion species, this is given by the sum over all species $i$:\n$$ \\rho(\\mathbf{r}) = \\sum_{i} q_i n_i(\\mathbf{r}) $$\nwhere $q_i$ is the charge of an ion of species $i$ and $n_i(\\mathbf{r})$ is its local number density.\n\nUnder conditions of thermal equilibrium, the local number density of each ion species follows the Boltzmann distribution:\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{W_i(\\mathbf{r})}{k_B T}\\right) $$\nHere, $n_i^0$ is the bulk number density of species $i$ (far from any local charge source), $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. The potential energy of an ion of species $i$ at position $\\mathbf{r}$ is $W_i(\\mathbf{r}) = q_i \\psi(\\mathbf{r})$. Substituting this into the distribution gives:\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{q_i \\psi(\\mathbf{r})}{k_B T}\\right) $$\nCombining the Poisson equation with the Boltzmann distribution for the charge density yields the Poisson-Boltzmann equation (PBE):\n$$ \\nabla^2 \\psi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\exp\\left(-\\frac{q_i \\psi(\\mathbf{r})}{k_B T}\\right) $$\nThe problem specifies that we are in the linear response regime, where the electrostatic potential is small, meaning the electrostatic energy is much smaller than the thermal energy: $|q_i \\psi(\\mathbf{r})| \\ll k_B T$. This allows for the linearization of the exponential term using a Taylor series expansion, $\\exp(-x) \\approx 1 - x$ for small $x$:\n$$ \\nabla^2 \\psi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\sum_{i} q_i n_i^0 \\left(1 - \\frac{q_i \\psi(\\mathbf{r})}{k_B T}\\right) $$\nDistributing the terms in the summation gives:\n$$ \\nabla^2 \\psi(\\mathbf{r}) \\approx -\\frac{1}{\\varepsilon} \\left( \\sum_{i} q_i n_i^0 - \\frac{\\psi(\\mathbf{r})}{k_B T} \\sum_{i} q_i^2 n_i^0 \\right) $$\nThe first term in the parenthesis, $\\sum_i q_i n_i^0$, represents the net charge density in the bulk solution. A fundamental property of a bulk electrolyte is overall electroneutrality, so this term is zero:\n$$ \\sum_{i} q_i n_i^0 = 0 $$\nThe linearized PBE thus simplifies to the Debye-Hückel equation:\n$$ \\nabla^2 \\psi(\\mathbf{r}) = \\left( \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 \\right) \\psi(\\mathbf{r}) $$\nThis equation is of the form $\\nabla^2 \\psi(\\mathbf{r}) = \\kappa^2 \\psi(\\mathbf{r})$, where $\\kappa$ is the inverse Debye screening length. By comparing the two forms, we identify the screening parameter $\\kappa^2$ as:\n$$ \\kappa^2 = \\frac{1}{\\varepsilon k_B T} \\sum_{i} n_i^0 q_i^2 $$\nThe Debye screening length, $\\lambda_D$, is defined as $\\lambda_D = 1/\\kappa$. Therefore, the screening relation for a multicomponent electrolyte is:\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon k_B T}{\\sum_{i} n_i^0 q_i^2}} $$\nThe term $\\sum_i n_i^0 q_i^2$ quantifies the screening capacity of the ionic solution. The presence of the charge squared, $q_i^2$, in this sum is crucial. It indicates that multivalent ions contribute disproportionately more to screening than monovalent ions. For instance, a divalent ion (charge $2e$) contributes $(2e)^2 = 4e^2$ to the sum, four times more than a monovalent ion (charge $e$) of the same concentration, which contributes $e^2$. The presence of divalent calcium in the specified buffer will therefore significantly increase the screening effect (i.e., decrease the Debye length) compared to a solution containing only monovalent salts at a similar molar concentration.\n\nNow we evaluate $\\lambda_D$ for the given buffer. The ion species are sodium ($\\mathrm{Na}^{+}$), calcium ($\\mathrm{Ca}^{2+}$), and chloride ($\\mathrm{Cl}^{-}$). Their charges are $q_{\\mathrm{Na}^+} = +e$, $q_{\\mathrm{Ca}^{2+}} = +2e$, and $q_{\\mathrm{Cl}^-} = -e$, where $e$ is the elementary charge.\nThe molar concentrations ($c_i$) are given:\n$c_{\\mathrm{NaCl}} = 0.10$ M\n$c_{\\mathrm{CaCl}_2} = 0.05$ M\nAssuming full dissociation, the concentrations of the individual ions are:\n$c_{\\mathrm{Na}^{+}} = 0.10$ M\n$c_{\\mathrm{Ca}^{2+}} = 0.05$ M\n$c_{\\mathrm{Cl}^{-}} = c_{\\text{from NaCl}} + c_{\\text{from CaCl}_2} = 0.10\\ \\mathrm{M} + 2 \\times 0.05\\ \\mathrm{M} = 0.20$ M\n\nThe sum $\\sum_i n_i^0 q_i^2$ can be expressed in terms of molar concentrations. Since $n_i^0 = c_i N_A \\times 1000$ (for $c_i$ in mol/L and $n_i^0$ in m⁻³) and $q_i = z_i e$ (where $z_i$ is the valence), the sum becomes:\n$$ \\sum_{i} n_i^0 q_i^2 = \\sum_{i} (c_i N_A \\times 1000) (z_i e)^2 = e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2 $$\nLet's calculate the term $\\sum_i c_i z_i^2$:\n$$ \\sum_{i} c_i z_i^2 = c_{\\mathrm{Na}^{+}} (z_{\\mathrm{Na}^{+}})^2 + c_{\\mathrm{Ca}^{2+}} (z_{\\mathrm{Ca}^{2+}})^2 + c_{\\mathrm{Cl}^{-}} (z_{\\mathrm{Cl}^{-}})^2 $$\n$$ \\sum_{i} c_i z_i^2 = (0.10)(+1)^2 + (0.05)(+2)^2 + (0.20)(-1)^2 $$\n$$ \\sum_{i} c_i z_i^2 = 0.10 \\times 1 + 0.05 \\times 4 + 0.20 \\times 1 = 0.10 + 0.20 + 0.20 = 0.50 \\ \\mathrm{mol}\\,\\mathrm{L}^{-1} $$\nNow, we can write the expression for the Debye length as:\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon_r \\varepsilon_0 k_B T}{e^2 N_A \\times 1000 \\sum_{i} c_i z_i^2}} $$\nWe substitute the given physical constants and calculated values:\n$T = 298$ K\n$\\varepsilon_r = 78.37$\n$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}$ F m⁻¹\n$k_B = 1.380649 \\times 10^{-23}$ J K⁻¹\n$e = 1.602176634 \\times 10^{-19}$ C\n$N_A = 6.02214076 \\times 10^{23}$ mol⁻¹\n$\\sum_i c_i z_i^2 = 0.50$ mol L⁻¹\n\nNumerator: $\\varepsilon_r \\varepsilon_0 k_B T$\n$ = (78.37)(8.8541878128 \\times 10^{-12}\\ \\mathrm{F\\,m}^{-1})(1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1})(298\\ \\mathrm{K}) $\n$ \\approx 2.85483 \\times 10^{-30} \\ \\mathrm{F\\,J\\,m}^{-1} $\n\nDenominator: $e^2 N_A \\times 1000 \\sum_i c_i z_i^2$\n$ = (1.602176634 \\times 10^{-19}\\ \\mathrm{C})^2 (6.02214076 \\times 10^{23}\\ \\mathrm{mol}^{-1}) (1000\\ \\mathrm{L\\,m}^{-3}) (0.50\\ \\mathrm{mol\\,L}^{-1}) $\n$ \\approx 7.72836 \\times 10^{-12} \\ \\mathrm{C}^2\\mathrm{m}^{-3} $\nNote that the units of the numerator, F J m⁻¹, are equivalent to C² m⁻¹, since $J = C \\cdot V$ and $F = C/V$, so $F \\cdot J = C^2$.\n\nNow, we calculate $\\lambda_D^2$:\n$$ \\lambda_D^2 = \\frac{2.85483 \\times 10^{-30}\\ \\mathrm{C}^2\\mathrm{m}^{-1}}{7.72836 \\times 10^{-12}\\ \\mathrm{C}^2\\mathrm{m}^{-3}} \\approx 3.6939 \\times 10^{-19}\\ \\mathrm{m}^2 $$\nTaking the square root to find $\\lambda_D$:\n$$ \\lambda_D = \\sqrt{3.6939 \\times 10^{-19}\\ \\mathrm{m}^2} \\approx 6.0778 \\times 10^{-10}\\ \\mathrm{m} $$\nThe problem requests the answer in nanometers. Since $1\\ \\mathrm{nm} = 10^{-9}\\ \\mathrm{m}$:\n$$ \\lambda_D \\approx 0.60778\\ \\mathrm{nm} $$\nRounding to three significant figures, we get:\n$$ \\lambda_D \\approx 0.608\\ \\mathrm{nm} $$\nThis value represents the characteristic length scale over which electrostatic interactions are screened by the mobile ions in the given buffer.",
            "answer": "$$\n\\boxed{0.608}\n$$"
        },
        {
            "introduction": "The full Poisson-Boltzmann (PB) equation is nonlinear and often challenging to solve analytically, leading to the widespread use of its linearized form, the Debye-Hückel theory. It is crucial for any practitioner to understand the conditions under which this approximation is valid. This practice involves deriving the exact relationship for a charged planar surface in the nonlinear model and comparing it to the prediction from the linearized version . By implementing a program to quantify the error, you will develop a quantitative intuition for the breakdown of the linear approximation at high surface charges or low salt concentrations.",
            "id": "3866522",
            "problem": "Consider a symmetric monovalent electrolyte adjacent to a uniformly charged, infinite planar surface. The solvent is treated as a continuum dielectric with relative permittivity $\\epsilon$, absolute permittivity $\\epsilon\\epsilon_0$, and temperature $T$. Let the surface at position $x=0$ carry a uniform free surface charge density $\\sigma$, and the electrolyte occupy the half-space $x>0$ with bulk number concentration $n_0$ of cations and $n_0$ of anions (so that the bulk salt concentration is $c_0=n_0/N_A$ in $\\mathrm{mol\\,m^{-3}}$). Assume equilibrium and no fluid flow.\n\nStarting from first principles valid in computational chemical biology and electrostatics, specifically:\n- Gauss’s law in differential form (Poisson’s equation) $\\nabla\\cdot\\left(\\epsilon\\epsilon_0\\nabla\\psi\\right)=-\\rho$,\n- Boltzmann distributions $c_\\pm(x)=n_0\\exp\\!\\left(\\mp \\dfrac{e\\psi(x)}{k_B T}\\right)$ for monovalent ions in an electrostatic potential $\\psi(x)$,\n- The definition of the Debye screening parameter under small-potential linearization, and\n- Appropriate boundary conditions $\\psi(\\infty)=0$, $-\\epsilon\\epsilon_0\\psi'(0)=\\sigma$,\n\nderive, from these bases and without invoking any shortcut formulas, the relationship between surface charge density $\\sigma$ and surface potential $\\psi_0=\\psi(0)$ for both:\n1. The full nonlinear Poisson–Boltzmann (PB) description, and\n2. The linearized PB (Debye–Hückel) description in the small-potential regime.\n\nThen, implement a program that:\n- Uses the derived relationships to compute the surface potential predicted by the nonlinear PB, $\\psi_0^{\\mathrm{NL}}$, and by the linearized PB, $\\psi_0^{\\mathrm{LIN}}$, for each provided test case.\n- Quantifies the absolute relative error in the linear prediction with respect to the nonlinear prediction as the decimal fraction\n$$\\mathrm{err}=\\dfrac{\\left|\\psi_0^{\\mathrm{LIN}}-\\psi_0^{\\mathrm{NL}}\\right|}{\\left|\\psi_0^{\\mathrm{NL}}\\right|}.$$\n- Expresses all potentials in $\\mathrm{V}$ and the error as a unitless decimal fraction.\n\nUse the following physical constants precisely:\n- Elementary charge $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$,\n- Boltzmann constant $k_B=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$,\n- Vacuum permittivity $\\epsilon_0=8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$,\n- Avogadro constant $N_A=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$,\n- Temperature $T=298\\,\\mathrm{K}$.\n\nYour program must treat the given bulk salt concentrations $c_0$ in $\\mathrm{mol\\,m^{-3}}$ by converting them to number density $n_0=N_A c_0$ in $\\mathrm{m^{-3}}$. For the linearized PB, use the planar solution consistent with the boundary condition to relate $\\sigma$ and $\\psi_0$ via the Debye screening parameter $\\kappa$, where $\\kappa^2=\\dfrac{2 e^2 n_0}{\\epsilon\\epsilon_0 k_B T}$ for a symmetric monovalent electrolyte.\n\nTest suite. For coverage across regimes, use the following parameter sets $(\\sigma, c_0, \\epsilon)$, with $\\sigma$ in $\\mathrm{C\\,m^{-2}}$, $c_0$ in $\\mathrm{mol\\,m^{-3}}$, and $\\epsilon$ dimensionless:\n- Case A (typical aqueous, moderate charge, moderate salt): $\\sigma=-2.0\\times 10^{-2}$, $c_0=100$, $\\epsilon=78.5$.\n- Case B (small charge, low salt): $\\sigma=-1.0\\times 10^{-4}$, $c_0=1$, $\\epsilon=78.5$.\n- Case C (large charge, reduced permittivity, moderate salt): $\\sigma=-2.0\\times 10^{-1}$, $c_0=10$, $\\epsilon=40$.\n- Case D (moderate charge, high salt): $\\sigma=-1.0\\times 10^{-2}$, $c_0=1000$, $\\epsilon=78.5$.\n- Case E (zero charge boundary case): $\\sigma=0.0$, $c_0=100$, $\\epsilon=78.5$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list ordered as $[\\psi_0^{\\mathrm{NL}},\\ \\psi_0^{\\mathrm{LIN}},\\ \\mathrm{err}]$ for the corresponding test case, for example $[[a_1,b_1,e_1],[a_2,b_2,e_2],\\dots]$. All $\\psi_0$ values must be in $\\mathrm{V}$ and all errors must be decimal fractions.",
            "solution": "The user-provided problem is evaluated as valid according to the specified criteria. It is scientifically grounded in the principles of electrostatics and statistical mechanics, well-posed with sufficient information for a unique solution, and stated in objective, formal language. The problem requires the derivation and application of the Poisson-Boltzmann (PB) model, which is a standard and central topic in computational chemical biology.\n\nThe derivation and solution proceed as follows.\n\nThe system consists of an infinite planar surface with uniform surface charge density $\\sigma$ at $x=0$, and a symmetric monovalent electrolyte in the half-space $x>0$. The solvent is a continuum dielectric with relative permittivity $\\epsilon$ at temperature $T$. The electrolyte has a bulk ion number concentration of $n_0$.\n\nThe fundamental relationship between the electrostatic potential $\\psi$ and the charge density $\\rho$ is given by Poisson's equation. For a one-dimensional system where the potential $\\psi$ varies only with the distance $x$ from the surface, this is:\n$$\n\\frac{d}{dx}\\left(\\epsilon\\epsilon_0 \\frac{d\\psi}{dx}\\right) = -\\rho(x)\n$$\nAssuming a uniform dielectric, $\\epsilon$ is constant, and the equation simplifies to:\n$$\n\\frac{d^2\\psi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon\\epsilon_0}\n$$\nThe charge density $\\rho(x)$ arises from the mobile ions in the electrolyte. For a symmetric $1:1$ electrolyte, the number concentrations of cations, $n_+(x)$, and anions, $n_-(x)$, are given by the Boltzmann distribution:\n$$\nn_+(x) = n_0 \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_0 \\exp\\left(+\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nwhere $e$ is the elementary charge, $k_B$ is the Boltzmann constant, and $n_0$ is the bulk number concentration of each ionic species. The net charge density is the sum of the charge contributions from cations (charge $+e$) and anions (charge $-e$):\n$$\n\\rho(x) = e n_+(x) - e n_-(x) = e n_0 \\left[ \\exp\\left(-\\frac{e\\psi(x)}{k_B T}\\right) - \\exp\\left(\\frac{e\\psi(x)}{k_B T}\\right) \\right]\n$$\nUsing the identity $2\\sinh(y) = e^y - e^{-y}$, the charge density can be expressed as:\n$$\n\\rho(x) = -2en_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nSubstituting this into Poisson's equation gives the full one-dimensional nonlinear Poisson-Boltzmann (PB) equation:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nTo solve this equation for the relationship between surface charge $\\sigma$ and surface potential $\\psi_0 = \\psi(0)$, we use an integration technique. Multiplying both sides by $2\\frac{d\\psi}{dx}$:\n$$\n2\\frac{d\\psi}{dx}\\frac{d^2\\psi}{dx^2} = \\frac{4en_0}{\\epsilon\\epsilon_0} \\frac{d\\psi}{dx} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\nThe left side is the derivative of $(\\frac{d\\psi}{dx})^2$ with respect to $x$. The right side can also be expressed as a derivative. We can write:\n$$\n\\frac{d}{dx}\\left(\\left(\\frac{d\\psi}{dx}\\right)^2\\right) = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\frac{k_B T}{e}\\right) \\frac{d}{dx}\\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\nIntegrating from a position $x$ to infinity, and applying the boundary conditions that the potential and its gradient vanish far from the surface, i.e., $\\psi(\\infty)=0$ and $(\\frac{d\\psi}{dx})_{x\\to\\infty}=0$:\n$$\n\\int_x^\\infty \\frac{d}{dx'}\\left(\\left(\\frac{d\\psi}{dx'}\\right)^2\\right) dx' = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\int_x^\\infty \\frac{d}{dx'}\\left(\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right) dx'\n$$\n$$\n\\left[\\left(\\frac{d\\psi}{dx'}\\right)^2\\right]_x^\\infty = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left[\\cosh\\left(\\frac{e\\psi(x')}{k_B T}\\right)\\right]_x^\\infty\n$$\n$$\n0 - \\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh(0) - \\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\\right)\n$$\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{4n_0 k_B T}{\\epsilon\\epsilon_0} \\left(\\cosh\\left(\\frac{e\\psi(x)}{k_B T}\\right) - 1\\right)\n$$\nUsing the identity $\\cosh(y) - 1 = 2\\sinh^2(y/2)$, we obtain:\n$$\n\\left(\\frac{d\\psi}{dx}\\right)^2 = \\frac{8n_0 k_B T}{\\epsilon\\epsilon_0} \\sinh^2\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\nTaking the square root gives the electric field:\n$$\n\\frac{d\\psi}{dx} = -\\text{sgn}(\\psi_0) \\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\left|\\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\\right|\n$$\nA simpler way to handle the sign is to recognize that for $\\psi_0>0$, $\\psi(x)$ decreases, so $\\psi' < 0$. For $\\psi_0<0$, $\\psi(x)$ increases, so $\\psi' > 0$. And $\\sinh(y)$ has the same sign as $y$. This means the product $\\psi' \\cdot \\sinh(e\\psi/2k_BT)$ is always non-positive. We thus take the negative root:\n$$\n\\frac{d\\psi}{dx} = -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi(x)}{2k_B T}\\right)\n$$\nThe boundary condition at the charged surface is derived from Gauss's law for a planar surface: $-\\epsilon\\epsilon_0 \\left(\\frac{d\\psi}{dx}\\right)_{x=0} = \\sigma$. Substituting our expression for the derivative at $x=0$:\n$$\n-\\epsilon\\epsilon_0 \\left( -\\sqrt{\\frac{8n_0 k_B T}{\\epsilon\\epsilon_0}} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right) \\right) = \\sigma\n$$\nThis simplifies to the Grahame equation, which relates the surface charge density $\\sigma$ to the surface potential $\\psi_0$:\n$$\n\\sigma = \\sqrt{8n_0 k_B T \\epsilon\\epsilon_0} \\sinh\\left(\\frac{e\\psi_0}{2k_B T}\\right)\n$$\nTo find the surface potential $\\psi_0^{\\mathrm{NL}}$ for the full nonlinear PB model, we solve for $\\psi_0$:\n$$\n\\sinh\\left(\\frac{e\\psi_0^{\\mathrm{NL}}}{2k_B T}\\right) = \\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\n$$\n$$\n\\psi_0^{\\mathrm{NL}} = \\frac{2k_B T}{e} \\text{arsinh}\\left(\\frac{\\sigma}{\\sqrt{8n_0 k_B T \\epsilon\\epsilon_0}}\\right)\n$$\n\nFor the linearized PB (Debye-Hückel) description, we assume the potential is small, i.e., $|e\\psi(x)| \\ll k_B T$. This allows the linearization $\\sinh(y) \\approx y$. The PB equation becomes:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2en_0}{\\epsilon\\epsilon_0} \\left(\\frac{e\\psi(x)}{k_B T}\\right) = \\left(\\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\\right) \\psi(x)\n$$\nThis is the linearized Poisson-Boltzmann equation. The term in parenthesis is the square of the Debye screening parameter, $\\kappa$:\n$$\n\\kappa^2 = \\frac{2e^2 n_0}{\\epsilon\\epsilon_0 k_B T}\n$$\nThe equation is now $\\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi$. The general solution is $\\psi(x) = A e^{-\\kappa x} + B e^{\\kappa x}$. Applying the boundary condition $\\psi(\\infty)=0$ requires $B=0$. The solution is $\\psi(x) = A e^{-\\kappa x}$. At the surface, $\\psi(0) = \\psi_0 = A$, so $\\psi(x) = \\psi_0 e^{-\\kappa x}$.\n\nTo find the relationship between $\\sigma$ and $\\psi_0$, we use the second boundary condition, $-\\epsilon\\epsilon_0 \\psi'(0) = \\sigma$. The derivative is $\\psi'(x) = -\\kappa\\psi_0 e^{-\\kappa x}$, so $\\psi'(0) = -\\kappa\\psi_0$.\n$$\n-\\epsilon\\epsilon_0(-\\kappa \\psi_0) = \\sigma\n$$\n$$\n\\epsilon\\epsilon_0 \\kappa \\psi_0 = \\sigma\n$$\nSolving for the surface potential $\\psi_0^{\\mathrm{LIN}}$ in the linearized approximation yields:\n$$\n\\psi_0^{\\mathrm{LIN}} = \\frac{\\sigma}{\\epsilon\\epsilon_0 \\kappa}\n$$\nThe program will compute $\\psi_0^{\\mathrm{NL}}$ and $\\psi_0^{\\mathrm{LIN}}$ using these derived expressions and then calculate the relative error $\\mathrm{err} = |\\psi_0^{\\mathrm{LIN}} - \\psi_0^{\\mathrm{NL}}| / |\\psi_0^{\\mathrm{NL}}|$. For the special case $\\sigma=0$, both $\\psi_0^{\\mathrm{NL}}$ and $\\psi_0^{\\mathrm{LIN}}$ are $0$, and the error is defined as $0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates surface potentials for a charged planar surface\n    in an electrolyte using both nonlinear and linearized Poisson-Boltzmann theory.\n    \"\"\"\n\n    # Define physical constants\n    E = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23     # Boltzmann constant in J/K\n    EPS_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    NA = 6.02214076e23   # Avogadro constant in mol^-1\n    T = 298.0              # Temperature in K\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (sigma, c0, epsilon)\n    # sigma: surface charge density in C/m^2\n    # c0: bulk salt concentration in mol/m^3\n    # epsilon: relative permittivity (dimensionless)\n    test_cases = [\n        (-2.0e-2, 100.0, 78.5),   # Case A\n        (-1.0e-4, 1.0, 78.5),     # Case B\n        (-2.0e-1, 10.0, 40.0),    # Case C\n        (-1.0e-2, 1000.0, 78.5),  # Case D\n        (0.0, 100.0, 78.5),       # Case E\n    ]\n\n    results = []\n    for sigma, c0, epsilon in test_cases:\n        # Convert bulk concentration c0 (mol/m^3) to number density n0 (m^-3)\n        n0 = c0 * NA\n        \n        # Handle the special case where surface charge is zero\n        if sigma == 0.0:\n            psi0_nl = 0.0\n            psi0_lin = 0.0\n            err = 0.0\n            results.append([psi0_nl, psi0_lin, err])\n            continue\n            \n        # --- Nonlinear Poisson-Boltzmann (NL) calculation ---\n        # Formula: psi0_nl = (2 * kB * T / e) * arsinh(sigma / sqrt(8 * n0 * kB * T * epsilon * epsilon0))\n        denom_nl = np.sqrt(8 * n0 * KB * T * epsilon * EPS_0)\n        arg_arsinh = sigma / denom_nl\n        psi0_nl = (2 * KB * T / E) * np.arcsinh(arg_arsinh)\n\n        # --- Linearized Poisson-Boltzmann (LIN) calculation ---\n        # Formula: psi0_lin = sigma / (epsilon * epsilon0 * kappa)\n        # where kappa = sqrt(2 * e^2 * n0 / (epsilon * epsilon0 * kB * T))\n        kappa_sq = (2 * E**2 * n0) / (epsilon * EPS_0 * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        psi0_lin = sigma / (epsilon * EPS_0 * kappa)\n\n        # --- Error Calculation ---\n        # Formula: err = |psi0_lin - psi0_nl| / |psi0_nl|\n        # The case psi0_nl = 0 (i.e., sigma = 0) is handled above.\n        err = np.abs(psi0_lin - psi0_nl) / np.abs(psi0_nl)\n\n        results.append([psi0_nl, psi0_lin, err])\n\n    # Final print statement in the exact required format.\n    # Format each inner list to a string '[v1,v2,v3]' and join them.\n    formatted_results = [\n        f\"[{','.join(f'{val:.8e}' for val in res)}]\" for res in results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Numerical solutions to the Poisson-Boltzmann equation are necessarily performed within a finite computational domain, whereas the physical system is often effectively infinite. Imposing artificial boundary conditions, such as fixing the potential to zero at the edge of the domain, can introduce significant artifacts that corrupt the solution. This exercise explores the error, or bias, introduced by such a truncation for the linearized PB equation around a central point charge . By deriving an analytical expression for this bias, you will learn to determine the minimal \"buffer\" region of solvent required to ensure the accuracy of the potential within a region of interest, a critical skill for setting up reliable electrostatic simulations.",
            "id": "3866532",
            "problem": "Consider the linearized Poisson–Boltzmann equation (LPB) in three dimensions for the dimensionless reduced electrostatic potential $\\psi(\\mathbf{r})$ created by a single point-like solute of valence $z$ centered at the origin in a homogeneous ionic solution of relative permittivity and temperature such that the Bjerrum length is $\\ell_B$ (expressed in nanometers). The linearized Poisson–Boltzmann equation is a screened Poisson equation, and the screening strength is characterized by the Debye screening parameter $\\kappa$ (expressed in inverse nanometers). In spherical coordinates under the assumption of spherical symmetry, you consider a finite computational ball of radius $R$ with Dirichlet boundary condition $\\psi(R)=0$. The infinite-domain reference solution corresponds to the same governing equation but without truncation at $R$.\n\nYour task is to quantify how truncating the domain and imposing the Dirichlet boundary condition biases the interior potentials, and to propose a buffer thickness that guarantees the absolute bias does not exceed a prescribed threshold. Specifically:\n\n1. Start from fundamental physical and mathematical bases appropriate for computational chemical biology:\n   - Use the electrostatic Poisson equation coupled with Boltzmann statistics for mobile ions, and invoke the small-potential limit to obtain the linearized Poisson–Boltzmann equation for the reduced potential $\\psi$.\n   - Use spherical symmetry for a single point-like solute at the origin so that the governing equation reduces to a one-dimensional radial ordinary differential equation for $\\psi(r)$.\n\n2. Define the bias $\\Delta(r;R)$ as the difference between the finite-domain Dirichlet solution evaluated at radius $r$ and the infinite-domain reference solution at the same $r$.\n\n3. For a given domain-of-interest radius $r_d$ (expressed in nanometers), find the minimal computational radius $R$ (with $R \\ge r_d$) such that the maximum absolute bias over all points $r \\in [0,r_d]$ is less than or equal to a specified threshold $\\tau$ (dimensionless, in units of the reduced potential). Report the buffer thickness $B = R - r_d$ in nanometers. Your derivation must rely only on the bases stated above and not introduce unjustified shortcut formulas.\n\n4. Your program must implement the derived expression for the minimal buffer thickness $B$ and evaluate it for the test suite below. Distances must be in nanometers, $\\kappa$ must be in inverse nanometers, $\\ell_B$ must be in nanometers, and the threshold $\\tau$ is dimensionless. Output the buffer thicknesses $B$ rounded to six decimal places.\n\nTest suite (each case is $(z, \\kappa, r_d, \\tau, \\ell_B)$):\n- Case 1 (general case with moderate screening): $(1, 0.1, 1.0, 0.01, 0.714)$.\n- Case 2 (stronger screening, higher valence): $(2, 0.5, 2.0, 0.005, 0.714)$.\n- Case 3 (weak screening relative to domain, very tight error threshold): $(4, 0.2, 3.0, 0.0001, 0.714)$.\n- Case 4 (short-range screening, small domain-of-interest): $(1, 1.0, 0.5, 0.02, 0.714)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the buffer thickness results for the four test cases as a comma-separated list enclosed in square brackets. Each entry must be the buffer thickness $B$ rounded to six decimal places in nanometers, for example: \"[12.345678,3.210000, ...]\".",
            "solution": "The user-provided problem statement is valid. It is scientifically grounded in the principles of physical chemistry, specifically the Poisson-Boltzmann theory, and poses a well-defined mathematical problem regarding the numerical solution of partial differential equations. The parameters and context are standard in computational chemical biology. We will now proceed with a complete solution.\n\nThe problem requires a derivation of the necessary buffer thickness for a spherical computational domain used to solve the linearized Poisson-Boltzmann (LPB) equation. The goal is to ensure that the error, or bias, introduced by the domain truncation and an artificial Dirichlet boundary condition remains below a specified threshold $\\tau$ within a domain of interest of radius $r_d$.\n\n**1. The Linearized Poisson-Boltzmann Equation**\n\nThe electrostatic potential $\\Phi(\\mathbf{r})$ in an ionic solution is described by the Poisson equation:\n$$ \\nabla^2 \\Phi(\\mathbf{r}) = -\\frac{1}{\\epsilon} \\rho(\\mathbf{r}) $$\nwhere $\\epsilon = \\epsilon_0 \\epsilon_r$ is the dielectric permittivity of the medium and $\\rho(\\mathbf{r})$ is the total charge density. The charge density is composed of the fixed charge density of the solute, $\\rho_{\\text{fix}}(\\mathbf{r})$, and the charge density from mobile ions in the solvent, $\\rho_{\\text{mob}}(\\mathbf{r})$.\nFor a single point-like solute of valence $z$ at the origin, the fixed charge is $q = ze_c$ (with $e_c$ being the elementary charge), and its charge density is represented by a Dirac delta function: $\\rho_{\\text{fix}}(\\mathbf{r}) = ze_c \\delta(\\mathbf{r})$.\n\nThe mobile ion density is described by a Boltzmann distribution. For a symmetric $1:1$ electrolyte of bulk concentration $c_0$, the density is:\n$$ \\rho_{\\text{mob}}(\\mathbf{r}) = c_0 e_c \\left( e^{-e_c \\Phi(\\mathbf{r}) / (k_B T)} - e^{+e_c \\Phi(\\mathbf{r}) / (k_B T)} \\right) = -2c_0 e_c \\sinh\\left(\\frac{e_c \\Phi(\\mathbf{r})}{k_B T}\\right) $$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nIntroducing the dimensionless reduced potential $\\psi(\\mathbf{r}) = \\frac{e_c \\Phi(\\mathbf{r})}{k_B T}$, the full Poisson-Boltzmann equation becomes:\n$$ \\nabla^2 \\psi(\\mathbf{r}) = -\\frac{z e_c^2 \\delta(\\mathbf{r})}{\\epsilon k_B T} + \\frac{2c_0 e_c^2}{\\epsilon k_B T} \\sinh(\\psi(\\mathbf{r})) $$\nThis equation can be simplified using two standard parameters. The Bjerrum length, $\\ell_B$, is the distance at which the electrostatic interaction energy between two elementary charges equals the thermal energy scale:\n$$ \\ell_B = \\frac{e_c^2}{4\\pi \\epsilon k_B T} $$\nThe Debye screening parameter, $\\kappa$, characterizes the electrostatic screening by the mobile ions:\n$$ \\kappa^2 = \\frac{2 c_0 e_c^2}{\\epsilon k_B T} $$\nUsing these definitions, the equation becomes: $\\nabla^2 \\psi(\\mathbf{r}) = -4\\pi z \\ell_B \\delta(\\mathbf{r}) + \\kappa^2 \\sinh(\\psi(\\mathbf{r}))$.\n\nThe problem specifies the linearized Poisson-Boltzmann (LPB) equation, which is valid in the small-potential limit ($\\psi \\ll 1$), where $\\sinh(\\psi) \\approx \\psi$. This yields a linear, second-order partial differential equation:\n$$ \\nabla^2 \\psi(\\mathbf{r}) - \\kappa^2 \\psi(\\mathbf{r}) = -4\\pi z \\ell_B \\delta(\\mathbf{r}) $$\n\n**2. Solution in Spherical Coordinates**\n\nFor a point charge at the origin, the system is spherically symmetric, so the potential $\\psi$ depends only on the radial distance $r = |\\mathbf{r}|$. The Laplacian operator in spherical coordinates simplifies to $\\nabla^2 \\psi(r) = \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{d\\psi}{dr}\\right)$. For $r > 0$, the source term $\\delta(\\mathbf{r})$ is zero, and the LPB equation becomes:\n$$ \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{d\\psi}{dr}\\right) - \\kappa^2 \\psi(r) = 0 $$\nBy substituting $u(r) = r\\psi(r)$, this equation simplifies to a standard second-order ODE with constant coefficients:\n$$ u''(r) - \\kappa^2 u(r) = 0 $$\nThe general solution for $u(r)$ is $u(r) = C_1 e^{\\kappa r} + C_2 e^{-\\kappa r}$. This gives the general solution for the potential $\\psi(r)$:\n$$ \\psi(r) = \\frac{C_1 e^{\\kappa r} + C_2 e^{-\\kappa r}}{r} $$\n\n**3. Infinite-Domain and Finite-Domain Solutions**\n\nWe now solve for the potential under two different boundary conditions.\n\n*   **Infinite-Domain Reference Solution, $\\psi_{\\infty}(r)$**:\n    The physical boundary condition for an infinite domain is that the potential must vanish at infinity: $\\lim_{r\\to\\infty} \\psi(r) = 0$. This requires the coefficient of the exponentially growing term, $C_1$, to be zero. Thus, $\\psi_{\\infty}(r) = \\frac{C_2 e^{-\\kappa r}}{r}$. The constant $C_2$ is determined by the behavior near the source at $r=0$. As $r \\to 0$, the screening effect becomes negligible, and the potential must approach the unscreened Coulomb potential of the point charge: $\\psi(r) \\approx z\\ell_B/r$. Comparing this to $\\lim_{r\\to 0} \\psi_{\\infty}(r) = C_2/r$, we find $C_2 = z\\ell_B$. The infinite-domain solution, known as the screened Coulomb or Yukawa potential, is therefore:\n    $$ \\psi_{\\infty}(r) = z\\ell_B \\frac{e^{-\\kappa r}}{r} $$\n\n*   **Finite-Domain Dirichlet Solution, $\\psi_{R}(r)$**:\n    For a finite computational ball of radius $R$, the artificial boundary condition is $\\psi_R(R)=0$. We use the general solution $\\psi(r) = \\frac{1}{r} (C_1 e^{\\kappa r} + C_2 e^{-\\kappa r})$. The behavior at the origin still requires $\\lim_{r\\to 0} r\\psi_R(r) = z\\ell_B$, which implies $C_1 + C_2 = z\\ell_B$. The boundary condition at $r=R$ implies $C_1 e^{\\kappa R} + C_2 e^{-\\kappa R} = 0$. Solving this system for $C_1$ and $C_2$ yields:\n    $C_1 = -z\\ell_B \\frac{e^{-2\\kappa R}}{1 - e^{-2\\kappa R}}$ and $C_2 = \\frac{z\\ell_B}{1 - e^{-2\\kappa R}}$.\n    A more elegant approach uses hyperbolic functions. The general solution for $u(r) = r\\psi(r)$ can be written as $u(r) = A\\cosh(\\kappa r) + B\\sinh(\\kappa r)$. The condition at the origin gives $\\lim_{r \\to 0} u(r) = A = z\\ell_B$. The boundary condition $\\psi_R(R)=0$ implies $u(R)=0$, so $z\\ell_B\\cosh(\\kappa R) + B\\sinh(\\kappa R) = 0$, which gives $B = -z\\ell_B \\frac{\\cosh(\\kappa R)}{\\sinh(\\kappa R)}$. Substituting back gives:\n    $u(r) = z\\ell_B \\left( \\cosh(\\kappa r) - \\frac{\\cosh(\\kappa R)}{\\sinh(\\kappa R)}\\sinh(\\kappa r) \\right) = \\frac{z\\ell_B}{\\sinh(\\kappa R)} (\\cosh(\\kappa r)\\sinh(\\kappa R) - \\sinh(\\kappa r)\\cosh(\\kappa R))$.\n    Using the identity for $\\sinh(x-y)$, we get $u(r) = z\\ell_B \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)}$. The finite-domain solution is thus:\n    $$ \\psi_R(r) = \\frac{z\\ell_B}{r} \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)} $$\n\n**4. Bias Analysis and Buffer Thickness Derivation**\n\nThe bias is defined as the difference between the finite-domain and infinite-domain solutions:\n$$ \\Delta(r; R) = \\psi_R(r) - \\psi_{\\infty}(r) = \\frac{z\\ell_B}{r} \\left( \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)} - e^{-\\kappa r} \\right) $$\nWe can simplify the term in the parenthesis:\n$$ \\frac{\\sinh(\\kappa(R-r))}{\\sinh(\\kappa R)} - e^{-\\kappa r} = \\frac{e^{\\kappa R}e^{-\\kappa r} - e^{-\\kappa R}e^{\\kappa r}}{e^{\\kappa R} - e^{-\\kappa R}} - e^{-\\kappa r} = \\frac{(e^{\\kappa R}e^{-\\kappa r} - e^{-\\kappa R}e^{\\kappa r}) - e^{-\\kappa r}(e^{\\kappa R} - e^{-\\kappa R})}{e^{\\kappa R}-e^{-\\kappa R}} = \\frac{-e^{-\\kappa R}e^{\\kappa r} + e^{-\\kappa R}e^{-\\kappa r}}{e^{\\kappa R}-e^{-\\kappa R}} = \\frac{-e^{-\\kappa R}(e^{\\kappa r}-e^{-\\kappa r})}{e^{\\kappa R}-e^{-\\kappa R}} = -e^{-\\kappa R}\\frac{\\sinh(\\kappa r)}{\\sinh(\\kappa R)} $$\nThis gives a compact expression for the bias:\n$$ \\Delta(r; R) = - \\frac{z\\ell_B}{r} \\frac{e^{-\\kappa R}\\sinh(\\kappa r)}{\\sinh(\\kappa R)} $$\nThe task is to find the minimum $R \\ge r_d$ such that $\\max_{r \\in [0, r_d]} |\\Delta(r; R)| \\le \\tau$. The absolute bias is:\n$$ |\\Delta(r; R)| = |z|\\ell_B \\frac{e^{-\\kappa R}}{|\\sinh(\\kappa R)|} \\frac{|\\sinh(\\kappa r)|}{r} $$\nFor physically relevant parameters, $\\kappa > 0$ and $R > 0$, so $\\sinh(\\kappa R)>0$. With $r \\ge 0$, $\\sinh(\\kappa r) \\ge 0$. The expression simplifies to:\n$$ |\\Delta(r; R)| = |z|\\ell_B \\frac{e^{-\\kappa R}}{\\sinh(\\kappa R)} \\left( \\frac{\\sinh(\\kappa r)}{r} \\right) $$\nTo find the maximum of this function with respect to $r$ on the interval $[0, r_d]$, we analyze the term $f(r) = \\frac{\\sinh(\\kappa r)}{r}$. Its derivative is $f'(r) = \\frac{\\kappa r \\cosh(\\kappa r) - \\sinh(\\kappa r)}{r^2}$. For $\\kappa r > 0$, it is a known property that $\\tanh(x) < x$, which implies $\\sinh(x) < x \\cosh(x)$. Therefore, the numerator is always positive for $r>0$, meaning $f(r)$ is a strictly increasing function of $r$. The maximum value of $|\\Delta(r; R)|$ on the interval $[0, r_d]$ must therefore occur at the boundary $r=r_d$.\n\nThe condition on the buffer becomes:\n$$ |\\Delta(r_d; R)| = |z|\\ell_B \\frac{e^{-\\kappa R}}{\\sinh(\\kappa R)} \\frac{\\sinh(\\kappa r_d)}{r_d} \\le \\tau $$\nWe can rewrite the $R$-dependent term as $\\frac{e^{-\\kappa R}}{\\sinh(\\kappa R)} = \\frac{2}{e^{2\\kappa R} - 1}$. The inequality becomes:\n$$ \\frac{2}{e^{2\\kappa R} - 1} \\le \\frac{\\tau r_d}{|z|\\ell_B \\sinh(\\kappa r_d)} $$\nSince the left hand side is a decreasing function of $R$, the minimal $R$ that satisfies this condition is found by solving the equality:\n$$ e^{2\\kappa R} - 1 = \\frac{2|z|\\ell_B \\sinh(\\kappa r_d)}{\\tau r_d} \\implies R = \\frac{1}{2\\kappa} \\ln\\left(1 + \\frac{2|z|\\ell_B \\sinh(\\kappa r_d)}{\\tau r_d}\\right) $$\nThis expression gives the required computational radius $R$. The requested buffer thickness is $B = R - r_d$. If this calculation yields an $R < r_d$, it means that a computational radius of $r_d$ (i.e., a zero buffer) is already sufficient to meet the error tolerance. Thus, the minimal required buffer thickness is given by:\n$$ B = \\max\\left(0, \\frac{1}{2\\kappa} \\ln\\left(1 + \\frac{2|z|\\ell_B \\sinh(\\kappa r_d)}{\\tau r_d}\\right) - r_d\\right) $$\nThis is the final expression to be implemented.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimal buffer thickness for solving the linearized Poisson-Boltzmann\n    equation in a finite spherical domain.\n    \"\"\"\n    \n    # Test cases: (z, kappa, r_d, tau, l_B)\n    # z: solute valence (dimensionless)\n    # kappa: Debye screening parameter (nm^-1)\n    # r_d: domain-of-interest radius (nm)\n    # tau: absolute bias threshold (dimensionless)\n    # l_B: Bjerrum length (nm)\n    test_cases = [\n        (1, 0.1, 1.0, 0.01, 0.714),\n        (2, 0.5, 2.0, 0.005, 0.714),\n        (4, 0.2, 3.0, 0.0001, 0.714),\n        (1, 1.0, 0.5, 0.02, 0.714)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        z, kappa, r_d, tau, l_B = case\n\n        # Derived formula for the minimal computational radius R.\n        # R = (1/(2*kappa)) * ln(1 + (2*|z|*l_B*sinh(kappa*r_d)) / (tau*r_d))\n        \n        # Absolute value of z should be used as per the derivation of the absolute bias.\n        abs_z = np.abs(z)\n\n        # To avoid potential division by zero if r_d is zero, although problem constraints\n        # imply r_d > 0.\n        if r_d == 0:\n            # At r_d = 0, the problem is ill-defined. In the limit r_d -> 0, sinh(kappa*r_d)/r_d -> kappa.\n            # However, the physical scenario and bias definition become ambiguous at the point charge.\n            # Assuming r_d > 0 based on the problem context.\n            pass\n\n        # Argument inside the logarithm\n        log_argument = 1.0 + (2.0 * abs_z * l_B * np.sinh(kappa * r_d)) / (tau * r_d)\n\n        R = (1.0 / (2.0 * kappa)) * np.log(log_argument)\n\n        # The buffer thickness is B = R - r_d.\n        # If the calculated R is less than r_d, it means the error tolerance\n        # is met even with a zero buffer (R = r_d).\n        # Hence, the buffer thickness cannot be negative.\n        B = np.maximum(0.0, R - r_d)\n        \n        results.append(f\"{B:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}