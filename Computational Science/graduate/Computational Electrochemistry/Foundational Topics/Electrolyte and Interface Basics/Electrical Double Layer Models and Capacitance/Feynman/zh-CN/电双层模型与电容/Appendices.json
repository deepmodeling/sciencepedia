{
    "hands_on_practices": [
        {
            "introduction": "理解电双层的第一步是从其最简化的形式开始：线性化的泊松-玻尔兹曼（Poisson-Boltzmann）理论。本练习将引导你通过解析推导来求解这个基本模型，揭示电极表面附近电势呈指数衰减的特性。通过这个实践，你将亲手推导出德拜长度（Debye length）$ \\kappa^{-1} $这一核心概念，并掌握在小电势近似下电势分布和表面电荷密度的计算方法。",
            "id": "4243279",
            "problem": "考虑一个半无限的平面电解质，其占据 $x \\geq 0$ 的空间，并与一个位于 $x=0$ 处、均匀带电的理想极化金属电极相邻。该电解质为处于热平衡状态的对称 $z:z$ 二元电解质，每种离子的体数密度为 $n_{\\infty}$，绝对温度为 $T$，介电常数为 $\\varepsilon = \\varepsilon_{0}\\varepsilon_{r}$，其中 $\\varepsilon_{0}$ 是真空介电常数，$\\varepsilon_{r}$ 是相对介电常数。设静电势为 $ \\phi(x) $，其边界条件为 $ \\phi(0) = \\phi_{0} $（恒定表面电势）以及当 $ x \\to \\infty $ 时 $ \\phi(x) \\to 0 $。假设电势足够小，以至于离子的玻尔兹曼分布可以被线性化。\n\n从一维泊松方程 $ \\partial_{x}^{2}\\phi(x) = -\\rho(x)/\\varepsilon $ 和离子数密度的玻尔兹曼分布出发，推导适用于此几何构型的线性化泊松-玻尔兹曼 (PB) 方程。然后，求解得到的边值问题以获得 $ \\phi(x) $，并使用麦克斯韦边界条件计算相应的表面电荷密度 $ \\sigma = -\\varepsilon\\, \\partial_{x}\\phi|_{x=0} $。用 $ \\phi_{0} $ 和线性化过程中出现的逆德拜屏蔽参数 $ \\kappa $ 来表示你的最终结果。以闭合形式的解析表达式给出最终答案。不要代入数值。",
            "solution": "本问题要求推导并求解与带电平面电极相邻的半无限对称电解质中静电势的线性化泊松-玻尔兹曼方程，然后计算电极上的表面电荷密度。\n\n分析始于静电势 $\\phi(x)$ 的一维泊松方程：\n$$\n\\frac{d^2\\phi(x)}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon}\n$$\n其中 $\\rho(x)$ 是电解质中的局部体积电荷密度，$\\varepsilon$ 是介质的介电常数。该电解质是一种对称的 $z:z$ 二元电解质，意味着它由带电量为 $+ze$ 的阳离子和带电量为 $-ze$ 的阴离子组成，其中 $z$ 是化合价，$e$ 是元电荷。\n\n在热平衡状态下，阳离子 $n_+(x)$ 和阴离子 $n_-(x)$ 的局部数密度由玻尔兹曼分布描述：\n$$\nn_+(x) = n_{\\infty} \\exp\\left(-\\frac{ze\\phi(x)}{k_B T}\\right)\n$$\n$$\nn_-(x) = n_{\\infty} \\exp\\left(-\\frac{(-ze)\\phi(x)}{k_B T}\\right) = n_{\\infty} \\exp\\left(\\frac{ze\\phi(x)}{k_B T}\\right)\n$$\n此处，$n_{\\infty}$ 是每种离子的体数密度（在电势 $\\phi$ 为零处），$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n净电荷密度 $\\rho(x)$ 是阳离子和阴离子电荷贡献的总和：\n$$\n\\rho(x) = (+ze)n_+(x) + (-ze)n_-(x) = ze(n_+(x) - n_-(x))\n$$\n代入 $n_+(x)$ 和 $n_-(x)$ 的玻尔兹曼分布，得到：\n$$\n\\rho(x) = zen_{\\infty} \\left[ \\exp\\left(-\\frac{ze\\phi(x)}{k_B T}\\right) - \\exp\\left(\\frac{ze\\phi(x)}{k_B T}\\right) \\right]\n$$\n这可以用双曲正弦函数 $\\sinh(u) = \\frac{1}{2}(\\exp(u) - \\exp(-u))$ 来表示：\n$$\n\\rho(x) = -2zen_{\\infty} \\sinh\\left(\\frac{ze\\phi(x)}{k_B T}\\right)\n$$\n将此式代入泊松方程，得到完整的非线性泊松-玻尔兹曼方程：\n$$\n\\frac{d^2\\phi(x)}{dx^2} = \\frac{2zen_{\\infty}}{\\varepsilon} \\sinh\\left(\\frac{ze\\phi(x)}{k_B T}\\right)\n$$\n题目说明电势足够小，这对应于条件 $|ze\\phi(x)| \\ll k_B T$。这使得指数项或等效地，双曲正弦函数可以被线性化。对于小自变量 $u$，有 $\\sinh(u) \\approx u$。因此，我们近似为：\n$$\n\\sinh\\left(\\frac{ze\\phi(x)}{k_B T}\\right) \\approx \\frac{ze\\phi(x)}{k_B T}\n$$\n于是，线性化的电荷密度为：\n$$\n\\rho(x) \\approx -2zen_{\\infty} \\left(\\frac{ze\\phi(x)}{k_B T}\\right) = -\\left(\\frac{2z^2e^2n_{\\infty}}{k_B T}\\right)\\phi(x)\n$$\n将这个线性化的电荷密度代入泊松方程，得到线性化的泊松-玻尔兹曼方程，也称为德拜-休克尔方程：\n$$\n\\frac{d^2\\phi(x)}{dx^2} = -\\frac{1}{\\varepsilon} \\left[ -\\left(\\frac{2z^2e^2n_{\\infty}}{k_B T}\\right)\\phi(x) \\right] = \\left(\\frac{2z^2e^2n_{\\infty}}{\\varepsilon k_B T}\\right)\\phi(x)\n$$\n我们定义逆德拜屏蔽参数 $\\kappa$ 为：\n$$\n\\kappa^2 = \\frac{2z^2e^2n_{\\infty}}{\\varepsilon k_B T}\n$$\n$\\kappa$ 的单位是长度的倒数。特征长度 $1/\\kappa$ 被称为德拜长度。\n于是，线性化的泊松-玻尔兹曼方程可以紧凑地写为：\n$$\n\\frac{d^2\\phi(x)}{dx^2} = \\kappa^2 \\phi(x)\n$$\n这是一个二阶线性齐次常微分方程。其通解为：\n$$\n\\phi(x) = C_1 \\exp(\\kappa x) + C_2 \\exp(-\\kappa x)\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n第一个边界条件是，在远离电极的电解质本体中，电势消失：当 $x \\to \\infty$ 时，$\\phi(x) \\to 0$。应用此条件：\n$$\n\\lim_{x \\to \\infty} \\left( C_1 \\exp(\\kappa x) + C_2 \\exp(-\\kappa x) \\right) = 0\n$$\n由于 $\\kappa > 0$，当 $x \\to \\infty$ 时，$\\exp(\\kappa x)$ 项发散。为防止电势变为无穷大，系数 $C_1$ 必须为零。当 $x \\to \\infty$ 时，$\\exp(-\\kappa x)$ 项趋近于 0，这与边界条件一致。因此，我们必须有 $C_1=0$。\n解简化为：\n$$\n\\phi(x) = C_2 \\exp(-\\kappa x)\n$$\n第二个边界条件是电极表面的固定电势：$\\phi(0) = \\phi_0$。应用此条件：\n$$\n\\phi(0) = C_2 \\exp(-\\kappa \\cdot 0) = C_2 \\cdot 1 = C_2\n$$\n因此，$C_2 = \\phi_0$。电势分布的最终表达式为：\n$$\n\\phi(x) = \\phi_0 \\exp(-\\kappa x)\n$$\n接下来，我们计算金属电极上的表面电荷密度 $\\sigma$。它通过麦克斯韦边界条件与表面电场相关联，在问题中给出为 $\\sigma = -\\varepsilon\\, \\partial_{x}\\phi|_{x=0}$。\n首先，我们求电势 $\\phi(x)$ 对 $x$ 的导数：\n$$\n\\frac{d\\phi(x)}{dx} = \\frac{d}{dx} \\left( \\phi_0 \\exp(-\\kappa x) \\right) = \\phi_0 (-\\kappa) \\exp(-\\kappa x) = -\\kappa \\phi_0 \\exp(-\\kappa x)\n$$\n现在，我们在电极表面 $x=0$ 处计算该导数的值：\n$$\n\\left.\\frac{d\\phi}{dx}\\right|_{x=0} = -\\kappa \\phi_0 \\exp(-\\kappa \\cdot 0) = -\\kappa \\phi_0\n$$\n最后，我们将此结果代入表面电荷密度的表达式中：\n$$\n\\sigma = -\\varepsilon \\left( -\\kappa \\phi_0 \\right) = \\varepsilon \\kappa \\phi_0\n$$\n问题要求给出 $\\phi(x)$ 和 $\\sigma$ 的解析表达式。这就是所要求的两个结果。它们描述了在德拜-休克尔近似下，电势随远离电极的距离呈指数衰减，以及表面电荷与表面电势之间的线性关系。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\phi_0 \\exp(-\\kappa x)  \\varepsilon \\kappa \\phi_0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "经典的泊松-玻尔兹曼（Poisson-Boltzmann）模型将离子视为无体积的点电荷，这一简化在强电极极化下会导致理论预测的离子浓度超过物理极限。本计算实践旨在让你直面这一理论的局限性，通过编程实现并对比经典模型与考虑了离子体积（即空间拥挤效应）的修正模型。这个练习将深化你对不同电双层模型物理假设的理解，并揭示在高电势下引入离子尺寸效应的重要性。",
            "id": "4243260",
            "problem": "考虑一个与对称单价电解质接触的平面电极，在计算电化学中使用电双层的平均场理论对其进行建模。电极相对于本体溶液的电势为 $V$（单位：伏特）。本体摩尔浓度为 $c^{\\infty}$（单位：$\\mathrm{mol}/\\mathrm{m}^3$）。溶剂的相对介电常数为 $\\epsilon_{\\mathrm{r}}$，真空介电常数为 $\\epsilon_0$，因此绝对介电常数为 $\\epsilon = \\epsilon_{\\mathrm{r}} \\epsilon_0$（单位：$\\mathrm{F}/\\mathrm{m}$）。温度为 $T$（单位：$\\mathrm{K}$）。电解质离子带有化合价 $z$（无量纲），元电荷为 $e$（单位：$\\mathrm{C}$），玻尔兹曼常数为 $k_{\\mathrm{B}}$（单位：$\\mathrm{J}/\\mathrm{K}$），阿伏伽德罗常数为 $N_{\\mathrm{A}}$（单位：$\\mathrm{mol}^{-1}$）。单个离子的排除体积为 $v$（单位：$\\mathrm{m}^3$），代表空间拥挤效应。\n\n考虑两种模型：\n- 经典的泊松-玻尔兹曼（PB）模型，对于平面几何也称为Gouy-Chapman模型，该模型将离子视作点状粒子，并通过玻尔兹曼分布将离子数密度 $n^{\\infty} = N_{\\mathrm{A}} c^{\\infty}$ 与依赖于电势的电荷分布关联起来。\n- 一种拥挤受限模型，其中空间排斥将反离子的局域数密度限制为 $n_{\\max} = 1 / v$，从而对局域体积电荷密度施加了上限 $|\\rho(z)| \\leq z e n_{\\max}$。\n\n从泊松方程 $d^2 \\psi / dz^2 = -\\rho(z)/\\epsilon$ 和表面电荷密度定义 $\\sigma = -\\epsilon \\, (d\\psi/dz)\\rvert_{z=0}$ 出发，并仅使用基本的热力学和静电学原理，推导：\n- 由经典泊松-玻尔兹曼模型在平面几何中预测的表面电荷密度 $\\sigma_{\\mathrm{PB}}(V)$ 的表达式，该表达式是 $V$, $c^{\\infty}$, $z$, $e$, $k_{\\mathrm{B}}$, $T$ 和 $\\epsilon$ 的函数。\n- 在空间拥挤效应（有限的 $v$）下，与 $|\\rho(z)| \\leq z e n_{\\max}$ 和相同的静电边界条件一致的最大可达表面电荷密度 $\\sigma_{\\max}(V)$ 的严格上限，该上限是 $V$, $v$, $z$, $e$ 和 $\\epsilon$ 的函数。\n\n您的任务是实现一个完整的、可运行的程序，该程序针对给定的测试套件，为每个案例计算：\n- $\\sigma_{\\max}(V)$，单位为 $\\mathrm{C}/\\mathrm{m}^2$，\n- $\\sigma_{\\mathrm{PB}}(V)$，单位为 $\\mathrm{C}/\\mathrm{m}^2$，\n- 无量纲比率 $r = \\sigma_{\\max}(V) / \\sigma_{\\mathrm{PB}}(V)$。\n\n在您的计算中使用以下常数和假设：\n- $z = 1$,\n- $T = 298$ $\\mathrm{K}$,\n- $\\epsilon_{\\mathrm{r}} = 78.4$,\n- $\\epsilon_0 = 8.8541878128 \\times 10^{-12}$ $\\mathrm{F}/\\mathrm{m}$,\n- $e = 1.602176634 \\times 10^{-19}$ $\\mathrm{C}$,\n- $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J}/\\mathrm{K}$,\n- $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}$ $\\mathrm{mol}^{-1}$。\n\n物理单位要求：\n- 所有表面电荷密度均以 $\\mathrm{C}/\\mathrm{m}^2$ 表示。\n- 将比率 $r$ 表示为小数。\n- 将所有输出四舍五入至六位有效数字。\n\n测试套件：\n为以下参数集 $(V, c^{\\infty}, v)$ 提供计算，其中 $V$ 的单位是 $\\mathrm{V}$，$c^{\\infty}$ 的单位是 $\\mathrm{mol}/\\mathrm{m}^3$，$v$ 的单位是 $\\mathrm{m}^3$：\n- 案例 $1$：$(0.2, 1000, 3.0 \\times 10^{-29})$，\n- 案例 $2$：$(1.0, 1000, 3.0 \\times 10^{-29})$，\n- 案例 $3$：$(1.0, 100, 8.0 \\times 10^{-29})$，\n- 案例 $4$：$(0.05, 10, 2.5 \\times 10^{-29})$，\n- 案例 $5$：$(1.5, 1000, 1.0 \\times 10^{-28})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，每个内部列表对应一个测试案例，并按 $[\\sigma_{\\max}, \\sigma_{\\mathrm{PB}}, r]$ 的顺序排列，所有数字均采用十进制表示法并四舍五入至六位有效数字。例如，输出可能看起来像 $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\ldots]$，其中 $x_i$, $y_i$ 和 $z_i$ 是指定单位和精度的浮点数。",
            "solution": "推导和计算策略分三部分进行：\n1.  从泊松-玻尔兹曼模型推导表面电荷密度 $\\sigma_{\\mathrm{PB}}$。\n2.  在空间拥挤效应下推导最大表面电荷密度 $\\sigma_{\\max}$。\n3.  实现这些公式，为给定的测试案例计算所需的值。\n\n### 第一部分：表面电荷密度 $\\sigma_{\\mathrm{PB}}(V)$ 的推导（泊松-玻尔兹曼模型）\n\n出发点是描述静电势 $\\psi(z)$ 作为与平面电极距离 $z$ 的函数的一维泊松方程：\n$$\n\\frac{d^2\\psi}{dz^2} = -\\frac{\\rho(z)}{\\epsilon}\n$$\n其中 $\\rho(z)$ 是局域体积电荷密度，$\\epsilon$ 是溶剂的绝对介电常数（$\\epsilon = \\epsilon_{\\mathrm{r}}\\epsilon_0$）。\n\n对于对称的 $z:z$ 电解质，电荷密度由 $\\rho(z) = ze(n_+(z) - n_-(z))$ 给出，其中 $n_+$ 和 $n_-$ 分别是阳离子和阴离子的数密度。泊松-玻尔兹曼模型假设离子是点电荷，其分布遵循玻尔兹曼统计：\n$$\nn_+(z) = n^{\\infty} \\exp\\left(-\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\n$$\n$$\nn_-(z) = n^{\\infty} \\exp\\left(+\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\n$$\n此处，$n^{\\infty} = N_{\\mathrm{A}}c^{\\infty}$ 是本体离子数密度，$e$ 是元电荷，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n将这些代入 $\\rho(z)$ 的表达式，得到：\n$$\n\\rho(z) = zen^{\\infty}\\left[\\exp\\left(-\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right) - \\exp\\left(\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\\right] = -2zen^{\\infty}\\sinh\\left(\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\n$$\n因此，泊松-玻尔兹曼方程为：\n$$\n\\frac{d^2\\psi}{dz^2} = \\frac{2zen^{\\infty}}{\\epsilon}\\sinh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\n$$\n为了求解该方程以得到电场，我们乘以积分因子 $2(d\\psi/dz)$:\n$$\n2\\frac{d\\psi}{dz}\\frac{d^2\\psi}{dz^2} = \\frac{d}{dz}\\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{4zen^{\\infty}}{\\epsilon}\\sinh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\\frac{d\\psi}{dz}\n$$\n我们从电双层中的一点 $z$ 积分到无穷远，并应用本体边界条件 $\\psi(\\infty) = 0$ 和 $(d\\psi/dz)_{z\\to\\infty} = 0$:\n$$\n\\int_z^\\infty \\frac{d}{dz'}\\left(\\frac{d\\psi}{dz'}\\right)^2 dz' = \\int_z^\\infty \\frac{4zen^{\\infty}}{\\epsilon}\\sinh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\\frac{d\\psi}{dz'} dz'\n$$\n$$\n\\left[\\left(\\frac{d\\psi}{dz'}\\right)^2\\right]_z^\\infty = \\frac{4zen^{\\infty}}{\\epsilon} \\int_{\\psi(z)}^0 \\sinh\\left(\\frac{zeu}{k_{\\mathrm{B}}T}\\right) du\n$$\n$$\n0 - \\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{4zen^{\\infty}}{\\epsilon} \\left[\\frac{k_{\\mathrm{B}}T}{ze}\\cosh\\left(\\frac{zeu}{k_{\\mathrm{B}}T}\\right)\\right]_{\\psi(z)}^0\n$$\n$$\n-\\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{4n^{\\infty}k_{\\mathrm{B}}T}{\\epsilon} \\left(\\cosh(0) - \\cosh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\\right)\n$$\n使用双曲恒等式 $1 - \\cosh(x) = -2\\sinh^2(x/2)$:\n$$\n\\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{8n^{\\infty}k_{\\mathrm{B}}T}{\\epsilon}\\sinh^2\\left(\\frac{ze\\psi}{2k_{\\mathrm{B}}T}\\right)\n$$\n电极上的表面电荷密度定义为 $\\sigma = -\\epsilon (d\\psi/dz)\\rvert_{z=0}$。对上述表达式取平方根（取适当的符号以确保 $\\psi$ 从表面电势 $V$ 衰减到 $0$），并在 $z=0$ 处（此时 $\\psi(0)=V$）求值：\n$$\n\\sigma_{\\mathrm{PB}}(V) = \\sqrt{8\\epsilon k_{\\mathrm{B}}T n^{\\infty}} \\sinh\\left(\\frac{zeV}{2k_{\\mathrm{B}}T}\\right)\n$$\n代入指定的 $n^{\\infty} = N_{\\mathrm{A}} c^{\\infty}$，$\\epsilon = \\epsilon_{\\mathrm{r}}\\epsilon_0$ 和 $z=1$，得到用于计算的最终公式。\n\n### 第二部分：最大表面电荷密度 $\\sigma_{\\max}(V)$ 的推导（空间拥挤效应）\n\n该模型对离子的局域数密度施加了物理限制，$n(z) \\le n_{\\max} = 1/v$，其中 $v$ 是单个离子的排除体积。这为局域电荷密度的量值设定了上限：$|\\rho(z)| \\le ze n_{\\max}$。我们将此最大电荷密度定义为 $\\rho_{\\max} = ze/v$。\n\n电极上的表面电荷密度与扩散层中的总积分电荷大小相等、符号相反：\n$$\n\\sigma = -\\int_0^\\infty \\rho(z) dz\n$$\n为找到给定正电势 $V > 0$ 时 $\\sigma$ 的严格上限，我们必须找到能使该积分最大化的电荷分布 $\\rho(z)$，同时满足约束条件 $|\\rho(z)| \\le \\rho_{\\max}$ 且该分布能产生电势 $\\psi(0)=V$。为了最大化一个正的 $\\sigma$，$\\rho(z)$ 的积分必须尽可能为负。这可以通过从电极表面开始的一个区域内将 $\\rho(z)$ 设置为其最负值 $-\\rho_{\\max}$ 来实现。对于给定电势，使电荷最大化的分布是一个紧密的抗衡离子层：\n$$\n\\rho(z) =\n\\begin{cases}\n-\\rho_{\\max}  \\text{for } 0 \\le z \\le \\delta \\\\\n0  \\text{for } z > \\delta\n\\end{cases}\n$$\n这个紧密层的厚度 $\\delta$ 由电势 $V$ 决定。我们对这个电荷分布求解泊松方程：$d^2\\psi/dz^2 = -(-\\rho_{\\max})/\\epsilon = \\rho_{\\max}/\\epsilon$，其中 $z \\in [0, \\delta]$。\n积分一次得到电场：$d\\psi/dz = (\\rho_{\\max}/\\epsilon)z + C_1$。\n再次积分得到电势：$\\psi(z) = (\\rho_{\\max}/(2\\epsilon))z^2 + C_1z + C_2$。\n\n边界条件是：\n1.  $\\psi(0) = V$（电极处的电势）。\n2.  $\\psi(\\delta) = 0$（紧密层边缘的电势为零）。\n3.  $(d\\psi/dz)\\rvert_{z=\\delta} = 0$（紧密层边缘的电场为零，因为当 $z > \\delta$ 时没有电荷）。\n\n根据条件 1：$C_2 = V$。\n根据条件 3：$(\\rho_{\\max}/\\epsilon)\\delta + C_1 = 0 \\implies C_1 = -(\\rho_{\\max}/\\epsilon)\\delta$。\n根据条件 2：\n$$\n\\frac{\\rho_{\\max}}{2\\epsilon}\\delta^2 - \\left(\\frac{\\rho_{\\max}}{\\epsilon}\\delta\\right)\\delta + V = 0 \\implies -\\frac{\\rho_{\\max}}{2\\epsilon}\\delta^2 + V = 0\n$$\n求解 $\\delta$：\n$$\n\\delta = \\sqrt{\\frac{2\\epsilon V}{\\rho_{\\max}}}\n$$\n现在，我们计算此构型下的表面电荷：\n$$\n\\sigma_{\\max} = -\\int_0^\\delta (-\\rho_{\\max}) dz = \\rho_{\\max}\\delta = \\rho_{\\max}\\sqrt{\\frac{2\\epsilon V}{\\rho_{\\max}}} = \\sqrt{2\\epsilon V \\rho_{\\max}}\n$$\n代入 $\\rho_{\\max} = ze/v$（其中 $z=1$）和 $\\epsilon = \\epsilon_{\\mathrm{r}}\\epsilon_0$：\n$$\n\\sigma_{\\max}(V) = \\sqrt{\\frac{2\\epsilon_{\\mathrm{r}}\\epsilon_0eV}{v}}\n$$\n此表达式给出了在空间约束下，对于给定电势 $V$ 的最大可能表面电荷。\n\n### 第三部分：计算实现\n\n推导出的 $\\sigma_{\\mathrm{PB}}(V)$ 和 $\\sigma_{\\max}(V)$ 公式在 Python 中实现。该程序为每个测试案例计算这些值及其比率 $r = \\sigma_{\\max}(V) / \\sigma_{\\mathrm{PB}}(V)$。一个自定义的格式化函数确保所有数值输出都按要求以标准十进制表示法四舍五入到六位有效数字。对于 $V>0$ 的测试案例，$\\sigma_{\\mathrm{PB}}$ 和 $\\sigma_{\\max}$ 均为正值。比率 $r$ 提供了一个无量纲的度量，衡量与理想点离子模型相比，空间效应如何限制表面电荷。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates surface charge densities for Poisson-Boltzmann and crowding-limited models\n    of the electrical double layer.\n    \"\"\"\n    \n    # Define physical constants\n    Z = 1.0  # Ion valence (dimensionless)\n    T = 298.0  # Temperature (K)\n    EPS_R = 78.4  # Relative permittivity of the solvent (dimensionless)\n    EPS_0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    E = 1.602176634e-19  # Elementary charge (C)\n    K_B = 1.380649e-23  # Boltzmann constant (J/K)\n    N_A = 6.02214076e23  # Avogadro number (mol^-1)\n    \n    # Derived constant\n    EPS = EPS_R * EPS_0  # Absolute permittivity (F/m)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (V, c_inf, v)\n    # V: potential (V)\n    # c_inf: bulk concentration (mol/m^3)\n    # v: per-ion excluded volume (m^3)\n    test_cases = [\n        (0.2, 1000, 3.0e-29),\n        (1.0, 1000, 3.0e-29),\n        (1.0, 100, 8.0e-29),\n        (0.05, 10, 2.5e-29),\n        (1.5, 1000, 1.0e-28),\n    ]\n\n    def custom_format(value, sig_figs=6):\n        \"\"\"\n        Formats a number to a specified number of significant figures in decimal notation.\n        \"\"\"\n        if value == 0:\n            return \"0.0\"\n\n        # Determine the number of decimal places needed for rounding\n        power = np.floor(np.log10(np.abs(value)))\n        round_digits = sig_figs - 1 - int(power)\n\n        if round_digits  0:\n            # Handle rounding to the left of the decimal point\n            scale = 10**(-round_digits)\n            # Use np.round for standard rounding, then convert to int to drop .0\n            rounded = np.round(value / scale) * scale\n            return str(int(rounded))\n        else:\n            # Handle rounding to the right of the decimal point\n            # Use f-string formatting to ensure correct number of trailing zeros\n            return f\"{value:.{round_digits}f}\"\n\n    results = []\n    for V, c_inf, v in test_cases:\n        # Calculate Poisson-Boltzmann surface charge density (sigma_pb)\n        n_inf = N_A * c_inf  # Bulk number density (m^-3)\n        sinh_arg = (Z * E * V) / (2 * K_B * T)\n        sigma_pb = np.sqrt(8 * EPS * K_B * T * n_inf) * np.sinh(sinh_arg)\n\n        # Calculate maximum surface charge density under steric crowding (sigma_max)\n        # Note: All V are positive, so np.sqrt is safe.\n        rho_max = (Z * E) / v\n        sigma_max = np.sqrt(2 * EPS * V * rho_max)\n        \n        # Calculate the dimensionless ratio\n        r = sigma_max / sigma_pb\n        \n        # Format results to six significant figures\n        formatted_sigma_max = custom_format(sigma_max, 6)\n        formatted_sigma_pb = custom_format(sigma_pb, 6)\n        formatted_r = custom_format(r, 6)\n        \n        results.append([formatted_sigma_max, formatted_sigma_pb, formatted_r])\n\n    # Construct the final output string in the specified format\n    row_strs = []\n    for row in results:\n        row_strs.append(f\"[{','.join(row)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(row_strs)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "之前的练习侧重于电双层在平衡态下的静态结构，但电双层的形成并非瞬时完成。这个高级计算实践将引导你从静态描述过渡到动态行为，通过求解时间相关的德拜-法尔肯哈根（Debye-Falkenhagen）方程来模拟电双层对电势阶跃的响应。你将学习如何建立并求解一个描述离子输运与静电耦合的偏微分方程，并从计算出的瞬态信号中提取关键的动力学参数——电双层充电时间常数 $\\tau$。",
            "id": "4243308",
            "problem": "要求您模拟在一个平面阻塞电极上，当电极电势发生微小阶跃变化后，电双层中静电势和表面电荷的时间演化。假设电解质为对称单价电解质，并使用适用于小电势的线性化泊松-玻尔兹曼和能斯特-普朗克框架。必须在垂直于电极的一维空间上求解阶跃响应，并且必须从瞬态表面电荷信号中提取有效时间常数。\n\n从计算电化学的基本定律和定义出发：\n\n- 静电势$\\,\\phi(x,t)\\,$的泊松方程将净电荷密度$\\,\\rho(x,t)\\,$与静电场联系起来：$$\\frac{\\partial^2 \\phi}{\\partial x^2} = - \\frac{\\rho}{\\varepsilon},$$ 其中$\\,\\varepsilon\\,$是介质的介电常数。\n- 物种$\\,i\\,$的能斯特-普朗克(NP)通量为$\\,J_i = -D_i\\left(\\frac{\\partial c_i}{\\partial x} + \\frac{z_i e}{k_{\\mathrm{B}} T} c_i \\frac{\\partial \\phi}{\\partial x}\\right)\\,$，其中$\\,D_i\\,$是扩散系数，$\\,c_i\\,$是浓度，$\\,z_i\\,$是化合价，$\\,e\\,$是元电荷，$\\,k_{\\mathrm{B}}\\,$是玻尔兹曼常数，$\\,T\\,$是绝对温度。在电势阶跃前，体相中满足电中性。\n- 在对称$\\,z:z\\,$电解质中，围绕$\\,\\phi=0\\,$的线性化区域内，组合的泊松-玻尔兹曼(PB)关系给出$\\,\\rho(x,t) \\approx -\\varepsilon \\kappa^2 \\phi(x,t)\\,$，其中德拜参数$\\,\\kappa\\,$由下式定义：$$\\kappa^2 = \\frac{2 z^2 e^2 N_{\\mathrm{A}} c_\\infty}{\\varepsilon k_{\\mathrm{B}} T},$$ 其中$\\,N_{\\mathrm{A}}\\,$是阿伏伽德罗常数，$\\,c_\\infty\\,$是体相浓度。在线性化的PB-NP框架下，电势服从Debye–Falkenhagen (DF)方程：$$\\frac{\\partial \\phi}{\\partial t} = D \\left(\\frac{\\partial^2 \\phi}{\\partial x^2} - \\kappa^2 \\phi\\right),$$ 为简化起见，假设阳离子和阴离子的扩散系数$\\,D\\,$相同。\n- 界面处有限的斯特恩层电容$\\,C_{\\mathrm{S}}\\,$施加了一个混合(Robin)边界条件，将界面电势$\\,\\phi(0,t)\\,$和表面电荷密度$\\,\\sigma(t)\\,$通过$$\\sigma(t) = C_{\\mathrm{S}}\\big(\\Delta\\phi - \\phi(0,t)\\big),$$联系起来，其中$\\,\\Delta\\phi\\,$是施加的电极电势阶跃，且$\\,\\sigma(t) = -\\varepsilon\\,\\frac{\\partial \\phi}{\\partial x}\\big|_{x=0^+}\\,$。在计算域的外边界$\\,x=L\\,$处，施加$\\,\\phi(L,t) = 0\\,$以表示体相。\n- 初始条件为$\\,\\phi(x,0)=0\\,$ (对于$\\,x0\\,$)。\n\n在一维域$\\,x \\in [0,L]\\,$内，使用无条件稳定的时间离散化和二阶空间离散化方法为DF方程实现一个鲁棒的数值求解器，该求解器需满足上述边界条件。计算在$\\,t=0^+\\,$时发生阶跃变化$\\,\\Delta\\phi\\,$后，表面电荷密度$\\,\\sigma(t)\\,$的时间演化。将有效充电时间常数$\\,\\tau\\,$定义为$\\,\\sigma(t)\\,$达到其稳态值$\\,\\sigma_\\infty\\,$的$\\,1 - e^{-1}\\,$倍时所对应的时间。以秒为单位表示$\\,\\tau\\,$，并将每个返回的值四舍五入到六位有效数字。\n\n所有物理量必须使用国际单位制(SI)处理：秒($\\,\\mathrm{s}\\,$)、米($\\,\\mathrm{m}\\,$)、伏特($\\,\\mathrm{V}\\,$)、法拉每平方米($\\,\\mathrm{F/m^2}\\,$)、摩尔每立方米($\\,\\mathrm{mol/m^3}\\,$)。\n\n您的程序必须使用以下SI单位的常数：$\\,\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}\\,$，水的相对介电常数$\\,\\varepsilon_r = 78.5\\,$，因此$\\,\\varepsilon = \\varepsilon_r \\varepsilon_0\\,$，$\\,k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}\\,$，$\\,T = 298\\ \\mathrm{K}\\,$，$\\,e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}\\,$，$\\,N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}\\,$，以及$\\,z=1\\,$.\n\n数值细节和算法约束：\n- 对DF方程使用隐式时间步进格式，空间上使用二阶中心差分。\n- 在$\\,x=0\\,$处施加线性Robin条件作为斯特恩边界，在$\\,x=L\\,$处施加狄利克雷条件$\\,\\phi(L,t)=0\\,$。\n- 自适应地选择空间步长$\\,\\Delta x\\,$为$\\,\\Delta x = \\min\\left(\\lambda_{\\mathrm{D}}/8,\\ L/400\\right)\\,$，其中$\\,\\lambda_{\\mathrm{D}} = 1/\\kappa\\,$是德拜长度；选择总模拟时间$\\,T_{\\mathrm{end}} = 50/\\left(D\\kappa^2\\right)\\,$，并使用$\\,5000\\,$个均匀的时间步长，使得$\\,\\Delta t = T_{\\mathrm{end}}/5000\\,$。\n- 使用斯特恩关系$\\,\\sigma(t) = C_{\\mathrm{S}}(\\Delta\\phi - \\phi(0,t))\\,$计算$\\,\\sigma(t)\\,$。\n- 从稳态一致性解析地确定$\\,\\sigma_\\infty\\,$，并用它来提取由$\\,\\sigma(\\tau) = \\sigma_\\infty \\left(1 - e^{-1}\\right)\\,$定义的$\\,\\tau\\,$。使用相邻时间样本之间的线性插值来精确计算$\\,\\tau\\,$。\n\n测试套件：\n提供以下四组参数集的结果。每个测试用例都是独立的，必须从给定的初始条件开始计算。\n\n- 测试用例1：$\\,c_\\infty = 0.1\\ \\mathrm{mol/L}\\,$, $\\,D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}\\,$, $\\,C_{\\mathrm{S}} = 0.2\\ \\mathrm{F/m^2}\\,$, $\\,\\Delta\\phi = 0.025\\ \\mathrm{V}\\,$, $\\,L = 1.0\\times 10^{-7}\\ \\mathrm{m}\\,$。\n- 测试用例2：$\\,c_\\infty = 0.001\\ \\mathrm{mol/L}\\,$, $\\,D = 1.5\\times 10^{-9}\\ \\mathrm{m^2/s}\\,$, $\\,C_{\\mathrm{S}} = 0.2\\ \\mathrm{F/m^2}\\,$, $\\,\\Delta\\phi = 0.010\\ \\mathrm{V}\\,$, $\\,L = 1.0\\times 10^{-6}\\ \\mathrm{m}\\,$。\n- 测试用例3：$\\,c_\\infty = 0.1\\ \\mathrm{mol/L}\\,$, $\\,D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}\\,$, $\\,C_{\\mathrm{S}} = 5.0\\ \\mathrm{F/m^2}\\,$, $\\,\\Delta\\phi = 0.025\\ \\mathrm{V}\\,$, $\\,L = 1.0\\times 10^{-7}\\ \\mathrm{m}\\,$。\n- 测试用例4：$\\,c_\\infty = 0.1\\ \\mathrm{mol/L}\\,$, $\\,D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}\\,$, $\\,C_{\\mathrm{S}} = 0.02\\ \\mathrm{F/m^2}\\,$, $\\,\\Delta\\phi = 0.025\\ \\mathrm{V}\\,$, $\\,L = 1.0\\times 10^{-7}\\ \\mathrm{m}\\,$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的结果以秒为单位，每个值都四舍五入到六位有效数字，并按上述测试用例的顺序排列，例如：$$[\\tau_1,\\tau_2,\\tau_3,\\tau_4].$$",
            "solution": "用户要求基于线性化的泊松-玻尔兹曼和能斯特-普朗克框架，通过数值求解来模拟电双层对电势阶跃的瞬态响应。该问题在科学上是合理的、良定的，并包含了求解所需的所有必要信息。\n\n### 第1部分：物理模型和控制方程\n\n问题的核心是在对称单价电解质中，随时间变化的静电势$\\phi(x,t)$。对于小电势扰动，其演化由Debye-Falkenhagen (DF)方程控制，这是一个线性偏微分方程(PDE)：\n$$ \\frac{\\partial \\phi}{\\partial t} = D \\left(\\frac{\\partial^2 \\phi}{\\partial x^2} - \\kappa^2 \\phi\\right) $$\n这里，$\\,D\\,$是离子扩散系数，$\\kappa$是德拜长度$\\lambda_{\\mathrm{D}}$的倒数，由$\\kappa^2 = \\frac{2 z^2 e^2 N_{\\mathrm{A}} c_\\infty}{\\varepsilon k_{\\mathrm{B}} T}$定义，其中各个符号代表其标准的物理意义（化合价、元电荷、阿伏伽德罗常数、体相浓度、介电常数、玻尔兹曼常数和温度）。\n\n问题定义在一维空间域$x \\in [0,L]$上。\n- 初始状态是平衡态，因此初始条件为$\\phi(x,0) = 0$。\n- 位于$x=L$的边界设置在电解质体相深处，那里电势为零，因此施加一个狄利克雷条件：$\\phi(L,t) = 0$。\n- 位于$x=0$的边界代表电极-电解质界面，该界面包含一个电容为$C_{\\mathrm{S}}$的斯特恩层。施加的电势阶跃为$\\Delta\\phi$。表面电荷密度$\\sigma(t)$、斯特恩层上的电势降以及外亥姆霍兹平面上的电势$\\phi(0,t)$之间的关系由$\\sigma(t) = C_{\\mathrm{S}}(\\Delta\\phi - \\phi(0,t))$给出。界面处的高斯定律将表面电荷与电场联系起来：$\\sigma(t) = -\\varepsilon\\frac{\\partial \\phi}{\\partial x}\\big|_{x=0}$。将这两者结合起来得到一个混合(Robin)边界条件：\n$$ -\\varepsilon\\frac{\\partial \\phi}{\\partial x}\\bigg|_{x=0} = C_{\\mathrm{S}}\\big(\\Delta\\phi - \\phi(0,t)\\big) $$\n\n### 第2部分：数值离散化\n\n为了数值求解DF方程，我们使用有限差分法。空间域$[0,L]$被离散为$N_{int}$个宽度为$\\Delta x$的区间，得到$N_x = N_{int}+1$个网格点$x_i = i\\Delta x$。时间被离散为大小为$\\Delta t$的步长，$t_n = n\\Delta t$。在网格点$i$和时间步$n$的电势记为$\\phi_i^n$。\n\n该偏微分方程使用二阶中心差分来处理空间导数，并使用后向欧拉法来处理时间导数，以确保题目要求的无条件稳定性。对于任意内部网格点$i$ ($1 \\le i \\le N_x-2$)，离散化的方程为：\n$$ \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = D \\left( \\frac{\\phi_{i-1}^{n+1} - 2\\phi_i^{n+1} + \\phi_{i+1}^{n+1}}{(\\Delta x)^2} - \\kappa^2 \\phi_i^{n+1} \\right) $$\n重新整理该方程，将时间步$n+1$的未知项组合在左侧，得到：\n$$ -\\alpha \\phi_{i-1}^{n+1} + (1 + 2\\alpha + D\\Delta t \\kappa^2) \\phi_i^{n+1} - \\alpha \\phi_{i+1}^{n+1} = \\phi_i^n $$\n其中$\\alpha = \\frac{D \\Delta t}{(\\Delta x)^2}$。\n\n边界条件按如下方式并入：\n-   在$x=L$ ($i=N_{int}=N_x-1$)处，狄利克雷条件为$\\phi_{N_x-1}^{n+1} = 0$。\n-   在$x=0$ ($i=0$)处，对Robin条件进行离散化。为保持二阶空间精度，我们引入一个位于$x_{-1}=-\\Delta x$的“虚拟”点，并使用中心差分来计算梯度：$\\frac{\\partial \\phi}{\\partial x}\\big|_{x=0} \\approx \\frac{\\phi_1 - \\phi_{-1}}{2\\Delta x}$。将此代入Robin条件，使我们能够用域内的电势来表示虚拟点电势$\\phi_{-1}^{n+1}$。然后将此$\\phi_{-1}^{n+1}$的表达式代入为点$i=0$写的离散化DF方程中。这为$\\phi_0^{n+1}$和$\\phi_1^{n+1}$产生了一个修正后的第一个方程：\n$$ (1 + 2\\alpha + D\\Delta t \\kappa^2 + \\beta) \\phi_0^{n+1} - 2\\alpha \\phi_1^{n+1} = \\phi_0^n + \\beta \\Delta\\phi $$\n其中$\\beta = \\frac{2 D \\Delta t C_{\\mathrm{S}}}{\\varepsilon \\Delta x}$。\n\n这组$N_x-1$个线性方程（对于$i=0, \\dots, N_x-2$）构成了一个形式为$A\\mathbf{\\Phi}^{n+1} = \\mathbf{b}^n$的三对角系统，其中$\\mathbf{\\Phi}^{n+1}$是未知电势的向量$[\\phi_0^{n+1}, \\dots, \\phi_{N_x-2}^{n+1}]^T$。这个系统可以在每个时间步使用托马斯算法高效求解，该算法在`scipy.linalg.solve_banded`中可用。\n\n### 第3部分：时间常数提取\n\n模拟通过从$t=0$开始迭代求解矩阵系统，直到达到总模拟时间$T_{\\mathrm{end}}$。在每个时间步$t_n$，界面处的电势$\\phi(0, t_n) = \\phi_0^n$被用来计算表面电荷密度：\n$$ \\sigma(t_n) = C_{\\mathrm{S}}(\\Delta\\phi - \\phi_0^n) $$\n该过程持续进行，直到系统接近其稳态。稳态表面电荷$\\sigma_\\infty$通过在原始偏微分方程中设置$\\frac{\\partial \\phi}{\\partial t} = 0$并求解所得的常微分方程来解析确定。这得到：\n$$ \\sigma_\\infty = \\frac{C_{\\mathrm{S}} \\varepsilon \\kappa}{C_{\\mathrm{S}} + \\varepsilon \\kappa} \\Delta\\phi $$\n这对应于串联的斯特恩电容$C_{\\mathrmS}$和扩散层(Gouy-Chapman)电容$C_{\\mathrm{D}} = \\varepsilon\\kappa$上存储的总电荷。\n\n有效充电时间常数$\\tau$被定义为表面电荷达到其最终稳态值的$(1 - e^{-1})$倍时的时间。我们计算这个目标电荷$\\sigma_{\\text{target}} = \\sigma_\\infty (1 - e^{-1})$，在模拟过程中监测计算出的$\\sigma(t_n)$，并找出包含$\\tau$的两个连续时间点$t_{k-1}$和$t_k$（即$\\sigma(t_{k-1}) \\le \\sigma_{\\text{target}} \\le \\sigma(t_k)$）。然后通过在这两点之间进行线性插值来找到$\\tau$的精确值：\n$$ \\tau = t_{k-1} + (t_k - t_{k-1}) \\frac{\\sigma_{\\text{target}} - \\sigma(t_{k-1})}{\\sigma(t_k) - \\sigma(t_{k-1})} $$\n每个测试用例的最终结果是这个$\\tau$值，四舍五入到六位有效数字。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Physical Constants in SI units\n    EPS0 = 8.8541878128e-12  # F/m\n    EPS_R = 78.5\n    EPS = EPS_R * EPS0\n    KB = 1.380649e-23  # J/K\n    T = 298.0  # K\n    E = 1.602176634e-19  # C\n    NA = 6.02214076e+23  # 1/mol\n    Z = 1.0\n\n    constants = {\n        'eps': EPS,\n        'kB': KB,\n        'T': T,\n        'e': E,\n        'Na': NA,\n        'z': Z\n    }\n\n    test_cases = [\n        # c_inf [mol/L], D [m^2/s], Cs [F/m^2], dPhi [V], L [m]\n        (0.1, 1.0e-9, 0.2, 0.025, 1.0e-7),\n        (0.001, 1.5e-9, 0.2, 0.010, 1.0e-6),\n        (0.1, 1.0e-9, 5.0, 0.025, 1.0e-7),\n        (0.1, 1.0e-9, 0.02, 0.025, 1.0e-7)\n    ]\n\n    results = []\n    for params in test_cases:\n        tau = compute_tau(params, constants)\n        results.append(tau)\n\n    # Format output to six significant figures.\n    formatted_results = [_format_to_6_sig_figs(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef _format_to_6_sig_figs(num):\n    \"\"\"Formats a number to a string with 6 significant figures.\"\"\"\n    if num == 0:\n        return '0.00000'\n    # Use scientific notation formatting with 5 decimal places for 6 total sig figs.\n    return f\"{num:.5e}\"\n\ndef compute_tau(params, constants):\n    \"\"\"\n    Computes the effective time constant for a single set of parameters.\n    \"\"\"\n    c_inf_L, D, Cs, dPhi, L = params\n    c_inf_SI = c_inf_L * 1000.0  # Convert mol/L to mol/m^3\n\n    eps = constants['eps']\n    kB = constants['kB']\n    T = constants['T']\n    e = constants['e']\n    Na = constants['Na']\n    z = constants['z']\n\n    # --- 1. Calculate derived parameters ---\n    kappa_sq = (2 * z**2 * e**2 * Na * c_inf_SI) / (eps * kB * T)\n    kappa = np.sqrt(kappa_sq)\n    lambda_D = 1.0 / kappa\n\n    # --- 2. Set up numerical grid ---\n    # Per problem spec: dx = min(lambda_D/8, L/400)\n    num_intervals = int(max(400, np.ceil(L / (lambda_D / 8.0))))\n    dx = L / num_intervals\n    Nx = num_intervals + 1  # Number of grid points\n\n    Nt = 5000\n    T_end = 50.0 / (D * kappa_sq)\n    dt = T_end / Nt\n    \n    x = np.linspace(0, L, Nx)\n\n    # --- 3. Initialize potential and storage ---\n    phi = np.zeros(Nx)\n    \n    # We will solve for phi_0 to phi_{Nx-2}. phi_{Nx-1} is fixed at 0.\n    # The size of the linear system is Nx-1.\n    system_size = Nx - 1 \n\n    # --- 4. Assemble the tridiagonal matrix for the implicit scheme ---\n    alpha = D * dt / (dx**2)\n    beta = (2 * D * dt * Cs) / (eps * dx)\n\n    # Scipy's solve_banded uses a special storage format for banded matrices\n    # A has shape (3, system_size):\n    # row 0: upper diagonal (shifted)\n    # row 1: main diagonal\n    # row 2: lower diagonal (shifted)\n    A = np.zeros((3, system_size))\n\n    # Main diagonal\n    A[1, 0] = 1 + 2 * alpha + D * dt * kappa_sq + beta\n    A[1, 1:] = 1 + 2 * alpha + D * dt * kappa_sq\n\n    # Lower diagonal\n    A[2, 0:system_size-1] = -alpha\n\n    # Upper diagonal\n    A[0, 1] = -2 * alpha\n    A[0, 2:] = -alpha\n\n    # --- 5. Calculate steady-state and target charge ---\n    sigma_inf = (Cs * eps * kappa) / (Cs + eps * kappa) * dPhi\n    sigma_target = sigma_inf * (1 - np.exp(-1))\n\n    # --- 6. Time-stepping loop ---\n    times = np.linspace(0, T_end, Nt + 1)\n    sigmas = np.zeros(Nt + 1)\n\n    phi_k = phi[:system_size].copy() # Current potential vector (unknowns)\n\n    for n in range(1, Nt + 1):\n        # Build RHS vector b\n        b = phi_k.copy()\n        b[0] += beta * dPhi\n\n        # Solve the tridiagonal system for phi at the next time step\n        phi_k = solve_banded((1, 1), A, b, overwrite_ab=False, overwrite_b=True)\n        \n        # Calculate surface charge\n        phi_at_0 = phi_k[0]\n        sigma_t = Cs * (dPhi - phi_at_0)\n        \n        sigmas[n] = sigma_t\n        times[n] = n * dt\n        \n    # --- 7. Interpolate to find tau ---\n    tau = 0.0\n    for i in range(1, Nt + 1):\n        if sigmas[i] >= sigma_target:\n            sigma_prev = sigmas[i-1]\n            sigma_curr = sigmas[i]\n            time_prev = times[i-1]\n            time_curr = times[i]\n            \n            # Linear interpolation\n            if sigma_curr > sigma_prev:\n                fraction = (sigma_target - sigma_prev) / (sigma_curr - sigma_prev)\n                tau = time_prev + fraction * (time_curr - time_prev)\n            else: # Should not happen in a charging curve\n                tau = time_curr\n            break\n            \n    return tau\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}