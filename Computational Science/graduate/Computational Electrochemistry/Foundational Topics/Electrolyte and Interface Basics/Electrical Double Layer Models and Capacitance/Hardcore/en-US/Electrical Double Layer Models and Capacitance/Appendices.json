{
    "hands_on_practices": [
        {
            "introduction": "The Gouy-Chapman model provides the foundational description of the diffuse layer, the region of mobile ions adjacent to a charged surface. Mastering its mathematical formulation is essential for understanding how the electrical double layer (EDL) stores charge. This practice  will guide you through the derivation of the model's key prediction—the differential capacitance—and its dependence on potential and ionic strength, offering a crucial link between theory and the interpretation of experimental electrochemical data.",
            "id": "4243283",
            "problem": "A planar electrode at $x=0$ is in contact with a semi-infinite ($x>0$) aqueous electrolyte that can be modeled by the mean-field Poisson–Boltzmann theory for a symmetric $z:z$ electrolyte. Assume no specific adsorption, point-like ions, and a spatially uniform relative permittivity $\\varepsilon_{r}$. The bulk temperature is $T$, and the bulk ionic strength is $I$. The electrostatic potential is $\\phi(x)$ with boundary conditions $\\phi(x)\\to 0$ and $d\\phi/dx\\to 0$ as $x\\to\\infty$, and $\\phi(0)=\\phi_{0}$. The surface charge density is $\\sigma$, and the area-specific differential capacitance is defined by $C=\\mathrm{d}\\sigma/\\mathrm{d}\\phi_{0}$. The Poisson equation is $d^{2}\\phi/dx^{2}=-\\rho(x)/(\\varepsilon_{r}\\varepsilon_{0})$, and the local number densities obey Boltzmann statistics, $n_{\\pm}(x)=n_{0}\\exp\\!\\left(\\mp z e \\phi(x)/(k_{B}T)\\right)$, where $n_{0}$ is the bulk number density of each ionic species.\n\n(a) Starting from these premises, derive the Gouy–Chapman expression for the differential capacitance $C_{GC}(\\phi_{0},I)$ of the diffuse layer in terms of $I$ and show from this expression that $C_{GC}$ decreases monotonically as $I$ decreases when $\\phi_{0}$ is held fixed.\n\n(b) Using your derived expression, evaluate $C_{GC}$ at $\\phi_{0}=0$ for a monovalent electrolyte ($z=1$) with ionic strength $I=10\\ \\mathrm{mM}$ at $T=298\\ \\mathrm{K}$ and $\\varepsilon_{r}=78$. Express your final numerical answer as an area-specific capacitance in $\\mu\\mathrm{F}/\\mathrm{cm}^{2}$ and round to three significant figures.\n\nUse the following fundamental constants for any numerical evaluation: elementary charge $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$, vacuum permittivity $\\varepsilon_{0}=8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}$, Boltzmann constant $k_{B}=1.380649\\times 10^{-23}\\ \\mathrm{J/K}$, and Avogadro’s number $N_{A}=6.02214076\\times 10^{23}\\ \\mathrm{mol}^{-1}$. The ionic strength is defined by $I=\\frac{1}{2}\\sum_{i} c_{i} z_{i}^{2}$ with $c_{i}$ in $\\mathrm{mol/L}$; when converting to number density, use $n_{i}=N_{A} c_{i}^{\\ast}$ with $c_{i}^{\\ast}$ in $\\mathrm{mol/m}^{3}$ and $c_{i}^{\\ast}=1000\\,c_{i}$.",
            "solution": "The user wants to solve a two-part problem concerning the Gouy-Chapman model of the electrical double layer.\n\n### Part (a): Derivation and Analysis of Gouy-Chapman Capacitance\n\nThe problem begins with the Poisson equation and Boltzmann statistics for ion distributions in a semi-infinite electrolyte in contact with a planar electrode. The electrolyte is symmetric, of type $z:z$.\n\nThe local volumetric charge density $\\rho(x)$ is given by the sum of charges from cations and anions:\n$$\n\\rho(x) = (ze) n_{+}(x) + (-ze) n_{-}(x) = ze(n_{+}(x) - n_{-}(x))\n$$\nUsing the provided Boltzmann distributions for the number densities, $n_{\\pm}(x)=n_{0}\\exp\\left(\\mp ze\\phi(x)/(k_{B}T)\\right)$, we get:\n$$\n\\rho(x) = ze n_{0} \\left[ \\exp\\left(-\\frac{ze\\phi(x)}{k_{B}T}\\right) - \\exp\\left(\\frac{ze\\phi(x)}{k_{B}T}\\right) \\right] = -2ze n_{0} \\sinh\\left(\\frac{ze\\phi(x)}{k_{B}T}\\right)\n$$\nSubstituting this into the Poisson equation, $d^{2}\\phi/dx^{2}=-\\rho(x)/(\\varepsilon_{r}\\varepsilon_{0})$, yields the Poisson-Boltzmann equation for a symmetric electrolyte:\n$$\n\\frac{d^{2}\\phi}{dx^{2}} = \\frac{2ze n_{0}}{\\varepsilon_{r}\\varepsilon_{0}} \\sinh\\left(\\frac{ze\\phi(x)}{k_{B}T}\\right)\n$$\nTo solve this second-order nonlinear differential equation, we use the first integral method. We multiply both sides by $2(d\\phi/dx)$ and recognize that $2(d\\phi/dx)(d^2\\phi/dx^2) = d/dx[(d\\phi/dx)^2]$.\n$$\n\\frac{d}{dx}\\left[\\left(\\frac{d\\phi}{dx}\\right)^{2}\\right] = \\frac{4ze n_{0}}{\\varepsilon_{r}\\varepsilon_{0}} \\sinh\\left(\\frac{ze\\phi}{k_{B}T}\\right) \\frac{d\\phi}{dx}\n$$\nIntegrating both sides with respect to $x$ gives:\n$$\n\\left(\\frac{d\\phi}{dx}\\right)^{2} = \\int \\frac{4ze n_{0}}{\\varepsilon_{r}\\varepsilon_{0}} \\sinh\\left(\\frac{ze\\phi}{k_{B}T}\\right) d\\phi = \\frac{4ze n_{0}}{\\varepsilon_{r}\\varepsilon_{0}} \\left(\\frac{k_{B}T}{ze}\\right) \\cosh\\left(\\frac{ze\\phi}{k_{B}T}\\right) + C_{1}\n$$\n$$\n\\left(\\frac{d\\phi}{dx}\\right)^{2} = \\frac{4n_{0}k_{B}T}{\\varepsilon_{r}\\varepsilon_{0}} \\cosh\\left(\\frac{ze\\phi}{k_{B}T}\\right) + C_{1}\n$$\nThe integration constant $C_{1}$ is found by applying the boundary condition in the bulk electrolyte, i.e., as $x \\to \\infty$, $\\phi \\to 0$ and $d\\phi/dx \\to 0$.\n$$\n0 = \\frac{4n_{0}k_{B}T}{\\varepsilon_{r}\\varepsilon_{0}} \\cosh(0) + C_{1} \\implies C_{1} = -\\frac{4n_{0}k_{B}T}{\\varepsilon_{r}\\varepsilon_{0}}\n$$\nSubstituting $C_{1}$ back into the equation gives:\n$$\n\\left(\\frac{d\\phi}{dx}\\right)^{2} = \\frac{4n_{0}k_{B}T}{\\varepsilon_{r}\\varepsilon_{0}} \\left[ \\cosh\\left(\\frac{ze\\phi}{k_{B}T}\\right) - 1 \\right]\n$$\nUsing the hyperbolic identity $\\cosh(u) - 1 = 2\\sinh^2(u/2)$, we simplify this to:\n$$\n\\left(\\frac{d\\phi}{dx}\\right)^{2} = \\frac{8n_{0}k_{B}T}{\\varepsilon_{r}\\varepsilon_{0}} \\sinh^{2}\\left(\\frac{ze\\phi}{2k_{B}T}\\right)\n$$\nTaking the square root, we obtain an expression for the electric field, $E(x) = -d\\phi/dx$. The sign is chosen such that the potential decays from $\\phi_{0}$ to $0$. If $\\phi_0 > 0$, $\\phi(x) > 0$ for all $x$, and we expect $d\\phi/dx  0$. Since $\\sinh(u)$ has the same sign as $u$, we must take the negative root.\n$$\n\\frac{d\\phi}{dx} = -\\sqrt{\\frac{8n_{0}k_{B}T}{\\varepsilon_{r}\\varepsilon_{0}}} \\sinh\\left(\\frac{ze\\phi}{2k_{B}T}\\right)\n$$\nThe surface charge density $\\sigma$ on the electrode is related to the electric field at the surface ($x=0$) by Gauss's Law. The total charge in the diffuse layer, $\\sigma_d$, must balance the electrode charge, $\\sigma = -\\sigma_d$. The diffuse layer charge is $\\sigma_d = \\int_0^\\infty \\rho(x)dx = \\int_0^\\infty -\\varepsilon_r\\varepsilon_0 \\frac{d^2\\phi}{dx^2} dx = -\\varepsilon_r\\varepsilon_0 [\\frac{d\\phi}{dx}]_0^\\infty = \\varepsilon_r\\varepsilon_0 \\left(\\frac{d\\phi}{dx}\\right)_{x=0}$.\nTherefore, the charge on the metal electrode is:\n$$\n\\sigma = -\\sigma_d = -\\varepsilon_{r}\\varepsilon_{0} \\left(\\frac{d\\phi}{dx}\\right)_{x=0}\n$$\nSubstituting the expression for $d\\phi/dx$ evaluated at $x=0$, where $\\phi=\\phi_0$:\n$$\n\\sigma = -\\varepsilon_{r}\\varepsilon_{0} \\left( -\\sqrt{\\frac{8n_{0}k_{B}T}{\\varepsilon_{r}\\varepsilon_{0}}} \\sinh\\left(\\frac{ze\\phi_{0}}{2k_{B}T}\\right) \\right) = \\sqrt{8n_{0}k_{B}T\\varepsilon_{r}\\varepsilon_{0}} \\sinh\\left(\\frac{ze\\phi_{0}}{2k_{B}T}\\right)\n$$\nThis is the Gouy-Chapman equation relating surface charge density to surface potential. The differential capacitance $C_{GC}$ is defined as $C_{GC} = d\\sigma/d\\phi_{0}$. Differentiating the above expression for $\\sigma$ with respect to $\\phi_0$:\n$$\nC_{GC} = \\frac{d}{d\\phi_{0}} \\left[ \\sqrt{8n_{0}k_{B}T\\varepsilon_{r}\\varepsilon_{0}} \\sinh\\left(\\frac{ze\\phi_{0}}{2k_{B}T}\\right) \\right] = \\sqrt{8n_{0}k_{B}T\\varepsilon_{r}\\varepsilon_{0}} \\cosh\\left(\\frac{ze\\phi_{0}}{2k_{B}T}\\right) \\left(\\frac{ze}{2k_{B}T}\\right)\n$$\nTo express this in terms of ionic strength $I$, we relate $n_0$ to $I$. For a symmetric $z:z$ electrolyte with molar concentration $c_0$ (in $\\mathrm{mol/L}$), the ionic strength is $I = \\frac{1}{2}(c_0 z^2 + c_0 z^2) = c_0 z^2$. The bulk number density $n_0$ (in $\\mathrm{m^{-3}}$) is given by $n_0 = 1000 N_A c_0 = 1000 N_A (I/z^2)$. Now we substitute this into the expression for $C_{GC}$:\n$$\nC_{GC} = \\sqrt{8 \\left(\\frac{1000 N_A I}{z^2}\\right) k_{B}T\\varepsilon_{r}\\varepsilon_{0}} \\cosh\\left(\\frac{ze\\phi_{0}}{2k_{B}T}\\right) \\left(\\frac{ze}{2k_{B}T}\\right)\n$$\nA more convenient form involves the Debye length, $\\kappa^{-1}$. The inverse Debye length squared is $\\kappa^2 = \\frac{e^2 \\sum_i n_{i,0} z_i^2}{\\varepsilon_r \\varepsilon_0 k_B T}$. For our system, $\\sum_i n_{i,0} z_i^2 = n_0 z^2 + n_0 z^2 = 2n_0 z^2 = 2(\\frac{1000 N_A I}{z^2}) z^2 = 2000 N_A I$.\nSo, $\\kappa^2 = \\frac{2000 N_A I e^2}{\\varepsilon_r \\varepsilon_0 k_B T}$.\nThe capacitance can be shown to be $C_{GC} = \\varepsilon_r\\varepsilon_0 \\kappa \\cosh\\left(\\frac{ze\\phi_0}{2k_B T}\\right)$. Substituting for $\\kappa$:\n$$\nC_{GC}(\\phi_0, I) = \\varepsilon_r\\varepsilon_0 \\sqrt{\\frac{2000 N_A I e^2}{\\varepsilon_r\\varepsilon_0 k_B T}} \\cosh\\left(\\frac{ze\\phi_0}{2k_B T}\\right)\n$$\n$$\nC_{GC}(\\phi_0, I) = \\sqrt{\\frac{2000 N_A e^2 \\varepsilon_r\\varepsilon_0 I}{k_B T}} \\cosh\\left(\\frac{ze\\phi_0}{2 k_B T}\\right)\n$$\nThis is the Gouy-Chapman expression for the differential capacitance. To analyze its dependence on $I$ for a fixed $\\phi_0$, we note that all terms except $I$ are constant for a given system at fixed temperature and potential.\nLet $A(\\phi_0) = \\sqrt{\\frac{2000 N_A e^2 \\varepsilon_r\\varepsilon_0}{k_B T}} \\cosh\\left(\\frac{ze\\phi_0}{2 k_B T}\\right)$. Since all physical constants are positive and $\\cosh(u) \\ge 1$ for any real $u$, we have $A(\\phi_0) > 0$.\nThe expression for capacitance becomes $C_{GC}(I) = A(\\phi_0) \\sqrt{I}$. The function $f(I) = \\sqrt{I}$ is a strictly and monotonically increasing function for $I>0$. Therefore, $C_{GC}$ is also a monotonically increasing function of $I$. This means that as the ionic strength $I$ decreases, $C_{GC}$ also decreases monotonically.\n\n### Part (b): Numerical Evaluation\n\nWe need to evaluate $C_{GC}$ for the specific case where $\\phi_0=0$. In this case, $\\cosh\\left(\\frac{ze\\phi_0}{2 k_B T}\\right) = \\cosh(0) = 1$. The expression simplifies to:\n$$\nC_{GC}(\\phi_0=0, I) = \\sqrt{\\frac{2000 N_A e^2 \\varepsilon_r\\varepsilon_0 I}{k_B T}}\n$$\nWe are given the following values:\n- Ionic strength $I = 10 \\ \\mathrm{mM} = 10 \\times 10^{-3} \\ \\mathrm{mol/L} = 0.01 \\ \\mathrm{mol/L}$. Note that $z=1$ is consistent with the definition of $I$ but the value of $z$ cancels out in this final form.\n- Temperature $T = 298 \\ \\mathrm{K}$\n- Relative permittivity $\\varepsilon_r = 78$\n- Elementary charge $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$\n- Vacuum permittivity $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$\n- Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$\n- Avogadro's number $N_{A} = 6.02214076 \\times 10^{23} \\ \\mathrm{mol}^{-1}$\n\nWe will substitute these values, all in SI units, into the expression.\nThe numerator inside the square root is $N_u = 2000 N_A e^2 \\varepsilon_r\\varepsilon_0 I$:\n$$\nN_u = 2000 \\times (6.02214076 \\times 10^{23}) \\times (1.602176634 \\times 10^{-19})^2 \\times (78) \\times (8.8541878128 \\times 10^{-12}) \\times (0.01)\n$$\n$$\nN_u \\approx 2.1365 \\times 10^{-22} \\ \\mathrm{F^2 \\cdot J / m^3}\n$$\nThe denominator is $D_e = k_B T$:\n$$\nD_e = (1.380649 \\times 10^{-23}) \\times (298) \\approx 4.1143 \\times 10^{-21} \\ \\mathrm{J}\n$$\nNow we compute the capacitance squared:\n$$\nC_{GC}^2 = \\frac{N_u}{D_e} = \\frac{2.1365 \\times 10^{-22}}{4.1143 \\times 10^{-21}} \\approx 0.05195 \\ \\mathrm{F^2/m^4}\n$$\nTaking the square root:\n$$\nC_{GC} = \\sqrt{0.05195} \\approx 0.2279 \\ \\mathrm{F/m^2}\n$$\nThe problem asks for the answer in units of $\\mu\\mathrm{F}/\\mathrm{cm}^2$. We perform the unit conversion:\n$$\n1 \\ \\mathrm{F/m^2} = \\frac{10^6 \\ \\mu\\mathrm{F}}{(100 \\ \\mathrm{cm})^2} = \\frac{10^6 \\ \\mu\\mathrm{F}}{10^4 \\ \\mathrm{cm}^2} = 100 \\ \\mu\\mathrm{F/cm^2}\n$$\nTherefore,\n$$\nC_{GC} \\approx 0.2279 \\times 100 \\ \\mu\\mathrm{F/cm^2} = 22.79 \\ \\mu\\mathrm{F/cm^2}\n$$\nRounding to three significant figures, the final result is $22.8 \\ \\mu\\mathrm{F/cm^2}$.",
            "answer": "$$\\boxed{22.8}$$"
        },
        {
            "introduction": "While the Gouy-Chapman model is powerful, its assumption of point-like ions breaks down at high potentials or concentrations where ions are densely packed. This exercise  serves as a critical \"reality check,\" challenging you to quantify the impact of finite ion size. By comparing the classical Poisson-Boltzmann predictions to a model incorporating steric crowding, you will discover how physical constraints impose an upper limit on surface charge density, a phenomenon crucial for modeling modern energy storage devices.",
            "id": "4243260",
            "problem": "Consider a planar electrode in contact with a symmetric monovalent electrolyte, modeled within computational electrochemistry using mean-field theories of the electrical double layer. The electrode potential relative to the bulk is $V$ (in volts). The bulk molar concentration is $c^{\\infty}$ (in $\\mathrm{mol}/\\mathrm{m}^3$). The solvent has relative permittivity $\\epsilon_{\\mathrm{r}}$ and vacuum permittivity $\\epsilon_0$, so the absolute permittivity is $\\epsilon = \\epsilon_{\\mathrm{r}} \\epsilon_0$ (in $\\mathrm{F}/\\mathrm{m}$). The temperature is $T$ (in $\\mathrm{K}$). The electrolyte ions carry valence $z$ (dimensionless), elementary charge $e$ (in $\\mathrm{C}$), Boltzmann constant $k_{\\mathrm{B}}$ (in $\\mathrm{J}/\\mathrm{K}$), and Avogadro number $N_{\\mathrm{A}}$ (in $\\mathrm{mol}^{-1}$). The per-ion excluded volume is $v$ (in $\\mathrm{m}^3$), representing steric crowding.\n\nTwo models are considered:\n- The classical Poisson–Boltzmann (PB) model, also known as the Gouy–Chapman model for planar geometry, which treats ions as point-like and relates ionic number density $n^{\\infty} = N_{\\mathrm{A}} c^{\\infty}$ to the potential-dependent charge distribution via the Boltzmann distribution.\n- A crowding-limited model, where steric exclusion constrains the local number density of counterions by $n_{\\max} = 1 / v$, imposing an upper bound on the local volumetric charge density $|\\rho(z)| \\leq z e n_{\\max}$.\n\nStarting from the Poisson equation $d^2 \\psi / dz^2 = -\\rho(z)/\\epsilon$ and the definition of surface charge density $\\sigma = -\\epsilon \\, (d\\psi/dz)\\rvert_{z=0}$, and using only fundamental thermodynamic and electrostatic principles, derive:\n- An expression for the surface charge density $\\sigma_{\\mathrm{PB}}(V)$ predicted by the classical Poisson–Boltzmann model in planar geometry, as a function of $V$, $c^{\\infty}$, $z$, $e$, $k_{\\mathrm{B}}$, $T$, and $\\epsilon$.\n- A rigorous upper bound on the maximum achievable surface charge density $\\sigma_{\\max}(V)$ under steric crowding (finite $v$), consistent with $|\\rho(z)| \\leq z e n_{\\max}$ and the same electrostatic boundary conditions, as a function of $V$, $v$, $z$, $e$, and $\\epsilon$.\n\nYour task is to implement a complete, runnable program that, for a given test suite, computes for each case:\n- $\\sigma_{\\max}(V)$ in $\\mathrm{C}/\\mathrm{m}^2$,\n- $\\sigma_{\\mathrm{PB}}(V)$ in $\\mathrm{C}/\\mathrm{m}^2$,\n- The dimensionless ratio $r = \\sigma_{\\max}(V) / \\sigma_{\\mathrm{PB}}(V)$.\n\nUse the following constants and assumptions in your computations:\n- $z = 1$,\n- $T = 298$ $\\mathrm{K}$,\n- $\\epsilon_{\\mathrm{r}} = 78.4$,\n- $\\epsilon_0 = 8.8541878128 \\times 10^{-12}$ $\\mathrm{F}/\\mathrm{m}$,\n- $e = 1.602176634 \\times 10^{-19}$ $\\mathrm{C}$,\n- $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J}/\\mathrm{K}$,\n- $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}$ $\\mathrm{mol}^{-1}$.\n\nPhysical units requirement:\n- Express all surface charge densities in $\\mathrm{C}/\\mathrm{m}^2$.\n- Express the ratio $r$ as a decimal.\n- Round all outputs to six significant figures.\n\nTest suite:\nProvide calculations for the following parameter sets $(V, c^{\\infty}, v)$, where $V$ is in $\\mathrm{V}$, $c^{\\infty}$ is in $\\mathrm{mol}/\\mathrm{m}^3$, and $v$ is in $\\mathrm{m}^3$:\n- Case $1$: $(0.2, 1000, 3.0 \\times 10^{-29})$,\n- Case $2$: $(1.0, 1000, 3.0 \\times 10^{-29})$,\n- Case $3$: $(1.0, 100, 8.0 \\times 10^{-29})$,\n- Case $4$: $(0.05, 10, 2.5 \\times 10^{-29})$,\n- Case $5$: $(1.5, 1000, 1.0 \\times 10^{-28})$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, each inner list corresponding to a test case and ordered as $[\\sigma_{\\max}, \\sigma_{\\mathrm{PB}}, r]$, with all numbers in decimal notation rounded to six significant figures. For example, an output could look like $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\ldots]$ where $x_i$, $y_i$, and $z_i$ are floats in the specified units and precision.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in established principles of physical electrochemistry, well-posed with all necessary parameters provided, and formulated with objective, precise language. It requires the derivation and computation of quantities from the standard Poisson-Boltzmann (Gouy-Chapman) model and a crowding-limited model, which are staples of the field.\n\nThe derivation and computational strategy proceed in three parts:\n1.  Derivation of the surface charge density $\\sigma_{\\mathrm{PB}}$ from the Poisson-Boltzmann model.\n2.  Derivation of the maximum surface charge density $\\sigma_{\\max}$ under steric crowding.\n3.  Implementation of these formulas to compute the required values for the given test cases.\n\n### Part 1: Derivation of Surface Charge Density $\\sigma_{\\mathrm{PB}}(V)$ (Poisson-Boltzmann Model)\n\nThe starting point is the one-dimensional Poisson equation for the electrostatic potential $\\psi(z)$ as a function of distance $z$ from a planar electrode:\n$$\n\\frac{d^2\\psi}{dz^2} = -\\frac{\\rho(z)}{\\epsilon}\n$$\nwhere $\\rho(z)$ is the local volumetric charge density and $\\epsilon$ is the absolute permittivity of the solvent ($\\epsilon = \\epsilon_{\\mathrm{r}}\\epsilon_0$).\n\nFor a symmetric $z:z$ electrolyte, the charge density is given by $\\rho(z) = ze(n_+(z) - n_-(z))$, where $n_+$ and $n_-$ are the number densities of cations and anions, respectively. The Poisson-Boltzmann model assumes ions are point charges whose distribution follows Boltzmann statistics:\n$$\nn_+(z) = n^{\\infty} \\exp\\left(-\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\n$$\n$$\nn_-(z) = n^{\\infty} \\exp\\left(+\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\n$$\nHere, $n^{\\infty} = N_{\\mathrm{A}}c^{\\infty}$ is the bulk number density of ions, $e$ is the elementary charge, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nSubstituting these into the expression for $\\rho(z)$ yields:\n$$\n\\rho(z) = zen^{\\infty}\\left[\\exp\\left(-\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right) - \\exp\\left(\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\\right] = -2zen^{\\infty}\\sinh\\left(\\frac{ze\\psi(z)}{k_{\\mathrm{B}}T}\\right)\n$$\nThe Poisson-Boltzmann equation is thus:\n$$\n\\frac{d^2\\psi}{dz^2} = \\frac{2zen^{\\infty}}{\\epsilon}\\sinh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\n$$\nTo solve this equation for the electric field, we multiply by the integrating factor $2(d\\psi/dz)$:\n$$\n2\\frac{d\\psi}{dz}\\frac{d^2\\psi}{dz^2} = \\frac{d}{dz}\\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{4zen^{\\infty}}{\\epsilon}\\sinh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\\frac{d\\psi}{dz}\n$$\nWe integrate from a point $z$ in the double layer to infinity, applying the bulk boundary conditions $\\psi(\\infty) = 0$ and $(d\\psi/dz)_{z\\to\\infty} = 0$:\n$$\n\\int_z^\\infty \\frac{d}{dz'}\\left(\\frac{d\\psi}{dz'}\\right)^2 dz' = \\int_z^\\infty \\frac{4zen^{\\infty}}{\\epsilon}\\sinh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\\frac{d\\psi}{dz'} dz'\n$$\n$$\n\\left[\\left(\\frac{d\\psi}{dz'}\\right)^2\\right]_z^\\infty = \\frac{4zen^{\\infty}}{\\epsilon} \\int_{\\psi(z)}^0 \\sinh\\left(\\frac{zeu}{k_{\\mathrm{B}}T}\\right) du\n$$\n$$\n0 - \\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{4zen^{\\infty}}{\\epsilon} \\left[\\frac{k_{\\mathrm{B}}T}{ze}\\cosh\\left(\\frac{zeu}{k_{\\mathrm{B}}T}\\right)\\right]_{\\psi(z)}^0\n$$\n$$\n-\\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{4n^{\\infty}k_{\\mathrm{B}}T}{\\epsilon} \\left(\\cosh(0) - \\cosh\\left(\\frac{ze\\psi}{k_{\\mathrm{B}}T}\\right)\\right)\n$$\nUsing the hyperbolic identity $1 - \\cosh(x) = -2\\sinh^2(x/2)$:\n$$\n\\left(\\frac{d\\psi}{dz}\\right)^2 = \\frac{8n^{\\infty}k_{\\mathrm{B}}T}{\\epsilon}\\sinh^2\\left(\\frac{ze\\psi}{2k_{\\mathrm{B}}T}\\right)\n$$\nThe surface charge density on the electrode is defined as $\\sigma = -\\epsilon (d\\psi/dz)\\rvert_{z=0}$. Taking the square root of the above expression (with the appropriate sign to ensure $\\psi$ decays from the surface potential $V$ to $0$) and evaluating at $z=0$ where $\\psi(0)=V$:\n$$\n\\sigma_{\\mathrm{PB}}(V) = \\sqrt{8\\epsilon k_{\\mathrm{B}}T n^{\\infty}} \\sinh\\left(\\frac{zeV}{2k_{\\mathrm{B}}T}\\right)\n$$\nSubstituting $n^{\\infty} = N_{\\mathrm{A}} c^{\\infty}$, $\\epsilon = \\epsilon_{\\mathrm{r}}\\epsilon_0$, and $z=1$ as specified gives the final formula for computation.\n\n### Part 2: Derivation of Maximum Surface Charge Density $\\sigma_{\\max}(V)$ (Steric Crowding)\n\nThis model imposes a physical limit on the local number density of ions, $n(z) \\le n_{\\max} = 1/v$, where $v$ is the per-ion excluded volume. This sets an upper bound on the magnitude of the local charge density: $|\\rho(z)| \\le ze n_{\\max}$. Let's define this maximum charge density as $\\rho_{\\max} = ze/v$.\n\nThe surface charge density on the electrode is equal and opposite to the total integrated charge in the diffuse layer:\n$$\n\\sigma = -\\int_0^\\infty \\rho(z) dz\n$$\nTo find the rigorous upper bound on $\\sigma$ for a given positive potential $V > 0$, we must find the charge distribution $\\rho(z)$ that maximizes this integral, subject to the constraints $|\\rho(z)| \\le \\rho_{\\max}$ and that the distribution produces the potential $\\psi(0)=V$. To maximize a positive $\\sigma$, the integral of $\\rho(z)$ must be as negative as possible. This is achieved by setting $\\rho(z)$ to its most negative value, $-\\rho_{\\max}$, over some region starting from the electrode surface. The distribution that maximizes charge for a given potential is a compact layer of counterions:\n$$\n\\rho(z) =\n\\begin{cases}\n-\\rho_{\\max}  \\text{for } 0 \\le z \\le \\delta \\\\\n0  \\text{for } z > \\delta\n\\end{cases}\n$$\nThe thickness $\\delta$ of this compact layer is determined by the potential $V$. We solve the Poisson equation for this charge profile: $d^2\\psi/dz^2 = -(-\\rho_{\\max})/\\epsilon = \\rho_{\\max}/\\epsilon$ for $z \\in [0, \\delta]$.\nIntegrating once gives the electric field: $d\\psi/dz = (\\rho_{\\max}/\\epsilon)z + C_1$.\nIntegrating a second time gives the potential: $\\psi(z) = (\\rho_{\\max}/(2\\epsilon))z^2 + C_1z + C_2$.\n\nThe boundary conditions are:\n1.  $\\psi(0) = V$ (potential at the electrode).\n2.  $\\psi(\\delta) = 0$ (potential is zero at the edge of the compact layer).\n3.  $(d\\psi/dz)\\rvert_{z=\\delta} = 0$ (electric field is zero at the edge of the compact layer, as there is no charge for $z > \\delta$).\n\nFrom condition 1: $C_2 = V$.\nFrom condition 3: $(\\rho_{\\max}/\\epsilon)\\delta + C_1 = 0 \\implies C_1 = -(\\rho_{\\max}/\\epsilon)\\delta$.\nFrom condition 2:\n$$\n\\frac{\\rho_{\\max}}{2\\epsilon}\\delta^2 - \\left(\\frac{\\rho_{\\max}}{\\epsilon}\\delta\\right)\\delta + V = 0 \\implies -\\frac{\\rho_{\\max}}{2\\epsilon}\\delta^2 + V = 0\n$$\nSolving for $\\delta$:\n$$\n\\delta = \\sqrt{\\frac{2\\epsilon V}{\\rho_{\\max}}}\n$$\nNow, we calculate the surface charge for this configuration:\n$$\n\\sigma_{\\max} = -\\int_0^\\delta (-\\rho_{\\max}) dz = \\rho_{\\max}\\delta = \\rho_{\\max}\\sqrt{\\frac{2\\epsilon V}{\\rho_{\\max}}} = \\sqrt{2\\epsilon V \\rho_{\\max}}\n$$\nSubstituting $\\rho_{\\max} = ze/v$ (with $z=1$) and $\\epsilon = \\epsilon_{\\mathrm{r}}\\epsilon_0$:\n$$\n\\sigma_{\\max}(V) = \\sqrt{\\frac{2\\epsilon_{\\mathrm{r}}\\epsilon_0eV}{v}}\n$$\nThis expression provides the maximum possible surface charge for a given potential $V$ under the steric constraint.\n\n### Part 3: Computational Implementation\n\nThe derived formulas for $\\sigma_{\\mathrm{PB}}(V)$ and $\\sigma_{\\max}(V)$ are implemented in Python. The program computes these values for each test case, along with their ratio $r = \\sigma_{\\max}(V) / \\sigma_{\\mathrm{PB}}(V)$. A custom formatting function ensures that all numerical outputs are rounded to six significant figures in standard decimal notation, as required. For test cases with $V>0$, both $\\sigma_{\\mathrm{PB}}$ and $\\sigma_{\\max}$ are positive. The ratio $r$ provides a dimensionless measure of how steric effects limit the surface charge compared to the ideal point-ion model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates surface charge densities for Poisson-Boltzmann and crowding-limited models\n    of the electrical double layer.\n    \"\"\"\n    \n    # Define physical constants\n    Z = 1.0  # Ion valence (dimensionless)\n    T = 298.0  # Temperature (K)\n    EPS_R = 78.4  # Relative permittivity of the solvent (dimensionless)\n    EPS_0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    E = 1.602176634e-19  # Elementary charge (C)\n    K_B = 1.380649e-23  # Boltzmann constant (J/K)\n    N_A = 6.02214076e23  # Avogadro number (mol^-1)\n    \n    # Derived constant\n    EPS = EPS_R * EPS_0  # Absolute permittivity (F/m)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (V, c_inf, v)\n    # V: potential (V)\n    # c_inf: bulk concentration (mol/m^3)\n    # v: per-ion excluded volume (m^3)\n    test_cases = [\n        (0.2, 1000, 3.0e-29),\n        (1.0, 1000, 3.0e-29),\n        (1.0, 100, 8.0e-29),\n        (0.05, 10, 2.5e-29),\n        (1.5, 1000, 1.0e-28),\n    ]\n\n    def custom_format(value, sig_figs=6):\n        \"\"\"\n        Formats a number to a specified number of significant figures in decimal notation.\n        \"\"\"\n        if value == 0:\n            return \"0.0\"\n\n        # Determine the number of decimal places needed for rounding\n        power = np.floor(np.log10(np.abs(value)))\n        round_digits = sig_figs - 1 - int(power)\n\n        if round_digits  0:\n            # Handle rounding to the left of the decimal point\n            scale = 10**(-round_digits)\n            # Use np.round for standard rounding, then convert to int to drop .0\n            rounded = np.round(value / scale) * scale\n            return str(int(rounded))\n        else:\n            # Handle rounding to the right of the decimal point\n            # Use f-string formatting to ensure correct number of trailing zeros\n            return f\"{value:.{round_digits}f}\"\n\n    results = []\n    for V, c_inf, v in test_cases:\n        # Calculate Poisson-Boltzmann surface charge density (sigma_pb)\n        n_inf = N_A * c_inf  # Bulk number density (m^-3)\n        sinh_arg = (Z * E * V) / (2 * K_B * T)\n        sigma_pb = np.sqrt(8 * EPS * K_B * T * n_inf) * np.sinh(sinh_arg)\n\n        # Calculate maximum surface charge density under steric crowding (sigma_max)\n        # Note: All V are positive, so np.sqrt is safe.\n        rho_max = (Z * E) / v\n        sigma_max = np.sqrt(2 * EPS * V * rho_max)\n        \n        # Calculate the dimensionless ratio\n        r = sigma_max / sigma_pb\n        \n        # Format results to six significant figures\n        formatted_sigma_max = custom_format(sigma_max, 6)\n        formatted_sigma_pb = custom_format(sigma_pb, 6)\n        formatted_r = custom_format(r, 6)\n        \n        results.append([formatted_sigma_max, formatted_sigma_pb, formatted_r])\n\n    # Construct the final output string in the specified format\n    row_strs = []\n    for row in results:\n        row_strs.append(f\"[{','.join(row)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(row_strs)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond static equilibrium, this final practice delves into the dynamics of double layer formation. The rate at which the EDL charges and discharges governs the performance of many electrochemical systems, from supercapacitors to sensors. This advanced exercise  involves numerically solving the Debye-Falkenhagen equation, a linearized dynamic model, to simulate the transient response to a potential step and extract the fundamental charging time constant, providing insight into the kinetics of the EDL.",
            "id": "4243308",
            "problem": "You are asked to model the time evolution of the electrostatic potential and surface charge in the electrical double layer at a planar blocking electrode after a small step change in electrode potential. Assume a symmetric monovalent electrolyte and use the linearized Poisson–Boltzmann and Nernst–Planck framework appropriate for small potentials. The step response must be solved in one dimension normal to the electrode and the effective time constant must be extracted from the transient surface charge signal.\n\nStarting from fundamental laws and definitions in computational electrochemistry:\n\n- The Poisson equation for the electrostatic potential $\\phi(x,t)$ relates the net charge density $\\rho(x,t)$ to the electrostatic field: $$\\frac{\\partial^2 \\phi}{\\partial x^2} = - \\frac{\\rho}{\\varepsilon},$$ where $\\varepsilon$ is the permittivity of the medium.\n- The Nernst–Planck (NP) flux for a species $i$ is $J_i = -D_i\\left(\\frac{\\partial c_i}{\\partial x} + \\frac{z_i e}{k_{\\mathrm{B}} T} c_i \\frac{\\partial \\phi}{\\partial x}\\right)$, where $D_i$ is the diffusion coefficient, $c_i$ is concentration, $z_i$ is valence, $e$ is elementary charge, $k_{\\mathrm{B}}$ is Boltzmann constant, and $T$ is absolute temperature, with electroneutrality in the bulk prior to the step.\n- In the linearized regime about $\\phi=0$ for a symmetric $z:z$ electrolyte, the combined Poisson–Boltzmann (PB) relation gives $\\rho(x,t) \\approx -\\varepsilon \\kappa^2 \\phi(x,t)$, where the Debye parameter $\\kappa$ is defined by $$\\kappa^2 = \\frac{2 z^2 e^2 N_{\\mathrm{A}} c_\\infty}{\\varepsilon k_{\\mathrm{B}} T},$$ with $N_{\\mathrm{A}}$ the Avogadro constant and $c_\\infty$ the bulk concentration. Under the linearized PB–NP framework, the potential obeys the Debye–Falkenhagen (DF) equation $$\\frac{\\partial \\phi}{\\partial t} = D \\left(\\frac{\\partial^2 \\phi}{\\partial x^2} - \\kappa^2 \\phi\\right),$$ with a single diffusion coefficient $D$ assumed equal for cations and anions for simplicity.\n- A finite Stern layer capacitance $C_{\\mathrm{S}}$ at the interface imposes a mixed (Robin) boundary condition linking the interfacial potential $\\phi(0,t)$ and the surface charge density $\\sigma(t)$ by $$\\sigma(t) = C_{\\mathrm{S}}\\big(\\Delta\\phi - \\phi(0,t)\\big),$$ where $\\Delta\\phi$ is the applied electrode potential step and $\\sigma(t) = -\\varepsilon\\,\\frac{\\partial \\phi}{\\partial x}\\big|_{x=0^+}$. At the outer boundary of the computational domain at $x=L$, impose $\\phi(L,t) = 0$ to represent the bulk.\n- The initial condition is $\\phi(x,0)=0$ for $x>0$.\n\nImplement a robust numerical solver for the DF equation in a one-dimensional domain $x \\in [0,L]$ using an unconditionally stable time discretization and second-order spatial discretization that respect the above boundary conditions. Compute the time evolution of the surface charge density $\\sigma(t)$ after a step change $\\Delta\\phi$ at $t=0^+$. Define the effective charging time constant $\\tau$ to be the time at which $\\sigma(t)$ reaches a fraction $1 - e^{-1}$ of its steady-state value $\\sigma_\\infty$. Express $\\tau$ in seconds and round each returned value to six significant figures.\n\nAll physical quantities must be treated in the International System of Units (SI): seconds ($\\mathrm{s}$), meters ($\\mathrm{m}$), volts ($\\mathrm{V}$), farads per square meter ($\\mathrm{F/m^2}$), moles per cubic meter ($\\mathrm{mol/m^3}$).\n\nYour program must use the following constants in SI units: $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}$, relative permittivity of water $\\varepsilon_r = 78.5$ so that $\\varepsilon = \\varepsilon_r \\varepsilon_0$, $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$, $T = 298\\ \\mathrm{K}$, $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$, $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$, and $z=1$.\n\nNumerical details and algorithmic constraints:\n- Use an implicit time-stepping scheme for the DF equation with second-order central differences in space.\n- Enforce the Stern boundary as a linear Robin condition at $x=0$ and a Dirichlet condition $\\phi(L,t)=0$ at $x=L$.\n- Choose the spatial step $\\Delta x$ adaptively as $\\Delta x = \\min\\left(\\lambda_{\\mathrm{D}}/8,\\ L/400\\right)$, where $\\lambda_{\\mathrm{D}} = 1/\\kappa$ is the Debye length, and choose the total simulation time $T_{\\mathrm{end}} = 50/\\left(D\\kappa^2\\right)$ with $5000$ uniform time steps so that $\\Delta t = T_{\\mathrm{end}}/5000$.\n- Compute $\\sigma(t)$ using the Stern relation $\\sigma(t) = C_{\\mathrm{S}}(\\Delta\\phi - \\phi(0,t))$.\n- Determine $\\sigma_\\infty$ analytically from steady-state consistency and use it to extract $\\tau$ defined by $\\sigma(\\tau) = \\sigma_\\infty \\left(1 - e^{-1}\\right)$. Use linear interpolation between adjacent time samples to refine $\\tau$.\n\nTest suite:\nProvide results for the following four parameter sets. Each test case is independent and must be computed starting from the stated initial conditions.\n\n- Test case $1$: $c_\\infty = 0.1\\ \\mathrm{mol/L}$, $D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}$, $C_{\\mathrm{S}} = 0.2\\ \\mathrm{F/m^2}$, $\\Delta\\phi = 0.025\\ \\mathrm{V}$, $L = 1.0\\times 10^{-7}\\ \\mathrm{m}$.\n- Test case $2$: $c_\\infty = 0.001\\ \\mathrm{mol/L}$, $D = 1.5\\times 10^{-9}\\ \\mathrm{m^2/s}$, $C_{\\mathrm{S}} = 0.2\\ \\mathrm{F/m^2}$, $\\Delta\\phi = 0.010\\ \\mathrm{V}$, $L = 1.0\\times 10^{-6}\\ \\mathrm{m}$.\n- Test case $3$: $c_\\infty = 0.1\\ \\mathrm{mol/L}$, $D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}$, $C_{\\mathrm{S}} = 5.0\\ \\mathrm{F/m^2}$, $\\Delta\\phi = 0.025\\ \\mathrm{V}$, $L = 1.0\\times 10^{-7}\\ \\mathrm{m}$.\n- Test case $4$: $c_\\infty = 0.1\\ \\mathrm{mol/L}$, $D = 1.0\\times 10^{-9}\\ \\mathrm{m^2/s}$, $C_{\\mathrm{S}} = 0.02\\ \\mathrm{F/m^2}$, $\\Delta\\phi = 0.025\\ \\mathrm{V}$, $L = 1.0\\times 10^{-7}\\ \\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in seconds, each rounded to six significant figures, ordered corresponding to the above test cases, for example: $$[\\tau_1,\\tau_2,\\tau_3,\\tau_4].$$",
            "solution": "The user has requested a numerical solution to model the transient response of an electrical double layer to a potential step, based on the linearized Poisson-Boltzmann and Nernst-Planck framework. The problem is scientifically sound, well-posed, and contains all necessary information for a solution.\n\n### Part 1: Physical Model and Governing Equations\n\nThe core of the problem is the time-dependent electrostatic potential $\\phi(x,t)$ in a symmetric monovalent electrolyte. For small potential perturbations, its evolution is governed by the Debye-Falkenhagen (DF) equation, a linear partial differential equation (PDE):\n$$ \\frac{\\partial \\phi}{\\partial t} = D \\left(\\frac{\\partial^2 \\phi}{\\partial x^2} - \\kappa^2 \\phi\\right) $$\nHere, $D$ is the ionic diffusion coefficient, and $\\kappa$ is the inverse of the Debye length $\\lambda_{\\mathrm{D}}$, defined by $\\kappa^2 = \\frac{2 z^2 e^2 N_{\\mathrm{A}} c_\\infty}{\\varepsilon k_{\\mathrm{B}} T}$, where the symbols represent their standard physical meanings (valence, elementary charge, Avogadro's number, bulk concentration, permittivity, Boltzmann constant, and temperature).\n\nThe problem is defined on a one-dimensional spatial domain $x \\in [0,L]$.\n- The initial state is equilibrium, so the initial condition is $\\phi(x,0) = 0$.\n- The boundary at $x=L$ is set deep in the bulk electrolyte where the potential is zero, imposing a Dirichlet condition: $\\phi(L,t) = 0$.\n- The boundary at $x=0$ represents the electrode-electrolyte interface, which includes a Stern layer with capacitance $C_{\\mathrm{S}}$. The applied potential step is $\\Delta\\phi$. The relationship between the surface charge density $\\sigma(t)$, the potential drop across the Stern layer, and the potential at the outer Helmholtz plane $\\phi(0,t)$ is given by $\\sigma(t) = C_{\\mathrm{S}}(\\Delta\\phi - \\phi(0,t))$. Gauss's law at the interface relates the surface charge to the electric field: $\\sigma(t) = -\\varepsilon\\frac{\\partial \\phi}{\\partial x}\\big|_{x=0}$. Combining these two gives a mixed (Robin) boundary condition:\n$$ -\\varepsilon\\frac{\\partial \\phi}{\\partial x}\\bigg|_{x=0} = C_{\\mathrm{S}}\\big(\\Delta\\phi - \\phi(0,t)\\big) $$\n\n### Part 2: Numerical Discretization\n\nTo solve the DF equation numerically, we use the finite difference method. The spatial domain $[0,L]$ is discretized into $N_{int}$ intervals of width $\\Delta x$, yielding $N_x = N_{int}+1$ grid points $x_i = i\\Delta x$. Time is discretized into steps of size $\\Delta t$, $t_n = n\\Delta t$. The potential at grid point $i$ and time step $n$ is denoted $\\phi_i^n$.\n\nThe PDE is discretized using a second-order central difference for the spatial derivative and the backward Euler method for the time derivative to ensure unconditional stability as requested. For any interior grid point $i$ ($1 \\le i \\le N_x-2$), the discretized equation is:\n$$ \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = D \\left( \\frac{\\phi_{i-1}^{n+1} - 2\\phi_i^{n+1} + \\phi_{i+1}^{n+1}}{(\\Delta x)^2} - \\kappa^2 \\phi_i^{n+1} \\right) $$\nRearranging this equation to group the unknown terms at time step $n+1$ on the left side gives:\n$$ -\\alpha \\phi_{i-1}^{n+1} + (1 + 2\\alpha + D\\Delta t \\kappa^2) \\phi_i^{n+1} - \\alpha \\phi_{i+1}^{n+1} = \\phi_i^n $$\nwhere $\\alpha = \\frac{D \\Delta t}{(\\Delta x)^2}$.\n\nThe boundary conditions are incorporated as follows:\n-   At $x=L$ ($i=N_{int}=N_x-1$), the Dirichlet condition is $\\phi_{N_x-1}^{n+1} = 0$.\n-   At $x=0$ ($i=0$), the Robin condition is discretized. To maintain second-order spatial accuracy, we introduce a \"ghost\" point at $x_{-1}=-\\Delta x$ and use a central difference for the gradient: $\\frac{\\partial \\phi}{\\partial x}\\big|_{x=0} \\approx \\frac{\\phi_1 - \\phi_{-1}}{2\\Delta x}$. Substituting this into the Robin condition allows us to express the ghost point potential $\\phi_{-1}^{n+1}$ in terms of potentials within the domain. This expression for $\\phi_{-1}^{n+1}$ is then substituted into the discretized DF equation written for the point $i=0$. This yields a modified first equation for $\\phi_0^{n+1}$ and $\\phi_1^{n+1}$:\n$$ (1 + 2\\alpha + D\\Delta t \\kappa^2 + \\beta) \\phi_0^{n+1} - 2\\alpha \\phi_1^{n+1} = \\phi_0^n + \\beta \\Delta\\phi $$\nwhere $\\beta = \\frac{2 D \\Delta t C_{\\mathrm{S}}}{\\varepsilon \\Delta x}$.\n\nThis set of $N_x-1$ linear equations (for $i=0, \\dots, N_x-2$) forms a tridiagonal system of the form $A\\mathbf{\\Phi}^{n+1} = \\mathbf{b}^n$, where $\\mathbf{\\Phi}^{n+1}$ is the vector of unknown potentials $[\\phi_0^{n+1}, \\dots, \\phi_{N_x-2}^{n+1}]^T$. This system can be solved efficiently at each time step using the Thomas algorithm, which is available in `scipy.linalg.solve_banded`.\n\n### Part 3: Time Constant Extraction\n\nThe simulation proceeds by iteratively solving the matrix system from $t=0$ until the total simulation time $T_{\\mathrm{end}}$ is reached. At each time step $t_n$, the potential at the interface, $\\phi(0, t_n) = \\phi_0^n$, is used to calculate the surface charge density:\n$$ \\sigma(t_n) = C_{\\mathrm{S}}(\\Delta\\phi - \\phi_0^n) $$\nThe process continues until the system approaches its steady state. The steady-state surface charge, $\\sigma_\\infty$, is determined analytically by setting $\\frac{\\partial \\phi}{\\partial t} = 0$ in the original PDE and solving the resulting ordinary differential equation with the specified boundary conditions. This yields:\n$$ \\sigma_\\infty = \\frac{C_{\\mathrm{S}} \\varepsilon \\kappa}{C_{\\mathrm{S}} + \\varepsilon \\kappa} \\Delta\\phi $$\nwhich corresponds to the total charge stored across the series combination of the Stern capacitance $C_{\\mathrmS}$ and the diffuse layer (Gouy-Chapman) capacitance $C_{\\mathrm{D}} = \\varepsilon\\kappa$.\n\nThe effective charging time constant, $\\tau$, is defined as the time at which the surface charge reaches a fraction $(1 - e^{-1})$ of its final steady-state value. We calculate this target charge $\\sigma_{\\text{target}} = \\sigma_\\infty (1 - e^{-1})$, monitor the computed $\\sigma(t_n)$ during the simulation, and identify the two consecutive time points, $t_{k-1}$ and $t_k$, that bracket $\\tau$ (i.e., $\\sigma(t_{k-1})  \\sigma_{\\text{target}} \\le \\sigma(t_k)$). A precise value for $\\tau$ is then found by linear interpolation between these two points:\n$$ \\tau = t_{k-1} + (t_k - t_{k-1}) \\frac{\\sigma_{\\text{target}} - \\sigma(t_{k-1})}{\\sigma(t_k) - \\sigma(t_{k-1})} $$\nThe final result for each test case is this value of $\\tau$, rounded to six significant figures.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Physical Constants in SI units\n    EPS0 = 8.8541878128e-12  # F/m\n    EPS_R = 78.5\n    EPS = EPS_R * EPS0\n    KB = 1.380649e-23  # J/K\n    T = 298.0  # K\n    E = 1.602176634e-19  # C\n    NA = 6.02214076e+23  # 1/mol\n    Z = 1.0\n\n    constants = {\n        'eps': EPS,\n        'kB': KB,\n        'T': T,\n        'e': E,\n        'Na': NA,\n        'z': Z\n    }\n\n    test_cases = [\n        # c_inf [mol/L], D [m^2/s], Cs [F/m^2], dPhi [V], L [m]\n        (0.1, 1.0e-9, 0.2, 0.025, 1.0e-7),\n        (0.001, 1.5e-9, 0.2, 0.010, 1.0e-6),\n        (0.1, 1.0e-9, 5.0, 0.025, 1.0e-7),\n        (0.1, 1.0e-9, 0.02, 0.025, 1.0e-7)\n    ]\n\n    results = []\n    for params in test_cases:\n        tau = compute_tau(params, constants)\n        results.append(tau)\n\n    # Format output to six significant figures.\n    formatted_results = [_format_to_6_sig_figs(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef _format_to_6_sig_figs(num):\n    \"\"\"Formats a number to a string with 6 significant figures.\"\"\"\n    if num == 0:\n        return '0.00000'\n    # Use scientific notation formatting with 5 decimal places for 6 total sig figs.\n    return f\"{num:.5e}\"\n\ndef compute_tau(params, constants):\n    \"\"\"\n    Computes the effective time constant for a single set of parameters.\n    \"\"\"\n    c_inf_L, D, Cs, dPhi, L = params\n    c_inf_SI = c_inf_L * 1000.0  # Convert mol/L to mol/m^3\n\n    eps = constants['eps']\n    kB = constants['kB']\n    T = constants['T']\n    e = constants['e']\n    Na = constants['Na']\n    z = constants['z']\n\n    # --- 1. Calculate derived parameters ---\n    kappa_sq = (2 * z**2 * e**2 * Na * c_inf_SI) / (eps * kB * T)\n    kappa = np.sqrt(kappa_sq)\n    lambda_D = 1.0 / kappa\n\n    # --- 2. Set up numerical grid ---\n    # Per problem spec: dx = lambda_D/8 and dx = L/400\n    num_intervals = int(max(400, np.ceil(L / (lambda_D / 8.0))))\n    dx = L / num_intervals\n    Nx = num_intervals + 1  # Number of grid points\n\n    Nt = 5000\n    T_end = 50.0 / (D * kappa_sq)\n    dt = T_end / Nt\n    \n    x = np.linspace(0, L, Nx)\n\n    # --- 3. Initialize potential and storage ---\n    phi = np.zeros(Nx)\n    \n    # We will solve for phi_0 to phi_{Nx-2}. phi_{Nx-1} is fixed at 0.\n    # The size of the linear system is Nx-1.\n    system_size = Nx - 1 \n\n    # --- 4. Assemble the tridiagonal matrix for the implicit scheme ---\n    alpha = D * dt / (dx**2)\n    beta = (2 * D * dt * Cs) / (eps * dx)\n\n    # Scipy's solve_banded uses a special storage format for banded matrices\n    # A has shape (3, system_size):\n    # row 0: upper diagonal (shifted)\n    # row 1: main diagonal\n    # row 2: lower diagonal (shifted)\n    A = np.zeros((3, system_size))\n\n    # Main diagonal\n    A[1, 0] = 1 + 2 * alpha + D * dt * kappa_sq + beta\n    A[1, 1:] = 1 + 2 * alpha + D * dt * kappa_sq\n\n    # Lower diagonal\n    A[2, 0:system_size-1] = -alpha\n\n    # Upper diagonal\n    A[0, 1] = -2 * alpha\n    A[0, 2:] = -alpha\n\n    # --- 5. Calculate steady-state and target charge ---\n    sigma_inf = (Cs * eps * kappa) / (Cs + eps * kappa) * dPhi\n    sigma_target = sigma_inf * (1 - np.exp(-1))\n\n    # --- 6. Time-stepping loop ---\n    times = np.linspace(0, T_end, Nt + 1)\n    sigmas = np.zeros(Nt + 1)\n\n    phi_k = phi[:system_size].copy() # Current potential vector (unknowns)\n\n    for n in range(1, Nt + 1):\n        # Build RHS vector b\n        b = phi_k.copy()\n        b[0] += beta * dPhi\n\n        # Solve the tridiagonal system for phi at the next time step\n        phi_k = solve_banded((1, 1), A, b, overwrite_ab=False, overwrite_b=True)\n        \n        # Calculate surface charge\n        phi_at_0 = phi_k[0]\n        sigma_t = Cs * (dPhi - phi_at_0)\n        \n        sigmas[n] = sigma_t\n        times[n] = n * dt\n        \n    # --- 7. Interpolate to find tau ---\n    tau = 0.0\n    for i in range(1, Nt + 1):\n        if sigmas[i] >= sigma_target:\n            sigma_prev = sigmas[i-1]\n            sigma_curr = sigmas[i]\n            time_prev = times[i-1]\n            time_curr = times[i]\n            \n            # Linear interpolation\n            if sigma_curr > sigma_prev:\n                fraction = (sigma_target - sigma_prev) / (sigma_curr - sigma_prev)\n                tau = time_prev + fraction * (time_curr - time_prev)\n            else: # Should not happen in a charging curve\n                tau = time_curr\n            break\n            \n    return tau\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}