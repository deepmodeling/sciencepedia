{
    "hands_on_practices": [
        {
            "introduction": "任何分子动力学（MD）模拟的核心都是力场，它精确地定义了粒子间的相互作用。本练习旨在实践模拟设置中的一个基本环节：如何使用混合规则来确定不同原子类型之间的相互作用参数 。通过将这些微观参数与可观测的宏观结构（如径向分布函数）联系起来，您将初步探索模拟参数如何影响系统的物理结构。",
            "id": "4238306",
            "problem": "考虑一个与计算电化学相关的经典分子动力学设定，其中离子使用 Lennard-Jones (LJ) 势和库仑相互作用进行建模，水由三点可转移分子间势 (TIP3P) 模型表示。需要两个基本要素：用于交叉相互作用的组合规则以及从微观势到结构可观测量的映射。假设以下经过充分检验的定义和关系：(i) 用于交叉 LJ 参数的 Lorentz–Berthelot 组合规则，$\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$ 和 $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$；(ii) LJ 对势 $U_{\\mathrm{LJ}}(r) = 4 \\epsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right]$；以及 (iii) 库仑相互作用 $U_{\\mathrm{C}}(r) = \\frac{k_e q_i q_j}{\\varepsilon_r r}$，其中 $k_e$ 是以能量-距离为单位的库仑常数，$q_i$ 和 $q_j$ 是以基本电荷为单位的粒子电荷，$\\varepsilon_r$ 是介质的相对介电常数。总对势为 $U_{\\mathrm{tot}}(r) = U_{\\mathrm{LJ}}(r) + U_{\\mathrm{C}}(r)$。\n\n在液体中，径向分布函数 $g(r)$ 通过 $g(r) \\propto \\exp\\left(-\\beta W(r)\\right)$ 与平均力势 $W(r)$ 相关联，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。当用对势 $U_{\\mathrm{tot}}(r)$ 来近似 $W(r)$ 时，$g(r)$ 的第一峰位可以通过 $U_{\\mathrm{tot}}(r)$ 的最小值位置来估计，即 $r^\\star = \\arg\\min_{r0} U_{\\mathrm{tot}}(r)$。尽管这种映射是一种近似，但它通常被用来推断水合结构的敏感性。\n\n您的任务是编写一个完整的程序，对于指定的钠 ($\\mathrm{Na}^+$) 和氯 ($\\mathrm{Cl}^-$) 的 Lennard-Jones 参数，以及给定的 TIP3P 氧参数，执行以下操作：\n\n1. 使用 Lorentz–Berthelot 组合规则计算 $\\mathrm{Na}$–$\\mathrm{Cl}$ 对的交叉相互作用 LJ 参数，即计算 $\\sigma_{\\mathrm{NaCl}}$ 和 $\\epsilon_{\\mathrm{NaCl}}$。\n2. 计算 $\\mathrm{Na}$–$\\mathrm{O}$ 对的交叉相互作用 LJ 参数，其中 $\\mathrm{O}$ 是 TIP3P 的氧，即计算 $\\sigma_{\\mathrm{NaO}}$ 和 $\\epsilon_{\\mathrm{NaO}}$。\n3. 使用 $\\mathrm{Na}$ 和 $\\mathrm{O}$ 之间的总势 $U_{\\mathrm{tot}}(r)$，其中 $q_{\\mathrm{Na}} = +1$ 和 $q_{\\mathrm{O}} = -0.834$，通过计算 $r^\\star = \\arg\\min_{r \\in [r_{\\min}, r_{\\max}]} U_{\\mathrm{tot}}(r)$ 来评估 $g_{\\mathrm{NaO}}(r)$ 的第一峰位，搜索区间 $[r_{\\min}, r_{\\max}]$ 选为 $[0.5, 6.0]$ 埃。使用库仑常数 $k_e = 13.8935456$，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}\\,e^{-2}$，这样当 $r$ 以 $\\mathrm{\\AA}$ 为单位且电荷以基本电荷为单位时，能量的单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n为每个测试案例报告以下量：\n- $\\sigma_{\\mathrm{NaCl}}$，单位为埃，\n- $\\epsilon_{\\mathrm{NaCl}}$，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，\n- $r^\\star$，单位为埃，四舍五入到三位小数。\n\n使用 TIP3P 氧的 Lennard-Jones 参数 $\\sigma_{\\mathrm{O}} = 3.15061$ 埃和 $\\epsilon_{\\mathrm{O}} = 0.636386$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，以及电荷 $q_{\\mathrm{Na}} = +1$，$q_{\\mathrm{O}} = -0.834$（以基本电荷为单位，无量纲）。此问题不涉及角度。\n\n测试套件：\n为以下四个参数集提供输出，每个参数集以 $(\\sigma_{\\mathrm{Na}}, \\epsilon_{\\mathrm{Na}}, \\sigma_{\\mathrm{Cl}}, \\epsilon_{\\mathrm{Cl}}, \\varepsilon_r)$ 的形式给出：\n- 案例 A（典型水溶液条件）：$(2.589, 0.3526418, 4.401, 0.100, 78.4)$。\n- 案例 B（由于较低介电常数导致更强的有效库仑作用）：$(2.589, 0.3526418, 4.401, 0.100, 30.0)$。\n- 案例 C（替代的钠 Lennard-Jones 参数，与案例 A 具有相同的介电常数）：$(2.350, 0.544, 4.401, 0.100, 78.4)$。\n- 案例 D（高介电屏蔽）：$(2.589, 0.3526418, 4.401, 0.100, 150.0)$。\n\n科学真实性说明：数值选择是合理的，并且在内部是一致的，以用于演示。此问题将水合结构的敏感性通过 $g_{\\mathrm{NaO}}(r)$ 的峰位（即 $U_{\\mathrm{tot}}(r)$ 的最小值）来构建，这是一种基于平衡统计力学的标准近似方法。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个元素对应一个测试案例，并且本身必须是 $[\\sigma_{\\mathrm{NaCl}}, \\epsilon_{\\mathrm{NaCl}}, r^\\star]$ 形式的列表，使用上述指定单位，所有数字四舍五入到三位小数。例如，输出格式类似于 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$。",
            "solution": "该问题是有效的。它定义明确，科学上基于经典统计力学和分子模拟的原理，并且所有必要的数据和定义都已提供。这些任务在计算上是直接的，涉及定义公式的直接应用和标准的一维数值优化。\n\n该问题要求对四个不同的测试案例进行一系列计算，每个案例由一组钠 ($\\mathrm{Na}^+$) 和氯 ($\\mathrm{Cl}^-$) 离子的 Lennard-Jones (LJ) 参数以及相对介电常数 ($\\varepsilon_r$) 的值定义。TIP3P 水模型氧原子 ($\\mathrm{O}$) 的参数作为常数给出。\n\n每个测试案例的三个主要任务是：\n1.  计算 $\\mathrm{Na}^+$-$\\mathrm{Cl}^-$ 对的交叉相互作用 LJ 参数，$\\sigma_{\\mathrm{NaCl}}$ 和 $\\epsilon_{\\mathrm{NaCl}}$。\n2.  计算 $\\mathrm{Na}^+$-$\\mathrm{O}$ 对的交叉相互作用 LJ 参数，$\\sigma_{\\mathrm{NaO}}$ 和 $\\epsilon_{\\mathrm{NaO}}$。（这些是下一步所需的中间值）。\n3.  通过找到总对势 $U_{\\mathrm{tot}}(r)$ 的最小值来估计 $\\mathrm{Na}^+$-$\\mathrm{O}$ 径向分布函数 $g_{\\mathrm{NaO}}(r)$ 的第一峰位 $r^\\star$。\n\n解决方案的逻辑步骤如下：\n\n**1. 交叉相互作用 Lennard-Jones 参数的计算**\n\n问题指定使用 Lorentz-Berthelot 组合规则：\n$$ \\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2} $$\n$$ \\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j} $$\n\n对于 $\\mathrm{Na}^+$-$\\mathrm{Cl}^-$ 对，给定特定测试案例的参数 $(\\sigma_{\\mathrm{Na}}, \\epsilon_{\\mathrm{Na}})$ 和 $(\\sigma_{\\mathrm{Cl}}, \\epsilon_{\\mathrm{Cl}})$，交叉相互作用参数计算如下：\n$$ \\sigma_{\\mathrm{NaCl}} = \\frac{\\sigma_{\\mathrm{Na}} + \\sigma_{\\mathrm{Cl}}}{2} $$\n$$ \\epsilon_{\\mathrm{NaCl}} = \\sqrt{\\epsilon_{\\mathrm{Na}} \\epsilon_{\\mathrm{Cl}}} $$\n这是每个案例需要报告的三个量中的两个。\n\n对于 $\\mathrm{Na}^+$-$\\mathrm{O}$ 对，我们使用给定的 $\\mathrm{Na}^+$ 参数和 TIP3P 氧原子的常数参数，$\\sigma_{\\mathrm{O}} = 3.15061 \\, \\mathrm{\\AA}$ 和 $\\epsilon_{\\mathrm{O}} = 0.636386 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。计算是类似的：\n$$ \\sigma_{\\mathrm{NaO}} = \\frac{\\sigma_{\\mathrm{Na}} + \\sigma_{\\mathrm{O}}}{2} $$\n$$ \\epsilon_{\\mathrm{NaO}} = \\sqrt{\\epsilon_{\\mathrm{Na}} \\epsilon_{\\mathrm{O}}} $$\n这些参数是下一步构建势函数所必需的。\n\n**2. 第一水合层峰位 ($r^\\star$) 的确定**\n\n径向分布函数 $g(r)$ 中第一峰的位置是液体局部结构的关键指标。问题指出 $g(r)$ 与平均力势 $W(r)$ 的关系为 $g(r) \\propto \\exp(-\\beta W(r))$，其中 $\\beta = 1/(k_B T)$。因此，$g(r)$ 的峰值对应于 $W(r)$ 的最小值。问题采用一个常见的近似，即用直接对势 $U_{\\mathrm{tot}}(r)$ 代替平均力势 $W(r)$。因此，我们寻求最小化 $U_{\\mathrm{tot}}(r)$ 的值 $r^\\star$：\n$$ r^\\star = \\arg\\min_{r  0} U_{\\mathrm{tot}}(r) $$\n\n$\\mathrm{Na}^+$-$\\mathrm{O}$ 相互作用的总对势是 Lennard-Jones 势和库仑势之和：\n$$ U_{\\mathrm{tot}}(r) = U_{\\mathrm{LJ}}(r) + U_{\\mathrm{C}}(r) $$\n\n代入每个分量的表达式，我们得到：\n$$ U_{\\mathrm{tot}}(r) = 4 \\epsilon_{\\mathrm{NaO}}\\left[\\left(\\frac{\\sigma_{\\mathrm{NaO}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{NaO}}}{r}\\right)^{6}\\right] + \\frac{k_e q_{\\mathrm{Na}} q_{\\mathrm{O}}}{\\varepsilon_r r} $$\n\n所需的参数有：\n- $\\sigma_{\\mathrm{NaO}}$ 和 $\\epsilon_{\\mathrm{NaO}}$，如上所述计算。\n- 偏电荷：$q_{\\mathrm{Na}} = +1 \\, e$ 和 $q_{\\mathrm{O}} = -0.834 \\, e$。\n- 库仑常数：$k_e = 13.8935456 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}\\,e^{-2}$。\n- 相对介电常数 $\\varepsilon_r$，为每个测试案例提供。\n\n任务是找到使该函数最小化的 $r$ 值。由于 $U_{\\mathrm{tot}}(r)$ 是一个非线性函数，我们必须使用数值优化方法。最小值的搜索应在区间 $r \\in [0.5, 6.0]$ 埃内进行。一维标量最小化算法，例如 `scipy.optimize.minimize_scalar` 提供的算法，适用于此目的。待最小化的函数是根据每个测试案例对应的特定参数集以 $r$ 定义的。此最小化的结果就是值 $r^\\star$。\n\n**3. 算法实现**\n\n总体算法如下：\n1.  定义常数参数：$\\sigma_{\\mathrm{O}}$、$\\epsilon_{\\mathrm{O}}$、$q_{\\mathrm{Na}}$、$q_{\\mathrm{O}}$ 和 $k_e$。\n2.  定义四个测试案例的列表，每个案例是一个元组 $(\\sigma_{\\mathrm{Na}}, \\epsilon_{\\mathrm{Na}}, \\sigma_{\\mathrm{Cl}}, \\epsilon_{\\mathrm{Cl}}, \\varepsilon_r)$。\n3.  初始化一个空列表以存储最终结果。\n4.  遍历每个测试案例：\n    a. 提取当前案例的参数 $(\\sigma_{\\mathrm{Na}}, \\epsilon_{\\mathrm{Na}}, \\sigma_{\\mathrm{Cl}}, \\epsilon_{\\mathrm{Cl}}, \\varepsilon_r)$。\n    b. 使用 Lorentz-Berthelot 规则计算 $\\sigma_{\\mathrm{NaCl}}$ 和 $\\epsilon_{\\mathrm{NaCl}}$。\n    c. 计算中间参数 $\\sigma_{\\mathrm{NaO}}$ 和 $\\epsilon_{\\mathrm{NaO}}$。\n    d. 使用当前案例的参数为 $\\mathrm{Na}^+$-$\\mathrm{O}$ 对定义总势函数 $U_{\\mathrm{tot}}(r)$。\n    e. 在区间 $[0.5, 6.0]$ 内数值求解 $r^\\star$，即最小化 $U_{\\mathrm{tot}}(r)$ 的 $r$ 值。\n    f. 存储当前案例的三元组 $[\\sigma_{\\mathrm{NaCl}}, \\epsilon_{\\mathrm{NaCl}}, r^\\star]$。\n5.  处理完所有测试案例后，将收集到的结果格式化为指定的单个字符串：一个列表的列表，每个数字四舍五入到三位小数，并且内部列表中没有空格，例如 `[[x1,y1,z1],[x2,y2,z2],...]`。\n6.  打印最终格式化的字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the computational electrochemistry problem for a given set of test cases.\n    \"\"\"\n\n    # Define constants given in the problem statement.\n    # TIP3P Oxygen parameters\n    SIGMA_O = 3.15061  # angstroms\n    EPSILON_O = 0.636386  # kJ/mol\n\n    # Charges in elementary charge units\n    Q_NA = 1.0\n    Q_O = -0.834\n\n    # Coulomb constant\n    K_E = 13.8935456  # kJ/mol * A * e^-2\n\n    # Search interval for r*\n    R_BOUNDS = (0.5, 6.0)  # angstroms\n\n    # Define the test cases from the problem statement.\n    # Each case is (sigma_Na, epsilon_Na, sigma_Cl, epsilon_Cl, epsilon_r)\n    test_cases = [\n        # Case A: (typical aqueous conditions)\n        (2.589, 0.3526418, 4.401, 0.100, 78.4),\n        # Case B: (stronger effective Coulomb due to lower dielectric)\n        (2.589, 0.3526418, 4.401, 0.100, 30.0),\n        # Case C: (alternative sodium Lennard-Jones parameters, same dielectric as Case A)\n        (2.350, 0.544, 4.401, 0.100, 78.4),\n        # Case D: (high dielectric screening)\n        (2.589, 0.3526418, 4.401, 0.100, 150.0),\n    ]\n\n    final_results = []\n    \n    for case in test_cases:\n        sigma_na, epsilon_na, sigma_cl, epsilon_cl, epsilon_r = case\n\n        # 1. Compute the cross-interaction LJ parameters for the Na-Cl pair\n        sigma_nacl = (sigma_na + sigma_cl) / 2.0\n        epsilon_nacl = np.sqrt(epsilon_na * epsilon_cl)\n\n        # 2. Compute the cross-interaction LJ parameters for the Na-O pair\n        sigma_nao = (sigma_na + SIGMA_O) / 2.0\n        epsilon_nao = np.sqrt(epsilon_na * EPSILON_O)\n\n        # 3. Define the total potential U_tot(r) for the Na-O pair\n        def u_total_nao(r, s_nao, e_nao, ep_r):\n            \"\"\"\n            Calculates the total pair potential between Na+ and O.\n            U_tot(r) = U_LJ(r) + U_C(r)\n            \"\"\"\n            # Lennard-Jones potential\n            # Using pre-computation of (sigma/r) for efficiency\n            sr6 = (s_nao / r)**6\n            sr12 = sr6**2\n            u_lj = 4.0 * e_nao * (sr12 - sr6)\n\n            # Coulombic potential\n            u_c = (K_E * Q_NA * Q_O) / (ep_r * r)\n\n            return u_lj + u_c\n\n        # Find r*, the location of the minimum of U_tot(r) for Na-O\n        # We pass the parameters for the current case to the function\n        # to be minimized.\n        result = minimize_scalar(\n            u_total_nao,\n            bounds=R_BOUNDS,\n            method='bounded',\n            args=(sigma_nao, epsilon_nao, epsilon_r)\n        )\n        r_star = result.x\n        \n        # Store the results for this case\n        final_results.append((sigma_nacl, epsilon_nacl, r_star))\n\n    # Format the output string as per the problem specification:\n    # [[x1,y1,z1],[x2,y2,z2],...] with numbers rounded to three decimal places\n    # and no spaces inside the inner lists.\n    formatted_strings = []\n    for s_nacl, e_nacl, r_star in final_results:\n        formatted_strings.append(f\"[{s_nacl:.3f},{e_nacl:.3f},{r_star:.3f}]\")\n    \n    final_output_string = f\"[{','.join(formatted_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "分子动力学模拟能够生成海量的微观数据，而其真正的价值在于将这些微观细节与宏观物理性质联系起来。本练习将引导您应用统计力学中的一个核心原理——涨落-耗散定理——从系统总偶极矩的涨落中计算出静态介电常数 。这不仅是一次编程实践，更是对如何从微观涨落中提取宏观响应性质的深刻体验。",
            "id": "4238365",
            "problem": "考虑一个由经典分子动力学（MD）模拟的电中性、各向同性、周期性的含水电解质模拟单元。在给定时间，单元的总偶极矩矢量由基本静电学关系 $ \\mathbf{M} = \\sum_{i} q_i \\mathbf{r}_i $ 定义，其中 $ q_i $ 是粒子电荷，$ \\mathbf{r}_i $ 是它们相对于固定原点的位置矢量。宏观极化强度为 $ \\mathbf{P} = \\mathbf{M}/V $，其中 $ V $ 是系统体积。在存在一个弱的、空间均匀的外部电场 $ \\mathbf{E} $ 的情况下，哈密顿量增加了一个耦合项 $ -\\mathbf{M}\\cdot\\mathbf{E} $，并且适用温度为 $ T $ 的正则系综。在立方和各向同性单元中，采用传导（锡箔）边界条件时，线性响应和平衡统计力学通过涨落-耗散定理（FDT）将场致极化与平衡偶极涨落联系起来。\n\n仅从以下几点出发：\n- 应用于MD轨迹的牛顿运动定律，\n- 包含玻尔兹曼因子 $ \\exp(-\\beta H) $ 的正则系综定义，$ \\beta = 1/(k_B T) $，\n- 极化强度的定义 $ \\mathbf{P} = \\mathbf{M}/V $，\n- 材料关系式 $ \\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\mathbf{P} $，\n并将响应视为零场下的线性和各向同性，推导出一个用无外场时 $ \\mathbf{M} $ 的偶极矩涨落表示的静态相对介电常数（静态介电常数）$ \\epsilon_r $ 的平衡涨落表达式。请用MD轨迹中 $ \\mathbf{M} $ 的时间平均值、真空介电常数 $ \\epsilon_0 $、盒子体积 $ V $、玻尔兹曼常数 $ k_B $ 和温度 $ T $ 来表示 $ \\epsilon_r $。\n\n然后，实现一个程序，该程序在给定总偶极矩矢量 $ \\mathbf{M}(t) $ 的离散时间样本的情况下，通过用时间平均代替系综平均来计算 $ \\epsilon_r $。您的程序必须：\n- 使用 $ 1 $ 德拜 $ = 3.33564\\times 10^{-30} $ 库仑·米，将以德拜为单位的偶极数据转换为库仑·米。\n- 使用 $ \\epsilon_0 = 8.854187817\\times 10^{-12} $ 法拉/米，$ k_B = 1.380649\\times 10^{-23} $ 焦耳/开尔文。\n- 根据以纳米为单位的立方盒子边长 $ L $ 计算体积：$ V = (L\\times 10^{-9})^3 $ 米$^3$。\n- 除非出现非零平均值，否则将每个数据集视为各向同性；确保计算适当地减去任何非零的平均偶极矢量。\n\n物理单位：您计算出的 $ \\epsilon_r $ 最终答案必须是无量纲的。\n\n角度单位：不适用。\n\n百分比：不适用。\n\n测试套件。对于每种情况，通过用指定的振幅 $ a $（单位为德拜）缩放偶极矢量的基本模式，并可选地向所有帧添加一个恒定的漂移矢量 $ \\mathbf{d} $（单位为德拜），来构建一个包含 $ N = 4 $ 个时间帧的合成MD轨迹。基本模式是：\n- 帧 $ 1 $: $ [a, a, a] $,\n- 帧 $ 2 $: $ [-a, -a, -a] $,\n- 帧 $ 3 $: $ [a, -a, a] $,\n- 帧 $ 4 $: $ [-a, a, -a] $。\n如果指定了漂移 $ \\mathbf{d} = [d_x, d_y, d_z] $，则在转换单位之前，将其按分量加到每个帧的矢量上。\n\n评估以下情况：\n1. 情况 $ 1 $（名义上的纯水状）：$ T = 298.15 $ K，$ L = 3.0 $ nm，振幅 $ a = 82.5 $ 德拜，无漂移（$ \\mathbf{d} = [0,0,0] $）。\n2. 情况 $ 2 $（中等浓度的氯化钠水溶液，有轻微的极化漂移）：$ T = 298.15 $ K，$ L = 3.0 $ nm，振幅 $ a = 80.3 $ 德拜，漂移 $ \\mathbf{d} = [5.0, -3.0, 2.0] $ 德拜。\n3. 情况 $ 3 $（较小盒子中浓度更高的电解质）：$ T = 298.15 $ K，$ L = 2.5 $ nm，振幅 $ a = 59.0 $ 德拜，无漂移（$ \\mathbf{d} = [0,0,0] $）。\n4. 情况 $ 4 $（较大盒子中稍高温度下的高离子强度）：$ T = 310.0 $ K，$ L = 3.5 $ nm，振幅 $ a = 93.6 $ 德拜，无漂移（$ \\mathbf{d} = [0,0,0] $）。\n\n您的程序应生成一行输出，其中包含上述情况下计算出的四个 $ \\epsilon_r $ 值，格式为用方括号括起来的逗号分隔列表，顺序与情况相同（例如，$ [\\epsilon_{r,1},\\epsilon_{r,2},\\epsilon_{r,3},\\epsilon_{r,4}] $）。",
            "solution": "我们首先在正则系综下，使用平衡统计力学将微观偶极涨落与宏观介电响应联系起来。令 $ H_0 $ 表示在无外部电场时电解质的哈密顿量，令 $ \\mathbf{E} $ 为一个均匀的外部电场。电场通过相互作用能 $ H_{\\text{int}} = -\\mathbf{M}\\cdot\\mathbf{E} $ 与系统耦合，因此完整的哈密顿量为 $ H = H_0 - \\mathbf{M}\\cdot\\mathbf{E} $。温度 $ T $ 下的正则配分函数为 $ Z(\\mathbf{E}) = \\int \\mathrm{d}\\Gamma \\exp\\left( -\\beta \\left( H_0(\\Gamma) - \\mathbf{M}(\\Gamma)\\cdot\\mathbf{E} \\right) \\right) $，其中 $ \\Gamma $ 表示相空间坐标，$ \\beta = 1/(k_B T) $。\n\n在电场 $ \\mathbf{E} $ 下偶极矩的热平均值为\n$$\n\\langle \\mathbf{M} \\rangle_{\\mathbf{E}} = \\frac{1}{Z(\\mathbf{E})} \\int \\mathrm{d}\\Gamma \\, \\mathbf{M}(\\Gamma) \\exp\\left( -\\beta \\left( H_0(\\Gamma) - \\mathbf{M}(\\Gamma)\\cdot\\mathbf{E} \\right) \\right).\n$$\n对电场求导并在零场下取值，得到线性响应极化率张量\n$$\n\\chi_{\\alpha\\beta} = \\left. \\frac{\\partial \\langle M_\\alpha \\rangle_{\\mathbf{E}}}{\\partial E_\\beta} \\right|_{\\mathbf{E}=\\mathbf{0}} = \\beta \\left( \\langle M_\\alpha M_\\beta \\rangle - \\langle M_\\alpha \\rangle \\langle M_\\beta \\rangle \\right),\n$$\n这是一个由涨落-耗散定理（FDT）产生的标准平衡涨落公式。对于各向同性系统，极化率张量简化为标量极化率 $ \\chi $，因此 $ \\chi_{\\alpha\\beta} = \\delta_{\\alpha\\beta} \\chi $，其迹为\n$$\n\\chi = \\frac{1}{3} \\beta \\left( \\langle \\mathbf{M}^2 \\rangle - \\langle \\mathbf{M} \\rangle^2 \\right),\n$$\n其中 $ \\mathbf{M}^2 = \\mathbf{M}\\cdot\\mathbf{M} $ 且 $ \\langle \\mathbf{M} \\rangle^2 = \\langle \\mathbf{M} \\rangle \\cdot \\langle \\mathbf{M} \\rangle $。在宏观上，极化强度为 $ \\mathbf{P} = \\mathbf{M}/V $，对于线性、各向同性、均匀介质，其本构关系为 $ \\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\mathbf{P} = \\epsilon \\mathbf{E} $，其中 $ \\epsilon = \\epsilon_r \\epsilon_0 $ 是绝对介电常数。标量极化率通过 $ \\mathbf{P} = \\epsilon_0 \\chi \\mathbf{E} $ 连接极化强度和电场，因此 $ \\epsilon_r = 1 + \\chi $。\n\n将微观涨落表达式与此宏观关系相结合，得到\n$$\n\\epsilon_r = 1 + \\frac{1}{3 \\epsilon_0 V} \\beta \\left( \\langle \\mathbf{M}^2 \\rangle - \\langle \\mathbf{M} \\rangle^2 \\right) = 1 + \\frac{ \\langle \\mathbf{M}^2 \\rangle - \\langle \\mathbf{M} \\rangle^2 }{ 3 \\epsilon_0 V k_B T }.\n$$\n要从MD轨迹计算 $ \\epsilon_r $，我们用离散样本上的时间平均代替系综平均。给定 $ N $ 帧的 $ \\mathbf{M}(t_j) $，其分量为 $ M_x(t_j), M_y(t_j), M_z(t_j) $，所需的平均值为\n$$\n\\langle \\mathbf{M} \\rangle \\approx \\frac{1}{N} \\sum_{j=1}^{N} \\mathbf{M}(t_j), \\qquad \\langle \\mathbf{M}^2 \\rangle \\approx \\frac{1}{N} \\sum_{j=1}^{N} \\left( \\mathbf{M}(t_j)\\cdot \\mathbf{M}(t_j) \\right).\n$$\n然后我们计算\n$$\n\\mathrm{Var}(\\mathbf{M}) = \\langle \\mathbf{M}^2 \\rangle - \\langle \\mathbf{M} \\rangle^2,\n$$\n最后\n$$\n\\epsilon_r = 1 + \\frac{ \\mathrm{Var}(\\mathbf{M}) }{ 3 \\epsilon_0 V k_B T }.\n$$\n\n单位处理至关重要。输入的偶极矢量以德拜为单位，因此我们使用 $ 1 $ 德拜 $ = 3.33564\\times 10^{-30} $ 库仑·米 将每个矢量转换为国际单位制（SI）。盒子是立方体，边长 $ L $ 以纳米为单位，因此 $ V = (L\\times 10^{-9})^3 $ 米$^3$。我们使用 $ \\epsilon_0 = 8.854187817\\times 10^{-12} $ 法拉/米 和 $ k_B = 1.380649\\times 10^{-23} $ 焦耳/开尔文。\n\n每种情况的算法步骤：\n1. 使用给定的振幅 $ a $（德拜）从基本模式构建 $ N = 4 $ 个以德拜为单位的偶极帧，如果指定了漂移 $ \\mathbf{d} $（德拜），则加上它。\n2. 将每个帧乘以 $ 3.33564\\times 10^{-30} $ 转换为库仑·米。\n3. 计算 $ \\langle \\mathbf{M} \\rangle $、$ \\langle \\mathbf{M}^2 \\rangle $ 和 $ \\mathrm{Var}(\\mathbf{M}) $。\n4. 根据 $ L $ 计算 $ V $，并根据涨落表达式计算 $ \\epsilon_r $。\n5. 报告无量纲的 $ \\epsilon_r $。\n\n将这些步骤应用于指定的测试套件，会产生无量纲的输出。因为基本模式是对称的，任何非零漂移 $ \\mathbf{d} $ 只对 $ \\langle \\mathbf{M} \\rangle $ 和 $ \\langle \\mathbf{M}^2 \\rangle $ 有贡献，但它在 $ \\mathrm{Var}(\\mathbf{M}) $ 的减法 $ \\langle \\mathbf{M}^2 \\rangle - \\langle \\mathbf{M} \\rangle^2 $ 中被抵消。对于所选的振幅和盒子/温度参数，计算出的值与给定条件下含水电解质的物理上合理的静态介电常数一致。最终程序以所需的单行方括号格式计算并输出四个值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nEPS0 = 8.854187817e-12  # vacuum permittivity (F/m)\nKB = 1.380649e-23       # Boltzmann constant (J/K)\nDEBYE_TO_CM = 3.33564e-30  # Debye to Coulomb-meter\n\ndef construct_frames(amplitude_D, drift_D=None):\n    \"\"\"\n    Construct 4 dipole frames in Debye based on the specified pattern, amplitude, and optional drift.\n    Returns an array of shape (4, 3).\n    \"\"\"\n    a = amplitude_D\n    base_frames = np.array([\n        [ a,  a,  a],\n        [-a, -a, -a],\n        [ a, -a,  a],\n        [-a,  a, -a]\n    ], dtype=float)\n    if drift_D is not None:\n        drift = np.array(drift_D, dtype=float)\n        base_frames = base_frames + drift\n    return base_frames\n\ndef compute_eps_r(frames_D, T_K, L_nm):\n    \"\"\"\n    Compute the static relative permittivity epsilon_r from dipole frames in Debye,\n    temperature T in K, and cubic box length L in nm.\n    \"\"\"\n    # Convert frames to SI (C·m)\n    frames_SI = frames_D * DEBYE_TO_CM\n\n    # Compute averages\n    M_mean = np.mean(frames_SI, axis=0)                   # vector mean\n    M2_mean = np.mean(np.sum(frames_SI**2, axis=1))       # mean of M·M\n    var_M = M2_mean - np.dot(M_mean, M_mean)              # vector variance\n\n    # Volume in m^3\n    L_m = L_nm * 1e-9\n    V = L_m ** 3\n\n    # Compute epsilon_r\n    eps_r = 1.0 + var_M / (3.0 * EPS0 * V * KB * T_K)\n    return eps_r\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: (T_K, L_nm, amplitude_D, drift_D or None)\n        (298.15, 3.0, 82.5, None),                     # Case 1\n        (298.15, 3.0, 80.3, [5.0, -3.0, 2.0]),         # Case 2\n        (298.15, 2.5, 59.0, None),                     # Case 3\n        (310.0,  3.5, 93.6, None),                     # Case 4\n    ]\n\n    results = []\n    for T_K, L_nm, amplitude_D, drift in test_cases:\n        frames_D = construct_frames(amplitude_D, drift)\n        eps_r = compute_eps_r(frames_D, T_K, L_nm)\n        results.append(eps_r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "检验一个计算模型的最终标准是其预测和复现真实实验的能力。本练习模拟了计算电化学中一个常见的核心工作流程：处理电极-电解质界面的原始模拟数据，并与实验测量值进行定量比较 。您将学习到关键的实用技能，例如通过零电荷电势（PZC）校准电势标度，以及计算微分电容，从而掌握如何验证模拟结果并洞察真实世界的电化学现象。",
            "id": "4238391",
            "problem": "您的任务是设计一个程序，该程序利用计算电化学中经典分子动力学模拟产生的输出来对电极-电解质体系进行校准和差异量化。该程序必须处理电极电势及其相应表面电荷密度的离散采样数据，并将得到的微分电容曲线与实验数据进行比较。其推导和算法必须基于经典力学和静电学的第一性原理。\n\n从基本原理出发，使用以下基础：\n- 经典粒子的牛顿第二定律：对于质量为 $m_i$、位置为 $\\mathbf{r}_i$ 的粒子 $i$，有 $\\mathbf{F}_i = m_i \\, d^2 \\mathbf{r}_i / dt^2$。\n- 表面电荷密度的定义：$\\sigma(V)$ 是在电极电势为 $V$ 时，通过模拟的恒定电势边界条件得到的单位面积上的电极净电荷。\n- 单位面积微分电容的定义：$C(V) = d\\sigma / dV$。\n\n定义：\n- 零电荷电势 (PZC)：$V_{\\mathrm{PZC}}$ 是使 $\\sigma(V_{\\mathrm{PZC}}) = 0$ 的电极电势。\n- 功函数校准偏移量：在经典分子动力学模拟中，由于电极功函数的影响，绝对电势参考点可能与实验存在偏移。需要校准一个有效的电势偏移量 $\\Delta V$，以使模拟的 $V_{\\mathrm{PZC}}$ 与实验的 $V_{\\mathrm{PZC}}$ 对齐。对模拟电势使用加法校准 $V_{\\mathrm{cal}} = V_{\\mathrm{sim}} - \\Delta V$，其中 $\\Delta V = V_{\\mathrm{PZC}}^{\\mathrm{sim}} - V_{\\mathrm{PZC}}^{\\mathrm{exp}}$。\n\n算法要求：\n1. 给定一组离散的模拟电势 $V_{\\mathrm{sim}}$（单位：伏特）和相应的表面电荷密度 $\\sigma_{\\mathrm{sim}}$（单位：$\\mathrm{C}/\\mathrm{m}^2$），通过以下方式计算 $V_{\\mathrm{PZC}}^{\\mathrm{sim}}$：\n   - 如果存在索引对 $(i,i+1)$ 使得 $\\sigma_{\\mathrm{sim}}(V_i) \\cdot \\sigma_{\\mathrm{sim}}(V_{i+1}) \\le 0$，则通过在 $(V_i,\\sigma_i)$ 和 $(V_{i+1},\\sigma_{i+1})$ 之间进行线性插值来计算零点。\n   - 如果在定义域内没有发生符号变化，则通过最小二乘线性回归 $\\sigma(V) \\approx a V + b$ 来估计 $V_{\\mathrm{PZC}}^{\\mathrm{sim}}$，并计算 $V_{\\mathrm{PZC}}^{\\mathrm{sim}} = -b/a$（假设 $a \\ne 0$）。\n2. 给定 $V_{\\mathrm{PZC}}^{\\mathrm{exp}}$（单位：伏特），计算功函数校准偏移量 $\\Delta V = V_{\\mathrm{PZC}}^{\\mathrm{sim}} - V_{\\mathrm{PZC}}^{\\mathrm{exp}}$（单位：伏特），以及校准后的电势 $V_{\\mathrm{cal}} = V_{\\mathrm{sim}} - \\Delta V$。\n3. 通过对 $\\sigma_{\\mathrm{sim}}$ 关于 $V_{\\mathrm{cal}}$ 进行数值微分，计算单位面积微分电容 $C_{\\mathrm{sim}}(V_{\\mathrm{cal}})$（单位：$\\mathrm{F}/\\mathrm{m}^2$）。对内部点使用二阶精确的中心差分，对端点使用一阶向前/向后差分。\n4. 给定实验电容曲线样本 $(V_{\\mathrm{exp}}, C_{\\mathrm{exp}})$，在共享的电势域上将 $C_{\\mathrm{sim}}(V_{\\mathrm{cal}})$ 插值到 $V_{\\mathrm{exp}}$ 网格上，并计算：\n   - 在重叠区域内，插值后模拟电容与实验电容之间的均方根误差 (RMSE)（单位：$\\mathrm{F}/\\mathrm{m}^2$）。\n   - 在同一重叠区域内的最大绝对偏差 (MAD)（单位：$\\mathrm{F}/\\mathrm{m}^2$）。\n5. 在校准后的标度上计算校准后的 PZC $V_{\\mathrm{PZC}}^{\\mathrm{cal}} = V_{\\mathrm{PZC}}^{\\mathrm{sim}} - \\Delta V$，如果按规定应用偏移量，该值应等于 $V_{\\mathrm{PZC}}^{\\mathrm{exp}}$。\n\n单位：\n- 所有电势必须以伏特 (V) 为单位。\n- 表面电荷密度必须以库仑/平方米 ($\\mathrm{C}/\\mathrm{m}^2$) 为单位。\n- 电容必须以法拉/平方米 ($\\mathrm{F}/\\mathrm{m}^2$) 为单位。\n\n测试套件由以下三个案例定义，您的程序应直接使用，不作更改：\n- 案例1（正常路径；单调的 $\\sigma(V)$ 且零点在域内）：\n  - $V_{\\mathrm{sim}} = [-1.0,-0.5,0.0,0.5,1.0]$.\n  - $\\sigma_{\\mathrm{sim}} = [-0.25,-0.12,0.0,0.12,0.26]$.\n  - $V_{\\mathrm{exp}} = [-0.5,0.0,0.5,1.0]$.\n  - $C_{\\mathrm{exp}} = [0.23,0.24,0.26,0.28]$.\n  - $V_{\\mathrm{PZC}}^{\\mathrm{exp}} = 0.10$.\n- 案例2（边界情况；域内无零点，需要外插计算 PZC）：\n  - $V_{\\mathrm{sim}} = [0.2,0.6,1.0,1.4]$.\n  - $\\sigma_{\\mathrm{sim}} = [0.05,0.15,0.26,0.36]$.\n  - $V_{\\mathrm{exp}} = [0.0,0.4,0.8,1.2,1.6]$.\n  - $C_{\\mathrm{exp}} = [0.24,0.25,0.27,0.29,0.305]$.\n  - $V_{\\mathrm{PZC}}^{\\mathrm{exp}} = 0.00$.\n- 案例3（非线性的 $\\sigma(V)$，零点在域内且曲率适中）：\n  - $V_{\\mathrm{sim}} = [-1.5,-1.0,-0.5,0.0,0.5,1.0,1.5]$.\n  - $\\sigma_{\\mathrm{sim}} = [-0.30,-0.22,-0.12,-0.02,0.09,0.21,0.35]$.\n  - $V_{\\mathrm{exp}} = [-1.0,-0.5,0.0,0.5,1.0,1.5]$.\n  - $C_{\\mathrm{exp}} = [0.18,0.20,0.22,0.25,0.28,0.32]$.\n  - $V_{\\mathrm{PZC}}^{\\mathrm{exp}} = 0.15$.\n\n您的程序必须生成单行输出，其中包含一个子列表的列表，每个案例对应一个子列表，每个子列表包含四个浮点数，顺序为 $[\\Delta V, V_{\\mathrm{PZC}}^{\\mathrm{cal}}, \\mathrm{RMSE}, \\mathrm{MAD}]$，无空格。例如，最终输出格式必须类似于 “[[d1,v1,r1,m1],[d2,v2,r2,m2],[d3,v3,r3,m3]]”。所有报告值必须使用上述指定的国际单位制（SI）单位。",
            "solution": "经典力学和静电学原理为电化学界面的分子动力学模拟提供了基础。牛顿第二定律 $\\mathbf{F}_i = m_i d^2 \\mathbf{r}_i / dt^2$ 控制着每个质量为 $m_i$、位置为 $\\mathbf{r}_i$ 的粒子 $i$ 在原子间力作用下的运动。在恒电势模拟中，电极保持在指定的电势 $V$，系统演化到一个平衡态，其特征是电极上具有净表面电荷密度 $\\sigma(V)$。这两个量之间的关系定义了界面的电化学行为。一个关键指标是单位面积微分电容 $C(V)$，定义为表面电荷密度随电极电势的变化率：\n$$C(V) = \\frac{d\\sigma}{dV}$$\n本问题要求开发一种算法，用以处理来自模拟的离散数据集 $(V_{\\mathrm{sim}}, \\sigma_{\\mathrm{sim}})$，并将得到的电容曲线与实验数据 $(V_{\\mathrm{exp}}, C_{\\mathrm{exp}})$ 进行比较。此比较中的一个关键步骤是电势标度的校准。模拟计算的电势是相对于一个内在参考（例如，真空能级）的，而实验电势通常是相对于标准参比电极报告的。这种差异主要由电极的功函数引起，会引入一个恒定的偏移量。我们可以通过对齐模拟和实验共有的一个关键物理特征来校正这一点：零电荷电势 $V_{\\mathrm{PZC}}$，在该电势下 $\\sigma(V_{\\mathrm{PZC}}) = 0$。校准偏移量 $\\Delta V$ 的确定方式是使模拟的 PZC 与实验的 PZC 对齐。然后，校准后的电势标度为 $V_{\\mathrm{cal}} = V_{\\mathrm{sim}} - \\Delta V$，其中 $\\Delta V = V_{\\mathrm{PZC}}^{\\mathrm{sim}} - V_{\\mathrm{PZC}}^{\\mathrm{exp}}$。\n\n算法流程如下：\n\n1.  **确定模拟的零电荷电势 $V_{\\mathrm{PZC}}^{\\mathrm{sim}}$**：\n    给定来自模拟的一组离散点 $(V_i, \\sigma_i)$，我们必须找到使 $\\sigma(V)=0$ 的电势 $V$。\n    -   如果电荷密度数据 $\\sigma_{\\mathrm{sim}}$ 在相邻点之间存在符号变化，即对于某个索引 $i$，有 $\\sigma_i \\cdot \\sigma_{i+1} \\le 0$，则 $V_{\\mathrm{PZC}}^{\\mathrm{sim}}$ 位于区间 $[V_i, V_{i+1}]$（或 $[V_{i+1}, V_i]$）内。我们将函数 $\\sigma(V)$ 在 $(V_i, \\sigma_i)$ 和 $(V_{i+1}, \\sigma_{i+1})$ 之间近似为一条直线。该直线与 $\\sigma = 0$ 的交点电势通过线性插值找到。斜率为 $m = (\\sigma_{i+1} - \\sigma_i) / (V_{i+1} - V_i)$。直线方程为 $\\sigma(V) - \\sigma_i = m (V - V_i)$。设 $\\sigma(V)=0$，解出 $V=V_{\\mathrm{PZC}}^{\\mathrm{sim}}$：\n        $$V_{\\mathrm{PZC}}^{\\mathrm{sim}} = V_i - \\frac{\\sigma_i}{m} = V_i - \\sigma_i \\frac{V_{i+1} - V_i}{\\sigma_{i+1} - \\sigma_i}$$\n    -   如果 $\\sigma_{\\mathrm{sim}}$ 在采样的电势范围内不改变符号，我们必须通过外插法来找到 $V_{\\mathrm{PZC}}^{\\mathrm{sim}}$。假设在该给定范围内关系近似线性，我们进行最小二乘线性回归以拟合模型 $\\sigma(V) \\approx aV + b$ 到 $(V_{\\mathrm{sim}}, \\sigma_{\\mathrm{sim}})$ 数据。系数 $a$ 和 $b$ 通过最小化残差平方和来确定。一旦找到最佳拟合线，PZC 通过求解 $\\sigma(V)=0$ 时的 $V$ 来估计：\n        $$V_{\\mathrm{PZC}}^{\\mathrm{sim}} = -\\frac{b}{a}$$\n\n2.  **电势标度校准**：\n    利用 $V_{\\mathrm{PZC}}^{\\mathrm{sim}}$ 和给定的实验值 $V_{\\mathrm{PZC}}^{\\mathrm{exp}}$，计算加法电势偏移量：\n    $$\\Delta V = V_{\\mathrm{PZC}}^{\\mathrm{sim}} - V_{\\mathrm{PZC}}^{\\mathrm{exp}}$$\n    然后将此偏移量应用于整套模拟电势，以获得校准后的电势标度：\n    $$V_{\\mathrm{cal},i} = V_{\\mathrm{sim},i} - \\Delta V$$\n    根据构造，校准后的零电荷电势 $V_{\\mathrm{PZC}}^{\\mathrm{cal}} = V_{\\mathrm{PZC}}^{\\mathrm{sim}} - \\Delta V$ 将等于 $V_{\\mathrm{PZC}}^{\\mathrm{exp}}$。\n\n3.  **计算模拟的微分电容 $C_{\\mathrm{sim}}$**：\n    电容 $C_{\\mathrm{sim}}$ 是 $\\sigma_{\\mathrm{sim}}$ 相对于校准电势 $V_{\\mathrm{cal}}$ 的导数。由于 $V_{\\mathrm{cal}}$ 只是 $V_{\\mathrm{sim}}$ 的一个简单平移（$dV_{\\mathrm{cal}} = dV_{\\mathrm{sim}}$），我们可以对 $\\sigma_{\\mathrm{sim}}$ 关于 $V_{\\mathrm{sim}}$ 进行微分。对于离散数据，我们使用有限差分法。为保持精度，对内部点使用二阶中心差分格式：\n    $$C_i = \\frac{\\sigma_{i+1} - \\sigma_{i-1}}{V_{i+1} - V_{i-1}}, \\quad \\text{for } i \\in [1, N-2]$$\n    在数据范围的边界处，无法使用中心差分，因此使用一阶向前/向后差分格式：\n    $$C_0 = \\frac{\\sigma_1 - \\sigma_0}{V_1 - V_0} \\quad \\text{(向前差分)}$$\n    $$C_{N-1} = \\frac{\\sigma_{N-1} - \\sigma_{N-2}}{V_{N-1} - V_{N-2}} \\quad \\text{ (向后差分)}$$\n    这样就得到了一组与电势 $V_{\\mathrm{cal}}$ 对应的电容值 $C_{\\mathrm{sim}}$。\n\n4.  **差异量化**：\n    为了比较模拟电容曲线 $(V_{\\mathrm{cal}}, C_{\\mathrm{sim}})$ 和实验电容曲线 $(V_{\\mathrm{exp}}, C_{\\mathrm{exp}})$，必须在共同的电势网格上对它们进行评估。我们首先确定重叠的电势域：$[\\max(\\min(V_{\\mathrm{cal}}), \\min(V_{\\mathrm{exp}})), \\min(\\max(V_{\\mathrm{cal}}), \\max(V_{\\mathrm{exp}}))]$。我们选择落在此重叠区域内的实验电势点 $V_{\\mathrm{exp},j}$。然后，我们对 $(V_{\\mathrm{cal}}, C_{\\mathrm{sim}})$ 数据使用线性插值，以在每个共同电势 $V_{\\mathrm{exp},j}$ 处找到模拟的电容值 $C_{\\mathrm{sim,interp},j}$。在相同的电势网格上，有了两组电容数据 $C_{\\mathrm{sim,interp}}$ 和对应的 $C_{\\mathrm{exp}}$ 子集，我们计算两个标准误差度量：\n    -   均方根误差 (RMSE)：\n        $$\\mathrm{RMSE} = \\sqrt{\\frac{1}{M}\\sum_{j=1}^{M} (C_{\\mathrm{sim,interp},j} - C_{\\mathrm{exp},j})^2}$$\n        其中 $M$ 是重叠域中的点数。\n    -   最大绝对偏差 (MAD)：\n        $$\\mathrm{MAD} = \\max_{j} |C_{\\mathrm{sim,interp},j} - C_{\\mathrm{exp},j}|$$\n这些度量量化了校准后模拟与实验之间的一致性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(case):\n    \"\"\"\n    Processes a single test case for electrode-electrolyte system calibration.\n\n    Args:\n        case (tuple): A tuple containing simulation and experimental data:\n                      (V_sim, sigma_sim, V_exp, C_exp, V_pzc_exp).\n\n    Returns:\n        list: A list of four floats [delta_V, V_pzc_cal, rmse, mad].\n    \"\"\"\n    V_sim, sigma_sim, V_exp, C_exp, V_pzc_exp = case\n    V_sim = np.array(V_sim, dtype=float)\n    sigma_sim = np.array(sigma_sim, dtype=float)\n    V_exp = np.array(V_exp, dtype=float)\n    C_exp = np.array(C_exp, dtype=float)\n\n    # 1. Compute V_pzc_sim\n    V_pzc_sim = None\n    found_crossing = False\n    for i in range(len(sigma_sim) - 1):\n        if sigma_sim[i] * sigma_sim[i+1] = 0:\n            V1, s1 = V_sim[i], sigma_sim[i]\n            V2, s2 = V_sim[i+1], sigma_sim[i+1]\n            \n            # Avoid division by zero if sigma values are identical\n            if s2 - s1 == 0:\n                # This implies both are zero if their product is = 0\n                V_pzc_sim = V1 if s1 == 0 else V2\n            else:\n                m = (s2 - s1) / (V2 - V1)\n                V_pzc_sim = V1 - s1 / m\n            \n            found_crossing = True\n            break\n            \n    if not found_crossing:\n        # Least squares linear regression: sigma = aV + b\n        a, b = np.polyfit(V_sim, sigma_sim, 1)\n        if a == 0:\n            # Physically unlikely edge case, but handle to avoid division by zero\n            # If a=0, sigma is constant. If that constant is not 0, PZC is at infinity.\n            # We set it to a large number as a placeholder, though problem implies a!=0.\n            V_pzc_sim = np.inf if b != 0 else 0\n        else:\n            V_pzc_sim = -b / a\n            \n    # 2. Compute offset and calibrated potentials\n    delta_V = V_pzc_sim - V_pzc_exp\n    V_cal = V_sim - delta_V\n\n    # 3. Compute simulated capacitance C_sim\n    # np.gradient uses 2nd-order central differences and 1st-order at boundaries by default\n    C_sim = np.gradient(sigma_sim, V_sim)\n\n    # 4. Quantify discrepancy\n    V_overlap_min = max(np.min(V_cal), np.min(V_exp))\n    V_overlap_max = min(np.max(V_cal), np.max(V_exp))\n    \n    overlap_mask = (V_exp >= V_overlap_min)  (V_exp = V_overlap_max)\n    V_compare = V_exp[overlap_mask]\n    C_exp_compare = C_exp[overlap_mask]\n\n    rmse = 0.0\n    mad = 0.0\n    \n    if V_compare.size > 0:\n        # Interpolate C_sim onto the comparison potential grid\n        C_sim_interp = np.interp(V_compare, V_cal, C_sim)\n        \n        # Calculate error metrics\n        errors = C_sim_interp - C_exp_compare\n        rmse = np.sqrt(np.mean(errors**2))\n        mad = np.max(np.abs(errors))\n\n    # 5. Compute calibrated PZC\n    V_pzc_cal = V_pzc_sim - delta_V\n\n    return [delta_V, V_pzc_cal, rmse, mad]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (\n            [-1.0,-0.5,0.0,0.5,1.0],\n            [-0.25,-0.12,0.0,0.12,0.26],\n            [-0.5,0.0,0.5,1.0],\n            [0.23,0.24,0.26,0.28],\n            0.10\n        ),\n        (\n            [0.2,0.6,1.0,1.4],\n            [0.05,0.15,0.26,0.36],\n            [0.0,0.4,0.8,1.2,1.6],\n            [0.24,0.25,0.27,0.29,0.305],\n            0.00\n        ),\n        (\n            [-1.5,-1.0,-0.5,0.0,0.5,1.0,1.5],\n            [-0.30,-0.22,-0.12,-0.02,0.09,0.21,0.35],\n            [-1.0,-0.5,0.0,0.5,1.0,1.5],\n            [0.18,0.20,0.22,0.25,0.28,0.32],\n            0.15\n        )\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(case)\n        results.append(result)\n\n    # Format the final output string as specified\n    output_str = \",\".join([f\"[{','.join(map(str, r))}]\" for r in results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        }
    ]
}