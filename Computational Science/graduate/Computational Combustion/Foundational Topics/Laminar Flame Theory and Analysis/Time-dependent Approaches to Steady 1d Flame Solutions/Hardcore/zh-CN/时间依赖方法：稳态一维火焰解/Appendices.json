{
    "hands_on_practices": [
        {
            "introduction": "我们首先从燃烧模拟中最具挑战性的一个方面入手：化学动力学中巨大的时间尺度跨度。这个练习  将演示为何显式时间积分方法在实践中往往不可行，它通过分析化学雅可比矩阵的特征值，让您对数值刚性有一个定量的理解，并为后续使用隐式方法求解火焰问题提供了理论依据。",
            "id": "4073140",
            "problem": "考虑一个一维预混火焰，通过时间推进方法计算其稳态解。在固定轴向位置的极早期瞬态过程中，忽略输运过程，并将局部化学反应建模为空间均匀动力学。在这段短暂的时间内，混合物是等温的，且密度恒定。一个刚性的两步全局机理将燃料转化为一种中间产物，然后再转化为最终产物：\n- 第1步：燃料 $\\mathrm{F}$ 和氧化剂 $\\mathrm{O}$ 反应生成中间产物 $\\mathrm{I}$，速率为 $r_{1} = k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}$。\n- 第2步：中间产物 $\\mathrm{I}$ 分解为产物 $\\mathrm{P}$，速率为 $r_{2} = k_{2} C_{\\mathrm{I}}$。\n\n此处，$C_{\\mathrm{F}}$ 和 $C_{\\mathrm{I}}$ 表示摩尔浓度，单位为 $\\mathrm{mol/m^{3}}$。在早期瞬态过程中，假设氧化剂浓度近似恒定，等于其初始值 $C_{\\mathrm{O}}$，并假定混合物遵循理想气体行为。状态向量为 $y = \\begin{pmatrix} C_{\\mathrm{F}} \\\\ C_{\\mathrm{I}} \\end{pmatrix}$，局部源项为 $S(y) = \\begin{pmatrix} -k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} \\\\ k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}} \\end{pmatrix}$。初始条件为 $C_{\\mathrm{F}}(0) = 1.0$ 和 $C_{\\mathrm{I}}(0) = 0$（单位为 $\\mathrm{mol/m^{3}}$）。\n\n您将分析初始状态下的局部化学雅可比矩阵及其特征值，并将其与用于稳态一维火焰伪瞬态方法的均匀动力学显式前向欧拉时间积分的允许时间步长联系起来。\n\n给定参数：\n- $k_{1} = 1.0 \\times 10^{4} \\, \\mathrm{m^{3}/(mol \\cdot s)}$,\n- $k_{2} = 2.0 \\times 10^{2} \\, \\mathrm{s^{-1}}$,\n- 压力 $p = 1.01325 \\times 10^{5} \\, \\mathrm{Pa}$,\n- 温度 $T = 300 \\, \\mathrm{K}$,\n- 氧气摩尔分数 $X_{\\mathrm{O}} = 0.21$,\n- 通用气体常数 $R = 8.314462618 \\, \\mathrm{J/(mol \\cdot K)}$。\n\n任务：\n1. 从质量作用定律和雅可比矩阵的定义 $J(y) = \\partial S/\\partial y$ 出发，推导在 $C_{\\mathrm{O}}$ 被视为常数时的初始状态下的化学雅可比矩阵。\n2. 用 $k_{1}$、$k_{2}$ 和 $C_{\\mathrm{O}}$ 符号化地计算该雅可比矩阵的特征值。\n3. 对应用于线性化系统 $\\dot{y} = J y$ 的显式前向欧拉法使用线性稳定性分析，确定在早期瞬态期间保证两种特征模式都稳定的最大时间步长 $\\Delta t_{\\max}$，首先以闭式形式表示结果，然后进行数值计算。\n4. 通过理想气体定律 $C_{\\text{tot}} = p/(R T)$ 和 $C_{\\mathrm{O}} = X_{\\mathrm{O}} C_{\\text{tot}}$ 计算 $C_{\\mathrm{O}}$，然后计算 $\\Delta t_{\\max}$ 的数值。\n\n将 $\\Delta t_{\\max}$ 的最终数值答案四舍五入到四位有效数字，并以秒为单位表示。最终答案必须是单个实数。",
            "solution": "该问题要求分析应用于简化、刚性化学动力学模型的显式时间积分方案的稳定性限制时间步长，该模型与一维预混火焰的伪瞬态计算相关。分析分四个步骤进行：推导化学雅可比矩阵，求其特征值，确定符号稳定性约束，最后计算最大允许时间步长的数值。\n\n**第1步：化学雅可比矩阵的推导**\n\n控制局部均匀动力学的常微分方程组(ODEs)由 $\\frac{dy}{dt} = S(y)$ 给出，其中状态向量 $y$ 和源项 $S(y)$ 定义如下：\n$$\ny = \\begin{pmatrix} C_{\\mathrm{F}} \\\\ C_{\\mathrm{I}} \\end{pmatrix}\n$$\n$$\nS(y) = \\begin{pmatrix} S_1 \\\\ S_2 \\end{pmatrix} = \\begin{pmatrix} -k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} \\\\ k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}} \\end{pmatrix}\n$$\n问题指明，氧化剂浓度 $C_{\\mathrm{O}}$ 被视为常数。化学雅可比矩阵 $J$ 定义为源项向量相对于状态向量各分量的偏导数矩阵：\n$$\nJ(y) = \\frac{\\partial S}{\\partial y} = \\begin{pmatrix} \\frac{\\partial S_1}{\\partial C_{\\mathrm{F}}} & \\frac{\\partial S_1}{\\partial C_{\\mathrm{I}}} \\\\ \\frac{\\partial S_2}{\\partial C_{\\mathrm{F}}} & \\frac{\\partial S_2}{\\partial C_{\\mathrm{I}}} \\end{pmatrix}\n$$\n我们计算雅可比矩阵的每个元素：\n- $\\frac{\\partial S_1}{\\partial C_{\\mathrm{F}}} = \\frac{\\partial}{\\partial C_{\\mathrm{F}}} (-k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}) = -k_{1} C_{\\mathrm{O}}$\n- $\\frac{\\partial S_1}{\\partial C_{\\mathrm{I}}} = \\frac{\\partial}{\\partial C_{\\mathrm{I}}} (-k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}}) = 0$\n- $\\frac{\\partial S_2}{\\partial C_{\\mathrm{F}}} = \\frac{\\partial}{\\partial C_{\\mathrm{F}}} (k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}}) = k_{1} C_{\\mathrm{O}}$\n- $\\frac{\\partial S_2}{\\partial C_{\\mathrm{I}}} = \\frac{\\partial}{\\partial C_{\\mathrm{I}}} (k_{1} C_{\\mathrm{F}} C_{\\mathrm{O}} - k_{2} C_{\\mathrm{I}}) = -k_{2}$\n\n组合这些分量得到雅可比矩阵：\n$$\nJ = \\begin{pmatrix} -k_{1} C_{\\mathrm{O}} & 0 \\\\ k_{1} C_{\\mathrm{O}} & -k_{2} \\end{pmatrix}\n$$\n由于源项 $S(y)$ 在 $y$ 的分量上是线性的（因为 $C_{\\mathrm{O}}$ 是常数），雅可比矩阵 $J$ 是一个常数矩阵，不依赖于状态 $y$。因此，在所述假设下，这就是初始状态以及所有后续时间的雅可比矩阵。\n\n**第2步：雅可比矩阵的特征值**\n\n矩阵的特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根。然而，雅可比矩阵 $J$ 是一个下三角矩阵。三角矩阵的一个基本性质是其特征值就是其主对角线上的元素。\n因此，$J$ 的特征值为：\n$$\n\\lambda_{1} = -k_{1} C_{\\mathrm{O}}\n$$\n$$\n\\lambda_{2} = -k_{2}\n$$\n\n**第3步：前向欧拉法的稳定性限制**\n\n前向欧拉法是一种显式时间积分格式，由 $y^{n+1} = y^n + \\Delta t S(y^n)$ 给出。对于线性系统 $\\dot{y} = Jy$，这变为 $y^{n+1} = y^n + \\Delta t J y^n = (I + \\Delta t J)y^n$。为使数值解保持稳定，放大矩阵 $G = I + \\Delta t J$ 的特征值的模必须不大于1。$G$ 的特征值为 $1 + \\Delta t \\lambda_i$，其中 $\\lambda_i$ 是 $J$ 的特征值。\n因此，稳定性条件为：\n$$\n|1 + \\Delta t \\lambda_i| \\le 1 \\quad \\text{for all } i\n$$\n在我们的情况中，速率常数 $k_{1}$ 和 $k_{2}$ 为正，浓度 $C_{\\mathrm{O}}$ 也为正。因此，特征值 $\\lambda_1 = -k_1 C_{\\mathrm{O}}$ 和 $\\lambda_2 = -k_2$ 都是实数且为负。对于一个实负特征值 $\\lambda$，稳定性条件 $|1 + \\Delta t \\lambda| \\le 1$ 展开为：\n$$\n-1 \\le 1 + \\Delta t \\lambda \\le 1\n$$\n不等式的右边，$1 + \\Delta t \\lambda \\le 1$，意味着 $\\Delta t \\lambda \\le 0$，这对于 $\\Delta t > 0$ 和 $\\lambda < 0$ 总是成立的。\n不等式的左边，$-1 \\le 1 + \\Delta t \\lambda$，意味着 $-2 \\le \\Delta t \\lambda$，可以重排得到时间步长约束：\n$$\n\\Delta t \\le -\\frac{2}{\\lambda}\n$$\n为确保整个系统的稳定性，时间步长 $\\Delta t$ 必须对所有特征值都满足此条件。这意味着 $\\Delta t$ 必须小于最严格的限制：\n$$\n\\Delta t \\le \\min\\left(-\\frac{2}{\\lambda_1}, -\\frac{2}{\\lambda_2}\\right) = \\min\\left(\\frac{2}{k_{1} C_{\\mathrm{O}}}, \\frac{2}{k_{2}}\\right)\n$$\n可能的最大时间步长 $\\Delta t_{\\max}$ 是使上式取等号的值。这可以用分母中的最大值函数来表示：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\max(k_{1} C_{\\mathrm{O}}, k_{2})}\n$$\n这就是最大稳定时间步长的闭式表达式。\n\n**第4步：时间步长的数值计算**\n\n为了找到 $\\Delta t_{\\max}$ 的数值，我们必须首先计算 $C_{\\mathrm{O}}$。假设混合物表现为理想气体，总摩尔浓度 $C_{\\text{tot}}$ 由理想气体定律 $p = C_{\\text{tot}} R T$ 给出：\n$$\nC_{\\text{tot}} = \\frac{p}{RT}\n$$\n使用给定值 $p = 1.01325 \\times 10^{5} \\, \\mathrm{Pa}$，$R = 8.314462618 \\, \\mathrm{J/(mol \\cdot K)}$，以及 $T = 300 \\, \\mathrm{K}$：\n$$\nC_{\\text{tot}} = \\frac{1.01325 \\times 10^{5} \\, \\mathrm{Pa}}{(8.314462618 \\, \\mathrm{J/(mol \\cdot K)}) (300 \\, \\mathrm{K})} \\approx 40.6215 \\, \\mathrm{mol/m^3}\n$$\n氧化剂浓度 $C_{\\mathrm{O}}$ 是其摩尔分数 $X_{\\mathrm{O}}$ 乘以总浓度：\n$$\nC_{\\mathrm{O}} = X_{\\mathrm{O}} C_{\\text{tot}} = 0.21 \\times 40.6215 \\, \\mathrm{mol/m^3} \\approx 8.5305 \\, \\mathrm{mol/m^3}\n$$\n现在我们计算 $\\Delta t_{\\max}$ 表达式分母中的两项：\n- 第一项是 $k_{1} C_{\\mathrm{O}}$。给定 $k_{1} = 1.0 \\times 10^{4} \\, \\mathrm{m^{3}/(mol \\cdot s)}$：\n$$\nk_{1} C_{\\mathrm{O}} = (1.0 \\times 10^{4}) \\times 8.5305 \\, \\mathrm{s^{-1}} \\approx 8.5305 \\times 10^{4} \\, \\mathrm{s^{-1}}\n$$\n- 第二项是 $k_{2}$，给定为 $k_{2} = 2.0 \\times 10^{2} \\, \\mathrm{s^{-1}}$。\n\n比较两个时间尺度的倒数：\n$$\n\\max(k_{1} C_{\\mathrm{O}}, k_{2}) = \\max(8.5305 \\times 10^{4}, 2.0 \\times 10^{2}) = 8.5305 \\times 10^{4} \\, \\mathrm{s^{-1}}\n$$\n最快的化学过程，即燃料的消耗，决定了稳定性极限。我们现在可以计算 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{2}{k_{1} C_{\\mathrm{O}}} = \\frac{2}{k_{1} X_{\\mathrm{O}} (p/RT)} = \\frac{2RT}{k_{1} X_{\\mathrm{O}} p}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2 \\times (8.314462618) \\times (300)}{(1.0 \\times 10^{4}) \\times (0.21) \\times (1.01325 \\times 10^{5})} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{4988.67757}{2.127825 \\times 10^{8}} \\, \\mathrm{s} \\approx 2.344550 \\times 10^{-5} \\, \\mathrm{s}\n$$\n按要求四舍五入到四位有效数字：\n$$\n\\Delta t_{\\max} \\approx 2.345 \\times 10^{-5} \\, \\mathrm{s}\n$$\n这个极小的时间步长突显了化学动力学中数值刚度带来的挑战，在这种情况下，显式方法受到最快反应时间尺度的严重限制，即使我们关心的是发生在慢得多的时间尺度上的现象。",
            "answer": "$$\\boxed{2.345 \\times 10^{-5}}$$"
        },
        {
            "introduction": "在理解了数值刚性的挑战之后，我们可以开始构建我们的第一个火焰求解器 。这个练习将指导您为一个非预混火焰面模型开发一个半隐式代码，其中扩散项被隐式处理以确保稳定性，而简化的显式反应项则让我们能更专注于求解器的基本结构。这种方法是在实现简易性和数值稳定性之间取得平衡的实用入门。",
            "id": "4073136",
            "problem": "本题要求构建一个瞬态计算程序，用于在固定的标量耗散率下恢复稳态一维小火焰解。控制方程基于混合分数坐标系中的组分守恒和能量守恒，并假设单位刘易斯数和恒定物性。目标是积分非稳态小火焰方程直至达到稳态，然后报告在几种不同标量耗散率下稳态剖面的定量特征。\n\n从以下基本原理出发：\n- 在一维坐标系中包含扩散和反应的组分守恒：对于每个质量分数为$Y$的反应组分，$$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial \\zeta^2} + S_Y,$$ 其中$D$是有效扩散系数，$S_Y$是化学源项。\n- 包含热传导和热释放的能量守恒：对于温度$T$，$$\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial \\zeta^2} + S_T,$$ 其中$S_T$是热释放源项。\n- 在单位刘易斯数的小火焰坐标系中，有效扩散系数由标量耗散率$\\chi$决定，即$D = \\chi/2$。\n\n假设一个单步不可逆反应，燃料与氧气反应生成产物：$$F + O \\rightarrow P,$$ 其速率采用类似阿伦尼乌斯模型，通过活化温度进行建模。在此模型下，\n- 组分和温度方程为\n$$\\frac{\\partial Y_F}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_F}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_O}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_O}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_P}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_P}{\\partial \\zeta^2} + \\omega,$$\n$$\\frac{\\partial T}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 T}{\\partial \\zeta^2} + H \\,\\omega,$$\n其中$\\omega$是反应速率，$H$是单位质量有效热释放除以比热容，单位为开尔文。\n- 使用以下反应速率模型：\n$$\\omega(\\zeta,t) = k_0 \\,\\exp\\!\\left(-\\frac{\\Theta}{T(\\zeta,t)}\\right)\\, Y_F(\\zeta,t)\\, Y_O(\\zeta,t),$$\n其中$k_0$是指前因子，单位为秒的倒数（s$^{-1}$），$\\Theta$是活化温度，单位为开尔文。\n\n在混合分数域的两端施加对应于纯净流的狄利克雷边界条件：\n- 在$\\zeta = 0$处：$Y_F = Y_{F,0}$, $Y_O = 0$, $Y_P = 0$, $T = T_0$。\n- 在$\\zeta = 1$处：$Y_F = 0$, $Y_O = Y_{O,1}$, $Y_P = 0$, $T = T_1$。\n使用无反应的线性混合剖面初始化场：\n$$Y_F(\\zeta,0) = Y_{F,0}\\,(1-\\zeta), \\quad Y_O(\\zeta,0) = Y_{O,1}\\,\\zeta, \\quad Y_P(\\zeta,0)=0, \\quad T(\\zeta,0) = T_0.$$\n\n将空间域$\\zeta \\in [0,1]$离散为$N$个点的均匀网格。采用数值稳定的方法对各方程进行时间积分，直至解达到稳态：使用后向欧拉法隐式处理扩散项，并显式处理反应源项。对于隐式离散扩散算子，使用$\\partial^2/\\partial \\zeta^2$的标准二阶中心差分近似和狄利克雷边界条件，从而在每个时间步为内部点生成一个三对角线性系统。对于内部索引为$j$的每个变量$u \\in \\{Y_F,Y_O,Y_P,T\\}$，在时间步$n \\to n+1$的半隐式时间离散格式为\n$$(1 + 2r)\\,u_j^{n+1} - r\\,u_{j-1}^{n+1} - r\\,u_{j+1}^{n+1} = u_j^n + \\Delta t\\,S_u^n + r\\,u_{\\text{left}}^{n+1}\\,\\delta_{j,1} + r\\,u_{\\text{right}}^{n+1}\\,\\delta_{j,M},$$\n其中$r = \\Delta t\\,(\\chi/2)/\\Delta \\zeta^2$，$M$是最后一个内部点的索引，$\\delta_{j,k}$是克罗内克δ函数，$u_{\\text{left}}$和$u_{\\text{right}}$分别是$\\zeta=0$和$\\zeta=1$处的边界值。显式源项为$S_{Y_F}^n = -\\omega^n$, $S_{Y_O}^n = -\\omega^n$, $S_{Y_P}^n = +\\omega^n$, $S_T^n = H\\,\\omega^n$，使用$Y_F^n$、$Y_O^n$和$T^n$进行计算。\n\n使用以下参数值（已注明物理单位）：\n- 标量耗散率$\\chi$（单位：s$^{-1}$）将因测试用例而异。\n- 指前因子$k_0 = 500$（单位：s$^{-1}$），活化温度$\\Theta = 2000$（单位：开尔文），热释放参数$H = 1500$（单位：开尔文）。\n- 边界条件：$Y_{F,0} = 0.8$（无量纲质量分数），$Y_{O,1} = 0.21$（无量纲质量分数），$T_0 = 300$（单位：开尔文），$T_1 = 300$（单位：开尔文）。\n- 空间网格点数$N = 128$（无量纲计数），均匀间距$\\Delta \\zeta = 1/(N-1)$；时间步长$\\Delta t = 0.002$（单位：秒）。\n- 收敛标准：当连续时间步之间的最大绝对变化满足$\\max\\{\\lVert Y_F^{n+1}-Y_F^n\\rVert_\\infty,\\lVert Y_O^{n+1}-Y_O^n\\rVert_\\infty,\\lVert Y_P^{n+1}-Y_P^n\\rVert_\\infty\\}  10^{-8}$且$\\lVert T^{n+1}-T^n\\rVert_\\infty  10^{-6}$时，或达到最大时间步数$6000$时，宣布达到稳态，以先到者为准。\n\n测试组：\n针对以下标量耗散率（单位：s$^{-1}$）评估程序：\n- 用例1：$\\chi = 0.5$（低耗散，理想情况）。\n- 用例2：$\\chi = 10.0$（中等耗散）。\n- 用例3：$\\chi = 80.0$（高耗散，接近熄火行为）。\n\n对于每个用例，在收敛后，计算以下三个输出：\n- 最高温度$T_{\\max}$（单位：开尔文），四舍五入到三位小数。\n- 最高温度的位置$\\zeta_{\\max T}$（在$[0,1]$范围内），四舍五入到三位小数。\n- 产物质量分数在整个域上的积分$\\int_0^1 Y_P(\\zeta)\\,d\\zeta$（无量纲），使用梯形法则计算，并四舍五入到三位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$[T_{\\max}^{(1)}, \\zeta_{\\max T}^{(1)}, I_P^{(1)}, T_{\\max}^{(2)}, \\zeta_{\\max T}^{(2)}, I_P^{(2)}, T_{\\max}^{(3)}, \\zeta_{\\max T}^{(3)}, I_P^{(3)}],$$\n其中上标$(k)$表示测试组中的用例$k$。$T_{\\max}$以开尔文表示，$\\zeta_{\\max T}$无量纲，$I_P$无量纲。不应打印任何其他文本。",
            "solution": "推导始于针对单位刘易斯数下混合分数坐标系的守恒定律，该定律将所有标量的扩散与标量耗散率联系起来。在用于小火焰描述的一维坐标$\\zeta$中，有效扩散系数为$D = \\chi/2$，其中$\\chi$是标量耗散率，单位为秒的倒数（s$^{-1}$）。组分质量分数$Y$的守恒方程为\n$$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial \\zeta^2} + S_Y,$$\n温度$T$的守恒方程为\n$$\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial \\zeta^2} + S_T,$$\n其中$S_Y$和$S_T$分别代表化学反应和热释放产生的源项。对于单步反应$F + O \\rightarrow P$，其速率通过活化温度表示的类似阿伦尼乌斯速率模型为\n$$\\omega(\\zeta,t) = k_0 \\,\\exp\\!\\left(-\\frac{\\Theta}{T(\\zeta,t)}\\right)\\, Y_F(\\zeta,t)\\, Y_O(\\zeta,t),$$\n其中$k_0$为指前因子，$\\Theta$为活化温度。在单位刘易斯数和恒定物性的条件下，组分和能量方程变为\n$$\\frac{\\partial Y_F}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_F}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_O}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_O}{\\partial \\zeta^2} - \\omega,$$\n$$\\frac{\\partial Y_P}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 Y_P}{\\partial \\zeta^2} + \\omega,$$\n$$\\frac{\\partial T}{\\partial t} = \\frac{\\chi}{2} \\frac{\\partial^2 T}{\\partial \\zeta^2} + H \\,\\omega,$$\n其中$H = Q/c_p$是单位反应进程的有效温升，Q是单位质量燃料消耗的热释放量，$c_p$是比热容。\n\n与逆流混合下的小火焰问题一致的边界条件，被施加为狄利克雷条件：\n- 在$\\zeta = 0$（燃料侧）：$Y_F = Y_{F,0}$, $Y_O = 0$, $Y_P = 0$, $T = T_0$。\n- 在$\\zeta = 1$（氧化剂侧）：$Y_F = 0$, $Y_O = Y_{O,1}$, $Y_P = 0$, $T = T_1$。\n这些条件代表了从两端进入的纯净流。初始条件是采用线性插值的无反应混合剖面：\n$$Y_F(\\zeta,0) = Y_{F,0}\\,(1-\\zeta),\\quad Y_O(\\zeta,0) = Y_{O,1}\\,\\zeta,\\quad Y_P(\\zeta,0)=0,\\quad T(\\zeta,0)=T_0.$$\n\n为了通过时间积分计算稳态解，我们将$\\zeta \\in [0,1]$离散为$N$个均匀间隔的点，点间距为$\\Delta \\zeta = 1/(N-1)$，并采用时间步长$\\Delta t$。扩散算子使用二阶中心有限差分来近似二阶导数。对于内部点$j = 1,\\dots,N-2$，通用场$u$的$\\partial^2 u/\\partial \\zeta^2$的空间离散化为\n$$\\left.\\frac{\\partial^2 u}{\\partial \\zeta^2}\\right|_j \\approx \\frac{u_{j-1} - 2 u_j + u_{j+1}}{\\Delta \\zeta^2}.$$\n我们隐式处理扩散项以确保在大$\\chi$值下的稳定性，并显式处理反应源项以避免求解非线性系统。对于内部点$j$，采用显式源项的后向欧拉格式得出：\n$$(1 + 2r)\\,u_j^{n+1} - r\\,u_{j-1}^{n+1} - r\\,u_{j+1}^{n+1} = u_j^n + \\Delta t\\,S_u^n,$$\n其中\n$$r = \\frac{\\Delta t}{\\Delta \\zeta^2}\\frac{\\chi}{2}.$$\n通过将已知边界值移到右侧，狄利克雷边界条件被引入到第一个和最后一个内部点的方程中：\n$$(1 + 2r)\\,u_1^{n+1} - r\\,u_0^{n+1} - r\\,u_2^{n+1} = u_1^n + \\Delta t\\,S_u^n \\quad\\Rightarrow\\quad (1 + 2r)\\,u_1^{n+1} - r\\,u_2^{n+1} = u_1^n + \\Delta t\\,S_u^n + r\\,u_{\\text{left}},$$\n$$(1 + 2r)\\,u_{M}^{n+1} - r\\,u_{M-1}^{n+1} - r\\,u_{M+1}^{n+1} = u_{M}^n + \\Delta t\\,S_u^n \\quad\\Rightarrow\\quad (1 + 2r)\\,u_{M}^{n+1} - r\\,u_{M-1}^{n+1} = u_{M}^n + \\Delta t\\,S_u^n + r\\,u_{\\text{right}},$$\n其中$M = N-2$是最后一个内部点的索引，$u_{\\text{left}}$和$u_{\\text{right}}$分别是$\\zeta=0$和$\\zeta=1$处的狄利克雷边界值，且$u_0^{n+1} = u_{\\text{left}}$，$u_{N-1}^{n+1} = u_{\\text{right}}$。\n\n这为每个时间步中的每个场$u \\in \\{Y_F, Y_O, Y_P, T\\}$产生一个三对角线性系统：\n$$\n\\begin{bmatrix}\n1+2r  -r  0  \\cdots  0 \\\\\n-r  1+2r  -r  \\cdots  0 \\\\\n0  -r  1+2r  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  -r \\\\\n0  0  0  -r  1+2r\n\\end{bmatrix}\n\\begin{bmatrix}\nu_1^{n+1} \\\\ u_2^{n+1} \\\\ u_3^{n+1} \\\\ \\vdots \\\\ u_{M}^{n+1}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nu_1^n + \\Delta t\\,S_{u,1}^n + r\\,u_{\\text{left}} \\\\\nu_2^n + \\Delta t\\,S_{u,2}^n \\\\\nu_3^n + \\Delta t\\,S_{u,3}^n \\\\\n\\vdots \\\\\nu_{M}^n + \\Delta t\\,S_{u,M}^n + r\\,u_{\\text{right}}\n\\end{bmatrix}.\n$$\n因为在给定用例中（固定的$\\chi$, $\\Delta t$, $\\Delta \\zeta$），系数矩阵不发生变化，所以用于求解三对角系统的标准Thomas算法是高效且稳定的。\n\n反应源项在时间层$n$使用以下公式显式计算\n$$\\omega_j^n = k_0 \\exp\\!\\left(-\\frac{\\Theta}{T_j^n}\\right) Y_{F,j}^n Y_{O,j}^n,$$\n各场的源项为\n$$S_{Y_F,j}^n = - \\omega_j^n,\\quad S_{Y_O,j}^n = - \\omega_j^n,\\quad S_{Y_P,j}^n = + \\omega_j^n,\\quad S_{T,j}^n = H\\, \\omega_j^n.$$\n在求解了扩散隐式更新之后，精确地施加狄利克雷边界条件：\n$$Y_F^{n+1}(0) = Y_{F,0},\\quad Y_F^{n+1}(1) = 0,\\quad Y_O^{n+1}(0) = 0,\\quad Y_O^{n+1}(1) = Y_{O,1},$$\n$$Y_P^{n+1}(0) = 0,\\quad Y_P^{n+1}(1) = 0,\\quad T^{n+1}(0) = T_0,\\quad T^{n+1}(1) = T_1.$$\n将质量分数裁剪到物理允许范围内，以避免因显式反应更新而产生的微小负值：\n$$Y_F^{n+1} \\leftarrow \\max(Y_F^{n+1}, 0),\\quad Y_O^{n+1} \\leftarrow \\max(Y_O^{n+1}, 0),\\quad Y_P^{n+1} \\leftarrow \\max(Y_P^{n+1}, 0).$$\n\n通过监测内部点上每个时间步的最大绝对变化来评估是否收敛到稳态：\n$$\\Delta_Y^n = \\max\\left\\{ \\lVert Y_F^{n+1}-Y_F^n \\rVert_\\infty,\\, \\lVert Y_O^{n+1}-Y_O^n \\rVert_\\infty,\\, \\lVert Y_P^{n+1}-Y_P^n \\rVert_\\infty \\right\\},$$\n$$\\Delta_T^n = \\lVert T^{n+1}-T^n \\rVert_\\infty.$$\n当$\\Delta_Y^n  10^{-8}$且$\\Delta_T^n  10^{-6}$时，或迭代次数达到规定的最大值时，停止计算。\n\n在每个测试用例的$\\chi$值下达到稳态后，计算所要求的输出：\n- 最高温度$T_{\\max}$是\n$$T_{\\max} = \\max_j T_j,$$\n及其位置（由网格点近似的连续坐标）是\n$$\\zeta_{\\max T} = \\zeta_{\\arg\\max_j T_j}.$$\n- 产物质量分数在整个域上的积分使用梯形法则计算\n$$I_P = \\int_0^1 Y_P(\\zeta)\\,d\\zeta \\approx \\sum_{j=0}^{N-2} \\frac{Y_{P,j} + Y_{P,j+1}}{2} \\,\\Delta \\zeta.$$\n\n最后，按指定顺序汇总三个测试用例的结果。所有温度单位均为开尔文，标量耗散率单位为秒的倒数，质量分数无量纲。程序按指令要求，将九个数字精确地按\n$$[T_{\\max}^{(1)}, \\zeta_{\\max T}^{(1)}, I_P^{(1)}, T_{\\max}^{(2)}, \\zeta_{\\max T}^{(2)}, I_P^{(2)}, T_{\\max}^{(3)}, \\zeta_{\\max T}^{(3)}, I_P^{(3)}],$$\n顺序打印在单行上，并四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef thomas_algorithm(lower, diag, upper, rhs):\n    \"\"\"\n    Solve a tridiagonal system Ax = rhs where A has 'lower' subdiagonal,\n    'diag' main diagonal, and 'upper' superdiagonal using the Thomas algorithm.\n    All arrays are 1D; lengths: len(diag)=n, len(lower)=n-1, len(upper)=n-1.\n    \"\"\"\n    n = len(diag)\n    # Copy to avoid modifying inputs\n    c_prime = np.empty(n-1, dtype=float)\n    d_prime = np.empty(n, dtype=float)\n\n    # Forward sweep\n    c_prime[0] = upper[0] / diag[0]\n    d_prime[0] = rhs[0] / diag[0]\n    for i in range(1, n-1):\n        denom = diag[i] - lower[i-1] * c_prime[i-1]\n        c_prime[i] = upper[i] / denom\n        d_prime[i] = (rhs[i] - lower[i-1] * d_prime[i-1]) / denom\n    denom_last = diag[n-1] - lower[n-2] * c_prime[n-2]\n    d_prime[n-1] = (rhs[n-1] - lower[n-2] * d_prime[n-2]) / denom_last\n\n    # Back substitution\n    x = np.empty(n, dtype=float)\n    x[n-1] = d_prime[n-1]\n    for i in range(n-2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i+1]\n    return x\n\ndef run_case(chi, N=128, dt=0.002, max_steps=6000,\n             YF_left=0.8, YO_right=0.21, T_left=300.0, T_right=300.0,\n             Theta=2000.0, k0=500.0, H=1500.0,\n             tol_species=1e-8, tol_temp=1e-6):\n    \"\"\"\n    Integrate the unsteady flamelet equations to steady state for a given chi.\n    Returns Tmax (K), zeta_at_Tmax, integral of YP over domain.\n    \"\"\"\n    # Grid\n    zeta = np.linspace(0.0, 1.0, N)\n    dz = zeta[1] - zeta[0]\n    # Initial conditions: non-reacting mixing\n    YF = YF_left * (1.0 - zeta)\n    YO = YO_right * zeta\n    YP = np.zeros_like(zeta)\n    T = np.full_like(zeta, T_left)\n\n    # Dirichlet boundary values\n    YF_bL, YF_bR = YF_left, 0.0\n    YO_bL, YO_bR = 0.0, YO_right\n    YP_bL, YP_bR = 0.0, 0.0\n    T_bL, T_bR = T_left, T_right\n\n    # Precompute tridiagonal coefficients for implicit diffusion\n    r = dt * (chi / 2.0) / (dz * dz)\n    M = N - 2  # number of interior points\n    if M = 0:\n        raise ValueError(\"Grid must have at least 3 points.\")\n    lower = np.full(M-1, -r, dtype=float)\n    upper = np.full(M-1, -r, dtype=float)\n    diag = np.full(M, 1.0 + 2.0 * r, dtype=float)\n\n    # Time integration loop\n    for step in range(max_steps):\n        # Compute reaction rate omega (explicit) using current fields\n        # Prevent division by zero or overflow in exp by clipping temperature\n        T_eff = np.clip(T, 1e-6, 1e6)\n        omega = k0 * np.exp(-Theta / T_eff) * YF * YO\n\n        # Prepare RHS for each field (interior points only)\n        # Index mapping: interior j corresponds to full index i = j+1\n        # YF\n        rhs_YF = YF[1:-1] + dt * (-omega[1:-1])\n        rhs_YF[0] += r * YF_bL\n        rhs_YF[-1] += r * YF_bR\n        # YO\n        rhs_YO = YO[1:-1] + dt * (-omega[1:-1])\n        rhs_YO[0] += r * YO_bL\n        rhs_YO[-1] += r * YO_bR\n        # YP\n        rhs_YP = YP[1:-1] + dt * (+omega[1:-1])\n        rhs_YP[0] += r * YP_bL\n        rhs_YP[-1] += r * YP_bR\n        # T\n        rhs_T = T[1:-1] + dt * (H * omega[1:-1])\n        rhs_T[0] += r * T_bL\n        rhs_T[-1] += r * T_bR\n\n        # Solve tridiagonal systems\n        YF_new_interior = thomas_algorithm(lower, diag, upper, rhs_YF)\n        YO_new_interior = thomas_algorithm(lower, diag, upper, rhs_YO)\n        YP_new_interior = thomas_algorithm(lower, diag, upper, rhs_YP)\n        T_new_interior = thomas_algorithm(lower, diag, upper, rhs_T)\n\n        # Assemble full fields and enforce boundaries\n        YF_new = np.empty_like(YF)\n        YO_new = np.empty_like(YO)\n        YP_new = np.empty_like(YP)\n        T_new = np.empty_like(T)\n\n        YF_new[0] = YF_bL\n        YF_new[-1] = YF_bR\n        YF_new[1:-1] = YF_new_interior\n\n        YO_new[0] = YO_bL\n        YO_new[-1] = YO_bR\n        YO_new[1:-1] = YO_new_interior\n\n        YP_new[0] = YP_bL\n        YP_new[-1] = YP_bR\n        YP_new[1:-1] = YP_new_interior\n\n        T_new[0] = T_bL\n        T_new[-1] = T_bR\n        T_new[1:-1] = T_new_interior\n\n        # Clip mass fractions to [0, 1] for numerical sanity\n        YF_new = np.clip(YF_new, 0.0, 1.0)\n        YO_new = np.clip(YO_new, 0.0, 1.0)\n        YP_new = np.clip(YP_new, 0.0, 1.0)\n\n        # Check convergence\n        delta_species = max(\n            np.max(np.abs(YF_new - YF)),\n            np.max(np.abs(YO_new - YO)),\n            np.max(np.abs(YP_new - YP))\n        )\n        delta_temp = np.max(np.abs(T_new - T))\n        # Update fields\n        YF, YO, YP, T = YF_new, YO_new, YP_new, T_new\n\n        if delta_species  tol_species and delta_temp  tol_temp:\n            break\n\n    # Compute requested outputs\n    Tmax = float(np.max(T))\n    idx_max = int(np.argmax(T))\n    zeta_at_Tmax = float(zeta[idx_max])\n    IP = float(np.trapz(YP, zeta))\n\n    # Round as specified\n    Tmax = round(Tmax, 3)\n    zeta_at_Tmax = round(zeta_at_Tmax, 3)\n    IP = round(IP, 3)\n\n    return Tmax, zeta_at_Tmax, IP\n\ndef solve():\n    # Define the test cases from the problem statement (chi values in s^-1).\n    test_cases = [\n        0.5,   # Case 1: low dissipation\n        10.0,  # Case 2: moderate dissipation\n        80.0   # Case 3: high dissipation\n    ]\n\n    results = []\n    for chi in test_cases:\n        Tmax, zeta_max, IP = run_case(chi=chi)\n        results.extend([Tmax, zeta_max, IP])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "为了构建一个更鲁棒且通用的求解器，我们将从半隐式方法进阶到全隐式方法 。这个练习将指导您为一个预混火焰实现一个基于牛顿法的求解器，该求解器与用于处理刚性问题的二阶向后差分公式（BDF2）时间积分器相结合。这种全耦合方法能够同时隐式处理扩散项和高度非线性的反应项，从而允许使用更大的时间步长，是解决复杂燃烧问题的强大工具。",
            "id": "4073125",
            "problem": "考虑一个一维稳态预混火焰，该火焰通过伪时间方法建模，将耦合的组分-温度系统推进至稳态。设 $x \\in [0,L]$ 表示空间坐标，令 $Y(x,\\tau)$ 为燃料质量分数，$T(x,\\tau)$ 为温度，其中 $\\tau$ 是用于稳态收敛的人工时间。假设密度恒定、输运系数恒定、刘易斯数为1，以及单步阿伦尼乌斯反应速率。控制伪时间演化方程为\n$$\n\\frac{\\partial Y}{\\partial \\tau} \\;=\\; D \\frac{\\partial^2 Y}{\\partial x^2} \\;-\\; \\omega(Y,T), \\qquad \\frac{\\partial T}{\\partial \\tau} \\;=\\; \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\;+\\; \\frac{q}{c_p}\\,\\omega(Y,T),\n$$\n其中反应速率为\n$$\n\\omega(Y,T) \\;=\\; A \\exp\\!\\left(-\\frac{E}{T}\\right) Y,\n$$\n此处 $D$ 是组分质量扩散系数，$\\alpha$ 是热扩散系数，$q$ 是单位质量热释放，$c_p$ 是定压比热，$A$ 是指前因子，$E$ 是活化温度参数。施加边界条件\n$$\nY(0,\\tau) \\;=\\; Y_u, \\quad T(0,\\tau) \\;=\\; T_u, \\quad \\left.\\frac{\\partial Y}{\\partial x}\\right|_{x=L} \\;=\\; 0, \\quad \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} \\;=\\; 0,\n$$\n并使用 $Y(x,0) = Y_u$，$T(x,0)=T_u$ 对所有 $x \\in [0,L]$ 进行初始化。\n\n使用二阶向后差分格式（BDF2），对于人工时间步长 $\\Delta \\tau$，从时间层 $n-1$ 和 $n$ 到 $n+1$ 的通用标量场 $U \\in \\{Y,T\\}$ 的全隐式更新定义为\n$$\n\\frac{3 U^{n+1} - 4 U^{n} + U^{n-1}}{2 \\Delta \\tau} \\;=\\; \\mathcal{R}_U\\!\\left(U^{n+1}\\right),\n$$\n其中 $\\mathcal{R}_Y(Y^{n+1},T^{n+1}) = D\\,\\partial_{xx} Y^{n+1} - \\omega(Y^{n+1},T^{n+1})$ 和 $\\mathcal{R}_T(Y^{n+1},T^{n+1}) = \\alpha\\,\\partial_{xx} T^{n+1} + \\frac{q}{c_p}\\omega(Y^{n+1},T^{n+1})$ 表示在新时间层上计算的稳态残差算子。这导致了一个关于 $Y^{n+1}$ 和 $T^{n+1}$ 的非线性耦合系统，必须在每个 BDF2 步中求解。第一个时间步必须使用向后欧拉法来为 BDF2 提供初始值，即\n$$\n\\frac{U^{1} - U^0}{\\Delta \\tau} \\;=\\; \\mathcal{R}_U\\!\\left(U^{1}\\right).\n$$\n\n用一个包含 $N$ 个点的均匀网格离散化空间域 $[0,L]$，网格间距为 $h = L/(N-1)$，并使用二阶中心差分计算拉普拉斯算子。通过代数约束 $Y_0=Y_u$，$T_0=T_u$ 施加左侧的狄利克雷边界条件，并用单边约束 $Y_{N-1} = Y_{N-2}$ 和 $T_{N-1} = T_{N-2}$ 近似右侧的诺伊曼边界条件。为交错的未知数向量 $\\mathbf{U}^{n+1} = [Y_0^{n+1},T_0^{n+1},Y_1^{n+1},T_1^{n+1},\\ldots,Y_{N-1}^{n+1},T_{N-1}^{n+1}]^\\top$ 构建非线性系统。在每个时间步，通过构建残差向量 $\\mathbf{F}(\\mathbf{U}^{n+1})$ 和雅可比矩阵 $\\mathbf{J} = \\partial \\mathbf{F}/\\partial \\mathbf{U}^{n+1}$，使用牛顿法求解该非线性系统。在内部区域，网格索引为 $i$ 处的耦合组分-温度残差应从 BDF2 公式和离散化的残差算子中导出。在边界处，将代数约束作为残差，并设置适当的雅可比矩阵项来强制执行。\n\n从基本守恒陈述和向后差分格式（BDF）的定义出发，推导 $Y$ 和 $T$ 的耦合离散 BDF2 更新方程，以及相应的牛顿残差和雅可比矩阵块。明确符号约定以及扩散和反应耦合的贡献。然后实现一个求解器，该求解器：\n- 使用一个向后欧拉步和随后的 BDF2 步在人工时间内推进。\n- 在每一步中，使用牛顿法，并通过利用雅可比矩阵的带状块结构进行稀疏线性求解。\n- 当稳态残差 $\\mathcal{R}_Y$ 和 $\\mathcal{R}_T$ 的无穷范数在新时间层上降至给定容差以下时，检测接近稳态，若达到则提前终止。\n\n必须使用并指定以下物理单位：$L$ 单位为米 (m)，$D$ 和 $\\alpha$ 单位为平方米/秒 ($\\mathrm{m}^2/\\mathrm{s}$)，$q$ 单位为焦耳/千克 ($\\mathrm{J}/\\mathrm{kg}$)，$c_p$ 单位为焦耳/(千克·开尔文) ($\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$)，$A$ 单位为 1/秒 ($\\mathrm{s}^{-1}$)，$E$ 单位为开尔文 (K)，$Y$ 无量纲，$T$ 单位为开尔文 (K)，$\\Delta \\tau$ 单位为秒 (s)。最终输出以开尔文 (K) 表示。本问题不涉及角度。没有百分比。\n\n测试套件和输出规范：\n使用以下包含三个参数集的测试套件，分别探讨理想情况、刚度增加情况和粗网格边界情况。对于每种情况，运行至指定的最大时间步数或提前达到稳态收敛，以先到者为准。对于每种情况，报告最终右边界温度 $T_{N-1}$，单位为开尔文 (K)，四舍五入到三位小数。\n\n- 情况 $1$ (理想情况): $L=0.01 \\, \\mathrm{m}$, $N=40$, $D=1.0\\times 10^{-5} \\, \\mathrm{m}^2/\\mathrm{s}$, $\\alpha=1.0\\times 10^{-5} \\, \\mathrm{m}^2/\\mathrm{s}$, $A=2.0\\times 10^{6} \\, \\mathrm{s}^{-1}$, $E=8.0\\times 10^{4} \\, \\mathrm{K}$, $q=1.5\\times 10^{7} \\, \\mathrm{J}/\\mathrm{kg}$, $c_p=1.0\\times 10^{3} \\, \\mathrm{J}/(\\mathrm{kg}\\cdot \\mathrm{K})$, $Y_u=0.06$, $T_u=300.0 \\, \\mathrm{K}$, $\\Delta \\tau=1.0\\times 10^{-5} \\, \\mathrm{s}$, 最大步数 $12$。\n- 情况 $2$ (刚度增加): $L=0.01 \\, \\mathrm{m}$, $N=30$, $D=8.0\\times 10^{-6} \\, \\mathrm{m}^2/\\mathrm{s}$, $\\alpha=8.0\\times 10^{-6} \\, \\mathrm{m}^2/\\mathrm{s}$, $A=5.0\\times 10^{6} \\, \\mathrm{s}^{-1}$, $E=1.2\\times 10^{5} \\, \\mathrm{K}$, $q=1.5\\times 10^{7} \\, \\mathrm{J}/\\mathrm{kg}$, $c_p=1.0\\times 10^{3} \\, \\mathrm{J}/(\\mathrm{kg}\\cdot \\mathrm{K})$, $Y_u=0.06$, $T_u=300.0 \\, \\mathrm{K}$, $\\Delta \\tau=5.0\\times 10^{-6} \\, \\mathrm{s}$, 最大步数 $14$。\n- 情况 $3$ (粗网格): $L=0.005 \\, \\mathrm{m}$, $N=20$, $D=1.2\\times 10^{-5} \\, \\mathrm{m}^2/\\mathrm{s}$, $\\alpha=1.2\\times 10^{-5} \\, \\mathrm{m}^2/\\mathrm{s}$, $A=1.0\\times 10^{6} \\, \\mathrm{s}^{-1}$, $E=7.0\\times 10^{4} \\, \\mathrm{K}$, $q=1.2\\times 10^{7} \\, \\mathrm{J}/\\mathrm{kg}$, $c_p=1.0\\times 10^{3} \\, \\mathrm{J}/(\\mathrm{kg}\\cdot \\mathrm{K})$, $Y_u=0.05$, $T_u=300.0 \\, \\mathrm{K}$, $\\Delta \\tau=2.0\\times 10^{-5} \\, \\mathrm{s}$, 最大步数 $10$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个条目是对应测试用例的最终右边界温度，单位为开尔文 (K)，四舍五入到三位小数（例如，\"[1234.567,890.123,456.789]\"）。",
            "solution": "该问题是有效的。它提出了一个针对一维预混火焰的适定的、有科学依据的模型，该模型将使用一种标准的、适当的数值方法（伪时间推进法，结合隐式 BDF2/牛顿求解器）来求解。所有参数、方程和边界条件都已明确定义，构成了一个在计算燃烧学中独立且可数值求解的问题。\n\n在此，我们推导牛顿求解器所需的离散非线性系统及其对应的雅可比矩阵。\n\n### 1. 控制方程和离散化\n\n燃料质量分数 $Y(x,\\tau)$ 和温度 $T(x,\\tau)$ 的控制偏微分方程为：\n$$\n\\frac{\\partial Y}{\\partial \\tau} \\;=\\; D \\frac{\\partial^2 Y}{\\partial x^2} \\;-\\; \\omega(Y,T) \\quad \\text{(组分)}\n$$\n$$\n\\frac{\\partial T}{\\partial \\tau} \\;=\\; \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\;+\\; \\frac{q}{c_p}\\,\\omega(Y,T) \\quad \\text{(能量)}\n$$\n反应速率由阿伦尼乌斯定律给出 $\\omega(Y,T) = A \\exp(-E/T) Y$。\n\n空间域 $x \\in [0,L]$ 使用一个包含 $N$ 个点 $x_i = i h$（其中 $i \\in \\{0, 1, \\dots, N-1\\}$）的均匀网格进行离散化，网格间距为 $h = L/(N-1)$。这些网格点上的解表示为 $Y_i(\\tau)$ 和 $T_i(\\tau)$。对于内部网格点 $i \\in \\{1, \\dots, N-2\\}$，通用场 $U_i$ 的二阶空间导数（拉普拉斯算子）使用二阶中心差分格式来近似：\n$$\n\\left.\\frac{\\partial^2 U}{\\partial x^2}\\right|_{x_i} \\approx \\frac{U_{i+1} - 2U_i + U_{i-1}}{h^2}\n$$\n\n### 2. 时间离散化和残差公式\n\n我们通过在伪时间 $\\tau$ 中推进来寻求稳态解。时间层 $\\tau_n = n \\Delta\\tau$ 处的解表示为 $U^n$。我们的目标是求解下一个时间层 $U^{n+1}$ 的解。该问题要求使用全隐式格式，这导致在每个时间步都需求解一个非线性方程组。我们定义非线性残差向量 $\\mathbf{F}(\\mathbf{U}^{n+1})$，使得在解处 $\\mathbf{F}(\\mathbf{U}^{n+1}) = \\mathbf{0}$。状态向量 $\\mathbf{U}$ 是一个交错的未知数数组：$\\mathbf{U} = [Y_0, T_0, Y_1, T_1, \\dots, Y_{N-1}, T_{N-1}]^\\top$。\n\n#### 2.1. 第一个时间步：向后欧拉法 (BE)\n对于第一步（从 $n=0$ 到 $n=1$），使用向后欧拉法：\n$$\n\\frac{U^{1} - U^{0}}{\\Delta \\tau} \\;=\\; \\mathcal{R}_U(U^{1})\n$$\n其中 $\\mathcal{R}_U$ 是稳态残差算子。对于内部网格点 $i \\in \\{1, \\dots, N-2\\}$，$Y_i^1$ 和 $T_i^1$ 的离散残差方程为：\n$$\nF_{2i} = \\frac{Y_i^1 - Y_i^0}{\\Delta\\tau} - \\left( D \\frac{Y_{i+1}^1 - 2Y_i^1 + Y_{i-1}^1}{h^2} - \\omega(Y_i^1, T_i^1) \\right) = 0\n$$\n$$\nF_{2i+1} = \\frac{T_i^1 - T_i^0}{\\Delta\\tau} - \\left( \\alpha \\frac{T_{i+1}^1 - 2T_i^1 + T_{i-1}^1}{h^2} + \\frac{q}{c_p}\\omega(Y_i^1, T_i^1) \\right) = 0\n$$\n\n#### 2.2. 后续步骤：BDF2\n对于所有后续步骤 ($n \\ge 1$)，使用二阶向后差分格式 (BDF2)：\n$$\n\\frac{3 U^{n+1} - 4 U^{n} + U^{n-1}}{2 \\Delta \\tau} \\;=\\; \\mathcal{R}_U(U^{n+1})\n$$\n对于内部点 $i$，相应的离散残差方程为：\n$$\nF_{2i} = \\frac{3Y_i^{n+1} - 4Y_i^n + Y_i^{n-1}}{2\\Delta\\tau} - \\left( D \\frac{Y_{i+1}^{n+1} - 2Y_i^{n+1} + Y_{i-1}^{n+1}}{h^2} - \\omega(Y_i^{n+1}, T_i^{n+1}) \\right) = 0\n$$\n$$\nF_{2i+1} = \\frac{3T_i^{n+1} - 4T_i^n + T_i^{n-1}}{2\\Delta\\tau} - \\left( \\alpha \\frac{T_{i+1}^{n+1} - 2T_i^{n+1} + T_{i-1}^{n+1}}{h^2} + \\frac{q}{c_p}\\omega(Y_i^{n+1}, T_i^{n+1}) \\right) = 0\n$$\n\n### 3. 边界条件残差\n\n边界条件在残差向量 $\\mathbf{F}$ 中作为代数约束来强制执行。\n\n- **左边界 ($i=0$, 狄利克雷):** $Y_0 = Y_u$, $T_0 = T_u$.\n  $$ F_0 = Y_0^{n+1} - Y_u = 0 $$\n  $$ F_1 = T_0^{n+1} - T_u = 0 $$\n- **右边界 ($i=N-1$, 诺伊曼):** $\\partial Y/\\partial x = 0$, $\\partial T/\\partial x = 0$，用一阶单边差分近似：$Y_{N-1} = Y_{N-2}$, $T_{N-1} = T_{N-2}$。\n  $$ F_{2(N-1)} = Y_{N-1}^{n+1} - Y_{N-2}^{n+1} = 0 $$\n  $$ F_{2(N-1)+1} = T_{N-1}^{n+1} - T_{N-2}^{n+1} = 0 $$\n\n### 4. 牛顿法和雅可比矩阵\n\n非线性系统 $\\mathbf{F}(\\mathbf{U}^{n+1}) = \\mathbf{0}$ 使用牛顿法求解。从一个猜测值 $\\mathbf{U}_k$（通常是前一时间步的解 $\\mathbf{U}^n$）开始，我们迭代：\n$$\n\\mathbf{J}(\\mathbf{U}_k) \\Delta \\mathbf{U}_k = -\\mathbf{F}(\\mathbf{U}_k)\n$$\n$$\n\\mathbf{U}_{k+1} = \\mathbf{U}_k + \\Delta \\mathbf{U}_k\n$$\n其中 $\\mathbf{J} = \\partial \\mathbf{F}/\\partial \\mathbf{U}$ 是雅可比矩阵。我们现在推导 $\\mathbf{J}$ 的各项。为清晰起见，我们省略未知变量的上标 $n+1$ 和牛顿迭代索引 $k$。令 $\\beta_1 = 1/\\Delta\\tau$ 为 BE 系数，$\\beta_2 = 3/(2\\Delta\\tau)$ 为 BDF2 系数。令 $\\beta$ 为当前步骤的有效系数。\n\n反应速率的导数为：\n$$\n\\frac{\\partial \\omega}{\\partial Y_i} = A \\exp(-E/T_i)\n$$\n$$\n\\frac{\\partial \\omega}{\\partial T_i} = A \\exp(-E/T_i) Y_i \\left(\\frac{E}{T_i^2}\\right) = \\omega(Y_i, T_i) \\frac{E}{T_i^2}\n$$\n\n雅可比矩阵 $\\mathbf{J}$ 是一个稀疏的块状带状矩阵。对于内部点 $i$，关于 $F_{2i}$ 和 $F_{2i+1}$ 的行的非零项源于对节点 $i-1$、$i$ 和 $i+1$ 处变量的依赖。这为内部区域形成了一个块三对角结构。\n\n- **关于 $(Y_i, T_i)$ 的导数 (对角块):**\n  $$ \\frac{\\partial F_{2i}}{\\partial Y_i} = \\beta + \\frac{2D}{h^2} + \\frac{\\partial \\omega}{\\partial Y_i}, \\quad \\frac{\\partial F_{2i}}{\\partial T_i} = \\frac{\\partial \\omega}{\\partial T_i} $$\n  $$ \\frac{\\partial F_{2i+1}}{\\partial Y_i} = -\\frac{q}{c_p} \\frac{\\partial \\omega}{\\partial Y_i}, \\quad \\frac{\\partial F_{2i+1}}{\\partial T_i} = \\beta + \\frac{2\\alpha}{h^2} - \\frac{q}{c_p} \\frac{\\partial \\omega}{\\partial T_i} $$\n\n- **关于 $(Y_{i-1}, T_{i-1})$ 的导数 (下对角块):**\n  $$ \\frac{\\partial F_{2i}}{\\partial Y_{i-1}} = -\\frac{D}{h^2}, \\quad \\frac{\\partial F_{2i+1}}{\\partial T_{i-1}} = -\\frac{\\alpha}{h^2} $$\n  所有其他关于 $i-1$ 处变量的导数均为零。\n\n- **关于 $(Y_{i+1}, T_{i+1})$ 的导数 (上对角块):**\n  $$ \\frac{\\partial F_{2i}}{\\partial Y_{i+1}} = -\\frac{D}{h^2}, \\quad \\frac{\\partial F_{2i+1}}{\\partial T_{i+1}} = -\\frac{\\alpha}{h^2} $$\n  所有其他关于 $i+1$ 处变量的导数均为零。\n\n雅可比矩阵的边界行由简单的代数约束确定：\n- **关于 $F_0=Y_0-Y_u$ 的行:** $\\partial F_0 / \\partial Y_0 = 1$。所有其他项为 $0$。\n- **关于 $F_1=T_0-T_u$ 的行:** $\\partial F_1 / \\partial T_0 = 1$。所有其他项为 $0$。\n- **关于 $F_{2(N-1)}=Y_{N-1}-Y_{N-2}$ 的行:** $\\partial F_{2(N-1)}/\\partial Y_{N-1} = 1$, $\\partial F_{2(N-1)}/\\partial Y_{N-2} = -1$。\n- **关于 $F_{2(N-1)+1}=T_{N-1}-T_{N-2}$ 的行:** $\\partial F_{2(N-1)+1}/\\partial T_{N-1} = 1$, $\\partial F_{2(N-1)+1}/\\partial T_{N-2} = -1$。\n\n这完成了对非线性系统及其雅可比矩阵的规范，可以在每个时间步使用稀疏矩阵库进行实现和求解，直到达到稳态条件。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases.\n    \"\"\"\n    test_cases = [\n        (0.01, 40, 1.0e-5, 1.0e-5, 2.0e6, 8.0e4, 1.5e7, 1.0e3, 0.06, 300.0, 1.0e-5, 12),\n        (0.01, 30, 8.0e-6, 8.0e-6, 5.0e6, 1.2e5, 1.5e7, 1.0e3, 0.06, 300.0, 5.0e-6, 14),\n        (0.005, 20, 1.2e-5, 1.2e-5, 1.0e6, 7.0e4, 1.2e7, 1.0e3, 0.05, 300.0, 2.0e-5, 10),\n    ]\n\n    results = []\n    for case in test_cases:\n        T_end = solve_case(case)\n        results.append(f\"{T_end:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(params):\n    \"\"\"\n    Solves a single case of the 1D flame problem.\n    \"\"\"\n    L, N, D, alpha, A, E, q, cp, Yu, Tu, dt, max_steps = params\n\n    # Numerical parameters\n    STEADY_TOL = 1.0\n    NEWTON_TOL = 1e-8\n    MAX_NEWTON_ITER = 20\n    \n    h = L / (N - 1)\n    \n    # State vector U = [Y_0, T_0, Y_1, T_1, ..., Y_{N-1}, T_{N-1}]\n    # Initial conditions\n    U = np.zeros(2 * N)\n    for i in range(N):\n        U[2 * i] = Yu\n        U[2 * i + 1] = Tu\n    \n    U_prev = U.copy() # For BDF2, U^{n-1}\n\n    # Time-marching loop\n    for n in range(max_steps):\n        is_bdf2 = n > 0\n        U_guess = U.copy()\n\n        # Newton's method loop\n        for k in range(MAX_NEWTON_ITER):\n            F = np.zeros(2 * N)\n            J = lil_matrix((2 * N, 2 * N), dtype=np.float64)\n\n            # BDF/BE coefficient\n            beta = 3.0 / (2.0 * dt) if is_bdf2 else 1.0 / dt\n\n            # Left boundary (i=0): Dirichlet\n            F[0] = U_guess[0] - Yu\n            J[0, 0] = 1.0\n            F[1] = U_guess[1] - Tu\n            J[1, 1] = 1.0\n\n            # Interior points (i=1 to N-2)\n            for i in range(1, N - 1):\n                # Indices for variables and residuals\n                y_idx, t_idx = 2 * i, 2 * i + 1\n                y_im1_idx, t_im1_idx = 2 * (i - 1), 2 * (i - 1) + 1\n                y_ip1_idx, t_ip1_idx = 2 * (i + 1), 2 * (i + 1) + 1\n\n                # Current state at node i\n                Y_i, T_i = U_guess[y_idx], U_guess[t_idx]\n                Y_im1, T_im1 = U_guess[y_im1_idx], U_guess[t_im1_idx]\n                Y_ip1, T_ip1 = U_guess[y_ip1_idx], U_guess[t_ip1_idx]\n\n                # Reaction term and its derivatives\n                if T_i = 0:\n                    omega, omega_dY, omega_dT = 0.0, 0.0, 0.0\n                else:\n                    exp_term = np.exp(-E / T_i)\n                    omega = A * exp_term * Y_i\n                    omega_dY = A * exp_term\n                    omega_dT = omega * E / (T_i**2)\n                \n                # Diffusion terms\n                diff_Y = D * (Y_ip1 - 2 * Y_i + Y_im1) / h**2\n                diff_T = alpha * (T_ip1 - 2 * T_i + T_im1) / h**2\n\n                # Residuals\n                if is_bdf2:\n                    history_Y = (4 * U[y_idx] - U_prev[y_idx]) / (2 * dt)\n                    history_T = (4 * U[t_idx] - U_prev[t_idx]) / (2 * dt)\n                else: # BE\n                    history_Y = U[y_idx] / dt\n                    history_T = U[t_idx] / dt\n                \n                F[y_idx] = beta * Y_i - history_Y - diff_Y + omega\n                F[t_idx] = beta * T_i - history_T - diff_T - (q / cp) * omega\n                \n                # Jacobian entries for interior point i\n                # Diagonal block (derivatives w.r.t Y_i, T_i)\n                J[y_idx, y_idx] = beta + 2 * D / h**2 + omega_dY\n                J[y_idx, t_idx] = omega_dT\n                J[t_idx, y_idx] = -(q / cp) * omega_dY\n                J[t_idx, t_idx] = beta + 2 * alpha / h**2 - (q / cp) * omega_dT\n                # Off-diagonal blocks\n                J[y_idx, y_im1_idx] = -D / h**2\n                J[t_idx, t_im1_idx] = -alpha / h**2\n                J[y_idx, y_ip1_idx] = -D / h**2\n                J[t_idx, t_ip1_idx] = -alpha / h**2\n\n            # Right boundary (i=N-1): Neumann\n            y_idx, t_idx = 2 * (N - 1), 2 * (N - 1) + 1\n            y_im1_idx, t_im1_idx = 2 * (N-2), 2 * (N-2) + 1\n            F[y_idx] = U_guess[y_idx] - U_guess[y_im1_idx]\n            J[y_idx, y_idx] = 1.0\n            J[y_idx, y_im1_idx] = -1.0\n            F[t_idx] = U_guess[t_idx] - U_guess[t_im1_idx]\n            J[t_idx, t_idx] = 1.0\n            J[t_idx, t_im1_idx] = -1.0\n            \n            # Solve linear system and update\n            delta_U = spsolve(J.tocsc(), -F)\n            U_guess += delta_U\n            \n            if np.linalg.norm(delta_U)  NEWTON_TOL:\n                break\n        \n        # Update time levels\n        U_prev, U = U, U_guess\n        \n        # Check for steady-state convergence\n        steady_res = []\n        for i in range(1, N - 1):\n            Y_i, T_i = U[2*i], U[2*i+1]\n            Y_im1, Y_ip1 = U[2*(i-1)], U[2*(i+1)]\n            T_im1, T_ip1 = U[2*(i-1)+1], U[2*(i+1)+1]\n            \n            omega = A * np.exp(-E / T_i) * Y_i if T_i > 0 else 0.0\n            \n            res_Y = D * (Y_ip1 - 2 * Y_i + Y_im1) / h**2 - omega\n            res_T = alpha * (T_ip1 - 2 * T_i + T_im1) / h**2 + (q / cp) * omega\n            steady_res.extend([abs(res_Y), abs(res_T)])\n        \n        if steady_res and max(steady_res)  STEADY_TOL:\n            break\n            \n    return U[2 * (N - 1) + 1]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}