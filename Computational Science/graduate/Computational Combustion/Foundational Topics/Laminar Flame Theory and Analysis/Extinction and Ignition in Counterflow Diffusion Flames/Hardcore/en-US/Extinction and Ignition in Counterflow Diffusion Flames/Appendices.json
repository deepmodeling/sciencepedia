{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of diffusion flames, we begin with an idealized yet powerful foundation: the Burke-Schumann model. This exercise strips the problem down to its essential physics by assuming infinitely fast chemistry, creating an infinitesimally thin \"flame sheet.\" This practice will guide you through the analytical derivation of temperature and species profiles as a function of the conserved scalar mixture fraction, $Z$, providing a clear illustration of how reactants mix and are consumed to produce a peak temperature at the stoichiometric location .",
            "id": "4024507",
            "problem": "Consider a steady, laminar counterflow diffusion flame between a pure methane fuel stream and a pure oxygen oxidizer stream in the Burke–Schumann (BS) limit of infinitely fast chemistry, with unity Lewis numbers and adiabatic, nonradiative conditions. Let the reaction be $\\text{CH}_4 + 2\\text{O}_2 \\to \\text{CO}_2 + 2\\text{H}_2\\text{O}$, and define the stoichiometric oxidizer-to-fuel mass ratio as $s$, so that $s = 4$ for these pure streams. The mixture fraction $Z$ is defined as the conserved scalar representing the mass fraction of material originating from the fuel stream, so $Z = 1$ on the fuel boundary and $Z = 0$ on the oxidizer boundary. Assume constant and equal mixture specific heat $c_p$ for all species and temperatures, and take $c_p$, the Lower Heating Value (LHV) of methane per unit mass of fuel $q$, and the stream temperatures $T_F$ and $T_O$ as given.\n\nStarting from the conservation of mass, species, and enthalpy under the BS model, and using the definition of the stoichiometric mixture fraction $Z_{\\mathrm{st}}$, perform the following:\n\n1. Derive the piecewise species mass fraction fields $Y_F(Z)$, $Y_O(Z)$, and $Y_P(Z)$ for fuel-limited ($Z  Z_{\\mathrm{st}}$) and oxidizer-limited ($Z  Z_{\\mathrm{st}}$) sides, where the inert “products” lump the post-reaction mixture ($\\text{CO}_2$ and $\\text{H}_2\\text{O}$) as a single aggregate.\n2. Enforce conservation of total enthalpy (sensible plus chemical) across the flame sheet to construct the piecewise temperature field $T(Z)$ in terms of $T_F$, $T_O$, $q$, $c_p$, $s$, and $Z$.\n3. Evaluate the adiabatic flame temperature at $Z = Z_{\\mathrm{st}}$.\n\nUse the following numerically specified parameters: $T_F = 300\\,\\mathrm{K}$, $T_O = 1000\\,\\mathrm{K}$, $c_p = 3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1}$, $q = 5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$, and $s = 4$. Express the final adiabatic flame temperature in Kelvin, and round your final numerical answer to four significant figures.",
            "solution": "The problem describes a steady, one-dimensional counterflow diffusion flame under the Burke–Schumann (BS) or infinite-rate chemistry approximation. Key assumptions include unity Lewis numbers for all species, constant and equal specific heats $c_p$, and adiabatic, nonradiative conditions. We are asked to derive the species and temperature fields as functions of the mixture fraction $Z$ and then calculate the adiabatic flame temperature.\n\nThe mixture fraction $Z$ is a conserved scalar that tracks the mass originating from the fuel stream. It is defined to be $Z=1$ in the pure fuel stream and $Z=0$ in the pure oxidizer stream. Under the given assumptions, any conserved scalar $\\psi$ (i.e., a quantity with no net source or sink term in its conservation equation) is a linear function of $Z$:\n$$ \\psi(Z) = \\psi(Z=0) + [\\psi(Z=1) - \\psi(Z=0)] Z $$\n\n**1. Derivation of Species Mass Fraction Fields**\n\nThe chemical reaction is given as $\\text{CH}_4 + 2\\text{O}_2 \\to \\text{CO}_2 + 2\\text{H}_2\\text{O}$. On a mass basis, this is $1\\,\\mathrm{kg}$ of fuel reacting with $s=4\\,\\mathrm{kg}$ of oxidizer to produce $(1+s)=5\\,\\mathrm{kg}$ of products. The species are fuel (F), oxidizer (O), and products (P).\n\nWe can construct a conserved scalar variable (a Shvab-Zeldovich variable) from the fuel and oxidizer mass fractions, $Y_F$ and $Y_O$:\n$$ \\beta = Y_O - s Y_F $$\nThe source term for $Y_F$ is $\\dot{\\omega}_F$ and for $Y_O$ is $s \\dot{\\omega}_F$, where $\\dot{\\omega}_F$ is the mass rate of consumption of fuel per unit volume. The source term for $\\beta$ is $s \\dot{\\omega}_F - s(\\dot{\\omega}_F) = 0$, so $\\beta$ is a conserved scalar.\n\nWe evaluate $\\beta$ at the boundaries:\n- At the oxidizer boundary ($Z=0$): $Y_O = 1$, $Y_F = 0$. Thus, $\\beta_0 = 1 - s(0) = 1$.\n- At the fuel boundary ($Z=1$): $Y_O = 0$, $Y_F = 1$. Thus, $\\beta_1 = 0 - s(1) = -s$.\n\nSince $\\beta$ is a linear function of $Z$:\n$$ \\beta(Z) = \\beta_0 + (\\beta_1 - \\beta_0) Z = 1 + (-s-1)Z = 1 - (s+1)Z $$\nSo, we have the relation:\n$$ Y_O(Z) - s Y_F(Z) = 1 - (s+1)Z $$\nIn the Burke–Schumann model, the reaction is infinitely fast, so fuel and oxidizer cannot coexist. They react in an infinitesimally thin \"flame sheet\" located at the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$.\n- On the fuel-lean side ($Z  Z_{\\mathrm{st}}$), there is an excess of oxidizer, so all fuel is consumed: $Y_F(Z) = 0$.\n- On the fuel-rich side ($Z > Z_{\\mathrm{st}}$), there is an excess of fuel, so all oxidizer is consumed: $Y_O(Z) = 0$.\n\nAt the flame sheet ($Z=Z_{\\mathrm{st}}$), both reactants are depleted: $Y_F(Z_{\\mathrm{st}}) = 0$ and $Y_O(Z_{\\mathrm{st}}) = 0$. Using our expression for $\\beta(Z)$, this means:\n$$ 0 - s(0) = 1 - (s+1)Z_{\\mathrm{st}} \\implies Z_{\\mathrm{st}} = \\frac{1}{s+1} $$\nWith $s=4$, the stoichiometric mixture fraction is $Z_{\\mathrm{st}} = \\frac{1}{4+1} = \\frac{1}{5} = 0.2$.\n\nNow we can determine the piecewise expressions for $Y_F(Z)$ and $Y_O(Z)$:\nFor $Z \\le Z_{\\mathrm{st}}$: $Y_F(Z) = 0$. The oxidizer mass fraction is $Y_O(Z) - 0 = 1 - (s+1)Z$.\nFor $Z > Z_{\\mathrm{st}}$: $Y_O(Z) = 0$. The fuel mass fraction is $0 - s Y_F(Z) = 1 - (s+1)Z \\implies Y_F(Z) = \\frac{(s+1)Z - 1}{s}$.\n\nSo, the piecewise fields for the reactants are:\n$$ Y_F(Z) = \\begin{cases} 0  \\text{for } Z \\le Z_{\\mathrm{st}} \\\\ \\frac{(s+1)Z - 1}{s}  \\text{for } Z > Z_{\\mathrm{st}} \\end{cases} $$\n$$ Y_O(Z) = \\begin{cases} 1 - (s+1)Z  \\text{for } Z  Z_{\\mathrm{st}} \\\\ 0  \\text{for } Z \\ge Z_{\\mathrm{st}} \\end{cases} $$\nThe total mass fraction must sum to unity: $Y_F + Y_O + Y_P = 1$. Thus, the product mass fraction is $Y_P(Z) = 1 - Y_F(Z) - Y_O(Z)$.\nFor $Z \\le Z_{\\mathrm{st}}$: $Y_P(Z) = 1 - 0 - (1-(s+1)Z) = (s+1)Z$.\nFor $Z > Z_{\\mathrm{st}}$: $Y_P(Z) = 1 - \\frac{(s+1)Z - 1}{s} - 0 = \\frac{s - (s+1)Z + 1}{s} = \\frac{(s+1)(1-Z)}{s}$.\nThe resulting piecewise field for the products is:\n$$ Y_P(Z) = \\begin{cases} (s+1)Z  \\text{for } Z \\le Z_{\\mathrm{st}} \\\\ \\frac{(s+1)(1-Z)}{s}  \\text{for } Z > Z_{\\mathrm{st}} \\end{cases} $$\n\n**2. Derivation of the Temperature Field**\n\nUnder the assumptions of unity Lewis numbers and adiabatic conditions, a specific total enthalpy is conserved. We define this total enthalpy as:\n$$ h_T = c_p T + Y_F q $$\nwhere $T$ is the local mixture temperature and $q$ is the lower heating value (LHV) of the fuel per unit mass of fuel. The conservation of $h_T$ can be shown by combining the energy and fuel species conservation equations, where the source terms cancel out due to the unity Lewis number assumption.\n\nSince $h_T$ is a conserved scalar, it is a linear function of $Z$. We evaluate $h_T$ at the boundaries:\n- At the oxidizer boundary ($Z=0$): $T = T_O$, $Y_F = 0$. Thus, $h_{T,0} = c_p T_O + 0 \\cdot q = c_p T_O$.\n- At the fuel boundary ($Z=1$): $T = T_F$, $Y_F = 1$. Thus, $h_{T,1} = c_p T_F + 1 \\cdot q = c_p T_F + q$.\n\nThe linear relationship for $h_T(Z)$ is:\n$$ h_T(Z) = h_{T,0} + (h_{T,1} - h_{T,0})Z = c_p T_O + (c_p T_F + q - c_p T_O)Z $$\nWe can now find the temperature $T(Z)$ by rearranging its definition:\n$$ T(Z) = \\frac{h_T(Z) - Y_F(Z) q}{c_p} = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z - Y_F(Z)\\frac{q}{c_p} $$\nSubstituting the piecewise expression for $Y_F(Z)$:\nFor $Z \\le Z_{\\mathrm{st}}$ ($Y_F=0$):\n$$ T(Z) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z $$\nFor $Z > Z_{\\mathrm{st}}$ ($Y_F(Z) = \\frac{(s+1)Z - 1}{s}$):\n$$ T(Z) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z - \\left(\\frac{(s+1)Z - 1}{s}\\right)\\frac{q}{c_p} $$\n$$ T(Z) = T_O + \\frac{q}{sc_p} + Z\\left(T_F - T_O + \\frac{q}{c_p} - \\frac{(s+1)q}{sc_p}\\right) $$\n$$ T(Z) = T_O + \\frac{q}{sc_p} + Z\\left(T_F - T_O - \\frac{q}{sc_p}\\right) $$\nThe temperature field is piecewise linear, with its maximum at the flame sheet, $Z=Z_{\\mathrm{st}}$.\n\n**3. Evaluation of the Adiabatic Flame Temperature**\n\nThe adiabatic flame temperature, $T_{ad}$, is the temperature at the flame sheet, $T(Z_{\\mathrm{st}})$. We can use the simpler fuel-lean side expression for $T(Z)$ and substitute $Z=Z_{\\mathrm{st}} = \\frac{1}{s+1}$:\n$$ T_{ad} = T(Z_{\\mathrm{st}}) = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)Z_{\\mathrm{st}} $$\n$$ T_{ad} = T_O + \\left(T_F - T_O + \\frac{q}{c_p}\\right)\\frac{1}{s+1} $$\n$$ T_{ad} = \\frac{T_O(s+1) + T_F - T_O}{s+1} + \\frac{q}{c_p(s+1)} $$\n$$ T_{ad} = \\frac{sT_O + T_F}{s+1} + \\frac{q}{c_p(s+1)} $$\nThis expression shows that the flame temperature consists of two parts: the temperature from inert mixing of the two streams evaluated at $Z_{\\mathrm{st}}$, and the temperature rise due to the release of chemical energy.\n\nNow, we substitute the given numerical values:\n$T_F = 300\\,\\mathrm{K}$\n$T_O = 1000\\,\\mathrm{K}$\n$c_p = 3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1}$\n$q = 5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$\n$s = 4$\n\nFirst, calculate the inert mixing temperature term:\n$$ \\frac{sT_O + T_F}{s+1} = \\frac{4 \\times 1000\\,\\mathrm{K} + 300\\,\\mathrm{K}}{4+1} = \\frac{4300\\,\\mathrm{K}}{5} = 860\\,\\mathrm{K} $$\nNext, calculate the temperature rise from combustion:\n$$ \\frac{q}{c_p(s+1)} = \\frac{5.0 \\times 10^7\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}}{(3.6 \\times 10^3\\,\\mathrm{J}\\,(\\mathrm{kg}\\,\\mathrm{K})^{-1})(4+1)} = \\frac{5.0 \\times 10^7}{3.6 \\times 10^3 \\times 5}\\,\\mathrm{K} = \\frac{5.0 \\times 10^7}{1.8 \\times 10^4}\\,\\mathrm{K} \\approx 2777.78\\,\\mathrm{K} $$\nThe adiabatic flame temperature is the sum of these two terms:\n$$ T_{ad} = 860\\,\\mathrm{K} + 2777.77... \\,\\mathrm{K} = 3637.77... \\,\\mathrm{K} $$\nRounding to four significant figures, we get:\n$$ T_{ad} = 3638\\,\\mathrm{K} $$",
            "answer": "$$\\boxed{3638}$$"
        },
        {
            "introduction": "Moving from the ideal to the practical, this exercise explores how real-world adjustments, such as inert gas dilution, impact flame stability. Building upon the concepts of stoichiometric mixture fraction, $Z_{st}$, and adiabatic flame temperature, $T_{ad}$, you will quantify how adding inerts to the fuel or oxidizer streams alters the flame's fundamental properties. This practice uses a simplified but insightful model to connect these thermodynamic changes to a critical scalar dissipation rate, $\\chi_{st,\\mathrm{crit}}$, offering a tangible link between stream composition, flame temperature, and the onset of extinction .",
            "id": "4024493",
            "problem": "Consider a planar, steady counterflow diffusion flame between two opposing streams: a fuel stream and an oxidizer stream. Assume unity Lewis number, equal diffusivities of species, constant pressure, and negligible radiation and viscous dissipation. The mixture fraction $Z \\in [0,1]$ is defined such that $Z=1$ corresponds to properties of the fuel stream and $Z=0$ corresponds to properties of the oxidizer stream. Under equal-diffusivity mixing with no reaction, the local mass fractions of the fuel and oxidizer at mixture fraction $Z$ are $Y_F(Z) = Z \\, Y_{F,\\infty}$ and $Y_O(Z) = (1-Z)\\, Y_{O,\\infty}$, where $Y_{F,\\infty}$ and $Y_{O,\\infty}$ denote the fuel and oxidizer mass fractions in their respective incoming streams.\n\nAssume a single-step global reaction $\\nu_F \\,\\mathrm{F} + \\nu_O \\,\\text{O}_2 \\to \\mathrm{Products}$ with molecular weights $W_F$ and $W_O$, and define the mass-based stoichiometric ratio $s$ by $s = \\dfrac{\\nu_O W_O}{\\nu_F W_F}$. The stoichiometric surface is located at mixture fraction $Z_{st}$ satisfying the stoichiometric constraint $Y_O(Z_{st}) = s \\, Y_F(Z_{st})$. Inert dilution is introduced by replacing a portion of either stream with chemically inert species. Let $i_F \\in [0,1)$ denote the inert dilution fraction in the fuel stream and $i_O \\in [0,1)$ denote the inert dilution fraction in the oxidizer stream. The undiluted base mass fraction of fuel in the fuel stream is $Y_{F,\\mathrm{base}}$, and the undiluted base mass fraction of oxygen in the oxidizer stream is $Y_{O,\\mathrm{base}}$. With inert dilution, the incoming stream compositions are $Y_{F,\\infty} = (1 - i_F)\\, Y_{F,\\mathrm{base}}$ in the fuel stream and $Y_{O,\\infty} = (1 - i_O)\\, Y_{O,\\mathrm{base}}$ in the oxidizer stream.\n\nAssume the incoming stream temperatures are $T_{F,\\infty}$ for the fuel stream and $T_{O,\\infty}$ for the oxidizer stream. With constant specific heat capacity at constant pressure $c_p$ for the mixture and a heat release per unit fuel mass $Q$, the adiabatic flame temperature at the stoichiometric surface $T_{ad}$ can be modeled by the energy balance at $Z_{st}$: the flame-sheet temperature equals the linear mixed temperature plus the sensible temperature rise associated with the released chemical energy of the consumed fuel. Let the temperature without reaction at $Z_{st}$ be $T_{\\mathrm{mix}}(Z_{st}) = Z_{st} T_{F,\\infty} + (1 - Z_{st}) T_{O,\\infty}$. The adiabatic flame temperature at the sheet is then $T_{ad} = T_{\\mathrm{mix}}(Z_{st}) + \\dfrac{Q}{c_p} \\, Y_F(Z_{st})$, with $Y_F(Z_{st}) = Z_{st} \\, Y_{F,\\infty}$.\n\nTo quantify ignition and extinction, use a reduced timescale comparison between mixing and chemistry at the stoichiometric surface. Let the temperature-dependent chemical rate coefficient be Arrhenius: $k(T) = A \\, \\exp\\!\\left(-\\dfrac{E}{R\\,T}\\right)$, where $A$ is the pre-exponential factor, $E$ is the activation energy, and $R$ is the Universal Gas Constant (UGC). Approximate the critical scalar dissipation rate at the stoichiometric surface for extinction by $\\chi_{st,\\mathrm{crit}} = C \\, k(T_{ad})$, with $C$ a dimensionless proportionality constant that arises from matching the diffusive timescale to the chemical timescale near $Z_{st}$. Interpret $\\chi_{st,\\mathrm{crit}}$ as the maximum stoichiometric scalar dissipation rate the flame can sustain; larger imposed mixing rates lead to extinction. Adding inert dilution shifts $Z_{st}$ through the mass-fraction constraint, reduces $T_{ad}$ through enthalpy dilution, and thereby modifies $k(T_{ad})$ and $\\chi_{st,\\mathrm{crit}}$.\n\nStarting from the definitions and physical laws stated above, derive expressions for $Z_{st}$, $T_{ad}$, and $\\chi_{st,\\mathrm{crit}}$ as functions of $i_F$, $i_O$, $T_{F,\\infty}$, $T_{O,\\infty}$, $Y_{F,\\mathrm{base}}$, $Y_{O,\\mathrm{base}}$, $\\nu_F$, $\\nu_O$, $W_F$, $W_O$, $Q$, $c_p$, $A$, $E$, $R$, and $C$. Then implement these expressions to compute the requested quantities for the following test suite. Use the parameters:\n- $\\nu_F = 1$,\n- $\\nu_O = 2$,\n- $W_F = 0.016$ $\\mathrm{kg/mol}$,\n- $W_O = 0.032$ $\\mathrm{kg/mol}$,\n- $Y_{F,\\mathrm{base}} = 1.0$,\n- $Y_{O,\\mathrm{base}} = 0.233$,\n- $Q = 5.0 \\times 10^{7}$ $\\mathrm{J/kg}$,\n- $c_p = 1200$ $\\mathrm{J/(kg\\cdot K)}$,\n- $A = 1.0 \\times 10^{7}$ $\\mathrm{s^{-1}}$,\n- $E = 1.20 \\times 10^{5}$ $\\mathrm{J/mol}$,\n- $R = 8.314$ $\\mathrm{J/(mol\\cdot K)}$,\n- $C = 0.5$.\n\nTest cases (each case is $(i_F, i_O, T_{F,\\infty}, T_{O,\\infty})$):\n1. $(0.0, 0.0, 300, 300)$\n2. $(0.6, 0.0, 300, 300)$\n3. $(0.0, 0.6, 300, 300)$\n4. $(0.4, 0.5, 500, 300)$\n5. $(0.0, 0.9, 300, 700)$\n\nFor each test case, compute:\n- $Z_{st}$ (dimensionless),\n- $T_{ad}$ in $\\mathrm{K}$,\n- $\\chi_{st,\\mathrm{crit}}$ in $\\mathrm{s^{-1}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case result itself represented as a list in the form $[Z_{st}, T_{ad}, \\chi_{st,\\mathrm{crit}}]$, for example $[[z_1,t_1,c_1],[z_2,t_2,c_2],\\dots]$. All answers for $T_{ad}$ must be expressed in $\\mathrm{K}$, and all answers for $\\chi_{st,\\mathrm{crit}}$ must be expressed in $\\mathrm{s^{-1}}$. The outputs must be floats.",
            "solution": "To solve this problem, we derive expressions for the stoichiometric mixture fraction ($Z_{st}$), adiabatic flame temperature ($T_{ad}$), and critical scalar dissipation rate ($\\chi_{st,\\mathrm{crit}}$) step-by-step based on the provided definitions and physical laws.\n\n### Step 1: Derivation of the Mass-Based Stoichiometric Ratio, $s$\n\nThe mass-based stoichiometric ratio, $s$, is defined as the mass of oxidizer required to completely consume a unit mass of fuel. It is given by the formula:\n$$\ns = \\frac{\\nu_O W_O}{\\nu_F W_F}\n$$\nwhere $\\nu_F$ and $\\nu_O$ are the molar stoichiometric coefficients of the fuel and oxidizer, respectively, and $W_F$ and $W_O$ are their molecular weights. For the provided parameters:\n- Molar stoichiometric coefficient of fuel, $\\nu_F = 1$\n- Molar stoichiometric coefficient of oxidizer, $\\nu_O = 2$\n- Molecular weight of fuel, $W_F = 0.016 \\, \\mathrm{kg/mol}$\n- Molecular weight of oxidizer, $W_O = 0.032 \\, \\mathrm{kg/mol}$\n\nSubstituting these values yields:\n$$\ns = \\frac{2 \\times 0.032 \\, \\mathrm{kg/mol}}{1 \\times 0.016 \\, \\mathrm{kg/mol}} = \\frac{0.064}{0.016} = 4\n$$\nThe stoichiometric ratio is a constant value of $4$ for all test cases.\n\n### Step 2: Derivation of the Stoichiometric Mixture Fraction, $Z_{st}$\n\nThe stoichiometric mixture fraction, $Z_{st}$, is the value of the mixture fraction $Z$ where fuel and oxidizer exist in stoichiometric proportions. Its location is defined by the condition $Y_O(Z_{st}) = s \\, Y_F(Z_{st})$. The problem states that without reaction, the mass fractions of fuel and oxidizer are linear functions of $Z$:\n$$\nY_F(Z) = Z \\, Y_{F,\\infty}\n$$\n$$\nY_O(Z) = (1-Z) \\, Y_{O,\\infty}\n$$\nThe incoming mass fractions, $Y_{F,\\infty}$ and $Y_{O,\\infty}$, are affected by inert dilution fractions $i_F$ and $i_O$:\n$$\nY_{F,\\infty} = (1 - i_F) \\, Y_{F,\\mathrm{base}}\n$$\n$$\nY_{O,\\infty} = (1 - i_O) \\, Y_{O,\\mathrm{base}}\n$$\nSubstituting the linear mixing rules into the stoichiometric condition:\n$$\n(1 - Z_{st}) \\, Y_{O,\\infty} = s \\, (Z_{st} \\, Y_{F,\\infty})\n$$\nWe can solve for $Z_{st}$:\n$$\nY_{O,\\infty} - Z_{st} \\, Y_{O,\\infty} = s \\, Z_{st} \\, Y_{F,\\infty}\n$$\n$$\nY_{O,\\infty} = Z_{st} (s \\, Y_{F,\\infty} + Y_{O,\\infty})\n$$\n$$\nZ_{st} = \\frac{Y_{O,\\infty}}{s \\, Y_{F,\\infty} + Y_{O,\\infty}}\n$$\nFinally, substituting the expressions for the diluted incoming mass fractions:\n$$\nZ_{st} = \\frac{(1 - i_O) \\, Y_{O,\\mathrm{base}}}{s \\, (1 - i_F) \\, Y_{F,\\mathrm{base}} + (1 - i_O) \\, Y_{O,\\mathrm{base}}}\n$$\nThis expression allows calculation of $Z_{st}$ for each test case, given $i_F$ and $i_O$.\n\n### Step 3: Derivation of the Adiabatic Flame Temperature, $T_{ad}$\n\nThe adiabatic flame temperature at the stoichiometric surface, $T_{ad}$, is modeled as the sum of the non-reacting mixture temperature, $T_{\\mathrm{mix}}(Z_{st})$, and a temperature rise due to the heat released by fuel consumption. The formula is:\n$$\nT_{ad} = T_{\\mathrm{mix}}(Z_{st}) + \\frac{Q}{c_p} \\, Y_F(Z_{st})\n$$\nwhere $Q$ is the heat release per unit fuel mass and $c_p$ is the specific heat capacity. The mixture temperature is a linear interpolation of the incoming stream temperatures, $T_{F,\\infty}$ and $T_{O,\\infty}$:\n$$\nT_{\\mathrm{mix}}(Z_{st}) = Z_{st} T_{F,\\infty} + (1 - Z_{st}) T_{O,\\infty}\n$$\nThe fuel mass fraction at the flame sheet, $Y_F(Z_{st})$, is the amount of fuel transported to the flame front, which is then assumed to be completely consumed. It is given by:\n$$\nY_F(Z_{st}) = Z_{st} \\, Y_{F,\\infty} = Z_{st} \\, (1 - i_F) \\, Y_{F,\\mathrm{base}}\n$$\nCombining these expressions, we obtain the full formula for $T_{ad}$:\n$$\nT_{ad} = Z_{st} T_{F,\\infty} + (1 - Z_{st}) T_{O,\\infty} + \\frac{Q}{c_p} \\, Z_{st} \\, (1 - i_F) \\, Y_{F,\\mathrm{base}}\n$$\n$T_{ad}$ can be computed after $Z_{st}$ is determined.\n\n### Step 4: Derivation of the Critical Scalar Dissipation Rate, $\\chi_{st,\\mathrm{crit}}$\n\nThe critical scalar dissipation rate at extinction, $\\chi_{st,\\mathrm{crit}}$, is approximated as being proportional to the chemical reaction rate at the adiabatic flame temperature. The model is given as:\n$$\n\\chi_{st,\\mathrm{crit}} = C \\, k(T_{ad})\n$$\nwhere $C$ is a dimensionless proportionality constant. The chemical rate coefficient, $k(T)$, follows the Arrhenius law:\n$$\nk(T) = A \\, \\exp\\left(-\\frac{E}{R\\,T}\\right)\n$$\nHere, $A$ is the pre-exponential factor, $E$ is the activation energy, and $R$ is the Universal Gas Constant. Substituting the expression for $k(T)$ at $T = T_{ad}$ into the equation for $\\chi_{st,\\mathrm{crit}}$:\n$$\n\\chi_{st,\\mathrm{crit}} = C \\, A \\, \\exp\\left(-\\frac{E}{R\\,T_{ad}}\\right)\n$$\nThis expression can be calculated once $T_{ad}$ is known.\n\n### Computational Procedure\nFor each test case, specified by the tuple $(i_F, i_O, T_{F,\\infty}, T_{O,\\infty})$, the calculation proceeds as follows:\n1.  All physical and chemical constants ($s$, $Y_{F,\\mathrm{base}}$, $Y_{O,\\mathrm{base}}$, $Q$, $c_p$, $C$, $A$, $E$, $R$) are defined. The stoichiometric ratio $s$ is pre-calculated as $4$.\n2.  Given $i_F$ and $i_O$, calculate the stoichiometric mixture fraction $Z_{st}$ using the derived formula from Step 2.\n3.  Using the calculated $Z_{st}$ and the given $T_{F,\\infty}$ and $T_{O,\\infty}$, compute the adiabatic flame temperature $T_{ad}$ using the formula from Step 3.\n4.  Finally, use the calculated $T_{ad}$ to compute the critical scalar dissipation rate $\\chi_{st,\\mathrm{crit}}$ using the formula from Step 4.\n5.  The triplet of results, $[Z_{st}, T_{ad}, \\chi_{st,\\mathrm{crit}}]$, is stored for each test case.\n6.  The final output is a list containing these triplets, formatted as specified.\nThis procedure will be implemented in the Python script.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes flame properties for a counterflow diffusion flame based on a simplified model.\n\n    The function derives expressions for the stoichiometric mixture fraction (Z_st),\n    adiabatic flame temperature (T_ad), and critical scalar dissipation rate (chi_st_crit)\n    and evaluates them for a given set of test cases.\n    \"\"\"\n\n    # --- Given Constants ---\n    nu_F = 1.0\n    nu_O = 2.0\n    W_F = 0.016  # kg/mol\n    W_O = 0.032  # kg/mol\n    Y_F_base = 1.0\n    Y_O_base = 0.233\n    Q = 5.0e7  # J/kg\n    c_p = 1200.0  # J/(kg.K)\n    A = 1.0e7  # s^-1\n    E = 1.20e5  # J/mol\n    R = 8.314  # J/(mol.K)\n    C = 0.5\n\n    # --- Test Cases ---\n    # Each case is a tuple: (i_F, i_O, T_F_inf, T_O_inf)\n    test_cases = [\n        (0.0, 0.0, 300.0, 300.0),\n        (0.6, 0.0, 300.0, 300.0),\n        (0.0, 0.6, 300.0, 300.0),\n        (0.4, 0.5, 500.0, 300.0),\n        (0.0, 0.9, 300.0, 700.0),\n    ]\n\n    # --- Calculations ---\n    # Step 1: Calculate the mass-based stoichiometric ratio (s)\n    # This is constant for all cases.\n    s = (nu_O * W_O) / (nu_F * W_F)\n\n    results = []\n    for case in test_cases:\n        i_F, i_O, T_F_inf, T_O_inf = case\n\n        # Calculate incoming mass fractions with dilution\n        Y_F_inf = (1.0 - i_F) * Y_F_base\n        Y_O_inf = (1.0 - i_O) * Y_O_base\n\n        # Step 2: Calculate stoichiometric mixture fraction (Z_st)\n        denominator_Z_st = s * Y_F_inf + Y_O_inf\n        if denominator_Z_st == 0:\n            # Handle potential division by zero, though unlikely with problem constraints\n            Z_st = np.nan \n        else:\n            Z_st = Y_O_inf / denominator_Z_st\n\n        # Step 3: Calculate adiabatic flame temperature (T_ad)\n        T_mix_st = Z_st * T_F_inf + (1.0 - Z_st) * T_O_inf\n        # Fuel mass fraction at the stoichiometric surface (from mixing line)\n        Y_F_st = Z_st * Y_F_inf  \n        T_ad = T_mix_st + (Q / c_p) * Y_F_st\n\n        # Step 4: Calculate critical scalar dissipation rate (chi_st_crit)\n        # Arrhenius rate coefficient at T_ad\n        k_T_ad = A * np.exp(-E / (R * T_ad))\n        chi_st_crit = C * k_T_ad\n\n        results.append([Z_st, T_ad, chi_st_crit])\n\n    # Format the output as a string representing a list of lists.\n    # The map(str, ...) converts each inner list to its string representation.\n    # Ex: [1.0, 2.0] - '[1.0, 2.0]'\n    output_str = f\"[{','.join(map(str, results))}]\"\n\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice moves into the realm of computational combustion, where you will directly simulate the celebrated \"S-curve\" that defines ignition and extinction phenomena. You will solve the flamelet equations, which balance finite-rate Arrhenius chemistry with diffusive transport, for a range of scalar dissipation rates, $\\chi_{st}$. By numerically computing the flame's response—specifically its maximum temperature and heat release—to varying levels of strain, you will trace the boundaries of stable combustion and identify the critical extinction point where the flame is quenched by excessive mixing .",
            "id": "4024497",
            "problem": "You are given a steady, unity-Lewis-number counterflow diffusion flamelet model for a one-step irreversible reaction in the mixture-fraction coordinate $Z \\in [0,1]$. The fuel mass fraction $Y_F(Z)$, oxidizer mass fraction $Y_O(Z)$, and temperature $T(Z)$ satisfy the ordinary differential equations derived from conservation of species and energy and the definition of scalar dissipation rate:\n$$\n-\\frac{\\chi}{2}\\frac{d^2 Y_F}{dZ^2} = \\frac{\\omega_F}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 Y_O}{dZ^2} = \\frac{\\omega_O}{\\rho},\\quad\n-\\frac{\\chi}{2}\\frac{d^2 T}{dZ^2} = \\frac{\\dot{q}}{\\rho c_p},\n$$\nwhere $\\chi$ is the scalar dissipation rate assumed equal to the stoichiometric scalar dissipation rate $\\chi_{st}$ for this simplified model, $\\rho$ is the density, $c_p$ is the constant-pressure specific heat, $\\omega_F$ and $\\omega_O$ are the volumetric source terms for fuel and oxidizer (negative for consumption), and $\\dot{q}$ is the volumetric heat release rate.\n\nAssume a one-step Arrhenius model with reaction rate per unit volume\n$$\n\\omega_r(Z) = \\rho\\,k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T(Z)}\\right)\\,[Y_F(Z)]^a\\,[Y_O(Z)]^b,\n$$\nand species source terms\n$$\n\\omega_F(Z) = -\\,\\omega_r(Z),\\qquad \\omega_O(Z) = -\\,s\\,\\omega_r(Z),\n$$\nwith stoichiometric mass consumption factor $s0$. The volumetric heat release rate is\n$$\n\\dot{q}(Z) = q\\,\\omega_r(Z),\n$$\nwhere $q$ is the specific heat release per unit mass of fuel consumed. The boundary conditions represent the fuel and oxidizer streams:\n$$\nY_F(0) = 0,\\quad Y_O(0) = Y_{O,u},\\quad T(0) = T_u,\\qquad\nY_F(1) = Y_{F,u},\\quad Y_O(1) = 0,\\quad T(1) = T_u,\n$$\nwith $Y_{F,u}  0$, $Y_{O,u}  0$, and $T_u$ the upstream temperature.\n\nUsing these definitions and constants\n- $\\rho = 1.0$ $\\mathrm{kg/m^3}$,\n- $c_p = 1000$ $\\mathrm{J/(kg\\cdot K)}$,\n- $q = 5.0\\times 10^7$ $\\mathrm{J/kg}$,\n- $k_0 = 20.0$ $\\mathrm{s^{-1}}$,\n- $E_a = 1.2\\times 10^5$ $\\mathrm{J/mol}$,\n- $R = 8.314$ $\\mathrm{J/(mol\\cdot K)}$,\n- $a = 1$, $b = 1$,\n- $s = 4$,\n- $Y_{F,u} = 0.1$, $Y_{O,u} = 0.23$,\n- $T_u = 300$ $\\mathrm{K}$,\n- $D = 1.0\\times 10^{-4}$ $\\mathrm{m^2/s}$,\n\nand assuming a constant scalar dissipation rate $\\chi = \\chi_{st}$, you must:\n\n1. Formulate the boundary value problem in first-order form and solve it numerically over $Z \\in [0,1]$ for each specified $\\chi_{st}$.\n2. Compute the maximum temperature\n$$\nT_{\\max} = \\max_{Z \\in [0,1]} T(Z),\n$$\nexpressed in $\\mathrm{K}$.\n3. Compute the integrated heat release per unit area across the flame\n$$\n\\mathcal{I}(\\chi_{st}) = \\int_0^1 \\dot{q}(Z)\\,\\frac{ds}{dZ}\\,dZ = \\sqrt{\\frac{2D}{\\chi_{st}}}\\,\\int_0^1 q\\,\\omega_r(Z)\\,dZ,\n$$\nexpressed in $\\mathrm{W/m^2}$, using the relation $\\chi = 2D\\left(\\frac{dZ}{ds}\\right)^2$ under the assumption of one-dimensional variation normal to the flame.\n4. Identify the onset of steep decline near extinction with the following criteria applied to the ordered sequence of $\\chi_{st}$ values:\n   - For temperature: find the smallest index $i0$ such that $\\displaystyle \\frac{T_{\\max}(\\chi_{st,i})}{T_{\\max}(\\chi_{st,i-1})}  0.90$. If none exists, report $-1$.\n   - For integrated heat release: find the smallest index $i0$ such that $\\displaystyle \\frac{\\mathcal{I}(\\chi_{st,i})}{\\mathcal{I}(\\chi_{st,i-1})}  0.50$. If none exists, report $-1$.\n\nThe required units are:\n- Temperature in $\\mathrm{K}$.\n- Integrated heat release per unit area in $\\mathrm{W/m^2}$.\n\nYour program must implement the numerical solution using the above constants and produce results for the following scalar dissipation rate test suite (in $\\mathrm{s^{-1}}$):\n- Happy path: $\\chi_{st} = 5.0$,\n- Moderately diffusive: $\\chi_{st} = 15.0$,\n- Near-extinction regime: $\\chi_{st} = 30.0$,\n- Strongly diffusive: $\\chi_{st} = 60.0$,\n- Extreme diffusion, edge case: $\\chi_{st} = 100.0$.\n\nThe final program output must be a single line containing a comma-separated list enclosed in square brackets of the form\n$$\n\\big[ [T_{\\max,1}, T_{\\max,2}, T_{\\max,3}, T_{\\max,4}, T_{\\max,5}],\\ [\\mathcal{I}_1, \\mathcal{I}_2, \\mathcal{I}_3, \\mathcal{I}_4, \\mathcal{I}_5],\\ i_T,\\ i_I \\big],\n$$\nwhere $T_{\\max,k}$ and $\\mathcal{I}_k$ are the values for the $k$-th $\\chi_{st}$ in the order given above, $i_T$ is the onset index for temperature decline, and $i_I$ is the onset index for integrated heat release decline. All numerical outputs must be real numbers (floats) for $T_{\\max,k}$ and $\\mathcal{I}_k$, and integers for $i_T$ and $i_I$.",
            "solution": "This problem requires the numerical solution of a nonlinear boundary value problem (BVP) that models the structure of a flamelet. The solution methodology involves several key steps implemented in the provided code.\n\n**1. Formulation as a First-Order System**\n\nThe given system consists of three coupled, second-order ordinary differential equations (ODEs). To use standard numerical BVP solvers (like `scipy.integrate.solve_bvp`), the system is first converted into a system of six first-order ODEs. A state vector $y(Z) = [Y_F, Y_F', Y_O, Y_O', T, T']^T$ is defined, where the prime denotes differentiation with respect to $Z$. The original equations are then rewritten as a system $\\frac{dy}{dZ} = f(Z, y, \\chi_{st})$. The reaction rate $\\omega_r$ is a highly nonlinear function of the state variables, as defined in the problem statement. To ensure physical results during iteration, mass fractions $Y_F$ and $Y_O$ are constrained to be non-negative within the reaction rate calculation.\n\n**2. Boundary Conditions**\n\nThe physical boundary conditions of the fuel and oxidizer streams translate directly into conditions on the state vector $y$ at the boundaries of the domain $Z=0$ and $Z=1$:\n- At $Z=0$ (oxidizer stream): $Y_F(0)=0$, $Y_O(0)=Y_{O,u}$, $T(0)=T_u$.\n- At $Z=1$ (fuel stream): $Y_F(1)=Y_{F,u}$, $Y_O(1)=0$, $T(1)=T_u$.\n\n**3. Numerical Solution Strategy**\n\nThe BVP is solved using a numerical package. Due to the stiffness and nonlinearity introduced by the Arrhenius term, a robust solution strategy is required.\n\n- **Initial Guess**: For the first calculation (at low $\\chi_{st}$), an analytical guess is constructed. The species profiles are approximated by linear \"mixing\" lines, and the temperature profile is approximated by a parabolic shape with a reasonable peak temperature, representing a burning flame.\n- **Continuation Method**: To solve for the entire range of $\\chi_{st}$ values, a continuation method is employed. The converged solution for a given $\\chi_{st,i}$ serves as an excellent initial guess for the next, slightly larger value, $\\chi_{st,i+1}$. This greatly improves solver robustness, especially when approaching the extinction limit where the flame becomes very sensitive. If the solver fails to converge for a high $\\chi_{st}$, it indicates that no stable burning solution exists, and the flame is considered extinguished. In this case, the solution defaults to the trivial \"frozen\" (non-reacting) state, where $T_{max}=T_u$ and $\\mathcal{I}=0$.\n\n**4. Post-Processing**\n\nOnce a converged solution is obtained for a given $\\chi_{st}$, the required physical quantities are calculated:\n- **Maximum Temperature ($T_{\\max}$)**: This is found by taking the maximum value of the computed temperature profile $T(Z)$.\n- **Integrated Heat Release ($\\mathcal{I}$)**: This requires numerically integrating the heat release rate across the flame structure. The integral $\\int_0^1 q\\,\\omega_r(Z)\\,dZ$ is computed from the solution profiles using a numerical quadrature rule (e.g., the trapezoidal rule), and the result is multiplied by the pre-factor $\\sqrt{2D/\\chi_{st}}$.\n\nBy repeating this process for each value in the $\\chi_{st}$ test suite, we can trace the flame's response to increasing strain (the S-curve) and identify the critical conditions for extinction based on the specified criteria.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Solves the counterflow diffusion flamelet equations for a series of scalar dissipation rates,\n    calculates maximum temperature and integrated heat release, and identifies extinction indices.\n    \"\"\"\n    # Define physical and chemical constants from the problem statement\n    rho = 1.0       # kg/m^3\n    cp = 1000.0     # J/(kg*K)\n    q = 5.0e7       # J/kg\n    k0 = 20.0       # s^-1\n    Ea = 1.2e5      # J/mol\n    R = 8.314       # J/(mol*K)\n    a = 1.0         # Reaction order for fuel\n    b = 1.0         # Reaction order for oxidizer\n    s = 4.0         # Stoichiometric mass ratio\n    Y_F_u = 0.1     # Fuel mass fraction in fuel stream\n    Y_O_u = 0.23    # Oxidizer mass fraction in oxidizer stream\n    T_u = 300.0     # K\n    D = 1.0e-4      # m^2/s\n\n    # Define the test cases for the stoichiometric scalar dissipation rate\n    chi_st_values = [5.0, 15.0, 30.0, 60.0, 100.0]\n\n    def ode_fun(Z, y, chi_st):\n        \"\"\"\n        Defines the system of first-order ODEs for the flamelet model.\n        State vector y = [Y_F, Y_F', Y_O, Y_O', T, T']\n        \"\"\"\n        # Clamp concentrations and temperature to be physical\n        YF = np.maximum(y[0], 0.0)\n        YO = np.maximum(y[2], 0.0)\n        T = np.maximum(y[4], T_u)\n\n        # Volumetric reaction rate (rho=1)\n        reaction_rate = k0 * np.exp(-Ea / (R * T)) * (YF**a) * (YO**b)\n\n        # Second derivatives\n        d2YF_dZ2 = (2.0 / chi_st) * reaction_rate\n        d2YO_dZ2 = (2.0 * s / chi_st) * reaction_rate\n        d2T_dZ2 = -(2.0 * q / (cp * chi_st)) * reaction_rate\n\n        # Return derivatives of the state vector\n        return np.vstack((y[1], d2YF_dZ2, y[3], d2YO_dZ2, y[5], d2T_dZ2))\n\n    def bc_fun(ya, yb):\n        \"\"\"\n        Defines the boundary conditions at Z=0 (ya) and Z=1 (yb).\n        \"\"\"\n        return np.array([\n            ya[0] - 0.0,      # YF(0) = 0\n            ya[2] - Y_O_u,    # YO(0) = Y_O_u\n            ya[4] - T_u,      # T(0) = T_u\n            yb[0] - Y_F_u,    # YF(1) = Y_F_u\n            yb[2] - 0.0,      # YO(1) = 0\n            yb[4] - T_u,      # T(1) = T_u\n        ])\n\n    T_max_results = []\n    I_results = []\n    \n    sol_prev = None\n    Z_mesh = np.linspace(0, 1, 201)\n\n    for chi_st in chi_st_values:\n        if sol_prev is None:\n            # For the first run, create an analytical guess\n            y_guess = np.zeros((6, Z_mesh.size))\n            T_peak_guess = 2500.0\n            \n            y_guess[0, :] = Y_F_u * Z_mesh                 # YF profile\n            y_guess[1, :] = Y_F_u                          # YF' profile\n            y_guess[2, :] = Y_O_u * (1 - Z_mesh)           # YO profile\n            y_guess[3, :] = -Y_O_u                         # YO' profile\n            y_guess[4, :] = T_u + (T_peak_guess - T_u) * 4 * Z_mesh * (1 - Z_mesh) # T profile\n            y_guess[5, :] = (T_peak_guess - T_u) * 4 * (1 - 2 * Z_mesh)           # T' profile\n        else:\n            # Use the previous successful solution as guess (continuation)\n            y_guess = sol_prev.sol(Z_mesh)\n\n        # Solve the BVP\n        sol = solve_bvp(lambda Z, y: ode_fun(Z, y, chi_st),\n                        bc_fun,\n                        Z_mesh,\n                        y_guess,\n                        tol=1e-5,\n                        max_nodes=5000)\n\n        if not sol.success:\n            # If solver fails, assume extinction: trivial non-reacting solution\n            current_T_max = T_u\n            current_I = 0.0\n            sol_prev = None # Reset continuation\n        else:\n            # Store solution for next step in continuation\n            sol_prev = sol\n            \n            # Evaluate solution on a fine grid for accurate post-processing\n            Z_fine = np.linspace(0, 1, 1001)\n            y_fine = sol.sol(Z_fine)\n\n            # Task 2: Compute maximum temperature\n            T_profile = y_fine[4, :]\n            current_T_max = np.max(T_profile)\n\n            # Task 3: Compute integrated heat release\n            YF_fine = np.maximum(y_fine[0, :], 0.0)\n            YO_fine = np.maximum(y_fine[2, :], 0.0)\n            T_fine = y_fine[4, :]\n\n            omega_r_profile = rho * k0 * np.exp(-Ea / (R * T_fine)) * (YF_fine**a) * (YO_fine**b)\n            integral_q_omega_r = np.trapz(q * omega_r_profile, x=Z_fine)\n            \n            pre_factor = np.sqrt(2 * D / chi_st)\n            current_I = pre_factor * integral_q_omega_r\n\n        T_max_results.append(current_T_max)\n        I_results.append(current_I)\n\n    # Task 4: Identify onset indices for extinction\n    i_T = -1\n    for i in range(1, len(T_max_results)):\n        if T_max_results[i-1] > T_u and (T_max_results[i] / T_max_results[i-1])  0.90:\n            i_T = i\n            break\n            \n    i_I = -1\n    for i in range(1, len(I_results)):\n        if I_results[i-1] > 1e-9 and (I_results[i] / I_results[i-1])  0.50:\n            i_I = i\n            break\n\n    # Format final output string\n    t_max_str = ','.join(map(str, T_max_results))\n    i_val_str = ','.join(map(str, I_results))\n    \n    print(f\"[[{t_max_str}],[{i_val_str}],{i_T},{i_I}]\")\n\nsolve()\n```"
        }
    ]
}