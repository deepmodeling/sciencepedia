{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of non-premixed combustion analysis is the stoichiometric mixture fraction, $Z_{st}$, which marks the precise location in mixture fraction space where fuel and oxidizer are in perfect balance. This exercise provides foundational practice in calculating this crucial parameter by defining a conserved scalar based on elemental oxygen demand. Mastering this calculation allows you to determine whether any point in a flame is fuel-lean or fuel-rich, a fundamental skill for interpreting combustion phenomena. ",
            "id": "4062754",
            "problem": "A steady, non-premixed mixing layer forms between a fuel stream of pure methane and an oxidizer stream of dry air at atmospheric conditions. The Shvab–Zel’dovich formulation for non-premixed flames uses a conserved scalar, the mixture fraction, built from elemental conservation with equal diffusivities (unit Lewis numbers), and evaluates stoichiometry by imposing zero net oxidizer demand. Consider the complete oxidation reaction $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$ and assume the following inlet compositions:\n- Fuel stream: pure methane, with elemental mass fractions $Y_{C,F} = \\frac{12}{16}$, $Y_{H,F} = \\frac{4}{16}$, and $Y_{O,F} = 0$.\n- Oxidizer stream: dry air, approximated as only $\\mathrm{O_2}$ and $\\mathrm{N_2}$, with $Y_{\\mathrm{O_2},O} = 0.233$, $Y_{\\mathrm{N_2},O} = 0.767$, and hence elemental mass fractions $Y_{C,O} = 0$, $Y_{H,O} = 0$, and $Y_{O,O} = 0.233$.\nUse the atomic weights $W_C = 12$, $W_H = 1$, and $W_O = 16$.\n\nUnder the Shvab–Zel’dovich formulation employing the element-molar oxygen-demand scalar defined by the conserved linear combination of elemental molar abundances,\n$$\\beta \\equiv 2\\,\\frac{Y_C}{W_C} + \\frac{1}{2}\\,\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O},$$\nderive an expression for the stoichiometric mixture fraction $Z_{st}$ based solely on inlet stream compositions by imposing zero net oxygen demand at stoichiometry and the linearity of mixing for conserved scalars. Then, for a location in the flow where the mixture fraction is $Z = 0.08$, determine whether the state is fuel-lean ($Z  Z_{st}$) or fuel-rich ($Z  Z_{st}$).\n\nRound your value of $Z_{st}$ to four significant figures and treat the mixture fraction as unitless. Provide your final answer as a two-entry row matrix $\\begin{pmatrix} Z_{st}  s \\end{pmatrix}$, where $s = \\operatorname{sgn}(Z - Z_{st})$ with $s \\in \\{-1, 0, 1\\}$ and the convention that $s = -1$ denotes fuel-lean, $s = +1$ denotes fuel-rich, and $s = 0$ denotes exactly stoichiometric.",
            "solution": "The user wants to solve a combustion problem using the Shvab–Zel’dovich formulation.\n\n### Step 1: Problem Validation\n\n**1. Extract Givens:**\n-   **Reaction:** $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$\n-   **Fuel Stream (denoted by subscript F):** Pure methane ($\\mathrm{CH_4}$), corresponding to mixture fraction $Z=1$. Elemental mass fractions are $Y_{C,F} = \\frac{12}{16}$, $Y_{H,F} = \\frac{4}{16}$, and $Y_{O,F} = 0$.\n-   **Oxidizer Stream (denoted by subscript O):** Dry air, corresponding to mixture fraction $Z=0$. Composition is $Y_{\\mathrm{O_2},O} = 0.233$ and $Y_{\\mathrm{N_2},O} = 0.767$. Elemental mass fractions are $Y_{C,O} = 0$, $Y_{H,O} = 0$, and $Y_{O,O} = 0.233$.\n-   **Atomic Weights:** $W_C = 12$, $W_H = 1$, and $W_O = 16$.\n-   **Conserved Scalar Definition:** An element-molar oxygen-demand scalar $\\beta$ is defined as $\\beta \\equiv 2\\,\\frac{Y_C}{W_C} + \\frac{1}{2}\\,\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O}$, where $Y_C$, $Y_H$, and $Y_O$ are the local elemental mass fractions of carbon, hydrogen, and oxygen, respectively.\n-   **Stoichiometry Condition:** The stoichiometric condition is defined by $\\beta_{st} = 0$.\n-   **Target Location:** A point in the flow where the mixture fraction is $Z = 0.08$.\n-   **Required Output:**\n    1.  The value of the stoichiometric mixture fraction, $Z_{st}$, rounded to four significant figures.\n    2.  A determination of whether the state at $Z=0.08$ is fuel-lean or fuel-rich, represented by $s = \\operatorname{sgn}(Z - Z_{st})$, where $s=-1$ for lean, $s=+1$ for rich, and $s=0$ for stoichiometric.\n    3.  The final answer must be in the matrix form $\\begin{pmatrix} Z_{st}  s \\end{pmatrix}$.\n\n**2. Validate Using Extracted Givens:**\n-   **Scientific Grounding:** The problem is firmly rooted in classical combustion theory. The Shvab–Zel’dovich formulation, conserved scalars, and the concept of mixture fraction are standard and fundamental topics in the study of non-premixed flames. The given chemical reaction and compositions are standard representations for methane-air combustion. The construction of the scalar $\\beta$ is a valid application of elemental conservation principles to define stoichiometry. The problem is scientifically sound.\n-   **Well-Posedness:** The problem statement is complete, providing all necessary definitions, constants, and boundary conditions to uniquely determine the required values. The tasks are specific and solvable.\n-   **Objectivity:** The problem is stated in precise, quantitative, and unambiguous scientific language. There are no subjective or opinion-based elements.\n\n**3. Verdict and Action:**\nThe problem is deemed **valid**. It is a well-posed, scientifically grounded problem from the field of computational combustion. A complete solution will be provided.\n\n### Step 2: Derivation and Solution\n\nThe core principle of the Shvab–Zel’dovich formulation under the assumption of equal diffusivities (unit Lewis numbers for all species) is that any conserved scalar is a linear function of any other conserved scalar. The mixture fraction, $Z$, is a conserved scalar by definition, with values $Z=1$ in the fuel stream and $Z=0$ in the oxidizer stream. The scalar $\\beta$, being a linear combination of conserved elemental mass fractions, is also a conserved scalar.\n\nTherefore, $\\beta$ must be a linear function of $Z$:\n$$ \\beta(Z) = (\\beta_F - \\beta_O)Z + \\beta_O $$\nwhere $\\beta_F$ and $\\beta_O$ are the values of $\\beta$ in the pure fuel and oxidizer streams, respectively.\n\nFirst, we calculate $\\beta_F$ for the fuel stream ($Z=1$), where $Y_{C,F} = \\frac{12}{16}$, $Y_{H,F} = \\frac{4}{16}$, and $Y_{O,F} = 0$.\n$$ \\beta_F = 2\\,\\frac{Y_{C,F}}{W_C} + \\frac{1}{2}\\,\\frac{Y_{H,F}}{W_H} - \\frac{Y_{O,F}}{W_O} $$\n$$ \\beta_F = 2 \\left( \\frac{12/16}{12} \\right) + \\frac{1}{2} \\left( \\frac{4/16}{1} \\right) - \\frac{0}{16} $$\n$$ \\beta_F = 2 \\left( \\frac{1}{16} \\right) + \\frac{1}{2} \\left( \\frac{4}{16} \\right) = \\frac{2}{16} + \\frac{2}{16} = \\frac{4}{16} = \\frac{1}{4} $$\n\nNext, we calculate $\\beta_O$ for the oxidizer stream ($Z=0$), where $Y_{C,O} = 0$, $Y_{H,O} = 0$, and $Y_{O,O} = 0.233$.\n$$ \\beta_O = 2\\,\\frac{Y_{C,O}}{W_C} + \\frac{1}{2}\\,\\frac{Y_{H,O}}{W_H} - \\frac{Y_{O,O}}{W_O} $$\n$$ \\beta_O = 2 \\left( \\frac{0}{12} \\right) + \\frac{1}{2} \\left( \\frac{0}{1} \\right) - \\frac{0.233}{16} $$\n$$ \\beta_O = - \\frac{0.233}{16} $$\n\nStoichiometry is defined as the condition where there is exactly enough oxidizer to completely consume the fuel, which corresponds to $\\beta = 0$. We denote the mixture fraction at this condition as $Z_{st}$. We can find $Z_{st}$ by setting $\\beta(Z_{st}) = 0$ in the linear relationship.\n$$ 0 = (\\beta_F - \\beta_O)Z_{st} + \\beta_O $$\nSolving for $Z_{st}$:\n$$ Z_{st} = \\frac{-\\beta_O}{\\beta_F - \\beta_O} $$\nSubstituting the calculated values for $\\beta_F$ and $\\beta_O$:\n$$ Z_{st} = \\frac{- \\left( - \\frac{0.233}{16} \\right)}{\\frac{1}{4} - \\left( - \\frac{0.233}{16} \\right)} = \\frac{\\frac{0.233}{16}}{\\frac{4}{16} + \\frac{0.233}{16}} $$\n$$ Z_{st} = \\frac{\\frac{0.233}{16}}{\\frac{4 + 0.233}{16}} = \\frac{0.233}{4.233} $$\nNow, we compute the numerical value:\n$$ Z_{st} \\approx 0.0550437042... $$\nRounding to four significant figures as required by the problem statement gives:\n$$ Z_{st} \\approx 0.05504 $$\n\nThe problem then asks to determine if the state at a location with mixture fraction $Z = 0.08$ is fuel-lean or fuel-rich.\nA mixture is:\n-   Fuel-lean if $Z  Z_{st}$ (excess oxidizer)\n-   Fuel-rich if $Z  Z_{st}$ (excess fuel)\n-   Stoichiometric if $Z = Z_{st}$\n\nComparing the given value $Z=0.08$ with the calculated stoichiometric value $Z_{st} \\approx 0.05504$:\n$$ 0.08  0.05504 $$\nSince $Z  Z_{st}$, the mixture is fuel-rich.\n\nWe must also calculate $s = \\operatorname{sgn}(Z - Z_{st})$.\n$$ Z - Z_{st} = 0.08 - 0.05504 = 0.02496 $$\nSince $Z - Z_{st}  0$, the sign function gives:\n$$ s = \\operatorname{sgn}(0.02496) = 1 $$\n\nThe final answer is to be provided as a two-entry row matrix $\\begin{pmatrix} Z_{st}  s \\end{pmatrix}$.\nThe two entries are $Z_{st} = 0.05504$ and $s = 1$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.05504  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The previous exercise utilized a conserved scalar to find the flame position. This next practice delves into the theoretical heart of the Shvab-Zeldovich formulation: elemental conservation. You will derive the dimensionless weighting coefficients that are used to construct any conserved scalar, revealing that the \"conservation\" property is a direct mathematical consequence of atom conservation in chemical reactions. This fundamental exercise bridges the gap between chemical stoichiometry and the powerful conserved scalar approach used in combustion modeling. ",
            "id": "4062763",
            "problem": "Consider a non-premixed methane–air system modeled under the Shvab–Zel’dovich (SZ) formulation, where the species set is $\\{ \\mathrm{CH_4}, \\mathrm{O_2}, \\mathrm{N_2}, \\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{CO} \\}$. Let the tracked elements be carbon ($\\mathrm{C}$), hydrogen ($\\mathrm{H}$), and oxygen ($\\mathrm{O}$). Assume the following standard atomic weights: $W_{\\mathrm{C}} = 12.011$, $W_{\\mathrm{H}} = 1.008$, $W_{\\mathrm{O}} = 15.999$, and $W_{\\mathrm{N}} = 14.007$, all in $\\mathrm{g/mol}$. Species molecular weights are to be obtained from these atomic weights using stoichiometry. Let $\\dot{\\omega}_i$ denote the mass production rate of species $i$ in $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$, and let $a_{k,i}$ denote the number of atoms of element $k \\in \\{\\mathrm{C},\\mathrm{H},\\mathrm{O}\\}$ in species $i$.\n\nStarting from:\n- the elemental conservation statement that the total molar production rate of each element vanishes due to chemical reaction,\n- the relation between mass and molar production rates via molecular weights,\nderive, from first principles, a set of dimensionless SZ weighting coefficients $\\beta^{(k)}_i$ such that the weighted sum of reaction source terms vanishes for each tracked element, i.e., $\\sum_i \\beta^{(k)}_i \\dot{\\omega}_i = 0$ for $k \\in \\{\\mathrm{C},\\mathrm{H},\\mathrm{O}\\}$ for any reaction mechanism that respects elemental conservation.\n\nThen, using your derived formula and the species set given, compute numerically the SZ weights for the three elements and the six species. Use the species order $\\left[\\mathrm{CH_4}, \\mathrm{O_2}, \\mathrm{N_2}, \\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{CO}\\right]$ and report the final answer as a single row matrix of $18$ entries in the following concatenated order:\n- first the six $\\beta^{(\\mathrm{C})}_i$,\n- then the six $\\beta^{(\\mathrm{H})}_i$,\n- then the six $\\beta^{(\\mathrm{O})}_i$.\n\nFinally, verify explicitly (by symbolic stoichiometric accounting) that for the global one-step methane combustion reaction $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$ with $\\mathrm{N_2}$ inert, the weighted sums $\\sum_i \\beta^{(k)}_i \\dot{\\omega}_i$ vanish for $k \\in \\{\\mathrm{C},\\mathrm{H},\\mathrm{O}\\}$. For this verification, express species mass source terms as $\\dot{\\omega}_i = W_i \\nu_i r$, where $W_i$ is the species molecular weight in $\\mathrm{g/mol}$, $\\nu_i$ is the stoichiometric coefficient (negative for reactants, positive for products), and $r$ is a molar progress rate. No numerical value of $r$ is required.\n\nAnswer specification:\n- Round your reported SZ weights to four significant figures.\n- Report your final answer as a single row matrix as specified above.\n- The SZ weights are dimensionless; no units are required in the final answer.",
            "solution": "The user-provided problem has been validated and is deemed a valid, well-posed, and scientifically grounded problem in the field of computational combustion.\n\nThe solution proceeds in three parts: first, the derivation of the Shvab–Zel’dovich (SZ) weighting coefficients from first principles; second, the numerical computation of these coefficients for the given methane-air system; and third, the verification of the derived coefficients for a global one-step reaction.\n\n### Part 1: Derivation of the Shvab–Zel’dovich Coefficients\n\nThe fundamental principle underlying the Shvab–Zel’dovich formulation is the conservation of elements during chemical reactions. We are asked to start from the statement that the total molar production rate of each element $k$ is zero.\n\nLet $\\dot{\\Omega}_i$ be the molar production rate of species $i$ (in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$), and let $a_{k,i}$ be the number of atoms of element $k$ in a molecule of species $i$. The conservation of element $k$ requires that the net molar production rate of that element, summed over all species, must be zero:\n$$\n\\sum_{i} a_{k,i} \\dot{\\Omega}_i = 0\n$$\nThis equation must hold for any valid chemical reaction mechanism.\n\nThe problem provides the mass production rate, $\\dot{\\omega}_i$ (in $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$), and asks for a relationship involving these terms. The molar production rate $\\dot{\\Omega}_i$ and mass production rate $\\dot{\\omega}_i$ are related by the molecular weight $W_i$ of species $i$ (in $\\mathrm{g\\,mol^{-1}}$ or $\\mathrm{kg\\,kmol^{-1}}$). We have:\n$$\n\\dot{\\omega}_i = W_i \\dot{\\Omega}_i \\implies \\dot{\\Omega}_i = \\frac{\\dot{\\omega}_i}{W_i}\n$$\nSubstituting this relationship into the elemental conservation equation gives:\n$$\n\\sum_{i} a_{k,i} \\frac{\\dot{\\omega}_i}{W_i} = 0\n$$\nThis equation has the form $\\sum_i \\beta'^{(k)}_i \\dot{\\omega}_i = 0$, where the coefficients are $\\beta'^{(k)}_i = a_{k,i} / W_i$. However, the problem requires *dimensionless* coefficients. The coefficient $\\beta'^{(k)}_i$ has units of moles per mass (e.g., $\\mathrm{mol/g}$), since $a_{k,i}$ is dimensionless.\n\nTo make these coefficients dimensionless, we can multiply the entire equation by a constant that has units of mass per mole. A physically meaningful and convenient choice for this constant is the atomic weight of the element $k$ being tracked, $W_k$. Multiplying the equation by $W_k$ yields:\n$$\nW_k \\sum_{i} \\frac{a_{k,i}}{W_i} \\dot{\\omega}_i = \\sum_{i} \\left( \\frac{a_{k,i} W_k}{W_i} \\right) \\dot{\\omega}_i = 0\n$$\nWe can now identify the dimensionless Shvab–Zel’dovich weighting coefficients, $\\beta^{(k)}_i$, as:\n$$\n\\beta^{(k)}_i = \\frac{a_{k,i} W_k}{W_i}\n$$\nThis coefficient represents the mass fraction of element $k$ in species $i$. The resulting equation, $\\sum_i \\beta^{(k)}_i \\dot{\\omega}_i = 0$, represents the conservation of mass for element $k$, as $\\beta^{(k)}_i \\dot{\\omega}_i$ is the mass production rate of element $k$ associated with the production of species $i$.\n\n### Part 2: Numerical Computation of Coefficients\n\nWe first calculate the molecular weights ($W_i$) for each species in the set $\\{ \\mathrm{CH_4}, \\mathrm{O_2}, \\mathrm{N_2}, \\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{CO} \\}$ using the given atomic weights: $W_{\\mathrm{C}} = 12.011$, $W_{\\mathrm{H}} = 1.008$, $W_{\\mathrm{O}} = 15.999$, and $W_{\\mathrm{N}} = 14.007$, all in $\\mathrm{g/mol}$.\n\n$W_{\\mathrm{CH_4}} = 1 \\cdot W_{\\mathrm{C}} + 4 \\cdot W_{\\mathrm{H}} = 12.011 + 4(1.008) = 16.043 \\, \\mathrm{g/mol}$\n$W_{\\mathrm{O_2}} = 2 \\cdot W_{\\mathrm{O}} = 2(15.999) = 31.998 \\, \\mathrm{g/mol}$\n$W_{\\mathrm{N_2}} = 2 \\cdot W_{\\mathrm{N}} = 2(14.007) = 28.014 \\, \\mathrm{g/mol}$\n$W_{\\mathrm{CO_2}} = 1 \\cdot W_{\\mathrm{C}} + 2 \\cdot W_{\\mathrm{O}} = 12.011 + 2(15.999) = 44.009 \\, \\mathrm{g/mol}$\n$W_{\\mathrm{H_2O}} = 2 \\cdot W_{\\mathrm{H}} + 1 \\cdot W_{\\mathrm{O}} = 2(1.008) + 15.999 = 18.015 \\, \\mathrm{g/mol}$\n$W_{\\mathrm{CO}} = 1 \\cdot W_{\\mathrm{C}} + 1 \\cdot W_{\\mathrm{O}} = 12.011 + 15.999 = 28.010 \\, \\mathrm{g/mol}$\n\nNow, we compute the coefficients $\\beta^{(k)}_i = (a_{k,i} W_k) / W_i$ for each element $k \\in \\{\\mathrm{C}, \\mathrm{H}, \\mathrm{O}\\}$ and each species $i$.\n\n**Element Carbon (C):** $W_{\\mathrm{C}} = 12.011$\n$\\beta^{(\\mathrm{C})}_{\\mathrm{CH_4}} = \\frac{1 \\cdot 12.011}{16.043} \\approx 0.7487$\n$\\beta^{(\\mathrm{C})}_{\\mathrm{O_2}} = \\frac{0 \\cdot 12.011}{31.998} = 0$\n$\\beta^{(\\mathrm{C})}_{\\mathrm{N_2}} = \\frac{0 \\cdot 12.011}{28.014} = 0$\n$\\beta^{(\\mathrm{C})}_{\\mathrm{CO_2}} = \\frac{1 \\cdot 12.011}{44.009} \\approx 0.2729$\n$\\beta^{(\\mathrm{C})}_{\\mathrm{H_2O}} = \\frac{0 \\cdot 12.011}{18.015} = 0$\n$\\beta^{(\\mathrm{C})}_{\\mathrm{CO}} = \\frac{1 \\cdot 12.011}{28.010} \\approx 0.4288$\n\n**Element Hydrogen (H):** $W_{\\mathrm{H}} = 1.008$\n$\\beta^{(\\mathrm{H})}_{\\mathrm{CH_4}} = \\frac{4 \\cdot 1.008}{16.043} \\approx 0.2513$\n$\\beta^{(\\mathrm{H})}_{\\mathrm{O_2}} = \\frac{0 \\cdot 1.008}{31.998} = 0$\n$\\beta^{(\\mathrm{H})}_{\\mathrm{N_2}} = \\frac{0 \\cdot 1.008}{28.014} = 0$\n$\\beta^{(\\mathrm{H})}_{\\mathrm{CO_2}} = \\frac{0 \\cdot 1.008}{44.009} = 0$\n$\\beta^{(\\mathrm{H})}_{\\mathrm{H_2O}} = \\frac{2 \\cdot 1.008}{18.015} \\approx 0.1119$\n$\\beta^{(\\mathrm{H})}_{\\mathrm{CO}} = \\frac{0 \\cdot 1.008}{28.010} = 0$\n\n**Element Oxygen (O):** $W_{\\mathrm{O}} = 15.999$\n$\\beta^{(\\mathrm{O})}_{\\mathrm{CH_4}} = \\frac{0 \\cdot 15.999}{16.043} = 0$\n$\\beta^{(\\mathrm{O})}_{\\mathrm{O_2}} = \\frac{2 \\cdot 15.999}{31.998} = 1.000$\n$\\beta^{(\\mathrm{O})}_{\\mathrm{N_2}} = \\frac{0 \\cdot 15.999}{28.014} = 0$\n$\\beta^{(\\mathrm{O})}_{\\mathrm{CO_2}} = \\frac{2 \\cdot 15.999}{44.009} \\approx 0.7271$\n$\\beta^{(\\mathrm{O})}_{\\mathrm{H_2O}} = \\frac{1 \\cdot 15.999}{18.015} \\approx 0.8881$\n$\\beta^{(\\mathrm{O})}_{\\mathrm{CO}} = \\frac{1 \\cdot 15.999}{28.010} \\approx 0.5712$\n\n### Part 3: Verification for a Global One-Step Reaction\n\nWe verify the result for the reaction $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$. The stoichiometric coefficients $\\nu_i$ for the species vector $[\\mathrm{CH_4}, \\mathrm{O_2}, \\mathrm{N_2}, \\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{CO}]$ are $[-1, -2, 0, 1, 2, 0]$.\n\nThe mass source term for species $i$ is given by $\\dot{\\omega}_i = W_i \\nu_i r$, where $r$ is a molar progress rate. We must show that $\\sum_i \\beta^{(k)}_i \\dot{\\omega}_i = 0$ for each element $k$.\n\nSubstituting the expressions for $\\beta^{(k)}_i$ and $\\dot{\\omega}_i$:\n$$\n\\sum_i \\beta^{(k)}_i \\dot{\\omega}_i = \\sum_i \\left( \\frac{a_{k,i} W_k}{W_i} \\right) (W_i \\nu_i r) = \\sum_i a_{k,i} W_k \\nu_i r = W_k r \\sum_i a_{k,i} \\nu_i\n$$\nThe sum is zero if and only if $\\sum_i a_{k,i} \\nu_i = 0$. This is the mathematical statement of atom conservation for element $k$ in the reaction. We verify this for each element.\n\n**Carbon (C):**\n$$\n\\sum_i a_{\\mathrm{C},i} \\nu_i = a_{\\mathrm{C},\\mathrm{CH_4}}\\nu_{\\mathrm{CH_4}} + a_{\\mathrm{C},\\mathrm{O_2}}\\nu_{\\mathrm{O_2}} + a_{\\mathrm{C},\\mathrm{N_2}}\\nu_{\\mathrm{N_2}} + a_{\\mathrm{C},\\mathrm{CO_2}}\\nu_{\\mathrm{CO_2}} + a_{\\mathrm{C},\\mathrm{H_2O}}\\nu_{\\mathrm{H_2O}} + a_{\\mathrm{C},\\mathrm{CO}}\\nu_{\\mathrm{CO}} \\\\\n= (1)(-1) + (0)(-2) + (0)(0) + (1)(1) + (0)(2) + (0)(0) = -1 + 1 = 0\n$$\n\n**Hydrogen (H):**\n$$\n\\sum_i a_{\\mathrm{H},i} \\nu_i = a_{\\mathrm{H},\\mathrm{CH_4}}\\nu_{\\mathrm{CH_4}} + a_{\\mathrm{H},\\mathrm{H_2O}}\\nu_{\\mathrm{H_2O}} \\\\\n= (4)(-1) + (2)(2) = -4 + 4 = 0\n$$\n\n**Oxygen (O):**\n$$\n\\sum_i a_{\\mathrm{O},i} \\nu_i = a_{\\mathrm{O},\\mathrm{O_2}}\\nu_{\\mathrm{O_2}} + a_{\\mathrm{O},\\mathrm{CO_2}}\\nu_{\\mathrm{CO_2}} + a_{\\mathrm{O},\\mathrm{H_2O}}\\nu_{\\mathrm{H_2O}} \\\\\n= (2)(-2) + (2)(1) + (1)(2) = -4 + 2 + 2 = 0\n$$\nThe verification is successful. For all three elements, the weighted sum of mass source rates vanishes, confirming the validity of the derived $\\beta^{(k)}_i$ coefficients.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7487  0  0  0.2729  0  0.4288  0.2513  0  0  0  0.1119  0  0  1.000  0  0.7271  0.8881  0.5712\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from analytical fundamentals to computational practice, this final exercise challenges you to simulate transient flame phenomena using the unsteady flamelet equation. This powerful equation describes the competition between chemical reaction and diffusion, governed by the scalar dissipation rate, $\\chi$. By implementing a numerical solver, you will investigate flame ignition dynamics, observing how a sudden change in flow conditions can cause a nearly extinguished mixture to transition into a robustly burning flame. This hands-on coding problem provides direct experience with the methods used at the forefront of computational combustion research. ",
            "id": "4062835",
            "problem": "Consider the unsteady Shvab–Zel’dovich formulation for non-premixed flames under the following assumptions: constant density, equal and constant species diffusivities (unity Lewis number), and negligible pressure gradients. Let $Z \\in [0,1]$ denote the conserved mixture fraction. Define a normalized progress variable $C(Z,t)$ that is $0$ in fresh reactants and approaches $1$ in fully reacted products. Starting from the unsteady species conservation equations and the definition of the mixture fraction, transform the governing equations into mixture-fraction space using the Shvab–Zel’dovich change of variables. Under the stated assumptions, derive the unsteady flamelet equation for a generic scalar $\\phi(Z,t)$ of the form\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\chi(Z,t)}{2}\\,\\frac{\\partial^2 \\phi}{\\partial Z^2} + S_{\\phi}(Z,t),\n$$\nwhere $\\chi(Z,t)$ is the scalar dissipation rate and $S_{\\phi}(Z,t)$ is a source term. Then, specialize to a single-reaction, reduced-order model in which the scalar is the progress variable $C(Z,t)$, the scalar dissipation rate is spatially uniform in $Z$ and undergoes a sudden decrease at time $t=0$, and the chemical source term is given by a localized, bounded, autocatalytic form with a stoichiometric center $Z_{\\mathrm{st}}$:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\chi(t)}{2}\\,\\frac{\\partial^2 C}{\\partial Z^2} + \\mathrm{Da}\\,G(Z;Z_{\\mathrm{st}},\\sigma_R)\\,C\\,(1-C),\n$$\nwith Dirichlet boundary conditions $C(0,t)=0$ and $C(1,t)=0$, and an initial condition that represents a nearly extinguished state,\n$$\nC(Z,0) = \\varepsilon\\,G(Z;Z_{\\mathrm{st}},\\sigma_R),\n$$\nwhere $\\varepsilon \\ll 1$, $\\mathrm{Da}  0$ is a Damköhler number, $\\sigma_R  0$ is the localization width of the reaction zone, and\n$$\nG(Z;Z_{\\mathrm{st}},\\sigma_R) = \\exp\\!\\left(-\\frac{(Z-Z_{\\mathrm{st}})^2}{2\\,\\sigma_R^2}\\right).\n$$\nAssume the scalar dissipation rate is spatially uniform in $Z$ and piecewise constant in time,\n$$\n\\chi(t) = \\begin{cases}\n\\chi_{\\mathrm{hi}},  t0,\\\\\n\\chi_{\\mathrm{lo}},  t\\ge 0,\n\\end{cases}\n$$\nand that the system is started at $t=0$ with the nearly extinguished initial condition given above. You are to analyze ignition transients in $Z$-space following the sudden decrease $\\chi_{\\mathrm{hi}} \\to \\chi_{\\mathrm{lo}}$ at $t=0$.\n\nYour task is to implement a numerical solver for the initial-boundary value problem on $Z \\in [0,1]$ and $t \\ge 0$ in dimensionless units. Use a method-of-lines approach: discretize in $Z$ using a second-order central finite difference approximation of the Laplacian with Dirichlet boundary conditions, and integrate in time using a stiff ordinary differential equation solver. Treat the diffusion term implicitly via the stiff solver and compute the nonlinear source term pointwise.\n\nDefine an ignition indicator by\n$$\nI(t) = \\max_{Z \\in [0,1]} C(Z,t).\n$$\nDefine the ignition time $t_{\\mathrm{ign}}$ as the first time $t \\ge 0$ such that $I(t)$ reaches or exceeds a specified threshold $\\theta \\in (0,1)$, i.e.,\n$$\nt_{\\mathrm{ign}} = \\inf \\left\\{ t \\ge 0 \\,:\\, I(t) \\ge \\theta \\right\\}.\n$$\nIf $I(t)$ does not reach $\\theta$ within a specified maximum simulation time $t_{\\max}$, report $t_{\\mathrm{ign}}=-1$.\n\nExpress all times in dimensionless units. Your program must apply the same uniform spatial grid to all test cases and use $\\varepsilon=10^{-4}$ for the initial condition.\n\nImplement your solver and compute $t_{\\mathrm{ign}}$ for the following four test cases, each provided as a tuple of parameters $(\\mathrm{Da},\\chi_{\\mathrm{hi}},\\chi_{\\mathrm{lo}},Z_{\\mathrm{st}},\\sigma_R,\\theta,t_{\\max})$:\n\n- Case A (nominal ignition): $(150.0,\\,8.0,\\,0.8,\\,0.5,\\,0.05,\\,0.5,\\,5.0)$\n- Case B (no ignition within horizon): $(30.0,\\,8.0,\\,3.0,\\,0.5,\\,0.05,\\,0.5,\\,5.0)$\n- Case C (fast ignition with narrow reaction zone): $(200.0,\\,12.0,\\,0.5,\\,0.5,\\,0.03,\\,0.6,\\,3.0)$\n- Case D (borderline ignition): $(80.0,\\,10.0,\\,1.5,\\,0.5,\\,0.05,\\,0.4,\\,5.0)$\n\nYour program should produce a single line of output containing the ignition times for the four test cases as a comma-separated list of floating-point numbers enclosed in square brackets in the order A, B, C, D. Report $t_{\\mathrm{ign}}$ in dimensionless units, rounded to five decimal places for each case. If ignition does not occur by $t_{\\max}$, report $-1.00000$ for that case.\n\nYour implementation must be self-contained and must not require any user input. The numerical method must be robust to parameter variations across the provided test suite while adhering to the stated assumptions and modeling choices.",
            "solution": "The problem asks for the numerical solution of a simplified unsteady flamelet equation, which is a one-dimensional parabolic partial differential equation (PDE), to determine the ignition time for several sets of physical parameters.\n\nFirst, we validate the origin and form of the governing equation. The problem begins with the general conservation equation for a chemical species mass fraction $Y_i$ in a fluid. Under the stated assumptions of constant density $\\rho$ and equal species diffusivities $D_i=D$ (implying unity Lewis numbers), the species transport equation is:\n$$\n\\rho \\frac{\\partial Y_i}{\\partial t} + \\rho \\mathbf{v} \\cdot \\nabla Y_i = -\\nabla \\cdot \\mathbf{j}_i + \\dot{\\omega}_i\n$$\nUsing Fick's law for the diffusive flux, $\\mathbf{j}_i = -\\rho D \\nabla Y_i$, and constant density, this simplifies to:\n$$\n\\frac{\\partial Y_i}{\\partial t} + \\mathbf{v} \\cdot \\nabla Y_i = D \\nabla^2 Y_i + \\frac{\\dot{\\omega}_i}{\\rho}\n$$\nThe Shvab–Zel’dovich formulation introduces a conserved scalar, the mixture fraction $Z$, which has no source term and is governed by:\n$$\n\\frac{\\partial Z}{\\partial t} + \\mathbf{v} \\cdot \\nabla Z = D \\nabla^2 Z\n$$\nA coordinate transformation is applied, from physical coordinates $(\\mathbf{x}, t)$ to mixture fraction coordinates $(Z, t)$. For any scalar quantity $\\phi$ expressed as a function of $Z$ and $t$, its transport equation $\\frac{\\partial \\phi}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\phi = D \\nabla^2 \\phi + S_\\phi$ can be transformed. Using the chain rule, the derivatives are:\n$$\n\\frac{\\partial \\phi}{\\partial t}\\bigg|_{\\mathbf{x}} = \\frac{\\partial \\phi}{\\partial t}\\bigg|_{Z} + \\frac{\\partial \\phi}{\\partial Z}\\frac{\\partial Z}{\\partial t}\\bigg|_{\\mathbf{x}}\n$$\n$$\n\\nabla \\phi = \\frac{\\partial \\phi}{\\partial Z} \\nabla Z\n$$\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial Z^2} (\\nabla Z \\cdot \\nabla Z) + \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z = \\frac{\\partial^2 \\phi}{\\partial Z^2} |\\nabla Z|^2 + \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z\n$$\nSubstituting these into the transport equation for $\\phi$ yields:\n$$\n\\left( \\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial \\phi}{\\partial Z}\\frac{\\partial Z}{\\partial t} \\right) + \\mathbf{v} \\cdot \\left( \\frac{\\partial \\phi}{\\partial Z} \\nabla Z \\right) = D \\left( \\frac{\\partial^2 \\phi}{\\partial Z^2} |\\nabla Z|^2 + \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z \\right) + S_\\phi\n$$\nRearranging and using the transport equation for $Z$ to substitute for the term $\\frac{\\partial Z}{\\partial t} + \\mathbf{v} \\cdot \\nabla Z$:\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial \\phi}{\\partial Z} \\left( D \\nabla^2 Z \\right) = D \\frac{\\partial^2 \\phi}{\\partial Z^2} |\\nabla Z|^2 + D \\frac{\\partial \\phi}{\\partial Z} \\nabla^2 Z + S_\\phi\n$$\nThe terms involving $\\nabla^2 Z$ cancel, leaving:\n$$\n\\frac{\\partial \\phi}{\\partial t} = D |\\nabla Z|^2 \\frac{\\partial^2 \\phi}{\\partial Z^2} + S_\\phi\n$$\nBy defining the scalar dissipation rate as $\\chi(Z,t) = 2D |\\nabla Z|^2$, we arrive at the general form of the unsteady flamelet equation:\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\chi(Z,t)}{2}\\,\\frac{\\partial^2 \\phi}{\\partial Z^2} + S_{\\phi}(Z,t)\n$$\nThis derivation confirms the theoretical soundness of the model provided in the problem.\n\nThe specific problem to be solved is a specialization of this equation for a progress variable $C(Z,t)$ on the domain $Z \\in [0,1]$:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\chi(t)}{2}\\,\\frac{\\partial^2 C}{\\partial Z^2} + \\mathrm{Da}\\,G(Z;Z_{\\mathrm{st}},\\sigma_R)\\,C\\,(1-C)\n$$\nwith boundary conditions $C(0,t)=0$, $C(1,t)=0$, and initial condition $C(Z,0) = \\varepsilon\\,G(Z;Z_{\\mathrm{st}},\\sigma_R)$. For the simulations starting at $t=0$, the scalar dissipation rate is constant, $\\chi(t) = \\chi_{\\mathrm{lo}}$. The parameter $\\chi_{\\mathrm{hi}}$ pertains to the system state before $t=0$ and is not used in the simulation for $t \\ge 0$.\n\nWe solve a this PDE using the method of lines. The spatial domain $Z \\in [0,1]$ is discretized into $N_Z$ uniformly spaced points $Z_j = j \\cdot \\Delta Z$ for $j=0, 1, \\dots, N_Z-1$, where $\\Delta Z = 1/(N_Z-1)$. Let $C_j(t)$ denote the numerical approximation of $C(Z_j, t)$. The second spatial derivative (Laplacian) at the interior grid points ($j=1, \\dots, N_Z-2$) is approximated using a second-order central finite difference scheme:\n$$\n\\left.\\frac{\\partial^2 C}{\\partial Z^2}\\right|_{Z_j} \\approx \\frac{C_{j+1}(t) - 2C_j(t) + C_{j-1}(t)}{(\\Delta Z)^2}\n$$\nThis discretization transforms the single PDE into a system of $N_Z-2$ coupled ordinary differential equations (ODEs) for the interior points. The ODE for each $C_j(t)$ is:\n$$\n\\frac{dC_j}{dt} = \\frac{\\chi_{\\mathrm{lo}}}{2} \\left( \\frac{C_{j+1} - 2C_j + C_{j-1}}{(\\Delta Z)^2} \\right) + \\mathrm{Da}\\,G(Z_j)\\,C_j\\,(1-C_j)\n$$\nThe Dirichlet boundary conditions $C_0(t)=0$ and $C_{N_Z-1}(t)=0$ are enforced directly in the equations for $C_1$ and $C_{N_Z-2}$.\n\nThis system of ODEs is known to be stiff due to the strong coupling introduced by the discretized diffusion term, especially for fine grids (small $\\Delta Z$). We use a suitable stiff ODE solver, `scipy.integrate.solve_ivp` with the `BDF` (Backward Differentiation Formula) method, to integrate the system in time from $t=0$ to $t=t_{\\max}$.\n\nThe ignition time, $t_{\\mathrm{ign}}$, is defined as the first time $t \\ge 0$ at which the ignition indicator $I(t) = \\max_{Z \\in [0,1]} C(Z,t)$ reaches a given threshold $\\theta$. This is implemented using the event detection capability of the ODE solver. We define an event function $e(t, \\mathbf{C}) = \\max(\\mathbf{C}) - \\theta$, where $\\mathbf{C}$ is the vector of interior $C_j$ values. The solver is configured to find the root of this function (where $e=0$) and terminate the integration. The time of this event is $t_{\\mathrm{ign}}$. If the integration completes up to $t_{\\max}$ without the event occurring, it signifies failed ignition, and $t_{\\mathrm{ign}}$ is reported as $-1$.\n\nFor the numerical implementation, a sufficiently fine grid with $N_Z=401$ points is used to ensure resolution of the narrow reaction zones, particularly in Case C. The initial condition is evaluated on this grid using the prescribed value of $\\varepsilon=10^{-4}$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the unsteady flamelet equation for ignition transients.\n    \"\"\"\n    test_cases = [\n        # (Da, chi_hi, chi_lo, Z_st, sigma_R, theta, t_max)\n        (150.0, 8.0, 0.8, 0.5, 0.05, 0.5, 5.0),    # Case A\n        (30.0, 8.0, 3.0, 0.5, 0.05, 0.5, 5.0),    # Case B\n        (200.0, 12.0, 0.5, 0.5, 0.03, 0.6, 3.0),    # Case C\n        (80.0, 10.0, 1.5, 0.5, 0.05, 0.4, 5.0),    # Case D\n    ]\n\n    # Shared numerical parameters as per problem description\n    N_Z = 401\n    epsilon = 1e-4\n\n    # Set up the uniform spatial grid for all cases\n    Z_grid = np.linspace(0.0, 1.0, N_Z)\n    dZ = Z_grid[1] - Z_grid[0]\n    Z_interior = Z_grid[1:-1]\n\n    results = []\n\n    for case in test_cases:\n        Da, chi_hi, chi_lo, Z_st, sigma_R, theta, t_max = case\n        \n        # Pre-calculate the Gaussian part of the source term and initial condition\n        G_Z = np.exp(-(Z_grid - Z_st)**2 / (2.0 * sigma_R**2))\n        G_interior = G_Z[1:-1]\n        \n        # Initial condition for the progress variable C at t=0\n        C0 = epsilon * G_Z\n        y0 = C0[1:-1]  # State vector for interior points\n\n        def rhs(t, y):\n            \"\"\"\n            Right-hand side of the ODE system from method-of-lines.\n            y is the vector of C values at the interior grid points.\n            \"\"\"\n            # Reconstruct the full vector C including boundaries\n            C_full = np.concatenate(([0.0], y, [0.0]))\n            \n            # 1. Diffusion term (discretized Laplacian)\n            laplacian = (C_full[2:] - 2.0 * C_full[1:-1] + C_full[:-2]) / (dZ**2)\n            diffusion_term = (chi_lo / 2.0) * laplacian\n            \n            # 2. Source term\n            source_term = Da * G_interior * y * (1.0 - y)\n            \n            return diffusion_term + source_term\n\n        def ignition_event(t, y):\n            \"\"\"\n            Event function to detect ignition.\n            Triggers when max(C) reaches the threshold theta.\n            \"\"\"\n            return np.max(y) - theta\n        \n        ignition_event.terminal = True  # Stop integration when event occurs\n        ignition_event.direction = 1    # Trigger only when value increases past zero\n\n        # Solve the initial value problem\n        sol = solve_ivp(\n            fun=rhs,\n            t_span=(0, t_max),\n            y0=y0,\n            method='BDF',  # Stiff solver\n            events=ignition_event,\n            dense_output=True, # For accurate event location\n            rtol=1e-6,\n            atol=1e-9\n        )\n\n        # Determine ignition time from a successful event detection\n        # sol.status == 1 means an event terminated the integration.\n        if sol.status == 1 and sol.t_events[0].size > 0:\n            t_ign = sol.t_events[0][0]\n        else:\n            # No ignition within t_max or solver failed\n            t_ign = -1.0\n        \n        results.append(t_ign)\n\n    # Format output to 5 decimal places as required\n    formatted_results = [f\"{r:.5f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```"
        }
    ]
}