{
    "hands_on_practices": [
        {
            "introduction": "在编写任何代码之前，正确地建立数学模型是至关重要的一步。本练习旨在挑战您区分燃烧器稳定火焰与自由传播火焰的边界条件和稳定判据，这是计算燃烧学中的一个基本概念。理解这种区别是建立有效模型的首要步骤。",
            "id": "4010680",
            "problem": "一维稳态预混火焰可以在计算燃烧学中使用的两种典型配置中进行建模：一种是锚定在固体燃烧器上的燃烧器稳定火焰，另一种是没有固体锚定面的自由传播火焰。两者都受多组分反应混合物的质量、组分和能量守恒定律支配。设 $x$ 表示轴向坐标，$\\rho$ 表示密度，$u$ 表示轴向速度，$Y_k$ 表示组分 $k$ 的质量分数，$J_k$ 表示组分 $k$ 的扩散质量通量，$\\dot{\\omega}_k$ 表示组分 $k$ 的化学生成速率，$T$ 表示温度，$\\lambda$ 表示热导率，$h$ 表示传热系数，$T_w$ 表示燃烧器壁面温度，$T_u$ 表示未燃气体温度，$S_L$ 表示层流燃烧速度。在这两种配置中，稳态守恒方程在混合物平均扩散闭合模型下，沿 $x$ 轴简化为以下形式：质量守恒 $d(\\rho u)/dx = 0$；组分守恒 $\\rho u \\, dY_k/dx + dJ_k/dx = \\dot{\\omega}_k$；以及能量守恒 $\\rho u \\, c_p \\, dT/dx - d(\\lambda \\, dT/dx)/dx = -\\sum_k h_k \\dot{\\omega}_k + \\text{diffusive enthalpy terms}$，其中 $c_p$ 是定压比热，$h_k$ 是组分 $k$ 的比焓。\n\n选择一个选项，该选项以物理上一致的数学形式，正确且完整地对比了这两种配置的适用边界条件和稳定或传播准则。\n\nA. 燃烧器稳定火焰：有限域 $x \\in [0,L]$，在 $x=0$ 处有一个固体燃烧器。在燃烧器处施加一个热边界，可以是狄利克雷条件 $T(0)=T_w$，也可以是罗宾条件 $-\\lambda \\, \\frac{dT}{dx}\\big|_{x=0} = h \\, [\\,T(0)-T_w\\,]$。在燃烧器处施加零法向组分通量，$J_k(0)=0$ 对于所有 $k$。通过固定质量通量来指定入流，即 $u(0)=u_{\\text{in}}$，因此 $m=\\rho u$ 由 $d(\\rho u)/dx=0$ 确定。在出口 $x=L$ 处，应用开放边界 $\\frac{dT}{dx}(L)=0$ 和 $\\frac{dY_k}{dx}(L)=0$，以使解平滑地流出。稳定准则：当施加的对流入流与混合物在损失和应变环境下的有效燃烧能力相匹配时，即 $u_{\\text{in}} = S_L^{\\text{eff}}$，火焰在实验室坐标系中是静止的；如果 $u_{\\text{in}}  S_L^{\\text{eff}}$，火焰发生回火，而如果 $u_{\\text{in}} > S_L^{\\text{eff}}$，则发生吹熄。自由传播火焰：在一个以未知速度 $S_L$ 移动的坐标系中的无限或足够大的域。上游远场狄利克雷条件在 $x \\to -\\infty$ 处：$T(-\\infty)=T_u$ 和 $Y_k(-\\infty)=Y_{k,u}$。下游远场在 $x \\to +\\infty$ 处趋于平衡且梯度为零：$\\frac{dT}{dx}(+\\infty)=0$ 和 $\\frac{dY_k}{dx}(+\\infty)=0$。传播准则：$S_L$ 是一个特征值，它是在同时满足两个远场条件和 $d(\\rho u)/dx=0$ 时产生的。\n\nB. 自由传播火焰：有限域，在 $x=0$ 处有冷壁，满足 $T(0)=T_w$ 和 $J_k(0)=0$，以及一个给定的入口 $u(0)=u_{\\text{in}}$，而 $S_L$ 是从 $m=\\rho u$ 事后计算得出。燃烧器稳定火焰：在移动坐标系中建模，具有未知的 $S_L$，上游为狄利克雷未燃条件，下游为零梯度条件。\n\nC. 燃烧器稳定火焰：在壁面施加狄利克雷组分组成 $Y_k(0)=Y_{k,u}$ 和一个绝热壁条件 $-\\lambda \\frac{dT}{dx}\\big|_{x=0}=0$；当上游温度梯度为零时，$\\frac{dT}{dx}(0)=0$，火焰是静止的。自由传播火焰：在下游施加已燃状态的狄利克雷值 $Y_k(+\\infty)=Y_{k,b}$ 和 $T(+\\infty)=T_b$，并将 $S_L = u_{\\text{in}}$ 作为从入流中已知的量。\n\nD. 自由传播火焰：在上游和下游都施加狄利克雷条件，$T(-\\infty) = T_u$，$Y_k(-\\infty)=Y_{k,u}$，$T(+\\infty)=T_b$，$Y_k(+\\infty)=Y_{k,b}$，并指定 $S_L$ 为 $S_L = m/\\rho_u$，其中 $\\rho_u$ 是上游密度。燃烧器稳定火焰：在燃烧器处施加零梯度条件，$\\frac{dT}{dx}(0)=0$ 和 $\\frac{dY_k}{dx}(0)=0$，并调整一个未知的入流 $u(0)$ 以使火焰保持在 $x=0$ 处。",
            "solution": "该问题陈述被评估为**有效**。它具有科学依据，提法恰当，客观，并提出了计算燃烧理论中一个标准的、非平凡的问题。所描述的控制方程和物理情景——燃烧器稳定火焰和自由传播火焰——是典型的模型。该问题要求对这两个问题的数学表述进行清晰而精确的区分，这是该领域的一个基本概念。所提供的信息是自洽的并且足以回答问题。\n\n问题的核心是区分两种基本的一维（$1$D）预混火焰模型的数学设置。\n\n**1. 燃烧器稳定火焰**\n\n这种配置模拟了一个在实验室坐标系中被固体物体（通常是多孔塞式燃烧器，预混的燃料-氧化剂混合物通过它流动）保持静止的火焰。\n\n*   **控制方程和参考系**：该问题在静止（实验室）参考系中求解。火焰相对于燃烧器位于一个固定位置，燃烧器放置在一个边界上，例如 $x=0$。质量、组分和能量的控制方程在有限域 $x \\in [0, L]$ 上求解。\n*   **关键参数**：单位面积的质量流率 $m = \\rho u$ 在整个域中是一个常数，因为 $d(\\rho u)/dx = 0$。在这种配置中，$m$ 是一个*指定的输入参数*。实验者或计算科学家设定入口速度 $u_{\\text{in}}$ 和混合物性质，从而固定了 $m$。\n*   **边界条件**：\n    *   在入流/燃烧器表面 ($x=0$): a) 速度是指定的，$u(0)=u_{\\text{in}}$。 b) 需要一个热边界条件来解释气体和固体燃烧器之间的传热。这可以是一个狄利克雷条件，指定温度 $T(0)=T_w$，或者更一般地，一个模拟热损失的罗宾条件，例如 $-\\lambda \\frac{dT}{dx}\\big|_{x=0} = h (T(0) - T_w)$，其中 $h$ 是传热系数，$T_w$ 是燃烧器冷却剂温度。绝热情况 $\\frac{dT}{dx}\\big|_{x=0} = 0$ 是没有热损失的特例。 c) 必须设置组分边界条件。对于惰性、非催化、不可渗透的燃烧器表面，每个组分到壁面的净通量为零。一个常见且物理上合理的边界条件是设置扩散质量通量为零，$J_k(0) = 0$ 对于所有组分 $k$。\n    *   在出口 ($x=L$): 计算域必须足够长，以使燃烧完全（或接近完全）。为防止边界对解产生人为影响，应用“开放”或“软”边界条件。这些通常是零梯度（诺伊曼）条件：$\\frac{dT}{dx}(L)=0$ 和 $\\frac{dY_k}{dx}(L)=0$。\n*   **稳定准则**：这是一个边值问题。对于给定的一组参数（入流质量通量 $m$、未燃混合物性质、燃烧器热性质），求解稳态分布 $T(x)$ 和 $Y_k(x)$。物理上稳定的火焰对应于稳态解的存在。从物理上理解，稳定是施加的流速与火焰传播趋势之间的平衡。对于给定的混合物，存在一个流速范围，在此范围内存在稳定的火焰。如果流速太慢，火焰会回火（向上游传播）；如果流速太快，它会吹熄（被对流带走）。\n\n**2. 自由传播火焰**\n\n这种配置模拟了一个理想化的平面火焰，自由地传播到静止、均匀的未燃混合物中，远离任何墙壁或约束表面。\n\n*   **控制方程和参考系**：该问题最方便在随火焰锋面移动的参考系中求解。在此参考系中，火焰是静止的，未燃气体以层流燃烧速度 $S_L$ 从 $x \\to -\\infty$ 流向它。已燃产物向 $x \\to +\\infty$ 流走。理论上，域是无限的，$x \\in (-\\infty, +\\infty)$。\n*   **关键参数**：质量流率 $m = \\rho u$ 再次为常数。然而，在这种配置中，$m$ 不是一个指定的参数。它是问题的一个*未知特征值*。然后从该特征值确定层流燃烧速度为 $S_L = m/\\rho_u$，其中 $\\rho_u$ 是未燃气体的密度。\n*   **边界条件**：\n    *   在上游远场 ($x \\to -\\infty$): 流体是未燃混合物。应用狄利克雷条件：$T(-\\infty)=T_u$ 和 $Y_k(-\\infty)=Y_{k,u}$。\n    *   在下游远场 ($x \\to +\\infty$): 燃烧完成，气体处于化学平衡状态。所有梯度必须为零。应用诺伊曼条件：$\\frac{dT}{dx}(+\\infty)=0$ 和 $\\frac{dY_k}{dx}(+\\infty)=0$。\n*   **传播准则**：受 $\\pm\\infty$ 处的两点边界条件约束的常微分控制方程组构成一个非线性特征值问题。一个非平凡解（即火焰剖面）仅对一个唯一的、特定的质量通量 $m$ 值存在。找到这个特征值是计算的主要目标，因为它决定了混合物的基本性质，即层流燃烧速度 $S_L$。\n\n基于此分析，我们评估各个选项。\n\n**选项 A**\n*   **燃烧器稳定火焰描述**：正确地识别了有限域 $[0,L]$ 和在 $x=0$ 处的燃烧器。它正确地列出了标准热边界条件（狄利克雷 $T(0)=T_w$ 或罗宾 $-\\lambda \\frac{dT}{dx}|_{x=0} = h[T(0)-T_w]$）和标准组分条件（$J_k(0)=0$）。它正确地指出质量通量 $m$ 由固定的入流 $u(0)=u_{\\text{in}}$ 确定。它正确地将出口条件识别为零梯度，$\\frac{dT}{dx}(L)=0$ 和 $\\frac{dY_k}{dx}(L)=0$。对稳定的物理解释也是正确的。\n*   **自由传播火焰描述**：正确地识别了移动坐标系和无限域。它正确地指定了上游狄利克雷条件（$T(-\\infty)=T_u$, $Y_k(-\\infty)=Y_{k,u}$）和下游零梯度条件（$\\frac{dT}{dx}(+\\infty)=0$, $\\frac{dY_k}{dx}(+\\infty)=0$）。至关重要的是，它正确地将 $S_L$（通过质量通量 $m$）识别为满足边界条件而产生的特征值。\n*   **结论**：该选项准确且完整地对比了两种配置。**正确**。\n\n**选项 B**\n*   该选项错误地交换了两种火焰类型的描述。它将“冷壁”和“指定入口”归于自由传播火焰，而根据定义，自由传播火焰没有壁面。它将“具有未知 $S_L$ 的移动坐标系”归于燃烧器稳定火焰，这是不正确的。\n*   **结论**：**不正确**。\n\n**选项 C**\n*   **燃烧器稳定火焰描述**：它错误地提出在壁面施加狄利克雷组分组成 $Y_k(0)=Y_{k,u}$，这是一个可能但不太通用且在物理上有问题的条件。它将热条件仅限于绝热情况，这不具有普遍性。其稳定准则 $\\frac{dT}{dx}(0)=0$ 仅仅是绝热边界条件本身，而不是稳定准则。\n*   **自由传播火焰描述**：它错误地提出在下游施加已燃状态的狄利克雷值 $Y_{k,b}$ 和 $T_{b}$。这会过度约束问题；已燃状态是计算的结果，而不是输入。它还错误地指出 $S_L$ 是一个已知量。\n*   **结论**：**不正确**。\n\n**选项 D**\n*   **自由传播火焰描述**：与选项 C 一样，它错误地在下游边界施加狄利克雷条件，这是一个根本性错误。它还错误地暗示 $S_L$ 或 $m$ 是一个指定的量。\n*   **燃烧器稳定火焰描述**：它错误地指出在燃烧器处施加零梯度条件；非绝热燃烧器（这是普遍情况）具有非零的温度梯度。它还错误地声称入流 $u(0)$ 是未知且可调整的；在标准公式中，入流质量通量是一个固定的输入参数。\n*   **结论**：**不正确**。\n\n总之，选项 A 是唯一一个在两种典型火焰模型之间进行物理上和数学上合理对比的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "燃烧器稳定火焰的一个决定性特征是与燃烧器表面的热交换，这既稳定了火焰，也影响了其结构和温度。本练习提供了一个动手实践的机会，使用标准的工程模型来估算传导和辐射热损失的相对重要性。这类分析对于理解主导物理过程和验证更复杂的模拟至关重要。",
            "id": "4010681",
            "problem": "考虑一个一维、稳态、由燃烧器稳定的、在标准大气压下的化学计量甲烷-空气平面火焰，该火焰附着于一个等温多孔燃烧器上。假设在近壁区域，气体温度在一个传导长度尺度上从燃烧器表面温度近似线性增加到热核心区温度。气体也作为一个灰体介质向燃烧器表面辐射，其有效灰体气体发射率代表了高温和一个大气压下的二氧化碳和水蒸气。\n\n使用以下具有科学真实性的代表性数据：\n- 火焰核心区的最高气体温度：$T_{\\max} = 2200\\ \\mathrm{K}$。\n- 燃烧器表面（壁面）温度：$T_{w} = 800\\ \\mathrm{K}$。\n- 近壁温度近似线性上升的传导长度尺度：$\\delta_{c} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$。\n- 与温度相关的混合物热导率（在 $800\\ \\mathrm{K}$ 到 $2200\\ \\mathrm{K}$ 范围内有效）：$\\lambda(T) = 2.6 \\times 10^{-2} + 4.9 \\times 10^{-5}\\, T$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 向燃烧器辐射的热产物层的有效灰体气体发射率：$\\varepsilon_{g} = 0.03$。\n- 斯蒂芬-玻尔兹曼常数：$\\sigma = 5.670 \\times 10^{-8}\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$。\n\n将燃烧器处的传导热通量大小建模为 $q''_{\\mathrm{cond}} = \\lambda(T_{m})\\, (T_{\\max} - T_{w})/\\delta_{c}$，其中 $T_{m}$ 是 $T_{w}$ 和 $T_{\\max}$ 之间的算术平均温度。将从气体到燃烧器的辐射热通量大小建模为 $q''_{\\mathrm{rad}} = \\varepsilon_{g}\\, \\sigma\\, \\big(T_{\\max}^{4} - T_{w}^{4}\\big)$。\n\n计算比率 $R \\equiv q''_{\\mathrm{rad}}/q''_{\\mathrm{cond}}$。将最终答案表示为一个无量纲数，并四舍五入到三位有效数字。",
            "solution": "首先对问题陈述进行严格的验证程序。\n\n**步骤 1：提取给定条件**\n给定条件从问题陈述中逐字提取：\n- 火焰核心区的最高气体温度：$T_{\\max} = 2200\\ \\mathrm{K}$。\n- 燃烧器表面（壁面）温度：$T_{w} = 800\\ \\mathrm{K}$。\n- 传导长度尺度：$\\delta_{c} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$。\n- 与温度相关的混合物热导率：$\\lambda(T) = 2.6 \\times 10^{-2} + 4.9 \\times 10^{-5}\\, T$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 有效灰体气体发射率：$\\varepsilon_{g} = 0.03$。\n- 斯蒂芬-玻尔兹曼常数：$\\sigma = 5.670 \\times 10^{-8}\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$。\n- 传导热通量大小的模型：$q''_{\\mathrm{cond}} = \\lambda(T_{m})\\, (T_{\\max} - T_{w})/\\delta_{c}$。\n- 用于计算热导率的平均温度的定义：$T_{m}$ 是 $T_{w}$ 和 $T_{\\max}$ 之间的算术平均温度。\n- 辐射热通量大小的模型：$q''_{\\mathrm{rad}} = \\varepsilon_{g}\\, \\sigma\\, \\big(T_{\\max}^{4} - T_{w}^{4}\\big)$。\n- 目标是计算比率 $R \\equiv q''_{\\mathrm{rad}}/q''_{\\mathrm{cond}}$。\n\n**步骤 2：使用提取的给定条件进行验证**\n- **科学依据**：该问题描述了从火焰到燃烧器的传热，这是燃烧科学中的一个常见情景。所提供的传导和辐射传热模型是标准的工程近似，尽管有所简化。在传热分析中，使用特征长度上的线性温度分布来计算传导（傅里叶定律的近似）以及使用灰体模型计算辐射是公认的方法。所提供的温度、材料特性和物理常数的数值对于标准大气压下的化学计量甲烷-空气火焰是符合实际的。\n- **适定性**：问题被完全指定。它提供了计算两种热通量及其比率所需的所有数值数据和明确公式。该任务是一个直接的计算，可以得出一个唯一且有意义的结果。\n- **客观性**：问题以精确、定量的语言陈述，没有任何主观性或模糊性。\n\n**步骤 3：结论与行动**\n该问题具有科学依据、适定、客观且完整。它没有任何指定的缺陷。因此，该问题被认为是**有效的**，并将提供解答。\n\n目标是计算比率 $R$，定义为：\n$$\nR = \\frac{q''_{\\mathrm{rad}}}{q''_{\\mathrm{cond}}}\n$$\n这需要分别计算辐射热通量 $q''_{\\mathrm{rad}}$ 和传导热通量 $q''_{\\mathrm{cond}}$。\n\n首先，我们使用提供的公式和数据计算辐射热通量的大小 $q''_{\\mathrm{rad}}$：\n$$\nq''_{\\mathrm{rad}} = \\varepsilon_{g}\\, \\sigma\\, \\big(T_{\\max}^{4} - T_{w}^{4}\\big)\n$$\n代入给定值：\n- $\\varepsilon_{g} = 0.03$\n- $\\sigma = 5.670 \\times 10^{-8}\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$\n- $T_{\\max} = 2200\\ \\mathrm{K}$\n- $T_{w} = 800\\ \\mathrm{K}$\n\n我们计算温度的四次方：\n$$\nT_{\\max}^{4} = (2200)^{4}\\ \\mathrm{K}^{4} = 2.34256 \\times 10^{13}\\ \\mathrm{K}^{4}\n$$\n$$\nT_{w}^{4} = (800)^{4}\\ \\mathrm{K}^{4} = 4.096 \\times 10^{11}\\ \\mathrm{K}^{4} = 0.04096 \\times 10^{13}\\ \\mathrm{K}^{4}\n$$\n差值为：\n$$\nT_{\\max}^{4} - T_{w}^{4} = (2.34256 - 0.04096) \\times 10^{13}\\ \\mathrm{K}^{4} = 2.3016 \\times 10^{13}\\ \\mathrm{K}^{4}\n$$\n现在，我们计算 $q''_{\\mathrm{rad}}$：\n$$\nq''_{\\mathrm{rad}} = (0.03) \\times (5.670 \\times 10^{-8}\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}) \\times (2.3016 \\times 10^{13}\\ \\mathrm{K}^{4})\n$$\n$$\nq''_{\\mathrm{rad}} \\approx 39148.15\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n\n接下来，我们使用其指定模型计算传导热通量的大小 $q''_{\\mathrm{cond}}$：\n$$\nq''_{\\mathrm{cond}} = \\lambda(T_{m})\\, \\frac{T_{\\max} - T_{w}}{\\delta_{c}}\n$$\n这需要在算术平均温度 $T_{m}$ 下计算热导率 $\\lambda$。\n首先，计算 $T_m$：\n$$\nT_{m} = \\frac{T_{w} + T_{\\max}}{2} = \\frac{800\\ \\mathrm{K} + 2200\\ \\mathrm{K}}{2} = \\frac{3000\\ \\mathrm{K}}{2} = 1500\\ \\mathrm{K}\n$$\n现在，使用给定的线性函数计算热导率 $\\lambda(T_{m})$：\n$$\n\\lambda(T) = 2.6 \\times 10^{-2} + 4.9 \\times 10^{-5}\\, T\n$$\n$$\n\\lambda(1500\\ \\mathrm{K}) = 2.6 \\times 10^{-2} + 4.9 \\times 10^{-5} \\times 1500\n$$\n$$\n\\lambda(1500\\ \\mathrm{K}) = 0.026 + 0.0735 = 0.0995\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}\n$$\n现在我们可以使用剩余的给定值计算 $q''_{\\mathrm{cond}}$：\n- $\\Delta T = T_{\\max} - T_{w} = 2200\\ \\mathrm{K} - 800\\ \\mathrm{K} = 1400\\ \\mathrm{K}$\n- $\\delta_{c} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$\n$$\nq''_{\\mathrm{cond}} = (0.0995\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}) \\times \\frac{1400\\ \\mathrm{K}}{5.0 \\times 10^{-4}\\ \\mathrm{m}}\n$$\n$$\nq''_{\\mathrm{cond}} = \\frac{139.3}{0.0005}\\ \\mathrm{W}\\,\\mathrm{m}^{-2} = 278600\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n\n最后，我们计算比率 $R$：\n$$\nR = \\frac{q''_{\\mathrm{rad}}}{q''_{\\mathrm{cond}}} = \\frac{39148.15}{278600} \\approx 0.1405174\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nR \\approx 0.141\n$$\n该结果表明，在指定的条件和模型假设下，近壁区域的传热以传导为主，辐射传热约占向燃烧器表面传导传热的 $14\\%$。",
            "answer": "$$\n\\boxed{0.141}\n$$"
        },
        {
            "introduction": "最后的步骤是将模型转化为代码并确保其正确性。本练习将指导您完成一个简化火焰的组分守恒方程的数值求解过程，并且关键在于，验证您的数值解是否遵循了质量守恒的基本原则。这项实践对于开发稳健可靠的计算工具至关重要。",
            "id": "4010716",
            "problem": "考虑一个一维、稳态、由燃烧器稳定的、具有恒定横截面积的平面预混火焰，沿轴向坐标 $x \\in [0,L]$ 建模，其中 $L$ 的单位是米。假设密度 $\\rho$ 恒定，且每个组分 $k$ 遵循混合平均 Fickian 扩散，具有恒定的类二元扩散有效扩散系数 $D_k$。设轴向速度为 $u(x)$，单位为米/秒。定义组分质量分数 $Y_k(x)$、扩散质量通量 $J_k(x)$（在 $+x$ 方向为正）以及净体积质量源项 $\\dot{\\omega}_k(x)$，单位为千克/立方米·秒。稳态下的组分守恒方程为\n$$\n\\frac{d}{dx}\\left(\\rho\\,u(x)\\,Y_k(x) - J_k(x)\\right) = \\dot{\\omega}_k(x),\n$$\n其混合平均扩散闭合模型为\n$$\nJ_k(x) = -\\rho\\,D_k\\,\\frac{dY_k}{dx}.\n$$\n施加边界条件 $Y_k(0)=Y_{k,\\text{in}}$（Dirichlet 入口）和 $\\frac{dY_k}{dx}(L)=0$（Neumann 出口，零梯度）。在整个域上，每个组分的守恒积分表达式为\n$$\n\\left[\\rho\\,u(L)\\,Y_k(L) - J_k(L)\\right] - \\left[\\rho\\,u(0)\\,Y_k(0) - J_k(0)\\right] = \\int_0^L \\dot{\\omega}_k(x)\\,dx.\n$$\n等效地，\n$$\n\\underbrace{\\left(\\rho\\,u(0)\\,Y_k(0) - J_k(0)\\right) - \\left(\\rho\\,u(L)\\,Y_k(L) - J_k(L)\\right)}_{\\text{流入减去流出，单位为 } \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}} = -\\int_0^L \\dot{\\omega}_k(x)\\,dx.\n$$\n\n你需要对代表氢气燃烧的单步反应中的燃料和主要产物，数值验证该积分守恒，\n$$\n\\mathrm{H}_2 + \\tfrac{1}{2}\\,\\mathrm{O}_2 \\to \\mathrm{H}_2\\mathrm{O},\n$$\n使用一个给定的摩尔反应速率剖面 $r(x)$（单位为摩尔/立方米·秒），并通过摩尔质量将其转换为质量源项。使用以下摩尔质量：$W_{\\mathrm{H}_2} = 0.002\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$，$W_{\\mathrm{O}_2} = 0.032\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$，以及 $W_{\\mathrm{H}_2\\mathrm{O}} = 0.018\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$。组分质量源项为\n$$\n\\dot{\\omega}_{\\mathrm{H}_2}(x) = -1\\cdot W_{\\mathrm{H}_2}\\,r(x),\\quad\n\\dot{\\omega}_{\\mathrm{O}_2}(x) = -\\tfrac{1}{2}\\cdot W_{\\mathrm{O}_2}\\,r(x),\\quad\n\\dot{\\omega}_{\\mathrm{H}_2\\mathrm{O}}(x) = +1\\cdot W_{\\mathrm{H}_2\\mathrm{O}}\\,r(x),\n$$\n使得 $\\dot{\\omega}_{\\mathrm{H}_2}(x)+\\dot{\\omega}_{\\mathrm{O}_2}(x)+\\dot{\\omega}_{\\mathrm{H}_2\\mathrm{O}}(x)=0$ 逐点成立。\n\n离散化以下边值问题\n$$\n\\rho\\,u(x)\\,\\frac{dY_k}{dx} + \\rho\\,D_k\\,\\frac{d^2 Y_k}{dx^2} = \\dot{\\omega}_k(x)\n$$\n在均匀网格上，对内部点使用二阶中心差分，并在边界上强制施加 $Y_k(0)=Y_{k,\\text{in}}$ 和 $\\frac{dY_k}{dx}(L)=0$。计算 $J_k(x)$，并评估边界通量 $\\rho\\,u(0)\\,Y_k(0)-J_k(0)$ 和 $\\rho\\,u(L)\\,Y_k(L)-J_k(L)$，两者的单位均为千克/平方米·秒。使用梯形法则数值计算 $-\\int_0^L \\dot{\\omega}_k(x)\\,dx$。对于每个组分 $k\\in\\{\\mathrm{H}_2,\\mathrm{O}_2,\\mathrm{H}_2\\mathrm{O}\\}$，验证流入量减去流出量是否在数值容差范围内等于净消耗/生成量。\n\n单位：所有通量的单位必须是 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，扩散系数的单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，密度的单位是 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，速度的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。不使用角度。数值验证的输出必须是布尔值。\n\n测试套件：实现以下三种情况。在每种情况下，摩尔反应速率是一个高斯剖面\n$$\nr(x) = r_0\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\,\\sigma^2}\\right),\n$$\n参数如下。\n\n- 情况1（基准，稳态均匀流）：\n  - $L = 0.020\\ \\mathrm{m}$，$N = 401$ 网格点，$\\rho = 1.000\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n  - $u(x) = 0.050\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$ （恒定）。\n  - $D_{\\mathrm{H}_2} = 7.0\\times 10^{-5}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{O}_2} = 3.0\\times 10^{-5}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{H}_2\\mathrm{O}} = 4.0\\times 10^{-5}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n  - $Y_{\\mathrm{H}_2,\\text{in}} = 0.080$，$Y_{\\mathrm{O}_2,\\text{in}} = 0.200$，$Y_{\\mathrm{H}_2\\mathrm{O},\\text{in}} = 0.000$。\n  - $r_0 = 15.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，$x_0 = 0.010\\ \\mathrm{m}$，$\\sigma = 0.002\\ \\mathrm{m}$。\n\n- 情况2（边界情况，无反应）：\n  - 与情况1中的 $L$、$N$、$\\rho$、$u(x)$、$D_k$ 和 $Y_{k,\\text{in}}$ 相同。\n  - $r_0 = 0.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，$x_0 = 0.010\\ \\mathrm{m}$，$\\sigma = 0.002\\ \\mathrm{m}$。\n\n- 情况3（可变速度和扩散系数）：\n  - $L = 0.015\\ \\mathrm{m}$，$N = 301$ 网格点，$\\rho = 1.100\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n  - $u(x) = 0.040 + 0.040\\,x/L\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$ （线性增加）。\n  - $D_{\\mathrm{H}_2} = 1.0\\times 10^{-4}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{O}_2} = 4.0\\times 10^{-5}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$D_{\\mathrm{H}_2\\mathrm{O}} = 5.0\\times 10^{-5}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n  - $Y_{\\mathrm{H}_2,\\text{in}} = 0.060$，$Y_{\\mathrm{O}_2,\\text{in}} = 0.220$，$Y_{\\mathrm{H}_2\\mathrm{O},\\text{in}} = 0.000$。\n  - $r_0 = 20.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，$x_0 = 0.012\\ \\mathrm{m}$，$\\sigma = 0.0015\\ \\mathrm{m}$。\n\n对于每种情况和每个组分，计算一个布尔值，以指示\n$\n\\left(\\rho\\,u(0)\\,Y_k(0) - J_k(0)\\right) - \\left(\\rho\\,u(L)\\,Y_k(L) - J_k(L)\\right)\n$\n是否等于\n$\n-\\int_0^L \\dot{\\omega}_k(x)\\,dx\n$，容差为相对误差 $10^{-6}$ 和绝对误差 $10^{-9}$（单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n[\\text{情况 }1:\\ \\mathrm{H}_2,\\ \\mathrm{O}_2,\\ \\mathrm{H}_2\\mathrm{O},\\ \\text{情况 }2:\\ \\mathrm{H}_2,\\ \\mathrm{O}_2,\\ \\mathrm{H}_2\\mathrm{O},\\ \\text{情况 }3:\\ \\mathrm{H}_2,\\ \\mathrm{O}_2,\\ \\mathrm{H}_2\\mathrm{O}],\n$$\n例如，$[{\\tt True},{\\tt False},\\dots]$。",
            "solution": "问题陈述是有效的。它提出了一个源于计算燃烧学领域、有科学依据且适定的边值问题。所有必要的数据和条件都已提供，不存在矛盾或歧义。任务是数值求解一组线性常微分方程，并验证数值解是否满足原始守恒定律的积分形式，这是数值分析中的一个标准验证程序。\n\n问题的核心是求解每个组分 $k \\in \\{\\mathrm{H}_2, \\mathrm{O}_2, \\mathrm{H}_2\\mathrm{O}\\}$ 的稳态一维组分输运方程。将 Fickian 扩散定律 $J_k(x) = -\\rho D_k \\frac{dY_k}{dx}$ 代入一般守恒方程，我们得到关于质量分数 $Y_k(x)$ 的二阶线性常微分方程（ODE）：\n$$\n\\rho D_k \\frac{d^2 Y_k}{dx^2} + \\rho u(x) \\frac{d Y_k}{dx} = \\dot{\\omega}_k(x)\n$$\n该 ODE 是在域 $x \\in [0, L]$ 上的一个边值问题（BVP），服从以下边界条件：\n$$\nY_k(0) = Y_{k,\\text{in}} \\quad (\\text{Dirichlet 入口})\n$$\n$$\n\\frac{dY_k}{dx}(L) = 0 \\quad (\\text{Neumann 出口})\n$$\n\n为数值求解此 BVP，我们采用有限差分法，在一个包含 $N$ 个点 $x_i = i \\cdot \\Delta x$（其中 $i=0, 1, \\dots, N-1$）的均匀网格上进行，网格间距为 $\\Delta x = L/(N-1)$。令 $Y_{k,i}$ 为 $Y_k(x_i)$ 的数值近似。\n\n在内部网格点 $x_i$（对于 $i=1, \\dots, N-2$），一阶和二阶导数使用二阶中心差分格式近似：\n$$\n\\frac{dY_k}{dx}\\bigg|_{x_i} \\approx \\frac{Y_{k,i+1} - Y_{k,i-1}}{2\\Delta x}\n$$\n$$\n\\frac{d^2 Y_k}{dx^2}\\bigg|_{x_i} \\approx \\frac{Y_{k,i+1} - 2Y_{k,i} + Y_{k,i-1}}{(\\Delta x)^2}\n$$\n将这些代入控制 ODE，在每个内部点上得到一个线性代数方程：\n$$\n\\rho D_k \\left( \\frac{Y_{k,i+1} - 2Y_{k,i} + Y_{k,i-1}}{(\\Delta x)^2} \\right) + \\rho u(x_i) \\left( \\frac{Y_{k,i+1} - Y_{k,i-1}}{2\\Delta x} \\right) = \\dot{\\omega}_k(x_i)\n$$\n对未知数 $Y_{k,i-1}, Y_{k,i}, Y_{k,i+1}$ 重新整理各项：\n$$\n\\left( \\frac{\\rho D_k}{(\\Delta x)^2} - \\frac{\\rho u_i}{2\\Delta x} \\right) Y_{k,i-1} + \\left( -\\frac{2\\rho D_k}{(\\Delta x)^2} \\right) Y_{k,i} + \\left( \\frac{\\rho D_k}{(\\Delta x)^2} + \\frac{\\rho u_i}{2\\Delta x} \\right) Y_{k,i+1} = \\dot{\\omega}_{k,i}\n$$\n\n边界条件处理如下：\n1.  **在 $x_0=0$ 处的入口：** Dirichlet 条件 $Y_k(0) = Y_{k,\\text{in}}$ 直接设定了值 $Y_{k,0}$。在第一个内部点 $i=1$ 的方程中，该值成为一个已知量。\n2.  **在 $x_{N-1}=L$ 处的出口：** Neumann 条件 $\\frac{dY_k}{dx}(L)=0$ 是通过使用一个“虚拟点” $x_N = L+\\Delta x$ 来实现的，以保持二阶精度。以 $x_{N-1}$ 为中心的中心差分得到 $\\frac{Y_{k,N} - Y_{k,N-2}}{2\\Delta x} = 0$，这意味着 $Y_{k,N} = Y_{k,N-2}$。然后，在 $x_{N-1}$ 处对控制 ODE 进行离散化，并将 $Y_{k,N}$ 替换为 $Y_{k,N-2}$。这就得到了关于未知数 $Y_{k,N-1}$ 的最终方程：\n    $$\n    \\left( \\frac{2\\rho D_k}{(\\Delta x)^2} \\right) Y_{k,N-2} - \\left( \\frac{2\\rho D_k}{(\\Delta x)^2} \\right) Y_{k,N-1} = \\dot{\\omega}_{k,N-1}\n    $$\n\n这个过程产生了一个包含 $N-1$ 个线性方程的方程组，用于求解 $N-1$ 个未知的质量分数 $Y_{k,1}, \\dots, Y_{k,N-1}$。该系统可以写成矩阵形式 $A \\vec{Y}_k = \\vec{b}$，其中 $A$ 是一个三对角矩阵，可使用标准的线性代数求解器求解。\n\n一旦计算出剖面 $Y_k(x_i)$，就进行数值验证。我们必须检查流入量减去流出量是否等于净生成量：\n$$\n\\underbrace{\\left(\\rho u(0)Y_k(0) - J_k(0)\\right) - \\left(\\rho u(L)Y_k(L) - J_k(L)\\right)}_{\\text{LHS}} = \\underbrace{-\\int_0^L \\dot{\\omega}_k(x)dx}_{\\text{RHS}}\n$$\n两边都进行数值计算：\n-   **右侧（RHS）：** 源项的积分是使用梯形法则在离散的 $\\dot{\\omega}_k(x_i)$ 剖面上计算的。\n-   **左侧（LHS）：** 计算边界处的通量。总通量为 $F_k(x) = \\rho u(x) Y_k(x) - J_k(x) = \\rho u(x) Y_k(x) + \\rho D_k \\frac{dY_k}{dx}$。\n    -   在入口（$x=0$）处，导数 $\\frac{dY_k}{dx}(0)$ 使用二阶精度的向前差分公式近似：$\\frac{dY_k}{dx}(0) \\approx \\frac{-3Y_{k,0} + 4Y_{k,1} - Y_{k,2}}{2\\Delta x}$。\n    -   在出口（$x=L$）处，边界条件规定 $\\frac{dY_k}{dx}(L)=0$，因此扩散通量 $J_k(L)=0$。总通量纯粹是对流性的：$F_k(L) = \\rho u(L) Y_k(L)$。\n    那么 LHS 就是 $F_k(0) - F_k(L)$。\n\n最后，通过确认是否满足 $|\\text{LHS} - \\text{RHS}| \\le \\epsilon_a + \\epsilon_r |\\text{RHS}|$ 来检查等式是否成立，其中指定的相对容差为 $\\epsilon_r = 10^{-6}$，绝对容差为 $\\epsilon_a = 10^{-9}$。此过程将应用于每个组分和三个测试用例中的每一个。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the burner-stabilized flame problem and verifies mass conservation.\n    \"\"\"\n\n    def solve_and_verify(case_params):\n        \"\"\"\n        Solves the BVP for a given case and verifies conservation for all species.\n        \"\"\"\n        L = case_params['L']\n        N = case_params['N']\n        rho = case_params['rho']\n        u_params = case_params['u_params']\n        reaction_params = case_params['reaction']\n        species_data = case_params['species_data']\n\n        def u_func(x_coords, length):\n            if u_params['type'] == 'constant':\n                return u_params['val'] * np.ones_like(x_coords)\n            elif u_params['type'] == 'linear':\n                c0, c1_factor = u_params['coeffs']\n                return c0 + c1_factor * x_coords / length\n\n        x = np.linspace(0, L, N)\n        dx = x[1] - x[0]\n        u = u_func(x, L)\n\n        r0, x0, sigma = reaction_params\n        r = r0 * np.exp(-(x - x0)**2 / (2 * sigma**2))\n\n        results_case = []\n        for species_name in ['H2', 'O2', 'H2O']:\n            Dk, Yk_in, Wk, nu_k = species_data[species_name]\n            \n            omega_k = nu_k * Wk * r\n\n            # Assemble the linear system A*y = b for unknowns y = [Y_1, ..., Y_{N-1}]\n            M = N - 1\n            A = np.zeros((M, M))\n            b = np.zeros(M)\n            \n            # Equations for interior points i = 1, ..., N-2\n            # These correspond to matrix rows j = 0, ..., N-3\n            for i in range(1, N - 1):\n                j = i - 1  # Matrix row index\n                \n                c_low = rho * Dk / dx**2 - rho * u[i] / (2 * dx)\n                c_diag = -2 * rho * Dk / dx**2\n                c_high = rho * Dk / dx**2 + rho * u[i] / (2 * dx)\n\n                b[j] = omega_k[i]\n                \n                if i == 1: # First row, j=0\n                    A[j, j] = c_diag\n                    A[j, j + 1] = c_high\n                    b[j] -= c_low * Yk_in\n                else: # Interior rows\n                    A[j, j - 1] = c_low\n                    A[j, j] = c_diag\n                    A[j, j + 1] = c_high\n\n            # Equation for outlet point i=N-1 (matrix row j=N-2)\n            j = N - 2\n            # Convective term with central difference vanishes due to ghost point\n            # d^2Y/dx^2 term at i=N-1 using ghost point Y_N = Y_{N-2}\n            # rho*Dk * (Y_N - 2*Y_{N-1} + Y_{N-2})/dx^2 = rho*Dk * (2*Y_{N-2} - 2*Y_{N-1})/dx^2\n            # The logic in the solution document for the matrix is correct\n            # Let's check u(x_{N-1}) * (Y_N - Y_{N-2}) / (2*dx) term. Y_N = Y_{N-2} so this is zero.\n            A[j, j - 1] = 2 * rho * Dk / dx**2\n            A[j, j] = -2 * rho * Dk / dx**2\n            b[j] = omega_k[N-1]\n            \n            # Solve for unknown Y values\n            Y_unknowns = np.linalg.solve(A, b)\n            Yk = np.concatenate(([Yk_in], Y_unknowns))\n\n            # Perform verification\n            # RHS: - integral(omega_k) dx\n            rhs = -np.trapz(omega_k, x)\n\n            # LHS: (inflow flux) - (outflow flux)\n            # Flux F_k = rho*u*Y_k - J_k = rho*u*Y_k + rho*D_k*dY_k/dx\n            \n            # Inlet flux at x=0\n            # Use 2nd-order forward difference for dYk/dx(0)\n            dYdx_0 = (-3 * Yk[0] + 4 * Yk[1] - Yk[2]) / (2 * dx)\n            flux_in = rho * u[0] * Yk[0] + rho * Dk * dYdx_0\n\n            # Outlet flux at x=L\n            # dYk/dx(L) = 0, so J_k(L) = 0\n            flux_out = rho * u[-1] * Yk[-1]\n            \n            lhs = flux_in - flux_out\n\n            # Check for conservation within tolerances\n            atol = 1e-9\n            rtol = 1e-6\n            is_conserved = np.isclose(lhs, rhs, rtol=rtol, atol=atol)\n            results_case.append(is_conserved)\n            \n        return results_case\n\n    # Molar masses in kg/mol\n    W_H2 = 0.002\n    W_O2 = 0.032\n    W_H2O = 0.018\n\n    # --- Test Case 1 ---\n    case1 = {\n        'L': 0.020, 'N': 401, 'rho': 1.000,\n        'u_params': {'type': 'constant', 'val': 0.050},\n        'reaction': (15.0, 0.010, 0.002),\n        'species_data': {\n            'H2':  (7.0e-5, 0.080, W_H2, -1.0),\n            'O2':  (3.0e-5, 0.200, W_O2, -0.5),\n            'H2O': (4.0e-5, 0.000, W_H2O, 1.0)\n        }\n    }\n    \n    # --- Test Case 2 ---\n    case2 = {\n        'L': 0.020, 'N': 401, 'rho': 1.000,\n        'u_params': {'type': 'constant', 'val': 0.050},\n        'reaction': (0.0, 0.010, 0.002),\n        'species_data': {\n            'H2':  (7.0e-5, 0.080, W_H2, -1.0),\n            'O2':  (3.0e-5, 0.200, W_O2, -0.5),\n            'H2O': (4.0e-5, 0.000, W_H2O, 1.0)\n        }\n    }\n\n    # --- Test Case 3 ---\n    case3 = {\n        'L': 0.015, 'N': 301, 'rho': 1.100,\n        'u_params': {'type': 'linear', 'coeffs': (0.040, 0.040)},\n        'reaction': (20.0, 0.012, 0.0015),\n        'species_data': {\n            'H2':  (1.0e-4, 0.060, W_H2, -1.0),\n            'O2':  (4.0e-5, 0.220, W_O2, -0.5),\n            'H2O': (5.0e-5, 0.000, W_H2O, 1.0)\n        }\n    }\n\n    all_results = []\n    all_results.extend(solve_and_verify(case1))\n    all_results.extend(solve_and_verify(case2))\n    all_results.extend(solve_and_verify(case3))\n    \n    # Format the final output string exactly as requested\n    output_str = f\"[{','.join(str(r) for r in all_results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}