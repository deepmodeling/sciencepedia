{
    "hands_on_practices": [
        {
            "introduction": "This practice simulates a common experimental task: determining the unstretched laminar burning velocity from raw data of a spherically expanding flame. You will learn to correct for systematic experimental biases and apply the concept of linear extrapolation to account for flame stretch effects. This exercise provides a foundational understanding of how a key combustion property, $S_{L}^{0}$, is extracted from imperfect real-world measurements .",
            "id": "4016490",
            "problem": "A constant-pressure combustion vessel is used to record outwardly propagating spherical flame fronts in a premixed hydrogen–air mixture at ambient conditions. The laminar burning velocity at zero stretch, denoted $S_{L}^{0}$, is defined as the normal propagation speed of an unstretched planar flame relative to the unburned mixture. The experiment employs high-speed imaging with exposure time $T_{\\text{exp}} = 0.2\\,\\text{ms}$, and each recorded timestamp corresponds to the start of the exposure. Due to a known calibration issue, measured radii are inflated by a multiplicative scale bias of $0.3\\%$; treat this bias as a deterministic factor that must be corrected.\n\nThree frames yield raw flame radii and timestamps:\n- $t_{1} = 1.2\\,\\text{ms}$, $r_{\\text{raw},1} = 12.35\\,\\text{mm}$,\n- $t_{2} = 1.6\\,\\text{ms}$, $r_{\\text{raw},2} = 14.21\\,\\text{mm}$,\n- $t_{3} = 2.0\\,\\text{ms}$, $r_{\\text{raw},3} = 16.02\\,\\text{mm}$.\n\nAssume the front position recorded in each frame corresponds to the mid-exposure time $t_{i} + T_{\\text{exp}}/2$. Treat the displacement speed over each adjacent-interval midpoint as approximately constant. The flame stretch rate is defined by the area-based kinematic relation $\\kappa \\equiv (1/A)\\,\\mathrm{d}A/\\mathrm{d}t$, and for a spherical front of radius $r$ the area is $A = 4\\pi r^{2}$. The local displacement speed is $S_{d} \\equiv \\mathrm{d}r/\\mathrm{d}t$. Near zero stretch, model the dependence of $S_{d}$ on $\\kappa$ as first-order in $\\kappa$ and use linear extrapolation to obtain $S_{L}^{0}$ at $\\kappa = 0$ from measurements at nonzero $\\kappa$.\n\nTasks:\n1. Correct the radii for the known $0.3\\%$ scale bias.\n2. Using adjacent pairs $(t_{1},r_{1})$ and $(t_{2},r_{2})$, and $(t_{2},r_{2})$ and $(t_{3},r_{3})$, compute two midpoint pairs $\\big(\\kappa, S_{d}\\big)$, where $S_{d}$ is approximated by the finite difference of $r$ over the corresponding time difference, and $\\kappa$ is obtained from the definition $\\kappa = (1/A)\\,\\mathrm{d}A/\\mathrm{d}t$ with $A = 4\\pi r^{2}$ evaluated using the midpoint radius and the same finite-difference $\\mathrm{d}r/\\mathrm{d}t$.\n3. Perform a linear extrapolation of $S_{d}$ versus $\\kappa$ to $\\kappa = 0$ to determine $S_{L}^{0}$.\n\nExpress the final value of $S_{L}^{0}$ in $\\text{m}\\,\\text{s}^{-1}$ and round your answer to three significant figures. Ignore random uncertainties for the central estimate, but account for the stated deterministic bias correction exactly.",
            "solution": "The problem requires the determination of the unstretched laminar burning velocity, $S_{L}^{0}$, from experimental data of a spherically propagating flame. This involves correcting the raw data, calculating the displacement speed $S_{d}$ and stretch rate $\\kappa$ for two intervals, and then performing a linear extrapolation of $S_{d}$ versus $\\kappa$ to the unstretched condition, $\\kappa=0$.\n\nFirst, we establish the given parameters and data:\n-   Exposure time: $T_{\\text{exp}} = 0.2\\,\\text{ms} = 2 \\times 10^{-4}\\,\\text{s}$.\n-   Multiplicative scale bias: a $0.3\\%$ inflation, which corresponds to a factor of $1 + 0.003 = 1.003$.\n-   Raw data points $(t_{i}, r_{\\text{raw},i})$:\n    -   $t_{1} = 1.2\\,\\text{ms}$, $r_{\\text{raw},1} = 12.35\\,\\text{mm}$\n    -   $t_{2} = 1.6\\,\\text{ms}$, $r_{\\text{raw},2} = 14.21\\,\\text{mm}$\n    -   $t_{3} = 2.0\\,\\text{ms}$, $r_{\\text{raw},3} = 16.02\\,\\text{mm}$\n\nThe solution proceeds in three steps as outlined in the problem statement.\n\n**Step 1: Data Correction**\n\nWe must correct both the timestamps and the measured radii.\nThe effective time of each measurement corresponds to the midpoint of the exposure interval. The corrected time $t'_{i}$ is given by:\n$$t'_{i} = t_{i} + \\frac{T_{\\text{exp}}}{2}$$\nWith $T_{\\text{exp}} = 0.2\\,\\text{ms}$, the time correction is $0.1\\,\\text{ms}$.\n$$t'_{1} = 1.2\\,\\text{ms} + 0.1\\,\\text{ms} = 1.3\\,\\text{ms}$$\n$$t'_{2} = 1.6\\,\\text{ms} + 0.1\\,\\text{ms} = 1.7\\,\\text{ms}$$\n$$t'_{3} = 2.0\\,\\text{ms} + 0.1\\,\\text{ms} = 2.1\\,\\text{ms}$$\n\nThe raw radii $r_{\\text{raw},i}$ are inflated by $0.3\\%$. The true radius $r_i$ is found by dividing the raw radius by the bias factor $1.003$.\n$$r_{i} = \\frac{r_{\\text{raw},i}}{1.003}$$\n$$r_{1} = \\frac{12.35\\,\\text{mm}}{1.003}$$\n$$r_{2} = \\frac{14.21\\,\\text{mm}}{1.003}$$\n$$r_{3} = \\frac{16.02\\,\\text{mm}}{1.003}$$\nIt is prudent to keep these values in their fractional form during intermediate calculations to avoid premature rounding errors.\n\n**Step 2: Computation of Midpoint Pairs $(\\kappa, S_{d})$**\n\nWe compute two pairs of $(\\kappa, S_{d})$, one for the interval between $(t'_{1}, r_{1})$ and $(t'_{2}, r_{2})$, and another for the interval between $(t'_{2}, r_{2})$ and $(t'_{3}, r_{3})$.\n\nFor the first interval (denoted by subscript $12$):\nThe time difference is $\\Delta t_{12} = t'_{2} - t'_{1} = 1.7\\,\\text{ms} - 1.3\\,\\text{ms} = 0.4\\,\\text{ms}$.\nThe displacement speed $S_{d,12}$ is approximated by a finite difference:\n$$S_{d,12} = \\frac{r_{2} - r_{1}}{\\Delta t_{12}} = \\frac{(14.21 - 12.35)/1.003\\,\\text{mm}}{0.4\\,\\text{ms}} = \\frac{1.86/1.003}{0.4}\\,\\frac{\\text{mm}}{\\text{ms}} = \\frac{1.86}{0.4012}\\,\\frac{\\text{m}}{\\text{s}} \\approx 4.63609\\,\\frac{\\text{m}}{\\text{s}}$$\nNote that the unit $\\text{mm}/\\text{ms}$ is numerically equivalent to $\\text{m}/\\text{s}$.\n\nThe stretch rate for a spherical flame is $\\kappa = (1/A)(\\mathrm{d}A/\\mathrm{d}t)$. With $A = 4\\pi r^2$, this becomes $\\kappa = (1/(4\\pi r^2))(8\\pi r (\\mathrm{d}r/\\mathrm{d}t)) = (2/r)(\\mathrm{d}r/\\mathrm{d}t)$. We evaluate this using the midpoint radius and the finite-difference speed.\nThe midpoint radius is $r_{12} = (r_{1}+r_{2})/2$.\n$$r_{12} = \\frac{(12.35 + 14.21)/1.003}{2}\\,\\text{mm} = \\frac{26.56}{2.006}\\,\\text{mm}$$\nThe stretch rate is $\\kappa_{12}$:\n$$\n\\kappa_{12} = \\frac{2 S_{d,12}}{r_{12}} = \\frac{2 \\cdot \\frac{r_2-r_1}{\\Delta t_{12}}}{\\frac{r_1+r_2}{2}} = \\frac{4(r_2-r_1)}{\\Delta t_{12}(r_1+r_2)}\n$$\nSubstituting the expressions for $r_i$ in terms of $r_{\\text{raw},i}$:\n$$\n\\kappa_{12} = \\frac{4(r_{\\text{raw},2} - r_{\\text{raw},1})/1.003}{\\Delta t_{12}(r_{\\text{raw},1} + r_{\\text{raw},2})/1.003} = \\frac{4(r_{\\text{raw},2} - r_{\\text{raw},1})}{\\Delta t_{12}(r_{\\text{raw},1} + r_{\\text{raw},2})}\n$$\nThe bias correction cancels for $\\kappa$.\n$$\\kappa_{12} = \\frac{4(14.21 - 12.35)\\,\\text{mm}}{0.4\\,\\text{ms} \\cdot (12.35 + 14.21)\\,\\text{mm}} = \\frac{4(1.86)}{0.4(26.56)}\\,\\text{ms}^{-1} = \\frac{7.44}{10.624}\\,\\text{ms}^{-1} \\approx 0.70030\\,\\text{ms}^{-1}$$\nConverting to SI units, $\\kappa_{12} \\approx 700.30\\,\\text{s}^{-1}$.\n\nFor the second interval (denoted by subscript $23$):\nThe time difference is $\\Delta t_{23} = t'_{3} - t'_{2} = 2.1\\,\\text{ms} - 1.7\\,\\text{ms} = 0.4\\,\\text{ms}$.\nThe displacement speed $S_{d,23}$ is:\n$$S_{d,23} = \\frac{r_{3} - r_{2}}{\\Delta t_{23}} = \\frac{(16.02 - 14.21)/1.003\\,\\text{mm}}{0.4\\,\\text{ms}} = \\frac{1.81/1.003}{0.4}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{1.81}{0.4012}\\,\\frac{\\text{m}}{\\text{s}} \\approx 4.51147\\,\\frac{\\text{m}}{\\text{s}}$$\nThe stretch rate $\\kappa_{23}$ is:\n$$\\kappa_{23} = \\frac{4(r_{\\text{raw},3} - r_{\\text{raw},2})}{\\Delta t_{23}(r_{\\text{raw},2} + r_{\\text{raw},3})} = \\frac{4(16.02 - 14.21)\\,\\text{mm}}{0.4\\,\\text{ms} \\cdot (14.21 + 16.02)\\,\\text{mm}} = \\frac{4(1.81)}{0.4(30.23)}\\,\\text{ms}^{-1} = \\frac{7.24}{12.092}\\,\\text{ms}^{-1} \\approx 0.59874\\,\\text{ms}^{-1}$$\nConverting to SI units, $\\kappa_{23} \\approx 598.74\\,\\text{s}^{-1}$.\n\nSo we have two points $(\\kappa, S_d)$:\nPoint A: $(\\kappa_A, S_{d,A}) = (700.30\\,\\text{s}^{-1}, 4.63609\\,\\text{m/s})$\nPoint B: $(\\kappa_B, S_{d,B}) = (598.74\\,\\text{s}^{-1}, 4.51147\\,\\text{m/s})$\n\n**Step 3: Linear Extrapolation to $\\kappa=0$**\n\nWe model the relationship between $S_d$ and $\\kappa$ as linear: $S_d(\\kappa) = m\\kappa + c$. The unstretched laminar burning velocity $S_L^0$ is the value of $S_d$ at $\\kappa=0$, which is the intercept $c$.\nGiven two points $(\\kappa_A, S_{d,A})$ and $(\\kappa_B, S_{d,B})$, the intercept $S_L^0$ of the line passing through them is given by:\n$$S_{L}^{0} = \\frac{S_{d,B}\\kappa_A - S_{d,A}\\kappa_B}{\\kappa_A - \\kappa_B}$$\nSubstituting the calculated values:\n$$S_{L}^{0} = \\frac{(4.51147\\,\\text{m/s})(700.30\\,\\text{s}^{-1}) - (4.63609\\,\\text{m/s})(598.74\\,\\text{s}^{-1})}{700.30\\,\\text{s}^{-1} - 598.74\\,\\text{s}^{-1}}$$\n$$S_{L}^{0} = \\frac{3159.40 - 2775.83}{101.56}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{383.57}{101.56}\\,\\frac{\\text{m}}{\\text{s}} \\approx 3.7767\\,\\frac{\\text{m}}{\\text{s}}$$\nA more precise calculation using the unrounded intermediate values gives:\n$\\kappa_A = 700.3011... \\,\\text{s}^{-1}$\n$\\kappa_B = 598.7429... \\,\\text{s}^{-1}$\n$S_{d,A} = 4.6360917... \\,\\text{m/s}$\n$S_{d,B} = 4.5114656... \\,\\text{m/s}$\n$$S_{L}^{0} = \\frac{(4.5114656)(700.3011) - (4.6360917)(598.7429)}{700.3011 - 598.7429}\\,\\frac{\\text{m}}{\\text{s}}$$\n$$S_{L}^{0} = \\frac{3159.400 - 2775.833}{101.5582}\\,\\frac{\\text{m}}{\\text{s}} = \\frac{383.567}{101.5582}\\,\\frac{\\text{m}}{\\text{s}} \\approx 3.77666\\,\\frac{\\text{m}}{\\text{s}}$$\nThe problem requires the final answer to be rounded to three significant figures.\n$$S_{L}^{0} \\approx 3.78\\,\\frac{\\text{m}}{\\text{s}}$$",
            "answer": "$$\n\\boxed{3.78}\n$$"
        },
        {
            "introduction": "Moving from experimental data analysis to computational design, this exercise challenges you to think like a computational scientist. You will evaluate different proposed methods for measuring the Markstein length, $L_M$, in a simulated counterflow flame configuration. The goal is to identify the most scientifically rigorous procedure, thereby deepening your understanding of how to correctly isolate and quantify the effects of flame stretch in a virtual experiment .",
            "id": "4077909",
            "problem": "You are asked to determine the Markstein length $L_M$ of a laminar premixed flame using a computational counterflow configuration, following the Zeldovich–Frank-Kamenetskii theory for premixed flames. Consider an axisymmetric twin-jet counterflow of a gaseous, single-step reactive mixture at constant ambient pressure, with equal inlet temperatures, compositions, and densities on both sides. The flow establishes a stagnation plane approximately midway between the inlets, and a planar premixed flame forms near this plane for suitable inlet velocities. Assume the mixture has unity Lewis number and that simulations are performed under adiabatic, non-radiative conditions with detailed transport and chemistry.\n\nThe governing base for your reasoning must be the following, and only the following: conservation of mass, species, and energy; the definition of laminar burning velocity $S_L$ as the normal propagation speed of the flame relative to the unburned mixture; the definition of flame stretch rate $\\kappa$ for a material surface as $\\kappa = \\frac{1}{A} \\frac{\\mathrm{d}A}{\\mathrm{d}t}$ and, equivalently, $\\kappa = \\nabla_s \\cdot \\mathbf{u}_t$ where $\\nabla_s$ is the surface divergence and $\\mathbf{u}_t$ is the tangential component of the velocity along the flame surface; and the consumption-speed definition $S_c$ obtained from species conservation by integrating the volumetric fuel consumption rate across the flame and normalizing by the upstream fuel mass fraction and density. You must not invoke or assume any shortcut formulas beyond these definitions and the conservation laws.\n\nYour goal is to extract $L_M$ by applying a controlled hydrodynamic strain in the counterflow and fitting the response $S_L(\\kappa)$ in the weak-stretch regime, with curvature effects negligible (planar flame) and without extinction. Which of the following numerical procedures is consistent with this goal and will yield a scientifically sound and unbiased estimate of $L_M$?\n\nA. For a set of $N \\geq 5$ steady simulations, vary the imposed counterflow strain by adjusting equal inlet velocities to span a small range of strain rates $a$ such that the flame remains planar and non-extinguished. For each case, compute the local flame stretch rate $\\kappa$ at the flame by evaluating $\\kappa = \\left(\\mathbf{I} - \\mathbf{n}\\mathbf{n}\\right) : \\nabla \\mathbf{u}$ on the unburned side at the location of peak heat release, where $\\mathbf{n}$ is the unit normal to the flame and $\\nabla \\mathbf{u}$ is the velocity gradient tensor; verify that curvature is negligible so that $\\kappa \\approx a$. Compute the laminar burning velocity $S_L$ using the consumption-speed definition $S_c = \\frac{1}{\\rho_u Y_{F,u}} \\int \\dot{\\omega}_F \\,\\mathrm{d}s_n$, where $\\rho_u$ and $Y_{F,u}$ are the upstream unburned density and fuel mass fraction, $\\dot{\\omega}_F$ is the fuel consumption rate per unit volume, and $\\mathrm{d}s_n$ integrates along the flame-normal coordinate. Fit $S_L(\\kappa)$ over the smallest-strain subset that is demonstrably linear (checked by residual analysis and by excluding cases with noticeable pre-extinction curvature), and identify $L_M$ from the slope of the best-fit line. Report uncertainty from grid and domain refinement and from fit statistics.\n\nB. Hold inlet composition and temperature fixed, and for $M \\geq 3$ cases vary only the inlet velocity $U_{\\text{in}}$. Estimate the stretch rate as $\\kappa \\approx U_{\\text{in}}/\\delta_L$, where $\\delta_L$ is the unstretched flame thickness measured from a separate one-dimensional free-flame computation. Compute $S_L$ as the mass-flux-normalized inlet velocity, $S_L \\approx U_{\\text{in}}$, since the flame is approximately planar. Fit $S_L$ versus $\\kappa$ over the full range of $\\kappa$ up to near-extinction to increase dynamic range, and take $L_M$ from the slope.\n\nC. In $K \\geq 4$ simulations, vary the strain and record the axial position of the flame $x_f$ defined by the location of maximum temperature gradient. Since higher strain convects the flame closer to the stagnation plane, fit $x_f$ versus the imposed strain rate $a$ and obtain $L_M$ as $\\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$, which has units of length and thus directly represents the Markstein length.\n\nD. Using a single high-resolution simulation at moderate strain, compute the spatial maximum of the temperature gradient magnitude, $\\max |\\nabla T|$, and use the ratio $S_L \\approx \\alpha \\, \\max |\\nabla T|$ with $\\alpha$ the thermal diffusivity of the unburned mixture to approximate the burning velocity. Then perturb the strain slightly, recompute $S_L$, and obtain $L_M$ from the finite-difference slope of $S_L$ versus $\\kappa$.\n\nE. For a series of simulations, measure the strain rate as $a = \\left.\\frac{\\partial u_x}{\\partial x}\\right|_{x=0}$ at the stagnation plane, independent of the flame location. Compute $S_L$ as the inlet mass flux divided by upstream density, $S_L \\approx \\frac{\\dot{m}_{\\text{in}}}{\\rho_u A}$, assuming equal opposing jets and negligible compressibility effects. Fit $S_L$ versus $a$ across a wide range including nonlinear and near-extinction regimes to estimate $L_M$ from the slope.\n\nSelect the single best option.",
            "solution": "The problem statement is critically evaluated as follows.\n\n### Step 1: Extract Givens\n- **Physical System:** A laminar premixed flame.\n- **Configuration:** Computational simulation of an axisymmetric twin-jet counterflow of a gaseous, single-step reactive mixture.\n- **Boundary and Initial Conditions:** Constant ambient pressure; equal inlet temperatures, compositions, and densities for both jets.\n- **Resulting Flow:** A stagnation plane forms midway between the inlets; a planar premixed flame is established near the stagnation plane.\n- **Mixture Properties:** Unity Lewis number.\n- **Simulation Conditions:** Adiabatic, non-radiative, with detailed transport and chemistry.\n- **Governing Principles:** Conservation of mass, species, and energy.\n- **Core Definitions:**\n    1.  Laminar burning velocity $S_L$: Normal propagation speed of the flame relative to the unburned mixture.\n    2.  Flame stretch rate $\\kappa$: $\\kappa = \\frac{1}{A} \\frac{\\mathrm{d}A}{\\mathrm{d}t}$ where $A$ is flame surface area; also $\\kappa = \\nabla_s \\cdot \\mathbf{u}_t$ where $\\nabla_s$ is the surface divergence and $\\mathbf{u}_t$ is the tangential velocity component along the flame surface.\n    3.  Consumption speed $S_c$: $S_c = \\frac{1}{\\rho_u Y_{F,u}} \\int \\dot{\\omega}_F \\,\\mathrm{d}s_n$, where $\\rho_u$ and $Y_{F,u}$ are upstream density and fuel mass fraction, $\\dot{\\omega}_F$ is the volumetric fuel consumption rate, and the integral is along the flame-normal coordinate $s_n$.\n- **Objective:** Determine the Markstein length $L_M$ by fitting the response of the laminar burning velocity $S_L$ to the stretch rate $\\kappa$, i.e., $S_L(\\kappa)$, in the weak-stretch regime where curvature effects are negligible.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in the field of combustion theory, specifically Zeldovich–Frank-Kamenetskii (ZFK) theory. The use of a counterflow configuration to study stretched flames is a standard and well-validated experimental and computational technique. All provided definitions for $S_L$, $\\kappa$, and $S_c$ are standard in the field. The setup is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It asks for the correct procedure to determine a well-defined physical quantity ($L_M$) from a standard computational experiment. The relationship between $S_L$ and $\\kappa$ provides a clear basis for such a determination.\n- **Objective:** The language is technical, precise, and free of subjective or ambiguous statements.\n- **Conclusion:** The problem statement does not violate any of the invalidity criteria. It is scientifically sound, well-posed, objective, complete, and relevant.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. A solution will be derived by analyzing the proposed procedures against the established principles of combustion science and numerical methods.\n\nThe fundamental basis for determining the Markstein length, $L_M$, is the linear relationship derived from asymptotic flame theory for the weak-stretch regime:\n$$ S_L - S_L^0 = -L_M \\kappa $$\nwhere $S_L^0$ is the laminar burning velocity of the corresponding unstretched ($ \\kappa = 0 $), planar flame. This equation shows that $L_M$ is related to the negative of the slope of the $S_L$ versus $\\kappa$ curve in the limit of $\\kappa \\to 0$. A robust numerical procedure must therefore accurately determine $S_L$ and $\\kappa$ from a series of simulations and perform a proper linear regression.\n\n### Option-by-Option Analysis\n\n**A. For a set of $N \\geq 5$ steady simulations, vary the imposed counterflow strain by adjusting equal inlet velocities to span a small range of strain rates $a$ such that the flame remains planar and non-extinguished. For each case, compute the local flame stretch rate $\\kappa$ at the flame by evaluating $\\kappa = \\left(\\mathbf{I} - \\mathbf{n}\\mathbf{n}\\right) : \\nabla \\mathbf{u}$ on the unburned side at the location of peak heat release, where $\\mathbf{n}$ is the unit normal to the flame and $\\nabla \\mathbf{u}$ is the velocity gradient tensor; verify that curvature is negligible so that $\\kappa \\approx a$. Compute the laminar burning velocity $S_L$ using the consumption-speed definition $S_c = \\frac{1}{\\rho_u Y_{F,u}} \\int \\dot{\\omega}_F \\,\\mathrm{d}s_n$, where $\\rho_u$ and $Y_{F,u}$ are the upstream unburned density and fuel mass fraction, $\\dot{\\omega}_F$ is the fuel consumption rate per unit volume, and $\\mathrm{d}s_n$ integrates along the flame-normal coordinate. Fit $S_L(\\kappa)$ over the smallest-strain subset that is demonstrably linear (checked by residual analysis and by excluding cases with noticeable pre-extinction curvature), and identify $L_M$ from the slope of the best-fit line. Report uncertainty from grid and domain refinement and from fit statistics.**\n\nThis option outlines a methodologically impeccable procedure.\n1.  **Varying Strain and Data Set:** Performing $N \\geq 5$ simulations by varying inlet velocities is the correct way to generate a data set $\\{(\\kappa_i, S_{L,i})\\}$. Staying in a small, non-extinguished range correctly targets the weak-stretch regime.\n2.  **Measuring Stretch Rate $\\kappa$:** The formula $\\kappa = (\\mathbf{I} - \\mathbf{n}\\mathbf{n}) : \\nabla \\mathbf{u}$ is the rigorous, coordinate-invariant definition of the tangential strain rate on a surface. Evaluating it on the unburned side of the flame is theoretically correct, as the flame responds to the strain in the incoming flow. The peak heat release rate is a standard and robust marker for the flame's location.\n3.  **Measuring Burning Velocity $S_L$:** The consumption speed definition, $S_c$, is based on the integrated species consumption rate, which is a globally conserved quantity and thus provides a robust measure of the flame's overall strength. For unity Lewis number flames, it is established that $S_c$ is an excellent proxy for $S_L$. This is a state-of-the-art method.\n4.  **Extracting $L_M$:** Fitting $S_L(\\kappa)$ only over the demonstrably linear, small-strain subset is the correct way to apply the linear theory. Excluding nonlinear, near-extinction data is crucial. Identifying $L_M$ from the slope of this fit is the direct application of the defining equation.\n5.  **Uncertainty Quantification:** Acknowledging and reporting numerical (grid, domain) and statistical (fit) uncertainties is a hallmark of a scientifically valid study.\n\nVerdict: **Correct**. This option represents the gold standard for this type of computational measurement.\n\n**B. Hold inlet composition and temperature fixed, and for $M \\geq 3$ cases vary only the inlet velocity $U_{\\text{in}}$. Estimate the stretch rate as $\\kappa \\approx U_{\\text{in}}/\\delta_L$, where $\\delta_L$ is the unstretched flame thickness measured from a separate one-dimensional free-flame computation. Compute $S_L$ as the mass-flux-normalized inlet velocity, $S_L \\approx U_{\\text{in}}$, since the flame is approximately planar. Fit $S_L$ versus $\\kappa$ over the full range of $\\kappa$ up to near-extinction to increase dynamic range, and take $L_M$ from the slope.**\n\nThis option contains several critical flaws.\n1.  **Crude Approximation for $\\kappa$:** The expression $\\kappa \\approx U_{\\text{in}}/\\delta_L$ is a dimensional scaling argument, not a measurement. The actual stretch rate is a local property of the flow field at the flame front, which this approximation fails to capture accurately.\n2.  **Incorrect Approximation for $S_L$:** The assertion $S_L \\approx U_{\\text{in}}$ is fundamentally incorrect. In a counterflow, the unburned gas decelerates as it approaches the stagnation plane. The flame speed $S_L$ is the speed relative to the gas immediately upstream of it, which is significantly smaller than the inlet velocity $U_{\\text{in}}$.\n3.  **Incorrect Fitting Range:** Using the full range of $\\kappa$ up to extinction is incorrect. The linear theory only applies to weak stretch. Including the highly non-linear near-extinction data will corrupt the linear fit and yield a meaningless slope.\n\nVerdict: **Incorrect**. This procedure relies on flawed approximations and incorrect methodology.\n\n**C. In $K \\geq 4$ simulations, vary the strain and record the axial position of the flame $x_f$ defined by the location of maximum temperature gradient. Since higher strain convects the flame closer to the stagnation plane, fit $x_f$ versus the imposed strain rate $a$ and obtain $L_M$ as $\\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$, which has units of length and thus directly represents the Markstein length.**\n\nThis option is based on a physically and dimensionally flawed premise.\n1.  **Dimensional Inconsistency:** The Markstein length $L_M$ has units of length, $[L]$. The strain rate $a$ has units of inverse time, $[T^{-1}]$. The flame position $x_f$ has units of length, $[L]$. The proposed derivative $\\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$ therefore has units of $[L] / [T^{-1}] = [L T]$, which are units of length multiplied by time, not length.\n2.  **Physical Invalidity:** There is no theoretical basis in flame theory for the claim that $L_M = \\frac{\\mathrm{d}x_f}{\\mathrm{d}a}$. The Markstein length is defined by the sensitivity of burning velocity to stretch, not flame position to strain rate.\n\nVerdict: **Incorrect**. The proposed relationship is dimensionally inconsistent and physically unfounded.\n\n**D. Using a single high-resolution simulation at moderate strain, compute the spatial maximum of the temperature gradient magnitude, $\\max |\\nabla T|$, and use the ratio $S_L \\approx \\alpha \\, \\max |\\nabla T|$ with $\\alpha$ the thermal diffusivity of the unburned mixture to approximate the burning velocity. Then perturb the strain slightly, recompute $S_L$, and obtain $L_M$ from the finite-difference slope of $S_L$ versus $\\kappa$.**\n\nThis procedure is significantly less robust than option A.\n1.  **Two-Point Estimate:** Using only two points (an initial simulation and a perturbed one) to calculate a finite-difference slope is highly sensitive to numerical noise and may not accurately represent the true slope in the linear regime. A linear regression over multiple points ($N \\geq 5$ as in A) is statistically far superior.\n2.  **Approximation for $S_L$:** The relation $S_L \\approx \\alpha \\, \\max |\\nabla T|$ is an approximation derived from simplified thermal flame theory. While useful, it is less general and robust than the consumption speed $S_c$, which is derived directly from the species conservation equation without such simplifying assumptions.\n\nVerdict: **Incorrect**. This method is technically viable but methodologically inferior and less accurate than the procedure in A. It relies on an approximation for $S_L$ and a poor two-point estimate for the derivative.\n\n**E. For a series of simulations, measure the strain rate as $a = \\left.\\frac{\\partial u_x}{\\partial x}\\right|_{x=0}$ at the stagnation plane, independent of the flame location. Compute $S_L$ as the inlet mass flux divided by upstream density, $S_L \\approx \\frac{\\dot{m}_{\\text{in}}}{\\rho_u A}$, assuming equal opposing jets and negligible compressibility effects. Fit $S_L$ versus $a$ across a wide range including nonlinear and near-extinction regimes to estimate $L_M$ from the slope.**\n\nThis option combines several flaws seen in other incorrect options.\n1.  **Imprecise Measure of Strain:** Measuring the strain rate at the stagnation plane ($x=0$) is an approximation. The strain rate relevant to the flame is the one it experiences on its unburned side, which is not necessarily the same as at the stagnation plane, especially in flows with significant property variations.\n2.  **Incorrect Approximation for $S_L$:** Calculating $S_L \\approx \\frac{\\dot{m}_{\\text{in}}}{\\rho_u A}$ is equivalent to setting $S_L \\approx U_{\\text{in}}$ (assuming $\\rho_{\\text{in}} \\approx \\rho_u$), which is fundamentally incorrect for the same reasons as in option B.\n3.  **Incorrect Fitting Range:** As in option B, fitting across a wide range including the nonlinear near-extinction regime will produce an erroneous result for $L_M$.\n\nVerdict: **Incorrect**. This procedure uses flawed approximations for both $S_L$ and the relevant stretch rate, and employs an incorrect fitting methodology.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This final practice bridges theory and practical data analysis by tasking you with extracting the Markstein number from simulated flame data. You will implement a statistically robust procedure using Weighted Least Squares to account for data of varying quality and the delta method to quantify the uncertainty in your result. This hands-on coding exercise  equips you with essential skills for analyzing complex simulation outputs and reporting results with scientific rigor.",
            "id": "4018368",
            "problem": "You are given a computational task inspired by Direct Numerical Simulation (DNS) of premixed flames to extract the Markstein number from controlled flame wrinkling. The diffusive–thermal instability in premixed flames manifests as a sensitivity of the local normal burning velocity to curvature and stretch. Under controlled wrinkling with negligible tangential strain, your goal is to estimate the Markstein number by fitting the curvature dependence of the local normal laminar burning velocity and quantifying uncertainty.\n\nStart from first principles appropriate to the thin reaction zone of a premixed flame and the diffusive–thermal theory. The normal laminar burning velocity, denoted by $S_L$, and the local mean curvature of the flame front, denoted by $\\kappa$ (with $\\kappa  0$ for convex towards reactants), are the relevant measurable quantities. Under small-amplitude wrinkling with negligible stretch, the leading-order sensitivity of $S_L$ to $\\kappa$ near $\\kappa = 0$ can be justified by a first-order Taylor expansion consistent with inner–outer matched asymptotic analysis, without assuming any specific shortcut formula. The Markstein length, denoted by $L_M$, is defined as the coefficient that relates the first-order sensitivity of $S_L$ to $\\kappa$ about $\\kappa = 0$. The Markstein number, denoted by $M_a$, is defined as $M_a = L_M / \\delta_L$, where $\\delta_L$ is the laminar flame thickness. All quantities are standard in computational combustion; please define and use them carefully.\n\nYou must:\n- Derive, from the conservation laws and diffusive–thermal considerations, that for small curvature the dependence $S_L(\\kappa)$ around $\\kappa = 0$ admits a first-order linear model that allows you to identify $L_M$ as a ratio of the model’s slope and intercept in a way that is dimensionally consistent.\n- Design a statistically sound estimator to fit the linear model to noisy DNS-like data and to extract the Markstein length $L_M$ and Markstein number $M_a$, with uncertainty quantification for both. Use Weighted Least Squares (WLS) with weights based on reported measurement standard deviations for $S_L$ only. Propagate parameter covariance by the delta method to obtain standard deviations of $L_M$ and $M_a$.\n\nYour program must compute the estimates and their uncertainties for the following test suite. The wrinkling is sinusoidal with small amplitude in the $x$-direction, with flame front given by $y(x) = A \\sin(k x)$, where $A$ is the amplitude and $k = 2\\pi/\\lambda$ is the wavenumber. The local curvature at $x$ in the small-slope limit is\n$$\n\\kappa(x) \\approx -A k^2 \\sin(k x).\n$$\nFor each case, construct $N = 21$ sample points with phases $\\phi_j = 2\\pi j/N$ for $j = 0, 1, \\ldots, 20$, and set $x_j$ such that $k x_j = \\phi_j$ (angles in radians). The measured local normal laminar burning velocity is given deterministically by\n$$\nS_L^{\\mathrm{meas}}(\\phi_j) = S_L^0 - S_L^0 \\, L_M \\, \\kappa(\\phi_j) + \\epsilon_1 \\cos(2 \\phi_j) + \\epsilon_2 \\sin(3 \\phi_j),\n$$\nwhere $S_L^0$ is the baseline planar laminar burning velocity, $L_M$ is the true Markstein length used to generate the data, and $\\epsilon_1$ and $\\epsilon_2$ are fixed deterministic measurement biases. The reported measurement standard deviation for $S_L$ at each sample is\n$$\n\\sigma_S(\\phi_j) = \\sigma_0 + \\sigma_1 \\, |\\kappa(\\phi_j)|,\n$$\nand is to be used as the weight basis for WLS. Assume negligible measurement error in $\\kappa$ for the purposes of linear fitting.\n\nThe three test cases are:\n\n- Case 1 (general positive sensitivity):\n  - Amplitude $A = 0.004~\\mathrm{m}$, wavelength $\\lambda = 0.10~\\mathrm{m}$.\n  - Baseline $S_L^0 = 0.40~\\mathrm{m/s}$.\n  - True Markstein length $L_M = 0.0008~\\mathrm{m}$.\n  - Laminar flame thickness $\\delta_L = 0.0005~\\mathrm{m}$.\n  - Bias amplitudes $\\epsilon_1 = 0.00035~\\mathrm{m/s}$, $\\epsilon_2 = 0.00015~\\mathrm{m/s}$.\n  - Reported standard deviation parameters $\\sigma_0 = 0.0004~\\mathrm{m/s}$, $\\sigma_1 = 0.00001~\\mathrm{m^2/s}$.\n\n- Case 2 (negative sensitivity indicating diffusive–thermal destabilization):\n  - Amplitude $A = 0.006~\\mathrm{m}$, wavelength $\\lambda = 0.08~\\mathrm{m}$.\n  - Baseline $S_L^0 = 0.35~\\mathrm{m/s}$.\n  - True Markstein length $L_M = -0.0003~\\mathrm{m}$.\n  - Laminar flame thickness $\\delta_L = 0.0005~\\mathrm{m}$.\n  - Bias amplitudes $\\epsilon_1 = 0.00030~\\mathrm{m/s}$, $\\epsilon_2 = -0.00010~\\mathrm{m/s}$.\n  - Reported standard deviation parameters $\\sigma_0 = 0.0005~\\mathrm{m/s}$, $\\sigma_1 = 0.00002~\\mathrm{m^2/s}$.\n\n- Case 3 (boundary case with very small curvature amplitude):\n  - Amplitude $A = 0.001~\\mathrm{m}$, wavelength $\\lambda = 0.12~\\mathrm{m}$.\n  - Baseline $S_L^0 = 0.42~\\mathrm{m/s}$.\n  - True Markstein length $L_M = 0.0005~\\mathrm{m}$.\n  - Laminar flame thickness $\\delta_L = 0.0004~\\mathrm{m}$.\n  - Bias amplitudes $\\epsilon_1 = 0.00050~\\mathrm{m/s}$, $\\epsilon_2 = 0.00020~\\mathrm{m/s}$.\n  - Reported standard deviation parameters $\\sigma_0 = 0.0006~\\mathrm{m/s}$, $\\sigma_1 = 0.000005~\\mathrm{m^2/s}$.\n\nAlgorithmic requirements:\n- For each case, form the dataset $\\{(\\kappa(\\phi_j), S_L^{\\mathrm{meas}}(\\phi_j), \\sigma_S(\\phi_j))\\}_{j=0}^{20}$ in the specified units.\n- Fit the linear model $S_L(\\kappa) \\approx a + b \\kappa$ using Weighted Least Squares with weights $w_j = 1/\\sigma_S(\\phi_j)^2$, and estimate $a$ and $b$ along with the $2 \\times 2$ parameter covariance matrix $\\mathrm{Cov}([a,b])$.\n- From dimensional analysis and the first-order definition of the Markstein length, compute $L_M = -b/a$, and then $M_a = L_M / \\delta_L$.\n- Use the delta method to propagate $\\mathrm{Cov}([a,b])$ and compute the standard deviation of $L_M$ and of $M_a$.\n\nUnits and output:\n- $S_L$ and $S_L^0$ must be treated in $\\mathrm{m/s}$.\n- $\\kappa$ must be treated in $\\mathrm{m^{-1}}$.\n- $L_M$ must be returned in $\\mathrm{m}$.\n- $\\delta_L$ must be treated in $\\mathrm{m}$.\n- $M_a$ is dimensionless.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, where each case’s result is itself a list in the order $[a, L_M, M_a, \\sigma_{L_M}, \\sigma_{M_a}]$. All entries are floats. For example: $[[\\ldots],[\\ldots],[\\ldots]]$.\n\nNo external input is allowed; all values must be computed internally from the given specifications.",
            "solution": "We begin from the fundamental transport formulation for premixed flames in the thin reaction zone approximation, where a flame front is represented as an interface propagating normal to itself with a local normal burning velocity. Let $S_L$ be the local normal laminar burning velocity and $n$ be the coordinate normal to the front. In a curved flame, species and heat diffusion alter gradients across the front, and the surface divergence contributes to the transport through the curvature $\\kappa$ and stretch. Under controlled wrinkling, we assume negligible tangential strain so that the primary geometric effect is curvature. In this regime and for small-amplitude wrinkling with a curvature magnitude small compared to the inverse of the laminar flame thickness, asymptotic analysis (expansion in the small parameter $\\epsilon = \\delta_L / R$, with $R$ a local radius of curvature) yields that the leading-order correction to $S_L$ due to curvature is linear in $\\kappa$ near $\\kappa = 0$. Specifically, if $S_L(\\kappa)$ is smooth near $\\kappa = 0$, then the first-order Taylor expansion gives\n$$\nS_L(\\kappa) \\approx S_L^0 + \\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} \\kappa,\n$$\nwhere $S_L^0$ is the planar flame speed. Diffusive–thermal theory connects the derivative to mixture transport and reaction properties; by definition of the Markstein length $L_M$, the coefficient of the first-order sensitivity satisfies\n$$\n\\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} = - S_L^0 \\, L_M.\n$$\nThis definition is dimensionally consistent: $S_L^0$ has units of $\\mathrm{m/s}$, $\\kappa$ has units of $\\mathrm{m^{-1}}$, which implies that $L_M$ has units of $\\mathrm{m}$, and the product $S_L^0 L_M \\kappa$ has units of $\\mathrm{m/s}$. Combining the Taylor expansion with the definition of $L_M$, the leading-order model becomes\n$$\nS_L(\\kappa) \\approx S_L^0 - S_L^0 \\, L_M \\, \\kappa.\n$$\nIntroducing the linear regression parameters\n$$\na := S_L^0, \\qquad b := \\left.\\frac{\\partial S_L}{\\partial \\kappa}\\right|_{\\kappa=0} = - S_L^0 \\, L_M,\n$$\nwe can write $S_L(\\kappa) \\approx a + b \\kappa$. Solving for the Markstein length in terms of $a$ and $b$ gives\n$$\nL_M = -\\frac{b}{a}.\n$$\nThe Markstein number is defined as\n$$\nM_a = \\frac{L_M}{\\delta_L},\n$$\nwhere $\\delta_L$ is the laminar flame thickness.\n\nWe next construct a statistically sound estimator for $a$ and $b$ using Weighted Least Squares (WLS). Suppose we have data $\\{(\\kappa_j, S_j, \\sigma_j)\\}_{j=1}^N$, where $S_j$ is the measured $S_L$ at curvature $\\kappa_j$, and $\\sigma_j$ is the reported standard deviation of $S_j$. We form the design matrix\n$$\nX = \\begin{bmatrix}\n1  \\kappa_1 \\\\\n\\vdots  \\vdots \\\\\n1  \\kappa_N\n\\end{bmatrix}, \\quad\n\\mathbf{y} = \\begin{bmatrix} S_1 \\\\ \\vdots \\\\ S_N \\end{bmatrix}, \\quad\nW = \\mathrm{diag}\\left(\\frac{1}{\\sigma_1^2}, \\ldots, \\frac{1}{\\sigma_N^2}\\right).\n$$\nUnder the assumption that measurement errors in $S_j$ are independent with variances $\\sigma_j^2$ and that $\\kappa_j$ is measured with negligible error, the WLS estimator is\n$$\n\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} \\hat{a} \\\\ \\hat{b} \\end{bmatrix}\n= \\left( X^\\top W X \\right)^{-1} X^\\top W \\mathbf{y}.\n$$\nThe parameter covariance matrix is\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\left( X^\\top W X \\right)^{-1},\n$$\nbecause $W = \\Sigma^{-1}$ with $\\Sigma = \\mathrm{diag}(\\sigma_1^2, \\ldots, \\sigma_N^2)$.\n\nFrom $\\hat{a}$ and $\\hat{b}$ we compute the estimated Markstein length\n$$\n\\hat{L}_M = -\\frac{\\hat{b}}{\\hat{a}},\n$$\nand the estimated Markstein number\n$$\n\\hat{M}_a = \\frac{\\hat{L}_M}{\\delta_L}.\n$$\nTo quantify uncertainty, we use the delta method. Let $g(a,b) = -b/a$ so that $L_M = g(a,b)$. The gradient of $g$ is\n$$\n\\nabla g(a,b) = \\begin{bmatrix}\n\\frac{\\partial g}{\\partial a} \\\\\n\\frac{\\partial g}{\\partial b}\n\\end{bmatrix}\n= \\begin{bmatrix}\n\\frac{b}{a^2} \\\\\n-\\frac{1}{a}\n\\end{bmatrix}.\n$$\nThen, for small parameter uncertainty, the variance of $\\hat{L}_M$ is approximated by\n$$\n\\mathrm{Var}(\\hat{L}_M) \\approx \\nabla g(\\hat{a},\\hat{b})^\\top \\, \\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) \\, \\nabla g(\\hat{a},\\hat{b}),\n$$\nand the standard deviation is $\\sigma_{L_M} = \\sqrt{\\mathrm{Var}(\\hat{L}_M)}$. Since $\\delta_L$ is treated as known (non-random) in this estimation, the variance of $\\hat{M}_a$ is\n$$\n\\mathrm{Var}(\\hat{M}_a) \\approx \\frac{\\mathrm{Var}(\\hat{L}_M)}{\\delta_L^2},\n$$\nand $\\sigma_{M_a} = \\sqrt{\\mathrm{Var}(\\hat{M}_a)}$.\n\nData construction for the test suite follows the controlled wrinkling geometry. For each case with amplitude $A$ and wavelength $\\lambda$, the wavenumber is $k = 2\\pi/\\lambda$, the phases are $\\phi_j = 2\\pi j/N$ in radians for $j = 0, 1, \\ldots, N-1$ with $N = 21$, and the curvature samples are\n$$\n\\kappa_j = -A k^2 \\sin(\\phi_j).\n$$\nThe measured burning velocity at each sample, in $\\mathrm{m/s}$, is\n$$\nS_j = S_L^0 - S_L^0 \\, L_M \\, \\kappa_j + \\epsilon_1 \\cos(2 \\phi_j) + \\epsilon_2 \\sin(3 \\phi_j),\n$$\nand the reported standard deviation for WLS weighting is\n$$\n\\sigma_j = \\sigma_0 + \\sigma_1 \\, |\\kappa_j|.\n$$\nThese formulas ensure deterministic data generation consistent with geometrically controlled curvature and plausible, heteroskedastic measurement uncertainties.\n\nAlgorithmic steps implemented in the program:\n1. For each case, compute $k$, the phase array $\\{\\phi_j\\}$, the curvature array $\\{\\kappa_j\\}$, the measured velocities $\\{S_j\\}$, and the standard deviations $\\{\\sigma_j\\}$ using the specified parameters and units.\n2. Assemble $X$, $\\mathbf{y}$, and $W$. Compute $\\hat{\\boldsymbol{\\beta}}$, $\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}})$, $\\hat{L}_M$, and $\\hat{M}_a$ using the formulas above.\n3. Compute $\\sigma_{L_M}$ and $\\sigma_{M_a}$ by covariance propagation via the delta method.\n4. For each case, return the list $[\\hat{a}, \\hat{L}_M, \\hat{M}_a, \\sigma_{L_M}, \\sigma_{M_a}]$, where $\\hat{a}$ is in $\\mathrm{m/s}$, $\\hat{L}_M$ is in $\\mathrm{m}$, and $\\hat{M}_a$ is dimensionless. Aggregate the three results into a single bracketed list and print as a single line.\n\nThis approach integrates physical reasoning from diffusive–thermal instability with statistically principled estimation and uncertainty quantification, suitable for extracting the Markstein number from DNS-like data obtained under controlled flame wrinkling.",
            "answer": "```python\nimport numpy as np\n\ndef weighted_linear_fit(kappa, S_meas, sigma_S):\n    \"\"\"\n    Perform weighted least squares fit of S = a + b * kappa.\n    Returns a, b, and covariance matrix of [a, b].\n    \"\"\"\n    # Design matrix X: first column ones (intercept), second column kappa\n    X = np.column_stack([np.ones_like(kappa), kappa])\n    # Weights: W = diag(1/sigma^2)\n    w = 1.0 / (sigma_S ** 2)\n    W = np.diag(w)\n    # Compute (X^T W X)^-1 and X^T W y\n    XT_W = X.T * w  # broadcasting weights across rows\n    XT_W_X = XT_W @ X\n    XT_W_y = XT_W @ S_meas\n    # Solve for beta = [a, b]\n    cov_beta = np.linalg.inv(XT_W_X)\n    beta = cov_beta @ XT_W_y\n    a, b = beta[0], beta[1]\n    return a, b, cov_beta\n\ndef delta_method_std_LM(a, b, cov_beta, delta_L):\n    \"\"\"\n    Compute standard deviations of L_M = -b/a and M_a = L_M / delta_L via delta method.\n    \"\"\"\n    # Gradient of L_M wrt [a, b]: [b/a^2, -1/a]\n    grad = np.array([b / (a**2), -1.0 / a])\n    var_LM = grad @ (cov_beta @ grad)\n    sigma_LM = np.sqrt(var_LM)\n    sigma_Ma = sigma_LM / delta_L\n    return sigma_LM, sigma_Ma\n\ndef construct_case(A, lam, SL0, LM_true, delta_L, eps1, eps2, sigma0, sigma1, N=21):\n    \"\"\"\n    Construct deterministic dataset based on sinusoidal wrinkling and specified parameters.\n    Returns kappa array, S_meas array, sigma_S array, and delta_L.\n    \"\"\"\n    k = 2.0 * np.pi / lam\n    j = np.arange(N)\n    phi = 2.0 * np.pi * j / N  # radians\n    # Small-slope curvature\n    kappa = -A * (k**2) * np.sin(phi)\n    # Measured S_L with deterministic biases\n    S_meas = SL0 - SL0 * LM_true * kappa + eps1 * np.cos(2.0 * phi) + eps2 * np.sin(3.0 * phi)\n    # Reported standard deviations (heteroskedastic by |kappa|)\n    sigma_S = sigma0 + sigma1 * np.abs(kappa)\n    return kappa, S_meas, sigma_S, delta_L\n\ndef solve():\n    # Define test cases with parameters as specified in the problem statement.\n    test_params = [\n        # Case 1\n        {\n            \"A\": 0.004, \"lam\": 0.10, \"SL0\": 0.40, \"LM_true\": 0.0008, \"delta_L\": 0.0005,\n            \"eps1\": 0.00035, \"eps2\": 0.00015, \"sigma0\": 0.0004, \"sigma1\": 0.00001\n        },\n        # Case 2\n        {\n            \"A\": 0.006, \"lam\": 0.08, \"SL0\": 0.35, \"LM_true\": -0.0003, \"delta_L\": 0.0005,\n            \"eps1\": 0.00030, \"eps2\": -0.00010, \"sigma0\": 0.0005, \"sigma1\": 0.00002\n        },\n        # Case 3\n        {\n            \"A\": 0.001, \"lam\": 0.12, \"SL0\": 0.42, \"LM_true\": 0.0005, \"delta_L\": 0.0004,\n            \"eps1\": 0.00050, \"eps2\": 0.00020, \"sigma0\": 0.0006, \"sigma1\": 0.000005\n        },\n    ]\n\n    results = []\n    for params in test_params:\n        kappa, S_meas, sigma_S, delta_L = construct_case(**params)\n        # Weighted least squares fit\n        a, b, cov_beta = weighted_linear_fit(kappa, S_meas, sigma_S)\n        # Markstein length and number\n        LM_est = -b / a\n        Ma_est = LM_est / delta_L\n        # Uncertainty via delta method\n        sigma_LM, sigma_Ma = delta_method_std_LM(a, b, cov_beta, delta_L)\n        # Collect results: [a (m/s), L_M (m), M_a (-), sigma_LM (m), sigma_Ma (-)]\n        results.append([a, LM_est, Ma_est, sigma_LM, sigma_Ma])\n\n    # Final print statement in the exact required format.\n    # Single line, comma-separated, enclosed in square brackets.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}