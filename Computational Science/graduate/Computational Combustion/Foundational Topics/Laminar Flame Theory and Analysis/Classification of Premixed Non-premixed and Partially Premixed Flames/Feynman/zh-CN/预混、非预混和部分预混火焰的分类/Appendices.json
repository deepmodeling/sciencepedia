{
    "hands_on_practices": [
        {
            "introduction": "我们从一个经典的分析练习——Burke-Schumann扩散火焰模型开始。该模型将燃烧过程简化为在化学计量比界面上发生的无限快反应，使我们能够专注于燃料和氧化剂的输运过程。通过从第一性原理推导混合分数的分布，你将对扩散如何控制非预混火焰的结构和位置有一个基本的、解析性的理解。",
            "id": "4012508",
            "problem": "考虑两个形成平面混合层的平行、同向、等温流，该混合层沿流向坐标 $x$ 对齐，且仅在横向坐标 $y$ 上变化。上方气流 ($y>0$) 为纯燃料，其燃料质量分数为 $Y_{F}=1$，氧化剂质量分数为 $Y_{O}=0$；而下方气流 ($y0$) 为纯氧化剂，其 $Y_{O}=1$，$Y_{F}=0$。两股气流均具有均匀的密度、恒定的输运性质和相等的组分扩散系数，并以相同的均匀速度 $u$ 沿 $x$ 方向流动。流动是稳态的，且雷诺数足够高，以至于轴向扩散相对于轴向对流可以忽略不计。$y$ 方向的分子扩散控制着横向混合。假设燃料和氧化剂之间的化学反应速率无限快，因此 Burke–Schumann 近似（反应局限在满足化学计量的薄面上）有效。化学计量的氧化剂与燃料质量比为 $s>0$，且组分的路易斯数均为1。\n\n在这些假设下，混合分数 $Z(y,x)$ 是一个守恒标量，遵循一维稳态对流扩散方程\n$$\nu\\,\\frac{\\partial Z}{\\partial x} \\;=\\; D\\,\\frac{\\partial^{2} Z}{\\partial y^{2}},\n$$\n对于 $-\\infty  y  \\infty$ 且 $x > 0$。推导出火焰形状 $y_f(x)$ 及其在给定下游位置 $x$ 处的斜率 $dy_f/dx$ 的表达式。将这两个量作为二元组 $(y_f(x), dy_f/dx)$ 的两个分量放在一个答案框中。",
            "solution": "用户希望我解决一个计算燃烧学中的问题。\n\n我的计划如下：\n1.  **验证问题**：\n    *   **第1步：提取已知信息**：我将列出问题陈述中提供的所有信息。\n        *   几何形状：两个平行的、同向的、等温的气流。平面混合层。\n        *   坐标系：$x$ 是流向， $y$ 是横向。\n        *   上方气流 ($y>0$)：纯燃料，$Y_F=1$, $Y_O=0$。\n        *   下方气流 ($y0$)：纯氧化剂，$Y_O=1$, $Y_F=0$。\n        *   流动性质：密度均匀，输运性质恒定，组分扩散系数相等 ($Le=1$)。\n        *   速度：两股气流在 $x$ 方向上均具有均匀速度 $u$。\n        *   流动状态：稳态流，高雷诺数（轴向扩散可忽略）。\n        *   混合机理：$y$ 方向的分子扩散。\n        *   化学反应：无限快反应（Burke–Schumann 近似）。反应发生在化学计量面上。\n        *   化学计量：化学计量氧化剂与燃料质量比为 $s > 0$。\n        *   混合分数 $Z(y,x)$ 的控制方程：$u\\,\\frac{\\partial Z}{\\partial x} \\;=\\; D\\,\\frac{\\partial^{2} Z}{\\partial y^{2}}$，适用于 $-\\infty  y  \\infty$ 且 $x>0$。\n        *   边界条件：$Z(y \\to \\infty) = 1$，$Z(y \\to -\\infty) = 0$。\n    *   **第2步：使用提取的给定信息进行验证**：该问题是经典的 Burke-Schumann 问题，具有科学依据，且定义明确。\n    *   **第3步：得出结论**：问题有效。\n2.  **制定解决方案**：\n    *   **第1步：求解 $Z(y,x)$**：这是一个抛物线型偏微分方程，可以通过变量代换 $\\eta = y/\\sqrt{x}$ 将其转化为常微分方程，也可以通过相似性解或傅里叶变换求解。由于其形式类似于热传导方程，其解的形式为误差函数。\n        *   利用相似变量 $\\eta = y / \\sqrt{4Dx/u}$，方程变为 $-2\\eta \\frac{dZ}{d\\eta} = \\frac{d^2Z}{d\\eta^2}$。\n        *   该方程的解为 $Z(\\eta) = A \\int_0^\\eta e^{-t^2} dt + B = A' \\text{erf}(\\eta) + B$。\n        *   应用边界条件 $Z(\\eta \\to \\infty) = 1$ 和 $Z(\\eta \\to -\\infty) = 0$，我们得到 $Z(\\eta) = \\frac{1}{2}(1+\\text{erf}(\\eta))$。\n        *   代回原变量，我们得到 $Z(y,x) = \\frac{1}{2}\\left(1 + \\text{erf}\\left(\\frac{y}{2\\sqrt{Dx/u}}\\right)\\right)$。\n    *   **第2步：确定火焰位置 $y_f(x)$**：火焰位于化学计量混合分数 $Z=Z_{st}$ 处。\n        *   $Z_{st}$ 与氧化剂-燃料质量比 $s$ 的关系为 $Z_{st} = \\frac{1}{1+s}$。\n        *   设置 $Z(y_f,x) = Z_{st}$ 并求解 $y_f$：$\\frac{1}{1+s} = \\frac{1}{2}\\left(1 + \\text{erf}\\left(\\frac{y_f}{2\\sqrt{Dx/u}}\\right)\\right)$。\n        *   $2/(1+s) - 1 = \\text{erf}\\left(\\frac{y_f}{2\\sqrt{Dx/u}}\\right)$\n        *   $\\frac{1-s}{1+s} = \\text{erf}\\left(\\frac{y_f}{2\\sqrt{Dx/u}}\\right)$\n        *   $y_f(x) = 2\\sqrt{\\frac{Dx}{u}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$。\n    *   **第3步：计算斜率 $dy_f/dx$**：对 $y_f(x)$ 求关于 $x$ 的导数。\n        *   $y_f(x) = C \\sqrt{x}$，其中 $C = 2\\sqrt{D/u} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$。\n        *   $\\frac{dy_f}{dx} = C \\cdot \\frac{1}{2\\sqrt{x}} = \\frac{1}{2\\sqrt{x}} \\left( 2\\sqrt{\\frac{D}{u}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right) \\right) = \\sqrt{\\frac{D}{ux}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right)$。\n    *   **第4步：整合答案**：将 $y_f(x)$ 和 $dy_f/dx$ 的表达式放入所要求的元组格式中。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 2\\sqrt{\\frac{Dx}{u}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right) \\\\ \\sqrt{\\frac{D}{ux}} \\text{erf}^{-1}\\left(\\frac{1-s}{1+s}\\right) \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理想化的无限速率化学反应模型之外，真实的火焰由化学反应速率和流体输运速率之间的竞争所决定。本练习将引导你通过编程，使用点火延迟（化学）和驻留/混合时间（输运）的简化模型来探索这种平衡。通过计算这些特征时间尺度，你将学习如何识别潜在的自燃区域，并根据混合与化学反应时间的比率对整个燃烧状态进行分类。",
            "id": "4012540",
            "problem": "您的任务是设计并实现一个计算程序，使用基于科学原理的详细化学反应替代模型，对典型的非预混剪切层沿线的局部火焰区域进行划分，并识别易自燃区域。这项工作必须基于第一性原理进行构建，且最终必须形成一个完整的、可运行的程序，该程序能够为指定的测试套件输出数值结果。物理背景是一个由两股流（燃料流和氧化剂流）形成的平面剪切层。分类目标是区分预混、非预混和部分预混火焰，而自燃分析的目标是通过比较停留时间与点火延迟时间来研究抬举火焰的稳定性。\n\n基本定义和模型假设：\n- 两股流之间的混合物由 Bilger 混合分数 $Z$ 表示，$Z=0$ 表示纯氧化剂，$Z=1$ 表示纯燃料。甲烷–空气的化学计量混合分数取为 $Z_{\\mathrm{st}} = 0.055$。\n- 局部混合物温度通过两股流的绝热、等压混合来建模，使用凸组合 $T(Z) = Z \\, T_F + (1-Z)\\, T_O$，其中 $T_F$ 是燃料流温度，$T_O$ 是氧化剂流温度。所有温度必须以开尔文（Kelvin）为单位提供和解释。\n- 假设压力恒定，点火延迟由一个 Arrhenius 定律建模，并辅以一个对偏离化学计量的行为进行惩罚的组分敏感性因子。具体而言，点火延迟为\n$$\n\\tau_{\\mathrm{ign}}(Z) = A \\,\\exp\\!\\left(\\frac{E/R}{T(Z)}\\right)\\, g(Z),\n$$\n其中\n$$\ng(Z) = 1 + \\alpha\\left(\\frac{Z}{Z_{\\mathrm{st}}} + \\frac{Z_{\\mathrm{st}}}{Z} - 2\\right),\n$$\n根据算术平均-几何平均不等式 (AM–GM)，该式在 $Z=Z_{\\mathrm{st}}$ 时达到其最小值。参数为 $A=10^{-7}\\,\\mathrm{s}$、$E/R=12000\\,\\mathrm{K}$ 和 $\\alpha=3$，选择这些参数是为了在指定温度范围内产生与甲烷–空气动力学趋势一致的点火延迟。为避免除以零，凡是 $Z$ 出现在有理表达式中的地方，计算时必须使用有效混合分数 $Z_{\\mathrm{eff}} = \\max(\\min(Z,1-10^{-5}),10^{-5})$。\n- 剪切层坐标 $s$ 跨越区间 $[0,L_s]$，层内的混合分数分布建模为\n$$\nZ(s) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{s - L_s/2}{w}\\right)\\right],\n$$\n其中 $L_s$ 是跨度长度，$w$ 控制过渡层的厚度。坐标 $s$ 被均匀离散化为 $N$ 个点。\n- 停留时间通过对流估算建模\n$$\nt_{\\mathrm{res}} = \\frac{L_{\\mathrm{ref}}}{U},\n$$\n其中 $L_{\\mathrm{ref}}$ 是到潜在稳定区域的参考轴向长度，$U$ 是特征对流速度，单位分别为 $\\mathrm{m}$ 和 $\\mathrm{m/s}$，从而得到单位为 $\\mathrm{s}$ 的 $t_{\\mathrm{res}}$。\n- 混合时间通过扩散时间尺度定义\n$$\nt_{\\mathrm{mix}} = \\frac{\\lambda^2}{D},\n$$\n其中 $\\lambda$ 是特征剪切层厚度，$D$ 是代表性物质扩散系数，从而得到单位为 $\\mathrm{s}$ 的 $t_{\\mathrm{mix}}$。\n\n易自燃区域识别：\n- 在每个离散位置 $s_i$，计算 $\\tau_{\\mathrm{ign}}(Z(s_i))$ 并与 $t_{\\mathrm{res}}$ 进行比较。如果 $\\tau_{\\mathrm{ign}}(Z(s_i)) \\le t_{\\mathrm{res}}$，则位置 $s_i$ 被认为是易自燃的。\n\n火焰区域划分：\n- 使用比率\n$$\nP = \\frac{t_{\\mathrm{mix}}}{\\min_i \\tau_{\\mathrm{ign}}(Z(s_i))},\n$$\n根据以下规则对测试案例的区域进行划分：\n    - 非预混：$P \\ge 3$。\n    - 部分预混：$0.3  P  3$。\n    - 预混：$P \\le 0.3$。\n对于输出编码，使用整数：非预混 $=0$，部分预混 $=1$，预混 $=2$。\n\n单位：\n- 所有长度必须以 $\\mathrm{m}$ 为单位处理和报告，速度以 $\\mathrm{m/s}$ 为单位，温度以 $\\mathrm{K}$ 为单位，时间以 $\\mathrm{s}$ 为单位，输出必须是无单位的整数和整数列表，如规范所述。\n\n程序输出规范：\n- 您的程序必须生成单行输出，其中包含所有测试案例的结果，格式为用方括号括起来的逗号分隔列表。每个测试案例的结果必须是一个双元素列表，形式为 $[c,[i_1,i_2,\\dots]]$，其中 $c$ 是为整个测试案例定义的分类代码整数，$[i_1,i_2,\\dots]$ 是易自燃位置 $s_i$ 的整数索引列表，按升序排列。如果没有索引满足自燃判据，则使用空列表 $[]$。\n- 除了这个单行列表外，程序输出中不允许有任何额外的文本或格式。\n\n测试套件：\n为保证科学覆盖性，请使用给定的参数评估以下三个案例。所有常数必须完全按所列使用，所有数字必须按上述单位进行解释。\n\n- 案例 1（热伴流、高速射流、较厚混合层，预期在 $Z_{\\mathrm{st}}$ 附近发生非预混自燃）：\n    - $T_F = 300$，$T_O = 1400$，$U = 50$，$L_{\\mathrm{ref}} = 0.1$，$\\lambda = 0.001$，$D = 1\\times 10^{-4}$，$L_s = 0.02$，$w = 0.002$，$N = 51$。\n- 案例 2（冷伴流、高速射流、薄混合层，预期不发生自燃）：\n    - $T_F = 300$，$T_O = 800$，$U = 50$，$L_{\\mathrm{ref}} = 0.1$，$\\lambda = 0.0005$，$D = 1\\times 10^{-4}$，$L_s = 0.02$，$w = 0.002$，$N = 51$。\n- 案例 3（中等预热、慢速射流、中等厚度混合层，预期为部分预混并带有自燃区）：\n    - $T_F = 300$，$T_O = 1100$，$U = 5$，$L_{\\mathrm{ref}} = 0.1$，$\\lambda = 0.0009$，$D = 1\\times 10^{-4}$，$L_s = 0.02$，$w = 0.0015$，$N = 51$。\n\n您的程序必须计算每个案例的分类代码和易自燃索引列表，并按上述描述打印单行聚合输出，例如，格式为 $[[c_1,[i_{1,1},\\dots]],[c_2,[\\dots]],[c_3,[\\dots]]]$。",
            "solution": "用户提供了一个问题，要求开发一个计算程序，用于在典型的非预混剪切层中划分火焰区域并识别易自燃区域。该问题具有科学依据，是良态的，并提供了所有必要的参数和模型。验证过程确认了其有效性。\n\n### 步骤 1：提取给定条件\n\n**物理常数和模型参数：**\n-   甲烷–空气的化学计量混合分数：$Z_{\\mathrm{st}} = 0.055$。\n-   点火延迟指前因子：$A = 10^{-7}\\,\\mathrm{s}$。\n-   归一化活化能：$E/R = 12000\\,\\mathrm{K}$。\n-   点火延迟的组分敏感性因子：$\\alpha = 3$。\n\n**数学模型：**\n-   温度作为混合分数 $Z$ 的函数：$T(Z) = Z \\, T_F + (1-Z)\\, T_O$，其中 $T_F$ 是燃料流温度，$T_O$ 是氧化剂流温度。\n-   点火延迟作为混合分数 $Z$ 的函数：\n    $$\n    \\tau_{\\mathrm{ign}}(Z) = A \\,\\exp\\!\\left(\\frac{E/R}{T(Z)}\\right)\\, g(Z)\n    $$\n    其中组分依赖项为\n    $$\n    g(Z) = 1 + \\alpha\\left(\\frac{Z}{Z_{\\mathrm{st}}} + \\frac{Z_{\\mathrm{st}}}{Z} - 2\\right).\n    $$\n-   用于数值稳定性的有效混合分数：在有理表达式中使用 $Z_{\\mathrm{eff}} = \\max(\\min(Z,1-10^{-5}),10^{-5})$ 代替 $Z$。\n-   剪切层混合分数在坐标 $s \\in [0, L_s]$ 上的分布：\n    $$\n    Z(s) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{s - L_s/2}{w}\\right)\\right],\n    $$\n    其中 $L_s$ 是跨度长度，$w$ 是厚度参数。坐标 $s$ 被离散化为 $N$ 个点。\n-   对流停留时间：$t_{\\mathrm{res}} = L_{\\mathrm{ref}}/U$，其中 $L_{\\mathrm{ref}}$ 为参考长度，$U$ 为特征速度。\n-   扩散混合时间：$t_{\\mathrm{mix}} = \\lambda^2/D$，其中 $\\lambda$ 为特征厚度，$D$ 为扩散系数。\n\n**分类和识别标准：**\n-   易自燃区域：如果 $\\tau_{\\mathrm{ign}}(Z(s_i)) \\le t_{\\mathrm{res}}$，则位置 $s_i$ 易于自燃。\n-   火焰区域划分参数：$P = \\frac{t_{\\mathrm{mix}}}{\\min_i \\tau_{\\mathrm{ign}}(Z(s_i))}$。\n    -   非预混：$P \\ge 3$（编码为 $0$）。\n    -   部分预混：$0.3  P  3$（编码为 $1$）。\n    -   预混：$P \\le 0.3$（编码为 $2$）。\n\n**测试套件数据：**\n-   **案例 1：** $T_F = 300\\,\\mathrm{K}$，$T_O = 1400\\,\\mathrm{K}$，$U = 50\\,\\mathrm{m/s}$，$L_{\\mathrm{ref}} = 0.1\\,\\mathrm{m}$，$\\lambda = 0.001\\,\\mathrm{m}$，$D = 1\\times 10^{-4}\\,\\mathrm{m^2/s}$，$L_s = 0.02\\,\\mathrm{m}$，$w = 0.002\\,\\mathrm{m}$，$N = 51$。\n-   **案例 2：** $T_F = 300\\,\\mathrm{K}$，$T_O = 800\\,\\mathrm{K}$，$U = 50\\,\\mathrm{m/s}$，$L_{\\mathrm{ref}} = 0.1\\,\\mathrm{m}$，$\\lambda = 0.0005\\,\\mathrm{m}$，$D = 1\\times 10^{-4}\\,\\mathrm{m^2/s}$，$L_s = 0.02\\,\\mathrm{m}$，$w = 0.002\\,\\mathrm{m}$，$N = 51$。\n-   **案例 3：** $T_F = 300\\,\\mathrm{K}$，$T_O = 1100\\,\\mathrm{K}$，$U = 5\\,\\mathrm{m/s}$，$L_{\\mathrm{ref}} = 0.1\\,\\mathrm{m}$，$\\lambda = 0.0009\\,\\mathrm{m}$，$D = 1\\times 10^{-4}\\,\\mathrm{m^2/s}$，$L_s = 0.02\\,\\mathrm{m}$，$w = 0.0015\\,\\mathrm{m}$，$N = 51$。\n\n### 步骤 2：使用提取的给定条件进行验证\n\n该问题具有科学依据，采用了燃烧理论中的标准概念，如混合分数、Arrhenius 动力学和特征时间尺度（Damköhler 数分析）。这些模型虽然简化（例如，线性温度分布、单步动力学替代模型），但对于基于第一性原理的计算分析是合适的，并且公式正确。使用 $Z_{\\mathrm{eff}}$ 是处理潜在奇异点的标准数值技术。基于混合与化学时间之比（$P$）的火焰区域划分标准是燃烧区域图的基石。自燃判据是点火延迟与停留时间比较的直接应用。该问题是良态的，为每个测试案例指定了所有必需的参数，并且计算任务定义明确。语言客观而精确。\n\n### 步骤 3：结论与行动\n该问题**有效**。现在将开发一个计算解决方案。\n\n### 基于原理的解决方案设计\n\n解决方案将以 Python 程序的形式实现，该程序系统地处理问题陈述中定义的每个测试案例。每个案例的总体逻辑如下，遵循指定的物理模型和计算过程。\n\n**1. 剪切层的离散化：**\n剪切层定义在从 $0$ 到 $L_s$ 的空间坐标 $s$ 上。该域被离散化为 $N$ 个均匀间隔的点，表示为集合 $\\{s_i\\}_{i=0}^{N-1}$。\n$$\ns_i = i \\frac{L_s}{N-1} \\quad \\text{其中 } i = 0, 1, \\dots, N-1.\n$$\n\n**2. 混合分数和温度分布：**\n对于离散域中的每个点 $s_i$，我们首先使用提供的双曲正切函数分布计算局部混合分数 $Z(s_i)$：\n$$\nZ(s_i) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{s_i - L_s/2}{w}\\right)\\right].\n$$\n随后，使用线性混合法则确定局部温度 $T(Z(s_i))$：\n$$\nT(Z(s_i)) = Z(s_i) \\, T_F + (1-Z(s_i))\\, T_O.\n$$\n\n**3. 点火延迟计算：**\n在每个点 $s_i$ 处计算点火延迟 $\\tau_{\\mathrm{ign}}$。这需要计算依赖于组分的项 $g(Z)$ 和 Arrhenius 项。为了数值稳定性，在 $g(Z)$ 内的有理表达式中的 $Z$ 被替换为 $Z_{\\mathrm{eff}}$：\n$$\nZ_{\\mathrm{eff}}(s_i) = \\max(\\min(Z(s_i),1-10^{-5}),10^{-5}).\n$$\n然后，$g(Z(s_i))$ 函数为：\n$$\ng(Z(s_i)) = 1 + \\alpha\\left(\\frac{Z_{\\mathrm{eff}}(s_i)}{Z_{\\mathrm{st}}} + \\frac{Z_{\\mathrm{st}}}{Z_{\\mathrm{eff}}(s_i)} - 2\\right).\n$$\n点火延迟分布 $\\tau_{\\mathrm{ign}}(Z(s_i))$ 最终计算为：\n$$\n\\tau_{\\mathrm{ign}}(Z(s_i)) = A \\,\\exp\\!\\left(\\frac{E/R}{T(Z(s_i))}\\right)\\, g(Z(s_i)).\n$$\n\n**4. 特征时间尺度：**\n为每个测试案例计算两个全局特征时间：对流停留时间 $t_{\\mathrm{res}}$ 和扩散混合时间 $t_{\\mathrm{mix}}$。\n$$\nt_{\\mathrm{res}} = \\frac{L_{\\mathrm{ref}}}{U} \\quad \\text{和} \\quad t_{\\mathrm{mix}} = \\frac{\\lambda^2}{D}.\n$$\n\n**5. 自燃区域识别：**\n在每个离散点 $s_i$ 处评估自燃判据 $\\tau_{\\mathrm{ign}}(Z(s_i)) \\le t_{\\mathrm{res}}$。满足此条件的整数索引集合 $\\{i\\}$ 构成了易自燃区域。这些索引将按升序收集到一个列表中。\n\n**6. 火焰区域划分：**\n火焰区域由参数 $P$ 确定。首先，找到整个剪切层上的最小点火延迟 $\\tau_{\\mathrm{ign,min}}$：\n$$\n\\tau_{\\mathrm{ign,min}} = \\min_{i} \\tau_{\\mathrm{ign}}(Z(s_i)).\n$$\n然后，参数 $P$ 计算为混合时间与此最小化学时间之比：\n$$\nP = \\frac{t_{\\mathrm{mix}}}{\\tau_{\\mathrm{ign,min}}}.\n$$\n根据 $P$ 的值对区域进行分类：\n-   若 $P \\ge 3$，分类代码为 $c=0$（非预混）。\n-   若 $0.3  P  3$，分类代码为 $c=1$（部分预混）。\n-   若 $P \\le 0.3$，分类代码为 $c=2$（预混）。\n\n**7. 最终输出生成：**\n对于每个测试案例，结果被编译成一个双元素列表：`[分类代码, 自燃索引列表]`。所有测试案例的最终输出是一个表示这些结果列表的单行字符串，格式如规范所述。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the computational combustion problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: hot coflow, fast jet, thicker mixing\n        {\n            \"T_F\": 300, \"T_O\": 1400, \"U\": 50, \"L_ref\": 0.1, \"lambda\": 0.001,\n            \"D\": 1e-4, \"L_s\": 0.02, \"w\": 0.002, \"N\": 51\n        },\n        # Case 2: cold coflow, fast jet, thin mixing\n        {\n            \"T_F\": 300, \"T_O\": 800, \"U\": 50, \"L_ref\": 0.1, \"lambda\": 0.0005,\n            \"D\": 1e-4, \"L_s\": 0.02, \"w\": 0.002, \"N\": 51\n        },\n        # Case 3: moderate preheat, slow jet, intermediate mixing\n        {\n            \"T_F\": 300, \"T_O\": 1100, \"U\": 5, \"L_ref\": 0.1, \"lambda\": 0.0009,\n            \"D\": 1e-4, \"L_s\": 0.02, \"w\": 0.0015, \"N\": 51\n        }\n    ]\n    \n    # Foundational constants\n    Z_st = 0.055\n    A = 1e-7\n    E_over_R = 12000\n    alpha = 3.0\n\n    all_results = []\n    \n    for params in test_cases:\n        # Unpack parameters for the current case\n        T_F = params[\"T_F\"]\n        T_O = params[\"T_O\"]\n        U = params[\"U\"]\n        L_ref = params[\"L_ref\"]\n        lambda_mix = params[\"lambda\"]\n        D = params[\"D\"]\n        L_s = params[\"L_s\"]\n        w = params[\"w\"]\n        N = params[\"N\"]\n\n        # 1. Discretization of the shear layer\n        s = np.linspace(0, L_s, N)\n        \n        # 2. Mixture fraction and temperature profiles\n        Z = 0.5 * (1 + np.tanh((s - L_s / 2) / w))\n        T = Z * T_F + (1 - Z) * T_O\n        \n        # 3. Ignition delay calculation\n        # Use effective Z to avoid division by zero\n        Z_eff = np.clip(Z, 1e-5, 1 - 1e-5)\n        g_Z = 1 + alpha * (Z_eff / Z_st + Z_st / Z_eff - 2)\n        tau_ign = A * np.exp(E_over_R / T) * g_Z\n        \n        # 4. Characteristic timescales\n        t_res = L_ref / U\n        t_mix = lambda_mix**2 / D\n        \n        # 5. Autoignition zone identification\n        autoignition_indices = np.where(tau_ign = t_res)[0].tolist()\n        \n        # 6. Flame regime classification\n        tau_ign_min = np.min(tau_ign)\n        P = t_mix / tau_ign_min\n        \n        if P >= 3:\n            classification_code = 0  # Non-premixed\n        elif P > 0.3:\n            classification_code = 1  # Partially premixed\n        else:\n            classification_code = 2  # Premixed\n            \n        all_results.append([classification_code, autoignition_indices])\n\n    def format_case_result(case_result):\n        \"\"\"Custom formatter to produce output string with no spaces.\"\"\"\n        class_code, indices = case_result\n        indices_str = f\"[{','.join(map(str, indices))}]\"\n        return f\"[{class_code},{indices_str}]\"\n\n    # Final print statement in the exact required format.\n    formatted_results = [format_case_result(res) for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "为了在复杂流动中高效地模拟燃烧，现代计算方法常依赖于“火焰面模型”。该方法的核心是构建一个火焰面数据库（或称“流形”），其中预先计算并存储了在不同混合速率下，火焰的关键属性如何随混合分数 $Z$ 变化。这项高级实践将指导你通过数值求解稳态火焰面方程来构建这样一个数据库，然后利用它对不同的燃烧状态（包括非预混、预混和部分预混模式）进行分类，这模拟了计算燃烧学中用于分析湍流-化学相互作用的前沿技术。",
            "id": "4012490",
            "problem": "您的任务是为甲烷-空气在混合分数空间中构建一个简化但科学上一致的稳态层流小火焰面，然后使用该小火焰面对局部燃烧模态进行分类，分类依据是混合分数和反应进程变量。整个工作在混合分数坐标 $Z \\in [0,1]$ 中进行，并假设刘易斯数为1且密度恒定。目标是根据基本定义和稳态小火焰平衡方程，设计一个数值上稳健、可实现且可测试的算法。\n\n需要使用的基本和核心定义：\n- Bilger混合分数 $Z$ 是一个守恒标量，它参数化了纯氧化剂 ($Z=0$) 和纯燃料 ($Z=1$) 之间的局部组分。对于甲烷-空气，化学计量混合分数约为 $Z_{st} = 0.055$。\n- 反应进程变量 $c$ 是一个有界标量，$c \\in [0,1]$，它随着反应物向产物的转化而单调增加。在燃烧模型中，一个常见的定义是 $c = (Y_{CO_2} + Y_{H_2O} + Y_{CO}) / (Y_{CO_2}^{eq} + Y_{H_2O}^{eq} + Y_{CO}^{eq})$，但在这里您将通过混合分数空间中的反应-扩散平衡来对 $c$ 进行建模。\n- 在混合分数坐标下，对于单位刘易斯数和恒定密度，稳态小火焰方程是扩散和化学反应之间的二阶平衡方程，\n$$\n\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z) = 0,\n$$\n其中 $\\chi$ 是标量耗散率（单位为 $\\text{s}^{-1}$），用于量化沿 $Z$ 方向的分子混合强度；$\\dot{\\omega}_c$ 是代表化学转化的源项。\n\n为使问题在计算上易于处理同时保持科学合理性而做的模型假设：\n- 使用一个以 $Z_{st}$ 为中心的局部化反应源来表示甲烷-空气扩散火焰反应区，\n$$\n\\dot{\\omega}_c(c,Z;\\chi) = k_0 \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma^2}\\right) \\, c(1-c) \\, \\max\\!\\left(0, 1 - \\frac{\\chi}{\\chi_{crit}}\\right),\n$$\n其中 $k_0$ 是有效化学反应速率常数，$\\sigma$ 是混合分数空间中反应区的宽度，$\\chi_{crit}$ 是临界标量耗散率，当超过该值时非预混小火焰会熄灭。假设 $Z_{st} = 0.055$，$k_0 = 60$（单位为 $\\text{s}^{-1}$），$\\sigma = 0.02$（在 $Z$ 中无量纲），以及 $\\chi_{crit} = 25$（单位为 $\\text{s}^{-1}$）。\n- 施加狄利克雷边界条件 $c(0) = 0$ 和 $c(1) = 0$，表示在边界处的纯氧化剂和纯燃料流中反应进程为零。\n- 为了将 $c$ 与温度联系起来以保证物理合理性，使用一个绝热映射\n$$\nT(Z,c) = T_u + c \\left[T_b(Z) - T_u\\right], \\quad T_b(Z) = T_u + \\Delta T_{max} \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma_T^2}\\right),\n$$\n其中 $T_u = 300$ (开尔文)，$\\Delta T_{max} = 1920$ (开尔文)，以及 $\\sigma_T = 0.04$。此温度并非最终输出所必需，但它是物理上合理的小火焰面的一部分。\n\n小火焰面的数值构建：\n- 对于集合 $\\{\\chi_1, \\chi_2, \\chi_3\\} = \\{5, 10, 30\\}$（单位为 $\\text{s}^{-1}$）中的每个标量耗散率，通过伪时间推进方法在 $Z \\in [0,1]$ 的均匀网格上求解稳态小火焰方程直至达到稳态。其中，扩散项采用隐式处理，反应项采用显式处理。空间网格至少包含 $N = 201$ 个点，并以稳定的步长进行时间推进，直到更新量的无穷范数低于 $10^{-8}$ 或达到最大迭代次数。最终得到的小火焰面是 $c(Z;\\chi)$，它是针对每个 $\\chi$ 在 $Z$ 上的列表。\n\n基于小火焰面的分类任务：\n- 对于一组由 $(\\chi, Z, c_{meas})$ 表征的局部状态，其中 $c_{meas}$ 是测量或预测的局部反应进程变量，使用通过插值评估的小火焰面值 $c_{ref} = c(Z;\\chi)$ 对燃烧模态进行分类。使用以下阈值和容差：\n  - 反应进程阈值 $c_{th} = 0.05$，\n  - 化学计量邻近度 $\\delta_Z = 0.02$，\n  - 一致性容差 $tol_c = 0.10$。\n- 分类规则如下：\n  1. 如果 $c_{ref}  c_{th}$ 且 $\\chi \\ge \\chi_{crit}$ 且 $c_{meas}  c_{th}$，则分类为代码 $4$ (熄灭的非预混小火焰)。\n  2. 否则，如果 $c_{ref} \\ge c_{th}$ 且 $|c_{meas} - c_{ref}| \\le tol_c$ 且 $|Z - Z_{st}| \\le \\delta_Z$，则分类为代码 $1$ (非预混小火焰燃烧)。\n  3. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| \\le \\delta_Z$，则分类为代码 $2$ (部分预混燃烧)。\n  4. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| > \\delta_Z$，则分类为代码 $3$ (预混燃烧)。\n  5. 否则分类为代码 $0$ (未燃或惰性混合物)。\n- 这些规则体现了物理思想：非预混火焰在 $Z_{st}$ 附近燃烧并与小火焰面匹配；部分预混燃烧发生在 $Z_{st}$ 附近但偏离非预混小火焰值；预混燃烧发生在远离 $Z_{st}$ 的地方并具有显著的反应进程。\n\n测试套件：\n使用以下七个测试用例，每个用例都是一个三元组 $(\\chi, Z, c_{meas})$，其中 $\\chi$ 的单位是 $\\text{s}^{-1}$，$Z$ 和 $c_{meas}$ 无量纲：\n- 用例 A: $(\\chi, Z, c_{meas}) = (10, 0.055, 0.80)$，\n- 用例 B: $(\\chi, Z, c_{meas}) = (10, 0.10, 0.60)$，\n- 用例 C: $(\\chi, Z, c_{meas}) = (10, 0.070, 0.40)$，\n- 用例 D: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.00)$，\n- 用例 E: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.50)$，\n- 用例 F: $(\\chi, Z, c_{meas}) = (5, 0.00, 0.00)$，\n- 用例 G: $(\\chi, Z, c_{meas}) = (5, 1.00, 0.00)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含七个案例的分类代码，形式为逗号分隔的列表并用方括号括起来（例如，$\"[1,3,2,4,3,0,0]\"$）。不应打印任何额外文本。所有物理单位已在其各自的定义中指定；输出本身是无量纲的整数代码。",
            "solution": "在尝试求解之前，问题陈述经过了严格的验证过程。\n\n### 步骤1：提取给定信息\n\n- **标量变量与坐标**：\n  - 混合分数：$Z \\in [0,1]$\n  - 反应进程变量：$c \\in [0,1]$\n- **物理常数与参数**：\n  - 化学计量混合分数：$Z_{st} = 0.055$\n  - 有效化学反应速率常数：$k_0 = 60 \\text{ s}^{-1}$\n  - $Z$空间中的反应区宽度：$\\sigma = 0.02$\n  - 临界标量耗散率：$\\chi_{crit} = 25 \\text{ s}^{-1}$\n  - 标量耗散率测试集：$\\{\\chi_1, \\chi_2, \\chi_3\\} = \\{5, 10, 30\\} \\text{ s}^{-1}$\n  - 温度映射参数：$T_u = 300 \\text{ K}$, $\\Delta T_{max} = 1920 \\text{ K}$, $\\sigma_T = 0.04$\n- **控制方程（稳态层流小火焰）**：\n  - $\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z) = 0$\n- **反应源项模型**：\n  - $\\dot{\\omega}_c(c,Z;\\chi) = k_0 \\exp\\!\\left(-\\frac{(Z - Z_{st})^2}{2\\sigma^2}\\right) \\, c(1-c) \\, \\max\\!\\left(0, 1 - \\frac{\\chi}{\\chi_{crit}}\\right)$\n- **边界条件**：\n  - 狄利克雷条件：$c(0) = 0$ 和 $c(1) = 0$\n- **数值参数**：\n  - 空间网格点数：$N \\ge 201$\n  - 伪时间推进的收敛容差：更新量的无穷范数 $ 10^{-8}$\n- **分类参数**：\n  - 反应进程阈值：$c_{th} = 0.05$\n  - 化学计量邻近度：$\\delta_Z = 0.02$\n  - 一致性容差：$tol_c = 0.10$\n- **分类规则**：\n  1. 如果 $c_{ref}  c_{th}$ 且 $\\chi \\ge \\chi_{crit}$ 且 $c_{meas}  c_{th}$，分类为代码 $4$。\n  2. 否则，如果 $c_{ref} \\ge c_{th}$ 且 $|c_{meas} - c_{ref}| \\le tol_c$ 且 $|Z - Z_{st}| \\le \\delta_Z$，分类为代码 $1$。\n  3. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| \\le \\delta_Z$，分类为代码 $2$。\n  4. 否则，如果 $c_{meas} \\ge c_{th}$ 且 $|Z - Z_{st}| > \\delta_Z$，分类为代码 $3$。\n  5. 否则分类为代码 $0$。\n- **测试套件**：\n  - 用例 A: $(\\chi, Z, c_{meas}) = (10, 0.055, 0.80)$\n  - 用例 B: $(\\chi, Z, c_{meas}) = (10, 0.10, 0.60)$\n  - 用例 C: $(\\chi, Z, c_{meas}) = (10, 0.070, 0.40)$\n  - 用例 D: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.00)$\n  - 用例 E: $(\\chi, Z, c_{meas}) = (30, 0.055, 0.50)$\n  - 用例 F: $(\\chi, Z, c_{meas}) = (5, 0.00, 0.00)$\n  - 用例 G: $(\\chi, Z, c_{meas}) = (5, 1.00, 0.00)$\n\n### 步骤2：使用提取的给定信息进行验证\n\n根据验证标准对问题进行评估：\n\n- **科学基础**：该问题建立在层流小火焰模型之上，这是湍流燃烧理论的基石。控制方程是混合分数空间中反应-扩散平衡的一个简化但标准的表示。所做的假设（单位刘易斯数，恒定密度）是创建易于处理但信息丰富的模型的常用方法。源项虽然是唯象的，但正确地捕捉了反应在化学计量比附近的局部化特性、其对反应物/产物浓度的依赖性（通过 $c(1-c)$），以及在高标量耗散率下火焰熄灭的物理现象。该问题作为一个燃烧建模的计算练习，在科学上是一致且合理的。\n- **适定性**：核心任务是求解一个一维、二阶、非线性的边值问题（BVP）。给定了狄利克雷边界条件 $c(0)=0$ 和 $c(1)=0$，该问题是适定的。建议的数值方法，即采用半隐式格式的伪时间推进，是解决此类边值问题的标准且稳健的技术。分类规则以一套完整且确定性的 `if-elif-else` 条件给出，保证了对任何输入都有唯一的分类。\n- **客观性**：所有参数、方程和规则都经过了精确的数学定义。没有主观或模糊的陈述。\n- **完整性与一致性**：问题是自洽的。所有必要的常数、方程、边界条件以及数值和分类参数都已提供。单位在整个问题中是一致的（例如，$k_0$ 和 $\\chi$ 的单位都是 $\\text{s}^{-1}$）。内部没有矛盾。\n- **其他缺陷**：该问题并非不切实际、不适定、微不足道或无法验证。它代表了计算科学中的一个标准数值任务。\n\n### 步骤3：结论与行动\n\n该问题是 **有效的**。它是一个适定的、有科学依据且精确定义的计算任务。可以继续进行求解。\n\n### 求解\n\n求解过程分为两个阶段：首先，数值构建层流小火焰面 $c(Z;\\chi)$；其次，利用该小火焰面对局部燃烧状态进行分类。\n\n**1. 小火焰面的构建**\n\n分析的基础是稳态层流小火焰方程，它描述了在混合分数 $Z$ 坐标系中，反应进程变量 $c$ 的分子扩散与化学反应之间的平衡：\n$$\n\\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z;\\chi) = 0\n$$\n这是一个非线性的二阶常微分方程，边界条件为 $c(Z=0)=0$ 和 $c(Z=1)=0$。我们对每个给定的标量耗散率 $\\chi \\in \\{5, 10, 30\\} \\, \\text{s}^{-1}$ 数值求解此方程。\n\n求解这类方程的一种稳健方法是伪时间推进，即将稳态方程重新表述为一个瞬态问题，其解会收敛到所需的稳态解：\n$$\n\\frac{\\partial c}{\\partial t} = \\chi \\frac{\\partial^2 c}{\\partial Z^2} + \\dot{\\omega}_c(c,Z;\\chi)\n$$\n我们将空间域 $Z \\in [0,1]$ 离散为 $N=201$ 个均匀分布的网格点 $Z_i = i \\Delta Z$，其中 $\\Delta Z = 1/(N-1)$。空间导数使用二阶中心差分格式近似：\n$$\n\\frac{\\partial^2 c}{\\partial Z^2}\\bigg|_{Z_i} \\approx \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta Z)^2}\n$$\n对于时间离散化，如建议所示，采用半隐式格式，对刚性的扩散项进行隐式处理，对非线性的反应项进行显式处理。使用隐式欧拉格式处理扩散，显式欧拉格式处理反应，在时间步 $n$ 求解时间步 $n+1$ 的解：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = \\chi \\left( \\frac{c_{i+1}^{n+1} - 2c_i^{n+1} + c_{i-1}^{n+1}}{(\\Delta Z)^2} \\right) + \\dot{\\omega}_c(c_i^n, Z_i; \\chi)\n$$\n整理各项，将所有未知值 $c^{n+1}$ 移到左侧：\n$$\n-\\alpha c_{i-1}^{n+1} + (1 + 2\\alpha) c_i^{n+1} - \\alpha c_{i+1}^{n+1} = c_i^n + \\Delta t \\cdot \\dot{\\omega}_c(c_i^n, Z_i; \\chi)\n$$\n其中 $\\alpha = \\chi \\Delta t / (\\Delta Z)^2$。该方程适用于所有内部网格点 $i=1, \\dots, N-2$。这构成了一个三对角线性方程组 $A \\mathbf{c}^{n+1} = \\mathbf{b}^n$，可以在每个时间步高效求解。该过程从 $c(Z, t=0)=0$ 开始，迭代进行，直到连续解之间的变化量 $\\|\\mathbf{c}^{n+1} - \\mathbf{c}^n\\|_{\\infty}$ 小于收敛容差 $10^{-8}$。\n\n对于 $\\chi \\ge \\chi_{crit}$ 的情况，项 $\\max(0, 1-\\chi/\\chi_{crit})$ 变为 $0$，使得反应源 $\\dot{\\omega}_c \\equiv 0$。控制方程简化为扩散方程 $\\chi \\frac{\\partial^2 c}{\\partial Z^2} = 0$，边界条件为 $c(0)=0$ 和 $c(1)=0$。其唯一解是平凡解 $c(Z) = 0$，代表化学熄灭状态。对于 $\\chi=30 \\, \\text{s}^{-1}$，我们直接使用这个解析结果。\n\n该过程最终得到三个不同的小火焰剖面，$c(Z; \\chi=5)$、$c(Z; \\chi=10)$ 和 $c(Z; \\chi=30)$，它们共同构成了小火焰面。\n\n**2. 燃烧模态的分类**\n\n计算出小火焰面后，我们可以对每个测试用例的局部状态 $(\\chi, Z_{meas}, c_{meas})$ 进行分类。分类的核心是将测量的反应进程变量 $c_{meas}$ 与来自小火焰面的参考值 $c_{ref} = c(Z_{meas}; \\chi)$ 进行比较。该参考值通过在位置 $Z_{meas}$ 处对预先计算的相应剖面 $c(Z;\\chi)$ 进行线性插值得到。\n\n然后，通过系统地应用给定的层级规则进行分类：\n1.  **代码 4 (熄灭的非预混小火焰)**：当标量耗散率 $\\chi$ 大于或等于临界值 $\\chi_{crit}$，且参考和测量的反应进程变量都低于点火阈值 $c_{th}$ 时适用。这标识了一个混合过于强烈以致非预混火焰无法维持的状态。\n2.  **代码 1 (非预混小火焰燃烧)**：当局部条件接近化学计量比 ($|Z - Z_{st}| \\le \\delta_Z$)，有显著的反应进程 ($c_{ref} \\ge c_{th}$)，并且测量的反应进程变量 $c_{meas}$ 与小火焰面的预测值一致 ($|c_{meas} - c_{ref}| \\le tol_c$) 时，标识为此状态。这代表了典型的非预混燃烧。\n3.  **代码 2 (部分预混燃烧)**：此规则捕捉了那些接近化学计量比且显示出显著反应，但反应进程变量 $c_{meas}$ 偏离非预混小火焰值的状态。这种偏离表明局部混合物组分并非源自纯粹、未燃的燃料和氧化剂流，暗示了事先的部分预混。\n4.  **代码 3 (预混燃烧)**：此代码分配给那些具有显著反应进程 ($c_{meas} \\ge c_{th}$) 但发生在远离化学计量混合分数 ($|Z - Z_{st}| > \\delta_Z$) 的状态。这标识了在贫燃或富燃预混状态下燃烧的火焰。\n5.  **代码 0 (未燃或惰性)**：这是对任何不满足燃烧或熄灭标准的状态的默认分类，通常对应于反应进程可忽略不计 ($c_{meas}  c_{th}$) 的区域。\n\n最终的实现将计算小火焰面，然后将此分类逻辑应用于七个测试用例中的每一个，以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the computational combustion problem by first constructing a flamelet\n    manifold and then using it to classify burning regimes.\n    \"\"\"\n\n    # --- Givens: Constants and Parameters ---\n    # Model parameters\n    Z_st = 0.055       # Stoichiometric mixture fraction\n    k_0 = 60.0         # Rate constant (1/s)\n    sigma = 0.02       # Reaction zone width\n    chi_crit = 25.0    # Critical scalar dissipation rate (1/s)\n\n    # Numerical parameters\n    N = 201                      # Number of grid points\n    max_iter = 20000             # Max iterations for time marching\n    conv_tol = 1e-8              # Convergence tolerance\n    dt = 1e-4                    # Pseudo-time step (s)\n\n    # Classification parameters\n    c_th = 0.05        # Progress threshold\n    delta_Z = 0.02     # Stoichiometric proximity\n    tol_c = 0.10       # Consistency tolerance\n\n    # Chi values for manifold computation\n    chi_values = [5.0, 10.0, 30.0]\n\n    # Test cases: (chi, Z_meas, c_meas)\n    test_cases = [\n        (10.0, 0.055, 0.80), # A\n        (10.0, 0.10, 0.60),  # B\n        (10.0, 0.070, 0.40),  # C\n        (30.0, 0.055, 0.00),  # D\n        (30.0, 0.055, 0.50),  # E\n        (5.0, 0.00, 0.00),   # F\n        (5.0, 1.00, 0.00),   # G\n    ]\n\n    # --- Stage 1: Compute Flamelet Manifold ---\n    Z_grid = np.linspace(0, 1, N)\n    dZ = Z_grid[1] - Z_grid[0]\n    \n    manifold_profiles = {}\n\n    for chi in chi_values:\n        # If chi >= chi_crit, flame is extinguished, c(Z) = 0\n        if chi >= chi_crit:\n            manifold_profiles[chi] = np.zeros(N)\n            continue\n        \n        # Initialize progress variable profile\n        c = np.zeros(N)\n        \n        # --- Set up the tridiagonal system for implicit diffusion ---\n        # A * c_new = b\n        # A is tridiagonal: [diag_lower, diag_main, diag_upper]\n        alpha = chi * dt / (dZ**2)\n        \n        # Banded matrix representation for scipy.linalg.solve_banded\n        # (l=1, u=1) -> 3 rows\n        # Row 0: super-diagonal (u)\n        # Row 1: main diagonal\n        # Row 2: sub-diagonal (l)\n        A_banded = np.zeros((3, N - 2))\n        A_banded[0, 1:] = -alpha  # Super-diagonal\n        A_banded[1, :] = 1.0 + 2.0 * alpha # Main diagonal\n        A_banded[2, :-1] = -alpha # Sub-diagonal\n\n        # --- Pseudo-time marching loop ---\n        for _ in range(max_iter):\n            c_old = c.copy()\n            \n            # Calculate reaction source term (explicit)\n            reaction_gaussian = np.exp(-((Z_grid - Z_st)**2) / (2 * sigma**2))\n            extinction_term = max(0, 1 - chi / chi_crit)\n            omega_c = k_0 * reaction_gaussian * c * (1 - c) * extinction_term\n            \n            # Right-hand side of the linear system\n            rhs = c + dt * omega_c\n            \n            # Solve the tridiagonal system A*c = b for interior points\n            # Dirichlet BCs c[0]=0, c[N-1]=0 are handled implicitly as they\n            # don't appear in the (N-2)x(N-2) system.\n            c[1:-1] = solve_banded((1, 1), A_banded, rhs[1:-1])\n\n            # Check for convergence\n            if np.linalg.norm(c - c_old, np.inf)  conv_tol:\n                break\n        \n        manifold_profiles[chi] = c\n\n    # --- Stage 2: Classify Test Cases ---\n    results = []\n    for chi_meas, Z_meas, c_meas in test_cases:\n        # Get the corresponding flamelet profile\n        c_profile = manifold_profiles[chi_meas]\n        \n        # Interpolate to find reference progress variable c_ref\n        c_ref = np.interp(Z_meas, Z_grid, c_profile)\n        \n        # Apply classification rules\n        code = 0 # Default classification\n        \n        # Rule 1: Extinguished non-premixed\n        if c_ref  c_th and chi_meas >= chi_crit and c_meas  c_th:\n            code = 4\n        # Rule 2: Non-premixed flamelet burning\n        elif c_ref >= c_th and abs(c_meas - c_ref) = tol_c and abs(Z_meas - Z_st) = delta_Z:\n            code = 1\n        # Rule 3: Partially premixed burning\n        elif c_meas >= c_th and abs(Z_meas - Z_st) = delta_Z:\n            code = 2\n        # Rule 4: Premixed burning\n        elif c_meas >= c_th and abs(Z_meas - Z_st) > delta_Z:\n            code = 3\n        # Rule 5: Unburnt or inert (default else case)\n        else:\n            code = 0\n\n        results.append(code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}