{
    "hands_on_practices": [
        {
            "introduction": "The mixture fraction, $Z$, is a powerful conserved scalar that simplifies the analysis of diffusion flames by tracking the origin of material from the fuel and oxidizer streams. A key location in this framework is the stoichiometric surface, where fuel and oxidizer meet in perfect proportions for complete combustion. This exercise  provides foundational practice in deriving the stoichiometric mixture fraction, $Z_{st}$, from first principles, connecting the inlet stream compositions to the flame's location in mixture-fraction space.",
            "id": "4014554",
            "problem": "Consider a steady, planar, laminar counterflow diffusion flame formed by two opposed streams with an imposed strain rate $a$ and equal molecular diffusivities (unity Lewis number). The left (fuel) stream enters with mass fractions $Y_{F,1}$ and $Y_{O_2,1}$ of the fuel $F$ and oxygen $\\mathrm{O_2}$, respectively, and the right (oxidizer) stream enters with mass fractions $Y_{F,2}$ and $Y_{O_2,2}$ of the same two species. All other species are inerts and do not participate in the reaction. The reaction is modeled as a single global step\n$$\nF + s\\,\\mathrm{O_2} \\to \\text{products},\n$$\nwhere $s$ is the stoichiometric oxygen coefficient per mole of the fuel, determined by element balances of carbon, hydrogen, and oxygen in $F$. Assume the fuel has the empirical formula $\\mathrm{C}_{n_C}\\mathrm{H}_{n_H}\\mathrm{O}_{n_O}$ and that nitrogen is inert.\n\nDefine the mixture fraction $Z$ as the conserved scalar that linearly interpolates any inlet-conserved quantity between the two streams, with $Z=1$ at the fuel inlet and $Z=0$ at the oxidizer inlet. Under the stated assumptions, the pre-reaction local mass fractions of $F$ and $\\mathrm{O_2}$ vary linearly with $Z$.\n\nUsing only conservation of mass and elements and the definition of the stoichiometric condition, derive the closed-form analytic expression for the stoichiometric mixture fraction $Z_{st}$ in terms of the inlet mass fractions $Y_{F,1}$, $Y_{F,2}$, $Y_{O_2,1}$, $Y_{O_2,2}$, the molecular weights $W_F$ and $W_{O_2}$, and the integers $n_C$, $n_H$, $n_O$ defining the fuel composition. Your final expression must explicitly show how $s$ is computed from element balances and be expressed as a single analytic expression for $Z_{st}$. $Z_{st}$ is dimensionless. Provide your final answer as a single closed-form analytic expression for $Z_{st}$.",
            "solution": "The problem requires the derivation of the stoichiometric mixture fraction, $Z_{st}$, for a counterflow diffusion flame. The derivation will be based on the principles of mass conservation, the definition of the mixture fraction as a conserved scalar, and the definition of stoichiometry.\n\nFirst, we establish the relationship between the local mass fractions of fuel and oxidizer and the mixture fraction, $Z$. The problem states that $Z$ is a conserved scalar, with $Z=1$ in the fuel stream (stream $1$) and $Z=0$ in the oxidizer stream (stream $2$). Under the assumption of equal molecular diffusivities (unity Lewis number), any conserved scalar, including the elemental mass fractions, varies linearly with $Z$. Consequently, the \"unreacted\" mass fractions of fuel ($Y_F^u$) and oxygen ($Y_{O_2}^u$)—that is, the mass fractions that would exist at a given location due to mixing alone, without any chemical reaction—also vary linearly with $Z$. These are given by:\n$$\nY_F^u(Z) = Z \\cdot Y_{F,1} + (1-Z) \\cdot Y_{F,2}\n$$\n$$\nY_{O_2}^u(Z) = Z \\cdot Y_{O_2,1} + (1-Z) \\cdot Y_{O_2,2}\n$$\nwhere $Y_{F,1}$ and $Y_{O_2,1}$ are the mass fractions at the fuel stream inlet, and $Y_{F,2}$ and $Y_{O_2,2}$ are the mass fractions at the oxidizer stream inlet.\n\nNext, we establish the stoichiometric condition on a mass basis. The single-step global reaction is given on a molar basis:\n$$F + s\\,\\mathrm{O_2} \\to \\text{products}$$\nHere, $1$ mole of fuel $F$ reacts with $s$ moles of oxygen $\\mathrm{O_2}$. The quantity $s$ is the molar stoichiometric coefficient. To convert this to a mass relationship, we use the molecular weights of the fuel, $W_F$, and oxygen, $W_{O_2}$. The mass of fuel reacting is proportional to $1 \\cdot W_F$, and the mass of oxygen reacting is proportional to $s \\cdot W_{O_2}$. The stoichiometric mass ratio, $\\nu$, is the mass of oxygen required to completely consume a unit mass of fuel:\n$$\\nu = \\frac{\\text{mass of } \\mathrm{O_2} \\text{ consumed}}{\\text{mass of } F \\text{ consumed}} = \\frac{s \\cdot W_{O_2}}{1 \\cdot W_F} = \\frac{s W_{O_2}}{W_F}$$\n\nThe stoichiometric mixture fraction, $Z_{st}$, is the specific value of $Z$ at which the unreacted fuel and oxygen are present in exactly this stoichiometric ratio. At the location where $Z=Z_{st}$, the ratio of the available (unreacted) mass fractions must equal the stoichiometric mass ratio:\n$$\\frac{Y_{O_2}^u(Z_{st})}{Y_F^u(Z_{st})} = \\nu$$\n\nSubstituting the linear expressions for $Y_F^u(Z)$ and $Y_{O_2}^u(Z)$ into this condition, we get:\n$$\\frac{Z_{st} Y_{O_2,1} + (1-Z_{st}) Y_{O_2,2}}{Z_{st} Y_{F,1} + (1-Z_{st}) Y_{F,2}} = \\nu = \\frac{s W_{O_2}}{W_F}$$\nWe now solve this equation for $Z_{st}$. First, cross-multiply:\n$$W_F \\left( Z_{st} Y_{O_2,1} + (1-Z_{st}) Y_{O_2,2} \\right) = s W_{O_2} \\left( Z_{st} Y_{F,1} + (1-Z_{st}) Y_{F,2} \\right)$$\nExpand the terms:\n$$W_F Z_{st} Y_{O_2,1} + W_F Y_{O_2,2} - W_F Z_{st} Y_{O_2,2} = s W_{O_2} Z_{st} Y_{F,1} + s W_{O_2} Y_{F,2} - s W_{O_2} Z_{st} Y_{F,2}$$\nGroup all terms containing $Z_{st}$ on one side of the equation:\n$$Z_{st} \\left( W_F Y_{O_2,1} - W_F Y_{O_2,2} - s W_{O_2} Y_{F,1} + s W_{O_2} Y_{F,2} \\right) = s W_{O_2} Y_{F,2} - W_F Y_{O_2,2}$$\nIsolating $Z_{st}$ gives:\n$$Z_{st} = \\frac{s W_{O_2} Y_{F,2} - W_F Y_{O_2,2}}{s W_{O_2} (Y_{F,2} - Y_{F,1}) + W_F (Y_{O_2,1} - Y_{O_2,2})}$$\nTo obtain a more standard form, we can multiply the numerator and denominator by $-1$:\n$$Z_{st} = \\frac{W_F Y_{O_2,2} - s W_{O_2} Y_{F,2}}{s W_{O_2} (Y_{F,1} - Y_{F,2}) - W_F (Y_{O_2,1} - Y_{O_2,2})}$$\n\nThe problem requires an explicit expression for the molar stoichiometric coefficient $s$. The fuel has the empirical formula $\\mathrm{C}_{n_C}\\mathrm{H}_{n_H}\\mathrm{O}_{n_O}$. Assuming complete combustion, the products are carbon dioxide ($\\mathrm{CO_2}$) and water ($\\mathrm{H_2O}$). The balanced chemical equation is:\n$$\\mathrm{C}_{n_C}\\mathrm{H}_{n_H}\\mathrm{O}_{n_O} + s\\,\\mathrm{O_2} \\to n_C\\,\\mathrm{CO_2} + \\frac{n_H}{2}\\,\\mathrm{H_2O}$$\nWe determine $s$ by balancing the oxygen atoms. The number of oxygen atoms on the left side is $n_O + 2s$, and on the right side is $2n_C + \\frac{n_H}{2}$. Equating these gives:\n$$n_O + 2s = 2n_C + \\frac{n_H}{2}$$\nSolving for $s$:\n$$2s = 2n_C + \\frac{n_H}{2} - n_O$$\n$$s = n_C + \\frac{n_H}{4} - \\frac{n_O}{2}$$\n\nFinally, we substitute this expression for $s$ into our equation for $Z_{st}$ to obtain the final closed-form expression in terms of the specified variables:\n$$Z_{st} = \\frac{W_F Y_{O_2,2} - \\left(n_C + \\frac{n_H}{4} - \\frac{n_O}{2}\\right) W_{O_2} Y_{F,2}}{\\left(n_C + \\frac{n_H}{4} - \\frac{n_O}{2}\\right) W_{O_2} (Y_{F,1} - Y_{F,2}) - W_F (Y_{O_2,1} - Y_{O_2,2})}$$\nThis expression is the complete and final solution, derived from first principles as requested. It defines the stoichiometric mixture fraction $Z_{st}$ based entirely on the inlet stream compositions, fuel chemistry, and molecular weights.",
            "answer": "$$\\boxed{\\frac{W_F Y_{O_2,2} - \\left(n_C + \\frac{n_H}{4} - \\frac{n_O}{2}\\right) W_{O_2} Y_{F,2}}{\\left(n_C + \\frac{n_H}{4} - \\frac{n_O}{2}\\right) W_{O_2} (Y_{F,1} - Y_{F,2}) - W_F (Y_{O_2,1} - Y_{O_2,2})}}$$"
        },
        {
            "introduction": "A counterflow diffusion flame is stabilized by the aerodynamic stretching of the flow field, a property quantified by the strain rate, $a$. This parameter governs the rates of mixing and transport, ultimately determining the flame's stability and structure. This practice  bridges theory and experiment by guiding you through a kinematic derivation to relate the strain rate to the easily controlled inlet velocities and nozzle separation distance in an opposed-jet configuration.",
            "id": "4014558",
            "problem": "Consider a planar opposed-jet configuration for a counterflow diffusion flame in which two semi-infinite, uniform-velocity streams face each other across a gap of width $L$. The left nozzle at $x=-L/2$ issues a fuel stream of constant speed $U_f0$ directed in the $+x$ direction, and the right nozzle at $x=+L/2$ issues an oxidizer stream of constant speed $U_o0$ directed in the $-x$ direction. Assume steady, low-Mach-number, constant-density flow and neglect the feedback of heat release on the hydrodynamics so that the base flow is determined kinematically by the opposed jets. Define the stagnation plane as the location $x=x_s$ where the axial velocity component $u(x)$ vanishes. Define the imposed axial strain rate $a$ to be the magnitude of the axial velocity gradient at the stagnation plane, $a \\equiv -\\left.\\frac{du}{dx}\\right|_{x=x_s}0$.\n\nUnder the standard near-stagnation similarity assumption for planar counterflow that, in the core between the two inlets, the axial velocity profile is linear in the distance from the stagnation plane, i.e., $u(x)$ is well-approximated by a linear function of $(x-x_s)$, use only basic kinematics consistent with steady, constant-density flow to derive a closed-form expression that links the imposed strain rate $a$ to the inlet speeds $(U_f,U_o)$ and the separation $L$. State clearly any intermediate quantities you introduce, and eliminate them in favor of $(U_f,U_o,L)$ in the final expression. Express your final answer for $a$ in $\\mathrm{s}^{-1}$. No numerical evaluation or rounding is required.",
            "solution": "The problem asks for the derivation of an expression for the imposed axial strain rate, $a$, in a planar opposed-jet counterflow configuration. The derivation will be based on the provided kinematic assumptions.\n\nThe fundamental assumption stated in the problem is that in the core region between the two nozzles, the axial velocity profile $u(x)$ is a linear function of the distance from the stagnation plane, $x_s$. The stagnation plane is defined as the location where the axial velocity vanishes, $u(x_s) = 0$. We can express this linear relationship as:\n$$\nu(x) = C(x - x_s)\n$$\nwhere $C$ is a constant of proportionality. This form automatically satisfies the condition $u(x_s) = 0$.\n\nThe imposed axial strain rate, $a$, is defined as the magnitude of the velocity gradient at the stagnation plane:\n$$\na \\equiv -\\left.\\frac{du}{dx}\\right|_{x=x_s}\n$$\nThe negative sign is included in the definition to ensure that $a  0$ for a flow that is compressing along the $x$-axis around the stagnation point. We can find the derivative of our assumed velocity profile:\n$$\n\\frac{du}{dx} = \\frac{d}{dx}[C(x - x_s)] = C\n$$\nSince the derivative is constant for a linear function, the gradient at any point $x$, including at $x=x_s$, is equal to $C$. Therefore, we can relate the constant $C$ to the strain rate $a$:\n$$\na = -C\n$$\nSubstituting $C = -a$ back into the expression for the velocity profile, we obtain the axial velocity as a function of the strain rate $a$ and the stagnation plane position $x_s$:\n$$\nu(x) = -a(x - x_s)\n$$\nThis is the kinematic model for the velocity field that we will use. It contains two unknown parameters: the strain rate $a$ and the stagnation plane position $x_s$. To solve for these, we must apply the boundary conditions given at the two nozzle exits.\n\nThe problem specifies the following boundary conditions:\n1.  At the fuel nozzle exit, located at $x = -L/2$, the velocity is $U_f$ in the positive $x$-direction. Thus, $u(-L/2) = U_f$.\n2.  At the oxidizer nozzle exit, located at $x = +L/2$, the velocity is $U_o$ in the negative $x$-direction. Thus, $u(+L/2) = -U_o$.\n\nWe now apply these two boundary conditions to our velocity model, $u(x) = -a(x-x_s)$, which yields a system of two linear equations for the two unknowns, $a$ and $x_s$.\n\nApplying the first boundary condition (fuel side):\n$$\nu\\left(-\\frac{L}{2}\\right) = U_f \\implies U_f = -a\\left(-\\frac{L}{2} - x_s\\right)\n$$\n$$\nU_f = a\\left(\\frac{L}{2} + x_s\\right) \\quad \\quad (1)\n$$\n\nApplying the second boundary condition (oxidizer side):\n$$\nu\\left(+\\frac{L}{2}\\right) = -U_o \\implies -U_o = -a\\left(\\frac{L}{2} - x_s\\right)\n$$\n$$\n-U_o = a\\left(x_s - \\frac{L}{2}\\right) \\quad \\quad (2)\n$$\n\nWe have a system of two equations:\n$$\n\\begin{cases}\nU_f = a x_s + \\frac{aL}{2} \\\\\n-U_o = a x_s - \\frac{aL}{2}\n\\end{cases}\n$$\nOur goal is to find an expression for $a$. We can eliminate the intermediate quantity $x_s$ by subtracting the second equation from the first:\n$$\nU_f - (-U_o) = \\left(a x_s + \\frac{aL}{2}\\right) - \\left(a x_s - \\frac{aL}{2}\\right)\n$$\n$$\nU_f + U_o = a x_s + \\frac{aL}{2} - a x_s + \\frac{aL}{2}\n$$\n$$\nU_f + U_o = aL\n$$\nSolving for the strain rate $a$, we find:\n$$\na = \\frac{U_f + U_o}{L}\n$$\nThis expression relates the imposed strain rate $a$ directly to the inlet speeds $U_f$ and $U_o$ and the separation distance $L$, as required. The units are consistent: if speeds are in $\\mathrm{m}/\\mathrm{s}$ and distance is in $\\mathrm{m}$, the strain rate $a$ is in $\\mathrm{s}^{-1}$. All intermediate quantities have been eliminated in the final expression. For completeness, we could also solve for the stagnation plane position $x_s$ by adding the two equations, which yields $x_s = \\frac{L}{2} \\frac{U_f - U_o}{U_f + U_o}$, confirming its dependence on the relative momentum of the jets. However, the problem only asks for the expression for $a$.",
            "answer": "$$\n\\boxed{\\frac{U_f + U_o}{L}}\n$$"
        },
        {
            "introduction": "Real flames involve a complex interplay between chemical reaction, convection, and molecular diffusion, which can lead to phenomena like extinction at high strain rates or temperature overshoots due to preferential diffusion. This advanced computational exercise  challenges you to build a flamelet model to investigate these non-ideal effects. By solving the governing equations in mixture-fraction space, you will directly observe how non-unity Lewis numbers and the scalar dissipation rate—a measure of strain—dictate the flame's peak temperature and its proximity to extinction.",
            "id": "4014589",
            "problem": "Consider a steady, planar counterflow diffusion flame modeled in mixture-fraction space. Let the mixture fraction be denoted by $Z \\in [0,1]$, with $Z=0$ representing the oxidizer stream and $Z=1$ representing the fuel stream. The stoichiometric mixture fraction is denoted by $Z_{st} \\in (0,1)$ and is determined from the stoichiometric mass ratio and the boundary mass fractions. The scalar dissipation rate profile is specified as a given function $\\,\\chi(Z)\\,$ characterized by the stoichiometric value $\\,\\chi_{st}\\,$ and a shape parameter.\n\nYou will quantify the impact of a non-unity Lewis number, $Le \\neq 1$, on the steady temperature and a representative radical mass fraction distribution near $Z_{st}$, and relate this to extinction behavior under an imposed strain rate through the scalar dissipation rate. The model is defined in purely mathematical terms by the following differential equations and boundary conditions, derived from conservation laws and steady flamelet theory, with constant density and constant specific heat:\n\n1. Species and energy equations in mixture-fraction space:\nFor fuel mass fraction $Y_F(Z)$, oxidizer mass fraction $Y_O(Z)$, radical mass fraction $Y_R(Z)$, and temperature $T(Z)$, the governing steady, one-dimensional boundary value problem is\n$$\n\\frac{\\chi(Z)}{2\\,Le_F}\\,\\frac{d^2 Y_F}{dZ^2} + \\omega(Y_F,Y_O,T) = 0,\n$$\n$$\n\\frac{\\chi(Z)}{2\\,Le_O}\\,\\frac{d^2 Y_O}{dZ^2} + s\\,\\omega(Y_F,Y_O,T) = 0,\n$$\n$$\n\\frac{\\chi(Z)}{2\\,Le_R}\\,\\frac{d^2 Y_R}{dZ^2} + k_{r,\\mathrm{prod}}\\,\\omega(Y_F,Y_O,T) - k_{r,\\mathrm{loss}}\\,Y_R = 0,\n$$\n$$\n\\frac{\\chi(Z)}{2\\,Le_T}\\,\\frac{d^2 T}{dZ^2} + \\frac{q}{\\rho\\,c_p}\\,\\omega(Y_F,Y_O,T) - k_{h,\\mathrm{loss}}\\big(T - T_{\\mathrm{mix}}(Z)\\big) = 0.\n$$\nHere $Le_F$, $Le_O$, $Le_R$, and $Le_T$ are the Lewis numbers for fuel, oxidizer, radical, and thermal field respectively; $s$ is the stoichiometric oxidizer-to-fuel mass consumption ratio; $k_{r,\\mathrm{prod}}$ and $k_{r,\\mathrm{loss}}$ are radical production and loss coefficients; $q$ is the heat release per unit mass of fuel; $\\rho$ is the density; $c_p$ is the specific heat at constant pressure; $k_{h,\\mathrm{loss}}$ is a small heat-loss coefficient; and $T_{\\mathrm{mix}}(Z)$ is the streamwise mixing temperature defined as a linear blend of boundary temperatures.\n\n2. Arrhenius-form reaction rate:\n$$\n\\omega(Y_F,Y_O,T) = A\\,\\rho\\,Y_F^a\\,Y_O^b\\,\\exp\\!\\left(-\\frac{E}{R_u\\,T}\\right),\n$$\nwhere $A$ is a pre-exponential factor, $a$ and $b$ are reaction orders, $E$ is an activation energy, and $R_u$ is the universal gas constant.\n\n3. Scalar dissipation rate:\nAssume a Gaussian-like profile peaked at $Z_{st}$:\n$$\n\\chi(Z) = \\chi_{st}\\,\\exp\\!\\left(-\\beta\\,\\frac{(Z-Z_{st})^2}{Z_{st}(1-Z_{st})}\\right),\n$$\nwhere $\\beta  0$ controls the localization. To ensure numerical robustness, when evaluating $\\chi(Z)$ in a computation, you must cap it below by a small positive floor value to avoid division by zero.\n\n4. Boundary conditions:\n$$\nY_F(0) = 0,\\quad Y_O(0) = Y_{O,0},\\quad Y_R(0) = 0,\\quad T(0) = T_{ox},\n$$\n$$\nY_F(1) = Y_{F,1},\\quad Y_O(1) = 0,\\quad Y_R(1) = 0,\\quad T(1) = T_{fuel}.\n$$\nThe linear mixing temperature is\n$$\nT_{\\mathrm{mix}}(Z) = Z\\,T_{fuel} + (1-Z)\\,T_{ox}.\n$$\n\n5. Stoichiometric mixture fraction:\nFor a one-step fuel-oxidizer reaction with mass stoichiometric ratio $s$, fuel-stream mass fraction $Y_{F,1}$, and oxidizer-stream mass fraction $Y_{O,0}$, define\n$$\nZ_{st} = \\frac{1}{1 + s\\,\\frac{Y_{F,1}}{Y_{O,0}}}.\n$$\n\nTask Requirements:\n- Implement a robust numerical solver for the above boundary value problem using any modern programming language, but your final answer must be a complete, runnable program. You must compute the steady profiles $Y_F(Z)$, $Y_O(Z)$, $Y_R(Z)$, and $T(Z)$ on $Z \\in [0,1]$ for each test case specified below.\n- Quantify the impact of $Le \\neq 1$ near $Z_{st}$ by extracting, for each test case, the maximum temperature $T_{\\max}$ and the maximum radical mass fraction $Y_{R,\\max}$ over the window $\\{Z: |Z-Z_{st}| \\le \\Delta Z\\}$ where $\\Delta Z = 0.2$.\n- Determine extinction behavior under the imposed strain via $\\,\\chi_{st}\\,$ by checking if the flame fails to reach a sufficiently high peak temperature. Define extinction to occur when $\\,T_{\\max}  T_{\\mathrm{ext}}$, where $T_{\\mathrm{ext}} = 1400$ in Kelvin.\n\nPhysical constants and parameters:\n- Use $\\,\\rho = 1$ in $\\mathrm{kg/m^3}$, $\\,c_p = 1000$ in $\\mathrm{J/(kg\\,K)}$, $\\,q = 2\\times 10^6$ in $\\mathrm{J/kg}$, $\\,A = 100$ in $\\mathrm{s^{-1}}$, $\\,a = 1$, $\\,b = 1$, $\\,E = 2\\times 10^4$ in $\\mathrm{J/mol}$, $\\,R_u = 8.314$ in $\\mathrm{J/(mol\\,K)}$, $\\,k_{r,\\mathrm{prod}} = 0.2$, $\\,k_{r,\\mathrm{loss}} = 50$, $\\,k_{h,\\mathrm{loss}} = 50$, and $\\,\\beta = 3$ (dimensionless). Use $\\,Le_T = 1$.\n- Use fuel and oxidizer stream temperatures $\\,T_{fuel} = 300$ in Kelvin and $\\,T_{ox} = 300$ in Kelvin.\n- Use $\\,Y_{F,1} = 1.0$ (pure fuel stream), $\\,Y_{O,0} = 0.233$ (oxidizer mass fraction for oxygen in air), and fuel-oxidizer stoichiometry for hydrogen and oxygen with $s = 8$.\n\nUnits:\n- Express all temperatures in Kelvin. Radical mass fractions are dimensionless. Extinction is a boolean condition.\n- Angles are not used. Percentages must not be used.\n\nTest Suite:\nEvaluate the following four cases, which probe the role of $Le \\neq 1$ and imposed strain through $\\,\\chi_{st}$:\n1. Case A (baseline unity Lewis numbers, moderate strain): $Le_F = 1.0$, $Le_O = 1.0$, $Le_R = 1.0$, $\\chi_{st} = 5.0$ in $\\mathrm{s^{-1}}$.\n2. Case B (preferential diffusion with $Le_F  1$, moderate strain): $Le_F = 0.3$, $Le_O = 1.0$, $Le_R = 0.3$, $\\chi_{st} = 5.0$ in $\\mathrm{s^{-1}}$.\n3. Case C (suppressed fuel diffusion with $Le_F  1$, moderate strain): $Le_F = 2.0$, $Le_O = 1.0$, $Le_R = 2.0$, $\\chi_{st} = 5.0$ in $\\mathrm{s^{-1}}$.\n4. Case D (baseline unity Lewis numbers, high strain): $Le_F = 1.0$, $Le_O = 1.0$, $Le_R = 1.0$, $\\chi_{st} = 30.0$ in $\\mathrm{s^{-1}}$.\n\nOutput Specification:\n- For each test case, extract $T_{\\max}$ in Kelvin and $Y_{R,\\max}$ (dimensionless) over $|Z-Z_{st}| \\le \\Delta Z$ with $\\Delta Z = 0.2$, and determine the extinction boolean using $T_{\\mathrm{ext}} = 1400$ in Kelvin.\n- Round $T_{\\max}$ and $Y_{R,\\max}$ to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of the form $[T_{\\max}, Y_{R,\\max}, \\text{extinct}]$. For example: $[[1800.123,0.012,False],[...],[...],[...]]$.",
            "solution": "The user has provided a problem statement describing a steady, one-dimensional counterflow diffusion flame in mixture-fraction space. The task is to solve a system of differential equations and analyze the solution for different physical parameters. I will first validate the problem statement before proceeding to a solution.\n\n### Step 1: Extract Givens\n\nThe givens are extracted verbatim from the problem statement.\n\n**Governing Equations:**\nThe steady-state species and energy balance equations in mixture-fraction space, $Z$, are given for fuel mass fraction $Y_F(Z)$, oxidizer mass fraction $Y_O(Z)$, radical mass fraction $Y_R(Z)$, and temperature $T(Z)$:\n$$\n\\frac{\\chi(Z)}{2\\,Le_F}\\,\\frac{d^2 Y_F}{dZ^2} + \\omega(Y_F,Y_O,T) = 0\n$$\n$$\n\\frac{\\chi(Z)}{2\\,Le_O}\\,\\frac{d^2 Y_O}{dZ^2} + s\\,\\omega(Y_F,Y_O,T) = 0\n$$\n$$\n\\frac{\\chi(Z)}{2\\,Le_R}\\,\\frac{d^2 Y_R}{dZ^2} + k_{r,\\mathrm{prod}}\\,\\omega(Y_F,Y_O,T) - k_{r,\\mathrm{loss}}\\,Y_R = 0\n$$\n$$\n\\frac{\\chi(Z)}{2\\,Le_T}\\,\\frac{d^2 T}{dZ^2} + \\frac{q}{\\rho\\,c_p}\\,\\omega(Y_F,Y_O,T) - k_{h,\\mathrm{loss}}\\big(T - T_{\\mathrm{mix}}(Z)\\big) = 0\n$$\n\n**Constitutive Relations and Definitions:**\n- Reaction rate: $\\omega(Y_F,Y_O,T) = A\\,\\rho\\,Y_F^a\\,Y_O^b\\,\\exp\\!\\left(-\\frac{E}{R_u\\,T}\\right)$\n- Scalar dissipation rate profile: $\\chi(Z) = \\chi_{st}\\,\\exp\\!\\left(-\\beta\\,\\frac{(Z-Z_{st})^2}{Z_{st}(1-Z_{st})}\\right)$ with a small positive floor value.\n- Linear mixing temperature: $T_{\\mathrm{mix}}(Z) = Z\\,T_{fuel} + (1-Z)\\,T_{ox}$\n- Stoichiometric mixture fraction: $Z_{st} = \\frac{1}{1 + s\\,\\frac{Y_{F,1}}{Y_{O,0}}}$\n\n**Boundary Conditions for $Z \\in [0,1]$:**\n- At $Z=0$: $Y_F(0) = 0$, $Y_O(0) = Y_{O,0}$, $Y_R(0) = 0$, $T(0) = T_{ox}$\n- At $Z=1$: $Y_F(1) = Y_{F,1}$, $Y_O(1) = 0$, $Y_R(1) = 0$, $T(1) = T_{fuel}$\n\n**Physical Constants and Parameters:**\n- $\\rho = 1 \\, \\mathrm{kg/m^3}$\n- $c_p = 1000 \\, \\mathrm{J/(kg\\,K)}$\n- $q = 2\\times 10^6 \\, \\mathrm{J/kg}$\n- $A = 100 \\, \\mathrm{s^{-1}}$\n- $a = 1$, $b = 1$\n- $E = 2\\times 10^4 \\, \\mathrm{J/mol}$\n- $R_u = 8.314 \\, \\mathrm{J/(mol\\,K)}$\n- $k_{r,\\mathrm{prod}} = 0.2$\n- $k_{r,\\mathrm{loss}} = 50$\n- $k_{h,\\mathrm{loss}} = 50$\n- $\\beta = 3$\n- $Le_T = 1$\n- $T_{fuel} = 300 \\, \\mathrm{K}$, $T_{ox} = 300 \\, \\mathrm{K}$\n- $Y_{F,1} = 1.0$\n- $Y_{O,0} = 0.233$\n- $s = 8$\n\n**Task Requirements:**\n- Find $T_{\\max}$ and $Y_{R,\\max}$ over the window $|Z-Z_{st}| \\le \\Delta Z$ where $\\Delta Z = 0.2$.\n- Define extinction as $T_{\\max}  T_{\\mathrm{ext}}$ where $T_{\\mathrm{ext}} = 1400 \\, \\mathrm{K}$.\n\n**Test Suite:**\n1.  Case A: $Le_F = 1.0$, $Le_O = 1.0$, $Le_R = 1.0$, $\\chi_{st} = 5.0 \\, \\mathrm{s^{-1}}$\n2.  Case B: $Le_F = 0.3$, $Le_O = 1.0$, $Le_R = 0.3$, $\\chi_{st} = 5.0 \\, \\mathrm{s^{-1}}$\n3.  Case C: $Le_F = 2.0$, $Le_O = 1.0$, $Le_R = 2.0$, $\\chi_{st} = 5.0 \\, \\mathrm{s^{-1}}$\n4.  Case D: $Le_F = 1.0$, $Le_O = 1.0$, $Le_R = 1.0$, $\\chi_{st} = 30.0 \\, \\mathrm{s^{-1}}$\n\n### Step 2: Validate Using Extracted Givens\n\nI will now assess the problem's validity based on the extracted information.\n\n-   **Scientifically Grounded**: The problem is a well-established simplification of combustion phenomena, known as the steady flamelet model. The governing equations are derived from fundamental conservation principles of mass and energy, coupled with standard models for chemical reaction rates (Arrhenius law) and transport phenomena. The concept of mixture fraction and scalar dissipation rate is central to the theory of non-premixed combustion. The problem is firmly grounded in the principles of fluid mechanics, thermodynamics, and chemical kinetics. (Status: Valid)\n-   **Well-Posed**: The problem is formulated as a system of four coupled, second-order, non-linear ordinary differential equations (ODEs) on a finite domain $Z \\in [0,1]$. A total of eight boundary conditions are provided (two for each second-order ODE), which is the correct number to specify a unique solution for a boundary value problem (BVP). The parameters and functions are all explicitly defined. The system is therefore mathematically well-posed. (Status: Valid)\n-   **Objective**: The problem statement is entirely quantitative and objective. All parameters are given as precise numerical values, and the goals are defined through unambiguous mathematical criteria ($T_{\\max}$, $Y_{R,\\max}$, extinction condition). There are no subjective or opinion-based elements. (Status: Valid)\n-   **Completeness and Consistency**: All necessary parameters, equations, and boundary conditions are provided. There are no contradictions in the setup. The requirement to cap $\\chi(Z)$ is a standard numerical practice to handle the limits of the model, not a flaw. (Status: Valid)\n-   **Feasibility**: The parameter values are physically reasonable for a model combustion problem. The task of numerically solving this BVP is standard and achievable with modern scientific computing libraries. (Status: Valid)\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. It is a scientifically sound, well-posed, and objective problem in computational combustion.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. I will proceed with formulating and implementing a solution.\n\n### Solution and Algorithmic Design\n\nThe problem requires the solution of a system of coupled, non-linear, second-order ODEs constituting a boundary value problem (BVP). A robust numerical approach is necessary. I will employ a finite-difference-based BVP solver, specifically `scipy.integrate.solve_bvp`, which is well-suited for this class of problems.\n\n**1. System Transformation to First Order**\n\nThe `solve_bvp` function requires the system to be expressed as a set of first-order ODEs. We introduce new variables for the first derivatives of our primary unknowns. Let the state vector be $\\mathbf{y}(Z)$, an 8-component vector defined as:\n$$\n\\mathbf{y}(Z) = [y_0, y_1, y_2, y_3, y_4, y_5, y_6, y_7]^T = [Y_F, \\frac{dY_F}{dZ}, Y_O, \\frac{dY_O}{dZ}, Y_R, \\frac{dY_R}{dZ}, T, \\frac{dT}{dZ}]^T\n$$\nThe original four second-order equations are transformed into a system of eight first-order equations:\n$$\n\\frac{d y_0}{dZ} = y_1\n$$\n$$\n\\frac{d y_1}{dZ} = -\\frac{2\\,Le_F}{\\chi(Z)}\\, \\omega(y_0, y_2, y_6)\n$$\n$$\n\\frac{d y_2}{dZ} = y_3\n$$\n$$\n\\frac{d y_3}{dZ} = -\\frac{2\\,Le_O}{\\chi(Z)}\\, s\\, \\omega(y_0, y_2, y_6)\n$$\n$$\n\\frac{d y_4}{dZ} = y_5\n$$\n$$\n\\frac{d y_5}{dZ} = -\\frac{2\\,Le_R}{\\chi(Z)}\\, \\left(k_{r,\\mathrm{prod}}\\,\\omega(y_0, y_2, y_6) - k_{r,\\mathrm{loss}}\\,y_4\\right)\n$$\n$$\n\\frac{d y_6}{dZ} = y_7\n$$\n$$\n\\frac{d y_7}{dZ} = -\\frac{2\\,Le_T}{\\chi(Z)}\\, \\left(\\frac{q}{\\rho\\,c_p}\\,\\omega(y_0, y_2, y_6) - k_{h,\\mathrm{loss}}\\left(y_6 - T_{\\mathrm{mix}}(Z)\\right)\\right)\n$$\nNote that the reaction rate $\\omega$ and the mixing temperature $T_{\\mathrm{mix}}$ are functions of the state variables and the independent variable $Z$. To ensure numerical stability, the $\\chi(Z)$ term in the denominators will be floored at a small positive value, and the mass fractions $y_0, y_2$ inside the reaction rate term $\\omega$ will be clipped at zero.\n\n**2. Boundary Conditions**\n\nThe eight boundary conditions are expressed in terms of the state vector $\\mathbf{y}$ at the boundaries $Z=0$ (denoted $\\mathbf{y}_a$) and $Z=1$ (denoted $\\mathbf{y}_b$):\n- $y_{0,a} - 0 = 0$\n- $y_{2,a} - Y_{O,0} = 0$\n- $y_{4,a} - 0 = 0$\n- $y_{6,a} - T_{ox} = 0$\n- $y_{0,b} - Y_{F,1} = 0$\n- $y_{2,b} - 0 = 0$\n- $y_{4,b} - 0 = 0$\n- $y_{6,b} - T_{fuel} = 0$\n\nThese form the residuals that the BVP solver will attempt to drive to zero.\n\n**3. Initial Guess**\n\nThe convergence of the non-linear solver is highly sensitive to the initial guess for the solution profiles. A physically informed guess is crucial to finding the ignited (high-temperature) solution branch, as opposed to the trivial non-reacting solution.\n- **Grid:** A uniform grid of $101$ points across $Z \\in [0,1]$ is chosen for discretization.\n- **Reactants ($Y_F, Y_O$):** Piecewise linear profiles based on the Burke-Schumann thin-flame approximation are used. Fuel exists only for $Z  Z_{st}$ and oxidizer exists only for $Z  Z_{st}$.\n- **Temperature ($T$):** The linear mixing profile $T_{mix}(Z)$ is augmented with a superimposed Gaussian peak centered at $Z_{st}$. This peak, with an estimated height of $\\approx 1800 \\, \\mathrm{K}$, guides the solver towards the high-temperature flame solution.\n- **Radical ($Y_R$):** A small Gaussian peak centered at $Z_{st}$ is assumed, representing radical formation in the reaction zone.\n- **Derivatives:** The initial guess for the first-derivative components ($y_1, y_3, y_5, y_7$) is calculated using finite differences from the guessed profiles of the primary variables.\n\n**4. Post-Processing**\n\nFor each test case, after the BVP is successfully solved, the following steps are taken:\n1. The solution profiles for $T(Z)$ (i.e., $y_6$) and $Y_R(Z)$ (i.e., $y_4$) are extracted from the solver result.\n2. A boolean mask is created to identify the grid points $Z_i$ that fall within the specified analysis window, $|Z_i - Z_{st}| \\le \\Delta Z$.\n3. The maximum temperature $T_{\\max}$ and maximum radical mass fraction $Y_{R,\\max}$ are found by taking the maximum values of the respective profiles within this window.\n4. An extinction flag is set to `True` if $T_{\\max}  T_{\\mathrm{ext}}$ ($1400\\, \\mathrm{K}$), and `False` otherwise.\n5. The results ($T_{\\max}$, $Y_{R,\\max}$) are rounded to three decimal places and formatted as specified.\n\nThis procedure is repeated for all four test cases, and the final results are aggregated into a single output line.\n\nThe case studies will illustrate:\n- **Case A vs. B/C:** The effect of non-unity Lewis numbers. With $Le1$ (Case B), preferential diffusion of heat and light reactants focuses energy at the reaction zone, leading to higher peak temperatures. With $Le>1$ (Case C), diffusion away from the reaction zone is enhanced, lowering peak temperatures.\n- **Case A vs. D:** The effect of strain rate, represented by $\\chi_{st}$. Higher strain rates (higher $\\chi_{st}$) imply shorter residence times and increased heat/species transport away from the flame, which can lead to lower temperatures and eventual extinction, as explored in Case D.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_bvp\nimport sys\n\n# Increase recursion limit for potentially deep solver calls\nsys.setrecursionlimit(2000)\n\ndef solve():\n    \"\"\"\n    Solves the counterflow diffusion flame problem for four test cases.\n    \"\"\"\n    # Physical constants and parameters\n    params = {\n        'rho': 1.0,           # kg/m^3\n        'cp': 1000.0,         # J/(kg*K)\n        'q': 2.0e6,           # J/kg\n        'A': 100.0,           # s^-1\n        'a': 1.0,             # reaction order\n        'b': 1.0,             # reaction order\n        'E': 2.0e4,           # J/mol\n        'Ru': 8.314,          # J/(mol*K)\n        'kr_prod': 0.2,       # dimensionless coefficient\n        'kr_loss': 50.0,      # dimensionless coefficient\n        'kh_loss': 50.0,      # dimensionless coefficient\n        'beta': 3.0,          # dimensionless\n        'Le_T': 1.0,          # Thermal Lewis number\n        'T_fuel': 300.0,      # K\n        'T_ox': 300.0,        # K\n        'YF1': 1.0,           # fuel mass fraction at Z=1\n        'YO0': 0.233,         # oxidizer mass fraction at Z=0\n        's': 8.0,             # stoichiometric mass ratio\n        'T_ext': 1400.0,      # K\n        'delta_Z': 0.2,       # window for analysis\n        'chi_floor': 1e-10,   # floor for scalar dissipation rate\n    }\n    \n    # Stoichiometric mixture fraction (Corrected Formula)\n    params['Z_st'] = 1.0 / (1.0 + params['s'] * params['YF1'] / params['YO0'])\n\n    test_cases = [\n        # Case A\n        {'Le_F': 1.0, 'Le_O': 1.0, 'Le_R': 1.0, 'chi_st': 5.0},\n        # Case B\n        {'Le_F': 0.3, 'Le_O': 1.0, 'Le_R': 0.3, 'chi_st': 5.0},\n        # Case C\n        {'Le_F': 2.0, 'Le_O': 1.0, 'Le_R': 2.0, 'chi_st': 5.0},\n        # Case D\n        {'Le_F': 1.0, 'Le_O': 1.0, 'Le_R': 1.0, 'chi_st': 30.0},\n    ]\n\n    results = []\n\n    for case_params in test_cases:\n        # Combine base params with case-specific params\n        current_params = params.copy()\n        current_params.update(case_params)\n\n        # Helper functions defined within the loop to capture current_params\n        def T_mix_func(z):\n            return z * current_params['T_fuel'] + (1.0 - z) * current_params['T_ox']\n\n        def chi_func(z):\n            Z_st = current_params['Z_st']\n            chi_st = current_params['chi_st']\n            beta = current_params['beta']\n            chi = chi_st * np.exp(-beta * (z - Z_st)**2 / (Z_st * (1 - Z_st)))\n            return np.maximum(chi, current_params['chi_floor'])\n\n        def omega_func(yf, yo, t):\n            # Clip mass fractions to be non-negative\n            yf_clip = np.maximum(0.0, yf)\n            yo_clip = np.maximum(0.0, yo)\n            A = current_params['A']\n            rho = current_params['rho']\n            E = current_params['E']\n            Ru = current_params['Ru']\n            a = current_params['a']\n            b = current_params['b']\n            \n            # Avoid exp overflow/underflow by checking T\n            if np.any(t = 0): return np.zeros_like(t)\n            \n            rate = A * rho * (yf_clip**a) * (yo_clip**b) * np.exp(-E / (Ru * t))\n            return rate\n\n        # System of 8 first-order ODEs\n        def ode_system(z, y):\n            # y = [YF, YF', YO, YO', YR, YR', T, T']\n            yf, _, yo, _, yr, _, t, _ = y\n            \n            omega_val = omega_func(yf, yo, t)\n            chi_val = chi_func(z)\n            \n            dYF_dZ2 = - (2 * current_params['Le_F'] / chi_val) * omega_val\n            dYO_dZ2 = - (2 * current_params['Le_O'] / chi_val) * current_params['s'] * omega_val\n            dYR_dZ2 = - (2 * current_params['Le_R'] / chi_val) * (current_params['kr_prod'] * omega_val - current_params['kr_loss'] * yr)\n            dT_dZ2 = - (2 * current_params['Le_T'] / chi_val) * ( (current_params['q'] / (current_params['rho'] * current_params['cp'])) * omega_val - current_params['kh_loss'] * (t - T_mix_func(z)) )\n            \n            return np.vstack([\n                y[1], dYF_dZ2,\n                y[3], dYO_dZ2,\n                y[5], dYR_dZ2,\n                y[7], dT_dZ2\n            ])\n\n        # Boundary conditions residuals\n        def boundary_conditions(ya, yb):\n            # ya: solution at Z=0, yb: solution at Z=1\n            # ya = [YF(0), YF'(0), ...], yb = [YF(1), YF'(1), ...]\n            return np.array([\n                ya[0] - 0.0,                        # YF(0) = 0\n                ya[2] - current_params['YO0'],      # YO(0) = YO0\n                ya[4] - 0.0,                        # YR(0) = 0\n                ya[6] - current_params['T_ox'],     # T(0) = Tox\n                yb[0] - current_params['YF1'],      # YF(1) = YF1\n                yb[2] - 0.0,                        # YO(1) = 0\n                yb[4] - 0.0,                        # YR(1) = 0\n                yb[6] - current_params['T_fuel']    # T(1) = Tfuel\n            ])\n\n        # Initial grid and guess for the solution\n        Z_st = current_params['Z_st']\n        N_points = 101\n        z_init = np.linspace(0, 1, N_points)\n        y_init = np.zeros((8, N_points))\n\n        # Physically-informed initial guess\n        # YF guess\n        y_init[0, :] = np.where(z_init > Z_st, current_params['YF1'] * (z_init - Z_st) / (1 - Z_st), 0.0)\n        # YO guess\n        y_init[2, :] = np.where(z_init  Z_st, current_params['YO0'] * (Z_st - z_init) / Z_st, 0.0)\n        # YR guess\n        y_init[4, :] = 0.01 * np.exp(-50 * (z_init - Z_st)**2)\n        # T guess\n        T_peak_guess = 1800.0\n        y_init[6, :] = T_mix_func(z_init) + T_peak_guess * np.exp(-50 * (z_init - Z_st)**2)\n\n        # Derivatives guess\n        y_init[1, :-1] = np.diff(y_init[0, :]) / np.diff(z_init)\n        y_init[3, :-1] = np.diff(y_init[2, :]) / np.diff(z_init)\n        y_init[5, :-1] = np.diff(y_init[4, :]) / np.diff(z_init)\n        y_init[7, :-1] = np.diff(y_init[6, :]) / np.diff(z_init)\n        y_init[1, -1], y_init[3, -1], y_init[5, -1], y_init[7, -1] = y_init[1, -2], y_init[3, -2], y_init[5, -2], y_init[7, -2]\n        \n        # Solve the BVP\n        sol = solve_bvp(ode_system, boundary_conditions, z_init, y_init, tol=1e-4, max_nodes=5000)\n        \n        if not sol.success:\n            print(f\"BVP solver failed to converge for case: {case_params}\", file=sys.stderr)\n            # Use extinguished solution as a fallback\n            T_max = np.max(y_init[6,:])\n            YR_max = np.max(y_init[4,:])\n        else:\n            # Post-processing\n            z_sol = sol.x\n            y_sol = sol.y\n            T_sol = y_sol[6]\n            YR_sol = y_sol[4]\n            \n            # Find values within the analysis window\n            window_mask = np.abs(z_sol - Z_st) = current_params['delta_Z']\n            \n            T_in_window = T_sol[window_mask]\n            YR_in_window = YR_sol[window_mask]\n            \n            if T_in_window.size > 0:\n                T_max = np.max(T_in_window)\n            else: # Window might be empty if grid is too coarse, though unlikely\n                T_max = T_mix_func(Z_st)\n\n            if YR_in_window.size > 0:\n                YR_max = np.max(YR_in_window)\n            else:\n                YR_max = 0.0\n\n        extinct = T_max  current_params['T_ext']\n        \n        results.append([round(T_max, 3), round(YR_max, 3), extinct])\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}