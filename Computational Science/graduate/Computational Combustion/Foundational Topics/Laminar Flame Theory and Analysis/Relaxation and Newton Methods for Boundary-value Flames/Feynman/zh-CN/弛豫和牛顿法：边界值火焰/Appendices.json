{
    "hands_on_practices": [
        {
            "introduction": "要使用牛顿法求解描述火焰结构的非线性边值问题，关键的第一步是计算系统的雅可比矩阵。本练习聚焦于其中最复杂的部分：化学反应源项。通过分析推导阿伦尼乌斯反应速率对温度和组分质量分数的偏导数，您将亲身体验线性化控制方程所需的核心分析任务 。",
            "id": "4057801",
            "problem": "考虑一个恒压下的稳态、平面、一维预混火焰，该火焰被建模为空间坐标 $x \\in [0,L]$ 上的一个边值问题（BVP）。该混合物由燃料 $F$、氧化剂 $O$ 和产物 $P$ 组成，它们经历一个单步不可逆反应，化学计量为 $\\nu_{F} F + \\nu_{O} O \\rightarrow \\nu_{P} P$。假设如下：\n\n- 质量通量 $m$ 是常数，热导率 $\\lambda$ 是常数，物种扩散系数 $D$ 是常数且刘易斯数（Lewis number）为1（为简化起见，热扩散系数和质量扩散系数相等）。\n- 恒压比热 $c_{p}$ 是常数。\n- 密度 $\\rho$ 在恒定压力下遵循理想气体关系，且混合物的有效分子量 $\\bar{W}$ 为常数，因此 $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$，其中 $R_{u}$ 是通用气体常数，$\\bar{p}$ 是恒定压力。\n- 放热由一个恒定的有效反应热 $Q$ 表示，使得能量方程中的化学源项为 $- \\sum_{k} h_{k} \\omega_{k} = Q\\,\\dot{\\omega}$，对于放热反应，$Q > 0$。\n- 定义正的化学计量质量因子 $s_{F} = \\nu_{F} W_{F}$、$s_{O} = \\nu_{O} W_{O}$ 和 $s_{P} = \\nu_{P} W_{P}$，其中 $W_{k}$ 是物种的分子量。那么，物种的质量生成速率满足 $\\omega_{F} = - s_{F}\\,\\dot{\\omega}$、$\\omega_{O} = - s_{O}\\,\\dot{\\omega}$ 和 $\\omega_{P} = s_{P}\\,\\dot{\\omega}$。\n- 单位体积的反应进程速率由单步阿伦尼乌斯定律（Arrhenius law）给出\n$$\n\\dot{\\omega}(Y_{F},Y_{O},T) \\;=\\; A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp\\!\\big(-E/(R_{u} T)\\big)\n$$\n其中 $A>0$，活化能 $E>0$，燃料的反应级数 $a>0$，氧化剂的反应级数 $b>0$，以及质量分数 $Y_{F}$ 和 $Y_{O}$。\n\n严格从一维稳态的物种和能量守恒定律以及上述理想气体密度模型出发：\n\n1) 写出燃料质量分数 $Y_{F}(x)$、氧化剂质量分数 $Y_{O}(x)$ 和温度 $T(x)$ 的显式BVP微分方程，包括对流、扩散以及通过 $\\dot{\\omega}$ 表示的化学源项。陈述合理的上游和下游边界条件以完善该BVP。\n\n2) 为了在应用于 $(Y_{F},Y_{O},T)$ 的离散化BVP残差的牛顿法（Newton–Raphson法）中使用，推导反应源对残差向量 $\\boldsymbol{R}(Y_{F},Y_{O},T) = \\big(R_{F},R_{O},R_{T}\\big)$ 贡献的局部偏导数相对于变量 $(Y_{F},Y_{O},T)$ 的解析表达式。假设残差按标准形式组合\n$$\nR_{F} \\;=\\; m\\,\\frac{d Y_{F}}{dx} \\;-\\; \\frac{d}{dx}\\!\\Big(\\rho D\\,\\frac{d Y_{F}}{dx}\\Big) \\;-\\; \\omega_{F}, \\qquad\nR_{O} \\;=\\; m\\,\\frac{d Y_{O}}{dx} \\;-\\; \\frac{d}{dx}\\!\\Big(\\rho D\\,\\frac{d Y_{O}}{dx}\\Big) \\;-\\; \\omega_{O},\n$$\n$$\nR_{T} \\;=\\; m\\,c_{p}\\,\\frac{d T}{dx} \\;-\\; \\frac{d}{dx}\\!\\Big(\\lambda\\,\\frac{d T}{dx}\\Big) \\;-\\; Q\\,\\dot{\\omega},\n$$\n因此，对雅可比矩阵（Jacobian）的反应源贡献是 $(-\\omega_{F}, -\\omega_{O}, -Q\\,\\dot{\\omega})$ 相对于 $(Y_{F},Y_{O},T)$ 的局部导数。在关于 $T$ 的导数中，考虑依赖关系 $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$，并以 $(A,E,R_{u},\\rho,Y_{F},Y_{O},T,a,b,s_{F},s_{O},Q)$ 的闭合解析形式保留结果。\n\n将你的最终答案以单行矩阵的形式报告，其中包含按以下顺序排列的九个偏导数\n$$\n\\bigg(\\frac{\\partial R_{F}}{\\partial Y_{F}},\\;\\frac{\\partial R_{F}}{\\partial Y_{O}},\\;\\frac{\\partial R_{F}}{\\partial T},\\;\\frac{\\partial R_{O}}{\\partial Y_{F}},\\;\\frac{\\partial R_{O}}{\\partial Y_{O}},\\;\\frac{\\partial R_{O}}{\\partial T},\\;\\frac{\\partial R_{T}}{\\partial Y_{F}},\\;\\frac{\\partial R_{T}}{\\partial Y_{O}},\\;\\frac{\\partial R_{T}}{\\partial T}\\bigg).\n$$\n\n以闭式解析表达式给出最终答案。不需要进行数值计算或四舍五入。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n- **系统：** 稳态、平面、一维预混火焰。\n- **空间域：** 空间坐标为 $x \\in [0,L]$。\n- **化学方案：** 涉及燃料 $F$、氧化剂 $O$ 和产物 $P$ 的单步不可逆反应 $\\nu_{F} F + \\nu_{O} O \\rightarrow \\nu_{P} P$。\n- **物理常数和性质：**\n    - 质量通量 $m$ 是常数。\n    - 热导率 $\\lambda$ 是常数。\n    - 物种扩散系数 $D$ 是常数。\n    - 刘易斯数（Lewis numbers）为1。\n    - 恒压比热 $c_{p}$ 是常数。\n    - 放热由一个恒定的有效反应热 $Q > 0$ 表征。\n- **状态和速率模型：**\n    - 密度遵循 $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$，其中压力 $\\bar{p}$、平均分子量 $\\bar{W}$ 和通用气体常数 $R_{u}$ 均为常数。\n    - 能量源项：$- \\sum_{k} h_{k} \\omega_{k} = Q\\,\\dot{\\omega}$。\n    - 物种质量生成速率：$\\omega_{F} = - s_{F}\\,\\dot{\\omega}$、$\\omega_{O} = - s_{O}\\,\\dot{\\omega}$、$\\omega_{P} = s_{P}\\,\\dot{\\omega}$，其中 $s_{F} = \\nu_{F} W_{F}$ 和 $s_{O} = \\nu_{O} W_{O}$ 是正的化学计量质量因子。\n    - 反应进程速率：$\\dot{\\omega}(Y_{F},Y_{O},T) = A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp(-E/(R_{u} T))$，其中指前因子 $A>0$、活化能 $E>0$、反应级数 $a>0$ 和 $b>0$。\n- **牛顿法（Newton's Method）的控制残差：**\n    - $R_{F} = m\\,\\frac{d Y_{F}}{dx} - \\frac{d}{dx}(\\rho D\\,\\frac{d Y_{F}}{dx}) - \\omega_{F}$\n    - $R_{O} = m\\,\\frac{d Y_{O}}{dx} - \\frac{d}{dx}(\\rho D\\,\\frac{d Y_{O}}{dx}) - \\omega_{O}$\n    - $R_{T} = m\\,c_{p}\\,\\frac{d T}{dx} - \\frac{d}{dx}(\\lambda\\,\\frac{d T}{dx}) - Q\\,\\dot{\\omega}$\n- **任务：**\n    1.  写出 $Y_{F}(x)$、$Y_{O}(x)$ 和 $T(x)$ 的显式BVP微分方程，并陈述合理的边界条件。\n    2.  推导反应源对雅可比矩阵（Jacobian matrix）贡献的九个解析偏导数，定义为 $(-\\omega_{F}, -\\omega_{O}, -Q\\,\\dot{\\omega})$ 相对于 $(Y_{F},Y_{O},T)$ 的导数。最终答案应为包含这九个导数的行矩阵。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了一个简化但标准且基础的一维预混火焰模型。控制方程基于质量和能量守恒，而阿伦尼乌斯速率定律（Arrhenius rate law）是化学动力学的基石。这些假设（恒定物性、单位刘易斯数、单步反应）是常用的理想化处理，旨在使问题在解析和计算上易于处理。该模型在科学上是合理的。\n- **适定性：** 该问题是适定的。它要求构建一个BVP（这是一项标准任务），并计算明确定义的偏导数。其结构清晰，能够导出一个唯一且有意义的结果。\n- **客观性：** 该问题使用精确、客观和形式化的数学语言陈述。没有主观或含糊不清的术语。\n\n### 第3步：结论与行动\n该问题是**有效的**。它是计算燃烧理论中一个标准的、自包含的练习。可以开始求解过程。\n\n---\n\n### 解答\n\n按照问题陈述的要求，解答分为两部分呈现。\n\n#### 1. 边值问题（BVP）的构建\n\n稳态一维反应流的控制方程源自物种和能量的守恒原理。对于一个质量通量 $m$ 恒定的系统，质量分数为 $Y_k$、扩散速度为 $V_k$ 的物种守恒由 $\\frac{d}{dx}(m Y_k + \\rho Y_k V_k) = \\omega_k$ 给出。使用菲克定律（Fick's law）进行质量扩散，$\\rho Y_k V_k = -\\rho D_k \\frac{dY_k}{dx}$，展开对流项，我们得到 $m\\frac{dY_k}{dx} - \\frac{d}{dx}(\\rho D_k \\frac{dY_k}{dx}) = \\omega_k$。对能量守恒进行类似的推导可得到温度方程。\n\n应用问题的具体假设——所有物种的扩散系数 $D$ 恒定（由于单位刘易斯数的假设意味着 $D_k = D = \\lambda/(\\rho c_p)$）、热导率 $\\lambda$ 恒定、比热 $c_p$ 恒定——并代入给定的源项表达式，我们得到微分方程组。稳态解的条件是残差 $R_F$、$R_O$ 和 $R_T$ 均为零。\n\n因此，该BVP由以下关于 $Y_F(x)$、$Y_O(x)$ 和 $T(x)$ 的二阶常微分方程组定义：\n\n1.  **燃料质量分数方程：**\n    $$m\\,\\frac{d Y_{F}}{dx} - \\frac{d}{dx}\\!\\left(\\rho D\\,\\frac{d Y_{F}}{dx}\\right) = \\omega_{F} = -s_{F}\\,\\dot{\\omega}$$\n\n2.  **氧化剂质量分数方程：**\n    $$m\\,\\frac{d Y_{O}}{dx} - \\frac{d}{dx}\\!\\left(\\rho D\\,\\frac{d Y_{O}}{dx}\\right) = \\omega_{O} = -s_{O}\\,\\dot{\\omega}$$\n\n3.  **温度方程：**\n    $$m\\,c_{p}\\,\\frac{d T}{dx} - \\frac{d}{dx}\\!\\left(\\lambda\\,\\frac{d T}{dx}\\right) = Q\\,\\dot{\\omega}$$\n\n其中 $\\dot{\\omega} = A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp(-E/(R_{u} T))$ 且 $\\rho(T) = \\bar{p}\\,\\bar{W}/(R_{u} T)$。\n\n在定义域 $x \\in [0,L]$ 上，此BVP的合理边界条件是：\n-   **上游（$x=0$ 处的未燃混合物）：** 我们指定新鲜、未反应混合物的组分和温度。这些是狄利克雷条件（Dirichlet conditions）。\n    $$Y_{F}(0) = Y_{F,u}, \\quad Y_{O}(0) = Y_{O,u}, \\quad T(0) = T_{u}$$\n-   **下游（$x=L$ 处的已燃产物）：** 对于足够长的区域 $L$，火焰完全燃烧，系统接近化学平衡和热均匀状态。这通过将所有变量的梯度设置为零来表示。这些是齐次诺伊曼条件（homogeneous Neumann conditions）。\n    $$\\frac{d Y_{F}}{dx}\\bigg|_{x=L} = 0, \\quad \\frac{d Y_{O}}{dx}\\bigg|_{x=L} = 0, \\quad \\frac{d T}{dx}\\bigg|_{x=L} = 0$$\n\n#### 2. 从反应源推导雅可比矩阵贡献项\n\n任务是求向量 $(-\\omega_{F}, -\\omega_{O}, -Q\\,\\dot{\\omega})$ 相对于变量 $(Y_{F}, Y_{O}, T)$ 的偏导数。\n使用给定的关系，需要微分的函数是：\n-   对于 $R_{F}$ 残差：$-\\omega_{F} = -(-s_{F}\\,\\dot{\\omega}) = s_{F}\\,\\dot{\\omega}$\n-   对于 $R_{O}$ 残差：$-\\omega_{O} = -(-s_{O}\\,\\dot{\\omega}) = s_{O}\\,\\dot{\\omega}$\n-   对于 $R_{T}$ 残差：$-Q\\,\\dot{\\omega}$\n\n中心任务是计算反应速率 $\\dot{\\omega}$ 相对于 $Y_{F}$、$Y_{O}$ 和 $T$ 的偏导数。反应速率为：\n$$\\dot{\\omega} = A\\,\\rho(T)\\,Y_{F}^{a}\\,Y_{O}^{b}\\,\\exp\\!\\left(-\\frac{E}{R_{u} T}\\right)$$\n\n**关于 $Y_{F}$ 的偏导数：**\n$$\\frac{\\partial \\dot{\\omega}}{\\partial Y_{F}} = A\\,\\rho(T)\\,(a\\,Y_{F}^{a-1})\\,Y_{O}^{b}\\,\\exp\\!\\left(-\\frac{E}{R_{u} T}\\right) = \\frac{a}{Y_{F}}\\dot{\\omega}$$\n\n**关于 $Y_{O}$ 的偏导数：**\n根据与 $Y_F$ 导数的对称性：\n$$\\frac{\\partial \\dot{\\omega}}{\\partial Y_{O}} = A\\,\\rho(T)\\,Y_{F}^{a}\\,(b\\,Y_{O}^{b-1})\\,\\exp\\!\\left(-\\frac{E}{R_{u} T}\\right) = \\frac{b}{Y_{O}}\\dot{\\omega}$$\n\n**关于 $T$ 的偏导数：**\n该导数同时涉及 $\\rho(T)$ 和指数项。我们使用对数微分法进行优雅的推导。\n$$\\ln(\\dot{\\omega}) = \\ln(A) + \\ln(\\rho(T)) + a\\ln(Y_{F}) + b\\ln(Y_{O}) - \\frac{E}{R_{u} T}$$\n已知 $\\rho(T) = \\frac{\\bar{p}\\bar{W}}{R_u T}$，我们有 $\\ln(\\rho(T)) = \\ln(\\frac{\\bar{p}\\bar{W}}{R_u}) - \\ln(T)$。将 $\\ln(\\dot{\\omega})$ 对 $T$ 微分得到：\n$$\\frac{1}{\\dot{\\omega}}\\frac{\\partial \\dot{\\omega}}{\\partial T} = \\frac{d}{dT}(-\\ln(T)) - \\frac{d}{dT}\\left(\\frac{E}{R_{u} T}\\right) = -\\frac{1}{T} - \\left(-\\frac{E}{R_{u} T^2}\\right) = \\frac{E}{R_{u} T^2} - \\frac{1}{T}$$\n因此，偏导数为：\n$$\\frac{\\partial \\dot{\\omega}}{\\partial T} = \\dot{\\omega} \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$$\n\n现在，我们构建所需的九个偏导数。根据问题说明，结果不使用简写 $\\dot{\\omega}$ 表示。\n\n1.  $\\frac{\\partial (-\\omega_{F})}{\\partial Y_{F}} = \\frac{\\partial (s_{F}\\dot{\\omega})}{\\partial Y_{F}} = s_{F} \\frac{a}{Y_{F}}\\dot{\\omega} = a s_{F} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T})$\n2.  $\\frac{\\partial (-\\omega_{F})}{\\partial Y_{O}} = \\frac{\\partial (s_{F}\\dot{\\omega})}{\\partial Y_{O}} = s_{F} \\frac{b}{Y_{O}}\\dot{\\omega} = b s_{F} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T})$\n3.  $\\frac{\\partial (-\\omega_{F})}{\\partial T} = \\frac{\\partial (s_{F}\\dot{\\omega})}{\\partial T} = s_{F}\\dot{\\omega}\\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) = s_{F} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$\n4.  $\\frac{\\partial (-\\omega_{O})}{\\partial Y_{F}} = \\frac{\\partial (s_{O}\\dot{\\omega})}{\\partial Y_{F}} = s_{O} \\frac{a}{Y_{F}}\\dot{\\omega} = a s_{O} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T})$\n5.  $\\frac{\\partial (-\\omega_{O})}{\\partial Y_{O}} = \\frac{\\partial (s_{O}\\dot{\\omega})}{\\partial Y_{O}} = s_{O} \\frac{b}{Y_{O}}\\dot{\\omega} = b s_{O} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T})$\n6.  $\\frac{\\partial (-\\omega_{O})}{\\partial T} = \\frac{\\partial (s_{O}\\dot{\\omega})}{\\partial T} = s_{O}\\dot{\\omega}\\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) = s_{O} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$\n7.  $\\frac{\\partial (-Q\\dot{\\omega})}{\\partial Y_{F}} = -Q \\frac{a}{Y_{F}}\\dot{\\omega} = -a Q A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T})$\n8.  $\\frac{\\partial (-Q\\dot{\\omega})}{\\partial Y_{O}} = -Q \\frac{b}{Y_{O}}\\dot{\\omega} = -b Q A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T})$\n9.  $\\frac{\\partial (-Q\\dot{\\omega})}{\\partial T} = -Q\\dot{\\omega}\\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right) = -Q A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)$\n\n将这九个表达式收集到一个单行矩阵中，作为最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\na s_{F} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}), &\nb s_{F} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T}), &\ns_{F} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right), \\\\\na s_{O} A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}), &\nb s_{O} A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T}), &\ns_{O} A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right), \\\\\n-a Q A \\rho Y_{F}^{a-1} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}), &\n-b Q A \\rho Y_{F}^{a} Y_{O}^{b-1} \\exp(-\\frac{E}{R_{u} T}), &\n-Q A \\rho Y_{F}^{a} Y_{O}^{b} \\exp(-\\frac{E}{R_{u} T}) \\left(\\frac{E}{R_{u} T^2} - \\frac{1}{T}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在推导出雅可比矩阵的解析表达式之后，下一步是将连续问题转化为计算机可以求解的离散代数系统。本练习将指导您使用有限差分法在网格上离散化控制方程。您将构建全局雅可比矩阵，并揭示其典型的稀疏块三对角结构，这对于为此类问题设计高效的数值求解器至关重要 。",
            "id": "4057871",
            "problem": "考虑一个火焰坐标系中的稳态、平面、一维边界值预混火焰模型，其中对流、扩散和单步反应耦合了两种组分：燃料和氧化剂。假设密度恒定、物性恒定，并采用等温近似，因此反应速率仅取决于组分。控制组分守恒方程为以下稳态一维偏微分方程 (PDE)，写为在 $x \\in [0,L]$ 上的燃料质量分数 $Y_{F}(x)$ 和氧化剂质量分数 $Y_{O}(x)$：\n$$\n0 \\;=\\; D_{F}\\,\\frac{d^{2}Y_{F}}{dx^{2}} \\;-\\; u\\,\\frac{dY_{F}}{dx} \\;-\\; \\nu_{F}\\,\\omega(Y_{F},Y_{O}),\n$$\n$$\n0 \\;=\\; D_{O}\\,\\frac{d^{2}Y_{O}}{dx^{2}} \\;-\\; u\\,\\frac{dY_{O}}{dx} \\;-\\; \\nu_{O}\\,\\omega(Y_{F},Y_{O}),\n$$\n其中 $D_{F}$ 和 $D_{O}$ 是组分扩散系数，$u$ 是恒定的对流速度，$\\nu_{F} > 0$ 和 $\\nu_{O} > 0$ 是化学计量消耗系数，单步等温反应速率由下式给出\n$$\n\\omega(Y_{F},Y_{O}) \\;=\\; k\\,Y_{F}\\,Y_{O},\n$$\n其中 $k>0$ 是一个常数。\n\n使用 $N$ 个内部点 $\\{x_{i}\\}_{i=1}^{N}$ 将域离散化，这些点均匀分布，网格间距为 $\\Delta x = L/(N+1)$，并在 $x=0$ 和 $x=L$ 处施加 Dirichlet 边界条件：\n$$\nY_{F}(0) = Y_{F,L},\\quad Y_{O}(0) = Y_{O,L},\\quad Y_{F}(L) = Y_{F,R},\\quad Y_{O}(L) = Y_{O,R},\n$$\n其中 $Y_{F,L}$、$Y_{O,L}$、$Y_{F,R}$ 和 $Y_{O,R}$ 是已知常数。在内部节点上，对一阶和二阶导数均使用基于三点格式的二阶中心差分。在每个内部网格点 $i \\in \\{1,\\dots,N\\}$ 处，构建离散残差 $R_{F,i}(Y_{F,i-1},Y_{F,i},Y_{F,i+1},Y_{O,i})$ 和 $R_{O,i}(Y_{O,i-1},Y_{O,i},Y_{O,i+1},Y_{F,i})$，其中 $Y_{F,i}$ 和 $Y_{O,i}$ 表示节点 $i$ 处的未知数，而 $i=0$ 和 $i=N+1$ 处的边界值被视为已知。\n\n设全局未知向量按节点进行字典序排列，每个节点内的组分组合在一起：\n$$\n\\mathbf{U} \\;=\\; \\big( Y_{F,1},\\,Y_{O,1},\\,Y_{F,2},\\,Y_{O,2},\\,\\dots,\\,Y_{F,N},\\,Y_{O,N} \\big)^{\\mathsf{T}}.\n$$\n相应地，通过按节点堆叠组分残差来定义全局残差 $\\mathbf{R}(\\mathbf{U})$。\n\n使用用于非线性系统的 Newton 方法，通过计算三点格式中出现的所需偏导数来构建雅可比矩阵 $\\mathbf{J} = \\partial \\mathbf{R}/\\partial \\mathbf{U}$。明确写出：\n- 在内部节点 $i$ 处，填充耦合 $(Y_{F,i},Y_{O,i})$ 的对角 $2\\times 2$ 块所需的解析偏导数，\n- 填充耦合节点 $i$ 与节点 $i-1$ 和 $i+1$ 的非对角 $2\\times 2$ 块的解析偏导数，\n- 全局雅可比矩阵 $\\mathbf{J}$ 的稀疏模式，用带有 Dirichlet 边界的三点格式所产生的非零位置来描述。\n\n最后，计算全局雅可比矩阵 $\\mathbf{J}$ 中非零项的总数，作为内部点数 $N$ 的函数。将最终答案表示为一个关于 $N$ 的、无单位的单个精确符号表达式。",
            "solution": "该问题已经过验证，被确定为计算燃烧学中一个适定的、有科学依据的问题。它包含了所有必要的信息，并且没有矛盾或歧义。\n\n我们首先建立系统的离散残差方程。域 $x \\in [0,L]$ 被离散化为 $N$ 个内部点 $\\{x_i\\}_{i=1}^{N}$，其均匀间距为 $\\Delta x = L/(N+1)$。节点 $x_0=0$ 和 $x_{N+1}=L$ 是边界点。设 $Y_{F,i} \\approx Y_F(x_i)$ 和 $Y_{O,i} \\approx Y_O(x_i)$。\n\n对内部节点 $i$ 处的一阶和二阶导数使用二阶中心差分格式：\n$$\n\\frac{dY}{dx}\\bigg|_{i} \\approx \\frac{Y_{i+1} - Y_{i-1}}{2\\Delta x}\n$$\n$$\n\\frac{d^{2}Y}{dx^{2}}\\bigg|_{i} \\approx \\frac{Y_{i+1} - 2Y_{i} + Y_{i-1}}{(\\Delta x)^2}\n$$\n将这些近似式代入控制方程，得到每个内部节点 $i \\in \\{1, \\dots, N\\}$ 的离散残差方程。\n\n对于燃料质量分数 $Y_F$：\n$$\nR_{F,i}(Y_{F,i-1}, Y_{F,i}, Y_{F,i+1}, Y_{O,i}) = D_{F}\\,\\left(\\frac{Y_{F,i+1} - 2Y_{F,i} + Y_{F,i-1}}{(\\Delta x)^{2}}\\right) - u\\,\\left(\\frac{Y_{F,i+1} - Y_{F,i-1}}{2\\Delta x}\\right) - \\nu_{F}\\,k\\,Y_{F,i}\\,Y_{O,i}\n$$\n对于氧化剂质量分数 $Y_O$：\n$$\nR_{O,i}(Y_{O,i-1}, Y_{O,i}, Y_{O,i+1}, Y_{F,i}) = D_{O}\\,\\left(\\frac{Y_{O,i+1} - 2Y_{O,i} + Y_{O,i-1}}{(\\Delta x)^{2}}\\right) - u\\,\\left(\\frac{Y_{O,i+1} - Y_{O,i-1}}{2\\Delta x}\\right) - \\nu_{O}\\,k\\,Y_{F,i}\\,Y_{O,i}\n$$\n边界上的值 $Y_{F,0}=Y_{F,L}$、$Y_{O,0}=Y_{O,L}$、$Y_{F,N+1}=Y_{F,R}$ 和 $Y_{O,N+1}=Y_{O,R}$ 是已知常数。\n\nNewton 方法需要雅可比矩阵 $\\mathbf{J} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{U}}$，其中全局未知向量为 $\\mathbf{U} = (Y_{F,1}, Y_{O,1}, \\dots, Y_{F,N}, Y_{O,N})^{\\mathsf{T}}$，全局残差向量为 $\\mathbf{R} = (R_{F,1}, R_{O,1}, \\dots, R_{F,N}, R_{O,N})^{\\mathsf{T}}$。雅可比矩阵是一个 $(2N) \\times (2N)$ 的块矩阵。一个通用块元素 $\\mathbf{J}_{ij}$ 是一个由下式给出的 $2\\times 2$ 矩阵：\n$$\n\\mathbf{J}_{ij} = \\frac{\\partial (R_{F,i}, R_{O,i})}{\\partial (Y_{F,j}, Y_{O,j})} = \\begin{pmatrix} \\frac{\\partial R_{F,i}}{\\partial Y_{F,j}} & \\frac{\\partial R_{F,i}}{\\partial Y_{O,j}} \\\\ \\frac{\\partial R_{O,i}}{\\partial Y_{F,j}} & \\frac{\\partial R_{O,i}}{\\partial Y_{O,j}} \\end{pmatrix}\n$$\n由于三点格式，节点 $i$ 处的残差仅依赖于节点 $i-1$、$i$ 和 $i+1$ 处的未知数。因此，对于 $|i-j|>1$，$\\mathbf{J}_{ij}$ 为零，雅可比矩阵 $\\mathbf{J}$ 是块三对角的。\n\n题目要求给出构成这些块的显式偏导数。\n\n**1. 对角块导数（耦合节点 $i$ 与自身, $j=i$）**\n这些导数构成了 $2 \\times 2$ 的对角块 $\\mathbf{J}_{ii}$。我们将残差 $R_{F,i}$ 和 $R_{O,i}$ 对未知数 $Y_{F,i}$ 和 $Y_{O,i}$ 求导：\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{F,i}} = \\frac{-2D_{F}}{(\\Delta x)^{2}} - \\nu_{F}\\,k\\,Y_{O,i}\n$$\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{O,i}} = -\\nu_{F}\\,k\\,Y_{F,i}\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{F,i}} = -\\nu_{O}\\,k\\,Y_{O,i}\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{O,i}} = \\frac{-2D_{O}}{(\\Delta x)^{2}} - \\nu_{O}\\,k\\,Y_{F,i}\n$$\n\n**2. 非对角块导数（耦合节点 $i$ 与 $i-1$ 和 $i+1$）**\n这些导数填充了非对角块 $\\mathbf{J}_{i,i-1}$ 和 $\\mathbf{J}_{i,i+1}$。\n\n对于下非对角块 $\\mathbf{J}_{i,i-1}$（其中 $i \\in \\{2, \\dots, N\\}$），我们对 $Y_{F,i-1}$ 和 $Y_{O,i-1}$ 求导：\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{F,i-1}} = \\frac{D_{F}}{(\\Delta x)^{2}} + \\frac{u}{2\\Delta x}\n$$\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{O,i-1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{F,i-1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{O,i-1}} = \\frac{D_{O}}{(\\Delta x)^{2}} + \\frac{u}{2\\Delta x}\n$$\n对于上非对角块 $\\mathbf{J}_{i,i+1}$（其中 $i \\in \\{1, \\dots, N-1\\}$），我们对 $Y_{F,i+1}$ 和 $Y_{O,i+1}$ 求导：\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{F,i+1}} = \\frac{D_{F}}{(\\Delta x)^{2}} - \\frac{u}{2\\Delta x}\n$$\n$$\n\\frac{\\partial R_{F,i}}{\\partial Y_{O,i+1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{F,i+1}} = 0\n$$\n$$\n\\frac{\\partial R_{O,i}}{\\partial Y_{O,i+1}} = \\frac{D_{O}}{(\\Delta x)^{2}} - \\frac{u}{2\\Delta x}\n$$\n\n**3. 全局雅可比矩阵 $\\mathbf{J}$ 的稀疏模式**\n全局雅可比矩阵 $\\mathbf{J}$ 是一个 $(2N) \\times (2N)$ 的矩阵。如前所述，它具有块三对角结构：\n$$\n\\mathbf{J} = \\begin{pmatrix}\n\\mathbf{A}_1 & \\mathbf{C}_1 &  & \\mathbf{0} \\\\\n\\mathbf{B}_2 & \\mathbf{A}_2 & \\mathbf{C}_2 &  \\\\\n & \\ddots & \\ddots & \\ddots & \\\\\n & & \\mathbf{B}_{N-1} & \\mathbf{A}_{N-1} & \\mathbf{C}_{N-1} \\\\\n\\mathbf{0} & & & \\mathbf{B}_N & \\mathbf{A}_N\n\\end{pmatrix}\n$$\n其中 $\\mathbf{A}_i=\\mathbf{J}_{ii}$、$\\mathbf{B}_i=\\mathbf{J}_{i,i-1}$ 和 $\\mathbf{C}_i=\\mathbf{J}_{i,i+1}$ 是 $2 \\times 2$ 的块。\n- 对角块 $\\mathbf{A}_i$ 通常是稠密的，包含四个非零项，这是由反应项和二阶导数格式中 $Y_{F,i}$ 和 $Y_{O,i}$ 的耦合产生的。\n- 非对角块 $\\mathbf{B}_i$ 和 $\\mathbf{C}_i$ 是对角矩阵。每个包含两个非零项，因为对于此模型，节点 $i$ 处的燃料方程不依赖于相邻节点的氧化剂（反之亦然）。\n\n**4. 非零项总数**\n为求得非零项的总数，我们将每种类型的块的贡献相加。\n- 有 $N$ 个对角块 ($\\mathbf{A}_i$)。每个贡献 $4$ 个非零项。来自对角块的总数为：$4N$。\n- 有 $N-1$ 个下非对角块 ($\\mathbf{B}_i$)。每个贡献 $2$ 个非零项。来自下非对角块的总数为：$2(N-1)$。\n- 有 $N-1$ 个上非对角块 ($\\mathbf{C}_i$)。每个贡献 $2$ 个非零项。来自上非对角块的总数为：$2(N-1)$。\n\n雅可比矩阵 $\\mathbf{J}$ 中非零项的总数是这些贡献的总和：\n$$\n\\text{Total nonzeros} = 4N + 2(N-1) + 2(N-1) = 4N + 2N - 2 + 2N - 2 = 8N - 4\n$$",
            "answer": "$$\\boxed{8N - 4}$$"
        },
        {
            "introduction": "仅有对牛顿法的理论理解是不够的；对于像火焰这样的刚性问题，其实际应用需要特定的技术来保证稳健的收敛性。这项编码练习将带您从理论走向实践，挑战您使用回溯线搜索来实现一种带阻尼的牛顿法。通过强制执行 Armijo 条件以确保充分下降，您将学习如何防止迭代发散或振荡，这是开发可靠科学计算软件的一项关键技能 。",
            "id": "4057815",
            "problem": "考虑一个无量纲、一维、稳态预混边界值火焰模型，其标量反应进度变量为 $y(x)$，定义域为 $x \\in [0,1]$，其中 $y(x)$ 满足狄利克雷边界条件 $y(0)=1$ 和 $y(1)=0$。在最简单的反应-扩散近似中，源于物种守恒和傅里叶/菲克型扩散的控制常微分方程 (ODE) 为\n$$\n-D \\frac{d^2 y}{dx^2} + \\mathrm{Da}\\, f(y) = 0,\n$$\n其中 $D>0$ 是一个常数无量纲扩散系数，$\\mathrm{Da}>0$ 是丹姆科勒数（反应速率与输运速率之比），$f(y)$ 是一个光滑的非线性反应源项。在本问题中，使用\n$$\nf(y) = y\\,(1-y)\\, e^{\\beta y},\n$$\n其中 $\\beta \\ge 0$ 是一个无量纲活化参数。\n\n在具有 $N$ 个节点（索引为 $i=0,1,\\dots,N-1$）的均匀网格上离散化该 ODE，网格间距为 $\\Delta x = \\frac{1}{N-1}$，未知向量为 $U=\\mathbf{y} \\in \\mathbb{R}^{N}$，其集合了节点值 $y_i \\approx y(x_i)$，其中 $x_i=i\\Delta x$。通过残差方程施加狄利克雷边界条件。将离散残差 $F(U) \\in \\mathbb{R}^{N}$ 定义为\n- 边界残差：$F_0(U) = y_0 - 1$ 和 $F_{N-1}(U) = y_{N-1} - 0$，\n- 内部残差，对于 $i=1,\\dots,N-2$：\n$$\nF_i(U) = -D\\,\\frac{y_{i-1} - 2 y_i + y_{i+1}}{\\Delta x^2} + \\mathrm{Da}\\, f(y_i).\n$$\n\n求解 $F(U)=0$ 的牛顿法基于在当前迭代点 $U$ 附近对 $F$ 进行线性化，组装雅可比矩阵 $J(U)=\\frac{\\partial F}{\\partial U}$，求解线性系统 $J(U)\\,p = -F(U)$ 以获得牛顿步 $p$，并使用步长 $\\alpha \\in (0,1]$ 更新 $U_{\\text{new}} = U + \\alpha p$。为了改善高度非线性火焰问题的全局收敛性和鲁棒性，需要对价值函数使用线搜索进行阻尼。\n\n令价值函数为\n$$\n\\phi(U) = \\frac{1}{2} \\|F(U)\\|_2^2,\n$$\n其梯度为 $\\nabla \\phi(U) = J(U)^\\top F(U)$。选择 $\\alpha$ 的充分下降条件（通常称为 Armijo 条件）是\n$$\n\\phi(U + \\alpha p) \\le \\phi(U) + c_1 \\alpha\\, \\nabla \\phi(U)^\\top p,\n$$\n其中 $c_1 \\in (0,1)$ 是一个固定参数。\n\n任务：\n- 从稳态守恒定律和给定的离散化出发，推导实现带有回溯线搜索的牛顿法所需的表达式，该方法强制价值函数 $\\phi(U)=\\frac{1}{2}\\|F(U)\\|_2^2$ 充分下降。\n- 为离散残差 $F(U)$ 显式地构建雅可比矩阵 $J(U)$。\n- 实现一个牛顿迭代，该迭代通过 $J(U)p=-F(U)$ 计算 $p$，并对 $\\alpha$ 执行回溯线搜索，以强制满足具有固定 $c_1$ 的 Armijo 条件。\n- 使用以下参数集和初始猜测的测试套件：\n    - 情况1（理想路径）：$N=64$，$D=1$，$\\mathrm{Da}=10$，$\\beta=5$，初始猜测 $y_i^{(0)} = 1 - x_i$。\n    - 情况2（强反应非线性）：$N=64$，$D=1$，$\\mathrm{Da}=100$，$\\beta=10$，初始猜测 $y_i^{(0)} = 1 - x_i$。\n    - 情况3（更刚性的边缘情况）：$N=128$，$D=1$，$\\mathrm{Da}=300$，$\\beta=20$，初始猜测 $y_i^{(0)} = 1 - x_i$。\n- 在每种情况下，在初始猜测处执行一次牛顿线性化，计算牛顿步 $p$，并从 $\\alpha_0=1$ 开始应用回溯线搜索，使用 $c_1=10^{-4}$，重复将 $\\alpha$ 减半，直到满足 Armijo 条件。在该第一次牛顿步的线搜索终止后，记录接受的 $\\alpha$。如果在 50 次减半内未满足 Armijo 条件，则返回最后测试的 $\\alpha$。\n- 您的程序应生成单行输出，其中包含三个测试用例所接受的步长，格式为方括号内以逗号分隔的列表（例如，$[0.5,0.25,1.0]$）。输出是无单位的无量纲数，应打印为 Python 浮点字面量。\n\n您的实现必须是一个完整、可运行的程序。它不能读取输入。它必须使用上述定义实现牛顿步和 Armijo 回溯线搜索。测试套件涵盖一个一般情况（情况1），一个可能需要阻尼的强非线性情况（情况2），以及一个预计需要更强阻尼的更刚性的边缘情况（情况3）。每种情况的最终答案都是一个浮点数，表示仅对第一个牛顿步强制执行 $\\phi$ 的充分下降条件后接受的步长 $\\alpha$。最终输出格式必须是单行：方括号内包含三个浮点数的列表，以逗号分隔，没有空格。",
            "solution": "问题陈述提出了计算燃烧学领域一个明确定义的数值任务，要求为一个离散化的一维边界值火焰问题实现一个带有回溯线搜索的单次牛顿步。该问题具有科学依据，数学上一致，并为其解决方案提供了所有必要信息。因此，该问题被认为是有效的。我们继续进行推导和实现。\n\n问题的核心是找到非线性代数方程组 $F(U)=0$ 的近似解，其中 $U \\in \\mathbb{R}^N$ 是反应进度变量的未知节点值 $y_i$ 的向量，而 $F(U) \\in \\mathbb{R}^N$ 是离散残差向量。求解方法是牛顿法，该方法需要残差的雅可比矩阵 $J(U) = \\frac{\\partial F}{\\partial U}$。\n\n首先，我们推导雅可比矩阵的元素 $J_{ij} = \\frac{\\partial F_i}{\\partial y_j}$。残差向量 $F(U)$ 是按分量定义的。\n\n对于边界条件，残差为：\n1.  在 $x_0=0$ 处：$F_0(U) = y_0 - 1$。\n2.  在 $x_{N-1}=1$ 处：$F_{N-1}(U) = y_{N-1} - 0$。\n\n这些行的偏导数是直接的：\n- 对于行 $i=0$：$\\frac{\\partial F_0}{\\partial y_0} = 1$，且当 $j \\neq 0$ 时 $\\frac{\\partial F_0}{\\partial y_j} = 0$。\n- 对于行 $i=N-1$：$\\frac{\\partial F_{N-1}}{\\partial y_{N-1}} = 1$，且当 $j \\neq N-1$ 时 $\\frac{\\partial F_{N-1}}{\\partial y_j} = 0$。\n\n对于内部节点 $i \\in \\{1, 2, \\dots, N-2\\}$，残差由离散化的控制方程给出：\n$$\nF_i(U) = -D\\,\\frac{y_{i-1} - 2 y_i + y_{i+1}}{\\Delta x^2} + \\mathrm{Da}\\, f(y_i)\n$$\n其中 $\\Delta x = \\frac{1}{N-1}$ 是网格间距，且 $f(y) = y(1-y)e^{\\beta y}$。\n\n$F_i$ 对于内部节点 $i$ 的偏导数仅依赖于 $y_{i-1}$、$y_i$ 和 $y_{i+1}$，使得雅可比矩阵在这些行上是三对角的。\n- 关于 $y_{i-1}$ 的偏导数是：\n$$\nJ_{i, i-1} = \\frac{\\partial F_i}{\\partial y_{i-1}} = -D\\,\\frac{1}{\\Delta x^2}\n$$\n- 关于 $y_{i+1}$ 的偏导数是：\n$$\nJ_{i, i+1} = \\frac{\\partial F_i}{\\partial y_{i+1}} = -D\\,\\frac{1}{\\Delta x^2}\n$$\n- 关于 $y_i$ 的偏导数涉及到反应源项的导数 $f'(y) = \\frac{df}{dy}$：\n$$\nJ_{i, i} = \\frac{\\partial F_i}{\\partial y_i} = -D\\,\\frac{-2}{\\Delta x^2} + \\mathrm{Da}\\, \\frac{d}{dy_i} [f(y_i)] = \\frac{2D}{\\Delta x^2} + \\mathrm{Da}\\,f'(y_i)\n$$\n为完成此表达式，我们计算 $f(y)$ 的导数：\n$$\nf(y) = (y-y^2)e^{\\beta y}\n$$\n使用乘法法则，我们得到：\n$$\nf'(y) = \\frac{d}{dy}(y-y^2) \\cdot e^{\\beta y} + (y-y^2) \\cdot \\frac{d}{dy}(e^{\\beta y}) = (1-2y)e^{\\beta y} + (y-y^2)(\\beta e^{\\beta y})\n$$\n$$\nf'(y) = (1 - 2y + \\beta y - \\beta y^2)e^{\\beta y}\n$$\n因此，雅可比矩阵 $J(U)$ 是一个 $N \\times N$ 矩阵，其第一行和最后一行的对角线元素为 `1`，内部行具有如上推导的三对角结构。\n\n牛顿迭代包括两个主要阶段：\n1.  **求解牛顿步 $p$**：给定当前迭代点 $U$，我们计算残差 $F(U)$ 和雅可比矩阵 $J(U)$，然后求解线性系统 $J(U)p = -F(U)$。\n2.  **为步长 $\\alpha$ 进行线搜索**：我们找到一个步长 $\\alpha \\in (0, 1]$，确保价值函数有充分下降。此处，价值函数为 $\\phi(U) = \\frac{1}{2}\\|F(U)\\|_2^2$。充分下降（Armijo）条件是：\n$$\n\\phi(U + \\alpha p) \\le \\phi(U) + c_1 \\alpha\\, \\nabla \\phi(U)^\\top p\n$$\n价值函数的梯度是 $\\nabla \\phi(U) = J(U)^\\top F(U)$。代入此式和牛顿方程 $J(U)p = -F(U)$ 可以简化方向导数项：\n$$\n\\nabla \\phi(U)^\\top p = (J(U)^\\top F(U))^\\top p = F(U)^\\top J(U) p = F(U)^\\top (-F(U)) = -\\|F(U)\\|_2^2\n$$\n因此，Armijo 条件简化为：\n$$\n\\frac{1}{2}\\|F(U + \\alpha p)\\|_2^2 \\le \\frac{1}{2}\\|F(U)\\|_2^2 - c_1 \\alpha \\|F(U)\\|_2^2\n$$\n这种形式在计算上是高效的，因为它避免了显式构造 $J^\\top F$。\n\n每个测试用例的算法如下：\n1.  初始化参数（$N$, $D$, $\\mathrm{Da}$, $\\beta$）和网格属性（$\\Delta x$, $x_i$）。\n2.  定义初始猜测 $U^{(0)}$ 为 $y_i^{(0)} = 1 - x_i$。\n3.  计算初始残差 $F(U^{(0)})$ 和雅可比矩阵 $J(U^{(0)})$。\n4.  求解线性系统 $J(U^{(0)})p = -F(U^{(0)})$ 以获得牛顿步 $p$。\n5.  计算初始价值函数值 $\\phi(U^{(0)})$ 和残差的 L2 范数平方 $\\|F(U^{(0)})\\|_2^2$。\n6.  执行回溯线搜索：\n    a. 从 $\\alpha = 1$ 开始。\n    b. 在一个循环中，测试当前的 $\\alpha$。\n    c. 如果满足简化的 Armijo 条件，则接受当前的 $\\alpha$ 并终止搜索。\n    d. 如果条件不满足，则将 $\\alpha$ 减半（$\\alpha \\leftarrow \\alpha/2$）并重复测试。\n    e. 这个过程最多重复 50 次减半（即，对 $\\alpha = 1, 0.5, \\dots, 2^{-50}$ 共进行 51 次测试）。如果在最后一次测试后条件仍未满足，则记录最后测试的 $\\alpha$ 值。\n7.  为该情况记录最终接受的（或最后测试的）$\\alpha$。\n\n实现将针对三个指定的测试用例遵循此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the backtracking line search step length alpha for three test cases\n    of a 1D boundary-value flame problem discretized with finite differences.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (N, D, Da, beta)\n        (64, 1.0, 10.0, 5.0),\n        # Case 2: (N, D, Da, beta)\n        (64, 1.0, 100.0, 10.0),\n        # Case 3: (N, D, Da, beta)\n        (128, 1.0, 300.0, 20.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, D, Da, beta = case\n        \n        # --- Helper Functions for Reaction Kinetics ---\n        def f_reaction(y, beta_val):\n            \"\"\"Reaction source term f(y) = y(1-y)exp(beta*y)\"\"\"\n            return y * (1.0 - y) * np.exp(beta_val * y)\n\n        def df_reaction_dy(y, beta_val):\n            \"\"\"Derivative of the reaction source term, f'(y)\"\"\"\n            return (1.0 - 2.0 * y + beta_val * y - beta_val * y**2) * np.exp(beta_val * y)\n\n        # --- Functions to build the discrete residual and Jacobian ---\n        def compute_residual(U, n_nodes, D_val, Da_val, beta_val, dx):\n            \"\"\"Computes the residual vector F(U)\"\"\"\n            F = np.zeros(n_nodes)\n            # Boundary conditions\n            F[0] = U[0] - 1.0\n            F[n_nodes - 1] = U[n_nodes - 1] - 0.0\n            \n            # Interior nodes\n            dx2 = dx**2\n            for i in range(1, n_nodes - 1):\n                laplacian = (U[i-1] - 2.0 * U[i] + U[i+1]) / dx2\n                F[i] = -D_val * laplacian + Da_val * f_reaction(U[i], beta_val)\n            return F\n\n        def compute_jacobian(U, n_nodes, D_val, Da_val, beta_val, dx):\n            \"\"\"Computes the Jacobian matrix J(U)\"\"\"\n            J = np.zeros((n_nodes, n_nodes))\n            # Boundary conditions derivatives\n            J[0, 0] = 1.0\n            J[n_nodes - 1, n_nodes - 1] = 1.0\n            \n            # Interior nodes derivatives\n            dx2 = dx**2\n            d_val = -D_val / dx2\n            for i in range(1, n_nodes - 1):\n                # Off-diagonal elements (from diffusion term)\n                J[i, i-1] = d_val\n                J[i, i+1] = d_val\n                # Diagonal element (from diffusion and reaction)\n                J[i, i] = -2.0 * d_val + Da_val * df_reaction_dy(U[i], beta_val)\n            return J\n\n        # --- Main Logic for a Single Case ---\n        \n        # 1. Setup grid and initial guess\n        dx = 1.0 / (N - 1)\n        x = np.linspace(0, 1, N)\n        U0 = 1.0 - x  # Initial guess U^(0)\n\n        # 2. Perform one Newton step\n        #    a. Compute residual and Jacobian at U0\n        F0 = compute_residual(U0, N, D, Da, beta, dx)\n        J0 = compute_jacobian(U0, N, D, Da, beta, dx)\n        \n        #    b. Solve for the Newton step 'p' from J*p = -F\n        p = np.linalg.solve(J0, -F0)\n\n        # 3. Perform backtracking line search for alpha\n        c1 = 1e-4\n        max_halvings = 50\n        \n        # Pre-compute terms for Armijo condition\n        norm_F0_sq = np.dot(F0, F0)\n        phi0 = 0.5 * norm_F0_sq\n        \n        alpha = 1.0\n        # Loop for up to 50 halvings (51 total tests)\n        for i in range(max_halvings + 1):\n            U_trial = U0 + alpha * p\n            F_trial = compute_residual(U_trial, N, D, Da, beta, dx)\n            phi_trial = 0.5 * np.dot(F_trial, F_trial)\n            \n            # Armijo sufficient decrease condition\n            if phi_trial = phi0 - c1 * alpha * norm_F0_sq:\n                # Accepted alpha, break the search\n                break\n            \n            # If condition not met, halve alpha for the next iteration\n            # The problem states to return the *last tested alpha* if it never passes.\n            # This loop structure ensures that if the condition never passes,\n            # 'alpha' holds the value from the last test (i=50).\n            if i  max_halvings:\n                alpha /= 2.0\n                \n        results.append(alpha)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}