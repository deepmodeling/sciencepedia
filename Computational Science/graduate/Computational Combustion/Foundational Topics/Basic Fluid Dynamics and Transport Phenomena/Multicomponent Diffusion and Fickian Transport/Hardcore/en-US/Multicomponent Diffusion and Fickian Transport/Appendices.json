{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone skill in computational transport is the ability to accurately solve the fundamental diffusion equation. This practice guides you through the process of deriving the 1D diffusion equation from species conservation principles for a binary mixture and implementing a numerical solution using a finite-difference scheme. By validating your code against a known analytical solution, you will build essential skills in algorithm development, stability analysis, and code verification for parabolic partial differential equations. ",
            "id": "4043180",
            "problem": "Consider a one-dimensional, isothermal, constant-pressure, binary gas mixture where hydrogen $\\text{H}_2$ diffuses into nitrogen $\\text{N}_2$ along the spatial coordinate $x \\in [0,L]$. Assume the mixture is quiescent so that bulk convection is negligible, the total mass density $\\rho$ is uniform, and the binary diffusion coefficient $D_{\\text{H_2,N_2}}$ is constant. The wall at $x=0$ is instantaneously set and maintained at a fixed hydrogen mass fraction $Y_{\\text{H_2}}(x=0,t)=Y_s$, and the domain is initially free of hydrogen, $Y_{\\text{H_2}}(x,0)=0$ for $x>0$. The far boundary at $x=L$ is held at $Y_{\\text{H_2}}(x=L,t)=0$ so that, for times of interest, the finite domain approximates a semi-infinite half-space.\n\nStarting from fundamental species conservation and a constitutive relation for diffusive flux valid for binary mixtures derived from the Maxwell–Stefan equations, show that, under the stated assumptions, the hydrogen mass fraction obeys a diffusion equation. You will then implement a numerical solver to compute the profile $Y_{\\text{H_2}}(x,t)$ and validate it against the analytical solution that can be expressed using the complementary error function.\n\nYour program must:\n- Derive an explicit finite-difference time-stepping scheme on a uniform grid for $x \\in [0,L]$ to advance $Y_{\\text{H_2}}$ from $t=0$ to a specified final time $t_{\\text{end}}$, with Dirichlet boundary conditions $Y_{\\text{H_2}}(0,t)=Y_s$ and $Y_{\\text{H_2}}(L,t)=0$, and initial condition $Y_{\\text{H_2}}(x,0)=0$.\n- Respect the explicit scheme stability condition by choosing a time step $\\Delta t$ consistent with the diffusion coefficient and grid spacing.\n- Compute the analytical reference profile at $t=t_{\\text{end}}$ that is expressible via the complementary error function, appropriate for an initially hydrogen-free semi-infinite domain maintained at $Y_s$ at $x=0$.\n- Return, for each test case, the root-mean-square error across the spatial grid between the numerical and analytical hydrogen mass fraction at $t_{\\text{end}}$. The error is dimensionless because it is based on mass fraction.\n\nUse the following test suite of scientifically plausible parameters, all at $\\text{T} \\approx \\text{300\\,K}$ and $\\text{p} \\approx \\text{1\\,atm}$, with $D_{\\text{H_2,N_2}} \\approx 7.8 \\times 10^{-5}\\,\\text{m^2/s}$:\n- Case A (general case): $D = 7.8 \\times 10^{-5}\\,\\text{m^2/s}$, $L = 0.05\\,\\text{m}$, $N_x = 201$ grid points, $Y_s = 0.1$ (dimensionless), $t_{\\text{end}} = 0.2\\,\\text{s}$, explicit stability ratio factor $r=0.4$ so that $\\Delta t = r \\,\\Delta t_{\\max}$ with $\\Delta t_{\\max} = \\tfrac{1}{2}\\,\\Delta x^2/D$.\n- Case B (early-time boundary layer): $D = 7.8 \\times 10^{-5}\\,\\text{m^2/s}$, $L = 0.05\\,\\text{m}$, $N_x = 201$, $Y_s = 0.1$, $t_{\\text{end}} = 0.005\\,\\text{s}$, $r=0.4$.\n- Case C (near-stability explicit time step): $D = 7.8 \\times 10^{-5}\\,\\text{m^2/s}$, $L = 0.05\\,\\text{m}$, $N_x = 201$, $Y_s = 0.1$, $t_{\\text{end}} = 0.1\\,\\text{s}$, $r=0.49$.\n- Case D (coarse spatial resolution): $D = 7.8 \\times 10^{-5}\\,\\text{m^2/s}$, $L = 0.05\\,\\text{m}$, $N_x = 51$, $Y_s = 0.1$, $t_{\\text{end}} = 0.2\\,\\text{s}$, $r=0.4$.\n- Case E (different imposed mass fraction): $D = 7.8 \\times 10^{-5}\\,\\text{m^2/s}$, $L = 0.05\\,\\text{m}$, $N_x = 201$, $Y_s = 0.05$, $t_{\\text{end}} = 0.2\\,\\text{s}$, $r=0.4$.\n\nPhysical units:\n- Report $D$ in $\\text{m^2/s}$, $L$ and $x$ in $\\text{m}$, $t$ in $\\text{s}$, and $Y_{\\text{H_2}}$ is dimensionless (mass fraction).\n- The final results are root-mean-square errors in mass fraction, which are dimensionless floats.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the cases in the order A through E, for example, $\\left[\\text{error}_A,\\text{error}_B,\\text{error}_C,\\text{error}_D,\\text{error}_E\\right]$.",
            "solution": "The user-provided problem has been assessed and is determined to be **valid**. It is a well-posed, scientifically grounded problem in the field of transport phenomena and computational methods. It is self-contained, with all necessary parameters, initial conditions, and boundary conditions provided. The underlying physics of Fickian diffusion is correctly stated, and the request to derive the governing equation, implement a standard numerical scheme, and validate it against a known analytical solution constitutes a standard and meaningful exercise in computational science.\n\n**1. Derivation of the Governing Equation**\n\nThe starting point is the general conservation equation for a chemical species $i$ in a multicomponent mixture:\n$$\n\\frac{\\partial (\\rho Y_i)}{\\partial t} + \\nabla \\cdot (\\rho Y_i \\mathbf{v}) = -\\nabla \\cdot \\mathbf{J}_i + \\dot{\\omega}_i\n$$\nHere, $\\rho$ is the total mass density, $Y_i$ is the mass fraction of species $i$, $t$ is time, $\\mathbf{v}$ is the bulk fluid velocity vector, $\\mathbf{J}_i$ is the diffusive mass flux vector of species $i$, and $\\dot{\\omega}_i$ is the mass production rate of species $i$ due to chemical reactions.\n\nThe problem states several simplifying assumptions, which we apply sequentially:\n1.  The mixture is quiescent, so bulk convection is negligible. This implies $\\mathbf{v} = \\mathbf{0}$.\n2.  The process is non-reacting, so the mass production rate is zero: $\\dot{\\omega}_i = 0$.\n3.  The diffusion is one-dimensional along the coordinate $x$, so the divergence operator simplifies: $\\nabla \\cdot \\rightarrow \\frac{\\partial}{\\partial x}$.\n4.  The total mass density $\\rho$ is uniform and constant.\n\nApplying these assumptions to the general conservation equation yields:\n$$\n\\frac{\\partial (\\rho Y_i)}{\\partial t} = -\\frac{\\partial J_{i,x}}{\\partial x}\n$$\nSince $\\rho$ is constant, it can be factored out of the time derivative:\n$$\n\\rho \\frac{\\partial Y_i}{\\partial t} = -\\frac{\\partial J_{i,x}}{\\partial x} \\implies \\frac{\\partial Y_i}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial J_{i,x}}{\\partial x}\n$$\nThe problem specifies a binary mixture of hydrogen ($\\text{H}_2$) and nitrogen ($\\text{N}_2$). For such a mixture, the diffusive flux can be modeled by Fick's first law, which is a simplification of the Maxwell-Stefan equations under these conditions. The mass flux of species $i$ relative to the mass-averaged velocity (which is zero here) is given by:\n$$\n\\mathbf{J}_i = -\\rho D_{ij} \\nabla Y_i\n$$\nFor the one-dimensional diffusion of hydrogen ($\\text{H}_2$) into nitrogen ($\\text{N}_2$), we write the flux component $J_{\\text{H_2},x}$ as:\n$$\nJ_{\\text{H_2},x} = -\\rho D_{\\text{H_2,N_2}} \\frac{\\partial Y_{\\text{H_2}}}{\\partial x}\n$$\nwhere $D_{\\text{H_2,N_2}}$ is the binary diffusion coefficient.\n\nSubstituting this constitutive relation for the flux into the simplified conservation equation gives:\n$$\n\\frac{\\partial Y_{\\text{H_2}}}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial}{\\partial x} \\left( -\\rho D_{\\text{H_2,N_2}} \\frac{\\partial Y_{\\text{H_2}}}{\\partial x} \\right)\n$$\nThe problem further assumes that the diffusion coefficient $D_{\\text{H_2,N_2}}$ is constant. With both $\\rho$ and $D_{\\text{H_2,N_2}}$ being constants, they can be moved outside the spatial derivative:\n$$\n\\frac{\\partial Y_{\\text{H_2}}}{\\partial t} = \\frac{\\rho D_{\\text{H_2,N_2}}}{\\rho} \\frac{\\partial^2 Y_{\\text{H_2}}}{\\partial x^2}\n$$\nThis simplifies to the one-dimensional linear diffusion equation:\n$$\n\\frac{\\partial Y_{\\text{H_2}}}{\\partial t} = D_{\\text{H_2,N_2}} \\frac{\\partial^2 Y_{\\text{H_2}}}{\\partial x^2}\n$$\nLetting $Y(x,t)$ denote $Y_{\\text{H_2}}(x,t)$ and $D$ denote $D_{\\text{H_2,N_2}}$, we have the final partial differential equation (PDE) to be solved.\n\n**2. Analytical Solution**\n\nThe problem is defined on $x \\in [0, L]$ with boundary conditions $Y(0,t)=Y_s$ and $Y(L,t)=0$, and initial condition $Y(x,0)=0$. The problem states that for the times of interest, the finite domain approximates a semi-infinite half-space ($x \\in [0, \\infty)$). For this semi-infinite case with boundary conditions $Y(0,t)=Y_s$ and $\\lim_{x\\to\\infty} Y(x,t)=0$, the analytical solution to the diffusion equation is given by:\n$$\nY_{\\text{analytical}}(x,t) = Y_s \\cdot \\text{erfc}\\left( \\frac{x}{2\\sqrt{Dt}} \\right)\n$$\nwhere $\\text{erfc}(z)$ is the complementary error function, defined as $\\text{erfc}(z) = 1 - \\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_z^\\infty e^{-\\xi^2} d\\xi$. This solution will serve as the reference against which the numerical result is validated. The approximation is valid as long as the diffusion length, proportional to $\\sqrt{Dt}$, is significantly smaller than the domain length $L$, ensuring $Y(L,t) \\approx 0$.\n\n**3. Numerical Scheme: Explicit Finite-Difference Method**\n\nWe discretize the domain in space and time. A uniform spatial grid is defined by points $x_j = j \\cdot \\Delta x$ for $j=0, 1, \\dots, N_x-1$, where the grid spacing is $\\Delta x = L / (N_x - 1)$. Time is discretized into steps $t_n = n \\cdot \\Delta t$. We denote the numerical approximation of $Y(x_j, t_n)$ as $Y_j^n$.\n\nThe PDE is approximated using finite differences:\n- The time derivative is approximated with a first-order forward difference: $\\frac{\\partial Y}{\\partial t} \\approx \\frac{Y_j^{n+1} - Y_j^n}{\\Delta t}$.\n- The spatial second derivative is approximated with a second-order central difference: $\\frac{\\partial^2 Y}{\\partial x^2} \\approx \\frac{Y_{j+1}^n - 2Y_j^n + Y_{j-1}^n}{\\Delta x^2}$.\n\nSubstituting these into the PDE gives the Forward-Time Central-Space (FTCS) scheme:\n$$\n\\frac{Y_j^{n+1} - Y_j^n}{\\Delta t} = D \\left( \\frac{Y_{j+1}^n - 2Y_j^n + Y_{j-1}^n}{\\Delta x^2} \\right)\n$$\nSolving for $Y_j^{n+1}$ gives the explicit update rule for the interior grid points ($j=1, \\dots, N_x-2$):\n$$\nY_j^{n+1} = Y_j^n + \\alpha \\left( Y_{j+1}^n - 2Y_j^n + Y_{j-1}^n \\right)\n$$\nwhere $\\alpha = \\frac{D \\Delta t}{\\Delta x^2}$ is the dimensionless diffusion number.\n\nThe FTCS scheme is only conditionally stable. Stability requires $\\alpha \\le \\frac{1}{2}$, which imposes a constraint on the time step: $\\Delta t \\le \\frac{\\Delta x^2}{2D}$. The problem defines $\\Delta t_{\\max} = \\frac{\\Delta x^2}{2D}$ and specifies the time step as $\\Delta t = r \\cdot \\Delta t_{\\max}$ with a stability ratio factor $r < 1$ (e.g., $r=0.4$ or $r=0.49$). This gives a diffusion number $\\alpha = \\frac{D (r \\cdot \\Delta x^2 / (2D))}{\\Delta x^2} = \\frac{r}{2}$. Since $r<1$, the stability condition $\\alpha < 1/2$ is always satisfied.\n\n**4. Algorithmic Implementation**\n\nThe numerical solution is computed as follows:\n1.  For each test case, the parameters $D, L, N_x, Y_s, t_{\\text{end}}, r$ are specified.\n2.  The spatial grid spacing $\\Delta x = L / (N_x - 1)$ and the time step $\\Delta t = r \\frac{\\Delta x^2}{2D}$ are calculated.\n3.  The total number of time steps is determined by $N_t = \\lceil t_{\\text{end}} / \\Delta t \\rceil$ to ensure the simulation runs up to or slightly beyond $t_{\\text{end}}$. The final time of the numerical simulation is $t_{\\text{final}} = N_t \\Delta t$.\n4.  A one-dimensional array `Y` of size $N_x$ is initialized to represent the mass fraction profile. The initial condition $Y(x,0)=0$ for $x>0$ and $Y(0,t)=Y_s$ for $t \\ge 0$ is imposed by setting $Y_0 = Y_s$ and $Y_j=0$ for $j > 0$. The far-field boundary condition is $Y_{N_x-1}=0$.\n5.  A time-stepping loop iterates $N_t$ times. In each iteration, the values of `Y` at the next time step are computed from the values at the current time step using the FTCS update rule. This is performed efficiently using vectorized array operations on the interior points. The boundary values at $j=0$ and $j=N_x-1$ remain fixed throughout the simulation.\n6.  After the loop completes, the array `Y` contains the numerical solution $Y_{\\text{numerical}}(x_j)$ at time $t_{\\text{final}}$.\n7.  The analytical solution $Y_{\\text{analytical}}(x_j)$ is computed at each grid point $x_j$ at the same final time $t_{\\text{final}}$ for a consistent comparison.\n8.  The Root-Mean-Square Error (RMSE) is calculated between the numerical and analytical solutions:\n$$\n\\text{RMSE} = \\sqrt{ \\frac{1}{N_x} \\sum_{j=0}^{N_x-1} \\left( Y_{\\text{numerical}}(x_j) - Y_{\\text{analytical}}(x_j) \\right)^2 }\n$$\nThis procedure is repeated for each test case provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Solves the 1D diffusion equation for H2 in N2 using an explicit\n    finite-difference scheme and validates it against the analytical solution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (D, L, Nx, Ys, t_end, r)\n    # D: Diffusion coefficient (m^2/s)\n    # L: Domain length (m)\n    # Nx: Number of grid points\n    # Ys: Hydrogen mass fraction at x=0\n    # t_end: Final simulation time (s)\n    # r: Stability ratio factor for time step calculation\n    test_cases = [\n        # Case A: general case\n        (7.8e-5, 0.05, 201, 0.1, 0.2, 0.4),\n        # Case B: early-time boundary layer\n        (7.8e-5, 0.05, 201, 0.1, 0.005, 0.4),\n        # Case C: near-stability explicit time step\n        (7.8e-5, 0.05, 201, 0.1, 0.1, 0.49),\n        # Case D: coarse spatial resolution\n        (7.8e-5, 0.05, 51, 0.1, 0.2, 0.4),\n        # Case E: different imposed mass fraction\n        (7.8e-5, 0.05, 201, 0.05, 0.2, 0.4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        D, L, Nx, Ys, t_end, r = case\n\n        # --- 1. Grid and Time Step Setup ---\n        # Spatial grid\n        x = np.linspace(0, L, Nx)\n        dx = L / (Nx - 1)\n\n        # Time step calculation based on stability criteria\n        # The stability limit for FTCS is dt <= dx^2 / (2*D).\n        # We use a factor r to stay safely below this limit.\n        dt_max = 0.5 * dx**2 / D\n        dt = r * dt_max\n        \n        # Diffusion number alpha = D * dt / dx^2\n        alpha = D * dt / dx**2\n\n        # Number of time steps to reach or exceed t_end\n        num_steps = int(np.ceil(t_end / dt))\n        final_t = num_steps * dt\n\n        # --- 2. Initialization ---\n        # Initialize mass fraction array Y\n        # IC: Y(x, 0) = 0 for x > 0\n        # BC: Y(0, t) = Ys is applied at t=0\n        Y = np.zeros(Nx)\n        Y[0] = Ys\n        # BC: Y(L, t) = 0 is implicitly handled by Y[-1] = 0\n\n        # --- 3. Time Marching Loop (Numerical Solution) ---\n        for _ in range(num_steps):\n            # Use a copy of Y to compute the next step, ensuring an explicit scheme\n            Y_old = Y.copy()\n            # Update interior points using a vectorized FTCS scheme\n            # Y_new[j] = Y_old[j] + alpha * (Y_old[j+1] - 2*Y_old[j] + Y_old[j-1])\n            Y[1:-1] = Y_old[1:-1] + alpha * (Y_old[2:] - 2*Y_old[1:-1] + Y_old[:-2])\n            # Boundary conditions are Dirichlet, so Y[0] and Y[-1] are not updated.\n            # They were set at initialization and remain fixed.\n\n        # At this point, Y is the numerical solution at time final_t\n\n        # --- 4. Analytical Solution ---\n        # The analytical solution for a semi-infinite domain is Ys * erfc(x / (2*sqrt(D*t)))\n        # We evaluate it at the final numerical time for a consistent comparison.\n        # To avoid division by zero if final_t is zero, add a small epsilon.\n        # In this problem, t_end > 0, so final_t will also be > 0.\n        denominator = 2.0 * np.sqrt(D * final_t)\n        # Handle the case x=0, t>0, where the argument is 0. erfc(0)=1.\n        # np.divide handles x/0 correctly for our purposes.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            arg = x / denominator\n        \n        # When x=0 and t>0, arg=0. When x>0 and t->0, arg->inf.\n        # erfc(0) = 1, erfc(inf) = 0.\n        # A special case for t=0 is Y=Ys at x=0 and Y=0 elsewhere.\n        # Our final_t is always > 0.\n        Y_analytical = Ys * erfc(arg)\n\n        # --- 5. Error Calculation ---\n        # Calculate Root-Mean-Square Error (RMSE) between numerical and analytical solutions\n        rmse = np.sqrt(np.mean((Y - Y_analytical)**2))\n        results.append(rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.10f}' for res in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In combustion and other reacting flows, the rate at which chemical species diffuse is often different from the rate at which heat diffuses. This practice introduces the Lewis number ($Le$), a critical dimensionless parameter that quantifies this phenomenon of differential diffusion. By implementing physically-based, temperature-dependent correlations for transport properties, you will compute the Lewis numbers for key species like $\\text{H}_2$ and $\\text{CO}_2$ and analyze how their deviation from unity can significantly impact flame structure and behavior. ",
            "id": "4043160",
            "problem": "Consider a one-dimensional, steady premixed hydrogen–air flame in the reaction zone where temperature varies monotonically with position. Assume each species obeys Fickian transport and the mixture obeys Fourier heat conduction. Starting from the following fundamental bases and core definitions:\n- Fourier's law of heat conduction: $q = -k \\, \\partial T/\\partial x$, where $q$ is the heat flux, $k$ is the thermal conductivity, $T$ is temperature, and $x$ is spatial coordinate.\n- Fick's first law of diffusion: $J_i = -\\rho \\, D_i \\, \\partial Y_i/\\partial x$, where $J_i$ is the diffusive mass flux of species $i$, $\\rho$ is the mass density, $D_i$ is the mass diffusivity of species $i$, and $Y_i$ is the mass fraction of species $i$.\n- Thermal diffusivity: $\\alpha = k/(\\rho \\, c_p)$, where $c_p$ is the mixture specific heat at constant pressure.\n- Lewis number of species $i$: $Le_i = \\alpha/D_i$.\n\nAssume an ideal gas mixture with constant mixture molar mass and temperature-dependent properties approximated by well-tested correlations:\n- Ideal gas law: $\\rho(T,p) = p/(R_m \\, T)$, with $R_m = R_u/M_{\\mathrm{mix}}$, where $R_u$ is the universal gas constant and $M_{\\mathrm{mix}}$ is the mixture molar mass.\n- Thermal conductivity correlation: $k(T) = k_0 \\left(T/T_0\\right)^{0.9}$.\n- Specific heat correlation: $c_p(T) = c_{p0} + b \\left(T - T_0\\right)$.\n- Mixture-averaged mass diffusivity correlation (Chapman–Enskog scaling): $D_i(T,p) = D_{i0} \\left(T/T_0\\right)^{1.75} \\left(p_0/p\\right)$.\n\nUse the following constants and reference values:\n- $R_u = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$,\n- $M_{\\mathrm{mix}} = 0.02897 \\ \\mathrm{kg/mol}$ (air-like mixture),\n- $R_m = R_u/M_{\\mathrm{mix}}$,\n- $T_0 = 300 \\ \\mathrm{K}$,\n- $p_0 = 101325 \\ \\mathrm{Pa}$,\n- $k_0 = 0.026 \\ \\mathrm{W/(m \\cdot K)}$,\n- $c_{p0} = 1007 \\ \\mathrm{J/(kg \\cdot K)}$,\n- $b = 0.2 \\ \\mathrm{J/(kg \\cdot K^2)}$,\n- $D_{\\text{H}_2,0} = 6.3 \\times 10^{-5} \\ \\mathrm{m^2/s}$,\n- $D_{\\text{CO}_2,0} = 1.6 \\times 10^{-5} \\ \\mathrm{m^2/s}$.\n\nDefine the diffusion–thermal skew ratio as\n$$s_i(T) = \\sqrt{\\frac{D_i(T,p)}{\\alpha(T,p)}} = \\sqrt{\\frac{1}{Le_i(T,p)}},$$\nwhich compares the diffusion length scales of heat and species in a parabolic-diffusion sense.\n\nYour task is to compute the temperature-dependent Lewis numbers $Le_{\\text{H}_2}(T)$ and $Le_{\\text{CO}_2}(T)$ across specified temperature grids and pressures, and to quantify how non-unity Lewis numbers skew temperature and species profiles through the ratio $s_i(T)$. Express all physical inputs in the specified SI units: $T$ in $\\mathrm{K}$, $p$ in $\\mathrm{Pa}$, $k$ in $\\mathrm{W/(m \\cdot K)}$, $c_p$ in $\\mathrm{J/(kg \\cdot K)}$, $\\rho$ in $\\mathrm{kg/m^3}$, and $D_i$ in $\\mathrm{m^2/s}$. The outputs $Le_i$ and $s_i$ are dimensionless.\n\nFor each test case, compute and return:\n1. The list of $Le_{\\text{H}_2}(T)$ values for the given temperature grid and pressure.\n2. The list of $Le_{\\text{CO}_2}(T)$ values for the given temperature grid and pressure.\n3. The list of $s_{\\text{H}_2}(T)$ values for the given temperature grid and pressure.\n4. The list of $s_{\\text{CO}_2}(T)$ values for the given temperature grid and pressure.\n5. The average (arithmetic mean) of $Le_{\\text{H}_2}(T)$ across the temperature grid as a single float.\n6. The average (arithmetic mean) of $Le_{\\text{CO}_2}(T)$ across the temperature grid as a single float.\n7. A boolean indicating whether $| \\overline{Le}_{\\text{H_2}} - 1 | \\ge 0.2$.\n8. A boolean indicating whether $| \\overline{Le}_{\\text{CO}_2} - 1 | \\ge 0.2$.\n\nTest suite:\n- Case A (typical near-atmospheric flame): $p = 101325 \\ \\mathrm{Pa}$, $T$ grid $[300, 800, 1200, 1800, 2200] \\ \\mathrm{K}$.\n- Case B (low-pressure edge): $p = 20265 \\ \\mathrm{Pa}$, $T$ grid $[300, 800, 1200, 1800, 2200] \\ \\mathrm{K}$.\n- Case C (elevated-pressure edge): $p = 506625 \\ \\mathrm{Pa}$, $T$ grid $[300, 800, 1200, 1800, 2200] \\ \\mathrm{K}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the order specified above. For example, the output format is\n$[ \\text{caseA\\_result}, \\text{caseB\\_result}, \\text{caseC\\_result} ]$,\nwith each $\\text{caseX\\_result}$ being a list of lists and floats and booleans in the strict order $1$–$8$ described above.",
            "solution": "The problem requires the calculation of temperature-dependent Lewis numbers, $Le_i(T)$, and diffusion–thermal skew ratios, $s_i(T)$, for hydrogen ($i=\\text{H_2}$) and carbon dioxide ($i=\\text{CO_2}$) within a premixed flame context. The calculations are to be performed for three different pressure conditions over a specified temperature grid.\n\nThe solution proceeds by first deriving a simplified analytical expression for the Lewis number based on the provided physical laws and empirical correlations. This is followed by the computational implementation of this expression.\n\nThe Lewis number for a species $i$ is defined as the ratio of the thermal diffusivity of the mixture, $\\alpha$, to the mass diffusivity of the species, $D_i$:\n$$Le_i = \\frac{\\alpha}{D_i}$$\nThe thermal diffusivity is given by $\\alpha = k/(\\rho c_p)$, where $k$ is the thermal conductivity, $\\rho$ is the mass density, and $c_p$ is the specific heat at constant pressure. Substituting this into the Lewis number definition gives:\n$$Le_i(T, p) = \\frac{k(T)}{\\rho(T, p) c_p(T) D_i(T, p)}$$\nThe problem provides the following temperature- and pressure-dependent correlations for the transport and thermodynamic properties:\n1.  Thermal conductivity: $k(T) = k_0 \\left(\\frac{T}{T_0}\\right)^{0.9}$\n2.  Specific heat: $c_p(T) = c_{p0} + b(T - T_0)$\n3.  Mass density (from ideal gas law): $\\rho(T, p) = \\frac{p}{R_m T}$\n4.  Mass diffusivity: $D_i(T, p) = D_{i0} \\left(\\frac{T}{T_0}\\right)^{1.75} \\left(\\frac{p_0}{p}\\right)$\n\nLet us substitute these expressions into the equation for $Le_i(T, p)$:\n$$Le_i(T, p) = \\frac{k_0 \\left(\\frac{T}{T_0}\\right)^{0.9}}{\\left(\\frac{p}{R_m T}\\right) \\left(c_{p0} + b(T-T_0)\\right) \\left(D_{i0} \\left(\\frac{T}{T_0}\\right)^{1.75} \\left(\\frac{p_0}{p}\\right)\\right)}$$\nWe can rearrange and group the terms to analyze the dependencies:\n$$Le_i(T, p) = \\frac{k_0 R_m T \\left(\\frac{T}{T_0}\\right)^{0.9}}{p \\left(c_{p0} + b(T-T_0)\\right)} \\cdot \\frac{1}{D_{i0} \\left(\\frac{T}{T_0}\\right)^{1.75} \\left(\\frac{p_0}{p}\\right)}$$\n$$Le_i(T, p) = \\left( \\frac{k_0 R_m}{D_{i0} p_0} \\right) \\left( \\frac{p}{p} \\right) \\frac{T \\left(\\frac{T}{T_0}\\right)^{0.9}}{\\left(c_{p0} + b(T-T_0)\\right) \\left(\\frac{T}{T_0}\\right)^{1.75}}$$\nA critical observation here is that the pressure term, $p$, cancels out. This means that for the specific set of correlations provided (which are standard approximations in combustion theory), the Lewis number is independent of pressure, i.e., $Le_i(T, p) = Le_i(T)$. Consequently, the calculations for all three test cases (Case A, B, and C), which differ only by pressure, will yield identical results.\n\nWe can further simplify the pressure-independent expression for $Le_i(T)$:\n$$Le_i(T) = \\left( \\frac{k_0 R_m}{p_0 D_{i0}} \\right) \\frac{T \\cdot T^{0.9} \\cdot T_0^{-0.9}}{(c_{p0} + b(T-T_0)) \\cdot T^{1.75} \\cdot T_0^{-1.75}}$$\nCombining the powers of $T$ and $T_0$:\n$$Le_i(T) = \\left( \\frac{k_0 R_m T_0^{1.75 - 0.9}}{p_0 D_{i0}} \\right) \\frac{T^{1 + 0.9 - 1.75}}{c_{p0} + b(T-T_0)}$$\n$$Le_i(T) = \\left( \\frac{k_0 R_m T_0^{0.85}}{p_0 D_{i0}} \\right) \\frac{T^{0.15}}{c_{p0} + b(T-T_0)}$$\nThis final expression is a function of temperature $T$ only. The term in the parentheses is a constant for each species $i$.\n\nThe diffusion-thermal skew ratio, $s_i(T)$, is then computed directly from the Lewis number:\n$$s_i(T) = \\sqrt{\\frac{1}{Le_i(T)}} = \\frac{1}{\\sqrt{Le_i(T)}}$$\n\nThe computational procedure involves the following steps for each test case:\n1.  Initialize empty lists to store the computed values for each of the $5$ temperatures in the grid.\n2.  Iterate through each temperature $T$ in the provided grid: $[300, 800, 1200, 1800, 2200] \\ \\mathrm{K}$.\n3.  For each species $i \\in \\{\\text{H_2}, \\text{CO_2}\\}$, calculate $Le_i(T)$ using the derived pressure-independent formula and the given constants:\n    - $R_u = 8.314 \\ \\mathrm{J/(mol \\cdot K)}$, $M_{\\mathrm{mix}} = 0.02897 \\ \\mathrm{kg/mol}$, so $R_m = R_u/M_{\\mathrm{mix}} \\approx 287.0 \\ \\mathrm{J/(kg \\cdot K)}$.\n    - $T_0 = 300 \\ \\mathrm{K}$, $p_0 = 101325 \\ \\mathrm{Pa}$, $k_0 = 0.026 \\ \\mathrm{W/(m \\cdot K)}$.\n    - $c_{p0} = 1007 \\ \\mathrm{J/(kg \\cdot K)}$, $b = 0.2 \\ \\mathrm{J/(kg \\cdot K^2)}$.\n    - $D_{\\text{H_2},0} = 6.3 \\times 10^{-5} \\ \\mathrm{m^2/s}$, $D_{\\text{CO_2},0} = 1.6 \\times 10^{-5} \\ \\mathrm{m^2/s}$.\n4.  Calculate the corresponding skew ratio $s_i(T)$.\n5.  Append the calculated $Le_i(T)$ and $s_i(T)$ values to their respective lists.\n6.  After iterating through all temperatures, calculate the arithmetic mean of the values in the $Le_{\\text{H_2}}(T)$ and $Le_{\\text{CO_2}}(T)$ lists.\n7.  Evaluate the boolean conditions $| \\overline{Le}_{\\text{H_2}} - 1 | \\ge 0.2$ and $| \\overline{Le}_{\\text{CO_2}} - 1 | \\ge 0.2$.\n8.  Assemble the eight required outputs (four lists, two floats, two booleans) into a single result list for the case.\n\nSince $Le_i$ and $s_i$ are pressure-independent, the final result list will be identical for Case A, B, and C.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes temperature-dependent Lewis numbers and related quantities\n    for H2 and CO2 based on provided transport property correlations.\n    \"\"\"\n\n    # Define physical constants and reference values\n    R_u = 8.314  # Universal gas constant, J/(mol.K)\n    M_mix = 0.02897  # Mixture molar mass, kg/mol\n    R_m = R_u / M_mix  # Specific gas constant for the mixture, J/(kg.K)\n\n    T0 = 300.0  # Reference temperature, K\n    p0 = 101325.0  # Reference pressure, Pa\n\n    k0 = 0.026  # Reference thermal conductivity, W/(m.K)\n    c_p0 = 1007.0  # Reference specific heat, J/(kg.K)\n    b = 0.2  # Temperature coefficient for specific heat, J/(kg.K^2)\n\n    D_H2_0 = 6.3e-5  # Reference mass diffusivity of H2, m^2/s\n    D_CO2_0 = 1.6e-5  # Reference mass diffusivity of CO2, m^2/s\n\n    def compute_for_case(p, T_grid):\n        \"\"\"\n        Performs the calculation for a single test case (pressure and T grid).\n        \"\"\"\n        Le_H2_list = []\n        Le_CO2_list = []\n        s_H2_list = []\n        s_CO2_list = []\n\n        # Pre-calculate constant factors for Lewis number calculation.\n        # As derived in the solution, Lewis number is pressure-independent for these correlations.\n        # Le_i(T) = C_i * T**0.15 / (c_p0 + b * (T - T0))\n        # C_i = (k0 * R_m * T0**0.85) / (p0 * D_i0)\n        \n        C_H2_num_factor = (k0 * R_m * T0**0.85) / (p0 * D_H2_0)\n        C_CO2_num_factor = (k0 * R_m * T0**0.85) / (p0 * D_CO2_0)\n\n        for T in T_grid:\n            # Although pressure p is passed, the calculation for Le is independent of it.\n            # We use the simplified, pressure-independent formula derived in the solution.\n            \n            c_p_T = c_p0 + b * (T - T0)\n            T_pow_015 = T**0.15\n\n            # Calculate Lewis numbers for H2 and CO2\n            Le_H2 = C_H2_num_factor * T_pow_015 / c_p_T\n            Le_CO2 = C_CO2_num_factor * T_pow_015 / c_p_T\n\n            # Calculate diffusion-thermal skew ratios\n            s_H2 = 1.0 / np.sqrt(Le_H2)\n            s_CO2 = 1.0 / np.sqrt(Le_CO2)\n\n            Le_H2_list.append(Le_H2)\n            Le_CO2_list.append(Le_CO2)\n            s_H2_list.append(s_H2)\n            s_CO2_list.append(s_CO2)\n\n        # Calculate average Lewis numbers\n        avg_Le_H2 = np.mean(Le_H2_list)\n        avg_Le_CO2 = np.mean(Le_CO2_list)\n\n        # Perform boolean checks for significant deviation from unity\n        is_H2_skewed = abs(avg_Le_H2 - 1.0) >= 0.2\n        is_CO2_skewed = abs(avg_Le_CO2 - 1.0) >= 0.2\n\n        return [\n            Le_H2_list,\n            Le_CO2_list,\n            s_H2_list,\n            s_CO2_list,\n            avg_Le_H2,\n            avg_Le_CO2,\n            is_H2_skewed,\n            is_CO2_skewed,\n        ]\n\n    # Define the test cases from the problem statement.\n    T_grid = [300.0, 800.0, 1200.0, 1800.0, 2200.0]\n    test_cases = [\n        (101325.0, T_grid),  # Case A\n        (20265.0, T_grid),   # Case B\n        (506625.0, T_grid),  # Case C\n    ]\n\n    results = []\n    for p, T_grid_case in test_cases:\n        case_result = compute_for_case(p, T_grid_case)\n        results.append(case_result)\n\n    # Format the final output string as specified\n    # The default str() representation for lists and booleans is used.\n    # The join method creates the comma-separated list of case results.\n    # The f-string adds the outer brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # Python's str() adds spaces. To create a compact representation,\n    # we can remove spaces after commas and colons.\n    output_str = output_str.replace(\", \", \",\")\n    output_str = output_str.replace(\": \", \":\")\n    \n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "While Fick's law provides a useful approximation for diffusive flux, a more fundamental description is found in the Maxwell-Stefan equations, which account for multicomponent interactions more rigorously. This practice challenges you to work with the Maxwell-Stefan formalism to isolate and quantify a diffusion mechanism not present in simple Fickian models: baro-diffusion, the transport of species driven by a pressure gradient. You will learn to assess the relative importance of different physical driving forces in a complex, realistic combustion environment like a counterflow flame. ",
            "id": "4043171",
            "problem": "Consider a steady, isothermal segment of a compressing counterflow flame in a methane–air system where the local gas mixture can be treated as an ideal gas mixture. Take the axial coordinate to be $y$, with increasing $y$ directed from the fuel stream toward the oxidizer stream. At a particular axial location, the local mole fractions are\n$$\nx_{\\text{H_2}} = 0.04,\\quad x_{\\text{H_2O}} = 0.16,\\quad x_{\\text{CO_2}} = 0.09,\\quad x_{\\text{CO}} = 0.02,\\quad x_{\\text{N_2}} = 0.67,\\quad x_{\\text{O_2}} = 0.02,\n$$\nand the local static pressure and its gradient are\n$$\np = 3.03975 \\times 10^{5}\\ \\mathrm{Pa},\\quad \\frac{\\partial p}{\\partial y} = 1.000 \\times 10^{5}\\ \\mathrm{Pa/m}.\n$$\nThe hydrogen mole fraction has an axial gradient\n$$\n\\frac{\\partial x_{\\text{H_2}}}{\\partial y} = -25\\ \\mathrm{m}^{-1}.\n$$\nAssume the temperature is spatially uniform so that thermal diffusion (also called the Soret effect) can be neglected. No external body forces other than those implied by the hydrodynamics are present. The molecular weights are\n$$\nM_{\\text{H_2}} = 2,\\ M_{\\text{H_2O}} = 18,\\ M_{\\text{CO_2}} = 44,\\ M_{\\text{CO}} = 28,\\ M_{\\text{N_2}} = 28,\\ M_{\\text{O_2}} = 32\\ \\mathrm{g/mol}.\n$$\n\nStarting from the Maxwell–Stefan description of multicomponent diffusion for ideal gas mixtures and working in the mass-average frame, derive the form of the diffusion driving force for species $\\text{H}_2$ that separates the contribution due to the concentration gradient from the contribution due to the pressure gradient (baro-diffusion). Using these fundamentals, compute the dimensionless ratio of the magnitude of the baro-diffusion contribution to the magnitude of the concentration-diffusion contribution for species $\\text{H}_2$ at the specified location. Express your final answer as a decimal number rounded to four significant figures, with no units.",
            "solution": "The problem requires the derivation of the diffusion driving force for species $\\text{H}_2$ from the Maxwell–Stefan equations and the subsequent calculation of the ratio of the baro-diffusion contribution to the concentration-diffusion contribution. The system is a steady, isothermal, one-dimensional counterflow flame.\n\nThe Maxwell–Stefan multicomponent diffusion formalism provides the fundamental relationship between the forces acting on species in a mixture and the resulting relative motion between them. For an ideal gas mixture, neglecting external body forces and thermal diffusion (Soret effect) as specified, the generalized diffusion driving force for species $i$, denoted $\\mathbf{d}_i$, is given by the expression:\n$$\n\\mathbf{d}_i = \\nabla x_i + (x_i - Y_i) \\frac{\\nabla p}{p}\n$$\nHere, $x_i$ is the mole fraction of species $i$, $Y_i$ is its mass fraction, $p$ is the static pressure, and $\\nabla$ is the gradient operator. This vector $\\mathbf{d}_i$ represents the net thermodynamic force per mole of mixture that drives the diffusion of species $i$. This force is balanced by the frictional drag exerted by other species in the mixture.\n\nThe problem specifies a one-dimensional system with the axial coordinate denoted by $y$. Therefore, the gradient operator simplifies to $\\nabla = \\frac{d}{dy}\\hat{\\mathbf{y}}$, where $\\hat{\\mathbf{y}}$ is the unit vector in the $y$-direction. The scalar driving force component for species $\\text{H_2}$ in the $y$-direction, $d_{\\text{H_2}}$, is:\n$$\nd_{\\text{H_2}} = \\frac{d x_{\\text{H_2}}}{dy} + (x_{\\text{H_2}} - Y_{\\text{H_2}}) \\frac{1}{p} \\frac{dp}{dy}\n$$\nThis expression separates the total driving force into two distinct physical contributions as requested by the problem:\n1. The term $F_{\\text{conc}} = \\frac{d x_{\\text{H_2}}}{dy}$ represents the driving force due to the gradient in the mole fraction of $\\text{H_2}$. This is ordinary concentration diffusion, which drives species from regions of high concentration to low concentration.\n2. The term $F_{\\text{baro}} = (x_{\\text{H_2}} - Y_{\\text{H_2}}) \\frac{1}{p} \\frac{dp}{dy}$ represents the driving force due to the pressure gradient. This phenomenon is known as baro-diffusion or pressure diffusion. It causes species to diffuse in response to a pressure gradient. The direction of this diffusion depends on the sign of the term $(x_i - Y_i)$.\n\nThe problem asks for the dimensionless ratio of the magnitude of the baro-diffusion contribution to the magnitude of the concentration-diffusion contribution for species $\\text{H}_2$. This ratio is:\n$$\n\\text{Ratio} = \\frac{|F_{\\text{baro}}|}{|F_{\\text{conc}}|} = \\frac{\\left| (x_{\\text{H_2}} - Y_{\\text{H_2}}) \\frac{1}{p} \\frac{dp}{dy} \\right|}{\\left| \\frac{d x_{\\text{H_2}}}{dy} \\right|}\n$$\nTo compute this ratio, we must first calculate the mass fraction of hydrogen, $Y_{\\text{H_2}}$. The mass fraction $Y_i$ is related to the mole fraction $x_i$ by the equation:\n$$\nY_i = \\frac{x_i M_i}{M}\n$$\nwhere $M_i$ is the molar mass of species $i$ and $M$ is the mean molar mass of the mixture, defined as $M = \\sum_j x_j M_j$.\n\nUsing the given mole fractions and molar masses (in $\\mathrm{g/mol}$):\n$x_{\\text{H_2}} = 0.04$, $M_{\\text{H_2}} = 2$\n$x_{\\text{H_2O}} = 0.16$, $M_{\\text{H_2O}} = 18$\n$x_{\\text{CO_2}} = 0.09$, $M_{\\text{CO_2}} = 44$\n$x_{\\text{CO}} = 0.02$, $M_{\\text{CO}} = 28$\n$x_{\\text{N_2}} = 0.67$, $M_{\\text{N_2}} = 28$\n$x_{\\text{O_2}} = 0.02$, $M_{\\text{O_2}} = 32$\n\nThe mean molar mass $M$ is calculated as:\n$$\nM = (0.04)(2) + (0.16)(18) + (0.09)(44) + (0.02)(28) + (0.67)(28) + (0.02)(32)\n$$\n$$\nM = 0.08 + 2.88 + 3.96 + 0.56 + 18.76 + 0.64 = 26.88\\ \\mathrm{g/mol}\n$$\nNow, we can calculate the mass fraction of hydrogen, $Y_{\\text{H_2}}$:\n$$\nY_{\\text{H_2}} = \\frac{x_{\\text{H_2}} M_{\\text{H_2}}}{M} = \\frac{(0.04)(2)}{26.88} = \\frac{0.08}{26.88}\n$$\nThe term $(x_{\\text{H_2}} - Y_{\\text{H_2}})$ becomes:\n$$\nx_{\\text{H_2}} - Y_{\\text{H_2}} = 0.04 - \\frac{0.08}{26.88} = \\frac{0.04 \\times 26.88 - 0.08}{26.88} = \\frac{1.0752 - 0.08}{26.88} = \\frac{0.9952}{26.88}\n$$\nWe are given the following values:\n$\\frac{d x_{\\text{H_2}}}{dy} = -25\\ \\mathrm{m}^{-1}$\n$p = 3.03975 \\times 10^{5}\\ \\mathrm{Pa}$\n$\\frac{dp}{dy} = 1.000 \\times 10^{5}\\ \\mathrm{Pa/m}$\n\nNow we substitute these values into the ratio expression.\nThe magnitude of the concentration-diffusion contribution is:\n$$\n|F_{\\text{conc}}| = \\left| \\frac{d x_{\\text{H_2}}}{dy} \\right| = |-25\\ \\mathrm{m}^{-1}| = 25\\ \\mathrm{m}^{-1}\n$$\nThe magnitude of the baro-diffusion contribution is:\n$$\n|F_{\\text{baro}}| = \\left| \\left( \\frac{0.9952}{26.88} \\right) \\frac{1}{3.03975 \\times 10^{5}} (1.000 \\times 10^{5}) \\right| = \\left( \\frac{0.9952}{26.88} \\right) \\frac{1.000}{3.03975}\\ \\mathrm{m}^{-1}\n$$\nCalculating the value of $|F_{\\text{baro}}|$:\n$$\n|F_{\\text{baro}}| = \\frac{0.9952}{26.88 \\times 3.03975} \\approx \\frac{0.9952}{81.714} \\approx 0.01217909\\ \\mathrm{m}^{-1}\n$$\nFinally, we compute the ratio:\n$$\n\\text{Ratio} = \\frac{|F_{\\text{baro}}|}{|F_{\\text{conc}}|} = \\frac{0.01217909...}{25} \\approx 0.00048716...\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\text{Ratio} \\approx 0.0004872\n$$\nThis result demonstrates that, for this specific case, the contribution of baro-diffusion to the total diffusion driving force on hydrogen is substantially smaller than the contribution from the concentration gradient.",
            "answer": "$$\n\\boxed{0.0004872}\n$$"
        }
    ]
}