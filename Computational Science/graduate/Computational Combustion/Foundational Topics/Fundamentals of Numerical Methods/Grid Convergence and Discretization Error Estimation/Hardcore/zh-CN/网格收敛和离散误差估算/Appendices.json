{
    "hands_on_practices": [
        {
            "introduction": "理论通过实践得以升华。求解离散化误差估算问题的第一步是掌握执行和解读网格收敛性研究的标准化流程。本练习将指导您完成一个完整的三套网格验证研究，这是一个任何计算流体力学（CFD）实践者的基石技能。您将从一系列模拟数据中计算出观察到的收敛阶数（$p$），估算离散化误差的网格收敛指数（GCI），并执行一致性检查，以验证解是否处于渐进收敛区间内 。",
            "id": "4029259",
            "problem": "使用一个具有二阶空间重构和时间上充分解析的化学与扩散的有限体积反应求解器，对大气压下的一维自由传播贫燃预混甲烷-空气火焰进行模拟。关注的可观测量是稳态时的层流火焰速度，记为 $S_L$。使用了三套系统加密的网格，其常数加密比为 $r$，其中网格1最粗，网格2为中等，网格3最细。网格间距分别为 $h_1 = 0.40\\,\\mathrm{mm}$、$h_2 = 0.20\\,\\mathrm{mm}$ 和 $h_3 = 0.10\\,\\mathrm{mm}$，因此加密比 $r = h_1/h_2 = h_2/h_3 = 2$。计算出的火焰速度分别为 $S_{L,1} = 0.406\\,\\mathrm{m/s}$、$S_{L,2} = 0.418\\,\\mathrm{m/s}$ 和 $S_{L,3} = 0.421\\,\\mathrm{m/s}$。假设数值方法处于网格收敛的渐近区域，并且对于一个足够光滑的标量，其离散误差 $E(h)$ 随网格间距的变化关系为 $E(h) \\sim C h^p$，其中 $C$ 是一个与网格无关的常数，$p$ 是表观精度阶数。需要使用计算流体动力学中的标准做法，为网格对 $(1,2)$ 和 $(2,3)$ 计算网格收敛指数 (GCI)，安全因子 $F_s = 1.25$。对于每对网格，使用该对中较细网格的解作为归一化量，并且两对网格使用相同的 $F_s$。\n\n仅使用这些前提和数据：\n- 从三套网格序列中确定表观阶数 $p$，\n- 计算两个 GCI 值 $\\mathrm{GCI}_{12}$ 和 $\\mathrm{GCI}_{23}$，\n- 并评估在渐近收敛条件下将比率 $\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23}$ 与 $r^p$ 进行比较的三网格一致性检验。\n\n哪个选项与给出的控制定义、渐近误差缩放关系以及数值数据最为一致？\n\nA. 表观阶数约为 $p \\approx 2.00$；GCI 值为 $\\mathrm{GCI}_{12} \\approx 1.20 \\times 10^{-2}$ 和 $\\mathrm{GCI}_{23} \\approx 2.97 \\times 10^{-3}$；比率 $\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23} \\approx 4.03$ 与 $r^p = 4$ 的差距在百分之几以内，因此一致性检验通过。\n\nB. 表观阶数约为 $p \\approx 1.00$；$\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23} \\approx 2$，这与 $r^p$ 有显著偏差，因此一致性检验失败，该格式实际上是一阶的。\n\nC. 单调性要求被违反，因为 $S_L$ 随网格加密而减小，使得一致性检验无效；因此，无法得出结论。\n\nD. 比率 $\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23}$ 强烈依赖于安全因子 $F_s$，选择 $F_s = 1.25$ 而不是 $F_s = 3$ 会改变一致性检验是否通过的结果。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n问题为一项关于计算层流火焰速度 $S_L$ 的网格收敛性研究提供了以下数据和前提：\n- **网格：** 三套系统加密的网格，标记为 1（最粗）、2（中等）和 3（最细）。\n- **网格间距：** $h_1 = 0.40\\,\\mathrm{mm}$、$h_2 = 0.20\\,\\mathrm{mm}$ 和 $h_3 = 0.10\\,\\mathrm{mm}$。\n- **加密比：** $r = h_1/h_2 = h_2/h_3 = 2$，为常数。\n- **计算解：** $S_{L,1} = 0.406\\,\\mathrm{m/s}$、$S_{L,2} = 0.418\\,\\mathrm{m/s}$ 和 $S_{L,3} = 0.421\\,\\mathrm{m/s}$。\n- **假设：**\n    1. 数值方法处于网格收敛的渐近区域。\n    2. 离散误差 $E(h)$ 的缩放关系为 $E(h) \\sim C h^p$，其中 $p$ 是表观精度阶数，$C$ 是一个常数。\n- **GCI 计算参数：**\n    1. 安全因子：$F_s = 1.25$。\n    2. 待计算的 GCI 对：$(1,2)$ 和 $(2,3)$。\n    3. 归一化：对于每对网格，使用较细网格的解作为归一化量。\n- **要求任务：**\n    1. 确定表观阶数 $p$。\n    2. 计算 $\\mathrm{GCI}_{12}$ 和 $\\mathrm{GCI}_{23}$。\n    3. 评估一致性检验：$\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23}$ vs. $r^p$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 问题描述了计算流体动力学（CFD）及相关领域中一个标准且被广泛接受的验证程序，即基于 Richardson 外推的网格收敛指数（GCI）方法。其物理背景（层流火焰速度）和数值都是合理的。\n- **适定性：** 提供了执行所需计算的所有必要数据和定义。问题是自洽且清晰的。\n- **客观性：** 语言是定量的、精确的，没有主观论断。\n\n### 步骤 3：结论与行动\n问题陈述内部一致、科学合理且适定。它是一个数值方法验证的标准练习。验证结论为 **有效**。我将继续进行求解。\n\n## 求解推导\n\n令 $\\phi_k$ 表示在网格间距为 $h_k$ 的网格 $k$ 上的解 $S_{L,k}$。给定的解为 $\\phi_1 = 0.406\\,\\mathrm{m/s}$，$\\phi_2 = 0.418\\,\\mathrm{m/s}$ 和 $\\phi_3 = 0.421\\,\\mathrm{m/s}$。\n\n### 1. 确定表观精度阶数 $p$\n\n假设解处于渐近区域，计算解 $\\phi_h$ 可以表示为关于精确解 $\\phi_{ext}$ 的展开式：\n$$ \\phi_h = \\phi_{ext} + C h^p + \\text{h.o.t.} $$\n其中 $C$ 是一个常数，'h.o.t.' 代表高阶项，在渐近区域中可以忽略。将此应用于我们的三套网格：\n$$ \\phi_1 = \\phi_{ext} + C h_1^p $$\n$$ \\phi_2 = \\phi_{ext} + C h_2^p $$\n$$ \\phi_3 = \\phi_{ext} + C h_3^p $$\n我们可以通过考虑解的差值之比来消去 $\\phi_{ext}$ 和 $C$：\n$$ \\phi_2 - \\phi_1 = C(h_2^p - h_1^p) = C( (h_1/r)^p - h_1^p ) = C h_1^p (r^{-p} - 1) $$\n$$ \\phi_3 - \\phi_2 = C(h_3^p - h_2^p) = C( (h_2/r)^p - h_2^p ) = C h_2^p (r^{-p} - 1) $$\n取这两个差值的比率：\n$$ \\frac{\\phi_3 - \\phi_2}{\\phi_2 - \\phi_1} = \\frac{C h_2^p (r^{-p} - 1)}{C h_1^p (r^{-p} - 1)} = \\left(\\frac{h_2}{h_1}\\right)^p = \\left(\\frac{1}{r}\\right)^p = r^{-p} $$\n可以解出表观阶数 $p$：\n$$ p = \\frac{\\ln\\left(\\frac{\\phi_1 - \\phi_2}{\\phi_2 - \\phi_3}\\right)}{\\ln(r)} $$\n使用给定数据：\n- $\\phi_1 - \\phi_2 = 0.406 - 0.418 = -0.012$\n- $\\phi_2 - \\phi_3 = 0.418 - 0.421 = -0.003$\n- $r = 2$\n差值之比为 $\\frac{-0.012}{-0.003} = 4$。\n将此代入 $p$ 的方程中：\n$$ r^p = 4 \\implies 2^p = 4 = 2^2 $$\n因此，表观阶数为 $p = 2$。\n\n### 2. 计算 GCI 值\n\n网格收敛指数（GCI）提供了离散误差的估计。对于一对网格（粗网格 $i$，细网格 $j$），GCI 由下式给出：\n$$ \\mathrm{GCI}_{ij} = F_s \\frac{|e_{ij}|}{r^p - 1} $$\n其中 $e_{ij}$ 是相对差。问题规定必须使用较细网格的解进行归一化。因此，对于一对粗网格 $i$ 和细网格 $j$：\n$$ e_{ij} = \\frac{\\phi_i - \\phi_j}{\\phi_j} $$\n因此，完整公式为：\n$$ \\mathrm{GCI}_{ij} = F_s \\left| \\frac{(\\phi_i - \\phi_j)/\\phi_j}{r^p - 1} \\right| $$\n\n**计算 $\\mathrm{GCI}_{12}$：**\n该对网格由网格 1（粗，i=1）和网格 2（细，j=2）组成。\n- $\\phi_1 = 0.406$\n- $\\phi_2 = 0.418$\n- $r = 2$\n- $p = 2$\n- $F_s = 1.25$\n$$ \\mathrm{GCI}_{12} = 1.25 \\times \\left| \\frac{(0.406 - 0.418) / 0.418}{2^2 - 1} \\right| = 1.25 \\times \\left| \\frac{-0.012 / 0.418}{3} \\right| $$\n$$ \\mathrm{GCI}_{12} = 1.25 \\times \\left| \\frac{-0.028708...}{3} \\right| = 1.25 \\times 0.009569... \\approx 0.01196 $$\n用科学记数法表示得到 $\\mathrm{GCI}_{12} \\approx 1.20 \\times 10^{-2}$。\n\n**计算 $\\mathrm{GCI}_{23}$：**\n该对网格由网格 2（粗，i=2）和网格 3（细，j=3）组成。\n- $\\phi_2 = 0.418$\n- $\\phi_3 = 0.421$\n- $r = 2$\n- $p = 2$\n- $F_s = 1.25$\n$$ \\mathrm{GCI}_{23} = 1.25 \\times \\left| \\frac{(0.418 - 0.421) / 0.421}{2^2 - 1} \\right| = 1.25 \\times \\left| \\frac{-0.003 / 0.421}{3} \\right| $$\n$$ \\mathrm{GCI}_{23} = 1.25 \\times \\left| \\frac{-0.007125...}{3} \\right| = 1.25 \\times 0.002375... \\approx 0.002969 $$\n用科学记数法表示得到 $\\mathrm{GCI}_{23} \\approx 2.97 \\times 10^{-3}$。\n\n### 3. 渐近区域一致性检验\n\n解处于收敛的渐近区域的一个必要条件是，两个连续网格对的 GCI 值之比应近似等于 $r^p$。具体来说，对于网格对 $(1,2)$ 和 $(2,3)$，我们应该有：\n$$ \\frac{\\mathrm{GCI}_{12}}{\\mathrm{GCI}_{23}} \\approx r^p $$\n让我们根据计算出的 GCI 值来计算这个比率：\n$$ \\frac{\\mathrm{GCI}_{12}}{\\mathrm{GCI}_{23}} \\approx \\frac{0.01196}{0.002969} \\approx 4.0286 $$\n理论值为 $r^p = 2^2 = 4$。\n计算得到的比率 $4.0286$ 与 $4$ 非常接近。百分比差异为：\n$$ \\frac{|4.0286 - 4|}{4} \\times 100\\% = \\frac{0.0286}{4} \\times 100\\% \\approx 0.715\\% $$\n这个微小的偏差证实了解对于一个二阶格式，其行为符合在渐近区域的预期。一致性检验通过。\n\n## 选项评估\n\n**选项 A：** 表观阶数约为 $p \\approx 2.00$；GCI 值为 $\\mathrm{GCI}_{12} \\approx 1.20 \\times 10^{-2}$ 和 $\\mathrm{GCI}_{23} \\approx 2.97 \\times 10^{-3}$；比率 $\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23} \\approx 4.03$ 与 $r^p = 4$ 的差距在百分之几以内，因此一致性检验通过。\n- 我们的计算得出 $p = 2.00$。这相符。\n- 我们的计算得出 $\\mathrm{GCI}_{12} \\approx 1.20 \\times 10^{-2}$。这相符。\n- 我们的计算得出 $\\mathrm{GCI}_{23} \\approx 2.97 \\times 10^{-3}$。这相符。\n- 我们的比率约为 $4.03$，远在与 $r^p = 4$ 相差百分之几的范围内。检验通过的结论是正确的。\n- **结论：正确。**\n\n**选项 B：** 表观阶数约为 $p \\approx 1.00$；$\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23} \\approx 2$，这与 $r^p$ 有显著偏差，因此一致性检验失败，该格式实际上是一阶的。\n- 我们的计算明确显示 $p = 2$，而不是 $p = 1$。前提不正确。\n- 计算出的 GCI 比率约为 $4.03$，而不是 $2$。根据数据，该陈述在事实上是不正确的。\n- **结论：不正确。**\n\n**选项 C：** 单调性要求被违反，因为 $S_L$ 随网格加密而减小，使得一致性检验无效；因此，无法得出结论。\n- 解为 $S_{L,1} = 0.406$，$S_{L,2} = 0.418$ 和 $S_{L,3} = 0.421$。随着网格加密（$h$ 减小），解 $S_L$ 是单调递增的（$0.406  0.418  0.421$）。$S_L$ 随网格加密而减小的前提在事实上是错误的。观察到了单调收敛，这是 GCI 方法的一个先决条件。\n- **结论：不正确。**\n\n**选项 D：** 比率 $\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23}$ 强烈依赖于安全因子 $F_s$，选择 $F_s = 1.25$ 而不是 $F_s = 3$ 会改变一致性检验是否通过的结果。\n- 让我们检查比率 $\\mathrm{GCI}_{12}/\\mathrm{GCI}_{23}$：\n$$ \\frac{\\mathrm{GCI}_{12}}{\\mathrm{GCI}_{23}} = \\frac{F_s \\left| \\frac{(\\phi_1 - \\phi_2)/\\phi_2}{r^p - 1} \\right|}{F_s \\left| \\frac{(\\phi_2 - \\phi_3)/\\phi_3}{r^p - 1} \\right|} = \\frac{|\\phi_1 - \\phi_2|}{|\\phi_2 - \\phi_3|} \\times \\frac{|\\phi_3|}{|\\phi_2|} $$\n- 如问题所述，只要对两个 GCI 计算使用相同的 $F_s$，安全因子 $F_s$ 就会从分子和分母中约去。因此，该比率与 $F_s$ 无关。此选项的前提是根本错误的。\n- **结论：不正确。**\n\n所有计算和分析都有力地支持了选项 A 中的陈述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了标准程序之后，理解其局限性以及如何解读偏离理想情况的结果至关重要。本练习  呈现了一个常见但具有欺骗性的场景：在粗网格上，解看似已达到“网格无关”，但实际上并未真正进入渐进收敛区间。通过分析给定的燃烧模拟数据，您将学会区分表观收敛与经过验证的收敛，并理解这种行为背后的物理原因，例如关键特征的解析度不足。",
            "id": "4029328",
            "problem": "一位研究人员使用有限体积法，对质量、动量、能量和组分的守恒方程采用名义上为二阶的格式进行空间离散化，模拟了大气条件下的一维、稳态、自由传播的预混甲烷-空气火焰。感兴趣的可观测量是层流火焰速度 $S_L$ 和最高温度 $T_{\\max}$。计算域长度为 $L=10\\,\\mathrm{mm}$。估算的反应区厚度（即组分质量分数和温度梯度最陡峭的距离）为 $\\delta_R=0.10\\,\\mathrm{mm}$。使用了包含 $N_1=100$、$N_2=200$ 和 $N_3=400$ 个控制体积的均匀网格，其网格间距分别为 $h_1=L/N_1$、$h_2=L/N_2$ 和 $h_3=L/N_3$，加密比为 $r=h_1/h_2=h_2/h_3=2$。计算得到的值为：\n$S_L(h_1)=0.40\\,\\mathrm{m/s}$，$S_L(h_2)=0.44\\,\\mathrm{m/s}$，$S_L(h_3)=0.445\\,\\mathrm{m/s}$，以及\n$T_{\\max}(h_1)=2160\\,\\mathrm{K}$，$T_{\\max}(h_2)=2185\\,\\mathrm{K}$，$T_{\\max}(h_3)=2180\\,\\mathrm{K}$。\n假设数值解在迭代意义上已完全收敛（即非线性和线性求解器的容差已收紧，使得迭代误差相对于离散误差可以忽略不计）。\n\n从第一性原理出发，考虑在渐近范围内对足够光滑解的一致离散化的标准截断误差框架：当网格间距 $h$ 相对于问题中最小的物理长度尺度足够小时，一个感兴趣的量 $u(h)$ 满足 $u(h)=u_{\\mathrm{exact}}+C h^p+\\mathcal{O}(h^{p+1})$，其中 $C$ 为某个系数，$p0$ 为方法阶数。请利用此框架和给定数据，论证网格无关性（即网格加密后解的变化很小）与已验证的网格收敛（即通过估算的观测阶和外推法证明的渐近行为）之间的区别，并解释为何在计算燃烧学中，两套网格间的微小变化本身并不意味着渐近行为。\n\n哪个选项最能正确地反映本案例的推理过程？\n\nA. 如果 $S_L$ 在两套连续网格间的相对变化低于 $1\\%$，则解既是网格无关的，也是渐近收敛的；三套网格分析是不必要的，因为 $u(h)=u_{\\mathrm{exact}}+C h^p$ 对任何 $h$ 都成立。\n\nB. 已验证的网格收敛要求通过分析至少三套具有恒定加密比 $r1$ 的系统性加密网格来证明渐近行为，估算一致的观测阶 $p$ 和一个外推值，并检查单调趋势以及迭代误差和离散误差的分离；两套网格间的微小变化可能发生在渐近范围之外，原因包括预渐近误差项的抵消、当 $h/\\delta_R\\not\\ll 1$ 时反应区的解析度不足或非单调行为，因此它们并不意味着渐近收敛。\n\nC. 具有 $h_3/\\delta_R\\approx 0.25$ 保证了渐近收敛，因为至少有四个点跨越了反应区；因此，$S_L$ 的微小变化足以断定已验证的网格收敛。\n\nD. $T_{\\max}$ 随网格加密的非单调变化必定源于建模误差，且不影响网格收敛；由于 $S_L$ 变化很小，即使 $T_{\\max}$ 发生振荡，解也是渐近的。",
            "solution": "用户提供了一个关于计算燃烧学中网格收敛性分析的问题。我将首先验证问题陈述，然后进行完整解答。\n\n### 第一步：提取给定条件\n\n-   **模拟类型：** 一维 ($1\\mathrm{D}$)、稳态、自由传播的预混甲烷-空气火焰。\n-   **条件：** 大气压力。\n-   **数值方法：** 有限体积法，空间离散化的名义精度为二阶 ($p_{\\text{nom}}=2$)。\n-   **感兴趣量 (QoI)：** 层流火焰速度 $S_L$ 和最高温度 $T_{\\max}$。\n-   **计算域长度：** $L = 10\\,\\mathrm{mm}$。\n-   **估算的反应区厚度：** $\\delta_R = 0.10\\,\\mathrm{mm}$。\n-   **网格：** 三套均匀网格，分别包含 $N_1=100$、$N_2=200$ 和 $N_3=400$ 个控制体积。\n-   **网格间距：** $h_1 = L/N_1 = 10/100 = 0.1\\,\\mathrm{mm}$；$h_2 = L/N_2 = 10/200 = 0.05\\,\\mathrm{mm}$；$h_3 = L/N_3 = 10/400 = 0.025\\,\\mathrm{mm}$。\n-   **加密比：** $r = h_1/h_2 = h_2/h_3 = 2$。\n-   **$S_L$ 的计算数据：** $S_{L,1} = S_L(h_1) = 0.40\\,\\mathrm{m/s}$；$S_{L,2} = S_L(h_2) = 0.44\\,\\mathrm{m/s}$；$S_{L,3} = S_L(h_3) = 0.445\\,\\mathrm{m/s}$。\n-   **$T_{\\max}$ 的计算数据：** $T_{\\max,1} = T_{\\max}(h_1) = 2160\\,\\mathrm{K}$；$T_{\\max,2} = T_{\\max}(h_2) = 2185\\,\\mathrm{K}$；$T_{\\max,3} = T_{\\max}(h_3) = 2180\\,\\mathrm{K}$。\n-   **假设：** 迭代误差相对于离散误差可以忽略不计。\n-   **框架：** 感兴趣量 $u(h)$ 的渐近误差模型为 $u(h) \\approx u_{\\text{exact}} + C h^p$。\n\n### 第二步：使用提取的给定条件进行验证\n\n对问题陈述的有效性进行审查。\n\n-   **科学依据：** 该场景是计算燃烧学中的一个标准测试案例。物理量（$S_L$、$T_{\\max}$、$\\delta_R$）对于化学计量的甲烷-空气火焰是符合实际的。数值方法（FVM、网格加密）和VV原理也是标准的。\n-   **适定性：** 问题提供了所有必要的数据和明确的指令，要求基于这些数据和第一性原理分析网格收敛的状态。可以遵循一条唯一的推理路线。\n-   **客观性：** 问题以客观、技术性的语言表述。\n-   **缺陷检查：**\n    1.  **科学/事实不健全：** 无。问题是健全的。\n    2.  **非形式化/不相关：** 问题与其所述主题直接相关，并且完全可以形式化。\n    3.  **不完整/矛盾：** 数据对于所要求的分析是完整且一致的。\n    4.  **不切实际/不可行：** 所有参数和结果都在所述模拟的实际范围内。\n    5.  **不适定/结构不良：** 问题结构良好。\n    6.  **伪深奥/琐碎：** 问题并非琐碎；它探讨了表观收敛（粗网格上的微小变化）与已验证的渐近收敛之间关键且常被误解的区别。所提供的数据同时显示了单调和非单调行为，是为阐明这种细微差别而精心选择的。\n    7.  **超出科学可验证性范围：** 所涉及的原理是数值分析的基石，并且完全可以验证。\n\n### 第三步：结论和行动\n\n问题陈述是**有效的**。将推导完整解答。\n\n### 基于原理的推导\n\n问题的核心是评估数值解是否处于“渐近范围”内，在该范围内，离散误差由其主导项决定，从而可以进行可靠的误差估计和外推。所提供的误差模型为 $u(h) = u_{\\text{exact}} + C h^p + \\mathcal{O}(h^{p+1})$。对于网格间距为 $h_1$、$h_2=h_1/r$ 和 $h_3=h_2/r$ 上的三个解 $u_1$、$u_2$、$u_3$，我们有：\n$u_2 - u_1 \\approx C(h_2^p - h_1^p) = C h_2^p (1 - r^p)$\n$u_3 - u_2 \\approx C(h_3^p - h_2^p) = C h_3^p (1 - r^p)$\n差值之比为 $\\frac{u_1-u_2}{u_2-u_3} \\approx \\frac{h_1^p}{h_2^p} = r^p$。这使得可以计算观测到的收敛阶 $p_{\\text{obs}}$：\n$$p_{\\text{obs}} = \\frac{\\ln\\left(\\frac{u_1-u_2}{u_2-u_3}\\right)}{\\ln(r)}$$\n要使解处于渐近范围内，我们期望 $p_{\\text{obs}} \\approx p_{\\text{nom}}$ 并且单调收敛（即差值 $u_1-u_2$ 和 $u_2-u_3$ 符号相同）。\n\n1.  **层流火焰速度 $S_L$ 的分析**\n    -   $S_{L,1} = 0.40\\,\\mathrm{m/s}$\n    -   $S_{L,2} = 0.44\\,\\mathrm{m/s}$\n    -   $S_{L,3} = 0.445\\,\\mathrm{m/s}$\n    -   加密比 $r=2$。\n    解随着网格加密单调增加。我们可以计算 $p_{\\text{obs}}$：\n    $$ p_{\\text{obs}, S_L} = \\frac{\\ln\\left(\\frac{S_{L,1}-S_{L,2}}{S_{L,2}-S_{L,3}}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{0.40 - 0.44}{0.44 - 0.445}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{-0.04}{-0.005}\\right)}{\\ln(2)} = \\frac{\\ln(8)}{\\ln(2)} = \\frac{3\\ln(2)}{\\ln(2)} = 3 $$\n    观测到的收敛阶为 $p_{\\text{obs}, S_L} = 3$。这与格式的名义阶数 $p_{\\text{nom}}=2$ 有显著差异。显著的偏差（一个典型阈值是 $|p_{\\text{obs}} - p_{\\text{nom}}| > 0.5$）是解*不*在渐近范围内的强烈指标。高阶误差项尚不可忽略，观测到的行为很可能是由于误差的偶然抵消造成的。\n\n2.  **最高温度 $T_{\\max}$ 的分析**\n    -   $T_{\\max,1} = 2160\\,\\mathrm{K}$\n    -   $T_{\\max,2} = 2185\\,\\mathrm{K}$\n    -   $T_{\\max,3} = 2180\\,\\mathrm{K}$\n    从网格1到2的变化是 $T_{\\max,2} - T_{\\max,1} = 25\\,\\mathrm{K}$。从网格2到3的变化是 $T_{\\max,3} - T_{\\max,2} = -5\\,\\mathrm{K}$。解不随网格加密单调变化。这是一个明确的迹象，表明 $T_{\\max}$ 的解*不*在渐近范围内。$p_{\\text{obs}}$ 的公式无法应用，因为它需要对一个负数取对数。\n\n3.  **物理分辨率分析**\n    问题指明了火焰的反应区厚度为 $\\delta_R = 0.10\\,\\mathrm{mm}$。网格间距为 $h_1 = 0.1\\,\\mathrm{mm}$，$h_2 = 0.05\\,\\mathrm{mm}$，和 $h_3 = 0.025\\,\\mathrm{mm}$。我们可以评估解析此关键物理尺度的网格单元数：\n    -   网格1：$\\delta_R/h_1 = (0.10\\,\\mathrm{mm}) / (0.1\\,\\mathrm{mm}) = 1$ 个单元格。严重解析不足。\n    -   网格2：$\\delta_R/h_2 = (0.10\\,\\mathrm{mm}) / (0.05\\,\\mathrm{mm}) = 2$ 个单元格。严重解析不足。\n    -   网格3：$\\delta_R/h_3 = (0.10\\,\\mathrm{mm}) / (0.025\\,\\mathrm{mm}) = 4$ 个单元格。充其量是勉强解析。\n    对于像燃烧这样具有强非线性的问题，通常引用10-20个单元格作为开始接近渐近范围的最低要求。缺乏足够的分辨率是数值结果中观测到非渐近行为的根本物理原因。\n\n**推导结论：** 在两套最密网格之间 $S_L$ 的微小变化（$|S_{L,3}-S_{L,2}|/S_{L,2} \\approx 1.1\\%$）是具有误导性的。这种现象通常被称为“表观收敛”或“网格无关性”，但并不构成已验证的网格收敛。使用三套网格的严格分析表明，两个感兴趣量都不在渐近范围内：$S_L$ 显示出不一致的收敛阶，而 $T_{\\max}$ 显示出非单调行为。反应区的物理分辨率不足解释了为什么渐近假设会失效。\n\n### 逐项分析选项\n\n**A. 如果 $S_L$ 在两套连续网格间的相对变化低于 $1\\%$，则解既是网格无关的，也是渐近收敛的；三套网格分析是不必要的，因为 $u(h)=u_{\\mathrm{exact}}+C h^p$ 对任何 $h$ 都成立。**\n这个陈述从根本上是错误的。仅凭两套网格间的微小变化，并不足以作为渐近收敛的充分条件，正如我们的分析所证明的。要求至少三套网格的目的恰恰是为了检验渐近行为。误差模型 $u(h)=u_{\\mathrm{exact}}+C h^p$ 是一个渐近近似，仅在 $h$ 足够小时有效，而不是对“任何 $h$”都成立。\n**结论：不正确。**\n\n**B. 已验证的网格收敛要求通过分析至少三套具有恒定加密比 $r1$ 的系统性加密网格来证明渐近行为，估算一致的观测阶 $p$ 和一个外推值，并检查单调趋势以及迭代误差和离散误差的分离；两套网格间的微小变化可能发生在渐近范围之外，原因包括预渐近误差项的抵消、当 $h/\\delta_R\\not\\ll 1$ 时反应区的解析度不足或非单调行为，因此它们并不意味着渐近收敛。**\n这个选项正确而全面地总结了网格收敛性验证的最佳实践。它正确地指出了使用至少三套网格、检查一致的收敛阶（$p_{\\text{obs}} \\approx p_{\\text{nom}}$）以及验证单调行为的必要性。它准确地列出了两套网格间的微小变化可能具有误导性的原因：预渐近误差的抵消（导致我们的 $p_{\\text{obs}, S_L}=3$）、关键物理特征的解析度不足（$h/\\delta_R$ 不小）以及非单调行为（如在 $T_{\\max}$ 中所见）。这个选项与我们的推导分析完全一致。\n**结论：正确。**\n\n**C. 具有 $h_3/\\delta_R\\approx 0.25$ 保证了渐近收敛，因为至少有四个点跨越了反应区；因此，$S_L$ 的微小变化足以断定已验证的网格收敛。**\n这个陈述提出了一个错误的论断。在某个特征上（这里是 $1/(h_3/\\delta_R)=4$）有一定数量的网格点只是一个经验法则，并不能保证处于渐近范围内，特别是对于高度非线性的问题。$T_{\\max}$ 的非单调收敛和 $S_L$ 的不一致的 $p_{\\text{obs}}$ 提供了直接反驳这一论断的证据。因此，得出的结论是无效的。\n**结论：不正确。**\n\n**D. $T_{\\max}$ 随网格加密的非单调变化必定源于建模误差，且不影响网格收敛；由于 $S_L$ 变化很小，即使 $T_{\\max}$ 发生振荡，解也是渐近的。**\n这个陈述是不正确的。关键解变量在网格加密过程中的非单调行为是网格过粗时离散误差的典型症状，而不必然是“建模误差”（物理/化学模型本身的误差）。忽略这个非渐近行为的明确指标是不严谨的科学实践。所有主要感兴趣量的收敛行为都应被考虑。选择性地采纳 $S_L$ 的“好看”结果，而忽视 $T_{\\max}$ 的“难看”结果，会导致错误的收敛结论。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "这个高级练习介绍了“人造解方法”（Method of Manufactured Solutions, MMS），这是一种强大的代码验证（code verification）技术。解的验证（Solution verification）旨在估算特定模拟中的数值误差，但我们如何验证代码本身的正确性呢？您将为控制方程组构建一个精确的解析解，并用它来精确测量您的数值格式所产生的截断误差。通过这个过程，您可以确认代码是否达到了其理论上的收敛精度，这是确保模拟可靠性的严格一步。",
            "id": "4029257",
            "problem": "考虑一个一维多组分平流-扩散-反应系统，该系统以摩尔单位表示，描述了一组参与燃烧化学的物种。设空间域为 $x \\in [0,1]$，具有周期性边界条件，时间为 $t \\in \\mathbb{R}^{+}$。对于每个物种 $k$，其摩尔浓度 $C_{k}(x,t)$ 的控制方程为\n$$\n\\frac{\\partial C_{k}}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u \\, C_{k}\\right) = \\frac{\\partial}{\\partial x}\\left(D \\, \\frac{\\partial C_{k}}{\\partial x}\\right) + R_{k}(x,t),\n$$\n其中 $u$ 是以 $\\mathrm{m/s}$ 为单位的恒定平流速度，$D$ 是以 $\\mathrm{m^{2}/s}$ 为单位的恒定扩散系数，$R_{k}$ 是以 $\\mathrm{mol/(m^{3}\\,s)}$ 为单位的摩尔源项。使用人造解方法（Method of Manufactured Solutions, MMS）构造物种场和源项，使其在连续层面上精确满足元素守恒，然后使用二阶空间离散格式验证离散元素守恒和网格收敛性。\n\n考虑三种物种：氢气（$\\mathrm{H_2}$）、氧气（$\\mathrm{O_2}$）和水（$\\mathrm{H_2O}$）。定义每个分子中的元素原子数如下：对于氢原子，$a_{\\mathrm{H},\\mathrm{H_2}} = 2$, $a_{\\mathrm{H},\\mathrm{O_2}} = 0$, $a_{\\mathrm{H},\\mathrm{H_2O}} = 2$；对于氧原子，$a_{\\mathrm{O},\\mathrm{H_2}} = 0$, $a_{\\mathrm{O},\\mathrm{O_2}} = 2$, $a_{\\mathrm{O},\\mathrm{H_2O}} = 1$。令元素加权和为\n$$\nZ_{\\mathrm{H}}(x,t) = 2 C_{\\mathrm{H_2}}(x,t) + 2 C_{\\mathrm{H_2O}}(x,t), \\quad Z_{\\mathrm{O}}(x,t) = 2 C_{\\mathrm{O_2}}(x,t) + C_{\\mathrm{H_2O}}(x,t).\n$$\n\n构造一个由两个光滑分量组成的人造解，\n$$\n\\phi(x,t) = A + B \\, e^{-\\lambda t} \\, \\sin\\!\\big(2\\pi(x - u t)\\big), \\quad \\lambda = D (2\\pi)^{2},\n$$\n$$\n\\chi(x,t) = C_{0} + C_{1} \\, \\cos(4\\pi x) \\, \\sin(\\Omega t),\n$$\n并将物种浓度定义为线性组合\n$$\nC_{\\mathrm{H_2}}(x,t) = \\alpha_{\\mathrm{H_2}}\\,\\phi(x,t) + \\beta_{\\mathrm{H_2}}\\,\\chi(x,t),\n$$\n$$\nC_{\\mathrm{O_2}}(x,t) = \\alpha_{\\mathrm{O_2}}\\,\\phi(x,t) + \\beta_{\\mathrm{O_2}}\\,\\chi(x,t),\n$$\n$$\nC_{\\mathrm{H_2O}}(x,t) = \\alpha_{\\mathrm{H_2O}}\\,\\phi(x,t) + \\beta_{\\mathrm{H_2O}}\\,\\chi(x,t),\n$$\n其中常数 $\\alpha_{\\mathrm{H_2}} = 1.1$, $\\alpha_{\\mathrm{O_2}} = 0.7$, $\\alpha_{\\mathrm{H_2O}} = 0.4$ 和 $\\beta_{\\mathrm{H_2}} = -1.0$, $\\beta_{\\mathrm{O_2}} = -0.5$, $\\beta_{\\mathrm{H_2O}} = 1.0$。将 $\\chi$ 的强迫项定义为\n$$\nQ(x,t) = \\frac{\\partial \\chi}{\\partial t} + u \\frac{\\partial \\chi}{\\partial x} - D \\frac{\\partial^{2} \\chi}{\\partial x^{2}},\n$$\n并将物种源项定义为\n$$\nR_{\\mathrm{H_2}}(x,t) = \\beta_{\\mathrm{H_2}}\\, Q(x,t), \\quad R_{\\mathrm{O_2}}(x,t) = \\beta_{\\mathrm{O_2}}\\, Q(x,t), \\quad R_{\\mathrm{H_2O}}(x,t) = \\beta_{\\mathrm{H_2O}}\\, Q(x,t).\n$$\n这种选择确保了元素生成率满足\n$$\n\\sum_{k} a_{\\mathrm{H},k}\\, R_{k}(x,t) = 0, \\quad \\sum_{k} a_{\\mathrm{O},k}\\, R_{k}(x,t) = 0,\n$$\n对于所有的 $x$ 和 $t$，通过构造即可满足。\n\n在一个固定时间 $t = t_{0}$，在一个包含 $N$ 个点的均匀周期性网格上，使用二阶中心差分对空间算子进行离散化。用 $h = 1/N$ 表示网格间距，用 $x_{i} = (i + 1/2) h$（其中 $i = 0,1,\\dots,N-1$）表示网格点。在 $t_{0}$ 时刻使用精确的解析时间导数 $\\frac{\\partial C_k}{\\partial t}$。将物种 $k$ 在网格点 $i$ 的离散残差定义为\n$$\n\\mathcal{L}_{k,i} = \\left.\\frac{\\partial C_{k}}{\\partial t}\\right|_{t=t_{0}} + u \\, \\delta_{x}C_{k,i} - D \\, \\delta_{xx}C_{k,i} - R_{k}(x_{i},t_{0}),\n$$\n其中 $\\delta_{x}$ 和 $\\delta_{xx}$ 是对一阶和二阶空间导数的二阶中心差分近似，并带有周期性环绕处理。定义离散元素残差\n$$\nS_{\\mathrm{H},i} = 2 \\mathcal{L}_{\\mathrm{H_2},i} + 2 \\mathcal{L}_{\\mathrm{H_2O},i}, \\quad S_{\\mathrm{O},i} = 2 \\mathcal{L}_{\\mathrm{O_2},i} + \\mathcal{L}_{\\mathrm{H_2O},i}.\n$$\n对于每个元素 $e \\in \\{\\mathrm{H}, \\mathrm{O}\\}$ 和网格尺寸 $N$，计算均方根范数\n$$\nE_{e}(N) = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(S_{e,i}\\right)^{2}}.\n$$\n使用三个嵌套的网格尺寸 $N_{1}$、$N_{2}$ 和 $N_{3}$（其中 $h_{j} = 1/N_{j}$），通过以下公式估算每个元素在连续网格层级之间的观测收敛阶\n$$\np_{e}^{(1,2)} = \\frac{\\ln\\big(E_{e}(N_{1})/E_{e}(N_{2})\\big)}{\\ln(h_{1}/h_{2})}, \\quad p_{e}^{(2,3)} = \\frac{\\ln\\big(E_{e}(N_{2})/E_{e}(N_{3})\\big)}{\\ln(h_{2}/h_{3})}.\n$$\n此外，报告在最细网格 $N_{3}$ 上的最大范数元素残差\n$$\nM(N_{3}) = \\max\\left\\{ \\max_{i} \\left|S_{\\mathrm{H},i}\\right|, \\max_{i} \\left|S_{\\mathrm{O},i}\\right| \\right\\}.\n$$\n量 $E_{e}(N)$ 和 $M(N_{3})$ 必须以 $\\mathrm{mol/(m^{3}\\,s)}$ 为单位表示。\n\n实现上述过程并为以下测试套件生成结果，其中所有量均采用一致的国际单位制表示，角度以弧度为单位：\n\n- 测试用例1（一般情况）：$N$-层级 $[16,32,64]$，$u = 0.3\\,\\mathrm{m/s}$，$D = 0.01\\,\\mathrm{m^{2}/s}$，$A = 1.0\\,\\mathrm{mol/m^{3}}$，$B = 0.2\\,\\mathrm{mol/m^{3}}$，$C_{0} = 0.05\\,\\mathrm{mol/m^{3}}$，$C_{1} = 0.1\\,\\mathrm{mol/m^{3}}$，$\\Omega = 3.0\\,\\mathrm{rad/s}$，$t_{0} = 0.25\\,\\mathrm{s}$。\n- 测试用例2（粗网格边界）：$N$-层级 $[8,16,32]$，$u = 0.3\\,\\mathrm{m/s}$，$D = 0.01\\,\\mathrm{m^{2}/s}$，$A = 1.0\\,\\mathrm{mol/m^{3}}$，$B = 0.4\\,\\mathrm{mol/m^{3}}$，$C_{0} = 0.05\\,\\mathrm{mol/m^{3}}$，$C_{1} = 0.5\\,\\mathrm{mol/m^{3}}$，$\\Omega = 3.0\\,\\mathrm{rad/s}$，$t_{0} = 0.10\\,\\mathrm{s}$。\n- 测试用例3（高扩散边缘）：$N$-层级 $[16,32,64]$，$u = 0.1\\,\\mathrm{m/s}$，$D = 0.2\\,\\mathrm{m^{2}/s}$，$A = 1.0\\,\\mathrm{mol/m^{3}}$，$B = 0.2\\,\\mathrm{mol/m^{3}}$，$C_{0} = 0.05\\,\\mathrm{mol/m^{3}}$，$C_{1} = 0.1\\,\\mathrm{mol/m^{3}}$，$\\Omega = 3.0\\,\\mathrm{rad/s}$，$t_{0} = 0.40\\,\\mathrm{s}$。\n\n你的程序应为每个测试用例计算五个浮点数 $[p_{\\mathrm{H}}^{(1,2)}, p_{\\mathrm{H}}^{(2,3)}, p_{\\mathrm{O}}^{(1,2)}, p_{\\mathrm{O}}^{(2,3)}, M(N_{3})]$，并将所有测试用例的结果汇总到单行输出中，结果以逗号分隔并用方括号括起来（例如，最终输出应类似于 $[r_{1},r_{2},\\dots,r_{15}]$）。所有残差范数必须以 $\\mathrm{mol/(m^{3}\\,s)}$ 为单位，以普通十进制数报告，所有收敛阶也必须以普通十进制数报告。",
            "solution": "该问题被评估为具有科学依据、良态、客观且内部一致。它构成了计算科学中使用人造解方法（MMS）的一个标准验证练习，并提供了所有必需的数据和定义。因此，将给出一个完整的解。\n\n主要目标是使用人造解方法来验证一个多物种平流-扩散-反应系统的二阶空间离散格式在格式的截断误差阶内保持元素守恒。\n\n首先，我们分析连续问题。物种 $k$ 的摩尔浓度 $C_k(x,t)$ 的控制方程由下式给出：\n$$\n\\frac{\\partial C_{k}}{\\partial t} + u \\frac{\\partial C_{k}}{\\partial x} = D \\frac{\\partial^{2} C_{k}}{\\partial x^{2}} + R_{k}(x,t)\n$$\n其中平流速度 $u$ 和扩散系数 $D$ 是常数。\n\n每个物种浓度 $C_k(x,t)$ 的人造解被构造成两个基函数 $\\phi(x,t)$ 和 $\\chi(x,t)$ 的线性组合：\n$$\nC_k(x,t) = \\alpha_k \\phi(x,t) + \\beta_k \\chi(x,t)\n$$\n第一个基函数 $\\phi(x,t) = A + B e^{-\\lambda t} \\sin\\left(2\\pi(x - ut)\\right)$（其中 $\\lambda = D(2\\pi)^2$）被特意构造成齐次平流-扩散方程（即 $\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} - D \\frac{\\partial^2 \\phi}{\\partial x^2} = 0$）的精确解。这可以通过直接代入其偏导数来验证：\n$$\n\\frac{\\partial \\phi}{\\partial t} = -B \\lambda e^{-\\lambda t} \\sin\\left(2\\pi(x-ut)\\right) - B e^{-\\lambda t} \\cos\\left(2\\pi(x-ut)\\right) (2\\pi u)\n$$\n$$\n\\frac{\\partial \\phi}{\\partial x} = B e^{-\\lambda t} \\cos\\left(2\\pi(x-ut)\\right) (2\\pi)\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} = -B e^{-\\lambda t} \\sin\\left(2\\pi(x-ut)\\right) (2\\pi)^2\n$$\n将这些代入齐次偏微分方程（PDE）得到：\n$$\n\\left( -B \\lambda e^{-\\lambda t} \\sin(\\dots) - 2\\pi u B e^{-\\lambda t} \\cos(\\dots) \\right) + u \\left( 2\\pi B e^{-\\lambda t} \\cos(\\dots) \\right) - D \\left( -(2\\pi)^2 B e^{-\\lambda t} \\sin(\\dots) \\right)\n$$\n$$\n= \\left( -\\lambda + D(2\\pi)^2 \\right) B e^{-\\lambda t} \\sin(\\dots) = 0\n$$\n根据定义 $\\lambda = D(2\\pi)^2$。常数部分 $A$ 也平凡地满足齐次方程。\n\n为了使完整的人造解 $C_k(x,t)$ 满足控制方程，源项 $R_k$ 必须定义为将 $C_k$ 代入偏微分方程后剩下的残差。将平流-扩散算子 $\\mathcal{P} \\equiv \\frac{\\partial}{\\partial t} + u \\frac{\\partial}{\\partial x} - D \\frac{\\partial^2}{\\partial x^2}$ 应用于 $C_k$：\n$$\n\\mathcal{P}[C_k] = \\mathcal{P}[\\alpha_k \\phi + \\beta_k \\chi] = \\alpha_k \\mathcal{P}[\\phi] + \\beta_k \\mathcal{P}[\\chi]\n$$\n由于 $\\mathcal{P}[\\phi] = 0$，这简化为 $\\mathcal{P}[C_k] = \\beta_k \\mathcal{P}[\\chi]$。因此，所需的源项是 $R_k(x,t) = \\beta_k Q(x,t)$，其中 $Q(x,t) = \\mathcal{P}[\\chi] = \\frac{\\partial \\chi}{\\partial t} + u \\frac{\\partial \\chi}{\\partial x} - D \\frac{\\partial^2 \\chi}{\\partial x^2}$，这与问题中的定义完全一致。\n\n这个问题的关键方面是元素守恒。元素 $e$ 的生成速率由 $\\sum_k a_{e,k} R_k$ 给出，其中 $a_{e,k}$ 是物种 $k$ 中元素 $e$ 的原子数。该问题的构造使得这个和在连续层面上为零。对于元素 H：\n$$\n\\sum_k a_{\\mathrm{H},k} R_k = a_{\\mathrm{H},\\mathrm{H_2}} R_{\\mathrm{H_2}} + a_{\\mathrm{H},\\mathrm{O_2}} R_{\\mathrm{O_2}} + a_{\\mathrm{H},\\mathrm{H_2O}} R_{\\mathrm{H_2O}} = 2 R_{\\mathrm{H_2}} + 0 \\cdot R_{\\mathrm{O_2}} + 2 R_{\\mathrm{H_2O}}\n$$\n$$\n= (2 \\beta_{\\mathrm{H_2}} + 2 \\beta_{\\mathrm{H_2O}}) Q(x,t) = (2(-1.0) + 2(1.0)) Q(x,t) = 0\n$$\n对于元素 O：\n$$\n\\sum_k a_{\\mathrm{O},k} R_k = a_{\\mathrm{O},\\mathrm{H_2}} R_{\\mathrm{H_2}} + a_{\\mathrm{O},\\mathrm{O_2}} R_{\\mathrm{O_2}} + a_{\\mathrm{O},\\mathrm{H_2O}} R_{\\mathrm{H_2O}} = 0 \\cdot R_{\\mathrm{H_2}} + 2 R_{\\mathrm{O_2}} + 1 \\cdot R_{\\mathrm{H_2O}}\n$$\n$$\n= (2 \\beta_{\\mathrm{O_2}} + \\beta_{\\mathrm{H_2O}}) Q(x,t) = (2(-0.5) + 1.0) Q(x,t) = 0\n$$\n因此，源项是元素守恒的。这意味着元素加权和 $Z_e = \\sum_k a_{e,k} C_k$ 必须满足一个齐次平流-扩散方程，$\\mathcal{P}[Z_e] = \\sum_k a_{e,k} \\mathcal{P}[C_k] = \\sum_k a_{e,k} R_k = 0$。\n\n现在我们转向离散问题。在网格点 $x_i$ 处物种 $k$ 的离散残差定义为：\n$$\n\\mathcal{L}_{k,i} = \\left.\\frac{\\partial C_{k}}{\\partial t}\\right|_{t_0, x_i} + u \\, (\\delta_{x}C_{k})_i - D \\, (\\delta_{xx}C_{k})_i - R_k(x_i, t_0)\n$$\n其中 $\\delta_x$ 和 $\\delta_{xx}$ 是二阶中心差分算子。这个残差衡量了精确的连续解不满足离散方程的程度。根据定义，它就是空间离散的局部截断误差。\n\n离散元素残差为 $S_{e,i} = \\sum_k a_{e,k} \\mathcal{L}_{k,i}$。由于算子的线性特性：\n$$\nS_{e,i} = \\sum_k a_{e,k} \\left( \\frac{\\partial C_k}{\\partial t} + u \\delta_x C_k - D \\delta_{xx} C_k - R_k \\right)_i = \\left( \\frac{\\partial Z_e}{\\partial t} + u \\delta_x Z_e - D \\delta_{xx} Z_e - \\sum_k a_{e,k} R_k \\right)_i\n$$\n因为 $\\sum_k a_{e,k} R_k = 0$，这简化为 $S_{e,i} = \\left( \\frac{\\partial Z_e}{\\partial t} + u \\delta_x Z_e - D \\delta_{xx} Z_e \\right)_i$。\n我们也知道，在连续层面上，$\\frac{\\partial Z_e}{\\partial t} + u \\frac{\\partial Z_e}{\\partial x} - D \\frac{\\partial^2 Z_e}{\\partial x^2} = 0$。\n因此，元素残差可以表示为作用于 $Z_e$ 的离散算子和连续算子之差：\n$$\nS_{e,i} = u \\left( \\delta_x Z_e - \\frac{\\partial Z_e}{\\partial x} \\right)_i - D \\left( \\delta_{xx} Z_e - \\frac{\\partial^2 Z_e}{\\partial x^2} \\right)_i\n$$\n这表明离散元素残差是作用于元素和 $Z_e$ 的一阶和二阶导数近似的截断误差之和。对于二阶中心差分，一阶导数的截断误差是 $O(h^2)$，二阶导数的截断误差也是 $O(h^2)$，其中 $h=1/N$ 是网格间距。因此，我们期望 $S_{e,i}$ 是 $h^2$ 阶的，即 $S_{e,i} \\propto h^2$。RMS 范数 $E_e(N)$ 也应表现出二阶收敛性，即 $E_e(N) \\propto h^2$。因此，观测到的收敛阶 $p_e$ 应接近于 2。\n\n算法实现将按以下步骤进行：\n1. 对于每个测试用例，定义所有物理参数和 MMS 参数。\n2. 对于序列中的每个网格分辨率 $N_j$：\n   a. 定义空间网格 $x_i = (i+1/2)h$，其中 $i=0,\\dots,N_j-1$。\n   b. 在网格上为每个物种解析地计算 $C_k(x_i, t_0)$、$\\frac{\\partial C_k}{\\partial t}(x_i, t_0)$ 和 $R_k(x_i, t_0)$。\n   c. 实现二阶周期性中心差分算子来计算 $(\\delta_x C_k)_i$ 和 $(\\delta_{xx} C_k)_i$。\n   d. 计算每个物种的残差 $\\mathcal{L}_{k,i}$。\n   e. 计算元素残差 $S_{\\mathrm{H},i}$ 和 $S_{\\mathrm{O},i}$。\n   f. 计算并存储 RMS 范数 $E_{\\mathrm{H}}(N_j)$ 和 $E_{\\mathrm{O}}(N_j)$。\n3. 使用存储的范数计算收敛阶 $p_e^{(1,2)}$ 和 $p_e^{(2,3)}$。\n4. 在最细的网格 $N_3$ 上，计算元素残差的最大范数 $M(N_3)$。\n5. 汇总并格式化每个测试用例的五个浮点数结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the grid convergence problem for the given test cases.\n    \"\"\"\n    # Test cases as provided in the problem statement.\n    test_cases = [\n        # ((N1, N2, N3), u, D, A, B, C0, C1, Omega, t0)\n        ([16, 32, 64], 0.3, 0.01, 1.0, 0.2, 0.05, 0.1, 3.0, 0.25),\n        ([8, 16, 32], 0.3, 0.01, 1.0, 0.4, 0.05, 0.5, 3.0, 0.10),\n        ([16, 32, 64], 0.1, 0.2, 1.0, 0.2, 0.05, 0.1, 3.0, 0.40),\n    ]\n\n    # Species and element definitions\n    # C_k = [C_H2, C_O2, C_H2O]\n    alpha_k = np.array([1.1, 0.7, 0.4])  # for H2, O2, H2O\n    beta_k = np.array([-1.0, -0.5, 1.0])  # for H2, O2, H2O\n    \n    # Element atom counts [a_e,H2, a_e,O2, a_e,H2O]\n    a_H = np.array([2.0, 0.0, 2.0])\n    a_O = np.array([0.0, 2.0, 1.0])\n\n    all_results = []\n\n    for case in test_cases:\n        N_levels, u, D, A, B, C0, C1, Omega, t0 = case\n        \n        h_levels = [1.0 / N for N in N_levels]\n        error_norms_H = []\n        error_norms_O = []\n        \n        S_H_finest = None\n        S_O_finest = None\n\n        for N in N_levels:\n            h = 1.0 / N\n            x = (np.arange(N) + 0.5) * h\n\n            # Analytical functions and derivatives\n            k1 = 2.0 * np.pi\n            k2 = 4.0 * np.pi\n            lam = D * k1**2\n\n            # phi and its time derivative\n            exp_term = B * np.exp(-lam * t0)\n            sin_phi_arg = k1 * (x - u * t0)\n            phi = A + exp_term * np.sin(sin_phi_arg)\n            dphi_dt = exp_term * (-lam * np.sin(sin_phi_arg) - k1 * u * np.cos(sin_phi_arg))\n            \n            # chi and its derivatives\n            cos_chi_x_arg = k2 * x\n            sin_chi_t_arg = np.sin(Omega * t0)\n            cos_chi_t_arg = np.cos(Omega * t0)\n            \n            chi = C0 + C1 * np.cos(cos_chi_x_arg) * sin_chi_t_arg\n            dchi_dt = C1 * Omega * np.cos(cos_chi_x_arg) * cos_chi_t_arg\n            dchi_dx = -C1 * k2 * np.sin(cos_chi_x_arg) * sin_chi_t_arg\n            d2chi_dx2 = -C1 * k2**2 * np.cos(cos_chi_x_arg) * sin_chi_t_arg\n            \n            # Source term Q\n            Q = dchi_dt + u * dchi_dx - D * d2chi_dx2\n            \n            # Discrete derivative operators (2nd-order central, periodic)\n            def delta_x(f, h_grid):\n                return (np.roll(f, -1) - np.roll(f, 1)) / (2.0 * h_grid)\n\n            def delta_xx(f, h_grid):\n                return (np.roll(f, -1) - 2.0 * f + np.roll(f, 1)) / (h_grid**2)\n\n            L_all_species = np.zeros((3, N))\n\n            for k_idx in range(3):\n                # Species fields\n                C_k = alpha_k[k_idx] * phi + beta_k[k_idx] * chi\n                dC_dt_k = alpha_k[k_idx] * dphi_dt + beta_k[k_idx] * dchi_dt\n                R_k = beta_k[k_idx] * Q\n                \n                # Discrete derivatives\n                dCdx_k_num = delta_x(C_k, h)\n                d2Cdx2_k_num = delta_xx(C_k, h)\n\n                # Species residual\n                L_k = dC_dt_k + u * dCdx_k_num - D * d2Cdx2_k_num - R_k\n                L_all_species[k_idx, :] = L_k\n\n            # Elemental residuals\n            S_H = a_H[0] * L_all_species[0] + a_H[2] * L_all_species[2]\n            S_O = a_O[1] * L_all_species[1] + a_O[2] * L_all_species[2]\n            \n            # RMS error norms\n            E_H = np.sqrt(np.mean(S_H**2))\n            E_O = np.sqrt(np.mean(S_O**2))\n            \n            error_norms_H.append(E_H)\n            error_norms_O.append(E_O)\n            \n            if N == N_levels[-1]:\n                S_H_finest = S_H\n                S_O_finest = S_O\n        \n        # Calculate convergence orders\n        p_H_12 = np.log(error_norms_H[0] / error_norms_H[1]) / np.log(h_levels[0] / h_levels[1])\n        p_H_23 = np.log(error_norms_H[1] / error_norms_H[2]) / np.log(h_levels[1] / h_levels[2])\n        \n        p_O_12 = np.log(error_norms_O[0] / error_norms_O[1]) / np.log(h_levels[0] / h_levels[1])\n        p_O_23 = np.log(error_norms_O[1] / error_norms_O[2]) / np.log(h_levels[1] / h_levels[2])\n        \n        # Calculate max-norm on finest grid\n        M_N3 = np.max([np.max(np.abs(S_H_finest)), np.max(np.abs(S_O_finest))])\n\n        all_results.extend([p_H_12, p_H_23, p_O_12, p_O_23, M_N3])\n        \n    print(f\"[{','.join(f'{r:.15f}' for r in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}