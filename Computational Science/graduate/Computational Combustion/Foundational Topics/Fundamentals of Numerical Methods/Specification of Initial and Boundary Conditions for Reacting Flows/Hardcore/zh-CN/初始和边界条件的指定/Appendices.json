{
    "hands_on_practices": [
        {
            "introduction": "在反应流模拟中，点火延迟等关键现象对初始条件，特别是初始活性自由基的浓度，表现出极大的敏感性。在链式反应体系中，初始自由基池的微小变化可能导致点火时间的巨大差异。本练习  旨在通过一个简化的动力学模型，定量探索初始自由基质量分数与点火延迟时间之间的关系，从而掌握如何通过“播种”自由基来精确控制点火行为。",
            "id": "4065723",
            "problem": "考虑一个均匀、绝热、恒容的零维（0-D）反应器，其中包含预混可燃气体。在链式分支反应系统的点火诱导期内，由于分支反应，少量自由基池可能会近似呈指数级增长。我们关注自由基初始条件的设定，以及在初始条件中刻意植入自由基如何改变点火诱导时间。假设在诱导阶段，自由基质量分数 $Y_{\\mathrm{r}}(t)$（代表 $Y_{\\mathrm{H}}$ 或 $Y_{\\mathrm{OH}}$）存在一个有效的单参数线性化模型：\n$$\n\\frac{dY_{\\mathrm{r}}}{dt} = \\lambda\\,Y_{\\mathrm{r}},\n$$\n其中 $\\lambda$ 是一个有效的链式分支特征值，其大小通过阿伦尼乌斯形式取决于热力学状态和氧化剂摩尔浓度。将 $\\lambda$ 处理为\n$$\n\\lambda(T,p,x_{\\mathrm{O_2}}) = k(T)\\,[\\mathrm{O_2}],\n\\quad\nk(T) = A\\,T^{n}\\,\\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}\\,T}\\right),\n\\quad\n[\\mathrm{O_2}] = x_{\\mathrm{O_2}}\\frac{p}{R_{\\mathrm{u}}\\,T},\n$$\n其中 $A$ 的单位为 $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$，$n$ 无量纲，$E_{\\mathrm{a}}$ 的单位为 $\\mathrm{J\\,mol^{-1}}$，$R_{\\mathrm{u}}$ 是通用气体常数，单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$T$ 的单位为 $\\mathrm{K}$，$p$ 的单位为 $\\mathrm{Pa}$，$x_{\\mathrm{O_2}}$ 是氧气的摩尔分数。假设氧化剂摩尔分数 $x_{\\mathrm{O_2}}$ 由空气提供，并且在初始条件中指定了初始自由基质量分数 $Y_{\\mathrm{r},0}$。定义一个临界自由基质量分数 $Y_{\\mathrm{crit}}$，当达到此值时，线性化模型不再有效，因为会随之发生快速放热；将 $Y_{\\mathrm{crit}}$ 视为一个小的、与物质相关的阈值。\n\n在这些假设下，点火诱导时间 $t_{\\mathrm{ign}}$ 是根据线性增长模型，$Y_{\\mathrm{r}}(t)$ 从 $Y_{\\mathrm{r},0}$ 增长到 $Y_{\\mathrm{crit}}$ 所需的时间。在初始条件中植入自由基意味着在演化前将 $Y_{\\mathrm{r},0}$ 扰动一个非负量 $\\delta Y$，以减少诱导时间。设初始条件在 $t=0$ 时从 $Y_{\\mathrm{r},0}$ 修改为 $Y_{\\mathrm{r},0} + \\delta Y$。\n\n仅从所述模型、理想气体定律和质量作用动力学出发，从第一性原理进行数学推导：\n- 一个用 $Y_{\\mathrm{r},0}$、$Y_{\\mathrm{crit}}$ 和 $\\lambda$ 表示 $t_{\\mathrm{ign}}$ 的表达式；\n- 实现以下任一目标所需的扰动 $\\delta Y$：\n  1. 一个指定的比例减少量 $0 \\le \\beta  1$，使得 $t_{\\mathrm{new}} = (1-\\beta)\\,t_{\\mathrm{old}}$，或\n  2. 一个指定的绝对减少量 $\\Delta t > 0$，使得 $t_{\\mathrm{new}} = t_{\\mathrm{old}} - \\Delta t$，并受物理约束 $t_{\\mathrm{new}} \\ge 0$ 的限制。\n\n如果 $\\Delta t \\ge t_{\\mathrm{old}}$，模型表明需要在 $t=0$ 时将 $Y_{\\mathrm{r},0} + \\delta Y$ 驱动到至少 $Y_{\\mathrm{crit}}$，此时最小的有物理意义的扰动为 $\\delta Y = \\max(Y_{\\mathrm{crit}} - Y_{\\mathrm{r},0}, 0)$，从而得到 $t_{\\mathrm{new}} = 0$。\n\n假设使用以下常量（以指定单位表示所有数值）：\n- 通用气体常数 $R_{\\mathrm{u}} = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 有效阿伦尼乌斯参数 $A = 10^{6}\\,\\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}}$，$n = 0$，$E_{\\mathrm{a}} = 1.2\\times 10^{5}\\,\\mathrm{J\\,mol^{-1}}$。\n- 在所有情况下，氧气摩尔分数 $x_{\\mathrm{O_2}} = 0.21$。\n- 临界阈值 $Y_{\\mathrm{crit,H}} = 10^{-6}$ 和 $Y_{\\mathrm{crit,OH}} = 10^{-6}$（无量纲质量分数）。\n- 使用 $1\\,\\mathrm{atm} = 101325\\,\\mathrm{Pa}$。\n\n反应流模型的初始和边界条件设定：\n- 初始热力学状态：均匀温度 $T_{0}$（单位 $\\mathrm{K}$），均匀压力 $p_{0}$（单位 $\\mathrm{atm}$），以及均匀组分，其中氧气摩尔分数为 $x_{\\mathrm{O_2}}$，植入的自由基（$\\mathrm{H}$ 或 $\\mathrm{OH}$）的初始质量分数为 $Y_{\\mathrm{r},0}$。\n- 边界条件：封闭、绝热的反应器，无流入或流出，边界上无热量或质量传递（恒容）。\n\n您的任务是实现一个完整的程序，该程序：\n1. 将 $p_{0}$ 从 $\\mathrm{atm}$ 转换为 $\\mathrm{Pa}$。\n2. 根据给定的 $T_{0}$ 和 $p_{0}$ 计算 $[\\mathrm{O_2}]$，然后计算 $\\lambda$。\n3. 计算 $t_{\\mathrm{old}}$ 以及实现所要求的减少目标所需的扰动 $\\delta Y$，和在修改后的初始条件 $Y_{\\mathrm{r},0} + \\delta Y$ 下预测的 $t_{\\mathrm{new}}$。\n4. 根据一个给定的实际掺杂上限 $Y_{\\max}$（无量纲）评估可行性，报告 $\\delta Y \\le Y_{\\max}$ 是否成立；不要将 $\\delta Y$ 裁剪到 $Y_{\\max}$，而是将可行性报告为一个布尔值。\n\n测试套件：\n为以下四种情况提供结果。在每种情况下，使用上述指定的特定自由基的 $Y_{\\mathrm{crit}}$。\n\n- 情况 A（正常情况，比例目标，氢自由基）：\n  - 自由基：$\\mathrm{H}$\n  - $T_{0} = 1200\\,\\mathrm{K}$，$p_{0} = 20\\,\\mathrm{atm}$，$x_{\\mathrm{O_2}} = 0.21$\n  - $Y_{\\mathrm{H},0} = 10^{-10}$，比例减少量 $\\beta = 0.5$\n  - 实际掺杂上限 $Y_{\\max} = 10^{-5}$\n\n- 情况 B（绝对减少目标大于基准延迟，羟基自由基）：\n  - 自由基：$\\mathrm{OH}$\n  - $T_{0} = 1500\\,\\mathrm{K}$，$p_{0} = 10\\,\\mathrm{atm}$，$x_{\\mathrm{O_2}} = 0.21$\n  - $Y_{\\mathrm{OH},0} = 5\\times 10^{-9}$，绝对减少量 $\\Delta t = 0.01\\,\\mathrm{s}$\n  - 实际掺杂上限 $Y_{\\max} = 10^{-6}$\n\n- 情况 C（边界情况，极低温度，大的比例目标，氢自由基）：\n  - 自由基：$\\mathrm{H}$\n  - $T_{0} = 900\\,\\mathrm{K}$，$p_{0} = 30\\,\\mathrm{atm}$，$x_{\\mathrm{O_2}} = 0.21$\n  - $Y_{\\mathrm{H},0} = 10^{-12}$，比例减少量 $\\beta = 0.9$\n  - 实际掺杂上限 $Y_{\\max} = 10^{-7}$\n\n- 情况 D（边界情况，小的绝对减少量，低压下的羟基自由基）：\n  - 自由基：$\\mathrm{OH}$\n  - $T_{0} = 1000\\,\\mathrm{K}$，$p_{0} = 1\\,\\mathrm{atm}$，$x_{\\mathrm{O_2}} = 0.21$\n  - $Y_{\\mathrm{OH},0} = 10^{-8}$，绝对减少量 $\\Delta t = 1\\times 10^{-4}\\,\\mathrm{s}$\n  - 实际掺杂上限 $Y_{\\max} = 10^{-6}$\n\n所需单位和输出：\n- 所有时间以 $\\mathrm{s}$ 表示。\n- 所有质量分数表示为无量纲小数。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，每种情况的结果是列表 $[\\delta Y,\\, t_{\\mathrm{old}},\\, t_{\\mathrm{new}},\\, \\text{feasible}]$。例如，最终输出应如下所示：\n`[[\\delta Y_{A}, t_{old,A}, t_{new,A}, feasible_{A}], [\\delta Y_{B}, t_{old,B}, t_{new,B}, feasible_{B}], [\\delta Y_{C}, t_{old,C}, t_{new,C}, feasible_{C}], [\\delta Y_{D}, t_{old,D}, t_{new,D}, feasible_{D}]]`.",
            "solution": "用户提供的问题陈述已经过仔细验证，被认定为科学上合理、提法恰当且完整。所有提供的模型、参数和常数均符合化学动力学和热力学的既定原理。该问题可形式化，并与计算燃烧学直接相关，具体涉及点火延迟对初始自由基浓度的敏感性。我现在将从第一性原理开始推导，并进行后续的实现。\n\n### 第一部分：第一性原理推导\n\n**1.1. 点火诱导时间 ($t_{\\mathrm{ign}}$) 的表达式**\n\n问题始于一个简化的线性模型，用于描述诱导期内自由基质量分数 $Y_{\\mathrm{r}}$ 的演化：\n$$\n\\frac{dY_{\\mathrm{r}}}{dt} = \\lambda\\,Y_{\\mathrm{r}}\n$$\n此处，$\\lambda$ 是有效的链式分支特征值，它被视为在初始热力学状态 $(T_0, p_0)$ 和氧气摩尔分数 $x_{\\mathrm{O_2}}$ 下评估的常数。这是一个有效的近似，因为在主要放热事件发生前，温度和主要物质的浓度几乎保持不变。\n\n这是一个一阶线性常微分方程。我们可以通过变量分离法来求解：\n$$\n\\frac{dY_{\\mathrm{r}}}{Y_{\\mathrm{r}}} = \\lambda\\,dt\n$$\n我们将此方程从时间 $t=0$ 的初始状态积分到任意时间 $t$ 的状态。初始条件为 $Y_{\\mathrm{r}}(0) = Y_{\\mathrm{r},0}$。\n$$\n\\int_{Y_{\\mathrm{r},0}}^{Y_{\\mathrm{r}}(t)} \\frac{d\\tilde{Y}_{\\mathrm{r}}}{\\tilde{Y}_{\\mathrm{r}}} = \\int_{0}^{t} \\lambda\\,d\\tilde{t}\n$$\n由于 $\\lambda$ 是常数，积分结果为：\n$$\n\\left[ \\ln(\\tilde{Y}_{\\mathrm{r}}) \\right]_{Y_{\\mathrm{r},0}}^{Y_{\\mathrm{r}}(t)} = \\lambda t\n$$\n$$\n\\ln(Y_{\\mathrm{r}}(t)) - \\ln(Y_{\\mathrm{r},0}) = \\lambda t\n$$\n$$\n\\ln\\left(\\frac{Y_{\\mathrm{r}}(t)}{Y_{\\mathrm{r},0}}\\right) = \\lambda t\n$$\n求解 $Y_{\\mathrm{r}}(t)$，我们得到自由基池的典型指数增长：\n$$\nY_{\\mathrm{r}}(t) = Y_{\\mathrm{r},0} e^{\\lambda t}\n$$\n点火诱导时间 $t_{\\mathrm{ign}}$ 定义为自由基质量分数达到临界阈值 $Y_{\\mathrm{crit}}$ 的时间。我们通过设置 $t = t_{\\mathrm{ign}}$ 和 $Y_{\\mathrm{r}}(t_{\\mathrm{ign}}) = Y_{\\mathrm{crit}}$ 来求 $t_{\\mathrm{ign}}$：\n$$\nY_{\\mathrm{crit}} = Y_{\\mathrm{r},0} e^{\\lambda t_{\\mathrm{ign}}}\n$$\n为了求出 $t_{\\mathrm{ign}}$，我们进行代数求解：\n$$\ne^{\\lambda t_{\\mathrm{ign}}} = \\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\n$$\n对两边取自然对数：\n$$\n\\lambda t_{\\mathrm{ign}} = \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right)\n$$\n这给出了点火诱导时间的最终表达式：\n$$\nt_{\\mathrm{ign}} = \\frac{1}{\\lambda} \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right)\n$$\n此表达式在 $\\lambda > 0$ 和 $Y_{\\mathrm{crit}} > Y_{\\mathrm{r},0}$ 的条件下有效，这在点火的物理设定中是固有的。\n\n**1.2. 自由基植入扰动 ($\\delta Y$) 的表达式**\n\n植入自由基将初始条件从 $Y_{\\mathrm{r},0}$ 修改为 $Y'_{\\mathrm{r},0} = Y_{\\mathrm{r},0} + \\delta Y$，其中 $\\delta Y \\ge 0$。原始点火时间记为 $t_{\\mathrm{old}}$，新时间记为 $t_{\\mathrm{new}}$。\n$$\nt_{\\mathrm{old}} = \\frac{1}{\\lambda} \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right)\n$$\n$$\nt_{\\mathrm{new}} = \\frac{1}{\\lambda} \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0} + \\delta Y}\\right)\n$$\n我们需要为两种情况推导 $\\delta Y$。\n\n**情况 1：指定的比例减少**\n新点火时间是旧时间的一部分：$t_{\\mathrm{new}} = (1-\\beta)t_{\\mathrm{old}}$，对于 $0 \\le \\beta  1$。\n$$\n\\frac{1}{\\lambda} \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0} + \\delta Y}\\right) = (1-\\beta) \\left[ \\frac{1}{\\lambda} \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right) \\right]\n$$\n消去 $1/\\lambda$ 项，并使用对数幂次法则 $\\alpha \\ln(x) = \\ln(x^\\alpha)$:\n$$\n\\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0} + \\delta Y}\\right) = \\ln\\left[ \\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right)^{1-\\beta} \\right]\n$$\n令对数的自变量相等：\n$$\n\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0} + \\delta Y} = \\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right)^{1-\\beta}\n$$\n现在，我们求解 $Y_{\\mathrm{r},0} + \\delta Y$：\n$$\nY_{\\mathrm{r},0} + \\delta Y = Y_{\\mathrm{crit}} \\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right)^{-(1-\\beta)} = Y_{\\mathrm{crit}} \\left(\\frac{Y_{\\mathrm{r},0}}{Y_{\\mathrm{crit}}}\\right)^{1-\\beta} = Y_{\\mathrm{crit}} \\frac{Y_{\\mathrm{r},0}^{1-\\beta}}{Y_{\\mathrm{crit}}^{1-\\beta}} = Y_{\\mathrm{crit}}^{\\beta} Y_{\\mathrm{r},0}^{1-\\beta}\n$$\n分离出 $\\delta Y$ 得到所需的扰动：\n$$\n\\delta Y = Y_{\\mathrm{crit}}^{\\beta} Y_{\\mathrm{r},0}^{1-\\beta} - Y_{\\mathrm{r},0}\n$$\n\n**情况 2：指定的绝对减少**\n新点火时间减少一个绝对量：$t_{\\mathrm{new}} = t_{\\mathrm{old}} - \\Delta t$，其中 $\\Delta t > 0$ 且 $t_{\\mathrm{new}} \\ge 0$。\n必须考虑两种子情况。\n\n子情况 2a: $\\Delta t  t_{\\mathrm{old}}$。\n新时间 $t_{\\mathrm{new}}$ 为正。\n$$\nt_{\\mathrm{new}} = \\frac{1}{\\lambda} \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0} + \\delta Y}\\right) = t_{\\mathrm{old}} - \\Delta t = \\frac{1}{\\lambda} \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right) - \\Delta t\n$$\n乘以 $\\lambda$ 并合并项：\n$$\n\\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0} + \\delta Y}\\right) = \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right) - \\lambda \\Delta t\n$$\n对两边取指数：\n$$\n\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0} + \\delta Y} = \\exp\\left( \\ln\\left(\\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}}\\right) - \\lambda \\Delta t \\right) = \\frac{Y_{\\mathrm{crit}}}{Y_{\\mathrm{r},0}} e^{-\\lambda \\Delta t}\n$$\n求解 $Y_{\\mathrm{r},0} + \\delta Y$:\n$$\nY_{\\mathrm{r},0} + \\delta Y = \\frac{Y_{\\mathrm{crit}}}{(Y_{\\mathrm{crit}}/Y_{\\mathrm{r},0})\\,e^{-\\lambda \\Delta t}} = Y_{\\mathrm{r},0}\\,e^{\\lambda \\Delta t}\n$$\n这给出了扰动：\n$$\n\\delta Y = Y_{\\mathrm{r},0} e^{\\lambda \\Delta t} - Y_{\\mathrm{r},0} = Y_{\\mathrm{r},0}(e^{\\lambda \\Delta t} - 1)\n$$\n\n子情况 2b: $\\Delta t \\ge t_{\\mathrm{old}}$。\n目标减少量大于或等于整个诱导期。最小的有物理意义的点火时间是 $t_{\\mathrm{new}} = 0$。这可以通过将初始自由基浓度设置为至少达到临界值来实现。实现此目标的最小扰动是当 $Y_{\\mathrm{r},0} + \\delta Y = Y_{\\mathrm{crit}}$ 时。\n$$\n\\delta Y = Y_{\\mathrm{crit}} - Y_{\\mathrm{r},0}\n$$\n考虑到约束 $\\delta Y \\ge 0$，并注意到 $Y_{\\mathrm{r},0}$ 理论上可能大于 $Y_{\\mathrm{crit}}$（意味着 $t_{\\mathrm{old}} \\le 0$），最通用的形式是 $\\delta Y = \\max(Y_{\\mathrm{crit}} - Y_{\\mathrm{r},0}, 0)$，正如问题中所述。对于所有实际的点火场景，$Y_{\\mathrm{crit}} > Y_{\\mathrm{r},0}$。\n\n### 第二部分：算法实现\n\n程序将为每个测试用例执行以下步骤：\n1.  **设置常量和输入**：定义物理常量和测试用例参数。\n2.  **计算 $\\lambda$**：\n    *   将压力 $p_0$ 从 atm 转换为 Pa：$p_{0,\\mathrm{Pa}} = p_{0,\\mathrm{atm}} \\times 101325$。\n    *   使用理想气体定律计算氧气摩尔浓度 $[\\mathrm{O_2}]$：$[\\mathrm{O_2}] = x_{\\mathrm{O_2}} \\frac{p_{0,\\mathrm{Pa}}}{R_{\\mathrm{u}} T_0}$。\n    *   计算速率系数 $k(T_0)$：$k(T_0) = A T_0^n \\exp(-E_a / (R_u T_0))$。\n    *   计算特征值：$\\lambda = k(T_0) [\\mathrm{O_2}]$。\n3.  **计算 $t_{\\mathrm{old}}$**：使用推导出的公式 $t_{\\mathrm{old}} = \\frac{1}{\\lambda} \\ln(Y_{\\mathrm{crit}}/Y_{\\mathrm{r},0})$。根据指定的自由基选择 $Y_{\\mathrm{crit}}$ 的值。\n4.  **计算 $\\delta Y$ 和 $t_{\\mathrm{new}}$**：\n    *   如果目标是**比例减少** $\\beta$，使用：\n        *   $t_{\\mathrm{new}} = (1-\\beta) t_{\\mathrm{old}}$\n        *   $\\delta Y = Y_{\\mathrm{crit}}^{\\beta} Y_{\\mathrm{r},0}^{1-\\beta} - Y_{\\mathrm{r},0}$\n    *   如果目标是**绝对减少** $\\Delta t$，首先检查是否 $\\Delta t \\ge t_{\\mathrm{old}}$：\n        *   如果为真，设置 $t_{\\mathrm{new}} = 0$ 和 $\\delta Y = Y_{\\mathrm{crit}} - Y_{\\mathrm{r},0}$。\n        *   如果为假，设置 $t_{\\mathrm{new}} = t_{\\mathrm{old}} - \\Delta t$ 和 $\\delta Y = Y_{\\mathrm{r},0}(e^{\\lambda \\Delta t} - 1)$。\n5.  **评估可行性**：将计算出的 $\\delta Y$ 与实际掺杂上限 $Y_{\\max}$ 进行比较。结果是一个布尔值，表示 $\\delta Y \\le Y_{\\max}$ 是否成立。\n6.  **格式化和输出**：将所有情况的结果 $[\\delta Y, t_{\\mathrm{old}}, t_{\\mathrm{new}}, \\text{feasible}]$ 整理成一个列表的列表，并以指定格式打印。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the radical seeding problem for ignition time reduction.\n    The function processes a suite of test cases, calculating the original ignition time,\n    the required radical perturbation to meet a specified reduction target, the new\n    ignition time, and the feasibility of the perturbation.\n    \"\"\"\n\n    # --- Constants ---\n    R_U = 8.314462618  # Universal gas constant (J mol^-1 K^-1)\n    A = 1.0e6          # Arrhenius pre-exponential factor (m^3 mol^-1 s^-1)\n    N = 0.0            # Temperature exponent (dimensionless)\n    E_A = 1.2e5        # Activation energy (J mol^-1)\n    X_O2 = 0.21        # Oxygen molar fraction (dimensionless)\n    ATM_TO_PA = 101325.0 # Pressure conversion (Pa/atm)\n\n    # --- Critical Mass Fractions ---\n    Y_CRIT = {\n        'H': 1.0e-6,\n        'OH': 1.0e-6\n    }\n    \n    # --- Test Suite ---\n    # Each case is a dictionary defining the problem parameters.\n    # 'target_type' can be 'fractional' (beta) or 'absolute' (Delta_t).\n    test_cases = [\n        # Case A: happy path, fractional target, hydrogen radical\n        {'radical': 'H', 'T0': 1200.0, 'p0_atm': 20.0, 'Yr0': 1.0e-10, \n         'target_type': 'fractional', 'target_value': 0.5, 'Y_max': 1.0e-5},\n        \n        # Case B: absolute target larger than baseline delay, hydroxyl radical\n        {'radical': 'OH', 'T0': 1500.0, 'p0_atm': 10.0, 'Yr0': 5.0e-9, \n         'target_type': 'absolute', 'target_value': 0.01, 'Y_max': 1.0e-6},\n        \n        # Case C: edge case, very low temperature, large fractional target, hydrogen radical\n        {'radical': 'H', 'T0': 900.0, 'p0_atm': 30.0, 'Yr0': 1.0e-12, \n         'target_type': 'fractional', 'target_value': 0.9, 'Y_max': 1.0e-7},\n         \n        # Case D: boundary case, small absolute reduction, hydroxyl radical at low pressure\n        {'radical': 'OH', 'T0': 1000.0, 'p0_atm': 1.0, 'Yr0': 1.0e-8, \n         'target_type': 'absolute', 'target_value': 1.0e-4, 'Y_max': 1.0e-6}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        T0 = case['T0']\n        p0_pa = case['p0_atm'] * ATM_TO_PA\n        Yr0 = case['Yr0']\n        Y_crit = Y_CRIT[case['radical']]\n\n        # Step 1: Calculate the chain-branching eigenvalue lambda\n        # Oxygen molar concentration from ideal gas law: [O2] = x_O2 * p / (R_u * T)\n        o2_conc = X_O2 * p0_pa / (R_U * T0)\n        \n        # Rate constant k(T) from Arrhenius form\n        k = A * (T0 ** N) * math.exp(-E_A / (R_U * T0))\n\n        # Eigenvalue lambda = k * [O2]\n        lambda_val = k * o2_conc\n\n        # Step 2: Calculate the original ignition time (t_old)\n        # Handle the edge case where Yr0 >= Y_crit, though not expected from problem context\n        if Yr0 >= Y_crit:\n            t_old = 0.0\n        else:\n            t_old = (1.0 / lambda_val) * math.log(Y_crit / Yr0)\n\n        # Step 3: Calculate perturbation (delta_Y) and new time (t_new)\n        if case['target_type'] == 'fractional':\n            beta = case['target_value']\n            t_new = (1.0 - beta) * t_old\n            # delta_Y = Y_crit^beta * Yr0^(1-beta) - Yr0\n            delta_Y = (Y_crit**beta) * (Yr0**(1.0 - beta)) - Yr0\n        \n        elif case['target_type'] == 'absolute':\n            Delta_t = case['target_value']\n            # Check if requested reduction is larger than the original ignition time\n            if Delta_t >= t_old:\n                t_new = 0.0\n                delta_Y = max(0.0, Y_crit - Yr0)\n            else:\n                t_new = t_old - Delta_t\n                # delta_Y = Yr0 * (exp(lambda * Delta_t) - 1)\n                delta_Y = Yr0 * (math.exp(lambda_val * Delta_t) - 1.0)\n        \n        # Step 4: Check if the required perturbation is feasible\n        feasible = delta_Y = case['Y_max']\n\n        # Store the results for this case\n        results.append([delta_Y, t_old, t_new, feasible])\n\n    # Final print statement in the exact required format.\n    # The str() function on a list will add spaces after commas, which we remove.\n    # The str() on a boolean correctly yields \"True\" or \"False\".\n    formatted_results = [str(r).replace(\" \", \"\") for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了初始条件，反应也可以由边界驱动，例如通过热壁点火。在许多实际燃烧设备中，高温表面是点火的来源，因此准确模拟从壁面到气体的热量传递对于预测点火至关重要。本练习  将此物理情景抽象为一个瞬态热传导问题，要求您推导为达到自燃温度所需的壁面热通量（一个诺伊曼边界条件），从而将热边界条件与化学反应的启动直接联系起来。",
            "id": "4065706",
            "problem": "一种预混合的静止可燃气体占据了 $x>0$ 的半空间，其初始温度 $T_0$ 在空间上是均匀的。在时间 $t=0^{+}$ 时，位于 $x=0$ 处的一个完全不渗透、非催化的壁面被激活，成为一个热点火引发器，它通过施加一个大小为 $q''$ 的恒定热通量将热量从壁面传入气体中。在点火之前，于所关心的时间尺度上，化学放热可以忽略不计，且气体的性质在空间和时间上是均匀且恒定的。你打算在一次直接数值模拟（DNS）中指定热壁点火，方法是将壁面上的热边界条件设定为具有恒定值 $q''$ 的诺伊曼条件，并强制所有组分在壁面处的法向质量通量为零。目标是选择合适的 $q''$ 值，使得在指定的点火延迟时间 $t=\\tau_{\\mathrm{ig}}$ 时，紧邻壁面的气体温度能够达到自燃阈值温度 $T_{\\mathrm{ai}}$。\n\n从无流动和无反应情况下的能量守恒出发，将气体视为一个半无限介质，该介质在 $x>0$ 区域满足一维非稳态热传导，其热扩散率 $\\alpha$ 和热导率 $k$ 均为常数。建立能够代表此热壁策略的、数学上精确的温度初始条件和边界条件。然后，在不假设任何已有的对流传热关系式的情况下，利用这些条件推导出能保证 $T(0^{+},\\tau_{\\mathrm{ig}})=T_{\\mathrm{ai}}$ 的最小恒定壁面热通量 $q''$ 的表达式。最后，代入给定的数据并计算 $q''$ 的数值。\n\n使用以下数据，这些数据代表了点火前时间尺度上，大气压下的贫燃碳氢化合物-空气混合物的典型值：\n- 初始温度: $T_0 = 600\\ \\mathrm{K}$。\n- 自燃阈值: $T_{\\mathrm{ai}} = 1000\\ \\mathrm{K}$。\n- 热导率: $k = 0.10\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$。\n- 热扩散率: $\\alpha = 1.40\\times 10^{-4}\\ \\mathrm{m^2\\,s^{-1}}$。\n- 目标点火延迟时间: $\\tau_{\\mathrm{ig}} = 10\\ \\mathrm{ms}$。\n\n将 $q''$ 的最终答案以 $\\mathrm{kW\\,m^{-2}}$ 为单位表示，并四舍五入至三位有效数字。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于瞬态热传导原理，问题提法得当，具有一套完整且一致的条件，并以客观、正式的语言表述。所有提供的数据在物理上是现实的，并且量纲一致。\n\n该问题描述了一个半无限介质（静止气体）在其边界上受恒定热通量作用下的一维非稳态加热过程。其基本物理定律是傅里叶热传导定律，该定律在无对流、无化学反应、无内部热源的情况下与能量守恒相结合，可导出一维热方程来描述温度 $T(x,t)$ 的变化。\n\n该问题的数学表述如下：\n控制方程：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{对于 } x > 0, t > 0 $$\n其中 $\\alpha$ 是气体的恒定热扩散率。\n\n初始条件 (IC)：\n气体初始温度均匀为 $T_0$。\n$$ T(x, 0) = T_0 \\quad \\text{对于 } x \\ge 0 $$\n\n边界条件 (BCs)：\n1. 在壁面（$x=0$）处，对于 $t>0$，施加一个恒定的热通量 $q''$。根据傅里叶定律，热通量由 $q''_{\\text{cond}} = -k \\frac{\\partial T}{\\partial x}$ 给出。由于热流方向是从壁面到气体（$x$ 正方向），该条件为：\n$$ -k \\frac{\\partial T}{\\partial x}(0, t) = q'' \\quad \\text{对于 } t > 0 $$\n其中 $k$ 是气体的恒定热导率。\n\n2. 在远离壁面的地方（$x \\to \\infty$），温度不受边界加热的影响，因此保持为初始温度 $T_0$。\n$$ \\lim_{x\\to\\infty} T(x,t) = T_0 \\quad \\text{对于 } t \\ge 0 $$\n\n为求解此偏微分方程及其相关的初始和边界条件，我们可以使用拉普拉斯变换法。令 $\\theta(x,t) = T(x,t) - T_0$。问题变换为：\n$$ \\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} $$\n$$ \\theta(x, 0) = 0 $$\n$$ -k \\frac{\\partial \\theta}{\\partial x}(0, t) = q'' $$\n$$ \\lim_{x\\to\\infty} \\theta(x,t) = 0 $$\n\n对该偏微分方程关于时间 $t$ 进行拉普拉斯变换，设 $\\bar{\\theta}(x,s) = \\mathcal{L}\\{\\theta(x,t)\\}$，我们得到一个关于 $x$ 的常微分方程：\n$$ s\\bar{\\theta}(x,s) - \\theta(x,0) = \\alpha \\frac{d^2 \\bar{\\theta}}{dx^2} $$\n$$ \\frac{d^2 \\bar{\\theta}}{dx^2} - \\frac{s}{\\alpha}\\bar{\\theta} = 0 $$\n其通解为 $\\bar{\\theta}(x,s) = C_1 \\exp\\left(-\\sqrt{\\frac{s}{\\alpha}}x\\right) + C_2 \\exp\\left(\\sqrt{\\frac{s}{\\alpha}}x\\right)$。在无穷远处的变换后的边界条件 $\\lim_{x\\to\\infty} \\bar{\\theta}(x,s) = 0$ 要求 $C_2=0$。因此，$\\bar{\\theta}(x,s) = C_1 \\exp\\left(-\\sqrt{\\frac{s}{\\alpha}}x\\right)$。\n\n在 $x=0$ 处的变换后的边界条件是 $\\mathcal{L}\\left\\{-k \\frac{\\partial \\theta}{\\partial x}(0, t)\\right\\} = \\mathcal{L}\\{q''\\}$，可得 $-k \\frac{d\\bar{\\theta}}{dx}(0,s) = \\frac{q''}{s}$。\n对我们关于 $\\bar{\\theta}$ 的解求导：$\\frac{d\\bar{\\theta}}{dx} = -C_1 \\sqrt{\\frac{s}{\\alpha}} \\exp\\left(-\\sqrt{\\frac{s}{\\alpha}}x\\right)$。\n在 $x=0$ 处，得到 $\\frac{d\\bar{\\theta}}{dx}(0,s) = -C_1 \\sqrt{\\frac{s}{\\alpha}}$。\n代入边界条件：$-k \\left(-C_1 \\sqrt{\\frac{s}{\\alpha}}\\right) = \\frac{q''}{s}$，解得 $C_1 = \\frac{q''\\sqrt{\\alpha}}{k s^{3/2}}$。\n\n拉普拉斯域中壁面处（$x=0$）温度的解为：\n$$ \\bar{\\theta}(0,s) = C_1 = \\frac{q''\\sqrt{\\alpha}}{k s^{3/2}} $$\n为了求出时域中壁面处的温度 $\\theta(0,t)$，我们进行拉普拉斯逆变换。使用标准变换对 $\\mathcal{L}^{-1}\\{s^{-3/2}\\} = 2\\sqrt{\\frac{t}{\\pi}}$，我们发现：\n$$ \\theta(0,t) = \\frac{q''\\sqrt{\\alpha}}{k} \\mathcal{L}^{-1}\\{s^{-3/2}\\} = \\frac{q''\\sqrt{\\alpha}}{k} \\left(2\\sqrt{\\frac{t}{\\pi}}\\right) = \\frac{2q''}{k}\\sqrt{\\frac{\\alpha t}{\\pi}} $$\n转换回原始温度变量 $T(x,t) = \\theta(x,t) + T_0$，紧邻壁面的气体温度为：\n$$ T(0,t) = T_0 + \\frac{2q''}{k}\\sqrt{\\frac{\\alpha t}{\\pi}} $$\n问题要求在点火延迟时间 $t = \\tau_{\\mathrm{ig}}$ 时，壁面温度达到自燃阈值 $T_{\\mathrm{ai}}$。因此，我们令 $T(0, \\tau_{\\mathrm{ig}}) = T_{\\mathrm{ai}}$：\n$$ T_{\\mathrm{ai}} = T_0 + \\frac{2q''}{k}\\sqrt{\\frac{\\alpha \\tau_{\\mathrm{ig}}}{\\pi}} $$\n我们现在求解该方程以得到所需的热通量 $q''$：\n$$ T_{\\mathrm{ai}} - T_0 = \\frac{2q''}{k}\\sqrt{\\frac{\\alpha \\tau_{\\mathrm{ig}}}{\\pi}} $$\n$$ q'' = \\frac{k(T_{\\mathrm{ai}} - T_0)}{2} \\sqrt{\\frac{\\pi}{\\alpha \\tau_{\\mathrm{ig}}}} $$\n这就是最小恒定壁面热通量的符号表达式。\n\n现在，我们代入给定的数值：\n- $T_0 = 600\\ \\mathrm{K}$\n- $T_{\\mathrm{ai}} = 1000\\ \\mathrm{K}$\n- $k = 0.10\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- $\\alpha = 1.40 \\times 10^{-4}\\ \\mathrm{m^2\\,s^{-1}}$\n- $\\tau_{\\mathrm{ig}} = 10\\ \\mathrm{ms} = 1.0 \\times 10^{-2}\\ \\mathrm{s}$\n\n温差为 $\\Delta T = T_{\\mathrm{ai}} - T_0 = 1000\\ \\mathrm{K} - 600\\ \\mathrm{K} = 400\\ \\mathrm{K}$。\n\n平方根下的项为：\n$$ \\alpha \\tau_{\\mathrm{ig}} = (1.40 \\times 10^{-4}\\ \\mathrm{m^2\\,s^{-1}})(1.0 \\times 10^{-2}\\ \\mathrm{s}) = 1.40 \\times 10^{-6}\\ \\mathrm{m^2} $$\n将这些值代入 $q''$ 的表达式中：\n$$ q'' = \\frac{(0.10\\ \\mathrm{W\\,m^{-1}\\,K^{-1}})(400\\ \\mathrm{K})}{2} \\sqrt{\\frac{\\pi}{1.40 \\times 10^{-6}\\ \\mathrm{m^2}}} $$\n$$ q'' = (20\\ \\mathrm{W\\,m^{-1}}) \\sqrt{\\frac{\\pi}{1.40 \\times 10^{-6}\\ \\mathrm{m^2}}} $$\n$$ q'' = (20\\ \\mathrm{W\\,m^{-1}}) \\frac{\\sqrt{\\pi}}{\\sqrt{1.40} \\times 10^{-3}\\ \\mathrm{m}} $$\n$$ q'' \\approx (20) \\frac{1.77245}{1.18322 \\times 10^{-3}}\\ \\mathrm{W\\,m^{-2}} $$\n$$ q'' \\approx 29959.9\\ \\mathrm{W\\,m^{-2}} $$\n问题要求答案以千瓦每平方米（$\\mathrm{kW\\,m^{-2}}$）为单位。\n$$ q'' = 29.9599\\ \\mathrm{kW\\,m^{-2}} $$\n四舍五入到三位有效数字，我们得到：\n$$ q'' \\approx 30.0\\ \\mathrm{kW\\,m^{-2}} $$",
            "answer": "$$\\boxed{30.0}$$"
        },
        {
            "introduction": "在计算流体动力学中，定义一个稳定且物理真实的出口边界条件是最具挑战性的任务之一，尤其是在有热量释放的低速流动中。出口处可能出现的再循环（或回流）会导致热产物被重新吸入计算域或环境流体被卷入，从而严重影响模拟的准确性。本练习  通过一个代表性的出口回流场景，让您定量比较三种常见的边界处理策略对总焓通量的影响，从而深刻理解出口边界条件的选择对系统全局能量平衡的决定性作用。",
            "id": "4065701",
            "problem": "一个平面的低马赫数反应流通道在一个轴向位置 $x=L$ 处排入一个开放的储库。计算域由一个控制体组成，其上游由入流界定，下游由一个出口边界 $\\Gamma_{\\text{out}}$ 界定，该出口边界的外向单位法向量为 $\\mathbf{n}$。在低马赫数近似下，显焓的能量方程可以写成在控制体 $V$ 上的积分形式\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_V \\rho h\\,\\mathrm{d}V \\;=\\; -\\int_{\\partial V} \\rho h\\,(\\mathbf{u}\\cdot \\mathbf{n})\\,\\mathrm{d}A \\;+\\; \\text{扩散通量} \\;+\\; \\text{化学热释放} \\;+\\; \\text{压力功项},\n$$\n其中 $\\rho$ 是密度， $h$ 是显焓，$\\mathbf{u}$ 是速度矢量。我们关注通过 $\\Gamma_{\\text{out}}$ 的对流焓通量，其定义为\n$$\n\\dot{H}_{\\text{conv}} \\;=\\; \\int_{\\Gamma_{\\text{out}}} \\rho h\\,u_n\\,\\mathrm{d}A,\n$$\n其中 $u_n=\\mathbf{u}\\cdot\\mathbf{n}$ 向外为正。假设在 $\\Gamma_{\\text{out}}$ 处，流动有两个子区域：一个覆盖出口面积 $A$ 的 $(1-f)$ 分数的外流区，其均匀法向外流速度为 $u_o>0$；以及一个覆盖 $A$ 的 $f$ 分数的回流（再循环）区，其均匀法向内流速度为 $u_n=-u_b  0$。以下量是均匀且已知的：\n- 出口面积 $A$ 等于 $A=\\,$$0.10\\,\\mathrm{m^2}$，\n- 回流面积分数 $f=\\,$$0.15$，\n- 外流区的法向外流速度 $u_o=\\,$$15\\,\\mathrm{m/s}$，\n- 回流区的内流速率 $u_b=\\,$$3\\,\\mathrm{m/s}$，\n- 靠近出口的域内热气体的密度和显焓分别为 $\\rho_d=\\,$$0.70\\,\\mathrm{kg/m^3}$ 和 $h_d=\\,$$1.20\\times 10^6\\,\\mathrm{J/kg}$，\n- 出口外的环境储库的密度和显焓分别为 $\\rho_a=\\,$$1.20\\,\\mathrm{kg/m^3}$ 和 $h_a=\\,$$3.00\\times 10^5\\,\\mathrm{J/kg}$。\n\n考虑三种用于处理 $\\Gamma_{\\text{out}}$ 处回流的边界条件设计：\n(i) 对 $h$ 和组分采用朴素零梯度出口（将域内侧的值外插到边界上），这实际上在包括回流区在内的所有地方都使用 $(\\rho,h)=(\\rho_d,h_d)$；\n(ii) 在回流中进行焓钳位，这在 $u_n  0$ 的地方强制 $(\\rho,h)=(\\rho_a,h_a)$，并在 $u_n>0$ 的地方使用 $(\\rho,h)=(\\rho_d,h_d)$；\n(iii) 防止回流，这在预测的 $u_n  0$ 的地方设置 $u_n=0$，同时在外流区使用 $(\\rho,h)=(\\rho_d,h_d)$。\n\n从 $\\dot{H}_{\\text{conv}}$ 的积分形式出发，推导在三种设计下通过 $\\Gamma_{\\text{out}}$ 的净向外对流显焓通量的表达式，并计算相应的数值。假设扩散、化学和压力功的贡献在别处得到一致处理，在此比较中无需包含在 $\\dot{H}_{\\text{conv}}$ 中。哪一组数值是正确的？\n\nA. 朴素法：$1.0332\\times 10^6\\,\\mathrm{W}$；钳位法：$1.0548\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0710\\times 10^6\\,\\mathrm{W}$\n\nB. 朴素法：$1.0332\\times 10^6\\,\\mathrm{W}$；钳位法：$1.06155\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0710\\times 10^6\\,\\mathrm{W}$\n\nC. 朴素法：$1.1088\\times 10^6\\,\\mathrm{W}$；钳位法：$1.0872\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0710\\times 10^6\\,\\mathrm{W}$\n\nD. 朴素法：$1.0332\\times 10^6\\,\\mathrm{W}$；钳位法：$1.0548\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0548\\times 10^6\\,\\mathrm{W}$",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n- **流动与几何**：一个平面的低马赫数反应流，在通道中流动并于 $x=L$ 处排入一个开放的储库。计算域出口为 $\\Gamma_{\\text{out}}$，面积为 $A$，外向单位法向量为 $\\mathbf{n}$。\n- **控制方程背景**：显焓方程的积分形式为\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_V \\rho h\\,\\mathrm{d}V \\;=\\; -\\int_{\\partial V} \\rho h\\,(\\mathbf{u}\\cdot \\mathbf{n})\\,\\mathrm{d}A \\;+\\; \\text{其他项}. $$\n- **待计算量**：通过出口 $\\Gamma_{\\text{out}}$ 的对流焓通量：\n$$ \\dot{H}_{\\text{conv}} \\;=\\; \\int_{\\Gamma_{\\text{out}}} \\rho h\\,u_n\\,\\mathrm{d}A. $$\n其中 $u_n = \\mathbf{u}\\cdot\\mathbf{n}$ 是向外的法向速度分量。\n- **出口流动条件**：\n  - 外流区：覆盖面积 $A$ 的 $(1-f)$ 分数，具有均匀的法向速度 $u_n = u_o > 0$。\n  - 回流区：覆盖面积 $A$ 的 $f$ 分数，具有均匀的法向速度 $u_n = -u_b  0$。\n- **数值数据**：\n  - 出口面积：$A=0.10\\,\\mathrm{m^2}$。\n  - 回流面积分数：$f=0.15$。\n  - 外流速度：$u_o=15\\,\\mathrm{m/s}$。\n  - 内流速率：$u_b=3\\,\\mathrm{m/s}$。\n  - 域内侧属性（热气体）：$\\rho_d=0.70\\,\\mathrm{kg/m^3}$ 和 $h_d=1.20\\times 10^6\\,\\mathrm{J/kg}$。\n  - 环境储库属性：$\\rho_a=1.20\\,\\mathrm{kg/m^3}$ 和 $h_a=3.00\\times 10^5\\,\\mathrm{J/kg}$。\n- **边界条件设计**：\n  - (i) **朴素法**：在 $\\Gamma_{\\text{out}}$ 上所有地方都为 $(\\rho,h)=(\\rho_d,h_d)$。\n  - (ii) **钳位法**：$u_n  0$ 处为 $(\\rho,h)=(\\rho_a,h_a)$；$u_n>0$ 处为 $(\\rho,h)=(\\rho_d,h_d)$。\n  - (iii) **防止回流法**：预测的 $u_n  0$ 处设置 $u_n=0$；外流区为 $(\\rho,h)=(\\rho_d,h_d)$。\n\n### 第2步：使用提取的已知条件进行验证\n对问题陈述进行有效性评估。\n- **科学依据**：是。该问题设置在反应流的计算流体力学（CFD）背景下，这是一个成熟的工程学科。所提出的概念——低马赫数近似、显焓输运以及各种出口边界条件（零梯度、钳位、防止回流）——都是数值建模中标准且具有物理意义的构造。所提供的物理值对于燃烧系统出口是符合实际的。\n- **适定的**：是。问题定义清晰。对于三种边界条件设计中的每一种，都提供了所有必要的信息来唯一地计算指定的量 $\\dot{H}_{\\text{conv}}$。\n- **客观的**：是。问题使用了计算燃烧领域常见的精确技术语言，没有歧义或主观内容。\n- **结论**：该问题具有科学合理性，是自洽且适定的。未发现任何缺陷。\n\n### 第3步：裁定与行动\n该问题是**有效的**。将继续进行求解推导。\n\n### 对流焓通量的推导\n\n通过出口边界 $\\Gamma_{\\text{out}}$ 的净向外对流显焓通量由以下积分给出：\n$$ \\dot{H}_{\\text{conv}} = \\int_{\\Gamma_{\\text{out}}} \\rho h u_n\\,\\mathrm{d}A $$\n出口面积 $A$ 分为两个区域：一个外流区 $\\Gamma_o$ 和一个回流区 $\\Gamma_b$。积分可以相应地拆分：\n$$ \\dot{H}_{\\text{conv}} = \\int_{\\Gamma_o} \\rho h u_n\\,\\mathrm{d}A + \\int_{\\Gamma_b} \\rho h u_n\\,\\mathrm{d}A $$\n这些区域的面积分别为 $A_o = (1-f)A$ 和 $A_b = fA$。由于每种情况下各区域内的属性都被指定为均匀的，积分简化为代数和：\n$$ \\dot{H}_{\\text{conv}} = (\\rho h u_n)|_{\\text{外流}} A_o + (\\rho h u_n)|_{\\text{回流}} A_b $$\n代入给定的速度和面积：\n$$ \\dot{H}_{\\text{conv}} = (\\rho h)|_{\\text{外流}} u_o (1-f)A + (\\rho h)|_{\\text{回流}} (-u_b) fA $$\n现在我们将这个通用公式应用于三种指定的边界条件设计。\n\n**情况 (i)：朴素零梯度**\n在这种设计中，域内侧的属性被外插到整个边界。因此，在外流和回流区域中都有 $(\\rho,h) = (\\rho_d,h_d)$。\n$$ \\dot{H}_{\\text{conv, naive}} = (\\rho_d h_d) u_o (1-f)A + (\\rho_d h_d) (-u_b) fA $$\n$$ \\dot{H}_{\\text{conv, naive}} = \\rho_d h_d A \\left[ u_o(1-f) - u_b f \\right] $$\n代入数值：\n- $\\rho_d h_d = (0.70\\,\\mathrm{kg/m^3})(1.20 \\times 10^6\\,\\mathrm{J/kg}) = 8.40 \\times 10^5\\,\\mathrm{J/m^3}$\n- $A = 0.10\\,\\mathrm{m^2}$\n- $f = 0.15$，所以 $1-f = 0.85$\n- $u_o = 15\\,\\mathrm{m/s}$\n- $u_b = 3\\,\\mathrm{m/s}$\n$$ \\dot{H}_{\\text{conv, naive}} = (8.40 \\times 10^5\\,\\mathrm{J/m^3})(0.10\\,\\mathrm{m^2}) \\left[ (15\\,\\mathrm{m/s})(0.85) - (3\\,\\mathrm{m/s})(0.15) \\right] $$\n$$ \\dot{H}_{\\text{conv, naive}} = (8.40 \\times 10^4\\,\\mathrm{J/m}) \\left[ 12.75\\,\\mathrm{m/s} - 0.45\\,\\mathrm{m/s} \\right] $$\n$$ \\dot{H}_{\\text{conv, naive}} = (8.40 \\times 10^4\\,\\mathrm{J/m}) (12.3\\,\\mathrm{m/s}) = 1033200\\,\\mathrm{W} = 1.0332 \\times 10^6\\,\\mathrm{W} $$\n\n**情况 (ii)：回流中的焓钳位**\n在这种设计中，外流流体具有域内侧属性，而回流流体具有环境属性。\n- 外流区 $(\\Gamma_o)$: $(\\rho,h) = (\\rho_d,h_d)$。\n- 回流区 $(\\Gamma_b)$: $(\\rho,h) = (\\rho_a,h_a)$。\n通量表达式变为：\n$$ \\dot{H}_{\\text{conv, clamp}} = (\\rho_d h_d) u_o (1-f)A + (\\rho_a h_a) (-u_b) fA $$\n第一项代表离开域的焓，第二项代表从环境储库进入域的焓。\n我们计算每一项：\n- 外流通量：$(\\rho_d h_d) u_o (1-f)A = (8.40 \\times 10^5\\,\\mathrm{J/m^3})(15\\,\\mathrm{m/s})(0.85)(0.10\\,\\mathrm{m^2}) = 1071000\\,\\mathrm{W}$。\n- 回流通量：我们需要 $\\rho_a h_a = (1.20\\,\\mathrm{kg/m^3})(3.00 \\times 10^5\\,\\mathrm{J/kg}) = 3.60 \\times 10^5\\,\\mathrm{J/m^3}$。\n  $(\\rho_a h_a) (-u_b) fA = (3.60 \\times 10^5\\,\\mathrm{J/m^3})(-3\\,\\mathrm{m/s})(0.15)(0.10\\,\\mathrm{m^2}) = -16200\\,\\mathrm{W}$。\n净通量是这两个分量的和：\n$$ \\dot{H}_{\\text{conv, clamp}} = 1071000\\,\\mathrm{W} - 16200\\,\\mathrm{W} = 1054800\\,\\mathrm{W} = 1.0548 \\times 10^6\\,\\mathrm{W} $$\n\n**情况 (iii)：防止回流**\n这种设计通过在预测到回流的地方将法向速度设置为零，从而人为地修改边界上的速度场。\n- 外流区 $(\\Gamma_o)$: $u_n = u_o$，$(\\rho,h)=(\\rho_d,h_d)$。\n- “回流”区 $(\\Gamma_b)$: $u_n=0$。\n计算通量表达式：\n$$ \\dot{H}_{\\text{conv, prevent}} = (\\rho_d h_d) u_o (1-f)A + (\\rho h)|_{\\text{回流}} (0) fA $$\n第二项恒为零，因为在该区域 $u_n=0$。因此，净通量就是来自外流区的通量：\n$$ \\dot{H}_{\\text{conv, prevent}} = (\\rho_d h_d) u_o (1-f)A $$\n这与在钳位情况下计算的外流通量相同。\n$$ \\dot{H}_{\\text{conv, prevent}} = 1071000\\,\\mathrm{W} = 1.0710 \\times 10^6\\,\\mathrm{W} $$\n\n### 结果总结\n- 朴素法：$\\dot{H}_{\\text{conv}} = 1.0332 \\times 10^6\\,\\mathrm{W}$\n- 钳位法：$\\dot{H}_{\\text{conv}} = 1.0548 \\times 10^6\\,\\mathrm{W}$\n- 防止回流法：$\\dot{H}_{\\text{conv}} = 1.0710 \\times 10^6\\,\\mathrm{W}$\n\n### 逐项分析\n\n**A. 朴素法：$1.0332\\times 10^6\\,\\mathrm{W}$；钳位法：$1.0548\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0710\\times 10^6\\,\\mathrm{W}$**\n这组值与所有三种边界条件设计推导出的值完全匹配。\n**裁定：正确**\n\n**B. 朴素法：$1.0332\\times 10^6\\,\\mathrm{W}$；钳位法：$1.06155\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0710\\times 10^6\\,\\mathrm{W}$**\n朴素法和防止回流法的值是正确的。钳位法的值是错误的。导致 $1.06155\\times 10^6\\,\\mathrm{W}$ 的错误是由于在回流计算中错误地将域内侧密度 $\\rho_d$ 与环境焓 $h_a$ 一起使用：\n错误的回流通量：$(\\rho_d h_a) (-u_b) fA = (0.70 \\times 3.00 \\times 10^5) (-3) (0.15) (0.10) = -9450\\,\\mathrm{W}$。\n错误的净通量：$1071000\\,\\mathrm{W} - 9450\\,\\mathrm{W} = 1061550\\,\\mathrm{W} = 1.06155 \\times 10^6\\,\\mathrm{W}$。\n**裁定：错误**\n\n**C. 朴素法：$1.1088\\times 10^6\\,\\mathrm{W}$；钳位法：$1.0872\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0710\\times 10^6\\,\\mathrm{W}$**\n防止回流法的值是正确的。朴素法和钳位法的值是错误的。这个错误源于对对流通量积分的基本误解，具体来说是使用了速度大小 $|u_n|$ 而不是有符号的速度 $u_n$。\n错误的朴素法：$\\rho_d h_d A [u_o(1-f) + u_b f] = (8.4 \\times 10^4)[12.75+0.45] = 1108800\\,\\mathrm{W}$。\n错误的钳位法：外流通量 + $|$回流通量$| = 1071000 + |-16200| = 1087200\\,\\mathrm{W}$。\n**裁定：错误**\n\n**D. 朴素法：$1.0332\\times 10^6\\,\\mathrm{W}$；钳位法：$1.0548\\times 10^6\\,\\mathrm{W}$；防止回流法：$1.0548\\times 10^6\\,\\mathrm{W}$**\n朴素法和钳位法的值是正确的。防止回流法的值是错误的。它错误地将防止回流情况的结果等同于钳位情况。防止回流完全消除了 $u_n$ 被预测为负的那部分边界上的任何通量贡献，而钳位条件允许焓的负（向内）通量。\n**裁定：错误**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}