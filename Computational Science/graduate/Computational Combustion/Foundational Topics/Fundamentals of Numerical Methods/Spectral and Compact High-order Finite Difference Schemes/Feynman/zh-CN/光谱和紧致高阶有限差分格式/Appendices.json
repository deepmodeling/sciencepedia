{
    "hands_on_practices": [
        {
            "introduction": "本练习将介绍伪谱法的核心概念：在傅里叶空间中计算导数。通过使用快速傅里叶变换（FFT）实现微分，您将亲身体验其对于良好解析函数的“谱精度”，同时也将揭示与奈奎斯特频率和混叠相关的关键限制。该练习为您理解谱法在模拟物理现象中的强大功能和潜在缺陷奠定了基础。",
            "id": "4066305",
            "problem": "考虑一个周期性的一维域 $[0,2\\pi)$，该域模拟了计算燃烧学中反应流直接数值模拟（Direct Numerical Simulation）的一个均匀方向，其中物种和温度场需要高保真度的梯度。设 $N$ 表示网格点的数量，均匀网格定义为 $x_j = \\frac{2\\pi}{N} j$，其中 $j \\in \\{0,1,\\dots,N-1\\}$，角度以弧度为单位。设 $f(x)$ 是在此网格上采样的标量场。周期域上的伪谱一阶导数使用离散傅里叶变换（DFT）和快速傅里叶变换（FFT）计算算法，这些是经过充分检验的用于周期性问题的数值工具。\n\n从一个足够光滑的周期函数的傅里叶级数表示以及在网格 $x_j$ 上的相关离散傅里叶变换（DFT）对出发，推导函数 $f(x) = \\sin(kx)$ 的伪谱一阶导数算子，并实现它以计算在 $N=32$ 和 $k=7$ 的情况下网格上的逐点导数。推导必须从标准的DFT定义以及物理空间中的微分对应于谱空间中乘以波数的性质开始，不能预先假定最终的算法。\n\n您必须验证伪谱导数与精确解析导数之间的最大逐点绝对误差为机器零，该值由一个适用于双精度浮点运算的阈值 $T$ 来量化。对于此问题，将机器零定义为 $\\lvert \\text{error} \\rvert \\le T$，其中 $T = 10^{-12}$。\n\n您的程序必须：\n- 使用弧度作为角度单位。\n- 所有测试均使用 $N=32$。\n- 在 $[0,2\\pi)$ 上构建周期性网格 $x_j$。\n- 对于每个测试用例，根据给定的整数 $k$，定义 $f_j = f(x_j)$，其中 $f(x) = \\sin(kx)$。\n- 在周期性网格上使用基于DFT/FFT的方法计算伪谱一阶导数。\n- 计算 $f(x)=\\sin(kx)$ 的精确解析导数，即 $f'(x)=k\\cos(kx)$，并在网格点上求值。\n- 计算整个网格上的最大逐点绝对误差，并返回一个布尔值，指示该误差是否小于或等于 $T$。\n\n测试套件：\n- 一般可分辨模式：$N=32, k=7$。\n- 高频但可分辨模式：$N=32, k=15$。\n- 奈奎斯特模式边缘情况：$N=32, k=16$。\n- 超出奈奎斯特频率的混叠现象：$N=32, k=17$。\n- 平凡的常数导数情况：$N=32, k=0$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”），每个条目都是一个布尔值，表示相应测试用例的最大逐点绝对误差是否小于或等于 $T$，顺序与上面列出的顺序相同。不允许有其他输出。",
            "solution": "该问题是有效的，因为它在科学上基于傅里叶分析和数值方法的原理，问题提法清晰，目标明确，并提供了所有必要的数据，同时以客观、正式的语言表述。这些测试用例是谱方法分析中的标准用例，旨在探究算法在可分辨模式下、奈奎斯特极限处以及混叠情况下的行为。\n\n我们的任务是推导并实现周期函数 $f(x)$ 在域 $[0, 2\\pi)$ 上的伪谱一阶导数算子。推导将从傅里叶级数和离散傅里叶变换（DFT）的原理开始。\n\n设一个足够光滑的 $2\\pi$ 周期函数 $f(x)$ 由其复傅里叶级数表示：\n$$\nf(x) = \\sum_{m=-\\infty}^{\\infty} \\hat{f}_m e^{imx}\n$$\n其中 $\\hat{f}_m$ 是复傅里叶系数，$m$ 是整数波数。对 $x$ 求导得出：\n$$\nf'(x) = \\frac{d}{dx} \\sum_{m=-\\infty}^{\\infty} \\hat{f}_m e^{imx} = \\sum_{m=-\\infty}^{\\infty} (im) \\hat{f}_m e^{imx}\n$$\n这展示了谱方法的基本原理：物理空间中的微分等价于在谱（傅里叶）空间中乘以 $im$，其中 $i = \\sqrt{-1}$。\n\n在计算环境中，连续函数 $f(x)$ 在离散网格上进行采样。问题定义了一个由 $N$ 个点组成的均匀网格 $x_j = \\frac{2\\pi}{N} j$，其中 $j \\in \\{0, 1, \\dots, N-1\\}$。此网格上的函数值表示为 $f_j = f(x_j)$。连续傅里叶级数被离散傅里叶变换（DFT）对所取代。正向DFT（分析变换）和逆向DFT（合成变换）定义如下：\n$$\n\\hat{f}_m^{\\text{DFT}} = \\sum_{j=0}^{N-1} f_j e^{-imx_j} = \\sum_{j=0}^{N-1} f_j e^{-i \\frac{2\\pi mj}{N}}, \\quad m \\in \\{0, 1, \\dots, N-1\\}\n$$\n$$\nf_j = \\frac{1}{N} \\sum_{m=0}^{N-1} \\hat{f}_m^{\\text{DFT}} e^{imx_j} = \\frac{1}{N} \\sum_{m=0}^{N-1} \\hat{f}_m^{\\text{DFT}} e^{i \\frac{2\\pi mj}{N}}, \\quad j \\in \\{0, 1, \\dots, N-1\\}\n$$\n伪谱微分算法利用这个离散框架来近似导数 $f'(x_j)$：\n\n1.  **变换到谱空间**：计算离散函数值 $f_j$ 的DFT以获得谱系数 $\\hat{f}_m^{\\text{DFT}}$。这通常使用快速傅里叶变换（FFT）算法高效完成。\n    $$\n    \\{\\hat{f}_0^{\\text{DFT}}, \\hat{f}_1^{\\text{DFT}}, \\dots, \\hat{f}_{N-1}^{\\text{DFT}}\\} = \\text{FFT}(\\{f_0, f_1, \\dots, f_{N-1}\\})\n    $$\n\n2.  **在谱空间中微分**：将每个谱系数 $\\hat{f}_m^{\\text{DFT}}$ 乘以其对应的有效波数，并再乘以 $i$。DFT索引 $m \\in \\{0, 1, \\dots, N-1\\}$ 必须映射到它们所代表的物理波数。对于实值信号，波数关于零对称。对于偶数个点 $N$，DFT索引按如下方式映射到有效波数向量 $m'_{\\text{eff}}$：\n    -   对于 $0 \\le m  N/2$，索引 $m$ 对应于物理波数 $m' = m$。\n    -   对于 $N/2  m  N$，索引 $m$ 对应于一个负的（混叠的）波数。映射关系为 $m' = m - N$。例如，$m=N-1$ 对应于 $m'=-1$。\n    -   索引 $m=N/2$ 是特殊的，对应于奈奎斯特波数。对于一个实值输入函数 $f_j$，其导数 $f'_j$ 也必须是实数。一个序列 $\\hat{g}_m$ 的逆DFT产生实值结果的充分必要条件是该序列具有厄米对称性，即 $\\hat{g}_m = \\overline{\\hat{g}_{N-m}}$（其中上划线表示复共轭）。让我们将导数的DFT表示为 $\\hat{g}_m = i m'_{\\text{eff}}(m) \\hat{f}_m^{\\text{DFT}}$。对于实数输入 $f_j$，有 $\\hat{f}_m^{\\text{DFT}} = \\overline{\\hat{f}_{N-m}^{\\text{DFT}}}$。对于 $m \\ne 0, N/2$，我们有 $m'_{\\text{eff}}(N-m) = (N-m)-N = -m = -m'_{\\text{eff}}(m)$。那么 $\\hat{g}_{N-m} = i m'_{\\text{eff}}(N-m) \\hat{f}_{N-m}^{\\text{DFT}} = -im'_{\\text{eff}}(m) \\overline{\\hat{f}_m^{\\text{DFT}}} = \\overline{i m'_{\\text{eff}}(m) \\hat{f}_m^{\\text{DFT}}} = \\overline{\\hat{g}_m}$。对称性成立。然而，在奈奎斯特频率 $m=N/2$ 处，$m' = N/2$。对于实信号，$\\hat{f}_{N/2}^{\\text{DFT}}$ 必须是一个实数。微分将得到 $\\hat{g}_{N/2} = i(N/2)\\hat{f}_{N/2}^{\\text{DFT}}$，这是一个纯虚数。这破坏了厄米对称性，因为除非 $\\hat{g}_{N/2}$ 为零，否则 $\\hat{g}_{N/2} \\ne \\overline{\\hat{g}_{N/2}}$。为确保实函数的导数保持为实数，一个常见的约定是将奈奎斯特模式的导数设为零。\n\n    因此，应用于DFT索引 $m \\in \\{0, 1, \\dots, N-1\\}$ 的有效波数向量 $m'_{\\text{eff}}$ 是：\n    $$\n    m'_{\\text{eff}}(m) = \\begin{cases} m  \\text{if } 0 \\le m  N/2 \\\\ 0  \\text{if } m = N/2 \\\\ m-N  \\text{if } N/2  m  N \\end{cases}\n    $$\n    导数的谱系数 $\\hat{g}_m^{\\text{DFT}}$ 随后计算如下：\n    $$\n    \\hat{g}_m^{\\text{DFT}} = i m'_{\\text{eff}}(m) \\hat{f}_m^{\\text{DFT}}\n    $$\n\n3.  **变换回物理空间**：计算修正后的谱系数 $\\hat{g}_m^{\\text{DFT}}$ 的逆DFT，以获得网格上的导数值 $f'_j$。\n    $$\n    \\{f'_0, f'_1, \\dots, f'_{N-1}\\} = \\text{IFFT}(\\{\\hat{g}_0^{\\text{DFT}}, \\hat{g}_1^{\\text{DFT}}, \\dots, \\hat{g}_{N-1}^{\\text{DFT}}\\})\n    $$\n\n对于函数 $f(x) = \\sin(kx) = \\frac{e^{ikx} - e^{-ikx}}{2i}$，其解析导数为 $f'(x) = k\\cos(kx)$。\n-   **情况 $k=7$ 和 $k=15$ ($N=32$)：** 由于 $0  k  N/2 = 16$，波数可以被网格很好地分辨。DFT可以精确表示两个正弦分量 $e^{ikx}$ 和 $e^{-ikx}$。伪谱导数将是数值精确的，误差将在机器精度级别。与 $T=10^{-12}$ 的布尔值检查应为真。\n-   **情况 $k=16$ ($N=32$)：** 这是奈奎斯特波数，$k=N/2$。网格上的函数值为 $f_j = \\sin(16 \\cdot \\frac{2\\pi j}{32}) = \\sin(\\pi j) = 0$（对所有 $j$）。全零向量的DFT是全零向量。因此，数值导数为零。而解析导数为 $f'(x_j) = 16\\cos(16x_j) = 16\\cos(\\pi j) = 16(-1)^j$。数值和解析结果显著不同，因此误差会很大。布尔值检查将为假。\n-   **情况 $k=17$ ($N=32$)：** 这个波数超出了奈奎斯特极限，$|k|>N/2$。信号发生了混叠。在网格上，频率 $k=17$ 与频率 $k' = k-N = 17-32 = -15$ 是无法区分的。也就是说，$\\sin(17x_j) = \\sin((32-15)x_j) = \\sin(2\\pi j - 15x_j) = \\sin(-15x_j) = -\\sin(15x_j)$。数值方法将计算 $-\\sin(15x)$ 的导数，即 $-15\\cos(15x)$。这不等于真实的导数 $17\\cos(17x)$。误差会很大，布尔值检查将为假。\n-   **情况 $k=0$ ($N=32$)：** 函数为 $f(x) = \\sin(0) = 0$（对所有 $x$）。数值导数为零。解析导数为 $f'(x) = 0 \\cdot \\cos(0) = 0$。误差恒为零。布尔值检查将为真。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the pseudo-spectral derivative for f(x) = sin(kx) on a periodic grid\n    and verifies its accuracy against the analytical derivative for several test cases.\n    \"\"\"\n    # Define problem constants\n    N = 32\n    T = 1e-12\n\n    # Define the test suite of wavenumbers k\n    test_cases = [\n        7,  # General resolvable mode\n        15, # High but resolvable mode\n        16, # Nyquist mode edge case\n        17, # Aliasing beyond Nyquist\n        0,  # Trivial constant derivative case\n    ]\n\n    results = []\n    \n    # Construct the periodic grid\n    # x_j = (2*pi/N) * j for j in {0, ..., N-1}\n    x_grid = (2 * np.pi / N) * np.arange(N)\n\n    # Define the effective wavenumbers for differentiation\n    # For a real signal, the derivative of the Nyquist component is set to 0\n    # to ensure the resulting derivative is also real.\n    m_eff = np.fft.fftfreq(N, d=1.0/N) # This is equivalent to np.fft.fftfreq(N) * N\n    # Set the derivative of the Nyquist mode to zero\n    if N % 2 == 0:\n        m_eff[N // 2] = 0.0\n\n    for k in test_cases:\n        # 1. Define the function f(x) = sin(kx) on the grid\n        f_vals = np.sin(k * x_grid)\n\n        # 2. Compute the pseudo-spectral first derivative\n        # a. Forward FFT to get spectral coefficients\n        f_hat = np.fft.fft(f_vals)\n\n        # b. Multiply by i*m_eff in spectral space\n        df_hat = 1j * m_eff * f_hat\n\n        # c. Inverse FFT to get derivative in physical space\n        # Result should be real; take the real part to discard negligible\n        # imaginary components from floating-point inaccuracies.\n        df_dx_spectral = np.real(np.fft.ifft(df_hat))\n\n        # 3. Compute the exact analytical derivative f'(x) = k*cos(kx) on the grid\n        df_dx_analytical = k * np.cos(k * x_grid)\n\n        # 4. Compute the maximum pointwise absolute error\n        max_abs_error = np.max(np.abs(df_dx_spectral - df_dx_analytical))\n\n        # 5. Verify if the error is within the specified tolerance T\n        results.append(max_abs_error = T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, [r.item() for r in results]))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "接下来，我们将从谱方法转向另一类高阶离散格式：紧致有限差分格式。您将运用泰勒级数分析这一数值方法的基石，来推导一个四阶精度格式的系数。这项理论性练习与第一个计算实践形成了有益的对比，加深了您对高阶精度如何被严格实现的理解。",
            "id": "4066280",
            "problem": "考虑一个用于计算流体动力学（CFD）中计算燃烧学的一维反应混合物，其分子扩散系数恒定，并分布在均匀网格上。设 $u(x)$ 是一个光滑标量场（例如，某组分的质量分数），在间距为 $h$ 的均匀节点 $x_i = x_0 + i h$ 上采样。您的目标是构建一个紧致、中心、四阶精度的有限差分格式来近似二阶导数 $u''(x_i)$，该格式在所有网格点上组装时会产生一个五对角线的左侧矩阵。\n\n假设采用周期性边界条件，以便内部公式适用于所有节点。寻求一个形如下式的对称紧致关系\n$$\na\\,u''_{i-2} + b\\,u''_{i-1} + c\\,u''_{i} + b\\,u''_{i+1} + a\\,u''_{i+2}\n= \\frac{1}{h^{2}}\\left[ A\\left(u_{i-2} - 2 u_{i} + u_{i+2}\\right) + B\\left(u_{i-1} - 2 u_{i} + u_{i+1}\\right) \\right],\n$$\n其中 $a$、$b$、$c$、$A$ 和 $B$ 是与 $i$ 无关的常数，且模板是中心对称的。为了保证唯一性并最小化显式算子的计算带宽，施加归一化和带宽约束 $c = 1$、$A = 0$ 和 $B = 1$。\n\n使用关于 $x_i$ 的泰勒级数展开，通过匹配截至 $\\mathcal{O}(h^{2})$ 的各项来强制格式具有四阶相容性，然后确定主导阶的局部截断误差。具体要求如下：\n\n- 确定 $a$ 和 $b$，使得该格式对于 $u''(x_i)$ 是相容的且达到四阶精度。\n- 通过执行泰勒展开来验证精度阶数，并确定首个非零截断项。\n- 以 $C_{\\mathrm{TE}}\\,h^{4}\\,u^{(6)}(x_i)$ 的形式报告主导局部截断误差，给出常数 $C_{\\mathrm{TE}}$ 的精确有理数值。\n\n将最终答案表示为一个行矩阵，其中包含五个格式系数和截断误差常数，顺序为 $\\left(a,\\,b,\\,c,\\,A,\\,B,\\,C_{\\mathrm{TE}}\\right)$。提供精确的有理数值（不要四舍五入）。",
            "solution": "目标是为给定的紧致有限差分格式确定系数 $a$ 和 $b$，以达到四阶精度，并找到相应的主导截断误差。\n\n首先，我们将给定的约束条件 $c=1$、$A=0$ 和 $B=1$ 应用到格式的一般形式中。这可将方程简化为：\n$$\na\\,u''_{i-2} + b\\,u''_{i-1} + u''_{i} + b\\,u''_{i+1} + a\\,u''_{i+2}\n= \\frac{1}{h^{2}}\\left(u_{i-1} - 2 u_{i} + u_{i+1}\\right)\n$$\n局部截断误差 $T_i$ 是通过将精确解 $u(x)$ 代入格式来定义的。如果格式是完美的，对于精确解，重新排列各项后应有 $T_i=0$。\n$$\nT_i = \\left( a u''_{i-2} + b u''_{i-1} + u''_{i} + b u''_{i+1} + a u''_{i+2} \\right) - \\frac{1}{h^2} \\left( u_{i-1} - 2u_i + u_{i+1} \\right)\n$$\n为确定系数和精度阶数，我们假设 $u(x)$ 足够光滑，并将每一项在点 $x_i$ 附近进行泰勒级数展开。设 $u_i^{(n)}$ 表示 $u$ 在 $x_i$ 处的 $n$ 阶导数。\n\n函数值的展开式为：\n$$\nu_{i \\pm k} = u(x_i \\pm kh) = u_i \\pm (kh)u_i' + \\frac{(kh)^2}{2!}u_i'' \\pm \\frac{(kh)^3}{3!}u_i''' + \\frac{(kh)^4}{4!}u_i^{(4)} \\pm \\frac{(kh)^5}{5!}u_i^{(5)} + \\frac{(kh)^6}{6!}u_i^{(6)} + \\mathcal{O}(h^7)\n$$\n右侧（RHS）算子包含标准的二阶中心差分模板：\n$$\nu_{i-1} - 2u_i + u_{i+1} = \\left(u_i - hu_i' + \\frac{h^2}{2}u_i'' - \\dots\\right) - 2u_i + \\left(u_i + hu_i' + \\frac{h^2}{2}u_i'' + \\dots\\right)\n$$\n通过对 $u_{i+1}$ 和 $u_{i-1}$ 的级数求和，$h$ 的奇次幂项相互抵消：\n$$\nu_{i-1} - 2u_i + u_{i+1} = 2\\left(\\frac{h^2}{2}u_i'' + \\frac{h^4}{24}u_i^{(4)} + \\frac{h^6}{720}u_i^{(6)}\\right) + \\mathcal{O}(h^8) = h^2 u_i'' + \\frac{h^4}{12}u_i^{(4)} + \\frac{h^6}{360}u_i^{(6)} + \\mathcal{O}(h^8)\n$$\n因此，截断误差表达式的右侧为：\n$$\n\\frac{1}{h^2}\\left(u_{i-1} - 2u_i + u_{i+1}\\right) = u_i'' + \\frac{h^2}{12}u_i^{(4)} + \\frac{h^4}{360}u_i^{(6)} + \\mathcal{O}(h^6)\n$$\n接下来，我们展开截断误差表达式左侧（LHS）的各项。二阶导数值的展开式为：\n$$\nu''_{i \\pm k} = u''(x_i \\pm kh) = u_i'' \\pm (kh)u_i''' + \\frac{(kh)^2}{2!}u_i^{(4)} \\pm \\frac{(kh)^3}{3!}u_i^{(5)} + \\frac{(kh)^4}{4!}u_i^{(6)} + \\mathcal{O}(h^5)\n$$\n由于对称性，我们合并各项：\n$$\nu''_{i-k} + u''_{i+k} = 2u_i'' + (kh)^2 u_i^{(4)} + \\frac{(kh)^4}{12}u_i^{(6)} + \\mathcal{O}(h^6)\n$$\n对于 $k=1$：\n$$u''_{i-1} + u''_{i+1} = 2u_i'' + h^2 u_i^{(4)} + \\frac{h^4}{12}u_i^{(6)} + \\mathcal{O}(h^6)$$\n对于 $k=2$：\n$$u''_{i-2} + u''_{i+2} = 2u_i'' + (2h)^2 u_i^{(4)} + \\frac{(2h)^4}{12}u_i^{(6)} + \\mathcal{O}(h^6) = 2u_i'' + 4h^2 u_i^{(4)} + \\frac{4}{3}h^4 u_i^{(6)} + \\mathcal{O}(h^6)$$\n将这些代入截断误差表达式的左侧：\n$$\n\\text{LHS} = a(2u_i'' + 4h^2 u_i^{(4)} + \\frac{4}{3}h^4 u_i^{(6)}) + b(2u_i'' + h^2 u_i^{(4)} + \\frac{h^4}{12}u_i^{(6)}) + u_i'' + \\mathcal{O}(h^6)\n$$\n按导数阶数对各项进行分组：\n$$\n\\text{LHS} = (1+2a+2b)u_i'' + (4a+b)h^2 u_i^{(4)} + \\left(\\frac{4a}{3} + \\frac{b}{12}\\right)h^4 u_i^{(6)} + \\mathcal{O}(h^6)\n$$\n现在我们组合出截断误差 $T_i = \\text{LHS} - \\text{RHS}$ 的完整表达式：\n$$\nT_i = \\left[(1+2a+2b)u_i'' + \\dots\\right] - \\left[u_i'' + \\frac{h^2}{12}u_i^{(4)} + \\dots\\right]\n$$\n$$\nT_i = (2a+2b)u_i'' + \\left(4a+b - \\frac{1}{12}\\right)h^2 u_i^{(4)} + \\left(\\frac{4a}{3} + \\frac{b}{12} - \\frac{1}{360}\\right)h^4 u_i^{(6)} + \\mathcal{O}(h^6)\n$$\n为使格式达到四阶精度，截断误差必须为 $\\mathcal{O}(h^4)$。这要求 $u_i''$ 和 $h^2 u_i^{(4)}$ 的系数为零。\n1. $u_i''$ 的系数：\n$$2a+2b=0 \\implies a = -b$$\n2. $h^2 u_i^{(4)}$ 的系数：\n$$4a+b - \\frac{1}{12} = 0$$\n将 $a=-b$ 代入第二个方程：\n$$4(-b) + b - \\frac{1}{12} = 0 \\implies -3b = \\frac{1}{12} \\implies b = -\\frac{1}{36}$$\n由 $a=-b$，我们得到：\n$$a = \\frac{1}{36}$$\n问题陈述中施加的约束是 $c=1$、$A=0$ 和 $B=1$。\n\n当 $a = 1/36$ 且 $b = -1/36$ 时，截断误差中截至 $\\mathcal{O}(h^2)$ 的项都为零。主导项是与 $h^4$ 成正比的项：\n$$\nT_i = \\left(\\frac{4a}{3} + \\frac{b}{12} - \\frac{1}{360}\\right)h^4 u_i^{(6)} + \\mathcal{O}(h^6)\n$$\n这就是主导局部截断误差，其形式为 $C_{\\mathrm{TE}} h^4 u_i^{(6)}$。常数 $C_{\\mathrm{TE}}$ 为：\n$$\nC_{\\mathrm{TE}} = \\frac{4a}{3} + \\frac{b}{12} - \\frac{1}{360}\n$$\n代入 $a$ 和 $b$ 的值：\n$$\nC_{\\mathrm{TE}} = \\frac{4}{3}\\left(\\frac{1}{36}\\right) + \\frac{1}{12}\\left(-\\frac{1}{36}\\right) - \\frac{1}{360} = \\frac{1}{27} - \\frac{1}{432} - \\frac{1}{360}\n$$\n为计算这些分数的和，我们找到一个公分母。素因数分解为 $27=3^3$、$432 = 2^4 \\cdot 3^3$ 和 $360 = 2^3 \\cdot 3^2 \\cdot 5$。最小公倍数是 $2^4 \\cdot 3^3 \\cdot 5 = 16 \\cdot 27 \\cdot 5 = 2160$。\n$$\nC_{\\mathrm{TE}} = \\frac{1 \\cdot 80}{27 \\cdot 80} - \\frac{1 \\cdot 5}{432 \\cdot 5} - \\frac{1 \\cdot 6}{360 \\cdot 6} = \\frac{80}{2160} - \\frac{5}{2160} - \\frac{6}{2160} = \\frac{80 - 11}{2160} = \\frac{69}{2160}\n$$\n这个分数可以通过分子分母同除以最大公约数 $3$ 来化简：\n$$\nC_{\\mathrm{TE}} = \\frac{69 \\div 3}{2160 \\div 3} = \\frac{23}{720}\n$$\n因此，主导局部截断误差是 $\\frac{23}{720}h^4 u^{(6)}_i$。\n\n所求的值为：\n- $a = \\frac{1}{36}$\n- $b = -\\frac{1}{36}$\n- $c = 1$ (给定)\n- $A = 0$ (给定)\n- $B = 1$ (给定)\n- $C_{\\mathrm{TE}} = \\frac{23}{720}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{36}  -\\frac{1}{36}  1  0  1  \\frac{23}{720} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "对于任何有意义的模拟而言，一个稳定的数值格式是必不可少的。这最后一个练习将高阶紧致空间离散的概念与时间推进方法相结合，以探讨数值稳定性。通过执行傅里叶-冯·诺依曼稳定性分析，您将确定一个扩散问题的最大允许时间步长，并对比显式格式的条件稳定性与隐式格式的无条件稳定性。",
            "id": "4066301",
            "problem": "在计算燃烧学的预混火焰模拟中，温度或物质的扩散传输可以局部地理想化为一维热方程。考虑定义在间距为 $\\Delta x$ 的均匀周期性网格上的纯扩散方程 $u_{t}=\\nu\\,u_{xx}$，其空间项采用二阶导数的六阶紧致三对角格式进行近似。紧致拉普拉斯算子由以下关系式隐式定义\n$$\n\\alpha\\,\\delta^{(2)} u_{j-1}+\\delta^{(2)} u_{j}+\\alpha\\,\\delta^{(2)} u_{j+1}\n=\\frac{1}{\\Delta x^{2}}\\Big[a\\,(u_{j-1}-2u_{j}+u_{j+1})+b\\,(u_{j-2}-2u_{j}+u_{j+2})\\Big],\n$$\n其中 $\\delta^{(2)} u_{j}$ 表示在网格点 $x_{j}$ 处对 $u_{xx}$ 的有限差分近似，常数 $\\alpha$、$a$ 和 $b$ 的选择使得 $\\delta^{(2)}$ 的截断误差为 $\\mathcal{O}(\\Delta x^{6})$。\n\n仅使用泰勒级数一致性和对周期性网格进行的傅里叶模态分析（使用无量纲波数，单位为弧度），确定将此空间离散格式与 Forward Euler (FE) 时间积分器耦合所得到的全离散格式对所有可分辨的傅里叶模态保持线性稳定的最大无量纲时间步长比 $C_{\\max}=\\nu\\,\\Delta t/\\Delta x^{2}$。然后，通过报告将 Crank–Nicolson (CN) 时间积分器应用于相同空间离散格式时对应的 $C_{\\max}$，与前者进行比较。\n\n您的答案必须是一个数对，按顺序给出 Forward Euler 和 Crank–Nicolson 的最大稳定比率。以闭合形式表示所有精确值，无需四舍五入。最终答案中不包含单位。",
            "solution": "该问题要求解一维扩散方程 $u_t = \\nu u_{xx}$ 的最大稳定无量纲时间步长比 $C_{\\max} = \\nu \\Delta t / \\Delta x^2$。该方程的空间导数使用六阶紧致有限差分格式进行离散，并采用两种不同的时间积分器：Forward Euler (FE) 和 Crank-Nicolson (CN)。\n\n求解过程包括三个主要部分：\n1.  确定六阶紧致空间格式的系数。\n2.  对 FE 时间积分器进行 von Neumann 稳定性分析，以求得 $C_{\\max, FE}$。\n3.  对 CN 时间积分器进行 von Neumann 稳定性分析，以求得 $C_{\\max, CN}$。\n\n**第一部分：确定紧致格式的系数**\n\n在网格点 $x_j$ 处，二阶导数 $u_{xx}$ 的六阶紧致近似 $\\delta^{(2)}u_j$ 定义为：\n$$\n\\alpha\\,\\delta^{(2)} u_{j-1}+\\delta^{(2)} u_{j}+\\alpha\\,\\delta^{(2)} u_{j+1}\n=\\frac{1}{\\Delta x^{2}}\\Big[a\\,(u_{j-1}-2u_{j}+u_{j+1})+b\\,(u_{j-2}-2u_{j}+u_{j+2})\\Big]\n$$\n为了找到确保六阶精度的系数 $\\alpha$、$a$ 和 $b$，我们在傅里叶空间中分析该格式。设 $u_j = \\exp(i k x_j) = \\exp(i k j \\Delta x)$。精确的二阶导数为 $u_{xx} = -k^2 u_j$。数值近似可以写为 $\\delta^{(2)} u_j = -(k')^2 u_j$，其中 $k'$ 是修正波数。令 $\\xi = k \\Delta x$ 为无量纲波数。\n\n将傅里叶模态 $u_j = \\exp(i j \\xi)$ 代入定义关系式得到：\n$$\n-(k')^2 \\left( \\alpha e^{-i\\xi} + 1 + \\alpha e^{i\\xi} \\right) u_j = \\frac{1}{\\Delta x^2} \\left( a(e^{-i\\xi} - 2 + e^{i\\xi}) + b(e^{-2i\\xi} - 2 + e^{2i\\xi}) \\right) u_j\n$$\n化简后为：\n$$\n-(k')^2 (1 + 2\\alpha \\cos\\xi) = \\frac{1}{\\Delta x^2} \\left( 2a(\\cos\\xi - 1) + 2b(\\cos(2\\xi) - 1) \\right)\n$$\n求解 $(k')^2$：\n$$\n(k')^2 = \\frac{1}{\\Delta x^2} \\frac{2a(1-\\cos\\xi) + 2b(1-\\cos(2\\xi))}{1+2\\alpha\\cos\\xi}\n$$\n使用恒等式 $1-\\cos\\xi = 2\\sin^2(\\xi/2)$ 和 $1-\\cos(2\\xi) = 2\\sin^2(\\xi)$，我们得到：\n$$\n(k'\\Delta x)^2 = \\frac{4a\\sin^2(\\xi/2) + 4b\\sin^2(\\xi)}{1+2\\alpha\\cos\\xi}\n$$\n为达到六阶精度，空间算子的截断误差必须为 $\\mathcal{O}(\\Delta x^6)$。这意味着数值算子的符号 $(k'\\Delta x)^2$ 必须与精确算子的符号 $(k\\Delta x)^2 = \\xi^2$ 匹配，直到 $\\mathcal{O}(\\xi^8)$ 的项。\n$$\n\\frac{4a\\sin^2(\\xi/2) + 4b\\sin^2(\\xi)}{1+2\\alpha\\cos\\xi} = \\xi^2 + \\mathcal{O}(\\xi^8)\n$$\n这可以重写为：\n$$\n4a\\sin^2(\\xi/2) + 4b\\sin^2(\\xi) = \\xi^2(1+2\\alpha\\cos\\xi) + \\mathcal{O}(\\xi^8)\n$$\n我们在 $\\xi=0$ 附近将两边展开为泰勒级数：\n左侧 (LHS) 为：\n$$\n\\text{LHS} = 4a\\left(\\frac{\\xi^2}{4}-\\frac{\\xi^4}{48}+\\frac{\\xi^6}{1440} - \\dots\\right) + 4b\\left(\\xi^2-\\frac{\\xi^4}{3}+\\frac{2\\xi^6}{45} - \\dots\\right)\n$$\n$$\n\\text{LHS} = (a+4b)\\xi^2 - \\left(\\frac{a}{12}+\\frac{4b}{3}\\right)\\xi^4 + \\left(\\frac{a}{360}+\\frac{8b}{45}\\right)\\xi^6 + \\mathcal{O}(\\xi^8)\n$$\n右侧 (RHS) 为：\n$$\n\\text{RHS} = \\xi^2\\left[1+2\\alpha\\left(1-\\frac{\\xi^2}{2}+\\frac{\\xi^4}{24}-\\frac{\\xi^6}{720}+\\dots\\right)\\right]\n$$\n$$\n\\text{RHS} = (1+2\\alpha)\\xi^2 - \\alpha\\xi^4 + \\frac{\\alpha}{12}\\xi^6 - \\frac{\\alpha}{360}\\xi^8 + \\mathcal{O}(\\xi^{10})\n$$\n匹配 $\\xi^2$、$\\xi^4$ 和 $\\xi^6$ 次方的系数：\n1.  $\\xi^2$: $a+4b = 1+2\\alpha \\implies a+4b-2\\alpha = 1$\n2.  $\\xi^4$: $-\\left(\\frac{a}{12}+\\frac{4b}{3}\\right) = -\\alpha \\implies a+16b = 12\\alpha \\implies a+16b-12\\alpha = 0$\n3.  $\\xi^6$: $\\frac{a}{360}+\\frac{8b}{45} = \\frac{\\alpha}{12} \\implies a+64b = 30\\alpha \\implies a+64b-30\\alpha = 0$\n\n我们求解这个线性系统。将(2)式减去(1)式得到 $12b-10\\alpha = -1$。将(3)式减去(2)式得到 $48b-18\\alpha=0$，化简为 $8b = 3\\alpha$，即 $\\alpha = \\frac{8}{3}b$。\n将此代入 $12b-10\\alpha=-1$：\n$$\n12b - 10\\left(\\frac{8}{3}b\\right) = -1 \\implies 12b - \\frac{80}{3}b = -1 \\implies \\frac{36-80}{3}b = -1 \\implies -\\frac{44}{3}b = -1 \\implies b = \\frac{3}{44}\n$$\n现在我们求解 $\\alpha$ 和 $a$：\n$$\n\\alpha = \\frac{8}{3}b = \\frac{8}{3}\\left(\\frac{3}{44}\\right) = \\frac{8}{44} = \\frac{2}{11}\n$$\n$$\na = 1 - 4b + 2\\alpha = 1 - 4\\left(\\frac{3}{44}\\right) + 2\\left(\\frac{2}{11}\\right) = 1 - \\frac{3}{11} + \\frac{4}{11} = 1 + \\frac{1}{11} = \\frac{12}{11}\n$$\n系数为 $\\alpha = \\frac{2}{11}$，$a = \\frac{12}{11}$ 和 $b = \\frac{3}{44}$。\n\n**第二部分：Forward Euler 格式的稳定性**\n\n半离散方程为 $\\frac{du_j}{dt} = \\nu \\delta^{(2)} u_j$。在傅里叶空间中，这变为 $\\frac{d\\hat{u}}{dt} = \\nu \\lambda(\\xi) \\hat{u}$，其中 $\\lambda(\\xi)$ 是 $\\delta^{(2)}$ 算子的符号：\n$$\n\\lambda(\\xi) = -(k')^2 = -\\frac{1}{\\Delta x^2} \\frac{4a\\sin^2(\\xi/2) + 4b\\sin^2(\\xi)}{1+2\\alpha\\cos\\xi}\n$$\n我们定义一个非负函数 $f(\\xi)$：\n$$\nf(\\xi) = \\frac{4a\\sin^2(\\xi/2) + 4b\\sin^2(\\xi)}{1+2\\alpha\\cos\\xi}\n$$\n因此 $\\lambda(\\xi) = -f(\\xi)/\\Delta x^2$。Forward Euler 格式为 $u_j^{n+1} = u_j^n + \\Delta t (\\nu \\delta^{(2)} u_j^n)$。放大因子 $G(\\xi)$ 为：\n$$\nG_{FE}(\\xi) = 1 + \\nu \\Delta t \\lambda(\\xi) = 1 - \\frac{\\nu \\Delta t}{\\Delta x^2} f(\\xi) = 1 - C f(\\xi)\n$$\n其中 $C = \\nu \\Delta t / \\Delta x^2$。为了保证稳定性，对所有 $\\xi \\in [-\\pi, \\pi]$ 都必须有 $|G_{FE}(\\xi)| \\le 1$。因为 $C > 0$ 且 $f(\\xi) \\ge 0$，该条件变为：\n$$\n-1 \\le 1 - C f(\\xi) \\le 1 \\implies C f(\\xi) \\le 2\n$$\n此式必须对所有 $\\xi$ 成立，因此我们要求 $C \\cdot \\max_{\\xi} f(\\xi) \\le 2$。因此，最大稳定时间步长为：\n$$\nC_{\\max, FE} = \\frac{2}{\\max_{\\xi \\in [-\\pi, \\pi]} f(\\xi)}\n$$\n我们必须找到 $f(\\xi)$ 的最大值。代入系数：\n$$\nf(\\xi) = \\frac{4\\left(\\frac{12}{11}\\right)\\sin^2(\\frac{\\xi}{2}) + 4\\left(\\frac{3}{44}\\right)\\sin^2(\\xi)}{1+2\\left(\\frac{2}{11}\\right)\\cos\\xi} = \\frac{\\frac{48}{11}\\sin^2(\\frac{\\xi}{2}) + \\frac{3}{11}\\sin^2(\\xi)}{1+\\frac{4}{11}\\cos\\xi} = \\frac{48\\sin^2(\\frac{\\xi}{2}) + 3\\sin^2(\\xi)}{11+4\\cos\\xi}\n$$\n使用 $\\sin^2(\\frac{\\xi}{2}) = \\frac{1-\\cos\\xi}{2}$ 和 $\\sin^2(\\xi)=1-\\cos^2\\xi$：\n$$\nf(\\xi) = \\frac{48\\left(\\frac{1-\\cos\\xi}{2}\\right) + 3(1-\\cos^2\\xi)}{11+4\\cos\\xi} = \\frac{24(1-\\cos\\xi) + 3(1-\\cos\\xi)(1+\\cos\\xi)}{11+4\\cos\\xi} = \\frac{(1-\\cos\\xi)(24 + 3(1+\\cos\\xi))}{11+4\\cos\\xi} = \\frac{(1-\\cos\\xi)(27+3\\cos\\xi)}{11+4\\cos\\xi}\n$$\n令 $y = \\cos\\xi$。当 $\\xi$ 在 $[-\\pi, \\pi]$ 范围内变化时，$y$ 在 $[-1, 1]$ 范围内变化。我们要求函数 $g(y) = \\frac{(1-y)(27+3y)}{11+4y}$ 在 $y \\in [-1, 1]$ 上的最大值。\n其导数 $g'(y)$ 的分子为 $-12y^2-66y-372 = -6(2y^2+11y+62)$。二次式 $2y^2+11y+62$ 的判别式为 $11^2 - 4(2)(62) = 121 - 496  0$。由于首项系数为正，该二次式恒为正。因此，分子恒为负，所以 $g'(y)  0$。\n函数 $g(y)$ 在其定义域上是单调递减的。在区间 $y \\in [-1, 1]$ 上的最大值出现在左端点 $y=-1$ 处。这对应于 $\\xi = \\pm\\pi$。\n$$\n\\max_{\\xi} f(\\xi) = g(-1) = \\frac{(1 - (-1))(27 + 3(-1))}{11 + 4(-1)} = \\frac{(2)(24)}{7} = \\frac{48}{7}\n$$\nForward Euler 格式的最大稳定 Courant 数为：\n$$\nC_{\\max, FE} = \\frac{2}{48/7} = \\frac{14}{48} = \\frac{7}{24}\n$$\n\n**第三部分：Crank-Nicolson 格式的稳定性**\n\nCrank-Nicolson 格式为 $u_j^{n+1} = u_j^n + \\frac{\\Delta t}{2} \\nu (\\delta^{(2)} u_j^{n+1} + \\delta^{(2)} u_j^n)$。其放大因子为：\n$$\nG_{CN}(\\xi) = \\frac{1 + \\frac{1}{2} \\nu \\Delta t \\lambda(\\xi)}{1 - \\frac{1}{2} \\nu \\Delta t \\lambda(\\xi)} = \\frac{1 - \\frac{1}{2} C f(\\xi)}{1 + \\frac{1}{2} C f(\\xi)}\n$$\n为了保证稳定性，我们要求 $|G_{CN}(\\xi)| \\le 1$。令 $X = \\frac{1}{2} C f(\\xi)$。由于 $C>0$ 且我们已证明 $f(\\xi) \\ge 0$，所以有 $X \\ge 0$。稳定性条件是：\n$$\n\\left| \\frac{1-X}{1+X} \\right| \\le 1\n$$\n因为 $X$ 是一个非负实数，所以 $1+X \\ge 1$。其模为 $|1-X|/(1+X)$。\n$$\n|1-X| \\le 1+X\n$$\n两边平方（这是有效的，因为两边都是非负的）：\n$$\n(1-X)^2 \\le (1+X)^2 \\implies 1 - 2X + X^2 \\le 1 + 2X + X^2 \\implies -2X \\le 2X \\implies 0 \\le 4X\n$$\n此不等式对所有 $X \\ge 0$ 都成立。这意味着对于任何 $C \\ge 0$ 的选择，稳定性条件都得到满足。对于此问题，Crank-Nicolson 格式是无条件稳定的。因此，最大稳定时间步长比是无限的。\n$$\nC_{\\max, CN} = \\infty\n$$\n\n最终答案是分别是 Forward Euler 和 Crank-Nicolson 格式的最大稳定比率对。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{7}{24}  \\infty \\end{pmatrix}}\n$$"
        }
    ]
}