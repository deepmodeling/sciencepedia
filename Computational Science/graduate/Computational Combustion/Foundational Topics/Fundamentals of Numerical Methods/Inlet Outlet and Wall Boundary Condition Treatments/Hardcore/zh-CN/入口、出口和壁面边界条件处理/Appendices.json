{
    "hands_on_practices": [
        {
            "introduction": "在任何流体模拟中，壁面边界都是最基本的组成部分。本练习将指导您从第一性原理出发，实现最常见的壁面条件——滑移/无滑移与绝热/等温。通过推导和应用虚拟单元（ghost-cell）的数值，您将亲身体验数值方法如何在固体表面强制施加物理定律，这是计算流体动力学从业者的一项关键技能 ()。",
            "id": "4032103",
            "problem": "我们要求您在应用于燃烧流的计算流体动力学（CFD）的有限体积法（FVM）中，实现物理上一致的壁面边界条件处理。重点是一个单位法线方向的平面壁面边界，以及为速度场和温度场强制执行物理上正确的行为而一致地构建虚拟单元值。此任务必须从基本原理解决：速度的不可穿透性和滑移与无滑移行为，以及温度的绝热与等温行为。您必须形式化并计算虚拟单元值，以确保可压缩流求解的正确壁面约束。您不得依赖任何捷径或预先给定的公式；相反，您的解决方案必须从基本定律推导出所需内容。您的最终程序必须为一组指定情况计算切向速度的虚拟单元值和温度的虚拟单元值。\n\n物理设置为二维笛卡尔均匀网格，带有一个任意排列的平面壁面。设壁面局部由平面上的单位法向量 $\\,\\mathbf{n}\\,$ 表示。设邻近壁面的第一个内部单元中心处的流体速度表示为 $\\,\\mathbf{u}_0\\,$（单位为 $\\mathrm{m/s}$），该中心处的温度为 $\\,T_0\\,$（单位为 $\\mathrm{K}$）。设等温情况下的壁面温度为 $\\,T_w\\,$（单位为 $\\mathrm{K}$）。在一个以单元为中心的有限体积离散化中，为进行数值强制，假设壁面位于第一个内部单元中心和虚拟单元中心沿壁面法线方向的中点。您必须计算与以下物理定义的边界类型一致的虚拟单元值：\n\n1. 不可穿透壁面：壁面处的法向速度满足 $\\,\\mathbf{u}\\cdot\\mathbf{n} = 0\\,$。\n2. 滑移壁面（无粘）：壁面处的剪切应力为零，这意味着切向速度沿壁面法线方向的法向梯度为零。\n3. 无滑移壁面（有粘）：壁面处的法向速度和切向速度都必须为零。\n4. 绝热壁面：法向热通量满足 $\\,\\mathbf{q}\\cdot\\mathbf{n} = 0\\,$，其中 $\\,\\mathbf{q} = -k\\,\\nabla T\\,$ 是传导热通量，意味着壁面处的法向温度梯度为零。\n5. 等温壁面：壁面处的温度是预设的，等于 $\\,T_w\\,$。\n\n您必须将内部速度 $\\,\\mathbf{u}_0\\,$ 投影到壁面法向和壁面切向方向上，强制执行适当的壁面约束以确定虚拟单元值，然后报告虚拟单元速度的标量切向分量和虚拟单元温度。您必须将速度解释为 $\\mathrm{m/s}$，温度解释为 $\\mathrm{K}$。\n\n您的程序必须为以下测试套件实现上述要求，其中每个案例都指定了壁面法线 $\\,\\mathbf{n}\\,$、内部速度 $\\,\\mathbf{u}_0\\,$、内部温度 $\\,T_0\\,$、速度边界类型（滑移或无滑移）以及热边界类型（绝热或等温，并在适用时指定 $\\,T_w\\,$）。单位法线必须作为通用情况处理，切线方向必须选择为与法线正交。\n\n测试套件：\n- 案例 $\\,1\\,$：$\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (1.5,-2.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 800\\,$ $\\mathrm{K}$, 滑移和绝热。\n- 案例 $\\,2\\,$：$\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (3.0,4.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 1100\\,$ $\\mathrm{K}$, 滑移和等温，$\\,T_w = 1000\\,$ $\\mathrm{K}$。\n- 案例 $\\,3\\,$：$\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (0.5,1.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 1200\\,$ $\\mathrm{K}$, 无滑移和绝热。\n- 案例 $\\,4\\,$：$\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (-0.2,-0.8)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 400\\,$ $\\mathrm{K}$, 无滑移和等温，$\\,T_w = 350\\,$ $\\mathrm{K}$。\n- 案例 $\\,5\\,$：$\\,\\mathbf{n} = (1,0)\\,$, $\\,\\mathbf{u}_0 = (2.0,0.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 900\\,$ $\\mathrm{K}$, 滑移和绝热。\n- 案例 $\\,6\\,$：$\\,\\mathbf{n} = \\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\,$, $\\,\\mathbf{u}_0 = (1.0,2.0)\\,$ $\\mathrm{m/s}$, $\\,T_0 = 850\\,$ $\\mathrm{K}$, 滑移和等温，$\\,T_w = 800\\,$ $\\mathrm{K}$。\n\n对于每个案例，计算并返回：\n- 虚拟单元速度的标量切向分量（单位为 $\\mathrm{m/s}$），该分量是相对于与 $\\,\\mathbf{n}\\,$ 正交的单位切线方向定义的。\n- 虚拟单元温度（单位为 $\\mathrm{K}$）。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表，列表被方括号包围，其中每个元素是一个双元素列表 $\\,\\big[\\text{虚拟切向速度}, \\text{虚拟温度}\\big]\\,$。例如，一个有效的整体格式是 $\\,\\big[ [a_1,b_1], [a_2,b_2], \\dots \\big]\\,$。在输出中，将所有数值报告为不带单位的普通浮点数。在内部，所有速度必须以 $\\mathrm{m/s}$ 为单位，所有温度必须以 $\\mathrm{K}$ 为单位处理。",
            "solution": "我们从流体力学和传热学的基本原理开始。考虑二维域中的一个平面壁面。设单位法向量为 $\\,\\mathbf{n}\\,$，并定义一个单位切向 $\\,\\mathbf{t}\\,$，使得 $\\,\\mathbf{t}\\cdot\\mathbf{n} = 0\\,$ 且 $\\,\\|\\mathbf{t}\\| = 1\\,$。在二维中，一个方便的构造是，当 $\\,\\mathbf{n} = (n_x,n_y)\\,$ 时，$\\,\\mathbf{t} = (-n_y, n_x)\\,$，然后在存在数值舍入误差的情况下进行归一化。\n\n邻近壁面的单元中心处的内部速度为 $\\,\\mathbf{u}_0\\,$。通过正交投影将 $\\,\\mathbf{u}_0\\,$ 分解为法向和切向标量分量：\n$$\nu_{n,0} = \\mathbf{u}_0 \\cdot \\mathbf{n}, \\quad u_{t,0} = \\mathbf{u}_0 \\cdot \\mathbf{t}.\n$$\n其向量形式为 $\\,\\mathbf{u}_0 = u_{n,0}\\,\\mathbf{n} + u_{t,0}\\,\\mathbf{t}\\,$。\n\n我们现在在一个以单元为中心的有限体积法（FVM）框架中施加壁面物理条件。虚拟单元中心对称地放置在壁面的另一侧，其到壁面的法向距离与内部单元中心相同，因此壁面位于这两个中心的中点。当边界值通过与壁面约束一致的奇反射或偶反射来强制执行时，这种对称放置意味着线性重构具有二阶精度。\n\n速度边界类型：\n1. 不可穿透壁面。必须在壁面处强制执行条件 $\\,\\mathbf{u}\\cdot\\mathbf{n} = 0\\,$。在二阶对称的虚拟单元放置中，关于壁面的奇反射强制使法向速度的壁面值为零。将虚拟单元的法向分量表示为 $\\,u_{n,g}\\,$，内部单元的法向分量表示为 $\\,u_{n,0}\\,$。通过奇反射，虚拟值必须满足\n$$\nu_{n,g} = -\\,u_{n,0}.\n$$\n这确保了在内部和虚拟中心之间进行线性插值时，壁面值为零，从而使不可穿透性约束在壁面处成立。\n\n2. 滑移壁面（无粘）。壁面剪切应力为零，这意味着切向速度的法向导数为零：\n$$\n\\frac{\\partial u_t}{\\partial n} = 0 \\quad \\text{在壁面上}.\n$$\n在内部和虚拟中心关于壁面对称放置的情况下，这通过切向分量的偶反射来强制执行：虚拟切向标量等于内部切向标量，\n$$\nu_{t,g} = u_{t,0}.\n$$\n结合 $\\,u_{n,g} = -u_{n,0}\\,$，虚拟速度向量则为\n$$\n\\mathbf{u}_g = u_{n,g}\\,\\mathbf{n} + u_{t,g}\\,\\mathbf{t} = (-u_{n,0})\\,\\mathbf{n} + (u_{t,0})\\,\\mathbf{t}.\n$$\n\n3. 无滑移壁面（有粘）。壁面上的速度为零，意味着法向和切向分量在壁面上都为零。对称的虚拟单元放置意味着两个分量都进行奇反射：\n$$\nu_{n,g} = -\\,u_{n,0}, \\quad u_{t,g} = -\\,u_{t,0}.\n$$\n这在插值到壁面时强制速度为零。\n\n热边界类型：\n1. 绝热壁面。法向热通量为零，$\\,\\mathbf{q}\\cdot\\mathbf{n} = 0\\,$，其中 $\\,\\mathbf{q} = -k\\nabla T\\,$ 且 $\\,k\\,$ 是热导率。因此，\n$$\n\\frac{\\partial T}{\\partial n} = 0 \\quad \\text{在壁面上}.\n$$\n在对称放置下，这通过温度的偶反射来强制执行：\n$$\nT_g = T_0,\n$$\n其中 $\\,T_g\\,$ 是虚拟单元温度，$\\,T_0\\,$ 是相邻的内部温度。\n\n2. 等温壁面。壁面处的温度被指定为 $\\,T_w\\,$。通过对称放置和到位于内部和虚拟中心中点的壁面进行线性插值，壁面温度等于内部和虚拟值的平均值。强制壁面温度为 $\\,T_w\\,$ 得到\n$$\n\\frac{T_0 + T_g}{2} = T_w \\quad \\Rightarrow \\quad T_g = 2\\,T_w - T_0.\n$$\n\n每个案例的算法步骤：\n1. 对给定的壁面法线 $\\,\\mathbf{n}\\,$ 进行归一化，以确保其单位长度：\n$$\n\\mathbf{n} \\leftarrow \\frac{\\mathbf{n}}{\\|\\mathbf{n}\\|}.\n$$\n2. 构造并归一化切向 $\\,\\mathbf{t}\\,$ 为 $\\,\\mathbf{t} = (-n_y, n_x)\\,$，然后将 $\\,\\mathbf{t}\\,$ 归一化为单位长度。\n3. 计算标量投影 $\\,u_{n,0} = \\mathbf{u}_0 \\cdot \\mathbf{n}\\,$ 和 $\\,u_{t,0} = \\mathbf{u}_0 \\cdot \\mathbf{t}\\,$。\n4. 应用速度边界条件：\n   - 对于滑移：$\\,u_{n,g} = -u_{n,0}\\,$, $\\,u_{t,g} = u_{t,0}\\,$.\n   - 对于无滑移：$\\,u_{n,g} = -u_{n,0}\\,$, $\\,u_{t,g} = -u_{t,0}\\,$.\n   速度所需的输出是标量 $\\,u_{t,g}\\,$。\n5. 应用热边界条件：\n   - 对于绝热：$\\,T_g = T_0\\,$.\n   - 对于等温：$\\,T_g = 2\\,T_w - T_0\\,$.\n6. 报告每个案例的对 $\\,\\big[u_{t,g},\\,T_g\\big]\\,$，将第一个解释为 $\\mathrm{m/s}$，第二个解释为 $\\mathrm{K}$，并将所有结果输出到单行的列表的列表中。\n\n将这些步骤应用于指定的测试套件：\n- 案例 $\\,1\\,$（滑移，绝热），$\\,\\mathbf{n}=(1,0)\\,$ 且 $\\,\\mathbf{t}=(0,1)\\,$，得到 $\\,u_{t,0} = -2.0\\,$，因此 $\\,u_{t,g} = -2.0\\,$；温度 $\\,T_g = 800\\,$。\n- 案例 $\\,2\\,$（滑移，等温），得到 $\\,u_{t,g} = 4.0\\,$；温度 $\\,T_g = 2\\cdot 1000 - 1100 = 900\\,$。\n- 案例 $\\,3\\,$（无滑移，绝热），得到 $\\,u_{t,g} = -1.0\\,$；温度 $\\,T_g = 1200\\,$。\n- 案例 $\\,4\\,$（无滑移，等温），得到 $\\,u_{t,g} = 0.8\\,$；温度 $\\,T_g = 2\\cdot 350 - 400 = 300\\,$。\n- 案例 $\\,5\\,$（滑移，绝热），得到 $\\,u_{t,g} = 0.0\\,$；温度 $\\,T_g = 900\\,$。\n- 案例 $\\,6\\,$（滑移，等温），$\\,\\mathbf{n}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\,$ 且 $\\,\\mathbf{t}=\\left(-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)\\,$，得到 $\\,u_{t,0} = \\mathbf{u}_0\\cdot\\mathbf{t} = \\frac{-1+2}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}}\\,$，因此 $\\,u_{t,g} = \\frac{1}{\\sqrt{2}}\\,$；温度 $\\,T_g = 2\\cdot 800 - 850 = 750\\,$。\n\n最终程序必须根据输入通用地计算这些结果，并打印包含所有案例的二元列表 $\\,\\big[u_{t,g},\\,T_g\\big]\\,$ 的单行列表，数值为普通浮点数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef normalize(vec):\n    \"\"\"Return the normalized vector; if norm is zero, return zero vector.\"\"\"\n    v = np.array(vec, dtype=float)\n    nrm = np.linalg.norm(v)\n    if nrm == 0.0:\n        return v\n    return v / nrm\n\ndef tangential_from_normal(n):\n    \"\"\"Construct a unit tangential vector orthonormal to the unit normal n in 2D.\"\"\"\n    # For n = (nx, ny), a perpendicular vector is t = (-ny, nx)\n    t = np.array([-n[1], n[0]], dtype=float)\n    return normalize(t)\n\ndef ghost_tangential_and_temperature(n, u0, T0, slip, adiabatic, Tw=None):\n    \"\"\"\n    Compute ghost-cell tangential velocity component and temperature.\n    n: wall normal vector (2D), will be normalized.\n    u0: interior velocity vector (2D) in m/s.\n    T0: interior temperature in K.\n    slip: boolean, True for slip wall, False for no-slip wall.\n    adiabatic: boolean, True for adiabatic wall, False for isothermal wall.\n    Tw: wall temperature in K if isothermal; ignored for adiabatic.\n    Returns (u_t_ghost, T_ghost).\n    \"\"\"\n    n_hat = normalize(n)\n    t_hat = tangential_from_normal(n_hat)\n    u0_vec = np.array(u0, dtype=float)\n\n    # Decompose interior velocity\n    u_n0 = float(np.dot(u0_vec, n_hat))\n    u_t0 = float(np.dot(u0_vec, t_hat))\n\n    # Apply velocity boundary condition\n    u_ng = -u_n0  # impermeability always enforced\n    if slip:\n        u_tg = u_t0  # zero gradient of tangential velocity at slip wall\n    else:\n        u_tg = -u_t0  # no-slip: zero wall tangential velocity\n\n    # Apply thermal boundary condition\n    if adiabatic:\n        T_g = float(T0)\n    else:\n        # isothermal: require Tw provided\n        if Tw is None:\n            raise ValueError(\"Isothermal wall requires Tw.\")\n        T_g = float(2.0 * Tw - T0)\n\n    return (u_tg, T_g)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: dict with keys 'n', 'u0', 'T0', 'slip', 'adiabatic', 'Tw' (optional)\n    test_cases = [\n        # Case 1: n=(1,0), u0=(1.5,-2.0), T0=800, slip  adiabatic\n        {\"n\": (1.0, 0.0), \"u0\": (1.5, -2.0), \"T0\": 800.0, \"slip\": True,  \"adiabatic\": True,  \"Tw\": None},\n        # Case 2: n=(1,0), u0=(3.0,4.0), T0=1100, slip  isothermal Tw=1000\n        {\"n\": (1.0, 0.0), \"u0\": (3.0, 4.0),  \"T0\": 1100.0, \"slip\": True,  \"adiabatic\": False, \"Tw\": 1000.0},\n        # Case 3: n=(1,0), u0=(0.5,1.0), T0=1200, no-slip  adiabatic\n        {\"n\": (1.0, 0.0), \"u0\": (0.5, 1.0),  \"T0\": 1200.0, \"slip\": False, \"adiabatic\": True,  \"Tw\": None},\n        # Case 4: n=(1,0), u0=(-0.2,-0.8), T0=400, no-slip  isothermal Tw=350\n        {\"n\": (1.0, 0.0), \"u0\": (-0.2, -0.8), \"T0\": 400.0, \"slip\": False, \"adiabatic\": False, \"Tw\": 350.0},\n        # Case 5: n=(1,0), u0=(2.0,0.0), T0=900, slip  adiabatic\n        {\"n\": (1.0, 0.0), \"u0\": (2.0, 0.0),  \"T0\": 900.0, \"slip\": True,  \"adiabatic\": True,  \"Tw\": None},\n        # Case 6: n=(1/sqrt(2),1/sqrt(2)), u0=(1.0,2.0), T0=850, slip  isothermal Tw=800\n        {\"n\": (1.0/np.sqrt(2.0), 1.0/np.sqrt(2.0)), \"u0\": (1.0, 2.0), \"T0\": 850.0, \"slip\": True, \"adiabatic\": False, \"Tw\": 800.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        u_tg, T_g = ghost_tangential_and_temperature(\n            n=case[\"n\"],\n            u0=case[\"u0\"],\n            T0=case[\"T0\"],\n            slip=case[\"slip\"],\n            adiabatic=case[\"adiabatic\"],\n            Tw=case[\"Tw\"]\n        )\n        # Optional rounding for neat output\n        u_tg_round = round(u_tg, 6)\n        T_g_round = round(T_g, 6)\n        results.append([u_tg_round, T_g_round])\n\n    # Final print statement in the exact required format: single line, list of lists.\n    # Ensure no extra text is printed.\n    print(f\"[{','.join(str(item) for item in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于反应流模拟，设定一致的入口条件对保证计算的准确性至关重要。本练习处理一个常见的实际问题：当输入的组分质量分数之和不为一时，我们该如何处理。您将学习并应用一种修正方案，该方案不仅能强制执行质量守恒，还能通过调整温度来保持入口流动的总能量不变，从而确保边界处理的物理意义 ()。",
            "id": "4032089",
            "problem": "您正在为一个计算燃烧模拟中的反应理想气体混合物建立入口边界条件模型。入口的组分质量分数可能与入口处的质量守恒不符，质量守恒要求各组分的质量分数之和为一。您必须设计并实现一个边界修正和焓守恒的归一化方案。\n\n假设以下基本事实，您应以此为基础进行推导和设计：\n- 对于一个混合物，质量分数满足恒等式 $\\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k = 1$，其中 $Y_k$ 是组分质量分数，$N_{\\mathrm{sp}}$ 是组分的数量。\n- 组分 $k$ 的显焓是相对于参考温度 $T_{\\mathrm{ref}}$ 定义的，其表达式为 $h_k^{\\mathrm{sens}}(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(T')\\, \\mathrm{d}T'$。在本问题中，将每个组分的 $c_{p,k}$ 模拟为常数，因此 $h_k^{\\mathrm{sens}}(T) = c_{p,k}\\,(T - T_{\\mathrm{ref}})$。\n- 混合物的显焓为 $h^{\\mathrm{sens}}(T, \\boldsymbol{Y}) = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k\\, h_k^{\\mathrm{sens}}(T)$。\n\n您的任务是：\n1. 计算入口处的质量守恒偏差，定义为 $\\varepsilon = 1 - \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{in}}$，其中 $Y_k^{\\mathrm{in}}$ 是给定的入口质量分数。\n2. 通过以下步骤修正组分质量分数：\n   - 强制非负性：任何 $Y_k^{\\mathrm{in}}  0$ 的值在归一化之前必须被截断为 $0$。\n   - 重新归一化截断后的入口质量分数，以获得满足 $\\sum_{k} \\tilde{Y}_k = 1$ 的修正后质量分数 $\\tilde{Y}_k$。\n3. 通过将静温从 $T_{\\mathrm{in}}$ 调整为修正值 $\\tilde{T}$，来在此修正过程中保持入口混合物显焓不变，使得 $h^{\\mathrm{sens}}(T_{\\mathrm{in}}, \\boldsymbol{Y}^{\\mathrm{clip}}) = h^{\\mathrm{sens}}(\\tilde{T}, \\tilde{\\boldsymbol{Y}})$，其中 $\\boldsymbol{Y}^{\\mathrm{clip}}$ 是用于定义目标焓值的截断后（非负）入口质量分数。使用定比热模型精确推导和计算 $\\tilde{T}$。\n\n所有温度必须以开尔文（$\\mathrm{K}$）为单位表示。参考温度为 $T_{\\mathrm{ref}} = 298.15$ $\\mathrm{K}$。对于五组分集合 $\\{ \\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{CH_4}, \\mathrm{CO_2}, \\mathrm{H_2O} \\}$，定压比热 $c_{p,k}$ 是常数，单位为 $\\mathrm{J}\\, \\mathrm{kg}^{-1}\\, \\mathrm{K}^{-1}$，具体如下：\n- $\\mathrm{N_2}$: $c_{p,\\mathrm{N_2}} = 1040.0$\n- $\\mathrm{O_2}$: $c_{p,\\mathrm{O_2}} = 918.0$\n- $\\mathrm{CH_4}$: $c_{p,\\mathrm{CH_4}} = 2220.0$\n- $\\mathrm{CO_2}$: $c_{p,\\mathrm{CO_2}} = 846.0$\n- $\\mathrm{H_2O}$: $c_{p,\\mathrm{H_2O}} = 1850.0$\n\n使用以下入口状态的测试套件来实现上述方案。每个测试案例提供 $T_{\\mathrm{in}}$ 和按组分顺序 $\\{ \\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{CH_4}, \\mathrm{CO_2}, \\mathrm{H_2O} \\}$ 排列的入口质量分数：\n\n- 测试案例 A（总和大于1的一般情况）：$T_{\\mathrm{in}} = 900.0$ $\\mathrm{K}$，$\\boldsymbol{Y}^{\\mathrm{in}} = [0.75, 0.21, 0.03, 0.02, 0.0]$。\n- 测试案例 B（总和小于1的一般情况）：$T_{\\mathrm{in}} = 1200.0$ $\\mathrm{K}$，$\\boldsymbol{Y}^{\\mathrm{in}} = [0.70, 0.19, 0.06, 0.03, 0.01]$。\n- 测试案例 C（由于数值噪声导致的负值条目）：$T_{\\mathrm{in}} = 800.0$ $\\mathrm{K}$，$\\boldsymbol{Y}^{\\mathrm{in}} = [0.77, 0.23, -0.01, 0.01, 0.0]$。\n- 测试案例 D（轻度过指定）：$T_{\\mathrm{in}} = 1000.0$ $\\mathrm{K}$，$\\boldsymbol{Y}^{\\mathrm{in}} = [0.78, 0.22, 0.01, 0.0, 0.0]$。\n\n您的程序必须：\n- 对于每个测试案例，计算并返回一个三元组，该三元组由偏差 $\\varepsilon$、保持显焓的修正后温度 $\\tilde{T}$ 以及经过截断和归一化后的修正质量分数向量 $\\tilde{\\boldsymbol{Y}}$ 组成，所有数值均需四舍五入到六位小数。\n- 生成单行输出，其中包含这四个测试案例的三元组列表，格式为用方括号括起来的逗号分隔列表。在每个三元组内部，修正后的质量分数必须作为子列表出现，并按组分顺序 $\\{ \\mathrm{N_2}, \\mathrm{O_2}, \\mathrm{CH_4}, \\mathrm{CO_2}, \\mathrm{H_2O} \\}$ 排列。\n\n例如，最终的输出格式必须是：\n$[ [\\varepsilon_A, \\tilde{T}_A, [\\tilde{Y}_{A,\\mathrm{N_2}}, \\tilde{Y}_{A,\\mathrm{O_2}}, \\tilde{Y}_{A,\\mathrm{CH_4}}, \\tilde{Y}_{A,\\mathrm{CO_2}}, \\tilde{Y}_{A,\\mathrm{H_2O}}]], [\\varepsilon_B, \\tilde{T}_B, [\\dots]], [\\varepsilon_C, \\tilde{T}_C, [\\dots]], [\\varepsilon_D, \\tilde{T}_D, [\\dots]] ]$\n其中所有数值条目均为十进制数，温度单位为开尔文，质量分数和偏差为无量纲，每个数值都需四舍五入到六位小数。",
            "solution": "问题陈述被评估为有效。它在科学上基于热力学和质量守恒原理，问题提法适定，给定的条件清晰完整，并以客观、正式的语言表述。可以推导出并计算出唯一且有意义的解。\n\n任务是设计并实现一个用于修正反应气体混合物入口边界条件的数值方案。该方案必须通过调整入口温度来确保质量守恒并保持混合物的显焓。该过程包括三个连续的步骤：计算质量守恒误差，修正组分质量分数，以及调整温度。\n\n### 1. 质量守恒偏差\n\n多组分混合物的质量守恒基本原理要求所有组分质量分数 $Y_k$ 的总和等于一。\n$$\n\\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k = 1\n$$\n其中 $N_{\\mathrm{sp}}$ 是组分的总数。给定的入口质量分数（表示为 $Y_k^{\\mathrm{in}}$）可能违反此条件。偏差 $\\varepsilon$ 定义为此总和与一的偏离量：\n$$\n\\varepsilon = 1 - \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{in}}\n$$\n\n### 2. 质量分数修正方案\n\n一组物理上有效的质量分数必须满足两个条件：非负性（对于所有 $k$，$Y_k \\ge 0$）和总和为一的约束。修正在两个子步骤中执行。\n\n#### 2.1. 非负性强制（截断）\n\n数值误差或用户输入可能导致小的负质量分数。这些值是非物理的，必须被消除。每个入口质量分数 $Y_k^{\\mathrm{in}}$ 如果为负，则被截断为零。得到的截断后质量分数 $Y_k^{\\mathrm{clip}}$ 定义为：\n$$\nY_k^{\\mathrm{clip}} = \\max(0, Y_k^{\\mathrm{in}})\n$$\n\n#### 2.2. 归一化\n\n截断后，质量分数的总和 $S^{\\mathrm{clip}} = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{clip}}$ 可能不等于 $1$。为强制总和为一的约束，对截断后的质量分数进行归一化。最终的修正后质量分数 $\\tilde{Y}_k$ 通过将每个 $Y_k^{\\mathrm{clip}}$ 除以它们的总和 $S^{\\mathrm{clip}}$ 得到：\n$$\n\\tilde{Y}_k = \\frac{Y_k^{\\mathrm{clip}}}{S^{\\mathrm{clip}}} = \\frac{Y_k^{\\mathrm{clip}}}{\\sum_{j=1}^{N_{\\mathrm{sp}}} Y_j^{\\mathrm{clip}}}\n$$\n此操作保证 $\\sum_{k=1}^{N_{\\mathrm{sp}}} \\tilde{Y}_k = 1$，前提是 $S^{\\mathrm{clip}}  0$。对于给定的测试案例，此条件得到满足。\n\n### 3. 焓守恒的温度修正\n\n质量分数的修正改变了入口混合物的组分。为保持流动的原始能量含量，必须调整入口温度。这是通过保持混合物显焓来实现的。\n\n在定比热假设下，组分 $k$ 的显焓 $h_k^{\\mathrm{sens}}$ 由下式给出：\n$$\nh_k^{\\mathrm{sens}}(T) = c_{p,k}(T - T_{\\mathrm{ref}})\n$$\n其中 $c_{p,k}$ 是组分 $k$ 的定压比热，$T$ 是静温，$T_{\\mathrm{ref}}$ 是焓的参考温度，给定为 $298.15 \\, \\mathrm{K}$。\n\n混合物显焓 $h^{\\mathrm{sens}}$ 是组分焓的质量分数加权和：\n$$\nh^{\\mathrm{sens}}(T, \\boldsymbol{Y}) = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k h_k^{\\mathrm{sens}}(T) = \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k c_{p,k} (T - T_{\\mathrm{ref}}) = (T - T_{\\mathrm{ref}}) \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k c_{p,k}\n$$\n\n问题要求，由截断后质量分数 $\\boldsymbol{Y}^{\\mathrm{clip}}$ 在原始入口温度 $T_{\\mathrm{in}}$ 下定义的混合物显焓，等于由修正后质量分数 $\\tilde{\\boldsymbol{Y}}$ 在新的修正后温度 $\\tilde{T}$ 下定义的混合物显焓。这个守恒原理表示为：\n$$\nh^{\\mathrm{sens}}(T_{\\mathrm{in}}, \\boldsymbol{Y}^{\\mathrm{clip}}) = h^{\\mathrm{sens}}(\\tilde{T}, \\tilde{\\boldsymbol{Y}})\n$$\n\n代入混合物显焓的定义，得到：\n$$\n(T_{\\mathrm{in}} - T_{\\mathrm{ref}}) \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{clip}} c_{p,k} = (\\tilde{T} - T_{\\mathrm{ref}}) \\sum_{k=1}^{N_{\\mathrm{sp}}} \\tilde{Y}_k c_{p,k}\n$$\n\n我们引入混合物比热 $c_{p, \\mathrm{mix}}(\\boldsymbol{Y}) = \\sum_k Y_k c_{p,k}$。该方程变为：\n$$\n(T_{\\mathrm{in}} - T_{\\mathrm{ref}}) \\, c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}}) = (\\tilde{T} - T_{\\mathrm{ref}}) \\, c_{p, \\mathrm{mix}}(\\tilde{\\boldsymbol{Y}})\n$$\n\n根据归一化步骤，我们有 $\\tilde{Y}_k = Y_k^{\\mathrm{clip}} / S^{\\mathrm{clip}}$。因此，修正后的混合物比热可以与截断后的混合物比热关联起来：\n$$\nc_{p, \\mathrm{mix}}(\\tilde{\\boldsymbol{Y}}) = \\sum_{k=1}^{N_{\\mathrm{sp}}} \\tilde{Y}_k c_{p,k} = \\sum_{k=1}^{N_{\\mathrm{sp}}} \\frac{Y_k^{\\mathrm{clip}}}{S^{\\mathrm{clip}}} c_{p,k} = \\frac{1}{S^{\\mathrm{clip}}} \\sum_{k=1}^{N_{\\mathrm{sp}}} Y_k^{\\mathrm{clip}} c_{p,k} = \\frac{c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}})}{S^{\\mathrm{clip}}}\n$$\n\n将此关系代回焓守恒方程：\n$$\n(T_{\\mathrm{in}} - T_{\\mathrm{ref}}) \\, c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}}) = (\\tilde{T} - T_{\\mathrm{ref}}) \\, \\frac{c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}})}{S^{\\mathrm{clip}}}\n$$\n\n假设 $c_{p, \\mathrm{mix}}(\\boldsymbol{Y}^{\\mathrm{clip}})  0$（这是成立的，因为所有 $c_{p,k}  0$ 且至少有一个 $Y_k^{\\mathrm{clip}}  0$），我们可以从等式两边消去此项：\n$$\nT_{\\mathrm{in}} - T_{\\mathrm{ref}} = \\frac{\\tilde{T} - T_{\\mathrm{ref}}}{S^{\\mathrm{clip}}}\n$$\n\n解出修正后的温度 $\\tilde{T}$，得到最终的精确表达式：\n$$\n\\tilde{T} = T_{\\mathrm{ref}} + S^{\\mathrm{clip}} (T_{\\mathrm{in}} - T_{\\mathrm{ref}})\n$$\n这个简洁的结果表明，温度修正因子就是截断后质量分数的总和 $S^{\\mathrm{clip}}$。现在整个过程可以通过算法来实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes boundary condition corrections for reacting flow inlets.\n\n    For each test case, the function calculates:\n    1. The mass conservation discrepancy (epsilon).\n    2. The corrected mass fractions (Y_tilde) by clipping negative values and normalizing.\n    3. The corrected temperature (T_tilde) that preserves the mixture sensible enthalpy.\n    \"\"\"\n    \n    # Foundational constants and definitions\n    T_ref = 298.15  # K\n    species = ['N2', 'O2', 'CH4', 'CO2', 'H2O']\n    # Specific heats at constant pressure [J kg^-1 K^-1] for the species set\n    cp_k = np.array([1040.0, 918.0, 2220.0, 846.0, 1850.0])\n\n    # Test suite of inlet states\n    # Each case: (T_in [K], Y_in list)\n    test_cases = [\n        # Test case A\n        (900.0, [0.75, 0.21, 0.03, 0.02, 0.0]),\n        # Test case B\n        (1200.0, [0.70, 0.19, 0.06, 0.03, 0.01]),\n        # Test case C\n        (800.0, [0.77, 0.23, -0.01, 0.01, 0.0]),\n        # Test case D\n        (1000.0, [0.78, 0.22, 0.01, 0.0, 0.0]),\n    ]\n\n    # List to store the string representation of each case's result\n    formatted_results = []\n\n    for T_in, Y_in_list in test_cases:\n        Y_in = np.array(Y_in_list)\n\n        # 1. Compute the mass conservation discrepancy\n        epsilon = 1.0 - np.sum(Y_in)\n\n        # 2. Correct the species mass fractions\n        # 2.1. Enforce non-negativity (clipping)\n        Y_clip = np.maximum(0.0, Y_in)\n\n        # 2.2. Renormalize to obtain corrected mass fractions\n        S_clip = np.sum(Y_clip)\n        \n        if S_clip > 0:\n            Y_tilde = Y_clip / S_clip\n        else:\n            # Handle edge case where all mass fractions are zero or negative.\n            # In this case, mass fractions remain zero and no normalization is possible.\n            # Temperature is not adjusted as enthalpy is zero.\n            Y_tilde = np.zeros_like(Y_in)\n            \n        # 3. Preserve enthalpy by correcting the temperature\n        if S_clip > 0:\n             # The derivation simplifies to T_tilde = T_ref + S_clip * (T_in - T_ref)\n            T_tilde = T_ref + S_clip * (T_in - T_ref)\n        else:\n            T_tilde = T_in\n\n        # Format results to six decimal places as required by the problem statement.\n        eps_str = f\"{epsilon:.6f}\"\n        T_tilde_str = f\"{T_tilde:.6f}\"\n        \n        # Format the mass fraction vector as a string list\n        y_tilde_str_list = [f\"{y:.6f}\" for y in Y_tilde]\n        y_tilde_list_str = f\"[{','.join(y_tilde_str_list)}]\"\n        \n        # Combine into the final string format for the current test case\n        case_result_str = f\"[{eps_str},{T_tilde_str},{y_tilde_list_str}]\"\n        formatted_results.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "可压缩流模拟的稳定性和准确性取决于数学上的适定（well-posed）边界条件。本练习旨在探索流动物理学与欧拉方程特征线理论之间的深刻联系。通过计算满足特定流动条件所需的入口温度，您将理解为何在入口或出口处需要指定的变量数量是由流态（亚音速/超音速）决定的，从而确保数值问题的适定性 ()。",
            "id": "4032117",
            "problem": "一股未燃预混气体的一维反应入流从一个沿 $x$ 正方向延伸的计算域的左边界进入一个计算燃烧室。该求解器在欧拉方程的无粘双曲近似下，使用基于特征线的边界条件来确保问题的适定性。未燃混合物中的声速由 $a=\\sqrt{\\gamma(T)\\,R\\,T}$ 建模，其中 $R$ 是混合气体常数，$\\gamma(T)$ 是依赖于温度的比热比。在亚音速入流条件下，必须正好有两条特征线进入计算域，这在入口马赫数满足 $0  M_{\\text{in}}  1$ 时发生。您必须推导出并计算出与期望声速相对应的入口静温，同时确保此条件得到满足。\n\n比热比 $\\gamma$ 依赖于温度，并由以下模型给出：\n$$\n\\gamma(T) = \\gamma_{0} + \\frac{k}{T}\n$$\n其中 $T$ 是静温，单位为开尔文，$\\gamma_{0}$ 和 $k$ 是给定常数。\n\n您必须求解入口静温 $T_{\\text{in}}$，该温度能在入口处产生期望的声速 $a_{\\text{des}}$，同时保持入流是亚音速的。为此，您将获得以下数据：\n- $\\gamma_{0} = 1.20$（无量纲）\n- $k = 51$（单位为开尔文）\n- $R = 287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$（气体常数）\n- $a_{\\text{des}} = 520\\ \\mathrm{m\\,s^{-1}}$（期望声速）\n- $U_{\\text{in}} = 120\\ \\mathrm{m\\,s^{-1}}$（入口速度）\n\n首先，验证流动确实是亚音速的。然后，推导出一个求解 $T_{\\text{in}}$ 的符号表达式。最后，使用给定的数值计算 $T_{\\text{in}}$ 的值。\n\n您的最终答案应为以开尔文表示的入口静温，四舍五入到小数点后一位。",
            "solution": "首先对问题陈述进行验证，以确定其科学和逻辑上的完整性。\n\n### 步骤 1：提取给定条件\n- **系统**：未燃预混气体的一维反应入流进入计算燃烧室。\n- **计算域**：沿 $x$ 正方向延伸。\n- **求解器细节**：使用基于欧拉方程无粘双曲近似的特征线边界条件。\n- **声速模型**：$a=\\sqrt{\\gamma(T)\\,R\\,T}$。\n- **气体性质**：\n    - $R$：混合气体常数。\n    - $\\gamma(T)$：依赖于温度的比热比，模型为 $\\gamma(T)=\\gamma_{0}+\\dfrac{k}{T}$。\n- **入口条件**：\n    - 亚音速入流，对应入口马赫数 $M_{\\text{in}}$ 满足 $0  M_{\\text{in}}  1$，要求正好有两条特征线进入计算域。\n    - 入口处期望的未燃声速：$a_{\\text{des}}$。\n    - 给定的入口流向速度：$U_{\\text{in}}$。\n- **目标**：确定入口静温 $T_{\\text{in}}$，使其在达到期望声速的同时满足亚音速入流条件。\n- **数值数据**：\n    - $\\gamma_{0}=1.20$\n    - $k=51$ (单位必须是开尔文，以使 $\\frac{k}{T}$ 无量纲)\n    - $R=287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n    - $a_{\\text{des}}=520\\ \\mathrm{m\\,s^{-1}}$\n    - $U_{\\text{in}}=120\\ \\mathrm{m\\,s^{-1}}$\n- **输出格式**：以开尔文表示最终温度，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题在科学上基于可压缩流体动力学和计算燃烧学的原理。在计算流体动力学（CFD）中，对欧拉方程使用基于特征线的边界条件是一种标准且严谨的技术。\n\n一维欧拉方程的特征速度（特征值）为 $\\lambda_1 = u - a$、$\\lambda_2 = u$ 和 $\\lambda_3 = u + a$，其中 $u$ 是流体速度，$a$ 是当地声速。在一个入口边界（$x=0$），流体沿 $x$ 正方向进入计算域，因此 $u  0$。如果特征线的速度为正，即它们将信息传播到计算域内部，则认为它们是“入射”的。\n- 对于 $u  0$ 和 $a  0$，$\\lambda_3 = u + a$ 总是正的。\n- 对于入流，$\\lambda_2 = u$ 是正的。\n- $\\lambda_1 = u - a$ 可以是正、负或零。\n\n问题陈述指出，对于亚音速入流，必须正好有两条特征线进入计算域。这对应于条件 $u  a$，或马赫数 $M = u/a  1$。在这种情况下，$\\lambda_1 = u - a  0$，因此该特征波将信息传播出计算域。另外两条特征线 $\\lambda_2=u$ 和 $\\lambda_3=u+a$ 具有正速度，是入射的。因此，对于亚音速入口，正好有两条入射特征线，这与问题陈述一致。与这些入射特征线相关的物理量必须在边界上指定，而与出射特征线相关的量必须从计算域内部计算得出。\n\n让我们使用所提供的数据验证亚音速条件。入口马赫数为 $M_{\\text{in}} = \\frac{U_{\\text{in}}}{a_{\\text{des}}}$。\n$$\nM_{\\text{in}} = \\frac{120\\ \\mathrm{m\\,s^{-1}}}{520\\ \\mathrm{m\\,s^{-1}}} \\approx 0.2307\n$$\n由于 $0  M_{\\text{in}}  1$，流动确实是亚音速的，并且问题的前提是自洽且物理上合理的。该问题是适定的、客观的，并包含获得唯一解所需的所有信息。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的。将推导解答。\n\n### 解题推导\n目标是找到能产生声速 $a_{\\text{des}}$ 的入口温度 $T_{\\text{in}}$。声速与温度之间的关系由下式给出：\n$$\na = \\sqrt{\\gamma(T)\\,R\\,T}\n$$\n比热比 $\\gamma$ 是温度依赖的，并建模为：\n$$\n\\gamma(T) = \\gamma_{0} + \\frac{k}{T}\n$$\n我们将 $\\gamma(T)$ 的表达式代入声速方程。在入口处，$T = T_{\\text{in}}$ 并且我们要求 $a = a_{\\text{des}}$。\n$$\na_{\\text{des}} = \\sqrt{\\left(\\gamma_{0} + \\frac{k}{T_{\\text{in}}}\\right) R T_{\\text{in}}}\n$$\n为了求解 $T_{\\text{in}}$，我们首先对方程两边取平方：\n$$\na_{\\text{des}}^2 = \\left(\\gamma_{0} + \\frac{k}{T_{\\text{in}}}\\right) R T_{\\text{in}}\n$$\n接下来，我们将右侧的项 $R T_{\\text{in}}$ 分配进去：\n$$\na_{\\text{des}}^2 = \\gamma_{0} R T_{\\text{in}} + \\frac{k}{T_{\\text{in}}} R T_{\\text{in}}\n$$\n分数中的 $T_{\\text{in}}$ 项消掉了：\n$$\na_{\\text{des}}^2 = \\gamma_{0} R T_{\\text{in}} + k R\n$$\n这是一个关于 $T_{\\text{in}}$ 的线性方程。我们现在可以通过重新整理各项来分离出 $T_{\\text{in}}$：\n$$\n\\gamma_{0} R T_{\\text{in}} = a_{\\text{des}}^2 - k R\n$$\n最后，除以 $\\gamma_{0} R$ 得到入口温度的符号表达式：\n$$\nT_{\\text{in}} = \\frac{a_{\\text{des}}^2 - k R}{\\gamma_{0} R}\n$$\n现在，我们将给定的数值代入此表达式。单位必须一致。$R$ 的单位是 $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，等同于 $\\mathrm{m^2\\,s^{-2}\\,K^{-1}}$。$a_{\\text{des}}$ 的单位是 $\\mathrm{m\\,s^{-1}}$。$k$ 的单位是 $\\mathrm{K}$，而 $\\gamma_{0}$ 是无量纲的。\n- $\\gamma_{0} = 1.20$\n- $k = 51\\ \\mathrm{K}$\n- $R = 287\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}}$\n- $a_{\\text{des}} = 520\\ \\mathrm{m\\,s^{-1}}$\n\n首先，计算分子中的各项：\n$$\na_{\\text{des}}^2 = (520)^2 = 270400\\ \\mathrm{m^2\\,s^{-2}}\n$$\n$$\nk R = 51\\ \\mathrm{K} \\times 287\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}} = 14637\\ \\mathrm{m^2\\,s^{-2}}\n$$\n分子是：\n$$\na_{\\text{des}}^2 - k R = 270400 - 14637 = 255763\\ \\mathrm{m^2\\,s^{-2}}\n$$\n接下来，计算分母：\n$$\n\\gamma_{0} R = 1.20 \\times 287\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}} = 344.4\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}}\n$$\n现在，计算 $T_{\\text{in}}$ 的值：\n$$\nT_{\\text{in}} = \\frac{255763\\ \\mathrm{m^2\\,s^{-2}}}{344.4\\ \\mathrm{m^2\\,s^{-2}\\,K^{-1}}} \\approx 742.633565621...\\ \\mathrm{K}\n$$\n问题要求答案四舍五入到小数点后一位。\n$$\nT_{\\text{in}} \\approx 742.6\\ \\mathrm{K}\n$$\n如前所述，此温度确保了在满足适定的亚音速入流边界条件的同时，达到期望的声速。",
            "answer": "$$\\boxed{742.6}$$"
        }
    ]
}