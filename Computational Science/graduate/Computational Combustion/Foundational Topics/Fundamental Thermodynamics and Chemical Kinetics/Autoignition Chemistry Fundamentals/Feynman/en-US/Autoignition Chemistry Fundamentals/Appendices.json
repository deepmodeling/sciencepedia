{
    "hands_on_practices": [
        {
            "introduction": "Autoignition is fundamentally a competition between reaction pathways that accelerate radical production (chain branching) and those that consume radicals (chain termination). This exercise provides a concrete, quantitative exploration of this critical balance. By calculating the oxygen mole fraction at which the rate of the primary branching reaction $\\text{H} + \\text{O}_2 \\to \\text{O} + \\text{OH}$ equals that of a key termination channel, you will determine a tipping point for ignition under specific conditions, directly connecting microscopic kinetics to macroscopic system behavior .",
            "id": "4008445",
            "problem": "Consider a homogeneous, well-mixed reactive gas at constant pressure and temperature, representative of the pre-ignition stage in computational combustion. The core chain-branching step is the elementary reaction $\\text{H} + \\text{O}_{2} \\to \\text{O} + \\text{OH}$ and a dominant radical-termination channel is the three-body recombination $\\text{H} + \\text{O}_{2} + M \\to \\text{HO}_{2} + M$. Assume the following physically grounded principles as a starting base: the law of mass action for elementary reactions, the ideal gas law, and Arrhenius temperature dependence of rate coefficients. Work in the low-pressure limit of the Lindemann mechanism for the termination reaction so that the effective termination rate coefficient is $k_{0}(T)$ multiplied by the effective third-body concentration.\n\nLet the mixture contain only molecular oxygen and molecular nitrogen, with mole fractions $X_{\\text{O}_{2}}$ and $X_{\\text{N}_{2}}$ satisfying $X_{\\text{O}_{2}} + X_{\\text{N}_{2}} = 1$. The temperature is $T = 1200\\ \\mathrm{K}$ and the pressure is $P = 10\\ \\mathrm{bar}$, to be treated as $P = 1.0\\times 10^{6}\\ \\mathrm{Pa}$. The effective third-body concentration is defined by collisional efficiency weights: $[M]_{\\mathrm{eff}} = C_{\\mathrm{tot}}\\left(\\alpha_{\\text{O}_{2}}\\,X_{\\text{O}_{2}} + \\alpha_{\\text{N}_{2}}\\,X_{\\text{N}_{2}}\\right)$, where $C_{\\mathrm{tot}}$ is the total molar concentration from the ideal gas law $C_{\\mathrm{tot}} = P/(R\\,T)$, $R$ is the universal gas constant, and $\\alpha_{i}$ are species-dependent third-body efficiencies for the $\\text{H} + \\text{O}_{2} + M$ reaction. Use $\\alpha_{\\text{O}_{2}} = 1.30$ and $\\alpha_{\\text{N}_{2}} = 0.70$.\n\nLet the chain-branching bimolecular rate coefficient be $k_{b}(T) = A_{b}\\,\\exp\\!\\left(-\\frac{E_{b}}{R\\,T}\\right)$ with $A_{b} = 5.00\\ \\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}}$ and $E_{b} = 2.00\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}}$. Let the low-pressure-limit termination rate coefficient be $k_{0}(T) = A_{0}\\,\\exp\\!\\left(-\\frac{E_{0}}{R\\,T}\\right)$ with $A_{0} = 2.00\\times 10^{-2}\\ \\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}}$ and $E_{0} = 1.00\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}}$.\n\nStarting from the stated fundamental laws and definitions, derive the condition for the critical oxygen mole fraction $X_{\\text{O}_{2}}^{\\star}$ at which the rate of the chain-branching reaction $\\text{H} + \\text{O}_{2}\\to \\text{O} + \\text{OH}$ exactly equals the rate of radical termination $\\text{H} + \\text{O}_{2} + M \\to \\text{HO}_{2} + M$, and then compute $X_{\\text{O}_{2}}^{\\star}$. Report the final answer as a pure mole fraction (dimensionless) rounded to four significant figures. Use $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$.",
            "solution": "The law of mass action states that the rate of an elementary reaction equals its rate coefficient multiplied by the product of reactant concentrations. For the chain-branching step $\\text{H} + \\text{O}_{2} \\to \\text{O} + \\text{OH}$, the rate is\n$$\nr_{b} = k_{b}(T)\\,[\\text{H}]\\,[\\text{O}_{2}] ,\n$$\nwhere $k_{b}(T)$ is the temperature-dependent bimolecular rate coefficient. For the three-body termination $\\text{H} + \\text{O}_{2} + M \\to \\text{HO}_{2} + M$ in the low-pressure limit of the Lindemann mechanism, the rate is\n$$\nr_{t} = k_{0}(T)\\,[\\text{H}]\\,[\\text{O}_{2}]\\,[M]_{\\mathrm{eff}} ,\n$$\nwith $k_{0}(T)$ the low-pressure-limit termolecular rate coefficient and $[M]_{\\mathrm{eff}}$ the effective collider concentration.\n\nThe critical mole fraction $X_{\\text{O}_{2}}^{\\star}$ is defined at the condition $r_{b} = r_{t}$. Equating the rates and cancelling the common factors $[\\text{H}]$ and $[\\text{O}_{2}]$ yields\n$$\nk_{b}(T) = k_{0}(T)\\,[M]_{\\mathrm{eff}} .\n$$\nThe effective collider concentration incorporates third-body efficiencies,\n$$\n[M]_{\\mathrm{eff}} = C_{\\mathrm{tot}}\\left(\\alpha_{\\text{O}_{2}}\\,X_{\\text{O}_{2}} + \\alpha_{\\text{N}_{2}}\\,X_{\\text{N}_{2}}\\right) ,\n$$\nwhere $X_{\\text{N}_{2}} = 1 - X_{\\text{O}_{2}}$. The total molar concentration $C_{\\mathrm{tot}}$ follows from the ideal gas law,\n$$\nC_{\\mathrm{tot}} = \\frac{P}{R\\,T} .\n$$\nSubstituting these into the equality condition gives\n$$\nk_{b}(T) = k_{0}(T)\\,\\frac{P}{R\\,T}\\left(\\alpha_{\\text{O}_{2}}\\,X_{\\text{O}_{2}} + \\alpha_{\\text{N}_{2}}\\,(1 - X_{\\text{O}_{2}})\\right) .\n$$\nCollecting terms in $X_{\\text{O}_{2}}$,\n$$\nk_{b}(T) = k_{0}(T)\\,\\frac{P}{R\\,T}\\left(\\alpha_{\\text{N}_{2}} + (\\alpha_{\\text{O}_{2}} - \\alpha_{\\text{N}_{2}})\\,X_{\\text{O}_{2}}\\right) .\n$$\nSolving for $X_{\\text{O}_{2}}$,\n$$\nX_{\\text{O}_{2}}^{\\star} = \\frac{\\displaystyle \\frac{k_{b}(T)\\,R\\,T}{k_{0}(T)\\,P} - \\alpha_{\\text{N}_{2}}}{\\alpha_{\\text{O}_{2}} - \\alpha_{\\text{N}_{2}}} .\n$$\n\nNext, evaluate $k_{b}(T)$ and $k_{0}(T)$ using the Arrhenius forms provided:\n$$\nk_{b}(T) = A_{b}\\,\\exp\\!\\left(-\\frac{E_{b}}{R\\,T}\\right) , \\qquad A_{b} = 5.00\\ \\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}}, \\quad E_{b} = 2.00\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}} ,\n$$\n$$\nk_{0}(T) = A_{0}\\,\\exp\\!\\left(-\\frac{E_{0}}{R\\,T}\\right) , \\qquad A_{0} = 2.00\\times 10^{-2}\\ \\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}}, \\quad E_{0} = 1.00\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}} .\n$$\nWith $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $T = 1200\\ \\mathrm{K}$, and $P = 1.0\\times 10^{6}\\ \\mathrm{Pa}$, first compute $R\\,T$:\n$$\nR\\,T = 8.314462618 \\times 1200 = 9{,}977.3551416\\ \\mathrm{J\\,mol^{-1}} .\n$$\nCompute the exponential factors:\n$$\n\\frac{E_{b}}{R\\,T} = \\frac{2.00\\times 10^{4}}{9{,}977.3551416} \\approx 2.0045 , \\quad \\exp\\!\\left(-\\frac{E_{b}}{R\\,T}\\right) \\approx 0.13473 ,\n$$\n$$\n\\frac{E_{0}}{R\\,T} = \\frac{1.00\\times 10^{4}}{9{,}977.3551416} \\approx 1.00226 , \\quad \\exp\\!\\left(-\\frac{E_{0}}{R\\,T}\\right) \\approx 0.36695 .\n$$\nThus,\n$$\nk_{b}(T) \\approx 5.00 \\times 0.13473 = 0.67365\\ \\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}} ,\n$$\n$$\nk_{0}(T) \\approx 2.00\\times 10^{-2} \\times 0.36695 = 7.339\\times 10^{-3}\\ \\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}} .\n$$\nThe total molar concentration is\n$$\nC_{\\mathrm{tot}} = \\frac{P}{R\\,T} = \\frac{1.0\\times 10^{6}}{9{,}977.3551416} \\approx 100.228\\ \\mathrm{mol\\,m^{-3}} .\n$$\nFor convenience, define\n$$\n\\Theta \\equiv \\frac{k_{b}(T)}{k_{0}(T)\\,C_{\\mathrm{tot}}} = \\frac{0.67365}{(7.339\\times 10^{-3})\\times 100.228} \\approx \\frac{0.67365}{0.73573} \\approx 0.9155 .\n$$\nFrom the algebra above,\n$$\nX_{\\text{O}_{2}}^{\\star} = \\frac{\\Theta - \\alpha_{\\text{N}_{2}}}{\\alpha_{\\text{O}_{2}} - \\alpha_{\\text{N}_{2}}} = \\frac{0.9155 - 0.70}{1.30 - 0.70} = \\frac{0.2155}{0.60} \\approx 0.3592 .\n$$\n\nThis value lies between $0$ and $1$, consistent with a physically meaningful mole fraction. It indicates that, at $T = 1200\\ \\mathrm{K}$ and $P = 10\\ \\mathrm{bar}$ with the specified rate parameters and third-body efficiencies, the chain-branching step $\\text{H} + \\text{O}_{2} \\to \\text{O} + \\text{OH}$ overtakes termination when the oxygen mole fraction exceeds approximately $0.3592$. Rounded to four significant figures, the critical oxygen mole fraction is $0.3592$, reported as a dimensionless mole fraction.",
            "answer": "$$\\boxed{0.3592}$$"
        },
        {
            "introduction": "While individual reactions are important, autoignition is a system-level phenomenon governed by the collective dynamics of a radical pool. Linear stability analysis is a powerful technique to understand this collective behavior by examining the system's response to small perturbations. In this practice, you will approximate the complex chemical system as a linear one to find its characteristic growth rate—the largest positive eigenvalue $\\lambda_{\\max}$—which dictates the timescale of the exponential radical runaway that defines ignition .",
            "id": "4008423",
            "problem": "You are asked to implement a complete, runnable program that computes the largest real-part eigenvalue $\\lambda_{\\max}$ of the linearized radical-subsystem Jacobian for a reduced hydrogen-oxygen ($\\text{H}_2/\\text{O}_2$) mechanism at a specified temperature and composition, and to relate its magnitude to the expected autoignition induction time. The program must be self-contained and produce results for a specified test suite.\n\nAssume an isothermal, constant-pressure gas mixture at $P = 1\\,\\mathrm{atm}$ with mole fractions $X_{\\mathrm{H_2}}$, $X_{\\mathrm{O_2}}$, and $X_{\\mathrm{N_2}}$ (nitrogen serves as an inert bath gas). The total molar concentration is given by the Ideal Gas Law $C_{\\mathrm{tot}} = P/\\left(R_u T\\right)$, where $R_u$ is the universal gas constant. Species molar concentrations in $\\mathrm{mol/m^3}$ are $C_i = X_i C_{\\mathrm{tot}}$. The reduced mechanism tracks radical production and consumption via the following reactions under the Law of Mass Action and Arrhenius kinetics:\n\n1. $\\mathrm{H} + \\mathrm{O_2} \\rightarrow \\mathrm{O} + \\mathrm{OH}$, with rate $r_1 = k_1(T)\\, [\\mathrm{H}][\\mathrm{O_2}]$.\n2. $\\mathrm{O} + \\mathrm{H_2} \\rightarrow \\mathrm{H} + \\mathrm{OH}$, with rate $r_2 = k_2(T)\\, [\\mathrm{O}][\\mathrm{H_2}]$.\n3. $\\mathrm{OH} + \\mathrm{H_2} \\rightarrow \\mathrm{H} + \\mathrm{H_2O}$, with rate $r_4 = k_4(T)\\, [\\mathrm{OH}][\\mathrm{H_2}]$.\n\nHere $[\\cdot]$ denotes molar concentration in $\\mathrm{mol/m^3}$. The rate constants $k_j(T)$ follow the Arrhenius form $k_j(T) = A_j\\, T^{n_j} \\exp\\left(-E_{a,j}/(R_u T)\\right)$ for $j \\in \\{1,2,4\\}$, with the following parameters (given in centimeter-cubed per mole per second and calories per mole, which you must convert to International System of Units (SI)):\n\n- Reaction $1$: $A_1 = 2.65\\times 10^{16}\\,\\mathrm{cm^3/(mol\\cdot s)}$, $n_1 = -0.670$, $E_{a,1} = 1.704\\times 10^{4}\\,\\mathrm{cal/mol}$.\n- Reaction $2$: $A_2 = 3.87\\times 10^{4}\\,\\mathrm{cm^3/(mol\\cdot s)}$, $n_2 = 2.70$, $E_{a,2} = 6260\\,\\mathrm{cal/mol}$.\n- Reaction $4$: $A_4 = 2.06\\times 10^{8}\\,\\mathrm{cm^3/(mol\\cdot s)}$, $n_4 = 1.52$, $E_{a,4} = 3430\\,\\mathrm{cal/mol}$.\n\nConversion rules to SI are: $1\\,\\mathrm{cm^3/(mol\\cdot s)} = 10^{-6}\\,\\mathrm{m^3/(mol\\cdot s)}$ and $1\\,\\mathrm{cal/mol} = 4.184\\,\\mathrm{J/mol}$. Use $R_u = 8.31446261815324\\,\\mathrm{J/(mol\\cdot K)}$.\n\nLinearize the early-time radical dynamics by treating $[\\mathrm{H_2}]$ and $[\\mathrm{O_2}]$ as constants equal to their initial values, and by writing the radical state vector $\\mathbf{x} = \\big([\\mathrm{H}], [\\mathrm{O}], [\\mathrm{OH}]\\big)^\\top$. Under this approximation, the linear system $\\dot{\\mathbf{x}} = \\mathbf{A}\\,\\mathbf{x}$ has the Jacobian\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n- a_1  a_2  a_4 \\\\\na_1  - a_2  0 \\\\\na_1  a_2  - a_4\n\\end{bmatrix},\n\\quad\na_1 = k_1(T)\\,[\\mathrm{O_2}],\\quad\na_2 = k_2(T)\\,[\\mathrm{H_2}],\\quad\na_4 = k_4(T)\\,[\\mathrm{H_2}].\n$$\nLet $\\lambda_{\\max}$ be the largest real part among the eigenvalues of $\\mathbf{A}$. Interpret the expected induction time for autoignition as $t_{\\mathrm{ind}} \\approx 1/\\lambda_{\\max}$ when $\\lambda_{\\max}  0$. If $\\lambda_{\\max} \\leq 0$, set $t_{\\mathrm{ind}} = +\\infty$.\n\nYour program must:\n- Compute $k_1(T)$, $k_2(T)$, and $k_4(T)$ in SI units for each test case.\n- Compute $[\\mathrm{H_2}]$ and $[\\mathrm{O_2}]$ in $\\mathrm{mol/m^3}$ from $X_{\\mathrm{H_2}}$, $X_{\\mathrm{O_2}}$, $P$, and $T$ using the Ideal Gas Law.\n- Assemble $\\mathbf{A}$, compute its eigenvalues, and determine $\\lambda_{\\max}$ as the maximum of their real parts in $\\mathrm{s^{-1}}$.\n- Compute $t_{\\mathrm{ind}}$ in seconds as specified.\n- Report both $\\lambda_{\\max}$ and $t_{\\mathrm{ind}}$ rounded to six decimal places, except if $t_{\\mathrm{ind}} = +\\infty$ in which case return the floating-point infinity without rounding.\n\nPhysical units requirement: Output $\\lambda_{\\max}$ in $\\mathrm{s^{-1}}$ and $t_{\\mathrm{ind}}$ in $\\mathrm{s}$.\n\nAngle units do not apply. Percentages do not apply.\n\nTest suite (each case specifies $T$ in $\\mathrm{K}$ and mole fractions for $\\mathrm{H_2}$, $\\mathrm{O_2}$, and $\\mathrm{N_2}$, which sum to $1$):\n- Case $1$: $T = 900$, $X_{\\mathrm{H_2}} = 0.05$, $X_{\\mathrm{O_2}} = 0.05$, $X_{\\mathrm{N_2}} = 0.90$.\n- Case $2$: $T = 1200$, $X_{\\mathrm{H_2}} = 0.05$, $X_{\\mathrm{O_2}} = 0.10$, $X_{\\mathrm{N_2}} = 0.85$.\n- Case $3$: $T = 1800$, $X_{\\mathrm{H_2}} = 0.03$, $X_{\\mathrm{O_2}} = 0.21$, $X_{\\mathrm{N_2}} = 0.76$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list $[\\lambda_{\\max}, t_{\\mathrm{ind}}]$ for the corresponding test case. For example, the output should look like\n$[[\\lambda_1,t_1],[\\lambda_2,t_2],[\\lambda_3,t_3]]$\nwith each numeric value rounded as specified.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of chemical kinetics and linear stability analysis, is mathematically well-posed, and provides a complete and consistent set of data and definitions required for its solution. The necessary physical constants, such as the conversion from atmospheres to Pascals, are standard and unambiguously implied by the use of SI units for other provided constants.\n\nThe solution proceeds by first establishing the physical and chemical context, then deriving the mathematical model, and finally detailing the computational algorithm to solve for the requested quantities.\n\n**1. Physical Parameters and Concentrations**\n\nThe analysis is for an isothermal, constant-pressure gas mixture. The total molar concentration of the mixture, $C_{\\mathrm{tot}}$, is given by the Ideal Gas Law:\n$$ C_{\\mathrm{tot}} = \\frac{P}{R_u T} $$\nwhere the pressure is $P = 1\\,\\mathrm{atm} = 101325\\,\\mathrm{Pa}$, the temperature $T$ is specified for each case, and the universal gas constant is $R_u = 8.31446261815324\\,\\mathrm{J/(mol\\cdot K)}$. The molar concentrations of the stable species, hydrogen ($[\\mathrm{H_2}]$) and oxygen ($[\\mathrm{O_2}]$), are calculated from their initial mole fractions, $X_{\\mathrm{H_2}}$ and $X_{\\mathrm{O_2}}$, as:\n$$ [\\mathrm{H_2}] = X_{\\mathrm{H_2}} C_{\\mathrm{tot}} \\quad \\text{and} \\quad [\\mathrm{O_2}] = X_{\\mathrm{O_2}} C_{\\mathrm{tot}} $$\nThese concentrations are in SI units of $\\mathrm{mol/m^3}$ and are assumed to remain constant during the early induction phase of autoignition.\n\n**2. Chemical Kinetics and Rate Constants**\n\nThe problem provides a reduced three-reaction mechanism for the hydrogen-oxygen system. The rates of these reactions are governed by Arrhenius kinetics, where the rate constant $k_j(T)$ for reaction $j$ is given by:\n$$ k_j(T) = A_j T^{n_j} \\exp\\left(-\\frac{E_{a,j}}{R_u T}\\right) $$\nThe pre-exponential factor $A_j$, temperature exponent $n_j$, and activation energy $E_{a,j}$ are provided for reactions $j \\in \\{1, 2, 4\\}$. The given parameters must be converted to SI units:\n- Pre-exponential factors ($A_j$): from $\\mathrm{cm^3/(mol\\cdot s)}$ to $\\mathrm{m^3/(mol\\cdot s)}$ by multiplying by $10^{-6}$.\n- Activation energies ($E_{a,j}$): from $\\mathrm{cal/mol}$ to $\\mathrm{J/mol}$ by multiplying by $4.184$.\n\nThe values in SI units are:\n- Reaction $1$: $A_1 = 2.65 \\times 10^{10}\\,\\mathrm{m^3/(mol\\cdot s)}$, $n_1 = -0.670$, $E_{a,1} = 71295.36\\,\\mathrm{J/mol}$.\n- Reaction $2$: $A_2 = 3.87 \\times 10^{-2}\\,\\mathrm{m^3/(mol\\cdot s)}$, $n_2 = 2.70$, $E_{a,2} = 26191.84\\,\\mathrm{J/mol}$.\n- Reaction $4$: $A_4 = 206\\,\\mathrm{m^3/(mol\\cdot s)}$, $n_4 = 1.52$, $E_{a,4} = 14351.12\\,\\mathrm{J/mol}$.\n\n**3. Linearized Radical Dynamics**\n\nThe evolution of the radical species concentrations, represented by the state vector $\\mathbf{x} = \\big([\\mathrm{H}], [\\mathrm{O}], [\\mathrm{OH}]\\big)^\\top$, is described by a system of ordinary differential equations (ODEs). The net rate of change for each radical is the sum of its production and consumption rates from the three reactions:\n\\begin{align*}\n\\frac{d[\\mathrm{H}]}{dt} = -r_1 + r_2 + r_4 = -k_1(T)[\\mathrm{O_2}][\\mathrm{H}] + k_2(T)[\\mathrm{H_2}][\\mathrm{O}] + k_4(T)[\\mathrm{H_2}][\\mathrm{OH}] \\\\\n\\frac{d[\\mathrm{O}]}{dt} = r_1 - r_2 = k_1(T)[\\mathrm{O_2}][\\mathrm{H}] - k_2(T)[\\mathrm{H_2}][\\mathrm{O}] \\\\\n\\frac{d[\\mathrm{OH}]}{dt} = r_1 + r_2 - r_4 = k_1(T)[\\mathrm{O_2}][\\mathrm{H}] + k_2(T)[\\mathrm{H_2}][\\mathrm{O}] - k_4(T)[\\mathrm{H_2}][\\mathrm{OH}]\n\\end{align*}\nUnder the approximation that $[\\mathrm{H_2}]$ and $[\\mathrm{O_2}]$ are constant, this system of ODEs is linear in the radical concentrations. It can be written in matrix form as $\\dot{\\mathbf{x}} = \\mathbf{A}\\,\\mathbf{x}$, where $\\mathbf{A}$ is the Jacobian matrix of the system. By defining the coefficients $a_1 = k_1(T)[\\mathrm{O_2}]$, $a_2 = k_2(T)[\\mathrm{H_2}]$, and $a_4 = k_4(T)[\\mathrm{H_2}]$, the Jacobian matrix is:\n$$\n\\mathbf{A} = \\frac{\\partial \\dot{\\mathbf{x}}}{\\partial \\mathbf{x}^\\top} =\n\\begin{bmatrix}\n-a_1  a_2  a_4 \\\\\na_1  -a_2  0 \\\\\na_1  a_2  -a_4\n\\end{bmatrix}\n$$\nThis matrix is identical to the one provided in the problem statement, confirming its derivation.\n\n**4. Eigenvalue Analysis and Induction Time**\n\nThe behavior of the linear system $\\dot{\\mathbf{x}} = \\mathbf{A}\\,\\mathbf{x}$ is determined by the eigenvalues of the matrix $\\mathbf{A}$. If any eigenvalue has a positive real part, the corresponding mode will grow exponentially, leading to a runaway increase in radical concentrations, which is the definition of autoignition. The dominant growth rate is given by the largest real part among all eigenvalues, denoted $\\lambda_{\\max} = \\max(\\mathrm{Re}(\\lambda_i))$, where $\\lambda_i$ are the eigenvalues of $\\mathbf{A}$.\n\nThe characteristic time scale for this exponential growth is the autoignition induction time, $t_{\\mathrm{ind}}$. For $\\lambda_{\\max}  0$, this time is inversely proportional to the growth rate:\n$$ t_{\\mathrm{ind}} \\approx \\frac{1}{\\lambda_{\\max}} $$\nIf $\\lambda_{\\max} \\le 0$, there is no exponential growth of radical concentrations, and thus no ignition is predicted by this linear model. In this scenario, the induction time is considered to be infinite, $t_{\\mathrm{ind}} = +\\infty$.\n\n**5. Computational Procedure**\n\nFor each test case defined by $T$, $X_{\\mathrm{H_2}}$, and $X_{\\mathrm{O_2}}$:\n1.  Calculate the constant concentrations $[\\mathrm{H_2}]$ and $[\\mathrm{O_2}]$ in $\\mathrm{mol/m^3}$ using the Ideal Gas Law.\n2.  Calculate the rate constants $k_1(T)$, $k_2(T)$, and $k_4(T)$ in $\\mathrm{m^3/(mol\\cdot s)}$ using the Arrhenius equation and the SI parameters.\n3.  Compute the coefficients $a_1$, $a_2$, and $a_4$ in $\\mathrm{s^{-1}}$.\n4.  Assemble the $3 \\times 3$ Jacobian matrix $\\mathbf{A}$.\n5.  Compute the eigenvalues of $\\mathbf{A}$ using a numerical linear algebra library.\n6.  Determine $\\lambda_{\\max}$ by finding the maximum value of the real parts of the computed eigenvalues.\n7.  Calculate $t_{\\mathrm{ind}}$. If $\\lambda_{\\max}  0$, $t_{\\mathrm{ind}} = 1/\\lambda_{\\max}$. Otherwise, $t_{\\mathrm{ind}}$ is set to floating-point infinity.\n8.  The final results, $\\lambda_{\\max}$ and $t_{\\mathrm{ind}}$, are rounded to six decimal places as required for numerical output.\nThis procedure is implemented in the provided program to generate the solution for the specified test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the largest real-part eigenvalue of the linearized radical-subsystem\n    Jacobian for a reduced H2/O2 mechanism and the corresponding autoignition\n    induction time for a suite of test cases.\n    \"\"\"\n    # Universal gas constant in J/(mol.K)\n    R_u = 8.31446261815324\n    # Pressure in Pa (1 atm)\n    P = 101325.0\n\n    # Conversion factors\n    cal_to_J = 4.184\n    cm3_to_m3 = 1.0e-6\n\n    # Arrhenius parameters for the reactions in SI units\n    # k_j(T) = A_j * T^n_j * exp(-E_{a,j} / (R_u * T))\n    # Units: A_j in m^3/(mol.s), E_{a,j} in J/mol\n    params = {\n        1: { # H + O2 - O + OH\n            'A': 2.65e16 * cm3_to_m3,\n            'n': -0.670,\n            'Ea': 1.704e4 * cal_to_J\n        },\n        2: { # O + H2 - H + OH\n            'A': 3.87e4 * cm3_to_m3,\n            'n': 2.70,\n            'Ea': 6260.0 * cal_to_J\n        },\n        4: { # OH + H2 - H + H2O\n            'A': 2.06e8 * cm3_to_m3,\n            'n': 1.52,\n            'Ea': 3430.0 * cal_to_J\n        }\n    }\n\n    # Test cases: (T in K, X_H2, X_O2, X_N2)\n    test_cases = [\n        (900.0, 0.05, 0.05, 0.90),\n        (1200.0, 0.05, 0.10, 0.85),\n        (1800.0, 0.03, 0.21, 0.76)\n    ]\n\n    results_for_printing = []\n\n    def arrhenius_k(T, A, n, Ea):\n        \"\"\"Calculates the Arrhenius rate constant k(T).\"\"\"\n        return A * (T**n) * np.exp(-Ea / (R_u * T))\n\n    for T, X_H2, X_O2, _ in test_cases:\n        # Calculate total molar concentration C_tot in mol/m^3\n        C_tot = P / (R_u * T)\n\n        # Calculate concentrations of H2 and O2 in mol/m^3\n        C_H2 = X_H2 * C_tot\n        C_O2 = X_O2 * C_tot\n\n        # Calculate rate constants k_j(T) in m^3/(mol.s)\n        k1 = arrhenius_k(T, params[1]['A'], params[1]['n'], params[1]['Ea'])\n        k2 = arrhenius_k(T, params[2]['A'], params[2]['n'], params[2]['Ea'])\n        k4 = arrhenius_k(T, params[4]['A'], params[4]['n'], params[4]['Ea'])\n\n        # Calculate Jacobian coefficients a_j in s^-1\n        a1 = k1 * C_O2\n        a2 = k2 * C_H2\n        a4 = k4 * C_H2\n\n        # Assemble the Jacobian matrix A\n        A = np.array([\n            [-a1, a2, a4],\n            [a1, -a2, 0],\n            [a1, a2, -a4]\n        ])\n\n        # Compute eigenvalues and find the maximum real part (lambda_max)\n        eigenvalues = np.linalg.eigvals(A)\n        lambda_max = np.max(np.real(eigenvalues))\n\n        # Compute induction time t_ind\n        if lambda_max  0:\n            t_ind = 1.0 / lambda_max\n            t_ind_str = f\"{t_ind:.6f}\"\n        else:\n            t_ind = float('inf')\n            t_ind_str = \"inf\"\n            \n        lambda_max_str = f\"{lambda_max:.6f}\"\n        \n        # Format the result pair as a string \"[lambda,t_ind]\"\n        result_pair_str = f\"[{lambda_max_str},{t_ind_str}]\"\n        results_for_printing.append(result_pair_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_for_printing)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond static or linearized analyses, this practice dives into the full time-dependent simulation of a reacting system. You will implement a model for a simplified low-temperature (LT) chemical mechanism, coupling the species rate equations with the energy equation in an adiabatic reactor. This exercise will allow you to directly observe how specific kinetic features, such as the competition between exothermic and endothermic reaction steps, dynamically influence the heat release rate and the resulting ignition delay time .",
            "id": "4008479",
            "problem": "Consider a homogeneous, adiabatic, constant-volume reactor modeling Low-Temperature (LT) peroxy chemistry, with a minimal mechanism that captures an endothermic initiation step and its effect on ignition delay. The species are a generic fuel radical $R$, molecular oxygen $\\text{O}_2$, peroxy radical $\\text{RO}_2$, and lumped products $P$. The elementary reactions are: (i) $R + \\text{O}_2 \\to \\text{RO}_2$ with exothermic heat release $+Q_1$ per mole, (ii) $\\text{RO}_2 \\to R + \\text{O}_2$ with endothermic heat absorption $-Q_1$ per mole, and (iii) $\\text{RO}_2 \\to P + \\text{HO}_2$ with exothermic heat release $+Q_2$ per mole. All reactions follow mass-action kinetics with Arrhenius rates. Let $A_1$, $E_1$ be the pre-exponential factor and activation energy for $R + \\text{O}_2 \\to \\text{RO}_2$, $A_r$, $E_r$ for $\\text{RO}_2 \\to R + \\text{O}_2$, and $A_2$, $E_2$ for $\\text{RO}_2 \\to P + \\text{HO}_2$. Let $R_g$ be the universal gas constant. The rate constants are $k_1(T) = A_1 \\exp\\!\\left(-\\dfrac{E_1}{R_g T}\\right)$, $k_{-1}(T) = A_r \\exp\\!\\left(-\\dfrac{E_r}{R_g T}\\right)$, and $k_2(T) = A_2 \\exp\\!\\left(-\\dfrac{E_2}{R_g T}\\right)$. The concentrations (in $\\mathrm{mol \\ m^{-3}}$) are $c_R$, $c_{\\text{O}_2}$, $c_{\\text{RO}_2}$, and $c_P$, and the temperature is $T$.\n\nStarting from fundamental laws and core definitions:\n- Use mass-action kinetics to write the species evolution:\n$$\\frac{dc_R}{dt} = -k_1(T)\\, c_R\\, c_{\\text{O}_2} + k_{-1}(T)\\, c_{\\text{RO}_2},$$\n$$\\frac{dc_{\\text{RO}_2}}{dt} = k_1(T)\\, c_R\\, c_{\\text{O}_2} - k_{-1}(T)\\, c_{\\text{RO}_2} - k_2(T)\\, c_{\\text{RO}_2},$$\n$$\\frac{dc_{\\text{O}_2}}{dt} = -k_1(T)\\, c_R\\, c_{\\text{O}_2} + k_{-1}(T)\\, c_{\\text{RO}_2},$$\n$$\\frac{dc_{P}}{dt} = k_2(T)\\, c_{\\text{RO}_2}.$$\n- Apply conservation of energy for an adiabatic constant-volume reactor. Denote the constant molar isochoric heat capacity of the mixture by $C_{v,m}$ (assumed temperature-independent for this simplified scheme) and the total molar concentration by $c_{\\mathrm{tot}} = c_R + c_{\\text{RO}_2} + c_{\\text{O}_2} + c_P$. The volumetric heat capacity is $C_{v,\\mathrm{vol}} = c_{\\mathrm{tot}}\\, C_{v,m}$. The volumetric heat release rate $\\dot{q}$ is the sum of reaction rates times their molar heats of reaction:\n$$\\dot{q}(T, \\mathbf{c}) = Q_1\\, k_1(T)\\, c_R\\, c_{\\text{O}_2} - Q_1\\, k_{-1}(T)\\, c_{\\text{RO}_2} + Q_2\\, k_2(T)\\, c_{\\text{RO}_2}.$$\nThe temperature evolution is\n$$\\frac{dT}{dt} = \\frac{\\dot{q}(T, \\mathbf{c})}{C_{v,\\mathrm{vol}}} = \\frac{Q_1\\, k_1(T)\\, c_R\\, c_{\\text{O}_2} - Q_1\\, k_{-1}(T)\\, c_{\\text{RO}_2} + Q_2\\, k_2(T)\\, c_{\\text{RO}_2}}{(c_R + c_{\\text{RO}_2} + c_{\\text{O}_2} + c_{P})\\, C_{v,m}}.$$\n\nExplain, within this framework, how the endothermic initiation step $\\text{RO}_2 \\to R + \\text{O}_2$ delays ignition by temporarily reducing $\\dot{q}$, and quantify this effect by computing ignition delay times under different parameter sets in a simple Low-Temperature (LT) scheme. Define the ignition delay time as the time at which $\\dfrac{dT}{dt}$ attains its global maximum over the simulated time window, provided that the maximum exceeds a threshold $\\alpha$ to distinguish true ignition from slow warming. If the maximum $\\dfrac{dT}{dt}$ does not exceed $\\alpha$, report that ignition did not occur within the window.\n\nUse the Ideal Gas Law to set the initial total molar concentration $c_{\\mathrm{tot},0} = \\dfrac{P_0}{R_g T_0}$ from an initial pressure $P_0$ and initial temperature $T_0$, and allocate initial species concentrations by $c_{\\text{O}_2,0} = X_{\\text{O}_2}\\, c_{\\mathrm{tot},0}$, $c_{R,0} = X_{R_0}\\, c_{\\mathrm{tot},0}$, $c_{\\text{RO}_2,0} = 0$, $c_{P,0} = c_{\\mathrm{tot},0} - c_{\\text{O}_2,0} - c_{R,0}$ (the remainder is lumped as $P$ to preserve $c_{\\mathrm{tot},0}$ at $t=0$). Simulate up to a final time $t_f$ and compute the ignition delay time for each case.\n\nSpecify the constants and units:\n- $R_g = 8.314 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$,\n- $C_{v,m} = 20.0 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$,\n- all heats $Q_1$, $Q_2$ in $\\mathrm{J \\ mol^{-1}}$,\n- all pre-exponentials $A_1$ in $\\mathrm{m^3 \\ mol^{-1} \\ s^{-1}}$, $A_r$ and $A_2$ in $\\mathrm{s^{-1}}$,\n- all activation energies $E_1$, $E_r$, $E_2$ in $\\mathrm{J \\ mol^{-1}}$,\n- concentrations in $\\mathrm{mol \\ m^{-3}}$, time in $\\mathrm{s}$, temperature in $\\mathrm{K}$, and pressure in $\\mathrm{Pa}$.\n\nImplement the computation for the following test suite, which varies the strength of the endothermic initiation and the initial radical pool to test its effect on ignition delay:\n\n- Case $1$ (happy path, no endothermic initiation): $T_0 = 700.0$, $P_0 = 10.0 \\times 101325$, $X_{\\text{O}_2} = 0.21$, $X_{R_0} = 10^{-6}$, $A_1 = 10^{3}$, $E_1 = 5.0 \\times 10^{4}$, $A_r = 0$, $E_r = 2.0 \\times 10^{4}$, $A_2 = 10^{8}$, $E_2 = 8.0 \\times 10^{4}$, $Q_1 = 1.5 \\times 10^{4}$, $Q_2 = 2.0 \\times 10^{5}$, $t_f = 0.5$, $\\alpha = 1.0$.\n- Case $2$ (moderate endothermic initiation): same as Case $1$ but with $A_r = 10^{3}$.\n- Case $3$ (strong endothermic initiation and larger endothermicity): same as Case $1$ but with $A_r = 10^{5}$ and $Q_1 = 3.0 \\times 10^{4}$.\n- Case $4$ (edge case with a smaller radical pool): same as Case $2$ but with $X_{R_0} = 10^{-7}$.\n\nFor each case, integrate the coupled ordinary differential equations and determine the ignition delay time as defined. If ignition occurs, output the ignition delay time in seconds as a float; if it does not occur within $t_f$, output the float $-1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[t_1,t_2,t_3,t_4]$), where each $t_i$ is the ignition delay time for case $i$ in seconds. Express all times in $\\mathrm{s}$, with each float formatted to $6$ decimal places.",
            "solution": "The problem has been validated and found to be well-posed, scientifically grounded, and internally consistent. It presents a simplified but coherent model of low-temperature autoignition chemistry within a constant-volume adiabatic reactor. All necessary parameters, initial conditions, and definitions are provided to formulate and solve a system of ordinary differential equations (ODEs) and subsequently determine the ignition delay time. The nomenclature, while slightly unconventional (e.g., referring to $\\text{RO}_2 \\to R+\\text{O}_2$ as an \"initiation\" step), is clearly defined, and the governing equations are physically and mathematically sound.\n\nThe problem requires a two-part response: first, an explanation of the physical mechanism by which the endothermic reaction delays ignition, and second, a quantitative calculation of this effect.\n\n**Theoretical Framework and Governing Equations**\n\nThe physical system is a homogeneous, adiabatic, constant-volume reactor. The state of the system at any time $t$ is described by the vector of species concentrations $\\mathbf{c} = [c_R, c_{\\text{RO}_2}, c_{\\text{O}_2}, c_P]$ and the temperature $T$. The evolution of this state is governed by a system of coupled first-order ODEs derived from mass-action kinetics and energy conservation.\n\nThe reaction mechanism is:\n1. $R + \\text{O}_2 \\to \\text{RO}_2$ (forward addition, exothermic), with rate $k_1(T) = A_1 \\exp(-E_1/R_gT)$\n2. $\\text{RO}_2 \\to R + \\text{O}_2$ (reverse dissociation, endothermic), with rate $k_{-1}(T) = A_r \\exp(-E_r/R_gT)$\n3. $\\text{RO}_2 \\to P + \\dots$ (propagation/branching, exothermic), with rate $k_2(T) = A_2 \\exp(-E_2/R_gT)$\n\nAlthough reaction $3$ is written as $\\text{RO}_2 \\to P + \\text{HO}_2$, the provided ODE for the lumped product $P$, $\\frac{dc_P}{dt} = k_2(T) c_{\\text{RO}_2}$, implies a simplified stoichiometry of $\\text{RO}_2 \\to P$ for the purpose of tracking molar concentrations. This simplification is common in reduced kinetic models.\n\nThe species evolution equations are given as:\n$$ \\frac{dc_R}{dt} = -k_1 c_R c_{\\text{O}_2} + k_{-1} c_{\\text{RO}_2} $$\n$$ \\frac{dc_{\\text{RO}_2}}{dt} = k_1 c_R c_{\\text{O}_2} - k_{-1} c_{\\text{RO}_2} - k_2 c_{\\text{RO}_2} $$\n$$ \\frac{dc_{\\text{O}_2}}{dt} = -k_1 c_R c_{\\text{O}_2} + k_{-1} c_{\\text{RO}_2} $$\n$$ \\frac{dc_P}{dt} = k_2 c_{\\text{RO}_2} $$\n\nThe temperature evolution is governed by the energy balance equation for an adiabatic, constant-volume system:\n$$ \\frac{dT}{dt} = \\frac{\\dot{q}(T, \\mathbf{c})}{C_{v,\\mathrm{vol}}} $$\nwhere $\\dot{q}$ is the volumetric heat release rate and $C_{v,\\mathrm{vol}}$ is the volumetric heat capacity. The heat release rate is the sum of the rates of each reaction multiplied by its heat of reaction:\n$$ \\dot{q} = \\omega_1 Q_1 + \\omega_{-1}(-Q_1) + \\omega_2 Q_2 = Q_1 (k_1 c_R c_{\\text{O}_2} - k_{-1} c_{\\text{RO}_2}) + Q_2 k_2 c_{\\text{RO}_2} $$\nThe volumetric heat capacity is $C_{v,\\mathrm{vol}} = c_{\\mathrm{tot}} C_{v,m}$, where $c_{\\mathrm{tot}} = c_R + c_{\\text{RO}_2} + c_{\\text{O}_2} + c_P$ is the total molar concentration and $C_{v,m}$ is the constant mixture-averaged molar heat capacity. Note that the total number of moles, and thus $c_{\\mathrm{tot}}$, is not constant in this system, as the reaction $R+\\text{O}_2 \\leftrightarrow \\text{RO}_2$ changes the mole number. The rate of change of total concentration is $\\frac{dc_{\\mathrm{tot}}}{dt} = -k_1 c_R c_{\\text{O}_2} + k_{-1} c_{\\text{RO}_2}$. The formulation correctly accounts for this by including $c_{\\mathrm{tot}}$ in the denominator of the temperature ODE, making it part of the dynamic system.\n\n**The Role of the Endothermic Reaction in Delaying Ignition**\n\nIgnition is a thermal runaway phenomenon driven by a net positive feedback loop: reactions release heat, increasing the temperature, which in turn exponentially accelerates the reaction rates (per the Arrhenius law), leading to even faster heat release. The key to ignition is achieving a sufficiently large positive net heat release rate, $\\dot{q}  0$.\n\nThe expression for $\\dot{q}$ reveals the role of the endothermic step $\\text{RO}_2 \\to R + \\text{O}_2$. The term associated with this reaction is $-Q_1 k_{-1} c_{\\text{RO}_2}$. Since $Q_1$ is the positive heat of reaction for the exothermic forward step, this term represents heat absorption—a heat sink.\n\nThe process unfolds as follows:\n1. Initially, $c_{\\text{RO}_2,0}=0$. The forward reaction $R+\\text{O}_2 \\to \\text{RO}_2$ begins, producing the peroxy radical $\\text{RO}_2$ and releasing heat ($+Q_1 k_1 c_R c_{\\text{O}_2}$).\n2. As the concentration $c_{\\text{RO}_2}$ increases, its two consumption pathways become significant:\n   a. The main exothermic pathway, $\\text{RO}_2 \\to P$, contributes significantly to heating via the term $+Q_2 k_2 c_{\\text{RO}_2}$. Since typically $Q_2 \\gg Q_1$ and $E_2$ is high, this reaction is crucial for the temperature rise leading to ignition.\n   b. The endothermic reverse pathway, $\\text{RO}_2 \\to R+\\text{O}_2$, which becomes active if its rate constant $k_{-1}$ (governed by $A_r$) is non-zero. This pathway has two delaying effects:\n      i. **Direct Thermal Damping:** It directly reduces the net heat release rate $\\dot{q}$ by introducing the negative term $-Q_1 k_{-1} c_{\\text{RO}_2}$. A larger pre-exponential factor $A_r$ or a larger thermodynamic barrier $Q_1$ enhances this cooling effect.\n      ii. **Kinetic Competition:** It competes with the primary heat-releasing reaction for the same radical pool, $\\text{RO}_2$. Every mole of $\\text{RO}_2$ that dissociates back to $R+\\text{O}_2$ is a mole that cannot react via the $\\text{RO}_2 \\to P$ pathway to release the large amount of heat $Q_2$.\n\nBy both cooling the mixture and reducing the rate of the main exothermic step, the endothermic reverse reaction slows the overall rate of temperature rise, $\\frac{dT}{dt}$. This pushes the time at which $\\frac{dT}{dt}$ reaches its maximum—the ignition delay time—to later times. The test cases are designed to illustrate this: Case 2 introduces this effect ($A_r  0$) relative to Case 1 ($A_r=0$), and Case 3 strengthens it (larger $A_r$ and $Q_1$), which should progressively increase the calculated ignition delay. Case 4 demonstrates that a smaller initial radical pool further delays ignition by slowing the initial buildup of $\\text{RO}_2$.\n\n**Numerical Solution Strategy**\n\nThe problem is an initial value problem (IVP) for a system of five coupled ODEs (four for species concentrations, one for temperature).\n1.  **State Vector:** The state of the system is defined by the vector $y(t) = [c_R(t), c_{\\text{RO}_2}(t), c_{\\text{O}_2}(t), c_P(t), T(t)]^T$.\n2.  **ODE System:** A Python function is defined to compute the time derivative $\\frac{dy}{dt}$ given the current state $(t, y)$ and the fixed physical parameters of a given case. This function implements the right-hand sides of the five governing equations.\n3.  **Integration:** The `scipy.integrate.solve_ivp` function is employed to solve the IVP. Due to the potentially large differences in reaction timescales, chemical kinetics problems are often \"stiff\". Therefore, an implicit solver suitable for stiff problems, such as `Radau` or `BDF`, is chosen for robustness and efficiency. The `dense_output=True` option is used to obtain a continuous representation of the solution over the integration interval $[0, t_f]$.\n4.  **Ignition Delay Calculation:** The ignition delay time is defined as the time at which $\\frac{dT}{dt}$ reaches its global maximum.\n    - Using the dense solution from `solve_ivp`, a helper function is created that can evaluate $\\frac{dT}{dt}$ at any arbitrary time $t \\in [0, t_f]$. This is done by evaluating the state vector $y(t)$ using the dense output object, then passing this state to the ODE system function to compute the derivatives.\n    - To find the maximum of $\\frac{dT}{dt}$, we find the minimum of its negative, $-\\frac{dT}{dt}$. The `scipy.optimize.minimize_scalar` function is used for this purpose. It efficiently finds the time $t_{ign}$ that minimizes this function within the bounded interval $[0, t_f]$.\n    - The maximum value of the temperature derivative, $\\max(\\frac{dT}{dt})$, is then checked against the threshold $\\alpha=1.0 \\ \\mathrm{K/s}$. If it exceeds the threshold, the computed time $t_{ign}$ is reported. Otherwise, ignition is considered not to have occurred, and $-1.0$ is reported.\n\nThis numerical approach provides a robust and accurate method to quantify the ignition delay times for the specified test cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the autoignition problem for the four specified test cases.\n    \"\"\"\n    \n    # Global constants\n    Rg = 8.314  # J mol^-1 K^-1\n    Cvm = 20.0  # J mol^-1 K^-1\n\n    # Define the four test cases as a list of dictionaries\n    test_cases = [\n        { # Case 1: Baseline, no endothermic reverse reaction\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-6,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 0.0, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 1.5e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 1\"\n        },\n        { # Case 2: Moderate endothermic reaction\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-6,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 1e3, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 1.5e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 2\"\n        },\n        { # Case 3: Strong endothermic reaction\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-6,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 1e5, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 3.0e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 3\"\n        },\n        { # Case 4: Smaller initial radical pool\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-7,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 1e3, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 1.5e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 4\"\n        }\n    ]\n\n    results = []\n\n    def ode_system(t, y, params):\n        \"\"\"\n        Defines the system of ODEs for the reactor.\n        y = [c_R, c_RO2, c_O2, c_P, T]\n        \"\"\"\n        c_R, c_RO2, c_O2, c_P, T = y\n        A1, E1, Ar, Er, A2, E2, Q1, Q2 = params\n\n        # Enforce physical bounds to prevent numerical instability\n        c_R = max(0.0, c_R)\n        c_RO2 = max(0.0, c_RO2)\n        c_O2 = max(0.0, c_O2)\n        T = max(1.0, T)\n\n        # Arrhenius rate constants\n        k1 = A1 * np.exp(-E1 / (Rg * T))\n        k_1 = Ar * np.exp(-Er / (Rg * T))\n        k2 = A2 * np.exp(-E2 / (Rg * T))\n\n        # Reaction rates per unit volume (mol m^-3 s^-1)\n        w1 = k1 * c_R * c_O2\n        w_1 = k_1 * c_RO2\n        w2 = k2 * c_RO2\n\n        # Species rate equations\n        dcR_dt = -w1 + w_1\n        dcRO2_dt = w1 - w_1 - w2\n        dcO2_dt = -w1 + w_1 \n        dcP_dt = w2\n\n        # Energy conservation equation\n        q_dot = Q1 * w1 - Q1 * w_1 + Q2 * w2\n        c_tot = c_R + c_RO2 + c_O2 + c_P\n        # Prevent division by zero if all reactants are depleted\n        c_tot_vol = max(c_tot, 1e-20) * Cvm\n        dT_dt = q_dot / c_tot_vol\n\n        return [dcR_dt, dcRO2_dt, dcO2_dt, dcP_dt, dT_dt]\n\n    for case in test_cases:\n        # 1. Set up initial conditions\n        c_tot0 = case[\"P0\"] / (Rg * case[\"T0\"])\n        cR0 = case[\"X_R0\"] * c_tot0\n        cO20 = case[\"X_O2\"] * c_tot0\n        cRO20 = 0.0\n        cP0 = c_tot0 - cR0 - cO20\n        y0 = [cR0, cRO20, cO20, cP0, case[\"T0\"]]\n\n        tf = case[\"tf\"]\n        alpha = case[\"alpha\"]\n        \n        # Pack kinetic/thermo parameters\n        ode_params = (case[\"A1\"], case[\"E1\"], case[\"Ar\"], case[\"Er\"], \n                      case[\"A2\"], case[\"E2\"], case[\"Q1\"], case[\"Q2\"])\n\n        # 2. Integrate the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, tf],\n            y0=y0,\n            method='Radau', # A good choice for stiff ODEs in chemical kinetics\n            dense_output=True,\n            args=(ode_params,)\n        )\n\n        # 3. Find ignition delay time\n        # Define a function returning -dT/dt for the optimizer\n        def neg_dTdt(t, sol_obj, params):\n            y_t = sol_obj.sol(t)\n            derivatives = ode_system(t, y_t, params)\n            return -derivatives[4]\n\n        # Use a bounded scalar optimizer to find the time of min(-dT/dt) = max(dT/dt)\n        # Add a small epsilon to the bounds to avoid issues at the very edge.\n        opt_bounds = (1e-9, tf - 1e-9) if tf  2e-9 else (0, tf)\n        res = minimize_scalar(\n            neg_dTdt, \n            bounds=opt_bounds, \n            method='bounded', \n            args=(sol, ode_params)\n        )\n\n        ign_time = res.x\n        max_dTdt = -res.fun\n\n        # 4. Check against ignition criterion and store result\n        if max_dTdt  alpha:\n            results.append(ign_time)\n        else:\n            results.append(-1.0)\n    \n    # 5. Print results in the specified format\n    print(f\"[{','.join([f'{t:.6f}' for t in results])}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}