{
    "hands_on_practices": [
        {
            "introduction": "要理解自燃，首先要从基础热力学入手。化学反应发生时的条件——无论是定容还是定压——都深刻影响着化学能释放后如何转化为温度升高。本练习将引导您通过一个基础推导，解析地确定这两种理想情景下点火延迟时间的关系，从而揭示比热容在其中的关键作用。",
            "id": "4008434",
            "problem": "考虑一个在零维设定下经历自燃的空间均匀、绝热的理想气体反应混合物。假设一个单步不可逆反应，其单位体积总放热率由标准化学源项 $-\\sum_{j} \\dot{\\omega}_{j} h_{j}$ 表示，其中 $\\dot{\\omega}_{j}$ 是组分 $j$ 的摩尔生成速率，$h_{j}$ 是组分 $j$ 的比焓。将质量比放热率定义为\n$$\n\\dot{q}(T) \\equiv -\\frac{1}{\\rho}\\sum_{j}\\dot{\\omega}_{j} h_{j},\n$$\n因此 $\\dot{q}(T)$ 的单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$。在诱导期内，假设：\n- 混合物表现为理想气体，其混合物平均定压比热 $c_{p}$ 和定容比热 $c_{v}$ 不随时间变化，\n- 在达到选定的点火温度之前，组分和混合物分子量保持冻结，因此 $\\dot{q}(T)$ 可被视为仅是温度 $T$ 的函数，\n- 点火延迟时间 $\\tau$ 定义为温度沿绝热轨迹从初始值 $T_{0}$ 演变到给定点火温度 $T_{\\mathrm{ig}}T_{0}$ 所需的时间。\n\n在定容（CV）和定压（CP）条件下，绝热、均匀理想气体的能量平衡导出的温度演变规律为\n$$\n\\frac{dT}{dt}=\\frac{\\dot{q}(T)}{c_{v}} \\quad \\text{(CV)}, \n\\qquad\n\\frac{dT}{dt}=\\frac{\\dot{q}(T)}{c_{p}} \\quad \\text{(CP)}.\n$$\n设 $\\tau_{CV}$ 和 $\\tau_{CP}$ 分别表示在定容和定压条件下，温度从 $T_{0}$ 达到 $T_{\\mathrm{ig}}$ 所需的时间，即相应的点火延迟时间。从上述基本平衡方程和理想气体假设出发，推导一个用 $c_{p}$、$c_{v}$ 和 $\\tau_{CV}$ 表示的差值 $\\tau_{CP}-\\tau_{CV}$ 的解析表达式。\n\n将最终答案表示为单个闭式解析表达式。无需进行数值代入。",
            "solution": "首先对问题进行验证，确认其是自洽的，以热力学和化学动力学原理为科学基础，并且是适定的。\n\n目标是推导定压（CP）过程和定容（CV）过程的点火延迟时间之差 $\\tau_{CP} - \\tau_{CV}$ 的解析表达式。\n\n出发点是均匀、绝热的理想气体反应混合物的温度演变控制方程：\n1.  对于定容过程：\n    $$\n    \\frac{dT}{dt} = \\frac{\\dot{q}(T)}{c_{v}}\n    $$\n2.  对于定压过程：\n    $$\n    \\frac{dT}{dt} = \\frac{\\dot{q}(T)}{c_{p}}\n    $$\n此处，$T$ 是温度，$t$ 是时间，$\\dot{q}(T)$ 是质量比放热率（假设在诱导期内仅依赖于温度），$c_{v}$ 和 $c_{p}$ 分别是恒定的混合物平均定容比热和定压比热。\n\n点火延迟时间 $\\tau$ 定义为温度从初始值 $T_{0}$ 升高到指定的点火温度 $T_{\\mathrm{ig}}$ 所需的时间。为求得此时间，我们可以将控制方程视为一阶可分离常微分方程。\n\n对于定容（CV）情况，我们分离变量：\n$$\ndt = \\frac{c_v}{\\dot{q}(T)} dT\n$$\n在诱导期内对两边积分，时间 $t$ 从 $0$ 变为 $\\tau_{CV}$，温度 $T$ 从 $T_{0}$ 变为 $T_{\\mathrm{ig}}$：\n$$\n\\int_{0}^{\\tau_{CV}} dt = \\int_{T_{0}}^{T_{\\mathrm{ig}}} \\frac{c_v}{\\dot{q}(T)} dT\n$$\n由于假设 $c_{v}$ 是常数，可以将其移到积分号外：\n$$\n\\tau_{CV} = c_{v} \\int_{T_{0}}^{T_{\\mathrm{ig}}} \\frac{1}{\\dot{q}(T)} dT\n$$\n此方程给出了定容条件下的点火延迟时间表达式。\n\n类似地，对于定压（CP）情况，我们对其控制方程进行变量分离：\n$$\ndt = \\frac{c_p}{\\dot{q}(T)} dT\n$$\n从 $t=0$ 到 $t=\\tau_{CP}$ 以及 $T=T_{0}$ 到 $T=T_{\\mathrm{ig}}$ 进行积分：\n$$\n\\int_{0}^{\\tau_{CP}} dt = \\int_{T_{0}}^{T_{\\mathrm{ig}}} \\frac{c_p}{\\dot{q}(T)} dT\n$$\n由于 $c_{p}$ 也是常数，我们有：\n$$\n\\tau_{CP} = c_{p} \\int_{T_{0}}^{T_{\\mathrm{ig}}} \\frac{1}{\\dot{q}(T)} dT\n$$\n这是定压条件下的点火延迟时间表达式。\n\n我们观察到 $\\tau_{CV}$ 和 $\\tau_{CP}$ 的表达式都包含相同的定积分，我们可以将其定义为 $I$：\n$$\nI \\equiv \\int_{T_{0}}^{T_{\\mathrm{ig}}} \\frac{1}{\\dot{q}(T)} dT\n$$\n该积分取决于初始和最终温度以及放热率的函数形式，但在所述假设下，它对于 CV 和 CP 两种情况是相同的。\n\n现在我们可以用这个公共积分 $I$ 来表示点火延迟时间：\n$$\n\\tau_{CV} = c_{v} I\n$$\n$$\n\\tau_{CP} = c_{p} I\n$$\n题目要求用 $c_{p}$、$c_{v}$ 和 $\\tau_{CV}$ 表示 $\\tau_{CP} - \\tau_{CV}$ 的表达式。从 $\\tau_{CV}$ 的方程中，我们可以将积分 $I$ 表示为：\n$$\nI = \\frac{\\tau_{CV}}{c_{v}}\n$$\n现在，将这个 $I$ 的表达式代入 $\\tau_{CP}$ 的方程中：\n$$\n\\tau_{CP} = c_{p} \\left( \\frac{\\tau_{CV}}{c_{v}} \\right) = \\frac{c_{p}}{c_{v}} \\tau_{CV}\n$$\n该方程表明，定压下的点火延迟时间比定容下的长，其系数为 $\\frac{c_p}{c_v}$，即热容比 $\\gamma$。这在物理上是自洽的，因为对于理想气体，$c_p  c_v$。在定压过程中，一部分释放的化学能必须用于对环境做膨胀功，从而减少了可用于提高混合物温度的能量。因此，温度上升得更慢，导致点火延迟时间更长。\n\n最后，我们计算所要求的差值 $\\tau_{CP} - \\tau_{CV}$：\n$$\n\\tau_{CP} - \\tau_{CV} = \\frac{c_{p}}{c_{v}} \\tau_{CV} - \\tau_{CV}\n$$\n提出公因子 $\\tau_{CV}$，我们得到：\n$$\n\\tau_{CP} - \\tau_{CV} = \\left( \\frac{c_{p}}{c_{v}} - 1 \\right) \\tau_{CV}\n$$\n为了将其表示为单个分数，我们合并括号内的项：\n$$\n\\tau_{CP} - \\tau_{CV} = \\left( \\frac{c_{p} - c_{v}}{c_{v}} \\right) \\tau_{CV}\n$$\n这就是用指定量表示的点火延迟时间差值的最终解析表达式。",
            "answer": "$$\n\\boxed{\\left( \\frac{c_{p} - c_{v}}{c_{v}} \\right) \\tau_{CV}}\n$$"
        },
        {
            "introduction": "自燃的核心是活性自由基池的指数级增长。我们可以运用线性稳定性分析这一强大工具来解析这种化学失控过程。本练习要求您计算反应体系雅可比矩阵的特征值，以找出主导增长率 $\\lambda_{\\max}$，并将其与自燃延迟时间直接关联起来。",
            "id": "4008423",
            "problem": "要求您实现一个完整的、可运行的程序，用于在指定的温度和组分下，计算简化的氢氧 (H$_2$/O$_2$) 反应机理的线性化自由基子系统雅可比矩阵的最大实部特征值 $\\lambda_{\\max}$，并将其大小与预期的自燃诱导时间关联起来。该程序必须是自包含的，并能为指定的测试套件生成结果。\n\n假设在 $P = 1\\,\\mathrm{atm}$ 的条件下，有一个等温、等压的气体混合物，其摩尔分数为 $X_{\\mathrm{H_2}}$、$X_{\\mathrm{O_2}}$ 和 $X_{\\mathrm{N_2}}$（氮气作为惰性载气）。根据理想气体定律，$C_{\\mathrm{tot}} = P/\\left(R_u T\\right)$，其中 $R_u$ 是普适气体常数，可得到总摩尔浓度。物种的摩尔浓度（单位：$\\mathrm{mol/m^3}$）为 $C_i = X_i C_{\\mathrm{tot}}$。该简化机理遵循质量作用定律和阿伦尼乌斯动力学，通过以下反应来追踪自由基的生成和消耗：\n\n1. $\\mathrm{H} + \\mathrm{O_2} \\rightarrow \\mathrm{O} + \\mathrm{OH}$，反应速率为 $r_1 = k_1(T)\\, [\\mathrm{H}][\\mathrm{O_2}]$。\n2. $\\mathrm{O} + \\mathrm{H_2} \\rightarrow \\mathrm{H} + \\mathrm{OH}$，反应速率为 $r_2 = k_2(T)\\, [\\mathrm{O}][\\mathrm{H_2}]$。\n3. $\\mathrm{OH} + \\mathrm{H_2} \\rightarrow \\mathrm{H} + \\mathrm{H_2O}$，反应速率为 $r_4 = k_4(T)\\, [\\mathrm{OH}][\\mathrm{H_2}]$。\n\n此处 $[\\cdot]$ 表示摩尔浓度，单位为 $\\mathrm{mol/m^3}$。速率常数 $k_j(T)$ 符合阿伦尼乌斯形式 $k_j(T) = A_j\\, T^{n_j} \\exp\\left(-E_{a,j}/(R_u T)\\right)$，其中 $j \\in \\{1,2,4\\}$，参数如下（给定单位为立方厘米每摩尔每秒和卡每摩尔，您必须将其转换为国际单位制（SI））：\n\n- 反应 $1$：$A_1 = 2.65\\times 10^{16}\\,\\mathrm{cm^3/(mol\\cdot s)}$，$n_1 = -0.670$，$E_{a,1} = 1.704\\times 10^{4}\\,\\mathrm{cal/mol}$。\n- 反应 $2$：$A_2 = 3.87\\times 10^{4}\\,\\mathrm{cm^3/(mol\\cdot s)}$，$n_2 = 2.70$，$E_{a,2} = 6260\\,\\mathrm{cal/mol}$。\n- 反应 $4$：$A_4 = 2.06\\times 10^{8}\\,\\mathrm{cm^3/(mol\\cdot s)}$，$n_4 = 1.52$，$E_{a,4} = 3430\\,\\mathrm{cal/mol}$。\n\n到国际单位制的转换规则为：$1\\,\\mathrm{cm^3/(mol\\cdot s)} = 10^{-6}\\,\\mathrm{m^3/(mol\\cdot s)}$ 和 $1\\,\\mathrm{cal/mol} = 4.184\\,\\mathrm{J/mol}$。使用 $R_u = 8.31446261815324\\,\\mathrm{J/(mol\\cdot K)}$。\n\n通过将 $[\\mathrm{H_2}]$ 和 $[\\mathrm{O_2}]$ 视为等于其初始值的常数，并写出自由基状态向量 $\\mathbf{x} = \\big([\\mathrm{H}], [\\mathrm{O}], [\\mathrm{OH}]\\big)^\\top$，来对早期自由基动力学进行线性化。在此近似下，线性系统 $\\dot{\\mathbf{x}} = \\mathbf{A}\\,\\mathbf{x}$ 的雅可比矩阵为\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n- a_1  a_2  a_4 \\\\\na_1  - a_2  0 \\\\\na_1  a_2  - a_4\n\\end{bmatrix},\n\\quad\na_1 = k_1(T)\\,[\\mathrm{O_2}],\\quad\na_2 = k_2(T)\\,[\\mathrm{H_2}],\\quad\na_4 = k_4(T)\\,[\\mathrm{H_2}].\n$$\n令 $\\lambda_{\\max}$ 为矩阵 $\\mathbf{A}$ 的特征值中的最大实部。当 $\\lambda_{\\max}  0$ 时，将预期的自燃诱导时间解释为 $t_{\\mathrm{ind}} \\approx 1/\\lambda_{\\max}$。如果 $\\lambda_{\\max} \\leq 0$，则设 $t_{\\mathrm{ind}} = +\\infty$。\n\n您的程序必须：\n- 为每个测试用例计算 SI 单位下的 $k_1(T)$、$k_2(T)$ 和 $k_4(T)$。\n- 根据 $X_{\\mathrm{H_2}}$、$X_{\\mathrm{O_2}}$、$P$ 和 $T$，使用理想气体定律计算 $[\\mathrm{H_2}]$ 和 $[\\mathrm{O_2}]$（单位为 $\\mathrm{mol/m^3}$）。\n- 组装矩阵 $\\mathbf{A}$，计算其特征值，并确定 $\\lambda_{\\max}$ 为其特征值实部的最大值（单位为 $\\mathrm{s^{-1}}$）。\n- 按规定计算 $t_{\\mathrm{ind}}$（单位为秒）。\n- 报告 $\\lambda_{\\max}$ 和 $t_{\\mathrm{ind}}$，均四舍五入到六位小数，但如果 $t_{\\mathrm{ind}} = +\\infty$，则返回浮点无穷大，不进行四舍五入。\n\n物理单位要求：以 $\\mathrm{s^{-1}}$ 为单位输出 $\\lambda_{\\max}$，以 $\\mathrm{s}$ 为单位输出 $t_{\\mathrm{ind}}$。\n\n角度单位不适用。百分比不适用。\n\n测试套件（每个用例指定温度 $T$（单位为 K）以及 $\\mathrm{H_2}$、$\\mathrm{O_2}$ 和 $\\mathrm{N_2}$ 的摩尔分数，其总和为 $1$）：\n- 用例 1：$T = 900$，$X_{\\mathrm{H_2}} = 0.05$，$X_{\\mathrm{O_2}} = 0.05$，$X_{\\mathrm{N_2}} = 0.90$。\n- 用例 2：$T = 1200$，$X_{\\mathrm{H_2}} = 0.05$，$X_{\\mathrm{O_2}} = 0.10$，$X_{\\mathrm{N_2}} = 0.85$。\n- 用例 3：$T = 1800$，$X_{\\mathrm{H_2}} = 0.03$，$X_{\\mathrm{O_2}} = 0.21$，$X_{\\mathrm{N_2}} = 0.76$。\n\n最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素是对应测试用例的二元列表 $[\\lambda_{\\max}, t_{\\mathrm{ind}}]$。例如，输出应如下所示：\n$[[\\lambda_1,t_1],[\\lambda_2,t_2],[\\lambda_3,t_3]]$\n每个数值都按规定进行四舍五入。",
            "solution": "该问题被评估为有效。它在科学上基于化学动力学和线性稳定性分析的原理，在数学上是良定的，并为求解提供了完整且一致的数据和定义集。必要的物理常数，如从大气压到帕斯卡的转换，是标准的，并且通过为其他给定常数使用国际单位制（SI）而明确地被隐含。\n\n解决方案首先建立物理和化学背景，然后推导数学模型，最后详细说明用于求解所要求数量的计算算法。\n\n**1. 物理参数和浓度**\n\n分析对象为等温、等压的气体混合物。混合物的总摩尔浓度 $C_{\\mathrm{tot}}$ 由理想气体定律给出：\n$$ C_{\\mathrm{tot}} = \\frac{P}{R_u T} $$\n其中压力 $P = 1\\,\\mathrm{atm} = 101325\\,\\mathrm{Pa}$，温度 $T$ 为每个用例指定，普适气体常数 $R_u = 8.31446261815324\\,\\mathrm{J/(mol\\cdot K)}$。稳定物种氢气 ($[\\mathrm{H_2}]$) 和氧气 ($[\\mathrm{O_2}]$) 的摩尔浓度由其初始摩尔分数 $X_{\\mathrm{H_2}}$ 和 $X_{\\mathrm{O_2}}$ 计算得出：\n$$ [\\mathrm{H_2}] = X_{\\mathrm{H_2}} C_{\\mathrm{tot}} \\quad \\text{和} \\quad [\\mathrm{O_2}] = X_{\\mathrm{O_2}} C_{\\mathrm{tot}} $$\n这些浓度的国际单位制单位为 $\\mathrm{mol/m^3}$，并假设在自燃的早期诱导阶段保持不变。\n\n**2. 化学动力学和速率常数**\n\n问题提供了一个简化的氢氧系统三步反应机理。这些反应的速率由阿伦尼乌斯动力学控制，其中反应 $j$ 的速率常数 $k_j(T)$ 由下式给出：\n$$ k_j(T) = A_j T^{n_j} \\exp\\left(-\\frac{E_{a,j}}{R_u T}\\right) $$\n对于反应 $j \\in \\{1, 2, 4\\}$，给出了指前因子 $A_j$、温度指数 $n_j$ 和活化能 $E_{a,j}$。给定的参数必须转换为国际单位制：\n- 指前因子 ($A_j$)：从 $\\mathrm{cm^3/(mol\\cdot s)}$ 转换为 $\\mathrm{m^3/(mol\\cdot s)}$，需乘以 $10^{-6}$。\n- 活化能 ($E_{a,j}$)：从 $\\mathrm{cal/mol}$ 转换为 $\\mathrm{J/mol}$，需乘以 $4.184$。\n\n国际单位制下的值为：\n- 反应 $1$：$A_1 = 2.65 \\times 10^{10}\\,\\mathrm{m^3/(mol\\cdot s)}$, $n_1 = -0.670$, $E_{a,1} = 71295.36\\,\\mathrm{J/mol}$。\n- 反应 $2$：$A_2 = 3.87 \\times 10^{-2}\\,\\mathrm{m^3/(mol\\cdot s)}$, $n_2 = 2.70$, $E_{a,2} = 26191.84\\,\\mathrm{J/mol}$。\n- 反应 $4$：$A_4 = 206\\,\\mathrm{m^3/(mol\\cdot s)}$, $n_4 = 1.52$, $E_{a,4} = 14351.12\\,\\mathrm{J/mol}$。\n\n**3. 线性化的自由基动力学**\n\n由状态向量 $\\mathbf{x} = \\big([\\mathrm{H}], [\\mathrm{O}], [\\mathrm{OH}]\\big)^\\top$ 表示的自由基物种浓度的演变，由一个常微分方程（ODEs）系统描述。每个自由基的净变化率是其在三个反应中生成和消耗速率的总和：\n\\begin{align*}\n\\frac{d[\\mathrm{H}]}{dt} = -r_1 + r_2 + r_4 = -k_1(T)[\\mathrm{O_2}][\\mathrm{H}] + k_2(T)[\\mathrm{H_2}][\\mathrm{O}] + k_4(T)[\\mathrm{H_2}][\\mathrm{OH}] \\\\\n\\frac{d[\\mathrm{O}]}{dt} = r_1 - r_2 = k_1(T)[\\mathrm{O_2}][\\mathrm{H}] - k_2(T)[\\mathrm{H_2}][\\mathrm{O}] \\\\\n\\frac{d[\\mathrm{OH}]}{dt} = r_1 + r_2 - r_4 = k_1(T)[\\mathrm{O_2}][\\mathrm{H}] + k_2(T)[\\mathrm{H_2}][\\mathrm{O}] - k_4(T)[\\mathrm{H_2}][\\mathrm{OH}]\n\\end{align*}\n在 $[\\mathrm{H_2}]$ 和 $[\\mathrm{O_2}]$ 恒定的近似下，该常微分方程系统在自由基浓度上是线性的。它可以写成矩阵形式 $\\dot{\\mathbf{x}} = \\mathbf{A}\\,\\mathbf{x}$，其中 $\\mathbf{A}$ 是该系统的雅可比矩阵。通过定义系数 $a_1 = k_1(T)[\\mathrm{O_2}]$，$a_2 = k_2(T)[\\mathrm{H_2}]$ 和 $a_4 = k_4(T)[\\mathrm{H_2}]$，雅可比矩阵为：\n$$\n\\mathbf{A} = \\frac{\\partial \\dot{\\mathbf{x}}}{\\partial \\mathbf{x}^\\top} =\n\\begin{bmatrix}\n-a_1  a_2  a_4 \\\\\na_1  -a_2  0 \\\\\na_1  a_2  -a_4\n\\end{bmatrix}\n$$\n该矩阵与问题陈述中提供的矩阵相同，从而证实了其推导。\n\n**4. 特征值分析和诱导时间**\n\n线性系统 $\\dot{\\mathbf{x}} = \\mathbf{A}\\,\\mathbf{x}$ 的行为由矩阵 $\\mathbf{A}$ 的特征值决定。如果任何一个特征值具有正实部，则对应的模式将呈指数增长，导致自由基浓度失控增加，这正是自燃的定义。主导增长率由所有特征值中的最大实部给出，记为 $\\lambda_{\\max} = \\max(\\mathrm{Re}(\\lambda_i))$，其中 $\\lambda_i$ 是 $\\mathbf{A}$ 的特征值。\n\n该指数增长的特征时间尺度是自燃诱导时间 $t_{\\mathrm{ind}}$。对于 $\\lambda_{\\max}  0$，该时间与增长率成反比：\n$$ t_{\\mathrm{ind}} \\approx \\frac{1}{\\lambda_{\\max}} $$\n如果 $\\lambda_{\\max} \\le 0$，则自由基浓度没有指数增长，因此该线性模型预测不会发生点火。在这种情况下，诱导时间被认为是无限的，$t_{\\mathrm{ind}} = +\\infty$。\n\n**5. 计算步骤**\n\n对于由 $T$、$X_{\\mathrm{H_2}}$ 和 $X_{\\mathrm{O_2}}$ 定义的每个测试用例：\n1.  使用理想气体定律计算恒定浓度 $[\\mathrm{H_2}]$ 和 $[\\mathrm{O_2}]$（单位：$\\mathrm{mol/m^3}$）。\n2.  使用阿伦尼乌斯方程和国际单位制参数计算速率常数 $k_1(T)$、$k_2(T)$ 和 $k_4(T)$（单位：$\\mathrm{m^3/(mol\\cdot s)}$）。\n3.  计算系数 $a_1$、$a_2$ 和 $a_4$（单位：$\\mathrm{s^{-1}}$）。\n4.  组装 $3 \\times 3$ 的雅可比矩阵 $\\mathbf{A}$。\n5.  使用数值线性代数库计算 $\\mathbf{A}$ 的特征值。\n6.  通过找到计算出的特征值实部的最大值来确定 $\\lambda_{\\max}$。\n7.  计算 $t_{\\mathrm{ind}}$。如果 $\\lambda_{\\max}  0$，则 $t_{\\mathrm{ind}} = 1/\\lambda_{\\max}$。否则，将 $t_{\\mathrm{ind}}$ 设置为浮点无穷大。\n8.  最终结果 $\\lambda_{\\max}$ 和 $t_{\\mathrm{ind}}$ 按要求四舍五入到六位小数以进行数值输出。\n在提供的程序中实现了此过程，以便为指定的测试套件生成解决方案。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the largest real-part eigenvalue of the linearized radical-subsystem\n    Jacobian for a reduced H2/O2 mechanism and the corresponding autoignition\n    induction time for a suite of test cases.\n    \"\"\"\n    # Universal gas constant in J/(mol.K)\n    R_u = 8.31446261815324\n    # Pressure in Pa (1 atm)\n    P = 101325.0\n\n    # Conversion factors\n    cal_to_J = 4.184\n    cm3_to_m3 = 1.0e-6\n\n    # Arrhenius parameters for the reactions in SI units\n    # k_j(T) = A_j * T^n_j * exp(-E_{a,j} / (R_u * T))\n    # Units: A_j in m^3/(mol.s), E_{a,j} in J/mol\n    params = {\n        1: { # H + O2 - O + OH\n            'A': 2.65e16 * cm3_to_m3,\n            'n': -0.670,\n            'Ea': 1.704e4 * cal_to_J\n        },\n        2: { # O + H2 - H + OH\n            'A': 3.87e4 * cm3_to_m3,\n            'n': 2.70,\n            'Ea': 6260.0 * cal_to_J\n        },\n        4: { # OH + H2 - H + H2O\n            'A': 2.06e8 * cm3_to_m3,\n            'n': 1.52,\n            'Ea': 3430.0 * cal_to_J\n        }\n    }\n\n    # Test cases: (T in K, X_H2, X_O2, X_N2)\n    test_cases = [\n        (900.0, 0.05, 0.05, 0.90),\n        (1200.0, 0.05, 0.10, 0.85),\n        (1800.0, 0.03, 0.21, 0.76)\n    ]\n\n    results_for_printing = []\n\n    def arrhenius_k(T, A, n, Ea):\n        \"\"\"Calculates the Arrhenius rate constant k(T).\"\"\"\n        return A * (T**n) * np.exp(-Ea / (R_u * T))\n\n    for T, X_H2, X_O2, _ in test_cases:\n        # Calculate total molar concentration C_tot in mol/m^3\n        C_tot = P / (R_u * T)\n\n        # Calculate concentrations of H2 and O2 in mol/m^3\n        C_H2 = X_H2 * C_tot\n        C_O2 = X_O2 * C_tot\n\n        # Calculate rate constants k_j(T) in m^3/(mol.s)\n        k1 = arrhenius_k(T, params[1]['A'], params[1]['n'], params[1]['Ea'])\n        k2 = arrhenius_k(T, params[2]['A'], params[2]['n'], params[2]['Ea'])\n        k4 = arrhenius_k(T, params[4]['A'], params[4]['n'], params[4]['Ea'])\n\n        # Calculate Jacobian coefficients a_j in s^-1\n        a1 = k1 * C_O2\n        a2 = k2 * C_H2\n        a4 = k4 * C_H2\n\n        # Assemble the Jacobian matrix A\n        A = np.array([\n            [-a1, a2, a4],\n            [a1, -a2, 0],\n            [a1, a2, -a4]\n        ])\n\n        # Compute eigenvalues and find the maximum real part (lambda_max)\n        eigenvalues = np.linalg.eigvals(A)\n        lambda_max = np.max(np.real(eigenvalues))\n\n        # Compute induction time t_ind\n        if lambda_max > 0:\n            t_ind = 1.0 / lambda_max\n            t_ind_str = f\"{t_ind:.6f}\"\n        else:\n            t_ind = float('inf')\n            t_ind_str = \"inf\"\n            \n        lambda_max_str = f\"{lambda_max:.6f}\"\n        \n        # Format the result pair as a string \"[lambda,t_ind]\"\n        result_pair_str = f\"[{lambda_max_str},{t_ind_str}]\"\n        results_for_printing.append(result_pair_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_for_printing)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "碳氢燃料的自燃行为，尤其是在低温区，受控于复杂的反应网络，其中既包含放热步骤也包含吸热步骤。本计算实践将通过模拟一个简化的动力学模型，探索吸热反应如何与放热路径竞争，从而暂时抑制温度上升并延长点火延迟。这为我们理解负温度系数（NTC）等现象提供了关键的洞察。",
            "id": "4008479",
            "problem": "考虑一个均相、绝热、恒容反应器，用于模拟低温（LT）过氧化学，其包含一个能够捕捉吸热引发步骤及其对点火延迟影响的最小机理。所涉及的物种为通用燃料自由基 $R$、分子氧 $O_2$、过氧自由基 $RO_2$ 和集总产物 $P$。基元反应包括：(i) $R + O_2 \\rightarrow RO_2$，每摩尔放出热量 $+Q_1$（放热）；(ii) $RO_2 \\rightarrow R + O_2$，每摩尔吸收热量 $-Q_1$（吸热）；(iii) $RO_2 \\rightarrow P + HO_2$，每摩尔放出热量 $+Q_2$（放热）。所有反应均遵循质量作用动力学的阿伦尼乌斯速率定律。设 $A_1$、$E_1$ 分别为 $R + O_2 \\rightarrow RO_2$ 的指前因子和活化能，$A_r$、$E_r$ 分别为 $RO_2 \\rightarrow R + O_2$ 的指前因子和活化能，以及 $A_2$、$E_2$ 分别为 $RO_2 \\rightarrow P + HO_2$ 的指前因子和活化能。设 $R_g$ 为普适气体常数。速率常数为 $k_1(T) = A_1 \\exp\\!\\left(-\\dfrac{E_1}{R_g T}\\right)$、$k_{-1}(T) = A_r \\exp\\!\\left(-\\dfrac{E_r}{R_g T}\\right)$ 和 $k_2(T) = A_2 \\exp\\!\\left(-\\dfrac{E_2}{R_g T}\\right)$。浓度（单位为 $\\mathrm{mol \\ m^{-3}}$）分别为 $c_R$、$c_{O_2}$、$c_{RO_2}$ 和 $c_P$，温度为 $T$。\n\n从基本定律和核心定义出发：\n- 使用质量作用动力学编写物种演化方程：\n$$\\frac{dc_R}{dt} = -k_1(T)\\, c_R\\, c_{O_2} + k_{-1}(T)\\, c_{RO_2},$$\n$$\\frac{dc_{RO_2}}{dt} = k_1(T)\\, c_R\\, c_{O_2} - k_{-1}(T)\\, c_{RO_2} - k_2(T)\\, c_{RO_2},$$\n$$\\frac{dc_{O_2}}{dt} = -k_1(T)\\, c_R\\, c_{O_2} + k_{-1}(T)\\, c_{RO_2},$$\n$$\\frac{dc_{P}}{dt} = k_2(T)\\, c_{RO_2}.$$\n- 对绝热恒容反应器应用能量守恒定律。将混合物的恒定摩尔等容热容记为 $C_{v,m}$（在此简化方案中假定其与温度无关），总摩尔浓度记为 $c_{\\mathrm{tot}} = c_R + c_{RO_2} + c_{O_2} + c_P$。体积热容为 $C_{v,\\mathrm{vol}} = c_{\\mathrm{tot}}\\, C_{v,m}$。体积放热率 $\\dot{q}$ 是各反应速率乘以其摩尔反应热的总和：\n$$\\dot{q}(T, \\mathbf{c}) = Q_1\\, k_1(T)\\, c_R\\, c_{O_2} - Q_1\\, k_{-1}(T)\\, c_{RO_2} + Q_2\\, k_2(T)\\, c_{RO_2}.$$\n温度演化方程为\n$$\\frac{dT}{dt} = \\frac{\\dot{q}(T, \\mathbf{c})}{C_{v,\\mathrm{vol}}} = \\frac{Q_1\\, k_1(T)\\, c_R\\, c_{O_2} - Q_1\\, k_{-1}(T)\\, c_{RO_2} + Q_2\\, k_2(T)\\, c_{RO_2}}{(c_R + c_{RO_2} + c_{O_2} + c_{P})\\, C_{v,m}}.$$\n\n在此框架内，解释吸热引发步骤 $RO_2 \\rightarrow R + O_2$ 如何通过暂时降低 $\\dot{q}$ 来延迟点火，并通过在一个简单的低温（LT）方案中计算不同参数集下的点火延迟时间来量化此效应。将点火延迟时间定义为在模拟时间窗口内 $\\dfrac{dT}{dt}$ 达到其全局最大值的时间，前提是该最大值超过一个阈值 $\\alpha$，以区分真正的点火和缓慢升温。如果 $\\dfrac{dT}{dt}$ 的最大值未超过 $\\alpha$，则报告在该时间窗口内未发生点火。\n\n使用理想气体定律根据初始压力 $P_0$ 和初始温度 $T_0$ 设置初始总摩尔浓度 $c_{\\mathrm{tot},0} = \\dfrac{P_0}{R_g T_0}$，并通过以下方式分配初始物种浓度：$c_{O_2,0} = X_{O_2}\\, c_{\\mathrm{tot},0}$，$c_{R,0} = X_{R_0}\\, c_{\\mathrm{tot},0}$，$c_{RO_2,0} = 0$，$c_{P,0} = c_{\\mathrm{tot},0} - c_{O_2,0} - c_{R,0}$（剩余部分作为 $P$ 集总，以在 $t=0$ 时保持 $c_{\\mathrm{tot},0}$ 不变）。模拟至最终时间 $t_f$ 并计算每种情况的点火延迟时间。\n\n指定常数和单位：\n- $R_g = 8.314 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$，\n- $C_{v,m} = 20.0 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$，\n- 所有热量 $Q_1$、$Q_2$ 的单位为 $\\mathrm{J \\ mol^{-1}}$，\n- 所有指前因子 $A_1$ 的单位为 $\\mathrm{m^3 \\ mol^{-1} \\ s^{-1}}$，$A_r$ 和 $A_2$ 的单位为 $\\mathrm{s^{-1}}$，\n- 所有活化能 $E_1$、$E_r$、$E_2$ 的单位为 $\\mathrm{J \\ mol^{-1}}$，\n- 浓度的单位为 $\\mathrm{mol \\ m^{-3}}$，时间的单位为 $\\mathrm{s}$，温度的单位为 $\\mathrm{K}$，压力的单位为 $\\mathrm{Pa}$。\n\n为以下测试套件实现计算，该套件通过改变吸热引发的强度和初始自由基池来测试其对点火延迟的影响：\n\n- 案例1（理想情况，无吸热引发）：$T_0 = 700.0$，$P_0 = 10.0 \\times 101325$，$X_{O_2} = 0.21$，$X_{R_0} = 10^{-6}$，$A_1 = 10^{3}$，$E_1 = 5.0 \\times 10^{4}$，$A_r = 0$，$E_r = 2.0 \\times 10^{4}$，$A_2 = 10^{8}$，$E_2 = 8.0 \\times 10^{4}$，$Q_1 = 1.5 \\times 10^{4}$，$Q_2 = 2.0 \\times 10^{5}$，$t_f = 0.5$，$\\alpha = 1.0$。\n- 案例2（中等吸热引发）：与案例1相同，但 $A_r = 10^{3}$。\n- 案例3（强吸热引发和更大的吸热性）：与案例1相同，但 $A_r = 10^{5}$ 且 $Q_1 = 3.0 \\times 10^{4}$。\n- 案例4（具有较小自由基池的边缘情况）：与案例2相同，但 $X_{R_0} = 10^{-7}$。\n\n对于每种情况，积分耦合的常微分方程组，并按定义确定点火延迟时间。如果发生点火，则以浮点数形式输出以秒为单位的点火延迟时间；如果在 $t_f$ 内未发生点火，则输出浮点数 $-1.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[t_1,t_2,t_3,t_4]$），其中每个 $t_i$ 是情况 $i$ 的点火延迟时间（秒）。所有时间均以 $\\mathrm{s}$ 表示，每个浮点数格式化为 $6$ 位小数。",
            "solution": "该问题已经过验证，被认为是适定的、有科学依据且内部一致的。它提出了一个简化但连贯的恒容绝热反应器中低温自燃化学模型。所有必要的参数、初始条件和定义都已提供，足以构建和求解一个常微分方程（ODE）系统，并随后确定点火延迟时间。尽管术语略显非传统（例如，将 $RO_2 \\rightarrow R+O_2$ 称为“引发”步骤），但其定义清晰，且控制方程在物理上和数学上都是合理的。\n\n该问题需要两部分回答：首先，解释吸热反应延迟点火的物理机理；其次，对该效应进行定量计算。\n\n**理论框架与控制方程**\n\n物理系统是一个均相、绝热、恒容反应器。系统在任意时刻 $t$ 的状态由物种浓度向量 $\\mathbf{c} = [c_R, c_{RO_2}, c_{O_2}, c_P]$ 和温度 $T$ 描述。该状态的演化由一个源于质量作用动力学和能量守恒的一阶耦合常微分方程组控制。\n\n反应机理为：\n1. $R + O_2 \\rightarrow RO_2$ (正向加成，放热)，速率为 $k_1(T) = A_1 \\exp(-E_1/R_gT)$\n2. $RO_2 \\rightarrow R + O_2$ (逆向离解，吸热)，速率为 $k_{-1}(T) = A_r \\exp(-E_r/R_gT)$\n3. $RO_2 \\rightarrow P + \\dots$ (链增长/链分支，放热)，速率为 $k_2(T) = A_2 \\exp(-E_2/R_gT)$\n\n尽管反应3写作 $RO_2 \\rightarrow P + HO_2$，但为集总产物 $P$ 提供的常微分方程 $\\frac{dc_P}{dt} = k_2(T) c_{RO_2}$ 暗示了为追踪摩尔浓度而简化的化学计量关系 $RO_2 \\rightarrow P$。这种简化在简化动力学模型中很常见。\n\n物种演化方程如下：\n$$ \\frac{dc_R}{dt} = -k_1 c_R c_{O_2} + k_{-1} c_{RO_2} $$\n$$ \\frac{dc_{RO_2}}{dt} = k_1 c_R c_{O_2} - k_{-1} c_{RO_2} - k_2 c_{RO_2} $$\n$$ \\frac{dc_{O_2}}{dt} = -k_1 c_R c_{O_2} + k_{-1} c_{RO_2} $$\n$$ \\frac{dc_P}{dt} = k_2 c_{RO_2} $$\n\n温度演化由绝热、恒容系统的能量平衡方程控制：\n$$ \\frac{dT}{dt} = \\frac{\\dot{q}(T, \\mathbf{c})}{C_{v,\\mathrm{vol}}} $$\n其中 $\\dot{q}$ 是体积放热率，$C_{v,\\mathrm{vol}}$ 是体积热容。放热率是每个反应的速率乘以其反应热的总和：\n$$ \\dot{q} = \\omega_1 Q_1 + \\omega_{-1}(-Q_1) + \\omega_2 Q_2 = Q_1 (k_1 c_R c_{O_2} - k_{-1} c_{RO_2}) + Q_2 k_2 c_{RO_2} $$\n体积热容为 $C_{v,\\mathrm{vol}} = c_{\\mathrm{tot}} C_{v,m}$，其中 $c_{\\mathrm{tot}} = c_R + c_{RO_2} + c_{O_2} + c_P$ 是总摩尔浓度，$C_{v,m}$ 是恒定的混合物平均摩尔热容。请注意，在该系统中，总摩尔数以及 $c_{\\mathrm{tot}}$ 不是恒定的，因为反应 $R+O_2 \\leftrightarrow RO_2$ 会改变摩尔数。该公式通过将 $c_{\\mathrm{tot}}$ 包含在温度常微分方程的分母中来正确地考虑了这一点，使其成为动态系统的一部分。\n\n**吸热反应在延迟点火中的作用**\n\n点火是一种热失控现象，由一个净正反馈回路驱动：反应释放热量，使温度升高，而温度升高又会根据阿伦尼乌斯定律指数级地加速反应速率，导致更快的放热。点火的关键是实现足够大的净正放热率，即 $\\dot{q}  0$。\n\n$\\dot{q}$ 的表达式揭示了吸热步骤 $RO_2 \\rightarrow R + O_2$ 的作用。与此反应相关的项是 $-Q_1 k_{-1} c_{RO_2}$。由于 $Q_1$ 是放热正向步骤的正反应热，该项代表吸热——一个热沉。\n\n过程展开如下：\n1. 最初，$c_{RO_2,0}=0$。正向反应 $R+O_2 \\rightarrow RO_2$ 开始，生成过氧自由基 $RO_2$ 并释放热量 ($+Q_1 k_1 c_R c_{O_2}$) 。\n2. 随着浓度 $c_{RO_2}$ 的增加，其两条消耗途径变得显著：\n   a. 主要的放热途径，$RO_2 \\rightarrow P$，通过项 $+Q_2 k_2 c_{RO_2}$ 对升温做出显著贡献。由于通常 $Q_2 \\gg Q_1$ 且 $E_2$ 较高，该反应对于导致点火的温度上升至关重要。\n   b. 吸热逆向途径，$RO_2 \\rightarrow R+O_2$，如果其速率常数 $k_{-1}$（由 $A_r$ 控制）不为零，则该途径被激活。此途径具有两种延迟效应：\n      i. **直接热阻尼**：它通过引入负项 $-Q_1 k_{-1} c_{RO_2}$ 直接降低净放热率 $\\dot{q}$。更大的指前因子 $A_r$ 或更大的热力学势垒 $Q_1$ 会增强这种冷却效应。\n      ii. **动力学竞争**：它与主要的放热反应竞争同一个自由基池 $RO_2$。每摩尔分解回 $R+O_2$ 的 $RO_2$ 就意味着少了一摩尔可以通过 $RO_2 \\rightarrow P$ 途径反应释放大量热量 $Q_2$。\n\n通过同时冷却混合物和降低主放热步骤的速率，吸热逆反应减慢了总的温升速率 $\\frac{dT}{dt}$。这会将 $\\frac{dT}{dt}$ 达到其最大值的时间——即点火延迟时间——推迟。这些测试案例旨在说明这一点：案例2相对于案例1（$A_r=0$）引入了此效应（$A_r  0$），而案例3则加强了它（更大的 $A_r$ 和 $Q_1$），这应该会逐步增加计算出的点火延迟。案例4表明，较小的初始自由基池通过减缓 $RO_2$ 的初始积累，会进一步延迟点火。\n\n**数值解法策略**\n\n该问题是一个包含五个耦合常微分方程（四个用于物种浓度，一个用于温度）的初值问题（IVP）。\n1.  **状态向量：** 系统的状态由向量 $y(t) = [c_R(t), c_{RO_2}(t), c_{O_2}(t), c_P(t), T(t)]^T$ 定义。\n2.  **ODE系统：** 定义一个Python函数，用于在给定当前状态 $(t, y)$ 和给定案例的固定物理参数的情况下，计算时间导数 $\\frac{dy}{dt}$。该函数实现了五个控制方程的右侧项。\n3.  **积分：** 使用 `scipy.integrate.solve_ivp` 函数来求解该初值问题。由于反应时间尺度可能存在巨大差异，化学动力学问题通常是“刚性”的。因此，为保证鲁棒性和效率，选择了一个适用于刚性问题的隐式求解器，例如 `Radau` 或 `BDF`。`dense_output=True` 选项用于获得解在积分区间 $[0, t_f]$ 上的连续表示。\n4.  **点火延迟计算：** 点火延迟时间定义为 $\\frac{dT}{dt}$ 达到其全局最大值的时间。\n    - 使用 `solve_ivp` 的密集输出，创建一个辅助函数，该函数可以在任意时间 $t \\in [0, t_f]$ 计算 $\\frac{dT}{dt}$。这是通过使用密集输出对象评估状态向量 $y(t)$，然后将此状态传递给ODE系统函数来计算导数。\n    - 为了找到 $\\frac{dT}{dt}$ 的最大值，我们寻找其负值 $-\\frac{dT}{dt}$ 的最小值。`scipy.optimize.minimize_scalar` 函数用于此目的。它能有效地在有界区间 $[0, t_f]$ 内找到使该函数最小化的时间 $t_{ign}$。\n    - 然后将温度导数的最大值 $\\max(\\frac{dT}{dt})$ 与阈值 $\\alpha=1.0 \\ \\mathrm{K/s}$ 进行比较。如果超过阈值，则报告计算出的时间 $t_{ign}$。否则，认为未发生点火，并报告 $-1.0$。\n\n这种数值方法为量化指定测试案例的点火延迟时间提供了一种鲁棒且准确的方法。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the autoignition problem for the four specified test cases.\n    \"\"\"\n    \n    # Global constants\n    Rg = 8.314  # J mol^-1 K^-1\n    Cvm = 20.0  # J mol^-1 K^-1\n\n    # Define the four test cases as a list of dictionaries\n    test_cases = [\n        { # Case 1: Baseline, no endothermic reverse reaction\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-6,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 0.0, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 1.5e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 1\"\n        },\n        { # Case 2: Moderate endothermic reaction\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-6,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 1e3, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 1.5e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 2\"\n        },\n        { # Case 3: Strong endothermic reaction\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-6,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 1e5, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 3.0e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 3\"\n        },\n        { # Case 4: Smaller initial radical pool\n            \"T0\": 700.0, \"P0\": 10.0 * 101325, \"X_O2\": 0.21, \"X_R0\": 1e-7,\n            \"A1\": 1e3, \"E1\": 5.0e4, \"Ar\": 1e3, \"Er\": 2.0e4, \"A2\": 1e8, \"E2\": 8.0e4,\n            \"Q1\": 1.5e4, \"Q2\": 2.0e5, \"tf\": 0.5, \"alpha\": 1.0, \"label\": \"Case 4\"\n        }\n    ]\n\n    results = []\n\n    def ode_system(t, y, params):\n        \"\"\"\n        Defines the system of ODEs for the reactor.\n        y = [c_R, c_RO2, c_O2, c_P, T]\n        \"\"\"\n        c_R, c_RO2, c_O2, c_P, T = y\n        A1, E1, Ar, Er, A2, E2, Q1, Q2 = params\n\n        # Enforce physical bounds to prevent numerical instability\n        c_R = max(0.0, c_R)\n        c_RO2 = max(0.0, c_RO2)\n        c_O2 = max(0.0, c_O2)\n        T = max(1.0, T)\n\n        # Arrhenius rate constants\n        k1 = A1 * np.exp(-E1 / (Rg * T))\n        k_1 = Ar * np.exp(-Er / (Rg * T))\n        k2 = A2 * np.exp(-E2 / (Rg * T))\n\n        # Reaction rates per unit volume (mol m^-3 s^-1)\n        w1 = k1 * c_R * c_O2\n        w_1 = k_1 * c_RO2\n        w2 = k2 * c_RO2\n\n        # Species rate equations\n        dcR_dt = -w1 + w_1\n        dcRO2_dt = w1 - w_1 - w2\n        dcO2_dt = -w1 + w_1 \n        dcP_dt = w2\n\n        # Energy conservation equation\n        q_dot = Q1 * w1 - Q1 * w_1 + Q2 * w2\n        c_tot = c_R + c_RO2 + c_O2 + c_P\n        # Prevent division by zero if all reactants are depleted\n        c_tot_vol = max(c_tot, 1e-20) * Cvm\n        dT_dt = q_dot / c_tot_vol\n\n        return [dcR_dt, dcRO2_dt, dcO2_dt, dcP_dt, dT_dt]\n\n    for case in test_cases:\n        # 1. Set up initial conditions\n        c_tot0 = case[\"P0\"] / (Rg * case[\"T0\"])\n        cR0 = case[\"X_R0\"] * c_tot0\n        cO20 = case[\"X_O2\"] * c_tot0\n        cRO20 = 0.0\n        cP0 = c_tot0 - cR0 - cO20\n        y0 = [cR0, cRO20, cO20, cP0, case[\"T0\"]]\n\n        tf = case[\"tf\"]\n        alpha = case[\"alpha\"]\n        \n        # Pack kinetic/thermo parameters\n        ode_params = (case[\"A1\"], case[\"E1\"], case[\"Ar\"], case[\"Er\"], \n                      case[\"A2\"], case[\"E2\"], case[\"Q1\"], case[\"Q2\"])\n\n        # 2. Integrate the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, tf],\n            y0=y0,\n            method='Radau', # A good choice for stiff ODEs in chemical kinetics\n            dense_output=True,\n            args=(ode_params,)\n        )\n\n        # 3. Find ignition delay time\n        # Define a function returning -dT/dt for the optimizer\n        def neg_dTdt(t, sol_obj, params):\n            y_t = sol_obj.sol(t)\n            derivatives = ode_system(t, y_t, params)\n            return -derivatives[4]\n\n        # Use a bounded scalar optimizer to find the time of min(-dT/dt) = max(dT/dt)\n        # Add a small epsilon to the bounds to avoid issues at the very edge.\n        opt_bounds = (1e-9, tf - 1e-9) if tf > 2e-9 else (0, tf)\n        res = minimize_scalar(\n            neg_dTdt, \n            bounds=opt_bounds, \n            method='bounded', \n            args=(sol, ode_params)\n        )\n\n        ign_time = res.x\n        max_dTdt = -res.fun\n\n        # 4. Check against ignition criterion and store result\n        if max_dTdt > alpha:\n            results.append(ign_time)\n        else:\n            results.append(-1.0)\n    \n    # 5. Print results in the specified format\n    print(f\"[{','.join([f'{t:.6f}' for t in results])}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}