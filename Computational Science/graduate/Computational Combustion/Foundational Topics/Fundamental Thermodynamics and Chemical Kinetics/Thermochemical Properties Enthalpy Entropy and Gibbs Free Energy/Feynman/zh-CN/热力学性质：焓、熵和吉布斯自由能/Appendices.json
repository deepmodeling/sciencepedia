{
    "hands_on_practices": [
        {
            "introduction": "在理论上学习了焓变的计算后，一个重要的实践环节是将其与工程应用联系起来。燃料的热值是燃烧器和发动机设计中的一个关键参数，它直接量化了燃料燃烧时释放的能量。本练习旨在通过应用赫斯定律（Hess’s Law）和标准生成焓（standard enthalpies of formation），从第一性原理出发计算甲烷的低热值（Lower Heating Value, LHV），从而巩固您对反应焓（enthalpy of reaction）物理意义的理解。",
            "id": "4071822",
            "problem": "考虑甲烷在标准条件（$25^\\circ\\mathrm{C}$，$1\\,\\mathrm{atm}$）下的完全化学计量燃烧。仅使用基本的热化学定义，根据列表中的标准生成焓和产物中水的相态，来构建标准反应焓。高热值（HHV）对应于产物中 $25^\\circ\\mathrm{C}$ 的液态水，而低热值（LHV）对应于产物中 $25^\\circ\\mathrm{C}$ 的水蒸气。相关物种的标准生成焓 $\\Delta H_f^\\circ$ 如下：\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{CH_4(g)}\\right)= -74.85\\,\\mathrm{kJ\\,mol^{-1}}$，\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{CO_2(g)}\\right)= -393.52\\,\\mathrm{kJ\\,mol^{-1}}$，\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(l)}\\right)= -285.83\\,\\mathrm{kJ\\,mol^{-1}}$，\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(g)}\\right)= -241.826\\,\\mathrm{kJ\\,mol^{-1}}$，\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{O_2(g)}\\right)= 0\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n原子质量如下：\n- $\\mathrm{C}:\\,12.011\\,\\mathrm{g\\,mol^{-1}}$，\n- $\\mathrm{H}:\\,1.00794\\,\\mathrm{g\\,mol^{-1}}$。\n\n从第一性原理出发，使用标准反应焓的定义和 Hess 定律，并通过强制产物中水的正确相态，确定单位质量甲烷的低热值。将最终能量以 $\\mathrm{MJ\\,kg^{-1}}$ 为单位表示。将最终答案四舍五入到四位有效数字。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- **反应**：甲烷（$\\mathrm{CH_4(g)}$）的完全化学计量燃烧。\n- **标准条件**：$T = 25^\\circ\\mathrm{C}$ ($298.15\\,\\mathrm{K}$)，$P = 1\\,\\mathrm{atm}$。\n- **定义**：\n    - 高热值（HHV）对应于产物中 $25^\\circ\\mathrm{C}$ 的液态水（$\\mathrm{H_2O(l)}$）。\n    - 低热值（LHV）对应于产物中 $25^\\circ\\mathrm{C}$ 的水蒸气（$\\mathrm{H_2O(g)}$）。\n- **标准生成焓（$\\Delta H_f^\\circ$，单位 $\\mathrm{kJ\\,mol^{-1}}$）**：\n    - $\\Delta H_f^\\circ(\\mathrm{CH_4(g)}) = -74.85$\n    - $\\Delta H_f^\\circ(\\mathrm{CO_2(g)}) = -393.52$\n    - $\\Delta H_f^\\circ(\\mathrm{H_2O(l)}) = -285.83$\n    - $\\Delta H_f^\\circ(\\mathrm{H_2O(g)}) = -241.826$\n    - $\\Delta H_f^\\circ(\\mathrm{O_2(g)}) = 0$\n- **原子质量（$\\mathrm{g\\,mol^{-1}}$）**：\n    - $\\mathrm{C}: 12.011$\n    - $\\mathrm{H}: 1.00794$\n- **任务**：确定单位质量甲烷的低热值（LHV），单位为 $\\mathrm{MJ\\,kg^{-1}}$。\n- **取整**：将最终答案四舍五入到四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题牢固地植根于热化学的基本原理，特别是 Hess 定律以及标准生成焓和热值的定义。所有提供的热化学数据都是标准的、公认的数值。这些概念是燃烧科学的核心。该问题在科学上是合理的。\n2.  **适定性**：问题陈述清晰，提供了计算甲烷 LHV 的唯一、稳定且有意义值所需的所有必要数据（标准生成焓、原子质量）和定义（LHV vs. HHV）。\n3.  **客观性**：问题以精确、无歧义的科学语言表达。“标准条件”、“生成焓”和“LHV”等术语具有严格的、普遍接受的定义。\n4.  **缺陷评估**：\n    -   问题不违反任何科学原理。\n    -   这是一个标准的、可形式化的热化学计算。\n    -   提供的数据是完整和一致的。\n    -   条件和数值在物理上是现实的。\n    -   问题结构导向一个唯一的解。\n\n### 第 3 步：结论与行动\n该问题是有效的。将提供一个合理的解答。\n\n这个问题的核心原理是 Hess 定律，该定律指出，标准反应焓 $\\Delta H_{rxn}^\\circ$ 是产物的标准生成焓之和与反应物的标准生成焓之和之间的差值，两者均按其各自的化学计量系数（$\\nu_i$）进行加权。\n$$ \\Delta H_{rxn}^\\circ = \\sum_{p} \\nu_p \\Delta H_{f,p}^\\circ - \\sum_{r} \\nu_r \\Delta H_{f,r}^\\circ $$\n\n首先，我们必须建立甲烷（$\\mathrm{CH_4}$）完全燃烧的平衡化学方程式。反应物是甲烷和氧气（$\\mathrm{O_2}$），产物是二氧化碳（$\\mathrm{CO_2}$）和水（$\\mathrm{H_2O}$）。问题规定我们必须确定低热值（LHV），这对应于产物中的水处于气相（$\\mathrm{H_2O(g)}$）。\n\n未配平的反应是：\n$$ \\mathrm{CH_4(g)} + \\mathrm{O_2(g)} \\rightarrow \\mathrm{CO_2(g)} + \\mathrm{H_2O(g)} $$\n\n配平原子：\n-   **碳 (C)**：左侧 1 个，右侧 1 个。已配平。\n-   **氢 (H)**：左侧 4 个，右侧 2 个。我们需要为 $\\mathrm{H_2O}$ 加上系数 2。\n    $$ \\mathrm{CH_4(g)} + \\mathrm{O_2(g)} \\rightarrow \\mathrm{CO_2(g)} + 2\\mathrm{H_2O(g)} $$\n-   **氧 (O)**：左侧 2 个。右侧，我们有来自 $\\mathrm{CO_2}$ 的 2 个和来自 $2\\mathrm{H_2O}$ 的 $2 \\times 1 = 2$ 个，总共 4 个。我们需要为 $\\mathrm{O_2}$ 加上系数 2。\n\n用于 LHV 计算的已配平的化学计量反应是：\n$$ \\mathrm{CH_4(g)} + 2\\mathrm{O_2(g)} \\rightarrow \\mathrm{CO_2(g)} + 2\\mathrm{H_2O(g)} $$\n\n现在，我们将 Hess 定律应用于此反应。反应物的化学计量系数为 $\\nu_{\\mathrm{CH_4}} = 1$ 和 $\\nu_{\\mathrm{O_2}} = 2$。产物的化学计量系数为 $\\nu_{\\mathrm{CO_2}} = 1$ 和 $\\nu_{\\mathrm{H_2O}} = 2$。\n$$ \\Delta H_{rxn}^\\circ = \\left[ (1 \\cdot \\Delta H_f^\\circ(\\mathrm{CO_2(g)})) + (2 \\cdot \\Delta H_f^\\circ(\\mathrm{H_2O(g)})) \\right] - \\left[ (1 \\cdot \\Delta H_f^\\circ(\\mathrm{CH_4(g)})) + (2 \\cdot \\Delta H_f^\\circ(\\mathrm{O_2(g)})) \\right] $$\n\n代入给定值：\n$$ \\Delta H_f^\\circ(\\mathrm{CH_4(g)}) = -74.85\\,\\mathrm{kJ\\,mol^{-1}} $$\n$$ \\Delta H_f^\\circ(\\mathrm{O_2(g)}) = 0\\,\\mathrm{kJ\\,mol^{-1}} \\text{ （根据定义，元素处于其标准状态）} $$\n$$ \\Delta H_f^\\circ(\\mathrm{CO_2(g)}) = -393.52\\,\\mathrm{kJ\\,mol^{-1}} $$\n$$ \\Delta H_f^\\circ(\\mathrm{H_2O(g)}) = -241.826\\,\\mathrm{kJ\\,mol^{-1}} $$\n\n计算 $\\Delta H_{rxn}^\\circ$：\n$$ \\Delta H_{rxn}^\\circ = \\left[ (1\\,\\mathrm{mol} \\cdot (-393.52\\,\\mathrm{kJ\\,mol^{-1}})) + (2\\,\\mathrm{mol} \\cdot (-241.826\\,\\mathrm{kJ\\,mol^{-1}})) \\right] - \\left[ (1\\,\\mathrm{mol} \\cdot (-74.85\\,\\mathrm{kJ\\,mol^{-1}})) + (2\\,\\mathrm{mol} \\cdot (0\\,\\mathrm{kJ\\,mol^{-1}})) \\right] $$\n$$ \\Delta H_{rxn}^\\circ = [ -393.52 - 483.652 ]\\,\\mathrm{kJ} - [ -74.85 ]\\,\\mathrm{kJ} $$\n$$ \\Delta H_{rxn}^\\circ = -877.172\\,\\mathrm{kJ} + 74.85\\,\\mathrm{kJ} $$\n$$ \\Delta H_{rxn}^\\circ = -802.322\\,\\mathrm{kJ} $$\n这是每摩尔甲烷燃烧的反应焓。\n\n热值定义为燃烧过程中释放的热量的大小。对于放热反应（$\\Delta H_{rxn}^\\circ < 0$），热值为正量：\n$$ \\mathrm{LHV} = -\\Delta H_{rxn}^\\circ $$\n$$ \\mathrm{LHV} = -(-802.322\\,\\mathrm{kJ\\,mol^{-1}}) = 802.322\\,\\mathrm{kJ\\,mol^{-1}} $$\n这是摩尔低热值。\n\n问题要求单位质量甲烷的 LHV（$\\mathrm{MJ\\,kg^{-1}}$）。要从摩尔基准转换为质量基准，我们需要甲烷的摩尔质量 $M_{\\mathrm{CH_4}}$。\n使用提供的原子质量：\n$$ M_{\\mathrm{C}} = 12.011\\,\\mathrm{g\\,mol^{-1}} $$\n$$ M_{\\mathrm{H}} = 1.00794\\,\\mathrm{g\\,mol^{-1}} $$\n$$ M_{\\mathrm{CH_4}} = M_{\\mathrm{C}} + 4 \\cdot M_{\\mathrm{H}} = 12.011\\,\\mathrm{g\\,mol^{-1}} + 4 \\cdot (1.00794\\,\\mathrm{g\\,mol^{-1}}) $$\n$$ M_{\\mathrm{CH_4}} = 12.011\\,\\mathrm{g\\,mol^{-1}} + 4.03176\\,\\mathrm{g\\,mol^{-1}} = 16.04276\\,\\mathrm{g\\,mol^{-1}} $$\n\n现在，我们计算质量比 LHV，$\\mathrm{LHV_{mass}}$：\n$$ \\mathrm{LHV_{mass}} = \\frac{\\mathrm{LHV}}{M_{\\mathrm{CH_4}}} = \\frac{802.322\\,\\mathrm{kJ\\,mol^{-1}}}{16.04276\\,\\mathrm{g\\,mol^{-1}}} \\approx 50.0108\\,\\mathrm{kJ\\,g^{-1}} $$\n\n最后，我们将单位从 $\\mathrm{kJ\\,g^{-1}}$ 转换为所需的 $\\mathrm{MJ\\,kg^{-1}}$。\n$$ 1\\,\\mathrm{kJ} = 10^{-3}\\,\\mathrm{MJ} $$\n$$ 1\\,\\mathrm{g} = 10^{-3}\\,\\mathrm{kg} $$\n因此：\n$$ \\frac{\\mathrm{kJ}}{\\mathrm{g}} = \\frac{10^{-3}\\,\\mathrm{MJ}}{10^{-3}\\,\\mathrm{kg}} = \\frac{\\mathrm{MJ}}{\\mathrm{kg}} $$\n在此特定转换中，数值不变。\n$$ \\mathrm{LHV_{mass}} \\approx 50.0108\\,\\mathrm{MJ\\,kg^{-1}} $$\n\n问题要求答案四舍五入到四位有效数字。\n$$ \\mathrm{LHV_{mass}} \\approx 50.01\\,\\mathrm{MJ\\,kg^{-1}} $$",
            "answer": "$$\\boxed{50.01}$$"
        },
        {
            "introduction": "在计算燃烧学中，我们不仅需要计算单一反应的焓变，更需要能够精确获取任意温度和组分下气体混合物的热力学性质。美国国家航空航天局（NASA）的七系数多项式是该领域内描述纯理想气体组分热化学性质的行业标准。本练习将指导您编写程序，利用这些多项式计算单个组分的恒压热容 $c_{p,i}$、焓 $h_i$ 和熵 $s_i$，并根据理想气体混合定律得到混合物的宏观性质，这是开发或使用任何燃烧模拟代码都必须掌握的基础技能。",
            "id": "4071841",
            "problem": "考虑一个理想气体甲烷–空气混合物，其温度为 $T = 1000\\,\\mathrm{K}$，压力为 $p = 1\\,\\mathrm{bar}$。该混合物包含甲烷 $\\mathrm{CH_4}$、氧气 $\\mathrm{O_2}$ 和氮气 $\\mathrm{N_2}$ 三种组分，其摩尔分数 $x_i$ 已知。使用美国国家航空航天局（NASA）的七系数多项式表示法来描述理想气体组分在高温范围（适用于 $1000\\,\\mathrm{K} \\le T \\le 6000\\,\\mathrm{K}$）的热化学性质，对于一个系数为 $\\{a_1,a_2,a_3,a_4,a_5,a_6,a_7\\}$ 的组分，总结如下：\n- 每摩尔定压热容：$$\\frac{c_{p,i}(T)}{R} = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4.$$\n- 每摩尔焓：$$\\frac{h_i(T)}{R\\,T} = a_1 + a_2 \\frac{T}{2} + a_3 \\frac{T^2}{3} + a_4 \\frac{T^3}{4} + a_5 \\frac{T^4}{5} + a_6 \\frac{1}{T}.$$\n- 标准压力 $p_0 = 1\\,\\mathrm{bar}$ 下的标准摩尔熵：$$\\frac{s_i^0(T)}{R} = a_1 \\ln T + a_2 T + a_3 \\frac{T^2}{2} + a_4 \\frac{T^3}{3} + a_5 \\frac{T^4}{4} + a_7.$$\n这里的 $R$ 是通用气体常数。\n\n对于理想气体混合物，其在 $(T,p)$ 条件下的性质由与统计热力学和分压概念一致的经典理想混合物法则定义。混合物的摩尔定压热容 $c_{p,\\mathrm{mix}}(T)$ 和混合物摩尔焓 $h_{\\mathrm{mix}}(T)$ 是各组分性质的摩尔分数加权和。混合物摩尔熵 $s_{\\mathrm{mix}}(T,p,\\{x_i\\})$ 包括了由各组分分压导出的理想混合贡献。您必须将 $c_{p,\\mathrm{mix}}$ 以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 表示，将 $h_{\\mathrm{mix}}$ 以 $\\mathrm{kJ\\,mol^{-1}}$ 表示，将 $s_{\\mathrm{mix}}$ 以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 表示。使用 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和 $p_0 = 1\\,\\mathrm{bar}$。假设 $p = p_0$。\n\n使用以下高温 NASA 多项式系数（适用于 $1000\\,\\mathrm{K} \\le T \\le 6000\\,\\mathrm{K}$）：\n- $\\mathrm{CH_4}$: $a_1 = 7.48514950\\times 10^{-2}$, $a_2 = 1.33909467\\times 10^{-2}$, $a_3 = -5.73285829\\times 10^{-6}$, $a_4 = 1.22292535\\times 10^{-9}$, $a_5 = -1.01815230\\times 10^{-13}$, $a_6 = -1.00099753\\times 10^{4}$, $a_7 = 1.84373180\\times 10^{1}$.\n- $\\mathrm{O_2}$: $a_1 = 3.28253784$, $a_2 = 1.48308754\\times 10^{-3}$, $a_3 = -7.57966669\\times 10^{-7}$, $a_4 = 2.09470555\\times 10^{-10}$, $a_5 = -2.16717794\\times 10^{-14}$, $a_6 = -1.08845772\\times 10^{3}$, $a_7 = 5.45323129$.\n- $\\mathrm{N_2}$: $a_1 = 2.95257626$, $a_2 = 1.39690040\\times 10^{-3}$, $a_3 = -4.92631603\\times 10^{-7}$, $a_4 = 7.86010367\\times 10^{-11}$, $a_5 = -4.60700342\\times 10^{-15}$, $a_6 = -9.23948688\\times 10^{2}$, $a_7 = 5.87188762$.\n\n关于混合物熵的说明：对于 $p = p_0$ 的情况，混合物的摩尔熵是各组分在温度 $T$ 下的标准熵之和减去基于摩尔分数的理想混合项，这与分压定义一致。当 $x_i = 0$ 时，将数学极限 $x_i \\ln x_i$ 视为 $0$。\n\n您的程序必须针对每个指定的测试案例，使用上述原理和系数计算三元组 $\\left[c_{p,\\mathrm{mix}}(T), h_{\\mathrm{mix}}(T), s_{\\mathrm{mix}}(T,p)\\right]$。所有测试的温度和压力固定为 $T = 1000\\,\\mathrm{K}$ 和 $p = 1\\,\\mathrm{bar}$。\n\n测试集（每一项为 $(x_{\\mathrm{CH_4}}, x_{\\mathrm{O_2}}, x_{\\mathrm{N_2}})$）：\n- 案例1（$T=1000\\,\\mathrm{K}$ 时的化学计量甲烷-空气反应物混合物）：$x_{\\mathrm{CH_4}} = \\frac{1}{10.5238095238} \\approx 0.0950$, $x_{\\mathrm{O_2}} = \\frac{2}{10.5238095238} \\approx 0.1900$, $x_{\\mathrm{N_2}} = \\frac{7.5238095238}{10.5238095238} \\approx 0.7150$。\n- 案例2（纯甲烷）：$x_{\\mathrm{CH_4}} = 1.0$, $x_{\\mathrm{O_2}} = 0.0$, $x_{\\mathrm{N_2}} = 0.0$。\n- 案例3（干空气基准）：$x_{\\mathrm{CH_4}} = 0.0$, $x_{\\mathrm{O_2}} = 0.21$, $x_{\\mathrm{N_2}} = 0.79$。\n- 案例4（空气中的贫燃甲烷）：$x_{\\mathrm{CH_4}} = 0.02$, $x_{\\mathrm{O_2}} = 0.2058$, $x_{\\mathrm{N_2}} = 0.7742$。\n- 案例5（纯氧气）：$x_{\\mathrm{CH_4}} = 0.0$, $x_{\\mathrm{O_2}} = 1.0$, $x_{\\mathrm{N_2}} = 0.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试案例的结果本身也是一个逗号分隔的三个浮点数列表，顺序为 $\\left[c_{p,\\mathrm{mix}}\\,(\\mathrm{J\\,mol^{-1}\\,K^{-1}}), h_{\\mathrm{mix}}\\,(\\mathrm{kJ\\,mol^{-1}}), s_{\\mathrm{mix}}\\,(\\mathrm{J\\,mol^{-1}\\,K^{-1}})\\right]$。例如，最后一行必须看起来像 $\\left[\\left[c_1,h_1,s_1\\right],\\left[c_2,h_2,s_2\\right],\\dots\\right]$。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上基于化学热力学原理，问题阐述清晰，并包含计算唯一可验证解所需的所有信息。所提供的数据，包括 NASA 多项式系数和测试混合物的组成，与燃烧领域的既定标准一致。\n\n该问题的求解涉及一个两阶段计算过程。首先，在指定温度 $T = 1000\\,\\mathrm{K}$下，计算每种气体组分（$i$）的摩尔热化学性质——具体来说是定压热容（$c_{p,i}$）、焓（$h_i$）和标准态熵（$s_i^0$）。其次，对于每组给定的摩尔分数 $\\{x_i\\}$，使用理想气体混合物法则将这些特定于组分的性质组合起来，以确定混合物的相应性质（$c_{p,\\mathrm{mix}}$, $h_{\\mathrm{mix}}$, $s_{\\mathrm{mix}}$）。\n\n此分析的基础常数和参数为：\n- 通用气体常数, $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 温度, $T = 1000\\,\\mathrm{K}$。\n- 系统压力, $p = 1\\,\\mathrm{bar}$。\n- 标准态压力, $p_0 = 1\\,\\mathrm{bar}$。\n\n**第一部分：组分特定热化学性质的计算**\n\n使用所提供的七系数 NASA 多项式表达式计算每个组分 $i \\in \\{\\mathrm{CH_4}, \\mathrm{O_2}, \\mathrm{N_2}\\}$ 的性质。这些多项式给出了性质的无量纲形式，然后将其转换为最终的带量纲值。温度 $T = 1000\\,\\mathrm{K}$ 位于给定系数的指定高温有效范围内。\n\n摩尔定压热容 $c_{p,i}(T)$ 计算如下：\n$$\nc_{p,i}(T) = R \\left( a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right)\n$$\n结果单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n摩尔焓 $h_i(T)$ 计算如下：\n$$\nh_i(T) = R T \\left( a_1 + a_2 \\frac{T}{2} + a_3 \\frac{T^2}{3} + a_4 \\frac{T^3}{4} + a_5 \\frac{T^4}{5} + a_6 \\frac{1}{T} \\right)\n$$\n结果单位为 $\\mathrm{J\\,mol^{-1}}$。该值表示在参考温度（$298.15\\,\\mathrm{K}$）下的标准态生成焓与从参考温度到系统温度 $T$ 的显焓变之和。\n\n标准摩尔熵 $s_i^0(T)$，即在标准压力 $p_0=1\\,\\mathrm{bar}$ 下的熵，计算如下：\n$$\ns_i^0(T) = R \\left( a_1 \\ln T + a_2 T + a_3 \\frac{T^2}{2} + a_4 \\frac{T^3}{3} + a_5 \\frac{T^4}{4} + a_7 \\right)\n$$\n结果单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n**第二部分：混合物性质的计算**\n\n对于理想气体混合物，其广延性质是各组分性质的摩尔分数加权和。\n\n混合物摩尔定压热容 $c_{p,\\mathrm{mix}}(T)$ 由下式给出：\n$$\nc_{p,\\mathrm{mix}}(T) = \\sum_{i} x_i c_{p,i}(T)\n$$\n其中 $x_i$ 是组分 $i$ 的摩尔分数。单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n混合物摩尔焓 $h_{\\mathrm{mix}}(T)$ 同样由下式给出：\n$$\nh_{\\mathrm{mix}}(T) = \\sum_{i} x_i h_i(T)\n$$\n结果以 $\\mathrm{J\\,mol^{-1}}$ 计算，随后除以 $1000$ 转换为 $\\mathrm{kJ\\,mol^{-1}}$ 以满足输出要求。\n\n理想气体混合物的混合物摩尔熵 $s_{\\mathrm{mix}}(T, p, \\{x_i\\})$ 由分熵之和给出：\n$$\ns_{\\mathrm{mix}}(T, p, \\{x_i\\}) = \\sum_{i} x_i s_i(T, p_i)\n$$\n其中 $p_i = x_i p$ 是组分 $i$ 的分压。单一理想气体组分 $i$ 在压力 $p_i$ 下的熵与其标准态熵 $s_i^0(T)$ 的关系为：\n$$\ns_i(T, p_i) = s_i^0(T) - R \\ln\\left(\\frac{p_i}{p_0}\\right)\n$$\n代入 $p_i = x_i p$ 并将这些式子结合，得到混合物熵的完整表达式：\n$$\ns_{\\mathrm{mix}}(T, p, \\{x_i\\}) = \\sum_{i} x_i \\left( s_i^0(T) - R \\ln\\left(\\frac{x_i p}{p_0}\\right) \\right) = \\sum_{i} x_i s_i^0(T) - R \\sum_{i} x_i \\ln x_i - R \\ln\\left(\\frac{p}{p_0}\\right)\n$$\n问题规定系统压力 $p$ 等于标准压力 $p_0$，即 $p = p_0 = 1\\,\\mathrm{bar}$。这简化了最后一项，因为 $\\ln(p/p_0) = \\ln(1) = 0$。因此，所需的混合物熵为：\n$$\ns_{\\mathrm{mix}}(T, p_0, \\{x_i\\}) = \\sum_{i} x_i s_i^0(T) - R \\sum_{i} x_i \\ln x_i\n$$\n项 $- R \\sum_{i} x_i \\ln x_i$ 是理想混合熵。为进行计算，当摩尔分数 $x_i = 0$ 时，项 $x_i \\ln x_i$ 取其数学极限值，即 $0$。$s_{\\mathrm{mix}}$ 的最终单位是 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n计算算法首先在 $T = 1000\\,\\mathrm{K}$ 时计算并存储 $\\mathrm{CH_4}$、$\\mathrm{O_2}$ 和 $\\mathrm{N_2}$ 的性质 $(c_{p,i}, h_i, s_i^0)$。然后，对于五个测试案例中的每一个，它应用上述摩尔分数加权求和法则来计算最终的混合物性质 $[c_{p,\\mathrm{mix}}, h_{\\mathrm{mix}}, s_{\\mathrm{mix}}]$，并确保最终的焓单位正确。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes thermochemical properties for methane-air mixtures using NASA polynomials.\n    \"\"\"\n\n    # Universal gas constant in J mol-1 K-1\n    UNIVERSAL_GAS_CONSTANT = 8.314462618\n\n    # Fixed temperature for all calculations\n    TEMPERATURE = 1000.0  # in K\n\n    # NASA 7-coefficient polynomial data for high-temperature range (1000 K = T = 6000 K)\n    # The species are CH4, O2, N2\n    # Coefficients are {a1, a2, a3, a4, a5, a6, a7}\n    NASA_COEFFICIENTS = {\n        'CH4': [\n            7.48514950e-02, 1.33909467e-02, -5.73285829e-06, 1.22292535e-09,\n            -1.01815230e-13, -1.00099753e+04, 1.84373180e+01\n        ],\n        'O2': [\n            3.28253784e+00, 1.48308754e-03, -7.57966669e-07, 2.09470555e-10,\n            -2.16717794e-14, -1.08845772e+03, 5.45323129e+00\n        ],\n        'N2': [\n            2.95257626e+00, 1.39690040e-03, -4.92631603e-07, 7.86010367e-11,\n            -4.60700342e-15, -9.23948688e+02, 5.87188762e+00\n        ]\n    }\n\n    # Test suite: mole fractions (x_CH4, x_O2, x_N2)\n    # Using exact fractions where available for precision\n    test_cases = [\n        # Case 1: Stoichiometric methane–air\n        (1.0/10.5238095238, 2.0/10.5238095238, 7.5238095238/10.5238095238),\n        # Case 2: Pure methane\n        (1.0, 0.0, 0.0),\n        # Case 3: Dry air\n        (0.0, 0.21, 0.79),\n        # Case 4: Lean methane in air\n        (0.02, 0.2058, 0.7742),\n        # Case 5: Pure oxygen\n        (0.0, 1.0, 0.0),\n    ]\n\n    species_list = ['CH4', 'O2', 'N2']\n    \n    # Pre-calculate powers of T for efficiency\n    T = TEMPERATURE\n    T_powers = np.array([T, T**2, T**3, T**4])\n    ln_T = np.log(T)\n    R = UNIVERSAL_GAS_CONSTANT\n\n    # Calculate and store individual species properties at T=1000 K\n    species_properties = {}\n    for species, coeffs in NASA_COEFFICIENTS.items():\n        a = np.array(coeffs)\n        \n        # Molar heat capacity: cp = R * (a1 + a2*T + a3*T^2 + a4*T^3 + a5*T^4)\n        cp_over_R = a[0] + np.dot(a[1:5], T_powers)\n        cp_i = cp_over_R * R\n\n        # Molar enthalpy: h = R*T * (a1 + a2*T/2 + a3*T^2/3 + a4*T^3/4 + a5*T^4/5 + a6/T)\n        h_over_RT = a[0] + np.dot(a[1:5], T_powers / np.arange(2, 6)) + a[5] / T\n        h_i = h_over_RT * R * T\n\n        # Standard molar entropy: s0 = R * (a1*ln(T) + a2*T + a3*T^2/2 + a4*T^3/3 + a5*T^4/4 + a7)\n        s0_over_R = a[0] * ln_T + np.dot(a[1:5], T_powers / np.arange(1, 5)) + a[6]\n        s0_i = s0_over_R * R\n\n        species_properties[species] = {'cp': cp_i, 'h': h_i, 's0': s0_i}\n\n    results = []\n    for mole_fraction_tuple in test_cases:\n        mole_fractions = dict(zip(species_list, mole_fraction_tuple))\n\n        cp_mix = 0.0\n        h_mix = 0.0\n        s0_mix_sum = 0.0\n        entropy_of_mixing_term = 0.0\n\n        for species, x_i in mole_fractions.items():\n            if x_i  0:\n                props = species_properties[species]\n                cp_mix += x_i * props['cp']\n                h_mix += x_i * props['h']\n                s0_mix_sum += x_i * props['s0']\n                entropy_of_mixing_term += x_i * np.log(x_i)\n\n        # Final mixture entropy: s_mix = sum(xi*s0_i) - R*sum(xi*ln(xi))\n        s_mix = s0_mix_sum - R * entropy_of_mixing_term\n        \n        # Convert molar enthalpy to kJ/mol for the final output\n        h_mix_kJ_per_mol = h_mix / 1000.0\n\n        results.append([cp_mix, h_mix_kJ_per_mol, s_mix])\n\n    # Format the output as a single line string: [[c1,h1,s1],[c2,h2,s2],...]\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "热力学性质的最终应用之一是预测化学反应的最终状态，即化学平衡。根据热力学第二定律，在恒定温度 $T$ 和压力 $p$ 下，封闭系统的平衡态对应其总吉布斯自由能 $G$ 的最小值。这个终极练习要求您将所有学过的概念融会贯通：首先计算各组分的吉布斯自由能，然后构建一个基于拉格朗日乘子法（Lagrange multipliers）的数值求解器，通过最小化总吉布斯自由能来计算复杂反应系统的平衡组分。 成功完成此练习标志着您已具备从第一性原理预测化学系统行为的核心能力。",
            "id": "4071838",
            "problem": "考虑一个在指定温度 $T$ 和压力 $p$ 下的理想气体混合物，其中可包含物种 $\\mathrm{H_2}$、$\\mathrm{O_2}$、$\\mathrm{H}$、$\\mathrm{O}$、$\\mathrm{OH}$ 和 $\\mathrm{H_2O}$。该混合物是封闭的，其原子组成由氢原子和氧原子的数量固定，记为向量 $\\boldsymbol{b} = (b_{\\mathrm{H}}, b_{\\mathrm{O}})$。在平衡状态下，混合物在满足原子守恒和物种量非负性的约束条件下，使其总吉布斯自由能最小化。您的任务是：通过最小化总吉布斯自由能，建立表征平衡组成的非线性系统；并实现一个牛顿-拉格朗日求解器，该求解器强制执行原子平衡约束和非负性约束。\n\n请基于以下基本事实进行推导：\n- 热力学第二定律表明，在恒定温度 $T$ 和压力 $p$ 下，封闭系统的平衡态会使其总吉布斯自由能 $G$ 最小化。\n- 对于理想气体混合物，化学势由标准态热化学函数和混合贡献共同决定。\n- 等式约束是原子守恒定律，不等式约束是物种量的非负性。\n\n物种组和数据（所有值均基于 $p^0 = 100000\\,\\mathrm{Pa}$ 的理想气体标准态，参考温度为 $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$）：\n- 物种顺序：$\\mathrm{H_2}$、$\\mathrm{O_2}$、$\\mathrm{H}$、$\\mathrm{O}$、$\\mathrm{OH}$、$\\mathrm{H_2O}$。\n- 原子组成矩阵 $\\boldsymbol{A}$（行代表元素 $\\mathrm{H}$ 和 $\\mathrm{O}$，列遵循上述物种顺序）：\n  $\\boldsymbol{A} = \\begin{bmatrix}\n  2  0  1  0  1  2 \\\\\n  0  2  0  1  1  1\n  \\end{bmatrix}$。\n- 恒压定热容 $\\boldsymbol{c}_p$（单位：$\\mathrm{J\\ mol^{-1}\\ K^{-1}}$）：\n  $\\mathrm{H_2}: 28.836$，$\\mathrm{O_2}: 29.355$，$\\mathrm{H}: 20.786$，$\\mathrm{O}: 20.786$，$\\mathrm{OH}: 29.100$，$\\mathrm{H_2O}: 33.600$。\n- $T_{\\mathrm{ref}}$ 下的标准生成焓（单位：$\\mathrm{J\\ mol^{-1}}$）：\n  $\\mathrm{H_2}: 0$，$\\mathrm{O_2}: 0$，$\\mathrm{H}: 218000$，$\\mathrm{O}: 249000$，$\\mathrm{OH}: 39000$，$\\mathrm{H_2O}: -241826$。\n- $T_{\\mathrm{ref}}$ 和 $p^0$ 下的标准绝对熵（单位：$\\mathrm{J\\ mol^{-1}\\ K^{-1}}$）：\n  $\\mathrm{H_2}: 130.680$，$\\mathrm{O_2}: 205.000$，$\\mathrm{H}: 114.600$，$\\mathrm{O}: 161.060$，$\\mathrm{OH}: 183.700$，$\\mathrm{H_2O}: 188.840$。\n- 普适气体常数：$R = 8.314462618\\,\\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n\n利用这些数据，通过结合相对于 $T_{\\mathrm{ref}}$ 的焓和熵的定 $c_p$ 近似，定义每个物种 $i$ 在温度 $T$ 下的标准态摩尔吉布斯自由能 $g_i^0(T)$。然后，通过最小化混合物的总吉布斯自由能 $G(T,p,\\boldsymbol{n})$（相对于物种量 $\\boldsymbol{n}$），并满足原子守恒约束 $\\boldsymbol{A}\\boldsymbol{n} = \\boldsymbol{b}$ 和所有物种 $n_i \\ge 0$ 的条件，来构建平衡条件。\n\n您必须：\n1. 推导一个非线性方程组的方阵系统。其未知数包括物种量（以强制 $n_i \\ge 0$ 的方式表示）、元素守恒约束的拉格朗日乘子，以及使系统适定所需的任何辅助变量。\n2. 构建一个牛顿-拉格朗日迭代法来求解该系统，并实施充分的全局化策略以确保所提供的测试用例能够收敛。\n3. 以指定顺序返回所有六个物种的平衡摩尔分数，作为程序的最终结果。\n\n物理单位与计算规则：\n- 温度 $T$ 的单位是 $\\mathrm{K}$，压力 $p$ 的单位是 $\\mathrm{Pa}$，标准压力为 $p^0 = 100000\\,\\mathrm{Pa}$。\n- 所有热化学输入（$\\boldsymbol{c}_p$、生成焓、熵）均使用如上所列的 $\\mathrm{SI}$ 单位。\n- 将最终的平衡组成表示为无量纲的摩尔分数，四舍五入到六位小数。\n\n测试套件：\n- 情况 $1$（一般情况）：$T = 3000$，$p = 101325$，$\\boldsymbol{b} = (2.0, 1.0)$。\n- 情况 $2$（低温边界）：$T = 1000$，$p = 101325$，$\\boldsymbol{b} = (2.0, 1.0)$。\n- 情况 $3$（富燃混合物，较高压力）：$T = 3500$，$p = 1013250$，$\\boldsymbol{b} = (2.0, 0.8)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个包含六个浮点数的、用方括号括起来的逗号分隔列表，按上述物种列表排序。例如，输出格式必须是：\n$\\texttt{[[y1\\_case1,y2\\_case1,y3\\_case1,y4\\_case1,y5\\_case1,y6\\_case1],[y1\\_case2,\\dots,y6\\_case2],[y1\\_case3,\\dots,y6\\_case3]]}$。",
            "solution": "该问题要求计算一个包含物种 $\\mathrm{H_2}$、$\\mathrm{O_2}$、$\\mathrm{H}$、$\\mathrm{O}$、$\\mathrm{OH}$ 和 $\\mathrm{H_2O}$ 的理想气体混合物在给定温度 $T$、压力 $p$ 和固定元素组成下的平衡组成。这是一个经典的热力学第二定律的应用，该定律指出，在恒定 $T$ 和 $p$ 下的封闭系统将达到一个使其总吉布斯自由能 $G$ 最小化的平衡状态。该最小化过程受原子守恒约束。\n\n首先，我们为每个物种 $i$ 定义必要的热化学性质。物种 $i$ 的标准态摩尔吉布斯自由能，记为 $g_i^0(T)$，是温度的函数，由其标准态摩尔焓 $h_i^0(T)$ 和熵 $s_i^0(T, p^0)$ 计算得出，即 $g_i^0(T) = h_i^0(T) - T s_i^0(T, p^0)$。问题指定使用定热容 $c_{p,i}^0$ 近似。\n\n温度 $T$ 下的标准态摩尔焓通过从参考温度 $T_{\\mathrm{ref}}$ 对热容进行积分得到：\n$$h_i^0(T) = \\Delta h_{f,i}^0(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^T c_{p,i}^0 dT' = \\Delta h_{f,i}^0(T_{\\mathrm{ref}}) + c_{p,i}^0(T - T_{\\mathrm{ref}})$$\n其中 $\\Delta h_{f,i}^0(T_{\\mathrm{ref}})$ 是物种 $i$ 在 $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$ 下的标准生成焓。\n\n类似地，在温度 $T$ 和标准压力 $p^0$ 下的标准态摩尔熵为：\n$$s_i^0(T, p^0) = s_i^0(T_{\\mathrm{ref}}, p^0) + \\int_{T_{\\mathrm{ref}}}^T \\frac{c_{p,i}^0}{T'} dT' = s_i^0(T_{\\mathrm{ref}}, p^0) + c_{p,i}^0\\ln\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)$$\n其中 $s_i^0(T_{\\mathrm{ref}}, p^0)$ 是物种 $i$ 在 $T_{\\mathrm{ref}}$ 和 $p^0$ 下的标准绝对熵。\n\n综合这些，每个物种 $i$ 的标准态摩尔吉布斯自由能为：\n$$g_i^0(T) = \\left[ \\Delta h_{f,i}^0(T_{\\mathrm{ref}}) + c_{p,i}^0(T - T_{\\mathrm{ref}}) \\right] - T \\left[ s_i^0(T_{\\mathrm{ref}}, p^0) + c_{p,i}^0\\ln\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) \\right]$$\n\n含有 $N_s$ 个物种的理想气体混合物的总吉布斯自由能为 $G = \\sum_{i=1}^{N_s} n_i \\mu_i$，其中 $n_i$ 是物种 $i$ 的摩尔数，$\\mu_i$ 是其化学势。化学势由下式给出：\n$$\\mu_i(T, p, \\boldsymbol{y}) = g_i^0(T) + RT\\ln\\left(\\frac{p_i}{p^0}\\right) = g_i^0(T) + RT\\ln\\left(\\frac{y_i p}{p^0}\\right)$$\n这里，$R$ 是普适气体常数，$y_i = n_i/n_{tot}$ 是物种 $i$ 的摩尔分数，$n_{tot} = \\sum_i n_i$ 是混合物中的总摩尔数，$p_i = y_i p$ 是分压。\n\n平衡状态是通过相对于摩尔数 $\\boldsymbol{n} = (n_1, \\dots, n_{N_s})$ 最小化 $G$ 来找到的，同时满足元素守恒约束：\n$$\\sum_{i=1}^{N_s} a_{ji} n_i = b_j \\quad \\text{对于每个元素 } j=1, \\dots, N_e$$\n以及非负性约束 $n_i \\ge 0$。在这个问题中，我们有 $N_s=6$ 个物种和 $N_e=2$ 个元素（H 和 O），元素丰度由向量 $\\boldsymbol{b} = (b_H, b_O)$ 给出，原子组成矩阵为 $\\boldsymbol{A}$，其中 $a_{ji}$ 是物种 $i$ 的一个分子中元素 $j$ 的原子数。\n\n为了解决这个约束优化问题，我们使用拉格朗日乘子法。拉格朗日函数 $\\mathcal{L}$ 是：\n$$\\mathcal{L}(\\boldsymbol{n}, \\boldsymbol{\\lambda}) = G(\\boldsymbol{n}) - \\sum_{j=1}^{N_e} \\lambda_j \\left( \\sum_{i=1}^{N_s} a_{ji} n_i - b_j \\right)$$\n在最小值处，拉格朗日函数相对于每个 $n_i$ 的梯度必须为零，这产生了以下条件：\n$$\\frac{\\partial \\mathcal{L}}{\\partial n_i} = \\mu_i - \\sum_{j=1}^{N_e} \\lambda_j a_{ji} = 0$$\n这意味着在平衡时，每个物种的化学势是拉格朗日乘子 $\\lambda_j$ 的线性组合，这些乘子可以解释为元素势：\n$$\\mu_i = \\sum_{j=1}^{N_e} a_{ji} \\lambda_j$$\n代入 $\\mu_i$ 的表达式并除以 $RT$，我们引入无量纲元素势 $\\pi_j = \\lambda_j / (RT)$：\n$$\\frac{g_i^0(T)}{RT} + \\ln\\left(\\frac{n_i}{n_{tot}}\\right) + \\ln\\left(\\frac{p}{p^0}\\right) = \\sum_{j=1}^{N_e} a_{ji} \\pi_j$$\n\n为了为数值求解器构建一个适定系统，我们选择一组独立变量并构造一个非线性方程组的方阵系统。一个稳健的变量选择，遵循像 NASA CEA 这样的成熟程序中使用的公式，是元素势 $\\pi_j$ 和总摩尔数的自然对数 $\\ln n_{tot}$ 的集合。对于我们的系统，未知数向量是 $\\boldsymbol{v} = (\\pi_H, \\pi_O, \\ln n_{tot})^T$。\n\n重新整理平衡条件，可以得到每个 $n_i$ 作为 $\\boldsymbol{v}$ 函数的显式表达式：\n$$\\ln n_i = \\ln n_{tot} + \\sum_{j=1}^{N_e} a_{ji}\\pi_j - \\frac{g_i^0(T)}{RT} - \\ln\\left(\\frac{p}{p^0}\\right)$$\n$$n_i(\\boldsymbol{v}) = \\exp\\left( (\\ln n_{tot}) + a_{H,i}\\pi_H + a_{O,i}\\pi_O - \\frac{g_i^0(T)}{RT} - \\ln\\left(\\frac{p}{p^0}\\right) \\right)$$\n这个公式巧妙地强制执行了非负性约束 $n_i  0$。\n\n现在我们可以定义一个包含 $N_e + 1 = 3$ 个残差方程的系统 $\\boldsymbol{F}(\\boldsymbol{v})=\\boldsymbol{0}$，对应于两个元素守恒定律和一个总摩尔数的闭合方程。\n$$F_1(\\boldsymbol{v}) = \\sum_{i=1}^{N_s} a_{H,i} n_i(\\boldsymbol{v}) - b_H = 0 \\quad (\\text{氢原子平衡})$$\n$$F_2(\\boldsymbol{v}) = \\sum_{i=1}^{N_s} a_{O,i} n_i(\\boldsymbol{v}) - b_O = 0 \\quad (\\text{氧原子平衡})$$\n$$F_3(\\boldsymbol{v}) = \\sum_{i=1}^{N_s} n_i(\\boldsymbol{v}) - \\exp(\\ln n_{tot}) = 0 \\quad (\\text{摩尔数闭合})$$\n这是一个关于 $3$ 个未知数 $\\boldsymbol{v} = (v_1, v_2, v_3)^T = (\\pi_H, \\pi_O, \\ln n_{tot})^T$ 的 $3$ 个非线性方程的方阵系统。\n\n我们使用牛顿法求解该系统。迭代更新规则为 $\\boldsymbol{v}^{(k+1)} = \\boldsymbol{v}^{(k)} + \\alpha \\Delta \\boldsymbol{v}^{(k)}$，其中修正向量 $\\Delta \\boldsymbol{v}^{(k)}$ 是线性系统 $\\boldsymbol{J}^{(k)} \\Delta \\boldsymbol{v}^{(k)} = -\\boldsymbol{F}^{(k)}$ 的解。这里，$\\boldsymbol{F}^{(k)}$ 是残差向量，$\\boldsymbol{J}^{(k)}$ 是在第 $k$ 次迭代时计算的雅可比矩阵。参数 $\\alpha \\in (0, 1]$ 是一个通过线搜索算法确定的阻尼因子，以确保稳健收敛（全局化）。\n\n雅可比矩阵的元素 $J_{jk} = \\partial F_j / \\partial v_k$ 是通过对残差方程求导得出的。所需的 $n_i(\\boldsymbol{v})$ 的偏导数为：\n$$\\frac{\\partial n_i}{\\partial \\pi_H} = n_i a_{H,i}, \\quad \\frac{\\partial n_i}{\\partial \\pi_O} = n_i a_{O,i}, \\quad \\frac{\\partial n_i}{\\partial (\\ln n_{tot})} = n_i$$\n得到的 $3 \\times 3$ 雅可比矩阵 $\\boldsymbol{J}$ 是：\n$$ \\boldsymbol{J} =\n\\begin{pmatrix}\n\\sum_{i} n_i a_{H,i}^2   \\sum_{i} n_i a_{H,i} a_{O,i}  \\sum_{i} n_i a_{H,i} \\\\\n\\sum_{i} n_i a_{O,i} a_{H,i}  \\sum_{i} n_i a_{O,i}^2  \\sum_{i} n_i a_{O,i} \\\\\n\\sum_{i} n_i a_{H,i}  \\sum_{i} n_i a_{O,i}  \\sum_{i} n_i - \\exp(\\ln n_{tot})\n\\end{pmatrix}\n$$\n求和遍及所有物种 $i=1, \\dots, N_s$。\n\n求解算法如下：\n1. 初始化未知数向量 $\\boldsymbol{v}^{(0)}$。一个安全的选择是能够产生较小初始摩尔数的初值。\n2. 对于每次迭代 $k$：\n    a. 使用 $\\boldsymbol{v}^{(k)}$ 计算所有物种的 $n_i^{(k)}$。\n    b. 计算残差向量 $\\boldsymbol{F}^{(k)}$ 和雅可比矩阵 $\\boldsymbol{J}^{(k)}$。\n    c. 检查收敛性（例如，$||\\boldsymbol{F}^{(k)}||_2  \\mathrm{tolerance}$）。如果收敛，则退出循环。\n    d. 求解线性系统 $\\boldsymbol{J}^{(k)} \\Delta \\boldsymbol{v}^{(k)} = -\\boldsymbol{F}^{(k)}$ 以获得 $\\Delta \\boldsymbol{v}^{(k)}$。\n    e. 执行线搜索以找到一个阻尼因子 $\\alpha$，确保残差范数有充分的下降。\n    f. 更新解：$\\boldsymbol{v}^{(k+1)} = \\boldsymbol{v}^{(k)} + \\alpha \\Delta \\boldsymbol{v}^{(k)}$。\n3. 一旦收敛到 $\\boldsymbol{v}^*$，计算最终的摩尔数 $\\boldsymbol{n}^*$、总摩尔数 $n_{tot}^* = \\sum n_i^*$ 和平衡摩尔分数 $y_i^* = n_i^*/n_{tot}^*$。\n该过程为求解化学平衡状态提供了一种稳健而高效的方法。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the chemical equilibrium problem for the given test cases.\n    \"\"\"\n\n    # --- Problem Data ---\n    # Species order: H2, O2, H, O, OH, H2O\n    SPECIES = ['H2', 'O2', 'H', 'O', 'OH', 'H2O']\n    NUM_SPECIES = 6\n    NUM_ELEMENTS = 2\n\n    # Universal Gas Constant (J / mol K)\n    R = 8.314462618\n\n    # Reference State\n    T_REF = 298.15  # K\n    P_0 = 100000.0   # Pa\n\n    # Atomic composition matrix A (rows: H, O; cols: species)\n    A = np.array([\n        [2., 0., 1., 0., 1., 2.],  # H atoms\n        [0., 2., 0., 1., 1., 1.]   # O atoms\n    ])\n\n    # Standard formation enthalpies at T_ref (J/mol)\n    H_F_REF = np.array([0., 0., 218000., 249000., 39000., -241826.])\n\n    # Standard absolute entropies at T_ref, P_0 (J/mol K)\n    S_REF = np.array([130.680, 205.000, 114.600, 161.060, 183.700, 188.840])\n\n    # Constant heat capacities at constant pressure (J/mol K)\n    CP = np.array([28.836, 29.355, 20.786, 20.786, 29.100, 33.600])\n\n    def get_g0_over_RT(T):\n        \"\"\"\n        Calculates the standard-state Gibbs free energy for each species at temperature T,\n        normalized by RT.\n        \"\"\"\n        h0 = H_F_REF + CP * (T - T_REF)\n        s0 = S_REF + CP * np.log(T / T_REF)\n        g0 = h0 - T * s0\n        return g0 / (R * T)\n\n    def equilibrium_solver(T, p, b):\n        \"\"\"\n        Solves for the equilibrium composition using a Newton-Lagrange method.\n        \n        Args:\n            T (float): Temperature in Kelvin.\n            p (float): Pressure in Pascals.\n            b (np.array): Vector of elemental abundances (b_H, b_O).\n\n        Returns:\n            np.array: Vector of equilibrium mole fractions.\n        \"\"\"\n        g0_over_RT = get_g0_over_RT(T)\n        log_p_over_p0 = np.log(p / P_0)\n\n        # Unknowns vector v = [pi_H, pi_O, log_n_tot]\n        v = np.array([-20.0, -20.0, 0.0])  # Initial guess\n\n        # Newton solver parameters\n        max_iter = 100\n        tolerance = 1e-10\n        max_step_norm = 2.0\n        \n        for k in range(max_iter):\n            pi_H, pi_O, log_n_tot = v\n            \n            # Calculate mole numbers n_i from current variables v\n            exponent = log_n_tot + A[0] * pi_H + A[1] * pi_O - g0_over_RT - log_p_over_p0\n            n = np.exp(exponent)\n            \n            # Calculate residual vector F\n            F = np.zeros(NUM_ELEMENTS + 1)\n            F[0] = np.dot(A[0], n) - b[0]\n            F[1] = np.dot(A[1], n) - b[1]\n            F[2] = np.sum(n) - np.exp(log_n_tot)\n            \n            # Check for convergence\n            norm_F = np.linalg.norm(F)\n            if norm_F  tolerance:\n                break\n            \n            # Calculate Jacobian matrix J\n            J = np.zeros((NUM_ELEMENTS + 1, NUM_ELEMENTS + 1))\n            # Top-left block: d(element balance)/d(pi)\n            J[0, 0] = np.dot(n, A[0]**2)\n            J[0, 1] = np.dot(n, A[0] * A[1])\n            J[1, 0] = J[0, 1]\n            J[1, 1] = np.dot(n, A[1]**2)\n            \n            # Right column: d(element balance)/d(log_n_tot)\n            b_current = A @ n\n            J[0, 2] = b_current[0]\n            J[1, 2] = b_current[1]\n            \n            # Bottom row: d(mole balance)/d(v)\n            J[2, 0] = b_current[0]\n            J[2, 1] = b_current[1]\n            J[2, 2] = np.sum(n) - np.exp(log_n_tot) # This is F[2]\n            \n            # Solve the linear system J * dv = -F\n            try:\n                dv = np.linalg.solve(J, -F)\n            except np.linalg.LinAlgError:\n                # Use pseudo-inverse if Jacobian is singular\n                dv = np.linalg.pinv(J) @ -F\n\n            # Globalization: Step size control and backtracking line search\n            dv_norm = np.linalg.norm(dv)\n            if dv_norm  max_step_norm:\n                dv = dv * (max_step_norm / dv_norm)\n            \n            alpha = 1.0\n            for _ in range(10): # Max 10 line search steps\n                v_next = v + alpha * dv\n                pi_H_next, pi_O_next, log_n_tot_next = v_next\n                exp_next = log_n_tot_next + A[0] * pi_H_next + A[1] * pi_O_next - g0_over_RT - log_p_over_p0\n                n_next = np.exp(exp_next)\n\n                F_next = np.zeros(NUM_ELEMENTS + 1)\n                F_next[0] = np.dot(A[0], n_next) - b[0]\n                F_next[1] = np.dot(A[1], n_next) - b[1]\n                F_next[2] = np.sum(n_next) - np.exp(log_n_tot_next)\n                \n                if np.linalg.norm(F_next)  norm_F:\n                    v = v_next\n                    break\n                alpha /= 2.0\n            else: # If line search fails, break main loop\n                break\n\n        # Post-processing: calculate final mole fractions\n        pi_H, pi_O, log_n_tot = v\n        exponent = log_n_tot + A[0] * pi_H + A[1] * pi_O - g0_over_RT - log_p_over_p0\n        n_final = np.exp(exponent)\n        n_tot_final = np.sum(n_final)\n        y_final = n_final / n_tot_final\n\n        return y_final\n\n    # --- Test Suite ---\n    test_cases = [\n        # T (K), p (Pa), b (H, O)\n        (3000.0, 101325.0, np.array([2.0, 1.0])),\n        (1000.0, 101325.0, np.array([2.0, 1.0])),\n        (3500.0, 1013250.0, np.array([2.0, 0.8])),\n    ]\n\n    all_results = []\n    for T, p, b in test_cases:\n        y = equilibrium_solver(T, p, b)\n        y_rounded = np.round(y, 6)\n        all_results.append(f\"[{','.join(f'{val:.6f}' for val in y_rounded)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}