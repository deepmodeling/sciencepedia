{
    "hands_on_practices": [
        {
            "introduction": "Before implementing complex equations of state from scratch, it is instructive to see how physical parameters can be extracted from experimental-like data. This exercise focuses on the virial equation of state, a foundational model that directly links the macroscopic compressibility factor $Z$ to the temperature-dependent second virial coefficient $B(T)$, which reflects pairwise molecular interactions. By fitting a model to a provided dataset, you will develop practical skills in data analysis and model validation that are essential for any computational scientist .",
            "id": "4023518",
            "problem": "You are provided with a synthetic but scientifically plausible dataset of compressibility factor values for nitrogen, expressed as $Z(p,T)$ over a set of pressures and temperatures relevant to combustion chambers. The goal is to infer the temperature dependence of the second virial coefficient $B(T)$ for nitrogen and to evaluate the accuracy of the truncated virial Equation of State (EOS) up to a maximum pressure of $20$ bar.\n\nFundamental base: Start from the definition of the compressibility factor $Z$ for a gas and the virial expansion concept. Use the truncated virial EOS valid at low to moderate densities to connect the data $Z(p,T)$ to the second virial coefficient $B(T)$. Then fit a parametric functional form for $B(T)$ over the given temperature range.\n\nData and units:\n- Use the universal gas constant $R_u = 8.314462618$ $\\mathrm{J/(mol\\cdot K)}$.\n- Use the molar basis throughout and express pressure in Pascal. Convert bar to Pascal using $1$ bar $= 10^5$ $\\mathrm{Pa}$.\n- Temperatures $T$ are in Kelvin and the compressibility factor $Z$ is dimensionless.\n\nDataset:\n- Temperatures (Kelvin): $[300,500,1000,2000]$.\n- Pressures (bar): $[1,5,10,15,20]$.\n- The following matrix contains $Z(p,T)$ values, with each row corresponding to one temperature (in the same order as listed above), and each column corresponding to one pressure (in the same order as listed above). All entries are dimensionless:\n$$\n\\begin{bmatrix}\n0.996993 & 0.979465 & 0.960730 & 0.938695 & 0.920460 \\\\\n0.999432 & 0.994359 & 0.987917 & 0.982476 & 0.977334 \\\\\n0.999780 & 0.999701 & 0.998602 & 0.998303 & 0.997304 \\\\\n1.000256 & 1.000080 & 1.000661 & 1.000741 & 1.001121\n\\end{bmatrix}\n$$\n\nTasks:\n1. For each temperature $T$ in the dataset, infer the second virial coefficient $B(T)$ from the provided $Z(p,T)$ values by performing a linear regression of $Z$ against pressure $p$ at fixed $T$. Use a model with a free intercept to avoid bias from measurement offsets. Then transform the fitted slope to obtain $B(T)$ on a molar basis.\n2. Fit the temperature dependence of the second virial coefficient using the parametric model $B(T) = a_0 + a_1/T$ with a linear least squares fit over the provided temperature set.\n3. Using the fitted $B(T)$, predict $Z(p,T)$ across the full grid of provided temperatures and pressures, and evaluate the accuracy of the truncated virial EOS.\n\nRequired outputs and test suite:\nCompute the following five quantities, each expressed as a float unless otherwise specified:\n- Item 1 (float): The root mean square error (RMSE) between the predicted and provided $Z(p,T)$ over all $4 \\times 5$ data points. Report as a dimensionless value rounded to six decimal places.\n- Item 2 (float): The maximum absolute deviation at $p = 20$ bar across the four temperatures. Report as a dimensionless value rounded to six decimal places.\n- Item 3 (float): The predicted compressibility factor at $T = 1800$ Kelvin and $p = 20$ bar using the fitted $B(T)$. Report as a dimensionless value rounded to six decimal places.\n- Item 4 (boolean): Whether the fitted $B(T)$ crosses zero in the interval $[300,2000]$ Kelvin. Return a boolean value.\n- Item 5 (float): The predicted compressibility factor at $T = 300$ Kelvin and $p = 0$ bar using the fitted $B(T)$. Report as a dimensionless value rounded to six decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order listed above, with floats rounded to six decimal places. For example:\n\"[rmse,max_abs_err,z_1800K_20bar,zero_crossing,z_300K_0bar]\".",
            "solution": "The user has requested an analysis of a synthetic dataset for the compressibility factor $Z$ of nitrogen. The objective is to determine the second virial coefficient $B(T)$, fit it to a parametric model, and evaluate the accuracy of the resulting truncated virial equation of state.\n\nThe problem is scientifically well-grounded, self-contained, and algorithmically tractable. The premises are consistent with the principles of physical chemistry and thermodynamics. All data and constants required for a unique solution are provided. Therefore, the problem is deemed valid.\n\nThe solution proceeds in three main steps, as outlined in the problem statement.\n\n**Step 1: Inference of the Second Virial Coefficient $B(T)$**\n\nThe virial equation of state (EOS) provides a formalism to describe the deviation of a real gas from ideal gas behavior. It expresses the compressibility factor, $Z = \\frac{pv}{R_u T}$, as a power series in the molar density $1/v$, where $p$ is the pressure, $v$ is the molar volume, $T$ is the absolute temperature, and $R_u$ is the universal gas constant.\n$$Z = 1 + \\frac{B(T)}{v} + \\frac{C(T)}{v^2} + O(v^{-3})$$\nThe coefficients $B(T)$, $C(T)$, etc., are the second, third, etc., virial coefficients, which are functions of temperature only.\n\nFor low to moderate pressures, this equation can be truncated and rearranged into a power series in pressure. Using the approximation $v \\approx \\frac{R_u T}{p}$ in the second term, we obtain the truncated virial EOS in pressure form:\n$$Z(p, T) \\approx 1 + \\frac{B(T) p}{R_u T}$$\nThis equation suggests that at a fixed temperature $T$, the compressibility factor $Z$ is approximately a linear function of pressure $p$. The intercept is $1$, and the slope is $\\frac{B(T)}{R_u T}$.\n\nThe problem specifies performing a linear regression for $Z$ against $p$ at each given temperature $T_i$ using an empirical model with a free intercept, $Z(p) = c_0 + c_1 p$. This is a robust approach that accommodates potential systematic offsets in the $Z$ data, where the ideal intercept of $1$ might not be perfectly met. The slope of this regression, $c_1$, is identified with the theoretical slope:\n$$c_1(T) = \\frac{B(T)}{R_u T}$$\nFrom this relationship, we can infer the second virial coefficient for each temperature in the dataset:\n$$B(T) = c_1(T) \\cdot R_u T$$\nThis procedure is applied to each of the four temperature rows in the provided $Z(p,T)$ matrix. Pressures are first converted from bar to Pascal ($1 \\text{ bar} = 10^5 \\text{ Pa}$).\n\n**Step 2: Parametric Fit for the Temperature Dependence of $B(T)$**\n\nThe second virial coefficient $B(T)$ captures the effects of pairwise molecular interactions. Its temperature dependence can often be described by simple empirical or semi-empirical models. The problem specifies fitting the calculated $B(T_i)$ values to the following two-parameter model:\n$$B(T) = a_0 + \\frac{a_1}{T}$$\nThis equation is linear with respect to the variable $1/T$. Therefore, the coefficients $a_0$ (intercept) and $a_1$ (slope) can be determined by a linear least-squares fit of the calculated $B(T_i)$ values against the corresponding $1/T_i$ values. The parameter $a_0$ represents the high-temperature limit of $B(T)$ and is related to the effective volume of the molecules (hard-sphere repulsion), while $a_1$ is related to the strength of intermolecular attractive forces.\n\n**Step 3: Prediction, Error Analysis, and Evaluation**\n\nWith the coefficients $a_0$ and $a_1$ determined, we have a continuous analytical model for the second virial coefficient, $B_{\\text{fit}}(T) = a_0 + a_1/T$. This model can be used to predict the compressibility factor at any pressure $p$ and temperature $T$ (within the range of validity) using the fundamental theoretical EOS form:\n$$Z_{\\text{pred}}(p, T) = 1 + \\frac{B_{\\text{fit}}(T) p}{R_u T} = 1 + \\frac{(a_0 + a_1/T) p}{R_u T}$$\nNote that the intercept is fixed at $1$, consistent with the physical definition of $Z$, which must approach $1$ as $p \\to 0$.\n\nThe required outputs are computed as follows:\n\n1.  **Root Mean Square Error (RMSE):** The accuracy of the fitted model is evaluated by computing the RMSE between the predicted $Z_{\\text{pred}}$ values and the original data $Z_{\\text{data}}$ over all $N=20$ points:\n    $$\\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{4} \\sum_{j=1}^{5} (Z_{\\text{pred}}(p_j, T_i) - Z_{\\text{data}, ij})^2}$$\n2.  **Maximum Absolute Deviation at $p = 20$ bar:** This metric quantifies the model's worst-case performance at the highest pressure in the dataset:\n    $$\\text{MaxDev}_{20\\text{bar}} = \\max_{i} |Z_{\\text{pred}}(p=20 \\text{ bar}, T_i) - Z_{\\text{data}}(p=20 \\text{ bar}, T_i)|$$\n3.  **Predicted $Z$ at $T=1800$ K and $p=20$ bar:** This is a direct application of the prediction formula to a point not in the original dataset, testing the interpolative power of the model.\n4.  **Zero Crossing of $B(T)$:** The Boyle temperature, $T_B$, is the temperature at which $B(T)=0$. For the fitted model, this occurs when $a_0 + a_1/T_B = 0$, which gives $T_B = -a_1/a_0$. A boolean value is returned indicating whether this temperature falls within the given range $[300, 2000]$ K.\n5.  **Predicted $Z$ at $T=300$ K and $p=0$ bar:** By the definition of the prediction model, $Z_{\\text{pred}}(p=0, T) = 1$ for any temperature. This serves as a conceptual check. The result is $1.0$.\n\nThe following Python code implements this entire procedure.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of inferring the second virial coefficient for nitrogen,\n    fitting a model, and evaluating its accuracy.\n    \"\"\"\n    # ------------------ Givens and Constants ------------------\n    R_u = 8.314462618  # J/(mol*K)\n    \n    # Dataset\n    temperatures_K = np.array([300.0, 500.0, 1000.0, 2000.0])\n    pressures_bar = np.array([1.0, 5.0, 10.0, 15.0, 20.0])\n    Z_data = np.array([\n        [0.996993, 0.979465, 0.960730, 0.938695, 0.920460],\n        [0.999432, 0.994359, 0.987917, 0.982476, 0.977334],\n        [0.999780, 0.999701, 0.998602, 0.998303, 0.997304],\n        [1.000256, 1.000080, 1.000661, 1.000741, 1.001121]\n    ])\n    \n    # Convert pressure to SI units (Pascal)\n    pressures_Pa = pressures_bar * 1.0e5\n\n    # ------------------ Task 1: Infer B(T) for each T ------------------\n    B_values = []\n    for i, T in enumerate(temperatures_K):\n        z_row = Z_data[i, :]\n        # Perform linear regression: Z = c1*p + c0\n        c1, c0 = np.polyfit(pressures_Pa, z_row, 1)\n        \n        # Infer B(T) from the slope c1: c1 = B(T) / (R_u * T)\n        b_t = c1 * R_u * T\n        B_values.append(b_t)\n    \n    B_values = np.array(B_values)\n\n    # ------------------ Task 2: Fit B(T) = a0 + a1/T ------------------\n    inv_T = 1.0 / temperatures_K\n    \n    # Perform linear regression: B = a1*(1/T) + a0\n    a1, a0 = np.polyfit(inv_T, B_values, 1)\n\n    # ------------------ Task 3: Predict Z(p,T) and Evaluate ------------------\n    def B_fit(T):\n        \"\"\"Calculates B(T) using the fitted model.\"\"\"\n        return a0 + a1 / T\n\n    def Z_pred(p, T):\n        \"\"\"Predicts Z(p,T) using the fitted B(T) and truncated virial EOS.\"\"\"\n        return 1.0 + (B_fit(T) * p) / (R_u * T)\n\n    # Predict Z over the entire grid\n    Z_pred_matrix = np.zeros_like(Z_data)\n    for i, T in enumerate(temperatures_K):\n        for j, p in enumerate(pressures_Pa):\n            Z_pred_matrix[i, j] = Z_pred(p, T)\n\n    # ------------------ Required Outputs Calculation ------------------\n\n    # Item 1: RMSE between predicted and provided Z(p,T)\n    rmse = np.sqrt(np.mean((Z_pred_matrix - Z_data)**2))\n\n    # Item 2: Maximum absolute deviation at p = 20 bar\n    max_abs_err_20bar = np.max(np.abs(Z_pred_matrix[:, -1] - Z_data[:, -1]))\n\n    # Item 3: Predicted Z at T = 1800 K and p = 20 bar\n    p_eval = 20.0 * 1.0e5\n    T_eval = 1800.0\n    z_1800K_20bar = Z_pred(p_eval, T_eval)\n\n    # Item 4: Whether B(T) crosses zero in [300, 2000] K\n    # B(T) = 0 => a0 + a1/T = 0 => T = -a1/a0\n    zero_crossing = False\n    if a0 != 0:\n        boyle_temp = -a1 / a0\n        if 300.0 <= boyle_temp <= 2000.0:\n            zero_crossing = True\n\n    # Item 5: Predicted Z at T = 300 K and p = 0 bar\n    # By definition of the model used for prediction, Z(p=0,T)=1.\n    z_300K_0bar = Z_pred(0.0, 300.0)\n\n    # ------------------ Final Output Formatting ------------------\n    results = [\n        f\"{rmse:.6f}\",\n        f\"{max_abs_err_20bar:.6f}\",\n        f\"{z_1800K_20bar:.6f}\",\n        str(zero_crossing),\n        f\"{z_300K_0bar:.6f}\"\n    ]\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While the virial equation is powerful, many engineering applications require more robust models like cubic equations of state (EOS). This practice takes you into the core of modern thermodynamic modeling, where you will implement and compare two of the most influential cubic EOSs: the Soave-Redlich-Kwong (SRK) and Peng-Robinson (PR) models. By analyzing their predictions and dissecting the role of the temperature-dependent attraction term $\\alpha(T)$, you will gain a deeper understanding of their construction and respective domains of accuracy .",
            "id": "4023485",
            "problem": "You are tasked with constructing a complete, runnable program that compares predictions of the compressibility factor $Z$ for hydrogen using two widely used cubic equations of state: the Soave-Redlich-Kwong (SRK) and the Peng-Robinson (PR) models. The purpose is to analyze how the temperature-dependent attraction parameter $\\alpha(T)$ influences high-temperature behavior. Your derivation and implementation must begin from foundational thermodynamic definitions and laws, and must avoid relying on or citing shortcut formulas in the problem statement. The program will solve for the vapor-phase compressibility factor $Z$ at a fixed high temperature and across a range of pressures, using hydrogen as the single-component fluid.\n\nFundamental bases to use:\n- The definition of the compressibility factor: $Z = \\dfrac{p v}{R T}$, where $p$ is pressure, $v$ is molar volume, $R$ is the universal gas constant, and $T$ is temperature.\n- The general rationale of cubic equations of state in separating repulsive and attractive contributions to the pressure, with a parameter $b$ that captures excluded volume effects and a parameter $a(T)$ that captures attractive interactions; for SRK and PR, $a(T)$ is factored as $a \\alpha(T)$, where $a$ is a constant dependent on critical properties and $\\alpha(T)$ is a temperature-dependent modifier.\n- The pure-component critical property relationships that allow expressing $a$ and $b$ in terms of the critical temperature $T_c$ and critical pressure $p_c$ for each of the SRK and PR models.\n- The acentric factor $\\omega$ entering the temperature-dependence via $\\alpha(T)$ for both models.\n\nYou must:\n1. Derive, from the above bases and the structural forms of the SRK and PR equations of state, the corresponding cubic equations in $Z$ for a pure component, expressed in terms of the reduced parameters $A$ and $B$ built from $a \\alpha(T)$, $b$, $p$, $R$, and $T$, and then implement a robust numerical root-finding method to obtain physically admissible $Z$ values. Explicit formulas for the SRK and PR equations of state, as well as for $\\alpha(T)$, $a$, and $b$, should be developed in your solution, not in this problem statement.\n2. Use the largest real root for $Z$ at the specified high temperature to represent the vapor-phase solution at all given pressures.\n3. Implement both the native SRK and PR $\\alpha(T)$ formulations. Additionally, implement cross-substitution experiments where the SRK $\\alpha(T)$ is used inside the PR equation and the PR $\\alpha(T)$ is used inside the SRK equation. This isolates the impact of the $\\alpha(T)$ formulation on high-temperature predictions.\n4. Quantify high-temperature accuracy by computing the absolute deviation from the perfect-gas limit, defined as $|Z - 1|$, for each case.\n5. Use the following constants for hydrogen and universal constants:\n   - Universal gas constant: $R = 8.314462618$ J/mol/K.\n   - Hydrogen critical temperature: $T_c = 33.19$ K.\n   - Hydrogen critical pressure: $p_c = 12.8$ bar.\n   - Hydrogen acentric factor: $\\omega = -0.215$.\n6. Use a fixed temperature of $T = 900$ K and pressures $p$ in the following test suite (expressed in bar): $p \\in \\{1, 50, 100\\}$.\n7. Unit consistency: Convert all pressures from bar to Pascal before using them inside your equations of state. The final compressibility factor $Z$ and deviations $|Z-1|$ are dimensionless and must be output as floating-point numbers.\n8. Test suite coverage and outputs:\n   - Compute lists of $Z$ for SRK with its native $\\alpha(T)$ and PR with its native $\\alpha(T)$ across the three pressures.\n   - Compute lists of $|Z-1|$ for both native SRK and native PR across the three pressures.\n   - Compute the list of differences $Z_{\\text{PR,native}} - Z_{\\text{SRK,native}}$ across the three pressures.\n   - Compute the list of changes in PR $Z$ when using SRK's $\\alpha(T)$ instead of PR's $\\alpha(T)$, defined as $Z_{\\text{PR,SRK}\\,\\alpha(T)} - Z_{\\text{PR,native}}$, across the three pressures.\n   - Compute the list of changes in SRK $Z$ when using PR's $\\alpha(T)$ instead of SRK's $\\alpha(T)$, defined as $Z_{\\text{SRK,PR}\\,\\alpha(T)} - Z_{\\text{SRK,native}}$, across the three pressures.\n9. Final output format:\n   - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each element being one of the lists described above in the exact order:\n     - $[Z_{\\text{SRK,native}}, Z_{\\text{PR,native}}, |Z_{\\text{SRK,native}}-1|, |Z_{\\text{PR,native}}-1|, Z_{\\text{PR,native}} - Z_{\\text{SRK,native}}, Z_{\\text{PR,SRK}\\,\\alpha(T)} - Z_{\\text{PR,native}}, Z_{\\text{SRK,PR}\\,\\alpha(T)} - Z_{\\text{SRK,native}}]$.\n   - Each inner list must contain three floating-point numbers corresponding to $p=1$ bar, $p=50$ bar, and $p=100$ bar, respectively, and must be dimensionless.\n   - The single line of output must contain no additional text.\n\nThis program must be self-contained and require no user input. It must numerically solve the derived cubic equations in $Z$ for each case and aggregate all results in the specified final output format. The problem emphasizes the derivation from first principles and the clear algorithmic implementation rather than reliance on memorized formulas.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of chemical thermodynamics, specifically the use of cubic equations of state to model real gas behavior. It is well-posed, providing all necessary constants, conditions, and a clear set of objectives, leading to a unique and verifiable numerical solution. The problem statement is objective and free of ambiguities. We may therefore proceed with a complete solution.\n\nThe primary objective is to solve for the compressibility factor, $Z$, for hydrogen at high temperature ($T=900$ K) and various pressures ($p \\in \\{1, 50, 100\\}$ bar) using two common cubic equations of state (EoS): the Soave-Redlich-Kwong (SRK) and Peng-Robinson (PR) models. This involves deriving the cubic polynomials for $Z$ from the fundamental pressure-explicit forms of these EoS, implementing a numerical solution, and comparing the results, including an analysis of the temperature-dependent attraction parameter, $\\alpha(T)$.\n\nA generic two-parameter cubic EoS can be written in the pressure-explicit form:\n$$\np = \\frac{R T}{v - b} - \\frac{a(T)}{v^2 + u b v + w b^2}\n$$\nwhere $p$ is the absolute pressure, $T$ is the absolute temperature, $v$ is the molar volume, and $R$ is the universal gas constant. The parameter $b$ represents the excluded molar volume, and $a(T)$ accounts for intermolecular attractive forces. The constants $u$ and $w$ define the specific model.\n\nFor the SRK EoS, $u=1$ and $w=0$:\n$$\np_{\\text{SRK}} = \\frac{R T}{v - b} - \\frac{a(T)}{v(v+b)}\n$$\n\nFor the PR EoS, $u=2$ and $w=-1$:\n$$\np_{\\text{PR}} = \\frac{R T}{v - b} - \\frac{a(T)}{v(v+b) + b(v-b)} = \\frac{R T}{v - b} - \\frac{a(T)}{v^2 + 2bv - b^2}\n$$\n\nThe analysis requires solving for the compressibility factor, defined as $Z = \\frac{pv}{RT}$. To achieve this, we first transform the pressure-explicit EoS into a cubic polynomial in $Z$.\n\n**Derivation of the Cubic Polynomial in Z for SRK EoS**\n\nStarting with the SRK equation:\n$$\np = \\frac{R T}{v - b} - \\frac{a(T)}{v(v+b)}\n$$\nWe multiply the entire equation by $\\frac{v(v+b)(v-b)}{p}$ to clear the denominators:\n$$\nv(v+b)(v-b) = \\frac{RT}{p}v(v+b) - \\frac{a(T)}{p}(v-b)\n$$\nExpanding the terms yields:\n$$\nv^3 - b^2v = \\frac{RT}{p}(v^2 + bv) - \\frac{a(T)}{p}v + \\frac{a(T)b}{p}\n$$\nRearranging into a polynomial form of $v$:\n$$\nv^3 - \\left(\\frac{RT}{p}\\right)v^2 - \\left(b^2 - \\frac{RTb}{p} + \\frac{a(T)}{p}\\right)v - \\frac{a(T)b}{p} = 0\n$$\nTo convert this to a polynomial in $Z$, we substitute $v = Z\\frac{RT}{p}$:\n$$\n\\left(Z\\frac{RT}{p}\\right)^3 - \\left(\\frac{RT}{p}\\right)\\left(Z\\frac{RT}{p}\\right)^2 - \\left(b^2 - \\frac{RTb}{p} + \\frac{a(T)}{p}\\right)\\left(Z\\frac{RT}{p}\\right) - \\frac{a(T)b}{p} = 0\n$$\nMultiplying the entire equation by $\\left(\\frac{p}{RT}\\right)^3$ simplifies the expression:\n$$\nZ^3 - Z^2 - \\left(\\frac{b^2p^2}{R^2T^2} - \\frac{bp}{RT} + \\frac{a(T)p}{R^2T^2}\\right)Z - \\frac{a(T)b p^2}{R^3T^3} = 0\n$$\nWe define the dimensionless parameters $A = \\frac{a(T)p}{R^2T^2}$ and $B = \\frac{bp}{RT}$. Substituting these gives the final cubic equation in $Z$ for the SRK model:\n$$\nZ^3 - Z^2 + (A - B - B^2)Z - AB = 0\n$$\n\n**Derivation of the Cubic Polynomial in Z for PR EoS**\n\nThe derivation for the PR model is analogous. Starting with:\n$$\np = \\frac{R T}{v - b} - \\frac{a(T)}{v^2 + 2bv - b^2}\n$$\nRearranging the equation to isolate terms and form a polynomial in $v$:\n$$\np(v-b)(v^2+2bv-b^2) = RT(v^2+2bv-b^2) - a(T)(v-b)\n$$\nExpanding and collecting terms of powers of $v$:\n$$\np(v^3 + bv^2 - 3b^2v + b^3) = RTv^2 + 2RTbv - RTb^2 - a(T)v + a(T)b\n$$\n$$\nv^3 + \\left(b - \\frac{RT}{p}\\right)v^2 + \\left(-3b^2 - \\frac{2RTb}{p} + \\frac{a(T)}{p}\\right)v + \\left(b^3 + \\frac{RTb^2}{p} - \\frac{a(T)b}{p}\\right) = 0\n$$\nSubstitute $v = Z\\frac{RT}{p}$ and multiply by $\\left(\\frac{p}{RT}\\right)^3$:\n$$\nZ^3 + \\left(\\frac{bp}{RT}-1\\right)Z^2 + \\left(-\\frac{3b^2p^2}{R^2T^2} - \\frac{2bp}{RT} + \\frac{a(T)p}{R^2T^2}\\right)Z + \\left(\\frac{b^3p^3}{R^3T^3} + \\frac{b^2p^2}{R^2T^2} - \\frac{a(T)bp^2}{R^3T^3}\\right) = 0\n$$\nUsing the same definitions for $A$ and $B$, we obtain the cubic equation in $Z$ for the PR model:\n$$\nZ^3 - (1-B)Z^2 + (A - 2B - 3B^2)Z - (AB - B^2 - B^3) = 0\n$$\n\n**Model Parameters**\n\nThe parameters $a$ and $b$ are not arbitrary; they are determined from the fluid's critical properties ($T_c, p_c$) by enforcing the criticality conditions ($\\frac{\\partial p}{\\partial v}|_{T_c} = 0$ and $\\frac{\\partial^2 p}{\\partial v^2}|_{T_c} = 0$). The parameter $a$ is also a function of temperature, expressed as $a(T) = a_c \\alpha(T)$, where $a_c = a(T_c)$.\n\nFor the **SRK model**:\n$$\na_c = \\Omega_a \\frac{R^2 T_c^2}{p_c} \\quad \\text{with} \\quad \\Omega_a = 0.42748\n$$\n$$\nb = \\Omega_b \\frac{R T_c}{p_c} \\quad \\text{with} \\quad \\Omega_b = 0.08664\n$$\n$$\n\\alpha_{\\text{SRK}}(T) = \\left[ 1 + m_{\\text{SRK}} \\left( 1 - \\sqrt{\\frac{T}{T_c}} \\right) \\right]^2\n$$\n$$\nm_{\\text{SRK}} = 0.480 + 1.574 \\omega - 0.176 \\omega^2\n$$\n\nFor the **PR model**:\n$$\na_c = \\Omega_a \\frac{R^2 T_c^2}{p_c} \\quad \\text{with} \\quad \\Omega_a = 0.45724\n$$\n$$\nb = \\Omega_b \\frac{R T_c}{p_c} \\quad \\text{with} \\quad \\Omega_b = 0.07780\n$$\n$$\n\\alpha_{\\text{PR}}(T) = \\left[ 1 + m_{\\text{PR}} \\left( 1 - \\sqrt{\\frac{T}{T_c}} \\right) \\right]^2\n$$\n$$\nm_{\\text{PR}} = 0.37464 + 1.54226 \\omega - 0.26992 \\omega^2\n$$\nHere, $\\omega$ is the Pitzer acentric factor, which characterizes the non-sphericity of the molecular potential field.\n\n**Numerical Solution Algorithm**\n\nFor each specified pressure $p$ and the given temperature $T=900$ K, we perform the following steps for each combination of EoS (SRK/PR) and $\\alpha(T)$ function (native/cross-substituted):\n\n1.  Convert the pressure from bar to Pascals: $p \\,[\\text{Pa}] = p \\,[\\text{bar}] \\times 10^5$.\n2.  Calculate the reduced temperature $T_r = T/T_c$.\n3.  Calculate the appropriate $m$ parameter based on the chosen $\\alpha(T)$ formulation and the acentric factor $\\omega$.\n4.  Calculate $\\alpha(T)$ using the chosen formulation.\n5.  Calculate the EoS-specific parameters $a_c$ and $b$ based on the chosen EoS structure (SRK or PR).\n6.  Calculate the temperature-dependent attraction parameter $a(T) = a_c \\alpha(T)$.\n7.  Compute the dimensionless parameters $A = \\frac{a(T)p}{R^2T^2}$ and $B = \\frac{bp}{RT}$.\n8.  Construct the coefficients of the cubic polynomial in $Z$ corresponding to the chosen EoS structure.\n9.  Solve the cubic equation for its three roots. A standard numerical root-finding algorithm for polynomials will be used.\n10. The roots can be real or complex. For a single-phase fluid, there will be either one or three real roots. We select the largest real root, which corresponds to the compressibility factor of the vapor phase.\n11. Using the computed $Z$ values, we calculate the required derived quantities: the deviation from ideal gas behavior $|Z-1|$, the difference between native SRK and PR predictions, and the change in $Z$ due to the cross-substitution of $\\alpha(T)$ functions.\n\nThis procedure is systematically applied to all test cases, and the results are aggregated for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes compressibility factors and related quantities for hydrogen\n    using SRK and PR equations of state, including cross-substitutions\n    of the alpha function.\n    \"\"\"\n\n    # --- Givens and Constants ---\n    R = 8.314462618  # Universal gas constant, J/(mol*K)\n    T_C_H2 = 33.19  # Critical temperature of H2, K\n    P_C_H2 = 12.8  # Critical pressure of H2, bar\n    OMEGA_H2 = -0.215  # Acentric factor of H2\n\n    T = 900.0  # Temperature, K\n    PRESSURES_BAR = [1.0, 50.0, 100.0]  # Pressures, bar\n    \n    # Convert critical pressure to Pascals\n    P_C_H2_PA = P_C_H2 * 1e5\n\n    def get_alpha_parameters(omega):\n        \"\"\"Calculates m_SRK and m_PR for the alpha functions.\"\"\"\n        m_srk = 0.480 + 1.574 * omega - 0.176 * omega**2\n        m_pr = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n        return m_srk, m_pr\n\n    def calculate_alpha(T, T_c, m):\n        \"\"\"Calculates the temperature-dependent alpha parameter.\"\"\"\n        T_r = T / T_c\n        return (1 + m * (1 - np.sqrt(T_r)))**2\n\n    def get_eos_parameters(eos_type):\n        \"\"\"Returns the constants Omega_a and Omega_b for SRK or PR.\"\"\"\n        if eos_type == 'SRK':\n            omega_a = 0.42748\n            omega_b = 0.08664\n        elif eos_type == 'PR':\n            omega_a = 0.45724\n            omega_b = 0.07780\n        else:\n            raise ValueError(\"Unknown EoS type\")\n        return omega_a, omega_b\n\n    def solve_Z(p_pa, T_kelvin, eos_type, alpha_type):\n        \"\"\"\n        Solves the cubic equation of state for the compressibility factor Z.\n\n        Args:\n            p_pa (float): Pressure in Pascals.\n            T_kelvin (float): Temperature in Kelvin.\n            eos_type (str): 'SRK' or 'PR' for the equation structure.\n            alpha_type (str): 'SRK' or 'PR' for the alpha function formulation.\n        \n        Returns:\n            float: The largest real root for Z (vapor phase).\n        \"\"\"\n        # 1. Get m parameters for both alpha functions\n        m_srk, m_pr = get_alpha_parameters(OMEGA_H2)\n        \n        # 2. Select appropriate m and calculate alpha\n        if alpha_type == 'SRK':\n            m = m_srk\n        else: # 'PR'\n            m = m_pr\n        alpha = calculate_alpha(T_kelvin, T_C_H2, m)\n        \n        # 3. Get EoS constants and calculate a_c and b\n        omega_a_eos, omega_b_eos = get_eos_parameters(eos_type)\n        a_c = omega_a_eos * (R**2 * T_C_H2**2) / P_C_H2_PA\n        b = omega_b_eos * (R * T_C_H2) / P_C_H2_PA\n        \n        # 4. Calculate a(T)\n        a_T = a_c * alpha\n        \n        # 5. Calculate dimensionless parameters A and B\n        A = a_T * p_pa / (R**2 * T_kelvin**2)\n        B = b * p_pa / (R * T_kelvin)\n        \n        # 6. Define polynomial coefficients based on EoS type\n        if eos_type == 'SRK':\n            # Z^3 - Z^2 + (A - B - B^2)Z - AB = 0\n            coeffs = [1, -1, A - B - B**2, -A * B]\n        else: # 'PR'\n            # Z^3 - (1-B)Z^2 + (A - 2B - 3B^2)Z - (AB - B^2 - B^3) = 0\n            coeffs = [1, -(1 - B), A - 2*B - 3*B**2, -(A*B - B**2 - B**3)]\n            \n        # 7. Solve for roots and select the largest real root\n        roots = np.roots(coeffs)\n        real_roots = roots[np.isreal(roots)].real\n        \n        if len(real_roots) == 0:\n            # Should not happen under these conditions\n            return np.nan\n        \n        return np.max(real_roots)\n\n    # --- Main Calculation Loop ---\n    z_srk_native_list = []\n    z_pr_native_list = []\n    z_pr_srk_alpha_list = []\n    z_srk_pr_alpha_list = []\n\n    for p_bar in PRESSURES_BAR:\n        p_pascal = p_bar * 1e5\n        \n        # Native models\n        z_srk_native = solve_Z(p_pascal, T, 'SRK', 'SRK')\n        z_pr_native = solve_Z(p_pascal, T, 'PR', 'PR')\n        \n        # Cross-substitution models\n        z_pr_srk_alpha = solve_Z(p_pascal, T, 'PR', 'SRK')\n        z_srk_pr_alpha = solve_Z(p_pascal, T, 'SRK', 'PR')\n        \n        z_srk_native_list.append(z_srk_native)\n        z_pr_native_list.append(z_pr_native)\n        z_pr_srk_alpha_list.append(z_pr_srk_alpha)\n        z_srk_pr_alpha_list.append(z_srk_pr_alpha)\n\n    # --- Post-processing to calculate required quantities ---\n    z_srk_native_arr = np.array(z_srk_native_list)\n    z_pr_native_arr = np.array(z_pr_native_list)\n    z_pr_srk_alpha_arr = np.array(z_pr_srk_alpha_list)\n    z_srk_pr_alpha_arr = np.array(z_srk_pr_alpha_list)\n\n    # Absolute deviations from ideal gas (Z=1)\n    dev_srk_list = np.abs(z_srk_native_arr - 1).tolist()\n    dev_pr_list = np.abs(z_pr_native_arr - 1).tolist()\n    \n    # Difference between native PR and SRK\n    diff_pr_srk_list = (z_pr_native_arr - z_srk_native_arr).tolist()\n    \n    # Change in Z due to alpha cross-substitution\n    change_pr_list = (z_pr_srk_alpha_arr - z_pr_native_arr).tolist()\n    change_srk_list = (z_srk_pr_alpha_arr - z_srk_native_arr).tolist()\n\n    # --- Format final output ---\n    results = [\n        z_srk_native_list,\n        z_pr_native_list,\n        dev_srk_list,\n        dev_pr_list,\n        diff_pr_srk_list,\n        change_pr_list,\n        change_srk_list,\n    ]\n\n    # Convert lists of floats to a string representation for the final print\n    # e.g., [[1.0, 2.0], [3.0, 4.0]] -> \"[[1.0, 2.0],[3.0, 4.0]]\"\n    output_str = str(results).replace(\" \", \"\")\n\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Practical combustion simulations rarely involve pure substances; they require modeling multi-component mixtures across wide ranges of temperature and pressure. This final exercise challenges you to extend the Peng-Robinson EOS to mixtures using classical mixing rules and to compute properties in the numerically sensitive near-critical region, where phase behavior is complex. Mastering the techniques in this problem is crucial for developing robust and reliable thermodynamic property routines for advanced, real-world combustion codes .",
            "id": "4023555",
            "problem": "Consider a single-component fluid and a binary mixture relevant to computational combustion. Use the Peng–Robinson equation of state (PR EOS) as the constitutive model for thermodynamic properties. You will derive expressions needed to compute the compressibility factor and evaluate the near-critical behavior. Then you will implement a program to compute the compressibility factor and a temperature-dependent attraction parameter for selected test states.\n\nFundamental base:\n- The compressibility factor is defined by $Z \\equiv \\dfrac{p\\,v}{R\\,T}$ where $p$ is pressure, $v$ is molar volume, $R$ is the universal gas constant, and $T$ is temperature.\n- The Peng–Robinson equation of state is a widely validated cubic equation of state that models real-gas behavior. For a single component, it is written in molar form as\n$$\np = \\frac{R\\,T}{v - b} - \\frac{a(T)}{v^2 + 2\\,b\\,v - b^2},\n$$\nwhere $a(T)$ is a temperature-dependent attraction parameter and $b$ is a covolume parameter. For a mixture, the same algebraic form holds but with mixture parameters $a_{\\mathrm{m}}(T)$ and $b_{\\mathrm{m}}$ computed from mixing rules.\n- The Peng–Robinson parameterization uses critical properties and the acentric factor to define $a(T)$ and $b$ via\n$$\na(T) = a_{\\mathrm{c}}\\,\\alpha(T),\\quad a_{\\mathrm{c}} = 0.45724\\,\\frac{R^2\\,T_{\\mathrm{c}}^2}{p_{\\mathrm{c}}},\\quad b = 0.07780\\,\\frac{R\\,T_{\\mathrm{c}}}{p_{\\mathrm{c}}},\n$$\n$$\n\\alpha(T) = \\left[1 + \\kappa\\left(1 - \\sqrt{\\frac{T}{T_{\\mathrm{c}}}}\\right)\\right]^2,\\quad \\kappa = 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^2,\n$$\nwhere $T_{\\mathrm{c}}$ is the critical temperature, $p_{\\mathrm{c}}$ is the critical pressure, and $\\omega$ is the acentric factor (dimensionless).\n\nFor a binary mixture of components $i \\in \\{1,2\\}$ with mole fractions $x_i$, classical mixing rules define\n$$\na_{\\mathrm{m}}(T) = \\sum_{i=1}^{2}\\sum_{j=1}^{2} x_i\\,x_j\\,\\sqrt{a_i(T)\\,a_j(T)}\\,(1 - k_{ij}),\\quad b_{\\mathrm{m}} = \\sum_{i=1}^{2} x_i\\,b_i,\n$$\nwhere $k_{ij}$ is the binary interaction parameter ($k_{ii} = 0$ by convention).\n\nTask:\n1. Starting from the PR EOS definition given above and the compressibility factor definition $Z = p\\,v/(R\\,T)$, derive a cubic polynomial in $Z$ with coefficients expressed in terms of the dimensionless parameters\n$$\nA \\equiv \\frac{a(T)\\,p}{R^2\\,T^2},\\quad B \\equiv \\frac{b\\,p}{R\\,T}\n$$\nfor the single-component case, and similarly with $a_{\\mathrm{m}}(T)$, $b_{\\mathrm{m}}$ for the mixture. You must show each step from the fundamental definitions to the final cubic in $Z$ without assuming intermediate shortcut formulas.\n2. Using the derived relations, implement a robust numerical strategy to compute all real roots of the cubic in $Z$ for a given state. Select the largest real root as the vapor-like compressibility factor and the smallest real root as the liquid-like compressibility factor. In states with only one real root, report that value as both vapor-like and liquid-like $Z$ since phases coincide near the critical point.\n3. Analyze numerically how $a(T)$ behaves as $T \\to T_{\\mathrm{c}}$ and how the real roots of the cubic coalesce or separate near the critical state. Your algorithm must incorporate computational safeguards suitable for combustion property calculations near critical conditions (for example, scaling to dimensionless groups, tolerances for root classification, and regularization of temperature ratios).\n4. Compute, for each test state specified below, the vapor-like compressibility factor $Z_{\\mathrm{v}}$ and the attraction parameter ($a$ for a single component or $a_{\\mathrm{m}}$ for the mixture). Report $Z_{\\mathrm{v}}$ as dimensionless and $a$ (or $a_{\\mathrm{m}}$) in $\\mathrm{Pa\\, m^6\\, mol^{-2}}$. Each test case result must be two numbers: first $Z_{\\mathrm{v}}$ (dimensionless), then $a$ (or $a_{\\mathrm{m}}$) in $\\mathrm{Pa\\, m^6\\, mol^{-2}}$.\n\nPhysical constants and properties (use International System of Units):\n- Use $R = 8.314462618\\ \\mathrm{J\\, mol^{-1}\\, K^{-1}}$.\n- Methane ($\\mathrm{CH_4}$): $T_{\\mathrm{c}} = 190.564\\ \\mathrm{K}$, $p_{\\mathrm{c}} = 4.5992\\times 10^{6}\\ \\mathrm{Pa}$, $\\omega = 0.011$.\n- Nitrogen ($\\mathrm{N_2}$): $T_{\\mathrm{c}} = 126.192\\ \\mathrm{K}$, $p_{\\mathrm{c}} = 3.3958\\times 10^{6}\\ \\mathrm{Pa}$, $\\omega = 0.0372$.\n- Binary interaction parameter for methane–nitrogen: $k_{12} = k_{21} = 0.03$ and $k_{11} = k_{22} = 0$.\n\nTest suite:\n- Case $1$ (single-component $\\mathrm{CH_4}$, near-critical below): $T = T_{\\mathrm{c}}(1 - 10^{-6})$, $p = p_{\\mathrm{c}}$.\n- Case $2$ (single-component $\\mathrm{CH_4}$, at critical): $T = T_{\\mathrm{c}}$, $p = p_{\\mathrm{c}}$.\n- Case $3$ (single-component $\\mathrm{CH_4}$, near-critical above): $T = T_{\\mathrm{c}}(1 + 10^{-6})$, $p = p_{\\mathrm{c}}$.\n- Case $4$ (single-component $\\mathrm{CH_4}$, dilute-gas): $T = 300\\ \\mathrm{K}$, $p = 1.0\\times 10^{5}\\ \\mathrm{Pa}$.\n- Case $5$ (binary mixture $\\mathrm{CH_4}/\\mathrm{N_2}$, composition $x_{\\mathrm{CH_4}} = 0.7$, $x_{\\mathrm{N_2}} = 0.3$, near methane critical pressure): $T = 190.564\\ \\mathrm{K}$, $p = 4.0\\times 10^{6}\\ \\mathrm{Pa}$.\n- Case $6$ (binary mixture $\\mathrm{CH_4}/\\mathrm{N_2}$, composition $x_{\\mathrm{CH_4}} = 0.7$, $x_{\\mathrm{N_2}} = 0.3$, high-temperature combustion-relevant): $T = 1500\\ \\mathrm{K}$, $p = 1.0\\times 10^{5}\\ \\mathrm{Pa}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the ordered pairs $(Z_{\\mathrm{v}},a)$ for each test case in ascending case order, flattened into a single list. For example, the output must be of the form\n$[Z_{\\mathrm{v,1}},a_1,Z_{\\mathrm{v,2}},a_2,\\dots,Z_{\\mathrm{v,6}},a_6]$,\nwith $Z_{\\mathrm{v,i}}$ dimensionless and $a_i$ in $\\mathrm{Pa\\, m^6\\, mol^{-2}}$.",
            "solution": "The posed problem is valid as it is scientifically grounded in established principles of chemical thermodynamics, mathematically well-posed, and free of ambiguity or contradiction. It requests the derivation and implementation of a standard model, the Peng–Robinson Equation of State (PR EOS), to compute thermodynamic properties of single-component and binary-mixture fluids, which is a canonical task in computational thermodynamics and combustion modeling. All necessary data and constants are provided. Therefore, I will proceed with a full solution.\n\nPart 1: Derivation of the Cubic Polynomial in Compressibility Factor $Z$\n\nThe problem begins with the definition of the Peng–Robinson equation of state in terms of molar volume $v$:\n$$\np = \\frac{R\\,T}{v - b} - \\frac{a(T)}{v^2 + 2\\,b\\,v - b^2}\n$$\nand the definition of the compressibility factor, $Z$:\n$$\nZ = \\frac{p\\,v}{R\\,T} \\implies v = \\frac{Z\\,R\\,T}{p}\n$$\nOur objective is to derive a cubic polynomial in $Z$. The most direct path is to first rearrange the PR EOS into a cubic polynomial in $v$, and then substitute the expression for $v$ in terms of $Z$.\n\nFirst, we clear the denominators by rearranging the EOS:\n$$\np + \\frac{a(T)}{v^2 + 2\\,b\\,v - b^2} = \\frac{R\\,T}{v - b}\n$$\nMultiply both sides by $(v - b)(v^2 + 2\\,b\\,v - b^2)$:\n$$\np\\,(v - b)\\,(v^2 + 2\\,b\\,v - b^2) + a(T)\\,(v - b) = R\\,T\\,(v^2 + 2\\,b\\,v - b^2)\n$$\nExpand the polynomial terms:\n$$\np\\,(v^3 + 2\\,b\\,v^2 - b^2v - b\\,v^2 - 2\\,b^2v + b^3) + a\\,v - a\\,b = R\\,T\\,v^2 + 2\\,R\\,T\\,b\\,v - R\\,T\\,b^2\n$$\nCollect terms with like powers of $v$:\n$$\np\\,v^3 + p\\,(b\\,v^2) - p\\,(3\\,b^2v) + p\\,b^3 + a\\,v - a\\,b = R\\,T\\,v^2 + 2\\,R\\,T\\,b\\,v - R\\,T\\,b^2\n$$\nMove all terms to the left-hand side to form a homogeneous polynomial equation:\n$$\np\\,v^3 + (p\\,b - R\\,T)\\,v^2 + (a - 3\\,p\\,b^2 - 2\\,R\\,T\\,b)\\,v + (p\\,b^3 + R\\,T\\,b^2 - a\\,b) = 0\n$$\nTo non-dimensionalize, we divide the entire equation by $p$:\n$$\nv^3 + (b - \\frac{R\\,T}{p})\\,v^2 + (\\frac{a}{p} - 3\\,b^2 - 2\\,b\\frac{R\\,T}{p})\\,v + (b^3 + b^2\\frac{R\\,T}{p} - \\frac{a\\,b}{p}) = 0\n$$\nNow, substitute $v = Z \\frac{R\\,T}{p}$ into this cubic equation in $v$:\n$$\n\\left(Z\\frac{R\\,T}{p}\\right)^3 + \\left(b - \\frac{R\\,T}{p}\\right)\\left(Z\\frac{R\\,T}{p}\\right)^2 + \\left(\\frac{a}{p} - 3\\,b^2 - 2\\,b\\frac{R\\,T}{p}\\right)\\left(Z\\frac{R\\,T}{p}\\right) + \\left(b^3 + b^2\\frac{R\\,T}{p} - \\frac{a\\,b}{p}\\right) = 0\n$$\nTo simplify, multiply the entire equation by $\\left(\\frac{p}{R\\,T}\\right)^3$:\n$$\nZ^3 + \\left(b\\frac{p}{R\\,T} - 1\\right)Z^2 + \\left(\\frac{a\\,p}{(R\\,T)^2} - 3\\,b^2\\frac{p^2}{(R\\,T)^2} - 2\\,b\\frac{p}{R\\,T}\\right)Z + \\left(b^3\\frac{p^3}{(R\\,T)^3} + b^2\\frac{p^2}{(R\\,T)^2} - \\frac{a\\,b\\,p^2}{(R\\,T)^3}\\right) = 0\n$$\nThe problem defines the dimensionless parameters $A$ and $B$:\n$$\nA \\equiv \\frac{a\\,p}{R^2\\,T^2}, \\quad B \\equiv \\frac{b\\,p}{R\\,T}\n$$\nSubstituting $A$ and $B$ into the equation yields:\n$$\nZ^3 + (B - 1)Z^2 + (A - 3B^2 - 2B)Z + (B^3 + B^2 - A\\,B) = 0\n$$\nRearranging to the canonical polynomial form $Z^3 + c_2Z^2 + c_1Z + c_0 = 0$, we have:\n$$\nc_2 = B - 1\n$$\n$$\nc_1 = A - 2B - 3B^2\n$$\n$$\nc_0 = B^3 + B^2 - AB\n$$\nFor convenience, this is often written as:\n$$\nZ^3 - (1 - B)Z^2 + (A - 2B - 3B^2)Z - (AB - B^2 - B^3) = 0\n$$\nThis is the required cubic polynomial in the compressibility factor $Z$. This same form applies to mixtures, provided that the parameters $a$ and $b$ are replaced by the mixture parameters $a_{\\mathrm{m}}$ and $b_{\\mathrm{m}}$, which in turn modifies the definitions of $A$ and $B$.\n\nPart 2: Numerical Strategy and Implementation\n\nThe solution to the problem requires a numerical algorithm to compute the parameters $a$ and $b$, formulate the coefficients of the cubic polynomial in $Z$, find its roots, and report the desired quantities.\n\nThe overall algorithm is as follows:\n1.  For a given state ($T$, $p$) and composition (mole fractions $x_i$ for components $i$), first compute the component-specific parameters. For each component $i$:\n    -   $a_{c,i} = 0.45724\\,\\frac{R^2\\,T_{\\mathrm{c},i}^2}{p_{\\mathrm{c},i}}$\n    -   $b_i = 0.07780\\,\\frac{R\\,T_{\\mathrm{c},i}}{p_{\\mathrm{c},i}}$\n    -   $\\kappa_i = 0.37464 + 1.54226\\,\\omega_i - 0.26992\\,\\omega_i^2$\n    -   $\\alpha_i(T) = \\left[1 + \\kappa_i\\left(1 - \\sqrt{T/T_{\\mathrm{c},i}}\\right)\\right]^2$\n    -   $a_i(T) = a_{c,i}\\,\\alpha_i(T)$\n\n2.  If the fluid is a mixture, compute the mixture parameters $a_{\\mathrm{m}}(T)$ and $b_{\\mathrm{m}}$ using the provided mixing rules:\n    -   $b_{\\mathrm{m}} = \\sum_i x_i b_i$\n    -   $a_{\\mathrm{m}}(T) = \\sum_i \\sum_j x_i x_j \\sqrt{a_i(T)a_j(T)}(1-k_{ij})$, where $k_{ii}=0$.\n    For a single component, $a_{\\mathrm{m}}(T) = a(T)$ and $b_{\\mathrm{m}} = b$.\n\n3.  With $a_{\\mathrm{m}}$ and $b_{\\mathrm{m}}$ (or $a$ and $b$ for a pure fluid), calculate the dimensionless groups $A$ and $B$:\n    -   $A = \\frac{a_{\\mathrm{m}}\\,p}{R^2\\,T^2}$\n    -   $B = \\frac{b_{\\mathrm{m}}\\,p}{R\\,T}$\n\n4.  Construct the coefficients of the cubic polynomial $Z^3 + c_2Z^2 + c_1Z + c_0 = 0$:\n    -   $c_2 = B - 1$\n    -   $c_1 = A - 2B - 3B^2$\n    -   $c_0 = B^3 + B^2 - AB$\n\n5.  Solve the cubic polynomial for its roots. A robust method, such as the companion matrix eigenvalue algorithm implemented in `numpy.roots`, is appropriate. This will yield three roots, which may be real or complex conjugate pairs.\n\n6.  Isolate the real roots. Since the coefficients are real, any complex roots must appear in conjugate pairs. A cubic polynomial must have at least one real root. We identify real roots by checking if the absolute value of their imaginary part is below a small numerical tolerance (e.g., $10^{-9}$).\n\n7.  As per the problem specification, the vapor-like compressibility factor, $Z_{\\mathrm{v}}$, is the largest real root. In a single-phase region or at the critical point, there is only one real root, which represents the fluid's compressibility. In a two-phase (vapor-liquid) region, there are three distinct real roots; the largest corresponds to the vapor phase, the smallest to the liquid phase, and the intermediate root is physically unstable.\n\nThe numerical implementation will use double-precision floating-point arithmetic, which is sufficient to handle the near-critical test cases where $T$ is very close to $T_{\\mathrm{c}}$. The term $\\sqrt{T/T_{\\mathrm{c}}}$ is well-behaved for all $T>0$. For the specified test cases, no catastrophic cancellation or other numerical instability is anticipated that would require special regularization beyond standard floating-point practices.\n\nThis procedure is systematically applied to each of the six test cases defined in the problem, yielding the required pairs of $(Z_{\\mathrm{v}}, a)$ or $(Z_{\\mathrm{v}}, a_{\\mathrm{m}})$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Peng-Robinson EOS for compressibility factor and attraction\n    parameter for a series of test cases.\n    \"\"\"\n\n    # Physical constants and properties\n    R = 8.314462618  # J mol^-1 K^-1\n\n    PROPERTIES = {\n        'CH4': {'Tc': 190.564, 'pc': 4.5992e6, 'omega': 0.011},\n        'N2':  {'Tc': 126.192, 'pc': 3.3958e6, 'omega': 0.0372}\n    }\n\n    # Binary interaction parameters {frozenset({comp1, comp2}): kij}\n    K_IJ = {\n        frozenset(['CH4', 'N2']): 0.03\n    }\n\n    def get_pr_eos_results(T, p, composition):\n        \"\"\"\n        Calculates the vapor-like compressibility factor Z_v and the mixture\n        attraction parameter a_m for a given state and composition.\n\n        Args:\n            T (float): Temperature in K.\n            p (float): Pressure in Pa.\n            composition (list): A list of tuples, where each tuple contains\n                                a component name (str) and its mole fraction (float).\n\n        Returns:\n            tuple: A tuple containing (Z_v, a_m), where Z_v is dimensionless and\n                   a_m is in Pa m^6 mol^-2.\n        \"\"\"\n        num_components = len(composition)\n        comp_names = [c[0] for c in composition]\n        mole_fractions = np.array([c[1] for c in composition])\n\n        # Step 1: Calculate individual component parameters\n        a_i_T = np.zeros(num_components)\n        b_i = np.zeros(num_components)\n\n        for i in range(num_components):\n            name = comp_names[i]\n            prop = PROPERTIES[name]\n            Tc, pc, omega = prop['Tc'], prop['pc'], prop['omega']\n\n            ac_i = 0.45724 * (R**2 * Tc**2) / pc\n            b_i[i] = 0.07780 * (R * Tc) / pc\n            \n            kappa_i = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n            \n            Tr = T / Tc\n            alpha_i_T = (1 + kappa_i * (1 - np.sqrt(Tr)))**2\n            a_i_T[i] = ac_i * alpha_i_T\n\n        # Step 2: Apply mixing rules\n        b_m = np.sum(mole_fractions * b_i)\n\n        a_m = 0.0\n        for i in range(num_components):\n            for j in range(num_components):\n                key = frozenset([comp_names[i], comp_names[j]])\n                k_ij = K_IJ.get(key, 0.0)\n                a_m += mole_fractions[i] * mole_fractions[j] * np.sqrt(a_i_T[i] * a_i_T[j]) * (1 - k_ij)\n        \n        # Step 3: Calculate dimensionless parameters A and B\n        A = a_m * p / (R**2 * T**2)\n        B = b_m * p / (R * T)\n\n        # Step 4: Formulate cubic polynomial coefficients for Z\n        # Z^3 + c2*Z^2 + c1*Z + c0 = 0\n        c2 = B - 1\n        c1 = A - 2 * B - 3 * B**2\n        c0 = B**3 + B**2 - A * B\n        \n        coeffs = [1, c2, c1, c0]\n\n        # Step 5 & 6: Solve for roots and find real roots\n        roots = np.roots(coeffs)\n        real_roots = roots[np.isclose(roots.imag, 0)].real\n\n        # Step 7: Select vapor-like root Z_v\n        Z_v = np.max(real_roots)\n        \n        return Z_v, a_m\n\n    # Test Suite\n    CH4_Tc = PROPERTIES['CH4']['Tc']\n    CH4_pc = PROPERTIES['CH4']['pc']\n    \n    test_cases = [\n        # Case 1: single-component CH4, near-critical below\n        {'T': CH4_Tc * (1 - 1e-6), 'p': CH4_pc, 'composition': [('CH4', 1.0)]},\n        # Case 2: single-component CH4, at critical\n        {'T': CH4_Tc, 'p': CH4_pc, 'composition': [('CH4', 1.0)]},\n        # Case 3: single-component CH4, near-critical above\n        {'T': CH4_Tc * (1 + 1e-6), 'p': CH4_pc, 'composition': [('CH4', 1.0)]},\n        # Case 4: single-component CH4, dilute-gas\n        {'T': 300.0, 'p': 1.0e5, 'composition': [('CH4', 1.0)]},\n        # Case 5: binary mixture CH4/N2, near methane critical pressure\n        {'T': 190.564, 'p': 4.0e6, 'composition': [('CH4', 0.7), ('N2', 0.3)]},\n        # Case 6: binary mixture CH4/N2, high-T combustion\n        {'T': 1500.0, 'p': 1.0e5, 'composition': [('CH4', 0.7), ('N2', 0.3)]},\n    ]\n\n    results = []\n    for case in test_cases:\n        Z_v, a_val = get_pr_eos_results(case['T'], case['p'], case['composition'])\n        results.append(Z_v)\n        results.append(a_val)\n    \n    # Format and print the final output\n    print(f\"[{','.join(f'{val:.8e}' for val in results)}]\")\n\nsolve()\n```"
        }
    ]
}