{
    "hands_on_practices": [
        {
            "introduction": "Before performing any calculations, we must ensure the integrity of our underlying data. This exercise highlights a foundational principle of modeling: the reverse rate constant, $k_r$, must be derived from an equilibrium constant, $K(T)$, that uses the exact same thermodynamic data source as the rest of your simulation. This practice problem demonstrates how mixing thermodynamic datasets, even for a single reaction, breaks the principle of detailed balance and forces the simulation to relax to a physically incorrect equilibrium state .",
            "id": "4058057",
            "problem": "In an ideal-gas combustion mechanism, consider the elementary reversible reaction $\\,\\mathrm{H} + \\mathrm{OH} \\rightleftharpoons \\mathrm{O} + \\mathrm{H}_2\\,$, for which the overall change in mole number is $\\,\\Delta \\nu = 0\\,$. A kinetics library supplies the forward rate constant at $\\,T=1500\\ \\mathrm{K}\\,$ as $\\,k_f(T)=1.00\\times 10^{14}\\ \\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}\\,$. Two independent thermodynamic property datasets, denoted Dataset $A$ and Dataset $B$, give different values for the standard-state reaction Gibbs free energy at $\\,T=1500\\ \\mathrm{K}\\,$:\n- Dataset $A$: $\\,\\Delta G^\\circ_{\\mathrm{rxn},A}(T)=+5.0\\ \\mathrm{kJ\\,mol^{-1}}\\,$,\n- Dataset $B$: $\\,\\Delta G^\\circ_{\\mathrm{rxn},B}(T)=+6.5\\ \\mathrm{kJ\\,mol^{-1}}\\,$.\n\nAssume ideal-gas standard states at $\\,p^\\circ=1\\ \\mathrm{bar}\\,$ and recall that the equilibrium constant for $\\,\\Delta \\nu=0\\,$ reactions is directly related to the standard-state reaction Gibbs free energy through the well-tested relation $\\,K(T)=\\exp\\!\\left(-\\Delta G^\\circ_{\\mathrm{rxn}}(T)/(R\\,T)\\right)\\,$, where $\\,R=8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$ is the universal gas constant.\n\nA developer constructs a simulation that\n(i) computes the reverse rate constant $\\,k_r(T)\\,$ from the kinetics library’s $\\,k_f(T)\\,$ together with $\\,K(T)\\,$ evaluated using Dataset $B$, but\n(ii) in a separate equilibrium module, evaluates the equilibrium constant $\\,K(T)\\,$ using Dataset $A$ to compare against the implied kinetic equilibrium $\\,K_{\\mathrm{rate}}(T)\\equiv k_f(T)/k_r(T)\\,$.\n\nBased on first-principles definitions of detailed balance and equilibrium in ideal gases, which option correctly identifies the requirement for thermodynamic consistency of $\\,k_r(T)\\,$ and quantifies the inconsistency introduced by mixing Dataset $A$ and Dataset $B$ as described? Choose the single best answer.\n\nA. The reverse rate constant $\\,k_r(T)\\,$ must be computed from $\\,k_f(T)\\,$ using an equilibrium constant $\\,K(T)\\,$ evaluated from the same species thermodynamic dataset used elsewhere in the model; otherwise $\\,K_{\\mathrm{rate}}(T)\\neq K_{\\mathrm{thermo}}(T)\\,$. With $\\,\\Delta G^\\circ_{\\mathrm{rxn},A}=5.0\\ \\mathrm{kJ\\,mol^{-1}}\\,$ and $\\,\\Delta G^\\circ_{\\mathrm{rxn},B}=6.5\\ \\mathrm{kJ\\,mol^{-1}}\\,$ at $\\,T=1500\\ \\mathrm{K}\\,$, the inconsistency factor is $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}=K_B/K_A\\approx 0.887\\,$, violating detailed balance.\n\nB. Any choice of thermochemical dataset is acceptable for computing $\\,k_r(T)\\,$ so long as the stoichiometry is correct; because $\\,\\Delta \\nu=0\\,$, mixing datasets cannot affect detailed balance and $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}=1.000\\,$.\n\nC. The reverse rate constant may be taken from an independent fit without regard to the thermodynamic dataset; if a mismatch arises the system still relaxes to the correct thermodynamic equilibrium, and for the data given $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}\\approx 1.13\\,$ which merely accelerates convergence.\n\nD. Using different thermodynamic datasets only rescales both $\\,k_f(T)\\,$ and $\\,k_r(T)\\,$ by the same factor, leaving $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}\\,$ invariant; for the values given the factor would be $\\,1.48\\,$ because $\\,\\exp(+\\Delta\\Delta G^\\circ/(R\\,T))\\,$ multiplies numerator and denominator identically.",
            "solution": "The user has provided a problem to be solved following a strict set of rules, including mandatory validation of the problem statement before attempting a solution.\n\n### Step 1: Extract Givens\n- **Reaction:** $\\mathrm{H} + \\mathrm{OH} \\rightleftharpoons \\mathrm{O} + \\mathrm{H}_2$\n- **Change in moles:** $\\Delta \\nu = 0$\n- **Temperature:** $T=1500\\ \\mathrm{K}$\n- **Forward rate constant:** $k_f(T)=1.00\\times 10^{14}\\ \\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$ at $T=1500\\ \\mathrm{K}$\n- **Dataset A:** Standard-state reaction Gibbs free energy, $\\Delta G^\\circ_{\\mathrm{rxn},A}(T)=+5.0\\ \\mathrm{kJ\\,mol^{-1}}$\n- **Dataset B:** Standard-state reaction Gibbs free energy, $\\Delta G^\\circ_{\\mathrm{rxn},B}(T)=+6.5\\ \\mathrm{kJ\\,mol^{-1}}$\n- **Standard state:** Ideal gas at $p^\\circ=1\\ \\mathrm{bar}$\n- **Equilibrium constant relation:** $K(T)=\\exp\\!\\left(-\\Delta G^\\circ_{\\mathrm{rxn}}(T)/(R\\,T)\\right)$\n- **Universal gas constant:** $R=8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- **Simulation setup:**\n    - (i) Reverse rate constant $k_r(T)$ is computed using $k_f(T)$ and an equilibrium constant $K(T)$ derived from Dataset B.\n    - (ii) A separate equilibrium module uses Dataset A to evaluate the \"thermodynamic\" equilibrium constant $K_{\\mathrm{thermo}}(T)$ for comparison against the implied kinetic equilibrium constant, $K_{\\mathrm{rate}}(T) \\equiv k_f(T)/k_r(T)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the required criteria.\n\n- **Scientifically Grounded:** The problem is based on fundamental principles of chemical kinetics and thermodynamics, specifically the relationship between rate constants and the equilibrium constant (detailed balance), and the relationship between the equilibrium constant and the standard Gibbs free energy of reaction. All concepts are standard in physical chemistry and combustion science. The reaction is a well-known elementary step in hydrogen and hydrocarbon combustion. The numerical values are physically plausible.\n- **Well-Posed:** The problem provides all necessary information to determine the inconsistency. It clearly defines two different thermodynamic datasets and how they are used incorrectly in a hypothetical simulation, then asks for a quantification of the resulting error. The question leads to a unique, stable, and meaningful solution.\n- **Objective:** The problem is stated in precise, quantitative terms. It describes a common pitfall in scientific software development (mixing inconsistent data sources) without any subjective or opinion-based language.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and objective. It contains no contradictions or missing information that would prevent a rigorous solution. Therefore, the problem is **valid**. The solution process will now proceed.\n\n### Derivation\nThe principle of detailed balance requires that at equilibrium, the rate of every elementary forward reaction equals the rate of its corresponding reverse reaction. For the given reaction, $\\mathrm{H} + \\mathrm{OH} \\underset{k_r}{\\stackrel{k_f}{\\rightleftharpoons}} \\mathrm{O} + \\mathrm{H}_2$, the equilibrium condition is:\n$$ k_f [\\mathrm{H}]_{\\mathrm{eq}}[\\mathrm{OH}]_{\\mathrm{eq}} = k_r [\\mathrm{O}]_{\\mathrm{eq}}[\\mathrm{H}_2]_{\\mathrm{eq}} $$\nThis leads to the fundamental relationship between the rate constants and the concentration-based equilibrium constant, $K_c(T)$:\n$$ \\frac{k_f(T)}{k_r(T)} = \\frac{[\\mathrm{O}]_{\\mathrm{eq}}[\\mathrm{H}_2]_{\\mathrm{eq}}}{[\\mathrm{H}]_{\\mathrm{eq}}[\\mathrm{OH}]_{\\mathrm{eq}}} = K_c(T) $$\nFor a gas-phase reaction, the relationship between the pressure-based equilibrium constant $K_p(T)$ and $K_c(T)$ is $K_p(T) = K_c(T) (RT/p^\\circ)^{\\Delta\\nu}$. The problem states that the change in the number of moles for the reaction, $\\Delta\\nu$, is zero. Consequently, $K_p(T) = K_c(T)$. We can refer to this simply as the equilibrium constant, $K(T)$.\n\nThermodynamic consistency in a reaction mechanism demands that the equilibrium constant implied by the kinetics, which we define as $K_{\\mathrm{rate}}(T) \\equiv k_f(T)/k_r(T)$, must be identical to the equilibrium constant derived from the thermodynamic properties of the species, $K_{\\mathrm{thermo}}(T)$. The latter is given by:\n$$ K_{\\mathrm{thermo}}(T) = \\exp\\left(-\\frac{\\Delta G^\\circ_{\\mathrm{rxn}}(T)}{RT}\\right) $$\nTherefore, for a consistent model, it must hold that:\n$$ \\frac{k_f(T)}{k_r(T)} = \\exp\\left(-\\frac{\\Delta G^\\circ_{\\mathrm{rxn}}(T)}{RT}\\right) $$\nThis means that $k_f(T)$, $k_r(T)$, and $\\Delta G^\\circ_{\\mathrm{rxn}}(T)$ are not independent; they must be linked by this relation using a single, consistent thermodynamic dataset.\n\nIn the described simulation, this principle is violated.\n1.  The developer calculates the reverse rate constant, $k_r(T)$, using the forward rate constant, $k_f(T)$, and the equilibrium constant derived from Dataset B, which we denote $K_B(T)$.\n    $$ K_B(T) = \\exp\\left(-\\frac{\\Delta G^\\circ_{\\mathrm{rxn},B}(T)}{RT}\\right) $$\n    The calculated reverse rate is $k_r(T) = k_f(T) / K_B(T)$.\n\n2.  The equilibrium constant that is implicitly defined by the chosen rate constants in the simulation is therefore:\n    $$ K_{\\mathrm{rate}}(T) = \\frac{k_f(T)}{k_r(T)} = \\frac{k_f(T)}{k_f(T) / K_B(T)} = K_B(T) $$\n\n3.  However, the simulation's equilibrium module uses Dataset A to define the \"correct\" thermodynamic equilibrium. This equilibrium constant is:\n    $$ K_{\\mathrm{thermo}}(T) = K_A(T) = \\exp\\left(-\\frac{\\Delta G^\\circ_{\\mathrm{rxn},A}(T)}{RT}\\right) $$\n\nThe problem asks to quantify the inconsistency, which is the ratio $K_{\\mathrm{rate}}(T) / K_{\\mathrm{thermo}}(T)$.\n$$ \\frac{K_{\\mathrm{rate}}(T)}{K_{\\mathrm{thermo}}(T)} = \\frac{K_B(T)}{K_A(T)} = \\frac{\\exp\\left(-\\Delta G^\\circ_{\\mathrm{rxn},B}/(RT)\\right)}{\\exp\\left(-\\Delta G^\\circ_{\\mathrm{rxn},A}/(RT)\\right)} = \\exp\\left(\\frac{\\Delta G^\\circ_{\\mathrm{rxn},A} - \\Delta G^\\circ_{\\mathrm{rxn},B}}{RT}\\right) $$\nWe are given the following values:\n- $T = 1500\\ \\mathrm{K}$\n- $\\Delta G^\\circ_{\\mathrm{rxn},A} = +5.0\\ \\mathrm{kJ\\,mol^{-1}} = 5000\\ \\mathrm{J\\,mol^{-1}}$\n- $\\Delta G^\\circ_{\\mathrm{rxn},B} = +6.5\\ \\mathrm{kJ\\,mol^{-1}} = 6500\\ \\mathrm{J\\,mol^{-1}}$\n- $R = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\nFirst, calculate the product $RT$:\n$$ RT = (8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (1500\\ \\mathrm{K}) = 12471\\ \\mathrm{J\\,mol^{-1}} $$\nNext, calculate the difference in Gibbs free energy values:\n$$ \\Delta G^\\circ_{\\mathrm{rxn},A} - \\Delta G^\\circ_{\\mathrm{rxn},B} = 5000\\ \\mathrm{J\\,mol^{-1}} - 6500\\ \\mathrm{J\\,mol^{-1}} = -1500\\ \\mathrm{J\\,mol^{-1}} $$\nNow, compute the ratio:\n$$ \\frac{K_{\\mathrm{rate}}}{K_{\\mathrm{thermo}}} = \\exp\\left(\\frac{-1500\\ \\mathrm{J\\,mol^{-1}}}{12471\\ \\mathrm{J\\,mol^{-1}}}\\right) \\approx \\exp(-0.120279) \\approx 0.88667 $$\nRounding to three significant figures, the inconsistency factor is $0.887$.\n\n### Option-by-Option Analysis\n\n**A. The reverse rate constant $\\,k_r(T)\\,$ must be computed from $\\,k_f(T)\\,$ using an equilibrium constant $\\,K(T)\\,$ evaluated from the same species thermodynamic dataset used elsewhere in the model; otherwise $\\,K_{\\mathrm{rate}}(T)\\neq K_{\\mathrm{thermo}}(T)\\,$. With $\\,\\Delta G^\\circ_{\\mathrm{rxn},A}=5.0\\ \\mathrm{kJ\\,mol^{-1}}\\,$ and $\\,\\Delta G^\\circ_{\\mathrm{rxn},B}=6.5\\ \\mathrm{kJ\\,mol^{-1}}\\,$ at $\\,T=1500\\ \\mathrm{K}\\,$, the inconsistency factor is $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}=K_B/K_A\\approx 0.887\\,$, violating detailed balance.**\n- This option correctly states the requirement for thermodynamic consistency. It correctly identifies that in the problem's scenario, $K_{\\mathrm{rate}}$ is associated with Dataset B and $K_{\\mathrm{thermo}}$ with Dataset A. The calculation of the ratio $K_B/K_A$ as approximately $0.887$ is correct, as derived above. A system with $K_{\\mathrm{rate}} \\neq K_{\\mathrm{thermo}}$ will not relax to the thermodynamically defined equilibrium, thus violating the consequences of detailed balance.\n- **Verdict: Correct.**\n\n**B. Any choice of thermochemical dataset is acceptable for computing $\\,k_r(T)\\,$ so long as the stoichiometry is correct; because $\\,\\Delta \\nu=0\\,$, mixing datasets cannot affect detailed balance and $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}=1.000\\,$.**\n- This is incorrect. The choice of thermodynamic dataset is critical as it defines $\\Delta G^\\circ_{\\mathrm{rxn}}$ and thus $K(T)$. Mixing datasets leads to an inconsistency where $K_{\\mathrm{rate}} \\neq K_{\\mathrm{thermo}}$. The condition $\\Delta \\nu=0$ simplifies the expression for $K(T)$ but does not eliminate the need for consistency. The ratio is not $1.000$.\n- **Verdict: Incorrect.**\n\n**C. The reverse rate constant may be taken from an independent fit without regard to the thermodynamic dataset; if a mismatch arises the system still relaxes to the correct thermodynamic equilibrium, and for the data given $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}\\approx 1.13\\,$ which merely accelerates convergence.**\n- This is incorrect. If $k_r(T)$ is chosen independently such that $K_{\\mathrm{rate}} \\neq K_{\\mathrm{thermo}}$, the kinetic simulation will relax to a steady state where net reaction rates are zero, but this state will correspond to the equilibrium defined by $K_{\\mathrm{rate}}$, not the one defined by $K_{\\mathrm{thermo}}$. It is a fundamentally incorrect equilibrium state. The calculated ratio of $1.13$ is the inverse of the correct ratio ($1/0.887 \\approx 1.1275$). An inconsistency leads to wrong results, it does not \"merely accelerate convergence\".\n- **Verdict: Incorrect.**\n\n**D. Using different thermodynamic datasets only rescales both $\\,k_f(T)\\,$ and $\\,k_r(T)\\,$ by the same factor, leaving $\\,K_{\\mathrm{rate}}/K_{\\mathrm{thermo}}\\,$ invariant; for the values given the factor would be $\\,1.48\\,$ because $\\,\\exp(+\\Delta\\Delta G^\\circ/(R\\,T))\\,$ multiplies numerator and denominator identically.**\n- This is incorrect. The forward rate constant $k_f(T)$ is supplied by a kinetics library and is unaffected by the choice of thermodynamic dataset. Only $k_r(T)$ is computed from the thermodynamic data (and $k_f(T)$). Since $k_f(T)$ is constant and $k_r(T)$ changes depending on the dataset used, their ratio $K_{\\mathrm{rate}}$ is not invariant. The premise of the argument is fallacious.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "In computational practice, forward rate coefficients are typically expressed in concentration units, while thermodynamic databases provide the pressure-based equilibrium constant, $K_p$. Bridging this gap is a crucial and common task. This hands-on coding exercise guides you through developing a robust routine to correctly compute the reverse rate coefficient, $k_r$, paying special attention to the conversion from $K_p$ to the concentration-based $K_c$, which is critically dependent on the change in the number of moles, $\\Delta \\nu$ .",
            "id": "4058172",
            "problem": "A reversible elementary gas-phase reaction is written as $\\sum_i \\nu_i^{\\prime} X_i \\rightleftharpoons \\sum_i \\nu_i^{\\prime\\prime} X_i$, where $\\nu_i^{\\prime}$ and $\\nu_i^{\\prime\\prime}$ are the stoichiometric coefficients of species $X_i$ in the forward and reverse directions, respectively. Let $\\Delta \\nu \\equiv \\sum_i \\nu_i^{\\prime\\prime} - \\sum_i \\nu_i^{\\prime}$ denote the net change in total mole number across the reaction. The forward rate coefficient $k_f$ is specified in concentration-based units consistent with the Ideal Gas Law (IGL), $p_i = c_i R T$, where $p_i$ is partial pressure in $\\mathrm{Pa}$, $c_i$ is concentration in $\\mathrm{mol/m^3}$, $R$ is the universal gas constant in $\\mathrm{J/(mol\\cdot K)}$, and $T$ is temperature in $\\mathrm{K}$. The reverse rate coefficient $k_r$ must be computed from the pressure-based equilibrium constant $K_p(T)$ defined with respect to the Standard State Pressure (SSP) $p^\\circ = 1~\\mathrm{bar}$, where $1~\\mathrm{bar} = 10^5~\\mathrm{Pa}$. Assume ideal-gas thermodynamics and elementary reaction kinetics.\n\nStarting from first principles, namely (i) the law of mass action for elementary reactions, (ii) the Ideal Gas Law (IGL), and (iii) the thermodynamic definition of the equilibrium constant in pressure form, derive the relationship between $k_r$ and $k_f$ that ensures thermodynamic consistency (detailed balance) at equilibrium. Specifically, show how to correctly incorporate $\\Delta \\nu$ and the factor $(R T / p^\\circ)^{\\Delta \\nu}$ in converting $K_p(T)$ to the concentration-based equilibrium constant $K_c(T)$ needed to relate $k_f$ and $k_r$.\n\nThen implement a robust routine that:\n- Computes $\\Delta \\nu$ from given integer stoichiometric coefficient lists for reactants and products,\n- Converts $K_p(T)$ to $K_c(T)$ using the correct power of $(R T / p^\\circ)$,\n- Computes $k_r$ from $k_f$ and $K_c(T)$ so that detailed balance is satisfied.\n\nAll quantities must use International System of Units (SI). The forward rate coefficient $k_f$ is provided in SI units consistent with concentrations in $\\mathrm{mol/m^3}$ and time in $\\mathrm{s}$. For unimolecular reactions ($\\sum_i \\nu_i^{\\prime} = 1$), $k_f$ has units of $\\mathrm{s^{-1}}$; for bimolecular reactions ($\\sum_i \\nu_i^{\\prime} = 2$), $k_f$ has units of $\\mathrm{m^3/(mol\\cdot s)}$; for termolecular reactions ($\\sum_i \\nu_i^{\\prime} = 3$), $k_f$ has units of $\\mathrm{m^6/(mol^2\\cdot s)}$, and similarly for higher orders. Your program must output $k_r$ in SI units consistent with these conventions.\n\nUse the universal gas constant $R = 8.31446261815324~\\mathrm{J/(mol\\cdot K)}$ and the standard state pressure $p^\\circ = 10^5~\\mathrm{Pa}$.\n\nTest Suite:\nProvide a procedure that evaluates the following four test cases. Each test case is defined as a tuple $(k_f, T, K_p, \\boldsymbol{\\nu}^{\\prime}, \\boldsymbol{\\nu}^{\\prime\\prime})$:\n\n- Case 1 (happy path, $\\Delta \\nu = 0$): Water-gas shift-like stoichiometry\n  - $k_f = 10^{-3}$,\n  - $T = 1200$,\n  - $K_p = 1.2$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [1, 1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [1, 1]$.\n\n- Case 2 (net mole reduction, $\\Delta \\nu = -1$): $2\\mathrm{H}_2 + \\mathrm{O}_2 \\rightleftharpoons 2\\mathrm{H}_2\\mathrm{O}$\n  - $k_f = 10^{-16}$,\n  - $T = 1000$,\n  - $K_p = 10^{14}$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [2, 1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [2]$.\n\n- Case 3 (net mole increase, $\\Delta \\nu = +1$): $\\mathrm{N}_2\\mathrm{O}_4 \\rightleftharpoons 2\\mathrm{NO}_2$\n  - $k_f = 2 \\times 10^{-3}$,\n  - $T = 400$,\n  - $K_p = 0.05$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [2]$.\n\n- Case 4 (high temperature dissociation, $\\Delta \\nu = +1$): $\\mathrm{H}_2 \\rightleftharpoons 2\\mathrm{H}$\n  - $k_f = 100$,\n  - $T = 2500$,\n  - $K_p = 10^{-3}$,\n  - $\\boldsymbol{\\nu}^{\\prime} = [1]$,\n  - $\\boldsymbol{\\nu}^{\\prime\\prime} = [2]$.\n\nRequired final output format:\nYour program should produce a single line of output containing the computed reverse rate coefficients for the four test cases as a comma-separated list enclosed in square brackets, in the order given above, for example, $\\left[ r_1, r_2, r_3, r_4 \\right]$, where each $r_i$ is a floating-point number representing $k_r$ in SI units consistent with concentration-based kinetics.",
            "solution": "The problem is valid as it is scientifically grounded in fundamental principles of chemical kinetics and thermodynamics, well-posed with all necessary data provided, and expressed in objective, formal language. We may therefore proceed with the derivation and solution.\n\nThe problem requires the derivation of a thermodynamically consistent relationship between the forward rate coefficient, $k_f$, and the reverse rate coefficient, $k_r$, for a general elementary gas-phase reaction:\n$$\n\\sum_{i} \\nu_i^{\\prime} X_i \\rightleftharpoons \\sum_{i} \\nu_i^{\\prime\\prime} X_i\n$$\nHere, $X_i$ is a chemical species, and $\\nu_i^{\\prime}$ and $\\nu_i^{\\prime\\prime}$ are its stoichiometric coefficients as a reactant (forward direction) and product (reverse direction), respectively.\n\nOur derivation will be based on three first principles as requested: (i) the law of mass action for elementary reactions, (ii) the Ideal Gas Law (IGL), and (iii) the thermodynamic definition of the pressure-based equilibrium constant, $K_p$.\n\nFirst, we apply the law of mass action. For an elementary reaction, the forward rate of reaction, $R_f$, is proportional to the product of the concentrations of the reactants, each raised to the power of its stoichiometric coefficient:\n$$\nR_f = k_f \\prod_{i} [X_i]^{\\nu_i^{\\prime}}\n$$\nwhere $[X_i]$ represents the molar concentration of species $X_i$ in units of $\\mathrm{mol/m^3}$ and $k_f$ is the forward rate coefficient.\n\nSimilarly, the reverse rate of reaction, $R_r$, is given by:\n$$\nR_r = k_r \\prod_{i} [X_i]^{\\nu_i^{\\prime\\prime}}\n$$\nwhere $k_r$ is the reverse rate coefficient.\n\nThe principle of detailed balance requires that at chemical equilibrium, the forward rate must equal the reverse rate for every elementary reaction. Thus, at equilibrium, $R_{f, \\text{eq}} = R_{r, \\text{eq}}$:\n$$\nk_f \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime}} = k_r \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime}}\n$$\nwhere the subscript 'eq' denotes equilibrium conditions.\n\nThis equation can be rearranged to relate the ratio of the rate coefficients to the ratio of the products of equilibrium concentrations:\n$$\n\\frac{k_f}{k_r} = \\frac{\\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime}}}{\\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime}}} = \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime}}\n$$\nThe right-hand side of this expression is, by definition, the concentration-based equilibrium constant, $K_c(T)$:\n$$\nK_c(T) = \\prod_{i} [X_i]_{\\text{eq}}^{\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime}}\n$$\nTherefore, the rate coefficients are directly related through $K_c(T)$:\n$$\n\\frac{k_f(T)}{k_r(T)} = K_c(T)\n$$\n\nNext, we introduce the thermodynamic pressure-based equilibrium constant, $K_p(T)$. For a mixture of ideal gases, the activity of species $i$ is defined as $a_i = p_i / p^\\circ$, where $p_i$ is its partial pressure and $p^\\circ$ is the standard state pressure ($1~\\mathrm{bar}$ or $10^5~\\mathrm{Pa}$). $K_p(T)$ is defined in terms of these activities at equilibrium:\n$$\nK_p(T) = \\prod_{i} a_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} = \\prod_{i} \\left( \\frac{p_{i, \\text{eq}}}{p^\\circ} \\right)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}\n$$\nWe can separate the pressure terms:\n$$\nK_p(T) = \\frac{\\prod_{i} p_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{\\prod_{i} (p^\\circ)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}} = \\frac{\\prod_{i} p_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{(p^\\circ)^{\\sum_i (\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}\n$$\nLet $\\Delta \\nu$ be the net change in the total number of moles for the reaction, defined as $\\Delta \\nu = \\sum_i \\nu_i^{\\prime\\prime} - \\sum_i \\nu_i^{\\prime}$. The expression for $K_p(T)$ becomes:\n$$\nK_p(T) = \\frac{\\prod_{i} p_{i, \\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{(p^\\circ)^{\\Delta \\nu}}\n$$\n\nNow, we connect the pressure-based and concentration-based constants using the Ideal Gas Law (IGL), which relates the partial pressure $p_i$ of a species to its molar concentration $[X_i]$ and the temperature $T$:\n$$\np_i = [X_i] R T\n$$\nwhere $R$ is the universal gas constant. Substituting the IGL into the expression for $K_p(T)$:\n$$\nK_p(T) = \\frac{\\prod_{i} ([X_i]_{\\text{eq}} R T)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})}}{(p^\\circ)^{\\Delta \\nu}}\n$$\nFactoring out the terms, we get:\n$$\nK_p(T) = \\frac{ \\left( \\prod_{i} [X_i]_{\\text{eq}}^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} \\right) \\left( \\prod_{i} (R T)^{(\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} \\right) }{(p^\\circ)^{\\Delta \\nu}}\n$$\nThe first term in the numerator is $K_c(T)$. The second term simplifies to $(R T)^{\\sum_i (\\nu_i^{\\prime\\prime} - \\nu_i^{\\prime})} = (R T)^{\\Delta \\nu}$. This yields the fundamental relationship between $K_p(T)$ and $K_c(T)$:\n$$\nK_p(T) = K_c(T) \\frac{(R T)^{\\Delta \\nu}}{(p^\\circ)^{\\Delta \\nu}} = K_c(T) \\left( \\frac{R T}{p^\\circ} \\right)^{\\Delta \\nu}\n$$\n\nTo find $k_r$, we first express $K_c(T)$ in terms of the given $K_p(T)$:\n$$\nK_c(T) = K_p(T) \\left( \\frac{R T}{p^\\circ} \\right)^{-\\Delta \\nu} = K_p(T) \\left( \\frac{p^\\circ}{R T} \\right)^{\\Delta \\nu}\n$$\nFinally, by substituting this into the detailed balance relation $k_r = k_f / K_c$, we obtain the desired formula for the reverse rate coefficient:\n$$\nk_r(T) = \\frac{k_f(T)}{K_c(T)} = \\frac{k_f(T)}{K_p(T) \\left( \\frac{p^\\circ}{R T} \\right)^{\\Delta \\nu}}\n$$\nThis simplifies to the final expression to be implemented:\n$$\nk_r(T) = \\frac{k_f(T)}{K_p(T)} \\left( \\frac{R T}{p^\\circ} \\right)^{\\Delta \\nu}\n$$\nThis relationship ensures thermodynamic consistency. The algorithmic implementation will involve:\n$1$. Computing $\\Delta \\nu = \\sum \\nu_i^{\\prime\\prime} - \\sum \\nu_i^{\\prime}$ from the input stoichiometric coefficient vectors.\n$2$. Evaluating the dimensionless conversion term $(RT/p^\\circ)^{\\Delta\\nu}$. Note that $p^\\circ$ must be in SI units ($\\mathrm{Pa}$) to match $R$ and $T$.\n$3$. Calculating $k_r$ using the derived formula. The units of $k_r$ will be consistent with concentration in $\\mathrm{mol/m^3}$ and time in $\\mathrm{s}$, as demonstrated by a dimensional analysis of the terms.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the reverse rate coefficient for a reversible elementary\n    gas-phase reaction to ensure thermodynamic consistency.\n    \"\"\"\n\n    # Define physical constants in SI units.\n    # Universal gas constant in J/(mol·K)\n    R = 8.31446261815324\n    # Standard State Pressure (SSP) in Pa (1 bar = 10^5 Pa)\n    P_STANDARD = 100000.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k_f, T, K_p, nu_prime, nu_double_prime)\n    # k_f: forward rate coefficient (SI units, mol/m^3 basis)\n    # T: temperature (K)\n    # K_p: pressure-based equilibrium constant (dimensionless)\n    # nu_prime: list of reactant stoichiometric coefficients\n    # nu_double_prime: list of product stoichiometric coefficients\n    test_cases = [\n        # Case 1: Water-gas shift-like, Delta_nu = 0\n        (1.0e-3, 1200.0, 1.2, [1, 1], [1, 1]),\n        \n        # Case 2: Water formation, Delta_nu = -1\n        (1.0e-16, 1000.0, 1.0e14, [2, 1], [2]),\n        \n        # Case 3: N2O4 dissociation, Delta_nu = +1\n        (2.0e-3, 400.0, 0.05, [1], [2]),\n        \n        # Case 4: H2 dissociation, Delta_nu = +1\n        (100.0, 2500.0, 1.0e-3, [1], [2]),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        kf, T, Kp, nu_prime, nu_double_prime = case\n\n        # Step 1: Compute Delta_nu, the net change in total mole number.\n        sum_nu_prime = sum(nu_prime)\n        sum_nu_double_prime = sum(nu_double_prime)\n        delta_nu = float(sum_nu_double_prime - sum_nu_prime)\n\n        # Step 2: Compute the conversion factor from Kp to Kc.\n        # The relationship is Kc = Kp * (p_std / (R * T))**delta_nu.\n        # The reverse rate coefficient is kr = kf / Kc.\n        # Combining these gives: kr = kf / (Kp * (p_std / (R*T))**delta_nu)\n        # Which simplifies to: kr = (kf / Kp) * ((R*T) / p_std)**delta_nu\n        \n        # The term (R * T / P_STANDARD) has units of m^3/mol.\n        conversion_factor = (R * T / P_STANDARD) ** delta_nu\n        \n        # Step 3: Compute the reverse rate coefficient kr.\n        # Handle the case where Kp might be zero to avoid division by zero,\n        # though not expected in these test cases.\n        if Kp == 0:\n            # If Kp is zero, the reverse reaction is infinitely favored,\n            # implying kr would be infinitely large if kf is non-zero.\n            # This is a physical edge case not present in the tests.\n            # For practical purposes, we might represent this as infinity.\n            kr = float('inf')\n        else:\n            kr = (kf / Kp) * conversion_factor\n            \n        results.append(kr)\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of float values enclosed in square brackets.\n    # Using a list comprehension and str.join for clean formatting.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After building a kinetic model, how can you verify that it is thermodynamically consistent? This advanced exercise challenges you to move from implementing individual reactions to validating an entire mechanism. You will design and code a numerical test that checks for detailed balance by first calculating a reaction's true thermodynamic equilibrium composition and then confirming that the forward and reverse rates are indeed equal at that state. This practice provides a powerful, general method for debugging kinetic models and ensuring their physical fidelity .",
            "id": "4058122",
            "problem": "You are to design and implement a numerical test that verifies detailed balance for individual reversible reactions by computing the forward–reverse rate residual at a composition constrained by the thermodynamic equilibrium constant. The test must be general, transparent, and reproducible. Your program must take a small, specified test suite of reactions and produce a single line of output listing a residual metric for each case.\n\nStart from the following fundamental base:\n- Ideal Gas Law (IGL): partial pressure and concentration of an ideal gas are related by $p_i = C_i R T$, where $p_i$ is partial pressure, $C_i$ is molar concentration in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $R$ is the universal gas constant, $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and $T$ is absolute temperature in $\\mathrm{K}$.\n- Law of Mass Action: for a reaction with net stoichiometry $\\sum_i \\nu_{i,f} X_i \\rightleftharpoons \\sum_i \\nu_{i,r} X_i$, the forward rate is $r_f = k_f \\prod_i C_i^{\\nu_{i,f}}$ and the reverse rate is $r_r = k_r \\prod_i C_i^{\\nu_{i,r}}$, where $k_f$ and $k_r$ are rate coefficients in units consistent with the overall reaction order and concentrations $C_i$ given in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Thermodynamic equilibrium constant: the pressure-based equilibrium constant is $K_p(T) = \\exp\\!\\left(-\\Delta G^\\circ_r(T)/(R T)\\right)$, where $\\Delta G^\\circ_r(T)$ is the standard Gibbs free energy change of reaction in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$. The concentration-based equilibrium constant is related by $K_p(T) = K_c(T) (R T)^{\\Delta \\nu}$, with $\\Delta \\nu = \\sum_i \\nu_{i,r} - \\sum_i \\nu_{i,f}$.\n\nAt thermodynamic equilibrium and for a mechanism that is thermodynamically consistent, detailed balance holds: $r_f = r_r$ when the composition satisfies $K_c(T)$ and $k_r = k_f / K_c(T)$. Your task is to compute $r_f - r_r$ at the composition that enforces $K_c(T)$ for each reaction, and to demonstrate how violations of thermodynamic consistency manifest when $k_r$ is not computed from $K_c(T)$.\n\nDefine the reaction extent $\\xi$ for a single reaction with initial concentrations $C_{i,0}$ and net stoichiometric signed coefficients $s_i = \\nu_{i,r} - \\nu_{i,f}$, so that $C_i(\\xi) = C_{i,0} + s_i \\xi$. The equilibrium composition for the single-reaction mixture is found by solving the scalar constraint\n$$\n\\frac{\\prod_i C_i(\\xi)^{\\nu_{i,r}}}{\\prod_i C_i(\\xi)^{\\nu_{i,f}}} \\;=\\; K_c(T),\n$$\nsubject to the physical bounds that keep all $C_i(\\xi) \\ge 0$. Use this $\\xi$ to evaluate $r_f$ and $r_r$ and report a normalized residual\n$$\n\\varepsilon \\;=\\; \\frac{r_f - r_r}{\\lvert r_f \\rvert + \\lvert r_r \\rvert + \\varepsilon_0},\n$$\nwhere $\\varepsilon_0$ is a small positive number (use $10^{-300}$) to prevent division by zero. The normalized residual $\\varepsilon$ is dimensionless.\n\nImplement the forward rate coefficient using the Arrhenius form $k_f(T) = A T^n \\exp\\!\\left(-E_a/(R T)\\right)$, where $A$, $n$, and $E_a$ are provided parameters. Units must be consistent: concentrations $C_i$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, temperature $T$ in $\\mathrm{K}$, activation energy $E_a$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$, and time in $\\mathrm{s}$. The units of $A$ depend on the overall reaction order $m = \\sum_i \\nu_{i,f}$: for $m = 1$, $A$ has units $\\mathrm{s}^{-1}$; for $m = 2$, $A$ has units $\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$; for $m = 3$, $A$ has units $\\mathrm{m}^6\\,\\mathrm{mol}^{-2}\\,\\mathrm{s}^{-1}$, and so on.\n\nTest suite. Use the following three cases. In each, compute $K_p(T)$, $K_c(T)$, the equilibrium extent $\\xi$, the forward $k_f(T)$, the reverse $k_r(T)$, rates $r_f$ and $r_r$, and then $\\varepsilon$.\n\n- Case $1$ (thermodynamically consistent, negative $\\Delta \\nu$):\n    - Reaction: $A + B \\rightleftharpoons C$.\n    - Temperature: $T = 1000\\,\\mathrm{K}$.\n    - Standard Gibbs free energy of reaction: $\\Delta G^\\circ_r(T) = -20000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n    - Net stoichiometric coefficients: $\\nu_{A,f} = 1$, $\\nu_{B,f} = 1$, $\\nu_{C,r} = 1$, others zero. Thus $\\Delta \\nu = 1 - 2 = -1$.\n    - Initial concentrations: $C_{A,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{B,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{C,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n    - Arrhenius parameters (forward): $A = 1.0 \\times 10^{6}$, $n = 0.0$, $E_a = 60000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n    - Reverse rate coefficient: $k_r = k_f / K_c(T)$ (consistent).\n\n- Case $2$ (thermodynamic violation demonstration, positive $\\Delta \\nu$):\n    - Reaction: $C \\rightleftharpoons A + B$.\n    - Temperature: $T = 1200\\,\\mathrm{K}$.\n    - Standard Gibbs free energy of reaction: $\\Delta G^\\circ_r(T) = +15000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n    - Net stoichiometric coefficients: $\\nu_{C,f} = 1$, $\\nu_{A,r} = 1$, $\\nu_{B,r} = 1$, others zero. Thus $\\Delta \\nu = 2 - 1 = +1$.\n    - Initial concentrations: $C_{C,0} = 1.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{A,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{B,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n    - Arrhenius parameters (forward): $A = 1.0 \\times 10^{3}$, $n = 0.0$, $E_a = 80000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n    - Reverse rate coefficient: $k_r = \\alpha \\, k_f / K_c(T)$ with $\\alpha = 2.0$ (intentional inconsistency).\n\n- Case $3$ (thermodynamically consistent, zero $\\Delta \\nu$ as a boundary case):\n    - Reaction: $A + B \\rightleftharpoons D + E$.\n    - Temperature: $T = 800\\,\\mathrm{K}$.\n    - Standard Gibbs free energy of reaction: $\\Delta G^\\circ_r(T) = -5000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n    - Net stoichiometric coefficients: $\\nu_{A,f} = 1$, $\\nu_{B,f} = 1$, $\\nu_{D,r} = 1$, $\\nu_{E,r} = 1$, others zero. Thus $\\Delta \\nu = (1 + 1) - (1 + 1) = 0$.\n    - Initial concentrations: $C_{A,0} = 0.5\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{B,0} = 0.5\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{D,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{E,0} = 0.0\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n    - Arrhenius parameters (forward): $A = 2.0 \\times 10^{5}$, $n = 0.0$, $E_a = 50000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n    - Reverse rate coefficient: $k_r = k_f / K_c(T)$ (consistent).\n\nAlgorithmic requirements:\n- Compute $K_p(T)$ and $K_c(T)$ using the formulas above.\n- Compute the equilibrium reaction extent $\\xi$ by solving the scalar equation for $K_c(T)$ using a robust root-finding approach on the physically admissible interval $\\xi \\in [\\xi_{\\min}, \\xi_{\\max}]$, where $\\xi_{\\min}$ and $\\xi_{\\max}$ are determined from $C_i(\\xi) \\ge 0$.\n- Evaluate $r_f$, $r_r$, and the normalized residual $\\varepsilon$.\n- Your program must be a complete, runnable script. Do not read input; embed the test suite numerics internally.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example: $[r_1,r_2,r_3]$, where each $r_j$ is the computed $\\varepsilon$ for case $j$ as a floating-point number with default Python formatting. The residuals are dimensionless and require no physical unit conversion.",
            "solution": "The goal is to test detailed balance by evaluating the difference $r_f - r_r$ at a composition that enforces the thermodynamic equilibrium constant $K_c(T)$ for each reaction. The reasoning proceeds from first principles.\n\nStart from the Ideal Gas Law (IGL) and the Law of Mass Action. For a single reaction $\\sum_i \\nu_{i,f} X_i \\rightleftharpoons \\sum_i \\nu_{i,r} X_i$, define the signed stoichiometric coefficients $s_i = \\nu_{i,r} - \\nu_{i,f}$. If the reaction proceeds by an extent $\\xi$ starting from initial concentrations $C_{i,0}$, the instantaneous concentrations are $C_i(\\xi) = C_{i,0} + s_i \\xi$. The concentration-based equilibrium constant for the reaction, assuming ideal gas behavior, is\n$$\nK_c(T) \\;=\\; \\frac{K_p(T)}{(R T)^{\\Delta \\nu}}, \\quad \\Delta \\nu \\;=\\; \\sum_i \\nu_{i,r} - \\sum_i \\nu_{i,f}, \\quad K_p(T) \\;=\\; \\exp\\!\\left(-\\frac{\\Delta G^\\circ_r(T)}{R T}\\right).\n$$\nThis relationship follows from the definition $K_p = \\prod_i p_i^{\\nu_{i,r}} / \\prod_i p_i^{\\nu_{i,f}}$ and the Ideal Gas Law $p_i = C_i R T$, which yields $K_p = K_c (R T)^{\\Delta \\nu}$.\n\nThermodynamic consistency and microscopic reversibility imply that at equilibrium $r_f = r_r$, provided that the reverse rate coefficient satisfies $k_r = k_f / K_c(T)$ and the composition enforces $K_c(T)$. To construct a numerical test, we enforce the equilibrium composition through a scalar equation in $\\xi$:\n$$\n\\Phi(\\xi) \\;\\equiv\\; \\frac{\\prod_i C_i(\\xi)^{\\nu_{i,r}}}{\\prod_i C_i(\\xi)^{\\nu_{i,f}}} \\;-\\; K_c(T) \\;=\\; 0.\n$$\nWe solve for $\\xi$ on the admissible interval determined by $C_i(\\xi) \\ge 0$. Specifically, if $s_i < 0$, then $\\xi \\le C_{i,0}/(-s_i)$; if $s_i > 0$, then $\\xi \\ge -C_{i,0}/s_i$. In the typical forward progression for reactions initialized with only reactants, we constrain $\\xi \\in [0, \\min_{i: s_i < 0} C_{i,0}/(-s_i)]$.\n\nOnce $\\xi$ is found, we compute concentrations $C_i(\\xi)$ and then the forward and reverse rates using the Law of Mass Action:\n$$\nr_f \\;=\\; k_f(T)\\, \\prod_i C_i(\\xi)^{\\nu_{i,f}}, \\qquad k_f(T) \\;=\\; A T^n \\exp\\!\\left(-\\frac{E_a}{R T}\\right),\n$$\n$$\nr_r \\;=\\; k_r(T)\\, \\prod_i C_i(\\xi)^{\\nu_{i,r}}, \\qquad k_r(T) \\;=\\; \\frac{k_f(T)}{K_c(T)} \\quad \\text{(consistent)}.\n$$\nTo demonstrate violations, we set $k_r(T) = \\alpha\\, k_f(T)/K_c(T)$ for some $\\alpha \\ne 1$, thus breaking detailed balance. We then compute the normalized residual\n$$\n\\varepsilon \\;=\\; \\frac{r_f - r_r}{\\lvert r_f \\rvert + \\lvert r_r \\rvert + \\varepsilon_0},\n$$\nwith $\\varepsilon_0 = 10^{-300}$ to avoid division by zero. For a consistent mechanism, the numerator tends to $0$ at equilibrium (up to numerical round-off), yielding $\\varepsilon \\approx 0$. For inconsistent reverse rates, $\\varepsilon$ will be non-zero, scaled by the magnitude of the violation $\\alpha - 1$ and the equilibrium rates.\n\nApply this to the three test cases:\n\nCase $1$: $A + B \\rightleftharpoons C$ at $T = 1000\\,\\mathrm{K}$, $\\Delta G^\\circ_r = -20000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$. Compute $K_p = \\exp\\!\\left(20000/(8.314462618 \\cdot 1000)\\right)$, then $\\Delta \\nu = -1$ and $K_c = K_p / (R T)^{-1} = K_p \\cdot R T$. The equilibrium constraint reduces to\n$$\n\\frac{C_C}{C_A C_B} \\;=\\; K_c, \\quad C_A = 1 - \\xi, \\; C_B = 1 - \\xi, \\; C_C = \\xi,\n$$\nwhich yields $\\xi$ from $\\xi = K_c (1 - \\xi)^2$. The program solves this via robust root finding. With $k_r = k_f/K_c$, the residual $\\varepsilon$ should be near $0$.\n\nCase $2$: $C \\rightleftharpoons A + B$ at $T = 1200\\,\\mathrm{K}$, $\\Delta G^\\circ_r = +15000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$. Compute $K_p = \\exp\\!\\left(-15000/(8.314462618 \\cdot 1200)\\right)$, then $\\Delta \\nu = +1$ and $K_c = K_p / (R T)^{+1}$. The equilibrium constraint reduces to\n$$\n\\frac{C_A C_B}{C_C} \\;=\\; K_c, \\quad C_C = 1 - \\xi, \\; C_A = \\xi, \\; C_B = \\xi,\n$$\nwhich gives $\\xi^2/(1 - \\xi) = K_c$. With $k_r = \\alpha\\, k_f/K_c$ and $\\alpha = 2.0$, detailed balance is violated and $\\varepsilon$ will be non-zero.\n\nCase $3$: $A + B \\rightleftharpoons D + E$ at $T = 800\\,\\mathrm{K}$, $\\Delta G^\\circ_r = -5000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $\\Delta \\nu = 0$ so $K_c = K_p$. The constraint is\n$$\n\\frac{C_D C_E}{C_A C_B} \\;=\\; K_c, \\quad C_A = 0.5 - \\xi, \\; C_B = 0.5 - \\xi, \\; C_D = \\xi, \\; C_E = \\xi,\n$$\nleading to $\\xi^2/(0.5 - \\xi)^2 = K_c$. Because $k_r = k_f/K_c$, the residual should again be near $0$. This case also acts as a boundary with $\\Delta \\nu = 0$, removing the $(R T)^{\\Delta \\nu}$ factor.\n\nNumerical considerations:\n- Root finding is carried out on the interval constrained by $C_i(\\xi) \\ge 0$.\n- The function is solved in terms of logarithms if necessary to improve robustness, but direct ratio evaluation suffices in these cases.\n- Residual normalization avoids unit dependencies and highlights violations independently of absolute rate magnitudes.\n\nThe final program implements these steps for the specified test suite and prints a single line in the required format $[r_1,r_2,r_3]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\nR = 8.314462618  # J/(mol*K)\n\ndef arrhenius_k(A, n, Ea, T):\n    \"\"\"Compute Arrhenius rate coefficient k_f(T) = A * T^n * exp(-Ea/(R*T)).\"\"\"\n    return A * (T ** n) * np.exp(-Ea / (R * T))\n\ndef Kp_from_deltaG(deltaG, T):\n    \"\"\"Compute pressure-based equilibrium constant Kp(T) = exp(-ΔG/(R*T)).\"\"\"\n    return np.exp(-deltaG / (R * T))\n\ndef Kc_from_Kp(Kp, T, delta_nu):\n    \"\"\"Compute concentration-based equilibrium constant Kc from Kp.\"\"\"\n    # Kp = Kc * (R T)^{Δν} / (p_std)^{Δν} is the definition for dimensionless Kp.\n    # When rate laws use concentrations, p_std is not used.\n    # The relation is Kp = Kc * (RT)^{Δν} where Kp uses partial pressures\n    # and Kc uses concentrations. Here units are tricky. The problem implies SI\n    # units throughout. The relation derived in the problem text is\n    # Kp = Kc * (RT/p_std)^{Δν} where p_std is 1 bar, and Kp is dimensionless.\n    # This implies Kc = Kp / (RT/p_std)^{Δν} = Kp * (p_std/RT)^{Δν}.\n    # However, the problem text in p3 is Kp = Kc * (RT)^{Δν}.\n    # Let's stick to the problem statement for p3: Kc = Kp / (RT)^{Δν}\n    return Kp / ((R * T) ** delta_nu)\n\ndef equilibrium_extent(Kc, C0, nu_f, nu_r):\n    \"\"\"\n    Solve for reaction extent xi such that\n    prod(C_i(xi)^{nu_r_i}) / prod(C_i(xi)^{nu_f_i}) = Kc\n    subject to concentrations C_i(xi) = C0_i + s_i * xi >= 0.\n    \"\"\"\n    s = np.array(nu_r) - np.array(nu_f)\n    C0 = np.array(C0, dtype=float)\n    nu_f = np.array(nu_f, dtype=float)\n    nu_r = np.array(nu_r, dtype=float)\n\n    # Determine admissible interval for xi: ensure C_i(xi) >= 0 for all i\n    # Lower bound: max over s_i > 0 of (-C0_i / s_i), generally 0 for our setups.\n    xi_lower_candidates = []\n    for Ci0, si in zip(C0, s):\n        if si > 0:\n            xi_lower_candidates.append(-Ci0 / si)\n    xi_lower = max([0.0] + xi_lower_candidates)  # prefer forward extent >= 0\n\n    # Upper bound: min over s_i  0 of (C0_i / -s_i)\n    xi_upper_candidates = []\n    for Ci0, si in zip(C0, s):\n        if si  0:\n            xi_upper_candidates.append(Ci0 / (-si))\n    xi_upper = min(xi_upper_candidates) if xi_upper_candidates else 1e6  # large if no consumption\n\n    # Define the equilibrium function f(xi) = ratio - Kc\n    def f(xi):\n        Ci = C0 + s * xi\n        # If any concentration is non-positive, penalize\n        if np.any(Ci = 0):\n            return np.nan\n        numerator = 1.0\n        denominator = 1.0\n        # Compute product avoiding overflow via logs if needed; here direct is fine\n        for Cij, nu_ij in zip(Ci, nu_r):\n            if nu_ij != 0:\n                numerator *= Cij ** nu_ij\n        for Cij, nu_ij in zip(Ci, nu_f):\n            if nu_ij != 0:\n                denominator *= Cij ** nu_ij\n        return (numerator / denominator) - Kc\n\n    # Evaluate at bounds\n    # Slightly shrink interval to avoid exact zero concentrations\n    eps = 1e-15\n    a = xi_lower + eps\n    b = xi_upper - eps if np.isfinite(xi_upper) else xi_lower + 1.0\n    # Ensure a = b\n    if b = a:\n        # Degenerate interval; return boundary\n        return max(xi_lower, min(xi_upper, xi_lower))\n\n    fa = f(a)\n    fb = f(b)\n\n    # If either bound hits NaN due to concentrations, adjust inward\n    # Attempt a few times to find valid evaluations\n    attempts = 0\n    while (np.isnan(fa) or np.isnan(fb)) and attempts  20:\n        a += eps * 10**attempts\n        b -= eps * 10**attempts\n        if b = a: break\n        fa = f(a)\n        fb = f(b)\n        attempts += 1\n    \n    # If function values have different signs, use brentq\n    if not (np.isnan(fa) or np.isnan(fb)) and fa * fb = 0:\n        try:\n            xi = brentq(f, a, b, maxiter=100, xtol=1e-12, rtol=1e-12)\n            return xi\n        except (ValueError, RuntimeError):\n            # Fall back to midpoint if root finding fails\n            return 0.5 * (a + b)\n\n    # If no sign change, pick the point where |f| is smaller\n    if np.isnan(fa) and not np.isnan(fb): return b\n    if np.isnan(fb) and not np.isnan(fa): return a\n    if np.isnan(fa) and np.isnan(fb): return xi_lower\n    return a if abs(fa)  abs(fb) else b\n\ndef compute_rates_and_residual(T, deltaG, nu_f, nu_r, C0, A, n, Ea, alpha=1.0):\n    \"\"\"\n    Compute k_f, k_r, equilibrium composition, rates and normalized residual epsilon.\n    alpha scales k_r to demonstrate violations: k_r = alpha * k_f / Kc.\n    \"\"\"\n    # Equilibrium constants\n    Kp = Kp_from_deltaG(deltaG, T)\n    delta_nu = float(np.sum(nu_r) - np.sum(nu_f))\n    Kc = Kc_from_Kp(Kp, T, delta_nu)\n\n    # Equilibrium extent and composition\n    xi = equilibrium_extent(Kc, C0, nu_f, nu_r)\n    s = np.array(nu_r) - np.array(nu_f)\n    Ci = np.array(C0, dtype=float) + s * xi\n\n    # Forward and reverse rate coefficients\n    kf = arrhenius_k(A, n, Ea, T)\n    kr = alpha * kf / Kc\n\n    # Compute rates\n    rf = kf\n    rr = kr\n    # Multiply by the appropriate concentration products\n    for Cij, nu_ij in zip(Ci, nu_f):\n        if nu_ij != 0:\n            rf *= Cij ** nu_ij\n    for Cij, nu_ij in zip(Ci, nu_r):\n        if nu_ij != 0:\n            rr *= Cij ** nu_ij\n\n    # Normalized residual\n    tiny = 1e-300\n    eps = (rf - rr) / (abs(rf) + abs(rr) + tiny)\n    return eps\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T, deltaG, nu_f, nu_r, C0_list, A, n, Ea, alpha)\n    test_cases = [\n        # Case 1: A + B => C, consistent\n        (1000.0, -20000.0,\n         [1, 1, 0],  # nu_f for A, B, C\n         [0, 0, 1],  # nu_r for A, B, C\n         [1.0, 1.0, 0.0],  # initial concentrations\n         1.0e6, 0.0, 60000.0, 1.0),\n        # Case 2: C => A + B, inconsistent with alpha=2.0\n        (1200.0, +15000.0,\n         [0, 0, 1],  # nu_f for A, B, C\n         [1, 1, 0],  # nu_r for A, B, C\n         [0.0, 0.0, 1.0],  # initial concentrations\n         1.0e3, 0.0, 80000.0, 2.0),\n        # Case 3: A + B => D + E, consistent, delta_nu = 0\n        (800.0, -5000.0,\n         [1, 1, 0, 0],  # nu_f for A, B, D, E\n         [0, 0, 1, 1],  # nu_r for A, B, D, E\n         [0.5, 0.5, 0.0, 0.0],  # initial concentrations\n         2.0e5, 0.0, 50000.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, deltaG, nu_f, nu_r, C0, A, n, Ea, alpha = case\n        eps = compute_rates_and_residual(T, deltaG, nu_f, nu_r, C0, A, n, Ea, alpha)\n        results.append(eps)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}