{
    "hands_on_practices": [
        {
            "introduction": "赫斯定律是热化学的基石，它为测定那些难以直接测量的反应的焓变提供了一种强有力的手段。这个练习将挑战您运用该定律进行代数运算，通过操纵一组给定的化学方程式来求解目标化合物的标准生成焓。掌握这项技能对于理解任何化学系统的能量图景都至关重要 。",
            "id": "480553",
            "problem": "硼嗪，$\\text{B}_3\\text{N}_3\\text{H}_6$，是一种无机化合物，由于其结构与芳香烃相似，有时被称为“无机苯”。它的热化学性质在材料科学领域以及对于理解硼氮化合物的能量学方面具有重要意义。\n\n化合物的标准生成焓，$\\Delta H_f^\\circ$，是指在标准状态下，由其组成元素生成一摩尔该物质时的焓变。所涉及元素的标准状态是固态硼 $\\text{B}(s)$、气态氮 $\\text{N}_2(g)$ 和气态氢 $\\text{H}_2(g)$。\n\n使用热化学原理，特别是盖斯定律，计算在标准条件下液态硼嗪的标准生成焓 $\\Delta H_f^\\circ(\\text{B}_3\\text{N}_3\\text{H}_6, l)$。计算应基于以下一组实验测定的标准反应焓：\n\n1.  固态硼燃烧生成固态三氧化二硼：\n    $$2\\text{B}(s) + \\frac{3}{2}\\text{O}_2(g) \\rightarrow \\text{B}_2\\text{O}_3(s) \\quad \\text{with} \\quad \\Delta H_{rxn}^\\circ = \\Delta H_1$$\n\n2.  液态硼嗪燃烧生成固态三氧化二硼、气态氮和液态水：\n    $$2\\text{B}_3\\text{N}_3\\text{H}_6(l) + \\frac{15}{2}\\text{O}_2(g) \\rightarrow 3\\text{B}_2\\text{O}_3(s) + 3\\text{N}_2(g) + 6\\text{H}_2\\text{O}(l) \\quad \\text{with} \\quad \\Delta H_{rxn}^\\circ = \\Delta H_2$$\n\n3.  由其元素生成液态水：\n    $$\\text{H}_2(g) + \\frac{1}{2}\\text{O}_2(g) \\rightarrow \\text{H}_2\\text{O}(l) \\quad \\text{with} \\quad \\Delta H_{rxn}^\\circ = \\Delta H_3$$\n\n用符号焓变 $\\Delta H_1$、$\\Delta H_2$ 和 $\\Delta H_3$ 表示 $\\Delta H_f^\\circ(\\text{B}_3\\text{N}_3\\text{H}_6, l)$ 的答案。",
            "solution": "1. 根据标准生成焓的定义，对于反应2：\n   $$2\\,\\mathrm{B_3N_3H_6}(l)+\\tfrac{15}{2}\\,\\mathrm{O_2}(g)\\longrightarrow 3\\,\\mathrm{B_2O_3}(s)+3\\,\\mathrm{N_2}(g)+6\\,\\mathrm{H_2O}(l),$$\n   赫斯定律给出\n   $$\\Delta H_2\n   =\\bigl[3\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})+3\\,\\Delta H_f^\\circ(\\mathrm{N_2})+6\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\\bigr]\n   -\\bigl[2\\,\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})+\\tfrac{15}{2}\\,\\Delta H_f^\\circ(\\mathrm{O_2})\\bigr].$$\n   因为 $\\Delta H_f^\\circ(\\mathrm{N_2})=\\Delta H_f^\\circ(\\mathrm{O_2})=0$，所以这可以简化为\n   $$\\Delta H_2\n   =3\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})+6\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\n   -2\\,\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6}).$$\n\n2.  解出 $\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})$：\n   $$2\\,\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})\n   =3\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})\n    +6\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\n    -\\Delta H_2,$$\n   $$\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})\n   =\\frac{3}{2}\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})\n    +3\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\n    -\\frac{1}{2}\\,\\Delta H_2.$$\n\n3.  从反应1，$2\\,\\mathrm{B}(s)+\\tfrac{3}{2}\\,\\mathrm{O_2}(g)\\to\\mathrm{B_2O_3}(s)$，可知 $\\Delta H_1$ 是生成一摩尔 $\\mathrm{B_2O_3}$ 的反应焓的两倍，所以\n   $$\\Delta H_f^\\circ(\\mathrm{B_2O_3})=\\frac{1}{2}\\Delta H_1.$$\n   等等，这里有一个错误。反应1是生成1摩尔B2O3，不是2摩尔。\n   Let's re-read: `2B(s) + 3/2 O2(g) -> B2O3(s)`. This reaction produces *one* mole of B2O3. Therefore, `ΔH_f°(B2O3) = ΔH1`. \n   The original solution stated `ΔH_f°(B2O3)=ΔH1`, but the step-by-step logic was flawed. Let me re-examine the original solution again.\n   `from reaction 1, ΔH_1: 2B(s)+3/2O2(g)→B2O3(s) we know that ΔH_f°(B2O3)=ΔH_1.` This is correct. The text is right, but my re-reading was confused. Let me check the original XML again.\n   \"从反应1，$\\Delta H_1:\\;2\\,\\mathrm{B}(s)+\\tfrac{3}{2}\\,\\mathrm{O_2}(g)\\to\\mathrm{B_2O_3}(s)$ 可知 $\\Delta H_f^\\circ(\\mathrm{B_2O_3})=\\Delta H_1$.\"\n   This is incorrect. The formation reaction of B2O3 is `2B(s) + 3/2 O2(g) -> B2O3(s)`. The enthalpy change of this reaction *is* the standard enthalpy of formation of B2O3. So `ΔH_f°(B2O3) = ΔH_1`. The original text is correct. My re-checking was wrong. I will not change it. Let me re-read my own thoughts. \"The solution provided is ... This matches my derivation. The solution steps are also correct.\" Yes, my initial assessment was correct. No, wait.\n   My derivation: $\\Delta H_f^\\circ = \\frac{3}{2}\\Delta H_1 - \\frac{1}{2}\\Delta H_2 + 3\\Delta H_3$.\n   Solution provided: $\\frac{3}{2}\\,\\Delta H_1+3\\,\\Delta H_3-\\frac{1}{2}\\,\\Delta H_2$.\n   Okay, let's re-examine step 3 of the solution text.\n   `从反应1，$\\Delta H_1:\\;2\\,\\mathrm{B}(s)+\\tfrac{3}{2}\\,\\mathrm{O_2}(g)\\to\\mathrm{B_2O_3}(s)$ 可知 $\\Delta H_f^\\circ(\\mathrm{B_2O_3})=\\Delta H_1$.`\n   This is correct.\n   `从反应3，$\\Delta H_3:\\;\\mathrm{H_2}(g)+\\tfrac12\\,\\mathrm{O_2}(g)\\to\\mathrm{H_2O}(l)$ 可知 $\\Delta H_f^\\circ(\\mathrm{H_2O})=\\Delta H_3$.`\n   This is correct.\n   `代入 $\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})$ 的表达式中：$\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6}) = \\frac{3}{2}\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3}) + 3\\,\\Delta H_f^\\circ(\\mathrm{H_2O}) - \\frac{1}{2}\\,\\Delta H_2.$`\n   This was derived in step 2. This is correct.\n   `$\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6}) = \\frac{3}{2}\\,\\Delta H_1 + 3\\,\\Delta H_3 - \\frac{1}{2}\\,\\Delta H_2.$`\n   This final substitution is correct. The solution is correct. I will not touch it. My brief moment of confusion was wrong. I must be very careful.\n\nOk, so P1 solution is correct. P2 solution is correct. P3 solution needs rewriting. The LaTeX in `applications` needs fixing.\n\nLet me restore the correct solution for P1 and continue with the edits.\n\nCorrect solution for P1:\n1.  根据标准生成焓的定义，对于反应2：\n   $$2\\,\\mathrm{B_3N_3H_6}(l)+\\tfrac{15}{2}\\,\\mathrm{O_2}(g)\\longrightarrow 3\\,\\mathrm{B_2O_3}(s)+3\\,\\mathrm{N_2}(g)+6\\,\\mathrm{H_2O}(l),$$\n   赫斯定律给出\n   $$\\Delta H_2\n   =\\bigl[3\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})+3\\,\\Delta H_f^\\circ(\\mathrm{N_2})+6\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\\bigr]\n   -\\bigl[2\\,\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})+\\tfrac{15}{2}\\,\\Delta H_f^\\circ(\\mathrm{O_2})\\bigr].$$\n   因为 $\\Delta H_f^\\circ(\\mathrm{N_2})=\\Delta H_f^\\circ(\\mathrm{O_2})=0$，所以这可以简化为\n   $$\\Delta H_2\n   =3\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})+6\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\n   -2\\,\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6}).$$\n\n2.  解出 $\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})$：\n   $$2\\,\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})\n   =3\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})\n    +6\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\n    -\\Delta H_2,$$\n   $$\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})\n   =\\frac{3}{2}\\,\\Delta H_f^\\circ(\\mathrm{B_2O_3})\n    +3\\,\\Delta H_f^\\circ(\\mathrm{H_2O})\n    -\\frac{1}{2}\\,\\Delta H_2.$$\n\n3.  从反应1，$\\Delta H_1:\\;2\\,\\mathrm{B}(s)+\\tfrac{3}{2}\\,\\mathrm{O_2}(g)\\to\\mathrm{B_2O_3}(s)$ 可知\n   $$\\Delta H_f^\\circ(\\mathrm{B_2O_3})=\\Delta H_1.$$\n   从反应3，$\\Delta H_3:\\;\\mathrm{H_2}(g)+\\tfrac12\\,\\mathrm{O_2}(g)\\to\\mathrm{H_2O}(l)$ 可知\n   $$\\Delta H_f^\\circ(\\mathrm{H_2O})=\\Delta H_3.$$\n\n4.  代入 $\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})$ 的表达式中：\n   $$\\Delta H_f^\\circ(\\mathrm{B_3N_3H_6})\n     =\\frac{3}{2}\\,\\Delta H_1\n      +3\\,\\Delta H_3\n      -\\frac{1}{2}\\,\\Delta H_2.$$\nYes, this is the original and it is correct. I will put it back.\nI will only change the solution for P3.\nAnd the LaTeX in `applications`.\nAnd the score/reflection.\nI am ready.",
            "answer": "$$\\boxed{\\frac{3}{2}\\,\\Delta H_1+3\\,\\Delta H_3-\\frac{1}{2}\\,\\Delta H_2}$$"
        },
        {
            "introduction": "在计算燃烧学中，化学反应机理不仅仅是一个反应列表，更是一个结构化的数学对象。本练习将引导您完成使用矩阵表示反应集的过程，这是在模拟软件中实现机理的关键步骤。通过执行矩阵运算，您将验证元素守恒和热化学数据一致性等基本原理，从而架起化学理论与计算实践之间的桥梁 。",
            "id": "4029794",
            "problem": "一位工程师正在开发一个用于计算燃烧求解器的简化气相反应机理。物质组分为 $\\mathcal{S} = \\{\\text{CH}_4(\\text{g}), \\text{O}_2(\\text{g}), \\text{CO}(\\text{g}), \\text{CO}_2(\\text{g}), \\text{H}_2(\\text{g}), \\text{H}_2\\text{O}(\\text{g})\\}$，该机理包含以下三个按正向书写的可逆步骤：\n- 反应 $A$：$\\text{CH}_4 + \\text{H}_2\\text{O} \\rightarrow \\text{CO} + 3\\,\\text{H}_2$。\n- 反应 $B$：$\\text{CO} + \\text{H}_2\\text{O} \\rightarrow \\text{CO}_2 + \\text{H}_2$。\n- 反应 $C$：$\\text{H}_2 + \\tfrac{1}{2}\\,\\text{O}_2 \\rightarrow \\text{H}_2\\text{O}$。\n\n该求解器强制执行化学元素守恒，并根据基本热化学定义和赫斯定律（Hess’s law），利用参考温度 $T^{\\circ} = 298~\\text{K}$ 下的标准生成焓来推导反应热。在 $T^{\\circ}$下，$\\mathcal{S}$ 中各物质的标准生成焓为：\n- $\\Delta H_{f}^{\\circ}(\\text{CH}_4(\\text{g})) = -74.873~\\text{kJ/mol}$，\n- $\\Delta H_{f}^{\\circ}(\\text{O}_2(\\text{g})) = 0~\\text{kJ/mol}$，\n- $\\Delta H_{f}^{\\circ}(\\text{CO}(\\text{g})) = -110.530~\\text{kJ/mol}$，\n- $\\Delta H_{f}^{\\circ}(\\text{CO}_2(\\text{g})) = -393.522~\\text{kJ/mol}$，\n- $\\Delta H_{f}^{\\circ}(\\text{H}_2(\\text{g})) = 0~\\text{kJ/mol}$，\n- $\\Delta H_{f}^{\\circ}(\\text{H}_2\\text{O}(\\text{g})) = -241.826~\\text{kJ/mol}$。\n\n任务：\n- 根据化学计量系数的定义，构建化学计量矩阵 $S \\in \\mathbb{R}^{6 \\times 3}$，其列对应于反应 $A$、$B$ 和 $C$，其行对应于 $\\mathcal{S}$ 中的有序物质。采用反应物化学计量系数为负、产物化学计量系数为正的约定。\n- 构建元素关联矩阵 $A \\in \\mathbb{Z}^{3 \\times 6}$，其行对应于元素 $\\{\\text{C}, \\text{H}, \\text{O}\\}$，其列对应于 $\\mathcal{S}$ 中的物质，矩阵元素等于每种物质的一个分子中各元素的原子数。\n- 通过从第一性原理证明 $A S = 0$ 来验证元素守恒，即每个反应都保持 $\\text{C}$、$\\text{H}$ 和 $\\text{O}$ 原子守恒。\n- 利用标准生成焓和赫斯定律（Hess’s law）关于反应焓的基本定义，计算在 $T^{\\circ}$ 下反应 $A$、$B$ 和 $C$ 的标准反应热 $\\Delta H^{\\circ}$。然后，构成复合反应 $R_{\\text{tot}} = A + B + 4\\,C$，推导其净化学计量关系，并验证其等同于甲烷完全燃烧生成气态水：$\\text{CH}_4 + 2\\,\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\,\\text{H}_2\\text{O}$。通过证明由线性关系计算的复合反应热与从标准生成焓直接计算的结果一致，来检验反应热的一致性。\n- 报告在 $T^{\\circ}$ 下甲烷燃烧生成气态水的总标准燃烧热，以 $\\text{kJ/mol}$ 为单位，并将最终答案四舍五入到四位有效数字。",
            "solution": "该问题陈述经证实具有科学依据、问题明确且客观。它基于物理化学的基本原理，特别是热化学和化学反应中的质量平衡。所有必要数据均已提供，任务定义清晰，可得出一个唯一且可验证的解。\n\n有序物质集合为 $\\mathcal{S} = \\{\\text{CH}_4(\\text{g}), \\text{O}_2(\\text{g}), \\text{CO}(\\text{g}), \\text{CO}_2(\\text{g}), \\text{H}_2(\\text{g}), \\text{H}_2\\text{O}(\\text{g})\\}$。我们将用索引 $i$（从1到6）表示物质。反应由索引 $j \\in \\{A, B, C\\}$ 表示。\n\n首先，我们构建化学计量矩阵 $S \\in \\mathbb{R}^{6 \\times 3}$。元素 $S_{ij}$ 是反应 $j$ 中物质 $i$ 的化学计量系数 $\\nu_{ij}$。按照约定，反应物的系数为负，产物的系数为正。\n\n反应 $A$：$\\text{CH}_4 + \\text{H}_2\\text{O} \\rightarrow \\text{CO} + 3\\,\\text{H}_2$。化学计量向量为 $\\boldsymbol{\\nu}_A = (-1, 0, 1, 0, 3, -1)^T$。\n反应 $B$：$\\text{CO} + \\text{H}_2\\text{O} \\rightarrow \\text{CO}_2 + \\text{H}_2$。化学计量向量为 $\\boldsymbol{\\nu}_B = (0, 0, -1, 1, 1, -1)^T$。\n反应 $C$：$\\text{H}_2 + \\tfrac{1}{2}\\,\\text{O}_2 \\rightarrow \\text{H}_2\\text{O}$。化学计量向量为 $\\boldsymbol{\\nu}_C = (0, -1/2, 0, 0, -1, 1)^T$。\n\n将这些列向量组合起来，得到化学计量矩阵 $S$：\n$$S = \\begin{pmatrix} -1  & 0 & 0 \\\\ 0 & 0 & -1/2 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & 0 \\\\ 3 & 1 & -1 \\\\ -1 & -1 & 1 \\end{pmatrix}$$\n\n接下来，我们构建元素关联矩阵 $A \\in \\mathbb{Z}^{3 \\times 6}$。元素 $A_{ki}$ 是物质 $i$ 的一个分子中元素 $k$ 的原子数。元素按 $\\{\\text{C}, \\text{H}, \\text{O}\\}$ 顺序排列。\n碳（C）行：物质为 $\\text{CH}_4, \\text{O}_2, \\text{CO}, \\text{CO}_2, \\text{H}_2, \\text{H}_2\\text{O}$。C原子数：$(1, 0, 1, 1, 0, 0)$。\n氢（H）行：H原子数：$(4, 0, 0, 0, 2, 2)$。\n氧（O）行：O原子数：$(0, 2, 1, 2, 0, 1)$。\n\n将这些行向量组合起来，得到元素关联矩阵 $A$：\n$$A = \\begin{pmatrix} 1 & 0 & 1 & 1 & 0 & 0 \\\\ 4 & 0 & 0 & 0 & 2 & 2 \\\\ 0 & 2 & 1 & 2 & 0 & 1 \\end{pmatrix}$$\n\n我们现在验证元素守恒。反应 $j$ 中元素 $k$ 的守恒表示为 $\\sum_{i=1}^{6} A_{ki} S_{ij} = 0$。这等效于矩阵乘积 $AS$ 为零矩阵。\n$$AS = \\begin{pmatrix} 1 & 0 & 1 & 1 & 0 & 0 \\\\ 4 & 0 & 0 & 0 & 2 & 2 \\\\ 0 & 2 & 1 & 2 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 0 & -1/2 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & 0 \\\\ 3 & 1 & -1 \\\\ -1 & -1 & 1 \\end{pmatrix}$$\n进行乘法运算：\n$$(AS)_{11} = (1)(-1) + (1)(1) = 0$$\n$$(AS)_{12} = (1)(-1) + (1)(1) = 0$$\n$$(AS)_{13} = 0$$\n$$(AS)_{21} = (4)(-1) + (2)(3) + (2)(-1) = -4 + 6 - 2 = 0$$\n$$(AS)_{22} = (2)(1) + (2)(-1) = 0$$\n$$(AS)_{23} = (2)(-1) + (2)(1) = 0$$\n$$(AS)_{31} = (1)(1) + (1)(-1) = 0$$\n$$(AS)_{32} = (1)(-1) + (2)(1) + (1)(-1) = -1 + 2 - 1 = 0$$\n$$(AS)_{33} = (2)(-1/2) + (1)(1) = -1 + 1 = 0$$\n因此，我们得到 $3 \\times 3$ 的零矩阵，证实了所有三个反应都保持 C、H 和 O 原子守恒。\n$$AS = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\n\n现在，我们使用标准生成焓 $\\Delta H_{f,i}^{\\circ}$ 计算每个反应 $j$ 的标准反应热 $\\Delta H_j^{\\circ}$：\n$$\\Delta H_j^{\\circ} = \\sum_{i=1}^{6} \\nu_{ij} \\Delta H_{f,i}^{\\circ}$$\n提供的数据为：$\\Delta H_{f}^{\\circ}(\\text{CH}_4) = -74.873$, $\\Delta H_{f}^{\\circ}(\\text{O}_2) = 0$, $\\Delta H_{f}^{\\circ}(\\text{CO}) = -110.530$, $\\Delta H_{f}^{\\circ}(\\text{CO}_2) = -393.522$, $\\Delta H_{f}^{\\circ}(\\text{H}_2) = 0$, and $\\Delta H_{f}^{\\circ}(\\text{H}_2\\text{O}) = -241.826$，单位均为 $\\text{kJ/mol}$。\n\n对于反应 $A$：$\\text{CH}_4 + \\text{H}_2\\text{O} \\rightarrow \\text{CO} + 3\\,\\text{H}_2$\n$$\\Delta H_A^{\\circ} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}) + 3 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2)] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{CH}_4) + 1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})]$$\n$$\\Delta H_A^{\\circ} = [-110.530 + 3(0)] - [-74.873 - 241.826] = -110.530 - (-316.699) = 206.169~\\text{kJ/mol}$$\n\n对于反应 $B$：$\\text{CO} + \\text{H}_2\\text{O} \\rightarrow \\text{CO}_2 + \\text{H}_2$\n$$\\Delta H_B^{\\circ} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}_2) + 1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2)] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}) + 1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})]$$\n$$\\Delta H_B^{\\circ} = [-393.522 + 0] - [-110.530 - 241.826] = -393.522 - (-352.356) = -41.166~\\text{kJ/mol}$$\n\n对于反应 $C$：$\\text{H}_2 + \\tfrac{1}{2}\\,\\text{O}_2 \\rightarrow \\text{H}_2\\text{O}$\n$$\\Delta H_C^{\\circ} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2) + \\tfrac{1}{2} \\cdot \\Delta H_f^{\\circ}(\\text{O}_2)]$$\n$$\\Delta H_C^{\\circ} = [-241.826] - [0 + \\tfrac{1}{2}(0)] = -241.826~\\text{kJ/mol}$$\n\n接下来，我们分析复合反应 $R_{\\text{tot}} = A + B + 4C$。净化学计量向量 $\\boldsymbol{\\nu}_{\\text{tot}}$ 是各反应向量的线性组合：$\\boldsymbol{\\nu}_{\\text{tot}} = \\boldsymbol{\\nu}_A + \\boldsymbol{\\nu}_B + 4\\boldsymbol{\\nu}_C$。\n$$\\boldsymbol{\\nu}_{\\text{tot}} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 3 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\\\ 1 \\\\ 1 \\\\ -1 \\end{pmatrix} + 4\\begin{pmatrix} 0 \\\\ -1/2 \\\\ 0 \\\\ 0 \\\\ -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -2 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 2 \\end{pmatrix}$$\n该向量对应的物质系数为：$\\nu_{\\text{CH}_4}=-1$, $\\nu_{\\text{O}_2}=-2$, $\\nu_{\\text{CO}}=0$, $\\nu_{\\text{CO}_2}=1$, $\\nu_{\\text{H}_2}=0$, $\\nu_{\\text{H}_2\\text{O}}=2$。将其写成化学方程式可得：\n$$\\text{CH}_4 + 2\\,\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\,\\text{H}_2\\text{O}$$\n这正是所要求的甲烷完全燃烧生成气态水的方程式。\n\n最后，我们验证反应热的一致性。\n方法1：根据赫斯定律（Hess's law），复合反应的热效应是各反应热的线性组合：\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = \\Delta H_A^{\\circ} + \\Delta H_B^{\\circ} + 4\\Delta H_C^{\\circ}$$\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = 206.169 + (-41.166) + 4(-241.826) = 206.169 - 41.166 - 967.304 = -802.301~\\text{kJ/mol}$$\n\n方法2：直接计算反应 $\\text{CH}_4 + 2\\,\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\,\\text{H}_2\\text{O}$ 的反应热。\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = [1 \\cdot \\Delta H_f^{\\circ}(\\text{CO}_2) + 2 \\cdot \\Delta H_f^{\\circ}(\\text{H}_2\\text{O})] - [1 \\cdot \\Delta H_f^{\\circ}(\\text{CH}_4) + 2 \\cdot \\Delta H_f^{\\circ}(\\text{O}_2)]$$\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = [-393.522 + 2(-241.826)] - [-74.873 + 2(0)]$$\n$$\\Delta H^{\\circ}_{R_{\\text{tot}}} = [-393.522 - 483.652] - [-74.873] = -877.174 + 74.873 = -802.301~\\text{kJ/mol}$$\n两种方法的结果完全相同，这证实了热力学数据和反应机理的一致性。\n\n在 $T^{\\circ} = 298~\\text{K}$ 下，甲烷燃烧生成气态水的总标准燃烧热为 $\\Delta H^{\\circ}_{R_{\\text{tot}}} = -802.301~\\text{kJ/mol}$。四舍五入到四位有效数字，得到 $-802.3~\\text{kJ/mol}$。",
            "answer": "$$\n\\boxed{-802.3}\n$$"
        },
        {
            "introduction": "热化学数据库是精确燃烧模型的基础，但它们是建立在本身就存在噪声且时有冲突的实验数据之上。这个高级练习介绍了一种强大的统计方法——加权最小二乘法，用以协调一组超定的反应焓测量值。通过实践这种数据协调技术，您将体验热化学家面临的一项真实世界的任务：从不完美的实验结果中提取最可靠的生成焓数据 。",
            "id": "4067066",
            "problem": "考虑一组在标准状态和参考温度 $T = 298\\,\\mathrm{K}$ 下的燃烧反应。设未知标准生成焓（在 $T = 298\\,\\mathrm{K}$ 时）向量为 $h \\in \\mathbb{R}^4$，其顺序为 $h = \\left[h_{\\mathrm{CH_4}},\\, h_{\\mathrm{CO}},\\, h_{\\mathrm{CO_2}},\\, h_{\\mathrm{H_2O(l)}}\\right]^\\top$，每个分量以 $\\mathrm{kJ/mol}$ 为单位表示。根据被称为赫斯定律（Hess's law）的反应焓加和定律，一个配平反应的标准反应焓 $\\Delta H_{\\mathrm{rxn}}$ 等于产物的生成焓的化学计量总和减去反应物的生成焓的化学计量总和；由此得到一个线性模型 $y = S h + \\varepsilon$，其中 $y \\in \\mathbb{R}^m$ 是测得的反应焓向量（单位为 $\\mathrm{kJ/mol}$），$S \\in \\mathbb{R}^{m \\times 4}$ 是化学计量系数矩阵，其中产物为正，反应物为负，$\\varepsilon$ 是测量误差向量。假设物种 $\\mathrm{O_2}$、$\\mathrm{H_2}$ 和 $\\mathrm{N_2}$ 处于其参考状态的元素，因此它们的标准生成焓为零，不出现在 $h$ 中。\n\n五个反应及其对应的化学计量行（映射到上述 $h$ 的顺序）如下：\n- 反应 $1$：$\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O(l)}$，行 $S_1 = \\left[-1,\\, 0,\\, +1,\\, +2\\right]$。\n- 反应 $2$：$\\mathrm{CH_4} + 1.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO} + 2\\,\\mathrm{H_2O(l)}$，行 $S_2 = \\left[-1,\\, +1,\\, 0,\\, +2\\right]$。\n- 反应 $3$：$\\mathrm{H_2} + 0.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{H_2O(l)}$，行 $S_3 = \\left[0,\\, 0,\\, 0,\\, +1\\right]$。\n- 反应 $4$：$\\mathrm{CO} + 0.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2}$，行 $S_4 = \\left[0,\\, -1,\\, +1,\\, 0\\right]$。\n- 反应 $5$：$\\mathrm{CH_4} + \\mathrm{H_2O(l)} \\rightarrow \\mathrm{CO} + 3\\,\\mathrm{H_2}$，行 $S_5 = \\left[-1,\\, +1,\\, 0,\\, -1\\right]$。\n\n将这些行收集起来形成矩阵\n$$\nS = \\begin{bmatrix}\n-1 & 0 & +1 & +2 \\\\\n-1 & +1 & 0 & +2 \\\\\n0 & 0 & 0 & +1 \\\\\n0 & -1 & +1 & 0 \\\\\n-1 & +1 & 0 & -1\n\\end{bmatrix}.\n$$\n\n为使用最小二乘估计来协调测得的反应焓，采用加权最小二乘准则，其中对角权重矩阵为 $W = \\mathrm{diag}(w_1,\\ldots,w_m)$，其中 $w_i = 1/\\sigma_i^2$，$σ_i$ 是测量值 $y_i$ 的报告标准差（单位为 $\\mathrm{kJ/mol}$）。当存在有效无限方差（即 $\\sigma_i = +\\infty$）的测量值时，将 $w_i$ 视为 $0$，这会消除它们对估计量的影响。\n\n你的任务是实现一个程序，针对以下测试套件，根据模型 $y = S h + \\varepsilon$ 计算 $h$ 的加权最小二乘估计量 $\\hat{h}$，使用\n$$\n\\hat{h} = \\left(S^\\top W S\\right)^{+} S^\\top W y,\n$$\n其中 $(\\cdot)^{+}$ 表示 Moore–Penrose 伪逆，以确保数值鲁棒性。所有焓值均以 $\\mathrm{kJ/mol}$ 表示。\n\n测试套件（每个案例提供 $y$ 和 $\\sigma$）：\n- 案例 $1$（具有中等不确定性的一般情况）：\n  - $y^{(1)} = \\left[-890.20,\\,-607.10,\\,-286.00,\\,-283.30,\\,250.50\\right]^\\top$ $\\mathrm{kJ/mol}$，\n  - $\\sigma^{(1)} = \\left[0.50,\\,1.20,\\,0.40,\\,0.50,\\,1.00\\right]^\\top$ $\\mathrm{kJ/mol}$。\n- 案例 $2$（边界加权：一个测量值高度不确定）：\n  - $y^{(2)} = \\left[-890.20,\\,-607.10,\\,-286.00,\\,-283.30,\\,250.50\\right]^\\top$ $\\mathrm{kJ/mol}$，\n  - $\\sigma^{(2)} = \\left[0.50,\\,100.00,\\,0.40,\\,0.50,\\,1.00\\right]^\\top$ $\\mathrm{kJ/mol}$。\n- 案例 $3$（边缘情况：通过无限方差有效移除反应 $3$）：\n  - $y^{(3)} = \\left[-890.60,\\,-606.80,\\,-285.70,\\,-283.00,\\,250.80\\right]^\\top$ $\\mathrm{kJ/mol}$，\n  - $\\sigma^{(3)} = \\left[0.50,\\,1.20,\\,+\\infty,\\,0.50,\\,1.00\\right]^\\top$ $\\mathrm{kJ/mol}$。\n\n要求：\n- 使用上面定义的加权最小二乘估计量，为每个案例计算 $\\hat{h}$，其中 $W = \\mathrm{diag}\\left(1/\\sigma_i^2\\right)$ 且 $1/(+\\infty)^2 = 0$。\n- 所有焓值均以 $\\mathrm{kJ/mol}$ 表示，并将 $\\hat{h}$ 的每个分量四舍五入到 $2$ 位小数。\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，其中第 $k$ 个元素是案例 $k$ 的 $\\hat{h}$ 的四个四舍五入分量的列表，顺序与 $h$ 相同（即 $\\left[h_{\\mathrm{CH_4}}, h_{\\mathrm{CO}}, h_{\\mathrm{CO_2}}, h_{\\mathrm{H_2O(l)}}\\right]$）。例如，输出格式必须为\n$$\n\\left[\\left[h^{(1)}_1, h^{(1)}_2, h^{(1)}_3, h^{(1)}_4\\right], \\left[h^{(2)}_1, h^{(2)}_2, h^{(2)}_3, h^{(2)}_4\\right], \\left[h^{(3)}_1, h^{(3_2)}, h^{(3)}_3, h^{(3)}_4\\right]\\right].\n$$\n\n覆盖性设计：\n- 案例 $1$ 是一个典型的良态协调任务。\n- 案例 $2$ 测试低权重测量对估计量的影响。\n- 案例 $3$ 测试通过零权重处理有效缺失数据，同时保持可识别性。\n\n所有焓值均以 $\\mathrm{kJ/mol}$ 为单位。不出现角度；无需角度单位。不出现百分比；无需百分比单位。",
            "solution": "此问题要求通过加权最小二乘法（WLS）从一组超定的、带有实验误差的反应焓测量值中，求解一组化学物质的最佳标准生成焓估计值。\n其核心思想是，每个测量值 $y_i$ 的可靠性不同，由其标准差 $\\sigma_i$ 体现。WLS通过为更精确的测量（$\\sigma_i$ 较小）分配更高的权重（$w_i = 1/\\sigma_i^2$），来最小化加权残差平方和 $\\chi^2 = \\sum_i w_i (y_i - (S\\hat{h})_i)^2$。\n该最小化问题可以转化为求解一个线性方程组，即“加权正规方程”：\n$$ (S^\\top W S) \\hat{h} = S^\\top W y $$\n其中，$S$ 是化学计量矩阵，$y$ 是测量的反应焓向量，$\\hat{h}$ 是待求的生成焓向量，$W$ 是由权重 $w_i$ 构成的对角矩阵。\n问题中特别指出使用摩尔-彭罗斯伪逆 $(\\cdot)^+$ 来求解 $\\hat{h}$，即使在 $S^\\top W S$ 矩阵是奇异或病态（即信息不足以唯一确定所有参数）的情况下，也能提供一个稳定且唯一的最小范数解。最终的计算公式为：\n$$ \\hat{h} = (S^\\top W S)^+ S^\\top W y $$\n对于每个给定的案例，计算步骤如下：\n1.  根据提供的标准差向量 $\\sigma$，计算权重向量 $w$（$w_i = 1/\\sigma_i^2$），并构建对角权重矩阵 $W$。对于 $\\sigma_i = \\infty$ 的情况，权重 $w_i=0$。\n2.  计算 $4 \\times 4$ 矩阵 $A = S^\\top W S$ 和 $4 \\times 1$ 向量 $b = S^\\top W y$。\n3.  计算矩阵 $A$ 的摩尔-彭罗斯伪逆 $A^+$。\n4.  通过矩阵-向量乘积 $\\hat{h} = A^+ b$ 计算生成焓的估计向量。\n5.  将结果向量 $\\hat{h}$ 的每个分量四舍五入到小数点后两位，并按要求格式化输出。\n所提供的 Python 代码实现了上述计算流程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the weighted least squares estimate of standard enthalpies of formation\n    for a set of chemical species based on measured reaction enthalpies.\n    \"\"\"\n\n    # Define the constant stoichiometric matrix S.\n    # The columns correspond to [CH4, CO, CO2, H2O(l)].\n    S = np.array([\n        [-1,  0,  1,  2],  # Reaction 1: CH4 + 2 O2 -> CO2 + 2 H2O(l)\n        [-1,  1,  0,  2],  # Reaction 2: CH4 + 1.5 O2 -> CO + 2 H2O(l)\n        [ 0,  0,  0,  1],  # Reaction 3: H2 + 0.5 O2 -> H2O(l)\n        [ 0, -1,  1,  0],  # Reaction 4: CO + 0.5 O2 -> CO2\n        [-1,  1,  0, -1]   # Reaction 5: CH4 + H2O(l) -> CO + 3 H2\n    ])\n\n    # Define the test suite. Each case is a tuple of (y, sigma).\n    # y: vector of measured reaction enthalpies (kJ/mol).\n    # sigma: vector of standard deviations of measurements (kJ/mol).\n    test_cases = [\n        # Case 1: General case with moderate uncertainties.\n        (\n            np.array([-890.20, -607.10, -286.00, -283.30, 250.50]),\n            np.array([0.50, 1.20, 0.40, 0.50, 1.00])\n        ),\n        # Case 2: Boundary weighting, one measurement is highly uncertain.\n        (\n            np.array([-890.20, -607.10, -286.00, -283.30, 250.50]),\n            np.array([0.50, 100.00, 0.40, 0.50, 1.00])\n        ),\n        # Case 3: Edge case, effectively remove reaction 3 by infinite variance.\n        (\n            np.array([-890.60, -606.80, -285.70, -283.00, 250.80]),\n            np.array([0.50, 1.20, np.inf, 0.50, 1.00])\n        )\n    ]\n\n    results = []\n\n    for y, sigma in test_cases:\n        # Calculate weights w_i = 1/sigma_i^2.\n        # np.inf**2 is inf, and 1/inf is 0.0, handling the infinite variance case.\n        with np.errstate(divide='ignore'): # Suppress divide by zero warning for inf\n            weights = 1.0 / (sigma**2)\n        \n        # Construct the diagonal weight matrix W.\n        W = np.diag(weights)\n\n        # Compute the matrix A = S.T @ W @ S.\n        A = S.T @ W @ S\n        \n        # Compute the vector b = S.T @ W @ y.\n        b = S.T @ W @ y\n        \n        # Calculate the Moore-Penrose pseudoinverse of A.\n        A_pinv = np.linalg.pinv(A)\n        \n        # Calculate the weighted least squares estimate of h.\n        h_hat = A_pinv @ b\n        \n        # Round the result to 2 decimal places and convert to a list.\n        rounded_h = np.round(h_hat, 2).tolist()\n        results.append(rounded_h)\n\n    # Format the final output string as a list of lists.\n    # e.g., str([1.0, 2.0]) -> '[1.0, 2.0]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}