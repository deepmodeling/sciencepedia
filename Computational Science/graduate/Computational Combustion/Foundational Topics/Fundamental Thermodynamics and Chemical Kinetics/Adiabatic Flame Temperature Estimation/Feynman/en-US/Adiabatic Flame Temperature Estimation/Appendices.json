{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of estimating the adiabatic flame temperature is the application of the First Law of Thermodynamics, which dictates that for an adiabatic process, the enthalpy of the reactants must equal the enthalpy of the products. This first exercise  provides a foundational approach by using constant average specific heats for the products. This simplification allows for a direct algebraic solution, enabling you to focus on the core energy balance principle and the essential skill of determining product composition from elemental conservation under non-stoichiometric (lean) conditions.",
            "id": "4006482",
            "problem": "Consider a perfectly stirred, steady-flow, adiabatic, constant-pressure combustor in which gaseous methane $\\mathrm{CH_4}$ at an initial temperature $T_0 = 298\\,\\mathrm{K}$ is burned with dry air. Treat all gases as ideal and neglect dissociation and radiation. Dry air is modeled as a mixture with mole fractions $0.21$ for $\\mathrm{O_2}$ and $0.79$ for $\\mathrm{N_2}$; for convenience, assume $\\mathrm{N_2}$ accompanies $\\mathrm{O_2}$ in a fixed molar ratio of $3.76\\,\\mathrm{mol\\,N_2/mol\\,O_2}$. The standard molar enthalpies of formation at $298\\,\\mathrm{K}$ are: $\\Delta h_f^\\circ(\\mathrm{CH_4(g)}) = -74.85\\,\\mathrm{kJ/mol}$, $\\Delta h_f^\\circ(\\mathrm{CO_2(g)}) = -393.52\\,\\mathrm{kJ/mol}$, $\\Delta h_f^\\circ(\\mathrm{H_2O(g)}) = -241.826\\,\\mathrm{kJ/mol}$, $\\Delta h_f^\\circ(\\mathrm{O_2(g)}) = 0$, and $\\Delta h_f^\\circ(\\mathrm{N_2(g)}) = 0$. Over the expected flame temperature range, approximate the mean molar isobaric heat capacities of the product species as constants: $c_{p,\\mathrm{CO_2}} = 50.0\\,\\mathrm{J/(mol\\cdot K)}$, $c_{p,\\mathrm{H_2O}} = 40.0\\,\\mathrm{J/(mol\\cdot K)}$, $c_{p,\\mathrm{O_2}} = 36.0\\,\\mathrm{J/(mol\\cdot K)}$, and $c_{p,\\mathrm{N_2}} = 34.0\\,\\mathrm{J/(mol\\cdot K)}$.\n\nDefine the equivalence ratio $\\phi$ as the actual fuel-to-oxidizer molar ratio divided by the stoichiometric fuel-to-oxidizer molar ratio. For one mole of methane, the stoichiometric oxidizer requirement is $2$ moles of $\\mathrm{O_2}$. For the lean case $\\phi < 1$, the oxidizer feed is $2/\\phi$ moles of $\\mathrm{O_2}$ accompanied by $(2/\\phi)\\times 3.76$ moles of $\\mathrm{N_2}$.\n\nStarting from the First Law of Thermodynamics for a steady-flow reactor and the definition of enthalpy for ideal gas mixtures, and using elemental conservation to determine the product composition when $\\phi < 1$, derive the expression that links the adiabatic flame temperature $T_{\\mathrm{ad}}$ to the reaction heat release and the sensible enthalpy rise of the products. Then, for $\\phi = 0.80$, evaluate $T_{\\mathrm{ad}}$ numerically under the stated assumptions.\n\nExpress your final temperature in $\\mathrm{K}$ and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation of an expression for the adiabatic flame temperature, $T_{\\mathrm{ad}}$, and its numerical evaluation for the lean combustion of methane. The analysis begins with the First Law of Thermodynamics for a steady-flow open system (control volume).\n\nFor a steady-flow, adiabatic, constant-pressure combustor with no shaft work ($\\dot{W}_s = 0$) and no heat transfer ($\\dot{Q} = 0$), the First Law simplifies to the conservation of enthalpy. The total enthalpy of the reactants entering the combustor must equal the total enthalpy of the products leaving it. On a molar basis, this is expressed as:\n$$\n\\sum_{\\text{reactants}} N_i \\bar{h}_i(T_R) = \\sum_{\\text{products}} N_j \\bar{h}_j(T_P)\n$$\nwhere $N_i$ and $N_j$ are the number of moles of reactant species $i$ and product species $j$ respectively, and $\\bar{h}$ is the molar enthalpy. Let $H_R$ be the total enthalpy of reactants and $H_P$ be the total enthalpy of products, so $H_R = H_P$.\n\nThe reactants are at an initial temperature $T_R = T_0 = 298\\,\\mathrm{K}$, which is the standard reference temperature. The products are at the final adiabatic flame temperature, $T_P = T_{\\mathrm{ad}}$.\n\nThe absolute molar enthalpy $\\bar{h}_i(T)$ of an ideal gas species $i$ at a temperature $T$ is the sum of its standard molar enthalpy of formation at the reference temperature $T_0$, denoted $\\Delta \\bar{h}_{f,i}^\\circ$, and its sensible enthalpy change from $T_0$ to $T$.\n$$\n\\bar{h}_i(T) = \\Delta \\bar{h}_{f,i}^\\circ + \\bar{h}_i(T) - \\bar{h}_i(T_0) = \\Delta \\bar{h}_{f,i}^\\circ + \\int_{T_0}^{T} \\bar{c}_{p,i}(T') dT'\n$$\nThe problem states to assume constant mean molar isobaric heat capacities, $\\bar{c}_{p,i}$. Thus, the sensible enthalpy term simplifies to $\\bar{c}_{p,i}(T - T_0)$.\n\nFor the reactants at $T_R = T_0$, the sensible enthalpy term is zero. Therefore, the total enthalpy of the reactants is the sum of their enthalpies of formation:\n$$\nH_R = \\sum_{\\text{reactants}} N_i \\bar{h}_i(T_0) = \\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ\n$$\n\nFor the products at $T_P = T_{\\mathrm{ad}}$, the total enthalpy is:\n$$\nH_P = \\sum_{\\text{products}} N_j \\bar{h}_j(T_{\\mathrm{ad}}) = \\sum_{\\text{products}} N_j \\left[ \\Delta \\bar{h}_{f,j}^\\circ + \\bar{c}_{p,j}(T_{\\mathrm{ad}} - T_0) \\right]\n$$\n$$\nH_P = \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ + \\left( \\sum_{\\text{products}} N_j \\bar{c}_{p,j} \\right) (T_{\\mathrm{ad}} - T_0)\n$$\n\nEquating the enthalpies of reactants and products ($H_R = H_P$):\n$$\n\\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ = \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ + \\left( \\sum_{\\text{products}} N_j \\bar{c}_{p,j} \\right) (T_{\\mathrm{ad}} - T_0)\n$$\nThis expression links the adiabatic flame temperature to the heat release and sensible enthalpy rise. The term $\\left(\\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ - \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ\\right)$ represents the heat of reaction at standard temperature $T_0$, which is released and absorbed as sensible heat by the products. Rearranging to solve for $T_{\\mathrm{ad}}$ gives the desired expression:\n$$\nT_{\\mathrm{ad}} = T_0 + \\frac{\\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ - \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ}{\\sum_{\\text{products}} N_j \\bar{c}_{p,j}}\n$$\nThis completes the first part of the problem.\n\nNext, we must determine the composition of the reactants and products for lean combustion ($\\phi < 1$) of one mole of methane ($\\mathrm{CH_4}$). The stoichiometric reaction is $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$. The stoichiometric fuel-to-oxidizer molar ratio is $1/2$. The actual fuel-to-oxidizer ratio is given by the equivalence ratio definition $\\phi = \\frac{(\\mathrm{F}/\\mathrm{A})_{\\text{actual}}}{(\\mathrm{F}/\\mathrm{A})_{\\text{stoich}}}$. Here, A refers only to $\\mathrm{O_2}$. For $1$ mole of fuel, the actual moles of $\\mathrm{O_2}$ are $(1/\\phi) \\times 2$. Thus, for the lean case per mole of fuel, the number of moles of $\\mathrm{O_2}$ supplied is $2/\\phi$, accompanied by $(2/\\phi) \\times 3.76$ moles of $\\mathrm{N_2}$.\n\nThe reaction equation is:\n$$\n\\mathrm{CH_4} + \\frac{2}{\\phi}(\\mathrm{O_2} + 3.76\\,\\mathrm{N_2}) \\rightarrow a\\,\\mathrm{CO_2} + b\\,\\mathrm{H_2O} + c\\,\\mathrm{O_2} + d\\,\\mathrm{N_2}\n$$\nPerforming an element balance to find the molar coefficients of the products ($a, b, c, d$):\n\\begin{itemize}\n    \\item Carbon (C): $1 = a \\implies a = 1$\n    \\item Hydrogen (H): $4 = 2b \\implies b = 2$\n    \\item Nitrogen (N): $2 \\times \\frac{2}{\\phi} \\times 3.76 = 2d \\implies d = \\frac{7.52}{\\phi}$\n    \\item Oxygen (O): $2 \\times \\frac{2}{\\phi} = 2a + b + 2c \\implies \\frac{4}{\\phi} = 2(1) + 2 + 2c \\implies \\frac{4}{\\phi} = 4 + 2c \\implies c = 2(\\frac{1}{\\phi} - 1)$\n\\end{itemize}\nSo, for lean combustion, the products per mole of fuel are: $1\\,\\mathrm{mol\\,CO_2}$, $2\\,\\mathrm{mol\\,H_2O}$, $2(1/\\phi - 1)\\,\\mathrm{mol\\,O_2}$, and $(7.52/\\phi)\\,\\mathrm{mol\\,N_2}$.\n\nNow, we evaluate for the specific case $\\phi = 0.80$.\nThe molar coefficients for the products are:\n\\begin{itemize}\n    \\item $N_{\\mathrm{CO_2}} = 1$\n    \\item $N_{\\mathrm{H_2O}} = 2$\n    \\item $N_{\\mathrm{O_2, P}} = 2(\\frac{1}{0.80} - 1) = 2(1.25 - 1) = 2(0.25) = 0.5$\n    \\item $N_{\\mathrm{N_2, P}} = \\frac{7.52}{0.80} = 9.4$\n\\end{itemize}\nThe reactant composition per mole of fuel is $1\\,\\mathrm{mol\\,CH_4}$, $(2/0.80)\\,\\mathrm{mol\\,O_2} = 2.5\\,\\mathrm{mol\\,O_2}$, and $9.4\\,\\mathrm{mol\\,N_2}$.\n\nWe can now calculate the numerical value of $T_{\\mathrm{ad}}$.\nThe initial temperature is $T_0 = 298\\,\\mathrm{K}$.\n\nThe numerator term (net enthalpy release) is $\\sum_{\\text{reactants}} N_i \\Delta \\bar{h}_{f,i}^\\circ - \\sum_{\\text{products}} N_j \\Delta \\bar{h}_{f,j}^\\circ$.\nReactant enthalpy of formation:\n$H_R^\\circ = N_{\\mathrm{CH_4}} \\Delta \\bar{h}_{f, \\mathrm{CH_4}}^\\circ + N_{\\mathrm{O_2, R}} \\Delta \\bar{h}_{f, \\mathrm{O_2}}^\\circ + N_{\\mathrm{N_2, R}} \\Delta \\bar{h}_{f, \\mathrm{N_2}}^\\circ$\n$H_R^\\circ = (1\\,\\mathrm{mol})(-74.85\\,\\mathrm{kJ/mol}) + (2.5\\,\\mathrm{mol})(0) + (9.4\\,\\mathrm{mol})(0) = -74.85\\,\\mathrm{kJ}$\n\nProduct enthalpy of formation:\n$H_P^\\circ = N_{\\mathrm{CO_2}} \\Delta \\bar{h}_{f, \\mathrm{CO_2}}^\\circ + N_{\\mathrm{H_2O}} \\Delta \\bar{h}_{f, \\mathrm{H_2O}}^\\circ + N_{\\mathrm{O_2, P}} \\Delta \\bar{h}_{f, \\mathrm{O_2}}^\\circ + N_{\\mathrm{N_2, P}} \\Delta \\bar{h}_{f, \\mathrm{N_2}}^\\circ$\n$H_P^\\circ = (1\\,\\mathrm{mol})(-393.52\\,\\mathrm{kJ/mol}) + (2\\,\\mathrm{mol})(-241.826\\,\\mathrm{kJ/mol}) + (0.5\\,\\mathrm{mol})(0) + (9.4\\,\\mathrm{mol})(0)$\n$H_P^\\circ = -393.52\\,\\mathrm{kJ} - 483.652\\,\\mathrm{kJ} = -877.172\\,\\mathrm{kJ}$\n\nNumerator = $H_R^\\circ - H_P^\\circ = (-74.85\\,\\mathrm{kJ}) - (-877.172\\,\\mathrm{kJ}) = 802.322\\,\\mathrm{kJ} = 802322\\,\\mathrm{J}$.\n\nThe denominator term is $\\sum_{\\text{products}} N_j \\bar{c}_{p,j}$.\n$\\sum N_j \\bar{c}_{p,j} = N_{\\mathrm{CO_2}}\\bar{c}_{p,\\mathrm{CO_2}} + N_{\\mathrm{H_2O}}\\bar{c}_{p,\\mathrm{H_2O}} + N_{\\mathrm{O_2, P}}\\bar{c}_{p,\\mathrm{O_2}} + N_{\\mathrm{N_2, P}}\\bar{c}_{p,\\mathrm{N_2}}$\n$\\sum N_j \\bar{c}_{p,j} = (1\\,\\mathrm{mol})(50.0\\,\\mathrm{J/(mol\\cdot K)}) + (2\\,\\mathrm{mol})(40.0\\,\\mathrm{J/(mol\\cdot K)}) + (0.5\\,\\mathrm{mol})(36.0\\,\\mathrm{J/(mol\\cdot K)}) + (9.4\\,\\mathrm{mol})(34.0\\,\\mathrm{J/(mol\\cdot K)})$\n$\\sum N_j \\bar{c}_{p,j} = 50.0 + 80.0 + 18.0 + 319.6 = 467.6\\,\\mathrm{J/K}$.\n\nFinally, we calculate $T_{\\mathrm{ad}}$:\n$$\nT_{\\mathrm{ad}} = 298\\,\\mathrm{K} + \\frac{802322\\,\\mathrm{J}}{467.6\\,\\mathrm{J/K}} = 298\\,\\mathrm{K} + 1715.829769\\,\\mathrm{K} = 2013.829769\\,\\mathrm{K}\n$$\nRounding the final answer to four significant figures gives $2014\\,\\mathrm{K}$. In standard scientific notation this is $2.014 \\times 10^3\\,\\mathrm{K}$.",
            "answer": "$$\\boxed{2.014 \\times 10^3}$$"
        },
        {
            "introduction": "While the assumption of constant specific heats is instructive, realistic flame temperature calculations require accounting for the strong temperature dependence of thermodynamic properties. This practice  introduces the industry-standard method for this: the NASA 7-coefficient polynomials, which provide a highly accurate representation of species enthalpy and heat capacity. Solving the energy balance equation now becomes a nonlinear problem requiring a numerical root-finding algorithm, a core competency you will develop while exploring the effects of stoichiometry and reactant preheating.",
            "id": "4006481",
            "problem": "You are tasked with deriving and implementing an algorithm to compute the adiabatic flame temperature for hydrocarbon combustion using temperature-dependent heat capacities expressed through National Aeronautics and Space Administration (NASA) seven-coefficient polynomials. The scenario is an adiabatic, steady, constant-pressure, ideal-gas combustion process with no shaft work and negligible kinetic and potential energy changes. Assume complete combustion of the limiting reactant to carbon dioxide and water vapor, and treat any excess oxygen, nitrogen, or methane as non-reacting in the products. Water is to be treated as vapor in the products. Air is modeled as a mixture containing $21\\%$ oxygen and $79\\%$ nitrogen by mole.\n\nStarting from first principles, use the steady-flow energy equation for an adiabatic process, which implies conservation of total molar enthalpy:\n$$\n\\sum_i n_{r,i}\\, h_i(T_0) \\;=\\; \\sum_j n_{p,j}\\, h_j(T_{\\mathrm{ad}})\n$$\nwhere $n_{r,i}$ and $n_{p,j}$ are the molar amounts of reactant species $i$ and product species $j$, $h_k(T)$ is the molar enthalpy of species $k$ at temperature $T$, $T_0$ is the reactant inlet temperature, and $T_{\\mathrm{ad}}$ is the adiabatic flame temperature to be determined.\n\nModel each species molar enthalpy $h(T)$ using the NASA seven-coefficient polynomial form. For a given species with coefficients $\\{a_1,a_2,a_3,a_4,a_5,a_6,a_7\\}$ valid over a temperature range, the dimensionless heat capacity and enthalpy functions are:\n$$\n\\frac{c_p(T)}{R} \\;=\\; a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4,\n$$\n$$\n\\frac{h(T)}{R\\,T} \\;=\\; a_1 + \\frac{a_2 T}{2} + \\frac{a_3 T^2}{3} + \\frac{a_4 T^3}{4} + \\frac{a_5 T^4}{5} + \\frac{a_6}{T},\n$$\nwhere $R$ is the universal gas constant. Use piecewise polynomials with the following low-temperature ($200\\,\\mathrm{K}$ to $1000\\,\\mathrm{K}$) and high-temperature ($1000\\,\\mathrm{K}$ to $6000\\,\\mathrm{K}$) coefficient sets. The species included are methane ($\\mathrm{CH_4}$), oxygen ($\\mathrm{O_2}$), nitrogen ($\\mathrm{N_2}$), carbon dioxide ($\\mathrm{CO_2}$), and water vapor ($\\mathrm{H_2O}$).\n\nFor $\\mathrm{CH_4}$:\n- Low: $[5.14987613,\\,-0.013671,\\;4.918005\\times 10^{-5},\\,-4.835016\\times 10^{-8},\\;1.753601\\times 10^{-11},\\,-10246.6476,\\,-4.641303]$\n- High: $[7.48514950,\\,-0.007243135,\\;2.225501\\times 10^{-6},\\,-3.102517\\times 10^{-10},\\;1.360730\\times 10^{-14},\\,-10602.047,\\,-14.0991]$\n\nFor $\\mathrm{O_2}$:\n- Low: $[3.78245636,\\,-0.002996734,\\;9.847302\\times 10^{-6},\\,-9.681295\\times 10^{-9},\\;3.243728\\times 10^{-12},\\,-1063.94356,\\;3.657675]$\n- High: $[3.28253784,\\;0.001483088,\\,-7.579666\\times 10^{-7},\\;2.094706\\times 10^{-10},\\,-2.167178\\times 10^{-14},\\,-1088.059,\\;5.453231]$\n\nFor $\\mathrm{N_2}$:\n- Low: $[3.53100528,\\,-0.0001236609,\\,-5.029994\\times 10^{-7},\\;2.435306\\times 10^{-9},\\,-1.408812\\times 10^{-12},\\,-1046.976,\\;2.967474]$\n- High: $[2.95257626,\\;0.001396901,\\,-4.926316\\times 10^{-7},\\;7.860103\\times 10^{-11},\\,-4.607553\\times 10^{-15},\\,-923.948,\\;5.871892]$\n\nFor $\\mathrm{CO_2}$:\n- Low: $[2.35677352,\\;0.008984596,\\,-7.123562\\times 10^{-6},\\;2.459190\\times 10^{-9},\\,-1.436995\\times 10^{-13},\\,-48371.96,\\;9.901052]$\n- High: $[3.85796028,\\;0.004414370,\\,-2.214814\\times 10^{-6},\\;5.234901\\times 10^{-10},\\,-4.720841\\times 10^{-14},\\,-48759.16,\\;2.271638]$\n\nFor $\\mathrm{H_2O}$ (vapor):\n- Low: $[4.198640,\\,-0.002036434,\\;6.520402\\times 10^{-6},\\,-5.487970\\times 10^{-9},\\;1.771978\\times 10^{-12},\\,-30293.7267,\\,-0.849032208]$\n- High: $[3.03399249,\\;0.002176918,\\,-1.640725\\times 10^{-7},\\,-9.704198\\times 10^{-11},\\;1.682010\\times 10^{-14},\\,-30004.297,\\;4.966770]$\n\nUse $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The enthalpy $h(T)$ calculated from the NASA polynomial is the absolute molar enthalpy on a consistent reference scale; therefore, you must use $h(T)$ directly for both reactants at $T_0$ and products at $T_{\\mathrm{ad}}$ in the energy balance.\n\nDefine the equivalence ratio $\\phi$ as:\n$$\n\\phi \\;=\\; \\frac{(F/O)_{\\mathrm{actual}}}{(F/O)_{\\mathrm{stoich}}},\n$$\nwith methane stoichiometry $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$. For a given $\\phi$ and $n_{\\mathrm{CH_4}}$ moles of methane, compute the inlet oxygen moles as:\n$$\nn_{\\mathrm{O_2,in}} \\;=\\; \\frac{2\\,n_{\\mathrm{CH_4}}}{\\phi},\n$$\nand the accompanying nitrogen moles as:\n$$\nn_{\\mathrm{N_2,in}} \\;=\\; 3.7619 \\, n_{\\mathrm{O_2,in}}.\n$$\nDetermine the reaction extent $\\xi$ by the limiting reactant:\n$$\n\\xi \\;=\\; \\min\\left(n_{\\mathrm{CH_4}},\\;\\frac{n_{\\mathrm{O_2,in}}}{2}\\right).\n$$\nThe product composition is then:\n- $n_{\\mathrm{CO_2}} = \\xi$,\n- $n_{\\mathrm{H_2O}} = 2\\,\\xi$,\n- $n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2\\,\\xi$,\n- $n_{\\mathrm{CH_4,ex}} = n_{\\mathrm{CH_4}} - \\xi$,\n- $n_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}}$.\n\nImplement a root-finding algorithm to solve for $T_{\\mathrm{ad}}$ satisfying the energy balance equation. Ensure a robust bracketing over a temperature interval that covers physically plausible flame temperatures for hydrocarbon-air combustion (e.g., from $300\\,\\mathrm{K}$ to $4000\\,\\mathrm{K}$), and terminate when the absolute enthalpy residual is less than $10^{-3}\\ \\mathrm{J/mol}$ or when the temperature interval width is less than $10^{-6}\\ \\mathrm{K}$.\n\nPhysical units: Output temperatures must be expressed in $\\mathrm{K}$ and rounded to two decimal places.\n\nAngle units: Not applicable.\n\nPercentages: Not applicable.\n\nYour program must produce a single line of output containing the computed adiabatic flame temperatures for the following test suite, as a comma-separated list enclosed in square brackets:\n- Case $1$: $n_{\\mathrm{CH_4}} = 1.0$ mole, $\\phi = 1.0$, $T_0 = 298.15\\ \\mathrm{K}$.\n- Case $2$: $n_{\\mathrm{CH_4}} = 1.0$ mole, $\\phi = 1.0$, $T_0 = 800.00\\ \\mathrm{K}$.\n- Case $3$: $n_{\\mathrm{CH_4}} = 1.0$ mole, $\\phi = 0.80$, $T_0 = 298.15\\ \\mathrm{K}$.\n- Case $4$: $n_{\\mathrm{CH_4}} = 1.0$ mole, $\\phi = 1.20$, $T_0 = 298.15\\ \\mathrm{K}$.\n\nFinal output format specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[T_1,T_2,T_3,T_4]$), where each $T_i$ is the adiabatic flame temperature in $\\mathrm{K}$ rounded to two decimal places, with no spaces anywhere in the line.",
            "solution": "The problem requires the calculation of the adiabatic flame temperature, $T_{\\mathrm{ad}}$, for the combustion of methane ($\\mathrm{CH_4}$) with air under specified conditions. This is a classic thermodynamic problem solvable by applying the First Law of Thermodynamics to a steady-state, steady-flow, adiabatic, isobaric reacting system with no work interactions.\n\n**1. Fundamental Principle: Conservation of Enthalpy**\n\nFor a steady-flow, adiabatic system where changes in kinetic and potential energy are negligible and no shaft work is performed, the First Law of Thermodynamics simplifies to the conservation of total enthalpy. The total enthalpy of the reactants entering the system at temperature $T_0$ must equal the total enthalpy of the products exiting at the adiabatic flame temperature, $T_{\\mathrm{ad}}$. This principle is expressed as:\n$$\nH_{\\text{reactants}}(T_0) = H_{\\text{products}}(T_{\\mathrm{ad}})\n$$\nIn terms of molar quantities, this balance is:\n$$\n\\sum_{i \\in \\text{reactants}} n_{r,i}\\, h_i(T_0) = \\sum_{j \\in \\text{products}} n_{p,j}\\, h_j(T_{\\mathrm{ad}})\n$$\nwhere $n_k$ represents the number of moles of species $k$, and $h_k(T)$ is its absolute molar enthalpy at temperature $T$. Our goal is to find the temperature $T_{\\mathrm{ad}}$ that satisfies this equation.\n\n**2. Molar Enthalpy from NASA Polynomials**\n\nThe absolute molar enthalpy, $h(T)$, of each species is modeled using the NASA seven-coefficient polynomial form. The formula provided for the dimensionless enthalpy, $\\frac{h(T)}{RT}$, is rearranged to solve for $h(T)$:\n$$\nh(T) = R T \\left( a_1 + \\frac{a_2 T}{2} + \\frac{a_3 T^2}{3} + \\frac{a_4 T^3}{4} + \\frac{a_5 T^4}{5} + \\frac{a_6}{T} \\right)\n$$\nHere, $R$ is the universal gas constant ($8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$), $T$ is the absolute temperature in Kelvin, and $\\{a_1, a_2, \\ldots, a_7\\}$ are the species-specific coefficients. For each species, two sets of coefficients are provided: one for the low-temperature range ($200\\,\\mathrm{K} \\le T < 1000\\,\\mathrm{K}$) and one for the high-temperature range ($1000\\,\\mathrm{K} \\le T \\le 6000\\,\\mathrm{K}$). The computational algorithm must select the appropriate set of coefficients based on the temperature $T$ at which the enthalpy is being evaluated.\n\n**3. Stoichiometry and Species Mole Balances**\n\nThe composition of the reactant and product mixtures must be determined based on the given equivalence ratio, $\\phi$. The basis for all calculations is taken as $n_{\\mathrm{CH_4}} = 1.0$ mole of fuel.\n\nThe stoichiometric combustion of methane in oxygen is:\n$$\n\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}\n$$\nThe stoichiometric fuel-to-oxygen ratio is $(F/O)_{\\mathrm{stoich}} = \\frac{n_{\\mathrm{CH_4}}}{n_{\\mathrm{O_2}}} = \\frac{1}{2}$. The equivalence ratio $\\phi$ is defined as the actual fuel/oxygen ratio divided by the stoichiometric one:\n$$\n\\phi = \\frac{(F/O)_{\\mathrm{actual}}}{(F/O)_{\\mathrm{stoich}}} = \\frac{n_{\\mathrm{CH_4}}/n_{\\mathrm{O_2,in}}}{1/2} = \\frac{2\\,n_{\\mathrm{CH_4}}}{n_{\\mathrm{O_2,in}}}\n$$\nFrom this, we determine the moles of oxygen supplied:\n$$\nn_{\\mathrm{O_2,in}} = \\frac{2\\,n_{\\mathrm{CH_4}}}{\\phi}\n$$\nThe air is comprised of $21\\%$ $\\mathrm{O_2}$ and $79\\%$ $\\mathrm{N_2}$ by mole, so the moles of accompanying inert nitrogen are:\n$$\nn_{\\mathrm{N_2,in}} = n_{\\mathrm{O_2,in}} \\times \\frac{0.79}{0.21} \\approx 3.7619 \\, n_{\\mathrm{O_2,in}}\n$$\n\nThe extent of reaction, $\\xi$, is determined by the limiting reactant. For each mole of reaction progress, $1$ mole of $\\mathrm{CH_4}$ and $2$ moles of $\\mathrm{O_2}$ are consumed. The maximum possible extent is:\n$$\n\\xi = \\min\\left(n_{\\mathrm{CH_4,in}}, \\frac{n_{\\mathrm{O_2,in}}}{2}\\right)\n$$\nThe molar amounts of the product species are then calculated as follows, assuming complete combustion of the limiting reactant:\n-   Moles of $\\mathrm{CO_2}$: $n_{\\mathrm{CO_2}} = \\xi$\n-   Moles of $\\mathrm{H_2O}$: $n_{\\mathrm{H_2O}} = 2\\xi$\n-   Moles of excess $\\mathrm{O_2}$: $n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2\\xi$\n-   Moles of excess $\\mathrm{CH_4}$: $n_{\\mathrm{CH_4,ex}} = n_{\\mathrm{CH_4,in}} - \\xi$\n-   Moles of $\\mathrm{N_2}$: $n_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}}$ (inert)\n\n**4. Algorithmic Solution via Root-Finding**\n\nThe problem is now reduced to finding the root $T_{\\mathrm{ad}}$ of the following nonlinear residual function, $F(T)$:\n$$\nF(T) = H_{\\text{products}}(T) - H_{\\text{reactants}}(T_0) = 0\n$$\nwhere $H_{\\text{reactants}}(T_0)$ is a constant value for a given case.\n\nThe algorithm proceeds as follows:\n1.  For each test case (defined by $\\phi$ and $T_0$ with $n_{\\mathrm{CH_4}}=1.0$):\n    a.  Calculate the molar amounts of all reactant species: $n_{\\mathrm{CH_4, in}}$, $n_{\\mathrm{O_2, in}}$, $n_{\\mathrm{N_2, in}}$.\n    b.  Calculate the total enthalpy of the reactant mixture at the initial temperature $T_0$: $H_{\\text{reactants}}(T_0) = \\sum_{i} n_{r,i} h_i(T_0)$.\n    c.  Calculate the molar amounts of all product species: $n_{\\mathrm{CO_2}}$, $n_{\\mathrm{H_2O}}$, $n_{\\mathrm{O_2,ex}}$, $n_{\\mathrm{CH_4,ex}}$, and $n_{\\mathrm{N_2}}$.\n    d.  Define the residual function $F(T)$ which calculates the total enthalpy of the product mixture at a given temperature $T$, $H_{\\text{products}}(T) = \\sum_{j} n_{p,j} h_j(T)$, and subtracts the pre-computed $H_{\\text{reactants}}(T_0)$.\n2.  Use a numerical root-finding algorithm to solve $F(T_{\\mathrm{ad}})=0$. A bracketing method like Brent's method is suitable, as the function $F(T)$ is monotonic and the problem guarantees that a root exists within the interval $[300\\,\\mathrm{K}, 4000\\,\\mathrm{K}]$. The physical reasoning is that for an exothermic reaction, $H_{\\text{products}}(T_0) < H_{\\text{reactants}}(T_0)$, thus $F(T_0)<0$. As product temperature increases, its sensible enthalpy rises, ensuring $F(T)$ will eventually become positive. Therefore, `scipy.optimize.brentq` is an excellent choice.\n3.  The found root, $T_{\\mathrm{ad}}$, is the adiabatic flame temperature. This value is then rounded to two decimal places as required.\n4.  The process is repeated for all test cases, and the results are compiled into the specified output format.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the adiabatic flame temperature for methane combustion.\n    \n    This function solves the energy balance equation for an adiabatic, constant-pressure\n    combustion process. It uses NASA 7-coefficient polynomials to model the\n    temperature-dependent enthalpy of each species. A root-finding algorithm\n    is employed to find the temperature at which the total enthalpy of the products\n    equals the total enthalpy of the reactants.\n    \"\"\"\n\n    # Universal Gas Constant in J/(mol*K)\n    R = 8.314462618\n\n    # NASA 7-coefficient polynomial data for each species.\n    # Format: {species: {'low': [a1..a7], 'high': [a1..a7]}}\n    nasa_coeffs = {\n        'CH4': {\n            'low': np.array([5.14987613, -0.013671, 4.918005e-05, -4.835016e-08, 1.753601e-11, -10246.6476, -4.641303]),\n            'high': np.array([7.48514950, -0.007243135, 2.225501e-06, -3.102517e-10, 1.360730e-14, -10602.047, -14.0991])\n        },\n        'O2': {\n            'low': np.array([3.78245636, -0.002996734, 9.847302e-06, -9.681295e-09, 3.243728e-12, -1063.94356, 3.657675]),\n            'high': np.array([3.28253784, 0.001483088, -7.579666e-07, 2.094706e-10, -2.167178e-14, -1088.059, 5.453231])\n        },\n        'N2': {\n            'low': np.array([3.53100528, -0.0001236609, -5.029994e-07, 2.435306e-09, -1.408812e-12, -1046.976, 2.967474]),\n            'high': np.array([2.95257626, 0.001396901, -4.926316e-07, 7.860103e-11, -4.607553e-15, -923.948, 5.871892])\n        },\n        'CO2': {\n            'low': np.array([2.35677352, 0.008984596, -7.123562e-06, 2.459190e-09, -1.436995e-13, -48371.96, 9.901052]),\n            'high': np.array([3.85796028, 0.004414370, -2.214814e-06, 5.234901e-10, -4.720841e-14, -48759.16, 2.271638])\n        },\n        'H2O': {\n            'low': np.array([4.198640, -0.002036434, 6.520402e-06, -5.487970e-09, 1.771978e-12, -30293.7267, -0.849032208]),\n            'high': np.array([3.03399249, 0.002176918, -1.640725e-07, -9.704198e-11, 1.682010e-14, -30004.297, 4.966770])\n        }\n    }\n\n    def get_molar_enthalpy(species, T):\n        \"\"\"Calculates molar enthalpy h(T) for a given species and temperature.\"\"\"\n        if T < 1000.0:\n            coeffs = nasa_coeffs[species]['low']\n        else:\n            coeffs = nasa_coeffs[species]['high']\n        \n        a1, a2, a3, a4, a5, a6, _ = coeffs\n        \n        term1 = a1\n        term2 = a2 * T / 2\n        term3 = a3 * T**2 / 3\n        term4 = a4 * T**3 / 4\n        term5 = a5 * T**4 / 5\n        term6 = a6 / T\n        \n        h = R * T * (term1 + term2 + term3 + term4 + term5 + term6)\n        return h\n\n    # Test cases: (n_CH4, phi, T0)\n    test_cases = [\n        (1.0, 1.0, 298.15),   # Case 1\n        (1.0, 1.0, 800.00),   # Case 2\n        (1.0, 0.80, 298.15),  # Case 3\n        (1.0, 1.20, 298.15)   # Case 4\n    ]\n\n    results = []\n\n    for n_ch4_in, phi, T0 in test_cases:\n        # Step 1: Determine reactant composition\n        n_o2_in = 2.0 * n_ch4_in / phi\n        # N2/O2 ratio in air is 79/21\n        n_n2_in = n_o2_in * (79.0 / 21.0)\n        \n        reactants = {'CH4': n_ch4_in, 'O2': n_o2_in, 'N2': n_n2_in}\n\n        # Step 2: Calculate total enthalpy of reactants at T0\n        H_reactants = sum(n * get_molar_enthalpy(sp, T0) for sp, n in reactants.items())\n\n        # Step 3: Determine product composition\n        # Extent of reaction (xi) based on limiting reactant\n        xi = min(n_ch4_in, n_o2_in / 2.0)\n        \n        n_co2_out = xi\n        n_h2o_out = 2.0 * xi\n        n_o2_out = n_o2_in - 2.0 * xi\n        n_ch4_out = n_ch4_in - xi\n        n_n2_out = n_n2_in\n        \n        products = {\n            'CO2': n_co2_out, \n            'H2O': n_h2o_out,\n            'O2': n_o2_out,\n            'CH4': n_ch4_out,\n            'N2': n_n2_out\n        }\n\n        # Step 4: Define residual function for root-finding\n        def enthalpy_residual(T_ad):\n            \"\"\"Calculates H_products(T_ad) - H_reactants(T0).\"\"\"\n            H_products = sum(n * get_molar_enthalpy(sp, T_ad) \n                             for sp, n in products.items() if n > 0)\n            return H_products - H_reactants\n            \n        # Step 5: Solve for the adiabatic flame temperature (T_ad)\n        # The search interval [300 K, 4000 K] is physically reasonable.\n        try:\n            T_ad = brentq(enthalpy_residual, 300.0, 4000.0, xtol=1e-6, rtol=1e-8)\n            results.append(f\"{T_ad:.2f}\")\n        except ValueError:\n            # This should not happen if the problem is well-posed.\n            results.append(\"Error\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "At the extreme temperatures characteristic of flames, the assumption of complete combustion to only major products like $CO_2$ and $H_2O$ breaks down. High-temperature chemical equilibrium leads to the formation of minor species through endothermic reactions, which lowers the final flame temperature. This advanced practice  delves into this phenomenon by requiring you to solve a coupled system of nonlinear equations that simultaneously enforces the energy balance, thermal NO equilibrium, and ionization equilibrium via the Saha equation, providing a more accurate and physically complete picture of the combustion products' state.",
            "id": "4006472",
            "problem": "Consider a lean premixed methane–air flame undergoing adiabatic, constant-pressure combustion at thermodynamic equilibrium. The goal is to estimate the adiabatic flame temperature by solving a coupled nonlinear system that enforces energy conservation, element conservation, and chemical equilibrium for high-temperature phenomena including thermal nitric oxide and ionization. Assume an ideal gas mixture and ignore dissociation of carbon dioxide and water.\n\nBegin from the First Law of Thermodynamics for a steady, adiabatic, one-dimensional flow with no shaft work, which implies that the total enthalpy of the reactants equals the total enthalpy of the products. Use element conservation for nitrogen and oxygen and ideal-gas equilibrium relations. Consider the following species set in the products: carbon dioxide, water vapor, molecular nitrogen, molecular oxygen, nitric oxide, ionized nitric oxide, and electrons. Electroneutrality is enforced by the equality of the number of moles of ionized nitric oxide and electrons.\n\nLet the fuel be methane, the oxidizer be dry air with oxygen mole fraction $x_{\\mathrm{O_2}} = 0.2095$ and nitrogen mole fraction $x_{\\mathrm{N_2}} = 0.7905$, and let the global equivalence ratio be $\\phi \\in (0,1)$ so that the mixture is lean. Use one mole of methane as the fuel basis. The inlet pressure is $p$ in $\\mathrm{Pa}$, and the inlet temperature is $T_0$ in $\\mathrm{K}$. The inlet oxygen moles are $n_{\\mathrm{O_2,in}} = 2/\\phi$, and the inlet nitrogen moles are $n_{\\mathrm{N_2,in}} = (x_{\\mathrm{N_2}}/x_{\\mathrm{O_2}})\\,n_{\\mathrm{O_2,in}}$. The complete-combustion product moles of carbon dioxide and water vapor are $n_{\\mathrm{CO_2}} = 1$ and $n_{\\mathrm{H_2O}} = 2$. The initial excess oxygen moles are $n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2$, which must be strictly positive for $\\phi < 1$.\n\nLet the unknown product moles of nitric oxide be $n_{\\mathrm{NO}}$, ionized nitric oxide be $n_{\\mathrm{NO^+}}$, and electrons be $n_{e}$. Enforce electroneutrality by $n_{e} = n_{\\mathrm{NO^+}}$. Given the formation of nitric oxide and its ionization, the remaining product moles of molecular oxygen and molecular nitrogen follow from element conservation:\n$$\nn_{\\mathrm{O_2}} = n_{\\mathrm{O_2,ex}} - \\frac{n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}}}{2}, \\quad\nn_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}} - \\frac{n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}}}{2}.\n$$\nLet the total product moles be\n$$\nn_{\\mathrm{tot}} = n_{\\mathrm{CO_2}} + n_{\\mathrm{H_2O}} + n_{\\mathrm{N_2}} + n_{\\mathrm{O_2}} + n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}} + n_e.\n$$\n\nImpose chemical equilibrium for thermal nitric oxide via the equilibrium constant for the reaction $2\\,\\mathrm{NO} \\rightleftharpoons \\mathrm{N_2} + \\mathrm{O_2}$ under the ideal-gas law. For this reaction, the equilibrium constant expressed in terms of mole numbers is independent of pressure:\n$$\nK_p(T) = \\frac{n_{\\mathrm{N_2}}\\,n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2}.\n$$\nApproximate $K_p(T)$ using a van’t Hoff form with temperature-independent standard reaction enthalpy $\\Delta H^\\circ$ and entropy $\\Delta S^\\circ$, so that\n$$\n\\ln K_p(T) = -\\frac{\\Delta G^\\circ(T)}{R\\,T}, \\quad \\Delta G^\\circ(T) = \\Delta H^\\circ - T\\,\\Delta S^\\circ,\n$$\nwith constants $\\Delta H^\\circ = -180500\\,\\mathrm{J/mol}$ and $\\Delta S^\\circ = -24.74\\,\\mathrm{J/(mol\\cdot K)}$, where $R$ is the universal gas constant.\n\nImpose ionization equilibrium for nitric oxide via the Saha equation for the reaction $\\mathrm{NO} \\rightleftharpoons \\mathrm{NO^+} + e^-$. Using ideal-gas number densities and partition-function ratio approximated as unity, the Saha relation in terms of mole fractions $y_i = n_i/n_{\\mathrm{tot}}$ is\n$$\n\\frac{y_e\\,y_{\\mathrm{NO^+}}}{y_{\\mathrm{NO}}} = S(T)\\,\\frac{k_B\\,T}{p},\n$$\nwhere $S(T) = 2\\left(\\frac{2\\pi m_e k_B T}{h^2}\\right)^{3/2}\\exp\\left(-\\frac{E_{\\mathrm{ion}}}{k_B T}\\right)$, $m_e$ is the electron mass, $h$ is Planck’s constant, $k_B$ is Boltzmann’s constant, and $E_{\\mathrm{ion}}$ is the ionization energy of nitric oxide, with $E_{\\mathrm{ion}} = 9.26\\,\\mathrm{eV}$.\n\nLet the standard enthalpies of formation at $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$ be $h_f^\\circ(\\mathrm{CH_4}) = -74850\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{CO_2}) = -393522\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{H_2O(g)}) = -241826\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{NO}) = 90250\\,\\mathrm{J/mol}$, $h_f^\\circ(\\mathrm{NO^+}) = h_f^\\circ(\\mathrm{NO}) + 9.26\\times 96485\\,\\mathrm{J/mol}$, and $h_f^\\circ$ equal to $0\\,\\mathrm{J/mol}$ for $\\mathrm{O_2}$, $\\mathrm{N_2}$, and $e^-$. Model species isobaric heat capacities with linear temperature dependence $c_{p,i}(T) = a_i + b_i\\,T$, using coefficients $(a_i,b_i)$ in $\\mathrm{J/(mol\\cdot K)}$ and $\\mathrm{J/(mol\\cdot K^2)}$:\n$$\n\\begin{aligned}\n&(\\mathrm{CO_2}): (a,b) = (37.0,\\,0.0030), \\quad (\\mathrm{H_2O}): (33.6,\\,0.0040), \\quad (\\mathrm{N_2}): (29.0,\\,0.0027),\\\\\n&(\\mathrm{O_2}): (29.0,\\,0.0025), \\quad (\\mathrm{NO}): (30.0,\\,0.0030), \\quad (\\mathrm{NO^+}): (30.0,\\,0.0030),\\\\\n&(\\mathrm{e^-}): (20.786,\\,0.0), \\quad (\\mathrm{CH_4}): (35.0,\\,0.0100).\n\\end{aligned}\n$$\nSensible enthalpy rises from $T_{\\mathrm{ref}}$ are $\\Delta h_i(T;T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} c_{p,i}(T')\\,\\mathrm{d}T' = a_i\\,(T-T_{\\mathrm{ref}}) + \\frac{b_i}{2}\\,(T^2 - T_{\\mathrm{ref}}^2)$.\n\nLet the reactant enthalpy at the inlet be\n$$\nH_{\\mathrm{in}} = n_{\\mathrm{CH_4}}\\left[h_f^\\circ(\\mathrm{CH_4}) + \\Delta h_{\\mathrm{CH_4}}(T_0;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{O_2,in}}\\left[0 + \\Delta h_{\\mathrm{O_2}}(T_0;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{N_2,in}}\\left[0 + \\Delta h_{\\mathrm{N_2}}(T_0;T_{\\mathrm{ref}})\\right],\n$$\nwith $n_{\\mathrm{CH_4}} = 1$. The product enthalpy is\n$$\n\\begin{aligned}\nH_{\\mathrm{out}}(T,n_{\\mathrm{NO}},n_{\\mathrm{NO^+}}) &=\nn_{\\mathrm{CO_2}}\\left[h_f^\\circ(\\mathrm{CO_2}) + \\Delta h_{\\mathrm{CO_2}}(T;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{H_2O}}\\left[h_f^\\circ(\\mathrm{H_2O}) + \\Delta h_{\\mathrm{H_2O}}(T;T_{\\mathrm{ref}})\\right]\\\\\n&\\quad + n_{\\mathrm{N_2}}\\left[0 + \\Delta h_{\\mathrm{N_2}}(T;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{O_2}}\\left[0 + \\Delta h_{\\mathrm{O_2}}(T;T_{\\mathrm{ref}})\\right]\\\\\n&\\quad + n_{\\mathrm{NO}}\\left[h_f^\\circ(\\mathrm{NO}) + \\Delta h_{\\mathrm{NO}}(T;T_{\\mathrm{ref}})\\right]\n+ n_{\\mathrm{NO^+}}\\left[h_f^\\circ(\\mathrm{NO^+}) + \\Delta h_{\\mathrm{NO^+}}(T;T_{\\mathrm{ref}})\\right]\\\\\n&\\quad + n_{e}\\left[0 + \\Delta h_{e}(T;T_{\\mathrm{ref}})\\right].\n\\end{aligned}\n$$\nThe adiabatic flame temperature $T_{\\mathrm{ad}}$ and product composition $(n_{\\mathrm{NO}},n_{\\mathrm{NO^+}})$ satisfy the nonlinear system\n$$\n\\begin{cases}\nK_p(T) - \\dfrac{n_{\\mathrm{N_2}}\\,n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2} = 0,\\\\[1em]\n\\dfrac{y_e\\,y_{\\mathrm{NO^+}}}{y_{\\mathrm{NO}}} - S(T)\\,\\dfrac{k_B T}{p} = 0,\\\\[1em]\nH_{\\mathrm{out}}(T,n_{\\mathrm{NO}},n_{\\mathrm{NO^+}}) - H_{\\mathrm{in}} = 0,\n\\end{cases}\n$$\nwith $y_i = n_i/n_{\\mathrm{tot}}$ and $n_e = n_{\\mathrm{NO^+}}$. All species moles must be nonnegative and $n_{\\mathrm{O_2}} \\ge 0$.\n\nImplement a program to solve this system numerically for the adiabatic flame temperature and return only the flame temperature for each test case. Use the following test suite with specified inputs $(\\phi, p, T_0)$:\n- Case $1$: $\\phi = 0.85$, $p = 100000\\,\\mathrm{Pa}$, $T_0 = 298.15\\,\\mathrm{K}$.\n- Case $2$: $\\phi = 0.70$, $p = 100000\\,\\mathrm{Pa}$, $T_0 = 298.15\\,\\mathrm{K}$.\n- Case $3$: $\\phi = 0.85$, $p = 5000000\\,\\mathrm{Pa}$, $T_0 = 298.15\\,\\mathrm{K}$.\n- Case $4$: $\\phi = 0.85$, $p = 100000\\,\\mathrm{Pa}$, $T_0 = 800.00\\,\\mathrm{K}$.\n\nYour program should produce a single line of output containing the adiabatic flame temperatures in $\\mathrm{K}$, rounded to one decimal place, as a comma-separated list enclosed in square brackets, for example, $[T_1,T_2,T_3,T_4]$.",
            "solution": "The user has provided a scientifically grounded and well-posed problem in computational combustion. The task is to determine the adiabatic flame temperature for a lean methane-air mixture by numerically solving a system of three coupled nonlinear equations that represent conservation of energy, element conservation, and chemical equilibrium. The problem is valid, and a complete solution will be provided.\n\n### Problem Formulation and Governing Equations\n\nThe state of the product gas at thermodynamic equilibrium is described by the adiabatic flame temperature, $T$, and the mole numbers of the product species. Based on the problem statement, the system is specified by three unknowns: the temperature $T$, the moles of nitric oxide $n_{\\mathrm{NO}}$, and the moles of ionized nitric oxide $n_{\\mathrm{NO^+}}$. All other product mole numbers can be derived from these three variables and the initial reactant composition. The problem is thus to find the root of a system of three nonlinear equations for three unknowns, $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$, where $\\mathbf{x} = (T, n_{\\mathrm{NO}}, n_{\\mathrm{NO^+}})$.\n\nThe three governing equations are:\n1.  **Thermal NO Equilibrium**: The equilibrium for the reaction $2\\,\\mathrm{NO} \\rightleftharpoons \\mathrm{N_2} + \\mathrm{O_2}$ is given by the equilibrium constant $K_p(T)$.\n2.  **NO Ionization Equilibrium**: The ionization of nitric oxide, $\\mathrm{NO} \\rightleftharpoons \\mathrm{NO^+} + e^-$, is described by the Saha equation.\n3.  **Energy Conservation**: The First Law of Thermodynamics for an adiabatic, constant-pressure process requires the enthalpy of the products at temperature $T$ to equal the enthalpy of the reactants at temperature $T_0$.\n\nLet's define the components of the vector function $\\mathbf{F}$.\n\n**Variables and Derived Quantities**\nThe independent variables for our numerical solver are chosen to enhance stability. Mole numbers can span many orders of magnitude and must be positive. Therefore, we solve for the temperature $T$, the natural logarithm of the moles of nitric oxide, $u_1 = \\ln(n_{\\mathrm{NO}})$, and the natural logarithm of the moles of ionized nitric oxide, $u_2 = \\ln(n_{\\mathrm{NO^+}})$. Our state vector is $\\mathbf{x} = (T, u_1, u_2)$. This transformation ensures that $n_{\\mathrm{NO}} = \\exp(u_1)$ and $n_{\\mathrm{NO^+}} = \\exp(u_2)$ are always positive.\n\nFor a given set of inputs $(\\phi, p, T_0)$ and a state vector $\\mathbf{x}$, we calculate the derived quantities:\n- Reactant moles: $n_{\\mathrm{CH_4}} = 1$, $n_{\\mathrm{O_2,in}} = 2/\\phi$, $n_{\\mathrm{N_2,in}} = (x_{\\mathrm{N_2}}/x_{\\mathrm{O_2}}) n_{\\mathrm{O_2,in}} \\approx 3.7733\\, n_{\\mathrm{O_2,in}}$.\n- Excess oxygen: $n_{\\mathrm{O_2,ex}} = n_{\\mathrm{O_2,in}} - 2$.\n- Product moles:\n    - $n_{\\mathrm{NO}} = \\exp(u_1)$, $n_{\\mathrm{NO^+}} = \\exp(u_2)$.\n    - $n_e = n_{\\mathrm{NO^+}}$ (electroneutrality).\n    - $n_{\\mathrm{CO_2}} = 1$, $n_{\\mathrm{H_2O}} = 2$.\n    - $n_{\\mathrm{O_2}} = n_{\\mathrm{O_2,ex}} - (n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}})/2$.\n    - $n_{\\mathrm{N_2}} = n_{\\mathrm{N_2,in}} - (n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}})/2$.\n    - $n_{\\mathrm{tot}} = 1 + n_{\\mathrm{H_2O}} + n_{\\mathrm{O_2}} + n_{\\mathrm{N_2}} + n_{\\mathrm{NO}} + n_{\\mathrm{NO^+}} + n_e = 1 + n_{\\mathrm{O_2,in}} + n_{\\mathrm{N_2,in}} + n_{\\mathrm{NO^+}}$.\n\n**Residual Equations**\nTo improve numerical stability, we formulate the equilibrium equations in logarithmic form. The three residual functions to be driven to zero are:\n\n1.  **NO Equilibrium Residual, $F_0$**:\n    From $K_p(T) = \\frac{n_{\\mathrm{N_2}} n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2}$, we take the natural logarithm of both sides:\n    $$F_0(T, u_1, u_2) = \\ln(K_p(T)) - \\ln\\left(\\frac{n_{\\mathrm{N_2}} n_{\\mathrm{O_2}}}{n_{\\mathrm{NO}}^2}\\right) = \\ln(K_p(T)) - (\\ln(n_{\\mathrm{N_2}}) + \\ln(n_{\\mathrm{O_2}}) - 2u_1) = 0$$\n    where $\\ln(K_p(T)) = -(\\Delta H^\\circ - T\\Delta S^\\circ)/(RT) = -\\Delta H^\\circ/(RT) + \\Delta S^\\circ/R$.\n\n2.  **Saha Equilibrium Residual, $F_1$**:\n    From $\\frac{y_e y_{\\mathrm{NO^+}}}{y_{\\mathrm{NO}}} = S(T)\\frac{k_B T}{p}$, we substitute $y_i = n_i/n_{\\mathrm{tot}}$ and $n_e = n_{\\mathrm{NO^+}}$:\n    $\\frac{(n_{\\mathrm{NO^+}}/n_{\\mathrm{tot}})^2}{n_{\\mathrm{NO}}/n_{\\mathrm{tot}}} = \\frac{n_{\\mathrm{NO^+}}^2}{n_{\\mathrm{NO}} n_{\\mathrm{tot}}} = S(T)\\frac{k_B T}{p}$.\n    Taking the natural logarithm:\n    $$F_1(T, u_1, u_2) = 2\\ln(n_{\\mathrm{NO^+}}) - \\ln(n_{\\mathrm{NO}}) - \\ln(n_{\\mathrm{tot}}) - \\ln\\left(S(T)\\frac{k_B T}{p}\\right) = 2u_2 - u_1 - \\ln(n_{\\mathrm{tot}}) - \\ln\\left(S(T)\\frac{k_B T}{p}\\right) = 0$$\n    where $S(T) = 2\\left(\\frac{2\\pi m_e k_B T}{h^2}\\right)^{3/2}\\exp\\left(-\\frac{E_{\\mathrm{ion}}}{k_B T}\\right)$.\n\n3.  **Energy Balance Residual, $F_2$**:\n    This is based on the first law, $H_{\\mathrm{out}}(T, n_{\\mathrm{NO}}, n_{\\mathrm{NO^+}}) = H_{\\mathrm{in}}(T_0)$.\n    $$F_2(T, u_1, u_2) = H_{\\mathrm{out}}(T, \\exp(u_1), \\exp(u_2)) - H_{\\mathrm{in}}(T_0) = 0$$\n    The reactant enthalpy $H_{\\mathrm{in}}$ and product enthalpy $H_{\\mathrm{out}}$ are calculated as the sum of species enthalpies, $H = \\sum_i n_i h_i(T)$. Each species enthalpy is the sum of its standard enthalpy of formation at $T_{\\mathrm{ref}}$ and its sensible enthalpy change from $T_{\\mathrm{ref}}$ to the specified temperature: $h_i(T) = h_{f,i}^\\circ + \\Delta h_i(T; T_{\\mathrm{ref}})$.\n    The sensible enthalpy is computed by integrating the given linear heat capacity function:\n    $$\\Delta h_i(T; T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} c_{p,i}(T')\\,\\mathrm{d}T' = a_i(T-T_{\\mathrm{ref}}) + \\frac{b_i}{2}(T^2 - T_{\\mathrm{ref}}^2)$$\n\n### Numerical Solution Strategy\n\nThe system $\\mathbf{F}(T, u_1, u_2) = \\mathbf{0}$ will be solved using a numerical root-finding algorithm. The `scipy.optimize.root` function, which implements a robust quasi-Newton method, is well-suited for this task.\n\nThe overall algorithm is as follows:\n1.  Define all physical and thermochemical constants provided in the problem statement.\n2.  For each test case $(\\phi, p, T_0)$:\n    a.  Pre-calculate constant reactant properties: $n_{\\mathrm{O_2,in}}$, $n_{\\mathrm{N_2,in}}$, $n_{\\mathrm{O_2,ex}}$, and the total reactant enthalpy $H_{\\mathrm{in}}(T_0)$.\n    b.  Define the residual function $\\mathbf{F}(\\mathbf{x})$ that takes the vector $\\mathbf{x}=(T, u_1, u_2)$ and returns the vector of residuals $(F_0, F_1, F_2)$. This function will use the pre-calculated reactant properties.\n    c.  Within the residual function, we must ensure that the mole numbers $n_{\\mathrm{O_2}}$ and $n_{\\mathrm{N_2}}$ remain positive, as required for the logarithm terms and for physical validity. If they become non-positive, a large penalty is returned to guide the solver away from this unphysical region.\n    d.  Provide a reasonable initial guess for the solver. Based on typical lean methane-air combustion, an initial temperature guess of $T \\approx_g 2100\\,\\mathrm{K}$ is appropriate. The mole numbers for $n_{\\mathrm{NO}}$ and $n_{\\mathrm{NO^+}}$ are expected to be small, correspond to negative values for $u_1$ and $u_2$. An initial guess of $\\mathbf{x}_g = (2100, -6, -25)$ is chosen based on preliminary estimation.\n    e.  Call `scipy.optimize.root` to find the solution vector $\\mathbf{x}^*$.\n    f.  The first element of the solution vector, $T^*$, is the adiabatic flame temperature.\n3.  Collect the resulting temperatures for all test cases, format them to one decimal place, and print them in the specified list format.\n\nThis structured approach ensures that the complex, coupled physics of the problem is translated into a well-behaved numerical system that can be solved efficiently and accurately.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.constants import k, h, m_e, R\n\ndef solve():\n    \"\"\"\n    Main function to solve for adiabatic flame temperature for a set of test cases.\n    \"\"\"\n    # Physical and chemical constants\n    CONSTS = {\n        'x_O2': 0.2095,\n        'x_N2': 0.7905,\n        'T_ref': 298.15,  # K\n        'R': R,  # J/(mol*K)\n        'k_B': k,  # J/K\n        'h': h,  # J*s\n        'm_e': m_e,  # kg\n        'E_ion_eV': 9.26,  # eV\n        'eV_to_J': 1.602176634e-19,  # J/eV\n        'F': 96485.0,  # J/mol/eV (approx. Faraday constant)\n        'dH_NO_rxn': -180500.0,  # J/mol\n        'dS_NO_rxn': -24.74,  # J/(mol*K)\n    }\n    CONSTS['E_ion_J'] = CONSTS['E_ion_eV'] * CONSTS['eV_to_J']\n\n    # Standard enthalpies of formation (J/mol) at T_ref\n    HF_O = {\n        'CH4': -74850.0, 'CO2': -393522.0, 'H2O': -241826.0,\n        'NO': 90250.0, 'O2': 0.0, 'N2': 0.0, 'e-': 0.0\n    }\n    HF_O['NO+'] = HF_O['NO'] + CONSTS['E_ion_eV'] * CONSTS['F']\n\n    # Heat capacity coefficients c_p(T) = a + bT; a in J/(mol*K), b in J/(mol*K^2)\n    CP_COEFFS = {\n        'CH4': (35.0, 0.0100), 'CO2': (37.0, 0.0030), 'H2O': (33.6, 0.0040),\n        'N2': (29.0, 0.0027), 'O2': (29.0, 0.0025), 'NO': (30.0, 0.0030),\n        'NO+': (30.0, 0.0030), 'e-': (20.786, 0.0)\n    }\n\n    test_cases = [\n        # (phi, p (Pa), T0 (K))\n        (0.85, 100000.0, 298.15),\n        (0.70, 100000.0, 298.15),\n        (0.85, 5000000.0, 298.15),\n        (0.85, 100000.0, 800.00),\n    ]\n\n    results = []\n    for phi, p, T0 in test_cases:\n        residual_func = create_residual_function(phi, p, T0, CONSTS, HF_O, CP_COEFFS)\n        \n        # Initial guess: [T (K), ln(n_NO), ln(n_NO+)]\n        x_guess = np.array([2100.0, -6.0, -25.0])\n        \n        # Levenberg-Marquardt ('lm') can be more robust for some problems\n        sol = root(residual_func, x_guess, method='hybr', tol=1e-8)\n        \n        if sol.success:\n            T_ad = sol.x[0]\n            results.append(f\"{T_ad:.1f}\")\n        else:\n            # Fallback for failed convergence, though not expected for these cases\n            results.append(\"NaN\")\n            \n    print(f\"[{','.join(results)}]\")\n\ndef create_residual_function(phi, p, T0, consts, hf_o, cp_coeffs):\n    \"\"\"\n    Factory function to create a residual function with problem parameters encapsulated.\n    \"\"\"\n    T_ref = consts['T_ref']\n\n    def sensible_enthalpy(T, species):\n        a, b = cp_coeffs[species]\n        return a * (T - T_ref) + 0.5 * b * (T**2 - T_ref**2)\n\n    # Reactant properties\n    n_CH4 = 1.0\n    n_O2_in = 2.0 / phi\n    n_N2_in = n_O2_in * (consts['x_N2'] / consts['x_O2'])\n    n_O2_ex = n_O2_in - 2.0\n    n_tot_in = n_CH4 + n_O2_in + n_N2_in\n\n    # Reactant enthalpy (constant for a given case)\n    H_in = (\n        n_CH4 * (hf_o['CH4'] + sensible_enthalpy(T0, 'CH4')) +\n        n_O2_in * sensible_enthalpy(T0, 'O2') +\n        n_N2_in * sensible_enthalpy(T0, 'N2')\n    )\n\n    def residual(x):\n        T, u1, u2 = x\n        \n        if T < 0:\n            return np.array([1e6, 1e6, 1e6])\n\n        n_NO = np.exp(u1)\n        n_NO_plus = np.exp(u2)\n        n_e = n_NO_plus\n\n        # Product mole numbers from element conservation\n        n_sum_NOx = n_NO + n_NO_plus\n        n_O2 = n_O2_ex - 0.5 * n_sum_NOx\n        n_N2 = n_N2_in - 0.5 * n_sum_NOx\n        \n        # Physicality constraints\n        if n_O2 <= 0 or n_N2 <= 0:\n            return np.array([1e6, 1e6, 1e6])\n\n        n_CO2 = 1.0\n        n_H2O = 2.0\n        n_tot = n_tot_in + n_NO_plus\n        \n        # --- Residual F0: Thermal NO equilibrium ---\n        ln_Kp_NO = -consts['dH_NO_rxn'] / (consts['R'] * T) + consts['dS_NO_rxn'] / consts['R']\n        F0 = ln_Kp_NO - (np.log(n_N2) + np.log(n_O2) - 2 * u1)\n        \n        # --- Residual F1: Saha ionization equilibrium ---\n        # S(T)*k*T/p term\n        S_T_term = 2.0 * ((2 * np.pi * consts['m_e'] * consts['k_B'] * T) / (consts['h']**2))**1.5\n        saha_factor = S_T_term * np.exp(-consts['E_ion_J'] / (consts['k_B'] * T)) * (consts['k_B'] * T / p)\n        \n        if saha_factor <= 0:\n            return np.array([1e6, 1e6, 1e6])\n            \n        ln_saha = np.log(saha_factor)\n        F1 = (2 * u2 - u1 - np.log(n_tot)) - ln_saha\n\n        # --- Residual F2: Energy balance ---\n        product_species = ['CO2', 'H2O', 'N2', 'O2', 'NO', 'NO+', 'e-']\n        product_moles = [n_CO2, n_H2O, n_N2, n_O2, n_NO, n_NO_plus, n_e]\n        \n        H_out = 0.0\n        for i, species in enumerate(product_species):\n            n_i = product_moles[i]\n            h_i = hf_o[species] + sensible_enthalpy(T, species)\n            H_out += n_i * h_i\n            \n        F2 = H_out - H_in\n        \n        return np.array([F0, F1, F2])\n\n    return residual\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}