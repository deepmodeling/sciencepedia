{
    "hands_on_practices": [
        {
            "introduction": "Before any computational solver can determine the final composition of a reacting mixture at equilibrium, the problem must be framed in a precise mathematical language. This foundational exercise guides you through this critical setup process . By applying the inviolable principle of element conservation to a realistic methane-air system, you will construct the system of linear equations that constrains the possible outcomes and, in doing so, determine the number of independent chemical reactions required to fully define the equilibrium state.",
            "id": "4072095",
            "problem": "A lean premixed methane–air mixture at equivalence ratio $\\phi=0.8$ is brought to thermodynamic equilibrium at fixed temperature $T$ and pressure $P$. Assume an ideal gas mixture and dry air with molar composition $y_{\\mathrm{O_2}}=0.21$ and $y_{\\mathrm{N_2}}=0.79$. Consider $1$ mol of initial methane, $\\mathrm{CH_4}$, premixed with air. For the equilibrium calculation, adopt the chemically plausible species set $\\mathcal{S}=\\{\\mathrm{CO_2},\\mathrm{CO},\\mathrm{H_2O},\\mathrm{H_2},\\mathrm{O_2},\\mathrm{O},\\mathrm{H},\\mathrm{OH},\\mathrm{N_2}\\}$ and neglect all other species and ionization. Treat nitrogen chemistry as frozen except for $\\mathrm{N_2}$.\n\nUsing only fundamental conservation of chemical elements and the definition of equivalence ratio, proceed as follows:\n\n1) From the definition of equivalence ratio and the stoichiometry of complete methane oxidation, determine the initial moles of $\\mathrm{O_2}$ and $\\mathrm{N_2}$ present per $1$ mol of $\\mathrm{CH_4}$ at $\\phi=0.8$.\n\n2) Formulate the elemental conservation constraints for elements $\\mathrm{C}$, $\\mathrm{H}$, $\\mathrm{O}$, and $\\mathrm{N}$ in the compact matrix form $\\mathbf{A}\\,\\mathbf{n}=\\mathbf{b}$, where $\\mathbf{n}$ collects the unknown equilibrium mole numbers of the species in $\\mathcal{S}$ and $\\mathbf{b}$ collects the total element moles implied by the initial mixture.\n\n3) Based on these constraints and the chosen species set, determine the minimum number of independent equilibrium-constant relations required to close a mass-action formulation for the composition at fixed $T$ and $P$.\n\nExpress the final answer as a single integer. No rounding is required. No units are needed for the final answer.",
            "solution": "The problem asks for the minimum number of independent equilibrium-constant relations required to determine the composition of a methane-air mixture at thermodynamic equilibrium. The solution to such a problem is found by balancing the number of unknown species concentrations with the number of available constraint equations. In a system at fixed temperature $T$ and pressure $P$, the unknowns are the mole numbers, $n_j$, of each of the $N_{species}$ species present at equilibrium.\n\nThese unknowns are subject to $K$ linear constraints imposed by the conservation of chemical elements. The number of independent elemental conservation equations, $K$, is equal to the rank of the atom matrix $\\mathbf{A}$, where $A_{ij}$ is the number of atoms of element $i$ in a molecule of species $j$.\n\nThe system of $N_{species}$ unknown mole numbers is therefore underdetermined by the $K$ elemental conservation equations alone. To close the system, we must introduce additional equations derived from the principle of chemical equilibrium. For a mass-action formulation, this is accomplished by specifying a set of $N_{reactions}$ independent chemical reactions. The law of mass action is then applied to each of these reactions, providing one equilibrium-constant relation per reaction. The minimum number of such relations required to close the system is the number of independent reactions, given by:\n$$N_{reactions} = N_{species} - K = N_{species} - \\text{rank}(\\mathbf{A})$$\nWe will now follow the steps outlined in the problem to determine this number.\n\n1) First, we determine the composition of the initial reactant mixture. The problem specifies $1$ mol of methane, $\\mathrm{CH_4}$, premixed with air at an equivalence ratio of $\\phi=0.8$. The stoichiometric (complete) oxidation of methane in air is:\n$$\\mathrm{CH_4} + a_{st}(\\mathrm{O_2} + \\frac{y_{\\mathrm{N_2}}}{y_{\\mathrm{O_2}}}\\mathrm{N_2}) \\rightarrow \\mathrm{CO_2} + 2\\mathrm{H_2O} + a_{st} \\frac{y_{\\mathrm{N_2}}}{y_{\\mathrm{O_2}}}\\mathrm{N_2}$$\nBalancing the oxygen atoms gives $2 = a_{st} \\times 2$, so the stoichiometric oxygen-to-fuel mole ratio is $a_{st} = 2$.\n\nThe equivalence ratio $\\phi$ is defined as the actual fuel-to-oxidizer ratio divided by the stoichiometric fuel-to-oxidizer ratio. Using moles of $\\mathrm{O_2}$ as the measure of the oxidizer:\n$$\\phi = \\frac{(\\text{moles of fuel} / \\text{moles of } \\mathrm{O_2})_{actual}}{(\\text{moles of fuel} / \\text{moles of } \\mathrm{O_2})_{st}} = \\frac{(1 / a_{actual})}{(1 / a_{st})} = \\frac{a_{st}}{a_{actual}}$$\nGiven $\\phi=0.8$ and $a_{st}=2$, we find the actual moles of $\\mathrm{O_2}$ per mole of $\\mathrm{CH_4}$:\n$$a_{actual} = \\frac{a_{st}}{\\phi} = \\frac{2}{0.8} = 2.5$$\nSo, the initial mixture contains $2.5$ mol of $\\mathrm{O_2}$. The moles of $\\mathrm{N_2}$ are determined by the composition of air:\n$$n_{\\mathrm{N_2,init}} = a_{actual} \\times \\frac{y_{\\mathrm{N_2}}}{y_{\\mathrm{O_2}}} = 2.5 \\times \\frac{0.79}{0.21}$$\nThe initial reactant mixture is $1\\,\\mathrm{CH_4} + 2.5\\,\\mathrm{O_2} + (2.5 \\times \\frac{0.79}{0.21})\\,\\mathrm{N_2}$.\n\n2) Next, we formulate the elemental conservation constraints in the form $\\mathbf{A}\\,\\mathbf{n}=\\mathbf{b}$. The set of plausible equilibrium species is given as $\\mathcal{S}=\\{\\mathrm{CO_2},\\mathrm{CO},\\mathrm{H_2O},\\mathrm{H_2},\\mathrm{O_2},\\mathrm{O},\\mathrm{H},\\mathrm{OH},\\mathrm{N_2}\\}$. The number of species is $N_{species} = 9$. The vector of unknown equilibrium mole numbers is:\n$$\\mathbf{n} = \\begin{pmatrix} n_{\\mathrm{CO_2}} \\\\ n_{\\mathrm{CO}} \\\\ n_{\\mathrm{H_2O}} \\\\ n_{\\mathrm{H_2}} \\\\ n_{\\mathrm{O_2}} \\\\ n_{\\mathrm{O}} \\\\ n_{\\mathrm{H}} \\\\ n_{\\mathrm{OH}} \\\\ n_{\\mathrm{N_2}} \\end{pmatrix}$$\nThe vector $\\mathbf{b}$ contains the total moles of each element (C, H, O, N) in the initial mixture. Based on $1\\,\\mathrm{CH_4} + 2.5\\,\\mathrm{O_2} + (2.5 \\times \\frac{0.79}{0.21})\\,\\mathrm{N_2}$:\n$b_C = 1 \\times (\\text{moles of } \\mathrm{CH_4}) = 1$\n$b_H = 4 \\times (\\text{moles of } \\mathrm{CH_4}) = 4$\n$b_O = 2 \\times (\\text{moles of } \\mathrm{O_2}) = 2 \\times 2.5 = 5$\n$b_N = 2 \\times (\\text{moles of } \\mathrm{N_2}) = 2 \\times (2.5 \\times \\frac{0.79}{0.21}) = \\frac{3.95}{0.21}$\nSo, $\\mathbf{b} = [1, 4, 5, \\frac{3.95}{0.21}]^T$.\n\nThe atom matrix $\\mathbf{A}$ has its rows corresponding to the elements (C, H, O, N) and columns corresponding to the species in $\\mathbf{n}$. The entry $A_{ij}$ is the number of atoms of element $i$ in species $j$.\n$$\\mathbf{A} = \\begin{pmatrix}\n1  1  0  0  0  0  0  0  0 \\\\\n0  0  2  2  0  0  1  1  0 \\\\\n2  1  1  0  2  1  0  1  0 \\\\\n0  0  0  0  0  0  0  0  2\n\\end{pmatrix}$$\n\n3) Finally, we determine the minimum number of independent equilibrium-constant relations, which is $N_{species} - \\text{rank}(\\mathbf{A})$. We have $N_{species}=9$. We must find the rank of the $4 \\times 9$ matrix $\\mathbf{A}$. The rank is the number of linearly independent rows or columns. The four rows represent the conservation of four distinct chemical elements: C, H, O, and N. We can formally prove their linear independence. A linear combination of the rows is zero if $c_1 \\mathbf{r}_1 + c_2 \\mathbf{r}_2 + c_3 \\mathbf{r}_3 + c_4 \\mathbf{r}_4 = \\mathbf{0}$, where $\\mathbf{r}_i$ is the $i$-th row.\nLooking at the 9th column, we have $c_4 \\cdot 2 = 0$, which implies $c_4=0$.\nLooking at the 1st column, we have $c_1 \\cdot 1 + c_3 \\cdot 2 = 0$.\nLooking at the 2nd column, we have $c_1 \\cdot 1 + c_3 \\cdot 1 = 0$.\nSubtracting the second equation from the first gives $c_3=0$, which in turn implies $c_1=0$.\nLooking at the 3rd column, with $c_1=c_3=0$, we have $c_2 \\cdot 2 = 0$, which implies $c_2=0$.\nSince $c_1=c_2=c_3=c_4=0$ is the only solution, the four row vectors are linearly independent. Therefore, the rank of matrix $\\mathbf{A}$ is $4$.\n\nAn alternative method is to find a $4 \\times 4$ submatrix with a non-zero determinant. Let us select the columns corresponding to the species $\\mathrm{CO_2}$, $\\mathrm{H_2O}$, $\\mathrm{O_2}$, and $\\mathrm{N_2}$ (columns 1, 3, 5, and 9):\n$$\\begin{vmatrix}\n1  0  0  0 \\\\\n0  2  0  0 \\\\\n2  1  2  0 \\\\\n0  0  0  2\n\\end{vmatrix} = 1 \\cdot 2 \\cdot 2 \\cdot 2 = 8$$\nSince the determinant is non-zero, the rank of $\\mathbf{A}$ is at least $4$. As the matrix has only $4$ rows, its rank cannot exceed $4$. Thus, $\\text{rank}(\\mathbf{A}) = 4$.\n\nThe number of independent equilibrium-constant relations is:\n$$N_{reactions} = N_{species} - \\text{rank}(\\mathbf{A}) = 9 - 4 = 5$$\nThis is the number of independent reactions that can be formed among the $9$ species, and it represents the number of additional non-linear equations required to solve for the equilibrium mole numbers, in addition to the $4$ linear elemental conservation constraints.",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "With the mathematical framework established, the next step is to compute the equilibrium constants, $K(T)$, which govern the balance of species. These constants are not arbitrary parameters but are fundamentally determined by the change in standard Gibbs free energy, $\\Delta G^{\\circ}(T)$. This practice provides direct, hands-on experience with the gold standard in combustion thermochemistry: the 7-coefficient NASA polynomials . You will implement the formulas to compute enthalpy, entropy, and Gibbs free energy from these polynomials, thereby gaining a practical understanding of how thermochemical data libraries are used to calculate equilibrium constants as a function of temperature.",
            "id": "4072073",
            "problem": "Consider the elementary gas-phase reaction under standard-state conditions at a pressure of $1\\,\\mathrm{bar}$,\n$$\\mathrm{CO} + \\tfrac{1}{2}\\,\\mathrm{O_2} \\rightleftharpoons \\mathrm{CO_2}.$$\nStarting from the fundamental definitions that the molar enthalpy satisfies $c_p(T) = \\left(\\partial h/\\partial T\\right)_p$ and that the standard chemical potential satisfies $\\mu_i^\\circ(T) = h_i^\\circ(T) - T\\,s_i^\\circ(T)$, and the equilibrium condition $\\Delta G^\\circ(T) = - R T \\ln K(T)$, derive an algorithm that computes the standard-state reaction thermodynamics and equilibrium constant from temperature-dependent heat capacity data. Use well-tested polynomial representations for ideal-gas thermochemistry as follows.\n\nFor each species, use the seven-coefficient National Aeronautics and Space Administration (NASA) ideal-gas polynomial forms over two temperature intervals, a low-temperature range $[200,1000]\\,\\mathrm{K}$ and a high-temperature range $[1000,6000]\\,\\mathrm{K}$. For a given temperature $T$, use the low-range coefficients if $T  1000\\,\\mathrm{K}$ and the high-range coefficients if $T \\ge 1000\\,\\mathrm{K}$. The nondimensional standard properties are given by\n$$\\frac{c_p^\\circ(T)}{R} = a_1 + a_2\\,T + a_3\\,T^2 + a_4\\,T^3 + a_5\\,T^4,$$\n$$\\frac{h^\\circ(T)}{R\\,T} = a_1 + a_2\\,\\frac{T}{2} + a_3\\,\\frac{T^2}{3} + a_4\\,\\frac{T^3}{4} + a_5\\,\\frac{T^4}{5} + \\frac{a_6}{T},$$\n$$\\frac{s^\\circ(T)}{R} = a_1 \\ln T + a_2\\,T + a_3\\,\\frac{T^2}{2} + a_4\\,\\frac{T^3}{3} + a_5\\,\\frac{T^4}{4} + a_7,$$\nwhere $R$ is the universal gas constant. Use $R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nUse the following validated coefficient sets for each species, where each $a_j$ is specified for both temperature ranges. All numbers are in the standard NASA units implied by the above formulas.\n\n- For $\\mathrm{CO_2}$:\n  - Low range $[200,1000]\\,\\mathrm{K}$: $a_1 = 2.35677352\\times 10^{0}$, $a_2 = 8.98459677\\times 10^{-3}$, $a_3 = -7.12356269\\times 10^{-6}$, $a_4 = 2.45919022\\times 10^{-9}$, $a_5 = -1.43699548\\times 10^{-13}$, $a_6 = -4.83719697\\times 10^{4}$, $a_7 = 9.90105222\\times 10^{0}$.\n  - High range $[1000,6000]\\,\\mathrm{K}$: $a_1 = 3.85796028\\times 10^{0}$, $a_2 = 4.41437026\\times 10^{-3}$, $a_3 = -2.21481404\\times 10^{-6}$, $a_4 = 5.23490188\\times 10^{-10}$, $a_5 = -4.72084164\\times 10^{-14}$, $a_6 = -4.87591660\\times 10^{4}$, $a_7 = 2.27163806\\times 10^{0}$.\n\n- For $\\mathrm{CO}$:\n  - Low range $[200,1000]\\,\\mathrm{K}$: $a_1 = 3.57953347\\times 10^{0}$, $a_2 = -6.10353680\\times 10^{-4}$, $a_3 = 1.01681433\\times 10^{-6}$, $a_4 = 9.07005884\\times 10^{-10}$, $a_5 = -9.04424499\\times 10^{-13}$, $a_6 = -1.43440860\\times 10^{4}$, $a_7 = 3.50840928\\times 10^{0}$.\n  - High range $[1000,6000]\\,\\mathrm{K}$: $a_1 = 2.71518561\\times 10^{0}$, $a_2 = 2.06252743\\times 10^{-3}$, $a_3 = -9.98825771\\times 10^{-7}$, $a_4 = 2.30053008\\times 10^{-10}$, $a_5 = -2.03647716\\times 10^{-14}$, $a_6 = -1.41518724\\times 10^{4}$, $a_7 = 7.81868772\\times 10^{0}$.\n\n- For $\\mathrm{O_2}$:\n  - Low range $[200,1000]\\,\\mathrm{K}$: $a_1 = 3.78245636\\times 10^{0}$, $a_2 = -2.99673416\\times 10^{-3}$, $a_3 = 9.84730201\\times 10^{-6}$, $a_4 = -9.68129509\\times 10^{-9}$, $a_5 = 3.24372837\\times 10^{-12}$, $a_6 = -1.06394356\\times 10^{3}$, $a_7 = 3.65767573\\times 10^{0}$.\n  - High range $[1000,6000]\\,\\mathrm{K}$: $a_1 = 3.28253784\\times 10^{0}$, $a_2 = 1.48308754\\times 10^{-3}$, $a_3 = -7.57966669\\times 10^{-7}$, $a_4 = 2.09470555\\times 10^{-10}$, $a_5 = -2.16717794\\times 10^{-14}$, $a_6 = -1.08845772\\times 10^{3}$, $a_7 = 5.45323129\\times 10^{0}$.\n\nFor each test temperature $T$, compute:\n- The standard-state reaction enthalpy change $\\Delta H^\\circ(T)$ in $\\mathrm{kJ\\,mol^{-1}}$.\n- The standard-state reaction entropy change $\\Delta S^\\circ(T)$ in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- The standard-state reaction Gibbs free energy change $\\Delta G^\\circ(T)$ in $\\mathrm{kJ\\,mol^{-1}}$.\n- The dimensionless equilibrium constant $K(T)$ at standard state of $1\\,\\mathrm{bar}$, defined by $K(T) = \\exp\\!\\left(-\\Delta G^\\circ(T)/(R T)\\right)$.\n\nUse the stoichiometric coefficients $\\nu_{\\mathrm{CO_2}} = +1$, $\\nu_{\\mathrm{CO}} = -1$, and $\\nu_{\\mathrm{O_2}} = -\\tfrac{1}{2}$ so that $\\Delta H^\\circ(T) = \\sum_i \\nu_i h_i^\\circ(T)$ and $\\Delta S^\\circ(T) = \\sum_i \\nu_i s_i^\\circ(T)$.\n\nTest suite:\n- $T = 298.15\\,\\mathrm{K}$ (room temperature reference).\n- $T = 1000.0\\,\\mathrm{K}$ (NASA range boundary).\n- $T = 1500.0\\,\\mathrm{K}$ (high-temperature combustion regime).\n- $T = 3000.0\\,\\mathrm{K}$ (very high temperature).\n- $T = 6000.0\\,\\mathrm{K}$ (upper validity limit).\n- $T = 200.0\\,\\mathrm{K}$ (lower validity limit).\n\nYour program must:\n- Implement the above thermodynamic relations without using any hard-coded shortcut formulas for $\\Delta G^\\circ$ or $K(T)$ beyond the definitions given.\n- Use the provided coefficients exactly and $R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- For each test temperature, report a list containing $[T, \\Delta H^\\circ(T), \\Delta S^\\circ(T), \\Delta G^\\circ(T), K(T)]$ where $T$ is in $\\mathrm{K}$, $\\Delta H^\\circ$ and $\\Delta G^\\circ$ are in $\\mathrm{kJ\\,mol^{-1}}$, and $\\Delta S^\\circ$ is in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Round each floating-point number to $6$ significant digits.\n- Produce a single line of output containing the results as a comma-separated list of these per-temperature lists, enclosed in square brackets, for example $[[\\dots],[\\dots],\\dots]$ with no spaces.\n\nAngle units are not applicable. No percentages are involved; any fractional values must be represented in decimal form.\n\nYour task is to produce the final single-line output for the full test suite. The program must be fully self-contained and require no user input or external files.",
            "solution": "The problem requires the computation of standard-state thermodynamic properties ($\\Delta H^\\circ(T)$, $\\Delta S^\\circ(T)$, $\\Delta G^\\circ(T)$) and the equilibrium constant ($K(T)$) for the gas-phase reaction $\\mathrm{CO} + \\tfrac{1}{2}\\,\\mathrm{O_2} \\rightleftharpoons \\mathrm{CO_2}$ at several specified temperatures. The calculation will be based on the provided seven-coefficient NASA polynomials for the temperature-dependent ideal-gas properties of each species.\n\nThe validation of the problem statement confirms that it is scientifically grounded, well-posed, and contains all necessary information to proceed. The provided thermodynamic relations and data are consistent with established principles of physical chemistry and computational thermodynamics.\n\nThe algorithmic approach is designed to systematically compute the required quantities, starting from the fundamental definitions provided.\n\nFirst, we establish the procedure for calculating the standard molar properties of an individual species $i$ at a given temperature $T$. The problem provides polynomial expressions for the dimensionless specific heat capacity $c_p^\\circ(T)/R$, dimensionless enthalpy $h^\\circ(T)/(RT)$, and dimensionless entropy $s^\\circ(T)/R$. For a given species and temperature $T$, we first select the appropriate set of seven coefficients $\\{a_1, a_2, a_3, a_4, a_5, a_6, a_7\\}$ based on the temperature range: the low-range set for $T \\in [200\\,\\mathrm{K}, 1000\\,\\mathrm{K})$ and the high-range set for $T \\in [1000\\,\\mathrm{K}, 6000\\,\\mathrm{K}]$.\n\nThe standard molar enthalpy $h_i^\\circ(T)$ for species $i$ is calculated by rearranging the provided formula:\n$$h_i^\\circ(T) = R\\,T \\left( a_1 + a_{2,i}\\,\\frac{T}{2} + a_{3,i}\\,\\frac{T^2}{3} + a_{4,i}\\,\\frac{T^3}{4} + a_{5,i}\\,\\frac{T^4}{5} + \\frac{a_{6,i}}{T} \\right)$$\nThe standard molar entropy $s_i^\\circ(T)$ for species $i$ is similarly calculated from its defining polynomial:\n$$s_i^\\circ(T) = R \\left( a_{1,i} \\ln T + a_{2,i}\\,T + a_{3,i}\\,\\frac{T^2}{2} + a_{4,i}\\,\\frac{T^3}{3} + a_{5,i}\\,\\frac{T^4}{4} + a_{7,i} \\right)$$\nIn these calculations, $R$ is the universal gas constant, $R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The resulting $h_i^\\circ(T)$ is in units of $\\mathrm{J\\,mol^{-1}}$ and $s_i^\\circ(T)$ is in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nNext, we compute the standard-state change of these properties for the overall reaction. The change in any extensive property $X$ for a reaction is given by $\\Delta X = \\sum_i \\nu_i X_i$, where $\\nu_i$ are the stoichiometric coefficients of the species $i$. For the reaction $\\mathrm{CO} + \\tfrac{1}{2}\\,\\mathrm{O_2} \\rightleftharpoons \\mathrm{CO_2}$, the stoichiometric coefficients are given as $\\nu_{\\mathrm{CO_2}} = +1$, $\\nu_{\\mathrm{CO}} = -1$, and $\\nu_{\\mathrm{O_2}} = -\\tfrac{1}{2}$.\n\nThe standard reaction enthalpy change, $\\Delta H^\\circ(T)$, is computed as:\n$$\\Delta H^\\circ(T) = \\sum_i \\nu_i h_i^\\circ(T) = (1) \\cdot h_{\\mathrm{CO_2}}^\\circ(T) + (-1) \\cdot h_{\\mathrm{CO}}^\\circ(T) + (-\\tfrac{1}{2}) \\cdot h_{\\mathrm{O_2}}^\\circ(T)$$\nThe standard reaction entropy change, $\\Delta S^\\circ(T)$, is computed as:\n$$\\Delta S^\\circ(T) = \\sum_i \\nu_i s_i^\\circ(T) = (1) \\cdot s_{\\mathrm{CO_2}}^\\circ(T) + (-1) \\cdot s_{\\mathrm{CO}}^\\circ(T) + (-\\tfrac{1}{2}) \\cdot s_{\\mathrm{O_2}}^\\circ(T)$$\nThe standard reaction Gibbs free energy change, $\\Delta G^\\circ(T)$, is derived from the fundamental definition of the standard chemical potential, $\\mu_i^\\circ(T) = h_i^\\circ(T) - T\\,s_i^\\circ(T)$. The reaction Gibbs free energy change is thus:\n$$\\Delta G^\\circ(T) = \\sum_i \\nu_i \\mu_i^\\circ(T) = \\sum_i \\nu_i (h_i^\\circ(T) - T\\,s_i^\\circ(T)) = \\left(\\sum_i \\nu_i h_i^\\circ(T)\\right) - T\\left(\\sum_i \\nu_i s_i^\\circ(T)\\right)$$\nThis simplifies to the well-known relation:\n$$\\Delta G^\\circ(T) = \\Delta H^\\circ(T) - T\\,\\Delta S^\\circ(T)$$\nThis relation is used to calculate $\\Delta G^\\circ(T)$ from the previously computed reaction enthalpy and entropy.\n\nFinally, the dimensionless equilibrium constant, $K(T)$, is calculated using the provided relationship with the Gibbs free energy change:\n$$\\Delta G^\\circ(T) = -R T \\ln K(T)$$\nRearranging for $K(T)$ gives:\n$$K(T) = \\exp\\left(-\\frac{\\Delta G^\\circ(T)}{R T}\\right)$$\nFor this calculation, it is crucial that $\\Delta G^\\circ(T)$, $R$, and $T$ are in consistent units (e.g., $\\Delta G^\\circ(T)$ in $\\mathrm{J\\,mol^{-1}}$, $R$ in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and $T$ in $\\mathrm{K}$).\n\nThe implementation will consist of:\n1.  Storing the NASA coefficients and stoichiometric coefficients in suitable data structures.\n2.  A function that, for a given species and temperature, selects the correct coefficients and computes $h^\\circ(T)$ and $s^\\circ(T)$.\n3.  A main loop that iterates through each temperature in the test suite.\n4.  Within this loop, invoking the species-property function for $\\mathrm{CO_2}$, $\\mathrm{CO}$, and $\\mathrm{O_2}$, and then calculating $\\Delta H^\\circ(T)$, $\\Delta S^\\circ(T)$, and subsequently $\\Delta G^\\circ(T)$ and $K(T)$.\n5.  Converting the results to the specified output units: $\\Delta H^\\circ(T)$ and $\\Delta G^\\circ(T)$ to $\\mathrm{kJ\\,mol^{-1}}$ by dividing by $1000$.\n6.  Rounding all floating-point numbers in the final output list to 6 significant digits.\n7.  Formatting the final results as a single-line string representing a list of lists, with no spaces, as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes thermodynamic properties for the reaction CO + 0.5 O2 = CO2\n    using 7-coefficient NASA polynomials.\n    \"\"\"\n    \n    # Universal Gas Constant in J mol^-1 K^-1\n    R = 8.31446261815324\n\n    # NASA 7-coefficient polynomial data for each species.\n    # Structure: {species: {'low': [coeffs], 'high': [coeffs]}}\n    # where the ranges are low=[200,1000) K and high=[1000,6000] K.\n    nasa_coeffs = {\n        'CO2': {\n            'low': [2.35677352e+00, 8.98459677e-03, -7.12356269e-06, 2.45919022e-09, -1.43699548e-13, -4.83719697e+04, 9.90105222e+00],\n            'high': [3.85796028e+00, 4.41437026e-03, -2.21481404e-06, 5.23490188e-10, -4.72084164e-14, -4.87591660e+04, 2.27163806e+00]\n        },\n        'CO': {\n            'low': [3.57953347e+00, -6.10353680e-04, 1.01681433e-06, 9.07005884e-10, -9.04424499e-13, -1.43440860e+04, 3.50840928e+00],\n            'high': [2.71518561e+00, 2.06252743e-03, -9.98825771e-07, 2.30053008e-10, -2.03647716e-14, -1.41518724e+04, 7.81868772e+00]\n        },\n        'O2': {\n            'low': [3.78245636e+00, -2.99673416e-03, 9.84730201e-06, -9.68129509e-09, 3.24372837e-12, -1.06394356e+03, 3.65767573e+00],\n            'high': [3.28253784e+00, 1.48308754e-03, -7.57966669e-07, 2.09470555e-10, -2.16717794e-14, -1.08845772e+03, 5.45323129e+00]\n        }\n    }\n\n    # Stoichiometric coefficients for the reaction CO + 0.5 O2 = CO2\n    stoich = {'CO2': 1.0, 'CO': -1.0, 'O2': -0.5}\n\n    # Test temperatures in Kelvin, as specified in the problem statement.\n    test_cases = [298.15, 1000.0, 1500.0, 3000.0, 6000.0, 200.0]\n\n    def round_to_sf(num, sig_figs):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if num == 0:\n            return 0.0\n        # Use format string specifier 'g' for robust significant figure handling.\n        return float(f'{num:.{sig_figs}g}')\n\n    def get_species_properties(species, T):\n        \"\"\"Calculates standard molar enthalpy and entropy for a species at T.\"\"\"\n        if T  1000.0:\n            coeffs = nasa_coeffs[species]['low']\n        else:  # T >= 1000.0\n            coeffs = nasa_coeffs[species]['high']\n\n        a1, a2, a3, a4, a5, a6, a7 = coeffs\n        \n        T2 = T * T\n        T3 = T2 * T\n        T4 = T3 * T\n\n        # Calculate standard molar enthalpy h_i(T) in J/mol\n        # h/RT = a1 + a2*T/2 + a3*T^2/3 + a4*T^3/4 + a5*T^4/5 + a6/T\n        h_over_RT = (a1 + a2 * T / 2.0 + a3 * T2 / 3.0 + a4 * T3 / 4.0 + a5 * T4 / 5.0 + a6 / T)\n        h = h_over_RT * R * T\n\n        # Calculate standard molar entropy s_i(T) in J/mol-K\n        # s/R = a1*ln(T) + a2*T + a3*T^2/2 + a4*T^3/3 + a5*T^4/4 + a7\n        s_over_R = (a1 * np.log(T) + a2 * T + a3 * T2 / 2.0 + a4 * T3 / 3.0 + a5 * T4 / 4.0 + a7)\n        s = s_over_R * R\n\n        return h, s\n\n    all_results = []\n    for T in test_cases:\n        delta_H_reaction = 0.0  # in J/mol\n        delta_S_reaction = 0.0  # in J/mol-K\n\n        for species, nu in stoich.items():\n            h_species, s_species = get_species_properties(species, T)\n            delta_H_reaction += nu * h_species\n            delta_S_reaction += nu * s_species\n\n        # Calculate standard reaction Gibbs free energy in J/mol\n        delta_G_reaction = delta_H_reaction - T * delta_S_reaction\n\n        # Calculate dimensionless equilibrium constant K(T)\n        K = np.exp(-delta_G_reaction / (R * T))\n\n        # Convert energies to kJ/mol for output\n        delta_H_kj = delta_H_reaction / 1000.0\n        delta_G_kj = delta_G_reaction / 1000.0\n\n        # Round all output values to 6 significant figures\n        result_row = [\n            round_to_sf(T, 6),\n            round_to_sf(delta_H_kj, 6),\n            round_to_sf(delta_S_reaction, 6),\n            round_to_sf(delta_G_kj, 6),\n            round_to_sf(K, 6)\n        ]\n        all_results.append(result_row)\n\n    # Format the final output string as a list of lists with no spaces\n    output_str = f\"[{','.join([f'[{\",\".join(map(str, res))}]' for res in all_results])}]\"\n    \n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "A calculated equilibrium composition is only as reliable as the thermodynamic data it is based on, which in real-world applications always has some degree of uncertainty. This advanced practice introduces the essential engineering and scientific skill of sensitivity analysis . Using the powerful technique of linearization, you will learn to quantify how a small uncertainty in a fundamental property, like a species' enthalpy of formation, propagates to affect the final predicted equilibrium mole fractions, providing crucial insight into the robustness of your model.",
            "id": "4072059",
            "problem": "Consider the gas-phase reaction $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$ at constant temperature $T$ and pressure $p$, modeled as an ideal gas mixture. An initially prepared mixture contains $1$ $\\mathrm{mol}$ of $\\mathrm{CO_2}$ and $1$ $\\mathrm{mol}$ of $\\mathrm{H_2}$, with no $\\mathrm{CO}$ or $\\mathrm{H_2O}$ present. The system is brought to thermodynamic equilibrium at $T = 1200 \\ \\mathrm{K}$ and $p = 1 \\ \\mathrm{bar}$. At this temperature, the reaction’s equilibrium constant in terms of partial pressures, $K_p$, has been determined (from standard thermochemical data) to equal $1$.\n\nSuppose now that the standard enthalpy of formation of water vapor at the same temperature, $\\Delta H_f^\\circ(\\mathrm{H_2O}, T)$, is subject to a small uncertain perturbation. Assume the uncertainty affects only the enthalpy, not the standard entropy of formation, so that the resulting perturbation of the reaction’s standard Gibbs free energy change is $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = \\nu_{\\mathrm{H_2O}} \\, \\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T)$, where $\\nu_{\\mathrm{H_2O}}$ is the stoichiometric coefficient of $\\mathrm{H_2O}$ in the reaction. The universal gas constant is $R = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$.\n\nUsing linearization of the mass-action equations about the nominal equilibrium state at $K_p = 1$, quantify the first-order change in the equilibrium mole fraction of carbon monoxide, $\\delta y_{\\mathrm{CO}}$, caused by a positive perturbation $\\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T) = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$. Express your answer as a decimal, and round to four significant figures. The final answer must be given without units.",
            "solution": "The problem is first validated.\n\n*   **Givens Extraction**:\n    *   Reaction: $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$\n    *   Phase: Gas phase, ideal gas mixture.\n    *   Conditions: Constant temperature $T = 1200 \\ \\mathrm{K}$ and pressure $p = 1 \\ \\mathrm{bar}$.\n    *   Initial composition: $n_{\\mathrm{CO_2},0} = 1 \\ \\mathrm{mol}$, $n_{\\mathrm{H_2},0} = 1 \\ \\mathrm{mol}$, $n_{\\mathrm{CO},0} = 0 \\ \\mathrm{mol}$, $n_{\\mathrm{H_2O},0} = 0 \\ \\mathrm{mol}$.\n    *   Nominal equilibrium constant: $K_p = 1$.\n    *   Perturbation expression: $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = \\nu_{\\mathrm{H_2O}} \\, \\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T)$.\n    *   Perturbation magnitude: $\\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T) = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$.\n    *   Constant: $R = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$.\n    *   Objective: Find the first-order change in the equilibrium mole fraction of carbon monoxide, $\\delta y_{\\mathrm{CO}}$, using linearization.\n\n*   **Validation**:\n    *   The problem is scientifically grounded in the principles of chemical thermodynamics, specifically the law of mass action and the relationship between Gibbs free energy and the equilibrium constant.\n    *   The reaction is the well-known water-gas shift reaction, and the given conditions are physically plausible.\n    *   The problem is well-posed, providing all necessary data and a clear objective. It specifies the method of linearization, which is a standard analytical technique.\n    *   The setup is internally consistent and free of ambiguities.\n    *   The problem is deemed **valid**.\n\nThe solution proceeds as follows.\n\nFirst, we characterize the nominal equilibrium state. Let $\\xi$ be the extent of reaction in moles. Based on the stoichiometry of $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$ and the initial amounts, the number of moles of each species at equilibrium is:\n$n_{\\mathrm{CO_2}} = 1 - \\xi$\n$n_{\\mathrm{H_2}} = 1 - \\xi$\n$n_{\\mathrm{CO}} = \\xi$\n$n_{\\mathrm{H_2O}} = \\xi$\n\nThe total number of moles in the mixture is $N_{tot} = (1 - \\xi) + (1 - \\xi) + \\xi + \\xi = 2$. The total number of moles is constant throughout the reaction.\n\nThe mole fraction of each species $i$, $y_i$, is given by $y_i = n_i / N_{tot}$.\n$y_{\\mathrm{CO_2}} = \\frac{1 - \\xi}{2}$\n$y_{\\mathrm{H_2}} = \\frac{1 - \\xi}{2}$\n$y_{\\mathrm{CO}} = \\frac{\\xi}{2}$\n$y_{\\mathrm{H_2O}} = \\frac{\\xi}{2}$\n\nThe equilibrium constant in terms of partial pressures, $K_p$, is defined as:\n$$K_p = \\frac{p_{\\mathrm{CO}} p_{\\mathrm{H_2O}}}{p_{\\mathrm{CO_2}} p_{\\mathrm{H_2}}}$$\nUsing Dalton's law, the partial pressure of species $i$ is $p_i = y_i p$.\n$$K_p = \\frac{(y_{\\mathrm{CO}} p) (y_{\\mathrm{H_2O}} p)}{(y_{\\mathrm{CO_2}} p) (y_{\\mathrm{H_2}} p)} = \\frac{y_{\\mathrm{CO}} y_{\\mathrm{H_2O}}}{y_{\\mathrm{CO_2}} y_{\\mathrm{H_2}}} p^{(1+1)-(1+1)} = \\frac{y_{\\mathrm{CO}} y_{\\mathrm{H_2O}}}{y_{\\mathrm{CO_2}} y_{\\mathrm{H_2}}}$$\nSince the sum of stoichiometric coefficients of products minus reactants, $\\Delta \\nu_g$, is $0$, $K_p$ is independent of pressure and equal to the equilibrium constant in terms of mole fractions, $K_y$.\n\nSubstituting the expressions for mole fractions in terms of $\\xi$:\n$$K_p = \\frac{(\\frac{\\xi}{2})(\\frac{\\xi}{2})}{(\\frac{1-\\xi}{2})(\\frac{1-\\xi}{2})} = \\frac{\\xi^2}{(1-\\xi)^2} = \\left(\\frac{\\xi}{1-\\xi}\\right)^2$$\n\nFor the nominal equilibrium state, we are given $K_p = 1$. Solving for the nominal equilibrium extent of reaction, $\\xi_{eq}$:\n$$1 = \\left(\\frac{\\xi_{eq}}{1-\\xi_{eq}}\\right)^2$$\nSince $\\xi_{eq}$ must be positive (as products are formed from zero initial amounts), we take the positive square root:\n$$1 = \\frac{\\xi_{eq}}{1-\\xi_{eq}} \\implies 1 - \\xi_{eq} = \\xi_{eq} \\implies 2\\xi_{eq} = 1 \\implies \\xi_{eq} = 0.5 \\ \\mathrm{mol}$$\nThe nominal equilibrium mole fraction of carbon monoxide, $y_{\\mathrm{CO},eq}$, is:\n$$y_{\\mathrm{CO},eq} = \\frac{\\xi_{eq}}{2} = \\frac{0.5}{2} = 0.25$$\n\nNext, we analyze the effect of the perturbation. We need to find the first-order change $\\delta y_{\\mathrm{CO}}$. Since $y_{\\mathrm{CO}} = \\xi/2$, the change is given by $\\delta y_{\\mathrm{CO}} = \\frac{1}{2} \\delta \\xi$. We need to find $\\delta \\xi$.\nWe use linearization to relate a small change in $K_p$, $\\delta K_p$, to the resulting change in $\\xi$, $\\delta \\xi$:\n$$\\delta K_p \\approx \\left(\\frac{dK_p}{d\\xi}\\right)_{\\xi_{eq}} \\delta \\xi$$\nWe must compute the derivative of $K_p$ with respect to $\\xi$:\n$$\\frac{dK_p}{d\\xi} = \\frac{d}{d\\xi} \\left[ ( \\xi (1-\\xi)^{-1} )^2 \\right] = 2\\left(\\frac{\\xi}{1-\\xi}\\right) \\frac{d}{d\\xi}\\left(\\frac{\\xi}{1-\\xi}\\right) = 2\\left(\\frac{\\xi}{1-\\xi}\\right) \\frac{(1)(1-\\xi) - (\\xi)(-1)}{(1-\\xi)^2} = 2\\left(\\frac{\\xi}{1-\\xi}\\right) \\frac{1}{(1-\\xi)^2} = \\frac{2\\xi}{(1-\\xi)^3}$$\nEvaluating this derivative at the nominal equilibrium point $\\xi_{eq} = 0.5$:\n$$\\left(\\frac{dK_p}{d\\xi}\\right)_{\\xi_{eq}=0.5} = \\frac{2(0.5)}{(1 - 0.5)^3} = \\frac{1}{(0.5)^3} = \\frac{1}{0.125} = 8$$\nThus, $\\delta \\xi \\approx \\frac{\\delta K_p}{8}$.\n\nNow, we must find $\\delta K_p$ resulting from the perturbation in the standard Gibbs free energy of reaction, $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ$. The relationship is:\n$$\\Delta G_{\\mathrm{rxn}}^\\circ = -RT \\ln K_p \\implies K_p = \\exp\\left(-\\frac{\\Delta G_{\\mathrm{rxn}}^\\circ}{RT}\\right)$$\nLinearizing this relationship:\n$$\\delta K_p \\approx \\left(\\frac{dK_p}{d(\\Delta G_{\\mathrm{rxn}}^\\circ)}\\right)_{\\text{nom}} \\delta \\Delta G_{\\mathrm{rxn}}^\\circ$$\nThe derivative is:\n$$\\frac{dK_p}{d(\\Delta G_{\\mathrm{rxn}}^\\circ)} = \\exp\\left(-\\frac{\\Delta G_{\\mathrm{rxn}}^\\circ}{RT}\\right) \\left(-\\frac{1}{RT}\\right) = -\\frac{K_p}{RT}$$\nAt the nominal state, $K_p = 1$, so:\n$$\\left(\\frac{dK_p}{d(\\Delta G_{\\mathrm{rxn}}^\\circ)}\\right)_{\\text{nom}} = -\\frac{1}{RT}$$\nTherefore, $\\delta K_p \\approx -\\frac{\\delta \\Delta G_{\\mathrm{rxn}}^\\circ}{RT}$.\n\nThe problem states that the perturbation in Gibbs free energy is $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = \\nu_{\\mathrm{H_2O}} \\, \\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T)$. For the reaction $\\mathrm{CO_2} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{CO} + \\mathrm{H_2O}$, the stoichiometric coefficient of water vapor, $\\nu_{\\mathrm{H_2O}}$, is $+1$.\nGiven $\\delta \\Delta H_f^\\circ(\\mathrm{H_2O}, T) = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$, we have $\\delta \\Delta G_{\\mathrm{rxn}}^\\circ = +2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$.\n\nNow we can calculate $\\delta K_p$ using $T = 1200 \\ \\mathrm{K}$ and $R = 8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$:\n$$RT = (8.314462618 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1})(1200 \\ \\mathrm{K}) = 9977.3551416 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}$$\n$$\\delta K_p \\approx -\\frac{2000 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}}{9977.3551416 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1}} \\approx -0.2004539$$\n\nUsing this, we find $\\delta \\xi$:\n$$\\delta \\xi \\approx \\frac{\\delta K_p}{8} \\approx \\frac{-0.2004539}{8} \\approx -0.0250567$$\n\nFinally, we calculate the change in the mole fraction of carbon monoxide:\n$$\\delta y_{\\mathrm{CO}} = \\frac{1}{2} \\delta \\xi \\approx \\frac{-0.0250567}{2} \\approx -0.01252835$$\n\nRounding the result to four significant figures, we get:\n$$\\delta y_{\\mathrm{CO}} \\approx -0.01253$$\nThe negative sign indicates that a positive perturbation to the Gibbs free energy of reaction shifts the equilibrium to the left, decreasing the amount of products, as expected.",
            "answer": "$$\\boxed{-0.01253}$$"
        }
    ]
}