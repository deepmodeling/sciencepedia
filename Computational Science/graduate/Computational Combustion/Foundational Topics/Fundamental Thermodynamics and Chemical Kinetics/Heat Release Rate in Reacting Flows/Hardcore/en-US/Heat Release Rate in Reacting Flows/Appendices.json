{
    "hands_on_practices": [
        {
            "introduction": "The foundation of calculating heat release lies in connecting macroscopic energy release to the microscopic world of chemical bonds. This first practice establishes that fundamental link. By working through a simplified scenario in a Perfectly Stirred Reactor, you will derive the volumetric heat release rate directly from the reaction's standard enthalpy change and its rate of progress, reinforcing the core principles of thermochemistry in reacting flows .",
            "id": "4029587",
            "problem": "A spatially uniform, steady, isobaric reacting flow within a Perfectly Stirred Reactor (PSR) is dominated by a single global oxidation step that is not the usual complete combustion. The chemistry is represented by the elementary stoichiometric change\n$$\\mathrm{CH}_4 + 1.5\\,\\mathrm{O}_2 \\rightarrow \\mathrm{CO} + 2\\,\\mathrm{H}_2\\mathrm{O},$$\nwith nitrogen acting as an inert diluent. Assume ideal-gas behavior and neglect sensible enthalpy changes between the reference state and the reactor temperature, so that species enthalpies may be approximated by their standard enthalpies of formation at the reference temperature. The following standard enthalpies of formation at $298\\,\\mathrm{K}$ are provided:\n$$h_{f,\\mathrm{CH}_4}^{\\circ}(298\\,\\mathrm{K}) = -74.85\\,\\mathrm{kJ/mol},\\quad h_{f,\\mathrm{O}_2}^{\\circ}(298\\,\\mathrm{K}) = 0\\,\\mathrm{kJ/mol},$$\n$$h_{f,\\mathrm{CO}}^{\\circ}(298\\,\\mathrm{K}) = -110.53\\,\\mathrm{kJ/mol},\\quad h_{f,\\mathrm{H}_2\\mathrm{O}}^{\\circ}(298\\,\\mathrm{K}) = -241.826\\,\\mathrm{kJ/mol}.$$\n\nWithin the PSR, the molar rate of progress of the reaction per unit volume is measured to be $r = 15.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$. Using conservation of energy for reacting flows and the definition of species enthalpy in terms of standard enthalpy of formation, derive an expression for the volumetric heat release rate in terms of the stoichiometric coefficients, the standard enthalpies of formation, and the molar rate of progress, and then evaluate it numerically under the given assumptions.\n\nExpress the final heat release rate in $\\mathrm{MW/m}^3$ and round your answer to four significant figures. The final answer must be a single real number.",
            "solution": "The problem requires the derivation and calculation of the volumetric heat release rate, denoted as $\\dot{q}$, for a chemically reacting flow in a Perfectly Stirred Reactor (PSR).\n\nThe volumetric heat release rate is defined as the rate at which chemical energy is converted to thermal energy per unit volume. For a system with $N$ chemical species, this is mathematically expressed as the negative sum of the product of the molar production rate per unit volume of each species, $\\dot{\\Omega}_k$, and its corresponding molar enthalpy, $h_k$:\n$$ \\dot{q} = - \\sum_{k=1}^{N} \\dot{\\Omega}_k h_k $$\nThe species molar enthalpy, $h_k$, at a given temperature $T$ is the sum of its standard molar enthalpy of formation at a reference temperature $T_{ref}$, denoted $h_{f,k}^{\\circ}(T_{ref})$, and its sensible enthalpy change from $T_{ref}$ to $T$:\n$$ h_k(T) = h_{f,k}^{\\circ}(T_{ref}) + \\int_{T_{ref}}^{T} C_{p,k}(T') dT' $$\nwhere $C_{p,k}$ is the molar heat capacity at constant pressure for species $k$.\n\nThe problem states a critical simplifying assumption: \"neglect sensible enthalpy changes between the reference state and the reactor temperature\". This is a formal directive to set the integral term to zero, which implies that the enthalpy of each species can be approximated by its standard enthalpy of formation:\n$$ h_k(T) \\approx h_{f,k}^{\\circ}(T_{ref}) $$\nSubstituting this approximation into the expression for $\\dot{q}$ yields:\n$$ \\dot{q} \\approx - \\sum_{k=1}^{N} \\dot{\\Omega}_k h_{f,k}^{\\circ} $$\nThe problem specifies that the chemistry is governed by a single global reaction. For a single reaction, the molar production rate of any species $k$, $\\dot{\\Omega}_k$, is directly proportional to the molar rate of progress of the reaction per unit volume, $r$. The constant of proportionality is the stoichiometric coefficient of species $k$, $\\nu_k$, in the balanced reaction equation (where $\\nu_k  0$ for products and $\\nu_k  0$ for reactants):\n$$ \\dot{\\Omega}_k = \\nu_k r $$\nSubstituting this relationship into the equation for $\\dot{q}$:\n$$ \\dot{q} = - \\sum_{k=1}^{N} (\\nu_k r) h_{f,k}^{\\circ} = -r \\left( \\sum_{k=1}^{N} \\nu_k h_{f,k}^{\\circ} \\right) $$\nThe term in the parenthesis is the definition of the standard heat of reaction, $\\Delta H_R^{\\circ}$:\n$$ \\Delta H_R^{\\circ} = \\sum_{k=1}^{N} \\nu_k h_{f,k}^{\\circ} = \\sum_{\\text{products}} |\\nu_k| h_{f,k}^{\\circ} - \\sum_{\\text{reactants}} |\\nu_k| h_{f,k}^{\\circ} $$\nThus, the derived expression for the volumetric heat release rate under the stated assumptions is:\n$$ \\dot{q} = -r \\Delta H_R^{\\circ} $$\nNow, we can evaluate this expression numerically. The global reaction is given as:\n$$ \\mathrm{CH}_4 + 1.5\\,\\mathrm{O}_2 \\rightarrow \\mathrm{CO} + 2\\,\\mathrm{H}_2\\mathrm{O} $$\nThe stoichiometric coefficients are: $\\nu_{\\mathrm{CH}_4} = -1$, $\\nu_{\\mathrm{O}_2} = -1.5$, $\\nu_{\\mathrm{CO}} = 1$, and $\\nu_{\\mathrm{H}_2\\mathrm{O}} = 2$.\n\nThe standard heat of reaction, $\\Delta H_R^{\\circ}$, is calculated using the provided standard enthalpies of formation at $T_{ref} = 298\\,\\mathrm{K}$:\n- $h_{f,\\mathrm{CH}_4}^{\\circ} = -74.85\\,\\mathrm{kJ/mol}$\n- $h_{f,\\mathrm{O}_2}^{\\circ} = 0\\,\\mathrm{kJ/mol}$\n- $h_{f,\\mathrm{CO}}^{\\circ} = -110.53\\,\\mathrm{kJ/mol}$\n- $h_{f,\\mathrm{H}_2\\mathrm{O}}^{\\circ} = -241.826\\,\\mathrm{kJ/mol}$\n\n$$ \\Delta H_R^{\\circ} = (1 \\cdot h_{f,\\mathrm{CO}}^{\\circ} + 2 \\cdot h_{f,\\mathrm{H}_2\\mathrm{O}}^{\\circ}) - (1 \\cdot h_{f,\\mathrm{CH}_4}^{\\circ} + 1.5 \\cdot h_{f,\\mathrm{O}_2}^{\\circ}) $$\n$$ \\Delta H_R^{\\circ} = [1(-110.53) + 2(-241.826)]\\,\\mathrm{kJ/mol} - [1(-74.85) + 1.5(0)]\\,\\mathrm{kJ/mol} $$\n$$ \\Delta H_R^{\\circ} = [-110.53 - 483.652]\\,\\mathrm{kJ/mol} - [-74.85]\\,\\mathrm{kJ/mol} $$\n$$ \\Delta H_R^{\\circ} = -594.182\\,\\mathrm{kJ/mol} + 74.85\\,\\mathrm{kJ/mol} $$\n$$ \\Delta H_R^{\\circ} = -519.332\\,\\mathrm{kJ/mol} $$\nThe reaction is exothermic, as indicated by the negative sign of $\\Delta H_R^{\\circ}$. The molar rate of progress per unit volume is given as $r = 15.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\nSubstituting these values into the expression for $\\dot{q}$:\n$$ \\dot{q} = -(15.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}) \\times (-519.332\\,\\mathrm{kJ/mol}) $$\n$$ \\dot{q} = 8101.5792\\,\\mathrm{kJ}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\nThe problem requires the answer in units of megawatts per cubic meter ($\\mathrm{MW/m}^3$) and rounded to four significant figures. The unit $\\mathrm{kJ}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ is equivalent to $\\mathrm{kW/m}^3$. We use the conversion $1\\,\\mathrm{MW} = 1000\\,\\mathrm{kW}$:\n$$ \\dot{q} = 8101.5792\\,\\mathrm{kW/m}^3 = \\frac{8101.5792}{1000}\\,\\mathrm{MW/m}^3 $$\n$$ \\dot{q} = 8.1015792\\,\\mathrm{MW/m}^3 $$\nRounding to four significant figures, we obtain:\n$$ \\dot{q} \\approx 8.102\\,\\mathrm{MW/m}^3 $$",
            "answer": "$$\\boxed{8.102}$$"
        },
        {
            "introduction": "In practical combustion systems, such as nonpremixed flames, fuel and oxidizer are not perfectly uniform, and we need robust models to predict the heat release rate. This exercise transitions from pure thermochemistry to the realm of computational modeling. You will develop a model for the heat release rate within the mixture fraction framework, a cornerstone of turbulent combustion theory, and implement it computationally to test its behavior across various flame conditions . This practice builds essential skills in translating theoretical concepts into a working computational tool.",
            "id": "4029590",
            "problem": "You are asked to develop, derive, and implement a computational procedure for the volumetric Heat Release Rate (HRR) in nonpremixed reacting flows using the mixture fraction framework. The goal is to obtain a physically consistent expression for the volumetric heat release rate based on first principles, suitable for computing in a programmatic manner. The derivation must start from fundamental conservation laws and widely accepted definitions, and must not assume any shortcut formulas without justification.\n\nStarting point and assumptions:\n- Consider a nonpremixed flame formed by the mixing of two streams: a pure fuel stream with fuel mass fraction $Y_{F,\\infty}$ and a pure oxidizer stream with oxidizer mass fraction $Y_{O,\\infty}$. The mixture fraction $Z$ is the conserved scalar that represents the local contribution of the fuel stream to the mixture ($Z \\in [0,1]$), such that the pre-reaction mixing line gives $Y_F(Z)$ and $Y_O(Z)$ as functions of $Z$.\n- Assume a single-step, irreversible reaction that consumes fuel and oxidizer to form products, with a constant heat of reaction per unit mass of fuel consumed equal to $Q$ (heat of combustion, positive for exothermic reactions).\n- Let $s$ be the stoichiometric oxidizer-to-fuel mass ratio implied by the reaction stoichiometry.\n- Let $\\rho$ be the local mass density and $k$ be a mixing-limited effective rate coefficient with units of $\\mathrm{s}^{-1}$ that captures the time scale of molecular mixing in a nonpremixed flame segment.\n\nTasks:\n1. Starting from conservation of energy for reacting flows and the definition of specific enthalpy source terms, derive a mathematically consistent expression for the volumetric heat release rate $\\dot{q}$ in terms of the fuel consumption rate. Explicitly connect $\\dot{q}$ to the mass rate of fuel consumption and the heat of reaction $Q$. The final result must be expressed in units of $\\mathrm{W/m^3}$.\n2. In nonpremixed flows, use the definition of mixture fraction $Z$ and pre-reaction linear mixing to express $Y_F(Z)$ and $Y_O(Z)$ as functions of $Z$, $Y_{F,\\infty}$, and $Y_{O,\\infty}$. Then, using stoichiometric consistency, derive the stoichiometric mixture fraction $Z_{\\mathrm{st}}$ as a function of $Y_{F,\\infty}$, $Y_{O,\\infty}$, and $s$ without assuming any shortcut. Confirm that at $Z=Z_{\\mathrm{st}}$, the local proportions are exactly stoichiometric.\n3. Propose and justify a mixing-limited finite-rate closure for the local fuel consumption rate that respects stoichiometry and the limiting-reactant principle for nonpremixed flames. The closure must produce a consumption rate with units of $\\mathrm{kg/(m^3\\,s)}$ and must be consistent with the assumed $k$ and $\\rho$.\n\nImplementation:\n- Implement the derived expression for $\\dot{q}(Z;\\rho,k,Q,Y_{F,\\infty},Y_{O,\\infty},s)$ in a complete, runnable program.\n- Use the parameter values below as a test suite. For the entries that specify $Z=Z_{\\mathrm{st}}$, compute $Z_{\\mathrm{st}}$ from the provided $Y_{F,\\infty}$, $Y_{O,\\infty}$, and $s$ values.\n- Express every computed heat release rate in $\\mathrm{W/m^3}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$).\n\nTest suite (each tuple is $(\\rho,k,Q,Y_{F,\\infty},Y_{O,\\infty},s,Z)$):\n- Case $1$: Methane–air at stoichiometry: $(1.2,10,5\\times 10^{7},1.0,0.233,4,Z_{\\mathrm{st}})$.\n- Case $2$: Methane–air, oxidizer-only mixing point: $(1.2,10,5\\times 10^{7},1.0,0.233,4,0)$.\n- Case $3$: Methane–air, fuel-only mixing point: $(1.2,10,5\\times 10^{7},1.0,0.233,4,1)$.\n- Case $4$: Hydrogen–air, moderately fuel-rich mixture: $(0.9,50,1.2\\times 10^{8},1.0,0.233,8,0.5)$.\n- Case $5$: Hydrogen–air at stoichiometry: $(1.0,100,1.2\\times 10^{8},1.0,0.233,8,Z_{\\mathrm{st}})$.\n- Case $6$: Methane–air, dense and fuel-rich: $(10.0,5,5\\times 10^{7},1.0,0.233,4,0.8)$.\n- Case $7$: Methane–air at stoichiometry with zero mixing rate constant: $(1.2,0,5\\times 10^{7},1.0,0.233,4,Z_{\\mathrm{st}})$.\n\nAll numerical values in the test suite are physically plausible for nonpremixed flames. The output values must be floating-point numbers corresponding to heat release rates in $\\mathrm{W/m^3}$ for each case, aggregated into a single bracketed list printed by the program as the only output line.",
            "solution": "The solution is developed in three parts as requested by the problem statement: first, establishing the relationship between the volumetric heat release rate $\\dot{q}$ and the fuel consumption rate; second, deriving the key quantities of the mixture fraction framework, including the stoichiometric mixture fraction $Z_{\\mathrm{st}}$; and third, postulating a physically-based closure model for the fuel consumption rate.\n\n### Task 1: Volumetric Heat Release Rate Derivation\n\nThe volumetric heat release rate, $\\dot{q}$, is defined as the rate of energy released by chemical reaction per unit volume, with units of $\\mathrm{W/m^3}$ or $\\mathrm{J/(m^3 s)}$. In a reacting flow, the source term in the conservation equation for total enthalpy is precisely this quantity.\n\nFor a system of chemically reacting species, the heat release rate is given by the sum over all species $i$ of the negative product of their mass production rate $\\dot{\\omega}_i$ (in $\\mathrm{kg/(m^3 s)}$) and their standard enthalpy of formation $\\Delta h_{f,i}^{\\circ}$ (in $\\mathrm{J/kg}$):\n$$\n\\dot{q} = - \\sum_{i} \\dot{\\omega}_i \\Delta h_{f,i}^{\\circ}\n$$\nThe problem simplifies the chemistry to a single-step, irreversible reaction where fuel ($F$) and oxidizer ($O$) react to form products ($P$):\n$$\n1\\,\\mathrm{kg}\\; F + s\\,\\mathrm{kg}\\; O \\longrightarrow (1+s)\\,\\mathrm{kg}\\; P\n$$\nwhere $s$ is the stoichiometric oxidizer-to-fuel mass ratio. Let $\\dot{\\omega}_F^{\\text{cons}}$ be the mass consumption rate of fuel, which is a positive quantity with units of $\\mathrm{kg/(m^3 s)}$. The source term for the fuel species is then $\\dot{\\omega}_F = -\\dot{\\omega}_F^{\\text{cons}}$, and for the oxidizer, $\\dot{\\omega}_O = -s\\dot{\\omega}_F^{\\text{cons}}$.\n\nThe problem defines $Q$ as the heat of reaction per unit mass of fuel consumed, a positive value for an exothermic reaction. By definition, $Q$ is the change in enthalpy for the reaction, normalized by the mass of fuel:\n$$\nQ = -\\left( \\Delta h_{f,P}^{\\circ} \\frac{m_P}{m_F} - \\Delta h_{f,F}^{\\circ} \\frac{m_F}{m_F} - \\Delta h_{f,O}^{\\circ} \\frac{m_O}{m_F} \\right) = -\\left( (1+s)\\Delta h_{f,P}^{\\circ} - \\Delta h_{f,F}^{\\circ} - s\\Delta h_{f,O}^{\\circ} \\right)\n$$\nAssuming for simplicity that products and reactants other than fuel and oxidizer have zero enthalpy of formation (a common convention), this simplifies. However, we can proceed more directly. The total heat release rate is:\n$$\n\\dot{q} = -(\\dot{\\omega}_F \\Delta h_{f,F}^{\\circ} + \\dot{\\omega}_O \\Delta h_{f,O}^{\\circ} + \\dot{\\omega}_P \\Delta h_{f,P}^{\\circ})\n$$\nSubstituting the reaction rates in terms of $\\dot{\\omega}_F^{\\text{cons}}$: $\\dot{\\omega}_F = -\\dot{\\omega}_F^{\\text{cons}}$, $\\dot{\\omega}_O = -s\\dot{\\omega}_F^{\\text{cons}}$, and $\\dot{\\omega}_P = (1+s)\\dot{\\omega}_F^{\\text{cons}}$.\n$$\n\\dot{q} = -(-\\dot{\\omega}_F^{\\text{cons}} \\Delta h_{f,F}^{\\circ} -s\\dot{\\omega}_F^{\\text{cons}} \\Delta h_{f,O}^{\\circ} + (1+s)\\dot{\\omega}_F^{\\text{cons}} \\Delta h_{f,P}^{\\circ})\n$$\n$$\n\\dot{q} = \\dot{\\omega}_F^{\\text{cons}} (\\Delta h_{f,F}^{\\circ} + s\\Delta h_{f,O}^{\\circ} - (1+s)\\Delta h_{f,P}^{\\circ})\n$$\nThe term in the parenthesis is precisely the definition of $Q$. Therefore, the volumetric heat release rate is directly proportional to the fuel mass consumption rate $\\dot{\\omega}_F^{\\text{cons}}$:\n$$\n\\dot{q} = \\dot{\\omega}_F^{\\text{cons}} Q\n$$\nFor notational simplicity, we will let $\\dot{\\omega}_F$ denote the positive fuel consumption rate from this point forward.\n\n### Task 2: Mixture Fraction and Stoichiometry\n\nThe mixture fraction $Z$ is a conserved scalar that measures the proportion of mass in a given fluid parcel that originated from the fuel stream. It ranges from $Z=0$ (pure oxidizer stream) to $Z=1$ (pure fuel stream).\nThe composition of the unreacted mixture is determined by linear mixing of the fuel and oxidizer streams. The fuel stream ($Z=1$) has a fuel mass fraction of $Y_{F,1} = Y_{F,\\infty}$ and an oxidizer mass fraction of $Y_{O,1}=0$. The oxidizer stream ($Z=0$) has $Y_{F,2}=0$ and $Y_{O,2}=Y_{O,\\infty}$.\nThe mass fractions of fuel ($Y_F^0$) and oxidizer ($Y_O^0$) in the unreacted mixture at a point with mixture fraction $Z$ are given by:\n$$\nY_F^0(Z) = Z \\cdot Y_{F,1} + (1-Z) \\cdot Y_{F,2} = Z Y_{F,\\infty}\n$$\n$$\nY_O^0(Z) = Z \\cdot Y_{O,1} + (1-Z) \\cdot Y_{O,2} = (1-Z) Y_{O,\\infty}\n$$\nThe stoichiometric condition is defined as the state where the available fuel and oxidizer are in the exact mass ratio required for complete combustion, which is $s$. The mixture fraction at which this occurs is the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$. At this point, the ratio of the unreacted mass fractions must equal $s$:\n$$\n\\frac{Y_O^0(Z_{\\mathrm{st}})}{Y_F^0(Z_{\\mathrm{st}})} = s\n$$\nSubstituting the expressions for $Y_F^0$ and $Y_O^0$:\n$$\n\\frac{(1-Z_{\\mathrm{st}}) Y_{O,\\infty}}{Z_{\\mathrm{st}} Y_{F,\\infty}} = s\n$$\nWe solve this algebraic equation for $Z_{\\mathrm{st}}$:\n$$\n(1-Z_{\\mathrm{st}}) Y_{O,\\infty} = s Z_{\\mathrm{st}} Y_{F,\\infty}\n$$\n$$\nY_{O,\\infty} - Z_{\\mathrm{st}}Y_{O,\\infty} = s Z_{\\mathrm{st}} Y_{F,\\infty}\n$$\n$$\nY_{O,\\infty} = Z_{\\mathrm{st}}(s Y_{F,\\infty} + Y_{O,\\infty})\n$$\n$$\nZ_{\\mathrm{st}} = \\frac{Y_{O,\\infty}}{s Y_{F,\\infty} + Y_{O,\\infty}}\n$$\nThis derived expression allows for the calculation of $Z_{\\mathrm{st}}$ from the boundary stream compositions and the reaction stoichiometry.\n\n### Task 3: Mixing-Limited Reaction Rate Closure\n\nIn nonpremixed combustion, the overall reaction rate is often controlled by the rate at which fuel and oxidizer are mixed at the molecular level, rather than by chemical kinetics. The problem specifies a mixing-limited effective rate coefficient $k$ (in $\\mathrm{s}^{-1}$), which represents the inverse of the characteristic time for this mixing process.\n\nA closure for the fuel consumption rate $\\dot{\\omega}_F$ must respect the limiting-reactant principle: the reaction stops when either fuel or oxidizer is depleted. The model should reflect that the rate of consumption is proportional to the local density $\\rho$, the mixing rate $k$, and the available amount of the limiting reactant.\n\nThe available fuel mass fraction is $Y_F^0(Z) = Z Y_{F,\\infty}$. The available oxidizer mass fraction is $Y_O^0(Z) = (1-Z) Y_{O,\\infty}$. Stoichiometrically, $1$ kg of fuel requires $s$ kg of oxidizer. Thus, the amount of fuel that can be consumed by the available oxidizer is $Y_O^0(Z)/s$.\n\nThe amount of fuel that can react is limited by the minimum of the available fuel and the fuel equivalent of the available oxidizer. We define this reactable fuel mass fraction, $Y_{F, \\text{reactable}}$, as:\n$$\nY_{F, \\text{reactable}}(Z) = \\min\\left( Y_F^0(Z), \\frac{Y_O^0(Z)}{s} \\right) = \\min\\left( Z Y_{F,\\infty}, \\frac{(1-Z)Y_{O,\\infty}}{s} \\right)\n$$\nThis expression correctly identifies the limiting reactant:\n- If $Z  Z_{\\mathrm{st}}$, the mixture is fuel-lean. The first term is smaller.\n- If $Z  Z_{\\mathrm{st}}$, the mixture is fuel-rich. The second term is smaller.\n- If $Z = Z_{\\mathrm{st}}$, both terms are equal, as shown in the derivation of $Z_{\\mathrm{st}}$.\n\nThe mixing-limited fuel consumption rate, $\\dot{\\omega}_F$, is modeled as the rate at which this reactable fuel mass is consumed over the mixing timescale $1/k$:\n$$\n\\dot{\\omega}_F(\\rho, k, Z) = \\rho k Y_{F, \\text{reactable}}(Z)\n$$\nSubstituting the expression for $Y_{F, \\text{reactable}}$:\n$$\n\\dot{\\omega}_F = \\rho k \\min\\left( Z Y_{F,\\infty}, \\frac{(1-Z)Y_{O,\\infty}}{s} \\right)\n$$\nThis model provides a reaction rate in $\\mathrm{kg/(m^3 s)}$, is proportional to the mixing rate $k$, and correctly observes the limiting reactant principle.\n\n### Final Expression for Implementation\n\nCombining the results from all three tasks, we obtain the complete expression for the volumetric heat release rate $\\dot{q}$ as a function of the local mixture fraction $Z$ and the other given parameters:\n$$\n\\dot{q}(Z; \\rho, k, Q, Y_{F,\\infty}, Y_{O,\\infty}, s) = Q \\cdot \\dot{\\omega}_F = \\rho k Q \\min\\left( Z Y_{F,\\infty}, \\frac{(1-Z)Y_{O,\\infty}}{s} \\right)\n$$\nThis expression is now ready for programmatic implementation. For cases where $Z$ is specified as $Z_{\\mathrm{st}}$, the value will first be computed using the formula derived in Task 2.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a computational procedure for the volumetric Heat Release Rate (HRR)\n    in nonpremixed reacting flows using a mixture fraction framework.\n    \"\"\"\n\n    # Test suite: each tuple is (rho, k, Q, Y_F_inf, Y_O_inf, s, Z)\n    # rho: density (kg/m^3)\n    # k: mixing rate coefficient (1/s)\n    # Q: heat of combustion (J/kg_fuel)\n    # Y_F_inf: fuel mass fraction in the fuel stream\n    # Y_O_inf: oxidizer mass fraction in the oxidizer stream\n    # s: stoichiometric oxidizer-to-fuel mass ratio\n    # Z: mixture fraction (or 'Z_st' for stoichiometric)\n    test_cases = [\n        # Case 1: Methane–air at stoichiometry\n        (1.2, 10.0, 5.0e7, 1.0, 0.233, 4.0, 'Z_st'),\n        # Case 2: Methane–air, oxidizer-only mixing point\n        (1.2, 10.0, 5.0e7, 1.0, 0.233, 4.0, 0.0),\n        # Case 3: Methane–air, fuel-only mixing point\n        (1.2, 10.0, 5.0e7, 1.0, 0.233, 4.0, 1.0),\n        # Case 4: Hydrogen–air, moderately fuel-rich mixture\n        (0.9, 50.0, 1.2e8, 1.0, 0.233, 8.0, 0.5),\n        # Case 5: Hydrogen–air at stoichiometry\n        (1.0, 100.0, 1.2e8, 1.0, 0.233, 8.0, 'Z_st'),\n        # Case 6: Methane–air, dense and fuel-rich\n        (10.0, 5.0, 5.0e7, 1.0, 0.233, 4.0, 0.8),\n        # Case 7: Methane–air at stoichiometry with zero mixing rate constant\n        (1.2, 0.0, 5.0e7, 1.0, 0.233, 4.0, 'Z_st'),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, k, Q, Y_F_inf, Y_O_inf, s, Z_val = case\n        \n        # If Z is specified as 'Z_st', calculate the stoichiometric mixture fraction\n        if Z_val == 'Z_st':\n            # Z_st = Y_O_inf / (s * Y_F_inf + Y_O_inf)\n            if (s * Y_F_inf + Y_O_inf) == 0:\n                Z = 0.0 # Avoid division by zero, though not expected with given data\n            else:\n                Z = Y_O_inf / (s * Y_F_inf + Y_O_inf)\n        else:\n            Z = float(Z_val)\n            \n        # These are the unreacted mass fractions of fuel and oxidizer based on mixing alone\n        # Y_F_unreacted = Z * Y_F_inf\n        # Y_O_unreacted = (1 - Z) * Y_O_inf\n\n        # The amount of fuel that can react is limited by the minimum of available fuel\n        # and the fuel-equivalent of available oxidizer.\n        # This is the \"reactable\" fuel mass fraction.\n        # Term 1: available fuel\n        fuel_term = Z * Y_F_inf\n        # Term 2: fuel equivalent of available oxidizer\n        if s == 0:\n             oxidizer_term = float('inf') # Avoid division by zero for non-reacting cases\n        else:\n             oxidizer_term = ((1.0 - Z) * Y_O_inf) / s\n        \n        Y_F_reactable = np.min([fuel_term, oxidizer_term])\n        \n        # The fuel consumption rate (omega_dot_F) is modeled using a mixing-limited closure.\n        # omega_dot_F = rho * k * Y_F_reactable   [kg/(m^3*s)]\n        omega_dot_F = rho * k * Y_F_reactable\n        \n        # The volumetric heat release rate (q_dot) is the fuel consumption rate\n        # multiplied by the heat of reaction per unit mass of fuel.\n        # q_dot = omega_dot_F * Q  [W/m^3]\n        q_dot = omega_dot_F * Q\n        \n        results.append(q_dot)\n\n    # Format the final output as a comma-separated list in square brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The heat release rate is not merely a passive outcome of reaction; it can actively drive powerful physical phenomena. This advanced practice explores one of the most critical consequences: thermoacoustic instability, where fluctuations in heat release can amplify acoustic waves in a combustor. Starting from the fundamental conservation laws, you will derive the growth rate of an acoustic instability driven by an oscillating heat source, providing a hands-on understanding of the famous Rayleigh criterion and its importance in the design of engines and power generation systems .",
            "id": "4029592",
            "problem": "Consider a one-dimensional rigid-walled duct of length $L$ and constant cross-sectional area $A$, filled with an ideal gas initially at uniform base state pressure $p_0$, density $\\rho_0$, and temperature $T_0$. Let the ratio of specific heats be $\\gamma$, and the speed of sound be $c$, where $c^2 = \\gamma p_0 / \\rho_0$. Neglect mean flow, viscosity, and thermal conduction. Assume small-amplitude acoustics and a spatially distributed, time-dependent volumetric heat release rate $q'(x,t)$ due to a reacting flow. The acoustic field is dominated by the half-wave standing mode, with pressure and velocity perturbations\n$$\np'(x,t) = \\hat{p}\\,\\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\cos(\\omega t), \\quad u'(x,t) = \\tilde{u}\\,\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin(\\omega t),\n$$\nwhere $\\hat{p}$ is the pressure amplitude, $\\tilde{u}$ is the velocity amplitude to be determined from the linear wave relations, and $\\omega$ is the angular frequency of the mode. The volumetric heat release oscillation is given by\n$$\nq'(x,t) = \\hat{q}\\,\\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\cos(\\omega t + \\phi),\n$$\nwith amplitude $\\hat{q}$ and phase $\\phi$ relative to the pressure oscillation. The duct ends are perfectly reflecting, so there is no net acoustic energy flux through the boundaries over a cycle.\n\nStarting from the linearized conservation laws for an ideal gas with heat addition and fundamental thermodynamic identities (no shortcut formulas), derive the cycle-averaged exponential growth rate $\\sigma$ of the acoustic mode amplitude resulting from thermoacoustic coupling, under the assumption that $\\sigma / \\omega \\ll 1$ so that the amplitude change over one acoustic period is small. Then, evaluate $\\sigma$ numerically for\n$$\nL = 1\\,\\mathrm{m},\\quad A = 1.0\\times 10^{-2}\\,\\mathrm{m}^2,\\quad p_0 = 1.01325\\times 10^{5}\\,\\mathrm{Pa},\\quad \\gamma = 1.4,\n$$\n$$\n\\hat{p} = 1.0\\times 10^{2}\\,\\mathrm{Pa},\\quad \\hat{q} = 1.0\\times 10^{3}\\,\\mathrm{W/m^3},\\quad \\phi = \\frac{\\pi}{3}\\,\\mathrm{rad}.\n$$\nRound your final numerical value of $\\sigma$ to four significant figures and express it in $\\mathrm{s^{-1}}$.",
            "solution": "We begin with the linearized conservation equations for a one-dimensional ideal gas with volumetric heat addition, neglecting mean flow, viscosity, and conduction. The continuity and momentum equations are\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0, \\qquad \\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0.\n$$\nThe energy equation in terms of temperature with volumetric heat release $q'$ is, to leading order,\n$$\n\\rho_0 c_v \\frac{\\partial T'}{\\partial t} = -p_0 \\frac{\\partial u'}{\\partial x} + q',\n$$\nwhere $c_v$ is the specific heat at constant volume. The ideal gas equation of state gives $p' = R(\\rho_0 T' + T_0 \\rho')$, with $R = c_p - c_v$ and $c_p/c_v = \\gamma$. Differentiating the equation of state in time and using the continuity and energy equations to eliminate $\\partial \\rho'/\\partial t$ and $\\partial T'/\\partial t$, one obtains the linear pressure equation with heat addition,\n$$\n\\frac{\\partial p'}{\\partial t} + \\gamma p_0 \\frac{\\partial u'}{\\partial x} = (\\gamma - 1)\\,q'.\n$$\nThis can be verified by noting for an ideal gas that $R T_0 = p_0 / \\rho_0$ and $c_p = \\gamma c_v$, leading to the stated coupling coefficient $(\\gamma - 1)$.\n\nTo derive the acoustic energy balance, multiply the momentum equation by $u'$ and the pressure equation by $p'/(\\gamma p_0)$, and add:\n$$\n\\rho_0 u' \\frac{\\partial u'}{\\partial t} + \\frac{p'}{\\gamma p_0} \\frac{\\partial p'}{\\partial t} + u' \\frac{\\partial p'}{\\partial x} + \\frac{p'}{\\gamma p_0}\\,\\gamma p_0 \\frac{\\partial u'}{\\partial x} = \\frac{\\gamma - 1}{\\gamma p_0} p'\\,q'.\n$$\nRecognizing the time derivatives of the quadratic forms and rearranging as a divergence, we write\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{\\rho_0 u'^2}{2} + \\frac{p'^2}{2\\gamma p_0}\\right) + \\frac{\\partial}{\\partial x}\\left(p' u'\\right) = \\frac{\\gamma - 1}{\\gamma p_0}\\,p' q'.\n$$\nIntegrating over the duct volume $V$ and using the boundary condition of no net acoustic flux through the ends over a cycle (rigid, perfectly reflecting walls yield zero cycle-average of $\\int_{\\partial V} p' u' \\, dS$), we obtain the acoustic energy equation\n$$\n\\frac{dE}{dt} = \\int_V \\frac{\\gamma - 1}{\\gamma p_0}\\,\\langle p' q' \\rangle_t \\, dV,\n$$\nwhere the total acoustic energy is\n$$\nE(t) = \\int_V \\left(\\frac{\\rho_0 u'^2}{2} + \\frac{p'^2}{2\\gamma p_0}\\right) dV,\n$$\nand $\\langle \\cdot \\rangle_t$ denotes cycle-average over the acoustic period $T = 2\\pi/\\omega$.\n\nFor the half-wave mode with wavenumber $k = \\pi/L$, the homogeneous (no source) standing-wave relation between amplitudes is obtained by combining the linear source-free equations; for a plane wave, $p'$ and $u'$ are related by $u' = \\pm p'/(\\rho_0 c)$ with a quadrature phase shift in the standing wave. Consistent with the given spatial forms, we have\n$$\nu'(x,t) = \\frac{\\hat{p}}{\\rho_0 c}\\,\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin(\\omega t),\n$$\nwhich satisfies the momentum equation with $p'(x,t) = \\hat{p}\\cos(\\pi x/L)\\cos(\\omega t)$.\n\nThe cycle-averaged total acoustic energy for this mode is\n$$\n\\langle E \\rangle_t = \\int_0^L \\int_A \\left(\\frac{\\rho_0 \\langle u'^2 \\rangle_t}{2} + \\frac{\\langle p'^2 \\rangle_t}{2\\gamma p_0}\\right) dA\\,dx.\n$$\nCompute the time averages $\\langle \\cos^2(\\omega t)\\rangle_t = \\langle \\sin^2(\\omega t)\\rangle_t = \\frac{1}{2}$ and the spatial integrals\n$$\n\\int_0^L \\cos^2\\!\\left(\\frac{\\pi x}{L}\\right) dx = \\int_0^L \\sin^2\\!\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{L}{2}.\n$$\nHence,\n$$\n\\langle p'^2 \\rangle_t = \\frac{1}{2}\\hat{p}^2 \\cos^2\\!\\left(\\frac{\\pi x}{L}\\right), \\quad \\langle u'^2 \\rangle_t = \\frac{1}{2}\\left(\\frac{\\hat{p}}{\\rho_0 c}\\right)^2 \\sin^2\\!\\left(\\frac{\\pi x}{L}\\right).\n$$\nIntegrating over the cross-sectional area $A$ and $x \\in [0,L]$ gives\n$$\n\\langle E \\rangle_t = A \\left[ \\int_0^L \\frac{\\rho_0}{2}\\cdot \\frac{1}{2}\\left(\\frac{\\hat{p}}{\\rho_0 c}\\right)^2 \\sin^2\\!\\left(\\frac{\\pi x}{L}\\right) dx + \\int_0^L \\frac{1}{2\\gamma p_0}\\cdot \\frac{1}{2}\\hat{p}^2 \\cos^2\\!\\left(\\frac{\\pi x}{L}\\right) dx \\right].\n$$\nUsing $c^2 = \\gamma p_0/\\rho_0$, both integrals evaluate to the same value, yielding\n$$\n\\langle E \\rangle_t = A \\left[ \\frac{\\hat{p}^2}{4\\rho_0 c^2}\\cdot \\frac{L}{2} + \\frac{\\hat{p}^2}{4\\gamma p_0}\\cdot \\frac{L}{2} \\right] = A L \\frac{\\hat{p}^2}{8\\gamma p_0} + A L \\frac{\\hat{p}^2}{8\\gamma p_0} = A L \\frac{\\hat{p}^2}{4\\gamma p_0}.\n$$\n\nNext, evaluate the cycle-averaged source term. The given $q'(x,t)$ is in phase with $\\cos(\\pi x/L)$ but has a phase $\\phi$ in time. The cycle-average of the product is\n$$\n\\left\\langle p'(x,t)\\,q'(x,t)\\right\\rangle_t = \\hat{p}\\hat{q}\\,\\cos^2\\!\\left(\\frac{\\pi x}{L}\\right)\\left\\langle \\cos(\\omega t)\\cos(\\omega t + \\phi)\\right\\rangle_t = \\frac{1}{2}\\hat{p}\\hat{q}\\,\\cos^2\\!\\left(\\frac{\\pi x}{L}\\right)\\cos\\phi,\n$$\nsince $\\langle \\cos(\\omega t)\\cos(\\omega t+\\phi) \\rangle_t = \\frac{1}{2}\\cos\\phi$. Integrating this over the volume gives\n$$\n\\int_V \\left\\langle p' q' \\right\\rangle_t \\, dV = A \\int_0^L \\frac{1}{2}\\hat{p}\\hat{q}\\,\\cos^2\\!\\left(\\frac{\\pi x}{L}\\right)\\cos\\phi \\, dx = A \\cdot \\frac{1}{2}\\hat{p}\\hat{q}\\cos\\phi \\cdot \\frac{L}{2} = A L \\frac{\\hat{p}\\hat{q}\\cos\\phi}{4}.\n$$\n\nWith no net boundary flux over a cycle, the cycle-averaged energy growth rate is\n$$\n\\left\\langle \\frac{dE}{dt} \\right\\rangle_t = \\frac{\\gamma - 1}{\\gamma p_0} \\int_V \\left\\langle p' q' \\right\\rangle_t \\, dV = \\frac{\\gamma - 1}{\\gamma p_0} \\cdot A L \\frac{\\hat{p}\\hat{q}\\cos\\phi}{4}.\n$$\nAssuming slow growth relative to the acoustic period, the acoustic energy scales with the square of the amplitude, so if the mode amplitude grows as $\\exp(\\sigma t)$, then $E(t) \\propto \\exp(2\\sigma t)$ and\n$$\n\\frac{1}{\\langle E \\rangle_t} \\left\\langle \\frac{dE}{dt} \\right\\rangle_t \\approx 2\\sigma.\n$$\nTherefore,\n$$\n\\sigma = \\frac{1}{2} \\cdot \\frac{\\gamma - 1}{\\gamma p_0} \\cdot \\frac{A L \\frac{\\hat{p}\\hat{q}\\cos\\phi}{4}}{A L \\frac{\\hat{p}^2}{4\\gamma p_0}} = \\frac{\\gamma - 1}{2} \\cdot \\frac{\\hat{q}\\cos\\phi}{\\hat{p}} \\cdot \\frac{1}{\\hat{p}} \\cdot \\frac{\\gamma p_0}{\\gamma p_0}.\n$$\nCarrying out the algebra carefully using the explicit forms,\n$$\n\\sigma = \\frac{1}{2} \\cdot \\frac{\\gamma - 1}{\\gamma p_0} \\cdot \\frac{A L \\hat{p}\\hat{q}\\cos\\phi / 4}{A L \\hat{p}^2 /(4\\gamma p_0)} = \\frac{1}{2} \\cdot \\frac{\\gamma - 1}{\\gamma p_0} \\cdot \\frac{\\hat{p}\\hat{q}\\cos\\phi}{\\hat{p}^2} \\cdot \\gamma p_0 = \\frac{\\gamma - 1}{2} \\cdot \\frac{\\hat{q}\\cos\\phi}{\\hat{p}}.\n$$\nThus the cycle-averaged exponential growth rate is\n$$\n\\sigma = \\frac{\\gamma - 1}{2} \\cdot \\frac{\\hat{q}\\cos\\phi}{\\hat{p}}.\n$$\nNote that for a mode whose spatial coupling factors in $p'$ and $q'$ are identical and the boundaries store acoustic energy without net flux over a cycle, the $A L$ and $\\gamma p_0$ factors cancel, leaving a compact expression proportional to the Rayleigh index density normalized by the mode energy density amplitude. The sign of $\\cos\\phi$ embodies the Rayleigh criterion: positive in-phase coupling ($|\\phi|  \\pi/2$) yields $\\sigma  0$.\n\nNow insert the given numerical values. With $\\gamma = 1.4$, $\\hat{q} = 1.0\\times 10^{3}\\,\\mathrm{W/m^3}$, $\\hat{p} = 1.0\\times 10^{2}\\,\\mathrm{Pa}$, and $\\phi = \\pi/3$,\n$$\n\\cos\\phi = \\cos\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{2}, \\quad \\gamma - 1 = 0.4.\n$$\nHence,\n$$\n\\sigma = \\frac{0.4}{2} \\cdot \\frac{1.0\\times 10^{3} \\cdot \\frac{1}{2}}{1.0\\times 10^{2}} = 0.2 \\cdot \\frac{500}{100} = 0.2 \\cdot 5 = 1.0.\n$$\nRounded to four significant figures and expressed in $\\mathrm{s^{-1}}$, the result is $1.000\\,\\mathrm{s^{-1}}$.",
            "answer": "$$\\boxed{1.000}$$"
        }
    ]
}