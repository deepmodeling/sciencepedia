{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of thermochemical analysis is determining the energy released during a reaction. This practice guides you through the fundamental calculation of the standard molar heat of combustion, $\\Delta H_c^\\circ$, using Hess's Law, which leverages the fact that enthalpy is a state function. By applying this principle to the combustion of benzene , you will solidify your understanding of how heats of reaction are determined from tabulated standard enthalpies of formation.",
            "id": "4029853",
            "problem": "A computational combustion model for hydrocarbon fuels requires accurate standard molar heats of combustion to close the energy equation and to calibrate reaction mechanisms. Consider the complete combustion of benzene at standard conditions ($298.15$ K, $1$ atm) to carbon dioxide and liquid water. Treat benzene in its standard liquid state. Use the thermochemical definition of standard molar enthalpy of formation and the fact that enthalpy is a state function, together with stoichiometric conservation, to determine the standard molar heat of combustion.\n\nThe balanced reaction is\n$$\\mathrm{C_6H_6(l) + \\tfrac{15}{2}\\,O_2(g) \\to 6\\,CO_2(g) + 3\\,H_2O(l)}.$$\n\nUse the following standard molar enthalpies of formation at $298.15$ K:\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{CO_2(g)}\\right) = -393.509$ kJ/mol,\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(l)}\\right) = -285.830$ kJ/mol,\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{C_6H_6(l)}\\right) = +49.0$ kJ/mol,\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{O_2(g)}\\right) = 0$ kJ/mol.\n\nCompute the standard molar heat of combustion $\\Delta H_c^\\circ$ of benzene for the reaction above. Then, verify your computed value against the National Institute of Standards and Technology (NIST) recommended value of $-3268.0$ kJ/mol at $298.15$ K by briefly explaining potential reasons for any deviation that may arise from using tabulated formation data. Express the final energy in kJ/mol and round your answer to four significant figures.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. It is a standard application of fundamental principles of thermochemistry and is free of any invalidating flaws. Therefore, a solution can be derived.\n\nThe standard molar heat of combustion, $\\Delta H_c^\\circ$, is a specific type of standard enthalpy of reaction, $\\Delta H_{rxn}^\\circ$. According to Hess's Law, the enthalpy change of a reaction is independent of the path taken. This principle allows for the calculation of the standard enthalpy change of a reaction from the standard molar enthalpies of formation, $\\Delta H_f^\\circ$, of the products and reactants. Enthalpy is a state function, which underlies this law.\n\nThe general formula is:\n$$ \\Delta H_c^\\circ = \\sum_p \\nu_p \\Delta H_f^\\circ(\\text{products}) - \\sum_r \\nu_r \\Delta H_f^\\circ(\\text{reactants}) $$\nwhere $\\nu_p$ and $\\nu_r$ are the stoichiometric coefficients of the products and reactants, respectively.\n\nThe balanced chemical equation for the complete combustion of liquid benzene is given as:\n$$ \\mathrm{C_6H_6(l) + \\tfrac{15}{2}\\,O_2(g) \\to 6\\,CO_2(g) + 3\\,H_2O(l)} $$\n\nFrom this equation, we identify the reactants, products, and their respective stoichiometric coefficients:\nReactants:\n- $\\mathrm{C_6H_6(l)}$: $\\nu_{\\mathrm{C_6H_6}} = 1$\n- $\\mathrm{O_2(g)}$: $\\nu_{\\mathrm{O_2}} = \\frac{15}{2} = 7.5$\n\nProducts:\n- $\\mathrm{CO_2(g)}$: $\\nu_{\\mathrm{CO_2}} = 6$\n- $\\mathrm{H_2O(l)}$: $\\nu_{\\mathrm{H_2O}} = 3$\n\nThe standard molar enthalpies of formation, $\\Delta H_f^\\circ$, at $298.15 \\, \\mathrm{K}$ are provided:\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{CO_2(g)}\\right) = -393.509 \\, \\mathrm{kJ/mol}$\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(l)}\\right) = -285.830 \\, \\mathrm{kJ/mol}$\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{C_6H_6(l)}\\right) = +49.0 \\, \\mathrm{kJ/mol}$\n- $\\Delta H_f^\\circ\\!\\left(\\mathrm{O_2(g)}\\right) = 0 \\, \\mathrm{kJ/mol}$ (by definition for an element in its standard state)\n\nWe apply the formula for $\\Delta H_c^\\circ$:\n$$ \\Delta H_c^\\circ = \\left[ 6 \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{CO_2(g)}\\right) + 3 \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{H_2O(l)}\\right) \\right] - \\left[ 1 \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{C_6H_6(l)}\\right) + \\tfrac{15}{2} \\cdot \\Delta H_f^\\circ\\!\\left(\\mathrm{O_2(g)}\\right) \\right] $$\n\nFirst, let's calculate the sum of the enthalpies of formation for the products, scaled by their stoichiometric coefficients:\n$$ \\sum_p \\nu_p \\Delta H_f^\\circ(\\text{products}) = 6 \\, \\mathrm{mol} \\times (-393.509 \\, \\mathrm{kJ/mol}) + 3 \\, \\mathrm{mol} \\times (-285.830 \\, \\mathrm{kJ/mol}) $$\n$$ \\sum_p \\nu_p \\Delta H_f^\\circ(\\text{products}) = (-2361.054 \\, \\mathrm{kJ}) + (-857.490 \\, \\mathrm{kJ}) = -3218.544 \\, \\mathrm{kJ} $$\n\nNext, we calculate the sum for the reactants:\n$$ \\sum_r \\nu_r \\Delta H_f^\\circ(\\text{reactants}) = 1 \\, \\mathrm{mol} \\times (+49.0 \\, \\mathrm{kJ/mol}) + \\tfrac{15}{2} \\, \\mathrm{mol} \\times (0 \\, \\mathrm{kJ/mol}) $$\n$$ \\sum_r \\nu_r \\Delta H_f^\\circ(\\text{reactants}) = 49.0 \\, \\mathrm{kJ} + 0 \\, \\mathrm{kJ} = 49.0 \\, \\mathrm{kJ} $$\n\nNow, we compute the standard molar heat of combustion:\n$$ \\Delta H_c^\\circ = (-3218.544 \\, \\mathrm{kJ}) - (49.0 \\, \\mathrm{kJ}) $$\n$$ \\Delta H_c^\\circ = -3267.544 \\, \\mathrm{kJ} $$\nThis value is for the combustion of $1$ mole of benzene as written in the reaction. Therefore, the standard molar heat of combustion is $-3267.544 \\, \\mathrm{kJ/mol}$.\n\nThe problem requires rounding the final answer to four significant figures.\n$$ \\Delta H_c^\\circ \\approx -3268 \\, \\mathrm{kJ/mol} $$\n\nThe second part of the problem asks for a comparison of this computed value with the NIST recommended value of $-3268.0 \\, \\mathrm{kJ/mol}$ and an explanation for any deviation.\nOur calculated value, $-3267.544 \\, \\mathrm{kJ/mol}$, is extremely close to the NIST value. The difference is $-3268.0 - (-3267.544) = -0.456 \\, \\mathrm{kJ/mol}$. When rounded to four significant figures, our value becomes $-3268 \\, \\mathrm{kJ/mol}$, which matches the integer part of the NIST value. The small deviation can be attributed to several factors inherent in thermochemical calculations:\n1.  **Experimental Uncertainty**: The standard enthalpies of formation used as input are experimentally determined quantities, each with an associated measurement uncertainty. These uncertainties propagate through the calculation. For example, the value for $\\Delta H_f^\\circ(\\mathrm{C_6H_6(l)})$ is given as $+49.0 \\, \\mathrm{kJ/mol}$, with only one decimal place, suggesting lower precision compared to the other values.\n2.  **Internal Consistency of Data**: The NIST recommended value for $\\Delta H_c^\\circ(\\mathrm{C_6H_6(l)})$ is part of a large, internally consistent thermochemical network. This database is globally optimized to minimize discrepancies over thousands of species and reactions. The individual $\\Delta H_f^\\circ$ values used in our calculation may originate from different experiments or evaluations and may not be perfectly consistent with the specific set used by NIST to derive its final recommended value.\n3.  **Direct vs. Indirect Determination**: The NIST value for the heat of combustion may be based on high-precision direct measurements, such as bomb calorimetry of benzene combustion. Such direct measurements are often more accurate for a specific reaction than values calculated indirectly from the heats of formation of other compounds, as was done here. The Hess's Law calculation is fundamentally sound, but its accuracy is limited by the accuracy of the input data.\n\nThe very close agreement between the calculated value and the NIST benchmark validates the quality of the provided formation enthalpy data and the application of Hess's Law.\nThe final requested value is the computed heat of combustion, rounded to four significant figures.\nComputed value: $-3267.544 \\, \\mathrm{kJ/mol}$.\nRounded value: $-3268 \\, \\mathrm{kJ/mol}$.",
            "answer": "$$\\boxed{-3268}$$"
        },
        {
            "introduction": "In combustion engineering, the energy content of a fuel is often specified as either a Higher Heating Value (HHV) or Lower Heating Value (LHV), a distinction that can be a source of significant error if misunderstood. This exercise  focuses on the physical basis for this difference: the latent heat of vaporization of water produced during combustion. By quantifying the numerical impact of this phase change for common fuels, you will gain a practical appreciation for these crucial definitions and learn to avoid common pitfalls in energy calculations.",
            "id": "4029814",
            "problem": "A computational combustion code estimates the standard heat release by evaluating the standard enthalpy of reaction at a reference temperature $T_{0} = 298\\ \\mathrm{K}$ and pressure $p_{0} = 1\\ \\mathrm{atm}$ using tabulated standard enthalpies of formation. In practice, the Higher Heating Value (HHV) and Lower Heating Value (LHV) differ by the phase of the water in the products: HHV takes water as liquid, whereas LHV takes water as vapor. A common mistake in HHV computations is to use gaseous water as a product, thereby underestimating the HHV.\n\nStarting from first principles and using Hess’s law for standard enthalpy of reaction, quantify the numerical impact of this mistake for methane and hydrogen fuels at $T_{0} = 298\\ \\mathrm{K}$. Specifically, compute the difference between the correct HHV and the incorrectly computed “HHV” in which product water is taken as vapor (for complete, stoichiometric combustion to carbon dioxide and water).\n\nUse the following standard enthalpies of formation at $T_{0} = 298\\ \\mathrm{K}$, $p_{0} = 1\\ \\mathrm{atm}$:\n- $\\Delta H_{f}^{\\circ}\\!\\left(\\mathrm{CH_{4}(g)}\\right) = -74.85\\ \\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}\\!\\left(\\mathrm{H_{2}(g)}\\right) = 0\\ \\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}\\!\\left(\\mathrm{O_{2}(g)}\\right) = 0\\ \\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}\\!\\left(\\mathrm{CO_{2}(g)}\\right) = -393.51\\ \\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}\\!\\left(\\mathrm{H_{2}O(l)}\\right) = -285.83\\ \\mathrm{kJ/mol}$,\n- $\\Delta H_{f}^{\\circ}\\!\\left(\\mathrm{H_{2}O(g)}\\right) = -241.82\\ \\mathrm{kJ/mol}$.\n\nAssume complete, stoichiometric combustion:\n- $\\mathrm{CH_{4}(g)} + 2\\,\\mathrm{O_{2}(g)} \\to \\mathrm{CO_{2}(g)} + 2\\,\\mathrm{H_{2}O}(\\text{phase})$,\n- $\\mathrm{H_{2}(g)} + \\tfrac{1}{2}\\,\\mathrm{O_{2}(g)} \\to \\mathrm{H_{2}O}(\\text{phase})$,\n\nand take the reactants at the same reference state as the products. Derive and report the magnitude of the error per mole of fuel (the amount by which the incorrect “HHV’’ using gaseous water is lower than the correct HHV using liquid water) for methane and for hydrogen. Round your answers to four significant figures and express them in $\\mathrm{kJ/mol}$. Present your final answer as a row matrix with the first entry for methane and the second for hydrogen.",
            "solution": "The problem requires the quantification of a specific error in the computation of the Higher Heating Value (HHV) for methane ($\\mathrm{CH_4}$) and hydrogen ($\\mathrm{H_2}$) fuels. The error arises from incorrectly assuming the product water is in the gaseous phase instead of the correct liquid phase. The analysis will be conducted at the standard reference state of $T_{0} = 298\\ \\mathrm{K}$ and $p_{0} = 1\\ \\mathrm{atm}$.\n\nFirst, we establish the fundamental principles. The standard enthalpy of reaction, $\\Delta H_{rxn}^{\\circ}$, is determined by Hess's law, which states that the total enthalpy change for a reaction is the sum of the standard enthalpies of formation of the products minus the sum of the standard enthalpies of formation of the reactants, each weighted by their stoichiometric coefficients ($n_i$):\n$$ \\Delta H_{rxn}^{\\circ} = \\sum_{products} n_p \\Delta H_{f,p}^{\\circ} - \\sum_{reactants} n_r \\Delta H_{f,r}^{\\circ} $$\nThe heating value ($HV$) of a fuel is defined as the negative of its standard enthalpy of combustion, $\\Delta H_{c}^{\\circ}$.\n$$ HV = -\\Delta H_{c}^{\\circ} $$\nBy convention, the standard enthalpy of combustion is the enthalpy of reaction for the complete combustion of one mole of the fuel.\n\nThe Higher Heating Value (HHV) is defined for the case where water, a product of combustion, is in the liquid phase. The Lower Heating Value (LHV) is defined for the case where product water is in the gaseous phase.\n\nThe problem describes a correct HHV calculation and an incorrect one. Let's formalize these.\n\nThe correct HHV, which we denote as $HHV_{correct}$, corresponds to the reaction where water is liquid, $\\mathrm{H_2O(l)}$. The corresponding standard enthalpy of reaction is $\\Delta H_{rxn, l}^{\\circ}$.\n$$ HHV_{correct} = -\\Delta H_{rxn, l}^{\\circ} = -\\left( \\sum_{products} n_p \\Delta H_{f,p}^{\\circ}(\\text{with } \\mathrm{H_2O(l)}) - \\sum_{reactants} n_r \\Delta H_{f,r}^{\\circ} \\right) $$\n\nThe incorrect \"HHV\", which we denote as $\"HHV\"_{incorrect}$, corresponds to the reaction where water is gaseous, $\\mathrm{H_2O(g)}$. The corresponding standard enthalpy of reaction is $\\Delta H_{rxn, g}^{\\circ}$. This value is, in fact, the LHV.\n$$ \"HHV\"_{incorrect} = -\\Delta H_{rxn, g}^{\\circ} = -\\left( \\sum_{products} n_p \\Delta H_{f,p}^{\\circ}(\\text{with } \\mathrm{H_2O(g)}) - \\sum_{reactants} n_r \\Delta H_{f,r}^{\\circ} \\right) $$\n\nThe problem asks for the error, $E$, defined as the difference between the correct HHV and the incorrectly computed value.\n$$ E = HHV_{correct} - \"HHV\"_{incorrect} $$\nSubstituting the definitions above:\n$$ E = (-\\Delta H_{rxn, l}^{\\circ}) - (-\\Delta H_{rxn, g}^{\\circ}) = \\Delta H_{rxn, g}^{\\circ} - \\Delta H_{rxn, l}^{\\circ} $$\nNow, we substitute the expressions based on Hess's Law:\n$$ E = \\left( \\sum_{products} n_p \\Delta H_{f,p}^{\\circ}(\\text{with } \\mathrm{H_2O(g)}) - \\sum_{reactants} n_r \\Delta H_{f,r}^{\\circ} \\right) - \\left( \\sum_{products} n_p \\Delta H_{f,p}^{\\circ}(\\text{with } \\mathrm{H_2O(l)}) - \\sum_{reactants} n_r \\Delta H_{f,r}^{\\circ} \\right) $$\nThe terms for the reactants and any products other than water are identical in both summations and thus cancel out. Let $n_{\\mathrm{H_2O}}$ be the stoichiometric coefficient of water in the combustion reaction. The expression for the error simplifies to:\n$$ E = n_{\\mathrm{H_2O}} \\Delta H_{f}^{\\circ}(\\mathrm{H_2O(g)}) - n_{\\mathrm{H_2O}} \\Delta H_{f}^{\\circ}(\\mathrm{H_2O(l)}) $$\n$$ E = n_{\\mathrm{H_2O}} \\left[ \\Delta H_{f}^{\\circ}(\\mathrm{H_2O(g)}) - \\Delta H_{f}^{\\circ}(\\mathrm{H_2O(l)}) \\right] $$\nThe term in the brackets is the standard enthalpy of vaporization of water at $T_0 = 298\\ \\mathrm{K}$, $\\Delta H_{vap}^{\\circ}(\\mathrm{H_2O})$.\n$$ \\Delta H_{vap}^{\\circ}(\\mathrm{H_2O}) = \\Delta H_{f}^{\\circ}(\\mathrm{H_2O(g)}) - \\Delta H_{f}^{\\circ}(\\mathrm{H_2O(l)}) $$\nThus, the error is simply the product of the number of moles of water produced per mole of fuel and the standard enthalpy of vaporization of water.\n\nUsing the provided data:\n$\\Delta H_{f}^{\\circ}(\\mathrm{H_2O(l)}) = -285.83\\ \\mathrm{kJ/mol}$\n$\\Delta H_{f}^{\\circ}(\\mathrm{H_2O(g)}) = -241.82\\ \\mathrm{kJ/mol}$\n\nWe calculate the standard enthalpy of vaporization of water:\n$$ \\Delta H_{vap}^{\\circ}(\\mathrm{H_2O}) = (-241.82\\ \\mathrm{kJ/mol}) - (-285.83\\ \\mathrm{kJ/mol}) = 44.01\\ \\mathrm{kJ/mol} $$\n\nNow, we apply this result to each fuel based on its stoichiometry.\n\n**1. Methane ($\\mathrm{CH_4}$)**\nThe stoichiometric combustion reaction is:\n$$ \\mathrm{CH_{4}(g)} + 2\\,\\mathrm{O_{2}(g)} \\to \\mathrm{CO_{2}(g)} + 2\\,\\mathrm{H_{2}O}(\\text{phase}) $$\nFor each mole of methane combusted, $n_{\\mathrm{H_2O}} = 2$ moles of water are produced.\nThe error for methane, $E_{\\mathrm{CH_4}}$, is:\n$$ E_{\\mathrm{CH_4}} = 2 \\times \\Delta H_{vap}^{\\circ}(\\mathrm{H_2O}) = 2 \\times 44.01\\ \\mathrm{kJ/mol} = 88.02\\ \\mathrm{kJ/mol} $$\nThis is the amount by which the HHV is underestimated per mole of $\\mathrm{CH_4}$.\n\n**2. Hydrogen ($\\mathrm{H_2}$)**\nThe stoichiometric combustion reaction is:\n$$ \\mathrm{H_{2}(g)} + \\tfrac{1}{2}\\,\\mathrm{O_{2}(g)} \\to \\mathrm{H_{2}O}(\\text{phase}) $$\nFor each mole of hydrogen combusted, $n_{\\mathrm{H_2O}} = 1$ mole of water is produced.\nThe error for hydrogen, $E_{\\mathrm{H_2}}$, is:\n$$ E_{\\mathrm{H_2}} = 1 \\times \\Delta H_{vap}^{\\circ}(\\mathrm{H_2O}) = 1 \\times 44.01\\ \\mathrm{kJ/mol} = 44.01\\ \\mathrm{kJ/mol} $$\nThis is the amount by which the HHV is underestimated per mole of $\\mathrm{H_2}$.\n\nThe problem requires the answers to be rounded to four significant figures. Our results, $88.02\\ \\mathrm{kJ/mol}$ and $44.01\\ \\mathrm{kJ/mol}$, are already presented to four significant figures, consistent with the precision of the input data.\n\nThe final answer is presented as a row matrix with the result for methane first, followed by hydrogen.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n88.02 & 44.01\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond calculating the total energy released, a central task in combustion is to determine the resulting temperature of the products under adiabatic conditions—the adiabatic flame temperature, $T_{\\mathrm{ad}}$. This practice  bridges fundamental thermodynamics with computational methods by challenging you to solve the energy balance equation for $T_{\\mathrm{ad}}$. You will implement a robust numerical solution using temperature-dependent NASA polynomial models for heat capacity and critically assess the bias introduced by the common simplification of using a constant specific heat, $c_p$, a vital skill for any computational modeler.",
            "id": "4029768",
            "problem": "You are asked to quantify, for a canonical complete combustion case, the bias introduced by using a constant isobaric specific heat capacity $c_p$ instead of temperature-dependent $C_p(T)$ for computing the adiabatic flame temperature $T_{\\mathrm{ad}}$ of the product mixture. The setting is a stoichiometric methane–air reaction at standard conditions, with water in the vapor phase. You must derive from first principles the governing energy balance, implement a computational procedure to obtain $T_{\\mathrm{ad}}$ with temperature-dependent $C_p(T)$ modeled by well-tested polynomials, then compute the approximation bias when using a constant $c_p$ chosen at various representative temperatures, and assess whether the approximation is acceptable.\n\nFundamental base to use:\n- The First Law of Thermodynamics for a steady, adiabatic, single-inlet, single-outlet reactive flow with negligible shaft work, kinetic energy, and potential energy changes states an enthalpy balance: the total molar enthalpy of products equals the total molar enthalpy of reactants. For complete combustion at constant pressure and adiabatic conditions, this reduces to\n$$\n\\sum_{j \\in \\text{products}} n_j \\, h_j(T_{\\mathrm{ad}}) \\;=\\; \\sum_{i \\in \\text{reactants}} n_i \\, h_i(T_0) \\,,\n$$\nwhere $n_k$ denotes stoichiometric molar coefficients and $h_k(T)$ denotes molar enthalpy at temperature $T$.\n- Decompose $h_k(T)$ into standard formation enthalpy at a reference temperature $T_{\\mathrm{ref}}$ and sensible enthalpy due to heating from $T_{\\mathrm{ref}}$ to $T$: \n$$\nh_k(T) \\;=\\; h_k^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} C_{p,k}(T')\\, dT' \\,.\n$$\n- Define the standard molar heat of reaction at $T_{\\mathrm{ref}}$ as\n$$\n\\Delta H_{\\mathrm{rxn}}^\\circ(T_{\\mathrm{ref}}) \\;=\\; \\sum_{j \\in \\text{products}} n_j \\, h_j^\\circ(T_{\\mathrm{ref}}) \\;-\\; \\sum_{i \\in \\text{reactants}} n_i \\, h_i^\\circ(T_{\\mathrm{ref}}) \\,.\n$$\nFor complete combustion of methane to carbon dioxide and water vapor at $T_{\\mathrm{ref}} = T_0$, this quantity is negative, and the heat release magnitude is \n$$\nQ \\;=\\; -\\Delta H_{\\mathrm{rxn}}^\\circ(T_{\\mathrm{ref}}) \\,,\n$$\na positive number.\n\nDerivation target:\n- Starting from the above fundamentals, show that when $T_{\\mathrm{ref}} = T_0$ and reactants enter at $T_0$, the adiabatic flame temperature $T_{\\mathrm{ad}}$ satisfies \n$$\n\\sum_{j \\in \\text{products}} n_j \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' \\;=\\; Q \\,.\n$$\n- In the constant-$c_p$ approximation where each product is assumed to have constant specific heat independent of $T$, the balance reduces to \n$$\n\\left( \\sum_{j \\in \\text{products}} n_j \\, c_{p,j}^{\\mathrm{const}} \\right) \\, (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0) \\;=\\; Q \\,,\n$$\nfrom which \n$$\nT_{\\mathrm{ad}}^{\\mathrm{const}} \\;=\\; T_0 + \\frac{Q}{\\sum_{j \\in \\text{products}} n_j \\, c_{p,j}^{\\mathrm{const}}} \\,.\n$$\n\nCombustion system specifications:\n- Stoichiometric methane–air reaction at constant pressure, neglecting dissociation and minor species formation:\n$$\n\\mathrm{CH_4} + 2\\,\\mathrm{O_2} + 7.52\\,\\mathrm{N_2} \\;\\to\\; \\mathrm{CO_2} + 2\\,\\mathrm{H_2O} + 7.52\\,\\mathrm{N_2} \\,.\n$$\n- Reference and inlet temperature: $T_{\\mathrm{ref}} = T_0 = 300$ K.\n- Standard molar heat of reaction to water vapor at $T_{\\mathrm{ref}}$: $\\Delta H_{\\mathrm{rxn}}^\\circ(T_{\\mathrm{ref}}) = -802340$ J/mol of $\\mathrm{CH_4}$, giving $Q = 802340$ J/mol of $\\mathrm{CH_4}$.\n- Product stoichiometric molar coefficients per mole of $\\mathrm{CH_4}$: $n_{\\mathrm{CO_2}} = 1$, $n_{\\mathrm{H_2O}} = 2$, $n_{\\mathrm{N_2}} = 7.52$.\n\nThermochemical property model:\n- Ideal gas mixture; product $C_{p,j}(T)$ for $j \\in \\{\\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{N_2}\\}$ modeled by the five-term temperature-dependent polynomial form widely used in the NASA seven-coefficient thermodynamic polynomials:\n$$\n\\frac{C_{p,j}(T)}{R} \\;=\\; a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\,,\n$$\nwith the universal gas constant $R = 8.314462618$ J/(mol·K) and species-dependent coefficients $\\{a_m\\}$ specified piecewise over temperature ranges. The sensible enthalpy change over a temperature interval $[T_1, T_2]$ is obtained by integrating $C_{p,j}(T)$:\n$$\n\\Delta h_j(T_1 \\to T_2) \\;=\\; \\int_{T_1}^{T_2} C_{p,j}(T)\\, dT \\;=\\; R \\left[ a_1 (T_2 - T_1) + \\frac{a_2}{2} (T_2^2 - T_1^2) + \\frac{a_3}{3} (T_2^3 - T_1^3) + \\frac{a_4}{4} (T_2^4 - T_1^4) + \\frac{a_5}{5} (T_2^5 - T_1^5) \\right] \\,,\n$$\napplied piecewise with continuity at range boundaries.\n\nPiecewise coefficients to use (valid ranges in Kelvin):\n- $\\mathrm{N_2}$:\n  - Low ($200 \\le T \\le 1000$): $a_1 = 3.53100528$, $a_2 = -1.23660987\\times 10^{-4}$, $a_3 = -5.02999437\\times 10^{-7}$, $a_4 = 2.43530612\\times 10^{-9}$, $a_5 = -1.40881235\\times 10^{-12}$.\n  - High ($1000 \\le T \\le 6000$): $a_1 = 2.95257626$, $a_2 = 1.39690040\\times 10^{-3}$, $a_3 = -4.92631603\\times 10^{-7}$, $a_4 = 7.86010367\\times 10^{-11}$, $a_5 = -4.60755321\\times 10^{-15}$.\n- $\\mathrm{CO_2}$:\n  - Low ($300 \\le T \\le 1200$): $a_1 = 2.35677352$, $a_2 = 8.98459677\\times 10^{-3}$, $a_3 = -7.12356269\\times 10^{-6}$, $a_4 = 2.45919022\\times 10^{-9}$, $a_5 = -1.43699548\\times 10^{-13}$.\n  - High ($1200 \\le T \\le 6000$): $a_1 = 3.85796028$, $a_2 = 4.41437026\\times 10^{-3}$, $a_3 = -2.21481404\\times 10^{-6}$, $a_4 = 5.23490188\\times 10^{-10}$, $a_5 = -4.72084164\\times 10^{-14}$.\n- $\\mathrm{H_2O}$:\n  - Low ($300 \\le T \\le 1700$): $a_1 = 3.38684249$, $a_2 = 3.47498246\\times 10^{-3}$, $a_3 = -6.35469639\\times 10^{-6}$, $a_4 = 6.96858127\\times 10^{-9}$, $a_5 = -2.50658847\\times 10^{-12}$.\n  - High ($1700 \\le T \\le 6000$): $a_1 = 2.67214561$, $a_2 = 3.05629289\\times 10^{-3}$, $a_3 = -8.73026011\\times 10^{-7}$, $a_4 = 1.20099639\\times 10^{-10}$, $a_5 = -6.39161884\\times 10^{-15}$.\n\nComputational tasks:\n1. Implement a solver for $T_{\\mathrm{ad}}$ by satisfying \n$$\n\\sum_{j \\in \\{\\mathrm{CO_2},\\mathrm{H_2O},\\mathrm{N_2}\\}} n_j \\, \\Delta h_j(T_0 \\to T_{\\mathrm{ad}}) \\;=\\; Q \\,,\n$$\nwith $T_0 = 300$ K and $Q = 802340$ J/mol. Solve for $T_{\\mathrm{ad}}$ using a robust bracketed root-finding method over $[1000, 3500]$ K, assuming monotonic increase of $\\sum_j n_j \\Delta h_j$ with $T$ under the given model and neglecting dissociation.\n2. For the constant-$c_p$ approximation, define \n$$\nc_{p,j}^{\\mathrm{const}} \\;=\\; C_{p,j}(T_{\\mathrm{const}}) \\,,\n$$\nwith $T_{\\mathrm{const}}$ provided per test case, and compute \n$$\nT_{\\mathrm{ad}}^{\\mathrm{const}} \\;=\\; T_0 + \\frac{Q}{\\sum_j n_j \\, c_{p,j}^{\\mathrm{const}}} \\,.\n$$\n3. Compute the absolute bias\n$$\n\\Delta T \\;=\\; T_{\\mathrm{ad}}^{\\mathrm{const}} - T_{\\mathrm{ad}} \\,,\n$$\nexpressed in Kelvin, and the relative bias\n$$\n\\delta \\;=\\; \\frac{|\\Delta T|}{T_{\\mathrm{ad}}} \\,,\n$$\nexpressed as a decimal.\n4. Assess acceptability using the criterion that the approximation is acceptable if both $|\\Delta T| \\le 40$ K and $\\delta \\le 0.02$.\n\nPhysical units and output specifications:\n- Report temperature biases $\\Delta T$ in Kelvin, rounded to $3$ decimal places.\n- The acceptability indicator is a boolean.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain, for each test case in order, the rounded temperature bias followed by the boolean acceptability indicator.\n\nTest suite:\n- Use $4$ test cases with $T_{\\mathrm{const}} \\in \\{800, 1200, 1600, 2200\\}$ K.\n- These cases probe the approximation at substantially sub-adiabatic, near-midrange, near-adiabatic, and super-adiabatic representative temperatures.\n\nFinal output format:\n- Your program must print a single line in the form\n$$\n[\\Delta T_1,\\mathrm{accept}_1,\\Delta T_2,\\mathrm{accept}_2,\\Delta T_3,\\mathrm{accept}_3,\\Delta T_4,\\mathrm{accept}_4]\n$$\nwhere each $\\Delta T_k$ is rounded to $3$ decimal places (in Kelvin) and each $\\mathrm{accept}_k$ is either $\\mathrm{True}$ or $\\mathrm{False}$.",
            "solution": "The problem requires us to quantify the error in calculating the adiabatic flame temperature, $T_{\\mathrm{ad}}$, of a stoichiometric methane-air mixture when using a constant specific heat capacity, $c_p$, versus a temperature-dependent polynomial model, $C_p(T)$. This analysis proceeds in three stages: first, a formal derivation of the governing energy balance equations from first principles; second, the implementation of a numerical solver for the accurate $T_{\\mathrm{ad}}$ using the polynomial model; and third, the computation of the approximate temperature, $T_{\\mathrm{ad}}^{\\mathrm{const}}$, and the resulting bias for several choices of constant $c_p$.\n\n### Principle-Based Derivation\n\nWe begin with the First Law of Thermodynamics for a steady, adiabatic, open-system reactor where changes in kinetic and potential energy and shaft work are negligible. The energy balance reduces to an enthalpy balance: the total molar enthalpy of the products leaving the system equals the total molar enthalpy of the reactants entering.\n$$\n\\sum_{j \\in \\text{products}} n_j \\, h_j(T_{\\mathrm{ad}}) = \\sum_{i \\in \\text{reactants}} n_i \\, h_i(T_0)\n$$\nHere, $n_k$ are the stoichiometric coefficients, $h_k(T)$ is the molar enthalpy of species $k$ at temperature $T$, $T_0$ is the initial temperature of reactants, and $T_{\\mathrm{ad}}$ is the final adiabatic flame temperature of the products.\n\nThe molar enthalpy $h_k(T)$ is expressed as the sum of the standard molar enthalpy of formation at a reference temperature $T_{\\mathrm{ref}}$, $h_k^\\circ(T_{\\mathrm{ref}})$, and the sensible enthalpy change from $T_{\\mathrm{ref}}$ to $T$:\n$$\nh_k(T) = h_k^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} C_{p,k}(T')\\, dT'\n$$\nBy selecting the reference temperature to be the same as the reactant inlet temperature, $T_{\\mathrm{ref}} = T_0 = 300 \\, \\mathrm{K}$, the enthalpy balance becomes:\n$$\n\\sum_{j \\in \\text{products}} n_j \\left( h_j^\\circ(T_0) + \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' \\right) = \\sum_{i \\in \\text{reactants}} n_i \\left( h_i^\\circ(T_0) + \\int_{T_0}^{T_0} C_{p,i}(T')\\, dT' \\right)\n$$\nThe integral for the reactants vanishes as the integration interval is zero. Rearranging the equation to group the enthalpies of formation gives:\n$$\n\\sum_{j \\in \\text{products}} n_j \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' = \\sum_{i \\in \\text{reactants}} n_i h_i^\\circ(T_0) - \\sum_{j \\in \\text{products}} n_j h_j^\\circ(T_0)\n$$\nThe right-hand side is the negative of the standard heat of reaction at $T_0$, which is defined as $\\Delta H_{\\mathrm{rxn}}^\\circ(T_0) = \\sum_{j} n_j h_j^\\circ(T_0) - \\sum_{i} n_i h_i^\\circ(T_0)$. The heat released by the exothermic reaction, $Q$, is $Q = -\\Delta H_{\\mathrm{rxn}}^\\circ(T_0)$. This leads to the first target equation, which governs the \"true\" adiabatic flame temperature:\n$$\n\\sum_{j \\in \\text{products}} n_j \\int_{T_0}^{T_{\\mathrm{ad}}} C_{p,j}(T')\\, dT' = Q\n$$\nThis equation physically states that the total heat released by the reaction ($Q$) is completely absorbed by the product gases, raising their temperature from $T_0$ to $T_{\\mathrm{ad}}$.\n\nFor the constant specific heat approximation, we assume $C_{p,j}(T) = c_{p,j}^{\\mathrm{const}}$ for each product species $j$. The integral simplifies significantly:\n$$\n\\int_{T_0}^{T_{\\mathrm{ad}}^{\\mathrm{const}}} c_{p,j}^{\\mathrm{const}}\\, dT' = c_{p,j}^{\\mathrm{const}} (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0)\n$$\nSubstituting this into the energy balance yields:\n$$\n\\sum_{j \\in \\text{products}} n_j c_{p,j}^{\\mathrm{const}} (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0) = Q\n$$\nFactoring out the common temperature difference term $(T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0)$ gives:\n$$\n\\left( \\sum_{j \\in \\text{products}} n_j c_{p,j}^{\\mathrm{const}} \\right) (T_{\\mathrm{ad}}^{\\mathrm{const}} - T_0) = Q\n$$\nSolving for the approximate adiabatic flame temperature, $T_{\\mathrm{ad}}^{\\mathrm{const}}$, provides the second target equation:\n$$\nT_{\\mathrm{ad}}^{\\mathrm{const}} = T_0 + \\frac{Q}{\\sum_{j \\in \\text{products}} n_j c_{p,j}^{\\mathrm{const}}}\n$$\nThis completes the required derivation.\n\n### Computational Procedure\n\nThe core of the task is to solve the nonlinear equation $\\sum_{j} n_j \\Delta h_j(T_0 \\to T_{\\mathrm{ad}}) - Q = 0$ for $T_{\\mathrm{ad}}$.\n\n1.  **Thermochemical Data Representation**: The species-specific polynomial coefficients for $C_p(T)$ are stored in a nested dictionary structure. This allows for efficient lookup of the appropriate coefficient set based on species name and temperature. Key constants like the universal gas constant $R$, initial temperature $T_0$, heat release $Q$, and stoichiometric coefficients $n_j$ for the products ($\\mathrm{CO_2}, \\mathrm{H_2O}, \\mathrm{N_2}$) are defined.\n\n2.  **Specific Heat and Enthalpy Functions**:\n    - A function `cp_species(T, species)` is implemented to calculate the molar specific heat $C_{p,j}(T)$ for a given species $j$ at temperature $T$. It first identifies the correct set of polynomial coefficients $\\{a_m\\}$ based on $T$ falling into the low- or high-temperature range, then evaluates the polynomial $C_{p,j}(T) = R \\sum_{m=1}^{5} a_m T^{m-1}$.\n    - A function `delta_h_species(T_start, T_end, species)` calculates the sensible enthalpy change $\\Delta h_j = \\int_{T_{\\mathrm{start}}}^{T_{\\mathrm{end}}} C_{p,j}(T') dT'$. This function correctly handles piecewise integration. If the interval $[T_{\\mathrm{start}}, T_{\\mathrm{end}}]$ crosses the temperature boundary where the coefficients change, the integral is split into two parts, each using the appropriate set of coefficients. The integral itself is calculated using the analytical formula: $\\Delta h_j = R \\sum_{m=1}^{5} \\frac{a_m}{m} (T_{\\mathrm{end}}^m - T_{\\mathrm{start}}^m)$.\n\n3.  **Root-Finding for $T_{\\mathrm{ad}}$**:\n    - A function `f_root(T)` representing the energy balance residual, $f(T) = \\left( \\sum_{j} n_j \\Delta h_j(T_0 \\to T) \\right) - Q$, is defined. The true adiabatic flame temperature $T_{\\mathrm{ad}}$ is the root of this function, i.e., where $f(T_{\\mathrm{ad}}) = 0$.\n    - Since the total sensible enthalpy of the products is a monotonically increasing function of temperature (as all $C_p>0$), the function $f(T)$ will have a unique root. We employ a robust bracketed root-finding algorithm, `scipy.optimize.brentq`, to solve for $T_{\\mathrm{ad}}$ within the specified interval $[1000, 3500]\\,\\mathrm{K}$.\n\n4.  **Bias Analysis**:\n    - After determining the accurate $T_{\\mathrm{ad}}$, we iterate through the given test cases for the representative temperature $T_{\\mathrm{const}} \\in \\{800, 1200, 1600, 2200\\}\\,\\mathrm{K}$.\n    - For each $T_{\\mathrm{const}}$, the constant specific heat for each product species, $c_{p,j}^{\\mathrm{const}} = C_{p,j}(T_{\\mathrm{const}})$, is calculated using the `cp_species` function.\n    - The total heat capacity of the product mixture is computed as $\\sum_j n_j c_{p,j}^{\\mathrm{const}}$.\n    - The approximate flame temperature $T_{\\mathrm{ad}}^{\\mathrm{const}}$ is calculated using its derived explicit formula.\n    - The absolute bias $\\Delta T = T_{\\mathrm{ad}}^{\\mathrm{const}} - T_{\\mathrm{ad}}$ and relative bias $\\delta = |\\Delta T|/T_{\\mathrm{ad}}$ are computed.\n    - An acceptability check is performed based on the criteria $|\\Delta T| \\le 40\\,\\mathrm{K}$ and $\\delta \\le 0.02$.\n\n5.  **Output Generation**: The results for each test case, comprising the rounded temperature bias and the boolean acceptability indicator, are collected into a list and printed in the required single-line format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the adiabatic flame temperature for stoichiometric methane-air combustion\n    and analyzes the bias from using constant specific heat approximations.\n    \"\"\"\n    # 1. Define constants, stoichiometry, and thermochemical data\n    R = 8.314462618  # Universal gas constant, J/(mol·K)\n    T0 = 300.0       # Initial and reference temperature, K\n    Q = 802340.0     # Heat release per mole of CH4, J/mol\n\n    # Stoichiometric coefficients of products per mole of CH4\n    n_prod = {'CO2': 1.0, 'H2O': 2.0, 'N2': 7.52}\n\n    # NASA polynomial coefficients for Cp/R = a1 + a2*T + a3*T^2 + a4*T^3 + a5*T^4\n    # Structure: {species: {'low'/'high': ([coeffs], T_min, T_max)}}\n    coeffs_data = {\n        'N2': {\n            'low':  ([3.53100528, -1.23660987e-4, -5.02999437e-7, 2.43530612e-9, -1.40881235e-12], 200.0, 1000.0),\n            'high': ([2.95257626, 1.39690040e-3, -4.92631603e-7, 7.86010367e-11, -4.60755321e-15], 1000.0, 6000.0)\n        },\n        'CO2': {\n            'low':  ([2.35677352, 8.98459677e-3, -7.12356269e-6, 2.45919022e-9, -1.43699548e-13], 300.0, 1200.0),\n            'high': ([3.85796028, 4.41437026e-3, -2.21481404e-6, 5.23490188e-10, -4.72084164e-14], 1200.0, 6000.0)\n        },\n        'H2O': {\n            'low':  ([3.38684249, 3.47498246e-3, -6.35469639e-6, 6.96858127e-9, -2.50658847e-12], 300.0, 1700.0),\n            'high': ([2.67214561, 3.05629289e-3, -8.73026011e-7, 1.20099639e-10, -6.39161884e-15], 1700.0, 6000.0)\n        }\n    }\n\n    # 2. Implement helper functions for thermochemical properties\n    def get_coeffs_for_T(T, species):\n        \"\"\"Returns the appropriate polynomial coefficient set for a given temperature.\"\"\"\n        low_coeffs, _, T_low_max = coeffs_data[species]['low']\n        high_coeffs, T_high_min, _ = coeffs_data[species]['high']\n        # The ranges are inclusive. T at the boundary can use either set.\n        if T = T_low_max:\n            return low_coeffs\n        else: # T > T_low_max, must be in high range\n            return high_coeffs\n\n    def cp_species(T, species):\n        \"\"\"Computes molar specific heat Cp for a species at temperature T.\"\"\"\n        a = get_coeffs_for_T(T, species)\n        T_powers = np.array([1.0, T, T**2, T**3, T**4])\n        return R * np.dot(a, T_powers)\n\n    def h_integral_poly(T1, T2, coeffs_list):\n        \"\"\"Computes the definite integral of Cp(T) from T1 to T2 using a single polynomial.\"\"\"\n        a = np.array(coeffs_list)\n        p = np.arange(1, 6)\n        term2 = np.sum(a * (T2**p) / p)\n        term1 = np.sum(a * (T1**p) / p)\n        return R * (term2 - term1)\n\n    def delta_h_species(T_start, T_end, species):\n        \"\"\"Computes sensible enthalpy change, handling piecewise polynomials.\"\"\"\n        low_coeffs, _, T_boundary = coeffs_data[species]['low']\n        high_coeffs, _, _ = coeffs_data[species]['high']\n\n        if T_end = T_boundary:\n            return h_integral_poly(T_start, T_end, low_coeffs)\n        elif T_start >= T_boundary:\n            return h_integral_poly(T_start, T_end, high_coeffs)\n        else: # Interval crosses the boundary T_start  T_boundary  T_end\n            h_low_part = h_integral_poly(T_start, T_boundary, low_coeffs)\n            h_high_part = h_integral_poly(T_boundary, T_end, high_coeffs)\n            return h_low_part + h_high_part\n\n    # 3. Define the root function for the energy balance\n    def f_root(T):\n        \"\"\"\n        Energy balance residual: Total sensible enthalpy of products minus heat release.\n        The root of this function is the adiabatic flame temperature.\n        \"\"\"\n        total_h_products = sum(n * delta_h_species(T0, T, species) for species, n in n_prod.items())\n        return total_h_products - Q\n\n    # 4. Solve for the accurate adiabatic flame temperature T_ad\n    T_ad_bracket = [1000.0, 3500.0]\n    # Check if the root is bracketed\n    # assert f_root(T_ad_bracket[0])  0 and f_root(T_ad_bracket[1]) > 0\n    T_ad = brentq(f_root, T_ad_bracket[0], T_ad_bracket[1], xtol=1e-8)\n\n    # 5. Process test cases to evaluate the constant Cp approximation\n    test_cases_T_const = [800.0, 1200.0, 1600.0, 2200.0]\n    results = []\n\n    for T_const in test_cases_T_const:\n        # a) Compute total mixture heat capacity using the constant Cp approximation\n        sum_n_cp_const = sum(n * cp_species(T_const, species) for species, n in n_prod.items())\n\n        # b) Compute approximate adiabatic flame temperature\n        T_ad_const = T0 + Q / sum_n_cp_const\n        \n        # c) Compute biases\n        delta_T = T_ad_const - T_ad\n        delta_rel = abs(delta_T) / T_ad\n        \n        # d) Assess acceptability based on given criteria\n        is_acceptable = (abs(delta_T) = 40.0) and (delta_rel = 0.02)\n        \n        results.append(round(delta_T, 3))\n        results.append(is_acceptable)\n        \n    # 6. Format and print final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}