{
    "hands_on_practices": [
        {
            "introduction": "在进行任何燃烧模拟之前，确保所有物理量采用一致的单位制是至关重要的一步。本练习将指导您完成一个基本但关键的任务：将文献中常见的混合cgs单位制反应速率常数转换为严格的国际单位制（SI）。通过这个过程，您不仅能掌握单位换算的技巧，还能加深对不同反应通道在特定条件下相对重要性的理解。",
            "id": "4056781",
            "problem": "考虑在理想搅拌反应器 (PSR) 内的均匀气体混合物中发生的单步自由基消耗过程，其中自由基 $\\mathrm{R}$ 通过两个基元反应通道与 $\\mathrm{O_2}$ 反应：\n- 通道 A (双分子)：$\\mathrm{R} + \\mathrm{O_2} \\rightarrow \\text{产物}$，浓度为二级。\n- 通道 B (有第三体 $\\mathrm{M}$ 参与的三分子)：$\\mathrm{R} + \\mathrm{O_2} + \\mathrm{M} \\rightarrow \\text{产物} + \\mathrm{M}$，浓度为三级。\n\n现提供以厘米-克-秒 (cgs) 混合摩尔单位表示的气相反应速率常数：\n- 通道 A：$k_{2}^{\\mathrm{cgs}} = 1.20 \\times 10^{13}\\ \\mathrm{cm^{3}\\,mol^{-1}\\,s^{-1}}$，\n- 通道 B：$k_{3}^{\\mathrm{cgs}} = 3.00 \\times 10^{17}\\ \\mathrm{cm^{6}\\,mol^{-2}\\,s^{-1}}$。\n\n混合物是理想气体，其总压 $P = 1.50\\ \\mathrm{atm}$，温度 $T = 1800\\ \\mathrm{K}$。假设为基元步骤动力学，因此通道 A 的反应速率为 $r_{2} = k_{2}[\\mathrm{R}][\\mathrm{O_2}]$，通道 B 的反应速率为 $r_{3} = k_{3}[\\mathrm{R}][\\mathrm{O_2}][\\mathrm{M}]$，其中方括号表示摩尔浓度，单位为 $\\mathrm{mol\\,m^{-3}}$。\n\n任务：\n1. 从基本单位定义出发，将 $k_{2}^{\\mathrm{cgs}}$ 转换为国际单位制 (SI) 单位 $\\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}}$，并将 $k_{3}^{\\mathrm{cgs}}$ 转换为 SI 单位 $\\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}}$。仅使用定义 $1\\ \\mathrm{m} = 100\\ \\mathrm{cm}$ 以及对 $\\mathrm{mol}$ 和 $\\mathrm{s}$ 的恒等变换。\n2. 使用理想气体定律和普适气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$（其中 $1\\ \\mathrm{J} = 1\\ \\mathrm{Pa\\,m^{3}}$ 和 $1\\ \\mathrm{atm} = 1.01325 \\times 10^{5}\\ \\mathrm{Pa}$），计算在给定 $(P,T)$ 条件下的总摩尔浓度 $[\\mathrm{M}]$，单位为 $\\mathrm{mol\\,m^{-3}}$。\n3. 通过量纲分析验证，当所有量都使用 SI 单位时，$r_{2}$ 和 $r_{3}$ 的单位均为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$。\n4. 在给定的 $(P,T)$ 条件下，使用您通过 SI 单位转换后的速率常数以及任务 2 中得到的 $[\\mathrm{M}]$，计算无量纲比率 $\\phi = r_{3}/r_{2}$。\n\n将 $\\phi$ 的最终结果表示为一个纯数，四舍五入至四位有效数字。最终答案中无需提供中间结果，但您的推理必须与上述指定的基本依据保持一致。",
            "solution": "首先将根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n问题陈述中提供的数据、变量和条件如下：\n- 反应通道 A：$\\mathrm{R} + \\mathrm{O_2} \\rightarrow \\text{产物}$，二级。\n- 反应通道 B：$\\mathrm{R} + \\mathrm{O_2} + \\mathrm{M} \\rightarrow \\text{产物} + \\mathrm{M}$，三级。\n- 通道 A 的速率常数：$k_{2}^{\\mathrm{cgs}} = 1.20 \\times 10^{13}\\ \\mathrm{cm^{3}\\,mol^{-1}\\,s^{-1}}$。\n- 通道 B 的速率常数：$k_{3}^{\\mathrm{cgs}} = 3.00 \\times 10^{17}\\ \\mathrm{cm^{6}\\,mol^{-2}\\,s^{-1}}$。\n- 通道 A 的速率表达式：$r_{2} = k_{2}[\\mathrm{R}][\\mathrm{O_2}]$。\n- 通道 B 的速率表达式：$r_{3} = k_{3}[\\mathrm{R}][\\mathrm{O_2}][\\mathrm{M}]$。\n- 摩尔浓度 `[...]` 的单位指定为 $\\mathrm{mol\\,m^{-3}}$。\n- 总压：$P = 1.50\\ \\mathrm{atm}$。\n- 温度：$T = 1800\\ \\mathrm{K}$。\n- 气体混合物为理想气体。\n- 单位转换定义：$1\\ \\mathrm{m} = 100\\ \\mathrm{cm}$。\n- 普适气体常数：$R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 能量单位转换：$1\\ \\mathrm{J} = 1\\ \\mathrm{Pa\\,m^{3}}$。\n- 压力单位转换：$1\\ \\mathrm{atm} = 1.01325 \\times 10^{5}\\ \\mathrm{Pa}$。\n- 需要计算一个无量纲比率 $\\phi = r_{3}/r_{2}$。\n\n_注意：问题陈述对速率常数使用了 cgs/摩尔混合单位，这在燃烧领域的文献中是一种常见但有时会引起混淆的惯例。本任务明确要求将其转换为一致的 SI 单位制。_\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据充分：** 该问题基于化学动力学的基本原理，特别是基元反应的质量作用定律。双分子和三分子反应、速率常数、反应级数以及理想气体定律的使用是物理化学和燃烧科学中的标准概念。所提供的值在高温气相反应的合理范围内。该问题没有科学缺陷。\n- **提法恰当：** 该问题提供了执行所需计算的所有必要数据、常数和明确指令。四个任务逻辑结构清晰，能够得出目标比率 $\\phi$ 的唯一数值解。\n- **客观性：** 该问题以精确、定量的术语陈述，没有任何主观性或偏见。\n- **完整且一致：** 该问题自成体系。所有必要的单位转换和物理常数均已提供。没有内部矛盾。\n- **不切实际或不可行：** 压力 ($1.50\\ \\mathrm{atm}$) 和温度 ($1800\\ \\mathrm{K}$) 的条件对于燃烧过程是现实的。速率常数的值在物理上是合理的。\n- **提法不当或结构不良：** 该问题结构清晰，且有唯一解。\n- **过于简单或同义反复：** 该问题需要多步计算，涉及单位转换、物理定律的应用、量纲分析和代数运算。这是一个应用基本原理的实质性练习。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的，提法恰当，并且内部一致。因此被判定为**有效**。将提供完整解答。\n\n---\n\n### 解答\n\n解答过程将通过执行问题陈述中列出的四个任务来进行。\n\n**任务 1：将速率常数转换为 SI 单位。**\n\n速率常数所需的 SI 单位，对 $k_2$ 是 $\\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}}$，对 $k_3$ 是 $\\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}}$。转换依赖于定义 $1\\ \\mathrm{m} = 100\\ \\mathrm{cm}$。\n\n对于二级速率常数 $k_2$：\n体积的换算因子推导如下：\n$$1\\ \\mathrm{m} = 100\\ \\mathrm{cm} = 10^2\\ \\mathrm{cm}$$\n$$(1\\ \\mathrm{m})^3 = (10^2\\ \\mathrm{cm})^3 \\implies 1\\ \\mathrm{m^3} = 10^6\\ \\mathrm{cm^3}$$\n因此，$1\\ \\mathrm{cm^3} = 10^{-6}\\ \\mathrm{m^3}$。\n我们将 $k_{2}^{\\mathrm{cgs}}$ 转换为 $k_{2}^{\\mathrm{SI}}$：\n$$k_{2}^{\\mathrm{SI}} = (1.20 \\times 10^{13}\\ \\mathrm{cm^{3}\\,mol^{-1}\\,s^{-1}}) \\times \\left( \\frac{10^{-6}\\ \\mathrm{m^3}}{1\\ \\mathrm{cm^3}} \\right)$$\n$$k_{2}^{\\mathrm{SI}} = 1.20 \\times 10^{13} \\times 10^{-6}\\ \\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}} = 1.20 \\times 10^{7}\\ \\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}}$$\n\n对于三级速率常数 $k_3$：\n体积项平方的换算因子为：\n$$1\\ \\mathrm{cm^6} = (1\\ \\mathrm{cm^3})^2 = (10^{-6}\\ \\mathrm{m^3})^2 = 10^{-12}\\ \\mathrm{m^6}$$\n我们将 $k_{3}^{\\mathrm{cgs}}$ 转换为 $k_{3}^{\\mathrm{SI}}$：\n$$k_{3}^{\\mathrm{SI}} = (3.00 \\times 10^{17}\\ \\mathrm{cm^{6}\\,mol^{-2}\\,s^{-1}}) \\times \\left( \\frac{10^{-12}\\ \\mathrm{m^6}}{1\\ \\mathrm{cm^6}} \\right)$$\n$$k_{3}^{\\mathrm{SI}} = 3.00 \\times 10^{17} \\times 10^{-12}\\ \\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}} = 3.00 \\times 10^{5}\\ \\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}}$$\n\n**任务 2：计算总摩尔浓度 $[\\mathrm{M}]$。**\n\n气体混合物的总摩尔浓度 $[\\mathrm{M}]$ 可以通过理想气体定律 $PV = nRT$ 计算。摩尔浓度定义为 $[\\mathrm{M}] = n/V$，其中 $n$ 是摩尔数，$V$ 是体积。\n整理理想气体定律得到：\n$$[\\mathrm{M}] = \\frac{n}{V} = \\frac{P}{RT}$$\n为了进行计算，所有量都必须采用一致的 SI 单位。压力 $P$ 必须从 $\\mathrm{atm}$ 转换为 $\\mathrm{Pa}$。\n$$P = 1.50\\ \\mathrm{atm} \\times (1.01325 \\times 10^{5}\\ \\mathrm{Pa\\,atm^{-1}}) = 1.519875 \\times 10^{5}\\ \\mathrm{Pa}$$\n现在，我们可以使用给定的 $P$、$T$ 和 $R$ 的值来计算 $[\\mathrm{M}]$：\n$$[\\mathrm{M}] = \\frac{1.519875 \\times 10^{5}\\ \\mathrm{Pa}}{(8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (1800\\ \\mathrm{K})}$$\n单位是一致的，因为 $1\\ \\mathrm{J} = 1\\ \\mathrm{Pa\\,m^3}$：\n$$\\frac{\\mathrm{Pa}}{\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\cdot \\mathrm{K}} = \\frac{\\mathrm{Pa}}{\\mathrm{Pa\\,m^3\\,mol^{-1}}} = \\mathrm{mol\\,m^{-3}}$$\n数值为：\n$$[\\mathrm{M}] = \\frac{1.519875 \\times 10^{5}}{14966.03271} \\approx 10.155519\\ \\mathrm{mol\\,m^{-3}}$$\n这个值将在最终计算中使用。\n\n**任务 3：验证反应速率的单位。**\n\n在体积动力学中，反应速率的单位是单位体积、单位时间内的物质的量，在问题陈述中正确地给出 SI 单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$。\n\n对于速率 $r_2 = k_2[\\mathrm{R}][\\mathrm{O_2}]$：\n令 $[Units(X)]$ 表示量 $X$ 的单位。\n$$[r_2] = [k_2] \\cdot [\\mathrm{R}] \\cdot [\\mathrm{O_2}]$$\n$$[r_2] = (\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}) \\cdot (\\mathrm{mol\\,m^{-3}}) \\cdot (\\mathrm{mol\\,m^{-3}})$$\n$$[r_2] = \\mathrm{m^{3-3-3}} \\cdot \\mathrm{mol^{-1+1+1}} \\cdot \\mathrm{s^{-1}} = \\mathrm{m^{-3}} \\cdot \\mathrm{mol^{1}} \\cdot \\mathrm{s^{-1}}$$\n$$[r_2] = \\mathrm{mol\\,m^{-3}\\,s^{-1}}$$\n单位得到验证。\n\n对于速率 $r_3 = k_3[\\mathrm{R}][\\mathrm{O_2}][\\mathrm{M}]$：\n$$[r_3] = [k_3] \\cdot [\\mathrm{R}] \\cdot [\\mathrm{O_2}] \\cdot [\\mathrm{M}]$$\n$$[r_3] = (\\mathrm{m^6\\,mol^{-2}\\,s^{-1}}) \\cdot (\\mathrm{mol\\,m^{-3}}) \\cdot (\\mathrm{mol\\,m^{-3}}) \\cdot (\\mathrm{mol\\,m^{-3}})$$\n$$[r_3] = \\mathrm{m^{6-3-3-3}} \\cdot \\mathrm{mol^{-2+1+1+1}} \\cdot \\mathrm{s^{-1}} = \\mathrm{m^{-3}} \\cdot \\mathrm{mol^{1}} \\cdot \\mathrm{s^{-1}}$$\n$$[r_3] = \\mathrm{mol\\,m^{-3}\\,s^{-1}}$$\n三级反应的单位也得到了验证。\n\n**任务 4：计算无量纲比率 $\\phi$。**\n\n比率 $\\phi$ 定义为 $\\phi = r_{3}/r_{2}$。代入速率表达式得到：\n$$\\phi = \\frac{r_3}{r_2} = \\frac{k_{3}[\\mathrm{R}][\\mathrm{O_2}][\\mathrm{M}]}{k_{2}[\\mathrm{R}][\\mathrm{O_2}]}$$\n自由基 $[\\mathrm{R}]$ 和氧气 $[\\mathrm{O_2}]$ 的浓度相互消去：\n$$\\phi = \\frac{k_3}{k_2} [\\mathrm{M}]$$\n我们可以使用 SI 单位验证该表达式是无量纲的：\n$$[\\phi] = \\frac{[k_3]}{[k_2]} [\\mathrm{M}] = \\frac{\\mathrm{m^6\\,mol^{-2}\\,s^{-1}}}{\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}} \\cdot (\\mathrm{mol\\,m^{-3}}) = (\\mathrm{m^3\\,mol^{-1}}) \\cdot (\\mathrm{mol\\,m^{-3}}) = 1$$\n现在，我们代入 $k_2$、$k_3$ 和 $[\\mathrm{M}]$ 的 SI 值：\n$$k_{2}^{\\mathrm{SI}} = 1.20 \\times 10^{7}\\ \\mathrm{m^{3}\\,mol^{-1}\\,s^{-1}}$$\n$$k_{3}^{\\mathrm{SI}} = 3.00 \\times 10^{5}\\ \\mathrm{m^{6}\\,mol^{-2}\\,s^{-1}}$$\n$$[\\mathrm{M}] = \\frac{P}{RT} = \\frac{1.50 \\times 1.01325 \\times 10^5}{8.314462618 \\times 1800}\\ \\mathrm{mol\\,m^{-3}}$$\n将这些值代入 $\\phi$ 的表达式中：\n$$\\phi = \\left( \\frac{3.00 \\times 10^{5}}{1.20 \\times 10^{7}} \\right) \\cdot \\left( \\frac{1.50 \\times 1.01325 \\times 10^5}{8.314462618 \\times 1800} \\right)$$\n$$\\phi = (2.5 \\times 10^{-2}) \\cdot (10.155519...)$$\n$$\\phi \\approx 0.2538879...$$\n问题要求最终答案四舍五入至四位有效数字。\n$$\\phi \\approx 0.2539$$\n这个无量纲比率表明，在给定条件下，二级通道的速率大约是三级通道速率的四倍 ($r_2 \\approx r_3 / 0.2539$)。",
            "answer": "$$\n\\boxed{0.2539}\n$$"
        },
        {
            "introduction": "化学动力学模型的构建和优化往往依赖于对实验数据的精确分析。本练习模拟了这一核心研究过程，要求您从第一性原理出发，为喷射搅拌反应器（JSR）的稳态数据推导出一个回归模型 。您将应用该模型，通过分析不同背景气体组分下的模拟实验数据，来估算一个关键动力学参数——第三体碰撞效率。",
            "id": "4056779",
            "problem": "考虑一个在稳态下运行的充分混合、等温、等压的射流搅拌反应器 (JSR)。将一种标记为 $\\mathrm{A}$ 的单一反应物种以极低的摩尔分数引入到由 $\\mathrm{N_2}$、$\\mathrm{Ar}$ 和 $\\mathrm{CO_2}$ 组成的载气混合物中。$\\mathrm{A}$ 的消耗主要由一个第三体辅助步骤主导，该反应对 $\\mathrm{A}$ 是一级反应，对有效第三体浓度也是一级反应。有效第三体浓度定义为由未知的无量纲第三体效率加权的载气物种浓度的线性组合。任务是通过对在多种载气组分下获取的反应器稳态数据进行回归，来估算这些第三体效率。您必须使用的基本出发点是：基元反应的质量作用定律、反应级数和速率常数的定义、连续搅拌反应器的稳态质量平衡以及理想气体定律。\n\n您的程序必须从第一性原理出发，推导出连接所测量的 $\\mathrm{A}$ 的入口和出口组分、停留时间以及有效第三体浓度的控制关系式，然后将该关系式表达为适合对未知效率进行回归的形式。您不得依赖任何预先给定的简化公式；所有所需的关系式都必须从所述的基本依据中获得。\n\n使用的定义和假设：\n- 理想气体定律：$c_{\\mathrm{tot}} = \\dfrac{P}{R T}$，其中 $c_{\\mathrm{tot}}$ 是总摩尔浓度，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$P$ 是压力，单位为 $\\mathrm{Pa}$，$T$ 是温度，单位为 $\\mathrm{K}$，$R$ 是普适气体常数 $8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 有效第三体浓度为 $[\\mathrm{M}]_{\\mathrm{eff}} = \\sum_i \\alpha_i [X_i]$，其中 $[X_i]$ 是载气物种 $i \\in \\{\\mathrm{N_2}, \\mathrm{Ar}, \\mathrm{CO_2}\\}$ 的摩尔浓度，$\\alpha_i$ 是待估算的未知无量纲第三体效率。\n- 载气物种 $i$ 的摩尔浓度为 $[X_i] = y_i\\, c_{\\mathrm{tot}}$，其中 $y_i$ 是其摩尔分数。\n- 速率常数 $k_0(T)$ 是低压、依赖于第三体的速率常数，单位为 $\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$。\n\n使用以下包含三个独立数据集的测试套件，每个数据集都包含在不同载气组分下的多个实验。在每个数据集中，对于每个实验，都给定了反应器温度 $T$（单位 K）、压力 $P$（单位 Pa）、停留时间 $\\tau$（单位 s）、低压极限速率常数 $k_0(T)$（单位 $\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$）、$\\mathrm{A}$ 的入口摩尔分数 $y_{\\mathrm{A,in}}$（无量纲）、载气摩尔分数 $(y_{\\mathrm{N_2}}, y_{\\mathrm{Ar}}, y_{\\mathrm{CO_2}})$（无量纲）以及测得的 $\\mathrm{A}$ 的出口摩尔分数 $y_{\\mathrm{A,out}}$（无量纲）。所有量都必须使用所提供的单位进行处理。\n\n数据集 $1$：\n- 全局设置：$T = 900\\,\\mathrm{K}$，$P = 101325\\,\\mathrm{Pa}$，$\\tau = 0.8\\,\\mathrm{s}$，$k_0(T) = 0.12\\,\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$，$y_{\\mathrm{A,in}} = 2.0 \\times 10^{-4}$。\n- 实验（载气组分 $(y_{\\mathrm{N_2}}, y_{\\mathrm{Ar}}, y_{\\mathrm{CO_2}})$，测得的 $y_{\\mathrm{A,out}}$）：\n    1. $(0.7, 0.2, 0.1)$，$y_{\\mathrm{A,out}} = 0.00010691$。\n    2. $(0.9, 0.1, 0.0)$，$y_{\\mathrm{A,out}} = 0.00010831$。\n    3. $(0.0, 1.0, 0.0)$，$y_{\\mathrm{A,out}} = 0.00015873$。\n    4. $(0.2, 0.2, 0.6)$，$y_{\\mathrm{A,out}} = 0.00008593$。\n    5. $(0.5, 0.0, 0.5)$，$y_{\\mathrm{A,out}} = 0.00008458$。\n\n数据集 $2$：\n- 全局设置：$T = 1000\\,\\mathrm{K}$，$P = 101325\\,\\mathrm{Pa}$，$\\tau = 1.2\\,\\mathrm{s}$，$k_0(T) = 0.08\\,\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$，$y_{\\mathrm{A,in}} = 1.5 \\times 10^{-4}$。\n- 实验：\n    1. $(0.6, 0.3, 0.1)$，$y_{\\mathrm{A,out}} = 0.00008696$。\n    2. $(0.1, 0.1, 0.8)$，$y_{\\mathrm{A,out}} = 0.00006208$。\n    3. $(0.85, 0.15, 0.0)$，$y_{\\mathrm{A,out}} = 0.00008662$。\n    4. $(0.0, 0.0, 1.0)$，$y_{\\mathrm{A,out}} = 0.00005683$。\n    5. $(0.4, 0.6, 0.0)$，$y_{\\mathrm{A,out}} = 0.00010220$。\n\n数据集 $3$（边缘情况，反应可忽略）：\n- 全局设置：$T = 700\\,\\mathrm{K}$，$P = 101325\\,\\mathrm{Pa}$，$\\tau = 0.4\\,\\mathrm{s}$，$k_0(T) = 1.0 \\times 10^{-9}\\,\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$，$y_{\\mathrm{A,in}} = 3.0 \\times 10^{-4}$。\n- 实验：\n    1. $(0.7, 0.3, 0.0)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n    2. $(0.3, 0.7, 0.0)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n    3. $(0.0, 0.2, 0.8)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n    4. $(0.9, 0.0, 0.1)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n\n您的程序必须：\n- 对于每个数据集，从第一性原理出发，推导出一个适合利用给定的稳态测量值来估算未知效率 $\\alpha_{\\mathrm{N_2}}$、$\\alpha_{\\mathrm{Ar}}$ 和 $\\alpha_{\\mathrm{CO_2}}$ 的线性回归关系。使用非负最小二乘法 (NNLS) 来强制 $\\alpha_i \\ge 0$ 以确保物理真实性。\n- 计算每个数据集的估算效率，顺序为 $\\left[\\alpha_{\\mathrm{N_2}}, \\alpha_{\\mathrm{Ar}}, \\alpha_{\\mathrm{CO_2}}\\right]$。\n- 将最终结果表示为四舍五入到六位小数的无量纲浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个结果都是一个包含按顺序 $\\left[\\alpha_{\\mathrm{N_2}}, \\alpha_{\\mathrm{Ar}}, \\alpha_{\\mathrm{CO_2}}\\right]$ 排列的估算效率的三元素列表，并四舍五入到六位小数。例如：$[[0.700000,0.200000,1.400000],[\\dots],[\\dots]]$。",
            "solution": "用户希望我解决一个化学动力学问题。\n\n### 步骤 1：提取给定信息\n- **反应器类型**：充分混合、等温、等压的射流搅拌反应器 (JSR) 稳态运行。\n- **反应物种**：A，摩尔分数极低。\n- **载气**：$\\mathrm{N_2}$、$\\mathrm{Ar}$、$\\mathrm{CO_2}$。\n- **反应类型**：第三体辅助，对 A 是一级，对有效第三体浓度是一级。\n- **基本原理**：质量作用定律、反应级数/速率常数、连续搅拌反应器的稳态质量平衡、理想气体定律。\n- **理想气体定律**：$c_{\\mathrm{tot}} = \\dfrac{P}{R T}$，其中 $c_{\\mathrm{tot}}$ 单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$P$ 单位为 $\\mathrm{Pa}$，$T$ 单位为 $\\mathrm{K}$，$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- **有效第三体浓度**：$[\\mathrm{M}]_{\\mathrm{eff}} = \\sum_i \\alpha_i [X_i]$，其中 $i \\in \\{\\mathrm{N_2}, \\mathrm{Ar}, \\mathrm{CO_2}\\}$。$\\alpha_i$ 为无量纲效率。\n- **载气物种浓度**：$[X_i] = y_i\\, c_{\\mathrm{tot}}$，其中 $y_i$ 为摩尔分数。\n- **速率常数**：$k_0(T)$，低压、依赖于第三体的速率常数，单位为 $\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$。\n- **回归方法**：非负最小二乘法 (NNLS) 以强制 $\\alpha_i \\ge 0$。\n- **数据集**：\n    - **数据集 1**：$T = 900\\,\\mathrm{K}$，$P = 101325\\,\\mathrm{Pa}$，$\\tau = 0.8\\,\\mathrm{s}$，$k_0(T) = 0.12\\,\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$，$y_{\\mathrm{A,in}} = 2.0 \\times 10^{-4}$。实验：\n        1. $(y_{\\mathrm{N_2}}, y_{\\mathrm{Ar}}, y_{\\mathrm{CO_2}}) = (0.7, 0.2, 0.1)$，$y_{\\mathrm{A,out}} = 0.00010691$。\n        2. $(0.9, 0.1, 0.0)$，$y_{\\mathrm{A,out}} = 0.00010831$。\n        3. $(0.0, 1.0, 0.0)$，$y_{\\mathrm{A,out}} = 0.00015873$。\n        4. $(0.2, 0.2, 0.6)$，$y_{\\mathrm{A,out}} = 0.00008593$。\n        5. $(0.5, 0.0, 0.5)$，$y_{\\mathrm{A,out}} = 0.00008458$。\n    - **数据集 2**：$T = 1000\\,\\mathrm{K}$，$P = 101325\\,\\mathrm{Pa}$，$\\tau = 1.2\\,\\mathrm{s}$，$k_0(T) = 0.08\\,\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrm{s})^{-1}$，$y_{\\mathrm{A,in}} = 1.5 \\times 10^{-4}$。实验：\n        1. $(0.6, 0.3, 0.1)$，$y_{\\mathrm{A,out}} = 0.00008696$。\n        2. $(0.1, 0.1, 0.8)$，$y_{\\mathrm{A,out}} = 0.00006208$。\n        3. $(0.85, 0.15, 0.0)$，$y_{\\mathrm{A,out}} = 0.00008662$。\n        4. $(0.0, 0.0, 1.0)$，$y_{\\mathrm{A,out}} = 0.00005683$。\n        5. $(0.4, 0.6, 0.0)$，$y_{\\mathrm{A,out}} = 0.00010220$。\n    - **数据集 3**：$T = 700\\,\\mathrm{K}$，$P = 101325\\,\\mathrm{Pa}$，$\\tau = 0.4\\,\\mathrm{s}$，$k_0(T) = 1.0 \\times 10^{-9}\\,\\mathrm{m^3}\\,(\\mathrm{mol}\\,\\mathrms)^{-1}$，$y_{\\mathrm{A,in}} = 3.0 \\times 10^{-4}$。实验：\n        1. $(0.7, 0.3, 0.0)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n        2. $(0.3, 0.7, 0.0)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n        3. $(0.0, 0.2, 0.8)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n        4. $(0.9, 0.0, 0.1)$，$y_{\\mathrm{A,out}} = 0.00030000$。\n\n### 步骤 2：使用提取的给定信息进行验证\n1.  **科学或事实上的不健全性**：该问题基于化学动力学和反应器设计的既定原理（JSR 质量平衡、质量作用定律、理想气体定律）。估算第三体效率的情景是燃烧化学中的标准实践。未发现违规。\n2.  **不可形式化或不相关**：该问题直接涉及燃烧环境中的反应级数和速率常数。它可以形式化为一个数学回归问题。未发现违规。\n3.  **不完整或矛盾的设置**：每个数据集都提供了必要的温度、压力、停留时间、速率常数、摩尔分数和测量值。每个数据集中的实验数量（5、5 和 4）都大于未知参数的数量（3），使得系统超定，适合进行回归。未发现违规。\n4.  **不切实际或不可行**：提供的数据值（温度、压力、浓度、速率常数）在气相动力学实验的物理现实范围内。单位是一致的。未发现违规。\n5.  **不适定或结构不良**：该问题旨在通过非负最小二乘法找到唯一解，这是一种适定的数值方法。术语定义清晰。未发现违规。\n6.  **伪深刻、琐碎或同义反复**：该问题需要从第一性原理推导和数值回归，这是一项非凡的任务。数据集 3 代表了一个有效且重要的边缘情况（无可观察到的反应），用于测试所推导模型的鲁棒性。未发现违规。\n7.  **超出科学可验证范围**：该问题是一个标准的数据分析和参数估计任务，完全可以通过数学和计算方法进行验证。未发现违规。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导与实现策略\n\n任务是估算 $i \\in \\{\\mathrm{N_2}, \\mathrm{Ar}, \\mathrm{CO_2}\\}$ 的第三体效率 $\\alpha_i$。这需要推导测量量与未知效率之间的线性关系，然后可以使用线性回归求解。推导过程必须从第一性原理出发。\n\n**1. JSR 的稳态质量平衡**\n\n对于在稳态下运行的理想混合射流搅拌反应器 (JSR) 中的物种 $\\mathrm{A}$，其质量平衡方程为：\n$$\n\\text{摩尔流入速率} - \\text{摩尔流出速率} + \\text{摩尔生成速率} \\times \\text{体积} = 0\n$$\n用摩尔流率 $F_{\\mathrm{A}}$（单位 $\\mathrm{mol}\\,\\mathrm{s}^{-1}$）、净反应速率 $\\omega_{\\mathrm{A}}$（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）和反应器体积 $V_R$（单位 $\\mathrm{m}^3$）表示，即：\n$$\nF_{\\mathrm{A,in}} - F_{\\mathrm{A,out}} + \\omega_{\\mathrm{A}} V_R = 0\n$$\n摩尔流率是摩尔浓度 $[\\mathrm{A}]$（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$）和体积流率 $\\dot{V}$（单位 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$）的乘积。假设密度恒定（等温、等压且反应物摩尔分数极低），$\\dot{V}$ 是常数。\n$$\n[\\mathrm{A}]_{\\mathrm{in}}\\dot{V} - [\\mathrm{A}]_{\\mathrm{out}}\\dot{V} + \\omega_{\\mathrm{A}} V_R = 0\n$$\n两边同除以 $\\dot{V}$ 并引入停留时间定义 $\\tau = V_R / \\dot{V}$：\n$$\n[\\mathrm{A}]_{\\mathrm{in}} - [\\mathrm{A}]_{\\mathrm{out}} + \\omega_{\\mathrm{A}} \\tau = 0\n$$\n\n**2. 反应速率定律**\n\n问题指出，该反应对 $[\\mathrm{A}]$ 是一级，对有效第三体浓度 $[\\mathrm{M}]_{\\mathrm{eff}}$ 也是一级。根据质量作用定律，$\\mathrm{A}$ 的消耗速率为：\n$$\n\\text{消耗速率} = k_0(T) [\\mathrm{A}] [\\mathrm{M}]_{\\mathrm{eff}}\n$$\n净生成速率 $\\omega_{\\mathrm{A}}$ 是消耗速率的负值。在 JSR 中，组分是均匀的，因此反应速率在出口条件下计算。因此，$[\\mathrm{A}] = [\\mathrm{A}]_{\\mathrm{out}}$。\n$$\n\\omega_{\\mathrm{A}} = -k_0(T) [\\mathrm{A}]_{\\mathrm{out}} [\\mathrm{M}]_{\\mathrm{eff}}\n$$\n\n**3. 结合质量平衡和速率定律**\n\n将 $\\omega_{\\mathrm{A}}$ 的表达式代入质量平衡方程：\n$$\n[\\mathrm{A}]_{\\mathrm{in}} - [\\mathrm{A}]_{\\mathrm{out}} - k_0(T) [\\mathrm{A}]_{\\mathrm{out}} [\\mathrm{M}]_{\\mathrm{eff}} \\tau = 0\n$$\n我们的目标是找到隐藏在 $[\\mathrm{M}]_{\\mathrm{eff}}$ 中的效率 $\\alpha_i$。我们重新整理方程以分离出 $[\\mathrm{M}]_{\\mathrm{eff}}$：\n$$\nk_0(T) [\\mathrm{A}]_{\\mathrm{out}} [\\mathrm{M}]_{\\mathrm{eff}} \\tau = [\\mathrm{A}]_{\\mathrm{in}} - [\\mathrm{A}]_{\\mathrm{out}}\n$$\n$$\n[\\mathrm{M}]_{\\mathrm{eff}} = \\frac{[\\mathrm{A}]_{\\mathrm{in}} - [\\mathrm{A}]_{\\mathrm{out}}}{k_0(T) [\\mathrm{A}]_{\\mathrm{out}} \\tau}\n$$\n\n**4. 转换为可测量量（摩尔分数）**\n\n实验数据以摩尔分数 ($y$) 而非浓度的形式给出。我们使用理想气体定律将它们关联起来。总摩尔浓度 $c_{\\mathrm{tot}}$ 为：\n$$\nc_{\\mathrm{tot}} = \\frac{P}{RT}\n$$\n任何物种 $j$ 的浓度为 $[j] = y_j c_{\\mathrm{tot}} = y_j \\frac{P}{RT}$。将此应用于入口和出口的物种 $\\mathrm{A}$：\n$$\n[\\mathrm{A}]_{\\mathrm{in}} = y_{\\mathrm{A,in}} \\frac{P}{RT} \\quad \\text{和} \\quad [\\mathrm{A}]_{\\mathrm{out}} = y_{\\mathrm{A,out}} \\frac{P}{RT}\n$$\n将这些代入 $[\\mathrm{M}]_{\\mathrm{eff}}$ 的表达式中：\n$$\n[\\mathrm{M}]_{\\mathrm{eff}} = \\frac{y_{\\mathrm{A,in}}\\frac{P}{RT} - y_{\\mathrm{A,out}}\\frac{P}{RT}}{k_0(T) \\left(y_{\\mathrm{A,out}}\\frac{P}{RT}\\right) \\tau} = \\frac{y_{\\mathrm{A,in}} - y_{\\mathrm{A,out}}}{k_0(T) y_{\\mathrm{A,out}} \\tau}\n$$\n该方程的右侧完全由已知的实验参数和测量值组成。\n\n**5. 建立线性回归问题**\n\n现在我们使用 $[\\mathrm{M}]_{\\mathrm{eff}}$ 的定义：\n$$\n[\\mathrm{M}]_{\\mathrm{eff}} = \\sum_i \\alpha_i [X_i]\n$$\n其中 $i \\in \\{\\mathrm{N_2}, \\mathrm{Ar}, \\mathrm{CO_2}\\}$。载气物种 $[X_i]$ 的浓度也用摩尔分数表示：\n$$\n[X_i] = y_i c_{\\mathrm{tot}} = y_i \\frac{P}{RT}\n$$\n所以，定义变为：\n$$\n[\\mathrm{M}]_{\\mathrm{eff}} = \\sum_i \\alpha_i \\left(y_i \\frac{P}{RT}\\right) = \\frac{P}{RT} \\sum_i \\alpha_i y_i\n$$\n令我们推导出的两个 $[\\mathrm{M}]_{\\mathrm{eff}}$ 表达式相等：\n$$\n\\frac{y_{\\mathrm{A,in}} - y_{\\mathrm{A,out}}}{k_0(T) y_{\\mathrm{A,out}} \\tau} = \\frac{P}{RT} \\sum_i \\alpha_i y_i\n$$\n重新整理，将所有已知量放在一边，未知数的线性组合放在另一边：\n$$\n\\frac{RT}{P} \\left( \\frac{y_{\\mathrm{A,in}} - y_{\\mathrm{A,out}}}{k_0(T) y_{\\mathrm{A,out}} \\tau} \\right) = \\sum_i \\alpha_i y_i = \\alpha_{\\mathrm{N_2}} y_{\\mathrm{N_2}} + \\alpha_{\\mathrm{Ar}} y_{\\mathrm{Ar}} + \\alpha_{\\mathrm{CO_2}} y_{\\mathrm{CO_2}}\n$$\n这是一个线性方程。对于一组 $n$ 个实验，我们可以构建一个矩阵形式为 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 的线性方程组：\n$$\n\\begin{pmatrix}\ny_{\\mathrm{N_2},1} & y_{\\mathrm{Ar},1} & y_{\\mathrm{CO_2},1} \\\\\ny_{\\mathrm{N_2},2} & y_{\\mathrm{Ar},2} & y_{\\mathrm{CO_2},2} \\\\\n\\vdots & \\vdots & \\vdots \\\\\ny_{\\mathrm{N_2},n} & y_{\\mathrm{Ar},n} & y_{\\mathrm{CO_2},n}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\alpha_{\\mathrm{N_2}} \\\\\n\\alpha_{\\mathrm{Ar}} \\\\\n\\alpha_{\\mathrm{CO_2}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_1 \\\\\nb_2 \\\\\n\\vdots \\\\\nb_n\n\\end{pmatrix}\n$$\n其中未知数向量为 $\\mathbf{x} = [\\alpha_{\\mathrm{N_2}}, \\alpha_{\\mathrm{Ar}}, \\alpha_{\\mathrm{CO_2}}]^T$，设计矩阵 $\\mathbf{A}$ 由每个实验的载气摩尔分数组成，观测向量 $\\mathbf{b}$ 的元素为：\n$$\nb_j = \\frac{RT}{P} \\left( \\frac{y_{\\mathrm{A,in}} - y_{\\mathrm{A,out},j}}{k_0(T) y_{\\mathrm{A,out},j} \\tau} \\right)\n$$\n由于实验次数 $n$ 大于未知数数量（3），该系统是超定的。我们求解 $\\mathbf{x}$，使其最小化残差的欧几里得范数平方，即 $||\\mathbf{A}\\mathbf{x} - \\mathbf{b}||_2^2$。为确保物理真实性，效率必须为非负值，即 $\\alpha_i \\ge 0$。因此，我们采用非负最小二乘法 (NNLS) 来求解 $\\mathbf{x}$。此过程应用于每个数据集以找到相应的效率。\n\n对于数据集 $3$，其中 $y_{\\mathrm{A,out}} = y_{\\mathrm{A,in}}$，所有实验的分子 $y_{\\mathrm{A,in}} - y_{\\mathrm{A,out},j}$ 均为零。这正确地导致所有 $j$ 的 $b_j = 0$，从而得到方程组 $\\mathbf{A}\\mathbf{x} = \\mathbf{0}$。在非负性约束下，该方程组的物理和数学上正确的解是 $\\mathbf{x} = [0, 0, 0]^T$，这表明当未观察到反应时，无法提取有关效率的任何信息。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Derives and solves a linear regression problem to find third-body efficiencies\n    from JSR steady-state data.\n    \"\"\"\n    R_GAS_CONSTANT = 8.314462618  # J mol^-1 K^-1\n\n    datasets = [\n        {\n            \"T\": 900.0,  # K\n            \"P\": 101325.0,  # Pa\n            \"tau\": 0.8,  # s\n            \"k0\": 0.12,  # m^3 mol^-1 s^-1\n            \"y_A_in\": 2.0e-4,\n            \"experiments\": [\n                ((0.7, 0.2, 0.1), 0.00010691),\n                ((0.9, 0.1, 0.0), 0.00010831),\n                ((0.0, 1.0, 0.0), 0.00015873),\n                ((0.2, 0.2, 0.6), 0.00008593),\n                ((0.5, 0.0, 0.5), 0.00008458),\n            ]\n        },\n        {\n            \"T\": 1000.0,\n            \"P\": 101325.0,\n            \"tau\": 1.2,\n            \"k0\": 0.08,\n            \"y_A_in\": 1.5e-4,\n            \"experiments\": [\n                ((0.6, 0.3, 0.1), 0.00008696),\n                ((0.1, 0.1, 0.8), 0.00006208),\n                ((0.85, 0.15, 0.0), 0.00008662),\n                ((0.0, 0.0, 1.0), 0.00005683),\n                ((0.4, 0.6, 0.0), 0.00010220),\n            ]\n        },\n        {\n            \"T\": 700.0,\n            \"P\": 101325.0,\n            \"tau\": 0.4,\n            \"k0\": 1.0e-9,\n            \"y_A_in\": 3.0e-4,\n            \"experiments\": [\n                ((0.7, 0.3, 0.0), 0.00030000),\n                ((0.3, 0.7, 0.0), 0.00030000),\n                ((0.0, 0.2, 0.8), 0.00030000),\n                ((0.9, 0.0, 0.1), 0.00030000),\n            ]\n        }\n    ]\n\n    all_results = []\n    \n    for dataset in datasets:\n        T = dataset[\"T\"]\n        P = dataset[\"P\"]\n        tau = dataset[\"tau\"]\n        k0 = dataset[\"k0\"]\n        y_A_in = dataset[\"y_A_in\"]\n        experiments = dataset[\"experiments\"]\n\n        A_matrix_rows = []\n        b_vector_elements = []\n\n        # From first principles, we derived the linear relation:\n        # (R*T/P) * (y_A_in - y_A_out) / (k0 * y_A_out * tau) = sum(alpha_i * y_i)\n        # This is a system Ax = b, where:\n        # A is the matrix of bath gas mole fractions (y_N2, y_Ar, y_CO2)\n        # x is the vector of unknown efficiencies (alpha_N2, alpha_Ar, alpha_CO2)\n        # b is the vector of calculated values from experimental measurements.\n\n        rt_over_p = (R_GAS_CONSTANT * T) / P\n        \n        for exp in experiments:\n            bath_composition, y_A_out = exp\n            A_matrix_rows.append(bath_composition)\n            \n            # Handle the case of no reaction to avoid division by zero or large float errors\n            # Although y_A_out is non-zero in the given data, this is robust.\n            if y_A_in == y_A_out or k0 == 0 or y_A_out == 0:\n                b_j = 0.0\n            else:\n                numerator = y_A_in - y_A_out\n                denominator = k0 * y_A_out * tau\n                b_j = rt_over_p * (numerator / denominator)\n            b_vector_elements.append(b_j)\n            \n        A = np.array(A_matrix_rows)\n        b = np.array(b_vector_elements)\n        \n        # Solve the system Ax = b using Non-Negative Least Squares (NNLS)\n        # to enforce the physical constraint that efficiencies alpha_i must be >= 0.\n        alphas, _ = nnls(A, b)\n        \n        # Format the results to 6 decimal places as lists\n        formatted_alphas = [round(a, 6) for a in alphas]\n        all_results.append(formatted_alphas)\n\n    # Prepare the final output string in the exact required format\n    # Example: [[1.000000,0.200000,1.500000],[...]]\n    final_output_parts = []\n    for res in all_results:\n        # Format each float to 6 decimal places\n        formatted_numbers = [f\"{num:.6f}\" for num in res]\n        # Create a string representation of the list\n        list_str = f\"[{','.join(formatted_numbers)}]\"\n        final_output_parts.append(list_str)\n        \n    print(f\"[{','.join(final_output_parts)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "在复杂的燃烧模拟中，为了降低计算成本，通常需要对详细的化学反应机理进行简化，而准稳态近似（QSSA）是其中最常用的方法之一。本练习提供了一个高级计算实践，旨在量化QSSA引入的误差，特别是其对有效反应级数这一微妙动力学指标的影响 。通过实施并对比完整模型和简化模型，您将深入理解模型简化的代价以及评估其适用性的定量方法。",
            "id": "4056778",
            "problem": "考虑一个在连续搅拌釜反应器（CSTR）中进行的均相、等温、等压气相反应体系，该体系描述了燃料物种 $A$ 通过一个双中间体链式反应机理与分子氧 $O_2$ 反应。中间体为 $B$ 和 $C$，$M$ 表示有效的第三体碰撞物，假定为混合物本身。反应器的停留时间为 $\\tau$，进料摩尔分数为 $y_{A,\\mathrm{in}}$ 和 $y_{O_2,\\mathrm{in}}$，温度为 $T$（单位：开尔文），压力为 $p$（单位：帕斯卡）。根据理想气体定律，总摩尔浓度为 $C_\\mathrm{tot} = p/(R\\,T)$，其中 $R$ 是普适气体常数。考虑以下具有质量作用动力学的基元反应机理：\n- $R_1$: $A + O_2 \\rightarrow B$，\n- $R_2$: $B + M \\rightarrow C + M$，\n- $R_3$: $C + A \\rightarrow \\text{Products} + B$，\n- $R_4$: $B + A \\rightarrow \\text{Products}$，\n- $R_5$: $C \\rightarrow \\text{Products}$。\n\n在质量作用动力学下，反应速率为：\n- $r_1 = k_1(T)\\,[A]\\,[O_2]$,\n- $r_2 = k_2(T)\\,[B]\\,[M]$,\n- $r_3 = k_3(T)\\,[C]\\,[A]$,\n- $r_4 = k_4(T)\\,[B]\\,[A]$,\n- $r_5 = k_5(T)\\,[C]$,\n\n其中速率常数具有阿伦尼乌斯温度依赖性 $k_i(T) = A_i\\,T^{n_i}\\,\\exp\\!\\left(-E_i/(R\\,T)\\right)$，此处 $A_i$ 是指前因子，$n_i$ 是温度指数，$E_i$ 是活化能。使用以下参数值：\n- $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n- $A_1 = 0.1\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_1 = 0$, $E_1 = 20000\\ \\mathrm{J\\,mol^{-1}}$,\n- $A_2 = 1.0\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_2 = 0$, $E_2 = 0\\ \\mathrm{J\\,mol^{-1}}$,\n- $A_3 = 0.05\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_3 = 0$, $E_3 = 10000\\ \\mathrm{J\\,mol^{-1}}$,\n- $A_4 = 0.02\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_4 = 0$, $E_4 = 5000\\ \\mathrm{J\\,mol^{-1}}$,\n- $A_5 = 2.0\\ \\mathrm{s^{-1}}$, $n_5 = 0$, $E_5 = 20000\\ \\mathrm{J\\,mol^{-1}}$.\n\n假设进料中 $y_{A,\\mathrm{in}} = 0.05$，$y_{O_2,\\mathrm{in}} = 0.21$，其余为惰性物质，因此 $y_{M,\\mathrm{in}} = 1 - y_{A,\\mathrm{in}} - y_{O_2,\\mathrm{in}}$。设停留时间为 $\\tau = 1.0\\ \\mathrm{s}$。进料摩尔浓度为 $[A]_\\mathrm{in} = y_{A,\\mathrm{in}}\\,C_\\mathrm{tot}$，$[O_2]_\\mathrm{in} = y_{O_2,\\mathrm{in}}\\,C_\\mathrm{tot}$，且在反应器中 $[M] \\approx C_\\mathrm{tot}$。\n\n通过将包括中间体在内的所有物种的时间导数（包含稀释项）设为零来定义完整的 CSTR 稳态：\n$$\n\\begin{aligned}\n0 = -\\big(k_1(T)\\,[A]\\,[O_2] + k_3(T)\\,[C]\\,[A] + k_4(T)\\,[B]\\,[A]\\big) + \\frac{[A]_\\mathrm{in} - [A]}{\\tau},\\\\\n0 = -k_1(T)\\,[A]\\,[O_2] + \\frac{[O_2]_\\mathrm{in} - [O_2]}{\\tau},\\\\\n0 = +k_1(T)\\,[A]\\,[O_2] - k_2(T)\\,[B]\\,[M] - k_4(T)\\,[B]\\,[A] + k_3(T)\\,[C]\\,[A] - \\frac{[B]}{\\tau},\\\\\n0 = +k_2(T)\\,[B]\\,[M] - k_3(T)\\,[C]\\,[A] - k_5(T)\\,[C] - \\frac{[C]}{\\tau}.\n\\end{aligned}\n$$\n$A$ 的全局动力学消耗速率定义为\n$$\nr_A = k_1(T)\\,[A]\\,[O_2] + k_3(T)\\,[C]\\,[A] + k_4(T)\\,[B]\\,[A].\n$$\n通过在固定 $T$ 和 $p$ 下的局部对数敏感度来定义有效反应级数：\n$$\nn_A = \\frac{\\partial \\ln r_A}{\\partial \\ln [A]},\\quad n_{O_2} = \\frac{\\partial \\ln r_A}{\\partial \\ln [O_2]}.\n$$\n\n通过将中间体的平衡方程设为零同时忽略稀释项来定义准稳态近似（QSSA），即\n$$\n\\begin{aligned}\n0 = +k_1(T)\\,[A]\\,[O_2] - k_2(T)\\,[B]\\,[M] - k_4(T)\\,[B]\\,[A] + k_3(T)\\,[C]\\,[A],\\\\\n0 = +k_2(T)\\,[B]\\,[M] - k_3(T)\\,[C]\\,[A] - k_5(T)\\,[C].\n\\end{aligned}\n$$\n在 QSSA 下，$[B]$ 和 $[C]$ 是 $[A]$ 和 $[O_2]$ 的隐式函数（其中 $[M] \\approx C_\\mathrm{tot}$），QSSA 预测的级数 $n_A^\\mathrm{QSSA}$ 和 $n_{O_2}^\\mathrm{QSSA}$ 的定义类似，通过使用 QSSA 约束对 $r_A$ 关于 $[A]$ 和 $[O_2]$ 求导得出。\n\n您的任务是实现一个完整的程序，该程序能够：\n- 针对每个测试条件 $(T,p)$，计算完整的 CSTR 稳态 $([A],[O_2],[B],[C])$，\n- 在相同的 $[A]$ 和 $[O_2]$ 条件下，计算 QSSA 的 $[B]$ 和 $[C]$，\n- 使用包含稀释项的中间体稳态约束的隐式微分，计算完整稳态的 $n_A$ 和 $n_{O_2}$，\n- 使用不包含稀释项的 QSSA 约束的隐式微分，计算 $n_A^\\mathrm{QSSA}$ 和 $n_{O_2}^\\mathrm{QSSA}$，\n- 报告每个测试用例的绝对误差 $|n_A - n_A^\\mathrm{QSSA}|$ 和 $|n_{O_2} - n_{O_2}^\\mathrm{QSSA}|$。\n\n所有浓度单位表示为 $\\mathrm{mol\\,m^{-3}}$，所有速率单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$，温度单位为 $\\mathrm{K}$，压力单位为 $\\mathrm{Pa}$，时间单位为 $\\mathrm{s}$。程序必须使用以下测试套件：\n- 案例 1：$T = 900\\ \\mathrm{K}$，$p = 101325\\ \\mathrm{Pa}$，\n- 案例 2：$T = 1200\\ \\mathrm{K}$，$p = 506625\\ \\mathrm{Pa}$，\n- 案例 3：$T = 800\\ \\mathrm{K}$，$p = 10132.5\\ \\mathrm{Pa}$，\n- 案例 4：$T = 1500\\ \\mathrm{K}$，$p = 101325\\ \\mathrm{Pa}$，\n- 案例 5：$T = 700\\ \\mathrm{K}$，$p = 202650\\ \\mathrm{Pa}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是对应测试用例的绝对误差的双元素列表，顺序为 $[|n_A - n_A^\\mathrm{QSSA}|,|n_{O_2} - n_{O_2}^\\mathrm{QSSA}|]$。例如，输出格式应类似于 $[[e_{A,1},e_{O_2,1}],[e_{A,2},e_{O_2,2}],\\ldots,[e_{A,5},e_{O_2,5}]]$，其中每个 $e_{\\cdot,\\cdot}$ 都是一个浮点数。",
            "solution": "已对用户提供的问题进行了分析，并认定其有效。该问题具有科学依据、问题定义明确，并且为获得唯一且有意义的解提供了所有必要的数据和条件。\n\n该问题要求比较由完整连续搅拌釜反应器（CSTR）稳态模型和简化的准稳态近似（QSSA）模型预测的燃料物种 $A$ 消耗的有效反应级数。任务的核心是通过比较反应速率的局部对数敏感度（即反应级数），来量化由 QSSA 引入的误差。\n\n首先，我们确定系统的参数和控制方程。普适气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。反应器停留时间 $\\tau = 1.0\\ \\mathrm{s}$。入口摩尔分数为 $y_{A,\\mathrm{in}} = 0.05$ 和 $y_{O_2,\\mathrm{in}} = 0.21$。对于给定的温度 $T$ 和压力 $p$，总摩尔浓度为 $C_\\mathrm{tot} = p/(R\\,T)$，入口浓度为 $[A]_{\\mathrm{in}} = y_{A,\\mathrm{in}} C_\\mathrm{tot}$ 和 $[O_2]_{\\mathrm{in}} = y_{O_2,\\mathrm{in}} C_\\mathrm{tot}$。第三体浓度近似为 $[M] \\approx C_\\mathrm{tot}$。阿伦尼乌斯速率常数 $k_i(T)$ 使用提供的参数计算为 $k_i(T) = A_i T^{n_i} \\exp(-E_i/(R\\,T))$。请注意，所有 $n_i$ 值均为 0，这简化了表达式为 $k_i(T) = A_i \\exp(-E_i/(R\\,T))$。\n\n完整的 CSTR 稳态由一个包含四个物种浓度 $([A], [O_2], [B], [C])$ 的非线性代数方程组描述。我们定义一个向量函数 $\\mathbf{F}([A], [O_2], [B], [C]) = \\mathbf{0}$，其中：\n$$\n\\begin{aligned}\nF_A = \\frac{[A]_\\mathrm{in} - [A]}{\\tau} - \\left(k_1[A][O_2] + k_3[C][A] + k_4[B][A]\\right) = 0 \\\\\nF_{O_2} = \\frac{[O_2]_\\mathrm{in} - [O_2]}{\\tau} - k_1[A][O_2] = 0 \\\\\nF_B = \\frac{-[B]}{\\tau} + \\left(k_1[A][O_2] - k_2[B][M] - k_4[B][A] + k_3[C][A]\\right) = 0 \\\\\nF_C = \\frac{-[C]}{\\tau} + \\left(k_2[B][M] - k_3[C][A] - k_5[C]\\right) = 0\n\\end{aligned}\n$$\n对于每个测试用例 $(T,p)$，该方程组通过数值方法求解，以找到稳态浓度，我们记为 $([A]^*, [O_2]^*, [B]^*, [C]^*)$。使用入口浓度 $([A]_\\mathrm{in}, [O_2]_\\mathrm{in}, 0, 0)$ 作为初始猜测值，适合采用数值求根算法。\n\n$A$ 的全局消耗速率为 $r_A = k_1[A][O_2] + k_3[C][A] + k_4[B][A]$。有效反应级数定义为局部对数敏感度：\n$$\nn_A = \\frac{\\partial \\ln r_A}{\\partial \\ln [A]} = \\frac{[A]}{r_A} \\frac{\\mathrm{d}r_A}{\\mathrm{d}[A]}, \\quad n_{O_2} = \\frac{\\partial \\ln r_A}{\\partial \\ln [O_2]} = \\frac{[O_2]}{r_A} \\frac{\\mathrm{d}r_A}{\\mathrm{d}[O_2]}\n$$\n这里，全微分 $\\frac{\\mathrm{d}r_A}{\\mathrm{d}[A]}$（在恒定 $[O_2]$ 下）和 $\\frac{\\mathrm{d}r_A}{\\mathrm{d}[O_2]}$（在恒定 $[A]$ 下）必须考虑到中间体浓度 $[B]$ 和 $[C]$ 是 $[A]$ 和 $[O_2]$ 的函数。例如，使用链式法则：\n$$\n\\frac{\\mathrm{d}r_A}{\\mathrm{d}[A]} = \\frac{\\partial r_A}{\\partial [A]} + \\frac{\\partial r_A}{\\partial [B]} \\frac{\\partial [B]}{\\partial [A]} + \\frac{\\partial r_A}{\\partial [C]} \\frac{\\partial [C]}{\\partial [A]}\n$$\n$r_A$ 的偏导数是直接的：$\\frac{\\partial r_A}{\\partial [A]} = k_1[O_2]+k_3[C]+k_4[B]$, $\\frac{\\partial r_A}{\\partial [B]} = k_4[A]$, 和 $\\frac{\\partial r_A}{\\partial [C]} = k_3[A]$。\n中间体的导数（例如 $\\frac{\\partial [B]}{\\partial [A]}$）通过对中间体的稳态平衡方程 $F_B=0$ 和 $F_C=0$ 进行隐式微分求得。这会产生一个关于导数的 $2 \\times 2$ 线性方程组。对 $[A]$ 进行微分：\n$$\n\\begin{pmatrix} \\frac{\\partial F_B}{\\partial [B]} & \\frac{\\partial F_B}{\\partial [C]} \\\\ \\frac{\\partial F_C}{\\partial [B]} & \\frac{\\partial F_C}{\\partial [C]} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial [B]}{\\partial [A]} \\\\ \\frac{\\partial [C]}{\\partial [A]} \\end{pmatrix} = - \\begin{pmatrix} \\frac{\\partial F_B}{\\partial [A]} \\\\ \\frac{\\partial F_C}{\\partial [A]} \\end{pmatrix}\n$$\n雅可比矩阵和右侧向量为：\n$$\n\\mathbf{J} = \\begin{pmatrix} -(k_2[M] + k_4[A] + 1/\\tau) & k_3[A] \\\\ k_2[M] & -(k_3[A] + k_5 + 1/\\tau) \\end{pmatrix}, \\quad \\mathbf{b}_A = \\begin{pmatrix} -(k_1[O_2] - k_4[B] + k_3[C]) \\\\ k_3[C] \\end{pmatrix}\n$$\n对于关于 $[O_2]$ 的导数，也求解一个类似的系统，其右侧为 $\\mathbf{b}_{O_2} = (-k_1[A], 0)^T$。所有项都在完整稳态浓度下计算。\n\n准稳态近似（QSSA）忽略了中间体的输运（稀释）项，实际上是假设它们的化学反应时间尺度与停留时间相比无限快。QSSA 方程为：\n$$\n\\begin{aligned}\nH_B = k_1[A][O_2] - k_2[B][M] - k_4[B][A] + k_3[C][A] = 0 \\\\\nH_C = k_2[B][M] - k_3[C][A] - k_5[C] = 0\n\\end{aligned}\n$$\n对于给定的 $[A]$ 和 $[O_2]$（取自完整的 CSTR 解，即 $[A]^*$ 和 $[O_2]^*$），这是一个关于 QSSA 浓度 $([B]^\\mathrm{QSSA}, [C]^\\mathrm{QSSA})$ 的线性方程组。\nQSSA 反应级数 $n_A^\\mathrm{QSSA}$ 和 $n_{O_2}^\\mathrm{QSSA}$ 通过对 QSSA 系统（$H_B=0, H_C=0$）进行隐式微分来类似地计算。这等效于使用相同的导数形式，但使用一个修改后的雅可比矩阵 $\\mathbf{J}^\\mathrm{QSSA}$，其中 $1/\\tau = 0$。右侧向量在形式上是相同的，但是使用 $[A]^*, [O_2]^*$ 以及得到的 QSSA 中间体 $[B]^\\mathrm{QSSA}$ 和 $[C]^\\mathrm{QSSA}$ 进行计算。\n\n最后一步是计算每个测试用例的绝对误差 $|n_A - n_A^\\mathrm{QSSA}|$ 和 $|n_{O_2} - n_{O_2}^\\mathrm{QSSA}|$。\n\n每个测试用例 $(T,p)$ 的计算步骤如下：\n1. 计算 $C_\\mathrm{tot}$、$[A]_\\mathrm{in}$、$[O_2]_\\mathrm{in}$ 和所有的 $k_i(T)$。\n2. 求解 $4 \\times 4$ 非线性方程组以找到 $([A]^*, [O_2]^*, [B]^*, [C]^*)$。\n3. 使用这些浓度构建 $\\mathbf{J}$ 和 $\\mathbf{b}_A, \\mathbf{b}_{O_2}$。求解两个 $2 \\times 2$ 线性方程组以获得中间体的导数。\n4. 计算 $r_A$ 和完整模型的级数 $n_A, n_{O_2}$。\n5. 使用 $[A]^*$ 和 $[O_2]^*$ 求解 $2 \\times 2$ 线性 QSSA 系统，得到 $([B]^\\mathrm{QSSA}, [C]^\\mathrm{QSSA})$。\n6. 使用 $([A]^*, [O_2]^*, [B]^\\mathrm{QSSA}, [C]^\\mathrm{QSSA})$ 构建 $\\mathbf{J}^\\mathrm{QSSA}$ 和 $\\mathbf{b}_A^\\mathrm{QSSA}, \\mathbf{b}_{O_2}^\\mathrm{QSSA}$。求解以获得基于 QSSA 的导数。\n7. 计算 $r_A^\\mathrm{QSSA}$ 和 QSSA 级数 $n_A^\\mathrm{QSSA}, n_{O_2}^\\mathrm{QSSA}$。\n8. 计算绝对误差并存储结果。\n对所有测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import fsolve\n\ndef solve():\n    \"\"\"\n    Solves the CSTR problem for a series of test cases, comparing full steady-state\n    and QSSA models for reaction orders and reporting the errors.\n    \"\"\"\n\n    # Constants and fixed parameters\n    R_GAS = 8.314462618  # J/mol/K\n    TAU = 1.0  # s\n    Y_A_IN = 0.05\n    Y_O2_IN = 0.21\n\n    # Kinetic parameters (A_i, n_i, E_i)\n    K_PARAMS = {\n        1: (0.1, 0.0, 20000.0),   # A (m^3/mol/s), n, E (J/mol)\n        2: (1.0, 0.0, 0.0),\n        3: (0.05, 0.0, 10000.0),\n        4: (0.02, 0.0, 5000.0),\n        5: (2.0, 0.0, 20000.0)    # A (1/s) for 1st-order reaction R5\n    }\n\n    test_cases = [\n        (900.0, 101325.0),    # T (K), p (Pa)\n        (1200.0, 506625.0),\n        (800.0, 10132.5),\n        (1500.0, 101325.0),\n        (700.0, 202650.0)\n    ]\n\n    results = []\n    for T, p in test_cases:\n        # Calculate case-specific parameters\n        c_tot = p / (R_GAS * T)\n        c_A_in = Y_A_IN * c_tot\n        c_O2_in = Y_O2_IN * c_tot\n        c_M = c_tot\n\n        k = {i: A * T**n * np.exp(-E / (R_GAS * T)) for i, (A, n, E) in K_PARAMS.items()}\n\n        # 1. Solve for full CSTR steady-state concentrations\n        def full_ss_equations(x):\n            cA, cO2, cB, cC = x\n            r1 = k[1] * cA * cO2\n            r2 = k[2] * cB * c_M\n            r3 = k[3] * cC * cA\n            r4 = k[4] * cB * cA\n            r5 = k[5] * cC\n            \n            # Net production rates for species\n            omega_A = -r1 - r3 - r4\n            omega_O2 = -r1\n            omega_B = r1 - r2 - r4 + r3\n            omega_C = r2 - r3 - r5\n            \n            # CSTR balance equations\n            F_A = (c_A_in - cA) / TAU + omega_A\n            F_O2 = (c_O2_in - cO2) / TAU + omega_O2\n            F_B = -cB / TAU + omega_B\n            F_C = -cC / TAU + omega_C\n            \n            return [F_A, F_O2, F_B, F_C]\n\n        initial_guess = [c_A_in, c_O2_in, 0.0, 0.0]\n        ss_concs = fsolve(full_ss_equations, initial_guess)\n        cA_ss, cO2_ss, cB_ss, cC_ss = ss_concs\n\n        # 2. Calculate reaction orders for the full model\n        def get_full_orders(cA, cO2, cB, cC):\n            # Jacobian of intermediate system (FB, FC) wrt (cB, cC)\n            J = np.array([\n                [-(k[2] * c_M + k[4] * cA + 1/TAU), k[3] * cA],\n                [k[2] * c_M, -(k[3] * cA + k[5] + 1/TAU)]\n            ])\n\n            # RHS for d/d[A]\n            b_A = np.array([\n                -(k[1] * cO2 - k[4] * cB + k[3] * cC),\n                k[3] * cC\n            ])\n            dcB_dcA, dcC_dcA = np.linalg.solve(J, -b_A)\n\n            # RHS for d/d[O2]\n            b_O2 = np.array([-k[1] * cA, 0.0])\n            dcB_dcO2, dcC_dcO2 = np.linalg.solve(J, -b_O2)\n\n            rA = k[1] * cA * cO2 + k[3] * cC * cA + k[4] * cB * cA\n            if rA == 0: return 0.0, 0.0\n\n            # Total derivative of rA wrt cA\n            drA_dcA = (k[1] * cO2 + k[3] * cC + k[4] * cB) + \\\n                      (k[4] * cA) * dcB_dcA + (k[3] * cA) * dcC_dcA\n            n_A = (cA / rA) * drA_dcA\n            \n            # Total derivative of rA wrt cO2\n            drA_dcO2 = k[1] * cA + (k[4] * cA) * dcB_dcO2 + (k[3] * cA) * dcC_dcO2\n            n_O2 = (cO2 / rA) * drA_dcO2\n            \n            return n_A, n_O2\n\n        n_A_full, n_O2_full = get_full_orders(cA_ss, cO2_ss, cB_ss, cC_ss)\n\n        # 3. Calculate concentrations and orders for the QSSA model\n        \n        # a) Solve for QSSA concentrations [B] and [C]\n        qssa_A_matrix = np.array([\n            [-(k[2] * c_M + k[4] * cA_ss), k[3] * cA_ss],\n            [k[2] * c_M, -(k[3] * cA_ss + k[5])]\n        ])\n        qssa_b_vector = np.array([-k[1] * cA_ss * cO2_ss, 0.0])\n        cB_qssa, cC_qssa = np.linalg.solve(qssa_A_matrix, qssa_b_vector)\n\n        # b) Calculate QSSA reaction orders\n        def get_qssa_orders(cA, cO2, cB, cC):\n            # Jacobian of QSSA intermediate system wrt (cB, cC)\n            J_qssa = np.array([\n                [-(k[2] * c_M + k[4] * cA), k[3] * cA],\n                [k[2] * c_M, -(k[3] * cA + k[5])]\n            ])\n\n            # RHS for d/d[A]\n            b_A_qssa = np.array([\n                -(k[1] * cO2 - k[4] * cB + k[3] * cC),\n                k[3] * cC\n            ]) \n            dcB_dcA_qssa, dcC_dcA_qssa = np.linalg.solve(J_qssa, -b_A_qssa)\n            \n            # RHS for d/d[O2]\n            b_O2_qssa = np.array([-k[1] * cA, 0.0])\n            dcB_dcO2_qssa, dcC_dcO2_qssa = np.linalg.solve(J_qssa, -b_O2_qssa)\n\n            rA_qssa = k[1] * cA * cO2 + k[3] * cC * cA + k[4] * cB * cA\n            if rA_qssa == 0: return 0.0, 0.0\n            \n            drA_dcA_qssa = (k[1] * cO2 + k[3] * cC + k[4] * cB) + \\\n                           (k[4] * cA) * dcB_dcA_qssa + (k[3] * cA) * dcC_dcA_qssa\n            n_A_qssa = (cA / rA_qssa) * drA_dcA_qssa\n            \n            drA_dcO2_qssa = k[1] * cA + (k[4] * cA) * dcB_dcO2_qssa + (k[3] * cA) * dcC_dcO2_qssa\n            n_O2_qssa = (cO2 / rA_qssa) * drA_dcO2_qssa\n            \n            return n_A_qssa, n_O2_qssa\n\n        n_A_qssa, n_O2_qssa = get_qssa_orders(cA_ss, cO2_ss, cB_qssa, cC_qssa)\n\n        # 4. Calculate and store the absolute errors\n        err_A = abs(n_A_full - n_A_qssa)\n        err_O2 = abs(n_O2_full - n_O2_qssa)\n        results.append([err_A, err_O2])\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}