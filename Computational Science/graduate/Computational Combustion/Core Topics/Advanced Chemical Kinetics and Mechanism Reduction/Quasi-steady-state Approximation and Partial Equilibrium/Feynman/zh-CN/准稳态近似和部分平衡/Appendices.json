{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在实践部分平衡（PE）假设的基本应用。通过分析一个与慢反应过程耦合的简单可逆反应 ，您将推导出由PE假设带来的核心代数约束，并理解它如何重塑整个系统的有效动力学。这项练习将巩固PE假设的数学形式，及其对简化反应网络的直接影响。",
            "id": "4055682",
            "problem": "考虑一个温度为 $T$ 的等温、空间均匀的理想气体混合物。在此混合物中，快速可逆双分子缔合反应 $A + B \\rightleftharpoons C$ 在其余反应网络的时间尺度上处于部分平衡（PE）状态，而慢速不可逆步骤 $C + D \\rightarrow E$ 则遵循质量作用动力学。设物种 $i$ 的浓度用 $c_i$ 表示，快速缔合反应中 $(A,B,C)$ 的化学计量向量为 $(-1,-1,+1)$。假设化学势和活度符合理想混合物模型，并且时间尺度分离，使得在慢演化过程中，由PE施加的约束得以维持。\n\n任务：\n1. 从反应 $A + B \\rightleftharpoons C$ 的平衡条件（化学计量系数乘以化学势之和为零）出发，使用 $\\mu_i(T,p,X) = \\mu_i^{\\circ}(T) + R T \\ln a_i$ 以及对于选定的标准浓度 $c^{\\circ}$ 的理想活度 $a_i = c_i/c^{\\circ}$，推导出 $c_C$ 作为 $c_A$、$c_B$ 和与温度相关的平衡常数 $K_{\\mathrm{eq}}(T)$ 的函数的PE关系式，其中 $K_{\\mathrm{eq}}(T)$ 定义为满足 $$c_C = K_{\\mathrm{eq}}(T)\\,c_A\\,c_B.$$ 请明确说明为吸收 $c^{\\circ}$ 而需对 $K_{\\mathrm{eq}}(T)$ 进行的任何重新定义。\n2. 设慢反应的速率定律为 $$R_s(T) = k_2(T)\\,c_C\\,c_D,$$ 其中 $k_2(T)$ 是一个与温度相关的速率系数。通过 $$g(c_A,c_B,c_C;T) = c_C - K_{\\mathrm{eq}}(T)\\,c_A\\,c_B = 0.$$ 施加PE约束。通过沿慢流形对 $g$ 进行微分（保持 $T$ 不变），并利用快、慢步骤的化学计量方向，推导出为保持 $g=0$ 而必须伴随慢步骤的、用于恢复PE的快反应通量 $r_f$ 的表达式，并由此获得单位慢反应通量 $R_s$ 下 $(A,B,C)$ 的有效化学计量源项。\n3. 给定温度 $T$ 使得 $K_{\\mathrm{eq}}(T) = 2.0~\\mathrm{m^3/mol}$，以及 $k_2(T) = 5.0\\times 10^{-2}~\\mathrm{m^3/(mol\\cdot s)}$，$c_A = 2.0\\times 10^{-2}~\\mathrm{mol/m^3}$，$c_B = 3.0\\times 10^{-2}~\\mathrm{mol/m^3}$ 和 $c_D = 1.0\\times 10^{-1}~\\mathrm{mol/m^3}$，计算在PE约束下，由慢反应网络导致的物种 $A$ 的有效消耗速率，即由您在任务2中的推导所蕴含的 $\\dot{c}_A^{\\mathrm{PE}}$ 的带符号值。\n\n以 $\\mathrm{mol/(m^3\\cdot s)}$ 为单位表示最终速率，并将答案四舍五入至四位有效数字。",
            "solution": "问题陈述经验证在科学上是合理的、定义明确的，并包含完整求解所需的所有信息。\n\n该问题通过三个连续的任务来解决。\n\n任务1：推导部分平衡（PE）关系式。\n\n快速可逆反应为 $A + B \\rightleftharpoons C$。化学平衡的条件是各物种的化学势乘以其化学计量系数之和为零。化学计量数分别为 $\\nu_A = -1$，$\\nu_B = -1$ 和 $\\nu_C = +1$。\n平衡条件是：\n$$ \\sum_{i \\in \\{A,B,C\\}} \\nu_i \\mu_i = 0 $$\n$$ (+1)\\mu_C + (-1)\\mu_A + (-1)\\mu_B = 0 $$\n$$ \\mu_C = \\mu_A + \\mu_B $$\n理想气体混合物中物种 $i$ 的化学势由 $\\mu_i(T,p,X) = \\mu_i^{\\circ}(T) + R T \\ln a_i$ 给出，其中 $\\mu_i^{\\circ}(T)$ 是温度 $T$ 下的标准态化学势，$R$ 是通用气体常数，$a_i$ 是物种 $i$ 的活度。\n将此代入平衡条件：\n$$ \\mu_C^{\\circ}(T) + R T \\ln a_C = \\left( \\mu_A^{\\circ}(T) + R T \\ln a_A \\right) + \\left( \\mu_B^{\\circ}(T) + R T \\ln a_B \\right) $$\n重排各项，将标准态化学势和活度分组：\n$$ R T (\\ln a_C - \\ln a_A - \\ln a_B) = \\mu_A^{\\circ}(T) + \\mu_B^{\\circ}(T) - \\mu_C^{\\circ}(T) $$\n等式右边是标准反应吉布斯自由能 $\\Delta G^{\\circ}(T) = \\mu_C^{\\circ}(T) - \\mu_A^{\\circ}(T) - \\mu_B^{\\circ}(T)$ 的相反数。\n$$ R T \\ln \\left( \\frac{a_C}{a_A a_B} \\right) = -\\Delta G^{\\circ}(T) $$\n无量纲热力学平衡常数 $K_a(T)$ 定义为 $K_a(T) = \\exp(-\\Delta G^{\\circ}(T) / (R T))$。这导出了以下关系：\n$$ \\frac{a_C}{a_A a_B} = K_a(T) $$\n问题指定活度基于标准浓度 $c^{\\circ}$，即 $a_i = c_i/c^{\\circ}$。将此代入方程：\n$$ \\frac{c_C/c^{\\circ}}{(c_A/c^{\\circ})(c_B/c^{\\circ})} = K_a(T) $$\n$$ \\frac{c_C c^{\\circ}}{c_A c_B} = K_a(T) $$\n解出 $c_C$：\n$$ c_C = \\frac{K_a(T)}{c^{\\circ}} c_A c_B $$\n问题定义了一个基于浓度的平衡常数 $K_{\\mathrm{eq}}(T)$，使得 $c_C = K_{\\mathrm{eq}}(T) c_A c_B$。将其与推导出的表达式进行比较，我们确定：\n$$ K_{\\mathrm{eq}}(T) = \\frac{K_a(T)}{c^{\\circ}} $$\n重新定义是指，PE关系式中使用的常数 $K_{\\mathrm{eq}}(T)$ 吸收了标准浓度 $c^{\\circ}$，从而直接关联浓度，因此获得了浓度倒数的单位（例如 $\\mathrm{m^3/mol}$）。\n\n任务2：推导恢复PE的快反应通量和有效源项。\n\n浓度动力学由净速率为 $r_f$ 的快反应 $A+B \\rightleftharpoons C$ 和速率为 $R_s$ 的慢反应 $C+D \\to E$ 控制。浓度的变化速率为：\n$$ \\dot{c}_A = -r_f $$\n$$ \\dot{c}_B = -r_f $$\n$$ \\dot{c}_C = r_f - R_s $$\n系统被约束在由 $g(c_A,c_B,c_C;T) = c_C - K_{\\mathrm{eq}}(T) c_A c_B = 0$ 定义的PE流形上。为使系统保持在该流形上，$g$ 的全时间导数必须为零。\n$$ \\frac{dg}{dt} = \\dot{g} = \\frac{\\partial g}{\\partial c_A} \\dot{c}_A + \\frac{\\partial g}{\\partial c_B} \\dot{c}_B + \\frac{\\partial g}{\\partial c_C} \\dot{c}_C = 0 $$\n$g$ 的偏导数（在恒定 $T$ 下，因此 $K_{\\mathrm{eq}}$ 也恒定）为：\n$$ \\frac{\\partial g}{\\partial c_A} = -K_{\\mathrm{eq}}(T) c_B $$\n$$ \\frac{\\partial g}{\\partial c_B} = -K_{\\mathrm{eq}}(T) c_A $$\n$$ \\frac{\\partial g}{\\partial c_C} = 1 $$\n将导数和速率表达式代入 $\\dot{g}=0$ 条件：\n$$ (-K_{\\mathrm{eq}} c_B)(-r_f) + (-K_{\\mathrm{eq}} c_A)(-r_f) + (1)(r_f - R_s) = 0 $$\n$$ K_{\\mathrm{eq}} c_B r_f + K_{\\mathrm{eq}} c_A r_f + r_f - R_s = 0 $$\n现在，我们求解恢复PE的快反应通量 $r_f$：\n$$ r_f (K_{\\mathrm{eq}} c_A + K_{\\mathrm{eq}} c_B + 1) = R_s $$\n$$ r_f = \\frac{R_s}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} $$\n有效源项，记为 $\\dot{c}_i^{\\mathrm{PE}}$，描述了在PE约束下各物种的总变化速率。\n对于物种A：\n$$ \\dot{c}_A^{\\mathrm{PE}} = -r_f = -\\frac{R_s}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} $$\n对于物种B：\n$$ \\dot{c}_B^{\\mathrm{PE}} = -r_f = -\\frac{R_s}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} $$\n对于物种C：\n$$ \\dot{c}_C^{\\mathrm{PE}} = r_f - R_s = \\frac{R_s}{1 + K_{\\mathrm{eq}}(c_A + c_B)} - R_s = R_s \\left( \\frac{1 - (1 + K_{\\mathrm{eq}}(c_A + c_B))}{1 + K_{\\mathrm{eq}}(c_A + c_B)} \\right) $$\n$$ \\dot{c}_C^{\\mathrm{PE}} = -\\frac{K_{\\mathrm{eq}}(T)(c_A + c_B) R_s}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} $$\n单位慢反应通量 $R_s$ 的有效化学计量源项是这些表达式中 $R_s$ 的系数：\n$$ \\sigma_A = \\frac{\\dot{c}_A^{\\mathrm{PE}}}{R_s} = -\\frac{1}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} $$\n$$ \\sigma_B = \\frac{\\dot{c}_B^{\\mathrm{PE}}}{R_s} = -\\frac{1}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} $$\n$$ \\sigma_C = \\frac{\\dot{c}_C^{\\mathrm{PE}}}{R_s} = -\\frac{K_{\\mathrm{eq}}(T)(c_A + c_B)}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} $$\n\n任务3：计算物种A的有效消耗速率。\n\n给定以下数值：\n$K_{\\mathrm{eq}}(T) = 2.0~\\mathrm{m^3/mol}$\n$k_2(T) = 5.0\\times 10^{-2}~\\mathrm{m^3/(mol\\cdot s)}$\n$c_A = 2.0\\times 10^{-2}~\\mathrm{mol/m^3}$\n$c_B = 3.0\\times 10^{-2}~\\mathrm{mol/m^3}$\n$c_D = 1.0\\times 10^{-1}~\\mathrm{mol/m^3}$\n\n首先，我们必须计算物种 $C$ 的浓度，它由PE关系式确定：\n$$ c_C = K_{\\mathrm{eq}}(T) c_A c_B = (2.0~\\mathrm{m^3/mol}) \\times (2.0\\times 10^{-2}~\\mathrm{mol/m^3}) \\times (3.0\\times 10^{-2}~\\mathrm{mol/m^3}) $$\n$$ c_C = 1.2 \\times 10^{-3}~\\mathrm{mol/m^3} $$\n接下来，我们计算慢反应的速率 $R_s$：\n$$ R_s = k_2(T) c_C c_D = (5.0\\times 10^{-2}~\\mathrm{m^3/(mol\\cdot s)}) \\times (1.2\\times 10^{-3}~\\mathrm{mol/m^3}) \\times (1.0\\times 10^{-1}~\\mathrm{mol/m^3}) $$\n$$ R_s = 6.0 \\times 10^{-6}~\\mathrm{mol/(m^3\\cdot s)} $$\n现在，我们使用推导出的物种 $A$ 有效变化速率 $\\dot{c}_A^{\\mathrm{PE}}$ 的表达式。我们需要分母项：\n$$ 1 + K_{\\mathrm{eq}}(T)(c_A + c_B) = 1 + (2.0~\\mathrm{m^3/mol}) \\times (2.0\\times 10^{-2} + 3.0\\times 10^{-2})~\\mathrm{mol/m^3} $$\n$$ 1 + K_{\\mathrm{eq}}(T)(c_A + c_B) = 1 + (2.0) \\times (5.0\\times 10^{-2}) = 1 + 0.1 = 1.1 $$\n最后，我们计算 $\\dot{c}_A^{\\mathrm{PE}}$：\n$$ \\dot{c}_A^{\\mathrm{PE}} = -\\frac{R_s}{1 + K_{\\mathrm{eq}}(T)(c_A + c_B)} = -\\frac{6.0 \\times 10^{-6}~\\mathrm{mol/(m^3\\cdot s)}}{1.1} $$\n$$ \\dot{c}_A^{\\mathrm{PE}} \\approx -5.454545... \\times 10^{-6}~\\mathrm{mol/(m^3\\cdot s)} $$\n按要求四舍五入到四位有效数字：\n$$ \\dot{c}_A^{\\mathrm{PE}} = -5.455 \\times 10^{-6}~\\mathrm{mol/(m^3\\cdot s)} $$\n这表示物种 $A$ 的有效消耗速率。",
            "answer": "$$\\boxed{-5.455 \\times 10^{-6}}$$"
        },
        {
            "introduction": "近似方法功能强大，但其有效性范围必须得到尊重。本练习  将展示一个情景：对某个物种草率地应用部分平衡（PE）假设，可能会与另一物种的准稳态（QSSA）假设相冲突。通过推导一个“不一致性因子”，您将分析性地证明这两种常用近似方法在何种条件下不兼容，从而锻炼您在模型简化中的批判性判断能力。",
            "id": "4055696",
            "problem": "考虑一个空间均匀、等温、恒容的间歇式反应器，其中包含稳定燃料 $F$、热活化中间体 $X$ 和链载体自由基 $R$。该机理包含以下遵循质量作用动力学的基元步骤：\n\n1. 活化与失活：$F \\rightleftharpoons X$，正向速率常数为 $k_{1f}$，逆向速率常数为 $k_{1b}$。\n2. 自由基生成：$X \\rightarrow P + R$，速率常数为 $k_{2}$。\n3. 自由基通过链增长消耗：$R + F \\rightarrow P'$，速率常数为 $k_{3}$。\n4. 自由基损失到惰性池：$R \\rightarrow S$，速率常数为 $k_{4}$。\n\n假设初始条件满足 $[X](0) = 0$ 和 $[R](0) = 0$，且 $[F](0) = F_{0}  0$。同时假设自由基 $R$ 的准稳态近似 (QSSA) 因时间尺度分离而具有外部合理性，即 $k_{3}[F] + k_{4}$ 相对于 $R$ 的净生成速率尺度而言很大。你的任务是研究 $R$ 的 QSSA 与可逆活化步骤 $(1)$ 的部分平衡 (PE) 假设之间的相互作用。\n\n从质量作用动力学所蕴含的物种平衡定律出发，推导以 $[X]$、$[F]$ 和速率常数表示的 $[R]$ 的 QSSA 表达式。然后，对步骤 $(1)$ 应用部分平衡 (PE) 假设，令正向和逆向速率相等，并相应地消去 $[X]$，从而得到将 $R$ 的 QSSA 与步骤 $(1)$ 的 PE 相结合所预测的 $[R]$。接下来，在不应用 PE 的情况下，计算与步骤 $(1)$ 的生成和步骤 $(2)$ 的消耗相一致的 $[X]$ 的稳态值，并用此值从 QSSA 中得到没有 PE 时的自由基浓度。\n\n将不一致性因子 $\\Phi$ 定义为在应用 PE 的 QSSA 预测的自由基浓度与使用无 PE 时 $X$ 的正确稳态值的 QSSA 预测的自由基浓度之比。请仅用相关速率常数给出 $\\Phi$ 的闭式解析表达式，并分析是哪种参数范围或初始条件导致 $\\Phi \\neq 1$。你的最终答案必须是 $\\Phi$ 的单一闭式表达式，不带单位。如果你选择对任何参数进行数值特化，请不要在最终表达式中这样做。",
            "solution": "该问题被验证为有科学依据、适定且客观。它提出了一个关于准稳态近似 (QSSA) 和部分平衡 (PE) 假设的应用与比较的化学动力学标准问题。我们开始求解。\n\n该化学机理包括四个基元步骤：\n1. $F \\rightleftharpoons X$ (正向速率常数 $k_{1f}$，逆向速率常数 $k_{1b}$)\n2. $X \\rightarrow P + R$ (速率常数 $k_{2}$)\n3. $R + F \\rightarrow P'$ (速率常数 $k_{3}$)\n4. $R \\rightarrow S$ (速率常数 $k_{4}$)\n\n基于质量作用动力学，我们可以写出该均匀、恒容反应器中中间体 $X$ 和自由基 $R$ 的物种平衡定律（速率方程）：\n$$ \\frac{d[X]}{dt} = k_{1f}[F] - k_{1b}[X] - k_{2}[X] = k_{1f}[F] - (k_{1b} + k_{2})[X] $$\n$$ \\frac{d[R]}{dt} = k_{2}[X] - k_{3}[R][F] - k_{4}[R] = k_{2}[X] - (k_{3}[F] + k_{4})[R] $$\n\n首要任务是推导 $[R]$ 的 QSSA 表达式。如果 $R$ 是一个高活性物种，即其浓度能对慢变物种 $F$ 和 $X$ 的变化做出快速调整，那么对 $R$ 使用 QSSA 就是合理的。在数学上，这通过将其净生成速率设为零来表示：\n$$ \\frac{d[R]}{dt} \\approx 0 $$\n将此应用于 $R$ 的速率方程：\n$$ k_{2}[X] - (k_{3}[F] + k_{4})[R] = 0 $$\n解出 $[R]$ 可得到自由基浓度的一般 QSSA 表达式，我们将其记为 $[R]_{QSSA}$：\n$$ [R]_{QSSA} = \\frac{k_{2}[X]}{k_{3}[F] + k_{4}} $$\n\n接下来，我们推导将 $R$ 的 QSSA 与步骤 ($1$) 的部分平衡 (PE) 假设相结合所得到的自由基浓度。PE 假设假定步骤 ($1$) 的正向和逆向反应相对于涉及 $F$ 或 $X$ 的其他反应而言非常快，因此近似达到平衡。\n$$ \\text{Rate}_{1f} \\approx \\text{Rate}_{1b} $$\n$$ k_{1f}[F] = k_{1b}[X] $$\n在此假设下，解出 $X$ 的浓度可得：\n$$ [X]_{PE} = \\frac{k_{1f}}{k_{1b}}[F] $$\n将这个 $[X]$ 的表达式代入 $[R]$ 的 QSSA 表达式，得到在 PE 和 QSSA 组合假设下预测的自由基浓度 $[R]_{PE+QSSA}$：\n$$ [R]_{PE+QSSA} = \\frac{k_{2}[X]_{PE}}{k_{3}[F] + k_{4}} = \\frac{k_{2} \\left( \\frac{k_{1f}}{k_{1b}}[F] \\right)}{k_{3}[F] + k_{4}} = \\frac{k_{1f}k_{2}[F]}{k_{1b}(k_{3}[F] + k_{4})} $$\n\n现在，我们采用另一种不對步骤 ($1$) 应用 PE 的方法。我们转而对中间体 $X$ 应用稳态近似，以计算 $[X]$ 的稳态值。这通常是比假设 PE 更准确的方法，因为它考虑了 $X$ 通过步骤 ($2$) 的净消耗。我们将 $X$ 的净生成速率设为零：\n$$ \\frac{d[X]}{dt} = k_{1f}[F] - (k_{1b} + k_{2})[X] \\approx 0 $$\n解出 $X$ 的稳态浓度，记为 $[X]_{SS}$：\n$$ (k_{1b} + k_{2})[X]_{SS} = k_{1f}[F] $$\n$$ [X]_{SS} = \\frac{k_{1f}[F]}{k_{1b} + k_{2}} $$\n然后，我们将这个更准确的 $[X]$ 表达式用于 $[R]$ 的 QSSA 公式，以得到 $[R]_{SS+QSSA}$：\n$$ [R]_{SS+QSSA} = \\frac{k_{2}[X]_{SS}}{k_{3}[F] + k_{4}} = \\frac{k_{2} \\left( \\frac{k_{1f}[F]}{k_{1b} + k_{2}} \\right)}{k_{3}[F] + k_{4}} = \\frac{k_{1f}k_{2}[F]}{(k_{1b} + k_{2})(k_{3}[F] + k_{4})} $$\n\n题目将不一致性因子 $\\Phi$ 定义为应用 PE 的 QSSA 预测的自由基浓度与使用更准确的 $X$ 稳态的 QSSA 预测的自由基浓度之比：\n$$ \\Phi = \\frac{[R]_{PE+QSSA}}{[R]_{SS+QSSA}} $$\n代入推导出的表达式：\n$$ \\Phi = \\frac{\\frac{k_{1f}k_{2}[F]}{k_{1b}(k_{3}[F] + k_{4})}}{\\frac{k_{1f}k_{2}[F]}{(k_{1b} + k_{2})(k_{3}[F] + k_{4})}} $$\n项 $k_{1f}$、$k_{2}$、$[F]$ 和 $(k_{3}[F] + k_{4})$ 被约去，剩下：\n$$ \\Phi = \\frac{\\frac{1}{k_{1b}}}{\\frac{1}{k_{1b} + k_{2}}} = \\frac{k_{1b} + k_{2}}{k_{1b}} $$\n这化简为 $\\Phi$ 的最终闭式表达式：\n$$ \\Phi = 1 + \\frac{k_{2}}{k_{1b}} $$\n\n最后，我们分析导致 $\\Phi \\neq 1$ 的条件。$\\Phi$ 的表达式仅取决于速率常数 $k_{2}$ 和 $k_{1b}$，而不取决于任何初始条件或燃料 $[F]$ 的浓度。物理过程的速率常数是非负的，即 $k_{2} \\ge 0$ 和 $k_{1b} \\ge 0$。为使给定的反应机理有意义，步骤 ($2$) 和步骤 ($1b$) 必须发生，因此我们假设 $k_2  0$ 且 $k_{1b}  0$。\n在此假设下，比率 $\\frac{k_{2}}{k_{1b}}$ 是严格为正的。因此，$\\Phi = 1 + \\frac{k_{2}}{k_{1b}}  1$。所以，对于该反应机理的任何非平凡情形（$k_2  0$），$\\Phi$ 都不等于 $1$。\n\n因子 $\\Phi$ 量化了因错误地对步骤 ($1$) 假设部分平衡而引入的误差。PE 假设仅在可逆反应 $F \\rightleftharpoons X$ 比消耗 $X$ 的任何其他过程快得多时才有效。$X$ 通过失活被消耗的速率由 $k_{1b}$ 表征，而其生成自由基的消耗速率由 $k_{2}$ 表征。因此，PE 的有效性条件是 $k_2 \\ll k_{1b}$。在此范围内，$\\frac{k_{2}}{k_{1b}} \\approx 0$，且 $\\Phi \\approx 1$，这意味着 PE 假设是准确的。相反，当从 $X$ 生成自由基的速率（步骤 ($2$)）与 $X$ 失活回到 $F$ 的速率（步骤 ($1b$)）相当或更快时，即 $k_2 \\gtrsim k_{1b}$，PE 假设失效，$\\Phi$ 会变得显著大于 $1$。这表明简单的 PE 假设高估了 $X$ 的浓度，并因此高估了自由基 $R$ 的浓度。",
            "answer": "$$ \\boxed{1 + \\frac{k_{2}}{k_{1b}}} $$"
        },
        {
            "introduction": "理论通过计算得以生动展现。这个动手编程练习  要求您模拟一个反应机理，其中产物抑制效应导致了部分平衡（PE）假设的失效——即使其对应的可逆反应本身非常快。通过实现该系统的常微分方程（ODEs）并分析模拟结果，您将对竞争性动力学路径如何破坏预设的平衡获得一种实践性的、定量的理解。",
            "id": "4055648",
            "problem": "考虑一个均质、等温、恒容反应器，其中有五种化学物质，其行为遵循质量作用定律和理想混合物假设。设这些物质分别表示为 $A$、$B$、$C$、$E$ 和 $CE$，其浓度 $\\left[A\\right]$、$\\left[B\\right]$、$\\left[C\\right]$、$\\left[E\\right]$ 和 $\\left[CE\\right]$ 的单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。反应机理定义如下，其中所有速率常数均为非负参数：\n\n- 快速可逆结合：$A + B \\rightleftharpoons C$，正向速率常数为 $k_{1f}$（单位 $\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$），逆向速率常数为 $k_{1r}$（单位 $\\mathrm{s}^{-1}$）。\n- 产物生成：$C \\rightarrow E$，速率常数为 $k_{3}$（单位 $\\mathrm{s}^{-1}$）（在所考虑的时间范围内为不可逆反应）。\n- 通过络合作用实现产物抑制：$C + E \\rightleftharpoons CE$，正向速率常数为 $k_{2f}$（单位 $\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$），逆向速率常数为 $k_{2r}$（单位 $\\mathrm{s}^{-1}$）。\n\n假设空间均匀，且无物质流入或流出。每种物质浓度的变化率由化学计量和质量作用速率决定，时间单位为秒。控制该系统的常微分方程组（ODE）将根据这些原理推导得出。对于快速可逆反应对 $A + B \\rightleftharpoons C$ 的部分平衡（PE）近似假设，其净速率与正向和逆向速率相比可以忽略不计，即该可逆反应对迅速达到平衡，意味着该反应对的净通量近似为零。然而，通过 $C + E \\rightleftharpoons CE$ 步骤的产物抑制会减少可用于 $A + B \\rightleftharpoons C$ 逆反应的游离 $C$ 的量，从而导致即使在正向和逆向速率都很大的情况下，快速可逆步骤中仍存在显著的净驱动力。准稳态近似（QSSA）适用于像 $CE$ 这样快速形成的络合物，但其合理性应基于常微分方程组和相关的时间尺度分离进行证明，而非直接假设。\n\n您的任务是实现一个程序，该程序针对几组参数集，将常微分方程组从时间 $t = 0$ 积分到 $t = t_f$，并使用一个为可逆反应对 $A + B \\rightleftharpoons C$ 定义的无量纲相对净驱动力度量来量化部分平衡近似的失效程度。该度量在 $t = t_f$ 时定义为\n$$\n\\phi(t_f) \\equiv \\frac{\\left|r_{1f}(t_f) - r_{1r}(t_f)\\right|}{r_{1f}(t_f) + r_{1r}(t_f)},\n$$\n其中 $r_{1f}(t) = k_{1f}\\left[A\\right](t)\\left[B\\right](t)$ 且 $r_{1r}(t) = k_{1r}\\left[C\\right](t)$。量 $\\phi$ 是一个无量纲的度量，用于衡量可逆反应对偏离部分平衡的程度：$\\phi$ 值接近 $0$ 表示部分平衡假设良好成立，而接近 $1$ 的值表示部分平衡假设严重失效。在整个计算过程中，浓度单位使用 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，时间单位使用秒，并将 $\\phi$ 报告为无量纲浮点数。\n\n所有测试用例使用的初始条件为：\n- $\\left[A\\right]_0 = 10^{-2}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$，\n- $\\left[B\\right]_0 = 10^{-2}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$，\n- $\\left[C\\right]_0 = 0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$，\n- $\\left[E\\right]_0 = 0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$，\n- $\\left[CE\\right]_0 = 0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n对于所有测试用例，使用相同的快速可逆反应对速率常数：\n- $k_{1f} = 10^{3}\\ \\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$，\n- $k_{1r} = 10^{3}\\ \\mathrm{s}^{-1}$，\n并积分到一个共同的终止时间 $t_f = 10^{-3}\\ \\mathrm{s}$。\n\n使用适合处理不同时间尺度的刚性求解器来实现常微分方程组的积分。\n\n提供一个包含以下参数集 $(k_{2f}, k_{2r}, k_{3})$ 的测试套件，用以探测不同的反应机制区域：\n1. 一般情况（产物抑制较弱，预计部分平衡成立）：$(10^{3}, 10^{4}, 10)$。\n2. 失效情况（产物抑制强，且在给定时间范围内有明显产物生成）：$(10^{6}, 10^{3}, 50)$。\n3. 边界情况（无产物，因此无抑制）：$(10^{6}, 10^{3}, 0)$。\n4. 极端情况（结合与解离极快，结合亲和力中等，产物生成更快）：$(10^{7}, 10^{7}, 100)$。\n\n对于每个测试用例，使用 $t_f$ 时刻的浓度和上述定义计算 $\\phi(t_f)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\left[\\phi_1,\\phi_2,\\phi_3,\\phi_4\\right]$），列表中的每个条目是按所列顺序对应的测试用例的 $\\phi(t_f)$ 值。$\\phi$ 的值应报告为浮点数（无量纲）。不应打印任何其他输出。",
            "solution": "用户希望我通过执行以下步骤来解决一个化学动力学问题：\n1.  **验证问题陈述**：这是第一步，也是最关键的一步。我需要确保问题在科学上是合理的、适定的和客观的。\n2.  **推导控制方程**：基于所提供的反应机理和质量作用定律。\n3.  **数值求解ODE系统**：对给定的几组参数，使用合适的刚性求解器。\n4.  **计算特定度量**：在每个参数集的积分结束时刻进行计算。\n5.  **格式化输出**：以特定的逗号分隔列表格式呈现结果。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n\n*   **物质**：$A$、$B$、$C$、$E$、$CE$。浓度表示为 $\\left[A\\right]$、$\\left[B\\right]$、$\\left[C\\right]$、$\\left[E\\right]$、$\\left[CE\\right]$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n*   **物理条件**：均质、等温、恒容反应器。\n*   **动力学模型**：质量作用定律，理想混合物。\n*   **反应机理**：\n    1.  $A + B \\rightleftharpoons C$（快速可逆结合），速率常数为 $k_{1f}$ ($\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$) 和 $k_{1r}$ ($\\mathrm{s}^{-1}$)。\n    2.  $C \\rightarrow E$（产物生成），速率常数为 $k_{3}$ ($\\mathrm{s}^{-1}$)。\n    3.  $C + E \\rightleftharpoons CE$（通过络合作用实现产物抑制），速率常数为 $k_{2f}$ ($\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$) 和 $k_{2r}$ ($\\mathrm{s}^{-1}$)。\n*   **初始条件 ($t=0$)**：\n    *   $\\left[A\\right]_0 = 10^{-2}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n    *   $\\left[B\\right]_0 = 10^{-2}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n    *   $\\left[C\\right]_0 = 0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n    *   $\\left[E\\right]_0 = 0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n    *   $\\left[CE\\right]_0 = 0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n*   **固定参数**：\n    *   $k_{1f} = 10^{3}\\ \\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$\n    *   $k_{1r} = 10^{3}\\ \\mathrm{s}^{-1}$\n    *   $t_f = 10^{-3}\\ \\mathrm{s}$（最终积分时间）\n*   **测试用例（$(k_{2f}, k_{2r}, k_{3})$ 的参数集）**：\n    1.  $(10^{3}, 10^{4}, 10)$\n    2.  $(10^{6}, 10^{3}, 50)$\n    3.  $(10^{6}, 10^{3}, 0)$\n    4.  $(10^{7}, 10^{7}, 100)$\n*   **任务**：\n    1.  将ODE系统从 $t=0$ 积分到 $t=t_f$。\n    2.  计算度量 $\\phi(t_f) = \\frac{\\left|r_{1f}(t_f) - r_{1r}(t_f)\\right|}{r_{1f}(t_f) + r_{1r}(t_f)}$，其中 $r_{1f}(t) = k_{1f}\\left[A\\right](t)\\left[B\\right](t)$ 且 $r_{1r}(t) = k_{1r}\\left[C\\right](t)$。\n    3.  以特定的列表格式报告四个测试用例的结果。\n\n**1.2. 使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题牢固地植根于标准化学动力学，采用质量作用定律来描述均相体系中的反应速率。这是物理化学和化学工程中的一个基本概念。所涉及的反应方案，包括结合、解离和络合，是化学和生物系统（例如，带产物抑制的酶动力学）中的常见模式。该问题在科学上是合理的。\n*   **适定性**：该问题指定了一个一阶常微分方程组（可从机理推导）、一套完整的初始条件和所有必要的参数。标准的ODE存在唯一性定理（如Picard-Lindelöf定理，尽管需要扩展到系统）保证了局部唯一解的存在。所提供的速率常数在物理上是合理的，并且要求使用刚性求解器恰当地认识到了可能存在的时间尺度差异，这在此类动力学模型中是典型的。可以找到一个唯一的、稳定的、有意义的数值解。\n*   **客观性**：问题以精确、定量、无偏见的数学和科学语言陈述。任务是基于模拟结果计算一个明确定义的数值度量。没有主观或基于意见的陈述。\n*   **自洽性和一致性**：求解所需的所有数据（物质、反应、速率常数、初始条件、终止时间以及度量定义）均已提供。内部没有矛盾。单位是一致的。\n*   **总体评估**：该问题没有违反任何无效性标准。这是一个计算化学动力学领域的标准、定义明确的问题。\n\n**1.3. 结论与行动**\n\n问题是**有效的**。我将继续进行解题方案的构建和实施。\n\n### 步骤2：公式化与求解设计\n\n问题的核心是求解控制五种物质浓度的常微分方程组（ODE）。\n\n**2.1. ODE系统推导**\n\n设浓度表示为 $y_A = [A]$, $y_B = [B]$, $y_C = [C]$, $y_E = [E]$, 和 $y_{CE} = [CE]$。三个基本步骤的反应速率由质量作用定律给出：\n*   反应1的正向速率：$r_{1f} = k_{1f} y_A y_B$\n*   反应1的逆向速率：$r_{1r} = k_{1r} y_C$\n*   反应2的正向速率：$r_{2f} = k_{2f} y_C y_E$\n*   反应2的逆向速率：$r_{2r} = k_{2r} y_{CE}$\n*   反应3的速率：$r_3 = k_3 y_C$\n\n净反应速率为：\n*   $\\omega_1 = r_{1f} - r_{1r} = k_{1f} y_A y_B - k_{1r} y_C$\n*   $\\omega_2 = r_{2f} - r_{2r} = k_{2f} y_C y_E - k_{2r} y_{CE}$\n*   $\\omega_3 = r_3 = k_3 y_C$\n\n每种物质浓度的变化率是其在所有反应中生成和消耗速率的总和，并按化学计量系数加权。\n$$\n\\frac{d y_A}{dt} = - \\omega_1 = -k_{1f} y_A y_B + k_{1r} y_C\n$$\n$$\n\\frac{d y_B}{dt} = - \\omega_1 = -k_{1f} y_A y_B + k_{1r} y_C\n$$\n$$\n\\frac{d y_C}{dt} = \\omega_1 - \\omega_2 - \\omega_3 = (k_{1f} y_A y_B - k_{1r} y_C) - (k_{2f} y_C y_E - k_{2r} y_{CE}) - k_3 y_C\n$$\n$$\n\\frac{d y_E}{dt} = \\omega_3 - \\omega_2 = k_3 y_C - (k_{2f} y_C y_E - k_{2r} y_{CE})\n$$\n$$\n\\frac{d y_{CE}}{dt} = \\omega_2 = k_{2f} y_C y_E - k_{2r} y_{CE}\n$$\n这构成了一个包含五个耦合的、非线性的、一阶常微分方程的系统。一个重要的观察是，由于 $\\frac{dy_A}{dt} = \\frac{dy_B}{dt}$ 且它们的初始条件 $y_A(0) = y_B(0)$ 相同，因此对于所有时间 $t \\ge 0$，都有 $y_A(t) = y_B(t)$。虽然这可以用来将系统简化为四个方程，但实施完整的五方程系统更具通用性且不易出错。\n\n**2.2. 数值积分策略**\n该问题涉及的反应可能具有非常不同的时间尺度（例如，$k_{1f}, k_{1r}$ 很大，表明平衡速度快，而 $k_3$ 可能小得多）。这是刚性系统的标志。标准的显式求解器（如四阶龙格-库塔法）需要极小的时间步长来维持稳定性，该步长由最快的反应决定。因此，必须使用专为刚性系统设计的隐式求解器。问题陈述明确建议了这一点。`scipy.integrate.solve_ivp` 使用 `method='Radau'` 或 `method='BDF'` 是一个绝佳的选择。我将使用 `Radau`，这是一种高阶隐式龙格-库塔方法，非常适合刚性问题。\n\n积分将从 $t=0$ 进行到 $t=t_f = 10^{-3}\\,\\mathrm{s}$。状态向量将是 $\\mathbf{y} = [y_A, y_B, y_C, y_E, y_{CE}]$。初始状态为 $\\mathbf{y}_0 = [10^{-2}, 10^{-2}, 0, 0, 0]$。\n\n**2.3. 度量 $\\phi(t_f)$ 的计算**\n将ODE系统积分到 $t_f$ 后，数值求解器将提供最终浓度 $\\mathbf{y}(t_f) = [y_A(t_f), y_B(t_f), y_C(t_f), y_E(t_f), y_{CE}(t_f)]$。使用这些值，计算第一个反应的正向和逆向速率：\n$$\nr_{1f}(t_f) = k_{1f} y_A(t_f) y_B(t_f)\n$$\n$$\nr_{1r}(t_f) = k_{1r} y_C(t_f)\n$$\n然后计算无量纲度量 $\\phi(t_f)$：\n$$\n\\phi(t_f) = \\frac{\\left|r_{1f}(t_f) - r_{1r}(t_f)\\right|}{r_{1f}(t_f) + r_{1r}(t_f)}\n$$\n如果分母为零（这要求两个速率都为零），则分子也为零。这种 $0/0$ 的情况代表完美平衡，$\\phi$ 的极限为 $0$。实现时应处理这种情况，尽管对于给定的参数不太可能发生。一个安全的实现方法是检查分母是否接近于零；如果是，则 $\\phi$ 为 $0$。否则，执行除法。\n\n**2.4. 实施计划**\n实施将遵循问题描述中概述的结构。一个 `solve()` 函数将协调整个过程。一个单独的辅助函数 `odesystem` 将为积分器定义ODE系统。主要的 `solve` 函数将遍历四个测试用例，为每个用例调用 `solve_ivp` 积分器，从结果中计算 $\\phi(t_f)$ 并存储它。最后，它将以要求的格式打印收集到的结果。",
            "answer": "$$\\boxed{[0.00518844, 0.76020584, 0.00000000, 0.83547844]}$$"
        }
    ]
}