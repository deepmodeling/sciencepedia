{
    "hands_on_practices": [
        {
            "introduction": "Runge-Kutta 方法的核心由其 Butcher 表中的系数（$A$、$b$ 和 $c$）定义。这些系数必须满足特定的“相容性条件”，以确保数值格式至少具有一阶精度。本练习将引导你检验这些基本条件，并深入探讨当这些条件被违反时，在刚性化学动力学积分的背景下会产生怎样的物理影响，从而将抽象的数学要求与具体的模拟结果联系起来。",
            "id": "4017903",
            "problem": "考虑一种用于计算燃烧学中刚性化学动力学积分的候选对角隐式 Runge–Kutta (DIRK) 方法，该方法应用于组分质量分数的自治常微分方程 (ODE) 系统，\n$$\n\\frac{dY}{dt}=\\omega(Y,T),\n$$\n其中 $Y$ 表示组分质量分数向量，$T$ 是温度。该方法由其具有 $s=2$ 个级的 Butcher 表格指定：\n$$\nA=\\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix},\\quad\nc=\\begin{pmatrix}\n\\gamma \\\\\n0.999\n\\end{pmatrix},\\quad\nb^{\\top}=\\begin{pmatrix}\n0.5 & 0.5\n\\end{pmatrix},\n$$\n其中 $\\gamma=0.2928932188134524$。\n\n仅使用自治 ODE 的 Runge–Kutta 方法的基本定义及其一阶相容性条件，验证此 Butcher 表格是否满足内部相容性条件 $A\\mathbf{1}=c$ 和权重归一化条件 $\\sum_{i=1}^{s} b_i=1$。然后，为此表格计算标量违背度量\n$$\nE=\\|A\\mathbf{1}-c\\|_{1}+\\left|\\sum_{i=1}^{s} b_i-1\\right|,\n$$\n其中 $\\|\\cdot\\|_{1}$ 是向量 1-范数，$\\mathbf{1}$ 是 $\\mathbb{R}^{s}$ 中所有分量均为 1 的向量。\n\n最后，从物理上解释在刚性燃烧动力学中积分 $\\frac{dY}{dt}=\\omega(Y,T)$ 时，$A\\mathbf{1}-c$ 的每个非零分量和 $\\sum_{i=1}^{s} b_i-1$ 的非零值分别意味着什么。您最终报告的值必须是 $E$，且必须四舍五入到四位有效数字，不带单位。",
            "solution": "我们从步长为 $h>0$ 的自治 ODE $\\frac{dy}{dt}=f(y)$ 的 Runge–Kutta 方法的定义开始。一个通用的 $s$ 级 Runge–Kutta 格式通过\n$$\nY_i=y_n+h\\sum_{j=1}^{s} a_{ij} f(Y_j),\\quad i=1,\\dots,s,\n$$\n定义级值 $Y_i$，并通过\n$$\ny_{n+1}=y_n+h\\sum_{i=1}^{s} b_i f(Y_i).\n$$\n推进求解。对于自治问题，内部相容性条件 $A\\mathbf{1}=c$ 确保当应用于右端项为常数 $f(y)=\\kappa$ (其中 $\\kappa$ 为常数) 的线性测试问题时，级的增量与级横坐标对齐。确实，取 $f(y)=\\kappa$ 可得\n$$\nY_i=y_n+h\\kappa\\sum_{j=1}^{s} a_{ij},\n$$\n而在级横坐标处的精确解应为 $y_n+h\\kappa c_i$。因此，自治 ODE 的内部相容性要求\n$$\n\\sum_{j=1}^{s} a_{ij}=c_i,\\quad \\text{等价于}\\quad A\\mathbf{1}=c.\n$$\n类似地，应用于 $f(y)=\\kappa$ 的步进更新的一阶精度要求\n$$\ny_{n+1}=y_n+h\\kappa\\sum_{i=1}^{s} b_i\\approx y_n+h\\kappa,\n$$\n这意味着权重归一化条件\n$$\n\\sum_{i=1}^{s} b_i=1.\n$$\n\n现在我们为给定的 Butcher 表格评估这些条件。令\n$$\nA=\\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix},\\quad\nc=\\begin{pmatrix}\n\\gamma \\\\\n0.999\n\\end{pmatrix},\\quad\nb^{\\top}=\\begin{pmatrix}\n0.5 & 0.5\n\\end{pmatrix},\\quad\n\\mathbf{1}=\\begin{pmatrix}\n1\\\\\n1\n\\end{pmatrix}.\n$$\n计算 $A\\mathbf{1}$：\n$$\nA\\mathbf{1}=\\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix}\\begin{pmatrix}\n1\\\\\n1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\gamma\\cdot 1+0\\cdot 1\\\\\n(1-\\gamma)\\cdot 1+\\gamma\\cdot 1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\gamma\\\\\n1\n\\end{pmatrix}.\n$$\n因此，\n$$\nA\\mathbf{1}-c=\\begin{pmatrix}\n\\gamma\\\\\n1\n\\end{pmatrix}-\\begin{pmatrix}\n\\gamma\\\\\n0.999\n\\end{pmatrix}\n=\\begin{pmatrix}\n0\\\\\n1-0.999\n\\end{pmatrix}\n=\\begin{pmatrix}\n0\\\\\n0.001\n\\end{pmatrix}.\n$$\n其向量 1-范数是\n$$\n\\|A\\mathbf{1}-c\\|_{1}=|0|+|0.001|=0.001.\n$$\n接下来，计算权重之和：\n$$\n\\sum_{i=1}^{2} b_i=0.5+0.5=1.\n$$\n于是，\n$$\n\\left|\\sum_{i=1}^{2} b_i-1\\right|=|1-1|=0.\n$$\n因此，违背度量为\n$$\nE=\\|A\\mathbf{1}-c\\|_{1}+\\left|\\sum_{i=1}^{2} b_i-1\\right|=0.001+0=0.001.\n$$\n将 $E$ 四舍五入到四位有效数字可得\n$$\nE=1.000\\times 10^{-3}.\n$$\n\n对于刚性燃烧动力学 $\\frac{dY}{dt}=\\omega(Y,T)$ 的物理解释：\n- $A\\mathbf{1}-c$ 的一个非零分量表明内部级位置 $c_i$ 不等于行和 $\\sum_{j=1}^{s} a_{ij}$。对于自治动力学，这种不对齐意味着级状态 $Y_i$ 累积的增量与其名义上的级横坐标不一致。在实践中，这会降低级的阶数，扭曲反应源项评估 $\\omega(Y,T)$ 的时间中心性，并且在刚性区域，会加剧阶数降低并使趋向化学平衡的过程产生偏差。\n- $\\sum_{i=1}^{s} b_i-1$ 的非零值表示在一个步长内无法精确再现常数源项。在化学动力学中，这意味着当 $\\omega(Y,T)$ 在一个步长内（例如，在准稳态条件下）实际上为常数时，该方法会在 $Y$ 中引入系统性漂移，可能违反诸如质量分数总和为一的守恒约束，并错误地表示反应进程。\n\n对于给定的 Butcher 表格，计算出的 $A\\mathbf{1}-c=\\begin{pmatrix}0\\\\0.001\\end{pmatrix}$ 表明仅在第二级存在微小的内部不相容性，而权重归一化是精确的。因此，$E=1.000\\times 10^{-3}$ 量化了一个局限于内部级的微小但非零的偏差。",
            "answer": "$$\\boxed{1.000 \\times 10^{-3}}$$"
        },
        {
            "introduction": "对于化学动力学等刚性系统，仅有精度是不够的，我们还需要方法具备优异的稳定性，特别是L-稳定性，以有效抑制数值振荡。本练习将带你从分析转向设计，通过求解阶数条件和施加稳定性约束（如“刚性精度”），来构造一个具有特定性质的积分方法。你将亲手推导出一个二阶L-稳定SDIRK方法的系数，这个过程是开发用于燃烧模拟的高级数值积分器的核心环节。",
            "id": "4017939",
            "problem": "考虑一个均匀等温反应器，其化学动力学由组分质量分数向量 $\\mathbf{Y}(t)$ 控制，其演化遵循常微分方程 $\\frac{d\\mathbf{Y}}{dt} = \\boldsymbol{\\omega}(\\mathbf{Y})$，其中 $\\boldsymbol{\\omega}(\\mathbf{Y})$ 是从质量作用动力学推导出的反应源项。在计算燃烧学中，这类系统是刚性的，因为雅可比矩阵 $\\frac{\\partial \\boldsymbol{\\omega}}{\\partial \\mathbf{Y}}$ 包含具有大的负实部的特征值。为对该系统进行积分，您将构建一个二阶、两级的单对角隐式Runge–Kutta (SDIRK) 方法，并选择其参数以最大化线性化刚性动力学模态的线性稳定性。\n\n假设一个两级的SDIRK方法，在其系数矩阵中有一个共享的对角参数 $\\gamma$，级横坐标为 $c_{1} = \\gamma$ 和 $c_{2} = 1$，以及Butcher系数\n$$\nA = \\begin{pmatrix}\n\\gamma & 0 \\\\\na_{21} & \\gamma\n\\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix}\nb_{1} \\\\ b_{2}\n\\end{pmatrix}.\n$$\n根据定义，级横坐标约束 $c_{2} = 1$ 强制要求 $a_{21} = 1 - \\gamma$。仅使用应用于自治系统的Runge–Kutta方法的二阶精度要求，将系数 $a_{21}$ 和 $\\mathbf{b}$ 构建为 $\\gamma$ 的函数。\n\n然后，考虑标量线性测试方程 $\\frac{dy}{dt} = \\lambda y$（其中 $z = h \\lambda$ 且 $h > 0$）的线性稳定性，并将放大因子 $R(z)$ 定义为您的SDIRK方法所生成的比率 $y_{n+1}/y_{n}$。在与计算燃烧学相关的刚性动力学体系中，“最大化线性稳定性”采纳了线性稳定性（“L-稳定性”）的精确含义，即放大因子沿负实轴满足 $\\lim_{z \\to -\\infty} R(z) = 0$。强制施加刚性精度，意味着该方法的权重向量等于 $A$ 的最后一行，即 $b_{1} = a_{21}$ 和 $b_{2} = \\gamma$，并同时施加二阶精度条件和刚性精度条件来选择 $\\gamma$，以使该方法是L-稳定的。\n\n您的任务：\n- 推导该两级Runge–Kutta方法的二阶条件，并求解 $a_{21}$ 和 $\\mathbf{b}$ 作为 $\\gamma$ 的函数。\n- 构建SDIRK方法的 $R(z)$，并解释刚性精度如何为刚性动力学模态强制实现L-稳定性。\n- 结合使用二阶条件和刚性精度，确定能产生一个二阶、L-稳定的两级SDIRK方法的唯一 $\\gamma$ 值。\n\n将 $\\gamma$ 的最终值表示为闭式解析表达式。无需四舍五入，答案中不应报告任何物理单位。",
            "solution": "该问题陈述是刚性常微分方程数值分析领域中的一个适定且标准的练习，具体涉及单对角隐式Runge-Kutta (SDIRK) 方法的构建。它具有科学依据、内容自洽，并且所有术语在该学科内都有明确定义。因此，该问题被视为有效，并将构建解答。\n\n任务是为一个受刚性精度约束的二阶、两级、L-稳定的SDIRK方法确定唯一的参数 $\\gamma$，以应用于刚性化学动力学。解答根据问题陈述的引导分为三个部分。\n\n首先，我们使用二阶精度条件推导Runge-Kutta方法的系数，使其表示为 $\\gamma$ 的函数。\n对于自治系统，一个Runge-Kutta方法是二阶($p=2$)的，如果它满足以下两个条件：\n1.  一阶条件：$\\sum_{i=1}^{s} b_i = 1$\n2.  二阶条件：$\\sum_{i=1}^{s} b_i c_i = \\frac{1}{2}$\n\n对于给定的两级($s=2$)方法，其Butcher表由以下各项表征：\n$$\nA = \\begin{pmatrix}\n\\gamma & 0 \\\\\na_{21} & \\gamma\n\\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix}\nb_{1} \\\\ b_{2}\n\\end{pmatrix}, \\quad\n\\mathbf{c} = \\begin{pmatrix}\nc_{1} \\\\ c_{2}\n\\end{pmatrix}\n$$\n问题指定了级横坐标 $c_1 = \\gamma$ 和 $c_2 = 1$。对于第二级，行和等于 $c_i$ 的条件 $c_i = \\sum_{j=1}^{s} a_{ij}$ 为 $c_2 = a_{21} + a_{22}$，这给出 $1 = a_{21} + \\gamma$。此结果证实了所给的约束条件 $a_{21} = 1 - \\gamma$。\n\n将 $s=2$，$c_1 = \\gamma$ 和 $c_2 = 1$ 代入阶数条件，得到一个关于权重 $b_1$ 和 $b_2$ 的二元线性方程组：\n$$\nb_1 + b_2 = 1\n$$\n$$\nb_1 \\gamma + b_2 (1) = \\frac{1}{2}\n$$\n任务的这一部分要求仅根据这些条件求解 $b_1$ 和 $b_2$ 作为 $\\gamma$ 的函数。用第一个方程减去第二个方程得到：\n$$\nb_1(1-\\gamma) = 1 - \\frac{1}{2} = \\frac{1}{2}\n$$\n假设 $\\gamma \\neq 1$，我们可以解出 $b_1$：\n$$\nb_1 = \\frac{1}{2(1-\\gamma)}\n$$\n将此结果代回 $b_1 + b_2 = 1$ 可得到 $b_2$：\n$$\nb_2 = 1 - b_1 = 1 - \\frac{1}{2(1-\\gamma)} = \\frac{2(1-\\gamma) - 1}{2(1-\\gamma)} = \\frac{2 - 2\\gamma - 1}{2(1-\\gamma)} = \\frac{1-2\\gamma}{2(1-\\gamma)}\n$$\n因此，仅基于二阶精度，系数为 $a_{21}=1-\\gamma$，$b_1 = \\frac{1}{2(1-\\gamma)}$，以及 $b_2 = \\frac{1-2\\gamma}{2(1-\\gamma)}$。\n\n其次，我们构建稳定性函数 $R(z)$ 并分析L-稳定性。将Runge-Kutta方法应用于标量测试方程 $\\frac{dy}{dt} = \\lambda y$ 可得 $y_{n+1} = R(z) y_n$，其中 $z = h\\lambda$。对于对角隐式方法，级值 $Y_i$ 由 $Y_i = y_n + h \\sum_{j=1}^{i} a_{ij} f(Y_j) = y_n + z \\sum_{j=1}^{i} a_{ij} (Y_j/y_n)$ 给出。对于最终更新，$y_{n+1} = y_n + h \\sum_{i=1}^s b_i f(Y_i)$。\n问题引导我们施加刚性精度，这意味着权重向量 $\\mathbf{b}$ 与矩阵 $A$ 的最后一行完全相同。对于我们的 $s=2$ 情况，这意味着 $b_1 = a_{21}$ 且 $b_2 = a_{22} = \\gamma$。\n这个条件有一个重要的推论：最终解 $y_{n+1}$ 与最后一个级值 $Y_2$ 相同。\n$y_{n+1} = y_n + h(b_1 f(Y_1) + b_2 f(Y_2)) = y_n + h(a_{21} \\lambda Y_1 + \\gamma \\lambda Y_2)$。\n第二个级值为：$Y_2 = y_n + h(a_{21} \\lambda Y_1 + \\gamma \\lambda Y_2)$。显然 $y_{n+1} = Y_2$。\n因此，稳定性函数为 $R(z) = Y_2/y_n$。我们来推导它。\n第一级给出：\n$$\nY_1 = y_n + h a_{11} \\lambda Y_1 = y_n + z \\gamma \\frac{Y_1}{y_n} y_n \\implies Y_1(1-z\\gamma)=y_n \\implies \\frac{Y_1}{y_n} = \\frac{1}{1-z\\gamma}\n$$\n第二级给出：\n$$\nY_2 = y_n + h a_{21} \\lambda Y_1 + h a_{22} \\lambda Y_2 = y_n + z a_{21} Y_1 + z \\gamma Y_2\n$$\n$$\nY_2(1-z\\gamma) = y_n + z a_{21} Y_1 \\implies \\frac{Y_2}{y_n}(1-z\\gamma) = 1 + z a_{21} \\frac{Y_1}{y_n}\n$$\n代入 $Y_1/y_n$ 的表达式：\n$$\nR(z) = \\frac{Y_2}{y_n} = \\frac{1 + z a_{21} \\frac{1}{1-z\\gamma}}{1-z\\gamma} = \\frac{1-z\\gamma + z a_{21}}{(1-z\\gamma)^2}\n$$\nL-稳定性是当 $z \\to -\\infty$ 时，$\\lim_{z \\to -\\infty} R(z) = 0$ 的性质。对于我们的 $R(z)$，我们考察其极限：\n$$\n\\lim_{z \\to -\\infty} R(z) = \\lim_{z \\to -\\infty} \\frac{1 + (a_{21}-\\gamma)z}{1 - 2z\\gamma + z^2\\gamma^2}\n$$\n分子是关于 $z$ 的一次多项式，而分母是二次多项式。只要 $\\gamma \\neq 0$，该极限就为0。因此，任何具有刚性精度的SDIRK方法都是自动L-稳定的。这就是刚性精度强制实现L-稳定性的方式：它确保了一个有理稳定性函数，其中分母多项式的次数高于分子多项式的次数。\n\n第三，我们通过同时施加二阶精度条件和刚性精度条件来确定 $\\gamma$ 的唯一值。\n条件如下：\n1.  $b_1 + b_2 = 1$\n2.  $b_1 c_1 + b_2 c_2 = \\frac{1}{2}$\n3.  $b_1 = a_{21}$ (来自刚性精度)\n4.  $b_2 = \\gamma$ (来自刚性精度)\n5.  $a_{21} = 1 - \\gamma$ (来自 $c_2=a_{21}+\\gamma=1$)\n6.  $c_1 = \\gamma$\n7.  $c_2 = 1$\n\n将条件(3)、(4)和(5)合并到条件(1)中：\n$$\n(1-\\gamma) + \\gamma = 1 \\implies 1 = 1\n$$\n这表明条件是一致的，但并未约束 $\\gamma$。\n\n现在，我们使用条件(2)，并将所有其他条件代入其中：\n$$\nb_1 c_1 + b_2 c_2 = (a_{21})(c_1) + (\\gamma)(c_2) = (1-\\gamma)(\\gamma) + (\\gamma)(1) = \\frac{1}{2}\n$$\n这给出了一个关于 $\\gamma$ 的二次方程：\n$$\n\\gamma - \\gamma^2 + \\gamma = \\frac{1}{2}\n$$\n$$\n2\\gamma - \\gamma^2 = \\frac{1}{2}\n$$\n两边乘以2并重新整理得到：\n$$\n4\\gamma - 2\\gamma^2 = 1 \\implies 2\\gamma^2 - 4\\gamma + 1 = 0\n$$\n使用求根公式 $\\gamma = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 求解 $\\gamma$：\n$$\n\\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16-8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4}\n$$\n这产生了 $\\gamma$ 的两个可能解：\n$$\n\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\quad \\text{和} \\quad \\gamma_2 = 1 + \\frac{\\sqrt{2}}{2}\n$$\n两个解都能得到一个二阶、L-稳定的SDIRK方法。然而，问题要求一个唯一的 $\\gamma$，并将其应用背景设定在计算燃烧学和化学动力学中。在此背景下，诸如组分质量分数之类的物理量必须保持非负。已知具有负系数（$a_{ij}$ 或 $b_i$）的数值方法在保持正性方面存在问题，并可能导致非物理的解。\n\n我们来检验每个 $\\gamma$ 值对应的系数：\n情况1：$\\gamma = \\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.2929$。\n$a_{21} = 1 - \\gamma_1 = 1 - (1 - \\frac{\\sqrt{2}}{2}) = \\frac{\\sqrt{2}}{2} > 0$。\n权重为 $b_1 = a_{21} = \\frac{\\sqrt{2}}{2} > 0$ 和 $b_2 = \\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} > 0$。\n在这种情况下，所有特征系数（$a_{21}$、$b_1$、$b_2$、$\\gamma$）都是正的。\n\n情况2：$\\gamma = \\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1.7071$。\n$a_{21} = 1 - \\gamma_2 = 1 - (1 + \\frac{\\sqrt{2}}{2}) = -\\frac{\\sqrt{2}}{2} < 0$。\n权重为 $b_1 = a_{21} = -\\frac{\\sqrt{2}}{2} < 0$ 和 $b_2 = \\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} > 0$。\n这个选择导致系数 $a_{21}$ 和 $b_1$ 为负。这种方法不适用于像化学动力学这样的一般非线性刚性问题，因为负系数很容易产生非物理的负质量分数，从而导致模拟的不稳定或失败。\n\n因此，对于预期的应用，只有第一个解在物理上和数值上是可取的。这为选择“唯一”的 $\\gamma$ 提供了依据。更优的选择是 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$。",
            "answer": "$$ \\boxed{1 - \\frac{\\sqrt{2}}{2}} $$"
        },
        {
            "introduction": "数值方法的理论性质，如L-稳定性，必须在实际应用中得到检验。本练习提供了一个将理论与实践相结合的综合计算任务，你将对一个著名的L-稳定SDIRK方法在经典的Robertson刚性化学动力学问题上进行数值验证。通过计算系统雅可比矩阵的特征值 $\\lambda_i$，并评估该方法的稳定性函数 $R(z)$ 在 $z=h\\lambda_i$ 处的值，你将亲眼见证理论上的稳定性如何转化为在实际问题中的稳健表现。",
            "id": "4017946",
            "problem": "考虑被称为罗伯逊问题的刚性化学动力学常微分方程组，该方程组模拟了一个简化的反应机理，并作为刚性问题的原型广泛应用于计算燃烧学中。该系统由物种浓度 $y_1(t)$、$y_2(t)$ 和 $y_3(t)$ 随时间的演化定义，遵循定律 $dy/dt = f(y)$，其中 $y = [y_1, y_2, y_3]^T$，$f(y)$ 由质量作用动力学构建。设反应速率常数为 $k_1 = 0.04$、$k_2 = 10^4$ 和 $k_3 = 3 \\times 10^7$（单位均为 $\\text{s}^{-1}$）。初始条件为 $y(0) = [1, 0, 0]^T$。方程组的右端项为\n$$\n\\frac{dy_1}{dt} = -k_1 y_1 + k_2 y_2 y_3, \\quad\n\\frac{dy_2}{dt} = k_1 y_1 - k_2 y_2 y_3 - k_3 y_2^2, \\quad\n\\frac{dy_3}{dt} = k_3 y_2^2,\n$$\n其中时间 $t$ 以秒为单位，浓度 $y_i$ 经过无量纲化，使得它们的总和在所有时间 $t$ 始终为 $1$。该系统在状态 $y$ 下的雅可比矩阵 $J(y) = \\partial f / \\partial y$ 用于线性化，其特征值表示刚性谱。在对角隐式龙格-库塔（DIRK）方法中，稳定性和刚性处理可以通过线性化放大因子进行分析。对于线性化系统 $dy/dt = J y$，在一个大小为 $h$ 的时间步长上，该因子由稳定性函数 $R(z)$ 在 $z = h \\lambda$ 处的值决定，其中 $\\lambda$ 是 $J$ 的每个特征值。\n\n您的任务是实现并分析归功于 Alexander 的两阶段二阶单对角隐式龙格-库塔方法。该方法在文献中以其 L-稳定性和 A-稳定性而闻名，并用于刚性动力学积分。该方法的对角系数为 $\\gamma = 1 - 1/\\sqrt{2}$。对于标量测试方程 $dy/dt = \\lambda y$，DIRK 方法的单步放大因子由该方法的稳定性函数 $R(z)$ 给出，其中 $z = h \\lambda$。对于 Alexander 方法，$R(z)$ 是一个依赖于 $\\gamma$ 的有理函数，它决定了每一步的放大幅度。\n\n基于以下基本原理：\n- 非线性动力学方程 $dy/dt = f(y)$ 在一个状态 $y^\\star$ 附近的局部线性化得到 $dy/dt = J(y^\\star) y$，其中 $J(y^\\star)$ 是在 $y^\\star$ 处计算的雅可比矩阵，\n- 龙格-库塔方法在标量线性测试方程 $dy/dt = \\lambda y$ 上的稳定性由其稳定性函数 $R(z)$ 表征，而对于线性系统 $dy/dt = J y$，矩阵放大是应用于矩阵 $J$ 的有理函数 $R(h J)$，\n- 方法的 L-稳定性意味着当 $z$ 沿负实轴趋于 $-\\infty$ 时，有 $|R(z)| \\to 0$；而 A-稳定性意味着对于所有满足 $\\operatorname{Re}(z) \\le 0$ 的 $z$，有 $|R(z)| \\le 1$，\n\n您必须实现 Alexander 两阶段 DIRK 稳定性函数，并用它来：\n- 通过计算选定负实数值 $z$ 的 $|R(z)|$ 来验证 L-稳定性，\n- 在虚轴上的样本点上检查 A-稳定性，\n- 通过计算雅可比矩阵 $J(y)$ 在一个物理相关状态 $y$ 下的特征值 $\\lambda_i$ 对应的 $|R(h \\lambda_i)|$ 值，来计算罗伯逊问题的线性化放大因子。具体而言，这个状态 $y$ 是通过将罗伯逊系统从 $t=0$ 到 $t=1$ 进行数值积分得到的在 $t = 1.0$ 秒时的状态。\n\n您的程序必须执行以下操作：\n- 使用刚性求解器将罗伯逊系统从 $t = 0$ 秒积分到 $t = 1.0$ 秒，以获得 $y(1.0)$。\n- 计算雅可比矩阵 $J(y(1.0))$。\n- 使用对角参数为 $\\gamma = 1 - 1/\\sqrt{2}$ 的 DIRK 系数实现 Alexander 两阶段 DIRK 稳定性函数 $R(z)$，并将其明确表示为一个有理函数。\n- 计算并报告 $z = -1$、$z = -10$ 和 $z = -100$ 时的幅值 $|R(z)|$。\n- 分别计算并报告对于 $z = i \\cdot 10$ 和 $z = i \\cdot 100$ 是否满足 $|R(z)| \\le 1$ 的布尔值。此处角度单位是弧度，因为虚轴采样使用复指数。\n- 计算 $J(y(1.0))$ 的特征值 $\\lambda_i$，排除任何满足 $|\\lambda_i| < 10^{-8}$ 的特征值，然后对于步长 $h = 10^{-4}$ 秒、$h = 10^{-2}$ 秒、$h = 10^{-1}$ 秒和 $h = 1.0$ 秒，计算并报告 $|R(h \\lambda_i)|$ 在所有满足 $\\operatorname{Re}(\\lambda_i) < 0$ 的特征值 $i$ 上的最大值。\n\n设计一套稳健的输出，以便可以与已发表的 Alexander DIRK 方法的稳定性（A-稳定性和 L-稳定性）进行验证。为了数值的真实性：\n- 时间单位必须是秒。\n- 浓度是无量纲的。\n- 按照规定报告幅值和布尔值，不带百分号。\n\n测试套件和最终输出：\n- 在程序中内置以下测试套件参数：\n    - 负实轴点：$z = -1$、$z = -10$、$z = -100$。\n    - 虚轴点：$z = i \\cdot 10$、$z = i \\cdot 100$。\n    - 罗伯逊问题最终状态时间：$t = 1.0$ 秒。\n    - 步长：$h = 10^{-4}$ 秒、$h = 10^{-2}$ 秒、$h = 10^{-1}$ 秒和 $h = 1.0$ 秒。\n    - 特征值排除容差：$|\\lambda| < 10^{-8}$。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n    - 三个浮点数 $|R(-1)|$、$|R(-10)|$、$|R(-100)|$。\n    - 两个布尔值，分别表示 $|R(i \\cdot 10)| \\le 1$ 和 $|R(i \\cdot 100)| \\le 1$。\n    - 四个浮点数，分别代表在 $t = 1.0$ 秒时，对于步长 $h = 10^{-4}$、$10^{-2}$、$10^{-1}$ 和 $1.0$ 秒，在所有负实部特征值上 $|R(h \\lambda_i)|$ 的最大值。\n\n最终输出必须严格符合 $[r_1,r_2,r_3,b_1,b_2,a_1,a_2,a_3,a_4]$ 的格式，其中 $r_j$ 是浮点数，$b_j$ 是布尔值，$a_j$ 是浮点数。",
            "solution": "用户提供的问题是数值分析领域中一个适定任务，专门关注用于刚性常微分方程（ODE）的隐式龙格-库塔方法的稳定性。该问题具有科学依据，使用经典的罗伯逊问题作为测试案例，并采用雅可比矩阵、其特征值以及方法的稳定性函数等标准分析工具。所有必要的参数和定义都已提供，从而可以得到一个唯一且可验证的数值解。该问题被判定为**有效**。\n\n解决方案首先建立理论和数学框架，然后进行所要求的具体数值计算。\n\n1.  **罗伯逊问题与刚性**\n    罗伯逊问题模拟了一个简单的三物种化学反应。它是一个包含三个非线性常微分方程的系统：\n    $$\n    \\begin{aligned}\n    \\frac{dy_1}{dt} = -k_1 y_1 + k_2 y_2 y_3 \\\\\n    \\frac{dy_2}{dt} = k_1 y_1 - k_2 y_2 y_3 - k_3 y_2^2 \\\\\n    \\frac{dy_3}{dt} = k_3 y_2^2\n    \\end{aligned}\n    $$\n    其速率常数为 $k_1 = 0.04$，$k_2 = 10^4$ 和 $k_3 = 3 \\times 10^7$。初始状态为 $y(0) = [1, 0, 0]^T$。该系统表现出刚性，意味着动力学的特征时间尺度（由系统雅可比矩阵特征值实部的倒数给出）相差多个数量级。这需要使用隐式数值积分方法才能获得稳定且高效的解。该系统总浓度守恒，即 $\\frac{d}{dt}(y_1+y_2+y_3) = 0$，因此对于所有 $t \\ge 0$，有 $y_1(t)+y_2(t)+y_3(t) = 1$。\n\n2.  **系统雅可比矩阵**\n    系统的稳定性和局部动力学由其雅可比矩阵 $J(y) = \\partial f / \\partial y$ 决定。对于罗伯逊系统，其分量 $J_{ij} = \\partial f_i / \\partial y_j$ 为：\n    $$\n    J(y) = \\begin{pmatrix}\n    \\frac{\\partial f_1}{\\partial y_1} & \\frac{\\partial f_1}{\\partial y_2} & \\frac{\\partial f_1}{\\partial y_3} \\\\\n    \\frac{\\partial f_2}{\\partial y_1} & \\frac{\\partial f_2}{\\partial y_2} & \\frac{\\partial f_2}{\\partial y_3} \\\\\n    \\frac{\\partial f_3}{\\partial y_1} & \\frac{\\partial f_3}{\\partial y_2} & \\frac{\\partial f_3}{\\partial y_3}\n    \\end{pmatrix} =\n    \\begin{pmatrix}\n    -k_1 & k_2 y_3 & k_2 y_2 \\\\\n    k_1 & -k_2 y_3 - 2k_3 y_2 & -k_2 y_2 \\\\\n    0 & 2 k_3 y_2 & 0\n    \\end{pmatrix}\n    $$\n    在给定状态 $y$ 下，$J(y)$ 的特征值决定了解的局部行为。由于质量守恒，其中一个特征值始终为零，对应于不变流形 $y_1+y_2+y_3=1$。其他特征值通常为负数且相差悬殊，这证实了系统的刚性。\n\n3.  **对角隐式龙格-库塔（DIRK）方法与稳定性函数**\n    龙格-库塔方法是求解常微分方程的一族数值格式。当一个方法应用于刚性系统时，其稳定性通过线性测试方程 $dy/dt = \\lambda y$ 进行分析，其中 $\\lambda$ 是一个满足 $\\operatorname{Re}(\\lambda) \\le 0$ 的复数。将龙格-库塔方法应用于该方程，单步迭代的结果为 $y_{n+1} = R(z) y_n$，其中 $z = h\\lambda$，$h$ 是时间步长。函数 $R(z)$ 是稳定性函数，它是一个关于 $z$ 的有理函数，其系数由方法的布切莱表（Butcher tableau）系数决定。对于一个系数矩阵为 $A$、权重向量为 $b$ 的方法，其稳定性函数由下式给出：\n    $$\n    R(z) = 1 + z b^T (I - zA)^{-1} \\mathbf{1}\n    $$\n    该问题指定了 Alexander (1977) 的两阶段、二阶 L-稳定 SDIRK 方法。单对角隐式龙格-库塔（SDIRK）方法的布切莱表具有一个系数矩阵 $A$，该矩阵是下三角矩阵，且主对角线上的值恒为 $\\gamma$。Alexander 方法的具体布切莱表为：\n    $$\n    \\begin{array}{c|cc}\n    \\gamma & \\gamma & 0 \\\\\n    1 & 1-\\gamma & \\gamma \\\\\n    \\hline\n     & 1-\\gamma & \\gamma\n    \\end{array}\n    \\quad \\text{with} \\quad \\gamma = 1 - \\frac{1}{\\sqrt{2}}\n    $$\n    将 $A = \\begin{pmatrix} \\gamma & 0 \\\\ 1-\\gamma & \\gamma \\end{pmatrix}$ 和 $b^T = [1-\\gamma, \\gamma]$ 代入 $R(z)$ 的公式：\n    $$\n    I - zA = \\begin{pmatrix} 1 - z\\gamma & 0 \\\\ -z(1-\\gamma) & 1 - z\\gamma \\end{pmatrix}\n    $$\n    其逆矩阵为：\n    $$\n    (I - zA)^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma & 0 \\\\ z(1-\\gamma) & 1 - z\\gamma \\end{pmatrix}\n    $$\n    然后，$b^T (I - zA)^{-1} \\mathbf{1}$ 变为：\n    $$\n    \\frac{1}{(1-z\\gamma)^2} [1-\\gamma, \\gamma] \\begin{pmatrix} 1-z\\gamma \\\\ 1-2z\\gamma+z \\end{pmatrix} = \\frac{(1-\\gamma)(1-z\\gamma) + \\gamma(1-2z\\gamma+z)}{(1-z\\gamma)^2} = \\frac{1-z\\gamma^2}{(1-z\\gamma)^2}\n    $$\n    最终，稳定性函数为：\n    $$\n    R(z) = 1 + z \\frac{1-z\\gamma^2}{(1-z\\gamma)^2} = \\frac{(1-z\\gamma)^2 + z - z^2\\gamma^2}{(1-z\\gamma)^2} = \\frac{1 - 2z\\gamma + z^2\\gamma^2 + z - z^2\\gamma^2}{(1-z\\gamma)^2} = \\frac{1 + (1-2\\gamma)z}{(1-\\gamma z)^2}\n    $$\n    代入 $\\gamma = 1 - 1/\\sqrt{2}$，我们得到 $1-2\\gamma = 1 - 2(1 - 1/\\sqrt{2}) = -1+\\sqrt{2}$。显式的稳定性函数为：\n    $$\n    R(z) = \\frac{1 + (\\sqrt{2}-1)z}{(1 - (1 - 1/\\sqrt{2})z)^2}\n    $$\n\n4.  **稳定性分析（A-稳定性与 L-稳定性）**\n    - **A-稳定性**要求对于所有满足 $\\operatorname{Re}(z) \\le 0$ 的 $z$，都有 $|R(z)| \\le 1$。这确保了对于任何稳定的线性系统，无论步长如何，数值解都不会增长。我们在虚轴上的样本点 $z=10i$ 和 $z=100i$ 上验证此性质。\n    - **L-稳定性**是一个更强的条件，它要求方法是 A-稳定的，并且当 $\\operatorname{Re}(z) \\to -\\infty$ 时，有 $|R(z)| \\to 0$。这对于刚性系统至关重要，因为它能衰减来自刚性（快速衰减）分量的数值贡献。我们通过计算大的负实数 $z = -1, -10, -100$ 的 $|R(z)|$ 来验证这一点。其幅值应趋于零。\n\n5.  **数值实现与计算**\n    获得所需结果的步骤如下：\n    a. 使用刚性求解器（`scipy.integrate.solve_ivp` 并设置方法为 `'Radau'`）对罗伯逊常微分方程系统从 $t=0$ 积分到 $t=1.0$，以求得状态 $y(1.0)$。\n    b. 使用推导出的公式和状态 $y(1.0)$ 计算雅可比矩阵 $J(y(1.0))$。\n    c. 在代码中实现稳定性函数 $R(z)$，确保其能处理复数值参数。\n    d. 在 $z \\in \\{-1, -10, -100\\}$ 处计算 $|R(z)|$ 以检查 L-稳定性行为。\n    e. 在 $z \\in \\{10i, 100i\\}$ 处计算 $|R(z)| \\le 1$ 以检查 A-稳定性行为。\n    f. 计算 $J(y(1.0))$ 的特征值 $\\lambda_i$。过滤这些特征值，只保留满足 $\\operatorname{Re}(\\lambda_i) < 0$ 和 $|\\lambda_i| \\ge 10^{-8}$ 的值。\n    g. 对于每个指定的步长 $h \\in \\{10^{-4}, 10^{-2}, 10^{-1}, 1.0\\}$，为所有过滤后的特征值计算放大因子集合 $|R(h\\lambda_i)|$。\n    h. 报告每个 $h$ 对应的该集合中的最大值。该值，即放大算子 $R(hJ)$ 的谱半径，决定了线性化系统数值解的稳定性和衰减特性。\n    i. 按照最终输出的要求，将所有结果合并到一个列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the specified numerical analysis problem involving the Robertson\n    problem and the Alexander SDIRK method.\n    \"\"\"\n    \n    # 1. Define constants and problem parameters\n    k1 = 0.04\n    k2 = 1.0e4\n    k3 = 3.0e7\n    \n    # Alexander SDIRK method parameter\n    gamma = 1.0 - 1.0 / np.sqrt(2)\n    \n    # Initial conditions and time span\n    y0 = np.array([1.0, 0.0, 0.0])\n    t_span = [0.0, 1.0]\n\n    # 2. Define ODE system and its Jacobian\n    def robertson_rhs(t, y):\n        \"\"\"Right-hand side of the Robertson ODE system.\"\"\"\n        dy1 = -k1 * y[0] + k2 * y[1] * y[2]\n        dy2 = k1 * y[0] - k2 * y[1] * y[2] - k3 * y[1]**2\n        dy3 = k3 * y[1]**2\n        return np.array([dy1, dy2, dy3])\n\n    def robertson_jac(t, y):\n        \"\"\"Jacobian of the Robertson ODE system.\"\"\"\n        J = np.zeros((3, 3))\n        # df1/dy\n        J[0, 0] = -k1\n        J[0, 1] = k2 * y[2]\n        J[0, 2] = k2 * y[1]\n        # df2/dy\n        J[1, 0] = k1\n        J[1, 1] = -k2 * y[2] - 2 * k3 * y[1]\n        J[1, 2] = -k2 * y[1]\n        # df3/dy\n        J[2, 1] = 2 * k3 * y[1]\n        return J\n        \n    # 3. Integrate the ODE system to find y(1.0)\n    sol = solve_ivp(\n        fun=robertson_rhs,\n        t_span=t_span,\n        y0=y0,\n        method='Radau', # A stiff solver\n        jac=robertson_jac,\n        rtol=1e-9,\n        atol=1e-12\n    )\n    y_final = sol.y[:, -1]\n    \n    # 4. Implement the Alexander SDIRK stability function R(z)\n    def stability_function_R(z, gamma_val):\n        \"\"\"Stability function for the Alexander SDIRK(2,2) method.\"\"\"\n        _1_minus_2gamma = 1.0 - 2.0 * gamma_val # This is sqrt(2) - 1\n        numerator = 1.0 + _1_minus_2gamma * z\n        denominator = (1.0 - gamma_val * z)**2\n        return numerator / denominator\n        \n    results = []\n\n    # 5. Task: Evaluate |R(z)| for z on the negative real axis\n    real_z_points = [-1.0, -10.0, -100.0]\n    for z in real_z_points:\n        R_val = stability_function_R(z, gamma)\n        results.append(np.abs(R_val))\n    \n    # 6. Task: Check A-stability for z on the imaginary axis\n    imag_z_points = [10.0j, 100.0j]\n    for z in imag_z_points:\n        R_val = stability_function_R(z, gamma)\n        results.append(np.abs(R_val) <= 1.0)\n        \n    # 7. Task: Compute linearized amplification factors for the Robertson problem\n    \n    # Compute Jacobian and its eigenvalues at t=1.0\n    J_final = robertson_jac(t_span[1], y_final)\n    eigenvalues = np.linalg.eigvals(J_final)\n    \n    # Filter eigenvalues\n    eigenvalue_tol = 1e-8\n    filtered_eigenvalues = [\n        lam for lam in eigenvalues \n        if np.abs(lam) >= eigenvalue_tol and np.real(lam) < 0\n    ]\n    \n    step_sizes_h = [1e-4, 1e-2, 1e-1, 1.0]\n    \n    for h in step_sizes_h:\n        if not filtered_eigenvalues:\n            # This case should not happen for Robertson problem\n            max_amplification = np.nan\n        else:\n            amplification_factors = [\n                np.abs(stability_function_R(h * lam, gamma))\n                for lam in filtered_eigenvalues\n            ]\n            max_amplification = np.max(amplification_factors)\n        results.append(max_amplification)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}