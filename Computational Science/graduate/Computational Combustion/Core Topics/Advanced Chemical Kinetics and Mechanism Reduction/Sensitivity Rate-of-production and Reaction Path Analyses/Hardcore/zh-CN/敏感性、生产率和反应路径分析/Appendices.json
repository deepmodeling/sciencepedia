{
    "hands_on_practices": [
        {
            "introduction": "能够正确构建一个物种的产率（Rate of Production, ROP）是化学动力学建模的基石。本练习提供了从一组给定的基元反应中直接推导ROP表达式的基础实践，旨在巩固您对单个反应步骤如何影响物种总浓度变化的理解。",
            "id": "4060890",
            "problem": "考虑一个包含四种物种 $H$、$O_2$、$HO_2$ 和 $H_2O_2$ 的等温、等压、空间均匀的理想气体混合物。其基元化学反应机理仅限于以下两个可逆反应：\n$$\nR_1:\\quad H + O_2 \\rightleftharpoons HO_2, \\qquad R_2:\\quad HO_2 + HO_2 \\rightleftharpoons H_2O_2 + O_2.\n$$\n假设为基元质量作用动力学。将反应 $R_1$ 的正向和逆向速率系数分别记为 $k_{1f}$ 和 $k_{1r}$，将反应 $R_2$ 的正向和逆向速率系数分别记为 $k_{2f}$ 和 $k_{2r}$。令 $[X]$ 表示物种 $X$ 的摩尔浓度。基于化学计量和质量作用动力学，使用标准的物种生成速率定义，推导出 $HO_2$ 的生成速率（ROP），记为 $\\mathrm{ROP}_{HO_2}$，并将其表示为 $k_{1f}$、$k_{1r}$、$k_{2f}$、$k_{2r}$、$[H]$、$[O_2]$、$[HO_2]$ 和 $[H_2O_2]$ 的函数。清晰地指出哪些项对应于 $HO_2$ 的生成，哪些对应于其消耗，并将它们组合成一个单一的 $\\mathrm{ROP}_{HO_2}$ 简化表达式。\n\n最终表达式需以摩尔浓度（例如，单位为 $\\mathrm{mol}\\,\\mathrm{cm}^{-3}$）和时间（例如，单位为 $\\mathrm{s}$）的符号形式表示，使得 $\\mathrm{ROP}_{HO_2}$ 的量纲为浓度每时间。不要代入任何数值，也不要进行任何单位转换。最终答案必须是单一的闭式解析表达式（不含不等式或需要求解的方程）。无需进行四舍五入。",
            "solution": "该问题要求推导在一个由两个可逆基元反应定义的化学体系中，物种 $HO_2$ 的生成速率（Rate of Production, ROP）。一个物种的 ROP 是其摩尔浓度因体系中所有化学反应而变化的净速率，通常记为 $\\omega_i$ 或 $\\mathrm{ROP}_i$。它由所有 $N_r$ 个基元反应的贡献加和而成：\n$$\n\\mathrm{ROP}_{i} = \\frac{d[X_i]}{dt} = \\sum_{j=1}^{N_r} \\nu_{ij} r_j\n$$\n其中 $r_j$ 是反应 $j$ 的净反应速率（rate of progress），而 $\\nu_{ij}$ 是物种 $i$ 在反应 $j$ 中的净化学计量系数。根据本文中定义的约定，$\\nu_{ij} = \\nu'_{ij} - \\nu''_{ij}$，其中 $\\nu'_{ij}$ 是产物侧的化学计量系数，$\\nu''_{ij}$ 是反应物侧的化学计量系数。\n\n对于一个可逆的基元反应，其净速率 $r_j$ 是正向速率 $r_{j,f}$ 和逆向速率 $r_{j,b}$ 之差。根据质量作用定律，我们有：\n$$\nr_j = r_{j,f} - r_{j,b}\n$$\n我们将此框架应用于给定的两个反应中的物种 $HO_2$。\n\n**反应 1: $R_1: H + O_2 \\rightleftharpoons HO_2$**\n\n首先，我们确定 $HO_2$ 在反应 $R_1$ 中的净化学计量系数。在这个反应中，$HO_2$ 是产物，其产物侧化学计量系数为 $\\nu'_{HO_2, 1} = 1$；它不是反应物，因此其反应物侧化学计量系数为 $\\nu''_{HO_2, 1} = 0$。\n净化学计量系数为 $\\nu_{HO_2, 1} = \\nu'_{HO_2, 1} - \\nu''_{HO_2, 1} = 1 - 0 = 1$。\n\n反应 $R_1$ 的净速率 $r_1$ 为：\n$$\nr_1 = r_{1,f} - r_{1,b} = k_{1f} [H] [O_2] - k_{1r} [HO_2]\n$$\n\n因此，反应 $R_1$ 对 $HO_2$ 的 ROP 的贡献为：\n$$\n(\\mathrm{ROP}_{HO_2})_1 = \\nu_{HO_2, 1} \\times r_1 = (1) \\times (k_{1f} [H] [O_2] - k_{1r} [HO_2]) = k_{1f} [H] [O_2] - k_{1r} [HO_2]\n$$\n\n**反应 2: $R_2: HO_2 + HO_2 \\rightleftharpoons H_2O_2 + O_2$**\n\n接下来，我们分析反应 $R_2$ 的贡献。在这个反应中，$HO_2$ 是反应物，其反应物侧化学计量系数为 $\\nu''_{HO_2, 2} = 2$；它不是产物，因此其产物侧化学计量系数为 $\\nu'_{HO_2, 2} = 0$。\n净化学计量系数为 $\\nu_{HO_2, 2} = \\nu'_{HO_2, 2} - \\nu''_{HO_2, 2} = 0 - 2 = -2$。\n\n反应 $R_2$ 的净速率 $r_2$ 为：\n$$\nr_2 = r_{2,f} - r_{2,b} = k_{2f} [HO_2]^2 - k_{2r} [H_2O_2] [O_2]\n$$\n\n因此，反应 $R_2$ 对 $HO_2$ 的 ROP 的贡献为：\n$$\n(\\mathrm{ROP}_{HO_2})_2 = \\nu_{HO_2, 2} \\times r_2 = (-2) \\times (k_{2f} [HO_2]^2 - k_{2r} [H_2O_2] [O_2]) = -2 k_{2f} [HO_2]^2 + 2 k_{2r} [H_2O_2] [O_2]\n$$\n因子 2 的出现是因为在反应 $R_2$ 的每个正向步骤中净消耗两个 $HO_2$ 分子，而在每个逆向步骤中净生成两个 $HO_2$ 分子。\n\n**$HO_2$ 的总生成速率**\n\n$HO_2$ 的总 ROP 是来自所有反应的贡献之和：\n$$\n\\mathrm{ROP}_{HO_2} = (\\mathrm{ROP}_{HO_2})_1 + (\\mathrm{ROP}_{HO_2})_2\n$$\n$$\n\\mathrm{ROP}_{HO_2} = (k_{1f} [H] [O_2] - k_{1r} [HO_2]) + (-2 k_{2f} [HO_2]^2 + 2 k_{2r} [H_2O_2] [O_2])\n$$\n将这些项合并成一个单一表达式，得到：\n$$\n\\mathrm{ROP}_{HO_2} = k_{1f} [H] [O_2] - k_{1r} [HO_2] - 2 k_{2f} [HO_2]^2 + 2 k_{2r} [H_2O_2] [O_2]\n$$\n\n按要求，我们辨识出对应于 $HO_2$ 生成（正号）和消耗（负号）的各项：\n- **$HO_2$ 的生成**：\n  - 来自 $R_1$ 正向反应 ($H + O_2 \\rightarrow HO_2$)：$+ k_{1f} [H] [O_2]$\n  - 来自 $R_2$ 逆向反应 ($H_2O_2 + O_2 \\rightarrow 2HO_2$)：$+ 2 k_{2r} [H_2O_2] [O_2]$\n- **$HO_2$ 的消耗**：\n  - 来自 $R_1$ 逆向反应 ($HO_2 \\rightarrow H + O_2$)：$- k_{1r} [HO_2]$\n  - 来自 $R_2$ 正向反应 ($2HO_2 \\rightarrow H_2O_2 + O_2$)：$- 2 k_{2f} [HO_2]^2$\n\n最终的简化表达式是这四项的线性组合。",
            "answer": "$$\n\\boxed{k_{1f} [H] [O_2] - k_{1r} [HO_2] - 2 k_{2f} [HO_2]^2 + 2 k_{2r} [H_2O_2] [O_2]}\n$$"
        },
        {
            "introduction": "一个化学上合理的动力学模型必须严格遵守质量守恒定律。本练习将指导您构建一个诊断检查，以验证反应机理是否质量守恒，这是开发和使用任何燃烧模型时都至关重要的质量控制步骤。",
            "id": "4060806",
            "problem": "考虑一个在恒定体积下的均匀、等温反应混合物，其由摩尔组分守恒描述。令 $i \\in \\{1,\\dots,N\\}$ 为化学组分的索引，$r \\in \\{1,\\dots,R\\}$ 为基元反应的索引。将组分 $i$ 的摩尔浓度记为 $c_i$，其分子量记为 $W_i$ (单位为 $\\mathrm{g/mol}$)，组分 $i$ 在反应 $r$ 中的化学计量系数记为 $\\nu_{i r}$ (产物为正，反应物为负)，反应 $r$ 的标量反应速率记为 $\\mathcal{R}_r$ (单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$)。定义组分 $i$ 的生成速率 (ROP) 为 $ \\mathrm{ROP}_i = \\sum_{r=1}^{R} \\nu_{i r}\\,\\mathcal{R}_r$，因此组分摩尔守恒方程可写为 $ \\frac{d c_i}{d t} = \\mathrm{ROP}_i$。一个反应机理遵守质量守恒，当且仅当每个反应本身都质量平衡，即对所有 $r$ 都有 $ \\sum_{i=1}^{N} W_i \\,\\nu_{i r} = 0$。\n\n(a) 严格地从组分摩尔守恒和所述的质量守恒条件出发，构建一个关于质量守恒的标量诊断残差，该残差用分子量、化学计量系数和反应速率表示。您的表达式必须写成一个仅包含 $W_i$、$\\nu_{i r}$ 和 $\\mathcal{R}_r$ 的单一闭式解析标量。然后，解释该标量残差如何与每个反应的质量缺陷相关联，并描述一种有原则的策略，用于在不引用任何预先给定的快捷公式的情况下，定位由数值舍入、不一致的分子量或错误的化学计量引起的偏差。\n\n(b) 为了以无量纲方式量化任何偏差的严重程度，定义一个基于组分质量生成速率绝对值之和 $ \\sum_{i=1}^{N} | W_i \\,\\mathrm{ROP}_i |$ 的归一化方法，并通过将(a)部分得到的标量残差的绝对值除以该归一化值，来形成一个无量纲归一化残差。对于单步反应机理\n$$ 2\\,\\mathrm{H}_2 + \\mathrm{O}_2 \\longrightarrow 2\\,\\mathrm{H}_2\\mathrm{O}, $$\n使用特定状态下的以下数据：\n- $W_{\\mathrm{H}_2} = 2.01588$ (单位为 $\\mathrm{g/mol}$), $W_{\\mathrm{O}_2} = 31.9988$ (单位为 $\\mathrm{g/mol}$), $W_{\\mathrm{H}_2\\mathrm{O}} = 18.0000$ (单位为 $\\mathrm{g/mol}$),\n- $\\nu_{\\mathrm{H}_2,1} = -2$, $\\nu_{\\mathrm{O}_2,1} = -1$, $\\nu_{\\mathrm{H}_2\\mathrm{O},1} = +2$,\n- $\\mathcal{R}_1 = 0.75$ (单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$).\n\n计算上面定义的无量纲归一化残差。将您的答案四舍五入到四位有效数字。将最终值表示为无单位的纯小数。",
            "solution": "**(a) 质量守恒残差的推导与定位策略**\n\n分析始于一个封闭、均匀、恒定体积系统中的质量守恒基本原理。总质量密度 $\\rho$ 是所有组分的分质量密度 $\\rho_i$ 之和。组分 $i$ 的分质量密度是其摩尔浓度 $c_i$ 与其分子量 $W_i$ 的乘积。因此，总质量密度为：\n$$ \\rho = \\sum_{i=1}^{N} \\rho_i = \\sum_{i=1}^{N} c_i W_i $$\n为使总质量守恒，其对时间 $t$ 的变化率必须为零。\n$$ \\frac{d\\rho}{dt} = 0 $$\n我们可以构建一个诊断残差 $\\mathcal{D}$，它表示计算出的总质量密度的变化率。如果反应机理及相关数据与质量守恒完全一致，该残差将为零。任何非零值都表示存在偏差。我们通过对 $\\rho$ 的表达式关于时间求导来推导该残差。由于分子量 $W_i$ 是常数，我们有：\n$$ \\frac{d\\rho}{dt} = \\frac{d}{dt} \\left( \\sum_{i=1}^{N} c_i W_i \\right) = \\sum_{i=1}^{N} W_i \\frac{dc_i}{dt} $$\n问题给出了组分摩尔守恒方程，该方程将浓度的变化率与组分的生成速率 ($\\mathrm{ROP}$) 等同起来：\n$$ \\frac{dc_i}{dt} = \\mathrm{ROP}_i = \\sum_{r=1}^{R} \\nu_{i r}\\,\\mathcal{R}_r $$\n将此表达式代入我们关于 $\\frac{d\\rho}{dt}$ 的方程中，得到：\n$$ \\frac{d\\rho}{dt} = \\sum_{i=1}^{N} W_i \\left( \\sum_{r=1}^{R} \\nu_{i r}\\,\\mathcal{R}_r \\right) $$\n该表达式代表了系统中总的质量生成速率。为了更好地理解其结构，我们可以交换求和的顺序，因为求和是有限的：\n$$ \\frac{d\\rho}{dt} = \\sum_{r=1}^{R} \\sum_{i=1}^{N} W_i \\nu_{i r}\\,\\mathcal{R}_r = \\sum_{r=1}^{R} \\left( \\sum_{i=1}^{N} W_i \\nu_{i r} \\right) \\mathcal{R}_r $$\n问题指出，一个反应机理遵守质量守恒，当且仅当对于每个独立的反应 $r$ 都有 $\\sum_{i=1}^{N} W_i \\,\\nu_{i r} = 0$。括号内的项 $\\delta_r \\equiv \\sum_{i=1}^{N} W_i \\nu_{i r}$ 是反应 $r$ 的*质量缺陷*。它表示进行一摩尔反应 $r$ 所产生或消耗的净质量。如果对所有 $r \\in \\{1,\\dots,R\\}$ 都有 $\\delta_r = 0$，那么 $\\frac{d\\rho}{dt} = \\sum_{r=1}^{R} (0) \\mathcal{R}_r = 0$，总质量守恒。\n\n因此，以给定量的单一闭式解析标量形式表示的质量守恒标量诊断残差为：\n$$ \\mathcal{D} = \\sum_{r=1}^{R} \\left( \\sum_{i=1}^{N} W_i \\nu_{i r} \\right) \\mathcal{R}_r $$\n这个残差 $\\mathcal{D}$ 正是总质量密度的变化率 $\\frac{d\\rho}{dt}$。\n\n这个表达式将总质量守恒偏差 $\\mathcal{D}$ 与每个反应的质量缺陷 $\\delta_r$ 直接关联起来。总残差是各个反应质量缺陷的加权和，其权重是相应的反应速率 $\\mathcal{R}_r$。\n\n一种无需引用任何预先给定的公式来定位偏差的有原则的策略，直接源于此结构。我们不应只计算总残差 $\\mathcal{D}$，而必须执行以下步骤：\n1.  对机理中的每个基元反应 $r$ (从 $r=1$ 到 $R$)，计算其各自的质量缺陷：\n    $$ \\delta_r = \\sum_{i=1}^{N} W_i \\nu_{i r} $$\n2.  在一个小的数值容差范围内，将每个 $\\delta_r$ 与零进行比较。\n3.  任何 $\\delta_r \\neq 0$ 的反应 $r$ 都是质量不平衡的来源。这将问题定位到特定的反应。\n4.  对于每个有偏差的反应，检查参与该反应的组分集以及它们相应的化学计量系数 $\\nu_{ir}$ 和分子量 $W_i$。误差必定存在于这个小的数据子集中，这可能是由于错误的化学计量系数（例如，机理文件中的录入错误）、某个组分不一致的分子量分配，或者在分子量未以足够精度和一致性指定时的数值舍入误差。\n\n**(b) 无量纲归一化残差的计算**\n\n问题将无量纲归一化残差 $\\mathcal{D}_{norm}$ 定义为：\n$$ \\mathcal{D}_{norm} = \\frac{|\\mathcal{D}|}{\\sum_{i=1}^{N} | W_i \\,\\mathrm{ROP}_i |} $$\n对于所给的单步反应机理 ($R=1$)，标量残差为 $\\mathcal{D} = (\\sum_{i=1}^{N} W_i \\nu_{i,1}) \\mathcal{R}_1$，组分 $i$ 的生成速率为 $\\mathrm{ROP}_i = \\nu_{i,1} \\mathcal{R}_1$。\n\n将这些代入 $\\mathcal{D}_{norm}$ 的定义中：\n$$ \\mathcal{D}_{norm} = \\frac{\\left| \\left(\\sum_{i=1}^{N} W_i \\nu_{i,1}\\right) \\mathcal{R}_1 \\right|}{\\sum_{i=1}^{N} | W_i \\nu_{i,1} \\mathcal{R}_1 |} = \\frac{|\\mathcal{R}_1| \\left| \\sum_{i=1}^{N} W_i \\nu_{i,1} \\right|}{|\\mathcal{R}_1| \\sum_{i=1}^{N} | W_i \\nu_{i,1} |} $$\n由于反应速率 $\\mathcal{R}_1 = 0.75$ 非零，它可以被消去，从而得到一个仅依赖于化学计量和分子量的简化表达式：\n$$ \\mathcal{D}_{norm} = \\frac{\\left| \\sum_{i=1}^{N} W_i \\nu_{i,1} \\right|}{\\sum_{i=1}^{N} | W_i \\nu_{i,1} |} $$\n涉及的组分是 $\\mathrm{H}_2$、$\\mathrm{O}_2$ 和 $\\mathrm{H}_2\\mathrm{O}$。我们使用所提供的数据：\n- $W_{\\mathrm{H}_2} = 2.01588$\n- $W_{\\mathrm{O}_2} = 31.9988$\n- $W_{\\mathrm{H}_2\\mathrm{O}} = 18.0000$\n- $\\nu_{\\mathrm{H}_2,1} = -2$\n- $\\nu_{\\mathrm{O}_2,1} = -1$\n- $\\nu_{\\mathrm{H}_2\\mathrm{O},1} = +2$\n\n首先，我们计算分子，即反应质量缺陷的绝对值 $|\\delta_1|$：\n$$ \\delta_1 = \\sum_{i=1}^{N} W_i \\nu_{i,1} = W_{\\mathrm{H}_2}\\nu_{\\mathrm{H}_2,1} + W_{\\mathrm{O}_2}\\nu_{\\mathrm{O}_2,1} + W_{\\mathrm{H}_2\\mathrm{O}}\\nu_{\\mathrm{H}_2\\mathrm{O},1} $$\n$$ \\delta_1 = (2.01588)(-2) + (31.9988)(-1) + (18.0000)(+2) $$\n$$ \\delta_1 = -4.03176 - 31.9988 + 36.0000 = -0.03056 $$\n分子为 $|\\delta_1| = |-0.03056| = 0.03056$。\n\n接下来，我们计算分母，即每个组分质量贡献的绝对值之和：\n$$ \\sum_{i=1}^{N} | W_i \\nu_{i,1} | = |W_{\\mathrm{H}_2}\\nu_{\\mathrm{H}_2,1}| + |W_{\\mathrm{O}_2}\\nu_{\\mathrm{O}_2,1}| + |W_{\\mathrm{H}_2\\mathrm{O}}\\nu_{\\mathrm{H}_2\\mathrm{O},1}| $$\n$$ \\sum_{i=1}^{N} | W_i \\nu_{i,1} | = |(2.01588)(-2)| + |(31.9988)(-1)| + |(18.0000)(+2)| $$\n$$ \\sum_{i=1}^{N} | W_i \\nu_{i,1} | = |-4.03176| + |-31.9988| + |36.0000| $$\n$$ \\sum_{i=1}^{N} | W_i \\nu_{i,1} | = 4.03176 + 31.9988 + 36.0000 = 72.03056 $$\n\n最后，我们计算该比值以求得无量纲归一化残差：\n$$ \\mathcal{D}_{norm} = \\frac{0.03056}{72.03056} \\approx 0.0004242646... $$\n将此值四舍五入到四位有效数字，得到 $0.0004243$。",
            "answer": "$$\\boxed{0.0004243}$$"
        },
        {
            "introduction": "识别最具影响力的反应是反应路径分析的主要目标，但在速率参数存在不确定性的情况下，我们对这一识别结果的置信度有多高？这项高级练习引入了一种基于蒙特卡洛方法来评估结论的稳健性，引导您从简单的确定性排序，过渡到更切合实际的概率性框架。",
            "id": "4060858",
            "problem": "给定一个均相、恒压反应体系的单一热化学状态，该体系遵循质量作用定律。对于索引为 $i$ 的物种，其生产速率 (Rate of Production, ROP) 通过分解为各反应贡献的基本形式定义如下：\n$$\n\\mathrm{ROP}_i \\;=\\; \\sum_{j=1}^{N_r} \\nu_{i,j}\\,\\omega_j,\n$$\n其中 $N_r$ 是反应总数，$\\nu_{i,j}$ 是物种 $i$ 在反应 $j$ 中的净化学计量系数（生成为正，消耗为负），$\\omega_j$ 是反应 $j$ 的净速率。单个反应对物种 $i$ 的 ROP 的贡献为\n$$\n\\mathrm{ROP}_{i,j} \\;=\\; \\nu_{i,j}\\,\\omega_j,\n$$\n反应路径分析通过对各贡献的绝对值 $|\\mathrm{ROP}_{i,j}|$ 进行排序，来排列对物种 $i$ 浓度变化贡献最强的反应。\n\n假设针对动力学速率参数存在一个局部参数不确定性模型，使得对于每个索引为 $j$ 的反应，其净反应速率 $\\omega_j$ 受到如下乘性扰动：\n$$\n\\omega_j \\;\\mapsto\\; u_j\\,\\omega_j,\n$$\n其中 $u_j$ 在各反应间独立且被建模为对数正态分布：\n$$\n\\ln(u_j) \\sim \\mathcal{N}\\!\\left(-\\tfrac{1}{2}\\sigma_j^2,\\;\\sigma_j^2\\right).\n$$\n该选择确保了 $\\mathbb{E}[u_j] = 1$，同时允许通过对数空间中的标准差 $\\sigma_j$ 来控制其分布的离散程度。在此不确定性下，单个反应的 ROP 贡献扰动为：\n$$\n\\mathrm{ROP}_{i,j} \\;\\mapsto\\; u_j\\,\\mathrm{ROP}_{i,j}.\n$$\n\n您的任务是：\n- 实现一个算法，通过将绝对值 $|\\mathrm{ROP}_{i,j}|$ 按降序排序并选取前 $k$ 个反应，来确定对 $\\mathrm{ROP}_i$ 贡献最大的 $k$ 个主导反应。若出现平局（即绝对值相等），则优先选择零基索引较小的反应。\n- 通过蒙特卡洛采样，计算在扰动贡献 $|u_j\\,\\mathrm{ROP}_{i,j}|$ 下每个反应进入前 $k$ 名的概率，从而评估这种主导地位在参数不确定性下的稳健性。将具有最大概率的 $k$ 个反应定义为稳健主导集，若出现平局（即概率相等），则优先选择零基索引较小的反应。\n\n请使用以下测试套件。每个案例定义了 $N_r$、化学计量系数向量 $\\nu_{i,j}$、基准反应速率向量 $\\omega_j$、对数空间标准差向量 $\\sigma_j$ 以及整数 $k$。在本问题中，所有数组都是无量纲的，索引为从零开始的整数。\n\n- 案例 A（一般情况，绝对值各不相同）：\n  - $N_r = 5$\n  - $\\nu_{i,j} = (\\,1.0,\\,-2.0,\\,1.0,\\,0.0,\\,1.0\\,)$\n  - $\\omega_j = (\\,2.0,\\,0.5,\\,1.5,\\,0.0,\\,-0.2\\,)$\n  - $\\sigma_j = (\\,0.1,\\,0.4,\\,0.2,\\,0.3,\\,0.5\\,)$\n  - $k = 2$\n- 案例 B（边界情况， $|\\mathrm{ROP}_{i,j}|$ 存在相等值）：\n  - $N_r = 4$\n  - $\\nu_{i,j} = (\\,1.0,\\,1.0,\\,-1.0,\\,1.0\\,)$\n  - $\\omega_j = (\\,1.0,\\,-1.0,\\,1.0,\\,-1.0\\,)$\n  - $\\sigma_j = (\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,)$\n  - $k = 3$\n- 案例 C（极端情况，一个高度不确定的主导反应）：\n  - $N_r = 6$\n  - $\\nu_{i,j} = (\\,1.0,\\,1.0,\\,1.0,\\,-1.0,\\,2.0,\\,-3.0\\,)$\n  - $\\omega_j = (\\,0.8,\\,0.7,\\,0.6,\\,0.3,\\,0.2,\\,-0.5\\,)$\n  - $\\sigma_j = (\\,0.15,\\,0.10,\\,0.10,\\,0.20,\\,0.10,\\,0.60\\,)$\n  - $k = 3$\n\n蒙特卡洛参数：\n- 每个案例的独立抽样数量 $N = 10000$。\n- 为保证可复现性，随机种子固定为 $42$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。\n- 对于每个测试用例，输出一个包含两个元素的列表：\n  - 第一项是基于基准状态下 $|\\mathrm{ROP}_{i,j}|$ 排序得到的 $k$ 个主导反应的索引列表。\n  - 第二项是基于不确定性模型下通过蒙特卡洛方法计算出的前 $k$ 名出现概率排序得到的 $k$ 个稳健主导反应的索引列表。\n- 索引必须是从零开始的整数。\n- 完整的输出应如下所示：\n$$\n[\\,[\\text{基准前\\_k个},\\;\\text{稳健前\\_k个}],\\,[\\dots],\\,[\\dots]\\,]\n$$\n其中每个占位符都是一个整数列表。\n\n您的程序必须实现以上要求，并严格按照指定格式生成单行输出。",
            "solution": "该问题是有效的。它在科学上基于化学动力学和不确定性量化的原理，定义清晰，有明确的平局处理规则，并且是客观且计算可行的。\n\n解决方案要求为每个测试用例实现两种不同的分析：确定性反应路径分析和通过蒙特卡洛模拟进行的概率性稳健性分析。其目的是比较两种方法识别出的主导化学反应集合。\n\n### 第一部分：确定性主导反应分析\n\n此分析基于单一、名义上的热化学状态下反应对物种 $i$ 的生产速率 (ROP) 的贡献，来识别最具影响力的反应。\n\n反应 $j$ 对物种 $i$ 的 ROP 的贡献由下式给出：\n$$\n\\mathrm{ROP}_{i,j} \\;=\\; \\nu_{i,j}\\,\\omega_j\n$$\n其中 $\\nu_{i,j}$ 是化学计量系数，$\\omega_j$ 是净反应速率。该贡献的绝对值 $|\\mathrm{ROP}_{i,j}|$ 量化了反应 $j$ 对物种 $i$ 浓度的影响，无论它是生产途径还是消耗途径。\n\n寻找 $k$ 个主导反应集的算法如下：\n1.  对于每个反应 $j \\in \\{0, 1, \\dots, N_r-1\\}$（其中 $N_r$ 是反应总数），使用提供的向量 $\\boldsymbol{\\nu}_i$ 和 $\\boldsymbol{\\omega}$ 计算基准 ROP 贡献 $\\mathrm{ROP}_{i,j} = \\nu_{i,j}\\omega_j$。\n2.  计算每个贡献的绝对值 $|\\mathrm{ROP}_{i,j}|$。\n3.  为便于排序，创建一个元组列表，其中每个元组包含绝对值及其对应的反应索引：$(|\\mathrm{ROP}_{i,j}|, j)$。\n4.  对该元组列表进行排序。主要排序标准是绝对值，按降序排列。次要排序标准（用于解决绝对值相等的情况）是反应索引 $j$，按升序排列。这遵循了指定的平局处理规则。\n5.  确定性主导集由排序后列表中的前 $k$ 个元组的索引构成。\n\n### 第二部分：概率性稳健性分析\n\n此分析评估在动力学参数不确定性下，反应主导性层次结构的稳定性。不确定性通过对每个反应速率 $\\omega_j$ 施加一个独立的、服从对数正态分布的乘性因子 $u_j$ 来建模。$\\ln(u_j)$ 的分布被指定为正态分布 $\\mathcal{N}(-\\frac{1}{2}\\sigma_j^2, \\sigma_j^2)$，其中 $\\sigma_j$ 是为反应 $j$ 指定的对数空间标准差。这种形式确保了乘数的期望值为 $\\mathbb{E}[u_j]=1$。\n\n扰动后的 ROP 贡献为 $\\mathrm{ROP}_{i,j}^{\\text{pert}} = u_j \\mathrm{ROP}_{i,j}$。该分析通过蒙特卡洛模拟进行。\n\n算法如下：\n1.  初始化一个大小为 $N_r$ 的频率计数器数组 `counts`，所有元素均为零。该数组将存储在所有蒙特卡洛样本中每个反应出现在前 $k$ 名集合中的次数。\n2.  固定随机数生成器的种子为 $42$ 以确保可复现性。\n3.  执行一个总共 $N=10000$ 个样本的循环。在每次迭代中：\n    a.  对于每个反应 $j=0, \\dots, N_r-1$，生成一个随机乘数 $u_j$。这可以通过首先从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取一个样本 $z_j$，然后计算 $u_j = \\exp(-\\frac{1}{2}\\sigma_j^2 + \\sigma_j z_j)$ 来实现。\n    b.  计算此样本的扰动后 ROP 贡献的绝对值：$|\\mathrm{ROP}_{i,j}^{\\text{pert}}| = |u_j \\mathrm{ROP}_{i,j}| = u_j |\\mathrm{ROP}_{i,j}|$，因为 $u_j$ 严格为正。\n    c.  通过对配对 $(|\\mathrm{ROP}_{i,j}^{\\text{pert}}|, j)$ 使用与确定性情况相同的“绝对值降序，索引升序”规则进行排序，来确定该扰动样本的前 $k$ 个主导反应。\n    d.  对于上一步中确定的 $k$ 个反应索引，将其在 `counts` 数组中对应的计数器加一。\n4.  循环结束后，通过将每个反应 $j$ 的总计数除以样本数 $N$ 来计算其出现在前 $k$ 名集合中的概率 $P_j$：$P_j = \\text{counts}_j / N$。\n5.  为确定稳健主导集，根据这些概率对反应进行排序。创建一个元组列表 $(P_j, j)$，并以概率 $P_j$ 为主键（降序），索引 $j$ 为次键（升序）进行排序。\n6.  稳健主导集由该排序后的概率列表中的前 $k$ 个元组的索引构成。\n\n通过比较确定性主导集和稳健主导集，可以评估动力学不确定性对标准反应路径分析所得结论的影响。一个在确定性分析中占主导地位但具有高不确定性的反应，其主导概率可能会很低，并可能在稳健集中被一个主导性较弱但更确定的反应所取代。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reaction path robustness problem for the given test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (general, distinct magnitudes)\n        {\n            \"Nr\": 5,\n            \"nu_i\": (1.0, -2.0, 1.0, 0.0, 1.0),\n            \"omega\": (2.0, 0.5, 1.5, 0.0, -0.2),\n            \"sigma\": (0.1, 0.4, 0.2, 0.3, 0.5),\n            \"k\": 2,\n        },\n        # Case B (boundary, ties in |ROP_ij|)\n        {\n            \"Nr\": 4,\n            \"nu_i\": (1.0, 1.0, -1.0, 1.0),\n            \"omega\": (1.0, -1.0, 1.0, -1.0),\n            \"sigma\": (0.0, 0.0, 0.0, 0.0),\n            \"k\": 3,\n        },\n        # Case C (edge, one highly uncertain dominant reaction)\n        {\n            \"Nr\": 6,\n            \"nu_i\": (1.0, 1.0, 1.0, -1.0, 2.0, -3.0),\n            \"omega\": (0.8, 0.7, 0.6, 0.3, 0.2, -0.5),\n            \"sigma\": (0.15, 0.10, 0.10, 0.20, 0.10, 0.60),\n            \"k\": 3,\n        },\n    ]\n\n    mc_samples = 10000\n    seed = 42\n    results = []\n\n    for case in test_cases:\n        Nr = case[\"Nr\"]\n        nu_i = np.array(case[\"nu_i\"])\n        omega = np.array(case[\"omega\"])\n        sigma = np.array(case[\"sigma\"])\n        k = case[\"k\"]\n        \n        indices = np.arange(Nr)\n\n        # --- Task 1: Deterministic Dominant Reaction Analysis ---\n        rop_ij = nu_i * omega\n        abs_rop_ij = np.abs(rop_ij)\n\n        # Sort by magnitude (desc) and then index (asc) for tie-breaking\n        base_sorted_pairs = sorted(zip(abs_rop_ij, indices), key=lambda p: (-p[0], p[1]))\n        base_top_k = [pair[1] for pair in base_sorted_pairs[:k]]\n\n        # --- Task 2: Probabilistic Robustness Analysis ---\n        np.random.seed(seed)\n        top_k_counts = np.zeros(Nr, dtype=int)\n\n        for _ in range(mc_samples):\n            # Generate lognormal multipliers u_j\n            z = np.random.normal(size=Nr)\n            u = np.exp(-0.5 * sigma**2 + sigma * z)\n\n            # Calculate perturbed ROP magnitudes\n            perturbed_abs_rop = u * abs_rop_ij\n            \n            # Identify top k for this sample\n            sample_sorted_pairs = sorted(zip(perturbed_abs_rop, indices), key=lambda p: (-p[0], p[1]))\n            sample_top_k_indices = [pair[1] for pair in sample_sorted_pairs[:k]]\n            \n            # Increment counts for the top k reactions\n            top_k_counts[sample_top_k_indices] += 1\n            \n        # Calculate probabilities\n        probabilities = top_k_counts / mc_samples\n\n        # Determine robust dominant set by sorting probabilities\n        prob_sorted_pairs = sorted(zip(probabilities, indices), key=lambda p: (-p[0], p[1]))\n        robust_top_k = [pair[1] for pair in prob_sorted_pairs[:k]]\n\n        results.append([base_top_k, robust_top_k])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list in Python includes spaces, matching the format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}