{
    "hands_on_practices": [
        {
            "introduction": "In practical combustion systems, radiative heat transfer is often governed by a mixture of participating media, primarily hot gases like $H_2O$ and $CO_2$, and soot particles. A crucial first step in modeling such systems is to understand the relative contribution of each component. This practice  will guide you through a calculation, starting from the fundamental Radiative Transfer Equation (RTE) under the optically thin approximation, to estimate the fraction of radiative loss from soot versus gas in a typical diffusion flame environment. This exercise provides a quantitative understanding of why soot is often the dominant radiator, a key piece of physical intuition in computational combustion.",
            "id": "4056019",
            "problem": "Consider a locally homogeneous control volume embedded in the luminous core of a turbulent diffusion flame at temperature $T=1800\\,\\mathrm{K}$ and pressure $p=1\\,\\mathrm{atm}$. The medium is participating due to soot and radiatively active gases. Assume the following physically realistic conditions and models:\n\n- The Radiative Transfer Equation (RTE) for emission and absorption governs radiative transport, and scattering is negligible for both soot and gas in this region.\n- The region is optically thin, so reabsorption within the volume and incident irradiation from the surroundings are negligible; i.e., the net radiative loss can be estimated from local emission alone.\n- Soot is modeled as small, absorbing particles in the Rayleigh limit. Its Planck-mean absorption coefficient is represented by the well-tested expression $\\kappa_{P,\\text{soot}}=\\dfrac{3\\,E_P\\,f_v}{d_p}$, where $E_P$ is the Planck-averaged dimensionless absorption function of soot material at the given temperature, $f_v$ is the soot volume fraction, and $d_p$ is the primary particle diameter.\n- For the product gas mixture at $T=1800\\,\\mathrm{K}$ with representative mole fractions $x_{\\mathrm{H_2O}}=0.10$ and $x_{\\mathrm{CO_2}}=0.12$, high-resolution line-by-line modeling yields a Planck-mean absorption coefficient $\\kappa_{P,\\text{gas}}=0.40\\,\\mathrm{m}^{-1}$ at $p=1\\,\\mathrm{atm}$.\n- The Planck-averaged soot absorption function at $T=1800\\,\\mathrm{K}$ is $E_P=0.28$, the soot volume fraction is $f_v=2.0\\times 10^{-7}$, and the primary particle diameter is $d_p=35\\,\\mathrm{nm}$.\n\nStarting from the fundamental definition of emission in a participating medium and the Radiative Transfer Equation (RTE), use the optically thin approximation to derive, from first principles, an expression for the fraction of the total volumetric radiative loss attributable to soot. Then evaluate this fraction numerically using the given data. Express your final answer as a dimensionless decimal rounded to four significant figures.",
            "solution": "The problem requires the derivation of an expression for the fraction of total volumetric radiative loss attributable to soot in a participating medium, followed by a numerical evaluation.\n\n**Part 1: Theoretical Derivation**\n\nThe fundamental equation governing the transport of thermal radiation in an absorbing, emitting, and non-scattering medium is the Radiative Transfer Equation (RTE). Along a path with coordinate $s$, the RTE for the spectral intensity $I_\\lambda$ is:\n$$\n\\frac{dI_\\lambda}{ds} = \\kappa_\\lambda I_{b\\lambda}(T) - \\kappa_\\lambda I_\\lambda\n$$\nHere, $\\kappa_\\lambda$ is the spectral absorption coefficient of the medium, $I_{b\\lambda}(T)$ is the spectral intensity of a blackbody at temperature $T$ (given by Planck's law), and the terms on the right-hand side represent spectral emission and absorption, respectively.\n\nThe net rate of energy transferred by radiation per unit volume is given by the divergence of the radiative heat flux vector, $\\nabla \\cdot \\mathbf{q}_r$. This quantity can be expressed by integrating the source term of the RTE over all solid angles ($4\\pi$ steradians) and all wavelengths:\n$$\n\\nabla \\cdot \\mathbf{q}_r = \\int_{0}^{\\infty} \\int_{4\\pi} (\\kappa_\\lambda I_{b\\lambda}(T) - \\kappa_\\lambda I_\\lambda) \\,d\\Omega \\,d\\lambda\n$$\nThis can be rewritten as:\n$$\n\\nabla \\cdot \\mathbf{q}_r = \\int_{0}^{\\infty} \\kappa_\\lambda \\left( \\int_{4\\pi} I_{b\\lambda}(T) \\,d\\Omega - \\int_{4\\pi} I_\\lambda \\,d\\Omega \\right) d\\lambda\n$$\nSince blackbody radiation is isotropic, $I_{b\\lambda}(T)$ is independent of direction, so $\\int_{4\\pi} I_{b\\lambda}(T) \\,d\\Omega = 4\\pi I_{b\\lambda}(T)$. The second integral defines the incident spectral irradiation, $G_\\lambda = \\int_{4\\pi} I_\\lambda \\,d\\Omega$. Thus,\n$$\n\\nabla \\cdot \\mathbf{q}_r = \\int_{0}^{\\infty} \\kappa_\\lambda (4\\pi I_{b\\lambda}(T) - G_\\lambda) \\,d\\lambda\n$$\nThe problem states that the medium is optically thin and that incident irradiation from the surroundings is negligible. In the optically thin approximation, radiation emitted by the medium escapes without significant reabsorption. This, combined with negligible external irradiation, implies that the local radiative intensity $I_\\lambda$ is very small compared to the blackbody intensity, so $I_\\lambda \\approx 0$. Consequently, the incident irradiation $G_\\lambda$ is also approximately zero.\n\nUnder this approximation, the volumetric radiative loss, which we define as $q_{loss} = \\nabla \\cdot \\mathbf{q}_r$, simplifies to the volumetric emission rate:\n$$\nq_{loss} \\approx \\int_{0}^{\\infty} 4\\pi \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda = 4\\pi \\int_{0}^{\\infty} \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda\n$$\nTo evaluate this spectral integral, we introduce the Planck-mean absorption coefficient, $\\kappa_P$, which is defined as the spectrally averaged absorption coefficient weighted by the blackbody intensity distribution:\n$$\n\\kappa_P = \\frac{\\int_{0}^{\\infty} \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda}{\\int_{0}^{\\infty} I_{b\\lambda}(T) \\,d\\lambda}\n$$\nThe denominator is the total blackbody intensity, which is related to the Stefan-Boltzmann constant $\\sigma$ by $\\int_{0}^{\\infty} I_{b\\lambda}(T) \\,d\\lambda = \\frac{\\sigma T^4}{\\pi}$.\nRearranging the definition of $\\kappa_P$, we get:\n$$\n\\int_{0}^{\\infty} \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda = \\kappa_P \\int_{0}^{\\infty} I_{b\\lambda}(T) \\,d\\lambda = \\kappa_P \\frac{\\sigma T^4}{\\pi}\n$$\nSubstituting this back into the expression for $q_{loss}$:\n$$\nq_{loss} = 4\\pi \\left( \\kappa_P \\frac{\\sigma T^4}{\\pi} \\right) = 4 \\kappa_P \\sigma T^4\n$$\nThis is the expression for the total volumetric radiative loss in an optically thin medium.\n\nThe medium is a mixture of soot and radiatively active gases. Assuming the species form a simple mixture, their spectral absorption coefficients are additive: $\\kappa_\\lambda = \\kappa_{\\lambda, \\text{soot}} + \\kappa_{\\lambda, \\text{gas}}$. Due to the linearity of the integration in the definition of $\\kappa_P$, the total Planck-mean absorption coefficient is the sum of the individual Planck-mean coefficients:\n$$\n\\kappa_{P, \\text{total}} = \\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}\n$$\nThe total volumetric radiative loss is therefore:\n$$\nq_{loss, \\text{total}} = 4 \\kappa_{P, \\text{total}} \\sigma T^4 = 4 (\\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}) \\sigma T^4\n$$\nThe portion of this loss attributable to emission from soot is determined solely by its own absorption coefficient:\n$$\nq_{loss, \\text{soot}} = 4 \\kappa_{P, \\text{soot}} \\sigma T^4\n$$\nThe fraction of the total volumetric radiative loss attributable to soot, $F_{\\text{soot}}$, is the ratio of the loss due to soot to the total loss:\n$$\nF_{\\text{soot}} = \\frac{q_{loss, \\text{soot}}}{q_{loss, \\text{total}}} = \\frac{4 \\kappa_{P, \\text{soot}} \\sigma T^4}{4 (\\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}) \\sigma T^4}\n$$\nThe terms $4$, $\\sigma$, and $T^4$ cancel, yielding the final derived expression:\n$$\nF_{\\text{soot}} = \\frac{\\kappa_{P, \\text{soot}}}{\\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}}\n$$\n\n**Part 2: Numerical Evaluation**\n\nWe are given the Planck-mean absorption coefficient for the gas phase:\n$$\n\\kappa_{P, \\text{gas}} = 0.40\\,\\mathrm{m}^{-1}\n$$\nWe must calculate the Planck-mean absorption coefficient for soot using the provided model and data:\n$$\n\\kappa_{P,\\text{soot}} = \\frac{3\\,E_P\\,f_v}{d_p}\n$$\nThe given values are:\n- $E_P = 0.28$\n- $f_v = 2.0 \\times 10^{-7}$\n- $d_p = 35\\,\\mathrm{nm} = 35 \\times 10^{-9}\\,\\mathrm{m}$\n\nSubstituting these values into the expression for $\\kappa_{P,\\text{soot}}$:\n$$\n\\kappa_{P,\\text{soot}} = \\frac{3 \\times 0.28 \\times (2.0 \\times 10^{-7})}{35 \\times 10^{-9}\\,\\mathrm{m}} = \\frac{1.68 \\times 10^{-7}}{35 \\times 10^{-9}\\,\\mathrm{m}} = 4.8\\,\\mathrm{m}^{-1}\n$$\nNow we can compute the fraction $F_{\\text{soot}}$ by substituting the numerical values of the absorption coefficients:\n$$\nF_{\\text{soot}} = \\frac{4.8\\,\\mathrm{m}^{-1}}{4.8\\,\\mathrm{m}^{-1} + 0.40\\,\\mathrm{m}^{-1}} = \\frac{4.8}{5.2}\n$$\n$$\nF_{\\text{soot}} = \\frac{48}{52} = \\frac{12}{13} \\approx 0.9230769...\n$$\nThe problem requires the answer to be a dimensionless decimal rounded to four significant figures. Rounding the result gives:\n$$\nF_{\\text{soot}} = 0.9231\n$$\nThis result signifies that, under the given conditions, soot is responsible for approximately $92.31\\%$ of the total radiative energy loss from the volume element.",
            "answer": "$$\\boxed{0.9231}$$"
        },
        {
            "introduction": "While understanding the contributors to radiation is vital, accurately modeling their spectral behavior is equally important. A common simplification is the 'gray gas' approximation, where properties are averaged over the entire spectrum. This practice  provides a powerful counterexample, demonstrating a scenario where the gray model fails spectacularly. By analyzing a gas layer with specific spectral characteristics interacting with a spectrally-selective wall, you will derive how this simplification can lead to errors of more than an order of magnitude, revealing the critical role of spectral correlations between medium emission and surface properties.",
            "id": "4056074",
            "problem": "Consider a plane-parallel, isothermal combustion gas layer of thickness $L = 0.05 \\ \\text{m}$ at uniform temperature $T_{g} = 1800 \\ \\text{K}$, bounded below by an opaque wall at $z = 0$ and open to a cold, non-emitting environment on the opposite side. The gas is a mixture dominated by carbon dioxide and water vapor, in Local Thermodynamic Equilibrium (LTE), non-scattering, with refractive index approximately unity, and optically thin such that $k_{\\tilde{\\nu}} L \\ll 1$ for all wavenumbers $\\tilde{\\nu}$.\n\nThe directional spectral intensity $I_{\\tilde{\\nu}}(z, \\mu)$ in a participating medium satisfies the Radiative Transfer Equation (RTE): \n$$\n\\mu \\frac{\\partial I_{\\tilde{\\nu}}}{\\partial z} = -k_{\\tilde{\\nu}} I_{\\tilde{\\nu}} + k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}),\n$$\nwhere $\\mu = \\cos\\theta$ is the direction cosine, $k_{\\tilde{\\nu}}$ is the spectral absorption coefficient, and $I_{b,\\tilde{\\nu}}(T_{g})$ is the blackbody spectral intensity at temperature $T_{g}$. Assume the wall’s emission is negligible compared to the gas emission under these conditions.\n\nPartition the spectrum into two disjoint sets:\n- A line-dominated set $\\mathcal{S}_{\\ell}$ covering strong bands centered in ranges $2000$–$2400 \\ \\text{cm}^{-1}$ and $3000$–$4000 \\ \\text{cm}^{-1}$, with effective absorption coefficient $k_{\\ell} = 0.40 \\ \\text{m}^{-1}$ and wall spectral absorptivity $\\alpha_{\\ell} = 0.05$ within these bands.\n- A complementary background set $\\mathcal{S}_{b}$ comprising the remainder of the spectrum, with $k_{b} = 0.0010 \\ \\text{m}^{-1}$ and wall spectral absorptivity $\\alpha_{b} = 0.90$.\n\nAt $T_{g} = 1800 \\ \\text{K}$, let $f_{\\ell} = 0.28$ and $f_{b} = 0.72$ denote the fractions of the hemispherical blackbody emissive power carried within $\\mathcal{S}_{\\ell}$ and $\\mathcal{S}_{b}$, respectively, so that $f_{\\ell} + f_{b} = 1$. Use the identity for the total hemispherical blackbody emissive power $E_{b}(T_{g}) = \\sigma T_{g}^{4}$ with $\\sigma = 5.670374419 \\times 10^{-8} \\ \\text{W} \\ \\text{m}^{-2} \\ \\text{K}^{-4}$.\n\nStarting from the Radiative Transfer Equation and the optically thin limit, derive the absorbed radiative heat flux at the wall predicted by:\n1. A narrow-band resolution that respects the spectral partition $\\{\\mathcal{S}_{\\ell}, \\mathcal{S}_{b}\\}$.\n2. A gray gas model using the Planck mean absorption coefficient $k_{P}(T_{g})$ and a Planck-weighted wall absorptivity $\\alpha_{P}$ defined by \n$$\nk_{P}(T_{g}) = \\frac{\\int_{0}^{\\infty} k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}, \n\\quad \n\\alpha_{P} = \\frac{\\int_{0}^{\\infty} \\alpha_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}.\n$$\n\nThen, compute the dimensionless ratio \n$$\nR = \\frac{F_{\\text{abs}}^{\\text{gray}}}{F_{\\text{abs}}^{\\text{NB}}}\n$$\nof the gray-model predicted absorbed flux $F_{\\text{abs}}^{\\text{gray}}$ to the narrow-band absorbed flux $F_{\\text{abs}}^{\\text{NB}}$, using the given data. Round your final ratio to four significant figures. Express the final answer as a dimensionless number.",
            "solution": "The task is to derive the absorbed radiative heat flux at the wall ($z=0$) for both a narrow-band model and a gray gas model, and then to compute the ratio of their predictions.\n\nFirst, we must find the spectral intensity incident on the wall. We solve the given Radiative Transfer Equation (RTE) for rays traveling towards the wall (i.e., in directions with $\\mu  0$). The formal solution for intensity at position $z=0$ originating from the top boundary at $z=L$ is:\n$$\nI_{\\tilde{\\nu}}(0, \\mu) = I_{\\tilde{\\nu}}(L, \\mu) \\exp\\left(\\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right) + I_{b,\\tilde{\\nu}}(T_g) \\left(1 - \\exp\\left(\\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right)\\right)\n$$\nSince the top boundary is open to a cold, non-emitting environment, the incident intensity at that boundary is zero: $I_{\\tilde{\\nu}}(L, \\mu  0) = 0$. Using the optically thin approximation ($k_{\\tilde{\\nu}}L \\ll 1$), we expand the exponential term $\\exp(x) \\approx 1+x$. The intensity incident on the wall becomes:\n$$\nI_{\\tilde{\\nu}}(0, \\mu) \\approx I_{b,\\tilde{\\nu}}(T_g) \\left(1 - \\left(1 + \\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right)\\right) = -I_{b,\\tilde{\\nu}}(T_g) \\frac{k_{\\tilde{\\nu}}L}{\\mu}\n$$\nThe spectral radiative heat flux incident on the wall, $F_{\\text{in},\\tilde{\\nu}}$, is found by integrating this intensity over the incoming hemisphere ($\\mu  0$):\n$$\nF_{\\text{in},\\tilde{\\nu}} = \\int_{2\\pi, \\mu0} I_{\\tilde{\\nu}}(0, \\mu) |\\mu| d\\Omega = \\int_{0}^{2\\pi} d\\phi \\int_{-1}^{0} \\left(-I_{b,\\tilde{\\nu}}(T_g) \\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right) (-\\mu) d\\mu = 2\\pi I_{b,\\tilde{\\nu}}(T_g) k_{\\tilde{\\nu}}L\n$$\nThe absorbed spectral heat flux at the wall is then $F_{\\text{abs},\\tilde{\\nu}} = \\alpha_{\\tilde{\\nu}} F_{\\text{in},\\tilde{\\nu}} = 2\\pi \\alpha_{\\tilde{\\nu}} k_{\\tilde{\\nu}} L I_{b,\\tilde{\\nu}}(T_g)$.\n\n**1. Narrow-Band (NB) Absorbed Flux**\nThe total absorbed flux for the narrow-band model, $F_{\\text{abs}}^{\\text{NB}}$, is the integral of $F_{\\text{abs},\\tilde{\\nu}}$ over the entire spectrum. Using the given two-band partition:\n$$\nF_{\\text{abs}}^{\\text{NB}} = \\int_0^\\infty F_{\\text{abs},\\tilde{\\nu}} d\\tilde{\\nu} = 2\\pi L \\left( \\alpha_{\\ell} k_{\\ell} \\int_{\\mathcal{S}_{\\ell}} I_{b,\\tilde{\\nu}}(T_g) d\\tilde{\\nu} + \\alpha_{b} k_{b} \\int_{\\mathcal{S}_{b}} I_{b,\\tilde{\\nu}}(T_g) d\\tilde{\\nu} \\right)\n$$\nUsing the identity $\\int_{\\mathcal{S}_i} I_{b,\\tilde{\\nu}} d\\tilde{\\nu} = f_i \\int_0^\\infty I_{b,\\tilde{\\nu}} d\\tilde{\\nu} = f_i \\frac{\\sigma T_g^4}{\\pi}$, we simplify the expression:\n$$\nF_{\\text{abs}}^{\\text{NB}} = 2\\pi L \\left( \\alpha_{\\ell} k_{\\ell} f_{\\ell} \\frac{\\sigma T_g^4}{\\pi} + \\alpha_{b} k_{b} f_{b} \\frac{\\sigma T_g^4}{\\pi} \\right) = 2 L \\sigma T_g^4 (\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b})\n$$\n\n**2. Gray Gas Model Absorbed Flux**\nFor the gray gas model, we use a single effective absorption coefficient $k_P$ and wall absorptivity $\\alpha_P$. By analogy with the spectral derivation, the total absorbed flux is:\n$$\nF_{\\text{abs}}^{\\text{gray}} = 2 \\alpha_P k_P L \\sigma T_g^4\n$$\nThe Planck-mean properties $k_P$ and $\\alpha_P$ are calculated from their definitions using the two-band model:\n$$\nk_P = \\frac{\\int_{0}^{\\infty} k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}} = k_{\\ell} f_{\\ell} + k_{b} f_{b}\n$$\n$$\n\\alpha_P = \\frac{\\int_{0}^{\\infty} \\alpha_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}} = \\alpha_{\\ell} f_{\\ell} + \\alpha_{b} f_{b}\n$$\n\n**3. Ratio of the Fluxes**\nThe dimensionless ratio $R$ is $R = F_{\\text{abs}}^{\\text{gray}} / F_{\\text{abs}}^{\\text{NB}}$. Substituting the derived expressions:\n$$\nR = \\frac{2 \\alpha_P k_P L \\sigma T_g^4}{2 L \\sigma T_g^4 (\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b})} = \\frac{\\alpha_P k_P}{\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b}} = \\frac{(\\alpha_{\\ell} f_{\\ell} + \\alpha_{b} f_{b})(k_{\\ell} f_{\\ell} + k_{b} f_{b})}{\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b}}\n$$\nNow, we substitute the numerical values:\n-   $k_{\\ell} = 0.40 \\ \\text{m}^{-1}$, $\\alpha_{\\ell} = 0.05$, $f_{\\ell} = 0.28$\n-   $k_{b} = 0.0010 \\ \\text{m}^{-1}$, $\\alpha_{b} = 0.90$, $f_{b} = 0.72$\n\nFirst, compute the Planck-mean properties $\\alpha_P$ and $k_P$:\n$$\n\\alpha_P = (0.05)(0.28) + (0.90)(0.72) = 0.014 + 0.648 = 0.662\n$$\n$$\nk_P = (0.40)(0.28) + (0.0010)(0.72) = 0.112 + 0.00072 = 0.11272 \\ \\text{m}^{-1}\n$$\nThe numerator of the ratio $R$ is the product $\\alpha_P k_P$:\n$$\n\\text{Numerator} = (0.662)(0.11272) = 0.07462064\n$$\nThe denominator is the spectrally-correlated term from the narrow-band model:\n$$\n\\text{Denominator} = \\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b} = (0.05)(0.40)(0.28) + (0.90)(0.0010)(0.72)\n$$\n$$\n\\text{Denominator} = 0.0056 + 0.000648 = 0.006248\n$$\nFinally, compute the ratio $R$:\n$$\nR = \\frac{0.07462064}{0.006248} \\approx 11.943124\n$$\nRounding to four significant figures gives $11.94$. This large error illustrates the failure of the gray gas model when strong negative correlations exist between gas emission (strong in band $\\mathcal{S}_{\\ell}$) and surface absorption (weak in band $\\mathcal{S}_{\\ell}$).",
            "answer": "$$\n\\boxed{11.94}\n$$"
        },
        {
            "introduction": "Given the limitations of the gray gas model, more sophisticated non-gray approaches are essential for accurate simulations. However, brute-force line-by-line (LbL) integration is too computationally expensive for most applications. This hands-on practice  challenges you to implement the correlated-$k$ (c-k) method, a powerful and widely used technique that captures the essential spectral effects with a fraction of the computational cost. You will construct a $k$-distribution from a given high-resolution spectrum and use it to calculate band transmissivity, directly comparing the accuracy and efficiency of the c-k model against the benchmark LbL solution.",
            "id": "4056000",
            "problem": "Consider one-dimensional spectral radiative transfer through a homogeneous, isothermal, non-scattering gas slab in local thermodynamic equilibrium. Start from the Radiative Transfer Equation (RTE) for a collimated beam at a single normalized spectral coordinate $x$ with pure absorption and no emission, $$\\frac{d I(x,s)}{d s} = -\\kappa(x)\\, I(x,s),$$ where $I(x,s)$ is the spectral intensity along path coordinate $s$ and $\\kappa(x)$ is the spectral absorption coefficient. For a slab of physical thickness $L$ and uniform $\\kappa(x)$, the solution is $$I(x,L) = I(x,0)\\,\\exp\\!\\left(-\\kappa(x)\\,L\\right).$$ The spectral transmissivity at $x$ is therefore $$\\mathcal{T}(x;L) = \\exp\\!\\left(-\\kappa(x)\\,L\\right).$$ The band-mean transmissivity over a normalized band $x \\in [0,1]$ is $$\\overline{\\mathcal{T}}(L) = \\int_0^1 \\exp\\!\\left(-\\kappa(x)\\,L\\right)\\,dx.$$\n\nYou are asked to compute the band-mean transmissivity using two methods and to quantify their differences:\n- A line-by-line (LbL) reference computed by explicit quadrature over a uniform spectral grid.\n- A correlated-$k$ approximation using the $k$-distribution and quadrature on the cumulative probability domain.\n\nUse the following scientifically consistent synthetic spectrum for the absorption coefficient with physical units of inverse length (meters to the power minus one):\n$$\\kappa(x) = b + \\sum_{i=1}^{5} A_i \\exp\\!\\left(-\\frac{(x-\\mu_i)^2}{2\\,\\sigma_i^2}\\right),$$\nwith parameters\n- Baseline $b = 0.2$ m$^{-1}$,\n- Line centers $\\mu = [0.15,\\, 0.37,\\, 0.55,\\, 0.72,\\, 0.90]$ (dimensionless),\n- Line amplitudes $A = [150.0,\\, 50.0,\\, 300.0,\\, 120.0,\\, 220.0]$ m$^{-1}$,\n- Line widths $\\sigma = [0.01,\\, 0.02,\\, 0.015,\\, 0.025,\\, 0.008]$ (dimensionless).\n\nFor the LbL reference, approximate the band-mean transmissivity by a uniform Riemann sum on $N$ points:\n$$\\overline{\\mathcal{T}}_{\\text{LbL}}(L) \\approx \\frac{1}{N}\\sum_{j=1}^{N} \\exp\\!\\left(-\\kappa(x_j)\\,L\\right), \\quad x_j = \\frac{j-\\tfrac{1}{2}}{N},$$\nwith $N = 4096$.\n\nFor the correlated-$k$ approximation, construct the empirical $k$-distribution by sorting the set $\\{\\kappa(x_j)\\}_{j=1}^N$ to obtain a nondecreasing sequence $\\{k_{(j)}\\}_{j=1}^N$, and define the empirical cumulative probability coordinates $$g_j = \\frac{j-\\tfrac{1}{2}}{N}, \\quad j=1,\\dots,N.$$ Let $Q(g)$ denote the empirical quantile function that maps $g \\in [0,1]$ to $k$ via linear interpolation of the pairs $(g_j, k_{(j)})$. Approximate the correlated-$k$ transmissivity by Gauss–Legendre quadrature of order $m$ on $[0,1]$:\n$$\\overline{\\mathcal{T}}_{k}(L; m) \\approx \\sum_{q=1}^{m} w_q^{(g)} \\exp\\!\\left(-Q(g_q)\\,L\\right),$$\nwhere $\\{g_q, w_q^{(g)}\\}_{q=1}^m$ are the Gauss–Legendre abscissas and weights on $[0,1]$ obtained by the affine mapping from $[-1,1]$.\n\nCompute, for each test case, the relative error using the LbL value as the reference:\n$$\\varepsilon_{\\text{rel}} = \\frac{\\left|\\overline{\\mathcal{T}}_{k}(L; m) - \\overline{\\mathcal{T}}_{\\text{LbL}}(L)\\right|}{\\overline{\\mathcal{T}}_{\\text{LbL}}(L)}.$$\n\nYour program must implement the above definitions exactly and produce the relative errors for the following test suite of $(L, m)$ pairs, with $L$ in meters and $m$ unitless:\n- $(L, m) = (0.01, 4)$,\n- $(L, m) = (0.01, 12)$,\n- $(L, m) = (1.0, 4)$,\n- $(L, m) = (1.0, 12)$,\n- $(L, m) = (10.0, 4)$,\n- $(L, m) = (10.0, 12)$.\n\nRequirements and deliverables:\n- Use $N = 4096$ spectral points for the LbL reference and for constructing the empirical $k$-distribution.\n- Use Gauss–Legendre quadrature of order $m$ on $[0,1]$ as specified to evaluate the correlated-$k$ integral.\n- Express the band-mean transmissivity as dimensionless quantities. The absorption coefficient $\\kappa$ is in m$^{-1}$ and the slab thickness $L$ is in m.\n- For each test case, compute $\\varepsilon_{\\text{rel}}$ as a float.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_6]$), where $r_i$ is the relative error for the $i$-th test case listed above, in the same order. No other text should be printed.",
            "solution": "The core task is to compute the band-mean transmissivity, $\\overline{\\mathcal{T}}(L)$, of a homogeneous gas slab of thickness $L$. This quantity is defined as the integral of the spectral transmissivity, $\\mathcal{T}(x;L)$, over a normalized spectral band $x \\in [0,1]$:\n$$\n\\overline{\\mathcal{T}}(L) = \\int_0^1 \\mathcal{T}(x;L)\\,dx = \\int_0^1 \\exp\\!\\left(-\\kappa(x)\\,L\\right)\\,dx\n$$\nHere, $\\kappa(x)$ is the spectral absorption coefficient, given as a sum of a baseline and five Gaussian functions representing spectral lines. The solution proceeds by implementing the two specified numerical methods for approximating this integral and then calculating their relative difference.\n\nThe computational procedure is as follows:\n\n1.  **Spectrum Discretization and Evaluation**:\n    First, the function for the absorption coefficient $\\kappa(x)$ is defined as per the problem statement. A uniform spectral grid of $N=4096$ points, $\\{x_j\\}$, is created where $x_j = (j-0.5)/N$ for $j=1, \\dots, N$. The absorption coefficient is evaluated at each of these points to obtain the discrete spectrum $\\{\\kappa(x_j)\\}$.\n\n2.  **Line-by-Line (LbL) Reference Calculation**:\n    The LbL approximation of the band-mean transmissivity serves as the high-fidelity reference. It is computed using a uniform Riemann sum over the $N$ spectral points:\n    $$\n    \\overline{\\mathcal{T}}_{\\text{LbL}}(L) = \\frac{1}{N}\\sum_{j=1}^{N} \\exp\\!\\left(-\\kappa(x_j)\\,L\\right)\n    $$\n    For a given path length $L$, this is calculated by first computing the spectral transmissivity $\\exp(-\\kappa(x_j)L)$ for each point $x_j$ and then taking the arithmetic mean of these values.\n\n3.  **Correlated-$k$ Distribution Construction**:\n    The correlated-$k$ method reformulates the integral over spectral coordinate $x$ into an integral over a cumulative probability coordinate $g$. This is achieved by reordering the spectral absorption coefficients. The set of $N$ values $\\{\\kappa(x_j)\\}$ is sorted in non-decreasing order to obtain the sequence $\\{k_{(j)}\\}$. This sorted sequence, when plotted against the cumulative coordinate $g_j = (j-0.5)/N$, forms the empirical $k$-distribution. A quantile function, $Q(g)$, which maps $g \\in [0,1]$ to an absorption coefficient $k$, is constructed by performing linear interpolation on the discrete data points $(g_j, k_{(j)})$.\n\n4.  **Correlated-$k$ Transmissivity Calculation**:\n    With the reordering, the band-mean transmissivity integral is transformed:\n    $$\n    \\overline{\\mathcal{T}}(L) = \\int_0^1 \\exp\\!\\left(-\\kappa(x)\\,L\\right)\\,dx = \\int_0^1 \\exp\\!\\left(-Q(g)\\,L\\right)\\,dg\n    $$\n    This new integral is evaluated using an $m$-point Gauss-Legendre quadrature over the domain $g \\in [0,1]$. The standard Gauss-Legendre quadrature nodes $\\{\\xi_q\\}$ and weights $\\{w_q^{(\\xi)}\\}$ are defined on $[-1,1]$. They are mapped to the interval $[0,1]$ using the affine transformation:\n    $$\n    g_q = \\frac{1}{2}(\\xi_q + 1), \\quad w_q^{(g)} = \\frac{1}{2}w_q^{(\\xi)}\n    $$\n    The correlated-$k$ transmissivity is then approximated by the sum:\n    $$\n    \\overline{\\mathcal{T}}_{k}(L; m) \\approx \\sum_{q=1}^{m} w_q^{(g)} \\exp\\!\\left(-Q(g_q)\\,L\\right)\n    $$\n    For each quadrature point $g_q$, the corresponding value $Q(g_q)$ is found by interpolating the empirical $k$-distribution.\n\n5.  **Relative Error Calculation**:\n    For each test case pair $(L, m)$, the relative error $\\varepsilon_{\\text{rel}}$ of the correlated-$k$ approximation with respect to the LbL reference is computed as:\n    $$\n    \\varepsilon_{\\text{rel}} = \\frac{\\left|\\overline{\\mathcal{T}}_{k}(L; m) - \\overline{\\mathcal{T}}_{\\text{LbL}}(L)\\right|}{\\overline{\\mathcal{T}}_{\\text{LbL}}(L)}\n    $$\n    This procedure is executed for all six specified $(L, m)$ pairs, and the resulting relative errors are collected and formatted for the final output using a Python script.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes the relative error between LbL and correlated-k models for band-mean\n    transmissivity for a suite of test cases.\n    \"\"\"\n    # Define constants for the absorption coefficient model from the problem statement.\n    B = 0.2  # m^-1\n    MU = np.array([0.15, 0.37, 0.55, 0.72, 0.90])\n    A = np.array([150.0, 50.0, 300.0, 120.0, 220.0])  # m^-1\n    SIGMA = np.array([0.01, 0.02, 0.015, 0.025, 0.008])\n    N = 4096\n\n    # Define the test cases (L, m)\n    test_cases = [\n        (0.01, 4),\n        (0.01, 12),\n        (1.0, 4),\n        (1.0, 12),\n        (10.0, 4),\n        (10.0, 12),\n    ]\n\n    def kappa(x_grid):\n        \"\"\"\n        Calculates the spectral absorption coefficient kappa(x).\n        x_grid is expected to be a numpy array.\n        \"\"\"\n        # Ensure x_grid is a column vector to enable broadcasting against row vectors MU, A, SIGMA.\n        x_col = np.atleast_1d(x_grid)[:, np.newaxis]\n        \n        # Compute sum of Gaussians using broadcasting for efficiency.\n        # The expression `(x_col - MU)` broadcasts to a shape of (len(x_grid), 5).\n        # The sum is then performed along axis=1 to collapse the 5 Gaussian components.\n        gaussians = np.sum(A * np.exp(-((x_col - MU)**2) / (2 * SIGMA**2)), axis=1)\n        \n        return B + gaussians\n\n    # Pre-computation Step: Generate spectral grid and kappa values.\n    # Grid points x_j = (j - 0.5) / N for j = 1, ..., N.\n    x_j = (np.arange(1, N + 1) - 0.5) / N\n    kappa_vals = kappa(x_j)\n\n    # Pre-computation Step: Construct the k-distribution.\n    # The quantile function Q(g) is defined by the sorted kappa values\n    # against the cumulative probability coordinate g.\n    k_sorted = np.sort(kappa_vals)\n    # For a uniform spectral grid, the cumulative probability coordinates g_j are identical to x_j.\n    g_j = (np.arange(1, N + 1) - 0.5) / N\n    \n    results = []\n    for L, m in test_cases:\n        # Step 1: Compute the LbL reference transmissivity.\n        # This is the mean of the spectral transmissivity over the uniform grid.\n        transmissivity_lbl_spectral = np.exp(-kappa_vals * L)\n        mean_transmissivity_lbl = np.mean(transmissivity_lbl_spectral)\n\n        # Step 2: Compute the correlated-k transmissivity.\n        # Get Gauss-Legendre quadrature nodes (xi) and weights (w) for order m on [-1, 1].\n        xi_q_raw, w_q_raw = roots_legendre(m)\n        \n        # Affine mapping from [-1, 1] to [0, 1] for quadrature points and weights.\n        g_q = 0.5 * (xi_q_raw + 1.0)\n        w_q_g = 0.5 * w_q_raw\n        \n        # Evaluate the quantile function Q(g) at the quadrature points g_q\n        # by interpolating the pre-computed k-distribution (g_j, k_sorted).\n        k_q = np.interp(g_q, g_j, k_sorted)\n        \n        # Compute the correlated-k transmissivity as a weighted sum.\n        transmissivity_k_points = np.exp(-k_q * L)\n        mean_transmissivity_k = np.sum(w_q_g * transmissivity_k_points)\n        \n        # Step 3: Compute the relative error and store it.\n        relative_error = np.abs(mean_transmissivity_k - mean_transmissivity_lbl) / mean_transmissivity_lbl\n        results.append(relative_error)\n\n    # Format the final output as a single-line comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}