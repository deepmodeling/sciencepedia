{
    "hands_on_practices": [
        {
            "introduction": "在燃烧应用中，准确量化火焰的辐射热损失至关重要。本练习将辐射传递方程 (RTE) 的基本原理应用于一个实际场景：分析湍流扩散火焰中烟尘与气体对总辐射损失的相对贡献 ()。通过应用光学薄近似，您将推导出一种估算方法，并加深对普朗克平均吸收系数在简化辐射计算中作用的理解。",
            "id": "4056019",
            "problem": "考虑一个嵌入在湍流扩散火焰发光核心区的局部均匀控制体，其温度为 $T=1800\\,\\mathrm{K}$，压力为 $p=1\\,\\mathrm{atm}$。该介质由于烟尘和辐射活性气体的存在而是参与性介质。假设以下符合物理实际的条件和模型：\n\n- 辐射传输由描述发射和吸收的辐射传递方程（RTE）控制，且在该区域内，烟尘和气体的散射均可忽略不计。\n- 该区域是光学薄的，因此控制体内的再吸收和来自周围环境的入射辐照均可忽略不计；即，净辐射损失可以仅从局部发射来估算。\n- 烟尘被建模为处于 Rayleigh 极限下的小吸收颗粒。其 Planck 平均吸收系数由经过充分验证的表达式 $\\kappa_{P,\\text{soot}}=\\frac{3\\,E_P\\,f_v}{d_p}$ 表示，其中 $E_P$ 是给定温度下烟尘材料的 Planck 平均无量纲吸收函数，$f_v$ 是烟尘体积分数，$d_p$ 是一次颗粒直径。\n- 对于温度为 $T=1800\\,\\mathrm{K}$、代表性摩尔分数为 $x_{\\mathrm{H_2O}}=0.10$ 和 $x_{\\mathrm{CO_2}}=0.12$ 的产物气体混合物，高分辨率逐线建模式计算得出在 $p=1\\,\\mathrm{atm}$ 下的 Planck 平均吸收系数为 $\\kappa_{P,\\text{gas}}=0.40\\,\\mathrm{m}^{-1}$。\n- 在 $T=1800\\,\\mathrm{K}$ 时，Planck 平均烟尘吸收函数为 $E_P=0.28$，烟尘体积分数为 $f_v=2.0\\times 10^{-7}$，一次颗粒直径为 $d_p=35\\,\\mathrm{nm}$。\n\n从参与性介质中发射的基本定义和辐射传递方程（RTE）出发，利用光学薄近似，从第一性原理推导出一个表达式，用于计算可归因于烟尘的总单位体积辐射损失的分数。然后，使用给定数据对该分数进行数值评估。将最终答案表示为一个四舍五入到四位有效数字的无量纲小数。",
            "solution": "问题要求推导参与性介质中可归因于烟尘的总单位体积辐射损失分数的表达式，然后进行数值评估。\n\n**第一部分：理论推导**\n\n在一个吸收、发射且不散射的介质中，控制热辐射传输的基本方程是辐射传递方程（RTE）。沿着坐标为 $s$ 的路径，光谱强度 $I_\\lambda$ 的 RTE 为：\n$$\n\\frac{dI_\\lambda}{ds} = \\kappa_\\lambda I_{b\\lambda}(T) - \\kappa_\\lambda I_\\lambda\n$$\n此处，$\\kappa_\\lambda$ 是介质的光谱吸收系数，$I_{b\\lambda}(T)$ 是温度为 $T$ 的黑体的光谱强度（由 Planck 定律给出），等式右边的两项分别代表光谱发射和吸收。\n\n单位体积内通过辐射传递的净能量速率由辐射热通量矢量 $\\mathbf{q}_r$ 的散度 $\\nabla \\cdot \\mathbf{q}_r$ 给出。该量可以通过将 RTE 的源项对所有立体角（$4\\pi$ 球面度）和所有波长进行积分来表示：\n$$\n\\nabla \\cdot \\mathbf{q}_r = \\int_{0}^{\\infty} \\int_{4\\pi} (\\kappa_\\lambda I_{b\\lambda}(T) - \\kappa_\\lambda I_\\lambda) \\,d\\Omega \\,d\\lambda\n$$\n这可以改写为：\n$$\n\\nabla \\cdot \\mathbf{q}_r = \\int_{0}^{\\infty} \\kappa_\\lambda \\left( \\int_{4\\pi} I_{b\\lambda}(T) \\,d\\Omega - \\int_{4\\pi} I_\\lambda \\,d\\Omega \\right) d\\lambda\n$$\n由于黑体辐射是各向同性的，$I_{b\\lambda}(T)$ 与方向无关，因此 $\\int_{4\\pi} I_{b\\lambda}(T) \\,d\\Omega = 4\\pi I_{b\\lambda}(T)$。第二个积分定义了入射光谱辐照度，$G_\\lambda = \\int_{4\\pi} I_\\lambda \\,d\\Omega$。因此，\n$$\n\\nabla \\cdot \\mathbf{q}_r = \\int_{0}^{\\infty} \\kappa_\\lambda (4\\pi I_{b\\lambda}(T) - G_\\lambda) \\,d\\lambda\n$$\n问题指出介质是光学薄的，且来自周围环境的入射辐照可忽略不计。在光学薄近似下，介质发射的辐射在没有显著再吸收的情况下逸出。这一点，再加上可忽略的外部辐照，意味着局部辐射强度 $I_\\lambda$ 与黑体强度相比非常小，因此 $I_\\lambda \\approx 0$。因此，入射辐照度 $G_\\lambda$ 也近似为零。\n\n在此近似下，我们定义为 $q_{loss} = \\nabla \\cdot \\mathbf{q}_r$ 的单位体积辐射损失简化为单位体积发射率：\n$$\nq_{loss} \\approx \\int_{0}^{\\infty} 4\\pi \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda = 4\\pi \\int_{0}^{\\infty} \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda\n$$\n为了计算这个光谱积分，我们引入 Planck 平均吸收系数 $\\kappa_P$，其定义为由黑体强度分布加权的光谱平均吸收系数：\n$$\n\\kappa_P = \\frac{\\int_{0}^{\\infty} \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda}{\\int_{0}^{\\infty} I_{b\\lambda}(T) \\,d\\lambda}\n$$\n分母是总黑体强度，它通过 $\\int_{0}^{\\infty} I_{b\\lambda}(T) \\,d\\lambda = \\frac{\\sigma T^4}{\\pi}$ 与 Stefan-Boltzmann 常数 $\\sigma$ 相关。\n重新整理 $\\kappa_P$ 的定义，我们得到：\n$$\n\\int_{0}^{\\infty} \\kappa_\\lambda I_{b\\lambda}(T) \\,d\\lambda = \\kappa_P \\int_{0}^{\\infty} I_{b\\lambda}(T) \\,d\\lambda = \\kappa_P \\frac{\\sigma T^4}{\\pi}\n$$\n将此代回 $q_{loss}$ 的表达式中：\n$$\nq_{loss} = 4\\pi \\left( \\kappa_P \\frac{\\sigma T^4}{\\pi} \\right) = 4 \\kappa_P \\sigma T^4\n$$\n这是光学薄介质中总单位体积辐射损失的表达式。\n\n介质是烟尘和辐射活性气体的混合物。假设这些组分形成一个简单混合物，它们的光谱吸收系数是可加的：$\\kappa_\\lambda = \\kappa_{\\lambda, \\text{soot}} + \\kappa_{\\lambda, \\text{gas}}$。由于 $\\kappa_P$ 定义中积分的线性特性，总的 Planck 平均吸收系数是各个组分 Planck 平均系数之和：\n$$\n\\kappa_{P, \\text{total}} = \\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}\n$$\n因此，总单位体积辐射损失为：\n$$\nq_{loss, \\text{total}} = 4 \\kappa_{P, \\text{total}} \\sigma T^4 = 4 (\\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}) \\sigma T^4\n$$\n此损失中可归因于烟尘发射的部分仅由其自身的吸收系数决定：\n$$\nq_{loss, \\text{soot}} = 4 \\kappa_{P, \\text{soot}} \\sigma T^4\n$$\n可归因于烟尘的总单位体积辐射损失分数 $F_{\\text{soot}}$，是烟尘造成的损失与总损失之比：\n$$\nF_{\\text{soot}} = \\frac{q_{loss, \\text{soot}}}{q_{loss, \\text{total}}} = \\frac{4 \\kappa_{P, \\text{soot}} \\sigma T^4}{4 (\\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}) \\sigma T^4}\n$$\n项 $4$、$\\sigma$ 和 $T^4$ 被消去，得到最终的推导表达式：\n$$\nF_{\\text{soot}} = \\frac{\\kappa_{P, \\text{soot}}}{\\kappa_{P, \\text{soot}} + \\kappa_{P, \\text{gas}}}\n$$\n\n**第二部分：数值评估**\n\n我们已知气相的 Planck 平均吸收系数：\n$$\n\\kappa_{P, \\text{gas}} = 0.40\\,\\mathrm{m}^{-1}\n$$\n我们必须使用提供的模型和数据计算烟尘的 Planck 平均吸收系数：\n$$\n\\kappa_{P,\\text{soot}} = \\frac{3\\,E_P\\,f_v}{d_p}\n$$\n给定值为：\n- $E_P = 0.28$\n- $f_v = 2.0 \\times 10^{-7}$\n- $d_p = 35\\,\\mathrm{nm} = 35 \\times 10^{-9}\\,\\mathrm{m}$\n\n将这些值代入 $\\kappa_{P,\\text{soot}}$ 的表达式中：\n$$\n\\kappa_{P,\\text{soot}} = \\frac{3 \\times 0.28 \\times (2.0 \\times 10^{-7})}{35 \\times 10^{-9}\\,\\mathrm{m}} = \\frac{1.68 \\times 10^{-7}}{35 \\times 10^{-9}\\,\\mathrm{m}} = 4.8\\,\\mathrm{m}^{-1}\n$$\n现在我们可以通过代入吸收系数的数值来计算分数 $F_{\\text{soot}}$：\n$$\nF_{\\text{soot}} = \\frac{4.8\\,\\mathrm{m}^{-1}}{4.8\\,\\mathrm{m}^{-1} + 0.40\\,\\mathrm{m}^{-1}} = \\frac{4.8}{5.2}\n$$\n$$\nF_{\\text{soot}} = \\frac{48}{52} = \\frac{12}{13} \\approx 0.9230769...\n$$\n问题要求答案是一个四舍五入到四位有效数字的无量纲小数。将结果四舍五入得到：\n$$\nF_{\\text{soot}} = 0.9231\n$$\n这个结果表明，在给定条件下，烟尘约占该体积元总辐射能量损失的 $92.31\\%$。",
            "answer": "$$\\boxed{0.9231}$$"
        },
        {
            "introduction": "气体辐射通常具有高度复杂的光谱结构，逐线 (Line-by-Line, LbL) 计算虽然精确但计算成本极高。本实践旨在通过编程实现一种高效的气体辐射模型——相关k分布法 (correlated-k method) ()。您将为一个合成光谱计算其谱带平均透射率，并将其与精确的 LbL 参考值进行比较，从而亲身体验这种强大降阶模型的工作原理及其精度。",
            "id": "4056000",
            "problem": "考虑通过处于局部热力学平衡状态的均匀、等温、非散射气体平板的一维光谱辐射传输。从辐射传输方程 (RTE) 出发，对于在单一归一化光谱坐标 $x$ 上的准直光束，只有纯吸收，没有发射，其形式为：$$\\frac{d I(x,s)}{d s} = -\\kappa(x)\\, I(x,s),$$ 其中 $I(x,s)$ 是沿路径坐标 $s$ 的光谱强度，$\\kappa(x)$ 是光谱吸收系数。对于物理厚度为 $L$ 且 $\\kappa(x)$ 均匀的平板，解为 $$I(x,L) = I(x,0)\\,\\exp\\!\\left(-\\kappa(x)\\,L\\right).$$ 因此，$x$ 处的光谱透过率为 $$\\mathcal{T}(x;L) = \\exp\\!\\left(-\\kappa(x)\\,L\\right).$$ 在归一化波段 $x \\in [0,1]$ 上的带平均透过率为 $$\\overline{\\mathcal{T}}(L) = \\int_0^1 \\exp\\!\\left(-\\kappa(x)\\,L\\right)\\,dx.$$\n\n您需要使用两种方法计算带平均透过率，并量化它们之间的差异：\n- 通过在均匀光谱网格上进行显式求积计算的逐线 (LbL) 参考值。\n- 使用 k-分布和在累积概率域上进行求积的相关-k 近似。\n\n使用以下科学上一致的合成光谱作为吸收系数，其物理单位为逆长度（米的一次方）：\n$$\\kappa(x) = b + \\sum_{i=1}^{5} A_i \\exp\\!\\left(-\\frac{(x-\\mu_i)^2}{2\\,\\sigma_i^2}\\right),$$\n参数如下\n- 基线 $b = 0.2$ m$^{-1}$，\n- 谱线中心 $\\mu = [0.15,\\, 0.37,\\, 0.55,\\, 0.72,\\, 0.90]$ (无量纲)，\n- 谱线振幅 $A = [150.0,\\, 50.0,\\, 300.0,\\, 120.0,\\, 220.0]$ m$^{-1}$，\n- 谱线宽度 $\\sigma = [0.01,\\, 0.02,\\, 0.015,\\, 0.025,\\, 0.008]$ (无量纲)。\n\n对于 LbL 参考值，使用 $N$ 个点上的均匀黎曼和来近似带平均透过率：\n$$\\overline{\\mathcal{T}}_{\\text{LbL}}(L) \\approx \\frac{1}{N}\\sum_{j=1}^{N} \\exp\\!\\left(-\\kappa(x_j)\\,L\\right), \\quad x_j = \\frac{j-\\tfrac{1}{2}}{N},$$\n其中 $N = 4096$。\n\n对于相关-k 近似，通过对集合 $\\{\\kappa(x_j)\\}_{j=1}^N$ 进行排序以获得一个非递减序列 $\\{k_{(j)}\\}_{j=1}^N$ 来构建经验 k-分布，并定义经验累积概率坐标 $$g_j = \\frac{j-\\tfrac{1}{2}}{N}, \\quad j=1,\\dots,N.$$ 令 $Q(g)$ 表示经验分位数函数，它通过对点对 $(g_j, k_{(j)})$ 进行线性插值，将 $g \\in [0,1]$ 映射到 $k$。使用在 $[0,1]$ 上的 $m$ 阶高斯-勒让德求积来近似相关-k 透过率：\n$$\\overline{\\mathcal{T}}_{k}(L; m) \\approx \\sum_{q=1}^{m} w_q^{(g)} \\exp\\!\\left(-Q(g_q)\\,L\\right),$$\n其中 $\\{g_q, w_q^{(g)}\\}_{q=1}^m$ 是通过从 $[-1,1]$ 进行仿射映射得到的在 $[0,1]$ 上的高斯-勒让德横坐标和权重。\n\n对于每个测试用例，使用 LbL 值作为参考计算相对误差：\n$$\\varepsilon_{\\text{rel}} = \\frac{\\left|\\overline{\\mathcal{T}}_{k}(L; m) - \\overline{\\mathcal{T}}_{\\text{LbL}}(L)\\right|}{\\overline{\\mathcal{T}}_{\\text{LbL}}(L)}.$$\n\n您的程序必须精确实现上述定义，并为以下 $(L, m)$ 对的测试套件生成相对误差，其中 $L$ 的单位是米， $m$ 是无量纲的：\n- $(L, m) = (0.01, 4)$,\n- $(L, m) = (0.01, 12)$,\n- $(L, m) = (1.0, 4)$,\n- $(L, m) = (1.0, 12)$,\n- $(L, m) = (10.0, 4)$,\n- $(L, m) = (10.0, 12)$.\n\n要求和交付成果：\n- 使用 $N = 4096$ 个光谱点用于 LbL 参考和构建经验 k-分布。\n- 按照规定，在 $[0,1]$ 上使用 $m$ 阶高斯-勒让德求积来计算相关-k 积分。\n- 将带平均透过率表示为无量纲量。吸收系数 $\\kappa$ 的单位是 m$^{-1}$，平板厚度 $L$ 的单位是 m。\n- 对于每个测试用例，将 $\\varepsilon_{\\text{rel}}$ 计算为浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，$[r_1,r_2,\\dots,r_6]$），其中 $r_i$ 是上面列出的第 $i$ 个测试用例的相对误差，顺序相同。不应打印其他任何文本。",
            "solution": "该问题在科学和数学上是适定的，提供了一套完整且一致的定义和数据。这是辐射传热领域的一个标准数值练习，具体涉及高分辨率逐线 (LbL) 计算与计算高效的相关-k 模型之间的比较。所有必要的参数和步骤都已明确定义，从而可以进行直接且无歧义的实现。因此，该问题是有效的，下面提供了解决方案。\n\n核心任务是计算厚度为 $L$ 的均匀气体平板的带平均透过率 $\\overline{\\mathcal{T}}(L)$。该量定义为光谱透过率 $\\mathcal{T}(x;L)$ 在归一化光谱波段 $x \\in [0,1]$ 上的积分：\n$$\n\\overline{\\mathcal{T}}(L) = \\int_0^1 \\mathcal{T}(x;L)\\,dx = \\int_0^1 \\exp\\!\\left(-\\kappa(x)\\,L\\right)\\,dx\n$$\n这里，$\\kappa(x)$ 是光谱吸收系数，由一个基线和五个代表光谱线的高斯函数之和给出。解决方案的步骤是实现两种指定的数值方法来近似该积分，然后计算它们的相对差异。\n\n计算过程如下：\n\n1.  **光谱离散化与求值**：\n    首先，我们根据问题陈述定义吸收系数 $\\kappa(x)$ 的函数：\n    $$\n    \\kappa(x) = b + \\sum_{i=1}^{5} A_i \\exp\\!\\left(-\\frac{(x-\\mu_i)^2}{2\\,\\sigma_i^2}\\right)\n    $$\n    使用给定的 $b$、$A_i$、$\\mu_i$ 和 $\\sigma_i$ 参数。然后，我们创建一个包含 $N=4096$ 个点的均匀光谱网格 $\\{x_j\\}$，其中 $x_j = (j-0.5)/N$，对于 $j=1, \\dots, N$。在每个点上计算吸收系数，以获得离散光谱 $\\{\\kappa(x_j)\\}$。\n\n2.  **逐线 (LbL) 参考计算**：\n    带平均透过率的 LbL 近似值作为高保真参考。它是通过在 $N$ 个光谱点上使用均匀黎曼和计算的：\n    $$\n    \\overline{\\mathcal{T}}_{\\text{LbL}}(L) = \\frac{1}{N}\\sum_{j=1}^{N} \\exp\\!\\left(-\\kappa(x_j)\\,L\\right)\n    $$\n    对于给定的路径长度 $L$，首先计算每个点 $x_j$ 的光谱透过率 $\\exp(-\\kappa(x_j)L)$，然后取这些值的算术平均值。\n\n3.  **相关-k 分布构建**：\n    相关-k 方法将对光谱坐标 $x$ 的积分重新表述为对累积概率坐标 $g$ 的积分。这是通过对光谱吸收系数进行重排序来实现的。将 $N$ 个值组成的集合 $\\{\\kappa(x_j)\\}$ 按非递减顺序排序，得到序列 $\\{k_{(j)}\\}$。将此排序后的序列与累积坐标 $g_j = (j-0.5)/N$ 对应绘制，便构成了经验 k-分布。问题定义了一个分位数函数 $Q(g)$，它将 $g \\in [0,1]$ 映射到吸收系数 $k$。该函数通过对离散数据点 $(g_j, k_{(j)})$ 进行线性插值来构建。\n\n4.  **相关-k 透过率计算**：\n    通过重排序，带平均透过率积分被转换为：\n    $$\n    \\overline{\\mathcal{T}}(L) = \\int_0^1 \\exp\\!\\left(-\\kappa(x)\\,L\\right)\\,dx = \\int_0^1 \\exp\\!\\left(-Q(g)\\,L\\right)\\,dg\n    $$\n    这个新积分使用在域 $g \\in [0,1]$ 上的 $m$ 点高斯-勒让德求积进行计算。标准的高斯-勒让德求积节点 $\\{\\xi_q\\}$ 和权重 $\\{w_q^{(\\xi)}\\}$ 定义在 $[-1,1]$ 上。它们通过仿射变换映射到区间 $[0,1]$：\n    $$\n    g_q = \\frac{1}{2}(\\xi_q + 1), \\quad w_q^{(g)} = \\frac{1}{2}w_q^{(\\xi)}\n    $$\n    相关-k 透过率随后通过以下求和来近似：\n    $$\n    \\overline{\\mathcal{T}}_{k}(L; m) \\approx \\sum_{q=1}^{m} w_q^{(g)} \\exp\\!\\left(-Q(g_q)\\,L\\right)\n    $$\n    对于每个求积点 $g_q$，通过对上一步构建的经验 k-分布进行插值，找到相应的值 $Q(g_q)$。\n\n5.  **相对误差计算**：\n    对于每个测试用例对 $(L, m)$，相关-k 近似相对于 LbL 参考的相对误差 $\\varepsilon_{\\text{rel}}$ 计算如下：\n    $$\n    \\varepsilon_{\\text{rel}} = \\frac{\\left|\\overline{\\mathcal{T}}_{k}(L; m) - \\overline{\\mathcal{T}}_{\\text{LbL}}(L)\\right|}{\\overline{\\mathcal{T}}_{\\text{LbL}}(L)}\n    $$\n    对所有六个指定的 $(L, m)$ 对执行此过程，并将得到的相对误差收集并格式化以备最终输出。该实现使用 `numpy` 进行高效的数组操作，并使用 `scipy.special.roots_legendre` 获取高斯-勒让德求积的节点和权重。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes the relative error between LbL and correlated-k models for band-mean\n    transmissivity for a suite of test cases.\n    \"\"\"\n    # Define constants for the absorption coefficient model from the problem statement.\n    B = 0.2  # m^-1\n    MU = np.array([0.15, 0.37, 0.55, 0.72, 0.90])\n    A = np.array([150.0, 50.0, 300.0, 120.0, 220.0])  # m^-1\n    SIGMA = np.array([0.01, 0.02, 0.015, 0.025, 0.008])\n    N = 4096\n\n    # Define the test cases (L, m)\n    test_cases = [\n        (0.01, 4),\n        (0.01, 12),\n        (1.0, 4),\n        (1.0, 12),\n        (10.0, 4),\n        (10.0, 12),\n    ]\n\n    def kappa(x_grid):\n        \"\"\"\n        Calculates the spectral absorption coefficient kappa(x).\n        x_grid is expected to be a numpy array.\n        \"\"\"\n        # Ensure x_grid is a column vector to enable broadcasting against row vectors MU, A, SIGMA.\n        x_col = np.atleast_1d(x_grid)[:, np.newaxis]\n        \n        # Compute sum of Gaussians using broadcasting for efficiency.\n        # The expression `(x_col - MU)` broadcasts to a shape of (len(x_grid), 5).\n        # The sum is then performed along axis=1 to collapse the 5 Gaussian components.\n        gaussians = np.sum(A * np.exp(-((x_col - MU)**2) / (2 * SIGMA**2)), axis=1)\n        \n        return B + gaussians\n\n    # Pre-computation Step: Generate spectral grid and kappa values.\n    # Grid points x_j = (j - 0.5) / N for j = 1, ..., N.\n    x_j = (np.arange(1, N + 1) - 0.5) / N\n    kappa_vals = kappa(x_j)\n\n    # Pre-computation Step: Construct the k-distribution.\n    # The quantile function Q(g) is defined by the sorted kappa values\n    # against the cumulative probability coordinate g.\n    k_sorted = np.sort(kappa_vals)\n    # For a uniform spectral grid, the cumulative probability coordinates g_j are identical to x_j.\n    g_j = (np.arange(1, N + 1) - 0.5) / N\n    \n    results = []\n    for L, m in test_cases:\n        # Step 1: Compute the LbL reference transmissivity.\n        # This is the mean of the spectral transmissivity over the uniform grid.\n        transmissivity_lbl_spectral = np.exp(-kappa_vals * L)\n        mean_transmissivity_lbl = np.mean(transmissivity_lbl_spectral)\n\n        # Step 2: Compute the correlated-k transmissivity.\n        # Get Gauss-Legendre quadrature nodes (xi) and weights (w) for order m on [-1, 1].\n        xi_q_raw, w_q_raw = roots_legendre(m)\n        \n        # Affine mapping from [-1, 1] to [0, 1] for quadrature points and weights.\n        g_q = 0.5 * (xi_q_raw + 1.0)\n        w_q_g = 0.5 * w_q_raw\n        \n        # Evaluate the quantile function Q(g) at the quadrature points g_q\n        # by interpolating the pre-computed k-distribution (g_j, k_sorted).\n        k_q = np.interp(g_q, g_j, k_sorted)\n        \n        # Compute the correlated-k transmissivity as a weighted sum.\n        transmissivity_k_points = np.exp(-k_q * L)\n        mean_transmissivity_k = np.sum(w_q_g * transmissivity_k_points)\n        \n        # Step 3: Compute the relative error and store it.\n        relative_error = np.abs(mean_transmissivity_k - mean_transmissivity_lbl) / mean_transmissivity_lbl\n        results.append(relative_error)\n\n    # Format the final output as a single-line comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "尽管灰气体模型因其简单性而具有吸引力，但在许多实际情况下，它会引入巨大的误差，尤其是在气体和壁面的光谱特性存在相关性时。本练习通过构建一个思想实验，旨在揭示这种简化的潜在缺陷 ()。您将推导并比较窄带模型和灰气体模型在一个特殊场景下的壁面吸收热流，从而定量地理解为何必须谨慎使用灰气体近似。",
            "id": "4056074",
            "problem": "考虑一个平面平行、等温的燃烧气体层，其厚度为 $L = 0.05 \\ \\text{m}$，均匀温度为 $T_{g} = 1800 \\ \\text{K}$。该气体层下界为位于 $z = 0$ 处的不透明壁面，另一侧则通向一个冷的、不发射辐射的环境。该气体是以二氧化碳和水蒸气为主的混合物，处于局部热力学平衡（LTE）状态，无散射，折射率近似为1，且为光学薄层，即对于所有波数 $\\tilde{\\nu}$，均满足 $k_{\\tilde{\\nu}} L \\ll 1$。\n\n在参与介质中，方向光谱强度 $I_{\\tilde{\\nu}}(z, \\mu)$ 满足辐射传输方程（RTE）：\n$$\n\\mu \\frac{\\partial I_{\\tilde{\\nu}}}{\\partial z} = -k_{\\tilde{\\nu}} I_{\\tilde{\\nu}} + k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}),\n$$\n其中 $\\mu = \\cos\\theta$ 是方向余弦，$k_{\\tilde{\\nu}}$ 是光谱吸收系数，$I_{b,\\tilde{\\nu}}(T_{g})$ 是温度为 $T_{g}$ 时的黑体光谱强度。假设在此条件下，壁面的发射与气体的发射相比可以忽略不计。\n\n将光谱划分为两个不相交的集合：\n- 一个谱线主导集 $\\mathcal{S}_{\\ell}$，覆盖中心在 $2000$–$2400 \\ \\text{cm}^{-1}$ 和 $3000$–$4000 \\ \\text{cm}^{-1}$ 范围内的强吸收带，在这些带内有效吸收系数为 $k_{\\ell} = 0.40 \\ \\text{m}^{-1}$，壁面光谱吸收率为 $\\alpha_{\\ell} = 0.05$。\n- 一个互补的背景集 $\\mathcal{S}_{b}$，包含光谱的其余部分，其 $k_{b} = 0.0010 \\ \\text{m}^{-1}$，壁面光谱吸收率为 $\\alpha_{b} = 0.90$。\n\n在 $T_{g} = 1800 \\ \\text{K}$ 时，令 $f_{\\ell} = 0.28$ 和 $f_{b} = 0.72$ 分别表示在 $\\mathcal{S}_{\\ell}$ 和 $\\mathcal{S}_{b}$ 内所包含的半球黑体发射功率的分数，因此 $f_{\\ell} + f_{b} = 1$。使用总半球黑体发射功率的恒等式 $E_{b}(T_{g}) = \\sigma T_{g}^{4}$，其中 $\\sigma = 5.670374419 \\times 10^{-8} \\ \\text{W} \\ \\text{m}^{-2} \\ \\text{K}^{-4}$。\n\n从辐射传输方程和光学薄极限出发，推导由以下模型预测的壁面吸收辐射热通量：\n1. 尊重光谱划分 $\\{\\mathcal{S}_{\\ell}, \\mathcal{S}_{b}\\}$ 的窄带模型。\n2. 使用普朗克平均吸收系数 $k_{P}(T_{g})$ 和普朗克加权壁面吸收率 $\\alpha_{P}$ 的灰体气体模型，定义如下：\n$$\nk_{P}(T_{g}) = \\frac{\\int_{0}^{\\infty} k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}, \n\\quad \n\\alpha_{P} = \\frac{\\int_{0}^{\\infty} \\alpha_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}.\n$$\n\n然后，计算无量纲比值\n$$\nR = \\frac{F_{\\text{abs}}^{\\text{gray}}}{F_{\\text{abs}}^{\\text{NB}}}\n$$\n即灰体模型预测的吸收通量 $F_{\\text{abs}}^{\\text{gray}}$ 与窄带模型吸收通量 $F_{\\text{abs}}^{\\text{NB}}$ 之比，使用给定的数据。将最终比值四舍五入至四位有效数字。以无量纲数的形式表示最终答案。",
            "solution": "用户要求我按照指定的步骤和格式解决问题。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n\n问题陈述中的逐字已知条件如下：\n-   一个厚度为 $L = 0.05 \\ \\text{m}$ 的平面平行、等温燃烧气体层。\n-   均匀气体温度 $T_{g} = 1800 \\ \\text{K}$。\n-   该层下界为位于 $z = 0$ 处的不透明壁面，另一侧（$z=L$）通向一个冷的、不发射辐射的环境。\n-   该气体是处于局部热力学平衡（LTE）状态、无散射、折射率近似为1的混合物。\n-   该气体为光学薄层：对于所有波数 $\\tilde{\\nu}$，均满足 $k_{\\tilde{\\nu}} L \\ll 1$。\n-   给出的辐射传输方程（RTE）为：$\\mu \\frac{\\partial I_{\\tilde{\\nu}}}{\\partial z} = -k_{\\tilde{\\nu}} I_{\\tilde{\\nu}} + k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g})$。\n-   $\\mu = \\cos\\theta$ 是方向余弦。\n-   $k_{\\tilde{\\nu}}$ 是光谱吸收系数。\n-   $I_{b,\\tilde{\\nu}}(T_{g})$ 是温度为 $T_{g}$ 时的黑体光谱强度。\n-   壁面的发射可忽略不计。\n-   光谱被划分为两个不相交的集合：\n    -   谱线主导集 $\\mathcal{S}_{\\ell}$（强吸收带）：$k_{\\ell} = 0.40 \\ \\text{m}^{-1}$，壁面光谱吸收率 $\\alpha_{\\ell} = 0.05$。\n    -   背景集 $\\mathcal{S}_{b}$（互补集）：$k_{b} = 0.0010 \\ \\text{m}^{-1}$，壁面光谱吸收率 $\\alpha_{b} = 0.90$。\n-   在 $T_{g} = 1800 \\ \\text{K}$ 时的半球黑体发射功率分数：$f_{\\ell} = 0.28$ 和 $f_{b} = 0.72$。\n-   总半球黑体发射功率的恒等式：$E_{b}(T_{g}) = \\sigma T_{g}^{4}$。\n-   斯蒂芬-玻尔兹曼常数：$\\sigma = 5.670374419 \\times 10^{-8} \\ \\text{W} \\ \\text{m}^{-2} \\ \\text{K}^{-4}$。\n-   普朗克平均吸收系数的定义：$k_{P}(T_{g}) = \\frac{\\int_{0}^{\\infty} k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}$。\n-   普朗克加权壁面吸收率的定义：$\\alpha_{P} = \\frac{\\int_{0}^{\\infty} \\alpha_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}}(T_{g}) \\, d\\tilde{\\nu}}$。\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于辐射传热的基本原理，特别是参与介质中的辐射传输方程。物理场景（热气体层）和简化（平面平行、等温、无散射、光学薄）是热科学和燃烧领域的标准做法。\n-   **适定性**：该问题提供了明确的目标（计算两种不同模型预测的吸收通量之比），充分的边界条件（一个不透明壁面和一个冷的开放边界），以及所有必要的物理参数（双带模型的 $L, T_g, k_{\\tilde{\\nu}}, \\alpha_{\\tilde{\\nu}}$）。灰体模型参数（$k_P, \\alpha_P$）的定义是标准的。任务定义明确，可以得出唯一解。\n-   **客观性**：问题以精确、定量的术语陈述。没有主观或含糊不清的陈述。\n-   **完整性与一致性**：问题是自洽的。黑体分数之和 $f_{\\ell} + f_{b} = 0.28 + 0.72 = 1.0$，这具有一致性。给定的数据足以执行所有要求的计算。\n\n该问题没有表现出问题验证清单中列出的任何缺陷。满足有效问题的所有标准。\n\n#### 步骤 3：结论与行动\n问题是有效的。开始进行求解。\n\n### 求解过程\n\n任务是推导窄带模型和灰体气体模型下壁面（$z=0$）吸收的辐射热通量，然后计算它们的比值。\n\n首先，我们求解入射到 $z=0$ 处壁面上的方向光谱强度 $I_{\\tilde{\\nu}}(z, \\mu)$。这些是沿 $\\mu  0$ 方向传播的射线。RTE可以写成：\n$$\n\\mu \\frac{d I_{\\tilde{\\nu}}}{dz} = k_{\\tilde{\\nu}} (I_{b,\\tilde{\\nu}}(T_g) - I_{\\tilde{\\nu}})\n$$\n从边界 $z'$ 出发到达位置 $z$ 的强度的形式解为：\n$$\nI_{\\tilde{\\nu}}(z, \\mu) = I_{\\tilde{\\nu}}(z', \\mu) \\exp\\left(-\\frac{k_{\\tilde{\\nu}}(z-z')}{\\mu}\\right) + I_{b,\\tilde{\\nu}}(T_g) \\left(1 - \\exp\\left(-\\frac{k_{\\tilde{\\nu}}(z-z')}{\\mu}\\right)\\right)\n$$\n对于在方向 $\\mu  0$ 上入射到 $z=0$ 处壁面的射线，其路径始于上边界 $z=L$。问题陈述该边界通向一个冷的、不发射辐射的环境，因此该边界的入射强度为零：$I_{\\tilde{\\nu}}(L, \\mu  0) = 0$。在解中设 $z=0$ 和 $z'=L$：\n$$\nI_{\\tilde{\\nu}}(0, \\mu) = I_{\\tilde{\\nu}}(L, \\mu) \\exp\\left(\\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right) + I_{b,\\tilde{\\nu}}(T_g) \\left(1 - \\exp\\left(\\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right)\\right) = I_{b,\\tilde{\\nu}}(T_g) \\left(1 - \\exp\\left(\\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right)\\right)\n$$\n问题指定了光学薄极限 $k_{\\tilde{\\nu}}L \\ll 1$。由于 $\\mu$ 在 $[-1, 0)$ 范围内，指数的参数 $\\frac{k_{\\tilde{\\nu}}L}{\\mu}$ 的量级也很小（掠射角 $\\mu \\to 0$ 除外）。对小量 $x$ 使用泰勒级数展开 $\\exp(x) \\approx 1+x$：\n$$\nI_{\\tilde{\\nu}}(0, \\mu) \\approx I_{b,\\tilde{\\nu}}(T_g) \\left(1 - \\left(1 + \\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right)\\right) = -I_{b,\\tilde{\\nu}}(T_g) \\frac{k_{\\tilde{\\nu}}L}{\\mu}\n$$\n入射到壁面上的光谱辐射热通量通过将强度在入射半球上积分得到：\n$$\nF_{\\text{in},\\tilde{\\nu}} = \\int_{2\\pi, \\mu0} I_{\\tilde{\\nu}}(0, \\mu) |\\mu| d\\Omega = \\int_{0}^{2\\pi} d\\phi \\int_{-1}^{0} I_{\\tilde{\\nu}}(0, \\mu) (-\\mu) d\\mu\n$$\n代入 $I_{\\tilde{\\nu}}(0, \\mu)$ 的表达式：\n$$\nF_{\\text{in},\\tilde{\\nu}} = 2\\pi \\int_{-1}^{0} \\left(-I_{b,\\tilde{\\nu}}(T_g) \\frac{k_{\\tilde{\\nu}}L}{\\mu}\\right) (-\\mu) d\\mu = 2\\pi \\int_{-1}^{0} I_{b,\\tilde{\\nu}}(T_g) k_{\\tilde{\\nu}}L d\\mu\n$$\n$$\nF_{\\text{in},\\tilde{\\nu}} = 2\\pi I_{b,\\tilde{\\nu}}(T_g) k_{\\tilde{\\nu}}L\n$$\n壁面吸收的光谱热通量为 $F_{\\text{abs},\\tilde{\\nu}} = \\alpha_{\\tilde{\\nu}} F_{\\text{in},\\tilde{\\nu}} = 2\\pi \\alpha_{\\tilde{\\nu}} k_{\\tilde{\\nu}} L I_{b,\\tilde{\\nu}}(T_g)$。\n\n**1. 窄带（NB）吸收通量**\n窄带模型的总吸收通量 $F_{\\text{abs}}^{\\text{NB}}$ 是光谱吸收通量在所有波数上的积分。使用给定的双带光谱划分：\n$$\nF_{\\text{abs}}^{\\text{NB}} = \\int_0^\\infty F_{\\text{abs},\\tilde{\\nu}} d\\tilde{\\nu} = \\int_{\\mathcal{S}_{\\ell}} 2\\pi \\alpha_{\\ell} k_{\\ell} L I_{b,\\tilde{\\nu}}(T_g) d\\tilde{\\nu} + \\int_{\\mathcal{S}_{b}} 2\\pi \\alpha_{b} k_{b} L I_{b,\\tilde{\\nu}}(T_g) d\\tilde{\\nu}\n$$\n由于每个带内的性质是常数，我们可以将它们从积分中提出来：\n$$\nF_{\\text{abs}}^{\\text{NB}} = 2\\pi L \\left( \\alpha_{\\ell} k_{\\ell} \\int_{\\mathcal{S}_{\\ell}} I_{b,\\tilde{\\nu}}(T_g) d\\tilde{\\nu} + \\alpha_{b} k_{b} \\int_{\\mathcal{S}_{b}} I_{b,\\tilde{\\nu}}(T_g) d\\tilde{\\nu} \\right)\n$$\n黑体强度在整个光谱上的积分与半球黑体发射功率 $E_b(T_g) = \\sigma T_g^4$ 相关，关系式为 $\\int_0^\\infty \\pi I_{b,\\tilde{\\nu}} d\\tilde{\\nu} = E_b(T_g)$，这意味着 $\\int_0^\\infty I_{b,\\tilde{\\nu}} d\\tilde{\\nu} = \\frac{\\sigma T_g^4}{\\pi}$。分数 $f_{\\ell}$ 和 $f_b$ 的定义使得 $\\int_{\\mathcal{S}_i} I_{b,\\tilde{\\nu}} d\\tilde{\\nu} = f_i \\int_0^\\infty I_{b,\\tilde{\\nu}} d\\tilde{\\nu} = f_i \\frac{\\sigma T_g^4}{\\pi}$，其中 $i \\in \\{\\ell, b\\}$。\n将此代入 $F_{\\text{abs}}^{\\text{NB}}$ 的表达式中：\n$$\nF_{\\text{abs}}^{\\text{NB}} = 2\\pi L \\left( \\alpha_{\\ell} k_{\\ell} f_{\\ell} \\frac{\\sigma T_g^4}{\\pi} + \\alpha_{b} k_{b} f_{b} \\frac{\\sigma T_g^4}{\\pi} \\right)\n$$\n$$\nF_{\\text{abs}}^{\\text{NB}} = 2 L \\sigma T_g^4 (\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b})\n$$\n\n**2. 灰体气体模型吸收通量**\n对于灰体气体模型，假定气体具有单一的有效吸收系数 $k_P$，壁面具有有效的吸收率 $\\alpha_P$。吸收通量的推导与光谱情况类似，但使用灰体性质。来自灰体气体的入射通量为：\n$$\nF_{\\text{in}}^{\\text{gray}} = 2\\pi I_b(T_g) k_P L\n$$\n其中 $I_b(T_g) = \\int_0^\\infty I_{b,\\tilde{\\nu}}(T_g) d\\tilde{\\nu} = \\frac{\\sigma T_g^4}{\\pi}$。\n$$\nF_{\\text{in}}^{\\text{gray}} = 2\\pi \\left(\\frac{\\sigma T_g^4}{\\pi}\\right) k_P L = 2 \\sigma T_g^4 k_P L\n$$\n吸收通量是该入射通量乘以灰体壁面吸收率 $\\alpha_P$：\n$$\nF_{\\text{abs}}^{\\text{gray}} = \\alpha_P F_{\\text{in}}^{\\text{gray}} = 2 \\alpha_P k_P L \\sigma T_g^4\n$$\n现在，我们必须使用它们的定义和双带模型来评估普朗克平均性质 $k_P$ 和 $\\alpha_P$。\n$$\nk_P = \\frac{\\int_{0}^{\\infty} k_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}} = \\frac{k_{\\ell} \\int_{\\mathcal{S}_{\\ell}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu} + k_{b} \\int_{\\mathcal{S}_{b}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}} = \\frac{k_{\\ell} f_{\\ell} \\int I_{b,\\tilde{\\nu}} d\\tilde{\\nu} + k_{b} f_{b} \\int I_{b,\\tilde{\\nu}} d\\tilde{\\nu}}{\\int I_{b,\\tilde{\\nu}} d\\tilde{\\nu}} = k_{\\ell} f_{\\ell} + k_{b} f_{b}\n$$\n壁面吸收率也类似：\n$$\n\\alpha_P = \\frac{\\int_{0}^{\\infty} \\alpha_{\\tilde{\\nu}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}} = \\frac{\\alpha_{\\ell} \\int_{\\mathcal{S}_{\\ell}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu} + \\alpha_{b} \\int_{\\mathcal{S}_{b}} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}}{\\int_{0}^{\\infty} I_{b,\\tilde{\\nu}} d\\tilde{\\nu}} = \\alpha_{\\ell} f_{\\ell} + \\alpha_{b} f_{b}\n$$\n\n**3. 通量之比**\n无量纲比值 $R$ 定义为 $R = \\frac{F_{\\text{abs}}^{\\text{gray}}}{F_{\\text{abs}}^{\\text{NB}}}$。\n$$\nR = \\frac{2 \\alpha_P k_P L \\sigma T_g^4}{2 L \\sigma T_g^4 (\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b})} = \\frac{\\alpha_P k_P}{\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b}}\n$$\n代入 $\\alpha_P$ 和 $k_P$ 的表达式：\n$$\nR = \\frac{(\\alpha_{\\ell} f_{\\ell} + \\alpha_{b} f_{b})(k_{\\ell} f_{\\ell} + k_{b} f_{b})}{\\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b}}\n$$\n现在，我们代入数值：\n-   $k_{\\ell} = 0.40 \\ \\text{m}^{-1}$\n-   $\\alpha_{\\ell} = 0.05$\n-   $f_{\\ell} = 0.28$\n-   $k_{b} = 0.0010 \\ \\text{m}^{-1}$\n-   $\\alpha_{b} = 0.90$\n-   $f_{b} = 0.72$\n\n首先，计算普朗克平均性质 $\\alpha_P$ 和 $k_P$：\n$$\n\\alpha_P = (0.05)(0.28) + (0.90)(0.72) = 0.014 + 0.648 = 0.662\n$$\n$$\nk_P = (0.40)(0.28) + (0.0010)(0.72) = 0.112 + 0.00072 = 0.11272 \\ \\text{m}^{-1}\n$$\n比值 $R$ 的分子是 $\\alpha_P$ 和 $k_P$ 的乘积：\n$$\n\\text{分子} = \\alpha_P k_P = (0.662)(0.11272) = 0.07462064\n$$\n分母是在窄带模型中计算的光谱相关项：\n$$\n\\text{分母} = \\alpha_{\\ell} k_{\\ell} f_{\\ell} + \\alpha_{b} k_{b} f_{b} = (0.05)(0.40)(0.28) + (0.90)(0.0010)(0.72)\n$$\n$$\n\\text{分母} = (0.02)(0.28) + (0.0009)(0.72) = 0.0056 + 0.000648 = 0.006248\n$$\n最后，计算比值 $R$：\n$$\nR = \\frac{0.07462064}{0.006248} \\approx 11.943124\n$$\n四舍五入至四位有效数字，比值为 $11.94$。比值远大于1（$R > 1$）表明，在这种情况下，灰体气体模型是一个很差的近似，这是由于气体的光谱吸收系数与壁面的光谱吸收率之间存在强烈的负相关性。",
            "answer": "$$\n\\boxed{11.94}\n$$"
        }
    ]
}