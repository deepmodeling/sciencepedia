{
    "hands_on_practices": [
        {
            "introduction": "掌握辐射与流体流动及燃烧耦合的第一步是深刻理解辐射传递方程（RTE）。本练习将指导你从基本物理原理出发，推导在一个理想化的（均匀、灰色、非散射）燃烧产物平板中RTE的解析解。通过这个推导，你将对辐射强度如何在一个参与介质中因吸收而衰减，并因自身热发射而增强建立起核心的数学和物理直觉。",
            "id": "4015145",
            "problem": "考虑一个厚度为 $L$、温度恒为 $T$、均匀灰体吸收系数为 $\\kappa$ 的一维、平面平行、均匀的燃烧板。该板代表了一个处于局部热力学平衡状态的由燃烧产生的参与介质（例如，一个充满烟炱的火焰区）。不存在散射。您关心的是离开该板冷边界的辐射强度。设坐标 $x$ 从冷边界 $x=0$ 延伸至另一侧边界 $x=L$。对于一条以相对于板法线（与 $+x$ 方向对齐）的角度 $\\theta$ 离开冷边界的射线，定义方向余弦的大小为 $\\mu = |\\cos\\theta| \\in (0,1]$。在热边界 $x=L$ 处，沿该射线朝向冷边界的入射边界强度被指定为 $I_{\\text{in}}(\\mu)$ 并且是有限的。在冷边界之外，环境不发射辐射，也不向板内贡献入射辐射。\n\n仅从沿射线的辐射能量守恒、无散射介质的辐射传输方程定义以及局部热力学平衡下的基尔霍夫热辐射定律出发，推导在指定射线上冷边界处的出射强度的形式解。在光谱平均（灰体）近似下进行推导，并使用单位立体角内的频率积分黑体强度 $B(T) = \\sigma T^{4}/\\pi$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。将您的最终答案表示为出射强度 $I_{\\text{e}}(\\mu)$ 的单个闭式解析表达式，单位为 $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}$，并作为 $\\mu$、$\\kappa$、$L$、$T$ 和 $I_{\\text{in}}(\\mu)$ 的函数。不需要进行数值计算。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 第一步：提取已知条件\n-   **系统**：一维、平面平行、均匀的燃烧板。\n-   **厚度**：$L$。\n-   **温度**：恒定， $T$。\n-   **吸收系数**：均匀且灰体， $\\kappa$。\n-   **热力学状态**：局部热力学平衡 (LTE)。\n-   **散射**：无散射。\n-   **坐标系**：$x$ 从冷边界 $x=0$ 指向热边界 $x=L$。板的法线与 $+x$ 方向对齐。\n-   **射线方向**：由方向余弦的大小 $\\mu = |\\cos\\theta| \\in (0,1]$ 定义，其中 $\\theta$ 是相对于 $+x$ 方向的角度。求解的是离开冷边界的射线。\n-   **$x=L$ 处的边界条件**：指向冷边界的入射强度是给定的有限函数 $I_{\\text{in}}(\\mu)$。\n-   **$x=0$ 处的边界条件**：板外部的环境不发射辐射，不提供入射辐射。\n-   **基本原理**：推导必须从沿射线的辐射能量守恒、无散射介质的辐射传输方程 (RTE) 定义以及局部热力学平衡 (LTE) 下的基尔霍夫热辐射定律出发。\n-   **近似**：光谱平均（灰体）。\n-   **黑体强度**：频率积分的黑体强度由 $B(T) = \\frac{\\sigma T^{4}}{\\pi}$ 给出，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n-   **目标**：推导在冷边界处的出射强度 $I_{\\text{e}}(\\mu)$ 的形式解。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据**：该问题是辐射传热学中一个经典且基础的练习。它基于公认的物理原理：辐射传输方程、基尔霍夫定律和斯特藩-玻尔兹曼定律。所做的假设（一维、灰体、均匀、无散射介质、局部热力学平衡）是该领域建立基础理解时使用的标准理想化模型。该问题在科学上是合理的。\n-   **适定性**：该问题提供了所有必要信息：几何形状（$L$）、介质属性（$\\kappa$, $T$）和边界条件（在 $x=L$ 处的 $I_{\\text{in}}(\\mu)$ 和在 $x=0$ 处的零入射辐射）。目标陈述清晰。存在一个唯一且有意义的出射强度解。\n-   **客观性**：问题以精确、明确、客观的语言陈述。所有术语均为热科学领域的标准术语。\n\n### 第三步：结论与行动\n问题陈述有效，有科学依据，适定且客观。它不包含矛盾、歧义或不合理的假设。将按要求推导解答。\n\n推导从强度为 $I$ 的辐射束沿路径 $s$ 传播时的辐射能量守恒原理开始。在微分路径长度 $ds$ 上，强度的变化量 $dI$ 是发射增益和吸收损耗之和。\n\n对于无散射的参与介质，吸收造成的损耗与局部强度 $I$ 和吸收系数 $\\kappa$ 成正比，由 $-\\kappa I ds$ 给出。在局部热力学平衡 (LTE) 条件下，发射带来的增益由基尔霍夫定律描述。光谱发射率等于光谱吸收率，发射源项为 $\\kappa B(T) ds$，其中 $B(T)$ 是对所有频率积分的普朗克函数，代表黑体强度。\n\n将这些项组合起来，得到沿路径 $s$ 的微分形式的辐射传输方程 (RTE)：\n$$\n\\frac{dI}{ds} = \\kappa B(T) - \\kappa I\n$$\n路径长度 $ds$ 通过方向余弦与空间坐标 $x$ 相关联，$dx = (\\cos\\theta) ds$。设 $\\theta$ 为射线传播方向与 $x$ 轴正方向之间的夹角。因此，RTE 可以用空间坐标 $x$ 来表示：\n$$\n\\cos\\theta \\frac{dI}{dx} = \\kappa (B(T) - I)\n$$\n我们要求解在冷边界 $x=0$ 处出射的强度 $I_{\\text{e}}(\\mu)$。这部分辐射必然源于板内部或热边界 $x=L$。因此，我们关心的射线是从 $x=L$ 向 $x=0$ 传播的。对于这样的射线，传播方向在 $x$ 轴负方向，这意味着角度 $\\theta$ 在 $(\\pi/2, \\pi]$ 范围内。因此，$\\cos\\theta$ 是负值。\n\n问题将方向余弦的大小定义为 $\\mu = |\\cos\\theta|$。对于所考虑的射线，我们有 $\\cos\\theta = -\\mu$，其中 $\\mu \\in (0, 1]$。将此代入 RTE 得到：\n$$\n-\\mu \\frac{dI}{dx} = \\kappa (B(T) - I)\n$$\n为方便起见，重新排列可得：\n$$\n\\mu \\frac{dI}{dx} = \\kappa (I - B(T))\n$$\n这是一个一阶线性常微分方程。为了求解它，我们可以分离变量或使用积分因子。让我们将其重写为：\n$$\n\\frac{dI}{I - B(T)} = \\frac{\\kappa}{\\mu} dx\n$$\n由于温度 $T$ 是恒定的，黑体强度 $B(T)$ 在整个板中也是恒定的。我们可以沿射线路径，从热边界 $x=L$ 到冷边界 $x=0$ 对该方程进行积分。对于这条射线，在 $x=L$ 处的强度是给定的入射强度 $I_{\\text{in}}(\\mu)$，而在 $x=0$ 处的强度是我们希望求得的出射强度 $I_{\\text{e}}(\\mu)$。\n$$\n\\int_{I_{\\text{in}}(\\mu)}^{I_{\\text{e}}(\\mu)} \\frac{dI}{I - B(T)} = \\int_{L}^{0} \\frac{\\kappa}{\\mu} dx\n$$\n计算两边的积分：\n$$\n\\left[ \\ln|I - B(T)| \\right]_{I_{\\text{in}}(\\mu)}^{I_{\\text{e}}(\\mu)} = \\frac{\\kappa}{\\mu} [x]_{L}^{0}\n$$\n$$\n\\ln|I_{\\text{e}}(\\mu) - B(T)| - \\ln|I_{\\text{in}}(\\mu) - B(T)| = \\frac{\\kappa}{\\mu} (0 - L) = -\\frac{\\kappa L}{\\mu}\n$$\n$$\n\\ln\\left(\\frac{|I_{\\text{e}}(\\mu) - B(T)|}{|I_{\\text{in}}(\\mu) - B(T)|}\\right) = -\\frac{\\kappa L}{\\mu}\n$$\n对两边取指数：\n$$\n\\frac{|I_{\\text{e}}(\\mu) - B(T)|}{|I_{\\text{in}}(\\mu) - B(T)|} = \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\n在一个纯吸收-发射介质中，沿任何路径的强度都将单调趋近于黑体强度 $B(T)$。由于射线从 $x=L$ 传播到 $x=0$，如果 $I_{\\text{in}}(\\mu) > B(T)$，强度将向 $B(T)$ 减小，所以 $I_{\\text{e}}(\\mu) > B(T)$。如果 $I_{\\text{in}}(\\mu)  B(T)$，强度将向 $B(T)$ 增加，所以 $I_{\\text{e}}(\\mu)  B(T)$。无论哪种情况，项 $(I - B(T))$ 沿路径的符号都不会改变。因此，只要我们保持正确的符号关系，就可以去掉绝对值符号。\n$$\nI_{\\text{e}}(\\mu) - B(T) = (I_{\\text{in}}(\\mu) - B(T)) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\n求解出射强度 $I_{\\text{e}}(\\mu)$：\n$$\nI_{\\text{e}}(\\mu) = B(T) + (I_{\\text{in}}(\\mu) - B(T)) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\n$$\nI_{\\text{e}}(\\mu) = B(T) + I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) - B(T) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\n$$\n$$\nI_{\\text{e}}(\\mu) = I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) + B(T) \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\n$$\n这就是出射强度的形式解。第一项表示来自热边界的入射辐射 $I_{\\text{in}}(\\mu)$，它被沿路径的板的光学厚度 $\\kappa L/\\mu$ 所衰减。第二项表示来自板本身热发射的贡献，即黑体强度 $B(T)$ 乘以板的方向发射率 $\\epsilon_\\mu = (1 - \\exp(-\\kappa L/\\mu))$。\n\n最后，我们代入给定的灰体黑体强度表达式 $B(T) = \\frac{\\sigma T^4}{\\pi}$：\n$$\nI_{\\text{e}}(\\mu) = I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) + \\frac{\\sigma T^{4}}{\\pi} \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\n$$\n这是在冷边界处出射强度的最终闭式解析表达式。",
            "answer": "$$\\boxed{I_{\\text{in}}(\\mu) \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) + \\frac{\\sigma T^{4}}{\\pi} \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)}$$"
        },
        {
            "introduction": "上一个练习中的“灰色介质”假设是一种有用的理想化，但真实燃烧产物（如水蒸气和二氧化碳）的辐射特性在整个光谱上是高度非均匀的。本练习将带你进入对真实气体辐射特性建模的核心，通过一个计算实践，学习如何从光谱吸收系数模型出发，计算普朗克平均吸收系数 $\\kappa_{P}$。这对于将复杂的非灰色辐射行为简化并整合到工程计算中至关重要。",
            "id": "4015090",
            "problem": "考虑一个由水蒸气和二氧化碳组成的一维、无散射的参与性气体介质，该介质被视为温度为 $T = 1800\\,\\text{K}$ 的等温介质，且压力 $p$ 在空间上均匀。混合物的平均光谱吸收系数被建模为由各组分的摩尔分数加权的贡献之和。混合物的普朗克平均吸收系数 $\\kappa_{P}$ 通过根据波长对黑体强度进行加权来定义，具体如下\n$$\n\\kappa_{P}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda},\n$$\n其中 $\\kappa_{\\lambda}$ 是混合物的光谱吸收系数，$I_{\\lambda}^{b}(T)$ 是温度为 $T$ 时的黑体光谱强度。单位波长的黑体光谱强度由普朗克定律给出，这是热辐射的基本定律：\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right),\n$$\n其中 $h$ 是普朗克常数，$c$ 是真空中光速，$k_{B}$ 是玻尔兹曼常数。基尔霍夫热辐射定律（适用于局部热力学平衡）确保了发射和吸收是相关的，这证明了使用 $I_{\\lambda}^{b}(T)$ 作为定义 $\\kappa_{P}$ 的权重函数的合理性。\n\n假设混合物的光谱吸收系数采用以下具有科学依据的参数模型：\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\chi_{\\mathrm{H_2O}} \\, A_{\\mathrm{H_2O}}(T,p) \\, g_{\\mathrm{H_2O}}(\\lambda) \\;+\\; \\chi_{\\mathrm{CO_2}} \\, A_{\\mathrm{CO_2}}(T,p) \\, g_{\\mathrm{CO_2}}(\\lambda),\n$$\n其中 $\\chi_{\\mathrm{H_2O}}$ 和 $\\chi_{\\mathrm{CO_2}}$ 分别是水蒸气和二氧化碳的摩尔分数，$A_{i}(T,p)$ 是单位为长度倒数的组分振幅函数，$g_{i}(\\lambda)$ 是代表主要红外波段的无量纲光谱形状函数。振幅函数随压力和温度的变化关系如下\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s},\n$$\n其中 $p_{0} = 101325\\,\\text{Pa}$，$T_{0} = 1800\\,\\text{K}$，$s = 0.5$，组分基线系数 $\\alpha_{\\mathrm{H_2O}} = 4.0\\,\\text{m}^{-1}$，$\\alpha_{\\mathrm{CO_2}} = 3.0\\,\\text{m}^{-1}$。光谱形状函数被规定为高斯谱带之和：\n$$\ng_{\\mathrm{H_2O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\mathrm{H_2O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{H_2O})}_{j}}{\\sigma^{(\\mathrm{H_2O})}_{j}}\\right)^{2} \\right),\n$$\n其中心 $\\lambda^{(\\mathrm{H_2O})}_{j} \\in \\{1.4\\times 10^{-6},\\, 2.7\\times 10^{-6},\\, 6.3\\times 10^{-6}\\}\\,\\text{m}$，权重 $w^{(\\mathrm{H_2O})}_{j} \\in \\{0.5,\\, 0.3,\\, 0.2\\}$，宽度 $\\sigma^{(\\mathrm{H_2O})}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.5\\times 10^{-6},\\, 1.2\\times 10^{-6}\\}\\,\\text{m}$。类似地，\n$$\ng_{\\mathrm{CO_2}}(\\lambda) = \\sum_{j=1}^{2} w^{(\\mathrm{CO_2})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{CO_2})}_{j}}{\\sigma^{(\\mathrm{CO_2})}_{j}}\\right)^{2} \\right),\n$$\n其中心 $\\lambda^{(\\mathrm{CO_2})}_{j} \\in \\{2.0\\times 10^{-6},\\, 4.3\\times 10^{-6}\\}\\,\\text{m}$，权重 $w^{(\\mathrm{CO_2})}_{j} \\in \\{0.4,\\, 0.6\\}$，宽度 $\\sigma^{(\\mathrm{CO_2})}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.8\\times 10^{-6}\\}\\,\\text{m}$。波长积分域必须取为 $\\lambda \\in [2\\times 10^{-7},\\, 2\\times 10^{-5}]\\,\\text{m}$，以覆盖 $T = 1800\\,\\text{K}$ 时的相关热谱。\n\n定义光学厚度为\n$$\n\\tau = \\kappa_{P} \\, L,\n$$\n其中 $L$ 是介质厚度。在灰体近似的背景下，$\\tau$ 为单位量级的区域表明其行为既非光学薄也非光学厚；评估灰体模型适用性（无散射且发射-吸收耦合占主导地位）的一个实用标准是\n$$\n\\text{gray\\_ok} = \\begin{cases}\n\\text{true},  \\text{if } 0.3 \\le \\tau \\le 3.0,\\\\\n\\text{false},  \\text{otherwise}.\n\\end{cases}\n$$\n\n任务：\n- 使用上述定义和模型，为下面的每个测试用例计算 $\\kappa_{P}$ 和 $\\tau$。\n- 将 $\\kappa_{P}$ 以 $\\text{m}^{-1}$ 为单位表示，$\\tau$ 为无量纲量，两者均四舍五入到六位小数。\n- 对于每个测试用例，还需输出 $\\text{gray\\_ok}$，其值为小写字符串 $\\,\\text{true}\\,$ 或 $\\,\\text{false}\\,$。\n- 您的程序必须在指定域上进行数值波长积分。\n\n测试套件：\n1. 用例 1：$T = 1800\\,\\text{K}$，$p = 1.0\\,\\text{atm}$，$\\chi_{\\mathrm{H_2O}} = 0.10$，$\\chi_{\\mathrm{CO_2}} = 0.10$，$L = 2.0\\,\\text{m}$。\n2. 用例 2：$T = 1800\\,\\text{K}$，$p = 1.0\\,\\text{atm}$，$\\chi_{\\mathrm{H_2O}} = 0.00$，$\\chi_{\\mathrm{CO_2}} = 0.20$，$L = 1.0\\,\\text{m}$。\n3. 用例 3：$T = 1800\\,\\text{K}$，$p = 5.0\\,\\text{atm}$，$\\chi_{\\mathrm{H_2O}} = 0.20$，$\\chi_{\\mathrm{CO_2}} = 0.10$，$L = 1.0\\,\\text{m}$。\n4. 用例 4（边界情况，透明介质）：$T = 1800\\,\\text{K}$，$p = 1.0\\,\\text{atm}$，$\\chi_{\\mathrm{H_2O}} = 0.00$，$\\chi_{\\mathrm{CO_2}} = 0.00$，$L = 1.0\\,\\text{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个各用例结果的列表。每个用例的结果必须是一个形如 $[\\kappa_{P}, \\tau, \\text{gray\\_ok}]$ 的三元列表，不含空格，其中 $\\kappa_{P}$ 的单位是 $\\text{m}^{-1}$，$\\tau$ 是无量纲的，两者都四舍五入到六位小数，而 $\\text{gray\\_ok}$ 是小写字符串 $\\,\\text{true}\\,$ 或 $\\,\\text{false}\\,$。总输出必须是这些用例列表的逗号分隔列表，并用方括号括起来。例如，格式为 $[[0.123456,0.654321,true],[\\dots],[\\dots],[\\dots]]$。",
            "solution": "该问题要求计算在指定热力学条件下，水蒸气和二氧化碳气体混合物的普朗克平均吸收系数 $\\kappa_{P}$。基于此，需要为几个测试用例确定光学厚度 $\\tau$ 和一个灰体模型的适用性标准。\n\n普朗克平均吸收系数 $\\kappa_{P}$ 定义为由黑体光谱强度 $I_{\\lambda}^{b}(T)$ 加权并由总黑体强度归一化的光谱吸收系数 $\\kappa_{\\lambda}$。公式为：\n$$\n\\kappa_{P}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda}\n$$\n对于数值计算，无限积分域被替换为指定的范围 $\\lambda \\in [2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$，该范围在给定温度 $T=1800\\,\\text{K}$ 下捕获了绝大部分的黑体发射功率。设分子为 $N$，分母为 $D$。\n$$\nN = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} \\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}})\\, I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\n$$\nD = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\n然后，$\\kappa_{P} = N/D$。黑体光谱强度 $I_{\\lambda}^{b}(T)$ 由普朗克定律给出：\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\n常数前因子 $2 h c^{2}$ 同时出现在分子 $N$ 和分母 $D$ 的积分中，因此可以消去。这对数值计算是有利的，因为它避免了处理非常大或非常小的数。因此，我们可以使用一个与 $I_{\\lambda}^{b}(T)$ 成比例的简化权重函数：\n$$\nw(\\lambda, T) = \\frac{1}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\n\n混合物的光谱吸收系数 $\\kappa_{\\lambda}$ 被建模为各组分贡献的线性组合：\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\mathrm{H_2O}},\\chi_{\\mathrm{CO_2}}) = \\chi_{\\mathrm{H_2O}} \\, A_{\\mathrm{H_2O}}(T,p) \\, g_{\\mathrm{H_2O}}(\\lambda) \\;+\\; \\chi_{\\mathrm{CO_2}} \\, A_{\\mathrm{CO_2}}(T,p) \\, g_{\\mathrm{CO_2}}(\\lambda)\n$$\n每个组分 $i \\in \\{\\mathrm{H_2O}, \\mathrm{CO_2}\\}$ 的振幅函数 $A_{i}$ 取决于压力 $p$ 和温度 $T$：\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s}\n$$\n其中参数 $\\alpha_{i}$、$p_{0} = 101325\\,\\text{Pa}$、$T_{0} = 1800\\,\\text{K}$ 和 $s = 0.5$ 均已给定。注意，对于所有测试用例，$T = T_0$，所以项 $\\left(T/T_{0}\\right)^{s}$ 总是等于 1。压力必须使用 $1\\,\\text{atm} = 101325\\,\\text{Pa}$ 从大气压转换为帕斯卡。\n\n光谱形状函数 $g_{i}(\\lambda)$ 被建模为代表吸收带的高斯函数之和：\n$$\ng_{\\mathrm{H_2O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\mathrm{H_2O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{H_2O})}_{j}}{\\sigma^{(\\mathrm{H_2O})}_{j}}\\right)^{2} \\right)\n$$\n$$\ng_{\\mathrm{CO_2}}(\\lambda) = \\sum_{j=1}^{2} w^{(\\mathrm{CO_2})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\mathrm{CO_2})}_{j}}{\\sigma^{(\\mathrm{CO_2})}_{j}}\\right)^{2} \\right)\n$$\n这些高斯函数的参数（权重 $w_j$、中心 $\\lambda_j$ 和宽度 $\\sigma_j$）在问题陈述中已提供。\n\n每个测试用例的算法流程如下：\n1.  确定用例特定的参数：$T$、$p$ (单位 atm)、$\\chi_{\\mathrm{H_2O}}$、$\\chi_{\\mathrm{CO_2}}$ 和 $L$。所有用例的温度 $T=1800\\,\\text{K}$ 是恒定的。\n2.  使用给定模型计算振幅函数 $A_{\\mathrm{H_2O}}$ 和 $A_{\\mathrm{CO_2}}$，确保使用帕斯卡为单位的压力。\n3.  使用计算出的振幅和预定义的光谱形状函数 $g_{\\mathrm{H_2O}}(\\lambda)$ 和 $g_{\\mathrm{CO_2}}(\\lambda)$，构建光谱吸收系数函数 $\\kappa_{\\lambda}(\\lambda)$。\n4.  定义分子被积函数 $\\kappa_{\\lambda}(\\lambda) w(\\lambda, T)$ 和分母被积函数 $w(\\lambda, T)$。\n5.  在波长范围 $[2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$ 上对积分 $N$ 和 $D$ 进行数值评估。高质量的数值求积例程，如 `scipy.integrate.quad`，适合此任务。对于水蒸气和二氧化碳的摩尔分数 $\\chi_{\\mathrm{H_2O}}$ 和 $\\chi_{\\mathrm{CO_2}}$ 均为零的特殊情况，$\\kappa_{\\lambda}$ 恒为零，这使得分子 $N=0$，因此 $\\kappa_{P}=0$，无需积分。\n6.  计算普朗克平均吸收系数：$\\kappa_{P} = N/D$。\n7.  计算光学厚度：$\\tau = \\kappa_{P} \\, L$。\n8.  应用给定标准确定 $\\text{gray\\_ok}$ 的值：如果 $0.3 \\le \\tau \\le 3.0$，则为 $\\text{true}$，否则为 $\\text{false}$。\n9.  按要求格式化计算值（$\\kappa_P$ 和 $\\tau$ 四舍五入到六位小数，以及 $\\text{gray\\_ok}$ 的小写字符串）。\n\n对问题陈述中提供的每个测试用例实施此流程，以生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Calculates the Planck mean absorption coefficient, optical thickness,\n    and a gray-model applicability metric for a gas mixture.\n    \"\"\"\n    \n    # Define physical constants from SciPy\n    h = constants.h  # Planck constant (J.s)\n    c = constants.c  # Speed of light in vacuum (m/s)\n    k = constants.k  # Boltzmann constant (J/K)\n\n    # Define model parameters from the problem statement\n    # Reference conditions\n    p0 = 101325.0  # Reference pressure in Pa\n    T0 = 1800.0   # Reference temperature in K\n    s = 0.5       # Temperature exponent\n\n    # Species baseline coefficients\n    alpha_h2o = 4.0  # m^-1\n    alpha_co2 = 3.0  # m^-1\n\n    # Integration wavelength range\n    WAV_MIN, WAV_MAX = 2e-7, 2e-5 # m\n\n    # Spectral shape function parameters for H2O\n    H2O_BANDS = {\n        'weights': np.array([0.5, 0.3, 0.2]),\n        'centers': np.array([1.4e-6, 2.7e-6, 6.3e-6]),\n        'widths': np.array([0.4e-6, 0.5e-6, 1.2e-6])\n    }\n\n    # Spectral shape function parameters for CO2\n    CO2_BANDS = {\n        'weights': np.array([0.4, 0.6]),\n        'centers': np.array([2.0e-6, 4.3e-6]),\n        'widths': np.array([0.4e-6, 0.8e-6])\n    }\n\n    def planck_weight_function(wav, T):\n        \"\"\"\n        Calculates the wavelength-dependent part of the Planck function,\n        omitting the 2*h*c^2 constant which cancels out.\n        \"\"\"\n        C2_over_T = h * c / (k * T)\n        exponent = C2_over_T / wav\n        # np.exp(709.78) is a typical double-precision float limit\n        if exponent > 700:\n            return 0.0\n        return (1.0 / wav**5) / (np.exp(exponent) - 1.0)\n\n    def g_h2o(wav):\n        \"\"\"Calculates the spectral shape function for H2O.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(H2O_BANDS['weights'], H2O_BANDS['centers'], H2O_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def g_co2(wav):\n        \"\"\"Calculates the spectral shape function for CO2.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(CO2_BANDS['weights'], CO2_BANDS['centers'], CO2_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def calculate_k_p(T, p_atm, chi_h2o, chi_co2):\n        \"\"\"Calculates the Planck mean absorption coefficient.\"\"\"\n        # Handle the transparent medium case directly for efficiency and correctness.\n        if chi_h2o == 0.0 and chi_co2 == 0.0:\n            return 0.0\n\n        p_pa = p_atm * 101325.0\n        \n        # Calculate amplitude functions A_i\n        A_h2o = alpha_h2o * (p_pa / p0) * (T / T0)**s\n        A_co2 = alpha_co2 * (p_pa / p0) * (T / T0)**s\n\n        def kappa_lambda(wav):\n            \"\"\"Calculates the mixture spectral absorption coefficient.\"\"\"\n            return chi_h2o * A_h2o * g_h2o(wav) + chi_co2 * A_co2 * g_co2(wav)\n        \n        # Numerator integral: integral(kappa_lambda * I_lambda^b * d_lambda)\n        # We use planck_weight_function since the 2hc^2 constant cancels.\n        num_integrand = lambda wav: kappa_lambda(wav) * planck_weight_function(wav, T)\n        numerator, _ = integrate.quad(num_integrand, WAV_MIN, WAV_MAX)\n        \n        # Denominator integral: integral(I_lambda^b * d_lambda)\n        den_integrand = lambda wav: planck_weight_function(wav, T)\n        denominator, _ = integrate.quad(den_integrand, WAV_MIN, WAV_MAX)\n\n        if denominator == 0:\n            return 0.0\n        \n        return numerator / denominator\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T [K], p [atm], chi_H2O, chi_CO2, L [m])\n        (1800.0, 1.0, 0.10, 0.10, 2.0),\n        (1800.0, 1.0, 0.00, 0.20, 1.0),\n        (1800.0, 5.0, 0.20, 0.10, 1.0),\n        (1800.0, 1.0, 0.00, 0.00, 1.0),\n    ]\n\n    results_str_list = []\n    for T_case, p_case, chi_h2o_case, chi_co2_case, L_case in test_cases:\n        kappa_p = calculate_k_p(T_case, p_case, chi_h2o_case, chi_co2_case)\n        tau = kappa_p * L_case\n        gray_ok = \"true\" if 0.3 = tau = 3.0 else \"false\"\n        \n        # Format the result for this case as a string \"[k_p,tau,gray_ok]\"\n        case_result_str = f\"[{kappa_p:.6f},{tau:.6f},{gray_ok}]\"\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际的计算燃烧模拟中，直接求解详细的光谱辐射传递方程（逐线积分法，LBL）计算成本极高。因此，开发和使用简化模型（如灰色气体模型或加权灰气体总和模型，WSGG）是必不可少的。本练习通过一个典型的炉膛热流计算问题，让你亲手比较不同简化模型与高精度LBL参考解的差异，从而量化模型简化所带来的精度损失。这个实践将帮助你理解在计算效率和模型保真度之间进行权衡的现实挑战。",
            "id": "4015147",
            "problem": "考虑一个厚度为 $L$ 的一维、平面平行、等温的参与性气体层，该气体层由两个温度分别为 $T_{w,1}$ 和 $T_{w,2}$ 的等温黑体壁面所界定。气体处于均匀温度 $T_g$ 下，吸收和发射辐射，但不发生散射。设局部光谱强度 $I_\\nu(s,\\mu)$ 满足非散射介质的辐射传输方程 (RTE)，该方程沿一条射线表示，其方向余弦 $\\mu \\in [-1,1]$ 是相对于壁面1的外法线而言的：\n$$\n\\frac{d I_\\nu}{ds} = -\\kappa_\\nu I_\\nu + \\kappa_\\nu I_{b,\\nu}(T_g),\n$$\n其中 $\\kappa_\\nu$ 是光谱吸收系数，单位为 $\\mathrm{m}^{-1}$；$s$ 是路径长度坐标，单位为 $\\mathrm{m}$；$I_{b,\\nu}(T)$ 是温度为 $T$ 时的光谱黑体强度。黑体壁面的边界条件为：对于从壁面1进入介质的辐射，$I_\\nu(0,\\mu > 0) = I_{b,\\nu}(T_{w,1})$；对于从壁面2进入介质的辐射，$I_\\nu(L,\\mu  0) = I_{b,\\nu}(T_{w,2})$。\n\n定义壁面1上的半球入射辐射（对壁面1的辐照度）为\n$$\nH_1 = \\int_{\\Omega^-} I(\\mathbf{x}_w,\\mathbf{s}) \\, \\left|\\mathbf{s}\\cdot \\mathbf{n}\\right| \\, d\\Omega,\n$$\n其中 $\\Omega^-$ 表示相对于壁面1的入射半球，$\\mathbf{n}$ 是壁面1的外单位法向量（指向气体），$I(\\mathbf{x}_w,\\mathbf{s})$ 是在壁面位置 $\\mathbf{x}_w$ 沿方向 $\\mathbf{s}$ 的频率积分强度。对于黑体壁面，从壁面1进入气体的净辐射热流密度为\n$$\nq''_1 = \\sigma T_{w,1}^4 - H_1,\n$$\n其中 $\\sigma$ 是 Stefan–Boltzmann 常数，其值为 $\\sigma = 5.670374419\\times 10^{-8} \\,\\mathrm{W\\, m^{-2}\\, K^{-4}}$。\n\n在甲烷-空气炉的实际计算燃烧模拟中，需要使用光谱模型。此处考虑三种光谱吸收模型：\n\n1. 灰体模型，使用单一的有效吸收系数 $\\kappa_{\\text{gray}}$（单位为 $\\mathrm{m}^{-1}$）。\n2. 四组分灰体气体加权和 (WSGG) 模型，由四个吸收系数 $\\kappa_i$ 和相应的非负权重 $w_i$（其中 $i \\in \\{1,2,3,4\\}$）指定。透明气体的权重为 $w_0 = 1 - \\sum_{i=1}^{4} w_i$，对应的吸收系数为 $\\kappa_0 = 0$。\n3. 逐线 (LBL) 参考，提供为一组离散的光谱线或谱带，包含吸收系数 $\\kappa_j$ 和权重 $W_j$（其中 $j \\in \\{1,\\dots,N\\}$），满足 $\\sum_{j=1}^N W_j = 1$，且某些条目可能具有 $\\kappa_j = 0$ 以表示透明窗口。\n\n所有模型均采用以下物理上一致的基础：\n- 频率积分的黑体强度为 $I_b(T) = \\sigma T^4 / \\pi$，单位为 $\\mathrm{W\\, m^{-2}\\, sr^{-1}}$。\n- 对于一个给定的具有吸收系数 $\\kappa$ 的光谱子集，沿着从内部指向壁面1且源于壁面2的射线，在等温、均匀介质中RTE的形式解给出了到达壁面1的入射强度，该强度取决于 $\\kappa$、对壁强度以及路径上的气体发射。\n- 入射辐射 $H_1$ 是通过对入射强度在半球上进行积分来计算的，即对所有相对于壁面法线的方向余弦 $\\mu \\in (0,1)$ 的方向进行积分。\n\n您的任务是编写一个程序，为下面指定的每个测试用例计算：\n- 使用提供的 $\\{\\kappa_j, W_j\\}_{j=1}^N$ 计算LBL参考壁面热流密度 $q''_{1,\\mathrm{LBL}}$。\n- 使用 $\\kappa_{\\text{gray}}$ 计算灰体模型壁面热流密度 $q''_{1,\\mathrm{gray}}$。\n- 使用集合 $\\{(\\kappa_i, w_i)\\}_{i=1}^4$ 并增补透明气体组 $(\\kappa_0=0, w_0)$ 来计算四组分WSGG壁面热流密度 $q''_{1,\\mathrm{WSGG}}$。\n\n然后，为每个测试用例计算相对于LBL参考的两个误差度量：\n- 灰体模型的相对误差 $e_{\\mathrm{gray}} = \\left| q''_{1,\\mathrm{gray}} - q''_{1,\\mathrm{LBL}} \\right| / \\left| q''_{1,\\mathrm{LBL}} \\right|$。\n- WSGG的相对误差 $e_{\\mathrm{WSGG}} = \\left| q''_{1,\\mathrm{WSGG}} - q''_{1,\\mathrm{LBL}} \\right| / \\left| q''_{1,\\mathrm{LBL}} \\right|$。\n\n必须遵守所有物理单位：\n- 长度 $L$ 单位为 $\\mathrm{m}$。\n- 吸收系数 $\\kappa$ 单位为 $\\mathrm{m}^{-1}$。\n- 温度单位为 $\\mathrm{K}$。\n- 热流密度 $q''$ 单位为 $\\mathrm{W\\, m^{-2}}$。\n\n角度积分必须在入射半球上进行，单位为弧度。\n\n从基本定律和定义出发，实现上述计算，并与RTE及所述建模假设保持一致。不要引入任何与非散射、等温、平面平行假设相矛盾的封闭模型或公式。\n\n测试套件：\n为以下三个测试用例提供结果，每个用例表示为一组参数。在每个用例中，逐线集合是一个由 $(\\kappa_j, W_j)$ 对组成的列表。\n\n- 用例1（光学薄趋势）：\n  - $L = 0.1 \\,\\mathrm{m}$, $T_g = 1800 \\,\\mathrm{K}$, $T_{w,1} = 1600 \\,\\mathrm{K}$, $T_{w,2} = 1400 \\,\\mathrm{K}$。\n  - 灰体： $\\kappa_{\\text{gray}} = 0.05 \\,\\mathrm{m}^{-1}$。\n  - 四组分 WSGG： $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.1, 0.15), (0.5, 0.15), (2.0, 0.07), (10.0, 0.03)\\}$，透明气体权重 $w_0 = 0.60$。\n  - LBL 集合 $\\{(\\kappa_j, W_j)\\}_{j=1}^{5} = \\{(0.0, 0.55), (0.05, 0.20), (0.5, 0.15), (3.0, 0.07), (15.0, 0.03)\\}$。\n\n- 用例2（中等光学厚度）：\n  - $L = 1.0 \\,\\mathrm{m}$, $T_g = 1800 \\,\\mathrm{K}$, $T_{w,1} = 1500 \\,\\mathrm{K}$, $T_{w,2} = 1200 \\,\\mathrm{K}$。\n  - 灰体： $\\kappa_{\\text{gray}} = 0.3 \\,\\mathrm{m}^{-1}$。\n  - 四组分 WSGG： $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.02, 0.20), (0.1, 0.30), (0.5, 0.35), (2.0, 0.10)\\}$，透明气体权重 $w_0 = 0.05$。\n  - LBL 集合 $\\{(\\kappa_j, W_j)\\}_{j=1}^{5} = \\{(0.0, 0.05), (0.02, 0.15), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20)\\}$。\n\n- 用例3（光学厚趋势）：\n  - $L = 3.0 \\,\\mathrm{m}$, $T_g = 2000 \\,\\mathrm{K}$, $T_{w,1} = 1700 \\,\\mathrm{K}$, $T_{w,2} = 1300 \\,\\mathrm{K}$。\n  - 灰体： $\\kappa_{\\text{gray}} = 0.7 \\,\\mathrm{m}^{-1}$。\n  - 四组分 WSGG： $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.1, 0.25), (0.5, 0.40), (2.0, 0.25), (8.0, 0.08)\\}$，透明气体权重 $w_0 = 0.02$。\n  - LBL 集合 $\\{(\\kappa_j, W_j)\\}_{j=1}^{6} = \\{(0.0, 0.02), (0.01, 0.08), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20), (10.0, 0.10)\\}$。\n\n最终输出格式：\n您的程序应生成单行输出，包含按顺序排列的六个误差值\n$$\n[e_{\\mathrm{gray},1}, e_{\\mathrm{WSGG},1}, e_{\\mathrm{gray},2}, e_{\\mathrm{WSGG},2}, e_{\\mathrm{gray},3}, e_{\\mathrm{WSGG},3}],\n$$\n以逗号分隔的列表形式，并用方括号括起来。每个条目必须是四舍五入到六位有效数字的小数（可接受科学记数法或定点记数法）。无量纲误差必须以小数形式表示（不要使用百分号）。",
            "solution": "我们从平面平行板中非散射、等温介质的辐射传输方程 (RTE) 开始。设气体是均匀的，吸收系数为 $\\kappa$，温度为 $T_g$，由位于 $x=0$（壁面1，温度为 $T_{w,1}$）和 $x=L$（壁面2，温度为 $T_{w,2}$）的黑体壁面界定。相对于壁面1外法线的方向余弦为 $\\mu = \\cos\\theta \\in [-1,1]$。\n\n沿射线的RTE光谱形式为\n$$\n\\frac{d I_\\nu(x,\\mu)}{ds} = -\\kappa_\\nu I_\\nu(x,\\mu) + \\kappa_\\nu I_{b,\\nu}(T_g),\n$$\n其形式解描述了从内部沿指向壁面1的入射方向（即，从壁面1向板内测量的方向余弦大小 $\\mu \\in (0,1)$）投射到壁面1上的强度，该解通过沿长度为 $L/\\mu$ 的路径从对面的边界 $x=L$ 向 $x=0$ 积分得到：\n$$\nI_\\nu(0, -\\mu) = I_{b,\\nu}(T_{w,2}) \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right) + \\int_{0}^{L/\\mu} \\kappa_\\nu I_{b,\\nu}(T_g) \\exp\\!\\left[-\\kappa_\\nu s\\right] \\, ds.\n$$\n由于气体是等温的，$I_{b,\\nu}(T_g)$ 沿路径为常数，积分计算结果为\n$$\n\\int_{0}^{L/\\mu} \\kappa_\\nu I_{b,\\nu}(T_g) \\exp(-\\kappa_\\nu s)\\, ds = I_{b,\\nu}(T_g)\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right)\\right].\n$$\n因此，壁面1上的入射光谱强度为\n$$\nI_\\nu(0, -\\mu) = I_{b,\\nu}(T_{w,2}) \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right) + I_{b,\\nu}(T_g)\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right)\\right].\n$$\n\n为了获得频率积分强度，我们对所有光谱子集进行积分。对于将光谱离散为 $M$ 组的模型，每组由索引 $m$ 标识，具有吸收系数 $\\kappa_m$ 和权重 $w_m$（满足 $\\sum_{m=1}^M w_m = 1$），假设每组在其权重范围内表现得像一个灰体，其 $I_b(T) = \\sigma T^4/\\pi$，则入射的组平均强度为\n$$\nI_m(0, -\\mu) = \\frac{\\sigma T_{w,2}^4}{\\pi} \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) + \\frac{\\sigma T_g^4}{\\pi} \\left[1 - \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right)\\right].\n$$\n对于 $\\kappa=0$ 的透明气体组，此式简化为 $I_{\\text{clear}}(0,-\\mu) = \\frac{\\sigma T_{w,2}^4}{\\pi}$，并且不发射任何辐射。\n\n壁面1上的半球入射辐射是入射半球上的积分：\n$$\nH_1 = \\int_{\\Omega^-} I(\\mathbf{x}_w,\\mathbf{s}) \\left|\\mathbf{s}\\cdot\\mathbf{n}\\right| d\\Omega = 2\\pi \\int_{0}^{1} \\left[ \\sum_{m=1}^{M} w_m \\, I_m(0,-\\mu) \\right] \\mu \\, d\\mu,\n$$\n其中，围绕壁面法线的轴对称性允许将其简化为关于 $\\mu$ 的一维积分，并带有一个因子 $2\\pi$。\n\n利用黑体壁面的辐射出射度-发射功率恒等式，离开壁面1的净辐射热流密度为\n$$\nq''_1 = \\sigma T_{w,1}^4 - H_1.\n$$\n\n我们现在将此框架应用于每个模型：\n- 对于灰体模型，只有一个组，$M=1$，$w_1=1$，且 $\\kappa_1 = \\kappa_{\\text{gray}}$。\n- 对于四组分灰体气体加权和 (WSGG)，包括透明气体在内，共有五个有效组：$M=5$，其中 $\\kappa_0 = 0$，$w_0 = 1 - \\sum_{i=1}^4 w_i$，以及指定的 $\\{(\\kappa_i,w_i)\\}_{i=1}^4$。\n- 对于逐线 (LBL) 参考，离散的谱线或谱带直接用作分组：$M=N$，$\\kappa_m = \\kappa_j$，$w_m = W_j$。\n\n每个测试用例的算法步骤如下：\n1. 计算 $T=T_g$ 和 $T=T_{w,2}$ 时的 $I_b(T) = \\sigma T^4 / \\pi$。\n2. 定义入射辐射的被积函数：\n   $$\n   \\Phi(\\mu) = \\mu \\sum_{m=1}^{M} w_m \\left[ \\frac{\\sigma T_{w,2}^4}{\\pi} \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) + \\frac{\\sigma T_g^4}{\\pi} \\left( 1 - \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) \\right) \\right].\n   $$\n3. 在 $\\mu \\in (0,1)$ 区间内使用自适应求积法数值计算 $H_1 = 2\\pi \\int_0^1 \\Phi(\\mu) \\, d\\mu$；被积函数是良态的，因为当 $\\mu \\to 0^+$ 时，因子 $\\mu$ 乘以一个指数级小的项，确保了可积性。\n4. 计算 $q''_1 = \\sigma T_{w,1}^4 - H_1$。\n5. 将上述步骤应用于 LBL 集以获得 $q''_{1,\\mathrm{LBL}}$，应用于灰体集以获得 $q''_{1,\\mathrm{gray}}$，以及应用于 WSGG 集（包括透明气体组）以获得 $q''_{1,\\mathrm{WSGG}}$。\n6. 计算相对误差：\n   $$\n   e_{\\mathrm{gray}} = \\frac{\\left| q''_{1,\\mathrm{gray}} - q''_{1,\\mathrm{LBL}} \\right|}{\\left| q''_{1,\\mathrm{LBL}} \\right|}, \\quad\n   e_{\\mathrm{WSGG}} = \\frac{\\left| q''_{1,\\mathrm{WSGG}} - q''_{1,\\mathrm{LBL}} \\right|}{\\left| q''_{1,\\mathrm{LBL}} \\right|}.\n   $$\n\n每一步都保持单位一致：$I_b$ 的单位是 $\\mathrm{W\\, m^{-2}\\, sr^{-1}}$，角度积分产生 $\\mathrm{W\\, m^{-2}}$，而 $q''_1$ 的单位是 $\\mathrm{W\\, m^{-2}}$。无量纲误差以小数形式报告。\n\n对于测试套件：\n- 用例1的特点是，许多组的光学厚度因子 $\\kappa L$ 很小，接近于透射占主导的极限行为，此时 $q''_1 \\to \\sigma (T_{w,1}^4 - T_{w,2}^4)$。\n- 用例2表现出中等光学厚度，气体自发射与壁面间透射达到平衡。\n- 用例3在大多数组中是光学厚的，接近类扩散极限，此时 $H_1 \\to \\sigma T_g^4$ 且 $q''_1 \\to \\sigma (T_{w,1}^4 - T_g^4)$。\n\n数值考虑：\n- 对于有限的 $\\kappa L$，被积函数 $\\Phi(\\mu)$ 在 $(0,1]$ 上是光滑的，并且当 $\\mu \\to 0^+$ 时趋向于 0，因为 $\\mu \\exp(-\\kappa L/\\mu)$ 趋向于 0 的速度比任何代数速率都快。\n- 使用绝对和相对容差在 $10^{-10}$ 量级的自适应求积法（例如，通过 $\\int_0^1$ 的实现方式，如 Gauss–Kronrod 方法）可确保精度。\n\n程序为三个指定的用例实现了这些步骤，并打印包含六个误差值 $[e_{\\mathrm{gray},1}, e_{\\mathrm{WSGG},1}, e_{\\mathrm{gray},2}, e_{\\mathrm{WSGG},2}, e_{\\mathrm{gray},3}, e_{\\mathrm{WSGG},3}]$ 的单行输出，每个值都四舍五入到六位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Stefan–Boltzmann constant (W/m^2/K^4)\nSIGMA = 5.670374419e-8\n\ndef blackbody_intensity(T):\n    \"\"\"Frequency-integrated blackbody intensity Ib = sigma*T^4/pi (W/m^2/sr).\"\"\"\n    return SIGMA * (T ** 4) / np.pi\n\ndef incident_radiation_on_wall(L, Tg, Tw2, kappas, weights):\n    \"\"\"\n    Compute hemispherical incident radiation H1 on wall 1 due to the gas and wall 2\n    for a set of spectral groups with absorption coefficients 'kappas' (1/m)\n    and corresponding weights 'weights' (sum to 1).\n    \"\"\"\n    Ib_g = blackbody_intensity(Tg)\n    Ib_w2 = blackbody_intensity(Tw2)\n\n    # Define integrand in mu for H1 = 2*pi * integral_0^1 [ Phi(mu) dmu ]\n    def phi(mu):\n        # Avoid mu=0 exactly; quad won't evaluate at endpoints by default.\n        # Contribution for each group m: w_m * [ Ib_w2 * exp(-kappa_m*L/mu) + Ib_g*(1 - exp(...)) ]\n        # Multiply by mu for projection.\n        s = 0.0\n        for kappa, w in zip(kappas, weights):\n            if kappa == 0.0:\n                # Clear gas: exp(0)=1, emission term zero\n                term = Ib_w2\n            else:\n                att = np.exp(- (kappa * L) / mu)\n                term = Ib_w2 * att + Ib_g * (1.0 - att)\n            s += w * term\n        return mu * s\n\n    # Perform the angular integration\n    H1, _ = quad(phi, 0.0, 1.0, epsabs=1e-10, epsrel=1e-10, limit=200)\n    H1 *= 2.0 * np.pi\n    return H1\n\ndef wall_heat_flux(L, Tg, Tw1, Tw2, kappas, weights):\n    \"\"\"Compute net radiative heat flux leaving wall 1: q1'' = sigma*Tw1^4 - H1.\"\"\"\n    H1 = incident_radiation_on_wall(L, Tg, Tw2, kappas, weights)\n    q = SIGMA * (Tw1 ** 4) - H1\n    return q\n\ndef compute_errors_for_case(case):\n    \"\"\"\n    Given a case dict with keys:\n        L, Tg, Tw1, Tw2, k_gray, wsgg_weights, wsgg_kappas, ref_lines (list of (kappa, weight))\n    compute the relative errors for gray and WSGG vs LBL reference.\n    \"\"\"\n    L = case['L']\n    Tg = case['Tg']\n    Tw1 = case['Tw1']\n    Tw2 = case['Tw2']\n\n    # Reference (LBL) flux\n    ref_pairs = case['ref_lines']\n    ref_kappas = np.array([p[0] for p in ref_pairs], dtype=float)\n    ref_weights = np.array([p[1] for p in ref_pairs], dtype=float)\n    ref_weights = ref_weights / np.sum(ref_weights)\n    q_ref = wall_heat_flux(L, Tg, Tw1, Tw2, ref_kappas, ref_weights)\n\n    # Gray model\n    k_gray = case['k_gray']\n    q_gray = wall_heat_flux(L, Tg, Tw1, Tw2, np.array([k_gray], dtype=float), np.array([1.0], dtype=float))\n\n    # WSGG model (include clear gas group)\n    wsgg_kappas = np.array(case['wsgg_kappas'], dtype=float)\n    wsgg_weights = np.array(case['wsgg_weights'], dtype=float)\n    w_clear = 1.0 - np.sum(wsgg_weights)\n    # Append clear gas group\n    wsgg_kappas_full = np.concatenate((np.array([0.0], dtype=float), wsgg_kappas))\n    wsgg_weights_full = np.concatenate((np.array([w_clear], dtype=float), wsgg_weights))\n    # Normalize defensively to handle any small rounding\n    wsgg_weights_full = wsgg_weights_full / np.sum(wsgg_weights_full)\n    q_wsgg = wall_heat_flux(L, Tg, Tw1, Tw2, wsgg_kappas_full, wsgg_weights_full)\n\n    # Relative errors\n    denom = abs(q_ref) if abs(q_ref) > 0 else 1.0  # guard, though q_ref != 0 in these cases\n    e_gray = abs(q_gray - q_ref) / denom\n    e_wsgg = abs(q_wsgg - q_ref) / denom\n\n    return e_gray, e_wsgg\n\ndef format_float(x):\n    # Six significant digits; choose scientific notation to be consistent across magnitudes\n    return f\"{x:.6g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'L': 0.1,\n            'Tg': 1800.0,\n            'Tw1': 1600.0,\n            'Tw2': 1400.0,\n            'k_gray': 0.05,\n            'wsgg_kappas': [0.1, 0.5, 2.0, 10.0],\n            'wsgg_weights': [0.15, 0.15, 0.07, 0.03],  # sum 0.40, clear weight 0.60\n            'ref_lines': [(0.0, 0.55), (0.05, 0.20), (0.5, 0.15), (3.0, 0.07), (15.0, 0.03)],\n        },\n        {\n            'L': 1.0,\n            'Tg': 1800.0,\n            'Tw1': 1500.0,\n            'Tw2': 1200.0,\n            'k_gray': 0.3,\n            'wsgg_kappas': [0.02, 0.1, 0.5, 2.0],\n            'wsgg_weights': [0.20, 0.30, 0.35, 0.10],  # sum 0.95, clear weight 0.05\n            'ref_lines': [(0.0, 0.05), (0.02, 0.15), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20)],\n        },\n        {\n            'L': 3.0,\n            'Tg': 2000.0,\n            'Tw1': 1700.0,\n            'Tw2': 1300.0,\n            'k_gray': 0.7,\n            'wsgg_kappas': [0.1, 0.5, 2.0, 8.0],\n            'wsgg_weights': [0.25, 0.40, 0.25, 0.08],  # sum 0.98, clear weight 0.02\n            'ref_lines': [(0.0, 0.02), (0.01, 0.08), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20), (10.0, 0.10)],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        e_gray, e_wsgg = compute_errors_for_case(case)\n        results.extend([e_gray, e_wsgg])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(format_float(x) for x in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}