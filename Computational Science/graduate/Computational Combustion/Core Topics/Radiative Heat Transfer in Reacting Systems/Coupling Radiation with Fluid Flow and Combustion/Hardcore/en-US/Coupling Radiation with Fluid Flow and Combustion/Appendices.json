{
    "hands_on_practices": [
        {
            "introduction": "The spectral absorption coefficient $\\kappa_{\\lambda}$ of combustion gases like H2O and CO2 varies erratically with wavelength, making direct spectral integration of the Radiative Transfer Equation computationally prohibitive for most applications. To create tractable engineering models, we often use spectrally-averaged or \"mean\" absorption coefficients. This exercise  provides hands-on computational practice in calculating the Planck mean absorption coefficient $\\kappa_{P}$, which is weighted by the blackbody emission spectrum, from a physically-based spectral model. Mastering this is a fundamental step toward developing and understanding the gray and non-gray radiation models used throughout computational combustion.",
            "id": "4015090",
            "problem": "Consider a one-dimensional, non-scattering, participating gas medium consisting of water vapor and carbon dioxide, treated as isothermal at temperature $T = 1800\\,\\text{K}$ and at spatially uniform pressure $p$. The mixture-averaged spectral absorption coefficient is modeled as the sum of species contributions weighted by their mole fractions. The Planck mean absorption coefficient $\\kappa_{P}$ of the mixture is defined by the blackbody intensity weighting over wavelength according to\n$$\n\\kappa_{P}(T,p,\\chi_{\\text{H}_2\\text{O}},\\chi_{\\text{CO}_2}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\text{H}_2\\text{O}},\\chi_{\\text{CO}_2})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda},\n$$\nwhere $\\kappa_{\\lambda}$ is the mixture spectral absorption coefficient and $I_{\\lambda}^{b}(T)$ is the blackbody spectral intensity at temperature $T$. The blackbody spectral intensity per unit wavelength is given by Planck’s law, a fundamental law of thermal radiation:\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right),\n$$\nwith $h$ the Planck constant, $c$ the speed of light in vacuum, and $k_{B}$ the Boltzmann constant. Kirchhoff’s law of thermal radiation (for local thermodynamic equilibrium) ensures that emission and absorption are linked, justifying the use of $I_{\\lambda}^{b}(T)$ as the weighting function for defining $\\kappa_{P}$.\n\nAssume the following scientifically grounded parametric model for the mixture’s spectral absorption coefficient:\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\text{H}_2\\text{O}},\\chi_{\\text{CO}_2}) = \\chi_{\\text{H}_2\\text{O}} \\, A_{\\text{H}_2\\text{O}}(T,p) \\, g_{\\text{H}_2\\text{O}}(\\lambda) \\;+\\; \\chi_{\\text{CO}_2} \\, A_{\\text{CO}_2}(T,p) \\, g_{\\text{CO}_2}(\\lambda),\n$$\nwhere $\\chi_{\\text{H}_2\\text{O}}$ and $\\chi_{\\text{CO}_2}$ are the mole fractions of water vapor and carbon dioxide, respectively, $A_{i}(T,p)$ are species amplitude functions with units of inverse length, and $g_{i}(\\lambda)$ are unitless spectral shape functions representing the principal infrared bands. The amplitude functions scale with pressure and temperature as\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s},\n$$\nwith $p_{0} = 101325\\,\\text{Pa}$, $T_{0} = 1800\\,\\text{K}$, $s = 0.5$, and species baseline coefficients $\\alpha_{\\text{H}_2\\text{O}} = 4.0\\,\\text{m}^{-1}$, $\\alpha_{\\text{CO}_2} = 3.0\\,\\text{m}^{-1}$. The spectral shape functions are prescribed as sums of Gaussian bands:\n$$\ng_{\\text{H}_2\\text{O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\text{H}_2\\text{O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\text{H}_2\\text{O})}_{j}}{\\sigma^{(\\text{H}_2\\text{O})}_{j}}\\right)^{2} \\right),\n$$\nwith centers $\\lambda^{(\\text{H}_2\\text{O})}_{j} \\in \\{1.4\\times 10^{-6},\\, 2.7\\times 10^{-6},\\, 6.3\\times 10^{-6}\\}\\,\\text{m}$, weights $w^{(\\text{H}_2\\text{O})}_{j} \\in \\{0.5,\\, 0.3,\\, 0.2\\}$, and widths $\\sigma^{(\\text{H}_2\\text{O})}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.5\\times 10^{-6},\\, 1.2\\times 10^{-6}\\}\\,\\text{m}$. Similarly,\n$$\ng_{\\text{CO}_2}(\\lambda) = \\sum_{j=1}^{2} w^{(\\text{CO}_2)}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\text{CO}_2)}_{j}}{\\sigma^{(\\text{CO}_2)}_{j}}\\right)^{2} \\right),\n$$\nwith centers $\\lambda^{(\\text{CO}_2)}_{j} \\in \\{2.0\\times 10^{-6},\\, 4.3\\times 10^{-6}\\}\\,\\text{m}$, weights $w^{(\\text{CO}_2)}_{j} \\in \\{0.4,\\, 0.6\\}$, and widths $\\sigma^{(\\text{CO}_2)}_{j} \\in \\{0.4\\times 10^{-6},\\, 0.8\\times 10^{-6}\\}\\,\\text{m}$. The wavelength integration domain must be taken as $\\lambda \\in [2\\times 10^{-7},\\, 2\\times 10^{-5}]\\,\\text{m}$ to cover the relevant thermal spectrum at $T = 1800\\,\\text{K}$.\n\nDefine the optical thickness as\n$$\n\\tau = \\kappa_{P} \\, L,\n$$\nwhere $L$ is the medium thickness. In the context of gray approximations, regimes with $\\tau$ of order unity indicate neither optically thin nor optically thick behavior; a practical criterion for assessing gray-model applicability (without scattering and with dominant emission-absorption coupling) is\n$$\n\\text{gray\\_ok} = \\begin{cases}\n\\text{true}, & \\text{if } 0.3 \\le \\tau \\le 3.0,\\\\\n\\text{false}, & \\text{otherwise}.\n\\end{cases}\n$$\n\nTasks:\n- Compute $\\kappa_{P}$ and $\\tau$ for each test case below, using the definitions and models above.\n- Express $\\kappa_{P}$ in $\\text{m}^{-1}$ and $\\tau$ as a dimensionless quantity, both rounded to six decimal places.\n- For each test case, also output $\\text{gray\\_ok}$ as either the lowercase string $\\,\\text{true}\\,$ or $\\,\\text{false}\\,$.\n- Your program must carry out the wavelength integrations numerically over the specified domain.\n\nTest Suite:\n1. Case $1$: $T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\text{H}_2\\text{O}} = 0.10$, $\\chi_{\\text{CO}_2} = 0.10$, $L = 2.0\\,\\text{m}$.\n2. Case $2$: $T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\text{H}_2\\text{O}} = 0.00$, $\\chi_{\\text{CO}_2} = 0.20$, $L = 1.0\\,\\text{m}$.\n3. Case $3$: $T = 1800\\,\\text{K}$, $p = 5.0\\,\\text{atm}$, $\\chi_{\\text{H}_2\\text{O}} = 0.20$, $\\chi_{\\text{CO}_2} = 0.10$, $L = 1.0\\,\\text{m}$.\n4. Case $4$ (edge case, transparent medium): $T = 1800\\,\\text{K}$, $p = 1.0\\,\\text{atm}$, $\\chi_{\\text{H}_2\\text{O}} = 0.00$, $\\chi_{\\text{CO}_2} = 0.00$, $L = 1.0\\,\\text{m}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list of per-case results. Each per-case result must be a three-element list of the form $[\\kappa_{P}, \\tau, \\text{gray\\_ok}]$ with no spaces, where $\\kappa_{P}$ is in $\\text{m}^{-1}$, $\\tau$ is dimensionless, both rounded to six decimal places, and $\\text{gray\\_ok}$ is the lowercase string $\\,\\text{true}\\,$ or $\\,\\text{false}\\,$. The overall output must be a comma-separated list of these per-case lists, enclosed in square brackets. For example, the format is $[[0.123456,0.654321,true],[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The problem requires the calculation of the Planck mean absorption coefficient, $\\kappa_{P}$, for a gas mixture of water vapor and carbon dioxide at specified thermodynamic conditions. From this, the optical thickness $\\tau$ and a gray-model applicability criterion are to be determined for several test cases.\n\nThe Planck mean absorption coefficient $\\kappa_{P}$ is defined as the spectral absorption coefficient $\\kappa_{\\lambda}$ weighted by the blackbody spectral intensity $I_{\\lambda}^{b}(T)$ and normalized by the total blackbody intensity. The formula is:\n$$\n\\kappa_{P}(T,p,\\chi_{\\text{H}_2\\text{O}},\\chi_{\\text{CO}_2}) = \\frac{\\int_{0}^{\\infty} \\kappa_{\\lambda}(T,p,\\chi_{\\text{H}_2\\text{O}},\\chi_{\\text{CO}_2})\\, I_{\\lambda}^{b}(T)\\, d\\lambda}{\\int_{0}^{\\infty} I_{\\lambda}^{b}(T)\\, d\\lambda}\n$$\nFor numerical computation, the infinite integration domain is replaced by the specified range $\\lambda \\in [2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$, which captures the vast majority of the blackbody emissive power at the given temperature of $T=1800\\,\\text{K}$. Let the numerator be $N$ and the denominator be $D$.\n$$\nN = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} \\kappa_{\\lambda}(T,p,\\chi_{\\text{H}_2\\text{O}},\\chi_{\\text{CO}_2})\\, I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\n$$\nD = \\int_{2\\times 10^{-7}}^{2\\times 10^{-5}} I_{\\lambda}^{b}(T)\\, d\\lambda\n$$\nThen, $\\kappa_{P} = N/D$. The blackbody spectral intensity $I_{\\lambda}^{b}(T)$ is given by Planck's law:\n$$\nI_{\\lambda}^{b}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\nThe constant prefactor $2 h c^{2}$ appears in both the numerator $N$ and the denominator $D$ integrals and can thus be canceled out. This is advantageous for numerical computation, as it avoids handling very large or very small numbers. We can therefore use a simplified weighting function proportional to $I_{\\lambda}^{b}(T)$:\n$$\nw(\\lambda, T) = \\frac{1}{\\lambda^{5}} \\left( \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1} \\right)\n$$\n\nThe mixture spectral absorption coefficient $\\kappa_{\\lambda}$ is modeled as a linear combination of contributions from each species:\n$$\n\\kappa_{\\lambda}(T,p,\\chi_{\\text{H}_2\\text{O}},\\chi_{\\text{CO}_2}) = \\chi_{\\text{H}_2\\text{O}} \\, A_{\\text{H}_2\\text{O}}(T,p) \\, g_{\\text{H}_2\\text{O}}(\\lambda) \\;+\\; \\chi_{\\text{CO}_2} \\, A_{\\text{CO}_2}(T,p) \\, g_{\\text{CO}_2}(\\lambda)\n$$\nThe amplitude function $A_{i}$ for each species $i \\in \\{\\text{H}_2\\text{O}, \\text{CO}_2\\}$ depends on pressure $p$ and temperature $T$:\n$$\nA_{i}(T,p) = \\alpha_{i} \\left(\\frac{p}{p_{0}}\\right) \\left(\\frac{T}{T_{0}}\\right)^{s}\n$$\nwith given parameters $\\alpha_{i}$, $p_{0} = 101325\\,\\text{Pa}$, $T_{0} = 1800\\,\\text{K}$, and $s = 0.5$. Note that for all test cases, $T = T_0$, so the term $\\left(T/T_{0}\\right)^{s}$ is always equal to $1$. Pressure must be converted from atmospheres to Pascals using $1\\,\\text{atm} = 101325\\,\\text{Pa}$.\n\nThe spectral shape functions $g_{i}(\\lambda)$ are modeled as a sum of Gaussian functions, representing absorption bands:\n$$\ng_{\\text{H}_2\\text{O}}(\\lambda) = \\sum_{j=1}^{3} w^{(\\text{H}_2\\text{O})}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\text{H}_2\\text{O})}_{j}}{\\sigma^{(\\text{H}_2\\text{O})}_{j}}\\right)^{2} \\right)\n$$\n$$\ng_{\\text{CO}_2}(\\lambda) = \\sum_{j=1}^{2} w^{(\\text{CO}_2)}_{j} \\exp\\!\\left( - \\left(\\frac{\\lambda - \\lambda^{(\\text{CO}_2)}_{j}}{\\sigma^{(\\text{CO}_2)}_{j}}\\right)^{2} \\right)\n$$\nThe parameters for these Gaussians (weights $w_j$, centers $\\lambda_j$, and widths $\\sigma_j$) are provided in the problem statement.\n\nThe algorithmic procedure for each test case is as follows:\n1.  Establish the case-specific parameters: $T$, $p$ (in atm), $\\chi_{\\text{H}_2\\text{O}}$, $\\chi_{\\text{CO}_2}$, and $L$. The temperature $T=1800\\,\\text{K}$ is constant for all cases.\n2.  Calculate the amplitude functions $A_{\\text{H}_2\\text{O}}$ and $A_{\\text{CO}_2}$ using the given model, making sure to use pressure in Pascals.\n3.  Construct the function for the spectral absorption coefficient $\\kappa_{\\lambda}(\\lambda)$ using the calculated amplitudes and the predefined spectral shape functions $g_{\\text{H}_2\\text{O}}(\\lambda)$ and $g_{\\text{CO}_2}(\\lambda)$.\n4.  Define the numerator integrand, $\\kappa_{\\lambda}(\\lambda) w(\\lambda, T)$, and the denominator integrand, $w(\\lambda, T)$.\n5.  Numerically evaluate the integrals $N$ and $D$ over the wavelength range $[2\\times 10^{-7}, 2\\times 10^{-5}]\\,\\text{m}$. A high-quality numerical quadrature routine, such as `scipy.integrate.quad`, is suitable for this task. For the special case where both mole fractions $\\chi_{\\text{H}_2\\text{O}}$ and $\\chi_{\\text{CO}_2}$ are zero, $\\kappa_{\\lambda}$ is identically zero, making the numerator $N=0$ and thus $\\kappa_{P}=0$ without need for integration.\n6.  Compute the Planck mean absorption coefficient: $\\kappa_{P} = N/D$.\n7.  Calculate the optical thickness: $\\tau = \\kappa_{P} \\, L$.\n8.  Apply the given criterion to determine the value of $\\text{gray\\_ok}$: it is $\\text{true}$ if $0.3 \\le \\tau \\le 3.0$, and $\\text{false}$ otherwise.\n9.  Format the calculated values ($\\kappa_P$ and $\\tau$ rounded to six decimal places, and the lowercase string for $\\text{gray\\_ok}$) as required.\n\nThis procedure is implemented for each test case provided in the problem statement to generate the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Calculates the Planck mean absorption coefficient, optical thickness,\n    and a gray-model applicability metric for a gas mixture.\n    \"\"\"\n    \n    # Define physical constants from SciPy\n    h = constants.h  # Planck constant (J.s)\n    c = constants.c  # Speed of light in vacuum (m/s)\n    k = constants.k  # Boltzmann constant (J/K)\n\n    # Define model parameters from the problem statement\n    # Reference conditions\n    p0 = 101325.0  # Reference pressure in Pa\n    T0 = 1800.0   # Reference temperature in K\n    s = 0.5       # Temperature exponent\n\n    # Species baseline coefficients\n    alpha_h2o = 4.0  # m^-1\n    alpha_co2 = 3.0  # m^-1\n\n    # Integration wavelength range\n    WAV_MIN, WAV_MAX = 2e-7, 2e-5 # m\n\n    # Spectral shape function parameters for H2O\n    H2O_BANDS = {\n        'weights': np.array([0.5, 0.3, 0.2]),\n        'centers': np.array([1.4e-6, 2.7e-6, 6.3e-6]),\n        'widths': np.array([0.4e-6, 0.5e-6, 1.2e-6])\n    }\n\n    # Spectral shape function parameters for CO2\n    CO2_BANDS = {\n        'weights': np.array([0.4, 0.6]),\n        'centers': np.array([2.0e-6, 4.3e-6]),\n        'widths': np.array([0.4e-6, 0.8e-6])\n    }\n\n    def planck_weight_function(wav, T):\n        \"\"\"\n        Calculates the wavelength-dependent part of the Planck function,\n        omitting the 2*h*c^2 constant which cancels out.\n        \"\"\"\n        C2_over_T = h * c / (k * T)\n        exponent = C2_over_T / wav\n        # np.exp(709.78) is a typical double-precision float limit\n        if exponent > 700:\n            return 0.0\n        return (1.0 / wav**5) / (np.exp(exponent) - 1.0)\n\n    def g_h2o(wav):\n        \"\"\"Calculates the spectral shape function for H2O.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(H2O_BANDS['weights'], H2O_BANDS['centers'], H2O_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def g_co2(wav):\n        \"\"\"Calculates the spectral shape function for CO2.\"\"\"\n        val = 0.0\n        for w, center, sigma in zip(CO2_BANDS['weights'], CO2_BANDS['centers'], CO2_BANDS['widths']):\n            val += w * np.exp(-((wav - center) / sigma)**2)\n        return val\n\n    def calculate_k_p(T, p_atm, chi_h2o, chi_co2):\n        \"\"\"Calculates the Planck mean absorption coefficient.\"\"\"\n        # Handle the transparent medium case directly for efficiency and correctness.\n        if chi_h2o == 0.0 and chi_co2 == 0.0:\n            return 0.0\n\n        p_pa = p_atm * 101325.0\n        \n        # Calculate amplitude functions A_i\n        A_h2o = alpha_h2o * (p_pa / p0) * (T / T0)**s\n        A_co2 = alpha_co2 * (p_pa / p0) * (T / T0)**s\n\n        def kappa_lambda(wav):\n            \"\"\"Calculates the mixture spectral absorption coefficient.\"\"\"\n            return chi_h2o * A_h2o * g_h2o(wav) + chi_co2 * A_co2 * g_co2(wav)\n        \n        # Numerator integral: integral(kappa_lambda * I_lambda^b * d_lambda)\n        # We use planck_weight_function since the 2hc^2 constant cancels.\n        num_integrand = lambda wav: kappa_lambda(wav) * planck_weight_function(wav, T)\n        numerator, _ = integrate.quad(num_integrand, WAV_MIN, WAV_MAX)\n        \n        # Denominator integral: integral(I_lambda^b * d_lambda)\n        den_integrand = lambda wav: planck_weight_function(wav, T)\n        denominator, _ = integrate.quad(den_integrand, WAV_MIN, WAV_MAX)\n\n        if denominator == 0:\n            return 0.0\n        \n        return numerator / denominator\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T [K], p [atm], chi_H2O, chi_CO2, L [m])\n        (1800.0, 1.0, 0.10, 0.10, 2.0),\n        (1800.0, 1.0, 0.00, 0.20, 1.0),\n        (1800.0, 5.0, 0.20, 0.10, 1.0),\n        (1800.0, 1.0, 0.00, 0.00, 1.0),\n    ]\n\n    results_str_list = []\n    for T_case, p_case, chi_h2o_case, chi_co2_case, L_case in test_cases:\n        kappa_p = calculate_k_p(T_case, p_case, chi_h2o_case, chi_co2_case)\n        tau = kappa_p * L_case\n        gray_ok = \"true\" if 0.3 <= tau <= 3.0 else \"false\"\n        \n        # Format the result for this case as a string \"[k_p,tau,gray_ok]\"\n        case_result_str = f\"[{kappa_p:.6f},{tau:.6f},{gray_ok}]\"\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once mean absorption coefficients are determined, we can construct radiation models of varying complexity, from the simple gray gas model to the more accurate Weighted-Sum-of-Gray-Gases (WSGG) model. The choice of model always involves a trade-off between computational expense and predictive accuracy. This practice  allows you to quantitatively assess this trade-off by comparing the performance of these common models against a high-fidelity Line-By-Line (LBL) benchmark. By calculating the relative error in wall heat flux for a canonical furnace problem, you will gain a practical appreciation for the strengths and limitations of different spectral modeling strategies.",
            "id": "4015147",
            "problem": "Consider a one-dimensional, plane-parallel, isothermal participating gas layer of thickness $L$ bounded by two black, isothermal walls at temperatures $T_{w,1}$ and $T_{w,2}$. The gas is at a uniform temperature $T_g$, absorbs and emits but does not scatter radiation. Let the local spectral intensity $I_\\nu(s,\\mu)$ satisfy the Radiative Transfer Equation (RTE) for a non-scattering medium, expressed along a ray with direction cosine $\\mu \\in [-1,1]$ with respect to the outward normal of wall $1$:\n$$\n\\frac{d I_\\nu}{ds} = -\\kappa_\\nu I_\\nu + \\kappa_\\nu I_{b,\\nu}(T_g),\n$$\nwhere $\\kappa_\\nu$ is the spectral absorption coefficient with units $\\mathrm{m}^{-1}$, $s$ is the path length coordinate with units $\\mathrm{m}$, and $I_{b,\\nu}(T)$ is the spectral blackbody intensity at temperature $T$. The boundary conditions at the black walls are $I_\\nu(0,\\mu > 0) = I_{b,\\nu}(T_{w,1})$ for radiation leaving wall $1$ into the medium and $I_\\nu(L,\\mu < 0) = I_{b,\\nu}(T_{w,2})$ for radiation leaving wall $2$ into the medium.\n\nDefine the hemispherical incident radiation on wall $1$ (irradiation onto wall $1$) as\n$$\nH_1 = \\int_{\\Omega^-} I(\\mathbf{x}_w,\\mathbf{s}) \\, \\left|\\mathbf{s}\\cdot \\mathbf{n}\\right| \\, d\\Omega,\n$$\nwhere $\\Omega^-$ denotes the incoming hemisphere relative to wall $1$, $\\mathbf{n}$ is the outward unit normal of wall $1$ (into the gas), and $I(\\mathbf{x}_w,\\mathbf{s})$ is the frequency-integrated intensity at the wall location $\\mathbf{x}_w$ along direction $\\mathbf{s}$. For a black wall, the net radiative heat flux leaving wall $1$ into the gas is\n$$\nq''_1 = \\sigma T_{w,1}^4 - H_1,\n$$\nwhere $\\sigma$ is the Stefan–Boltzmann constant with value $\\sigma = 5.670374419\\times 10^{-8} \\,\\mathrm{W\\, m^{-2}\\, K^{-4}}$.\n\nIn practical computational combustion simulations of methane–air furnaces, spectral models are required. Three models are considered here for the spectral absorption:\n\n1. A gray model using a single, effective absorption coefficient $\\kappa_{\\text{gray}}$ (units $\\mathrm{m}^{-1}$).\n2. A four-group Weighted Sum of Gray Gases (WSGG) model, specified by four absorption coefficients $\\kappa_i$ and corresponding nonnegative weights $w_i$ for $i \\in \\{1,2,3,4\\}$. The clear-gas weight is $w_0 = 1 - \\sum_{i=1}^{4} w_i$ and corresponds to $\\kappa_0 = 0$.\n3. A line-by-line (LBL) reference provided as a discrete set of spectral lines or bands with absorption coefficients $\\kappa_j$ and weights $W_j$ for $j \\in \\{1,\\dots,N\\}$, where $\\sum_{j=1}^N W_j = 1$ and some entries may have $\\kappa_j = 0$ to represent transparent windows.\n\nAll models adopt the following physically consistent base:\n- The frequency-integrated blackbody intensity is $I_b(T) = \\sigma T^4 / \\pi$ with units $\\mathrm{W\\, m^{-2}\\, sr^{-1}}$.\n- For a given spectral subset with absorption coefficient $\\kappa$, along a ray directed toward wall $1$ from the interior and originating at wall $2$, the formal solution of the RTE in an isothermal, homogeneous medium yields an incoming intensity at wall $1$ that depends on $\\kappa$, the opposite wall intensity, and the gas emission along the path.\n- The incident radiation $H_1$ is computed by integrating the incoming intensity over the hemisphere, i.e., over all directions with direction cosine $\\mu \\in (0,1)$ relative to the wall-normal.\n\nYour task is to write a program that, for each test case specified below, computes:\n- The LBL reference wall heat flux $q''_{1,\\mathrm{LBL}}$ using the provided $\\{\\kappa_j, W_j\\}_{j=1}^N$.\n- The gray-model wall heat flux $q''_{1,\\mathrm{gray}}$ using $\\kappa_{\\text{gray}}$.\n- The four-group WSGG wall heat flux $q''_{1,\\mathrm{WSGG}}$ using the set $\\{(\\kappa_i, w_i)\\}_{i=1}^4$ augmented with the clear-gas group $(\\kappa_0=0, w_0)$.\n\nThen, for each test case, compute two error metrics relative to the LBL reference:\n- The gray-model relative error $e_{\\mathrm{gray}} = \\left| q''_{1,\\mathrm{gray}} - q''_{1,\\mathrm{LBL}} \\right| / \\left| q''_{1,\\mathrm{LBL}} \\right|$.\n- The WSGG relative error $e_{\\mathrm{WSGG}} = \\left| q''_{1,\\mathrm{WSGG}} - q''_{1,\\mathrm{LBL}} \\right| / \\left| q''_{1,\\mathrm{LBL}} \\right|$.\n\nAll physical units must be respected:\n- Length $L$ in $\\mathrm{m}$.\n- Absorption coefficients $\\kappa$ in $\\mathrm{m}^{-1}$.\n- Temperature in $\\mathrm{K}$.\n- Heat flux $q''$ in $\\mathrm{W\\, m^{-2}}$.\n\nAngle integration must be performed over the incoming hemisphere in radians.\n\nImplement the above consistently with the RTE and the stated modeling assumptions, starting from the fundamental laws and definitions. Do not introduce any closure or formula that contradicts the non-scattering, isothermal, plane-parallel assumption.\n\nTest Suite:\nProvide results for the following three test cases, each expressed as a tuple of parameters. Within each case, the line-by-line set is a list of pairs $(\\kappa_j, W_j)$.\n\n- Case $1$ (optically thin tendency):\n  - $L = 0.1 \\,\\mathrm{m}$, $T_g = 1800 \\,\\mathrm{K}$, $T_{w,1} = 1600 \\,\\mathrm{K}$, $T_{w,2} = 1400 \\,\\mathrm{K}$.\n  - Gray: $\\kappa_{\\text{gray}} = 0.05 \\,\\mathrm{m}^{-1}$.\n  - Four-group WSGG: $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.1, 0.15), (0.5, 0.15), (2.0, 0.07), (10.0, 0.03)\\}$, clear-gas weight $w_0 = 0.60$.\n  - LBL set $\\{(\\kappa_j, W_j)\\}_{j=1}^{5} = \\{(0.0, 0.55), (0.05, 0.20), (0.5, 0.15), (3.0, 0.07), (15.0, 0.03)\\}$.\n\n- Case $2$ (moderate optical thickness):\n  - $L = 1.0 \\,\\mathrm{m}$, $T_g = 1800 \\,\\mathrm{K}$, $T_{w,1} = 1500 \\,\\mathrm{K}$, $T_{w,2} = 1200 \\,\\mathrm{K}$.\n  - Gray: $\\kappa_{\\text{gray}} = 0.3 \\,\\mathrm{m}^{-1}$.\n  - Four-group WSGG: $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.02, 0.20), (0.1, 0.30), (0.5, 0.35), (2.0, 0.10)\\}$, clear-gas weight $w_0 = 0.05$.\n  - LBL set $\\{(\\kappa_j, W_j)\\}_{j=1}^{5} = \\{(0.0, 0.05), (0.02, 0.15), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20)\\}$.\n\n- Case $3$ (optically thick tendency):\n  - $L = 3.0 \\,\\mathrm{m}$, $T_g = 2000 \\,\\mathrm{K}$, $T_{w,1} = 1700 \\,\\mathrm{K}$, $T_{w,2} = 1300 \\,\\mathrm{K}$.\n  - Gray: $\\kappa_{\\text{gray}} = 0.7 \\,\\mathrm{m}^{-1}$.\n  - Four-group WSGG: $\\{(\\kappa_i, w_i)\\}_{i=1}^4 = \\{(0.1, 0.25), (0.5, 0.40), (2.0, 0.25), (8.0, 0.08)\\}$, clear-gas weight $w_0 = 0.02$.\n  - LBL set $\\{(\\kappa_j, W_j)\\}_{j=1}^{6} = \\{(0.0, 0.02), (0.01, 0.08), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20), (10.0, 0.10)\\}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the six error values in the order\n$$\n[e_{\\mathrm{gray},1}, e_{\\mathrm{WSGG},1}, e_{\\mathrm{gray},2}, e_{\\mathrm{WSGG},2}, e_{\\mathrm{gray},3}, e_{\\mathrm{WSGG},3}],\n$$\nas a comma-separated list enclosed in square brackets. Each entry must be a decimal number rounded to six significant digits (scientific or fixed-point notation is acceptable). The unitless errors must be expressed as decimals (do not use a percentage sign).",
            "solution": "We start from the Radiative Transfer Equation (RTE) for a non-scattering, isothermal medium in a plane-parallel slab. Let the gas be homogeneous with absorption coefficient $\\kappa$ and temperature $T_g$, bounded by black walls at $x=0$ (wall $1$) with temperature $T_{w,1}$ and $x=L$ (wall $2$) with temperature $T_{w,2}$. The direction cosine relative to the outward normal of wall $1$ is $\\mu = \\cos\\theta \\in [-1,1]$.\n\nThe spectral RTE along a ray is\n$$\n\\frac{d I_\\nu(x,\\mu)}{ds} = -\\kappa_\\nu I_\\nu(x,\\mu) + \\kappa_\\nu I_{b,\\nu}(T_g),\n$$\nwith the formal solution for the intensity impinging on wall $1$ from the interior along directions incoming to wall $1$ (i.e., with direction cosine magnitude $\\mu \\in (0,1)$ measured into the slab from wall $1$) obtained by integrating from the opposite boundary at $x=L$ toward $x=0$ along a path of length $L/\\mu$:\n$$\nI_\\nu(0, -\\mu) = I_{b,\\nu}(T_{w,2}) \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right) + \\int_{0}^{L/\\mu} \\kappa_\\nu I_{b,\\nu}(T_g) \\exp\\!\\left[-\\kappa_\\nu s\\right] \\, ds.\n$$\nBecause the gas is isothermal, $I_{b,\\nu}(T_g)$ is constant along the path, and the integral evaluates to\n$$\n\\int_{0}^{L/\\mu} \\kappa_\\nu I_{b,\\nu}(T_g) \\exp(-\\kappa_\\nu s)\\, ds = I_{b,\\nu}(T_g)\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right)\\right].\n$$\nTherefore, the incoming spectral intensity at wall $1$ is\n$$\nI_\\nu(0, -\\mu) = I_{b,\\nu}(T_{w,2}) \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right) + I_{b,\\nu}(T_g)\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\nu L}{\\mu}\\right)\\right].\n$$\n\nTo obtain the frequency-integrated intensity, we integrate over all spectral subsets. For models that discretize spectrum into $M$ groups indexed by $m$ with absorption coefficient $\\kappa_m$ and weight $w_m$ satisfying $\\sum_{m=1}^M w_m = 1$, assuming each group behaves as a gray gas over its weight with $I_b(T) = \\sigma T^4/\\pi$, the incoming group-averaged intensity is\n$$\nI_m(0, -\\mu) = \\frac{\\sigma T_{w,2}^4}{\\pi} \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) + \\frac{\\sigma T_g^4}{\\pi} \\left[1 - \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right)\\right].\n$$\nFor a clear-gas group with $\\kappa=0$, this reduces to $I_{\\text{clear}}(0,-\\mu) = \\frac{\\sigma T_{w,2}^4}{\\pi}$ and emits nothing.\n\nThe hemispherical incident radiation on wall $1$ is the integral over the incoming hemisphere:\n$$\nH_1 = \\int_{\\Omega^-} I(\\mathbf{x}_w,\\mathbf{s}) \\left|\\mathbf{s}\\cdot\\mathbf{n}\\right| d\\Omega = 2\\pi \\int_{0}^{1} \\left[ \\sum_{m=1}^{M} w_m \\, I_m(0,-\\mu) \\right] \\mu \\, d\\mu,\n$$\nwhere axial symmetry about the wall normal allows reduction to a one-dimensional integral in $\\mu$ with the factor $2\\pi$.\n\nUsing the black-wall radiosity-emissive power identity for a black wall, the net radiative heat flux leaving wall $1$ is\n$$\nq''_1 = \\sigma T_{w,1}^4 - H_1.\n$$\n\nWe now map this framework to each model:\n- For the gray model, there is a single group with $M=1$, $w_1=1$, and $\\kappa_1 = \\kappa_{\\text{gray}}$.\n- For the four-group Weighted Sum of Gray Gases (WSGG), there are five effective groups including the clear gas: $M=5$ with $\\kappa_0 = 0$, $w_0 = 1 - \\sum_{i=1}^4 w_i$, and $\\{(\\kappa_i,w_i)\\}_{i=1}^4$ as specified.\n- For the line-by-line (LBL) reference, the discrete lines or bands are directly used as the groups: $M=N$, $\\kappa_m = \\kappa_j$, $w_m = W_j$.\n\nAlgorithmic steps for each test case are:\n1. Compute $I_b(T) = \\sigma T^4 / \\pi$ for $T=T_g$ and $T=T_{w,2}$.\n2. Define the integrand for the incident radiation:\n   $$\n   \\Phi(\\mu) = \\mu \\sum_{m=1}^{M} w_m \\left[ \\frac{\\sigma T_{w,2}^4}{\\pi} \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) + \\frac{\\sigma T_g^4}{\\pi} \\left( 1 - \\exp\\!\\left(-\\frac{\\kappa_m L}{\\mu}\\right) \\right) \\right].\n   $$\n3. Numerically evaluate $H_1 = 2\\pi \\int_0^1 \\Phi(\\mu) \\, d\\mu$ using adaptive quadrature in $\\mu \\in (0,1)$; the integrand is well-behaved because as $\\mu \\to 0^+$, the factor $\\mu$ multiplies an exponentially small term, ensuring integrability.\n4. Compute $q''_1 = \\sigma T_{w,1}^4 - H_1$.\n5. Apply the above for the LBL set to obtain $q''_{1,\\mathrm{LBL}}$, for the gray set to obtain $q''_{1,\\mathrm{gray}}$, and for the WSGG set (including the clear-gas group) to obtain $q''_{1,\\mathrm{WSGG}}$.\n6. Compute the relative errors:\n   $$\n   e_{\\mathrm{gray}} = \\frac{\\left| q''_{1,\\mathrm{gray}} - q''_{1,\\mathrm{LBL}} \\right|}{\\left| q''_{1,\\mathrm{LBL}} \\right|}, \\quad\n   e_{\\mathrm{WSGG}} = \\frac{\\left| q''_{1,\\mathrm{WSGG}} - q''_{1,\\mathrm{LBL}} \\right|}{\\left| q''_{1,\\mathrm{LBL}} \\right|}.\n   $$\n\nUnits are preserved at each step: $I_b$ is in $\\mathrm{W\\, m^{-2}\\, sr^{-1}}$, the angular integration produces $\\mathrm{W\\, m^{-2}}$, and $q''_1$ is in $\\mathrm{W\\, m^{-2}}$. The dimensionless errors are reported as decimals.\n\nFor the test suite:\n- Case $1$ features small optical thickness factors $\\kappa L$ across many groups, approaching the limiting behavior where transmission dominates and $q''_1 \\to \\sigma (T_{w,1}^4 - T_{w,2}^4)$.\n- Case $2$ exhibits moderate optical thickness, balancing gas self-emission and wall-to-wall transmission.\n- Case $3$ is optically thick across most groups, approaching the diffusion-like limit where $H_1 \\to \\sigma T_g^4$ and $q''_1 \\to \\sigma (T_{w,1}^4 - T_g^4)$.\n\nNumerical considerations:\n- The integrand $\\Phi(\\mu)$ is smooth on $(0,1]$ and tends to $0$ as $\\mu \\to 0^+$ for finite $\\kappa L$ because $\\mu \\exp(-\\kappa L/\\mu) \\to 0$ faster than any algebraic rate.\n- Adaptive quadrature (for example, Gauss–Kronrod via an implementation of $\\int_0^1$) with absolute and relative tolerances on the order of $10^{-10}$ ensures accuracy.\n\nThe program implements these steps for the three specified cases and prints a single line containing the six errors $[e_{\\mathrm{gray},1}, e_{\\mathrm{WSGG},1}, e_{\\mathrm{gray},2}, e_{\\mathrm{WSGG},2}, e_{\\mathrm{gray},3}, e_{\\mathrm{WSGG},3}]$, each rounded to six significant digits.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Stefan–Boltzmann constant (W/m^2/K^4)\nSIGMA = 5.670374419e-8\n\ndef blackbody_intensity(T):\n    \"\"\"Frequency-integrated blackbody intensity Ib = sigma*T^4/pi (W/m^2/sr).\"\"\"\n    return SIGMA * (T ** 4) / np.pi\n\ndef incident_radiation_on_wall(L, Tg, Tw2, kappas, weights):\n    \"\"\"\n    Compute hemispherical incident radiation H1 on wall 1 due to the gas and wall 2\n    for a set of spectral groups with absorption coefficients 'kappas' (1/m)\n    and corresponding weights 'weights' (sum to 1).\n    \"\"\"\n    Ib_g = blackbody_intensity(Tg)\n    Ib_w2 = blackbody_intensity(Tw2)\n\n    # Define integrand in mu for H1 = 2*pi * integral_0^1 [ Phi(mu) dmu ]\n    def phi(mu):\n        # Avoid mu=0 exactly; quad won't evaluate at endpoints by default.\n        # Contribution for each group m: w_m * [ Ib_w2 * exp(-kappa_m*L/mu) + Ib_g*(1 - exp(...)) ]\n        # Multiply by mu for projection.\n        s = 0.0\n        for kappa, w in zip(kappas, weights):\n            if kappa == 0.0:\n                # Clear gas: exp(0)=1, emission term zero\n                term = Ib_w2\n            else:\n                att = np.exp(- (kappa * L) / mu)\n                term = Ib_w2 * att + Ib_g * (1.0 - att)\n            s += w * term\n        return mu * s\n\n    # Perform the angular integration\n    H1, _ = quad(phi, 0.0, 1.0, epsabs=1e-10, epsrel=1e-10, limit=200)\n    H1 *= 2.0 * np.pi\n    return H1\n\ndef wall_heat_flux(L, Tg, Tw1, Tw2, kappas, weights):\n    \"\"\"Compute net radiative heat flux leaving wall 1: q1'' = sigma*Tw1^4 - H1.\"\"\"\n    H1 = incident_radiation_on_wall(L, Tg, Tw2, kappas, weights)\n    q = SIGMA * (Tw1 ** 4) - H1\n    return q\n\ndef compute_errors_for_case(case):\n    \"\"\"\n    Given a case dict with keys:\n        L, Tg, Tw1, Tw2, k_gray, wsgg_weights, wsgg_kappas, ref_lines (list of (kappa, weight))\n    compute the relative errors for gray and WSGG vs LBL reference.\n    \"\"\"\n    L = case['L']\n    Tg = case['Tg']\n    Tw1 = case['Tw1']\n    Tw2 = case['Tw2']\n\n    # Reference (LBL) flux\n    ref_pairs = case['ref_lines']\n    ref_kappas = np.array([p[0] for p in ref_pairs], dtype=float)\n    ref_weights = np.array([p[1] for p in ref_pairs], dtype=float)\n    ref_weights = ref_weights / np.sum(ref_weights)\n    q_ref = wall_heat_flux(L, Tg, Tw1, Tw2, ref_kappas, ref_weights)\n\n    # Gray model\n    k_gray = case['k_gray']\n    q_gray = wall_heat_flux(L, Tg, Tw1, Tw2, np.array([k_gray], dtype=float), np.array([1.0], dtype=float))\n\n    # WSGG model (include clear gas group)\n    wsgg_kappas = np.array(case['wsgg_kappas'], dtype=float)\n    wsgg_weights = np.array(case['wsgg_weights'], dtype=float)\n    w_clear = 1.0 - np.sum(wsgg_weights)\n    # Append clear gas group\n    wsgg_kappas_full = np.concatenate((np.array([0.0], dtype=float), wsgg_kappas))\n    wsgg_weights_full = np.concatenate((np.array([w_clear], dtype=float), wsgg_weights))\n    # Normalize defensively to handle any small rounding\n    wsgg_weights_full = wsgg_weights_full / np.sum(wsgg_weights_full)\n    q_wsgg = wall_heat_flux(L, Tg, Tw1, Tw2, wsgg_kappas_full, wsgg_weights_full)\n\n    # Relative errors\n    denom = abs(q_ref) if abs(q_ref) > 0 else 1.0  # guard, though q_ref != 0 in these cases\n    e_gray = abs(q_gray - q_ref) / denom\n    e_wsgg = abs(q_wsgg - q_ref) / denom\n\n    return e_gray, e_wsgg\n\ndef format_float(x):\n    # Six significant digits; choose scientific notation to be consistent across magnitudes\n    return f\"{x:.6g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'L': 0.1,\n            'Tg': 1800.0,\n            'Tw1': 1600.0,\n            'Tw2': 1400.0,\n            'k_gray': 0.05,\n            'wsgg_kappas': [0.1, 0.5, 2.0, 10.0],\n            'wsgg_weights': [0.15, 0.15, 0.07, 0.03],  # sum 0.40, clear weight 0.60\n            'ref_lines': [(0.0, 0.55), (0.05, 0.20), (0.5, 0.15), (3.0, 0.07), (15.0, 0.03)],\n        },\n        {\n            'L': 1.0,\n            'Tg': 1800.0,\n            'Tw1': 1500.0,\n            'Tw2': 1200.0,\n            'k_gray': 0.3,\n            'wsgg_kappas': [0.02, 0.1, 0.5, 2.0],\n            'wsgg_weights': [0.20, 0.30, 0.35, 0.10],  # sum 0.95, clear weight 0.05\n            'ref_lines': [(0.0, 0.05), (0.02, 0.15), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20)],\n        },\n        {\n            'L': 3.0,\n            'Tg': 2000.0,\n            'Tw1': 1700.0,\n            'Tw2': 1300.0,\n            'k_gray': 0.7,\n            'wsgg_kappas': [0.1, 0.5, 2.0, 8.0],\n            'wsgg_weights': [0.25, 0.40, 0.25, 0.08],  # sum 0.98, clear weight 0.02\n            'ref_lines': [(0.0, 0.02), (0.01, 0.08), (0.1, 0.25), (0.5, 0.35), (2.0, 0.20), (10.0, 0.10)],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        e_gray, e_wsgg = compute_errors_for_case(case)\n        results.extend([e_gray, e_wsgg])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(format_float(x) for x in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "The ultimate purpose of modeling radiation in combustion is to capture its influence on the reacting flow field. One of the most critical effects is radiative heat loss from hot product gases, which directly reduces the flame temperature from its ideal adiabatic value. This final exercise  demonstrates this vital coupling in action by guiding you to incorporate a radiative loss term into the flame's energy balance. By solving for the resulting temperature in a one-dimensional flame, you will quantify the impact of radiation and gain a tangible understanding of how it modifies the thermodynamic state in combustion systems.",
            "id": "4015157",
            "problem": "Consider a steady one-dimensional premixed methane–air flame represented by a control volume of thickness $L$ and unit cross-sectional area. The inflowing mixture has bulk speed $U$, pressure $p$, and inlet temperature $T_{\\mathrm{in}}$. In the adiabatic limit, the products reach the adiabatic flame temperature $T_{\\mathrm{ad}}$. When optically thin radiation is included, the products lose energy to the surroundings at temperature $T_{\\mathrm{env}}$, leading to a reduced exit temperature $T_{\\mathrm{rad}}$. You must compute the temperature reduction $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$.\n\nStart from fundamental laws:\n- Conservation of energy for a steady one-dimensional control volume implies that the net enthalpy rise equals the chemical heat release minus any heat losses. With adiabatic heat release denoted by $m\\dot{}\\,c_p\\,(T_{\\mathrm{ad}} - T_{\\mathrm{in}})$, the non-adiabatic exit temperature satisfies\n$$\nm\\dot{}\\,c_p\\,(T_{\\mathrm{rad}} - T_{\\mathrm{in}}) \\;=\\; m\\dot{}\\,c_p\\,(T_{\\mathrm{ad}} - T_{\\mathrm{in}}) \\;-\\; Q_{\\mathrm{rad}}(T_{\\mathrm{rad}}),\n$$\nwhich rearranges to the implicit equation\n$$\nT_{\\mathrm{ad}} - T_{\\mathrm{rad}} \\;=\\; \\frac{Q_{\\mathrm{rad}}(T_{\\mathrm{rad}})}{m\\dot{}\\,c_p},\n$$\nwhere $m\\dot{} = \\rho\\,U$ is the mass flux per unit area, $\\rho$ the product-gas density, and $c_p$ the specific heat at constant pressure. Take $c_p$ to be constant and equal to $1200\\ \\mathrm{J/(kg\\cdot K)}$ for the product mixture.\n\n- Under the optically thin approximation, the divergence of the radiative heat flux can be modeled by\n$$\n\\dot{q}_{\\mathrm{rad}}(T) \\;=\\; 4\\,\\sigma\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big),\n$$\nwhere $\\sigma$ is the Stefan–Boltzmann constant and $\\kappa_P(T)$ is a Planck-mean absorption coefficient of the participating gases. For a slab of thickness $L$ and approximately uniform product temperature $T$, the radiative loss per unit area is\n$$\nQ_{\\mathrm{rad}}(T) \\;=\\; \\dot{q}_{\\mathrm{rad}}(T)\\,L \\;=\\; 4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big).\n$$\n\n- Model $\\kappa_P(T)$ using the Weighted Sum of Gray Gases (WSGG) for water vapor and carbon dioxide. Let the product mole fractions (assumed fixed by stoichiometric methane–air chemistry) be $X_{\\text{H}_2\\text{O}} = 2/10.52$ and $X_{\\text{CO}_2} = 1/10.52$, and the product mixture molar mass be\n$$\n\\bar{M} \\;=\\; 44\\,X_{\\text{CO}_2} + 18\\,X_{\\text{H}_2\\text{O}} + 28\\,(1 - X_{\\text{CO}_2} - X_{\\text{H}_2\\text{O}})\\ \\mathrm{g/mol}.\n$$\nUse the mixture gas constant $R_{\\mathrm{mix}} = R_u/\\bar{M}$ with $R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$ and convert pressure to atmospheres by $p_{\\mathrm{atm}} = p/101325$. Approximate the density at $T_{\\mathrm{ad}}$ by\n$$\n\\rho \\;=\\; \\frac{p}{R_{\\mathrm{mix}}\\,T_{\\mathrm{ad}}}.\n$$\n\nDefine three gray-gas absorption coefficients for each species (in $\\mathrm{m^{-1}\\,atm^{-1}}$):\n- For water vapor ($\\text{H}_2\\text{O}$): $k_{\\text{H}_2\\text{O},1} = 0.2$, $k_{\\text{H}_2\\text{O},2} = 1.5$, $k_{\\text{H}_2\\text{O},3} = 13.0$.\n- For carbon dioxide ($\\text{CO}_2$): $k_{\\text{CO}_2,1} = 0.1$, $k_{\\text{CO}_2,2} = 0.8$, $k_{\\text{CO}_2,3} = 8.0$.\n\nLet the temperature-dependent WSGG weights (non-negative and summing to one) be\n$$\n\\begin{aligned}\na_{\\text{H}_2\\text{O},1}(T) &= 0.6 - 10^{-4}\\,(T - 1000),\\\\\na_{\\text{H}_2\\text{O},2}(T) &= 0.3 + 5\\times 10^{-5}\\,(T - 1000),\\\\\na_{\\text{H}_2\\text{O},3}(T) &= 0.1 + 5\\times 10^{-5}\\,(T - 1000),\n\\end{aligned}\n\\qquad\n\\begin{aligned}\na_{\\text{CO}_2,1}(T) &= 0.7 - 10^{-4}\\,(T - 1000),\\\\\na_{\\text{CO}_2,2}(T) &= 0.25 + 5\\times 10^{-5}\\,(T - 1000),\\\\\na_{\\text{CO}_2,3}(T) &= 0.05 + 5\\times 10^{-5}\\,(T - 1000),\n\\end{aligned}\n$$\nand the species-level Planck-mean absorption coefficients are\n$$\n\\kappa_{\\text{H}_2\\text{O}}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\text{H}_2\\text{O}}\\,\\sum_{m=1}^3 a_{\\text{H}_2\\text{O},m}(T)\\,k_{\\text{H}_2\\text{O},m},\n\\qquad\n\\kappa_{\\text{CO}_2}(T) \\;=\\; p_{\\mathrm{atm}}\\,X_{\\text{CO}_2}\\,\\sum_{m=1}^3 a_{\\text{CO}_2,m}(T)\\,k_{\\text{CO}_2,m},\n$$\nso that\n$$\n\\kappa_P(T) \\;=\\; \\kappa_{\\text{H}_2\\text{O}}(T) + \\kappa_{\\text{CO}_2}(T).\n$$\n\nUsing these relations, compute $T_{\\mathrm{rad}}$ by solving\n$$\nf(T) \\;=\\; T_{\\mathrm{ad}} - T \\;-\\; \\frac{4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big)}{\\rho\\,U\\,c_p} \\;=\\; 0,\n$$\nfor $T\\in[T_{\\mathrm{env}},\\,T_{\\mathrm{ad}}]$, and report $\\Delta T = T_{\\mathrm{ad}} - T$.\n\nConstants and units:\n- Use $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$, $R_u = 8.314\\ \\mathrm{J/(mol\\cdot K)}$, $p_0 = 101325\\ \\mathrm{Pa}$.\n- Express all temperatures in $\\mathrm{K}$, pressure in $\\mathrm{Pa}$, length in $\\mathrm{m}$, speed in $\\mathrm{m/s}$, density in $\\mathrm{kg/m^3}$, and heat in $\\mathrm{W/m^2}$.\n- Express the final temperature reductions $\\Delta T$ in $\\mathrm{K}$ as floats.\n\nTest suite:\nProvide the following four parameter sets $(T_{\\mathrm{ad}}, T_{\\mathrm{env}}, p, U, L, T_{\\mathrm{in}})$ to exercise typical, high-flow, high-pressure, and warm-surroundings cases:\n1. $(2220,\\ 300,\\ 101325,\\ 0.5,\\ 0.010,\\ 300)$\n2. $(2220,\\ 300,\\ 101325,\\ 5.0,\\ 0.010,\\ 300)$\n3. $(2200,\\ 500,\\ 5\\times 101325,\\ 1.0,\\ 0.020,\\ 300)$\n4. $(2300,\\ 800,\\ 101325,\\ 0.1,\\ 0.015,\\ 300)$\n\nFinal output format:\nYour program should produce a single line of output containing the four temperature reductions as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), each value being a float in $\\mathrm{K}$.",
            "solution": "The problem requires solving a non-linear algebraic equation for the flame temperature, $T_{\\mathrm{rad}}$, which includes the effect of radiative heat loss. This temperature is then used to find the reduction $\\Delta T = T_{\\mathrm{ad}} - T_{\\mathrm{rad}}$. The governing equation is derived from the steady-state energy balance for the control volume:\n$$\nf(T) = T_{\\mathrm{ad}} - T - \\frac{Q_{\\mathrm{rad}}(T)}{\\rho\\,U\\,c_p} = 0\n$$\nThe radiative heat loss term, $Q_{\\mathrm{rad}}(T)$, is modeled using the optically thin approximation for a slab of thickness $L$:\n$$\nQ_{\\mathrm{rad}}(T) = 4\\,\\sigma\\,L\\,\\kappa_P(T)\\,\\big(T^4 - T_{\\mathrm{env}}^4\\big)\n$$\nThe Planck-mean absorption coefficient, $\\kappa_P(T)$, is itself a function of temperature, calculated using the provided Weighted-Sum-of-Gray-Gases (WSGG) model with temperature-dependent weights for $\\text{H}_2\\text{O}$ and $\\text{CO}_2$.\n\nThe algorithmic procedure is to first calculate all constant parameters (product mixture density $\\rho$, mass flux $\\rho U$, etc.) from the given inputs. Then, the function $f(T)$ is defined, incorporating the WSGG model for $\\kappa_P(T)$. Because $f(T)$ is continuous and monotonically decreasing on the interval $[T_{\\mathrm{env}}, T_{\\mathrm{ad}}]$ and changes sign at the endpoints, a unique root $T_{\\mathrm{rad}}$ is guaranteed. This root is found numerically using an algorithm such as Brent's method. Finally, the temperature reduction is calculated. This process is repeated for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Calculates the temperature reduction in a premixed flame due to\n    optically thin radiation, for a series of test cases.\n    \"\"\"\n    # Define constants\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant, W/(m^2*K^4)\n    RU = 8.314             # Universal gas constant, J/(mol*K)\n    P0 = 101325.0          # Standard pressure, Pa\n    CP = 1200.0            # Specific heat of products, J/(kg*K)\n\n    # WSGG model parameters\n    # Mole fractions\n    X_H2O = 2.0 / 10.52\n    X_CO2 = 1.0 / 10.52\n    \n    # Gray-gas absorption coefficients, m^-1*atm^-1\n    K_H2O = np.array([0.2, 1.5, 13.0])\n    K_CO2 = np.array([0.1, 0.8, 8.0])\n\n    # Test cases: (T_ad, T_env, p, U, L, T_in)\n    test_cases = [\n        (2220.0, 300.0, 101325.0, 0.5, 0.010, 300.0),\n        (2220.0, 300.0, 101325.0, 5.0, 0.010, 300.0),\n        (2200.0, 500.0, 5.0 * 101325.0, 1.0, 0.020, 300.0),\n        (2300.0, 800.0, 101325.0, 0.1, 0.015, 300.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T_ad, T_env, p, U, L, T_in = case\n\n        # --- 1. Calculate constant parameters ---\n        # Molar mass of product mixture, M_bar (kg/mol)\n        # Molar masses: CO2=44, H2O=18, N2=28 g/mol\n        m_bar_g = 44.0 * X_CO2 + 18.0 * X_H2O + 28.0 * (1.0 - X_CO2 - X_H2O)\n        m_bar_kg = m_bar_g / 1000.0 # Convert to kg/mol\n        \n        # Mixture-specific gas constant, R_mix (J/(kg*K))\n        R_mix = RU / m_bar_kg\n        \n        # Density of products at T_ad, rho (kg/m^3)\n        rho = p / (R_mix * T_ad)\n        \n        # Mass flux, m_dot (kg/(m^2*s))\n        m_dot = rho * U\n        \n        # Pressure in atmospheres (dimensionless)\n        p_atm = p / P0\n\n        # --- 2. Define temperature-dependent functions ---\n        def kappa_P(T):\n            \"\"\"Calculates the Planck-mean absorption coefficient kappa_P(T) in m^-1.\"\"\"\n            T_ref_diff = T - 1000.0\n            \n            # H2O WSGG weights\n            a_H2O_1 = 0.6 - 1e-4 * T_ref_diff\n            a_H2O_2 = 0.3 + 5e-5 * T_ref_diff\n            a_H2O_3 = 1.0 - a_H2O_1 - a_H2O_2 # Ensures sum is 1\n            a_H2O = np.array([a_H2O_1, a_H2O_2, a_H2O_3])\n            \n            # CO2 WSGG weights\n            a_CO2_1 = 0.7 - 1e-4 * T_ref_diff\n            a_CO2_2 = 0.25 + 5e-5 * T_ref_diff\n            a_CO2_3 = 1.0 - a_CO2_1 - a_CO2_2 # Ensures sum is 1\n            a_CO2 = np.array([a_CO2_1, a_CO2_2, a_CO2_3])\n\n            # Species-level absorption coefficients, kappa_i (m^-1)\n            # p_atm * X is the partial pressure in atm\n            kappa_H2O = p_atm * X_H2O * np.sum(a_H2O * K_H2O)\n            kappa_CO2 = p_atm * X_CO2 * np.sum(a_CO2 * K_CO2)\n            \n            return kappa_H2O + kappa_CO2\n\n        def f(T):\n            \"\"\"The function f(T) = 0 to be solved for T_rad.\"\"\"\n            # Radiative heat loss per unit area, Q_rad (W/m^2)\n            Q_rad = 4.0 * SIGMA * L * kappa_P(T) * (T**4 - T_env**4)\n            \n            # Energy balance equation\n            heat_loss_term = Q_rad / (m_dot * CP)\n            \n            return T_ad - T - heat_loss_term\n\n        # --- 3. Solve for T_rad ---\n        # The root is bracketed by T_env and T_ad\n        T_rad = brentq(f, a=T_env, b=T_ad)\n\n        # --- 4. Compute delta T ---\n        delta_T = T_ad - T_rad\n        results.append(delta_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}