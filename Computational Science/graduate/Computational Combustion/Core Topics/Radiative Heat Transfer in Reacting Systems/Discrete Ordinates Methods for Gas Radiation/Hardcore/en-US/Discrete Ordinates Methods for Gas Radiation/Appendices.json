{
    "hands_on_practices": [
        {
            "introduction": "The core idea of the Discrete Ordinates Method is to approximate the continuous angular domain of radiation intensity with a finite set of discrete directions. This practice  provides a direct way to quantify the error introduced by this fundamental approximation. By comparing the DOM result against an exact analytical solution for a simplified case, you will gain a concrete understanding of how angular resolution impacts accuracy.",
            "id": "4020307",
            "problem": "Consider monochromatic radiative transfer in a homogeneous, isothermal, gray, non-scattering gas contained within an axis-aligned cube of side length $L$ with cold, black boundary surfaces (zero incident intensity from boundaries). Let the gas absorption coefficient be $\\kappa$ (units $\\mathrm{m}^{-1}$) and the emission be characterized by a constant Planck function $B$ (units $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$). The Radiative Transfer Equation (RTE) along a ray parameterized by arc length $s$ with direction unit vector $\\boldsymbol{\\omega}$ is\n$$\n\\frac{d I(s,\\boldsymbol{\\omega})}{d s} \\;=\\; -\\,\\kappa\\, I(s,\\boldsymbol{\\omega}) \\;+\\; \\kappa\\, B,\n$$\nsubject to the boundary condition that $I=0$ at the cube surfaces (cold black boundaries). Define the optical thickness as $\\tau = \\kappa\\,L$.\n\nIn the optically thin limit, assume $\\kappa\\,L \\ll 1$ and systematically derive from the RTE the line-of-sight expression for the intensity at the cube center, $I_\\text{exact}(\\boldsymbol{\\omega})$, as a function of $\\kappa$, $B$, and the distance to the nearest boundary along direction $\\boldsymbol{\\omega}$. To do this, start from the RTE and the cold-black boundary condition to obtain the integral solution, then take the $\\kappa L \\ll 1$ limit to simplify the exponential attenuation factors. For an axis-aligned cube centered at the origin, show how the line-of-sight distance $s_b(\\boldsymbol{\\omega})$ from the center to the boundary in direction $\\boldsymbol{\\omega}$ can be expressed in terms of the direction cosines of $\\boldsymbol{\\omega}$ and $L$.\n\nNow, approximate the same line-of-sight intensity using the Discrete Ordinates Method (DOM), which replaces the continuous angular dependence by a finite set of directions. Use a tensor-product angular grid with $N$ polar divisions and $N$ azimuth divisions to define $N^2$ discrete ordinates:\n- Polar angles $\\theta_j = \\left(j+\\tfrac{1}{2}\\right)\\,\\pi/N$ for $j=0,1,\\dots,N-1$,\n- Azimuth angles $\\phi_k = \\left(k+\\tfrac{1}{2}\\right)\\,2\\pi/N$ for $k=0,1,\\dots,N-1$,\nand the corresponding unit vectors $\\boldsymbol{\\omega}_{j,k} = \\big(\\sin\\theta_j\\cos\\phi_k,\\; \\sin\\theta_j\\sin\\phi_k,\\; \\cos\\theta_j\\big)$. For a given target direction with angles $(\\theta^\\star,\\phi^\\star)$, approximate the intensity by selecting the nearest discrete ordinate $\\boldsymbol{\\omega}_{j,k}$ (in terms of smallest angular separation) and evaluating the optically-thin line-of-sight integral along that discrete direction. Denote this DOM approximation by $I_\\text{DOM}(N,\\theta^\\star,\\phi^\\star)$.\n\nDefine the absolute error\n$$\n\\varepsilon(\\tau,N,\\theta^\\star,\\phi^\\star) \\;=\\; \\big|\\,I_\\text{DOM}(N,\\theta^\\star,\\phi^\\star) \\;-\\; I_\\text{exact}(\\theta^\\star,\\phi^\\star)\\,\\big|,\n$$\nand study its dependence on optical thickness $\\tau$ and angular resolution $N$.\n\nYour program must:\n- Implement the exact optically-thin line-of-sight intensity from first principles (starting from the RTE as above).\n- Implement the DOM approximation using the angular grid defined above and nearest-direction selection.\n- Compute the absolute errors for the following test suite with $L=1\\,\\mathrm{m}$ and $B=1\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}}$, angles in radians:\n    1. $\\tau = 10^{-3}$, $N=8$, $(\\theta^\\star,\\phi^\\star)=(0.7,\\,1.3)$,\n    2. $\\tau = 10^{-3}$, $N=2$, $(\\theta^\\star,\\phi^\\star)=(0.7,\\,1.3)$,\n    3. $\\tau = 10^{-3}$, $N=32$, $(\\theta^\\star,\\phi^\\star)=(0.7,\\,1.3)$,\n    4. $\\tau = 5\\times 10^{-4}$, $N=8$, $(\\theta^\\star,\\phi^\\star)=(0.05,\\,2.2)$,\n    5. $\\tau = 10^{-2}$, $N=8$, $(\\theta^\\star,\\phi^\\star)=(1.55,\\,\\tfrac{\\pi}{4})$,\n    6. $\\tau = 10^{-1}$, $N=8$, $(\\theta^\\star,\\phi^\\star)=(0.7,\\,1.3)$.\n- Express the absolute errors in units of $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$.\n- Produce a single line of output containing the six error values as a comma-separated list enclosed in square brackets, for example, $\\big[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4,\\varepsilon_5,\\varepsilon_6\\big]$.\n\nAngles must be in radians. All physical quantities must be computed using $L$ in meters, $\\kappa$ in inverse meters, and $B$ in watts per square meter per steradian. The final answers for the test suite must be floating-point numbers.",
            "solution": "The user-provided problem has been assessed and is valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to proceed to a unique solution.\n\nThe solution is developed in three stages: first, the derivation of the exact line-of-sight intensity at the cube's center under the optically thin approximation; second, the formulation of the Discrete Ordinates Method (DOM) approximation for this intensity; and third, the calculation of the absolute error between the two for the specified test cases.\n\n**1. Derivation of the Exact Optically-Thin Intensity, $I_\\text{exact}$**\n\nThe starting point is the Radiative Transfer Equation (RTE) for a non-scattering, emitting-absorbing medium with constant properties, given by:\n$$\n\\frac{d I(s, \\boldsymbol{\\omega})}{ds} = -\\kappa I(s, \\boldsymbol{\\omega}) + \\kappa B\n$$\nwhere $I$ is the radiative intensity in direction $\\boldsymbol{\\omega}$, $s$ is the path length, $\\kappa$ is the absorption coefficient, and $B$ is the Planck function, representing the source term due to emission. This is a first-order linear ordinary differential equation. We can solve it by rearranging it and using an integrating factor $e^{\\kappa s}$:\n$$\n\\frac{dI}{ds} + \\kappa I = \\kappa B\n$$\n$$\ne^{\\kappa s} \\frac{dI}{ds} + \\kappa e^{\\kappa s} I = \\kappa B e^{\\kappa s}\n$$\n$$\n\\frac{d}{ds} \\left( I e^{\\kappa s} \\right) = \\kappa B e^{\\kappa s}\n$$\nTo find the intensity at a point $P$ (the cube center), we integrate along a line-of-sight from a boundary point $P_b$ to $P$. Let's set the path coordinate $s'=0$ at $P_b$ and $s'=s_b$ at $P$, where $s_b$ is the distance from the center to the boundary in the direction $-\\boldsymbol{\\omega}$. The integration yields:\n$$\n\\int_{0}^{s_b} \\frac{d}{ds'} \\left( I(s') e^{\\kappa s'} \\right) ds' = \\int_{0}^{s_b} \\kappa B e^{\\kappa s'} ds'\n$$\n$$\nI(s_b) e^{\\kappa s_b} - I(0) e^0 = \\kappa B \\left[ \\frac{1}{\\kappa} e^{\\kappa s'} \\right]_0^{s_b} = B (e^{\\kappa s_b} - 1)\n$$\nThe problem states the boundaries are cold and black, meaning the intensity originating from any boundary surface is zero. Thus, the boundary condition is $I(s'=0)=0$. Substituting this, we get:\n$$\nI(s_b) e^{\\kappa s_b} = B (e^{\\kappa s_b} - 1)\n$$\n$$\nI(s_b, \\boldsymbol{\\omega}) = B (1 - e^{-\\kappa s_b})\n$$\nThis is the full solution for the intensity at the center. The problem requires the solution in the optically thin limit, where the optical thickness of the domain is small, i.e., $\\tau = \\kappa L \\ll 1$. Since the path length $s_b$ is of the order of $L$, this implies $\\kappa s_b \\ll 1$. We can therefore use the first-order Taylor series expansion of the exponential function, $e^{-x} \\approx 1 - x$ for small $x$.\nApplying this approximation, we obtain the expression for the optically thin intensity, which we denote $I_\\text{exact}$:\n$$\nI_\\text{exact}(\\boldsymbol{\\omega}) \\approx B (1 - (1 - \\kappa s_b)) = B \\kappa s_b(\\boldsymbol{\\omega})\n$$\n\n**2. Geometric Path Length, $s_b(\\boldsymbol{\\omega})$**\n\nThe cube is axis-aligned, centered at the origin $(0,0,0)$, with side length $L$. Its faces are located at the planes $x=\\pm L/2$, $y=\\pm L/2$, and $z=\\pm L/2$. A ray of light traveling towards the center from the boundary moves along a direction $-\\boldsymbol{\\omega}$. Equivalently, a ray originating from the center at $\\mathbf{r}=(0,0,0)$ in direction $\\boldsymbol{\\omega}$ is described by the parametric equation $\\mathbf{r}(s) = s\\boldsymbol{\\omega}$ for $s>0$. Let the direction cosines of $\\boldsymbol{\\omega}$ be $(\\mu, \\eta, \\xi)$, where $\\boldsymbol{\\omega} = (\\mu, \\eta, \\xi)$ and $\\mu^2+\\eta^2+\\xi^2=1$. The coordinates of a point on the ray are $(x,y,z) = (s\\mu, s\\eta, s\\xi)$.\n\nThe ray intersects the boundary planes when one of the following conditions is met:\n$|x| = |s\\mu| = L/2 \\implies s = \\frac{L/2}{|\\mu|}$\n$|y| = |s\\eta| = L/2 \\implies s = \\frac{L/2}{|\\eta|}$\n$|z| = |s\\xi| = L/2 \\implies s = \\frac{L/2}{|\\xi|}$\n\nThe distance from the center to the nearest boundary point along this direction, $s_b(\\boldsymbol{\\omega})$, is the smallest of these positive distances:\n$$\ns_b(\\boldsymbol{\\omega}) = \\min\\left( \\frac{L/2}{|\\mu|}, \\frac{L/2}{|\\eta|}, \\frac{L/2}{|\\xi|} \\right)\n$$\nThis can be written more compactly as:\n$$\ns_b(\\boldsymbol{\\omega}) = \\frac{L/2}{\\max(|\\mu|, |\\eta|, |\\xi|)}\n$$\nThe direction cosines can be expressed in terms of spherical polar angles $(\\theta, \\phi)$ as $\\mu = \\sin\\theta\\cos\\phi$, $\\eta = \\sin\\theta\\sin\\phi$, and $\\xi = \\cos\\theta$. Substituting these into the intensity expression, we have:\n$$\nI_\\text{exact}(\\theta, \\phi) = B \\kappa \\left( \\frac{L/2}{\\max(|\\sin\\theta\\cos\\phi|, |\\sin\\theta\\sin\\phi|, |\\cos\\theta|)} \\right)\n$$\nUsing the optical thickness $\\tau = \\kappa L$, which implies $\\kappa = \\tau/L$, the expression becomes independent of $L$:\n$$\nI_\\text{exact}(\\theta, \\phi) = B \\frac{\\tau}{L} \\left( \\frac{L/2}{\\max(|\\sin\\theta\\cos\\phi|, |\\sin\\theta\\sin\\phi|, |\\cos\\theta|)} \\right) = \\frac{B \\tau/2}{\\max(|\\sin\\theta\\cos\\phi|, |\\sin\\theta\\sin\\phi|, |\\cos\\theta|)}\n$$\n\n**3. Discrete Ordinates Method (DOM) Approximation, $I_\\text{DOM}$**\n\nThe DOM replaces the continuous angular domain with a finite set of discrete directions or ordinates, $\\{\\boldsymbol{\\omega}_{j,k}\\}$. The problem specifies a tensor-product grid with $N^2$ ordinates defined by:\n- Polar angles: $\\theta_j = \\left(j+\\tfrac{1}{2}\\right)\\frac{\\pi}{N}$ for $j=0, 1, \\dots, N-1$\n- Azimuthal angles: $\\phi_k = \\left(k+\\tfrac{1}{2}\\right)\\frac{2\\pi}{N}$ for $k=0, 1, \\dots, N-1$\n\nFor a given target direction $\\boldsymbol{\\omega}^\\star$ (with angles $\\theta^\\star, \\phi^\\star$), the method requires finding the nearest discrete ordinate $\\boldsymbol{\\omega}_{j,k}$ in the set. The \"nearest\" is defined by the smallest angular separation, which is equivalent to maximizing the dot product between the unit vectors. We must find the index pair $(j_0, k_0)$ that maximizes:\n$$\n(j_0, k_0) = \\underset{j,k}{\\operatorname{argmax}} (\\boldsymbol{\\omega}_{j,k} \\cdot \\boldsymbol{\\omega}^\\star)\n$$\nLet the nearest ordinate be $\\boldsymbol{\\omega}_\\text{DOM} = \\boldsymbol{\\omega}_{j_0, k_0}$. Its direction cosines are $(\\mu_\\text{DOM}, \\eta_\\text{DOM}, \\xi_\\text{DOM})$.\n\nThe DOM approximation for the intensity, $I_\\text{DOM}$, is then the optically-thin intensity calculated along this discrete direction $\\boldsymbol{\\omega}_\\text{DOM}$:\n$$\nI_\\text{DOM}(N, \\theta^\\star, \\phi^\\star) = B \\kappa s_b(\\boldsymbol{\\omega}_\\text{DOM})\n$$\nSubstituting the expression for $s_b$ and $\\kappa=\\tau/L$:\n$$\nI_\\text{DOM}(N, \\theta^\\star, \\phi^\\star) = \\frac{B \\tau/2}{\\max(|\\mu_\\text{DOM}|, |\\eta_\\text{DOM}|, |\\xi_\\text{DOM}|)}\n$$\n\n**4. Error Calculation for Test Suite**\n\nThe absolute error $\\varepsilon$ is the magnitude of the difference between the DOM approximation and the exact optically-thin solution:\n$$\n\\varepsilon(\\tau, N, \\theta^\\star, \\phi^\\star) = |I_\\text{DOM}(N, \\theta^\\star, \\phi^\\star) - I_\\text{exact}(\\theta^\\star, \\phi^\\star)|\n$$\n$$\n\\varepsilon = \\frac{B\\tau}{2} \\left| \\frac{1}{\\max(|\\mu_\\text{DOM}|, |\\eta_\\text{DOM}|, |\\xi_\\text{DOM}|)} - \\frac{1}{\\max(|\\mu^\\star|, |\\eta^\\star|, |\\xi^\\star|)} \\right|\n$$\nThe provided code implements these formulas to compute the error for each case in the test suite with $L=1\\,\\mathrm{m}$ and $B=1\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_thin_intensity(tau, b_val, l_val, theta, phi):\n    \"\"\"\n    Calculates the optically-thin intensity for a given direction.\n    This function implements the formula: I = B * (tau/L) * s_b.\n    \"\"\"\n    # Calculate direction cosines\n    mu = np.sin(theta) * np.cos(phi)\n    eta = np.sin(theta) * np.sin(phi)\n    xi = np.cos(theta)\n    \n    # Denominator for the path length calculation\n    max_abs_cosine = np.max([np.abs(mu), np.abs(eta), np.abs(xi)])\n    \n    # Avoid division by zero for directions exactly along an axis, though grid prevents this.\n    if max_abs_cosine == 0:\n        # This case should not be reached with the given angle definitions.\n        return np.inf\n\n    # Calculate distance to boundary from the center\n    s_b = (l_val / 2.0) / max_abs_cosine\n    \n    # Absorption coefficient from optical thickness and length\n    kappa = tau / l_val\n    \n    # Optically-thin intensity\n    intensity = b_val * kappa * s_b\n    \n    return intensity\n\ndef compute_error(tau, n_grid, theta_star, phi_star, l_val, b_val):\n    \"\"\"\n    Computes the absolute error between the exact and DOM-approximated intensities.\n    \"\"\"\n    # 1. Calculate the 'exact' optically-thin intensity for the target direction\n    i_exact = get_thin_intensity(tau, b_val, l_val, theta_star, phi_star)\n    \n    # 2. Find the nearest discrete ordinate for the DOM approximation\n    \n    # Target direction vector\n    w_star = np.array([\n        np.sin(theta_star) * np.cos(phi_star),\n        np.sin(theta_star) * np.sin(phi_star),\n        np.cos(theta_star)\n    ])\n    \n    max_dot_product = -1.0\n    theta_dom, phi_dom = -1.0, -1.0\n    \n    # Generate discrete polar angles\n    thetas_j = (np.arange(n_grid) + 0.5) * np.pi / n_grid\n    \n    # Generate discrete azimuthal angles\n    phis_k = (np.arange(n_grid) + 0.5) * 2.0 * np.pi / n_grid\n    \n    # Search for the nearest ordinate\n    for tj in thetas_j:\n        for pk in phis_k:\n            # DOM direction vector\n            w_jk = np.array([\n                np.sin(tj) * np.cos(pk),\n                np.sin(tj) * np.sin(pk),\n                np.cos(tj)\n            ])\n            \n            dot_product = np.dot(w_star, w_jk)\n            \n            if dot_product > max_dot_product:\n                max_dot_product = dot_product\n                theta_dom = tj\n                phi_dom = pk\n\n    # 3. Calculate the DOM-approximated intensity using the nearest ordinate\n    i_dom = get_thin_intensity(tau, b_val, l_val, theta_dom, phi_dom)\n    \n    # 4. Compute the absolute error\n    error = np.abs(i_dom - i_exact)\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    # Define physical constants from the problem statement\n    L = 1.0  # meters\n    B = 1.0  # W m^-2 sr^-1\n    \n    # Define the test cases from the problem statement.\n    # Format: (tau, N, theta_star_rad, phi_star_rad)\n    test_cases = [\n        (1e-3, 8, 0.7, 1.3),\n        (1e-3, 2, 0.7, 1.3),\n        (1e-3, 32, 0.7, 1.3),\n        (5e-4, 8, 0.05, 2.2),\n        (1e-2, 8, 1.55, np.pi/4),\n        (1e-1, 8, 0.7, 1.3),\n    ]\n\n    results = []\n    for case in test_cases:\n        tau_val, n_val, theta_s, phi_s = case\n        \n        # Calculate the error for the current test case\n        abs_error = compute_error(tau_val, n_val, theta_s, phi_s, L, B)\n        \n        results.append(abs_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the understanding of angular discretization, this exercise  applies the DOM to a common engineering problem: calculating the total radiative heat loss from a hot gas slab. It introduces the simplest spectral model, the gray gas approximation, and contrasts it with a more detailed, albeit simplified, line-by-line spectral model. This practice highlights the importance of accounting for spectral property variations in radiative transfer.",
            "id": "4020320",
            "problem": "Consider an isothermal, homogeneous, plane-parallel slab of hot gas of thickness $L$ surrounded by vacuum on both sides. The gas is non-scattering and purely absorbing–emitting, and its thermodynamic state is uniform at temperature $T$. The goal is to compute the total outward radiative heat loss (leaving both sides) from the slab using two models: a gray Discrete Ordinates Method (DOM) and a simplified line-by-line spectral model built from discrete features. The Discrete Ordinates Method (DOM) must be used to evaluate the angular integration by replacing the continuous integral with a finite set of ordinates and weights.\n\nStart from the Radiative Transfer Equation (RTE) for a one-dimensional plane-parallel slab with no scattering and surroundings in vacuum:\n$$\n\\mu \\frac{d I(x,\\mu)}{dx} = -\\kappa I(x,\\mu) + \\kappa I_b,\n$$\nwhere $I(x,\\mu)$ is the spectral-directional radiative intensity, $\\mu$ is the direction cosine with respect to the slab normal, $\\kappa$ is the absorption coefficient, and $I_b$ is the blackbody radiative intensity integrated over frequency. Use the relation between total blackbody emissive power $E_b$ and blackbody intensity $I_b$,\n$$\nE_b = \\sigma T^4, \\quad I_b = \\frac{E_b}{\\pi} = \\frac{\\sigma T^4}{\\pi},\n$$\nwhere $\\sigma$ is the Stefan–Boltzmann constant.\n\nImpose vacuum boundary conditions at both slab faces. For rays entering the slab from either boundary, the incoming intensity is zero.\n\nIn the gray-gas model, use a single absorption coefficient $\\kappa$ independent of frequency. In the simplified line-by-line model, approximate the spectrum by a finite set of discrete features indexed by $k = 1,2,\\dots,K$, each with absorption coefficient $\\kappa_k$ and fractional blackbody power weight $\\alpha_k$ such that $\\sum_{k=1}^K \\alpha_k = 1$. Assume these $\\alpha_k$ values are fixed for the given conditions and represent how the total blackbody power $\\sigma T^4$ is partitioned among the discrete features and a continuum remainder.\n\nUse the Discrete Ordinates Method (DOM) with $N_\\mu$ positive ordinates to approximate the hemispherical angular integral. Let $\\mu_i$ and $w_i$ denote the positive direction cosines and corresponding quadrature weights on the interval $[0,1]$ that approximate integrals of the form $\\int_0^1 f(\\mu)\\,d\\mu \\approx \\sum_{i=1}^{N_\\mu} w_i f(\\mu_i)$. Use these to compute the outward hemispherical flux leaving one side, then sum the contributions from both sides to get the total outward radiative heat loss from the slab. Express all heat fluxes in watts per square meter (W/m$^2$) and report the relative difference between the line-by-line and gray results as a decimal.\n\nYour program must:\n- Solve the Radiative Transfer Equation along each ordinate to obtain the outgoing boundary intensities under the given vacuum boundary conditions.\n- Use the Discrete Ordinates Method (DOM) to evaluate the hemispherical flux leaving each boundary, and sum both boundaries to obtain the total outward heat loss for each model.\n- For the line-by-line model, compute the heat loss by summing the contributions of each spectral feature using its own absorption coefficient and fractional blackbody weight.\n\nTest suite parameter sets:\n1. Happy-path, moderately optically thick gray gas with distinct spectral lines:\n   - Temperature $T = 1200\\ \\mathrm{K}$,\n   - Thickness $L = 0.1\\ \\mathrm{m}$,\n   - Gray absorption coefficient $\\kappa = 5\\ \\mathrm{m}^{-1}$,\n   - Number of positive ordinates $N_\\mu = 8$,\n   - Spectral features: $K=3$ with $(\\kappa_1,\\kappa_2,\\kappa_3) = (50, 15, 1)\\ \\mathrm{m}^{-1}$ and $(\\alpha_1,\\alpha_2,\\alpha_3) = (0.3, 0.5, 0.2)$.\n2. Optically thin limit:\n   - Temperature $T = 1800\\ \\mathrm{K}$,\n   - Thickness $L = 0.02\\ \\mathrm{m}$,\n   - Gray absorption coefficient $\\kappa = 0.01\\ \\mathrm{m}^{-1}$,\n   - Number of positive ordinates $N_\\mu = 16$,\n   - Spectral features: $K=3$ with $(\\kappa_1,\\kappa_2,\\kappa_3) = (0.05, 0.02, 0.005)\\ \\mathrm{m}^{-1}$ and $(\\alpha_1,\\alpha_2,\\alpha_3) = (0.6, 0.25, 0.15)$.\n3. Optically thick limit:\n   - Temperature $T = 1000\\ \\mathrm{K}$,\n   - Thickness $L = 0.5\\ \\mathrm{m}$,\n   - Gray absorption coefficient $\\kappa = 100\\ \\mathrm{m}^{-1}$,\n   - Number of positive ordinates $N_\\mu = 12$,\n   - Spectral features: $K=3$ with $(\\kappa_1,\\kappa_2,\\kappa_3) = (200, 120, 50)\\ \\mathrm{m}^{-1}$ and $(\\alpha_1,\\alpha_2,\\alpha_3) = (0.2, 0.7, 0.1)$.\n4. Coarse angular resolution edge case:\n   - Temperature $T = 1500\\ \\mathrm{K}$,\n   - Thickness $L = 0.1\\ \\mathrm{m}$,\n   - Gray absorption coefficient $\\kappa = 10\\ \\mathrm{m}^{-1}$,\n   - Number of positive ordinates $N_\\mu = 2$,\n   - Spectral features: $K=3$ with $(\\kappa_1,\\kappa_2,\\kappa_3) = (5, 30, 2)\\ \\mathrm{m}^{-1}$ and $(\\alpha_1,\\alpha_2,\\alpha_3) = (0.4, 0.4, 0.2)$.\n\nOutput requirements:\n- For each test case, compute:\n  1. The total outward radiative heat loss using the gray model in W/m$^2$.\n  2. The total outward radiative heat loss using the simplified line-by-line model in W/m$^2$.\n  3. The relative difference $(q_{\\mathrm{LBL}} - q_{\\mathrm{gray}})/q_{\\mathrm{gray}}$ as a decimal (unitless).\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, in the order\n  $[q_{\\mathrm{gray},1}, q_{\\mathrm{LBL},1}, \\Delta_1, q_{\\mathrm{gray},2}, q_{\\mathrm{LBL},2}, \\Delta_2, q_{\\mathrm{gray},3}, q_{\\mathrm{LBL},3}, \\Delta_3, q_{\\mathrm{gray},4}, q_{\\mathrm{LBL},4}, \\Delta_4]$.\n- Express all heat fluxes in W/m$^2$, each rounded to six decimal places, and each relative difference rounded to six decimal places.",
            "solution": "The fundamental basis is the Radiative Transfer Equation (RTE) for a one-dimensional, plane-parallel, isothermal, homogeneous, purely absorbing–emitting medium with vacuum surroundings. The RTE reads\n$$\n\\mu \\frac{d I(x,\\mu)}{dx} = -\\kappa I(x,\\mu) + \\kappa I_b,\n$$\nwhere $I(x,\\mu)$ is the integrated-over-frequency radiative intensity, $\\mu$ is the direction cosine with respect to the slab normal, $\\kappa$ is the absorption coefficient, and $I_b$ is the integrated blackbody intensity. The total blackbody emissive power is $E_b = \\sigma T^4$ and the blackbody intensity is $I_b = \\sigma T^4/\\pi$.\n\nWith vacuum boundaries, the incoming intensities at both faces are zero: $I(0,\\mu>0) = 0$ and $I(L,\\mu<0) = 0$. For a uniform medium and constant source $I_b$, the RTE along a characteristic with a fixed $\\mu$ is a linear first-order ordinary differential equation with constant coefficients. Solving along the characteristic yields\n$$\nI(x,\\mu) = I_b + \\left(I(x_0,\\mu) - I_b\\right)\\exp\\left(-\\frac{\\kappa |x-x_0|}{|\\mu|}\\right),\n$$\nwhere $x_0$ is the boundary point from which the ray enters the domain. For $\\mu>0$, the ray entering at $x=0$ has $I(0,\\mu)=0$, and for $\\mu<0$, the ray entering at $x=L$ has $I(L,\\mu)=0$. Therefore, the outgoing intensities at the boundaries in the outward directions are\n$$\nI(L,\\mu>0) = I_b \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right), \\quad\nI(0,\\mu<0) = I_b \\left(1 - \\exp\\left(-\\frac{\\kappa L}{|\\mu|}\\right)\\right).\n$$\nBy symmetry of the homogeneous slab, both boundaries have identical outward intensity distributions in magnitude for their outgoing hemispheres.\n\nThe hemispherical radiative heat flux leaving one boundary is\n$$\nq_{\\text{side}} = \\int_{\\Omega^+} I(\\mu)\\, \\mu\\, d\\Omega = 2\\pi \\int_0^1 I(\\mu)\\, \\mu\\, d\\mu,\n$$\nwhere the factor $2\\pi$ accounts for azimuthal integration over the hemisphere. Substituting the boundary intensity for the outward hemisphere gives\n$$\nq_{\\text{side}} = 2\\pi \\int_0^1 I_b \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\\mu\\, d\\mu = 2\\pi I_b \\int_0^1 \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\\mu\\, d\\mu.\n$$\nThe total outward heat loss from both sides is $q_{\\text{tot}} = 2 q_{\\text{side}}$, so\n$$\nq_{\\text{tot}} = 4\\pi I_b \\int_0^1 \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\\mu\\, d\\mu.\n$$\nUsing $I_b = \\sigma T^4/\\pi$, this simplifies to\n$$\nq_{\\text{tot}} = 4 \\sigma T^4 \\int_0^1 \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu}\\right)\\right)\\mu\\, d\\mu.\n$$\nThis expression arises directly from the RTE solution and the definition of the flux; no shortcut formulas are introduced.\n\nTo evaluate the integral, use the Discrete Ordinates Method (DOM) to approximate the integral $\\int_0^1 f(\\mu)\\, d\\mu$ with a quadrature rule,\n$$\n\\int_0^1 f(\\mu)\\, d\\mu \\approx \\sum_{i=1}^{N_\\mu} w_i f(\\mu_i),\n$$\nwhere $(\\mu_i, w_i)$ are the positive ordinates and weights. A suitable choice is Gauss–Legendre quadrature mapped from $[-1,1]$ to $[0,1]$, with the mapping $\\mu = \\frac{1}{2}(x+1)$ and $w = \\frac{1}{2}w_{\\text{GL}}$, where $x$ and $w_{\\text{GL}}$ are the nodes and weights on $[-1,1]$. Then the DOM approximation for the total heat loss in the gray model is\n$$\nq_{\\text{tot, gray}} \\approx 4 \\sigma T^4 \\sum_{i=1}^{N_\\mu} w_i \\, \\mu_i \\left(1 - \\exp\\left(-\\frac{\\kappa L}{\\mu_i}\\right)\\right).\n$$\n\nFor the simplified line-by-line model, the total blackbody power is partitioned among $K$ discrete spectral features with fractional weights $\\alpha_k$ such that $\\sum_{k=1}^K \\alpha_k = 1$, each with its own absorption coefficient $\\kappa_k$. The boundary intensity contribution of feature $k$ in direction $\\mu$ is $I_{b,k}$ times the same exponential attenuation with $\\kappa_k$, and the hemispherical flux integrates linearly over features due to the superposition principle in the RTE for non-scattering media. Since $I_{b,k} = \\alpha_k I_b$, the total heat loss is\n$$\nq_{\\text{tot, LBL}} \\approx 4 \\sigma T^4 \\sum_{k=1}^K \\alpha_k \\left[ \\sum_{i=1}^{N_\\mu} w_i \\, \\mu_i \\left(1 - \\exp\\left(-\\frac{\\kappa_k L}{\\mu_i}\\right)\\right) \\right].\n$$\n\nLimiting behaviors validate the formulation:\n- Optically thin limit $\\kappa L \\ll 1$: $\\exp\\left(-\\frac{\\kappa L}{\\mu}\\right) \\approx 1 - \\frac{\\kappa L}{\\mu}$, hence\n$$\nq_{\\text{tot, gray}} \\approx 4 \\sigma T^4 \\int_0^1 \\frac{\\kappa L}{1}\\, d\\mu = 4 \\sigma T^4 \\kappa L,\n$$\nconsistent with volumetric emission leaving the slab. For the spectral model,\n$$\nq_{\\text{tot, LBL}} \\approx 4 \\sigma T^4 \\sum_{k=1}^K \\alpha_k \\kappa_k L.\n$$\n- Optically thick limit $\\kappa L \\gg 1$: the exponential term vanishes and\n$$\nq_{\\text{tot, gray}} \\to 4 \\sigma T^4 \\int_0^1 \\mu\\, d\\mu = 4 \\sigma T^4 \\cdot \\frac{1}{2} = 2 \\sigma T^4,\n$$\nwhich is the sum of blackbody emission from both faces. The spectral model also tends to the same limit because each feature saturates, and $\\sum_k \\alpha_k = 1$,\n$$\nq_{\\text{tot, LBL}} \\to 4 \\sigma T^4 \\cdot \\frac{1}{2} \\sum_{k=1}^K \\alpha_k = 2 \\sigma T^4.\n$$\n\nAlgorithmic steps:\n1. For each test case, compute $I_b = \\sigma T^4/\\pi$ and optical thicknesses $\\tau = \\kappa L$ (gray) and $\\tau_k = \\kappa_k L$ (spectral).\n2. Generate $N_\\mu$ positive ordinates $(\\mu_i, w_i)$ using Gauss–Legendre quadrature mapped to $[0,1]$.\n3. For the gray case, evaluate the DOM sum $S_{\\text{gray}} = \\sum_i w_i \\mu_i \\left(1 - e^{-\\tau/\\mu_i}\\right)$ and set $q_{\\text{tot, gray}} = 4 \\sigma T^4 S_{\\text{gray}}$.\n4. For the spectral case, evaluate $S_k = \\sum_i w_i \\mu_i \\left(1 - e^{-\\tau_k/\\mu_i}\\right)$ for each feature and set $q_{\\text{tot, LBL}} = 4 \\sigma T^4 \\sum_k \\alpha_k S_k$.\n5. Compute the relative difference $\\Delta = (q_{\\text{tot, LBL}} - q_{\\text{tot, gray}})/q_{\\text{tot, gray}}$.\n6. Round each heat flux to six decimal places in W/m$^2$ and each relative difference to six decimal places, and print the flattened list for all test cases in the specified single-line format.\n\nThis procedure directly implements the Discrete Ordinates Method (DOM) for a uniform, isothermal slab, solving the RTE along characteristics and performing the required angular integration via quadrature. The simplified line-by-line model is constructed by linear superposition of discrete spectral features, preserving consistency with the RTE and energy conservation in both thin and thick limits.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Stefan-Boltzmann constant in W/m^2/K^4\nSIGMA = 5.670374419e-8\n\ndef gauss_legendre_on_0_1(n):\n    \"\"\"\n    Return Gauss-Legendre nodes and weights mapped to [0,1].\n    \"\"\"\n    # Legendre nodes and weights on [-1,1]\n    x, w = np.polynomial.legendre.leggauss(n)\n    # Map to [0,1]: mu = (x+1)/2, w' = w/2\n    mu = 0.5 * (x + 1.0)\n    w01 = 0.5 * w\n    return mu, w01\n\ndef gray_total_flux(T, kappa, L, Nmu):\n    \"\"\"\n    Compute total outward radiative heat loss (both sides) for gray gas.\n    \"\"\"\n    mu, w = gauss_legendre_on_0_1(Nmu)\n    tau = kappa * L\n    # DOM sum S = sum w_i * mu_i * (1 - exp(-tau/mu_i))\n    # Note: when mu_i is small, exp(-tau/mu_i) -> 0 for large tau; stable.\n    S = np.sum(w * mu * (1.0 - np.exp(-tau / mu)))\n    q_total = 4.0 * SIGMA * (T**4) * S\n    return q_total\n\ndef lbl_total_flux(T, kappas, alphas, L, Nmu):\n    \"\"\"\n    Compute total outward radiative heat loss (both sides) for simplified line-by-line model.\n    \"\"\"\n    mu, w = gauss_legendre_on_0_1(Nmu)\n    kappas = np.array(kappas, dtype=float)\n    alphas = np.array(alphas, dtype=float)\n    # Normalize alphas to avoid numerical drift; they should sum to 1 by specification.\n    alphas = alphas / np.sum(alphas)\n    S_total = 0.0\n    for kappa, alpha in zip(kappas, alphas):\n        tau_k = kappa * L\n        S_k = np.sum(w * mu * (1.0 - np.exp(-tau_k / mu)))\n        S_total += alpha * S_k\n    q_total = 4.0 * SIGMA * (T**4) * S_total\n    return q_total\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T [K], L [m], kappa_gray [1/m], N_mu, kappas_list [1/m], alphas_list)\n    test_cases = [\n        (1200.0, 0.1, 5.0, 8,  [50.0, 15.0, 1.0],   [0.3, 0.5, 0.2]),\n        (1800.0, 0.02, 0.01, 16, [0.05, 0.02, 0.005], [0.6, 0.25, 0.15]),\n        (1000.0, 0.5, 100.0, 12, [200.0, 120.0, 50.0], [0.2, 0.7, 0.1]),\n        (1500.0, 0.1, 10.0, 2,  [5.0, 30.0, 2.0],   [0.4, 0.4, 0.2]),\n    ]\n\n    results = []\n    for (T, L, kappa_gray, Nmu, kappas, alphas) in test_cases:\n        q_gray = gray_total_flux(T, kappa_gray, L, Nmu)\n        q_lbl = lbl_total_flux(T, kappas, alphas, L, Nmu)\n        rel_diff = (q_lbl - q_gray) / q_gray if q_gray != 0.0 else np.nan\n        # Round to six decimal places as required\n        results.extend([\n            f\"{q_gray:.6f}\",\n            f\"{q_lbl:.6f}\",\n            f\"{rel_diff:.6f}\"\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "In real combustion systems, gas radiative properties vary dramatically with wavelength, a feature the gray gas model cannot capture. This advanced practice  challenges you to assess the error of this common assumption by using tabulated, spectrally-resolved absorption data for a water-carbon dioxide mixture. You will implement the Planck-mean absorption coefficient and compare the resulting gray model heat flux against a more accurate spectrally-resolved DOM solution.",
            "id": "4020295",
            "problem": "Consider a one-dimensional, plane-parallel, isothermal, homogeneous gas slab of thickness $L$ in $\\text{m}$, filled with a water–carbon dioxide mixture at temperature $T=1800$ $\\text{K}$ and total pressure $P=1$ $\\text{atm}$. The slab is bounded on both sides by vacuum; the boundaries are non-reflecting and non-emitting. The refractive index is unity, the gas is non-scattering, and the only radiative interaction is absorption and emission. The goal is to quantify the error introduced by a gray approximation relative to a spectrally resolved Discrete Ordinates Method (DOM) solution.\n\nStart from the plane-parallel Radiative Transfer Equation (RTE) for spectral intensity $I_\\lambda(x,\\mu)$ in a non-scattering, isothermal, homogeneous medium,\n$$\n\\mu \\,\\frac{d I_\\lambda}{dx} \\;=\\; -\\kappa_\\lambda \\left(I_\\lambda - B_\\lambda(T)\\right),\n$$\nwhere $\\mu$ is the direction cosine with respect to the slab normal, $\\kappa_\\lambda$ is the spectral absorption coefficient in $\\text{m}^{-1}$, and $B_\\lambda(T)$ is the Planck spectral radiance in $\\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1}$,\n$$\nB_\\lambda(T) \\;=\\; \\frac{2 h c^2}{\\lambda^5} \\left[\\exp\\!\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1\\right]^{-1},\n$$\nwith $h$ the Planck constant, $c$ the speed of light, and $k_B$ the Boltzmann constant. Assume the absorption coefficient of the mixture is additive in species mole fractions at $P=1$ $\\text{atm}$:\n$$\n\\kappa_\\lambda^{\\text{mix}} \\;=\\; y_{\\mathrm{H_2O}}\\,\\kappa_\\lambda^{\\mathrm{H_2O}} \\;+\\; y_{\\mathrm{CO_2}}\\,\\kappa_\\lambda^{\\mathrm{CO_2}},\n$$\nwhere $y_{\\mathrm{H_2O}}$ and $y_{\\mathrm{CO_2}}$ are the mole fractions. The following spectrally resolved tabulated data at $T=1800$ $\\text{K}$ and $P=1$ $\\text{atm}$ are provided for wavelength $\\lambda$ in micrometers and species absorption coefficient in $\\text{m}^{-1}$ per unit mole fraction:\n- Wavelengths in micrometers: $\\lambda \\in \\{2.0,\\,2.7,\\,4.3,\\,5.0,\\,10.0\\}$.\n- Water absorption coefficients: $\\kappa_\\lambda^{\\mathrm{H_2O}} \\in \\{0.2,\\,5.0,\\,0.5,\\,0.3,\\,0.1\\}$ $\\text{m}^{-1}$.\n- Carbon dioxide absorption coefficients: $\\kappa_\\lambda^{\\mathrm{CO_2}} \\in \\{0.1,\\,0.3,\\,8.0,\\,0.4,\\,0.2\\}$ $\\text{m}^{-1}$.\n\nFor the spectrally resolved solution, compute the outward hemispherical spectral heat flux at the left boundary $x=0$ using $S_4$ Discrete Ordinates Method (DOM), i.e., approximate the angular integral over $\\mu\\in[0,1]$ with four Gauss–Legendre points and weights on the half-range. For each wavelength, apply the exact characteristic solution for constant properties to obtain the boundary intensity in the outward directions $\\mu<0$,\n$$\nI_\\lambda(0,\\mu<0) \\;=\\; B_\\lambda(T)\\,\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\lambda^{\\text{mix}}\\,L}{|\\mu|}\\right)\\right],\n$$\nand then compute the outward spectral heat flux\n$$\nq_\\lambda(0) \\;=\\; 2\\pi \\,\\int_{0}^{1} \\mu \\, I_\\lambda(0,-\\mu)\\, d\\mu,\n$$\napproximated by $S_4$ quadrature. The total outward heat flux $q_{\\text{spec}}$ in $\\text{W}\\,\\text{m}^{-2}$ is obtained by numerically integrating $q_\\lambda(0)$ over wavelength $\\lambda$ expressed in meters.\n\nFor the gray approximation, replace $\\kappa_\\lambda^{\\text{mix}}$ by its Planck-mean value at $T=1800$ $\\text{K}$,\n$$\n\\kappa_{\\text{P}} \\;=\\; \\frac{\\int_{0}^{\\infty} \\kappa_\\lambda^{\\text{mix}} \\, B_\\lambda(T)\\, d\\lambda}{\\int_{0}^{\\infty} B_\\lambda(T)\\, d\\lambda},\n$$\nand solve the gray RTE for the spectrally integrated intensity $I(x,\\mu)$,\n$$\n\\mu \\,\\frac{d I}{dx} \\;=\\; -\\kappa_{\\text{P}} \\left(I - B(T)\\right),\n$$\nwhere $B(T)=\\int_{0}^{\\infty} B_\\lambda(T)\\, d\\lambda$ in $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}$, using the same $S_4$ quadrature and constant-property characteristic solution\n$$\nI(0,\\mu<0) \\;=\\; B(T)\\,\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_{\\text{P}}\\,L}{|\\mu|}\\right)\\right],\n$$\nto compute the outward gray heat flux\n$$\nq_{\\text{gray}}(0) \\;=\\; 2\\pi \\,\\int_{0}^{1} \\mu \\, I(0,-\\mu)\\, d\\mu.\n$$\n\nDefine the relative gray error as\n$$\n\\varepsilon \\;=\\; \\frac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}},\n$$\na dimensionless quantity to be reported as a decimal.\n\nImplement a program that carries out the above calculations using:\n- The provided spectral tabulation for $\\lambda$ in micrometers converted to meters.\n- The Discrete Ordinates Method (DOM) with $S_4$ half-range Gauss–Legendre quadrature for angular integration.\n- Numerical trapezoidal integration over the provided wavelength grid for all spectral integrals.\n\nUse the following test suite of parameter values, covering typical, optically thin, and optically thick cases:\n- Case $1$: $L=0.05$ $\\text{m}$, $y_{\\mathrm{H_2O}}=0.10$, $y_{\\mathrm{CO_2}}=0.10$.\n- Case $2$: $L=0.001$ $\\text{m}$, $y_{\\mathrm{H_2O}}=0.10$, $y_{\\mathrm{CO_2}}=0.05$.\n- Case $3$: $L=0.20$ $\\text{m}$, $y_{\\mathrm{H_2O}}=0.05$, $y_{\\mathrm{CO_2}}=0.20$.\n\nYour program should produce a single line of output containing the relative gray errors for the above three cases as a comma-separated list of decimal numbers enclosed in square brackets, for example, $[e_1,e_2,e_3]$. Angles, if any, must be treated in radians. The final answers must be expressed as decimals; physical fluxes are computed internally in $\\text{W}\\,\\text{m}^{-2}$, but the output is unitless.",
            "solution": "The fundamental base is the plane-parallel Radiative Transfer Equation (RTE) for a non-scattering, isothermal, homogeneous medium, the Planck spectral radiance, and energy conservation through angular and spectral integration. We consider a gas slab at temperature $T=1800$ $\\text{K}$, with refractive index unity, bounded by vacuum on each side, so there is no incident external radiation. The gas absorbs and emits but does not scatter. The boundary conditions are $I_\\lambda(0,\\mu>0)=0$ and $I_\\lambda(L,\\mu<0)=0$.\n\nWe begin with the RTE in one spatial dimension,\n$$\n\\mu \\,\\frac{d I_\\lambda}{dx} \\;=\\; -\\kappa_\\lambda \\left(I_\\lambda - B_\\lambda(T)\\right),\n$$\nwith constant $\\kappa_\\lambda$ and $B_\\lambda(T)$ because the slab is homogeneous and isothermal. This is a first-order linear ordinary differential equation along each direction $\\mu$. The homogeneous solution decays exponentially, and the particular solution is constant at $B_\\lambda(T)$. Applying the boundary condition at $x=L$ for $\\mu<0$ gives the characteristic solution at the left boundary $x=0$ in the outward directions $\\mu<0$:\n$$\nI_\\lambda(0,\\mu<0) \\;=\\; B_\\lambda(T)\\,\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_\\lambda L}{|\\mu|}\\right)\\right].\n$$\nBy symmetry, the right boundary outward intensity is obtained similarly from the $x=0$ boundary condition for $\\mu>0$. We focus on the left boundary.\n\nThe outward hemispherical spectral heat flux at $x=0$ is\n$$\nq_\\lambda(0) \\;=\\; 2\\pi \\int_0^1 \\mu \\, I_\\lambda(0,-\\mu) \\, d\\mu,\n$$\nwhere the factor $2\\pi$ is the azimuthal integral for axisymmetry in a plane-parallel slab. Since we cannot analytically integrate $\\mu$ times the exponential term for an arbitrary discrete scheme, we invoke the Discrete Ordinates Method (DOM). The DOM replaces the angular integral by a quadrature over discrete direction cosines and weights. Specifically, we adopt the $S_4$ scheme on the half-range, using four Gauss–Legendre points $\\{\\mu_m\\}_{m=1}^4$ in $[0,1]$ and corresponding weights $\\{w_m\\}_{m=1}^4$. The quadrature approximates\n$$\n\\int_0^1 f(\\mu)\\, d\\mu \\;\\approx\\; \\sum_{m=1}^4 w_m \\, f(\\mu_m).\n$$\nThus,\n$$\nq_\\lambda(0) \\;\\approx\\; 2\\pi \\sum_{m=1}^4 w_m \\, \\mu_m \\, I_\\lambda(0,-\\mu_m).\n$$\nThe mixture absorption coefficient is additive in mole fractions under the given assumption:\n$$\n\\kappa_\\lambda^{\\text{mix}} \\;=\\; y_{\\mathrm{H_2O}}\\,\\kappa_\\lambda^{\\mathrm{H_2O}} \\;+\\; y_{\\mathrm{CO_2}}\\,\\kappa_\\lambda^{\\mathrm{CO_2}}.\n$$\nWe compute $I_\\lambda(0,-\\mu_m)$ for each wavelength and direction using the characteristic solution above.\n\nNext, we integrate $q_\\lambda(0)$ over wavelength to obtain the total outward heat flux,\n$$\nq_{\\text{spec}} \\;=\\; \\int q_\\lambda(0)\\, d\\lambda,\n$$\nwhich we evaluate via the trapezoidal rule on the provided wavelength grid (converted from micrometers to meters) to maintain consistency with the tabulated data.\n\nFor the gray approximation, we define the Planck-mean absorption coefficient, using the same tabulated spectral grid and trapezoidal rule,\n$$\n\\kappa_{\\text{P}} \\;=\\; \\frac{\\int \\kappa_\\lambda^{\\text{mix}} B_\\lambda(T)\\, d\\lambda}{\\int B_\\lambda(T)\\, d\\lambda}.\n$$\nWe introduce the spectrally integrated Planck radiance,\n$$\nB(T) \\;=\\; \\int B_\\lambda(T)\\, d\\lambda,\n$$\nin $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}$. The gray RTE for the spectrally integrated intensity $I(x,\\mu)$ retains the same form:\n$$\n\\mu \\,\\frac{d I}{dx} \\;=\\; -\\kappa_{\\text{P}} \\left(I - B(T)\\right).\n$$\nWith the same boundary conditions (zero incident radiation from vacuum) and constant coefficients, the characteristic solution at $x=0$ for outward directions $\\mu<0$ is\n$$\nI(0,\\mu<0) \\;=\\; B(T)\\,\\left[1 - \\exp\\!\\left(-\\frac{\\kappa_{\\text{P}} L}{|\\mu|}\\right)\\right].\n$$\nUsing the same $S_4$ quadrature,\n$$\nq_{\\text{gray}}(0) \\;\\approx\\; 2\\pi \\sum_{m=1}^4 w_m \\, \\mu_m \\, I(0,-\\mu_m).\n$$\n\nFinally, the relative gray error is defined as\n$$\n\\varepsilon \\;=\\; \\frac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}}.\n$$\nWe compute $\\varepsilon$ for each test case:\n- Case $1$: $L=0.05$ $\\text{m}$, $y_{\\mathrm{H_2O}}=0.10$, $y_{\\mathrm{CO_2}}=0.10$.\n- Case $2$: $L=0.001$ $\\text{m}$, $y_{\\mathrm{H_2O}}=0.10$, $y_{\\mathrm{CO_2}}=0.05$.\n- Case $3$: $L=0.20$ $\\text{m}$, $y_{\\mathrm{H_2O}}=0.05$, $y_{\\mathrm{CO_2}}=0.20$.\n\nAlgorithmic steps:\n- Convert wavelengths from micrometers to meters.\n- Compute $B_\\lambda(T)$ for each wavelength, using physical constants $h$, $c$, $k_B$.\n- Form $\\kappa_\\lambda^{\\text{mix}}$ from species mole fractions and tabulated $\\kappa_\\lambda$.\n- Construct $S_4$ half-range Gauss–Legendre nodes $\\mu_m$ and weights $w_m$.\n- Spectral DOM: For each wavelength, evaluate $I_\\lambda(0,-\\mu_m)$ and compute $q_\\lambda(0)$; then integrate over $\\lambda$ to obtain $q_{\\text{spec}}$.\n- Gray DOM: Compute $\\kappa_{\\text{P}}$ and $B(T)$ via trapezoidal integration; evaluate $I(0,-\\mu_m)$ and compute $q_{\\text{gray}}$.\n- Report $\\varepsilon$ for each case as decimals in the required single-line format.\n\nThis approach aligns with the Discrete Ordinates Method (DOM) for angular integration, uses the exact characteristic solution for the RTE under constant properties, and applies Planck weighting for the gray approximation. All quantities are computed in consistent units; the final reported errors are unitless.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants\nh = 6.62607015e-34       # Planck constant, J*s\nc = 2.99792458e8         # speed of light, m/s\nkB = 1.380649e-23        # Boltzmann constant, J/K\n\nT = 1800.0  # K\n\n# Tabulated spectral data at T=1800 K, P=1 atm\n# Wavelengths in micrometers; will convert to meters\nlambda_um = np.array([2.0, 2.7, 4.3, 5.0, 10.0], dtype=float)\nlambda_m = lambda_um * 1e-6\n\n# Species absorption coefficients (per unit mole fraction) in 1/m\nkappa_H2O = np.array([0.2, 5.0, 0.5, 0.3, 0.1], dtype=float)\nkappa_CO2 = np.array([0.1, 0.3, 8.0, 0.4, 0.2], dtype=float)\n\ndef planck_lambda(lam, T):\n    \"\"\"\n    Planck spectral radiance B_lambda(T) [W m^-3 sr^-1] for wavelength lam [m].\n    \"\"\"\n    # Avoid overflow/underflow issues with large/small arguments\n    x = (h * c) / (lam * kB * T)\n    # Use expm1 for numerical stability: 1/(exp(x)-1) = 1/expm1(x)\n    return (2.0 * h * c**2) / (lam**5) / np.expm1(x)\n\ndef half_range_gauss_legendre(n):\n    \"\"\"\n    Half-range Gauss-Legendre quadrature on [0,1].\n    Returns nodes mu in [0,1] and weights w for integrating f(mu) over [0,1].\n    \"\"\"\n    # Legendre nodes/weights on [-1, 1]\n    xi, wi = np.polynomial.legendre.leggauss(n)\n    # Map to [0, 1]: mu = (xi + 1)/2, w = wi/2\n    mu = 0.5 * (xi + 1.0)\n    w = 0.5 * wi\n    return mu, w\n\ndef spectral_flux_left(L, y_H2O, y_CO2):\n    \"\"\"\n    Compute the spectrally resolved outward hemispherical heat flux at the left boundary.\n    \"\"\"\n    # Mixture absorption coefficient at each wavelength\n    kappa_mix = y_H2O * kappa_H2O + y_CO2 * kappa_CO2  # 1/m\n    # Planck spectral radiance at each wavelength\n    B_lam = planck_lambda(lambda_m, T)  # W m^-3 sr^-1\n\n    # S4 half-range quadrature\n    mu, w = half_range_gauss_legendre(4)\n\n    # For each wavelength, compute q_lambda via DOM:\n    # I_lambda(0, -mu) = B_lambda(T) * [1 - exp(-kappa_mix * L / mu)]\n    # q_lambda = 2*pi * sum_m w_m * mu_m * I_lambda(0, -mu_m)\n    I_boundary = B_lam[:, None] * (1.0 - np.exp(-(kappa_mix[:, None] * L) / mu[None, :]))\n    q_lambda = 2.0 * np.pi * np.sum(w[None, :] * mu[None, :] * I_boundary, axis=1)  # W m^-3\n\n    # Integrate q_lambda over wavelength to get total flux [W m^-2]\n    q_spec = np.trapz(q_lambda, lambda_m)\n    return q_spec\n\ndef gray_flux_left(L, y_H2O, y_CO2):\n    \"\"\"\n    Compute the gray outward hemispherical heat flux at the left boundary using Planck-mean kappa.\n    \"\"\"\n    kappa_mix = y_H2O * kappa_H2O + y_CO2 * kappa_CO2  # 1/m\n    B_lam = planck_lambda(lambda_m, T)  # W m^-3 sr^-1\n\n    # Spectrally integrated B(T) and Planck-mean kappa\n    B_total = np.trapz(B_lam, lambda_m)  # W m^-2 sr^-1\n    numerator = np.trapz(kappa_mix * B_lam, lambda_m)  # (1/m) * W m^-3 sr^-1 integrated -> W m^-2 sr^-1 / m\n    kappa_P = numerator / B_total  # 1/m\n\n    mu, w = half_range_gauss_legendre(4)\n\n    # I(0, -mu) = B_total * [1 - exp(-kappa_P * L / mu)]\n    I_gray_boundary = B_total * (1.0 - np.exp(-(kappa_P * L) / mu))\n    q_gray = 2.0 * np.pi * np.sum(w * mu * I_gray_boundary)  # W m^-2\n    return q_gray\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (L [m], y_H2O, y_CO2)\n    test_cases = [\n        (0.05, 0.10, 0.10),   # Case 1: typical\n        (0.001, 0.10, 0.05),  # Case 2: optically thin\n        (0.20, 0.05, 0.20),   # Case 3: optically thick, CO2-dominant band\n    ]\n\n    results = []\n    for L, yH2O, yCO2 in test_cases:\n        q_spec = spectral_flux_left(L, yH2O, yCO2)\n        q_gray = gray_flux_left(L, yH2O, yCO2)\n        # Relative error as decimal\n        err = (q_gray - q_spec) / q_spec\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}