{
    "hands_on_practices": [
        {
            "introduction": "In high-temperature applications like combustion, material properties such as thermal conductivity can vary significantly with temperature. While assuming constant properties simplifies analysis, it can introduce substantial errors. This exercise provides a concrete way to quantify the impact of this crucial modeling assumption, comparing a variable-property formulation to a constant-property one in a representative conjugate heat transfer problem . By working through this, you will gain a deeper appreciation for the importance of accurate physical modeling in predicting wall heat flux and temperature.",
            "id": "4014016",
            "problem": "A high-temperature reacting gas flows over a cooled metal wall. The reacting zone is sufficiently far from the wall that, in the immediate near-wall region of thickness $\\delta$, there is no homogeneous heat release and the energy transfer across this fluid film is dominated by steady one-dimensional conduction. The gas temperature outside the film is $T_{b}$, the wall temperature is $T_{w}$, and the coolant temperature at the inner surface of the solid wall is $T_{c}$. The gas exhibits temperature-dependent thermal conductivity $k(T)$ that increases with temperature according to $k(T) = k_{0}\\left(\\frac{T}{T_{0}}\\right)^{n}$, with $n=1$. The solid wall is a planar slab of thickness $L_{s}$ with constant thermal conductivity $k_{s}$, and it conducts heat one-dimensionally to the coolant.\n\nAssume steady state, no radiation, and negligible viscous dissipation in the near-wall film. In this conjugate heat transfer configuration, the heat flux $q''$ is continuous across the fluid-solid interface and the wall temperature $T_{w}$ adjusts to satisfy both fluid and solid conduction. Starting from the steady one-dimensional energy equation and Fourier’s law, derive the expressions relating $q''$ and $T_{w}$ in the variable-property case (with $k(T)$ as specified) and in the constant-property approximation (where $k$ is assumed equal to the reference value $k_{0}$ for the fluid film). Using the following data:\n- $T_{b} = 2200\\,\\text{K}$,\n- $T_{c} = 300\\,\\text{K}$,\n- $k_{0} = 0.12\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$,\n- $T_{0} = 1000\\,\\text{K}$,\n- $n = 1$,\n- $\\delta = 2.0\\times 10^{-4}\\,\\text{m}$,\n- $k_{s} = 15\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$,\n- $L_{s} = 5.0\\times 10^{-3}\\,\\text{m}$,\n\ncompute the relative deviation in wall heat flux incurred by the constant-property assumption, defined as the dimensionless quantity\n$$\\varepsilon = \\frac{|q''_{\\text{const}} - q''_{\\text{var}}|}{q''_{\\text{var}}},$$\nwhere $q''_{\\text{var}}$ is the wall heat flux obtained using the variable-property formulation $k(T) = k_{0}\\left(\\frac{T}{T_{0}}\\right)$ and $q''_{\\text{const}}$ is the wall heat flux obtained using the constant-property approximation $k = k_{0}$.\n\nExpress the final answer for $\\varepsilon$ as a decimal fraction and round your result to four significant figures. No units are required for $\\varepsilon$ since it is dimensionless.",
            "solution": "The scenario is a conjugate heat transfer problem with a reacting gas, but the near-wall film is non-reacting and steady. We begin with the fundamental laws governing heat conduction. In the fluid film, steady one-dimensional energy balance with no internal heat generation yields\n$$\\frac{d}{dy}\\left(k(T)\\frac{dT}{dy}\\right) = 0,$$\nwhich implies that $k(T)\\frac{dT}{dy}$ is a constant across the film. By Fourier’s law, the wall heat flux $q''$ is\n$$q'' = -k(T)\\frac{dT}{dy}.$$\nTherefore, $k(T)\\frac{dT}{dy} = -q''$ and\n$$\\frac{dT}{dy} = -\\frac{q''}{k(T)}.$$\nSeparating variables and integrating from the wall ($y=0$, $T=T_{w}$) to the edge of the film ($y=\\delta$, $T=T_{b}$) gives\n$$\\int_{0}^{\\delta} dy = \\int_{T_{w}}^{T_{b}} \\frac{k(T)}{q''}\\, dT,$$\nso\n$$\\delta = \\frac{1}{q''}\\int_{T_{w}}^{T_{b}} k(T)\\, dT.$$\nThis yields the general relation for the conduction-only film with variable conductivity,\n$$q'' = \\frac{1}{\\delta}\\int_{T_{w}}^{T_{b}} k(T)\\, dT.$$\n\nIn the solid wall, one-dimensional steady conduction to the coolant produces a heat flux\n$$q'' = \\frac{k_{s}}{L_{s}}(T_{w} - T_{c}),$$\nwhich must equal the fluid-side heat flux by continuity at the interface.\n\nVariable-property fluid case: with $k(T) = k_{0}\\left(\\frac{T}{T_{0}}\\right)$, the integral becomes\n$$\\int_{T_{w}}^{T_{b}} k(T)\\, dT = \\int_{T_{w}}^{T_{b}} k_{0}\\frac{T}{T_{0}}\\, dT = \\frac{k_{0}}{T_{0}}\\left[\\frac{T^{2}}{2}\\right]_{T_{w}}^{T_{b}} = \\frac{k_{0}}{2 T_{0}}\\left(T_{b}^{2} - T_{w}^{2}\\right).$$\nThus,\n$$q''_{\\text{var}} = \\frac{k_{0}}{2 T_{0} \\delta}\\left(T_{b}^{2} - T_{w}^{2}\\right).$$\nConjugate matching with the solid gives\n$$\\frac{k_{0}}{2 T_{0} \\delta}\\left(T_{b}^{2} - T_{w}^{2}\\right) = \\frac{k_{s}}{L_{s}}(T_{w} - T_{c}).$$\nDefine\n$$a = \\frac{k_{0}}{2 T_{0} \\delta}, \\quad b = \\frac{k_{s}}{L_{s}},$$\nso the equation becomes\n$$a\\left(T_{b}^{2} - T_{w}^{2}\\right) = b\\left(T_{w} - T_{c}\\right).$$\nRearranging to a quadratic in $T_{w}$,\n$$a T_{w}^{2} + b T_{w} - \\left(a T_{b}^{2} + b T_{c}\\right) = 0.$$\nSolving for $T_{w}$,\n$$T_{w,\\text{var}} = \\frac{-b + \\sqrt{b^{2} + 4 a\\left(a T_{b}^{2} + b T_{c}\\right)}}{2 a},$$\nwhere the positive branch is taken to ensure $T_{w}$ lies between $T_{c}$ and $T_{b}$.\n\nConstant-property fluid case: assume $k(T) = k_{0}$ throughout the film. Then the fluid-side heat flux is\n$$q''_{\\text{const}} = \\frac{k_{0}}{\\delta}\\left(T_{b} - T_{w}\\right).$$\nConjugate matching with the solid gives\n$$\\frac{k_{0}}{\\delta}\\left(T_{b} - T_{w}\\right) = \\frac{k_{s}}{L_{s}}(T_{w} - T_{c}).$$\nSolving for $T_{w}$,\n$$\\left(b + \\frac{k_{0}}{\\delta}\\right) T_{w} = \\frac{k_{0}}{\\delta} T_{b} + b T_{c},$$\nso\n$$T_{w,\\text{const}} = \\frac{\\left(\\frac{k_{0}}{\\delta}\\right) T_{b} + b T_{c}}{b + \\frac{k_{0}}{\\delta}}.$$\n\nWith the given parameters,\n$$T_{b} = 2200,\\quad T_{c} = 300,\\quad k_{0} = 0.12,\\quad T_{0} = 1000,\\quad \\delta = 2.0\\times 10^{-4},\\quad k_{s} = 15,\\quad L_{s} = 5.0\\times 10^{-3},$$\ncompute\n$$a = \\frac{0.12}{2 \\cdot 1000 \\cdot 2.0\\times 10^{-4}} = \\frac{0.12}{0.4} = 0.3,$$\n$$b = \\frac{15}{5.0\\times 10^{-3}} = 3000.$$\n\nVariable-property wall temperature:\n$$T_{w,\\text{var}} = \\frac{-3000 + \\sqrt{3000^{2} + 4 \\cdot 0.3\\left(0.3 \\cdot 2200^{2} + 3000 \\cdot 300\\right)}}{2 \\cdot 0.3}.$$\nCompute the inner terms:\n$$0.3 \\cdot 2200^{2} = 0.3 \\cdot 4{,}840{,}000 = 1{,}452{,}000,$$\n$$3000 \\cdot 300 = 900{,}000,$$\n$$a T_{b}^{2} + b T_{c} = 1{,}452{,}000 + 900{,}000 = 2{,}352{,}000,$$\n$$b^{2} + 4 a\\left(a T_{b}^{2} + b T_{c}\\right) = 9{,}000{,}000 + 4 \\cdot 0.3 \\cdot 2{,}352{,}000 = 9{,}000{,}000 + 2{,}822{,}400 = 11{,}822{,}400,$$\n$$\\sqrt{11{,}822{,}400} \\approx 3438.3715.$$\nThus,\n$$T_{w,\\text{var}} \\approx \\frac{-3000 + 3438.3715}{0.6} \\approx \\frac{438.3715}{0.6} \\approx 730.6192.$$\n\nVariable-property heat flux by solid conduction:\n$$q''_{\\text{var}} = b\\left(T_{w,\\text{var}} - T_{c}\\right) \\approx 3000 \\cdot (730.6192 - 300) \\approx 3000 \\cdot 430.6192 \\approx 1{,}291{,}858.7.$$\n\nConstant-property wall temperature:\n$$\\frac{k_{0}}{\\delta} = \\frac{0.12}{2.0\\times 10^{-4}} = 600,$$\n$$T_{w,\\text{const}} = \\frac{600 \\cdot 2200 + 3000 \\cdot 300}{3000 + 600} = \\frac{1{,}320{,}000 + 900{,}000}{3600} = \\frac{2{,}220{,}000}{3600} \\approx 616.6667.$$\n\nConstant-property heat flux:\n$$q''_{\\text{const}} = b\\left(T_{w,\\text{const}} - T_{c}\\right) = 3000 \\cdot (616.6667 - 300) = 3000 \\cdot 316.6667 = 950{,}000.$$\n\nRelative deviation:\n$$\\varepsilon = \\frac{|q''_{\\text{const}} - q''_{\\text{var}}|}{q''_{\\text{var}}} = \\frac{1{,}291{,}858.7 - 950{,}000}{1{,}291{,}858.7} \\approx \\frac{341{,}858.7}{1{,}291{,}858.7} \\approx 0.2646.$$\n\nRounding to four significant figures, the dimensionless deviation is $0.2646$.",
            "answer": "$$\\boxed{0.2646}$$"
        },
        {
            "introduction": "When solving the time-dependent energy equations with an explicit numerical scheme, the choice of the time step, $\\Delta t$, is critical for achieving a stable solution. Too large a timestep can cause unphysical oscillations that grow unboundedly, destroying the simulation. This practice guides you through the first-principles derivation of the stability constraints imposed by advection (the Courant–Friedrichs–Lewy or CFL condition) and diffusion in both the fluid and solid domains . Mastering this analysis is essential for anyone developing or using explicit solvers for computational fluid dynamics and conjugate heat transfer.",
            "id": "4013967",
            "problem": "A rectangular channel of a reacting gas is in conjugate contact with a solid wall. The energy equation for the gas and solid, respectively, are, under the assumptions of constant properties and negligible radiative exchange, given by the conservation of energy in the form $ \\rho c_{p} \\, \\frac{\\partial T}{\\partial t} + \\rho c_{p} \\, \\boldsymbol{u} \\cdot \\nabla T = \\nabla \\cdot \\left( k \\nabla T \\right) + \\dot{q}$ in the fluid and $ \\rho_{s} c_{p,s} \\, \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left( k_{s} \\nabla T \\right)$ in the solid. The conjugate interface enforces continuity of temperature and normal heat flux. Consider an explicit, single-step, unsplit update of temperature in both domains using forward Euler in time. In the fluid, advection is discretized by first-order upwind differences, and diffusion by second-order central differences. In the solid, only diffusion is present and is discretized identically. Assume the chemical source term $ \\dot{q}$ is treated in a way that does not impose a stricter timestep than advection or diffusion for the purpose of this stability analysis.\n\nStarting from the conservation statements above and the stated discretizations, derive the Courant–Friedrichs–Lewy (CFL) advection constraint and the explicit diffusion constraint that must be satisfied to ensure stability of this explicit conjugate solver on a three-dimensional, uniform Cartesian mesh. Your derivation must proceed from the discrete update implied by forward Euler and the spatial discretizations, and justify the form of the constraints without invoking any pre-memorized formulas.\n\nThen, for the following scientifically plausible property set and mesh, compute the maximum allowable timestep that satisfies both constraints simultaneously. Use the most restrictive constraint across both the fluid and the solid domains.\n\nFluid domain:\n- Mesh spacings are $ \\Delta x_{f} = 5.0 \\times 10^{-4} \\ \\mathrm{m}$, $ \\Delta y_{f} = 2.5 \\times 10^{-4} \\ \\mathrm{m}$, and $ \\Delta z_{f} = 1.0 \\times 10^{-3} \\ \\mathrm{m}$.\n- Velocity components are $ u_{x} = 25 \\ \\mathrm{m/s}$, $ u_{y} = 2 \\ \\mathrm{m/s}$, and $ u_{z} = 0 \\ \\mathrm{m/s}$.\n- Thermophysical properties are $ \\rho_{f} = 1.2 \\ \\mathrm{kg/m^{3}}$, $ c_{p,f} = 1.0 \\times 10^{3} \\ \\mathrm{J/(kg \\cdot K)}$, and $ k_{f} = 8.0 \\times 10^{-2} \\ \\mathrm{W/(m \\cdot K)}$.\n\nSolid domain:\n- Mesh spacings are $ \\Delta x_{s} = 2.5 \\times 10^{-4} \\ \\mathrm{m}$, $ \\Delta y_{s} = 2.5 \\times 10^{-4} \\ \\mathrm{m}$, and $ \\Delta z_{s} = 1.0 \\times 10^{-3} \\ \\mathrm{m}$.\n- Thermophysical properties are $ \\rho_{s} = 8.0 \\times 10^{3} \\ \\mathrm{kg/m^{3}}$, $ c_{p,s} = 5.0 \\times 10^{2} \\ \\mathrm{J/(kg \\cdot K)}$, and $ k_{s} = 1.6 \\times 10^{1} \\ \\mathrm{W/(m \\cdot K)}$.\n- The solid is stationary, so $ \\boldsymbol{u}_{s} = \\boldsymbol{0}$.\n\nDefine the fluid thermal diffusivity $ \\alpha_{f} = \\frac{k_{f}}{\\rho_{f} c_{p,f}}$ and the solid thermal diffusivity $ \\alpha_{s} = \\frac{k_{s}}{\\rho_{s} c_{p,s}}$ and compute the stability-limiting explicit diffusion constraint for each domain on its respective mesh. Likewise, compute the CFL advection constraint in the fluid domain.\n\nFinally, report the maximum allowable timestep as the minimum over all constraints (fluid advection and fluid/solid diffusion). Round your final numerical answer to four significant figures and express it in seconds.",
            "solution": "The problem requires the derivation of stability constraints for an explicit numerical scheme applied to a conjugate heat transfer problem, followed by the calculation of the maximum stable timestep for a given set of physical parameters. The derivation must originate from the governing equations and the specified discretization methods.\n\nFirst, we address the fluid domain. The governing energy equation is:\n$$ \\rho_{f} c_{p,f} \\, \\frac{\\partial T}{\\partial t} + \\rho_{f} c_{p,f} \\, \\boldsymbol{u} \\cdot \\nabla T = \\nabla \\cdot \\left( k_{f} \\nabla T \\right) + \\dot{q} $$\nWe divide by $ \\rho_{f} c_{p,f} $ to introduce the thermal diffusivity $ \\alpha_{f} = \\frac{k_{f}}{\\rho_{f} c_{p,f}} $:\n$$ \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T = \\alpha_{f} \\nabla^{2} T + \\frac{\\dot{q}}{\\rho_{f} c_{p,f}} $$\nThe problem specifies a forward Euler scheme for the time derivative, first-order upwind for the advection term $ \\boldsymbol{u} \\cdot \\nabla T $, and second-order central differences for the diffusion term $ \\alpha_{f} \\nabla^{2} T $. Let $ T_{i,j,k}^{n} $ denote the temperature at grid point $ (i,j,k) $ at time level $ n $. The discretized equation is:\n$$ \\frac{T_{i,j,k}^{n+1} - T_{i,j,k}^{n}}{\\Delta t} = -(\\boldsymbol{u} \\cdot \\nabla T)_{i,j,k}^{n} + (\\alpha_{f} \\nabla^{2} T)_{i,j,k}^{n} + \\frac{\\dot{q}_{i,j,k}^{n}}{\\rho_{f} c_{p,f}} $$\nThe spatial terms are discretized as follows. For advection, using first-order upwind differences on a $3$D Cartesian mesh (assuming for simplicity $ u_x, u_y, u_z > 0 $, the general form with absolute values is equivalent for stability analysis):\n$$ (\\boldsymbol{u} \\cdot \\nabla T)_{i,j,k}^{n} \\approx u_{x} \\frac{T_{i,j,k}^{n} - T_{i-1,j,k}^{n}}{\\Delta x_{f}} + u_{y} \\frac{T_{i,j,k}^{n} - T_{i,j-1,k}^{n}}{\\Delta y_{f}} + u_{z} \\frac{T_{i,j,k}^{n} - T_{i,j,k-1}^{n}}{\\Delta z_{f}} $$\nFor diffusion, using second-order central differences:\n$$ (\\nabla^{2} T)_{i,j,k}^{n} \\approx \\frac{T_{i+1,j,k}^{n} - 2T_{i,j,k}^{n} + T_{i-1,j,k}^{n}}{(\\Delta x_{f})^{2}} + \\frac{T_{i,j+1,k}^{n} - 2T_{i,j,k}^{n} + T_{i,j-1,k}^{n}}{(\\Delta y_{f})^{2}} + \\frac{T_{i,j,k+1}^{n} - 2T_{i,j,k}^{n} + T_{i,j,k-1}^{n}}{(\\Delta z_{f})^{2}} $$\nSubstituting these approximations into the time-discretized equation and solving for $ T_{i,j,k}^{n+1} $:\n$$ T_{i,j,k}^{n+1} = T_{i,j,k}^{n} - \\Delta t \\left( u_{x} \\frac{T_{i,j,k}^{n} - T_{i-1,j,k}^{n}}{\\Delta x_{f}} + \\dots \\right) + \\Delta t \\, \\alpha_{f} \\left( \\frac{T_{i+1,j,k}^{n} - 2T_{i,j,k}^{n} + T_{i-1,j,k}^{n}}{(\\Delta x_{f})^{2}} + \\dots \\right) + \\Delta t \\frac{\\dot{q}_{i,j,k}^{n}}{\\rho_{f} c_{p,f}} $$\nFor stability of this explicit scheme, the coefficient of the central node temperature $ T_{i,j,k}^{n} $ on the right-hand side must be non-negative. We collect all terms multiplying $ T_{i,j,k}^{n} $. Note that for any velocity direction, the upwind scheme contributes a term $ \\frac{|u_{\\beta}|}{\\Delta \\beta_{f}} T_{i,j,k}^{n} $ where $ \\beta \\in \\{x,y,z\\} $. The problem also assumes the source term $ \\dot{q} $ does not introduce a stricter stability constraint, so we treat it as independent of $ T_{i,j,k}^{n} $.\nThe coefficient of $ T_{i,j,k}^{n} $ is:\n$$ C_{f} = 1 - \\Delta t \\left( \\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}} \\right) - \\Delta t \\cdot 2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right) $$\nThe stability condition $ C_{f} \\ge 0 $ requires that:\n$$ \\Delta t \\left[ \\left( \\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}} \\right) + 2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right) \\right] \\le 1 $$\nThis single condition implies two separate constraints that must be satisfied. The Courant-Friedrichs-Lewy (CFL) advection constraint is:\n$$ \\Delta t_{adv,f} \\le \\frac{1}{\\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}}} $$\nThe explicit diffusion constraint is:\n$$ \\Delta t_{diff,f} \\le \\frac{1}{2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right)} $$\n\nNext, we address the solid domain. The governing equation is simpler as there is no advection or source term:\n$$ \\rho_{s} c_{p,s} \\, \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left( k_{s} \\nabla T \\right) $$\nDividing by $ \\rho_{s} c_{p,s} $ introduces the solid thermal diffusivity $ \\alpha_{s} = \\frac{k_{s}}{\\rho_{s} c_{p,s}} $:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha_{s} \\nabla^{2} T $$\nDiscretizing with forward Euler in time and second-order central differences in space yields:\n$$ \\frac{T_{i,j,k}^{n+1} - T_{i,j,k}^{n}}{\\Delta t} = \\alpha_{s} \\left( \\frac{T_{i+1,j,k}^{n} - 2T_{i,j,k}^{n} + T_{i-1,j,k}^{n}}{(\\Delta x_{s})^{2}} + \\dots \\right) $$\nSolving for $ T_{i,j,k}^{n+1} $ and collecting the coefficient of $ T_{i,j,k}^{n} $:\n$$ C_{s} = 1 - \\Delta t \\cdot 2\\alpha_{s} \\left( \\frac{1}{(\\Delta x_{s})^{2}} + \\frac{1}{(\\Delta y_{s})^{2}} + \\frac{1}{(\\Delta z_{s})^{2}} \\right) $$\nThe stability condition $ C_{s} \\ge 0 $ yields the diffusion constraint for the solid:\n$$ \\Delta t_{diff,s} \\le \\frac{1}{2\\alpha_{s} \\left( \\frac{1}{(\\Delta x_{s})^{2}} + \\frac{1}{(\\Delta y_{s})^{2}} + \\frac{1}{(\\Delta z_{s})^{2}} \\right)} $$\nThere is no advection constraint for the stationary solid.\n\nWith the constraints derived, we now compute the maximum allowable timestep using the provided data.\nFirst, we compute the thermal diffusivities.\nFluid thermal diffusivity:\n$$ \\alpha_{f} = \\frac{k_{f}}{\\rho_{f} c_{p,f}} = \\frac{8.0 \\times 10^{-2} \\ \\mathrm{W/(m \\cdot K)}}{(1.2 \\ \\mathrm{kg/m^{3}}) \\cdot (1.0 \\times 10^{3} \\ \\mathrm{J/(kg \\cdot K)})} = \\frac{8.0 \\times 10^{-2}}{1.2 \\times 10^{3}} \\ \\mathrm{m^2/s} = \\frac{1}{15000} \\ \\mathrm{m^2/s} \\approx 6.667 \\times 10^{-5} \\ \\mathrm{m^2/s} $$\nSolid thermal diffusivity:\n$$ \\alpha_{s} = \\frac{k_{s}}{\\rho_{s} c_{p,s}} = \\frac{1.6 \\times 10^{1} \\ \\mathrm{W/(m \\cdot K)}}{(8.0 \\times 10^{3} \\ \\mathrm{kg/m^{3}}) \\cdot (5.0 \\times 10^{2} \\ \\mathrm{J/(kg \\cdot K)})} = \\frac{16}{4.0 \\times 10^{6}} \\ \\mathrm{m^2/s} = 4.0 \\times 10^{-6} \\ \\mathrm{m^2/s} $$\n\nNow, we evaluate the timestep constraints.\nFluid advection constraint:\n$$ \\sum_{adv,f} = \\frac{|u_{x}|}{\\Delta x_{f}} + \\frac{|u_{y}|}{\\Delta y_{f}} + \\frac{|u_{z}|}{\\Delta z_{f}} = \\frac{25}{5.0 \\times 10^{-4}} + \\frac{2}{2.5 \\times 10^{-4}} + \\frac{0}{1.0 \\times 10^{-3}} $$\n$$ \\sum_{adv,f} = (5.0 \\times 10^{4}) + (0.8 \\times 10^{4}) + 0 = 5.8 \\times 10^{4} \\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{adv,f} \\le \\frac{1}{5.8 \\times 10^{4}} \\ \\mathrm{s} \\approx 1.7241 \\times 10^{-5} \\ \\mathrm{s} $$\nFluid diffusion constraint:\n$$ \\sum_{diff,f} = 2\\alpha_{f} \\left( \\frac{1}{(\\Delta x_{f})^{2}} + \\frac{1}{(\\Delta y_{f})^{2}} + \\frac{1}{(\\Delta z_{f})^{2}} \\right) $$\n$$ \\sum_{diff,f} = 2 \\left( \\frac{1}{15000} \\right) \\left( \\frac{1}{(5.0 \\times 10^{-4})^{2}} + \\frac{1}{(2.5 \\times 10^{-4})^{2}} + \\frac{1}{(1.0 \\times 10^{-3})^{2}} \\right) $$\n$$ \\sum_{diff,f} = \\frac{2}{15000} \\left( 4.0 \\times 10^{6} + 16.0 \\times 10^{6} + 1.0 \\times 10^{6} \\right) = \\frac{2 \\times (21.0 \\times 10^{6})}{1.5 \\times 10^{4}} = 2800 \\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{diff,f} \\le \\frac{1}{2800} \\ \\mathrm{s} \\approx 3.5714 \\times 10^{-4} \\ \\mathrm{s} $$\nSolid diffusion constraint:\n$$ \\sum_{diff,s} = 2\\alpha_{s} \\left( \\frac{1}{(\\Delta x_{s})^{2}} + \\frac{1}{(\\Delta y_{s})^{2}} + \\frac{1}{(\\Delta z_{s})^{2}} \\right) $$\n$$ \\sum_{diff,s} = 2(4.0 \\times 10^{-6}) \\left( \\frac{1}{(2.5 \\times 10^{-4})^{2}} + \\frac{1}{(2.5 \\times 10^{-4})^{2}} + \\frac{1}{(1.0 \\times 10^{-3})^{2}} \\right) $$\n$$ \\sum_{diff,s} = 8.0 \\times 10^{-6} \\left( 16.0 \\times 10^{6} + 16.0 \\times 10^{6} + 1.0 \\times 10^{6} \\right) = 8.0 \\times 10^{-6} (33.0 \\times 10^{6}) = 264 \\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{diff,s} \\le \\frac{1}{264} \\ \\mathrm{s} \\approx 3.7879 \\times 10^{-3} \\ \\mathrm{s} $$\n\nThe maximum allowable timestep for the entire conjugate system, $ \\Delta t_{max} $, must satisfy all constraints simultaneously. Therefore, it is the minimum of the individual limits:\n$$ \\Delta t_{max} = \\min(\\Delta t_{adv,f}, \\Delta t_{diff,f}, \\Delta t_{diff,s}) $$\n$$ \\Delta t_{max} = \\min(1.7241 \\times 10^{-5}, 3.5714 \\times 10^{-4}, 3.7879 \\times 10^{-3}) \\ \\mathrm{s} $$\nThe most restrictive constraint is the advection limit in the fluid domain.\n$$ \\Delta t_{max} = 1.7241 \\times 10^{-5} \\ \\mathrm{s} $$\nRounding to four significant figures as required, we obtain the final answer.\n$$ \\Delta t_{max} \\approx 1.724 \\times 10^{-5} \\ \\mathrm{s} $$",
            "answer": "$$\\boxed{1.724 \\times 10^{-5}}$$"
        },
        {
            "introduction": "A key goal in analyzing conjugate heat transfer in reacting flows is to understand not just the total heat load on a surface, but also the contributions from different physical mechanisms. The total wall heat flux is a sum of components from molecular conduction, turbulent transport, species diffusion, and thermal radiation. This coding exercise challenges you to dissect the total flux by implementing models for each component based on near-wall flow data . This form of post-processing analysis provides invaluable physical insight and is a standard practice in the field.",
            "id": "4013965",
            "problem": "Consider a one-dimensional, steady, wall-normal slice of a reacting turbulent flow adjacent to an isothermal, inert wall, within the context of conjugate heat transfer with reacting flows. Let the wall-normal coordinate be $y$, increasing from the wall into the fluid. Assume the following physically standard modeling closures and definitions as the fundamental base: Fourier’s law for molecular heat conduction, the eddy diffusivity concept for turbulent thermal transport with a prescribed turbulent Prandtl number, Fick’s law for species diffusion with mixture-averaged diffusion coefficients, and the Rosseland diffusion approximation for radiative heat transfer in an optically thick, gray, participating medium. The flow is ideal gas at uniform static pressure.\n\nStarting from the conservation of energy for a compressible, reacting flow, and invoking steady conditions and negligible viscous dissipation and pressure work in the near-wall layer, one can express the total wall heat flux (into the wall) as the sum of four components arising from molecular conduction, turbulent transport, diffusive enthalpy due to species gradients, and radiation. Using computed near-wall fields on a uniform grid $y \\in [0, y_{\\mathrm{max}}]$, you will construct each component consistently with the directionality defined above (positive when the net energy transfer is into the wall). Specifically, use the following modeling foundations for each component:\n- Molecular conduction: Fourier’s law with thermal conductivity $k(T)$.\n- Turbulent thermal transport: an eddy thermal conductivity $k_t = \\rho c_{p,\\mathrm{mix}} \\nu_t / \\mathrm{Pr}_t$, where $\\nu_t$ is the eddy viscosity and $\\mathrm{Pr}_t$ is the turbulent Prandtl number.\n- Diffusive enthalpy flux: species-wise enthalpy $h_j(T)$ multiplying the mass diffusion flux modeled by mixture-averaged diffusivity $D_j$ and gradient of mass fraction $Y_j$.\n- Radiation: the Rosseland diffusion approximation, in which an effective radiative conductivity $k_r = \\dfrac{16 \\sigma T^3}{3 \\kappa}$ multiplies the wall-normal temperature gradient, where $\\sigma$ is the Stefan–Boltzmann constant and $\\kappa$ is the absorption coefficient.\n\nUse the following specific forms and constants:\n- Ideal gas law at the wall: $\\rho_w = \\dfrac{p}{R_{\\mathrm{mix}} T_w}$, where $p$ is static pressure, $T_w$ is wall temperature, and $R_{\\mathrm{mix}} = \\dfrac{R_u}{M_{\\mathrm{mix}}}$ with $M_{\\mathrm{mix}}$ the mixture molecular weight computed from mass fractions $Y_{j,w}$ and species molecular weights $M_j$ via $M_{\\mathrm{mix}} = \\left(\\sum_j \\dfrac{Y_{j,w}}{M_j}\\right)^{-1}$ and $R_u$ is the universal gas constant.\n- Mixture heat capacity at constant pressure at the wall: $c_{p,\\mathrm{mix},w} = \\sum_j Y_{j,w} c_{p,j}$, with species constant $c_{p,j}$ values.\n- Species enthalpy at the wall: $h_{j,w} = c_{p,j} T_w$ (valid for moderate ranges when $c_{p,j}$ is treated constant over the near-wall temperature interval).\n- Thermal conductivity model: $k(T) = k_0 \\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right)^n$ with specified constants $k_0$, $T_{\\mathrm{ref}}$, and $n$.\n- Turbulent eddy viscosity: $\\nu_t = C_\\mu u_{\\mathrm{rms}} \\ell_{\\mathrm{mix}}$, where $C_\\mu$ is a constant, $u_{\\mathrm{rms}}$ is the root-mean-square velocity fluctuation, and $\\ell_{\\mathrm{mix}}$ is a mixing length.\n- Absorption coefficient: $\\kappa = \\kappa_0 + \\alpha X_{\\mathrm{H_2O},w}$, where $X_{\\mathrm{H_2O},w}$ is the mole fraction of water at the wall. Convert mass fractions at the wall to mole fractions via $X_j = \\dfrac{Y_j/M_j}{\\sum_k Y_k/M_k}$.\n\nGrid and derivative approximation:\n- Use a uniform grid with spacing $h$ and nodes at $y_0 = 0$, $y_1 = h$, and $y_2 = 2h$.\n- Approximate the wall-normal gradient of any scalar $f$ at the wall using a second-order forward difference: $f'_w \\approx \\dfrac{-3 f_0 + 4 f_1 - f_2}{2 h}$.\n\nNear-wall fields:\n- Temperature profile: $T(y) = T_w + \\left(T_g - T_w\\right)\\left(1 - e^{-y/\\delta_T}\\right)$.\n- Species mass fraction profiles: $Y_j(y) = Y_{j,w} + \\left(Y_{j,\\infty} - Y_{j,w}\\right)\\left(1 - e^{-y/\\delta_s}\\right)$.\n- Assume $Y_{j,w} = \\beta Y_{j,\\infty}$ with a constant $\\beta \\in (0,1)$ to induce a physically plausible near-wall gradient.\n\nComponent definitions (with the sign convention: positive value means net heat flow into the wall):\n- Molecular conductive component: $q_{\\mathrm{lam}} = k_w \\left.\\dfrac{dT}{dy}\\right|_w$, where $k_w = k(T_w)$.\n- Turbulent component: $q_{\\mathrm{turb}} = k_{t,w} \\left.\\dfrac{dT}{dy}\\right|_w$, where $k_{t,w} = \\rho_w c_{p,\\mathrm{mix},w} \\nu_t / \\mathrm{Pr}_t$.\n- Diffusive enthalpy component: $q_{\\mathrm{diff}} = \\sum_j h_{j,w} \\rho_w D_j \\left.\\dfrac{dY_j}{dy}\\right|_w$.\n- Radiative component: $q_{\\mathrm{rad}} = k_{r,w} \\left.\\dfrac{dT}{dy}\\right|_w$, where $k_{r,w} = \\dfrac{16 \\sigma T_w^3}{3 \\kappa_w}$ and $\\kappa_w$ is evaluated at the wall.\n- Total wall heat flux: $q_{\\mathrm{tot}} = q_{\\mathrm{lam}} + q_{\\mathrm{turb}} + q_{\\mathrm{diff}} + q_{\\mathrm{rad}}$.\n\nConstants to use:\n- Universal gas constant: $R_u = 8.314 \\,\\mathrm{J/(mol \\cdot K)}$.\n- Stefan–Boltzmann constant: $\\sigma = 5.670374419 \\times 10^{-8} \\,\\mathrm{W/(m^2 \\cdot K^4)}$.\n- Static pressure: $p = 1.0 \\times 10^5 \\,\\mathrm{Pa}$.\n- Thermal conductivity model: $k_0 = 0.03 \\,\\mathrm{W/(m \\cdot K)}$, $T_{\\mathrm{ref}} = 300 \\,\\mathrm{K}$, $n = 0.7$.\n- Turbulent model: $C_\\mu = 0.09$, $\\mathrm{Pr}_t = 0.9$.\n- Absorption model: $\\kappa_0 = 400 \\,\\mathrm{m^{-1}}$, $\\alpha = 800 \\,\\mathrm{m^{-1}}$.\n- Species set and properties: $\\mathrm{H_2}$, $\\mathrm{O_2}$, $\\mathrm{N_2}$, $\\mathrm{H_2O}$ with molecular weights $M_{\\mathrm{H_2}} = 0.002 \\,\\mathrm{kg/mol}$, $M_{\\mathrm{O_2}} = 0.032 \\,\\mathrm{kg/mol}$, $M_{\\mathrm{N_2}} = 0.028 \\,\\mathrm{kg/mol}$, $M_{\\mathrm{H_2O}} = 0.018 \\,\\mathrm{kg/mol}$; constant heat capacities $c_{p,\\mathrm{H_2}} = 14300 \\,\\mathrm{J/(kg \\cdot K)}$, $c_{p,\\mathrm{O_2}} = 1100 \\,\\mathrm{J/(kg \\cdot K)}$, $c_{p,\\mathrm{N_2}} = 1240 \\,\\mathrm{J/(kg \\cdot K)}$, $c_{p,\\mathrm{H_2O}} = 2000 \\,\\mathrm{J/(kg \\cdot K)}$; diffusion coefficients $D_{\\mathrm{H_2}} = 7.0 \\times 10^{-5} \\,\\mathrm{m^2/s}$, $D_{\\mathrm{O_2}} = 2.0 \\times 10^{-5} \\,\\mathrm{m^2/s}$, $D_{\\mathrm{N_2}} = 2.0 \\times 10^{-5} \\,\\mathrm{m^2/s}$, $D_{\\mathrm{H_2O}} = 2.0 \\times 10^{-5} \\,\\mathrm{m^2/s}$.\n\nGrid spacing:\n- $h = 1.0 \\times 10^{-5} \\,\\mathrm{m}$.\n\nMixing length:\n- $\\ell_{\\mathrm{mix}} = 1.0 \\times 10^{-4} \\,\\mathrm{m}$.\n\nUse the following test suite of parameter sets, each specified by the tuple $(\\phi, T_w, T_g, \\delta_T, \\delta_s, u_{\\mathrm{rms}}, \\beta, Y_{j,\\infty})$, where $\\phi$ is the equivalence ratio, $T_g$ is the gas-side far-field temperature, $\\delta_T$ and $\\delta_s$ are the thermal and species boundary layer scales, $u_{\\mathrm{rms}}$ is the root-mean-square velocity fluctuation, and $\\beta$ sets the wall mass fraction scaling:\n\n- Case 1 (lean boundary condition): $(\\phi = 0.4, T_w = 900 \\,\\mathrm{K}, T_g = 1800 \\,\\mathrm{K}, \\delta_T = 0.005 \\,\\mathrm{m}, \\delta_s = 0.004 \\,\\mathrm{m}, u_{\\mathrm{rms}} = 1.5 \\,\\mathrm{m/s}, \\beta = 0.95, Y_{\\mathrm{H_2O},\\infty} = 0.06, Y_{\\mathrm{O_2},\\infty} = 0.06, Y_{\\mathrm{H_2},\\infty} = 0.0, Y_{\\mathrm{N_2},\\infty} = 0.88)$.\n- Case 2 (moderately lean): $(\\phi = 0.7, T_w = 900 \\,\\mathrm{K}, T_g = 2100 \\,\\mathrm{K}, \\delta_T = 0.004 \\,\\mathrm{m}, \\delta_s = 0.004 \\,\\mathrm{m}, u_{\\mathrm{rms}} = 1.5 \\,\\mathrm{m/s}, \\beta = 0.95, Y_{\\mathrm{H_2O},\\infty} = 0.095, Y_{\\mathrm{O_2},\\infty} = 0.035, Y_{\\mathrm{H_2},\\infty} = 0.0, Y_{\\mathrm{N_2},\\infty} = 0.87)$.\n- Case 3 (stoichiometric): $(\\phi = 1.0, T_w = 900 \\,\\mathrm{K}, T_g = 2400 \\,\\mathrm{K}, \\delta_T = 0.003 \\,\\mathrm{m}, \\delta_s = 0.004 \\,\\mathrm{m}, u_{\\mathrm{rms}} = 1.5 \\,\\mathrm{m/s}, \\beta = 0.95, Y_{\\mathrm{H_2O},\\infty} = 0.12, Y_{\\mathrm{O_2},\\infty} = 0.01, Y_{\\mathrm{H_2},\\infty} = 0.0, Y_{\\mathrm{N_2},\\infty} = 0.87)$.\n- Case 4 (rich): $(\\phi = 1.3, T_w = 900 \\,\\mathrm{K}, T_g = 2200 \\,\\mathrm{K}, \\delta_T = 0.0035 \\,\\mathrm{m}, \\delta_s = 0.004 \\,\\mathrm{m}, u_{\\mathrm{rms}} = 1.5 \\,\\mathrm{m/s}, \\beta = 0.95, Y_{\\mathrm{H_2O},\\infty} = 0.11, Y_{\\mathrm{O_2},\\infty} = 0.0, Y_{\\mathrm{H_2},\\infty} = 0.03, Y_{\\mathrm{N_2},\\infty} = 0.86)$.\n- Case 5 (stoichiometric, zero turbulence edge case): $(\\phi = 1.0, T_w = 900 \\,\\mathrm{K}, T_g = 2400 \\,\\mathrm{K}, \\delta_T = 0.003 \\,\\mathrm{m}, \\delta_s = 0.004 \\,\\mathrm{m}, u_{\\mathrm{rms}} = 0.0 \\,\\mathrm{m/s}, \\beta = 0.95, Y_{\\mathrm{H_2O},\\infty} = 0.12, Y_{\\mathrm{O_2},\\infty} = 0.01, Y_{\\mathrm{H_2},\\infty} = 0.0, Y_{\\mathrm{N_2},\\infty} = 0.87)$.\n\nAlgorithmic task:\n- For each case, construct $T(y)$ and $Y_j(y)$ at $y = \\{0, h, 2h\\}$ using the given profiles and parameters, compute gradients at the wall using the second-order forward difference, compute $\\rho_w$, $c_{p,\\mathrm{mix},w}$, $k_w$, $\\nu_t$, $k_{t,w}$, $\\kappa_w$, $k_{r,w}$, and then compute $q_{\\mathrm{lam}}$, $q_{\\mathrm{turb}}$, $q_{\\mathrm{diff}}$, $q_{\\mathrm{rad}}$, and $q_{\\mathrm{tot}}$ using the component definitions above.\n\nScientific realism conditions:\n- Ensure all computed values are dimensionally consistent.\n- Express all heat fluxes in $\\mathrm{W/m^2}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a nested list of five floats $[q_{\\mathrm{lam}}, q_{\\mathrm{turb}}, q_{\\mathrm{diff}}, q_{\\mathrm{rad}}, q_{\\mathrm{tot}}]$, each rounded to three decimal places and expressed in $\\mathrm{W/m^2}$. For example: $[[\\ldots],[\\ldots],\\ldots]$.",
            "solution": "The objective is to compute the components of the total wall heat flux for several test cases of a reacting turbulent flow near an inert wall. The total heat flux into the wall, $q_{\\mathrm{tot}}$, is the sum of four components: molecular conduction ($q_{\\mathrm{lam}}$), turbulent transport ($q_{\\mathrm{turb}}$), diffusive enthalpy ($q_{\\mathrm{diff}}$), and radiation ($q_{\\mathrm{rad}}$). The calculation proceeds by first evaluating the near-wall temperature and species profiles at discrete points, then numerically approximating the wall-normal gradients, and finally using these gradients and other given parameters to compute each flux component according to the provided physical models.\n\nThe procedure for each test case is as follows:\n\n**Step 1: Evaluate Near-Wall Profiles**\n\nThe problem provides analytical profiles for temperature $T(y)$ and species mass fractions $Y_j(y)$ as functions of the wall-normal coordinate $y$. We need to evaluate these at three grid points: $y_0 = 0$, $y_1 = h$, and $y_2 = 2h$, where $h = 1.0 \\times 10^{-5} \\,\\mathrm{m}$ is the uniform grid spacing.\n\nThe temperature profile is given by:\n$$ T(y) = T_w + \\left(T_g - T_w\\right)\\left(1 - e^{-y/\\delta_T}\\right) $$\nWe compute $T_0 = T(y_0)$, $T_1 = T(y_1)$, and $T_2 = T(y_2)$. Note that $T(0) = T_w$.\n\nThe species mass fraction profiles are given by:\n$$ Y_j(y) = Y_{j,w} + \\left(Y_{j,\\infty} - Y_{j,w}\\right)\\left(1 - e^{-y/\\delta_s}\\right) $$\nwhere $Y_{j,w} = \\beta Y_{j,\\infty}$ and $\\beta$ is a given scaling factor. We compute $Y_{j,0} = Y_j(y_0)$, $Y_{j,1} = Y_j(y_1)$, and $Y_{j,2} = Y_j(y_2)$ for each of the four species $j \\in \\{\\mathrm{H_2}, \\mathrm{O_2}, \\mathrm{N_2}, \\mathrm{H_2O}\\}$. Note that $Y_j(0) = Y_{j,w}$.\n\n**Step 2: Approximate Wall-Normal Gradients**\n\nThe gradient of any scalar quantity $f$ at the wall ($y=0$) is approximated using a second-order forward finite difference scheme:\n$$ \\left.\\dfrac{df}{dy}\\right|_w \\approx \\dfrac{-3 f_0 + 4 f_1 - f_2}{2 h} $$\nWe apply this formula to the temperature and species mass fraction values computed in Step 1 to find the wall gradients $\\left.\\dfrac{dT}{dy}\\right|_w$ and $\\left.\\dfrac{dY_j}{dy}\\right|_w$ for each species $j$.\n\n**Step 3: Calculate Auxiliary Wall Properties**\n\nSeveral thermophysical properties at the wall are required for the heat flux calculations.\n\nFirst, we determine the wall mass fractions for all species:\n$$ Y_{j,w} = \\beta Y_{j,\\infty} $$\n\nNext, we compute the mixture molecular weight at the wall, $M_{\\mathrm{mix},w}$:\n$$ M_{\\mathrm{mix},w} = \\left(\\sum_j \\dfrac{Y_{j,w}}{M_j}\\right)^{-1} $$\nwhere $M_j$ are the species molecular weights.\n\nThe mixture-specific gas constant at the wall, $R_{\\mathrm{mix},w}$, is found using the universal gas constant, $R_u = 8.314 \\,\\mathrm{J/(mol \\cdot K)}$:\n$$ R_{\\mathrm{mix},w} = \\dfrac{R_u}{M_{\\mathrm{mix},w}} $$\n\nThe fluid density at the wall, $\\rho_w$, is calculated from the ideal gas law using the static pressure $p=1.0 \\times 10^5 \\,\\mathrm{Pa}$ and the wall temperature $T_w$:\n$$ \\rho_w = \\dfrac{p}{R_{\\mathrm{mix},w} T_w} $$\n\nThe mixture-averaged specific heat capacity at constant pressure at the wall, $c_{p,\\mathrm{mix},w}$, is:\n$$ c_{p,\\mathrm{mix},w} = \\sum_j Y_{j,w} c_{p,j} $$\nwhere $c_{p,j}$ are the species-specific heat capacities.\n\nThe species-specific enthalpies at the wall, $h_{j,w}$, are given by:\n$$ h_{j,w} = c_{p,j} T_w $$\n\nFor the radiation model, we need the mole fraction of water, $X_{\\mathrm{H_2O},w}$, at the wall, which is converted from mass fractions:\n$$ X_{\\mathrm{H_2O},w} = \\dfrac{Y_{\\mathrm{H_2O},w}/M_{\\mathrm{H_2O}}}{\\sum_k Y_{k,w}/M_k} $$\nThe denominator is the inverse of the mixture molecular weight, so this simplifies to $X_{\\mathrm{H_2O},w} = (Y_{\\mathrm{H_2O},w}/M_{\\mathrm{H_2O}}) M_{\\mathrm{mix},w}$.\n\nFinally, the absorption coefficient at the wall, $\\kappa_w$, is computed:\n$$ \\kappa_w = \\kappa_0 + \\alpha X_{\\mathrm{H_2O},w} $$\nwith $\\kappa_0 = 400 \\,\\mathrm{m^{-1}}$ and $\\alpha = 800 \\,\\mathrm{m^{-1}}$.\n\n**Step 4: Calculate Effective Thermal Conductivities**\n\nWe now compute the four conductivity coefficients required for the flux components.\n\nThe molecular thermal conductivity at the wall, $k_w$, is evaluated using the given power-law model:\n$$ k_w = k_0 \\left(\\dfrac{T_w}{T_{\\mathrm{ref}}}\\right)^n $$\nwith $k_0 = 0.03 \\,\\mathrm{W/(m \\cdot K)}$, $T_{\\mathrm{ref}} = 300 \\,\\mathrm{K}$, and $n = 0.7$.\n\nThe turbulent eddy viscosity, $\\nu_t$, is found from the simple algebraic model:\n$$ \\nu_t = C_\\mu u_{\\mathrm{rms}} \\ell_{\\mathrm{mix}} $$\nwith $C_\\mu = 0.09$, $u_{\\mathrm{rms}}$ from the test case, and $\\ell_{\\mathrm{mix}} = 1.0 \\times 10^{-4} \\,\\mathrm{m}$.\n\nThe eddy thermal conductivity at the wall, $k_{t,w}$, is then:\n$$ k_{t,w} = \\dfrac{\\rho_w c_{p,\\mathrm{mix},w} \\nu_t}{\\mathrm{Pr}_t} $$\nwhere the turbulent Prandtl number is $\\mathrm{Pr}_t = 0.9$. Note that if $u_{\\mathrm{rms}}=0$, then $\\nu_t=0$ and $k_{t,w}=0$.\n\nThe radiative conductivity at the wall, $k_{r,w}$, is derived from the Rosseland approximation:\n$$ k_{r,w} = \\dfrac{16 \\sigma T_w^3}{3 \\kappa_w} $$\nwhere $\\sigma = 5.670374419 \\times 10^{-8} \\,\\mathrm{W/(m^2 \\cdot K^4)}$ is the Stefan–Boltzmann constant.\n\n**Step 5: Compute Heat Flux Components**\n\nWith all gradients and coefficients determined, we compute the four components of the wall heat flux. The sign convention is positive for heat flux into the wall.\n\nMolecular conductive flux component:\n$$ q_{\\mathrm{lam}} = k_w \\left.\\dfrac{dT}{dy}\\right|_w $$\n\nTurbulent heat flux component:\n$$ q_{\\mathrm{turb}} = k_{t,w} \\left.\\dfrac{dT}{dy}\\right|_w $$\n\nDiffusive enthalpy flux component:\n$$ q_{\\mathrm{diff}} = \\sum_j \\left( h_{j,w} \\rho_w D_j \\left.\\dfrac{dY_j}{dy}\\right|_w \\right) $$\nwhere $D_j$ are the species mixture-averaged diffusion coefficients.\n\nRadiative heat flux component:\n$$ q_{\\mathrm{rad}} = k_{r,w} \\left.\\dfrac{dT}{dy}\\right|_w $$\n\nFinally, the total wall heat flux is the sum of these components:\n$$ q_{\\mathrm{tot}} = q_{\\mathrm{lam}} + q_{\\mathrm{turb}} + q_{\\mathrm{diff}} + q_{\\mathrm{rad}} $$\n\nThis entire sequence of calculations is performed for each of the five test cases provided. The final results for each case are presented as a list of five floating-point numbers: $[q_{\\mathrm{lam}}, q_{\\mathrm{turb}}, q_{\\mathrm{diff}}, q_{\\mathrm{rad}}, q_{\\mathrm{tot}}]$.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    # --- Physical and Model Constants ---\n    R_u = 8.314  # J/(mol.K)\n    sigma = 5.670374419e-8  # W/(m^2.K^4)\n    p_static = 1.0e5  # Pa\n    k0 = 0.03  # W/(m.K)\n    T_ref = 300.0  # K\n    n_k = 0.7\n    C_mu = 0.09\n    Pr_t = 0.9\n    kappa0 = 400.0  # m^-1\n    alpha = 800.0  # m^-1\n    h_grid = 1.0e-5  # m\n    l_mix = 1.0e-4  # m\n\n    # --- Species Properties ---\n    # Dictionary to hold properties for each species\n    species_data = {\n        'H2':  {'M': 0.002, 'cp': 14300.0, 'D': 7.0e-5},\n        'O2':  {'M': 0.032, 'cp': 1100.0,  'D': 2.0e-5},\n        'N2':  {'M': 0.028, 'cp': 1240.0,  'D': 2.0e-5},\n        'H2O': {'M': 0.018, 'cp': 2000.0,  'D': 2.0e-5}\n    }\n    species_list = ['H2', 'O2', 'N2', 'H2O']\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case 1 (lean)\n        {'phi': 0.4, 'Tw': 900.0, 'Tg': 1800.0, 'delta_T': 0.005, 'delta_s': 0.004, \n         'u_rms': 1.5, 'beta': 0.95, \n         'Y_inf': {'H2O': 0.06, 'O2': 0.06, 'H2': 0.0, 'N2': 0.88}},\n        # Case 2 (moderately lean)\n        {'phi': 0.7, 'Tw': 900.0, 'Tg': 2100.0, 'delta_T': 0.004, 'delta_s': 0.004, \n         'u_rms': 1.5, 'beta': 0.95, \n         'Y_inf': {'H2O': 0.095, 'O2': 0.035, 'H2': 0.0, 'N2': 0.87}},\n        # Case 3 (stoichiometric)\n        {'phi': 1.0, 'Tw': 900.0, 'Tg': 2400.0, 'delta_T': 0.003, 'delta_s': 0.004, \n         'u_rms': 1.5, 'beta': 0.95, \n         'Y_inf': {'H2O': 0.12, 'O2': 0.01, 'H2': 0.0, 'N2': 0.87}},\n        # Case 4 (rich)\n        {'phi': 1.3, 'Tw': 900.0, 'Tg': 2200.0, 'delta_T': 0.0035, 'delta_s': 0.004, \n         'u_rms': 1.5, 'beta': 0.95, \n         'Y_inf': {'H2O': 0.11, 'O2': 0.0, 'H2': 0.03, 'N2': 0.86}},\n        # Case 5 (stoichiometric, zero turbulence)\n        {'phi': 1.0, 'Tw': 900.0, 'Tg': 2400.0, 'delta_T': 0.003, 'delta_s': 0.004, \n         'u_rms': 0.0, 'beta': 0.95, \n         'Y_inf': {'H2O': 0.12, 'O2': 0.01, 'H2': 0.0, 'N2': 0.87}},\n    ]\n    \n    final_results = []\n\n    for case in test_cases:\n        Tw, Tg, delta_T, delta_s = case['Tw'], case['Tg'], case['delta_T'], case['delta_s']\n        u_rms, beta = case['u_rms'], case['beta']\n        Y_inf_dict = case['Y_inf']\n\n        # --- Step 1: Evaluate Near-Wall Profiles ---\n        y_coords = [0.0, h_grid, 2 * h_grid]\n        \n        # Temperature profile T(y)\n        T_profile = lambda y: Tw + (Tg - Tw) * (1 - math.exp(-y / delta_T))\n        T_vals = [T_profile(y) for y in y_coords]\n\n        # Species profiles Y_j(y)\n        Yj_vals = {sp: [] for sp in species_list}\n        Yjw_dict = {}\n        for sp in species_list:\n            Y_inf = Y_inf_dict[sp]\n            Y_w = beta * Y_inf\n            Yjw_dict[sp] = Y_w\n            # Yj(y) = Yw + (Y_inf - Yw) * (1 - exp(-y/delta_s))\n            Yj_profile = lambda y: Y_w + (Y_inf - Y_w) * (1 - math.exp(-y / delta_s))\n            Yj_vals[sp] = [Yj_profile(y) for y in y_coords]\n\n        # --- Step 2: Approximate Wall-Normal Gradients ---\n        # df/dy|_w = (-3*f0 + 4*f1 - f2) / (2*h)\n        dT_dy_wall = (-3 * T_vals[0] + 4 * T_vals[1] - T_vals[2]) / (2 * h_grid)\n        dYj_dy_wall = {}\n        for sp in species_list:\n            vals = Yj_vals[sp]\n            dYj_dy_wall[sp] = (-3 * vals[0] + 4 * vals[1] - vals[2]) / (2 * h_grid)\n\n        # --- Step 3: Calculate Auxiliary Wall Properties ---\n        sum_Yw_over_M = 0.0\n        for sp in species_list:\n            sum_Yw_over_M += Yjw_dict[sp] / species_data[sp]['M']\n        \n        M_mix_w = 1.0 / sum_Yw_over_M\n        R_mix_w = R_u / M_mix_w\n        rho_w = p_static / (R_mix_w * Tw)\n\n        cp_mix_w = 0.0\n        for sp in species_list:\n            cp_mix_w += Yjw_dict[sp] * species_data[sp]['cp']\n        \n        # Mole fraction of water at the wall for radiation model\n        Yw_h2o = Yjw_dict['H2O']\n        M_h2o = species_data['H2O']['M']\n        X_h2o_w = (Yw_h2o / M_h2o) * M_mix_w\n        kappa_w = kappa0 + alpha * X_h2o_w\n        \n        # --- Step 4: Calculate Effective Thermal Conductivities ---\n        k_w = k0 * (Tw / T_ref)**n_k\n        nu_t = C_mu * u_rms * l_mix\n        k_t_w = (rho_w * cp_mix_w * nu_t) / Pr_t\n        k_r_w = (16 * sigma * Tw**3) / (3 * kappa_w)\n\n        # --- Step 5: Compute Heat Flux Components ---\n        q_lam = k_w * dT_dy_wall\n        q_turb = k_t_w * dT_dy_wall\n        q_rad = k_r_w * dT_dy_wall\n        \n        q_diff = 0.0\n        for sp in species_list:\n            h_jw = species_data[sp]['cp'] * Tw\n            D_j = species_data[sp]['D']\n            q_diff += h_jw * rho_w * D_j * dYj_dy_wall[sp]\n            \n        q_tot = q_lam + q_turb + q_diff + q_rad\n\n        case_results = [\n            round(q_lam, 3),\n            round(q_turb, 3),\n            round(q_diff, 3),\n            round(q_rad, 3),\n            round(q_tot, 3)\n        ]\n        final_results.append(str(case_results))\n\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```"
        }
    ]
}