{
    "hands_on_practices": [
        {
            "introduction": "Before building complex simulations, it is crucial to understand the inherent numerical challenges of the system. This practice guides you through an essential diagnostic step: timescale analysis . By estimating and comparing the characteristic times for chemical reactions and thermal transport, you will uncover why metal combustion models are 'stiff' and learn to select appropriate numerical integration schemes that ensure both stability and efficiency.",
            "id": "4039011",
            "problem": "A single aluminum particle of radius $a=10\\,\\mu\\text{m}$ is embedded near the burning surface of a composite solid propellant and exposed to an oxidizing gas at temperature $T_g=2300\\,\\text{K}$. Assume the particle is thermally thin so that the lumped-capacitance approximation applies. The particle density is $\\rho_p=2700\\,\\text{kg}\\,\\text{m}^{-3}$, specific heat is $c_p=900\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, and its emissivity is $\\epsilon=0.30$. The gas-side convective heat transfer coefficient is $h=2.0\\times 10^{4}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, and the Stefan–Boltzmann constant is $\\sigma=5.67\\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$.\n\nThe surface oxidation of aluminum is modeled locally by a first-order consumption of the reactive aluminum surface fraction $Y_m(t)$ according to\n$$\n\\frac{dY_m}{dt} = -k(T_p)\\,Y_m,\n$$\nwhere $T_p$ is the particle temperature, $k(T_p)$ is the Arrhenius rate constant\n$$\nk(T_p) = k_0 \\exp\\!\\left(-\\frac{E_a}{R\\,T_p}\\right),\n$$\nwith pre-exponential factor $k_0=3.0\\times 10^{9}\\,\\text{s}^{-1}$, activation energy $E_a=180\\,\\text{kJ}\\,\\text{mol}^{-1}$, and universal gas constant $R=8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$. Assume initially $Y_m\\approx 1$ and $T_p\\approx T_g$.\n\nStarting from fundamental definitions of timescale, linearization of thermal relaxation under the lumped-capacitance approximation, and the Arrhenius form for $k(T)$, do the following:\n\n1. Estimate the chemical timescale $\\tau_{\\mathrm{chem}}$ at $T_p=T_g$.\n2. Estimate the particle thermal relaxation timescale $\\tau_{\\mathrm{th}}$ at $T_p\\approx T_g$ by linearizing radiation about $T_g$ and accounting for convection. Use the particle mass $m=\\rho_p \\frac{4}{3}\\pi a^3$ and surface area $A=4\\pi a^2$.\n3. Using the ratio of timescales and the standard notion of stiffness in ordinary differential equations (ODEs), assess whether the coupled $(Y_m, T_p)$ system is stiff and whether an explicit method would face a stability restriction tied to the fastest timescale.\n4. Select the option that most accurately states the solver requirement and proposes a suitable implicit integration scheme for the particle thermal state.\n\nOptions:\n- A. With the given parameters, the timescale separation indicates stiffness; an $L$-stable fully implicit scheme for $T_p$ such as backward Euler, solved by Newton iterations that include the derivatives of both reaction heat release and radiative loss, allows time steps set by $\\tau_{\\mathrm{th}}$ for accuracy rather than by $\\tau_{\\mathrm{chem}}$ for stability (e.g., choose $\\Delta t \\approx 0.1\\,\\tau_{\\mathrm{th}}$ to resolve thermal transients).\n\n- B. The system is not stiff because surface chemistry is slower than heat transfer; an explicit fourth-order Runge–Kutta scheme with $\\Delta t = 5\\,\\tau_{\\mathrm{th}}$ will be stable and accurate without special treatment.\n\n- C. The system is stiff, and even implicit methods must satisfy $\\Delta t < \\tau_{\\mathrm{chem}}$ for stability; the trapezoidal rule (implicit midpoint or Crank–Nicolson) is $L$-stable and thus preferable to backward Euler.\n\n- D. The system is stiff; a semi-implicit scheme that treats reaction heat implicitly but convection and radiation explicitly is unconditionally stable without Newton iterations and permits $\\Delta t \\gg \\tau_{\\mathrm{th}}$ with no accuracy penalty.\n\nChoose the single best option based on your derivations and assessments.",
            "solution": "The user has provided a problem in computational combustion concerning the numerical integration of the governing equations for a single aluminum particle. The task is to validate the problem statement, perform an analysis of the system's characteristic timescales, assess its numerical stiffness, and select the most appropriate solution strategy from the given options.\n\n### Step 1: Extract Givens\n\nThe following parameters and conditions are provided in the problem statement:\n- Particle radius: $a=10\\,\\mu\\text{m} = 1.0 \\times 10^{-5}\\,\\text{m}$\n- Gas temperature: $T_g=2300\\,\\text{K}$\n- Particle is thermally thin (lumped-capacitance approximation).\n- Particle density: $\\rho_p=2700\\,\\text{kg}\\,\\text{m}^{-3}$\n- Particle specific heat: $c_p=900\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$\n- Particle emissivity: $\\epsilon=0.30$\n- Convective heat transfer coefficient: $h=2.0\\times 10^{4}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n- Stefan–Boltzmann constant: $\\sigma=5.67\\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$\n- Surface reaction model for reactive surface fraction $Y_m(t)$: $\\frac{dY_m}{dt} = -k(T_p)\\,Y_m$\n- Arrhenius rate constant: $k(T_p) = k_0 \\exp(-\\frac{E_a}{R\\,T_p})$\n- Pre-exponential factor: $k_0=3.0\\times 10^{9}\\,\\text{s}^{-1}$\n- Activation energy: $E_a=180\\,\\text{kJ}\\,\\text{mol}^{-1} = 1.80 \\times 10^5\\,\\text{J}\\,\\text{mol}^{-1}$\n- Universal gas constant: $R=8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n- Initial conditions: $Y_m(0)\\approx 1$ and $T_p(0)\\approx T_g = 2300\\,\\text{K}$\n- Particle mass: $m=\\rho_p \\frac{4}{3}\\pi a^3$\n- Particle surface area: $A=4\\pi a^2$\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem describes a scientifically standard model for single-particle combustion, using a lumped-capacitance energy balance coupled with a surface reaction. The governing equations form a system of ordinary differential equations (ODEs). All physical parameters are within realistic ranges for aluminum combustion in a high-temperature environment. The problem asks for an analysis of the system's timescales and numerical properties (stiffness), which is a well-posed question in the field of scientific computing and computational combustion. The problem is scientifically grounded, well-posed, and objective. It does not violate any of the invalidity criteria. For instance, while the heat of reaction is not given, it is not required to estimate the chemical and thermal relaxation timescales as requested, which are sufficient to assess the system's stiffness.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. We may proceed with the solution.\n\n### Derivation and Analysis\n\nThe problem requires a four-part analysis: estimating the chemical timescale, estimating the thermal timescale, assessing stiffness, and selecting a suitable numerical method.\n\n**1. Estimate the chemical timescale $\\tau_{\\mathrm{chem}}$**\nThe chemical process is described by the first-order ODE: $\\frac{dY_m}{dt} = -k(T_p)\\,Y_m$. The characteristic timescale of this process, $\\tau_{\\mathrm{chem}}$, is the reciprocal of the rate constant, $k(T_p)$. We evaluate this at the initial particle temperature, $T_p = T_g = 2300\\,\\text{K}$.\nThe Arrhenius rate constant is:\n$$k(T_p) = k_0 \\exp\\left(-\\frac{E_a}{R\\,T_p}\\right)$$\nSubstituting the given values:\n$$\n\\frac{E_a}{R\\,T_p} = \\frac{1.80 \\times 10^5\\,\\text{J}\\,\\text{mol}^{-1}}{(8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2300\\,\\text{K})} \\approx \\frac{1.80 \\times 10^5}{19122.2} \\approx 9.4131\n$$\n$$\nk(2300\\,\\text{K}) = (3.0 \\times 10^9\\,\\text{s}^{-1}) \\exp(-9.4131) \\approx (3.0 \\times 10^9\\,\\text{s}^{-1})(8.165 \\times 10^{-5}) \\approx 2.45 \\times 10^5\\,\\text{s}^{-1}\n$$\nThe chemical timescale is therefore:\n$$\n\\tau_{\\mathrm{chem}} = \\frac{1}{k(2300\\,\\text{K})} \\approx \\frac{1}{2.45 \\times 10^5\\,\\text{s}^{-1}} \\approx 4.08 \\times 10^{-6}\\,\\text{s} = 4.08\\,\\mu\\text{s}\n$$\n\n**2. Estimate the particle thermal relaxation timescale $\\tau_{\\mathrm{th}}$**\nThe lumped-capacitance energy balance for the particle, considering only heat exchange with the surroundings (convection and radiation), is:\n$$m c_p \\frac{dT_p}{dt} = A h (T_g - T_p) + A \\epsilon \\sigma (T_{surr}^4 - T_p^4)$$\nAssuming the radiative surroundings are also at $T_g$, this becomes:\n$$m c_p \\frac{dT_p}{dt} = - A \\left[ h (T_p - T_g) + \\epsilon \\sigma (T_p^4 - T_g^4) \\right]$$\nTo find the thermal relaxation timescale, we linearize this equation for small temperature perturbations around $T_p = T_g$. Let $T_p = T_g + \\delta T$.\nThe convective term is $-A h \\delta T$.\nFor the radiative term, we use a first-order Taylor expansion: $T_p^4 \\approx T_g^4 + 4T_g^3 \\delta T$.\nThe radiative loss term becomes $-A \\epsilon \\sigma (T_p^4 - T_g^4) \\approx -A \\epsilon \\sigma (4T_g^3 \\delta T)$.\nThe linearized energy equation is:\n$$m c_p \\frac{d(\\delta T)}{dt} = - A (h + 4\\epsilon\\sigma T_g^3) \\delta T$$\nThis is a first-order decay equation for the temperature perturbation $\\delta T$. The form is $\\frac{d(\\delta T)}{dt} = -\\frac{1}{\\tau_{\\mathrm{th}}} \\delta T$, where the thermal timescale $\\tau_{\\mathrm{th}}$ is:\n$$\\tau_{\\mathrm{th}} = \\frac{m c_p}{A (h + 4\\epsilon\\sigma T_g^3)}$$\nUsing the particle geometry, the ratio $m/A = (\\rho_p \\frac{4}{3}\\pi a^3) / (4\\pi a^2) = \\frac{\\rho_p a}{3}$.\n$$\\tau_{\\mathrm{th}} = \\frac{\\rho_p a c_p}{3 (h + h_{rad})}$$\nwhere $h_{rad} = 4\\epsilon\\sigma T_g^3$ is the linearized radiative heat transfer coefficient.\nFirst, calculate $h_{rad}$:\n$$h_{rad} = 4(0.30)(5.67 \\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4})(2300\\,\\text{K})^3 \\approx 827.8\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$$\nThe total effective heat transfer coefficient is $h_{eff} = h + h_{rad} = 2.0 \\times 10^4 + 827.8 = 20827.8\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$.\nNow, calculate $\\tau_{\\mathrm{th}}$:\n$$\n\\tau_{\\mathrm{th}} = \\frac{(2700\\,\\text{kg}\\,\\text{m}^{-3})(1.0 \\times 10^{-5}\\,\\text{m})(900\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1})}{3(20827.8\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1})} = \\frac{2.43 \\times 10^{-2}}{6.248 \\times 10^4} \\approx 3.89 \\times 10^{-5}\\,\\text{s} = 38.9\\,\\mu\\text{s}\n$$\n\n**3. Assess stiffness**\nA system of ODEs is considered stiff if its characteristic timescales are widely separated. Here, we have:\n- Chemical timescale: $\\tau_{\\mathrm{chem}} \\approx 4.08\\,\\mu\\text{s}$\n- Thermal timescale: $\\tau_{\\mathrm{th}} \\approx 38.9\\,\\mu\\text{s}$\nThe ratio of the timescales is $\\tau_{\\mathrm{th}}/\\tau_{\\mathrm{chem}} \\approx 38.9 / 4.08 \\approx 9.5$.\nA ratio of approximately one order of magnitude is sufficient to classify the system as at least mildly stiff. The fastest process is the chemical reaction. For an explicit numerical integrator (like Forward Euler or Runge-Kutta schemes), the time step $\\Delta t$ is constrained by the fastest timescale for stability, i.e., $\\Delta t \\lesssim \\tau_{\\mathrm{chem}}$. This means that even if we are only interested in capturing the thermal evolution, which occurs on the slower timescale $\\tau_{\\mathrm{th}}$, we are forced to take very small time steps, making the computation inefficient. This is the hallmark of a stiff system.\n\n**4. Select the option for the solver requirement**\n\n- **Option A:** This option correctly identifies that the timescale separation indicates stiffness. It proposes using an $L$-stable fully implicit scheme like backward Euler. For stiff systems, $L$-stable schemes are superior to schemes that are merely $A$-stable (like the trapezoidal rule) because they effectively damp the fast, uninteresting transient components of the solution. The problem is nonlinear due to both the Arrhenius kinetics and the $T_p^4$ radiation term, so solving the implicit equations requires a nonlinear solver like Newton's method, which in turn needs the Jacobian matrix (containing derivatives of reaction and radiation terms). The main advantage of this approach is that the stability constraint is removed, and the time step $\\Delta t$ can be chosen based on accuracy considerations for the slowest timescale of interest, $\\tau_{\\mathrm{th}}$. A choice like $\\Delta t \\approx 0.1\\,\\tau_{\\mathrm{th}}$ is a reasonable example for resolving the thermal transient. This option is entirely consistent with the theory of numerical methods for stiff ODEs. **Verdict: Correct.**\n\n- **Option B:** This option claims the system is not stiff and that chemistry is slower than heat transfer. Our calculations show the opposite: $\\tau_{\\mathrm{chem}} < \\tau_{\\mathrm{th}}$, so chemistry is faster, and the system is stiff. It proposes an explicit method with a time step $\\Delta t = 5\\,\\tau_{\\mathrm{th}}$. Since $\\tau_{\\mathrm{th}} \\approx 9.5\\,\\tau_{\\mathrm{chem}}$, this would mean $\\Delta t \\approx 47.5\\,\\tau_{\\mathrm{chem}}$. Any explicit method would be violently unstable with a time step much larger than the stability limit of $\\approx \\tau_{\\mathrm{chem}}$. **Verdict: Incorrect.**\n\n- **Option C:** This option correctly identifies the system as stiff but then incorrectly claims that even implicit methods must satisfy $\\Delta t < \\tau_{\\mathrm{chem}}$ for stability. This negates the very purpose of using implicit methods for stiff problems. A-stable implicit methods, by definition, do not have such a stability restriction for linear problems and offer a much larger stability region for nonlinear ones. This option also incorrectly claims that the trapezoidal rule (Crank-Nicolson) is $L$-stable. It is $A$-stable, but its amplification factor approaches $-1$ for highly stiff components, which can introduce persistent, unphysical oscillations. Backward Euler, which is $L$-stable (amplification factor goes to $0$), is generally preferred for its better damping properties in stiff systems. **Verdict: Incorrect.**\n\n- **Option D:** This option correctly identifies stiffness but proposes a semi-implicit scheme. While such schemes (IMEX) can be effective, this option makes several false claims. It states the proposed scheme is \"unconditionally stable,\" which is not guaranteed when nonlinear terms like radiation are treated explicitly. It claims it works \"without Newton iterations,\" which is false because the implicit treatment of the highly nonlinear Arrhenius term still results in a nonlinear algebraic system to be solved at each step. Finally, it claims it permits $\\Delta t \\gg \\tau_{\\mathrm{th}}$ with \"no accuracy penalty.\" Any numerical method will suffer from large truncation errors (poor accuracy) if the time step is significantly larger than the scale of the phenomenon being resolved. **Verdict: Incorrect.**\n\nBased on the detailed analysis, Option A provides the most accurate and complete description of the system's numerical properties and the appropriate solution strategy.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Building on the principles of numerical stability, this exercise involves developing a complete transient model for a metal particle's thermal response to a dynamic environment. You will implement a simulation that captures the interplay between convective and radiative heat transfer, complex surface kinetics, and a fluctuating oxygen supply . The goal is to analyze the resulting temperature profile to identify and quantify critical combustion phenomena like ignition-extinction hysteresis, a hallmark of many reactive systems.",
            "id": "4039048",
            "problem": "Consider a single spherical metal particle embedded in the gas layer above a burning solid propellant. After an extinction episode (the particle cools below its reactive temperature), the particle may re-ignite if transient heat release due to oxidation exceeds heat losses. Model the particle as a lumped thermal mass and treat the oxygen supply to the particle surface as a fluctuating partial pressure around a slowly ramped mean value. The goal is to derive from first principles, implement, and solve a transient heating model with temperature-dependent surface kinetics and diffusion-like oxygen transport, then algorithmically quantify hysteresis in ignition–extinction cycles and the time to re-ignition after extinction.\n\nAssume the following physically consistent modeling ingredients:\n\n- Energy conservation for a lumped particle: the First Law for a control mass implies that the rate of change of internal energy equals the sum of heat gains and losses. Represent this as an Ordinary Differential Equation (ODE) for the particle temperature $T(t)$.\n\n- Heat losses to the surrounding gas at temperature $T_g$ by convection and thermal radiation. Use convective heat transfer coefficient $h$ and surface emissivity $\\varepsilon$. The surface area is $A = 4\\pi R^2$ for particle radius $R$. Use Stefan–Boltzmann constant $\\sigma$.\n\n- Heat gain by exothermic oxidation of the metal due to oxygen flux $J_{\\mathrm{O}_2}(t,T)$ reaching the particle surface. Assume a two-resistance model for mass transport and surface reaction. Let the effective molar flux be:\n$$\nJ_{\\mathrm{O}_2}(t,T) = v_{\\mathrm{eff}}(T)\\, C_{\\mathrm{O}_2}(t),\n$$\nwith effective velocity\n$$\nv_{\\mathrm{eff}}(T) = \\left(\\frac{1}{k_m} + \\frac{1}{k_s(T)}\\right)^{-1}.\n$$\nHere $k_m$ is a mass-transfer coefficient and $k_s(T)$ is a temperature-dependent surface reaction velocity. Let $C_{\\mathrm{O}_2}(t) = \\frac{p_{\\mathrm{O}_2}(t)}{R_u\\, T_g}$ be the oxygen molar concentration near the particle surface, with $R_u$ the Universal Gas Constant (UGC).\n\n- Model $k_m$ by a diffusion-limited value $k_m = \\frac{\\mathrm{Sh}\\, D}{R}$, where $D$ is an effective gas-phase oxygen diffusivity and $\\mathrm{Sh}$ is the Sherwood number for a stationary sphere.\n\n- Model the intrinsic surface reaction velocity by an Arrhenius form with a melt/oxide-breakup enhancement that increases reactive permeability at high temperature:\n$$\nk_s(T) = A_s \\exp\\!\\left(-\\frac{E}{R_u\\, T}\\right)\\, \\left[1 + \\frac{B_0}{1 + \\exp\\!\\left(-\\frac{T - T_{\\mathrm{trans}}}{\\Delta T}\\right)}\\right].\n$$\nThe bracketed factor transitions from near $1$ to approximately $1 + B_0$ as $T$ increases past $T_{\\mathrm{trans}}$ over width $\\Delta T$.\n\n- Model the combustion efficiency multiplier on heat release as\n$$\n\\eta(T) = \\eta_{\\ell} + \\frac{\\eta_h - \\eta_{\\ell}}{1 + \\exp\\!\\left(-\\frac{T - T_{\\mathrm{trans}}}{\\Delta T}\\right)},\n$$\nwith low-temperature value $\\eta_{\\ell}$ and high-temperature value $\\eta_h$.\n\n- The oxygen partial pressure experiences a slow mean ramp and fast fluctuations:\n$$\np_{\\mathrm{O}_2}(t) = \\mathrm{clip}\\!\\left(p_{\\mathrm{mean}}(t) + A_{\\mathrm{fluc}} \\sin(2\\pi f t),\\, 0,\\, p_{\\max}\\right),\n$$\nwhere $p_{\\mathrm{mean}}(t)$ ramps up linearly from $p_{\\ell}$ to $p_h$ over time $t_{\\mathrm{ramp}}$, is held, and then ramps down linearly back to $p_{\\ell}$ over time $t_{\\mathrm{ramp}}$. The function $\\mathrm{clip}(x, 0, p_{\\max})$ limits the value to the physically plausible interval $[0, p_{\\max}]$. The fluctuation amplitude is $A_{\\mathrm{fluc}}$ and the fluctuation frequency is $f$.\n\n- The exothermic heat release rate is proportional to oxygen molar flux and the particle surface area with a heat of reaction per mole of oxygen $H_{\\mathrm{O}_2}$:\n$$\n\\dot{q}_{\\mathrm{rxn}}(t,T) = \\eta(T)\\, H_{\\mathrm{O}_2}\\, A\\, J_{\\mathrm{O}_2}(t,T).\n$$\n\nStarting from these bases, derive the ODE in $T(t)$ that balances convective and radiative heat losses with reactive heat gain, for a particle of mass $m = \\rho \\frac{4}{3}\\pi R^3$ and constant specific heat $c_p$. Implement a numerical solver for $T(t)$ over the full ramp duration. Define ignition and extinction events as follows:\n\n- Sustained ignition on the upsweep occurs at the first time $t_{\\mathrm{ign}}$ during the up-ramp when $T(t)$ crosses upward above a threshold $T_{\\mathrm{ign}}$ and remains above $T_{\\mathrm{ign}}$ for at least one oscillation period $P = 1/f$. Record the corresponding mean oxygen partial pressure $p_{\\mathrm{mean}}(t_{\\mathrm{ign}})$.\n\n- Sustained extinction on the downsweep occurs at the first time $t_{\\mathrm{ext}}$ during the down-ramp when $T(t)$ crosses downward below a threshold $T_{\\mathrm{ext}}$ and remains below $T_{\\mathrm{ext}}$ for at least one period $P$. Record $p_{\\mathrm{mean}}(t_{\\mathrm{ext}})$.\n\n- The hysteresis width is the difference $\\Delta p = p_{\\mathrm{mean}}(t_{\\mathrm{ign}}) - p_{\\mathrm{mean}}(t_{\\mathrm{ext}})$, expressed in pascals. The re-ignition time after extinction is $\\Delta t_{\\mathrm{re}} = t_{\\mathrm{ign,after}} - t_{\\mathrm{ext}}$, where $t_{\\mathrm{ign,after}}$ is the first sustained ignition time occurring after $t_{\\mathrm{ext}}$. If no such ignition occurs within the simulated time, report $\\Delta t_{\\mathrm{re}} = -1.0$.\n\nUse the following constants and parameters, all scientifically plausible, with units as indicated:\n\n- Metal properties: $c_p = 900$ J kg$^{-1}$ K$^{-1}$, $\\rho = 2700$ kg m$^{-3}$.\n- Surroundings: $T_g = 800$ K, $\\varepsilon = 0.3$, $\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$.\n- Mass transfer: $\\mathrm{Sh} = 2$, $D$ varies per test case.\n- Reaction: $H_{\\mathrm{O}_2} = 1.0\\times 10^{6}$ J mol$^{-1}$, $A_s = 0.5$ m s$^{-1}$, $E = 1.2\\times 10^{5}$ J mol$^{-1}$, $B_0 = 500$, $T_{\\mathrm{trans}} = 1200$ K, $\\Delta T = 80$ K, $\\eta_{\\ell} = 0.1$, $\\eta_h = 0.95$.\n- Gas constant: $R_u = 8.314$ J mol$^{-1}$ K$^{-1}$.\n- Oxygen supply: $p_{\\max} = 1.0\\times 10^{5}$ Pa, $p_{\\ell} = 1.0\\times 10^{4}$ Pa, $p_h = 9.0\\times 10^{4}$ Pa, $t_{\\mathrm{ramp}} = 6.0$ s, $t_{\\mathrm{hold}} = 1.0$ s, $A_{\\mathrm{fluc}}$ and $f$ vary by test case.\n- Heat transfer: $h$ varies by test case.\n- Initial condition: $T(0) = 900$ K.\n- Thresholds: $T_{\\mathrm{ign}} = 1400$ K, $T_{\\mathrm{ext}} = 1200$ K.\n\nTest suite specification. Your program must solve the ODE for each of the following three parameter sets, compute $\\Delta p$ in pascals and $\\Delta t_{\\mathrm{re}}$ in seconds, and produce the single line output described below:\n\n- Case 1 (happy path): $R = 50\\times 10^{-6}$ m, $h = 500$ W m$^{-2}$ K$^{-1}$, $D = 1.0\\times 10^{-4}$ m$^{2}$ s$^{-1}$, $f = 8.0$ s$^{-1}$, $A_{\\mathrm{fluc}} = 1.5\\times 10^{4}$ Pa.\n\n- Case 2 (larger particle): $R = 200\\times 10^{-6}$ m, $h = 800$ W m$^{-2}$ K$^{-1}$, $D = 1.0\\times 10^{-4}$ m$^{2}$ s$^{-1}$, $f = 5.0$ s$^{-1}$, $A_{\\mathrm{fluc}} = 2.0\\times 10^{4}$ Pa.\n\n- Case 3 (reduced diffusivity edge): $R = 100\\times 10^{-6}$ m, $h = 700$ W m$^{-2}$ K$^{-1}$, $D = 6.0\\times 10^{-5}$ m$^{2}$ s$^{-1}$, $f = 12.0$ s$^{-1}$, $A_{\\mathrm{fluc}} = 1.0\\times 10^{4}$ Pa.\n\nAngle units are not involved. All physical units are as stated. The final answers must be floats. If the program detects that sustained ignition or extinction does not occur in the required interval for a case, it must return $\\Delta p = -1.0$ and/or $\\Delta t_{\\mathrm{re}} = -1.0$ for that case, as applicable.\n\nFinal output format. Your program should produce a single line of output containing a list of three two-element lists, one per test case, with each inner list in the form $[\\Delta p,\\Delta t_{\\mathrm{re}}]$, the first value in pascals and the second in seconds. For example, an output line must look like:\n$[[\\Delta p_1,\\Delta t_{\\mathrm{re},1}],[\\Delta p_2,\\Delta t_{\\mathrm{re},2}],[\\Delta p_3,\\Delta t_{\\mathrm{re},3}]]$\nwith numerical values filled in, and no additional text.",
            "solution": "The user has provided a problem in computational combustion concerning the ignition-extinction hysteresis of a single metal particle. The task is to derive the governing equation, solve it numerically, and analyze the results to quantify hysteresis and re-ignition time.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Principle**: First Law of Thermodynamics for a lumped-mass particle.\n- **Particle Model**: Sphere of radius $R$, density $\\rho = 2700$ kg m$^{-3}$, specific heat $c_p = 900$ J kg$^{-1}$ K$^{-1}$. Mass $m = \\rho \\frac{4}{3}\\pi R^3$, area $A = 4\\pi R^2$.\n- **Heat Transfer**:\n    - Convection to gas at $T_g = 800$ K with coefficient $h$.\n    - Radiation to same gas with emissivity $\\varepsilon = 0.3$.\n    - Stefan-Boltzmann constant $\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$.\n- **Reactive Heat Gain**:\n    - Rate $\\dot{q}_{\\mathrm{rxn}}(t,T) = \\eta(T)\\, H_{\\mathrm{O}_2}\\, A\\, J_{\\mathrm{O}_2}(t,T)$.\n    - Heat of reaction $H_{\\mathrm{O}_2} = 1.0\\times 10^{6}$ J mol$^{-1}$.\n    - Combustion efficiency $\\eta(T) = \\eta_{\\ell} + \\frac{\\eta_h - \\eta_{\\ell}}{1 + \\exp\\!\\left(-\\frac{T - T_{\\mathrm{trans}}}{\\Delta T}\\right)}$ with $\\eta_{\\ell} = 0.1$, $\\eta_h = 0.95$.\n- **Oxygen Transport**:\n    - Molar flux $J_{\\mathrm{O}_2}(t,T) = v_{\\mathrm{eff}}(T)\\, C_{\\mathrm{O}_2}(t)$.\n    - Effective velocity $v_{\\mathrm{eff}}(T) = \\left(\\frac{1}{k_m} + \\frac{1}{k_s(T)}\\right)^{-1}$.\n    - Molar concentration $C_{\\mathrm{O}_2}(t) = \\frac{p_{\\mathrm{O}_2}(t)}{R_u\\, T_g}$, with $R_u = 8.314$ J mol$^{-1}$ K$^{-1}$.\n    - Mass transfer coefficient $k_m = \\frac{\\mathrm{Sh}\\, D}{R}$, with Sherwood number $\\mathrm{Sh} = 2$. $D$ is case-dependent.\n- **Surface Kinetics**:\n    - Rate $k_s(T) = A_s \\exp\\!\\left(-\\frac{E}{R_u\\, T}\\right)\\, \\left[1 + \\frac{B_0}{1 + \\exp\\!\\left(-\\frac{T - T_{\\mathrm{trans}}}{\\Delta T}\\right)}\\right]$.\n    - Parameters: $A_s = 0.5$ m s$^{-1}$, $E = 1.2\\times 10^{5}$ J mol$^{-1}$, $B_0 = 500$, $T_{\\mathrm{trans}} = 1200$ K, $\\Delta T = 80$ K.\n- **Oxygen Supply**:\n    - Partial pressure $p_{\\mathrm{O}_2}(t) = \\mathrm{clip}\\!\\left(p_{\\mathrm{mean}}(t) + A_{\\mathrm{fluc}} \\sin(2\\pi f t),\\, 0,\\, p_{\\max}\\right)$.\n    - $p_{\\max} = 1.0\\times 10^{5}$ Pa.\n    - Mean pressure $p_{\\mathrm{mean}}(t)$ ramps linearly from $p_{\\ell} = 1.0\\times 10^{4}$ Pa to $p_h = 9.0\\times 10^{4}$ Pa over $t_{\\mathrm{ramp}} = 6.0$ s, holds for $t_{\\mathrm{hold}} = 1.0$ s, then ramps back down.\n    - $A_{\\mathrm{fluc}}$ and $f$ are case-dependent.\n- **Initial Condition**: $T(0) = 900$ K.\n- **Analysis Criteria**:\n    - Thresholds: $T_{\\mathrm{ign}} = 1400$ K, $T_{\\mathrm{ext}} = 1200$ K.\n    - Sustained ignition: First time $t_{\\mathrm{ign}}$ on up-ramp where $T(t)$ crosses and stays above $T_{\\mathrm{ign}}$ for at least $P = 1/f$.\n    - Sustained extinction: First time $t_{\\mathrm{ext}}$ on down-ramp where $T(t)$ crosses and stays below $T_{\\mathrm{ext}}$ for at least $P = 1/f$.\n    - Hysteresis width $\\Delta p = p_{\\mathrm{mean}}(t_{\\mathrm{ign}}) - p_{\\mathrm{mean}}(t_{\\mathrm{ext}})$.\n    - Re-ignition time $\\Delta t_{\\mathrm{re}} = t_{\\mathrm{ign,after}} - t_{\\mathrm{ext}}$.\n    - Default values of $-1.0$ if events are not found.\n- **Test Cases**: Three cases with specified values for $R, h, D, f, A_{\\mathrm{fluc}}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-founded in the principles of chemical engineering and combustion science. It uses standard models for heat transfer (convection, radiation), mass transfer (two-resistance theory), and chemical kinetics (Arrhenius law). The lumped-mass assumption is appropriate for small particles with high thermal conductivity. The models for reaction enhancement and efficiency change (sigmoidal functions) are physically reasonable representations of phenomena like oxide layer melting. **The problem is scientifically sound.**\n- **Well-Posedness**: The problem defines a first-order, non-linear Ordinary Differential Equation (ODE) for temperature $T(t)$ with a given initial condition. The functions involved are mathematically well-behaved, ensuring that a unique solution exists for the given time interval. The criteria for analyzing the solution are defined with precision, including the \"sustained\" condition for ignition and extinction, which is crucial for a problem with oscillatory forcing. **The problem is well-posed.**\n- **Objectivity**: All aspects of the problem are described using objective, mathematical, and physical terminology. There is no reliance on subjective or ambiguous language. **The problem is objective.**\n- **Flaw Checklist**: The problem does not violate any of the specified invalidity criteria. It is complete, internally consistent, physically plausible, and non-trivial.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be developed.\n\n### Derivation of the Governing Ordinary Differential Equation (ODE)\n\nThe energy balance for the particle is given by the First Law of Thermodynamics for a control mass: the rate of change of internal energy equals the net rate of heat addition.\n$$\n\\frac{dU}{dt} = \\dot{Q}_{\\text{net}}\n$$\nThe internal energy is $U = m c_p T$. Assuming constant mass $m$ and specific heat $c_p$, we have:\n$$\n\\frac{dU}{dt} = m c_p \\frac{dT}{dt}\n$$\nThe net heat rate is the sum of heat gained from the exothermic reaction, $\\dot{q}_{\\mathrm{rxn}}$, minus heat lost to the surroundings via convection, $\\dot{q}_{\\mathrm{conv}}$, and radiation, $\\dot{q}_{\\mathrm{rad}}$.\n$$\n\\dot{Q}_{\\text{net}} = \\dot{q}_{\\mathrm{rxn}} - \\dot{q}_{\\mathrm{conv}} - \\dot{q}_{\\mathrm{rad}}\n$$\nWhere:\n- Reaction gain: $\\dot{q}_{\\mathrm{rxn}}(t,T) = \\eta(T)\\, H_{\\mathrm{O}_2}\\, A\\, J_{\\mathrm{O}_2}(t,T)$\n- Convective loss: $\\dot{q}_{\\mathrm{conv}} = h A (T - T_g)$\n- Radiative loss: $\\dot{q}_{\\mathrm{rad}} = \\varepsilon \\sigma A (T^4 - T_g^4)$\n\nCombining these terms gives the energy balance equation:\n$$\nm c_p \\frac{dT}{dt} = \\eta(T)\\, H_{\\mathrm{O}_2}\\, A\\, J_{\\mathrm{O}_2}(t,T) - h A (T - T_g) - \\varepsilon \\sigma A (T^4 - T_g^4)\n$$\nTo obtain the final ODE for $T(t)$, we divide by $m c_p$ and substitute the ratio of surface area to mass, $\\frac{A}{m} = \\frac{4\\pi R^2}{\\rho \\frac{4}{3}\\pi R^3} = \\frac{3}{\\rho R}$:\n$$\n\\frac{dT}{dt} = \\frac{A}{m c_p} \\left[ \\eta(T)\\, H_{\\mathrm{O}_2}\\, J_{\\mathrm{O}_2}(t,T) - h (T - T_g) - \\varepsilon \\sigma (T^4 - T_g^4) \\right]\n$$\n$$\n\\frac{dT}{dt} = \\frac{3}{\\rho c_p R} \\left[ \\eta(T)\\, H_{\\mathrm{O}_2}\\, J_{\\mathrm{O}_2}(t,T) - h (T - T_g) - \\varepsilon \\sigma (T^4 - T_g^4) \\right]\n$$\nThe oxygen molar flux $J_{\\mathrm{O}_2}(t,T)$ is given by combining the expressions for effective velocity and concentration:\n$$\nJ_{\\mathrm{O}_2}(t,T) = \\left(\\frac{1}{k_m} + \\frac{1}{k_s(T)}\\right)^{-1} \\frac{p_{\\mathrm{O}_2}(t)}{R_u\\, T_g}\n$$\nwith $k_m = \\frac{\\mathrm{Sh}\\, D}{R}$. This completes the formulation of the ODE to be solved.\n\n### Numerical Implementation Strategy\n\n1.  **Encapsulation**: A class will be used to encapsulate all problem parameters and methods for each test case, promoting organized and reusable code.\n2.  **ODE Solver**: The `scipy.integrate.solve_ivp` function will be employed. This is a modern, robust solver suitable for potentially stiff systems common in combustion. We will request `dense_output=True` to obtain a continuous representation of the solution, which is essential for accurately finding the times at which temperature thresholds are crossed.\n3.  **Model Functions**: The time- and temperature-dependent terms ($p_{\\mathrm{mean}}(t)$, $p_{\\mathrm{O}_2}(t)$, $k_s(T)$, $\\eta(T)$) will be implemented as separate helper functions to maintain clarity in the main ODE right-hand side function.\n4.  **Analysis Logic**: After obtaining the numerical solution $T(t)$, a dedicated analysis function will process the time series. This function will:\n    - Generate a fine-grained time grid to evaluate the solution.\n    - Systematically search for upward crossings of $T_{\\mathrm{ign}}$ and downward crossings of $T_{\\mathrm{ext}}$ within the specified time windows (up-ramp and down-ramp, respectively).\n    - For each potential crossing, verify the \"sustained\" condition by checking that the temperature remains on the correct side of the threshold for a duration of at least one oscillation period $P = 1/f$.\n    - Use linear interpolation to accurately estimate the time of the crossing.\n    - Calculate the hysteresis width $\\Delta p$ and re-ignition time $\\Delta t_{\\mathrm{re}}$ based on the identified event times, handling cases where events do not occur by returning $-1.0$.\n5.  **Main Loop**: The program will iterate through the three specified test cases, instantiate the problem class, solve the ODE, analyze the results, and collect the final metrics.\n6.  **Output**: The final collected results will be formatted into the precise string format requested in the problem statement.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the particle combustion problem for all test cases.\n    \"\"\"\n\n    class ParticleCombustionProblem:\n        \"\"\"\n        Encapsulates the parameters and methods for solving the combustion ODE\n        for a single particle and analyzing the results.\n        \"\"\"\n        def __init__(self, case_params):\n            # Universal Constants\n            self.consts = {\n                'cp': 900.0, 'rho': 2700.0, 'Tg': 800.0, 'eps': 0.3,\n                'sigma': 5.670374419e-8, 'Sh': 2.0, 'H_O2': 1.0e6,\n                'As': 0.5, 'E': 1.2e5, 'B0': 500.0, 'T_trans': 1200.0,\n                'delta_T': 80.0, 'eta_l': 0.1, 'eta_h': 0.95,\n                'Ru': 8.314, 'p_max': 1.0e5, 'p_l': 1.0e4, 'p_h': 9.0e4,\n                't_ramp': 6.0, 't_hold': 1.0, 'T0': 900.0,\n                'T_ign_thresh': 1400.0, 'T_ext_thresh': 1200.0\n            }\n            # Update with case-specific parameters\n            self.params = self.consts.copy()\n            self.params.update(case_params)\n\n            # Pre-calculate frequently used values\n            self.t_ramp_up_end = self.params['t_ramp']\n            self.t_hold_end = self.params['t_ramp'] + self.params['t_hold']\n            self.t_final = 2 * self.params['t_ramp'] + self.params['t_hold']\n            self.p_l = self.params['p_l']\n            self.p_h = self.params['p_h']\n            self.period = 1.0 / self.params['f']\n        \n        def p_mean_func(self, t):\n            if t = self.t_ramp_up_end:\n                return self.p_l + (self.p_h - self.p_l) * (t / self.params['t_ramp'])\n            elif t = self.t_hold_end:\n                return self.p_h\n            elif t = self.t_final:\n                return self.p_h - (self.p_h - self.p_l) * (t - self.t_hold_end) / self.params['t_ramp']\n            return self.p_l\n\n        def p_o2_func(self, t):\n            p_mean = self.p_mean_func(t)\n            p_fluc = self.params['A_fluc'] * np.sin(2 * np.pi * self.params['f'] * t)\n            return np.clip(p_mean + p_fluc, 0, self.params['p_max'])\n\n        def k_s_func(self, T):\n            p = self.params\n            sig_term = 1.0 / (1.0 + np.exp(-(T - p['T_trans']) / p['delta_T']))\n            return p['As'] * np.exp(-p['E'] / (p['Ru'] * T)) * (1.0 + p['B0'] * sig_term)\n\n        def eta_func(self, T):\n            p = self.params\n            sig_term = 1.0 / (1.0 + np.exp(-(T - p['T_trans']) / p['delta_T']))\n            return p['eta_l'] + (p['eta_h'] - p['eta_l']) * sig_term\n\n        def ode_rhs(self, t, T_arr):\n            T = T_arr[0]\n            p = self.params\n\n            # Calculate intermediate terms\n            k_m = p['Sh'] * p['D'] / p['R']\n            k_s = self.k_s_func(T)\n            v_eff = 1.0 / (1.0 / k_m + 1.0 / k_s)\n            \n            p_o2 = self.p_o2_func(t)\n            C_o2 = p_o2 / (p['Ru'] * p['Tg'])\n            J_o2 = v_eff * C_o2\n            \n            eta = self.eta_func(T)\n\n            # Heat balance terms\n            q_gain = eta * p['H_O2'] * J_o2\n            q_loss_conv = p['h'] * (T - p['Tg'])\n            q_loss_rad = p['eps'] * p['sigma'] * (T**4 - p['Tg']**4)\n            \n            # ODE: dT/dt\n            dTdt = (3.0 / (p['rho'] * p['cp'] * p['R'])) * (q_gain - q_loss_conv - q_loss_rad)\n            return [dTdt]\n\n        def run_and_analyze(self):\n            # Solve the ODE\n            sol = solve_ivp(\n                self.ode_rhs,\n                (0, self.t_final),\n                [self.params['T0']],\n                dense_output=True,\n                method='LSODA',  # Robust for stiff systems\n                atol=1e-6, rtol=1e-5\n            )\n\n            # Analyze the solution\n            num_points = int(self.t_final * self.params['f'] * 20) # At least 20 points per oscillation\n            t_eval = np.linspace(0, self.t_final, num_points)\n            T_eval = sol.sol(t_eval)[0]\n\n            def find_sustained_crossing(direction, T_thresh, t_start, t_end):\n                for i in range(1, len(t_eval)):\n                    t_i, t_im1 = t_eval[i], t_eval[i-1]\n                    T_i, T_im1 = T_eval[i], T_eval[i-1]\n\n                    if not (t_start = t_i = t_end):\n                        continue\n\n                    is_crossing = False\n                    if direction == 'up' and T_im1 = T_thresh  T_i:\n                        is_crossing = True\n                    elif direction == 'down' and T_im1 >= T_thresh > T_i:\n                        is_crossing = True\n                    \n                    if is_crossing:\n                        t_cross = t_im1 + (t_i - t_im1) * (T_thresh - T_im1) / (T_i - T_im1)\n                        t_sustain_end = t_cross + self.period\n                        \n                        if t_sustain_end > self.t_final:\n                            continue # Cannot confirm sustained event\n\n                        # Check if sustained\n                        check_times = np.linspace(t_cross, t_sustain_end, 10)\n                        T_check = sol.sol(check_times)[0]\n                        \n                        is_sustained = False\n                        if direction == 'up' and np.all(T_check >= T_thresh):\n                            is_sustained = True\n                        elif direction == 'down' and np.all(T_check = T_thresh):\n                             is_sustained = True\n                        \n                        if is_sustained:\n                            return t_cross\n                return None\n\n            t_ign = find_sustained_crossing('up', self.params['T_ign_thresh'], 0, self.t_ramp_up_end)\n            t_ext = find_sustained_crossing('down', self.params['T_ext_thresh'], self.t_hold_end, self.t_final)\n\n            delta_p, delta_t_re = -1.0, -1.0\n\n            if t_ign is not None and t_ext is not None:\n                p_ign_mean = self.p_mean_func(t_ign)\n                p_ext_mean = self.p_mean_func(t_ext)\n                delta_p = p_ign_mean - p_ext_mean\n\n                t_ign_after = find_sustained_crossing('up', self.params['T_ign_thresh'], t_ext, self.t_final)\n                if t_ign_after is not None:\n                    delta_t_re = t_ign_after - t_ext\n            \n            return [delta_p, delta_t_re]\n\n    test_cases = [\n        {'R': 50e-6, 'h': 500.0, 'D': 1.0e-4, 'f': 8.0, 'A_fluc': 1.5e4}, # Case 1\n        {'R': 200e-6, 'h': 800.0, 'D': 1.0e-4, 'f': 5.0, 'A_fluc': 2.0e4}, # Case 2\n        {'R': 100e-6, 'h': 700.0, 'D': 6.0e-5, 'f': 12.0, 'A_fluc': 1.0e4}, # Case 3\n    ]\n    \n    results = []\n    for case in test_cases:\n        problem = ParticleCombustionProblem(case)\n        result = problem.run_and_analyze()\n        results.append(result)\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The combustion behavior of a metal particle is often controlled by the thin oxide layer forming on its surface. This advanced practice introduces a powerful technique for modeling the dynamics of this layer using a moving-boundary (Stefan) problem formulation . You will apply a quasi-steady-state approximation to reduce the complexity of the governing equations, deriving and solving an ordinary differential equation that describes the thickening and thinning of the oxide shell under varying ambient conditions.",
            "id": "4039058",
            "problem": "Consider a single, nearly spherical metal particle of radius $R_p$ covered by an oxide shell of thickness $h(t)$ that changes due to oxygen transport and surface reactions. The oxide is nonporous and at uniform temperature. Assume the shell thickness $h(t)$ is always much smaller than $R_p$, so radial curvature effects are negligible and oxygen transport across the shell can be treated in one-dimensional planar geometry. During an oxygen-starved period, the shell thickens due to inward transport of oxygen that reacts at the metal–oxide interface. Upon re-oxygenation, the shell can thin because the outer surface forms a volatile higher oxide whose evaporation removes oxide. You must formulate the transient moving-boundary (Stefan) problem for $h(t)$ from first principles and implement a numerical solution for the interface motion using the parameter sets provided.\n\nStart from the following foundational base:\n- Fick’s law of diffusion for the oxygen number concentration $C(x,t)$ in the oxide: $J(x,t) = -D\\,\\partial C/\\partial x$, where $J$ is the molar flux (in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$) and $D$ is the diffusivity (in $\\mathrm{m^2\\,s^{-1}}$).\n- An interfacial reaction at the metal–oxide interface with linear kinetics: $J_i(t) = k_i\\,C_i(t)$, where $C_i(t)$ is the interfacial oxygen concentration at $x=0$ (in $\\mathrm{mol\\,m^{-3}}$) and $k_i$ is the interfacial rate coefficient (in $\\mathrm{m\\,s^{-1}}$).\n- A boundary condition at the gas–oxide outer surface at $x=h(t)$ relating the surface oxygen concentration in the oxide to the external oxygen partial pressure $p_{O_2}(t)$ via a proportionality constant $H$: $C_\\infty(t) = H\\,p_{O_2}(t)$, with $H$ in $\\mathrm{mol\\,m^{-3}\\,Pa^{-1}}$.\n- The Stefan condition for the moving boundary at $x=0$ (metal–oxide interface) that converts interfacial oxygen flux into oxide thickness growth using the oxide molar volume $V_m$: $\\mathrm{d}h/\\mathrm{d}t = (V_m/\\nu)\\,J_i(t)$, where $\\nu$ is the number of oxygen atoms per oxide formula unit.\n- An evaporation sink at the outer surface that removes oxide upon re-oxygenation: $j_{\\mathrm{ev}}(t) = k_{\\mathrm{ev}}\\,p_{O_2}(t)$, expressed in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ of oxide removed, which contributes a thickness-loss term $-(V_m)\\,j_{\\mathrm{ev}}(t)$ in the Stefan condition.\n\nUnder the quasi-steady transport approximation ($\\partial C/\\partial t \\approx 0$ within the shell), the oxygen concentration profile across the oxide adjusts rapidly compared to $h(t)$, and the diffusion flux through the shell equals the interfacial reaction flux. Use this to derive a closed ordinary differential equation (ODE) for $h(t)$ that couples the diffusion resistance of the shell thickness and the interfacial reaction. The derivation must begin from the items listed above and must not assume any shortcut formulas. Explicitly justify each step of the reduction. Then, implement a computational solver for $h(t)$ over a piecewise-constant $p_{O_2}(t)$: a low value for $0 \\le t  t_{\\mathrm{sw}}$ (oxygen-starved) and a higher value for $t_{\\mathrm{sw}} \\le t \\le T$ (re-oxygenation). The evaporation term is inactive during the oxygen-starved period and active during re-oxygenation. Impose non-negativity $h(t) \\ge 0$ at all times.\n\nExpress all thicknesses in meters, all times in seconds, all pressures in pascals, and all fluxes in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$. Your program must compute the final oxide thickness $h(T)$ (in $\\mathrm{m}$) for each test case listed below and produce a single line of output that is a comma-separated list enclosed in square brackets in the order given below.\n\nTest suite parameter sets (each tuple lists $(D,\\,k_i,\\,H,\\,p_{\\mathrm{low}},\\,p_{\\mathrm{high}},\\,k_{\\mathrm{ev,high}},\\,V_m,\\,\\nu,\\,h_0,\\,t_{\\mathrm{sw}},\\,T)$):\n- Case $1$ (diffusion–reaction comparable; net thinning upon re-oxygenation): $(D=\\,$$1.0\\times 10^{-10}$, $k_i=\\,$$1.0\\times 10^{-2}$, $H=\\,$$5.0\\times 10^{-6}$, $p_{\\mathrm{low}}=\\,$$2.0\\times 10^{3}$, $p_{\\mathrm{high}}=\\,$$5.0\\times 10^{4}$, $k_{\\mathrm{ev,high}}=\\,$$5.0\\times 10^{-8}$, $V_m=\\,$$1.1\\times 10^{-5}$, $\\nu=\\,$$1$, $h_0=\\,$$1.0\\times 10^{-8}$, $t_{\\mathrm{sw}}=\\,$$0.5$, $T=\\,$$1.0$).\n- Case $2$ (reaction-limited; strong thinning upon re-oxygenation): $(D=\\,$$1.0\\times 10^{-10}$, $k_i=\\,$$1.0\\times 10^{-5}$, $H=\\,$$5.0\\times 10^{-6}$, $p_{\\mathrm{low}}=\\,$$2.0\\times 10^{3}$, $p_{\\mathrm{high}}=\\,$$5.0\\times 10^{4}$, $k_{\\mathrm{ev,high}}=\\,$$5.0\\times 10^{-8}$, $V_m=\\,$$1.1\\times 10^{-5}$, $\\nu=\\,$$1$, $h_0=\\,$$1.0\\times 10^{-8}$, $t_{\\mathrm{sw}}=\\,$$0.5$, $T=\\,$$1.0$).\n- Case $3$ (near-balance upon re-oxygenation): $(D=\\,$$1.0\\times 10^{-10}$, $k_i=\\,$$1.0\\times 10^{-2}$, $H=\\,$$5.0\\times 10^{-6}$, $p_{\\mathrm{low}}=\\,$$2.0\\times 10^{3}$, $p_{\\mathrm{high}}=\\,$$5.0\\times 10^{4}$, $k_{\\mathrm{ev,high}}=\\,$$2.5\\times 10^{-8}$, $V_m=\\,$$1.1\\times 10^{-5}$, $\\nu=\\,$$1$, $h_0=\\,$$1.0\\times 10^{-8}$, $t_{\\mathrm{sw}}=\\,$$0.5$, $T=\\,$$1.0$).\n- Case $4$ (diffusion-limited; edge case with minimal growth and potential shell loss): $(D=\\,$$1.0\\times 10^{-13}$, $k_i=\\,$$1.0\\times 10^{-2}$, $H=\\,$$5.0\\times 10^{-6}$, $p_{\\mathrm{low}}=\\,$$2.0\\times 10^{3}$, $p_{\\mathrm{high}}=\\,$$5.0\\times 10^{4}$, $k_{\\mathrm{ev,high}}=\\,$$5.0\\times 10^{-8}$, $V_m=\\,$$1.1\\times 10^{-5}$, $\\nu=\\,$$1$, $h_0=\\,$$5.0\\times 10^{-9}$, $t_{\\mathrm{sw}}=\\,$$0.5$, $T=\\,$$1.0$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[h_1, h_2, h_3, h_4]$ where each $h_i$ is the final oxide thickness for the corresponding case expressed in meters as a floating-point number.",
            "solution": "The user wants me to solve a transient moving-boundary problem related to the oxidation of a metal particle.\n\nHere's my thinking process:\n\n### 1. Problem Validation\n\nMy first step is to meticulously validate the problem statement.\n\n*   **Extract Givens**:\n    *   Geometry: Nearly spherical particle of radius $R_p$, oxide shell of thickness $h(t)$. Assumption: $h(t) \\ll R_p$, allowing 1D planar treatment.\n    *   Coordinate system: $x=0$ at the metal-oxide interface, $x=h(t)$ at the gas-oxide outer surface.\n    *   Diffusion: Fick's law for oxygen molar flux $J$ in the oxide: $J(x,t) = -D\\,\\partial C/\\partial x$. $C(x,t)$ is oxygen number concentration, $D$ is diffusivity.\n    *   Metal-Oxide Interfacial Reaction ($x=0$): Linear kinetics, $J_i(t) = k_i\\,C_i(t)$. $C_i(t)=C(0,t)$ is the interfacial oxygen concentration, $k_i$ is the rate coefficient.\n    *   Gas-Oxide Interfacial Concentration ($x=h(t)$): $C_\\infty(t) = H\\,p_{O_2}(t)$. $p_{O_2}(t)$ is external oxygen partial pressure, $H$ is a proportionality constant.\n    *   Stefan Condition for Growth (at $x=0$): $\\mathrm{d}h/\\mathrm{d}t = (V_m/\\nu)\\,J_i(t)$. $V_m$ is oxide molar volume, $\\nu$ is oxygen atoms per oxide formula unit.\n    *   Evaporation Sink (at $x=h(t)$): $j_{\\mathrm{ev}}(t) = k_{\\mathrm{ev}}\\,p_{O_2}(t)$, contributing a thickness loss rate of $-(V_m)\\,j_{\\mathrm{ev}}(t)$.\n    *   Core Assumption: Quasi-steady transport, $\\partial C/\\partial t \\approx 0$ within the shell.\n    *   Process Timeline:\n        *   Oxygen-starved period ($0 \\le t  t_{\\mathrm{sw}}$): $p_{O_2}(t) = p_{\\mathrm{low}}$, evaporation is inactive.\n        *   Re-oxygenation period ($t_{\\mathrm{sw}} \\le t \\le T$): $p_{O_2}(t) = p_{\\mathrm{high}}$, evaporation is active.\n    *   Constraint: $h(t) \\ge 0$.\n    *   Initial condition: $h(0)=h_0$.\n    *   Parameters: Values for $(D,\\,k_i,\\,H,\\,p_{\\mathrm{low}},\\,p_{\\mathrm{high}},\\,k_{\\mathrm{ev,high}},\\,V_m,\\,\\nu,\\,h_0,\\,t_{\\mathrm{sw}},\\,T)$ are provided for 4 test cases.\n\n*   **Validate Using Extracted Givens**:\n    1.  **Scientifically Grounded**: The problem combines Fickian diffusion, first-order reaction kinetics, and a Stefan condition for a moving boundary. This framework is a standard and physically sound approach for modeling reaction-diffusion processes like metal oxidation, corrosion, and chemical vapor deposition. The quasi-steady state approximation is a common and valid simplification when the timescale of species diffusion across the thin layer is much faster than the timescale of the boundary movement. These principles are fundamental to materials science and chemical engineering. The problem is scientifically grounded.\n    2.  **Well-Posed**: The problem provides a set of governing equations, an initial condition $h(0)=h_0$, and piecewise-constant parameters, which defines a well-posed initial value problem for an ordinary differential equation (ODE) in $h(t)$. A unique solution exists and can be found by numerical integration.\n    3.  **Objective**: The language is precise and quantitative. All terms are defined mathematically. The parameters are given as numerical values. There are no subjective or opinion-based statements.\n    4.  **Completeness**: All necessary physical laws, constants, and conditions are provided to derive and solve the governing equation. The problem is self-contained.\n    5.  **Consistency**: There are no apparent contradictions in the provided physics or data. The units are consistent if standard SI units are used, which is specified. For example, the Stefan condition is dimensionally consistent: $\\mathrm{d}h/\\mathrm{d}t$ ($\\mathrm{m\\,s^{-1}}$), $(V_m/\\nu)$ ($\\mathrm{m^3\\,mol^{-1}}$), $J_i$ ($\\mathrm{mol\\,m^{-2}\\,s^{-1}}$) gives $(V_m/\\nu)J_i$ in $\\mathrm{m\\,s^{-1}}$. The evaporation term is also consistent: $V_m$ ($\\mathrm{m^3\\,mol^{-1}}$), $j_{\\mathrm{ev}}$ ($\\mathrm{mol\\,m^{-2}\\,s^{-1}}$) gives $V_m j_{\\mathrm{ev}}$ in $\\mathrm{m\\,s^{-1}}$.\n\n*   **Verdict**: The problem is valid. It is a well-formulated, scientifically sound problem in computational transport phenomena, relevant to the specified domain of computational combustion.\n\n### 2. Derivation of the Governing ODE\n\nThe objective is to derive a single ODE for the oxide shell thickness, $h(t)$. This is achieved by first solving for the oxygen concentration profile $C(x,t)$ under the quasi-steady state approximation and then using this result in the Stefan condition.\n\n**Step 2a: Oxygen Concentration Profile**\n\nUnder the quasi-steady approximation, the time derivative of the concentration is negligible, $\\partial C/\\partial t \\approx 0$. The one-dimensional species conservation equation is $\\partial C/\\partial t = -\\partial J/\\partial x$. This simplifies to $\\partial J/\\partial x = 0$. Substituting Fick's law, $J = -D\\,\\partial C/\\partial x$, we get:\n$$ \\frac{\\partial}{\\partial x}\\left(-D\\frac{\\partial C}{\\partial x}\\right) = 0 $$\nAssuming the diffusivity $D$ is constant, this becomes the Laplace equation:\n$$ \\frac{\\partial^2 C}{\\partial x^2} = 0 $$\nIntegrating this equation twice with respect to the spatial coordinate $x$ gives a linear concentration profile:\n$$ C(x,t) = A(t) x + B(t) $$\nThe time-dependent coefficients $A(t)$ and $B(t)$ are determined by the boundary conditions at the two interfaces of the oxide shell.\n\nThe boundary at the metal-oxide interface is at $x=0$, where the concentration is $C(0,t) = C_i(t)$.\nThe boundary at the gas-oxide interface is at $x=h(t)$, where the concentration is given by $C(h(t),t) = C_\\infty(t) = H\\,p_{O_2}(t)$.\n\nApplying the first boundary condition at $x=0$:\n$$ C(0,t) = A(t) \\cdot 0 + B(t) = C_i(t) \\implies B(t) = C_i(t) $$\nApplying the second boundary condition at $x=h(t)$:\n$$ C(h(t),t) = A(t)h(t) + C_i(t) = C_\\infty(t) $$\nSolving for the coefficient $A(t)$:\n$$ A(t) = \\frac{C_\\infty(t) - C_i(t)}{h(t)} $$\nSubstituting $A(t)$ and $B(t)$ back into the general solution gives the explicit concentration profile across the oxide shell:\n$$ C(x,t) = \\left(\\frac{C_\\infty(t) - C_i(t)}{h(t)}\\right)x + C_i(t) $$\n\n**Step 2b: Interfacial Flux and Elimination of $C_i(t)$**\n\nThe quasi-steady approximation implies that the diffusion flux is constant throughout the shell. The magnitude of this flux, directed from the higher concentration at $x=h(t)$ to the lower concentration at $x=0$, is given by:\n$$ J_{\\text{diff}}(t) = \\left|-D\\frac{\\partial C}{\\partial x}\\right| = \\left|-D \\cdot A(t)\\right| = D \\frac{C_\\infty(t) - C_i(t)}{h(t)} $$\nAt the metal-oxide interface ($x=0$), this diffusion flux must be equal to the consumption flux due to the surface reaction, $J_i(t) = k_i\\,C_i(t)$. Equating the two fluxes allows us to eliminate the unknown interfacial concentration $C_i(t)$:\n$$ D \\frac{C_\\infty(t) - C_i(t)}{h(t)} = k_i C_i(t) $$\nWe can now solve for $C_i(t)$:\n$$ D\\,C_\\infty(t) - D\\,C_i(t) = k_i h(t) C_i(t) $$\n$$ D\\,C_\\infty(t) = C_i(t) \\left( D + k_i h(t) \\right) $$\n$$ C_i(t) = \\frac{D\\,C_\\infty(t)}{D + k_i h(t)} $$\nNow, we can express the interfacial reaction flux $J_i(t)$ solely in terms of $h(t)$ and known external conditions:\n$$ J_i(t) = k_i C_i(t) = k_i \\left( \\frac{D\\,C_\\infty(t)}{D + k_i h(t)} \\right) = \\frac{k_i D H p_{O_2}(t)}{D + k_i h(t)} $$\n\n**Step 2c: The Final ODE for $h(t)$**\n\nThe Stefan condition describes the net rate of change of the shell thickness. It accounts for growth due to the reaction at the inner interface and loss due to evaporation at the outer interface:\n$$ \\frac{\\mathrm{d}h}{\\mathrm{d}t} = (\\text{growth rate}) - (\\text{loss rate}) = \\frac{V_m}{\\nu}J_i(t) - V_m j_{\\mathrm{ev}}(t) $$\nSubstituting the expressions for $J_i(t)$ and $j_{\\mathrm{ev}}(t) = k_{\\mathrm{ev}}p_{O_2}(t)$, we obtain the final governing ODE for $h(t)$:\n$$ \\frac{\\mathrm{d}h}{\\mathrm{d}t} = \\frac{V_m}{\\nu}\\left(\\frac{k_i D H p_{O_2}(t)}{D + k_i h(t)}\\right) - V_m k_{\\mathrm{ev}}(t) p_{O_2}(t) $$\nThis is a first-order, nonlinear ordinary differential equation for $h(t)$.\n\n### 3. Numerical Solution Strategy\n\nThe problem involves two distinct time periods with different parameters. We must solve the ODE in a piecewise manner.\n\n**Phase 1: Oxygen-starved period ($0 \\le t  t_{\\mathrm{sw}}$)**\nDuring this phase, $p_{O_2}(t) = p_{\\mathrm{low}}$ and the evaporation term is inactive ($k_{\\mathrm{ev}} = 0$). The ODE simplifies to:\n$$ \\frac{\\mathrm{d}h}{\\mathrm{d}t} = \\frac{V_m}{\\nu}\\left(\\frac{k_i D H p_{\\mathrm{low}}}{D + k_i h(t)}\\right) $$\nWe integrate this ODE from $t=0$ to $t=t_{\\mathrm{sw}}$ with the initial condition $h(0) = h_0$.\n\n**Phase 2: Re-oxygenation period ($t_{\\mathrm{sw}} \\le t \\le T$)**\nDuring this phase, $p_{O_2}(t) = p_{\\mathrm{high}}$ and evaporation is active with rate constant $k_{\\mathrm{ev,high}}$. The full ODE applies:\n$$ \\frac{\\mathrm{d}h}{\\mathrm{d}t} = \\frac{V_m}{\\nu}\\left(\\frac{k_i D H p_{\\mathrm{high}}}{D + k_i h(t)}\\right) - V_m k_{\\mathrm{ev,high}} p_{\\mathrm{high}} $$\nThe initial condition for this phase is the thickness at the end of Phase 1, $h(t_{\\mathrm{sw}})$. We integrate this ODE from $t=t_{\\mathrm{sw}}$ to $t=T$.\n\nA critical constraint is that the thickness must remain non-negative, $h(t) \\ge 0$. In Phase 2, the rate $\\mathrm{d}h/\\mathrm{d}t$ can be negative. If the shell thins completely, its thickness should become zero and remain there.\n\n**Implementation**:\nWe will use the `scipy.integrate.solve_ivp` function, a robust numerical ODE solver.\n1.  Define a function for the RHS of the ODE for Phase 1.\n2.  Call `solve_ivp` to integrate over $[0, t_{\\mathrm{sw}}]$ starting from $h_0$.\n3.  Extract the solution at $t_{\\mathrm{sw}}$ to use as the initial condition for Phase 2.\n4.  Define a function for the RHS of the ODE for Phase 2.\n5.  Define an `event` function for `solve_ivp` that detects when $h(t)$ crosses zero from above. We set this event to be terminal, meaning the integration will stop if the shell is fully consumed.\n6.  Call `solve_ivp` for the interval $[t_{\\mathrm{sw}}, T]$.\n7.  If the integration was terminated by the event, the final thickness is $0$. Otherwise, it is the value computed at $t=T$. This procedure is repeated for each parameter set provided in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the moving-boundary problem for metal particle oxidation for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple lists (D, k_i, H, p_low, p_high, k_ev_high, V_m, nu, h_0, t_sw, T)\n    test_cases = [\n        (1.0e-10, 1.0e-2, 5.0e-6, 2.0e3, 5.0e4, 5.0e-8, 1.1e-5, 1, 1.0e-8, 0.5, 1.0),\n        (1.0e-10, 1.0e-5, 5.0e-6, 2.0e3, 5.0e4, 5.0e-8, 1.1e-5, 1, 1.0e-8, 0.5, 1.0),\n        (1.0e-10, 1.0e-2, 5.0e-6, 2.0e3, 5.0e4, 2.5e-8, 1.1e-5, 1, 1.0e-8, 0.5, 1.0),\n        (1.0e-13, 1.0e-2, 5.0e-6, 2.0e3, 5.0e4, 5.0e-8, 1.1e-5, 1, 5.0e-9, 0.5, 1.0),\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        D, ki, H, p_low, p_high, k_ev_high, Vm, nu, h0, t_sw, T = params\n\n        # === Phase 1: Oxygen-starved growth (0 = t  t_sw) ===\n        # The ODE is: dh/dt = (Vm/nu) * [ki*D*H*p_low] / [D + ki*h]\n        def ode_phase1(t, h_arr):\n            h = h_arr[0]\n            # Enforce non-negativity as a precaution, though h should grow here.\n            h = max(0, h)\n            \n            numerator = (Vm / nu) * ki * D * H * p_low\n            denominator = D + ki * h\n            \n            # If denominator is zero (unlikely for positive h), return 0 rate.\n            if denominator == 0:\n                return [0.0]\n                \n            return [numerator / denominator]\n\n        # Integrate from t=0 to t=t_sw\n        sol1 = solve_ivp(\n            ode_phase1, \n            [0, t_sw], \n            [h0], \n            dense_output=True, \n            method='RK45'\n        )\n        # Get the shell thickness at the end of phase 1\n        h_intermediate = sol1.sol(t_sw)[0]\n\n        # If somehow thickness becomes non-positive, it stays zero.\n        if h_intermediate = 0:\n            results.append(0.0)\n            continue\n            \n        # === Phase 2: Re-oxygenation (t_sw = t = T) ===\n        # The ODE is: dh/dt = (Vm/nu) * [ki*D*H*p_high] / [D + ki*h] - Vm*k_ev_high*p_high\n        def ode_phase2(t, h_arr):\n            h = h_arr[0]\n            # Non-negativity is handled by the event, but this is a safeguard.\n            h = max(0, h)\n\n            growth_numerator = (Vm / nu) * ki * D * H * p_high\n            denominator = D + ki * h\n            \n            if denominator == 0:\n                growth_term = np.inf\n            else:\n                 growth_term = growth_numerator / denominator\n            \n            loss_term = Vm * k_ev_high * p_high\n            \n            return [growth_term - loss_term]\n\n        # Define an event to stop integration if h becomes zero\n        def zero_crossing(t, h_arr):\n            return h_arr[0]\n        \n        zero_crossing.terminal = True  # Stop integration when event occurs\n        zero_crossing.direction = -1   # Trigger event only when h is decreasing\n\n        # Integrate from t=t_sw to t=T\n        sol2 = solve_ivp(\n            ode_phase2, \n            [t_sw, T], \n            [h_intermediate], \n            events=zero_crossing, \n            dense_output=True,\n            method='RK45'\n        )\n\n        # Determine the final thickness\n        final_h = 0.0\n        # If the zero-crossing event was triggered\n        if sol2.t_events[0].size > 0:\n            final_h = 0.0\n        else:\n            # If integration completed to t=T without the event\n            final_h = sol2.sol(T)[0]\n\n        # Final check to clamp any small negative numerical result to zero\n        final_h = max(0.0, final_h)\n\n        results.append(final_h)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}