{
    "hands_on_practices": [
        {
            "introduction": "液滴撞击的结果取决于惯性力、粘性力和毛细管力的相互作用。本练习通过从控制方程中推导关键的无量纲数（如雷诺数 $Re$ 和韦伯数 $We$），并利用经验关联式预测飞溅与沉积的临界条件，来加深您对这一核心物理机制的理解。",
            "id": "4022603",
            "problem": "一个直径为 $D$ 的单组分牛顿流体碳氢燃料液滴，以速度 $U$ 垂直撞击一个光滑、干燥、等温的固体壁面。该流体的密度为 $\\rho$，动力粘度为 $\\mu$，表面张力为 $\\gamma$。在短暂的撞击时间内，蒸发、相变和气相效应可以忽略不计，且在惯性撞击时间尺度上，重力也可以忽略不计。从考虑了液-气界面毛细作用的不可压缩纳维-斯托克斯方程出发，\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t}+\\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)=-\\nabla p+\\mu \\nabla^{2}\\boldsymbol{u},\\quad \\nabla\\cdot \\boldsymbol{u}=0,\n$$\n以及界面上的毛细法向应力跳跃条件 $\\Delta p=\\gamma \\kappa$，使用特征尺度长度 $D$、速度 $U$、时间 $D/U$ 和压力 $\\rho U^{2}$ 对这些方程进行无量纲化。根据 $(\\rho,\\mu,\\gamma,U,D)$，确定在此情景下控制液滴撞击和界面动力学的四个典型无量纲数：雷诺数、韦伯数、奥内佐格数和毛细数。解释它们如何从无量纲化的方程和界面条件中导出。\n\n然后，对于一个液滴，其参数为 $D=100\\,\\mu\\mathrm{m}$、$U=10\\,\\mathrm{m/s}$、$\\rho=800\\,\\mathrm{kg/m^3}$、$\\mu=2\\,\\mathrm{mPa\\,s}$ 和 $\\gamma=0.025\\,\\mathrm{N/m}$，计算这四个无量纲数的数值。使用一个广泛报道的、用于光滑干表面上垂直撞击的飞溅阈值关联式 $K=We^{1/2}Re^{1/4}$（临界值为 $K_{\\mathrm{crit}}=57.7$），通过定义一个结果指标 $S$ 来判断可能的结果是飞溅还是沉积。如果 $K>K_{\\mathrm{crit}}$（可能发生飞溅），则 $S$ 等于 $1$；否则（可能发生沉积），$S$ 等于 $0$。\n\n将你的最终答案以单行矩阵 $\\begin{pmatrix}Re  We  Oh  Ca  S\\end{pmatrix}$ 的形式报告。将 $Re$、$We$、$Oh$ 和 $Ca$ 中的每一个都四舍五入到四位有效数字。将 $S$ 报告为整数 $0$ 或 $1$。所有报告的量均为无量纲量。",
            "solution": "首先验证该问题是科学合理的、适定的、客观的和完整的。所有必要的数据、方程和条件都已提供，并且它们符合流体动力学的既定原理。对于碳氢燃料液滴，给出的数值是物理上现实的。该问题是量纲分析及其在实际工程关联式中应用的典型练习。\n\n第一步是将控制方程和界面条件无量纲化，以确定典型的无量纲数。提供的特征尺度是长度 $D$、速度 $U$、时间 $D/U$ 和压力 $\\rho U^2$。我们定义以下无量纲变量，用上标星号表示：\n$$\n\\boldsymbol{x}^* = \\frac{\\boldsymbol{x}}{D}, \\quad \\boldsymbol{u}^* = \\frac{\\boldsymbol{u}}{U}, \\quad t^* = \\frac{t}{D/U}, \\quad p^* = \\frac{p}{\\rho U^2}\n$$\n以无量纲坐标表示的微分算子为：\n$$\n\\frac{\\partial}{\\partial t} = \\frac{U}{D}\\frac{\\partial}{\\partial t^*}, \\quad \\nabla = \\frac{1}{D}\\nabla^*, \\quad \\nabla^2 = \\frac{1}{D^2}\\nabla^{*2}\n$$\n我们将这些代入不可压缩纳维-斯托克斯动量方程：\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t}+\\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)=-\\nabla p+\\mu \\nabla^{2}\\boldsymbol{u}\n$$\n代入经过标度化的变量和算子，得到：\n$$\n\\rho\\left(\\frac{U}{D}\\frac{\\partial (U\\boldsymbol{u}^*)}{\\partial t^*} + (U\\boldsymbol{u}^*)\\cdot\\left(\\frac{1}{D}\\nabla^*\\right)(U\\boldsymbol{u}^*)\\right) = -\\left(\\frac{1}{D}\\nabla^*\\right)(\\rho U^2 p^*) + \\mu \\left(\\frac{1}{D^2}\\nabla^{*2}\\right)(U\\boldsymbol{u}^*)\n$$\n将有量纲的系数因子提出来：\n$$\n\\frac{\\rho U^2}{D}\\left(\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^*\\right) = -\\frac{\\rho U^2}{D}\\nabla^* p^* + \\frac{\\mu U}{D^2}\\nabla^{*2} \\boldsymbol{u}^*\n$$\n为了使方程无量纲化，我们将所有项除以惯性项的系数 $\\rho U^2/D$：\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^* = -\\nabla^* p^* + \\left(\\frac{\\mu U/D^2}{\\rho U^2/D}\\right)\\nabla^{*2} \\boldsymbol{u}^*\n$$\n作为粘性项系数出现的无量纲数可简化为：\n$$\n\\frac{\\mu U D}{\\rho U^2 D^2} = \\frac{\\mu}{\\rho U D}\n$$\n这个数是**雷诺数** $Re$ 的倒数。因此，$Re = \\frac{\\rho U D}{\\mu}$。无量纲的动量方程为：\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^* = -\\nabla^* p^* + \\frac{1}{Re}\\nabla^{*2} \\boldsymbol{u}^*\n$$\n雷诺数 $Re$ 源于动量方程中惯性力与粘性力的比值。\n\n接下来，我们将液-气界面上的毛细法向应力跳跃条件 $\\Delta p=\\gamma \\kappa$ 无量纲化。曲率 $\\kappa$ 的单位是长度的倒数，所以其无量纲形式为 $\\kappa^* = \\kappa D$。\n$$\n\\Delta p = \\gamma \\kappa \\implies \\Delta(p^* \\rho U^2) = \\gamma \\frac{\\kappa^*}{D}\n$$\n$$\n(\\rho U^2) \\Delta p^* = \\frac{\\gamma}{D}\\kappa^*\n$$\n整理得到无量纲压力跳跃 $\\Delta p^*$：\n$$\n\\Delta p^* = \\left(\\frac{\\gamma}{\\rho U^2 D}\\right) \\kappa^*\n$$\n这个无量纲数是**韦伯数** $We$ 的倒数。因此，$We = \\frac{\\rho U^2 D}{\\gamma}$。无量纲的界面条件是 $\\Delta p^* = \\frac{1}{We}\\kappa^*$。韦伯数 $We$ 源于惯性力（或动压）与表面张力之比。\n\n**奥内佐格数** $Oh$ 和**毛细数** $Ca$ 是由 $Re$ 和 $We$ 导出的。奥内佐格数的构造与速度 $U$ 无关，因此仅表征流体和长度尺度的特性。其定义为：\n$$\nOh = \\frac{\\sqrt{We}}{Re} = \\frac{\\sqrt{\\rho U^2 D/\\gamma}}{\\rho U D/\\mu} = \\frac{U\\sqrt{\\rho D/\\gamma}}{U(\\rho D/\\mu)} = \\frac{\\mu}{\\sqrt{\\rho \\gamma D}}\n$$\n奥内佐格数关联了粘性力与惯性力和表面张力的几何平均值。\n\n毛细数关联了粘性力与表面张力，其定义为：\n$$\nCa = \\frac{We}{Re} = \\frac{\\rho U^2 D/\\gamma}{\\rho U D/\\mu} = \\frac{\\mu U}{\\gamma}\n$$\n\n现在，我们计算一个液滴的这四个无量纲数的数值，其参数为 $D=100\\,\\mu\\mathrm{m} = 1 \\times 10^{-4}\\,\\mathrm{m}$、$U=10\\,\\mathrm{m/s}$、$\\rho=800\\,\\mathrm{kg/m^3}$、$\\mu=2\\,\\mathrm{mPa\\,s} = 2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$ 和 $\\gamma=0.025\\,\\mathrm{N/m}$。\n\n雷诺数为：\n$$\nRe = \\frac{\\rho U D}{\\mu} = \\frac{(800\\,\\mathrm{kg/m^3}) (10\\,\\mathrm{m/s}) (1 \\times 10^{-4}\\,\\mathrm{m})}{2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}} = \\frac{0.8}{0.002} = 400\n$$\n四舍五入到四位有效数字，$Re = 400.0$。\n\n韦伯数为：\n$$\nWe = \\frac{\\rho U^2 D}{\\gamma} = \\frac{(800\\,\\mathrm{kg/m^3}) (10\\,\\mathrm{m/s})^2 (1 \\times 10^{-4}\\,\\mathrm{m})}{0.025\\,\\mathrm{N/m}} = \\frac{800 \\times 100 \\times 10^{-4}}{0.025} = \\frac{8}{0.025} = 320\n$$\n四舍五入到四位有效数字，$We = 320.0$。\n\n奥内佐格数为：\n$$\nOh = \\frac{\\mu}{\\sqrt{\\rho \\gamma D}} = \\frac{2 \\times 10^{-3}}{\\sqrt{(800)(0.025)(1 \\times 10^{-4})}} = \\frac{2 \\times 10^{-3}}{\\sqrt{0.002}} = \\frac{2 \\times 10^{-3}}{0.0447213...} \\approx 0.0447213...\n$$\n四舍五入到四位有效数字，$Oh = 0.04472$。\n\n毛细数为：\n$$\nCa = \\frac{\\mu U}{\\gamma} = \\frac{(2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}) (10\\,\\mathrm{m/s})}{0.025\\,\\mathrm{N/m}} = \\frac{0.02}{0.025} = 0.8\n$$\n四舍五入到四位有效数字，$Ca = 0.8000$。\n\n最后，我们使用飞溅关联式 $K=We^{1/2}Re^{1/4}$ 和临界值 $K_{\\mathrm{crit}}=57.7$ 来分类撞击结果。结果指标 $S$ 在发生飞溅时（$K > K_{\\mathrm{crit}}$）等于 $1$，在发生沉积时（$K \\le K_{\\mathrm{crit}}$）等于 $0$。\n我们计算飞溅参数 $K$：\n$$\nK = We^{1/2}Re^{1/4} = (320)^{1/2}(400)^{1/4}\n$$\n我们可以将其写为 $K = (\\sqrt{320})(\\sqrt[4]{400}) = (\\sqrt{64 \\times 5})(\\sqrt[4]{4 \\times 100}) = (8\\sqrt{5})(\\sqrt{2}\\sqrt{10}) = (8\\sqrt{5})(\\sqrt{2}\\sqrt{2}\\sqrt{5}) = (8\\sqrt{5})(2\\sqrt{5}) = 16 \\times 5 = 80$。\n计算出的值为 $K=80$。我们将其与临界值进行比较：\n$$\nK = 80 > K_{\\mathrm{crit}} = 57.7\n$$\n由于 $K$ 大于 $K_{\\mathrm{crit}}$，可能的结果是飞溅。因此，结果指标为 $S=1$。\n\n最终结果为 $Re = 400.0$、$We = 320.0$、$Oh = 0.04472$、$Ca = 0.8000$ 和 $S=1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 400.0  320.0  0.04472  0.8000  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当液滴以沉积方式撞击壁面时，会形成一个铺展的液膜，这一过程在表面冷却和涂层等应用中至关重要。本练习将引导您从斯托克斯方程出发，推导出一个包含壁面滑移效应的铺展定律，从而深入探究液膜形成的物理机制。这项实践旨在通过将复杂问题简化为其核心要素，来锻炼您的解析建模能力。",
            "id": "4022614",
            "problem": "考虑一个等温液滴在气体环境中撞击光滑、水平的刚性壁面。在与计算燃烧学相关的早期阶段，形成一个薄的轴对称液膜并径向铺展开来。采用柱坐标系，其中径向坐标为 $r$，壁面法向坐标为 $z$。设液膜具有均匀的厚度 $h$，其尖锐边缘位于半径 $R(t)$ 处。假设液膜处于低雷诺数斯托克斯流态（忽略液膜内部的惯性、重力和可压缩性），并将近壁面流动模拟为由缓慢变化的径向压力梯度驱动的局部一维剪切流。设自由表面为无剪切表面，并在壁面处施加纳维-滑移边界条件。具体来说，设径向速度场 $u(r,z,t)$ 在液膜内部满足不可压缩斯托克斯动量平衡方程\n$$\n0 \\;=\\; -\\frac{\\partial p}{\\partial r} \\;+\\; \\mu\\,\\frac{\\partial^{2} u}{\\partial z^{2}},\n$$\n其中 $\\mu$ 是动力粘度，以及以下边界条件\n$$\n\\frac{\\partial u}{\\partial z}\\bigg|_{z=h} \\;=\\; 0 \\quad \\text{(无剪切自由表面)}, \\qquad u\\big|_{z=0} \\;=\\; b\\,\\frac{\\partial u}{\\partial z}\\bigg|_{z=0} \\quad \\text{(壁面处的纳维-滑移)},\n$$\n其中 $b$ 是滑移长度。设液膜由液膜内部与边缘之间径向均匀、缓慢变化的压降 $\\Delta p(t)$ 驱动，使得局部压力梯度可以近似为\n$$\n-\\frac{\\partial p}{\\partial r} \\;\\approx\\; \\frac{\\Delta p(t)}{R(t)}.\n$$\n假设在所关注的短时间间隔内，$h$ 在空间和时间上是恒定的，并且前沿速度由液膜体积的质量守恒通过以下运动学关系控制\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\big(\\pi R^{2} h\\big) \\;=\\; 2\\pi R\\,q(R,t),\n$$\n其中 $q(r,t)$ 是深度积分的径向体积通量，定义为 $q(r,t) \\equiv \\int_{0}^{h} u(r,z,t)\\,\\mathrm{d}z$。使用这些假设，并从给定的控制方程和边界条件出发，在进一步的短时间近似下（即在所考虑的时间间隔内 $\\Delta p(t)$ 是一个常数，等于 $\\Delta p$），推导铺展半径 $R(t)$ 关于 $\\mu$、$h$、$b$、$\\Delta p$ 和时间 $t$ 的闭式表达式。最终的 $R(t)$ 以米为单位表示。不需要进行数值代入；请提供一个单一的解析表达式。",
            "solution": "问题要求推导液体液膜铺展半径 $R(t)$ 的表达式。推导从问题中给出的、在液膜内部有效的、关于速度 $u(r,z,t)$ 的径向 $r$ 方向的不可压缩斯托克斯动量平衡方程开始：\n$$0 = -\\frac{\\partial p}{\\partial r} + \\mu\\,\\frac{\\partial^{2} u}{\\partial z^{2}}$$\n其中 $p$ 是压力，$\\mu$ 是动力粘度，$z$ 是壁面法向坐标。\n\n问题中说明，将压力梯度近似为均匀的，并与液膜径向范围 $R(t)$ 上的压降 $\\Delta p(t)$ 相关联：\n$$-\\frac{\\partial p}{\\partial r} \\approx \\frac{\\Delta p(t)}{R(t)}$$\n此外，对于短时间近似，$\\Delta p(t)$ 被视为一个常数 $\\Delta p$。将此代入动量方程，得到：\n$$\\mu\\,\\frac{\\partial^{2} u}{\\partial z^{2}} = -\\frac{\\Delta p}{R(t)}$$\n整理后，我们得到一个关于 $u$ 作为 $z$ 的函数的二阶常微分方程，其中 $t$ 通过 $R(t)$ 作为参数出现：\n$$\\frac{\\partial^{2} u}{\\partial z^{2}} = -\\frac{\\Delta p}{\\mu R(t)}$$\n我们将此方程对 $z$ 积分两次：\n$$\\frac{\\partial u}{\\partial z} = -\\frac{\\Delta p}{\\mu R(t)} z + C_{1}$$\n$$u(r,z,t) = -\\frac{\\Delta p}{2\\mu R(t)} z^{2} + C_{1}z + C_{2}$$\n积分“常数”$C_{1}$ 和 $C_{2}$ 由边界条件确定。\n\n第一个边界条件是自由表面 $z=h$ 处的无剪切条件：\n$$\\frac{\\partial u}{\\partial z}\\bigg|_{z=h} = 0$$\n将此应用于我们关于 $\\frac{\\partial u}{\\partial z}$ 的表达式：\n$$-\\frac{\\Delta p}{\\mu R(t)}h + C_{1} = 0 \\implies C_{1} = \\frac{\\Delta p h}{\\mu R(t)}$$\n\n第二个边界条件是壁面 $z=0$ 处的纳维-滑移条件：\n$$u\\big|_{z=0} = b\\,\\frac{\\partial u}{\\partial z}\\bigg|_{z=0}$$\n其中 $b$ 是滑移长度。根据我们积分得到的表达式：\n$$u\\big|_{z=0} = C_{2}$$\n$$\\frac{\\partial u}{\\partial z}\\bigg|_{z=0} = C_{1}$$\n因此，该边界条件意味着 $C_{2} = b C_{1}$。代入已确定的 $C_{1}$ 值：\n$$C_{2} = b \\left(\\frac{\\Delta p h}{\\mu R(t)}\\right) = \\frac{b \\Delta p h}{\\mu R(t)}$$\n\n现在，我们将 $C_{1}$ 和 $C_{2}$ 代回到 $u(r,z,t)$ 的表达式中：\n$$u(r,z,t) = -\\frac{\\Delta p}{2\\mu R(t)} z^{2} + \\frac{\\Delta p h}{\\mu R(t)}z + \\frac{b \\Delta p h}{\\mu R(t)}$$\n我们可以提取公因式以获得速度分布：\n$$u(r,z,t) = \\frac{\\Delta p}{\\mu R(t)} \\left( -\\frac{z^{2}}{2} + hz + bh \\right)$$\n\n接下来，我们计算深度积分的径向体积通量 $q(r,t)$，其定义为：\n$$q(r,t) \\equiv \\int_{0}^{h} u(r,z,t)\\,\\mathrm{d}z$$\n$$q(r,t) = \\frac{\\Delta p}{\\mu R(t)} \\int_{0}^{h} \\left( -\\frac{z^{2}}{2} + hz + bh \\right) \\mathrm{d}z$$\n进行积分：\n$$q(r,t) = \\frac{\\Delta p}{\\mu R(t)} \\left[ -\\frac{z^{3}}{6} + \\frac{hz^{2}}{2} + bhz \\right]_{0}^{h}$$\n$$q(r,t) = \\frac{\\Delta p}{\\mu R(t)} \\left( -\\frac{h^{3}}{6} + \\frac{h^{3}}{2} + bh^{2} \\right) = \\frac{\\Delta p}{\\mu R(t)} \\left( \\frac{2h^{3}}{6} + bh^{2} \\right)$$\n$$q(r,t) = \\frac{\\Delta p}{\\mu R(t)} \\left( \\frac{h^{3}}{3} + bh^{2} \\right) = \\frac{\\Delta p h^{2}}{\\mu R(t)} \\left( \\frac{h}{3} + b \\right)$$\n\n液膜半径 $R(t)$ 的演化由表示质量守恒的运动学关系控制：\n$$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\big(\\pi R^{2} h\\big) = 2\\pi R\\,q(R,t)$$\n由于厚度 $h$ 是常数，左边变为 $2\\pi R h \\frac{\\mathrm{d}R}{\\mathrm{d}t}$。方程简化为：\n$$h \\frac{\\mathrm{d}R}{\\mathrm{d}t} = q(R,t)$$\n代入我们关于 $q(R,t)$ 的表达式：\n$$h \\frac{\\mathrm{d}R}{\\mathrm{d}t} = \\frac{\\Delta p h^{2}}{\\mu R(t)} \\left( \\frac{h}{3} + b \\right)$$\n两边除以 $h$（假设 $h \\neq 0$），我们得到一个关于 $R(t)$ 的一阶常微分方程：\n$$\\frac{\\mathrm{d}R}{\\mathrm{d}t} = \\frac{\\Delta p h}{\\mu R(t)} \\left( \\frac{h}{3} + b \\right)$$\n这是一个可分离变量的方程。我们重新整理它，将包含 $R$ 的项归类：\n$$R \\frac{\\mathrm{d}R}{\\mathrm{d}t} = \\frac{\\Delta p h}{\\mu} \\left( \\frac{h}{3} + b \\right)$$\n等式右边相对于时间 $t$ 是一个常数。我们对两边从 $t=0$ 积分到任意时间 $t$：\n$$\\int_{R(0)}^{R(t)} R'\\,\\mathrm{d}R' = \\int_{0}^{t} \\frac{\\Delta p h}{\\mu} \\left( \\frac{h}{3} + b \\right) \\mathrm{d}t'$$\n$$\\left[ \\frac{(R')^{2}}{2} \\right]_{R(0)}^{R(t)} = \\frac{\\Delta p h}{\\mu} \\left( \\frac{h}{3} + b \\right) [t']_{0}^{t}$$\n$$\\frac{R(t)^{2}}{2} - \\frac{R(0)^{2}}{2} = \\frac{\\Delta p h}{\\mu} \\left( \\frac{h}{3} + b \\right) t$$\n问题没有指定半径的初始条件。对于液滴撞击和铺展，自然的初始条件是 $R(0)=0$。应用此条件，我们得到：\n$$\\frac{R(t)^{2}}{2} = \\frac{\\Delta p h}{\\mu} \\left( \\frac{h}{3} + b \\right) t$$\n解出 $R(t)$：\n$$R(t)^{2} = \\frac{2\\Delta p h t}{\\mu} \\left( \\frac{h}{3} + b \\right) = \\frac{2\\Delta p h (h + 3b) t}{3\\mu}$$\n取平方根得到铺展半径的最终表达式：\n$$R(t) = \\sqrt{\\frac{2\\Delta p h (h + 3b) t}{3\\mu}}$$\n只要所有输入参数（$\\Delta p$、$h$、$b$、$t$、$\\mu$）都采用国际单位制基本单位，该表达式给出的 $R(t)$ 单位为米。",
            "answer": "$$\\boxed{\\sqrt{\\frac{2 \\Delta p h (h + 3b) t}{3 \\mu}}}$$"
        },
        {
            "introduction": "在现代工程学中，将物理理论与计算模拟相结合是一项关键技能。本练习将让您亲手实践，通过实现“鬼流体法”（GFM）来模拟由表面张力引起的流体界面处的压力不连续性。通过将您的代码与已知的解析解进行验证，您将深入了解先进多相流求解器中使用的核心技术。",
            "id": "4022595",
            "problem": "实现一个二维幽灵流体法 (GFM)，以施加由表面张力引起的跨材料界面的压力跳跃，并使用静态液滴测试验证其准确性。考虑一个边长为 $L$ 米的方形计算域，在 $N \\times N$ 个节点的笛卡尔网格上进行离散化，均匀间距为 $\\Delta x = \\Delta y = L/(N-1)$。一个半径为 $R$（单位：米）的圆形液滴以 $\\left(x_c, y_c\\right)=\\left(L/2,L/2\\right)$ 为中心。设 $\\phi(x,y)$ 为符号距离水平集函数，$\\phi(x,y) = \\sqrt{(x-x_c)^2+(y-y_c)^2} - R$，其中液滴内部 $\\phi \\lt 0$，外部 $\\phi \\gt 0$。\n\n假设各相处于静态平衡，因此压力场 $p(x,y)$ 是分段调和的：在两个区域中均有 $\\nabla^2 p = 0$，在界面处存在由杨-拉普拉斯 (Young–Laplace) 条件 $\\Delta p = \\gamma \\kappa$ 给出的跳跃，其中 $\\gamma$ 是表面张力（单位：$\\mathrm{N/m}$），$\\kappa$ 是曲率（单位：$\\mathrm{m^{-1}}$）。对于代表圆柱形液滴平面横截面的二维圆形界面，其曲率为 $\\kappa = 1/R$。在域边界上施加齐次狄利克雷 (Dirichlet) 边界条件 $p=0$ 以表示参考环境压力。使用五点有限差分模板计算离散拉普拉斯算子，并实现幽灵流体法以在被界面切割的网格边上强制施加跳跃条件。\n\n幽灵流体法指令：对于网格节点 $(i,j)$，将离散拉普拉斯方程写为 $4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = b_{i,j}$。对于 $(i,j)$ 的每个邻居 $(i',j')$，如果 $\\phi_{i,j}\\cdot\\phi_{i',j'} \\lt 0$（即界面穿过该边），则向右端项添加一个跳跃贡献：\n- 如果 $\\phi_{i,j} \\lt 0$ 且 $\\phi_{i',j'} \\gt 0$，则 $b_{i,j} \\leftarrow b_{i,j} + \\Delta p$。\n- 如果 $\\phi_{i,j} \\gt 0$ 且 $\\phi_{i',j'} \\lt 0$，则 $b_{i,j} \\leftarrow b_{i,j} - \\Delta p$。\n此处 $\\Delta p = \\gamma \\kappa$，且 $\\kappa = 1/R$。在域边界节点上强行施加 $p=0$。\n\n验证指标：对于每个测试用例，按如下方式计算远离界面的无穷范数误差。定义内部掩码 $\\mathcal{M}^{-} = \\{(i,j): \\phi_{i,j} \\lt -\\tau\\}$ 和外部掩码 $\\mathcal{M}^{+} = \\{(i,j): \\phi_{i,j} \\gt \\tau\\}$，缓冲距离为 $\\tau = 1.5 \\Delta x$。设 $p_{\\text{th}}^{-} = \\Delta p$ 和 $p_{\\text{th}}^{+} = 0$。计算 $E^{-}_{\\infty} = \\max_{(i,j)\\in \\mathcal{M}^{-}} \\left| p_{i,j} - p_{\\text{th}}^{-} \\right|$ 和 $E^{+}_{\\infty} = \\max_{(i,j)\\in \\mathcal{M}^{+}} \\left| p_{i,j} - p_{\\text{th}}^{+} \\right|$。报告 $E_{\\infty} = \\max(E^{-}_{\\infty}, E^{+}_{\\infty})$。\n\n物理单位要求：将所有误差 $E_{\\infty}$ 以帕斯卡 (Pa) 为单位表示为浮点数。\n\n测试套件：使用以下参数集来检验该方法：\n1. $L=0.01$ m, $N=64$, $R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$。\n2. $L=0.01$ m, $N=32$ (粗网格), $R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$。\n3. $L=0.01$ m, $N=128$ (细网格), $R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$。\n4. $L=0.01$ m, $N=128$, $R=0.0005$ m (小液滴), $\\gamma=0.072$ $\\mathrm{N/m}$。\n5. $L=0.01$ m, $N=128$, $R=0.0015$ m, $\\gamma=0.050$ $\\mathrm{N/m}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有五个测试用例的误差，格式为用方括号括起来的逗号分隔列表（例如：\"[e1,e2,e3,e4,e5]\"），其中每个 $e_k$ 是一个以帕斯卡 (Pa) 为单位的浮点数。",
            "solution": "用户提供了一个有效、适定且具有科学依据的问题陈述。该问题要求实现并验证一个用于静态液滴测试用例的二维幽灵流体法（GFM）。问题的核心是求解一个在圆形界面处存在急剧跳跃的分段调和压力场，该跳跃由杨-拉普拉斯方程控制。\n\n问题在于求解一个边长为 $L$ 的方形域内的压力场 $p(x,y)$。该域包含一个不同流体的圆形液滴，中心位于 $(L/2, L/2)$，半径为 $R$。两种流体之间的界面由符号距离函数的零等值线表示，即 $\\phi(x,y) = \\sqrt{(x-L/2)^2 + (y-L/2)^2} - R$，其中液滴内部 $\\phi \\lt 0$，外部 $\\phi \\gt 0$。在静态平衡且忽略体积力的情况下，每种流体中的压力是恒定的，这满足了调和条件 $\\nabla^2 p = 0$。在界面处，存在一个由杨-拉普拉斯方程决定的压力跳跃，$\\Delta p = p_{\\text{inside}} - p_{\\text{outside}} = \\gamma \\kappa$。这里，$\\gamma$ 是表面张力，$\\kappa$ 是界面曲率。对于二维圆形横截面，曲率为 $\\kappa = 1/R$。域边界上的压力被固定在参考值 $p=0$。因此，理论解是一个分段常数压力场：当 $\\phi  0$ 时，$p(x,y) = \\Delta p$；当 $\\phi > 0$ 时，$p(x,y) = 0$。\n\n该问题在一个均匀的 $N \\times N$ 笛卡尔网格上进行离散化，网格间距为 $\\Delta x = \\Delta y = L/(N-1)$。拉普拉斯算子使用标准的五点有限差分模板进行近似：\n$$\n\\nabla^2 p \\approx \\frac{p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4 p_{i,j}}{\\Delta x^2}\n$$\n问题指定将此模板重排为每个网格节点 $(i,j)$ 的线性方程形式：\n$$\n4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = b_{i,j}\n$$\n这等价于设置 $-\\Delta x^2 (\\nabla^2_h p)_{i,j} = b_{i,j}$，其中 $\\nabla^2_h$ 是离散拉普拉斯算子。对于远离界面的节点，控制方程为 $\\nabla^2 p = 0$，因此右端项 $b_{i,j}$ 为 $0$。压力跳跃条件通过为邻近界面的节点定义非零的 $b_{i,j}$ 值来强制执行，这是该特定幽灵流体法的精髓。\n\nGFM 通过向其模板跨越界面的节点的离散方程的右端项添加源项来模拟压力不连续性。指令指出，对于节点 $(i,j)$ 及其邻居 $(i',j')$，如果界面位于它们之间（即 $\\phi_{i,j} \\cdot \\phi_{i',j'}  0$），则向 $b_{i,j}$ 添加一个贡献。\n让我们分析这个指令。考虑一个位于液相中的节点 $(i,j)$（$\\phi_{i,j}  0$）及其位于气相中的邻居 $(i+1,j)$（$\\phi_{i+1,j} > 0$）。一个严格的 GFM 会通过从气相压力外插来定义 $(i+1,j)$ 位置的幽灵压力。一阶 GFM 将此幽灵压力定义为 $p_{i+1,j}^{\\text{ghost}} = p_{i+1,j} + \\Delta p$，其中 $p_{i+1,j}$ 是邻近节点的真实压力。将此代入节点 $(i,j)$ 的模板中：\n$$\n4 p_{i,j} - p_{i+1,j}^{\\text{ghost}} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = 0\n$$\n$$\n4 p_{i,j} - (p_{i+1,j} + \\Delta p) - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = 0\n$$\n将其重排以匹配问题指定的形式，得到：\n$$\n4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = \\Delta p\n$$\n这意味着对于节点 $(i,j)$，右端项 $b_{i,j}$ 应获得一个 $+\\Delta p$ 的贡献。这与指令相符：如果 $\\phi_{i,j}  0$ 且 $\\phi_{i',j'} > 0$，则 $b_{i,j}$ 增加 $\\Delta p$。\n反之，对于气相节点 $(i+1,j)$，跳跃为 $p_{\\text{inside}} - p_{\\text{outside}} = \\Delta p$，这意味着 $p_{\\text{outside}} - p_{\\text{inside}} = -\\Delta p$。节点 $(i,j)$ 位置的幽灵压力为 $p_{i,j}^{\\text{ghost}} = p_{i,j} - \\Delta p$。在 $(i+1,j)$ 处的模板变为：\n$$\n4 p_{i+1,j} - p_{i+2,j} - p_{i,j}^{\\text{ghost}} - p_{i+1,j+1} - p_{i+1,j-1} = 0\n$$\n$$\n4 p_{i+1,j} - p_{i+2,j} - (p_{i,j} - \\Delta p) - p_{i+1,j+1} - p_{i+1,j-1} = 0\n$$\n这对节点 $(i+1,j)$ 产生一个 $-\\Delta p$ 的右端项贡献，这也与指令相符。任何节点的总右端项值 $b_{i,j}$ 是其所有跨界面邻居贡献的总和。\n\n所有 $N \\times N$ 个节点的完整离散方程组构成一个形如 $A \\mathbf{p} = \\mathbf{b}$ 的大型稀疏线性系统。向量 $\\mathbf{p}$ 包含从二维网格展平的未知压力值。矩阵 $A$ 是系数矩阵。对于内部节点 $(i,j)$，$A$ 的第 $k=iN+j$ 行包含五点模板的系数：对角线上为 $4$，其四个邻居对应位置为 $-1$。对于边界节点，通过将 $A$ 的相应行设置为单位行（即 $A_{k,k}=1$，$l \\ne k$ 时 $A_{k,l}=0$）并将 $b_k=0$ 来强行施加狄利克雷条件 $p=0$。向量 $\\mathbf{b}$ 包含 GFM 源项，这些源项仅在邻近界面的节点上非零。\n\n求解此稀疏线性系统以获得数值压力场 $p_{i,j}$。为验证准确性，将数值解与已知的理论解（$p_{\\text{th}}^{-} = \\Delta p$，$p_{\\text{th}}^{+} = 0$）进行比较。误差使用无穷范数进行量化，该范数在由缓冲距离 $\\tau = 1.5 \\Delta x$ 定义的远离界面的区域内计算。内部误差 $E^{-}_{\\infty} = \\max |p_{i,j} - p_{\\text{th}}^{-}|$ 是对所有满足 $\\phi_{i,j}  -\\tau$ 的节点计算的，而外部误差 $E^{+}_{\\infty} = \\max |p_{i,j} - p_{\\text{th}}^{+}|$ 是对所有满足 $\\phi_{i,j} > \\tau$ 的节点计算的。最终报告的误差为 $E_{\\infty} = \\max(E^{-}_{\\infty}, E^{+}_{\\infty})$。\n\n该算法使用 Python 实现。网格和场数据存储在 `numpy` 数组中。大型稀疏矩阵 $A$ 使用 `scipy.sparse.lil_matrix` 构建，线性系统则使用 `scipy.sparse.linalg.spsolve` 高效求解。对所提供的五个测试用例中的每一个都执行此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (L, N, R, gamma)\n        (0.01, 64, 0.002, 0.072),\n        (0.01, 32, 0.002, 0.072),\n        (0.01, 128, 0.002, 0.072),\n        (0.01, 128, 0.0005, 0.072),\n        (0.01, 128, 0.0015, 0.050),\n    ]\n\n    results = []\n    for L, N, R, gamma in test_cases:\n        error = solve_one_case(L, N, R, gamma)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_one_case(L, N, R, gamma):\n    \"\"\"\n    Implements the Ghost Fluid Method for a single static droplet test case.\n\n    Args:\n        L (float): Domain side length in meters.\n        N (int): Number of grid nodes in each dimension.\n        R (float): Droplet radius in meters.\n        gamma (float): Surface tension in N/m.\n\n    Returns:\n        float: The infinity-norm error E_inf in Pascals.\n    \"\"\"\n    # 1. Grid and Level-Set Setup\n    dx = L / (N - 1)\n    x = np.linspace(0, L, N)\n    y = np.linspace(0, L, N)\n    xx, yy = np.meshgrid(x, y)\n    \n    xc, yc = L / 2.0, L / 2.0\n    phi = np.sqrt((xx - xc)**2 + (yy - yc)**2) - R\n    \n    # 2. System Assembly (A p = b)\n    n_nodes = N * N\n    A = lil_matrix((n_nodes, n_nodes), dtype=np.float64)\n    b = np.zeros(n_nodes, dtype=np.float64)\n    \n    # Pressure jump and theoretical pressures\n    delta_p = gamma / R\n\n    # Iterate over all grid points to build matrix A and vector b\n    for i in range(N):\n        for j in range(N):\n            k = i * N + j  # Flattened 1D index\n\n            # Strong enforcement of Dirichlet boundary conditions p=0\n            if i == 0 or i == N - 1 or j == 0 or j == N - 1:\n                A[k, k] = 1.0\n                b[k] = 0.0\n                continue\n\n            # Internal nodes: 5-point stencil for the Laplacian\n            A[k, k] = 4.0\n            A[k, k + 1] = -1.0  # Neighbor (i, j+1)\n            A[k, k - 1] = -1.0  # Neighbor (i, j-1)\n            A[k, k + N] = -1.0  # Neighbor (i+1, j)\n            A[k, k - N] = -1.0  # Neighbor (i-1, j)\n\n            # GFM: Add source terms to RHS for nodes adjacent to the interface\n            # Check right neighbor (i, j+1)\n            if phi[i, j] * phi[i, j + 1]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n            \n            # Check left neighbor (i, j-1)\n            if phi[i, j] * phi[i, j - 1]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n            \n            # Check top neighbor (i+1, j)\n            if phi[i, j] * phi[i + 1, j]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n\n            # Check bottom neighbor (i-1, j)\n            if phi[i, j] * phi[i - 1, j]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n    \n    # 3. Solve the Linear System\n    # Convert matrix to a more efficient format for solving\n    A_csc = A.tocsc()\n    p_flat = spsolve(A_csc, b)\n    p_sol = p_flat.reshape((N, N))\n\n    # 4. Error Verification\n    tau = 1.5 * dx\n    p_th_minus = delta_p\n    p_th_plus = 0.0\n\n    mask_inside = phi  -tau\n    mask_outside = phi > tau\n\n    p_values_inside = p_sol[mask_inside]\n    p_values_outside = p_sol[mask_outside]\n\n    err_inside = 0.0\n    if p_values_inside.size > 0:\n        err_inside = np.max(np.abs(p_values_inside - p_th_minus))\n\n    err_outside = 0.0\n    if p_values_outside.size > 0:\n        err_outside = np.max(np.abs(p_values_outside - p_th_plus))\n        \n    E_inf = max(err_inside, err_outside)\n    \n    return E_inf\n\nsolve()\n\n```"
        }
    ]
}