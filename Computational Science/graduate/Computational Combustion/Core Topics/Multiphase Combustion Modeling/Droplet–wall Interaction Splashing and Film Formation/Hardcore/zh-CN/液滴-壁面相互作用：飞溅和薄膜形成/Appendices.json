{
    "hands_on_practices": [
        {
            "introduction": "无量纲分析是流体力学研究的基石，它使我们能够将复杂的现象提炼为几个关键参数。本练习将引导你从纳维-斯托克斯方程出发，推导出控制液滴撞击过程的基本无量纲数（雷诺数$Re$、韦伯数$We$、奥内佐格数$Oh$和毛细数$Ca$）。通过将这些理论参数应用于一个经验关联式，你将能够预测液滴撞击的宏观结果（例如飞溅或沉积），从而将基础理论与工程应用联系起来。",
            "id": "4022603",
            "problem": "一个直径为 $D$ 的单组分牛顿流体碳氢燃料液滴，以速度 $U$ 垂直撞击一个光滑、干燥、等温的固体壁面。该流体的密度为 $\\rho$，动力粘度为 $\\mu$，表面张力为 $\\gamma$。在短暂的撞击时间内，蒸发、相变和气相效应可以忽略不计；在惯性撞击时间尺度上，重力也可以忽略不计。从不可压缩的纳维-斯托克斯方程（以及液-气界面上的毛细作用）出发：\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t}+\\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)=-\\nabla p+\\mu \\nabla^{2}\\boldsymbol{u},\\quad \\nabla\\cdot \\boldsymbol{u}=0,\n$$\n以及界面上的毛细法向应力跳跃条件 $\\Delta p=\\gamma \\kappa$，使用特征尺度：长度 $D$、速度 $U$、时间 $D/U$、压力 $\\rho U^{2}$，对这些方程进行无量纲化。根据 $(\\rho,\\mu,\\gamma,U,D)$，确定在此情况下控制液滴撞击和界面动力学的四个经典无量纲数：雷诺数、韦伯数、奥内佐格数和毛细数。解释它们如何从无量纲化的方程和界面条件中导出。\n\n然后，对于一个液滴，其参数为 $D=100\\,\\mu\\mathrm{m}$，$U=10\\,\\mathrm{m/s}$，$\\rho=800\\,\\mathrm{kg/m^3}$，$\\mu=2\\,\\mathrm{mPa\\,s}$，$\\gamma=0.025\\,\\mathrm{N/m}$，计算这四个无量纲数的数值。使用一个广泛报道的、用于光滑干燥表面上垂直撞击的飞溅阈值关联式 $K=We^{1/2}Re^{1/4}$，其临界值为 $K_{\\mathrm{crit}}=57.7$，通过定义一个结果指标 $S$ 来将可能的结果分类为飞溅或沉积，如果 $KK_{\\mathrm{crit}}$（可能发生飞溅），则 $S$ 等于 $1$，否则（可能发生沉积）$S$ 等于 $0$。\n\n将你的最终答案以单行矩阵 $\\begin{pmatrix}Re  We  Oh  Ca  S\\end{pmatrix}$ 的形式报告。将 $Re$、$We$、$Oh$ 和 $Ca$ 的值四舍五入到四位有效数字。将 $S$ 报告为整数 $0$ 或 $1$。所有报告的量均为无量纲。",
            "solution": "首先验证该问题是科学合理的、适定的、客观的和完整的。所有必要的数据、方程和条件都已提供，并且它们符合流体动力学的既定原理。对于碳氢燃料液滴，这些数值在物理上是现实的。该问题是量纲分析及其在实际工程关联式中应用的典型练习。\n\n第一步是无量纲化控制方程和界面条件，以确定经典的无量纲数。所提供的特征尺度为长度 $D$、速度 $U$、时间 $D/U$ 和压力 $\\rho U^2$。我们定义以下无量纲变量，用上标星号表示：\n$$\n\\boldsymbol{x}^* = \\frac{\\boldsymbol{x}}{D}, \\quad \\boldsymbol{u}^* = \\frac{\\boldsymbol{u}}{U}, \\quad t^* = \\frac{t}{D/U}, \\quad p^* = \\frac{p}{\\rho U^2}\n$$\n以无量纲坐标表示的微分算子为：\n$$\n\\frac{\\partial}{\\partial t} = \\frac{U}{D}\\frac{\\partial}{\\partial t^*}, \\quad \\nabla = \\frac{1}{D}\\nabla^*, \\quad \\nabla^2 = \\frac{1}{D^2}\\nabla^{*2}\n$$\n我们将这些代入不可压缩的纳维-斯托克斯动量方程：\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t}+\\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right)=-\\nabla p+\\mu \\nabla^{2}\\boldsymbol{u}\n$$\n代入经过缩放的变量和算子可得：\n$$\n\\rho\\left(\\frac{U}{D}\\frac{\\partial (U\\boldsymbol{u}^*)}{\\partial t^*} + (U\\boldsymbol{u}^*)\\cdot\\left(\\frac{1}{D}\\nabla^*\\right)(U\\boldsymbol{u}^*)\\right) = -\\left(\\frac{1}{D}\\nabla^*\\right)(\\rho U^2 p^*) + \\mu \\left(\\frac{1}{D^2}\\nabla^{*2}\\right)(U\\boldsymbol{u}^*)\n$$\n将有量纲的系数提出：\n$$\n\\frac{\\rho U^2}{D}\\left(\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^*\\right) = -\\frac{\\rho U^2}{D}\\nabla^* p^* + \\frac{\\mu U}{D^2}\\nabla^{*2} \\boldsymbol{u}^*\n$$\n为了使方程无量纲化，我们将所有项除以惯性项的系数 $\\rho U^2/D$：\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^* = -\\nabla^* p^* + \\left(\\frac{\\mu U/D^2}{\\rho U^2/D}\\right)\\nabla^{*2} \\boldsymbol{u}^*\n$$\n作为粘性项系数出现的无量纲数组可以简化为：\n$$\n\\frac{\\mu U D}{\\rho U^2 D^2} = \\frac{\\mu}{\\rho U D}\n$$\n这个数组是**雷诺数** $Re$ 的倒数。因此，$Re = \\frac{\\rho U D}{\\mu}$。无量纲动量方程为：\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\boldsymbol{u}^*\\cdot\\nabla^* \\boldsymbol{u}^* = -\\nabla^* p^* + \\frac{1}{Re}\\nabla^{*2} \\boldsymbol{u}^*\n$$\n雷诺数 $Re$ 源于动量方程中惯性力与粘性力之比。\n\n接下来，我们对液-气界面处的毛细法向应力跳跃条件 $\\Delta p=\\gamma \\kappa$ 进行无量纲化。曲率 $\\kappa$ 的单位是长度的倒数，所以其无量纲形式为 $\\kappa^* = \\kappa D$。\n$$\n\\Delta p = \\gamma \\kappa \\implies \\Delta(p^* \\rho U^2) = \\gamma \\frac{\\kappa^*}{D}\n$$\n$$\n(\\rho U^2) \\Delta p^* = \\frac{\\gamma}{D}\\kappa^*\n$$\n整理得到无量纲压力跳跃 $\\Delta p^*$：\n$$\n\\Delta p^* = \\left(\\frac{\\gamma}{\\rho U^2 D}\\right) \\kappa^*\n$$\n这个无量纲数组是**韦伯数** $We$ 的倒数。因此，$We = \\frac{\\rho U^2 D}{\\gamma}$。无量纲界面条件为 $\\Delta p^* = \\frac{1}{We}\\kappa^*$。韦伯数 $We$ 源于惯性力（或动压）与表面张力之比。\n\n**奥内佐格数** $Oh$ 和**毛细数** $Ca$ 由 $Re$ 和 $We$ 导出。奥内佐格数的构造与速度 $U$ 无关，因此仅表征流体和长度尺度的特性。其定义为：\n$$\nOh = \\frac{\\sqrt{We}}{Re} = \\frac{\\sqrt{\\rho U^2 D/\\gamma}}{\\rho U D/\\mu} = \\frac{U\\sqrt{\\rho D/\\gamma}}{U(\\rho D/\\mu)} = \\frac{\\mu}{\\sqrt{\\rho \\gamma D}}\n$$\n奥内佐格数关联了粘性力与惯性力和表面张力的几何平均值。\n\n毛细数关联了粘性力与表面张力，其定义为：\n$$\nCa = \\frac{We}{Re} = \\frac{\\rho U^2 D/\\gamma}{\\rho U D/\\mu} = \\frac{\\mu U}{\\gamma}\n$$\n\n现在，我们计算一个液滴的这四个无量纲数的数值，其参数为 $D=100\\,\\mu\\mathrm{m} = 1 \\times 10^{-4}\\,\\mathrm{m}$，$U=10\\,\\mathrm{m/s}$，$\\rho=800\\,\\mathrm{kg/m^3}$，$\\mu=2\\,\\mathrm{mPa\\,s} = 2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$，以及 $\\gamma=0.025\\,\\mathrm{N/m}$。\n\n雷诺数为：\n$$\nRe = \\frac{\\rho U D}{\\mu} = \\frac{(800\\,\\mathrm{kg/m^3}) (10\\,\\mathrm{m/s}) (1 \\times 10^{-4}\\,\\mathrm{m})}{2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}} = \\frac{0.8}{0.002} = 400\n$$\n四舍五入到四位有效数字，$Re = 400.0$。\n\n韦伯数为：\n$$\nWe = \\frac{\\rho U^2 D}{\\gamma} = \\frac{(800\\,\\mathrm{kg/m^3}) (10\\,\\mathrm{m/s})^2 (1 \\times 10^{-4}\\,\\mathrm{m})}{0.025\\,\\mathrm{N/m}} = \\frac{800 \\times 100 \\times 10^{-4}}{0.025} = \\frac{8}{0.025} = 320\n$$\n四舍五入到四位有效数字，$We = 320.0$。\n\n奥内佐格数为：\n$$\nOh = \\frac{\\mu}{\\sqrt{\\rho \\gamma D}} = \\frac{2 \\times 10^{-3}}{\\sqrt{(800)(0.025)(1 \\times 10^{-4})}} = \\frac{2 \\times 10^{-3}}{\\sqrt{0.002}} = \\frac{2 \\times 10^{-3}}{0.0447213...} \\approx 0.0447213...\n$$\n四舍五入到四位有效数字，$Oh = 0.04472$。\n\n毛细数为：\n$$\nCa = \\frac{\\mu U}{\\gamma} = \\frac{(2 \\times 10^{-3}\\,\\mathrm{Pa\\,s}) (10\\,\\mathrm{m/s})}{0.025\\,\\mathrm{N/m}} = \\frac{0.02}{0.025} = 0.8\n$$\n四舍五入到四位有效数字，$Ca = 0.8000$。\n\n最后，我们使用飞溅关联式 $K=We^{1/2}Re^{1/4}$ 和临界值 $K_{\\mathrm{crit}}=57.7$ 来对撞击结果进行分类。结果指标 $S$ 在发生飞溅时（$K > K_{\\mathrm{crit}}$）等于 $1$，在发生沉积时（$K \\le K_{\\mathrm{crit}}$）等于 $0$。\n我们计算飞溅参数 $K$：\n$$\nK = We^{1/2}Re^{1/4} = (320)^{1/2}(400)^{1/4}\n$$\n我们可以将其写为 $K = (\\sqrt{320})(\\sqrt[4]{400}) = (\\sqrt{64 \\times 5})(\\sqrt[4]{4 \\times 100}) = (8\\sqrt{5})(\\sqrt{2}\\sqrt{10}) = (8\\sqrt{5})(\\sqrt{2}\\sqrt{2}\\sqrt{5}) = (8\\sqrt{5})(2\\sqrt{5}) = 16 \\times 5 = 80$。\n计算值为 $K=80$。我们将其与临界值进行比较：\n$$\nK = 80 > K_{\\mathrm{crit}} = 57.7\n$$\n由于 $K$ 大于 $K_{\\mathrm{crit}}$，可能的结果是飞溅。因此，结果指标为 $S=1$。\n\n最终结果为 $Re = 400.0$、$We = 320.0$、$Oh = 0.04472$、$Ca = 0.8000$ 和 $S=1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 400.0  320.0  0.04472  0.8000  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了控制液滴撞击的宏观参数后，我们将深入探讨一个更高级的物理效应，它在许多实际应用中至关重要。在发动机燃烧等场景中，壁面通常是加热的，这会在铺展的液膜上产生温度梯度和相应的表面张力梯度（即热毛细或Marangoni效应）。本练习将运用标度分析方法，推导出一个能够量化此效应对铺展动力学影响的无量纲数，从而让你对热壁相互作用的物理机制有更深刻的理解。",
            "id": "4022588",
            "problem": "一滴单组分碳氢燃料液滴在静止气体中撞击一个加热的光滑壁面。撞击后，立即形成一个轴对称的液膜并径向铺展。由于液膜表面的温度变化，表面张力随之改变，从而驱动了改变铺展动力学的热毛细（Marangoni）应力。从第一性原理出发，构建一个无量纲数，用于量化液膜中热毛细驱动的铺展相对于粘性阻力和热扩散的强度，然后根据以下条件计算其值。\n\n假设液膜厚度均匀，且界面温度从靠近壁面的高温区域到液膜边缘近似线性下降。利用界面切向应力平衡和液膜内的对流-扩散平衡来构建你的无量纲量。热扩散系数定义为 $\\alpha = k/(\\rho c_{p})$。\n\n在代表性液膜温度下评估的燃料性质如下：\n- 动力粘度: $\\mu = 7.5 \\times 10^{-4}\\ \\mathrm{Pa\\cdot s}$。\n- 热导率: $k = 0.14\\ \\mathrm{W/(m\\cdot K)}$。\n- 密度: $\\rho = 680\\ \\mathrm{kg/m^{3}}$。\n- 定压比热: $c_{p} = 2.20 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)}$。\n- 表面张力温度系数: $\\partial \\sigma / \\partial T = -1.20 \\times 10^{-4}\\ \\mathrm{N/(m\\cdot K)}$。\n\n撞击后一小段时间的液膜几何形状和热学数据：\n- 液膜厚度: $h = 5.0 \\times 10^{-5}\\ \\mathrm{m}$。\n- 液膜上的界面温降: $\\Delta T = 20\\ \\mathrm{K}$。\n\n最终答案以无量纲数表示，并四舍五入到三位有效数字。最终数值答案中请勿包含单位。",
            "solution": "问题要求构建并评估一个无量纲数，该数用于量化热毛细驱动的铺展相对于粘性阻力和热扩散的强度。推导将基于第一性原理，特别是界面切向应力平衡和液膜内的热量对流-扩散平衡。\n\n首先，我们建立界面切向应力平衡。铺展的驱动力是热毛细或Marangoni应力 $\\tau_M$，它源于沿液膜表面的表面张力 $\\sigma$ 的梯度。该应力与液体内部的粘性剪切阻力 $\\tau_v$ 相平衡。平衡关系表示为 $\\tau_M \\approx \\tau_v$。\n\nMarangoni应力是表面张力的梯度，$\\tau_M = \\frac{\\partial \\sigma}{\\partial r}$。由于表面张力 $\\sigma$ 是温度 $T$ 的函数，我们可以使用链式法则：$\\frac{\\partial \\sigma}{\\partial r} = \\frac{\\partial \\sigma}{\\partial T} \\frac{\\partial T}{\\partial r}$。我们已知液膜上的温降为 $\\Delta T$。设液膜的特征径向长度为 $L$。温度梯度可以标度为 $\\frac{\\partial T}{\\partial r} \\sim \\frac{\\Delta T}{L}$。设 $\\sigma_T = |\\frac{\\partial \\sigma}{\\partial T}|$ 为表面张力温度系数的量值。那么Marangoni应力的标度为：\n$$\n\\tau_M \\sim \\sigma_T \\frac{\\Delta T}{L}\n$$\n\n液体中的粘性剪切应力由 $\\tau_v = \\mu \\frac{\\partial u_r}{\\partial z}$ 给出，其中 $\\mu$ 是动力粘度，$u_r$ 是径向速度，$z$ 是垂直于壁面的坐标。假设壁面处为无滑移条件（在 $z=0$ 处 $u_r=0$），且自由表面（在 $z=h$ 处）的特征铺展速度为 $U$，则速度梯度可以标度为 $\\frac{\\partial u_r}{\\partial z} \\sim \\frac{U-0}{h} = \\frac{U}{h}$。因此，粘性应力为：\n$$\n\\tau_v \\sim \\mu \\frac{U}{h}\n$$\n\n令Marangoni应力与粘性应力相等，我们得到特征铺展速度 $U$ 的关系式：\n$$\n\\sigma_T \\frac{\\Delta T}{L} \\sim \\mu \\frac{U}{h} \\implies U \\sim \\frac{\\sigma_T \\Delta T h}{\\mu L}\n$$\n\n接下来，我们按照要求考虑液膜中热量输运的对流-扩散平衡。温度场是由流体径向向外对流的热量与从热壁面垂直扩散到流体中的热量之间的平衡所建立的。能量方程为 $\\rho c_p (\\mathbf{u} \\cdot \\nabla T) = \\nabla \\cdot (k \\nabla T)$，其中 $\\rho$ 是密度，$c_p$ 是比热，$k$ 是热导率。\n\n径向对流项的标度为 $\\rho c_p u_r \\frac{\\partial T}{\\partial r} \\sim \\rho c_p U \\frac{\\Delta T}{L}$。\n主要的扩散项发生在温度梯度最陡峭的方向，即垂直方向（垂直于壁面），因为热量从壁面进入薄液膜。该项的标度为 $k \\frac{\\partial^2 T}{\\partial z^2} \\sim k \\frac{\\Delta T}{h^2}$。\n平衡这两项可得：\n$$\n\\rho c_p U \\frac{\\Delta T}{L} \\sim k \\frac{\\Delta T}{h^2}\n$$\n通过使用热扩散系数的定义 $\\alpha = k/(\\rho c_p)$，上式可简化为：\n$$\n\\frac{U}{L} \\sim \\frac{\\alpha}{h^2}\n$$\n这个关系式将流动的运动学特性（$U, L$）与流体的热学特性（$\\alpha$）和几何形状（$h$）联系起来。它表明，长度 $L$ 上的对流特征时间 $L/U$，与热量扩散通过厚度 $h$ 的时间 $h^2/\\alpha$ 处于同一数量级。\n\n现在我们得到了一个包含未知标度 $U$ 和 $L$ 的两个标度关系式的系统：\n1. $U \\sim \\frac{\\sigma_T \\Delta T h}{\\mu L}$\n2. $L \\sim \\frac{U h^2}{\\alpha}$\n\n为了仅使用给定参数构建一个无量纲数，我们消去 $U$ 和 $L$。将 (2) 式中 $L$ 的表达式代入 (1) 式：\n$$\nU \\sim \\frac{\\sigma_T \\Delta T h}{\\mu \\left( \\frac{U h^2}{\\alpha} \\right)} = \\frac{\\sigma_T \\Delta T \\alpha}{\\mu U h}\n$$\n对 $U^2$ 进行整理，得到Marangoni驱动速度平方的标度：\n$$\nU^2 \\sim \\frac{\\sigma_T \\Delta T \\alpha}{\\mu h}\n$$\n该表达式结合了热毛细驱动力（$\\sigma_T \\Delta T$）、粘性阻力（$\\mu$）和热扩散（$\\alpha$）。为使其成为无量纲数，我们可以用一个相关的速度标度的平方对其进行归一化。此问题中的一个自然速度标度是热量扩散通过膜厚 $h$ 的速度，定义为 $V_{th} = \\alpha/h$。\n所求的无量纲数，我们记为 $M_S$，是这些速度平方的比值：\n$$\nM_S = \\frac{U^2}{V_{th}^2} \\sim \\frac{\\left( \\frac{\\sigma_T \\Delta T \\alpha}{\\mu h} \\right)}{\\left( \\frac{\\alpha}{h} \\right)^2} = \\frac{\\sigma_T \\Delta T \\alpha}{\\mu h} \\frac{h^2}{\\alpha^2} = \\frac{\\sigma_T \\Delta T h}{\\mu \\alpha}\n$$\n这个无量纲数是表面Marangoni数的一种形式，它按照要求量化了热毛细对流相对于粘性耗散和热耗散的强度。\n\n现在，我们使用提供的数据计算该数值。\n首先，我们计算热扩散系数 $\\alpha$：\n$\\rho = 680\\ \\mathrm{kg/m^{3}}$\n$c_{p} = 2.20 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)}$\n$k = 0.14\\ \\mathrm{W/(m\\cdot K)}$\n$$\n\\alpha = \\frac{k}{\\rho c_p} = \\frac{0.14\\ \\mathrm{W/(m\\cdot K)}}{(680\\ \\mathrm{kg/m^{3}}) \\times (2.20 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)})} = \\frac{0.14}{1.496 \\times 10^6}\\ \\mathrm{m^2/s} \\approx 9.358289 \\times 10^{-8}\\ \\mathrm{m^2/s}\n$$\n接下来，我们将所有数值代入 $M_S$ 的表达式中。\n$\\sigma_T = |\\partial \\sigma / \\partial T| = |-1.20 \\times 10^{-4}| = 1.20 \\times 10^{-4}\\ \\mathrm{N/(m\\cdot K)}$\n$\\Delta T = 20\\ \\mathrm{K}$\n$h = 5.0 \\times 10^{-5}\\ \\mathrm{m}$\n$\\mu = 7.5 \\times 10^{-4}\\ \\mathrm{Pa\\cdot s}$\n$$\nM_S = \\frac{\\sigma_T \\Delta T h}{\\mu \\alpha} = \\frac{(1.20 \\times 10^{-4}\\ \\mathrm{N/(m\\cdot K)}) \\times (20\\ \\mathrm{K}) \\times (5.0 \\times 10^{-5}\\ \\mathrm{m})}{(7.5 \\times 10^{-4}\\ \\mathrm{Pa\\cdot s}) \\times (9.358289 \\times 10^{-8}\\ \\mathrm{m^2/s})}\n$$\n计算分子：\n$$\n\\text{Numerator} = (1.20 \\times 20 \\times 5.0) \\times 10^{-4} \\times 10^{-5} = 120 \\times 10^{-9} = 1.2 \\times 10^{-7}\\ \\mathrm{N}\n$$\n计算分母：\n$$\n\\text{Denominator} = (7.5 \\times 9.358289) \\times 10^{-4} \\times 10^{-8} = 70.18717 \\times 10^{-12} = 7.018717 \\times 10^{-11}\\ \\mathrm{N}\n$$\n单位 $\\mathrm{Pa \\cdot s \\cdot m^2/s} = \\mathrm{(N/m^2) \\cdot s \\cdot m^2/s} = \\mathrm{N}$，因此该数是无量纲的。\n最后，我们计算该比值：\n$$\nM_S = \\frac{1.2 \\times 10^{-7}}{7.018717 \\times 10^{-11}} \\approx 1709.725\n$$\n四舍五入到三位有效数字，该无量纲数的值为 $1710$，即 $1.71 \\times 10^3$。",
            "answer": "$$\n\\boxed{1.71 \\times 10^3}\n$$"
        },
        {
            "introduction": "本章的最后一个练习将引导你从解析模型过渡到计算实践。精确模拟多相流需要特殊的数值技术来处理界面上的不连续性，例如由表面张力引起的压力跳跃。本练习将为你提供一个实现鬼点法（Ghost Fluid Method, GFM）的编程实践，这是一种在模拟中施加杨-拉普拉斯压力跳跃条件的关键算法。通过将表面张力的理论概念转化为可工作的计算机代码，这个练习将巩固你对界面物理的理解，并为你进行高级计算流体动力学研究打下基础。",
            "id": "4022595",
            "problem": "实现一个二维鬼点法 (GFM) 来施加由表面张力引起的跨材料界面的压力跳跃，并使用静态液滴测试验证其准确性。考虑一个边长为 $L$ 米的正方形计算域，该域在具有均匀间距 $\\Delta x = \\Delta y = L/(N-1)$ 的 $N \\times N$ 节点的笛卡尔网格上进行离散化。一个半径为 $R$ 米的圆形液滴以 $\\left(x_c, y_c\\right)=\\left(L/2,L/2\\right)$ 为中心。令 $\\phi(x,y)$ 为符号距离水平集函数，$\\phi(x,y) = \\sqrt{(x-x_c)^2+(y-y_c)^2} - R$，其中液滴内部 $\\phi \\lt 0$，外部 $\\phi \\gt 0$。\n\n假设每个相都处于静态平衡状态，因此压力场 $p(x,y)$ 是分段调和的：在两个区域中均为 $\\nabla^2 p = 0$，界面处的跳跃由 Young–Laplace 条件 $\\Delta p = \\gamma \\kappa$ 给出，其中 $\\gamma$ 是表面张力（单位为 $\\mathrm{N/m}$），$\\kappa$ 是曲率（单位为 $\\mathrm{m^{-1}}$）。对于代表圆柱形液滴平面横截面的二维圆形界面，曲率为 $\\kappa = 1/R$。在区域边界上施加齐次 Dirichlet 边界条件 $p=0$，以表示参考环境压力。使用五点有限差分模板来计算离散拉普拉斯算子，并实现鬼点法以在被界面切割的网格边上强制执行跳跃条件。\n\n鬼点法指令：对于网格节点 $(i,j)$，将离散拉普拉斯方程写为 $4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = b_{i,j}$。对于 $(i,j)$ 的每个邻居 $(i',j')$，如果 $\\phi_{i,j}\\cdot\\phi_{i',j'} \\lt 0$（即界面穿过该边），则向右侧添加一个跳跃贡献：\n- 如果 $\\phi_{i,j} \\lt 0$ 且 $\\phi_{i',j'} \\gt 0$，则 $b_{i,j} \\leftarrow b_{i,j} + \\Delta p$。\n- 如果 $\\phi_{i,j} \\gt 0$ 且 $\\phi_{i',j'} \\lt 0$，则 $b_{i,j} \\leftarrow b_{i,j} - \\Delta p$。\n这里 $\\Delta p = \\gamma \\kappa$，其中 $\\kappa = 1/R$。在区域边界节点上强行施加 $p=0$。\n\n验证指标：对于每个测试用例，按如下方式计算远离界面的无穷范数误差。定义内部掩码 $\\mathcal{M}^{-} = \\{(i,j): \\phi_{i,j} \\lt -\\tau\\}$ 和外部掩码 $\\mathcal{M}^{+} = \\{(i,j): \\phi_{i,j} \\gt \\tau\\}$，其中缓冲区 $\\tau = 1.5 \\Delta x$。令 $p_{\\text{th}}^{-} = \\Delta p$ 和 $p_{\\text{th}}^{+} = 0$。计算 $E^{-}_{\\infty} = \\max_{(i,j)\\in \\mathcal{M}^{-}} \\left| p_{i,j} - p_{\\text{th}}^{-} \\right|$ 和 $E^{+}_{\\infty} = \\max_{(i,j)\\in \\mathcal{M}^{+}} \\left| p_{i,j} - p_{\\text{th}}^{+} \\right|$。报告 $E_{\\infty} = \\max(E^{-}_{\\infty}, E^{+}_{\\infty})$。\n\n物理单位要求：将所有误差 $E_{\\infty}$ 以帕斯卡 (Pa) 为单位表示为浮点数。\n\n测试套件：使用以下参数集来运行该方法：\n1. $L=0.01$ m, $N=64$, $R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$。\n2. $L=0.01$ m, $N=32$（粗网格），$R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$。\n3. $L=0.01$ m, $N=128$（细网格），$R=0.002$ m, $\\gamma=0.072$ $\\mathrm{N/m}$。\n4. $L=0.01$ m, $N=128$, $R=0.0005$ m（小液滴），$\\gamma=0.072$ $\\mathrm{N/m}$。\n5. $L=0.01$ m, $N=128$, $R=0.0015$ m, $\\gamma=0.050$ $\\mathrm{N/m}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有五个测试用例的误差，格式为逗号分隔的列表，并用方括号括起来（例如，“[e1,e2,e3,e4,e5]”），其中每个 $e_k$ 是以帕斯卡 (Pa) 为单位的浮点数。",
            "solution": "用户提供了一个有效、适定且具有科学依据的问题陈述。该问题要求实现并验证一个用于静态液滴测试用例的二维鬼点法 (GFM)。问题的核心是求解一个在圆形界面处存在急剧跳跃的分段调和压力场，该跳跃由 Young-Laplace 方程决定。\n\n问题是在一个边长为 $L$ 的正方形域中找到压力场 $p(x,y)$。该域包含一个不同流体的圆形液滴，中心位于 $(L/2, L/2)$，半径为 $R$。两种流体之间的界面由符号距离函数的零等值线表示，$\\phi(x,y) = \\sqrt{(x-L/2)^2 + (y-L/2)^2} - R$，其中液滴内部 $\\phi \\lt 0$，外部 $\\phi \\gt 0$。在静态平衡且忽略体积力的情况下，每种流体中的压力是恒定的，这满足调和条件 $\\nabla^2 p = 0$。在界面处，存在由 Young-Laplace 方程决定的压力跳跃，$\\Delta p = p_{\\text{inside}} - p_{\\text{outside}} = \\gamma \\kappa$。这里，$\\gamma$ 是表面张力，$\\kappa$ 是界面曲率。对于二维圆形横截面，曲率为 $\\kappa = 1/R$。域边界上的压力固定为参考值 $p=0$。因此，理论解是一个分段常数压力场：当 $\\phi  0$ 时，$p(x,y) = \\Delta p$；当 $\\phi > 0$ 时，$p(x,y) = 0$。\n\n该问题在具有均匀间距 $\\Delta x = \\Delta y = L/(N-1)$ 的 $N \\times N$ 笛卡尔网格上进行离散化。拉普拉斯算子使用标准的五点有限差分模板进行近似：\n$$\n\\nabla^2 p \\approx \\frac{p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4 p_{i,j}}{\\Delta x^2}\n$$\n问题指定将此模板重新排列为每个网格节点 $(i,j)$ 的线性方程形式：\n$$\n4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = b_{i,j}\n$$\n这等价于设置 $-\\Delta x^2 (\\nabla^2_h p)_{i,j} = b_{i,j}$，其中 $\\nabla^2_h$ 是离散拉普拉斯算子。对于远离界面的节点，控制方程为 $\\nabla^2 p = 0$，因此右侧项 $b_{i,j}$ 为 $0$。压力跳跃条件通过为邻近界面的节点定义非零的 $b_{i,j}$ 值来强制执行，这是该特定鬼点法的精髓。\n\nGFM 通过在模板跨越界面的节点的离散方程右侧添加源项来模拟压力不连续性。该指令指出，对于一个节点 $(i,j)$ 及其邻居 $(i',j')$，如果界面位于它们之间（即 $\\phi_{i,j} \\cdot \\phi_{i',j'}  0$），则向 $b_{i,j}$ 添加一个贡献。\n让我们分析这个指令。考虑一个处于液相的节点 $(i,j)$（$\\phi_{i,j}  0$）及其处于气相的邻居 $(i+1,j)$（$\\phi_{i+1,j} > 0$）。一个严格的 GFM 会通过从气相压力外插来定义位于 $(i+1,j)$ 处的鬼点压力。一阶 GFM 将此鬼点压力定义为 $p_{i+1,j}^{\\text{ghost}} = p_{i+1,j} + \\Delta p$，其中 $p_{i+1,j}$ 是邻近节点的真实压力。将此代入节点 $(i,j)$ 的模板中：\n$$\n4 p_{i,j} - p_{i+1,j}^{\\text{ghost}} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = 0\n$$\n$$\n4 p_{i,j} - (p_{i+1,j} + \\Delta p) - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = 0\n$$\n重新整理以匹配问题指定的形式，得到：\n$$\n4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1} = \\Delta p\n$$\n这意味着对于节点 $(i,j)$，右侧项 $b_{i,j}$ 应接收一个 $+\\Delta p$ 的贡献。这与指令相符：如果 $\\phi_{i,j}  0$ 且 $\\phi_{i',j'} > 0$，则 $b_{i,j}$ 增加 $\\Delta p$。\n相反，对于气相节点 $(i+1,j)$，跳跃为 $p_{\\text{inside}} - p_{\\text{outside}} = \\Delta p$，这意味着 $p_{\\text{outside}} - p_{\\text{inside}} = -\\Delta p$。位于节点 $(i,j)$ 处的鬼点压力是 $p_{i,j}^{\\text{ghost}} = p_{i,j} - \\Delta p$。$(i+1,j)$ 处的模板变为：\n$$\n4 p_{i+1,j} - p_{i+2,j} - p_{i,j}^{\\text{ghost}} - p_{i+1,j+1} - p_{i+1,j-1} = 0\n$$\n$$\n4 p_{i+1,j} - p_{i+2,j} - (p_{i,j} - \\Delta p) - p_{i+1,j+1} - p_{i+1,j-1} = 0\n$$\n这为节点 $(i+1,j)$ 提供了 $-\\Delta p$ 的右侧贡献，这也与指令相符。任何节点的总右侧值 $b_{i,j}$ 是其所有跨界面邻居贡献的总和。\n\n所有 $N \\times N$ 节点的完整离散方程组构成一个形式为 $A \\mathbf{p} = \\mathbf{b}$ 的大型稀疏线性系统。向量 $\\mathbf{p}$ 包含从二维网格展平的未知压力值。矩阵 $A$ 是系数矩阵。对于一个内部节点 $(i,j)$，$A$ 的第 $k=iN+j$ 行包含 5 点模板的系数：对角线上为 $4$，其四个邻居处为 $-1$。对于边界节点，通过将 $A$ 的相应行设置为主对角线为1的行（即，当 $l \\ne k$ 时，$A_{k,k}=1$，$A_{k,l}=0$），并设置 $b_k=0$，来强行施加 Dirichlet 条件 $p=0$。向量 $\\mathbf{b}$ 包含 GFM 源项，这些源项仅在邻近界面的节点上为非零。\n\n求解这个稀疏线性系统以获得数值压力场 $p_{i,j}$。为了验证准确性，将数值解与已知的理论解（$p_{\\text{th}}^{-} = \\Delta p$，$p_{\\text{th}}^{+} = 0$）进行比较。误差使用无穷范数进行量化，该范数在由缓冲区距离 $\\tau = 1.5 \\Delta x$ 定义的远离界面的区域中计算。内部误差 $E^{-}_{\\infty} = \\max |p_{i,j} - p_{\\text{th}}^{-}|$ 是对所有满足 $\\phi_{i,j}  -\\tau$ 的节点计算的，而外部误差 $E^{+}_{\\infty} = \\max |p_{i,j} - p_{\\text{th}}^{+}|$ 是对所有满足 $\\phi_{i,j} > \\tau$ 的节点计算的。最终报告的误差为 $E_{\\infty} = \\max(E^{-}_{\\infty}, E^{+}_{\\infty})$。\n\n该算法使用 Python 实现。网格和场数据存储在 `numpy` 数组中。大型稀疏矩阵 $A$ 使用 `scipy.sparse.lil_matrix` 构建，线性系统使用 `scipy.sparse.linalg.spsolve` 高效求解。对所提供的五个测试用例中的每一个都执行此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (L, N, R, gamma)\n        (0.01, 64, 0.002, 0.072),\n        (0.01, 32, 0.002, 0.072),\n        (0.01, 128, 0.002, 0.072),\n        (0.01, 128, 0.0005, 0.072),\n        (0.01, 128, 0.0015, 0.050),\n    ]\n\n    results = []\n    for L, N, R, gamma in test_cases:\n        error = solve_one_case(L, N, R, gamma)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_one_case(L, N, R, gamma):\n    \"\"\"\n    Implements the Ghost Fluid Method for a single static droplet test case.\n\n    Args:\n        L (float): Domain side length in meters.\n        N (int): Number of grid nodes in each dimension.\n        R (float): Droplet radius in meters.\n        gamma (float): Surface tension in N/m.\n\n    Returns:\n        float: The infinity-norm error E_inf in Pascals.\n    \"\"\"\n    # 1. Grid and Level-Set Setup\n    dx = L / (N - 1)\n    x = np.linspace(0, L, N)\n    y = np.linspace(0, L, N)\n    xx, yy = np.meshgrid(x, y)\n    \n    xc, yc = L / 2.0, L / 2.0\n    phi = np.sqrt((xx - xc)**2 + (yy - yc)**2) - R\n    \n    # 2. System Assembly (A p = b)\n    n_nodes = N * N\n    A = lil_matrix((n_nodes, n_nodes), dtype=np.float64)\n    b = np.zeros(n_nodes, dtype=np.float64)\n    \n    # Pressure jump and theoretical pressures\n    delta_p = gamma / R\n\n    # Iterate over all grid points to build matrix A and vector b\n    for i in range(N):\n        for j in range(N):\n            k = i * N + j  # Flattened 1D index\n\n            # Strong enforcement of Dirichlet boundary conditions p=0\n            if i == 0 or i == N - 1 or j == 0 or j == N - 1:\n                A[k, k] = 1.0\n                b[k] = 0.0\n                continue\n\n            # Internal nodes: 5-point stencil for the Laplacian\n            A[k, k] = 4.0\n            A[k, k + 1] = -1.0  # Neighbor (i, j+1)\n            A[k, k - 1] = -1.0  # Neighbor (i, j-1)\n            A[k, k + N] = -1.0  # Neighbor (i+1, j)\n            A[k, k - N] = -1.0  # Neighbor (i-1, j)\n\n            # GFM: Add source terms to RHS for nodes adjacent to the interface\n            # Check right neighbor (i, j+1)\n            if phi[i, j] * phi[i, j + 1]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n            \n            # Check left neighbor (i, j-1)\n            if phi[i, j] * phi[i, j - 1]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n            \n            # Check top neighbor (i+1, j)\n            if phi[i, j] * phi[i + 1, j]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n\n            # Check bottom neighbor (i-1, j)\n            if phi[i, j] * phi[i - 1, j]  0:\n                if phi[i, j]  0: b[k] += delta_p\n                else: b[k] -= delta_p\n    \n    # 3. Solve the Linear System\n    # Convert matrix to a more efficient format for solving\n    A_csc = A.tocsc()\n    p_flat = spsolve(A_csc, b)\n    p_sol = p_flat.reshape((N, N))\n\n    # 4. Error Verification\n    tau = 1.5 * dx\n    p_th_minus = delta_p\n    p_th_plus = 0.0\n\n    mask_inside = phi  -tau\n    mask_outside = phi > tau\n\n    p_values_inside = p_sol[mask_inside]\n    p_values_outside = p_sol[mask_outside]\n\n    err_inside = 0.0\n    if p_values_inside.size > 0:\n        err_inside = np.max(np.abs(p_values_inside - p_th_minus))\n\n    err_outside = 0.0\n    if p_values_outside.size > 0:\n        err_outside = np.max(np.abs(p_values_outside - p_th_plus))\n        \n    E_inf = max(err_inside, err_outside)\n    \n    return E_inf\n\nsolve()\n\n```"
        }
    ]
}