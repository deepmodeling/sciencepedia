{
    "hands_on_practices": [
        {
            "introduction": "这项练习旨在解决分段线性界面重构（PLIC-VOF）方法中的一个核心几何问题。我们将在给定流体体积分数 $\\alpha$ 和界面法向量 $\\mathbf{n}$ 的条件下，学习如何精确确定单个计算网格单元内平面界面的位置。掌握这一基本计算是理解VOF方法如何在离散网格上精确表示尖锐界面的关键。",
            "id": "4076438",
            "problem": "一种使用分段线性界面计算（PLIC）的流体体积法（VOF）重构方法，将边长为 $\\Delta$ 的立方计算单元内的液-气界面近似为一个平面，其方程为 $\\mathbf{n} \\cdot \\mathbf{x} = c$，其中 $\\mathbf{n}$ 是单位法向量，$c$ 是一个平面常数。液体被认为占据单元内由 $\\mathbf{n} \\cdot \\mathbf{x} \\le c$ 定义的半空间。假设该单元是轴对齐的，坐标 $\\mathbf{x} = (x,y,z)$ 从立方体的一个角上的原点开始测量，因此单元的定义域为 $[0,\\Delta] \\times [0,\\Delta] \\times [0,\\Delta]$。给定液体体积分数 $\\alpha = 0.3$ 和单位法向量 $\\mathbf{n} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$，请从第一性原理推导无量纲平面常数 $\\tilde{c} \\equiv \\frac{c}{\\Delta}$ 的表达式，该表达式能在单元内产生正确的液体体积分数 $\\alpha$。请将最终答案表示为 $\\tilde{c}$ 的一个精确解析表达式（无四舍五入）。",
            "solution": "问题要求解在一个立方单元内进行分段线性界面计算（PLIC）所用的无量纲平面常数 $\\tilde{c}$。液体体积分数 $\\alpha$、单元几何形状以及界面法向量 $\\mathbf{n}$ 均已给出。求解过程是通过将液体体积分数与由平面方程定义的液体区域的几何形状联系起来进行的。\n\n计算单元是一个由定义域 $\\mathcal{C} = [0, \\Delta] \\times [0, \\Delta] \\times [0, \\Delta]$ 定义的立方体。其总体积为 $V_{cell} = \\Delta^3$。\n\n液-气界面由平面 $\\mathbf{n} \\cdot \\mathbf{x} = c$ 近似。液体被定义为占据半空间 $\\mathbf{n} \\cdot \\mathbf{x} \\le c$。单元内的液体体积 $V_L$ 是区域 $\\{\\mathbf{x} \\in \\mathcal{C} \\mid \\mathbf{n} \\cdot \\mathbf{x} \\le c\\}$ 的体积。\n\n液体体积分数 $\\alpha$ 定义为液体体积与单元总体积之比：\n$$\n\\alpha = \\frac{V_L}{V_{cell}} = \\frac{V_L}{\\Delta^3}\n$$\n给定 $\\alpha = 0.3$ 和单位法向量 $\\mathbf{n} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$。界面方程为：\n$$\n\\frac{1}{\\sqrt{2}}x + \\frac{1}{\\sqrt{2}}y + 0z = c \\implies x+y = \\sqrt{2}c\n$$\n为简化几何计算，我们引入无量纲坐标 $\\tilde{\\mathbf{x}} = (\\tilde{x}, \\tilde{y}, \\tilde{z})$，其中 $\\tilde{x}=x/\\Delta$，$\\tilde{y}=y/\\Delta$，$\\tilde{z}=z/\\Delta$。在这些坐标系下，该单元是一个单位立方体 $\\tilde{\\mathcal{C}} = [0, 1] \\times [0, 1] \\times [0, 1]$。\n将 $\\mathbf{x} = \\Delta\\tilde{\\mathbf{x}}$ 代入液体区域的定义：\n$$\n\\mathbf{n} \\cdot (\\Delta \\tilde{\\mathbf{x}}) \\le c \\implies \\mathbf{n} \\cdot \\tilde{\\mathbf{x}} \\le \\frac{c}{\\Delta}\n$$\n题目将无量纲平面常数定义为 $\\tilde{c} \\equiv c/\\Delta$。因此，单位立方体中的液体区域由 $\\mathbf{n} \\cdot \\tilde{\\mathbf{x}} \\le \\tilde{c}$ 定义。\n根据定义，体积分数 $\\alpha$ 是单位立方体内液体区域的体积：\n$$\n\\alpha = \\text{Volume}(\\{\\tilde{\\mathbf{x}} \\in \\tilde{\\mathcal{C}} \\mid \\mathbf{n} \\cdot \\tilde{\\mathbf{x}} \\le \\tilde{c}\\})\n$$\n代入给定的法向量：\n$$\n\\frac{1}{\\sqrt{2}}\\tilde{x} + \\frac{1}{\\sqrt{2}}\\tilde{y} \\le \\tilde{c}\n$$\n定义界面的平面与 $\\tilde{z}$ 坐标无关，这意味着它是一个平行于 $\\tilde{z}$ 轴的垂直平面。因此，液体区域的体积是 $\\tilde{x}$-$\\tilde{y}$ 平面内二维液体区域的面积与立方体高度（为 $1$）的乘积。\n所以，$\\alpha$ 等于单位正方形 $[0, 1] \\times [0, 1]$ 中由以下条件定义的区域 $A$ 的面积：\n$$\nA = \\left\\{(\\tilde{x}, \\tilde{y}) \\in [0, 1]^2 \\mid \\frac{\\tilde{x}}{\\sqrt{2}} + \\frac{\\tilde{y}}{\\sqrt{2}} \\le \\tilde{c}\\right\\}\n$$\n这个不等式可以改写为 $\\tilde{x} + \\tilde{y} \\le \\sqrt{2}\\tilde{c}$。我们定义一个参数 $d = \\sqrt{2}\\tilde{c}$。问题简化为求解单位正方形内区域 $\\tilde{x} + \\tilde{y} \\le d$ 的面积。\n\n这个区域的形状取决于 $d$ 的值。函数 $f(\\tilde{x}, \\tilde{y}) = \\tilde{x}+\\tilde{y}$ 在单位正方形内，在 $(\\tilde{x}, \\tilde{y})=(0,0)$ 处取得最小值 $0$，在 $(\\tilde{x}, \\tilde{y})=(1,1)$ 处取得最大值 $2$。因此，我们只需要考虑 $d \\in [0, 2]$ 的情况。\n\n我们根据直线 $\\tilde{x} + \\tilde{y} = d$ 的位置区分两种情况：\n\n情况1：$0 \\le d \\le 1$。\n直线与 $\\tilde{x}$ 轴相交于 $(\\tilde{x},0)=(d,0)$，与 $\\tilde{y}$ 轴相交于 $(0,\\tilde{y})=(0,d)$。两个交点都位于单位正方形的边上。区域 $\\tilde{x} + \\tilde{y} \\le d$ 形成一个顶点为 $(0,0)$、$(d,0)$ 和 $(0,d)$ 的直角三角形。该三角形的面积由下式给出：\n$$\n\\alpha(d) = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} d \\cdot d = \\frac{1}{2}d^2\n$$\n这种情况适用于体积分数 $\\alpha \\in [0, \\frac{1}{2}(1)^2]$，即 $\\alpha \\in [0, 0.5]$。\n\n情况2：$1  d \\le 2$。\n直线 $\\tilde{x} + \\tilde{y} = d$ 不再与原点形成一个简单的三角形。液体区域是一个五边形。更简单的方法是计算“气体”区域（其中 $\\tilde{x} + \\tilde{y} > d$）的面积，然后从正方形的总面积（为 $1$）中减去它。气体区域是位于角点 $(1,1)$ 的一个三角形。其顶点为 $(d-1, 1)$、$(1, d-1)$ 和 $(1,1)$。这个三角形沿正方形边的两条边的长度是 $1 - (d-1) = 2-d$。这个气体三角形的面积是 $\\frac{1}{2}(2-d)^2$。因此，液体面积（体积分数）为：\n$$\n\\alpha(d) = 1 - \\frac{1}{2}(2-d)^2\n$$\n这种情况适用于体积分数 $\\alpha \\in (0.5, 1]$。\n\n题目指定液体体积分数 $\\alpha = 0.3$。由于 $0 \\le 0.3 \\le 0.5$，我们处于情况1。我们使用公式 $\\alpha = \\frac{1}{2}d^2$。\n$$\n0.3 = \\frac{1}{2}d^2\n$$\n$$\nd^2 = 2 \\times 0.3 = 0.6 = \\frac{6}{10} = \\frac{3}{5}\n$$\n由于 $d$ 对应于一个几何构型，我们取正根：\n$$\nd = \\sqrt{\\frac{3}{5}}\n$$\n最后，我们回顾 $d$ 用 $\\tilde{c}$ 表示的定义：\n$$\nd = \\sqrt{2}\\tilde{c}\n$$\n求解 $\\tilde{c}$：\n$$\n\\tilde{c} = \\frac{d}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}} \\sqrt{\\frac{3}{5}} = \\sqrt{\\frac{1}{2} \\cdot \\frac{3}{5}} = \\sqrt{\\frac{3}{10}}\n$$\n这就是无量纲平面常数 $\\tilde{c}$ 的精确解析表达式。",
            "answer": "$$ \\boxed{\\sqrt{\\frac{3}{10}}} $$"
        },
        {
            "introduction": "在掌握了单网格内的几何重构后，我们将探讨更复杂的物理现象。本练习将关注VOF模拟中的一个关键挑战：由表面张力离散化误差引起的虚假电流（spurious currents）。我们将通过对Navier-Stokes方程进行标度分析，推导出一个用于量化这些数值伪影的无量纲度量，从而深入理解数值误差如何影响物理仿真的准确性。",
            "id": "4076442",
            "problem": "在计算燃烧学中，静态液滴基准被广泛用于流体体积（VOF）法处理液-气界面，以量化被称为伪电流的寄生速度。考虑一个静止的、周期的、方形域中的不可压缩两相系统，其中一个半径为 $R$ 的单个液滴初始静止并浸没在气体中。界面由VOF指示函数表示，表面张力通过连续表面力（CSF）模型进行建模。目标是推导一个用于伪电流的无量纲误差指标，并在一系列网格加密下计算该指标。\n\n您必须基于以下公认的基础进行推导：\n- 在CSF框架下，用于具有表面张力的两相混合物的不可压缩Navier-Stokes方程：\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa \\nabla H,\n$$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度， $p$ 是压力，$\\mu$ 是动力粘度，$\\sigma$ 是表面张力，$\\kappa$ 是平均曲率，$H$ 是VOF指示函数的亥维赛函数；以及不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$。\n- 在静态液滴基准中，物理上正确的稳态解是 $\\mathbf{u}=\\mathbf{0}$，伴随有拉普拉斯压力跳跃 $\\Delta p = \\sigma \\kappa$；然而，数值曲率误差会引发伪速度。\n- L-无穷范数 $||\\mathbf{u}||_\\infty$ 是计算域上速度场的最大幅值，即 $||\\mathbf{u}||_\\infty = \\max_{\\mathbf{x}} ||\\mathbf{u}(\\mathbf{x})||$。\n\n假设：\n- 离散化引起的曲率误差 $|\\varepsilon_\\kappa|$ 与网格间距的关系为 $|\\varepsilon_\\kappa| \\sim \\alpha \\left( \\frac{\\Delta x}{R} \\right)^p \\frac{1}{R}$，其中 $\\alpha$ 是一个由曲率重构方法决定的无量纲常数，$p$ 是关于 $\\Delta x$ 的精度阶。\n- 在静态液滴测试的稳态、低雷诺数状态下，粘性扩散与由曲率误差产生的（错误的）毛细作用力相平衡。\n\n任务：\n1. 基于上述基础，不引入未经检验的捷径，推导一个由下式定义的无量纲伪电流误差指标\n$$\n\\mathcal{M} \\equiv \\frac{||\\mathbf{u}||_\\infty}{\\sigma/\\mu},\n$$\n该指标是 $R$, $\\Delta x$, $\\alpha$ 和 $p$ 的函数。\n2. 基于您的推导，实现一个算法，对于给定的 $(R,\\Delta x,\\alpha,p,\\sigma,\\mu)$，计算 $\\mathcal{M}$ 并将其四舍五入到六位小数。程序不应计算角度。如果计算了任何中间物理量，请确保其单位一致性，但最终输出是无量纲的，因此没有单位。\n3. 使用以下具有物理上合理参数的测试套件，在一系列网格加密下评估 $\\mathcal{M}$。对于每个测试，$R$ 和 $\\Delta x$ 的单位是米，$\\sigma$ 的单位是牛顿/米，$\\mu$ 的单位是帕斯卡·秒：\n   - 测试 1：$(R=\\;1.0\\times 10^{-3},\\;\\Delta x=\\;R/16,\\;\\alpha=\\;0.400,\\;p=\\;2,\\;\\sigma=\\;0.050,\\;\\mu=\\;1.0\\times 10^{-3})$。\n   - 测试 2：$(R=\\;5.0\\times 10^{-4},\\;\\Delta x=\\;R/64,\\;\\alpha=\\;0.060,\\;p=\\;1,\\;\\sigma=\\;0.072,\\;\\mu=\\;5.0\\times 10^{-4})$。\n   - 测试 3：$(R=\\;2.0\\times 10^{-3},\\;\\Delta x=\\;R,\\;\\alpha=\\;0.250,\\;p=\\;2,\\;\\sigma=\\;0.030,\\;\\mu=\\;2.0\\times 10^{-3})$。\n   - 测试 4：$(R=\\;7.5\\times 10^{-4},\\;\\Delta x=\\;R/128,\\;\\alpha=\\;1.100,\\;p=\\;3,\\;\\sigma=\\;0.072,\\;\\mu=\\;8.0\\times 10^{-4})$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是对应测试用例的 $\\mathcal{M}$ 的浮点值，四舍五入到六位小数，并按上述测试的顺序排列（例如，$[\\;0.015625,\\;0.060000,\\;0.250000,\\;0.000067\\;]$）。输出是无量纲的，并且必须严格遵循此格式。",
            "solution": "该问题要求推导无量纲伪电流误差指标 $\\mathcal{M}$，并为一组测试用例计算其值。推导过程必须基于所提供的物理原理和假设。\n\n推导过程如下。\n\n首先，我们从所给出的、使用连续表面力（CSF）模型建模表面张力的两相混合物不可压缩Navier-Stokes方程开始：\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_n \\nabla H\n$$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度， $t$ 是时间， $p$ 是压力，$\\mu$ 是动力粘度，$\\sigma$ 是表面张力，$\\kappa_n$ 是数值近似的曲率，$H$ 是表示体积分数的亥维赛函数。$\\kappa$ 上的下标 $n$ 是为了强调在数值模拟中，这是计算得到的曲率，而非精确的解析曲率。\n\n问题指出，伪电流是在稳态、低雷诺数状态下进行分析的。\n“稳态”假设意味着时间导数项为零：$\\frac{\\partial \\mathbf{u}}{\\partial t} = \\mathbf{0}$。\n“低雷诺数”假设意味着惯性项 $\\rho(\\mathbf{u}\\cdot \\nabla \\mathbf{u})$ 与粘性扩散项 $\\mu \\nabla^2 \\mathbf{u}$ 相比可以忽略不计。\n应用这些假设，可将控制方程简化为压力、粘性力和表面张力之间的平衡：\n$$\n\\mathbf{0} \\approx -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_n \\nabla H\n$$\n\n伪电流 $\\mathbf{u} \\neq \\mathbf{0}$ 的产生，是因为离散的压力梯度 $\\nabla p$ 无法完全平衡数值计算出的表面张力 $\\sigma \\kappa_n \\nabla H$。当压力梯度与来自精确曲率 $\\kappa_{exact}$ 的力相平衡时，即 $\\nabla p_{exact} = \\sigma \\kappa_{exact} \\nabla H$，存在精确解 $\\mathbf{u}=\\mathbf{0}$。曲率的数值误差 $\\varepsilon_\\kappa = \\kappa_n - \\kappa_{exact}$ 是驱动伪流动的非平衡残余力的来源。\n\n推导的核心在于所给的假设：“粘性扩散与（错误的）毛细作用力相平衡。”我们通过尺度分析来将其形式化。错误的毛细力密度 $\\mathbf{F}_{err}$ 是表面张力中驱动流动的部分，它源于曲率误差 $\\varepsilon_\\kappa$：\n$$\n\\mathbf{F}_{err} \\sim \\sigma \\varepsilon_\\kappa \\nabla H\n$$\n亥维赛函数的梯度 $\\nabla H$ 仅在界面处非零，其作用类似于一个离散的狄拉克函数。其大小与界面厚度的倒数成正比，而界面厚度又与网格间距 $\\Delta x$ 成正比。因此，有 $||\\nabla H|| \\sim 1/\\Delta x$。因此，错误力密度的大小为：\n$$\n||\\mathbf{F}_{err}|| \\sim \\sigma |\\varepsilon_\\kappa| \\frac{1}{\\Delta x}\n$$\n粘性扩散项是 $\\mu \\nabla^2 \\mathbf{u}$。对于尺度分析，拉普拉斯算子 $\\nabla^2$ 的尺度为 $1/L^2$，其中 $L$ 是速度场变化的特征长度尺度。对于在液滴周围形成的伪电流涡，最大的涡流受到液滴几何形状的限制。因此，全局流动结构的合适特征长度尺度是液滴半径 $R$。速度尺度取为最大速度幅值 $||\\mathbf{u}||_\\infty$。因此，粘性项的大小为：\n$$\n||\\mu \\nabla^2 \\mathbf{u}|| \\sim \\mu \\frac{||\\mathbf{u}||_\\infty}{R^2}\n$$\n根据平衡假设，我们令粘性项和错误毛细项的大小相等：\n$$\n\\mu \\frac{||\\mathbf{u}||_\\infty}{R^2} \\sim \\sigma |\\varepsilon_\\kappa| \\frac{1}{\\Delta x}\n$$\n现在我们可以求解最大速度幅值 $||\\mathbf{u}||_\\infty$：\n$$\n||\\mathbf{u}||_\\infty \\sim \\frac{\\sigma}{\\mu} \\frac{R^2}{\\Delta x} |\\varepsilon_\\kappa|\n$$\n问题提供了一个离散化引起的曲率误差模型：\n$$\n|\\varepsilon_\\kappa| \\sim \\alpha \\left( \\frac{\\Delta x}{R} \\right)^p \\frac{1}{R}\n$$\n其中 $\\alpha$ 是一个无量纲常数，$p$ 是精度阶。将此模型代入我们关于 $||\\mathbf{u}||_\\infty$ 的表达式中：\n$$\n||\\mathbf{u}||_\\infty \\sim \\frac{\\sigma}{\\mu} \\frac{R^2}{\\Delta x} \\left[ \\alpha \\left( \\frac{\\Delta x}{R} \\right)^p \\frac{1}{R} \\right]\n$$\n简化表达式：\n$$\n||\\mathbf{u}||_\\infty \\sim \\frac{\\sigma \\alpha}{\\mu} \\frac{R}{\\Delta x} \\left( \\frac{\\Delta x}{R} \\right)^p = \\frac{\\sigma \\alpha}{\\mu} \\left( \\frac{\\Delta x}{R} \\right)^{p-1}\n$$\n问题要求的是无量纲伪电流误差指标 $\\mathcal{M}$，其定义为：\n$$\n\\mathcal{M} \\equiv \\frac{||\\mathbf{u}||_\\infty}{\\sigma/\\mu}\n$$\n代入我们推导出的 $||\\mathbf{u}||_\\infty$ 表达式，我们得到 $\\mathcal{M}$ 的最终公式：\n$$\n\\mathcal{M} = \\frac{\\frac{\\sigma \\alpha}{\\mu} \\left( \\frac{\\Delta x}{R} \\right)^{p-1}}{\\sigma/\\mu} = \\alpha \\left( \\frac{\\Delta x}{R} \\right)^{p-1}\n$$\n这个关系式是无量纲的，因为 $\\alpha$ 和比率 $\\Delta x/R$ 都是无量纲的。该推导完全依赖于所提供的物理基础和标准的尺度分析技术。请注意，参数 $\\sigma$ 和 $\\mu$ 虽然对于伪电流的存在是物理上必不可少的，但在无量纲指标 $\\mathcal{M}$ 的最终表达式中被消掉了。\n\n计算算法是这个推导公式的直接实现。对于每个测试用例，我们都给定了 $R$、$\\Delta x$（作为 $R$ 的一部分）、$\\alpha$ 和 $p$ 的值。该算法将使用上述公式计算 $\\mathcal{M}$，并将结果四舍五入到六位小数。\n\n例如，对于测试1：\n$R = 1.0\\times 10^{-3}$，$\\Delta x = R/16$，$\\alpha = 0.400$，$p=2$。\n比率 $\\Delta x/R = 1/16$。\n指数 $p-1 = 2-1 = 1$。\n$$\n\\mathcal{M} = 0.400 \\times \\left( \\frac{1}{16} \\right)^1 = \\frac{0.400}{16} = 0.025\n$$\n对所有测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the nondimensional spurious-current error indicator M for a series\n    of static droplet test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (R, dx_fraction, alpha, p, sigma, mu)\n    # dx_fraction is the denominator 'd' in dx = R/d. For dx=R, d=1.\n    test_cases = [\n        # Test 1: (R=1.0e-3, Δx=R/16, α=0.400, p=2, σ=0.050, μ=1.0e-3)\n        (1.0e-3, 16.0, 0.400, 2, 0.050, 1.0e-3),\n        # Test 2: (R=5.0e-4, Δx=R/64, α=0.060, p=1, σ=0.072, μ=5.0e-4)\n        (5.0e-4, 64.0, 0.060, 1, 0.072, 5.0e-4),\n        # Test 3: (R=2.0e-3, Δx=R, α=0.250, p=2, σ=0.030, μ=2.0e-3)\n        (2.0e-3, 1.0, 0.250, 2, 0.030, 2.0e-3),\n        # Test 4: (R=7.5e-4, Δx=R/128, α=1.100, p=3, σ=0.072, μ=8.0e-4)\n        (7.5e-4, 128.0, 1.100, 3, 0.072, 8.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        R, dx_divisor, alpha, p, sigma, mu = case\n        \n        # The derivation shows that M does not depend on R, sigma, or mu explicitly,\n        # but on the ratio dx/R.\n        # M = alpha * (dx/R)^(p-1)\n        \n        # Calculate the ratio dx/R\n        # dx = R / dx_divisor\n        # dx/R = 1 / dx_divisor\n        dx_over_R = 1.0 / dx_divisor\n        \n        # Calculate the exponent\n        exponent = p - 1\n        \n        # Calculate M\n        # Using np.power for robust floating-point exponentiation\n        m_indicator = alpha * np.power(dx_over_R, exponent)\n        \n        # Round the result to six decimal places\n        # Using string formatting for precise rounding\n        rounded_result = f\"{m_indicator:.6f}\"\n\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    # The example output in the problem statement is illustrative of the format.\n    # The correct results are generated based on the derived formula.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的这项实践将理论与代码验证相结合，完成从理论推导到实践验证的闭环。我们将使用一组模拟网格加密研究生成的“实验”数据，通过统计学方法来估计虚假电流的收敛阶。这个过程不仅演示了如何凭经验验证理论标度律，也训练了计算科学家在评估和验证数值模型时所必备的关键技能。",
            "id": "4076424",
            "problem": "考虑一个静止气体中的静态球形液滴，其界面由流体体积（VOF）法表示，毛细作用由连续表面力（CSF）公式建模。在没有外力的情况下，任何非零速度场都源于离散误差，被称为伪电流。在计算燃烧学中，精确的界面动力学至关重要，因为界面曲率会影响压力跳跃和局部火焰动力学。对于一个网格间距为 $\\Delta x$ 的网格，假设无量纲伪电流幅值 $U_s(\\Delta x)$ 的缩放关系为 $U_s(\\Delta x) \\sim C \\, \\Delta x^p$，其中常数 $C$ 和指数 $p$ 由离散化决定，特别是曲率估算阶数。您的任务是设计并实现一个网格加密研究，以从数值数据中估算 $p$，并将其与曲率离散化阶数 $k$ 联系起来。\n\n从第一性原理出发：\n- 不可压缩的Navier–Stokes方程（在适用于小雷诺数界面流动的斯托克斯极限下）、VOF方法的定义以及CSF毛细力表示。假设真实解是完全静态的，并且观察到的所有速度都源于离散误差。\n- 一个 $k$ 阶的离散曲率估计器会引入一个与 $\\mathcal{O}(\\Delta x^k)$ 成比例的曲率误差。将斯托克斯算子视为一个有界线性逆映射，它将离散的力误差映射到速度，并将速度幅值缩放与曲率误差缩放关联起来。\n\n基于这些基础，实现一个算法，该算法：\n- 给定 $i = 1, \\dots, N$ 的数据对 $(\\Delta x_i, U_s(\\Delta x_i))$，通过对数变换进行线性回归来估算缩放指数 $p$，即使用普通最小二乘法拟合 $\\log U_s = \\log C + p \\log \\Delta x$ 以获得 $\\hat{p}$ 和 $\\hat{C}$。\n- 使用容差 $\\tau$ 将 $\\hat{p}$ 与给定的曲率离散化阶数 $k$进行比较，并返回 $\\lvert \\hat{p} - k \\rvert \\le \\tau$ 是否成立。\n\n假设与约定：\n- 所有幅值 $U_s$ 都是无量纲的，已通过特征速度进行缩放，因此不需要物理单位转换。\n- 所有对数均为自然对数。\n- 只有 $U_s > 0$ 和 $\\Delta x > 0$ 的数据是可接受的。\n- 使用容差 $\\tau = 0.3$。\n\n测试套件：\n提供一个包含五个案例的测试套件。对于每个案例，提供网格间距 $\\{\\Delta x_i\\}$、测量的无量纲幅值 $\\{U_s(\\Delta x_i)\\}$ 以及曲率离散化阶数 $k$。\n\n- 案例 1（二阶曲率，轻度噪声）：\n  - $\\Delta x = [\\,0.05,\\,0.025,\\,0.0125,\\,0.00625\\,]$\n  - $U_s = [\\,0.0012625,\\,0.00030625,\\,0.000079296875,\\,0.0000193359375\\,]$\n  - $k = 2$\n- 案例 2（一阶曲率，中度噪声）：\n  - $\\Delta x = [\\,0.05,\\,0.025,\\,0.0125,\\,0.00625\\,]$\n  - $U_s = [\\,0.0412,\\,0.0196,\\,0.0101,\\,0.00485\\,]$\n  - $k = 1$\n- 案例 3（二阶曲率，存在异常值）：\n  - $\\Delta x = [\\,0.0625,\\,0.03125,\\,0.015625,\\,0.0078125,\\,0.00390625\\,]$\n  - $U_s = [\\,0.0011484375,\\,0.000298828125,\\,0.00010986328125,\\,0.0000179443359375,\\,0.000004668189453125\\,]$\n  - $k = 2$\n- 案例 4（在不同加密程度下幅值近似恒定）：\n  - $\\Delta x = [\\,0.05,\\,0.025,\\,0.0125,\\,0.00625\\,]$\n  - $U_s = [\\,0.00301,\\,0.00300,\\,0.00299,\\,0.00302\\,]$\n  - $k = 2$\n- 案例 5（两点精确二阶缩放，无噪声）：\n  - $\\Delta x = [\\,0.02,\\,0.01\\,]$\n  - $U_s = [\\,0.00016,\\,0.00004\\,]$\n  - $k = 2$\n\n实现要求：\n- 对每个案例，通过对 $\\log U_s$ 与 $\\log \\Delta x$ 进行最小二乘来估算 $\\hat{p}$。\n- 对每个案例，计算布尔一致性标志 $\\mathrm{consistent} = (\\lvert \\hat{p} - k \\rvert \\le \\tau)$，其中 $\\tau = 0.3$。\n- 在最终输出中，将每个 $\\hat{p}$ 四舍五入到 3 位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试案例对应一个形如 $[\\hat{p},k,\\mathrm{consistent}]$ 的子列表。例如，输出应类似于 $[[\\hat{p}_1,k_1,\\mathrm{consistent}_1],[\\hat{p}_2,k_2,\\mathrm{consistent}_2],\\dots]$。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 第一步：提取已知信息\n- **物理模型**：一个静止气体中的静态球形液滴。\n- **数值方法**：液-气界面由流体体积（VOF）法表示。毛细作用由连续表面力（CSF）公式建模。\n- **现象**：伪电流，其无量纲幅值为 $U_s$，由离散误差引起。\n- **缩放定律**：假设伪电流幅值随网格间距 $\\Delta x$ 变化，其缩放关系为 $U_s(\\Delta x) \\sim C \\, \\Delta x^p$，其中 $C$ 是一个常数，$p$ 是缩放指数。\n- **理论基础**：指数 $p$ 由离散化阶数决定，特别是曲率估算阶数，记为 $k$。一个 $k$ 阶的离散曲率估计器的误差缩放为 $\\mathcal{O}(\\Delta x^k)$。斯托克斯算子将力误差与速度关联起来，意味着 $p \\approx k$。\n- **任务**：\n    1.  给定 $N$ 对 $(\\Delta x_i, U_s(\\Delta x_i))$，通过对数变换进行线性回归来估算缩放指数 $p$：$\\log U_s = \\log C + p \\log \\Delta x$。估算值记为 $\\hat{p}$。\n    2.  使用容差 $\\tau$ 将估算出的指数 $\\hat{p}$ 与理论曲率离散化阶数 $k$ 进行比较。\n    3.  返回一个布尔标志，指示一致性条件 $\\lvert \\hat{p} - k \\rvert \\le \\tau$ 是否满足。\n- **假设与约定**：\n    - 所有量均为无量纲。\n    - 对数均为自然对数（$\\ln$）。\n    - 数据仅限于 $U_s > 0$ 和 $\\Delta x > 0$。\n    - 容差为 $\\tau = 0.3$。\n- **测试套件**：提供了五个测试案例，每个案例都有一组网格间距 $\\{\\Delta x_i\\}$、测量的幅值 $\\{U_s(\\Delta x_i)\\}$ 和一个理论曲率阶数 $k$。\n    - **案例 1**：$k = 2$，$\\Delta x = [0.05, 0.025, 0.0125, 0.00625]$，$U_s = [0.0012625, 0.00030625, 0.000079296875, 0.0000193359375]$。\n    - **案例 2**：$k = 1$，$\\Delta x = [0.05, 0.025, 0.0125, 0.00625]$，$U_s = [0.0412, 0.0196, 0.0101, 0.00485]$。\n    - **案例 3**：$k = 2$，$\\Delta x = [0.0625, 0.03125, 0.015625, 0.0078125, 0.00390625]$，$U_s = [0.0011484375, 0.000298828125, 0.00010986328125, 0.0000179443359375, 0.000004668189453125]$。\n    - **案例 4**：$k = 2$，$\\Delta x = [0.05, 0.025, 0.0125, 0.00625]$，$U_s = [0.00301, 0.00300, 0.00299, 0.00302]$。\n    - **案例 5**：$k = 2$，$\\Delta x = [0.02, 0.01]$，$U_s = [0.00016, 0.00004]$。\n- **实现要求**：通过最小二乘法估算 $\\hat{p}$，将其四舍五入到3位小数，并计算一致性标志。\n- **输出格式**：`[[\\hat{p}_1,k_1,\\mathrm{consistent}_1],[\\hat{p}_2,k_2,\\mathrm{consistent}_2],...]`。\n\n### 第二步：使用提取的已知信息进行验证\n根据既定的验证标准对问题进行评估。\n\n- **科学基础**：该问题牢固地植根于计算流体动力学领域，特别是在多相流和计算燃烧学的背景下。VOF方法、用于表面张力的CSF模型、伪电流以及用于确定收敛阶的网格加密研究等概念都是标准的、成熟的课题。将曲率离散化阶数（$k$）与伪电流速度缩放（$p$）联系起来的理论论证是合理的。该论证依赖于将Navier-Stokes方程线性化到斯托克斯流区域，这适用于低速、毛细作用主导的流动，以及将离散斯托克斯算子的逆视为从力误差到速度误差的有界映射。这个框架是数值分析和代码验证程序的基石。\n- **适定性**：该问题是适定的。目标是使用指定的确定性方法（普通最小二乘法）从给定数据集中估算参数。每个测试案例的输入都已明确定义，所需的输出也已明确规定。对于每个测试案例，估算参数 $\\hat{p}$ 和一致性检查都存在唯一解。\n- **客观性**：问题陈述使用精确、客观的语言编写，没有主观论断或含糊之处。\n- **完整性与一致性**：问题是自洽的。所有必要的数据，包括网格间距的数值、速度幅值、理论阶数 $k$ 和容差 $\\tau$，都已提供。所提供的信息中没有矛盾之处。\n- **真实性**：所提供的数值数据虽然可能是合成的，但代表了从实际CFD模拟中对伪电流现象进行网格加密研究得到的结果。数量级和缩放趋势是合理的。\n- **结构**：问题结构良好，引导求解者从理论原理到具体的算法实现和测试协议。\n\n### 第三步：结论与行动\n问题陈述具有科学性、适定性、客观性和完整性。它代表了多相流数值代码验证中的一个标准程序。因此，该问题被判定为**有效**。将开发并给出解决方案。\n\n### 解决方案\n\n解决方案包括两个主要部分：为伪电流缩放与曲率离散化之间的关系提供理论论证，然后设计一种算法从数值数据中估算这种缩放关系。\n\n**理论基础**\n\n不可压缩两相流系统的控制方程是Navier-Stokes方程。在没有外部体积力且雷诺数较低（斯托克斯极限）的情况下，稳态动量方程简化为压力梯度、粘性力与表面张力之间的平衡：\n$$ 0 = -\\nabla P + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{F}_{sv} $$\n其中 $P$ 是压力，$\\mu$ 是动力粘度，$\\mathbf{u}$ 是速度场，$\\mathbf{F}_{sv}$ 是表面张力，仅作用于流体-流体界面。该系统与不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$ 耦合。\n\n流体体积（VOF）法使用标量场 $\\alpha(\\mathbf{x}, t)$ 隐式追踪界面，该标量场表示计算单元中一种流体（例如液体）的体积分数。界面被定义为 $0  \\alpha  1$ 的区域。\n\n连续表面力（CSF）模型将奇异的表面张力 $\\mathbf{F}_{sv}$ 近似为作用于界面周围小体积上的连续体力：\n$$ \\mathbf{F}_{sv} \\approx \\sigma \\kappa_h \\mathbf{n}_h $$\n其中 $\\sigma$ 是表面张力系数。离散曲率 $\\kappa_h$ 和界面法向量 $\\mathbf{n}_h$ 是根据VOF场 $\\alpha$ 计算的。例如，$\\mathbf{n}_h = (\\nabla_h \\alpha) / |\\nabla_h \\alpha|$ 和 $\\kappa_h = -\\nabla_h \\cdot \\mathbf{n}_h$，其中 $\\nabla_h$ 是一个离散梯度算子。\n\n对于一个完全静态的球形液滴，精确解具有恒定的曲率和零速度，即 $\\mathbf{u} = \\mathbf{0}$。然而，计算 $\\kappa_h$ 时的离散误差以及在离散压力梯度与所得力之间进行平衡时产生的误差，会导致一个非零的残余力 $\\delta\\mathbf{F}_h$。这个残余力会驱动非物理的流动，即伪电流 $\\mathbf{u}_s$。\n\n此误差的主要来源通常是曲率的计算。如果曲率估算方案的形式精度阶为 $k$，则曲率误差与网格间距 $\\Delta x$ 的缩放关系为：\n$$ \\text{Error}(\\kappa_h) = \\kappa_h - \\kappa_{\\text{exact}} = \\mathcal{O}(\\Delta x^k) $$\n此曲率误差会传播到表面张力误差中，即 $\\delta\\mathbf{F}_h \\sim \\mathcal{O}(\\Delta x^k)$。将力映射到速度的离散化斯托克斯算子可以表示为一个矩阵 $\\mathbf{L}_h$。伪电流速度 $\\mathbf{u}_s$ 是方程 $\\mathbf{L}_h \\mathbf{u}_s = \\delta\\mathbf{F}_h$ 的解。由于斯托克斯算子是线性的，其逆 $\\mathbf{L}_h^{-1}$ 是一个有界算子。因此，所产生的速度大小与力误差的大小成线性关系：\n$$ U_s = ||\\mathbf{u}_s|| \\propto ||\\delta\\mathbf{F}_h|| \\propto \\text{Error}(\\kappa_h) \\propto \\Delta x^k $$\n因此，我们期望从关系 $U_s \\sim C \\Delta x^p$ 中经验观察到的缩放指数 $p$ 等于曲率方案的理论精度阶数，即 $p \\approx k$。这种关系是验证程序的基础。\n\n**算法设计**\n\n任务是通过从给定数据中估算 $p$ 来验证这一理论预期。提出的模型是 $U_s = C \\Delta x^p$。为了求出 $p$，我们通过对等式两边取自然对数来线性化此模型：\n$$ \\ln(U_s) = \\ln(C) + p \\ln(\\Delta x) $$\n此方程具有直线方程 $y = c + m x$ 的形式，其中：\n- $y = \\ln(U_s)$\n- $x = \\ln(\\Delta x)$\n- $m = p$ （斜率）\n- $c = \\ln(C)$ （y轴截距）\n\n给定一组 $N$ 个数据点 $(\\Delta x_i, U_{s,i})$，我们可以使用普通最小二乘（OLS）回归找到最佳拟合斜率 $\\hat{p}$。令 $x_i = \\ln(\\Delta x_i)$ 和 $y_i = \\ln(U_{s,i})$。斜率 $\\hat{p}$ 的OLS估计由下式给出：\n$$ \\hat{p} = \\frac{\\sum_{i=1}^N (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^N (x_i - \\bar{x})^2} $$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是 $x_i$ 和 $y_i$ 值的样本均值。\n\n在实践中，这可以通过建立一个线性系统来解决。我们寻求一个参数向量 $\\boldsymbol{\\beta} = [\\ln(C), p]^T$，以最小化系统 $\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{y}$ 的平方误差，其中：\n$$ \\mathbf{X} = \\begin{pmatrix} 1   \\ln(\\Delta x_1) \\\\ 1   \\ln(\\Delta x_2) \\\\ \\vdots   \\vdots \\\\ 1   \\ln(\\Delta x_N) \\end{pmatrix}, \\quad \\mathbf{y} = \\begin{pmatrix} \\ln(U_{s,1}) \\\\ \\ln(U_{s,2}) \\\\ \\vdots \\\\ \\ln(U_{s,N}) \\end{pmatrix} $$\n解由正规方程给出：$\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$。所得向量 $\\hat{\\boldsymbol{\\beta}}$ 的第二个元素就是我们想要的估计值 $\\hat{p}$。\n\n每个测试用例的算法流程如下：\n1.  接受输入的网格间距数组 `delta_x` 和速度幅值数组 `U_s`，以及理论阶数 `k`。\n2.  通过应用自然对数转换数据：`x = np.log(delta_x)` 和 `y = np.log(U_s)`。\n3.  通过将一列1与向量 `x` 堆叠来构造设计矩阵 $\\mathbf{X}$。\n4.  求解线性最小二乘问题以找到系数（截距和斜率）。斜率即为 $\\hat{p}$。\n5.  将估算出的斜率 $\\hat{p}$ 四舍五入到3位小数。\n6.  使用给定的容差 $\\tau = 0.3$ 将四舍五入后的 $\\hat{p}$ 与理论阶数 $k$ 进行比较。一致性由布尔表达式 $\\lvert \\hat{p} - k \\rvert \\le 0.3$ 确定。\n7.  将当前案例的结果打包成 $[\\hat{p}, k, \\text{consistent}]$。\n8.  将所有测试案例的结果汇总到一个最终列表中。\n\n此程序将针对五个提供的测试案例进行实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a grid refinement study to estimate the scaling exponent p of spurious currents\n    and compares it to a theoretical curvature discretization order k.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"delta_x\": np.array([0.05, 0.025, 0.0125, 0.00625]),\n            \"U_s\": np.array([0.0012625, 0.00030625, 0.000079296875, 0.0000193359375]),\n            \"k\": 2\n        },\n        {\n            \"delta_x\": np.array([0.05, 0.025, 0.0125, 0.00625]),\n            \"U_s\": np.array([0.0412, 0.0196, 0.0101, 0.00485]),\n            \"k\": 1\n        },\n        {\n            \"delta_x\": np.array([0.0625, 0.03125, 0.015625, 0.0078125, 0.00390625]),\n            \"U_s\": np.array([0.0011484375, 0.000298828125, 0.00010986328125, 0.0000179443359375, 0.000004668189453125]),\n            \"k\": 2\n        },\n        {\n            \"delta_x\": np.array([0.05, 0.025, 0.0125, 0.00625]),\n            \"U_s\": np.array([0.00301, 0.00300, 0.00299, 0.00302]),\n            \"k\": 2\n        },\n        {\n            \"delta_x\": np.array([0.02, 0.01]),\n            \"U_s\": np.array([0.00016, 0.00004]),\n            \"k\": 2\n        }\n    ]\n\n    tolerance = 0.3\n    results = []\n\n    for case in test_cases:\n        delta_x = case[\"delta_x\"]\n        U_s = case[\"U_s\"]\n        k = case[\"k\"]\n\n        # Step 1: Transform the data using natural logarithm\n        # y = log(U_s), x = log(delta_x)\n        # The model is log(U_s) = log(C) + p * log(delta_x)\n        log_delta_x = np.log(delta_x)\n        log_U_s = np.log(U_s)\n\n        # Step 2: Perform linear least squares regression\n        # We need to solve X * beta = y for beta, where beta = [intercept, slope]\n        # The design matrix X has a column of ones (for the intercept) and a column of log_delta_x.\n        A = np.vstack([log_delta_x, np.ones(len(log_delta_x))]).T\n        \n        # np.linalg.lstsq returns the solution, residuals, rank, and singular values.\n        # The solution vector contains the slope and the intercept.\n        p_hat, intercept = np.linalg.lstsq(A, log_U_s, rcond=None)[0]\n\n        # Step 3: Round p_hat to 3 decimal places\n        p_hat_rounded = round(p_hat, 3)\n\n        # Step 4: Compare p_hat with k using the tolerance\n        is_consistent = abs(p_hat_rounded - k) = tolerance\n\n        # Step 5: Store the results\n        results.append(f\"[{p_hat_rounded},{k},{str(is_consistent).lower()}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}