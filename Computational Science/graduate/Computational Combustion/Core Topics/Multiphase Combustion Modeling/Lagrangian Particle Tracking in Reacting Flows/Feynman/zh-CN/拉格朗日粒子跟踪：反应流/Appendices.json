{
    "hands_on_practices": [
        {
            "introduction": "在任何拉格朗日颗粒追踪研究中，首要步骤是确定颗粒是会跟随流体运动，还是会因其惯性而偏离。斯托克斯数（$Stk$）是量化这一行为的关键无量纲参数，它代表了颗粒响应时间与流体特征时间的比值。本练习  将指导你完成在典型的高压燃烧条件下对斯托克斯数的计算，这需要你综合考虑气体属性与滑移流效应。",
            "id": "4034575",
            "problem": "考虑一个直径为 $d_{p}$ 的碳烟颗粒，悬浮于高压、高温的预混甲烷-空气火焰中。气体压力为 $p$，气体温度为 $T$，平均流场具有特征速度尺度 $U$ 和特征长度尺度 $L$。假设颗粒为球形，其材料密度为 $\\rho_{p}$，周围气体处于连续流区，但存在需要滑移修正的有限克努森数（Knudsen数，Kn）效应，并且颗粒雷诺数足够小，使得线性（Stokes）曳力定律有效。忽略重力沉降、附加质量力、Basset历史力以及除曳力之外的任何体积力。\n\n从牛顿第二定律和连续流极限下小球的Stokes曳力定义出发，并结合经过充分验证的适用于有限克努森数的Cunningham滑移修正，推导颗粒速度弛豫时间，并用其与流场时间尺度的比值来构建Stokes数。使用理想气体和分子动理论基础计算气体平均自由程，并使用一个标准的空气高温粘度关系式。\n\n在以下物理上合理的燃烧室条件下，计算Stokes数：\n- 气体压力 $p = 2.0 \\times 10^{6}\\ \\mathrm{Pa}$（即 $20$ bar）。\n- 气体温度 $T = 1800\\ \\mathrm{K}$。\n- 颗粒直径 $d_{p} = 5.0 \\times 10^{-8}\\ \\mathrm{m}$。\n- 颗粒密度 $\\rho_{p} = 1800\\ \\mathrm{kg/m^{3}}$。\n- 流场速度尺度 $U = 20\\ \\mathrm{m/s}$。\n- 流场长度尺度 $L = 2.0 \\times 10^{-3}\\ \\mathrm{m}$。\n- Boltzmann常数 $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$。\n- 空气的代表性分子直径 $d_{g} = 3.7 \\times 10^{-10}\\ \\mathrm{m}$。\n\n对于空气的温变动力粘度，使用Sutherland定律，其参数为\n$ \\mu_{0} = 1.716 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$ （在 $T_{0} = 273\\ \\mathrm{K}$ 时）和Sutherland常数 $S = 111\\ \\mathrm{K}$。\n\n对于Cunningham滑移修正，使用系数 $A = 1.257$，$B = 0.4$ 和 $C = 1.1$。\n\n将最终的Stokes数表示为无量纲小数，并将答案四舍五入至四位有效数字。",
            "solution": "问题陈述被认为是有效的。它在科学上基于流体力学和分子动理论的既定原理，所提供的数据完备，问题是良定的，且其语言是客观的。对于计算燃烧学的特定背景，所给定的条件和参数在物理上是合理的。\n\n颗粒的运动遵循牛顿第二定律。根据问题陈述，我们只考虑作用在颗粒上的曳力 $\\vec{F}_D$。运动方程为：\n$$m_{p} \\frac{d\\vec{v}_{p}}{dt} = \\vec{F}_D$$\n其中 $m_p$ 是颗粒质量，$\\vec{v}_p$ 是颗粒速度。假设颗粒是一个直径为 $d_p$、密度为 $\\rho_p$ 的球体，因此其质量由下式给出：\n$$m_{p} = \\rho_{p} V_{p} = \\rho_{p} \\left( \\frac{1}{6}\\pi d_{p}^{3} \\right)$$\n在Stokes流态下，经过滑移流效应修正的曳力由下式给出：\n$$\\vec{F}_D = \\frac{3\\pi\\mu d_p}{C_c} (\\vec{v}_g - \\vec{v}_p)$$\n此处，$\\mu$ 是气体的动力粘度，$\\vec{v}_g$ 是当地气体速度，$C_c$ 是Cunningham滑移修正因子。将 $m_p$ 和 $\\vec{F}_D$ 的表达式代入运动方程，得到：\n$$\\rho_{p} \\left( \\frac{1}{6}\\pi d_{p}^{3} \\right) \\frac{d\\vec{v}_{p}}{dt} = \\frac{3\\pi\\mu d_p}{C_c} (\\vec{v}_g - \\vec{v}_p)$$\n将此方程重新整理成一阶线性常微分方程的标准形式，我们得到：\n$$\\frac{d\\vec{v}_{p}}{dt} = \\frac{18\\mu}{\\rho_{p} d_{p}^{2} C_c} (\\vec{v}_g - \\vec{v}_p)$$\n该方程描述了颗粒速度向气体速度的弛豫过程。速度差项的系数是颗粒速度弛豫时间 $\\tau_p$ 的倒数。\n$$\\tau_p = \\frac{\\rho_{p} d_{p}^{2} C_c}{18\\mu}$$\n特征流场时间尺度 $\\tau_f$ 由给定的流场速度尺度 $U$ 和长度尺度 $L$ 定义：\n$$\\tau_f = \\frac{L}{U}$$\nStokes数 $\\mathrm{Stk}$ 是颗粒弛豫时间与流场时间尺度的无量纲比值：\n$$\\mathrm{Stk} = \\frac{\\tau_p}{\\tau_f} = \\frac{\\left(\\frac{\\rho_{p} d_{p}^{2} C_c}{18\\mu}\\right)}{\\left(\\frac{L}{U}\\right)} = \\frac{\\rho_{p} d_{p}^{2} C_c U}{18\\mu L}$$\n为了计算Stokes数，我们必须首先计算 $\\mu$、$\\lambda$（气体平均自由程）、Knudsen数 $\\mathrm{Kn}$ 和 $C_c$。\n\n1.  **气体动力粘度 ($\\mu$)**\n    我们使用Sutherland定律及给定参数：$T = 1800\\ \\mathrm{K}$，$T_0 = 273\\ \\mathrm{K}$，$\\mu_0 = 1.716 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$ 和 $S = 111\\ \\mathrm{K}$。\n    $$\\mu = \\mu_0 \\left(\\frac{T}{T_0}\\right)^{\\frac{3}{2}} \\frac{T_0 + S}{T + S}$$\n    $$\\mu = (1.716 \\times 10^{-5}) \\left(\\frac{1800}{273}\\right)^{1.5} \\frac{273 + 111}{1800 + 111} = (1.716 \\times 10^{-5}) (6.5934)^{1.5} \\frac{384}{1911}$$\n    $$\\mu \\approx (1.716 \\times 10^{-5}) (16.963) (0.20094) \\approx 5.8504 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$$\n\n2.  **气体平均自由程 ($\\lambda$)**\n    根据理想气体的分子动理论，$\\lambda$ 由下式给出：\n    $$\\lambda = \\frac{k_B T}{\\sqrt{2} \\pi d_g^2 p}$$\n    使用所提供的值：$k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$，$T = 1800\\ \\mathrm{K}$，$d_g = 3.7 \\times 10^{-10}\\ \\mathrm{m}$ 和 $p = 2.0 \\times 10^6\\ \\mathrm{Pa}$。\n    $$\\lambda = \\frac{(1.380649 \\times 10^{-23}) (1800)}{\\sqrt{2} \\pi (3.7 \\times 10^{-10})^2 (2.0 \\times 10^6)}$$\n    $$\\lambda \\approx \\frac{2.48517 \\times 10^{-20}}{1.21853 \\times 10^{-12}} \\approx 2.0395 \\times 10^{-8}\\ \\mathrm{m}$$\n\n3.  **Knudsen数 ($\\mathrm{Kn}$)**\n    Knudsen数是平均自由程与颗粒直径 $d_p = 5.0 \\times 10^{-8}\\ \\mathrm{m}$ 的比值。\n    $$\\mathrm{Kn} = \\frac{\\lambda}{d_p} = \\frac{2.0395 \\times 10^{-8}}{5.0 \\times 10^{-8}} \\approx 0.4079$$\n    由于 $0.1  \\mathrm{Kn}  10$，流动处于滑移流区，这验证了使用Cunningham修正的合理性。\n\n4.  **Cunningham滑移修正因子 ($C_c$)**\n    修正因子由以下公式给出：\n    $$C_c = 1 + \\mathrm{Kn} [A + B \\exp(-C/\\mathrm{Kn})]$$\n    系数为 $A = 1.257$，$B = 0.4$，$C = 1.1$，以及 $\\mathrm{Kn} \\approx 0.4079$。\n    $$C_c = 1 + 0.4079 [1.257 + 0.4 \\exp(-1.1/0.4079)]$$\n    $$C_c \\approx 1 + 0.4079 [1.257 + 0.4 \\exp(-2.6967)]$$\n    $$C_c \\approx 1 + 0.4079 [1.257 + 0.4(0.06742)] \\approx 1 + 0.4079 [1.28397] \\approx 1.5237$$\n\n5.  **Stokes数 ($\\mathrm{Stk}$)**\n    最后，我们将所有值代入Stokes数的表达式中：$\\rho_p = 1800\\ \\mathrm{kg/m^3}$，$d_p = 5.0 \\times 10^{-8}\\ \\mathrm{m}$，$U = 20\\ \\mathrm{m/s}$，$L = 2.0 \\times 10^{-3}\\ \\mathrm{m}$，$\\mu \\approx 5.8504 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$ 和 $C_c \\approx 1.5237$。\n    $$\\mathrm{Stk} = \\frac{\\rho_{p} d_{p}^{2} C_c U}{18\\mu L}$$\n    $$\\mathrm{Stk} = \\frac{(1800) (5.0 \\times 10^{-8})^2 (1.5237) (20)}{18 (5.8504 \\times 10^{-5}) (2.0 \\times 10^{-3})}$$\n    $$\\mathrm{Stk} = \\frac{(1800) (2.5 \\times 10^{-15}) (1.5237) (20)}{18 (5.8504 \\times 10^{-5}) (2.0 \\times 10^{-3})} \\approx \\frac{1.3713 \\times 10^{-10}}{2.1061 \\times 10^{-6}}$$\n    $$\\mathrm{Stk} \\approx 6.5109 \\times 10^{-5}$$\n    将此结果表示为小数并四舍五入到四位有效数字，得到 $0.00006511$。",
            "answer": "$$\\boxed{0.00006511}$$"
        },
        {
            "introduction": "在反应流，特别是火焰锋面附近，存在着强烈的温度和组分浓度梯度，这些梯度会诱导产生非曳力，即热泳力（thermophoresis）和扩散泳力（diffusiophoresis）。这些力可以显著改变颗粒的轨迹，即使在颗粒惯性可以忽略的情况下也是如此。本练习  要求你通过平衡这些泳力与粘性曳力，推导并计算颗粒的稳态速度，从而揭示颗粒在强梯度区域中如何相对于气体运动。",
            "id": "4034609",
            "problem": "在一维预混氢氧反应气体中，一个球形烟尘颗粒在拉格朗日框架内被追踪。在预热区的 $x_{0}$ 位置，气体以 $u_{x}(x_{0}) = 0.25\\,\\mathrm{m/s}$ 的速度沿 $+x$ 方向流动，温度梯度为 $\\partial T/\\partial x \\big|_{x_{0}} = 8.0 \\times 10^{5}\\,\\mathrm{K/m}$，氢摩尔数密度的对数梯度为 $\\partial \\ln n_{\\mathrm{H_{2}}}/\\partial x \\big|_{x_{0}} = -1.5 \\times 10^{4}\\,\\mathrm{m^{-1}}$。气体动力粘度为 $\\mu = 4.0 \\times 10^{-5}\\,\\mathrm{Pa \\cdot s}$。颗粒直径为 $d_{p} = 1.0 \\times 10^{-7}\\,\\mathrm{m}$，材料密度为 $\\rho_{p} = 1.8 \\times 10^{3}\\,\\mathrm{kg/m^{3}}$。假设处于连续介质区，滑移修正、重力和浮力均可忽略不计。\n\n由于施加的梯度，颗粒受到热泳和扩散泳效应的影响。设连续介质区的热泳和扩散泳相互作用由特定于材料的迁移率 $M_{T} = 5.0 \\times 10^{-19}\\,\\mathrm{N \\cdot m \\cdot K^{-1}}$ 和 $M_{D} = 3.0 \\times 10^{-16}\\,\\mathrm{N \\cdot m}$ 分别表征。如果有适当的时间尺度推理支持，则忽略颗粒惯性。\n\n从 Newton 第二定律和低 Reynolds 数下小球的 Stokes 阻力定义出发，推导由热泳和扩散泳联合作用对抗粘性阻力所产生的稳态拉格朗日颗粒在 $x$ 方向的速度 $v_{p,x}(x_{0})$，然后使用上述参数进行数值计算。最终速度以米/秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且自洽。\n\n**问题验证**\n\n**步骤 1：提取的已知条件**\n-   颗粒追踪框架：拉格朗日\n-   流动介质：一维预混氢氧反应气体\n-   流动方向：$+x$\n-   关注位置：$x_{0}$\n-   $x_{0}$ 处的气体速度：$u_{x}(x_{0}) = 0.25\\,\\mathrm{m/s}$\n-   $x_{0}$ 处的温度梯度：$\\frac{\\partial T}{\\partial x} \\big|_{x_{0}} = 8.0 \\times 10^{5}\\,\\mathrm{K/m}$\n-   $x_{0}$ 处的氢摩尔数密度的对数梯度：$\\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x} \\big|_{x_{0}} = -1.5 \\times 10^{4}\\,\\mathrm{m^{-1}}$\n-   气体动力粘度：$\\mu = 4.0 \\times 10^{-5}\\,\\mathrm{Pa \\cdot s}$\n-   颗粒直径：$d_{p} = 1.0 \\times 10^{-7}\\,\\mathrm{m}$\n-   颗粒材料密度：$\\rho_{p} = 1.8 \\times 10^{3}\\,\\mathrm{kg/m^{3}}$\n-   假设：连续介质区，滑移修正、重力和浮力可忽略不计。\n-   热泳迁移率：$M_{T} = 5.0 \\times 10^{-19}\\,\\mathrm{N \\cdot m \\cdot K^{-1}}$\n-   扩散泳迁移率：$M_{D} = 3.0 \\times 10^{-16}\\,\\mathrm{N \\cdot m}$\n-   惯性处理：若有时间尺度推理支持则忽略。\n\n**步骤 2：验证分析**\n该问题描述了一个小颗粒在粘性阻力、热泳和扩散泳作用下的运动。这些是气溶胶科学和燃烧学中已确立的物理现象。所提供的梯度和材料属性的数值在火焰锋面环境的合理范围内。\n\n问题通过“迁移率”来定义热泳和扩散泳相互作用，这是一种非标准的表述。然而，该表述可以形式化为具有一致单位的力的表达式。我们假设热泳力 $F_{T,x}$ 和扩散泳力 $F_{D,x}$ 由以下公式给出：\n$F_{T,x} = -M_{T} \\frac{\\partial T}{\\partial x}$\n$F_{D,x} = -M_{D} \\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x}$\n$F_{T,x}$ 的单位是 $(\\mathrm{N \\cdot m \\cdot K^{-1}}) \\cdot (\\mathrm{K \\cdot m^{-1}}) = \\mathrm{N}$，这是一个力的单位。\n$F_{D,x}$ 的单位是 $(\\mathrm{N \\cdot m}) \\cdot (\\mathrm{m^{-1}}) = \\mathrm{N}$，这也是一个力的单位。\n因此，这些定义在数学上是自洽的。\n\n对于直径为 $d_{p} = 1.0 \\times 10^{-7}\\,\\mathrm{m}$ 的颗粒，“连续介质区”的假设在大气压下通常不成立，因为 Knudsen 数会大于1。然而，问题可能隐含地假设了高压条件（例如，约100个大气压），此时气体平均自由程会足够小，从而满足连续介质假设（$Kn \\ll 1$）。由于问题明确指出要假设连续介质区，我们遵循这一指示进行。\n\n问题要求为忽略颗粒惯性提供理由。这可以通过比较颗粒动量弛豫时间 $\\tau_{p}$ 和特征流动时间 $\\tau_{f}$ 来实现。\n颗粒弛豫时间由 $\\tau_{p} = \\frac{\\rho_{p} d_{p}^{2}}{18\\mu}$ 给出。\n代入给定值：\n$$ \\tau_{p} = \\frac{(1.8 \\times 10^{3}\\,\\mathrm{kg/m^{3}}) (1.0 \\times 10^{-7}\\,\\mathrm{m})^{2}}{18 (4.0 \\times 10^{-5}\\,\\mathrm{Pa \\cdot s})} = \\frac{1.8 \\times 10^{-11}}{7.2 \\times 10^{-4}}\\,\\mathrm{s} = 2.5 \\times 10^{-8}\\,\\mathrm{s} $$\n特征流动时间可以从梯度的长度尺度和气体速度估算。浓度梯度的长度尺度为 $L_{c} = \\left| (\\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x})^{-1} \\right| = (1.5 \\times 10^{4})^{-1}\\,\\mathrm{m} \\approx 6.7 \\times 10^{-5}\\,\\mathrm{m}$。\n则流动时间尺度为 $\\tau_{f} = \\frac{L_{c}}{u_{x}} = \\frac{6.7 \\times 10^{-5}\\,\\mathrm{m}}{0.25\\,\\mathrm{m/s}} \\approx 2.7 \\times 10^{-4}\\,\\mathrm{s}$。\nStokes 数 $Stk = \\frac{\\tau_{p}}{\\tau_{f}} = \\frac{2.5 \\times 10^{-8}\\,\\mathrm{s}}{2.7 \\times 10^{-4}\\,\\mathrm{s}} \\approx 9.3 \\times 10^{-5}$。\n由于 $Stk \\ll 1$，颗粒几乎瞬时响应流场的变化。因此，忽略颗粒惯性并假设稳态力平衡是完全合理的。\n\n**步骤 3：结论**\n问题被认为是有效的。它在其自身的明确假设下是自洽的、可科学地形式化的，并且是适定的。我们可以继续进行求解。\n\n**推导与求解**\n\n颗粒在 $x$ 方向的运动由 Newton 第二定律描述：\n$$ m_{p} \\frac{d v_{p,x}}{dt} = \\sum F_{x} $$\n其中 $m_{p}$ 是颗粒质量，$v_{p,x}$ 是拉格朗日颗粒速度。作用在颗粒上的力包括 Stokes 阻力（$F_{\\text{drag}}$）、热泳力（$F_{T,x}$）和扩散泳力（$F_{D,x}$）。\n\n如上文所述，颗粒惯性可以忽略，因此我们可以假设一个稳态力平衡，其中合力为零：\n$$ \\sum F_{x} = F_{\\text{drag}} + F_{T,x} + F_{D,x} = 0 $$\n这些力的定义如下：\n$1.$ 连续介质区中球体的 Stokes 阻力为：\n$$ F_{\\text{drag}} = -3\\pi\\mu d_{p} (v_{p,x} - u_{x}) $$\n其中 $(v_{p,x} - u_{x})$ 是颗粒与气体之间的滑移速度。\n\n$2$. 根据问题中使用迁移率 $M_{T}$ 的定义，热泳力的方向与温度梯度相反：\n$$ F_{T,x} = -M_{T} \\frac{\\partial T}{\\partial x} $$\n\n$3$. 根据问题中使用迁移率 $M_{D}$ 的定义，扩散泳力的方向与数密度对数的梯度相反：\n$$ F_{D,x} = -M_{D} \\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x} $$\n\n将这些力的表达式代入 $x_{0}$ 位置的力平衡方程：\n$$ -3\\pi\\mu d_{p} (v_{p,x}(x_{0}) - u_{x}(x_{0})) - M_{T} \\frac{\\partial T}{\\partial x} \\bigg|_{x_{0}} - M_{D} \\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x} \\bigg|_{x_{0}} = 0 $$\n我们的目标是求解拉格朗日颗粒速度 $v_{p,x}(x_{0})$。重新整理方程：\n$$ 3\\pi\\mu d_{p} (v_{p,x}(x_{0}) - u_{x}(x_{0})) = -M_{T} \\frac{\\partial T}{\\partial x} \\bigg|_{x_{0}} - M_{D} \\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x} \\bigg|_{x_{0}} $$\n$$ v_{p,x}(x_{0}) - u_{x}(x_{0}) = -\\frac{1}{3\\pi\\mu d_{p}} \\left( M_{T} \\frac{\\partial T}{\\partial x} \\bigg|_{x_{0}} + M_{D} \\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x} \\bigg|_{x_{0}} \\right) $$\n最终，颗粒速度的表达式为：\n$$ v_{p,x}(x_{0}) = u_{x}(x_{0}) - \\frac{1}{3\\pi\\mu d_{p}} \\left( M_{T} \\frac{\\partial T}{\\partial x} \\bigg|_{x_{0}} + M_{D} \\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x} \\bigg|_{x_{0}} \\right) $$\n现在，我们将给定的数值代入此表达式。\n阻力系数项为：\n$$ 3\\pi\\mu d_{p} = 3\\pi(4.0 \\times 10^{-5}\\,\\mathrm{Pa \\cdot s})(1.0 \\times 10^{-7}\\,\\mathrm{m}) = 1.2\\pi \\times 10^{-11}\\,\\mathrm{N \\cdot s \\cdot m^{-1}} \\approx 3.7699 \\times 10^{-11}\\,\\mathrm{N \\cdot s \\cdot m^{-1}} $$\n括号中的热泳力项为：\n$$ M_{T} \\frac{\\partial T}{\\partial x} \\bigg|_{x_{0}} = (5.0 \\times 10^{-19}\\,\\mathrm{N \\cdot m \\cdot K^{-1}})(8.0 \\times 10^{5}\\,\\mathrm{K/m}) = 4.0 \\times 10^{-13}\\,\\mathrm{N} $$\n括号中的扩散泳力项为：\n$$ M_{D} \\frac{\\partial \\ln n_{\\mathrm{H_{2}}}}{\\partial x} \\bigg|_{x_{0}} = (3.0 \\times 10^{-16}\\,\\mathrm{N \\cdot m})(-1.5 \\times 10^{4}\\,\\mathrm{m^{-1}}) = -4.5 \\times 10^{-12}\\,\\mathrm{N} $$\n泳力项的总和为：\n$$ 4.0 \\times 10^{-13}\\,\\mathrm{N} - 4.5 \\times 10^{-12}\\,\\mathrm{N} = 0.4 \\times 10^{-12}\\,\\mathrm{N} - 4.5 \\times 10^{-12}\\,\\mathrm{N} = -4.1 \\times 10^{-12}\\,\\mathrm{N} $$\n现在，我们计算滑移速度 $v_{p,x}(x_{0}) - u_{x}(x_{0})$：\n$$ v_{p,x}(x_{0}) - u_{x}(x_{0}) = -\\frac{-4.1 \\times 10^{-12}\\,\\mathrm{N}}{1.2\\pi \\times 10^{-11}\\,\\mathrm{N \\cdot s \\cdot m^{-1}}} = \\frac{4.1 \\times 10^{-12}}{3.7699 \\times 10^{-11}}\\,\\mathrm{m/s} \\approx 0.108756\\,\\mathrm{m/s} $$\n最后，我们计算颗粒速度 $v_{p,x}(x_{0})$：\n$$ v_{p,x}(x_{0}) = u_{x}(x_{0}) + 0.108756\\,\\mathrm{m/s} = 0.25\\,\\mathrm{m/s} + 0.108756\\,\\mathrm{m/s} = 0.358756\\,\\mathrm{m/s} $$\n按要求四舍五入到四位有效数字：\n$$ v_{p,x}(x_{0}) \\approx 0.3588\\,\\mathrm{m/s} $$\n热泳力作用于 $-x$ 方向（沿着温度梯度降低的方向），而扩散泳力作用于 $+x$ 方向（与轻组分 $H_2$ 的梯度相反）。扩散泳效应占主导地位，导致颗粒的运动速度快于周围气体。",
            "answer": "$$\\boxed{0.3588}$$"
        },
        {
            "introduction": "拉格朗日模拟会产生包含海量颗粒状态的数据集，而从这些数据中提取有意义的统计信息是计算建模的关键一环。例如，在分析湍流非预混火焰时，我们常常需要了解在给定混合分数下（$Z=z$）的平均温度 $\\mathbb{E}[T \\mid Z=z]$。本练习  的重点是从模拟颗粒运动的物理模型转向数据后处理，要求你推导并实现一个基于核函数的统计估计器来计算条件平均值，这是解释和理解计算结果的核心技能。",
            "id": "4034629",
            "problem": "给定一个反应性非预混火焰的拉格朗日表示，其中计算粒子沿平流和扩散控制的轨迹携带热化学状态。混合分数被建模为一个守恒标量，温度通过热释放而演化。目标是通过对粒子系综进行统计采样，使用一个从第一性原理推导出的、有科学依据的估计器，来估计给定混合分数下的温度条件均值。您必须实现一个程序，通过一个基于核的估计器从粒子数据计算条件均值温度，该估计器应尊重混合分数的有界域并使用粒子质量加权，然后为指定的测试套件生成所要求的输出。\n\n此任务的基础由以下内容给出：\n- 使用牛顿运动学（即 $\\frac{d\\boldsymbol{X}}{dt} = \\boldsymbol{u}(\\boldsymbol{X},t)$）以及形式为 $\\frac{d\\phi}{dt} = \\text{源项} + \\text{扩散}$ 的标量演化定律，来描述粒子位置和标量状态沿拉格朗日轨迹的守恒。\n- 混合分数 $Z$ 是一个有界的、无量纲的守恒标量（无化学源项），在欧拉层面上遵循平流-扩散方程，而温度 $T$ 通过能量平衡方程 $\\frac{dT}{dt} = \\frac{\\dot{q}}{\\rho c_p} + \\text{扩散}$ 演化，其中 $\\dot{q}$ 是体积热释放率，$\\rho$ 是密度，$c_p$ 是比热。\n- 在拉格朗日蒙特卡洛表示中，一个由质量为 $w_i  0$ 的粒子组成的系综通过狄拉克测度的和来近似 $Z$ 和 $T$ 的联合分布。\n\n您的任务是：\n- 基于上述基础和条件期望的标准定义，为条件均值温度 $\\mathbb{E}[T \\mid Z = z]$ 推导一个可从粒子数据 $\\{(Z_i, T_i, w_i)\\}_{i=1}^N$ 实现的估计器。该估计器必须：\n  - 基于用一个带宽 $h  0$ 严格为正的平滑核来替换狄拉克测度，\n  - 通过边界修正来尊重物理域 $Z \\in [0,1]$，确保在 $Z=0$ 和 $Z=1$ 附近没有人为的质量损失，\n  - 包含粒子质量加权 $w_i$，\n  - 包括一个数值上合理的正则化方法，以避免除以零，同时在有足够数据时不会扭曲估计值。\n- 实现此估计器，以计算指定查询混合分数处的条件均值温度。所有报告的温度必须以开尔文为单位，并四舍五入到三位小数。\n\n在您的推导和实现中使用的定义和约束：\n- 条件均值 $\\mathbb{E}[T \\mid Z=z]$ 是根据 $T$ 和 $Z$ 的联合分布定义的，并且可以使用狄拉克测度和对粒子的系综平均来表示。\n- 核函数必须是带宽为 $h$ 的高斯核。混合分数域为 $Z \\in [0,1]$，必须通过与反射边界条件一致的适当边界修正来处理，不允许概率泄漏到域外。\n- 粒子温度 $T$ 应被视为以开尔文为单位的物理量。混合分数 $Z$ 是无量纲的。\n- 对粒子使用质量权重 $w_i$。当在某个查询值处的有效核权重在数值上可忽略不计时，应用一个物理上合理的正则化方案，该方案保持与系综的一致性。\n\n测试套件规范：\n您必须实现该估计器，并为以下三个测试用例计算条件均值温度。每个测试用例包含粒子状态和权重、一组查询混合分数以及一个核带宽。\n\n- 测试用例 $\\mathbf{A}$（类层流非预混火焰剖面）：\n  - 粒子数：$N = 100$。\n  - 粒子混合分数：对于 $i=0,1,\\dots,N-1$，_Z_i = \\frac{i}{N-1}$，因此 $Z_i \\in [0,1]$。\n  - 粒子温度（开尔文）：$$T_i = 300 + 1600\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.06}{0.08}\\right)^2\\right) + 50\\,\\sin(2\\pi Z_i).$$\n  - 粒子权重：对于所有 $i$，$w_i = 1$。\n  - 查询混合分数：$z_q \\in \\{0.0, 0.06, 0.5, 1.0\\}$。\n  - 核带宽：$h = 0.05$。\n\n- 测试用例 $\\mathbf{B}$（双峰和局部熄火结构）：\n  - 粒子数：$N = 80$。\n  - 粒子混合分数：对于 $i=0,1,\\dots,N-1$，$Z_i = \\frac{i}{N-1}$。\n  - 粒子温度（开尔文）：$$T_i = 300 + 1500\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.06}{0.04}\\right)^2\\right) - 600\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.06}{0.01}\\right)^2\\right) + 400\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.7}{0.05}\\right)^2\\right).$$\n  - 粒子权重：对于所有 $i$，$w_i = 1$。\n  - 查询混合分数：$z_q \\in \\{0.06, 0.7\\}$。\n  - 核带宽：$h = 0.04$。\n\n- 测试用例 $\\mathbf{C}$（靠近边界相关区域且具有非均匀质量权重的稀疏粒子簇）：\n  - 粒子数：$N = 40$。\n  - 粒子混合分数：$$Z_i = 0.2 + 0.02\\,\\cos\\!\\left(\\frac{2\\pi i}{N}\\right), \\quad i=0,1,\\dots,N-1,$$ 这会得到 $Z_i \\in [0.18, 0.22]$。\n  - 粒子温度（开尔文）：$$T_i = 300 + 1000\\,Z_i.$$\n  - 粒子权重：$$w_i = 1 + 0.5\\,\\cos(4\\pi Z_i), \\quad \\text{因此 } w_i \\in [0.5, 1.5].$$\n  - 查询混合分数：$z_q \\in \\{0.0, 0.1, 0.9, 1.0\\}$。\n  - 核带宽：$h = 0.06$。\n\n程序要求：\n- 实现上述估计器，并将其应用于所有测试用例。对于每个测试用例，计算指定查询混合分数处的条件均值温度列表，以开尔文表示并四舍五入到三位小数。\n- 最终输出格式：您的程序应生成一行输出，包含一个用方括号括起来的、由逗号分隔的列表，其中条目是对应于每个测试用例的浮点数列表，例如 `[[T_A,1,T_A,2,...],[T_B,1,T_B,2],[T_C,1,...]]`。仅打印一行，不含任何额外文本。",
            "solution": "用户希望基于一组拉格朗日粒子数据，推导并实现一个基于核的估计器，用于计算一个标量（温度 $T$）在另一个标量（混合分数 $Z$）给定值下的条件均值。该问题设置在计算燃烧学的背景下。\n\n### 步骤 1：问题验证\n\n#### 提取给定信息\n- **任务**：从粒子数据 $\\{(Z_i, T_i, w_i)\\}_{i=1}^N$ 推导并实现一个用于条件均值温度 $\\mathbb{E}[T \\mid Z = z]$ 的估计器。\n- **估计器要求**：\n    1.  基于核，使用带宽为 $h  0$ 的高斯核。\n    2.  对域 $Z \\in [0,1]$ 进行边界修正，与反射边界一致。\n    3.  包含粒子质量权重 $w_i  0$。\n    4.  采用数值正则化以处理除以零或接近零的情况。\n- **物理背景**：\n    - 具有位置 $\\boldsymbol{X}$、混合分数 $Z$、温度 $T$ 和质量 $w_i$ 的拉格朗日粒子。\n    - 混合分数 $Z$ 是一个守恒标量，有界于 $[0,1]$。\n    - 温度 $T$ 随热释放和扩散而演化。\n- **定义与约束**：\n    - 条件均值通过 $T$ 和 $Z$ 的联合分布定义。\n    - 核：高斯核，带宽 $h$。\n    - 域：$Z \\in [0,1]$。\n    - 输出：温度以开尔文为单位，四舍五入到三位小数。\n- **测试用例**：\n    - **用例 A**：$N = 100$。$Z_i = \\frac{i}{N-1}$ 对于 $i=0, \\dots, N-1$。$T_i = 300 + 1600\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.06}{0.08}\\right)^2\\right) + 50\\,\\sin(2\\pi Z_i)$。$w_i = 1$。查询 $z_q \\in \\{0.0,\\,0.06,\\,0.5,\\,1.0\\}$。带宽 $h = 0.05$。\n    - **用例 B**：$N = 80$。$Z_i = \\frac{i}{N-1}$ 对于 $i=0, \\dots, N-1$。$T_i = 300 + 1500\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.06}{0.04}\\right)^2\\right) - 600\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.06}{0.01}\\right)^2\\right) + 400\\,\\exp\\!\\left(-\\left(\\frac{Z_i - 0.7}{0.05}\\right)^2\\right)$。$w_i = 1$。查询 $z_q \\in \\{0.06,\\,0.7\\}$。带宽 $h = 0.04$。\n    - **用例 C**：$N = 40$。$Z_i = 0.2 + 0.02\\,\\cos\\!\\left(\\frac{2\\pi i}{N}\\right)$ 对于 $i=0, \\dots, N-1$。$T_i = 300 + 1000\\,Z_i$。$w_i = 1 + 0.5\\,\\cos(4\\pi Z_i)$。查询 $z_q \\in \\{0.0,\\,0.1,\\,0.9,\\,1.0\\}$。带宽 $h = 0.06$。\n- **输出格式**：单行打印一个浮点数列表的列表，例如 $[[T_{A,1}, \\dots], [T_{B,1}, \\dots], [T_{C,1}, \\dots]]$。\n\n#### 使用提取的给定信息进行验证\n根据验证标准评估该问题。\n- **科学性**：该问题牢固地植根于统计力学、计算流体动力学和燃烧理论领域。拉格朗日粒子法、混合分数形式体系和核密度估计都是标准的科学工具。这些概念在物理和数学上都是合理的。\n- **良构性**：该问题是完全指定的。它提供了理论基础、估计器的精确要求以及三个不同测试用例的完整数值数据。目标是计算一个确定性的数值结果，这是明确定义的。\n- **客观性**：问题陈述使用了精确、无歧义的科学语言。定义和约束是定量的和客观的。\n\n该问题没有表现出任何无效性缺陷：\n1.  **科学或事实不健全**：无。物理和数学都是标准的。\n2.  **不可形式化或不相关**：问题高度可形式化，并且是指定主题的核心。\n3.  **不完整或矛盾的设置**：无。所有必要信息都已提供。\n4.  **不切实际或不可行**：无。粒子数据和物理参数虽然是合成的，但代表了模拟中遇到的情况。\n5.  **病态或结构不良**：无。任务导向一个唯一、稳定且有意义的解。\n6.  **伪深刻、琐碎或同义反复**：问题是实质性的，要求推导一个具有特定约束（边界修正、加权、正则化）的非平凡统计估计器，并进行仔细实现。\n7.  **超出科学可验证性范围**：结果是计算确定性的，并且是可验证的。\n\n#### 结论与行动\n该问题是有效的。将提供一个完整、合理的解决方案。\n\n### 基于原理的解决方案推导和算法设计\n\n目标是推导一个用于在给定混合分数 $Z=z$ 条件下，温度 $T$ 的条件期望 $\\mathbb{E}[T \\mid Z=z]$ 的估计器。\n\n**1. 条件期望的正式定义**\n根据定义，给定 $Z=z$ 时 $T$ 的条件期望是 $T$ 在条件概率分布 $p(T \\mid z)$ 上的平均值：\n$$ \\mathbb{E}[T \\mid Z=z] = \\int T p(T \\mid z) \\, dT $$\n使用关系 $p(T \\mid z) = p(T, z) / p(z)$，其中 $p(T, z)$ 是联合概率密度函数 (PDF)，$p(z)$ 是 $Z$ 的边际 PDF，我们有：\n$$ \\mathbb{E}[T \\mid Z=z] = \\frac{\\int T p(T, z) \\, dT}{p(z)} $$\n\n**2. 拉格朗日粒子近似**\n在拉格朗日粒子法中，联合 PDF $p(T, Z)$ 由一个离散的 $N$ 个粒子集合来近似，每个粒子携带一个质量 $w_i$ 并具有状态 $(Z_i, T_i)$。这表示为加权狄拉克δ函数的和：\n$$ p(T, Z) \\approx \\frac{1}{W} \\sum_{i=1}^N w_i \\delta(Z - Z_i) \\delta(T - T_i) $$\n其中 $W = \\sum_{j=1}^N w_j$ 是系综的总质量。\n\n将此代入分子和分母的表达式中：\n- 分母（$Z$ 的边际 PDF）：$p(z) = \\int p(T, z) \\, dT \\approx \\frac{1}{W} \\sum_{i=1}^N w_i \\delta(z - Z_i)$\n- 分子：$\\int T p(T, z) \\, dT \\approx \\frac{1}{W} \\sum_{i=1}^N w_i T_i \\delta(z - Z_i)$\n\n这导致一个原始的、未平滑的表示，该表示是奇异的，并且仅在粒子位置 $Z_i$ 处有定义。\n\n**3. 核密度估计**\n为了获得一个平滑、连续的估计，我们用一个平滑的核函数 $K_h(u) = \\frac{1}{h}K(\\frac{u}{h})$ 来替换狄拉克δ函数 $\\delta(u)$，其中 $h$ 是带宽。问题指定了一个高斯核，其 $K(u) = \\frac{1}{\\sqrt{2\\pi}} e^{-u^2/2}$。条件均值的估计器，即Nadaraya-Watson估计器，变为：\n$$ \\hat{\\mathbb{E}}[T \\mid Z=z] = \\frac{\\sum_{i=1}^N w_i T_i K_h(z - Z_i)}{\\sum_{i=1}^N w_i K_h(z - Z_i)} $$\n总质量 $W$ 和来自核的归一化常数在分子和分母之间被抵消。\n\n**4. 有界域的边界修正**\n混合分数 $Z$ 被限制在域 $[0,1]$ 内。在边界附近居中的标准核会将其概率质量“泄漏”到该域之外，导致有偏估计。问题要求一个与反射边界条件一致的修正。这通过反射法实现，该方法在边界处添加“虚拟”粒子进行反射，以确保域内的总概率守恒。\n\n对于位于 $Z_i$ 的粒子和查询点 $z \\in [0,1]$，我们考虑它关于边界 $Z=0$（位于 $-Z_i$）和边界 $Z=1$（位于 $1+(1-Z_i) = 2-Z_i$）的反射。存在更高阶的反射，但对于像高斯这样快速衰减的核，它们的贡献可以忽略不计。从粒子 $i$ 到点 $z$ 的有效、经边界修正的核贡献是主核及其反射图像的总和：\n$$ K_{eff}(z, Z_i; h) = K_h(z - Z_i) + K_h(z - (-Z_i)) + K_h(z - (2-Z_i)) $$\n$$ K_{eff}(z, Z_i; h) = K_h(z - Z_i) + K_h(z + Z_i) + K_h(z - 2 + Z_i) $$\n由于高斯核是对称的，即 $K_h(u) = K_h(-u)$，这等效于 $K_h(z - Z_i) + K_h(z + Z_i) + K_h(2 - z - Z_i)$。在实现上，使用一个与核成比例的函数进行计算会很方便，因为常数因子会被抵消。令 $G(u; h) = \\exp\\left(-\\frac{u^2}{2h^2}\\right)$。从粒子 $i$ 对查询点 $z$ 的有效权重与以下成正比：\n$$ G_{eff}(z, Z_i; h) = G(z-Z_i; h) + G(z+Z_i; h) + G(z-(2-Z_i); h) $$\n\n**5. 完整的估计器公式**\n将经过边界修正的有效核权重代入Nadaraya-Watson公式，得到最终的估计器：\n$$ \\hat{\\mathbb{E}}[T \\mid Z=z] = \\frac{\\sum_{i=1}^N w_i T_i G_{eff}(z, Z_i; h)}{\\sum_{i=1}^N w_i G_{eff}(z, Z_i; h)} $$\n\n**6. 正则化**\n如果查询点 $z$ 远离所有粒子位置 $Z_i$，带宽 $h$ 可能太小，以至于没有任何粒子能做出显著贡献。在这种情况下，分母 $D(z) = \\sum_{i=1}^N w_i G_{eff}(z, Z_i; h)$ 在数值上可能与零无法区分，导致除零错误。一个有物理原则的正则化方法是返回可用的最佳估计，即整个粒子系综的无条件平均温度：\n$$ \\bar{T}_{ensemble} = \\frac{\\sum_{k=1}^N w_k T_k}{\\sum_{k=1}^N w_k} $$\n算法将按如下方式实现：\n如果 $D(z)  \\epsilon_{tol}$，其中 $\\epsilon_{tol}$ 是一个很小的数值容差（例如 $10^{-12}$），则估计的温度是 $\\bar{T}_{ensemble}$。否则，使用上述比率计算该值。这种方法确保了数值稳定性，并在数据稀疏区域提供了一个物理上有意义的结果。\n\n**7. 算法实现**\n实现将遵循以下步骤：\n- 对每个测试用例，生成粒子数据数组 $\\{Z_i\\}$、$\\{T_i\\}$ 和 $\\{w_i\\}$。\n- 对每个查询点 $z_q$：\n    1.  计算高斯函数的参数向量：$u_1 = z_q - Z_i$、$u_2 = z_q + Z_i$ 和 $u_3 = z_q - (2 - Z_i)$。\n    2.  使用这些参数和带宽 $h$ 计算所有粒子的有效核权重 $G_{eff}$。\n    3.  使用向量化求和计算分子 $N(z_q) = \\sum w_i T_i G_{eff}(z_q, Z_i; h)$ 和分母 $D(z_q) = \\sum w_i G_{eff}(z_q, Z_i; h)$。\n    4.  应用正则化：如果 $D(z_q)$ 低于容差，则使用预先计算的系综平均温度。否则，计算比率 $N(z_q)/D(z_q)$。\n    5.  将最终温度四舍五入到三位小数。\n- 收集所有测试用例的结果，并将其格式化为指定的输出字符串。\n\n该算法设计将推导出的原理直接转化为一个稳健的数值程序。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to compute and print results for all test cases.\n    \"\"\"\n\n    def get_test_cases():\n        \"\"\"\n        Generates the particle data and parameters for all three test cases.\n        \"\"\"\n        cases = []\n\n        # Test case A\n        N_A = 100\n        z_i_A = np.linspace(0.0, 1.0, N_A)\n        T_i_A = 300.0 + 1600.0 * np.exp(-((z_i_A - 0.06) / 0.08)**2) + 50.0 * np.sin(2 * np.pi * z_i_A)\n        w_i_A = np.ones(N_A)\n        z_q_A = [0.0, 0.06, 0.5, 1.0]\n        h_A = 0.05\n        cases.append(((z_i_A, T_i_A, w_i_A), z_q_A, h_A))\n\n        # Test case B\n        N_B = 80\n        z_i_B = np.linspace(0.0, 1.0, N_B)\n        T_i_B = (300.0 + 1500.0 * np.exp(-((z_i_B - 0.06) / 0.04)**2) -\n                 600.0 * np.exp(-((z_i_B - 0.06) / 0.01)**2) +\n                 400.0 * np.exp(-((z_i_B - 0.7) / 0.05)**2))\n        w_i_B = np.ones(N_B)\n        z_q_B = [0.06, 0.7]\n        h_B = 0.04\n        cases.append(((z_i_B, T_i_B, w_i_B), z_q_B, h_B))\n\n        # Test case C\n        N_C = 40\n        i_C = np.arange(N_C)\n        z_i_C = 0.2 + 0.02 * np.cos(2 * np.pi * i_C / N_C)\n        T_i_C = 300.0 + 1000.0 * z_i_C\n        w_i_C = 1.0 + 0.5 * np.cos(4 * np.pi * z_i_C)\n        z_q_C = [0.0, 0.1, 0.9, 1.0]\n        h_C = 0.06\n        cases.append(((z_i_C, T_i_C, w_i_C), z_q_C, h_C))\n        \n        return cases\n\n    def compute_conditional_mean(particle_data, query_points, h, epsilon=1e-12):\n        \"\"\"\n        Computes the conditional mean temperature using a boundary-corrected kernel estimator.\n\n        Args:\n            particle_data (tuple): Contains particle Z, T, and w as numpy arrays.\n            query_points (list): A list of Z values at which to evaluate the mean.\n            h (float): The kernel bandwidth.\n            epsilon (float): Tolerance for regularization.\n\n        Returns:\n            list: A list of computed conditional mean temperatures, rounded.\n        \"\"\"\n        Z_particles, T_particles, w_particles = particle_data\n        results = []\n\n        # Pre-calculate the regularized value (unconditional ensemble mean)\n        # This is the fallback for data-sparse regions.\n        total_mass = np.sum(w_particles)\n        if total_mass > 0:\n            unconditional_mean_T = np.sum(w_particles * T_particles) / total_mass\n        else: # Handle case of zero total mass, though problem givens w_i > 0\n            unconditional_mean_T = 0.0\n\n        for zq in query_points:\n            # G(u; h) = exp(-u^2 / (2*h^2))\n            inv_2h_sq = 1.0 / (2.0 * h**2)\n            \n            # Primary kernel term\n            u1 = zq - Z_particles\n            k1 = np.exp(-u1**2 * inv_2h_sq)\n            \n            # Boundary reflection at Z=0\n            u2 = zq + Z_particles\n            k2 = np.exp(-u2**2 * inv_2h_sq)\n\n            # Boundary reflection at Z=1\n            u3 = zq - (2.0 - Z_particles)\n            k3 = np.exp(-u3**2 * inv_2h_sq)\n            \n            # Effective kernel weight with boundary correction\n            k_eff = k1 + k2 + k3\n            \n            # Numerator of the Nadaraya-Watson estimator\n            numerator = np.sum(w_particles * T_particles * k_eff)\n            \n            # Denominator of the Nadaraya-Watson estimator\n            denominator = np.sum(w_particles * k_eff)\n            \n            # Apply regularization if denominator is close to zero\n            if denominator  epsilon:\n                cond_mean_T = unconditional_mean_T\n            else:\n                cond_mean_T = numerator / denominator\n            \n            results.append(round(cond_mean_T, 3))\n            \n        return results\n\n    all_results = []\n    test_cases = get_test_cases()\n\n    for p_data, z_q, h in test_cases:\n        case_results = compute_conditional_mean(p_data, z_q, h)\n        all_results.append(case_results)\n\n    # Format the final output string as required\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}