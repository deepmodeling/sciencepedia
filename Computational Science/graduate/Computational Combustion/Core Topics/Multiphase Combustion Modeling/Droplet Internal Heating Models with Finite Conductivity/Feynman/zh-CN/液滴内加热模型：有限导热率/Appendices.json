{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的液滴内部加热数值模型之前，一个关键的初步步骤是判断内部温度梯度是否显著。本练习将指导您通过量纲分析，推导出关键的无量纲数——毕渥数（Biot number），并理解它如何界定液滴加热的两种不同物理机制。掌握这种标度分析方法对于快速评估物理问题的主导因素和简化模型至关重要。 ",
            "id": "4022167",
            "problem": "考虑一个半径为 $R$ 的单组分球形液态燃料滴，在燃烧过程中浸没在高温气体环境中。液体的物性恒定：密度 $\\rho_{\\ell}$、定压比热容 $c_{p,\\ell}$、热导率 $k_{\\ell}$ 以及热扩散率 $\\alpha_{\\ell} = k_{\\ell}/(\\rho_{\\ell} c_{p,\\ell})$。液滴表面的气侧热传输通过牛顿对流边界进行建模，其传热系数为 $h_{g}$，远场气体温度为 $T_{g}$，该温度在空间上均匀且不随时间变化。忽略质量传递、相变、辐射以及液体内部的任何热源或热汇；假设轴对称性和气体性质的空间均匀性。内部液体温度场 $T_{\\ell}(r,t)$ 遵循傅里叶传导的能量守恒定律，而表面热通量遵循牛顿冷却定律。\n\n从液体的能量守恒和傅里叶定律出发，写出液体中的控制性瞬态热方程以及在 $r=R$ 处的对流边界条件，然后使用长度尺度 $R$、液滴与气体之间的特征温差 $\\Delta T$ 以及液体的特征扩散时间尺度对问题进行无量纲化。识别无量纲化后边界条件前面的那个无量纲数群，并通过数量级分析，仅使用物性 $\\rho_{\\ell}$, $c_{p,\\ell}$, $k_{\\ell}$, $R$, 和 $h_{g}$，将其物理解释为内部扩散和外部对流时间尺度的比值。\n\n基于该比值，说明区分近乎均匀的内部温度响应与强烈不均匀的内部温度响应的两种状态，并确定这些状态之间的数量级边界。作为最终答案，报告用于量化内部扩散与外部对流时间尺度之比的无量纲数群的闭合形式解析表达式，并将其简化为仅包含 $h_{g}$、$R$ 和 $k_{\\ell}$。不需要进行数值计算。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它代表了瞬态热传导中的一个标准问题，没有任何使其无效的缺陷。\n\n球形液滴内的温度场 $T_{\\ell}(r,t)$ 受能量守恒原理控制。在球坐标系中，假设温度仅依赖于径向坐标 $r$ 和时间 $t$（由于指定的对称性），并且在没有内部热源的情况下，热扩散方程为：\n$$\n\\rho_{\\ell} c_{p,\\ell} \\frac{\\partial T_{\\ell}}{\\partial t} = \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 k_{\\ell} \\frac{\\partial T_{\\ell}}{\\partial r} \\right)\n$$\n鉴于液体物性 $\\rho_{\\ell}$、$c_{p,\\ell}$ 和 $k_{\\ell}$ 是常数，我们可以使用热扩散率 $\\alpha_{\\ell} = k_{\\ell}/(\\rho_{\\ell} c_{p,\\ell})$ 来重写该方程：\n$$\n\\frac{\\partial T_{\\ell}}{\\partial t} = \\frac{\\alpha_{\\ell}}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial T_{\\ell}}{\\partial r} \\right)\n$$\n这就是液相的控制性瞬态热方程。\n\n该方程的边界条件如下：\n1. 在球心处，$r=0$，由于对称性，温度梯度必须为零，以确保温度保持有限且热通量不为奇异值。\n$$\n\\left. \\frac{\\partial T_{\\ell}}{\\partial r} \\right|_{r=0} = 0\n$$\n2. 在液滴表面处，$r=R$，从液体内部传导到表面的热量必须与从高温气体对流到表面的热量相平衡。这是一个使用傅里葉传导定律和牛顿冷却定律表示的能量平衡：\n$$\n-k_{\\ell} \\left. \\frac{\\partial T_{\\ell}}{\\partial r} \\right|_{r=R} = h_{g} (T_{g} - T_{\\ell}(R, t))\n$$\n\n为了对问题进行无量纲化，我们引入以下无量纲变量。设液滴的初始均匀温度为 $T_{0}$。一个自然的选择是取特征温差为 $\\Delta T = T_{g} - T_{0}$。\n- 无量纲半径：$\\eta = \\frac{r}{R}$\n- 无量纲温度：$\\Theta = \\frac{T_{\\ell}(r,t) - T_{0}}{T_{g} - T_{0}}$\n- 无量纲时间：$\\tau = \\frac{t}{\\tau_{diff}} = \\frac{t}{R^2 / \\alpha_{\\ell}} = \\frac{t \\alpha_{\\ell}}{R^2}$，其中特征时间尺度是液相扩散时间 $\\tau_{diff}$。\n\n现在我们变换导数：\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = \\frac{\\alpha_{\\ell}}{R^2} \\frac{\\partial}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial}{\\partial r} = \\frac{\\partial \\eta}{\\partial r} \\frac{\\partial}{\\partial \\eta} = \\frac{1}{R} \\frac{\\partial}{\\partial \\eta}\n$$\n将这些代入控制方程：\n$$\n\\frac{\\alpha_{\\ell}}{R^2} \\frac{\\partial (\\Theta(T_g - T_0) + T_0)}{\\partial \\tau} = \\frac{\\alpha_{\\ell}}{(R\\eta)^2} \\frac{1}{R}\\frac{\\partial}{\\partial \\eta} \\left( (R\\eta)^2 \\frac{1}{R} \\frac{\\partial (\\Theta(T_g - T_0) + T_0)}{\\partial \\eta} \\right)\n$$\n由于 $T_g$ 和 $T_0$ 是常数，方程简化为：\n$$\n\\frac{\\alpha_{\\ell}(T_g - T_0)}{R^2} \\frac{\\partial \\Theta}{\\partial \\tau} = \\frac{\\alpha_{\\ell}(T_g - T_0)}{R^2 \\eta^2} \\frac{\\partial}{\\partial \\eta} \\left( \\eta^2 \\frac{\\partial \\Theta}{\\partial \\eta} \\right)\n$$\n消去公因子，得到无量纲控制方程：\n$$\n\\frac{\\partial \\Theta}{\\partial \\tau} = \\frac{1}{\\eta^2} \\frac{\\partial}{\\partial \\eta} \\left( \\eta^2 \\frac{\\partial \\Theta}{\\partial \\eta} \\right)\n$$\n\n接下来，我们变换边界条件。\n1. 在 $r=0$ 处（对应于 $\\eta=0$）：\n$$\n\\left. \\frac{1}{R} \\frac{\\partial (\\Theta(T_g - T_0) + T_0)}{\\partial \\eta} \\right|_{\\eta=0} = 0 \\implies \\left. \\frac{\\partial \\Theta}{\\partial \\eta} \\right|_{\\eta=0} = 0\n$$\n2. 在 $r=R$ 处（对应于 $\\eta=1$）：\n$$\n-k_{\\ell} \\left. \\frac{1}{R} \\frac{\\partial (\\Theta(T_g - T_0) + T_0)}{\\partial \\eta} \\right|_{\\eta=1} = h_{g} (T_{g} - (\\Theta(1,\\tau)(T_g-T_0) + T_0))\n$$\n$$\n-k_{\\ell} \\frac{T_g-T_0}{R} \\left. \\frac{\\partial \\Theta}{\\partial \\eta} \\right|_{\\eta=1} = h_{g} (T_g - T_0 - \\Theta(1,\\tau)(T_g-T_0))\n$$\n$$\n-k_{\\ell} \\frac{T_g-T_0}{R} \\left. \\frac{\\partial \\Theta}{\\partial \\eta} \\right|_{\\eta=1} = h_{g} (T_g - T_0) (1 - \\Theta(1,\\tau))\n$$\n消去 $(T_g-T_0)$ 项并重新整理，我们得到表面的无量纲边界条件：\n$$\n\\left. \\frac{\\partial \\Theta}{\\partial \\eta} \\right|_{\\eta=1} = -\\frac{h_{g} R}{k_{\\ell}} (1 - \\Theta(1,\\tau))\n$$\n边界条件前面的单一无量纲数群是 $\\frac{h_{g} R}{k_{\\ell}}$。这就是毕渥数（Biot number），记为 $Bi$。\n\n为了物理解释这个数群，我们进行数量级分析，以找到内部和外部时间尺度的比值。\n热量在液滴半径 $R$ 内扩散的特征时间是内部扩散时间尺度 $\\tau_{diff}$：\n$$\n\\tau_{diff} \\sim \\frac{R^2}{\\alpha_{\\ell}} = \\frac{R^2 \\rho_{\\ell} c_{p,\\ell}}{k_{\\ell}}\n$$\n由于外部对流导致液滴热能变化的特征时间是外部对流时间尺度 $\\tau_{conv}$。这是液滴的热能含量与来自气体的传热速率之比。\n$$\n\\text{热能含量} \\sim (\\text{体积} \\times \\rho_{\\ell}) c_{p,\\ell} \\Delta T \\sim (\\frac{4}{3} \\pi R^3 \\rho_{\\ell}) c_{p,\\ell} \\Delta T\n$$\n$$\n\\text{传热速率} \\sim h_{g} \\times \\text{表面积} \\times \\Delta T \\sim h_{g} (4 \\pi R^2) \\Delta T\n$$\n时间尺度是它们的比值：\n$$\n\\tau_{conv} \\sim \\frac{\\frac{4}{3} \\pi R^3 \\rho_{\\ell} c_{p,\\ell} \\Delta T}{h_{g} (4 \\pi R^2) \\Delta T} = \\frac{\\rho_{\\ell} c_{p,\\ell} R}{3 h_{g}}\n$$\n对于数量级估算，忽略常数因子，$\\tau_{conv} \\sim \\frac{\\rho_{\\ell} c_{p,\\ell} R}{h_{g}}$。\n\n内部扩散时间尺度与外部对流时间尺度之比为：\n$$\n\\frac{\\tau_{diff}}{\\tau_{conv}} \\sim \\frac{R^2 \\rho_{\\ell} c_{p,\\ell} / k_{\\ell}}{\\rho_{\\ell} c_{p,\\ell} R / h_{g}} = \\left( \\frac{R^2 \\rho_{\\ell} c_{p,\\ell}}{k_{\\ell}} \\right) \\left( \\frac{h_{g}}{\\rho_{\\ell} c_{p,\\ell} R} \\right) = \\frac{h_{g} R^2}{k_{\\ell} R} = \\frac{h_{g} R}{k_{\\ell}}\n$$\n这个比值恰好是毕渥数，$Bi = h_{g} R/k_{\\ell}$。因此，毕渥数可以物理解释为内部（液侧）导热热阻与外部（气侧）对流换热热阻之比，或者等效地，解释为内部热扩散的特征时间与外部热对流的特征时间之比。\n\n基于这个比值，可以确定两种不同的加热状态：\n1. **近乎均匀的内部温度 ($Bi \\ll 1$)**：当毕渥数很小时，$\\tau_{diff} \\ll \\tau_{conv}$。热量在液滴内部的扩散速度远快于从气体供给的速度。因此，任何内部温度梯度都会迅速被抹平，液滴的温度在空间上是均匀的，$T_{\\ell}(r,t) \\approx T_{\\ell}(t)$。这就是“热薄”或“集总电容”状态。\n2. **强烈不均匀的内部温度 ($Bi \\gg 1$)**：当毕渥数很大时，$\\tau_{diff} \\gg \\tau_{conv}$。供给到表面的热量远快于其向内部传导的速度。这导致产生大的温度梯度，表面温度显著高于中心温度。这就是“热厚”或“传导受限”状态，此时必须求解完整的偏微分方程。\n\n这两种状态之间的数量级边界出现在时间尺度（或热阻）相当时，即 $Bi \\sim 1$。在实际工程分析中，当 $Bi  0.1$ 时，集总电容法通常被认为是有效的。\n\n题目要求的最终表达式是量化内部扩散与外部对流时间尺度之比的无量纲数群，简化为只包含 $h_{g}$、$R$ 和 $k_{\\ell}$。如前所导，这就是毕渥数。",
            "answer": "$$\n\\boxed{\\frac{h_{g} R}{k_{\\ell}}}\n$$"
        },
        {
            "introduction": "当确定有限热导率效应不可忽略时，我们就需要求解耦合的内外部传热问题。本练习将带您亲手构建一个迭代求解器，用于处理一个包含内部热源的稳态液滴加热问题。您将学习如何处理随温度变化的物性，并实现一个稳健的耦合算法来求解液滴表面温度，这是计算燃烧学中的一项核心技能。 ",
            "id": "4022129",
            "problem": "考虑一个半径为 $R$、具有有限热导率 $k_\\ell$ 的单组分、球对称液滴，悬浮在热气流中。由于辐射吸收或放热反应等内部过程，该液滴经历均匀的体积内加热 $\\dot{q}'''$。假设液滴内部为稳态传热，并忽略液体内部的对流；因此，在球对称条件下，径向坐标 $r \\in [0,R]$ 的液体温度场 $T(r)$ 的控制方程是带有均匀体积热生成的稳态传导能量方程：\n$$\n\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dT}{dr}\\right) = -\\frac{\\dot{q}'''}{k_\\ell}.\n$$\n边界条件为中心正则性条件 ($r=0$) 和表面界面能量平衡 ($r=R$)：\n$$\n\\text{finite}\\left(\\frac{dT}{dr}\\right)\\bigg|_{r \\to 0}, \\quad -k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R} = h_g(T_s; T_\\infty)\\,\\big(T_s - T_\\infty\\big),\n$$\n其中 $T_s = T(R)$ 是未知的液滴表面温度，$T_\\infty$ 是边界层边缘的气体温度。\n\n在气体侧，使用强制对流关联式来计算气体侧的对流传热系数 $h_g$。设特征长度为液滴直径 $d = 2R$。使用 Ranz–Marshall 形式的努塞尔数 $Nu$ 作为雷诺数 $Re$ 和普朗特数 $Pr$ 的函数：\n$$\nNu = 2 + 0.6\\,Re^{1/2}\\,Pr^{1/3}.\n$$\n计算 $h_g$ 如下：\n$$\nh_g = \\frac{Nu\\,k_g(T_f)}{d},\n$$\n其中 $k_g(T_f)$ 是在膜温 $T_f = (T_\\infty + T_s)/2$ 下计算的气体热导率。通过幂律模型来描述气体性质的温度依赖性\n$$\nk_g(T) = k_{g,ref}\\left(\\frac{T}{T_{ref}}\\right)^{\\beta_k}, \\quad \\mu_g(T) = \\mu_{g,ref}\\left(\\frac{T}{T_{ref}}\\right)^{\\beta_\\mu},\n$$\n设气体比热 $c_{p,g}$ 为常数，普朗特数定义为\n$$\nPr = \\frac{c_{p,g}\\,\\mu_g(T_f)}{k_g(T_f)}.\n$$\n\n您的任务是设计并实现一个耦合数值求解器，该求解器在气体侧对流（通过膜温 $T_f$ 基于 $T_s$ 更新 $h_g$）和液体侧传导边值问题（更新 $T_s$）之间进行迭代，直至收敛。您必须：\n- 从第一性原理出发：执行带有内部加热的球形传导方程和界面能量平衡。\n- 使用上述气体侧性质模型和 $Nu$ 关联式，将 $h_g$ 计算为 $T_s$ 当前估计值的函数。\n- 迭代求解一致的 $T_s$，使得界面能量通量与内部传导解相平衡。\n\n提出并实现一个针对 $T_s$ 的收敛准则，该准则结合了连续迭代变化和界面能量残差。具体来说，当以下两个条件同时满足时，终止迭代：\n- 连续迭代中表面温度的绝对变化满足 $\\lvert T_s^{(n+1)} - T_s^{(n)} \\rvert  \\varepsilon_T$，其中 $\\varepsilon_T = 10^{-6}$，单位为开尔文（$\\mathrm{K}$）。\n- 绝对界面能量残差满足\n$$\n\\left|h_g(T_s^{(n+1)};T_\\infty)\\left(T_s^{(n+1)}-T_\\infty\\right) + k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R}\\right|  \\varepsilon_q \\,\\max\\left(\\left|h_g(T_s^{(n+1)};T_\\infty)\\left(T_s^{(n+1)}-T_\\infty\\right)\\right|, \\left|\\;k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R}\\right|, 10^{-12} \\right),\n$$\n其中 $\\varepsilon_q = 10^{-8}$，导数 $\\left.dT/dr\\right|_{r=R}$ 取自与均匀体积加热一致的液体侧传导解。\n\n实现该求解器，并将其应用于以下参数集的测试套件。在所有情况下，温度以开尔文（$\\mathrm{K}$）表示，长度以米（$\\mathrm{m}$）表示，动力粘度以帕斯卡·秒（$\\mathrm{Pa\\,s}$）表示，热导率以瓦特每米开尔文（$\\mathrm{W/(m\\cdot K)}$）表示，比热以焦耳每千克开尔文（$\\mathrm{J/(kg\\cdot K)}$）表示，体积加热以瓦特每立方米（$\\mathrm{W/m^3}$）表示。按指示使用指数 $\\beta_k$ 和 $\\beta_\\mu$。每个测试用例指定 $(R, \\dot{q}''', T_\\infty, Re, c_{p,g}, k_{g,ref}, \\mu_{g,ref}, T_{ref}, \\beta_k, \\beta_\\mu, k_\\ell)$:\n\n- 案例A（中等流速，中等加热，类水液体）：\n  - $R = 5\\times10^{-4}$, $\\dot{q}''' = 5\\times10^{6}$, $T_\\infty = 1000$, $Re = 50$, $c_{p,g} = 1100$, $k_{g,ref} = 0.05$, $\\mu_{g,ref} = 4.0\\times10^{-5}$, $T_{ref} = 1000$, $\\beta_k = 0.9$, $\\beta_\\mu = 0.7$, $k_\\ell = 0.6$.\n- 案例B（小液滴，高流速，强加热）：\n  - $R = 5\\times10^{-5}$, $\\dot{q}''' = 1\\times10^{7}$, $T_\\infty = 1200$, $Re = 200$, $c_{p,g} = 1100$, $k_{g,ref} = 0.055$, $\\mu_{g,ref} = 4.5\\times10^{-5}$, $T_{ref} = 1200$, $\\beta_k = 0.9$, $\\beta_\\mu = 0.7$, $k_\\ell = 0.6$.\n- 案例C（无内部加热的边界情况）：\n  - $R = 1\\times10^{-3}$, $\\dot{q}''' = 0$, $T_\\infty = 900$, $Re = 100$, $c_{p,g} = 1100$, $k_{g,ref} = 0.05$, $\\mu_{g,ref} = 4.0\\times10^{-5}$, $T_{ref} = 900$, $\\beta_k = 0.9$, $\\beta_\\mu = 0.7$, $k_\\ell = 0.15$.\n- 案例D（大液滴，弱流速，中等加热，类燃料液体）：\n  - $R = 2\\times10^{-3}$, $\\dot{q}''' = 3\\times10^{6}$, $T_\\infty = 1000$, $Re = 10$, $c_{p,g} = 1100$, $k_{g,ref} = 0.05$, $\\mu_{g,ref} = 4.0\\times10^{-5}$, $T_{ref} = 1000$, $\\beta_k = 0.9$, $\\beta_\\mu = 0.7$, $k_\\ell = 0.15$.\n\n您的程序必须使用上述耦合迭代方法计算每个案例的收敛 $T_s$。为保证数值稳定性，您可以使用不动点迭代或简单的松弛方案，但必须强制执行所述的收敛准则。最终输出格式必须是单行，包含四个案例的收敛表面温度，形式为用方括号括起来的逗号分隔列表，每个条目均四舍五入到三位小数，单位为开尔文。例如，\n$[T_{s,A},T_{s,B},T_{s,C},T_{s,D}]$,\n其中每个 $T_{s,\\cdot}$ 均四舍五入到三位小数，并以 $\\mathrm{K}$ 为单位表示。",
            "solution": "用户提供了一个问题陈述，要求为涉及带内部热生成的液滴的耦合传热问题开发一个数值求解器。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- **控制方程（液体侧传导）：**\n$$\n\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dT}{dr}\\right) = -\\frac{\\dot{q}'''}{k_\\ell}\n$$\n其中 $T(r)$ 是 $r \\in [0,R]$ 的温度分布，$\\dot{q}'''$ 是均匀体积热生成率，$k_\\ell$ 是液体热导率。\n\n- **边界条件（液体侧）：**\n1.  中心正则性条件：$\\text{finite}\\left(\\frac{dT}{dr}\\right)\\bigg|_{r \\to 0}$\n2.  表面界面能量平衡 ($r=R$)：$$-k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R} = h_g(T_s; T_\\infty)\\,\\big(T_s - T_\\infty\\big)$$\n   其中 $T_s = T(R)$ 是表面温度，$T_\\infty$ 是环境气体温度。\n\n- **气体侧传热系数 ($h_g$)：**\n- 液滴直径 $d = 2R$。\n- 努塞尔数关联式 (Ranz–Marshall 型)：$Nu = 2 + 0.6\\,Re^{1/2}\\,Pr^{1/3}$。\n- $h_g$ 的定义：$h_g = \\frac{Nu\\,k_g(T_f)}{d}$。\n- 膜温：$T_f = (T_\\infty + T_s)/2$。\n\n- **气体性质模型（幂律）：**\n- 气体热导率：$k_g(T) = k_{g,ref}\\left(\\frac{T}{T_{ref}}\\right)^{\\beta_k}$。\n- 气体动力粘度：$\\mu_g(T) = \\mu_{g,ref}\\left(\\frac{T}{T_{ref}}\\right)^{\\beta_\\mu}$。\n- 气体比热 $c_{p,g}$ 为常数。\n- 普朗特数：$Pr = \\frac{c_{p,g}\\,\\mu_g(T_f)}{k_g(T_f)}$。\n\n- **收敛准则：**\n对 $T_s$ 的迭代必须在两个条件都满足时终止：\n1.  绝对温度变化：$\\lvert T_s^{(n+1)} - T_s^{(n)} \\rvert  \\varepsilon_T$，其中 $\\varepsilon_T = 10^{-6}\\,\\mathrm{K}$。\n2.  相对能量残差：\n$$\n\\left|h_g(T_s^{(n+1)};T_\\infty)\\left(T_s^{(n+1)}-T_\\infty\\right) + k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R}\\right|  \\varepsilon_q \\,\\max\\left(\\left|h_g(T_s^{(n+1)};T_\\infty)\\left(T_s^{(n+1)}-T_\\infty\\right)\\right|, \\left|\\;k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R}\\right|, 10^{-12} \\right)\n$$\n其中 $\\varepsilon_q = 10^{-8}$。\n\n- **测试用例：**\n提供了标记为 A、B、C 和 D 的四组参数集 $(R, \\dot{q}''', T_\\infty, Re, c_{p,g}, k_{g,ref}, \\mu_{g,ref}, T_{ref}, \\beta_k, \\beta_\\mu, k_\\ell)$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据指定标准验证问题：\n- **科学依据：** 该问题基于传热（传导和对流）的基本原理。控制方程是带有源项的稳态热方程在球坐标系下的标准形式。边界条件代表了物理约束（原点处的有限性，界面处的能量守恒）。气体侧关联式（Ranz-Marshall）和性质模型（幂律）是针对此类问题的标准、成熟的工程公式。该问题在科学上是合理的。\n- **适定性：** 该问题将一个可解的液体侧温度边值问题与一个气体侧传热的代数耦合条件相结合。这为未知表面温度 $T_s$ 形成了一个定义明确的系统。对于此类耦合问题，迭代解是一种标准且合适的方法，有望收敛到唯一解。\n- **客观性：** 问题陈述使用了精确的数学和物理术语，所有参数和标准都进行了量化定义。没有主观或含糊的陈述。\n- **不完整或矛盾的设置：** 问题是自洽的。每个测试用例所需的所有方程、常数和参数都已明确提供。收敛标准清晰明确。\n- **不切实际或不可行：** 所提供的物理参数在液滴加热和燃烧研究的现实范围内。\n\n### 步骤3：结论与行动\n问题在科学上有效、适定且完整。将开发一个解决方案。\n\n### 基于原理的解决方案设计\n\n#### 1. 液体侧温度分布的解析解\n首先，我们求解液滴内部温度分布 $T(r)$ 的常微分方程。控制方程为：\n$$\n\\frac{d}{dr}\\left(r^2 \\frac{dT}{dr}\\right) = -\\frac{\\dot{q}''' r^2}{k_\\ell}\n$$\n对 $r$ 积分一次得到：\n$$\nr^2 \\frac{dT}{dr} = -\\frac{\\dot{q}''' r^3}{3k_\\ell} + C_1\n$$\n第一个边界条件要求温度梯度 $\\frac{dT}{dr}$ 在中心 ($r=0$) 处是有限的。为此，积分常数 $C_1$ 必须为零。如果 $C_1 \\neq 0$，那么当 $r \\to 0$ 时，$\\frac{dT}{dr}$ 将与 $1/r^2$ 成正比，这是奇异的。因此，$C_1=0$。\n于是温度梯度为：\n$$\n\\frac{dT}{dr} = -\\frac{\\dot{q}''' r}{3k_\\ell}\n$$\n第二次积分得到温度分布：\n$$\nT(r) = -\\frac{\\dot{q}''' r^2}{6k_\\ell} + C_2\n$$\n第二个积分常数 $C_2$ 可以通过应用表面条件 $T(R)=T_s$ 来确定。\n$$\nT_s = -\\frac{\\dot{q}''' R^2}{6k_\\ell} + C_2 \\implies C_2 = T_s + \\frac{\\dot{q}''' R^2}{6k_\\ell}\n$$\n将 $C_2$ 代回 $T(r)$ 的表达式，得到液滴内部的最终温度分布，作为表面温度 $T_s$ 的函数：\n$$\nT(r) = T_s + \\frac{\\dot{q}'''}{6k_\\ell}(R^2 - r^2)\n$$\n\n#### 2. 界面能量平衡与表面温度方程\n液滴表面 ($r=R$) 的第二个边界条件是界面能量平衡，即从液体传导至表面的热量等于从表面对流至气体的热量：\n$$\n-k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R} = h_g(T_s - T_\\infty)\n$$\n从液体传导至表面的热通量 $-k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R}$ 可以使用我们的温度梯度表达式来计算：\n$$\n-k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R} = -k_\\ell\\left(-\\frac{\\dot{q}''' R}{3k_\\ell}\\right) = \\frac{\\dot{q}''' R}{3}\n$$\n该项代表液滴体积内生成的总热量 $\\dot{Q}_{gen} = \\dot{q}'''(\\frac{4}{3}\\pi R^3)$ 除以表面积 $A_s = 4\\pi R^2$。\n将此结果代入能量平衡方程得到：\n$$\n\\frac{\\dot{q}''' R}{3} = h_g(T_s - T_\\infty)\n$$\n这个方程代数地将未知表面温度 $T_s$ 与传热系数 $h_g$ 联系起来。我们可以重新排列它以显式表示 $T_s$，这将构成我们迭代更新方案的基础：\n$$\nT_s = T_\\infty + \\frac{\\dot{q}''' R}{3h_g}\n$$\n注意，对于特殊情况 $\\dot{q}'''=0$，该方程立即得出 $T_s = T_\\infty$。\n\n#### 3. 气体侧对流传热 ($h_g$)\n传热系数 $h_g$ 不是恒定的；它依赖于气体性质，而气体性质又依赖于膜温 $T_f = (T_\\infty + T_s)/2$。因此，$h_g$ 是 $T_s$ 的函数。对于给定的 $T_s$，计算 $h_g$ 的步骤如下：\n1.  计算膜温：$T_f = (T_\\infty + T_s)/2$。\n2.  使用给定的幂律在 $T_f$ 下评估气体热导率和粘度：\n    $$ k_g(T_f) = k_{g,ref}\\left(\\frac{T_f}{T_{ref}}\\right)^{\\beta_k}, \\quad \\mu_g(T_f) = \\mu_{g,ref}\\left(\\frac{T_f}{T_{ref}}\\right)^{\\beta_\\mu} $$\n3.  计算普朗特数：$Pr = \\frac{c_{p,g}\\,\\mu_g(T_f)}{k_g(T_f)}$。\n4.  使用 Ranz-Marshall 关联式计算努塞尔数：$Nu = 2 + 0.6\\,Re^{1/2}\\,Pr^{1/3}$。每个案例的雷诺数 $Re$ 是给定的常数。\n5.  计算传热系数：$h_g = \\frac{Nu\\,k_g(T_f)}{d}$，其中 $d=2R$。\n\n#### 4. 耦合迭代算法\n$T_s$ 和 $h_g$ 的方程是耦合的：$T_s$ 依赖于 $h_g$，$h_g$ 依赖于 $T_s$。这表明可以使用不动点迭代方案来寻找自洽解。\n\n1.  **初始化**：从表面温度的初始猜测值 $T_s^{(0)}$ 开始。一个自然的选择是环境气体温度，$T_s^{(0)} = T_\\infty$。设置迭代计数器 $n=0$。\n\n2.  **迭代循环**：对 $n=0, 1, 2, \\dots$ 重复，直到收敛：\n    a. 给定当前估计值 $T_s^{(n)}$，使用第 3 节中描述的步骤计算相应的传热系数 $h_g^{(n)}$。\n    b. 使用这个 $h_g^{(n)}$，通过第 2 节的公式找到表面温度的下一个估计值 $T_s^{(n+1)}$：\n       $$ T_s^{(n+1)} = T_\\infty + \\frac{\\dot{q}''' R}{3h_g^{(n)}} $$\n    c. **检查收敛性**：\n       - 计算温度变化：$\\Delta T_s = \\lvert T_s^{(n+1)} - T_s^{(n)} \\rvert$。\n       - 在新温度 $T_s^{(n+1)}$ 下计算能量残差的各项：\n         - 气体侧通量：$q''_{g} = h_g(T_s^{(n+1)})(T_s^{(n+1)}-T_\\infty)$，其中 $h_g(T_s^{(n+1)})$ 是使用 $T_s^{(n+1)}$ 计算的。\n         - 进入界面的液体侧通量：$q''_{\\ell,in} = k_\\ell\\left.\\frac{dT}{dr}\\right|_{r=R} = -\\frac{\\dot{q}''' R}{3}$。\n       - 计算绝对残差：$R_q = |q''_{g} + q''_{\\ell,in}| = |q''_{g} - \\frac{\\dot{q}''' R}{3}|$。\n       - 计算归一化因子：$N_q = \\max\\left(|q''_{g}|, |-q''_{\\ell,in}|, 10^{-12}\\right) = \\max\\left(|q''_{g}|, |\\frac{\\dot{q}''' R}{3}|, 10^{-12}\\right)$。\n       - 计算相对残差：$\\tilde{R}_q = R_q / N_q$。\n       - 如果 $\\Delta T_s  \\varepsilon_T$ 并且 $\\tilde{R}_q  \\varepsilon_q$，则解已收敛。循环终止。\n\n3.  **最终结果**：收敛值 $T_s^{(n+1)}$ 即为解。\n将实现此算法以求解四个测试用例中每个用例的 $T_s$。将包含最大迭代限制，以防止在不收敛的情况下出现无限循环。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the solver for all test cases and print results.\n    \"\"\"\n    # Each case: (R, q''', T_inf, Re, c_p_g, k_g_ref, mu_g_ref, T_ref, beta_k, beta_mu, k_l)\n    test_cases = [\n        # Case A: moderate flow, moderate heating, water-like liquid\n        (5e-4, 5e6, 1000, 50, 1100, 0.05, 4.0e-5, 1000, 0.9, 0.7, 0.6),\n        # Case B: small droplet, high flow, strong heating\n        (5e-5, 1e7, 1200, 200, 1100, 0.055, 4.5e-5, 1200, 0.9, 0.7, 0.6),\n        # Case C: no internal heating edge case\n        (1e-3, 0, 900, 100, 1100, 0.05, 4.0e-5, 900, 0.9, 0.7, 0.15),\n        # Case D: large droplet, weak flow, moderate heating, fuel-like liquid\n        (2e-3, 3e6, 1000, 10, 1100, 0.05, 4.0e-5, 1000, 0.9, 0.7, 0.15),\n    ]\n\n    results = []\n    for params in test_cases:\n        ts_converged = calculate_surface_temp(*params)\n        results.append(f\"{ts_converged:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_surface_temp(R, q_dot_triple, T_inf, Re, c_p_g, k_g_ref, mu_g_ref, T_ref, beta_k, beta_mu, k_l):\n    \"\"\"\n    Calculates the converged droplet surface temperature using a coupled iterative solver.\n\n    The function implements a fixed-point iteration to find a self-consistent\n    surface temperature (Ts) that balances liquid-side conduction with internal\n    generation and gas-side convection.\n    \"\"\"\n\n    # --- Constants and Pre-calculations ---\n    d = 2.0 * R\n    # Flux term from internal generation: q''' * R / 3\n    q_gen_flux = (q_dot_triple * R) / 3.0\n    \n    # Convergence criteria\n    eps_T = 1e-6\n    eps_q = 1e-8\n    max_iter = 100\n\n    # --- Helper function for gas-side calculation ---\n    def get_hg(Ts):\n        \"\"\"Calculates the gas-side heat transfer coefficient hg for a given Ts.\"\"\"\n        T_film = (T_inf + Ts) / 2.0\n        \n        # Handle the case where T_film might be zero, although unlikely in this context.\n        if T_film == 0:\n            # Fallback to avoid math domain errors, though parameters should prevent this.\n            T_film_ratio = 0\n        else:\n            T_film_ratio = T_film / T_ref\n            \n        k_g_Tf = k_g_ref * (T_film_ratio ** beta_k)\n        mu_g_Tf = mu_g_ref * (T_film_ratio ** beta_mu)\n        \n        # Avoid division by zero for k_g_Tf\n        if k_g_Tf == 0:\n            return 0\n\n        Pr = (c_p_g * mu_g_Tf) / k_g_Tf\n        \n        # Pr might be negative if properties are unphysical, handle with max(0, Pr)\n        Nu = 2.0 + 0.6 * (Re ** 0.5) * (np.cbrt(max(0, Pr)))\n        \n        h_g = (Nu * k_g_Tf) / d\n        return h_g\n\n    # --- Iterative Solver ---\n    Ts = T_inf  # Initial guess\n    \n    for _ in range(max_iter):\n        Ts_old = Ts\n        \n        # 1. Calculate hg based on the current Ts estimate (Ts_old)\n        hg_old = get_hg(Ts_old)\n        \n        # 2. Update Ts using the fixed-point relation: Ts = T_inf + q_gen_flux / hg\n        if hg_old == 0:\n            # This case occurs if Nu * k_g is zero. If q_gen_flux is also zero, Ts=T_inf.\n            # If q_gen_flux is non-zero, this is a singularity (infinite Ts).\n            # Given Nu >= 2 and positive conductivities, hg_old > 0.\n            # This is a safe-guard.\n            if q_gen_flux == 0:\n                 Ts = T_inf\n            else:\n                 # In a real scenario, this would indicate a problem.\n                 # For this assignment, we assume it doesn't happen.\n                 Ts = float('inf')\n        else:\n            Ts = T_inf + q_gen_flux / hg_old\n            \n        # 3. Check for convergence\n        \n        # Criterion 1: Absolute change in surface temperature\n        delta_T = abs(Ts - Ts_old)\n        \n        # Criterion 2: Interfacial energy residual\n        # The residual must be checked using properties evaluated at the NEW temperature Ts.\n        hg_new = get_hg(Ts)\n        \n        # Gas-side convective flux at the new temperature\n        q_conv_flux = hg_new * (Ts - T_inf)\n        \n        # Liquid-side conductive flux into the interface\n        # Note: k_l * (dT/dr)|_R = -q_gen_flux\n        q_cond_flux_in = -q_gen_flux\n        \n        # Absolute residual is the imbalance in the energy equation\n        abs_residual = abs(q_conv_flux + q_cond_flux_in)\n        \n        # Normalization term based on the magnitude of the fluxes\n        # Note: |-k_l * (dT/dr)|_R| = |q_gen_flux|\n        norm_term = max(abs(q_conv_flux), abs(q_gen_flux), 1e-12)\n        rel_residual = abs_residual / norm_term\n        \n        if delta_T  eps_T and rel_residual  eps_q:\n            return Ts # Converged\n            \n    # If the loop completes without converging, return the last calculated value.\n    # A more robust implementation might raise a ConvergenceError.\n    return Ts\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在掌握了稳态加热的耦合求解方法后，我们可以将其应用于更复杂的真实场景：液滴蒸发。本练习引入了相变、随温度变化的汽化潜热以及质量与能量守恒之间的紧密耦合。通过构建一个基于寻根算法的求解器，您将能够计算蒸发速率，并将其与经典的 $d^2$-法则联系起来，从而深入理解有限热导率模型如何修正经典的液滴蒸发理论。 ",
            "id": "4022170",
            "problem": "考虑一个半径为 $R$ 的孤立球形液态燃料液滴，蒸发到热的、静止的气体中。气相输运是准稳态且球对称的。液滴具有有限的导热系数，导致内部温度场不均匀，其特征为液体平均温度 $\\overline{T}(t)$ 和表面温度 $T_s(t)$。汽化潜热与温度相关，模型为 $h_{lv}(T_s)$。\n\n您需要确定 $h_{lv}(T_s)$ 如何改变有限导热系数与经典 $d^2$ 定律之间的耦合关系。具体来说，计算由瞬时 $d^2$ 定律速率定义的蒸发常数 $K$\n$$\nK \\equiv -\\frac{d(d^2)}{dt} = -\\frac{d(4R^2)}{dt} = \\frac{8 R}{\\rho_l} j,\n$$\n其中 $j$ 是表面的质量通量，单位为 $\\mathrm{kg}\\cdot \\mathrm{m}^{-2}\\cdot \\mathrm{s}^{-1}$，$ \\rho_l$ 是液体密度，单位为 $\\mathrm{kg}\\cdot \\mathrm{m}^{-3}$。您必须通过同时满足有限导热系数和随温度变化的潜热条件下的质量和能量平衡来获得 $j$。$K$ 的最终数值必须以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位表示。\n\n使用的基本原理：\n- Fick 定律用于描述在厚度与 $R$ 成正比的静止膜中的组分扩散：气相质量通量 $j$ 通过以下模型计算\n$$\nj_m(T_s) = \\rho_g \\, k_m \\left( Y_s(T_s) - Y_\\infty \\right),\n$$\n其中 $k_m$ 是有效传质系数，$\\rho_g$ 是气体密度，$Y_s(T_s)$ 是液滴表面的平衡蒸气质量分数，它取决于饱和压力。\n- 在有限导热系数模型中，液体内部的 Fourier 定律：一个线性化的内部传热系数 $h_{int}$ 通过以下方式将表面热传导通量与温差 $T_s - \\overline{T}$ 联系起来\n$$\nq_{int} = h_{int} \\left( T_s - \\overline{T} \\right),\n$$\n其中 $q_{int}$ 的单位是 $\\mathrm{W}\\cdot \\mathrm{m}^{-2}$。\n- 外部对流传热提供表面热通量\n$$\nq_{g}(T_s) = h_g \\left( T_\\infty - T_s \\right),\n$$\n其中 $h_g$ 是气相传热系数，$T_\\infty$ 是环境气体温度。\n- 界面处的能量守恒要求\n$$\nq_{g}(T_s) = j \\, h_{lv}(T_s) + q_{int}(T_s, \\overline{T}),\n$$\n意味着传入的热量被分配给蒸发质量的潜热和液滴内部的显热。\n\n用于闭合模型的热物理关系：\n- 传质系数的模型为\n$$\nk_m = \\frac{Sh \\, D_g}{2R},\n$$\n其中 $Sh$ 为 Sherwood 数，$D_g$ 为气体扩散系数。\n- 气相传热系数的模型为\n$$\nh_g = \\frac{Nu \\, k_g}{2R},\n$$\n其中 $Nu$ 为 Nusselt 数，$k_g$ 为气体导热系数。\n- 对于具有有限导热系数的球体，内部传热系数的模型为\n$$\nh_{int} = \\frac{3 k_l}{R},\n$$\n其中 $k_l$ 为液体导热系数。\n- 随温度变化的潜热模型为\n$$\nh_{lv}(T_s) = h_{lv,ref} \\left[ 1 - \\gamma \\left( T_s - T_{ref} \\right) \\right],\n$$\n其中 $h_{lv,ref}$ 是在参考温度 $T_{ref}$ 下的潜热，$\\gamma$ 是斜率，单位为 $\\mathrm{K}^{-1}$。此关系必须仅在 $h_{lv}(T_s)  0$ 的情况下强制执行。\n- 表面平衡蒸气质量分数是根据理想气体平衡，使用饱和压力 $p_{sat}(T_s)$ 和分子量计算的：\n$$\np_{sat}(T_s) = p_{ref} \\exp\\left( \\frac{\\Delta H_{mol}(T_s)}{R_u} \\left( \\frac{1}{T_{ref}} - \\frac{1}{T_s} \\right) \\right),\n$$\n$$\n\\Delta H_{mol}(T_s) = h_{lv}(T_s) \\, M_v,\n$$\n$$\nY_s(T_s) = \\frac{M_v \\, p_{sat}(T_s)}{M_v \\, p_{sat}(T_s) + M_a \\left( p_{tot} - p_{sat}(T_s) \\right)},\n$$\n其中 $R_u$ 是通用气体常数，$M_v$ 是蒸气分子量，$M_a$ 是空气分子量，$p_{ref}$ 是在 $T_{ref}$ 下的饱和压力，$p_{tot}$ 是总压力。\n\n耦合与迭代求解要求：\n- 物理上正确的质量通量 $j$ 必须同时满足传质关系和能量平衡。定义残差\n$$\nF(T_s; \\overline{T}) \\equiv j_m(T_s) - \\frac{q_g(T_s) - q_{int}(T_s, \\overline{T})}{h_{lv}(T_s)}.\n$$\n- 对于给定的 $R$ 和瞬时 $\\overline{T}$，使用稳健的一维求根方法找到使 $F(T_s; \\overline{T}) = 0$ 的 $T_s$。这是必需的迭代耦合步骤，因为 $h_{lv}(T_s)$ 通过 $p_{sat}(T_s)$ 和 $h_{lv}(T_s)$ 在分子和分母中均呈非线性出现。\n\n在获得 $T_s$ 和 $j$ 之后，通过上述 $d^2$ 定律的定义计算 $K$。在此任务中，将 $\\overline{T}$ 视为初始液体温度 $T_0$（相对于短时间尺度内的内部加热，表面进行准稳态调整），并在初始半径 $R_0$ 处评估瞬时 $K$。\n\n单位和输出要求：\n- 所有输入均采用国际单位制（SI units）。以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位，将指定测试案例的蒸发常数 $K$ 报告为十进制浮点数。\n- 不涉及角度单位。\n- 最终程序必须输出单行：一个用方括号括起来的逗号分隔列表，例如，“[result1,result2,result3]”。\n\n测试套件：\n使用以下三组参数在 $R=R_0$ 和 $\\overline{T}=T_0$ 时评估 $K$。\n- 案例 A（通用“理想路径”）：\n    - $R_0 = 5.0 \\times 10^{-4}\\, \\mathrm{m}$, $\\rho_l = 700\\, \\mathrm{kg}\\cdot \\mathrm{m}^{-3}$, $c_l = 2200\\, \\mathrm{J}\\cdot \\mathrm{kg}^{-1}\\cdot \\mathrm{K}^{-1}$, $k_l = 0.14\\, \\mathrm{W}\\cdot \\mathrm{m}^{-1}\\cdot \\mathrm{K}^{-1}$,\n    - $k_g = 0.06\\, \\mathrm{W}\\cdot \\mathrm{m}^{-1}\\cdot \\mathrm{K}^{-1}$, $D_g = 8.0 \\times 10^{-6}\\, \\mathrm{m}^2\\cdot \\mathrm{s}^{-1}$, $\\rho_g = 0.70\\, \\mathrm{kg}\\cdot \\mathrm{m}^{-3}$,\n    - $Nu = 2.0$, $Sh = 2.0$, $T_\\infty = 800\\, \\mathrm{K}$, $T_0 = 300\\, \\mathrm{K}$,\n    - $h_{lv,ref} = 3.5 \\times 10^{5}\\, \\mathrm{J}\\cdot \\mathrm{kg}^{-1}$, $\\gamma = 4.0 \\times 10^{-4}\\, \\mathrm{K}^{-1}$, $T_{ref} = 300\\, \\mathrm{K}$,\n    - $p_{tot} = 101325\\, \\mathrm{Pa}$, $p_{ref} = 7000\\, \\mathrm{Pa}$, $M_v = 1.002 \\times 10^{-1}\\, \\mathrm{kg}\\cdot \\mathrm{mol}^{-1}$, $M_a = 2.897 \\times 10^{-2}\\, \\mathrm{kg}\\cdot \\mathrm{mol}^{-1}$, $R_u = 8.314462618\\, \\mathrm{J}\\cdot \\mathrm{mol}^{-1}\\cdot \\mathrm{K}^{-1}$, $Y_\\infty = 0$.\n- 案例 B（边界条件接近无限导热系数）：\n    - 与案例 A 相同，但 $k_l = 1.0\\, \\mathrm{W}\\cdot \\mathrm{m}^{-1}\\cdot \\mathrm{K}^{-1}$ 且 $\\gamma = 1.0 \\times 10^{-4}\\, \\mathrm{K}^{-1}$。\n- 案例 C（低导热系数和潜热更强温度依赖性的边缘案例）：\n    - 与案例 A 相同，但 $k_l = 0.05\\, \\mathrm{W}\\cdot \\mathrm{m}^{-1}\\cdot \\mathrm{K}^{-1}$ 且 $\\gamma = 8.0 \\times 10^{-4}\\, \\mathrm{K}^{-1}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[resultA,resultB,resultC]”），其中每个结果是对应案例的 $K$ 的浮点值（单位为 $\\mathrm{m}^2/\\mathrm{s}$），该值通过对 $T_s$ 迭代求解 $F(T_s; \\overline{T})=0$ 然后在 $R=R_0$ 和 $\\overline{T}=T_0$ 处计算 $K$ 得出。",
            "solution": "问题陈述已经过严格验证，并被确定为计算燃烧领域中一个定义明确、有科学依据的问题。它内容自洽，包含所有必要的物理关系、参数和明确的目标。不存在科学或逻辑上的矛盾。因此，将提供一个解决方案。\n\n主要目标是计算球形液态燃料液滴的瞬时蒸发常数 $K$。该模型包含了扩展经典简单 $d^2$ 定律的两个关键物理现象：液滴内部的有限导热系数和随温度变化的汽化潜热。蒸发常数由液滴表面积的变化率定义，该变化率与表面的质量蒸发通量 $j$ 成正比：\n$$\nK = -\\frac{d(4R^2)}{dt} = \\frac{8 R}{\\rho_l} j\n$$\n此处，$R$ 是瞬时液滴半径，$\\rho_l$ 是恒定的液体密度。为了找到特定时刻的 $K$，我们必须确定 $j$ 的值。问题规定，此计算应在初始状态下进行，此时半径为 $R_0$，液体平均温度 $\\overline{T}$ 为初始温度 $T_0$。\n\n质量通量 $j$ 由液滴表面的两个耦合物理过程控制：从表面到环境气体的传质和界面处的能量平衡。\n\n首先，传质是由液滴表面与远场之间的燃料蒸气浓度梯度驱动的。根据所提供的静止膜模型：\n$$\nj_m(T_s) = \\rho_g \\, k_m \\left( Y_s(T_s) - Y_\\infty \\right)\n$$\n传质系数 $k_m$ 由 $k_m = \\frac{Sh \\, D_g}{2R}$ 给出，其中 $Sh$ 是 Sherwood 数，$D_g$ 是气相扩散系数。对于此问题，$Y_\\infty = 0$。表面蒸气质量分数 $Y_s(T_s)$ 是表面温度 $T_s$ 的强函数，由相平衡确定。这种依赖性是高度非线性的，通过饱和压力 $p_{sat}(T_s)$ 的 Clausius-Clapeyron 关系建模：\n$$\np_{sat}(T_s) = p_{ref} \\exp\\left( \\frac{\\Delta H_{mol}(T_s)}{R_u} \\left( \\frac{1}{T_{ref}} - \\frac{1}{T_s} \\right) \\right)\n$$\n其中 $\\Delta H_{mol}(T_s) = h_{lv}(T_s) \\, M_v$。然后，蒸气质量分数为：\n$$\nY_s(T_s) = \\frac{M_v \\, p_{sat}(T_s)}{M_v \\, p_{sat}(T_s) + M_a \\left( p_{tot} - p_{sat}(T_s) \\right)}\n$$\n至关重要的是，汽化潜热 $h_{lv}(T_s)$ 也取决于温度：\n$$\nh_{lv}(T_s) = h_{lv,ref} \\left[ 1 - \\gamma \\left( T_s - T_{ref} \\right) \\right]\n$$\n这引入了质量通量 $j_m$ 对 $T_s$ 的复杂隐式依赖。\n\n其次，液滴表面的能量平衡决定了来自热气体的传入热量如何分配。从气体到表面的热通量为 $q_g(T_s) = h_g (T_\\infty - T_s)$，其中 $h_g = \\frac{Nu \\, k_g}{2R}$ 是气相传热系数。这部分热量被两个过程消耗：为汽化提供潜热，$j \\cdot h_{lv}(T_s)$，以及将热量传导到液滴内部，$q_{int}(T_s, \\overline{T})$。内部热通量模型为 $q_{int}(T_s, \\overline{T}) = h_{int} (T_s - \\overline{T})$，其中内部传热系数由 $h_{int} = \\frac{3 k_l}{R}$ 给出。能量守恒方程为：\n$$\nq_g(T_s) = j \\cdot h_{lv}(T_s) + q_{int}(T_s, \\overline{T})\n$$\n这个方程可以重新排列，为质量通量提供一个独立的表达式，我们可以将其表示为 $j_e$：\n$$\nj_e(T_s, \\overline{T}) = \\frac{q_g(T_s) - q_{int}(T_s, \\overline{T})}{h_{lv}(T_s)}\n$$\n\n为了获得物理上一致的解，质量通量必须是唯一的。因此，从传质导出的值必须等于从能量平衡导出的值：$j_m(T_s) = j_e(T_s, \\overline{T})$。这个等式为未知表面温度 $T_s$ 建立了一个单一的非线性代数方程。为了求解 $T_s$，我们定义一个残差函数 $F(T_s; \\overline{T})$，其根对应于解：\n$$\nF(T_s; \\overline{T}) \\equiv j_m(T_s) - j_e(T_s, \\overline{T}) = j_m(T_s) - \\frac{q_g(T_s) - q_{int}(T_s, \\overline{T})}{h_{lv}(T_s)} = 0\n$$\n该方程中的所有项都是 $T_s$ 和已知参数的函数。分析所用的参数被设置为其初始值：$R = R_0$ 和 $\\overline{T} = T_0$。\n\n计算每个测试案例的 $K$ 的算法步骤如下：\n1.  对于一组给定的参数 $\\{R_0, T_0, \\rho_l, k_l, \\dots \\}$，定义所有构成函数：$h_{lv}(T_s)$、$p_{sat}(T_s)$、$Y_s(T_s)$、$j_m(T_s)$、$q_g(T_s)$ 和 $q_{int}(T_s)$。这些函数隐式地依赖于特定案例的固定参数。\n2.  构建残差函数 $F(T_s) = F(T_s; T_0)$。\n3.  使用稳健的一维求根算法，例如 Brent-Dekker 方法（SciPy 中的 `brentq`），找到满足 $F(T_s) = 0$ 的 $T_s$ 值。求根应在物理上有意义的范围内进行，例如 $[T_0, T_\\infty]$。由于表面温度必须位于液体整体温度和环境温度之间，这是一个合适的区间。\n4.  一旦确定了唯一的表面温度 $T_s^*$，计算相应的稳态质量通量 $j = j_m(T_s^*)$。\n5.  最后，将此质量通量 $j$ 代入蒸发常数的定义中以获得最终结果：\n    $$\n    K = \\frac{8 R_0}{\\rho_l} j\n    $$\n将此过程系统地应用于所提供的三个测试案例（A、B 和 C），以确定它们各自的蒸发常数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the evaporation constant K for three different droplet evaporation scenarios.\n    \"\"\"\n    \n    # Universal gas constant\n    Ru = 8.314462618  # J/(mol*K)\n\n    # Test cases defined as a list of dictionaries.\n    test_cases = [\n        # Case A: General \"happy path\"\n        {\n            \"name\": \"Case A\",\n            \"R0\": 5.0e-4, \"rho_l\": 700.0, \"k_l\": 0.14,\n            \"kg\": 0.06, \"Dg\": 8.0e-6, \"rho_g\": 0.70,\n            \"Nu\": 2.0, \"Sh\": 2.0, \"T_inf\": 800.0, \"T0\": 300.0,\n            \"h_lv_ref\": 3.5e5, \"gamma\": 4.0e-4, \"T_ref\": 300.0,\n            \"p_tot\": 101325.0, \"p_ref\": 7000.0, \"Mv\": 1.002e-1, \"Ma\": 2.897e-2, \"Y_inf\": 0.0\n        },\n        # Case B: Approaching infinite conductivity\n        {\n            \"name\": \"Case B\",\n            \"R0\": 5.0e-4, \"rho_l\": 700.0, \"k_l\": 1.0,  # Changed\n            \"kg\": 0.06, \"Dg\": 8.0e-6, \"rho_g\": 0.70,\n            \"Nu\": 2.0, \"Sh\": 2.0, \"T_inf\": 800.0, \"T0\": 300.0,\n            \"h_lv_ref\": 3.5e5, \"gamma\": 1.0e-4,  # Changed\n            \"T_ref\": 300.0,\n            \"p_tot\": 101325.0, \"p_ref\": 7000.0, \"Mv\": 1.002e-1, \"Ma\": 2.897e-2, \"Y_inf\": 0.0\n        },\n        # Case C: Low conductivity, strong temperature dependence\n        {\n            \"name\": \"Case C\",\n            \"R0\": 5.0e-4, \"rho_l\": 700.0, \"k_l\": 0.05,  # Changed\n            \"kg\": 0.06, \"Dg\": 8.0e-6, \"rho_g\": 0.70,\n            \"Nu\": 2.0, \"Sh\": 2.0, \"T_inf\": 800.0, \"T0\": 300.0,\n            \"h_lv_ref\": 3.5e5, \"gamma\": 8.0e-4,  # Changed\n            \"T_ref\": 300.0,\n            \"p_tot\": 101325.0, \"p_ref\": 7000.0, \"Mv\": 1.002e-1, \"Ma\": 2.897e-2, \"Y_inf\": 0.0\n        }\n    ]\n\n    results = []\n    \n    for case_params in test_cases:\n        \n        # Unpack parameters for conciseness\n        R = case_params[\"R0\"]\n        T_bar = case_params[\"T0\"]\n        \n        # Fixed coefficients for the given state (R=R0, T_bar=T0)\n        km = (case_params[\"Sh\"] * case_params[\"Dg\"]) / (2 * R)\n        hg = (case_params[\"Nu\"] * case_params[\"kg\"]) / (2 * R)\n        h_int = (3 * case_params[\"k_l\"]) / R\n        \n        # Define functions that depend on surface temperature Ts\n        def h_lv(Ts):\n            val = case_params[\"h_lv_ref\"] * (1 - case_params[\"gamma\"] * (Ts - case_params[\"T_ref\"]))\n            return max(val, 1e-9) # Prevent non-positive values\n\n        def p_sat(Ts):\n            delta_H_mol = h_lv(Ts) * case_params[\"Mv\"]\n            exponent = (delta_H_mol / Ru) * (1 / case_params[\"T_ref\"] - 1 / Ts)\n            return case_params[\"p_ref\"] * np.exp(exponent)\n            \n        def Ys(Ts):\n            ps = p_sat(Ts)\n            numerator = case_params[\"Mv\"] * ps\n            denominator = numerator + case_params[\"Ma\"] * (case_params[\"p_tot\"] - ps)\n            # Prevent division by zero if denominator is unexpectedly zero\n            return numerator / denominator if denominator != 0 else 0.0\n            \n        def jm(Ts):\n            return case_params[\"rho_g\"] * km * (Ys(Ts) - case_params[\"Y_inf\"])\n            \n        def qg(Ts):\n            return hg * (case_params[\"T_inf\"] - Ts)\n            \n        def q_int(Ts):\n            return h_int * (Ts - T_bar)\n            \n        # Define the residual function F(Ts) = 0\n        def residual(Ts):\n            \"\"\"\n            Residual function F(Ts) = j_m(Ts) - j_e(Ts, T_bar).\n            The root of this function is the surface temperature Ts that satisfies\n            both mass and energy conservation simultaneously.\n            \"\"\"\n            mass_flux_from_diffusion = jm(Ts)\n            \n            heat_flux_from_gas = qg(Ts)\n            heat_flux_into_liquid = q_int(Ts)\n            latent_heat = h_lv(Ts)\n            \n            mass_flux_from_energy = (heat_flux_from_gas - heat_flux_into_liquid) / latent_heat\n            \n            return mass_flux_from_diffusion - mass_flux_from_energy\n\n        # Solve for the surface temperature Ts using a robust root-finder.\n        # The physically valid range for Ts is between the liquid temperature and ambient temperature.\n        # Add a small epsilon to avoid issues at the exact boundaries.\n        try:\n            Ts_solution = brentq(residual, case_params[\"T0\"], case_params[\"T_inf\"] - 1e-6)\n        except ValueError:\n            # This can happen if the function values at the endpoints have a same sign,\n            # indicating a potential issue with the model or parameters.\n            # For this problem, the bracketing is physically sound.\n            results.append(float('nan')) # Or handle error appropriately\n            continue\n\n        # With the correct Ts, calculate the final mass flux and evaporation constant K\n        j_solution = jm(Ts_solution)\n        K = (8 * R / case_params[\"rho_l\"]) * j_solution\n        \n        results.append(K)\n\n    # Format and print the final output exactly as required.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}