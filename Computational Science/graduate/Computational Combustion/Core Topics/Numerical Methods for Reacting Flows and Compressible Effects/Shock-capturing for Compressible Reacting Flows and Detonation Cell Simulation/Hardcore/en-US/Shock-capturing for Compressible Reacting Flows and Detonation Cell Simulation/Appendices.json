{
    "hands_on_practices": [
        {
            "introduction": "Effective simulation of detonation begins with a firm grasp of the underlying physical scales. This exercise uses fundamental principles of transport phenomena to assess the feasibility of resolving key physical processes on a computational grid. By calculating dimensionless quantities like the Peclet number ($Pe$) and Schmidt number ($Sc$), you will learn to quantify the competition between advection and diffusion and determine whether critical reaction-diffusion layers can be captured directly, a core challenge in computational combustion. ",
            "id": "4061400",
            "problem": "Consider a two-dimensional simulation of detonation cells in a premixed reactive gas under high-temperature conditions. The post-shock, mean-flow properties in the reaction zone are approximately constant over a characteristic cellular length scale $L$. Assume the following typical values representative of strongly compressible reactive flows at detonation conditions: a characteristic convective speed $U = 2000$ $\\mathrm{m/s}$, a cellular length scale $L = 5.0 \\times 10^{-3}$ $\\mathrm{m}$, thermal diffusivity $\\alpha = 3.0 \\times 10^{-4}$ $\\mathrm{m^2/s}$, kinematic viscosity $\\nu = 4.0 \\times 10^{-4}$ $\\mathrm{m^2/s}$, and species mass diffusivity $D = 1.2 \\times 10^{-3}$ $\\mathrm{m^2/s}$. The simulation employs a uniform Cartesian grid with spacing $\\Delta x = 1.0 \\times 10^{-5}$ $\\mathrm{m}$ and a shock-capturing method suitable for compressible reacting flows.\n\nStarting from the species transport equation written as an advection-diffusion-reaction balance and the momentum equation with viscous stresses in the compressible Navier–Stokes framework, perform a first-principles nondimensionalization to identify the dimensionless groups governing the relative strength of advection, thermal diffusion, momentum diffusion, and mass diffusion. Use these groups to:\n- Derive the expression for the Peclet number (Pe) associated with heat transport over the cellular length scale and the Schmidt number (Sc) associated with momentum-to-mass diffusion ratio.\n- Compute the numerical values of the Peclet number and Schmidt number under the given conditions.\n- Using the identified advective–diffusive length scales implied by these groups, decide whether thermal and species diffusion layers are physically resolvable on the available grid spacing $\\Delta x$; base your decision on a comparison of the relevant diffusion lengths with $\\Delta x$ and justify it in terms of the governing balance.\n\nExpress the Peclet number and Schmidt number as unitless numbers and round both to three significant figures. The final answer must consist only of the two computed values arranged as a row matrix. Do not include any units in the final answer.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in the established principles of transport phenomena and computational fluid dynamics, well-posed with sufficient and consistent data for a unique solution, and formulated using objective, precise language. The physical parameters provided are realistic for the study of detonation waves in reactive gases. We may therefore proceed with a formal solution.\n\nThe problem requires a nondimensional analysis of the governing transport equations to derive key dimensionless groups, calculate their values, and assess the resolvability of physical phenomena on a given computational grid.\n\nFirst, we derive the Peclet number, $\\text{Pe}$, associated with heat transport. The Peclet number represents the ratio of the rate of advection of a physical quantity by the flow to the rate of diffusion of the same quantity driven by an appropriate gradient. For heat transport, this involves the advection of thermal energy versus thermal diffusion. The simplified steady-state energy equation, which balances these two effects, can be scaled as follows. Let $U$ be the characteristic convective speed, $L$ be the characteristic length scale, and $\\alpha$ be the thermal diffusivity. The advective heat flux scales as $\\rho c_p U \\Delta T$, where $\\rho$ is the density, $c_p$ is the specific heat capacity, and $\\Delta T$ is a characteristic temperature difference. The diffusive heat flux, governed by Fourier's law, scales as $k \\frac{\\Delta T}{L} = \\rho c_p \\alpha \\frac{\\Delta T}{L}$. In a differential control volume analysis, the divergence of the advective flux scales as $\\frac{\\rho c_p U \\Delta T}{L}$, and the divergence of the diffusive flux scales as $\\frac{\\rho c_p \\alpha \\Delta T}{L^2}$.\n\nThe ratio of these two terms defines the Peclet number for heat transfer:\n$$\n\\text{Pe} = \\frac{\\text{Advective Transport}}{\\text{Diffusive Transport}} = \\frac{U L}{\\alpha}\n$$\nSubstituting the given values:\n$$\n\\text{Pe} = \\frac{(2000 \\, \\mathrm{m/s}) (5.0 \\times 10^{-3} \\, \\mathrm{m})}{3.0 \\times 10^{-4} \\, \\mathrm{m^2/s}} = \\frac{10}{3.0 \\times 10^{-4}} \\approx 33333.\\overline{3}\n$$\nRounding to three significant figures, the Peclet number is $\\text{Pe} \\approx 3.33 \\times 10^{4}$. This high value indicates that over the cellular length scale $L$, advection is the overwhelmingly dominant mechanism for heat transport compared to thermal diffusion.\n\nNext, we derive the Schmidt number, $\\text{Sc}$. The Schmidt number is a dimensionless group that compares momentum diffusivity to mass diffusivity. It is defined as the ratio of the kinematic viscosity, $\\nu$, to the species mass diffusivity, $D$.\n$$\n\\text{Sc} = \\frac{\\nu}{D}\n$$\nThis number is crucial for comparing the relative thicknesses of the hydrodynamic (momentum) boundary layer and the species concentration boundary layer. Using the provided values:\n$$\n\\text{Sc} = \\frac{4.0 \\times 10^{-4} \\, \\mathrm{m^2/s}}{1.2 \\times 10^{-3} \\, \\mathrm{m^2/s}} = \\frac{4.0}{12} = \\frac{1}{3} \\approx 0.3333\\overline{3}\n$$\nRounding to three significant figures, the Schmidt number is $\\text{Sc} \\approx 0.333$. A Schmidt number less than $1$ indicates that mass diffusivity is greater than momentum diffusivity, meaning that species concentration profiles will diffuse faster and over a wider region than momentum profiles.\n\nFinally, we must assess whether the thermal and species diffusion layers are physically resolvable on the computational grid. The characteristic thickness of a diffusion layer, $\\delta$, can be estimated as the length scale over which advection and diffusion are of the same order of magnitude. This scale is different from the global cellular scale $L$.\n\nFor the thermal diffusion layer, the thickness $\\delta_{th}$ is found by balancing advection $U \\frac{\\partial T}{\\partial x}$ and diffusion $\\alpha \\frac{\\partial^2 T}{\\partial x^2}$. Scaling these terms gives $U \\frac{\\Delta T}{\\delta_{th}} \\sim \\alpha \\frac{\\Delta T}{\\delta_{th}^2}$, which yields:\n$$\n\\delta_{th} = \\frac{\\alpha}{U} = \\frac{3.0 \\times 10^{-4} \\, \\mathrm{m^2/s}}{2000 \\, \\mathrm{m/s}} = 1.5 \\times 10^{-7} \\, \\mathrm{m}\n$$\n\nFor the species diffusion layer, the thickness $\\delta_{sp}$ is found by balancing advection $U \\frac{\\partial Y}{\\partial x}$ and mass diffusion $D \\frac{\\partial^2 Y}{\\partial x^2}$. Scaling gives $U \\frac{\\Delta Y}{\\delta_{sp}} \\sim D \\frac{\\Delta Y}{\\delta_{sp}^2}$, which yields:\n$$\n\\delta_{sp} = \\frac{D}{U} = \\frac{1.2 \\times 10^{-3} \\, \\mathrm{m^2/s}}{2000 \\, \\mathrm{m/s}} = 6.0 \\times 10^{-7} \\, \\mathrm{m}\n$$\n\nThe problem states the grid spacing is $\\Delta x = 1.0 \\times 10^{-5} \\, \\mathrm{m}$. To resolve a physical feature, the grid spacing must be significantly smaller than the feature's characteristic size. We compare $\\Delta x$ to the diffusion layer thicknesses:\n- For the thermal layer: $\\frac{\\Delta x}{\\delta_{th}} = \\frac{1.0 \\times 10^{-5} \\, \\mathrm{m}}{1.5 \\times 10^{-7} \\, \\mathrm{m}} \\approx 66.7$.\n- For the species layer: $\\frac{\\Delta x}{\\delta_{sp}} = \\frac{1.0 \\times 10^{-5} \\, \\mathrm{m}}{6.0 \\times 10^{-7} \\, \\mathrm{m}} \\approx 16.7$.\n\nIn both cases, the grid spacing $\\Delta x$ is substantially larger than the characteristic diffusion lengths ($\\Delta x \\gg \\delta_{th}$ and $\\Delta x \\gg \\delta_{sp}$). The grid is too coarse to resolve the thin regions where diffusion is important. The thermal layer would require a grid approximately $67$ times finer, and the species layer would require a grid about $17$ times finer, just to place a single grid point within the layer thickness. A proper resolution would demand several grid points within each layer.\n\nTherefore, we conclude that neither the thermal diffusion layer nor the species diffusion layer is physically resolvable with the given grid spacing of $\\Delta x = 1.0 \\times 10^{-5} \\, \\mathrm{m}$. These layers represent subgrid-scale phenomena. This highlights a fundamental challenge in computational combustion: the disparity between large-scale fluid structures (like detonation cells) and extremely thin reaction-diffusion zones necessitates either prohibitively fine grids or the use of advanced shock-capturing methods and subgrid-scale models to represent the unresolved physics.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.33 \\times 10^{4}  0.333\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Given that many critical features in a detonation are too small to resolve with a uniform grid, adaptive mesh refinement (AMR) becomes an indispensable tool. However, for AMR to be effective, we must define robust criteria for where and how much to refine the grid. This practice bridges theory and application by having you estimate characteristic length scales from flow-field gradients and determine the minimum refinement level needed to accurately capture them, a crucial skill for designing efficient and accurate simulations. ",
            "id": "4061414",
            "problem": "A two-dimensional detonation wave with pronounced cellular structure is simulated using adaptive mesh refinement (AMR) for compressible reactive flow governed by the reactive Euler equations with a single-step Arrhenius source term. Accurate resolution of the induction zone and the shear layers behind triple points is required to ensure physically correct detonation cell morphology and shock-capturing quality. Consider the following setup and measurements taken from a preliminary coarse-grid solution.\n\nThe adaptive mesh refinement hierarchy uses a refinement ratio of $r=2$ between successive levels, so the spatial step at refinement level $\\ell$ is $$\\Delta x_{\\ell} = \\frac{\\Delta x_{0}}{2^{\\ell}},$$ where $\\Delta x_{0}$ is the base grid spacing. In the vicinity of a triple point path, the reacting induction zone is characterized using the reaction progress variable $\\lambda$, which varies from $\\lambda=0$ (unreacted) to $\\lambda=1$ (fully reacted). The local streamwise gradient magnitude of the progress variable along a shock-attached streamline is measured as $$\\left|\\frac{\\partial \\lambda}{\\partial s}\\right| = 4.0 \\times 10^{3} \\ \\mathrm{m}^{-1}.$$ The slip line emerging from the triple point exhibits a strong shear layer, whose local normal gradient of the streamwise velocity is measured as $$\\left|\\frac{\\partial u}{\\partial n}\\right| = 2.5 \\times 10^{5} \\, \\mathrm{s}^{-1},$$ with an estimated velocity jump across the layer of $$\\Delta u = 600 \\, \\mathrm{m/s}.$$\n\nThe base grid spacing is $$\\Delta x_{0} = 1.0 \\times 10^{-4} \\ \\text{m}.$$\n\nUsing first principles, estimate the characteristic length scales for the induction zone, $L_{\\text{ind}}$, and the shear layer, $\\delta_{\\text{shear}}$, based on the provided gradients. Then, determine the minimum AMR refinement level $\\ell_{\\min}$ such that both of the following numerical resolution criteria are satisfied simultaneously:\n- At least $N_{\\text{ind}}=20$ grid points across the induction zone thickness $L_{\\text{ind}}$,\n- At least $N_{\\text{shear}}=12$ grid points across the shear layer thickness $\\delta_{\\text{shear}}$.\n\nAssume that the induction zone spans the full variation of the progress variable from $0$ to $1$ locally. Express the final answer as the single integer $\\ell_{\\min}$. No rounding is required beyond the integer determination. The answer is dimensionless; do not include units.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of computational fluid dynamics and combustion, specifically concerning the numerical simulation of detonation waves. The problem is well-posed, objective, and self-contained, providing all necessary data and clear criteria to determine a unique solution. No scientific flaws, contradictions, or ambiguities are present.\n\nThe first step is to estimate the characteristic length scales of the two physical features described: the induction zone and the shear layer.\n\nA characteristic length scale, $L$, of a feature where a quantity $\\phi$ varies by $\\Delta \\phi$ can be estimated from its spatial gradient magnitude, $\\left|\\frac{\\partial \\phi}{\\partial x}\\right|$, using the first-order approximation:\n$$L \\approx \\frac{\\Delta \\phi}{\\left|\\frac{\\partial \\phi}{\\partial x}\\right|}$$\n\nFor the induction zone, the relevant quantity is the reaction progress variable, $\\lambda$. The problem states that this zone spans the full variation of $\\lambda$ from $\\lambda=0$ to $\\lambda=1$, so the total change is $\\Delta \\lambda = 1 - 0 = 1$. The streamwise gradient magnitude is given as $\\left|\\frac{\\partial \\lambda}{\\partial s}\\right| = 4.0 \\times 10^{3} \\ \\mathrm{m}^{-1}$. Therefore, the characteristic length of the induction zone, $L_{\\text{ind}}$, is:\n$$L_{\\text{ind}} \\approx \\frac{\\Delta \\lambda}{\\left|\\frac{\\partial \\lambda}{\\partial s}\\right|} = \\frac{1}{4.0 \\times 10^{3} \\ \\mathrm{m}^{-1}} = 0.25 \\times 10^{-3} \\ \\mathrm{m} = 2.5 \\times 10^{-4} \\ \\mathrm{m}$$\n\nFor the shear layer, the relevant quantity is the streamwise velocity, $u$. The total velocity jump across the layer is given as $\\Delta u = 600 \\, \\mathrm{m/s}$. The normal gradient of the velocity is given as $\\left|\\frac{\\partial u}{\\partial n}\\right| = 2.5 \\times 10^{5} \\, \\mathrm{s}^{-1}$. The characteristic thickness of the shear layer, $\\delta_{\\text{shear}}$, is:\n$$\\delta_{\\text{shear}} \\approx \\frac{\\Delta u}{\\left|\\frac{\\partial u}{\\partial n}\\right|} = \\frac{600 \\, \\mathrm{m/s}}{2.5 \\times 10^{5} \\, \\mathrm{s}^{-1}} = \\frac{6 \\times 10^2}{2.5 \\times 10^5} \\ \\mathrm{m} = 2.4 \\times 10^{-3} \\ \\mathrm{m}$$\n\nNext, we determine the required grid spacing to satisfy the numerical resolution criteria for each feature.\n\nFor the induction zone, the criterion is to have at least $N_{\\text{ind}}=20$ grid points across its thickness $L_{\\text{ind}}$. The required grid spacing, $\\Delta x_{\\text{req, ind}}$, is therefore:\n$$\\Delta x_{\\text{req, ind}} = \\frac{L_{\\text{ind}}}{N_{\\text{ind}}} = \\frac{2.5 \\times 10^{-4} \\ \\text{m}}{20} = 1.25 \\times 10^{-5} \\ \\text{m}$$\n\nFor the shear layer, the criterion is to have at least $N_{\\text{shear}}=12$ grid points across its thickness $\\delta_{\\text{shear}}$. The required grid spacing, $\\Delta x_{\\text{req, shear}}$, is:\n$$\\Delta x_{\\text{req, shear}} = \\frac{\\delta_{\\text{shear}}}{N_{\\text{shear}}} = \\frac{2.4 \\times 10^{-3} \\ \\text{m}}{12} = 0.2 \\times 10^{-3} \\ \\text{m} = 2.0 \\times 10^{-4} \\ \\text{m}$$\n\nTo satisfy both resolution criteria simultaneously, the grid spacing must be fine enough for the more restrictive (smaller) requirement. We define the overall required grid spacing, $\\Delta x_{\\text{req}}$, as the minimum of the two:\n$$\\Delta x_{\\text{req}} = \\min(\\Delta x_{\\text{req, ind}}, \\Delta x_{\\text{req, shear}})$$\n$$\\Delta x_{\\text{req}} = \\min(1.25 \\times 10^{-5} \\ \\text{m}, 2.0 \\times 10^{-4} \\ \\text{m}) = 1.25 \\times 10^{-5} \\ \\text{m}$$\nThe resolution of the induction zone is the binding constraint.\n\nFinally, we determine the minimum adaptive mesh refinement (AMR) level, $\\ell_{\\min}$, that provides a grid spacing $\\Delta x_{\\ell}$ less than or equal to $\\Delta x_{\\text{req}}$. The grid spacing at level $\\ell$ is given by the formula:\n$$\\Delta x_{\\ell} = \\frac{\\Delta x_{0}}{r^{\\ell}},$$\nwhere the base grid spacing is $\\Delta x_{0} = 1.0 \\times 10^{-4} \\ \\text{m}$ and the refinement ratio is $r=2$.\n\nWe must find the smallest integer $\\ell$ that satisfies the inequality:\n$$\\Delta x_{\\ell} \\le \\Delta x_{\\text{req}}$$\n$$\\frac{\\Delta x_{0}}{2^{\\ell}} \\le \\Delta x_{\\text{req}}$$\nRearranging the inequality to solve for $\\ell$:\n$$2^{\\ell} \\ge \\frac{\\Delta x_{0}}{\\Delta x_{\\text{req}}}$$\nSubstituting the numerical values:\n$$2^{\\ell} \\ge \\frac{1.0 \\times 10^{-4} \\ \\text{m}}{1.25 \\times 10^{-5} \\ \\text{m}}$$\n$$2^{\\ell} \\ge \\frac{10 \\times 10^{-5}}{1.25 \\times 10^{-5}} = \\frac{10}{1.25} = 8$$\nTo find the minimum integer $\\ell$ that satisfies $2^{\\ell} \\ge 8$, we can take the base-2 logarithm of both sides:\n$$\\ell \\ge \\log_{2}(8)$$\n$$\\ell \\ge 3$$\nSince $\\ell$ must be an integer, the minimum required refinement level is $\\ell_{\\min} = 3$. At this level, the grid spacing is $\\Delta x_{3} = (1.0 \\times 10^{-4}) / 2^3 = 1.25 \\times 10^{-5} \\ \\text{m}$, which exactly meets the resolution requirement for the induction zone.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "High-order shock-capturing schemes, while accurate, can sometimes produce unphysical results, such as negative mass fractions, especially near discontinuities. Ensuring the physical realizability of the solution is paramount for numerical stability and for obtaining meaningful results. This hands-on coding problem addresses this challenge directly, guiding you to implement a robust diagnostic and a conservative renormalization procedure to enforce physical constraints on species mass fractions, a vital component of any production-level reacting flow solver. ",
            "id": "4061426",
            "problem": "Consider a finite-volume discretization of the compressible reactive Euler equations in the context of shock-capturing for detonation cell simulation. Let a computational cell contain a mixture with density $\\rho$ (expressed in $\\mathrm{kg/m^3}$) and species mass fractions $Y_i$ for $i=1,\\dots,N$. The species mass fraction is defined by $Y_i = \\rho_i / \\rho$, where $\\rho_i$ is the partial density of species $i$, and the physical constraints require $Y_i \\ge 0$ for all $i$ and $\\sum_{i=1}^N Y_i = 1$. In practice, high-order shock-capturing schemes can produce violations of these constraints (e.g., due to numerical overshoot near discontinuities), which must be detected and corrected to maintain physical realism and numerical stability.\n\nYour task is to design:\n1. A diagnostic to flag any cell whose species mass fractions violate the constraint $\\sum_{i=1}^N Y_i = 1$ or positivity $Y_i \\ge 0$, using a tolerance $\\tau$ on the sum constraint.\n2. A conservative renormalization procedure that restores the species mass fractions to satisfy $Y_i^\\star \\ge 0$ and $\\sum_{i=1}^N Y_i^\\star = 1$ without altering the total mixture mass in the cell. The renormalization must keep $\\rho$ unchanged and should be derived from a principled projection, not an ad hoc heuristic.\n\nThe program you produce must:\n- Implement a diagnostic that marks a cell as violating the constraints if either $\\left|\\sum_{i=1}^N Y_i - 1\\right|  \\tau$ or $\\min_i Y_i  0$.\n- Implement a conservative renormalization that computes $Y^\\star$ as the Euclidean (least-squares) projection of $Y$ onto the probability simplex $\\mathcal{S}_N = \\{ x \\in \\mathbb{R}^N \\mid x_i \\ge 0,\\ \\sum_{i=1}^N x_i = 1 \\}$, and keeps the density $\\rho$ unchanged. After renormalization, update partial densities via $\\rho_i^\\star = \\rho\\,Y_i^\\star$ if needed. The renormalization must ensure the total mixture mass $\\rho$ remains unchanged.\n\nUse the following test suite of cells (each with $(\\rho, Y, \\tau)$), where all numbers are given explicitly:\n- Case A (happy path with moderate deviation): $\\rho = 1.2\\,\\mathrm{kg/m^3}$, $Y = (0.2, 0.3, 0.25, 0.2, 0.1)$, $\\tau = 10^{-10}$.\n- Case B (boundary condition near tolerance): $\\rho = 0.9\\,\\mathrm{kg/m^3}$, $Y = (0.3, 0.3, 0.400000000001)$, $\\tau = 10^{-10}$.\n- Case C (edge case with negativity): $\\rho = 1.0\\,\\mathrm{kg/m^3}$, $Y = (0.7, -0.05, 0.4)$, $\\tau = 10^{-10}$.\n- Case D (edge case with zero sum): $\\rho = 2.0\\,\\mathrm{kg/m^3}$, $Y = (0, 0, 0, 0)$, $\\tau = 10^{-10}$.\n- Case E (edge case with a species greater than one): $\\rho = 0.8\\,\\mathrm{kg/m^3}$, $Y = (1.2, -0.1, -0.1)$, $\\tau = 10^{-10}$.\n- Case F (detonation-relevant three-species mixture deviating from unity): $\\rho = 1.3\\,\\mathrm{kg/m^3}$, $Y = (0.03, 0.22, 0.73)$, $\\tau = 10^{-10}$.\n\nFor each case, your program must:\n- Apply the diagnostic before renormalization to produce a boolean flag indicating violation.\n- Apply the renormalization to compute $Y^\\star$.\n- Compute the absolute sum errors before and after: $e_{\\text{before}} = \\left|\\sum_i Y_i - 1\\right|$ and $e_{\\text{after}} = \\left|\\sum_i Y_i^\\star - 1\\right|$.\n- Verify that the mixture density is unchanged: a boolean $b_\\rho$ indicating whether the post-renormalization $\\rho$ equals the pre-renormalization $\\rho$ exactly.\n- Verify post-renormalization positivity: a boolean $b_{+}$ indicating whether $\\min_i Y_i^\\star \\ge 0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, where each case result is a list in the form $[\\text{flag}, e_{\\text{before}}, e_{\\text{after}}, b_\\rho, b_{+}]$.\n- For example, the output should look like $[[\\text{flag}_A, e_{\\text{before},A}, e_{\\text{after},A}, b_{\\rho,A}, b_{+,A}], [\\text{flag}_B, \\dots], \\dots]$.\n\nNo angles or percentages are involved; all outputs are dimensionless booleans or floats. Density must be treated in $\\mathrm{kg/m^3}$ internally but is not printed in the final output. The program must be completely self-contained and runnable without external input.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the field of computational combustion, mathematically well-posed, objective, and provides all necessary information to formulate a solution. No inconsistencies, unsound premises, or ambiguities were found.\n\nThe task is to develop and implement a two-part procedure for handling species mass fractions in a computational cell, a common requirement in simulations of compressible reacting flows. First, a diagnostic must flag cells with non-physical mass fractions. Second, a conservative renormalization procedure must correct these fractions to be physically admissible.\n\nLet the state of a cell be defined by its mixture density $\\rho$ and a vector of $N$ species mass fractions $Y = (Y_1, Y_2, \\dots, Y_N)$. The physical constraints on $Y$ are:\n1.  **Positivity:** $Y_i \\ge 0$ for all $i=1, \\dots, N$.\n2.  **Sum-to-unity:** $\\sum_{i=1}^N Y_i = 1$.\n\nThese two constraints define the standard, or probability, simplex in $N$ dimensions, denoted as $\\mathcal{S}_N$:\n$$ \\mathcal{S}_N = \\left\\{ x \\in \\mathbb{R}^N \\mid \\sum_{i=1}^N x_i = 1 \\text{ and } x_i \\ge 0 \\text{ for all } i \\right\\} $$\n\n### Part 1: Diagnostic for Constraint Violation\n\nThe diagnostic rule is explicitly defined. A given mass fraction vector $Y$ is flagged as being in violation of the physical constraints if its components are not on the simplex, with a specified tolerance $\\tau$ for the sum constraint. The violation condition is given by the logical disjunction:\n$$ \\left( \\left| \\sum_{i=1}^N Y_i - 1 \\right|  \\tau \\right) \\lor \\left( \\min_{i} Y_i  0 \\right) $$\nThis check is performed on the input state $(Y, \\tau)$ before any correction is applied. The absolute error in the sum before correction is calculated as $e_{\\text{before}} = \\left| \\sum_{i=1}^N Y_i - 1 \\right|$.\n\n### Part 2: Conservative Renormalization Procedure\n\nThe renormalization must map an arbitrary vector $Y \\in \\mathbb{R}^N$ to a vector $Y^\\star \\in \\mathcal{S}_N$. The problem mandates that this mapping be \"conservative,\" meaning the total mixture density $\\rho$ is unchanged. This is a key feature, as it ensures the total mass in the cell's volume, $\\rho V$, is conserved. The procedure only redistributes the mass among species.\n\nThe problem specifies a principled method: the corrected vector $Y^\\star$ must be the Euclidean (or least-squares) projection of the unphysical vector $Y$ onto the probability simplex $\\mathcal{S}_N$. This corresponds to solving the following quadratic programming problem:\n$$ \\begin{aligned} \\underset{Y^\\star}{\\text{minimize}} \\quad  \\frac{1}{2} \\| Y^\\star - Y \\|_2^2 = \\frac{1}{2} \\sum_{i=1}^N (Y_i^\\star - Y_i)^2 \\\\ \\text{subject to} \\quad  \\sum_{i=1}^N Y_i^\\star = 1 \\\\  Y_i^\\star \\ge 0, \\quad i=1, \\dots, N \\end{aligned} $$\nSince $\\mathcal{S}_N$ is a closed convex set, a unique solution $Y^\\star$ to this projection problem is guaranteed to exist for any $Y \\in \\mathbb{R}^N$.\n\nTo find the solution, we can use the Karush-Kuhn-Tucker (KKT) conditions. The solution $Y^\\star$ can be expressed in terms of a single scalar variable $\\theta$ (related to the Lagrange multiplier for the equality constraint) as:\n$$ Y_i^\\star = \\max(0, Y_i - \\theta) $$\nThis form elegantly incorporates the positivity constraint. Substituting this into the sum-to-unity constraint gives a non-linear equation for $\\theta$:\n$$ \\sum_{i=1}^N \\max(0, Y_i - \\theta) = 1 $$\nThe function $f(\\theta) = \\sum_{i=1}^N \\max(0, Y_i - \\theta)$ is continuous, piecewise linear, and monotonically decreasing. A unique $\\theta$ that solves $f(\\theta) = 1$ can be found efficiently. A well-established and fast algorithm for this projection is as follows:\n\n1.  Given the input vector $Y = (Y_1, \\dots, Y_N)$.\n2.  Sort the components of $Y$ in descending order to create a new vector $U$: $u_1 \\ge u_2 \\ge \\dots \\ge u_N$.\n3.  Find the largest integer index $\\rho_{\\text{idx}} \\in \\{1, \\dots, N\\}$ such that\n    $$ u_{\\rho_{\\text{idx}}} - \\frac{1}{\\rho_{\\text{idx}}} \\left( \\left( \\sum_{k=1}^{\\rho_{\\text{idx}}} u_k \\right) - 1 \\right)  0 $$\n    This index identifies the subset of components of $Y^\\star$ that will be positive.\n4.  Calculate the threshold $\\theta$ using this index $\\rho_{\\text{idx}}$:\n    $$ \\theta = \\frac{1}{\\rho_{\\text{idx}}} \\left( \\left( \\sum_{k=1}^{\\rho_{\\text{idx}}} u_k \\right) - 1 \\right) $$\n5.  The components of the projected vector $Y^\\star$ are then computed by applying this threshold to the original unsorted vector $Y$:\n    $$ Y_i^\\star = \\max(0, Y_i - \\theta) \\quad \\text{for } i=1, \\dots, N $$\n\n### Part 3: Post-Renormalization Verification\n\nAfter computing $Y^\\star$, we perform the required verification steps:\n1.  **Final Sum Error:** Calculate $e_{\\text{after}} = \\left| \\sum_{i=1}^N Y_i^\\star - 1 \\right|$. Due to the properties of the projection and the use of floating-point arithmetic, this value should be very close to $0$.\n2.  **Density Conservation:** The boolean $b_\\rho$ checks if the mixture density is unchanged. The algorithm described acts only on the mass fraction vector $Y$ and does not modify $\\rho$. Thus, by design, the post-renormalization density is identical to the pre-renormalization density, and $b_\\rho$ will be `True`.\n3.  **Positivity:** The boolean $b_{+}$ checks if $\\min_i Y_i^\\star \\ge 0$. The operation $Y_i^\\star = \\max(0, Y_i - \\theta)$ guarantees that all components of $Y^\\star$ are non-negative. Therefore, $b_{+}$ will also be `True`.\n\nThis completes the design of the diagnostic, the conservative renormalization procedure, and the verification steps. This framework is robust, non-heuristic, and ensures the fundamental physical constraints on species mass fractions are respected numerically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef renormalize_mass_fractions(Y):\n    \"\"\"\n    Projects a vector Y onto the probability simplex using a fast projection algorithm.\n    This corresponds to finding Y_star that solves:\n    minimize ||Y_star - Y||_2^2\n    subject to sum(Y_star) = 1 and Y_star_i = 0.\n\n    Args:\n        Y (np.ndarray): The input vector of mass fractions.\n\n    Returns:\n        np.ndarray: The projected vector Y_star on the simplex.\n    \"\"\"\n    n_species = len(Y)\n    \n    # Sort the mass fractions in descending order\n    U = np.sort(Y)[::-1]\n    \n    # Compute the cumulative sum of the sorted values\n    cssv = np.cumsum(U)\n    \n    # Find the largest index rho such that the projection condition holds.\n    # The condition is u_j - (1/j) * (sum_{k=1 to j} u_k - 1)  0\n    # The 'j' in the formula is 1-based, so we use arange(1, n+1).\n    j_indices = np.arange(1, n_species + 1)\n    condition = U - (cssv - 1) / j_indices  0\n    \n    # Find the last index (which corresponds to the largest j) where condition is True.\n    # np.where returns a tuple of arrays; we take the first.\n    # If no element satisfies the condition (e.g., Y is a zero vector), this will be empty.\n    # In that edge case, the projection is uniform.\n    if np.any(condition):\n        rho = np.where(condition)[0][-1] + 1\n    else:\n        # This branch handles cases like Y=(0,0,0) where the condition is never strictly  0 for all u_j=0\n        # although mathematically it could be = 0. For Y=(0,0,0) u_j - ...  0 fails, but the projection is uniform.\n        # This can be seen by setting rho = n_species\n        rho = n_species\n\n    # Calculate the threshold theta\n    # cssv is 0-indexed, so we use rho-1\n    theta = (cssv[rho - 1] - 1) / rho\n    \n    # Compute the projection\n    Y_star = np.maximum(0, Y - theta)\n    \n    return Y_star\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and produce the required output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (rho, Y, tau)\n        (1.2, np.array([0.2, 0.3, 0.25, 0.2, 0.1]), 1e-10),     # Case A\n        (0.9, np.array([0.3, 0.3, 0.400000000001]), 1e-10),  # Case B\n        (1.0, np.array([0.7, -0.05, 0.4]), 1e-10),            # Case C\n        (2.0, np.array([0.0, 0.0, 0.0, 0.0]), 1e-10),           # Case D\n        (0.8, np.array([1.2, -0.1, -0.1]), 1e-10),            # Case E\n        (1.3, np.array([0.03, 0.22, 0.73]), 1e-10),         # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        rho, Y, tau = case\n\n        # 1. Apply the diagnostic before renormalization\n        sum_Y = np.sum(Y)\n        min_Y = np.min(Y)\n        flag = bool(np.abs(sum_Y - 1)  tau or min_Y  0)\n\n        # 2. Compute the sum error before renormalization\n        e_before = np.abs(sum_Y - 1)\n\n        # 3. Apply the renormalization to compute Y_star\n        Y_star = renormalize_mass_fractions(Y)\n\n        # 4. Compute the sum error after renormalization\n        e_after = np.abs(np.sum(Y_star) - 1)\n\n        # 5. Verify density is unchanged. By problem design, it is.\n        b_rho = True\n\n        # 6. Verify post-renormalization positivity. By algorithm design, it is.\n        b_plus = bool(np.min(Y_star) = 0.0)\n\n        # Store the results for this case\n        case_result = [flag, e_before, e_after, b_rho, b_plus]\n        results.append(case_result)\n\n    # Format the final output string\n    # Python's bool `True` and `False` are used directly as specified by the problem's logic.\n    # The example output `[flag_A, ...]` is a generic placeholder.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}