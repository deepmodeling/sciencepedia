{
    "hands_on_practices": [
        {
            "introduction": "在开发或使用反应流求解器时，首要任务是验证其数值离散的准确性。制造解方法 (Method of Manufactured Solutions, MMS) 是一种严格的代码验证技术，它允许我们精确量化离散误差。通过本练习 ()，您将亲手实施 MMS，以检验对流和扩散项的常见有限差分格式是否达到了其理论精度，这是确保求解器可靠性的基石。",
            "id": "4006782",
            "problem": "考虑计算燃烧学中用于输运标量的反应流求解器中出现的一维周期性平流-扩散算子。令 $x \\in [0,1)$ 表示均匀网格上的位置，令 $u(x)$ 表示一个光滑的人工标量场。应用于 $u(x)$ 的空间平流-扩散算子由表达式 $a \\, \\partial u / \\partial x - D \\, \\partial^{2} u / \\partial x^{2}$ 定义，其中 $a$ 是常数平流速度，$D$ 是常数分子扩散系数，两者均为严格正值。在反应流求解器使用的算法结构中，该算子在具有周期性边界条件的均匀网格上使用有限差分法进行离散化。您需要采用 Method of Manufactured Solutions (MMS) 分别评估平流和扩散部分常用有限差分离散格式的观测精度阶。术语 Method of Manufactured Solutions (MMS) 指的是一种验证策略，其中选择一个光滑的解析函数 $u(x)$，并将离散算子近似值与应用于 $u(x)$ 的精确微分算子进行比较，以量化离散误差随网格加密的收敛性。\n\n使用以下基本设定：\n- 根据微积分，精确一阶导数为 $\\partial u / \\partial x$，精确二阶导数为 $\\partial^{2} u / \\partial x^{2}$。\n- $[0,1)$ 上的均匀网格有 $N$ 个点，间距为 $h = 1/N$，网格点为 $x_{i} = i h$，其中 $i \\in \\{0,1,\\dots,N-1\\}$。\n- 周期性边界条件意味着对于任何引用了 $\\{0,1,\\dots,N-1\\}$ 之外索引的离散模板，都有 $u_{-1} = u_{N-1}$ 和 $u_{N} = u_{0}$。\n\n选择人工解为 $u(x) = \\sin(2 \\pi x) + \\tfrac{1}{2} \\cos(4 \\pi x)$，其精确导数为 $\\partial u / \\partial x = 2 \\pi \\cos(2 \\pi x) - 2 \\pi \\sin(4 \\pi x)$ 和 $\\partial^{2} u / \\partial x^{2} = - (2 \\pi)^{2} \\sin(2 \\pi x) - (4 \\pi)^{2} \\tfrac{1}{2} \\cos(4 \\pi x)$。使用 $a = 1$ 和 $D = 10^{-2}$。\n\n为 $a > 0$ 定义离散平流算子近似：\n- 一阶迎风平流格式：$L^{h}_{\\mathrm{adv,up}}(u)_{i} = a \\, (u_{i} - u_{i-1}) / h$。\n- 二阶中心平流格式：$L^{h}_{\\mathrm{adv,cd}}(u)_{i} = a \\, (u_{i+1} - u_{i-1}) / (2 h)$。\n\n定义离散扩散算子近似：\n- 二阶中心扩散格式：$L^{h}_{\\mathrm{diff,cd}}(u)_{i} = D \\, (u_{i-1} - 2 u_{i} + u_{i+1}) / h^{2}$。\n\n对于每个网格尺寸 $N$，计算每个离散算子与其应用于人工解的精确对应算子之间的离散 $L^{2}$ 误差范数：\n- 迎风平流误差：$E_{\\mathrm{adv,up}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[L^{h}_{\\mathrm{adv,up}}(u)_{i} - a \\, (\\partial u / \\partial x)(x_{i}) \\right]^{2} \\, h \\right)^{1/2}$。\n- 中心平流误差：$E_{\\mathrm{adv,cd}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[L^{h}_{\\mathrm{adv,cd}}(u)_{i} - a \\, (\\partial u / \\partial x)(x_{i}) \\right]^{2} \\, h \\right)^{1/2}$。\n- 中心扩散误差：$E_{\\mathrm{diff,cd}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[L^{h}_{\\mathrm{diff,cd}}(u)_{i} - D \\, (\\partial^{2} u / \\partial x^{2})(x_{i}) \\right]^{2} \\, h \\right)^{1/2}$。\n\n每个离散格式的观测精度阶 $p$ 是通过对一系列加密网格上的数据对 $(\\log h, \\log E(h))$ 使用最小二乘法，用常数 $C$ 和 $p$ 拟合模型 $E(h) = C \\, h^{p}$ 得到的。也就是说，对于每个离散格式，计算 $p$ 作为 $\\log E(h)$ 相对于 $\\log h$ 的最佳拟合线的斜率，其中 $h = 1/N$。\n\n使用三个网格加密序列构成测试套件，涵盖一般情况、粗网格边界情况和更高分辨率情况：\n- 序列 $\\mathcal{S}_{A}$：$N \\in \\{8, 16, 32, 64\\}$。\n- 序列 $\\mathcal{S}_{B}$：$N \\in \\{12, 24, 48, 96\\}$。\n- 序列 $\\mathcal{S}_{C}$：$N \\in \\{30, 60, 120, 240\\}$。\n\n对于每个序列，计算并报告三种离散格式的观测精度阶：$p_{\\mathrm{adv,up}}$、$p_{\\mathrm{adv,cd}}$ 和 $p_{\\mathrm{diff,cd}}$。所有量均为无量纲。将每个报告的观测精度阶表示为四舍五入到4位小数的浮点数。\n\n您的程序应生成单行输出，包含按顺序排列的 9 个结果：$\\left[p_{\\mathrm{adv,up}}(\\mathcal{S}_{A}), p_{\\mathrm{adv,cd}}(\\mathcal{S}_{A}), p_{\\mathrm{diff,cd}}(\\mathcal{S}_{A}), p_{\\mathrm{adv,up}}(\\mathcal{S}_{B}), p_{\\mathrm{adv,cd}}(\\mathcal{S}_{B}), p_{\\mathrm{diff,cd}}(\\mathcal{S}_{B}), p_{\\mathrm{adv,up}}(\\mathcal{S}_{C}), p_{\\mathrm{adv,cd}}(\\mathcal{S}_{C}), p_{\\mathrm{diff,cd}}(\\mathcal{S}_{C})\\right]$，形式为方括号括起来的逗号分隔列表（例如 $[r_{1},r_{2},\\dots,r_{9}]$）。不得打印任何其他文本。",
            "solution": "该问题是有效的，因为它提出了一个基于 Method of Manufactured Solutions (MMS) 的适定且具有科学依据的任务，MMS 是计算科学中的一种标准验证程序。所有必需的数据、函数和方法均已提供，问题没有矛盾或含糊之处。\n\n目标是计算平流和扩散算子的三种不同有限差分离散格式的观测精度阶。这通过应用 Method of Manufactured Solutions (MMS) 来完成，其中一个已知的、被称为人工解的光滑函数被用作量化离散误差的基础。精度阶，用 $p$ 表示，描述了误差 $E$ 如何随着网格间距 $h$ 的减小而减小，遵循幂律关系 $E(h) \\approx C h^{p}$，其中 $C$ 是一个常数。\n\n人工解在周期域 $x \\in [0, 1)$ 上给出为 $u(x) = \\sin(2 \\pi x) + \\tfrac{1}{2} \\cos(4 \\pi x)$。问题在一个具有 $N$ 个点的均匀网格上进行评估，网格间距为 $h = 1/N$，网格点为 $x_i = i h$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。常数参数为平流速度 $a=1$ 和扩散系数 $D=10^{-2}$。\n\n人工解的精确一阶和二阶导数是：\n$$\n\\frac{\\partial u}{\\partial x} = 2 \\pi \\cos(2 \\pi x) - 2 \\pi \\sin(4 \\pi x)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = - (2 \\pi)^2 \\sin(2 \\pi x) - \\frac{(4 \\pi)^2}{2} \\cos(4 \\pi x)\n$$\n\n我们将分析三个离散算子：\n1.  **一阶迎风平流格式 ($L^{h}_{\\mathrm{adv,up}}$):** 该格式理论上为一阶精度，因此我们期望观测到 $p_{\\mathrm{adv,up}} \\approx 1$。\n    $$\n    L^{h}_{\\mathrm{adv,up}}(u)_{i} = a \\frac{u_i - u_{i-1}}{h}\n    $$\n2.  **二阶中心平流格式 ($L^{h}_{\\mathrm{adv,cd}}$):** 该格式理论上为二阶精度，因此我们期望观测到 $p_{\\mathrm{adv,cd}} \\approx 2$。\n    $$\n    L^{h}_{\\mathrm{adv,cd}}(u)_{i} = a \\frac{u_{i+1} - u_{i-1}}{2h}\n    $$\n3.  **二阶中心扩散格式 ($L^{h}_{\\mathrm{diff,cd}}$):** 该格式理论上也是二阶精度，因此我们期望观测到 $p_{\\mathrm{diff,cd}} \\approx 2$。\n    $$\n    L^{h}_{\\mathrm{diff,cd}}(u)_{i} = D \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2}\n    $$\n在所有情况下，都应用周期性边界条件，使得 $u_{-1} = u_{N-1}$ 和 $u_N = u_0$。\n\n对于这些算子中的每一个以及一系列网格尺寸 $N$，我们计算离散 $L^2$ 误差范数。例如，对于迎风平流格式，误差为：\n$$\nE_{\\mathrm{adv,up}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[ L^{h}_{\\mathrm{adv,up}}(u)_{i} - a \\left(\\frac{\\partial u}{\\partial x}\\right)(x_i) \\right]^2 h \\right)^{1/2}\n$$\n类似的公式也适用于另外两个算子，将它们分别与相应的精确解析算子 $a (\\partial u / \\partial x)$ 和 $D (\\partial^2 u / \\partial x^2)$ 进行比较。\n\n观测精度阶 $p$ 是根据一系列网格间距 $\\{h_j\\}$ 的计算误差值集合 $\\{E(h_j)\\}$ 来确定的。对误差模型 $E(h) = C h^p$ 取自然对数，得到一个线性关系：\n$$\n\\ln(E(h)) = p \\ln(h) + \\ln(C)\n$$\n这是一个形如 $y = mx + c$ 的方程，其中 $y = \\ln(E(h))$，斜率 $m$ 是精度阶 $p$，自变量是 $x = \\ln(h)$。因此，我们可以通过对每个网格加密序列 $\\mathcal{S}_A$、$\\mathcal{S}_B$ 和 $\\mathcal{S}_C$ 生成的数据点集 $(\\ln(h_j), \\ln(E(h_j)))$ 进行线性最小二乘回归，来为每个算子计算 $p$。对三个算子中的每一个重复此过程，总共得到 9 个精度阶的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.stats\n\ndef solve():\n    \"\"\"\n    Computes the observed order of accuracy for finite-difference discretizations\n    of advection and diffusion operators using the Method of Manufactured Solutions.\n    \"\"\"\n    # Define constants and manufactured solution functions\n    A_COEFF = 1.0\n    D_COEFF = 1.0e-2\n\n    def u_manufactured(x):\n        \"\"\"The manufactured solution u(x).\"\"\"\n        return np.sin(2 * np.pi * x) + 0.5 * np.cos(4 * np.pi * x)\n\n    def du_dx_exact(x):\n        \"\"\"The exact first derivative of u(x).\"\"\"\n        return 2 * np.pi * np.cos(2 * np.pi * x) - 2 * np.pi * np.sin(4 * np.pi * x)\n\n    def d2u_dx2_exact(x):\n        \"\"\"The exact second derivative of u(x).\"\"\"\n        return -(2 * np.pi)**2 * np.sin(2 * np.pi * x) - 0.5 * (4 * np.pi)**2 * np.cos(4 * np.pi * x)\n\n    # Define the grid refinement sequences\n    sequences = {\n        \"S_A\": [8, 16, 32, 64],\n        \"S_B\": [12, 24, 48, 96],\n        \"S_C\": [30, 60, 120, 240],\n    }\n\n    all_results = []\n    \n    # Process each sequence in the specified order\n    for seq_name in [\"S_A\", \"S_B\", \"S_C\"]:\n        Ns = sequences[seq_name]\n        \n        log_h_vals = []\n        log_err_adv_up = []\n        log_err_adv_cd = []\n        log_err_diff_cd = []\n\n        # Calculate errors for each grid size N in the current sequence\n        for N in Ns:\n            h = 1.0 / N\n            x = np.arange(N) * h\n            log_h_vals.append(np.log(h))\n\n            # Evaluate the manufactured solution and its exact derivatives on the grid\n            u_vals = u_manufactured(x)\n            dudx_vals = du_dx_exact(x)\n            d2udx2_vals = d2u_dx2_exact(x)\n            \n            # Use np.roll for efficient implementation of periodic boundary conditions\n            u_im1 = np.roll(u_vals, 1)  # u_{i-1}\n            u_ip1 = np.roll(u_vals, -1) # u_{i+1}\n\n            # Compute discrete operators\n            L_adv_up = A_COEFF * (u_vals - u_im1) / h\n            L_adv_cd = A_COEFF * (u_ip1 - u_im1) / (2 * h)\n            L_diff_cd = D_COEFF * (u_im1 - 2 * u_vals + u_ip1) / (h**2)\n\n            # Compute errors between discrete and exact operators\n            err_vec_adv_up = L_adv_up - A_COEFF * dudx_vals\n            err_vec_adv_cd = L_adv_cd - A_COEFF * dudx_vals\n            err_vec_diff_cd = L_diff_cd - D_COEFF * d2udx2_vals\n\n            # Compute discrete L2 error norms and store their logarithms\n            # L2 norm is sqrt(sum(error_i^2 * h))\n            err_norm_adv_up = np.sqrt(np.sum(err_vec_adv_up**2) * h)\n            err_norm_adv_cd = np.sqrt(np.sum(err_vec_adv_cd**2) * h)\n            err_norm_diff_cd = np.sqrt(np.sum(err_vec_diff_cd**2) * h)\n            \n            log_err_adv_up.append(np.log(err_norm_adv_up))\n            log_err_adv_cd.append(np.log(err_norm_adv_cd))\n            log_err_diff_cd.append(np.log(err_norm_diff_cd))\n\n        # Perform linear regression to find the slope (order of accuracy p)\n        # for each discretization scheme\n        p_adv_up = scipy.stats.linregress(log_h_vals, log_err_adv_up).slope\n        p_adv_cd = scipy.stats.linregress(log_h_vals, log_err_adv_cd).slope\n        p_diff_cd = scipy.stats.linregress(log_h_vals, log_err_diff_cd).slope\n        \n        all_results.extend([p_adv_up, p_adv_cd, p_diff_cd])\n\n    # Format results to 4 decimal places as required\n    formatted_results = [f\"{r:.4f}\" for r in all_results]\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于显式时间积分方案，数值稳定性是成功模拟的关键，而时间步长的选择则直接决定了稳定性。本练习 () 将指导您如何综合考虑对流、扩散和化学反应这三个不同物理过程所施加的稳定性约束。通过计算，您将确定一个能同时满足所有约束的最严格时间步长 $\\Delta t$，这是运行稳定显式模拟的一项核心技能。",
            "id": "4006741",
            "problem": "一个二维反应流求解器使用全显式、非分裂算法推进一个由平流、扩散和反应控制的输运标量 $Y$。该算法采用三阶强稳定保持（SSP）龙格-库塔（RK3）进行时间积分，使用五阶加权基本无振荡（WENO）通量处理平流项，并使用二阶中心差分处理扩散项。这种显式推进的稳定性由三个尺度约束控制，分别与平流（通过柯朗-弗里德里希斯-列维（CFL）数）、扩散（通过抛物线型稳定性数）和刚性化学反应（通过反应雅可比矩阵的线性测试方程界限）相关联。对于这种特定的离散化方案和网格，先前对组合空间算子与SSP–RK3进行的线性稳定性分析得出了三个无量纲的边界常数 $C_{\\mathrm{adv}}$、$C_{\\mathrm{diff}}$ 和 $C_{\\mathrm{react}}$。这些常数量化了相关放大因子负实轴上允许的最大归一化步长。\n\n考虑一个矩形域，其长度为 $L_{x} = 0.03\\ \\mathrm{m}$ 和 $L_{y} = 0.012\\ \\mathrm{m}$，并分别用 $N_{x} = 300$ 和 $N_{y} = 100$ 个单元进行均匀离散。在 $x$ 方向和 $y$ 方向上，可解析的最大平流速度分别为 $u_{\\max} = 12\\ \\mathrm{m/s}$ 和 $v_{\\max} = 3\\ \\mathrm{m/s}$。物质扩散系数为 $D = 1.5 \\times 10^{-4}\\ \\mathrm{m^{2}/s}$。在遇到的最刚性状态下，反应雅可比矩阵的最大（负实部）特征值的大小为 $|\\lambda_{\\max}| = 2.0 \\times 10^{5}\\ \\mathrm{s^{-1}}$。该算法和网格的稳定性边界常数为 $C_{\\mathrm{adv}} = 0.60$，$C_{\\mathrm{diff}} = 0.22$ 和 $C_{\\mathrm{react}} = 2.50$。\n\n使用多维反应流求解器中显式方法的基本稳定性原理，计算单一显式时间步长限制 $\\Delta t$，该步长需同时满足此配置下由平流、扩散和反应施加的所有三个约束。将最终结果四舍五入至三位有效数字，并以微秒（即 $\\mathrm{\\mu s}$）为单位表示。",
            "solution": "该问题被认为是有效的。这是一个在计算科学领域，特别是反应流数值分析领域中，提法恰当且具有科学依据的问题。它提供了所有必要的数据，并使用了清晰、客观的语言。任务是为一个由多个并发物理过程控制的全显式、非分裂数值算法确定最大稳定时间步长。\n\n显式、非分裂时间积分方案稳定性的基本原理是，单个时间步长 $\\Delta t$ 必须足够小，以解析系统中最快的动力学过程。这些动力学过程源于平流、扩散和化学反应。问题以无量纲边界常数的形式为这些过程中的每一个提供了稳定性判据。总时间步长 $\\Delta t$ 必须同时满足所有三个约束。这意味着 $\\Delta t$ 必须小于或等于每个过程单独施加的时间步长限制。在数学上，这表示为：\n$$ \\Delta t \\leq \\min(\\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{react}}) $$\n其中 $\\Delta t_{\\mathrm{adv}}$、$\\Delta t_{\\mathrm{diff}}$ 和 $\\Delta t_{\\mathrm{react}}$ 分别是平流、扩散和反应所允许的最大时间步长。我们将分别计算这些限制。\n\n首先，我们必须计算每个坐标方向上的网格间距 $\\Delta x$ 和 $\\Delta y$。\n给定域长度 $L_{x} = 0.03\\ \\mathrm{m}$ 和 $L_{y} = 0.012\\ \\mathrm{m}$，以及单元数 $N_{x} = 300$ 和 $N_{y} = 100$：\n$$ \\Delta x = \\frac{L_{x}}{N_{x}} = \\frac{0.03\\ \\mathrm{m}}{300} = 0.0001\\ \\mathrm{m} = 1.0 \\times 10^{-4}\\ \\mathrm{m} $$\n$$ \\Delta y = \\frac{L_{y}}{N_{y}} = \\frac{0.012\\ \\mathrm{m}}{100} = 0.00012\\ \\mathrm{m} = 1.2 \\times 10^{-4}\\ \\mathrm{m} $$\n\n现在，我们计算三个时间步长限制。\n\n1.  **平流时间步长限制 ($\\Delta t_{\\mathrm{adv}}$)**\n平流约束是一个多维的柯朗-弗里德里希斯-列维（CFL）条件。其稳定性判据由下式给出：\n$$ \\Delta t_{\\mathrm{adv}} \\left( \\frac{u_{\\max}}{\\Delta x} + \\frac{v_{\\max}}{\\Delta y} \\right) \\leq C_{\\mathrm{adv}} $$\n求解 $\\Delta t_{\\mathrm{adv}}$：\n$$ \\Delta t_{\\mathrm{adv}} = \\frac{C_{\\mathrm{adv}}}{\\frac{u_{\\max}}{\\Delta x} + \\frac{v_{\\max}}{\\Delta y}} $$\n使用所给定的值 $u_{\\max} = 12\\ \\mathrm{m/s}$，$v_{\\max} = 3\\ \\mathrm{m/s}$ 和 $C_{\\mathrm{adv}} = 0.60$：\n$$ \\frac{u_{\\max}}{\\Delta x} = \\frac{12\\ \\mathrm{m/s}}{1.0 \\times 10^{-4}\\ \\mathrm{m}} = 1.2 \\times 10^{5}\\ \\mathrm{s^{-1}} $$\n$$ \\frac{v_{\\max}}{\\Delta y} = \\frac{3\\ \\mathrm{m/s}}{1.2 \\times 10^{-4}\\ \\mathrm{m}} = 2.5 \\times 10^{4}\\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{\\mathrm{adv}} = \\frac{0.60}{(1.2 \\times 10^{5} + 2.5 \\times 10^{4})\\ \\mathrm{s^{-1}}} = \\frac{0.60}{1.45 \\times 10^{5}\\ \\mathrm{s^{-1}}} \\approx 4.1379 \\times 10^{-6}\\ \\mathrm{s} $$\n\n2.  **扩散时间步长限制 ($\\Delta t_{\\mathrm{diff}}$)**\n扩散约束（或称抛物线型约束）将时间步长与物质跨网格单元的扩散速率联系起来。对于二维的二阶中心差分格式，其稳定性判据为：\n$$ \\Delta t_{\\mathrm{diff}} \\cdot D \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right) \\leq C_{\\mathrm{diff}} $$\n求解 $\\Delta t_{\\mathrm{diff}}$：\n$$ \\Delta t_{\\mathrm{diff}} = \\frac{C_{\\mathrm{diff}}}{D \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right)} $$\n使用所给定的值 $D = 1.5 \\times 10^{-4}\\ \\mathrm{m^{2}/s}$ 和 $C_{\\mathrm{diff}} = 0.22$：\n$$ \\frac{1}{\\Delta x^2} = \\frac{1}{(1.0 \\times 10^{-4}\\ \\mathrm{m})^2} = 1.0 \\times 10^{8}\\ \\mathrm{m^{-2}} $$\n$$ \\frac{1}{\\Delta y^2} = \\frac{1}{(1.2 \\times 10^{-4}\\ \\mathrm{m})^2} = \\frac{1}{1.44 \\times 10^{-8}\\ \\mathrm{m^2}} \\approx 6.9444 \\times 10^{7}\\ \\mathrm{m^{-2}} $$\n$$ \\Delta t_{\\mathrm{diff}} = \\frac{0.22}{(1.5 \\times 10^{-4}\\ \\mathrm{m^{2}/s}) \\left( 1.0 \\times 10^{8}\\ \\mathrm{m^{-2}} + 6.9444 \\times 10^{7}\\ \\mathrm{m^{-2}} \\right)} $$\n$$ \\Delta t_{\\mathrm{diff}} = \\frac{0.22}{(1.5 \\times 10^{-4}) (1.69444 \\times 10^{8})\\ \\mathrm{s^{-1}}} = \\frac{0.22}{2.54167 \\times 10^{4}\\ \\mathrm{s^{-1}}} \\approx 8.6558 \\times 10^{-6}\\ \\mathrm{s} $$\n\n3.  **反应时间步长限制 ($\\Delta t_{\\mathrm{react}}$)**\n反应约束由化学动力学的刚性决定，其特征是反应雅可比矩阵的最大模特征值 $|\\lambda_{\\max}|$。其稳定性判据为：\n$$ \\Delta t_{\\mathrm{react}} \\cdot |\\lambda_{\\max}| \\leq C_{\\mathrm{react}} $$\n求解 $\\Delta t_{\\mathrm{react}}$：\n$$ \\Delta t_{\\mathrm{react}} = \\frac{C_{\\mathrm{react}}}{|\\lambda_{\\max}|} $$\n使用所给定的值 $|\\lambda_{\\max}| = 2.0 \\times 10^{5}\\ \\mathrm{s^{-1}}$ 和 $C_{\\mathrm{react}} = 2.50$：\n$$ \\Delta t_{\\mathrm{react}} = \\frac{2.50}{2.0 \\times 10^{5}\\ \\mathrm{s^{-1}}} = 1.25 \\times 10^{-5}\\ \\mathrm{s} $$\n\n最后，我们比较这三个时间步长限制，以找到总的最大稳定时间步长 $\\Delta t$：\n$$ \\Delta t = \\min(\\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{react}}) $$\n$$ \\Delta t = \\min(4.1379 \\times 10^{-6}\\ \\mathrm{s}, 8.6558 \\times 10^{-6}\\ \\mathrm{s}, 1.25 \\times 10^{-5}\\ \\mathrm{s}) $$\n最小值由平流约束控制：\n$$ \\Delta t = 4.1379 \\times 10^{-6}\\ \\mathrm{s} $$\n题目要求结果以微秒（$\\mu\\mathrm{s}$）表示，并四舍五入到三位有效数字。\n$$ \\Delta t = 4.1379\\ \\mu\\mathrm{s} \\approx 4.14\\ \\mu\\mathrm{s} $$\n因此，该模拟的单一显式时间步长受限于平流现象。",
            "answer": "$$\\boxed{4.14}$$"
        },
        {
            "introduction": "在反应流模拟中，由于数值误差的累积，尤其是在算子分裂格式中，计算出的组分质量分数可能会出现非物理值（如负值）。本练习 () 介绍了一种确保解的物理真实性的重要算法步骤。您将学习如何通过求解一个约束优化问题来施加质量守恒 $\\sum_{k} Y_{k} = 1$ 和非负性 $Y_{k} \\ge 0$ 的约束，从而以最小的扰动修正解，这对于维持求解器的长期稳定性和结果的物理一致性至关重要。",
            "id": "4006792",
            "problem": "考虑一个基于有限体积法 (FVM) 的计算燃烧学反应流求解器中的反应流单元更新。在一个时间分裂步（先进行对流-扩散，然后进行化学反应）之后，假设单元平均的组分质量分数被更新为一个向量 $\\boldsymbol{Y}^{\\mathrm{upd}} \\in \\mathbb{R}^{5}$，其分量为\n$$\n\\boldsymbol{Y}^{\\mathrm{upd}} = \\left( 0.40,\\ 0.35,\\ 0.20,\\ 0.08,\\ -0.03 \\right).\n$$\n在一个物理上一致的混合物中，组分质量分数必须满足质量守恒约束 $\\sum_{k=1}^{5} Y_{k} = 1$ 和对所有 $k$ 的非负性约束 $Y_{k} \\geq 0$。为了在反应流求解器的算法结构中强制施加这些约束，同时对更新后的状态进行最小扰动，我们通过求解以下问题来定义修正向量 $\\boldsymbol{\\delta} \\in \\mathbb{R}^{5}$：\n$$\n\\min_{\\boldsymbol{\\delta} \\in \\mathbb{R}^{5}} \\ \\|\\boldsymbol{\\delta}\\|_{2} \\quad \\text{subject to} \\quad \\sum_{k=1}^{5} \\left(Y_{k}^{\\mathrm{upd}} + \\delta_{k}\\right) = 1, \\quad Y_{k}^{\\mathrm{upd}} + \\delta_{k} \\geq 0 \\ \\ \\text{for all } k,\n$$\n其中 $\\|\\cdot\\|_{2}$ 表示欧几里得范数。该问题形式化了将 $\\boldsymbol{Y}^{\\mathrm{upd}}$ 投影到与非负且总和为1的质量分数相关的概率单纯形上所需的最小欧几里得变化。\n\n从质量守恒和组分质量分数的定义出发，由第一性原理推导充分必要的最优性条件，并为给定的 $\\boldsymbol{Y}^{\\mathrm{upd}}$ 计算出解决上述优化问题的唯一修正向量 $\\boldsymbol{\\delta}^{\\star}$。将最终答案表示为 $\\boldsymbol{\\delta}^{\\star}$ 各分量的行向量。无需四舍五入。",
            "solution": "基本依据是混合物的质量守恒，它要求组分质量分数满足 $\\sum_{k=1}^{N_{s}} Y_{k} = 1$ 和物理可实现性约束 $Y_{k} \\geq 0$。在反应流求解器的算法结构中，更新步骤之后的 $\\boldsymbol{Y}^{\\mathrm{upd}}$ 可能会违反非负性，并且（通常）其总和可能不为1。因此，我们寻求在欧几里得意义下的最小修正，以同时施加这两个约束。\n\n我们将此修正形式化为将 $\\boldsymbol{Y}^{\\mathrm{upd}}$ 投影到可行集 $\\mathcal{S}$ 上：\n$$\n\\mathcal{S} = \\left\\{ \\boldsymbol{y} \\in \\mathbb{R}^{5} \\ \\bigg| \\ \\sum_{k=1}^{5} y_{k} = 1, \\ \\ y_{k} \\geq 0 \\ \\ \\forall k \\right\\}.\n$$\n定义 $\\boldsymbol{y} = \\boldsymbol{Y}^{\\mathrm{upd}} + \\boldsymbol{\\delta}$。那么问题\n$$\n\\min_{\\boldsymbol{\\delta}} \\ \\|\\boldsymbol{\\delta}\\|_{2} \\quad \\text{subject to} \\quad \\sum_{k=1}^{5} \\left(Y_{k}^{\\mathrm{upd}} + \\delta_{k}\\right) = 1, \\ \\ Y_{k}^{\\mathrm{upd}} + \\delta_{k} \\geq 0\n$$\n等价于将 $\\boldsymbol{Y}^{\\mathrm{upd}}$ 投影到 $\\mathcal{S}$ 上的欧几里得投影问题：\n$$\n\\min_{\\boldsymbol{y} \\in \\mathcal{S}} \\ \\frac{1}{2} \\|\\boldsymbol{y} - \\boldsymbol{Y}^{\\mathrm{upd}}\\|_{2}^{2}.\n$$\n这是一个带有线性等式和不等式约束的严格凸二次规划问题，因此它存在唯一解。我们推导 Karush-Kuhn-Tucker (KKT) 条件来刻画最优点。\n\n构造拉格朗日函数\n$$\n\\mathcal{L}(\\boldsymbol{y}, \\lambda, \\boldsymbol{\\mu}) = \\frac{1}{2} \\sum_{k=1}^{5} \\left(y_{k} - Y_{k}^{\\mathrm{upd}}\\right)^{2} + \\lambda \\left( \\sum_{k=1}^{5} y_{k} - 1 \\right) - \\sum_{k=1}^{5} \\mu_{k} y_{k},\n$$\n其中 $\\lambda \\in \\mathbb{R}$ 是等式约束的乘子，$\\mu_{k} \\geq 0$ 是 $y_{k} \\geq 0$ 的乘子。KKT 条件如下：\n\n1. 稳定性条件：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial y_{k}} = y_{k} - Y_{k}^{\\mathrm{upd}} + \\lambda - \\mu_{k} = 0, \\quad k=1,\\dots,5.\n$$\n\n2. 原始可行性：\n$$\n\\sum_{k=1}^{5} y_{k} = 1, \\quad y_{k} \\geq 0 \\ \\ \\forall k.\n$$\n\n3. 对偶可行性：\n$$\n\\mu_{k} \\geq 0 \\ \\ \\forall k.\n$$\n\n4. 互补松弛性：\n$$\n\\mu_{k} y_{k} = 0 \\ \\ \\forall k.\n$$\n\n从稳定性条件可知，对每个 $k$：\n$$\ny_{k} = Y_{k}^{\\mathrm{upd}} - \\lambda + \\mu_{k}.\n$$\n如果 $y_{k} > 0$，由互补松弛性可知 $\\mu_{k} = 0$，因此对于激活（严格为正）的分量，\n$$\ny_{k} = Y_{k}^{\\mathrm{upd}} - \\lambda.\n$$\n如果 $y_{k} = 0$，则 $\\mu_{k} \\geq 0$ 会进行调整以满足稳定性条件，我们可以将解紧凑地写为\n$$\ny_{k} = \\max\\!\\left( Y_{k}^{\\mathrm{upd}} - \\lambda, \\ 0 \\right), \\quad k=1,\\dots,5,\n$$\n其中阈值 $\\lambda$ 的选择是为了施加等式约束。这是欧几里得投影到概率单纯形上的一个众所周知的刻画。\n\n因此，等式约束 $\\sum_{k=1}^{5} y_{k} = 1$ 变成了一个标量方程\n$$\n\\sum_{k=1}^{5} \\max\\!\\left( Y_{k}^{\\mathrm{upd}} - \\lambda, \\ 0 \\right) = 1.\n$$\n为了解出 $\\lambda$，我们确定解处的激活集 $\\mathcal{A} = \\{ k \\mid Y_{k}^{\\mathrm{upd}} - \\lambda > 0 \\}$。一个实用的方法是将 $Y_{k}^{\\mathrm{upd}}$ 按降序排列，并测试候选激活集的大小。对于给定的数据\n$$\n\\boldsymbol{Y}^{\\mathrm{upd}} = \\left( 0.40,\\ 0.35,\\ 0.20,\\ 0.08,\\ -0.03 \\right),\n$$\n一个可能的激活集是 $\\mathcal{A} = \\{1,2,3,4\\}$（前四个分量），因为第五个分量已经是负数，投影后很可能变为零。假设 $|\\mathcal{A}| = m = 4$，等式约束简化为\n$$\n\\sum_{k \\in \\mathcal{A}} \\left( Y_{k}^{\\mathrm{upd}} - \\lambda \\right) = 1 \\quad \\Longrightarrow \\quad \\left( \\sum_{k \\in \\mathcal{A}} Y_{k}^{\\mathrm{upd}} \\right) - m \\lambda = 1.\n$$\n计算激活集上的和：\n$$\n\\sum_{k \\in \\mathcal{A}} Y_{k}^{\\mathrm{upd}} = 0.40 + 0.35 + 0.20 + 0.08 = 1.03.\n$$\n然后\n$$\n1.03 - 4 \\lambda = 1 \\quad \\Longrightarrow \\quad \\lambda = \\frac{1.03 - 1}{4} = 0.0075.\n$$\n我们必须验证激活集的一致性：对于 $k \\in \\mathcal{A}$，\n$$\nY_{k}^{\\mathrm{upd}} - \\lambda > 0 \\quad \\text{and for} \\quad k \\notin \\mathcal{A}, \\quad Y_{k}^{\\mathrm{upd}} - \\lambda \\leq 0.\n$$\n检查最小的激活分量：\n$$\n0.08 - 0.0075 = 0.0725 > 0,\n$$\n和非激活分量：\n$$\n-0.03 - 0.0075 = -0.0375 \\leq 0.\n$$\n因此，所假设的激活集是正确的。因此，投影后的质量分数为\n$$\n\\boldsymbol{y}^{\\star} = \\left( \\max(0.40 - 0.0075, 0), \\ \\max(0.35 - 0.0075, 0), \\ \\max(0.20 - 0.0075, 0), \\ \\max(0.08 - 0.0075, 0), \\ \\max(-0.03 - 0.0075, 0) \\right)\n$$\n$$\n= \\left( 0.3925,\\ 0.3425,\\ 0.1925,\\ 0.0725,\\ 0 \\right).\n$$\n因此，最小修正向量 $\\boldsymbol{\\delta}^{\\star} = \\boldsymbol{y}^{\\star} - \\boldsymbol{Y}^{\\mathrm{upd}}$ 为\n$$\n\\boldsymbol{\\delta}^{\\star} = \\left( 0.3925 - 0.40,\\ 0.3425 - 0.35,\\ 0.1925 - 0.20,\\ 0.0725 - 0.08,\\ 0 - (-0.03) \\right)\n$$\n$$\n= \\left( -0.0075,\\ -0.0075,\\ -0.0075,\\ -0.0075,\\ 0.03 \\right).\n$$\n我们可以验证约束条件：$\\sum_{k=1}^{5} \\left(Y_{k}^{\\mathrm{upd}} + \\delta_{k}^{\\star}\\right) = \\sum_{k=1}^{5} y_{k}^{\\star} = 1$ 且对所有 $k$ 都有 $Y_{k}^{\\mathrm{upd}} + \\delta_{k}^{\\star} \\geq 0$，其中第五个分量恰好变为零。根据目标函数的严格凸性和约束的线性，该解是唯一的，并且最小化了 $\\|\\boldsymbol{\\delta}\\|_{2}$。\n\n因此，最小修正向量是\n$$\n\\boldsymbol{\\delta}^{\\star} = \\left( -0.0075,\\ -0.0075,\\ -0.0075,\\ -0.0075,\\ 0.03 \\right).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-0.0075 & -0.0075 & -0.0075 & -0.0075 & 0.03\\end{pmatrix}}$$"
        }
    ]
}