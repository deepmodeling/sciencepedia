## 引言
[反应流](@entry_id:190741)求解器是计算燃烧学乃至更广泛科学与工程领域中不可或缺的仿真工具，它们使我们能够以前所未有的细节洞察和预测从内燃机到星体演化等复杂现象。然而，构建一个准确、高效且鲁棒的求解器是一项艰巨的任务。其核心挑战在于反应流固有的多尺度特性——化学反应的时间尺度可跨越从纳秒到秒的多个数量级，而火焰锋面等空间结构又极其薄，这给[数值模拟](@entry_id:146043)带来了严峻的“刚性”问题。直接应用标准数值方法往往会导致无法接受的计算成本或不稳定的计算结果。

本文旨在系统性地揭示现代[反应流](@entry_id:190741)求解器背后的算法结构，以应对上述挑战。我们将带领读者深入探索这些复杂软件系统的内部工作机制。首先，在“原理与机制”一章中，我们将从控制方程出发，剖析刚性问题的根源，并介绍算子分裂、IMEX积分和[低马赫数近似](@entry_id:1127479)等基本应对策略。接着，“应用与跨学科交叉”一章将展示这些原理如何被组装成功能完备的求解器，并讨论自适应网格加密（[AMR](@entry_id:204220)）、与[湍流](@entry_id:151300)物理、高性能计算（HPC）和机器学习等前沿领域的深刻融合。最后，“动手实践”部分将提供具体的编程练习，帮助读者将理论知识转化为实践技能。通过这一结构化的学习路径，读者将全面掌握构建和理解高性能反应流求解器所需的关键知识。

## 原理与机制

本章旨在深入阐述[反应流](@entry_id:190741)求解器的核心原理和算法机制。继前一章对计算燃烧学领域的宏观介绍之后，我们将在此系统地剖析控制[反应流](@entry_id:190741)动的物理方程、这些方程所带来的独特数值挑战，以及为应对这些挑战而发展起来的关键算法策略。本章的探讨将从基本守恒定律出发，逐步深入到化学源项的构建、多尺度刚性问题的本质，并最终介绍现代求解器中广泛采用的算子分裂、隐式-显式（IMEX）时间积分方案以及针对低速燃烧的专门化[低马赫数方法](@entry_id:1127482)。

### [反应流](@entry_id:190741)的控制方程

任何[反应流](@entry_id:190741)模拟的基石都是一组描述质量、动量、能量和组分[质量守恒](@entry_id:204015)的[偏微分](@entry_id:194612)方程（PDEs）。对于一个可压缩、多组分、牛顿[流体混合物](@entry_id:190732)，这组方程通常以[守恒形式](@entry_id:1122899)写出，因为它在[数值离散化](@entry_id:752782)中，尤其是在存在激波或其他间断的情况下，具有良好的性质。该方程组的通用形式为：

$ \frac{\partial U}{\partial t} + \nabla \cdot F^{\text{adv}}(U) = \nabla \cdot F^{\text{diff}}(U, \nabla U) + S(U) $

此处，$U$ 是[守恒变量](@entry_id:747720)矢量，$F^{\text{adv}}$ 和 $F^{\text{diff}}$ 分别是对流（或称平流）通量矢量和[扩散通量](@entry_id:748422)矢量，$S$ 是源项矢量。

在一个包含 $N_s$ 个组分的系统中，守恒变量矢量 $U$ 的典型定义为 ：

$ U = [\rho, \rho\boldsymbol{u}, \rho E, \rho Y_1, \ldots, \rho Y_{N_s-1}]^T $

其中 $\rho$ 是混合物密度，$\boldsymbol{u}$ 是[质量平均速度](@entry_id:149575)矢量，$\rho\boldsymbol{u}$ 是[动量密度](@entry_id:271360)，$E$ 是单位质量总能量，$\rho E$ 是总能量密度，$Y_k$ 是组分 $k$ 的[质量分数](@entry_id:161575)，$\rho Y_k$ 是组分 $k$ 的质量浓度。注意，由于质量分数之和恒为1（$\sum_{k=1}^{N_s} Y_k = 1$），通常只需解 $N_s-1$ 个组分方程，第 $N_s$ 个组分的质量分数可以通过代数关系得到。

下面我们详细阐述方程中各个项的物理构成：

**对流通量 $F^{\text{adv}}(U)$** 描述了流体宏观运动所携带的[守恒量](@entry_id:161475)的输运。其各项分别为：
*   **质量通量**: $\rho\boldsymbol{u}$
*   **动量通量**: $\rho\boldsymbol{u}\boldsymbol{u} + p\boldsymbol{I}$，其中 $\rho\boldsymbol{u}\boldsymbol{u}$ 是动量的对流输运，$p\boldsymbol{I}$ 是由压力 $p$ 作用在流体微元表面产生的力，此处 $\boldsymbol{I}$ 是单位张量。
*   **[能量通量](@entry_id:266056)**: $(\rho E + p)\boldsymbol{u}$，其中 $\rho E\boldsymbol{u}$ 是总能量的对流输运，$p\boldsymbol{u}$ 是压力做的功（或称压力功通量）。
*   **组分质量通量**: $\rho Y_k \boldsymbol{u}$

**[扩散通量](@entry_id:748422) $F^{\text{diff}}(U, \nabla U)$** 描述了由分子随机运动引起的微观输运现象，这些现象倾向于抹平梯度。其各项为 ：
*   **质量通量**: $\boldsymbol{0}$。在[质量平均速度](@entry_id:149575)的定义下，所有组分扩散质量通量之和为零，因此总质量没有净扩散。
*   **动量通量**: $\boldsymbol{\tau}$，即[粘性应力](@entry_id:261328)张量。对于牛顿流体，它与[速度梯度](@entry_id:261686)成正比，$\boldsymbol{\tau}=\mu\left[\nabla\boldsymbol{u}+(\nabla\boldsymbol{u})^T-\tfrac{2}{3}\boldsymbol{I}(\nabla\cdot\boldsymbol{u})\right]$，其中 $\mu$ 是[动力粘度](@entry_id:268228)。
*   **能量通量**: $\boldsymbol{\tau}\cdot\boldsymbol{u} - \boldsymbol{q} - \sum_{k=1}^{N_s}h_k\boldsymbol{J}_k$。该项包含三个部分：粘性应力做功的通量 $\boldsymbol{\tau}\cdot\boldsymbol{u}$；由温度梯度引起的傅里叶[热传导](@entry_id:143509)通量 $\boldsymbol{q}=-\lambda\nabla T$（其中 $\lambda$ 是热导率）；以及由组分扩散引起的焓输运 $\sum_{k=1}^{N_s}h_k\boldsymbol{J}_k$，其中 $h_k$ 是组分 $k$ 的显焓，$\boldsymbol{J}_k$ 是组分 $k$ 的扩散质量通量。
*   **组分质量通量**: $-\boldsymbol{J}_k$。注意此处的负号，它确保了当 $F^{\text{diff}}$ 移到方程右侧时，$\nabla \cdot (-\boldsymbol{J}_k)$ 表示因扩散而导致的质量增加，这与物理直觉一致。

**源项 $S(U)$** 代表体积源，即在空间某点直接产生或消耗[守恒量](@entry_id:161475)的过程。
*   **质量源**: $0$ (质量是守恒的)。
*   **动量源**: $\rho\boldsymbol{g}$，即单位体积受到的重力，其中 $\boldsymbol{g}$ 是重力加速度。
*   **能量源**: $\rho\boldsymbol{u}\cdot\boldsymbol{g}$，即重力所做的功。其他[体积热源](@entry_id:1133894)（如辐射）在此被忽略。
*   **组分质量源**: $\dot{\omega}_k$，即组分 $k$ 由于化学反应产生的质量速率，单位为 $\text{kg}\,\text{m}^{-3}\,\text{s}^{-1}$。根据[质量守恒定律](@entry_id:147377)，所有组分的化学反应源项之和为零：$\sum_{k=1}^{N_s} \dot{\omega}_k = 0$。

### 物理过程的建模：源项与扩散

前述的控制方程提供了一个宏观框架，但其中的一些项，特别是化学反应源项 $\dot{\omega}_k$ 和组分扩散通量 $\boldsymbol{J}_k$，需要通过更底层的物理模型来封闭。

#### 化学反应源项

化学反应是燃烧过程的核心，它将化学能转化为热能。反应源项 $\dot{\omega}_k$ 的计算依赖于一个详细的化学[反应机理](@entry_id:149504)，该机理包含一系列[基元反应](@entry_id:177550)。对于一个由 $R$ 个可逆[基元反应](@entry_id:177550)组成的机理，其中第 $r$ 个反应可写为：

$ \sum_{i=1}^{N_s} \nu'_{i,r} \mathrm{X}_i \leftrightharpoons \sum_{i=1}^{N_s} \nu''_{i,r} \mathrm{X}_i $

这里，$\mathrm{X}_i$ 是组分 $i$ 的化学符号，$\nu'_{i,r}$ 和 $\nu''_{i,r}$ 分别是其作为反应物和产物的[化学计量系数](@entry_id:204082)（非负整数）。

根据质量作用定律，第 $r$ 个反应的净[反应速率](@entry_id:185114)（rate of progress），$\mathcal{R}_r$，单位为 $\text{mol}\,\text{m}^{-3}\,\text{s}^{-1}$，由正向[反应速率](@entry_id:185114)减去逆向[反应速率](@entry_id:185114)得到 ：

$ \mathcal{R}_r = k_{f,r} \prod_{i=1}^{N_s} C_i^{\nu'_{i,r}} - k_{b,r} \prod_{i=1}^{N_s} C_i^{\nu''_{i,r}} $

其中，$C_i$ 是组分 $i$ 的摩尔浓度（$\text{mol}\,\text{m}^{-3}$），$k_{f,r}$ 和 $k_{b,r}$ 分别是正向和逆向反应的[速率常数](@entry_id:140362)。[速率常数](@entry_id:140362)通常由Arrhenius公式给出，$k = A \exp(-E_a / (R_u T))$，强烈依赖于温度 $T$。

组分 $k$ 的总摩尔生成速率 $\dot{C}_k$ 是其在所有反应中生成速率的总和：

$ \dot{C}_k = \sum_{r=1}^{R} (\nu''_{k,r} - \nu'_{k,r}) \mathcal{R}_r $

其中 $(\nu''_{k,r} - \nu'_{k,r})$ 是组分 $k$ 在反应 $r$ 中的净[化学计量系数](@entry_id:204082)。最后，通过乘以组分 $k$ 的摩尔质量 $W_k$ ($\text{kg}\,\text{mol}^{-1}$)，我们得到质量基的[化学源项](@entry_id:747323)：

$ \dot{\omega}_k = W_k \dot{C}_k = W_k \sum_{r=1}^{R} (\nu''_{k,r} - \nu'_{k,r}) \mathcal{R}_r $

这个公式是连接微观[化学动力学](@entry_id:144961)和宏观流体[动力学方程](@entry_id:751029)的关键桥梁。

#### 组分[扩散模型](@entry_id:142185)

精确描述多组分混合物中的[扩散过程](@entry_id:268015)需要求解复杂的[Stefan-Maxwell方程](@entry_id:192069)，这在计算上非常昂贵。因此，在许多[燃烧模拟](@entry_id:155787)中，采用了简化的模型，其中最常用的是**混合物平均扩散模型**。

在该模型中，组分 $k$ 的扩散质量通量 $\boldsymbol{J}_k$ 被假定与自身的[质量分数](@entry_id:161575)梯度成正比，这是一种Fickian扩散的形式：

$ \boldsymbol{J}_k^{\ast} = -\rho D_{k,m} \nabla Y_k $

其中 $D_{k,m}$ 是组分 $k$ 在混合物中的有效扩散系数。然而，这个初步的通量 $\boldsymbol{J}_k^{\ast}$ 通常不满足[质量守恒](@entry_id:204015)的基本约束，即所有扩散质量通量之和必须为零：$\sum_{k=1}^{N_s} \boldsymbol{J}_k = \boldsymbol{0}$。这是因为各个组分的 $D_{k,m}$ 值不同。

为了强制满足这个约束，需要引入一个**修正速度** $\boldsymbol{u}_c$。修正后的[扩散通量](@entry_id:748422) $\boldsymbol{J}_k$ 定义为 ：

$ \boldsymbol{J}_k = \boldsymbol{J}_k^{\ast} - Y_k \sum_{j=1}^{N_s} \boldsymbol{J}_j^{\ast} $

这个修正过程在物理上等同于引入一个统一的漂移速度，使得在以此速度移动的参考系中，净[质量扩散](@entry_id:149532)为零，从而确保了模拟在质量平均参考系中的一致性。这个修正项可以写成 $\rho Y_k \boldsymbol{u}_c$ 的形式，其中修正速度为：

$ \boldsymbol{u}_c = \frac{1}{\rho} \sum_{j=1}^{N_s} \boldsymbol{J}_j^{\ast} = - \sum_{j=1}^{N_s} D_{j,m} \nabla Y_j $

通过从每个组分的初步通量中减去其[质量分数](@entry_id:161575)加权的修正通量，我们确保了总质量的守恒，这是任何物理上自洽的输运模型所必需的。

### 反应流中的刚性挑战

将上述方程组进行空间离散化后，我们得到一个大型的常微分方程组（ODEs）：

$ \frac{d\boldsymbol{U}}{dt} = \boldsymbol{F}(\boldsymbol{U}) $

其中 $\boldsymbol{U}$ 是包含所有网格点上所有守恒变量的巨大向量。这个[ODE系统](@entry_id:907499)的一个显著特征是其**刚性（stiffness）**，这意味着系统内部存在着时间尺度差异极大的多种物理过程。刚性是[计算燃烧学](@entry_id:1122776)中最核心的数值挑战，它主要源于两个方面：化学反应和空间离散。

#### [化学刚性](@entry_id:1122356)

燃烧过程涉及大量基元反应，其[反应速率](@entry_id:185114)可能相差数个数量级。例如，在一个典型的碳氢燃料火焰中，一些关键的[自由基](@entry_id:188302)（如H, O, OH）之间的反应非常迅速，而燃料分子的初始分解和主要产物（如CO）的氧化则相对较慢 。

我们可以通过估算一个反应的[特征时间尺度](@entry_id:276738) $\tau$ 来量化这一点。对于一个消耗某组分的[伪一级反应](@entry_id:184270)，其特征时间是伪一级[速率常数](@entry_id:140362)的倒数。考虑一个简化的甲烷-空气火焰模型，在约 $1800\,\text{K}$ 的高温区，一个典型的燃料氧化步骤（如 $\text{F}+\text{O}_2\rightarrow \text{产物}$，F代表燃料）可能具有约 $150\,\text{kJ/mol}$ 的高活化能，其特征时间尺度可能在**毫秒**（$10^{-3}\,\text{s}$）量级。与此同时，一个[自由基](@entry_id:188302)复合反应（如 $\text{H}+\text{OH}\rightarrow \text{H}_2\text{O}$）的活化能极低（约 $10\,\text{kJ/mol}$），其[特征时间尺度](@entry_id:276738)可能在**亚微秒**（$10^{-7}\,\text{s}$）量级。

这两个时间尺度的比值高达 $10^4$ 或更高。这种巨大的差异就是**[化学刚性](@entry_id:1122356)**的体现。对于依赖于系统最快时间尺度的标准显式时间积分方法（如显式Runge-Kutta法），其[稳定时间步长](@entry_id:755325)将被最快的化学反应（亚微秒）所限制。然而，我们通常关心的是较慢的宏观流动和[火焰传播](@entry_id:1125066)过程（毫秒或更长）。使用如此小的时间步长来模拟一个较长的物理过程，将导致无法承受的计算成本。

#### 来自[空间离散化](@entry_id:172158)的[数值刚性](@entry_id:752836)

除了化学反应，输运过程本身在离散化后也会引入刚性。考虑一个简化的对流-扩散方程，在空间上使用中心差分进行离散化后，对流项（[一阶导数](@entry_id:749425)）和扩散项（二阶导数）会产生具有不同性质的离散算子 。

通过傅里叶分析可以发现，中心差分格式下的对流算子 $-u D_1$ 的特征值是纯虚数，其[最大模](@entry_id:195246)值与网格尺寸 $\Delta x$ 成反比，即 $\mathcal{O}(\Delta x^{-1})$。这导致了显式积分中著名的[Courant-Friedrichs-Lewy (CFL) 条件](@entry_id:747986)，时间步长 $\Delta t$ 必须满足 $\Delta t \propto \Delta x$。

而扩散算子 $\alpha D_2$ 的特征值是负实数，其[最大模](@entry_id:195246)值（对应最高波数或最尖锐的网格尺度变化）与 $\Delta x^2$ 成反比，即 $\mathcal{O}(\Delta x^{-2})$。这为显式积分施加了一个更为严格的稳定性限制：$\Delta t \propto \Delta x^2$。

当网格被加密以解析更精细的流动结构时（即 $\Delta x \to 0$），$\Delta x^2$ 会比 $\Delta x$ 更快地趋近于零。因此，扩散项带来的[时间步长限制](@entry_id:756010)会变得远比对流项苛刻。这种由不同空间导数阶次及其离散化引起的稳定性限制差异，是[数值刚性](@entry_id:752836)的一个典型例子。

### 应对刚性的算法策略

为了在可接受的计算成本内求解刚性反应流方程，必须采用专门的[数值算法](@entry_id:752770)。这些算法的核心思想是**对不同物理过程区别对待**。

#### 算子分裂

算子分裂是一种强大的技术，它将复杂的、包含多个物理过程的演化[算子分解](@entry_id:154443)为一系列更简单的子算子，然后依次求解。对于我们的方程 $\partial u / \partial t = (\mathcal{A}+\mathcal{D}+\mathcal{R})u$，其中 $\mathcal{A}$, $\mathcal{D}$, $\mathcal{R}$ 分别代表对流、扩散和反应算子，我们可以将一个时间步 $\Delta t$ 内的求解过程分解为三个子步骤。

最简单的方法是**Lie-Trotter分裂**（或称Godunov分裂），它按顺序应用每个算子，总时间步长为 $\Delta t$ ：
$ u^{n+1} = \exp(\Delta t \mathcal{R}) \exp(\Delta t \mathcal{D}) \exp(\Delta t \mathcal{A}) u^n $
这种方法是**[一阶精度](@entry_id:749410)**的，因为其[截断误差](@entry_id:140949)为 $\mathcal{O}(\Delta t^2)$。

为了提高精度，可以使用**Strang分裂**，它采用一种对称的算[子序列](@entry_id:147702) ：
$ u^{n+1} = \exp(\frac{\Delta t}{2} \mathcal{A}) \exp(\frac{\Delta t}{2} \mathcal{D}) \exp(\Delta t \mathcal{R}) \exp(\frac{\Delta t}{2} \mathcal{D}) \exp(\frac{\Delta t}{2} \mathcal{A}) u^n $
这种对称结构消除了最低阶的误差项，使得方法达到**[二阶精度](@entry_id:137876)**，其局部截断误差为 $\mathcal{O}(\Delta t^3)$。

[算子分裂](@entry_id:634210)的巨大优势在于，我们可以为每个子步骤（如纯对流、纯扩散或纯化学反应）选择最适合其物理和数值特性的积分方法。

#### 隐式与隐式-显式（IMEX）[时间积分](@entry_id:267413)

对于刚性系统，**[隐式时间积分](@entry_id:171761)**是必不可少的。与显式方法（下一时刻的状态仅由当前时刻的状态计算）不同，[隐式方法](@entry_id:138537)（如向后欧拉法或高阶的后向差分格式 BDF）在计算下一时刻的状态时，会用到该时刻自身的状态，这通常需要求解一个（非）线性方程组。[隐式方法](@entry_id:138537)的关键优势在于其优越的稳定性。例如，**A-稳定**的[隐式方法](@entry_id:138537)可以对任何具有负实部特征值的稳定线性系统使用任意大的时间步长而不发散。对于负[实轴](@entry_id:148276)上特征值趋于负无穷时数值[放大因子](@entry_id:144315)趋于零的**L-稳定**方法，更是能够有效抑制和阻尼刚性分量带来的高频振荡 。

然而，对整个[反应流](@entry_id:190741)系统（包括对流、扩散和反应）进行全隐式求解，需要组装和求解一个巨大的、[非线性](@entry_id:637147)的耦合方程组，这在计算上仍然是极其昂贵的。

一个更高效、更流行的策略是**隐式-显式（IMEX）方法**。结合算子分裂的思想，[IMEX方法](@entry_id:170079)将系统分为刚性部分和非刚性部分 ：
*   **非刚性部分**（通常是对流项 $\mathcal{L}_{\text{adv}}$）采用计算成本较低的**显式**方法（如显式Runge-Kutta法）处理。其时间步长受限于较宽松的CFL条件 $\Delta t \propto \Delta x$。
*   **刚性部分**（通常是化学反应项 $\boldsymbol{R}$ 和扩散项 $\mathcal{L}_{\text{diff}}$）采用具有良好稳定性（如A-稳定或L-稳定）的**隐式**方法（如BDF或隐式Runge-Kutta法）处理。这样就摆脱了由化学和扩散引起的严苛的时间步长限制。

通过这种方式，IMEX方案在保持稳定性的同时，显著降低了每次时间步进的计算成本，因为它避免了对非刚性项进行昂贵的隐式求解。

### 专门化配方：[低马赫数近似](@entry_id:1127479)

在许多常见的燃烧应用中（如蜡烛火焰、家用燃气灶、[火灾蔓延](@entry_id:1125002)），流体速度 $U$ 远小于声速 $c$，即马赫数 $M = U/c \ll 1$。在这种情况下，使用完全可压缩的Navier-Stokes方程求解器会遇到一种特殊的算法瓶颈。

#### 声学时间步问题

对于显式[可压缩流求解器](@entry_id:1122759)，时间步长受限于最快的[波速](@entry_id:186208)，即声速 $c$。[CFL条件](@entry_id:178032)要求 $\Delta t \propto \Delta x / c$。然而，我们感兴趣的流体输运时间尺度是由[流体速度](@entry_id:267320) $U$ 决定的，即 $\Delta t_{\text{adv}} \propto \Delta x / U$。当 $M \ll 1$ 时，声学时间步长 $\Delta t$ 比对流时间步长 $\Delta t_{\text{adv}}$ 小一个量级 $M$ 。例如，对于 $M=0.01$ 的流动，求解器被迫使用比物理过程所需小100倍的时间步长，这造成了巨大的计算浪费。

#### [低马赫数](@entry_id:1127478)方程与散度约束

**[低马赫数近似](@entry_id:1127479)**通过在方程层面系统地滤除声波来解决这个问题。其核心思想是将压[力场](@entry_id:147325)分解为两部分 ：

$ p(\boldsymbol{x}, t) = p_0(t) + \pi(\boldsymbol{x}, t) $

其中，$p_0(t)$ 是一个空间均匀的[热力学压力](@entry_id:1133073)，它只随时间变化；$\pi(\boldsymbol{x}, t)$ 是一个空间变化的[流体动力](@entry_id:750449)学压力扰动，其量级远小于 $p_0$。在这个近似下，[状态方程](@entry_id:274378)（如[理想气体定律](@entry_id:146757)）仅与 $p_0$ 相关，即 $\rho = \rho(p_0, T, Y_k)$。

这种分解有效地将声学过程（通过 $\pi$ 的快速波动传播）与热力学状态（由 $p_0$ 和能量方程决定）[解耦](@entry_id:160890)。作为代价，我们失去了一个关于压力的[演化方程](@entry_id:268137)（能量方程不再直接提供压力更新）。取而代之的是一个**运动学约束**，它将速度场的散度与[热力学](@entry_id:172368)量的变化率联系起来。这个约束通过组合[质量守恒](@entry_id:204015)方程和状态方程的[物质导数](@entry_id:262900)得出 ：

$ \nabla \cdot \boldsymbol{u} = -\frac{1}{\rho}\left[ \left( \frac{\partial \rho}{\partial p} \right)_{T,Y} \frac{d p_0}{d t} + \left( \frac{\partial \rho}{\partial T} \right)_{p,Y} \frac{D T}{D t} + \sum_{k=1}^{N_s} \left( \frac{\partial \rho}{\partial Y_k} \right)_{p,T,Y_{j\neq k}} \frac{D Y_k}{D t} \right] $

这个方程至关重要：它表明在[低马赫数燃烧](@entry_id:1127480)中，速度场**不是无散的**（即 $\nabla \cdot \boldsymbol{u} \neq 0$）。[速度散度](@entry_id:264117)源于热膨胀（$DT/Dt$ 项）和组分变化（$DY_k/Dt$ 项），这是燃烧区别于常密度不可压缩流动的本质特征。

#### [投影法](@entry_id:147401)

在算法上，这个散度约束通常通过**投影法**来强制执行 。一个典型的时间步进过程包含两个主要步骤：

1.  **预测步**：首先，不考虑压力梯度项，使用动量方程中的对流、扩散和[体力](@entry_id:174230)项来计算一个临时的、不满足散度约束的**预测速度** $\boldsymbol{u}^*$。

2.  **校正/投影步**：然后，通过求解一个关于压力扰动（或其[标量势](@entry_id:276177) $\phi$）的**泊松方程**来校正速度场。这个泊松方程是通过对校正后的速度 $\boldsymbol{u}^{n+1} = \boldsymbol{u}^* - \Delta t \frac{1}{\rho^{n+1}}\nabla\phi^{n+1}$ 取散度，并令其等于上一步得到的散度约束 $S^{n+1} = (\nabla \cdot \boldsymbol{u})^{n+1}$ 而得到的。对于[变密度流](@entry_id:1133711)，这个方程是一个**变系数的椭圆型方程**  ：

    $ \nabla \cdot \left( \frac{1}{\rho^{n+1}} \nabla \phi^{n+1} \right) = \frac{1}{\Delta t} \left( \nabla \cdot \boldsymbol{u}^* - S^{n+1} \right) $

    求解这个椭圆方程得到的 $\phi^{n+1}$ 梯度被用来更新速度，从而得到一个既满足动量平衡又满足散度约束的最终速度场 $\boldsymbol{u}^{n+1}$。

通过这种方式，[低马赫数方法](@entry_id:1127482)将原来由声波传播决定的双曲问题转化为了一个在每个时间步求解椭圆型方程的问题。虽然求解这个[大型稀疏线性系统](@entry_id:137968)本身可能成为新的计算瓶颈（通常需要高效的Krylov子空间或[多重网格求解器](@entry_id:752283)），但它成功地将时间步长从声学限制中解放出来，使其只受限于较慢的对流和[扩散过程](@entry_id:268015)，从而为低速[燃烧模拟](@entry_id:155787)带来了巨大的效率提升。