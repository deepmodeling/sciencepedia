{
    "hands_on_practices": [
        {
            "introduction": "Before building a complex reacting-flow solver, we must verify that its fundamental components—the discrete operators for transport and diffusion—are implemented correctly. The Method of Manufactured Solutions (MMS) is a rigorous verification technique used to confirm that a numerical scheme achieves its theoretical order of accuracy. This practice  provides hands-on experience in implementing MMS to test common finite-difference approximations, a critical skill for developing any reliable scientific software.",
            "id": "4006782",
            "problem": "Consider the one-dimensional periodic advection–diffusion operator that appears in reacting-flow solvers for transported scalars in computational combustion. Let $x \\in [0,1)$ denote position along a uniform grid, and let $u(x)$ denote a smooth manufactured scalar field. The spatial advection–diffusion operator applied to $u(x)$ is defined by the expression $a \\, \\partial u / \\partial x - D \\, \\partial^{2} u / \\partial x^{2}$, where $a$ is a constant advection speed and $D$ is a constant molecular diffusivity, both strictly positive. In algorithmic structures used by reacting-flow solvers, this operator is discretized using finite differences on a uniform grid with periodic boundary conditions. You are to assess the observed order of accuracy of commonly used finite-difference discretizations for the advection and diffusion parts separately, employing the Method of Manufactured Solutions (MMS). The term Method of Manufactured Solutions (MMS) refers to a verification strategy in which a smooth, analytic function $u(x)$ is chosen, and discrete operator approximations are compared against the exact differential operator applied to $u(x)$ to quantify discretization error convergence with mesh refinement.\n\nUse the following fundamental base:\n- The exact first derivative is given by $\\partial u / \\partial x$ and the exact second derivative is given by $\\partial^{2} u / \\partial x^{2}$ from calculus.\n- The uniform grid on $[0,1)$ with $N$ points has spacing $h = 1/N$, with grid points $x_{i} = i h$ for $i \\in \\{0,1,\\dots,N-1\\}$.\n- Periodic boundary conditions imply $u_{-1} = u_{N-1}$ and $u_{N} = u_{0}$ for any discrete stencil that references indices outside $\\{0,1,\\dots,N-1\\}$.\n\nChoose the manufactured solution $u(x) = \\sin(2 \\pi x) + \\tfrac{1}{2} \\cos(4 \\pi x)$, with exact derivatives $\\partial u / \\partial x = 2 \\pi \\cos(2 \\pi x) - 2 \\pi \\sin(4 \\pi x)$ and $\\partial^{2} u / \\partial x^{2} = - (2 \\pi)^{2} \\sin(2 \\pi x) - (4 \\pi)^{2} \\tfrac{1}{2} \\cos(4 \\pi x)$. Use $a = 1$ and $D = 10^{-2}$.\n\nDefine the discrete advection operator approximations for $a > 0$:\n- Upwind first-order advection: $L^{h}_{\\mathrm{adv,up}}(u)_{i} = a \\, (u_{i} - u_{i-1}) / h$.\n- Central second-order advection: $L^{h}_{\\mathrm{adv,cd}}(u)_{i} = a \\, (u_{i+1} - u_{i-1}) / (2 h)$.\n\nDefine the discrete diffusion operator approximation:\n- Central second-order diffusion: $L^{h}_{\\mathrm{diff,cd}}(u)_{i} = D \\, (u_{i-1} - 2 u_{i} + u_{i+1}) / h^{2}$.\n\nFor each grid size $N$, compute the discrete $L^{2}$ error norm between each discrete operator and its exact counterpart applied to the manufactured solution:\n- Advection upwind error: $E_{\\mathrm{adv,up}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[L^{h}_{\\mathrm{adv,up}}(u)_{i} - a \\, (\\partial u / \\partial x)(x_{i}) \\right]^{2} \\, h \\right)^{1/2}$.\n- Advection central error: $E_{\\mathrm{adv,cd}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[L^{h}_{\\mathrm{adv,cd}}(u)_{i} - a \\, (\\partial u / \\partial x)(x_{i}) \\right]^{2} \\, h \\right)^{1/2}$.\n- Diffusion central error: $E_{\\mathrm{diff,cd}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[L^{h}_{\\mathrm{diff,cd}}(u)_{i} - D \\, (\\partial^{2} u / \\partial x^{2})(x_{i}) \\right]^{2} \\, h \\right)^{1/2}$.\n\nThe observed order of accuracy $p$ for each discretization is obtained by fitting the model $E(h) = C \\, h^{p}$ with constants $C$ and $p$ using least squares on the pairs $(\\log h, \\log E(h))$ over a sequence of refined grids. That is, compute $p$ as the slope of the best-fit line to $\\log E(h)$ as a function of $\\log h$ for each discretization, with $h = 1/N$.\n\nUse three grid refinement sequences to constitute the test suite, covering a general case, a coarse-grid boundary case, and a higher-resolution case:\n- Sequence $\\mathcal{S}_{A}$: $N \\in \\{8, 16, 32, 64\\}$.\n- Sequence $\\mathcal{S}_{B}$: $N \\in \\{12, 24, 48, 96\\}$.\n- Sequence $\\mathcal{S}_{C}$: $N \\in \\{30, 60, 120, 240\\}$.\n\nFor each sequence, compute and report the observed order of accuracy for the three discretizations: $p_{\\mathrm{adv,up}}$, $p_{\\mathrm{adv,cd}}$, and $p_{\\mathrm{diff,cd}}$. All quantities are dimensionless. Express each reported observed order of accuracy as a floating-point number rounded to $4$ decimal places.\n\nYour program should produce a single line of output containing the $9$ results in the order\n$\\left[p_{\\mathrm{adv,up}}(\\mathcal{S}_{A}), p_{\\mathrm{adv,cd}}(\\mathcal{S}_{A}), p_{\\mathrm{diff,cd}}(\\mathcal{S}_{A}), p_{\\mathrm{adv,up}}(\\mathcal{S}_{B}), p_{\\mathrm{adv,cd}}(\\mathcal{S}_{B}), p_{\\mathrm{diff,cd}}(\\mathcal{S}_{B}), p_{\\mathrm{adv,up}}(\\mathcal{S}_{C}), p_{\\mathrm{adv,cd}}(\\mathcal{S}_{C}), p_{\\mathrm{diff,cd}}(\\mathcal{S}_{C})\\right]$ as a comma-separated list enclosed in square brackets (for example, $[r_{1},r_{2},\\dots,r_{9}]$). No other text may be printed.",
            "solution": "The problem is valid as it presents a well-posed, scientifically grounded task based on the Method of Manufactured Solutions (MMS), a standard verification procedure in computational science. All required data, functions, and methodologies are provided, and the problem is free of contradictions or ambiguities.\n\nThe objective is to compute the observed order of accuracy for three distinct finite-difference discretizations of the advection and diffusion operators. This is accomplished by applying the Method of Manufactured Solutions (MMS), where a known smooth function, the manufactured solution, is used as a basis for quantifying the discretization error. The order of accuracy, denoted by $p$, characterizes how the error $E$ diminishes as the grid spacing $h$ is refined, following the power-law relationship $E(h) \\approx C h^{p}$, where $C$ is a constant.\n\nThe manufactured solution is given as $u(x) = \\sin(2 \\pi x) + \\tfrac{1}{2} \\cos(4 \\pi x)$ on the periodic domain $x \\in [0, 1)$. The problem is evaluated on a uniform grid with $N$ points, where the grid spacing is $h = 1/N$ and the grid points are $x_i = i h$ for $i \\in \\{0, 1, \\dots, N-1\\}$. The constant parameters are the advection speed $a=1$ and the diffusivity $D=10^{-2}$.\n\nThe exact first and second derivatives of the manufactured solution are:\n$$\n\\frac{\\partial u}{\\partial x} = 2 \\pi \\cos(2 \\pi x) - 2 \\pi \\sin(4 \\pi x)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = - (2 \\pi)^2 \\sin(2 \\pi x) - \\frac{(4 \\pi)^2}{2} \\cos(4 \\pi x)\n$$\n\nWe will analyze three discrete operators:\n1.  **Upwind first-order advection ($L^{h}_{\\mathrm{adv,up}}$):** This scheme is theoretically first-order accurate, so we expect to observe $p_{\\mathrm{adv,up}} \\approx 1$.\n    $$\n    L^{h}_{\\mathrm{adv,up}}(u)_{i} = a \\frac{u_i - u_{i-1}}{h}\n    $$\n2.  **Central second-order advection ($L^{h}_{\\mathrm{adv,cd}}$):** This scheme is theoretically second-order accurate, so we expect $p_{\\mathrm{adv,cd}} \\approx 2$.\n    $$\n    L^{h}_{\\mathrm{adv,cd}}(u)_{i} = a \\frac{u_{i+1} - u_{i-1}}{2h}\n    $$\n3.  **Central second-order diffusion ($L^{h}_{\\mathrm{diff,cd}}$):** This scheme is also theoretically second-order accurate, so we expect $p_{\\mathrm{diff,cd}} \\approx 2$.\n    $$\n    L^{h}_{\\mathrm{diff,cd}}(u)_{i} = D \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2}\n    $$\nIn all cases, periodic boundary conditions are applied, such that $u_{-1} = u_{N-1}$ and $u_N = u_0$.\n\nFor each of these operators and for a sequence of grid sizes $N$, we compute the discrete $L^2$ error norm. For example, for the upwind advection scheme, the error is:\n$$\nE_{\\mathrm{adv,up}}(h) = \\left( \\sum_{i=0}^{N-1} \\left[ L^{h}_{\\mathrm{adv,up}}(u)_{i} - a \\left(\\frac{\\partial u}{\\partial x}\\right)(x_i) \\right]^2 h \\right)^{1/2}\n$$\nAnalogous formulas apply to the other two operators, comparing them against the corresponding exact analytical operators, $a (\\partial u / \\partial x)$ and $D (\\partial^2 u / \\partial x^2)$, respectively.\n\nThe observed order of accuracy $p$ is determined from the set of computed error values $\\{E(h_j)\\}$ for a sequence of grid spacings $\\{h_j\\}$. Taking the natural logarithm of the error model $E(h) = C h^p$ yields a linear relationship:\n$$\n\\ln(E(h)) = p \\ln(h) + \\ln(C)\n$$\nThis is an equation of the form $y = mx + c$, where $y = \\ln(E(h))$, the slope $m$ is the order of accuracy $p$, and the independent variable is $x = \\ln(h)$. We can therefore compute $p$ for each operator by performing a linear least-squares regression on the set of data points $(\\ln(h_j), \\ln(E(h_j)))$ generated from each grid refinement sequence $\\mathcal{S}_A$, $\\mathcal{S}_B$, and $\\mathcal{S}_C$. This procedure is repeated for each of the three operators, yielding a total of $9$ values for the order of accuracy.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.stats\n\ndef solve():\n    \"\"\"\n    Computes the observed order of accuracy for finite-difference discretizations\n    of advection and diffusion operators using the Method of Manufactured Solutions.\n    \"\"\"\n    # Define constants and manufactured solution functions\n    A_COEFF = 1.0\n    D_COEFF = 1.0e-2\n\n    def u_manufactured(x):\n        \"\"\"The manufactured solution u(x).\"\"\"\n        return np.sin(2 * np.pi * x) + 0.5 * np.cos(4 * np.pi * x)\n\n    def du_dx_exact(x):\n        \"\"\"The exact first derivative of u(x).\"\"\"\n        return 2 * np.pi * np.cos(2 * np.pi * x) - 2 * np.pi * np.sin(4 * np.pi * x)\n\n    def d2u_dx2_exact(x):\n        \"\"\"The exact second derivative of u(x).\"\"\"\n        return -(2 * np.pi)**2 * np.sin(2 * np.pi * x) - 0.5 * (4 * np.pi)**2 * np.cos(4 * np.pi * x)\n\n    # Define the grid refinement sequences\n    sequences = {\n        \"S_A\": [8, 16, 32, 64],\n        \"S_B\": [12, 24, 48, 96],\n        \"S_C\": [30, 60, 120, 240],\n    }\n\n    all_results = []\n    \n    # Process each sequence in the specified order\n    for seq_name in [\"S_A\", \"S_B\", \"S_C\"]:\n        Ns = sequences[seq_name]\n        \n        log_h_vals = []\n        log_err_adv_up = []\n        log_err_adv_cd = []\n        log_err_diff_cd = []\n\n        # Calculate errors for each grid size N in the current sequence\n        for N in Ns:\n            h = 1.0 / N\n            x = np.arange(N) * h\n            log_h_vals.append(np.log(h))\n\n            # Evaluate the manufactured solution and its exact derivatives on the grid\n            u_vals = u_manufactured(x)\n            dudx_vals = du_dx_exact(x)\n            d2udx2_vals = d2u_dx2_exact(x)\n            \n            # Use np.roll for efficient implementation of periodic boundary conditions\n            u_im1 = np.roll(u_vals, 1)  # u_{i-1}\n            u_ip1 = np.roll(u_vals, -1) # u_{i+1}\n\n            # Compute discrete operators\n            L_adv_up = A_COEFF * (u_vals - u_im1) / h\n            L_adv_cd = A_COEFF * (u_ip1 - u_im1) / (2 * h)\n            L_diff_cd = D_COEFF * (u_im1 - 2 * u_vals + u_ip1) / (h**2)\n\n            # Compute errors between discrete and exact operators\n            err_vec_adv_up = L_adv_up - A_COEFF * dudx_vals\n            err_vec_adv_cd = L_adv_cd - A_COEFF * dudx_vals\n            err_vec_diff_cd = L_diff_cd - D_COEFF * d2udx2_vals\n\n            # Compute discrete L2 error norms and store their logarithms\n            # L2 norm is sqrt(sum(error_i^2 * h))\n            err_norm_adv_up = np.sqrt(np.sum(err_vec_adv_up**2) * h)\n            err_norm_adv_cd = np.sqrt(np.sum(err_vec_adv_cd**2) * h)\n            err_norm_diff_cd = np.sqrt(np.sum(err_vec_diff_cd**2) * h)\n            \n            log_err_adv_up.append(np.log(err_norm_adv_up))\n            log_err_adv_cd.append(np.log(err_norm_adv_cd))\n            log_err_diff_cd.append(np.log(err_norm_diff_cd))\n\n        # Perform linear regression to find the slope (order of accuracy p)\n        # for each discretization scheme\n        p_adv_up = scipy.stats.linregress(log_h_vals, log_err_adv_up).slope\n        p_adv_cd = scipy.stats.linregress(log_h_vals, log_err_adv_cd).slope\n        p_diff_cd = scipy.stats.linregress(log_h_vals, log_err_diff_cd).slope\n        \n        all_results.extend([p_adv_up, p_adv_cd, p_diff_cd])\n\n    # Format results to 4 decimal places as required\n    formatted_results = [f\"{r:.4f}\" for r in all_results]\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "When using explicit time integration schemes, the stability of the entire simulation hinges on choosing a sufficiently small time step, $\\Delta t$. In reacting flows, this time step is not governed by a single process but is instead constrained by the fastest timescale among advection, diffusion, and chemical reactions. This exercise  demonstrates how to calculate the global time step limit for an explicit solver by synthesizing the stability criteria from each physical process, offering a clear illustration of why stiff chemistry can make explicit methods computationally intractable.",
            "id": "4006741",
            "problem": "A two-dimensional reacting-flow solver advances a transported scalar $Y$ governed by advection, diffusion, and reaction using a fully explicit, unsplit algorithm with third-order Strong Stability Preserving (SSP) Runge–Kutta (RK3) time integration, fifth-order Weighted Essentially Non-Oscillatory (WENO) fluxes for advection, and second-order central differences for diffusion. Stability of this explicit advance is controlled by three scale constraints associated with advection through the Courant–Friedrichs–Lewy (CFL) number, diffusion through the parabolic stability number, and stiff chemistry through the linear test-equation bound for the reaction Jacobian. For this particular discretization and grid, prior linear stability analyses of the combined spatial operators with SSP–RK3 yield three dimensionless bounding constants $C_{\\mathrm{adv}}$, $C_{\\mathrm{diff}}$, and $C_{\\mathrm{react}}$ that quantify the maximum admissible normalized step along the negative real axis of the relevant amplification factors.\n\nConsider a rectangular domain with lengths $L_{x} = 0.03\\ \\mathrm{m}$ and $L_{y} = 0.012\\ \\mathrm{m}$, discretized uniformly with $N_{x} = 300$ and $N_{y} = 100$ cells, respectively. The maximum resolved advection velocities are $u_{\\max} = 12\\ \\mathrm{m/s}$ in the $x$-direction and $v_{\\max} = 3\\ \\mathrm{m/s}$ in the $y$-direction. The species diffusion coefficient is $D = 1.5 \\times 10^{-4}\\ \\mathrm{m^{2}/s}$. The largest magnitude (negative real) eigenvalue of the reaction Jacobian at the most stiff state encountered is $|\\lambda_{\\max}| = 2.0 \\times 10^{5}\\ \\mathrm{s^{-1}}$. The stability bounding constants for this algorithm and grid are $C_{\\mathrm{adv}} = 0.60$, $C_{\\mathrm{diff}} = 0.22$, and $C_{\\mathrm{react}} = 2.50$.\n\nUsing foundational stability principles for explicit methods in multidimensional reacting-flow solvers, compute the single explicit time step limit $\\Delta t$ that simultaneously satisfies all three constraints imposed by advection, diffusion, and reaction for this configuration. Round your final result to three significant figures and express it in microseconds (i.e., $\\mathrm{\\mu s}$).",
            "solution": "The problem is deemed valid. It is a well-posed, scientifically grounded problem in the field of computational science, specifically the numerical analysis of reacting flows. It provides all necessary data and uses clear, objective language. The task is to determine the maximum stable time step for a fully explicit, unsplit numerical algorithm, which is governed by multiple, concurrent physical processes.\n\nThe fundamental principle for the stability of an explicit, unsplit time-integration scheme is that the single time step, $\\Delta t$, must be small enough to resolve the fastest dynamics in the system. These dynamics arise from advection, diffusion, and chemical reaction. The problem provides the stability criteria for each of these processes in the form of a dimensionless bounding constant. The overall time step $\\Delta t$ must simultaneously satisfy all three constraints. This means that $\\Delta t$ must be less than or equal to the time-step limit imposed by each process individually. Mathematically, this is expressed as:\n$$ \\Delta t \\leq \\min(\\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{react}}) $$\nwhere $\\Delta t_{\\mathrm{adv}}$, $\\Delta t_{\\mathrm{diff}}$, and $\\Delta t_{\\mathrm{react}}$ are the maximum allowable time steps for advection, diffusion, and reaction, respectively. We shall compute each of these limits separately.\n\nFirst, we must calculate the grid spacing in each coordinate direction, $\\Delta x$ and $\\Delta y$.\nGiven the domain lengths $L_{x} = 0.03\\ \\mathrm{m}$ and $L_{y} = 0.012\\ \\mathrm{m}$, and the number of cells $N_{x} = 300$ and $N_{y} = 100$:\n$$ \\Delta x = \\frac{L_{x}}{N_{x}} = \\frac{0.03\\ \\mathrm{m}}{300} = 0.0001\\ \\mathrm{m} = 1.0 \\times 10^{-4}\\ \\mathrm{m} $$\n$$ \\Delta y = \\frac{L_{y}}{N_{y}} = \\frac{0.012\\ \\mathrm{m}}{100} = 0.00012\\ \\mathrm{m} = 1.2 \\times 10^{-4}\\ \\mathrm{m} $$\n\nNow, we compute the three time-step limits.\n\n1.  **Advection Time-Step Limit ($\\Delta t_{\\mathrm{adv}}$)**\nThe advection constraint is a multi-dimensional Courant–Friedrichs–Lewy (CFL) condition. The stability criterion is given by:\n$$ \\Delta t_{\\mathrm{adv}} \\left( \\frac{u_{\\max}}{\\Delta x} + \\frac{v_{\\max}}{\\Delta y} \\right) \\leq C_{\\mathrm{adv}} $$\nSolving for $\\Delta t_{\\mathrm{adv}}$:\n$$ \\Delta t_{\\mathrm{adv}} = \\frac{C_{\\mathrm{adv}}}{\\frac{u_{\\max}}{\\Delta x} + \\frac{v_{\\max}}{\\Delta y}} $$\nUsing the provided values $u_{\\max} = 12\\ \\mathrm{m/s}$, $v_{\\max} = 3\\ \\mathrm{m/s}$, and $C_{\\mathrm{adv}} = 0.60$:\n$$ \\frac{u_{\\max}}{\\Delta x} = \\frac{12\\ \\mathrm{m/s}}{1.0 \\times 10^{-4}\\ \\mathrm{m}} = 1.2 \\times 10^{5}\\ \\mathrm{s^{-1}} $$\n$$ \\frac{v_{\\max}}{\\Delta y} = \\frac{3\\ \\mathrm{m/s}}{1.2 \\times 10^{-4}\\ \\mathrm{m}} = 2.5 \\times 10^{4}\\ \\mathrm{s^{-1}} $$\n$$ \\Delta t_{\\mathrm{adv}} = \\frac{0.60}{(1.2 \\times 10^{5} + 2.5 \\times 10^{4})\\ \\mathrm{s^{-1}}} = \\frac{0.60}{1.45 \\times 10^{5}\\ \\mathrm{s^{-1}}} \\approx 4.1379 \\times 10^{-6}\\ \\mathrm{s} $$\n\n2.  **Diffusion Time-Step Limit ($\\Delta t_{\\mathrm{diff}}$)**\nThe diffusion, or parabolic, constraint relates the time step to the rate of species diffusion across grid cells. For a second-order central difference scheme in two dimensions, the stability criterion is:\n$$ \\Delta t_{\\mathrm{diff}} \\cdot D \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right) \\leq C_{\\mathrm{diff}} $$\nSolving for $\\Delta t_{\\mathrm{diff}}$:\n$$ \\Delta t_{\\mathrm{diff}} = \\frac{C_{\\mathrm{diff}}}{D \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right)} $$\nUsing the provided values $D = 1.5 \\times 10^{-4}\\ \\mathrm{m^{2}/s}$ and $C_{\\mathrm{diff}} = 0.22$:\n$$ \\frac{1}{\\Delta x^2} = \\frac{1}{(1.0 \\times 10^{-4}\\ \\mathrm{m})^2} = 1.0 \\times 10^{8}\\ \\mathrm{m^{-2}} $$\n$$ \\frac{1}{\\Delta y^2} = \\frac{1}{(1.2 \\times 10^{-4}\\ \\mathrm{m})^2} = \\frac{1}{1.44 \\times 10^{-8}\\ \\mathrm{m^2}} \\approx 6.9444 \\times 10^{7}\\ \\mathrm{m^{-2}} $$\n$$ \\Delta t_{\\mathrm{diff}} = \\frac{0.22}{(1.5 \\times 10^{-4}\\ \\mathrm{m^{2}/s}) \\left( 1.0 \\times 10^{8}\\ \\mathrm{m^{-2}} + 6.9444 \\times 10^{7}\\ \\mathrm{m^{-2}} \\right)} $$\n$$ \\Delta t_{\\mathrm{diff}} = \\frac{0.22}{(1.5 \\times 10^{-4}) (1.69444 \\times 10^{8})\\ \\mathrm{s^{-1}}} = \\frac{0.22}{2.54167 \\times 10^{4}\\ \\mathrm{s^{-1}}} \\approx 8.6558 \\times 10^{-6}\\ \\mathrm{s} $$\n\n3.  **Reaction Time-Step Limit ($\\Delta t_{\\mathrm{react}}$)**\nThe reaction constraint is determined by the stiffness of the chemical kinetics, characterized by the largest magnitude eigenvalue, $|\\lambda_{\\max}|$, of the reaction Jacobian. The stability criterion is:\n$$ \\Delta t_{\\mathrm{react}} \\cdot |\\lambda_{\\max}| \\leq C_{\\mathrm{react}} $$\nSolving for $\\Delta t_{\\mathrm{react}}$:\n$$ \\Delta t_{\\mathrm{react}} = \\frac{C_{\\mathrm{react}}}{|\\lambda_{\\max}|} $$\nUsing the provided values $|\\lambda_{\\max}| = 2.0 \\times 10^{5}\\ \\mathrm{s^{-1}}$ and $C_{\\mathrm{react}} = 2.50$:\n$$ \\Delta t_{\\mathrm{react}} = \\frac{2.50}{2.0 \\times 10^{5}\\ \\mathrm{s^{-1}}} = 1.25 \\times 10^{-5}\\ \\mathrm{s} $$\n\nFinally, we compare the three time-step limits to find the overall maximum stable time step $\\Delta t$:\n$$ \\Delta t = \\min(\\Delta t_{\\mathrm{adv}}, \\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{react}}) $$\n$$ \\Delta t = \\min(4.1379 \\times 10^{-6}\\ \\mathrm{s}, 8.6558 \\times 10^{-6}\\ \\mathrm{s}, 1.25 \\times 10^{-5}\\ \\mathrm{s}) $$\nThe minimum value is controlled by the advection constraint:\n$$ \\Delta t = 4.1379 \\times 10^{-6}\\ \\mathrm{s} $$\nThe problem requires the result to be expressed in microseconds ($\\mu\\mathrm{s}$) and rounded to three significant figures.\n$$ \\Delta t = 4.1379\\ \\mu\\mathrm{s} \\approx 4.14\\ \\mu\\mathrm{s} $$\nThus, the single explicit time step for the simulation is limited by the advection phenomenon.",
            "answer": "$$\\boxed{4.14}$$"
        },
        {
            "introduction": "Numerical errors arising from discretization or operator splitting can corrupt the solution, leading to non-physical species mass fractions, such as negative values or sums not equal to one. To maintain solver stability, these invalid states must be corrected. This practice  guides you through the derivation and application of a constrained optimization algorithm to project a non-physical composition back onto the valid set (the probability simplex) in a way that minimally perturbs the solution, a robust technique essential for state-of-the-art reacting-flow solvers.",
            "id": "4006792",
            "problem": "Consider a reacting-flow cell update in a finite-volume method (FVM) based reacting-flow solver for computational combustion. After a time-splitting step (advection-diffusion followed by chemistry), suppose the cell-averaged species mass fractions are updated to a vector $\\boldsymbol{Y}^{\\mathrm{upd}} \\in \\mathbb{R}^{5}$ with components\n$$\n\\boldsymbol{Y}^{\\mathrm{upd}} = \\left( 0.40,\\ 0.35,\\ 0.20,\\ 0.08,\\ -0.03 \\right).\n$$\nIn a physically consistent mixture, the species mass fractions must satisfy the conservation-of-mass constraint $\\sum_{k=1}^{5} Y_{k} = 1$ and the nonnegativity constraint $Y_{k} \\geq 0$ for all $k$. To enforce these constraints in the algorithmic structure of the reacting-flow solver while minimally perturbing the updated state, define the correction vector $\\boldsymbol{\\delta} \\in \\mathbb{R}^{5}$ by solving\n$$\n\\min_{\\boldsymbol{\\delta} \\in \\mathbb{R}^{5}} \\ \\|\\boldsymbol{\\delta}\\|_{2} \\quad \\text{subject to} \\quad \\sum_{k=1}^{5} \\left(Y_{k}^{\\mathrm{upd}} + \\delta_{k}\\right) = 1, \\quad Y_{k}^{\\mathrm{upd}} + \\delta_{k} \\geq 0 \\ \\ \\text{for all } k,\n$$\nwhere $\\|\\cdot\\|_{2}$ denotes the Euclidean norm. This problem formalizes the smallest Euclidean change needed to project $\\boldsymbol{Y}^{\\mathrm{upd}}$ onto the probability simplex associated with nonnegative mass fractions summing to unity.\n\nStarting from conservation of mass and the definition of species mass fractions, derive the necessary and sufficient optimality conditions from first principles and compute the unique correction vector $\\boldsymbol{\\delta}^{\\star}$ that solves the optimization problem above for the given $\\boldsymbol{Y}^{\\mathrm{upd}}$. Provide your final answer as the row vector of the components of $\\boldsymbol{\\delta}^{\\star}$. No rounding is required.",
            "solution": "The fundamental base is the conservation of mass for a mixture, which requires that the species mass fractions satisfy $\\sum_{k=1}^{N_{s}} Y_{k} = 1$ and the physical realizability constraint $Y_{k} \\geq 0$. In the algorithmic structure of a reacting-flow solver, after an update step $\\boldsymbol{Y}^{\\mathrm{upd}}$ may violate nonnegativity and (in general) may not sum to unity. We therefore seek the minimal correction in the Euclidean sense that enforces both constraints.\n\nWe formalize the correction as the projection of $\\boldsymbol{Y}^{\\mathrm{upd}}$ onto the feasible set\n$$\n\\mathcal{S} = \\left\\{ \\boldsymbol{y} \\in \\mathbb{R}^{5} \\ \\bigg| \\ \\sum_{k=1}^{5} y_{k} = 1, \\ \\ y_{k} \\geq 0 \\ \\ \\forall k \\right\\}.\n$$\nDefine $\\boldsymbol{y} = \\boldsymbol{Y}^{\\mathrm{upd}} + \\boldsymbol{\\delta}$. Then the problem\n$$\n\\min_{\\boldsymbol{\\delta}} \\ \\|\\boldsymbol{\\delta}\\|_{2} \\quad \\text{subject to} \\quad \\sum_{k=1}^{5} \\left(Y_{k}^{\\mathrm{upd}} + \\delta_{k}\\right) = 1, \\ \\ Y_{k}^{\\mathrm{upd}} + \\delta_{k} \\geq 0\n$$\nis equivalent to the Euclidean projection of $\\boldsymbol{Y}^{\\mathrm{upd}}$ onto $\\mathcal{S}$:\n$$\n\\min_{\\boldsymbol{y} \\in \\mathcal{S}} \\ \\frac{1}{2} \\|\\boldsymbol{y} - \\boldsymbol{Y}^{\\mathrm{upd}}\\|_{2}^{2}.\n$$\nThis is a strictly convex quadratic program with linear equality and inequality constraints, so it admits a unique solution. We derive the Karush-Kuhn-Tucker (KKT) conditions to characterize the optimizer.\n\nForm the Lagrangian\n$$\n\\mathcal{L}(\\boldsymbol{y}, \\lambda, \\boldsymbol{\\mu}) = \\frac{1}{2} \\sum_{k=1}^{5} \\left(y_{k} - Y_{k}^{\\mathrm{upd}}\\right)^{2} + \\lambda \\left( \\sum_{k=1}^{5} y_{k} - 1 \\right) - \\sum_{k=1}^{5} \\mu_{k} y_{k},\n$$\nwith $\\lambda \\in \\mathbb{R}$ the multiplier for the equality constraint and $\\mu_{k} \\geq 0$ the multipliers for $y_{k} \\geq 0$. The KKT conditions are:\n\n1. Stationarity:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial y_{k}} = y_{k} - Y_{k}^{\\mathrm{upd}} + \\lambda - \\mu_{k} = 0, \\quad k=1,\\dots,5.\n$$\n\n2. Primal feasibility:\n$$\n\\sum_{k=1}^{5} y_{k} = 1, \\quad y_{k} \\geq 0 \\ \\ \\forall k.\n$$\n\n3. Dual feasibility:\n$$\n\\mu_{k} \\geq 0 \\ \\ \\forall k.\n$$\n\n4. Complementary slackness:\n$$\n\\mu_{k} y_{k} = 0 \\ \\ \\forall k.\n$$\n\nFrom stationarity, for each $k$:\n$$\ny_{k} = Y_{k}^{\\mathrm{upd}} - \\lambda + \\mu_{k}.\n$$\nIf $y_{k} > 0$, complementary slackness implies $\\mu_{k} = 0$, so for the active (strictly positive) components,\n$$\ny_{k} = Y_{k}^{\\mathrm{upd}} - \\lambda.\n$$\nIf $y_{k} = 0$, then $\\mu_{k} \\geq 0$ adjusts to satisfy stationarity, and we can write the solution compactly as\n$$\ny_{k} = \\max\\!\\left( Y_{k}^{\\mathrm{upd}} - \\lambda, \\ 0 \\right), \\quad k=1,\\dots,5,\n$$\nfor some threshold $\\lambda$ chosen to enforce the equality constraint. This is the well-known characterization of the Euclidean projection onto the probability simplex.\n\nThe equality constraint $\\sum_{k=1}^{5} y_{k} = 1$ thus becomes the scalar equation\n$$\n\\sum_{k=1}^{5} \\max\\!\\left( Y_{k}^{\\mathrm{upd}} - \\lambda, \\ 0 \\right) = 1.\n$$\nTo solve for $\\lambda$, we determine the active set $\\mathcal{A} = \\{ k \\mid Y_{k}^{\\mathrm{upd}} - \\lambda > 0 \\}$ at the solution. A practical approach is to sort $Y_{k}^{\\mathrm{upd}}$ in descending order and test candidate active set sizes. For the given data\n$$\n\\boldsymbol{Y}^{\\mathrm{upd}} = \\left( 0.40,\\ 0.35,\\ 0.20,\\ 0.08,\\ -0.03 \\right),\n$$\na plausible active set is $\\mathcal{A} = \\{1,2,3,4\\}$ (the first four components), since the fifth is already negative and likely becomes zero after projection. Assuming $|\\mathcal{A}| = m = 4$, the equality constraint reduces to\n$$\n\\sum_{k \\in \\mathcal{A}} \\left( Y_{k}^{\\mathrm{upd}} - \\lambda \\right) = 1 \\quad \\Longrightarrow \\quad \\left( \\sum_{k \\in \\mathcal{A}} Y_{k}^{\\mathrm{upd}} \\right) - m \\lambda = 1.\n$$\nCompute the sum over the active set:\n$$\n\\sum_{k \\in \\mathcal{A}} Y_{k}^{\\mathrm{upd}} = 0.40 + 0.35 + 0.20 + 0.08 = 1.03.\n$$\nThen\n$$\n1.03 - 4 \\lambda = 1 \\quad \\Longrightarrow \\quad \\lambda = \\frac{1.03 - 1}{4} = 0.0075.\n$$\nWe must verify the consistency of the active set: for $k \\in \\mathcal{A}$,\n$$\nY_{k}^{\\mathrm{upd}} - \\lambda > 0 \\quad \\text{and for} \\quad k \\notin \\mathcal{A}, \\quad Y_{k}^{\\mathrm{upd}} - \\lambda \\leq 0.\n$$\nCheck the smallest active component:\n$$\n0.08 - 0.0075 = 0.0725 > 0,\n$$\nand the inactive one:\n$$\n-0.03 - 0.0075 = -0.0375 \\leq 0.\n$$\nHence the assumed active set is correct. Therefore, the projected mass fractions are\n$$\n\\boldsymbol{y}^{\\star} = \\left( \\max(0.40 - 0.0075, 0), \\ \\max(0.35 - 0.0075, 0), \\ \\max(0.20 - 0.0075, 0), \\ \\max(0.08 - 0.0075, 0), \\ \\max(-0.03 - 0.0075, 0) \\right)\n$$\n$$\n= \\left( 0.3925,\\ 0.3425,\\ 0.1925,\\ 0.0725,\\ 0 \\right).\n$$\nThe minimal correction vector $\\boldsymbol{\\delta}^{\\star} = \\boldsymbol{y}^{\\star} - \\boldsymbol{Y}^{\\mathrm{upd}}$ is thus\n$$\n\\boldsymbol{\\delta}^{\\star} = \\left( 0.3925 - 0.40,\\ 0.3425 - 0.35,\\ 0.1925 - 0.20,\\ 0.0725 - 0.08,\\ 0 - (-0.03) \\right)\n$$\n$$\n= \\left( -0.0075,\\ -0.0075,\\ -0.0075,\\ -0.0075,\\ 0.03 \\right).\n$$\nWe can verify the constraints: $\\sum_{k=1}^{5} \\left(Y_{k}^{\\mathrm{upd}} + \\delta_{k}^{\\star}\\right) = \\sum_{k=1}^{5} y_{k}^{\\star} = 1$ and $Y_{k}^{\\mathrm{upd}} + \\delta_{k}^{\\star} \\geq 0$ for all $k$, with the fifth component becoming exactly zero. By the strict convexity of the objective and linearity of the constraints, this solution is unique and minimizes $\\|\\boldsymbol{\\delta}\\|_{2}$.\n\nTherefore, the minimal correction vector is\n$$\n\\boldsymbol{\\delta}^{\\star} = \\left( -0.0075,\\ -0.0075,\\ -0.0075,\\ -0.0075,\\ 0.03 \\right).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-0.0075 & -0.0075 & -0.0075 & -0.0075 & 0.03\\end{pmatrix}}$$"
        }
    ]
}