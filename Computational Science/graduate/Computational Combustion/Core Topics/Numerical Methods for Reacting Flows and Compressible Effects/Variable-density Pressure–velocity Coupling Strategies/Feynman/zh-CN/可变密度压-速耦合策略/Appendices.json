{
    "hands_on_practices": [
        {
            "introduction": "在低马赫数反应流中，即使没有质量源项，剧烈的热释放导致的密度变化也会产生速度场。本练习将引导你从理想气体状态方程和连续性方程出发，推导出在恒定背景压力下，体积膨胀率（速度散度 $\\nabla \\cdot \\mathbf{u}$）与温度和组分变化率之间的基本数学关系 。这一“散度约束”是所有变密度压力-速度耦合策略的理论基石。",
            "id": "4075911",
            "problem": "考虑一个在计算燃烧学中使用的恒压反应器，其中包含空间均匀、密度可变、发生反应的理想气体混合物。该反应器在低马赫数近似下进行建模，其速度场可以适应体积膨胀或收缩，但热力学场在空间上是均匀的，仅随时间变化。设压力为 $p_{0}(t)$，并假定它被约束为不随时间变化。该混合物由理想气体混合物的状态方程（EOS）描述，\n$$\np_{0} \\;=\\; \\rho \\, R_{u} \\, T \\,\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}},\n$$\n其中 $\\rho$ 是密度，$T$ 是温度，$R_{u}$ 是通用气体常数，$Y_{k}$ 是组分的质量分数，$W_{k}$ 是组分的分子量，$N$ 是组分的数量。在空间均匀的反应器中，连续性方程简化为\n$$\n\\partial_{t}\\rho \\;+\\; \\rho \\,\\nabla\\cdot\\mathbf{u} \\;=\\; 0,\n$$\n其中 $\\nabla\\cdot\\mathbf{u}$ 是速度散度，对于均匀反应器，它在空间上是均匀的。\n\n从连续性方程和理想气体混合物状态方程严格出发，并假设 $p_{0}(t)$ 不随时间变化，推导温度的时间导数 $\\partial_{t} T$ 与速度散度 $\\nabla\\cdot\\mathbf{u}$ 之间的耦合关系。该关系在允许化学反应引起的组分 $Y_{k}(t)$ 随时间普遍变化的同时，强制压力保持恒定。将你的最终答案表示为一个单一的封闭形式解析表达式，显示 $\\nabla\\cdot\\mathbf{u}$ 如何依赖于 $\\partial_{t} T$ 和组分的时间变化。最终表达式中不要包含单位。",
            "solution": "该问题已经过验证，被认为是计算燃烧学领域中一个适定、有科学依据的问题。对于密度可变的低马赫数流动，推导压力-速度耦合约束是一项基础练习。\n\n目标是在恒定压力的约束下，推导速度散度 $\\nabla\\cdot\\mathbf{u}$、温度变化率 $\\partial_{t} T$ 和组分组成变化率 $\\partial_{t} Y_{k}$ 之间的关系。\n\n我们从问题陈述中提供的两个控制方程开始。\n\n首先，在恒定压力 $p_{0}$ 下的理想气体混合物状态方程（EOS）：\n$$\np_{0} = \\rho \\, R_{u} \\, T \\,\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}\n$$\n其中 $\\rho(t)$、$T(t)$ 和组分质量分数 $Y_{k}(t)$ 都是时间 $t$ 的函数。通用气体常数 $R_{u}$ 和组分分子量 $W_{k}$ 是常数。\n\n其次，空间均匀系统的连续性方程：\n$$\n\\partial_{t}\\rho + \\rho \\,\\nabla\\cdot\\mathbf{u} = 0\n$$\n\n问题的核心约束是压力 $p_{0}$ 不随时间变化。因此，其时间导数必须为零：\n$$\n\\partial_{t} p_{0} = 0\n$$\n\n为了强制执行此约束，我们对状态方程（EOS）关于时间求导。由于 $p_{0}$ 和 $R_{u}$ 是常数，我们可以将状态方程写为 $\\frac{p_{0}}{R_{u}} = \\rho \\, T \\,\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}$。对两边关于时间求导得到：\n$$\n\\partial_{t} \\left( \\frac{p_{0}}{R_{u}} \\right) = \\partial_{t} \\left( \\rho \\, T \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)\n$$\n$$\n0 = \\partial_{t} \\left( \\rho \\, T \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)\n$$\n右边是三个随时间变化的量的乘积：密度 $\\rho(t)$、温度 $T(t)$ 和组分项 $\\sum_{k=1}^{N} \\frac{Y_{k}(t)}{W_{k}}$。我们应用乘法法则求导，$(fgh)' = f'gh + fg'h + fgh'$，其中 $f=\\rho$，$g=T$，$h=\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}$。这得到：\n$$\n0 = (\\partial_{t}\\rho) \\left( T \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho \\left( (\\partial_{t}T) \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho \\left( T \\, \\partial_{t}\\left(\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}\\right) \\right)\n$$\n求和项的导数是导数的和，因为 $W_{k}$ 是常数：\n$$\n\\partial_{t}\\left(\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}\\right) = \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}}\n$$\n将此代回展开的状态方程导数中得到：\n$$\n0 = (\\partial_{t}\\rho) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\n现在，我们引入连续性方程，它将密度的时间导数与速度散度联系起来。从 $\\partial_{t}\\rho + \\rho \\,\\nabla\\cdot\\mathbf{u} = 0$，我们得到：\n$$\n\\partial_{t}\\rho = -\\rho \\,\\nabla\\cdot\\mathbf{u}\n$$\n我们将 $\\partial_{t}\\rho$ 的这个表达式代入我们微分后的状态方程：\n$$\n0 = (-\\rho \\,\\nabla\\cdot\\mathbf{u}) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + \\rho T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\n假设密度 $\\rho$ 非零，我们可以将整个方程除以 $\\rho$：\n$$\n0 = -(\\nabla\\cdot\\mathbf{u}) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\n我们的目标是找到 $\\nabla\\cdot\\mathbf{u}$ 的表达式。我们分离出包含 $\\nabla\\cdot\\mathbf{u}$ 的项：\n$$\n(\\nabla\\cdot\\mathbf{u}) T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) = (\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)\n$$\n最后，我们通过除以左侧的系数 $T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)$ 来求解 $\\nabla\\cdot\\mathbf{u}$，假设 $T \\neq 0$ 且混合物存在（即，和不为零）：\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{(\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right) + T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)}{T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)}\n$$\n这个表达式可以通过将其分成两个分数来简化：\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{(\\partial_{t}T) \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)}{T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)} + \\frac{T \\left( \\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}} \\right)}{T \\left( \\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}} \\right)}\n$$\n消去每个分数中的公因子，得到速度散度的最终解析表达式：\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{1}{T} \\partial_{t}T + \\frac{\\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}}}{\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}}\n$$\n这就是所要求的耦合关系。它规定了为响应温度和组分的变化以维持恒定压力所需的体积膨胀率（$\\nabla\\cdot\\mathbf{u}$）。",
            "answer": "$$\\boxed{\\nabla \\cdot \\mathbf{u} = \\frac{1}{T}\\partial_{t}T + \\frac{\\sum_{k=1}^{N} \\frac{\\partial_{t}Y_{k}}{W_{k}}}{\\sum_{k=1}^{N} \\frac{Y_{k}}{W_{k}}}}$$"
        },
        {
            "introduction": "将连续的控制方程离散化到数值网格上会带来新的挑战。在同位网格（collocated grid）上，对压力和速度进行直接的离散耦合会导致一种臭名昭著的“棋盘格”压力振荡，使得计算结果毫无物理意义。本练习将深入探讨经典的Rhie-Chow插值格式，通过理论分析揭示它如何有效地抑制这些非物理振荡，确保即使在密度剧烈变化的情况下也能获得稳定、可靠的数值解 。",
            "id": "4075909",
            "problem": "考虑一个用于低马赫数可变密度反应流的一维、均匀、同位有限体积离散化，这是计算燃烧学中的典型情况。网格的网格中心由 $i \\in \\mathbb{Z}$ 索引，具有均匀的网格宽度 $\\Delta x$ 和单位面面积，因此每个控制体的体积为 $V = \\Delta x$。由于组分分层，密度场呈空间交替分布：当 $i$ 为奇数时 $\\rho_{i} = \\rho_{1}$，当 $i$ 为偶数时 $\\rho_{i} = \\rho_{2}$，其中 $\\rho_{1}  0$ 且 $\\rho_{2}  0$。网格 $i$ 中的非定常动量系数定义为 $a_{i} = \\rho_{i} \\Delta x / \\Delta t$，其中 $\\Delta t  0$ 是用于稳定压力-速度耦合的伪时间步长。\n\n在同位网格上，使用 Rhie–Chow (RC) 插值策略进行压力-速度耦合。在面速度的压力驱动部分，引入一个无量纲强度参数 $\\alpha \\in \\mathbb{R}$ 乘以 RC 阻尼，并将网格 $i$ 和 $i+1$ 之间的 RC 面速度贡献定义为\n$$\nu^{p}_{i+\\frac{1}{2}} = - \\alpha \\, d_{i+\\frac{1}{2}} \\left( p_{i+1} - p_{i} \\right),\n$$\n其中面 $i+\\frac{1}{2}$ 的动量逆系数为 $d_{i+\\frac{1}{2}} = 1/a_{i+\\frac{1}{2}}$，面动量系数 $a_{i+\\frac{1}{2}}$ 是相邻网格系数的调和平均，\n$$\na_{i+\\frac{1}{2}} = \\frac{2}{\\frac{1}{a_{i}} + \\frac{1}{a_{i+1}}}.\n$$\n设面密度为算术平均 $\\rho_{i+\\frac{1}{2}} = (\\rho_{i} + \\rho_{i+1})/2$。则面 $i+\\frac{1}{2}$ 上的压力驱动质量通量修正为 $m^{p}_{i+\\frac{1}{2}} = \\rho_{i+\\frac{1}{2}} u^{p}_{i+\\frac{1}{2}}$。仅由压力驱动的 RC 速度引起的网格 $i$ 中的离散连续性残差为\n$$\nR_{i} = m^{p}_{i+\\frac{1}{2}} - m^{p}_{i-\\frac{1}{2}}.\n$$\n\n从离散质量守恒定律和上述 RC 定义出发。分析 $R_{i}$ 对典型棋盘格压力模式 $p_{i} = (-1)^{i} p_{0}$ 的响应，其中 $p_{0}$ 是一个非零常数振幅。根据比例关系\n$$\nR_{i} = \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\, \\hat{\\lambda} \\, p_{i}\n$$\n定义的无量纲、密度归一化的特征值 $\\hat{\\lambda}$，在 RC 插值对 $a_{i+\\frac{1}{2}}$ 使用调和平均、对 $\\rho_{i+\\frac{1}{2}}$ 使用算术平均，并处在上述交替密度模式下时，推导出其闭式表达式。\n\n你的最终答案必须是仅含 $\\alpha$ 的 $\\hat{\\lambda}$ 的单个解析表达式。由于 $\\hat{\\lambda}$ 根据其构造是无量纲的，因此不需要单位。此外，根据你的推导，解释 RC 策略在此类具有可变密度的同位网格上消除棋盘格压力模式的条件。不要计算任何数值。提供 $\\hat{\\lambda}$ 的表达式作为最终答案。",
            "solution": "该问题陈述经评估是有效的。它在科学上基于计算流体动力学的原理，特别是压力-速度耦合方案的分析。问题提法是适定的，提供了所有必要的定义和条件以得出唯一解。其语言客观，设定内部一致。\n\n目标是根据在棋盘格压力模式下连续性残差 $R_{i}$ 的关系式，推导出无量纲特征值 $\\hat{\\lambda}$。推导过程如下。\n\n网格 $i$ 中的离散连续性残差定义为净压力驱动质量通量：\n$$\nR_{i} = m^{p}_{i+\\frac{1}{2}} - m^{p}_{i-\\frac{1}{2}}\n$$\n面上的压力驱动质量通量由 $m^{p} = \\rho_{\\text{face}} u^{p}_{\\text{face}}$ 给出。面 $i+\\frac{1}{2}$ 上的压力驱动速度贡献定义为：\n$$\nu^{p}_{i+\\frac{1}{2}} = - \\alpha \\, d_{i+\\frac{1}{2}} \\left( p_{i+1} - p_{i} \\right) = - \\alpha \\frac{1}{a_{i+\\frac{1}{2}}} \\left( p_{i+1} - p_{i} \\right)\n$$\n因此，面 $i+\\frac{1}{2}$ 上的质量通量为：\n$$\nm^{p}_{i+\\frac{1}{2}} = \\rho_{i+\\frac{1}{2}} u^{p}_{i+\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\left( p_{i+1} - p_{i} \\right)\n$$\n类似地，面 $i-\\frac{1}{2}$ 上的质量通量为：\n$$\nm^{p}_{i-\\frac{1}{2}} = \\rho_{i-\\frac{1}{2}} u^{p}_{i-\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} \\left( p_{i} - p_{i-1} \\right)\n$$\n我们现在引入典型棋盘格压力模式 $p_{i} = (-1)^{i} p_{0}$，其中 $p_{0}$ 是一个非零常数振幅。跨网格面的压力差为：\n$$\np_{i+1} - p_{i} = (-1)^{i+1} p_{0} - (-1)^{i} p_{0} = -(-1)^{i} p_{0} - (-1)^{i} p_{0} = -2 (-1)^{i} p_{0} = -2 p_{i}\n$$\n$$\np_{i} - p_{i-1} = (-1)^{i} p_{0} - (-1)^{i-1} p_{0} = (-1)^{i} p_{0} - (-(-1)^{i} p_{0}) = 2 (-1)^{i} p_{0} = 2 p_{i}\n$$\n将这些压力差代回质量通量表达式：\n$$\nm^{p}_{i+\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} (-2 p_{i}) = 2 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}\n$$\n$$\nm^{p}_{i-\\frac{1}{2}} = - \\alpha \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} (2 p_{i}) = -2 \\alpha p_{i} \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}}\n$$\n连续性残差 $R_{i}$ 于是为：\n$$\nR_{i} = m^{p}_{i+\\frac{1}{2}} - m^{p}_{i-\\frac{1}{2}} = \\left( 2 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\right) - \\left( -2 \\alpha p_{i} \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} \\right) = 2 \\alpha p_{i} \\left( \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} + \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}} \\right)\n$$\n接下来，我们使用指定的交替密度场（当 $i$ 为奇数时 $\\rho_{i} = \\rho_{1}$，当 $i$ 为偶数时 $\\rho_{i} = \\rho_{2}$）来计算面上的量。此分析与网格 $i$ 是奇数还是偶数无关。我们假设 $i$ 是一个偶数索引。那么 $i+1$ 和 $i-1$ 是奇数索引。\n- 网格 $i$：$\\rho_{i} = \\rho_{2}$\n- 网格 $i+1$：$\\rho_{i+1} = \\rho_{1}$\n- 网格 $i-1$：$\\rho_{i-1} = \\rho_{1}$\n\n网格动量系数为 $a_{k} = \\rho_{k} \\frac{\\Delta x}{\\Delta t}$。设 $K = \\frac{\\Delta x}{\\Delta t}$。则 $a_{i} = \\rho_{2} K$，$a_{i+1} = \\rho_{1} K$，$a_{i-1} = \\rho_{1} K$。\n\n对于面 $i+\\frac{1}{2}$（在网格 $i$ 和 $i+1$ 之间）：\n- 密度的算术平均：$\\rho_{i+\\frac{1}{2}} = \\frac{\\rho_{i} + \\rho_{i+1}}{2} = \\frac{\\rho_{2} + \\rho_{1}}{2}$。\n- 动量系数的调和平均：\n$$\na_{i+\\frac{1}{2}} = \\frac{2}{\\frac{1}{a_{i}} + \\frac{1}{a_{i+1}}} = \\frac{2}{\\frac{1}{\\rho_{2} K} + \\frac{1}{\\rho_{1} K}} = \\frac{2K}{\\frac{\\rho_{1} + \\rho_{2}}{\\rho_{1} \\rho_{2}}} = 2K \\frac{\\rho_{1} \\rho_{2}}{\\rho_{1} + \\rho_{2}}\n$$\n\n对于面 $i-\\frac{1}{2}$（在网格 $i-1$ 和 $i$ 之间）：\n- 密度的算术平均：$\\rho_{i-\\frac{1}{2}} = \\frac{\\rho_{i-1} + \\rho_{i}}{2} = \\frac{\\rho_{1} + \\rho_{2}}{2}$。\n- 动量系数的调和平均：\n$$\na_{i-\\frac{1}{2}} = \\frac{2}{\\frac{1}{a_{i-1}} + \\frac{1}{a_{i}}} = \\frac{2}{\\frac{1}{\\rho_{1} K} + \\frac{1}{\\rho_{2} K}} = \\frac{2K}{\\frac{\\rho_{2} + \\rho_{1}}{\\rho_{1} \\rho_{2}}} = 2K \\frac{\\rho_{1} \\rho_{2}}{\\rho_{1} + \\rho_{2}}\n$$\n我们观察到 $\\rho_{i+\\frac{1}{2}} = \\rho_{i-\\frac{1}{2}}$ 且 $a_{i+\\frac{1}{2}} = a_{i-\\frac{1}{2}}$。这是由于平均方法的对称性，以及面 $i+\\frac{1}{2}$ 和面 $i-\\frac{1}{2}$ 都跨越密度为 $\\rho_1$ 和 $\\rho_2$ 的网格。\n因此，比率 $\\frac{\\rho_{\\text{face}}}{a_{\\text{face}}}$ 对两个面是相同的：\n$$\n\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} = \\frac{\\rho_{i-\\frac{1}{2}}}{a_{i-\\frac{1}{2}}}\n$$\n将此恒等式代入 $R_{i}$ 的表达式：\n$$\nR_{i} = 2 \\alpha p_{i} \\left( \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} + \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\right) = 4 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}\n$$\n问题通过以下比例关系定义了无量纲特征值 $\\hat{\\lambda}$：\n$$\nR_{i} = \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\, \\hat{\\lambda} \\, p_{i}\n$$\n通过将此定义与我们推导出的 $R_{i}$ 表达式进行比较，我们可以使两者相等：\n$$\n\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}} \\, \\hat{\\lambda} \\, p_{i} = 4 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}\n$$\n由于 $p_{0} \\neq 0$，因此 $p_{i} \\neq 0$。此外，由于 $\\rho_{1}, \\rho_{2}, \\Delta x, \\Delta t$ 均为正值，项 $\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}$ 不为零。因此，我们可以从两边消去这些公因子，得到 $\\hat{\\lambda}$ 的表达式：\n$$\n\\hat{\\lambda} = 4\\alpha\n$$\n这个结果与密度 $\\rho_1, \\rho_2$ 以及网格参数 $\\Delta x, \\Delta t$ 无关。\n\nRhie-Chow (RC) 策略旨在防止同位网格上的压力-速度解耦，这种解耦表现为非物理的棋盘格压力振荡。如果棋盘格压力模式产生非零的连续性残差 $R_{i}$，进而驱动压力修正以平滑压力场，则该策略是成功的。\n如果对于非零的棋盘格压力场，$R_{i}=0$，则该方案无法消除该模式。根据我们的推导，$R_{i} = 4 \\alpha p_{i} \\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}$。由于 $p_i \\neq 0$ 且所有物理量均为正，项 $\\frac{\\rho_{i+\\frac{1}{2}}}{a_{i+\\frac{1}{2}}}$ 严格为正。因此，$R_i=0$ 当且仅当 $4\\alpha=0$，即 $\\alpha=0$。\nRC 策略成功消除棋盘格压力模式的条件是 $\\hat{\\lambda} \\neq 0$，这要求 $\\alpha \\neq 0$。当 $\\alpha=0$ 时，面速度公式中的压力梯度项被抵消，导致了同位网格上的经典解耦问题。强度参数 $\\alpha$ 的任何非零值都确保了棋盘格模式被正确地抑制。无量纲特征值 $\\hat{\\lambda}=4\\alpha$ 表明，对于这种平均方法的选择，基本耦合强度与密度比无关。",
            "answer": "$$\n\\boxed{4\\alpha}\n$$"
        },
        {
            "introduction": "数值求解器的最终考验是其正确性的验证——仅仅编写代码是不够的，我们必须证明它能精确求解目标方程。本练习将介绍一种严谨且强大的代码验证技术——“人造解方法”（Method of Manufactured Solutions, MMS）。你将亲自设计一个已知的解析解，反向推导出它所对应的控制方程源项，然后运行你的数值求解器，检验它是否能够以足够高的精度恢复这个“人造”的精确解 。这是确保计算结果可信度的关键一步。",
            "id": "4075809",
            "problem": "考虑一个边长为 $L = 1$、网格间距均匀的二维周期性方形区域。您需要使用人造解方法（Method of Manufactured Solutions, MMS）来验证一种用于低马赫数燃烧的可变密度压力-速度耦合策略。控制基础是质量守恒和理想气体状态方程（Equation of State, EOS），并且在混合物层面不存在外部质量源。目标是设计人造的温度场 $T(\\mathbf{x})$、组分质量分数场 $Y_k(\\mathbf{x})$ 和密度场 $\\rho(\\mathbf{x})$，以产生一个已知的散度源 $S(\\mathbf{x})$，并利用该源项来验证基于投影法的可变密度压力-速度耦合。\n\n基本原理：\n- 质量守恒：$$\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0.$$\n- 理想气体状态方程：$$\\rho = \\frac{p_0 W}{R_u T},$$ 其中 $p_0$ 是恒定的参考热力学压力，$W$ 是混合物的分子量，$R_u$ 是通用气体常数。\n- 混合物分子量：$$W = \\left(\\sum_{k} \\frac{Y_k}{W_k}\\right)^{-1},$$ 对于组分索引 $k$，其组分分子量为 $W_k$。\n\n在低马赫数极限下，背景压力 $p_0$ 恒定，速度散度 $S(\\mathbf{x})$ 由温度场 $T(\\mathbf{x})$ 和组分质量分数场 $Y_k(\\mathbf{x})$ 通过状态方程所隐含的物质密度变化决定。您的任务是：\n1. 从上述基本原理出发，推导散度约束 $$\\nabla \\cdot \\mathbf{u} = S(\\mathbf{x}).$$\n2. 从一个不一定满足该约束的人造周期性预测速度场 $\\mathbf{u}^\\ast(\\mathbf{x})$ 出发，推导用于强制耦合的可变系数压力泊松方程，并说明如何获得修正后的速度 $\\mathbf{u}^{n+1}(\\mathbf{x})$ ，使其在数值容差范围内满足散度约束。\n\n对于人造场，请在单位正方形 $(x,y) \\in [0,1)^2$ 上使用以下周期函数：\n- 温度：\n  $$T(x,y) = T_0 \\left[1 + a_T \\sin(2\\pi x)\\cos(2\\pi y)\\right].$$\n- 双组分混合物的组分质量分数：\n  $$Y_1(x,y) = Y_m + a_Y \\cos(2\\pi x)\\sin(2\\pi y),\\quad Y_2(x,y) = 1 - Y_1(x,y),$$\n  组分分子量分别为 $W_1$ 和 $W_2$。\n- 混合物分子量：\n  $$W(x,y) = \\left(\\frac{Y_1(x,y)}{W_1} + \\frac{Y_2(x,y)}{W_2}\\right)^{-1}.$$\n- 根据状态方程计算的密度：\n  $$\\rho(x,y) = \\frac{p_0 W(x,y)}{R_u T(x,y)}.$$\n\n使用人造的周期性预测速度\n$$\\mathbf{u}^\\ast(x,y) = \\begin{bmatrix}\\sin(2\\pi y) \\\\ \\cos(2\\pi x)\\end{bmatrix}.$$\n\n根据状态方程和速度场隐含的 $T$ 和 $W$ 的物质导数来定义散度源 $S(\\mathbf{x})$。为了进行此验证，假设人造场与时间无关，因此物质导数简化为对流导数 $D(\\cdot)/Dt = \\mathbf{u}\\cdot\\nabla(\\cdot)$。\n\n使用均匀时间步长 $\\Delta t$ 构建可变系数泊松问题，\n$$\\nabla \\cdot \\left(\\frac{\\Delta t}{\\rho} \\nabla \\phi\\right) = \\nabla \\cdot \\mathbf{u}^\\ast - S,$$\n并通过以下方式修正速度\n$$\\mathbf{u}^{n+1} = \\mathbf{u}^\\ast - \\frac{\\Delta t}{\\rho} \\nabla \\phi,$$\n以使 $\\nabla \\cdot \\mathbf{u}^{n+1} \\approx S$。\n\n算法要求：\n- 在均匀的 $N\\times N$ 网格上，对空间算子使用带有周期性边界条件的二阶中心有限差分格式进行离散化。\n- 使用保守通量形式对算子 $\\nabla \\cdot (\\alpha \\nabla \\phi)$ 进行离散化，其中 $\\alpha = \\Delta t/\\rho$，面心上的 $\\alpha$ 值由相邻单元中心值的算术平均得到。\n- 求解线性系统时，对 $\\phi$ 进行规范固定（例如，在任意一个网格点上将 $\\phi$ 设为零），以消除由周期性边界条件产生的零空间。\n\n验证指标：\n- 计算散度约束的均方根（RMS）误差，\n  $$E = \\sqrt{\\frac{1}{N^2}\\sum_{i,j} \\left[\\left(\\nabla \\cdot \\mathbf{u}^{n+1}\\right)_{i,j} - S_{i,j}\\right]^2}.$$\n\n单位：\n- 在最终的数值验证中，所有量都可以作为无量纲量处理。您可以在程序中为 $p_0$、$R_u$、$W_k$ 和 $T_0$ 使用物理上一致的值作为参数，但最终的验证指标 $E$ 必须以无量纲浮点数的形式报告。\n\n测试套件：\n为以下四组参数提供均方根误差 $E$，每组参数代表一个独特的覆盖场景：\n- 情况 A（理想情况，中等梯度）：$N = 16$，$\\Delta t = 10^{-3}$，$T_0 = 1200$，$p_0 = 101325$，$W_1 = 28\\times 10^{-3}$，$W_2 = 18\\times 10^{-3}$，$Y_m = 0.5$，$a_T = 0.05$，$a_Y = 0.10$。\n- 情况 B（加密网格，更强梯度）：$N = 32$，$\\Delta t = 5\\times 10^{-4}$，$T_0 = 1500$，$p_0 = 101325$，$W_1 = 28\\times 10^{-3}$，$W_2 = 18\\times 10^{-3}$，$Y_m = 0.4$，$a_T = 0.20$，$a_Y = 0.20$。\n- 情况 C（边缘情况，零源项）：$N = 8$，$\\Delta t = 10^{-2}$，$T_0 = 1000$，$p_0 = 101325$，$W_1 = 28\\times 10^{-3}$，$W_2 = 18\\times 10^{-3}$，$Y_m = 0.7$，$a_T = 0.0$，$a_Y = 0.0$。\n- 情况 D（中等网格，非对称梯度）：$N = 24$，$\\Delta t = 2\\times 10^{-3}$，$T_0 = 1300$，$p_0 = 101325$，$W_1 = 28\\times 10^{-3}$，$W_2 = 18\\times 10^{-3}$，$Y_m = 0.6$，$a_T = 0.15$，$a_Y = 0.05$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个情况的均方根误差，格式为方括号内以逗号分隔的列表（例如，“[E_A,E_B,E_C,E_D]”）。每个条目都必须是浮点数。",
            "solution": "所呈现的问题陈述是一个适定的人造解方法（MMS）练习，用于验证计算燃烧学中的可变密度压力-速度耦合算法。它具有科学依据，内容自洽，并为完整的推导和数值实现提供了所有必要信息。该问题被认为是有效的。\n\n在此，我们展示了详细的推导步骤和数值解的设计。\n\n### 1. 散度约束和源项的推导\n\n分析始于质量守恒方程的微分形式，其表达式为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n其中 $\\rho$ 是流体密度，$\\mathbf{u}$ 是速度矢量。使用矢量微积分恒等式 $\\nabla \\cdot (\\rho \\mathbf{u}) = \\mathbf{u} \\cdot \\nabla \\rho + \\rho \\nabla \\cdot \\mathbf{u}$，质量守恒方程可以展开为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\rho + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n前两项构成了密度的物质导数 $\\frac{D\\rho}{Dt}$ 。这使我们能够将方程重写为：\n$$\n\\frac{D\\rho}{Dt} + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n在低马赫数流动中，速度场必须满足一个由流体热力学状态导出的散度约束。通过重新排列上述方程，我们得到该约束的显式形式：\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\n这是速度场必须满足的目标散度，我们将其表示为源项 $S(\\mathbf{x})$：\n$$\nS(\\mathbf{x}) = \\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\n为了将其与给定的热场和组分场联系起来，我们使用在恒定背景压力 $p_0$ 下的理想气体状态方程（EOS）：\n$$\n\\rho = \\frac{p_0 W}{R_u T}\n$$\n其中 $W$ 是混合物分子量，$T$ 是温度，$R_u$ 是通用气体常数。对状态方程取自然对数，我们得到 $\\ln \\rho = \\ln(p_0/R_u) + \\ln W - \\ln T$。应用物质导数 $D/Dt$ 可得：\n$$\n\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = \\frac{1}{W}\\frac{DW}{Dt} - \\frac{1}{T}\\frac{DT}{Dt}\n$$\n将此式代入 $S(\\mathbf{x})$ 的表达式中，可得：\n$$\nS(\\mathbf{x}) = - \\left( \\frac{1}{W}\\frac{DW}{Dt} - \\frac{1}{T}\\frac{DT}{Dt} \\right) = \\frac{1}{T}\\frac{DT}{Dt} - \\frac{1}{W}\\frac{DW}{Dt}\n$$\n问题指定人造场与时间无关（$\\partial/\\partial t = 0$），因此物质导数简化为对流导数，例如 $DT/Dt = \\mathbf{u} \\cdot \\nabla T$。源项的计算需要一个速度场。在预测-校正算法的背景下，源项使用最佳可用速度估计值进行评估，即预测速度 $\\mathbf{u}^\\ast$。因此，人造源项定义为：\n$$\nS(\\mathbf{x}) = \\frac{1}{T}(\\mathbf{u}^\\ast \\cdot \\nabla T) - \\frac{1}{W}(\\mathbf{u}^\\ast \\cdot \\nabla W)\n$$\n右侧的所有场（$T$、$W$、$\\mathbf{u}^\\ast$）都是指定的，因此 $S(\\mathbf{x})$ 是一个已知函数。\n\n### 2. 投影法和压力泊松方程\n\n压力-速度耦合的核心是投影法。我们从一个不满足散度约束的预测速度 $\\mathbf{u}^\\ast$ 开始。通过施加一个校正，得到一个新的满足约束的速度场 $\\mathbf{u}^{n+1}$。该校正用一个标量势场 $\\phi$ 的梯度来定义：\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^\\ast - \\frac{\\Delta t}{\\rho} \\nabla \\phi\n$$\n这里，$\\phi$ 是一个类压力的校正势，$\\Delta t$ 是时间步长。我们对 $\\mathbf{u}^{n+1}$ 强制施加散度约束：\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = S\n$$\n将 $\\mathbf{u}^{n+1}$ 的表达式代入约束条件中：\n$$\n\\nabla \\cdot \\left( \\mathbf{u}^\\ast - \\frac{\\Delta t}{\\rho} \\nabla \\phi \\right) = S\n$$\n根据散度算子的线性性质，我们有：\n$$\n\\nabla \\cdot \\mathbf{u}^\\ast - \\nabla \\cdot \\left( \\frac{\\Delta t}{\\rho} \\nabla \\phi \\right) = S\n$$\n重新排列此方程，得到关于 $\\phi$ 的可变系数泊松方程：\n$$\n\\nabla \\cdot \\left( \\frac{\\Delta t}{\\rho} \\nabla \\phi \\right) = \\nabla \\cdot \\mathbf{u}^\\ast - S\n$$\n求解这个关于 $\\phi$ 的椭圆型偏微分方程，可以通过更新方程来校正速度场，确保最终得到的速度场 $\\mathbf{u}^{n+1}$ 在数值精度的限制内满足散度约束，即 $\\nabla \\cdot \\mathbf{u}^{n+1} = S$。\n\n### 3. 数值离散化与求解\n\n该问题在间距为 $h=1/N$ 的均匀 $N \\times N$ 笛卡尔网格上求解。所有标量场均位于单元中心 $(x_i, y_j) = (ih, jh)$。\n\n**空间算子**：所有空间导数均使用带有周期性边界条件的二阶中心差分进行近似。对于一个通用标量场 $f_{i,j}$：\n$$\n\\left(\\frac{\\partial f}{\\partial x}\\right)_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2h}, \\quad \\left(\\frac{\\partial f}{\\partial y}\\right)_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2h}\n$$\n其中索引按模 $N$ 计算。这些公式用于计算 $\\nabla T$、$\\nabla W$ 以及随后的源项 $S_{i,j}$。它们也用于计算速度场的散度。MMS 的一个关键方面是，在定义源项和验证解时使用相同的离散算子。\n\n**泊松方程离散化**：可变系数泊松方程采用保守的有限差分格式进行离散化。设 $\\alpha = \\Delta t / \\rho$。在网格点 $(i,j)$ 处，算子 $\\nabla \\cdot (\\alpha \\nabla \\phi)$ 被离散化为：\n$$\n\\frac{1}{h^2} \\left[ \\alpha_{i+\\frac{1}{2},j}(\\phi_{i+1,j}-\\phi_{i,j}) - \\alpha_{i-\\frac{1}{2},j}(\\phi_{i,j}-\\phi_{i-1,j}) + \\alpha_{i,j+\\frac{1}{2}}(\\phi_{i,j+1}-\\phi_{i,j}) - \\alpha_{i,j-\\frac{1}{2}}(\\phi_{i,j}-\\phi_{i,j-1}) \\right] = R_{i,j}\n$$\n其中 $R_{i,j} = (\\nabla \\cdot \\mathbf{u}^\\ast)_{i,j} - S_{i,j}$。单元面上的系数 $\\alpha$ 通过相邻单元中心值的算术平均值计算，例如 $\\alpha_{i+\\frac{1}{2},j} = (\\alpha_{i,j} + \\alpha_{i+1,j})/2$。这种形式为每个网格点导出一个对称的五点模板，最终形成一个关于未知势矢量 $\\mathbf{\\Phi}$ 的大型、稀疏、对称的线性方程组 $A\\mathbf{\\Phi} = \\mathbf{B}$。\n\n**线性系统求解**：由于周期性边界条件（常数向量位于其零空间中），得到的矩阵 $A$ 是奇异的。这与物理事实相符：压力校正仅在相差一个附加常数的情况下是确定的。为了获得唯一解，我们必须进行规范固定。一个简单的方法是将一个网格点上的势设为零，例如 $\\phi_{0,0}=0$。这个约束消除了零空间，使系统可解。然后使用稀疏线性代数求解器求解修正后的线性系统。\n\n**验证**：求解出 $\\phi$ 后，使用中心差分计算其梯度 $\\nabla \\phi$。然后计算修正后的速度 $\\mathbf{u}^{n+1}$。最后，计算其散度 $(\\nabla \\cdot \\mathbf{u}^{n+1})_{i,j}$，并与人造源 $S_{i,j}$ 进行比较。整个网格上的均方根（RMS）误差 $E$ 提供了定量的验证指标。\n$$\nE = \\sqrt{\\frac{1}{N^2}\\sum_{i,j} \\left[\\left(\\nabla \\cdot \\mathbf{u}^{n+1}\\right)_{i,j} - S_{i,j}\\right]^2}\n$$\n$E$ 的一个较小值证实了压力-速度耦合算法正确地强制执行了散度约束。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Universal gas constant, can be set to 1.0 as problem is dimensionless\n    # but using the physical value is also fine.\n    R_u = 8.314  # J/(mol K)\n\n    test_cases = [\n        # Case A: happy path, moderate gradients\n        {'N': 16, 'dt': 1e-3, 'T0': 1200, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.5, 'aT': 0.05, 'aY': 0.10, 'Ru': R_u},\n        # Case B: refined grid, stronger gradients\n        {'N': 32, 'dt': 5e-4, 'T0': 1500, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.4, 'aT': 0.20, 'aY': 0.20, 'Ru': R_u},\n        # Case C: edge case, zero source\n        {'N': 8, 'dt': 1e-2, 'T0': 1000, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.7, 'aT': 0.0, 'aY': 0.0, 'Ru': R_u},\n        # Case D: intermediate grid, asymmetric gradients\n        {'N': 24, 'dt': 2e-3, 'T0': 1300, 'p0': 101325, 'W1': 28e-3, 'W2': 18e-3, 'Ym': 0.6, 'aT': 0.15, 'aY': 0.05, 'Ru': R_u},\n    ]\n\n    results = [solve_case(**case) for case in test_cases]\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\ndef solve_case(N, dt, T0, p0, W1, W2, Ym, aT, aY, Ru):\n    \"\"\"\n    Solves a single instance of the manufactured solution problem.\n    \"\"\"\n    L = 1.0\n    h = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    xx, yy = np.meshgrid(x, x, indexing='ij')\n\n    # Define helper functions for periodic central differences\n    def grad(f, h):\n        gx = (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * h)\n        gy = (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * h)\n        return gx, gy\n\n    def div(vx, vy, h):\n        dvx_dx = (np.roll(vx, -1, axis=0) - np.roll(vx, 1, axis=0)) / (2 * h)\n        dvy_dy = (np.roll(vy, -1, axis=1) - np.roll(vy, 1, axis=1)) / (2 * h)\n        return dvx_dx + dvy_dy\n\n    # --- Step 1: Compute manufactured fields and source term S ---\n    \n    # Temperature field\n    T = T0 * (1 + aT * np.sin(2 * np.pi * xx) * np.cos(2 * np.pi * yy))\n\n    # Species and mixture molecular weight fields\n    Y1 = Ym + aY * np.cos(2 * np.pi * xx) * np.sin(2 * np.pi * yy)\n    Y2 = 1 - Y1\n    W = 1.0 / (Y1 / W1 + Y2 / W2)\n\n    # Density field from EOS\n    rho = (p0 * W) / (Ru * T)\n    \n    # Predictor velocity field\n    u_star = np.sin(2 * np.pi * yy)\n    v_star = np.cos(2 * np.pi * xx)\n\n    # Compute gradients of T and W numerically\n    grad_T_x, grad_T_y = grad(T, h)\n    grad_W_x, grad_W_y = grad(W, h)\n\n    # Compute material derivatives (convective part only)\n    DTDt = u_star * grad_T_x + v_star * grad_T_y\n    DWDt = u_star * grad_W_x + v_star * grad_W_y\n\n    # Compute divergence source term S\n    S = (1 / T) * DTDt - (1 / W) * DWDt\n\n    # --- Step 2: Set up and solve the Poisson equation ---\n    \n    # RHS of the Poisson equation: div(u*) - S\n    # Note: Analytical div(u*) is 0. Numerical will be close to zero.\n    div_u_star = div(u_star, v_star, h)\n    RHS = (div_u_star - S).flatten()\n\n    # Coefficient alpha = dt/rho\n    alpha = dt / rho\n\n    # Assemble the sparse matrix for the variable-coefficient Laplacian\n    A = sparse.lil_matrix((N*N, N*N))\n    \n    for i in range(N):\n        for j in range(N):\n            k = i + j * N\n            \n            # East face\n            ip1 = (i + 1) % N\n            alpha_e = 0.5 * (alpha[i, j] + alpha[ip1, j])\n            A[k, ip1 + j * N] += alpha_e / h**2\n            A[k, k] -= alpha_e / h**2\n\n            # West face\n            im1 = (i - 1 + N) % N\n            alpha_w = 0.5 * (alpha[i, j] + alpha[im1, j])\n            A[k, im1 + j * N] += alpha_w / h**2\n            A[k, k] -= alpha_w / h**2\n            \n            # North face\n            jp1 = (j + 1) % N\n            alpha_n = 0.5 * (alpha[i, j] + alpha[i, jp1])\n            A[k, i + jp1 * N] += alpha_n / h**2\n            A[k, k] -= alpha_n / h**2\n\n            # South face\n            jm1 = (j - 1 + N) % N\n            alpha_s = 0.5 * (alpha[i, j] + alpha[i, jm1])\n            A[k, i + jm1 * N] += alpha_s / h**2\n            A[k, k] -= alpha_s / h**2\n\n    # Apply gauge fixing: phi[0,0] = 0\n    k_fix = 0\n    A[k_fix, :] = 0\n    A[k_fix, k_fix] = 1.0\n    RHS[k_fix] = 0.0\n    \n    # Convert to CSC format for efficient solving\n    A = A.tocsc()\n    \n    # Solve the linear system for phi\n    phi_flat = spsolve(A, RHS)\n    phi = phi_flat.reshape((N, N))\n\n    # --- Step 3: Correct velocity and verify divergence ---\n\n    # Compute gradient of phi\n    grad_phi_x, grad_phi_y = grad(phi, h)\n    \n    # Compute corrected velocity u_n+1\n    u_np1 = u_star - alpha * grad_phi_x\n    v_np1 = v_star - alpha * grad_phi_y\n    \n    # Compute divergence of corrected velocity\n    div_u_np1 = div(u_np1, v_np1, h)\n    \n    # Compute the RMS error of the divergence constraint\n    error = np.sqrt(np.mean((div_u_np1 - S)**2))\n    \n    return error\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}