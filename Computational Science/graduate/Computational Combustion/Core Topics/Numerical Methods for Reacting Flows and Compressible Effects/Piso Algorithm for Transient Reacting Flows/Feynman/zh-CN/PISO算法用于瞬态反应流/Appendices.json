{
    "hands_on_practices": [
        {
            "introduction": "在同位网格（collocated grid）方法中，一个经典的数值挑战是压力-速度解耦，这可能导致非物理的棋盘状压力场。本练习旨在通过一个简化的案例，清晰地揭示该问题的根源，并引导您推导并应用Rhie–Chow插值方法。通过对比，您将亲身体会到Rhie–Chow插值如何有效地抑制压力振荡，这是现代CFD求解器中一项至关重要的技术 。",
            "id": "4050227",
            "problem": "考虑一个用于处理瞬态反应、低马赫数流动问题的算子分裂压力隐式 (PISO) 算法中的一维、双单元同位网格有限体积离散。两个控制体分别表示为 $L$ 和 $R$，它们的宽度均为 $\\Delta x$，并共享一个内部面 $f$。假设混合物密度和粘度恒定，并假定反应源项已经线性化，使得预测步中的显式动量源为零。设每个单元中的半隐式离散动量方程都由相同的正对角系数 $a$（来自瞬态项和粘性项的贡献）表征，因此预测速度满足 $u_{L}^{*} = 0$ 和 $u_{R}^{*} = 0$。\n\n由于压力-速度解耦，出现了一种虚假的棋盘格压力模式：设单元中心压力为 $p_{L} = p_{0}$ 和 $p_{R} = -p_{0}$，其中 $p_{0} > 0$。你需要比较两种获取面 $f$ 处速度的方法：\n\n1.  将预测速度线性插值到面上，得到 $u_{f}^{\\mathrm{lin}}$。\n2.  源于面上有限体积动量平衡的 Rhie–Chow 修正插值，其中压力梯度使用中心差分，面系数取为 $a_{f} = a$（与两个单元的对称性一致），得到 $u_{f}^{\\mathrm{RC}}$。\n\n从一维动量方程的微分形式 $ \\rho \\,\\partial u/\\partial t = -\\partial p/\\partial x + \\partial \\tau/\\partial x + S_{u}$ 及其半隐式有限体积离散出发，根据给定数据推导 $u_{f}^{\\mathrm{lin}}$ 和 $u_{f}^{\\mathrm{RC}}$，并计算无量纲差异\n$$\n\\Delta \\tilde{u}_{f} \\equiv \\frac{u_{f}^{\\mathrm{RC}} - u_{f}^{\\mathrm{lin}}}{U_{\\mathrm{ref}}},\n$$\n其中参考速度定义为 $U_{\\mathrm{ref}} = \\frac{p_{0}}{a\\,\\Delta x}$。请以单个实数形式给出最终答案。无需四舍五入。由于该量是无量纲的，因此无需包含物理单位。",
            "solution": "我们从业经验证过程开始。\n\n### 第一步：提取已知条件\n-   **系统**：一维、双单元同位网格有限体积离散。\n-   **算法**：用于瞬态反应、低马赫数流动的 PISO 算法。\n-   **单元**：两个控制体，$L$（左）和 $R$（右）。\n-   **几何**：等宽 $\\Delta x$。\n-   **面**：$L$ 和 $R$ 共享的单个内部面 $f$。\n-   **属性**：恒定的混合物密度 ($\\rho$) 和粘度 ($\\mu$)。\n-   **源项线性化**：预测步的显式动量源为零。\n-   **离散动量方程**：半隐式，由相同的正对角系数 $a$ 表征。\n-   **预测速度**：$u_{L}^{*} = 0$ 和 $u_{R}^{*} = 0$。\n-   **压力场**：虚假的棋盘格模式：$p_{L} = p_{0}$ 和 $p_{R} = -p_{0}$，其中 $p_{0} > 0$。\n-   **任务**：比较两种获取面速度 $u_f$ 的方法。\n    1.  **方法一（线性插值）**：将预测速度线性插值到面上，得到 $u_{f}^{\\mathrm{lin}}$。\n    2.  **方法二（Rhie-Chow）**：Rhie-Chow 修正插值。\n        -   源于面上有限体积动量平衡。\n        -   压力梯度使用中心差分。\n        -   面系数 $a_{f} = a$。\n        -   得到 $u_{f}^{\\mathrm{RC}}$。\n-   **控制方程**：一维动量方程：$\\rho \\,\\partial u/\\partial t = -\\partial p/\\partial x + \\partial \\tau/\\partial x + S_{u}$。\n-   **待计算量**：无量纲差异 $\\Delta \\tilde{u}_{f} \\equiv \\frac{u_{f}^{\\mathrm{RC}} - u_{f}^{\\mathrm{lin}}}{U_{\\mathrm{ref}}}$。\n-   **参考速度**：$U_{\\mathrm{ref}} = \\frac{p_{0}}{a\\,\\Delta x}$。\n-   **最终答案**：一个实数，无需四舍五入。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学上合理**：是的。该问题建立在计算流体动力学（CFD）的成熟框架内，特别是有限体积法和 PISO 算法。Rhie-Chow 插值是防止同位网格中压力-速度解耦的标准技术。该设置是展示此插值有效性的经典测试案例。给出的动量控制方程是正确的。\n-   **良定的**：是的。问题提供了推导两种面速度并计算其差异所需的所有必要信息。该设置虽然简化，但很完整，可以得出一个唯一的解。\n-   **客观的**：是的。语言精确且技术性强。它描述了一个特定的数值设置，并要求一个定量的结果。没有主观或基于意见的陈述。\n\n我们来检查是否存在无效性缺陷：\n1.  **科学/事实上不成立**：没有。所涉及的物理和数值方法都是标准的。\n2.  **不可形式化/不相关**：没有。这是一个可形式化的问题，与指定的 CFD 主题直接相关。\n3.  **不完整/矛盾的设置**：没有。给定的条件充分且一致。例如，陈述 $u_L^*=0$ 和 $u_R^*=0$ 是问题设置的直接结果（显式源项为零，并且隐含地假设流动从静止开始，或者前一时间步的速度和粘性项在预测器中相互抵消）。问题指出对角系数 $a$ 来自瞬态项和粘性项的贡献，而预测速度基本上是 $u^*_P = (H(u) - \\nabla p^o)/a_P$。在 $H(u)$ 包括所有其他项的情况下，以及在一个显式源为零的特定设置中，我们可以推断对于这个简化情况，$H(u)$ 的其他部分也为零，因此 $u^*_P=0$ 是该问题的一个有效前提。\n4.  **不切实际/不可行**：没有。虽然高度简化，但条件并非物理上不可能。棋盘格压力场是一种已知的数值伪影。\n5.  **病态/结构不良**：没有。存在一个唯一的、稳定的、有意义的解。\n6.  **伪深刻/琐碎**：没有。该问题测试了 CFD 的一个核心概念。它并非琐碎，因为它需要从第一性原理推导 Rhie-Chow 插值公式并正确应用。简化使其易于处理，但并未消除核心概念上的挑战。\n7.  **超出科学可验证范围**：没有。结果是可以通过数学推导和验证的。\n\n### 第三步：结论与行动\n该问题是**有效的**。我将继续进行解答。\n\n### 解题计划\n1.  从控制体 $P$ 的通用半离散动量方程开始。\n2.  定义预测速度 $u_P^*$。\n3.  通过对给定的预测速度 $u_L^*$ 和 $u_R^*$ 进行线性插值来计算 $u_{f}^{\\mathrm{lin}}$。\n4.  推导 $u_f^{\\mathrm{RC}}$ 的 Rhie-Chow 插值公式。这包括：\n    a. 为单元 $L$ 和 $R$ 写出预测速度方程。\n    b. 将这些方程插值到面 $f$ 上。\n    c. 在面上代入离散压力梯度。\n5.  将给定数据（$u_L^*=0$，$u_R^*=0$，$p_L=p_0$，$p_R=-p_0$，$a_f = a$）应用于推导出的 $u_f^{\\mathrm{lin}}$ 和 $u_f^{\\mathrm{RC}}$ 公式。\n6.  计算差异 $u_{f}^{\\mathrm{RC}} - u_{f}^{\\mathrm{lin}}$。\n7.  使用给定的 $U_{\\mathrm{ref}} = \\frac{p_{0}}{a\\,\\Delta x}$ 对差异进行无量纲化。\n8.  将最终数值结果框出。\n\n---\n**详细推导**\n\n**1. 通用半离散动量方程**\n\n问题指出，一维动量方程为 $\\rho \\,\\partial u/\\partial t = -\\partial p/\\partial x + \\partial \\tau/\\partial x + S_{u}$。\n对于单元 $P$ 的半隐式有限体积离散可以写成：\n$$ a_P u_P = H(u) - (\\nabla_d p)_P $$\n其中 $a_P$ 是主对角系数，包括瞬态项（$\\propto \\rho/\\Delta t$）和粘性项的隐式部分。$H(u)$ 包含所有其他显式项（对流项、剩余的粘性项、源项）。$(\\nabla_d p)_P$ 是单元 $P$ 中的离散压力梯度项。问题指出，对于单元 $L$ 和 $R$，$a_P=a$。\n\n预测步使用前一时间步或 PISO 迭代的压力 $p^{old}$ 来计算一个临时速度 $u^*$：\n$$ a_P u_P^* = H(u) - (\\nabla_d p^{old})_P $$\n问题指出，在预测阶段，显式动量源为零，并给出 $u_L^*=0$ 和 $u_R^*=0$。对这个简化设置最直接的解释是，所有显式项之和为零，且旧的压力场是均匀的。即 $H(u)=0$ 且 $\\nabla_d p^{old}=0$。这与 $u^*=0$ 一致。\n\n现在我将计算两个面速度。\n\n1.  **线性插值, $u_{f}^{\\mathrm{lin}}$**：\n    该方法将单元中心的预测速度插值到面 $f$ 上。鉴于单元 $L$ 和 $R$ 的宽度均为 $\\Delta x$，面 $f$ 位于单元中心的中间。线性插值给出：\n    $$ u_{f}^{\\mathrm{lin}} = \\frac{u_L^* + u_R^*}{2} $$\n    使用给定的值 $u_L^*=0$ 和 $u_R^*=0$：\n    $$ u_{f}^{\\mathrm{lin}} = \\frac{0 + 0}{2} = 0 $$\n\n2.  **Rhie-Chow 插值, $u_{f}^{\\mathrm{RC}}$**：\n    此方法旨在防止压力-速度解耦。它通过在面上构建一个动量方程来实现这一点。面上的修正速度 $u_f$ 应满足：\n    $$ a_f u_f = \\overline{H(u)}_f - (\\nabla_d p)_f $$\n    其中 $\\overline{H(u)}_f$ 是显式项 $H(u)$ 到面上的插值，$(\\nabla_d p)_f$ 是使用新压力场 $p$ 在面上计算的压力梯度。\n    Rhie-Chow 的关键思想是使用预测速度的定义来近似 $\\overline{H(u)}_f$。从 $a_P u_P^* = H(u)_P - (\\nabla_d p^{old})_P$ 可得 $H(u)_P = a_P u_P^* + (\\nabla_d p^{old})_P$。\n    插值到面 $f$：\n    $$ \\overline{H(u)}_f = \\overline{a_P u_P^*}_f + \\overline{(\\nabla_d p^{old})_P}_f $$\n    鉴于 $a_P=a$ 是常数，$\\overline{a_P u_P^*}_f = a \\overline{u_P^*}_f = a u_{f}^{\\mathrm{lin}}$。\n    如前所述，$u^*=0$ 的前提意味着 $H(u)=0$ 和 $\\nabla_d p^{old}=0$。因此，$\\overline{H(u)}_f = 0$ 和 $\\overline{(\\nabla_d p^{old})_P}_f = 0$。\n    Rhie-Chow 速度 $u_{f}^{\\mathrm{RC}}$（即修正速度 $u_f$）的方程变为：\n    $$ a_f u_{f}^{\\mathrm{RC}} = 0 - (\\nabla_d p)_f $$\n    问题提供了 $a_f = a$。对于同位网格，面压力梯度 $(\\nabla_d p)_f$ 使用相邻单元 $L$ 和 $R$ 的单元中心压力计算：\n    $$ (\\nabla_d p)_f = \\frac{p_R - p_L}{\\Delta x} $$\n    问题指定了棋盘格压力场 $p_L = p_0$ 和 $p_R = -p_0$。\n    $$ (\\nabla_d p)_f = \\frac{(-p_0) - p_0}{\\Delta x} = \\frac{-2p_0}{\\Delta x} $$\n    将此代入 $u_{f}^{\\mathrm{RC}}$ 的方程中：\n    $$ a u_{f}^{\\mathrm{RC}} = - \\left( \\frac{-2p_0}{\\Delta x} \\right) = \\frac{2p_0}{\\Delta x} $$\n    求解 $u_{f}^{\\mathrm{RC}}$：\n    $$ u_{f}^{\\mathrm{RC}} = \\frac{2p_0}{a \\Delta x} $$\n\n3.  **无量纲差异**：\n    最后一步是计算无量纲差异 $\\Delta \\tilde{u}_{f}$：\n    $$ \\Delta \\tilde{u}_{f} = \\frac{u_{f}^{\\mathrm{RC}} - u_{f}^{\\mathrm{lin}}}{U_{\\mathrm{ref}}} $$\n    代入推导出的速度和给定的参考速度 $U_{\\mathrm{ref}} = \\frac{p_{0}}{a\\,\\Delta x}$：\n    $$ \\Delta \\tilde{u}_{f} = \\frac{\\frac{2p_0}{a \\Delta x} - 0}{\\frac{p_0}{a \\Delta x}} = \\frac{2p_0}{a \\Delta x} \\cdot \\frac{a \\Delta x}{p_0} = 2 $$",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "PISO算法的核心在于其预测-校正循环，而第一步便是动量预测。本练习将带您深入一个控制单元的内部，剖析动量预测方程的构建过程，包括对流-扩散项的线性化处理以及压力梯度的作用。通过亲手计算预测速度，您将对半隐式离散格式以及PISO算法如何启动求解过程建立坚实的理解 。",
            "id": "4050273",
            "problem": "考虑一个二维、低马赫数反应气体流中的单个控制容积单元，标记为 $P$。该流动采用算子分裂压力隐式 (PISO) 算法进行推进。$x$ 方向速度分量 $u$ 的动量预测步，是通过对 $x$ 动量方程的积分形式在体积 $V_P$ 和时间步长 $\\Delta t$ 上进行离散化得到的。其中，对流和扩散项被线性化为相邻耦合系数，压力梯度作为体积源项保留。假设采用同位网格有限体积布置，扩散项使用二阶中心差分，对流项使用一阶迎风格式，并忽略当前时间步内预测子步的密度变化。\n\n给定时间层 $n$ 时，单元 $P$ 及其紧邻单元 $E$、$W$、$N$ 和 $S$ 的以下数据：\n- 单元体积：$V_P = 8.0 \\times 10^{-6}\\ \\mathrm{m}^3$。\n- 时间步长：$\\Delta t = 1.0 \\times 10^{-5}\\ \\mathrm{s}$。\n- 预测子步中的混合物密度：$\\rho_P = 1.0\\ \\mathrm{kg/m}^3$。\n- $x$ 动量方程中对流-扩散的线性化相邻耦合系数：$a_E = 2.5\\ \\mathrm{kg/s}$，$a_W = 1.5\\ \\mathrm{kg/s}$，$a_N = 1.0\\ \\mathrm{kg/s}$，$a_S = 0.8\\ \\mathrm{kg/s}$。\n- 时间层 $n$ 的已知相邻单元速度：$u_E^{n} = 3.0\\ \\mathrm{m/s}$，$u_W^{n} = 1.5\\ \\mathrm{m/s}$，$u_N^{n} = 0.5\\ \\mathrm{m/s}$，$u_S^{n} = 0.2\\ \\mathrm{m/s}$。\n- 上一时间层单元中心速度：$u_P^{n} = 1.0\\ \\mathrm{m/s}$。\n- $x$ 动量方程在 $V_P$ 上的集总源贡献（包括体力以及线性化的反应诱导动量源）：$b_P = 0.4\\ \\mathrm{N}$。\n- 时间 $n$ 的旧时间层压力梯度：$\\left(\\partial p/\\partial x\\right)^{n} = 1.5 \\times 10^{3}\\ \\mathrm{Pa/m}$。\n- 用于隐式压力预测器的新时间层压力梯度的外推估计值：$\\left(\\partial p/\\partial x\\right)^{n+1,\\mathrm{est}} = 9.0 \\times 10^{2}\\ \\mathrm{Pa/m}$。\n\n从 $x$ 动量方程的积分形式以及标准的有限体积时间积分和空间线性化出发，推导 PISO 算法中 $u_P^{*}$ 的离散预测方程。利用此推导：\n\n1. 计算预测方程中单元 $P$ 的对角系数 $a_P$。\n2. 计算采用时间层 $n$ 的压力梯度得到的显式压力预测速度 $u_P^{*,\\mathrm{exp}}$。\n3. 计算采用外推估计值 $\\left(\\partial p/\\partial x\\right)^{n+1,\\mathrm{est}}$ 作为压力梯度得到的隐式压力预测速度 $u_P^{*,\\mathrm{imp}}$。\n4. 通过计算差值的大小 $\\left|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}\\right|$，评估显式与隐式压力梯度处理方法的效果。\n\n最终报告的量以 $\\mathrm{m/s}$ 为单位，并将最终答案四舍五入至四位有效数字。仅报告大小 $\\left|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}\\right|$ 作为最终答案（不要将中间结果报告为最终答案）。",
            "solution": "在进行求解之前，对问题陈述进行了严格验证。\n\n**第 1 步：提取已知条件**\n- **算法**：二维、低马赫数反应气体流的算子分裂压力隐式 (PISO) 算法。\n- **离散化**：同位网格有限体积，扩散项使用二阶中心差分，对流项使用一阶迎风格式。\n- **单元**：中心单元 $P$，相邻单元 $E$、$W$、$N$、$S$。\n- **单元体积**：$V_P = 8.0 \\times 10^{-6}\\ \\mathrm{m}^3$。\n- **时间步长**：$\\Delta t = 1.0 \\times 10^{-5}\\ \\mathrm{s}$。\n- **混合物密度**：$\\rho_P = 1.0\\ \\mathrm{kg/m}^3$（假设在预测步中为常数）。\n- **线性化相邻系数（$x$-动量）**：$a_E = 2.5\\ \\mathrm{kg/s}$，$a_W = 1.5\\ \\mathrm{kg/s}$，$a_N = 1.0\\ \\mathrm{kg/s}$，$a_S = 0.8\\ \\mathrm{kg/s}$。\n- **相邻单元速度（时间 $n$）**：$u_E^{n} = 3.0\\ \\mathrm{m/s}$，$u_W^{n} = 1.5\\ \\mathrm{m/s}$，$u_N^{n} = 0.5\\ \\mathrm{m/s}$，$u_S^{n} = 0.2\\ \\mathrm{m/s}$。\n- **单元速度（时间 $n$）**：$u_P^{n} = 1.0\\ \\mathrm{m/s}$。\n- **集总源项**：$b_P = 0.4\\ \\mathrm{N}$。\n- **压力梯度（时间 $n$）**：$\\left(\\frac{\\partial p}{\\partial x}\\right)^{n} = 1.5 \\times 10^{3}\\ \\mathrm{Pa/m}$。\n- **外推压力梯度（$n+1$ 的估计值）**：$\\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} = 9.0 \\times 10^{2}\\ \\mathrm{Pa/m}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了计算流体动力学中的一个标准数值程序 (PISO)。问题提法得当，提供了构建和求解离散方程所需的所有数据。术语精确客观。所提供的数值和单位在物理上是一致的，对于微尺度或细网格模拟是合理的。问题结构清晰，不包含任何矛盾、歧义或逻辑缺陷。\n\n**第 3 步：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n**离散预测方程的推导**\n控制容积 $V_P$ 上的 $x$ 动量方程的积分形式为：\n$$ \\frac{\\partial}{\\partial t}\\int_{V_P} \\rho u \\,dV + \\int_{\\partial V_P} \\rho u (\\mathbf{v} \\cdot \\mathbf{n}) \\,dS = \\int_{\\partial V_P} \\mu \\frac{\\partial u}{\\partial n} \\, dS - \\int_{V_P} \\frac{\\partial p}{\\partial x} \\, dV + \\int_{V_P} S_u \\,dV $$\n我们使用半隐式方法对该方程进行离散化，用于动量预测步。时间导数使用一阶欧拉格式近似。对流项和扩散项被线性化，对于预测步，相邻单元速度的影响使用时间层 $n$ 的值进行显式处理，而单元自身的速度 $u_P^*$ 则进行隐式处理。这使得每个单元的方程组解耦。单元面上对流和扩散通量的贡献被线性化为所提供的相邻系数 $a_{nb}$。\n\n预测速度 $u_P^*$ 的离散动量方程形式如下：\n$$ \\frac{\\rho_P V_P (u_P^* - u_P^n)}{\\Delta t} + \\mathcal{L}(u) = -V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\n其中 $\\mathcal{L}(u)$ 表示净对流-扩散算子。它被线性化，使得对角贡献是隐式的，非对角贡献是显式的：\n$$ \\mathcal{L}(u) \\approx \\left(\\sum_{nb} a_{nb}\\right) u_P^* - \\sum_{nb} a_{nb} u_{nb}^n $$\n这里，$\\sum_{nb} a_{nb}$ 对应于相邻单元 $nb \\in \\{E, W, N, S\\}$ 的相邻系数之和。这是一种用于稳定性的标准线性化方法。将其代入时间离散方程：\n$$ \\frac{\\rho_P V_P}{\\Delta t} (u_P^* - u_P^n) + \\left(\\sum_{nb} a_{nb}\\right) u_P^* - \\sum_{nb} a_{nb} u_{nb}^n = -V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\n重排方程，将乘以未知数 $u_P^*$ 的项组合在左侧，得到标准形式 $a_P u_P^* = \\text{RHS}$：\n$$ \\left( \\frac{\\rho_P V_P}{\\Delta t} + \\sum_{nb} a_{nb} \\right) u_P^* = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\n这就是 $u_P^*$ 的离散预测方程。\n\n**1. 对角系数 $a_P$ 的计算**\n根据推导出的方程，对角系数 $a_P$ 是乘以 $u_P^*$ 的项：\n$$ a_P = \\frac{\\rho_P V_P}{\\Delta t} + \\sum_{nb} a_{nb} $$\n首先，我们计算相邻系数之和：\n$$ \\sum_{nb} a_{nb} = a_E + a_W + a_N + a_S = 2.5 + 1.5 + 1.0 + 0.8 = 5.8\\ \\mathrm{kg/s} $$\n接下来，我们计算瞬态项系数：\n$$ \\frac{\\rho_P V_P}{\\Delta t} = \\frac{(1.0\\ \\mathrm{kg/m}^3)(8.0 \\times 10^{-6}\\ \\mathrm{m}^3)}{1.0 \\times 10^{-5}\\ \\mathrm{s}} = 0.8\\ \\mathrm{kg/s} $$\n因此，对角系数 $a_P$ 为：\n$$ a_P = 0.8\\ \\mathrm{kg/s} + 5.8\\ \\mathrm{kg/s} = 6.6\\ \\mathrm{kg/s} $$\n\n**2. 显式压力预测速度 $u_P^{*,\\mathrm{exp}}$ 的计算**\n对于显式压力预测器，我们使用时间层 $n$ 的压力梯度 $\\left(\\frac{\\partial p}{\\partial x}\\right)^n$。预测方程的右端项 (RHS) 为：\n$$ \\text{RHS}_{\\mathrm{exp}} = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^n + b_P $$\n我们计算每一项：\n$$ \\sum_{nb} a_{nb} u_{nb}^n = (2.5)(3.0) + (1.5)(1.5) + (1.0)(0.5) + (0.8)(0.2) = 7.5 + 2.25 + 0.5 + 0.16 = 10.41\\ \\mathrm{N} $$\n$$ \\frac{\\rho_P V_P}{\\Delta t} u_P^n = (0.8\\ \\mathrm{kg/s})(1.0\\ \\mathrm{m/s}) = 0.8\\ \\mathrm{N} $$\n$$ V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^n = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3)(1.5 \\times 10^{3}\\ \\mathrm{Pa/m}) = 12.0 \\times 10^{-3}\\ \\mathrm{N} = 0.012\\ \\mathrm{N} $$\n源项给定为 $b_P = 0.4\\ \\mathrm{N}$。\n对 RHS 的这些贡献求和：\n$$ \\text{RHS}_{\\mathrm{exp}} = 10.41 + 0.8 - 0.012 + 0.4 = 11.598\\ \\mathrm{N} $$\n那么预测速度为：\n$$ u_P^{*,\\mathrm{exp}} = \\frac{\\text{RHS}_{\\mathrm{exp}}}{a_P} = \\frac{11.598\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} \\approx 1.75727\\ \\mathrm{m/s} $$\n\n**3. 隐式压力预测速度 $u_P^{*,\\mathrm{imp}}$ 的计算**\n对于隐式压力预测器，我们使用外推的压力梯度估计值 $\\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}}$。RHS 为：\n$$ \\text{RHS}_{\\mathrm{imp}} = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} + b_P $$\n唯一改变的项是压力项：\n$$ V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3)(9.0 \\times 10^{2}\\ \\mathrm{Pa/m}) = 7.2 \\times 10^{-3}\\ \\mathrm{N} = 0.0072\\ \\mathrm{N} $$\n隐式情况下的 RHS 为：\n$$ \\text{RHS}_{\\mathrm{imp}} = 10.41 + 0.8 - 0.0072 + 0.4 = 11.6028\\ \\mathrm{N} $$\n预测速度为：\n$$ u_P^{*,\\mathrm{imp}} = \\frac{\\text{RHS}_{\\mathrm{imp}}}{a_P} = \\frac{11.6028\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} = 1.758\\ \\mathrm{m/s} $$\n\n**4. 差值大小 $|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}|$ 的计算**\n预测速度的差异可以直接从 RHS 项的差异计算得出，因为 $a_P$ 在两个计算中是共有的：\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} = \\frac{\\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}}}{a_P} $$\nRHS 的差异完全由压力梯度项引起：\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = \\left(-V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}}\\right) - \\left(-V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n}\\right) $$\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = V_P \\left[ \\left(\\frac{\\partial p}{\\partial x}\\right)^{n} - \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} \\right] $$\n代入数值：\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3) [1.5 \\times 10^{3} - 9.0 \\times 10^{2}] \\mathrm{Pa/m} $$\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = (8.0 \\times 10^{-6})(600)\\ \\mathrm{N} = 4.8 \\times 10^{-3}\\ \\mathrm{N} $$\n现在，我们求速度差：\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} = \\frac{4.8 \\times 10^{-3}\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} = \\frac{4.8}{6.6} \\times 10^{-3}\\ \\mathrm{m/s} = \\frac{8}{11} \\times 10^{-3}\\ \\mathrm{m/s} $$\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} \\approx 0.00072727... \\ \\mathrm{m/s} $$\n其大小为 $|0.00072727...| = 0.00072727... \\ \\mathrm{m/s}$。\n四舍五入到四位有效数字，我们得到 $0.0007273\\ \\mathrm{m/s}$。这可以用科学记数法表示为 $7.273 \\times 10^{-4}\\ \\mathrm{m/s}$。",
            "answer": "$$\\boxed{7.273 \\times 10^{-4}}$$"
        },
        {
            "introduction": "PISO算法的校正步骤本质上是为了满足一个关于速度散度的约束。在反应流中，这个散度并非为零，而是与化学反应释放的热量紧密相关。本练习将引导您从基本守恒定律出发，推导在低马赫数反应流中速度散度与密度变化的关系，并将其应用于一个层流火焰的物理场景 。这将帮助您深刻理解算法的数值约束与燃烧物理现象（如热膨胀）之间的深刻联系。",
            "id": "4050302",
            "problem": "考虑一个一维、平面、化学计量的甲烷-空气层流小火焰，该小火焰嵌入一个使用压力隐式算子分裂 (PISO) 算法的低马赫数瞬态求解器中。流动被视为准等压。上游未燃混合物的温度为 $T_{u} = 300\\,\\mathrm{K}$，压力为 $p_{0} = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$。在未燃和已燃气体中，混合气体常数近似为常数，等于 $\\bar{R} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。已燃气体的温度为 $T_{b} = 1800\\,\\mathrm{K}$。层流燃烧速度为 $S_{L} = 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，反应区的热厚度为 $\\delta_{L} = 0.45\\,\\mathrm{mm}$。假设：\n- 理想气体行为和火焰面上空间均匀的压力 ($p \\approx p_{0}$)。\n- 在火焰固定坐标系中存在一个稳态一维剖面，使得质量通量 $m = \\rho u$ 为常数，且等于 $\\rho_{u} S_{L}$，其中 $\\rho_{u}$ 是上游密度。\n- 在厚度为 $\\delta_{L}$ 的反应区内，由于热膨胀，流向速度从 $U_{u}$ 近似线性变化到 $U_{b}$，其中 $U_{u}$ 和 $U_{b}$ 分别是上游和下游速度。\n\n任务：\n1. 从变密度连续性方程和理想气体定律出发，并使用准等压假设，推导出 PISO 算法对低马赫数反应流中校正后速度场施加的散度约束。用物质导数和热力学变量表示该约束。\n2. 使用理想气体定律，计算上游和已燃气体密度 $\\rho_{u}$ 和 $\\rho_{b}$ 以及膨胀因子 $E = \\rho_{u}/\\rho_{b}$。\n3. 对稳态一维小火焰使用质量守恒，确定 $U_{u}$ 和 $U_{b}$，并以恒定梯度 $\\nabla \\cdot \\mathbf{u} \\approx (U_{b} - U_{u})/\\delta_{L}$ 估算反应区内的散度。说明预期的符号并计算其大小。\n4. 在给定假设下，通过证明表达式的等价性，验证您的估计与任务1中推导出的散度约束是一致的。\n\n将最终数值答案四舍五入到 $3$ 位有效数字。以 $\\mathrm{s}^{-1}$ 为单位表示最终结果。",
            "solution": "该问题陈述经评估具有科学依据、适定、客观且自洽。它提出了一个计算燃烧理论中的的标准问题，为层流小火焰模型提供了清晰的定义、一致的数据和物理上现实的假设。满足了有效问题的所有标准。\n\n**任务1：散度约束的推导**\n\n起点是可压缩流体的连续性方程：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度矢量。对散度项使用乘积法则，可展开为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\rho + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n前两项代表密度的物质导数 $\\frac{D\\rho}{Dt}$：\n$$\n\\frac{D\\rho}{Dt} + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n这个方程可以重新整理，以跟随流体质点的密度变化来明确表示速度散度：\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\n为了用热力学变量表示这一点，我们使用给定的理想气体定律 $p = \\rho \\bar{R} T$，其中 $p$ 是压力， $T$ 是温度，$\\bar{R}$ 是比气体常数。问题陈述中指出流动是准等压的，意味着压力在空间上是均匀的，$p(\\mathbf{x}, t) \\approx p_0(t)$，但在瞬态情况下可以随时间缓慢变化。因此，$\\rho = \\frac{p_0(t)}{\\bar{R} T}$。\n\n为了将密度的物质导数与压力和温度的物质导数联系起来，处理状态方程的对数形式很方便：\n$$\n\\ln(\\rho) = \\ln(p) - \\ln(\\bar{R}) - \\ln(T)\n$$\n对此表达式求物质导数（注意 $\\bar{R}$ 是常数）：\n$$\n\\frac{D}{Dt}(\\ln \\rho) = \\frac{D}{Dt}(\\ln p) - \\frac{D}{Dt}(\\ln T)\n$$\n这等价于：\n$$\n\\frac{1}{\\rho} \\frac{D\\rho}{Dt} = \\frac{1}{p} \\frac{Dp}{Dt} - \\frac{1}{T} \\frac{DT}{Dt}\n$$\n将此代回速度散度的表达式，得到所求的约束条件：\n$$\n\\nabla \\cdot \\mathbf{u} = - \\left( \\frac{1}{p} \\frac{Dp}{Dt} - \\frac{1}{T} \\frac{DT}{Dt} \\right) = \\frac{1}{T} \\frac{DT}{Dt} - \\frac{1}{p} \\frac{Dp}{Dt}\n$$\n这就是 PISO 算法必须为校正后的速度场施加的散度约束。它将流动的运动学（$\\nabla \\cdot \\mathbf{u}$）与沿流体质点路径的热力学变化（$\\frac{DT}{Dt}$, $\\frac{Dp}{Dt}$）联系起来。\n\n**任务2：密度和膨胀因子的计算**\n\n上游未燃气体密度 $\\rho_u$ 和下游已燃气体密度 $\\rho_b$ 使用理想气体定律 $p = \\rho \\bar{R} T$ 计算，假设压力均匀 $p = p_0 = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$。\n\n给定值：\n$p_0 = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$\n$\\bar{R} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n$T_u = 300\\,\\mathrm{K}$\n$T_b = 1800\\,\\mathrm{K}$\n\n上游密度：\n$$\n\\rho_u = \\frac{p_0}{\\bar{R} T_u} = \\frac{1.013 \\times 10^{5}\\,\\mathrm{Pa}}{(287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})(300\\,\\mathrm{K})} \\approx 1.1765\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\n下游密度：\n$$\n\\rho_b = \\frac{p_0}{\\bar{R} T_b} = \\frac{1.013 \\times 10^{5}\\,\\mathrm{Pa}}{(287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})(1800\\,\\mathrm{K})} \\approx 0.19609\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\n膨胀因子 $E$ 是未燃气体密度与已燃气体密度的比值：\n$$\nE = \\frac{\\rho_u}{\\rho_b} = \\frac{p_0 / (\\bar{R} T_u)}{p_0 / (\\bar{R} T_b)} = \\frac{T_b}{T_u} = \\frac{1800\\,\\mathrm{K}}{300\\,\\mathrm{K}} = 6\n$$\n\n**任务3：速度和散度估计的计算**\n\n问题指定了一个在火焰固定参考系中的稳态一维小火焰。层流燃烧速度 $S_L$ 是未燃混合物进入火焰锋面的速度。因此，上游速度 $U_u$ 等于 $S_L$。\n$$\nU_u = S_L = 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n稳态火焰的质量守恒规定质量通量 $m = \\rho u$ 是常数：\n$$\n\\rho_u U_u = \\rho_b U_b\n$$\n下游速度 $U_b$ 可以计算为：\n$$\nU_b = \\frac{\\rho_u}{\\rho_b} U_u = E \\cdot U_u = 6 \\times 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 2.28\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n在一维情况下，速度散度 $\\nabla \\cdot \\mathbf{u}$ 为 $\\frac{du}{dx}$。问题要求将其估计为厚度为 $\\delta_L = 0.45\\,\\mathrm{mm} = 0.45 \\times 10^{-3}\\,\\mathrm{m}$ 的反应区内的恒定梯度。\n$$\n\\nabla \\cdot \\mathbf{u} \\approx \\frac{U_b - U_u}{\\delta_L}\n$$\n由于 $U_b > U_u$，散度为正，这是预期的，因为气体燃烧时会发生热膨胀。其大小为：\n$$\n\\nabla \\cdot \\mathbf{u} \\approx \\frac{2.28\\,\\mathrm{m}\\,\\mathrm{s}^{-1} - 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.45 \\times 10^{-3}\\,\\mathrm{m}} = \\frac{1.90}{0.45 \\times 10^{-3}}\\,\\mathrm{s}^{-1} \\approx 4222.2\\,\\mathrm{s}^{-1}\n$$\n四舍五入到三位有效数字，估计的散度为 $4.22 \\times 10^{3}\\,\\mathrm{s}^{-1}$。\n\n**任务4：一致性验证**\n\n我们必须验证任务3中的估计值 $\\frac{U_b - U_u}{\\delta_L}$ 在问题对稳态小火焰的假设下，与任务1的散度约束是一致的。\n\n对于稳态（$ \\frac{\\partial}{\\partial t} = 0 $）、一维（$ \\nabla \\rightarrow \\frac{d}{dx} $, $ \\mathbf{u} \\rightarrow u $）、等压（$ \\frac{Dp}{Dt} = u \\frac{dp}{dx} = 0 $）流动，物质导数变为 $\\frac{D}{Dt} = u \\frac{d}{dx}$。任务1中的散度约束简化为：\n$$\n\\frac{du}{dx} = \\frac{1}{T} \\left( u \\frac{dT}{dx} \\right) \\implies \\frac{1}{u}\\frac{du}{dx} = \\frac{1}{T}\\frac{dT}{dx}\n$$\n这是一个关联速度和温度剖面的微分方程。从火焰的未燃侧（$u=U_u, T=T_u$）积分到已燃侧（$u=U_b, T=T_b$）得到：\n$$\n\\int_{U_u}^{U_b} \\frac{1}{u} du = \\int_{T_u}^{T_b} \\frac{1}{T} dT \\implies \\ln\\left(\\frac{U_b}{U_u}\\right) = \\ln\\left(\\frac{T_b}{T_u}\\right) \\implies \\frac{U_b}{U_u} = \\frac{T_b}{T_u}\n$$\n这与我们在任务2和3中从质量守恒和理想气体定律得到的结果是一致的。\n\n现在，我们使用额外假设，即在反应区 $x \\in [0, \\delta_L]$ 内速度剖面是线性的：\n$$\nu(x) = U_u + (U_b - U_u) \\frac{x}{\\delta_L}\n$$\n在此假设下，速度散度在整个反应区内是恒定的：\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{du}{dx} = \\frac{U_b - U_u}{\\delta_L}\n$$\n这意味着任务3中的“估计值”是在线性速度剖面假设下的精确散度。我们现在必须证明任务1中的表达式能给出相同的结果。\n从积分关系 $\\frac{u(x)}{U_u} = \\frac{T(x)}{T_u}$，我们可以找到线性速度剖面所蕴含的温度剖面：\n$$\nT(x) = T_u \\frac{u(x)}{U_u} = T_u \\left( 1 + \\frac{U_b - U_u}{U_u} \\frac{x}{\\delta_L} \\right)\n$$\n因此，温度梯度也是恒定的：\n$$\n\\frac{dT}{dx} = T_u \\frac{U_b - U_u}{U_u \\delta_L}\n$$\n现在，将这些剖面代入任务1中的局部散度表达式 $\\frac{u}{T}\\frac{dT}{dx}$：\n$$\n\\frac{u(x)}{T(x)} \\frac{dT}{dx} = \\frac{u(x)}{T_u \\frac{u(x)}{U_u}} \\left( T_u \\frac{U_b - U_u}{U_u \\delta_L} \\right)\n$$\n项 $u(x)$、$T_u$ 和 $U_u$ 可以消去：\n$$\n\\frac{u(x)}{T(x)} \\frac{dT}{dx} = \\frac{U_u}{T_u} \\left( \\frac{T_u}{U_u} \\frac{U_b - U_u}{\\delta_L} \\right) = \\frac{U_b - U_u}{\\delta_L}\n$$\n这个结果与从线性速度剖面计算出的恒定梯度是相同的。因此，在问题的特定假设下，任务3的估计值不仅是一个近似，而且与任务1的基本散度约束完全一致且在数学上等价。因此，计算值得到了验证。\n任务3的最终数值结果，四舍五入到3位有效数字：\n$$\n\\frac{1.90}{0.45 \\times 10^{-3}} \\,\\mathrm{s}^{-1} \\approx 4220 \\,\\mathrm{s}^{-1} = 4.22 \\times 10^3 \\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\\boxed{4.22 \\times 10^{3}}$$"
        }
    ]
}