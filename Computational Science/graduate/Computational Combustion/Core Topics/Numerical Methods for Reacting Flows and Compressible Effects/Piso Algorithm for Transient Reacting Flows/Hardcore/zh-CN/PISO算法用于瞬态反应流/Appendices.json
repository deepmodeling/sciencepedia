{
    "hands_on_practices": [
        {
            "introduction": "PISO算法的第一步是动量预测，即在不立即强制执行质量守恒的情况下，求解动量方程以获得一个临时的速度场。这个练习将带你深入了解这一关键步骤的离散化细节，通过为一个控制体计算预测速度，你将亲身体会到不同项（如对流、扩散、压力梯度）是如何组合成一个代数方程的。这项实践对于理解PISO算法中“算子分裂”思想的本质至关重要。",
            "id": "4050273",
            "problem": "考虑一个二维、低马赫数反应气体流中的单个控制体单元（标记为 $P$），该流动使用压力隐式算子分裂 (PISO) 算法进行推进。$x$ 方向速度分量 $u$ 的动量预测步是通过在时间步长 $\\Delta t$ 内对体积 $V_P$ 上的 $x$ 动量方程的积分形式进行离散化得到的，其中对流和扩散被线性化为相邻耦合系数，压力梯度作为体积源项保留。假设采用同位网格有限体积布置，扩散项使用二阶中心差分，对流项使用一阶迎风格式，并且在当前时间步的预测阶段忽略密度变化。\n\n给定在时间层 $n$ 时，单元 $P$ 及其紧邻的东 (E)、西 (W)、北 (N)、南 (S) 单元的以下数据：\n- 单元体积：$V_P = 8.0 \\times 10^{-6}\\ \\mathrm{m}^3$。\n- 时间步长：$\\Delta t = 1.0 \\times 10^{-5}\\ \\mathrm{s}$。\n- 预测阶段的混合物密度：$\\rho_P = 1.0\\ \\mathrm{kg/m}^3$。\n- $x$ 动量方程中对流-扩散项的线性化相邻耦合系数：$a_E = 2.5\\ \\mathrm{kg/s}$，$a_W = 1.5\\ \\mathrm{kg/s}$，$a_N = 1.0\\ \\mathrm{kg/s}$，$a_S = 0.8\\ \\mathrm{kg/s}$。\n- 时间层 $n$ 的已知相邻单元速度：$u_E^{n} = 3.0\\ \\mathrm{m/s}$，$u_W^{n} = 1.5\\ \\mathrm{m/s}$，$u_N^{n} = 0.5\\ \\mathrm{m/s}$，$u_S^{n} = 0.2\\ \\mathrm{m/s}$。\n- 前一时间层的单元中心速度：$u_P^{n} = 1.0\\ \\mathrm{m/s}$。\n- $V_P$ 上 $x$ 动量方程的总源项贡献（包括体积力和线性化的反应引起的动量源）：$b_P = 0.4\\ \\mathrm{N}$。\n- 时间 $n$ 的旧时间层压力梯度：$\\left(\\partial p/\\partial x\\right)^{n} = 1.5 \\times 10^{3}\\ \\mathrm{Pa/m}$。\n- 用于压力隐式预测步的新时间层压力梯度的外推估计值：$\\left(\\partial p/\\partial x\\right)^{n+1,\\mathrm{est}} = 9.0 \\times 10^{2}\\ \\mathrm{Pa/m}$。\n\n从 $x$ 动量方程的积分形式和标准的有限体积时间积分及空间线性化出发，推导 PISO 算法中 $u_P^{*}$ 的离散预测方程。利用此推导过程：\n\n1. 计算预测方程中单元 $P$ 的对角系数 $a_P$。\n2. 通过取时间层 $n$ 的压力梯度，计算压力显式预测速度 $u_P^{*,\\mathrm{exp}}$。\n3. 通过取外推估计值 $\\left(\\partial p/\\partial x\\right)^{n+1,\\mathrm{est}}$ 作为压力梯度，计算压力隐式预测速度 $u_P^{*,\\mathrm{imp}}$。\n4. 通过计算差值的绝对值 $\\left|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}\\right|$，评估压力梯度显式处理与隐式处理的影响。\n\n以 $\\mathrm{m/s}$ 为单位表示您最终报告的量，并将最终答案四舍五入到四位有效数字。仅报告绝对值 $\\left|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}\\right|$ 作为最终答案（不要将中间结果报告为最终答案）。",
            "solution": "在进行求解之前，对问题陈述进行了严格验证。\n\n**第 1 步：提取给定条件**\n- **算法**：用于二维、低马赫数反应气体流的压力隐式算子分裂 (PISO) 算法。\n- **离散化**：同位网格有限体积法，扩散项采用二阶中心差分，对流项采用一阶迎风格式。\n- **单元**：中心单元 $P$，相邻单元 E、W、N、S。\n- **单元体积**：$V_P = 8.0 \\times 10^{-6}\\ \\mathrm{m}^3$。\n- **时间步长**：$\\Delta t = 1.0 \\times 10^{-5}\\ \\mathrm{s}$。\n- **混合物密度**：$\\rho_P = 1.0\\ \\mathrm{kg/m}^3$ （假设在预测步中为常数）。\n- **线性化相邻系数（$x$-动量）**：$a_E = 2.5\\ \\mathrm{kg/s}$，$a_W = 1.5\\ \\mathrm{kg/s}$，$a_N = 1.0\\ \\mathrm{kg/s}$，$a_S = 0.8\\ \\mathrm{kg/s}$。\n- **相邻单元速度（时间 $n$）**：$u_E^{n} = 3.0\\ \\mathrm{m/s}$，$u_W^{n} = 1.5\\ \\mathrm{m/s}$，$u_N^{n} = 0.5\\ \\mathrm{m/s}$，$u_S^{n} = 0.2\\ \\mathrm{m/s}$。\n- **单元速度（时间 $n$）**：$u_P^{n} = 1.0\\ \\mathrm{m/s}$。\n- **总源项**：$b_P = 0.4\\ \\mathrm{N}$。\n- **压力梯度（时间 $n$）**：$\\left(\\frac{\\partial p}{\\partial x}\\right)^{n} = 1.5 \\times 10^{3}\\ \\mathrm{Pa/m}$。\n- **外推压力梯度（$n+1$ 的估计值）**：$\\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} = 9.0 \\times 10^{2}\\ \\mathrm{Pa/m}$。\n\n**第 2 步：使用提取的给定条件进行验证**\n该问题具有科学依据，描述了计算流体动力学中的一个标准数值程序 (PISO)。问题提法恰当，提供了构建和求解离散方程所需的所有数据。术语精确客观。所提供的数值和单位在物理上是一致的，对于微尺度或细网格模拟是合理的。问题结构清晰，不包含任何矛盾、歧义或逻辑缺陷。\n\n**第 3 步：结论和行动**\n该问题被判定为**有效**。将提供解答。\n\n**离散预测方程的推导**\n控制体 $V_P$ 上的 $x$ 动量方程的积分形式为：\n$$ \\frac{\\partial}{\\partial t}\\int_{V_P} \\rho u \\,dV + \\int_{\\partial V_P} \\rho u (\\mathbf{v} \\cdot \\mathbf{n}) \\,dS = \\int_{\\partial V_P} \\mu \\frac{\\partial u}{\\partial n} \\, dS - \\int_{V_P} \\frac{\\partial p}{\\partial x} \\, dV + \\int_{V_P} S_u \\,dV $$\n我们对动量预测步使用半隐式方法离散该方程。时间导数使用一阶欧拉格式近似。对流项和扩散项被线性化，在预测步中，相邻单元速度的影响使用时间层 $n$ 的值进行显式处理，而单元自身的速度 $u_P^*$ 则进行隐式处理。这使得每个单元的方程组解耦。单元面上的对流和扩散通量的贡献被线性化为给定的相邻系数 $a_{nb}$。\n\n预测速度 $u_P^*$ 的离散动量方程形式如下：\n$$ \\frac{\\rho_P V_P (u_P^* - u_P^n)}{\\Delta t} + \\mathcal{L}(u) = -V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\n其中 $\\mathcal{L}(u)$ 表示净对流-扩散算子。它被线性化，使得对角贡献是隐式的，非对角贡献是显式的：\n$$ \\mathcal{L}(u) \\approx \\left(\\sum_{nb} a_{nb}\\right) u_P^* - \\sum_{nb} a_{nb} u_{nb}^n $$\n这里，$\\sum_{nb} a_{nb}$ 对应于相邻单元 $nb \\in \\{E, W, N, S\\}$ 的相邻系数之和。这是一种为保证稳定性而采用的标准线性化方法。将此代入时间离散方程中：\n$$ \\frac{\\rho_P V_P}{\\Delta t} (u_P^* - u_P^n) + \\left(\\sum_{nb} a_{nb}\\right) u_P^* - \\sum_{nb} a_{nb} u_{nb}^n = -V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\n重新整理方程，将乘以未知数 $u_P^*$ 的项组合到左侧，得到标准形式 $a_P u_P^* = \\text{RHS}$：\n$$ \\left( \\frac{\\rho_P V_P}{\\Delta t} + \\sum_{nb} a_{nb} \\right) u_P^* = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right) + b_P $$\n这就是 $u_P^*$ 的离散预测方程。\n\n**1. 对角系数 $a_P$ 的计算**\n从推导出的方程可知，对角系数 $a_P$ 是乘以 $u_P^*$ 的项：\n$$ a_P = \\frac{\\rho_P V_P}{\\Delta t} + \\sum_{nb} a_{nb} $$\n首先，我们计算相邻系数之和：\n$$ \\sum_{nb} a_{nb} = a_E + a_W + a_N + a_S = 2.5 + 1.5 + 1.0 + 0.8 = 5.8\\ \\mathrm{kg/s} $$\n接下来，我们计算瞬态项系数：\n$$ \\frac{\\rho_P V_P}{\\Delta t} = \\frac{(1.0\\ \\mathrm{kg/m}^3)(8.0 \\times 10^{-6}\\ \\mathrm{m}^3)}{1.0 \\times 10^{-5}\\ \\mathrm{s}} = 0.8\\ \\mathrm{kg/s} $$\n因此，对角系数 $a_P$ 为：\n$$ a_P = 0.8\\ \\mathrm{kg/s} + 5.8\\ \\mathrm{kg/s} = 6.6\\ \\mathrm{kg/s} $$\n\n**2. 压力显式预测速度 $u_P^{*,\\mathrm{exp}}$ 的计算**\n对于压力显式预测，我们使用时间层 $n$ 的压力梯度 $\\left(\\frac{\\partial p}{\\partial x}\\right)^n$。预测方程的右侧（RHS）为：\n$$ \\text{RHS}_{\\mathrm{exp}} = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^n + b_P $$\n我们计算每一项：\n$$ \\sum_{nb} a_{nb} u_{nb}^n = (2.5)(3.0) + (1.5)(1.5) + (1.0)(0.5) + (0.8)(0.2) = 7.5 + 2.25 + 0.5 + 0.16 = 10.41\\ \\mathrm{N} $$\n$$ \\frac{\\rho_P V_P}{\\Delta t} u_P^n = (0.8\\ \\mathrm{kg/s})(1.0\\ \\mathrm{m/s}) = 0.8\\ \\mathrm{N} $$\n$$ V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^n = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3)(1.5 \\times 10^{3}\\ \\mathrm{Pa/m}) = 12.0 \\times 10^{-3}\\ \\mathrm{N} = 0.012\\ \\mathrm{N} $$\n源项给定为 $b_P = 0.4\\ \\mathrm{N}$。\n将这些贡献相加得到 RHS：\n$$ \\text{RHS}_{\\mathrm{exp}} = 10.41 + 0.8 - 0.012 + 0.4 = 11.598\\ \\mathrm{N} $$\n那么预测速度为：\n$$ u_P^{*,\\mathrm{exp}} = \\frac{\\text{RHS}_{\\mathrm{exp}}}{a_P} = \\frac{11.598\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} \\approx 1.75727\\ \\mathrm{m/s} $$\n\n**3. 压力隐式预测速度 $u_P^{*,\\mathrm{imp}}$ 的计算**\n对于压力隐式预测，我们使用外推的压力梯度估计值 $\\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}}$。RHS 为：\n$$ \\text{RHS}_{\\mathrm{imp}} = \\sum_{nb} a_{nb} u_{nb}^n + \\frac{\\rho_P V_P}{\\Delta t} u_P^n - V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} + b_P $$\n唯一改变的项是压力项：\n$$ V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3)(9.0 \\times 10^{2}\\ \\mathrm{Pa/m}) = 7.2 \\times 10^{-3}\\ \\mathrm{N} = 0.0072\\ \\mathrm{N} $$\n隐式情况下的 RHS 为：\n$$ \\text{RHS}_{\\mathrm{imp}} = 10.41 + 0.8 - 0.0072 + 0.4 = 11.6028\\ \\mathrm{N} $$\n预测速度为：\n$$ u_P^{*,\\mathrm{imp}} = \\frac{\\text{RHS}_{\\mathrm{imp}}}{a_P} = \\frac{11.6028\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} = 1.758\\ \\mathrm{m/s} $$\n\n**4. 差值绝对值 $|u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}}|$ 的计算**\n预测速度的差异可以直接从 RHS 项的差异计算得出，因为 $a_P$ 在两个计算中是公共的：\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} = \\frac{\\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}}}{a_P} $$\nRHS 的差异完全由压力梯度项引起：\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = \\left(-V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}}\\right) - \\left(-V_P \\left(\\frac{\\partial p}{\\partial x}\\right)^{n}\\right) $$\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = V_P \\left[ \\left(\\frac{\\partial p}{\\partial x}\\right)^{n} - \\left(\\frac{\\partial p}{\\partial x}\\right)^{n+1,\\mathrm{est}} \\right] $$\n代入数值：\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = (8.0 \\times 10^{-6}\\ \\mathrm{m}^3) [1.5 \\times 10^{3} - 9.0 \\times 10^{2}] \\mathrm{Pa/m} $$\n$$ \\text{RHS}_{\\mathrm{imp}} - \\text{RHS}_{\\mathrm{exp}} = (8.0 \\times 10^{-6})(600)\\ \\mathrm{N} = 4.8 \\times 10^{-3}\\ \\mathrm{N} $$\n现在，我们计算速度差：\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} = \\frac{4.8 \\times 10^{-3}\\ \\mathrm{N}}{6.6\\ \\mathrm{kg/s}} = \\frac{4.8}{6.6} \\times 10^{-3}\\ \\mathrm{m/s} = \\frac{8}{11} \\times 10^{-3}\\ \\mathrm{m/s} $$\n$$ u_P^{*,\\mathrm{imp}} - u_P^{*,\\mathrm{exp}} \\approx 0.00072727... \\ \\mathrm{m/s} $$\n其绝对值为 $|0.00072727...| = 0.00072727... \\ \\mathrm{m/s}$。\n四舍五入到四位有效数字，我们得到 $0.0007273\\ \\mathrm{m/s}$。这可以用科学记数法表示为 $7.273 \\times 10^{-4}\\ \\mathrm{m/s}$。",
            "answer": "$$\\boxed{7.273 \\times 10^{-4}}$$"
        },
        {
            "introduction": "在预测步骤之后，我们得到了一个通常不满足连续性方程的速度场。PISO算法的核心在于校正这一速度场，使其满足质量守恒。这个练习聚焦于校正步骤，你将学习如何利用已知的压力校正场和耦合系数来计算最终的、满足离散连续性方程的面通量。通过这个实践，你将掌握压力-速度耦合机制的精髓，这是所有基于压力的求解器的基石。",
            "id": "4050269",
            "problem": "在一个瞬态、低马赫数的反应流中，一个六面体控制体通过算子分裂压力隐式 (PISO) 算法进行推进。面法向体积通量是相对于指向外部的面法线定义的，并用 $\\phi_{f}$ 表示，其中 $f \\in \\{W, E, S, N, B, T\\}$ 分别对应西、东、南、北、底、顶六个面。在某次子迭代中，通过动量预测步得到了一个预测的（非无散）通量场 $\\phi_{f}^{*}$。控制体上的离散连续性方程要求修正后的通量满足\n$$\\sum_{f} \\phi_{f} = 0.$$\n一个压力修正场 $p'$ 在主单元 $P$ 的中心以及其六个面相邻单元的中心处是已知的。假设每个面上的线性化压力-速度耦合由一个已知的正常数 $D_{f}$ 来表征，使得压力修正引起的面法向通量修正是与穿过该面的相邻单元和主单元之间的压力差成线性比例的。所有量都处于相同的算法时间层级。\n\n数据：\n- 预测的向外体积通量（单位 m$^3$/s）：$\\phi_{W}^{*} = -1.000 \\times 10^{-5}$，$\\phi_{E}^{*} = 8.000 \\times 10^{-6}$，$\\phi_{S}^{*} = 6.000 \\times 10^{-6}$，$\\phi_{N}^{*} = 5.000 \\times 10^{-6}$，$\\phi_{B}^{*} = -2.500 \\times 10^{-6}$，$\\phi_{T}^{*} = -4.000 \\times 10^{-6}$。\n- 单元中心的压力修正（单位 Pa）：$p'_{P} = 0$，$p'_{W} = -1$，$p'_{E} = 2$，$p'_{S} = 3$，$p'_{N} = 1$，$p'_{B} = 0.5$，$p'_{T} = -2$。\n- 面耦合系数（单位 m$^3$/s/Pa）：$D_{W} = 2.000 \\times 10^{-6}$，$D_{E} = 1.000 \\times 10^{-6}$，$D_{S} = 5.000 \\times 10^{-7}$，$D_{N} = 1.500 \\times 10^{-6}$，$D_{B} = 3.000 \\times 10^{-6}$，$D_{T} = 1.000 \\times 10^{-6}$。\n\n使用有限体积法的基本原理以及 PISO 算法中的压力-速度耦合，推导面通量修正量关于 $p'$ 和 $D_{f}$ 的表达式，该表达式能使控制体的离散连续性方程残差为零。然后计算修正后的向外体积通量 $\\phi_{f}$（对于 $f \\in \\{W, E, S, N, B, T\\}$），使其精确满足 $\\sum_{f} \\phi_{f} = 0$。\n\n将您的最终答案表示为一个单行矩阵，按 $[W, E, S, N, B, T]$ 的面顺序排列，单位为 m$^3$/s。将每个条目四舍五入到四位有效数字。本题不涉及角度。",
            "solution": "我们从控制体（体积为 $V$）上连续性方程的有限体积离散化开始，其中面法线指向外部：\n$$\\int_{V} \\nabla \\cdot \\mathbf{u} \\, dV = \\sum_{f} \\int_{A_{f}} \\mathbf{u} \\cdot \\mathbf{n}_{f} \\, dA \\approx \\sum_{f} \\phi_{f} = 0,$$\n其中 $\\phi_{f}$ 表示通过面 $f$ 的向外体积通量。在算子分裂压力隐式 (PISO) 算法的预测-修正步中，首先使用已知的压力（或类压力）场从动量方程预测速度（以及相应的面通量），得到一个预测通量 $\\phi_{f}^{*}$，该通量通常不满足离散连续性方程。然后引入一个压力修正量 $p'$ 来调整速度和通量，使得修正后的通量 $\\phi_{f} = \\phi_{f}^{*} + \\Delta \\phi_{f}$ 满足\n$$\\sum_{f} \\phi_{f} = \\sum_{f} \\left( \\phi_{f}^{*} + \\Delta \\phi_{f} \\right) = 0.$$\n\n为了将 $\\Delta \\phi_{f}$ 与压力修正量 $p'$ 联系起来，我们从预测步中使用的线性化半离散动量方程开始：\n$$a_{P} \\mathbf{u}_{P}^{*} = \\mathbf{H}_{P} - \\nabla p^{n},$$\n其中 $a_{P} > 0$ 是瞬态项和扩散项离散化后得到的对角系数，$\\mathbf{H}_{P}$ 包含了已知的显式贡献项，$p^{n}$ 是前一迭代/时间步的已知压力。修正步引入 $\\mathbf{u} = \\mathbf{u}^{*} + \\mathbf{u}'$ 和压力修正量 $p'$，使得修正后的动量平衡方程为\n$$a_{P} \\mathbf{u}_{P} = \\mathbf{H}_{P} - \\nabla (p^{n} + p').$$\n从修正后的方程中减去预测方程，得到速度修正关系\n$$a_{P} \\mathbf{u}'_{P} = - \\nabla p'.$$\n假设将 $a_{P}^{-1}$ 从相邻单元中心到面进行标准线性插值，并在面 $f$ 处沿连接主单元 $P$ 和相邻单元 $N(f)$ 的连线使用中心差分计算法向压力梯度，则速度修正量的面法向分量导致体积通量修正的形式为\n$$\\Delta \\phi_{f} \\equiv \\left( \\mathbf{u}' \\cdot \\mathbf{n}_{f} \\right) A_{f} = - D_{f} \\left( p'_{N(f)} - p'_{P} \\right),$$\n其中 $D_{f} > 0$ 是给定的面压力-速度耦合系数，它由 $a_{P}^{-1}$ 的插值、面面积大小 $A_{f} = |\\mathbf{S}_{f}|$ 以及主单元-相邻单元法向距离的倒数共同决定。符号约定与指向外部的面法线一致；具体来说，一个正的 $(p'_{N(f)} - p'_{P})$ 会引起一个负的向外修正量 $\\Delta \\phi_{f}$，从而减小散度。\n\n因此，每个面上修正后的向外通量为\n$$\\phi_{f} = \\phi_{f}^{*} - D_{f} \\left( p'_{N(f)} - p'_{P} \\right).$$\n\n现在我们使用所提供的数据计算每个面所需的压力差和修正量。主单元的压力修正量为 $p'_{P} = 0$。相邻单元的修正量为 $p'_{W} = -1$，$p'_{E} = 2$，$p'_{S} = 3$，$p'_{N} = 1$，$p'_{B} = 0.5$，$p'_{T} = -2$，单位均为 Pa。面系数 $D_{f}$ 的单位为 m$^3$/s/Pa。\n\n计算压力差 $\\Delta p'_{f} \\equiv p'_{N(f)} - p'_{P}$：\n- 西面：$\\Delta p'_{W} = p'_{W} - p'_{P} = -1 - 0 = -1$。\n- 东面：$\\Delta p'_{E} = p'_{E} - p'_{P} = 2 - 0 = 2$。\n- 南面：$\\Delta p'_{S} = p'_{S} - p'_{P} = 3 - 0 = 3$。\n- 北面：$\\Delta p'_{N} = p'_{N} - p'_{P} = 1 - 0 = 1$。\n- 底面：$\\Delta p'_{B} = p'_{B} - p'_{P} = 0.5 - 0 = 0.5$。\n- 顶面：$\\Delta p'_{T} = p'_{T} - p'_{P} = -2 - 0 = -2$。\n\n计算通量修正量 $\\Delta \\phi_{f} = - D_{f} \\, \\Delta p'_{f}$ （单位 m$^3$/s）：\n- 西面：$\\Delta \\phi_{W} = - (2.000 \\times 10^{-6}) \\times (-1) = +2.000 \\times 10^{-6}$。\n- 东面：$\\Delta \\phi_{E} = - (1.000 \\times 10^{-6}) \\times (2) = -2.000 \\times 10^{-6}$。\n- 南面：$\\Delta \\phi_{S} = - (5.000 \\times 10^{-7}) \\times (3) = -1.500 \\times 10^{-6}$。\n- 北面：$\\Delta \\phi_{N} = - (1.500 \\times 10^{-6}) \\times (1) = -1.500 \\times 10^{-6}$。\n- 底面：$\\Delta \\phi_{B} = - (3.000 \\times 10^{-6}) \\times (0.5) = -1.500 \\times 10^{-6}$。\n- 顶面：$\\Delta \\phi_{T} = - (1.000 \\times 10^{-6}) \\times (-2) = +2.000 \\times 10^{-6}$。\n\n计算修正后的通量 $\\phi_{f} = \\phi_{f}^{*} + \\Delta \\phi_{f}$：\n- 西面：$\\phi_{W} = (-1.000 \\times 10^{-5}) + (2.000 \\times 10^{-6}) = -8.000 \\times 10^{-6}$ m$^3$/s。\n- 东面：$\\phi_{E} = (8.000 \\times 10^{-6}) + (-2.000 \\times 10^{-6}) = 6.000 \\times 10^{-6}$ m$^3$/s。\n- 南面：$\\phi_{S} = (6.000 \\times 10^{-6}) + (-1.500 \\times 10^{-6}) = 4.500 \\times 10^{-6}$ m$^3$/s。\n- 北面：$\\phi_{N} = (5.000 \\times 10^{-6}) + (-1.500 \\times 10^{-6}) = 3.500 \\times 10^{-6}$ m$^3$/s。\n- 底面：$\\phi_{B} = (-2.500 \\times 10^{-6}) + (-1.500 \\times 10^{-6}) = -4.000 \\times 10^{-6}$ m$^3$/s。\n- 顶面：$\\phi_{T} = (-4.000 \\times 10^{-6}) + (2.000 \\times 10^{-6}) = -2.000 \\times 10^{-6}$ m$^3$/s。\n\n离散连续性方程验证：\n$$\\sum_{f} \\phi_{f} = (-8.000 + 6.000 + 4.500 + 3.500 - 4.000 - 2.000) \\times 10^{-6} = 0,$$\n符合要求。\n\n因此，按 $[W, E, S, N, B, T]$ 顺序排列的修正后向外面通量矢量为\n$$\\left( -8.000 \\times 10^{-6}, \\; 6.000 \\times 10^{-6}, \\; 4.500 \\times 10^{-6}, \\; 3.500 \\times 10^{-6}, \\; -4.000 \\times 10^{-6}, \\; -2.000 \\times 10^{-6} \\right) \\text{ m}^3\\text{/s}.$$\n\n四舍五入到四位有效数字后，这些值已经符合要求的格式。",
            "answer": "$$\\boxed{\\begin{pmatrix}-8.000 \\times 10^{-6} & 6.000 \\times 10^{-6} & 4.500 \\times 10^{-6} & 3.500 \\times 10^{-6} & -4.000 \\times 10^{-6} & -2.000 \\times 10^{-6}\\end{pmatrix}}$$"
        },
        {
            "introduction": "对于反应流，PISO算法中的速度散度项 $\\nabla \\cdot \\mathbf{u}$ 具有深刻的物理意义，它直接关联于燃烧过程中的热膨胀。本练习将理论与物理现象相结合，要求你从基本的热力学定律和火焰结构出发，推导并估算火焰面上的速度散度。这有助于你理解PISO算法如何通过其散度约束来精确捕捉反应流中由化学反应引起的重要物理效应。",
            "id": "4050302",
            "problem": "考虑一个一维、平面、化学计量的甲烷-空气层流小火焰，它嵌入在一个使用压力隐式算子分裂 (Pressure-Implicit with Splitting of Operators, PISO) 算法的低马赫数瞬态求解器中。流动被视为准等压流动。上游未燃混合物的温度为 $T_{u} = 300\\,\\mathrm{K}$，压力为 $p_{0} = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$。在未燃和已燃气体中，混合气体常数均近似为常数，等于 $\\bar{R} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。已燃气体温度为 $T_{b} = 1800\\,\\mathrm{K}$。层流燃烧速度为 $S_{L} = 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，反应区的热厚度为 $\\delta_{L} = 0.45\\,\\mathrm{mm}$。假设：\n- 理想气体行为和火焰面上的空间均匀压力 ($p \\approx p_{0}$)。\n- 在火焰固定坐标系中，火焰呈稳态一维分布，因此质量通量 $m = \\rho u$ 为常数，且等于 $\\rho_{u} S_{L}$，其中 $\\rho_{u}$ 是上游密度。\n- 在厚度为 $\\delta_{L}$ 的反应区内，由于热膨胀，流向速度从上游速度 $U_{u}$ 近似线性变化到下游速度 $U_{b}$。\n\n任务：\n1. 从变密度连续性方程和理想气体定律出发，并利用准等压假设，推导 PISO 算法对低马赫数反应流中修正速度场施加的散度约束。用物质导数和热力学变量表示该约束。\n2. 使用理想气体定律，计算上游和已燃气体的密度 $\\rho_{u}$ 和 $\\rho_{b}$ 以及膨胀因子 $E = \\rho_{u}/\\rho_{b}$。\n3. 对稳态一维小火焰使用质量守恒，确定 $U_{u}$ 和 $U_{b}$，并以恒定梯度 $\\nabla \\cdot \\mathbf{u} \\approx (U_{b} - U_{u})/\\delta_{L}$ 估算整个反应区的散度。说明预期的符号并计算其大小。\n4. 通过证明在给定假设下表达式的等价性，验证您的估算与任务1中推导的散度约束是一致的。\n\n将最终数值答案四舍五入至 $3$ 位有效数字。以 $\\mathrm{s}^{-1}$ 为单位表示最终结果。",
            "solution": "该问题陈述经评估具有科学依据、问题适定、客观且内容完整。它提出了计算燃烧理论中的一个标准问题，为层流小火焰模型提供了清晰的定义、一致的数据和物理上现实的假设。满足了有效问题的所有标准。\n\n**任务1：散度约束的推导**\n\n出发点是可压缩流体的连续性方程：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度矢量。对散度项使用乘积法则，可展开为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\rho + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n前两项代表密度的物质导数 $\\frac{D\\rho}{Dt}$：\n$$\n\\frac{D\\rho}{Dt} + \\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n该方程可以重新排列，以跟随流体质点的密度变化来明确表示速度散度：\n$$\n\\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho} \\frac{D\\rho}{Dt}\n$$\n为了用热力学变量表示，我们使用给定的理想气体定律 $p = \\rho \\bar{R} T$，其中 $p$ 是压力，$T$ 是温度，$\\bar{R}$ 是比气体常数。问题陈述流动是准等压的，意味着压力在空间上是均匀的，$p(\\mathbf{x}, t) \\approx p_0(t)$，但在瞬态情况下可以随时间缓慢变化。因此，$\\rho = \\frac{p_0(t)}{\\bar{R} T}$。\n\n为了将密度的物质导数与压力和温度的物质导数联系起来，处理状态方程的对数形式会很方便：\n$$\n\\ln(\\rho) = \\ln(p) - \\ln(\\bar{R}) - \\ln(T)\n$$\n对该表达式求物质导数（注意 $\\bar{R}$ 是常数）：\n$$\n\\frac{D}{Dt}(\\ln \\rho) = \\frac{D}{Dt}(\\ln p) - \\frac{D}{Dt}(\\ln T)\n$$\n这等价于：\n$$\n\\frac{1}{\\rho} \\frac{D\\rho}{Dt} = \\frac{1}{p} \\frac{Dp}{Dt} - \\frac{1}{T} \\frac{DT}{Dt}\n$$\n将此代回速度散度的表达式，得到所需的约束条件：\n$$\n\\nabla \\cdot \\mathbf{u} = - \\left( \\frac{1}{p} \\frac{Dp}{Dt} - \\frac{1}{T} \\frac{DT}{Dt} \\right) = \\frac{1}{T} \\frac{DT}{Dt} - \\frac{1}{p} \\frac{Dp}{Dt}\n$$\n这就是 PISO 算法必须对修正后的速度场施加的散度约束。它将流动的运动学（$\\nabla \\cdot \\mathbf{u}$）与沿流体质点路径的热力学变化（$\\frac{DT}{Dt}$，$\\frac{Dp}{Dt}$）联系起来。\n\n**任务2：密度和膨胀因子的计算**\n\n上游未燃气体密度 $\\rho_u$ 和下游已燃气体密度 $\\rho_b$ 是在均匀压力 $p = p_0 = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$ 的假设下，使用理想气体定律 $p = \\rho \\bar{R} T$ 计算的。\n\n给定值：\n$p_0 = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$\n$\\bar{R} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n$T_u = 300\\,\\mathrm{K}$\n$T_b = 1800\\,\\mathrm{K}$\n\n上游密度：\n$$\n\\rho_u = \\frac{p_0}{\\bar{R} T_u} = \\frac{1.013 \\times 10^{5}\\,\\mathrm{Pa}}{(287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})(300\\,\\mathrm{K})} \\approx 1.1765\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\n下游密度：\n$$\n\\rho_b = \\frac{p_0}{\\bar{R} T_b} = \\frac{1.013 \\times 10^{5}\\,\\mathrm{Pa}}{(287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1})(1800\\,\\mathrm{K})} \\approx 0.19609\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\n膨胀因子 $E$ 是未燃气体与已燃气体的密度之比：\n$$\nE = \\frac{\\rho_u}{\\rho_b} = \\frac{p_0 / (\\bar{R} T_u)}{p_0 / (\\bar{R} T_b)} = \\frac{T_b}{T_u} = \\frac{1800\\,\\mathrm{K}}{300\\,\\mathrm{K}} = 6\n$$\n\n**任务3：速度和散度估算的计算**\n\n问题指定了在火焰固定参考系中的稳态一维小火焰。层流燃烧速度 $S_L$ 是未燃混合物进入火焰前锋的速度。因此，上游速度 $U_u$ 等于 $S_L$。\n$$\nU_u = S_L = 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n稳态火焰的质量守恒定律规定质量通量 $m = \\rho u$ 是恒定的：\n$$\n\\rho_u U_u = \\rho_b U_b\n$$\n下游速度 $U_b$ 可计算如下：\n$$\nU_b = \\frac{\\rho_u}{\\rho_b} U_u = E \\cdot U_u = 6 \\times 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 2.28\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n在一维情况下，速度散度 $\\nabla \\cdot \\mathbf{u}$ 为 $\\frac{du}{dx}$。问题要求将其估算为跨越厚度为 $\\delta_L = 0.45\\,\\mathrm{mm} = 0.45 \\times 10^{-3}\\,\\mathrm{m}$ 的反应区的恒定梯度。\n$$\n\\nabla \\cdot \\mathbf{u} \\approx \\frac{U_b - U_u}{\\delta_L}\n$$\n由于 $U_b > U_u$，散度为正，这是由于气体燃烧时热膨胀所预期的。其大小为：\n$$\n\\nabla \\cdot \\mathbf{u} \\approx \\frac{2.28\\,\\mathrm{m}\\,\\mathrm{s}^{-1} - 0.38\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.45 \\times 10^{-3}\\,\\mathrm{m}} = \\frac{1.90}{0.45 \\times 10^{-3}}\\,\\mathrm{s}^{-1} \\approx 4222.2\\,\\mathrm{s}^{-1}\n$$\n四舍五入到三位有效数字，估算的散度为 $4.22 \\times 10^{3}\\,\\mathrm{s}^{-1}$。\n\n**任务4：一致性验证**\n\n我们必须验证，在问题对稳态小火焰的假设下，任务3中的估算值 $\\frac{U_b - U_u}{\\delta_L}$ 与任务1中的散度约束是一致的。\n\n对于稳态（$\\frac{\\partial}{\\partial t} = 0$）、一维（$\\nabla \\rightarrow \\frac{d}{dx}$，$ \\mathbf{u} \\rightarrow u$）、等压（$\\frac{Dp}{Dt} = u \\frac{dp}{dx} = 0$）流动，物质导数变为 $\\frac{D}{Dt} = u \\frac{d}{dx}$。任务1中的散度约束简化为：\n$$\n\\frac{du}{dx} = \\frac{1}{T} \\left( u \\frac{dT}{dx} \\right) \\implies \\frac{1}{u}\\frac{du}{dx} = \\frac{1}{T}\\frac{dT}{dx}\n$$\n这是一个关联速度和温度分布的微分方程。将其从火焰的未燃侧（$u=U_u, T=T_u$）积分到已燃侧（$u=U_b, T=T_b$）得到：\n$$\n\\int_{U_u}^{U_b} \\frac{1}{u} du = \\int_{T_u}^{T_b} \\frac{1}{T} dT \\implies \\ln\\left(\\frac{U_b}{U_u}\\right) = \\ln\\left(\\frac{T_b}{T_u}\\right) \\implies \\frac{U_b}{U_u} = \\frac{T_b}{T_u}\n$$\n这与我们在任务2和3中从质量守恒和理想气体定律得到的结果是一致的。\n\n现在，我们使用附加假设，即在反应区内 $x \\in [0, \\delta_L]$，速度分布是线性的：\n$$\nu(x) = U_u + (U_b - U_u) \\frac{x}{\\delta_L}\n$$\n在此假设下，整个反应区的速度散度是恒定的：\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{du}{dx} = \\frac{U_b - U_u}{\\delta_L}\n$$\n这意味着任务3的“估算值”在线性速度分布假设下是精确的散度。我们现在必须证明任务1的表达式给出了相同的结果。\n从积分关系 $\\frac{u(x)}{U_u} = \\frac{T(x)}{T_u}$，我们可以找到由线性速度分布所蕴含的温度分布：\n$$\nT(x) = T_u \\frac{u(x)}{U_u} = T_u \\left( 1 + \\frac{U_b - U_u}{U_u} \\frac{x}{\\delta_L} \\right)\n$$\n因此，温度梯度也是恒定的：\n$$\n\\frac{dT}{dx} = T_u \\frac{U_b - U_u}{U_u \\delta_L}\n$$\n现在，将这些分布代入任务1的局部散度表达式 $\\frac{u}{T}\\frac{dT}{dx}$：\n$$\n\\frac{u(x)}{T(x)} \\frac{dT}{dx} = \\frac{u(x)}{T_u \\frac{u(x)}{U_u}} \\left( T_u \\frac{U_b - U_u}{U_u \\delta_L} \\right)\n$$\n$u(x)$、$T_u$ 和 $U_u$ 项相互抵消：\n$$\n\\frac{u(x)}{T(x)} \\frac{dT}{dx} = \\frac{U_u}{T_u} \\left( \\frac{T_u}{U_u} \\frac{U_b - U_u}{\\delta_L} \\right) = \\frac{U_b - U_u}{\\delta_L}\n$$\n这个结果与从线性速度分布计算出的恒定梯度是相同的。因此，任务3的估算值不仅仅是一个近似值，而是在问题给定的特定假设下，与任务1的基本散度约束完全一致且数学上等价。因此，计算值得到了验证。\n任务3的最终数值结果，四舍五入到3位有效数字：\n$$\n\\frac{1.90}{0.45 \\times 10^{-3}} \\,\\mathrm{s}^{-1} \\approx 4220 \\,\\mathrm{s}^{-1} = 4.22 \\times 10^3 \\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\\boxed{4.22 \\times 10^{3}}$$"
        }
    ]
}