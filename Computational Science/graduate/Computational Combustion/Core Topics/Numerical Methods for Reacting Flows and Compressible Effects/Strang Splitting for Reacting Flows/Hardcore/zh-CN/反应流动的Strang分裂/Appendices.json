{
    "hands_on_practices": [
        {
            "introduction": "算子分裂方法所产生的误差根源在于系统各部分（如对流、扩散、反应）的控制算子不可交换。本练习旨在探索一种理想情况：当对流、扩散和反应算子确实可以交换时会发生什么 。通过证明在此条件下，一阶的Lie-Trotter分裂和二阶的Strang分裂都变得精确且结果完全相同，我们将为理解分裂误差的本质建立坚实的直观基础。",
            "id": "4068681",
            "problem": "考虑一个定义在周期性域 $x \\in [0,L]$ 上的无量纲标量质量分数 $c(x,t)$ 的一维平流—扩散—反应系统，该系统由以下线性偏微分方程（PDE）控制：\n$$\n\\frac{\\partial c}{\\partial t} = \\mathcal{A} c + \\mathcal{D} c + \\mathcal{R} c,\n$$\n其中 $\\mathcal{A} := -a \\frac{\\partial}{\\partial x}$ 是平流速度为 $a$（单位：米/秒）的常系数平流算子，$\\mathcal{D} := D \\frac{\\partial^2}{\\partial x^2}$ 是扩散系数为 $D$（单位：平方米/秒）的常系数扩散算子，而 $\\mathcal{R} := r I$ 是反应速率为 $r$（单位：1/秒）的线性反应算子，$I$ 为单位算子。令 $(\\cdot,\\cdot)$ 表示在一个周期上的 $L^2$ 内积，并假设采用周期性边界条件。\n\n定义两个线性算子 $\\mathcal{X}$ 和 $\\mathcal{Y}$ 之间的李括号为 $[\\mathcal{X},\\mathcal{Y}] := \\mathcal{X}\\mathcal{Y} - \\mathcal{Y}\\mathcal{X}$。Strang 分裂法通过以下对称组合将时间从 $t$ 推进到 $t+\\Delta t$：\n$$\nS_{\\Delta t} := e^{\\frac{\\Delta t}{2} \\mathcal{A}} \\, e^{\\frac{\\Delta t}{2} \\mathcal{D}} \\, e^{\\Delta t \\mathcal{R}} \\, e^{\\frac{\\Delta t}{2} \\mathcal{D}} \\, e^{\\frac{\\Delta t}{2} \\mathcal{A}},\n$$\n而 Lie–Trotter 分裂法使用以下一阶组合：\n$$\nT_{\\Delta t} := e^{\\Delta t \\mathcal{A}} \\, e^{\\Delta t \\mathcal{D}} \\, e^{\\Delta t \\mathcal{R}}.\n$$\n从微积分和傅里叶分析的基本原理出发，推导在此设定下使得 $[\\mathcal{A},\\mathcal{D}]=0$、$[\\mathcal{A},\\mathcal{R}]=0$ 和 $[\\mathcal{D},\\mathcal{R}]=0$ 成立的充要条件。然后证明，在这些条件下，对于任何 $\\Delta t > 0$，算子 $S_{\\Delta t}$ 和 $T_{\\Delta t}$ 均产生相同的更新，即 $S_{\\Delta t} = T_{\\Delta t} = e^{\\Delta t (\\mathcal{A}+\\mathcal{D}+\\mathcal{R})}$。\n\n编写一个完整、可运行的程序，使用基于快速傅里叶变换（FFT）的谱方法，对一个简单的平流—扩散—反应（ADR）系统数值验证上述等式。使用一个由 $N$ 个等距点离散化的周期性域 $x \\in [0,L]$，以及以下初始条件：\n$$\nc(x,0) = \\sin\\!\\Big(\\frac{2\\pi p}{L} x\\Big) + \\frac{1}{2}\\cos\\!\\Big(\\frac{2\\pi q}{L} x\\Big),\n$$\n其中 $p$ 和 $q$ 是正整数。使用精确子流实现 Strang 分裂法和 Lie–Trotter 分裂法：\n- 平流：在傅里叶空间中，每个波数为 $k$ 的模态乘以 $e^{-i a k \\Delta t}$，这等效于空间位移 $a \\Delta t$。\n- 扩散：在傅里叶空间中，每个波数为 $k$ 的模态乘以 $e^{-D k^2 \\Delta t}$。\n- 反应：在物理空间中，$c$ 的每个点乘以 $e^{r \\Delta t}$。\n\n对于每个测试用例，使用均匀时间步长 $\\Delta t$（其中 $T / \\Delta t$ 为整数）将系统从 $t=0$ 演化到 $t=T$，并报告在时间 $T$ 时 Strang 解和 Lie–Trotter 解之间的均方根（RMS）误差。\n$$\n\\mathrm{RMS} := \\sqrt{\\frac{1}{N}\\sum_{j=0}^{N-1} \\left(c_{\\text{Strang}}(x_j,T) - c_{\\text{Trotter}}(x_j,T)\\right)^2}.\n$$\n由于 $c$ 是无量纲的，RMS 也是一个无量纲量。\n\n你的程序必须实现以下测试套件，每个测试用例指定为一个元组 $(L, N, \\Delta t, T, a, D, r, p, q)$：\n\n- 情况1（一般对易的ADR）：$(2\\pi, 256, 0.005, 0.5, 1.2, 0.03, -1.0, 3, 5)$。\n- 情况2（纯反应）：$(2\\pi, 128, 0.010, 0.5, 0.0, 0.0, 0.7, 4, 7)$。\n- 情况3（纯扩散）：$(2\\pi, 128, 0.020, 0.4, 0.0, 0.2, 0.0, 2, 6)$。\n- 情况4（纯平流）：$(2\\pi, 256, 0.003, 0.3, 2.0, 0.0, 0.0, 5, 8)$。\n- 情况5（不同尺度的混合ADR）：$(2\\pi, 192, 0.004, 0.52, 0.9, 0.05, -0.5, 7, 2)$。\n\n你的程序应生成单行输出，其中包含五个测试用例的 RMS 误差，形式为一个由方括号括起来的逗号分隔列表（例如 $[d_1,d_2,d_3,d_4,d_5]$），其中每个 $d_i$ 是一个浮点数。不应打印任何额外文本。由于该输出是无量纲的，因此没有物理单位。",
            "solution": "该问题要求分两部分作答：首先，理论推导平流、扩散和反应算子对易的条件，并在此条件下证明 Strang 分裂法和 Lie-Trotter 分裂法的等价性；其次，编写一个数值程序来验证这种等价性。\n\n**理论推导**\n\n控制该系统的偏微分方程（PDE）如下：\n$$\n\\frac{\\partial c}{\\partial t} = \\mathcal{A} c + \\mathcal{D} c + \\mathcal{R} c\n$$\n定义在周期性域 $x \\in [0,L]$ 上，其中 $c(x,t)$ 是一个无量纲标量。线性算子以常系数定义如下：\n- 平流算子：$\\mathcal{A} := -a \\frac{\\partial}{\\partial x}$\n- 扩散算子：$\\mathcal{D} := D \\frac{\\partial^2}{\\partial x^2}$\n- 反应算子：$\\mathcal{R} := r I$（其中 $I$ 是单位算子）\n\n我们寻求使这些算子的李括号为零的充要条件。李括号定义为 $[\\mathcal{X},\\mathcal{Y}] := \\mathcal{X}\\mathcal{Y} - \\mathcal{Y}\\mathcal{X}$。我们通过将每对算子作用于一个任意的、足够光滑的测试函数 $f(x)$ 来进行检验。\n\n**$[\\mathcal{A},\\mathcal{R}]=0$ 的条件：**\n算子 $\\mathcal{R}$ 对应于乘以一个标量常数 $r$。任何线性算子都与标量乘法对易。我们可以形式上证明如下：\n$$\n[\\mathcal{A},\\mathcal{R}] f(x) = (\\mathcal{A}\\mathcal{R} - \\mathcal{R}\\mathcal{A}) f(x) = \\mathcal{A}(r f(x)) - \\mathcal{R}(\\mathcal{A} f(x))\n$$\n$$\n= \\left(-a \\frac{\\partial}{\\partial x}\\right)(r f(x)) - r \\left(-a \\frac{\\partial f(x)}{\\partial x}\\right)\n$$\n由于 $a$ 和 $r$ 是常数，它们可以从导数中提出：\n$$\n= -ar \\frac{\\partial f(x)}{\\partial x} + ar \\frac{\\partial f(x)}{\\partial x} = 0\n$$\n这对任意 $f(x)$ 都成立，因此 $[\\mathcal{A},\\mathcal{R}]=0$。其充要条件是 $a$ 和 $r$ 为常数，这在题目中已经给出。\n\n**$[\\mathcal{D},\\mathcal{R}]=0$ 的条件：**\n类似地，扩散算子 $\\mathcal{D}$ 与标量 $r$ 的乘法对易：\n$$\n[\\mathcal{D},\\mathcal{R}] f(x) = (\\mathcal{D}\\mathcal{R} - \\mathcal{R}\\mathcal{D}) f(x) = \\mathcal{D}(r f(x)) - \\mathcal{R}(\\mathcal{D} f(x))\n$$\n$$\n= \\left(D \\frac{\\partial^2}{\\partial x^2}\\right)(r f(x)) - r \\left(D \\frac{\\partial^2 f(x)}{\\partial x^2}\\right)\n$$\n因为 $D$ 和 $r$ 是常数：\n$$\n= Dr \\frac{\\partial^2 f(x)}{\\partial x^2} - rD \\frac{\\partial^2 f(x)}{\\partial x^2} = 0\n$$\n因此，$[\\mathcal{D},\\mathcal{R}]=0$。其充要条件是 $D$ 和 $r$ 为常数，这也已在题目中给出。\n\n**$[\\mathcal{A},\\mathcal{D}]=0$ 的条件：**\n我们考察这两个微分算子的复合。\n$$\n\\mathcal{A}\\mathcal{D} f(x) = \\left(-a \\frac{\\partial}{\\partial x}\\right) \\left(D \\frac{\\partial^2 f(x)}{\\partial x^2}\\right) = -aD \\frac{\\partial^3 f(x)}{\\partial x^3}\n$$\n$$\n\\mathcal{D}\\mathcal{A} f(x) = \\left(D \\frac{\\partial^2}{\\partial x^2}\\right) \\left(-a \\frac{\\partial f(x)}{\\partial x}\\right) = -Da \\frac{\\partial^3 f(x)}{\\partial x^3}\n$$\n等式 $\\mathcal{A}\\mathcal{D}f(x) = \\mathcal{D}\\mathcal{A}f(x)$ 成立，因为系数 $a$ 和 $D$ 是常数，可以移出微分算子，并且对于足够光滑的函数，偏导数是可交换的（Clairaut 定理）。因此，李括号为零：\n$$\n[\\mathcal{A},\\mathcal{D}] = 0\n$$\n此对易性的充要条件是系数 $a$ 和 $D$ 为常数，不依赖于 $x$，正如问题中所述。\n\n一个更简洁的证明方法是使用傅里叶分析。在周期性域上，物理空间中的微分对应于傅里叶空间中乘以 $ik$，其中 $k$ 是波数。作用于傅里叶模态 $e^{ikx}$ 的算子变成了简单的乘子：\n- $\\mathcal{A} \\rightarrow \\hat{\\mathcal{A}} = -a(ik) = -iak$\n- $\\mathcal{D} \\rightarrow \\hat{\\mathcal{D}} = D(ik)^2 = -Dk^2$\n- $\\mathcal{R} \\rightarrow \\hat{\\mathcal{R}} = r$\n在傅里叶空间中，这些算子只是 $k$ 的函数。此类函数的乘法是可交换的。例如，$[\\hat{\\mathcal{A}}, \\hat{\\mathcal{D}}] = (-iak)(-Dk^2) - (-Dk^2)(-iak) = iakDk^2 - iakDk^2 = 0$。由于这些算子对每个傅里叶模态都对易，因此它们在一般情况下也对易。这证实了所有算子对都是对易的。\n\n**Strang 分裂法与 Lie-Trotter 分裂法的等价性**\n\n算子指数的一个基本性质指出，如果两个算子 $\\mathcal{X}$ 和 $\\mathcal{Y}$ 对易（即 $[\\mathcal{X},\\mathcal{Y}]=0$），那么 $e^{\\mathcal{X}}e^{\\mathcal{Y}} = e^{\\mathcal{Y}}e^{\\mathcal{X}} = e^{\\mathcal{X}+\\mathcal{Y}}$。此性质可以推广到任意数量的相互对易的算子。\n\n既然我们已经证明 $\\mathcal{A}$、$\\mathcal{D}$ 和 $\\mathcal{R}$ 是相互对易的，我们就可以分析这些分裂算子。\n\nLie-Trotter 算子为 $T_{\\Delta t} := e^{\\Delta t \\mathcal{A}} e^{\\Delta t \\mathcal{D}} e^{\\Delta t \\mathcal{R}}$。由于指数中的算子相互对易，我们可以将它们合并：\n$$\nT_{\\Delta t} = e^{\\Delta t \\mathcal{A} + \\Delta t \\mathcal{D} + \\Delta t \\mathcal{R}} = e^{\\Delta t (\\mathcal{A}+\\mathcal{D}+\\mathcal{R})}\n$$\n这恰好是完整 PDE 在一个时间步长 $\\Delta t$ 上的精确演化算子。\n\nStrang 分裂算子为 $S_{\\Delta t} := e^{\\frac{\\Delta t}{2} \\mathcal{A}} \\, e^{\\frac{\\Delta t}{2} \\mathcal{D}} \\, e^{\\Delta t \\mathcal{R}} \\, e^{\\frac{\\Delta t}{2} \\mathcal{D}} \\, e^{\\frac{\\Delta t}{2} \\mathcal{A}}$。利用对易性，我们可以重排各项因子：\n$$\nS_{\\Delta t} = \\left(e^{\\frac{\\Delta t}{2} \\mathcal{A}} e^{\\frac{\\Delta t}{2} \\mathcal{A}}\\right) \\left(e^{\\frac{\\Delta t}{2} \\mathcal{D}} e^{\\frac{\\Delta t}{2} \\mathcal{D}}\\right) e^{\\Delta t \\mathcal{R}}\n$$\n合并每个算子的指数：\n$$\nS_{\\Delta t} = e^{\\left(\\frac{\\Delta t}{2} + \\frac{\\Delta t}{2}\\right) \\mathcal{A}} \\, e^{\\left(\\frac{\\Delta t}{2} + \\frac{\\Delta t}{2}\\right) \\mathcal{D}} \\, e^{\\Delta t \\mathcal{R}} = e^{\\Delta t \\mathcal{A}} \\, e^{\\Delta t \\mathcal{D}} \\, e^{\\Delta t \\mathcal{R}}\n$$\n这个最终表达式与 $T_{\\Delta t}$ 的表达式相同。因此，当算子对易时，两种分裂格式对于任何 $\\Delta t > 0$ 都是等价且精确的：\n$$\nS_{\\Delta t} = T_{\\Delta t} = e^{\\Delta t (\\mathcal{A}+\\mathcal{D}+\\mathcal{R})}\n$$\n对于非对易算子，此等式不成立；Strang 分裂法通常具有 $\\Delta t$ 的二阶精度，而 Lie-Trotter 是一阶精度。数值实现将验证，对于给定问题，两种格式之间的差异可以忽略不计，仅受浮点精度的限制。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Numerically validates the equality of Strang and Lie-Trotter splitting\n    for a linear advection-diffusion-reaction PDE with constant coefficients,\n    where the operators are known to commute.\n    \"\"\"\n    \n    test_cases = [\n        # (L, N, dt, T, a, D, r, p, q)\n        (2 * np.pi, 256, 0.005, 0.5, 1.2, 0.03, -1.0, 3, 5),\n        (2 * np.pi, 128, 0.010, 0.5, 0.0, 0.0, 0.7, 4, 7),\n        (2 * np.pi, 128, 0.020, 0.4, 0.0, 0.2, 0.0, 2, 6),\n        (2 * np.pi, 256, 0.003, 0.3, 2.0, 0.0, 0.0, 5, 8),\n        (2 * np.pi, 192, 0.004, 0.52, 0.9, 0.05, -0.5, 7, 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        rms_diff = run_simulation(case)\n        results.append(rms_diff)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef run_simulation(case_params):\n    \"\"\"\n    Runs a single simulation for a given set of parameters and\n    returns the RMS difference between Strang and Lie-Trotter solutions.\n    \"\"\"\n    L, N, dt, T, a, D, r, p, q = case_params\n\n    # 1. Discretize domain and find corresponding wavenumbers\n    x = np.linspace(0, L, N, endpoint=False)\n    k = 2 * np.pi * np.fft.fftfreq(N, d=L / N)\n\n    # 2. Set initial condition\n    c0 = np.sin(2 * np.pi * p / L * x) + 0.5 * np.cos(2 * np.pi * q / L * x)\n\n    c_trotter = np.copy(c0)\n    c_strang = np.copy(c0)\n\n    # 3. Define operators for sub-steps\n    def apply_advection(c_in, tau, a_val, k_vec):\n        c_hat = np.fft.fft(c_in)\n        c_hat *= np.exp(-1j * a_val * k_vec * tau)\n        return np.real(np.fft.ifft(c_hat))\n\n    def apply_diffusion(c_in, tau, D_val, k_vec):\n        c_hat = np.fft.fft(c_in)\n        c_hat *= np.exp(-D_val * k_vec**2 * tau)\n        return np.real(np.fft.ifft(c_hat))\n    \n    def apply_reaction(c_in, tau, r_val):\n        return c_in * np.exp(r_val * tau)\n\n    # 4. Time evolution loop\n    num_steps = int(round(T / dt))\n    dt_half = dt / 2.0\n\n    for _ in range(num_steps):\n        # Lie-Trotter splitting update\n        # T_dt = exp(dt*A) exp(dt*D) exp(dt*R)\n        c_temp_T = apply_advection(c_trotter, dt, a, k)\n        c_temp_T = apply_diffusion(c_temp_T, dt, D, k)\n        c_trotter = apply_reaction(c_temp_T, dt, r)\n\n        # Strang splitting update\n        # S_dt = exp(dt/2*A) exp(dt/2*D) exp(dt*R) exp(dt/2*D) exp(dt/2*A)\n        c_temp_S = apply_advection(c_strang, dt_half, a, k)\n        c_temp_S = apply_diffusion(c_temp_S, dt_half, D, k)\n        c_temp_S = apply_reaction(c_temp_S, dt, r)\n        c_temp_S = apply_diffusion(c_temp_S, dt_half, D, k)\n        c_strang = apply_advection(c_temp_S, dt_half, a, k)\n\n    # 5. Calculate final RMS difference\n    rms_difference = np.sqrt(np.mean((c_strang - c_trotter)**2))\n    \n    return rms_difference\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "在理解了理想的算子可交换情况后，我们现在转向更常见的算子不可交换场景。本练习将直接比较一阶Lie-Trotter方法与二阶Strang分裂在一个简单对流-反应问题上的表现 。通过这个数值实验，您将能够凭经验验证这两种方法的理论精度阶数，并体会到Strang分裂在处理不可交换算子时的优越性。",
            "id": "4068626",
            "problem": "考虑一个一维、周期性、无量纲的反应流，包含两种组分的质量分数，记为 $Y(x,t)$ 和 $Z(x,t)$，在长度为 $L$、坐标为 $x \\in [0,L)$ 的区域上进行演化。该流动由具有恒定速度的平流和具有双线性质量作用动力学的局部反应所控制。其控制方程为\n$$\n\\frac{\\partial Y}{\\partial t} + c_Y \\frac{\\partial Y}{\\partial x} = -k\\, Y Z,\\qquad\n\\frac{\\partial Z}{\\partial t} + c_Z \\frac{\\partial Z}{\\partial x} = +k\\, Y Z,\n$$\n其中 $c_Y$ 和 $c_Z$ 是恒定的平流速度，$k$ 是恒定的反应速率。所有量均为无量纲。初始条件是光滑的正函数：\n$$\nY(x,0) = 0.7 + 0.2 \\sin(x) + 0.1 \\cos(2x), \\qquad\nZ(x,0) = 0.3 + 0.2 \\cos(x).\n$$\n在长度为 $L = 2\\pi$ 的周期性区间上，使用包含 $N = 1024$ 个点的均匀网格进行计算。设最终时间为 $T = 0.2$。定义作用于 $(Y,Z)$ 对的线性平流算子 $\\mathcal{A}$，通过沿特征线移动每个组分来实现；定义反应算子 $\\mathcal{R}$，通过求解每个网格点上由反应项引起的局部时间演化来实现。对两个算子均使用精确演化映射：对于平流，通过谱相位相乘实现精确的周期性位移；对于反应，利用反应下 $S=Y+Z$ 的不变性，使用通过分离变量法得到的局部常微分方程的精确解。\n\n构建两种算子分裂积分器来近似计算在时间 $T$ 的解：\n- Lie–Trotter 分裂在每个时间步长内，先应用一个大小为 $\\Delta t$ 的完整平流步，再应用一个大小为 $\\Delta t$ 的完整反应步来进行演化。\n- Strang 分裂在每个时间步长内，先应用一个大小为 $\\Delta t/2$ 的半个平流步，然后是一个大小为 $\\Delta t$ 的完整反应步，最后再应用一个大小为 $\\Delta t/2$ 的半个平流步来进行演化。\n\n对于每个近似解，使用网格上的离散 $L^2$ 范数，测量其在时间 $T$ 相对于一个参考解的全局误差。该参考解由 Strang 分裂法使用一个足够小的时间步长 $\\Delta t_{\\mathrm{ref}}$（远小于所测试的 $\\Delta t$ 值）构建：\n$$\nE(\\Delta t) = \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left[ \\left( Y_j(T;\\Delta t) - Y_j^{\\mathrm{ref}}(T) \\right)^2 + \\left( Z_j(T;\\Delta t) - Z_j^{\\mathrm{ref}}(T) \\right)^2 \\right] \\right)^{1/2},\n$$\n其中 $Y_j(T;\\Delta t)$ 和 $Z_j(T;\\Delta t)$ 表示在时间步长为 $\\Delta t$ 时，在网格点 $j$ 和时间 $T$ 得到的数值解，$Y_j^{\\mathrm{ref}}(T)$ 和 $Z_j^{\\mathrm{ref}}(T)$ 表示参考解。\n\n通过对一组时间步长上的 $\\log E(\\Delta t)$ 与 $\\log \\Delta t$ 进行最小二乘拟合，来估计每种方法的观测精度阶 $p$，即找到 $p$ 使得\n$$\n\\log E(\\Delta t) \\approx \\alpha + p \\, \\log \\Delta t\n$$\n对于某个常数 $\\alpha$。报告每种方法和每个测试案例所得到的 $p$ 值。\n\n使用以下参数集测试套件，每个测试的最终时间均为 $T = 0.2$，测试的时间步长集合为 $\\Delta t \\in \\{0.02, 0.01, 0.005, 0.0025\\}$：\n- 案例1：$c_Y = 1.0$, $c_Z = -0.5$, $k = 5.0$。\n- 案例2：$c_Y = 1.5$, $c_Z = 0.3$, $k = 2.0$。\n- 案例3：$c_Y = 0.7$, $c_Z = 1.2$, $k = 3.0$。\n\n所有量均为无量纲；无需物理单位。您的程序必须：\n- 精确实现谱平流位移。\n- 利用 $S=Y+Z$ 不变性，通过闭式解精确实现局部反应映射。\n- 使用 Strang 分裂法和 $\\Delta t_{\\mathrm{ref}} = 0.0003125$ 构建一个高保真度的参考解。\n- 对于每个案例，计算 Lie–Trotter 和 Strang 分裂在指定 $\\Delta t$ 值下的全局误差，估计每种方法的观测精度阶 $p$，并生成最终输出。输出为单行文本，包含按以下顺序排列的六个估计阶数：Lie–Trotter 案例1，Strang 案例1，Lie–Trotter 案例2，Strang 案例2，Lie–Trotter 案例3，Strang 案例3。\n\n最终输出格式：单行文本，使用方括号括起来的逗号分隔列表，例如\n$$\n[\\text{p\\_LT\\_1},\\text{p\\_Strang\\_1},\\text{p\\_LT\\_2},\\text{p\\_Strang\\_2},\\text{p\\_LT\\_3},\\text{p\\_Strang\\_3}]\n$$\n其中每个条目都是一个浮点数。",
            "solution": "用户提供的问题是计算科学领域一个适定且标准的练习，特别是在反应流的偏微分方程（PDE）数值求解方面。它具有科学依据，没有矛盾，并包含进行求解所需的所有必要信息。\n\n该问题的核心是在周期性域 $x \\in [0, 2\\pi)$ 上，对两个组分 $Y(x,t)$ 和 $Z(x,t)$ 的一维平流-反应方程组进行数值积分。控制方程为：\n$$\n\\frac{\\partial Y}{\\partial t} + c_Y \\frac{\\partial Y}{\\partial x} = -k\\, Y Z\n$$\n$$\n\\frac{\\partial Z}{\\partial t} + c_Z \\frac{\\partial Z}{\\partial x} = +k\\, Y Z\n$$\n其中 $c_Y$ 和 $c_Z$ 是恒定的平流速度，$k$ 是恒定的反应速率。初始条件由光滑的正函数给出：\n$$\nY(x,0) = 0.7 + 0.2 \\sin(x) + 0.1 \\cos(2x)\n$$\n$$\nZ(x,0) = 0.3 + 0.2 \\cos(x)\n$$\n求解域在包含 $N=1024$ 个点的均匀网格上进行离散化。问题的核心是使用算子分裂法求解该系统，这种方法将完整的偏微分方程解耦为更简单的子问题。将解 $(Y,Z)$ 向前推进一个时间步长 $\\Delta t$ 的完整演化算子 $\\mathcal{S}_{\\Delta t}$，通过纯平流算子（$\\mathcal{A}$）和纯反应算子（$\\mathcal{R}$）的组合来近似。\n\n演化方程可以写成抽象形式 $\\frac{d\\mathbf{u}}{dt} = (\\mathcal{A} + \\mathcal{R})\\mathbf{u}$，其中 $\\mathbf{u} = (Y,Z)^T$。这些算子分别对应于偏微分方程的平流部分和反应部分。\n\n### 平流算子 $\\mathcal{A}_{\\Delta t}$\n系统的平流部分是一对线性双曲方程：\n$$\n\\frac{\\partial Y}{\\partial t} + c_Y \\frac{\\partial Y}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial Z}{\\partial t} + c_Z \\frac{\\partial Z}{\\partial x} = 0\n$$\n对于周期性域，这些方程在傅里叶空间中求解最为高效和准确。对 $Y$ 的方程（对 $Z$ 也类似）进行傅里叶变换，可以为每个傅里叶模式 $\\hat{Y}(k_m, t)$ 得到一个常微分方程（ODE）：\n$$\n\\frac{d \\hat{Y}(k_m, t)}{dt} + c_Y (i k_m) \\hat{Y}(k_m, t) = 0\n$$\n其中 $k_m$ 是离散波数。对于长度为 $L=2\\pi$、包含 $N$ 个点的域，波数是整数 $m = [-N/2, \\dots, N/2 - 1]$。在一个时间步长 $\\Delta t$ 内的精确解是傅里叶空间中的一个简单相移：\n$$\n\\hat{Y}(k_m, t_0+\\Delta t) = \\hat{Y}(k_m, t_0) e^{-i k_m c_Y \\Delta t}\n$$\n平流算子 $\\mathcal{A}_{\\Delta t}$ 的计算实现方式如下：\n$1$. 对组分场（例如 $Y(x)$）进行正向快速傅里叶变换（FFT）。\n$2$. 将得到的傅里叶系数乘以复相因子 $e^{-i k_m c \\Delta t}$。\n$3$. 进行逆向 FFT 将场变换回物理空间。\n此过程独立地应用于 $Y$ 和 $Z$，使用它们各自的速度 $c_Y$ 和 $c_Z$。\n\n### 反应算子 $\\mathcal{R}_{\\Delta t}$\n反应部分是在每个网格点上独立求解的非线性耦合常微分方程组：\n$$\n\\frac{dY}{dt} = -k Y Z\n$$\n$$\n\\frac{dZ}{dt} = +k Y Z\n$$\n将两个方程相加，揭示了反应过程中的一个守恒量：\n$$\n\\frac{d(Y+Z)}{dt} = 0 \\implies S = Y+Z = \\text{constant}\n$$\n这个不变量 $S$ 使得系统可以解耦。将 $Z = S-Y$ 代入第一个 ODE，得到一个关于 $Y$ 的 logistic 型方程：\n$$\n\\frac{dY}{dt} = -k Y (S-Y)\n$$\n该方程是可分离的，并且可以精确积分。通过分离变量和使用部分分式分解，我们得到：\n$$\n\\int \\frac{dY}{Y(S-Y)} = \\int -k dt \\implies \\frac{1}{S} \\int \\left(\\frac{1}{Y} + \\frac{1}{S-Y}\\right) dY = -k \\int dt\n$$\n从 $t=0$ 时的初始状态 $(Y_0, Z_0)$ 积分到时间 $t$ 时的 $(Y(t), Z(t))$，然后求解 $Y(t)$，即可得到闭式解。一个数值稳定的形式是：\n$$\nY(t) = \\frac{S Y_0}{Z_0 e^{Skt} + Y_0}\n$$\n其中 $S = Y_0+Z_0$。然后可以从不变量中找到 $Z$ 的新值：$Z(t) = S - Y(t)$。反应算子 $\\mathcal{R}_{\\Delta t}$ 在每个网格点上应用这个精确解映射，时间步长为 $\\Delta t$。\n\n### 算子分裂积分器\n构建了两种分裂方法：\n$1$. **Lie–Trotter 分裂**：这是一种一阶精度方法。从 $t$ 到 $t+\\Delta t$ 的一步演化通过先应用完整的平流步，再应用完整的反应步来近似：\n$$\n\\mathbf{u}(t+\\Delta t) \\approx \\mathcal{S}_{\\Delta t}^{\\text{LT}}(\\mathbf{u}(t)) = \\mathcal{R}_{\\Delta t} \\circ \\mathcal{A}_{\\Delta t} (\\mathbf{u}(t))\n$$\n$2$. **Strang 分裂**：这是一种使用对称组合的二阶精度方法。一步演化通过应用半个平流步、一个完整的反应步、再应用另一个半个平流步来近似：\n$$\n\\mathbf{u}(t+\\Delta t) \\approx \\mathcal{S}_{\\Delta t}^{\\text{S}}(\\mathbf{u}(t)) = \\mathcal{A}_{\\Delta t/2} \\circ \\mathcal{R}_{\\Delta t} \\circ \\mathcal{A}_{\\Delta t/2} (\\mathbf{u}(t))\n$$\n\n### 收敛性分析\n为了确定观测精度阶 $p$，我们对一组递减的时间步长 $\\Delta t$ 进行模拟。在最终时间 $T$ 的全局误差是相对于一个高保真度参考解来计算的。参考解是使用 Strang 分裂法和一个非常小的时间步长 $\\Delta t_{\\text{ref}} = 0.0003125$ 生成的。误差使用离散 $L^2$ 范数来测量：\n$$\nE(\\Delta t) = \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left[ \\left( Y_j(T;\\Delta t) - Y_j^{\\mathrm{ref}}(T) \\right)^2 + \\left( Z_j(T;\\Delta t) - Z_j^{\\mathrm{ref}}(T) \\right)^2 \\right] \\right)^{1/2}\n$$\n对于一个 $p$ 阶方法，误差的缩放关系为 $E(\\Delta t) \\propto (\\Delta t)^p$。取对数后得到一个线性关系：$\\log E(\\Delta t) \\approx \\alpha + p \\log \\Delta t$。阶数 $p$ 被估计为对数据点 $(\\log \\Delta t, \\log E(\\Delta t))$ 进行线性最小二乘拟合的斜率。对三个测试案例中的 Lie-Trotter 分裂和 Strang 分裂都执行此操作。理论上预期的阶数是 Lie-Trotter 分裂为 $p=1$，Strang 分裂为 $p=2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef advect(Y, Z, dt, c_Y, c_Z, kx):\n    \"\"\"\n    Evolves Y and Z by a time step dt using the spectral advection operator.\n    \"\"\"\n    Y_hat = np.fft.fft(Y)\n    Z_hat = np.fft.fft(Z)\n    \n    Y_hat_new = Y_hat * np.exp(-1j * kx * c_Y * dt)\n    Z_hat_new = Z_hat * np.exp(-1j * kx * c_Z * dt)\n    \n    # an ifft followed by .real removes numerical noise in the imaginary part\n    Y_new = np.fft.ifft(Y_hat_new).real\n    Z_new = np.fft.ifft(Z_hat_new).real\n    \n    return Y_new, Z_new\n\ndef react(Y, Z, dt, k):\n    \"\"\"\n    Evolves Y and Z by a time step dt using the exact reaction operator.\n    \"\"\"\n    S = Y + Z\n    Y_new = np.copy(Y)\n    Z_new = np.copy(Z)\n    \n    # Only compute reaction where S > 0 to avoid division by zero or log(0) issues,\n    # and handle Y=Z=0 case where no reaction occurs.\n    # A small tolerance is used for floating-point comparisons.\n    mask = S > 1e-15\n    \n    Y_masked = Y[mask]\n    Z_masked = Z[mask]\n    S_masked = S[mask]\n    \n    # Use the numerically stable form of the exact solution to avoid large exponentials\n    # Y(t) = S*Y0 / (Z0*exp(S*k*t) + Y0)\n    exp_term_pos = np.exp(S_masked * k * dt)\n    denom = Z_masked * exp_term_pos + Y_masked\n    \n    # Avoid division by zero in the unlikely case denom is zero\n    # (only if Y_masked=0 and Z_masked=0, which is outside the mask)\n    Y_new[mask] = np.divide(S_masked * Y_masked, denom, out=np.zeros_like(Y_masked), where=denom!=0)\n\n    # Z is updated from the invariant S\n    Z_new = S - Y_new\n    \n    return Y_new, Z_new\n\ndef solve_lt(Y0, Z0, T, dt, c_Y, c_Z, k, kx):\n    \"\"\"Integrator using Lie-Trotter splitting.\"\"\"\n    Y, Z = np.copy(Y0), np.copy(Z0)\n    num_steps = int(round(T / dt))\n    \n    for _ in range(num_steps):\n        Y, Z = advect(Y, Z, dt, c_Y, c_Z, kx)\n        Y, Z = react(Y, Z, dt, k)\n        \n    return Y, Z\n\ndef solve_strang(Y0, Z0, T, dt, c_Y, c_Z, k, kx):\n    \"\"\"Integrator using Strang splitting.\"\"\"\n    Y, Z = np.copy(Y0), np.copy(Z0)\n    num_steps = int(round(T / dt))\n    \n    for _ in range(num_steps):\n        Y, Z = advect(Y, Z, dt / 2.0, c_Y, c_Z, kx)\n        Y, Z = react(Y, Z, dt, k)\n        Y, Z = advect(Y, Z, dt / 2.0, c_Y, c_Z, kx)\n        \n    return Y, Z\n\ndef solve():\n    # Define problem setup\n    N = 1024\n    L = 2.0 * np.pi\n    T = 0.2\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # The integer wavenumbers for L=2*pi\n    kx = np.fft.fftfreq(N) * N\n    \n    # Initial Conditions\n    Y0 = 0.7 + 0.2 * np.sin(x) + 0.1 * np.cos(2*x)\n    Z0 = 0.3 + 0.2 * np.cos(x)\n    \n    # Test cases and time steps for convergence analysis\n    test_cases = [\n        (1.0, -0.5, 5.0), # Case 1\n        (1.5, 0.3, 2.0),  # Case 2\n        (0.7, 1.2, 3.0),  # Case 3\n    ]\n    \n    dts = np.array([0.02, 0.01, 0.005, 0.0025])\n    dt_ref = 0.0003125\n    \n    all_orders = []\n    \n    for c_Y, c_Z, k in test_cases:\n        # Compute high-fidelity reference solution\n        Y_ref, Z_ref = solve_strang(Y0, Z0, T, dt_ref, c_Y, c_Z, k, kx)\n        \n        errors_lt = []\n        errors_strang = []\n        \n        for dt in dts:\n            # Solve with Lie-Trotter and compute error\n            Y_lt, Z_lt = solve_lt(Y0, Z0, T, dt, c_Y, c_Z, k, kx)\n            error_lt = np.sqrt(np.mean((Y_lt - Y_ref)**2 + (Z_lt - Z_ref)**2))\n            errors_lt.append(error_lt)\n            \n            # Solve with Strang and compute error\n            Y_s, Z_s = solve_strang(Y0, Z0, T, dt, c_Y, c_Z, k, kx)\n            error_s = np.sqrt(np.mean((Y_s - Y_ref)**2 + (Z_s - Z_ref)**2))\n            errors_strang.append(error_s)\n\n        # Estimate order of accuracy using a log-log linear fit\n        # The model is log(E) = alpha + p * log(dt)\n        # np.polyfit(x, y, 1) returns [p, alpha] for y = p*x + alpha\n        log_dts = np.log(dts)\n        \n        # Lie-Trotter order\n        log_errors_lt = np.log(np.array(errors_lt))\n        p_lt, _ = np.polyfit(log_dts, log_errors_lt, 1)\n        all_orders.append(p_lt)\n        \n        # Strang order\n        log_errors_strang = np.log(np.array(errors_strang))\n        p_strang, _ = np.polyfit(log_dts, log_errors_strang, 1)\n        all_orders.append(p_strang)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{p:.10f}' for p in all_orders)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在真实的燃烧模拟中，化学反应步骤通常是“刚性”的，意味着其时间尺度远快于输运过程。这要求使用隐式时间积分方法来保证数值稳定性。本练习提供了一个集中的动手计算任务，要求您使用向后欧拉法和牛顿-拉夫逊修正来求解一个耦合了温度的隐式反应半步，这是现代反应流求解器中的一项核心技术 。",
            "id": "4068653",
            "problem": "考虑一个通过 Strang 分裂（半个反应步，一个完整的对流-扩散步，半个反应步）推进的均相反应单元。重点关注一个持续时间为 $\\Delta t_{r} = \\Delta t/2$ 的反应半步，该步骤涉及在氧气过量的混合物中发生的单一不可逆燃料到产物的反应，使得反应速率对于燃料质量分数是伪一级。燃料质量分数记为 $Y_{F}$，混合物温度记为 $T$。单位时间的反应速率由 Arrhenius 定律建模\n$$\n\\omega(Y_{F},T) = A \\,\\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T}\\right)\\,Y_{F},\n$$\n其中 $A$ 是指前因子，$E_{a}$ 是活化能，$R_{u}$ 是普适气体常数。在定压、定密度和定比热的假设下，并忽略反应子步中的输运过程，燃料和温度遵循以下耦合常微分方程（ODE）\n$$\n\\frac{dY_{F}}{dt} = -\\omega(Y_{F},T), \\qquad \\frac{dT}{dt} = \\frac{q}{c_{p}}\\,\\omega(Y_{F},T),\n$$\n其中 $q$ 是单位质量燃料消耗所释放的比热，$c_{p}$ 是混合物的定压比热。该半步使用后向欧拉法进行隐式离散化：\n$$\nY_{F}^{*} = Y_{F}^{n} - \\Delta t_{r}\\,\\omega\\!\\left(Y_{F}^{*},T^{*}\\right), \\qquad\nT^{*} = T^{n} + \\Delta t_{r}\\,\\frac{q}{c_{p}}\\,\\omega\\!\\left(Y_{F}^{*},T^{*}\\right),\n$$\n其中上标 $n$ 表示半步开始时的状态，上标 $*$ 表示半步结束时更新后的状态。您的任务是，从初始猜测 $Y_{F}^{(0)} = Y_{F}^{n}$ 开始，通过推导 $Y_{F}^{*}$ 的标量非线性残差、其关于 $Y_{F}^{*}$ 的导数，并应用一次 Newton 校正 $Y_{F}^{(1)} = Y_{F}^{(0)} - F\\!\\left(Y_{F}^{(0)}\\right)/F'\\!\\left(Y_{F}^{(0)}\\right)$，来执行一次 Newton-Raphson（NR）校正以近似求解 $Y_{F}^{*}$。\n\n使用以下物理上一致的参数：\n- $Y_{F}^{n} = 0.06$，\n- $T^{n} = 1200\\,\\mathrm{K}$，\n- $\\Delta t = 2.0\\times 10^{-6}\\,\\mathrm{s}$，因此 $\\Delta t_{r} = 1.0\\times 10^{-6}\\,\\mathrm{s}$，\n- $A = 5.0\\times 10^{7}\\,\\mathrm{s}^{-1}$，\n- $E_{a} = 1.25\\times 10^{5}\\,\\mathrm{J/mol}$，\n- $R_{u} = 8.314\\,\\mathrm{J/(mol\\cdot K)}$，\n- $q = 5.0\\times 10^{7}\\,\\mathrm{J/kg}$，\n- $c_{p} = 1200\\,\\mathrm{J/(kg\\cdot K)}$。\n\n将您的最终答案表示为半步结束时经过 Newton 校正的燃料质量分数 $Y_{F}^{(1)}$ 的单个值。将您的答案四舍五入到八位有效数字。将您的答案表示为无量纲的质量分数。",
            "solution": "在反应子步中的控制常微分方程（ODE）为\n$$\n\\frac{dY_{F}}{dt} = -A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T}\\right) Y_{F}, \n\\qquad \n\\frac{dT}{dt} = \\frac{q}{c_{p}}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T}\\right) Y_{F}.\n$$\n在半步 $\\Delta t_{r}$ 上使用后向欧拉法得到隐式系统\n$$\nY_{F}^{*} = Y_{F}^{n} - \\Delta t_{r}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{*}}\\right) Y_{F}^{*},\n\\qquad\nT^{*} = T^{n} + \\Delta t_{r}\\,\\frac{q}{c_{p}}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{*}}\\right) Y_{F}^{*}.\n$$\n使用燃料方程消去 $T^{*}$。根据燃料更新方程，\n$$\n\\Delta t_{r}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{*}}\\right) Y_{F}^{*} = Y_{F}^{n} - Y_{F}^{*}.\n$$\n因此，温度更新方程可以改写为\n$$\nT^{*} = T^{n} + \\frac{q}{c_{p}}\\left(Y_{F}^{n} - Y_{F}^{*}\\right).\n$$\n定义常数\n$$\n\\alpha \\equiv \\frac{q}{c_{p}}.\n$$\n则 $T^{*} = T^{n} + \\alpha\\left(Y_{F}^{n} - Y_{F}^{*}\\right)$，且单个未知数 $Y_{F}^{*}$ 必须满足标量非线性方程\n$$\nF\\!\\left(Y\\right) \\equiv Y - Y_{F}^{n} + \\Delta t_{r}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,\\left[T^{n} + \\alpha\\left(Y_{F}^{n} - Y\\right)\\right]}\\right) Y = 0.\n$$\nNewton-Raphson（NR）校正需要导数 $F'(Y)$。使用乘法法则和链式法则求导。定义\n$$\nT(Y) \\equiv T^{n} + \\alpha\\left(Y_{F}^{n} - Y\\right), \n\\qquad\n\\phi(Y) \\equiv \\frac{E_{a}}{R_{u}\\,T(Y)}.\n$$\n则\n$$\n\\frac{d\\phi}{dY} = \\frac{E_{a}}{R_{u}}\\frac{d}{dY}\\left(\\frac{1}{T(Y)}\\right) \n= \\frac{E_{a}}{R_{u}}\\left(-\\frac{1}{T(Y)^{2}}\\right)\\frac{dT}{dY}\n= \\frac{E_{a}}{R_{u}}\\left(-\\frac{1}{T(Y)^{2}}\\right)\\left(-\\alpha\\right)\n= \\frac{E_{a}\\,\\alpha}{R_{u}\\,T(Y)^{2}}.\n$$\n设\n$$\ng(Y) \\equiv A \\exp\\!\\left(-\\phi(Y)\\right) Y.\n$$\n则\n$$\ng'(Y) = A \\exp\\!\\left(-\\phi(Y)\\right)\\left[1 + Y\\left(-\\frac{d\\phi}{dY}\\right)\\right]\n= A \\exp\\!\\left(-\\phi(Y)\\right)\\left[1 - Y\\,\\frac{E_{a}\\,\\alpha}{R_{u}\\,T(Y)^{2}}\\right].\n$$\n因此\n$$\nF'(Y) = 1 + \\Delta t_{r}\\,g'(Y) \n= 1 + \\Delta t_{r}\\,A \\exp\\!\\left(-\\phi(Y)\\right)\\left[1 - Y\\,\\frac{E_{a}\\,\\alpha}{R_{u}\\,T(Y)^{2}}\\right].\n$$\n从 $Y^{(0)} = Y_{F}^{n}$ 开始的单次 Newton 校正是\n$$\nY^{(1)} = Y^{(0)} - \\frac{F\\!\\left(Y^{(0)}\\right)}{F'\\!\\left(Y^{(0)}\\right)}.\n$$\n计算 $F$ 和 $F'$ 在 $Y^{(0)} = Y_{F}^{n}$ 处的值。在 $Y = Y_{F}^{n}$ 时，我们有 $T(Y) = T^{n}$，所以\n$$\n\\phi\\!\\left(Y_{F}^{n}\\right) = \\frac{E_{a}}{R_{u}\\,T^{n}}, \n\\qquad\n\\exp\\!\\left(-\\phi\\!\\left(Y_{F}^{n}\\right)\\right) = \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right).\n$$\n于是\n$$\nF\\!\\left(Y_{F}^{n}\\right) \n= Y_{F}^{n} - Y_{F}^{n} + \\Delta t_{r}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right) Y_{F}^{n}\n= \\Delta t_{r}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right) Y_{F}^{n},\n$$\n和\n$$\nF'\\!\\left(Y_{F}^{n}\\right)\n= 1 + \\Delta t_{r}\\,A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right)\\left[1 - Y_{F}^{n}\\,\\frac{E_{a}\\,\\alpha}{R_{u}\\,\\left(T^{n}\\right)^{2}}\\right].\n$$\n代入给定的参数值。首先计算温度耦合常数\n$$\n\\alpha = \\frac{q}{c_{p}} = \\frac{5.0\\times 10^{7}}{1200} \\approx 4.1666667\\times 10^{4}.\n$$\n计算在初始温度下的 Arrhenius 指数\n$$\n\\frac{E_{a}}{R_{u}\\,T^{n}} = \\frac{1.25\\times 10^{5}}{8.314 \\times 1200} = \\frac{1.25\\times 10^{5}}{9976.8} \\approx 12.5290674,\n$$\n所以\n$$\n\\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right) \\approx \\exp(-12.5290674) \\approx 3.615757\\times 10^{-6}.\n$$\n因此\n$$\nA \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right) \\approx 5.0\\times 10^{7}\\times 3.615757\\times 10^{-6} \\approx 1.8078785\\times 10^{2}.\n$$\n于是\n$$\nF\\!\\left(Y_{F}^{n}\\right) \\approx \\Delta t_{r}\\left[A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right)\\right] Y_{F}^{n}\n= \\left(1.0\\times 10^{-6}\\right)\\left(1.8078785\\times 10^{2}\\right)\\left(0.06\\right)\n\\approx 1.0847271\\times 10^{-5}.\n$$\n对于导数，计算括号内的温度耦合因子\n$$\nY_{F}^{n}\\,\\frac{E_{a}\\,\\alpha}{R_{u}\\,\\left(T^{n}\\right)^{2}} = 0.06 \\times \\frac{\\left(1.25\\times 10^{5}\\right)\\left(4.1666667\\times 10^{4}\\right)}{8.314 \\times \\left(1200\\right)^{2}} \\approx 26.102223,\n$$\n所以\n$$\n\\left[1 - Y_{F}^{n}\\,\\frac{E_{a}\\,\\alpha}{R_{u}\\,\\left(T^{n}\\right)^{2}}\\right] \\approx 1 - 26.102223 = -25.102223.\n$$\n因此\n$$\nF'\\!\\left(Y_{F}^{n}\\right) \n\\approx 1 + \\Delta t_{r}\\left[A \\exp\\!\\left(-\\frac{E_{a}}{R_{u}\\,T^{n}}\\right)\\right]\\left(-25.102223\\right)\n= 1 + \\left(1.0\\times 10^{-6}\\right)\\left(1.8078785\\times 10^{2}\\right)\\left(-25.102223\\right)\n\\approx 0.995461823.\n$$\n应用一次 Newton 校正：\n$$\nY_{F}^{(1)} = Y_{F}^{n} - \\frac{F\\!\\left(Y_{F}^{n}\\right)}{F'\\!\\left(Y_{F}^{n}\\right)}\n\\approx 0.06 - \\frac{1.0847271\\times 10^{-5}}{0.995461823}\n\\approx 0.06 - 1.0896827\\times 10^{-5}\n\\approx 0.059989103.\n$$\n四舍五入到八位有效数字，半步结束时经过 Newton 校正的燃料质量分数为 $0.059989103$，表示为无量纲质量分数。",
            "answer": "$$\\boxed{0.059989103}$$"
        }
    ]
}