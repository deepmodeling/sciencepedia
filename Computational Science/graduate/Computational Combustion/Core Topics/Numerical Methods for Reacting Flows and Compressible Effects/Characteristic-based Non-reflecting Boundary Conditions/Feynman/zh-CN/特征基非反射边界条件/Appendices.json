{
    "hands_on_practices": [
        {
            "introduction": "第一个实践项目提供了一个直接的、动手操作的特征基边界条件实现。通过模拟声学脉冲与边界的相互作用，您将通过计算验证所设定的特征反射系数 $r$ 与实际反射能量之间的关系。这项练习是理解和开发更复杂的无反射边界条件的基础。",
            "id": "4011716",
            "problem": "考虑与计算燃烧学相关的均匀介质中的一维小振幅声学，该模型通过围绕恒定平均态的线性化可压缩流进行建模。设平均密度为 $\\rho_0$，声速为 $c_0$，平均流速为 $U_0$。设空间域为区间 $x \\in [0,L]$，在 $x=L$ 处的向外单位法向量与 $x$ 轴正方向对齐。设 $p'(x,t)$ 和 $u'(x,t)$ 分别表示压力和速度相对于平均态的扰动，并假定其足够小以使线性化成立。线性化的控制方程意味着声扰动沿特征线以速度 $U_0 \\pm c_0$ 传播，并且通过法向速度为 $u_n'$ 的边界的单位面积瞬时声能通量由乘积 $p' u_n'$ 给出。\n\n您将构建一个纯右行高斯声脉冲，并使用基于特征线的边界条件来控制在右边界 $x=L$ 处的反射。您的任务是通过在 $x=L$ 处对 $p' u_n'$ 进行时域积分来量化反射能量，使用特征分解来分离入射和出射的贡献，并报告能量反射比。\n\n使用的基本原理：\n- 围绕均匀平均流的线性化一维声学：声学信息以速度 $U_0 \\pm c_0$ 传播；可以选择右行和左行特征线，使其一者以速度 $U_0 + c_0$ 传播，另一者以速度 $U_0 - c_0$ 传播。\n- 单位面积声能通量等于 $p' u_n'$。\n- 小振幅（线性）声学：忽略粘性、热释放以及熵或涡模式。\n\n高斯声脉冲测试的设计：\n- 定义右行特征变量（以速度 $U_0 + c_0$ 传播的那个），并在时间 $t=0$ 将其初始化为一个振幅为 $A$、中心在 $x=x_0$、标准差为 $\\sigma$ 的高斯脉冲，而左行特征变量（以速度 $U_0 - c_0$ 传播的那个）初始时处处为零。这确保在 $t=0$ 时有一个纯右行的声脉冲。\n- 使用尊重特征平流方向的适当稳定数值方法，将特征变量随时间向前演化。使用与 Courant–Friedrichs–Lewy 条件一致的时间步长。\n- 在 $x=L$ 处施加一个基于特征线的边界条件，使得那里的入射特征线与出射特征线成比例，比例系数为一个预设的反射系数 $r$（可为正或负）。在 $x=0$ 处，不注入波；确保没有伪波从 $x=0$ 进入。\n\n右边界处的能量核算：\n- 在 $x=L$ 处，在每个时间点从特征变量恢复 $p'(L,t)$ 和 $u'(L,t)$，并计算瞬时能量通量 $p'(L,t) \\, u_n'(L,t)$，其中 $u_n'$ 是垂直于边界（与 $x$ 对齐）的速度分量。\n- 使用特征分解，分离出射（右行）和入射（左行）的声学贡献，以便您可以计算由右行波带到边界的入射能量 $E_{\\mathrm{inc}}$ 和由左行波从边界带入域内的反射能量 $E_{\\mathrm{ref}}$。通过在相互作用的持续时间内对适当的时间分辨贡献进行积分来计算这些能量。报告无量纲能量反射比 $\\mathcal{R}_E = E_{\\mathrm{ref}} / E_{\\mathrm{inc}}$。\n\n单位和数值要求：\n- 一致使用国际单位制：距离以米为单位，时间以秒为单位，密度以千克每立方米为单位，速度以米每秒为单位。\n- 最终量 $\\mathcal{R}_E$ 是无量纲的；将其报告为浮点数。\n- 选择适当的空间和时间分辨率，以准确解析高斯脉冲及其与边界的相互作用。高斯振幅应足够小，以保持在线性区内。\n\n测试组：\n对于每个参数集，计算如上定义的单个标量输出 $\\mathcal{R}_E$。\n\n所有测试的通用参数：\n- $\\rho_0 = 1.2$ 千克每立方米。\n- $c_0 = 340$ 米每秒。\n- $L = 1.0$ 米。\n- 高斯参数：$x_0 = 0.2$ 米，$\\sigma = 0.05$ 米，$A = 1.0 \\times 10^{-3}$（为保证线性的小振幅）。\n- 演化足够长的时间，以使右行脉冲到达 $x=L$ 并且反射信号在 $x=L$ 处被完全生成和核算。\n\n各测试中的可变参数：\n- 测试 1：马赫数 $M = 0.0$（因此 $U_0 = M c_0$）和反射系数 $r = 0.0$。\n- 测试 2：马赫数 $M = 0.4$ 和反射系数 $r = 0.3$。\n- 测试 3：马赫数 $M = 0.8$ 和反射系数 $r = -0.5$。\n- 测试 4：马赫数 $M = 0.2$ 和反射系数 $r = 0.9$。\n\n您的程序应按上面列出的顺序计算四个测试中每一个的 $\\mathcal{R}_E$，并生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的结果列表，例如 $[\\mathcal{R}_E^{(1)},\\mathcal{R}_E^{(2)},\\mathcal{R}_E^{(3)},\\mathcal{R}_E^{(4)}]$。每个条目必须是四舍五入到四位小数的浮点数。不应打印其他文本。",
            "solution": "该问题要求计算声脉冲在与一维流中的边界相互作用时的能量反射比 $\\mathcal{R}_E$。解决方案涉及基于特征线法的数值模拟。我将首先形式化物理和数学模型，然后描述数值实现，最后详细说明所需能量比的计算。\n\n### 1. 控制方程和特征变量\n\n该问题由关于均匀平均态 $(\\rho_0, U_0, p_0)$ 的一维线性化欧拉方程建模，用于等熵流动。压力扰动 $p'(x,t)$ 和速度扰动 $u'(x,t)$ 的控制方程可以写成矩阵形式：\n$$\n\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}\n$$\n其中 $\\mathbf{q} = [p', u']^T$ 是状态变量的向量，系统矩阵 $\\mathbf{A}$ 是：\n$$\n\\mathbf{A} = \\begin{pmatrix} U_0  \\rho_0 c_0^2 \\\\ 1/\\rho_0  U_0 \\end{pmatrix}\n$$\n这里，$\\rho_0$ 是平均密度，$c_0$ 是平均声速，$U_0$ 是平均流速。已经引入了等熵关系 $p' = c_0^2 \\rho'$。\n\n为了求解这个双曲系统，我们使用其特征分解将其转换为一组独立的平流方程。$\\mathbf{A}$ 的特征值给出了特征速度：\n$$\n\\lambda_{1,2} = U_0 \\pm c_0\n$$\n相应的左特征向量 $\\mathbf{l}_{1,2}$ 允许我们定义特征变量（或黎曼不变量）$\\mathcal{L}_1$ 和 $\\mathcal{L}_2$：\n$$\n\\mathbf{l}_1 = [1, \\rho_0 c_0] \\quad \\implies \\quad \\mathcal{L}_1 = p' + \\rho_0 c_0 u' \\quad (\\text{右行波})\n$$\n$$\n\\mathbf{l}_2 = [1, -\\rho_0 c_0] \\quad \\implies \\quad \\mathcal{L}_2 = p' - \\rho_0 c_0 u' \\quad (\\text{左行波})\n$$\n这些特征变量满足简单的平流方程：\n$$\n\\frac{\\partial \\mathcal{L}_1}{\\partial t} + (U_0 + c_0) \\frac{\\partial \\mathcal{L}_1}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}_2}{\\partial t} + (U_0 - c_0) \\frac{\\partial \\mathcal{L}_2}{\\partial x} = 0\n$$\n物理变量 $p'$ 和 $u'$ 可以从特征变量中恢复：\n$$\np' = \\frac{\\mathcal{L}_1 + \\mathcal{L}_2}{2}, \\quad u' = \\frac{\\mathcal{L}_1 - \\mathcal{L}_2}{2 \\rho_0 c_0}\n$$\n\n### 2. 数值实现\n\n我们在离散网格上数值求解这两个解耦的平流方程。空间域 $x \\in [0, L]$ 被离散化为 $N_x$ 个点，间距为 $\\Delta x$。时间以步长 $\\Delta t$ 推进。采用一阶迎风格式，因其简单且稳定。\n\n对于 $\\mathcal{L}_1$，平流速度为 $v_1 = U_0 + c_0$。对于所有测试用例，$M = U_0/c_0  1$，所以 $v_1 > 0$。该格式使用来自左侧（迎风方向）的信息：\n$$\n\\mathcal{L}_{1,i}^{n+1} = \\mathcal{L}_{1,i}^n - \\frac{v_1 \\Delta t}{\\Delta x} (\\mathcal{L}_{1,i}^n - \\mathcal{L}_{1,i-1}^n)\n$$\n对于 $\\mathcal{L}_2$，平流速度为 $v_2 = U_0 - c_0  0$。该格式使用来自右侧的信息：\n$$\n\\mathcal{L}_{2,i}^{n+1} = \\mathcal{L}_{2,i}^n - \\frac{v_2 \\Delta t}{\\Delta x} (\\mathcal{L}_{2,i+1}^n - \\mathcal{L}_{2,i}^n)\n$$\n时间步长 $\\Delta t$ 的选择需满足 Courant-Friedrichs-Lewy (CFL) 条件：$\\Delta t \\le \\text{CFL} \\cdot \\frac{\\Delta x}{\\max(|v_1|, |v_2|)}$，其中 CFL 数选择小于 $1$。\n\n### 3. 初始条件和边界条件\n\n**初始条件 ($t=0$):** 初始化一个纯右行高斯脉冲。左行特征设置为零。\n$$\n\\mathcal{L}_1(x, 0) = A \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right), \\quad \\mathcal{L}_2(x, 0) = 0\n$$\n其中 $A$，$x_0$ 和 $\\sigma$ 是给定的脉冲振幅、中心和标准差。\n\n**边界条件:**\n- 在左边界 ($x=0$)，我们必须指定进入域的特征，即 $\\mathcal{L}_1$（因为 $v_1 > 0$）。为防止波注入，我们将其值在所有时间都设置为零：$\\mathcal{L}_1(0, t) = 0$。出射特征 $\\mathcal{L}_2$ 使用迎风格式从内部计算。\n- 在右边界 ($x=L$)，出射特征是 $\\mathcal{L}_1$，由内部计算得出。入射特征是 $\\mathcal{L}_2$（因为 $v_2  0$）。其值由问题指定为与出射特征成比例，反射系数为 $r$：\n$$\n\\mathcal{L}_2(L, t) = r \\cdot \\mathcal{L}_1(L, t)\n$$\n\n### 4. 能量反射比\n\n问题将声能通量定义为 $I(x, t) = p'(x, t) u'(x, t)$。我们在右边界 $x=L$ 处评估此值。为了找到入射和反射能量，我们必须分解此通量。将 $p'$ 和 $u'$ 的表达式用 $\\mathcal{L}_1$ 和 $\\mathcal{L}_2$ 代入：\n$$\nI(L, t) = \\left(\\frac{\\mathcal{L}_1(L,t) + \\mathcal{L}_2(L,t)}{2}\\right) \\left(\\frac{\\mathcal{L}_1(L,t) - \\mathcal{L}_2(L,t)}{2 \\rho_0 c_0}\\right) = \\frac{1}{4 \\rho_0 c_0} \\left( \\mathcal{L}_1(L,t)^2 - \\mathcal{L}_2(L,t)^2 \\right)\n$$\n这个表达式自然地分成了右行分量和左行分量。由右行波 $\\mathcal{L}_1$ 携带的入射能量通量被确定为：\n$$\nI_{\\mathrm{inc}}(t) = \\frac{\\mathcal{L}_1(L, t)^2}{4 \\rho_0 c_0}\n$$\n由左行波 $\\mathcal{L}_2$ 携带的反射能量通量的大小为：\n$$\nI_{\\mathrm{ref}}(t) = \\frac{\\mathcal{L}_2(L, t)^2}{4 \\rho_0 c_0}\n$$\n总入射能量 $E_{\\mathrm{inc}}$ 和反射能量 $E_{\\mathrm{ref}}$ 是通过在波与边界相互作用的持续时间内对这些通量进行积分得到的：\n$$\nE_{\\mathrm{inc}} = \\int_0^{T_{\\mathrm{final}}} I_{\\mathrm{inc}}(t) \\, dt, \\quad E_{\\mathrm{ref}} = \\int_0^{T_{\\mathrm{final}}} I_{\\mathrm{ref}}(t) \\, dt\n$$\n能量反射比 $\\mathcal{R}_E$ 是这些积分能量之比：\n$$\n\\mathcal{R}_E = \\frac{E_{\\mathrm{ref}}}{E_{\\mathrm{inc}}} = \\frac{\\int_0^{T_{\\mathrm{final}}} \\frac{\\mathcal{L}_2(L, t)^2}{4 \\rho_0 c_0} \\, dt}{\\int_0^{T_{\\mathrm{final}}} \\frac{\\mathcal{L}_1(L, t)^2}{4 \\rho_0 c_0} \\, dt} = \\frac{\\int_0^{T_{\\mathrm{final}}} \\mathcal{L}_2(L, t)^2 \\, dt}{\\int_0^{T_{\\mathrm{final}}} \\mathcal{L}_1(L, t)^2 \\, dt}\n$$\n代入边界条件 $\\mathcal{L}_2(L, t) = r \\cdot \\mathcal{L}_1(L, t)$:\n$$\n\\mathcal{R}_E = \\frac{\\int_0^{T_{\\mathrm{final}}} [r \\cdot \\mathcal{L}_1(L, t)]^2 \\, dt}{\\int_0^{T_{\\mathrm{final}}} \\mathcal{L}_1(L, t)^2 \\, dt} = \\frac{r^2 \\int_0^{T_{\\mathrm{final}}} \\mathcal{L}_1(L, t)^2 \\, dt}{\\int_0^{T_{\\mathrm{final}}} \\mathcal{L}_1(L, t)^2 \\, dt} = r^2\n$$\n这个解析结果表明，在所提供的简化通量定义下，能量反射比就是特征反射系数的平方，与平均流马赫数 $M$ 无关。数值模拟必须对给定的测试用例从计算上验证这一发现。任何数值误差，例如来自一阶格式的耗散，都会影响 $\\mathcal{L}_1(L,t)$，但会通过边界条件按比例传递给 $\\mathcal{L}_2(L,t)$，从而在积分结果中保持 $r^2$ 的比率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import trapezoid\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It simulates the propagation of a Gaussian acoustic pulse and calculates\n    the energy reflection ratio at the right boundary.\n    \"\"\"\n\n    def solve_case(M, r):\n        \"\"\"\n        Performs the numerical simulation for a single test case.\n\n        Args:\n            M (float): The mean flow Mach number.\n            r (float): The characteristic reflection coefficient at the right boundary.\n\n        Returns:\n            float: The computed energy reflection ratio, R_E.\n        \"\"\"\n        # Common parameters from the problem statement\n        rho0 = 1.2  # kg/m^3\n        c0 = 340.0  # m/s\n        L = 1.0     # m\n        x0 = 0.2    # m\n        sigma = 0.05 # m\n        A = 1.0e-3  # a.u. (small amplitude)\n\n        # Numerical parameters\n        Nx = 801  # Number of grid points for high resolution\n        dx = L / (Nx - 1)\n        x_grid = np.linspace(0, L, Nx)\n        CFL = 0.9\n\n        # Case-specific parameters based on Mach number\n        U0 = M * c0\n        v1 = U0 + c0  # Characteristic speed for L1 (right-running)\n        v2 = U0 - c0  # Characteristic speed for L2 (left-running)\n\n        # Time-stepping setup\n        # The simulation must run long enough to capture the entire pulse interaction at x=L\n        t_final = 0.006  # seconds, empirically chosen to be sufficient for all cases\n        dt = CFL * dx / max(abs(v1), abs(v2))\n        num_steps = int(t_final / dt)\n        \n        # Characteristic variables arrays\n        L1 = A * np.exp(-(x_grid - x0)**2 / (2 * sigma**2))\n        L2 = np.zeros(Nx)\n\n        # Arrays to store the time history of characteristic variables at the right boundary (x=L)\n        L1_boundary_hist = np.zeros(num_steps + 1)\n        L2_boundary_hist = np.zeros(num_steps + 1)\n\n        # Courant numbers for the upwind scheme\n        C1 = v1 * dt / dx\n        C2 = v2 * dt / dx\n\n        # Main time-integration loop\n        for n in range(num_steps):\n            # Store the boundary values at the current time step\n            L1_boundary_hist[n] = L1[-1]\n            L2_boundary_hist[n] = L2[-1]\n\n            # Keep a copy of the arrays from the previous time step\n            L1_old = L1.copy()\n            L2_old = L2.copy()\n            \n            # --- Update interior points using first-order upwind scheme ---\n            \n            # L1 advects to the right (v1 > 0), so upwind from the left\n            L1[1:] = L1_old[1:] - C1 * (L1_old[1:] - L1_old[0:-1])\n            \n            # L2 advects to the left (v2  0 for M  1), so upwind from the right\n            L2[0:-1] = L2_old[0:-1] - C2 * (L2_old[1:] - L2_old[0:-1])\n\n            # --- Apply boundary conditions ---\n            \n            # Left boundary (x=0): non-injecting condition for incoming characteristic L1\n            L1[0] = 0.0\n            # Outgoing characteristic L2[0] is already updated from the interior\n\n            # Right boundary (x=L): reflection condition for incoming characteristic L2\n            # Outgoing characteristic L1[-1] is already updated from the interior\n            L2[-1] = r * L1[-1]\n        \n        # Store the final boundary values at t_final\n        L1_boundary_hist[-1] = L1[-1]\n        L2_boundary_hist[-1] = L2[-1]\n\n        # --- Energy Calculation ---\n        \n        # The energy is proportional to the time integral of the square of the characteristic variable.\n        # The constant of proportionality 1/(4*rho0*c0) cancels out in the ratio.\n        # We use trapezoidal integration for accuracy.\n        \n        # Incident energy corresponds to the right-running wave L1\n        E_inc = trapezoid(L1_boundary_hist**2, dx=dt)\n        \n        # Reflected energy corresponds to the left-running wave L2\n        E_ref = trapezoid(L2_boundary_hist**2, dx=dt)\n\n        # Avoid division by zero if no wave reaches the boundary (not expected here)\n        if E_inc == 0.0:\n            return 0.0\n        \n        # Compute the energy reflection ratio\n        R_E = E_ref / E_inc\n        return R_E\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0),   # Test 1: M, r\n        (0.4, 0.3),   # Test 2: M, r\n        (0.8, -0.5),  # Test 3: M, r\n        (0.2, 0.9),   # Test 4: M, r\n    ]\n\n    results = []\n    for M_case, r_case in test_cases:\n        R_E_case = solve_case(M_case, r_case)\n        # Append the result rounded to four decimal places as required.\n        results.append(f\"{R_E_case:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现实世界中的计算流体动力学（CFD）代码，特别是针对低速流动的代码，通常采用预处理技术来提高数值效率，但这会改变控制方程的特征结构。本实践将前一练习中的基本概念扩展到这些更复杂的预处理系统。您将学习如何基于预处理雅可比矩阵修正后的特征值和特征向量，来推导和实现无反射边界条件。",
            "id": "4011719",
            "problem": "考虑与计算燃烧学相关的一维理想气体线性化可压缩欧拉方程，该方程以原始变量形式，围绕均匀基态的小扰动进行描述。令原始变量向量为 $q = [\\rho, u, p]^T$，其中 $\\rho$ 是密度，$u$ 是速度，$p$ 是压力。围绕常数参考态 $(\\rho_0, u_0, p_0)$ 进行线性化，得到一个常系数双曲系统 $ \\partial_t q + A \\partial_x q = 0 $，其中原始变量形式的通量雅可比矩阵 $A$ 由下式给出\n$$\nA = \\begin{bmatrix}\nu_0  \\rho_0  0 \\\\\n0  u_0  \\frac{1}{\\rho_0} \\\\\n0  \\gamma p_0  u_0 \n\\end{bmatrix},\n$$\n其中理想气体声速为 $a_0 = \\sqrt{\\gamma p_0 / \\rho_0}$，比热比 $\\gamma$ 为常数。\n\n在低马赫数下，预处理会修正时间算子以缓解刚性问题。考虑一个作用于原始变量的对角预处理器，它对压力方程进行缩放，定义为\n$$\n\\Pi = \\mathrm{diag}\\left(1,\\,1,\\,\\frac{1}{\\beta^2}\\right),\n$$\n其中 Turkel 型预处理参数为\n$$\n\\beta(M) = \\max\\left(\\min\\left(M,\\,1\\right),\\,\\beta_{\\min}\\right), \\quad M = \\frac{|u_0|}{a_0}.\n$$\n预处理后的特征算子为 $ \\tilde{J} = \\Pi^{-1} A $。\n\n基于特征的无反射边界条件 (NRBC) 是通过将扰动相对于外向边界法线分解为特征变量来构建的。对于位于 $x = L$ 的右边界，外向法线沿着 $+x$ 方向。定义预处理雅可比矩阵 $ \\tilde{J} $ 的右特征向量矩阵 $\\tilde{R}$ 和左特征向量矩阵 $\\tilde{L} = \\tilde{R}^{-1}$，以及特征变量\n$$\nw = \\tilde{L}\\,(q - q_{\\mathrm{ref}}),\n$$\n其中 $q_{\\mathrm{ref}}$ 是一个已知的外部参考态。如果一个特征模态的右特征向量在速度或压力分量上具有非零项，则将其归类为“声学”模态；如果右特征向量仅投影到密度上，则将其归类为“熵/对流”模态。对于右边界，特征值 $\\lambda  0$ 的模态为“入射”模态，特征值 $\\lambda > 0$ 的模态为“出射”模态。\n\n设计一个边界更新方案，通过将入射声学模态的特征振幅设置为零来消除它们，同时保持出射模态和熵/对流模态不变：\n$$\nw_i^{\\mathrm{new}} =\n\\begin{cases}\n0,  \\text{若模态 $i$ 是声学模态且是入射的（即 $\\lambda_i  0$），} \\\\\nw_i,  \\text{其他情况。}\n\\end{cases}\n$$\n通过以下方式重构修正后的边界扰动和状态：\n$$\n(q - q_{\\mathrm{ref}})^{\\mathrm{new}} = \\tilde{R}\\,w^{\\mathrm{new}}, \\qquad q_{\\mathrm{boundary}} = q_{\\mathrm{ref}} + (q - q_{\\mathrm{ref}})^{\\mathrm{new}}.\n$$\n\n使用所提供的参数，以数值方式实现此过程，并计算每个测试案例修正后的边界压力 $p_{\\mathrm{boundary}}$（单位：帕斯卡）。使用以下具有科学合理值的测试套件：\n\n- 测试案例 1 (亚声速出流)：$\\rho_0 = 1.2$ 千克/立方米 (kg/m^3)，$u_0 = 40$ 米/秒 (m/s)，$p_0 = 101325$ 帕斯卡 (Pa)，$\\gamma = 1.4$，内部状态 $q_{\\mathrm{int}} = [1.19, 41.0, 101625]^T$，参考 $q_{\\mathrm{ref}} = [1.2, 40.0, 101325]^T$，以及 $\\beta_{\\min} = 0.05$。\n- 测试案例 2 (超声速出流，此时预处理不起作用)：$\\rho_0 = 1.0$ kg/m^3，$u_0 = 800.0$ m/s，$p_0 = 100000.0$ Pa，$\\gamma = 1.4$，$q_{\\mathrm{int}} = [1.01, 795.0, 99500.0]^T$，$q_{\\mathrm{ref}} = [1.0, 800.0, 100000.0]^T$，以及 $\\beta_{\\min} = 0.05$。\n- 测试案例 3 (近零马赫数出流)：$\\rho_0 = 1.0$ kg/m^3，$u_0 = 5.0$ m/s，$p_0 = 100000.0$ Pa，$\\gamma = 1.4$，$q_{\\mathrm{int}} = [1.02, 6.5, 100250.0]^T$，$q_{\\mathrm{ref}} = [1.0, 5.0, 100000.0]^T$，以及 $\\beta_{\\min} = 0.05$。\n- 测试案例 4 (负速度入流)：$\\rho_0 = 1.0$ kg/m^3，$u_0 = -20.0$ m/s，$p_0 = 100000.0$ Pa，$\\gamma = 1.4$，$q_{\\mathrm{int}} = [0.98, -18.5, 99800.0]^T$，$q_{\\mathrm{ref}} = [1.0, -20.0, 100000.0]^T$，以及 $\\beta_{\\min} = 0.05$。\n\n算法要求：\n- 计算 $a_0 = \\sqrt{\\gamma p_0/\\rho_0}$、$M = |u_0|/a_0$ 和 $\\beta = \\max(\\min(M, 1), \\beta_{\\min})$。\n- 构建 $A$ 和 $\\Pi^{-1} = \\mathrm{diag}(1, 1, \\beta^2)$，然后得到 $\\tilde{J} = \\Pi^{-1} A$。\n- 计算 $\\tilde{J}$ 的特征值和右特征向量，构建 $\\tilde{L} = \\tilde{R}^{-1}$，以及 $\\Delta q = q_{\\mathrm{int}} - q_{\\mathrm{ref}}$ 的特征振幅 $w$。\n- 将 $w$ 的所有入射声学分量置零，并重构 $q_{\\mathrm{boundary}}$。\n\n您的程序应生成单行输出，其中包含以逗号分隔的帕斯卡单位的结果列表，并用方括号括起，每个值格式化为六位小数，例如：“[p1,p2,p3,p4]”。",
            "solution": "该问题要求为一维线性化可压缩欧拉方程实现一种基于特征的无反射边界条件 (NRBC)，并结合低马赫数预处理器。目标是根据内部数据和参考态，通过选择性地消除入射声波来计算边界上的修正压力。\n\n该过程基于双曲型偏微分方程的理论。系统 $\\partial_t q + A \\partial_x q = 0$ 可以通过变量变换，从原始变量 $q$ 变换为一组特征变量 $w$ 来实现对角化。每个特征变量对应一个波，其传播速度由通量雅可比矩阵 $A$ 的一个特征值给出。在边界处，这些波中的一些会传播出计算域（出射波），而另一些则会传播入计算域（入射波）。无反射边界条件旨在允许出射波无障碍地穿过边界，同时防止虚假的、非物理的波从外部反射或进入。\n\n这是通过为入射特征变量指定边界数据来实现的。一种常见且有效的 NRBC 方法是，将入射特征扰动的振幅设置为零，尤其是在外部状态已知或假定为静止时。然后，根据修正后的特征变量集重构边界状态，该变量集现在仅包含源于计算域内部的出射波的贡献以及任何指定的物理入射信息。\n\n在低马赫数流动的背景下，例如计算燃烧学中经常遇到的情况，欧拉方程会变得刚性。这是因为声波速度 ($u_0 \\pm a_0$) 远大于对流速度 ($u_0$)，导致通量雅可比矩阵的特征值范围差异巨大。这种刚性对显式数值方法施加了严格的时间步长限制。Turkel 型预处理通过修改时间导数项来解决这个问题，对于常系数系统，这等效于用矩阵 $\\Pi^{-1}$ 左乘通量雅可比矩阵。这里，$\\Pi = \\mathrm{diag}(1, 1, 1/\\beta^2)$ 对压力方程进行缩放，在低马赫数下，有效地将修正后系统中的声波速度减慢到与流速同一量级。参数 $\\beta$ 是马赫数 $M = |u_0|/a_0$ 的函数，其设计意图是仅在低马赫数下起作用（$\\beta \\ll 1$），而在 $M \\ge 1$ 时关闭（$\\beta = 1$），从而恢复为原始欧拉方程。\n\n因此，必须对预处理雅可比矩阵 $\\tilde{J} = \\Pi^{-1} A$ 进行 NRBC 的特征分析。实现指定边界条件的步骤如下：\n\n1.  **参数计算**：对于每个测试案例，使用平均流参数 $(\\rho_0, u_0, p_0)$ 和比热比 $\\gamma$ 来计算声速 $a_0 = \\sqrt{\\gamma p_0 / \\rho_0}$、马赫数 $M = |u_0|/a_0$ 和预处理参数 $\\beta = \\max(\\min(M, 1), \\beta_{\\min})$。\n\n2.  **矩阵构建**：构建原始变量通量雅可比矩阵 $A$ 和预处理矩阵的逆 $\\Pi^{-1}$。然后计算预处理雅可比矩阵 $\\tilde{J} = \\Pi^{-1} A$。\n    $$\n    A = \\begin{bmatrix} u_0  \\rho_0  0 \\\\ 0  u_0  1/\\rho_0 \\\\ 0  \\gamma p_0  u_0 \\end{bmatrix}, \\quad \\Pi^{-1} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\beta^2 \\end{bmatrix} \\implies \\tilde{J} = \\Pi^{-1} A = \\begin{bmatrix} u_0  \\rho_0  0 \\\\ 0  u_0  1/\\rho_0 \\\\ 0  \\beta^2 \\gamma p_0  u_0 \\end{bmatrix}\n    $$\n\n3.  **特征分解**：计算 $\\tilde{J}$ 的特征值 $\\lambda_i$ 和右特征向量（矩阵 $\\tilde{R}$ 的列）。$\\tilde{J}$ 的特征值为 $\\lambda_1 = u_0$、$\\lambda_2 = u_0 + \\beta a_0$ 和 $\\lambda_3 = u_0 - \\beta a_0$。它们代表了预处理特征波的速度。通过对右特征向量矩阵求逆得到左特征向量矩阵，即 $\\tilde{L} = \\tilde{R}^{-1}$。\n\n4.  **特征分解**：边界上的扰动由内部状态 $q_{\\mathrm{int}}$ 与外部参考态 $q_{\\mathrm{ref}}$ 之差来近似，即 $\\Delta q = q_{\\mathrm{int}} - q_{\\mathrm{ref}}$。通过计算特征振幅向量 $w = \\tilde{L} \\Delta q$，将此扰动投影到特征基上。\n\n5.  **边界条件应用**：NRBC 的核心是识别并消除入射声学模态。在右边界（外法线方向为 $+x$），如果一个模态的传播速度（特征值）$\\lambda_i$ 为负，则该模态为入射模态。如果一个模态对应的右特征向量在速度或压力变量上有非零分量，则该模态被归类为声学模态。问题指明，熵/对流模态（对应于 $\\lambda_1 = u_0$）的右特征向量与 $[1, 0, 0]^T$ 成正比。其他两个模态是声学模态。通过对每个既是声学模态又是入射模态的模态 $i$ 设置 $w_i^{\\mathrm{new}} = 0$，而对其他模态保持 $w_i^{\\mathrm{new}} = w_i$，形成一个新的特征振幅向量 $w^{\\mathrm{new}}$。\n\n6.  **状态重构**：通过将 $w^{\\mathrm{new}}$ 从特征基变换回来，重构原始变量中的修正扰动：$\\Delta q^{\\mathrm{new}} = \\tilde{R} w^{\\mathrm{new}}$。\n\n7.  **最终边界状态**：通过将修正后的扰动加到参考态上，获得最终的边界状态：$q_{\\mathrm{boundary}} = q_{\\mathrm{ref}} + \\Delta q^{\\mathrm{new}}$。所需的输出是该向量的压力分量 $p_{\\mathrm{boundary}}$。\n\n此过程被系统地应用于每个测试案例，以确定修正后的边界压力。使用数值线性代数程序进行特征分解和矩阵求逆。必须注意正确识别数值特征求解器返回的模态，并应用指定的逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the non-reflecting boundary condition problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Subsonic outflow\n        {'rho0': 1.2, 'u0': 40.0, 'p0': 101325.0, 'gamma': 1.4,\n         'q_int': np.array([1.19, 41.0, 101625.0]), 'q_ref': np.array([1.2, 40.0, 101325.0]), 'beta_min': 0.05},\n        # Case 2: Supersonic outflow\n        {'rho0': 1.0, 'u0': 800.0, 'p0': 100000.0, 'gamma': 1.4,\n         'q_int': np.array([1.01, 795.0, 99500.0]), 'q_ref': np.array([1.0, 800.0, 100000.0]), 'beta_min': 0.05},\n        # Case 3: Near-zero Mach outflow\n        {'rho0': 1.0, 'u0': 5.0, 'p0': 100000.0, 'gamma': 1.4,\n         'q_int': np.array([1.02, 6.5, 100250.0]), 'q_ref': np.array([1.0, 5.0, 100000.0]), 'beta_min': 0.05},\n        # Case 4: Inflow\n        {'rho0': 1.0, 'u0': -20.0, 'p0': 100000.0, 'gamma': 1.4,\n         'q_int': np.array([0.98, -18.5, 99800.0]), 'q_ref': np.array([1.0, -20.0, 100000.0]), 'beta_min': 0.05},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p_boundary = calculate_boundary_pressure(case)\n        results.append(f\"{p_boundary:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_boundary_pressure(params):\n    \"\"\"\n    Implements the characteristic-based NRBC procedure for a single case.\n    \"\"\"\n    rho0 = params['rho0']\n    u0 = params['u0']\n    p0 = params['p0']\n    gamma = params['gamma']\n    q_int = params['q_int']\n    q_ref = params['q_ref']\n    beta_min = params['beta_min']\n    \n    # 1. Parameter Calculation\n    a0 = np.sqrt(gamma * p0 / rho0)\n    M = np.abs(u0) / a0\n    beta = max(min(M, 1.0), beta_min)\n\n    # 2. Matrix Formulation\n    A = np.array([\n        [u0, rho0, 0],\n        [0, u0, 1/rho0],\n        [0, gamma * p0, u0]\n    ])\n    \n    Pi_inv = np.diag([1.0, 1.0, beta**2])\n    J_tilde = Pi_inv @ A\n\n    # 3. Eigen-Decomposition\n    # eigenvalues and right eigenvectors\n    # W contains eigenvectors as columns\n    eigenvalues, R_tilde = np.linalg.eig(J_tilde)\n    # left eigenvectors are rows of inv(W)\n    L_tilde = np.linalg.inv(R_tilde)\n    \n    # 4. Characteristic Decomposition\n    delta_q = q_int - q_ref\n    w = L_tilde @ delta_q\n\n    # 5. Boundary Condition Application\n    w_new = w.copy()\n    \n    for i in range(len(eigenvalues)):\n        lambda_i = eigenvalues[i]\n        r_i = R_tilde[:, i]\n\n        # Identify mode type: check if velocity or pressure components are non-zero\n        # The entropy mode has an eigenvector proportional to [1, 0, 0]^T\n        is_acoustic = not np.allclose(r_i[1:], [0, 0], atol=1e-9)\n        \n        # Identify incoming modes for a right boundary\n        is_incoming = lambda_i  0\n\n        # Apply NRBC rule\n        if is_acoustic and is_incoming:\n            w_new[i] = 0.0\n\n    # 6. State Reconstruction\n    delta_q_new = R_tilde @ w_new\n    \n    # 7. Final Boundary State\n    q_boundary = q_ref + delta_q_new\n    p_boundary = q_boundary[2]\n    \n    return p_boundary\n\nsolve()\n\n```"
        },
        {
            "introduction": "一个有效的边界条件必须是鲁棒和稳定的，即使在面对非理想流动现象（如出口处的间歇性回流）时也是如此。这个高级实践超越了理想的出口流动场景，旨在解决边界稳定性的关键问题。通过能量分析，您将推导并实现一种自适应边界条件，它能主动防止由回流引起的数值不稳定性。",
            "id": "4011771",
            "problem": "考虑在均匀基态附近计算燃烧学中使用的一维线性化等熵可压缩流模型。设基态密度为 $\\rho_0$，基态声速为 $a_0$，出口处的基态法向速度为 $u_n$。速度和压力的微小扰动（分别表示为 $u'$ 和 $p'$）满足通过将可压缩欧拉方程线性化而得到的对流声学系统（使用等熵封闭关系 $p' = a_0^2 \\rho'$）。该问题关注一个受间歇性回流事件（即法向速度 $u_n$ 暂时变为负值的时刻）影响的压力出口，以及设计基于特征的无反射边界条件，以防止扰动能量的无界增长。\n\n从线性化控制方程和扰动能量的定义出发，您的任务是：\n- 推导扰动的能量平衡方程，用能量密度和边界产生项表示。用特征变量和基流参数表示边界产生项。\n- 定义均匀基态附近的一维对流声学系统的特征变量 $c_+$ 和 $c_-$，并根据特征速度（用 $u_n$ 和 $a_0$ 表示）对其传播方向进行分类。\n- 在出口处提出一个单参数的基于特征的边界封闭，形式为“入射特征等于出射特征的倍数”，即 $c_{\\text{in}} = r\\,c_{\\text{out}}$，其中 $0 \\le r \\le 1$。当 $u_n \\ge 0$ 时，该条件作为无反射条件；当 $u_n  0$ 时，作为一种稳定化修正。\n- 从第一性原理出发，说明 $r$ 的选择如何影响边界能量产生。然后，推导出关于 $r$ 的一个条件（作为 $u_n$ 和 $a_0$ 的函数），该条件保证边界能量产生为非正，从而确保即使在 $u_n  0$ 时，扰动能量也不会因边界而瞬时增长。提出一个可实现的自适应规则 $r_{\\text{eff}}(u_n)$，该规则在遵守 $0 \\le r_{\\text{eff}} \\le 1$ 的同时强制执行此条件。\n\n实现要求：\n- 使用您推导的表达式，编写一个完整的、可运行的程序，为每个测试用例计算单位面积的边界能量产生 $B$，单位为 $\\mathrm{W/m^2}$，定义为与出口处扰动相关的向外能量通量。假设单位幅度的出射特征扰动大小为 $A_c$，为每个测试用例指定（单位为 $\\mathrm{m/s}$，因为每个特征变量是速度和声学速度势 $p' / (\\rho_0 a_0)$ 的和或差）。对入射特征乘数使用您的自适应规则 $r_{\\text{eff}}(u_n)$。\n- 程序必须实现以下针对亚音速条件 $|u_n|  a_0$ 的决策逻辑：当 $u_n \\ge 0$ 时，使用 $r_{\\text{eff}} = r_0$；当 $u_n  0$ 时，根据您推导的界限计算 $r_{\\text{eff}}$ 以确保非负的边界能量产生，并设置 $r_{\\text{eff}} = \\min(r_0, r_{\\text{bound}}(u_n,a_0))$，裁剪到 $[0,1]$ 范围内。对 $u_n$ 使用外法线约定。\n\n物理单位和输出规范：\n- 将每个计算出的单位面积边界能量产生 $B$ 以 $\\mathrm{W/m^2}$ 表示，并由编程语言的默认浮点表示进行四舍五入（不要在输出中格式化或标注单位）。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来，例如 $[b_1,b_2,b_3,\\dots]$。\n\n测试套件：\n使用以下参数集，每个参数集指定为一个元组 $(\\rho_0, a_0, u_n, r_0, A_c)$，其中 $\\rho_0$ 单位为 $\\mathrm{kg/m^3}$，$a_0$ 和 $u_n$ 单位为 $\\mathrm{m/s}$，$A_c$ 单位为 $\\mathrm{m/s}$。\n- 案例 $1$（亚音速流出“理想情况”）：$(1.20, 340.0, 50.0, 0.20, 0.10)$。\n- 案例 $2$（轻度亚音速回流）：$(1.20, 340.0, -5.0, 0.20, 0.10)$。\n- 案例 $3$（中度亚音速回流）：$(1.20, 340.0, -150.0, 0.50, 0.10)$。\n- 案例 $4$（近音速的亚音速回流边缘情况）：$(1.20, 340.0, -330.0, 0.90, 0.10)$。\n- 案例 $5$（零平均法向速度边界）：$(1.20, 340.0, 0.0, 0.70, 0.10)$。\n\n您的程序必须计算并返回列表 $[B_1,B_2,B_3,B_4,B_5]$，其中每个 $B_i$ 是对应案例的单位面积边界能量产生，单位为 $\\mathrm{W/m^2}$，使用您推导的自适应特征修正方法。输出必须是单行，且列表格式与指定完全一致。",
            "solution": "该问题的解决方案要求从一维线性化欧拉方程出发，推导出一个能量稳定的自适应边界条件，并将其应用于给定的测试案例。\n\n### A. 线性化方程和能量平衡\n\n首先，我们从一维线性化欧拉方程的连续性和动量方程开始，对于围绕均匀基态 $(\\rho_0, u_n, p_0)$ 的扰动 $(\\rho', u', p')$：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_n \\frac{\\partial \\rho'}{\\partial x} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n$$\n\\rho_0 \\left( \\frac{\\partial u'}{\\partial t} + u_n \\frac{\\partial u'}{\\partial x} \\right) + \\frac{\\partial p'}{\\partial x} = 0\n$$\n使用等熵关系 $p' = a_0^2 \\rho'$，我们可以用压力和速度扰动来表示这些方程。扰动能量密度 $E$ 是动能和声学势能之和：\n$$\nE = \\frac{1}{2} \\rho_0 (u')^2 + \\frac{1}{2} \\frac{(p')^2}{\\rho_0 a_0^2}\n$$\n通过对 $E$ 求时间导数并代入控制方程，我们可以推导出能量守恒定律：\n$$\n\\frac{\\partial E}{\\partial t} + \\frac{\\partial F}{\\partial x} = 0\n$$\n其中，能量通量 $F$ 为：\n$$\nF = u_n E + p' u'\n$$\n问题中定义的边界能量产生 $B$ 就是在出口边界处向外的能量通量，即 $B = F|_{\\text{出口}}$。\n\n### B. 特征变量\n\n为了将系统对角化，我们定义了具有速度单位的声学特征变量：\n$$\nc_+ = \\frac{p'}{\\rho_0 a_0} + u' \\quad \\text{和} \\quad c_- = \\frac{p'}{\\rho_0 a_0} - u'\n$$\n这些变量解耦了原始方程组，各自满足简单的平流方程。变量 $c_+$ 以特征速度 $\\lambda_+ = u_n + a_0$ 传播，而 $c_-$ 以 $\\lambda_- = u_n - a_0$ 传播。\n\n在亚音速出口边界（$|u_n|  a_0$），$\\lambda_+ > 0$ 且 $\\lambda_-  0$。因此，$c_+$ 是出射特征 ($c_{\\text{out}}$)，$c_-$ 是入射特征 ($c_{\\text{in}}$)。\n$$\nc_{\\text{out}} = c_+, \\quad c_{\\text{in}} = c_-\n$$\n\n### C. 以特征变量表示的边界能量产生\n\n我们可以用特征变量 $c_+$ 和 $c_-$ 来表示原始变量 $p'$ 和 $u'$：\n$$\np' = \\frac{\\rho_0 a_0}{2}(c_+ + c_-), \\quad u' = \\frac{1}{2}(c_+ - c_-)\n$$\n将这些关系代入能量通量 $F$ 的表达式中，得到：\n$$\nB = F|_{\\text{出口}} = u_n \\frac{\\rho_0}{4} (c_+^2 + c_-^2) + \\frac{\\rho_0 a_0}{4} (c_+^2 - c_-^2)\n$$\n$$\nB = \\frac{\\rho_0}{4} \\left[ (u_n+a_0)c_+^2 - (a_0-u_n)c_-^2 \\right]\n$$\n\n### D. 稳定条件和自适应规则\n\n现在应用边界条件 $c_{\\text{in}} = r c_{\\text{out}}$，即 $c_- = r c_+$:\n$$\nB = \\frac{\\rho_0}{4} c_+^2 \\left[ (u_n+a_0) - (a_0-u_n)r^2 \\right]\n$$\n为了确保数值稳定性，我们要求边界不能自发产生扰动能量，即向外的能量通量必须为非负，$B \\ge 0$。由于 $\\frac{\\rho_0}{4} c_+^2 \\ge 0$，这等价于：\n$$\n(u_n+a_0) - (a_0-u_n)r^2 \\ge 0 \\implies r^2 \\le \\frac{a_0+u_n}{a_0-u_n}\n$$\n由于 $r \\ge 0$，稳定条件为：\n$$\nr \\le \\sqrt{\\frac{a_0+u_n}{a_0-u_n}}\n$$\n- 对于流出 ($u_n \\ge 0$)，$\\frac{a_0+u_n}{a_0-u_n} \\ge 1$，因此任何 $r \\in [0, 1]$ 都是稳定的。\n- 对于回流 ($u_n  0$)，该条件对 $r$ 施加了非平凡的约束，以防止能量增长。\n\n基于此，我们构建自适应规则 $r_{\\text{eff}}(u_n)$：\n- 如果 $u_n \\ge 0$，使用用户指定的理想反射系数：$r_{\\text{eff}} = r_0$。\n- 如果 $u_n  0$，为保证稳定，必须选择一个满足上述条件的 $r$。我们取用户指定的 $r_0$ 和稳定性界限中的较小者：\n$$\nr_{\\text{eff}} = \\min\\left(r_0, \\sqrt{\\frac{a_0+u_n}{a_0-u_n}}\\right)\n$$\n这个规则确保了即使在回流情况下，边界条件也不会导致数值不稳定性。\n\n### 实现\n程序将实现此逻辑。对于每个测试案例，它首先根据 $u_n$ 的符号计算 $r_{\\text{eff}}$。然后，给定出射特征振幅 $A_c$（即 $c_+ = A_c$），使用最终公式计算边界能量产生 $B$：\n$$\nB = \\frac{\\rho_0}{4} A_c^2 \\left[ (a_0+u_n) - (a_0-u_n)r_{\\text{eff}}^2 \\right]\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.20, 340.0, 50.0, 0.20, 0.10),   # Case 1\n        (1.20, 340.0, -5.0, 0.20, 0.10),   # Case 2\n        (1.20, 340.0, -150.0, 0.50, 0.10), # Case 3\n        (1.20, 340.0, -330.0, 0.90, 0.10), # Case 4\n        (1.20, 340.0, 0.0, 0.70, 0.10),    # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        rho0, a0, un, r0, Ac = case\n\n        # Determine the effective reflection coefficient r_eff based on the adaptive rule\n        if un >= 0:\n            # For outflow or zero mean velocity, use the specified reflection coefficient r0\n            r_eff = r0\n        else: # un  0 (backflow)\n            # Ensure the argument of the square root is non-negative.\n            # For backflow (|un|  a0), we have -a0  un  0, so a0 + un > 0 and a0 - un > 0.\n            # Thus, the argument is always positive.\n            r_bound = np.sqrt((a0 + un) / (a0 - un))\n            \n            # Use the smaller of r0 and the stability-derived bound r_bound\n            r_eff = np.minimum(r0, r_bound)\n            \n            # Per problem spec, clip the result to the range [0, 1].\n            # This is technically redundant given the problem constraints (0=r0=1 and r_bound is in [0,1)),\n            # but it is good practice to enforce it explicitly.\n            r_eff = np.clip(r_eff, 0.0, 1.0)\n\n        # Calculate the boundary energy production per unit area, B\n        # This formula was derived from first principles in the solution text.\n        # B = (rho0 / 4) * Ac^2 * [ (a0 + un) - (a0 - un) * r_eff^2 ]\n        \n        term1 = a0 + un\n        term2 = (a0 - un) * r_eff**2\n        \n        B = (rho0 / 4.0) * (Ac**2) * (term1 - term2)\n        \n        results.append(B)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}