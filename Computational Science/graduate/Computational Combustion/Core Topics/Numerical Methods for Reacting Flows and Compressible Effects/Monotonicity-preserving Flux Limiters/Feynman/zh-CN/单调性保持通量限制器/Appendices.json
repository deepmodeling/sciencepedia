{
    "hands_on_practices": [
        {
            "introduction": "要掌握通量限制器，首先必须理解其核心机制：限制器函数 $\\phi(r)$。本练习将指导您使用一个简单的正弦波廓线，为几种常见的限制器计算 $\\phi(r)$ 的值。通过这个过程，您将直接观察到这些函数如何在解的光滑区域保持高精度，但在波峰和波谷附近则策略性地降低精度以防止振荡，这正是高分辨率格式的精髓所在。",
            "id": "4042834",
            "problem": "考虑一个一维线性平流问题，研究对象是一个被动标量，代表了预混火焰中的混合分数。该过程由标量守恒律 $u_{t} + a\\,u_{x} = 0$ 建模，其中平流速度 $a > 0$ 为常数。在一个间距为 $\\Delta x$、节点为 $x_{i} = i\\,\\Delta x$ 的均匀网格上，采用高分辨率的守恒律单调上游格式 (MUSCL) 进行重构，并使用一个保持单调性的总变差递减 (TVD) 限制器。定义离散斜率比\n$$\nr_{i} = \\frac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}},\n$$\n以及三种广泛使用的通量限制器函数 $\\phi(r)$：\n- minmod 限制器 $\\phi_{\\mathrm{mm}}(r) = \\max\\!\\big(0, \\min(1, r)\\big)$，\n- 单调中心 (MC) 限制器 $\\phi_{\\mathrm{MC}}(r) = \\max\\!\\big(0, \\min\\!\\big(\\tfrac{1+r}{2},\\, 2,\\, 2r\\big)\\big)$，\n- van Leer 限制器 $\\phi_{\\mathrm{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$。\n\n假设在区间 $[0, \\pi]$（单位为弧度）上，有一个光滑剖面 $u(x) = \\sin(x)$ 在粗网格 $x_{i} = i\\,\\Delta x$ 上进行采样，其中 $\\Delta x = \\pi/6$。对于网格指数 $i = 1$、$i = 3$ 和 $i = 5$，请执行以下操作：\n1. 精确计算 $r_{i}$ 并求出 $\\phi_{\\mathrm{mm}}(r_{i})$、$\\phi_{\\mathrm{MC}}(r_{i})$ 和 $\\phi_{\\mathrm{VL}}(r_{i})$ 的值。\n2. 使用基于泰勒级数的一致性论证，针对平流速度为正的 MUSCL 重构，估计这三个点处的局部截断误差阶 $p_{i}$。\n\n请提供有序元组\n$$\n\\big(r_{1},\\, \\phi_{\\mathrm{mm}}(r_{1}),\\, \\phi_{\\mathrm{MC}}(r_{1}),\\, \\phi_{\\mathrm{VL}}(r_{1}),\\, p_{1},\\, r_{3},\\, \\phi_{\\mathrm{mm}}(r_{3}),\\, \\phi_{\\mathrm{MC}}(r_{3}),\\, \\phi_{\\mathrm{VL}}(r_{3}),\\, p_{3},\\, r_{5},\\, \\phi_{\\mathrm{mm}}(r_{5}),\\, \\phi_{\\mathrm{MC}}(r_{5}),\\, \\phi_{\\mathrm{VL}}(r_{5}),\\, p_{5}\\big)\n$$\n的最终结果。无需四舍五入；请报告精确的解析值。角度单位为弧度，所有量均为无量纲量。",
            "solution": "该问题陈述科学严谨、适定、客观且自洽。它提出了一个关于双曲守恒律数值方法分析的标准练习，特别关注于保单调性通量限制器的行为。所有给出的定义、方程和数据都是计算流体力学领域的标准内容，没有矛盾或含糊之处。因此，该问题是有效的，可以构建解答。\n\n解答需要完成两个主要任务：首先，计算指定网格点上的斜率比 $r_i$ 和相应的限制器值 $\\phi(r_i)$；其次，确定这些点上的局部精度阶 $p_i$。\n\n首先，我们在均匀网格 $x_i = i\\,\\Delta x$（其中 $\\Delta x = \\pi/6$）上确定函数 $u(x) = \\sin(x)$ 的离散值。计算 $i \\in \\{1, 3, 5\\}$ 处的斜率比所需的值为 $u_0, u_1, u_2, u_3, u_4, u_5$ 和 $u_6$。\n$u_0 = \\sin(0 \\cdot \\pi/6) = \\sin(0) = 0$\n$u_1 = \\sin(1 \\cdot \\pi/6) = \\sin(\\pi/6) = 1/2$\n$u_2 = \\sin(2 \\cdot \\pi/6) = \\sin(\\pi/3) = \\sqrt{3}/2$\n$u_3 = \\sin(3 \\cdot \\pi/6) = \\sin(\\pi/2) = 1$\n$u_4 = \\sin(4 \\cdot \\pi/6) = \\sin(2\\pi/3) = \\sqrt{3}/2$\n$u_5 = \\sin(5 \\cdot \\pi/6) = \\sin(5\\pi/6) = 1/2$\n$u_6 = \\sin(6 \\cdot \\pi/6) = \\sin(\\pi) = 0$\n\n现在，我们计算每个指数 $i$ 所需的量。\n\n**网格指数 $i=1$ 处的分析**\n\n斜率比 $r_1$ 定义为：\n$$\nr_1 = \\frac{u_1 - u_0}{u_2 - u_1} = \\frac{1/2 - 0}{\\sqrt{3}/2 - 1/2} = \\frac{1/2}{(\\sqrt{3}-1)/2} = \\frac{1}{\\sqrt{3}-1}\n$$\n对分母进行有理化：\n$$\nr_1 = \\frac{1}{\\sqrt{3}-1} \\cdot \\frac{\\sqrt{3}+1}{\\sqrt{3}+1} = \\frac{\\sqrt{3}+1}{3-1} = \\frac{\\sqrt{3}+1}{2}\n$$\n由于 $\\sqrt{3} \\approx 1.732$，所以 $r_1 \\approx (1.732+1)/2 = 1.366$。\n\n现在我们计算 $r_1$ 对应的通量限制器值：\n1.  minmod 限制器：$\\phi_{\\mathrm{mm}}(r) = \\max(0, \\min(1, r))$。\n    由于 $r_1 = \\frac{\\sqrt{3}+1}{2}  1$，我们有 $\\min(1, r_1) = 1$。\n    $$\n    \\phi_{\\mathrm{mm}}(r_1) = \\max(0, 1) = 1\n    $$\n2.  单调中心 (MC) 限制器：$\\phi_{\\mathrm{MC}}(r) = \\max(0, \\min(\\frac{1+r}{2}, 2, 2r))$。\n    我们计算 $\\min$ 函数的参数：\n    $\\frac{1+r_1}{2} = \\frac{1 + (\\sqrt{3}+1)/2}{2} = \\frac{(2+\\sqrt{3}+1)/2}{2} = \\frac{3+\\sqrt{3}}{4}$。\n    $2r_1 = 2 \\cdot \\frac{\\sqrt{3}+1}{2} = \\sqrt{3}+1$。\n    我们必须比较 $\\frac{3+\\sqrt{3}}{4}$、$2$ 和 $\\sqrt{3}+1$。由于 $\\sqrt{3} \\approx 1.732$，所以 $\\frac{3+\\sqrt{3}}{4} \\approx 1.183$ 且 $\\sqrt{3}+1 \\approx 2.732$。\n    因此，$\\min(\\frac{3+\\sqrt{3}}{4}, 2, \\sqrt{3}+1) = \\frac{3+\\sqrt{3}}{4}$。\n    $$\n    \\phi_{\\mathrm{MC}}(r_1) = \\max\\left(0, \\frac{3+\\sqrt{3}}{4}\\right) = \\frac{3+\\sqrt{3}}{4}\n    $$\n3.  van Leer 限制器：$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$。\n    由于 $r_1  0$，该式简化为 $\\phi_{\\mathrm{VL}}(r_1) = \\frac{2r_1}{1+r_1}$。\n    $$\n    \\phi_{\\mathrm{VL}}(r_1) = \\frac{2 \\cdot \\frac{\\sqrt{3}+1}{2}}{1 + \\frac{\\sqrt{3}+1}{2}} = \\frac{\\sqrt{3}+1}{(2+\\sqrt{3}+1)/2} = \\frac{2(\\sqrt{3}+1)}{3+\\sqrt{3}}\n    $$\n    对分母进行有理化：\n    $$\n    \\phi_{\\mathrm{VL}}(r_1) = \\frac{2(\\sqrt{3}+1)(3-\\sqrt{3})}{(3+\\sqrt{3})(3-\\sqrt{3})} = \\frac{2(3\\sqrt{3}-3+3-\\sqrt{3})}{9-3} = \\frac{2(2\\sqrt{3})}{6} = \\frac{2\\sqrt{3}}{3}\n    $$\n\n**网格指数 $i=3$ 处的分析**\n\n斜率比 $r_3$ 为：\n$$\nr_3 = \\frac{u_3 - u_2}{u_4 - u_3} = \\frac{1 - \\sqrt{3}/2}{\\sqrt{3}/2 - 1} = \\frac{-( \\sqrt{3}/2 - 1)}{\\sqrt{3}/2 - 1} = -1\n$$\n现在我们计算 $r_3 = -1$ 对应的通量限制器值：\n1.  minmod 限制器：$\\phi_{\\mathrm{mm}}(-1) = \\max(0, \\min(1, -1)) = \\max(0, -1) = 0$。\n2.  MC 限制器：$\\phi_{\\mathrm{MC}}(-1) = \\max(0, \\min(\\frac{1+(-1)}{2}, 2, 2(-1))) = \\max(0, \\min(0, 2, -2)) = \\max(0, -2) = 0$。\n3.  van Leer 限制器：$\\phi_{\\mathrm{VL}}(-1) = \\frac{-1 + |-1|}{1 + |-1|} = \\frac{-1+1}{1+1} = \\frac{0}{2} = 0$。\n$$\n\\phi_{\\mathrm{mm}}(r_3) = 0, \\quad \\phi_{\\mathrm{MC}}(r_3) = 0, \\quad \\phi_{\\mathrm{VL}}(r_3) = 0\n$$\n\n**网格指数 $i=5$ 处的分析**\n\n斜率比 $r_5$ 为：\n$$\nr_5 = \\frac{u_5 - u_4}{u_6 - u_5} = \\frac{1/2 - \\sqrt{3}/2}{0 - 1/2} = \\frac{(1-\\sqrt{3})/2}{-1/2} = \\sqrt{3}-1\n$$\n由于 $\\sqrt{3} \\approx 1.732$，所以 $r_5 \\approx 0.732$。\n\n现在我们计算 $r_5$ 对应的通量限制器值：\n1.  minmod 限制器：$\\phi_{\\mathrm{mm}}(r) = \\max(0, \\min(1, r))$。\n    由于 $0  r_5  1$，我们有 $\\min(1, r_5) = r_5 = \\sqrt{3}-1$。\n    $$\n    \\phi_{\\mathrm{mm}}(r_5) = \\max(0, \\sqrt{3}-1) = \\sqrt{3}-1\n    $$\n2.  MC 限制器：$\\phi_{\\mathrm{MC}}(r) = \\max(0, \\min(\\frac{1+r}{2}, 2, 2r))$。\n    我们计算 $\\min$ 函数的参数：\n    $\\frac{1+r_5}{2} = \\frac{1 + (\\sqrt{3}-1)}{2} = \\frac{\\sqrt{3}}{2}$。\n    $2r_5 = 2(\\sqrt{3}-1) = 2\\sqrt{3}-2$。\n    我们必须比较 $\\frac{\\sqrt{3}}{2}$、$2$ 和 $2\\sqrt{3}-2$。由于 $\\sqrt{3} \\approx 1.732$，所以 $\\frac{\\sqrt{3}}{2} \\approx 0.866$ 且 $2\\sqrt{3}-2 \\approx 1.464$。\n    因此，$\\min(\\frac{\\sqrt{3}}{2}, 2, 2\\sqrt{3}-2) = \\frac{\\sqrt{3}}{2}$。\n    $$\n    \\phi_{\\mathrm{MC}}(r_5) = \\max\\left(0, \\frac{\\sqrt{3}}{2}\\right) = \\frac{\\sqrt{3}}{2}\n    $$\n3.  van Leer 限制器：$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$。\n    由于 $r_5  0$，该式简化为 $\\phi_{\\mathrm{VL}}(r_5) = \\frac{2r_5}{1+r_5}$。\n    $$\n    \\phi_{\\mathrm{VL}}(r_5) = \\frac{2(\\sqrt{3}-1)}{1 + (\\sqrt{3}-1)} = \\frac{2(\\sqrt{3}-1)}{\\sqrt{3}}\n    $$\n    对分母进行有理化：\n    $$\n    \\phi_{\\mathrm{VL}}(r_5) = \\frac{2(\\sqrt{3}-1)\\sqrt{3}}{\\sqrt{3}\\sqrt{3}} = \\frac{2(3-\\sqrt{3})}{3}\n    $$\n\n**局部截断误差阶 $p_i$ 的估计**\n\nMUSCL 类格式的局部精度阶 $p_i$ 取决于解的局部行为。这些格式被设计为高分辨率的，这意味着它们在解的光滑区域是二阶精度 ($p=2$)，但在局部极值点处会退化为一阶精度 ($p=1$)，以防止产生伪振荡，从而保持单调性。\n\n网格点 $x_i$ 处解的特性可以通过连续函数的一阶导数 $u'(x_i)$ 来确定。如果 $u'(x_i) \\neq 0$，则该点位于光滑的单调区域。如果 $u'(x_i)=0$，则该点是局部极值点。\n\n函数为 $u(x) = \\sin(x)$，其导数为 $u'(x) = \\cos(x)$。我们在感兴趣的点上计算该导数：\n-   当 $i=1$ 时，$x_1 = \\pi/6$。$u'(x_1) = \\cos(\\pi/6) = \\sqrt{3}/2 \\neq 0$。该点位于光滑区域。因此，局部截断误差为二阶。\n    $$\n    p_1 = 2\n    $$\n-   当 $i=3$ 时，$x_3 = 3\\pi/6 = \\pi/2$。$u'(x_3) = \\cos(\\pi/2) = 0$。该点对应于函数的局部极大值。为避免振荡，限制器将强制采用局部一阶重构。计算出的 $r_3 = -1$ 以及所有限制器值为零的结果证实了这种行为（格式局部退化为一阶上游格式）。\n    $$\n    p_3 = 1\n    $$\n-   当 $i=5$ 时，$x_5 = 5\\pi/6$。$u'(x_5) = \\cos(5\\pi/6) = -\\sqrt{3}/2 \\neq 0$。该点也位于光滑区域。因此，局部截断误差为二阶。\n    $$\n    p_5 = 2\n    $$\n\n将所有结果合并到指定的有序元组中，得到：\n$\\big(r_{1},\\, \\phi_{\\mathrm{mm}}(r_{1}),\\, \\phi_{\\mathrm{MC}}(r_{1}),\\, \\phi_{\\mathrm{VL}}(r_{1}),\\, p_{1},\\, r_{3},\\, \\phi_{\\mathrm{mm}}(r_{3}),\\, \\phi_{\\mathrm{MC}}(r_{3}),\\, \\phi_{\\mathrm{VL}}(r_{3}),\\, p_{3},\\, r_{5},\\, \\phi_{\\mathrm{mm}}(r_{5}),\\, \\phi_{\\mathrm{MC}}(r_{5}),\\, \\phi_{\\mathrm{VL}}(r_{5}),\\, p_{5}\\big)$\n$= \\big(\\frac{\\sqrt{3}+1}{2}, 1, \\frac{3+\\sqrt{3}}{4}, \\frac{2\\sqrt{3}}{3}, 2, -1, 0, 0, 0, 1, \\sqrt{3}-1, \\sqrt{3}-1, \\frac{\\sqrt{3}}{2}, \\frac{2(3-\\sqrt{3})}{3}, 2\\big)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sqrt{3}+1}{2}  1  \\frac{3+\\sqrt{3}}{4}  \\frac{2\\sqrt{3}}{3}  2  -1  0  0  0  1  \\sqrt{3}-1  \\sqrt{3}-1  \\frac{\\sqrt{3}}{2}  \\frac{2(3-\\sqrt{3})}{3}  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "光滑廓线虽然具有启发性，但对限制器的真正考验在于其在尖锐间断（如火焰锋面或激波）处的性能。本练习聚焦于一个阶跃廓线，以展示限制器如何果断地阻止伪振荡的产生。您将看到该格式恰好在尖锐锋面处自然地退化为更稳健的一阶方法，从而确保解保持物理上的合理性和单调性。",
            "id": "4042861",
            "problem": "考虑一个与计算燃烧学相关的有界标量场的一维线性平流，例如反应进度变量，其由守恒律 $u_t + a\\,u_x = 0$ ($a>0$) 控制。使用在宽度为 $\\Delta x$ 的均匀单元上的有限体积更新，其中在时间 $t^n$ 的单元平均值为 $u_i^n$：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right),\n$$\n其中 Courant–Friedrichs–Lewy (CFL) 数为 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$。对于 $a>0$，采用通过 Godunov 迎风格式和每个单元内的分段线性重构构建的保单调性总变差递减 (TVD) 通量：\n$$\nF_{i+\\frac{1}{2}}^n = a\\,u_{i+\\frac{1}{2}}^{-}, \\quad u_{i+\\frac{1}{2}}^{-} = u_i^n + \\frac{1}{2}s_i^n,\n$$\n其中限制斜率 $s_i^n$ 定义为\n$$\ns_i^n = \\phi(r_i^n)\\,\\Delta_{i+\\frac{1}{2}}^n,\\quad \\Delta_{i+\\frac{1}{2}}^n = u_{i+1}^n - u_i^n,\\quad r_i^n = \\frac{\\Delta_{i-\\frac{1}{2}}^n}{\\Delta_{i+\\frac{1}{2}}^n},\\quad \\Delta_{i-\\frac{1}{2}}^n = u_i^n - u_{i-1}^n.\n$$\n采用限制器函数 $\\phi(r)$ 为 minmod 限制器\n$$\n\\phi_{\\mathrm{minmod}}(r) = \\max\\!\\left(0,\\ \\min(1,\\ r)\\right),\n$$\n或 superbee 限制器\n$$\n\\phi_{\\mathrm{superbee}}(r) = \\max\\!\\left(0,\\ \\min(2r,\\,1),\\ \\min(r,\\,2)\\right).\n$$\n假设在时间 $t^n$ 有一个与燃烧锋面一致的右行单位阶跃，局限在单元 $i$ 附近，其值为\n$$\nu_{i-1}^n = 1,\\quad u_i^n = 1,\\quad u_{i+1}^n = 0,\n$$\n并且上游状态是均匀的，因此对于所有 $j \\leq i$ 有 $u_{j}^n = 1$，对于所有 $j \\geq i+1$ 有 $u_{j}^n = 0$。取 $\\lambda = 0.5$。\n\n任务：\n1. 计算单元 $i$ 处的比率 $r_i^n$。\n2. 计算 minmod 和 superbee 限制器对应的限制斜率 $s_i^n$。\n3. 使用限制重构，对每个限制器将 $u_i$ 更新一个时间步长至 $u_i^{n+1}$。\n4. 对每个限制器，通过确定 $u_i^{n+1}$ 是否位于区间 $\\left[\\min(u_{i-1}^n,\\,u_{i+1}^n),\\ \\max(u_{i-1}^n,\\,u_{i+1}^n)\\right]$ 内，来评估相对于紧邻单元的单调性。\n\n将你的最终答案表示为一个行矩阵，按顺序包含 $r_i^n$、使用 minmod 限制器的 $s_i^n$、使用 superbee 限制器的 $s_i^n$、使用 minmod 限制器的 $u_i^{n+1}$ 以及使用 superbee 限制器的 $u_i^{n+1}$ 的值。不需要四舍五入，这些无量纲量也没有附加物理单位。",
            "solution": "该问题被验证为有科学依据、适定且客观。它是使用高分辨率有限体积法求解双曲守恒律的一个标准练习，这是计算科学与工程领域的核心课题。所有必要的定义、方程和数据均已提供。\n\n解题过程按顺序解决四个任务。\n\n在时间 $t^n$ 时，单元 $i$ 附近的标量场的初始状态由以下给出：\n$u_{i-1}^n = 1$\n$u_i^n = 1$\n$u_{i+1}^n = 0$\n问题还指出，对于所有 $j \\leq i$ 有 $u_j^n = 1$，对于所有 $j \\geq i+1$ 有 $u_j^n = 0$。Courant 数为 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x} = 0.5$。\n\n**任务1：计算单元 $i$ 处的比率 $r_i^n$。**\n\n比率 $r_i^n$ 定义为 $r_i^n = \\frac{\\Delta_{i-\\frac{1}{2}}^n}{\\Delta_{i+\\frac{1}{2}}^n}$。我们首先计算连续差分 $\\Delta_{i-\\frac{1}{2}}^n$ 和 $\\Delta_{i+\\frac{1}{2}}^n$。\n\n$\\Delta_{i-\\frac{1}{2}}^n = u_i^n - u_{i-1}^n = 1 - 1 = 0$。\n$\\Delta_{i+\\frac{1}{2}}^n = u_{i+1}^n - u_i^n = 0 - 1 = -1$。\n\n现在，我们可以计算比率 $r_i^n$：\n$$\nr_i^n = \\frac{\\Delta_{i-\\frac{1}{2}}^n}{\\Delta_{i+\\frac{1}{2}}^n} = \\frac{0}{-1} = 0.\n$$\n\n**任务2：计算 minmod 和 superbee 限制器对应的限制斜率 $s_i^n$。**\n\n限制斜率由 $s_i^n = \\phi(r_i^n)\\,\\Delta_{i+\\frac{1}{2}}^n$ 给出。我们使用上面计算出的值 $r_i^n=0$ 和 $\\Delta_{i+\\frac{1}{2}}^n = -1$。\n\n对于 minmod 限制器：\n$\\phi_{\\mathrm{minmod}}(r_i^n) = \\phi_{\\mathrm{minmod}}(0) = \\max\\!\\left(0,\\ \\min(1,\\ 0)\\right) = \\max(0, 0) = 0$。\n因此，限制斜率为：\n$$\ns_i^n (\\text{minmod}) = \\phi_{\\mathrm{minmod}}(0) \\cdot \\Delta_{i+\\frac{1}{2}}^n = 0 \\cdot (-1) = 0.\n$$\n\n对于 superbee 限制器：\n$\\phi_{\\mathrm{superbee}}(r_i^n) = \\phi_{\\mathrm{superbee}}(0) = \\max\\!\\left(0,\\ \\min(2 \\cdot 0,\\,1),\\ \\min(0,\\,2)\\right) = \\max(0,\\ \\min(0,1),\\ \\min(0,2)) = \\max(0,0,0) = 0$。\n因此，限制斜率为：\n$$\ns_i^n (\\text{superbee}) = \\phi_{\\mathrm{superbee}}(0) \\cdot \\Delta_{i+\\frac{1}{2}}^n = 0 \\cdot (-1) = 0.\n$$\n在这种特定情况下，两个限制器在单元 $i$ 处都产生零斜率。\n\n**任务3：对每个限制器将 $u_i$ 更新至 $u_i^{n+1}$。**\n\n有限体积更新公式为：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right).\n$$\n数值通量由 $F_{j+\\frac{1}{2}}^n = a \\, u_{j+\\frac{1}{2}}^{-}$ 给出，其中 $u_{j+\\frac{1}{2}}^{-} = u_j^n + \\frac{1}{2}s_j^n$。\n将通量定义代入更新公式并使用 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$：\n$$\nu_i^{n+1} = u_i^n - \\frac{a\\,\\Delta t}{a\\,\\Delta x}\\left(a\\,u_{i+\\frac{1}{2}}^{-} - a\\,u_{i-\\frac{1}{2}}^{-}\\right) = u_i^n - \\lambda\\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right).\n$$\n我们需要计算单元界面 $u_{i+\\frac{1}{2}}^{-}$ 和 $u_{i-\\frac{1}{2}}^{-}$ 处的重构值。\n\n对于界面 $i+\\frac{1}{2}$：\n$u_{i+\\frac{1}{2}}^{-} = u_i^n + \\frac{1}{2}s_i^n$。\n由于我们发现对于两个限制器都有 $s_i^n = 0$，因此这个值对于两者是相同的：\n$$\nu_{i+\\frac{1}{2}}^{-} = 1 + \\frac{1}{2}(0) = 1.\n$$\n\n对于界面 $i-\\frac{1}{2}$：\n$u_{i-\\frac{1}{2}}^{-} = u_{i-1}^n + \\frac{1}{2}s_{i-1}^n$。\n我们必须计算单元 $i-1$ 处的限制斜率，即 $s_{i-1}^n = \\phi(r_{i-1}^n)\\,\\Delta_{i-\\frac{1}{2}}^n$。\n我们已经计算出 $\\Delta_{i-\\frac{1}{2}}^n = u_i^n - u_{i-1}^n = 0$。\n因此，无论限制器函数 $\\phi(r_{i-1}^n)$ 的值是多少：\n$$\ns_{i-1}^n = \\phi(r_{i-1}^n) \\cdot 0 = 0.\n$$\n这对 minmod 和 superbee 限制器都成立。\n现在我们计算界面 $i-\\frac{1}{2}$ 处的重构值：\n$$\nu_{i-\\frac{1}{2}}^{-} = u_{i-1}^n + \\frac{1}{2}s_{i-1}^n = 1 + \\frac{1}{2}(0) = 1.\n$$\n\n最后，我们更新单元平均值 $u_i^n$：\n$$\nu_i^{n+1} = u_i^n - \\lambda\\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right) = 1 - 0.5 \\cdot (1 - 1) = 1 - 0.5 \\cdot 0 = 1.\n$$\n这个结果对于 minmod 和 superbee 限制器是相同的。因此，$u_i^{n+1}(\\text{minmod}) = 1$ 和 $u_i^{n+1}(\\text{superbee}) = 1$。\n\n**任务4：评估单调性。**\n\n我们必须检查更新后的值 $u_i^{n+1}$ 是否位于其在时间 $t^n$ 的相邻值所定义的范围内。条件是 $u_i^{n+1} \\in \\left[\\min(u_{i-1}^n,\\,u_{i+1}^n),\\ \\max(u_{i-1}^n,\\,u_{i+1}^n)\\right]$。\n相邻值为 $u_{i-1}^n=1$ 和 $u_{i+1}^n=0$。\n区间为 $\\left[\\min(1, 0),\\ \\max(1, 0)\\right] = [0, 1]$。\n两个限制器的更新值均为 $u_i^{n+1} = 1$。\n由于 $1$ 在闭区间 $[0, 1]$ 内，因此两种格式都满足局部单调性条件。\n\n所要求的五个量的最终结果是：\n1. $r_i^n = 0$\n2. $s_i^n$ (minmod) = $0$\n3. $s_i^n$ (superbee) = $0$\n4. $u_i^{n+1}$ (minmod) = $1$\n5. $u_i^{n+1}$ (superbee) = $1$\n将这些值收集到一个行矩阵中作为最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这项练习将通过一个完整而强大的算法——通量修正输运 (Flux-Corrected Transport, FCT) ——来巩固您的理解。您将手动执行一个完整的时间步，从计算低阶和高阶通量，到对“反扩散”修正项应用复杂的限制器。这项练习提供了一个关于如何在实践中构建和实施一个稳健的、保持单调性的格式的整体视角。",
            "id": "4042837",
            "problem": "考虑反应流中组分质量分数线性平流的一维有限体积离散化，这是计算燃烧学中的一个典型问题。组分质量分数 $Y(x,t)$ 满足守恒律 $\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = 0$，其中平流速度 $u0$ 为常数。设网格为均匀网格，网格单元宽度为 $\\Delta x$，内部网格单元的索引为 $i=1,2,3$。你需要手动实现一个步长的通量修正输运 (FCT) 算法。在此，FCT 定义为一个低阶单调格式和一个高阶格式的凸组合，其中反扩散通量受到限制以保持单调性。\n\n使用以下科学上一致的设置：\n- 平流速度 $u = 1.0 \\,\\mathrm{m/s}$，网格间距 $\\Delta x = 1.0 \\times 10^{-2} \\,\\mathrm{m}$，时间步长 $\\Delta t = 6.0 \\times 10^{-3} \\,\\mathrm{s}$，因此 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = u \\Delta t/\\Delta x = 0.6$。\n- 初始网格单元平均质量分数（无量纲）：$Y_1^n = 0.2$，$Y_2^n = 0.8$，$Y_3^n = 0.4$。\n- 边界处理：在左侧入流边界，指定一个虚拟单元值 $Y_0^n = 0.2$；在右侧出流边界，取 $Y_4^n = Y_3^n$（零梯度出流）。将计算域边界上的反扩散通量设为零，即 $A_{0.5} = 0$ 和 $A_{3.5} = 0$。\n\n将网格单元界面 $i+1/2$ 处的数值通量定义如下：\n- 低阶通量（对于 $u0$ 的供体单元迎风格式）：$F^{\\mathrm{LO}}_{i+1/2} = u \\, Y_i^n$。\n- 高阶通量（中心格式）：$F^{\\mathrm{HO}}_{i+1/2} = u \\, (Y_i^n + Y_{i+1}^n)/2$。\n- 反扩散通量：$A_{i+1/2} = F^{\\mathrm{HO}}_{i+1/2} - F^{\\mathrm{LO}}_{i+1/2}$。\n\n设低阶更新为 $Y_i^{\\mathrm{LO}} = Y_i^n - (\\Delta t/\\Delta x)\\left(F^{\\mathrm{LO}}_{i+1/2} - F^{\\mathrm{LO}}_{i-1/2}\\right)$。为构造通量修正输运 (FCT) 的限制器系数，请使用 Zalesak 通量限制器。对于每个网格单元 $i$，根据前一时间层 $n$ 的值定义局部界限 $B_i^{\\min} = \\min\\left(Y_{i-1}^n, Y_i^n, Y_{i+1}^n\\right)$ 和 $B_i^{\\max} = \\max\\left(Y_{i-1}^n, Y_i^n, Y_{i+1}^n\\right)$，其中在 $i=1$ 处使用 $Y_0^n$，在 $i=3$ 处使用 $Y_4^n$ 作为相邻值。定义容量 $C_i^{+} = B_i^{\\max} - Y_i^{\\mathrm{LO}}$ 和 $C_i^{-} = Y_i^{\\mathrm{LO}} - B_i^{\\min}$，以及会导致 $Y_i$ 增加或减少的反扩散流入通量之和，\n$$\nP_i^{+} = \\max\\left(0, A_{i-1/2}\\right) + \\max\\left(0, -A_{i+1/2}\\right), \\quad\nP_i^{-} = \\max\\left(0, -A_{i-1/2}\\right) + \\max\\left(0, A_{i+1/2}\\right).\n$$\n限制器因子为\n$$\nr_i^{+} = \\begin{cases}\n1,  P_i^{+} = 0,\\\\\n\\min\\left(1, \\dfrac{C_i^{+}}{(\\Delta t/\\Delta x)\\, P_i^{+}}\\right),  P_i^{+}  0,\n\\end{cases}\n\\quad\nr_i^{-} = \\begin{cases}\n1,  P_i^{-} = 0,\\\\\n\\min\\left(1, \\dfrac{C_i^{-}}{(\\Delta t/\\Delta x)\\, P_i^{-}}\\right),  P_i^{-}  0.\n\\end{cases}\n$$\n通过以下公式限制每个内部界面上的反扩散通量\n$$\nA^{*}_{i+1/2} =\n\\begin{cases}\n\\min\\left(r_i^{-},\\, r_{i+1}^{+}\\right)\\, A_{i+1/2},  A_{i+1/2}  0,\\\\\n\\min\\left(r_i^{+},\\, r_{i+1}^{-}\\right)\\, A_{i+1/2},  A_{i+1/2}  0.\n\\end{cases}\n$$\n最后，计算中间网格单元经 FCT 修正后的更新值，\n$$\nY_2^{n+1} = Y_2^{\\mathrm{LO}} - \\frac{\\Delta t}{\\Delta x}\\left(A^{*}_{2.5} - A^{*}_{1.5}\\right).\n$$\n\n在给定的三单元模板上手动执行这些步骤，并以无量纲数的形式提供 $Y_2^{n+1}$ 的数值。将你的答案四舍五入到四位有效数字。此外，在你的推理过程中，你必须确认修正后的更新值相对于集合 $\\{Y_1^n, Y_2^n, Y_3^n\\}$，没有在中间网格单元中引入新的局部极值。",
            "solution": "该问题陈述经核实具有科学依据、适定、客观且完整。它描述了一种应用于线性平流方程的标准一维通量修正输运 (FCT) 算法，这是计算物理学和计算燃烧学中的一个基本问题。所有必需的参数、初始条件、边界条件和算法定义都已明确给出，没有歧义或矛盾。因此，我们可以开始求解。\n\n问题要求使用 FCT 方法计算一个时间步长后，三单元计算域中中心网格单元更新后的组分质量分数 $Y_2^{n+1}$。控制方程为 $\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = 0$。\n\n给定的参数如下：\n- 平流速度：$u = 1.0 \\,\\mathrm{m/s}$\n- 网格间距：$\\Delta x = 1.0 \\times 10^{-2} \\,\\mathrm{m}$\n- 时间步长：$\\Delta t = 6.0 \\times 10^{-3} \\,\\mathrm{s}$\n- 库朗数：$\\nu = \\frac{u \\Delta t}{\\Delta x} = \\frac{(1.0)(6.0 \\times 10^{-3})}{1.0 \\times 10^{-2}} = 0.6$\n- $n$ 时间层上的初始和边界网格单元平均值：\n  - $Y_0^n = 0.2$（虚拟单元）\n  - $Y_1^n = 0.2$\n  - $Y_2^n = 0.8$\n  - $Y_3^n = 0.4$\n  - $Y_4^n = Y_3^n = 0.4$（虚拟单元）\n\n计算过程按照 FCT 算法的定义分几个步骤进行。\n\n**步骤 1：计算低阶解 $Y_i^{\\mathrm{LO}}$**\n低阶格式为一阶迎风格式（供体单元），其更新方程为：\n$$Y_i^{\\mathrm{LO}} = Y_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F^{\\mathrm{LO}}_{i+1/2} - F^{\\mathrm{LO}}_{i-1/2}\\right)$$\n由于 $F^{\\mathrm{LO}}_{i+1/2} = u Y_i^n$（因为 $u>0$），该式可简化为：\n$$Y_i^{\\mathrm{LO}} = Y_i^n - \\frac{u \\Delta t}{\\Delta x}\\left(Y_i^n - Y_{i-1}^n\\right) = Y_i^n - \\nu\\left(Y_i^n - Y_{i-1}^n\\right)$$\n我们将此公式应用于内部网格单元 $i=1, 2, 3$：\n- 对于 $i=1$：$Y_1^{\\mathrm{LO}} = Y_1^n - \\nu(Y_1^n - Y_0^n) = 0.2 - 0.6(0.2 - 0.2) = 0.2$。\n- 对于 $i=2$：$Y_2^{\\mathrm{LO}} = Y_2^n - \\nu(Y_2^n - Y_1^n) = 0.8 - 0.6(0.8 - 0.2) = 0.8 - 0.6(0.6) = 0.8 - 0.36 = 0.44$。\n- 对于 $i=3$：$Y_3^{\\mathrm{LO}} = Y_3^n - \\nu(Y_3^n - Y_2^n) = 0.4 - 0.6(0.4 - 0.8) = 0.4 - 0.6(-0.4) = 0.4 + 0.24 = 0.64$。\n\n**步骤 2：计算反扩散通量 $A_{i+1/2}$**\n反扩散通量是高阶（中心）通量和低阶（迎风）通量之差：\n$$A_{i+1/2} = F^{\\mathrm{HO}}_{i+1/2} - F^{\\mathrm{LO}}_{i+1/2} = u \\frac{Y_i^n + Y_{i+1}^n}{2} - u Y_i^n = \\frac{u}{2}\\left(Y_{i+1}^n - Y_i^n\\right)$$\n我们需要计算内部界面和边界上的这些通量：\n- $A_{0.5} = 0$（给定）。\n- $A_{1.5} = \\frac{1.0}{2}(Y_2^n - Y_1^n) = \\frac{1}{2}(0.8 - 0.2) = 0.3$。\n- $A_{2.5} = \\frac{1.0}{2}(Y_3^n - Y_2^n) = \\frac{1}{2}(0.4 - 0.8) = -0.2$。\n- $A_{3.5} = 0$（给定）。\n\n**步骤 3：确定局部界限和容量**\n对于每个网格单元 $i$，我们从前一个时间步长找到局部极值 $B_i^{\\min}$ 和 $B_i^{\\max}$，然后基于低阶解计算容量 $C_i^+$ 和 $C_i^-$。\n- **网格单元 $i=1$**：\n  - $B_1^{\\min} = \\min(Y_0^n, Y_1^n, Y_2^n) = \\min(0.2, 0.2, 0.8) = 0.2$。\n  - $B_1^{\\max} = \\max(Y_0^n, Y_1^n, Y_2^n) = \\max(0.2, 0.2, 0.8) = 0.8$。\n  - $C_1^{+} = B_1^{\\max} - Y_1^{\\mathrm{LO}} = 0.8 - 0.2 = 0.6$。\n  - $C_1^{-} = Y_1^{\\mathrm{LO}} - B_1^{\\min} = 0.2 - 0.2 = 0$。\n- **网格单元 $i=2$**：\n  - $B_2^{\\min} = \\min(Y_1^n, Y_2^n, Y_3^n) = \\min(0.2, 0.8, 0.4) = 0.2$。\n  - $B_2^{\\max} = \\max(Y_1^n, Y_2^n, Y_3^n) = \\max(0.2, 0.8, 0.4) = 0.8$。\n  - $C_2^{+} = B_2^{\\max} - Y_2^{\\mathrm{LO}} = 0.8 - 0.44 = 0.36$。\n  - $C_2^{-} = Y_2^{\\mathrm{LO}} - B_2^{\\min} = 0.44 - 0.2 = 0.24$。\n- **网格单元 $i=3$**：\n  - $B_3^{\\min} = \\min(Y_2^n, Y_3^n, Y_4^n) = \\min(0.8, 0.4, 0.4) = 0.4$。\n  - $B_3^{\\max} = \\max(Y_2^n, Y_3^n, Y_4^n) = \\max(0.8, 0.4, 0.4) = 0.8$。\n  - $C_3^{+} = B_3^{\\max} - Y_3^{\\mathrm{LO}} = 0.8 - 0.64 = 0.16$。\n  - $C_3^{-} = Y_3^{\\mathrm{LO}} - B_3^{\\min} = 0.64 - 0.4 = 0.24$。\n\n**步骤 4：计算原始反扩散流入通量之和 $P_i^{\\pm}$**\n这些和表示了倾向于增加（$P_i^+$）或减少（$P_i^-$）网格单元 $i$ 中值的总反扩散通量。\n- **网格单元 $i=1$**：使用 $A_{0.5}=0$ 和 $A_{1.5}=0.3$。\n  - $P_1^{+} = \\max(0, A_{0.5}) + \\max(0, -A_{1.5}) = \\max(0, 0) + \\max(0, -0.3) = 0$。\n  - $P_1^{-} = \\max(0, -A_{0.5}) + \\max(0, A_{1.5}) = \\max(0, 0) + \\max(0, 0.3) = 0.3$。\n- **网格单元 $i=2$**：使用 $A_{1.5}=0.3$ 和 $A_{2.5}=-0.2$。\n  - $P_2^{+} = \\max(0, A_{1.5}) + \\max(0, -A_{2.5}) = \\max(0, 0.3) + \\max(0, -(-0.2)) = 0.3 + 0.2 = 0.5$。\n  - $P_2^{-} = \\max(0, -A_{1.5}) + \\max(0, A_{2.5}) = \\max(0, -0.3) + \\max(0, -0.2) = 0$。\n- **网格单元 $i=3$**：使用 $A_{2.5}=-0.2$ 和 $A_{3.5}=0$。\n  - $P_3^{+} = \\max(0, A_{2.5}) + \\max(0, -A_{3.5}) = \\max(0, -0.2) + \\max(0, 0) = 0$。\n  - $P_3^{-} = \\max(0, -A_{2.5}) + \\max(0, A_{3.5}) = \\max(0, -(-0.2)) + \\max(0, 0) = 0.2$。\n\n**步骤 5：计算限制器因子 $r_i^{\\pm}$**\n限制器因子是网格单元容量与潜在反扩散变化量的比值。我们使用 $\\frac{\\Delta t}{\\Delta x}=0.6$。\n- **网格单元 $i=1$**：\n  - $P_1^{+} = 0 \\implies r_1^{+} = 1$。\n  - $r_1^{-} = \\min\\left(1, \\frac{C_1^{-}}{(\\Delta t/\\Delta x)P_1^{-}}\\right) = \\min\\left(1, \\frac{0}{0.6 \\times 0.3}\\right) = 0$。\n- **网格单元 $i=2$**：\n  - $r_2^{+} = \\min\\left(1, \\frac{C_2^{+}}{(\\Delta t/\\Delta x)P_2^{+}}\\right) = \\min\\left(1, \\frac{0.36}{0.6 \\times 0.5}\\right) = \\min\\left(1, \\frac{0.36}{0.3}\\right) = \\min(1, 1.2) = 1$。\n  - $P_2^{-} = 0 \\implies r_2^{-} = 1$。\n- **网格单元 $i=3$**：\n  - $P_3^{+} = 0 \\implies r_3^{+} = 1$。\n  - $r_3^{-} = \\min\\left(1, \\frac{C_3^{-}}{(\\Delta t/\\Delta x)P_3^{-}}\\right) = \\min\\left(1, \\frac{0.24}{0.6 \\times 0.2}\\right) = \\min\\left(1, \\frac{0.24}{0.12}\\right) = \\min(1, 2) = 1$。\n\n**步骤 6：计算受限的反扩散通量 $A^{*}_{i+1/2}$**\n穿过每个界面的反扩散通量受到来自两个相邻网格单元的相关限制器因子的最小值限制。\n- **界面 $i+1/2=1.5$**：$A_{1.5}=0.3 > 0$。该通量受到“给予”单元 $i=1$（$r_1^-$）和“接收”单元 $i=2$（$r_2^+$）的限制。\n  - $A^{*}_{1.5} = \\min(r_1^-, r_2^+) A_{1.5} = \\min(0, 1) \\times 0.3 = 0 \\times 0.3 = 0$。\n- **界面 $i+1/2=2.5$**：$A_{2.5}=-0.2  0$。该通量受到“接收”单元 $i=2$（$r_2^+$）和“给予”单元 $i=3$（$r_3^-$）的限制。\n  - $A^{*}_{2.5} = \\min(r_2^+, r_3^-) A_{2.5} = \\min(1, 1) \\times (-0.2) = 1 \\times (-0.2) = -0.2$。\n\n**步骤 7：计算 $Y_2^{n+1}$ 的最终 FCT 更新值**\n最终的更新值是经受限反扩散通量修正后的低阶解。\n$$Y_2^{n+1} = Y_2^{\\mathrm{LO}} - \\frac{\\Delta t}{\\Delta x}\\left(A^{*}_{2.5} - A^{*}_{1.5}\\right)$$\n代入计算出的值：\n$$Y_2^{n+1} = 0.44 - 0.6\\left(-0.2 - 0\\right) = 0.44 - 0.6(-0.2) = 0.44 + 0.12 = 0.56$$\n\n**单调性确认**\nFCT 方法被设计为保单调的。这意味着更新后的值 $Y_i^{n+1}$ 必须位于前一时间步长局部邻域设定的界限内，即 $B_i^{\\min} \\leq Y_i^{n+1} \\leq B_i^{\\max}$。对于中间网格单元 $i=2$，这些界限是 $B_2^{\\min} = 0.2$ 和 $B_2^{\\max} = 0.8$。\n我们计算出的值为 $Y_2^{n+1} = 0.56$。我们检查该条件：\n$$0.2 \\leq 0.56 \\leq 0.8$$\n该条件得到满足。网格单元 $\\{1,2,3\\}$ 中的初始分布为 $\\{0.2, 0.8, 0.4\\}$，在单元 2 处有一个局部最大值。更新后的值 $0.56$ 介于 $n$ 时刻的相邻值（$0.2$ 和 $0.4$）之间，并且没有产生新的局部最小值或最大值。因此，计算结果保持了单调性。\n\n根据要求，将 $Y_2^{n+1}$ 的最终数值四舍五入到四位有效数字，结果为 $0.5600$。",
            "answer": "$$\\boxed{0.5600}$$"
        }
    ]
}