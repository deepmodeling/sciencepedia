{
    "hands_on_practices": [
        {
            "introduction": "Before writing code, a computational scientist must understand the target physical problem and design a robust verification strategy. This practice focuses on that crucial conceptual phase, challenging you to design a numerical experiment based on the Zel’dovich–von Neumann–Döring (ZND) theory of detonation. By correctly identifying the initial conditions, kinetic models, and key observables, you will learn how to structure a simulation to validate its physical fidelity against established theory .",
            "id": "4007506",
            "problem": "Consider the one-dimensional reactive Euler equations for a calorically perfect gas with a single-step irreversible reaction progress variable. The conserved variables are $U = [\\rho, \\rho u, \\rho E, \\rho Y]^\\top$, where $\\rho$ is density, $u$ is velocity, $E$ is total specific energy, and $Y$ is a bounded reaction progress variable with $Y=1$ in the unreacted mixture and $Y \\to 0$ in the fully reacted mixture. The fluxes $F(U)$ are those of the nonreactive Euler equations with an ideal-gas equation of state $p=(\\gamma-1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^2\\right)$ and $p=\\rho R T$, and the source terms are $S(U) = [0, 0, \\rho q \\omega, -\\rho \\omega]^\\top$, where $q>0$ is the specific heat release and $\\omega$ is the reaction rate. Assume Zel'dovich–von Neumann–Döring (ZND) detonation theory applies: a leading compression shock sets a frozen (non-reacted) von Neumann state, after which exothermic chemistry proceeds in a finite induction zone to the Chapman–Jouguet (CJ) state. You seek to verify an approximate Riemann solver for reactive flows by designing a reactive shock tube case and specifying a set of quantitative observables that can be compared to ZND theory.\n\nWhich option below provides a scientifically sound and self-consistent verification case, including initial states and kinetics that can produce a ZND-type detonation upon shock initiation, and a list of observables that can be compared directly to ZND theory predictions for detonation speed, induction length, and post-shock (von Neumann) state?\n\nA. One-dimensional shock tube of length $L=0.5\\,\\mathrm{m}$ with a diaphragm at $x=L/2$. Left state ($xL/2$): inert driver gas with $\\gamma=1.4$, $R=287\\,\\mathrm{J/(kg\\cdot K)}$, $p_L=6.0\\times 10^5\\,\\mathrm{Pa}$, $T_L=300\\,\\mathrm{K}$, $u_L=0$, $Y_L=0$. Right state ($x L/2$): reactive mixture with the same thermodynamic constants $\\gamma=1.4$, $R=287\\,\\mathrm{J/(kg\\cdot K)}$, $p_R=1.0\\times 10^5\\,\\mathrm{Pa}$, $T_R=300\\,\\mathrm{K}$, $u_R=0$, $Y_R=1$. Kinetics: one-step Arrhenius rate $\\omega = A\\,\\rho\\,Y\\,\\exp\\!\\left(-\\dfrac{E_a}{R T}\\right)$ with $A=1.0\\times 10^7\\,\\mathrm{s^{-1}}$, $E_a/R=1.8\\times 10^4\\,\\mathrm{K}$, and specific heat release $q=3.0\\times 10^6\\,\\mathrm{J/kg}$. Observables: detonation speed $D$ measured from the space–time trajectory of the leading shock/thermicity front, induction length $L_i$ measured as the distance between the shock location and the location of peak thermicity or maximum $\\rho q\\,\\omega$, and the von Neumann post-shock state $(p_2,\\,T_2,\\,u_2)$ inferred from Rankine–Hugoniot jump conditions with frozen composition across the shock. Compare $D$ to the Chapman–Jouguet prediction, $L_i$ to the ZND estimate based on the Arrhenius induction time behind the shock, and $(p_2,\\,T_2)$ to the frozen-shock Hugoniot computed from the upstream $(p_R,\\,T_R)$.\n\nB. One-dimensional shock tube with length $L=0.5\\,\\mathrm{m}$ and symmetric initial states: both sides have reactive mixture with $\\gamma=1.4$, $R=287\\,\\mathrm{J/(kg\\cdot K)}$, $p_L=p_R=1.0\\times 10^5\\,\\mathrm{Pa}$, $T_L=T_R=300\\,\\mathrm{K}$, $u_L=u_R=0$, $Y_L=Y_R=1$. Kinetics: two-step global mechanism with $\\omega=\\omega_1-\\omega_2$, both steps temperature-independent constants chosen so that the net rate is nonzero. Observables: laminar flame speed $S_L$ extracted from the expansion of a premixed deflagration, contact discontinuity speed, and equilibrium temperature in the far field. Compare $S_L$ and the contact speed to ZND detonation theory and use the equilibrium temperature to estimate the CJ speed.\n\nC. One-dimensional shock tube with a reactive driver: left state has the same reactive mixture as the right state but at $p_L=6.0\\times 10^5\\,\\mathrm{Pa}$, $T_L=300\\,\\mathrm{K}$, $Y_L=1$, and the right state is $p_R=1.0\\times 10^5\\,\\mathrm{Pa}$, $T_R=300\\,\\mathrm{K}$, $Y_R=1$. Kinetics: one-step Arrhenius with $\\omega = A\\,\\rho\\,Y\\,\\exp\\!\\left(-\\dfrac{E_a}{R T}\\right)$, $A=1.0\\times 10^7\\,\\mathrm{s^{-1}}$, $E_a/R=1.8\\times 10^4\\,\\mathrm{K}$, $q=3.0\\times 10^6\\,\\mathrm{J/kg}$. Observables: detonation speed $D$ measured from the contact discontinuity trajectory, induction length $L_i$ measured from the contact to the peak thermicity, and post-shock state $(p_2,\\,T_2)$ computed using the equilibrium (reacted) Hugoniot across the leading shock. Compare $D$ and $L_i$ to ZND CJ predictions.\n\nD. One-dimensional periodic domain of length $L=0.5\\,\\mathrm{m}$ filled uniformly with reactive gas: $\\gamma=1.4$, $R=287\\,\\mathrm{J/(kg\\cdot K)}$, $p_0=1.0\\times 10^5\\,\\mathrm{Pa}$, $T_0=1200\\,\\mathrm{K}$, $u_0=0$, $Y_0=1$. Kinetics: pressure-controlled rate $\\omega = k\\,p^n\\,Y$ with $k=10^{-4}\\,\\mathrm{Pa^{-n}\\,s^{-1}}$ and $n=2$, and $q=3.0\\times 10^6\\,\\mathrm{J/kg}$. Observables: acceleration of the pressure field, the phase speed of the dominant acoustic mode, and the rate of decrease of $Y$. Compare the phase speed to the CJ detonation speed and the pressure acceleration to the ZND induction processes.\n\nChoose the single best option.",
            "solution": "The problem statement is a valid meta-problem. It asks for the design of a scientifically sound verification case for an approximate Riemann solver for reactive flows, grounded in the established principles of the Zel'dovich–von Neumann–Döring (ZND) theory of detonation. The prompt is scientifically grounded, well-posed, objective, and does not violate any of the criteria for invalidity. The task is to select, from the given options, a complete and self-consistent problem specification that correctly sets up a numerical experiment to simulate a ZND-structured detonation and identifies the appropriate observables for comparison with theory.\n\nThe core principles of ZND theory are:\n1.  A non-reactive (frozen) shock wave, the ZND shock, propagates at the detonation velocity $D$. It compresses the initial reactive mixture to a high-pressure, high-temperature state known as the von Neumann state.\n2.  Following the shock, there is an induction zone of finite length, $L_i$, where the reaction initiates and proceeds. The composition of the gas mixture changes and energy is released.\n3.  For a self-sustaining detonation, the wave structure culminates in the Chapman–Jouguet (CJ) state, where the flow velocity relative to the shock front is equal to the local sound speed.\n\nA proper verification case must therefore:\na)  Establish initial conditions that can generate a strong shock capable of initiating a detonation.\nb)  Employ a physically reasonable, temperature-sensitive reaction rate model to capture the induction process.\nc)  Define a set of observables that correspond directly to the key features of the ZND model ($D$, the von Neumann state, $L_i$) and are measurable in a numerical simulation.\n\nWe will now evaluate each option against these requirements.\n\n**Option A Evaluation**\n\n*   **Initial Conditions:** The setup is a classic one-dimensional shock tube with a high-pressure inert driver gas ($p_L = 6.0 \\times 10^5\\,\\mathrm{Pa}$, $Y_L=0$) and a low-pressure reactive mixture ($p_R = 1.0 \\times 10^5\\,\\mathrm{Pa}$, $Y_R=1$). The pressure ratio of $6$ is sufficient to generate a strong shock propagating into the reactive gas on the right side. This shock will compress and heat the reactive mixture, providing the necessary conditions for initiation. The use of an inert driver ($Y_L=0$) is a methodologically sound choice, as it prevents chemical reactions in the driver gas, simplifying the analysis of the wave dynamics.\n*   **Kinetics:** The model uses a one-step Arrhenius rate, $\\omega = A\\,\\rho\\,Y\\,\\exp\\!\\left(-\\dfrac{E_a}{R T}\\right)$. This form is the archetypal model for temperature-activated chemical kinetics. The high activation energy ($E_a/R = 1.8 \\times 10^4\\,\\mathrm{K}$) ensures that the reaction rate is negligible at the initial temperature ($T_R=300\\,\\mathrm{K}$) but becomes significant at the high temperatures behind the initiating shock (the von Neumann state). This temperature sensitivity is essential for the ZND structure, which requires a \"frozen\" shock followed by a reaction zone.\n*   **Observables:** The proposed observables are precisely the quantities predicted by ZND theory.\n    1.  The detonation speed, $D$, is correctly identified as a primary observable, measured from the trajectory of the leading shock. This can be compared to the theoretical CJ detonation speed, $D_{CJ}$, which depends on the thermodynamic properties ($\\gamma$, $q$) of the mixture.\n    2.  The induction length, $L_i$, is correctly defined as the distance between the leading shock and the region of intense reaction (peak thermicity). This can be compared with a theoretical estimate derived from the integral of the reaction rate equation at the conditions of the von Neumann state.\n    3.  The von Neumann post-shock state $(p_2, T_2, u_2)$ is correctly identified as being defined by the Rankine–Hugoniot jump conditions for a *frozen* (non-reacting) shock. This is the definition of the von Neumann state and is a direct test of the code's ability to capture the leading shock of the ZND complex.\n\n*   **Verdict:** This option provides a scientifically sound, complete, and internally consistent verification case. It correctly formulates the initial conditions, kinetics, and observables required to test a numerical solver against ZND detonation theory. **Correct**.\n\n**Option B Evaluation**\n\n*   **Initial Conditions:** The setup specifies symmetric initial states ($p_L=p_R$, $T_L=T_R$, etc.) across the diaphragm. Upon removal of the diaphragm, two symmetric rarefaction waves will propagate away from the center. No shock wave is generated. A ZND detonation requires a strong shock for initiation. This setup will not produce a detonation.\n*   **Kinetics:** The kinetics are described as a \"two-step global mechanism with ... temperature-independent constants\". A reaction rate that is independent of temperature is fundamentally unphysical for a shock-initiated detonation. The core mechanism of ZND theory relies on the exponential increase in reaction rate with temperature following shock compression. This kinetic model is inappropriate.\n*   **Observables:** The option proposes measuring the \"laminar flame speed $S_L$\". A laminar flame, or deflagration, is a subsonic combustion wave driven by diffusion, fundamentally different from a supersonic detonation wave driven by shock compression. Comparing $S_L$ to ZND detonation theory is a category error.\n\n*   **Verdict:** This option is flawed in every aspect: the initial conditions will not generate a detonation, the kinetic model is unphysical for this context, and the proposed observables are for a different combustion regime. **Incorrect**.\n\n**Option C Evaluation**\n\n*   **Initial Conditions:** This setup uses a reactive driver gas. While this can generate a strong shock, it can unnecessarily complicate the problem compared to using an inert driver, as reactions may occur in the expanded driver gas. However, the critical flaws lie in the observables.\n*   **Kinetics:** The Arrhenius kinetics model is appropriate, as in Option A.\n*   **Observables:** The definitions of the observables betray a fundamental misunderstanding of ZND theory.\n    1.  \"*detonation speed D measured from the contact discontinuity trajectory*\": This is incorrect. The detonation speed, $D$, is the speed of the leading shock front. The contact discontinuity is a separate wave that moves at the local fluid velocity, which is not, in general, equal to $D$.\n    2.  \"*induction length Li measured from the contact to the peak thermicity*\": This is also incorrect. The induction zone is the region immediately *behind the leading shock*. Its length is the distance from the shock front to the region of significant heat release, not from the contact discontinuity.\n    3.  \"*post-shock state...computed using the equilibrium (reacted) Hugoniot*\": This is a critical error. The state immediately behind the shock front is the von Neumann state, which is by definition *unreacted* (frozen). It lies on the frozen Hugoniot curve. The equilibrium Hugoniot relates the initial state to the final, fully reacted state, bypassing the internal structure of the wave.\n\n*   **Verdict:** While the initial conditions could produce a detonation, the proposed list of observables is based on incorrect definitions that contradict the ZND model. This makes it an invalid verification procedure. **Incorrect**.\n\n**Option D Evaluation**\n\n*   **Initial Conditions:** The setup is a periodic domain with a uniform, high-temperature initial state ($T_0=1200\\,\\mathrm{K}$). This configuration does not possess a mechanism to generate a propagating shock wave, which is the defining feature of a detonation. It is a setup for studying spatially homogeneous auto-ignition or thermo-acoustic instabilities, not a ZND detonation wave.\n*   **Kinetics:** The rate law is given as $\\omega = k\\,p^n\\,Y$, which lacks temperature dependence. As discussed for Option B, a temperature-sensitive rate is essential for modeling shock-induced detonation. A purely pressure-dependent rate is unphysical for this phenomenon.\n*   **Observables:** The observables are irrelevant to ZND theory.\n    1.  \"*phase speed of the dominant acoustic mode*\": A detonation is a highly supersonic wave ($D \\gg c$, where $c$ is the sound speed). Comparing its speed to the phase speed of an acoustic wave is nonsensical.\n    2.  \"*acceleration of the pressure field*\": This quantity describes the rate of homogeneous energy release in a closed volume, which is characteristic of an explosion, not the structure of a propagating ZND wave.\n\n*   **Verdict:** This option describes a different physical problem (homogeneous ignition), uses an unphysical kinetic model for detonation, and proposes irrelevant observables. It is not a valid verification case for ZND theory. **Incorrect**.\n\n**Conclusion**\n\nOnly Option A describes a well-posed, physically meaningful, and methodologically sound verification problem for a reactive flow solver based on ZND theory. It correctly specifies the initial conditions for shock initiation, employs a suitable temperature-sensitive kinetic model, and identifies the correct set of observables and their corresponding theoretical benchmarks.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "With a verification strategy in mind, the next step is building the solver. This exercise takes you through the core mechanics of a finite-volume solver for reactive flows, focusing on operator splitting to decouple the transport and chemistry source terms. You will implement and compare first-order Godunov and second-order Strang splitting, gaining hands-on experience with the distinct stability constraints imposed by hyperbolic transport (the CFL condition) and stiff chemical kinetics .",
            "id": "4007520",
            "problem": "Consider the scalar reactive transport in one spatial dimension governed by the conservation law with source,\n$$\n\\frac{\\partial Y}{\\partial t} + \\frac{\\partial f(Y)}{\\partial x} = \\omega(Y),\n$$\nwhere $Y$ is a dimensionless species mass fraction, $x \\in [0,L]$ is a spatial coordinate with periodic boundary conditions, $t \\ge 0$ is time in dimensionless units, $f(Y) = a\\,Y$ is a linear flux with a constant advection speed $a$, and $\\omega(Y) = -K\\,Y$ represents chemistry modeled as a first-order decay. The stiffness $K$ is assumed to be Arrhenius, $K = A \\exp(-E/T)$, where $A$ is a pre-exponential factor, $E$ is a non-dimensional activation energy, and $T$ is a non-dimensional temperature.\n\nYour task is to implement a dimensionless solver using a finite-volume formulation with a first-order approximate Riemann solver for transport (Godunov flux) and operator splitting for chemistry–transport coupling. The solver must compute a single time step $\\Delta t$ that simultaneously satisfies:\n- a stability condition associated with hyperbolic transport that depends on the magnitude of the characteristic speed $a$ and the spatial grid size $\\Delta x$, and\n- a stability and monotonicity condition for explicit forward-Euler integration of the chemistry $Y'=-K Y$.\n\nYou must then compare the numerical error at a prescribed final time $t_f$ between:\n- Godunov first-order operator splitting (chemistry over the full $\\Delta t$ followed by transport over the full $\\Delta t$), and\n- Strang second-order operator splitting (chemistry over $\\Delta t/2$, transport over $\\Delta t$, then chemistry over $\\Delta t/2$).\n\nFor transport, use a first-order Godunov flux that, for a constant $a$, reduces to upwinding based on the sign of $a$ and the local left and right states. For chemistry, use explicit forward Euler. Use a uniform grid of $N_x$ control volumes over the periodic interval $[0,L]$ with cell centers $x_i = (i + \\tfrac{1}{2})\\Delta x$, where $\\Delta x = L/N_x$ and $i \\in \\{0,1,\\dots,N_x-1\\}$.\n\nTo assess accuracy, use the exact solution for this problem, obtained by the method of characteristics for the transport and direct integration for the chemistry,\n$$\nY_{\\text{exact}}(x,t) = Y_0\\!\\big( (x - a\\,t) \\bmod L \\big)\\,\\exp(-K\\,t),\n$$\nwhere $Y_0(x)$ is the initial condition defined as\n$$\nY_0(x) = 0.6 + 0.3 \\sin\\!\\left(\\frac{2\\pi x}{L}\\right) + 0.1 \\exp\\!\\left(-\\frac{(x - 0.3\\,L)^2}{2\\,(0.08\\,L)^2}\\right),\n$$\nwhich is strictly positive for all $x \\in [0,L]$ and dimensionless.\n\nYour program must:\n1. Derive and compute a single $\\Delta t$ that simultaneously satisfies the transport stability requirement tied to the Courant–Friedrichs–Lewy (CFL) condition and the explicit chemistry stability and monotonicity condition for $Y'=-K Y$.\n2. Advance the solution from $t=0$ to $t=t_f$ using both Godunov and Strang operator splitting, with the transport step computed by the first-order Godunov flux and the chemistry step computed by explicit forward Euler, while enforcing the same $\\Delta t$ throughout (use a final shorter step if $t_f$ is not an integer multiple of $\\Delta t$).\n3. Compute the root-mean-square ($L^2$) error of each numerical solution compared to the exact solution at $t=t_f$:\n$$\n\\varepsilon_{L^2} = \\left( \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} \\left( Y_i(t_f) - Y_{\\text{exact}}(x_i,t_f) \\right)^2 \\right)^{1/2}.\n$$\n\nAll quantities are dimensionless. Angles, where used inside trigonometric functions, are in radians. The characteristic speed $a$, domain length $L$, stiffness parameters $A$, $E$, and $T$, the number of cells $N_x$, the final time $t_f$, and the CFL number are specified per test case below.\n\nTest Suite:\n- Case $1$: $L=1$, $N_x=200$, $a=1$, $t_f=0.2$, $A=50$, $E=1$, $T=1$, $\\text{CFL}=0.9$.\n- Case $2$: $L=1$, $N_x=200$, $a=0$, $t_f=0.01$, $A=1000$, $E=0.1$, $T=1$, $\\text{CFL}=0.9$.\n- Case $3$: $L=1$, $N_x=200$, $a=-2$, $t_f=0.2$, $A=5$, $E=3$, $T=1$, $\\text{CFL}=0.95$.\n- Case $4$: $L=1$, $N_x=400$, $a=0.5$, $t_f=0.05$, $A=200$, $E=1.5$, $T=1$, $\\text{CFL}=0.99$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a list of two floats $[\\varepsilon^{\\text{Godunov}}_{L^2},\\varepsilon^{\\text{Strang}}_{L^2}]$. Aggregate all test cases into a single list as\n$$\n\\big[ [\\varepsilon^{\\text{Godunov}}_{L^2},\\varepsilon^{\\text{Strang}}_{L^2}], \\dots \\big],\n$$\nand print it in a single line with no spaces, for example, $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$, where each $x_k$ and $y_k$ are floats.",
            "solution": "The user-provided problem is assessed to be valid. It is a well-posed, scientifically grounded problem in computational combustion that requests the implementation and comparison of standard numerical methods for a reactive transport equation. All parameters and conditions are clearly specified, and the problem is free of contradictions or ambiguities.\n\nThe problem concerns the scalar reactive transport equation in one dimension:\n$$\n\\frac{\\partial Y}{\\partial t} + \\frac{\\partial f(Y)}{\\partial x} = \\omega(Y)\n$$\nHere, $Y(x,t)$ is the species mass fraction, the flux is linear, $f(Y) = aY$, with a constant advection speed $a$, and the source term represents first-order chemical decay, $\\omega(Y) = -KY$. The reaction rate constant is given by the Arrhenius law, $K = A \\exp(-E/T)$. The solution is sought on a periodic domain $x \\in [0,L]$.\n\nThe solution is constructed using a finite-volume method with operator splitting, which decouples the transport and chemistry processes. The governing equation is discretized by integrating over control volumes $C_i = [x_{i-1/2}, x_{i+1/2}]$ of size $\\Delta x = L/N_x$. This yields a system of ordinary differential equations (ODEs) for the cell-averaged mass fractions $Y_i(t)$:\n$$\n\\frac{d Y_i}{dt} + \\frac{1}{\\Delta x} \\left( f_{i+1/2} - f_{i-1/2} \\right) = \\omega(Y_i)\n$$\nwhere $f_{i+1/2}$ is the numerical flux at the interface between cells $i$ and $i+1$.\n\nOperator splitting is used to solve this system by advancing the solution through separate transport and chemistry steps.\nThe evolution of $Y$ from time $t^n$ to $t^{n+1} = t^n + \\Delta t$ can be written as $Y^{n+1} = \\mathcal{L}(\\Delta t) Y^n$, where $\\mathcal{L}$ is the evolution operator. This operator is split into a transport part, $\\mathcal{L}_{\\text{transport}}$, and a chemistry part, $\\mathcal{L}_{\\text{chem}}$.\n\nTwo splitting schemes are compared:\n1.  **Godunov Splitting (first-order):** This asymmetric scheme applies the chemistry operator over the full time step, followed by the transport operator over the full time step.\n    $$\n    Y^{n+1} = \\mathcal{L}_{\\text{transport}}(\\Delta t) \\circ \\mathcal{L}_{\\text{chem}}(\\Delta t) Y^n\n    $$\n2.  **Strang Splitting (second-order):** This symmetric scheme provides second-order accuracy for the combined process.\n    $$\n    Y^{n+1} = \\mathcal{L}_{\\text{chem}}(\\Delta t/2) \\circ \\mathcal{L}_{\\text{transport}}(\\Delta t) \\circ \\mathcal{L}_{\\text{chem}}(\\Delta t/2) Y^n\n    $$\n\nThe numerical methods for each operator are specified as follows:\n\n**Transport Operator ($\\mathcal{L}_{\\text{transport}}$):** The transport step solves the pure advection equation $\\frac{\\partial Y}{\\partial t} + a \\frac{\\partial Y}{\\partial x} = 0$. Using the finite-volume formulation, the update for cell $i$ is:\n$$\nY_i^{\\text{new}} = Y_i^{\\text{old}} - \\frac{\\Delta t}{\\Delta x} \\left( f_{i+1/2} - f_{i-1/2} \\right)\n$$\nThe problem specifies a first-order Godunov flux. For a linear flux $f(Y)=aY$, the Godunov flux is equivalent to a simple upwind flux. The flux at the interface $x_{i+1/2}$ between cells $i$ and $i+1$ is determined by the direction of information propagation, which is given by the sign of the advection speed $a$.\n-   If $a  0$, information flows from left to right, so the flux is determined by the left state $Y_i$: $f_{i+1/2} = a Y_i$. The scheme becomes $Y_i^{\\text{new}} = Y_i^{\\text{old}} - \\frac{a \\Delta t}{\\Delta x} (Y_i^{\\text{old}} - Y_{i-1}^{\\text{old}})$.\n-   If $a  0$, information flows from right to left, so the flux is determined by the right state $Y_{i+1}$: $f_{i+1/2} = a Y_{i+1}$. The scheme becomes $Y_i^{\\text{new}} = Y_i^{\\text{old}} - \\frac{a \\Delta t}{\\Delta x} (Y_{i+1}^{\\text{old}} - Y_i^{\\text{old}})$.\n-   If $a=0$, there is no transport, and the state remains unchanged.\nPeriodic boundary conditions are enforced, meaning cell $N_x-1$ is adjacent to cell $0$.\n\n**Chemistry Operator ($\\mathcal{L}_{\\text{chem}}$):** The chemistry step solves the ODE $\\frac{dY}{dt} = -KY$ for each cell independently. Using an explicit forward Euler scheme, the update is:\n$$\nY_i^{\\text{new}} = Y_i^{\\text{old}} + \\Delta t \\, \\omega(Y_i^{\\text{old}}) = Y_i^{\\text{old}} - \\Delta t K Y_i^{\\text{old}} = (1 - K \\Delta t) Y_i^{\\text{old}}\n$$\n\n**Time Step Determination:** A single time step $\\Delta t$ must be chosen to ensure the stability and monotonicity of both numerical schemes.\n1.  **Transport Stability:** The first-order upwind scheme is stable under the Courant–Friedrichs–Lewy (CFL) condition, $|\\nu| = \\frac{|a|\\Delta t}{\\Delta x} \\le 1$. A safety factor, the CFL number, is introduced, leading to the constraint:\n    $$\n    \\Delta t_{\\text{transport}} = \\frac{\\text{CFL} \\cdot \\Delta x}{|a|}\n    $$\n    This constraint is not applicable if $a=0$.\n2.  **Chemistry Stability and Monotonicity:** For the forward Euler scheme applied to $Y'=-KY$, stability requires $|1 - K\\Delta t| \\le 1$, which implies $K \\Delta t \\le 2$. However, a stricter condition is required to ensure that the mass fraction $Y$ remains non-negative (monotonicity). This requires the amplification factor to be non-negative: $1 - K \\Delta t \\ge 0$, which imposes the constraint:\n    $$\n    \\Delta t_{\\text{chem}} = \\frac{1}{K}\n    $$\nThe overall time step $\\Delta t$ must satisfy both conditions simultaneously, so we choose the minimum of the two limits:\n$$\n\\Delta t = \\min(\\Delta t_{\\text{transport}}, \\Delta t_{\\text{chem}})\n$$\n\nFinally, the accuracy of both splitting schemes is assessed by computing the root-mean-square ($L^2$) error of the numerical solutions $Y_i(t_f)$ against the provided exact solution at the final time $t_f$:\n$$\nY_{\\text{exact}}(x,t) = Y_0\\!\\big( (x - a\\,t) \\bmod L \\big)\\,\\exp(-K\\,t)\n$$\nThe error is calculated as:\n$$\n\\varepsilon_{L^2} = \\left( \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} \\left( Y_i(t_f) - Y_{\\text{exact}}(x_i,t_f) \\right)^2 \\right)^{1/2}\n$$\nThe simulation proceeds from $t=0$ to $t=t_f$ using the constant derived time step $\\Delta t$, with a final, smaller step taken if $t_f$ is not an integer multiple of $\\Delta t$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reactive transport problem for the given test cases\n    and prints the L2 errors for Godunov and Strang splitting methods.\n    \"\"\"\n\n    test_cases = [\n        {'L': 1, 'Nx': 200, 'a': 1, 'tf': 0.2, 'A': 50, 'E': 1, 'T': 1, 'CFL': 0.9},\n        {'L': 1, 'Nx': 200, 'a': 0, 'tf': 0.01, 'A': 1000, 'E': 0.1, 'T': 1, 'CFL': 0.9},\n        {'L': 1, 'Nx': 200, 'a': -2, 'tf': 0.2, 'A': 5, 'E': 3, 'T': 1, 'CFL': 0.95},\n        {'L': 1, 'Nx': 400, 'a': 0.5, 'tf': 0.05, 'A': 200, 'E': 1.5, 'T': 1, 'CFL': 0.99},\n    ]\n\n    all_results = []\n\n    def initial_condition(x, L):\n        \"\"\"Computes the initial condition Y_0(x).\"\"\"\n        term1 = 0.6\n        term2 = 0.3 * np.sin(2 * np.pi * x / L)\n        term3 = 0.1 * np.exp(-((x - 0.3 * L)**2) / (2 * (0.08 * L)**2))\n        return term1 + term2 + term3\n\n    def exact_solution(x, t, L, a, K):\n        \"\"\"Computes the exact solution Y_exact(x, t).\"\"\"\n        x_char = (x - a * t) % L\n        return initial_condition(x_char, L) * np.exp(-K * t)\n\n    def solve_chemistry(Y, dt, K):\n        \"\"\"Applies one forward Euler step for chemistry.\"\"\"\n        return Y * (1.0 - K * dt)\n\n    def solve_transport(Y, dt, a, dx):\n        \"\"\"Applies one first-order Godunov (upwind) step for transport.\"\"\"\n        if a == 0:\n            return Y\n        \n        nu = a * dt / dx\n        if a  0:\n            # Upwind from the left (i-1)\n            # Y_new[i] = Y[i] - nu * (Y[i] - Y[i-1])\n            return Y - nu * (Y - np.roll(Y, 1))\n        else: # a  0\n            # Upwind from the right (i+1)\n            # Y_new[i] = Y[i] - nu * (Y[i+1] - Y[i])\n            return Y - nu * (np.roll(Y, -1) - Y)\n\n    for case in test_cases:\n        L, Nx, a, tf, A, E, T, CFL = case.values()\n\n        # Grid and parameters\n        dx = L / Nx\n        x = np.linspace(0 + dx / 2, L - dx / 2, Nx)\n        K = A * np.exp(-E / T)\n\n        # Time step calculation\n        dt_chem = 1.0 / K\n        if a == 0:\n            dt_transport = np.inf\n        else:\n            dt_transport = CFL * dx / abs(a)\n        \n        dt = min(dt_transport, dt_chem)\n\n        # Initial conditions for simulations\n        Y0 = initial_condition(x, L)\n        Y_godunov = np.copy(Y0)\n        Y_strang = np.copy(Y0)\n\n        # Time-stepping loop\n        current_t = 0.0\n        while current_t  tf:\n            step_dt = min(dt, tf - current_t)\n\n            # Godunov (1st order) splitting: Chem(dt) - Transport(dt)\n            Y_star = solve_chemistry(Y_godunov, step_dt, K)\n            Y_godunov = solve_transport(Y_star, step_dt, a, dx)\n\n            # Strang (2nd order) splitting: Chem(dt/2) - Transport(dt) - Chem(dt/2)\n            Y_prime = solve_chemistry(Y_strang, step_dt / 2.0, K)\n            Y_double_prime = solve_transport(Y_prime, step_dt, a, dx)\n            Y_strang = solve_chemistry(Y_double_prime, step_dt / 2.0, K)\n            \n            current_t += step_dt\n        \n        # Calculate final error\n        Y_exact_final = exact_solution(x, tf, L, a, K)\n        \n        err_godunov = np.sqrt(np.mean((Y_godunov - Y_exact_final)**2))\n        err_strang = np.sqrt(np.mean((Y_strang - Y_exact_final)**2))\n        \n        all_results.append([err_godunov, err_strang])\n\n    # Format output as a single string, no spaces\n    result_str = \"[\" + \",\".join([f\"[{g},{s}]\" for g, s in all_results]) + \"]\"\n    print(result_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Standard Riemann solvers, while robust, can introduce excessive numerical diffusion in the low-Mach number regimes characteristic of many combustion phenomena. This final practice addresses this advanced issue by implementing low-Mach number preconditioning within the Harten-Lax-van Leer-Contact (HLLC) framework. By directly comparing the numerical diffusion of a species across a contact discontinuity with and without preconditioning, you will see firsthand how to improve solver accuracy for a critical feature in reactive flows .",
            "id": "4007521",
            "problem": "Consider the one-dimensional, inviscid, multicomponent reactive flow governed by the Euler equations augmented by a single passive species conservation equation. The conserved variables are $\\rho$, $\\rho u$, $E$, and $\\rho Y_F$, where $\\rho$ is the mass density in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $u$ is the velocity in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, $E$ is the total energy density in $\\mathrm{J}\\,\\mathrm{m}^{-3}$, and $Y_F$ is the fuel mass fraction (dimensionless). Assume a binary ideal-gas mixture of a fuel and an oxidizer with constant ratio of specific heats $\\gamma$ and composition-dependent specific gas constant $R(Y_F)$. The universal gas constant is $R_u$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and the molecular weights are $W_F$ and $W_O$ in $\\mathrm{kg}\\,\\mathrm{mol}^{-1}$. The mixture molecular weight is\n$$\nW(Y_F) = \\left(\\frac{Y_F}{W_F} + \\frac{1-Y_F}{W_O}\\right)^{-1},\n$$\nand the mixture specific gas constant is\n$$\nR(Y_F) = \\frac{R_u}{W(Y_F)}.\n$$\nFor thermodynamic closure, use the ideal-gas relation $p = \\rho R(Y_F) T$ with pressure $p$ in $\\mathrm{Pa}$ and temperature $T$ in $\\mathrm{K}$, and the total energy density\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2.\n$$\nThe speed of sound is $c = \\sqrt{\\gamma R(Y_F) T}$ and the Mach number is $M = \\frac{u}{c}$.\n\nYou will compute the Harten-Lax-van Leer-Contact (HLLC) approximate Riemann flux at a single interface with a strong composition gradient at low Mach number and compare the preconditioned versus unpreconditioned flux in terms of numerical species diffusion. Preconditioning is applied by scaling acoustic signals with a factor $\\alpha$ based on the local Mach number; specifically, define $\\tilde{c} = \\alpha c$ with $\\alpha = \\max(|M|,\\varepsilon)$ and $\\varepsilon = 10^{-6}$ to avoid degeneracy, and use $\\tilde{c}$ in all wave-speed estimates of the Riemann solver. This low-Mach preconditioning reduces excessive acoustic dissipation and is widely used in computational combustion to improve accuracy at $M \\ll 1$.\n\nLet left ($L$) and right ($R$) states be given by $(p_K, T_K, Y_{F,K})$ for $K \\in \\{L,R\\}$. Construct $\\rho_K = \\frac{p_K}{R(Y_{F,K}) T_K}$, $c_K = \\sqrt{\\gamma R(Y_{F,K}) T_K}$, and set the interface velocity $u_K = M c_L$ on both sides so that the interface Mach number is referenced to the left sound speed. Define the HLLC wave speeds using the Davis estimate with preconditioned acoustics:\n$$\nS_L = \\min(u_L - \\tilde{c}_L, u_R - \\tilde{c}_R), \\quad\nS_R = \\max(u_L + \\tilde{c}_L, u_R + \\tilde{c}_R),\n$$\nand the contact wave speed\n$$\nS_* = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)}.\n$$\nThe corresponding star-region densities are\n$$\n\\rho_{*L} = \\rho_L \\frac{S_L - u_L}{S_L - S_*}, \\quad\n\\rho_{*R} = \\rho_R \\frac{S_R - u_R}{S_R - S_*}.\n$$\nTreat the species as a passive scalar advected by the HLLC contact wave, with star-region species masses $(\\rho Y_F)_{*L} = \\rho_{*L} Y_{F,L}$ and $(\\rho Y_F)_{*R} = \\rho_{*R} Y_{F,R}$. The species flux component $F_{\\rho Y_F}$ across the interface is then obtained from the HLLC flux selection:\n- If $0 \\le S_L$, then $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L}$,\n- If $S_L  0 \\le S_*$, then $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L} + S_L\\left[(\\rho Y_F)_{*L} - \\rho_L Y_{F,L}\\right]$,\n- If $S_*  0 \\le S_R$, then $F_{\\rho Y_F} = \\rho_R u_R Y_{F,R} + S_R\\left[(\\rho Y_F)_{*R} - \\rho_R Y_{F,R}\\right]$,\n- If $S_R \\le 0$, then $F_{\\rho Y_F} = \\rho_R u_R Y_{F,R}$.\n\nDefine the pure advective upwind species flux by\n$$\nF_{\\mathrm{adv}} = u_{\\mathrm{up}} \\rho_{\\mathrm{up}} Y_{F,\\mathrm{up}},\n$$\nwhere the upwind state is selected by the sign of $u$ (use the left state if $u \\ge 0$, otherwise the right state). Quantify numerical species diffusion as\n$$\n\\mathcal{D} = \\left|F_{\\rho Y_F} - F_{\\mathrm{adv}}\\right|,\n$$\nwith units $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nCompute $\\mathcal{D}$ for both the preconditioned and unpreconditioned HLLC fluxes at the following test cases, each scientifically plausible and internally consistent:\n\n- Case A (happy path, strong composition contact): $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $p_R = 1.0\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = +0.05$.\n- Case B (small pressure jump at low Mach): $p_L = 1.001\\times10^5\\,\\mathrm{Pa}$, $p_R = 0.999\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = +0.05$.\n- Case C (extremely low Mach with small pressure jump): $p_L = 1.0001\\times10^5\\,\\mathrm{Pa}$, $p_R = 0.9999\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = +0.001$.\n- Case D (negative velocity contact): $p_L = 1.0\\times10^5\\,\\mathrm{Pa}$, $p_R = 1.0\\times10^5\\,\\mathrm{Pa}$, $T_L = T_R = 1000\\,\\mathrm{K}$, $Y_{F,L} = 0.99$, $Y_{F,R} = 0.01$, $M = -0.05$.\n\nUse $\\gamma = 1.4$, $W_F = 16\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ (methane-like fuel), $W_O = 32\\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$ (oxygen), and $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. For each case, compute the preconditioned numerical diffusion $\\mathcal{D}_{\\mathrm{pre}}$ with $\\alpha = \\max(|M|,10^{-6})$ and the unpreconditioned numerical diffusion $\\mathcal{D}_{\\mathrm{un}}$ with $\\alpha = 1$. Express all fluxes and diffusion magnitudes in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\mathcal{D}_{\\mathrm{pre}}^{A}, \\mathcal{D}_{\\mathrm{un}}^{A}, \\mathcal{D}_{\\mathrm{pre}}^{B}, \\mathcal{D}_{\\mathrm{un}}^{B}, \\mathcal{D}_{\\mathrm{pre}}^{C}, \\mathcal{D}_{\\mathrm{un}}^{C}, \\mathcal{D}_{\\mathrm{pre}}^{D}, \\mathcal{D}_{\\mathrm{un}}^{D}],\n$$\neach a floating-point number in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.",
            "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically the formulation of the Harten-Lax-van Leer-Contact (HLLC) approximate Riemann solver for the Euler equations with a passive scalar. The problem is well-posed, with all necessary parameters, equations, and boundary conditions provided for a unique solution. The numerical values are physically plausible for low-Mach number combustion scenarios.\n\nThe objective is to quantify the numerical diffusion of a passive species (fuel mass fraction $Y_F$) across a contact discontinuity, comparing the standard HLLC solver with a low-Mach preconditioned variant. The numerical diffusion, $\\mathcal{D}$, is defined as the absolute difference between the HLLC species flux, $F_{\\rho Y_F}$, and a reference purely advective upwind flux, $F_{\\mathrm{adv}}$.\n\nThe solution proceeds by implementing the specified algorithm for each test case, once with preconditioning and once without. The core steps for each calculation are as follows:\n\n1.  **State Initialization:** For each side of the interface, left ($L$) and right ($R$), the primitive variables $(p_K, T_K, Y_{F,K})$ are used to compute the required thermodynamic and gas-dynamic properties.\n    -   The mixture molecular weight $W_K$ is calculated using the formula $W(Y_{F,K}) = \\left(\\frac{Y_{F,K}}{W_F} + \\frac{1-Y_{F,K}}{W_O}\\right)^{-1}$.\n    -   The mixture specific gas constant is $R_K = R(Y_{F,K}) = \\frac{R_u}{W_K}$.\n    -   The density is found from the ideal gas law: $\\rho_K = \\frac{p_K}{R_K T_K}$.\n    -   The speed of sound is $c_K = \\sqrt{\\gamma R_K T_K}$.\n\n2.  **Velocity and Preconditioning Setup:**\n    -   The velocity is set to be uniform across the interface, determined by the Mach number $M$ and the left-side sound speed: $u_L = u_R = u = M c_L$.\n    -   The preconditioning factor $\\alpha$ is determined. For the unpreconditioned case, $\\alpha=1$. For the preconditioned case, $\\alpha = \\max(|M|, \\varepsilon)$, where $\\varepsilon=10^{-6}$.\n    -   The acoustically scaled sound speeds are then $\\tilde{c}_K = \\alpha c_K$.\n\n3.  **HLLC Wave Speed Estimation:** The three characteristic wave speeds of the HLLC solver are estimated.\n    -   The fastest left- and right-propagating acoustic wave speeds, $S_L$ and $S_R$, are estimated using the Davis formulation with the (preconditioned) sound speeds:\n        $$\n        S_L = \\min(u_L - \\tilde{c}_L, u_R - \\tilde{c}_R)\n        $$\n        $$\n        S_R = \\max(u_L + \\tilde{c}_L, u_R + \\tilde{c}_R)\n        $$\n    -   The contact wave speed, $S_*$, is calculated from the jump conditions across the acoustic waves:\n        $$\n        S_* = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)}\n        $$\n        A crucial observation is that if the pressures are equal ($p_L=p_R$) and velocities are equal ($u_L=u_R=u$), the expression for $S_*$ simplifies to $S_*=u$. This occurs in test cases A and D.\n\n4.  **HLLC Species Flux Calculation:** The species flux $F_{\\rho Y_F}$ at the interface (where $x/t=0$) is determined by which of the four regions defined by the wave speeds contains the interface.\n    -   If $0 \\le S_L$: $F_{\\rho Y_F} = F_L = \\rho_L u_L Y_{F,L}$\n    -   If $S_L  0 \\le S_*$: $F_{\\rho Y_F} = F_L + S_L (U_{*L} - U_L) = \\rho_L u_L Y_{F,L} + S_L \\left(\\rho_L Y_{F,L} \\frac{S_L-u_L}{S_L-S_*} \\right)$\n    -   If $S_*  0 \\le S_R$: $F_{\\rho Y_F} = F_R + S_R (U_{*R} - U_R) = \\rho_R u_R Y_{F,R} + S_R \\left(\\rho_R Y_{F,R} \\frac{S_R-u_R}{S_R-S_*} \\right)$\n    -   If $S_R \\le 0$: $F_{\\rho Y_F} = F_R = \\rho_R u_R Y_{F,R}$\n    The intermediate species states $(\\rho Y_F)_{*K}$ are derived from $(\\rho Y_F)_{*K} = \\rho_{*K} Y_{F,K}$ with $\\rho_{*K}$ defined in the problem. The flux expressions above are simplified forms for the species component.\n\n5.  **Reference Advective Flux Calculation:** The ideal, non-diffusive flux is the simple upwind flux $F_{\\mathrm{adv}}$. Since $u_L=u_R=u$, the choice of upwind state depends only on the sign of $u$.\n    -   If $u \\ge 0$: $F_{\\mathrm{adv}} = \\rho_L u Y_{F,L}$\n    -   If $u  0$: $F_{\\mathrm{adv}} = \\rho_R u Y_{F,R}$\n\n6.  **Numerical Diffusion Quantification:** The numerical diffusion is the magnitude of the difference between the HLLC flux and the ideal advective flux:\n    $$\n    \\mathcal{D} = |F_{\\rho Y_F} - F_{\\mathrm{adv}}|\n    $$\n\nThis procedure is systematically applied to the four test cases for both preconditioned and unpreconditioned scenarios.\n\n- **Cases A and D (isobaric contact):** In these cases, $p_L = p_R$, which leads to $S_* = u$. This means the HLLC solver correctly identifies the contact wave speed as the material velocity. For $u0$ (Case A), this results in $S_L0 \\le S_*$. The HLLC species flux simplifies to $F_{\\rho Y_F} = \\rho_L u Y_{F,L}$, which is exactly $F_{\\mathrm{adv}}$. For $u0$ (Case D), $S_*  0 \\le S_R$ and the flux simplifies to $F_{\\rho Y_F} = \\rho_R u Y_{F,R}$, which is also $F_{\\mathrm{adv}}$. Therefore, for both preconditioned and unpreconditioned solvers, the numerical diffusion $\\mathcal{D}$ is zero in Cases A and D. This is an expected result, as a well-constructed HLLC solver should perfectly resolve an isolated contact discontinuity.\n\n- **Cases B and C (non-isobaric contact):** Here, $p_L \\neq p_R$, so $S_* \\neq u$.\n    -   For the **unpreconditioned** solver ($\\alpha=1$), the acoustic wave speeds $S_L$ and $S_R$ are large (order $c$). The deviation of $S_*$ from $u$ introduces a non-zero correction term in the HLLC flux calculation, leading to $F_{\\rho Y_F} \\neq F_{\\mathrm{adv}}$ and thus a non-zero numerical diffusion $\\mathcal{D}_{\\mathrm{un}}  0$.\n    -   For the **preconditioned** solver, $\\alpha = |M|$, which is small. This drastically reduces the magnitude of the estimated acoustic wave speeds $\\tilde{c}_K$. For $M0$, we find that the preconditioned estimate gives $u_L - \\tilde{c}_L = M c_L - M c_L = 0$, leading to $S_L=0$. The flux calculation then falls into the first case ($0 \\le S_L$), giving $F_{\\rho Y_F} = \\rho_L u_L Y_{F,L} = F_{\\mathrm{adv}}$. Consequently, the preconditioned numerical diffusion is $\\mathcal{D}_{\\mathrm{pre}} = 0$.\n\nThis analysis demonstrates the efficacy of low-Mach preconditioning. By scaling down the acoustic wave speeds in the low-Mach limit, the solver correctly identifies the flow as advection-dominated and avoids introducing spurious diffusion associated with acoustic waves that are numerically large but physically weak. The preconditioning effectively decouples the species transport from the small pressure fluctuations.\n\nThe following Python program implements these calculations to find the numerical values for all eight required quantities.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the numerical species diffusion for preconditioned and unpreconditioned\n    HLLC fluxes for various low-Mach number test cases.\n    \"\"\"\n\n    # --- Constants and Physical Parameters ---\n    GAMMA = 1.4\n    W_F = 16.0e-3  # kg/mol (Methane-like)\n    W_O = 32.0e-3  # kg/mol (Oxygen-like)\n    R_U = 8.314462618  # J/(mol*K)\n    EPSILON = 1.0e-6\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A: Happy path, strong composition contact\n        {'pL': 1.0e5, 'pR': 1.0e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.05},\n        # Case B: Small pressure jump at low Mach\n        {'pL': 1.001e5, 'pR': 0.999e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.05},\n        # Case C: Extremely low Mach with small pressure jump\n        {'pL': 1.0001e5, 'pR': 0.9999e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': 0.001},\n        # Case D: Negative velocity contact\n        {'pL': 1.0e5, 'pR': 1.0e5, 'TL': 1000.0, 'TR': 1000.0, 'YFL': 0.99, 'YFR': 0.01, 'M': -0.05},\n    ]\n\n    def calculate_diffusion(case, preconditioned):\n        \"\"\"\n        Calculates the numerical diffusion for a single case setup.\n        \"\"\"\n        # Extract parameters from the case dictionary\n        pL, pR = case['pL'], case['pR']\n        TL, TR = case['TL'], case['TR']\n        YFL, YFR = case['YFL'], case['YFR']\n        M = case['M']\n\n        # --- Step 1: State Initialization ---\n        # Left state\n        W_L = 1.0 / (YFL / W_F + (1.0 - YFL) / W_O)\n        R_L = R_U / W_L\n        rho_L = pL / (R_L * TL)\n        c_L = np.sqrt(GAMMA * R_L * TL)\n        \n        # Right state\n        W_R = 1.0 / (YFR / W_F + (1.0 - YFR) / W_O)\n        R_R = R_U / W_R\n        rho_R = pR / (R_R * TR)\n        c_R = np.sqrt(GAMMA * R_R * TR)\n\n        # --- Step 2: Velocity and Preconditioning ---\n        u = M * c_L\n        uL = uR = u\n\n        if preconditioned:\n            alpha = max(abs(M), EPSILON)\n        else:\n            alpha = 1.0\n        \n        tilde_c_L = alpha * c_L\n        tilde_c_R = alpha * c_R\n        \n        # --- Step 3: HLLC Wave Speed Estimation ---\n        SL = min(uL - tilde_c_L, uR - tilde_c_R)\n        SR = max(uL + tilde_c_L, uR + tilde_c_R)\n\n        num_S_star = pR - pL + rho_L * uL * (SL - uL) - rho_R * uR * (SR - uR)\n        den_S_star = rho_L * (SL - uL) - rho_R * (SR - uR)\n        \n        if abs(den_S_star)  1e-12: # Avoid division by zero, though not expected here\n             # This case mainly happens for pL=pR and uL=uR, where S* = u\n             S_star = u\n        else:\n             S_star = num_S_star / den_S_star\n\n        # --- Step 4: HLLC Species Flux Calculation ---\n        flux_YL = rho_L * uL * YFL\n        flux_YR = rho_R * uR * YFR\n        rhoYF_L = rho_L * YFL\n        rhoYF_R = rho_R * YFR\n\n        if 0.0 = SL:\n            F_rhoYF = flux_YL\n        elif SL  0.0 = S_star:\n            # This is F_L + S_L * (U*L_rhoYF - U_L_rhoYF)\n            rhoYF_star_L = rho_L * YFL * (SL - uL) / (SL - S_star)\n            F_rhoYF = flux_YL + SL * (rhoYF_star_L - rhoYF_L)\n        elif S_star  0.0 = SR:\n            # This is F_R + S_R * (U*R_rhoYF - U_R_rhoYF)\n            rhoYF_star_R = rho_R * YFR * (SR - uR) / (SR - S_star)\n            F_rhoYF = flux_YR + SR * (rhoYF_star_R - rhoYF_R)\n        else:  # SR  0.0\n            F_rhoYF = flux_YR\n\n        # --- Step 5: Reference Advective Flux ---\n        if u = 0.0:\n            F_adv = flux_YL\n        else:\n            F_adv = flux_YR\n            \n        # --- Step 6: Numerical Diffusion ---\n        D = abs(F_rhoYF - F_adv)\n        return D\n\n    results = []\n    for case in test_cases:\n        D_pre = calculate_diffusion(case, preconditioned=True)\n        D_un = calculate_diffusion(case, preconditioned=False)\n        results.extend([D_pre, D_un])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}