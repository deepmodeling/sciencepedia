{
    "hands_on_practices": [
        {
            "introduction": "在算子分裂方法中，输运过程常采用显式格式求解，其时间步长受限于严格的稳定性条件。本练习  将指导你亲手计算一个典型的显式输运子步长的最大允许时间步长。通过同时考虑对流-声波（双曲型）和扩散（抛物型）过程的稳定性约束，你将掌握设置任何显式模拟时至关重要的第一步。",
            "id": "4046974",
            "problem": "考虑一个一维算子分裂燃烧求解器，其中输运子步使用有限体积法显式推进可压缩流变量，而化学子步则由一个隐式刚性常微分方程积分器单独求解。输运子步必须相对于双曲（声-对流）算子和抛物（粘性-扩散）算子保持稳定。\n\n给定一个包含五个控制体积的网格，其空间步长为 $(\\Delta x_1,\\Delta x_2,\\Delta x_3,\\Delta x_4,\\Delta x_5) = (4.0\\times 10^{-4},\\,6.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,3.0\\times 10^{-4},\\,7.0\\times 10^{-4})\\ \\mathrm{m}$，局部流动状态为 $(u_1,u_2,u_3,u_4,u_5) = (2.0,\\,1.5,\\,-0.5,\\,1.0,\\,2.5)\\ \\mathrm{m/s}$，对应的局部声速为 $(a_1,a_2,a_3,a_4,a_5) = (420,\\,380,\\,400,\\,450,\\,390)\\ \\mathrm{m/s}$。显式输运更新的 Courant-Friedrichs-Lewy (CFL) 数为 $\\text{CFL} = 0.4$。\n\n输运子步中的扩散算子采用时间上前向欧拉法和空间上二阶中心差分法进行推进。动力粘度和密度分别为 $(\\mu_1,\\mu_2,\\mu_3,\\mu_4,\\mu_5) = (5.0\\times 10^{-5},\\,4.6\\times 10^{-5},\\,4.8\\times 10^{-5},\\,5.5\\times 10^{-5},\\,4.7\\times 10^{-5})\\ \\mathrm{Pa\\cdot s}$ 和 $(\\rho_1,\\rho_2,\\rho_3,\\rho_4,\\rho_5) = (0.35,\\,0.40,\\,0.30,\\,0.32,\\,0.38)\\ \\mathrm{kg/m^3}$。最大组分质量扩散系数为 $D_{\\max} = 2.0\\times 10^{-4}\\ \\mathrm{m^2/s}$。假设在扩散稳定性评估中使用一维设定。\n\n从控制性双曲输运方程及其特征波速出发，推导显式输运更新的稳定性要求，并利用给定数据计算与声-对流稳定性要求一致的最大允许输运时间步长 $\\Delta t_T$。然后，从扩散方程和 von Neumann 分析出发，写出粘性-扩散稳定性约束，并评估对于这些数据，该约束是比声-对流约束更严格还是更宽松。讨论在算子分裂格式中，粘性-扩散约束如何与输运时间步长耦合。\n\n将输运时间步长的最终数值四舍五入至三位有效数字，并以微秒表示。",
            "solution": "用户提供了一个计算燃烧学问题，要求计算并比较一个算子分裂数值格式中受稳定性限制的时间步长。在尝试求解之前，需要对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n问题陈述中提供的数据和条件如下：\n- **数值格式：** 一维算子分裂求解器。输运子步为显式有限体积法。化学子步为隐式。\n- **网格：** 五个控制体积，其空间步长为 $(\\Delta x_1, \\Delta x_2, \\Delta x_3, \\Delta x_4, \\Delta x_5) = (4.0 \\times 10^{-4}, 6.0 \\times 10^{-4}, 5.0 \\times 10^{-4}, 3.0 \\times 10^{-4}, 7.0 \\times 10^{-4})\\ \\mathrm{m}$。\n- **流动状态：** 局部速度 $(u_1, u_2, u_3, u_4, u_5) = (2.0, 1.5, -0.5, 1.0, 2.5)\\ \\mathrm{m/s}$。\n- **声学状态：** 局部声速 $(a_1, a_2, a_3, a_4, a_5) = (420, 380, 400, 450, 390)\\ \\mathrm{m/s}$。\n- **双曲稳定性：** Courant-Friedrichs-Lewy 数 $\\text{CFL} = 0.4$。\n- **扩散格式：** 时间上为前向欧拉法，空间上为二阶中心差分。\n- **流体性质：**\n  - 动力粘度 $(\\mu_1, \\mu_2, \\mu_3, \\mu_4, \\mu_5) = (5.0 \\times 10^{-5}, 4.6 \\times 10^{-5}, 4.8 \\times 10^{-5}, 5.5 \\times 10^{-5}, 4.7 \\times 10^{-5})\\ \\mathrm{Pa \\cdot s}$。\n  - 密度 $(\\rho_1, \\rho_2, \\rho_3, \\rho_4, \\rho_5) = (0.35, 0.40, 0.30, 0.32, 0.38)\\ \\mathrm{kg/m^3}$。\n- **组分输运：** 最大组分质量扩散系数 $D_{\\max} = 2.0 \\times 10^{-4}\\ \\mathrm{m^2/s}$。\n- **任务：**\n  1. 推导双曲（声-对流）稳定性要求，并计算最大允许输运时间步长 $\\Delta t_T$。\n  2. 推导粘性-扩散稳定性约束，并评估其是更严格还是更宽松。\n  3. 讨论约束之间的耦合关系。\n  4. 提供 $\\Delta t_T$ 的最终数值，以微秒为单位，四舍五入至三位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题牢固地植根于计算流体动力学（CFD）和应用于反应流的数值分析原理。算子分裂、双曲系统的 CFL 条件以及抛物系统的扩散稳定性等概念都是标准和基础的。密度、粘度和声速的物理值对于燃烧环境中的气体混合物是合理的。\n- **适定的：** 该问题提供了计算所需时间步长限制的所有必要数据。任务定义清晰，能够导出一个唯一且有意义的解。\n- **客观的：** 问题陈述使用了精确的技术语言，没有主观或含糊的术语。\n- **结论：** 问题是自洽的、科学上合理的且适定的。未发现任何缺陷。\n\n**步骤 3：结论与行动**\n\n问题有效。将提供完整解答。\n\n### 求解\n\n该问题要求确定并比较一维燃烧求解器中显式输运子步的两个稳定性约束对时间步长的影响。\n\n**1. 声-对流（双曲）稳定性**\n\n输运子步求解可压缩流方程，这些方程构成一个双曲型偏微分方程组。对于一维欧拉方程，特征波速由 $u$、$u+a$ 和 $u-a$ 给出，其中 $u$ 是局部流体速度，$a$ 是局部声速。信息以 $|u|+a$ 的速度传播。\n\n对于一个显式有限体积格式，必须满足 Courant-Friedrichs-Lewy (CFL) 条件以确保数值稳定性。CFL 条件指出，数值依赖域必须包含物理依赖域。对于给定的控制体积 $i$，这表示为：\n$$ \\text{CFL}_i = \\frac{(|u_i| + a_i) \\Delta t_T}{\\Delta x_i} \\le \\text{CFL}_{\\max} $$\n在此问题中，我们给定一个固定的 CFL 数 $\\text{CFL} = 0.4$，用作上限。因此，每个单元 $i$ 的最大允许时间步长，记为 $\\Delta t_{T,i}$，为：\n$$ \\Delta t_{T,i} = \\frac{\\text{CFL} \\cdot \\Delta x_i}{|u_i| + a_i} $$\n为确保整个计算域的稳定性，全局输运时间步长 $\\Delta t_T$ 必须不大于所有单元允许时间步长的最小值：\n$$ \\Delta t_T = \\min_i \\left( \\Delta t_{T,i} \\right) = \\min_i \\left( \\frac{\\text{CFL} \\cdot \\Delta x_i}{|u_i| + a_i} \\right) $$\n我们现在为给定的五个控制体积中的每一个计算这个值：\n- 单元 1: $\\Delta t_{T,1} = \\frac{0.4 \\times (4.0 \\times 10^{-4})}{ |2.0| + 420 } = \\frac{1.6 \\times 10^{-4}}{422} \\approx 3.791 \\times 10^{-7}\\ \\mathrm{s}$\n- 单元 2: $\\Delta t_{T,2} = \\frac{0.4 \\times (6.0 \\times 10^{-4})}{ |1.5| + 380 } = \\frac{2.4 \\times 10^{-4}}{381.5} \\approx 6.291 \\times 10^{-7}\\ \\mathrm{s}$\n- 单元 3: $\\Delta t_{T,3} = \\frac{0.4 \\times (5.0 \\times 10^{-4})}{ |-0.5| + 400 } = \\frac{2.0 \\times 10^{-4}}{400.5} \\approx 4.994 \\times 10^{-7}\\ \\mathrm{s}$\n- 单元 4: $\\Delta t_{T,4} = \\frac{0.4 \\times (3.0 \\times 10^{-4})}{ |1.0| + 450 } = \\frac{1.2 \\times 10^{-4}}{451} \\approx 2.661 \\times 10^{-7}\\ \\mathrm{s}$\n- 单元 5: $\\Delta t_{T,5} = \\frac{0.4 \\times (7.0 \\times 10^{-4})}{ |2.5| + 390 } = \\frac{2.8 \\times 10^{-4}}{392.5} \\approx 7.134 \\times 10^{-7}\\ \\mathrm{s}$\n\n这些值中的最小值决定了全局时间步长：\n$$ \\Delta t_T = \\min(3.791, 6.291, 4.994, 2.661, 7.134) \\times 10^{-7}\\ \\mathrm{s} = 2.661 \\times 10^{-7}\\ \\mathrm{s} $$\n问题要求将此值以微秒（$\\mathrm{1\\ \\mu s = 10^{-6}\\ s}$）表示，并四舍五入至三位有效数字。\n$$ \\Delta t_T = 2.661 \\times 10^{-7}\\ \\mathrm{s} = 0.2661\\ \\mathrm{\\mu s} \\approx 0.266\\ \\mathrm{\\mu s} $$\n\n**2. 粘性-扩散（抛物）稳定性**\n\n粘性-扩散项由抛物型偏微分方程建模，例如热方程或通用扩散方程 $\\frac{\\partial \\phi}{\\partial t} = \\nu \\frac{\\partial^2 \\phi}{\\partial x^2}$，其中 $\\nu$ 代表相关的扩散系数（例如，热扩散系数、运动粘度或质量扩散系数）。\n问题指出，这些项采用时间上前向欧拉格式和空间上二阶中心差分（FTCS 格式）进行离散化。对扩散方程的 FTCS 格式进行 von Neumann 稳定性分析，得出对时间步长 $\\Delta t_D$ 的以下稳定性约束：\n$$ \\Delta t_D \\le \\frac{(\\Delta x)^2}{2\\nu} $$\n对于所有相关的扩散过程：动量（粘性）、能量（热传导）和组分（质量扩散），都必须满足此约束。总的扩散时间步长限制由最大的扩散系数和最小的网格间距决定。\n有效扩散系数 $\\nu_{\\text{eff}}$ 是运动粘度 $\\nu = \\mu/\\rho$、热扩散系数 $\\alpha = k/(\\rho c_p)$（未提供数据）和组分质量扩散系数 $D$ 中的最大值。我们已知最大组分扩散系数 $D_{\\max} = 2.0 \\times 10^{-4}\\ \\mathrm{m^2/s}$。我们必须首先计算每个单元的运动粘度，以确定起控制作用的扩散系数。\n- $\\nu_1 = \\frac{\\mu_1}{\\rho_1} = \\frac{5.0 \\times 10^{-5}}{0.35} \\approx 1.43 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_2 = \\frac{\\mu_2}{\\rho_2} = \\frac{4.6 \\times 10^{-5}}{0.40} = 1.15 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_3 = \\frac{\\mu_3}{\\rho_3} = \\frac{4.8 \\times 10^{-5}}{0.30} = 1.60 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_4 = \\frac{\\mu_4}{\\rho_4} = \\frac{5.5 \\times 10^{-5}}{0.32} \\approx 1.72 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_5 = \\frac{\\mu_5}{\\rho_5} = \\frac{4.7 \\times 10^{-5}}{0.38} \\approx 1.24 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n将这些值与给定的 $D_{\\max} = 2.0 \\times 10^{-4}\\ \\mathrm{m^2/s}$ 进行比较，我们发现组分扩散系数是系统中最大的扩散系数。因此，$\\nu_{\\text{eff}} = D_{\\max} = 2.0 \\times 10^{-4}\\ \\mathrm{m^2/s}$。\n\n在网格间距最小的区域，稳定性约束最为严格，即 $\\Delta x_{\\min} = \\Delta x_4 = 3.0 \\times 10^{-4}\\ \\mathrm{m}$。基于扩散稳定性约束的最大允许时间步长 $\\Delta t_{D, \\text{limit}}$ 为：\n$$ \\Delta t_{D, \\text{limit}} = \\frac{(\\Delta x_{\\min})^2}{2 \\nu_{\\text{eff}}} = \\frac{(3.0 \\times 10^{-4}\\ \\mathrm{m})^2}{2 \\times (2.0 \\times 10^{-4}\\ \\mathrm{m^2/s})} = \\frac{9.0 \\times 10^{-8}}{4.0 \\times 10^{-4}}\\ \\mathrm{s} = 2.25 \\times 10^{-4}\\ \\mathrm{s} $$\n这对应于 $225\\ \\mathrm{\\mu s}$。\n\n**3. 比较与讨论**\n\n比较两个稳定性极限：\n- 声-对流极限: $\\Delta t_T \\approx 0.266\\ \\mathrm{\\mu s}$\n- 粘性-扩散极限: $\\Delta t_{D, \\text{limit}} = 225\\ \\mathrm{\\mu s}$\n\n显然，$\\Delta t_T \\ll \\Delta t_{D, \\text{limit}}$。对于给定的数据，声-对流（双曲）稳定性要求比粘性-扩散（抛物）要求严格约三个数量级。这在可压缩流模拟中是一种常见情况，其中高特征波速（$|u|+a$）与精细网格相结合，导致由 CFL 条件决定的时间步长非常小。扩散约束与 $(\\Delta x)^2$ 成比例，而双曲 CFL 约束与 $\\Delta x$ 成比例。只有在极精细的网格上，或者在 $a$ 不是主导速度的极低速（近乎不可压缩）流动中，扩散约束才会比双曲约束更严格。\n\n在算子分裂格式中，如果整个输运子步（包括对流项和扩散项）都采用显式推进，那么用于该子步的单个时间步长 $\\Delta t_{\\text{transport}}$ 必须满足所有相关的显式稳定性准则。因此，这些约束之间的耦合关系是有效时间步长必须是各个极限中的最小值：\n$$ \\Delta t_{\\text{transport}} \\le \\min(\\Delta t_T, \\Delta t_{D, \\text{limit}}) $$\n对于此问题，输运求解器受双曲 CFL 条件的限制。输运子步的最大允许时间步长为 $\\Delta t_T \\approx 0.266\\ \\mathrm{\\mu s}$。\n\n最终要求的答案是由声-对流稳定性要求计算出的输运时间步长 $\\Delta t_T$。\n$$ \\Delta t_T \\approx 0.266\\ \\mathrm{\\mu s} $$",
            "answer": "$$\n\\boxed{0.266}\n$$"
        },
        {
            "introduction": "本练习  是一个综合性的实践，旨在让你将前面学到的概念融会贯通。你将亲手实现一个完整的Strang分裂格式，并将其与一种先进的非分裂隐式-显式（IMEX）方法进行比较。这项实践超越了基本概念，引导你探索在准确性和计算成本之间的实际权衡，这是为特定反应流问题选择合适数值方法时需要考虑的核心问题。",
            "id": "4046958",
            "problem": "考虑一个由组分守恒定律和菲克扩散控制的一维、等温、单组分反应流，其定义在一个周期性域上。从质量守恒和扩散通量的本构定律出发，可得到周期性区间 $x \\in [0,1]$ 上组分质量分数 $Y(x,t)$ 的无量纲平流-扩散-反应方程为\n$$\n\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^2 Y}{\\partial x^2} + \\omega(Y),\n$$\n其中 $u$ 是一个恒定的无量纲平流速度，$D$ 是一个无量纲扩散系数，$\\omega(Y)$ 是化学源项。假设一个线性的、不可逆的一阶反应，$\\omega(Y) = -k\\,Y$，其中 $k$ 是一个无量纲刚度参数，表示化学时间尺度与输运时间尺度的比率。设初始条件为一个光滑、局域化的质量分数，由下式给出\n$$\nY(x,0) = Y_0(x) = \\alpha + \\exp\\left(-\\frac{(x-x_c)^2}{2\\sigma^2}\\right),\n$$\n参数为 $\\alpha = 0.05$，$x_c = 0.3$，以及 $\\sigma = 0.05$，并在 $[0,1]$ 上具有周期性边界条件。所有量均视为无量纲。\n\n您必须实现并比较两种针对半离散（空间上）系统的时间积分方法：\n- 算子分裂法，在化学和输运之间使用 Strang 分裂，其中化学子问题和输运子问题在每个时间步内分别推进。\n- 非分裂的隐式-显式（IMEX）欧拉积分法，它在一个耦合的更新中显式处理输运项，隐式处理反应项。\n\n空间离散化要求：\n- 使用 $N$ 个均匀间隔的点和周期性边界条件对 $x \\in [0,1]$ 进行离散化。\n- 对平流项 $\\frac{\\partial Y}{\\partial x}$ 使用一阶迎风格式，对扩散项 $\\frac{\\partial^2 Y}{\\partial x^2}$ 使用二阶中心差分格式。\n- 显式输运时间步必须满足由 Courant–Friedrichs–Lewy（CFL）条件的平流部分和显式扩散稳定性极限推导出的标准稳定性约束。具体来说，对于网格间距 $\\Delta x$，选择一个时间步 $\\Delta t$ 使得\n$$\n\\Delta t \\le \\min\\left(\\text{CFL}_a \\frac{\\Delta x}{|u|},\\; \\text{CFL}_d \\frac{\\Delta x^2}{2D},\\; \\Delta t_{\\max}\\right),\n$$\n其中 $\\text{CFL}_a$ 和 $\\text{CFL}_d$ 是给定的常数，$\\Delta t_{\\max}$ 是一个全局上限，以防止在 $u = 0$ 和 $D = 0$ 时步长过大。最终时间 $T$ 必须通过相应调整 $\\Delta t$ 以整数步数达到。\n\n时间积分规范：\n- 对于算子分裂，在每个时间步 $\\Delta t$ 上使用 Strang 分裂：先为 $\\Delta t/2$ 推进化学反应，然后为 $\\Delta t$ 推进输运，再为 $\\Delta t/2$ 推进化学反应。对于化学半步，使用线性反应的精确解 $Y(t+\\tau) = Y(t)\\exp(-k\\tau)$。为了将精度驱动的计算工作量建模为刚度的函数，将每个化学半步细分为 $m_{\\text{sub}}$ 个子步，其中\n$$\nm_{\\text{sub}} = \\max\\left(1,\\; \\left\\lceil \\frac{k\\,\\Delta t}{\\chi} \\right\\rceil \\right),\n$$\n其中 $\\chi$ 是一个给定的类容差参数。这模拟了随着刚度增加，对快速化学反应需要更精细解析的需求，并引入了依赖于刚度的成本。\n- 对于非分裂的隐式-显式（IMEX）欧拉方法，计算时间层级 $n$ 的显式输运残差，并使用反应项的隐式后向欧拉处理来更新 $Y^{n+1}$：\n$$\nY^{n+1} = \\frac{Y^n + \\Delta t\\left(-u\\,\\partial_x Y^n + D\\,\\partial_{xx}Y^n\\right)}{1 + k\\,\\Delta t}.\n$$\n\n用于误差估计的参考解：\n- 通过使用更小的时间步 $\\Delta t_{\\text{ref}} = \\Delta t / r$（其中整数细化因子 $r \\ge 6$）积分相同的半离散方程，构建一个高保真参考解 $Y_{\\text{ref}}(x,T)$，使得时间离散误差相对于测试方法显著减小。\n\n误差和成本度量：\n- 计算每种方法在最终时间 $T$ 相对于参考解的离散时空 $L^2$ 误差：\n$$\nE = \\left(\\Delta x \\sum_{i=1}^{N} \\left(Y_i(T) - Y_{\\text{ref},i}(T)\\right)^2\\right)^{1/2}.\n$$\n- 将计算成本量化为一个与刚度和流场梯度成比例的操作计数代理：\n  - 对于算子分裂，定义\n  $$\n  C_{\\text{split}} = N \\times N_{\\text{steps}} \\times \\left(1 + 2\\,m_{\\text{sub}}\\right),\n  $$\n  其中 $N_{\\text{steps}} = \\left\\lceil \\frac{T}{\\Delta t} \\right\\rceil$ 是时间步数，项 $1$ 表示每步一次输运更新，$2\\,m_{\\text{sub}}$ 表示两次化学半步，每次半步又细分为 $m_{\\text{sub}}$ 个子步。\n  - 对于 IMEX 欧拉方法，定义\n  $$\n  C_{\\text{IMEX}} = N \\times N_{\\text{steps}} \\times 2,\n  $$\n  其中因子 $2$ 解释为每步一次输运残差评估和一次隐式反应更新。\n\n程序要求：\n- 在一个具有 $N = 256$，$\\text{CFL}_a = 0.8$，$\\text{CFL}_d = 0.4$，$\\Delta t_{\\max} = 0.005$，$\\chi = 0.01$ 和最终时间 $T = 0.05$ 的均匀网格上，使用指定的离散化方法实现这两种方法。使用下面测试套件中提供的无量纲参数。\n- 使用周期性边界条件。\n- 使用 $r = 8$ 来定义 $\\Delta t_{\\text{ref}}$。\n- 按规定计算并输出每个测试用例的误差和成本。\n\n测试套件：\n- 案例 1：$(k = 20,\\; u = 0.5,\\; D = 0.01)$。\n- 案例 2：$(k = 1,\\; u = 0.1,\\; D = 0.0)$。\n- 案例 3：$(k = 200,\\; u = 0.5,\\; D = 0.01)$。\n- 案例 4：$(k = 20,\\; u = 1.0,\\; D = 0.02)$。\n- 案例 5：$(k = 50,\\; u = 0.0,\\; D = 0.0)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。对于每个测试用例，按顺序附加四个量：$E_{\\text{split}}$，$E_{\\text{IMEX}}$，$C_{\\text{split}}$，$C_{\\text{IMEX}}$。因此，最终打印的列表应包含 $4 \\times 5 = 20$ 个数值条目，例如 $[e_1^{\\text{split}},e_1^{\\text{IMEX}},c_1^{\\text{split}},c_1^{\\text{IMEX}},\\dots,e_5^{\\text{split}},e_5^{\\text{IMEX}},c_5^{\\text{split}},c_5^{\\text{IMEX}}]$。所有误差和成本都是无量纲数。",
            "solution": "该问题是有效的。它提出了一个计算物理学领域中定义明确、具有科学依据的任务，具体涉及反应流偏微分方程（PDE）的数值分析。所有必要的物理参数、数值规范和评估指标都已提供，并且问题没有矛盾或含糊之处。\n\n该问题要求对一维平流-扩散-反应（ADR）方程的两种时间积分方案——Strang 算子分裂和隐式-显式（IMEX）欧拉方法——进行数值比较。分析内容包括实现这两种方法，计算它们的解，并评估它们相对于高保真参考解的准确性和计算成本。\n\n组分质量分数 $Y(x,t)$ 的控制 ADR 方程为：\n$$\n\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^2 Y}{\\partial x^2} - k Y\n$$\n该方程定义在周期性域 $x \\in [0,1]$ 上，其中 $u$ 为恒定平流速度，$D$ 为扩散系数，$k$ 为反应速率常数。\n\n**1. 半离散化（线方法）**\n\n我们首先将空间域 $x \\in [0,1]$ 离散为 $N$ 个均匀的网格单元，单元中心为 $x_i = (i-1/2)\\Delta x$，其中 $i=1, \\dots, N$，网格间距为 $\\Delta x = 1/N$。每个网格点上的质量分数记为 $Y_i(t) = Y(x_i, t)$。对空间导数应用有限差分近似，将单个 PDE 转化为一个包含 $N$ 个耦合常微分方程（ODE）的系统。设 $\\vec{Y}(t) = [Y_1(t), Y_2(t), \\dots, Y_N(t)]^T$。半离散系统为：\n$$\n\\frac{d\\vec{Y}}{dt} = \\mathcal{L}(\\vec{Y}) = \\mathcal{L}_{\\text{adv}}(\\vec{Y}) + \\mathcal{L}_{\\text{diff}}(\\vec{Y}) + \\mathcal{L}_{\\text{chem}}(\\vec{Y})\n$$\n其中 $\\mathcal{L}_{\\text{adv}}$、$\\mathcal{L}_{\\text{diff}}$ 和 $\\mathcal{L}_{\\text{chem}}$ 分别是平流、扩散和化学反应的离散算子。\n\n-   **平流算子 $\\mathcal{L}_{\\text{adv}}$**：对项 $-u \\frac{\\partial Y}{\\partial x}$ 使用一阶迎风格式。差分方向取决于速度 $u$ 的符号。\n    -   如果 $u > 0$（向右流动）：$(\\mathcal{L}_{\\text{adv}}(\\vec{Y}))_i = -u \\frac{Y_i - Y_{i-1}}{\\Delta x}$。\n    -   如果 $u  0$（向左流动）：$(\\mathcal{L}_{\\text{adv}}(\\vec{Y}))_i = -u \\frac{Y_{i+1} - Y_i}{\\Delta x}$。\n    -   如果 $u=0$，该项为零。\n    周期性边界条件意味着 $Y_0 = Y_N$ 和 $Y_{N+1} = Y_1$。\n\n-   **扩散算子 $\\mathcal{L}_{\\text{diff}}$**：对项 $D \\frac{\\partial^2 Y}{\\partial x^2}$ 使用二阶中心差分格式。\n    $$\n    (\\mathcal{L}_{\\text{diff}}(\\vec{Y}))_i = D \\frac{Y_{i+1} - 2Y_i + Y_{i-1}}{\\Delta x^2}\n    $$\n    同样，对超出 $[1, N]$ 范围的索引应用周期性边界条件。\n\n-   **化学算子 $\\mathcal{L}_{\\text{chem}}$**：线性反应项 $\\omega(Y) = -kY$ 变为简单的逐元素相乘。\n    $$\n    (\\mathcal{L}_{\\text{chem}}(\\vec{Y}))_i = -k Y_i\n    $$\n\n组合后的显式输运算子为 $\\mathcal{L}_T(\\vec{Y}) = \\mathcal{L}_{\\text{adv}}(\\vec{Y}) + \\mathcal{L}_{\\text{diff}}(\\vec{Y})$。\n\n**2. 时间步进与稳定性**\n\n时间步长 $\\Delta t$ 受到平流和扩散的显式有限差分格式稳定性的限制。Courant-Friedrichs-Lewy (CFL) 条件规定了允许的最大时间步长。规定的公式是：\n$$\n\\Delta t \\le \\min\\left(\\text{CFL}_a \\frac{\\Delta x}{|u|},\\; \\text{CFL}_d \\frac{\\Delta x^2}{2D},\\; \\Delta t_{\\max}\\right)\n$$\n其中 $\\text{CFL}_a=0.8$ 和 $\\text{CFL}_d=0.4$ 是稳定性因子，$\\Delta t_{\\max}=0.005$ 是一个上限。如果 $u=0$ 或 $D=0$，则最小值中的相应项被视为无穷大。为确保模拟恰好在最终时间 $T=0.05$ 结束，步数固定为 $N_{\\text{steps}} = \\lceil T/\\Delta t_{\\text{provisional}} \\rceil$，实际时间步长调整为 $\\Delta t = T / N_{\\text{steps}}$。\n\n**3. 数值积分方法**\n\n**a) Strang 算子分裂**\n\n该方法将刚性化学反应与非刚性输运解耦。完整算子 $\\mathcal{L}$ 被分裂为 $\\mathcal{L}_T$（输运）和 $\\mathcal{L}_{\\text{chem}}$（化学）。一个二阶精度的 Strang 分裂方案通过三个连续的子步骤将解从时间 $t^n$ 推进到 $t^{n+1} = t^n + \\Delta t$：\n1.  **化学半步：** 求解 $\\frac{d\\vec{Y}}{d\\tau} = \\mathcal{L}_{\\text{chem}}(\\vec{Y})$，时长为 $\\tau = \\Delta t/2$。对于线性反应，这有精确的解析解：\n    $$\n    \\vec{Y}^* = \\vec{Y}^n \\exp(-k \\Delta t/2)\n    $$\n2.  **输运全步：** 求解 $\\frac{d\\vec{Y}}{d\\tau} = \\mathcal{L}_T(\\vec{Y})$，时长为 $\\tau = \\Delta t$。此子步骤使用显式欧拉方法：\n    $$\n    \\vec{Y}^{**} = \\vec{Y}^* + \\Delta t \\cdot \\mathcal{L}_T(\\vec{Y}^*)\n    $$\n3.  **化学半步：** 再次求解化学 ODE，时长为 $\\tau = \\Delta t/2$：\n    $$\n    \\vec{Y}^{n+1} = \\vec{Y}^{**} \\exp(-k \\Delta t/2)\n    $$\n\n**b) 隐式-显式（IMEX）欧拉方法**\n\n此方法在一个耦合的更新中显式处理非刚性输运项，隐式处理可能刚性的反应项。这避免了与显式处理快速反应相关的稳定性限制。对输运应用前向欧拉格式，对化学应用后向欧拉格式，得到：\n$$\n\\frac{\\vec{Y}^{n+1} - \\vec{Y}^n}{\\Delta t} = \\mathcal{L}_{T}(\\vec{Y}^n) + \\mathcal{L}_{\\text{chem}}(\\vec{Y}^{n+1})\n$$\n代入离散算子：\n$$\n\\frac{Y_i^{n+1} - Y_i^n}{\\Delta t} = \\left(\\mathcal{L}_{T}(\\vec{Y}^n)\\right)_i - k Y_i^{n+1}\n$$\n整理得到 $Y_i^{n+1}$ 的更新规则：\n$$\nY_i^{n+1} (1 + k\\Delta t) = Y_i^n + \\Delta t \\left(\\mathcal{L}_{T}(\\vec{Y}^n)\\right)_i\n$$\n$$\nY_i^{n+1} = \\frac{Y_i^n + \\Delta t \\left(\\mathcal{L}_{T}(\\vec{Y}^n)\\right)_i}{1 + k\\Delta t}\n$$\n该方案在时间上是一阶精度的，但是 L-稳定的，使其能够处理刚性反应，而无需使用与化学时间尺度相关的极小时间步长。\n\n**4. 参考解、误差和成本**\n\n-   **参考解（$Y_{\\text{ref}}$）**：为了估计这两种方案的误差，使用稳健的 IMEX 欧拉方法和更小的时间步长 $\\Delta t_{\\text{ref}} = \\Delta t / r$（其中细化因子 $r=8$）生成一个高保真参考解。这显著减少了参考解的时间离散误差，使其成为一个合适的基准。\n\n-   **误差度量（$E$）**：每种方法的精度通过最终时间 $T$ 时相对于参考解的离isanbsp;`L^2` 误差来衡量：\n    $$\n    E = \\left(\\Delta x \\sum_{i=1}^{N} \\left(Y_i(T) - Y_{\\text{ref},i}(T)\\right)^2\\right)^{1/2}\n    $$\n\n-   **成本度量（$C$）**：使用简单的代理来估计计算成本。\n    -   $C_{\\text{split}} = N \\times N_{\\text{steps}} \\times \\left(1 + 2\\,m_{\\text{sub}}\\right)$，其中因子 $1$ 代表一个输运步骤，$2\\,m_{\\text{sub}}$ 代表两个化学半步的有效工作量。子步数 $m_{\\text{sub}} = \\max(1, \\lceil k \\Delta t / \\chi \\rceil)$ 模拟了刚性化学反应增加的计算工作量（其中 $\\chi=0.01$）。\n    -   $C_{\\text{IMEX}} = N \\times N_{\\text{steps}} \\times 2$，其中因子 $2$ 解释为每个时间步一次显式输运评估和一次隐式反应更新。\n\n实现将首先设置网格和初始条件，然后为每个测试案例计算特定的 $\\Delta t$。接着计算参考解、分裂解和 IMEX 解，最后计算误差和成本。",
            "answer": "[2.148117e-03,2.441441e-03,1.382400e+05,1.024000e+04,3.010170e-04,3.195325e-04,6.400000e+04,5.120000e+04,2.238210e-02,2.336151e-02,1.259520e+06,1.024000e+04,3.136894e-03,3.585721e-03,1.433600e+05,1.536000e+04,3.874136e-02,3.874136e-02,2.816000e+05,5.120000e+03]"
        }
    ]
}