{
    "hands_on_practices": [
        {
            "introduction": "The primary motivation for operator splitting in reactive flows is the extreme range of timescales present in chemical kinetics, a property known as stiffness. To effectively design a numerical method, we must first quantify this stiffness. This practice introduces the source Jacobian matrix, whose eigenvalues represent the characteristic timescales of the reaction system, and guides you through calculating a stiffness index to understand the challenge posed by the chemistry sub-problem .",
            "id": "4046953",
            "problem": "Consider the species conservation equation for a reactive mixture in computational combustion,\n$$\\frac{\\partial \\boldsymbol{Y}}{\\partial t} + \\mathcal{T}(\\boldsymbol{Y}) = \\boldsymbol{\\omega}(\\boldsymbol{Y}, T),$$\nwhere $\\boldsymbol{Y}$ is the vector of species mass fractions, $\\mathcal{T}(\\boldsymbol{Y})$ represents transport operators, and $\\boldsymbol{\\omega}(\\boldsymbol{Y}, T)$ is the chemical source term. In operator splitting, the reaction substep advances the chemistry by solving the ordinary differential equation (ODE)\n$$\\frac{\\mathrm{d}\\boldsymbol{Y}}{\\mathrm{d}t} = \\boldsymbol{\\omega}(\\boldsymbol{Y}, T)$$\nover a reaction time step $\\Delta t$ separate from transport. Linearizing the reaction ODE around a fixed state $(\\boldsymbol{Y}^{\\ast}, T^{\\ast})$ yields\n$$\\frac{\\mathrm{d}\\boldsymbol{\\eta}}{\\mathrm{d}t} = J_{S}\\, \\boldsymbol{\\eta}, \\quad \\text{with} \\quad J_{S} = \\left.\\frac{\\partial \\boldsymbol{\\omega}}{\\partial \\boldsymbol{Y}}\\right|_{(\\boldsymbol{Y}^{\\ast}, T^{\\ast})},$$\nwhere $\\boldsymbol{\\eta} = \\boldsymbol{Y} - \\boldsymbol{Y}^{\\ast}$ and $J_{S}$ is the source Jacobian (units $\\mathrm{s}^{-1}$). The stiffness index is defined here as the ratio of magnitudes of the fastest to slowest eigenvalues of $J_{S}$ (based on their real parts).\n\nAt a representative high-temperature state for a three-species reduced mechanism, suppose the source Jacobian is approximated by\n$$\nJ_{S} =\n\\begin{pmatrix}\n-1.2 \\times 10^{6}  0  0 \\\\\n3.0 \\times 10^{4}  -2.5 \\times 10^{3}  0 \\\\\n0  1.0 \\times 10^{3}  -75\n\\end{pmatrix}\n\\;\\; \\mathrm{s}^{-1}.\n$$\nUsing this $J_{S}$:\n1. Compute the stiffness index $S$ as the ratio of the magnitude of the fastest decay rate to the magnitude of the slowest decay rate (based on the real parts of the eigenvalues of $J_{S}$).\n2. Under a reaction-only substep advanced with Forward Euler (FE), determine the largest reaction time step $\\Delta t_{\\max}$ that remains linearly stable, and express $\\Delta t_{\\max}$ in microseconds.\n\nReport the final result as a two-entry row matrix containing first $S$ (dimensionless) and second $\\Delta t_{\\max}$ in microseconds, rounding each entry to four significant figures. Do not include any units in your final boxed answer, but use microseconds for $\\Delta t_{\\max}$ as specified.",
            "solution": "The solution involves two parts: calculating the stiffness index and determining the maximum stable time step for the Forward Euler method.\n\n**Part 1: Stiffness Index Calculation**\nThe source Jacobian matrix $J_S$ is a lower triangular matrix. Therefore, its eigenvalues ($\\lambda_i$) are its diagonal elements:\n$$ \\lambda_1 = -1.2 \\times 10^{6} \\, \\mathrm{s}^{-1}, \\quad \\lambda_2 = -2.5 \\times 10^{3} \\, \\mathrm{s}^{-1}, \\quad \\lambda_3 = -75 \\, \\mathrm{s}^{-1} $$\nAll eigenvalues are real and negative, representing decaying modes. The decay rate is the magnitude of the eigenvalue's real part.\n- The fastest decay rate corresponds to the eigenvalue with the largest magnitude: $|\\text{Re}(\\lambda_{\\text{fastest}})| = |\\lambda_1| = 1.2 \\times 10^{6} \\, \\mathrm{s}^{-1}$.\n- The slowest decay rate corresponds to the eigenvalue with the smallest magnitude: $|\\text{Re}(\\lambda_{\\text{slowest}})| = |\\lambda_3| = 75 \\, \\mathrm{s}^{-1}$.\n\nThe stiffness index $S$ is defined as the ratio of these rates:\n$$ S = \\frac{|\\text{Re}(\\lambda_{\\text{fastest}})|}{|\\text{Re}(\\lambda_{\\text{slowest}})|} = \\frac{1.2 \\times 10^{6}}{75} = 16,000 $$\nTo four significant figures, this is written as $1.600 \\times 10^4$.\n\n**Part 2: Maximum Time Step Calculation**\nFor the Forward Euler method, the stability region requires that for every eigenvalue $\\lambda$ of the Jacobian, $|1 + \\lambda \\Delta t| \\le 1$. For real, negative eigenvalues like the ones here, this inequality simplifies to $\\Delta t \\le -2/\\lambda$.\nThe overall time step is limited by the most restrictive case, which corresponds to the eigenvalue with the largest magnitude (the \"stiffest\" eigenvalue), $\\lambda_1 = -1.2 \\times 10^{6} \\, \\mathrm{s}^{-1}$.\n$$ \\Delta t_{\\max} = \\frac{-2}{\\lambda_1} = \\frac{-2}{-1.2 \\times 10^{6} \\, \\mathrm{s}^{-1}} = \\frac{5}{3} \\times 10^{-6} \\, \\mathrm{s} \\approx 1.6666... \\times 10^{-6} \\, \\mathrm{s} $$\nThe problem asks for the result in microseconds ($1 \\, \\mu\\mathrm{s} = 10^{-6} \\, \\mathrm{s}$), which is $\\Delta t_{\\max} \\approx 1.6666... \\, \\mu\\mathrm{s}$. Rounding to four significant figures gives $1.667 \\, \\mu\\mathrm{s}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.600 \\times 10^{4}  1.667\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After separating the stiff chemical source terms, an operator-split scheme must still stably advance the transport equations for advection and diffusion. When using an explicit method for this sub-step, the time step size is strictly limited by the speed at which information propagates through the grid. This exercise focuses on calculating the maximum allowable transport time step, $\\Delta t_T$, by applying the fundamental Courant-Friedrichs-Lewy (CFL) condition for hyperbolic phenomena and comparing it to the constraint imposed by parabolic diffusion terms .",
            "id": "4046974",
            "problem": "Consider a one-dimensional operator-split combustion solver in which the transport substep advances the compressible flow variables explicitly using a finite-volume method, and the chemistry substep is solved separately by an implicit stiff ordinary differential equation integrator. The transport substep must remain stable with respect to the hyperbolic (acoustic-convective) and parabolic (viscous-diffusive) operators.\n\nYou are given a mesh of five control volumes with spatial steps $(\\Delta x_1,\\Delta x_2,\\Delta x_3,\\Delta x_4,\\Delta x_5) = (4.0\\times 10^{-4},\\,6.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,3.0\\times 10^{-4},\\,7.0\\times 10^{-4})\\ \\mathrm{m}$ and local flow states $(u_1,u_2,u_3,u_4,u_5) = (2.0,\\,1.5,\\,-0.5,\\,1.0,\\,2.5)\\ \\mathrm{m/s}$ with corresponding local speeds of sound $(a_1,a_2,a_3,a_4,a_5) = (420,\\,380,\\,400,\\,450,\\,390)\\ \\mathrm{m/s}$. The Courant-Friedrichs-Lewy (CFL) number for the explicit transport update is $\\text{CFL} = 0.4$.\n\nThe diffusive operators in the transport substep are advanced by Forward Euler in time with second-order centered spatial differences. The dynamic viscosities and densities are $(\\mu_1,\\mu_2,\\mu_3,\\mu_4,\\mu_5) = (5.0\\times 10^{-5},\\,4.6\\times 10^{-5},\\,4.8\\times 10^{-5},\\,5.5\\times 10^{-5},\\,4.7\\times 10^{-5})\\ \\mathrm{Pa\\cdot s}$ and $(\\rho_1,\\rho_2,\\rho_3,\\rho_4,\\rho_5) = (0.35,\\,0.40,\\,0.30,\\,0.32,\\,0.38)\\ \\mathrm{kg/m^3}$, respectively. The largest species mass diffusivity is $D_{\\max} = 2.0\\times 10^{-4}\\ \\mathrm{m^2/s}$. Assume a one-dimensional setting for the diffusive stability assessment.\n\nStarting from the governing hyperbolic transport equations and their characteristic wave speeds, derive the stability requirement for the explicit transport update and compute the maximum allowable transport time step $\\Delta t_T$ consistent with the acoustic-convective stability requirement using the given data. Then, starting from the diffusion equation and von Neumann analysis for Forward Euler with centered differences, write down the viscous-diffusive stability constraint and evaluate whether it is more or less restrictive than the acoustic-convective constraint for these data. Discuss how the viscous-diffusive constraint couples to the transport time step in an operator-split scheme.\n\nRound your final numerical value of the transport time step to three significant figures and express it in microseconds.",
            "solution": "The problem requires the determination and comparison of two stability constraints on the time step for an explicit transport substep in a one-dimensional combustion solver.\n\n**1. Acoustic-Convective (Hyperbolic) Stability**\n\nThe transport substep solves the compressible flow equations, which form a system of hyperbolic partial differential equations. For the one-dimensional Euler equations, the characteristic wave speeds are given by $u$, $u+a$, and $u-a$, where $u$ is the local fluid velocity and $a$ is the local speed of sound. The information propagates at the speed $|u|+a$.\n\nFor an explicit finite-volume scheme, the Courant-Friedrichs-Lewy (CFL) condition must be satisfied to ensure numerical stability. The CFL condition states that the numerical domain of dependence must contain the physical domain of dependence. For a given control volume $i$, this is expressed as:\n$$ \\text{CFL}_i = \\frac{(|u_i| + a_i) \\Delta t_T}{\\Delta x_i} \\le \\text{CFL}_{\\max} $$\nIn this problem, we are given a fixed CFL number, $\\text{CFL} = 0.4$, which is used as the upper limit. Therefore, the maximum allowable time step for each cell $i$, denoted $\\Delta t_{T,i}$, is:\n$$ \\Delta t_{T,i} = \\frac{\\text{CFL} \\cdot \\Delta x_i}{|u_i| + a_i} $$\nTo ensure stability across the entire computational domain, the global transport time step $\\Delta t_T$ must be no larger than the minimum of the allowable time steps for all cells:\n$$ \\Delta t_T = \\min_i \\left( \\Delta t_{T,i} \\right) = \\min_i \\left( \\frac{\\text{CFL} \\cdot \\Delta x_i}{|u_i| + a_i} \\right) $$\nWe now compute this value for each of the five given control volumes:\n- Cell 1: $\\Delta t_{T,1} = \\frac{0.4 \\times (4.0 \\times 10^{-4})}{ |2.0| + 420 } = \\frac{1.6 \\times 10^{-4}}{422} \\approx 3.791 \\times 10^{-7}\\ \\mathrm{s}$\n- Cell 2: $\\Delta t_{T,2} = \\frac{0.4 \\times (6.0 \\times 10^{-4})}{ |1.5| + 380 } = \\frac{2.4 \\times 10^{-4}}{381.5} \\approx 6.291 \\times 10^{-7}\\ \\mathrm{s}$\n- Cell 3: $\\Delta t_{T,3} = \\frac{0.4 \\times (5.0 \\times 10^{-4})}{ |-0.5| + 400 } = \\frac{2.0 \\times 10^{-4}}{400.5} \\approx 4.994 \\times 10^{-7}\\ \\mathrm{s}$\n- Cell 4: $\\Delta t_{T,4} = \\frac{0.4 \\times (3.0 \\times 10^{-4})}{ |1.0| + 450 } = \\frac{1.2 \\times 10^{-4}}{451} \\approx 2.661 \\times 10^{-7}\\ \\mathrm{s}$\n- Cell 5: $\\Delta t_{T,5} = \\frac{0.4 \\times (7.0 \\times 10^{-4})}{ |2.5| + 390 } = \\frac{2.8 \\times 10^{-4}}{392.5} \\approx 7.134 \\times 10^{-7}\\ \\mathrm{s}$\n\nThe minimum of these values determines the global time step:\n$$ \\Delta t_T = \\min(3.791, 6.291, 4.994, 2.661, 7.134) \\times 10^{-7}\\ \\mathrm{s} = 2.661 \\times 10^{-7}\\ \\mathrm{s} $$\nThe problem asks for this value to be expressed in microseconds ($\\mathrm{1\\ \\mu s = 10^{-6}\\ s}$) and rounded to three significant figures.\n$$ \\Delta t_T = 2.661 \\times 10^{-7}\\ \\mathrm{s} = 0.2661\\ \\mathrm{\\mu s} \\approx 0.266\\ \\mathrm{\\mu s} $$\n\n**2. Viscous-Diffusive (Parabolic) Stability**\n\nThe viscous-diffusive terms are modeled by parabolic partial differential equations, such as the heat equation or a generic diffusion equation $\\frac{\\partial \\phi}{\\partial t} = \\nu \\frac{\\partial^2 \\phi}{\\partial x^2}$, where $\\nu$ represents the relevant diffusivity (e.g., thermal diffusivity, kinematic viscosity, or mass diffusivity).\nThe problem states that these terms are discretized using a Forward Euler scheme in time and second-order centered differences in space (FTCS scheme). Von Neumann stability analysis of the FTCS scheme for the diffusion equation yields the following stability constraint on the time step $\\Delta t_D$:\n$$ \\Delta t_D \\le \\frac{(\\Delta x)^2}{2\\nu} $$\nThis constraint must be satisfied for all relevant diffusive processes: momentum (viscosity), energy (thermal conduction), and species (mass diffusion). The overall diffusive time step limit is determined by the largest diffusivity and the smallest grid spacing.\nThe effective diffusivity, $\\nu_{\\text{eff}}$, is the maximum of the kinematic viscosity $\\nu = \\mu/\\rho$, the thermal diffusivity $\\alpha = k/(\\rho c_p)$ (data not provided), and the species mass diffusivity $D$. We are given the maximum species diffusivity, $D_{\\max} = 2.0 \\times 10^{-4}\\ \\mathrm{m^2/s}$. We must first calculate the kinematic viscosity for each cell to determine the controlling diffusivity.\n- $\\nu_1 = \\frac{\\mu_1}{\\rho_1} = \\frac{5.0 \\times 10^{-5}}{0.35} \\approx 1.43 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_2 = \\frac{\\mu_2}{\\rho_2} = \\frac{4.6 \\times 10^{-5}}{0.40} = 1.15 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_3 = \\frac{\\mu_3}{\\rho_3} = \\frac{4.8 \\times 10^{-5}}{0.30} = 1.60 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_4 = \\frac{\\mu_4}{\\rho_4} = \\frac{5.5 \\times 10^{-5}}{0.32} \\approx 1.72 \\times 10^{-4}\\ \\mathrm{m^2/s}$\n- $\\nu_5 = \\frac{\\mu_5}{\\rho_5} = \\frac{4.7 \\times 10^{-5}}{0.38} \\approx 1.24 \\times 10^{-4}\\ \\mathrm{m^2/s}$\nComparing these values with the given $D_{\\max} = 2.0 \\times 10^{-4}\\ \\mathrm{m^2/s}$, we see that the species diffusivity is the largest diffusivity in the system. Therefore, $\\nu_{\\text{eff}} = D_{\\max} = 2.0 \\times 10^{-4}\\ \\mathrm{m^2/s}$.\n\nThe stability constraint is most restrictive in the region with the smallest grid spacing, which is $\\Delta x_{\\min} = \\Delta x_4 = 3.0 \\times 10^{-4}\\ \\mathrm{m}$. The maximum allowable time step based on the diffusive stability constraint, $\\Delta t_{D, \\text{limit}}$, is:\n$$ \\Delta t_{D, \\text{limit}} = \\frac{(\\Delta x_{\\min})^2}{2 \\nu_{\\text{eff}}} = \\frac{(3.0 \\times 10^{-4}\\ \\mathrm{m})^2}{2 \\times (2.0 \\times 10^{-4}\\ \\mathrm{m^2/s})} = \\frac{9.0 \\times 10^{-8}}{4.0 \\times 10^{-4}}\\ \\mathrm{s} = 2.25 \\times 10^{-4}\\ \\mathrm{s} $$\nThis corresponds to $225\\ \\mathrm{\\mu s}$.\n\n**3. Comparison and Discussion**\n\nComparing the two stability limits:\n- Acoustic-convective limit: $\\Delta t_T \\approx 0.266\\ \\mathrm{\\mu s}$\n- Viscous-diffusive limit: $\\Delta t_{D, \\text{limit}} = 225\\ \\mathrm{\\mu s}$\n\nIt is evident that $\\Delta t_T \\ll \\Delta t_{D, \\text{limit}}$. The acoustic-convective (hyperbolic) stability requirement is approximately three orders of magnitude more restrictive than the viscous-diffusive (parabolic) requirement for the given data. This is a common situation in simulations of compressible flows, where high characteristic wave speeds ($|u|+a$) combined with fine meshes lead to very small time steps dictated by the CFL condition. The diffusive constraint scales with $(\\Delta x)^2$, while the hyperbolic CFL constraint scales with $\\Delta x$. The diffusive constraint would only become more restrictive than the hyperbolic one on an extremely fine mesh or in a very low-speed (nearly incompressible) flow where $a$ is not the dominant speed.\n\nIn an operator-split scheme where the entire transport substep (including both convective and diffusive terms) is advanced explicitly, the single time step $\\Delta t_{\\text{transport}}$ used for this substep must satisfy all relevant explicit stability criteria. Therefore, the coupling between the constraints is that the effective time step must be the minimum of the individual limits:\n$$ \\Delta t_{\\text{transport}} \\le \\min(\\Delta t_T, \\Delta t_{D, \\text{limit}}) $$\nFor this problem, the transport solver is limited by the hyperbolic CFL condition. The maximum allowable time step for the transport substep is $\\Delta t_T \\approx 0.266\\ \\mathrm{\\mu s}$.\n\nThe final answer required is the transport time step $\\Delta t_T$ calculated from the acoustic-convective stability requirement.\n$$ \\Delta t_T \\approx 0.266\\ \\mathrm{\\mu s} $$",
            "answer": "$$\n\\boxed{0.266}\n$$"
        },
        {
            "introduction": "Operator splitting is a powerful technique, but it is not the only approach for handling stiffness; integrated Implicit-Explicit (IMEX) methods provide a common and robust alternative. This final capstone practice challenges you to implement and compare a second-order Strang splitting scheme against a first-order IMEX integrator for a model reactive-flow problem. By analyzing the trade-offs between accuracy and computational cost across different flow and reaction regimes, you will gain critical insight into the practical performance of these competing numerical strategies .",
            "id": "4046958",
            "problem": "Consider a one-dimensional, isothermal, single-species reactive flow on a periodic domain governed by the species conservation law and Fickian diffusion. Starting from the conservation of mass and the constitutive law for diffusive flux, the dimensionless advection–diffusion–reaction equation for a species mass fraction $Y(x,t)$ on a periodic interval $x \\in [0,1]$ reads\n$$\n\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^2 Y}{\\partial x^2} + \\omega(Y),\n$$\nwhere $u$ is a constant nondimensional advection velocity, $D$ is a nondimensional diffusion coefficient, and $\\omega(Y)$ is the chemical source term. Assume a linear, irreversible first-order reaction, $\\omega(Y) = -k\\,Y$, where $k$ is a nondimensional stiffness parameter representing the ratio of chemical timescales to transport timescales. Let the initial condition be a smooth, localized mass fraction given by\n$$\nY(x,0) = Y_0(x) = \\alpha + \\exp\\left(-\\frac{(x-x_c)^2}{2\\sigma^2}\\right),\n$$\nwith parameters $\\alpha = 0.05$, $x_c = 0.3$, and $\\sigma = 0.05$, and periodic boundary conditions on $[0,1]$. All quantities are to be treated as nondimensional.\n\nYou must implement and compare two time-integration methodologies for the semi-discrete (in space) system:\n- Operator splitting between chemistry and transport using Strang splitting, where the chemistry subproblem and the transport subproblem are advanced separately within each time step.\n- An unsplit Implicit-Explicit (IMEX) Euler integrator, which treats transport terms explicitly and reaction terms implicitly in a single coupled update.\n\nSpatial discretization requirements:\n- Discretize $x \\in [0,1]$ with $N$ uniformly spaced points and periodic boundary conditions.\n- Use a first-order upwind scheme for the advection term $\\frac{\\partial Y}{\\partial x}$ and a second-order central difference scheme for the diffusion term $\\frac{\\partial^2 Y}{\\partial x^2}$.\n- The explicit transport time step must satisfy standard stability constraints derived from the Courant–Friedrichs–Lewy (CFL) condition for advection and the explicit diffusion stability limit. Specifically, for a grid spacing $\\Delta x$, choose a time step $\\Delta t$ such that\n$$\n\\Delta t \\le \\min\\left(\\text{CFL}_a \\frac{\\Delta x}{|u|},\\; \\text{CFL}_d \\frac{\\Delta x^2}{2D},\\; \\Delta t_{\\max}\\right),\n$$\nwith prescribed constants $\\text{CFL}_a$ and $\\text{CFL}_d$, and a global cap $\\Delta t_{\\max}$ to prevent excessively large steps when $u = 0$ and $D = 0$. The final time $T$ must be reached with an integer number of steps by adjusting $\\Delta t$ accordingly.\n\nTime-integration specifications:\n- For operator splitting, use Strang splitting over each time step $\\Delta t$: advance chemistry for $\\Delta t/2$, then transport for $\\Delta t$, and then chemistry for $\\Delta t/2$. For the chemistry half-steps, use the exact solution of the linear reaction $Y(t+\\tau) = Y(t)\\exp(-k\\tau)$. To model accuracy-driven computational effort as a function of stiffness, subdivide each chemistry half-step into $m_{\\text{sub}}$ substeps, where\n$$\nm_{\\text{sub}} = \\max\\left(1,\\; \\left\\lceil \\frac{k\\,\\Delta t}{\\chi} \\right\\rceil \\right),\n$$\nfor a prescribed tolerance-like parameter $\\chi$. This emulates the need for finer resolution of fast chemistry as stiffness increases and introduces a stiffness-dependent cost.\n- For the unsplit Implicit-Explicit (IMEX) Euler method, compute the explicit transport residual at time level $n$, and update $Y^{n+1}$ using an implicit backward Euler treatment of the reaction:\n$$\nY^{n+1} = \\frac{Y^n + \\Delta t\\left(-u\\,\\partial_x Y^n + D\\,\\partial_{xx}Y^n\\right)}{1 + k\\,\\Delta t}.\n$$\n\nReference solution for error estimation:\n- Construct a high-fidelity reference solution $Y_{\\text{ref}}(x,T)$ by integrating the same semi-discrete equations with the IMEX Euler method using a much smaller time step $\\Delta t_{\\text{ref}} = \\Delta t / r$, with an integer refinement factor $r \\ge 6$, such that temporal discretization error is significantly reduced relative to the tested methods.\n\nError and cost metrics:\n- Compute the discrete space–time $L^2$ error at final time $T$ for each method with respect to the reference solution:\n$$\nE = \\left(\\Delta x \\sum_{i=1}^{N} \\left(Y_i(T) - Y_{\\text{ref},i}(T)\\right)^2\\right)^{1/2}.\n$$\n- Quantify computational cost as an operation-count proxy that scales with stiffness and flow gradients:\n  - For operator splitting, define\n  $$\n  C_{\\text{split}} = N \\times N_{\\text{steps}} \\times \\left(1 + 2\\,m_{\\text{sub}}\\right),\n  $$\n  where $N_{\\text{steps}} = \\left\\lceil \\frac{T}{\\Delta t} \\right\\rceil$ is the number of time steps, the term $1$ counts one transport update per step, and $2\\,m_{\\text{sub}}$ counts two chemistry half-steps, each subdivided into $m_{\\text{sub}}$ substeps.\n  - For IMEX Euler, define\n  $$\n  C_{\\text{IMEX}} = N \\times N_{\\text{steps}} \\times 2,\n  $$\n  where the factor $2$ accounts for one transport residual evaluation and one implicit reaction update per step.\n\nProgram requirements:\n- Implement both methods with the specified discretizations on a uniform grid with $N = 256$, $\\text{CFL}_a = 0.8$, $\\text{CFL}_d = 0.4$, $\\Delta t_{\\max} = 0.005$, $\\chi = 0.01$, and final time $T = 0.05$. Use the nondimensional parameters provided in the test suite below.\n- Use periodic boundary conditions.\n- Use $r = 8$ to define $\\Delta t_{\\text{ref}}$.\n- Compute and output the error and cost for each test case as specified.\n\nTest suite:\n- Case $1$: $(k = 20,\\; u = 0.5,\\; D = 0.01)$.\n- Case $2$: $(k = 1,\\; u = 0.1,\\; D = 0.0)$.\n- Case $3$: $(k = 200,\\; u = 0.5,\\; D = 0.01)$.\n- Case $4$: $(k = 20,\\; u = 1.0,\\; D = 0.02)$.\n- Case $5$: $(k = 50,\\; u = 0.0,\\; D = 0.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append four quantities in order: $E_{\\text{split}}$, $E_{\\text{IMEX}}$, $C_{\\text{split}}$, $C_{\\text{IMEX}}$. The final printed list should therefore contain $4 \\times 5 = 20$ numeric entries, for example, $[e_1^{\\text{split}},e_1^{\\text{IMEX}},c_1^{\\text{split}},c_1^{\\text{IMEX}},\\dots,e_5^{\\text{split}},e_5^{\\text{IMEX}},c_5^{\\text{split}},c_5^{\\text{IMEX}}]$. All errors and costs are dimensionless numbers.",
            "solution": "The problem is valid. It presents a well-posed, scientifically grounded task in computational physics, specifically in the numerical analysis of partial differential equations (PDEs) for reactive flows. All necessary physical parameters, numerical specifications, and evaluation metrics are provided, and the problem is free of contradictions or ambiguities.\n\nThe problem asks for a numerical comparison of two time-integration schemes—Strang operator splitting and an Implicit-Explicit (IMEX) Euler method—for a one-dimensional advection-diffusion-reaction (ADR) equation. The analysis involves implementing both methods, computing their solutions, and assessing their accuracy and computational cost relative to a high-fidelity reference solution.\n\nThe governing ADR equation for the species mass fraction $Y(x,t)$ is given by:\n$$\n\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^2 Y}{\\partial x^2} - k Y\n$$\non a periodic domain $x \\in [0,1]$, with a constant advection velocity $u$, diffusion coefficient $D$, and reaction rate constant $k$.\n\n**1. Semi-Discretization (Method of Lines)**\n\nWe first discretize the spatial domain $x \\in [0,1]$ into $N$ uniform grid cells, with cell centers $x_i = (i-1/2)\\Delta x$ for $i=1, \\dots, N$, where the grid spacing is $\\Delta x = 1/N$. The mass fraction at each grid point is denoted $Y_i(t) = Y(x_i, t)$. Applying finite difference approximations to the spatial derivatives transforms the single PDE into a system of $N$ coupled ordinary differential equations (ODEs). Let $\\vec{Y}(t) = [Y_1(t), Y_2(t), \\dots, Y_N(t)]^T$. The semi-discrete system is:\n$$\n\\frac{d\\vec{Y}}{dt} = \\mathcal{L}(\\vec{Y}) = \\mathcal{L}_{\\text{adv}}(\\vec{Y}) + \\mathcal{L}_{\\text{diff}}(\\vec{Y}) + \\mathcal{L}_{\\text{chem}}(\\vec{Y})\n$$\nwhere $\\mathcal{L}_{\\text{adv}}$, $\\mathcal{L}_{\\text{diff}}$, and $\\mathcal{L}_{\\text{chem}}$ are the discrete operators for advection, diffusion, and chemistry, respectively.\n\n-   **Advection Operator $\\mathcal{L}_{\\text{adv}}$**: A first-order upwind scheme is used for the term $-u \\frac{\\partial Y}{\\partial x}$. The direction of the differencing depends on the sign of the velocity $u$.\n    -   If $u  0$ (flow to the right): $(\\mathcal{L}_{\\text{adv}}(\\vec{Y}))_i = -u \\frac{Y_i - Y_{i-1}}{\\Delta x}$.\n    -   If $u  0$ (flow to the left): $(\\mathcal{L}_{\\text{adv}}(\\vec{Y}))_i = -u \\frac{Y_{i+1} - Y_i}{\\Delta x}$.\n    -   If $u=0$, the term is zero.\n    Periodic boundary conditions imply that $Y_0 = Y_N$ and $Y_{N+1} = Y_1$.\n\n-   **Diffusion Operator $\\mathcal{L}_{\\text{diff}}$**: A second-order central difference scheme is used for the term $D \\frac{\\partial^2 Y}{\\partial x^2}$.\n    $$\n    (\\mathcal{L}_{\\text{diff}}(\\vec{Y}))_i = D \\frac{Y_{i+1} - 2Y_i + Y_{i-1}}{\\Delta x^2}\n    $$\n    Again, periodic boundary conditions are applied for indices outside the range $[1, N]$.\n\n-   **Chemistry Operator $\\mathcal{L}_{\\text{chem}}$**: The linear reaction term $\\omega(Y) = -kY$ becomes a simple element-wise multiplication.\n    $$\n    (\\mathcal{L}_{\\text{chem}}(\\vec{Y}))_i = -k Y_i\n    $$\n\nThe combined, explicit transport operator is $\\mathcal{L}_T(\\vec{Y}) = \\mathcal{L}_{\\text{adv}}(\\vec{Y}) + \\mathcal{L}_{\\text{diff}}(\\vec{Y})$.\n\n**2. Time-Stepping and Stability**\n\nThe time step $\\Delta t$ is constrained by the stability of the explicit finite difference schemes for advection and diffusion. The Courant-Friedrichs-Lewy (CFL) conditions dictate the maximum allowable time step. The prescribed formula is:\n$$\n\\Delta t \\le \\min\\left(\\text{CFL}_a \\frac{\\Delta x}{|u|},\\; \\text{CFL}_d \\frac{\\Delta x^2}{2D},\\; \\Delta t_{\\max}\\right)\n$$\nwhere $\\text{CFL}_a=0.8$ and $\\text{CFL}_d=0.4$ are stability factors, and $\\Delta t_{\\max}=0.005$ is a cap. If $u=0$ or $D=0$, the corresponding term in the minimum is treated as infinite. To ensure the simulation reaches the final time $T=0.05$ exactly, the number of steps is fixed as $N_{\\text{steps}} = \\lceil T/\\Delta t_{\\text{provisional}} \\rceil$, and the actual time step is adjusted to $\\Delta t = T / N_{\\text{steps}}$.\n\n**3. Numerical Integration Methods**\n\n**a) Strang Operator Splitting**\n\nThis method decouples the stiff chemistry from the non-stiff transport. The full operator $\\mathcal{L}$ is split into $\\mathcal{L}_T$ (transport) and $\\mathcal{L}_{\\text{chem}}$ (chemistry). A second-order accurate Strang splitting scheme advances the solution from time $t^n$ to $t^{n+1} = t^n + \\Delta t$ via three sequential sub-steps:\n1.  **Chemistry Half-Step:** Solve $\\frac{d\\vec{Y}}{d\\tau} = \\mathcal{L}_{\\text{chem}}(\\vec{Y})$ for a duration $\\tau = \\Delta t/2$. For the linear reaction, this has an exact analytical solution:\n    $$\n    \\vec{Y}^* = \\vec{Y}^n \\exp(-k \\Delta t/2)\n    $$\n2.  **Transport Full-Step:** Solve $\\frac{d\\vec{Y}}{d\\tau} = \\mathcal{L}_T(\\vec{Y})$ for a duration $\\tau = \\Delta t$. An explicit Euler method is used for this sub-step:\n    $$\n    \\vec{Y}^{**} = \\vec{Y}^* + \\Delta t \\cdot \\mathcal{L}_T(\\vec{Y}^*)\n    $$\n3.  **Chemistry Half-Step:** Solve the chemistry ODE again for a duration $\\tau = \\Delta t/2$:\n    $$\n    \\vec{Y}^{n+1} = \\vec{Y}^{**} \\exp(-k \\Delta t/2)\n    $$\n\n**b) Implicit-Explicit (IMEX) Euler Method**\n\nThis method treats the non-stiff transport terms explicitly and the potentially stiff reaction term implicitly within a single, coupled update. This avoids the stability limitations associated with an explicit treatment of the fast reaction. Applying a forward Euler scheme to transport and a backward Euler scheme to chemistry gives:\n$$\n\\frac{\\vec{Y}^{n+1} - \\vec{Y}^n}{\\Delta t} = \\mathcal{L}_{T}(\\vec{Y}^n) + \\mathcal{L}_{\\text{chem}}(\\vec{Y}^{n+1})\n$$\nSubstituting the discrete operators:\n$$\n\\frac{Y_i^{n+1} - Y_i^n}{\\Delta t} = \\left(\\mathcal{L}_{T}(\\vec{Y}^n)\\right)_i - k Y_i^{n+1}\n$$\nRearranging for $Y_i^{n+1}$ yields the update rule:\n$$\nY_i^{n+1} (1 + k\\Delta t) = Y_i^n + \\Delta t \\left(\\mathcal{L}_{T}(\\vec{Y}^n)\\right)_i\n$$\n$$\nY_i^{n+1} = \\frac{Y_i^n + \\Delta t \\left(\\mathcal{L}_{T}(\\vec{Y}^n)\\right)_i}{1 + k\\Delta t}\n$$\nThis scheme is first-order accurate in time but is L-stable, allowing it to handle stiff reactions without requiring prohibitively small time steps related to the chemical timescale.\n\n**4. Reference Solution, Error, and Cost**\n\n-   **Reference Solution ($Y_{\\text{ref}}$)**: To estimate the error of the two schemes, a high-fidelity reference solution is generated using the robust IMEX Euler method with a much smaller time step, $\\Delta t_{\\text{ref}} = \\Delta t / r$, where the refinement factor is $r=8$. This significantly reduces the temporal discretization error of the reference solution, making it a suitable benchmark.\n\n-   **Error Metric ($E$)**: The accuracy of each method is measured by the discrete space-time $L^2$ error at the final time $T$, computed against the reference solution:\n    $$\n    E = \\left(\\Delta x \\sum_{i=1}^{N} \\left(Y_i(T) - Y_{\\text{ref},i}(T)\\right)^2\\right)^{1/2}\n    $$\n\n-   **Cost Metrics ($C$)**: Simple proxies are used to estimate the computational cost.\n    -   $C_{\\text{split}} = N \\times N_{\\text{steps}} \\times \\left(1 + 2\\,m_{\\text{sub}}\\right)$, where the factor $1$ represents one transport step and $2\\,m_{\\text{sub}}$ represents the effective work of the two chemistry half-steps. The substep count $m_{\\text{sub}} = \\max(1, \\lceil k \\Delta t / \\chi \\rceil)$ models the increased computational effort for stiff chemistry (where $\\chi=0.01$).\n    -   $C_{\\text{IMEX}} = N \\times N_{\\text{steps}} \\times 2$, where the factor $2$ accounts for one explicit transport evaluation and one implicit reaction update per time step.\n\nThe implementation will proceed by setting up the grid and initial condition, then for each test case, calculating the specific $\\Delta t$. The reference, split, and IMEX solutions are then computed, followed by the calculation of errors and costs.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares Strang splitting and IMEX Euler methods for a 1D\n    advection-diffusion-reaction equation, as specified in the problem statement.\n    \"\"\"\n    # ====== Global Parameters from Problem Statement ======\n    N = 256\n    CFL_a = 0.8\n    CFL_d = 0.4\n    dt_max = 0.005\n    chi = 0.01\n    T_final = 0.05\n    ref_factor = 8\n\n    # Initial condition parameters\n    alpha = 0.05\n    x_c = 0.3\n    sigma = 0.05\n    \n    # Test cases: (k, u, D)\n    test_cases = [\n        (20.0, 0.5, 0.01),\n        (1.0, 0.1, 0.0),\n        (200.0, 0.5, 0.01),\n        (20.0, 1.0, 0.02),\n        (50.0, 0.0, 0.0)\n    ]\n    \n    # ====== Spatial Grid Setup ======\n    dx = 1.0 / N\n    x = np.linspace(0, 1.0 - dx, N)\n\n    # ====== Initial Condition ======\n    Y0 = alpha + np.exp(-((x - x_c)**2) / (2 * sigma**2))\n\n    # ====== Helper Functions ======\n    def transport_operator(Y, u, D, dx):\n        \"\"\"Computes the discrete transport residual L_T(Y).\"\"\"\n        # Second-order central difference for diffusion\n        # np.roll handles periodic boundaries\n        Y_prev = np.roll(Y, 1)\n        Y_next = np.roll(Y, -1)\n        laplacian = (Y_next - 2 * Y + Y_prev) / (dx**2)\n        diff_term = D * laplacian\n\n        # First-order upwind for advection\n        adv_term = np.zeros_like(Y)\n        if u > 0:\n            grad_bwd = (Y - Y_prev) / dx\n            adv_term = -u * grad_bwd\n        elif u  0:\n            grad_fwd = (Y_next - Y) / dx\n            adv_term = -u * grad_fwd\n        \n        return adv_term + diff_term\n\n    def run_imex_solver(k, u, D, n_steps, dt):\n        \"\"\"Solves the ADR equation using the IMEX Euler method.\"\"\"\n        Y = Y0.copy()\n        for _ in range(n_steps):\n            transport_res = transport_operator(Y, u, D, dx)\n            Y = (Y + dt * transport_res) / (1.0 + k * dt)\n        return Y\n\n    def run_strang_solver(k, u, D, n_steps, dt):\n        \"\"\"Solves the ADR equation using Strang splitting.\"\"\"\n        Y = Y0.copy()\n        for _ in range(n_steps):\n            # 1. Chemistry half-step\n            Y *= np.exp(-k * dt / 2.0)\n            \n            # 2. Transport full-step (Explicit Euler)\n            transport_res = transport_operator(Y, u, D, dx)\n            Y += dt * transport_res\n            \n            # 3. Chemistry half-step\n            Y *= np.exp(-k * dt / 2.0)\n        return Y\n\n    def calculate_error(Y_num, Y_ref, dx):\n        \"\"\"Computes the discrete L2 error.\"\"\"\n        return np.sqrt(dx * np.sum((Y_num - Y_ref)**2))\n\n    # ====== Main Loop for Test Cases ======\n    all_results = []\n    \n    for k, u, D in test_cases:\n        # --- Time step calculation ---\n        # Handle division by zero for u=0 or D=0\n        dt_a = CFL_a * dx / abs(u) if u != 0 else np.inf\n        dt_d = CFL_d * dx**2 / (2 * D) if D != 0 else np.inf\n        dt_provisional = min(dt_a, dt_d, dt_max)\n        \n        n_steps = int(np.ceil(T_final / dt_provisional))\n        dt = T_final / n_steps\n\n        # --- Cost calculation ---\n        m_sub = max(1, int(np.ceil(k * dt / chi)))\n        cost_split = N * n_steps * (1 + 2 * m_sub)\n        cost_imex = N * n_steps * 2\n\n        # --- Reference Solution ---\n        n_steps_ref = n_steps * ref_factor\n        dt_ref = dt / ref_factor\n        Y_ref = run_imex_solver(k, u, D, n_steps_ref, dt_ref)\n\n        # --- Strang Splitting Solution ---\n        Y_split = run_strang_solver(k, u, D, n_steps, dt)\n        \n        # --- IMEX Euler Solution ---\n        Y_imex = run_imex_solver(k, u, D, n_steps, dt)\n        \n        # --- Error Calculation ---\n        error_split = calculate_error(Y_split, Y_ref, dx)\n        error_imex = calculate_error(Y_imex, Y_ref, dx)\n\n        all_results.extend([error_split, error_imex, float(cost_split), float(cost_imex)])\n\n    # --- Final Output Formatting ---\n    print(f\"[{','.join(f'{val:.6e}' for val in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}