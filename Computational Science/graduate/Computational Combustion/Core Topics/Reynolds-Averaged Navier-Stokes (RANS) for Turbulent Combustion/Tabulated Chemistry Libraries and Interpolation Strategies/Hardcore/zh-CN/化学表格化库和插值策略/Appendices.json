{
    "hands_on_practices": [
        {
            "introduction": "在计算燃烧模拟中采用列表化学方法之前，一个至关重要的初步步骤是估算其内存成本。这项练习将帮助您将化学表的概念性参数（如分辨率和存储的组分数）与现实世界中的硬件限制联系起来。通过这个基本计算，您可以为您的模拟在存储需求和计算精度之间做出明智的权衡。",
            "id": "4070267",
            "problem": "在一个采用列表化学的计算燃烧代码中，热化学状态在一个由混合分数 $Z$ 和标量进程变量 $c$ 构成的二维均匀网格上表示。假设该库沿 $Z$ 轴有 $N_{Z}$ 个节点，沿 $c$ 轴有 $N_{c}$ 个节点。在每个网格节点上，该库存储了 $n_{s}$ 种化学物质的质量分数 $Y_{k}(Z,c)$ 和温度 $T(Z,c)$。假设所有存储的标量均根据电气与电子工程师协会 (IEEE) 754 标准的 64 位二进制双精度格式表示，每个标量占用 $b$ 个字节。不存储额外的元数据、填充或预计算的插值系数——只存储 $Y_{k}$ 和 $T$ 的节点值。\n\n从列表库和均匀张量积网格的定义出发，推导总内存占用 $M$（以字节为单位）作为 $N_{Z}$、$N_{c}$、$n_{s}$ 和 $b$ 的函数的通用表达式。然后，当 $N_{Z}=200$、$N_{c}=200$、$n_{s}=10$ 和 $b=8$ 时，计算总字节数。以字节为单位表示最终数值答案。无需四舍五入。",
            "solution": "该问题要求推导列表化学库总内存占用 $M$ 的通用表达式，并随后针对一组特定参数进行计算。对问题陈述的验证证实了其科学性、适定性、客观性，并包含了得出唯一解所需的所有信息。\n\n首先，我们确定计算网格中的总节点数。问题陈述指出，热化学状态在一个由混合分数 $Z$ 和标量进程变量 $c$ 构成的二维均匀网格上表示。该网格由沿 $Z$ 方向的 $N_Z$ 个节点和沿 $c$ 方向的 $N_c$ 个节点定义。作为一个张量积网格，状态空间中离散点（节点）的总数，我们记为 $N_{\\text{nodes}}$，是每个维度上节点数的乘积：\n$$N_{\\text{nodes}} = N_Z N_c$$\n\n接下来，我们确定每个网格节点存储的标量数量。问题明确指出，对于每个节点 $(Z,c)$，该库存储了 $n_s$ 种化学物质的质量分数 $Y_k(Z,c)$ 和温度 $T(Z,c)$。这意味着有 $n_s$ 个标量值用于质量分数，以及 $1$ 个标量值用于温度。因此，每个节点存储的标量总数，记为 $N_{\\text{scalars/node}}$，为：\n$$N_{\\text{scalars/node}} = n_s + 1$$\n\n整个库中存储的标量总数 $N_{\\text{total}}$ 是总节点数与每个节点标量数的乘积。\n$$N_{\\text{total}} = N_{\\text{nodes}} \\times N_{\\text{scalars/node}} = (N_Z N_c)(n_s + 1)$$\n\n最后，我们计算总内存占用 $M$（以字节为单位）。每个标量都以双精度（IEEE 754 64位二进制）表示，占用 $b$ 字节的内存。总内存占用是标量总数与每个标量大小（以字节为单位）的乘积。\n$$M(N_Z, N_c, n_s, b) = N_{\\text{total}} \\times b$$\n代入 $N_{\\text{total}}$ 的表达式，我们得到内存占用的通用表达式：\n$$M(N_Z, N_c, n_s, b) = N_Z N_c (n_s + 1) b$$\n这就是所求的通用公式。\n\n现在，我们用给定的数值计算这个表达式：$N_Z = 200$，$N_c = 200$，$n_s = 10$，以及 $b=8$ 字节（因为一个 64 位双精度浮点数是 $64/8 = 8$ 字节）。\n将这些值代入推导出的公式中：\n$$M = (200)(200)(10 + 1)(8)$$\n首先，计算总节点数：\n$$N_{\\text{nodes}} = 200 \\times 200 = 40000$$\n接下来，计算每个节点的标量数：\n$$N_{\\text{scalars/node}} = 10 + 1 = 11$$\n现在，计算总内存占用 $M$：\n$$M = 40000 \\times 11 \\times 8$$\n$$M = 440000 \\times 8$$\n$$M = 3520000$$\n指定库的总内存占用为 $3,520,000$ 字节。",
            "answer": "$$\\boxed{3520000}$$"
        },
        {
            "introduction": "创建化学表后，核心操作是使用插值方法检索任意状态点的数据。本练习将演示二维结构化网格的标准方法——双线性插值。更重要的是，它将揭示一个正确设计的插值方案如何保持基本的物理定律（例如质量守恒），这是确保模拟结果物理真实性的关键。",
            "id": "4070273",
            "problem": "一个用于预混火焰的表格化化学库由混合分数 $Z$ 和一个反应进程变量 $c$ 参数化。在此类库中，每个条目都存储了温度 $T(Z,c)$ 和一个组分质量分数向量 $Y(Z,c) = \\left(Y_{1}(Z,c), Y_{2}(Z,c), \\dots, Y_{N}(Z,c)\\right)$，并满足性质 $\\sum_{i=1}^{N} Y_{i}(Z,c) = 1$。考虑 $(Z,c)$ 平面中的一个结构化网格单元，其角点坐标为 $\\left(Z_{0}, c_{0}\\right) = \\left(0.10, 0.20\\right)$、$\\left(Z_{1}, c_{0}\\right) = \\left(0.30, 0.20\\right)$、$\\left(Z_{0}, c_{1}\\right) = \\left(0.10, 0.50\\right)$ 和 $\\left(Z_{1}, c_{1}\\right) = \\left(0.30, 0.50\\right)$。在这些角点上，表格化的值为：\n- $\\left(Z_{0}, c_{0}\\right)$: $T = 1000$ 且 $Y = \\left(0.30, 0.60, 0.10\\right)$，\n- $\\left(Z_{0}, c_{1}\\right)$: $T = 1500$ 且 $Y = \\left(0.10, 0.40, 0.50\\right)$，\n- $\\left(Z_{1}, c_{0}\\right)$: $T = 1800$ 且 $Y = \\left(0.55, 0.35, 0.10\\right)$，\n- $\\left(Z_{1}, c_{1}\\right)$: $T = 2100$ 且 $Y = \\left(0.25, 0.25, 0.50\\right)$。\n\n假设一个位于该单元内部的查询点 $\\left(Z, c\\right) = \\left(0.22, 0.38\\right)$。从质量分数满足 $\\sum_{i=1}^{N} Y_{i} = 1$ 的基本定义和一维线性插值的定义出发，推导一个适用于矩形单元的双线性插值策略，该策略需与沿 $Z$ 和 $c$ 方向的线性形函数一致。使用此策略，计算在点 $\\left(Z, c\\right) = \\left(0.22, 0.38\\right)$ 处的插值温度 $T$ 和组分质量分数向量 $Y$。然后，验证插值得到的组分质量分数仍然满足 $\\sum_{i=1}^{N} Y_{i} = 1$。\n\n最终温度以开尔文表示，组分质量分数以无量纲小数表示。将所有报告的数值四舍五入到 $4$ 位有效数字。将最终答案以单个行向量的形式给出，其中包含温度和 $Y$ 的各个组分。",
            "solution": "在尝试提供解法之前，将对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 表格化化学库的控制变量：混合分数 $Z$ 和反应进程变量 $c$。\n- 存储的热化学量：温度 $T(Z,c)$ 和组分质量分数向量 $Y(Z,c) = \\left(Y_{1}(Z,c), \\dots, Y_{N}(Z,c)\\right)$。\n- 质量分数的约束条件：$\\sum_{i=1}^{N} Y_{i}(Z,c) = 1$。\n- 网格单元角点坐标：\n  - $\\left(Z_{0}, c_{0}\\right) = \\left(0.10, 0.20\\right)$\n  - $\\left(Z_{1}, c_{0}\\right) = \\left(0.30, 0.20\\right)$\n  - $\\left(Z_{0}, c_{1}\\right) = \\left(0.10, 0.50\\right)$\n  - $\\left(Z_{1}, c_{1}\\right) = \\left(0.30, 0.50\\right)$\n- 角点上的表格值：\n  - 在 $\\left(Z_{0}, c_{0}\\right)$ 处：$T_{00} = 1000$ 且 $Y_{00} = \\left(0.30, 0.60, 0.10\\right)$。\n  - 在 $\\left(Z_{0}, c_{1}\\right)$ 处：$T_{01} = 1500$ 且 $Y_{01} = \\left(0.10, 0.40, 0.50\\right)$。\n  - 在 $\\left(Z_{1}, c_{0}\\right)$ 处：$T_{10} = 1800$ 且 $Y_{10} = \\left(0.55, 0.35, 0.10\\right)$。\n  - 在 $\\left(Z_{1}, c_{1}\\right)$ 处：$T_{11} = 2100$ 且 $Y_{11} = \\left(0.25, 0.25, 0.50\\right)$。\n- 查询点：$\\left(Z, c\\right) = \\left(0.22, 0.38\\right)$。\n- 任务：推导双线性插值策略，计算查询点处的插值 $T$ 和 $Y$，并验证插值后的质量分数之和为 $1$。\n- 报告要求：将所有最终数值四舍五入到 $4$ 位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 问题使用了计算燃烧学中的标准概念，包括混合分数、反应进程变量和表格化化学。质量分数约束 $\\sum Y_i = 1$ 是质量守恒的基本定律。双线性插值是一种标准的、成熟的数值方法。所有给定值对于燃烧场景都是物理上合理的。\n- **适定性：** 问题提供了执行所要求的双线性插值所需的所有必要数据（角点坐标、角点值以及单元内的查询点）。指示清晰，并能导出一个唯一的解。\n- **客观性：** 问题使用精确、无歧义的科学和数学语言进行陈述。\n\n给定的数据也是一致的。每个角点的质量分数之和为 $1$：\n- $Y_{00}: 0.30 + 0.60 + 0.10 = 1.00$\n- $Y_{01}: 0.10 + 0.40 + 0.50 = 1.00$\n- $Y_{10}: 0.55 + 0.35 + 0.10 = 1.00$\n- $Y_{11}: 0.25 + 0.25 + 0.50 = 1.00$\n\n### 步骤 3：结论与行动\n问题是有效的。将提供一个完整的解法。\n\n### 解法\n问题要求推导双线性插值策略，并应用该策略求出在 $(Z,c)$ 平面上特定点的温度 $T$ 和组分质量分数向量 $Y$。\n\n**1. 双线性插值公式的推导**\n\n设 $f(Z,c)$ 是定义在角点为 $(Z_0, c_0)$、$(Z_1, c_0)$、$(Z_0, c_1)$ 和 $(Z_1, c_1)$ 的矩形单元上的一个标量函数。双线性插值可以通过执行两次连续的线性插值来推导。\n\n首先，我们在 $c$ 坐标为常数 $c_0$ 和 $c_1$ 处沿 $Z$ 方向进行线性插值。对于点 $x$ 处的值 $f(x)$，沿一维（比如 $x$ 维）在点 $x_0$ 和 $x_1$ 之间的线性插值由下式给出：\n$$f(x) = f(x_0) + \\frac{x-x_0}{x_1-x_0} (f(x_1) - f(x_0)) = (1-\\xi)f(x_0) + \\xi f(x_1)$$\n其中 $\\xi = \\frac{x-x_0}{x_1-x_0}$ 是归一化坐标。\n\n对查询点 $Z$ 沿 $Z$ 轴应用此方法：\n设 $\\xi = \\frac{Z - Z_0}{Z_1 - Z_0}$。\n在 $(Z, c_0)$ 处的插值是：\n$$f(Z, c_0) \\approx (1-\\xi)f(Z_0, c_0) + \\xi f(Z_1, c_0)$$\n在 $(Z, c_1)$ 处的插值是：\n$$f(Z, c_1) \\approx (1-\\xi)f(Z_0, c_1) + \\xi f(Z_1, c_1)$$\n\n接下来，我们使用这两个中间值沿 $c$ 方向进行线性插值，以求出在查询点 $(Z, c)$ 处的值。\n设 $\\eta = \\frac{c - c_0}{c_1 - c_0}$。\n$$f(Z, c) \\approx (1-\\eta)f(Z, c_0) + \\eta f(Z, c_1)$$\n代入 $f(Z, c_0)$ 和 $f(Z, c_1)$ 的表达式：\n$$f(Z, c) \\approx (1-\\eta) \\left[ (1-\\xi)f(Z_0, c_0) + \\xi f(Z_1, c_0) \\right] + \\eta \\left[ (1-\\xi)f(Z_0, c_1) + \\xi f(Z_1, c_1) \\right]$$\n展开此表达式得到双线性插值公式：\n$$f(Z, c) \\approx (1-\\xi)(1-\\eta)f(Z_0, c_0) + \\xi(1-\\eta)f(Z_1, c_0) + (1-\\xi)\\eta f(Z_0, c_1) + \\xi\\eta f(Z_1, c_1)$$\n这个公式对应于四个角点值的加权平均，其中权重是归一化坐标的乘积。这与四边形单元上的线性形函数是一致的。\n\n**2. 插值的计算**\n\n首先，我们计算查询点 $(Z, c) = (0.22, 0.38)$ 的归一化坐标 $(\\xi, \\eta)$。\n单元边界为 $Z_0=0.10$、$Z_1=0.30$、$c_0=0.20$ 和 $c_1=0.50$。\n$$\\xi = \\frac{Z - Z_{0}}{Z_{1} - Z_{0}} = \\frac{0.22 - 0.10}{0.30 - 0.10} = \\frac{0.12}{0.20} = 0.6$$\n$$\\eta = \\frac{c - c_{0}}{c_{1} - c_{0}} = \\frac{0.38 - 0.20}{0.50 - 0.20} = \\frac{0.18}{0.30} = 0.6$$\n\n接下来，我们计算插值权重：\n- $(Z_0, c_0)$ 的权重：$w_{00} = (1-\\xi)(1-\\eta) = (1-0.6)(1-0.6) = 0.4 \\times 0.4 = 0.16$\n- $(Z_1, c_0)$ 的权重：$w_{10} = \\xi(1-\\eta) = 0.6 \\times (1-0.6) = 0.6 \\times 0.4 = 0.24$\n- $(Z_0, c_1)$ 的权重：$w_{01} = (1-\\xi)\\eta = (1-0.6) \\times 0.6 = 0.4 \\times 0.6 = 0.24$\n- $(Z_1, c_1)$ 的权重：$w_{11} = \\xi\\eta = 0.6 \\times 0.6 = 0.36$\n权重之和为 $0.16 + 0.24 + 0.24 + 0.36 = 1.0$。\n\n现在，我们将这些权重应用于表格值。\n对于温度 $T$：\n$T(Z, c) = w_{00}T_{00} + w_{10}T_{10} + w_{01}T_{01} + w_{11}T_{11}$\n$T(0.22, 0.38) = (0.16)(1000) + (0.24)(1800) + (0.24)(1500) + (0.36)(2100)$\n$T(0.22, 0.38) = 160 + 432 + 360 + 756 = 1708$\n四舍五入到 $4$ 位有效数字，温度为 $1708$ K。\n\n对于组分质量分数向量 $Y = (Y_1, Y_2, Y_3)$，我们对每个分量应用相同的插值方法。\n$Y(Z, c) = w_{00}Y_{00} + w_{10}Y_{10} + w_{01}Y_{01} + w_{11}Y_{11}$\n\n- 对于 $Y_1$：\n$Y_1(0.22, 0.38) = (0.16)(0.30) + (0.24)(0.55) + (0.24)(0.10) + (0.36)(0.25)$\n$Y_1(0.22, 0.38) = 0.048 + 0.132 + 0.024 + 0.090 = 0.294$\n四舍五入到 $4$ 位有效数字，$Y_1 = 0.2940$。\n\n- 对于 $Y_2$：\n$Y_2(0.22, 0.38) = (0.16)(0.60) + (0.24)(0.35) + (0.24)(0.40) + (0.36)(0.25)$\n$Y_2(0.22, 0.38) = 0.096 + 0.084 + 0.096 + 0.090 = 0.366$\n四舍五入到 $4$ 位有效数字，$Y_2 = 0.3660$。\n\n- 对于 $Y_3$：\n$Y_3(0.22, 0.38) = (0.16)(0.10) + (0.24)(0.10) + (0.24)(0.50) + (0.36)(0.50)$\n$Y_3(0.22, 0.38) = 0.016 + 0.024 + 0.120 + 0.180 = 0.340$\n四舍五入到 $4$ 位有效数字，$Y_3 = 0.3400$。\n\n插值得到的组分质量分数向量为 $Y = (0.2940, 0.3660, 0.3400)$。\n\n**3. 质量分数守恒的验证**\n\n我们必须验证插值得到的质量分数之和为 $1$。\n设 $Y_{i}(Z,c)$ 为组分 $i$ 的插值质量分数。\n$$\\sum_{i=1}^{N} Y_{i}(Z,c) = \\sum_{i=1}^{N} \\left( w_{00}Y_{i,00} + w_{10}Y_{i,10} + w_{01}Y_{i,01} + w_{11}Y_{i,11} \\right)$$\n由于求和是线性运算，我们可以改变求和的顺序：\n$$\\sum_{i=1}^{N} Y_{i}(Z,c) = w_{00}\\left(\\sum_{i=1}^{N}Y_{i,00}\\right) + w_{10}\\left(\\sum_{i=1}^{N}Y_{i,10}\\right) + w_{01}\\left(\\sum_{i=1}^{N}Y_{i,01}\\right) + w_{11}\\left(\\sum_{i=1}^{N}Y_{i,11}\\right)$$\n根据问题定义，每个表格化角点的质量分数之和为 $1$。\n$$\\sum_{i=1}^{N}Y_{i,00} = 1, \\quad \\sum_{i=1}^{N}Y_{i,10} = 1, \\quad \\sum_{i=1}^{N}Y_{i,01} = 1, \\quad \\sum_{i=1}^{N}Y_{i,11} = 1$$\n因此，\n$$\\sum_{i=1}^{N} Y_{i}(Z,c) = w_{00}(1) + w_{10}(1) + w_{01}(1) + w_{11}(1) = w_{00} + w_{10} + w_{01} + w_{11}$$\n如前所示，双线性插值权重之和总是 $1$。\n$$\\sum_{i=1}^{N} Y_{i}(Z,c) = 1$$\n这表明双线性插值方案内在地保持了质量分数守恒的性质。\n\n用我们计算出的值进行数值验证：\n$\\sum_{i=1}^{3} Y_i = 0.2940 + 0.3660 + 0.3400 = 1.0000$。\n验证成功。\n\n最终答案包含插值温度和三个组分的质量分数，均四舍五入到 $4$ 位有效数字。\n$T = 1708$ K\n$Y = (0.2940, 0.3660, 0.3400)$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1708  0.2940  0.3660  0.3400 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然线性插值很稳健，但为了获得更高的精度，我们常常需要使用高阶方法。然而，标准的高阶插值（如三次样条）可能会引入非物理的伪影，例如温度的过冲和下冲。这项高级练习通过对比标准三次样条和保形单调样条，展示了如何在不牺牲物理真实性的前提下实现更高阶的插值精度。",
            "id": "4070256",
            "problem": "给定一个一维（$1$-D）列表化的温度剖面，它代表了计算燃烧学中降维化学流形的一个典型例子，其中自变量是无量纲的混合分数 $x$，因变量是温度 $T$（单位为开尔文）。在列表化学库中，精确且保形的插值对于避免 $T(x)$ 中可能违反热力学一致性的非物理过冲至关重要。\n\n从基本定义出发，考虑以下插值构造：\n- 在子区间 $[x_i,x_{i+1}]$ 上的分段多项式插值，它匹配列表值 $T_i = T(x_i)$。\n- 具有端点数据 $(x_i, T_i)$ 和斜率 $m_i = \\frac{dT}{dx}(x_i)$ 的分段三次埃尔米特表示，组合后形成一个全局 $C^1$ 类（一次连续可微）的插值函数。\n- 一种保形单调三次策略，它对 $\\{m_i\\}$ 施加约束，使得如果 $\\{T_i\\}$ 在 $[x_i,x_{i+1}]$ 上是单调的，插值函数在该子区间内将保持在局部界限 $\\left[\\min(T_i,T_{i+1}), \\max(T_i,T_{i+1})\\right]$ 之内。\n\n使用广为接受的事实：\n- 没有显式保形约束的自然三次样条，在曲率急剧变化时可能会出现过冲，即使对于单调数据也是如此。\n- 分段三次埃尔米特插值多项式 (PCHIP) 使用从局部割线斜率导出的受约束斜率来保持单调性并避免过冲，同时维持 $C^1$ 类连续性。\n\n您的任务是为每个测试用例实现两种插值器：\n- 一个无约束三次样条。\n- 一个使用 PCHIP 的单调三次样条。\n\n然后，为每个测试用例评估以下量化诊断指标：\n- 在整个定义域上，插值函数 $f$ 的过冲幅度：对于每个子区间 $[x_i,x_{i+1}]$，在 $[x_i,x_{i+1}]$ 中均匀采样 $N$ 个点 $\\{s_k\\}$，并计算区间界限 $L_i = \\min(T_i,T_{i+1})$ 和 $U_i = \\max(T_i,T_{i+1})$。将区间过冲定义为\n$$\nO_i(f) = \\max_{k}\\left(\\max\\left(0, f(s_k) - U_i\\right), \\max\\left(0, L_i - f(s_k)\\right)\\right),\n$$\n全局过冲幅度定义为\n$$\nO(f) = \\max_i O_i(f).\n$$\n返回 $O(f)$，一个以开尔文为单位的实数值。\n- PCHIP 插值函数 $p$ 的单调性检查：在整个定义域上采样 $M$ 个点，验证其非递减行为，\n$$\np(x_{j+1}) - p(x_j) \\ge -\\varepsilon,\n$$\n对于一个容差 $\\varepsilon  0$。返回一个布尔值，指示该条件是否成立。\n- $C^1$ 类连续性检查，针对 PCHIP 插值函数 $p$：对于每个内部节点 $x_i$（其中 $i \\in \\{1, \\dots, n-2\\}$），通过在 $x_i \\pm \\delta_i$ 处进行采样来评估左右导数的极限 $p'(x_i^-)$ 和 $p'(x_i^+)$，其中 $\\delta_i$ 是一个相对于局部间距的小量。验证\n$$\n\\left|p'(x_i^-) - p'(x_i^+)\\right| \\le \\tau,\n$$\n在所有内部节点处是否满足容差 $\\tau  0$。返回一个布尔值，指示该条件是否成立。\n\n物理单位：温度必须以开尔文处理和报告。混合分数 $x$ 是无量纲的。\n\n角度单位不适用。\n\n测试套件如下，包含明确的列表化坐标和温度：\n- 测试用例 1（具有可变曲率的单调数据）：$x = [0.0, 0.1, 0.2, 0.4, 0.7, 1.0]$，$T = [300.0, 310.0, 400.0, 800.0, 1400.0, 1800.0]$ 开尔文。\n- 测试用例 2（平坦区后急剧上升）：$x = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0]$，$T = [300.0, 300.0, 300.0, 800.0, 1200.0, 1200.0]$ 开尔文。\n- 测试用例 3（末端附近的梯度突变）：$x = [0.0, 0.3, 0.31, 1.0]$，$T = [300.0, 330.0, 1600.0, 1800.0]$ 开尔文。\n\n对于数值参数，使用每个区间 $N = 1000$ 个样本来计算过冲，在整个定义域上使用 $M = 5000$ 个样本进行单调性检查，单调性容差为 $\\varepsilon = 10^{-10}$，$C^1$ 类连续性容差为 $\\tau = 10^{-9}$，并定义 $\\delta_i = 10^{-12} \\times (x_{i+1} - x_{i-1})$。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表，该列表封装在方括号中。列表的每个元素对应一个测试用例，每个测试用例的结果是按指定顺序聚合所需诊断指标的列表：\n- 对于测试用例 1：$[O(\\text{spline}), O(\\text{pchip}), \\text{is\\_monotone}]$。\n- 对于测试用例 2：$[O(\\text{spline}), O(\\text{pchip}), \\text{is\\_C1}]$。\n- 对于测试用例 3：$[O(\\text{spline}), O(\\text{pchip})]$。\n\n例如，最终输出必须具有 $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3]]$ 的形式，其中 $a_i$ 和 $b_i$ 是以开尔文为单位的实数，$c_i$ 是布尔值。",
            "solution": "我们从计算燃烧学中的列表化概念开始：化学库将一个低维控制变量（如混合分数 $x$）映射到热化学量（如温度 $T$），形式为在节点 $\\{(x_i, T_i)\\}_{i=0}^{n-1}$（其中 $x_0  x_1  \\dots  x_{n-1}$）处采样的函数 $T(x)$。精确的插值必须尊重物理单调性并避免非物理的过冲。\n\n基本定义。在每个子区间 $[x_i,x_{i+1}]$ 上的分段三次埃尔米特插值函数构造如下\n$$\np_i(x) = a_i (x-x_i)^3 + b_i (x-x_i)^2 + c_i (x-x_i) + d_i,\n$$\n其端点条件为\n$$\np_i(x_i) = T_i, \\quad p_i(x_{i+1}) = T_{i+1}, \\quad p_i'(x_i) = m_i, \\quad p_i'(x_{i+1}) = m_{i+1}.\n$$\n选择斜率 $\\{m_i\\}$ 并组合 $\\{p_i\\}$ 可得到一个全局插值函数 $p(x)$，如果对于所有内部节点都有 $p_i'(x_{i+1}) = p_{i+1}'(x_{i+1})$，则该函数为 $C^1$ 类。自然三次样条通过最小化一个涉及二阶导数的能量泛函来隐式确定 $\\{m_i\\}$，但它不强制保证单调性；曲率的急剧变化可能导致超出局部界限的过冲，从而产生非物理的温度。\n\n保形策略。分段三次埃尔米特插值多项式 (PCHIP) 通过从相邻的割线斜率中选择 $\\{m_i\\}$ 来强制实现单调性。定义局部间距和割线斜率\n$$\nh_i = x_{i+1} - x_i, \\quad d_i = \\frac{T_{i+1} - T_i}{h_i}.\n$$\n对于内部节点（其中 $i \\in \\{1,\\dots,n-2\\}$），Fritsch–Carlson 约束设置如下\n$$\nm_i =\n\\begin{cases}\n\\displaystyle \\frac{(h_{i-1} + h_i)}{\\frac{h_{i-1}}{d_{i-1}} + \\frac{h_i}{d_i}},  \\text{if } d_{i-1} d_i  0, \\\\\n0,  \\text{if } d_{i-1} d_i \\le 0,\n\\end{cases}\n$$\n当相邻割线斜率符号相同时，该值是它们的加权调和平均值，否则为零。端点斜率 $m_0$ 和 $m_{n-1}$ 是根据限制过冲的单边有偏公式计算的；具体来说，$m_0$ 和 $m_{n-1}$被选为相邻 $d$ 值的非负组合，并进行裁剪以避免产生新的极值。这些约束确保了如果 $\\{T_i\\}$ 在 $[x_i,x_{i+1}]$ 上是单调的，那么 $p(x)$ 会保持在区间界限 $\\left[\\min(T_i,T_{i+1}), \\max(T_i,T_{i+1})\\right]$ 内，同时保持 $C^1$ 类连续性，因为该构造在节点处强制导数匹配。\n\n诊断指标定义。为量化过冲，对于每个子区间 $[x_i,x_{i+1}]$，我们采样 $N$ 个点 $\\{s_k\\}$ 并定义界限\n$$\nL_i = \\min(T_i, T_{i+1}), \\quad U_i = \\max(T_i, T_{i+1}),\n$$\n并测量最大违规幅度\n$$\nO_i(f) = \\max_k \\left( \\max(0, f(s_k) - U_i), \\max(0, L_i - f(s_k)) \\right).\n$$\n我们将其聚合为\n$$\nO(f) = \\max_i O_i(f),\n$$\n其单位为开尔文，如果插值函数处处保持在局部界限内，则该值为零。\n\nPCHIP 的单调性检查通过采样 $M$ 个点 $\\{x_j\\}$ 并验证\n$$\np(x_{j+1}) - p(x_j) \\ge -\\varepsilon\n$$\n是否对一个小容差 $\\varepsilon$ 成立来进行，返回一个指示非递减行为的布尔值。由于 PCHIP 构造在单调数据上强制实现单调行为，因此在列表数据本身是非递减的测试用例上，此检查应能通过。\n\n$C^1$ 类连续性通过比较内部节点 $x_i$ 处的单边导数来评估。设 $\\delta_i = 10^{-12} \\times (x_{i+1} - x_{i-1})$。我们计算\n$$\np'(x_i^-) \\approx p'(x_i - \\delta_i), \\quad p'(x_i^+) \\approx p'(x_i + \\delta_i),\n$$\n并对一个小 $\\tau$ 验证容差\n$$\n\\left|p'(x_i^-) - p'(x_i^+)\\right| \\le \\tau\n$$\n，返回一个布尔值。PCHIP 插值函数是 $C^1$ 类的，因此在数值精度限制内，该检查应能通过。\n\n算法设计。对每个测试用例，我们：\n- 从 $(x_i, T_i)$ 构建一个无约束三次样条 $s(x)$ 和一个 PCHIP 插值函数 $p(x)$。\n- 使用每个区间 $N = 1000$ 个样本计算 $O(s)$ 和 $O(p)$。\n- 对于第一个测试用例，使用 $M = 5000$ 个样本和 $\\varepsilon = 10^{-10}$ 检查 $p$ 的单调性。\n- 对于第二个测试用例，通过比较内部节点的单边导数来检查 $p$ 的 $C^1$ 类连续性，其中 $\\tau = 10^{-9}$ 且 $\\delta_i$ 如前定义。\n\n输出规格。程序输出单行，包含一个有三个条目的列表，每个条目对应一个测试用例：\n- 测试用例 1：$[O(s), O(p), \\text{is\\_monotone}]$。\n- 测试用例 2：$[O(s), O(p), \\text{is\\_C1}]$。\n- 测试用例 3：$[O(s), O(p)]$。\n\n科学真实性。列表化的温度代表了随 $x$ 增加温度升高的燃烧过程，包括一个平坦区和一个陡峭梯度，已知这些情况对无约束三次样条构成挑战。源自局部割线斜率的 PCHIP 约束在消除过冲的同时保持了形状和 $C^1$ 类连续性，这对于鲁棒的列表化学库至关重要。",
            "answer": "[[16.3265306122449,0.0,True],[75.92592592592582,0.0,True],[122.18844888062837,0.0]]"
        }
    ]
}