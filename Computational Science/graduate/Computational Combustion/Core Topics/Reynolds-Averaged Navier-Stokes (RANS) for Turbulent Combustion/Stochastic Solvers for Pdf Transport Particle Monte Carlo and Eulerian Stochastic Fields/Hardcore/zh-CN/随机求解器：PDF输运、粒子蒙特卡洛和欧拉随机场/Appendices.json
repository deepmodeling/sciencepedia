{
    "hands_on_practices": [
        {
            "introduction": "要掌握随机求解器，我们首先必须理解微观混合模型的基本行为。均值交换相互作用 (IEM) 模型尽管简单，却为标量场如何向其均值松弛提供了关键的洞见。本练习  将引导您从一个简单的双峰分布出发，通过解析推导来探索IEM模型下的概率密度函数（PDF）演化，使您能够直观地观察并量化标量非均匀性的确定性衰减过程。",
            "id": "4068250",
            "problem": "考虑在一个统计平稳、空间均匀、无源、无汇、无平均流梯度的反应器中，对一个守恒混合分数 $Z$ 进行均匀湍流混合。在初始时刻 $t=0$ 时，$Z$ 的概率密度函数 (PDF) 是双峰的，由两个狄拉克δ分布的凸组合构成，\n$$\nP(Z,0) \\;=\\; w_1\\,\\delta\\!\\left(Z - z_1\\right) \\;+\\; w_2\\,\\delta\\!\\left(Z - z_2\\right),\n$$\n其中 $w_10$，$w_20$，$w_1+w_2=1$，且 $z_1 \\neq z_2$。混合过程使用“与均值相互作用交换 (IEM)”模型进行建模，其对任意实现 $Z(t)$ 的微观混合定律为\n$$\n\\frac{dZ}{dt} \\;=\\; -\\,\\frac{1}{\\tau_m}\\,\\bigl(Z(t) - \\widetilde{Z}(t)\\bigr),\n$$\n其中 $\\tau_m0$ 是一个恒定的微观混合时间尺度，$\\widetilde{Z}(t)$ 是 $Z$ 在时间 $t$ 的系综平均值。假设均值 $\\widetilde{Z}(t)$ 由演化的 PDF 自洽确定，且系统是封闭且均匀的，因此守恒定律适用。\n\n从均匀 IEM 混合下守恒标量的均值基本守恒定律以及在漂移 $\\dot{Z} = -(Z - \\widetilde{Z})/\\tau_m$ 下的 PDF 确定性刘维尔输运出发，推导当 $t0$ 时 PDF $P(Z,t)$ 的时间演化，并明确展示两个δ峰如何随时间移动。然后，定义双峰指数\n$$\nB(t) \\;=\\; \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|},\n$$\n其中 $z_1(t)$ 和 $z_2(t)$ 表示在时间 $t$ 的瞬时峰值位置，并以闭合形式计算 $B(t)$。\n\n请以单一闭合形式的符号表达式提供您的最终答案。无需四舍五入。双峰指数 $B(t)$ 是无量纲的；最终答案中不要包含单位。",
            "solution": "首先验证问题，确保其在科学上合理、适定且客观。\n\n**步骤 1：提取已知条件**\n- 混合分数 $Z$ 的初始概率密度函数 (PDF)：$P(Z,0) = w_1\\,\\delta(Z - z_1) + w_2\\,\\delta(Z - z_2)$。\n- 权重条件：$w_1  0$，$w_2  0$，$w_1+w_2=1$。\n- 初始峰值位置：$z_1 \\neq z_2$。\n- 混合模型：与均值相互作用交换 (IEM) 模型。\n- IEM 定律：$\\frac{dZ}{dt} = -\\frac{1}{\\tau_m}(Z(t) - \\widetilde{Z}(t))$。\n- 微观混合时间尺度：$\\tau_m0$ 为常数。\n- 系综平均：$\\widetilde{Z}(t) = \\int_{-\\infty}^{\\infty} \\xi P(\\xi, t) d\\xi$。\n- 系统属性：均匀、统计平稳、封闭、无源或汇，$Z$ 是一个守恒标量。\n- 双峰指数定义：$B(t) = \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|}$，其中 $z_1(t)$ 和 $z_2(t)$ 是在时间 $t$ 的峰值位置。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上是有根据的，描述了湍流中标量混合的一个标准模型 (IEM)，这是计算燃烧学的核心课题。它是一个适定问题，为 PDF 的演化提供了一个清晰的初值问题。语言客观，并使用了标准术语。陈述“$Z$ 是一个封闭、均匀系统中的守恒标量”意味着其平均值 $\\widetilde{Z}(t)$ 必须是恒定的。这可以通过对均值定义求时间导数并使用 PDF 的刘维尔输运方程 $\\frac{\\partial P}{\\partial t} + \\frac{\\partial}{\\partial Z}(\\dot{Z}P)=0$ 来验证，其中 $\\dot{Z}$ 是 IEM 混合定律。这导致 $\\frac{d\\widetilde{Z}}{dt} = \\int \\dot{Z}P\\,dZ = \\int -\\frac{1}{\\tau_m}(Z - \\widetilde{Z})P\\,dZ = -\\frac{1}{\\tau_m}(\\widetilde{Z} - \\widetilde{Z}) = 0$。因此，$\\widetilde{Z}(t)$ 确实是恒定的。问题是自洽的，并包含了所有必要信息。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n该问题要求推导 PDF $P(Z,t)$ 的时间演化和双峰指数 $B(t)$。\n\n首先，我们确定恒定的系综平均值 $\\widetilde{Z}$。由于 $\\widetilde{Z}(t)$ 对于所有 $t \\ge 0$ 都是恒定的，我们可以使用给定的初始 PDF $P(Z,0)$ 在 $t=0$ 时计算它。\n$$\n\\widetilde{Z} = \\widetilde{Z}(0) = \\int_{-\\infty}^{\\infty} Z \\, P(Z,0) \\, dZ\n$$\n代入 $P(Z,0)$ 的表达式：\n$$\n\\widetilde{Z} = \\int_{-\\infty}^{\\infty} Z \\, \\left[ w_1\\,\\delta(Z - z_1) + w_2\\,\\delta(Z - z_2) \\right] \\, dZ\n$$\n利用狄拉克δ分布的筛选性质 $\\int f(x)\\delta(x-a)dx = f(a)$，我们得到：\n$$\n\\widetilde{Z} = w_1 z_1 + w_2 z_2\n$$\n这是混合分数在所有时间 $t \\ge 0$ 的恒定平均值。\n\n接下来，我们分析由 IEM 模型控制的任何单个实现 $Z(t)$ 的演化。IEM 定律是一个一阶线性常微分方程 (ODE)：\n$$\n\\frac{dZ}{dt} = -\\frac{1}{\\tau_m}\\left(Z(t) - \\widetilde{Z}\\right)\n$$\n这个方程可以通过分离变量法或将其识别为标准线性 ODE 形式来求解。令 $Y(t) = Z(t) - \\widetilde{Z}$。那么 $\\frac{dY}{dt} = \\frac{dZ}{dt}$。ODE 变为：\n$$\n\\frac{dY}{dt} = -\\frac{1}{\\tau_m}Y(t)\n$$\n这个齐次 ODE 的解是 $Y(t) = Y(0)\\,\\exp(-t/\\tau_m)$。代回 $Z(t)$：\n$$\nZ(t) - \\widetilde{Z} = \\left(Z(0) - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n这可以重新排列，给出标量空间中任意点 $Z(0)$ 的轨迹：\n$$\nZ(t) = \\widetilde{Z} + \\left(Z(0) - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n这个方程描述了从 $t=0$ 时的标量值到时间 $t$ 时的标量值的确定性映射。\n\nPDF $P(Z,t)$ 在此确定性映射下的演化可以通过沿这些轨迹输运初始 PDF 来找到。初始 PDF 由位于 $Z=z_1$ 和 $Z=z_2$ 的两个狄拉克δ分布组成。每个δ函数将根据上面导出的轨迹方程移动。\n\n令 $z_1(t)$ 为最初位于 $z_1 \\equiv z_1(0)$ 的峰的位置。使用轨迹方程，设 $Z(0)=z_1$：\n$$\nz_1(t) = \\widetilde{Z} + \\left(z_1 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n类似地，对于最初位于 $z_2 \\equiv z_2(0)$ 的峰，其位置 $z_2(t)$ 由下式给出：\n$$\nz_2(t) = \\widetilde{Z} + \\left(z_2 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n由于权重 $w_1$ 和 $w_2$ 代表守恒的概率（或δ分布的质量分数），它们保持不变。因此，在任何时间 $t0$ 的 PDF 由两个被输运的δ分布之和给出：\n$$\nP(Z,t) = w_1\\,\\delta(Z - z_1(t)) + w_2\\,\\delta(Z - z_2(t))\n$$\n这明确地显示了两个δ峰如何随时间移动，指数地向均值 $\\widetilde{Z}$ 弛豫。\n\n现在，我们计算双峰指数 $B(t)$，其定义为：\n$$\nB(t) = \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|}\n$$\n分母就是 $|z_2 - z_1|$。对于分子，我们计算差值 $z_2(t) - z_1(t)$：\n$$\nz_2(t) - z_1(t) = \\left[ \\widetilde{Z} + \\left(z_2 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\right] - \\left[ \\widetilde{Z} + \\left(z_1 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\right]\n$$\n$$\nz_2(t) - z_1(t) = \\left[ (z_2 - \\widetilde{Z}) - (z_1 - \\widetilde{Z}) \\right] \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n$$\nz_2(t) - z_1(t) = (z_2 - z_1) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n取这个差值的绝对值：\n$$\n|z_2(t) - z_1(t)| = \\left|(z_2 - z_1) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\\right|\n$$\n因为 $t \\ge 0$ 且 $\\tau_m  0$，指数项 $\\exp(-t/\\tau_m)$ 总是非负的。因此：\n$$\n|z_2(t) - z_1(t)| = |z_2 - z_1| \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n最后，我们将此结果代入 $B(t)$ 的定义中：\n$$\nB(t) = \\frac{|z_2 - z_1| \\exp\\left(-\\frac{t}{\\tau_m}\\right)}{|z_2 - z_1|}\n$$\n鉴于 $z_1 \\neq z_2$，项 $|z_2 - z_1|$ 非零，可以从分子和分母中消去。这得到了双峰指数的闭合形式表达式：\n$$\nB(t) = \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n这个结果表明，PDF 两个模式之间的距离以等于微观混合时间尺度 $\\tau_m$ 的特征时间指数衰减，这是 IEM 模型的预期物理行为。",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{t}{\\tau_m}\\right)}$$"
        },
        {
            "introduction": "像IEM这样的唯象模型依赖于一些参数，例如混合时间尺度 $\\tau_m$，这些参数必须通过更高保真度的数据或实验来确定，才能具有物理意义。本练习  提供了一项关键工程与科学任务的实践经验：模型校准。您将学习如何使用来自直接数值模拟 (DNS) 的“基准”数据来推断 $\\tau_m$ 的最优值，从而弥合简化理论与复杂物理现实之间的鸿沟。",
            "id": "4068262",
            "problem": "您需要通过标定微混合时间尺度，并将预测的标量方差衰减与均匀湍流中的直接数值模拟（DNS）数据进行比较，来验证用于计算燃烧学中概率密度函数（PDF）输运的随机求解器中所使用的微混合模型。考虑一个被动标量场，其湍流为均匀各向同性，无平均剪切，无外部源项，因此平均标量保持恒定，仅方差因微混合而衰减。对于使用“与均值交换”（IEM）微混合模型的基于粒子的蒙特卡洛求解器和采用线性弛豫的欧拉随机场（ESF）求解器，每个粒子或场中的瞬时标量都服从向均值的线性弛豫。\n\n从不可压缩流中的基本被动标量输运方程和标量场方差的定义出发，推导一个与这些微混合模型一致的方差衰减方程。然后，给定均匀湍流中方差衰减的DNS数据，推断出能最佳匹配该衰减过程的微混合时间尺度 $ \\tau_m $ 或等效模型参数的标定值。\n\n假设以下基本前提：\n- 瞬时被动标量 $ Z(\\mathbf{x},t) $ 的均值为 $ \\langle Z \\rangle $，方差为 $ \\sigma^2(t) = \\langle (Z - \\langle Z \\rangle)^2 \\rangle $。\n- 均匀湍流中没有平均标量生成或外部源项，这意味着 $ d\\langle Z \\rangle/dt = 0 $。\n- 使用“与均值交换”（IEM）微混合模型的基于粒子的蒙特卡洛方法由一个线性弛豫形式表示：$ dZ_p/dt = -(Z_p - \\langle Z \\rangle)/\\tau_m $，其中 $ Z_p $ 是粒子携带的标量。\n- 使用线性弛豫的欧拉随机场（ESF）方法对每个随机场 $ \\phi_n $ 表示为 $ d\\phi_n/dt = -(\\phi_n - \\langle \\phi \\rangle)/\\tau_m $，其系综均值为 $ \\langle \\phi \\rangle $。\n\n您的程序必须：\n1. 在均匀湍流条件下，推导由这些模型隐含的方差衰减方程，并用它来构建 $ \\ln \\sigma^2(t) $ 的斜率与微混合时间尺度 $ \\tau_m $ 之间的标定关系。\n2. 实现两种标定策略：\n   - 基于粒子蒙特卡洛（IEM）的标定：通过最小二乘法估计 $ \\ln \\sigma^2(t) $ 相对于 $ t $ 的斜率，并从该斜率推断出 $ \\tau_m $。\n   - 基于欧拉随机场（ESF）的标定：通过非线性最小二乘法，最小化DNS方差 $ \\sigma^2_{\\mathrm{DNS}}(t) $ 与预测的 $ \\sigma^2_{\\mathrm{model}}(t;\\tau_m) $ 之间的平方误差和。\n\nDNS测试套件为三种科学上合理的均匀湍流情况提供了时间序列数据。时间单位为秒，方差为无量纲。请精确使用所提供的数据：\n\n- 情况 $ 1 $ （理想情况，快速混合）：时间 $ [0.0, 0.05, 0.1, 0.2, 0.4, 0.8] $；DNS方差 $ [1.0, 0.6753200460, 0.4463289641, 0.2038965180, 0.0397622040, 0.0017658580] $。\n- 情况 $ 2 $ （慢速混合，长时间衰减）：时间 $ [0.0, 1.0, 2.0, 5.0, 10.0] $；DNS方差 $ [1.0, 0.6603200460, 0.4643289640, 0.1303352830, 0.0203156390] $。\n- 情况 $ 3 $ （初始方差小，中等混合）：时间 $ [0.0, 0.1, 0.2, 0.5, 1.0] $；DNS方差 $ [0.01, 0.00675320046, 0.00447328964, 0.00136335283, 0.00018315639] $。\n\n您的程序必须：\n- 对每种情况，计算两个标定的微混合时间尺度（单位为秒）：$ \\tau_m^{\\mathrm{MC}} $（通过基于IEM的斜率拟合得到）和 $ \\tau_m^{\\mathrm{ESF}} $（通过使用ESF方差预测模型 $ \\sigma^2_{\\mathrm{model}}(t;\\tau_m) = \\sigma^2(0) \\exp(-2 t / \\tau_m) $ 进行非线性最小二乘最小化得到）。\n- 将每个标定的 $ \\tau_m $ 以秒为单位表示，并四舍五入到六位小数。\n- 生成一行输出，其中包含按顺序排列的六个标定值 $ [\\tau_m^{\\mathrm{MC},1}, \\tau_m^{\\mathrm{ESF},1}, \\tau_m^{\\mathrm{MC},2}, \\tau_m^{\\mathrm{ESF},2}, \\tau_m^{\\mathrm{MC},3}, \\tau_m^{\\mathrm{ESF},3}] $。\n\n科学真实性约束：\n- 在取对数时，确保方差值严格为正。\n- 不要使用任何外部数据；仅使用提供的测试套件。\n- 时间和 $ \\tau_m $ 的单位使用秒；方差是无量纲的。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$ [result1,result2,result3] $），每个结果四舍五入到六位小数，并以秒为单位表示。",
            "solution": "问题陈述已经过验证，被确定为自洽、有科学依据且定义明确。任务是从微混合模型中推导方差衰减模型，并用它来根据提供的直接数值模拟（DNS）数据标定微混合时间尺度 $ \\tau_m $。\n\n### 步骤 1：方差衰减方程的推导\n\n我们从标量场 $ Z(\\mathbf{x},t) $ 的方差定义开始，记为 $ \\sigma^2(t) $：\n$$ \\sigma^2(t) = \\langle (Z - \\langle Z \\rangle)^2 \\rangle $$\n其中 $ \\langle \\cdot \\rangle $ 代表系综平均算子。\n\n为了求得方差的变化率，我们对该定义关于时间 $ t $求导：\n$$ \\frac{d\\sigma^2}{dt} = \\frac{d}{dt} \\langle (Z - \\langle Z \\rangle)^2 \\rangle $$\n\n对于统计均匀的流动，时间导数和平均算子可以交换。应用链式法则进行微分，我们得到：\n$$ \\frac{d\\sigma^2}{dt} = \\left\\langle 2 (Z - \\langle Z \\rangle) \\frac{d}{dt} (Z - \\langle Z \\rangle) \\right\\rangle $$\n\n展开平均内的导数项：\n$$ \\frac{d}{dt} (Z - \\langle Z \\rangle) = \\frac{dZ}{dt} - \\frac{d\\langle Z \\rangle}{dt} $$\n\n问题陈述指出，对于均匀湍流中无平均生成或源项的被动标量情况，平均标量是恒定的。因此，$ d\\langle Z \\rangle/dt = 0 $。这简化了上述表达式为：\n$$ \\frac{d}{dt} (Z - \\langle Z \\rangle) = \\frac{dZ}{dt} $$\n\n将此结果代回方差变化率的方程中：\n$$ \\frac{d\\sigma^2}{dt} = \\left\\langle 2 (Z - \\langle Z \\rangle) \\frac{dZ}{dt} \\right\\rangle $$\n\n现在，我们引入微混合模型。粒子蒙特卡洛方法的“与均值交换”（IEM）模型和欧拉随机场（ESF）的线性弛豫模型都由相同的形式表示。对于任何单个实现（粒子的标量值 $ Z_p $ 或随机场值 $ \\phi_n $，我们统一记为 $ Z $），其演化是一个向均值的线性弛豫：\n$$ \\frac{dZ}{dt} = -\\frac{Z - \\langle Z \\rangle}{\\tau_m} $$\n其中 $ \\tau_m $ 是特征微混合时间尺度。\n\n将该模型代入我们的 $ d\\sigma^2/dt $ 方程：\n$$ \\frac{d\\sigma^2}{dt} = \\left\\langle 2 (Z - \\langle Z \\rangle) \\left( -\\frac{Z - \\langle Z \\rangle}{\\tau_m} \\right) \\right\\rangle $$\n\n我们可以将常数 $ -2/\\tau_m $ 提出平均算子：\n$$ \\frac{d\\sigma^2}{dt} = -\\frac{2}{\\tau_m} \\langle (Z - \\langle Z \\rangle)^2 \\rangle $$\n\n注意到 $ \\langle (Z - \\langle Z \\rangle)^2 \\rangle $ 正是方差 $ \\sigma^2 $ 的定义，我们得到最终的方差衰减常微分方程（ODE）：\n$$ \\frac{d\\sigma^2}{dt} = -\\frac{2}{\\tau_m} \\sigma^2(t) $$\n\n### 步骤 2：常微分方程的解与标定关系\n\n推导出的ODE是一阶线性齐次微分方程。它可以通过分离变量法求解，初始条件为 $ \\sigma^2(t=0) = \\sigma^2(0) $：\n$$ \\int_{\\sigma^2(0)}^{\\sigma^2(t)} \\frac{d\\tilde{\\sigma}^2}{\\tilde{\\sigma}^2} = \\int_0^t -\\frac{2}{\\tau_m} d\\tilde{t} $$\n$$ \\ln(\\sigma^2(t)) - \\ln(\\sigma^2(0)) = -\\frac{2}{\\tau_m} t $$\n\n这为我们的标定策略提供了两种有用的形式。首先，是 $ \\sigma^2(t) $ 的显式解：\n$$ \\sigma^2(t) = \\sigma^2(0) \\exp\\left(-\\frac{2t}{\\tau_m}\\right) $$\n该模型直接用于基于ESF方法的非线性最小二乘标定。\n\n其次，是对数空间中的线性关系：\n$$ \\ln(\\sigma^2(t)) = \\left(-\\frac{2}{\\tau_m}\\right)t + \\ln(\\sigma^2(0)) $$\n该方程具有 $ y = mx + c $ 的形式，其中 $ y = \\ln(\\sigma^2(t)) $，$ x = t $，截距为 $ c = \\ln(\\sigma^2(0)) $，斜率为 $ m = -2/\\tau_m $。\n\n### 步骤 3：标定策略的实现\n\n#### 策略 1：基于粒子蒙特卡洛（IEM）的标定\n此方法使用上面推导的线性关系。我们对数据对 $ (t_i, \\ln(\\sigma^2_{\\mathrm{DNS},i})) $ 进行线性最小二乘回归，以找到最佳拟合斜率 $ m $。一旦确定了斜率，微混合时间尺度 $ \\tau_m^{\\mathrm{MC}} $ 就通过重新整理斜率定义来计算：\n$$ m = -\\frac{2}{\\tau_m^{\\mathrm{MC}}} \\implies \\tau_m^{\\mathrm{MC}} = -\\frac{2}{m} $$\n此计算将使用 `numpy.polyfit` 来找到斜率 $ m $。\n\n#### 策略 2：基于欧拉随机场（ESF）的标定\n此方法直接使用非线性的指数衰减模型。目标是找到使DNS数据与模型预测之间的平方误差和（SSE）最小化的 $ \\tau_m^{\\mathrm{ESF}} $ 值：\n$$ \\text{SSE}(\\tau_m) = \\sum_{i} \\left( \\sigma^2_{\\mathrm{DNS}}(t_i) - \\sigma^2_{\\mathrm{model}}(t_i; \\tau_m) \\right)^2 $$\n其中 $ \\sigma^2_{\\mathrm{model}}(t; \\tau_m) = \\sigma^2(0) \\exp(-2t/\\tau_m) $，且 $ \\sigma^2(0) $ 是一个已知值（每种情况下DNS数据的第一个点）。这个非线性最小化问题将使用 `scipy.optimize.least_squares` 来解决。优化器的残差函数是：\n$$ r_i(\\tau_m) = \\sigma^2_{\\mathrm{DNS}}(t_i) - \\sigma^2(0) \\exp(-2t_i/\\tau_m) $$\n一个好的迭代求解器初始猜测值是线性拟合得到的值 $ \\tau_m^{\\mathrm{MC}} $。\n\n以下程序将为提供的三个DNS测试案例分别实现这两种策略。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Validates micromixing closures by calibrating the micromixing time scale\n    tau_m against DNS data for scalar variance decay in homogeneous turbulence.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"times\": np.array([0.0, 0.05, 0.1, 0.2, 0.4, 0.8]),\n            \"variances\": np.array([1.0, 0.6753200460, 0.4463289641, 0.2038965180, 0.0397622040, 0.0017658580])\n        },\n        {\n            \"times\": np.array([0.0, 1.0, 2.0, 5.0, 10.0]),\n            \"variances\": np.array([1.0, 0.6603200460, 0.4643289640, 0.1303352830, 0.0203156390])\n        },\n        {\n            \"times\": np.array([0.0, 0.1, 0.2, 0.5, 1.0]),\n            \"variances\": np.array([0.01, 0.00675320046, 0.00447328964, 0.00136335283, 0.00018315639])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        times = case[\"times\"]\n        variances = case[\"variances\"]\n\n        # --- Strategy 1: Particle Monte Carlo (IEM-based) Calibration ---\n        # This method performs a linear least squares fit on the transformed data:\n        # ln(sigma^2(t)) = - (2/tau_m) * t + ln(sigma^2(0))\n        # The slope 'm' of this line is -2/tau_m.\n        \n        # Take the natural logarithm of the variance data.\n        # The problem states variances are strictly positive, so no check is needed.\n        log_variances = np.log(variances)\n        \n        # Use polyfit to find the slope (m) and intercept (c) of the best-fit line.\n        # We only need the slope.\n        slope, _ = np.polyfit(times, log_variances, 1)\n        \n        # Calculate tau_m_MC from the slope.\n        # tau_m = -2 / slope\n        tau_m_mc = -2.0 / slope\n        results.append(tau_m_mc)\n\n        # --- Strategy 2: Eulerian Stochastic Fields (ESF-based) Calibration ---\n        # This method minimizes the sum of squared errors between the DNS data\n        # and the model sigma^2(t) = sigma^2(0) * exp(-2*t/tau_m) using\n        # non-linear least squares.\n        \n        sigma_sq_0 = variances[0]\n\n        # Define the residual function for the non-linear optimizer.\n        # It calculates the difference between DNS data and the model prediction.\n        def residuals(tau_m_array, t, sigma_sq_dns):\n            tau_m = tau_m_array[0]\n            # Handle potential non-positive tau_m during optimization iterations.\n            if tau_m = 0:\n                return np.full_like(sigma_sq_dns, 1e10) # Return a large error\n            \n            model_prediction = sigma_sq_0 * np.exp(-2.0 * t / tau_m)\n            return sigma_sq_dns - model_prediction\n\n        # Use the result from the linear fit as a good initial guess.\n        initial_guess = [tau_m_mc]\n\n        # Perform the non-linear least squares optimization.\n        # bounds=(0, np.inf) ensures the physical constraint tau_m > 0\n        opt_result = least_squares(residuals, initial_guess, args=(times, variances), bounds=(0, np.inf))\n        \n        # The optimized value of tau_m is the solution.\n        tau_m_esf = opt_result.x[0]\n        results.append(tau_m_esf)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to six decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "基于粒子的蒙特卡洛方法功能强大，但其精度受统计收敛性支配。本练习  将我们的重点从物理模型转移到数值方法本身，解决“需要多少粒子才足够？”这一关键问题。通过应用中心极限定理，您将推导出一个基本公式，用以估算达到所需统计精度 $\\Delta$ 所需的最小粒子数 $N$，这是设计高效可靠模拟的一项至关重要的技能。",
            "id": "4068300",
            "problem": "在一个用于湍流反应流的输运概率密度函数 (PDF) 基于粒子的蒙特卡洛求解器中，考虑单个计算单元，其中标量可观测量 $Q$ (例如，温度或组分质量分数等热化学量) 的平均值由 $N$ 个统计独立的粒子样本估计得出。假设粒子样本是独立同分布的，具有有限方差 $\\sigma^{2}$，该方差通过先前的运行或理论考虑是先验已知的。您希望基于蒙特卡洛样本均值，为 $Q$ 的均值 $\\mu$ 构建一个置信水平为 $1-\\alpha$ 的双侧置信区间，并要求该区间的总宽度不大于规定的容差 $\\Delta$。\n\n从样本均值的定义和中心极限定理 (CLT) 的陈述出发，推导所需的最小粒子数 $N$ 的表达式，使得在高斯近似 (由CLT所蕴含) 和双侧置信水平 $1-\\alpha$ 的条件下，均值的置信区间总宽度为 $\\Delta$。用 $\\Delta$、$\\sigma^{2}$ 和双侧标准正态分位数 $z_{1-\\alpha/2}$ 来表示您的结果。\n\n然后，对于一个代表非预混湍流火焰模拟的案例，对这一要求进行数值评估。在该案例中，标量方差为 $\\sigma^{2} = 9.0 \\times 10^{4}$，期望的置信水平为 $1-\\alpha = 0.99$，规定的总区间宽度为 $\\Delta = 20$。在您的计算中使用双侧高斯分位数值 $z_{0.995} = 2.576$ (四位有效数字)，并报告在高斯近似下保证区间宽度要求的最小整数 $N$。",
            "solution": "设标量可观测量 $Q$ 的 $N$ 个粒子样本由独立同分布 (i.i.d.) 的随机变量 $Q_1, Q_2, \\dots, Q_N$ 表示。每个样本都从一个具有有限均值 $\\mu$ 和有限方差 $\\sigma^2$ 的分布中抽取。样本均值 $\\bar{Q}_N$ 是总体均值 $\\mu$ 的估计量，其定义为：\n$$ \\bar{Q}_N = \\frac{1}{N} \\sum_{i=1}^{N} Q_i $$\n样本均值的期望值为 $E[\\bar{Q}_N] = \\mu$，这使其成为一个无偏估计量。样本均值的方差由 $\\text{Var}(\\bar{Q}_N)$ 给出，对于独立同分布的样本，它简化为：\n$$ \\text{Var}(\\bar{Q}_N) = \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} Q_i\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\text{Var}(Q_i) = \\frac{N\\sigma^2}{N^2} = \\frac{\\sigma^2}{N} $$\n因此，样本均值的标准差，即标准误差，为 $\\sigma_{\\bar{Q}_N} = \\frac{\\sigma}{\\sqrt{N}}$。\n\n根据中心极限定理 (CLT)，对于足够大的样本数 $N$，样本均值 $\\bar{Q}_N$ 的概率分布接近于一个均值为 $\\mu$、方差为 $\\frac{\\sigma^2}{N}$ 的正态 (高斯) 分布。我们可以将其表示为 $\\bar{Q}_N \\approx \\mathcal{N}\\left(\\mu, \\frac{\\sigma^2}{N}\\right)$。\n\n为了构建置信区间，我们定义一个标准化变量 $Z$，根据中心极限定理，它服从标准正态分布 $\\mathcal{N}(0, 1)$：\n$$ Z = \\frac{\\bar{Q}_N - \\mu}{\\sigma / \\sqrt{N}} $$\n对于一个置信水平为 $1-\\alpha$ 的双侧置信区间，我们寻求 $\\mu$ 的一个范围，使得以下概率陈述成立：\n$$ P(-z_{1-\\alpha/2} \\le Z \\le z_{1-\\alpha/2}) = 1-\\alpha $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的上尾临界值，对应于累积概率 $1-\\frac{\\alpha}{2}$。\n\n将 $Z$ 的表达式代入不等式：\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\bar{Q}_N - \\mu}{\\sigma/\\sqrt{N}} \\le z_{1-\\alpha/2}\\right) = 1-\\alpha $$\n我们可以重新整理这个不等式以分离出未知均值 $\\mu$：\n$$ -z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\bar{Q}_N - \\mu \\le z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n$$ -\\bar{Q}_N - z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le -\\mu \\le -\\bar{Q}_N + z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n两边乘以 $-1$ 并反转不等号得到：\n$$ \\bar{Q}_N - z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\mu \\le \\bar{Q}_N + z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n这就定义了 $\\mu$ 的置信区间。该区间的总宽度 $W$ 是上界和下界之差：\n$$ W = \\left(\\bar{Q}_N + z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}}\\right) - \\left(\\bar{Q}_N - z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}}\\right) = 2 z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n问题要求这个宽度不大于规定的容差 $\\Delta$。因此，我们建立以下不等式：\n$$ 2 z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\Delta $$\n为了求得最小粒子数 $N$，我们解出 $N$：\n$$ \\frac{2 z_{1-\\alpha/2} \\sigma}{\\Delta} \\le \\sqrt{N} $$\n对两边（均为正数）取平方，不等式保持不变：\n$$ \\left(\\frac{2 z_{1-\\alpha/2} \\sigma}{\\Delta}\\right)^2 \\le N $$\n根据要求，这可以根据方差 $\\sigma^2$ 重写为：\n$$ N \\ge \\frac{4 z_{1-\\alpha/2}^2 \\sigma^2}{\\Delta^2} $$\n这就是推导出的所需最小粒子数 $N$ 的表达式。\n\n接下来，我们用给定的值对这个表达式进行数值计算：\n- 方差 $\\sigma^2 = 9.0 \\times 10^4$\n- 置信水平 $1-\\alpha = 0.99$，这意味着 $\\alpha = 0.01$ 和 $\\frac{\\alpha}{2} = 0.005$。\n- 标准正态分位数 $z_{1-\\alpha/2} = z_{1-0.005} = z_{0.995} = 2.576$。\n- 总区间宽度容差 $\\Delta = 20$。\n\n将这些值代入关于 $N$ 的不等式：\n$$ N \\ge \\frac{4 \\times (2.576)^2 \\times (9.0 \\times 10^4)}{(20)^2} $$\n$$ N \\ge \\frac{4 \\times (2.576)^2 \\times 90000}{400} $$\n$$ N \\ge (2.576)^2 \\times \\frac{90000}{100} $$\n$$ N \\ge (6.635776) \\times (900) $$\n$$ N \\ge 5972.1984 $$\n由于粒子数 $N$ 必须是整数，我们必须选择满足此条件的最小整数。因此，所需的最小粒子数为：\n$$ N_{\\text{min}} = \\lceil 5972.1984 \\rceil = 5973 $$",
            "answer": "$$\\boxed{5973}$$"
        }
    ]
}