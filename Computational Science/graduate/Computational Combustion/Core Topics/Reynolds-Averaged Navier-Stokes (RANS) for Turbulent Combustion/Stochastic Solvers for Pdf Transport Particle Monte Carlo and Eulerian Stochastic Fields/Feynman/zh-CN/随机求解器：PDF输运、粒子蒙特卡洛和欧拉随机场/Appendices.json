{
    "hands_on_practices": [
        {
            "introduction": "要真正理解随机求解器，必须将理论方程与可工作的实现联系起来。本练习探讨了在线性反应和IEM混合作用下标量场的前两个矩（均值和方差）的演化。通过推导这些矩的解析解，并将其与您将构建的简单数值模拟进行比较，您将验证对欧拉随机场（ESF）方法和代码验证基本原则的理解。",
            "id": "4068263",
            "problem": "考虑一个用于计算燃烧学的均匀反应器中的空间均匀一维标量，其中标量场由一组欧拉随机场 (Eulerian Stochastic Fields, ESF) 系综表示。标量浓度用 $\\,\\phi\\,$ 表示，是无量纲的。其演化由线性反应和小尺度混合驱动。线性反应由 $\\,d\\phi/dt=-\\lambda\\,\\phi\\,$ 给出，其中 $\\,\\lambda\\,$ 是一个常数反应速率，单位为 $\\,\\mathrm{s}^{-1}\\,$。混合由均值交换相互作用 (Interaction by Exchange with the Mean, IEM) 模型来模拟，该模型以恒定的混合频率 $\\,\\gamma\\,$（单位为 $\\,\\mathrm{s}^{-1}\\,$）将每个场弛豫到瞬时均值。设有 $\\,M\\,$ 个 ESF 场 $\\,\\{\\phi_k(t)\\}_{k=1}^M\\,$，其样本均值为 $\\,\\bar{\\phi}(t)=(1/M)\\sum_{k=1}^M \\phi_k(t)\\,$，样本方差为 $\\,\\mathcal{V}(t)=(1/M)\\sum_{k=1}^M \\left(\\phi_k(t)-\\bar{\\phi}(t)\\right)^2\\,$。每个场的 ESF 演化由以下常微分方程定义：\n$$\n\\frac{d\\phi_k}{dt} \\;=\\; -\\,\\lambda\\,\\phi_k \\;+\\; \\gamma\\,\\big(\\,\\bar{\\phi}\\;-\\;\\phi_k\\,\\big),\n$$\n其中 $\\,\\lambda \\ge 0\\,$ 和 $\\,\\gamma \\ge 0\\,$ 是常数，$\\,t\\,$ 是时间，单位为 $\\,\\mathrm{s}\\,$。\n\n您的任务：\n- 从场演化方程出发，推导系综均值 $\\,\\bar{\\phi}(t)\\,$ 和方差 $\\,\\mathcal{V}(t)\\,$ 的演化方程。仅使用基本运算，如微分和平均的线性性质，以及系综方差的定义。不要假定任何已知的封闭形式表达式；从第一性原理推导它们。\n- 求解推导出的均值和方差随时间的演化方程，以获得 $\\,\\bar{\\phi}(t)\\,$ 和 $\\,\\mathcal{V}(t)\\,$ 作为 $\\,\\bar{\\phi}(0)\\,$、$\\,\\mathcal{V}(0)\\,$、$\\,\\lambda\\,$、$\\,\\gamma\\,$ 和 $\\,t\\,$ 的函数的封闭形式解析表达式。\n- 使用显式欧拉时间积分方法实现一个 ESF 求解器，该方法使用均匀时间步长 $\\,\\Delta t\\,$ 来推进 $\\,M\\,$ 个场，计算在指定的最终时间 $\\,t_{\\mathrm{end}}\\,$ 的样本均值和方差，并将 ESF 计算出的均值和方差与您推导的解析表达式进行比较。报告在 $\\,t_{\\mathrm{end}}\\,$ 时刻数值解与解析解之间的最大绝对偏差。\n\n物理单位：$\\,\\lambda\\,$ 和 $\\,\\gamma\\,$ 的单位是 $\\,\\mathrm{s}^{-1}\\,$，$\\,t\\,$ 和 $\\,\\Delta t\\,$ 的单位是 $\\,\\mathrm{s}\\,$。标量 $\\,\\phi\\,$ 是无量纲的。最终输出是标量值的绝对误差，因此是无量纲的。如果存在角度，请以弧度表示。此问题不需要角度。\n\n数值方法要求：使用显式欧拉进行时间积分，即对于每个时间步更新：\n$$\n\\phi_k^{n+1} \\;=\\; \\phi_k^n \\;+\\; \\Delta t\\,\\Big(-\\lambda\\,\\phi_k^n + \\gamma\\,(\\bar{\\phi}^n - \\phi_k^n)\\Big),\n$$\n其中 $\\,\\bar{\\phi}^n\\,$ 是在时间步 $\\,n\\,$ 的样本均值。\n\n测试组：实现并运行以下五个测试用例。对于每个用例，明确给出了初始场值 $\\{\\phi_k(0)\\}$ 以及 $\\,\\lambda\\,$、$\\,\\gamma\\,$、$\\,t_{\\mathrm{end}}\\,$ 和 $\\,\\Delta t\\,$。对于每个用例，计算在 $\\,t_{\\mathrm{end}}\\,$ 时的 ESF 均值和方差，使用您推导的公式计算在 $\\,t_{\\mathrm{end}}\\,$ 时的解析均值和方差，并返回这两对值之间的最大绝对偏差。\n\n- 用例 $\\,1\\,$（仅反应）：$\\,\\lambda=\\,\\,$$1.0\\,\\mathrm{s}^{-1}$，$\\,\\gamma=\\,\\,$$0.0\\,\\mathrm{s}^{-1}$，$\\,t_{\\mathrm{end}}=\\,\\,$$1.0\\,\\mathrm{s}$，$\\,\\Delta t=\\,\\,$$1.0\\times 10^{-4}\\,\\mathrm{s}$，$\\,\\{\\phi_k(0)\\}=\\,$$[-1.0,\\,-0.5,\\,0.0,\\,0.5,\\,1.0]$。\n- 用例 $\\,2\\,$（仅混合）：$\\,\\lambda=\\,\\,$$0.0\\,\\mathrm{s}^{-1}$，$\\,\\gamma=\\,\\,$$3.0\\,\\mathrm{s}^{-1}$，$\\,t_{\\mathrm{end}}=\\,\\,$$0.5\\,\\mathrm{s}$，$\\,\\Delta t=\\,\\,$$1.0\\times 10^{-4}\\,\\mathrm{s}$，$\\,\\{\\phi_k(0)\\}=\\,$$[1.0,\\,2.0,\\,3.0,\\,4.0]$。\n- 用例 $\\,3\\,$（反应与混合）：$\\,\\lambda=\\,\\,$$0.7\\,\\mathrm{s}^{-1}$，$\\,\\gamma=\\,\\,$$1.3\\,\\mathrm{s}^{-1}$，$\\,t_{\\mathrm{end}}=\\,\\,$$0.8\\,\\mathrm{s}$，$\\,\\Delta t=\\,\\,$$1.0\\times 10^{-4}\\,\\mathrm{s}$，$\\,\\{\\phi_k(0)\\}=\\,$$[0.2,\\,1.1,\\,-0.4,\\,2.0,\\,-1.2,\\,0.0]$。\n- 用例 $\\,4\\,$（单一场的边界情况）：$\\,\\lambda=\\,\\,$$2.0\\,\\mathrm{s}^{-1}$，$\\,\\gamma=\\,\\,$$10.0\\,\\mathrm{s}^{-1}$，$\\,t_{\\mathrm{end}}=\\,\\,$$0.3\\,\\mathrm{s}$，$\\,\\Delta t=\\,\\,$$1.0\\times 10^{-4}\\,\\mathrm{s}$，$\\,\\{\\phi_k(0)\\}=\\,$$[3.0]$。\n- 用例 $\\,5\\,$（零时间边界）：$\\,\\lambda=\\,\\,$$0.3\\,\\mathrm{s}^{-1}$，$\\,\\gamma=\\,\\,$$0.9\\,\\mathrm{s}^{-1}$，$\\,t_{\\mathrm{end}}=\\,\\,$$0.0\\,\\mathrm{s}$，$\\,\\Delta t=\\,\\,$$1.0\\times 10^{-3}\\,\\mathrm{s}$，$\\,\\{\\phi_k(0)\\}=\\,$$[0.7,\\,-0.2,\\,0.5]$。\n\n最终输出格式：您的程序应生成一行输出，其中包含五个最大绝对偏差（每个测试用例一个），形式为逗号分隔的列表并用方括号括起来，例如 $\\,\\,[e_1,e_2,e_3,e_4,e_5]\\,\\,$, 其中每个 $\\,e_i\\,$ 是一个浮点数（无量纲）。",
            "solution": "该问题要求推导欧拉随机场 (ESF) 系综的均值和方差的解析解，并与数值解进行比较。每个场 $\\phi_k$ 的演化由一个模拟反应和混合的线性常微分方程 (ODE) 控制。\n\n首先，我们推导系综均值 $\\bar{\\phi}(t)$ 的演化方程。均值定义为：\n$$\n\\bar{\\phi}(t) = \\frac{1}{M} \\sum_{k=1}^{M} \\phi_k(t)\n$$\n其中 $M$ 是随机场的数量。我们将 $\\bar{\\phi}(t)$ 对时间 $t$ 求导。由于微分和求和的线性性质，我们可以交换这些运算的顺序：\n$$\n\\frac{d\\bar{\\phi}}{dt} = \\frac{d}{dt} \\left( \\frac{1}{M} \\sum_{k=1}^{M} \\phi_k \\right) = \\frac{1}{M} \\sum_{k=1}^{M} \\frac{d\\phi_k}{dt}\n$$\n现在，我们代入给定的每个场的演化方程 $\\frac{d\\phi_k}{dt} = -\\lambda\\phi_k + \\gamma(\\bar{\\phi}-\\phi_k)$：\n$$\n\\frac{d\\bar{\\phi}}{dt} = \\frac{1}{M} \\sum_{k=1}^{M} \\left[ -\\lambda\\phi_k + \\gamma(\\bar{\\phi}-\\phi_k) \\right]\n$$\n我们可以拆分求和：\n$$\n\\frac{d\\bar{\\phi}}{dt} = \\frac{1}{M} \\sum_{k=1}^{M} (-\\lambda\\phi_k) + \\frac{1}{M} \\sum_{k=1}^{M} \\gamma(\\bar{\\phi}-\\phi_k)\n$$\n利用求和算子的线性性质并提出常数：\n$$\n\\frac{d\\bar{\\phi}}{dt} = -\\lambda \\left( \\frac{1}{M} \\sum_{k=1}^{M} \\phi_k \\right) + \\gamma \\left( \\frac{1}{M} \\sum_{k=1}^{M} (\\bar{\\phi}-\\phi_k) \\right)\n$$\n第一项包含了均值的定义，$\\bar{\\phi} = \\frac{1}{M}\\sum\\phi_k$。第二项简化为零：\n$$\n\\frac{1}{M} \\sum_{k=1}^{M} (\\bar{\\phi}-\\phi_k) = \\frac{1}{M} \\left( \\sum_{k=1}^{M} \\bar{\\phi} - \\sum_{k=1}^{M} \\phi_k \\right) = \\frac{1}{M} (M\\bar{\\phi} - M\\bar{\\phi}) = 0\n$$\n因此，均值的演化方程为：\n$$\n\\frac{d\\bar{\\phi}}{dt} = -\\lambda\\bar{\\phi}\n$$\n这是一个一阶线性齐次常微分方程。对于初始条件 $\\bar{\\phi}(0)$，通过分离变量法得到的解为：\n$$\n\\bar{\\phi}(t) = \\bar{\\phi}(0) e^{-\\lambda t}\n$$\n\n接下来，我们推导系综方差 $\\mathcal{V}(t)$ 的演化方程。方差定义为：\n$$\n\\mathcal{V}(t) = \\frac{1}{M} \\sum_{k=1}^{M} (\\phi_k(t) - \\bar{\\phi}(t))^2\n$$\n对时间 $t$ 求导并应用链式法则：\n$$\n\\frac{d\\mathcal{V}}{dt} = \\frac{d}{dt} \\left( \\frac{1}{M} \\sum_{k=1}^{M} (\\phi_k - \\bar{\\phi})^2 \\right) = \\frac{1}{M} \\sum_{k=1}^{M} 2(\\phi_k - \\bar{\\phi}) \\frac{d}{dt}(\\phi_k - \\bar{\\phi})\n$$\n导数项为 $\\frac{d}{dt}(\\phi_k - \\bar{\\phi}) = \\frac{d\\phi_k}{dt} - \\frac{d\\bar{\\phi}}{dt}$。我们代入 $\\frac{d\\phi_k}{dt}$ 的表达式和刚刚推导出的 $\\frac{d\\bar{\\phi}}{dt}$：\n$$\n\\frac{d}{dt}(\\phi_k - \\bar{\\phi}) = \\left[ -\\lambda\\phi_k + \\gamma(\\bar{\\phi}-\\phi_k) \\right] - \\left[ -\\lambda\\bar{\\phi} \\right]\n$$\n整理各项：\n$$\n\\frac{d}{dt}(\\phi_k - \\bar{\\phi}) = -\\lambda\\phi_k + \\gamma\\bar{\\phi} - \\gamma\\phi_k + \\lambda\\bar{\\phi} = -\\lambda(\\phi_k-\\bar{\\phi}) - \\gamma(\\phi_k-\\bar{\\phi}) = -(\\lambda+\\gamma)(\\phi_k-\\bar{\\phi})\n$$\n现在，将此结果代回 $\\frac{d\\mathcal{V}}{dt}$ 的方程中：\n$$\n\\frac{d\\mathcal{V}}{dt} = \\frac{1}{M} \\sum_{k=1}^{M} 2(\\phi_k - \\bar{\\phi}) \\left[ -(\\lambda+\\gamma)(\\phi_k-\\bar{\\phi}) \\right]\n$$\n简化表达式并将常数提出求和符号：\n$$\n\\frac{d\\mathcal{V}}{dt} = -2(\\lambda+\\gamma) \\left( \\frac{1}{M} \\sum_{k=1}^{M} (\\phi_k - \\bar{\\phi})^2 \\right)\n$$\n括号中的项是方差的定义，$\\mathcal{V}$。因此，方差的演化方程为：\n$$\n\\frac{d\\mathcal{V}}{dt} = -2(\\lambda+\\gamma)\\mathcal{V}\n$$\n这是另一个一阶线性齐次常微分方程。给定初始方差 $\\mathcal{V}(0)$，其解为：\n$$\n\\mathcal{V}(t) = \\mathcal{V}(0) e^{-2(\\lambda+\\gamma)t}\n$$\n\n为解决该问题，我们将实现一个 Python 脚本。该脚本将对每个测试用例执行两次计算。首先，它将使用推导出的公式 $\\bar{\\phi}(t) = \\bar{\\phi}(0) e^{-\\lambda t}$ 和 $\\mathcal{V}(t) = \\mathcal{V}(0) e^{-2(\\lambda+\\gamma)t}$ 计算在时间 $t_{\\mathrm{end}}$ 时的解析均值和方差，其中 $\\bar{\\phi}(0)$ 和 $\\mathcal{V}(0)$ 从给定的初始场 $\\{\\phi_k(0)\\}$ 计算得出。其次，它将使用显式欧拉方法和给定的时间步长 $\\Delta t$ 对 $M$ 个随机场进行从 $t=0$ 到 $t=t_{\\mathrm{end}}$ 的数值时间积分。每个时间步 $n$ 处每个场的数值更新规则是：\n$$\n\\phi_k^{n+1} = \\phi_k^n + \\Delta t\\,\\Big(-\\lambda\\,\\phi_k^n + \\gamma\\,(\\bar{\\phi}^n - \\phi_k^n)\\Big)\n$$\n其中 $\\bar{\\phi}^n$ 是在时间步 $n$ 时的场的样本均值。积分结束后，从最终场值 $\\{\\phi_k(t_{\\mathrm{end}})\\}$ 计算数值样本均值和方差。最后，计算均值和方差的解析解与数值解之间的最大绝对偏差，即 $\\max(|\\bar{\\phi}_{\\text{numerical}} - \\bar{\\phi}_{\\text{analytical}}|, |\\mathcal{V}_{\\text{numerical}} - \\mathcal{V}_{\\text{analytical}}|)$。对所有五个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ESF problem for five test cases, comparing numerical and analytical solutions.\n    \"\"\"\n    test_cases = [\n        {\n            \"lambda_val\": 1.0,\n            \"gamma_val\": 0.0,\n            \"t_end\": 1.0,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [-1.0, -0.5, 0.0, 0.5, 1.0],\n        },\n        {\n            \"lambda_val\": 0.0,\n            \"gamma_val\": 3.0,\n            \"t_end\": 0.5,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [1.0, 2.0, 3.0, 4.0],\n        },\n        {\n            \"lambda_val\": 0.7,\n            \"gamma_val\": 1.3,\n            \"t_end\": 0.8,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [0.2, 1.1, -0.4, 2.0, -1.2, 0.0],\n        },\n        {\n            \"lambda_val\": 2.0,\n            \"gamma_val\": 10.0,\n            \"t_end\": 0.3,\n            \"dt\": 1.0e-4,\n            \"phi_initial\": [3.0],\n        },\n        {\n            \"lambda_val\": 0.3,\n            \"gamma_val\": 0.9,\n            \"t_end\": 0.0,\n            \"dt\": 1.0e-3,\n            \"phi_initial\": [0.7, -0.2, 0.5],\n        },\n    ]\n\n    max_deviations = []\n\n    for case in test_cases:\n        lambda_val = case[\"lambda_val\"]\n        gamma_val = case[\"gamma_val\"]\n        t_end = case[\"t_end\"]\n        dt = case[\"dt\"]\n        phi_initial = np.array(case[\"phi_initial\"], dtype=np.float64)\n\n        # --- Analytical Solution ---\n        mean_initial = np.mean(phi_initial)\n        var_initial = np.var(phi_initial)  # ddof=0 is default, matches problem definition\n\n        mean_analytical = mean_initial * np.exp(-lambda_val * t_end)\n        var_analytical = var_initial * np.exp(-2 * (lambda_val + gamma_val) * t_end)\n\n        # --- Numerical Solution (Explicit Euler) ---\n        phi_current = phi_initial.copy()\n        \n        # Using np.round to handle potential floating-point inaccuracies in division\n        num_steps = int(np.round(t_end / dt))\n\n        for _ in range(num_steps):\n            mean_current = np.mean(phi_current)\n            # Vectorized Euler step for all fields\n            rhs = -lambda_val * phi_current + gamma_val * (mean_current - phi_current)\n            phi_current += dt * rhs\n\n        mean_numerical = np.mean(phi_current)\n        var_numerical = np.var(phi_current)\n\n        # --- Comparison ---\n        error_mean = np.abs(mean_numerical - mean_analytical)\n        error_var = np.abs(var_numerical - var_analytical)\n        \n        max_deviation = np.max([error_mean, error_var])\n        max_deviations.append(max_deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{d:.12e}' for d in max_deviations])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然矩方程描述了标量的整体行为，但概率密度函数（PDF）提供了完整的统计描述。本练习重点关注平均相互作用（IEM）模型，这是微观混合封闭模型的基石。您将解析求解一个简单的双峰PDF的演化，从而直观地了解IEM模型如何驱动标量值趋向其平均值，导致方差衰减并最终形成均匀混合物。",
            "id": "4068250",
            "problem": "考虑在一个无源、无汇、无平均流梯度的统计平稳、空间均匀的反应器中，一个守恒混合分数 $Z$ 的均匀湍流混合。在初始时刻 $t=0$，$Z$ 的概率密度函数 (PDF) 是双峰的，由两个狄拉克δ分布的凸组合构成，\n$$\nP(Z,0) \\;=\\; w_1\\,\\delta\\!\\left(Z - z_1\\right) \\;+\\; w_2\\,\\delta\\!\\left(Z - z_2\\right),\n$$\n其中 $w_1>0$，$w_2>0$，$w_1+w_2=1$，且 $z_1 \\neq z_2$。混合过程使用平均交换相互作用 (IEM) 模型进行建模，其对任何实现 $Z(t)$ 的微观混合定律为\n$$\n\\frac{dZ}{dt} \\;=\\; -\\,\\frac{1}{\\tau_m}\\,\\bigl(Z(t) - \\widetilde{Z}(t)\\bigr),\n$$\n其中 $\\tau_m>0$ 是一个恒定的微观混合时间尺度，而 $\\widetilde{Z}(t)$ 是 $Z$ 在时间 $t$ 的系综平均值。假设平均值 $\\widetilde{Z}(t)$ 是根据演化的PDF自洽地确定的，并且系统是封闭且均匀的，因此守恒定律适用。\n\n从均匀IEM混合下守恒标量的平均值基本守恒和在漂移 $\\dot{Z} = -(Z - \\widetilde{Z})/\\tau_m$ 下PDF的确定性刘维尔输运出发，推导当 $t>0$ 时PDF $P(Z,t)$ 的时间演化，并明确展示两个δ峰如何随时间移动。然后，定义双峰指数\n$$\nB(t) \\;=\\; \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|},\n$$\n其中 $z_1(t)$ 和 $z_2(t)$ 表示在时间 $t$ 的瞬时峰值位置，并以闭合形式计算 $B(t)$。\n\n请以 $B(t)$ 的单个闭合形式符号表达式提供您的最终答案。无需四舍五入。双峰指数 $B(t)$ 是无量纲的；不要在最终答案中包含单位。",
            "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n**步骤1：提取已知条件**\n- 混合分数 $Z$ 的初始概率密度函数 (PDF)：$P(Z,0) = w_1\\,\\delta(Z - z_1) + w_2\\,\\delta(Z - z_2)$。\n- 权重条件：$w_1 > 0$，$w_2 > 0$，$w_1+w_2=1$。\n- 初始峰值位置：$z_1 \\neq z_2$。\n- 混合模型：平均交换相互作用 (IEM)。\n- IEM定律：$\\frac{dZ}{dt} = -\\frac{1}{\\tau_m}(Z(t) - \\widetilde{Z}(t))$。\n- 微观混合时间尺度：$\\tau_m>0$ 是一个常数。\n- 系综平均：$\\widetilde{Z}(t) = \\int_{-\\infty}^{\\infty} \\xi P(\\xi, t) d\\xi$。\n- 系统属性：均匀、统计平稳、封闭、无源或汇，$Z$ 是一个守恒标量。\n- 双峰指数定义：$B(t) = \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|}$，其中 $z_1(t)$ 和 $z_2(t)$ 是在时间 $t$ 的峰值位置。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了湍流中标量混合的标准模型 (IEM)，这是计算燃烧学的核心课题。该问题是适定的，为PDF的演化提供了一个明确的初值问题。语言客观，并使用了标准术语。关于 $Z$ 是一个在封闭、均匀系统中的守恒标量的陈述意味着其平均值 $\\widetilde{Z}(t)$ 必须是恒定的。这可以通过对平均值的定义求时间导数，并使用PDF的刘维尔输运方程 $\\frac{\\partial P}{\\partial t} + \\frac{\\partial}{\\partial Z}(\\dot{Z}P)=0$ 来验证，其中 $\\dot{Z}$ 是IEM混合定律。这导致 $\\frac{d\\widetilde{Z}}{dt} = \\int \\dot{Z}P\\,dZ = \\int -\\frac{1}{\\tau_m}(Z - \\widetilde{Z})P\\,dZ = -\\frac{1}{\\tau_m}(\\widetilde{Z} - \\widetilde{Z}) = 0$。因此，$\\widetilde{Z}(t)$ 确实是恒定的。问题是自洽的，并包含所有必要信息。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供解答。\n\n该问题要求推导PDF $P(Z,t)$ 的时间演化和双峰指数 $B(t)$。\n\n首先，我们确定恒定的系综平均值 $\\widetilde{Z}$。由于 $\\widetilde{Z}(t)$ 对于所有 $t \\ge 0$ 都是恒定的，我们可以使用给定的初始PDF $P(Z,0)$ 在 $t=0$ 时计算它。\n$$\n\\widetilde{Z} = \\widetilde{Z}(0) = \\int_{-\\infty}^{\\infty} Z \\, P(Z,0) \\, dZ\n$$\n代入 $P(Z,0)$ 的表达式：\n$$\n\\widetilde{Z} = \\int_{-\\infty}^{\\infty} Z \\, \\left[ w_1\\,\\delta(Z - z_1) + w_2\\,\\delta(Z - z_2) \\right] \\, dZ\n$$\n使用狄拉克δ分布的筛选性质 $\\int f(x)\\delta(x-a)dx = f(a)$，我们得到：\n$$\n\\widetilde{Z} = w_1 z_1 + w_2 z_2\n$$\n这是混合分数在所有时间 $t \\ge 0$ 的恒定平均值。\n\n接下来，我们分析由IEM模型控制的任何单个实现 $Z(t)$ 的演化。IEM定律是一个一阶线性常微分方程 (ODE)：\n$$\n\\frac{dZ}{dt} = -\\frac{1}{\\tau_m}\\left(Z(t) - \\widetilde{Z}\\right)\n$$\n该方程可通过分离变量法求解，或将其识别为标准线性ODE形式。令 $Y(t) = Z(t) - \\widetilde{Z}$。那么 $\\frac{dY}{dt} = \\frac{dZ}{dt}$。ODE变为：\n$$\n\\frac{dY}{dt} = -\\frac{1}{\\tau_m}Y(t)\n$$\n这个齐次ODE的解是 $Y(t) = Y(0)\\,\\exp(-t/\\tau_m)$。代回$Z(t)$：\n$$\nZ(t) - \\widetilde{Z} = \\left(Z(0) - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n这可以重新排列，得到标量空间中任意点$Z(0)$的轨迹：\n$$\nZ(t) = \\widetilde{Z} + \\left(Z(0) - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n该方程描述了从 $t=0$ 时的标量值到时间 $t$ 的标量值的确定性映射。\n\n在这种确定性映射下，PDF $P(Z,t)$ 的演化是通过沿这些轨迹输运初始PDF来找到的。初始PDF由位于 $Z=z_1$ 和 $Z=z_2$ 的两个狄拉克δ分布组成。每个δ函数将根据上面推导的轨迹方程移动。\n\n设 $z_1(t)$ 是最初位于 $z_1 \\equiv z_1(0)$ 的峰的位置。使用轨迹方程，并令 $Z(0)=z_1$：\n$$\nz_1(t) = \\widetilde{Z} + \\left(z_1 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n类似地，对于最初位于 $z_2 \\equiv z_2(0)$ 的峰，其位置 $z_2(t)$ 由下式给出：\n$$\nz_2(t) = \\widetilde{Z} + \\left(z_2 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n由于权重 $w_1$ 和 $w_2$ 代表守恒的概率（或δ分布的质量分数），它们保持不变。因此，在任何时间 $t>0$ 的PDF由两个被输运的δ分布之和给出：\n$$\nP(Z,t) = w_1\\,\\delta(Z - z_1(t)) + w_2\\,\\delta(Z - z_2(t))\n$$\n这明确地显示了两个δ峰如何随时间移动，以指数形式向平均值 $\\widetilde{Z}$ 弛豫。\n\n现在，我们计算双峰指数 $B(t)$，其定义为：\n$$\nB(t) = \\frac{|z_2(t) - z_1(t)|}{|z_2(0) - z_1(0)|}\n$$\n分母就是 $|z_2 - z_1|$。对于分子，我们计算差值 $z_2(t) - z_1(t)$：\n$$\nz_2(t) - z_1(t) = \\left[ \\widetilde{Z} + \\left(z_2 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\right] - \\left[ \\widetilde{Z} + \\left(z_1 - \\widetilde{Z}\\right) \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\right]\n$$\n$$\nz_2(t) - z_1(t) = \\left[ (z_2 - \\widetilde{Z}) - (z_1 - \\widetilde{Z}) \\right] \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n$$\nz_2(t) - z_1(t) = (z_2 - z_1) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n取这个差的绝对值：\n$$\n|z_2(t) - z_1(t)| = \\left|(z_2 - z_1) \\exp\\left(-\\frac{t}{\\tau_m}\\right)\\right|\n$$\n由于 $t \\ge 0$ 且 $\\tau_m > 0$，指数项 $\\exp(-t/\\tau_m)$ 总是非负的。因此：\n$$\n|z_2(t) - z_1(t)| = |z_2 - z_1| \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n最后，我们将此结果代入 $B(t)$ 的定义中：\n$$\nB(t) = \\frac{|z_2 - z_1| \\exp\\left(-\\frac{t}{\\tau_m}\\right)}{|z_2 - z_1|}\n$$\n鉴于 $z_1 \\neq z_2$，项 $|z_2 - z_1|$ 非零，可以从分子和分母中约去。这就得出了双峰指数的闭合形式表达式：\n$$\nB(t) = \\exp\\left(-\\frac{t}{\\tau_m}\\right)\n$$\n这个结果表明，PDF的两个模态之间的距离以等于微观混合时间尺度 $\\tau_m$ 的特征时间呈指数衰减，这是IEM模型的预期物理行为。",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{t}{\\tau_m}\\right)}$$"
        },
        {
            "introduction": "基于粒子的蒙特卡洛方法功能强大，但本质上具有噪声。一个关键问题始终是：“需要多少粒子才足够？”本练习将统计学中的基本结果——中心极限定理——应用于从有限数量的粒子样本中估计可观测量均值的问题。通过完成此练习，您将学会如何确定达到所需统计精度所需的最小粒子数，这是设计和解释湍流燃烧中蒙特卡洛模拟的一项关键技能。",
            "id": "4068300",
            "problem": "在一个用于湍流反应流的输运概率密度函数 (PDF) 基粒子蒙特卡洛求解器中，考虑一个计算单元，其中标量可观测量 $Q$（例如，温度或组分质量分数等热化学量）的均值是通过 $N$ 个统计独立的粒子样本来估计的。假设粒子样本是独立同分布的，具有有限方差 $\\sigma^{2}$，该方差从先前的运行或理论考虑中先验已知。您希望基于蒙特卡洛样本均值，为 $Q$ 的均值 $\\mu$ 构建一个置信水平为 $1-\\alpha$ 的双侧置信区间，并且要求该区间的总宽度不大于预设的容差 $\\Delta$。\n\n从样本均值的定义和中心极限定理 (CLT) 的陈述出发，推导所需的最小粒子数 $N$ 的表达式，使得在 CLT 所蕴含的高斯近似下，对于双侧置信水平 $1-\\alpha$，均值的置信区间总宽度为 $\\Delta$。用 $\\Delta$、$\\sigma^{2}$ 和双侧标准正态分位数 $z_{1-\\alpha/2}$ 来表示您的结果。\n\n然后，在一个代表非预混湍流火焰模拟的案例中，对这一要求进行数值评估，其中标量方差为 $\\sigma^{2} = 9.0 \\times 10^{4}$，期望的置信水平为 $1-\\alpha = 0.99$，预设的区间总宽度为 $\\Delta = 20$。使用双侧高斯分位数值 $z_{0.995} = 2.576$（四位有效数字）进行计算，并报告在高斯近似下保证区间宽度要求的最小整数 $N$。",
            "solution": "设标量可观测量 $Q$ 的 $N$ 个粒子样本由独立同分布 (i.i.d.) 的随机变量 $Q_1, Q_2, \\dots, Q_N$ 表示。每个样本都从具有有限均值 $\\mu$ 和有限方差 $\\sigma^2$ 的分布中抽取。样本均值 $\\bar{Q}_N$ 是总体均值 $\\mu$ 的估计量，定义为：\n$$ \\bar{Q}_N = \\frac{1}{N} \\sum_{i=1}^{N} Q_i $$\n样本均值的期望值为 $E[\\bar{Q}_N] = \\mu$，使其成为一个无偏估计量。样本均值的方差由 $\\text{Var}(\\bar{Q}_N)$ 给出，对于独立同分布的样本，其简化为：\n$$ \\text{Var}(\\bar{Q}_N) = \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} Q_i\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\text{Var}(Q_i) = \\frac{N\\sigma^2}{N^2} = \\frac{\\sigma^2}{N} $$\n因此，样本均值的标准差，即标准误，为 $\\sigma_{\\bar{Q}_N} = \\frac{\\sigma}{\\sqrt{N}}$。\n\n根据中心极限定理 (CLT)，对于足够大的样本数量 $N$，样本均值 $\\bar{Q}_N$ 的概率分布近似于一个均值为 $\\mu$、方差为 $\\frac{\\sigma^2}{N}$ 的正态（高斯）分布。我们可以将其表示为 $\\bar{Q}_N \\approx \\mathcal{N}\\left(\\mu, \\frac{\\sigma^2}{N}\\right)$。\n\n为了构建置信区间，我们定义一个标准化变量 $Z$，根据中心极限定理，该变量服从标准正态分布 $\\mathcal{N}(0, 1)$：\n$$ Z = \\frac{\\bar{Q}_N - \\mu}{\\sigma / \\sqrt{N}} $$\n对于一个置信水平为 $1-\\alpha$ 的双侧置信区间，我们寻找 $\\mu$ 的一个范围，使得以下概率陈述成立：\n$$ P(-z_{1-\\alpha/2} \\le Z \\le z_{1-\\alpha/2}) = 1-\\alpha $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的上尾临界值，对应于累积概率 $1-\\frac{\\alpha}{2}$。\n\n将 $Z$ 的表达式代入不等式：\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\bar{Q}_N - \\mu}{\\sigma/\\sqrt{N}} \\le z_{1-\\alpha/2}\\right) = 1-\\alpha $$\n我们可以重新整理这个不等式以分离出未知均值 $\\mu$：\n$$ -z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\bar{Q}_N - \\mu \\le z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n$$ -\\bar{Q}_N - z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le -\\mu \\le -\\bar{Q}_N + z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n两边乘以 $-1$ 并反转不等号，得到：\n$$ \\bar{Q}_N - z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\mu \\le \\bar{Q}_N + z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n这就定义了 $\\mu$ 的置信区间。该区间的总宽度 $W$ 是上界和下界之差：\n$$ W = \\left(\\bar{Q}_N + z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}}\\right) - \\left(\\bar{Q}_N - z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}}\\right) = 2 z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n问题要求这个宽度不大于一个预设的容差 $\\Delta$。因此，我们建立以下不等式：\n$$ 2 z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\Delta $$\n为了找到最小粒子数 $N$，我们求解 $N$：\n$$ \\frac{2 z_{1-\\alpha/2} \\sigma}{\\Delta} \\le \\sqrt{N} $$\n对两边（均为正数）进行平方，不等式得以保持：\n$$ \\left(\\frac{2 z_{1-\\alpha/2} \\sigma}{\\Delta}\\right)^2 \\le N $$\n根据要求，这可以改写为用方差 $\\sigma^2$ 表示的形式：\n$$ N \\ge \\frac{4 z_{1-\\alpha/2}^2 \\sigma^2}{\\Delta^2} $$\n这就是推导出的所需最小粒子数 $N$ 的表达式。\n\n接下来，我们用给定的数值对这个表达式进行数值计算：\n- 方差 $\\sigma^2 = 9.0 \\times 10^4$\n- 置信水平 $1-\\alpha = 0.99$，这意味着 $\\alpha = 0.01$ 且 $\\frac{\\alpha}{2} = 0.005$。\n- 标准正态分位数 $z_{1-\\alpha/2} = z_{1-0.005} = z_{0.995} = 2.576$。\n- 区间总宽度容差 $\\Delta = 20$。\n\n将这些值代入关于 $N$ 的不等式中：\n$$ N \\ge \\frac{4 \\times (2.576)^2 \\times (9.0 \\times 10^4)}{(20)^2} $$\n$$ N \\ge \\frac{4 \\times (2.576)^2 \\times 90000}{400} $$\n$$ N \\ge (2.576)^2 \\times \\frac{90000}{100} $$\n$$ N \\ge (6.635776) \\times (900) $$\n$$ N \\ge 5972.1984 $$\n由于粒子数 $N$ 必须是整数，我们必须选择满足此条件的最小整数。因此，所需的最小粒子数为：\n$$ N_{\\text{min}} = \\lceil 5972.1984 \\rceil = 5973 $$",
            "answer": "$$\\boxed{5973}$$"
        }
    ]
}