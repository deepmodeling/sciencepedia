{
    "hands_on_practices": [
        {
            "introduction": "In reacting flows with significant heat release, like flames, density can vary dramatically. This poses a challenge for conventional statistical analysis and motivates the use of Favre (mass-weighted) averaging over Reynolds (volume-weighted) averaging. This practice  provides a concrete, quantitative look at the bias introduced by using the wrong averaging framework in a simplified two-state model of a premixed flame, highlighting why the Favre PDF is essential for accuracy in compressible combustion.",
            "id": "4073892",
            "problem": "Consider a statistically homogeneous premixed flame modeled as a two-state mixture with distinct densities, representative of reactants and products. The scalar of interest is a progress variable $\\phi$ that takes the value $\\phi_{1}=1$ in the product state and $\\phi_{2}=0$ in the reactant state. The two states occur with volume-weighted probabilities $p$ and $1-p$, respectively. The densities of the product and reactant states are $\\rho_{1}$ and $\\rho_{2}$, respectively. The mixture is assumed stationary and the only transport of $\\phi$ arises through convection; diffusion and reaction may be neglected for the purpose of evaluating the mean transport.\n\nIn the transported Probability Density Function (PDF) framework for reacting scalars in compressible flows, it is fundamental to distinguish the Reynolds PDF $P(\\phi)$ (volume-weighted) from the Favre PDF $\\tilde{P}(\\phi)$ (mass-weighted), with the defining relation $\\tilde{P}(\\phi)=\\rho(\\phi)P(\\phi)/\\bar{\\rho}$, where $\\bar{\\rho}$ is the Reynolds mean density. The Reynolds mean of the scalar is $\\overline{\\phi}=\\int \\phi\\,P(\\phi)\\,\\mathrm{d}\\phi$ and the Favre mean is $\\tilde{\\phi}=\\int \\phi\\,\\tilde{P}(\\phi)\\,\\mathrm{d}\\phi$.\n\nUsing only these foundational definitions, derive an expression for the bias error in the mean scalar transport that is incurred when the Reynolds PDF $P$ is used in place of the Favre PDF $\\tilde{P}$, quantified as the difference $E=\\overline{\\phi}-\\tilde{\\phi}$ for the two-state mixture. Then, evaluate $E$ for the following scientifically plausible premixed-flame parameters:\n- $p=0.40$,\n- $\\rho_{1}=0.30\\,\\mathrm{kg\\,m^{-3}}$,\n- $\\rho_{2}=1.20\\,\\mathrm{kg\\,m^{-3}}$.\n\nProvide your final answer as an exact fraction. The error $E$ is dimensionless; no units are required.",
            "solution": "The appropriate fundamental base is the distinction between Reynolds averaging (volume-weighted) and Favre averaging (mass-weighted) in compressible turbulent combustion, and the associated Probability Density Function (PDF) representations. For a scalar $\\phi$ with Reynolds PDF $P(\\phi)$, the Reynolds mean is defined as\n$$\n\\overline{\\phi}=\\int_{-\\infty}^{\\infty} \\phi\\,P(\\phi)\\,\\mathrm{d}\\phi,\n$$\nwhile the Favre mean is defined via the Favre PDF $\\tilde{P}(\\phi)$ as\n$$\n\\tilde{\\phi}=\\int_{-\\infty}^{\\infty} \\phi\\,\\tilde{P}(\\phi)\\,\\mathrm{d}\\phi.\n$$\nIn compressible flows, the Favre PDF is related to the Reynolds PDF through the mass-weighting relation\n$$\n\\tilde{P}(\\phi)=\\frac{\\rho(\\phi)}{\\bar{\\rho}}\\,P(\\phi),\n$$\nwhere $\\rho(\\phi)$ is the density associated with the state at $\\phi$, and $\\bar{\\rho}$ is the Reynolds mean density,\n$$\n\\bar{\\rho}=\\int_{-\\infty}^{\\infty} \\rho(\\phi)\\,P(\\phi)\\,\\mathrm{d}\\phi.\n$$\n\nWe model the premixed flame as a two-state mixture. The scalar takes two discrete values: $\\phi_{1}=1$ in the product state with density $\\rho_{1}$ and $\\phi_{2}=0$ in the reactant state with density $\\rho_{2}$. The Reynolds PDF is therefore\n$$\nP(\\phi)=p\\,\\delta(\\phi-\\phi_{1})+(1-p)\\,\\delta(\\phi-\\phi_{2}),\n$$\nwith $p$ the volume fraction of the product state and $1-p$ that of the reactant state. Using this discrete PDF, the Reynolds mean of $\\phi$ is\n$$\n\\overline{\\phi}=\\int \\phi\\,P(\\phi)\\,\\mathrm{d}\\phi=p\\,\\phi_{1}+(1-p)\\,\\phi_{2}.\n$$\nWith $\\phi_{1}=1$ and $\\phi_{2}=0$, this reduces to\n$$\n\\overline{\\phi}=p.\n$$\n\nThe Reynolds mean density is\n$$\n\\bar{\\rho}=\\int \\rho(\\phi)\\,P(\\phi)\\,\\mathrm{d}\\phi=p\\,\\rho_{1}+(1-p)\\,\\rho_{2}.\n$$\nThe Favre PDF for the two-state mixture is\n$$\n\\tilde{P}(\\phi)=\\frac{\\rho(\\phi)}{\\bar{\\rho}}\\,P(\\phi)=\\frac{p\\,\\rho_{1}}{\\bar{\\rho}}\\,\\delta(\\phi-\\phi_{1})+\\frac{(1-p)\\,\\rho_{2}}{\\bar{\\rho}}\\,\\delta(\\phi-\\phi_{2}).\n$$\nTherefore, the Favre mean is\n$$\n\\tilde{\\phi}=\\int \\phi\\,\\tilde{P}(\\phi)\\,\\mathrm{d}\\phi=\\frac{p\\,\\rho_{1}}{\\bar{\\rho}}\\,\\phi_{1}+\\frac{(1-p)\\,\\rho_{2}}{\\bar{\\rho}}\\,\\phi_{2}.\n$$\nWith $\\phi_{1}=1$ and $\\phi_{2}=0$, this becomes\n$$\n\\tilde{\\phi}=\\frac{p\\,\\rho_{1}}{p\\,\\rho_{1}+(1-p)\\,\\rho_{2}}.\n$$\n\nThe bias error $E$ incurred in the mean scalar transport when using the Reynolds PDF instead of the Favre PDF is defined as\n$$\nE=\\overline{\\phi}-\\tilde{\\phi}=p-\\frac{p\\,\\rho_{1}}{p\\,\\rho_{1}+(1-p)\\,\\rho_{2}}.\n$$\n\nWe now evaluate $E$ for the given parameters $p=0.40$, $\\rho_{1}=0.30\\,\\mathrm{kg\\,m^{-3}}$, and $\\rho_{2}=1.20\\,\\mathrm{kg\\,m^{-3}}$. First compute the Reynolds mean density:\n$$\n\\bar{\\rho}=p\\,\\rho_{1}+(1-p)\\,\\rho_{2}=(0.40)\\,(0.30)+(0.60)\\,(1.20)=0.12+0.72=0.84.\n$$\nCompute the Favre mean:\n$$\n\\tilde{\\phi}=\\frac{p\\,\\rho_{1}}{\\bar{\\rho}}=\\frac{(0.40)\\,(0.30)}{0.84}=\\frac{0.12}{0.84}=\\frac{12}{84}=\\frac{1}{7}.\n$$\nCompute the Reynolds mean:\n$$\n\\overline{\\phi}=p=0.40=\\frac{2}{5}.\n$$\nHence the error is\n$$\nE=\\overline{\\phi}-\\tilde{\\phi}=\\frac{2}{5}-\\frac{1}{7}=\\frac{14-5}{35}=\\frac{9}{35}.\n$$\nThis is an exact fraction and dimensionless, as required.",
            "answer": "$$\\boxed{\\frac{9}{35}}$$"
        },
        {
            "introduction": "A central challenge in modeling turbulent reacting flows is closing the molecular mixing term in the scalar transport equation. The Interaction by Exchange with the Mean (IEM) model offers a straightforward closure by relaxing scalar fluctuations towards the mean at a defined rate. This exercise  asks you to derive the analytical solution for the decay of scalar variance under this model, providing fundamental insight into how scalar inhomogeneities are dissipated by mixing.",
            "id": "4073894",
            "problem": "Consider a statistically homogeneous, isotropic turbulent flow carrying a single reacting scalar $\\phi(\\boldsymbol{x},t)$ with variable density $\\rho(\\boldsymbol{x},t)$. In transported Probability Density Function (PDF) methods for reacting scalars, one closes the molecular mixing term using the Interaction by Exchange with the Mean (IEM) model. In a Lagrangian description, the scalar composition carried by a notional particle, denoted $\\Phi(t)$, evolves under the IEM closure as a deterministic relaxation toward the Favre mean $\\tilde{\\phi}(t)$ with a constant mixing rate $\\gamma>0$. The Favre mean is defined by $\\tilde{\\phi}=\\langle \\rho \\phi \\rangle / \\langle \\rho \\rangle$, where $\\langle \\cdot \\rangle$ denotes an ensemble average. Assume a homogeneous mixer with no mean gradients, no physical diffusion, and no source terms other than IEM mixing, so that $\\tilde{\\phi}(t)$ is constant in time under the IEM operator. The Lagrangian model is given by the ordinary differential equation for the composition,\n$$\n\\frac{d\\Phi}{dt}=-\\gamma\\left(\\Phi-\\tilde{\\phi}\\right),\n$$\nwith $\\gamma$ independent of time. Let the initial distribution of $\\Phi(0)$ have finite Favre variance defined by\n$$\n\\sigma_{\\phi}^{2}(0)=\\left\\langle \\rho \\left(\\phi(0)-\\tilde{\\phi}\\right)^{2}\\right\\rangle \\Big/ \\langle \\rho \\rangle,\n$$\nand define $\\sigma_{\\phi}^{2}(t)$ analogously at time $t$.\n\nStarting from the above foundations, derive the time evolution of $\\sigma_{\\phi}^{2}(t)$ implied by the IEM relaxation for this homogeneous mixer. Your derivation should proceed from the given evolution law for $\\Phi(t)$, the definition of the Favre mean and Favre variance, and the homogeneity assumptions stated, without introducing any additional modeling shortcuts. Provide the final closed-form analytical expression for $\\sigma_{\\phi}^{2}(t)$ in terms of $\\sigma_{\\phi}^{2}(0)$, $\\gamma$, and $t$. Express your final answer as a single analytical expression with no equality sign and no units.",
            "solution": "The problem asks for the derivation of the time evolution of the Favre variance of a scalar, $\\sigma_{\\phi}^{2}(t)$, within a homogeneous turbulent mixer governed by the Interaction by Exchange with the Mean (IEM) model for molecular mixing.\n\nThe Favre variance at time $t$ is defined by the problem as:\n$$\n\\sigma_{\\phi}^{2}(t) = \\frac{\\left\\langle \\rho \\left(\\phi(t)-\\tilde{\\phi}\\right)^{2}\\right\\rangle}{\\langle \\rho \\rangle}\n$$\nIn a Lagrangian framework, where we follow notional fluid particles, the scalar value of a particle is denoted by $\\Phi(t)$ and its density by $\\rho(t)$. The ensemble average $\\langle \\cdot \\rangle$ is taken over a large set of these particles. The problem states that the system is statistically homogeneous, which implies that the mean density $\\langle \\rho \\rangle$ is constant in time.\n\nTo find the time evolution of $\\sigma_{\\phi}^{2}(t)$, we differentiate this definition with respect to time $t$:\n$$\n\\frac{d\\sigma_{\\phi}^{2}(t)}{dt} = \\frac{d}{dt} \\left[ \\frac{\\left\\langle \\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2}\\right\\rangle}{\\langle \\rho \\rangle} \\right]\n$$\nSince $\\langle \\rho \\rangle$ is a constant, we have:\n$$\n\\frac{d\\sigma_{\\phi}^{2}(t)}{dt} = \\frac{1}{\\langle \\rho \\rangle} \\frac{d}{dt} \\left\\langle \\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} \\right\\rangle\n$$\nFor a statistically stationary system, which is a consequence of homogeneity, the operations of differentiation with respect to time and ensemble averaging commute. Thus, we can move the derivative inside the angle brackets:\n$$\n\\frac{d\\sigma_{\\phi}^{2}(t)}{dt} = \\frac{1}{\\langle \\rho \\rangle} \\left\\langle \\frac{d}{dt} \\left[ \\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} \\right] \\right\\rangle\n$$\nWe apply the product rule for differentiation to the term inside the derivative:\n$$\n\\frac{d}{dt} \\left[ \\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} \\right] = \\frac{d\\rho}{dt} \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} + \\rho(t) \\frac{d}{dt} \\left[ \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} \\right]\n$$\nUsing the chain rule on the second term, and noting from the problem statement that the Favre mean $\\tilde{\\phi}$ is constant in time ($\\frac{d\\tilde{\\phi}}{dt}=0$), we get:\n$$\n\\frac{d}{dt} \\left[ \\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} \\right] = \\frac{d\\rho}{dt} \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} + 2\\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right) \\frac{d\\Phi}{dt}\n$$\nThe problem statement contains a potential ambiguity: it refers to a \"reacting scalar,\" which implies density may change with composition, but it also specifies \"no source terms other than IEM mixing,\" which implies no chemical reactions. The latter is a specific dynamical constraint and must take precedence. The IEM model itself only describes the evolution of the scalar $\\Phi$ due to mixing. In the absence of reactions or other specified dynamics for density, the most logical and standard simplification is to assume that the density of each Lagrangian particle is conserved, i.e., it is constant along its trajectory. This means $\\frac{d\\rho}{dt} = 0$ for each particle. Under this assumption, the first term in the expression above vanishes.\n$$\n\\frac{d}{dt} \\left[ \\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} \\right] = 2\\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right) \\frac{d\\Phi}{dt}\n$$\nSubstituting this back into the equation for the rate of change of the variance gives:\n$$\n\\frac{d\\sigma_{\\phi}^{2}(t)}{dt} = \\frac{1}{\\langle \\rho \\rangle} \\left\\langle 2\\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right) \\frac{d\\Phi}{dt} \\right\\rangle\n$$\nThe problem provides the Lagrangian evolution law for $\\Phi(t)$ according to the IEM model:\n$$\n\\frac{d\\Phi}{dt} = -\\gamma\\left(\\Phi - \\tilde{\\phi}\\right)\n$$\nwhere $\\gamma$ is the constant mixing rate. Substituting this expression for $\\frac{d\\Phi}{dt}$:\n$$\n\\frac{d\\sigma_{\\phi}^{2}(t)}{dt} = \\frac{1}{\\langle \\rho \\rangle} \\left\\langle 2\\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right) \\left[ -\\gamma\\left(\\Phi(t)-\\tilde{\\phi}\\right) \\right] \\right\\rangle\n$$\nWe can factor out the constants $-2$ and $\\gamma$ from the ensemble average:\n$$\n\\frac{d\\sigma_{\\phi}^{2}(t)}{dt} = -2\\gamma \\frac{\\left\\langle \\rho(t) \\left(\\Phi(t)-\\tilde{\\phi}\\right)^{2} \\right\\rangle}{\\langle \\rho \\rangle}\n$$\nThe term on the right is, by definition, the Favre variance $\\sigma_{\\phi}^{2}(t)$. This yields a first-order linear homogeneous ordinary differential equation for $\\sigma_{\\phi}^{2}(t)$:\n$$\n\\frac{d\\sigma_{\\phi}^{2}}{dt} = -2\\gamma \\sigma_{\\phi}^{2}(t)\n$$\nThis ODE can be solved by separation of variables, with the initial condition being the Favre variance at $t=0$, denoted $\\sigma_{\\phi}^{2}(0)$. The solution is:\n$$\n\\int_{\\sigma_{\\phi}^{2}(0)}^{\\sigma_{\\phi}^{2}(t)} \\frac{d(\\sigma_{\\phi}^{2})}{\\sigma_{\\phi}^{2}} = \\int_{0}^{t} -2\\gamma \\,d\\tau\n$$\n$$\n\\ln\\left(\\frac{\\sigma_{\\phi}^{2}(t)}{\\sigma_{\\phi}^{2}(0)}\\right) = -2\\gamma t\n$$\nExponentiating both sides provides the final analytical expression for the time evolution of the Favre variance:\n$$\n\\sigma_{\\phi}^{2}(t) = \\sigma_{\\phi}^{2}(0) \\exp(-2\\gamma t)\n$$\nThis result shows that the Favre scalar variance decays exponentially in time at a rate of $2\\gamma$ under the IEM mixing model in a homogeneous system.",
            "answer": "$$\\boxed{\\sigma_{\\phi}^{2}(0) \\exp(-2\\gamma t)}$$"
        },
        {
            "introduction": "Bridging theory and practice is a crucial step in mastering computational methods. This hands-on coding exercise  challenges you to build a simple particle-based transported PDF solver for a homogeneous system, incorporating both mixing and reaction operators. The core focus is on ensuring \"realizability\"â€”that the numerical scheme correctly maintains the physical constraints on species mass fractions ($0 \\le Y_i \\le 1$ and $\\sum_i Y_i = 1$), a non-negotiable requirement for any robust combustion simulation code.",
            "id": "4073910",
            "problem": "You are given the task of constructing and analyzing a simplified transported probability density function (PDF) solver for reacting scalars that represent species mass fractions. Let there be $N_s$ chemical species with mass fractions $\\{Y_i\\}_{i=1}^{N_s}$ per computational particle, where each particle is a sample from a joint probability distribution over the mass-fraction simplex. The mass-fraction simplex constraints are $0 \\le Y_i \\le 1$ for all $i$ and $\\sum_{i=1}^{N_s} Y_i = 1$. The solver evolves an ensemble of $N_p$ particles in time, where each particle carries a vector of mass fractions $\\mathbf{Y} \\in \\mathbb{R}^{N_s}$, and is subject to micro-mixing and reaction. Assume a statistically homogeneous system (no spatial transport), such that the transported joint probability density function $p(\\mathbf{Y}, t)$ obeys conservation of probability. The micro-mixing should be modeled as an evolution that contracts particle compositions toward an ensemble statistic in a manner consistent with realizability, and the reaction should be modeled as a linear Markov process among species that conserves total mass fraction.\n\nStarting from the following fundamental bases:\n- Conservation of probability and conservation of mass fraction on the simplex, which requires the invariants $0 \\le Y_i \\le 1$ and $\\sum_{i=1}^{N_s} Y_i = 1$ for all time.\n- A statistically homogeneous micro-mixing operator that, by construction, maps a particle composition into a convex combination with the ensemble statistic in a single time increment, preserving the simplex.\n- A linear reaction operator represented by a generator matrix with nonnegative off-diagonal entries and zero row-sum, which defines a continuous-time Markov process on the species index and preserves nonnegativity and the total sum.\n\nYour tasks are:\n1. Derive a principled particle-based time-advancement scheme grounded in the above bases that advances $\\mathbf{Y}$ by one time step $\\Delta t$ using a micro-mixing step followed by a linear reaction step. The scheme must preserve the invariants $0 \\le Y_i \\le 1$ and $\\sum_i Y_i = 1$ analytically.\n2. Implement a program that simulates the ensemble evolution over a specified number of time steps. The micro-mixing must be chosen to drive scalar values toward bounds when the ensemble statistic itself is near a bound, and the reaction must be represented by a generator that shifts probability among species while preserving conservation. No external input is allowed; all parameters are defined in the code.\n3. Design realizability tests to verify that, for all simulated time steps:\n   - The bounds $0 \\le Y_i \\le 1$ are maintained.\n   - The sum $\\sum_{i=1}^{N_s} Y_i = 1$ is maintained.\n   - When the ensemble statistic is near a bound, micro-mixing drives particle scalars closer to bounds in aggregate, quantified by a decrease in an aggregate closeness-to-bound metric.\n\nDefine the aggregate closeness-to-bound metric for an ensemble at time $t$ as follows. For each particle $k$ with composition $\\mathbf{Y}^{(k)}(t)$, compute $m^{(k)}(t) = \\max_i Y^{(k)}_i(t)$, and define the per-particle distance to the nearest upper bound as $d^{(k)}(t) = 1 - m^{(k)}(t)$. The ensemble metric is the arithmetic mean $\\bar{d}(t) = \\frac{1}{N_p} \\sum_{k=1}^{N_p} d^{(k)}(t)$. Micro-mixing is said to drive values toward bounds if $\\bar{d}(t_{\\text{final}}) \\le \\bar{d}(t_{\\text{initial}})$.\n\nThe program must execute the following test suite without any external input:\n\n- Test $1$ (general case): $N_s = 3$, $N_p = 1000$, $\\Delta t = 10^{-3}$, $N_{\\text{steps}} = 500$, mixing timescale $\\tau_{\\text{mix}} = 5 \\times 10^{-3}$, and a reaction generator that preferentially moves probability mass to species $1$ (indexing $i=1,2,3$). Initialize $70\\%$ of particles at $\\mathbf{Y} = [1,0,0]$ and $30\\%$ at $\\mathbf{Y} = [\\frac{1}{3},\\frac{1}{3},\\frac{1}{3}]$.\n- Test $2$ (boundary-driven mixing, no reaction): $N_s = 2$, $N_p = 200$, $\\Delta t = 5 \\times 10^{-2}$, $N_{\\text{steps}} = 50$, mixing timescale $\\tau_{\\text{mix}} = 5 \\times 10^{-2}$, reaction off. Initialize $50\\%$ of particles at $\\mathbf{Y} = [1,0]$ and $50\\%$ at $\\mathbf{Y} = [0.2,0.8]$.\n- Test $3$ (fast mixing limit): $N_s = 2$, $N_p = 50$, $\\Delta t = 1$, $N_{\\text{steps}} = 5$, mixing timescale $\\tau_{\\text{mix}} = 10^{-6}$, reaction off. Initialize particles evenly split between $\\mathbf{Y} = [1,0]$ and $\\mathbf{Y} = [0,1]$.\n- Test $4$ (single-particle edge case): $N_s = 3$, $N_p = 1$, $\\Delta t = 10^{-1}$, $N_{\\text{steps}} = 20$, mixing timescale $\\tau_{\\text{mix}} = 10^{-1}$, reaction off. Initialize the single particle at $\\mathbf{Y} = [1,0,0]$.\n\nFor each test, compute across all time steps the maximum realizability violation magnitude\n$$\n\\varepsilon = \\max\\left\\{ \\max_{k,t}\\left( \\max_i\\{-Y^{(k)}_i(t), \\, Y^{(k)}_i(t)-1\\} \\right), \\; \\max_{k,t} \\left| \\sum_{i=1}^{N_s} Y^{(k)}_i(t) - 1 \\right| \\right\\},\n$$\nand determine whether micro-mixing drives values toward bounds by checking $\\bar{d}(t_{\\text{final}}) \\le \\bar{d}(t_{\\text{initial}}) + 10^{-12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case yields a boolean defined as true if and only if both of the following hold: $(i)$ $\\varepsilon \\le 10^{-12}$ and $(ii)$ $\\bar{d}(t_{\\text{final}}) \\le \\bar{d}(t_{\\text{initial}}) + 10^{-12}$. Therefore, the final output must be of the form $[b_1,b_2,b_3,b_4]$ where each $b_j$ is either true or false as defined above.",
            "solution": "We begin with reacting scalars represented by species mass fractions $\\{Y_i\\}_{i=1}^{N_s}$ obeying $0 \\le Y_i \\le 1$ and $\\sum_{i=1}^{N_s} Y_i = 1$, defining the mass-fraction simplex. In the transported probability density function method, an ensemble of $N_p$ computational particles $\\{\\mathbf{Y}^{(k)}(t)\\}_{k=1}^{N_p}$ represents samples of the joint probability density function $p(\\mathbf{Y}, t)$, and their evolution must preserve realizability and probability conservation.\n\nPrinciple for micro-mixing. In statistically homogeneous turbulence, a micro-mixing closure must preserve realizability and be consistent with a contraction toward an ensemble statistic. Conservation and convexity are the bases: if the update from time $t$ to $t+\\Delta t$ is a convex combination between a particle and an ensemble statistic $\\mathbf{M}(t)$, then for any particle $k$,\n$$\n\\mathbf{Y}^{(k)}(t+\\Delta t) = \\alpha \\, \\mathbf{Y}^{(k)}(t) + (1-\\alpha)\\, \\mathbf{M}(t),\n$$\nwith $0 \\le \\alpha \\le 1$, guarantees $0 \\le Y^{(k)}_i(t+\\Delta t) \\le 1$ and $\\sum_i Y^{(k)}_i(t+\\Delta t) = 1$ provided the initial state is realizable and $\\mathbf{M}(t)$ lies on the simplex. A well-tested homogeneous micro-mixing model consistent with the above is the Interaction by Exchange with the Mean (IEM), which yields a drift proportional to the difference to the ensemble mean $\\mathbf{\\bar{Y}}(t) = \\frac{1}{N_p}\\sum_k \\mathbf{Y}^{(k)}(t)$ and a relaxation timescale $\\tau_{\\text{mix}}$. The ordinary differential equation for each particle is\n$$\n\\frac{d \\mathbf{Y}^{(k)}}{dt} = -\\frac{1}{\\tau_{\\text{mix}}} \\left( \\mathbf{Y}^{(k)} - \\mathbf{\\bar{Y}} \\right).\n$$\nSolving this linear differential equation over a single time step $\\Delta t$ with constant $\\mathbf{\\bar{Y}}$ during the step yields the exact update\n$$\n\\mathbf{Y}^{(k)}(t+\\Delta t) = \\mathbf{\\bar{Y}}(t) + e^{-\\Delta t/\\tau_{\\text{mix}}} \\left( \\mathbf{Y}^{(k)}(t) - \\mathbf{\\bar{Y}}(t) \\right),\n$$\nwhich is a convex combination between $\\mathbf{Y}^{(k)}(t)$ and $\\mathbf{\\bar{Y}}(t)$ since $e^{-\\Delta t/\\tau_{\\text{mix}}} \\in (0,1]$. This update preserves the simplex analytically: for each particle,\n$$\n\\sum_i Y^{(k)}_i(t+\\Delta t) = \\sum_i \\bar{Y}_i(t) + e^{-\\Delta t/\\tau_{\\text{mix}}}\\left( \\sum_i Y^{(k)}_i(t) - \\sum_i \\bar{Y}_i(t) \\right) = 1 + e^{-\\Delta t/\\tau_{\\text{mix}}}(1-1) = 1,\n$$\nand $Y^{(k)}_i(t+\\Delta t)$ lies between $Y^{(k)}_i(t)$ and $\\bar{Y}_i(t)$, which both lie in $[0,1]$, hence $0 \\le Y^{(k)}_i(t+\\Delta t) \\le 1$.\n\nPrinciple for reaction. Reactions shifting mass among species must preserve realizability. A continuous-time Markov chain on species indices implements a linear reaction operator with generator matrix $\\mathbf{Q} \\in \\mathbb{R}^{N_s \\times N_s}$ whose off-diagonal entries are nonnegative, and whose rows sum to zero:\n$$\nQ_{ij} \\ge 0 \\text{ for } i \\neq j, \\qquad \\sum_{j=1}^{N_s} Q_{ij} = 0 \\text{ for all } i.\n$$\nInterpreting $\\mathbf{Y}$ as a row vector, the reaction dynamics is\n$$\n\\frac{d \\mathbf{Y}}{dt} = \\mathbf{Y}\\, \\mathbf{Q}.\n$$\nThe exact one-step solution over $\\Delta t$ is\n$$\n\\mathbf{Y}(t+\\Delta t) = \\mathbf{Y}(t)\\, \\exp(\\mathbf{Q}\\Delta t),\n$$\nwhere $\\exp$ is the matrix exponential. For a valid generator, $\\mathbf{P} = \\exp(\\mathbf{Q}\\Delta t)$ is a stochastic matrix: its rows are probability distributions with nonnegative entries and row sum $1$. Therefore, if $\\mathbf{Y}(t)$ is a probability vector (components in $[0,1]$ and sum $1$), then $\\mathbf{Y}(t+\\Delta t) = \\mathbf{Y}(t)\\mathbf{P}$ is also a probability vector, preserving $0 \\le Y_i \\le 1$ and $\\sum_i Y_i = 1$.\n\nComposition of micro-mixing and reaction. Over each time step, we first apply the micro-mixing update using the ensemble mean to compute $\\mathbf{Y}^{(k)}_{\\text{mix}}$, and then apply the reaction update via the stochastic matrix $\\mathbf{P}$ to obtain $\\mathbf{Y}^{(k)}_{\\text{new}} = \\mathbf{Y}^{(k)}_{\\text{mix}} \\mathbf{P}$. Each substep maps the simplex into itself, so the composition does as well, preserving realizability analytically.\n\nDriving toward bounds. If the ensemble mean is near a bound (for example, the upper bound $1$ for some species component), the micro-mixing contraction pulls particles toward that mean, reducing the ensemble average distance to the nearest bound. A rigorous aggregate metric is to compute the maximum component per particle $m^{(k)}(t) = \\max_i Y^{(k)}_i(t)$ and the mean upper-bound distance $\\bar{d}(t) = \\frac{1}{N_p}\\sum_k (1 - m^{(k)}(t))$. Since mixing is a contraction toward the ensemble mean and the ensemble mean itself lies on the simplex, if the mean composition is closer to an upper bound than the initial ensemble average, repeated application of mixing reduces $\\bar{d}(t)$.\n\nAlgorithmic design.\n- Initialize an array of $N_p$ particle compositions on the simplex according to the specified test case.\n- For each time step:\n  1. Compute the ensemble mean $\\mathbf{\\bar{Y}}(t) = \\frac{1}{N_p}\\sum_k \\mathbf{Y}^{(k)}(t)$.\n  2. Apply micro-mixing (IEM exact update): for each particle $k$,\n     $$\n     \\mathbf{Y}^{(k)}_{\\text{mix}} = \\mathbf{\\bar{Y}}(t) + e^{-\\Delta t/\\tau_{\\text{mix}}} \\left( \\mathbf{Y}^{(k)}(t) - \\mathbf{\\bar{Y}}(t) \\right).\n     $$\n  3. Apply reaction: precompute $\\mathbf{P} = \\exp(\\mathbf{Q}\\Delta t)$ and set $\\mathbf{Y}^{(k)}(t+\\Delta t) = \\mathbf{Y}^{(k)}_{\\text{mix}} \\mathbf{P}$.\n  4. Track realizability violations: at each step, compute\n     $$\n     v_{\\text{bounds}}(t) = \\max_{k,i} \\left\\{ -Y^{(k)}_i(t),\\, Y^{(k)}_i(t)-1 \\right\\}, \\quad v_{\\text{sum}}(t) = \\max_k \\left| \\sum_i Y^{(k)}_i(t) - 1 \\right|.\n     $$\n     Accumulate $\\varepsilon = \\max_t \\max\\{v_{\\text{bounds}}(t), v_{\\text{sum}}(t)\\}$.\n- Compute the bound-closeness metric at initial and final times,\n  $$\n  \\bar{d}(t_{\\text{initial}}) = \\frac{1}{N_p}\\sum_{k=1}^{N_p} \\left( 1 - \\max_i Y^{(k)}_i(t_{\\text{initial}}) \\right), \\quad\n  \\bar{d}(t_{\\text{final}}) = \\frac{1}{N_p}\\sum_{k=1}^{N_p} \\left( 1 - \\max_i Y^{(k)}_i(t_{\\text{final}}) \\right).\n  $$\n- For each test, return a boolean that is true if $\\varepsilon \\le 10^{-12}$ and $\\bar{d}(t_{\\text{final}}) \\le \\bar{d}(t_{\\text{initial}}) + 10^{-12}$.\n\nTest-suite coverage rationale.\n- Test $1$ represents a typical transported probability density function scenario with three species, finite micro-mixing, and reaction that moves probability toward a dominant species. The initial ensemble includes a large fraction at a bound and a broad mixture, ensuring contraction toward bounds.\n- Test $2$ isolates micro-mixing without reaction in a two-species system, explicitly testing that mixing near bounds reduces aggregate distance to bounds.\n- Test $3$ is a fast-mixing limit where $\\Delta t/\\tau_{\\text{mix}} \\gg 1$, driving immediate contraction to the ensemble mean; it tests stability and realizability under strong mixing.\n- Test $4$ is a single-particle edge case where the ensemble mean equals the particle state; mixing is a null operation, and with reaction off, invariants and the bound-closeness metric remain unchanged.\n\nBy deriving the micro-mixing update from the Interaction by Exchange with the Mean model and the reaction update from the matrix exponential of a valid generator, the algorithm preserves realizability analytically. The program implements these steps with finite-precision arithmetic and verifies realizability with tight tolerances while confirming bound-directed behavior in the defined scenarios.",
            "answer": "$$\\boxed{[true,false,false,true]}$$"
        }
    ]
}