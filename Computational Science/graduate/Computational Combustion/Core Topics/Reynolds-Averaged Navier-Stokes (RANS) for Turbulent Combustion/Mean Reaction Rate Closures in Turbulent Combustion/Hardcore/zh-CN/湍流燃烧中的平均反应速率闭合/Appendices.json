{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在揭示湍流燃烧建模中的一个核心挑战：阿伦尼乌斯（Arrhenius）反应动力学的强非线性特性。通过一个理想化的思想实验，我们将直接推导湍流脉动对平均反应速率的影响，并量化为何不能简单地将平均温度代入速率表达式来计算平均速率。这个练习将帮助你理解湍流-化学相互作用的根本来源，即所谓的“反应速率封闭问题” 。",
            "id": "4038286",
            "problem": "考虑一个统计平稳、均匀的湍流反应流，其中单步反应的瞬时反应速率在经过适当的无量纲化处理并分离了指前因子和组分效应后，被建模为 $\\dot{\\omega}(\\theta)=\\exp(\\theta)$。这里的活化变量 $\\theta$ 定义为 $\\theta=-E_a/(R T)$，其中 $E_a$ 是活化能，$R$ 是通用气体常数，$T$ 是瞬时温度。假设湍流温度波动使得 $\\theta$ 成为一个均值为 $\\mu$、方差为 $\\sigma^2$ 的高斯随机变量，记作 $\\theta \\sim \\mathcal{N}(\\mu,\\sigma^2)$。令反应速率的雷诺平均（系综平均）表示为 $\\overline{\\dot{\\omega}}=\\langle \\dot{\\omega} \\rangle$。\n\n从 (i) 雷诺平均作为关于 $\\theta$ 的概率密度函数 (PDF) 的期望的定义，以及 (ii) 标准高斯 PDF 出发，推导出一个关于 $\\mu$ 和 $\\sigma^2$ 的 $\\overline{\\dot{\\omega}}$ 的封闭形式表达式，过程中不援引任何预先给定的特殊函数恒等式。然后，解释将 $\\overline{\\dot{\\omega}}$ 与朴素的“代入平均值”的阿伦尼乌斯估计 $\\exp(\\overline{\\theta})=\\exp(\\mu)$ 联系起来的乘性偏差因子，说明其如何源于指数函数的非线性以及湍流燃烧中 $\\theta$ 的统计特性。\n\n假设 $\\dot{\\omega}$ 是无量纲的。将你的最终答案表示为 $\\overline{\\dot{\\omega}}$ 的单个封闭形式解析表达式。不需要进行数值舍入。",
            "solution": "该问题是有效的，因为它科学地基于湍流燃烧理论的原理，问题定义明确，客观，并包含一套完整且一致的前提。我们继续进行推导。\n\n主要目标是计算瞬时反应速率的雷诺平均值 $\\overline{\\dot{\\omega}}$。根据定义，对于一个具有概率密度函数 (PDF) $P(\\theta)$ 的随机变量 $\\theta$，函数 $f(\\theta)$ 的期望（或雷诺平均）由下式给出：\n$$\n\\langle f(\\theta) \\rangle = \\int_{-\\infty}^{\\infty} f(\\theta) P(\\theta) \\, d\\theta\n$$\n在本问题中，函数是无量纲反应速率 $\\dot{\\omega}(\\theta) = \\exp(\\theta)$，随机变量 $\\theta$ 服从高斯分布 $\\theta \\sim \\mathcal{N}(\\mu, \\sigma^2)$。高斯分布的 PDF 为：\n$$\nP(\\theta) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right)\n$$\n其中 $\\mu$ 是 $\\theta$ 的均值，$\\sigma^2$ 是其方差。\n\n我们现在可以构建平均反应速率的积分，$\\overline{\\dot{\\omega}} = \\langle \\dot{\\omega}(\\theta) \\rangle$：\n$$\n\\overline{\\dot{\\omega}} = \\int_{-\\infty}^{\\infty} \\exp(\\theta) \\left[ \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\right] \\, d\\theta\n$$\n常数前因子可以移到积分之外：\n$$\n\\overline{\\dot{\\omega}} = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp(\\theta) \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\, d\\theta\n$$\n我们通过将其指数相加来合并两个指数项：\n$$\n\\overline{\\dot{\\omega}} = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(\\theta - \\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\, d\\theta\n$$\n为了求解此积分，我们必须将指数的自变量整理成二次型的形式，这将使我们能够利用高斯积分的性质。让我们展开自变量：\n$$\n\\theta - \\frac{(\\theta-\\mu)^2}{2\\sigma^2} = \\theta - \\frac{\\theta^2 - 2\\mu\\theta + \\mu^2}{2\\sigma^2} = \\frac{2\\sigma^2\\theta - (\\theta^2 - 2\\mu\\theta + \\mu^2)}{2\\sigma^2} = -\\frac{1}{2\\sigma^2} (\\theta^2 - 2\\mu\\theta - 2\\sigma^2\\theta + \\mu^2)\n$$\n$$\n= -\\frac{1}{2\\sigma^2} [\\theta^2 - 2(\\mu+\\sigma^2)\\theta + \\mu^2]\n$$\n现在，我们对括号内关于 $\\theta$ 的二次表达式进行配方。对于一般的二次式 $x^2 + bx + c$，我们将其写成 $(x+b/2)^2 - (b/2)^2 + c$。这里，我们的变量是 $\\theta$，一次项的系数是 $-2(\\mu+\\sigma^2)$。\n$$\n\\theta^2 - 2(\\mu+\\sigma^2)\\theta + \\mu^2 = \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - (\\mu+\\sigma^2)^2 + \\mu^2\n$$\n展开我们减去的平方项：\n$$\n= \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - (\\mu^2 + 2\\mu\\sigma^2 + \\sigma^4) + \\mu^2\n$$\n$$\n= \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - 2\\mu\\sigma^2 - \\sigma^4\n$$\n将此代回指数的自变量中：\n$$\n-\\frac{1}{2\\sigma^2} \\left( \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - 2\\mu\\sigma^2 - \\sigma^4 \\right) = -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} + \\frac{2\\mu\\sigma^2 + \\sigma^4}{2\\sigma^2}\n$$\n$$\n= -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} + \\mu + \\frac{\\sigma^2}{2}\n$$\n现在我们将这个简化后的表达式代回 $\\overline{\\dot{\\omega}}$ 的积分中：\n$$\n\\overline{\\dot{\\omega}} = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} + \\mu + \\frac{\\sigma^2}{2} \\right) \\, d\\theta\n$$\n项 $\\exp(\\mu + \\sigma^2/2)$ 不依赖于 $\\theta$，可以从积分中提出：\n$$\n\\overline{\\dot{\\omega}} = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left( -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} \\right) \\, d\\theta\n$$\n剩下的积分是一个高斯 PDF 在其整个定义域上的积分。具体来说，它是一个均值为 $\\mu' = \\mu+\\sigma^2$、方差为 $\\sigma^2$ 的高斯随机变量的 PDF。任何概率密度函数在其定义域 $(-\\infty, \\infty)$ 上的积分等于 $1$。\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left( -\\frac{\\left[\\theta - \\mu'\\right]^2}{2\\sigma^2} \\right) \\, d\\theta = 1\n$$\n因此，平均反应速率简化为：\n$$\n\\overline{\\dot{\\omega}} = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)\n$$\n这就是平均反应速率的封闭形式表达式。\n\n为了进行解释，我们将此结果与朴素的“代入平均值”估计进行比较。这种更简单的方法是在输入变量的平均值 $\\overline{\\theta} = \\mu$ 处评估反应速率函数。这得到：\n$$\n\\dot{\\omega}_{\\text{naive}} = \\dot{\\omega}(\\overline{\\theta}) = \\dot{\\omega}(\\mu) = \\exp(\\mu)\n$$\n真实平均速率与朴素估计之间的关系是：\n$$\n\\overline{\\dot{\\omega}} = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right) = \\exp(\\mu) \\exp\\left(\\frac{\\sigma^2}{2}\\right) = \\dot{\\omega}_{\\text{naive}} \\cdot \\exp\\left(\\frac{\\sigma^2}{2}\\right)\n$$\n乘性偏差因子是 $\\exp(\\sigma^2/2)$。这个因子总是大于或等于 $1$，因为 $\\sigma^2 \\ge 0$。因此，真实平均速率总是大于或等于在平均温度下评估的速率。这个结果是琴生不等式（Jensen's inequality）的直接推论，该不等式指出，对于凸函数 $f$，有 $\\langle f(X) \\rangle \\ge f(\\langle X \\rangle)$。指数函数 $f(\\theta) = \\exp(\\theta)$ 是严格凸的，因此对于任何非零方差 $\\sigma^2  0$，都有 $\\langle \\exp(\\theta) \\rangle  \\exp(\\langle \\theta \\rangle)$。\n\n这种偏差的物理根源在于阿伦尼乌斯动力学的强非线性。反应速率对温度呈指数级敏感。在湍流中，温度会波动。高温偏移（热点，对应于 $\\theta$ 的正向波动）会显著增加反应速率。低温偏移（冷点，对应于 $\\theta$ 的负向波动）会降低反应速率，但其程度远不那么剧烈。因为指数函数对高温的“奖励”远大于对低温的“惩罚”，所以平均速率被拉高，并由短暂的高温时刻的贡献所主导。方差 $\\sigma^2$ 量化了这些温度波动的强度。更大的方差意味着更强的湍流和更极端的温度波动，从而导致更大的偏差因子 $\\exp(\\sigma^2/2)$，以及朴素“代入平均值”模型的更严重失效。这是湍流燃烧建模中的一个核心问题，称为反应速率封闭问题。",
            "answer": "$$\n\\boxed{\\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)}\n$$"
        },
        {
            "introduction": "在掌握了湍流脉动影响非线性反应速率的基本原理后，我们将转向一个在雷诺平均纳维-斯托克斯（RANS）模拟中广泛应用的实际场景。本练习将介绍用于模拟非预混火焰中标量混合的Beta概率密度函数（PDF）模型。你将亲手实践如何利用RANS模型输出的平均混合分数及其方差来确定Beta PDF的参数，进而计算封闭后的平均反应速率并分析其对模型输入的敏感性 。",
            "id": "4038357",
            "problem": "在一个雷诺平均纳维-斯托克斯 (RANS) 框架内，对一个非预混湍流射流火焰进行建模。混合分数 $Z \\in [0,1]$ 被视为一个随机变量，其 Favre 平均统计量 $\\tilde{Z}$ 和 $\\widetilde{Z''^2}$ 用于参数化一个用于标量混合的 Beta 概率密度函数 (PDF) 封闭模型。在选定位置，Favre 平均混合分数及其方差据报告为 $\\tilde{Z} = 0.50$ 和 $\\widetilde{Z''^2} = 2.5 \\times 10^{-2}$。对于单步模型，平均反应速率封闭模型是通过将条件反应速率 $\\dot{\\omega}(Z)$ 对 $Z$ 的 Beta PDF 进行积分来构建的，假设条件模型为\n$$\n\\dot{\\omega}(Z) = C\\,Z^{p}\\,(1-Z)^{q},\n$$\n其中 $p=q=1$，校准常数 $C = 1.0$，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。假设 Beta PDF 参数化与报告的 $\\tilde{Z}$ 和 $\\widetilde{Z''^2}$ 一致，并且 Favre 平均和 PDF 封闭模型有效。\n\n从基本定义以及关于 PDF 和矩匹配的经过充分检验的事实出发，完成以下任务：\n\n1. 使用给定的 $\\tilde{Z}$ 和 $\\widetilde{Z''^2}$ 从第一性原理推导 Beta PDF 参数 $(\\alpha,\\beta)$，不得引用任何预先给出的参数公式作为捷径。明确展示根据报告的均值和方差获得 $(\\alpha,\\beta)$ 所需的步骤。\n\n2. 使用 Beta 函数的定义和 Gamma 函数的性质，将 Favre 平均反应速率 $\\overline{\\dot{\\omega}}$ 表示为 Beta 函数的比值，并针对推导出的 $(\\alpha,\\beta)$ 和给定的 $(p,q,C)$ 对其进行求值。\n\n3. 在 $\\tilde{Z}$ 固定的情况下，计算平均反应速率 $\\overline{\\dot{\\omega}}$ 相对于方差 $\\widetilde{Z''^2}$ 的灵敏度，即在给定的 $(\\tilde{Z},\\widetilde{Z''^2})$ 处计算 $\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}}$。将此灵敏度以 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ 为单位表示。\n\n将最终答案以单行矩阵的形式给出，其中包含 Beta 参数和所求的灵敏度，顺序为 $\\alpha$、$\\beta$、$\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}}$。如果需要进行数值近似，请将答案四舍五入到四位有效数字。否则，请给出精确值。",
            "solution": "混合分数 $Z$ 是一个取值范围在 $[0,1]$ 内的有界标量。在用于非预混燃烧的 RANS 封闭模型中，一种常见的做法是用一个由两个正参数 $(\\alpha,\\beta)$ 表征的 Beta 概率密度函数 (PDF) 来表示 $Z$ 的分布。Beta PDF 为\n$$\nf_{Z}(z;\\alpha,\\beta) = \\frac{z^{\\alpha-1}(1-z)^{\\beta-1}}{B(\\alpha,\\beta)},\\quad 0 \\le z \\le 1,\n$$\n其中 $B(\\alpha,\\beta)$ 是 Beta 函数，通过 Gamma 函数 $\\Gamma(\\cdot)$ 定义为\n$$\nB(\\alpha,\\beta) = \\frac{\\Gamma(\\alpha)\\,\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}.\n$$\nBeta 分布的前两阶矩是经过充分检验的事实：\n$$\n\\mathbb{E}[Z] = \\frac{\\alpha}{\\alpha+\\beta},\\qquad \\mathrm{Var}(Z) = \\frac{\\alpha\\,\\beta}{(\\alpha+\\beta)^{2}(\\alpha+\\beta+1)}.\n$$\n在 Favre 平均中，混合分数的均值和方差通常与这些表达式进行匹配（当封闭模型使用相同的矩时，Favre 权重不会改变矩匹配的代数运算）。记 $m \\equiv \\tilde{Z}$ 和 $v \\equiv \\widetilde{Z''^2}$，将其视为参数拟合中使用的均值和方差。\n\n第 1 步：从 $m$ 和 $v$ 推导 $(\\alpha,\\beta)$。\n\n引入和 $s \\equiv \\alpha+\\beta$。均值条件给出\n$$\nm = \\frac{\\alpha}{s}\\quad\\Rightarrow\\quad \\alpha = m\\,s,\\qquad \\beta = (1-m)\\,s.\n$$\n将这些代入方差表达式中：\n$$\nv = \\frac{\\alpha\\,\\beta}{s^{2}(s+1)} = \\frac{m\\,s\\,(1-m)\\,s}{s^{2}(s+1)} = \\frac{m(1-m)}{s+1}.\n$$\n求解 $s$：\n$$\ns+1 = \\frac{m(1-m)}{v}\\quad\\Rightarrow\\quad s = \\frac{m(1-m)}{v} - 1.\n$$\n则\n$$\n\\alpha = m\\left(\\frac{m(1-m)}{v} - 1\\right),\\qquad \\beta = (1-m)\\left(\\frac{m(1-m)}{v} - 1\\right).\n$$\n使用给定值 $m = 0.50$ 和 $v = 2.5\\times 10^{-2}$，\n$$\nm(1-m) = 0.5\\times 0.5 = 0.25,\\qquad s = \\frac{0.25}{2.5\\times 10^{-2}} - 1 = 10 - 1 = 9.\n$$\n因此，\n$$\n\\alpha = m\\,s = 0.5\\times 9 = \\frac{9}{2},\\qquad \\beta = (1-m)\\,s = 0.5\\times 9 = \\frac{9}{2}.\n$$\n\n第 2 步：表示并计算 $\\overline{\\dot{\\omega}}$。\n\n平均反应速率封闭模型通过将条件反应速率 $\\dot{\\omega}(Z)$ 对 $Z$ 的 PDF 进行积分得到：\n$$\n\\overline{\\dot{\\omega}} = \\int_{0}^{1} \\dot{\\omega}(z)\\,f_{Z}(z;\\alpha,\\beta)\\,\\mathrm{d}z = \\frac{C}{B(\\alpha,\\beta)}\\int_{0}^{1} z^{p+\\alpha-1}(1-z)^{q+\\beta-1}\\,\\mathrm{d}z.\n$$\n使用 Beta 函数的定义，\n$$\n\\int_{0}^{1} z^{A-1}(1-z)^{B-1}\\,\\mathrm{d}z = B(A,B),\n$$\n我们得到\n$$\n\\overline{\\dot{\\omega}} = C\\,\\frac{B(\\alpha+p,\\beta+q)}{B(\\alpha,\\beta)}.\n$$\n当 $p=q=1$ 且 $\\alpha=\\beta=9/2$ 时，\n$$\n\\overline{\\dot{\\omega}} = C\\,\\frac{B\\!\\left(\\frac{11}{2},\\frac{11}{2}\\right)}{B\\!\\left(\\frac{9}{2},\\frac{9}{2}\\right)} = C\\,\\frac{\\Gamma\\!\\left(\\frac{11}{2}\\right)^{2}\\,\\Gamma(9)}{\\Gamma\\!\\left(11\\right)\\,\\Gamma\\!\\left(\\frac{9}{2}\\right)^{2}}.\n$$\n通过递推关系 $\\Gamma(x+1) = x\\,\\Gamma(x)$ 和 $\\Gamma\\!\\left(\\frac{1}{2}\\right) = \\sqrt{\\pi}$ 使用半整数 Gamma 值：\n$$\n\\Gamma\\!\\left(\\frac{9}{2}\\right) = \\frac{105\\,\\sqrt{\\pi}}{16},\\qquad \\Gamma\\!\\left(\\frac{11}{2}\\right) = \\frac{945\\,\\sqrt{\\pi}}{32},\\qquad \\Gamma(9) = 8! = 40320,\\qquad \\Gamma(11) = 10! = 3628800.\n$$\n因此，\n$$\n\\frac{B\\!\\left(\\frac{11}{2},\\frac{11}{2}\\right)}{B\\!\\left(\\frac{9}{2},\\frac{9}{2}\\right)} = \\frac{\\left(\\frac{945\\,\\sqrt{\\pi}}{32}\\right)^{2}\\,40320}{\\left(\\frac{105\\,\\sqrt{\\pi}}{16}\\right)^{2}\\,3628800} = \\frac{(945/32)^{2}}{(105/16)^{2}}\\,\\frac{40320}{3628800}.\n$$\n化简该比值：\n$$\n\\frac{(945/32)^{2}}{(105/16)^{2}} = \\left(\\frac{945}{32}\\cdot\\frac{16}{105}\\right)^{2} = \\left(\\frac{945}{105}\\cdot\\frac{16}{32}\\right)^{2} = \\left(9\\cdot\\frac{1}{2}\\right)^{2} = \\left(\\frac{9}{2}\\right)^{2} = \\frac{81}{4} = 20.25,\n$$\n以及\n$$\n\\frac{40320}{3628800} = \\frac{1}{90}.\n$$\n因此，\n$$\n\\frac{B\\!\\left(\\frac{11}{2},\\frac{11}{2}\\right)}{B\\!\\left(\\frac{9}{2},\\frac{9}{2}\\right)} = 20.25 \\times \\frac{1}{90} = \\frac{9}{40} = 0.225,\n$$\n以及\n$$\n\\overline{\\dot{\\omega}} = C \\times \\frac{9}{40}.\n$$\n当 $C = 1.0$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）时，$\\overline{\\dot{\\omega}} = \\frac{9}{40}$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）。\n\n第 3 步：在 $\\tilde{Z}$ 固定时的灵敏度 $\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}}$。\n\n我们改变 $v \\equiv \\widetilde{Z''^2}$，同时保持 $m \\equiv \\tilde{Z}$ 固定。参数 $(\\alpha,\\beta)$ 仅通过 $s$ 依赖于 $v$，其中\n$$\ns = \\frac{m(1-m)}{v} - 1,\\qquad \\alpha = m\\,s,\\qquad \\beta = (1-m)\\,s.\n$$\n对 $s$ 关于 $v$ 求导：\n$$\n\\frac{\\mathrm{d}s}{\\mathrm{d}v} = -\\frac{m(1-m)}{v^{2}}.\n$$\n因此，\n$$\n\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} = m\\,\\frac{\\mathrm{d}s}{\\mathrm{d}v} = -\\frac{m^{2}(1-m)}{v^{2}},\\qquad \\frac{\\mathrm{d}\\beta}{\\mathrm{d}v} = (1-m)\\,\\frac{\\mathrm{d}s}{\\mathrm{d}v} = -\\frac{m(1-m)^{2}}{v^{2}},\n$$\n以及\n$$\n\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} + \\frac{\\mathrm{d}\\beta}{\\mathrm{d}v} = -\\frac{m(1-m)}{v^{2}}.\n$$\n定义\n$$\nR(\\alpha,\\beta) \\equiv \\frac{B(\\alpha+p,\\beta+q)}{B(\\alpha,\\beta)},\\quad\\text{这样}\\quad \\overline{\\dot{\\omega}} = C\\,R(\\alpha,\\beta).\n$$\n我们通过链式法则计算 $\\frac{\\mathrm{d}R}{\\mathrm{d}v}$。使用关于 $\\alpha$ 和 $\\beta$ 的对数导数会很方便。回想欧拉 digamma 函数 $\\psi(x) \\equiv \\frac{\\mathrm{d}}{\\mathrm{d}x}\\ln\\Gamma(x)$ 以及\n$$\n\\frac{\\partial}{\\partial a}\\ln B(a,b) = \\psi(a) - \\psi(a+b),\\qquad \\frac{\\partial}{\\partial b}\\ln B(a,b) = \\psi(b) - \\psi(a+b).\n$$\n因此，\n$$\n\\frac{\\partial}{\\partial \\alpha}\\ln R = \\left[\\psi(\\alpha+p) - \\psi(\\alpha+p+\\beta+q)\\right] - \\left[\\psi(\\alpha) - \\psi(\\alpha+\\beta)\\right],\n$$\n$$\n\\frac{\\partial}{\\partial \\beta}\\ln R = \\left[\\psi(\\beta+q) - \\psi(\\alpha+p+\\beta+q)\\right] - \\left[\\psi(\\beta) - \\psi(\\alpha+\\beta)\\right].\n$$\n则\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = R\\left(\\frac{\\partial \\ln R}{\\partial \\alpha}\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} + \\frac{\\partial \\ln R}{\\partial \\beta}\\frac{\\mathrm{d}\\beta}{\\mathrm{d}v}\\right),\n$$\n以及\n$$\n\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial v} = C\\,\\frac{\\mathrm{d}R}{\\mathrm{d}v}.\n$$\n对于对称情况 $\\alpha=\\beta=\\frac{9}{2}$ 和 $(p,q)=(1,1)$，\n$$\n\\frac{\\partial}{\\partial \\alpha}\\ln R = \\left[\\psi\\!\\left(\\frac{11}{2}\\right) - \\psi(11)\\right] - \\left[\\psi\\!\\left(\\frac{9}{2}\\right) - \\psi(9)\\right],\n$$\n根据对称性，$\\frac{\\partial}{\\partial \\beta}\\ln R$ 是相同的。使用递推关系 $\\psi(x+1) = \\psi(x) + \\frac{1}{x}$ 以避免特殊值：\n$$\n\\psi\\!\\left(\\frac{11}{2}\\right) - \\psi\\!\\left(\\frac{9}{2}\\right) = \\frac{1}{\\frac{9}{2}} = \\frac{2}{9},\\qquad \\psi(11) - \\psi(9) = \\frac{1}{9} + \\frac{1}{10}.\n$$\n因此，\n$$\n\\left[\\psi\\!\\left(\\frac{11}{2}\\right) - \\psi(11)\\right] - \\left[\\psi\\!\\left(\\frac{9}{2}\\right) - \\psi(9)\\right] = \\left(\\frac{2}{9}\\right) - \\left(\\frac{1}{9} + \\frac{1}{10}\\right) = \\frac{1}{9} - \\frac{1}{10} = \\frac{1}{90}.\n$$\n因此，\n$$\n\\frac{\\partial \\ln R}{\\partial \\alpha} = \\frac{\\partial \\ln R}{\\partial \\beta} = \\frac{1}{90}.\n$$\n与 $\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} + \\frac{\\mathrm{d}\\beta}{\\mathrm{d}v} = -\\frac{m(1-m)}{v^{2}}$ 结合得到\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = R\\left(\\frac{1}{90}\\right)\\left(-\\frac{m(1-m)}{v^{2}}\\right).\n$$\n当 $m=0.5$ 且 $v=2.5\\times 10^{-2}$ 时，\n$$\n-\\frac{m(1-m)}{v^{2}} = -\\frac{0.25}{(2.5\\times 10^{-2})^{2}} = -\\frac{0.25}{6.25\\times 10^{-4}} = -400,\n$$\n所以\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = R\\times \\frac{1}{90}\\times(-400) = -R\\,\\frac{40}{9}.\n$$\n由于从第 2 步可知 $R = \\frac{9}{40}$，\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = -1,\n$$\n因此\n$$\n\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}} = C\\,\\frac{\\mathrm{d}R}{\\mathrm{d}v} = -C.\n$$\n对于 $C=1.0$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$），灵敏度为 $-1.0$（单位 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）。\n\n按指定顺序收集所求的量，\n$$\n\\alpha = \\frac{9}{2},\\qquad \\beta = \\frac{9}{2},\\qquad \\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}} = -1.\n$$\n这些值是精确值，因此不需要四舍五入。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{9}{2}  \\frac{9}{2}  -1\\end{pmatrix}}$$"
        },
        {
            "introduction": "这项高级练习将理论分析与现代计算科学方法相结合，引入了不确定性量化（UQ）这一前沿课题。在实际的计算流体力学（CFD）模拟中，模型的输入参数（如湍流模型常数或统计矩）本身就存在不确定性。本练习要求你设计一个蒙特卡洛（Monte Carlo）模拟程序，以评估混合分数方差的不确定性如何传播并影响最终预测的平均反应速率，这是模型验证和建立可信度中的关键一步 。",
            "id": "4038362",
            "problem": "考虑一个雷诺平均湍流非预混燃烧场景，其中平均反应速率通过使用贝塔概率密度函数（Beta PDF）对混合分数上的条件反应速率进行积分来建模。设混合分数为 $Z \\in [0,1]$，其 Favre 平均值和方差分别表示为 $\\widetilde{Z}$ 和 $\\widetilde{Z''^2}$。平均反应速率的封闭项为\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\int_{0}^{1} \\dot{\\omega}(Z)\\,P_{\\beta}(Z; a, b)\\,\\mathrm{d}Z,\n$$\n其中 $P_{\\beta}(Z; a, b)$ 是参数为 $a0$ 和 $b0$ 的贝塔概率密度函数，$\\dot{\\omega}(Z)$ 是条件反应速率。\n\n假设燃料和氧化剂之间发生单步混合限制不可逆反应，其局部反应速率建模为\n$$\n\\dot{\\omega}(Z) \\;=\\; k\\,\\rho\\,Z\\,(1-Z),\n$$\n其中 $k$ 是一个正常数动力学常数，$\\rho$ 是热力学密度。注意，在化学计量单步模型中，$Z$ 和 $(1-Z)$ 可作为燃料和氧化剂质量分数的代理。$\\overline{\\dot{\\omega}}$ 的单位必须以 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ 报告。\n\n贝塔概率密度函数的参数将根据 $Z$ 的平均值和方差确定。对于 $[0,1]$ 上的贝塔分布，其平均值 $\\mu$ 和方差 $\\sigma^2$ 通过以下公式与 $a$ 和 $b$ 相关：\n$$\n\\mu \\;=\\; \\frac{a}{a+b}, \\qquad \\sigma^2 \\;=\\; \\frac{a\\,b}{(a+b)^2\\,(a+b+1)}.\n$$\n通过设置 $\\mu = \\widetilde{Z}$ 和 $\\sigma^2 = \\widetilde{Z''^2}$，必须在满足可容许性约束 $0  \\widetilde{Z''^2}  \\widetilde{Z}\\,(1-\\widetilde{Z})$ 的条件下，从 $(\\widetilde{Z}, \\widetilde{Z''^2})$ 确定 $(a,b)$。\n\n不确定性模型。设方差 $\\widetilde{Z''^2}$ 是不确定的，并建模为对数正态分布，其中位数为 $v_{\\mathrm{med}}$，对数标准差为 $\\sigma_{\\ln}$，即 $\\ln(\\widetilde{Z''^2}) \\sim \\mathcal{N}(\\ln(v_{\\mathrm{med}}),\\,\\sigma_{\\ln}^2)$。贝塔概率密度函数的可容许性约束要求 $0  \\widetilde{Z''^2}  \\widetilde{Z}\\,(1-\\widetilde{Z})$。如果采样得到的方差超过了允许的上限，则强制执行 $ \\widetilde{Z''^2} \\leftarrow \\widetilde{Z}\\,(1-\\widetilde{Z}) - \\epsilon$，其中 $\\epsilon  0$ 是一个小数。\n\n任务。仅从上述定义以及从 $(\\widetilde{Z}, \\widetilde{Z''^2})$ 构建贝塔概率密度函数出发，设计一个程序来：\n- 通过蒙特卡洛（MC）方法，从指定的对数正态分布中对不确定方差 $\\widetilde{Z''^2}$ 进行采样，并如上所述强制执行可容许性。\n- 对于每个样本，构建与 $(\\widetilde{Z}, \\widetilde{Z''^2})$ 一致的贝塔概率密度函数参数 $(a,b)$。\n- 使用上述积分和指定的 $\\dot{\\omega}(Z)$，计算相应的平均反应速率 $\\overline{\\dot{\\omega}}$。\n- 汇总所有样本的 $\\overline{\\dot{\\omega}}$ 分布，并计算置信水平为 $\\alpha$（例如 $\\alpha = 0.95$）的双侧置信区间（CI）。\n- 同时，使用设置为中位数 $v_{\\mathrm{med}}$ 的名义方差（需满足可容许性），计算名义平均反应速率。\n\n以 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ 为单位，将名义平均反应速率和置信区间的界限报告为浮点数。\n\n为确保可复现性和可测试性，采样时使用固定的伪随机种子 $12345$。在强制执行可容许性上限时，为保证数值稳定性，对每个测试用例使用给定的 $\\epsilon$。\n\n测试套件。为以下测试用例实现该程序，这些用例共同探讨了一般情况、小方差情况、近最大方差情况和高平均混合分数情况：\n- 情况 1：$\\widetilde{Z} = 0.3$, $v_{\\mathrm{med}} = 0.01$, $\\sigma_{\\ln} = 0.3$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, MC 样本数 $N = 5000$, 置信水平 $\\alpha = 0.95$, $\\epsilon = 10^{-12}$。\n- 情况 2：$\\widetilde{Z} = 0.3$, $v_{\\mathrm{med}} = 10^{-5}$, $\\sigma_{\\ln} = 0.1$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $N = 5000$, $\\alpha = 0.95$, $\\epsilon = 10^{-12}$。\n- 情况 3：$\\widetilde{Z} = 0.5$, $v_{\\mathrm{med}} = 0.24$, $\\sigma_{\\ln} = 0.6$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $N = 8000$, $\\alpha = 0.95$, $\\epsilon = 10^{-12}$。\n- 情况 4：$\\widetilde{Z} = 0.95$, $v_{\\mathrm{med}} = 0.001$, $\\sigma_{\\ln} = 0.2$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $N = 5000$, $\\alpha = 0.95$, $\\epsilon = 10^{-12}$。\n\n输出规范。您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是一个三元素列表 $[\\text{nominal}, \\text{lower}, \\text{upper}]$。例如：\n$$\n[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]\n$$\n所有 $x_i$、$y_i$ 和 $z_i$ 必须报告为十进制浮点数，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，输出字符串中不包含单位符号。",
            "solution": "问题陈述已经过严格验证，并被确定为科学上合理、适定、客观和完整的。它代表了计算湍流燃烧领域中的一个标准问题，特别是关于平均反应速率封闭项的不确定性量化。因此，我们可以着手解决。\n\n核心任务是在混合分数方差 $\\widetilde{Z''^2}$ 存在不确定性的情况下，计算名义平均反应速率 $\\overline{\\dot{\\omega}}$ 及其置信区间。解决方案结合了燃烧模型的统计力学和计算蒙特卡洛方法。算法设计基于以下原理和推导。\n\n### 1. 平均反应速率的解析表达式\n\n平均反应速率 $\\overline{\\dot{\\omega}}$ 由条件反应速率 $\\dot{\\omega}(Z)$ 乘以混合分数 $Z$ 的概率密度函数（PDF）的积分定义，这里假定为贝塔概率密度函数 $P_{\\beta}(Z; a, b)$。\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\int_{0}^{1} \\dot{\\omega}(Z)\\,P_{\\beta}(Z; a, b)\\,\\mathrm{d}Z\n$$\n条件反应速率为 $\\dot{\\omega}(Z) = k\\,\\rho\\,Z\\,(1-Z)$，贝塔概率密度函数为 $P_{\\beta}(Z; a, b) = \\frac{Z^{a-1}(1-Z)^{b-1}}{B(a,b)}$，其中 $B(a,b)$ 是贝塔函数。将这些代入积分中得到：\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\int_{0}^{1} k\\,\\rho\\,Z\\,(1-Z) \\frac{Z^{a-1}(1-Z)^{b-1}}{B(a,b)} \\,\\mathrm{d}Z\n$$\n常数 $k$ 和 $\\rho$ 可以被提出，涉及 $Z$ 的项可以合并：\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\frac{k\\rho}{B(a,b)} \\int_{0}^{1} Z^{(a+1)-1}(1-Z)^{(b+1)-1} \\,\\mathrm{d}Z\n$$\n根据定义，剩余的积分是贝塔函数 $B(a+1, b+1)$。因此，平均反应速率由以下代数表达式给出：\n$$\n\\overline{\\dot{\\omega}} \\;=\\; k\\rho \\frac{B(a+1, b+1)}{B(a,b)}\n$$\n使用恒等式 $B(x,y) = \\frac{\\Gamma(x)\\Gamma(y)}{\\Gamma(x+y)}$ 和性质 $\\Gamma(z+1)=z\\Gamma(z)$，我们可以简化这个比率：\n$$\n\\frac{B(a+1, b+1)}{B(a,b)} \\;=\\; \\frac{\\Gamma(a+1)\\Gamma(b+1)}{\\Gamma(a+b+2)} \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)} \\;=\\; \\frac{a\\Gamma(a)b\\Gamma(b)}{(a+b+1)(a+b)\\Gamma(a+b)} \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)} \\;=\\; \\frac{ab}{(a+b)(a+b+1)}\n$$\n问题陈述中指出，贝塔概率密度函数的参数 $a$ 和 $b$ 是为了匹配混合分数的前两阶矩，即其平均值 $\\widetilde{Z}$ 和方差 $\\widetilde{Z''^2}$。关系为 $\\widetilde{Z} = \\frac{a}{a+b}$ 和 $\\widetilde{Z''^2} = \\frac{ab}{(a+b)^2(a+b+1)}$。\n从方差的关系式，我们可以写出：\n$$\n\\frac{ab}{(a+b)(a+b+1)} \\;=\\; \\widetilde{Z''^2} (a+b)\n$$\n和 $a+b$ 可以从平均值和方差的定义中找到：\n$$\n\\widetilde{Z''^2} \\;=\\; \\frac{a}{a+b}\\frac{b}{a+b}\\frac{1}{a+b+1} \\;=\\; \\widetilde{Z}(1-\\widetilde{Z})\\frac{1}{a+b+1} \\implies a+b+1 = \\frac{\\widetilde{Z}(1-\\widetilde{Z})}{\\widetilde{Z''^2}}\n$$\n这得到 $a+b = \\frac{\\widetilde{Z}(1-\\widetilde{Z})}{\\widetilde{Z''^2}} - 1$。将此代入速率项的表达式中：\n$$\n\\frac{ab}{(a+b)(a+b+1)} = \\widetilde{Z''^2} \\left( \\frac{\\widetilde{Z}(1-\\widetilde{Z})}{\\widetilde{Z''^2}} - 1 \\right) = \\widetilde{Z}(1-\\widetilde{Z}) - \\widetilde{Z''^2}\n$$\n这提供了一个非常简单的平均反应速率解析公式，它仅依赖于 $Z$ 的平均值和方差，而不依赖于 $a$ 和 $b$ 的具体值：\n$$\n\\overline{\\dot{\\omega}} \\;=\\; k\\rho \\left( \\widetilde{Z}(1-\\widetilde{Z}) - \\widetilde{Z''^2} \\right)\n$$\n这个公式计算上高效且稳健，构成了我们算法的基础。它是从给定的贝塔概率密度函数模型中严格推导出来的。\n\n### 2. 不确定性传播与算法设计\n\n方差 $\\widetilde{Z''^2}$ 被建模为一个不确定参数，遵循对数正态分布，即 $\\ln(\\widetilde{Z''^2}) \\sim \\mathcal{N}(\\ln(v_{\\mathrm{med}}),\\,\\sigma_{\\ln}^2)$。我们使用蒙特卡洛（MC）模拟来将这种不确定性传播到平均反应速率 $\\overline{\\dot{\\omega}}$。\n\n总体算法如下：\n1.  **初始化**：对于每个测试用例，获取参数：平均混合分数 $\\widetilde{Z}$、方差中位数 $v_{\\mathrm{med}}$、对数标准差 $\\sigma_{\\ln}$、动力学常数 $k$、密度 $\\rho$、MC 样本数 $N$、置信水平 $\\alpha$ 和稳定性参数 $\\epsilon$。为保证所有情况的可复现性，一次性设置固定的伪随机种子。\n\n2.  **名义计算**：名义平均反应速率 $\\overline{\\dot{\\omega}}_{\\text{nom}}$ 使用方差的中位数 $v_{\\mathrm{med}}$ 计算。\n    *   物理上允许的最大方差是 $V_{\\max} = \\widetilde{Z}(1-\\widetilde{Z})$。\n    *   名义方差为满足可容许性而设置上限：$\\widetilde{Z''^2}_{\\text{nom}} = \\min(v_{\\mathrm{med}}, V_{\\max} - \\epsilon)$。\n    *   名义速率计算为 $\\overline{\\dot{\\omega}}_{\\text{nom}} = k\\rho (V_{\\max} - \\widetilde{Z''^2}_{\\text{nom}})$。\n\n3.  **蒙特卡洛模拟**：\n    *   从正态分布 $\\mathcal{N}(\\ln(v_{\\mathrm{med}}),\\,\\sigma_{\\ln}^2)$ 中生成 $N$ 个 $\\ln(\\widetilde{Z''^2})$ 的随机样本。\n    *   对这些样本进行指数运算，以获得 $N$ 个 $\\widetilde{Z''^2}$ 的样本。\n    *   通过向量化操作对所有样本强制执行可容许性约束：对于每个样本 $\\widetilde{Z''^2}_i$，其值更新为 $\\min(\\widetilde{Z''^2}_i, V_{\\max} - \\epsilon)$。\n    *   对于 $N$ 个满足可容许性的方差样本 $\\widetilde{Z''^2}_i$ 中的每一个，计算相应的平均反应速率 $\\overline{\\dot{\\omega}}_i = k\\rho (V_{\\max} - \\widetilde{Z''^2}_i)$。这将产生一个包含 $N$ 个 $\\overline{\\dot{\\omega}}$ 可能结果的分布。\n\n4.  **置信区间（CI）计算**：\n    *   双侧置信区间由计算出的 $N$ 个 $\\overline{\\dot{\\omega}}_i$ 值的经验分布确定。\n    *   下分位数和上分位数水平计算为 $q_{\\text{lower}} = (1-\\alpha)/2$ 和 $q_{\\text{upper}} = 1 - (1-\\alpha)/2$。\n    *   通过计算排序后的 $\\overline{\\dot{\\omega}}$ 样本的相应百分位数，找到置信区间的下限和上限。\n\n5.  **输出格式化**：每个测试用例的结果——名义速率、置信区间下限和置信区间上限——被收集并格式化为指定的列表的列表字符串格式。\n\n这种有原则的设计通过使用推导出的解析公式确保了科学正确性，并使用向量化蒙特卡洛采样提供了一种稳健的计算策略来量化不确定性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_rate_stats(Z_mean, V_med, sigma_ln, k, rho, N, alpha, eps, rng):\n    \"\"\"\n    Computes nominal rate and confidence interval for the mean reaction rate.\n\n    Args:\n        Z_mean (float): Favre-averaged mean of mixture fraction.\n        V_med (float): Median of the mixture fraction variance.\n        sigma_ln (float): Logarithmic standard deviation of the variance.\n        k (float): Kinetic constant.\n        rho (float): Thermodynamic density.\n        N (int): Number of Monte Carlo samples.\n        alpha (float): Confidence level for the interval.\n        eps (float): Small positive number for enforcing admissibility.\n        rng (np.random.Generator): NumPy random number generator instance.\n\n    Returns:\n        tuple[float, float, float]: Nominal rate, CI lower bound, CI upper bound.\n    \"\"\"\n    # Maximum physical variance\n    V_max = Z_mean * (1.0 - Z_mean)\n\n    # --- Nominal Calculation ---\n    # Enforce admissibility for the nominal variance\n    V_nom = min(V_med, V_max - eps)\n    # Ensure variance is positive\n    V_nom = max(V_nom, 0.0)\n\n    # Calculate nominal mean reaction rate\n    omega_nom = k * rho * (V_max - V_nom)\n\n    # --- Monte Carlo Simulation ---\n    # Generate N samples of log(variance) from a normal distribution\n    log_V_samples = rng.normal(loc=np.log(V_med), scale=sigma_ln, size=N)\n\n    # Exponentiate to get samples of variance\n    V_samples = np.exp(log_V_samples)\n\n    # Enforce admissibility constraint on all samples\n    V_samples = np.minimum(V_samples, V_max - eps)\n    # Ensure variance is positive\n    V_samples = np.maximum(V_samples, 0.0)\n\n    # Calculate the mean reaction rate for each sample\n    omega_samples = k * rho * (V_max - V_samples)\n\n    # --- Confidence Interval Calculation ---\n    # Calculate quantile levels\n    q_lower = (1.0 - alpha) / 2.0 * 100.0\n    q_upper = (1.0 + alpha) / 2.0 * 100.0\n    \n    # Compute the confidence interval using percentiles\n    ci_lower = np.percentile(omega_samples, q_lower)\n    ci_upper = np.percentile(omega_samples, q_upper)\n\n    return omega_nom, ci_lower, ci_upper\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Use a fixed pseudo-random seed for reproducibility.\n    # The problem specifies a single seed for the entire suite of tests.\n    rng = np.random.default_rng(12345)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: General case\n        {'Z_mean': 0.3, 'V_med': 0.01, 'sigma_ln': 0.3, 'k': 5.0, 'rho': 1.2, 'N': 5000, 'alpha': 0.95, 'eps': 1e-12},\n        # Case 2: Small-variance case\n        {'Z_mean': 0.3, 'V_med': 1e-5, 'sigma_ln': 0.1, 'k': 5.0, 'rho': 1.2, 'N': 5000, 'alpha': 0.95, 'eps': 1e-12},\n        # Case 3: Near-maximum-variance case\n        {'Z_mean': 0.5, 'V_med': 0.24, 'sigma_ln': 0.6, 'k': 5.0, 'rho': 1.2, 'N': 8000, 'alpha': 0.95, 'eps': 1e-12},\n        # Case 4: High-mean-mixture-fraction case\n        {'Z_mean': 0.95, 'V_med': 0.001, 'sigma_ln': 0.2, 'k': 5.0, 'rho': 1.2, 'N': 5000, 'alpha': 0.95, 'eps': 1e-12},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate the result for one case.\n        result = compute_rate_stats(\n            Z_mean=case['Z_mean'],\n            V_med=case['V_med'],\n            sigma_ln=case['sigma_ln'],\n            k=case['k'],\n            rho=case['rho'],\n            N=case['N'],\n            alpha=case['alpha'],\n            eps=case['eps'],\n            rng=rng\n        )\n        results.append(list(result))\n\n    # Format the final output string exactly as specified.\n    inner_parts = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}