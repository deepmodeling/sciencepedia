{
    "hands_on_practices": [
        {
            "introduction": "The strong nonlinearity of the Arrhenius reaction rate is the central challenge in turbulent combustion modeling. This practice explores this fundamental issue by examining how temperature fluctuations, here modeled with a Gaussian distribution, affect the mean reaction rate. By deriving the mean rate from first principles, you will uncover the origin of the \"turbulence-chemistry interaction\" term and understand why simply using the mean temperature in the Arrhenius law leads to significant errors .",
            "id": "4038286",
            "problem": "Consider a statistically stationary, homogeneous turbulent reacting flow in which the instantaneous reaction rate for a single-step reaction is modeled (after appropriate non-dimensionalization and isolation of prefactors and composition effects) as $\\dot{\\omega}(\\theta)=\\exp(\\theta)$, where the activation variable $\\theta$ is defined by $\\theta=-E_a/(R T)$ with $E_a$ the activation energy, $R$ the universal gas constant, and $T$ the instantaneous temperature. Assume that turbulent temperature fluctuations render $\\theta$ a random variable that is Gaussian with mean $\\mu$ and variance $\\sigma^2$, denoted $\\theta \\sim \\mathcal{N}(\\mu,\\sigma^2)$. Let the Reynolds average (ensemble average) of the reaction rate be denoted by $\\overline{\\dot{\\omega}}=\\langle \\dot{\\omega} \\rangle$. \n\nStarting from (i) the definition of the Reynolds average as an expectation with respect to the probability density function (PDF) of $\\theta$ and (ii) the standard Gaussian PDF, derive a closed-form expression for $\\overline{\\dot{\\omega}}$ in terms of $\\mu$ and $\\sigma^2$ without invoking any pre-stated special function identities. Then, interpret the multiplicative bias factor that relates $\\overline{\\dot{\\omega}}$ to the naive “plug-in-the-mean” Arrhenius estimate $\\exp(\\overline{\\theta})=\\exp(\\mu)$, explaining how it arises from the nonlinearity of the exponential and the statistics of $\\theta$ in turbulent combustion.\n\nAssume that $\\dot{\\omega}$ is non-dimensionalized. Express your final answer as a single closed-form analytic expression for $\\overline{\\dot{\\omega}}$. No numerical rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of turbulent combustion theory, well-posed, objective, and contains a complete and consistent set of premises. We proceed with the derivation.\n\nThe primary objective is to compute the Reynolds average of the instantaneous reaction rate, $\\overline{\\dot{\\omega}}$. By definition, for a random variable $\\theta$ with a probability density function (PDF) $P(\\theta)$, the expectation (or Reynolds average) of a function $f(\\theta)$ is given by:\n$$\n\\langle f(\\theta) \\rangle = \\int_{-\\infty}^{\\infty} f(\\theta) P(\\theta) \\, d\\theta\n$$\nIn this problem, the function is the non-dimensional reaction rate, $\\dot{\\omega}(\\theta) = \\exp(\\theta)$, and the random variable $\\theta$ follows a Gaussian distribution, $\\theta \\sim \\mathcal{N}(\\mu, \\sigma^2)$. The PDF for a Gaussian distribution is:\n$$\nP(\\theta) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right)\n$$\nwhere $\\mu$ is the mean and $\\sigma^2$ is the variance of $\\theta$.\n\nWe can now construct the integral for the mean reaction rate, $\\overline{\\dot{\\omega}} = \\langle \\dot{\\omega}(\\theta) \\rangle$:\n$$\n\\overline{\\dot{\\omega}} = \\int_{-\\infty}^{\\infty} \\exp(\\theta) \\left[ \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\right] \\, d\\theta\n$$\nThe constant prefactor can be moved outside the integral:\n$$\n\\overline{\\dot{\\omega}} = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp(\\theta) \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\, d\\theta\n$$\nWe combine the two exponential terms by adding their arguments:\n$$\n\\overline{\\dot{\\omega}} = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(\\theta - \\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\, d\\theta\n$$\nTo solve this integral, we must manipulate the argument of the exponential into the form of a quadratic, which will allow us to use the properties of the Gaussian integral. Let us expand the argument:\n$$\n\\theta - \\frac{(\\theta-\\mu)^2}{2\\sigma^2} = \\theta - \\frac{\\theta^2 - 2\\mu\\theta + \\mu^2}{2\\sigma^2} = \\frac{2\\sigma^2\\theta - (\\theta^2 - 2\\mu\\theta + \\mu^2)}{2\\sigma^2} = -\\frac{1}{2\\sigma^2} (\\theta^2 - 2\\mu\\theta - 2\\sigma^2\\theta + \\mu^2)\n$$\n$$\n= -\\frac{1}{2\\sigma^2} [\\theta^2 - 2(\\mu+\\sigma^2)\\theta + \\mu^2]\n$$\nNow, we complete the square for the quadratic expression in $\\theta$ inside the brackets. For a general quadratic $x^2 + bx + c$, we write it as $(x+b/2)^2 - (b/2)^2 + c$. Here, our variable is $\\theta$ and the coefficient of the linear term is $-2(\\mu+\\sigma^2)$.\n$$\n\\theta^2 - 2(\\mu+\\sigma^2)\\theta + \\mu^2 = \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - (\\mu+\\sigma^2)^2 + \\mu^2\n$$\nExpanding the squared term we subtracted:\n$$\n= \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - (\\mu^2 + 2\\mu\\sigma^2 + \\sigma^4) + \\mu^2\n$$\n$$\n= \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - 2\\mu\\sigma^2 - \\sigma^4\n$$\nSubstituting this back into the argument of the exponential:\n$$\n-\\frac{1}{2\\sigma^2} \\left( \\left[\\theta - (\\mu+\\sigma^2)\\right]^2 - 2\\mu\\sigma^2 - \\sigma^4 \\right) = -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} + \\frac{2\\mu\\sigma^2 + \\sigma^4}{2\\sigma^2}\n$$\n$$\n= -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} + \\mu + \\frac{\\sigma^2}{2}\n$$\nNow we substitute this simplified expression back into the integral for $\\overline{\\dot{\\omega}}$:\n$$\n\\overline{\\dot{\\omega}} = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} + \\mu + \\frac{\\sigma^2}{2} \\right) \\, d\\theta\n$$\nThe term $\\exp(\\mu + \\sigma^2/2)$ does not depend on $\\theta$ and can be factored out of the integral:\n$$\n\\overline{\\dot{\\omega}} = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left( -\\frac{\\left[\\theta - (\\mu+\\sigma^2)\\right]^2}{2\\sigma^2} \\right) \\, d\\theta\n$$\nThe remaining integral is the integral of a Gaussian PDF over its entire domain. Specifically, it is the PDF of a Gaussian random variable with mean $\\mu' = \\mu+\\sigma^2$ and variance $\\sigma^2$. The integral of any probability density function over its domain $(-\\infty, \\infty)$ is equal to $1$.\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left( -\\frac{\\left[\\theta - \\mu'\\right]^2}{2\\sigma^2} \\right) \\, d\\theta = 1\n$$\nTherefore, the mean reaction rate simplifies to:\n$$\n\\overline{\\dot{\\omega}} = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)\n$$\nThis is the closed-form expression for the mean reaction rate.\n\nFor the interpretation, we compare this result to the naive \"plug-in-the-mean\" estimate. This simpler approach would be to evaluate the reaction rate function at the mean value of the input variable, $\\overline{\\theta} = \\mu$. This gives:\n$$\n\\dot{\\omega}_{\\text{naive}} = \\dot{\\omega}(\\overline{\\theta}) = \\dot{\\omega}(\\mu) = \\exp(\\mu)\n$$\nThe relationship between the true mean rate and the naive estimate is:\n$$\n\\overline{\\dot{\\omega}} = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right) = \\exp(\\mu) \\exp\\left(\\frac{\\sigma^2}{2}\\right) = \\dot{\\omega}_{\\text{naive}} \\cdot \\exp\\left(\\frac{\\sigma^2}{2}\\right)\n$$\nThe multiplicative bias factor is $\\exp(\\sigma^2/2)$. This factor is always greater than or equal to $1$, since $\\sigma^2 \\ge 0$. The true mean rate is therefore always greater than or equal to the rate evaluated at the mean temperature. This result is a direct consequence of Jensen's inequality, which states that for a convex function $f$, $\\langle f(X) \\rangle \\ge f(\\langle X \\rangle)$. The exponential function $f(\\theta) = \\exp(\\theta)$ is strictly convex, so $\\langle \\exp(\\theta) \\rangle > \\exp(\\langle \\theta \\rangle)$ for any non-zero variance $\\sigma^2 > 0$.\n\nThe physical origin of this bias lies in the strong nonlinearity of the Arrhenius kinetics. The reaction rate is exponentially sensitive to temperature. In a turbulent flow, temperature fluctuates. High-temperature excursions (hot spots, corresponding to positive fluctuations in $\\theta$) increase the reaction rate dramatically. Low-temperature excursions (cold spots, corresponding to negative fluctuations in $\\theta$) decrease the rate, but far less dramatically. Because the exponential function 'rewards' high temperatures much more than it 'penalizes' low temperatures, the average rate is skewed high and is dominated by the contributions from the fleeting moments of high temperature. The variance $\\sigma^2$ quantifies the intensity of these temperature fluctuations. A larger variance implies stronger turbulence and more extreme temperature fluctuations, leading to a larger bias factor $\\exp(\\sigma^2/2)$ and a more severe failure of the naive \"plug-in-the-mean\" model. This is a central problem in turbulent combustion modeling, known as the reaction rate closure problem.",
            "answer": "$$\n\\boxed{\\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)}\n$$"
        },
        {
            "introduction": "The presumed Probability Density Function (PDF) method is a powerful tool for closing the mean reaction rate in non-premixed flames. This exercise provides hands-on experience with the widely used Beta PDF model, guiding you through the essential steps of matching its parameters to moments from a turbulence model, like the mean and variance of the mixture fraction. You will then compute the mean reaction rate and perform a sensitivity analysis, a key skill for evaluating model behavior and uncertainty .",
            "id": "4038357",
            "problem": "A non-premixed turbulent jet flame is modeled within the Reynolds Averaged Navier–Stokes (RANS) framework. The mixture fraction $Z \\in [0,1]$ is treated as a random variable whose Favre-averaged statistics $\\tilde{Z}$ and $\\widetilde{Z''^2}$ are used to parameterize a Beta Probability Density Function (PDF) closure for scalar mixing. The Favre-averaged mixture fraction and its variance at a selected location are reported as $\\tilde{Z} = 0.50$ and $\\widetilde{Z''^2} = 2.5 \\times 10^{-2}$. The mean reaction rate closure for a single-step model is constructed by integrating a conditional reaction rate $\\dot{\\omega}(Z)$ against the Beta PDF for $Z$, assuming the conditional model\n$$\n\\dot{\\omega}(Z) = C\\,Z^{p}\\,(1-Z)^{q},\n$$\nwith $p=q=1$ and a calibration constant $C = 1.0$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$. Assume the Beta PDF parameterization is consistent with the reported $\\tilde{Z}$ and $\\widetilde{Z''^2}$ and that the Favre averaging and PDF closure are valid.\n\nStarting from fundamental definitions and well-tested facts about PDFs and moment matching, carry out the following:\n\n1. Use the given $\\tilde{Z}$ and $\\widetilde{Z''^2}$ to derive the Beta PDF parameters $(\\alpha,\\beta)$ from first principles, without invoking any pre-stated parameter formulas as a shortcut. Explicitly demonstrate the steps needed to obtain $(\\alpha,\\beta)$ in terms of the reported mean and variance.\n\n2. Using the definition of the Beta function and properties of the Gamma function, express the Favre-mean reaction rate $\\overline{\\dot{\\omega}}$ as a ratio of Beta functions and evaluate it for the derived $(\\alpha,\\beta)$ and the given $(p,q,C)$.\n\n3. Compute the sensitivity of the mean reaction rate $\\overline{\\dot{\\omega}}$ with respect to the variance $\\widetilde{Z''^2}$ at fixed $\\tilde{Z}$, that is, evaluate $\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}}$ at the given $(\\tilde{Z},\\widetilde{Z''^2})$. Express this sensitivity in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nProvide the final answer as a single row matrix containing the Beta parameters and the requested sensitivity, in the order $\\alpha$, $\\beta$, $\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}}$. If any numerical approximation is required, round your answer to four significant figures. Otherwise, present exact values.",
            "solution": "The mixture fraction $Z$ is a bounded scalar taking values in $[0,1]$. In RANS closures for non-premixed combustion, a common practice is to represent the distribution of $Z$ with a Beta Probability Density Function (PDF) characterized by two positive parameters $(\\alpha,\\beta)$. The Beta PDF is\n$$\nf_{Z}(z;\\alpha,\\beta) = \\frac{z^{\\alpha-1}(1-z)^{\\beta-1}}{B(\\alpha,\\beta)},\\quad 0 \\le z \\le 1,\n$$\nwhere $B(\\alpha,\\beta)$ is the Beta function defined via the Gamma function $\\Gamma(\\cdot)$ as\n$$\nB(\\alpha,\\beta) = \\frac{\\Gamma(\\alpha)\\,\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}.\n$$\nThe first two moments of a Beta distribution are well-known facts:\n$$\n\\mathbb{E}[Z] = \\frac{\\alpha}{\\alpha+\\beta},\\qquad \\mathrm{Var}(Z) = \\frac{\\alpha\\,\\beta}{(\\alpha+\\beta)^{2}(\\alpha+\\beta+1)}.\n$$\nIn Favre averaging, the mixture fraction mean and variance are often matched to these expressions (the Favre weight does not alter the algebra of moment matching when the closure uses the same moments). Denote $m \\equiv \\tilde{Z}$ and $v \\equiv \\widetilde{Z''^2}$, treated as the mean and variance used in the parameter fit.\n\nStep 1: Derive $(\\alpha,\\beta)$ from $m$ and $v$.\n\nIntroduce the sum $s \\equiv \\alpha+\\beta$. The mean condition gives\n$$\nm = \\frac{\\alpha}{s}\\quad\\Rightarrow\\quad \\alpha = m\\,s,\\qquad \\beta = (1-m)\\,s.\n$$\nSubstitute these into the variance:\n$$\nv = \\frac{\\alpha\\,\\beta}{s^{2}(s+1)} = \\frac{m\\,s\\,(1-m)\\,s}{s^{2}(s+1)} = \\frac{m(1-m)}{s+1}.\n$$\nSolve for $s$:\n$$\ns+1 = \\frac{m(1-m)}{v}\\quad\\Rightarrow\\quad s = \\frac{m(1-m)}{v} - 1.\n$$\nThen\n$$\n\\alpha = m\\left(\\frac{m(1-m)}{v} - 1\\right),\\qquad \\beta = (1-m)\\left(\\frac{m(1-m)}{v} - 1\\right).\n$$\nWith the given values $m = 0.50$ and $v = 2.5\\times 10^{-2}$,\n$$\nm(1-m) = 0.5\\times 0.5 = 0.25,\\qquad s = \\frac{0.25}{2.5\\times 10^{-2}} - 1 = 10 - 1 = 9.\n$$\nTherefore,\n$$\n\\alpha = m\\,s = 0.5\\times 9 = \\frac{9}{2},\\qquad \\beta = (1-m)\\,s = 0.5\\times 9 = \\frac{9}{2}.\n$$\n\nStep 2: Express $\\overline{\\dot{\\omega}}$ and evaluate it.\n\nThe mean reaction rate closure is obtained by integrating the conditional reaction rate $\\dot{\\omega}(Z)$ against the PDF of $Z$:\n$$\n\\overline{\\dot{\\omega}} = \\int_{0}^{1} \\dot{\\omega}(z)\\,f_{Z}(z;\\alpha,\\beta)\\,\\mathrm{d}z = \\frac{C}{B(\\alpha,\\beta)}\\int_{0}^{1} z^{p+\\alpha-1}(1-z)^{q+\\beta-1}\\,\\mathrm{d}z.\n$$\nUsing the definition of the Beta function,\n$$\n\\int_{0}^{1} z^{A-1}(1-z)^{B-1}\\,\\mathrm{d}z = B(A,B),\n$$\nwe obtain\n$$\n\\overline{\\dot{\\omega}} = C\\,\\frac{B(\\alpha+p,\\beta+q)}{B(\\alpha,\\beta)}.\n$$\nWith $p=q=1$ and $\\alpha=\\beta=9/2$,\n$$\n\\overline{\\dot{\\omega}} = C\\,\\frac{B\\!\\left(\\frac{11}{2},\\frac{11}{2}\\right)}{B\\!\\left(\\frac{9}{2},\\frac{9}{2}\\right)} = C\\,\\frac{\\Gamma\\!\\left(\\frac{11}{2}\\right)^{2}\\,\\Gamma(9)}{\\Gamma\\!\\left(11\\right)\\,\\Gamma\\!\\left(\\frac{9}{2}\\right)^{2}}.\n$$\nUse the half-integer Gamma values via recurrence $\\Gamma(x+1) = x\\,\\Gamma(x)$ and $\\Gamma\\!\\left(\\frac{1}{2}\\right) = \\sqrt{\\pi}$:\n$$\n\\Gamma\\!\\left(\\frac{9}{2}\\right) = \\frac{105\\,\\sqrt{\\pi}}{16},\\qquad \\Gamma\\!\\left(\\frac{11}{2}\\right) = \\frac{945\\,\\sqrt{\\pi}}{32},\\qquad \\Gamma(9) = 8! = 40320,\\qquad \\Gamma(11) = 10! = 3628800.\n$$\nHence,\n$$\n\\frac{B\\!\\left(\\frac{11}{2},\\frac{11}{2}\\right)}{B\\!\\left(\\frac{9}{2},\\frac{9}{2}\\right)} = \\frac{\\left(\\frac{945\\,\\sqrt{\\pi}}{32}\\right)^{2}\\,40320}{\\left(\\frac{105\\,\\sqrt{\\pi}}{16}\\right)^{2}\\,3628800} = \\frac{(945/32)^{2}}{(105/16)^{2}}\\,\\frac{40320}{3628800}.\n$$\nSimplify the ratio:\n$$\n\\frac{(945/32)^{2}}{(105/16)^{2}} = \\left(\\frac{945}{32}\\cdot\\frac{16}{105}\\right)^{2} = \\left(\\frac{945}{105}\\cdot\\frac{16}{32}\\right)^{2} = \\left(9\\cdot\\frac{1}{2}\\right)^{2} = \\left(\\frac{9}{2}\\right)^{2} = \\frac{81}{4} = 20.25,\n$$\nand\n$$\n\\frac{40320}{3628800} = \\frac{1}{90}.\n$$\nTherefore,\n$$\n\\frac{B\\!\\left(\\frac{11}{2},\\frac{11}{2}\\right)}{B\\!\\left(\\frac{9}{2},\\frac{9}{2}\\right)} = 20.25 \\times \\frac{1}{90} = \\frac{9}{40} = 0.225,\n$$\nand\n$$\n\\overline{\\dot{\\omega}} = C \\times \\frac{9}{40}.\n$$\nWith $C = 1.0$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, $\\overline{\\dot{\\omega}} = \\frac{9}{40}$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nStep 3: Sensitivity $\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}}$ at fixed $\\tilde{Z}$.\n\nWe vary $v \\equiv \\widetilde{Z''^2}$ while holding $m \\equiv \\tilde{Z}$ fixed. The parameters $(\\alpha,\\beta)$ depend on $v$ only through $s$, with\n$$\ns = \\frac{m(1-m)}{v} - 1,\\qquad \\alpha = m\\,s,\\qquad \\beta = (1-m)\\,s.\n$$\nDifferentiate $s$ with respect to $v$:\n$$\n\\frac{\\mathrm{d}s}{\\mathrm{d}v} = -\\frac{m(1-m)}{v^{2}}.\n$$\nThus,\n$$\n\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} = m\\,\\frac{\\mathrm{d}s}{\\mathrm{d}v} = -\\frac{m^{2}(1-m)}{v^{2}},\\qquad \\frac{\\mathrm{d}\\beta}{\\mathrm{d}v} = (1-m)\\,\\frac{\\mathrm{d}s}{\\mathrm{d}v} = -\\frac{m(1-m)^{2}}{v^{2}},\n$$\nand\n$$\n\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} + \\frac{\\mathrm{d}\\beta}{\\mathrm{d}v} = -\\frac{m(1-m)}{v^{2}}.\n$$\nDefine\n$$\nR(\\alpha,\\beta) \\equiv \\frac{B(\\alpha+p,\\beta+q)}{B(\\alpha,\\beta)},\\quad\\text{so that}\\quad \\overline{\\dot{\\omega}} = C\\,R(\\alpha,\\beta).\n$$\nWe compute $\\frac{\\mathrm{d}R}{\\mathrm{d}v}$ via the chain rule. It is convenient to use the logarithmic derivative with respect to $\\alpha$ and $\\beta$. Recall the Euler digamma function $\\psi(x) \\equiv \\frac{\\mathrm{d}}{\\mathrm{d}x}\\ln\\Gamma(x)$ and that\n$$\n\\frac{\\partial}{\\partial a}\\ln B(a,b) = \\psi(a) - \\psi(a+b),\\qquad \\frac{\\partial}{\\partial b}\\ln B(a,b) = \\psi(b) - \\psi(a+b).\n$$\nTherefore,\n$$\n\\frac{\\partial}{\\partial \\alpha}\\ln R = \\left[\\psi(\\alpha+p) - \\psi(\\alpha+p+\\beta+q)\\right] - \\left[\\psi(\\alpha) - \\psi(\\alpha+\\beta)\\right],\n$$\n$$\n\\frac{\\partial}{\\partial \\beta}\\ln R = \\left[\\psi(\\beta+q) - \\psi(\\alpha+p+\\beta+q)\\right] - \\left[\\psi(\\beta) - \\psi(\\alpha+\\beta)\\right].\n$$\nThen\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = R\\left(\\frac{\\partial \\ln R}{\\partial \\alpha}\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} + \\frac{\\partial \\ln R}{\\partial \\beta}\\frac{\\mathrm{d}\\beta}{\\mathrm{d}v}\\right),\n$$\nand\n$$\n\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial v} = C\\,\\frac{\\mathrm{d}R}{\\mathrm{d}v}.\n$$\nFor the symmetric case $\\alpha=\\beta=\\frac{9}{2}$ and $(p,q)=(1,1)$,\n$$\n\\frac{\\partial}{\\partial \\alpha}\\ln R = \\left[\\psi\\!\\left(\\frac{11}{2}\\right) - \\psi(11)\\right] - \\left[\\psi\\!\\left(\\frac{9}{2}\\right) - \\psi(9)\\right],\n$$\nand by symmetry $\\frac{\\partial}{\\partial \\beta}\\ln R$ is identical. Use the recurrence $\\psi(x+1) = \\psi(x) + \\frac{1}{x}$ to avoid special values:\n$$\n\\psi\\!\\left(\\frac{11}{2}\\right) - \\psi\\!\\left(\\frac{9}{2}\\right) = \\frac{1}{\\frac{9}{2}} = \\frac{2}{9},\\qquad \\psi(11) - \\psi(9) = \\frac{1}{9} + \\frac{1}{10}.\n$$\nHence,\n$$\n\\left[\\psi\\!\\left(\\frac{11}{2}\\right) - \\psi(11)\\right] - \\left[\\psi\\!\\left(\\frac{9}{2}\\right) - \\psi(9)\\right] = \\left(\\frac{2}{9}\\right) - \\left(\\frac{1}{9} + \\frac{1}{10}\\right) = \\frac{1}{9} - \\frac{1}{10} = \\frac{1}{90}.\n$$\nTherefore,\n$$\n\\frac{\\partial \\ln R}{\\partial \\alpha} = \\frac{\\partial \\ln R}{\\partial \\beta} = \\frac{1}{90}.\n$$\nCombine with $\\frac{\\mathrm{d}\\alpha}{\\mathrm{d}v} + \\frac{\\mathrm{d}\\beta}{\\mathrm{d}v} = -\\frac{m(1-m)}{v^{2}}$ to obtain\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = R\\left(\\frac{1}{90}\\right)\\left(-\\frac{m(1-m)}{v^{2}}\\right).\n$$\nWith $m=0.5$ and $v=2.5\\times 10^{-2}$,\n$$\n-\\frac{m(1-m)}{v^{2}} = -\\frac{0.25}{(2.5\\times 10^{-2})^{2}} = -\\frac{0.25}{6.25\\times 10^{-4}} = -400,\n$$\nso\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = R\\times \\frac{1}{90}\\times(-400) = -R\\,\\frac{40}{9}.\n$$\nSince $R = \\frac{9}{40}$ from Step 2,\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}v} = -1,\n$$\nand thus\n$$\n\\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}} = C\\,\\frac{\\mathrm{d}R}{\\mathrm{d}v} = -C.\n$$\nFor $C=1.0$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, the sensitivity is $-1.0$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nCollecting the requested quantities in the specified order,\n$$\n\\alpha = \\frac{9}{2},\\qquad \\beta = \\frac{9}{2},\\qquad \\frac{\\partial \\overline{\\dot{\\omega}}}{\\partial \\widetilde{Z''^2}} = -1.\n$$\nNo rounding is required because these values are exact.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{9}{2} & \\frac{9}{2} & -1\\end{pmatrix}}$$"
        },
        {
            "introduction": "Building robust predictive models requires not only computing a single answer but also understanding its reliability. This computational practice delves into uncertainty quantification by propagating uncertainty from a turbulence model input—the mixture fraction variance—to the final mean reaction rate. You will implement a Monte Carlo simulation based on a Beta PDF closure, providing a practical introduction to methods used to assess the confidence in computational combustion predictions .",
            "id": "4038362",
            "problem": "Consider a Reynolds-averaged turbulent nonpremixed combustion scenario in which the mean reaction rate is modeled by integrating a conditional reaction rate over the mixture fraction using a Beta Probability Density Function (Beta PDF). Let the mixture fraction be denoted by $Z \\in [0,1]$, and its Favre-averaged mean and variance be denoted by $\\widetilde{Z}$ and $\\widetilde{Z''^2}$, respectively. The mean reaction rate closure is\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\int_{0}^{1} \\dot{\\omega}(Z)\\,P_{\\beta}(Z; a, b)\\,\\mathrm{d}Z,\n$$\nwhere $P_{\\beta}(Z; a, b)$ is the Beta PDF with parameters $a>0$ and $b>0$, and $\\dot{\\omega}(Z)$ is the conditional reaction rate.\n\nAssume a single-step mixing-limited irreversible reaction between a fuel and an oxidizer with local reaction rate modeled as\n$$\n\\dot{\\omega}(Z) \\;=\\; k\\,\\rho\\,Z\\,(1-Z),\n$$\nwhere $k$ is a positive kinetic constant and $\\rho$ is the thermodynamic density. Note that $Z$ and $(1-Z)$ serve as proxies for fuel and oxidizer mass fractions in a stoichiometric single-step model. The units of $\\overline{\\dot{\\omega}}$ must be reported in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\nThe Beta PDF parameters are to be determined from the mean and variance of $Z$. For a Beta distribution on $[0,1]$, the mean $\\mu$ and variance $\\sigma^2$ are related to $a$ and $b$ by\n$$\n\\mu \\;=\\; \\frac{a}{a+b}, \\qquad \\sigma^2 \\;=\\; \\frac{a\\,b}{(a+b)^2\\,(a+b+1)}.\n$$\nBy setting $\\mu = \\widetilde{Z}$ and $\\sigma^2 = \\widetilde{Z''^2}$, one must determine $(a,b)$ from $(\\widetilde{Z}, \\widetilde{Z''^2})$ subject to the admissibility constraint $0 < \\widetilde{Z''^2} < \\widetilde{Z}\\,(1-\\widetilde{Z})$.\n\nUncertainty model. Let the variance $\\widetilde{Z''^2}$ be uncertain and modeled as log-normal with median $v_{\\mathrm{med}}$ and logarithmic standard deviation $\\sigma_{\\ln}$, namely $\\ln(\\widetilde{Z''^2}) \\sim \\mathcal{N}(\\ln(v_{\\mathrm{med}}),\\,\\sigma_{\\ln}^2)$. The admissibility constraint for the Beta PDF requires $0 < \\widetilde{Z''^2} < \\widetilde{Z}\\,(1-\\widetilde{Z})$. If a sampled variance exceeds the admissible upper bound, enforce $ \\widetilde{Z''^2} \\leftarrow \\widetilde{Z}\\,(1-\\widetilde{Z}) - \\epsilon$ for a small $ \\epsilon > 0$.\n\nTask. Starting only from the definitions above and the construction of the Beta PDF from $(\\widetilde{Z}, \\widetilde{Z''^2})$, design a program to:\n- Sample the uncertain variance $\\widetilde{Z''^2}$ via Monte Carlo (MC) from the specified log-normal distribution, enforcing admissibility as stated.\n- For each sample, construct the Beta PDF parameters $(a,b)$ consistent with $(\\widetilde{Z}, \\widetilde{Z''^2})$.\n- Compute the corresponding mean reaction rate $\\overline{\\dot{\\omega}}$ using the integral above and the specified $\\dot{\\omega}(Z)$.\n- Aggregate the distribution of $\\overline{\\dot{\\omega}}$ across samples and compute the two-sided confidence interval (CI) at confidence level $\\alpha$ (e.g., $\\alpha = 0.95$).\n- Also compute the nominal mean reaction rate using the nominal variance set equal to the median $v_{\\mathrm{med}}$ (subject to admissibility).\n\nReport the nominal mean reaction rate and the CI bounds in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ as floating-point numbers.\n\nTo ensure reproducibility and testability, use a fixed pseudo-random seed of $12345$ for sampling. For numerical stability when enforcing the admissibility cap, use the given $\\epsilon$ for each test case.\n\nTest suite. Implement the program for the following test cases, which collectively probe a general case, a small-variance case, a near-maximum-variance case, and a high-mean-mixture-fraction case:\n- Case $1$: $\\widetilde{Z} = 0.3$, $v_{\\mathrm{med}} = 0.01$, $\\sigma_{\\ln} = 0.3$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, number of MC samples $N = 5000$, confidence level $\\alpha = 0.95$, $\\epsilon = 10^{-12}$.\n- Case $2$: $\\widetilde{Z} = 0.3$, $v_{\\mathrm{med}} = 10^{-5}$, $\\sigma_{\\ln} = 0.1$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $N = 5000$, $\\alpha = 0.95$, $\\epsilon = 10^{-12}$.\n- Case $3$: $\\widetilde{Z} = 0.5$, $v_{\\mathrm{med}} = 0.24$, $\\sigma_{\\ln} = 0.6$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $N = 8000$, $\\alpha = 0.95$, $\\epsilon = 10^{-12}$.\n- Case $4$: $\\widetilde{Z} = 0.95$, $v_{\\mathrm{med}} = 0.001$, $\\sigma_{\\ln} = 0.2$, $k = 5.0\\,\\mathrm{s}^{-1}$, $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $N = 5000$, $\\alpha = 0.95$, $\\epsilon = 10^{-12}$.\n\nOutput specification. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a three-element list $[\\text{nominal}, \\text{lower}, \\text{upper}]$. For example:\n$$\n[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]\n$$\nAll $x_i$, $y_i$, and $z_i$ must be reported as decimal floating-point numbers in $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ with no unit symbols included in the output string.",
            "solution": "The core task is to compute the nominal mean reaction rate $\\overline{\\dot{\\omega}}$ and its confidence interval, given uncertainty in the variance of the mixture fraction, $\\widetilde{Z''^2}$. The solution involves a combination of statistical mechanics of combustion models and computational Monte Carlo methods. The algorithmic design is founded on the following principles and derivations.\n\n### 1. Analytical Expression for the Mean Reaction Rate\n\nThe mean reaction rate $\\overline{\\dot{\\omega}}$ is defined by the integral of the conditional reaction rate $\\dot{\\omega}(Z)$ weighted by the Probability Density Function (PDF) of the mixture fraction $Z$, which is presumed to be a Beta PDF, $P_{\\beta}(Z; a, b)$.\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\int_{0}^{1} \\dot{\\omega}(Z)\\,P_{\\beta}(Z; a, b)\\,\\mathrm{d}Z\n$$\nThe conditional reaction rate is given as $\\dot{\\omega}(Z) = k\\,\\rho\\,Z\\,(1-Z)$, and the Beta PDF is $P_{\\beta}(Z; a, b) = \\frac{Z^{a-1}(1-Z)^{b-1}}{B(a,b)}$, where $B(a,b)$ is the Beta function. Substituting these into the integral yields:\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\int_{0}^{1} k\\,\\rho\\,Z\\,(1-Z) \\frac{Z^{a-1}(1-Z)^{b-1}}{B(a,b)} \\,\\mathrm{d}Z\n$$\nThe constants $k$ and $\\rho$ can be factored out, and the terms involving $Z$ can be combined:\n$$\n\\overline{\\dot{\\omega}} \\;=\\; \\frac{k\\rho}{B(a,b)} \\int_{0}^{1} Z^{(a+1)-1}(1-Z)^{(b+1)-1} \\,\\mathrm{d}Z\n$$\nThe remaining integral is, by definition, the Beta function $B(a+1, b+1)$. Thus, the mean reaction rate is given by the algebraic expression:\n$$\n\\overline{\\dot{\\omega}} \\;=\\; k\\rho \\frac{B(a+1, b+1)}{B(a,b)}\n$$\nUsing the identity $B(x,y) = \\frac{\\Gamma(x)\\Gamma(y)}{\\Gamma(x+y)}$ and the property $\\Gamma(z+1)=z\\Gamma(z)$, we can simplify this ratio:\n$$\n\\frac{B(a+1, b+1)}{B(a,b)} \\;=\\; \\frac{\\Gamma(a+1)\\Gamma(b+1)}{\\Gamma(a+b+2)} \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)} \\;=\\; \\frac{a\\Gamma(a)b\\Gamma(b)}{(a+b+1)(a+b)\\Gamma(a+b)} \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)} \\;=\\; \\frac{ab}{(a+b)(a+b+1)}\n$$\nThe problem states that the parameters $a$ and $b$ of the Beta PDF are chosen to match the first two moments of the mixture fraction, its mean $\\widetilde{Z}$ and variance $\\widetilde{Z''^2}$. The relationships are $\\widetilde{Z} = \\frac{a}{a+b}$ and $\\widetilde{Z''^2} = \\frac{ab}{(a+b)^2(a+b+1)}$.\nFrom the relation for the variance, we can write:\n$$\n\\frac{ab}{(a+b)(a+b+1)} \\;=\\; \\widetilde{Z''^2} (a+b)\n$$\nThe sum $a+b$ can be found from the definition of mean and variance:\n$$\n\\widetilde{Z''^2} \\;=\\; \\frac{a}{a+b}\\frac{b}{a+b}\\frac{1}{a+b+1} \\;=\\; \\widetilde{Z}(1-\\widetilde{Z})\\frac{1}{a+b+1} \\implies a+b+1 = \\frac{\\widetilde{Z}(1-\\widetilde{Z})}{\\widetilde{Z''^2}}\n$$\nThis gives $a+b = \\frac{\\widetilde{Z}(1-\\widetilde{Z})}{\\widetilde{Z''^2}} - 1$. Substituting this into the expression for the rate term:\n$$\n\\frac{ab}{(a+b)(a+b+1)} = \\widetilde{Z''^2} \\left( \\frac{\\widetilde{Z}(1-\\widetilde{Z})}{\\widetilde{Z''^2}} - 1 \\right) = \\widetilde{Z}(1-\\widetilde{Z}) - \\widetilde{Z''^2}\n$$\nThis provides a remarkably simple analytical formula for the mean reaction rate that depends only on the mean and variance of $Z$, not on the specific values of $a$ and $b$:\n$$\n\\overline{\\dot{\\omega}} \\;=\\; k\\rho \\left( \\widetilde{Z}(1-\\widetilde{Z}) - \\widetilde{Z''^2} \\right)\n$$\nThis formula is computationally efficient and robust, and forms the basis of our algorithm. It is rigorously derived from the provided Beta PDF model.\n\n### 2. Uncertainty Propagation and Algorithm Design\n\nThe variance $\\widetilde{Z''^2}$ is modeled as an uncertain parameter following a log-normal distribution, i.e., $\\ln(\\widetilde{Z''^2}) \\sim \\mathcal{N}(\\ln(v_{\\mathrm{med}}),\\,\\sigma_{\\ln}^2)$. We use a Monte Carlo (MC) simulation to propagate this uncertainty to the mean reaction rate $\\overline{\\dot{\\omega}}$.\n\nThe overall algorithm is as follows:\n1.  **Initialization**: For each test case, retrieve the parameters: mean mixture fraction $\\widetilde{Z}$, median variance $v_{\\mathrm{med}}$, logarithmic standard deviation $\\sigma_{\\ln}$, kinetic constant $k$, density $\\rho$, number of MC samples $N$, confidence level $\\alpha$, and stability parameter $\\epsilon$. A fixed pseudo-random seed is set once for reproducibility across all cases.\n\n2.  **Nominal Calculation**: The nominal mean reaction rate, $\\overline{\\dot{\\omega}}_{\\text{nom}}$, is calculated using the median of the variance, $v_{\\mathrm{med}}$.\n    *   The maximum physically admissible variance is $V_{\\max} = \\widetilde{Z}(1-\\widetilde{Z})$.\n    *   The nominal variance is capped for admissibility: $\\widetilde{Z''^2}_{\\text{nom}} = \\min(v_{\\mathrm{med}}, V_{\\max} - \\epsilon)$.\n    *   The nominal rate is computed as $\\overline{\\dot{\\omega}}_{\\text{nom}} = k\\rho (V_{\\max} - \\widetilde{Z''^2}_{\\text{nom}})$.\n\n3.  **Monte Carlo Simulation**:\n    *   Generate $N$ random samples of $\\ln(\\widetilde{Z''^2})$ from the normal distribution $\\mathcal{N}(\\ln(v_{\\mathrm{med}}),\\,\\sigma_{\\ln}^2)$.\n    *   Exponentiate these samples to obtain $N$ samples of $\\widetilde{Z''^2}$.\n    *   Enforce the admissibility constraint on all samples in a vectorized operation: for each sample $\\widetilde{Z''^2}_i$, its value is updated to $\\min(\\widetilde{Z''^2}_i, V_{\\max} - \\epsilon)$.\n    *   For each of the $N$ admissible variance samples $\\widetilde{Z''^2}_i$, compute the corresponding mean reaction rate $\\overline{\\dot{\\omega}}_i = k\\rho (V_{\\max} - \\widetilde{Z''^2}_i)$. This yields a distribution of $N$ possible outcomes for $\\overline{\\dot{\\omega}}$.\n\n4.  **Confidence Interval (CI) Calculation**:\n    *   The two-sided confidence interval is determined from the empirical distribution of the $N$ computed $\\overline{\\dot{\\omega}}_i$ values.\n    *   The lower and upper quantile levels are calculated as $q_{\\text{lower}} = (1-\\alpha)/2$ and $q_{\\text{upper}} = 1 - (1-\\alpha)/2$.\n    *   The lower and upper bounds of the CI are found by computing the corresponding percentiles of the sorted $\\overline{\\dot{\\omega}}$ samples.\n\n5.  **Output Formatting**: The results for each test case—the nominal rate, CI lower bound, and CI upper bound—are collected and formatted into the specified list-of-lists string format.\n\nThis principled design ensures scientific correctness by using a derived analytical formula, and provides a robust computational strategy using vectorized MC sampling to quantify uncertainty.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_rate_stats(Z_mean, V_med, sigma_ln, k, rho, N, alpha, eps, rng):\n    \"\"\"\n    Computes nominal rate and confidence interval for the mean reaction rate.\n\n    Args:\n        Z_mean (float): Favre-averaged mean of mixture fraction.\n        V_med (float): Median of the mixture fraction variance.\n        sigma_ln (float): Logarithmic standard deviation of the variance.\n        k (float): Kinetic constant.\n        rho (float): Thermodynamic density.\n        N (int): Number of Monte Carlo samples.\n        alpha (float): Confidence level for the interval.\n        eps (float): Small positive number for enforcing admissibility.\n        rng (np.random.Generator): NumPy random number generator instance.\n\n    Returns:\n        tuple[float, float, float]: Nominal rate, CI lower bound, CI upper bound.\n    \"\"\"\n    # Maximum physical variance\n    V_max = Z_mean * (1.0 - Z_mean)\n\n    # --- Nominal Calculation ---\n    # Enforce admissibility for the nominal variance\n    V_nom = min(V_med, V_max - eps)\n    # Ensure variance is positive\n    V_nom = max(V_nom, 0.0)\n\n    # Calculate nominal mean reaction rate\n    omega_nom = k * rho * (V_max - V_nom)\n\n    # --- Monte Carlo Simulation ---\n    # Generate N samples of log(variance) from a normal distribution\n    log_V_samples = rng.normal(loc=np.log(V_med), scale=sigma_ln, size=N)\n\n    # Exponentiate to get samples of variance\n    V_samples = np.exp(log_V_samples)\n\n    # Enforce admissibility constraint on all samples\n    V_samples = np.minimum(V_samples, V_max - eps)\n    # Ensure variance is positive\n    V_samples = np.maximum(V_samples, 0.0)\n\n    # Calculate the mean reaction rate for each sample\n    omega_samples = k * rho * (V_max - V_samples)\n\n    # --- Confidence Interval Calculation ---\n    # Calculate quantile levels\n    q_lower = (1.0 - alpha) / 2.0 * 100.0\n    q_upper = (1.0 + alpha) / 2.0 * 100.0\n    \n    # Compute the confidence interval using percentiles\n    ci_lower = np.percentile(omega_samples, q_lower)\n    ci_upper = np.percentile(omega_samples, q_upper)\n\n    return omega_nom, ci_lower, ci_upper\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Use a fixed pseudo-random seed for reproducibility.\n    # The problem specifies a single seed for the entire suite of tests.\n    rng = np.random.default_rng(12345)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: General case\n        {'Z_mean': 0.3, 'V_med': 0.01, 'sigma_ln': 0.3, 'k': 5.0, 'rho': 1.2, 'N': 5000, 'alpha': 0.95, 'eps': 1e-12},\n        # Case 2: Small-variance case\n        {'Z_mean': 0.3, 'V_med': 1e-5, 'sigma_ln': 0.1, 'k': 5.0, 'rho': 1.2, 'N': 5000, 'alpha': 0.95, 'eps': 1e-12},\n        # Case 3: Near-maximum-variance case\n        {'Z_mean': 0.5, 'V_med': 0.24, 'sigma_ln': 0.6, 'k': 5.0, 'rho': 1.2, 'N': 8000, 'alpha': 0.95, 'eps': 1e-12},\n        # Case 4: High-mean-mixture-fraction case\n        {'Z_mean': 0.95, 'V_med': 0.001, 'sigma_ln': 0.2, 'k': 5.0, 'rho': 1.2, 'N': 5000, 'alpha': 0.95, 'eps': 1e-12},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate the result for one case.\n        result = compute_rate_stats(\n            Z_mean=case['Z_mean'],\n            V_med=case['V_med'],\n            sigma_ln=case['sigma_ln'],\n            k=case['k'],\n            rho=case['rho'],\n            N=case['N'],\n            alpha=case['alpha'],\n            eps=case['eps'],\n            rng=rng\n        )\n        results.append(list(result))\n\n    # Format the final output string exactly as specified.\n    inner_parts = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}