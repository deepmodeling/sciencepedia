{
    "hands_on_practices": [
        {
            "introduction": "在雷诺平均（RANS）或大涡模拟（LES）中，我们求解标量（如混合分数 $Z$）的均值 $\\mu$ 和方差 $\\sigma^2$ 的输运方程。为了使用像Beta分布这样的假定PDF，我们必须首先根据这些矩来确定其形状参数 $\\alpha$ 和 $\\beta$。本练习将带你掌握“矩反演”这一基本技能，并引出至关重要的“可实现性”（realizability）或“可容许性”（admissibility）概念，确保我们的模型在物理上和数学上都是有意义的。",
            "id": "4053753",
            "problem": "在湍流非预混燃烧建模中，混合分数 $Z \\in [0,1]$ 通常采用假定概率密度函数 (PDF) 封闭模型进行处理。一个常见的选择是定义在 $[0,1]$ 区间上、具有正形状参数 $\\alpha$ 和 $\\beta$ 的贝塔分布。考虑一个来自雷诺平均纳维-斯托克斯 (RANS) 模拟的计算单元，其中该单元的混合分数的平均均值和方差分别报告为 $\\mu$ 和 $\\sigma^{2}$。从 $[0,1]$ 上的贝塔概率密度函数的定义出发，\n$$\np_{Z}(z;\\alpha,\\beta)=\\frac{z^{\\alpha-1}(1-z)^{\\beta-1}}{B(\\alpha,\\beta)}, \\quad 0 \\le z \\le 1, \\quad \\alpha0,\\ \\beta0,\n$$\n并结合连续随机变量的均值和方差的标准定义，\n$$\n\\mu=\\mathbb{E}[Z]=\\int_{0}^{1} z\\,p_{Z}(z;\\alpha,\\beta)\\,dz, \\quad \\sigma^{2}=\\operatorname{Var}(Z)=\\int_{0}^{1} (z-\\mu)^{2}\\,p_{Z}(z;\\alpha,\\beta)\\,dz,\n$$\n推导 $\\alpha(\\mu,\\sigma^{2})$ 和 $\\beta(\\mu,\\sigma^{2})$ 的封闭形式表达式。根据你的表达式，得到一个关于 $\\sigma^{2}$ 的必要且充分的容许性条件，该条件仅用 $\\mu$ 表示，并保证 $\\alpha0$ 和 $\\beta0$。\n\n然后，对于 RANS 报告的特定值 $\\mu=0.35$ 和 $\\sigma^{2}=0.040$，计算相应的形状参数 $\\alpha$ 和 $\\beta$。定义容许性指标\n$$\nI=\\begin{cases}\n1,  \\text{if the variance is admissible under the Beta presumed PDF for the given }\\mu,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n将最终结果以行向量 $\\big[\\alpha\\ \\ \\beta\\ \\ I\\big]$ 的形式报告。将 $\\alpha$ 和 $\\beta$ 四舍五入到四位有效数字。混合分数是无量纲的；请将你的最终结果表示为无量纲数。",
            "solution": "该问题要求根据贝塔概率密度函数 (PDF) 的均值 $\\mu$ 和方差 $\\sigma^2$ 推导其形状参数 $\\alpha$ 和 $\\beta$ 的表达式。随后，必须找到关于 $\\sigma^2$ 的容许性条件，最后，需要为给定的 $\\mu$ 和 $\\sigma^2$ 计算 $\\alpha$、$\\beta$ 和容许性指标 $I$ 的数值。\n\n对于区间 $[0, 1]$ 上的随机变量 $Z$，其贝塔 PDF 如下所示：\n$$\np_{Z}(z;\\alpha,\\beta)=\\frac{z^{\\alpha-1}(1-z)^{\\beta-1}}{B(\\alpha,\\beta)}, \\quad 0 \\le z \\le 1, \\quad \\alpha0,\\ \\beta0\n$$\n其中 $B(\\alpha,\\beta)$ 是贝塔函数，$B(\\alpha,\\beta) = \\int_{0}^{1} t^{\\alpha-1}(1-t)^{\\beta-1} dt$。贝塔函数与伽玛函数 $\\Gamma(x)$ 的关系为 $B(\\alpha,\\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$。伽玛函数的一个关键性质是 $\\Gamma(x+1) = x\\Gamma(x)$。\n\n首先，我们使用均值的定义推导其表达式 $\\mu = \\mathbb{E}[Z]$：\n$$\n\\mu = \\mathbb{E}[Z] = \\int_{0}^{1} z\\, p_{Z}(z;\\alpha,\\beta)\\,dz = \\frac{1}{B(\\alpha,\\beta)}\\int_{0}^{1} z \\cdot z^{\\alpha-1}(1-z)^{\\beta-1}\\,dz = \\frac{1}{B(\\alpha,\\beta)}\\int_{0}^{1} z^{\\alpha}(1-z)^{\\beta-1}\\,dz\n$$\n分子中的积分是 $B(\\alpha+1, \\beta)$ 的定义。因此，\n$$\n\\mu = \\frac{B(\\alpha+1, \\beta)}{B(\\alpha, \\beta)} = \\frac{\\Gamma(\\alpha+1)\\Gamma(\\beta)}{\\Gamma(\\alpha+1+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\n$$\n使用伽玛函数的性质 $\\Gamma(\\alpha+1) = \\alpha\\Gamma(\\alpha)$ 和 $\\Gamma(\\alpha+\\beta+1) = (\\alpha+\\beta)\\Gamma(\\alpha+\\beta)$，我们简化该表达式：\n$$\n\\mu = \\frac{\\alpha\\Gamma(\\alpha)\\Gamma(\\beta)}{(\\alpha+\\beta)\\Gamma(\\alpha+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} = \\frac{\\alpha}{\\alpha+\\beta}\n$$\n\n接下来，我们推导方差 $\\sigma^2 = \\operatorname{Var}(Z) = \\mathbb{E}[Z^2] - (\\mathbb{E}[Z])^2$。我们首先计算二阶矩 $\\mathbb{E}[Z^2]$：\n$$\n\\mathbb{E}[Z^2] = \\int_{0}^{1} z^2 p_{Z}(z;\\alpha,\\beta)\\,dz = \\frac{1}{B(\\alpha,\\beta)}\\int_{0}^{1} z^2 \\cdot z^{\\alpha-1}(1-z)^{\\beta-1}\\,dz = \\frac{B(\\alpha+2, \\beta)}{B(\\alpha, \\beta)}\n$$\n使用伽玛函数表示法：\n$$\n\\mathbb{E}[Z^2] = \\frac{\\Gamma(\\alpha+2)\\Gamma(\\beta)}{\\Gamma(\\alpha+2+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} = \\frac{(\\alpha+1)\\alpha\\Gamma(\\alpha)\\Gamma(\\beta)}{(\\alpha+\\beta+1)(\\alpha+\\beta)\\Gamma(\\alpha+\\beta)} \\cdot \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} = \\frac{\\alpha(\\alpha+1)}{(\\alpha+\\beta)(\\alpha+\\beta+1)}\n$$\n现在，我们计算方差：\n$$\n\\sigma^2 = \\mathbb{E}[Z^2] - \\mu^2 = \\frac{\\alpha(\\alpha+1)}{(\\alpha+\\beta)(\\alpha+\\beta+1)} - \\left(\\frac{\\alpha}{\\alpha+\\beta}\\right)^2 = \\frac{\\alpha(\\alpha+1)(\\alpha+\\beta) - \\alpha^2(\\alpha+\\beta+1)}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}\n$$\n简化分子：\n$$\n\\alpha[(\\alpha+1)(\\alpha+\\beta) - \\alpha(\\alpha+\\beta+1)] = \\alpha[\\alpha^2 + \\alpha\\beta + \\alpha + \\beta - \\alpha^2 - \\alpha\\beta - \\alpha] = \\alpha\\beta\n$$\n因此，方差的表达式为：\n$$\n\\sigma^2 = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}\n$$\n为了求出 $\\alpha(\\mu, \\sigma^2)$ 和 $\\beta(\\mu, \\sigma^2)$ 的表达式，我们反转这些矩关系。我们引入一个中间变量来表示参数之和，$S = \\alpha + \\beta$。\n从均值的表达式 $\\mu = \\frac{\\alpha}{\\alpha+\\beta} = \\frac{\\alpha}{S}$，得到 $\\alpha = \\mu S$。\n类似地，$1-\\mu = 1 - \\frac{\\alpha}{\\alpha+\\beta} = \\frac{\\beta}{\\alpha+\\beta} = \\frac{\\beta}{S}$，得到 $\\beta = (1-\\mu)S$。\n我们可以用 $\\mu$ 和 $S$ 重写方差表达式：\n$$\n\\sigma^2 = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)} = \\left(\\frac{\\alpha}{\\alpha+\\beta}\\right)\\left(\\frac{\\beta}{\\alpha+\\beta}\\right)\\frac{1}{(\\alpha+\\beta)+1} = \\mu(1-\\mu)\\frac{1}{S+1}\n$$\n求解 $S$：\n$$\nS+1 = \\frac{\\mu(1-\\mu)}{\\sigma^2} \\implies S = \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1\n$$\n将 $S$ 的这个表达式代回 $\\alpha$ 和 $\\beta$ 的关系式，我们得到所需的封闭形式表达式：\n$$\n\\alpha(\\mu, \\sigma^2) = \\mu \\left( \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 \\right)\n$$\n$$\n\\beta(\\mu, \\sigma^2) = (1-\\mu) \\left( \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 \\right)\n$$\n容许性条件要求形状参数为严格正数：$\\alpha > 0$ 和 $\\beta > 0$。对于一个物理上真实的混合分数，其均值必须在 $\\mu \\in [0, 1]$ 范围内。我们考虑非简并情况，即 $\\mu \\in (0, 1)$，此时 $\\mu$ 和 $1-\\mu$ 均为正。在这种情况下，当且仅当公共因子为正时，条件 $\\alpha>0$ 和 $\\beta>0$ 才得到满足：\n$$\n\\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 > 0\n$$\n$$\n\\frac{\\mu(1-\\mu)}{\\sigma^2} > 1\n$$\n对于非简并分布，$\\sigma^2 > 0$。因此，我们可以两边乘以 $\\sigma^2$ 而不改变不等号方向：\n$$\n\\sigma^2  \\mu(1-\\mu)\n$$\n这就是对于给定的 $\\mu \\in (0,1)$，关于 $\\sigma^2$ 的必要且充分的容许性条件。方差必须在 $0  \\sigma^2  \\mu(1-\\mu)$ 的范围内。\n\n现在，我们将这些结果应用于给定的 RANS 报告值：$\\mu=0.35$ 和 $\\sigma^{2}=0.040$。\n首先，我们检查容许性条件。我们计算此均值下允许的最大方差：\n$$ \\mu(1-\\mu) = 0.35 \\times (1 - 0.35) = 0.35 \\times 0.65 = 0.2275 $$\n给定 $\\sigma^2 = 0.040$。将给定方差与允许的最大方差进行比较：\n$$ 0.040  0.2275 $$\n由于条件满足，对于假定的贝塔 PDF，给定的方差是容许的。因此，容许性指标为 $I=1$。\n\n接下来，我们计算相应的形状参数 $\\alpha$ 和 $\\beta$。我们首先计算总和 $S$：\n$$ S = \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 = \\frac{0.2275}{0.040} - 1 = 5.6875 - 1 = 4.6875 $$\n现在我们计算 $\\alpha$ 和 $\\beta$：\n$$ \\alpha = \\mu S = 0.35 \\times 4.6875 = 1.640625 $$\n$$ \\beta = (1-\\mu) S = (1 - 0.35) \\times 4.6875 = 0.65 \\times 4.6875 = 3.046875 $$\n按照要求将这些值四舍五入到四位有效数字：\n$$ \\alpha \\approx 1.641 $$\n$$ \\beta \\approx 3.047 $$\n最终结果是包含计算值的行向量 $[\\alpha\\ \\ \\beta\\ \\ I]$。\n该向量为 $[1.641\\ \\ 3.047\\ \\ 1]$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 1.641  3.047  1 \\end{pmatrix}} $$"
        },
        {
            "introduction": "假定PDF方法的主要目的是为高度非线性的项（例如化学反应速率）提供封闭模型，因为这些项不能直接进行平均。本练习将通过一个简单但富有启发性的反应模型，指导你解析计算经过滤波的反应源项，从而演示这一核心原理。你将看到，通过与假定PDF进行卷积，一个复杂的非线性平均问题如何可以被精确求解。",
            "id": "4053747",
            "problem": "在用假定概率密度函数 (PDF) 方法模拟的湍流反应流中，有界进程变量的滤波或平均后的反应源项可以写为对一个假定分布的系综平均。考虑一个由假定贝塔分布控制的无量纲反应进程变量 $\\phi \\in [0,1]$。滤波后的源项定义为\n$$\n\\tilde{\\omega} \\equiv \\int_{0}^{1} \\omega(\\phi)\\, p(\\phi)\\, d\\phi,\n$$\n其中 $p(\\phi)$ 是参数为 $\\alpha0$ 和 $\\beta0$ 的贝塔概率密度函数，由下式给出\n$$\np(\\phi) = \\mathrm{Beta}(\\phi;\\alpha,\\beta) \\equiv \\frac{\\phi^{\\alpha-1}(1-\\phi)^{\\beta-1}}{B(\\alpha,\\beta)},\n$$\n且 $B(\\alpha,\\beta)$ 是由下式定义的欧拉贝塔函数\n$$\nB(\\alpha,\\beta) \\equiv \\int_{0}^{1} t^{\\alpha-1}(1-t)^{\\beta-1}\\, dt.\n$$\n假设一个无量纲反应模型为 $\\omega(\\phi) = \\phi^{n}$，其中整数 $n \\ge 0$。从以上定义出发，推导滤波后的源项 $\\tilde{\\omega}$ 的一个闭式表达式，该表达式应为贝塔函数之比的形式。你的最终答案必须是单一的解析表达式。不需要进行数值计算，并且由于所有量都是无量纲的，因此不需要单位。",
            "solution": "本题旨在确定反应进程变量 $\\phi$ 的滤波后源项 $\\tilde{\\omega}$。题目陈述提供了所有必要的定义，并且在科学和数学上是适定的。我们将进行形式推导。\n\n滤波后的源项由以下积分定义：\n$$\n\\tilde{\\omega} \\equiv \\int_{0}^{1} \\omega(\\phi)\\, p(\\phi)\\, d\\phi\n$$\n题目指定反应模型为幂律形式 $\\omega(\\phi) = \\phi^{n}$，其中 $n$ 为整数且 $n \\ge 0$。概率密度函数 (PDF) $p(\\phi)$ 被给定为参数为 $\\alpha  0$ 和 $\\beta  0$ 的贝塔分布：\n$$\np(\\phi) = \\frac{\\phi^{\\alpha-1}(1-\\phi)^{\\beta-1}}{B(\\alpha,\\beta)}\n$$\n此处，$B(\\alpha, \\beta)$ 是欧拉贝塔函数，定义为：\n$$\nB(\\alpha,\\beta) \\equiv \\int_{0}^{1} t^{\\alpha-1}(1-t)^{\\beta-1}\\, dt\n$$\n我们将 $\\omega(\\phi)$ 和 $p(\\phi)$ 的表达式代入 $\\tilde{\\omega}$ 的定义积分中：\n$$\n\\tilde{\\omega} = \\int_{0}^{1} \\left( \\phi^{n} \\right) \\left( \\frac{\\phi^{\\alpha-1}(1-\\phi)^{\\beta-1}}{B(\\alpha,\\beta)} \\right) d\\phi\n$$\n项 $B(\\alpha, \\beta)$ 相对于积分变量 $\\phi$ 是一个常数。因此，可以将其从积分中提出：\n$$\n\\tilde{\\omega} = \\frac{1}{B(\\alpha,\\beta)} \\int_{0}^{1} \\phi^{n} \\phi^{\\alpha-1}(1-\\phi)^{\\beta-1} d\\phi\n$$\n接下来，我们使用指数性质 $x^a x^b = x^{a+b}$ 合并被积函数中与 $\\phi$ 相关的幂次项：\n$$\n\\phi^{n} \\phi^{\\alpha-1} = \\phi^{n+\\alpha-1}\n$$\n将此结果代回 $\\tilde{\\omega}$ 的表达式中，得到：\n$$\n\\tilde{\\omega} = \\frac{1}{B(\\alpha,\\beta)} \\int_{0}^{1} \\phi^{(\\alpha+n)-1}(1-\\phi)^{\\beta-1} d\\phi\n$$\n我们现在来考察剩余积分 $\\int_{0}^{1} \\phi^{(\\alpha+n)-1}(1-\\phi)^{\\beta-1} d\\phi$ 的结构。通过将此积分与欧拉贝塔函数的定义 $B(x,y) = \\int_{0}^{1} t^{x-1}(1-t)^{y-1}\\, dt$ 进行比较，我们可以发现一个直接的对应关系。\n令新参数为 $x = \\alpha+n$ 和 $y = \\beta$。该积分可以写为：\n$$\n\\int_{0}^{1} \\phi^{x-1}(1-\\phi)^{y-1} d\\phi = B(x,y) = B(\\alpha+n, \\beta)\n$$\n为使该贝塔函数有良好定义，其参数必须为正。第一个参数是 $\\alpha+n$。由于给定 $\\alpha  0$ 且整数 $n \\ge 0$，它们的和 $\\alpha+n$ 必定严格为正。第二个参数是 $\\beta$，题目已给出 $\\beta  0$。因此，在给定约束条件下，函数 $B(\\alpha+n, \\beta)$ 是有良好定义的。\n\n最后，我们将积分的结果代回 $\\tilde{\\omega}$ 的表达式中：\n$$\n\\tilde{\\omega} = \\frac{1}{B(\\alpha,\\beta)} \\cdot B(\\alpha+n, \\beta)\n$$\n这就得到了滤波后源项的最终闭式表达式，其形式为贝塔函数之比：\n$$\n\\tilde{\\omega} = \\frac{B(\\alpha+n, \\beta)}{B(\\alpha, \\beta)}\n$$\n该表达式是一个贝塔分布随机变量的 $n$ 阶原始矩，这是概率论中的一个已知结果，我们已经从所提供的燃烧模拟问题的第一性原理出发，对其进行了形式推导。",
            "answer": "$$\\boxed{\\frac{B(\\alpha+n, \\beta)}{B(\\alpha, \\beta)}}$$"
        },
        {
            "introduction": "尽管解析解能提供深刻的洞见，但真实的燃烧化学过程极其复杂，其热化学性质通常以预先计算的数表形式存储。最后的这项练习将理论与计算现实联系起来，展示如何使用为Beta权重积分专门优化的高效求积方法，从数表中数值计算滤波后的物理量。这项练习突显了PDF的数学特性如何直接指导我们选择最优的数值算法，是连接理论模型与代码实现的关键一步。",
            "id": "4053718",
            "problem": "给定一个以混合分数 $Z \\in [0,1]$ 为函数的列表形式的组分质量分数分布 $Y_i(Z)$。在恒定密度假设下，Reynolds 滤波与密度加权 (Favre) 滤波重合，对于一个预设的混合分数概率密度函数 (PDF)，滤波后的组分质量分数 $\\tilde{Y_i}$ 定义为其期望值\n$$\n\\tilde{Y_i} \\;=\\; \\int_{0}^{1} Y_i(Z)\\, P(Z;\\alpha,\\beta)\\, \\mathrm{d}Z,\n$$\n其中 $P(Z;\\alpha,\\beta)$ 是 Beta 概率密度函数，其形状参数为 $\\alpha0$ 和 $\\beta0$，由下式给出\n$$\nP(Z;\\alpha,\\beta) \\;=\\; \\frac{Z^{\\alpha-1}(1-Z)^{\\beta-1}}{B(\\alpha,\\beta)},\n$$\n且 $B(\\alpha,\\beta)$ 表示 Beta 函数。\n\n从 $\\tilde{Y_i}$ 的积分定义和在区间 $[-1,1]$ 上带权重 $(1-x)^{a}(1+x)^{b}$ 的 Gauss–Jacobi 求积标准形式出发，推导一个算法，用于在 $Y_i(Z)$ 仅以 $Z \\in [0,1]$ 上的列表函数形式给出时，计算 $\\tilde{Y_i}$。您的算法必须：\n- 选择合适的变量替换，将 $[0,1]$ 上的 Beta 加权积分映射到 $[-1,1]$ 上的 Gauss–Jacobi 求积。\n- 使用插值方案来计算列表化的 $Y_i(Z)$ 在映射到 Z 空间后的求积节点处的值。\n- 对给定的 $(\\alpha,\\beta)$ 和指定数量的求积节点 $N \\in \\mathbb{N}$，生成 $\\tilde{Y_i}$ 的数值估计。\n\n为了在此背景下评估和讨论 Gauss–Jacobi 求积的数值精度，请为一组测试用例计算 Gauss–Jacobi 估计值相对于一个高精度参考积分的绝对误差。对于每个测试用例，列表化的 $Y_i(Z)$ 必须通过在 $[0,1]$ 的均匀网格上对已知的解析分布 $g(Z)$ 进行采样来创建，而参考值必须通过在 $[0,1]$ 上以严格的容差自适应地对解析被积函数 $g(Z)\\,P(Z;\\alpha,\\beta)$ 进行积分来计算。插值和求积的设计应被选择以避免伪振荡，并在端点 $Z=0$ 和 $Z=1$ 附近保持稳定性，特别是对于 $\\alpha1$ 或 $\\beta1$ 的情况，此时 Beta 概率密度函数是奇异但可积的。\n\n实现一个完整的程序，该程序：\n- 对于每个测试用例，使用 $[0,1]$ 上至少 $M=1001$ 个点的均匀网格，从解析函数 $g(Z)$ 构建列表化的 $Y_i(Z)$。\n- 使用带有 $N$ 个节点的 Gauss–Jacobi 求积，针对由 $(\\alpha,\\beta)$ 所隐含的 Beta 权重计算 $\\tilde{Y_i}$。\n- 通过在 $[0,1]$ 上直接对 $g(Z)\\,P(Z;\\alpha,\\beta)$ 进行积分，计算 $\\tilde{Y_i}$ 的高精度参考值，绝对和相对容差均设置为 $10^{-13}$。\n- 为每个测试用例返回绝对误差 $|\\tilde{Y_i}^{\\text{GJ}}-\\tilde{Y_i}^{\\text{ref}}|$，形式为浮点数。\n\n测试套件：\n- 用例 1：$\\alpha=2.5$，$\\beta=3.5$，$g(Z)=Z^{3}$，$N=2$。\n- 用例 2：$\\alpha=4.0$，$\\beta=1.5$，$g(Z)=Z^{5}$，$N=3$。\n- 用例 3：$\\alpha=0.6$，$\\beta=0.7$，$g(Z)=\\exp(2Z)$，$N=12$。\n- 用例 4：$\\alpha=0.2$，$\\beta=5.0$，$g(Z)=\\sin(\\pi Z)$，$N=24$。\n- 用例 5：$\\alpha=10.0$，$\\beta=10.0$，$g(Z)=\\cos(3Z)$，$N=8$。\n\n所有量均为无量纲。当 $g(Z)$ 中存在角度时，使用弧度单位。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_k$ 是测试用例 $k$ 的绝对误差，表示为浮点数。不应产生任何其他输出。",
            "solution": "我们从在混合分数 $Z \\in [0,1]$ 的预设概率密度函数 (PDF) 下，滤波后的组分质量分数的定义开始，假设密度恒定，从而 Reynolds 滤波和 Favre 滤波重合：\n$$\n\\tilde{Y_i} \\;=\\; \\mathbb{E}\\left[ Y_i(Z) \\right] \\;=\\; \\int_0^1 Y_i(Z)\\, P(Z;\\alpha,\\beta)\\,\\mathrm{d}Z,\n$$\n其中 Beta PDF 为\n$$\nP(Z;\\alpha,\\beta) \\;=\\; \\frac{Z^{\\alpha-1}(1-Z)^{\\beta-1}}{B(\\alpha,\\beta)},\n$$\n其中 $B(\\alpha,\\beta)=\\dfrac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$。\n\n为了应用 Gauss–Jacobi 求积，我们回顾它近似以下形式的积分\n$$\n\\int_{-1}^{1} (1-x)^{a}(1+x)^{b} f(x)\\,\\mathrm{d}x \\;\\approx\\; \\sum_{k=1}^{N} w_k f(x_k),\n$$\n其中 $\\{x_k\\}$ 和 $\\{w_k\\}$ 是指数为 $a-1$ 和 $b-1$ 的 N 点 Jacobi 节点和权重。我们希望计算\n$$\nI \\;=\\; \\int_{0}^{1} Y_i(Z)\\, Z^{\\alpha-1}(1-Z)^{\\beta-1}\\, \\mathrm{d}Z,\n$$\n然后通过 Beta 函数进行归一化，得到 Beta 加权期望：\n$$\n\\tilde{Y_i} \\;=\\; \\frac{I}{B(\\alpha,\\beta)}.\n$$\n我们通过仿射变换 $Z=\\dfrac{x+1}{2}$（其中 $x\\in[-1,1]$）将 $Z$ 映射到 $x$。则有 $\\mathrm{d}Z = \\dfrac{1}{2}\\mathrm{d}x$，$1-Z = \\dfrac{1-x}{2}$，以及 $Z = \\dfrac{1+x}{2}$。代入后，我们得到\n\\begin{align*}\nI \\;=\\; \\int_{-1}^{1} Y_i\\!\\left(\\frac{x+1}{2}\\right)\\,\\left(\\frac{1+x}{2}\\right)^{\\alpha-1}\\!\\left(\\frac{1-x}{2}\\right)^{\\beta-1}\\,\\frac{1}{2}\\,\\mathrm{d}x \\\\\n=\\; 2^{-(\\alpha+\\beta-1)} \\int_{-1}^{1} (1-x)^{\\beta-1} (1+x)^{\\alpha-1}\\, Y_i\\!\\left(\\frac{x+1}{2}\\right)\\,\\mathrm{d}x.\n\\end{align*}\n这正是指数为\n$$\na \\;=\\; \\beta-1, \\qquad b \\;=\\; \\alpha-1,\n$$\n且被积函数为\n$$\nf(x) \\;=\\; Y_i\\!\\left(\\frac{x+1}{2}\\right).\n$$\n的 Jacobi 形式。因此，N 点 Gauss–Jacobi 求积近似为\n$$\nI \\;\\approx\\; 2^{-(\\alpha+\\beta-1)} \\sum_{k=1}^{N} w_k\\, Y_i\\!\\left(\\frac{x_k+1}{2}\\right),\n$$\n所求的 Beta 加权期望为\n$$\n\\tilde{Y_i}^{\\text{GJ}} \\;=\\; \\frac{2^{-(\\alpha+\\beta-1)}}{B(\\alpha,\\beta)} \\sum_{k=1}^{N} w_k\\, Y_i\\!\\left(\\frac{x_k+1}{2}\\right).\n$$\n\n由于 $Y_i(Z)$ 仅以 $Z\\in[0,1]$ 上的列表函数形式提供，我们必须在映射后的求积节点 $Z_k = \\dfrac{x_k+1}{2}$ 处计算 $Y_i$ 的值。为避免振荡并再现平滑行为，我们采用三次样条插值。自然或非扭结三次样条是连续的，具有连续的一阶和二阶导数，对于平滑数据是稳定的，并且能精确地再现任何三次多项式，这在测试多项式分布时对精度有利。\n\n对于参考值，我们计算\n$$\n\\tilde{Y_i}^{\\text{ref}} \\;=\\; \\int_{0}^{1} g(Z)\\, \\frac{Z^{\\alpha-1}(1-Z)^{\\beta-1}}{B(\\alpha,\\beta)}\\, \\mathrm{d}Z,\n$$\n其中 $g(Z)$ 是生成列表的解析分布，通过自适应求积计算，绝对和相对容差均设为 $10^{-13}$。由于参考值使用了精确的解析函数，这可以最大程度地将求积误差与插值误差分离开来。\n\n算法步骤：\n1. 对每个测试用例，定义解析函数 $g(Z)$ 和参数 $(\\alpha,\\beta)$。\n2. 在 $[0,1]$ 上构建一个包含 $M=1001$ 个点的均匀网格 $\\{Z_j\\}_{j=0}^{M-1}$，并制表 $Y_j=g(Z_j)$。\n3. 根据列表数据构建一个三次样条插值函数 $S(Z)$。\n4. 获取指数为 $a=\\beta-1$ 和 $b=\\alpha-1$ 的 N 点 Jacobi 节点和权重 $\\{x_k,w_k\\}$。\n5. 将 $x_k$ 映射到 $Z_k=(x_k+1)/2$ 并计算 $S(Z_k)$。\n6. 形成 Gauss–Jacobi 估计值\n   $$\n   \\tilde{Y_i}^{\\text{GJ}} \\;=\\; \\frac{2^{-(\\alpha+\\beta-1)}}{B(\\alpha,\\beta)} \\sum_{k=1}^{N} w_k\\, S(Z_k).\n   $$\n7. 通过在 $[0,1]$ 上以严格容差自适应地对 $g(Z) P(Z;\\alpha,\\beta)$ 进行积分，计算参考值 $\\tilde{Y_i}^{\\text{ref}}$。\n8. 报告绝对误差 $|\\tilde{Y_i}^{\\text{GJ}}-\\tilde{Y_i}^{\\text{ref}}|$。\n\n精度讨论：\n- 对于 $Z^{m}$ 形式的被积函数，如果被积函数在求积节点上被精确求值，则具有 $N$ 个节点的 Gauss–Jacobi 求积对于 $m \\le 2N-1$ 是精确的。使用三次样条插值可以保持对三次分布的精确性，并且对于足够精细的列表，对更高次的多项式也能产生高精度。\n- 当 $\\alpha1$ 或 $\\beta1$ 时，Beta 概率密度函数具有可积的端点奇点。对于此类指数，Gauss–Jacobi 节点会在端点附近聚集，从而提高精度，因为该求积方法是为权重 $(1-x)^{a}(1+x)^{b}$ 优化的。映射 $Z=(x+1)/2$ 保留了在 $Z=0$ 和 $Z=1$ 附近的这种聚集特性。\n- 主要的误差来源是插值误差（如果列表数据粗糙或函数变化迅速）和求积截断误差（有限的 $N$）。增加 $M$ 会减少插值误差，增加 $N$ 会减少求积误差。用严格容差计算的参考积分可作为精确期望值的近似。\n\n该程序为指定的测试套件实现了上述过程，并以方括号内逗号分隔的列表形式输出绝对误差，适用于自动验证。所有量均为无量纲，且 $g(Z)$ 中的任何角度均以弧度为单位。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_jacobi, beta as beta_fn\nfrom scipy.integrate import quad\nfrom scipy.interpolate import CubicSpline\n\ndef gauss_jacobi_expectation_from_tabulation(z_grid, y_grid, alpha, beta, n_nodes):\n    \"\"\"\n    Compute E[Y(Z)] under Beta(alpha,beta) using Gauss-Jacobi quadrature,\n    where Y is given as tabulated values (z_grid, y_grid) on [0,1].\n    \"\"\"\n    # Jacobi parameters for weight (1-x)^(a) (1+x)^(b)\n    a_j = beta - 1.0\n    b_j = alpha - 1.0\n    # Obtain nodes and weights on [-1,1] for Jacobi(a_j, b_j)\n    x, w = roots_jacobi(n_nodes, a_j, b_j)\n    # Map nodes to Z in [0,1]\n    z_nodes = 0.5 * (x + 1.0)\n    # Interpolate Y at z_nodes using a cubic spline\n    spline = CubicSpline(z_grid, y_grid, bc_type='not-a-knot')\n    y_nodes = spline(z_nodes)\n    # Unnormalized weighted integral over [0,1]\n    scale = 2.0 ** (-(alpha + beta - 1.0))\n    I = scale * np.dot(w, y_nodes)\n    # Normalize by Beta function to get expectation\n    return I / beta_fn(alpha, beta)\n\ndef reference_expectation_analytic(func, alpha, beta):\n    \"\"\"\n    High-accuracy reference: integrate func(z) * BetaPDF(z; alpha,beta) over [0,1].\n    \"\"\"\n    B = beta_fn(alpha, beta)\n    def integrand(z):\n        return func(z) * (z**(alpha - 1.0)) * ((1.0 - z)**(beta - 1.0)) / B\n    # Handle potential endpoint singularities robustly\n    val, _ = quad(integrand, 0.0, 1.0, epsabs=1e-13, epsrel=1e-13, limit=100, points=[0.0, 1.0])\n    return val\n\ndef build_tabulation(func, M=1001):\n    \"\"\"\n    Build a uniform tabulation of func on [0,1] with M points.\n    \"\"\"\n    z = np.linspace(0.0, 1.0, M, dtype=float)\n    y = func(z)\n    return z, y\n\ndef solve():\n    # Define analytic profiles for test cases\n    def g1(z): return z**3\n    def g2(z): return z**5\n    def g3(z): return np.exp(2.0 * z)\n    def g4(z): return np.sin(np.pi * z)\n    def g5(z): return np.cos(3.0 * z)\n\n    test_cases = [\n        # (alpha, beta, function g(z), N nodes)\n        (2.5, 3.5, g1, 2),\n        (4.0, 1.5, g2, 3),\n        (0.6, 0.7, g3, 12),\n        (0.2, 5.0, g4, 24),\n        (10.0, 10.0, g5, 8),\n    ]\n\n    results = []\n    # Build a sufficiently fine tabulation to reduce interpolation error\n    M = 1001\n    for alpha, beta, g, n in test_cases:\n        z_grid, y_grid = build_tabulation(g, M=M)\n        gj_est = gauss_jacobi_expectation_from_tabulation(z_grid, y_grid, alpha, beta, n)\n        ref = reference_expectation_analytic(g, alpha, beta)\n        err = abs(gj_est - ref)\n        results.append(err)\n\n    # Format output as a single line with comma-separated floats (scientific notation), no spaces.\n    print(\"[\" + \",\".join(f\"{r:.12e}\" for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}