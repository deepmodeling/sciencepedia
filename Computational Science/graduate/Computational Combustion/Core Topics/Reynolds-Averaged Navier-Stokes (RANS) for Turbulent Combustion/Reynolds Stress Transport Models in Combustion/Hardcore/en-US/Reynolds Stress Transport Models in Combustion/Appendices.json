{
    "hands_on_practices": [
        {
            "introduction": "Reynolds stress models fundamentally work by separating the turbulent stresses into an isotropic part, related to the turbulent kinetic energy $k$, and an anisotropic part, described by the anisotropy tensor $a_{ij}$. This exercise solidifies the direct algebraic relationship between the Reynolds stress tensor $R_{ij}$, $k$, and $a_{ij}$. Mastering this core manipulation is an essential first step for interpreting and implementing advanced turbulence closures, as it forms the basic language for describing turbulence structure .",
            "id": "4058898",
            "problem": "In Reynolds-Averaged Navier–Stokes (RANS) modeling for turbulent reacting flows, the Reynolds stress tensor $R_{ij}$ appears in the transport of mean momentum and in closures for scalar fluxes in combustion. Consider a statistically stationary, plane homogeneous shear flow of an incompressible, constant-density mixture in a Cartesian frame $(x,y,z)$, with mean velocity $\\overline{u}_{i}$ of the form $\\overline{u}_{1} = S y$, $\\overline{u}_{2} = 0$, $\\overline{u}_{3} = 0$, where $S$ is a constant mean shear rate. Assume spatial homogeneity of the turbulence statistics and reflection symmetries typical of plane homogeneous shear flow such that $R_{13} = R_{31} = 0$ and $R_{23} = R_{32} = 0$, and that $R_{ij}$ is symmetric. Let the fluctuating velocity be defined by Reynolds decomposition $u_{i} = \\overline{u}_{i} + u_{i}'$, and let the Reynolds stress tensor be $R_{ij} \\equiv \\overline{u_{i}' u_{j}'}$. The turbulent kinetic energy is defined by $k \\equiv \\tfrac{1}{2} R_{ii}$. The anisotropy tensor is defined by the core relation $a_{ij} \\equiv \\dfrac{R_{ij}}{2k} - \\dfrac{1}{3}\\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nUsing only these core definitions and symmetry considerations for plane homogeneous shear flow, express all non-zero components of $R_{ij}$ in terms of $k$ and $a_{ij}$. Provide your final result as the ordered row vector $(R_{11}, R_{22}, R_{33}, R_{12})$ in closed form. No numerical evaluation is required, and no rounding is necessary. If you introduce any additional symbols, define them clearly.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of turbulence modeling, well-posed with sufficient and consistent definitions, and objective in its formulation. It requests a direct algebraic manipulation of given definitions, a standard procedure in tensor analysis within fluid mechanics. We can therefore proceed with the solution.\n\nThe objective is to express the non-zero components of the Reynolds stress tensor, $R_{ij}$, in terms of the turbulent kinetic energy, $k$, and the components of the anisotropy tensor, $a_{ij}$. The problem provides a direct relationship between these quantities.\n\nThe core definition of the anisotropy tensor, $a_{ij}$, is given as:\n$$\na_{ij} \\equiv \\frac{R_{ij}}{2k} - \\frac{1}{3}\\delta_{ij}\n$$\nwhere $R_{ij} \\equiv \\overline{u_{i}' u_{j}'}$ is the Reynolds stress tensor, $k \\equiv \\frac{1}{2} R_{ii} = \\frac{1}{2}\\overline{u_{k}' u_{k}'}$ is the turbulent kinetic energy, and $\\delta_{ij}$ is the Kronecker delta.\n\nTo express $R_{ij}$ in terms of $k$ and $a_{ij}$, we must rearrange this definitional equation. First, we isolate the term containing $R_{ij}$:\n$$\na_{ij} + \\frac{1}{3}\\delta_{ij} = \\frac{R_{ij}}{2k}\n$$\nNext, we multiply both sides of the equation by $2k$ to solve for $R_{ij}$:\n$$\nR_{ij} = 2k \\left( a_{ij} + \\frac{1}{3}\\delta_{ij} \\right)\n$$\nThis equation provides a general expression for any component of the Reynolds stress tensor. We can now use this to find the specific non-zero components requested: $R_{11}$, $R_{22}$, $R_{33}$, and $R_{12}$. The problem specifies that for the case of plane homogeneous shear flow, $R_{13} = R_{31} = 0$ and $R_{23} = R_{32} = 0$.\n\nWe evaluate the general expression for each component by setting the indices $i$ and $j$ accordingly and recalling the properties of the Kronecker delta, $\\delta_{ij}$, which is equal to $1$ if $i=j$ and $0$ if $i \\neq j$.\n\nFor the first normal stress component, $R_{11}$, we set $i=1$ and $j=1$. The Kronecker delta is $\\delta_{11} = 1$:\n$$\nR_{11} = 2k \\left( a_{11} + \\frac{1}{3}\\delta_{11} \\right) = 2k \\left( a_{11} + \\frac{1}{3} \\right)\n$$\n\nFor the second normal stress component, $R_{22}$, we set $i=2$ and $j=2$. The Kronecker delta is $\\delta_{22} = 1$:\n$$\nR_{22} = 2k \\left( a_{22} + \\frac{1}{3}\\delta_{22} \\right) = 2k \\left( a_{22} + \\frac{1}{3} \\right)\n$$\n\nFor the third normal stress component, $R_{33}$, we set $i=3$ and $j=3$. The Kronecker delta is $\\delta_{33} = 1$:\n$$\nR_{33} = 2k \\left( a_{33} + \\frac{1}{3}\\delta_{33} \\right) = 2k \\left( a_{33} + \\frac{1}{3} \\right)\n$$\n\nFor the primary shear stress component, $R_{12}$, we set $i=1$ and $j=2$. The Kronecker delta is $\\delta_{12} = 0$:\n$$\nR_{12} = 2k \\left( a_{12} + \\frac{1}{3}\\delta_{12} \\right) = 2k \\left( a_{12} + 0 \\right) = 2k a_{12}\n$$\nDue to the symmetry of the Reynolds stress tensor, $R_{21} = R_{12}$.\n\nAs a check for consistency, the anisotropy tensor is by construction a traceless tensor. We can verify this from its definition:\n$$\na_{ii} = \\frac{R_{ii}}{2k} - \\frac{1}{3}\\delta_{ii}\n$$\nUsing the definition of turbulent kinetic energy, $k = \\frac{1}{2} R_{ii}$, we have $R_{ii} = 2k$. The trace of the Kronecker delta is $\\delta_{ii} = \\delta_{11} + \\delta_{22} + \\delta_{33} = 1 + 1 + 1 = 3$. Substituting these into the expression for the trace of $a_{ij}$:\n$$\na_{ii} = \\frac{2k}{2k} - \\frac{1}{3}(3) = 1 - 1 = 0\n$$\nThis confirms that $a_{11} + a_{22} + a_{33} = 0$, which is a fundamental property of the anisotropy tensor.\n\nThe four non-zero components asked for are thus expressed in terms of $k$ and the corresponding components of $a_{ij}$. The final result is the ordered row vector $(R_{11}, R_{22}, R_{33}, R_{12})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2k \\left( a_{11} + \\frac{1}{3} \\right)  2k \\left( a_{22} + \\frac{1}{3} \\right)  2k \\left( a_{33} + \\frac{1}{3} \\right)  2k a_{12}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The full Reynolds stress tensor contains six independent components, making its direct interpretation challenging. The barycentric map, also known as the Lumley triangle, offers a powerful method for visualizing the *state* of turbulence by mapping the eigenvalues of the anisotropy tensor to a simple two-dimensional triangle . This practice guides you through applying this technique to classify the character of turbulence within a flame, translating abstract tensor components into a clear, graphical representation of whether the turbulence is primarily one-component (rod-like), two-component (sheet-like), or approaching an isotropic state.",
            "id": "4058935",
            "problem": "A lean premixed flame is simulated using Reynolds-Averaged Navier–Stokes (RANS) with a Reynolds stress transport model. At a point within the flame brush, the Reynolds stress tensor $\\mathbf{R}$ is diagonal in its principal frame, with eigenvalues $R_{1}$, $R_{2}$, and $R_{3}$ such that $R_{1} \\geq R_{2} \\geq R_{3}$. The turbulence kinetic energy is $k = \\frac{1}{2} \\operatorname{tr}(\\mathbf{R})$. The anisotropy tensor is defined by\n$$\n\\mathbf{b} = \\frac{\\mathbf{R}}{2k} - \\frac{1}{3}\\mathbf{I},\n$$\nwith ordered eigenvalues $b_{1} \\geq b_{2} \\geq b_{3}$.\n\nThe barycentric map of turbulence anisotropy represents the state as a convex combination of three limiting componentality states: one-component turbulence ($1\\mathrm{C}$), two-component turbulence ($2\\mathrm{C}$), and three-component isotropic turbulence ($3\\mathrm{C}$). These limiting states are located at the vertices of an equilateral triangle in Cartesian coordinates:\n$$\n\\text{$1\\mathrm{C}$ at } (x_{1\\mathrm{C}}, y_{1\\mathrm{C}}) = (1, 0), \\quad \\text{$2\\mathrm{C}$ at } (x_{2\\mathrm{C}}, y_{2\\mathrm{C}}) = (0, 0), \\quad \\text{$3\\mathrm{C}$ at } (x_{3\\mathrm{C}}, y_{3\\mathrm{C}}) = \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right).\n$$\nThe barycentric weights $(C_{1\\mathrm{C}}, C_{2\\mathrm{C}}, C_{3\\mathrm{C}})$ are nonnegative and sum to $1$, and the mapped point $(x, y)$ is given by\n$$\nx = C_{1\\mathrm{C}} x_{1\\mathrm{C}} + C_{2\\mathrm{C}} x_{2\\mathrm{C}} + C_{3\\mathrm{C}} x_{3\\mathrm{C}}, \\qquad\ny = C_{1\\mathrm{C}} y_{1\\mathrm{C}} + C_{2\\mathrm{C}} y_{2\\mathrm{C}} + C_{3\\mathrm{C}} y_{3\\mathrm{C}}.\n$$\n\nAt the selected point, measurements yield $R_{1} = 0.9$, $R_{2} = 0.4$, and $R_{3} = 0.2$, all in $\\mathrm{m^{2}\\,s^{-2}}$, and $k = 0.75$ in $\\mathrm{m^{2}\\,s^{-2}}$. Using the definitions above, compute the barycentric weights from the eigenvalues of $\\mathbf{b}$, map the state to Cartesian coordinates $(x, y)$, and provide the final $(x, y)$ values. Round your final Cartesian coordinates to four significant figures. The coordinates are dimensionless; do not include units in your final numeric answer.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- Reynolds stress tensor $\\mathbf{R}$ is diagonal in its principal frame with eigenvalues $R_{1}$, $R_{2}$, and $R_{3}$ such that $R_{1} \\geq R_{2} \\geq R_{3}$.\n- Measured eigenvalues of $\\mathbf{R}$: $R_{1} = 0.9\\,\\mathrm{m^{2}\\,s^{-2}}$, $R_{2} = 0.4\\,\\mathrm{m^{2}\\,s^{-2}}$, $R_{3} = 0.2\\,\\mathrm{m^{2}\\,s^{-2}}$.\n- Turbulence kinetic energy is $k = \\frac{1}{2} \\operatorname{tr}(\\mathbf{R})$.\n- Measured value of turbulence kinetic energy: $k = 0.75\\,\\mathrm{m^{2}\\,s^{-2}}$.\n- Anisotropy tensor definition: $\\mathbf{b} = \\frac{\\mathbf{R}}{2k} - \\frac{1}{3}\\mathbf{I}$, with ordered eigenvalues $b_{1} \\geq b_{2} \\geq b_{3}$.\n- Barycentric map limiting state vertices in Cartesian coordinates $(x,y)$:\n  - $1\\mathrm{C}$ state at $(x_{1\\mathrm{C}}, y_{1\\mathrm{C}}) = (1, 0)$.\n  - $2\\mathrm{C}$ state at $(x_{2\\mathrm{C}}, y_{2\\mathrm{C}}) = (0, 0)$.\n  - $3\\mathrm{C}$ state at $(x_{3\\mathrm{C}}, y_{3\\mathrm{C}}) = \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$.\n- Barycentric weights $(C_{1\\mathrm{C}}, C_{2\\mathrm{C}}, C_{3\\mathrm{C}})$ are nonnegative and sum to $1$.\n- Mapping from barycentric weights to Cartesian coordinates:\n  - $x = C_{1\\mathrm{C}} x_{1\\mathrm{C}} + C_{2\\mathrm{C}} x_{2\\mathrm{C}} + C_{3\\mathrm{C}} x_{3\\mathrm{C}}$\n  - $y = C_{1\\mathrm{C}} y_{1\\mathrm{C}} + C_{2\\mathrm{C}} y_{2\\mathrm{C}} + C_{3\\mathrm{C}} y_{3\\mathrm{C}}$\n- The task is to compute the barycentric weights from the eigenvalues of $\\mathbf{b}$, map the state to $(x, y)$, and round the final coordinates to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Soundness**: The problem statement is scientifically grounded. The definitions of turbulence kinetic energy ($k$), the anisotropy tensor ($\\mathbf{b}$), and the use of a barycentric map (also known as a Lumley triangle) are standard concepts in the field of turbulence modeling within computational fluid dynamics and combustion.\n2.  **Well-Posedness**: The problem is well-posed. It provides clear definitions and a direct path for calculation.\n3.  **Objectivity**: The problem is expressed in objective, technical language, free from bias or subjective claims.\n4.  **Incomplete or Contradictory Setup**: The givens are checked for internal consistency. The trace of the Reynolds stress tensor is $\\operatorname{tr}(\\mathbf{R}) = R_{1} + R_{2} + R_{3} = 0.9 + 0.4 + 0.2 = 1.5\\,\\mathrm{m^{2}\\,s^{-2}}$. According to the definition, the turbulence kinetic energy is $k = \\frac{1}{2} \\operatorname{tr}(\\mathbf{R}) = \\frac{1}{2}(1.5) = 0.75\\,\\mathrm{m^{2}\\,s^{-2}}$. This matches the provided value of $k$. The data is consistent. The problem does not explicitly state the formulas to calculate the barycentric weights $(C_{1\\mathrm{C}}, C_{2\\mathrm{C}}, C_{3\\mathrm{C}})$ from the eigenvalues of $\\mathbf{b}$. However, for this specific barycentric map construction, there are standard definitions in the scientific literature (e.g., Banerjee et al., J. Fluid Mech., 2007). In the context of an advanced problem in this specialized field, it is reasonable to assume these definitions are known. The problem is thus considered sufficiently specified for its target audience.\n5.  **Unrealistic or Infeasible Conditions**: The values for the Reynolds stresses are physically plausible for a turbulent flow.\n6.  **Other Flaws**: The problem is not trivial, tautological, or ill-posed.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution\n\nThe first step is to compute the eigenvalues of the anisotropy tensor, $\\mathbf{b}$. Since the Reynolds stress tensor $\\mathbf{R}$ is given in its principal frame (i.e., it is diagonal), the anisotropy tensor $\\mathbf{b} = \\frac{\\mathbf{R}}{2k} - \\frac{1}{3}\\mathbf{I}$ is also diagonal in the same frame. Its eigenvalues, $b_1, b_2, b_3$, can be calculated directly from the eigenvalues of $\\mathbf{R}$, which are $R_1, R_2, R_3$.\n\nThe relationship is given by:\n$$\nb_i = \\frac{R_i}{2k} - \\frac{1}{3} \\quad \\text{for } i \\in \\{1, 2, 3\\}\n$$\nWe are given $R_{1} = 0.9$, $R_{2} = 0.4$, $R_{3} = 0.2$, and $k = 0.75$. Thus, $2k = 2 \\times 0.75 = 1.5$.\nThe eigenvalues of $\\mathbf{b}$ are:\n$$\nb_1 = \\frac{0.9}{1.5} - \\frac{1}{3} = \\frac{3}{5} - \\frac{1}{3} = \\frac{9-5}{15} = \\frac{4}{15}\n$$\n$$\nb_2 = \\frac{0.4}{1.5} - \\frac{1}{3} = \\frac{4}{15} - \\frac{5}{15} = -\\frac{1}{15}\n$$\n$$\nb_3 = \\frac{0.2}{1.5} - \\frac{1}{3} = \\frac{2}{15} - \\frac{5}{15} = -\\frac{3}{15} = -\\frac{1}{5}\n$$\nAs a check, the trace of $\\mathbf{b}$ must be zero: $\\operatorname{tr}(\\mathbf{b}) = b_1 + b_2 + b_3 = \\frac{4}{15} - \\frac{1}{15} - \\frac{3}{15} = 0$. The calculation is correct.\n\nNext, we calculate the barycentric weights $(C_{1\\mathrm{C}}, C_{2\\mathrm{C}}, C_{3\\mathrm{C}})$. For the specified barycentric map, the weights are defined in terms of the ordered eigenvalues of $\\mathbf{b}$ ($b_1 \\geq b_2 \\geq b_3$) as follows:\n$$\nC_{1\\mathrm{C}} = b_1 - b_2\n$$\n$$\nC_{2\\mathrm{C}} = 2(b_2 - b_3)\n$$\n$$\nC_{3\\mathrm{C}} = 3b_3 + 1\n$$\nSubstituting the calculated values of $b_i$:\n$$\nC_{1\\mathrm{C}} = \\frac{4}{15} - \\left(-\\frac{1}{15}\\right) = \\frac{5}{15} = \\frac{1}{3}\n$$\n$$\nC_{2\\mathrm{C}} = 2\\left(-\\frac{1}{15} - \\left(-\\frac{1}{5}\\right)\\right) = 2\\left(-\\frac{1}{15} + \\frac{3}{15}\\right) = 2\\left(\\frac{2}{15}\\right) = \\frac{4}{15}\n$$\n$$\nC_{3\\mathrm{C}} = 3\\left(-\\frac{1}{5}\\right) + 1 = -\\frac{3}{5} + 1 = \\frac{2}{5}\n$$\nWe check that the weights sum to $1$: $C_{1\\mathrm{C}} + C_{2\\mathrm{C}} + C_{3\\mathrm{C}} = \\frac{1}{3} + \\frac{4}{15} + \\frac{2}{5} = \\frac{5}{15} + \\frac{4}{15} + \\frac{6}{15} = \\frac{15}{15} = 1$. The weights are correct.\n\nFinally, we map the turbulence state to the Cartesian coordinates $(x,y)$ using the given barycentric transformation and vertex locations:\n$$\nx = C_{1\\mathrm{C}} x_{1\\mathrm{C}} + C_{2\\mathrm{C}} x_{2\\mathrm{C}} + C_{3\\mathrm{C}} x_{3\\mathrm{C}}\n$$\n$$\ny = C_{1\\mathrm{C}} y_{1\\mathrm{C}} + C_{2\\mathrm{C}} y_{2\\mathrm{C}} + C_{3\\mathrm{C}} y_{3\\mathrm{C}}\n$$\nWith $(x_{1\\mathrm{C}}, y_{1\\mathrm{C}}) = (1, 0)$, $(x_{2\\mathrm{C}}, y_{2\\mathrm{C}}) = (0, 0)$, and $(x_{3\\mathrm{C}}, y_{3\\mathrm{C}}) = (\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$, the equations become:\n$$\nx = C_{1\\mathrm{C}}(1) + C_{2\\mathrm{C}}(0) + C_{3\\mathrm{C}}\\left(\\frac{1}{2}\\right) = C_{1\\mathrm{C}} + \\frac{1}{2}C_{3\\mathrm{C}}\n$$\n$$\ny = C_{1\\mathrm{C}}(0) + C_{2\\mathrm{C}}(0) + C_{3\\mathrm{C}}\\left(\\frac{\\sqrt{3}}{2}\\right) = \\frac{\\sqrt{3}}{2}C_{3\\mathrm{C}}\n$$\nSubstituting the values of the weights:\n$$\nx = \\frac{1}{3} + \\frac{1}{2}\\left(\\frac{2}{5}\\right) = \\frac{1}{3} + \\frac{1}{5} = \\frac{5+3}{15} = \\frac{8}{15}\n$$\n$$\ny = \\frac{\\sqrt{3}}{2}\\left(\\frac{2}{5}\\right) = \\frac{\\sqrt{3}}{5}\n$$\nThe problem requires the final coordinates to be rounded to four significant figures. We compute the decimal values:\n$$\nx = \\frac{8}{15} \\approx 0.533333...\n$$\n$$\ny = \\frac{\\sqrt{3}}{5} \\approx \\frac{1.7320508...}{5} \\approx 0.346410...\n$$\nRounding to four significant figures gives:\n$x \\approx 0.5333$\n$y \\approx 0.3464$\n\nThe mapped Cartesian coordinates of the turbulence state are $(0.5333, 0.3464)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5333  0.3464 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In computational simulations, approximations within Reynolds stress models and numerical discretization errors can yield unphysical results, such as negative normal stresses. To be physically meaningful, the Reynolds stress tensor must be positive semi-definite—a property known as realizability. This hands-on computational exercise challenges you to design and implement a robust algorithm to correct a non-realizable stress tensor while conserving turbulent kinetic energy . By developing an eigenvalue clipping and trace-preserving scaling procedure, you will gain practical insight into enforcing fundamental physical constraints within a CFD code, a critical skill for developing and using advanced turbulence models.",
            "id": "4058917",
            "problem": "Consider the Reynolds stress transport models in combustion using density-weighted (Favre) averaging. Let the modeled Reynolds stress tensor be the covariance of velocity fluctuations defined as $r_{ij} = \\widetilde{u_i'' u_j''}$, where the tilde denotes Favre averaging. By definition of covariance, the tensor $r_{ij}$ is symmetric and positive semidefinite, and the turbulent kinetic energy $k$ satisfies $k = \\dfrac{1}{2} r_{ii}$, so $\\operatorname{tr}(r_{ij}) = 2k$. In near-wall regions of reactive flows, numerical discretization and modeling approximations can produce a modeled $r_{ij}$ that violates realizability, such as negative normal stresses. The realizability constraints require $r_{ij}$ to be symmetric positive semidefinite and to have a nonnegative quadratic form $\\boldsymbol{a}^{\\top} r \\boldsymbol{a} \\ge 0$ for any vector $\\boldsymbol{a}$. \n\nYour task is to design and implement an algorithm that adjusts a given modeled near-wall Reynolds stress tensor to enforce realizability by eigenvalue clipping, while preserving the turbulent kinetic energy. The algorithm must:\n- Accept a possibly non-symmetric $3 \\times 3$ matrix $r$ with physical units $\\mathrm{m}^2/\\mathrm{s}^2$, and a wall-normal unit vector $\\boldsymbol{n}$.\n- Produce an adjusted symmetric positive semidefinite tensor $\\tilde{r}$ that preserves the original turbulent kinetic energy $k$ computed from the input $r$ (that is, $\\operatorname{tr}(\\tilde{r}) = \\operatorname{tr}(r)$).\n- Avoid negative normal stresses by ensuring that for the provided wall-normal vector $\\boldsymbol{n}$, the adjusted normal stress satisfies $\\boldsymbol{n}^{\\top} \\tilde{r} \\, \\boldsymbol{n} \\ge 0$.\n- Use an eigenvalue clipping approach and a lower bound threshold $\\varepsilon  0$ to enforce nonnegativity of the spectral components.\n- Symmetrize the input if necessary and incorporate a numerical tolerance for the case of vanishing turbulent kinetic energy.\n\nFundamental base for your derivation and implementation must be restricted to:\n- The definition of the Reynolds stress tensor as a covariance, and the associated property of positive semidefiniteness.\n- The definition $k = \\dfrac{1}{2} r_{ii}$ and $\\operatorname{tr}(r) = 2k$.\n- The spectral theorem for real symmetric matrices.\n\nNumerical tolerance and units:\n- Use a kinetic energy tolerance $\\delta = 10^{-12} \\, \\mathrm{m}^2/\\mathrm{s}^2$ to handle vanishing-energy cases. If $k \\le \\delta$, set $\\tilde{r} = 0$.\n- All inputs and outputs represent stresses in $\\mathrm{m}^2/\\mathrm{s}^2$. Express the final numerical answers in $\\mathrm{m}^2/\\mathrm{s}^2$ as raw floating-point numbers without unit symbols.\n\nTest suite:\nImplement your algorithm for the following test cases. For each case $(r^{(i)}, \\boldsymbol{n}^{(i)}, \\varepsilon^{(i)})$, compute the sorted eigenvalues of the adjusted tensor $\\tilde{r}^{(i)}$ and the adjusted wall-normal stress $s_n^{(i)} = \\boldsymbol{n}^{(i)\\top} \\tilde{r}^{(i)} \\, \\boldsymbol{n}^{(i)}$. Report each case’s result as a list of four floats $[\\lambda_1^{(i)}, \\lambda_2^{(i)}, \\lambda_3^{(i)}, s_n^{(i)}]$ where $\\lambda_1^{(i)} \\le \\lambda_2^{(i)} \\le \\lambda_3^{(i)}$. Use the lower-bound clipping parameter $\\varepsilon^{(i)}$ provided for each case.\n\n- Case $1$ (happy path, small negative normal component):\n  $$\n  r^{(1)} = \\begin{bmatrix}\n  1.2  0.1  0.0 \\\\\n  0.1  -0.02  0.0 \\\\\n  0.0  0.0  0.82\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(1)} = \\begin{bmatrix}0 \\\\ 1 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(1)} = 10^{-6}.\n  $$\n- Case $2$ (strongly negative modeled component):\n  $$\n  r^{(2)} = \\begin{bmatrix}\n  0.5  0.2  0.3 \\\\\n  0.2  -0.4  0.1 \\\\\n  0.3  0.1  1.1\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(2)} = \\begin{bmatrix}0 \\\\ 0 \\\\ 1\\end{bmatrix}, \\quad\n  \\varepsilon^{(2)} = 10^{-6}.\n  $$\n- Case $3$ (near-zero energy with small negative eigenvalue):\n  $$\n  r^{(3)} = \\begin{bmatrix}\n  10^{-10}  0  0 \\\\\n  0  2 \\times 10^{-10}  0 \\\\\n  0  0  -10^{-11}\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(3)} = \\begin{bmatrix}1 \\\\ 0 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(3)} = 10^{-12}.\n  $$\n- Case $4$ (non-symmetric input requiring symmetrization):\n  $$\n  r^{(4)} = \\begin{bmatrix}\n  0.9  0.3  -0.2 \\\\\n  0.25  0.6  0.4 \\\\\n  -0.15  0.5  0.7\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(4)} = \\dfrac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(4)} = 10^{-6}.\n  $$\n- Case $5$ (vanishing-energy boundary, triggers zero-tensor):\n  $$\n  r^{(5)} = \\begin{bmatrix}\n  5 \\times 10^{-13}  0  0 \\\\\n  0  5 \\times 10^{-13}  0 \\\\\n  0  0  5 \\times 10^{-13}\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(5)} = \\begin{bmatrix}0 \\\\ 1 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(5)} = 10^{-12}.\n  $$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of four floats $[\\lambda_1^{(i)}, \\lambda_2^{(i)}, \\lambda_3^{(i)}, s_n^{(i)}]$ for $i = 1, 2, 3, 4, 5$. For example, the structure must be like $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],\\dots]$ with all values in $\\mathrm{m}^2/\\mathrm{s}^2$.",
            "solution": "The problem at hand is to devise and implement a numerical algorithm to enforce physical realizability on a modeled $3 \\times 3$ Reynolds stress tensor, $r$, which may arise from numerical simulations in computational combustion. The core constraints of realizability are that the tensor must be symmetric and positive semidefinite. The algorithm must correct any violations of these properties while adhering to the crucial physical constraint of conserving the turbulent kinetic energy, $k$, which is linearly related to the trace of the tensor, $k = \\frac{1}{2} \\operatorname{tr}(r)$.\n\nThe methodology is founded upon established principles of linear algebra and turbulence modeling. The algorithm proceeds systematically through several steps, each grounded in a specific physical or mathematical requirement.\n\n**Step 1: Pre-computation and Low-Energy Cutoff**\nFirst, we address the base state of the flow. The turbulent kinetic energy, $k$, is defined as $k = \\frac{1}{2} r_{ii} = \\frac{1}{2}\\operatorname{tr}(r)$. For numerical stability and physical consistency, turbulent fluctuations are considered negligible if the kinetic energy falls below a specified small tolerance, $\\delta$.\nLet the input tensor be $r_{in}$. We compute its trace $T = \\operatorname{tr}(r_{in})$. The turbulent kinetic energy is $k = \\frac{1}{2}T$.\nIf $k \\le \\delta$, where $\\delta = 10^{-12} \\, \\mathrm{m}^2/\\mathrm{s}^2$, the turbulent field is considered to have vanished. In this case, the adjusted Reynolds stress tensor $\\tilde{r}$ is set to the zero matrix:\n$$\n\\tilde{r} = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\nThis satisfies all conditions trivially: it is symmetric, positive semidefinite (all eigenvalues are $0$), and its trace is $0$, which is consistent with the near-zero trace of the input.\n\n**Step 2: Symmetrization**\nThe Reynolds stress tensor, $r_{ij} = \\widetilde{u_i'' u_j''}$, is by definition a covariance tensor and must be symmetric ($r_{ij} = r_{ji}$). Numerical models may produce a non-symmetric tensor $r_{in}$. To restore this fundamental property, we replace $r_{in}$ with its symmetric part, $r_{sym}$:\n$$\nr_{sym} = \\frac{1}{2} (r_{in} + r_{in}^{\\top})\n$$\nThis operation is essential because the spectral theorem, which is central to our method, applies only to symmetric matrices. Importantly, this step preserves the trace, and therefore the turbulent kinetic energy:\n$$\n\\operatorname{tr}(r_{sym}) = \\operatorname{tr}\\left(\\frac{1}{2} (r_{in} + r_{in}^{\\top})\\right) = \\frac{1}{2} (\\operatorname{tr}(r_{in}) + \\operatorname{tr}(r_{in}^{\\top})) = \\frac{1}{2}(T + T) = T\n$$\n\n**Step 3: Eigendecomposition**\nAccording to the spectral theorem for real symmetric matrices, any such matrix $r_{sym}$ can be orthogonally diagonalized. We perform an eigendecomposition of $r_{sym}$ to reveal its fundamental structure:\n$$\nr_{sym} = Q \\Lambda Q^{\\top}\n$$\nHere, $\\Lambda = \\operatorname{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$ is the diagonal matrix containing the real eigenvalues of $r_{sym}$, and $Q$ is an orthogonal matrix ($Q Q^{\\top} = Q^{\\top} Q = I$) whose columns are the corresponding orthonormal eigenvectors. This decomposition separates the tensor's properties into its principal strains (eigenvalues) and principal directions (eigenvectors).\n\n**Step 4: Eigenvalue Clipping for Positive Semidefiniteness**\nA symmetric matrix is positive semidefinite if and only if all of its eigenvalues are non-negative ($\\lambda_i \\ge 0$). A modeled tensor may yield one or more negative eigenvalues, violating physical realizability. To correct this, we clip the negative eigenvalues. The problem specifies a clipping threshold $\\varepsilon  0$. Each eigenvalue $\\lambda_i$ is replaced by a clipped value $\\lambda'_i$:\n$$\n\\lambda'_i = \\max(\\lambda_i, \\varepsilon)\n$$\nThis step ensures that all modified eigenvalues are strictly positive, guaranteeing that the resulting tensor will be positive definite (a stronger condition than positive semidefinite). Let $\\Lambda' = \\operatorname{diag}(\\lambda'_1, \\lambda'_2, \\lambda'_3)$.\n\n**Step 5: Trace-Preserving Scaling**\nThe clipping operation in the previous step generally alters the trace of the tensor. The trace of the clipped-eigenvalue tensor would be $T' = \\operatorname{tr}(\\Lambda') = \\sum_{i=1}^3 \\lambda'_i$, which is generally not equal to the original trace $T$. To satisfy the conservation of turbulent kinetic energy, we must enforce $\\operatorname{tr}(\\tilde{r}) = T$.\n\nWe achieve this by multiplicatively scaling the clipped eigenvalues. We compute a scaling factor $C$ and apply it to each $\\lambda'_i$ to obtain the final eigenvalues $\\tilde{\\lambda}_i$:\n$$\nC = \\frac{T}{T'} = \\frac{\\sum_{i=1}^3 \\lambda_i}{\\sum_{i=1}^3 \\max(\\lambda_i, \\varepsilon)}\n$$\n$$\n\\tilde{\\lambda}_i = C \\cdot \\lambda'_i = \\left( \\frac{T}{\\sum_{j=1}^3 \\lambda'_j} \\right) \\lambda'_i\n$$\nThis scaling ensures that the sum of the final eigenvalues equals the original trace:\n$$\n\\sum_{i=1}^3 \\tilde{\\lambda}_i = \\sum_{i=1}^3 C \\lambda'_i = C \\sum_{i=1}^3 \\lambda'_i = \\frac{T}{T'} T' = T\n$$\nSince $T  2\\delta  0$ in this branch of the algorithm, and $\\lambda'_i \\ge \\varepsilon  0$, it follows that $T'  0$ and $C  0$. Thus, all final eigenvalues $\\tilde{\\lambda}_i$ are positive, ensuring the resulting tensor is positive definite.\n\n**Step 6: Tensor Reconstruction and Final Output Calculation**\nThe final, realizable Reynolds stress tensor, $\\tilde{r}$, is reconstructed using the original eigenvectors from $Q$ and the new, adjusted eigenvalues $\\tilde{\\lambda}_i$ in the diagonal matrix $\\tilde{\\Lambda} = \\operatorname{diag}(\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3)$:\n$$\n\\tilde{r} = Q \\tilde{\\Lambda} Q^{\\top}\n$$\nBy construction, $\\tilde{r}$ is symmetric (since $Q \\tilde{\\Lambda} Q^{\\top}$ is symmetric), has a trace equal to the original trace $T$, and is positive definite (all eigenvalues $\\tilde{\\lambda}_i  0$). The requirement that the wall-normal stress be non-negative, $\\boldsymbol{n}^{\\top} \\tilde{r} \\, \\boldsymbol{n} \\ge 0$, is automatically satisfied because $\\tilde{r}$ is positive definite.\n\nThe final quantities to be reported for each test case are:\n1. The sorted eigenvalues of $\\tilde{r}$, which are simply the values $\\{\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3\\}$ arranged in non-decreasing order.\n2. The adjusted wall-normal stress, $s_n = \\boldsymbol{n}^{\\top} \\tilde{r} \\, \\boldsymbol{n}$.\n\nThis comprehensive procedure robustly transforms a potentially unphysical modeled tensor into one that satisfies all fundamental mathematical and physical constraints required in turbulence modeling.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef adjust_reynolds_stress(r_in, n_vec, epsilon, delta=1e-12):\n    \"\"\"\n    Adjusts a modeled Reynolds stress tensor to enforce realizability.\n\n    Args:\n        r_in (np.ndarray): A 3x3 possibly non-symmetric Reynolds stress tensor.\n        n_vec (np.ndarray): A 3x1 wall-normal unit vector.\n        epsilon (float): A small positive eigenvalue clipping threshold.\n        delta (float): A kinetic energy tolerance for the zero-energy case.\n\n    Returns:\n        list: A list containing [sorted_eigenvalues, wall_normal_stress].\n    \"\"\"\n    # Step 1: Pre-computation and Low-Energy Cutoff\n    trace_T = np.trace(r_in)\n    k = 0.5 * trace_T\n    \n    if k = delta:\n        # If TKE is negligible, return a zero tensor's properties\n        adjusted_r = np.zeros((3, 3))\n        sorted_eigvals = [0.0, 0.0, 0.0]\n        normal_stress = 0.0\n        return sorted_eigvals + [normal_stress]\n\n    # Step 2: Symmetrization\n    r_sym = 0.5 * (r_in + r_in.T)\n    # The trace is preserved: np.trace(r_sym) == trace_T\n\n    # Step 3: Eigendecomposition\n    # eigh is for symmetric/Hermitian matrices, which r_sym is.\n    # It guarantees real eigenvalues and orthonormal eigenvectors.\n    eigvals, eigvecs_Q = np.linalg.eigh(r_sym)\n\n    # Step 4: Eigenvalue Clipping\n    clipped_eigvals = np.maximum(eigvals, epsilon)\n\n    # Step 5: Trace-Preserving Scaling\n    trace_T_prime = np.sum(clipped_eigvals)\n    \n    # The scaling factor C = trace_T / trace_T_prime\n    # We are in the case where k  delta, so trace_T  2*delta  0.\n    # Also, clipped_eigvals_i = epsilon  0, so trace_T_prime  0.\n    # Thus, scaling_factor is well-defined and positive.\n    scaling_factor = trace_T / trace_T_prime\n    \n    adjusted_eigvals = clipped_eigvals * scaling_factor\n\n    # Step 6: Tensor Reconstruction and Final Output Calculation\n    # Reconstruct the tensor: adjusted_r = Q * diag(adjusted_eigvals) * Q.T\n    adjusted_r = eigvecs_Q @ np.diag(adjusted_eigvals) @ eigvecs_Q.T\n\n    # Calculate the wall-normal stress\n    # n_vec must be a column vector for this operation\n    n_vec_col = n_vec.reshape(3, 1)\n    normal_stress = (n_vec_col.T @ adjusted_r @ n_vec_col)[0, 0]\n\n    # The eigenvalues of the reconstructed tensor are the adjusted_eigvals\n    sorted_eigvals = sorted(adjusted_eigvals)\n\n    return sorted_eigvals + [normal_stress]\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"r\": np.array([[1.2, 0.1, 0.0], [0.1, -0.02, 0.0], [0.0, 0.0, 0.82]]),\n            \"n\": np.array([0., 1., 0.]),\n            \"eps\": 1e-6\n        },\n        {\n            \"r\": np.array([[0.5, 0.2, 0.3], [0.2, -0.4, 0.1], [0.3, 0.1, 1.1]]),\n            \"n\": np.array([0., 0., 1.]),\n            \"eps\": 1e-6\n        },\n        {\n            \"r\": np.array([[1e-10, 0, 0], [0, 2e-10, 0], [0, 0, -1e-11]]),\n            \"n\": np.array([1., 0., 0.]),\n            \"eps\": 1e-12\n        },\n        {\n            \"r\": np.array([[0.9, 0.3, -0.2], [0.25, 0.6, 0.4], [-0.15, 0.5, 0.7]]),\n            \"n\": np.array([1./np.sqrt(2), 1./np.sqrt(2), 0.]),\n            \"eps\": 1e-6\n        },\n        {\n            \"r\": np.array([[5e-13, 0, 0], [0, 5e-13, 0], [0, 0, 5e-13]]),\n            \"n\": np.array([0., 1., 0.]),\n            \"eps\": 1e-12\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = adjust_reynolds_stress(case[\"r\"], case[\"n\"], case[\"eps\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Format: [[a1,a2,a3,a4],[b1,b2,b3,b4],...]\n    formatted_results = []\n    for res in results:\n        # Format each inner list of floats\n        formatted_results.append(f\"[{','.join(map(str, res))}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}