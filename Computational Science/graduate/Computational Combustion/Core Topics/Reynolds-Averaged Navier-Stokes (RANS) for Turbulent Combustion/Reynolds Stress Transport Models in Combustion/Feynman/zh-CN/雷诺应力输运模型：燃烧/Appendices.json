{
    "hands_on_practices": [
        {
            "introduction": "要精通雷诺应力输运模型，首先必须熟练掌握其核心变量。本练习旨在巩固您对雷诺应力张量 ($R_{ij}$)、湍动能 ($k$) 和各向异性张量 ($a_{ij}$) 之间基本代数关系的理解。通过从核心定义出发进行推导，您将为理解和实现更复杂的湍流闭合模型打下坚实的基础。",
            "id": "4058898",
            "problem": "在用于湍流反应流的雷诺平均纳维-斯托克斯 (RANS) 模拟中，雷诺应力张量 $R_{ij}$ 出现在平均动量的输运方程中，以及燃烧中标量通量的封闭项中。考虑一个在笛卡尔坐标系 $(x,y,z)$ 中的不可压缩、恒密度混合物的统计定常、平面均匀剪切流，其平均速度 $\\overline{u}_{i}$ 的形式为 $\\overline{u}_{1} = S y$，$\\overline{u}_{2} = 0$，$\\overline{u}_{3} = 0$，其中 $S$ 是一个恒定的平均剪切率。假设湍流统计量具有空间均匀性，并且具有平面均匀剪切流典型的反射对称性，使得 $R_{13} = R_{31} = 0$ 和 $R_{23} = R_{32} = 0$，并且 $R_{ij}$ 是对称的。令脉动速度由雷诺分解 $u_{i} = \\overline{u}_{i} + u_{i}'$ 定义，雷诺应力张量为 $R_{ij} \\equiv \\overline{u_{i}' u_{j}'}$。湍动能定义为 $k \\equiv \\tfrac{1}{2} R_{ii}$。各向异性张量由核心关系式 $a_{ij} \\equiv \\dfrac{R_{ij}}{2k} - \\dfrac{1}{3}\\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 δ。\n\n仅使用这些核心定义和对平面均匀剪切流的对称性考虑，将 $R_{ij}$ 的所有非零分量用 $k$ 和 $a_{ij}$ 表示。以有序行向量 $(R_{11}, R_{22}, R_{33}, R_{12})$ 的封闭形式提供您的最终结果。无需进行数值计算，也无需四舍五入。如果引入任何其他符号，请明确定义。",
            "solution": "目标是用湍动能 $k$ 和各向异性张量 $a_{ij}$ 的分量来表示雷诺应力张量 $R_{ij}$ 的非零分量。问题提供了这些量之间的直接关系。\n\n各向异性张量 $a_{ij}$ 的核心定义如下：\n$$\na_{ij} \\equiv \\frac{R_{ij}}{2k} - \\frac{1}{3}\\delta_{ij}\n$$\n其中 $R_{ij} \\equiv \\overline{u_{i}' u_{j}'}$ 是雷诺应力张量，$k \\equiv \\frac{1}{2} R_{ii} = \\frac{1}{2}\\overline{u_{k}' u_{k}'}$ 是湍动能，而 $\\delta_{ij}$ 是克罗内克 δ。\n\n为了用 $k$ 和 $a_{ij}$ 表示 $R_{ij}$，我们必须重新整理这个定义方程。首先，我们分离出包含 $R_{ij}$ 的项：\n$$\na_{ij} + \\frac{1}{3}\\delta_{ij} = \\frac{R_{ij}}{2k}\n$$\n接下来，我们在方程两边同乘以 $2k$ 来求解 $R_{ij}$：\n$$\nR_{ij} = 2k \\left( a_{ij} + \\frac{1}{3}\\delta_{ij} \\right)\n$$\n这个方程为雷诺应力张量的任意分量提供了一个通用表达式。我们现在可以用它来找到所要求的特定非零分量：$R_{11}$、$R_{22}$、$R_{33}$ 和 $R_{12}$。问题指明，对于平面均匀剪切流的情况，$R_{13} = R_{31} = 0$ 且 $R_{23} = R_{32} = 0$。\n\n我们通过相应地设置索引 $i$ 和 $j$ 并回顾克罗内克 δ $\\delta_{ij}$ 的性质（当 $i=j$ 时等于 $1$，当 $i \\neq j$ 时等于 $0$），来计算每个分量的表达式。\n\n对于第一个正应力分量 $R_{11}$，我们设置 $i=1$ 和 $j=1$。克罗内克 δ 为 $\\delta_{11} = 1$：\n$$\nR_{11} = 2k \\left( a_{11} + \\frac{1}{3}\\delta_{11} \\right) = 2k \\left( a_{11} + \\frac{1}{3} \\right)\n$$\n\n对于第二个正应力分量 $R_{22}$，我们设置 $i=2$ 和 $j=2$。克罗内克 δ 为 $\\delta_{22} = 1$：\n$$\nR_{22} = 2k \\left( a_{22} + \\frac{1}{3}\\delta_{22} \\right) = 2k \\left( a_{22} + \\frac{1}{3} \\right)\n$$\n\n对于第三个正应力分量 $R_{33}$，我们设置 $i=3$ 和 $j=3$。克罗内克 δ 为 $\\delta_{33} = 1$：\n$$\nR_{33} = 2k \\left( a_{33} + \\frac{1}{3}\\delta_{33} \\right) = 2k \\left( a_{33} + \\frac{1}{3} \\right)\n$$\n\n对于主剪应力分量 $R_{12}$，我们设置 $i=1$ 和 $j=2$。克罗内克 δ 为 $\\delta_{12} = 0$：\n$$\nR_{12} = 2k \\left( a_{12} + \\frac{1}{3}\\delta_{12} \\right) = 2k \\left( a_{12} + 0 \\right) = 2k a_{12}\n$$\n由于雷诺应力张量的对称性，$R_{21} = R_{12}$。\n\n作为一致性检查，各向异性张量根据其构造是一个无迹张量。我们可以从其定义来验证这一点：\n$$\na_{ii} = \\frac{R_{ii}}{2k} - \\frac{1}{3}\\delta_{ii}\n$$\n使用湍动能的定义 $k = \\frac{1}{2} R_{ii}$，我们得到 $R_{ii} = 2k$。克罗内克 δ 的迹是 $\\delta_{ii} = \\delta_{11} + \\delta_{22} + \\delta_{33} = 1 + 1 + 1 = 3$。将这些代入 $a_{ij}$ 的迹的表达式中：\n$$\na_{ii} = \\frac{2k}{2k} - \\frac{1}{3}(3) = 1 - 1 = 0\n$$\n这证实了 $a_{11} + a_{22} + a_{33} = 0$，这是各向异性张量的一个基本性质。\n\n因此，所要求的四个非零分量就用 $k$ 和 $a_{ij}$ 的相应分量表示出来了。最终结果是有序行向量 $(R_{11}, R_{22}, R_{33}, R_{12})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2k \\left( a_{11} + \\frac{1}{3} \\right)  2k \\left( a_{22} + \\frac{1}{3} \\right)  2k \\left( a_{33} + \\frac{1}{3} \\right)  2k a_{12}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了雷诺应力张量的各个分量之后，下一步是解读其物理意义。本练习将介绍一种强大的可视化工具——重心图（Barycentric Map），也称为 Lumley 三角图，用于直观地展示湍流的各向异性状态。通过计算各向异性张量的特征值并将其映射到一个二维空间，您将学会如何评估湍流结构是趋向于一维、二维还是各向同性。",
            "id": "4058935",
            "problem": "使用雷诺平均纳维-斯托克斯 (RANS) 方法和一个雷诺应力输运模型，对一个贫预混火焰进行了模拟。在火焰锋内某一点，雷诺应力张量 $\\mathbf{R}$ 在其主框架中是对角的，其特征值为 $R_{1}$、$R_{2}$ 和 $R_{3}$，满足 $R_{1} \\geq R_{2} \\geq R_{3}$。湍动能为 $k = \\frac{1}{2} \\operatorname{tr}(\\mathbf{R})$。各向异性张量定义为\n$$\n\\mathbf{b} = \\frac{\\mathbf{R}}{2k} - \\frac{1}{3}\\mathbf{I},\n$$\n其有序特征值为 $b_{1} \\geq b_{2} \\geq b_{3}$。\n\n湍流各向异性的重心图将湍流状态表示为三种极限组分性状态的凸组合：单分量湍流 ($1\\mathrm{C}$)、双分量湍流 ($2\\mathrm{C}$) 和三分量各向同性湍流 ($3\\mathrm{C}$)。这些极限状态位于笛卡尔坐标系中一个等边三角形的顶点上：\n$$\n\\text{$1\\mathrm{C}$ at } (x_{1\\mathrm{C}}, y_{1\\mathrm{C}}) = (1, 0), \\quad \\text{$2\\mathrm{C}$ at } (x_{2\\mathrm{C}}, y_{2\\mathrm{C}}) = (0, 0), \\quad \\text{$3\\mathrm{C}$ at } (x_{3\\mathrm{C}}, y_{3\\mathrm{C}}) = \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right).\n$$\n重心权重 $(C_{1\\mathrm{C}}, C_{2\\mathrm{C}}, C_{3\\mathrm{C}})$ 是非负的，且总和为 1，映射点 $(x, y)$ 由下式给出：\n$$\nx = C_{1\\mathrm{C}} x_{1\\mathrm{C}} + C_{2\\mathrm{C}} x_{2\\mathrm{C}} + C_{3\\mathrm{C}} x_{3\\mathrm{C}}, \\qquad\ny = C_{1\\mathrm{C}} y_{1\\mathrm{C}} + C_{2\\mathrm{C}} y_{2\\mathrm{C}} + C_{3\\mathrm{C}} y_{3\\mathrm{C}}.\n$$\n\n在所选点上，测量得出 $R_{1} = 0.9$，$R_{2} = 0.4$ 和 $R_{3} = 0.2$（单位均为 $\\mathrm{m^{2}\\,s^{-2}}$），以及 $k = 0.75$（单位为 $\\mathrm{m^{2}\\,s^{-2}}$）。使用以上定义，从 $\\mathbf{b}$ 的特征值计算重心权重，将状态映射到笛卡尔坐标 $(x, y)$，并提供最终的 $(x, y)$ 值。将最终的笛卡尔坐标四舍五入到四位有效数字。坐标是无量纲的；最终数值答案中不要包含单位。",
            "solution": "### 解答\n\n第一步是计算各向异性张量 $\\mathbf{b}$ 的特征值。由于雷诺应力张量 $\\mathbf{R}$ 是在其主框架中给出的（即，它是对角的），因此各向异性张量 $\\mathbf{b} = \\frac{\\mathbf{R}}{2k} - \\frac{1}{3}\\mathbf{I}$ 在同一框架中也是对角的。它的特征值 $b_1, b_2, b_3$ 可以直接从 $\\mathbf{R}$ 的特征值 $R_1, R_2, R_3$ 计算得出。\n\n关系式如下：\n$$\nb_i = \\frac{R_i}{2k} - \\frac{1}{3} \\quad \\text{for } i \\in \\{1, 2, 3\\}\n$$\n我们已知 $R_{1} = 0.9$，$R_{2} = 0.4$，$R_{3} = 0.2$，以及 $k = 0.75$。因此，$2k = 2 \\times 0.75 = 1.5$。\n$\\mathbf{b}$ 的特征值是：\n$$\nb_1 = \\frac{0.9}{1.5} - \\frac{1}{3} = \\frac{3}{5} - \\frac{1}{3} = \\frac{9-5}{15} = \\frac{4}{15}\n$$\n$$\nb_2 = \\frac{0.4}{1.5} - \\frac{1}{3} = \\frac{4}{15} - \\frac{5}{15} = -\\frac{1}{15}\n$$\n$$\nb_3 = \\frac{0.2}{1.5} - \\frac{1}{3} = \\frac{2}{15} - \\frac{5}{15} = -\\frac{3}{15} = -\\frac{1}{5}\n$$\n作为验证，$\\mathbf{b}$ 的迹必须为零：$\\operatorname{tr}(\\mathbf{b}) = b_1 + b_2 + b_3 = \\frac{4}{15} - \\frac{1}{15} - \\frac{3}{15} = 0$。计算是正确的。\n\n接下来，我们计算重心权重 $(C_{1\\mathrm{C}}, C_{2\\mathrm{C}}, C_{3\\mathrm{C}})$。对于指定的重心图，权重根据 $\\mathbf{b}$ 的有序特征值 ($b_1 \\geq b_2 \\geq b_3$) 定义如下：\n$$\nC_{1\\mathrm{C}} = b_1 - b_2\n$$\n$$\nC_{2\\mathrm{C}} = 2(b_2 - b_3)\n$$\n$$\nC_{3\\mathrm{C}} = 3b_3 + 1\n$$\n代入计算出的 $b_i$ 值：\n$$\nC_{1\\mathrm{C}} = \\frac{4}{15} - \\left(-\\frac{1}{15}\\right) = \\frac{5}{15} = \\frac{1}{3}\n$$\n$$\nC_{2\\mathrm{C}} = 2\\left(-\\frac{1}{15} - \\left(-\\frac{1}{5}\\right)\\right) = 2\\left(-\\frac{1}{15} + \\frac{3}{15}\\right) = 2\\left(\\frac{2}{15}\\right) = \\frac{4}{15}\n$$\n$$\nC_{3\\mathrm{C}} = 3\\left(-\\frac{1}{5}\\right) + 1 = -\\frac{3}{5} + 1 = \\frac{2}{5}\n$$\n我们检查权重之和是否为 1：$C_{1\\mathrm{C}} + C_{2\\mathrm{C}} + C_{3\\mathrm{C}} = \\frac{1}{3} + \\frac{4}{15} + \\frac{2}{5} = \\frac{5}{15} + \\frac{4}{15} + \\frac{6}{15} = \\frac{15}{15} = 1$。权重是正确的。\n\n最后，我们使用给定的重心变换和顶点位置，将湍流状态映射到笛卡尔坐标 $(x,y)$：\n$$\nx = C_{1\\mathrm{C}} x_{1\\mathrm{C}} + C_{2\\mathrm{C}} x_{2\\mathrm{C}} + C_{3\\mathrm{C}} x_{3\\mathrm{C}}\n$$\n$$\ny = C_{1\\mathrm{C}} y_{1\\mathrm{C}} + C_{2\\mathrm{C}} y_{2\\mathrm{C}} + C_{3\\mathrm{C}} y_{3\\mathrm{C}}\n$$\n当 $(x_{1\\mathrm{C}}, y_{1\\mathrm{C}}) = (1, 0)$，$(x_{2\\mathrm{C}}, y_{2\\mathrm{C}}) = (0, 0)$，以及 $(x_{3\\mathrm{C}}, y_{3\\mathrm{C}}) = (\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$ 时，方程变为：\n$$\nx = C_{1\\mathrm{C}}(1) + C_{2\\mathrm{C}}(0) + C_{3\\mathrm{C}}\\left(\\frac{1}{2}\\right) = C_{1\\mathrm{C}} + \\frac{1}{2}C_{3\\mathrm{C}}\n$$\n$$\ny = C_{1\\mathrm{C}}(0) + C_{2\\mathrm{C}}(0) + C_{3\\mathrm{C}}\\left(\\frac{\\sqrt{3}}{2}\\right) = \\frac{\\sqrt{3}}{2}C_{3\\mathrm{C}}\n$$\n代入权重值：\n$$\nx = \\frac{1}{3} + \\frac{1}{2}\\left(\\frac{2}{5}\\right) = \\frac{1}{3} + \\frac{1}{5} = \\frac{5+3}{15} = \\frac{8}{15}\n$$\n$$\ny = \\frac{\\sqrt{3}}{2}\\left(\\frac{2}{5}\\right) = \\frac{\\sqrt{3}}{5}\n$$\n问题要求将最终坐标四舍五入到四位有效数字。我们计算其小数值：\n$$\nx = \\frac{8}{15} \\approx 0.533333...\n$$\n$$\ny = \\frac{\\sqrt{3}}{5} \\approx \\frac{1.7320508...}{5} \\approx 0.346410...\n$$\n四舍五入到四位有效数字得到：\n$x \\approx 0.5333$\n$y \\approx 0.3464$\n\n湍流状态的映射笛卡尔坐标为 $(0.5333, 0.3464)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5333  0.3464 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在数值模拟中，模型和离散化误差有时会导致雷诺应力输运模型产生非物理性的结果。本练习聚焦于“可实现性”（Realizability）这一关键概念，即模型化的雷诺应力张量必须是半正定的。您将通过一个编程练习，实现一个基于特征值裁剪的标准算法，用于修正不满足可实现性条件的张量，同时确保湍动能守恒，从而深入了解构建稳健数值模型的实际挑战。",
            "id": "4058917",
            "problem": "请考虑在燃烧学中使用密度加权（Favre）平均的雷诺应力输运模型。设模拟的雷诺应力张量为法夫尔速度脉动的协方差，定义为 $r_{ij} = \\widetilde{u_i'' u_j''}$，其中波浪号表示Favre平均。根据协方差的定义，张量 $r_{ij}$ 是对称且半正定的，湍动能 $k$ 满足 $k = \\dfrac{1}{2} r_{ii}$，因此 $\\operatorname{tr}(r_{ij}) = 2k$。在反应流的近壁区，数值离散化和模型近似可能会产生违反可实现性的模拟 $r_{ij}$，例如出现负法向应力。可实现性约束要求 $r_{ij}$ 是对称半正定的，并且对于任意向量 $\\boldsymbol{a}$，其二次型 $\\boldsymbol{a}^{\\top} r \\boldsymbol{a} \\ge 0$ 均为非负。\n\n您的任务是设计并实现一个算法，该算法通过特征值裁剪来调整给定的近壁区模拟雷诺应力张量，以强制满足可实现性，同时保持湍动能不变。该算法必须：\n- 接受一个可能非对称的 $3 \\times 3$ 矩阵 $r$（物理单位为 $\\mathrm{m}^2/\\mathrm{s}^2$）和一个壁面法向单位向量 $\\boldsymbol{n}$。\n- 生成一个调整后的对称半正定张量 $\\tilde{r}$，该张量保持从输入 $r$ 计算出的原始湍动能 $k$ 不变（即 $\\operatorname{tr}(\\tilde{r}) = \\operatorname{tr}(r)$）。\n- 通过确保对于给定的壁面法向向量 $\\boldsymbol{n}$，调整后的法向应力满足 $\\boldsymbol{n}^{\\top} \\tilde{r} \\, \\boldsymbol{n} \\ge 0$，来避免负法向应力。\n- 使用特征值裁剪方法和一个下限阈值 $\\varepsilon > 0$ 来强制谱分量的非负性。\n- 如有必要，对输入进行对称化，并引入一个数值容差来处理湍动能消失的情况。\n\n您的推导和实现的基本依据必须仅限于：\n- 雷诺应力张量作为协方差的定义及其相关的半正定性。\n- 定义 $k = \\dfrac{1}{2} r_{ii}$ 和 $\\operatorname{tr}(r) = 2k$。\n- 实对称矩阵的谱定理。\n\n数值容差和单位：\n- 使用动能容差 $\\delta = 10^{-12} \\, \\mathrm{m}^2/\\mathrm{s}^2$ 来处理能量消失的情况。如果 $k \\le \\delta$，则设置 $\\tilde{r} = 0$。\n- 所有输入和输出均表示单位为 $\\mathrm{m}^2/\\mathrm{s}^2$ 的应力。以原始浮点数形式表示最终的数值答案，不带单位符号。\n\n测试套件：\n为以下测试用例实现您的算法。对每个用例 $(r^{(i)}, \\boldsymbol{n}^{(i)}, \\varepsilon^{(i)})$，计算调整后张量 $\\tilde{r}^{(i)}$ 的排序特征值和调整后的壁面法向应力 $s_n^{(i)} = \\boldsymbol{n}^{(i)\\top} \\tilde{r}^{(i)} \\, \\boldsymbol{n}^{(i)}$。将每个用例的结果报告为一个包含四个浮点数的列表 $[\\lambda_1^{(i)}, \\lambda_2^{(i)}, \\lambda_3^{(i)}, s_n^{(i)}]$，其中 $\\lambda_1^{(i)} \\le \\lambda_2^{(i)} \\le \\lambda_3^{(i)}$。使用为每个用例提供的下限裁剪参数 $\\varepsilon^{(i)}$。\n\n- 用例1（正常路径，存在小的负法向分量）：\n  $$\n  r^{(1)} = \\begin{bmatrix}\n  1.2  0.1  0.0 \\\\\n  0.1  -0.02  0.0 \\\\\n  0.0  0.0  0.82\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(1)} = \\begin{bmatrix}0 \\\\ 1 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(1)} = 10^{-6}.\n  $$\n- 用例2（存在强烈的负模拟分量）：\n  $$\n  r^{(2)} = \\begin{bmatrix}\n  0.5  0.2  0.3 \\\\\n  0.2  -0.4  0.1 \\\\\n  0.3  0.1  1.1\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(2)} = \\begin{bmatrix}0 \\\\ 0 \\\\ 1\\end{bmatrix}, \\quad\n  \\varepsilon^{(2)} = 10^{-6}.\n  $$\n- 用例3（能量接近零，且存在小的负特征值）：\n  $$\n  r^{(3)} = \\begin{bmatrix}\n  10^{-10}  0  0 \\\\\n  0  2 \\times 10^{-10}  0 \\\\\n  0  0  -10^{-11}\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(3)} = \\begin{bmatrix}1 \\\\ 0 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(3)} = 10^{-12}.\n  $$\n- 用例4（需要对称化的非对称输入）：\n  $$\n  r^{(4)} = \\begin{bmatrix}\n  0.9  0.3  -0.2 \\\\\n  0.25  0.6  0.4 \\\\\n  -0.15  0.5  0.7\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(4)} = \\dfrac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(4)} = 10^{-6}.\n  $$\n- 用例5（能量消失边界，触发零张量）：\n  $$\n  r^{(5)} = \\begin{bmatrix}\n  5 \\times 10^{-13}  0  0 \\\\\n  0  5 \\times 10^{-13}  0 \\\\\n  0  0  5 \\times 10^{-13}\n  \\end{bmatrix}, \\quad\n  \\boldsymbol{n}^{(5)} = \\begin{bmatrix}0 \\\\ 1 \\\\ 0\\end{bmatrix}, \\quad\n  \\varepsilon^{(5)} = 10^{-12}.\n  $$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身也是一个包含四个浮点数 $[\\lambda_1^{(i)}, \\lambda_2^{(i)}, \\lambda_3^{(i)}, s_n^{(i)}]$ 的列表（$i=1, 2, 3, 4, 5$）。例如，结构必须类似于 $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],\\dots]$，所有值的单位均为 $\\mathrm{m}^2/\\mathrm{s}^2$。",
            "solution": "当前的问题是设计并实现一个数值算法，用于对计算燃烧学数值模拟中可能出现的 $3 \\times 3$ 模拟雷诺应力张量 $r$ 强制施加物理可实现性。可实现性的核心约束是张量必须是对称和半正定的。该算法必须修正任何对这些性质的违反，同时遵守保持湍动能 $k$ 守恒的关键物理约束，该动能与张量的迹呈线性关系，$k = \\frac{1}{2} \\operatorname{tr}(r)$。\n\n该方法论基于线性代数和湍流模型的既定原理。该算法系统地通过几个步骤进行，每个步骤都基于特定的物理或数学要求。\n\n**步骤1：预计算和低能量截断**\n首先，我们处理流动的基态。湍动能 $k$ 定义为 $k = \\frac{1}{2} r_{ii} = \\frac{1}{2}\\operatorname{tr}(r)$。为保证数值稳定性和物理一致性，如果动能低于指定的小容差 $\\delta$，则认为湍流脉动是可忽略的。\n设输入张量为 $r_{in}$。我们计算其迹 $T = \\operatorname{tr}(r_{in})$。湍动能为 $k = \\frac{1}{2}T$。\n如果 $k \\le \\delta$，其中 $\\delta = 10^{-12} \\, \\mathrm{m}^2/\\mathrm{s}^2$，则认为湍流场已经消失。在这种情况下，将调整后的雷诺应力张量 $\\tilde{r}$ 设置为零矩阵：\n$$\n\\tilde{r} = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n这不证自明地满足了所有条件：它是对称的，半正定的（所有特征值均为0），其迹为0，这与输入的近零迹是一致的。\n\n**步骤2：对称化**\n雷诺应力张量 $r_{ij} = \\widetilde{u_i'' u_j''}$ 根据定义是一个协方差张量，必须是对称的（$r_{ij} = r_{ji}$）。数值模型可能会产生非对称张量 $r_{in}$。为了恢复这一基本属性，我们将 $r_{in}$ 替换为其对称部分 $r_{sym}$：\n$$\nr_{sym} = \\frac{1}{2} (r_{in} + r_{in}^{\\top})\n$$\n此操作至关重要，因为作为我们方法核心的谱定理仅适用于对称矩阵。重要的是，此步骤保持迹不变，因此湍动能也不变：\n$$\n\\operatorname{tr}(r_{sym}) = \\operatorname{tr}\\left(\\frac{1}{2} (r_{in} + r_{in}^{\\top})\\right) = \\frac{1}{2} (\\operatorname{tr}(r_{in}) + \\operatorname{tr}(r_{in}^{\\top})) = \\frac{1}{2}(T + T) = T\n$$\n\n**步骤3：特征分解**\n根据实对称矩阵的谱定理，任何此类矩阵 $r_{sym}$ 都可以被正交对角化。我们对 $r_{sym}$ 进行特征分解，以揭示其基本结构：\n$$\nr_{sym} = Q \\Lambda Q^{\\top}\n$$\n这里，$\\Lambda = \\operatorname{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$ 是包含 $r_{sym}$ 实特征值的对角矩阵，$Q$ 是一个正交矩阵（$Q Q^{\\top} = Q^{\\top} Q = I$），其列是相应的标准正交特征向量。这种分解将张量的属性分离为其主应变（特征值）和主方向（特征向量）。\n\n**步骤4：为保证半正定性进行特征值裁剪**\n一个对称矩阵是半正定的，当且仅当其所有特征值都为非负（$\\lambda_i \\ge 0$）。模拟张量可能会产生一个或多个负特征值，从而违反物理可实现性。为了修正这一点，我们裁剪负特征值。问题指定了一个裁剪阈值 $\\varepsilon > 0$。每个特征值 $\\lambda_i$ 被替换为一个裁剪后的值 $\\lambda'_i$：\n$$\n\\lambda'_i = \\max(\\lambda_i, \\varepsilon)\n$$\n此步骤确保所有修改后的特征值都严格为正，从而保证得到的张量是正定的（一个比半正定更强的条件）。令 $\\Lambda' = \\operatorname{diag}(\\lambda'_1, \\lambda'_2, \\lambda'_3)$。\n\n**步骤5：保持迹的缩放**\n前一步的裁剪操作通常会改变张量的迹。裁剪后特征值张量的迹将是 $T' = \\operatorname{tr}(\\Lambda') = \\sum_{i=1}^3 \\lambda'_i$，这通常不等于原始的迹 $T$。为满足湍动能守恒，我们必须强制执行 $\\operatorname{tr}(\\tilde{r}) = T$。\n\n我们通过对裁剪后的特征值进行乘法缩放来实现这一点。我们计算一个缩放因子 $C$ 并将其应用于每个 $\\lambda'_i$ 以获得最终的特征值 $\\tilde{\\lambda}_i$：\n$$\nC = \\frac{T}{T'} = \\frac{\\sum_{i=1}^3 \\lambda_i}{\\sum_{i=1}^3 \\max(\\lambda_i, \\varepsilon)}\n$$\n$$\n\\tilde{\\lambda}_i = C \\cdot \\lambda'_i = \\left( \\frac{T}{\\sum_{j=1}^3 \\lambda'_j} \\right) \\lambda'_i\n$$\n这种缩放确保了最终特征值的总和等于原始的迹：\n$$\n\\sum_{i=1}^3 \\tilde{\\lambda}_i = \\sum_{i=1}^3 C \\lambda'_i = C \\sum_{i=1}^3 \\lambda'_i = \\frac{T}{T'} T' = T\n$$\n由于在此算法分支中 $T > 2\\delta > 0$，并且 $\\lambda'_i \\ge \\varepsilon > 0$，因此 $T' > 0$ 且 $C > 0$。因此，所有最终特征值 $\\tilde{\\lambda}_i$ 均为正，确保了得到的张量是正定的。\n\n**步骤6：张量重构与最终输出计算**\n最终的可实现的雷诺应力张量 $\\tilde{r}$ 是使用来自 $Q$ 的原始特征向量和新的、调整后的特征值 $\\tilde{\\lambda}_i$（在对角矩阵 $\\tilde{\\Lambda} = \\operatorname{diag}(\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3)$ 中）重构的：\n$$\n\\tilde{r} = Q \\tilde{\\Lambda} Q^{\\top}\n$$\n根据构造，$\\tilde{r}$ 是对称的（因为 $Q \\tilde{\\Lambda} Q^{\\top}$ 是对称的），其迹等于原始迹 $T$，并且是正定的（所有特征值 $\\tilde{\\lambda}_i > 0$）。由于 $\\tilde{r}$ 是正定的，壁面法向应力为非负的要求 $\\boldsymbol{n}^{\\top} \\tilde{r} \\, \\boldsymbol{n} \\ge 0$ 被自动满足。\n\n每个测试用例需要报告的最终量是：\n1. $\\tilde{r}$ 的排序特征值，即 $\\{\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3\\}$ 这些值按非递减顺序排列。\n2. 调整后的壁面法向应力，$s_n = \\boldsymbol{n}^{\\top} \\tilde{r} \\, \\boldsymbol{n}$。\n\n这个全面的过程稳健地将一个可能不符合物理的模拟张量转换为一个满足湍流模型中所有基本数学和物理约束的张量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef adjust_reynolds_stress(r_in, n_vec, epsilon, delta=1e-12):\n    \"\"\"\n    Adjusts a modeled Reynolds stress tensor to enforce realizability.\n\n    Args:\n        r_in (np.ndarray): A 3x3 possibly non-symmetric Reynolds stress tensor.\n        n_vec (np.ndarray): A 3x1 wall-normal unit vector.\n        epsilon (float): A small positive eigenvalue clipping threshold.\n        delta (float): A kinetic energy tolerance for the zero-energy case.\n\n    Returns:\n        list: A list containing [sorted_eigenvalues, wall_normal_stress].\n    \"\"\"\n    # Step 1: Pre-computation and Low-Energy Cutoff\n    trace_T = np.trace(r_in)\n    k = 0.5 * trace_T\n    \n    if k = delta:\n        # If TKE is negligible, return a zero tensor's properties\n        adjusted_r = np.zeros((3, 3))\n        sorted_eigvals = [0.0, 0.0, 0.0]\n        normal_stress = 0.0\n        return sorted_eigvals + [normal_stress]\n\n    # Step 2: Symmetrization\n    r_sym = 0.5 * (r_in + r_in.T)\n    # The trace is preserved: np.trace(r_sym) == trace_T\n\n    # Step 3: Eigendecomposition\n    # eigh is for symmetric/Hermitian matrices, which r_sym is.\n    # It guarantees real eigenvalues and orthonormal eigenvectors.\n    eigvals, eigvecs_Q = np.linalg.eigh(r_sym)\n\n    # Step 4: Eigenvalue Clipping\n    clipped_eigvals = np.maximum(eigvals, epsilon)\n\n    # Step 5: Trace-Preserving Scaling\n    trace_T_prime = np.sum(clipped_eigvals)\n    \n    # The scaling factor C = trace_T / trace_T_prime\n    # We are in the case where k  delta, so trace_T  2*delta  0.\n    # Also, clipped_eigvals_i = epsilon  0, so trace_T_prime  0.\n    # Thus, scaling_factor is well-defined and positive.\n    scaling_factor = trace_T / trace_T_prime\n    \n    adjusted_eigvals = clipped_eigvals * scaling_factor\n\n    # Step 6: Tensor Reconstruction and Final Output Calculation\n    # Reconstruct the tensor: adjusted_r = Q * diag(adjusted_eigvals) * Q.T\n    adjusted_r = eigvecs_Q @ np.diag(adjusted_eigvals) @ eigvecs_Q.T\n\n    # Calculate the wall-normal stress\n    # n_vec must be a column vector for this operation\n    n_vec_col = n_vec.reshape(3, 1)\n    normal_stress = (n_vec_col.T @ adjusted_r @ n_vec_col)[0, 0]\n\n    # The eigenvalues of the reconstructed tensor are the adjusted_eigvals\n    sorted_eigvals = sorted(adjusted_eigvals)\n\n    return sorted_eigvals + [normal_stress]\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"r\": np.array([[1.2, 0.1, 0.0], [0.1, -0.02, 0.0], [0.0, 0.0, 0.82]]),\n            \"n\": np.array([0., 1., 0.]),\n            \"eps\": 1e-6\n        },\n        {\n            \"r\": np.array([[0.5, 0.2, 0.3], [0.2, -0.4, 0.1], [0.3, 0.1, 1.1]]),\n            \"n\": np.array([0., 0., 1.]),\n            \"eps\": 1e-6\n        },\n        {\n            \"r\": np.array([[1e-10, 0, 0], [0, 2e-10, 0], [0, 0, -1e-11]]),\n            \"n\": np.array([1., 0., 0.]),\n            \"eps\": 1e-12\n        },\n        {\n            \"r\": np.array([[0.9, 0.3, -0.2], [0.25, 0.6, 0.4], [-0.15, 0.5, 0.7]]),\n            \"n\": np.array([1./np.sqrt(2), 1./np.sqrt(2), 0.]),\n            \"eps\": 1e-6\n        },\n        {\n            \"r\": np.array([[5e-13, 0, 0], [0, 5e-13, 0], [0, 0, 5e-13]]),\n            \"n\": np.array([0., 1., 0.]),\n            \"eps\": 1e-12\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = adjust_reynolds_stress(case[\"r\"], case[\"n\"], case[\"eps\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Format: [[a1,a2,a3,a4],[b1,b2,b3,b4],...]\n    # Using a list comprehension and f-strings for concise formatting\n    print(f\"[{','.join([str(res) for res in results])}]\".replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}