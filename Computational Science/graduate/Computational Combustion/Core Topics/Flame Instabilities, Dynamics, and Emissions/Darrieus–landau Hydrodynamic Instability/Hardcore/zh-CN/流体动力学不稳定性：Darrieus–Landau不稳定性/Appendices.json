{
    "hands_on_practices": [
        {
            "introduction": "达里厄-朗道（DL）不稳定性从根本上是由未燃气体转变为高温产物时的密度降低所驱动的。本练习通过检验经典的线性增长率公式来深入探讨这一核心机制。通过计算增长率 $\\omega$ 对膨胀比 $E$ 的敏感性，您将对不稳定性受放热驱动的强度建立起定量的感觉，这有助于加深您对不稳定性主要驱动因素的物理直觉 。",
            "id": "4015870",
            "problem": "一个受到波数大小为 $|k|$ 的小振幅正弦扰动的二维、无粘性、零厚度、平面预混火焰会表现出 Darrieus–Landau (DL) 流体动力学不稳定性。设 $S_L$ 表示未拉伸层流火焰速度，气体膨胀比为 $E \\equiv \\rho_u/\\rho_b > 1$，其中 $\\rho_u$ 和 $\\rho_b$ 分别是未燃气体和已燃气体的密度。在此类火焰的经典线性理论中，单个傅里叶模态的时间增长率由下式给出：\n$$\\omega = S_L |k| \\frac{E - 1}{E + 1}.$$\n将 $S_L$ 和 $|k|$ 视为常数，计算增长率对膨胀比的参数敏感性 $\\frac{\\partial \\omega}{\\partial E}$，并将其表示为 $E$、$S_L$ 和 $|k|$ 的显式解析函数。然后，在极限 $E \\to 1^+$ 和 $E \\to \\infty$ 的情况下，从物理上解释该敏感性的符号和大小，并说明 $\\frac{\\partial \\omega}{\\partial E}$ 的单位。你最终报告的答案必须仅为 $\\frac{\\partial \\omega}{\\partial E}$ 的闭式解析表达式，不带单位。",
            "solution": "该问题要求计算 Darrieus–Landau 不稳定性增长率 $\\omega$ 对气体膨胀比 $E$ 的参数敏感性。给定的增长率表达式为：\n$$ \\omega = S_L |k| \\frac{E - 1}{E + 1} $$\n其中 $S_L$ 是未拉伸层流火焰速度， $|k|$ 是扰动波数大小， $E = \\rho_u / \\rho_b > 1$ 是膨胀比。我们的任务是计算偏导数 $\\frac{\\partial \\omega}{\\partial E}$，并将 $S_L$ 和 $|k|$ 视为常数。\n\n为了求得敏感性，我们将 $\\omega$ 的表达式对 $E$ 求导：\n$$ \\frac{\\partial \\omega}{\\partial E} = \\frac{\\partial}{\\partial E} \\left( S_L |k| \\frac{E - 1}{E + 1} \\right) $$\n由于 $S_L$ 和 $|k|$ 被视为常数，我们可以将它们从导数中提取出来：\n$$ \\frac{\\partial \\omega}{\\partial E} = S_L |k| \\frac{\\partial}{\\partial E} \\left( \\frac{E - 1}{E + 1} \\right) $$\n我们应用除法求导法则，该法则指出，对于函数 $u(E)$ 和 $v(E)$，$\\frac{d}{dE}\\left(\\frac{u}{v}\\right) = \\frac{v \\frac{du}{dE} - u \\frac{dv}{dE}}{v^2}$。设 $u(E) = E - 1$ 和 $v(E) = E + 1$。它们对 $E$ 的导数是：\n$$ \\frac{du}{dE} = \\frac{d}{dE}(E - 1) = 1 $$\n$$ \\frac{dv}{dE} = \\frac{d}{dE}(E + 1) = 1 $$\n将这些代入除法法则：\n$$ \\frac{\\partial}{\\partial E} \\left( \\frac{E - 1}{E + 1} \\right) = \\frac{(E + 1)(1) - (E - 1)(1)}{(E + 1)^2} = \\frac{E + 1 - E + 1}{(E + 1)^2} = \\frac{2}{(E + 1)^2} $$\n将此结果代回到 $\\frac{\\partial \\omega}{\\partial E}$ 的表达式中，我们得到敏感性的最终解析表达式：\n$$ \\frac{\\partial \\omega}{\\partial E} = S_L |k| \\frac{2}{(E + 1)^2} $$\n这就是增长率对膨胀比的敏感性的闭式解析表达式。\n\n接下来，我们解释该敏感性的符号和大小。物理上，$S_L$ 和 $|k|$ 均为正值（对于非平凡扰动，$S_L > 0$ 且 $|k| > 0$）。由于 $E > 1$，项 $(E+1)^2$ 也严格为正。因此，$\\frac{\\partial \\omega}{\\partial E}$ 总是正的。这表明不稳定性增长率 $\\omega$ 是膨胀比 $E$ 的单调递增函数。火焰前后更大的密度降（即更大的 $E$）总是导致更强的不稳定性，这在物理上是符合预期的，因为该不稳定性是由气体膨胀的流体动力学效应驱动的。\n\n现在我们分析 $E \\to 1^+$ 和 $E \\to \\infty$ 时的极限。\n\n在弱膨胀极限下，$E \\to 1^+$：\n$$ \\lim_{E \\to 1^+} \\frac{\\partial \\omega}{\\partial E} = \\lim_{E \\to 1^+} \\left( S_L |k| \\frac{2}{(E + 1)^2} \\right) = S_L |k| \\frac{2}{(1 + 1)^2} = S_L |k| \\frac{2}{4} = \\frac{1}{2} S_L |k| $$\n在此极限下，敏感性是一个有限的正值。这意味着一旦膨胀比略大于1，不稳定性增长率就开始增加。增长率本身在 $E=1$ 时为零，因此该敏感性描述了对于放热量非常低的火焰，不稳定性“开启”的速度有多快。\n\n在强膨胀极限下，$E \\to \\infty$：\n$$ \\lim_{E \\to \\infty} \\frac{\\partial \\omega}{\\partial E} = \\lim_{E \\to \\infty} \\left( S_L |k| \\frac{2}{(E + 1)^2} \\right) = 0 $$\n当 $E$ 变得非常大时，分母 $(E+1)^2$ 无界增长，导致敏感性趋近于零。这表明虽然增加 $E$ 总是会增加 $\\omega$，但对于非常强的火焰，这种效应会减弱。在此极限下，增长率 $\\omega$ 趋近于一个渐近最大值：\n$$ \\lim_{E \\to \\infty} \\omega = \\lim_{E \\to \\infty} \\left( S_L |k| \\frac{E - 1}{E + 1} \\right) = S_L |k| \\lim_{E \\to \\infty} \\frac{1 - \\frac{1}{E}}{1 + \\frac{1}{E}} = S_L |k| $$\n敏感性趋近于零反映了增长率正在其理论最大值 $S_L |k|$ 处饱和。膨胀比的进一步增加导致不稳定性增长率的增量越来越小。\n\n最后，我们确定 $\\frac{\\partial \\omega}{\\partial E}$ 的单位。增长率 $\\omega$ 的单位是时间的倒数，$[T]^{-1}$（例如，$s^{-1}$）。膨胀比 $E$ 是密度的比值，因此是无量纲的。因此，敏感性的单位是：\n$$ \\left[\\frac{\\partial \\omega}{\\partial E}\\right] = \\frac{[\\omega]}{[E]} = \\frac{[T]^{-1}}{1} = [T]^{-1} $$\n敏感性的单位是时间的倒数，与增长率本身的单位相同。我们可以从推导出的表达式中验证这一点：$S_L$ 的单位是 $[L][T]^{-1}$，$|k|$ 的单位是 $[L]^{-1}$。它们的乘积 $S_L |k|$ 的单位是 $[T]^{-1}$。项 $\\frac{2}{(E+1)^2}$ 是无量纲的。因此，单位是一致的。",
            "answer": "$$\\boxed{\\frac{2 S_L |k|}{(E + 1)^2}}$$"
        },
        {
            "introduction": "虽然气体膨胀会驱动不稳定性，但真实的火焰在小尺度上会受到火焰拉伸和黏性等效应的稳定作用。本练习探讨了这些稳定机制如何抑制最简单的 DL 理论所预测的无界增长。通过分析一个包含不稳定和稳定项的色散关系，您将学会识别最不稳定模式和短波截止等关键特征，这对于理解预混火焰的净稳定性特征以及不同物理效应之间的竞争至关重要 。",
            "id": "4015839",
            "problem": "考虑一个受 Darrieus-Landau 流体动力学不稳定性 (DLHI) 影响的平面、零厚度预混火焰。在经典的薄火焰界面描述中，波数大小为 $k \\ge 0$ 的小振幅正弦褶皱的线性色散关系可以表示为一个流体动力学失稳项与一个归因于 Markstein 效应的曲率/拉伸稳定项之间的竞争。将层流火焰速度记为 $S_{L}$，Markstein 长度记为 $L_{M}$。纯无粘、Markstein 稳定的色散关系可以写为\n$$\\omega_{0}(k) \\equiv A\\,k - B_{M}\\,k^{2},$$\n其中 $A>0$ 捕捉了气体膨胀引起的流体动力学驱动，而 $B_{M} \\equiv S_{L} L_{M} > 0$ 将 Markstein 稳定化编码为一个有效扩散率。现在假设流动在扰动尺度上具有有限的运动粘度 $\\nu>0$，并将其效应建模为增长率的一个附加耗散项 $-\\nu k^{2}$。那么，有粘色散关系变为\n$$\\omega_{\\nu}(k) \\equiv A\\,k - \\big(B_{M}+\\nu\\big)\\,k^{2}.$$\n\n定义截止波数 $k_{c}$ 为使增长率为零的最大 $k \\ge 0$，即 $\\,\\omega(k_{c})=0\\,$，并定义最大增长率 $\\omega_{\\max}$ 为 $\\max_{k\\ge 0}\\omega(k)$。仅使用微积分和给定的函数形式，推导无粘 Markstein 稳定情况和有粘情况下的 $k_{c}$ 和 $\\omega_{\\max}$。然后，通过构造无量纲比率\n$$R_{k} \\equiv \\frac{k_{c}^{(\\nu)}}{k_{c}^{(0)}}, \\qquad R_{\\omega} \\equiv \\frac{\\omega_{\\max}^{(\\nu)}}{\\omega_{\\max}^{(0)}},$$\n来消除未知的流体动力学系数 $A$，并将有序对 $\\big(R_{k},\\,R_{\\omega}\\big)$ 仅用 $S_{L}$、$L_{M}$ 和 $\\nu$ 表示。\n\n你的最终答案必须是仅包含 $S_{L}$、$L_{M}$ 和 $\\nu$ 的单个闭式解析表达式，并使用 $\\mathrm{pmatrix}$ 环境写成行矩阵的形式。比率 $\\big(R_{k},\\,R_{\\omega}\\big)$ 是无量纲的，因此不需要单位。不需要进行数值近似或四舍五入。",
            "solution": "该问题要求我们分析两种色散关系，并计算截止波数 $k_c$ 和最大增长率 $\\omega_{\\max}$ 的比率。\n\n**1. 无粘情况分析**\n\n无粘色散关系为 $\\omega_{0}(k) = A\\,k - B_{M}\\,k^{2}$。\n- **截止波数 $k_{c}^{(0)}$**：通过令 $\\omega_{0}(k) = k(A - B_{M}k) = 0$ 求解，我们得到非零根 $k_{c}^{(0)} = \\frac{A}{B_{M}}$。\n- **最大增长率 $\\omega_{\\max}^{(0)}$**：首先找到增长率达到最大的波数，即令导数 $\\frac{d\\omega_{0}}{dk} = A - 2 B_{M} k = 0$，解得 $k_{\\max} = \\frac{A}{2 B_{M}}$。将此波数代回 $\\omega_{0}(k)$，得到 $\\omega_{\\max}^{(0)} = A(\\frac{A}{2 B_{M}}) - B_{M}(\\frac{A}{2 B_{M}})^2 = \\frac{A^2}{4 B_{M}}$。\n\n**2. 有粘情况分析**\n\n有粘色散关系为 $\\omega_{\\nu}(k) = A\\,k - (B_{M}+\\nu)\\,k^{2}$。该方程在形式上与无粘情况相同，只是稳定项系数由 $B_{M}$ 变成了 $(B_{M}+\\nu)$。因此，我们可以直接通过替换得到有粘情况下的结果：\n- **截止波数 $k_{c}^{(\\nu)}$**：$k_{c}^{(\\nu)} = \\frac{A}{B_{M}+\\nu}$。\n- **最大增长率 $\\omega_{\\max}^{(\\nu)}$**：$\\omega_{\\max}^{(\\nu)} = \\frac{A^2}{4(B_{M}+\\nu)}$。\n\n**3. 构造比率**\n\n现在我们计算所要求的无量纲比率：\n- **截止波数比率 $R_k$**：\n  $$ R_{k} = \\frac{k_{c}^{(\\nu)}}{k_{c}^{(0)}} = \\frac{A / (B_{M} + \\nu)}{A / B_{M}} = \\frac{B_{M}}{B_{M} + \\nu} $$\n- **最大增长率比率 $R_\\omega$**：\n  $$ R_{\\omega} = \\frac{\\omega_{\\max}^{(\\nu)}}{\\omega_{\\max}^{(0)}} = \\frac{A^2 / (4 (B_{M} + \\nu))}{A^2 / (4 B_{M})} = \\frac{B_{M}}{B_{M} + \\nu} $$\n\n我们发现 $R_k = R_\\omega$。\n\n**4. 最终表达式**\n\n最后，将 $B_{M} = S_{L} L_{M}$ 代入，得到以物理参数表示的有序对比率：\n$$\n\\left( \\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}, \\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu} \\right)\n$$\n这便是最终的解析表达式，写成行矩阵的形式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu} & \\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "研究 DL 不稳定性复杂的非线性演化通常需要计算模拟。这些模拟中的一个关键要素是精确计算非局部流体动力学项，该项在数学上通过希尔伯特变换表示。这个编码练习搭建了从抽象理论到实际应用的桥梁，通过使用快速傅里叶变换 (FFT) 来计算火焰锋面导数的希尔伯特变换，您将获得在现代计算燃烧学研究中使用的强大谱方法的实践经验 。",
            "id": "4015882",
            "problem": "考虑一个一维、平面的预混火焰锋，由高度场 $h(x,t)$ 在长度为 $L$ 的周期性域上表示，其中 $x \\in [0,L)$ 是以弧度表示的流向坐标。在与 Darrieus–Landau (DL) 流体动力学不稳定性相关的线性流体动力学机制中，火焰锋的法向速度包含一个非局部贡献项，该项与流向导数 $h_x = \\partial h / \\partial x$ 的希尔伯特变换 $\\mathcal{H}\\{h_x\\}$ 成正比。该非局部项源于无旋（势）流耦合，并且是计算燃烧学中用于火焰锋动力学研究的光谱算法的核心。\n\n您的任务是，从第一性原理出发，使用快速傅里叶变换 (FFT) 在周期性网格上通过谱方法实现一个计算 $\\mathcal{H}\\{h_x\\}$ 的数值程序。该实现必须：\n- 使用具有 $N$ 个点的均匀网格，间距为 $\\Delta x = L/N$，角坐标为 $x_j = j \\Delta x$，其中 $j \\in \\{0,1,\\dots,N-1\\}$。\n- 将函数 $h(x)$ 视为 $L$ 周期函数，并以弧度表示角度。\n- 构建与网格上的 FFT 约定一致的离散波数数组 $k$，并用它来实现谱导数和谱希尔伯特变换算子。\n- 返回网格点上的实值 $\\mathcal{H}\\{h_x\\}(x)$。\n\n请设计、实现并测试您的程序，使用以下在一系列定义在 $x \\in [0,L)$ 上的函数和指定参数进行测试。对于每种情况，计算您的数值解 $\\mathcal{H}\\{h_x\\}$ 与其解析解之间的均方根 (RMS) 误差。解析解是根据希尔伯特变换作用于正弦和余弦函数的性质推导出来的。所有角度必须以弧度为单位，所有输出必须是无量纲的。\n\n测试套件：\n1. $L = 2\\pi$, $N = 1024$, $h(x) = \\cos(5x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 5\\cos(5x)$。\n2. $L = 2\\pi$, $N = 1024$, $h(x) = \\sin(7x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 7\\sin(7x)$。\n3. $L = 2\\pi$, $N = 1024$, $h(x) = 0.3\\cos(3x) - 0.5\\sin(6x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 0.9\\cos(3x) - 3\\sin(6x)$。\n4. $L = 2\\pi$, $N = 256$, $h(x) = 1.2$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 0$。\n5. $L = 2\\pi$, $N = 64$, $h(x) = \\cos(31x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 31\\cos(31x)$。\n\n按如下公式计算每种情况的均方根误差\n$$\n\\mathrm{RMS} = \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left[\\mathcal{H}\\{h_x\\}_{\\mathrm{num}}(x_j) - \\mathcal{H}\\{h_x\\}_{\\mathrm{anal}}(x_j)\\right]^2 \\right)^{1/2}.\n$$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是上述测试用例 $i$ 的均方根误差（一个浮点数）。",
            "solution": "该问题要求实现一个谱方法程序，用于计算非局部项 $\\mathcal{H}\\{h_x\\}$，其中 $h_x = \\partial h / \\partial x$，函数 $h(x)$ 是在域 $x \\in [0, L)$ 上的周期函数。这项计算在 Darrieus–Landau 不稳定性的研究中至关重要，该项用于模拟流体动力学对火焰锋速度的反馈效应。采用快速傅里叶变换 (FFT) 的谱方法特别适用于此任务，因为它在应用于光滑周期函数时具有高精度和高效率。\n\n谱方法的基本原理是在傅里叶空间中表示函数和算子。在区间 $[0, L)$ 上周期的函数 $h(x)$ 可以表示为傅里叶级数：\n$$\nh(x) = \\sum_{m=-\\infty}^{\\infty} \\hat{h}_m e^{i k_m x}\n$$\n在此表达式中，$k_m = 2\\pi m / L$ 是离散角波数，$\\hat{h}_m$ 是复值傅里叶系数。对于在 $N$ 个点的离散网格 $x_j = j \\Delta x$（网格间距 $\\Delta x = L/N$）上采样的函数，该级数被其离散对应物——离散傅里叶变换 (DFT) 所取代。DFT 系数 $\\hat{h}'_m$ 由采样函数值 $h_j = h(x_j)$ 计算得出：\n$$\n\\hat{h}'_m = \\sum_{j=0}^{N-1} h_j e^{-i 2\\pi m j / N}\n$$\n这些系数 $\\hat{h}'_m$ 是解析系数 $\\hat{h}_m$ 的近似值，并使用 FFT 算法高效计算。\n\n在傅里叶域中，诸如微分和希尔伯特变换之类的线性算子简化为代数乘法。我们首先分析微分算子 $\\partial/\\partial x$。将此算子应用于单个傅里叶基函数 $e^{i k_m x}$ 可得：\n$$\n\\frac{\\partial}{\\partial x} e^{i k_m x} = i k_m e^{i k_m x}\n$$\n这表明，实空间中的微分运算等效于在傅里叶空间中乘以因子 $i k_m$。因此，导数的傅里叶变换 $\\mathcal{F}\\{h_x\\}$ 与函数本身的傅里叶变换 $\\mathcal{F}\\{h\\}$ 通过 $\\mathcal{F}\\{h_x\\}(k) = (i k) \\mathcal{F}\\{h\\}(k)$ 相关联。\n\n接下来，我们考虑希尔伯特变换 $\\mathcal{H}$。对于周期函数，其在傅里叶域中的作用是将傅里叶系数乘以因子 $-i \\cdot \\mathrm{sgn}(k_m)$，其中符号函数 $\\mathrm{sgn}(\\cdot)$ 定义为：\n$$\n\\mathrm{sgn}(k_m) = \\begin{cases} +1 & \\text{if } k_m > 0 \\\\ 0 & \\text{if } k_m = 0 \\\\ -1 & \\text{if } k_m < 0 \\end{cases}\n$$\n因此，希尔伯特变换的傅里叶表示为 $\\mathcal{F}\\{\\mathcal{H}\\{h\\}\\}(k) = (-i \\cdot \\mathrm{sgn}(k)) \\mathcal{F}\\{h\\}(k)$。\n\n任务是计算复合运算 $\\mathcal{H}\\{h_x\\}$，这涉及应用微分和希尔伯特变换。通过级联它们各自的谱乘子，我们可以找到整个运算的单一谱乘子：\n$$\n\\mathcal{F}\\{\\mathcal{H}\\{h_x\\}\\}(k) = \\underbrace{(-i \\cdot \\mathrm{sgn}(k))}_{\\text{from } \\mathcal{H}} \\cdot \\underbrace{(i k)}_{\\text{from } \\partial/\\partial x} \\cdot \\mathcal{F}\\{h\\}(k)\n$$\n简化乘子的乘积可得一个简洁而优雅的结果：\n$$\n(-i \\cdot \\mathrm{sgn}(k)) \\cdot (i k) = -i^2 \\cdot k \\cdot \\mathrm{sgn}(k) = (1) \\cdot k \\cdot \\mathrm{sgn}(k) = |k|\n$$\n这表明算子 $\\mathcal{H} \\circ (\\partial/\\partial x)$ 等效于一个谱滤波器，其传递函数等于波数的绝对值 $|k|$。\n\n基于此原理，数值算法构建如下：\n1.  将域 $[0, L)$ 离散化为一个包含 $N$ 个点的均匀网格，$x_j = j (L/N)$，其中 $j = 0, 1, \\dots, N-1$。在此网格上计算输入函数 $h(x_j)$。\n2.  计算离散函数 $h_j$ 的正向 FFT，以获得其谱系数 $\\hat{h}_m = \\text{FFT}(h_j)$。\n3.  构建相应的离散角波数数组 $k_m$。对于长度为 $L$、包含 $N$ 个网格点且间距为 $\\Delta x = L/N$ 的域，波数由 $k_m = 2\\pi f_m$ 给出，其中频率 $f_m$ 由 `numpy.fft.fftfreq(N, d=\\Delta x)` 函数提供。\n4.  构建复合算子的谱乘子，它就是波数数组的绝对值 $|k_m|$。\n5.  通过逐元素相乘在傅里叶空间中应用该算子：$\\widehat{\\mathcal{H}\\{h_x\\}}_m = |k_m| \\hat{h}_m$。\n6.  计算所得乘积的逆 FFT，将结果转换回物理空间：$\\mathcal{H}\\{h_x\\}(x_j) = \\text{iFFT}(\\widehat{\\mathcal{H}\\{h_x\\}}_m)$。\n7.  逆 FFT 的输出是一个复值数组。由于对实值输入函数 $h(x)$ 的运算必须产生实值输出，因此取结果的实部。任何非零的虚部都归因于浮点数值误差。\n8.  此数值结果的精度通过计算其与给定解析解在网格点上的均方根 (RMS) 误差来量化。对于给定的测试用例，由于它们涉及远在网格奈奎斯特极限内的纯正弦波，谱方法预计将产生接近机器精度的误差。",
            "answer": "```python\nimport numpy as np\n\ndef spectral_hilbert_derivative(h_values, L, N):\n    \"\"\"\n    Computes the Hilbert transform of the derivative of h, H{h_x},\n    using a spectral method with FFT.\n\n    Args:\n        h_values (np.ndarray): The values of the function h(x) on a uniform grid.\n        L (float): The length of the periodic domain.\n        N (int): The number of points in the grid.\n\n    Returns:\n        np.ndarray: The real-valued result of H{h_x} evaluated on the grid.\n    \"\"\"\n    # 1. Compute the FFT of the input function.\n    h_hat = np.fft.fft(h_values)\n\n    # 2. Construct the array of discrete angular wavenumbers.\n    # The sample spacing is dx = L / N.\n    # np.fft.fftfreq(N, d=dx) gives frequencies in cycles per unit distance.\n    # Multiply by 2*pi to get angular wavenumbers k.\n    dx = L / N\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # 3. The spectral multiplier for the operator H{d/dx} is |k|.\n    abs_k = np.abs(k)\n\n    # 4. Apply the operator in Fourier space.\n    result_hat = abs_k * h_hat\n\n    # 5. Compute the inverse FFT to get the result in real space.\n    # The result should be real, so we take the real part to discard\n    # noise in the imaginary part due to floating-point errors.\n    result_real = np.fft.ifft(result_hat).real\n\n    return result_real\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 2 * np.pi, \"N\": 1024,\n            \"h_func\": lambda x: np.cos(5 * x),\n            \"anal_func\": lambda x: 5 * np.cos(5 * x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 1024,\n            \"h_func\": lambda x: np.sin(7 * x),\n            \"anal_func\": lambda x: 7 * np.sin(7 * x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 1024,\n            \"h_func\": lambda x: 0.3 * np.cos(3 * x) - 0.5 * np.sin(6 * x),\n            \"anal_func\": lambda x: 0.9 * np.cos(3 * x) - 3 * np.sin(6 * x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 256,\n            \"h_func\": lambda x: 1.2 * np.ones_like(x), # h(x) is constant\n            \"anal_func\": lambda x: np.zeros_like(x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 64,\n            \"h_func\": lambda x: np.cos(31 * x),\n            \"anal_func\": lambda x: 31 * np.cos(31 * x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        N = case[\"N\"]\n        h_func = case[\"h_func\"]\n        anal_func = case[\"anal_func\"]\n        \n        # Create the computational grid.\n        dx = L / N\n        x = np.arange(N) * dx\n        \n        # Evaluate the input function on the grid.\n        h_values = h_func(x)\n        \n        # Compute the numerical result using the spectral method.\n        num_result = spectral_hilbert_derivative(h_values, L, N)\n        \n        # Evaluate the analytical target function on the grid.\n        anal_result = anal_func(x)\n        \n        # Compute the Root-Mean-Square (RMS) error.\n        rms_error = np.sqrt(np.mean((num_result - anal_result)**2))\n        results.append(rms_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}