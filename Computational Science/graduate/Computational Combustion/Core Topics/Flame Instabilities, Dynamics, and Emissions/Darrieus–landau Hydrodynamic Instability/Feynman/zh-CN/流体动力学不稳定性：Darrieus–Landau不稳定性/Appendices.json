{
    "hands_on_practices": [
        {
            "introduction": "达里厄-朗道（Darrieus-Landau, DL）不稳定性的核心驱动力是火焰前后的气体膨胀。通过对不稳定增长率与膨胀比的关系进行参数敏感性分析，我们可以深入理解不同物理条件下（例如，从弱放热到强放热）该不稳定性的行为特征。这项练习  将通过基本的微积分推导，揭示该不稳定性对热膨胀的依赖性。",
            "id": "4015870",
            "problem": "一个二维、无粘性、零厚度的平面预混火焰，在波数大小为 $|k|$ 的小振幅正弦扰动作用下，会表现出 Darrieus–Landau (DL) 流体动力学不稳定性。设 $S_L$ 表示未受拉伸的层流火焰速度，气体膨胀比为 $E \\equiv \\rho_u/\\rho_b  1$，其中 $\\rho_u$ 和 $\\rho_b$ 分别是未燃气体和已燃气体的密度。在此类火焰的经典线性理论中，单一傅里叶模态的时间增长率由下式给出：\n$$\\omega = S_L |k| \\frac{E - 1}{E + 1}.$$\n将 $S_L$ 和 $|k|$ 视为常数，计算增长率相对于膨胀比的参数敏感性 $\\frac{\\partial \\omega}{\\partial E}$，并将其表示为 $E$、$S_L$ 和 $|k|$ 的显式解析函数。然后，在 $E \\to 1^+$ 和 $E \\to \\infty$ 的极限情况下，物理上解释该敏感性的符号和大小，并说明 $\\frac{\\partial \\omega}{\\partial E}$ 的单位。你最终报告的答案必须仅为 $\\frac{\\partial \\omega}{\\partial E}$ 的闭式解析表达式，不带单位。",
            "solution": "该问题要求计算 Darrieus–Landau 不稳定性增长率 $\\omega$ 相对于气体膨胀比 $E$ 的参数敏感性。给定的增长率表达式为：\n$$ \\omega = S_L |k| \\frac{E - 1}{E + 1} $$\n其中 $S_L$ 是未受拉伸的层流火焰速度， $|k|$ 是扰动波数的大小， $E = \\rho_u / \\rho_b  1$ 是膨胀比。我们的任务是计算偏导数 $\\frac{\\partial \\omega}{\\partial E}$，并将 $S_L$ 和 $|k|$ 视为常数。\n\n为求得敏感性，我们对 $\\omega$ 的表达式关于 $E$ 求导：\n$$ \\frac{\\partial \\omega}{\\partial E} = \\frac{\\partial}{\\partial E} \\left( S_L |k| \\frac{E - 1}{E + 1} \\right) $$\n由于 $S_L$ 和 $|k|$ 被视为常数，我们可以将它们从导数中提取出来：\n$$ \\frac{\\partial \\omega}{\\partial E} = S_L |k| \\frac{\\partial}{\\partial E} \\left( \\frac{E - 1}{E + 1} \\right) $$\n我们应用微分学的商法则，即对于函数 $u(E)$ 和 $v(E)$，$\\frac{d}{dE}\\left(\\frac{u}{v}\\right) = \\frac{v \\frac{du}{dE} - u \\frac{dv}{dE}}{v^2}$。令 $u(E) = E - 1$ 和 $v(E) = E + 1$。它们关于 $E$ 的导数是：\n$$ \\frac{du}{dE} = \\frac{d}{dE}(E - 1) = 1 $$\n$$ \\frac{dv}{dE} = \\frac{d}{dE}(E + 1) = 1 $$\n将这些代入商法则：\n$$ \\frac{\\partial}{\\partial E} \\left( \\frac{E - 1}{E + 1} \\right) = \\frac{(E + 1)(1) - (E - 1)(1)}{(E + 1)^2} = \\frac{E + 1 - E + 1}{(E + 1)^2} = \\frac{2}{(E + 1)^2} $$\n将此结果代回 $\\frac{\\partial \\omega}{\\partial E}$ 的表达式中，我们得到敏感性的最终解析表达式：\n$$ \\frac{\\partial \\omega}{\\partial E} = S_L |k| \\frac{2}{(E + 1)^2} $$\n这就是增长率相对于膨胀比的敏感性的闭式解析表达式。\n\n接下来，我们解释该敏感性的符号和大小。物理上，$S_L$ 和 $|k|$ 都是正值（对于非平凡扰动，$S_L  0$ 且 $|k|  0$）。由于 $E  1$，$(E+1)^2$ 项也严格为正。因此，$\\frac{\\partial \\omega}{\\partial E}$ 恒为正。这表明不稳定性增长率 $\\omega$ 是膨胀比 $E$ 的单调递增函数。火焰前后的密度降越大（即 $E$ 越大），总会导致更强的不稳定性，这在物理上是符合预期的，因为该不稳定性是由气体膨胀的流体动力学效应驱动的。\n\n我们现在分析 $E \\to 1^+$ 和 $E \\to \\infty$ 时的极限情况。\n\n在弱膨胀极限下，$E \\to 1^+$：\n$$ \\lim_{E \\to 1^+} \\frac{\\partial \\omega}{\\partial E} = \\lim_{E \\to 1^+} \\left( S_L |k| \\frac{2}{(E + 1)^2} \\right) = S_L |k| \\frac{2}{(1 + 1)^2} = S_L |k| \\frac{2}{4} = \\frac{1}{2} S_L |k| $$\n在此极限下，敏感性是一个有限的正值。这意味着一旦膨胀比略大于1，不稳定性增长率就开始增加。增长率本身在 $E=1$ 时为零，所以该敏感性描述了对于热释放非常低的火焰，不稳定性“开启”的速度有多快。\n\n在强膨胀极限下，$E \\to \\infty$：\n$$ \\lim_{E \\to \\infty} \\frac{\\partial \\omega}{\\partial E} = \\lim_{E \\to \\infty} \\left( S_L |k| \\frac{2}{(E + 1)^2} \\right) = 0 $$\n当 $E$ 变得非常大时，分母 $(E+1)^2$ 无界增长，导致敏感性趋近于零。这表明，虽然增加 $E$ 总会增加 $\\omega$，但对于非常强的火焰，其效应会减弱。在此极限下，增长率 $\\omega$ 趋于一个渐近最大值：\n$$ \\lim_{E \\to \\infty} \\omega = \\lim_{E \\to \\infty} \\left( S_L |k| \\frac{E - 1}{E + 1} \\right) = S_L |k| \\lim_{E \\to \\infty} \\frac{1 - \\frac{1}{E}}{1 + \\frac{1}{E}} = S_L |k| $$\n敏感性趋近于零反映了增长率正在其理论最大值 $S_L |k|$ 处饱和的事实。膨胀比的进一步增加导致不稳定性增长率的增量越来越小。\n\n最后，我们确定 $\\frac{\\partial \\omega}{\\partial E}$ 的单位。增长率 $\\omega$ 的单位是时间的倒数，即 $[T]^{-1}$ (例如 $s^{-1}$)。膨胀比 $E$ 是密度的比值，因此是无量纲的。所以，敏感性的单位是：\n$$ \\left[\\frac{\\partial \\omega}{\\partial E}\\right] = \\frac{[\\omega]}{[E]} = \\frac{[T]^{-1}}{1} = [T]^{-1} $$\n敏感性的单位是时间的倒数，与增长率本身的单位相同。我们可以从推导出的表达式中验证这一点：$S_L$ 的单位是 $[L][T]^{-1}$， $|k|$ 的单位是 $[L]^{-1}$。它们的乘积 $S_L |k|$ 的单位是 $[T]^{-1}$。$\\frac{2}{(E+1)^2}$ 项是无量纲的。因此，单位是一致的。",
            "answer": "$$\\boxed{\\frac{2 S_L |k|}{(E + 1)^2}}$$"
        },
        {
            "introduction": "经典的DL理论预测，扰动波长越短，不稳定性越强，这与物理现实不符。这项练习  引入了更符合实际的物理模型，考虑了马克斯坦（Markstein）效应和黏性耗散等稳定化机制。通过分析这些效应对色散关系的影响，你将学会如何确定不稳定的截止波数和最大增长率，从而理解真实火焰中不稳定性的尺度范围。",
            "id": "4015839",
            "problem": "考虑一个受到达里厄-朗道流体动力学不稳定性 (DLHI) 影响的、平面的、零厚度的预混火焰。在经典的薄火焰界面描述中，对于波数大小为 $k \\ge 0$ 的小振幅正弦波状褶皱，其线性色散关系可以表示为一个流体动力学失稳项与一个归因于马克斯坦效应的曲率/拉伸稳定作用之间的竞争。将层流火焰速度记为 $S_{L}$，马克斯坦长度记为 $L_{M}$。纯无粘的、由马克斯坦效应稳定的色散关系可以写为\n$$\\omega_{0}(k) \\equiv A\\,k - B_{M}\\,k^{2},$$\n其中 $A0$ 描述了由气体膨胀引起的流体动力学驱动，$B_{M} \\equiv S_{L} L_{M}  0$ 将马克斯坦稳定作用体现为一种有效扩散率。现在假设流体具有有限的运动粘度 $\\nu0$，其在扰动尺度上起作用，并将其效应建模为一个附加到增长率上的耗散项 $-\\nu k^{2}$。于是，有粘色散关系变为\n$$\\omega_{\\nu}(k) \\equiv A\\,k - \\big(B_{M}+\\nu\\big)\\,k^{2}.$$\n\n定义截止波数 $k_{c}$ 为使得增长率为零 $\\,\\omega(k_{c})=0\\,$ 的最大 $k \\ge 0$，并定义最大增长率 $\\omega_{\\max}$ 为 $\\max_{k\\ge 0}\\omega(k)$。仅使用微积分和给定的函数形式，推导无粘、马克斯坦稳定情况和有粘情况下的 $k_{c}$ 与 $\\omega_{\\max}$。然后，通过构造无量纲比率来消去未知的流体动力学系数 $A$\n$$R_{k} \\equiv \\frac{k_{c}^{(\\nu)}}{k_{c}^{(0)}}, \\qquad R_{\\omega} \\equiv \\frac{\\omega_{\\max}^{(\\nu)}}{\\omega_{\\max}^{(0)}},$$\n并将有序对 $\\big(R_{k},\\,R_{\\omega}\\big)$ 仅用 $S_{L}$、$L_{M}$ 和 $\\nu$ 表示。\n\n你的最终答案必须是一个仅包含 $S_{L}$、$L_{M}$ 和 $\\nu$ 的单一闭式解析表达式，并使用 $\\mathrm{pmatrix}$ 环境写成行矩阵的形式。比率 $\\big(R_{k},\\,R_{\\omega}\\big)$ 是无量纲的，因此不需要单位。不需要进行数值近似或四舍五入。",
            "solution": "求解过程需要计算无粘和有粘两种情况下的截止波数 $k_{c}$ 和最大增长率 $\\omega_{\\max}$，然后构造它们的比率。\n\n**第1部分：无粘情况分析**\n\n无粘色散关系由下式给出：\n$$\n\\omega_{0}(k) = A k - B_{M} k^{2}\n$$\n这是一个关于 $k$ 的二次函数，其图像是开口向下且过原点的抛物线。\n\n为求截止波数 $k_{c}^{(0)}$，我们令 $\\omega_{0}(k) = 0$ 并找出最大的非负根：\n$$\nA k - B_{M} k^{2} = 0\n$$\n$$\nk (A - B_{M} k) = 0\n$$\n根为 $k=0$ 和 $k = A / B_{M}$。由于 $A  0$ 且 $B_{M}  0$，最大的非负根是：\n$$\nk_{c}^{(0)} = \\frac{A}{B_{M}}\n$$\n\n为求最大增长率 $\\omega_{\\max}^{(0)}$，我们找到使 $\\omega_{0}(k)$ 对 $k$ 的导数为零的 $k$ 值：\n$$\n\\frac{d\\omega_{0}}{dk} = A - 2 B_{M} k\n$$\n令导数为零：\n$$\nA - 2 B_{M} k = 0 \\implies k_{\\max} = \\frac{A}{2 B_{M}}\n$$\n这个 $k$ 值对应于最大增长率。我们将其代回到 $\\omega_{0}(k)$ 的表达式中：\n$$\n\\omega_{\\max}^{(0)} = \\omega_{0}\\left(\\frac{A}{2 B_{M}}\\right) = A\\left(\\frac{A}{2 B_{M}}\\right) - B_{M}\\left(\\frac{A}{2 B_{M}}\\right)^2\n$$\n$$\n\\omega_{\\max}^{(0)} = \\frac{A^{2}}{2 B_{M}} - B_{M}\\left(\\frac{A^{2}}{4 B_{M}^{2}}\\right) = \\frac{A^{2}}{2 B_{M}} - \\frac{A^{2}}{4 B_{M}}\n$$\n$$\n\\omega_{\\max}^{(0)} = \\frac{2A^{2} - A^{2}}{4 B_{M}} = \\frac{A^{2}}{4 B_{M}}\n$$\n\n**第2部分：有粘情况分析**\n\n有粘色散关系由下式给出：\n$$\n\\omega_{\\nu}(k) = A k - (B_{M} + \\nu) k^{2}\n$$\n这与无粘情况具有相同的函数形式，只是系数 $B_{M}$ 被替换为 $(B_{M} + \\nu)$。我们可以通过直接代入来使用第1部分的结果。\n\n将 $k_{c}^{(0)}$ 表达式中的 $B_{M}$ 替换为 $(B_{M} + \\nu)$，即可得到截止波数 $k_{c}^{(\\nu)}$：\n$$\nk_{c}^{(\\nu)} = \\frac{A}{B_{M} + \\nu}\n$$\n\n类似地，将 $\\omega_{\\max}^{(0)}$ 表达式中的 $B_{M}$ 替换为 $(B_{M} + \\nu)$，即可得到最大增长率 $\\omega_{\\max}^{(\\nu)}$：\n$$\n\\omega_{\\max}^{(\\nu)} = \\frac{A^{2}}{4 (B_{M} + \\nu)}\n$$\n\n**第3部分：构造无量纲比率**\n\n现在我们构造所要求的无量纲比率 $R_{k}$ 和 $R_{\\omega}$。\n\n截止波数之比为：\n$$\nR_{k} = \\frac{k_{c}^{(\\nu)}}{k_{c}^{(0)}} = \\frac{A / (B_{M} + \\nu)}{A / B_{M}} = \\frac{A}{B_{M} + \\nu} \\cdot \\frac{B_{M}}{A}\n$$\n$$\nR_{k} = \\frac{B_{M}}{B_{M} + \\nu}\n$$\n\n最大增长率之比为：\n$$\nR_{\\omega} = \\frac{\\omega_{\\max}^{(\\nu)}}{\\omega_{\\max}^{(0)}} = \\frac{A^{2} / (4 (B_{M} + \\nu))}{A^{2} / (4 B_{M})} = \\frac{1}{B_{M} + \\nu} \\cdot \\frac{B_{M}}{1}\n$$\n$$\nR_{\\omega} = \\frac{B_{M}}{B_{M} + \\nu}\n$$\n\n我们发现 $R_{k} = R_{\\omega}$。\n\n**第4部分：最终表达式**\n\n最后，我们通过代入定义 $B_{M} = S_{L} L_{M}$，用给定的物理参数 $S_{L}$、$L_{M}$ 和 $\\nu$ 来表示这些比率：\n$$\nR_{k} = \\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}\n$$\n$$\nR_{\\omega} = \\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}\n$$\n\n题目要求的是有序对 $\\big(R_{k},\\,R_{\\omega}\\big)$，即：\n$$\n\\left(\\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}, \\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}\\right)\n$$\n这就是最终的解析表达式，写成了行矩阵的形式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}  \\frac{S_{L} L_{M}}{S_{L} L_{M} + \\nu}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从解析理论到计算模拟的跨越是现代燃烧学研究的关键一步。DL不稳定性的高级模型中包含非局域项，如火焰阵面斜率的希尔伯特变换（Hilbert transform），这在解析上难以处理，但在数值上可以通过谱方法高效计算。这项实践  将指导你使用快速傅里叶变换（FFT）实现这一关键的非局域算子，为你构建火焰动力学仿真代码提供核心技能。",
            "id": "4015882",
            "problem": "考虑一个一维、平面、预混的火焰锋，其由定义在长度为 $L$ 的周期性域上的高度场 $h(x,t)$ 表示，其中 $x \\in [0,L)$ 是以弧度表示的流向坐标。在与 Darrieus–Landau (DL) 流体动力学不稳定性相关的线性流体动力学机制中，法向火焰锋速度包含一个非局域贡献，该贡献与流向导数 $h_x = \\partial h / \\partial x$ 的希尔伯特变换 $\\mathcal{H}\\{h_x\\}$ 成正比。这个非局域项源于无旋（势）流耦合，并且是计算燃烧学中用于火焰锋动力学谱方法算法的核心。\n\n你的任务是，从基本原理出发，实现一个数值程序，该程序使用快速傅里叶变换 (FFT) 在周期性网格上以谱方法计算 $\\mathcal{H}\\{h_x\\}$。该实现必须：\n- 使用一个包含 $N$ 个点的均匀网格，网格间距为 $\\Delta x = L/N$，角坐标为 $x_j = j \\Delta x$，其中 $j \\in \\{0,1,\\dots,N-1\\}$。\n- 将函数 $h(x)$ 视为 $L$-周期函数，并以弧度表示角度。\n- 构建与网格上的 FFT 约定一致的离散波数数组 $k$，并用它来实现谱导数和谱希尔伯特变换算子。\n- 在网格点上返回实值的 $\\mathcal{H}\\{h_x\\}(x)$。\n\n设计、实现并在一组定义在 $x \\in [0,L)$ 上的函数上测试你的程序，使用指定的参数。对于每个案例，计算你的数值计算结果 $\\mathcal{H}\\{h_x\\}$ 与其解析对应项之间的均方根 (RMS) 误差。该解析对应项是根据希尔伯特变换在正弦和余弦函数上的性质推导出来的。所有角度必须以弧度为单位，所有输出必须是无量纲的。\n\n测试套件：\n1. $L = 2\\pi$，$N = 1024$，$h(x) = \\cos(5x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 5\\cos(5x)$。\n2. $L = 2\\pi$，$N = 1024$，$h(x) = \\sin(7x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 7\\sin(7x)$。\n3. $L = 2\\pi$，$N = 1024$，$h(x) = 0.3\\cos(3x) - 0.5\\sin(6x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 0.9\\cos(3x) - 3\\sin(6x)$。\n4. $L = 2\\pi$，$N = 256$，$h(x) = 1.2$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 0$。\n5. $L = 2\\pi$，$N = 64$，$h(x) = \\cos(31x)$。解析目标：$\\mathcal{H}\\{h_x\\}(x) = 31\\cos(31x)$。\n\n对每个案例，按如下方式计算 RMS 误差：\n$$\n\\mathrm{RMS} = \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left[\\mathcal{H}\\{h_x\\}_{\\mathrm{num}}(x_j) - \\mathcal{H}\\{h_x\\}_{\\mathrm{anal}}(x_j)\\right]^2 \\right)^{1/2}.\n$$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是上述测试案例 $i$ 的 RMS 误差（一个浮点数）。",
            "solution": "该问题要求实现一个谱方法程序，用于计算周期函数 $h(x)$ 在域 $x \\in [0, L)$ 上的非局域项 $\\mathcal{H}\\{h_x\\}$，其中 $h_x = \\partial h / \\partial x$。该计算在 Darrieus–Landau 不稳定性的研究中至关重要，其中该项模拟了流体动力学对火焰锋速度的反馈。采用快速傅里叶变换 (FFT) 的谱方法因其在应用于平滑周期函数时具有高精度和高效率，因此特别适合此任务。\n\n谱方法的基本原理是在傅里叶空间中表示函数和算子。在区间 $[0, L)$ 上周期的函数 $h(x)$ 可以表示为傅里叶级数：\n$$\nh(x) = \\sum_{m=-\\infty}^{\\infty} \\hat{h}_m e^{i k_m x}\n$$\n在此表达式中，$k_m = 2\\pi m / L$ 是离散角波数，而 $\\hat{h}_m$ 是复值傅里叶系数。对于在一个包含 $N$ 个点的离散网格 $x_j = j \\Delta x$（网格间距 $\\Delta x = L/N$）上采样的函数，此级数被其离散对应形式——离散傅里叶变换 (DFT) 所取代。DFT 系数 $\\hat{h}'_m$ 由采样函数值 $h_j = h(x_j)$ 计算得出：\n$$\n\\hat{h}'_m = \\sum_{j=0}^{N-1} h_j e^{-i 2\\pi m j / N}\n$$\n这些系数 $\\hat{h}'_m$ 是解析系数 $\\hat{h}_m$ 的近似值，并使用 FFT 算法高效计算。\n\n在傅里叶域中，诸如微分和希尔伯特变换等线性算子简化为代数乘法。我们首先分析微分算子 $\\partial/\\partial x$。将此算子应用于单个傅里叶基函数 $e^{i k_m x}$ 可得：\n$$\n\\frac{\\partial}{\\partial x} e^{i k_m x} = i k_m e^{i k_m x}\n$$\n这表明实空间中的微分运算等效于在傅里叶空间中乘以因子 $i k_m$。因此，导数的傅里叶变换 $\\mathcal{F}\\{h_x\\}$ 与函数本身的傅里叶变换 $\\mathcal{F}\\{h\\}$ 之间的关系为 $\\mathcal{F}\\{h_x\\}(k) = (i k) \\mathcal{F}\\{h\\}(k)$。\n\n接下来，我们考虑希尔伯特变换 $\\mathcal{H}$。对于周期函数，其在傅里叶域中的作用是将傅里叶系数乘以因子 $-i \\cdot \\mathrm{sgn}(k_m)$，其中符号函数 $\\mathrm{sgn}(\\cdot)$ 定义为：\n$$\n\\mathrm{sgn}(k_m) = \\begin{cases} +1  \\text{if } k_m  0 \\\\ 0  \\text{if } k_m = 0 \\\\ -1  \\text{if } k_m  0 \\end{cases}\n$$\n因此，希尔伯特变换的傅里叶表示为 $\\mathcal{F}\\{\\mathcal{H}\\{h\\}\\}(k) = (-i \\cdot \\mathrm{sgn}(k)) \\mathcal{F}\\{h\\}(k)$。\n\n任务是计算复合运算 $\\mathcal{H}\\{h_x\\}$，这涉及应用微分和希尔伯特变换。通过级联它们各自的谱乘子，我们可以找到整个运算的单一谱乘子：\n$$\n\\mathcal{F}\\{\\mathcal{H}\\{h_x\\}\\}(k) = \\underbrace{(-i \\cdot \\mathrm{sgn}(k))}_{\\text{from } \\mathcal{H}} \\cdot \\underbrace{(i k)}_{\\text{from } \\partial/\\partial x} \\cdot \\mathcal{F}\\{h\\}(k)\n$$\n简化乘子的乘积可以得到一个简洁而优雅的结果：\n$$\n(-i \\cdot \\mathrm{sgn}(k)) \\cdot (i k) = -i^2 \\cdot k \\cdot \\mathrm{sgn}(k) = (1) \\cdot k \\cdot \\mathrm{sgn}(k) = |k|\n$$\n这表明算子 $\\mathcal{H} \\circ (\\partial/\\partial x)$ 等效于一个谱滤波器，其传递函数等于波数的绝对值 $|k|$。\n\n基于此原理，数值算法构建如下：\n1.  将域 $[0, L)$ 离散化为一个包含 $N$ 个点的均匀网格， $x_j = j (L/N)$，其中 $j = 0, 1, \\dots, N-1$。在此网格上计算输入函数 $h(x_j)$。\n2.  计算离散函数 $h_j$ 的正向 FFT，以获得其谱系数 $\\hat{h}_m = \\text{FFT}(h_j)$。\n3.  构建相应的离散角波数数组 $k_m$。对于长度为 $L$、包含 $N$ 个网格点且间距为 $\\Delta x = L/N$ 的域，波数由 $k_m = 2\\pi f_m$ 给出，其中频率 $f_m$ 由函数 `numpy.fft.fftfreq(N, d=\\Delta x)` 提供。\n4.  构建复合算子的谱乘子，它就是波数数组的绝对值 $|k_m|$。\n5.  通过逐元素相乘在傅里叶空间中应用算子：$\\widehat{\\mathcal{H}\\{h_x\\}}_m = |k_m| \\hat{h}_m$。\n6.  计算所得乘积的逆向 FFT，将结果变换回物理空间：$\\mathcal{H}\\{h_x\\}(x_j) = \\text{iFFT}(\\widehat{\\mathcal{H}\\{h_x\\}}_m)$。\n7.  逆向 FFT 的输出是一个复值数组。由于对实值输入函数 $h(x)$ 的运算必须产生实值输出，因此我们取结果的实部。任何非零的虚部都归因于浮点数值误差。\n8.  通过计算数值结果与给定解析解在网格点上的均方根 (RMS) 误差来量化其精度。对于给定的测试案例，由于它们涉及远在网格奈奎斯特极限内的纯正弦波，谱方法预计将产生接近机器精度的误差。",
            "answer": "```python\nimport numpy as np\n\ndef spectral_hilbert_derivative(h_values, L, N):\n    \"\"\"\n    Computes the Hilbert transform of the derivative of h, H{h_x},\n    using a spectral method with FFT.\n\n    Args:\n        h_values (np.ndarray): The values of the function h(x) on a uniform grid.\n        L (float): The length of the periodic domain.\n        N (int): The number of points in the grid.\n\n    Returns:\n        np.ndarray: The real-valued result of H{h_x} evaluated on the grid.\n    \"\"\"\n    # 1. Compute the FFT of the input function.\n    h_hat = np.fft.fft(h_values)\n\n    # 2. Construct the array of discrete angular wavenumbers.\n    # The sample spacing is dx = L / N.\n    # np.fft.fftfreq(N, d=dx) gives frequencies in cycles per unit distance.\n    # Multiply by 2*pi to get angular wavenumbers k.\n    dx = L / N\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # 3. The spectral multiplier for the operator H{d/dx} is |k|.\n    abs_k = np.abs(k)\n\n    # 4. Apply the operator in Fourier space.\n    result_hat = abs_k * h_hat\n\n    # 5. Compute the inverse FFT to get the result in real space.\n    # The result should be real, so we take the real part to discard\n    # noise in the imaginary part due to floating-point errors.\n    result_real = np.fft.ifft(result_hat).real\n\n    return result_real\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 2 * np.pi, \"N\": 1024,\n            \"h_func\": lambda x: np.cos(5 * x),\n            \"anal_func\": lambda x: 5 * np.cos(5 * x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 1024,\n            \"h_func\": lambda x: np.sin(7 * x),\n            \"anal_func\": lambda x: 7 * np.sin(7 * x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 1024,\n            \"h_func\": lambda x: 0.3 * np.cos(3 * x) - 0.5 * np.sin(6 * x),\n            \"anal_func\": lambda x: 0.9 * np.cos(3 * x) - 3 * np.sin(6 * x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 256,\n            \"h_func\": lambda x: 1.2 * np.ones_like(x), # h(x) is constant\n            \"anal_func\": lambda x: np.zeros_like(x)\n        },\n        {\n            \"L\": 2 * np.pi, \"N\": 64,\n            \"h_func\": lambda x: np.cos(31 * x),\n            \"anal_func\": lambda x: 31 * np.cos(31 * x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        N = case[\"N\"]\n        h_func = case[\"h_func\"]\n        anal_func = case[\"anal_func\"]\n        \n        # Create the computational grid.\n        dx = L / N\n        x = np.arange(N) * dx\n        \n        # Evaluate the input function on the grid.\n        h_values = h_func(x)\n        \n        # Compute the numerical result using the spectral method.\n        num_result = spectral_hilbert_derivative(h_values, L, N)\n        \n        # Evaluate the analytical target function on the grid.\n        anal_result = anal_func(x)\n        \n        # Compute the Root-Mean-Square (RMS) error.\n        rms_error = np.sqrt(np.mean((num_result - anal_result)**2))\n        results.append(rms_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}