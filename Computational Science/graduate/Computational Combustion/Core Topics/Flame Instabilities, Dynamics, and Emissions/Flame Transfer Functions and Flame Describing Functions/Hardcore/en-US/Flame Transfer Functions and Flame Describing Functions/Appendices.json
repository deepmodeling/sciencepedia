{
    "hands_on_practices": [
        {
            "introduction": "To analyze thermoacoustic stability, the complex dynamics of a flame are often represented by simplified, low-order models. This exercise focuses on a classic Flame Transfer Function (FTF) model that combines a time delay and a first-order relaxation process. By working through this problem, you will practice the essential skill of extracting the frequency-dependent gain and phase from a complex transfer function, which is fundamental to understanding how a flame responds to acoustic forcing .",
            "id": "4025690",
            "problem": "Consider a compact, premixed flame in a duct subject to a small-amplitude harmonic perturbation of the inlet velocity. In the linear, time-invariant limit, the unsteady heat-release rate responds to the inlet-velocity perturbation through a convolution with an impulse response that is physically modeled as a pure time delay followed by a first-order relaxation. Denote the inlet-velocity perturbation by $u'(t)=\\Re\\{ \\hat{u}\\,\\exp(i\\omega t)\\}$ and the heat-release-rate perturbation by $q'(t)=\\Re\\{ \\hat{q}\\,\\exp(i\\omega t)\\}$. The Flame Transfer Function (FTF), defined as $G(\\omega)=\\hat{q}/\\hat{u}$, is given by\n$$\nG(\\omega)=\\frac{\\beta\\,\\exp(-i\\omega \\tau)}{1+i\\omega T},\n$$\nwhere $\\beta0$ is a real, dimensionless gain parameter, $\\tau0$ is a real, positive time delay, $T0$ is a real, positive relaxation time, and $\\omega$ is the angular frequency in radians per second. Starting from the linear systems framework and the complex representation of $G(\\omega)$, derive expressions for the magnitude $|G(\\omega)|$ and the phase angle $\\angle G(\\omega)$ (use the principal value of the argument and express the angle in radians). Then, identify the corner angular frequency $\\omega_{c}$ at which the magnitude $|G(\\omega)|$ has decreased to $1/\\sqrt{2}$ of its low-frequency limit. Provide closed-form analytic expressions for $|G(\\omega)|$, $\\angle G(\\omega)$, and $\\omega_{c}$. State the angle in radians and the corner frequency in radians per second. Do not assume any special numerical values; your final answer must be exact analytic expressions in terms of $\\beta$, $\\omega$, $\\tau$, and $T$.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. All provided information is consistent and conforms to established principles in linear systems theory and combustion dynamics. The model for the Flame Transfer Function (FTF) is a standard representation known as a time-delay with a first-order lag. The problem is solvable as stated.\n\nThe Flame Transfer Function (FTF), $G(\\omega)$, is given as a complex function of the angular frequency $\\omega$:\n$$\nG(\\omega)=\\frac{\\beta\\,\\exp(-i\\omega \\tau)}{1+i\\omega T}\n$$\nHere, $\\beta$, $\\tau$, and $T$ are real, positive constants, and $i$ is the imaginary unit. To solve the problem, we will derive expressions for the magnitude $|G(\\omega)|$ and the phase angle $\\angle G(\\omega)$, and then determine the corner frequency $\\omega_c$.\n\nFirst, we derive the magnitude of the FTF, $|G(\\omega)|$. The magnitude of a ratio of two complex numbers is the ratio of their magnitudes. Let the numerator be $z_1 = \\beta\\,\\exp(-i\\omega \\tau)$ and the denominator be $z_2 = 1+i\\omega T$. Then, $|G(\\omega)| = \\frac{|z_1|}{|z_2|}$.\n\nThe magnitude of the numerator, $|z_1|$, is calculated as follows:\n$$\n|z_1| = |\\beta\\,\\exp(-i\\omega \\tau)|\n$$\nSince $\\beta$ is a positive real number, we can write:\n$$\n|z_1| = \\beta\\,|\\exp(-i\\omega \\tau)|\n$$\nUsing Euler's formula, $\\exp(-i\\omega \\tau) = \\cos(-\\omega\\tau) + i\\sin(-\\omega\\tau) = \\cos(\\omega\\tau) - i\\sin(\\omega\\tau)$. The magnitude is:\n$$\n|\\exp(-i\\omega \\tau)| = \\sqrt{\\cos^2(\\omega\\tau) + (-\\sin(\\omega\\tau))^2} = \\sqrt{\\cos^2(\\omega\\tau) + \\sin^2(\\omega\\tau)} = \\sqrt{1} = 1\n$$\nTherefore, the magnitude of the numerator is $|z_1| = \\beta$.\n\nThe magnitude of the denominator, $|z_2|$, is the magnitude of the complex number $1+i\\omega T$:\n$$\n|z_2| = |1+i\\omega T| = \\sqrt{1^2 + (\\omega T)^2} = \\sqrt{1 + \\omega^2 T^2}\n$$\nCombining the magnitudes of the numerator and the denominator, we obtain the expression for the magnitude of the FTF:\n$$\n|G(\\omega)| = \\frac{|z_1|}{|z_2|} = \\frac{\\beta}{\\sqrt{1 + \\omega^2 T^2}}\n$$\n\nNext, we derive the phase angle of the FTF, $\\angle G(\\omega)$. The phase of a ratio of two complex numbers is the difference of their phases: $\\angle G(\\omega) = \\angle(z_1) - \\angle(z_2)$.\n\nThe phase of the numerator, $\\angle(z_1)$, is:\n$$\n\\angle(z_1) = \\angle(\\beta\\,\\exp(-i\\omega \\tau))\n$$\nSince $\\beta$ is a positive real number, its phase is $0$. Thus, the phase of the numerator is simply the phase of the complex exponential term:\n$$\n\\angle(z_1) = \\angle(\\exp(-i\\omega \\tau)) = -\\omega\\tau\n$$\nThis is expressed in radians.\n\nThe phase of the denominator, $\\angle(z_2)$, is the phase of the complex number $1+i\\omega T$. This is given by the arctangent of the ratio of the imaginary part to the real part:\n$$\n\\angle(z_2) = \\angle(1+i\\omega T) = \\arctan\\left(\\frac{\\omega T}{1}\\right) = \\arctan(\\omega T)\n$$\nThis is the principal value, which lies in the interval $(0, \\pi/2)$ since $\\omega  0$ and $T  0$.\n\nCombining the phases, we obtain the expression for the phase angle of the FTF:\n$$\n\\angle G(\\omega) = \\angle(z_1) - \\angle(z_2) = -\\omega\\tau - \\arctan(\\omega T)\n$$\nThe result is in radians.\n\nFinally, we determine the corner angular frequency, $\\omega_c$, defined as the frequency at which the magnitude $|G(\\omega)|$ has decreased to $1/\\sqrt{2}$ of its low-frequency limit. First, we find the low-frequency limit by evaluating $|G(\\omega)|$ as $\\omega \\to 0$:\n$$\n|G(0)| = \\lim_{\\omega \\to 0} \\frac{\\beta}{\\sqrt{1 + \\omega^2 T^2}} = \\frac{\\beta}{\\sqrt{1 + 0}} = \\beta\n$$\nThe condition for the corner frequency $\\omega_c$ is:\n$$\n|G(\\omega_c)| = \\frac{1}{\\sqrt{2}} |G(0)|\n$$\nSubstituting the expressions for $|G(\\omega_c)|$ and $|G(0)|$:\n$$\n\\frac{\\beta}{\\sqrt{1 + \\omega_c^2 T^2}} = \\frac{1}{\\sqrt{2}} \\beta\n$$\nSince $\\beta  0$, we can divide both sides by $\\beta$:\n$$\n\\frac{1}{\\sqrt{1 + \\omega_c^2 T^2}} = \\frac{1}{\\sqrt{2}}\n$$\nTaking the reciprocal of both sides gives:\n$$\n\\sqrt{1 + \\omega_c^2 T^2} = \\sqrt{2}\n$$\nSquaring both sides yields:\n$$\n1 + \\omega_c^2 T^2 = 2\n$$\nSolving for $\\omega_c^2$:\n$$\n\\omega_c^2 T^2 = 1 \\implies \\omega_c^2 = \\frac{1}{T^2}\n$$\nSince angular frequency $\\omega$ must be non-negative, we take the positive square root:\n$$\n\\omega_c = \\sqrt{\\frac{1}{T^2}} = \\frac{1}{T}\n$$\nThe corner frequency $\\omega_c$ depends only on the relaxation time $T$ and has units of radians per second.\n\nThe three requested quantities are $|G(\\omega)|$, $\\angle G(\\omega)$, and $\\omega_c$. The derived closed-form analytic expressions are:\n1. $|G(\\omega)| = \\frac{\\beta}{\\sqrt{1 + \\omega^2 T^2}}$\n2. $\\angle G(\\omega) = -\\omega\\tau - \\arctan(\\omega T)$\n3. $\\omega_c = \\frac{1}{T}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\beta}{\\sqrt{1 + \\omega^2 T^2}}  -\\omega \\tau - \\arctan(\\omega T)  \\frac{1}{T} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While low-order models are practical, deriving them from physical principles provides deeper insight into the underlying mechanisms governing flame response. This practice guides you through the derivation of an FTF for a purely convective flame, where perturbations are simply carried by the mean flow. This hands-on derivation will not only illuminate the physical origin of frequency-dependent gain and phase lag but also introduce the Strouhal number, a crucial dimensionless parameter that allows for the collapse of experimental data from different operating conditions onto a single curve .",
            "id": "4025671",
            "problem": "Consider a one-dimensional, mean-flow-aligned premixed flame of length $L$ with uniform mean axial velocity $U$ and negligible diffusive dispersion of perturbations. Let the normalized axial velocity fluctuation $u'(x,t)/\\overline{u}$ at the flame base $x=0$ be a single-tone harmonic input of angular frequency $\\omega$, and assume that perturbations are convected downstream without distortion by the mean flow. The normalized global heat-release-rate fluctuation $q'(t)/\\overline{q}$ is defined as a uniform spatial average of a local linear response along the flame, where the normalized local heat-release-rate fluctuation at position $x$ is proportional to the locally convected normalized velocity fluctuation with a dimensionless proportionality constant $n$ that does not depend on $\\omega$, $U$, or $L$. The normalized flame transfer function (FTF) $G(\\omega)$ is defined as the complex ratio of the Fourier amplitude of the normalized global heat-release-rate fluctuation to the Fourier amplitude of the normalized inlet velocity fluctuation.\n\nStarting from conservation of a passively convected scalar and the definition of the FTF, derive a closed-form expression for the nondimensionalized FTF $G(St)$ as a function of the Strouhal number $St=\\omega L/U$ under this convective-delay model with uniform spatial averaging. Your derivation must explicitly show how the convective transport produces the frequency-dependent phase and amplitude of $G(St)$, and justify how changes in $U$ and $L$ across operating conditions are collapsed by the choice of $St$. Express your final answer for $G(St)$ as a single analytic expression. Use radians for any phase angles. No numerical approximation or rounding is required.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained. It describes a classical convective time-lag model for the flame transfer function (FTF), a fundamental concept in combustion dynamics. We proceed with the derivation.\n\nThe objective is to derive the flame transfer function $G(St)$, defined as the ratio of the complex Fourier amplitude of the normalized global heat-release-rate fluctuation, $q'(t)/\\overline{q}$, to that of the normalized inlet velocity fluctuation, $u'(0,t)/\\overline{u}$.\n\nLet the normalized inlet velocity fluctuation be represented in complex form as a single-tone harmonic signal with angular frequency $\\omega$. Without loss of generality, we can set its complex amplitude to unity:\n$$\n\\frac{u'(0,t)}{\\overline{u}} = \\exp(i \\omega t)\n$$\nThe problem states that these velocity perturbations are convected downstream with the uniform mean velocity $U$ without distortion. This is a model of pure passive convection. A perturbation observed at the flame inlet $x=0$ at an initial time $t_0$ will arrive at a downstream position $x$ at a later time $t = t_0 + \\tau_c$, where $\\tau_c = x/U$ is the convective time delay. Consequently, the velocity fluctuation at position $x$ and time $t$ is identical to the fluctuation that was at the inlet at the earlier time $t - x/U$. This introduces a position-dependent phase lag.\n$$\n\\frac{u'(x,t)}{\\overline{u}} = \\frac{u'(0, t - x/U)}{\\overline{u}} = \\exp\\left(i \\omega \\left(t - \\frac{x}{U}\\right)\\right) = \\exp(i \\omega t) \\exp\\left(-i \\omega \\frac{x}{U}\\right)\n$$\nThis expression explicitly shows how convective transport produces a frequency-dependent phase lag, given by the term $\\exp(-i\\omega x/U)$.\n\nNext, we model the flame's response. The normalized local heat-release-rate fluctuation at position $x$, which we denote $q'_{N,loc}(x,t)$, is assumed to be in a linear, instantaneous relationship with the local normalized velocity fluctuation. The proportionality constant is the dimensionless gain $n$.\n$$\nq'_{N,loc}(x,t) = n \\left(\\frac{u'(x,t)}{\\overline{u}}\\right) = n \\exp(i \\omega t) \\exp\\left(-i \\omega \\frac{x}{U}\\right)\n$$\nThe normalized global heat-release-rate fluctuation, $q'_N(t) = q'(t)/\\overline{q}$, is obtained by performing a uniform spatial average of this local linear response over the entire flame length $L$.\n$$\nq'_N(t) = \\frac{1}{L} \\int_{0}^{L} q'_{N,loc}(x,t) \\,dx = \\frac{1}{L} \\int_{0}^{L} n \\left(\\frac{u'(x,t)}{\\overline{u}}\\right) \\,dx\n$$\nSubstituting the expression for the convected velocity fluctuation:\n$$\nq'_N(t) = \\frac{n}{L} \\int_{0}^{L} \\exp(i \\omega t) \\exp\\left(-i \\omega \\frac{x}{U}\\right) \\,dx\n$$\nThe term $\\exp(i \\omega t)$ is independent of the spatial variable $x$ and can be factored out of the integral.\n$$\nq'_N(t) = \\exp(i \\omega t) \\left[ \\frac{n}{L} \\int_{0}^{L} \\exp\\left(-i \\omega \\frac{x}{U}\\right) \\,dx \\right]\n$$\nThe FTF, $G(\\omega)$, is the ratio of the complex amplitude of the output, $q'_N(t)$, to the complex amplitude of the input, $u'(0,t)/\\overline{u}$. From the expressions above, the input amplitude is $1$ and the output amplitude is the term in the square brackets.\n$$\nG(\\omega) = \\frac{\\hat{q}'_N}{\\hat{u}'_N} = \\frac{n}{L} \\int_{0}^{L} \\exp\\left(-i \\omega \\frac{x}{U}\\right) \\,dx\n$$\nThis integral represents the spatially averaged effect of all local contributions, which interfere with each other due to their differing phase lags. The amplitude and phase of the global response are thus frequency-dependent. We now evaluate the integral:\n$$\n\\int_{0}^{L} \\exp\\left(-i \\omega \\frac{x}{U}\\right) \\,dx = \\left[ \\frac{\\exp\\left(-i \\omega \\frac{x}{U}\\right)}{-i \\omega/U} \\right]_{x=0}^{x=L} = \\frac{U}{-i\\omega} \\left( \\exp\\left(-i \\omega \\frac{L}{U}\\right) - \\exp(0) \\right) = \\frac{iU}{\\omega} \\left( 1 - \\exp\\left(-i \\omega \\frac{L}{U}\\right) \\right)\n$$\nSubstituting this result back into the expression for $G(\\omega)$:\n$$\nG(\\omega) = \\frac{n}{L} \\left[ \\frac{iU}{\\omega} \\left( 1 - \\exp\\left(-i \\omega \\frac{L}{U}\\right) \\right) \\right] = n \\frac{iU}{\\omega L} \\left( 1 - \\exp\\left(-i \\omega \\frac{L}{U}\\right) \\right)\n$$\nTo nondimensionalize the transfer function, we introduce the Strouhal number, $St = \\frac{\\omega L}{U}$. This dimensionless number represents the ratio of the characteristic convective time scale of the flame, $\\tau_c = L/U$, to the characteristic time scale of the perturbation, $T = 1/\\omega$ (up to a factor of $2\\pi$). Rearranging the expression for $G(\\omega)$ in terms of $St$:\n$$\nG(St) = n \\frac{1}{i \\left(\\frac{\\omega L}{U}\\right)} \\left( 1 - \\exp\\left(-i \\frac{\\omega L}{U}\\right) \\right) = n \\frac{1 - \\exp(-iSt)}{iSt}\n$$\nThis final expression depends only on the Strouhal number $St$. This demonstrates the data collapse: any combination of operating conditions (i.e., different values of $\\omega$, $L$, and $U$) that results in the same value of $St$ will produce the same nondimensional flame response $G(St)$. The Strouhal number effectively captures the entire dynamic behavior of this model by normalizing the forcing frequency $\\omega$ with the characteristic convection time $L/U$.\n\nThe expression can also be written in terms of the sinc function, which makes the amplitude and phase response more explicit. By factoring out $\\exp(-iSt/2)$:\n$$\nG(St) = n \\frac{\\exp(-iSt/2) ( \\exp(iSt/2) - \\exp(-iSt/2) )}{iSt} = n \\exp(-iSt/2) \\frac{2i\\sin(St/2)}{iSt} = n \\left( \\frac{\\sin(St/2)}{St/2} \\right) \\exp(-iSt/2)\n$$\nHere, the amplitude is $|G(St)| = n |\\sin(St/2)/(St/2)|$ and the phase is $\\angle G(St) = -St/2$ (plus a phase of $\\pi$ where the sinc function is negative). However, the form derived directly from integration is more compact.",
            "answer": "$$\n\\boxed{n \\frac{1 - \\exp(-iSt)}{iSt}}\n$$"
        },
        {
            "introduction": "The linear FTF concept is powerful, but real flames exhibit nonlinear behavior, especially at higher forcing amplitudes where effects like saturation become important. The Flame Describing Function (FDF) extends the FTF framework to account for such nonlinearities by making the flame's gain dependent on the forcing amplitude. This practice challenges you to derive and numerically evaluate an FDF for a flame with a saturating response, providing a critical bridge from linear systems theory to the analysis of nonlinear thermoacoustic phenomena and limit cycles .",
            "id": "4025734",
            "problem": "A static nonlinear mapping between velocity perturbation and heat-release-rate perturbation in a premixed flame is modeled as $q'(t)=f(u'(t))$ with $f(u')=q_{\\max}\\tanh(u'/U_s)$, where $u'(t)$ is the velocity fluctuation at the flame, $q'(t)$ is the corresponding heat-release-rate fluctuation, $q_{\\max}$ is the saturation level, and $U_s$ is a characteristic saturation scale for the input. Consider a sinusoidal input $u'(t)=A\\sin(\\omega t)$ of amplitude $A$ (in $\\mathrm{m/s}$) and angular frequency $\\omega$ (in $\\mathrm{rad/s}$). Using the fundamental definition of a describing function, derive the expression for the flame describing function $G(A,\\omega)$, defined as the ratio between the amplitude of the fundamental component of $q'(t)$ and the input amplitude $A$. Show from first principles and Fourier orthogonality that the resulting $G(A,\\omega)$ does not depend on $\\omega$ for this static nonlinearity, and reduce it to an integral with respect to an angle variable measured in radians. Determine the small-amplitude limit $A\\to 0$ and the large-amplitude asymptotic behavior $A\\to\\infty$ using appropriate expansions of $\\tanh(\\cdot)$, and interpret both limits physically in the context of flame transfer functions and flame describing functions.\n\nThen, evaluate $G(A,\\omega)$ numerically for the following test suite using high-accuracy numerical integration, expressing each result in $\\mathrm{W\\,s/m}$ and rounding to six decimal places:\n- Case $1$: $q_{\\max}=1000$ $\\mathrm{W}$, $U_s=1$ $\\mathrm{m/s}$, $A=0$ $\\mathrm{m/s}$, $\\omega=10$ $\\mathrm{rad/s}$.\n- Case $2$: $q_{\\max}=1000$ $\\mathrm{W}$, $U_s=1$ $\\mathrm{m/s}$, $A=0.1$ $\\mathrm{m/s}$, $\\omega=25$ $\\mathrm{rad/s}$.\n- Case $3$: $q_{\\max}=1000$ $\\mathrm{W}$, $U_s=1$ $\\mathrm{m/s}$, $A=1$ $\\mathrm{m/s}$, $\\omega=50$ $\\mathrm{rad/s}$.\n- Case $4$: $q_{\\max}=1000$ $\\mathrm{W}$, $U_s=1$ $\\mathrm{m/s}$, $A=5$ $\\mathrm{m/s}$, $\\omega=75$ $\\mathrm{rad/s}$.\n- Case $5$: $q_{\\max}=1000$ $\\mathrm{W}$, $U_s=1$ $\\mathrm{m/s}$, $A=20$ $\\mathrm{m/s}$, $\\omega=100$ $\\mathrm{rad/s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), in the order of Cases $1$ through $5$, where each $r_i$ is a float in $\\mathrm{W\\,s/m}$ rounded to six decimal places. The angle variable used in the derivation and numerical integration must be in radians.",
            "solution": "The problem requires the derivation, analysis, and numerical evaluation of the Flame Describing Function (FDF) for a given static nonlinear relationship between velocity and heat release rate perturbations.\n\nThe static nonlinear mapping is given by $q'(t) = f(u'(t))$, where the function is $f(u') = q_{\\max}\\tanh(u'/U_s)$. The input velocity perturbation is a sinusoid, $u'(t) = A\\sin(\\omega t)$. The output heat release rate perturbation is therefore $q'(t) = q_{\\max}\\tanh\\left(\\frac{A\\sin(\\omega t)}{U_s}\\right)$.\n\nThe Flame Describing Function, $G(A, \\omega)$, is defined as the ratio of the amplitude of the fundamental harmonic of the output signal $q'(t)$ to the amplitude of the input signal $A$.\n\nFirst, we derive the FDF from first principles. The output signal $q'(t)$ is a periodic function with a period $T = 2\\pi/\\omega$. It can be expanded into a Fourier series:\n$$q'(t) = a_0 + \\sum_{n=1}^{\\infty} \\left[ a_n \\cos(n\\omega t) + b_n \\sin(n\\omega t) \\right]$$\nThe Fourier coefficients are determined by the orthogonality of trigonometric functions. The function $u'(t) = A\\sin(\\omega t)$ is an odd function of $t$. The function $\\tanh(x)$ is an odd function of its argument $x$. Therefore, $q'(t) = f(u'(t))$ is an odd function of time $t$, since $f(-u') = q_{\\max}\\tanh(-u'/U_s) = -q_{\\max}\\tanh(u'/U_s) = -f(u')$. The integral of an odd function over a symmetric interval $[-T/2, T/2]$ is zero. The coefficients $a_n$ are calculated by integrating $q'(t)\\cos(n\\omega t)$, which is the product of an odd function ($q'(t)$) and an even function ($\\cos(n\\omega t)$), resulting in an odd integrand. Thus, all $a_n = 0$ for $n \\geq 0$.\n\nThe coefficients $b_n$ are given by:\n$$b_n = \\frac{2}{T} \\int_{-T/2}^{T/2} q'(t) \\sin(n\\omega t) \\, dt$$\nThe integrand $q'(t)\\sin(n\\omega t)$ is the product of two odd functions, which is an even function, so the integral is generally non-zero. The fundamental component of the output corresponds to $n=1$, and its amplitude is $b_1$.\n$$b_1 = \\frac{2}{T} \\int_{-T/2}^{T/2} q_{\\max}\\tanh\\left(\\frac{A\\sin(\\omega t)}{U_s}\\right) \\sin(\\omega t) \\, dt$$\nSubstituting $T = 2\\pi/\\omega$, we get:\n$$b_1 = \\frac{\\omega}{\\pi} \\int_{-\\pi/\\omega}^{\\pi/\\omega} q_{\\max}\\tanh\\left(\\frac{A\\sin(\\omega t)}{U_s}\\right) \\sin(\\omega t) \\, dt$$\nTo show that the result is independent of $\\omega$ for this static nonlinearity, we perform a change of variables. Let $\\theta = \\omega t$, which implies $dt = d\\theta/\\omega$. The integration limits for $t$ from $-\\pi/\\omega$ to $\\pi/\\omega$ correspond to $\\theta$ from $-\\pi$ to $\\pi$.\n$$b_1 = \\frac{\\omega}{\\pi} \\int_{-\\pi}^{\\pi} q_{\\max}\\tanh\\left(\\frac{A\\sin(\\theta)}{U_s}\\right) \\sin(\\theta) \\, \\frac{d\\theta}{\\omega} = \\frac{q_{\\max}}{\\pi} \\int_{-\\pi}^{\\pi} \\tanh\\left(\\frac{A\\sin(\\theta)}{U_s}\\right) \\sin(\\theta) \\, d\\theta$$\nAs demonstrated, the angular frequency $\\omega$ is eliminated from the expression for $b_1$, proving that the FDF for a static nonlinearity is independent of frequency. We can therefore denote it as $G(A)$.\nThe integrand $g(\\theta) = \\tanh\\left(\\frac{A\\sin(\\theta)}{U_s}\\right) \\sin(\\theta)$ is an even function of $\\theta$, since $g(-\\theta) = \\tanh\\left(\\frac{A\\sin(-\\theta)}{U_s}\\right) \\sin(-\\theta) = \\tanh\\left(-\\frac{A\\sin(\\theta)}{U_s}\\right)(-\\sin(\\theta)) = \\left(-\\tanh\\left(\\frac{A\\sin(\\theta)}{U_s}\\right)\\right)(-\\sin(\\theta)) = g(\\theta)$. Thus, we can simplify the integral:\n$$b_1 = \\frac{2q_{\\max}}{\\pi} \\int_{0}^{\\pi} \\tanh\\left(\\frac{A\\sin(\\theta)}{U_s}\\right) \\sin(\\theta) \\, d\\theta$$\nThe FDF is $G(A) = b_1/A$. The final expression to be evaluated is:\n$$G(A) = \\frac{2q_{\\max}}{\\pi A} \\int_{0}^{\\pi} \\tanh\\left(\\frac{A\\sin(\\theta)}{U_s}\\right) \\sin(\\theta) \\, d\\theta$$\n\nNext, we analyze the asymptotic limits.\nFor the small-amplitude limit, $A \\to 0$, the argument of the $\\tanh$ function, $x = A\\sin(\\theta)/U_s$, is small. We use the Taylor expansion $\\tanh(x) \\approx x$.\n$$G(A) \\approx \\frac{2q_{\\max}}{\\pi A} \\int_{0}^{\\pi} \\left(\\frac{A\\sin(\\theta)}{U_s}\\right) \\sin(\\theta) \\, d\\theta = \\frac{2q_{\\max}}{\\pi U_s} \\int_{0}^{\\pi} \\sin^2(\\theta) \\, d\\theta$$\nThe integral $\\int_0^{\\pi} \\sin^2(\\theta) \\, d\\theta = \\int_0^{\\pi} \\frac{1-\\cos(2\\theta)}{2} d\\theta = \\left[\\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4}\\right]_0^{\\pi} = \\frac{\\pi}{2}$.\nThus, the small-amplitude limit is:\n$$\\lim_{A \\to 0} G(A) = \\frac{2q_{\\max}}{\\pi U_s} \\left(\\frac{\\pi}{2}\\right) = \\frac{q_{\\max}}{U_s}$$\nPhysically, this limit represents the linear gain of the system. For infinitesimally small perturbations, the nonlinear function $f(u')$ can be approximated by its tangent at the origin, $f(u') \\approx f'(0)u'$. The derivative is $f'(u') = \\frac{q_{\\max}}{U_s}\\mathrm{sech}^2(u'/U_s)$, and at $u'=0$, $f'(0) = q_{\\max}/U_s$. This linear gain is known as the Flame Transfer Function (FTF), and the FDF correctly reduces to the FTF in the linear regime.\n\nFor the large-amplitude asymptotic behavior, $A \\to \\infty$, the argument $x = A\\sin(\\theta)/U_s$ becomes very large for any $\\theta \\in (0, \\pi)$. The hyperbolic tangent approaches the signum function: $\\tanh(x) \\to \\mathrm{sgn}(x)$. In the integration interval $[0, \\pi]$, $\\sin(\\theta) \\ge 0$, so $\\tanh(A\\sin(\\theta)/U_s) \\to 1$.\n$$G(A) \\approx \\frac{2q_{\\max}}{\\pi A} \\int_{0}^{\\pi} (1) \\sin(\\theta) \\, d\\theta$$\nThe integral $\\int_0^{\\pi} \\sin(\\theta) d\\theta = [-\\cos(\\theta)]_0^{\\pi} = 2$.\nSo, the large-amplitude asymptote is:\n$$G(A) \\sim \\frac{2q_{\\max}}{\\pi A} (2) = \\frac{4q_{\\max}}{\\pi A}$$\nPhysically, as the input amplitude $A$ becomes very large, the flame response saturates. The output $q'(t)$ approaches a square wave oscillating between $+q_{\\max}$ and $-q_{\\max}$. The amplitude of the fundamental harmonic of a square wave with peak value $q_{\\max}$ is $4q_{\\max}/\\pi$. Since the FDF is this amplitude divided by the input amplitude $A$, the gain must decay as $1/A$, which is confirmed by our derivation.\n\nFor numerical evaluation, we use the derived integral expression for $G(A)$. For Case 1 where $A=0$, we use the analytical small-amplitude limit $G(0) = q_{\\max}/U_s$. For Cases 2-5 where $A0$, we compute the definite integral numerically using high-accuracy quadrature. The parameters $q_{\\max}$, $U_s$, and $A$ for each case are substituted into the formula for $G(A)$. The results are then rounded to six decimal places.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the Flame Describing Function (FDF) for several test cases.\n\n    The FDF G(A) for a static nonlinearity q' = q_max * tanh(u'/U_s) under sinusoidal\n    forcing u' = A * sin(omega*t) is given by:\n    G(A) = (2 * q_max / (pi * A)) * Integral_0^pi[tanh(A*sin(theta)/U_s) * sin(theta) dtheta]\n\n    In the limit A - 0, G(A) - q_max / U_s.\n    \"\"\"\n\n    test_cases = [\n        # (q_max [W], U_s [m/s], A [m/s], omega [rad/s])\n        (1000.0, 1.0, 0.0, 10.0),\n        (1000.0, 1.0, 0.1, 25.0),\n        (1000.0, 1.0, 1.0, 50.0),\n        (1000.0, 1.0, 5.0, 75.0),\n        (1000.0, 1.0, 20.0, 100.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        q_max, U_s, A, omega = case\n\n        if A == 0:\n            # Handle the small-amplitude analytical limit (A - 0)\n            # G(0) = q_max / U_s\n            g_a = q_max / U_s\n        else:\n            # Define the integrand for numerical integration\n            # The integrand is a function of theta.\n            def integrand(theta):\n                return np.tanh(A * np.sin(theta) / U_s) * np.sin(theta)\n\n            # Perform high-accuracy numerical integration from 0 to pi\n            integral_val, _ = integrate.quad(integrand, 0, np.pi)\n\n            # Calculate the FDF G(A) = b1 / A\n            g_a = (2 * q_max / (np.pi * A)) * integral_val\n\n        # Append the result rounded to six decimal places\n        results.append(f\"{g_a:.6f}\")\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}