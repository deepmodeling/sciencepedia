{
    "hands_on_practices": [
        {
            "introduction": "To analyze how a complex sound field interacts with a heat source, it is often useful to decompose the field into a series of fundamental acoustic modes. This practice introduces the Galerkin projection method, a powerful mathematical tool for isolating the effect of a source on each individual mode. By modeling the heat source as an idealized point source, this exercise provides a clear and intuitive understanding of spatial coupling, demonstrating how the effectiveness of a source in driving an instability depends critically on its location relative to the pressure nodes and antinodes of the acoustic mode. ",
            "id": "4071507",
            "problem": "A one-dimensional, uniform, open–open duct of length $L$ supports small-amplitude acoustic motions about a spatially uniform base state with constant density $\\rho_{0}$ and speed of sound $c_{0}$. The acoustic pressure eigenfunctions $ \\phi_{n}(x) $ for the open–open duct satisfy the Sturm–Liouville problem $ \\partial_{xx} \\phi_{n} + k_{n}^{2} \\phi_{n} = 0 $ with boundary conditions $ \\phi_{n}(0) = 0 $ and $ \\phi_{n}(L) = 0 $, and form a complete orthogonal basis on $[0,L]$ under the inner product $ \\langle f,g \\rangle = \\int_{0}^{L} f(x)\\,g(x)\\,dx $. A compact, localized unsteady heat release is modeled as $ \\dot{q}'(x,t) = \\hat{q}\\,\\delta(x - x_{f})\\,\\cos(\\omega t) $, where $ \\hat{q} $ is the amplitude, $ \\delta(\\cdot) $ is the Dirac distribution, and $ x_{f} \\in (0,L) $. Consider the Galerkin projection of the volumetric heat-release perturbation onto the duct eigenfunctions to obtain mode-by-mode forcing coefficients.\n\nDefine the modal participation factor for mode $n$ as the spatial projection coefficient per unit heat-release amplitude,\n$$\n\\mathcal{G}_{n}(x_{f}) \\equiv \\frac{1}{\\hat{q}}\\,\\frac{\\int_{0}^{L} \\phi_{n}(x)\\,\\dot{q}'(x,t)\\,dx}{\\int_{0}^{L} \\phi_{n}^{2}(x)\\,dx},\n$$\nwhich isolates the spatial dependence of the forcing on mode $n$. Using only fundamental properties of the eigenproblem and distributions, compute a closed-form analytic expression for $ \\mathcal{G}_{n}(x_{f}) $ in terms of $L$, $n$, and $x_{f}$. Then, based on first principles and the Rayleigh criterion, explain qualitatively (no calculation required for this part) which modes are most strongly driven by the localized source as $n$ varies for a fixed $x_{f}$, and how the sign of $ \\mathcal{G}_{n} $ relates to potential growth or damping when the unsteady heat release is in phase with the acoustic pressure.\n\nYour final answer must be a single closed-form analytic expression for $ \\mathcal{G}_{n}(x_{f}) $. Do not include units. No numerical rounding is required.",
            "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Duct Geometry**: One-dimensional, uniform, length $L$.\n- **Boundary Conditions**: Open–open, which for the pressure eigenfunctions $\\phi_n(x)$ implies Dirichlet boundary conditions.\n- **Base State**: Spatially uniform, constant density $\\rho_0$, constant speed of sound $c_0$.\n- **Governing Equation for Eigenfunctions**: The Sturm–Liouville problem $\\partial_{xx} \\phi_{n} + k_{n}^{2} \\phi_{n} = 0$.\n- **Eigenfunction Boundary Conditions**: $\\phi_{n}(0) = 0$ and $\\phi_{n}(L) = 0$.\n- **Orthogonality Condition**: The eigenfunctions form a complete orthogonal basis on $[0,L]$ with the inner product $\\langle f,g \\rangle = \\int_{0}^{L} f(x)\\,g(x)\\,dx$.\n- **Heat Release Model**: $\\dot{q}'(x,t) = \\hat{q}\\,\\delta(x - x_{f})\\,\\cos(\\omega t)$, where $\\delta(\\cdot)$ is the Dirac distribution and the source location is $x_{f} \\in (0,L)$.\n- **Definition of Modal Participation Factor**: $\\mathcal{G}_{n}(x_{f}) \\equiv \\frac{1}{\\hat{q}}\\,\\frac{\\int_{0}^{L} \\phi_{n}(x)\\,\\dot{q}'(x,t)\\,dx}{\\int_{0}^{L} \\phi_{n}^{2}(x)\\,dx}$.\n- **Tasks**:\n    1. Compute a closed-form analytic expression for $\\mathcal{G}_{n}(x_{f})$.\n    2. Qualitatively explain which modes are most strongly driven.\n    3. Qualitatively explain the relationship between the sign of $\\mathcal{G}_{n}$ and stability based on the Rayleigh criterion.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n1.  **Scientific Soundness**: The problem describes a canonical case of thermoacoustic instability analysis. The use of the one-dimensional wave equation, Sturm-Liouville theory for eigenfunctions, Galerkin projection, and a localized source modeled by a Dirac delta function are all standard and well-established techniques in acoustics and combustion science. The boundary conditions $\\phi_n(0) = 0$ and $\\phi_n(L) = 0$ correctly represent the pressure nodes at the ends of an open–open duct.\n2.  **Well-Posedness**: The eigenproblem is well-defined and possesses a unique, discrete spectrum of eigenvalues and a corresponding set of orthogonal eigenfunctions. The definition of the modal participation factor $\\mathcal{G}_{n}(x_f)$ is explicit.\n3.  **Completeness and Consistency**: The problem provides all necessary information. There is a minor ambiguity in the definition of $\\mathcal{G}_{n}(x_f)$: its notation suggests it is a function of spatial variables only, but its definition includes the time-dependent term $\\dot{q}'(x,t)$. The phrase \"isolates the spatial dependence of the forcing\" clarifies the intent: $\\mathcal{G}_{n}(x_f)$ represents the amplitude of the modal forcing component that depends on spatial coupling. The time-varying part $\\cos(\\omega t)$ of the heat release should be separated out. This is a common practice and does not invalidate the problem but requires careful interpretation.\n4.  **No other flaws detected**: The problem is not unrealistic (within the context of a physical model), ill-posed, trivial, or unverifiable.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe solution proceeds in three parts as requested: derivation of $\\mathcal{G}_{n}(x_{f})$, analysis of modal driving strength, and interpretation of the sign of $\\mathcal{G}_{n}(x_{f})$ in the context of the Rayleigh criterion.\n\n**1. Calculation of the Modal Participation Factor $\\mathcal{G}_{n}(x_{f})$**\n\nFirst, we solve for the eigenfunctions $\\phi_n(x)$ from the given Sturm-Liouville problem:\n$$\n\\frac{d^2\\phi_n}{dx^2} + k_n^2 \\phi_n = 0\n$$\nThe general solution is $\\phi_n(x) = A \\sin(k_n x) + B \\cos(k_n x)$. Applying the boundary conditions:\n- $\\phi_n(0) = 0 \\implies A \\sin(0) + B \\cos(0) = 0 \\implies B=0$. The solution is of the form $\\phi_n(x) = A \\sin(k_n x)$.\n- $\\phi_n(L) = 0 \\implies A \\sin(k_n L) = 0$. For non-trivial solutions ($A \\neq 0$), we must have $\\sin(k_n L) = 0$, which implies $k_n L = n\\pi$ for integer $n$.\n\nThe eigenvalues are $k_n = \\frac{n\\pi}{L}$ for $n = 1, 2, 3, \\dots$ (The case $n=0$ gives the trivial solution $\\phi_0(x)=0$). The corresponding eigenfunctions are $\\phi_n(x) = A_n \\sin\\left(\\frac{n\\pi x}{L}\\right)$, where $A_n$ are arbitrary normalization constants. Since $\\mathcal{G}_{n}(x_f)$ is a ratio where $\\phi_n$ appears in the numerator and $\\phi_n^2$ in the denominator, the constants $A_n$ will cancel out. For simplicity, we choose $A_n=1$, so $\\phi_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$.\n\nNext, we compute the components of the expression for $\\mathcal{G}_{n}(x_f)$. As noted in the validation, the time-dependent term $\\cos(\\omega t)$ in $\\dot{q}'(x,t)$ is separated to yield a purely spatial coefficient. Let's define the spatial part of the heat release as $\\dot{Q}(x) = \\hat{q}\\,\\delta(x - x_f)$. The definition of $\\mathcal{G}_n(x_f)$ is thus interpreted as:\n$$\n\\mathcal{G}_{n}(x_{f}) = \\frac{1}{\\hat{q}}\\,\\frac{\\int_{0}^{L} \\phi_{n}(x)\\,\\dot{Q}(x)\\,dx}{\\int_{0}^{L} \\phi_{n}^{2}(x)\\,dx}\n$$\nThe numerator integral is the projection of the source onto the $n$-th mode:\n$$\n\\int_{0}^{L} \\phi_{n}(x)\\,\\dot{Q}(x)\\,dx = \\int_{0}^{L} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\hat{q}\\,\\delta(x - x_{f}) \\,dx\n$$\nUsing the sifting property of the Dirac delta function, which states $\\int f(x)\\delta(x-a)dx = f(a)$, and given that $x_f \\in (0,L)$, the integral evaluates to:\n$$\n\\hat{q}\\,\\sin\\left(\\frac{n\\pi x_f}{L}\\right)\n$$\nThe denominator integral is the squared norm of the eigenfunction:\n$$\n\\int_{0}^{L} \\phi_{n}^{2}(x)\\,dx = \\int_{0}^{L} \\sin^2\\left(\\frac{n\\pi x}{L}\\right) \\,dx\n$$\nUsing the trigonometric identity $\\sin^2(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$, the integral becomes:\n$$\n\\int_{0}^{L} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) \\,dx = \\frac{1}{2} \\left[ x - \\frac{L}{2n\\pi}\\sin\\left(\\frac{2n\\pi x}{L}\\right) \\right]_{0}^{L}\n$$\nEvaluating at the limits:\n$$\n\\frac{1}{2} \\left[ \\left(L - \\frac{L}{2n\\pi}\\sin(2n\\pi)\\right) - \\left(0 - \\frac{L}{2n\\pi}\\sin(0)\\right) \\right] = \\frac{1}{2} [L - 0 - 0] = \\frac{L}{2}\n$$\nNow, substitute the results for the numerator and denominator integrals back into the expression for $\\mathcal{G}_{n}(x_{f})$:\n$$\n\\mathcal{G}_{n}(x_{f}) = \\frac{1}{\\hat{q}} \\frac{\\hat{q}\\,\\sin\\left(\\frac{n\\pi x_f}{L}\\right)}{\\frac{L}{2}}\n$$\nSimplifying, we obtain the final closed-form expression:\n$$\n\\mathcal{G}_{n}(x_{f}) = \\frac{2}{L} \\sin\\left(\\frac{n\\pi x_f}{L}\\right)\n$$\n\n**2. Qualitative Analysis of Modal Driving Strength**\n\nThe term $\\mathcal{G}_{n}(x_f)$ represents the spatial coupling between the localized heat source and the $n$-th acoustic mode. The strength of the forcing on mode $n$ is proportional to the magnitude $|\\mathcal{G}_{n}(x_f)|$.\n- **Maximum Driving**: The driving is strongest when $|\\mathcal{G}_{n}(x_f)|$ is maximized. This occurs when $\\left|\\sin\\left(\\frac{n\\pi x_f}{L}\\right)\\right| = 1$. This condition is met when the argument of the sine function is an odd multiple of $\\pi/2$, i.e., $\\frac{n\\pi x_f}{L} = \\frac{(2m+1)\\pi}{2}$ for some integer $m \\geq 0$. This means the heat source at $x_f$ is located precisely at a pressure antinode (a point of maximum amplitude) of the eigenfunction $\\phi_n(x)$.\n- **Minimum (Zero) Driving**: The driving is weakest (zero) when $\\mathcal{G}_{n}(x_f) = 0$. This occurs when $\\sin\\left(\\frac{n\\pi x_f}{L}\\right) = 0$. This condition is met when the argument is an integer multiple of $\\pi$, i.e., $\\frac{n\\pi x_f}{L} = m\\pi$ for some integer $m$. This means the heat source at $x_f$ is located precisely at a pressure node (a point of zero amplitude) of the eigenfunction $\\phi_n(x)$.\n\nTherefore, for a fixed source location $x_f$, modes are most strongly driven when their pressure antinodes coincide with $x_f$, and are not driven at all if their pressure nodes coincide with $x_f$.\n\n**3. Qualitative Analysis of the Sign of $\\mathcal{G}_{n}$ and Stability**\n\nThe Rayleigh criterion states that acoustic oscillations are driven if heat is added to the fluid when it is at maximum compression and removed when it is at maximum rarefaction. More generally, instability is promoted if the pressure perturbation and the heat release rate perturbation are, on average, in phase. The net rate of acoustic energy generation for a mode $n$ is proportional to the volume-integrated product of the modal pressure perturbation $p'_n(x,t)$ and the heat release rate perturbation $\\dot{q}'(x,t)$, averaged over a cycle.\n\nLet us assume the system is being forced at a frequency $\\omega$ close to a natural frequency $\\omega_n=c_0 k_n$, and that the pressure response of mode $n$ is in phase with the forcing, i.e., $p'_n(x,t) \\propto \\phi_n(x) \\cos(\\omega t)$. The problem states that the heat release $\\dot{q}'(x,t) = \\hat{q}\\,\\delta(x - x_f)\\,\\cos(\\omega t)$ is in phase with the pressure.\n\nThe time-averaged rate of work done by the heat source on mode $n$, $\\langle \\dot{W}_n \\rangle_t$, is:\n$$\n\\langle \\dot{W}_n \\rangle_t \\propto \\left\\langle \\int_0^L p'_n(x,t) \\dot{q}'(x,t) \\,dx \\right\\rangle_t \\propto \\left\\langle \\int_0^L \\phi_n(x)\\cos(\\omega t) \\cdot \\delta(x-x_f)\\cos(\\omega t) \\,dx \\right\\rangle_t\n$$\n$$\n\\langle \\dot{W}_n \\rangle_t \\propto \\phi_n(x_f) \\langle \\cos^2(\\omega t) \\rangle_t = \\frac{1}{2}\\phi_n(x_f)\n$$\nGrowth or damping depends on the sign of this work.\nFrom our derivation, $\\mathcal{G}_{n}(x_f) = \\frac{2}{L} \\phi_n(x_f)$. Since $L0$, the sign of $\\mathcal{G}_{n}(x_f)$ is the same as the sign of the eigenfunction $\\phi_n(x)$ at the source location $x_f$.\n\n- **$\\mathcal{G}_{n}(x_f)  0$**: This implies $\\phi_n(x_f)  0$. The source is in a region where the pressure eigenfunction is positive. As the heat release is in phase with the pressure ($\\cos(\\omega t)$ terms match), heat is added when the local modal pressure is positive (compression) and removed when it is negative (rarefaction). This satisfies the Rayleigh criterion for instability, leading to **growth** of the acoustic mode.\n- **$\\mathcal{G}_{n}(x_f)  0$**: This implies $\\phi_n(x_f)  0$. The source is in a region where the pressure eigenfunction is negative. Here, heat is added when the local modal pressure is negative (rarefaction). This is opposite to the Rayleigh criterion and extracts energy from the acoustic mode, leading to **damping**.\n- **$\\mathcal{G}_{n}(x_f) = 0$**: This implies $\\phi_n(x_f) = 0$. The source is at a pressure node. No work is done on the mode, and it is neither driven nor damped by the heat source.",
            "answer": "$$ \\boxed{ \\frac{2}{L} \\sin\\left(\\frac{n \\pi x_{f}}{L}\\right) } $$"
        },
        {
            "introduction": "Linear stability analysis can predict whether an instability will grow, but it incorrectly suggests this growth is unbounded. In reality, nonlinear effects cause the instability to saturate at a finite amplitude, forming a stable oscillation known as a limit cycle. This exercise delves into this crucial nonlinear phenomenon by modeling a flame with a \"soft-limiter\" response. By establishing an energy balance between the power generated by the flame, calculated via the Rayleigh criterion, and the energy dissipated through acoustic damping, you will predict the final, stable amplitude of the thermoacoustic instability. ",
            "id": "4071515",
            "problem": "A straight, low-Mach combustor supports a single dominant acoustic mode that is well-approximated as a plane wave at the flame location. Let the mean gas density be $\\rho_0$, the speed of sound be $c_0$, and the acoustic pressure fluctuation at the flame location be $p'(t)=A\\cos(\\omega_0 t)$, where $A$ is the pressure amplitude to be determined. Assume the acoustic velocity fluctuation at the flame location satisfies the plane-wave relation $u'(t)=p'(t)/(\\rho_0 c_0)$, and the modal acoustic energy density averaged over one period is $E(A)=A^2/(2\\rho_0 c_0^2)$. The acoustic mode has a linear damping rate $\\zeta$ (per unit time), so that energy is removed at rate $2\\zeta E(A)$.\n\nThe flame’s unsteady heat release response is modeled by a Flame Transfer Function (FTF) with a soft limiter: the volumetric heat release rate fluctuation is given by\n$$\n\\dot{q}'(t)=\\frac{K\\,u'(t)}{1+\\left(u'(t)/u_s\\right)^2},\n$$\nwhere $K$ is a gain and $u_s$ is a soft-limiter velocity scale. Assume the unsteady heat release is in phase with the acoustic pressure at the flame location (zero time delay), so the Rayleigh work per unit volume averaged over one period is\n$$\nW(A)=\\left\\langle p'(t)\\,\\dot{q}'(t)\\right\\rangle.\n$$\nAt a limit cycle, the Rayleigh criterion implies a balance between acoustic power input and dissipation:\n$$\nW(A)=2\\zeta\\,E(A).\n$$\n\nStarting from these bases and performing all necessary integrals exactly, derive the nonlinear amplitude condition implied by the Rayleigh balance for the given soft limiter, and compute the resulting limit-cycle pressure amplitude $A$. Use the following parameters:\n- $\\rho_0=1.20\\ \\mathrm{kg/m^3}$,\n- $c_0=340\\ \\mathrm{m/s}$,\n- $u_s=4.00\\ \\mathrm{m/s}$,\n- $\\zeta=30.0\\ \\mathrm{s^{-1}}$,\n- $K$ chosen such that $Kc_0/\\zeta=3.00$.\n\nExpress the final pressure amplitude $A$ in $\\mathrm{Pa}$ and round your answer to four significant figures.",
            "solution": "The user has asked for the limit-cycle pressure amplitude $A$ in a thermoacoustic system governed by the Rayleigh criterion.\n\n**Step 1: Problem Validation**\n\nFirst, I must validate the problem statement.\n\n**Givens:**\n- Mean gas density: $\\rho_0 = 1.20\\ \\mathrm{kg/m^3}$\n- Speed of sound: $c_0 = 340\\ \\mathrm{m/s}$\n- Soft-limiter velocity scale: $u_s = 4.00\\ \\mathrm{m/s}$\n- Linear damping rate: $\\zeta = 30.0\\ \\mathrm{s^{-1}}$\n- Gain parameter relation: $Kc_0/\\zeta = 3.00$\n- Acoustic pressure fluctuation: $p'(t) = A\\cos(\\omega_0 t)$\n- Acoustic velocity fluctuation: $u'(t) = p'(t)/(\\rho_0 c_0)$\n- Modal acoustic energy density: $E(A) = A^2/(2\\rho_0 c_0^2)$\n- Acoustic energy dissipation rate: $2\\zeta E(A)$\n- Volumetric heat release rate fluctuation: $\\dot{q}'(t)=\\frac{K\\,u'(t)}{1+\\left(u'(t)/u_s\\right)^2}$\n- Rayleigh work per unit volume (period-averaged): $W(A)=\\left\\langle p'(t)\\,\\dot{q}'(t)\\right\\rangle$\n- Limit-cycle condition (Rayleigh balance): $W(A)=2\\zeta\\,E(A)$\n\n**Validation using Extracted Givens:**\n1.  **Scientific or Factual Soundness:** The problem is based on established principles of thermoacoustics. The Rayleigh criterion, plane-wave acoustics, and a nonlinear flame model (the soft limiter) are standard concepts in the field of combustion instabilities. It is scientifically sound.\n2.  **Formalizability and Relevance:** The problem is a formal mathematical exercise directly relevant to the topic of thermoacoustic instabilities.\n3.  **Completeness and Consistency:** The problem provides all necessary definitions, equations, and numerical parameters to derive a unique solution. There are no apparent contradictions.\n4.  **Realism and Feasibility:** The given physical parameters are realistic for air at near-standard conditions. The model is a simplified but plausible representation of a real combustor.\n5.  **Well-Posedness:** The structure of the problem leads to a unique, non-trivial solution for the limit-cycle amplitude.\n6.  **Non-Triviality:** The problem requires performing a non-trivial integral and solving a nonlinear algebraic equation, which is a substantive reasoning challenge.\n7.  **Verifiability:** The derivation and result are mathematically verifiable.\n\n**Verdict:** The problem is valid.\n\n**Step 2: Derivation of the Solution**\n\nThe limit-cycle amplitude is determined by the balance between the acoustic energy production rate, given by the Rayleigh work $W(A)$, and the acoustic energy dissipation rate, $2\\zeta E(A)$. The condition is:\n$$\nW(A) = 2\\zeta E(A)\n$$\nWe need to evaluate both sides of this equation.\n\nFirst, we evaluate the Rayleigh work term, $W(A) = \\left\\langle p'(t)\\,\\dot{q}'(t)\\right\\rangle$. The angle brackets denote an average over one acoustic period, $T = 2\\pi/\\omega_0$.\n$$\nW(A) = \\frac{1}{T} \\int_0^T p'(t)\\,\\dot{q}'(t)\\,dt\n$$\nWe are given the expressions for the fluctuations:\n$$\np'(t) = A\\cos(\\omega_0 t)\n$$\n$$\nu'(t) = \\frac{p'(t)}{\\rho_0 c_0} = \\frac{A}{\\rho_0 c_0}\\cos(\\omega_0 t)\n$$\n$$\n\\dot{q}'(t) = \\frac{K\\,u'(t)}{1+\\left(u'(t)/u_s\\right)^2} = \\frac{K \\left(\\frac{A}{\\rho_0 c_0}\\cos(\\omega_0 t)\\right)}{1+\\left(\\frac{A}{\\rho_0 c_0 u_s}\\cos(\\omega_0 t)\\right)^2}\n$$\nThe product $p'(t)\\,\\dot{q}'(t)$ is then:\n$$\np'(t)\\,\\dot{q}'(t) = A\\cos(\\omega_0 t) \\cdot \\frac{K \\frac{A}{\\rho_0 c_0}\\cos(\\omega_0 t)}{1+\\left(\\frac{A}{\\rho_0 c_0 u_s}\\cos(\\omega_0 t)\\right)^2} = \\frac{KA^2}{\\rho_0 c_0} \\frac{\\cos^2(\\omega_0 t)}{1+\\left(\\frac{A}{\\rho_0 c_0 u_s}\\right)^2\\cos^2(\\omega_0 t)}\n$$\nLet's define a non-dimensional amplitude $\\mathcal{A} = \\frac{A}{\\rho_0 c_0 u_s}$. The expression becomes:\n$$\np'(t)\\,\\dot{q}'(t) = \\frac{KA^2}{\\rho_0 c_0} \\frac{\\cos^2(\\omega_0 t)}{1+\\mathcal{A}^2\\cos^2(\\omega_0 t)}\n$$\nTo find $W(A)$, we average this expression over one period. Let $\\theta = \\omega_0t$.\n$$\nW(A) = \\frac{KA^2}{\\rho_0 c_0} \\left\\langle \\frac{\\cos^2(\\theta)}{1+\\mathcal{A}^2\\cos^2(\\theta)} \\right\\rangle = \\frac{KA^2}{\\rho_0 c_0} \\frac{1}{2\\pi}\\int_0^{2\\pi} \\frac{\\cos^2(\\theta)}{1+\\mathcal{A}^2\\cos^2(\\theta)} \\, d\\theta\n$$\nWe can rewrite the integrand as:\n$$\n\\frac{\\cos^2(\\theta)}{1+\\mathcal{A}^2\\cos^2(\\theta)} = \\frac{1}{\\mathcal{A}^2} \\frac{1+\\mathcal{A}^2\\cos^2(\\theta) - 1}{1+\\mathcal{A}^2\\cos^2(\\theta)} = \\frac{1}{\\mathcal{A}^2} \\left(1 - \\frac{1}{1+\\mathcal{A}^2\\cos^2(\\theta)}\\right)\n$$\nThe integral of the first term is $\\int_0^{2\\pi} 1 \\, d\\theta = 2\\pi$. For the second term, we use the standard integral result:\n$$\n\\int_0^{2\\pi} \\frac{d\\theta}{a+b\\cos^2(\\theta)} = \\frac{2\\pi}{ \\sqrt{a(a+b)}}\n$$\nIn our case, $a=1$ and $b=\\mathcal{A}^2$, so:\n$$\n\\int_0^{2\\pi} \\frac{d\\theta}{1+\\mathcal{A}^2\\cos^2(\\theta)} = \\frac{2\\pi}{\\sqrt{1(1+\\mathcal{A}^2)}} = \\frac{2\\pi}{\\sqrt{1+\\mathcal{A}^2}}\n$$\nSubstituting these results back into the average calculation:\n$$\n\\frac{1}{2\\pi}\\int_0^{2\\pi} \\frac{\\cos^2(\\theta)}{1+\\mathcal{A}^2\\cos^2(\\theta)} \\, d\\theta = \\frac{1}{\\mathcal{A}^2} \\left[ \\frac{1}{2\\pi}\\int_0^{2\\pi} 1 \\, d\\theta - \\frac{1}{2\\pi}\\int_0^{2\\pi} \\frac{d\\theta}{1+\\mathcal{A}^2\\cos^2(\\theta)} \\right] = \\frac{1}{\\mathcal{A}^2} \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right)\n$$\nSo, the Rayleigh work is:\n$$\nW(A) = \\frac{KA^2}{\\rho_0 c_0} \\frac{1}{\\mathcal{A}^2} \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right)\n$$\nSubstituting $\\mathcal{A}^2 = \\frac{A^2}{(\\rho_0 c_0 u_s)^2}$:\n$$\nW(A) = \\frac{KA^2}{\\rho_0 c_0} \\frac{(\\rho_0 c_0 u_s)^2}{A^2} \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right) = K \\rho_0 c_0 u_s^2 \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right)\n$$\nNext, we evaluate the dissipation term:\n$$\n2\\zeta E(A) = 2\\zeta \\left( \\frac{A^2}{2\\rho_0 c_0^2} \\right) = \\frac{\\zeta A^2}{\\rho_0 c_0^2}\n$$\nNow we equate the work and dissipation terms and substitute $A = \\mathcal{A} \\rho_0 c_0 u_s$:\n$$\nK \\rho_0 c_0 u_s^2 \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right) = \\frac{\\zeta (\\mathcal{A} \\rho_0 c_0 u_s)^2}{\\rho_0 c_0^2} = \\frac{\\zeta \\mathcal{A}^2 \\rho_0^2 c_0^2 u_s^2}{\\rho_0 c_0^2} = \\zeta \\mathcal{A}^2 \\rho_0 u_s^2\n$$\nDividing both sides by $\\rho_0 u_s^2$ (which are non-zero):\n$$\nK c_0 \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right) = \\zeta \\mathcal{A}^2\n$$\nWe are given the parameter group $G = Kc_0/\\zeta = 3.00$. Substituting this gives the nonlinear amplitude condition:\n$$\nG \\zeta \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right) = \\zeta \\mathcal{A}^2 \\implies G \\left( 1 - \\frac{1}{\\sqrt{1+\\mathcal{A}^2}} \\right) = \\mathcal{A}^2\n$$\nThis is the equation to solve for $\\mathcal{A}$. Let $x = \\mathcal{A}^2$.\n$$\nG\\left(1 - \\frac{1}{\\sqrt{1+x}}\\right) = x \\implies G - x = \\frac{G}{\\sqrt{1+x}}\n$$\nSquaring both sides (which requires $G-x > 0$ for a valid solution):\n$$\n(G-x)^2 = \\frac{G^2}{1+x} \\implies (G-x)^2(1+x)=G^2\n$$\n$$\n(G^2-2Gx+x^2)(1+x)=G^2\n$$\n$$\nG^2 - 2Gx + x^2 + G^2x - 2Gx^2 + x^3 = G^2\n$$\n$$\nx^3 + (1-2G)x^2 + (G^2-2G)x = 0\n$$\nThis equation has a trivial solution $x=0$ (or $\\mathcal{A}=0$), which corresponds to the stable zero-amplitude state. The non-trivial limit-cycle solutions are given by the roots of the quadratic factor:\n$$\nx^2 + (1-2G)x + (G^2-2G) = 0\n$$\nUsing the quadratic formula for $x = \\mathcal{A}^2$:\n$$\nx = \\frac{-(1-2G) \\pm \\sqrt{(1-2G)^2 - 4(1)(G^2-2G)}}{2} = \\frac{2G-1 \\pm \\sqrt{1-4G+4G^2 - 4G^2+8G}}{2}\n$$\n$$\nx = \\frac{2G-1 \\pm \\sqrt{1+4G}}{2}\n$$\nWe must check which root satisfies the condition $G-x > 0$.\nFor the root with the plus sign, $x_1 = \\frac{2G-1 + \\sqrt{1+4G}}{2}$:\n$G - x_1 = G - \\frac{2G-1 + \\sqrt{1+4G}}{2} = \\frac{2G - (2G-1 + \\sqrt{1+4G})}{2} = \\frac{1-\\sqrt{1+4G}}{2}$.\nFor $G = 3$, this is $\\frac{1-\\sqrt{13}}{2}  0$. So this root is extraneous, introduced by squaring.\nFor the root with the minus sign, $x_2 = \\frac{2G-1 - \\sqrt{1+4G}}{2}$:\n$G - x_2 = G - \\frac{2G-1 - \\sqrt{1+4G}}{2} = \\frac{2G - (2G-1 - \\sqrt{1+4G})}{2} = \\frac{1+\\sqrt{1+4G}}{2}$.\nFor $G = 3$, this is $\\frac{1+\\sqrt{13}}{2} > 0$. This root is physically valid.\nThus, the squared non-dimensional amplitude is:\n$$\n\\mathcal{A}^2 = \\frac{2G-1 - \\sqrt{1+4G}}{2}\n$$\nWe are also required to find a positive amplitude, so $\\mathcal{A}^2$ must be positive. This occurs when $2G-1 > \\sqrt{1+4G}$, which implies $(2G-1)^2 > 1+4G$, leading to $4G^2 - 8G > 0$, or $G > 2$. Since $G=3.00$, this condition is satisfied.\n\nNow we substitute $G=3.00$ to find $\\mathcal{A}^2$:\n$$\n\\mathcal{A}^2 = \\frac{2(3)-1 - \\sqrt{1+4(3)}}{2} = \\frac{5 - \\sqrt{13}}{2}\n$$\nThe non-dimensional amplitude is $\\mathcal{A} = \\sqrt{\\frac{5 - \\sqrt{13}}{2}}$.\nThe final pressure amplitude $A$ is given by $A = \\mathcal{A} \\rho_0 c_0 u_s$.\n$$\nA = \\left(\\sqrt{\\frac{5 - \\sqrt{13}}{2}}\\right) \\rho_0 c_0 u_s\n$$\nSubstituting the given numerical values:\n- $\\rho_0 = 1.20\\ \\mathrm{kg/m^3}$\n- $c_0 = 340\\ \\mathrm{m/s}$\n- $u_s = 4.00\\ \\mathrm{m/s}$\n$$\nA = \\left(\\sqrt{\\frac{5 - \\sqrt{13}}{2}}\\right) \\times (1.20) \\times (340) \\times (4.00)\n$$\n$$\nA = \\left(\\sqrt{\\frac{5 - 3.605551...}{2}}\\right) \\times 1632\n$$\n$$\nA = \\left(\\sqrt{0.697224...}\\right) \\times 1632\n$$\n$$\nA = (0.834999...) \\times 1632 = 1362.519... \\ \\mathrm{Pa}\n$$\nRounding to four significant figures, the limit-cycle pressure amplitude is $1363\\ \\mathrm{Pa}$.",
            "answer": "$$\\boxed{1363}$$"
        },
        {
            "introduction": "While analytical solutions provide fundamental insights, many practical engineering problems in thermoacoustics rely on numerical computation. This final practice bridges the gap between theory and application by guiding you through the implementation of a numerical model to calculate the thermoacoustic growth rate based on the Rayleigh criterion. By translating the integral definitions of the Rayleigh index and modal energy into code, you will gain a tangible understanding of how the interplay between the heat source's location (spatial coupling) and its timing relative to the pressure oscillations (temporal phasing) determines whether a mode is amplified or damped. ",
            "id": "4071531",
            "problem": "Consider a one-dimensional, non-dimensional acoustic field in a duct of length $L$ with acoustic pressure fluctuation $p'(x,t)$ governed by the inhomogeneous wave equation\n$$\\frac{\\partial^2 p'}{\\partial t^2} - c^2 \\frac{\\partial^2 p'}{\\partial x^2} = \\kappa \\,\\dot{q}'(x,t),$$\non the domain $x \\in [0,L]$, with homogeneous Dirichlet boundary conditions $p'(0,t) = 0$ and $p'(L,t) = 0$. Assume the sound speed $c$ is constant and non-dimensionalized as $c = 1$, and take the source coupling constant $\\kappa = 1$. The localized heat-release source is modeled as\n$$\\dot{q}'(x,t) = q_0 \\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\sin(\\omega t + \\phi),$$\nwhere $q_0$ is a non-dimensional source amplitude, $x_0$ is the source location, $\\sigma$ is the spatial width, $\\omega$ is the angular frequency, and $\\phi$ is a prescribed phase offset (angles in radians). All quantities are non-dimensional; no physical units are required.\n\nDefine a Galerkin method using the eigenfunctions of the spatial operator compatible with the boundary conditions. Let the basis functions be $\\Phi_n(x) = \\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$ for $n \\in \\mathbb{N}$, and expand the pressure fluctuation as $p'(x,t) = \\sum_{n=1}^{N} a_n(t)\\,\\Phi_n(x)$. Using orthogonality, derive the modal ordinary differential equations for $a_n(t)$ driven by the localized source.\n\nFor assessing thermoacoustic instability via the Rayleigh criterion, consider the contribution of a single free acoustic mode $n$ with pressure field\n$$p'_n(x,t) = A\\,\\Phi_n(x)\\,\\sin(\\omega_n t),$$\nwhere $A$ is an arbitrary non-dimensional amplitude and $\\omega_n = \\frac{n\\pi c}{L}$ is the mode angular frequency, with $c=1$. Define the Rayleigh index over one source period $T = \\frac{2\\pi}{\\omega}$ as\n$$\\mathcal{R}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} p'_n(x,t)\\,\\dot{q}'(x,t)\\,\\mathrm{d}x\\,\\mathrm{d}t,$$\nand define the non-dimensional modal energy measure\n$$\\mathcal{E}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} p'_n(x,t)^2\\,\\mathrm{d}x\\,\\mathrm{d}t.$$\nYou must compute a non-dimensional growth rate for mode $n$ as\n$$\\gamma_n = \\frac{\\mathcal{R}_n}{\\mathcal{E}_n},$$\nwhich serves here as a normalized indicator of modal amplification or decay. According to the Rayleigh criterion, a positive value of $\\gamma_n$ indicates net amplification over the cycle, a negative value indicates net damping, and zero indicates marginal behavior.\n\nYour task is to implement:\n- The Galerkin projection coefficient for mode $n$ that quantifies spatial coupling of the localized source to the mode, defined as $G_n = \\int_{0}^{L}\\Phi_n(x)\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\mathrm{d}x$.\n- The Rayleigh index $\\mathcal{R}_n$ and energy $\\mathcal{E}_n$ via direct numerical quadrature over $x$ and $t$ for the specified $p'_n$ and $\\dot{q}'$.\n- The normalized growth rate $\\gamma_n = \\mathcal{R}_n/\\mathcal{E}_n$.\n\nAngles must be treated in radians. All quantities are non-dimensional. Your numerical integrations must be accurate enough to resolve the oscillations; use sufficiently fine grids in $x$ and $t$.\n\nTest Suite:\nCompute $\\gamma_n$ for the following parameter sets. In all cases, take $c = 1$, $A = 1$, $q_0 = 1$, and the Rayleigh index and energy are evaluated over one source period $T = \\frac{2\\pi}{\\omega}$.\n\n- Case $1$ (general positive coupling): $(L, n, x_0, \\sigma, \\phi) = (1, 1, 0.3, 0.05, 0)$ with $\\omega = \\omega_n = \\frac{n\\pi}{L}$.\n- Case $2$ (temporal phase near marginal): $(L, n, x_0, \\sigma, \\phi) = (1, 1, 0.3, 0.05, \\frac{\\pi}{2})$ with $\\omega = \\omega_n$.\n- Case $3$ (temporal anti-phase, negative coupling): $(L, n, x_0, \\sigma, \\phi) = (1, 1, 0.3, 0.05, \\pi)$ with $\\omega = \\omega_n$.\n- Case $4$ (spatial near-node coupling, nearly zero): $(L, n, x_0, \\sigma, \\phi) = (1, 2, 0.5, 0.02, 0)$ with $\\omega = \\omega_n$.\n- Case $5$ (off-node, small phase lead): $(L, n, x_0, \\sigma, \\phi) = (1, 3, 0.9, 0.03, 0.3)$ with $\\omega = \\omega_n$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4,result_5]$), where each $result_i$ is the computed floating-point value of $\\gamma_n$ for the corresponding case in the test suite.",
            "solution": "The problem is subjected to validation against the specified criteria.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $\\frac{\\partial^2 p'}{\\partial t^2} - c^2 \\frac{\\partial^2 p'}{\\partial x^2} = \\kappa \\,\\dot{q}'(x,t)$\n- **Domain**: $x \\in [0,L]$\n- **Boundary Conditions**: $p'(0,t) = 0$ and $p'(L,t) = 0$\n- **Constants**: $c = 1$, $\\kappa = 1$\n- **Source Term**: $\\dot{q}'(x,t) = q_0 \\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\sin(\\omega t + \\phi)$\n- **Pressure Field Expansion (Galerkin Method)**: $p'(x,t) = \\sum_{n=1}^{N} a_n(t)\\,\\Phi_n(x)$\n- **Basis Functions**: $\\Phi_n(x) = \\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$ for $n \\in \\mathbb{N}$\n- **Single Mode Pressure Field for Analysis**: $p'_n(x,t) = A\\,\\Phi_n(x)\\,\\sin(\\omega_n t)$\n- **Mode Natural Angular Frequency**: $\\omega_n = \\frac{n\\pi c}{L}$\n- **Rayleigh Index Definition**: $\\mathcal{R}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} p'_n(x,t)\\,\\dot{q}'(x,t)\\,\\mathrm{d}x\\,\\mathrm{d}t$\n- **Source Period**: $T = \\frac{2\\pi}{\\omega}$\n- **Modal Energy Definition**: $\\mathcal{E}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} p'_n(x,t)^2\\,\\mathrm{d}x\\,\\mathrm{d}t$\n- **Normalized Growth Rate Definition**: $\\gamma_n = \\frac{\\mathcal{R}_n}{\\mathcal{E}_n}$\n- **Galerkin Projection Coefficient Definition**: $G_n = \\int_{0}^{L}\\Phi_n(x)\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\mathrm{d}x$\n- **Global Test Parameters**: $c = 1$, $A = 1$, $q_0 = 1$, and $\\omega = \\omega_n$ for all cases.\n- **Test Cases**:\n    1. $(L, n, x_0, \\sigma, \\phi) = (1, 1, 0.3, 0.05, 0)$\n    2. $(L, n, x_0, \\sigma, \\phi) = (1, 1, 0.3, 0.05, \\frac{\\pi}{2})$\n    3. $(L, n, x_0, \\sigma, \\phi) = (1, 1, 0.3, 0.05, \\pi)$\n    4. $(L, n, x_0, \\sigma, \\phi) = (1, 2, 0.5, 0.02, 0)$\n    5. $(L, n, x_0, \\sigma, \\phi) = (1, 3, 0.9, 0.03, 0.3)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is based on the well-established linear theory of thermoacoustic instability. The governing equation is the standard inhomogeneous wave equation. The Rayleigh criterion is a fundamental principle in the field. The use of a Galerkin method with sinusoidal basis functions is a standard analytical and computational technique for this class of problem. No scientific flaws are present.\n- **Well-Posed**: The problem is mathematically well-posed. The governing equation, domain, boundary conditions, and source term are all clearly defined. The quantities to be computed ($\\mathcal{R}_n$, $\\mathcal{E}_n$, $\\gamma_n$) are specified by unambiguous integral expressions. Essential data for each test case are provided.\n- **Objective**: All definitions and parameters are expressed in precise, objective mathematical language.\n- **Completeness and Consistency**: The problem is self-contained and internally consistent. All required parameters are provided for each calculation. The definitions do not conflict with one another.\n- **Realism**: The problem uses non-dimensional quantities, which is a standard practice in theoretical fluid mechanics and acoustics to generalize the results. The setup models a physically plausible scenario.\n- **Structure and Triviality**: The problem is well-structured and non-trivial, requiring the application of numerical quadrature to solve double integrals, which is a standard task in computational physics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\nThe objective is to compute the normalized growth rate $\\gamma_n = \\frac{\\mathcal{R}_n}{\\mathcal{E}_n}$ for a given acoustic mode $n$. The quantities $\\mathcal{R}_n$ and $\\mathcal{E}_n$ are defined as double integrals over space $x$ and time $t$. The problem requires a direct numerical evaluation of these integrals.\n\nThe Rayleigh index $\\mathcal{R}_n$ is defined as:\n$$ \\mathcal{R}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} p'_n(x,t)\\,\\dot{q}'(x,t)\\,\\mathrm{d}x\\,\\mathrm{d}t $$\nSubstituting the expressions for the modal pressure $p'_n(x,t)=A\\,\\sin(\\frac{n\\pi x}{L})\\,\\sin(\\omega_n t)$ and the heat release rate $\\dot{q}'(x,t) = q_0 \\,\\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\sin(\\omega t + \\phi)$:\n$$ \\mathcal{R}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} \\left[ A\\,\\sin(\\tfrac{n\\pi x}{L})\\,\\sin(\\omega_n t) \\right] \\left[ q_0 \\exp\\left(-\\tfrac{(x-x_0)^2}{2\\sigma^2}\\right)\\sin(\\omega t + \\phi) \\right] \\mathrm{d}x\\,\\mathrm{d}t $$\nThe modal energy measure $\\mathcal{E}_n$ is defined as:\n$$ \\mathcal{E}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} p'_n(x,t)^2\\,\\mathrm{d}x\\,\\mathrm{d}t $$\nSubstituting the expression for $p'_n(x,t)$:\n$$ \\mathcal{E}_n = \\frac{1}{T}\\int_{0}^{T}\\int_{0}^{L} \\left[ A\\,\\sin(\\tfrac{n\\pi x}{L})\\,\\sin(\\omega_n t) \\right]^2 \\mathrm{d}x\\,\\mathrm{d}t $$\nThe problem states that these double integrals should be computed via direct numerical quadrature. We will implement functions for the integrands and use the `scipy.integrate.dblquad` routine to perform the integrations over the domain $x \\in [0,L]$ and $t \\in [0,T]$, where $T=\\frac{2\\pi}{\\omega}$.\n\nFor context and verification, it is instructive to simplify these integrals analytically. The integrands are separable in space and time. For the specified condition $\\omega = \\omega_n$, the temporal integral in $\\mathcal{R}_n$ evaluates to $\\int_{0}^{T} \\sin(\\omega_n t) \\sin(\\omega_n t + \\phi) \\mathrm{d}t = \\frac{T}{2}\\cos(\\phi)$. The spatial integral is the Galerkin coefficient $G_n$. Thus, $\\mathcal{R}_n = \\frac{A\\,q_0\\,G_n}{2}\\cos(\\phi)$. The temporal integral in $\\mathcal{E}_n$ evaluates to $\\int_{0}^{T} \\sin^2(\\omega_n t) \\mathrm{d}t = \\frac{T}{2}$. The spatial integral in $\\mathcal{E}_n$ evaluates to $\\int_{0}^{L} \\sin^2(\\frac{n\\pi x}{L}) \\mathrm{d}x = \\frac{L}{2}$. Thus, $\\mathcal{E}_n = \\frac{A^2 L}{4}$.\nCombining these gives an analytical expression for the growth rate:\n$$ \\gamma_n = \\frac{\\mathcal{R}_n}{\\mathcal{E}_n} = \\frac{\\frac{A\\,q_0\\,G_n}{2}\\cos(\\phi)}{\\frac{A^2 L}{4}} = \\frac{2\\,q_0\\,G_n}{A\\,L}\\cos(\\phi) $$\nThis analytical result provides physical insight: the growth rate is proportional to the source amplitude $q_0$, the spatial coupling $G_n$, and the temporal phase alignment $\\cos(\\phi)$. It is inversely proportional to the pressure amplitude $A$ and duct length $L$. While this formula is useful for verification, the implementation will strictly adhere to the instruction of performing the full double numerical integration.\n\nThe computational procedure for each test case is as follows:\n1. Define the parameters $L, n, x_0, \\sigma, \\phi$ from the test case, and the global constants $c=1, A=1, q_0=1$.\n2. Calculate the dependent parameters: modal frequency $\\omega_n = \\frac{n\\pi c}{L}$, source frequency $\\omega=\\omega_n$, and source period $T = \\frac{2\\pi}{\\omega}$.\n3. Define the integrand for the Rayleigh index, $f_R(x,t) = p'_n(x,t)\\,\\dot{q}'(x,t)$.\n4. Define the integrand for the modal energy, $f_E(x,t) = p'_n(x,t)^2$.\n5. Use `scipy.integrate.dblquad` to compute the integrals $I_R = \\int_{0}^{T}\\int_{0}^{L} f_R(x,t)\\,\\mathrm{d}x\\,\\mathrm{d}t$ and $I_E = \\int_{0}^{T}\\int_{0}^{L} f_E(x,t)\\,\\mathrm{d}x\\,\\mathrm{d}t$.\n6. Compute $\\mathcal{R}_n = I_R / T$ and $\\mathcal{E}_n = I_E / T$.\n7. Compute the final growth rate $\\gamma_n = \\mathcal{R}_n / \\mathcal{E}_n$. If $\\mathcal{E}_n$ is zero or numerically close to zero, $\\gamma_n$ can be undefined or very large, but the conditions of the problem ($A0$, $L0$) ensure $\\mathcal{E}_n  0$.\nThe results for all test cases are collected and formatted as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import dblquad\n\ndef solve():\n    \"\"\"\n    Computes the normalized thermoacoustic growth rate for a series of test cases\n    by numerically integrating the Rayleigh index and modal energy.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (L, n, x_0, sigma, phi)\n    test_cases = [\n        (1.0, 1, 0.3, 0.05, 0.0),\n        (1.0, 1, 0.3, 0.05, np.pi / 2.0),\n        (1.0, 1, 0.3, 0.05, np.pi),\n        (1.0, 2, 0.5, 0.02, 0.0),\n        (1.0, 3, 0.9, 0.03, 0.3),\n    ]\n\n    results = []\n    \n    # Global parameters as per the problem statement\n    c = 1.0\n    A = 1.0\n    q0 = 1.0\n\n    for case in test_cases:\n        L, n, x0, sigma, phi = case\n        \n        # Calculate derived parameters\n        omega_n = n * np.pi * c / L\n        omega = omega_n  # Source frequency is at resonance\n        T = 2.0 * np.pi / omega\n        \n        # --- Define integrands for dblquad ---\n        # Note: Scipy's dblquad integrates func(y, x), where y is the inner variable.\n        # We want to compute integral dt * integral dx f(x, t).\n        # So our outer variable is t, inner is x. The function signature must be f(x, t).\n\n        def p_prime(x, t):\n            \"\"\"Acoustic pressure fluctuation for mode n.\"\"\"\n            return A * np.sin(n * np.pi * x / L) * np.sin(omega_n * t)\n        \n        def q_dot_prime(x, t):\n            \"\"\"Heat release rate fluctuation.\"\"\"\n            spatial_part = np.exp(-(x - x0)**2 / (2.0 * sigma**2))\n            temporal_part = np.sin(omega * t + phi)\n            return q0 * spatial_part * temporal_part\n\n        def integrand_R(x, t):\n            \"\"\"Integrand for the Rayleigh Index numerator.\"\"\"\n            return p_prime(x, t) * q_dot_prime(x, t)\n\n        def integrand_E(x, t):\n            \"\"\"Integrand for the modal energy numerator.\"\"\"\n            return p_prime(x, t)**2\n\n        # --- Perform numerical integration ---\n        \n        # Integrate over x from 0 to L (inner integral) and t from 0 to T (outer integral)\n        integral_R, _ = dblquad(integrand_R, 0, T, 0, L)\n        integral_E, _ = dblquad(integrand_E, 0, T, 0, L)\n\n        # Calculate Rayleigh Index and Modal Energy\n        rayleigh_index_R_n = integral_R / T\n        modal_energy_E_n = integral_E / T\n        \n        # Calculate the normalized growth rate\n        # Avoid division by zero, although E_n should be positive for A0, L0.\n        if abs(modal_energy_E_n)  1e-12:\n            gamma_n = 0.0\n        else:\n            gamma_n = rayleigh_index_R_n / modal_energy_E_n\n        \n        results.append(gamma_n)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}