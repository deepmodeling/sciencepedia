{
    "hands_on_practices": [
        {
            "introduction": "要理解整个烟尘颗粒群的演变，首先需要对两个独立颗粒的碰撞过程进行建模。本练习旨在推导在连续区中的基本布朗凝聚核$K_{ij}$，这在高压燃烧环境中是一种常见情景。通过此练习，您将巩固对扩散限制过程的理解，并接触到灵敏度分析，这是评估模型不确定性的一项关键技能。",
            "id": "4064690",
            "problem": "在克努森数很小的高压、富含烟尘的燃烧环境中，考虑标记为 $i$ 和 $j$ 的两个烟尘颗粒群之间的布朗凝聚。这些颗粒的特征在于它们的迁移率直径 $d_{m,i}$ 和 $d_{m,j}$，以及在载气中独立测量的平动扩散系数 $D_i$ 和 $D_j$。假设适用连续介质扩散极限，并且布朗凝聚完全受扩散限制，碰撞在相遇时发生。\n\n从扩散通量守恒和基于动力学理论与菲克输运的向吸收性球形汇的稳态扩散出发，在两个半径与其迁移率直径一致的球体之间的相对坐标系中，为成对捕获过程建模。推导布朗凝聚核 $K_{ij}$ 作为 $D_i$、$D_j$、$d_{m,i}$ 和 $d_{m,j}$ 的函数表达式。然后，假设 $D_i$ 和 $D_j$ 通过独立测量精确已知，唯一不确定的输入是具有独立微小相对不确定度的迁移率直径，定义并推导 $K_{ij}$ 对 $d_{m,i}$ 的一阶相对灵敏度，\n$$\nS_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}.\n$$\n\n使用以下测量属性，这些属性代表了在升高的压力下气体中的烟尘聚集体：\n- $d_{m,i} = 80\\,\\mathrm{nm}$，\n- $d_{m,j} = 120\\,\\mathrm{nm}$，\n- $D_i = 4.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$，\n- $D_j = 3.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$。\n\n在这些值下，计算核 $K_{ij}$ 和灵敏度系数 $S_i$。仅报告 $S_i$ 的数值作为最终答案。将报告的 $S_i$ 四舍五入到四位有效数字。如果你计算了 $K_{ij}$，请以 $\\mathrm{m^3\\,s^{-1}}$ 为单位表示。将 $S_i$ 视为无量纲数。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 两个烟尘颗粒群，标记为 $i$ 和 $j$。\n- 克努森数很小，适用连续介质扩散极限。\n- 布朗凝聚受扩散限制。\n- 迁移率直径：$d_{m,i}$ 和 $d_{m,j}$。\n- 平动扩散系数：$D_i$ 和 $D_j$。\n- 碰撞在相遇时发生（吸收性球体）。\n- 任务1：推导布朗凝聚核 $K_{ij}$ 作为 $D_i$、$D_j$、$d_{m,i}$ 和 $d_{m,j}$ 的函数。\n- 任务2：定义并推导 $K_{ij}$ 对 $d_{m,i}$ 的一阶相对灵敏度：$S_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}$。\n- 测量属性：\n  - $d_{m,i} = 80\\,\\mathrm{nm}$\n  - $d_{m,j} = 120\\,\\mathrm{nm}$\n  - $D_i = 4.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$\n  - $D_j = 3.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$\n- 任务3：数值计算 $S_i$ 并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。它使用标准术语和物理原理描述了气溶胶科学中的一个经典问题（连续介质区中的 Smoluchowski 凝聚）。提供了所有必要的信息，数据在物理上是一致的（较小的颗粒具有较高的扩散系数），并且目标明确。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整的解答。\n\n**布朗凝聚核 $K_{ij}$ 的推导**\n\n两个颗粒之间的布朗凝聚过程可以通过将一个颗粒（例如 $j$ 型）视为静止，而另一个颗粒（$i$ 型）向其扩散来进行建模。相对运动由相对扩散系数决定，该系数是各个扩散系数之和：\n$$\nD_{ij} = D_i + D_j\n$$\n该问题等效于一个扩散系数为 $D_{ij}$ 的点状颗粒向一个静止的吸收球体扩散。这个球体的半径，称为碰撞半径 $R_{ij}$，是两个碰撞颗粒的半径之和。颗粒半径是其迁移率直径的一半：$r_i = d_{m,i}/2$ 和 $r_j = d_{m,j}/2$。\n$$\nR_{ij} = r_i + r_j = \\frac{d_{m,i} + d_{m,j}}{2}\n$$\n距离静止吸收球体中心 $r$ 处的扩散颗粒浓度 $n(r)$ 由球坐标系中的稳态扩散方程描述。假设球对称，这就是关于 $n(r)$ 的拉普拉斯方程：\n$$\n\\nabla^2 n(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dn}{dr} \\right) = 0\n$$\n边界条件由问题的物理性质设定：\n1.  球体是一个理想汇，因此其表面的浓度为零：$n(r=R_{ij}) = 0$。\n2.  远离球体处，浓度是 $i$ 型颗粒未受扰动的体浓度，我们记为 $n_i$：$n(r \\to \\infty) = n_i$。\n\n对该微分方程积分两次，得到通解：\n$$\nn(r) = -\\frac{C_1}{r} + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是积分常数。应用边界条件：\n- 根据 $n(\\infty) = n_i$，我们得到 $C_2 = n_i$。\n- 根据 $n(R_{ij}) = 0$，我们有 $0 = -C_1/R_{ij} + n_i$，这给出 $C_1 = n_i R_{ij}$。\n因此，吸收球体周围的浓度分布为：\n$$\nn(r) = n_i \\left( 1 - \\frac{R_{ij}}{r} \\right)\n$$\n碰撞率通过计算进入球体表面的总扩散通量来求得。扩散通量矢量由 Fick 第一定律给出，$\\mathbf{J} = -D_{ij} \\nabla n$。在表面 $r=R_{ij}$ 处的通量大小为：\n$$\nJ = -D_{ij} \\left. \\frac{dn}{dr} \\right|_{r=R_{ij}}\n$$\n浓度梯度为 $\\frac{dn}{dr} = n_i \\frac{R_{ij}}{r^2}$。在表面上，这等于 $\\left. \\frac{dn}{dr} \\right|_{r=R_{ij}} = \\frac{n_i}{R_{ij}}$。\n因此，表面的通量为 $J = D_{ij} \\frac{n_i}{R_{ij}}$。与单个静止颗粒 $j$ 碰撞的颗粒总速率是该通量乘以吸收球体的表面积 $A = 4\\pi R_{ij}^2$：\n$$\n\\text{每个颗粒 } j \\text{ 的碰撞率} = J \\cdot A = \\left(D_{ij} \\frac{n_i}{R_{ij}}\\right) (4\\pi R_{ij}^2) = 4\\pi D_{ij} R_{ij} n_i\n$$\n双分子凝聚速率方程定义为 $dN_{ij}/dt = K_{ij} n_i n_j$，其中 $K_{ij}$ 是凝聚核，$N_{ij}$ 是碰撞事件的数浓度。单位体积的总碰撞率是每个颗粒 $j$ 的碰撞率乘以颗粒 $j$ 的浓度 $n_j$。\n$$\n\\frac{dN_{ij}}{dt} = (4\\pi D_{ij} R_{ij} n_i) n_j\n$$\n通过将其与定义进行比较，我们确定凝聚核 $K_{ij}$ 为：\n$$\nK_{ij} = 4\\pi D_{ij} R_{ij}\n$$\n将 $D_{ij}$ 和 $R_{ij}$ 的表达式用给定变量代入：\n$$\nK_{ij} = 4\\pi (D_i + D_j) \\left( \\frac{d_{m,i} + d_{m,j}}{2} \\right)\n$$\n$$\nK_{ij} = 2\\pi (D_i + D_j)(d_{m,i} + d_{m,j})\n$$\n这就是所求的连续介质区布朗凝聚核的表达式。\n\n**灵敏度系数 $S_i$ 的推导**\n\n灵敏度系数 $S_i$ 定义为：\n$$\nS_i \\equiv \\left.\\frac{\\partial \\ln K_{ij}}{\\partial \\ln d_{m,i}}\\right|_{D_i,D_j\\ \\mathrm{fixed}}\n$$\n使用对数导数的链式法则，这可以写成：\n$$\nS_i = \\frac{d_{m,i}}{K_{ij}} \\left( \\frac{\\partial K_{ij}}{\\partial d_{m,i}} \\right)\n$$\n如问题陈述所指定，计算偏导数时保持 $D_i$ 和 $D_j$ 不变。\n让我们计算 $K_{ij}$ 对 $d_{m,i}$ 的偏导数：\n$$\n\\frac{\\partial K_{ij}}{\\partial d_{m,i}} = \\frac{\\partial}{\\partial d_{m,i}} \\left[ 2\\pi (D_i + D_j)(d_{m,i} + d_{m,j}) \\right]\n$$\n由于在此微分中 $D_i$、$D_j$ 和 $d_{m,j}$ 被视为常数，项 $2\\pi(D_i+D_j)$ 是一个常数因子。\n$$\n\\frac{\\partial K_{ij}}{\\partial d_{m,i}} = 2\\pi (D_i + D_j) \\frac{\\partial}{\\partial d_{m,i}}(d_{m,i} + d_{m,j}) = 2\\pi (D_i + D_j) (1) = 2\\pi (D_i + D_j)\n$$\n现在，将此结果和 $K_{ij}$ 的表达式代回 $S_i$ 的公式中：\n$$\nS_i = \\frac{d_{m,i}}{2\\pi (D_i + D_j)(d_{m,i} + d_{m,j})} \\left[ 2\\pi (D_i + D_j) \\right]\n$$\n项 $2\\pi (D_i + D_j)$ 从分子和分母中约去，得到灵敏度系数的简化表达式：\n$$\nS_i = \\frac{d_{m,i}}{d_{m,i} + d_{m,j}}\n$$\n\n**$S_i$ 的数值计算**\n\n问题提供了以下数值：\n- $d_{m,i} = 80\\,\\mathrm{nm}$\n- $d_{m,j} = 120\\,\\mathrm{nm}$\n\n将这些值代入推导出的 $S_i$ 表达式中：\n$$\nS_i = \\frac{80\\,\\mathrm{nm}}{80\\,\\mathrm{nm} + 120\\,\\mathrm{nm}} = \\frac{80}{200}\n$$\n纳米单位相消，如预期留下一个无量纲的量。\n$$\nS_i = \\frac{8}{20} = \\frac{2}{5} = 0.4\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nS_i = 0.4000\n$$\n问题还要求计算 $K_{ij}$。这是一个中间步骤。\n$K_{ij} = 2\\pi (4.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}} + 3.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}})(80 \\times 10^{-9}\\,\\mathrm{m} + 120 \\times 10^{-9}\\,\\mathrm{m})$\n$K_{ij} = 2\\pi (7.0\\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}})(200 \\times 10^{-9}\\,\\mathrm{m})$\n$K_{ij} = 2\\pi (1400 \\times 10^{-18}\\,\\mathrm{m^3\\,s^{-1}}) = 2800\\pi \\times 10^{-18}\\,\\mathrm{m^3\\,s^{-1}} \\approx 8.796 \\times 10^{-15}\\,\\mathrm{m^3\\,s^{-1}}$。\n最终答案仅为 $S_i$ 的值。",
            "answer": "$$\n\\boxed{0.4000}\n$$"
        },
        {
            "introduction": "在上一个练习的基础上，我们需要认识到其模型的局限性。在许多火焰环境中，颗粒尺寸与气体分子的平均自由程相当，这使得连续区假设不再成立，此时克努森数 $Kn_{d} \\sim O(1)$。本练习将介绍过渡区和Cunningham滑移修正因子$C_{c}$，展示如何改进物理模型。通过计算简化模型带来的误差，您将定量地理解在何种情况下必须考虑更复杂的物理效应。",
            "id": "4064717",
            "problem": "考虑在层流乙烯-空气火焰中形成的两个相同的烟尘聚集体。每个聚集体近似为一个迁移率等效球体，其直径为 $d_{m} = 160\\,\\text{nm}$，半径为 $r = d_{m}/2$。气体温度为 $T = 1700\\,\\text{K}$，气体动力粘度为 $\\mu = 7.0 \\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$，气体的平均自由程为 $\\lambda_{g} = 80\\,\\text{nm}$。因此，基于颗粒直径的克努森数为 $Kn_{d} = 2 \\lambda_{g} / d_{m} \\sim O(1)$。假设烟尘聚集体足够紧凑，以至于迁移率等效直径适用于 Stokes-Einstein 扩散。\n\n从涨落-耗散关系和动力学理论出发，定义两个相同球体的连续区布朗碰并核，并使用 Fuchs-Sutugin (FS) 通量匹配插值法定义过渡区的碰并核。在连续区中，使用 Stokes-Einstein 扩散系数。在过渡区中，通过 Cunningham 修正因子 $C_{c}(Kn_{d})$ 将滑移修正纳入颗粒扩散系数中，其中\n$$\nC_{c}(Kn_{d}) = 1 + Kn_{d} \\left( A + B \\exp\\!\\left( -\\frac{C}{Kn_{d}} \\right) \\right),\n$$\n其中 $A = 1.257$，$B = 0.4$，$C = 1.1$。设玻尔兹曼常数为 $k_{B}$。\n\n将纯连续区碰并核定义为 $K_{c}$，将 FS 插值的过渡区碰并核定义为 $K_{t}$。计算使用纯连续区碰并核代替过渡区碰并核所引入的分数误差 $E$，\n$$\nE = \\frac{|K_{t} - K_{c}|}{K_{t}},\n$$\n结果为一个实数。将最终答案表示为无量纲小数，并四舍五入到四位有效数字。最终数值答案中不应包含任何单位。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、自洽且定义明确。\n\n### 步骤 1：提取已知条件\n- 两个相同的烟尘聚集体，近似为迁移率等效球体。\n- 球体直径：$d_{m} = 160\\,\\text{nm}$。\n- 球体半径：$r = d_{m}/2 = 80\\,\\text{nm}$。\n- 气体温度：$T = 1700\\,\\text{K}$。\n- 气体动力粘度：$\\mu = 7.0 \\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$。\n- 气体平均自由程：$\\lambda_{g} = 80\\,\\text{nm}$。\n- 克努森数定义：$Kn_{d} = 2 \\lambda_{g} / d_{m}$。\n- Cunningham 修正因子：$C_{c}(Kn_{d}) = 1 + Kn_{d} \\left( A + B \\exp\\left( -\\frac{C}{Kn_{d}} \\right) \\right)$。\n- $C_c$ 的常数：$A = 1.257$，$B = 0.4$，$C = 1.1$。\n- 玻尔兹曼常数：$k_{B}$。\n- 任务 1：定义连续区布朗碰并核 $K_c$。\n- 任务 2：定义 Fuchs-Sutugin (FS) 插值的过渡区碰并核 $K_t$。\n- 任务 3：计算分数误差 $E = \\frac{|K_{t} - K_{c}|}{K_{t}}$。\n- 任务 4：将最终答案四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题基于气溶胶物理学的标准原理，包括布朗运动、Stokes-Einstein 关系、碰并理论和过渡区修正（Cunningham 和 Fuchs-Sutugin）。所提供的物理参数对于高温燃烧环境是切合实际的。该问题提供了得出唯一解所需的所有数据、常数和方程。定义清晰，目标可量化。克努森数的计算证实了内部一致性：$Kn_d = 2 \\times (80\\,\\text{nm}) / (160\\,\\text{nm}) = 1$，这与 $Kn_{d} \\sim O(1)$ 的陈述一致。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解题推导\n\n解题过程从涨落-耗散定理开始，该定理通过 Stokes-Einstein 方程将颗粒扩散系数 $D$、热能 $k_B T$ 和摩擦因子 $f$ 联系起来：\n$$D = \\frac{k_B T}{f}$$\n\n**1. 连续区布朗碰并核 ($K_c$)**\n\n在连续区 ($Kn_d \\ll 1$) 中，半径为 $r$ 的球形颗粒的摩擦因子由斯托克斯定律给出：\n$$f_c = 6 \\pi \\mu r$$\n相应的连续区扩散系数 $D_c$ 为：\n$$D_c = \\frac{k_B T}{f_c} = \\frac{k_B T}{6 \\pi \\mu r}$$\n根据 Smoluchowski 的理论，两个碰撞颗粒 $i$ 和 $j$ 的布朗碰并核由 $K_{ij} = 4 \\pi (D_i + D_j)(r_i + r_j)$ 给出。对于两个相同的颗粒，$D_i = D_j = D_c$ 且 $r_i = r_j = r$。该核简化为：\n$$K_c = 4 \\pi (D_c + D_c)(r + r) = 16 \\pi r D_c$$\n代入 $D_c$ 的表达式：\n$$K_c = 16 \\pi r \\left( \\frac{k_B T}{6 \\pi \\mu r} \\right) = \\frac{8 k_B T}{3 \\mu}$$\n这是相同球体在连续区中的经典布朗碰并核表达式。\n\n**2. 过渡区碰并核 ($K_t$)**\n\n在过渡区 ($Kn_d \\sim 1$) 中，由于颗粒表面的气体滑移，颗粒迁移率高于斯托克斯定律的预测值。这种效应由 Cunningham 滑移修正因子 $C_c(Kn_d)$ 来量化。摩擦因子修正为：\n$$f_t = \\frac{f_c}{C_c(Kn_d)} = \\frac{6 \\pi \\mu r}{C_c(Kn_d)}$$\n因此，过渡区中的颗粒扩散系数 $D_t$ 增大：\n$$D_t = \\frac{k_B T}{f_t} = \\frac{k_B T C_c(Kn_d)}{6 \\pi \\mu r} = D_c \\cdot C_c(Kn_d)$$\n问题要求通过纳入此滑移修正后的扩散系数来定义过渡区碰并核 $K_t$。短语“使用 Fuchs-Sutugin (FS) 通量匹配插值法”被解释为为这类过渡区修正提供理论背景。基于问题陈述，最直接的实现方式是在碰并核公式中使用修正后的扩散系数 $D_t$：\n$$K_t = 16 \\pi r D_t = 16 \\pi r (D_c \\cdot C_c(Kn_d)) = \\left( \\frac{8 k_B T}{3 \\mu} \\right) C_c(Kn_d)$$\n因此，过渡区碰并核与连续区碰并核的关系为：\n$$K_t = K_c \\cdot C_c(Kn_d)$$\n\n**3. 分数误差 ($E$) 的计算**\n\n分数误差 $E$ 定义为：\n$$E = \\frac{|K_t - K_c|}{K_t}$$\n代入 $K_t = K_c \\cdot C_c(Kn_d)$：\n$$E = \\frac{|K_c \\cdot C_c(Kn_d) - K_c|}{K_c \\cdot C_c(Kn_d)} = \\frac{K_c |C_c(Kn_d) - 1|}{K_c C_c(Kn_d)}$$\n由于对于任何非负克努森数，$C_c(Kn_d) \\ge 1$，因此可以去掉绝对值符号：\n$$E = \\frac{C_c(Kn_d) - 1}{C_c(Kn_d)} = 1 - \\frac{1}{C_c(Kn_d)}$$\n这表明分数误差仅取决于 Cunningham 修正因子。\n\n首先，我们使用给定的定义和数据计算克努森数：\n$$Kn_d = \\frac{2 \\lambda_g}{d_m} = \\frac{2 \\times 80\\,\\text{nm}}{160\\,\\text{nm}} = 1$$\n接下来，我们使用给定的公式和常数 $A = 1.257$，$B = 0.4$ 和 $C = 1.1$ 计算 $Kn_d = 1$ 时的 Cunningham 修正因子 $C_c$：\n$$C_c(1) = 1 + 1 \\cdot \\left( A + B \\exp\\left(-\\frac{C}{1}\\right) \\right)$$\n$$C_c(1) = 1 + 1.257 + 0.4 \\exp(-1.1)$$\n使用值 $\\exp(-1.1) \\approx 0.332871$：\n$$C_c(1) \\approx 1 + 1.257 + 0.4 \\times 0.332871$$\n$$C_c(1) \\approx 2.257 + 0.1331484$$\n$$C_c(1) \\approx 2.3901484$$\n现在，我们可以计算分数误差 $E$：\n$$E = 1 - \\frac{1}{C_c(1)} \\approx 1 - \\frac{1}{2.3901484}$$\n$$E \\approx 1 - 0.4183833$$\n$$E \\approx 0.5816167$$\n按要求将结果四舍五入到四位有效数字：\n$$E \\approx 0.5816$$\n该结果表明，在这些过渡区条件下使用纯连续区碰并核，会导致碰并速率被低估约 $58.16 \\%$。",
            "answer": "$$\\boxed{0.5816}$$"
        },
        {
            "introduction": "现在，我们将视角从单个碰撞事件转向整个颗粒系综。描述这一演化过程的控制方程是Smoluchowski布居平衡方程。本练习将理论与计算实践联系起来，通过求解几个经典的、具有解析解的凝聚核（如常数核 $K(m,m') = K_0$ 和加和核 $K(m,m') = \\alpha (m + m')$）模型下总颗粒数密度 $N(t)$ 随时间的变化。您将获得直接的编程经验，来模拟凝聚动力学并解释不同物理情景下的结果。",
            "id": "4064732",
            "problem": "考虑一个空间均匀系统中烟尘颗粒凝聚的 Smoluchowski 总体平衡。令基于数量的质量分布为 $n(m,t)$，其中 $m$ 是颗粒质量（单位为 $\\mathrm{kg}$），$t$ 是时间（单位为 $\\mathrm{s}$）。总数密度为 $N(t) = \\int_{0}^{\\infty} n(m,t) \\, dm$，单位为 $\\mathrm{m}^{-3}$。初始分布指定为 $n(m,0) = N_0 \\, p(m)$，其中 $N_0$ 是初始总数密度，$p(m)$ 是质量的对数正态概率密度，\n$$\np(m) = \\frac{1}{m \\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(\\ln m - \\mu)^2}{2\\sigma^2}\\right),\n$$\n参数为 $\\mu$（无量纲）和 $\\sigma$（无量纲）。对数正态平均质量为 $\\mathbb{E}[m] = \\exp(\\mu + \\frac{1}{2}\\sigma^2)$，初始质量密度（一阶矩）为 $M_1(0) = \\int_0^\\infty m \\, n(m,0) \\, dm = N_0 \\, \\mathbb{E}[m]$，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n\n凝聚动力学遵循 Smoluchowski 总体平衡方程，\n$$\n\\frac{\\partial n(m,t)}{\\partial t} = \\frac{1}{2}\\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' - n(m,t) \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm',\n$$\n其中 $K(m,m')$ 是对称的凝聚核函数，单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$。总数密度随时间的变化可通过将上述方程对 $m$ 积分得到。\n\n您的任务是，使用为烟尘凝聚选择的理想化但量纲一致的核函数，为以下测试套件计算 $N(t)$，并按规定汇总输出。您必须使用指定的单位，并以科学记数法浮点数形式生成输出。程序必须使用对数正态初始分布和选定的核函数，为 $N(t)$ 实现正确的基于物理的推理：\n\n- 测试用例 1（一般常数核情况，实际量级和长时间）：核函数 $K(m,m') = K_0$，其中 $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 1.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -44.0$，$\\sigma = 0.4$，最终时间 $t = 10000\\ \\mathrm{s}$。\n- 测试用例 2（加性质量核，在实际时间内有中度衰减）：核函数 $K(m,m') = \\alpha (m + m')$，其中 $\\alpha = 100.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -40.9334$，$\\sigma = 0.6$，最终时间 $t = 1000\\ \\mathrm{s}$。\n- 测试用例 3（边界条件：常数核下的极短时间）：核函数 $K(m,m') = K_0$，其中 $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -43.0$，$\\sigma = 0.5$，最终时间 $t = 1\\ \\mathrm{s}$。\n- 测试用例 4（边缘情况：零加性核，无衰减）：核函数 $K(m,m') = \\alpha (m + m')$，其中 $\\alpha = 0.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$，$\\mu = -42.0$，$\\sigma = 0.7$，最终时间 $t = 3600\\ \\mathrm{s}$。\n\n科学真实性要求：\n- 对于除了聚集之外没有源或汇的纯凝聚过程，总质量密度 $M_1(t)$ 在时间上是守恒的，即 $M_1(t) = M_1(0)$。\n- 单位必须一致：$N(t)$ 的单位为 $\\mathrm{m}^{-3}$，$t$ 的单位为 $\\mathrm{s}$，$m$ 的单位为 $\\mathrm{kg}$，$K_0$ 的单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$\\alpha$ 的单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$。\n\n您的程序必须仅使用提供的信息和从 Smoluchowski 总体平衡方程开始的基本推导，为每个测试用例计算指定最终时间的 $N(t)$。将最终的数密度（单位为 $\\mathrm{m}^{-3}$）表示为小数点后有六位数字的科学记数法十进制浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，结果按测试用例的顺序排列。例如，“[value1,value2,value3,value4]”。\n\n预期的输出是浮点数。设计算法时，要通过正确处理质量守恒和零核行为来确保其对边界和边缘情况具有鲁棒性，避免数值不稳定性。",
            "solution": "该问题要求针对不同的凝聚核函数和初始条件，计算在指定最终时间 $t$ 的总颗粒数密度 $N(t)$。基于数量的质量分布 $n(m,t)$ 的演化由 Smoluchowski 总体平衡方程决定。通过将 Smoluchowski 方程对所有颗粒质量 $m$ 进行积分，我们可以得到关于 $N(t)$ 的常微分方程 (ODE)。\n\n总数密度定义为 $N(t) = \\int_{0}^{\\infty} n(m,t) \\, dm$。其时间导数为：\n$$\n\\frac{dN(t)}{dt} = \\int_{0}^{\\infty} \\frac{\\partial n(m,t)}{\\partial t} \\, dm\n$$\n将 $\\frac{\\partial n(m,t)}{\\partial t}$ 的 Smoluchowski 方程代入：\n$$\n\\frac{dN(t)}{dt} = \\int_{0}^{\\infty} \\left[ \\frac{1}{2}\\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' - n(m,t) \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm' \\right] dm\n$$\n第一项代表任何质量颗粒的生成速率，第二项代表损失速率。我们来分析这两项。损失项积分为：\n$$\nL = - \\int_0^\\infty n(m,t) \\left( \\int_0^\\infty K(m,m') \\, n(m',t)\\, dm' \\right) dm = - \\int_0^\\infty \\int_0^\\infty K(m, m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n生成项积分为：\n$$\nP = \\frac{1}{2} \\int_0^\\infty \\left( \\int_0^m K(m', m-m') \\, n(m',t) \\, n(m-m',t)\\, dm' \\right) dm\n$$\n通过变量替换为 $u=m'$ 和 $v=m-m'$，积分区域 $0 \\le m' \\le m  \\infty$ 变为 $u \\ge 0, v \\ge 0$。此变换的雅可比行列式为 $1$。该项变为：\n$$\nP = \\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K(u,v) \\, n(u,t) \\, n(v,t) \\, du \\, dv\n$$\n结合生成项和损失项，并注意到积分变量是哑变量，我们得到：\n$$\n\\frac{dN(t)}{dt} = \\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K(u,v) n(u,t) n(v,t) \\, du \\, dv - \\int_0^\\infty \\int_0^\\infty K(u,v) n(u,t) n(v,t) \\, du \\, dv\n$$\n$$\n\\frac{dN(t)}{dt} = -\\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K(m,m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n这个关于总数密度变化率的通用方程取决于凝聚核函数 $K(m,m')$ 的具体形式。我们分析测试用例中提供的两种核函数。\n\n**情况 A：常数核函数，$K(m,m') = K_0$**\n对于常数核函数，通用方程显著简化。\n$$\n\\frac{dN(t)}{dt} = -\\frac{1}{2} \\int_0^\\infty \\int_0^\\infty K_0 \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n$$\n\\frac{dN(t)}{dt} = -\\frac{K_0}{2} \\left[ \\int_0^\\infty n(m,t) \\, dm \\right] \\left[ \\int_0^\\infty n(m',t) \\, dm' \\right] = -\\frac{K_0}{2} N(t)^2\n$$\n这是一个可分离的常微分方程：$\\frac{dN}{N^2} = -\\frac{K_0}{2} dt$。在初始条件 $N(0)=N_0$ 下，从 $t=0$ 积分到 $t$：\n$$\n\\int_{N_0}^{N(t)} \\frac{dN}{N^2} = \\int_0^t -\\frac{K_0}{2} dt \\implies \\left[-\\frac{1}{N}\\right]_{N_0}^{N(t)} = -\\frac{K_0}{2} t\n$$\n$$\n-\\frac{1}{N(t)} + \\frac{1}{N_0} = -\\frac{K_0 t}{2} \\implies \\frac{1}{N(t)} = \\frac{1}{N_0} + \\frac{K_0 t}{2}\n$$\n总数密度的解为：\n$$\nN(t) = \\frac{1}{\\frac{1}{N_0} + \\frac{K_0 t}{2}} = \\frac{N_0}{1 + \\frac{N_0 K_0 t}{2}}\n$$\n此解仅取决于 $N_0$、$K_0$ 和 $t$。对于此核函数，不需要初始质量分布的细节，例如 $\\mu$ 和 $\\sigma$。\n\n**情况 B：加性核函数，$K(m,m') = \\alpha (m + m')$**\n对于加性核函数，通用方程变为：\n$$\n\\frac{dN(t)}{dt} = -\\frac{1}{2} \\int_0^\\infty \\int_0^\\infty \\alpha (m+m') \\, n(m,t) \\, n(m',t)\\, dm \\, dm'\n$$\n$$\n\\frac{dN(t)}{dt} = -\\frac{\\alpha}{2} \\left[ \\int_0^\\infty m \\, n(m,t) dm \\int_0^\\infty n(m',t) dm' + \\int_0^\\infty n(m,t) dm \\int_0^\\infty m' \\, n(m',t) dm' \\right]\n$$\n这些积分代表一阶矩（总质量密度）$M_1(t) = \\int_0^\\infty m \\, n(m,t) \\, dm$ 和零阶矩（总数密度）$N(t)$。\n$$\n\\frac{dN(t)}{dt} = -\\frac{\\alpha}{2} \\left[ M_1(t) N(t) + N(t) M_1(t) \\right] = -\\alpha M_1(t) N(t)\n$$\n如问题所述（并可从 PBE 验证），在纯凝聚过程中总质量是守恒的，因此 $M_1(t) = M_1(0)$。初始质量密度由 $M_1(0) = N_0 \\, \\mathbb{E}[m]$ 给出，其中初始对数正态分布的平均质量 $\\mathbb{E}[m]$ 为 $\\mathbb{E}[m] = \\exp(\\mu + \\sigma^2/2)$。\n常微分方程变为：\n$$\n\\frac{dN(t)}{dt} = -\\alpha M_1(0) N(t)\n$$\n这是一个可分离的线性常微分方程：$\\frac{dN}{N} = -\\alpha M_1(0) dt$。从 $t=0$ 积分到 $t$：\n$$\n\\int_{N_0}^{N(t)} \\frac{dN}{N} = \\int_0^t -\\alpha M_1(0) dt \\implies \\ln\\left(\\frac{N(t)}{N_0}\\right) = -\\alpha M_1(0) t\n$$\n解为：\n$$\nN(t) = N_0 \\exp(-\\alpha M_1(0) t) = N_0 \\exp(-\\alpha N_0 \\exp(\\mu + \\sigma^2/2) t)\n$$\n\n现在我们将这些推导出的公式应用于具体的测试用例。\n\n**测试用例 1：** 常数核函数，其中 $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 1.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，以及 $t = 10000\\ \\mathrm{s}$。\n$$\nN(10000) = \\frac{1.0 \\times 10^{12}}{1 + \\frac{(1.0 \\times 10^{12})(2.0 \\times 10^{-16})(10000)}{2}} = \\frac{1.0 \\times 10^{12}}{1 + \\frac{2.0 \\times 10^{0}}{2}} = \\frac{1.0 \\times 10^{12}}{1+1} = 5.0 \\times 10^{11}\\ \\mathrm{m}^{-3}\n$$\n\n**测试用例 2：** 加性核函数，其中 $\\alpha = 100.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，$\\mu = -40.9334$，$\\sigma = 0.6$，以及 $t = 1000\\ \\mathrm{s}$。\n首先，我们计算初始质量密度 $M_1(0)$：\n$$\nM_1(0) = N_0 \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right) = (5.0 \\times 10^{12}) \\exp\\left(-40.9334 + \\frac{0.6^2}{2}\\right)\n$$\n$$\nM_1(0) = (5.0 \\times 10^{12}) \\exp(-40.9334 + 0.18) = (5.0 \\times 10^{12}) \\exp(-40.7534) \\approx 5.000001 \\times 10^{-6}\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\n现在我们计算 $N(t)$：\n$$\nN(1000) = N_0 \\exp(-\\alpha M_1(0) t) = (5.0 \\times 10^{12}) \\exp(-(100.0)(5.000001 \\times 10^{-6})(1000))\n$$\n$$\nN(1000) = (5.0 \\times 10^{12}) \\exp(-0.5000001) \\approx 3.032653 \\times 10^{12}\\ \\mathrm{m}^{-3}\n$$\n\n**测试用例 3：** 常数核函数，其中 $K_0 = 2.0 \\times 10^{-16}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$，$N_0 = 5.0 \\times 10^{12}\\ \\mathrm{m}^{-3}$，以及 $t = 1\\ \\mathrm{s}$。\n$$\nN(1) = \\frac{5.0 \\times 10^{12}}{1 + \\frac{(5.0 \\times 10^{12})(2.0 \\times 10^{-16})(1)}{2}} = \\frac{5.0 \\times 10^{12}}{1 + 5.0 \\times 10^{-4}} = \\frac{5.0 \\times 10^{12}}{1.0005} \\approx 4.997501 \\times 10^{12}\\ \\mathrm{m}^{-3}\n$$\n\n**测试用例 4：** 加性核函数，其中 $\\alpha = 0.0\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}\\,\\mathrm{kg}^{-1}$，$N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$，以及 $t = 3600\\ \\mathrm{s}$。\n由于 $\\alpha=0$，核函数 $K(m,m')$ 恒为零。这意味着没有凝聚发生。\n$$\nN(t) = N_0 \\exp(-\\alpha M_1(0) t) = N_0 \\exp(0) = N_0\n$$\n因此，$N(3600) = N_0 = 1.0 \\times 10^{13}\\ \\mathrm{m}^{-3}$。数密度保持不变。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the total particle number density N(t) for soot coagulation\n    based on the Smoluchowski population balance equation for different\n    kernels and initial conditions.\n    \"\"\"\n    \n    # Test cases are provided as a list of dictionaries.\n    # 'kernel_type' is either 'constant' or 'additive'.\n    test_cases = [\n        # Test Case 1: constant-kernel\n        {'kernel_type': 'constant', 'K0': 2.0e-16, 'N0': 1.0e12, 't': 10000.0, 'mu': -44.0, 'sigma': 0.4},\n        # Test Case 2: additive-mass kernel\n        {'kernel_type': 'additive', 'alpha': 100.0, 'N0': 5.0e12, 't': 1000.0, 'mu': -40.9334, 'sigma': 0.6},\n        # Test Case 3: constant-kernel, short time\n        {'kernel_type': 'constant', 'K0': 2.0e-16, 'N0': 5.0e12, 't': 1.0, 'mu': -43.0, 'sigma': 0.5},\n        # Test Case 4: additive-mass kernel, zero alpha\n        {'kernel_type': 'additive', 'alpha': 0.0, 'N0': 1.0e13, 't': 3600.0, 'mu': -42.0, 'sigma': 0.7},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N0 = case['N0']\n        t = case['t']\n        \n        if case['kernel_type'] == 'constant':\n            # For a constant kernel K(m,m') = K0, the solution is:\n            # N(t) = N0 / (1 + (N0 * K0 * t) / 2)\n            K0 = case['K0']\n            \n            denominator = 1.0 + (N0 * K0 * t) / 2.0\n            N_t = N0 / denominator\n            \n        elif case['kernel_type'] == 'additive':\n            # For an additive kernel K(m,m') = alpha*(m+m'), the solution is:\n            # N(t) = N0 * exp(-alpha * M1_0 * t)\n            # where M1_0 is the initial mass density.\n            # M1_0 = N0 * E[m] = N0 * exp(mu + sigma^2 / 2)\n            alpha = case['alpha']\n            mu = case['mu']\n            sigma = case['sigma']\n            \n            # Handle the edge case where alpha is zero, which means no coagulation.\n            if alpha == 0.0:\n                N_t = N0\n            else:\n                # Calculate initial mass density M1(0)\n                mean_mass = np.exp(mu + (sigma**2) / 2.0)\n                M1_0 = N0 * mean_mass\n                \n                # Calculate N(t)\n                exponent = -alpha * M1_0 * t\n                N_t = N0 * np.exp(exponent)\n        \n        else:\n            # This case should not be reached with the given problem statement.\n            raise ValueError(f\"Unknown kernel type: {case['kernel_type']}\")\n\n        # Format the result to scientific notation with 6 decimal places.\n        results.append(f\"{N_t:.6e}\")\n\n    # The final output must be a single line: a comma-separated list in brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}