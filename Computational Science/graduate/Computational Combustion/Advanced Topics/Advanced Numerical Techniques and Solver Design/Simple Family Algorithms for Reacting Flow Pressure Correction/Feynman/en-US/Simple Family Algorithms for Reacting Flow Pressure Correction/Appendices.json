{
    "hands_on_practices": [
        {
            "introduction": "Understanding the convergence behavior of an iterative algorithm is fundamental to its effective use. This first practice delves into the heart of the SIMPLE algorithm's stability by using local mode analysis, a powerful theoretical tool for examining how numerical errors at different spatial frequencies are amplified or damped with each iteration. By deriving the amplification factor from first principles for a simplified model, you will gain a quantitative understanding of how parameters like under-relaxation factors, $\\alpha_u$ and $\\alpha_p$, directly control the algorithm's performance and help suppress instabilities . This exercise provides the foundational intuition needed to tune pressure-correction solvers for robust convergence.",
            "id": "4063149",
            "problem": "Consider a one-dimensional, low-Mach-number, variable-density reacting flow on a periodic domain, linearized about a steady base state such that the local mean density is frozen at a constant value $\\rho_{0} > 0$ for the purpose of the local analysis. Assume the linearized steady momentum balance can be represented by a diffusion–reaction operator driving the velocity field $u(x)$ by the pressure gradient, namely\n$$\n\\sigma\\,u(x) - \\mu\\,\\frac{d^{2}u}{dx^{2}} = -\\frac{dp}{dx},\n$$\nwhere $\\mu > 0$ is an effective viscosity and $\\sigma > 0$ collects local linear contributions from convection and reactive source linearization. Mass conservation in the low-Mach variable-density limit reduces locally to\n$$\n\\frac{d}{dx}\\left(\\rho_{0}\\,u(x)\\right) = 0.\n$$\nDiscretize on a uniform grid and perform a local mode (Fourier/von Neumann) analysis for a single mode with wavenumber $k > 0$. In Fourier space, denote the symbols of the gradient, divergence and momentum operators by\n$$\nG(k) = i\\,k,\\quad D(k) = i\\,k\\,\\rho_{0},\\quad A(k) = \\sigma + \\mu\\,k^{2}.\n$$\nAnalyze the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) iteration, with under-relaxation factors for velocity, $\\alpha_{u} \\in (0,1]$, and for pressure, $\\alpha_{p} \\in (0,1]$, using the standard SIMPLE steps applied to error fields:\n1. Velocity predictor: solve for the predicted velocity error $\\hat{u}$ from $A(k)\\,\\hat{u} = -G(k)\\,e_{p}^{n}$.\n2. Velocity under-relaxation: $e_{u}^{*} = e_{u}^{n} + \\alpha_{u}\\left(\\hat{u} - e_{u}^{n}\\right)$.\n3. Pressure correction equation: use the diagonal momentum inverse approximation $M_{d} = m > 0$ to define $H(k) = D(k)\\,M_{d}\\,G(k)$ and solve $H(k)\\,p' = D(k)\\,e_{u}^{*}$.\n4. Pressure update: $e_{p}^{n+1} = e_{p}^{n} + \\alpha_{p}\\,p'$.\n5. Velocity correction: $e_{u}^{n+1} = e_{u}^{*} - M_{d}\\,G(k)\\,p'$.\n\nAssume the iteration acts on a nonzero Fourier mode with wavenumber $k>0$ and that the density $\\rho_{0}$ remains constant during the iteration (reacting flow effects are embedded in $\\sigma$ and $\\mu$). Using the above operators and steps, derive the single-mode pressure error amplification factor $G(k)$ defined by $e_{p}^{n+1} = G(k)\\,e_{p}^{n}$ for a full SIMPLE iteration. Express your final answer as a closed-form analytic expression in terms of $\\alpha_{u}$, $\\alpha_{p}$, $m$, $\\sigma$, $\\mu$, and $k$. No numerical rounding is required. Provide only the expression for $G(k)$ as your final answer.",
            "solution": "The user wants me to act as a STEM professor and solve a problem related to the SIMPLE algorithm.\n\nHere's my plan:\n1.  **Validate the problem:** I need to go through the strict validation checklist.\n    *   **Step 1: Extract Givens:** I will list all equations, definitions, and variables provided in the problem statement verbatim.\n    *   **Step 2: Validate:** I will check the problem for scientific grounding, well-posedness, objectivity, completeness, and feasibility.\n        *   **Scientific Grounding:** The problem describes a linearized analysis of a reacting flow model and the SIMPLE algorithm. This is standard practice in computational fluid dynamics (CFD) and numerical analysis. The equations are linearized momentum and continuity equations. The SIMPLE steps are also standard. This seems scientifically sound.\n        *   **Well-Posed:** The problem asks for a specific derivation of the amplification factor for the SIMPLE iteration. This is a well-defined mathematical task. A unique solution should exist.\n        *   **Objective:** The language is technical and precise. No subjective statements.\n        *   **Completeness:** All necessary equations, operators, and steps for the SIMPLE iteration are provided. The goal is clearly stated. The variables ($\\alpha_u, \\alpha_p, m, \\sigma, \\mu, k, \\rho_0$) are defined.\n        *   **Consistency:** The linearized equations and their Fourier representations are consistent. For example, the second derivative $\\frac{d^2}{dx^2}$ becomes $-k^2$ in Fourier space, so the momentum operator symbol $A(k) = \\sigma - \\mu(-k^2) = \\sigma + \\mu k^2$ is correct. The gradient $\\frac{d}{dx}$ becomes $ik$, so $G(k) = ik$ is correct. The divergence $\\frac{d}{dx}(\\rho_0 \\cdot)$ becomes $ik\\rho_0$, so $D(k) = ik\\rho_0$ is correct. The steps of the SIMPLE algorithm are provided in a specific sequence. There are no contradictions.\n        *   **Realism:** The model is a simplification (linearized, 1D, frozen density for analysis), but this is a standard technique for stability analysis (von Neumann analysis). It's a plausible scenario for a theoretical CFD problem.\n        *   **Other Flaws:**\n            *   **Non-Formalizable/Irrelevant:** The problem is highly formal and directly related to the specified topic.\n            *   **Ill-Posed:** Seems well-posed.\n            *   **Pseudo-Profound/Trivial:** The derivation requires careful algebraic manipulation and understanding of the algorithm. It is not trivial.\n            *   **Unverifiable:** The derivation is a mathematical process and is fully verifiable.\n\n    *   **Step 3: Verdict:** The problem is valid. I can proceed to solve it.\n\n2.  **Solve the problem:** I need to derive the amplification factor $G(k)$ where $e_p^{n+1} = G(k) e_p^n$. This means I need to express $e_p^{n+1}$ solely in terms of $e_p^n$ and the given parameters. The velocity error $e_u^n$ will be an intermediate variable that needs to be eliminated.\n\n    The problem statement, however, seems to have a slight ambiguity. It asks to analyze the iteration on *error fields* ($e_p, e_u$), but Step 1 and 2 seem to imply a iterative solve for the velocity itself, not the error. Let's re-read carefully: \"using the standard SIMPLE steps applied to *error fields*\". Okay, this is a bit unusual. Typically SIMPLE is derived for the full variables, and the error analysis follows. But here, the steps are *defined* for the errors $e_u$ and $e_p$. This means the equations should be treated as they are written.\n    \n    Let's trace the dependencies:\n    $e_p^{n+1}$ depends on $e_p^n$ and $p'$.\n    $p'$ depends on $e_u^*$.\n    $e_u^*$ depends on $e_u^n$ and $\\hat{u}$.\n    $\\hat{u}$ depends on $e_p^n$.\n    \n    This is a problem. The error $e_u^{n+1}$ depends on $e_u^n$. I need a relationship between $e_u^n$ and $e_p^n$ to close the system. The problem statement does not provide one. Let's re-examine the context.\n\n    In a true SIMPLE iteration, we are solving a coupled system. Let the exact solution in Fourier space be $(\\hat{u}_{ex}, \\hat{p}_{ex})$.\n    The exact equations would be:\n    $A(k) \\hat{u}_{ex} = -G(k) \\hat{p}_{ex} + \\hat{S}_u$\n    $D(k) \\hat{u}_{ex} = \\hat{S}_\\rho$\n    Here sources are zero. So:\n    $A(k) \\hat{u}_{ex} = -G(k) \\hat{p}_{ex}$\n    $D(k) \\hat{u}_{ex} = 0\n    Since $k>0$ and $\\rho_0 > 0$, $D(k) = ik\\rho_0 \\neq 0$. This implies $\\hat{u}_{ex} = 0$.\n    Then $A(k) \\cdot 0 = -G(k) \\hat{p}_{ex}$, which implies $G(k) \\hat{p}_{ex}=0$. Since $k>0$, $G(k)=ik \\neq 0$. So $\\hat{p}_{ex}=0$.\n    The exact solution to the homogeneous problem is $(0,0)$.\n\n    The iteration is meant to drive the errors $e_u^n = \\hat{u}^n - \\hat{u}_{ex} = \\hat{u}^n$ and $e_p^n = \\hat{p}^n - \\hat{p}_{ex} = \\hat{p}^n$ to zero.\n    So, the analysis is on the convergence of the homogeneous problem. The variables $e_u$ and $e_p$ are the full Fourier modes of velocity and pressure at iteration $n$.\n\n    Let's re-label the variables for clarity to match the standard notation: $u^n$ and $p^n$ are the approximations at step $n$.\n    The problem defines the iteration on fields it calls \"error fields\".\n    Let's write the steps again, replacing $e_u$ with $u$ and $e_p$ with $p$.\n    1. Velocity predictor: $A(k)\\,\\hat{u} = -G(k)\\,p^{n}$.\n    2. Velocity under-relaxation: $u^{*} = u^{n} + \\alpha_{u}\\left(\\hat{u} - u^{n}\\right) = (1-\\alpha_u)u^n + \\alpha_u \\hatu$.\n    3. Pressure correction equation: $H(k)\\,p' = D(k)\\,u^{*}$.\n    4. Pressure update: $p^{n+1} = p^{n} + \\alpha_{p}\\,p'$.\n    5. Velocity correction: $u^{n+1} = u^{*} - M_{d}\\,G(k)\\,p'$.\n\n    But the goal is to find $p^{n+1} = G(k) p^n$. The presence of $u^n$ in step 2 is what makes this difficult.\n    Is there an implicit assumption I'm missing? What is the relationship between $u^n$ and $p^n$?\n    The true solution satisfies $A(k)u = -G(k)p$ and $D(k)u=0$.\n    The iteration is trying to satisfy these two equations.\n    The pressure correction equation $H(k)p' = D(k)u^*$ is designed to enforce the continuity equation at the next step.\n    Let's see: $D(k) u^{n+1} = D(k) (u^* - M_d G(k) p') = D(k)u^* - D(k) M_d G(k) p'$.\n    Since $H(k) = D(k) M_d G(k)$, we have $D(k)u^* = H(k)p'$.\n    So $D(k) u^{n+1} = H(k)p' - H(k)p' = 0$.\n    This means that if the iteration converges ($u^{n+1} \\to u$ and $p^{n+1} \\to p$), the final velocity field $u$ will satisfy the continuity equation $D(k)u=0$. This is a key feature of SIMPLE.\n    This also means $D(k)u^n = 0$ for all $n \\geq 1$. Let's assume we start from an initial guess $u^0, p^0$ such that $D(k)u^1 = 0$. Then this property holds for all subsequent iterates.\n    So, can I assume $D(k)u^n = 0$? This is a standard part of the analysis of projection methods. The velocity field at the beginning of each step is divergence-free. Let's assume this is implied.\n    \n    If $D(k) u^n=0$, then:\n    $D(k) u^* = D(k) ((1-\\alpha_u)u^n + \\alpha_u \\hat{u}) = (1-\\alpha_u)D(k)u^n + \\alpha_u D(k)\\hat{u} = \\alpha_u D(k)\\hat{u}$.\n    \n    This seems to be the missing link. Let's proceed with this assumption, as it's fundamental to how these projection-like methods work. The velocity field at the end of a step ($u^{n-1}$) is made to satisfy continuity, so the velocity at the start of the next step ($u^n$) satisfies continuity.\n\n    So, let's restart the derivation with the assumption $D(k) u^n = 0$.\n\n    **Step 1: Velocity predictor**\n    From $A(k)\\,\\hat{u} = -G(k)\\,p^{n}$, we get\n    $\\hat{u} = -A(k)^{-1} G(k) p^n$.\n    The problem defines $A(k) = \\sigma + \\mu k^2$. This is a scalar in Fourier space for a single mode, so its inverse is just $1/A(k)$.\n\n    **Step 2: Velocity under-relaxation**\n    $u^{*} = (1-\\alpha_u)u^n + \\alpha_u \\hat{u} = (1-\\alpha_u)u^n - \\alpha_u A(k)^{-1} G(k) p^n$.\n\n    **Step 3: Pressure correction equation**\n    $H(k)\\,p' = D(k)\\,u^{*}$.\n    Substitute $u^*$:\n    $H(k)\\,p' = D(k) \\left[ (1-\\alpha_u)u^n - \\alpha_u A(k)^{-1} G(k) p^n \\right]$.\n    $H(k)\\,p' = (1-\\alpha_u)D(k)u^n - \\alpha_u D(k) A(k)^{-1} G(k) p^n$.\n    Now, apply the crucial assumption: $D(k)u^n = 0$.\n    $H(k)\\,p' = - \\alpha_u D(k) A(k)^{-1} G(k) p^n$.\n    Now solve for $p'$:\n    $p' = - \\alpha_u H(k)^{-1} D(k) A(k)^{-1} G(k) p^n$.\n\n    **Step 4: Pressure update**\n    $p^{n+1} = p^{n} + \\alpha_{p}\\,p'$.\n    Substitute the expression for $p'$:\n    $p^{n+1} = p^{n} + \\alpha_{p} \\left[ - \\alpha_u H(k)^{-1} D(k) A(k}^{-1} G(k) p^n \\right]$.\n    $p^{n+1} = \\left[ 1 - \\alpha_p \\alpha_u H(k)^{-1} D(k) A(k}^{-1} G(k) \\right] p^n$.\n\n    So the amplification factor is $G_{amp}(k) = 1 - \\alpha_p \\alpha_u H(k)^{-1} D(k) A(k}^{-1} G(k)$.\n    Let's substitute the definitions of the operators. The problem uses $G(k)$ for the amplification factor, which conflicts with the gradient operator symbol. I will call it $G_{amp}(k)$ for now and rename it in the final presentation as requested.\n    $G(k) = i\\,k$\n    $D(k) = i\\,k\\,\\rho_{0}$\n    $A(k) = \\sigma + \\mu\\,k^{2}$\n    $M_d = m$\n    $H(k) = D(k)\\,M_{d}\\,G(k) = (i\\,k\\,\\rho_{0}) (m) (i\\,k) = -m\\,\\rho_{0}\\,k^2$.\n\n    Now substitute these into the expression for $G_{amp}(k)$.\n    $H(k)^{-1} = \\frac{1}{-m\\,\\rho_{0}\\,k^2}$.\n    $A(k)^{-1} = \\frac{1}{\\sigma + \\mu\\,k^{2}}$.\n\n    $G_{amp}(k) = 1 - \\alpha_p \\alpha_u \\left( \\frac{1}{-m\\,\\rho_{0}\\,k^2} \\right) (i\\,k\\,\\rho_{0}) \\left( \\frac{1}{\\sigma + \\mu\\,k^{2}} \\right) (i\\,k)$.\n    $G_{amp}(k) = 1 - \\frac{\\alpha_p \\alpha_u}{-m\\,\\rho_{0}\\,k^2} \\frac{(i\\,k\\,\\rho_{0})(i\\,k)}{\\sigma + \\mu\\,k^{2}}$.\n\n    Let's simplify the numerator term:\n    $(i\\,k\\,\\rho_{0})(i\\,k) = i^2 k^2 \\rho_0 = -k^2 \\rho_0$.\n\n    So,\n    $G_{amp}(k) = 1 - \\frac{\\alpha_p \\alpha_u}{-m\\,\\rho_{0}\\,k^2} \\frac{-k^2 \\rho_0}{\\sigma + \\mu\\,k^{2}}$.\n    The terms $-k^2 \\rho_0$ cancel in the numerator and denominator.\n    $G_{amp}(k) = 1 - \\frac{\\alpha_p \\alpha_u}{m} \\frac{1}{\\sigma + \\mu\\,k^{2}}$.\n\n    Wait, let me double check.\n    $H(k)^{-1} D(k) A(k)^{-1} G(k) = \\left( \\frac{1}{-m\\rho_0 k^2} \\right) (ik\\rho_0) \\left( \\frac{1}{\\sigma+\\mu k^2} \\right) (ik)$.\n    $= \\frac{i^2 k^2 \\rho_0}{-m\\rho_0 k^2 (\\sigma+\\mu k^2)} = \\frac{-k^2 \\rho_0}{-m\\rho_0 k^2 (\\sigma+\\mu k^2)} = \\frac{1}{m(\\sigma+\\mu k^2)}$.\n\n    So, $G_{amp}(k) = 1 - \\alpha_p \\alpha_u \\frac{1}{m(\\sigma+\\mu k^2)}$.\n    This seems too simple. Let me re-read the steps carefully.\n\n    1. Velocity predictor: $A(k)\\,\\hat{u} = -G(k)\\,e_{p}^{n}$. Solved for $\\hat{u}$.\n    2. Velocity under-relaxation: $e_{u}^{*} = e_{u}^{n} + \\alpha_{u}\\left(\\hat{u} - e_{u}^{n}\\right)$. My previous derivation used $u^*$ instead of $e_u^*$. This is a crucial point. The problem states the iteration is *applied to error fields*. This means that $e_u^n$ and $e_p^n$ are the variables.\n    Let's redo the derivation with the variables as given.\n\n    Given:\n    1. $A(k)\\,\\hat{u} = -G(k)\\,e_{p}^{n} \\implies \\hat{u} = -A(k)^{-1} G(k) e_p^n$.\n    2. $e_{u}^{*} = e_{u}^{n} + \\alpha_{u}\\left(\\hat{u} - e_{u}^{n}\\right) = (1-\\alpha_u)e_u^n + \\alpha_u \\hat{u}$.\n    3. $H(k)\\,p' = D(k)\\,e_{u}^{*}$.\n    4. $e_{p}^{n+1} = e_{p}^{n} + \\alpha_{p}\\,p'$.\n    5. $e_{u}^{n+1} = e_{u}^{*} - M_{d}\\,G(k)\\,p'$.\n\n    Goal: Find $G(k)$ such that $e_p^{n+1} = G(k) e_p^n$.\n\n    Let's trace the dependencies again.\n    $e_p^{n+1}$ depends on $e_p^n$ and $p'$.\n    $p'$ depends on $e_u^*$.\n    $e_u^*$ depends on $e_u^n$ and $\\hat{u}$.\n    $\\hat{u}$ depends on $e_p^n$.\n\n    So $e_p^{n+1}$ expression will contain $e_u^n$. The system is a coupled iteration for $(e_u, e_p)$:\n    $$ \\begin{pmatrix} e_u^{n+1} \\\\ e_p^{n+1} \\end{pmatrix} = M \\begin{pmatrix} e_u^{n} \\\\ e_p^{n} \\end{pmatrix} $$\n    The problem asks for $e_p^{n+1} = G(k) e_p^n$. This implies we are looking at a smaller part of the iteration matrix, or there's an implicit assumption.\n\n    Let's check the divergence of the error velocity.\n    $D(k) e_u^{n+1} = D(k) e_u^* - D(k) M_d G(k) p'$.\n    We have $H(k) = D(k) M_d G(k)$. So $D(k) M_d G(k) p' = H(k) p'$.\n    From step 3, $H(k)p' = D(k)e_u^*$.\n    So $D(k) e_u^{n+1} = D(k)e_u^* - D(k)e_u^* = 0$.\n    This means that the velocity error $e_u$ is projected onto the divergence-free space at each step. So $D(k)e_u^n = 0$ for $n \\ge 1$. This is the same assumption as before, but now applied to the error field $e_u$. Let's assume the initial error $e_u^0$ is not necessarily divergence free, but that $e_u^1, e_u^2, ...$ will be. If we are analyzing the asymptotic convergence, we can analyze the iteration for $n \\ge 1$, and thus assume $D(k)e_u^n = 0$. This is a standard procedure in von Neumann analysis of such schemes.\n\n    So, let's proceed with $D(k)e_u^n=0$.\n    \n    From step 2: $e_u^* = (1-\\alpha_u)e_u^n + \\alpha_u \\hat{u}$.\n    Apply $D(k)$ to this:\n    $D(k)e_u^* = D(k)[(1-\\alpha_u)e_u^n + \\alpha_u \\hat{u}] = (1-\\alpha_u)D(k)e_u^n + \\alpha_u D(k)\\hat{u}$.\n    With $D(k)e_u^n = 0$, we have:\n    $D(k)e_u^* = \\alpha_u D(k)\\hat{u}$.\n\n    From step 1, $\\hat{u} = -A(k)^{-1} G(k) e_p^n$.\n    Substitute $\\hat{u}$ into the expression for $D(k)e_u^*$:\n    $D(k)e_u^* = \\alpha_u D(k) [-A(k)^{-1} G(k) e_p^n] = -\\alpha_u D(k) A(k)^{-1} G(k) e_p^n$.\n\n    From step 3, $H(k)p' = D(k)e_u^*$.\n    So, $H(k)p' = -\\alpha_u D(k) A(k)^{-1} G(k) e_p^n$.\n    Solve for $p'$:\n    $p' = -\\alpha_u H(k)^{-1} D(k) A(k)^{-1} G(k) e_p^n$.\n\n    From step 4, $e_p^{n+1} = e_p^n + \\alpha_p p'$.\n    Substitute $p'$:\n    $e_p^{n+1} = e_p^n + \\alpha_p [-\\alpha_u H(k)^{-1} D(k) A(k)^{-1} G(k) e_p^n]$.\n    $e_p^{n+1} = \\left( 1 - \\alpha_p \\alpha_u H(k)^{-1} D(k) A(k)^{-1 G(k) \\right) e_p^n$.\n\n    This is the same expression as I got before. The amplification factor (which the problem calls $G(k)$) is:\n    $G_{amp}(k) = 1 - \\alpha_p \\alpha_u H(k)^{-1} D(k) A(k)^{-1} G_{op}(k)$.\n    I'll use $G_{op}(k)$ for the gradient operator to avoid confusion. $G_{op}(k) = ik$.\n    \n    The term to evaluate is $H(k)^{-1} D(k) A(k)^{-1} G_{op}(k)$.\n    $G_{op}(k) = i k$\n    $D(k) = i k \\rho_0$\n    $A(k) = \\sigma + \\mu k^2$\n    $H(k) = D(k) M_d G_{op}(k) = (ik\\rho_0) m (ik) = -m\\rho_0 k^2$.\n    \n    $H(k)^{-1} = \\frac{1}{-m\\rho_0 k^2}$.\n    $A(k)^{-1} = \\frac{1}{\\sigma + \\mu k^2}$.\n\n    $H(k)^{-1} D(k) A(k)^{-1} G_{op}(k) = \\left( \\frac{1}{-m\\rho_0 k^2} \\right) (ik\\rho_0) \\left( \\frac{1}{\\sigma + \\mu k^2} \\right) (ik)$\n    $= \\frac{i^2 k^2 \\rho_0}{-m\\rho_0 k^2 (\\sigma + \\mu k^2)}$\n    $= \\frac{-k^2 \\rho_0}{-m\\rho_0 k^2 (\\sigma + \\mu k^2)}$\n    $= \\frac{1}{m_0(\\sigma + \\mu k^2)}$.\n\n    So, the amplification factor is:\n    $G(k) = 1 - \\alpha_p \\alpha_u \\frac{1}{m(\\sigma + \\mu k^2)}$.\n\n    Double-checking the problem statement for any subtleties.\n    - \"linearized about a steady base state such that the local mean density is frozen at a constant value $\\rho_0 > 0$ for the purpose of the local analysis.\" This justifies using a constant $\\rho_0$ in the Fourier analysis.\n    - Momentum equation: $\\sigma u - \\mu u_{xx} = -p_x$. In Fourier space, $u_{xx} \\to -k^2 \\hat{u}$ and $p_x \\to ik\\hat{p}$. So $(\\sigma + \\mu k^2)\\hat{u} = -ik\\hat{p}$. This matches $A(k)\\hat{u} = -G(k)\\hat{p}$. Correct.\n    - Mass conservation: $(\\rho_0 u)_x = 0$. In Fourier space, $ik\\rho_0 \\hat{u} = 0$. This matches $D(k)\\hat{u} = 0$. Correct.\n    - Operator definitions: $G(k)=ik$, $D(k)=ik\\rho_0$, $A(k)=\\sigma+\\mu k^2$. All match the physics.\n    - SIMPLE steps: The steps are given. I must follow them exactly.\n    - Step 1: Velocity predictor: solve for $\\hat{u}$ from $A(k)\\hat{u} = -G(k)e_p^n$. This is the standard form, relating the non-divergence-free velocity to the old pressure gradient.\n    - Step 2: Velocity under-relaxation: $e_u^* = e_u^n + \\alpha_u(\\hat{u} - e_u^n)$. It is unusual to under-relax the *difference* between the predicted value and the old value. Usually it's $u^* = \\alpha_u \\hat{u} + (1-\\alpha_u)u^n$. This is mathematically equivalent. Let's check: $u^n + \\alpha_u(\\hat{u} - u^n) = u^n + \\alpha_u \\hat{u} - \\alpha_u u^n = (1-\\alpha_u)u^n + \\alpha_u \\hat{u}$. Yes, it's the standard form.\n    - Step 3: Pressure correction: Use $M_d=m$ to define $H(k) = D(k)M_d G(k)$ and solve $H(k)p' = D(k)e_u^*$. This is the standard pressure-correction Poisson-like equation.The approximation is that the inverse of the full momentum operator $A(k)^{-1}$ is approximated by a simpler operator, here $M_d=m$. Let's explore this. The exact relationship between velocity correction and pressure correction is $u' = -A^{-1}G p'$. SIMPLE approximates $A^{-1}$ with a diagonal part, which here is represented by $m$. The problem statement uses $M_d$ in Step 5 for the velocity correction, but in Step 3 it is used to define $H(k)$. Let's trace.\n    In the derivation of the pressure correction equation, one starts with $D(u^*+u')=0$ (enforcing continuity on the corrected velocity). So $D(u')=-D(u^*)$. Then, using the approximate momentum relation $u' = -M_d G p'$, we get $D(-M_d G p') = -D(u^*)$, which gives $D M_d G p' = D u^*$. This is exactly what is written: $H(k) p' = D(k) e_u^*$. So the formulation is consistent with the standard derivation of SIMPLE.\n    - Step 4: Pressure update: $e_p^{n+1} = e_p^n + \\alpha_p p'$. Standard.\n    - Step 5: Velocity correction: $e_u^{n+1} = e_u^* - M_d G(k) p'$. This is the application of the velocity correction $u' = -M_d G p'$ to the intermediate velocity $u^*$. Standard.\n\n    The logic seems to hold. The key assumption is $D(k)e_u^n=0$. Is this justifiable?\n    The problem asks for \"the single-mode pressure error amplification factor\". This implies a relation $e_p^{n+1} = G(k) e_p^n$. This structure can only be obtained if the $e_u^n$ term drops out. The only way for it to drop out is if $D(k)e_u^n=0$. As shown before, the structure of the algorithm ensures $D(k)e_u^{n+1}=0$ regardless of the value of $e_u^n$. Therefore, for any $n \\geq 1$, $D(k)e_u^n=0$. This analysis is therefore valid for the second and all subsequent iterations, which is what determines the asymptotic convergence rate. So the assumption is valid for the context of finding the amplification factor.\n\n    Let's re-check the algebra once more.\n    $e_p^{n+1} = e_p^n + \\alpha_p p'$\n    $p' = H(k)^{-1} D(k) e_u^*$\n    $e_u^* = (1-\\alpha_u)e_u^n + \\alpha_u \\hat{u}$\n    $\\hat{u} = -A(k)^{-1} G(k) e_p^n$\n\n    $p' = H(k)^{-1} D(k) [(1-\\alpha_u)e_u^n + \\alpha_u \\hat{u}]$\n    $p' = H(k)^{-1} [(1-\\alpha_u)D(k)e_u^n - \\alpha_u D(k)A(k)^{-1}G(k)e_p^n]$\n    Assuming $D(k)e_u^n=0$:\n    $p' = H(k)^{-1} [-\\alpha_u D(k)A(k)^{-1}G(k)e_p^n]$\n    \n    $e_p^{n+1} = e_p^n + \\alpha_p (-\\alpha_u) H(k)^{-1} D(k)A(k)^{-1}G(k) e_p^n$\n    $e_p^{n+1} = [1 - \\alpha_p \\alpha_u H(k)^{-1} D(k)A(k)^{-1}G(k)] e_p^n$\n    \n    $G(k)_{amp} = 1 - \\alpha_p \\alpha_u \\frac{D(k)A(k)^{-1}G(k)}{H(k)}$\n    \n    Numerator: $D(k)A(k)^{-1}G(k) = (ik\\rho_0) (\\frac{1}{\\sigma+\\mu k^2}) (ik) = \\frac{i^2 k^2 \\rho_0}{\\sigma+\\mu k^2} = \\frac{-k^2 \\rho_0}{\\sigma+\\mu k^2}$\n    Denominator: $H(k) = D(k) M_d G(k) = (ik\\rho_0) (m) (ik) = -m k^2 \\rho_0$\n\n    Ratio: $\\frac{D(k)A(k)^{-1}G(k)}{H(k)} = \\frac{-k^2 \\rho_0 / (\\sigma+\\mu k^2)}{-m k^2 \\rho_0} = \\frac{1}{m(\\sigma+\\mu k^2)}$.\n\n    $G(k)_{amp} = 1 - \\frac{\\alpha_p \\alpha_u}{m(\\sigma+\\mu k^2)}$.\n\n    The question is, is $M_d = m$ the diagonal of $A(k)$? The problem says it's an approximation $M_d = m > 0$. Usually, one would approximate $A^{-1}$ by its diagonal. For a full discretization on a grid, the operator $A$ corresponding to $\\sigma I - \\mu \\nabla^2$ would be a matrix. Its diagonal entries would be roughly $\\sigma + 2\\mu/(\\Delta x)^2$. The Fourier symbol $A(k)$ is the eigenvalue of this matrix for mode $k$. The problem doesn't state that $m$ is the diagonal of $A$, but rather a given constant $m>0$ that is used in the algorithm. This is a common simplification in textbook problems on SIMPLE. It represents the diagonal-part approximation of the momentum matrix. So I should just leave $m$ as it is.\n\n    So the final expression seems correct. Let me write down the solution formally.\n    I need to be careful with the LaTeX formatting rules.\n    - All math entities in LaTeX.\n- No markdown headers.\n    - Final answer in a box, single expression.\n    - Symbolic reasoning.\n\n    The problem statement uses $G(k)$ for the gradient operator and also for the amplification factor. This is a flaw in the problem statement (ambiguous notation). When I present the solution, I should clarify this. I can call the gradient operator $\\mathcal{G}(k)$ in my derivation to avoid confusion and then state that the final answer is for the amplification factor, which the problem calls $G(k)$.\n\n    Let's review the problem statement again. \"derive the single-mode pressure error amplification factor $G(k)$ defined by $e_p^{n+1} = G(k) e_p^n$\".\n    Okay, so my result is the amplification factor. The problem has a notation collision.\n    \"denote the symbols of the gradient, divergence and momentum operators by $G(k) = i\\,k, ...$\"\n    This is a direct conflict. However, the final request is \"Provide only the expression for $G(k)$ as your final answer\", where $G(k)$ is defined as the amplification factor. I should probably note the ambiguity in the problem but proceed by using a different symbol for the gradient operator during the derivation. The final boxed answer should just be the expression.\n\n    The overall structure of the solution:\n    1.  Start with problem validation (which I've done, and it's valid).\n    2.  State the goal: derive the expression for the pressure error amplification factor. I will note the notational ambiguity and use $\\mathcal{G}(k)$ for the gradient operator symbol to maintain clarity in the derivation.\n    3.  Write down the five steps of the SIMPLE iteration for the error fields as given.\n    4.  Combine the equations algebraically to find the relationship between $e_p^{n+1}$ and $e_p^n$.\n    5.  State and justify the key assumption that the divergence of the velocity error is zero, i.e., $D(k)e_u^n = 0$ for $n \\geq 1$.\n    6.  Substitute the operator definitions: $\\mathcal{G}(k)=ik$, $D(k)=ik\\rho_0$, $A(k)=\\sigma+\\mu k^2$, $H(k)=-m\\rho_0 k^2$.\n    7.  Simplify the expression to get the final result.\n    8.  Box the final answer.\n\n    The derivation looks solid. The result is a closed-form analytic expression in terms of the required variables. No numerical values are needed. The steps are logical and follow from the problem statement.\n\n    Final check on the result: $G_{amp}(k) = 1 - \\frac{\\alpha_p \\alpha_u}{m(\\sigma+\\mu k^2)}$.\n    This looks physically reasonable. For convergence, we need $|G_{amp}(k)| < 1$.\n    The term $\\frac{\\alpha_p \\alpha_u}{m(\\sigma+\\mu k^2)}$ is positive since all parameters are positive.\n    So $G_{amp}(k) < 1$.\n    For stability, we need $G_{amp}(k) > -1$.\n    $1 - \\frac{\\alpha_p \\alpha_u}{m(\\sigma+\\mu k^2)} > -1$\n    $2 > \\frac{\\alpha_p \\alpha_u}{m(\\sigma+\\mu k^2)}$\n    $2m(\\sigma+\\mu k^2) > \\alpha_p \\alpha_u$.\n    This is a condition on the parameters. The problem doesn't ask for a stability analysis, just the amplification factor. The result is what it is. For high wavenumbers $k \\to \\infty$, $G_{amp}(k) \\to 1$. This is a well-known issue with SIMPLE: it is a good smoother (damps low-wumber errors well) but a poor solver (damps high-wavenumber errors poorly). The expression reflects this: for small $k$, the subtracted term is large, making $G_{amp}$ small (good damping). For large $k$, the subtracted term is small, making $G_{amp}$ close to 1 (poor damping). This gives me confidence in the result.\n\n    The problem asks for $G(k)$, so I should use that in the final answer box. The collision in notation exists in the problem statement itself, so I'll follow its final instruction. My derivation will be clear.\n\n    The prompt has a high-priority formatting rule: **every mathematical entity**...**must** be written in LaTeX. I will be extra careful about this. All variables, numbers, symbols etc.\n    e.g. $\\rho_0$, $\\mu$, $\\sigma$, $u(x)$, $p(x)$, $k$, $i$, $\\alpha_u$, $\\alpha_p$, $m$, $e_p^n$, $e_u^*$, $p'$, $H(k)$, $D(k)$, $A(k)$, etc. must be in LaTeX. Even the number 1 in an expression like `1 - ...` must be `$1$`.\n\n    The final answer should be in a `\\boxed{}`.\n    It should be one expression.\n    Let me write it down to check formatting.\n    `\\boxed{1 - \\frac{\\alpha_p \\alpha_u}{m(\\sigma + \\mu k^2)}}`\n    This uses `\\frac`, has `{}` for exponents (none here), `\\ln` `\\exp` etc. (none here), `\\sin` etc (none here), `|...|` (none here), `\\binom` (none here), sci notation (none here). The format looks OK.\n    I should write $\\alpha_p$ as `\\alpha_p` and $\\alpha_u$ as `\\alpha_u`. And $\\mu$ as `\\mu` and `\\sigma` as `\\sigma`.\n    The final expression is `$$ \\boxed{1 - \\frac{\\alpha_{p} \\alpha_{u}}{m(\\sigma + \\mu k^{2})}} $$`. This looks correct.\n    I am ready to write the solution.",
            "answer": "$$\n\\boxed{1 - \\frac{\\alpha_{p} \\alpha_{u}}{m (\\sigma + \\mu k^{2})}}\n$$"
        },
        {
            "introduction": "Moving from idealized theory to practical implementation on a grid reveals a classic challenge in CFD: pressure-velocity decoupling. On collocated grids, where pressure and velocity components are stored at the same location, certain pressure fields, known as \"checkerboard\" modes, can exist in the null space of the discrete pressure gradient operator, leading to non-physical oscillations. This hands-on coding practice tasks you with building a diagnostic tool to detect this pathology by analyzing the energy spectrum of the pressure and velocity divergence fields . You will learn to identify the spectral signature of checkerboarding and connect it to physically motivated corrective actions, such as the application of Rhie-Chow interpolation.",
            "id": "4063108",
            "problem": "You are asked to write a complete and runnable program that detects and diagnoses pressure–velocity decoupling (checkerboarding) in a collocated-grid formulation of the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) family for reacting flows, by evaluating the discrete spectra of cell-centered pressure and face-normal mass flux divergence. The task must be grounded in first principles: mass and momentum conservation and standard discrete Fourier analysis. You must implement the analysis in a mathematically universal way that does not depend on any specific programming language idiosyncrasies and yields quantifiable outputs for a predefined test suite.\n\nStart from the following fundamental base:\n- Mass conservation (continuity): for constant density, the steady form is the discrete constraint that the cell-wise divergence of mass flux vanishes, i.e., the discrete operator applied to face-normal fluxes is zero.\n- Momentum conservation: the pressure gradient contributes to face mass flux through the momentum balance and its discrete counterpart. On collocated grids, naive interpolation of face fluxes from cell-centered variables without pressure-weighted coupling can create spurious odd–even decoupling modes.\n- Discrete Fourier transform (DFT): any discrete field on a periodic uniform grid admits a unique expansion into discrete Fourier modes; high-wavenumber modes capture grid-scale oscillations such as checkerboarding. The modes at the Nyquist wavenumber are the highest resolvable and are prototypical for odd–even oscillations.\n\nYou will implement the following definitions precisely:\n- Consider a uniform, periodic, two-dimensional grid of size $N_x \\times N_y$ cells indexed by $i \\in \\{0,\\dots,N_x-1\\}$ and $j \\in \\{0,\\dots,N_y-1\\}$. Let coordinates be $x_i = i/N_x$, $y_j = j/N_y$. Use dimensionless units so that the grid spacing is $1/N_x$ in $x$ and $1/N_y$ in $y$, and set density to unity.\n- Let $p_{i,j}$ denote cell-centered pressure. Let $u_{i+1/2,j}$ and $v_{i,j+1/2}$ denote face-normal mass fluxes in the $x$ and $y$ directions, respectively, stored on a periodic face grid. Represent faces by arrays of the same shape as cells using periodic indexing: for faces in $x$, index $u_{j,i}$ represents $u_{i+1/2,j}$, and for faces in $y$, index $v_{j,i}$ represents $v_{i,j+1/2}$. The discrete divergence at cell $(i,j)$ is\n\n$$\nd_{i,j} = \\left(u_{i+1/2,j} - u_{i-1/2,j}\\right) + \\left(v_{i,j+1/2} - v_{i,j-1/2}\\right),\n$$\n\nwith periodic indexing for $i-1$ and $j-1$.\n- For any real-valued field $f_{i,j}$ on the grid, define its two-dimensional discrete Fourier transform $F_{k_x,k_y}$ for $k_x \\in \\{0,\\dots,N_x-1\\}$ and $k_y \\in \\{0,\\dots,N_y-1\\}$ using the standard unitary-free convention. Define the total spectral energy\n\n$$\nE_\\text{tot}(f) = \\sum_{k_x=0}^{N_x-1} \\sum_{k_y=0}^{N_y-1} \\left|F_{k_x,k_y}\\right|^2.\n$$\n\n- Define the Nyquist index in $x$ as $k_x^\\star = N_x/2$ if $N_x$ is even (and undefined otherwise), and likewise $k_y^\\star = N_y/2$. Define the Nyquist set $\\mathcal{N} = \\{(k_x,k_y) \\mid k_x = k_x^\\star \\lor k_y = k_y^\\star\\}$. Define the Nyquist energy fraction for $f$ as\n\n$$\nr(f) = \\frac{\\sum_{(k_x,k_y)\\in \\mathcal{N}} \\left|F_{k_x,k_y}\\right|^2}{E_\\text{tot}(f)},\n$$\n\nwith the convention that $r(f)=0$ if $E_\\text{tot}(f)=0$.\n- Use a detection threshold $\\tau = 0.6$. Define $r_p = r(p)$ for the pressure field and $r_d = r(d)$ for the divergence of face-normal mass flux. Define $r_\\text{max} = \\max(r_p, r_d)$. Define the checkerboarding detection boolean $C$ as true if $r_\\text{max} \\ge \\tau$ and false otherwise.\n\nYou must also encode corrective actions as integer codes informed by interpolation and discretization choices:\n- Action code $0$: no change recommended.\n- Action code $1$: apply pressure-weighted momentum interpolation at faces (Rhie–Chow filtering) to couple pressure and velocity on collocated grids.\n- Action code $2$: increase dissipation in face mass flux interpolation or decrease momentum under-relaxation to damp high-frequency flux divergence (e.g., blend toward upwind for convective fluxes or increase pressure-weighting).\n\nSelect the action code according to the following logic: if $r_p \\ge \\tau$, then action code $1$; else if $r_d \\ge \\tau$, then action code $2$; else action code $0$.\n\nImplement the following test suite of synthetic, periodic fields at $N_x = N_y = 32$ to exercise different regimes. For each case, construct $p_{i,j}$, $u_{i+1/2,j}$, and $v_{i,j+1/2}$ as described.\n\n- Case A (smooth base flow, no checkerboard): define\n\n$$\np_{i,j} = \\sin\\left(2\\pi x_i\\right)\\sin\\left(2\\pi y_j\\right).\n$$\n\nDefine a cell-centered streamfunction $\\psi_{i,j} = \\sin\\left(2\\pi x_i\\right)\\sin\\left(2\\pi y_j\\right)$ and approximate cell-centered velocities by $u^\\text{cc}_{i,j} = \\frac{\\partial \\psi}{\\partial y} \\approx 2\\pi \\cos\\left(2\\pi y_j\\right)\\sin\\left(2\\pi x_i\\right)$ and $v^\\text{cc}_{i,j} = -\\frac{\\partial \\psi}{\\partial x} \\approx -2\\pi \\cos\\left(2\\pi x_i\\right)\\sin\\left(2\\pi y_j\\right)$. Then define face fluxes by arithmetic averaging to faces: $u_{i+1/2,j} = \\frac{1}{2}\\left(u^\\text{cc}_{i,j} + u^\\text{cc}_{i+1,j}\\right)$ and $v_{i,j+1/2} = \\frac{1}{2}\\left(v^\\text{cc}_{i,j} + v^\\text{cc}_{i,j+1}\\right)$, with periodic indexing.\n\n- Case B (canonical two-dimensional checkerboard in pressure): define\n\n$$\np_{i,j} = (-1)^{i+j},\n$$\n\nand set $u_{i+1/2,j} = 0$ and $v_{i,j+1/2} = 0$ for all faces.\n\n- Case C (one-dimensional checkerboard in pressure along $x$): define\n\n$$\np_{i,j} = (-1)^i,\n$$\n\nand set $u_{i+1/2,j} = 0$ and $v_{i,j+1/2} = 0$ for all faces.\n\n- Case D (smooth pressure, checkerboard in flux): define $p_{i,j}$ as in Case A. Define $u_{i+1/2,j} = (-1)^i$ for all $j$, and $v_{i,j+1/2} = 0$ for all $i,j$.\n\nYour program must, for each case, compute $r_p$, $r_d$, and $r_\\text{max}$, decide $C$, and select the action code according to the stated logic. The final result per case must be a list $[C, a, r_\\text{max}]$, where $C$ is a boolean, $a$ is an integer action code, and $r_\\text{max}$ is a floating-point number.\n\nFinal output format:\n- Your program must produce a single line of output containing a Python-style list of the four case results, each of which is itself a Python-style list $[C, a, r_\\text{max}]$. For example, a valid structure is $[[C_A,a_A,r_A],[C_B,a_B,r_B],[C_C,a_C,r_C],[C_D,a_D,r_D]]$. The booleans must print as true or false in Python’s canonical capitalization (True/False). The floats may be printed in standard decimal notation.\n\nNo other text should be printed. There are no physical units required, as all fields are nondimensional. Angles in trigonometric functions are in radians by construction. The test suite is fully specified above and must be hard-coded in your solution.",
            "solution": "We derive a principled spectral detector for pressure–velocity decoupling in collocated-grid Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) algorithms by relying on the governing conservation laws and the properties of discrete Fourier representations.\n\n1. Fundamental basis and checkerboarding origin:\n   - The discrete steady mass conservation statement for constant density is that the discrete divergence of face mass flux vanishes in each control volume. On a uniform grid with periodic boundary conditions, the discrete divergence operator applied to face-normal mass fluxes $u_{i+1/2,j}$ and $v_{i,j+1/2}$ is\n   \n$$\n   d_{i,j} = \\left(u_{i+1/2,j} - u_{i-1/2,j}\\right) + \\left(v_{i,j+1/2} - v_{i,j-1/2}\\right).\n   $$\n\n   - In collocated arrangements, the momentum equations relate face mass flux to cell-centered velocities and pressure gradients. A naive linear interpolation for face velocity without pressure-weighted coupling allows a non-unique mapping from pressure to face flux, which can support spurious odd–even oscillations in pressure that minimally affect the linearly interpolated face flux. This manifests as high-wavenumber modes at the Nyquist wavenumber, known as checkerboarding.\n   - In the Semi-Implicit Method for Pressure-Linked Equations, Rhie–Chow momentum interpolation explicitly introduces pressure-difference contributions in the face flux, coupling pressure and mass flux consistently and suppressing the decoupled mode.\n\n2. Spectral detection rationale:\n   - Any discrete field $f_{i,j}$ on a periodic uniform grid admits a two-dimensional discrete Fourier transform $F_{k_x,k_y}$ that uniquely represents it as a superposition of orthogonal modes. The Nyquist wavenumbers $k_x^\\star = N_x/2$ and $k_y^\\star = N_y/2$ (for even $N_x$ and $N_y$) correspond to the highest spatial frequency, with spatial variation of period two grid cells (alternating signs).\n   - Checkerboarding is characterized by dominance of these Nyquist modes, either in pressure $p$ or in the divergence $d$ of the face mass flux. Therefore, a diagnostic that measures the fraction of spectral energy located on the Nyquist set $\\mathcal{N} = \\{(k_x,k_y)\\mid k_x=k_x^\\star \\lor k_y=k_y^\\star\\}$ is appropriate. Define\n   \n$$\n   E_\\text{tot}(f) = \\sum_{k_x=0}^{N_x-1} \\sum_{k_y=0}^{N_y-1} \\left|F_{k_x,k_y}\\right|^2, \\quad\n   r(f) = \\frac{\\sum_{(k_x,k_y)\\in \\mathcal{N}} \\left|F_{k_x,k_y}\\right|^2}{E_\\text{tot}(f)}.\n   $$\n\n   If $r(f)$ is large, the Nyquist modes dominate the field.\n\n3. Decision logic grounded in conservation:\n   - Compute $r_p = r(p)$ and $r_d = r(d)$. The quantity $r_p$ captures spurious pressure oscillations associated with decoupled pressure correction, whereas $r_d$ captures high-frequency divergence oscillations associated with inconsistent or overly central face interpolation for momentum/convective flux.\n   - Define $r_\\text{max} = \\max(r_p, r_d)$ and a threshold $\\tau = 0.6$. If $r_\\text{max} \\ge \\tau$, checkerboarding is significant: set detection boolean $C$ to true. Otherwise, set $C$ to false.\n   - Select corrective action code $a$ tied to interpolation and discretization choices:\n     - If $r_p \\ge \\tau$, return $a=1$: apply Rhie–Chow momentum interpolation to introduce pressure differences directly in face mass flux, eliminating the decoupled pressure mode.\n     - Else if $r_d \\ge \\tau$, return $a=2$: increase dissipation or damping in face mass flux interpolation (e.g., blend toward upwind for convective fluxes or decrease momentum under-relaxation), which suppresses high-frequency divergence oscillations.\n     - Else, return $a=0$ (no change).\n\n4. Test suite design and coverage:\n   - Case A defines a smooth pressure field and a divergence-free velocity from a streamfunction. The spectra concentrate at low wavenumbers, so $r_p$ and $r_d$ are small; expect $C=$ false and $a=0$.\n   - Case B defines the canonical two-dimensional checkerboard pressure $p_{i,j} = (-1)^{i+j}$. Its discrete Fourier transform is concentrated at $(k_x^\\star,k_y^\\star)$, the Nyquist mode in both directions, hence $r_p \\approx 1$; expect $C=$ true and $a=1$.\n   - Case C defines a one-dimensional checkerboard in $x$, $p_{i,j} = (-1)^i$. Its transform is concentrated at $(k_x^\\star,0)$, which lies in $\\mathcal{N}$; hence $r_p \\approx 1$; expect $C=$ true and $a=1$.\n   - Case D defines a smooth pressure as in Case A but imposes a checkerboard in face $u$-flux, producing divergence $d_{i,j}$ with a strong Nyquist component along $x$. Hence $r_d \\approx 1$; expect $C=$ true and $a=2$.\n\n5. Algorithmic steps to implement:\n   - Build the grid with $N_x=N_y=32$, periodic indexing. Compute $p$, $u$, $v$ per case as prescribed. For Case A, compute cell-centered velocities from $\\psi$ and average to faces; for other cases set faces directly as specified.\n   - Compute the discrete divergence $d$ using periodic differences of face fluxes.\n   - Compute $r_p$ and $r_d$ by taking two-dimensional discrete Fourier transforms of $p$ and $d$, summing squared magnitudes to get $E_\\text{tot}$, and summing squared magnitudes on the Nyquist set $\\mathcal{N}$. Handle the $E_\\text{tot}=0$ case by defining the ratio as zero.\n   - Apply the decision logic to determine $C$, $a$, and $r_\\text{max}$ for each case.\n   - Aggregate and print results in the specified single-line format as a list of four lists $[C,a,r_\\text{max}]$.\n\nThis approach integrates the governing laws with spectral analysis to both detect the hallmark signature of checkerboarding and recommend physically motivated corrections rooted in interpolation and discretization choices standard within the SIMPLE family.",
            "answer": "```python\nimport numpy as np\n\ndef generate_grid(Nx, Ny):\n    x = np.arange(Nx) / Nx\n    y = np.arange(Ny) / Ny\n    X, Y = np.meshgrid(x, y, indexing='xy')  # shape (Ny, Nx)\n    return X, Y\n\ndef compute_fft_nyquist_ratio(field):\n    \"\"\"\n    Compute the fraction of spectral energy located on the Nyquist set:\n    modes where kx = Nx/2 or ky = Ny/2 (for even dimensions).\n    \"\"\"\n    Ny, Nx = field.shape\n    F = np.fft.fft2(field)\n    energy = (F * np.conj(F)).real\n    total_energy = energy.sum()\n    if total_energy == 0.0:\n        return 0.0\n    # Nyquist indices for even sizes\n    kx_star = Nx // 2 if Nx % 2 == 0 else None\n    ky_star = Ny // 2 if Ny % 2 == 0 else None\n\n    kx = np.arange(Nx)[None, :]  # shape (1, Nx)\n    ky = np.arange(Ny)[:, None]  # shape (Ny, 1)\n    mask = np.zeros((Ny, Nx), dtype=bool)\n    if kx_star is not None:\n        mask |= (kx == kx_star)\n    if ky_star is not None:\n        mask |= (ky == ky_star)\n\n    nyquist_energy = energy[mask].sum()\n    ratio = float(nyquist_energy / total_energy)\n    return ratio\n\ndef make_case_A(Nx, Ny):\n    # Smooth pressure and smooth divergence-free velocity from streamfunction\n    X, Y = generate_grid(Nx, Ny)\n    p = np.sin(2*np.pi*X) * np.sin(2*np.pi*Y)\n    # Cell-centered velocities from streamfunction psi = sin(2πx) sin(2πy)\n    u_cc = 2*np.pi * np.cos(2*np.pi*Y) * np.sin(2*np.pi*X)\n    v_cc = -2*np.pi * np.cos(2*np.pi*X) * np.sin(2*np.pi*Y)\n    # Average to faces with periodicity\n    # u_faces[j,i] at i+1/2: average u_cc[j,i] and u_cc[j,i+1]\n    u_faces = 0.5 * (u_cc + np.roll(u_cc, shift=-1, axis=1))\n    # v_faces[j,i] at j+1/2: average v_cc[j,i] and v_cc[j+1,i]\n    v_faces = 0.5 * (v_cc + np.roll(v_cc, shift=-1, axis=0))\n    return p, u_faces, v_faces\n\ndef make_case_B(Nx, Ny):\n    # 2D checkerboard pressure, zero fluxes\n    i = np.arange(Nx)[None, :]\n    j = np.arange(Ny)[:, None]\n    p = ((-1.0) ** (i + j)).astype(float)\n    u_faces = np.zeros((Ny, Nx), dtype=float)\n    v_faces = np.zeros((Ny, Nx), dtype=float)\n    return p, u_faces, v_faces\n\ndef make_case_C(Nx, Ny):\n    # 1D checkerboard along x in pressure, zero fluxes\n    i = np.arange(Nx)[None, :]\n    p_row = ((-1.0) ** i).astype(float)  # shape (1, Nx)\n    p = np.repeat(p_row, Ny, axis=0)\n    u_faces = np.zeros((Ny, Nx), dtype=float)\n    v_faces = np.zeros((Ny, Nx), dtype=float)\n    return p, u_faces, v_faces\n\ndef make_case_D(Nx, Ny):\n    # Smooth pressure as in A, but checkerboard flux in u\n    X, Y = generate_grid(Nx, Ny)\n    p = np.sin(2*np.pi*X) * np.sin(2*np.pi*Y)\n    i = np.arange(Nx)[None, :]\n    u_faces_row = ((-1.0) ** i).astype(float)  # shape (1, Nx)\n    u_faces = np.repeat(u_faces_row, Ny, axis=0)\n    v_faces = np.zeros((Ny, Nx), dtype=float)\n    return p, u_faces, v_faces\n\ndef divergence_from_faces(u_faces, v_faces):\n    \"\"\"\n    Compute discrete divergence d[j,i] = (u[i+1/2,j]-u[i-1/2,j]) + (v[i,j+1/2]-v[i,j-1/2])\n    using periodic boundary conditions. Arrays use shape (Ny,Nx).\n    \"\"\"\n    # Differences with periodic wrap\n    du = u_faces - np.roll(u_faces, shift=1, axis=1)  # along x faces\n    dv = v_faces - np.roll(v_faces, shift=1, axis=0)  # along y faces\n    d = du + dv\n    return d\n\ndef analyze_case(p, u_faces, v_faces, tau=0.6):\n    d = divergence_from_faces(u_faces, v_faces)\n    rp = compute_fft_nyquist_ratio(p)\n    rd = compute_fft_nyquist_ratio(d)\n    rmax = max(rp, rd)\n    checkerboard = (rmax >= tau)\n    if rp >= tau:\n        action = 1\n    elif rd >= tau:\n        action = 2\n    else:\n        action = 0\n    # Round rmax for cleaner output\n    rmax_out = float(np.round(rmax, 6))\n    return [checkerboard, action, rmax_out]\n\ndef solve():\n    Nx = 32\n    Ny = 32\n    # Define test cases\n    cases = []\n    cases.append(make_case_A(Nx, Ny))\n    cases.append(make_case_B(Nx, Ny))\n    cases.append(make_case_C(Nx, Ny))\n    cases.append(make_case_D(Nx, Ny))\n\n    results = []\n    for (p, u_faces, v_faces) in cases:\n        res = analyze_case(p, u_faces, v_faces, tau=0.6)\n        results.append(res)\n\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "The core SIMPLE algorithm has several variants, each designed to improve performance or robustness in specific physical regimes. In reacting flows, strong exothermic reactions can create large density variations, posing a significant challenge to the stability of the pressure-correction solver. This practice explores the trade-offs between two popular variants, SIMPLEC and SIMPLER, by analyzing how they handle the effective conductivity at the interface between high and low-density regions . By comparing the spectral radii derived from arithmetic versus harmonic averaging of properties, you will uncover why certain algorithmic choices are more robust than others for variable-density problems, highlighting the principle that the optimal numerical method is often dictated by the underlying physics.",
            "id": "4063159",
            "problem": "Consider a one-dimensional, periodic, collocated finite-volume discretization of a low-Mach-number reacting flow in which strong exothermicity produces a large density ratio between a hot zone and a cold zone. The pressure–velocity coupling is solved by algorithms from the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) family, specifically the SIMPLE-Consistent (SIMPLEC) and SIMPLE-Revised (SIMPLER) variants. Assume the following scientifically realistic setting for the pressure-correction stage:\n\n- The base state is linearized about zero velocity with a uniform diagonal momentum coefficient $a$ arising from the discretized and linearized momentum equation residual.\n- The mass flux correction at a face is modeled as proportional to the local pressure gradient with an effective conductivity $\\kappa_{f} = \\rho_{f}/a$, where $\\rho_{f}$ is the face density and $a$ is treated as spatially uniform due to linearization about the base state.\n- The domain consists of two equal subdomains with densities $\\rho_{c}$ (cold) and $\\rho_{h}$ (hot), with density ratio $r = \\rho_{h}/\\rho_{c}$, and a sharp but grid-aligned interface. This idealization is a standard model for analyzing robustness under large density ratios in variable-density pressure correction.\n- Rhie and Chow interpolation (Rhie–Chow) is used to prevent pressure checkerboarding, and the pressure correction is under-relaxed with factor $\\alpha_{p} \\in (0,1]$.\n- For a discrete Fourier mode of wavenumber $k$, the linearized amplification factor of the pressure correction iterate takes the form $g = 1 - \\alpha_{p} \\, C \\, \\kappa_{f} \\, \\sin^{2}(k \\Delta x / 2)$, where $C>0$ is a grid- and operator-dependent constant that does not depend on the averaging choice for $\\kappa_{f}$, and $\\Delta x$ is the uniform cell size.\n\nUnder these assumptions:\n- SIMPLEC uses an arithmetic average of the conductivity across the hot–cold face, $\\kappa_{A} = \\frac{1}{2}\\left(\\frac{\\rho_{c}}{a} + \\frac{\\rho_{h}}{a}\\right)$.\n- SIMPLER uses a harmonic average of the conductivity across the hot–cold face, $\\kappa_{H} = \\left( \\frac{1}{2}\\left(\\frac{a}{\\rho_{c}} + \\frac{a}{\\rho_{h}}\\right) \\right)^{-1} = \\frac{2}{a}\\,\\frac{\\rho_{c}\\rho_{h}}{\\rho_{c}+\\rho_{h}}$.\n\nThe worst-case spectral radius of the linearized iteration, $\\rho$, corresponds to the highest resolvable mode for which $\\sin^{2}(k \\Delta x/2)=1$.\n\nDefine the dimensionless relaxation strength $s = \\alpha_{p} \\, C \\, \\frac{\\rho_{c}}{a}$.\n\nDerive, from first principles starting at the variable-density continuity constraint and linearized momentum-to-pressure coupling, the closed-form expression for the ratio of worst-case spectral radii\n$$\\frac{\\rho_{\\text{SIMPLEC}}}{\\rho_{\\text{SIMPLER}}}$$\nas a function of the density ratio $r$ and the dimensionless relaxation strength $s$.\n\nYour final answer must be a single closed-form analytic expression. No numerical evaluation is required, and no units should be included in the final boxed answer. If any intermediate approximation is introduced, justify it from the stated assumptions and fundamental laws. Do not use or cite any shortcut formulas specific to these algorithms; instead, build the derivation from the continuity equation, the discretized momentum balance, and the pressure-correction mechanism they imply in the low-Mach reacting flow setting.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the established theory of computational fluid dynamics, specifically concerning pressure-velocity coupling algorithms for variable-density flows. The problem is well-posed, with all necessary parameters and relationships clearly defined, and is expressed in objective, formal language. The setup, while idealized, is a standard and meaningful test case for analyzing the robustness of numerical methods.\n\nThe derivation proceeds from the fundamental principles of the SIMPLE family of algorithms for solving the Navier-Stokes equations in the low-Mach-number regime.\n\nIn pressure-based solvers like SIMPLE, an iterative procedure is used to enforce the coupling between the velocity field $\\mathbf{u}$ and the pressure field $p$. A key step is the solution of a pressure-correction equation, which is derived from the continuity equation.\n\nThe discretized continuity equation for a control volume $P$ requires the net mass flux across its faces to be zero. If an intermediate velocity field $\\mathbf{u}^*$, calculated from the momentum equations with a temporary pressure field $p^*$, does not satisfy continuity, it produces a mass imbalance. A pressure correction $p'$ is sought to drive this imbalance to zero.\n\nThe linearized momentum equation provides a relationship between the correction to the velocity, $\\mathbf{u}'$, and the gradient of the pressure correction, $\\nabla p'$. For collocated grids, a special interpolation (like Rhie-Chow) is used to determine the face velocity correction. The problem encapsulates this relationship by stating that the mass flux correction at a face $f$ is proportional to the discrete pressure gradient:\n$$ \\delta(\\rho u)_f = - \\kappa_f \\frac{p'_{R} - p'_{L}}{\\Delta x} $$\nwhere $p'_{L}$ and $p'_{R}$ are the pressure corrections in the cells to the left and right of the face, and $\\kappa_f = \\rho_f/a$ is an effective conductivity. Here, $\\rho_f$ is the density at the face and $a$ is the uniform diagonal coefficient from the linearized momentum equation.\n\nSubstituting this flux correction into the discrete continuity equation for cell $i$ yields a sparse linear system for $p'$, which is a variable-coefficient Poisson-like equation:\n$$ \\frac{1}{\\Delta x} \\left( \\kappa_{e} \\frac{p'_{i+1} - p'_{i}}{\\Delta x} - \\kappa_{w} \\frac{p'_{i} - p'_{i-1}}{\\Delta x} \\right) = \\text{mass imbalance source term} $$\nwhere $e$ and $w$ refer to the east and west faces of the cell.\n\nThe iterative solution of this equation has a convergence behavior characterized by an amplification factor $g$ for each discrete Fourier mode of wavenumber $k$. The problem provides the functional form for this amplification factor:\n$$ g = 1 - \\alpha_{p} \\, C \\, \\kappa_{f} \\, \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) $$\nwhere $\\alpha_p$ is the pressure relaxation factor, and $C$ is a constant.\n\nThe worst-case convergence is determined by the spectral radius, $\\rho$, defined as the maximum absolute value of the amplification factor over all modes. The problem specifies that this worst case corresponds to the highest resolvable mode, where $k \\Delta x = \\pi$, for which $\\sin^2(k \\Delta x / 2) = \\sin^2(\\pi/2) = 1$. The spectral radius is therefore given by:\n$$ \\rho = \\left| g \\right|_{k \\Delta x = \\pi} = \\left| 1 - \\alpha_{p} \\, C \\, \\kappa_{f} \\right| $$\nThe value of $\\kappa_f$ to be used is that at the interface between the hot and cold subdomains, as this is where the large density jump challenges the numerical scheme. The difference between SIMPLEC and SIMPLER lies in the averaging used to calculate this interface conductivity.\n\nFirst, we analyze the SIMPLEC algorithm. It uses an arithmetic average for the conductivity:\n$$ \\kappa_A = \\frac{1}{2} \\left( \\frac{\\rho_c}{a} + \\frac{\\rho_h}{a} \\right) $$\nUsing the definition of the density ratio $r = \\rho_h / \\rho_c$, we can write $\\rho_h = r \\rho_c$.\n$$ \\kappa_A = \\frac{1}{2a} (\\rho_c + r \\rho_c) = \\frac{\\rho_c}{a} \\frac{1+r}{2} $$\nThe spectral radius for SIMPLEC is:\n$$ \\rho_{\\text{SIMPLEC}} = \\left| 1 - \\alpha_{p} \\, C \\, \\kappa_A \\right| = \\left| 1 - \\alpha_{p} \\, C \\, \\frac{\\rho_c}{a} \\frac{1+r}{2} \\right| $$\nUsing the definition of the dimensionless relaxation strength, $s = \\alpha_{p} \\, C \\, \\frac{\\rho_{c}}{a}$, we get:\n$$ \\rho_{\\text{SIMPLEC}} = \\left| 1 - s \\frac{1+r}{2} \\right| $$\n\nNext, we analyze the SIMPLER algorithm. It uses a harmonic average for the conductivity:\n$$ \\kappa_H = \\left( \\frac{1}{2} \\left[ \\left(\\frac{\\rho_c}{a}\\right)^{-1} + \\left(\\frac{\\rho_h}{a}\\right)^{-1} \\right] \\right)^{-1} = \\left( \\frac{1}{2} \\left( \\frac{a}{\\rho_c} + \\frac{a}{\\rho_h} \\right) \\right)^{-1} $$\nThis expression is given in the problem statement and can be simplified:\n$$ \\kappa_H = \\frac{2a}{\\frac{1}{\\rho_c} + \\frac{1}{\\rho_h}} = \\frac{2a}{\\frac{\\rho_h + \\rho_c}{\\rho_c \\rho_h}} = \\frac{2a \\rho_c \\rho_h}{\\rho_c + \\rho_h} $$\nWe express this in terms of the base density $\\rho_c$ and the density ratio $r$:\n$$ \\kappa_H = \\frac{2a \\rho_c (r \\rho_c)}{\\rho_c + r \\rho_c} = \\frac{2a r \\rho_c^2}{\\rho_c(1+r)} = \\frac{\\rho_c}{a} \\frac{2ar}{a(1+r)} = \\frac{\\rho_c}{a} \\frac{2r}{1+r} $$\nThe spectral radius for SIMPLER is:\n$$ \\rho_{\\text{SIMPLER}} = \\left| 1 - \\alpha_{p} \\, C \\, \\kappa_H \\right| = \\left| 1 - \\alpha_{p} \\, C \\, \\frac{\\rho_c}{a} \\frac{2r}{1+r} \\right| $$\nSubstituting the dimensionless relaxation strength $s$:\n$$ \\rho_{\\text{SIMPLER}} = \\left| 1 - s \\frac{2r}{1+r} \\right| $$\n\nFinally, we compute the ratio of the worst-case spectral radii:\n$$ \\frac{\\rho_{\\text{SIMPLEC}}}{\\rho_{\\text{SIMPLER}}} = \\frac{\\left| 1 - s \\frac{1+r}{2} \\right|}{\\left| 1 - s \\frac{2r}{1+r} \\right|} $$\nThis is the final closed-form expression for the ratio as a function of the density ratio $r$ and the dimensionless relaxation strength $s$. The absolute value signs are retained as the problem does not provide constraints on $s$ that would guarantee the arguments are positive.",
            "answer": "$$\n\\boxed{\\frac{\\left| 1 - s \\frac{1+r}{2} \\right|}{\\left| 1 - s \\frac{2r}{1+r} \\right|}}\n$$"
        }
    ]
}