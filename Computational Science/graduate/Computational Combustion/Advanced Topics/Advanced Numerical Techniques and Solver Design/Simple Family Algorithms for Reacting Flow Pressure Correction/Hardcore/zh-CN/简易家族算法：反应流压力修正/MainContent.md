## 引言
在[计算流体动力学](@entry_id:142614)（CFD）领域，特别是在模拟燃烧、化学反应等涉及显著密度变化的[复杂流动](@entry_id:747569)现象时，如何高效且准确地求解流场成为一个核心挑战。SIMPLE（Semi-Implicit Method for Pressure-Linked Equations）族算法正是在这一背景下诞生的经典数值方法，它为解决[低马赫数流动](@entry_id:751506)中的[压力-速度耦合](@entry_id:155962)问题提供了一个强大而灵活的框架。

其核心难题在于：速度场由压力梯度驱动，而压[力场](@entry_id:147325)本身又必须调整以确保速度场满足质量守恒。在密度随温度和组分剧烈变化的反应流中，这种耦合变得尤为紧密和“刚性”，给数值求解带来了巨大困难。本文旨在系统性地剖析SIMPLE族算法，填补理论知识与实际应用之间的鸿沟。

通过本文，读者将全面掌握该算法的内在机理和实践应用。在“原理与机制”一章中，我们将从基本控制方程出发，详细推导[压力修正方法](@entry_id:753705)的核心思想。接下来的“应用与跨学科关联”一章将展示该算法在[湍流](@entry_id:151300)、[自然对流](@entry_id:197869)等多个领域的扩展应用，并探讨其与其他数值方法的联系与区别。最后，“动手实践”部分将提供具体的编码和分析练习，帮助读者巩固所学知识。本文将引导您从理论基础平稳过渡到高级应用，为解决前沿科研和工程问题打下坚实的基础。

## 原理与机制

本章旨在深入探讨可变密度[反应流](@entry_id:190741)中[压力修正](@entry_id:753714)算法的核心原理与实现机制。我们将从[低马赫数流动](@entry_id:751506)控制方程出发，揭示[压力-速度耦合](@entry_id:155962)的根本挑战，并系统性地构建SIMPLE（Semi-Implicit Method for Pressure-Linked Equations）族算法的理论框架。通过对算法关键步骤的剖析，我们将阐明在强热[化学耦合](@entry_id:138976)下，如何通过[压力修正](@entry_id:753714)来严格保证质量守恒，并介绍SIMPLE、SIMPLEC和SIMPLER等主要算法变体之间的区别与联系。

### [低马赫数反应流](@entry_id:1127483)的控制方程

在[计算燃烧学](@entry_id:1122776)中，许多实际应用场景（如低速[火焰传播](@entry_id:1125066)、工业燃烧炉）的流速远小于声速，即马赫数 $M \ll 1$。在这种情况下，流场中的压力可以分解为一个空间均匀的[热力学](@entry_id:172368)背景压力 $p_0(t)$ 和一个动态的、空间变化的流体动力学压力扰动 $\pi(\mathbf{x}, t)$。[总压](@entry_id:265293)力 $p(\mathbf{x},t) = p_0(t) + \pi(\mathbf{x},t)$，其中 $\pi$ 相对于 $p_0$ 是一个小量。这种[低马赫数近似](@entry_id:1127479)有效地滤除了声波，允许使用更大的时间步长来捕捉流体力学和化学反应的时间尺度。

一个多组分反应混合物的[低马赫数流动](@entry_id:751506)由一组守恒型[偏微分](@entry_id:194612)方程描述。这些方程构成了压力修正算法求解的基础 。

**1. [质量守恒](@entry_id:204015)方程（[连续性方程](@entry_id:195013)）**
对于混合物整体，总质量是守恒的。化学反应会改变组分，但不会产生或湮灭总质量。因此，连续性方程为：
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0
$$
其中 $\rho$ 是混合物密度，$\mathbf{u}$ 是[质量平均速度](@entry_id:149575)。

**2. 组分[质量守恒](@entry_id:204015)方程**
对于混合物中的每一种组分 $k$（共 $N_s$ 种），其[质量守恒](@entry_id:204015)方程为：
$$
\frac{\partial (\rho Y_k)}{\partial t} + \nabla \cdot (\rho \mathbf{u} Y_k) = -\nabla \cdot \mathbf{J}_k + \dot{\omega}_k, \quad k=1, \dots, N_s
$$
这里，$Y_k$ 是组分 $k$ 的质量分数，$\mathbf{J}_k$ 是组分 $k$ 的扩散质量通量，$\dot{\omega}_k$ 是由化学反应引起的组分 $k$ 的单位体积[质量生成](@entry_id:161427)率。根据[质量守恒定律](@entry_id:147377)，所有组分的[扩散通量](@entry_id:748422)之和为零（$\sum_{k=1}^{N_s} \mathbf{J}_k = \mathbf{0}$），化学反应的总[质量生成](@entry_id:161427)率为零（$\sum_{k=1}^{N_s} \dot{\omega}_k = 0$）。将所有组分方程相加，即可恢复到混合物的总[质量守恒](@entry_id:204015)方程 。

**3. [动量守恒](@entry_id:149964)方程**
根据牛顿第二定律，流体的动量变化率等于作用在其上的力的总和。在[低马赫数近似](@entry_id:1127479)下，动量方程中的压力梯度项由[流体动力](@entry_id:750449)学压力扰动 $\pi$ 主导：
$$
\frac{\partial (\rho \mathbf{u})}{\partial t} + \nabla \cdot (\rho \mathbf{u} \mathbf{u}) = -\nabla \pi + \nabla \cdot \boldsymbol{\tau} + \rho \mathbf{g}
$$
其中 $\boldsymbol{\tau}$ 是[粘性应力](@entry_id:261328)张量，$\rho \mathbf{g}$ 是单位体积的体力（如重力）。对于牛顿流体，$\boldsymbol{\tau} = \mu \left[ \nabla \mathbf{u} + (\nabla \mathbf{u})^{\top} \right] - \frac{2}{3} \mu (\nabla \cdot \mathbf{u}) \mathbf{I}$，其中 $\mu$ 是[动力粘度](@entry_id:268228)。

**4. [能量守恒方程](@entry_id:748978)（显焓形式）**
能量守恒通常以焓或温度的形式表示。对于显焓 $h_s = \sum_k Y_k h_{s,k}$（其中 $h_{s,k}$ 是组分 $k$ 的显焓），其[输运方程](@entry_id:174281)为：
$$
\frac{\partial (\rho h_s)}{\partial t} + \nabla \cdot (\rho \mathbf{u} h_s) = \frac{d p_0}{d t} + \nabla \cdot (\lambda \nabla T) - \nabla \cdot \left( \sum_{k=1}^{N_s} h_{s,k} \mathbf{J}_k \right) + \Phi + \dot{q}_r
$$
该方程右侧各项分别代表：背景压力的时间变化所做的功（$\frac{d p_0}{d t}$）、[热传导](@entry_id:143509)（$\lambda$ 为导热系数）、与组分扩散相关的能量输运、粘性耗散产生的热量（$\Phi = \boldsymbol{\tau} : \nabla \mathbf{u}$）以及其他热源（如辐射 $\dot{q}_r$）。

**5. 状态方程**
这些方程还需要一个状态方程来封闭。对于[理想气体混合物](@entry_id:149212)，密度 $\rho$ 与温度 $T$、组分 $Y_k$ 和背景压力 $p_0$ 相关：
$$
\rho = \frac{p_0 W_{\text{mix}}}{R_u T}, \quad \text{其中} \quad W_{\text{mix}} = \left( \sum_{k=1}^{N_s} \frac{Y_k}{W_k} \right)^{-1}
$$
这里 $R_u$ 是[通用气体常数](@entry_id:136843)，$W_k$ 是组分 $k$ 的摩尔质量，$W_{\text{mix}}$ 是混合物的平均摩尔质量。

### 压力-速度耦合的根本挑战

在求解上述方程组时，一个核心的数值挑战是压力和速度的耦合。[动量方程](@entry_id:197225)包含的是压力的梯度 $\nabla \pi$，而不是压力本身。这意味着仅凭动量方程无法唯一确定压[力场](@entry_id:147325)（只能确定到一个任意常数）。更重要的是，即使我们能以某种方式求解[动量方程](@entry_id:197225)得到一个速度场，这个速度场也无法自动满足[质量守恒](@entry_id:204015)方程（连续性方程）的约束 。

对于[可变密度流](@entry_id:756427)，我们可以通过对[连续性方程](@entry_id:195013)进行变换来揭示速度场必须满足的运动学约束：
$$
\frac{D \rho}{D t} + \rho (\nabla \cdot \mathbf{u}) = 0 \quad \implies \quad \nabla \cdot \mathbf{u} = -\frac{1}{\rho} \frac{D \rho}{D t}
$$
其中 $\frac{D}{Dt} = \frac{\partial}{\partial t} + \mathbf{u} \cdot \nabla$ 是[物质导数](@entry_id:262900)。这个关系表明，在密度变化的流动中（例如，由于火焰中的剧烈热释放），速度场不再是[无散度](@entry_id:190991)（divergence-free）的。其散度 $S_{\text{dil}} = -\frac{1}{\rho} \frac{D \rho}{D t}$ 由密度的物质变化率决定，这在反应流中主要是由[热化学](@entry_id:137688)过程驱动的。

因此，[流体动力](@entry_id:750449)学压力 $\pi$ 的真正作用，可以被理解为一个拉格朗日乘子，其[梯度场](@entry_id:264143) $\nabla \pi$ 必须调整到恰当的形态，以驱动速度场 $\mathbf{u}$ 精确地满足上述散度约束。[动量方程](@entry_id:197225)和[连续性方程](@entry_id:195013)之间这种“速度中出现压力梯度，压力为满足[连续性方程](@entry_id:195013)而存在”的隐式耦合关系，是所有不可压缩和[低马赫数流](@entry_id:1127481)求解算法必须解决的核心问题。

### [压力修正方法](@entry_id:753705)：一个椭圆型约束

为了解决[压力-速度耦合](@entry_id:155962)问题，SIMPLE族算法采用了一种“预测-修正”的迭代策略。其基本思想是：

1.  **预测**：利用上一时刻或上一次迭代的压[力场](@entry_id:147325) $p^*$（或 $\pi^*$），求解动量方程，得到一个临时的、不满足[连续性方程](@entry_id:195013)的速度场，称为**预测速度** $\mathbf{u}^*$。
2.  **修正**：引入[压力修正](@entry_id:753714)量 $p'$ 和速度修正量 $\mathbf{u}'$，使得修正后的压力 $p = p^* + p'$ 和速度 $\mathbf{u} = \mathbf{u}^* + \mathbf{u}'$ 能够同时满足[动量方程](@entry_id:197225)和连续性方程。

从[动量方程](@entry_id:197225)的离散形式可以推导出速度修正量与[压力修正](@entry_id:753714)量之间的近似关系：
$$
\mathbf{u}' \approx - d \nabla p'
$$
其中 $d$ 是一个正系数，与动量方程的离散化系数有关。这个关系表明，[压力修正](@entry_id:753714)量的梯度驱动了速度的修正。

接下来，我们将修正后的速度 $\mathbf{u}$ 代入连续性方程并要求其成立：
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0 \implies \frac{\partial \rho}{\partial t} + \nabla \cdot (\rho (\mathbf{u}^* + \mathbf{u}')) = 0
$$
将 $\mathbf{u}'$ 的关系代入，得到：
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}^*) - \nabla \cdot (\rho d \nabla p') = 0
$$
整理后，我们得到一个关于压力修正量 $p'$ 的方程：
$$
\nabla \cdot (\rho d \nabla p') = \frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}^*)
$$
这是一个**泊松方程（Poisson-type equation）**。它的数学性质是**椭圆型**的 。这意味着，在任意一点的压力修正值 $p'$ 都受到整个计算域的边界条件和源项（即右侧的质量不平衡项）的全局影响。这与[低马赫数流动](@entry_id:751506)中压力扰动以无限大速度传播的物理图像是一致的。

值得注意的是，即使在包含 $\frac{\partial \rho}{\partial t}$ 项的瞬态[可变密度流](@entry_id:756427)中，该方程的性质仍然是椭圆型的。因为在求解该方程时，$\rho$ 是由温度和组分决定的（通过状态方程），而温度和组分由其自身的[输运方程](@entry_id:174281)控制。在分离求解的算法中，$\frac{\partial \rho}{\partial t}$ 项是根据前一时刻或前一次迭代的已知状态计算的，因此它充当一个已知的源项，而不是未知变量 $p'$ 的时间导数。这澄清了一个常见的误解，即认为该项会使方程变为抛物线型 。

### [压力修正方程](@entry_id:156602)的构成

在[有限体积法](@entry_id:141374)中，[压力修正方程](@entry_id:156602)的右端项（源项）代表了预测速度场在每个控制单元中造成的离散质量不平衡。

对于一个体积为 $V_P$ 的控制单元 $P$，其离散的质量守恒方程（采用一阶向后欧拉时间格式）为：
$$
\frac{(\rho_P^{n+1} - \rho_P^n)V_P}{\Delta t} + \sum_{f \in \partial P} \dot{m}_f^{n+1} = 0
$$
其中 $\dot{m}_f$ 是通过面 $f$ 的质量通量。如果使用预测速度 $\mathbf{u}^*$ 和更新后的密度 $\rho^{n+1}$ 计算出的预测质量通量 $\dot{m}_f^*$ 不满足这个方程，就会产生一个质量残差 $r_m(P)$：
$$
r_m(P) \equiv \frac{(\rho_P^{n+1} - \rho_P^n)V_P}{\Delta t} + \sum_{f \in \partial P} \dot{m}_f^* \neq 0
$$
这个非零的质量残差 $r_m(P)$ 就是压力修正泊松方程的离散源项。压力修正步骤的目标就是求解 $p'$，并用其修正速度场和质量通量，从而使每个控制单元的质量残差趋于零 。

在反应流模拟中，如果压力-速度耦合处理不当，持续存在的非零质量残差相当于在控制单元中引入了虚假的质量源或汇。这会扭曲由热释放引起的真实密度变化所要求的局部[速度散度](@entry_id:264117)场，从而导致对[火焰传播](@entry_id:1125066)速度和燃烧区域的错误预测，并可能在并置网格上引发[棋盘格压力](@entry_id:164851)振荡等非物理现象 。

对于瞬态问题，$\frac{\partial \rho}{\partial t}$ 项的处理至关重要 。
*   **滞后处理（Lagged Treatment）**：在求解[压力修正方程](@entry_id:156602)时，使用前一时间步或前一内迭代步的密度来计算该项。当时间步长 $\Delta t$ 远小于化学和热特征时间，或热释放较弱，密度变化不剧烈时，这种显式处理是可接受的，可以简化计算。
*   **迭代处理（Iterated Treatment）**：当密度变化显著时（例如，强放热反应或较大的时间步长），必须在[压力-速度耦合](@entry_id:155962)循环中迭代更新密度。这通常通过外循环实现：求解流动场 -> 求解[标量场](@entry_id:151443)（温度、组分） -> 更新密度 -> 重复该过程直到收敛。这种隐式处理对于保证强耦合问题的[数值稳定性](@entry_id:175146)和[质量守恒](@entry_id:204015)至关重要。

### 完整算法流程：分离求解法

一个典型的基于SIMPLE族算法的[反应流](@entry_id:190741)求解器，在一个时间步内的完[整流](@entry_id:197363)程如下 ：

1.  **初始化与动量预测**：使用旧时间步 $n$ 的场（$\rho^n, \mathbf{u}^n, T^n, Y_k^n$）和压[力场](@entry_id:147325) $p^n$，求解离散的[动量方程](@entry_id:197225)，得到预测速度场 $\mathbf{u}^*$。

2.  **[压力修正](@entry_id:753714)与速度修正**：
    *   利用 $\mathbf{u}^*$ 计算预测质量通量 $\tilde{m}_f$。在并置网格上，必须使用Rhie-Chow类型的插值来避免[压力-速度解耦](@entry_id:167545)。
    *   组建并求解关于压力修正量 $p'$ 的泊松方程，其源项为基于 $\tilde{m}_f$ 和滞后密度计算的质量残差。
    *   用求得的 $p'$ 修正压力、速度和质量通量，得到满足当前密度场下连续性方程的场 $(\mathbf{u}^{(1)}, \dot{m}_f^{(1)})$。

3.  **[标量输运方程](@entry_id:1131253)求解**：
    *   **关键步骤**：必须使用上一步得到的、满足质量守恒的质量通量 $\dot{m}_f^{(1)}$ 来对流标量（组分、焓等）。这是保证整个计算过程守恒性的核心。
    *   求解[组分输运方程](@entry_id:1132067)，得到新的组分质量分数场 $Y_k^{n+1}$ 。
    *   求解能量方程（或焓方程），得到新的温度场 $T^{n+1}$ 。在离散焓方程时，必须采用守恒形式，例如，对流项应为 $\dot{m}_f^{\text{PC}} h_{s,f}$，瞬态项应为 $\frac{(\rho h_s)^{n+1} - (\rho h_s)^n}{\Delta t}$，以确保能量的[离散守恒](@entry_id:1123819)。

4.  **物性更新与耦合反馈**：
    *   根据新的组分场 $Y_k^{n+1}$，计算新的混合物平均[摩尔质量](@entry_id:146110) $W_{\text{mix}}^{n+1}$。
    *   利用状态方程，根据新的温度 $T^{n+1}$、平均摩尔质量 $W_{\text{mix}}^{n+1}$ 和压力 $p^{(1)}$，更新密度场至 $\rho^{n+1}$。
    *   这个新密度 $\rho^{n+1}$ 将被用于下一个内迭代步或外迭代步的[连续性方程](@entry_id:195013)中，形成了从标量场到流场（通过密度）的强[耦合反馈回路](@entry_id:201759) 。

5.  **迭代与收敛**：由于密度场发生了变化，步骤2中得到的流场可能不再严格满足包含新密度时间变化率的连续性方程。因此，通常需要重复步骤2-4（作为外循环），直到所有变量（速度、压力、温度、组分、密度）都收敛到当前时间步的解。对于瞬态问题，这种包含多次修正的结构演变成了PISO（Pressure Implicit with Splitting of Operators）算法的思想。

### 算法变体：SIMPLE, SIMPLEC, SIMPLER

最初的SIMPLE算法只是众多[压力修正方法](@entry_id:753705)中的一种。为了改善其收敛性，后续发展出了多种变体，其中最著名的是SIMPLEC和SIMPLER 。它们的区别主要在于对速度[修正方程](@entry_id:173454)的不同处理方式，这直接影响了[压力-速度耦合](@entry_id:155962)的强度。

回顾速度修正量 $\mathbf{u}'$ 和压力修正量 $p'$ 之间的精确关系：
$$
a_P \mathbf{u}'_P = \sum_{N} a_N \mathbf{u}'_N - V_P \nabla p'_P
$$
其中 $a_P$ 是[动量方程](@entry_id:197225)离散后中心节点的系数， $a_N$ 是相邻节点的系数。

*   **SIMPLE**: 该算法做了最激进的简化，完全忽略了相邻速度修正的影响，即假设 $\sum_N a_N \mathbf{u}'_N \approx 0$。这导致了速度修正公式：
    $$
    \mathbf{u}'_P = - \frac{V_P}{a_P} \nabla p'_P
    $$
    这种简化使得[压力-速度耦合](@entry_id:155962)偏弱，通常需要配合较小的欠[松弛因子](@entry_id:1130825)才能[稳定收敛](@entry_id:199422)。

*   **SIMPLEC (SIMPLE-Consistent)**: 该算法试图对被忽略的项做出更合理的近似。它假设相邻节点的修正量与中心节点的修正量大致相同，即 $\mathbf{u}'_N \approx \mathbf{u}'_P$。代入原式并整理后得到：
    $$
    \mathbf{u}'_P = - \frac{V_P}{a_P - \sum_N a_N} \nabla p'_P
    $$
    由于 $a_P - \sum_N a_N$ 通常小于 $a_P$，对于相同的[压力修正](@entry_id:753714) $p'$，SIMPLEC产生的速度修正量 $\mathbf{u}'_P$ 更大。这增强了[压力-速度耦合](@entry_id:155962)，从而加速了收敛，允许使用更大的欠[松弛因子](@entry_id:1130825)。

*   **SIMPLER (SIMPLE-Revised)**: 该算法采用了完全不同的策略。它不求解[压力修正](@entry_id:753714)量，而是直接求解一个更优的压[力场](@entry_id:147325) $p$。
    1.  首先，求解一个不含压力梯度的动量方程，得到一个“伪速度”场 $\hat{\mathbf{u}}$。
    2.  然后，建立一个关于**真实压[力场](@entry_id:147325) $p$** 的泊松方程。该方程的源项由伪速度场的散度（即质量不平衡）构成。
    3.  求解该压力方程得到压[力场](@entry_id:147325) $p$。
    4.  最后，将这个求得的压[力场](@entry_id:147325)代入完整的[动量方程](@entry_id:197225)，求解最终的速度场 $\mathbf{u}$。
    SIMPLER通过构造一个更准确的压力方程，使得压[力场](@entry_id:147325)的求解与速度场的求解更加分离，通常表现出比SIMPLE和SIMPLEC更好的收敛性和鲁棒性，但每个迭代步的计算量也更大。

在可变密度反应流中，所有这些算法的压力（或压力修正）方程都必须包含由密度变化引起的瞬态项和对流项，通过密度 $\rho$ 将热化学过程与流[体力](@entry_id:174230)学紧密耦合在一起。从SIMPLE到SIMPLEC再到SIMPLER，算法对[压力-速度耦合](@entry_id:155962)的处理越来越精细，鲁棒性也随之增强。