{
    "hands_on_practices": [
        {
            "introduction": "制造解方法（MMS）的基础在于，通过引入一个源项，迫使一个我们选定的人工解析函数成为控制方程的精确解。第一个实践将直接应用此原理，要求您为可压缩流动的连续性方程推导所需的人工源项 。掌握这项基本技能是构建综合性验证测试的第一步。",
            "id": "4064345",
            "problem": "考虑一个在具有光滑边界 $\\partial \\Omega$ 的单连通域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的二维、可压缩、单相混合物反应流。其控制原理是总混合物质量守恒：任何物质控制体内总质量的时间变化率等于通过边界的净质量通量，加上由于建模（用于验证）或外部质量注入而产生的任何体积质量源。假设场是光滑的，并忽略任何奇异源，因此到局部（微分）形式的常规转换是有效的。在人工解方法（Method of Manufactured Solutions, MMS）中，人们选择解析场并推导出一个强迫项，使得这些场能够精确满足控制方程。设人工制造的密度和速度为\n$$\n\\rho(x,y,t) = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right],\n$$\n$$\nu(x,y,t) = U_{0}\\,\\cos(\\alpha x)\\,\\sin(\\beta y)\\,\\exp(\\mu t), \\quad v(x,y,t) = V_{0}\\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\nu t),\n$$\n其中 $(x,y)\\in\\Omega$, $t\\ge 0$, $\\rho_{0}>0$, $a\\in(0,1)$, $\\alpha>0$, $\\beta>0$，且 $U_{0}$, $V_{0}$, $\\lambda$, $\\mu$, $\\nu$ 是实常数。定义速度矢量为 $\\mathbf{u}=(u,v)$。从质量守恒的积分表述出发，并推导至其局部微分形式，为连续性方程推导MMS源项 $S_{\\rho}(x,y,t)$，该源项强制上述的 $\\rho(x,y,t)$ 和 $\\mathbf{u}(x,y,t)$ 成为可压缩连续性方程的精确解。以 $x$、$y$、$t$ 及给定常数的形式，明确计算 $S_{\\rho}(x,y,t)$ 的闭式表达式。然后，解释当这些人工制造的场被代入时，所推导出的 $S_{\\rho}$ 如何在可压缩求解器中强制实现精确平衡。你的最终答案必须是 $S_{\\rho}(x,y,t)$ 的单一闭式解析表达式。不需要进行数值计算。",
            "solution": "该问题是有效的，因为它科学地基于流体动力学原理和人工解方法（MMS），后者是计算科学中的一种标准验证技术。该问题是适定的、客观的且自洽的，所有必要的场和常数都已定义，从而可以对源项进行唯一的解析推导。\n\n目标是找到源项 $S_{\\rho}(x,y,t)$，它使得给定的密度人工场 $\\rho(x,y,t)$ 和速度人工场 $\\mathbf{u}(x,y,t)$ 成为可压缩连续性方程的精确解。带有源项的连续性方程的局部微分形式为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}\n$$\n在二维笛卡尔坐标系中，该方程表示为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\partial (\\rho v)}{\\partial y} = S_{\\rho}\n$$\n根据MMS的定义，源项 $S_{\\rho}$ 是将人工制造的场代入方程左侧得到的结果。我们将逐项进行计算。\n\n给定的人工制造场为：\n$$\n\\rho(x,y,t) = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right]\n$$\n$$\nu(x,y,t) = U_{0}\\,\\cos(\\alpha x)\\,\\sin(\\beta y)\\,\\exp(\\mu t)\n$$\n$$\nv(x,y,t) = V_{0}\\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\nu t)\n$$\n\n首先，我们计算密度的时间导数 $\\frac{\\partial \\rho}{\\partial t}$：\n$$\n\\frac{\\partial \\rho}{\\partial t} = \\frac{\\partial}{\\partial t} \\left( \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right] \\right)\n$$\n$$\n\\frac{\\partial \\rho}{\\partial t} = \\rho_{0} \\left[ a \\,\\sin(\\alpha x)\\,\\cos(\\beta y) \\cdot \\lambda \\exp(\\lambda t) \\right]\n$$\n$$\n\\frac{\\partial \\rho}{\\partial t} = \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y)\n$$\n\n接下来，我们计算质量通量的散度 $\\nabla \\cdot (\\rho \\mathbf{u}) = \\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\partial (\\rho v)}{\\partial y}$。\n\n我们从质量通量的 $x$ 分量 $\\rho u$ 开始：\n$$\n\\rho u = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right] \\cdot U_{0}\\,\\cos(\\alpha x)\\,\\sin(\\beta y)\\,\\exp(\\mu t)\n$$\n$$\n\\rho u = \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\beta y) \\left[ \\cos(\\alpha x) + a \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\alpha x)\\cos(\\beta y) \\right]\n$$\n现在，我们对 $x$ 求导：\n$$\n\\frac{\\partial (\\rho u)}{\\partial x} = \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\beta y) \\frac{\\partial}{\\partial x} \\left[ \\cos(\\alpha x) + a \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\alpha x)\\cos(\\beta y) \\right]\n$$\n使用导数公式 $\\frac{d}{d\\theta}(\\cos A\\theta) = -A\\sin A\\theta$ 和 $\\frac{d}{d\\theta}(\\sin A\\theta \\cos A\\theta) = \\frac{d}{d\\theta}(\\frac{1}{2}\\sin 2A\\theta) = A\\cos 2A\\theta$，我们得到：\n$$\n\\frac{\\partial (\\rho u)}{\\partial x} = \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\beta y) \\left[ -\\alpha \\sin(\\alpha x) + a \\exp(\\lambda t) (\\alpha \\cos(2\\alpha x))\\cos(\\beta y) \\right]\n$$\n$$\n\\frac{\\partial (\\rho u)}{\\partial x} = -\\alpha \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\alpha x) \\sin(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y)\n$$\n\n接下来，我们计算质量通量的 $y$ 分量 $\\rho v$：\n$$\n\\rho v = \\rho_{0} \\left[ 1 + a \\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\lambda t) \\right] \\cdot V_{0}\\,\\sin(\\alpha x)\\,\\cos(\\beta y)\\,\\exp(\\nu t)\n$$\n$$\n\\rho v = \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\left[ \\cos(\\beta y) + a \\exp(\\lambda t) \\sin(\\alpha x) \\cos^{2}(\\beta y) \\right]\n$$\n现在，我们对 $y$ 求导：\n$$\n\\frac{\\partial (\\rho v)}{\\partial y} = \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\frac{\\partial}{\\partial y} \\left[ \\cos(\\beta y) + a \\exp(\\lambda t) \\sin(\\alpha x) \\cos^{2}(\\beta y) \\right]\n$$\n使用导数公式 $\\frac{d}{d\\theta}(\\cos A\\theta) = -A\\sin A\\theta$ 和 $\\frac{d}{d\\theta}(\\cos^2 A\\theta) = 2\\cos A\\theta(-A\\sin A\\theta) = -A\\sin 2A\\theta$，我们得到：\n$$\n\\frac{\\partial (\\rho v)}{\\partial y} = \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\left[ -\\beta \\sin(\\beta y) + a \\exp(\\lambda t) \\sin(\\alpha x) (-\\beta \\sin(2\\beta y)) \\right]\n$$\n$$\n\\frac{\\partial (\\rho v)}{\\partial y} = -\\beta \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\sin(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y)\n$$\n\n最后，我们将所有项相加，得到源项 $S_{\\rho}(x,y,t)$：\n$$\nS_{\\rho}(x,y,t) = \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\partial (\\rho v)}{\\partial y}\n$$\n$$\nS_{\\rho}(x,y,t) = \\left( \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y) \\right)\n$$\n$$\n+ \\left( -\\alpha \\rho_{0} U_{0} \\exp(\\mu t) \\sin(\\alpha x) \\sin(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y) \\right)\n$$\n$$\n+ \\left( -\\beta \\rho_{0} V_{0} \\exp(\\nu t) \\sin(\\alpha x) \\sin(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y) \\right)\n$$\n对各项进行分组可以得到一个结构更清晰的表达式：\n$$\nS_{\\rho}(x,y,t) = -\\rho_{0} (\\alpha U_{0} \\exp(\\mu t) + \\beta V_{0} \\exp(\\nu t)) \\sin(\\alpha x) \\sin(\\beta y) + \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y)\n$$\n这就是所需源项的闭式解析表达式。\n\n在求解器验证的背景下，数值代码会对 方程 $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}$进行离散化。在所有网格点上指定人工制造的场 $\\rho(x,y,t)$ 和 $\\mathbf{u}(x,y,t)$，以及解析推导的源项 $S_{\\rho}(x,y,t)$。然后，代码计算方程左侧的数值近似值，我们可称之为 $L_h$。计算得到的 $L_h$ 与所提供的源项 $S_{\\rho}$ 之间的差值即为求解器的离散误差。根据设计，对于带有推导源项的连续偏微分方程，人工制造的场是其精确解。因此，随着网格和时间步长的细化，该误差 $||L_h - S_{\\rho}||$ 必须以与数值方法的理论精度阶一致的速率减小。这个过程验证了求解器正确地实现了由连续性方程所代表的物理过程。",
            "answer": "$$\n\\boxed{-\\rho_{0} (\\alpha U_{0} \\exp(\\mu t) + \\beta V_{0} \\exp(\\nu t)) \\sin(\\alpha x) \\sin(\\beta y) + \\lambda a \\rho_{0} \\exp(\\lambda t) \\sin(\\alpha x)\\cos(\\beta y) + a \\alpha \\rho_{0} U_{0} \\exp((\\lambda+\\mu)t) \\cos(2\\alpha x) \\sin(\\beta y) \\cos(\\beta y) - a \\beta \\rho_{0} V_{0} \\exp((\\lambda+\\nu)t) \\sin^{2}(\\alpha x) \\sin(2\\beta y)}\n$$"
        },
        {
            "introduction": "现实世界中的计算流体力学求解器很少只求解一个方程，它们通常处理复杂的耦合输运现象系统。本练习在前一个练习的基础上，将MMS应用于一个代表二元混合物的耦合系统，该系统包括组分和能量的输运方程 。通过这个实践，您将学习如何推导一组一致的源项，以验证代码中不同物理模型之间的相互作用。",
            "id": "4064325",
            "problem": "考虑使用制造解方法（MMS）来验证计算燃烧学中的一个反应流求解器。一个由两种组分构成的二元混合物被建模，其具有恒定的混合物密度 $\\rho$、恒定的粘度（此处未明确使用）、用于混合物平均扩散的恒定质量扩散系数 $D$、恒定的热导率 $k$ 以及恒定的定压比热容 $c_{p}$。忽略化学反应（对于 $k = 1,2$，$\\omega_{k} = 0$）、杜福尔（Dufour）效应和索雷（Soret）效应，并假设各组分比热容相等，从而使得 $\\sum_{k} h_{k} \\mathbf{J}_{k}$ 为零，其中 $h_{k} = c_{p} T$。需要验证的稳态守恒方程如下：\n- 质量（连续性）：$\\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}$。\n- 组分 $k$（守恒形式）：$\\nabla \\cdot (\\rho Y_{k} \\mathbf{u} + \\mathbf{J}_{k}) = S_{k}$，对于 $k = 1,2$，其中混合物平均扩散通量为 $\\mathbf{J}_{1} = - \\rho D \\nabla Y_{1}$ 且 $\\mathbf{J}_{2} = - \\mathbf{J}_{1}$。\n- 热能（守恒焓形式）：$\\nabla \\cdot (\\rho c_{p} T \\mathbf{u}) = \\nabla \\cdot (k \\nabla T) + S_{T}$。\n\n在一个二维周期性域中，坐标为 $(x,y)$，制造场被规定为\n$$\n\\mathbf{u}(x,y) = \\big( U_{0} \\sin x \\cos y, \\, V_{0} \\cos x \\sin y \\big), \\quad\nT(x,y) = T_{0} + \\epsilon \\sin x \\sin y,\n$$\n$$\nY_{1}(x,y) = Y_{10} + \\epsilon \\cos x, \\quad Y_{2}(x,y) = 1 - Y_{1}(x,y),\n$$\n其中 $U_{0}$、$V_{0}$、$T_{0}$、$Y_{10}$、$\\epsilon$、$\\rho$、$D$、$k$ 和 $c_{p}$ 均为常数。从所述的守恒定律和混合物平均扩散模型出发，推导稳态MMS源项 $S_{\\rho}$、$S_{1}$、$S_{2}$ 和 $S_{T}$，使规定的场成为相应方程的精确解。你的推导必须仅基于给定的方程和标准的矢量微积分恒等式。将最终答案表示为关于 $x$、$y$ 和所列常数的封闭形式解析表达式。无需四舍五入。将你的最终答案以 $\\big[S_{\\rho}, \\, S_{1}, \\, S_{2}, \\, S_{T}\\big]$ 的顺序表示为单个行矩阵。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个计算流体力学中适定的问题，具体涉及用于代码验证的制造解方法（MMS）。所有必要的方程、场和常数均已提供，不存在内部矛盾或科学谬误。我们可以继续推导源项。\n\n目标是找到源项 $S_{\\rho}$、$S_{1}$、$S_{2}$ 和 $S_{T}$，使得预设的制造场成为给定稳态守恒方程的精确解。这通过将给定的速度场 $\\mathbf{u}$、温度场 $T$ 和质量分数场 $Y_1$ 代入控制方程并计算所得表达式来实现。\n\n制造场为：\n$$\n\\mathbf{u}(x,y) = \\begin{pmatrix} u \\\\ v \\end{pmatrix} = \\begin{pmatrix} U_{0} \\sin x \\cos y \\\\ V_{0} \\cos x \\sin y \\end{pmatrix}\n$$\n$$\nT(x,y) = T_{0} + \\epsilon \\sin x \\sin y\n$$\n$$\nY_{1}(x,y) = Y_{10} + \\epsilon \\cos x\n$$\n$$\nY_{2}(x,y) = 1 - Y_{1}(x,y) = 1 - Y_{10} - \\epsilon \\cos x\n$$\n所有参数 $\\rho$、$D$、$k$、$c_p$、$U_0$、$V_0$、$T_0$、$Y_{10}$ 和 $\\epsilon$ 均为常数。\n\n我们将逐个计算每个源项。\n\n**1. 质量源项 ($S_{\\rho}$)**\n\n质量守恒（连续性）方程为：\n$$\nS_{\\rho} = \\nabla \\cdot (\\rho \\mathbf{u})\n$$\n由于密度 $\\rho$ 是常数，我们可以写成：\n$$\nS_{\\rho} = \\rho (\\nabla \\cdot \\mathbf{u}) = \\rho \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right)\n$$\n我们计算速度分量的偏导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}(U_{0} \\sin x \\cos y) = U_{0} \\cos x \\cos y\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y}(V_{0} \\cos x \\sin y) = V_{0} \\cos x \\cos y\n$$\n将这些代入 $S_{\\rho}$ 的表达式中：\n$$\nS_{\\rho} = \\rho (U_{0} \\cos x \\cos y + V_{0} \\cos x \\cos y) = \\rho (U_{0} + V_{0}) \\cos x \\cos y\n$$\n\n**2. 组分源项 ($S_{1}$)**\n\n组分1的守恒方程为：\n$$\nS_{1} = \\nabla \\cdot (\\rho Y_{1} \\mathbf{u} + \\mathbf{J}_{1})\n$$\n扩散通量由 $\\mathbf{J}_{1} = - \\rho D \\nabla Y_{1}$ 给出。将其代入组分方程：\n$$\nS_{1} = \\nabla \\cdot (\\rho Y_{1} \\mathbf{u} - \\rho D \\nabla Y_{1})\n$$\n由于 $\\rho$ 和 $D$ 是常数：\n$$\nS_{1} = \\rho \\left[ \\nabla \\cdot (Y_{1} \\mathbf{u}) - D \\nabla \\cdot (\\nabla Y_{1}) \\right] = \\rho \\left[ \\nabla \\cdot (Y_{1} \\mathbf{u}) - D \\nabla^{2} Y_{1} \\right]\n$$\n使用矢量恒等式 $\\nabla \\cdot (f \\mathbf{A}) = f (\\nabla \\cdot \\mathbf{A}) + \\mathbf{A} \\cdot (\\nabla f)$，我们展开对流项：\n$$\n\\nabla \\cdot (Y_{1} \\mathbf{u}) = Y_{1} (\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot (\\nabla Y_{1})\n$$\n我们已经求得 $\\nabla \\cdot \\mathbf{u} = (U_{0} + V_{0}) \\cos x \\cos y$。接下来，我们求 $Y_{1}$ 的梯度：\n$$\n\\nabla Y_{1} = \\left( \\frac{\\partial Y_{1}}{\\partial x}, \\frac{\\partial Y_{1}}{\\partial y} \\right) = \\left( \\frac{\\partial}{\\partial x}(Y_{10} + \\epsilon \\cos x), \\frac{\\partial}{\\partial y}(Y_{10} + \\epsilon \\cos x) \\right) = (-\\epsilon \\sin x, 0)\n$$\n现在我们计算平流项 $\\mathbf{u} \\cdot \\nabla Y_{1}$：\n$$\n\\mathbf{u} \\cdot \\nabla Y_{1} = (U_{0} \\sin x \\cos y)(-\\epsilon \\sin x) + (V_{0} \\cos x \\sin y)(0) = -U_{0} \\epsilon \\sin^{2} x \\cos y\n$$\n接下来，我们计算 $Y_1$ 的拉普拉斯算子 $\\nabla^{2} Y_{1}$：\n$$\n\\nabla^{2} Y_{1} = \\frac{\\partial^{2} Y_{1}}{\\partial x^{2}} + \\frac{\\partial^{2} Y_{1}}{\\partial y^{2}} = \\frac{\\partial}{\\partial x}(-\\epsilon \\sin x) + 0 = -\\epsilon \\cos x\n$$\n现在，我们整合所有部分得到 $S_{1}$：\n$$\nS_{1} = \\rho \\left[ Y_{1} (\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot \\nabla Y_{1} - D \\nabla^{2} Y_{1} \\right]\n$$\n$$\nS_{1} = \\rho \\left[ (Y_{10} + \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y - U_{0} \\epsilon \\sin^{2} x \\cos y - D(-\\epsilon \\cos x) \\right]\n$$\n$$\nS_{1} = \\rho \\left[ (Y_{10} + \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y - U_{0} \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right]\n$$\n\n**3. 组分源项 ($S_{2}$)**\n\n质量分数之和必须为1，即 $\\sum_{k} Y_k = Y_1 + Y_2 = 1$。因此，组分守恒方程之和必须与总质量守恒一致。将两个组分方程相加：\n$$\nS_{1} + S_{2} = \\nabla \\cdot (\\rho Y_{1} \\mathbf{u} + \\mathbf{J}_{1}) + \\nabla \\cdot (\\rho Y_{2} \\mathbf{u} + \\mathbf{J}_{2}) = \\nabla \\cdot (\\rho (Y_{1}+Y_{2}) \\mathbf{u} + (\\mathbf{J}_{1}+\\mathbf{J}_{2}))\n$$\n使用 $Y_1+Y_2=1$ 和 $\\mathbf{J}_2 = -\\mathbf{J}_1$（因此 $\\mathbf{J}_1+\\mathbf{J}_2=0$），这简化为：\n$$\nS_{1} + S_{2} = \\nabla \\cdot (\\rho \\mathbf{u}) = S_{\\rho}\n$$\n因此，我们可以从 $S_{2} = S_{\\rho} - S_{1}$ 求得 $S_{2}$。\n$$\nS_{2} = \\rho(U_{0} + V_{0}) \\cos x \\cos y - \\rho \\left[ (Y_{10} + \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y - U_{0} \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right]\n$$\n$$\nS_{2} = \\rho(U_{0} + V_{0}) \\cos x \\cos y \\left[ 1 - (Y_{10} + \\epsilon \\cos x) \\right] + \\rho U_{0} \\epsilon \\sin^2 x \\cos y - \\rho D \\epsilon \\cos x\n$$\n因为 $1 - (Y_{10} + \\epsilon \\cos x) = 1 - Y_1 = Y_2$：\n$$\nS_{2} = \\rho Y_{2} (U_{0} + V_{0}) \\cos x \\cos y + \\rho U_{0} \\epsilon \\sin^2 x \\cos y - \\rho D \\epsilon \\cos x\n$$\n代入 $Y_{2}(x,y)$ 的表达式：\n$$\nS_{2} = \\rho \\left[ (1 - Y_{10} - \\epsilon \\cos x) (U_{0} + V_{0}) \\cos x \\cos y + U_{0} \\epsilon \\sin^2 x \\cos y - D \\epsilon \\cos x \\right]\n$$\n\n**4. 能量源项 ($S_{T}$)**\n\n热能方程为：\n$$\n\\nabla \\cdot (\\rho c_{p} T \\mathbf{u}) = \\nabla \\cdot (k \\nabla T) + S_{T}\n$$\n求解 $S_{T}$：\n$$\nS_{T} = \\nabla \\cdot (\\rho c_{p} T \\mathbf{u}) - \\nabla \\cdot (k \\nabla T)\n$$\n由于 $\\rho$、$c_p$ 和 $k$ 是常数：\n$$\nS_{T} = \\rho c_{p} \\nabla \\cdot (T \\mathbf{u}) - k \\nabla^{2} T\n$$\n使用与组分方程相同的矢量恒等式：\n$$\nS_{T} = \\rho c_{p} \\left[ T(\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot \\nabla T \\right] - k \\nabla^{2} T\n$$\n我们需要温度场 $T(x,y) = T_{0} + \\epsilon \\sin x \\sin y$ 的梯度和拉普拉斯算子。\n梯度为：\n$$\n\\nabla T = \\left( \\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y} \\right) = (\\epsilon \\cos x \\sin y, \\epsilon \\sin x \\cos y)\n$$\n点积 $\\mathbf{u} \\cdot \\nabla T$ 为：\n$$\n\\mathbf{u} \\cdot \\nabla T = (U_{0} \\sin x \\cos y)(\\epsilon \\cos x \\sin y) + (V_{0} \\cos x \\sin y)(\\epsilon \\sin x \\cos y)\n$$\n$$\n\\mathbf{u} \\cdot \\nabla T = U_{0} \\epsilon \\sin x \\cos x \\sin y \\cos y + V_{0} \\epsilon \\sin x \\cos x \\sin y \\cos y = (U_{0} + V_{0}) \\epsilon \\sin x \\cos x \\sin y \\cos y\n$$\n$T$ 的拉普拉斯算子为：\n$$\n\\frac{\\partial^{2} T}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}(\\epsilon \\cos x \\sin y) = -\\epsilon \\sin x \\sin y\n$$\n$$\n\\frac{\\partial^{2} T}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}(\\epsilon \\sin x \\cos y) = -\\epsilon \\sin x \\sin y\n$$\n$$\n\\nabla^{2} T = \\frac{\\partial^{2} T}{\\partial x^{2}} + \\frac{\\partial^{2} T}{\\partial y^{2}} = -2\\epsilon \\sin x \\sin y\n$$\n现在，整合各项得到 $S_{T}$：\n$$\nS_{T} = \\rho c_{p} \\left[ (T_{0} + \\epsilon \\sin x \\sin y)(U_{0} + V_{0})\\cos x \\cos y + (U_{0} + V_{0}) \\epsilon \\sin x \\cos x \\sin y \\cos y \\right] - k(-2\\epsilon \\sin x \\sin y)\n$$\n从对流部分中提出因子 $(U_0+V_0)$：\n$$\nS_{T} = \\rho c_{p} (U_{0} + V_{0}) \\left[ T_{0} \\cos x \\cos y + \\epsilon \\sin x \\sin y \\cos x \\cos y + \\epsilon \\sin x \\cos x \\sin y \\cos y \\right] + 2k\\epsilon \\sin x \\sin y\n$$\n$$\nS_{T} = \\rho c_{p} (U_{0} + V_{0}) (T_{0} \\cos x \\cos y + 2 \\epsilon \\sin x \\cos x \\sin y \\cos y) + 2k\\epsilon \\sin x \\sin y\n$$\n\n源项最终表达式总结：\n$$\nS_{\\rho} = \\rho(U_0 + V_0) \\cos x \\cos y\n$$\n$$\nS_{1} = \\rho \\left[ (Y_{10} + \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y - U_0 \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right]\n$$\n$$\nS_{2} = \\rho \\left[ (1 - Y_{10} - \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y + U_0 \\epsilon \\sin^2 x \\cos y - D \\epsilon \\cos x \\right]\n$$\n$$\nS_{T} = \\rho c_p (U_0+V_0) (T_0 \\cos x \\cos y + 2 \\epsilon \\sin x \\cos x \\sin y \\cos y) + 2k\\epsilon \\sin x \\sin y\n$$\n这些表达式现在可以进行最终格式化了。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\rho(U_0 + V_0) \\cos x \\cos y \\\\ \\rho \\left[ (Y_{10} + \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y - U_0 \\epsilon \\sin^2 x \\cos y + D \\epsilon \\cos x \\right] \\\\ \\rho \\left[ (1 - Y_{10} - \\epsilon \\cos x)(U_0+V_0) \\cos x \\cos y + U_0 \\epsilon \\sin^2 x \\cos y - D \\epsilon \\cos x \\right] \\\\ \\rho c_p (U_0+V_0) (T_0 \\cos x \\cos y + 2 \\epsilon \\sin x \\cos x \\sin y \\cos y) + 2 k \\epsilon \\sin x \\sin y \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在构建了一个MMS问题之后，下一步便是用它来分析您的数值格式的精度。最后一个实践将焦点转移到计算局部截断误差，即精确的连续算子与其离散近似之间的差异 。通过分析这个误差，您可以预测求解器的理论收敛阶，这是任何严谨验证研究的关键成果。",
            "id": "4064285",
            "problem": "考虑一个一维、稳态、无量纲的对流-扩散-反应平衡方程，用于描述预混火焰中代表组分质量分数的反应标量 $Y(x)$，该方程建立在周期性域 $x \\in [0, 2\\pi]$ 上：\n$$\\mathrm{Pe}\\,\\frac{dY}{dx} \\;=\\; \\frac{d^{2}Y}{dx^{2}} \\;+\\; S(x),$$\n其中 $\\mathrm{Pe} > 0$ 是 Péclet 数，$S(x)$ 是一个无量纲源项，它汇集了反应的生成和消耗，域坐标 $x$ 是无量纲的，并以弧度为单位。假设使用制造解方法进行求解器验证，制造解为\n$$Y_{M}(x) \\;=\\; \\sin(m\\,x),$$\n其中 $m \\geq 1$ 是给定的正整数模数。源项 $S(x)$ 的选择应使 $Y_{M}(x)$ 精确满足该连续方程。\n\n使用单元中心有限体积法在包含 $N$ 个单元的均匀网格上离散该方程，网格间距为 $\\Delta x = 2\\pi/N$，采用周期性边界，并使用以下面通量：\n- 对流通量采用一阶迎风格式（针对 $\\mathrm{Pe} > 0$）计算，这在单元平衡中产生对 $\\frac{dY}{dx}\\big|_{x_i}$ 的后向差分近似 $\\left(Y_{i} - Y_{i-1}\\right)/\\Delta x$。\n- 扩散通量采用二阶中心差分计算，这在单元平衡中产生对 $\\frac{d^{2}Y}{dx^{2}}\\big|_{x_i}$ 的二阶差分近似 $\\left(Y_{i+1} - 2Y_{i} + Y_{i-1}\\right)/\\Delta x^{2}$。\n\n通过将精确制造解 $Y_{M}$ 代入离散算子，并减去在单元中心处求值的、包含源项 $S(x)$ 的精确连续算子，来定义局部截断误差 $T_{h}(x)$。对于指定的有限体积格式，推导出 $T_{h}(x)$ 直至并包含 $\\Delta x$ 的领头阶项。然后，利用此截断误差结果和针对线性稳态算子的标准相容性-稳定性论证，预测在网格细化下解误差在最大范数（此处无需考虑首字母缩写 LASER 的字面意义；最大范数通常记为 $L_{\\infty}$）下的观测收敛阶 $p$。\n\n以一个两元行矩阵的形式提供你的最终答案，其中包含：\n1. 领头阶局部截断误差函数 $T_{h}(x)$，用 $\\mathrm{Pe}$、$m$、$x$ 和 $\\Delta x$ 解析表示，只保留 $\\Delta x$ 的最低阶项。\n2. 在 $L_{\\infty}$ 范数下预测的观测收敛率 $p$。\n\n无需进行数值计算；报告解析表达式和整数 $p$。最终答案中不包含任何单位。",
            "solution": "控制方程是无量纲稳态对流-扩散-反应平衡方程\n$$\\mathrm{Pe}\\,\\frac{dY}{dx} \\;=\\; \\frac{d^{2}Y}{dx^{2}} \\;+\\; S(x),$$\n采用制造解方法，选择在 $x \\in [0, 2\\pi]$ 上的解为 $Y_{M}(x) = \\sin(m x)$。\n\n为确定使 $Y_{M}$ 成为精确解的源项 $S(x)$，将 $Y_{M}$ 代入连续算子：\n$$\\frac{dY_{M}}{dx} = m \\cos(m x), \\qquad \\frac{d^{2}Y_{M}}{dx^{2}} = -m^{2} \\sin(m x).$$\n因此，所需的精确源项为\n$$S(x) = \\mathrm{Pe}\\,m \\cos(m x) + m^{2} \\sin(m x),$$\n从而使连续方程得到精确满足：\n$$\\mathrm{Pe}\\,\\frac{dY_{M}}{dx} - \\frac{d^{2}Y_{M}}{dx^{2}} - S(x) \\equiv 0.$$\n\n现在考虑在单元中心 $x_{i}$ 处的离散有限体积算子，其网格间距均匀，为 $\\Delta x = 2\\pi/N$，并采用周期性边界。所选的通量离散化格式对网格函数 $Y_{i}$ 应用，得到以下离散算子：\n$$L_{h}(Y)_{i} \\;=\\; \\mathrm{Pe}\\,\\frac{Y_{i} - Y_{i-1}}{\\Delta x} \\;-\\; \\frac{Y_{i+1} - 2Y_{i} + Y_{i-1}}{\\Delta x^{2}} \\;-\\; S(x_{i}).$$\n根据定义，制造解在 $x_{i}$ 处的局部截断误差为\n$$T_{h}(x_{i}) \\;=\\; L_{h}(Y_{M})_{i} \\;-\\; \\left[ \\mathrm{Pe}\\,\\frac{dY_{M}}{dx}(x_{i}) \\;-\\; \\frac{d^{2}Y_{M}}{dx^{2}}(x_{i}) \\;-\\; S(x_{i}) \\right].$$\n由于 $S(x)$ 在单元中心处求值，并精确抵消了作用于 $Y_{M}$ 上的连续算子，我们有\n$$T_{h}(x_{i}) \\;=\\; \\mathrm{Pe}\\left(\\frac{Y_{M,i} - Y_{M,i-1}}{\\Delta x} - \\frac{dY_{M}}{dx}(x_{i})\\right) \\;-\\; \\left(\\frac{Y_{M,i+1} - 2Y_{M,i} + Y_{M,i-1}}{\\Delta x^{2}} - \\frac{d^{2}Y_{M}}{dx^{2}}(x_{i})\\right).$$\n\n我们对光滑函数 $Y$ 使用关于 $x_{i}$ 的泰勒级数展开来展开离散差分：\n- 一阶导数的后向差分：\n$$\\frac{Y_{i} - Y_{i-1}}{\\Delta x} \\;=\\; \\frac{dY}{dx}(x_{i}) \\;-\\; \\frac{1}{2}\\frac{d^{2}Y}{dx^{2}}(x_{i})\\,\\Delta x \\;+\\; \\frac{1}{6}\\frac{d^{3}Y}{dx^{3}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3}).$$\n- 二阶导数的二阶差分：\n$$\\frac{Y_{i+1} - 2Y_{i} + Y_{i-1}}{\\Delta x^{2}} \\;=\\; \\frac{d^{2}Y}{dx^{2}}(x_{i}) \\;+\\; \\frac{1}{12}\\frac{d^{4}Y}{dx^{4}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{4}).$$\n\n将这些应用于 $Y_{M}$ 并减去精确导数，截断误差变为\n$$T_{h}(x_{i}) \\;=\\; \\mathrm{Pe}\\left[-\\frac{1}{2}\\frac{d^{2}Y_{M}}{dx^{2}}(x_{i})\\,\\Delta x \\;+\\; \\frac{1}{6}\\frac{d^{3}Y_{M}}{dx^{3}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3})\\right] \\;-\\; \\left[\\frac{1}{12}\\frac{d^{4}Y_{M}}{dx^{4}}(x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{4})\\right].$$\n\n计算 $Y_{M}(x) = \\sin(m x)$ 所需的导数：\n$$\\frac{d^{2}Y_{M}}{dx^{2}} = -m^{2}\\sin(m x), \\qquad \\frac{d^{3}Y_{M}}{dx^{3}} = -m^{3}\\cos(m x), \\qquad \\frac{d^{4}Y_{M}}{dx^{4}} = m^{4}\\sin(m x).$$\n将它们代入截断误差展开式：\n\\begin{align*}\nT_{h}(x_{i}) \\;=\\; \\mathrm{Pe}\\left[\\frac{1}{2}m^{2}\\sin(m x_{i})\\,\\Delta x \\;-\\; \\frac{1}{6}m^{3}\\cos(m x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3})\\right] \\;-\\; \\left[\\frac{1}{12}m^{4}\\sin(m x_{i})\\,\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{4})\\right] \\\\\n=\\; \\left(\\frac{1}{2}\\mathrm{Pe}\\,m^{2}\\sin(m x_{i})\\right)\\Delta x \\;+\\; \\left[-\\frac{1}{6}\\mathrm{Pe}\\,m^{3}\\cos(m x_{i}) \\;-\\; \\frac{1}{12}m^{4}\\sin(m x_{i})\\right]\\Delta x^{2} \\;+\\; \\mathcal{O}(\\Delta x^{3}).\n\\end{align*}\n因此，领头阶局部截断误差函数为\n$$T_{h}^{\\text{lead}}(x) \\;=\\; \\frac{1}{2}\\,\\mathrm{Pe}\\,m^{2}\\,\\sin(m x)\\,\\Delta x.$$\n\n为了预测在网格细化下解误差在最大范数 $L_{\\infty}$ 下的观测收敛阶，我们采用针对线性稳态算子的标准相容性-稳定性范式。离散算子与连续算子是相容的，并且由于对流项的一阶迎风离散化，其领头截断误差为 $\\mathcal{O}(\\Delta x)$。对于一个稳定的稳态线性问题求解器，解误差 $\\|Y_{h} - Y_{M}\\|_{\\infty}$ 反映了截断误差的阶数，从而在 $\\Delta x \\to 0$ 时，在 $L_{\\infty}$ 范数下得到观测收敛率 $p = 1$。对截断误差的二阶扩散贡献项与 $\\Delta x^{2}$ 成正比，是渐近次要的。\n\n因此，所要求的数对由领头阶截断误差函数 $T_{h}^{\\text{lead}}(x)$ 和预测的观测收敛率 $p = 1$ 组成。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\tfrac{1}{2}\\,\\mathrm{Pe}\\,m^{2}\\,\\sin(m x)\\,\\Delta x  1\\end{pmatrix}}$$"
        }
    ]
}