{
    "hands_on_practices": [
        {
            "introduction": "反应流的模拟之所以充满挑战，是因为其固有的多尺度特性——从湍流涡的宏观运动到火焰面内化学反应的微观尺度。自适应网格加密（AMR）是应对这一挑战的关键技术。本练习将通过分析一个简化的一维平流-反应模型，帮助你从第一性原理出发，理解如何通过量化物理与数值的时间尺度来确定AMR的必要性。你将推导并计算 Courant–Friedrichs–Lewy (CFL) 数和 Damköhler 数，并利用它们来确定满足对流稳定性和反应区解析精度所需的最小网格加密等级 。",
            "id": "4006193",
            "problem": "考虑预混、平流主导的反应流中，单一反应物质的质量分数为 $Y(x,t)$ 的一维平流-反应模型。其控制方程为守恒定律\n$$\n\\frac{\\partial Y}{\\partial t} + u \\frac{\\partial Y}{\\partial x} = \\omega(Y,T),\n$$\n其中 $u$ 是流速，$\\omega(Y,T)$ 是化学源项。假设一个具有阿伦尼乌斯速率的全局一级动力学模型，\n$$\n\\omega(Y,T) = -k(T)\\,Y, \\quad k(T) = A \\exp\\!\\left(-\\frac{E_{a}}{R T}\\right),\n$$\n其中 $A$ 是指前因子，$E_{a}$ 是活化能，$R$ 是通用气体常数，$T$ 是温度。考虑自适应网格加密（AMR），层级之间的均匀加密比为 $2$。设基础（最粗）层级的均匀网格间距为 $\\Delta x_{0}$，时间步长为 $\\Delta t_{0}$。在层级 $\\ell$ 上，设 $\\Delta x_{\\ell} = \\Delta x_{0}/2^{\\ell}$，并假设时间步长被子循环为 $\\Delta t_{\\ell} = \\Delta t_{0}/2^{\\ell}$。最大流速为 $u_{\\max}$。\n\n仅使用基于时间尺度的基本定义，完成以下任务：\n\n1. 从单个单元的对流时间尺度和离散时间步长出发，推导给定层级上的对流 Courant–Friedrichs–Lewy (CFL) 数的表达式，并使用以下数据在基础层级上进行评估。\n2. 从化学速率的阿伦尼乌斯表达式和化学时间尺度的定义出发，推导并评估基础层级上的 Damköhler 数，该数基于对流穿过单元时间与化学时间之比。\n3. 使用您的结果和第一性原理，推导 AMR 必须满足的约束条件，以同时保持对流精度（CFL 稳定性/精度）和反应精度（反应区的空间分辨率）。假设对流精度是通过要求在所述的时间步长子循环下，每个层级上的 Courant 数不超过 $0.5$ 来强制执行的；反应空间精度是通过要求在特征长度为 $\\ell_{r}$ 的反应区内至少有 $N$ 个单元来强制执行的。对于平流主导且扩散可忽略不计的情况，取 $\\ell_{r} = u_{\\max} \\,\\tau_{\\mathrm{chem}}$，其中 $\\tau_{\\mathrm{chem}}$ 是化学时间尺度。\n4. 确定最小整数 AMR 层级 $\\ell_{\\min}$，使得对流和反应精度约束都得到满足。\n\n使用以下物理上一致的参数：\n- $u_{\\max} = 25~\\mathrm{m}\\,\\mathrm{s}^{-1}$，\n- $\\Delta x_{0} = 1.6 \\times 10^{-3}~\\mathrm{m}$，\n- $\\Delta t_{0} = 3.0 \\times 10^{-5}~\\mathrm{s}$，\n- $A = 2.0 \\times 10^{6}~\\mathrm{s}^{-1}$，\n- $E_{a} = 8.0 \\times 10^{4}~\\mathrm{J}\\,\\mathrm{mol}^{-1}$，\n- $R = 8.314~\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，\n- $T = 1500~\\mathrm{K}$，\n- $N = 12$。\n\n答案规范：\n- 您在第 1-3 项中的计算过程应在解答中展示。\n- 最终答案仅报告最小 AMR 层级 $\\ell_{\\min}$ 的最终值。最终答案中不包括单位。\n- 由于最终答案是整数，因此不需要舍入说明。",
            "solution": "### 解答推导\n\n**1. 对流 Courant–Friedrichs–Lewy (CFL) 数**\n\n对流时间尺度 $\\tau_{\\text{conv},\\ell}$ 是流体元以最大流速 $u_{\\max}$ 穿过宽度为 $\\Delta x_{\\ell}$ 的单个网格单元所需的时间。\n$$\n\\tau_{\\text{conv},\\ell} = \\frac{\\Delta x_{\\ell}}{u_{\\max}}\n$$\nCourant–Friedrichs–Lewy (CFL) 数 $C_{\\ell}$ 定义为离散时间步长 $\\Delta t_{\\ell}$ 与此对流时间尺度之比。\n$$\nC_{\\ell} = \\frac{\\Delta t_{\\ell}}{\\tau_{\\text{conv},\\ell}} = \\frac{\\Delta t_{\\ell}}{(\\Delta x_{\\ell} / u_{\\max})} = \\frac{u_{\\max} \\Delta t_{\\ell}}{\\Delta x_{\\ell}}\n$$\n为了在基础层级（$\\ell=0$）上评估该值，我们使用所提供的数据：\n$$\nC_{0} = \\frac{u_{\\max} \\Delta t_{0}}{\\Delta x_{0}} = \\frac{(25~\\mathrm{m}\\,\\mathrm{s}^{-1}) (3.0 \\times 10^{-5}~\\mathrm{s})}{1.6 \\times 10^{-3}~\\mathrm{m}} = \\frac{7.5 \\times 10^{-4}}{1.6 \\times 10^{-3}} = \\frac{7.5}{16} = 0.46875\n$$\n\n**2. Damköhler 数**\n\n化学反应遵循一级动力学，$\\frac{dY}{dt} = -k(T)Y$。特征化学时间尺度 $\\tau_{\\mathrm{chem}}$ 是速率常数 $k(T)$ 的倒数。\n$$\n\\tau_{\\mathrm{chem}} = \\frac{1}{k(T)} = \\frac{1}{A \\exp(-E_{a}/(RT))}\n$$\n首先，我们计算指数的参数：\n$$\n\\frac{E_{a}}{RT} = \\frac{8.0 \\times 10^{4}~\\mathrm{J}\\,\\mathrm{mol}^{-1}}{(8.314~\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(1500~\\mathrm{K})} = \\frac{8.0 \\times 10^{4}}{12471} \\approx 6.41532\n$$\n现在，我们计算速率常数 $k(T)$ 和化学时间尺度 $\\tau_{\\mathrm{chem}}$：\n$$\nk(1500~\\mathrm{K}) = (2.0 \\times 10^{6}~\\mathrm{s}^{-1}) \\exp(-6.41532) \\approx (2.0 \\times 10^{6})(1.636 \\times 10^{-3})~\\mathrm{s}^{-1} \\approx 3272.36~\\mathrm{s}^{-1}\n$$\n$$\n\\tau_{\\mathrm{chem}} = \\frac{1}{k(1500~\\mathrm{K})} \\approx \\frac{1}{3272.36~\\mathrm{s}^{-1}} \\approx 3.05589 \\times 10^{-4}~\\mathrm{s}\n$$\n问题将基础层级上的 Damköhler 数 $Da_{0}$ 定义为对流穿过单元时间 $\\tau_{\\text{conv},0}$ 与化学时间 $\\tau_{\\mathrm{chem}}$ 之比。\n$$\n\\tau_{\\text{conv},0} = \\frac{\\Delta x_{0}}{u_{\\max}} = \\frac{1.6 \\times 10^{-3}~\\mathrm{m}}{25~\\mathrm{m}\\,\\mathrm{s}^{-1}} = 6.4 \\times 10^{-5}~\\mathrm{s}\n$$\n$$\nDa_{0} = \\frac{\\tau_{\\text{conv},0}}{\\tau_{\\mathrm{chem}}} \\approx \\frac{6.4 \\times 10^{-5}~\\mathrm{s}}{3.05589 \\times 10^{-4}~\\mathrm{s}} \\approx 0.2094\n$$\n\n**3. AMR 约束**\n\n*   **对流精度约束：** 任何层级 $\\ell$ 上的 CFL 数必须满足 $C_{\\ell} \\le 0.5$。使用 AMR 尺度关系 $\\Delta x_{\\ell} = \\Delta x_0/2^\\ell$ 和 $\\Delta t_\\ell = \\Delta t_0/2^\\ell$：\n    $$\n    C_{\\ell} = \\frac{u_{\\max} \\Delta t_{\\ell}}{\\Delta x_{\\ell}} = \\frac{u_{\\max} (\\Delta t_{0}/2^{\\ell})}{(\\Delta x_{0}/2^{\\ell})} = \\frac{u_{\\max} \\Delta t_{0}}{\\Delta x_{0}} = C_{0}\n    $$\n    这表明对于规定的子循环方案，CFL 数在所有 AMR 层级上是恒定的。约束变为 $C_{0} \\le 0.5$。从第 1 部分，我们计算出 $C_{0} = 0.46875$。由于 $0.46875 \\le 0.5$，对流约束在所有层级 $\\ell \\ge 0$ 上都得到满足。此约束不施加最小必需的 AMR 层级。\n\n*   **反应精度约束：** 在适当的 AMR 层级 $\\ell$ 上，反应区必须由至少 $N=12$ 个单元解析。反应区的长度为 $\\ell_{r} = u_{\\max} \\tau_{\\mathrm{chem}}$。跨越此长度的大小为 $\\Delta x_{\\ell}$ 的网格单元数量为 $\\ell_{r} / \\Delta x_{\\ell}$。约束条件是：\n    $$\n    \\frac{\\ell_{r}}{\\Delta x_{\\ell}} \\ge N \\implies \\frac{u_{\\max} \\tau_{\\mathrm{chem}}}{\\Delta x_{\\ell}} \\ge N\n    $$\n    这对反应精度所需的网格间距施加了一个上限：\n    $$\n    \\Delta x_{\\ell} \\le \\frac{u_{\\max} \\tau_{\\mathrm{chem}}}{N}\n    $$\n    所需的网格必须至少这么精细。\n\n**4. 最小 AMR 层级 $\\ell_{\\min}$**\n\n我们需要找到满足反应精度约束的最小整数 AMR 层级 $\\ell = \\ell_{\\min}$，因为对流约束对所有层级都已满足。我们将 $\\Delta x_{\\ell}$ 的表达式代入反应约束不等式中：\n$$\n\\frac{\\Delta x_{0}}{2^{\\ell}} \\le \\frac{u_{\\max} \\tau_{\\mathrm{chem}}}{N}\n$$\n为了找到最小的 $\\ell$，我们求解 $2^{\\ell}$：\n$$\n2^{\\ell} \\ge \\frac{N \\Delta x_{0}}{u_{\\max} \\tau_{\\mathrm{chem}}}\n$$\n现在，我们将已知值代入不等式的右侧：\n$$\n\\frac{N \\Delta x_{0}}{u_{\\max} \\tau_{\\mathrm{chem}}} \\approx \\frac{(12)(1.6 \\times 10^{-3}~\\mathrm{m})}{(25~\\mathrm{m}\\,\\mathrm{s}^{-1})(3.05589 \\times 10^{-4}~\\mathrm{s})} = \\frac{1.92 \\times 10^{-2}}{7.6397 \\times 10^{-3}} \\approx 2.5132\n$$\n求解最小整数 $\\ell$ 的不等式是：\n$$\n2^{\\ell} \\ge 2.5132\n$$\n我们测试 $\\ell$ 的整数值：\n- 对于 $\\ell=0$：$2^{0} = 1$，不满足 $\\ge 2.5132$。\n- 对于 $\\ell=1$：$2^{1} = 2$，不满足 $\\ge 2.5132$。\n- 对于 $\\ell=2$：$2^{2} = 4$，满足 $\\ge 2.5132$。\n\n或者，对两边取自然对数：\n$$\n\\ell \\ln(2) \\ge \\ln(2.5132) \\implies \\ell \\ge \\frac{\\ln(2.5132)}{\\ln(2)} \\approx \\frac{0.9215}{0.6931} \\approx 1.3295\n$$\n由于 AMR 层级 $\\ell$ 必须是整数，满足此条件的最小整数是 $\\ell_{\\min}=2$。\n\n因此，需要最小 AMR 层级 $\\ell_{\\min}=2$ 才能同时满足对流和反应精度约束。在此层级上，网格间距将为 $\\Delta x_2 = \\Delta x_0/4 = 4.0 \\times 10^{-4}~\\mathrm{m}$，这足以解析反应区。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在确定了需要使用多层级网格之后，下一个关键问题是如何确保不同层级和网格片（patch）之间的有效数据通信。高阶数值格式为了保证其精度，需要在计算通量时访问 stencil 内的多个相邻单元。本练习将引导你探讨 AMR 框架中的一个核心实现细节：“幽灵单元”（ghost cells）。通过推导支持特定精度阶数 ($p$) 的数值格式所需的最小幽灵单元宽度，你将深刻理解算法精度、数据依赖性以及 AMR 软件架构之间的内在联系 。",
            "id": "4006179",
            "problem": "考虑一个在自适应网格加密（AMR）层级结构上对可压缩反应流方程组（质量、动量、总能量和多组分质量分数）进行的一维有限体积离散，其中连续层级之间的加密比为 $2:1$。空间离散采用一种守恒的Godunov类方法，其基于面的数值通量由重构的左右状态导出。在每个层级上，使用一个 $p-1$ 次多项式进行重构，以在空间上达到 $\\mathcal{O}(\\Delta x^{p})$ 阶的截断误差，并且每个面心通量的数值模板是中心对称的，并在面的两侧各跨越 $s$ 个单元。\n\n在每个网格片（patch）周围分配了鬼点（ghost cells），以实现片间的通信，包括：\n- 同层级邻居交换，以确保内部片边界附近的所有模板输入都可用，\n- 粗网格到细网格的延拓，以填充邻近粗细网格界面的细网格鬼点，\n- 细网格到粗网格的限制和回流操作，以强制跨层级的守恒性。\n\n从使用面周围半径为 $s$ 的模板计算面通量的有限体积公式出发，并基于 $2:1$ 加密比所蕴含的几何对齐方式（细网格的单元中心和面与粗网格的面和中心以嵌套方式对齐），推导所需的最小鬼点宽度 $g$ （每个层级上每个片周围所需的鬼点层数），以确保：\n- 片边界附近的任何面心通量都可以在不访问“片+鬼点”区域之外的数据的情况下构建，\n- 任何为邻近粗细网格界面的细网格鬼点提供数值的粗网格层延拓操作，都可以在仅使用粗网格“片+鬼点”区域内已存在数据的情况下执行，\n- 任何限制或回流操作都不会引入比面心重构更强的要求。\n\n假设重构模板是（中心）对称的，并且阶数 $p$ 指的是重构的空间精度。请提供 $g$ 关于 $p$ 的通用表达式，然后在所述的AMR网格上计算当 $p=3$ 时的 $g$ 值。将最终答案表示为整数。无需四舍五入，也无需单位。",
            "solution": "该问题要求推导在AMR网格上，一个空间精度为 $p$ 阶的有限体积格式所需的最小鬼点层数 $g$。$g$ 的值由所需数值操作中要求最苛刻的数据依赖性决定。我们必须分析以下操作的模板要求：\n1.  单元间通量的计算。\n2.  粗网格到细网格的延拓（插值）操作。\n\n问题陈述确认了限制和回流操作不会施加更严格的要求，因此我们可以忽略它们作为限制因素。\n\n**1. 通量计算的模板要求**\n\n该格式使用基于 $p-1$ 次多项式的重构来达到 $p$ 阶精度。构建这样一个多项式需要求解 $p$ 个系数，在有限体积的背景下，这些系数由 $p$ 个不同单元的单元平均值确定。\n\n问题陈述指出，面上通量的模板是中心对称的，并在该面两侧各跨越 $s$ 个单元。对于索引为 $i+1/2$ 的面，这意味着模板由左侧的 $s$ 个单元（索引为 $i, i-1, \\dots, i-s+1$）和右侧的 $s$ 个单元（索引为 $i+1, i+2, \\dots, i+s$）组成。该模板中的总单元数为 $2s$。\n\n为了达到 $p$ 阶精度，此模板必须至少包含 $p$ 个单元。一个能够同时支持偶数和奇数阶 $p$ 的对称模板，通常通过选择大于或等于 $p$ 的最小偶数来构建。这确保了模板总是围绕面-对 `i, i+1` 对称。因此，总模板大小为 $2s = 2 \\lceil p/2 \\rceil$。这给出了模板半径 $s$ 的直接关系：\n$$s = \\lceil p/2 \\rceil$$\n在片边界处，通量计算需要来自相邻片的数据。如果一个片在单元 $I$ 处结束，计算面 $I+1/2$ 处的通量需要来自相邻域的单元 $I+1, \\dots, I+s$。这些单元必须作为鬼点提供。因此，鬼点数 $g$ 必须至少为 $s$。这导出了我们对 $g$ 的第一个约束条件：\n$$g \\ge \\lceil p/2 \\rceil$$\n\n**2. 粗网格到细网格延拓的模板要求**\n\n在粗细网格界面处，细网格片的鬼点是通过对底层粗网格片的数据进行插值来填充的。此插值的阶数应与格式的总阶数 $p$ 一致。因此，插值也将使用一个 $p-1$ 次多项式，这需要一个包含 $p$ 个粗网格单元的模板。\n\n设细网格上的鬼点数为 $g$。这些细网格鬼点覆盖的物理域宽度为 $g \\cdot \\Delta x_{fine}$。给定 $2:1$ 的加密比，我们有 $\\Delta x_{fine} = \\Delta x_{coarse}/2$。以粗网格单元宽度度量，细网格鬼点区域的物理宽度为 $g \\cdot (\\Delta x_{coarse}/2) = (g/2) \\cdot \\Delta x_{coarse}$。该区域与 $\\lceil g/2 \\rceil$ 个粗网格单元重叠。\n\n为了填充这些细网格鬼点中的值，我们必须在底层的粗网格单元内的不同点上执行插值。考虑最苛刻的情况：填充最外层的细网格鬼点。这需要在物理边界之外的第 $\\lceil g/2 \\rceil$ 个粗网格单元内的某点进行插值。\n\n一个 $p$ 点插值模板，尽可能地以目标粗网格单元为中心，会有一个特定的半径。我们用 $s_{interp}$ 表示插值模板中心单元两侧所需的单元数，它由形成一个p点模板所需的半径给出。一个包含 $p$ 个单元的模板可以以一个单元为中心（对于奇数 $p$）或一个面为中心（对于偶数 $p$）。对于单元内任意点的插值，支持模板的半径为 $\\lceil(p-1)/2\\rceil$。\n$$s_{interp} = \\left\\lceil \\frac{p-1}{2} \\right\\rceil$$\n粗网格片必须为细网格鬼点区域下方的 $\\lceil g/2 \\rceil$ 个单元提供数据，外加额外的 $s_{interp}$ 个单元以完成最外层区域的插值模板。因此，粗网格层所需的鬼点数（也是 $g$）必须满足：\n$$g \\ge \\left\\lceil \\frac{g}{2} \\right\\rceil + s_{interp}$$\n代入 $s_{interp}$：\n$$g \\ge \\left\\lceil \\frac{g}{2} \\right\\rceil + \\left\\lceil \\frac{p-1}{2} \\right\\rceil$$\n这个不等式可以改写为：\n$$g - \\left\\lceil \\frac{g}{2} \\right\\rceil \\ge \\left\\lceil \\frac{p-1}{2} \\right\\rceil$$\n左侧的项可以简化为 $\\lfloor g/2 \\rfloor$。因此，对 $g$ 的第二个约束条件是：\n$$\\left\\lfloor \\frac{g}{2} \\right\\rfloor \\ge \\left\\lceil \\frac{p-1}{2} \\right\\rceil$$\n\n**3. 最小鬼点宽度 `g`**\n\n最小鬼点宽度 $g$ 是满足两个导出约束条件的最小整数：\n1.  $g \\ge \\lceil p/2 \\rceil$\n2.  $\\lfloor g/2 \\rfloor \\ge \\lceil (p-1)/2 \\rceil$\n\n让我们分析第二个约束条件以找到它所施加的最小 $g$。令 $K = \\lceil (p-1)/2 \\rceil$。该约束变为 $\\lfloor g/2 \\rfloor \\ge K$，这等价于 $g/2 \\ge K$，或 $g \\ge 2K$。因此，从延拓要求来看，最小的 $g$ 是 $2 \\lceil (p-1)/2 \\rceil$。\n\n现在我们通过取两个约束条件要求的最大值来找到总的最小 $g$：\n$$g = \\max\\left( \\left\\lceil \\frac{p}{2} \\right\\rceil, 2 \\left\\lceil \\frac{p-1}{2} \\right\\rceil \\right)$$\n这就是 $g$ 关于 $p$ 的通用表达式。\n\n**4. 当 `p=3` 时的计算**\n\n题目要求我们计算三阶格式（即 $p=3$）下 $g$ 的值。我们将 $p=3$ 代入通用表达式：\n$$g = \\max\\left( \\left\\lceil \\frac{3}{2} \\right\\rceil, 2 \\left\\lceil \\frac{3-1}{2} \\right\\rceil \\right)$$\n$$g = \\max\\left( \\lceil 1.5 \\rceil, 2 \\lceil 1 \\rceil \\right)$$\n$$g = \\max(2, 2 \\cdot 1)$$\n$$g = \\max(2, 2)$$\n$$g = 2$$\n因此，对于所述AMR层级结构上的三阶精度格式，至少需要 $2$ 个鬼点层。让我们检查一下 $g=2$ 是否满足 $p=3$ 时的两个原始不等式：\n1.  $2 \\ge \\lceil 3/2 \\rceil \\implies 2 \\ge 2$。（满足）\n2.  $\\lfloor 2/2 \\rfloor \\ge \\lceil (3-1)/2 \\rceil \\implies \\lfloor 1 \\rfloor \\ge \\lceil 1 \\rceil \\implies 1 \\ge 1$。（满足）\n$g=1$ 的值将不满足第一个不等式（$1 \\ge 2$ 是错误的），因此 $g=2$ 确实是最小整数解。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "对于流体动力学和燃烧学中的守恒律方程（如质量、动量和能量守恒），在整个计算域内严格保持守恒是保证数值解物理真实性的基石。然而，AMR 中的粗-细网格界面会打破通量的统一计算，从而引入守恒性误差。本练习将通过一个具体的平流-扩散问题，让你亲手实践“通量修正”（flux refluxing）这一关键算法。你将逐步計算粗、细网格在界面上的通量差异，并将此差异以“回流”的形式修正到粗网格单元上，从而直观地理解 AMR 框架是如何在多层级结构中维持严格守恒性的 。",
            "id": "4006196",
            "problem": "考虑一个反应流中单一物质质量分数 $Y$ 的一维对流-扩散子步，该子步在自适应网格加密 (AMR) 框架内构建。其中，反应通过算子分裂处理，并且在此子步中不活跃（即，反应源项为零）。在此子步期间，该物质的控制守恒律为\n$$\n\\frac{\\partial (\\rho Y)}{\\partial t} + \\frac{\\partial F}{\\partial x} = 0,\n$$\n其中总物质通量为\n$$\nF = \\rho u Y - \\rho D \\frac{\\partial Y}{\\partial x},\n$$\n此处 $\\rho$ 是质量密度，$u$ 是对流速度，$D$ 是分子扩散系数。假设密度 $\\rho$ 为常数，且横截面积均匀为 $1$，因此单元体积即为其长度。\n\n一个粗网格由两个粗单元 $C0$ 和 $C1$ 组成，覆盖 $x \\in [0, 2\\Delta x_c]$ 的区域，粗单元宽度为 $\\Delta x_c$。一个加密比 $r = 2$ 的细网格覆盖了粗单元 $C1$ 的整个空间范围，由两个宽度为 $\\Delta x_f = \\Delta x_c/2$ 的细单元 $F1$ 和 $F2$ 组成。$C0$ 和细网格之间的界面位于 $x = \\Delta x_c$。位于 $x = \\Delta x_c$ 的面由粗单元 $C0$ 和细单元 $F1$ 共享。位于 $x = 0$ 的左边界是一个具有固定狄利克雷质量分数的入流边界。\n\n参数和初始数据如下：\n- 密度 $\\rho = 1.0 \\ \\mathrm{kg/m^3}$，\n- 对流速度 $u = 0.8 \\ \\mathrm{m/s}$ (x 轴正方向)，\n- 扩散系数 $D = 1.0 \\times 10^{-4} \\ \\mathrm{m^2/s}$，\n- 粗单元宽度 $\\Delta x_c = 2.0 \\times 10^{-3} \\ \\mathrm{m}$，\n- 细单元宽度 $\\Delta x_f = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，\n- 时间步长 $\\Delta t = 5.0 \\times 10^{-4} \\ \\mathrm{s}$，\n- x=0 处的入流质量分数：$Y_{\\text{in}} = 0.20$，\n- 初始质量分数：$Y_{C0}^n = 0.06$, $Y_{F1}^n = 0.12$, $Y_{F2}^n = 0.08$。\n\n在粗网格层级，被覆盖的粗网格邻居 $C1$ 的状态由细网格数据的守恒限制定义，因此其粗网格质量分数为平均值 $Y_{C1}^n = (Y_{F1}^n + Y_{F2}^n)/2$。\n\n使用以下从守恒律和本构通量导出的物理标准离散化原则：\n- 根据 $u$ 的符号，对对流面状态 $Y$ 进行迎风选择，\n- 对扩散通量使用中心差分，其中梯度计算使用相邻单元中心的距离；对于位于宽度为 $\\Delta x_L$ 和 $\\Delta x_R$ 的两个单元之间的面，中心距为 $\\Delta x_L/2 + \\Delta x_R/2$。\n\n任务：\n1. 使用 $Y_{C0}^n$ 和粗网格邻居 $Y_{C1}^n$，并以中心距 $\\Delta x_c$ 计算 $C0$ 右侧面（位于 $x = \\Delta x_c$）的粗网格层级对流-扩散通量。同时，使用 $Y_{\\text{in}}$ 和 $Y_{C0}^n$，并以中心距 $\\Delta x_c/2$ 计算 $C0$ 左边界（位于 $x=0$）的面通量。\n2. 通过守恒律所隐含的有限体积更新方法，使用左、右侧面的粗网格层级通量，在时间步长 $\\Delta t$ 内更新 $Y_{C0}$。\n3. 使用来自 $C0$ 的迎风状态和来自 $F1$ 的细网格状态，并以中心距 $\\Delta x_c/2 + \\Delta x_f/2$，计算 $C0$ 和 $F1$ 之间界面（位于 $x = \\Delta x_c$）的细网格层级通量。\n4. 用细网格层级的界面通量填充一个通量寄存器，并对粗单元 $C0$ 应用回流修正，使其最终更新后的状态与通过 $x = \\Delta x_c$ 的细网格层级界面通量保持一致。\n5. 根据修正后的 $Y_{C0}^{n+1}$，计算 $C0$ 中每单位横截面积的最终物质质量，其定义为 $m_{C0}^{n+1} = \\rho \\, Y_{C0}^{n+1} \\, \\Delta x_c$，并以 $\\mathrm{kg/m^2}$ 为单位表示。\n\n将您的最终答案四舍五入至四位有效数字，并以 $\\mathrm{kg/m^2}$ 为单位表示最终质量。",
            "solution": "### 解题推导\n对于密度 $\\rho$ 为常数、体积为 $\\Delta x_i$（每单位面积）的通用单元 $i$，其控制方程的有限体积离散化形式为：\n$$ Y_i^{n+1} = Y_i^n - \\frac{\\Delta t}{\\rho \\Delta x_i} (F_{i+1/2} - F_{i-1/2}) $$\n位于左单元 $L$ 和右单元 $R$ 之间的面上通量 $F$ 被离散为对流通量和扩散通量之和。给定 $u  0$，对流部分使用左侧单元的状态 $Y_L$。扩散通量采用中心差分格式。\n$$ F_{face} = (\\rho u Y_L) - (\\rho D) \\frac{Y_R - Y_L}{d_{centers}} $$\n其中 $d_{centers}$ 是单元中心之间的距离。\n\n首先，我们确定粗网格邻居 $C1$ 的状态。它是覆盖其上的细单元的体积加权平均值（限制操作）。\n$$ Y_{C1}^n = \\frac{Y_{F1}^n \\Delta x_f + Y_{F2}^n \\Delta x_f}{\\Delta x_c} = \\frac{Y_{F1}^n + Y_{F2}^n}{r} $$\n当 $r=2$ 时，这是一个简单的平均：\n$$ Y_{C1}^n = \\frac{0.12 + 0.08}{2} = 0.10 $$\n\n**任务 1：计算 $C0$ 的粗网格层级通量**\n\n单元 $C0$ 的左侧面在 $x=0$ 处，右侧面在 $x=\\Delta x_c$ 处。\n\n- **$C0$ 左侧面（位于 $x=0$）的通量 $F_{C0,left}$：**\n左侧“单元”是边界条件 $Y_{\\text{in}}$，右侧单元是 $C0$。给定的中心距为 $d_{centers} = \\Delta x_c / 2$。\n对流项使用上游状态 $Y_{\\text{in}}$。\n$$ F_{C0,left} = \\rho u Y_{\\text{in}} - \\rho D \\frac{Y_{C0}^n - Y_{\\text{in}}}{\\Delta x_c / 2} $$\n$$ F_{C0,left} = (1.0)(0.8)(0.20) - (1.0)(1.0 \\times 10^{-4}) \\frac{0.06 - 0.20}{2.0 \\times 10^{-3} / 2} $$\n$$ F_{C0,left} = 0.16 - (1.0 \\times 10^{-4}) \\frac{-0.14}{1.0 \\times 10^{-3}} = 0.16 - (1.0 \\times 10^{-4})(-140) = 0.16 + 0.014 = 0.174 $$\n\n- **$C0$ 右侧面（位于 $x=\\Delta x_c$）的粗网格层级通量 $F_{C0,right}^c$：**\n左侧单元是 $C0$，右侧单元是 $C1$。给定的中心距为 $d_{centers} = \\Delta x_c$。\n对流项使用左侧状态 $Y_{C0}^n$。\n$$ F_{C0,right}^c = \\rho u Y_{C0}^n - \\rho D \\frac{Y_{C1}^n - Y_{C0}^n}{\\Delta x_c} $$\n$$ F_{C0,right}^c = (1.0)(0.8)(0.06) - (1.0)(1.0 \\times 10^{-4}) \\frac{0.10 - 0.06}{2.0 \\times 10^{-3}} $$\n$$ F_{C0,right}^c = 0.048 - (1.0 \\times 10^{-4}) \\frac{0.04}{2.0 \\times 10^{-3}} = 0.048 - (1.0 \\times 10^{-4})(20) = 0.048 - 0.002 = 0.046 $$\n\n**任务 2：使用粗网格通量更新 $Y_{C0}$**\n\n这是仅使用粗网格层级信息对 $C0$ 进行的临时更新。\n$$ Y_{C0}^{n+1, \\text{coarse}} = Y_{C0}^n - \\frac{\\Delta t}{\\rho \\Delta x_c} (F_{C0,right}^c - F_{C0,left}) $$\n$$ Y_{C0}^{n+1, \\text{coarse}} = 0.06 - \\frac{5.0 \\times 10^{-4}}{(1.0)(2.0 \\times 10^{-3})} (0.046 - 0.174) $$\n$$ Y_{C0}^{n+1, \\text{coarse}} = 0.06 - (0.25) (-0.128) = 0.06 + 0.032 = 0.092 $$\n\n**任务 3：计算细网格层级界面通量**\n\n这是在粗-细界面 $x=\\Delta x_c$ 处更精确的通量。左侧单元是 $C0$，右侧单元是细单元 $F1$。中心距为 $d_{centers} = \\Delta x_c/2 + \\Delta x_f/2$。\n$$ d_{centers} = \\frac{2.0 \\times 10^{-3}}{2} + \\frac{1.0 \\times 10^{-3}}{2} = 1.0 \\times 10^{-3} + 0.5 \\times 10^{-3} = 1.5 \\times 10^{-3} \\ \\mathrm{m} $$\n细网格层级通量 $F_{C0,right}^f$ 为：\n$$ F_{C0,right}^f = \\rho u Y_{C0}^n - \\rho D \\frac{Y_{F1}^n - Y_{C0}^n}{\\Delta x_c/2 + \\Delta x_f/2} $$\n$$ F_{C0,right}^f = (1.0)(0.8)(0.06) - (1.0)(1.0 \\times 10^{-4}) \\frac{0.12 - 0.06}{1.5 \\times 10^{-3}} $$\n$$ F_{C0,right}^f = 0.048 - (1.0 \\times 10^{-4}) \\frac{0.06}{1.5 \\times 10^{-3}} = 0.048 - (1.0 \\times 10^{-4})(40) = 0.048 - 0.004 = 0.044 $$\n\n**任务 4：应用回流修正**\n\n通量回流过程修正粗单元的状态，以确保在粗-细界面的守恒性。对 $Y_{C0}^{n+1, \\text{coarse}}$ 的更新基于界面处粗网格层级通量和细网格层级通量之间的差异。\n由于通量差异，$C0$ 中物质质量的变化为 $\\Delta m = (F_{C0,right}^c - F_{C0,right}^f) \\Delta t A$。由于面积 $A=1$，对状态变量 $Y_{C0}$ 的修正为：\n$$ \\Delta Y_{C0}^{\\text{reflux}} = \\frac{(F_{C0,right}^c - F_{C0,right}^f) \\Delta t}{\\rho \\Delta x_c} $$\n$$ \\Delta Y_{C0}^{\\text{reflux}} = \\frac{(0.046 - 0.044) (5.0 \\times 10^{-4})}{(1.0) (2.0 \\times 10^{-3})} = \\frac{(0.002) (5.0 \\times 10^{-4})}{2.0 \\times 10^{-3}} = \\frac{1.0 \\times 10^{-6}}{2.0 \\times 10^{-3}} = 0.0005 $$\n$C0$ 最终的、修正后的状态为：\n$$ Y_{C0}^{n+1} = Y_{C0}^{n+1, \\text{coarse}} + \\Delta Y_{C0}^{\\text{reflux}} $$\n$$ Y_{C0}^{n+1} = 0.092 + 0.0005 = 0.0925 $$\n\n**任务 5：计算 $C0$ 中的最终物质质量**\n\n单元 $C0$ 中每单位横截面积的最终物质质量为：\n$$ m_{C0}^{n+1} = \\rho \\, Y_{C0}^{n+1} \\, \\Delta x_c $$\n$$ m_{C0}^{n+1} = (1.0 \\ \\mathrm{kg/m^3}) \\times (0.0925) \\times (2.0 \\times 10^{-3} \\ \\mathrm{m}) $$\n$$ m_{C0}^{n+1} = 0.185 \\times 10^{-3} \\ \\mathrm{kg/m^2} = 1.85 \\times 10^{-4} \\ \\mathrm{kg/m^2} $$\n问题要求答案四舍五入至四位有效数字。\n$$ m_{C0}^{n+1} = 1.850 \\times 10^{-4} \\ \\mathrm{kg/m^2} $$",
            "answer": "$$\\boxed{1.850 \\times 10^{-4}}$$"
        }
    ]
}