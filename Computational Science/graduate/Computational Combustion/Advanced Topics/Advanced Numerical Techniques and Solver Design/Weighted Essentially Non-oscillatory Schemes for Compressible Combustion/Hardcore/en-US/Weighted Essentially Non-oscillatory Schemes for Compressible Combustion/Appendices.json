{
    "hands_on_practices": [
        {
            "introduction": "The power of a Weighted Essentially Non-oscillatory (WENO) scheme lies in its nonlinear weights, which adapt to the local smoothness of the solution. This analytical exercise delves into the core mechanism of the Jiang-Shu formulation (WENO-JS) by examining how its smoothness indicators behave for a simple sinusoidal wave. By deriving the response of these indicators as a function of grid resolution, you will gain fundamental insight into how the scheme intelligently transitions from a high-order, centered-biased stencil in smooth regions to a robust, upwind-biased one near sharp gradients. ",
            "id": "4077058",
            "problem": "A one-dimensional finite-volume solver for compressible reacting flow uses a fifth-order Weighted Essentially Non-Oscillatory (WENO) reconstruction in the Jiang–Shu formulation (WENO-JS) to approximate numerical fluxes at cell interfaces for the compressible Euler equations with species transport. Consider reconstruction of a smooth scalar field $q(x)$ (e.g., a characteristic-variable projection of a species mass fraction or enthalpy) at the interface $x_{i+\\frac{1}{2}}$ for positive characteristic speed, on a uniform grid with spacing $\\Delta x$ and nodes $x_i = i \\,\\Delta x$. Let $q(x) = \\sin(k x)$ with wavenumber $k$, and define the nondimensional wavenumber $\\kappa = k \\,\\Delta x$ and the phase $\\varphi = k x_i$.\n\nFor WENO-JS at $x_{i+\\frac{1}{2}}$ with positive wave speed, the three quadratic candidate stencils use the Jiang–Shu smoothness indicators\n$$\n\\beta_0 = \\frac{13}{12}\\left(q_{i-2}-2 q_{i-1}+q_i\\right)^{2} + \\frac{1}{4}\\left(q_{i-2}-4 q_{i-1}+3 q_i\\right)^{2},\n$$\n$$\n\\beta_1 = \\frac{13}{12}\\left(q_{i-1}-2 q_i+q_{i+1}\\right)^{2} + \\frac{1}{4}\\left(q_{i-1}-q_{i+1}\\right)^{2},\n$$\n$$\n\\beta_2 = \\frac{13}{12}\\left(q_{i}-2 q_{i+1}+q_{i+2}\\right)^{2} + \\frac{1}{4}\\left(3 q_{i}-4 q_{i+1}+q_{i+2}\\right)^{2},\n$$\nwhere $q_{i+m} = q(x_{i+m})$. Define the phase-average over one spatial period as\n$$\n\\langle \\beta_r \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\beta_r(\\varphi;\\kappa)\\, d\\varphi, \\quad r \\in \\{0,1,2\\}.\n$$\n\nStarting only from these definitions, trigonometric identities, and the uniform grid structure, derive a closed-form analytic expression for the ratio\n$$\nR(\\kappa) \\equiv \\frac{\\langle \\beta_1 \\rangle}{\\langle \\beta_0 \\rangle}\n$$\nin terms of $\\kappa$ only. Express your final result as a simplified analytic function of $\\kappa$ with no remaining dependence on $\\varphi$. No numerical evaluation is required, and no units are to be reported in the final answer.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It constitutes a standard theoretical analysis within the field of computational fluid dynamics concerning the properties of a Weighted Essentially Non-Oscillatory (WENO) scheme. All necessary definitions are provided, and there are no contradictions or ambiguities. The problem is therefore deemed valid and a solution will be derived.\n\nThe objective is to find the ratio $R(\\kappa) = \\frac{\\langle \\beta_1 \\rangle}{\\langle \\beta_0 \\rangle}$, where $\\langle \\beta_r \\rangle$ is the phase-average of the Jiang-Shu smoothness indicator $\\beta_r$. The scalar field is given as $q(x) = \\sin(k x)$. On a uniform grid $x_i = i\\,\\Delta x$, the point values $q_{i+m} = q(x_{i+m})$ can be expressed in terms of the phase $\\varphi = k x_i$ and the non-dimensional wavenumber $\\kappa = k\\,\\Delta x$:\n$$\nq_{i+m} = q(x_i + m\\,\\Delta x) = \\sin(k(x_i + m\\,\\Delta x)) = \\sin(k x_i + m k\\,\\Delta x) = \\sin(\\varphi + m\\kappa).\n$$\nThe phase-average of a function $f(\\varphi)$ is defined as $\\langle f \\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} f(\\varphi)\\,d\\varphi$. We will utilize the following standard integral results:\n$$\n\\langle \\sin^2(\\varphi + c) \\rangle = \\frac{1}{2}, \\quad \\langle \\cos^2(\\varphi + c) \\rangle = \\frac{1}{2}, \\quad \\langle \\sin(\\varphi + c)\\cos(\\varphi + c) \\rangle = 0\n$$\nfor any constant $c$, as the integration is over a full period.\n\nFirst, we analyze the smoothness indicator $\\beta_1$:\n$$\n\\beta_1 = \\frac{13}{12}\\left(q_{i-1}-2 q_i+q_{i+1}\\right)^{2} + \\frac{1}{4}\\left(q_{i-1}-q_{i+1}\\right)^{2}.\n$$\nThe terms inside the parentheses are central finite differences. We express them using trigonometric identities.\nThe second-difference term is:\n\\begin{align*}\nq_{i-1} - 2q_i + q_{i+1} = \\sin(\\varphi-\\kappa) - 2\\sin(\\varphi) + \\sin(\\varphi+\\kappa) \\\\\n= [\\sin(\\varphi-\\kappa) + \\sin(\\varphi+\\kappa)] - 2\\sin(\\varphi) \\\\\n= [2\\sin(\\varphi)\\cos(\\kappa)] - 2\\sin(\\varphi) \\\\\n= 2\\sin(\\varphi)(\\cos(\\kappa) - 1) \\\\\n= 2\\sin(\\varphi)(-2\\sin^2(\\frac{\\kappa}{2})) \\\\\n= -4\\sin(\\varphi)\\sin^2(\\frac{\\kappa}{2}).\n\\end{align*}\nThe first-difference term is:\n\\begin{align*}\nq_{i-1} - q_{i+1} = \\sin(\\varphi-\\kappa) - \\sin(\\varphi+\\kappa) \\\\\n= 2\\cos(\\varphi)\\sin(-\\kappa) \\\\\n= -2\\cos(\\varphi)\\sin(\\kappa).\n\\end{align*}\nSubstituting these into the expression for $\\beta_1$:\n\\begin{align*}\n\\beta_1 = \\frac{13}{12}\\left(-4\\sin(\\varphi)\\sin^2(\\frac{\\kappa}{2})\\right)^2 + \\frac{1}{4}\\left(-2\\cos(\\varphi)\\sin(\\kappa)\\right)^2 \\\\\n= \\frac{13}{12}\\left(16\\sin^2(\\varphi)\\sin^4(\\frac{\\kappa}{2})\\right) + \\frac{1}{4}\\left(4\\cos^2(\\varphi)\\sin^2(\\kappa)\\right) \\\\\n= \\frac{52}{3}\\sin^2(\\varphi)\\sin^4(\\frac{\\kappa}{2}) + \\cos^2(\\varphi)\\sin^2(\\kappa).\n\\end{align*}\nNow, we compute the phase-average $\\langle\\beta_1\\rangle$ by applying the averaging operator:\n\\begin{align*}\n\\langle \\beta_1 \\rangle = \\frac{52}{3}\\langle\\sin^2(\\varphi)\\rangle\\sin^4(\\frac{\\kappa}{2}) + \\langle\\cos^2(\\varphi)\\rangle\\sin^2(\\kappa) \\\\\n= \\frac{52}{3}\\left(\\frac{1}{2}\\right)\\sin^4(\\frac{\\kappa}{2}) + \\left(\\frac{1}{2}\\right)\\sin^2(\\kappa) \\\\\n= \\frac{26}{3}\\sin^4(\\frac{\\kappa}{2}) + \\frac{1}{2}(2\\sin(\\frac{\\kappa}{2})\\cos(\\frac{\\kappa}{2}))^2 \\\\\n= \\frac{26}{3}\\sin^4(\\frac{\\kappa}{2}) + 2\\sin^2(\\frac{\\kappa}{2})\\cos^2(\\frac{\\kappa}{2}) \\\\\n= \\sin^2(\\frac{\\kappa}{2}) \\left( \\frac{26}{3}\\sin^2(\\frac{\\kappa}{2}) + 2\\cos^2(\\frac{\\kappa}{2}) \\right) \\\\\n= \\sin^2(\\frac{\\kappa}{2}) \\left( \\frac{26}{3}\\sin^2(\\frac{\\kappa}{2}) + 2(1-\\sin^2(\\frac{\\kappa}{2})) \\right) \\\\\n= \\sin^2(\\frac{\\kappa}{2}) \\left( \\left(\\frac{26}{3} - 2\\right)\\sin^2(\\frac{\\kappa}{2}) + 2 \\right) \\\\\n= \\sin^2(\\frac{\\kappa}{2}) \\left( \\frac{20}{3}\\sin^2(\\frac{\\kappa}{2}) + 2 \\right) = 2\\sin^2(\\frac{\\kappa}{2}) \\left( 1 + \\frac{10}{3}\\sin^2(\\frac{\\kappa}{2}) \\right).\n\\end{align*}\n\nNext, we analyze the smoothness indicator $\\beta_0$:\n$$\n\\beta_0 = \\frac{13}{12}\\left(q_{i-2}-2 q_{i-1}+q_i\\right)^{2} + \\frac{1}{4}\\left(q_{i-2}-4 q_{i-1}+3 q_i\\right)^{2}.\n$$\nLet's denote the two terms in parentheses as $A = q_{i-2}-2 q_{i-1}+q_i$ and $B = q_{i-2}-4 q_{i-1}+3 q_i$.\nFor term $A$:\n\\begin{align*}\nA = \\sin(\\varphi-2\\kappa) - 2\\sin(\\varphi-\\kappa) + \\sin(\\varphi) \\\\\n= [\\sin(\\varphi-2\\kappa) + \\sin(\\varphi)] - 2\\sin(\\varphi-\\kappa) \\\\\n= 2\\sin(\\varphi-\\kappa)\\cos(\\kappa) - 2\\sin(\\varphi-\\kappa) \\\\\n= 2\\sin(\\varphi-\\kappa)(\\cos(\\kappa)-1) \\\\\n= -4\\sin(\\varphi-\\kappa)\\sin^2(\\frac{\\kappa}{2}).\n\\end{align*}\nThe phase-average of $A^2$ is:\n$$\n\\langle A^2 \\rangle = \\left\\langle \\left(-4\\sin(\\varphi-\\kappa)\\sin^2(\\frac{\\kappa}{2})\\right)^2 \\right\\rangle = 16\\sin^4(\\frac{\\kappa}{2})\\langle \\sin^2(\\varphi-\\kappa) \\rangle = 16\\sin^4(\\frac{\\kappa}{2})\\left(\\frac{1}{2}\\right) = 8\\sin^4(\\frac{\\kappa}{2}).\n$$\nFor term $B$, direct simplification is less obvious. We expand it in terms of $\\sin(\\varphi)$ and $\\cos(\\varphi)$:\n\\begin{align*}\nB = \\sin(\\varphi-2\\kappa) - 4\\sin(\\varphi-\\kappa) + 3\\sin(\\varphi) \\\\\n= [\\sin(\\varphi)\\cos(2\\kappa)-\\cos(\\varphi)\\sin(2\\kappa)] - 4[\\sin(\\varphi)\\cos(\\kappa)-\\cos(\\varphi)\\sin(\\kappa)] + 3\\sin(\\varphi) \\\\\n= \\sin(\\varphi)[\\cos(2\\kappa) - 4\\cos(\\kappa) + 3] + \\cos(\\varphi)[-\\sin(2\\kappa) + 4\\sin(\\kappa)].\n\\end{align*}\nLet $C_1(\\kappa) = \\cos(2\\kappa) - 4\\cos(\\kappa) + 3$ and $C_2(\\kappa) = 4\\sin(\\kappa) - \\sin(2\\kappa)$. Then $B = C_1\\sin(\\varphi) + C_2\\cos(\\varphi)$.\nThe phase-average of $B^2$ is:\n$$\n\\langle B^2 \\rangle = \\langle (C_1\\sin(\\varphi) + C_2\\cos(\\varphi))^2 \\rangle = C_1^2\\langle\\sin^2(\\varphi)\\rangle + C_2^2\\langle\\cos^2(\\varphi)\\rangle + 2C_1C_2\\langle\\sin(\\varphi)\\cos(\\varphi)\\rangle = \\frac{1}{2}(C_1^2 + C_2^2).\n$$\nWe compute $C_1^2 + C_2^2$:\n\\begin{align*}\nC_1^2 + C_2^2 = (\\cos(2\\kappa) - 4\\cos(\\kappa) + 3)^2 + (4\\sin(\\kappa) - \\sin(2\\kappa))^2 \\\\\n= [\\cos^2(2\\kappa) + 16\\cos^2(\\kappa) + 9 - 8\\cos(2\\kappa)\\cos(\\kappa) + 6\\cos(2\\kappa) - 24\\cos(\\kappa)] \\\\\n\\quad + [16\\sin^2(\\kappa) + \\sin^2(2\\kappa) - 8\\sin(\\kappa)\\sin(2\\kappa)] \\\\\n= (\\cos^2(2\\kappa) + \\sin^2(2\\kappa)) + 16(\\cos^2(\\kappa) + \\sin^2(\\kappa)) + 9 + 6\\cos(2\\kappa) - 24\\cos(\\kappa) \\\\\n\\quad - 8(\\cos(2\\kappa)\\cos(\\kappa) + \\sin(2\\kappa)\\sin(\\kappa)) \\\\\n= 1 + 16 + 9 + 6\\cos(2\\kappa) - 24\\cos(\\kappa) - 8\\cos(2\\kappa-\\kappa) \\\\\n= 26 + 6\\cos(2\\kappa) - 32\\cos(\\kappa) \\\\\n= 26 + 6(2\\cos^2(\\kappa)-1) - 32\\cos(\\kappa) \\\\\n= 12\\cos^2(\\kappa) - 32\\cos(\\kappa) + 20 \\\\\n= 4(3\\cos^2(\\kappa) - 8\\cos(\\kappa) + 5) \\\\\n= 4(\\cos(\\kappa)-1)(3\\cos(\\kappa)-5).\n\\end{align*}\nThus, $\\langle B^2 \\rangle = \\frac{1}{2} \\cdot 4(\\cos(\\kappa)-1)(3\\cos(\\kappa)-5) = 2(\\cos(\\kappa)-1)(3\\cos(\\kappa)-5)$.\nUsing half-angle identities:\n$\\cos(\\kappa)-1 = -2\\sin^2(\\frac{\\kappa}{2})$\n$3\\cos(\\kappa)-5 = 3(1-2\\sin^2(\\frac{\\kappa}{2}))-5 = -2-6\\sin^2(\\frac{\\kappa}{2}) = -2(1+3\\sin^2(\\frac{\\kappa}{2}))$.\nSo, $\\langle B^2 \\rangle = 2(-2\\sin^2(\\frac{\\kappa}{2}))(-2(1+3\\sin^2(\\frac{\\kappa}{2}))) = 8\\sin^2(\\frac{\\kappa}{2})(1+3\\sin^2(\\frac{\\kappa}{2}))$.\n\nNow we assemble $\\langle\\beta_0\\rangle$:\n\\begin{align*}\n\\langle \\beta_0 \\rangle = \\frac{13}{12}\\langle A^2 \\rangle + \\frac{1}{4}\\langle B^2 \\rangle \\\\\n= \\frac{13}{12}(8\\sin^4(\\frac{\\kappa}{2})) + \\frac{1}{4}(8\\sin^2(\\frac{\\kappa}{2})(1+3\\sin^2(\\frac{\\kappa}{2}))) \\\\\n= \\frac{26}{3}\\sin^4(\\frac{\\kappa}{2}) + 2\\sin^2(\\frac{\\kappa}{2}) + 6\\sin^4(\\frac{\\kappa}{2}) \\\\\n= \\left(\\frac{26}{3} + 6\\right)\\sin^4(\\frac{\\kappa}{2}) + 2\\sin^2(\\frac{\\kappa}{2}) \\\\\n= \\frac{44}{3}\\sin^4(\\frac{\\kappa}{2}) + 2\\sin^2(\\frac{\\kappa}{2}) \\\\\n= 2\\sin^2(\\frac{\\kappa}{2}) \\left( 1 + \\frac{22}{3}\\sin^2(\\frac{\\kappa}{2}) \\right).\n\\end{align*}\n\nFinally, we compute the ratio $R(\\kappa)$:\n$$\nR(\\kappa) = \\frac{\\langle \\beta_1 \\rangle}{\\langle \\beta_0 \\rangle} = \\frac{2\\sin^2(\\frac{\\kappa}{2}) \\left( 1 + \\frac{10}{3}\\sin^2(\\frac{\\kappa}{2}) \\right)}{2\\sin^2(\\frac{\\kappa}{2}) \\left( 1 + \\frac{22}{3}\\sin^2(\\frac{\\kappa}{2}) \\right)}.\n$$\nFor any physically relevant wavenumber in a discrete simulation, $\\kappa \\neq 2n\\pi$ for integer $n$, so $\\sin(\\frac{\\kappa}{2}) \\neq 0$. We can cancel the common factor $2\\sin^2(\\frac{\\kappa}{2})$:\n$$\nR(\\kappa) = \\frac{1 + \\frac{10}{3}\\sin^2(\\frac{\\kappa}{2})}{1 + \\frac{22}{3}\\sin^2(\\frac{\\kappa}{2})}.\n$$\nMultiplying the numerator and denominator by $3$ gives the simplified final expression:\n$$\nR(\\kappa) = \\frac{3 + 10\\sin^2(\\frac{\\kappa}{2})}{3 + 22\\sin^2(\\frac{\\kappa}{2})}.\n$$",
            "answer": "$$\n\\boxed{\\frac{3 + 10\\sin^{2}\\left(\\frac{\\kappa}{2}\\right)}{3 + 22\\sin^{2}\\left(\\frac{\\kappa}{2}\\right)}}\n$$"
        },
        {
            "introduction": "When applying a high-order scheme to a system of conservation laws like the Euler equations, a critical implementation choice arises: which set of variables should be reconstructed? Since the transformation between primitive variables ($\\rho, u, p$) and conservative variables ($\\rho, \\rho u, E$) is nonlinear, the operations of reconstruction and transformation do not commute. This hands-on coding problem challenges you to directly investigate the consequences of this choice by comparing the accuracy of WENO reconstruction performed on primitive versus conservative variables for a reactive flow with complex thermodynamics. ",
            "id": "4077033",
            "problem": "Consider one-dimensional smooth fields for a reactive compressible mixture on a periodic domain $x \\in [0,1]$. Let the primitive variables be density $\\rho(x)$ in kilograms per cubic meter (kg/m$^3$), velocity $u(x)$ in meters per second (m/s), pressure $p(x)$ in Pascals (Pa), and a smooth progress variable $c(x)$ (dimensionless) representing reaction progress. The mixture has a spatially varying specific heat ratio $\\gamma(x) = \\gamma_0 - \\Delta\\gamma\\,c(x)$, and a uniform specific heat release $q$ in Joules per kilogram (J/kg). The equation of state is defined by the specific internal energy\n$$ e(x) = \\frac{p(x)}{(\\gamma(x)-1)\\,\\rho(x)} + q\\,c(x), $$\nand the total energy density\n$$ E(x) = \\rho(x)\\,e(x) + \\tfrac{1}{2}\\,\\rho(x)\\,u(x)^2 = \\frac{p(x)}{\\gamma(x)-1} + \\rho(x)\\,q\\,c(x) + \\tfrac{1}{2}\\,\\rho(x)\\,u(x)^2. $$\nDefine the conservative variables as $U(x) = [\\rho(x),\\;\\rho(x)u(x),\\;E(x)]$.\n\nYou will analyze reconstruction error arising from performing Weighted Essentially Non-Oscillatory (WENO) reconstruction in two different variable sets for smooth test cases with variable $\\gamma$ and heat release $q$:\n- Method P: reconstruct primitive variables $[\\rho, u, p, c]$ to obtain interface values and then map to conservative variables $[\\rho,\\rho u, E]$ via the above thermodynamic relations at the interface.\n- Method C: reconstruct conservative variables $[\\rho,\\rho u, E]$ directly to obtain interface conservative values.\n\nUse a finite-volume discretization with $N$ uniform cells and periodic boundary conditions. For each cell, compute cell averages of both primitive and conservative variables by numerically integrating the exact fields over the cell. Implement a fifth-order finite-volume WENO-JS (Jiang–Shu) reconstruction that produces left-biased interface values at each cell face $x_{i+\\frac{1}{2}}$ from cell averages. Do not assume any linearization of the primitive-to-conservative mapping; apply the nonlinear mapping pointwise at interfaces in Method P. For Method C, reconstruct each conservative component independently.\n\nAdopt the following smooth exact fields for all test cases:\n- $\\rho(x) = 1 + 0.2\\,\\cos(2\\pi x)$ in kg/m$^3$,\n- $u(x) = 50 + 10\\,\\sin(2\\pi x + 0.1)$ in m/s,\n- $p(x) = 10^5 + 5\\times 10^3\\,\\cos(2\\pi x + 0.3)$ in Pa,\n- $c(x) = 0.5 + 0.1\\,\\sin(2\\pi x - 0.2)$ (dimensionless),\n- $\\gamma(x) = \\gamma_0 - \\Delta\\gamma\\,c(x)$ (dimensionless), with $\\gamma(x) > 1$ everywhere.\n\nFor each face $x_{i+\\frac{1}{2}}$, compute the exact conservative variables $U^{\\mathrm{exact}}(x_{i+\\frac{1}{2}})$ by evaluating the exact primitive fields at $x_{i+\\frac{1}{2}}$ and applying the equation of state. Compute the reconstructed interface conservative variables $U^{\\mathrm{P}}(x_{i+\\frac{1}{2}})$ using Method P and $U^{\\mathrm{C}}(x_{i+\\frac{1}{2}})$ using Method C. Quantify the reconstruction error for each method by the aggregated relative $L^2$ error over all interfaces and components:\n$$ \\varepsilon_{\\mathrm{P}} = \\frac{\\left(\\sum_{i} \\sum_{k=1}^{3} \\left(U^{\\mathrm{P}}_k(x_{i+\\frac{1}{2}}) - U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}{\\left(\\sum_{i} \\sum_{k=1}^{3} \\left(U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}, \\quad\n\\varepsilon_{\\mathrm{C}} = \\frac{\\left(\\sum_{i} \\sum_{k=1}^{3} \\left(U^{\\mathrm{C}}_k(x_{i+\\frac{1}{2}}) - U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}{\\left(\\sum_{i} \\sum_{k=1}^{3} \\left(U^{\\mathrm{exact}}_k(x_{i+\\frac{1}{2}})\\right)^2\\right)^{1/2}}. $$\nReport, for each test case, the tuple $[\\varepsilon_{\\mathrm{P}},\\;\\varepsilon_{\\mathrm{C}},\\;\\varepsilon_{\\mathrm{P}} - \\varepsilon_{\\mathrm{C}}]$ as three decimal floats.\n\nNumerical integration for cell averages must achieve accuracy consistent with the reconstruction order; use Gaussian quadrature with at least five points per cell. Treat the domain as periodic when accessing neighbor cells for WENO stencils.\n\nTest suite:\n- Case 1 (happy path): $N=80$, $\\gamma_0=1.4$, $\\Delta\\gamma=0.2$, $q=3\\times 10^4$ J/kg.\n- Case 2 (baseline): $N=80$, $\\gamma_0=1.4$, $\\Delta\\gamma=0$, $q=0$ J/kg.\n- Case 3 (strong variation): $N=160$, $\\gamma_0=1.3$, $\\Delta\\gamma=0.25$, $q=8\\times 10^4$ J/kg.\n- Case 4 (coarse grid): $N=40$, $\\gamma_0=1.4$, $\\Delta\\gamma=0.2$, $q=3\\times 10^4$ J/kg.\n\nAll quantities are to be computed using the units specified above; the final reported errors are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a sublist $[\\varepsilon_{\\mathrm{P}},\\varepsilon_{\\mathrm{C}},\\varepsilon_{\\mathrm{P}} - \\varepsilon_{\\mathrm{C}}]$; for example, a valid output format is $[[a,b,c],[d,e,f],[g,h,i],[j,k,l]]$.",
            "solution": "The problem requires a comparison of reconstruction errors between two approaches for a finite-volume scheme applied to a reactive compressible flow model. The two methods involve performing a fifth-order Weighted Essentially Non-Oscillatory (WENO) reconstruction on either the primitive variables (Method P) or the conservative variables (Method C). The analysis is performed for a smooth, one-dimensional periodic problem with a specified equation of state that includes a variable specific heat ratio $\\gamma(x)$ and a heat release term $q$.\n\nThe solution is implemented by following these steps:\n1.  Define the computational grid and the exact analytical solution for all flow variables.\n2.  Compute the cell averages of the required variables (primitive for Method P, conservative for Method C) by numerically integrating the exact solution over each cell.\n3.  Implement the fifth-order WENO-JS reconstruction algorithm to obtain left-biased values at cell interfaces from the cell averages.\n4.  Apply the two methods to compute the conservative state vector at each cell interface.\n5.  Calculate the exact conservative state vector at each interface for comparison.\n6.  Compute the aggregated relative $L^2$ error for each method to quantify their accuracy.\n7.  Repeat the process for all specified test cases.\n\n**1. Grid, Exact Solution, and State Variables**\n\nThe one-dimensional periodic domain $x \\in [0,1]$ is discretized into $N$ uniform cells, $C_i = [x_{i-1/2}, x_{i+1/2}]$, for $i=0, 1, \\dots, N-1$. The cell width is $\\Delta x = 1/N$, cell centers are $x_i = (i+0.5)\\Delta x$, and cell interfaces are at $x_{i+1/2} = (i+1)\\Delta x$.\n\nThe problem provides exact, smooth analytical functions for the primitive variables: density $\\rho(x)$, velocity $u(x)$, pressure $p(x)$, and reaction progress $c(x)$.\nThe specific heat ratio $\\gamma(x)$ is a function of the progress variable: $\\gamma(x) = \\gamma_0 - \\Delta\\gamma\\,c(x)$.\nThe conservative variables $U(x) = [\\rho(x), \\rho(x)u(x), E(x)]^T$ are defined using the thermodynamic relations. The total energy density $E(x)$ is given by:\n$$\nE(x) = \\frac{p(x)}{\\gamma(x)-1} + \\rho(x) q c(x) + \\frac{1}{2}\\rho(x) u(x)^2\n$$\n\n**2. Computation of Cell Averages**\n\nFor a generic function $f(x)$, its cell average over cell $C_i$ is defined as $\\bar{f}_i = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx$. To achieve an accuracy consistent with the fifth-order reconstruction scheme, this integral is computed numerically using a $5$-point Gaussian quadrature rule. For each cell $C_i$, the integral is calculated and then divided by the cell width $\\Delta x$. This procedure is applied to compute the cell averages of the primitive variables $\\{\\bar{\\rho}_i, \\bar{u}_i, \\bar{p}_i, \\bar{c}_i\\}$ for Method P, and the conservative variables $\\{\\bar{\\rho}_i, \\overline{\\rho u}_i, \\bar{E}_i\\}$ for Method C.\n\n**3. Fifth-Order WENO-JS Reconstruction**\n\nThe core of the numerical method is the fifth-order finite-volume WENO-JS scheme. From a given set of cell averages $\\bar{v}_i$, we reconstruct the left-biased value $v_{i+1/2}^L$ at the interface $x_{i+1/2}$. This reconstruction uses a stencil of $5$ cells centered around cell $i$: $\\{C_{i-2}, C_{i-1}, C_{i}, C_{i+1}, C_{i+2}\\}$. Due to the periodic domain, indices are handled modulo $N$.\n\nThe WENO reconstruction is a nonlinear combination of three $3$rd-order reconstructions, each based on a $3$-cell sub-stencil. For the interface $x_{i+1/2}$, the candidate values are:\n\\begin{align*}\nv_{i+1/2}^{(0)} = \\frac{1}{3}\\bar{v}_{i-2} - \\frac{7}{6}\\bar{v}_{i-1} + \\frac{11}{6}\\bar{v}_{i} \\\\\nv_{i+1/2}^{(1)} = -\\frac{1}{6}\\bar{v}_{i-1} + \\frac{5}{6}\\bar{v}_{i} + \\frac{1}{3}\\bar{v}_{i+1} \\\\\nv_{i+1/2}^{(2)} = \\frac{1}{3}\\bar{v}_{i} + \\frac{5}{6}\\bar{v}_{i+1} - \\frac{1}{6}\\bar{v}_{i+2}\n\\end{align*}\nThe smoothness of the solution on each sub-stencil is measured by smoothness indicators $IS_k$:\n\\begin{align*}\nIS_0 = \\frac{13}{12}(\\bar{v}_{i-2} - 2\\bar{v}_{i-1} + \\bar{v}_i)^2 + \\frac{1}{4}(\\bar{v}_{i-2} - 4\\bar{v}_{i-1} + 3\\bar{v}_i)^2 \\\\\nIS_1 = \\frac{13}{12}(\\bar{v}_{i-1} - 2\\bar{v}_i + \\bar{v}_{i+1})^2 + \\frac{1}{4}(\\bar{v}_{i-1} - \\bar{v}_{i+1})^2 \\\\\nIS_2 = \\frac{13}{12}(\\bar{v}_i - 2\\bar{v}_{i+1} + \\bar{v}_{i+2})^2 + \\frac{1}{4}(3\\bar{v}_i - 4\\bar{v}_{i+1} + \\bar{v}_{i+2})^2\n\\end{align*}\nThese indicators are used to compute the nonlinear weights $\\omega_k$. First, unnormalized weights $\\alpha_k$ are calculated using the optimal linear weights ($d_0=0.1, d_1=0.6, d_2=0.3$):\n$$\n\\alpha_k = \\frac{d_k}{(\\varepsilon + IS_k)^2}, \\quad k = 0, 1, 2\n$$\nwhere $\\varepsilon$ is a small positive number (e.g., $10^{-40}$) to prevent division by zero in smooth regions. The final weights are normalized: $\\omega_k = \\alpha_k / \\sum_{j=0}^{2} \\alpha_j$. The reconstructed value is the weighted sum of the candidates:\n$$\nv_{i+1/2}^L = \\sum_{k=0}^{2} \\omega_k v_{i+1/2}^{(k)}\n$$\n\n**4. Reconstruction Methodologies**\n\n- **Method P:** The WENO-JS reconstruction is applied independently to each set of primitive variable cell averages: $\\{\\bar{\\rho}_i\\}, \\{\\bar{u}_i\\}, \\{\\bar{p}_i\\}, \\{\\bar{c}_i\\}$. This yields interface values $\\rho^L_{i+1/2}, u^L_{i+1/2}, p^L_{i+1/2}, c^L_{i+1/2}$. The conservative state vector $U^{\\mathrm{P}}(x_{i+1/2})$ is then computed by applying the nonlinear equation of state to these reconstructed primitive values at each interface.\n\n- **Method C:** The WENO-JS reconstruction is applied independently to each set of conservative variable cell averages: $\\{\\bar{\\rho}_i\\}, \\{\\overline{\\rho u}_i\\}, \\{\\bar{E}_i\\}$. This directly yields the interface values of the conservative variables, forming the state vector $U^{\\mathrm{C}}(x_{i+1/2})$.\n\n**5. Error Calculation**\n\nFor each method, the reconstruction error is quantified by comparing the reconstructed conservative state vector at the interfaces, $U^{\\mathrm{P}}$ or $U^{\\mathrm{C}}$, against the exact state vector $U^{\\mathrm{exact}}$. The exact vector at each interface $x_{i+1/2}$ is found by evaluating the analytical functions $\\rho(x), u(x), p(x), c(x)$ at $x_{i+1/2}$ and applying the equation of state. The error is measured using the aggregated relative $L^2$ norm, defined as:\n$$\n\\varepsilon = \\frac{\\left( \\sum_{i=0}^{N-1} \\sum_{k=1}^{3} (U_k(x_{i+1/2}) - U^{\\mathrm{exact}}_k(x_{i+1/2}))^2 \\right)^{1/2}}{\\left( \\sum_{i=0}^{N-1} \\sum_{k=1}^{3} (U^{\\mathrm{exact}}_k(x_{i+1/2}))^2 \\right)^{1/2}}\n$$\nThis formula is used to compute both $\\varepsilon_{\\mathrm{P}}$ (for Method P) and $\\varepsilon_{\\mathrm{C}}$ (for Method C). The difference $\\varepsilon_{\\mathrm{P}} - \\varepsilon_{\\mathrm{C}}$ is also computed to directly compare the two methods. For smooth flows, it is generally anticipated that $\\varepsilon_{\\mathrm{P}}  \\varepsilon_{\\mathrm{C}}$ because primitive variables are often smoother and the reconstruction operator does not commute with the nonlinear transformation to conservative variables.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import fixed_quad\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the execution for all test cases.\n    \"\"\"\n\n    def weno5js_recon(v_bar):\n        \"\"\"\n        Performs 5th-order WENO-JS reconstruction for a 1D periodic domain.\n        Computes left-biased values at interfaces v_{i+1/2}^L.\n        This is a vectorized implementation for efficiency.\n        \"\"\"\n        eps = 1e-40\n        d0, d1, d2 = 0.1, 0.6, 0.3\n\n        # Stencil values shifted periodically\n        vm2 = np.roll(v_bar, 2)\n        vm1 = np.roll(v_bar, 1)\n        v0 = v_bar\n        vp1 = np.roll(v_bar, -1)\n        vp2 = np.roll(v_bar, -2)\n\n        # 3rd-order candidate reconstructions at i+1/2\n        v_rec0 = (1/3) * vm2 - (7/6) * vm1 + (11/6) * v0\n        v_rec1 = (-1/6) * vm1 + (5/6) * v0 + (1/3) * vp1\n        v_rec2 = (1/3) * v0 + (5/6) * vp1 - (1/6) * vp2\n\n        # Smoothness indicators\n        is0 = (13/12) * (vm2 - 2*vm1 + v0)**2 + (1/4) * (vm2 - 4*vm1 + 3*v0)**2\n        is1 = (13/12) * (vm1 - 2*v0 + vp1)**2 + (1/4) * (vm1 - vp1)**2\n        is2 = (13/12) * (v0 - 2*vp1 + vp2)**2 + (1/4) * (3*v0 - 4*vp1 + vp2)**2\n        \n        # Nonlinear weights\n        alpha0 = d0 / (eps + is0)**2\n        alpha1 = d1 / (eps + is1)**2\n        alpha2 = d2 / (eps + is2)**2\n        \n        sum_alpha = alpha0 + alpha1 + alpha2\n        \n        w0 = alpha0 / sum_alpha\n        w1 = alpha1 / sum_alpha\n        w2 = alpha2 / sum_alpha\n        \n        # Final reconstructed value\n        v_L = w0 * v_rec0 + w1 * v_rec1 + w2 * v_rec2\n        \n        return v_L\n\n    def compute_cell_avg(func, N):\n        \"\"\"\n        Computes cell averages of a function `func` over N uniform cells in [0,1]\n        using 5-point Gaussian quadrature for integration.\n        \"\"\"\n        dx = 1.0 / N\n        avg = np.zeros(N)\n        for i in range(N):\n            integral_val, _ = fixed_quad(func, i * dx, (i + 1) * dx, n=5)\n            avg[i] = integral_val / dx\n        return avg\n\n    def solve_case(N, gamma0, d_gamma, q):\n        \"\"\"\n        Solves the problem for a single test case.\n        \"\"\"\n        # 1. Setup Grid and Exact Functions\n        dx = 1.0 / N\n        x_interfaces = (np.arange(N) + 1.0) * dx\n        \n        # Exact primitive fields\n        rho_func = lambda x: 1.0 + 0.2 * np.cos(2 * np.pi * x)\n        u_func = lambda x: 50.0 + 10.0 * np.sin(2 * np.pi * x + 0.1)\n        p_func = lambda x: 1e5 + 5e3 * np.cos(2 * np.pi * x + 0.3)\n        c_func = lambda x: 0.5 + 0.1 * np.sin(2 * np.pi * x - 0.2)\n        gamma_func = lambda x: gamma0 - d_gamma * c_func(x)\n\n        # Exact conservative fields\n        rhou_func = lambda x: rho_func(x) * u_func(x)\n        E_func = lambda x: (p_func(x) / (gamma_func(x) - 1.0)\n                            + rho_func(x) * q * c_func(x)\n                            + 0.5 * rho_func(x) * u_func(x)**2)\n        \n        # 2. Compute Exact Interface Values\n        rho_exact_int = rho_func(x_interfaces)\n        u_exact_int = u_func(x_interfaces)\n        p_exact_int = p_func(x_interfaces)\n        c_exact_int = c_func(x_interfaces)\n        gamma_exact_int = gamma_func(x_interfaces)\n\n        U_exact_int = np.zeros((N, 3))\n        U_exact_int[:, 0] = rho_exact_int\n        U_exact_int[:, 1] = rho_exact_int * u_exact_int\n        U_exact_int[:, 2] = (p_exact_int / (gamma_exact_int - 1.0)\n                             + rho_exact_int * q * c_exact_int\n                             + 0.5 * rho_exact_int * u_exact_int**2)\n\n        # 3. Method P: Reconstruct primitives\n        rho_bar = compute_cell_avg(rho_func, N)\n        u_bar = compute_cell_avg(u_func, N)\n        p_bar = compute_cell_avg(p_func, N)\n        c_bar = compute_cell_avg(c_func, N)\n        \n        rho_L_p = weno5js_recon(rho_bar)\n        u_L_p = weno5js_recon(u_bar)\n        p_L_p = weno5js_recon(p_bar)\n        c_L_p = weno5js_recon(c_bar)\n        \n        gamma_L_p = gamma0 - d_gamma * c_L_p\n        \n        U_P_recon = np.zeros((N, 3))\n        U_P_recon[:, 0] = rho_L_p\n        U_P_recon[:, 1] = rho_L_p * u_L_p\n        U_P_recon[:, 2] = (p_L_p / (gamma_L_p - 1.0)\n                           + rho_L_p * q * c_L_p\n                           + 0.5 * rho_L_p * u_L_p**2)\n\n        # 4. Method C: Reconstruct conservatives\n        rhou_bar = compute_cell_avg(rhou_func, N)\n        E_bar = compute_cell_avg(E_func, N)\n        \n        U_C_recon = np.zeros((N, 3))\n        U_C_recon[:, 0] = weno5js_recon(rho_bar) # rho_bar is already computed\n        U_C_recon[:, 1] = weno5js_recon(rhou_bar)\n        U_C_recon[:, 2] = weno5js_recon(E_bar)\n        \n        # 5. Compute Errors\n        norm_exact_sq = np.sum(U_exact_int**2)\n        \n        err_P_sq = np.sum((U_P_recon - U_exact_int)**2)\n        eps_P = np.sqrt(err_P_sq / norm_exact_sq)\n        \n        err_C_sq = np.sum((U_C_recon - U_exact_int)**2)\n        eps_C = np.sqrt(err_C_sq / norm_exact_sq)\n\n        return [eps_P, eps_C, eps_P - eps_C]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, gamma0, d_gamma, q)\n        (80, 1.4, 0.2, 3e4),    # Case 1\n        (80, 1.4, 0.0, 0.0),    # Case 2\n        (160, 1.3, 0.25, 8e4),  # Case 3\n        (40, 1.4, 0.2, 3e4),     # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        N, gamma0, d_gamma, q = case\n        result = solve_case(N, gamma0, d_gamma, q)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A robust numerical solver for compressible reactive flows must not only be accurate but also maintain physical realism. Numerical errors, particularly near strong shocks or stiff reaction fronts, can lead to conservative state variables that imply unphysical conditions like negative temperature or pressure. This problem guides you through the design and verification of a positivity-preserving recovery algorithm, a crucial safeguard that ensures the thermodynamic state remains valid ($T > 0$, $p > 0$) after each conservative update, bridging the gap between the raw numerical output and a physically consistent solution. ",
            "id": "4077072",
            "problem": "Consider a one-dimensional compressible reacting flow discretized by a fifth-order Weighted Essentially Non-Oscillatory (WENO) scheme. After a conservative update at a symmetry point, the momentum is zero, and the available cell-centered conservative fields are the mass density $\\rho$, the total energy density $E$, and the species mass fractions $Y_{k}$ for a binary mixture of hydrogen and oxygen. The goal is to construct a positivity-preserving temperature recovery algorithm that guarantees strictly positive temperature $T$ and pressure $p$ by combining physically motivated lower bounds and a monotonic inversion of the Equation of State (EOS).\n\nAssume:\n- The species are hydrogen ($\\mathrm{H_{2}}$) and oxygen ($\\mathrm{O_{2}}$) with molecular weights $W_{\\mathrm{H_{2}}} = 2.016 \\times 10^{-3}\\,\\mathrm{kg/mol}$ and $W_{\\mathrm{O_{2}}} = 31.998 \\times 10^{-3}\\,\\mathrm{kg/mol}$, respectively, and the universal gas constant $R_{u} = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$.\n- The EOS is the ideal-gas mixture with mixture gas constant $R_{\\mathrm{mix}} = \\sum_{k} Y_{k}\\,R_{u}/W_{k}$ and pressure $p = \\rho\\,R_{\\mathrm{mix}}\\,T$.\n- Species constant-volume specific heats are temperature dependent and given by $c_{v,k}(T) = \\alpha_{k} + \\beta_{k} T$ with strictly positive coefficients, specifically $\\alpha_{\\mathrm{H_{2}}} = 1.0 \\times 10^{4}\\,\\mathrm{J/(kg\\cdot K)}$, $\\beta_{\\mathrm{H_{2}}} = 5.0\\,\\mathrm{J/(kg\\cdot K^{2})}$, $\\alpha_{\\mathrm{O_{2}}} = 7.0 \\times 10^{2}\\,\\mathrm{J/(kg\\cdot K)}$, and $\\beta_{\\mathrm{O_{2}}} = 0.3\\,\\mathrm{J/(kg\\cdot K^{2})}$. The mixture constant-volume specific heat is $c_{v,\\mathrm{mix}}(T) = \\sum_{k} Y_{k}\\,c_{v,k}(T)$.\n- The specific internal energy $u(T)$ of the mixture is defined by the reference $u(0) = 0$ and $u(T) = \\int_{0}^{T} c_{v,\\mathrm{mix}}(\\theta)\\,\\mathrm{d}\\theta$.\n- Lower bounds are enforced for robustness: density floor $\\rho_{\\min} = 10^{-6}\\,\\mathrm{kg/m^{3}}$, species floor $Y_{\\min} = 10^{-8}$ applied componentwise and then renormalized to $\\sum_{k} Y_{k} = 1$, and temperature floor $T_{\\min} = 300\\,\\mathrm{K}$ used only if the recovered internal energy falls below the minimum compatible with $T_{\\min}$.\n\nYou are given the raw conservative update outputs:\n- $\\rho_{\\mathrm{raw}} = 1.0\\,\\mathrm{kg/m^{3}}$,\n- $E_{\\mathrm{raw}} = 1.2 \\times 10^{6}\\,\\mathrm{J/m^{3}}$,\n- $Y_{\\mathrm{H_{2}},\\mathrm{raw}} = 0.10$ and $Y_{\\mathrm{O_{2}},\\mathrm{raw}} = 0.90$,\n- cell momentum is zero, so the kinetic energy density is zero.\n\nTasks:\n1. Derive, from first principles of reacting compressible flow and the ideal-gas mixture EOS, a positivity-preserving temperature recovery algorithm that:\n   - enforces $\\rho \\ge \\rho_{\\min}$ and $Y_{k} \\ge Y_{\\min}$ followed by renormalization to $\\sum_{k} Y_{k} = 1$,\n   - computes the specific internal energy $u$ from the energy decomposition using $u = E/\\rho$ under zero kinetic energy,\n   - evaluates the minimum specific internal energy $u_{\\min}$ implied by $T_{\\min}$ through the monotonic mapping $u(T)$, and\n   - inverts $u(T)$ monotonically to recover $T$ when $u \\ge u_{\\min}$, otherwise sets $T = T_{\\min}$.\n2. Prove that, under $\\alpha_{k}  0$ and $\\beta_{k} \\ge 0$, the mapping $T \\mapsto u(T)$ is strictly monotonically increasing and thus admits a unique inverse on $[0,\\infty)$, guaranteeing $T  0$ when $u  0$ and $p  0$ via $p = \\rho\\,R_{\\mathrm{mix}}\\,T$ if $\\rho  0$.\n3. Apply your algorithm to the provided data to compute the recovered temperature $T$.\n\nRound your recovered temperature to four significant figures and express it in Kelvin. The final answer must be a single real number.",
            "solution": "The problem is validated as scientifically sound, well-posed, and objective. It presents a standard task in computational reacting flows: ensuring the physical positivity of thermodynamic variables recovered from a numerical update of conservative variables. All necessary definitions, constants, and data are provided without ambiguity or contradiction.\n\nThe solution is presented in three parts, as requested by the problem statement: derivation of the temperature recovery algorithm, proof of the monotonicity of the internal energy function, and application of the algorithm to the given data.\n\n### Task 1: Derivation of the Positivity-Preserving Temperature Recovery Algorithm\n\nThe algorithm constructs a valid thermodynamic state (specifically temperature $T$ and pressure $p$) from the cell-centered conservative variables (mass density $\\rho$, momentum density $\\rho \\vec{v}$, total energy density $E$, and species mass fractions $Y_k$).\n\n**Step 1: Enforce Physical Bounds on Primitives**\nThe raw outputs from the numerical update, denoted with a subscript 'raw', may violate physical constraints. To ensure positivity and physical realizability, lower bounds (floors) are applied.\nThe density $\\rho$ is bounded from below:\n$$\n\\rho = \\max(\\rho_{\\mathrm{raw}}, \\rho_{\\min})\n$$\nThe species mass fractions $Y_k$ are also floored. A temporary mass fraction $Y_{k, \\text{temp}}$ is first computed for each species $k$:\n$$\nY_{k, \\text{temp}} = \\max(Y_{k, \\mathrm{raw}}, Y_{\\min})\n$$\nTo ensure that the mass fractions sum to unity, a renormalization step is performed:\n$$\nY_k = \\frac{Y_{k, \\text{temp}}}{\\sum_{j} Y_{j, \\text{temp}}}\n$$\nThis procedure guarantees $\\rho \\ge \\rho_{\\min} > 0$, $Y_k \\ge Y_{\\min} > 0$ for all $k$, and $\\sum_k Y_k = 1$.\n\n**Step 2: Calculate Specific Internal Energy**\nThe total energy density $E$ is the sum of internal energy density and kinetic energy density:\n$$\nE = \\rho u + \\frac{1}{2}\\rho |\\vec{v}|^2\n$$\nwhere $u$ is the specific internal energy and $\\vec{v}$ is the fluid velocity. The problem states that the cell momentum is zero, which implies $\\vec{v} = \\vec{0}$. Consequently, the kinetic energy is zero. The total energy density from the raw update, $E_{\\mathrm{raw}}$, is thus equal to the internal energy density:\n$$\nE_{\\mathrm{raw}} = \\rho u\n$$\nUsing the floored density $\\rho$ from Step 1, the specific internal energy $u$ is recovered as:\n$$\nu = \\frac{E_{\\mathrm{raw}}}{\\rho}\n$$\n\n**Step 3: Define the Internal Energy Function and its Minimum**\nThe specific internal energy $u$ is a function of temperature $T$. Based on the provided definition, $u(T) = \\int_{0}^{T} c_{v,\\mathrm{mix}}(\\theta)\\,\\mathrm{d}\\theta$ with the reference $u(0)=0$. The mixture specific heat at constant volume $c_{v,\\mathrm{mix}}(T)$ is given by:\n$$\nc_{v,\\mathrm{mix}}(T) = \\sum_k Y_k c_{v,k}(T) = \\sum_k Y_k (\\alpha_k + \\beta_k T)\n$$\nThis can be written as a linear function of temperature:\n$$\nc_{v,\\mathrm{mix}}(T) = A + BT\n$$\nwhere the coefficients $A$ and $B$ are mixture-averaged constants dependent on the (floored and renormalized) mass fractions:\n$$\nA = \\sum_k Y_k \\alpha_k \\quad \\text{and} \\quad B = \\sum_k Y_k \\beta_k\n$$\nIntegrating $c_{v,\\mathrm{mix}}(T)$ from $0$ to $T$ yields the expression for specific internal energy:\n$$\nu(T) = \\int_0^T (A + B\\theta)\\,\\mathrm{d}\\theta = \\left[ A\\theta + \\frac{1}{2}B\\theta^2 \\right]_0^T = AT + \\frac{1}{2}BT^2\n$$\nThe minimum physically acceptable temperature is $T_{\\min}$. The corresponding minimum specific internal energy, $u_{\\min}$, is found by evaluating $u(T)$ at $T_{\\min}$:\n$$\nu_{\\min} = u(T_{\\min}) = AT_{\\min} + \\frac{1}{2}BT_{\\min}^2\n$$\n\n**Step 4: Invert for Temperature**\nThe final step is to recover the temperature $T$ from the calculated specific internal energy $u$. A check against the minimum energy $u_{\\min}$ is performed.\n- If $u  u_{\\min}$, the energy from the numerical update is unphysically low. In this case, the temperature is capped at its floor value to prevent collapse:\n  $$\n  T = T_{\\min}\n  $$\n- If $u \\ge u_{\\min}$, the temperature is found by inverting the monotonic function $u(T)$. This requires solving the quadratic equation for $T$:\n  $$\n  \\frac{1}{2}BT^2 + AT - u = 0\n  $$\n  The physically meaningful solution for $T$ must be positive. Applying the quadratic formula:\n  $$\n  T = \\frac{-A \\pm \\sqrt{A^2 - 4(\\frac{1}{2}B)(-u)}}{2(\\frac{1}{2}B)} = \\frac{-A \\pm \\sqrt{A^2 + 2Bu}}{B}\n  $$\n  As will be proven in Task 2, $A > 0$ and $B \\ge 0$. For a physically meaningful state, we require $u \\ge 0$. The term under the square root, $A^2 + 2Bu$, is greater than or equal to $A^2$. Therefore, $\\sqrt{A^2 + 2Bu} \\ge A$. To ensure a positive temperature $T > 0$, the positive root must be chosen:\n  $$\n  T = \\frac{-A + \\sqrt{A^2 + 2Bu}}{B}\n  $$\n  (Note: If $B=0$, the energy function is linear, $u=AT$, and the inversion is simply $T=u/A$.)\n\n### Task 2: Proof of Monotonicity and Positivity\n\nWe must prove that the mapping $T \\mapsto u(T)$ is strictly monotonically increasing for $T \\ge 0$, which ensures a unique inverse $T(u)$, and that this leads to positive temperature and pressure under the given conditions.\n\nThe derivative of the specific internal energy $u(T)$ with respect to temperature $T$ is the mixture specific heat at constant volume $c_{v,\\mathrm{mix}}(T)$:\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}T} = c_{v,\\mathrm{mix}}(T) = A + BT = \\left(\\sum_k Y_k \\alpha_k\\right) + \\left(\\sum_k Y_k \\beta_k\\right)T\n$$\nThe problem statement and the algorithm ensure the following conditions:\n1.  Mass fractions are strictly positive after flooring and renormalization: $Y_k > 0$ for all species $k$.\n2.  The specific heat coefficients are positive: $\\alpha_k > 0$ and $\\beta_k \\ge 0$ (the problem data has $\\beta_k>0$, but we use the condition from the proof requirement).\n\nFrom these conditions, we can analyze the signs of $A$ and $B$:\n-   The coefficient $A = \\sum_k Y_k \\alpha_k$ is a sum of products of strictly positive numbers ($Y_k > 0$ and $\\alpha_k > 0$). Therefore, $A > 0$.\n-   The coefficient $B = \\sum_k Y_k \\beta_k$ is a sum of products of a positive number ($Y_k$) and a non-negative number ($\\beta_k$). Therefore, $B \\ge 0$.\n\nNow we evaluate the derivative for $T \\ge 0$:\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}T} = A + BT\n$$\nSince $A > 0$ and $BT \\ge 0$ for $T \\ge 0$, their sum must be strictly positive:\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}T} > 0 \\quad \\text{for all } T \\ge 0\n$$\nA strictly positive derivative on the interval $[0, \\infty)$ implies that $u(T)$ is a strictly monotonically increasing function of $T$ on this interval. This guarantees that for any value of $u$ in the range of the function, there exists a unique corresponding value of $T$.\n\nFurthermore, since $u(0) = 0$ and the function is strictly increasing, if $u > 0$, then the recovered temperature $T$ must be greater than $0$.\n\nFinally, the pressure is given by the ideal-gas Equation of State: $p = \\rho R_{\\mathrm{mix}} T$.\n-   The density $\\rho$ is guaranteed to be positive by the floor: $\\rho \\ge \\rho_{\\min} > 0$.\n-   The recovered temperature $T$ is guaranteed to be positive (either $T=T_{\\min}>0$ or recovered from $u>u_{\\min}$, which implies $T>T_{\\min}>0$).\n-   The mixture gas constant $R_{\\mathrm{mix}} = \\sum_k Y_k R_k = \\sum_k Y_k \\frac{R_u}{W_k}$. Since $Y_k > 0$, the universal gas constant $R_u > 0$, and molecular weights $W_k > 0$, it follows that $R_{\\mathrm{mix}} > 0$.\n\nSince $p$ is a product of three strictly positive quantities ($\\rho, R_{\\mathrm{mix}}, T$), the pressure is guaranteed to be strictly positive: $p > 0$. This completes the proof.\n\n### Task 3: Application to Given Data\n\nWe now apply the derived algorithm to the specific data provided.\n\n**Given Data:**\n-   $\\rho_{\\mathrm{raw}} = 1.0\\,\\mathrm{kg/m^{3}}$, $E_{\\mathrm{raw}} = 1.2 \\times 10^{6}\\,\\mathrm{J/m^{3}}$\n-   $Y_{\\mathrm{H_{2}},\\mathrm{raw}} = 0.10$, $Y_{\\mathrm{O_{2}},\\mathrm{raw}} = 0.90$\n-   $\\rho_{\\min} = 10^{-6}\\,\\mathrm{kg/m^{3}}$, $Y_{\\min} = 10^{-8}$, $T_{\\min} = 300\\,\\mathrm{K}$\n-   $\\alpha_{\\mathrm{H_{2}}} = 1.0 \\times 10^{4}\\,\\mathrm{J/(kg\\cdot K)}$, $\\beta_{\\mathrm{H_{2}}} = 5.0\\,\\mathrm{J/(kg\\cdot K^{2})}$\n-   $\\alpha_{\\mathrm{O_{2}}} = 7.0 \\times 10^{2}\\,\\mathrm{J/(kg\\cdot K)}$, $\\beta_{\\mathrm{O_{2}}} = 0.3\\,\\mathrm{J/(kg\\cdot K^{2})}$\n\n**Step 1: Enforce Bounds**\n-   $\\rho = \\max(1.0, 10^{-6}) = 1.0\\,\\mathrm{kg/m^{3}}$.\n-   $Y_{\\mathrm{H_{2}},\\text{temp}} = \\max(0.10, 10^{-8}) = 0.10$.\n-   $Y_{\\mathrm{O_{2}},\\text{temp}} = \\max(0.90, 10^{-8}) = 0.90$.\n-   Sum of temporary fractions = $0.10 + 0.90 = 1.0$. Renormalization is not needed.\n-   Final mass fractions: $Y_{\\mathrm{H_{2}}} = 0.10$, $Y_{\\mathrm{O_{2}}} = 0.90$.\n\n**Step 2: Calculate Specific Internal Energy**\nWith zero kinetic energy, $u = E_{\\mathrm{raw}} / \\rho$.\n$$\nu = \\frac{1.2 \\times 10^{6}\\,\\mathrm{J/m^{3}}}{1.0\\,\\mathrm{kg/m^{3}}} = 1.2 \\times 10^{6}\\,\\mathrm{J/kg}\n$$\n\n**Step 3: Calculate Coefficients and Minimum Energy**\nFirst, compute the mixture coefficients $A$ and $B$.\n$$\nA = Y_{\\mathrm{H_{2}}}\\alpha_{\\mathrm{H_{2}}} + Y_{\\mathrm{O_{2}}}\\alpha_{\\mathrm{O_{2}}} = (0.10)(1.0 \\times 10^{4}) + (0.90)(7.0 \\times 10^{2}) = 1000 + 630 = 1630\\,\\mathrm{J/(kg\\cdot K)}\n$$\n$$\nB = Y_{\\mathrm{H_{2}}}\\beta_{\\mathrm{H_{2}}} + Y_{\\mathrm{O_{2}}}\\beta_{\\mathrm{O_{2}}} = (0.10)(5.0) + (0.90)(0.3) = 0.50 + 0.27 = 0.77\\,\\mathrm{J/(kg\\cdot K^{2})}\n$$\nNext, compute the minimum internal energy $u_{\\min}$ at $T_{\\min} = 300\\,\\mathrm{K}$.\n$$\nu_{\\min} = AT_{\\min} + \\frac{1}{2}BT_{\\min}^2 = (1630)(300) + \\frac{1}{2}(0.77)(300)^2\n$$\n$$\nu_{\\min} = 489000 + (0.385)(90000) = 489000 + 34650 = 523650\\,\\mathrm{J/kg}\n$$\n\n**Step 4: Invert for Temperature**\nCompare the computed specific internal energy $u$ with the minimum value $u_{\\min}$:\n$$\nu = 1.2 \\times 10^{6}\\,\\mathrm{J/kg} \\quad \\text{and} \\quad u_{\\min} = 5.2365 \\times 10^5\\,\\mathrm{J/kg}\n$$\nSince $u > u_{\\min}$, we solve the quadratic equation for $T$:\n$$\nT = \\frac{-A + \\sqrt{A^2 + 2Bu}}{B}\n$$\nSubstitute the values for $A$, $B$, and $u$:\n$$\nT = \\frac{-1630 + \\sqrt{(1630)^2 + 2(0.77)(1.2 \\times 10^{6})}}{0.77}\n$$\n$$\nT = \\frac{-1630 + \\sqrt{2656900 + 1848000}}{0.77}\n$$\n$$\nT = \\frac{-1630 + \\sqrt{4504900}}{0.77}\n$$\n$$\nT = \\frac{-1630 + 2122.4759}{0.77} = \\frac{492.4759}{0.77} \\approx 639.5791\\,\\mathrm{K}\n$$\nRounding the result to four significant figures, as requested:\n$$\nT \\approx 639.6\\,\\mathrm{K}\n$$\nThe recovered temperature is $639.6\\,\\mathrm{K}$.",
            "answer": "$$\\boxed{639.6}$$"
        }
    ]
}