{
    "hands_on_practices": [
        {
            "introduction": "The power of the Discontinuous Galerkin (DG) method lies in its use of local, polynomial basis functions to construct high-order accurate schemes. This exercise provides foundational practice by guiding you through the construction of the essential mass and stiffness matrices on a canonical reference element . By analyzing how these matrices transform from the reference domain to a physical grid, you will gain a deeper understanding of the isoparametric mapping and its critical role in ensuring discrete conservation, a cornerstone of robust numerical methods for reactive flows.",
            "id": "4020013",
            "problem": "Consider a one-dimensional reactive species transport governed by the conservative advection–diffusion–reaction law\n$$\\frac{\\partial (\\rho Y)}{\\partial t} + \\frac{\\partial J}{\\partial x} = \\omega,$$\nwhere $\\rho$ is the mixture density, $Y$ is the species mass fraction, $J$ is the diffusive–advective flux, and $\\omega$ is the chemical source term. In the interior volume contribution for diffusion, the Discontinuous Galerkin (DG) method is based on a Galerkin projection using a local polynomial basis and exact quadrature to ensure conservation of fluxes and sources. Consider a single DG element and focus on the diffusion operator’s volume term on the canonical reference element $\\xi \\in [-1,1]$.\n\nUse the modal basis of Legendre polynomials up to degree $2$,\n$$\\phi_{0}(\\xi) = 1, \\quad \\phi_{1}(\\xi) = \\xi, \\quad \\phi_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2},$$\nand define the reference-element mass matrix and stiffness matrix by\n$$M_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi, \\qquad K_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\frac{d\\phi_{i}}{d\\xi}(\\xi)\\,\\frac{d\\phi_{j}}{d\\xi}(\\xi)\\,d\\xi.$$\n\n1. Construct $M^{\\mathrm{ref}}$ and $K^{\\mathrm{ref}}$ explicitly by evaluating the above integrals.\n2. Map the reference element to a physical element $x \\in [x_{L},x_{R}]$ by the affine isoparametric transformation $x(\\xi) = x_{c} + J\\,\\xi$ with constant Jacobian $J = \\frac{x_{R} - x_{L}}{2}$. Derive the scaling of the physical-element matrices $M^{\\mathrm{phys}}$ and $K^{\\mathrm{phys}}$ relative to $M^{\\mathrm{ref}}$ and $K^{\\mathrm{ref}}$.\n3. Explain, in the context of both the Discontinuous Galerkin (DG) method and the Lattice Boltzmann Method (LBM), how the isoparametric mapping and exact quadrature ensure discrete conservation of the advective–diffusive fluxes for a constant solution and prevent spurious geometric source terms, assuming $\\omega = 0$ and consistent numerical fluxes across element interfaces.\n4. For a physical element with $J = 3$, compute the largest eigenvalue of the operator $(M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}}$ exactly. Provide your final answer as a single exact value with no units.\n\nNo rounding is required; an exact expression is expected for the final answer.",
            "solution": "The problem will be addressed by completing the four specified parts in sequence.\n\n### Step 1: Problem Validation\n\n**Givens Extraction:**\n- Governing Equation: $\\frac{\\partial (\\rho Y)}{\\partial t} + \\frac{\\partial J}{\\partial x} = \\omega$\n- DG Element: Canonical reference element $\\xi \\in [-1,1]$\n- Modal Basis (Legendre polynomials up to degree $2$):\n  - $\\phi_{0}(\\xi) = 1$\n  - $\\phi_{1}(\\xi) = \\xi$\n  - $\\phi_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}$\n- Reference-element mass matrix definition: $M_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi$\n- Reference-element stiffness matrix definition: $K_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\frac{d\\phi_{i}}{d\\xi}(\\xi)\\,\\frac{d\\phi_{j}}{d\\xi}(\\xi)\\,d\\xi$\n- Mapping to physical element $x \\in [x_{L},x_{R}]$: $x(\\xi) = x_{c} + J\\,\\xi$\n- Jacobian of the mapping: $J = \\frac{x_{R} - x_{L}}{2}$\n- Condition for Part 3: $\\omega = 0$, constant solution, consistent numerical fluxes.\n- Condition for Part 4: Jacobian $J = 3$.\n\n**Validation:**\n1.  **Scientifically Grounded:** The problem is firmly rooted in the theory of the Discontinuous Galerkin (DG) method, a standard and widely used numerical technique in computational science and engineering, particularly for problems involving hyperbolic conservation laws like the one given. The definitions of the mass and stiffness matrices, the choice of Legendre polynomials as basis functions, and the use of an isoparametric mapping are all standard practices in finite element and DG methods.\n2.  **Well-Posed:** All parts of the problem are precisely stated. Parts 1, 2, and 4 require specific calculations based on well-defined mathematical objects. Part 3 requires a conceptual explanation based on established principles of the DG method (specifically, the Geometric Conservation Law or GCL).\n3.  **Objective:** The problem is phrased in objective, technical language, free from ambiguity or subjective claims.\n4.  **Complete and Consistent:** The information provided is sufficient to carry out all required tasks. There are no internal contradictions.\n\n**Verdict:** The problem is valid.\n\n### Step 2: Solution\n\n#### Part 1: Construction of $M^{\\mathrm{ref}}$ and $K^{\\mathrm{ref}}$\n\nThe basis functions provided, $\\phi_{0}(\\xi)$, $\\phi_{1}(\\xi)$, and $\\phi_{2}(\\xi)$, are the standard Legendre polynomials $P_{0}(\\xi)$, $P_{1}(\\xi)$, and $P_{2}(\\xi)$. Legendre polynomials are orthogonal on the interval $[-1,1]$ with the property:\n$$ \\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi) d\\xi = \\frac{2}{2i+1} \\delta_{ij} $$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\n**Mass Matrix $M^{\\mathrm{ref}}$:**\nThe elements of the mass matrix are $M_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi$. Due to the orthogonality property, all off-diagonal elements ($i \\neq j$) are zero. We compute the diagonal elements:\n$$ M_{00}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\phi_{0}(\\xi) d\\xi = \\frac{2}{2(0)+1} = 2 $$\n$$ M_{11}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{1}(\\xi)\\phi_{1}(\\xi) d\\xi = \\frac{2}{2(1)+1} = \\frac{2}{3} $$\n$$ M_{22}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{2}(\\xi)\\phi_{2}(\\xi) d\\xi = \\frac{2}{2(2)+1} = \\frac{2}{5} $$\nThus, the reference mass matrix is a diagonal matrix:\n$$ M^{\\mathrm{ref}} = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{2}{5} \\end{pmatrix} $$\n\n**Stiffness Matrix $K^{\\mathrm{ref}}$:**\nThe elements of the stiffness matrix are $K_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\frac{d\\phi_{i}}{d\\xi}(\\xi)\\,\\frac{d\\phi_{j}}{d\\xi}(\\xi)\\,d\\xi$. First, we compute the derivatives of the basis functions:\n$$ \\frac{d\\phi_{0}}{d\\xi} = \\frac{d}{d\\xi}(1) = 0 $$\n$$ \\frac{d\\phi_{1}}{d\\xi} = \\frac{d}{d\\xi}(\\xi) = 1 $$\n$$ \\frac{d\\phi_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{3\\xi^{2}-1}{2}\\right) = 3\\xi $$\nNow we compute the integrals for the matrix elements:\n$$ K_{0j}^{\\mathrm{ref}} = \\int_{-1}^{1} (0) \\frac{d\\phi_{j}}{d\\xi} d\\xi = 0 \\quad \\text{for } j=0,1,2. \\text{ By symmetry, } K_{i0}^{\\mathrm{ref}} = 0. $$\n$$ K_{11}^{\\mathrm{ref}} = \\int_{-1}^{1} (1)(1) d\\xi = [\\xi]_{-1}^{1} = 1 - (-1) = 2 $$\n$$ K_{12}^{\\mathrm{ref}} = \\int_{-1}^{1} (1)(3\\xi) d\\xi = 3 \\left[\\frac{\\xi^{2}}{2}\\right]_{-1}^{1} = 3 \\left(\\frac{1}{2} - \\frac{1}{2}\\right) = 0. \\text{ By symmetry, } K_{21}^{\\mathrm{ref}} = 0. $$\n$$ K_{22}^{\\mathrm{ref}} = \\int_{-1}^{1} (3\\xi)(3\\xi) d\\xi = 9 \\int_{-1}^{1} \\xi^{2} d\\xi = 9 \\left[\\frac{\\xi^{3}}{3}\\right]_{-1}^{1} = 9 \\left(\\frac{1}{3} - \\frac{-1}{3}\\right) = 9 \\left(\\frac{2}{3}\\right) = 6 $$\nThus, the reference stiffness matrix is also a diagonal matrix:\n$$ K^{\\mathrm{ref}} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix} $$\n\n#### Part 2: Scaling of Physical-Element Matrices\n\nThe physical-element matrices $M^{\\mathrm{phys}}$ and $K^{\\mathrm{phys}}$ are defined by integrals over the physical element $x \\in [x_{L}, x_{R}]$. We use the affine mapping $x(\\xi) = x_{c} + J\\xi$ to transform these integrals back to the reference element $\\xi \\in [-1,1]$. The differential element transforms as $dx = \\frac{dx}{d\\xi}d\\xi = J d\\xi$.\n\n**Physical Mass Matrix $M^{\\mathrm{phys}}$:**\nThe integral for the physical mass matrix is:\n$$ M_{ij}^{\\mathrm{phys}} = \\int_{x_L}^{x_R} \\phi_i(\\xi(x)) \\phi_j(\\xi(x)) dx $$\nChanging variables to $\\xi$:\n$$ M_{ij}^{\\mathrm{phys}} = \\int_{-1}^{1} \\phi_i(\\xi) \\phi_j(\\xi) (J d\\xi) = J \\int_{-1}^{1} \\phi_i(\\xi) \\phi_j(\\xi) d\\xi = J M_{ij}^{\\mathrm{ref}} $$\nTherefore, the physical mass matrix scales linearly with the Jacobian:\n$$ M^{\\mathrm{phys}} = J M^{\\mathrm{ref}} $$\n\n**Physical Stiffness Matrix $K^{\\mathrm{phys}}$:**\nThe stiffness matrix arises from the weak form of a second-derivative operator, for instance, $\\int \\frac{dv}{dx}\\frac{du}{dx} dx$. For our basis, this gives:\n$$ K_{ij}^{\\mathrm{phys}} = \\int_{x_L}^{x_R} \\frac{d\\phi_i}{dx}(\\xi(x)) \\frac{d\\phi_j}{dx}(\\xi(x)) dx $$\nWe use the chain rule to relate physical and reference derivatives: $\\frac{d}{d\\xi} = \\frac{dx}{d\\xi}\\frac{d}{dx} = J \\frac{d}{dx}$, which implies $\\frac{d}{dx} = \\frac{1}{J}\\frac{d}{d\\xi}$.\nSubstituting this and $dx = J d\\xi$ into the integral:\n$$ K_{ij}^{\\mathrm{phys}} = \\int_{-1}^{1} \\left(\\frac{1}{J}\\frac{d\\phi_i}{d\\xi}\\right) \\left(\\frac{1}{J}\\frac{d\\phi_j}{d\\xi}\\right) (J d\\xi) = \\frac{J}{J^2} \\int_{-1}^{1} \\frac{d\\phi_i}{d\\xi} \\frac{d\\phi_j}{d\\xi} d\\xi = \\frac{1}{J} K_{ij}^{\\mathrm{ref}} $$\nTherefore, the physical stiffness matrix scales with the inverse of the Jacobian:\n$$ K^{\\mathrm{phys}} = \\frac{1}{J} K^{\\mathrm{ref}} $$\n\n#### Part 3: Explanation of Conservation\n\nThis question relates to the Geometric Conservation Law (GCL), which states that a numerical scheme must reproduce a constant state exactly on any mesh. In the context of the given problem with $\\omega=0$, this means that if the solution $Y$ is constant, its time derivative must be zero, and no spurious fluxes or sources should be generated by the discretization itself.\n\n**Discontinuous Galerkin (DG) Method:**\nThe semi-discrete DG formulation for the governing equation on a physical element $\\Omega_e = [x_L, x_R]$ without sources is:\n$$ \\int_{\\Omega_e} \\frac{\\partial (\\rho Y)_h}{\\partial t} \\phi_i dx + \\int_{\\Omega_e} \\frac{\\partial J_h}{\\partial x} \\phi_i dx = 0 $$\nwhere $(\\rho Y)_h$ is the polynomial approximation of the solution. Integrating the flux term by parts yields:\n$$ \\frac{d}{dt} \\int_{\\Omega_e} (\\rho Y)_h \\phi_i dx + \\left[ \\hat{J} \\phi_i \\right]_{x_L}^{x_R} - \\int_{\\Omega_e} J_h \\frac{d\\phi_i}{dx} dx = 0 $$\nHere, $\\hat{J}$ is the numerical flux at the element interfaces.\n\nConsider a constant solution, $(\\rho Y)_h = C$. Since $\\phi_0(\\xi) = 1$ is in our basis, this constant state is represented exactly by setting the coefficient of $\\phi_0$ to $C$ and all other coefficients to zero.\n1.  **Volume Integral Term:** The volume integral involving the flux derivative is $\\int_{\\Omega_e} J_h \\frac{d\\phi_i}{dx} dx$. The flux $J$ contains diffusive and advective parts. For diffusion, $J \\propto \\frac{\\partial (\\rho Y)}{\\partial x}$, and for advection, $J \\propto \\rho Y$. For a constant solution $(\\rho Y)_h = C$, the diffusive flux is zero because the gradient is zero. The advective flux is constant, $J_{adv} = uC$. The integral becomes $\\int_{\\Omega_e} uC \\frac{d\\phi_i}{dx} dx = uC \\int_{x_L}^{x_R} \\frac{d\\phi_i}{dx} dx = uC[\\phi_i]_{x_L}^{x_R}$. This has to be balanced by the boundary fluxes. More fundamentally, the stiffness matrix term we computed corresponds to the diffusion operator. For a constant solution, the vector of solution coefficients is proportional to $(1, 0, 0, \\dots)^T$. The contribution from the stiffness matrix to the residual is $K^{\\mathrm{phys}} \\cdot (C, 0, 0)^T$. As shown in Part 1, the first column of $K^{\\mathrm{ref}}$ (and thus $K^{\\mathrm{phys}}$) is zero because $\\frac{d\\phi_0}{d\\xi}=0$. Therefore, the volume integral contribution from the diffusion operator for a constant solution is identically zero.\n2.  **Isoparametric Mapping and Exact Quadrature:** Spurious geometric source terms arise when the discrete operators do not correctly represent the geometry, specifically when the discrete divergence theorem is violated. For the affine mapping $x(\\xi) = x_c + J\\xi$, the Jacobian $J$ is constant. The integrands for the mass and stiffness matrices are polynomials in $\\xi$. By using a quadrature rule that is exact for these polynomials (e.g., Gaussian quadrature of sufficient order), the discrete matrices $M^{\\mathrm{phys}}$ and $K^{\\mathrm{phys}}$ are computed without error relative to the analytical integrals. This exact integration ensures that the geometric transformation does not introduce any artificial source terms. This property is crucial for satisfying the GCL. If the mapping were non-linear (e.g., for curved elements), the Jacobian would be a function $J(\\xi)$, and if the quadrature were not exact for the resulting non-polynomial integrands, spurious sources could be generated.\n3.  **Numerical Flux:** With a constant solution $Y=C$ everywhere, the states on both sides of any interface are identical. A consistent numerical flux $\\hat{J}$ must satisfy $\\hat{J}(C, C) = J(C)$. Thus, the surface flux terms $\\left[ \\hat{J} \\phi_i \\right]_{x_L}^{x_R}$ will correctly balance the physical flux, preventing spurious generation at interfaces.\n\n**Lattice Boltzmann Method (LBM):**\nThe LBM operates on a fixed, regular lattice. Conservation is ensured by the structure of the collision operator, which relaxes populations towards a local equilibrium that has the desired conserved moments (mass, momentum). The \"GCL\" concept is analogous to ensuring that boundary conditions or interfaces between different grid blocks do not act as artificial sources or sinks of conserved quantities. For instance, a simple bounce-back boundary rule on a staircase approximation of an inclined wall is known to violate momentum conservation, creating spurious drag. Advanced boundary conditions in LBM are designed to be mass- and momentum-conserving. In this sense, both DG and LBM require careful formulation of the scheme elements (exact quadrature for DG, specific boundary operators for LBM) to ensure that the discrete representation of geometry does not violate the fundamental physical conservation laws.\n\n#### Part 4: Eigenvalue Calculation\n\nWe need to compute the largest eigenvalue of the operator $(M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}}$ for a physical element with Jacobian $J = 3$. From the scaling relations derived in Part 2:\n$$ M^{\\mathrm{phys}} = J M^{\\mathrm{ref}} $$\n$$ K^{\\mathrm{phys}} = \\frac{1}{J} K^{\\mathrm{ref}} $$\nThe operator can be expressed in terms of the reference matrices:\n$$ (M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}} = (J M^{\\mathrm{ref}})^{-1} \\left(\\frac{1}{J} K^{\\mathrm{ref}}\\right) = \\left(\\frac{1}{J} (M^{\\mathrm{ref}})^{-1}\\right) \\left(\\frac{1}{J} K^{\\mathrm{ref}}\\right) = \\frac{1}{J^2} (M^{\\mathrm{ref}})^{-1} K^{\\mathrm{ref}} $$\nUsing the matrices computed in Part 1:\n$$ M^{\\mathrm{ref}} = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{2}{5} \\end{pmatrix} \\quad \\implies \\quad (M^{\\mathrm{ref}})^{-1} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{3}{2} & 0 \\\\ 0 & 0 & \\frac{5}{2} \\end{pmatrix} $$\n$$ K^{\\mathrm{ref}} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix} $$\nNow, we compute the product $(M^{\\mathrm{ref}})^{-1} K^{\\mathrm{ref}}$:\n$$ (M^{\\mathrm{ref}})^{-1} K^{\\mathrm{ref}} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{3}{2} & 0 \\\\ 0 & 0 & \\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix} = \\begin{pmatrix} (\\frac{1}{2})(0) & 0 & 0 \\\\ 0 & (\\frac{3}{2})(2) & 0 \\\\ 0 & 0 & (\\frac{5}{2})(6) \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 15 \\end{pmatrix} $$\nThe eigenvalues of this diagonal matrix are its diagonal entries: $\\{0, 3, 15\\}$.\nFinally, we scale these eigenvalues by the factor $\\frac{1}{J^2}$. With $J=3$, the scaling factor is $\\frac{1}{3^2} = \\frac{1}{9}$.\nThe eigenvalues of $(M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}}$ are:\n$$ \\left\\{ \\frac{1}{9}(0), \\frac{1}{9}(3), \\frac{1}{9}(15) \\right\\} = \\left\\{ 0, \\frac{3}{9}, \\frac{15}{9} \\right\\} = \\left\\{ 0, \\frac{1}{3}, \\frac{5}{3} \\right\\} $$\nThe largest eigenvalue of the operator is $\\frac{15}{9}$, which simplifies to $\\frac{5}{3}$.",
            "answer": "$$\\boxed{\\frac{5}{3}}$$"
        },
        {
            "introduction": "Unlike methods that directly discretize macroscopic equations, the Lattice Boltzmann Method (LBM) simulates fluid dynamics from a mesoscopic perspective, where transport properties emerge from particle collision and streaming rules. This practice problem focuses on the crucial task of connecting LBM's internal parameters—specifically the relaxation times—to the physical transport coefficients of a fluid . By learning to design relaxation parameters that achieve a target kinematic viscosity and Prandtl number, you will master a key skill for applying LBM to accurately model real-world phenomena like combustion.",
            "id": "4020053",
            "problem": "Consider a low-Mach reactive mixture to be simulated with a thermal Lattice Boltzmann Method (LBM), using the double-distribution function (DDF) approach with single-relaxation-time (SRT) Bhatnagar-Gross-Krook (BGK) collisions for momentum and temperature. Both the momentum and temperature fields are discretized on the two-dimensional nine-velocity lattice (D2Q9), for which the lattice streaming speed is $c = \\delta x / \\delta t$ and the lattice sound speed is $c_{s} = c / \\sqrt{3}$. The objective is to ensure that the LBM recovers the correct diffusive transport in the hydrodynamic limit for reactive flows and achieves a target Prandtl number consistent with combustion modeling. This design is also intended to be consistent with transport coefficients used in Discontinuous Galerkin (DG) solvers for reactive flow validation.\n\nYou are given a grid spacing $\\delta x = 1.0 \\times 10^{-5}\\,\\mathrm{m}$ and a time step $\\delta t = 1.0 \\times 10^{-6}\\,\\mathrm{s}$. For the existing simulation, the momentum relaxation time is $\\tau_{v,0} = 0.62$ and the temperature relaxation time is $\\tau_{T,0} = 0.545$.\n\nTasks:\n1. Using the LBM hydrodynamic limit for the D2Q9 lattice, compute the effective Prandtl number realized by the existing relaxation times.\n2. Design new relaxation parameters $\\tau_{v}$ and $\\tau_{T}$ that achieve a target physical kinematic viscosity $\\nu_{\\mathrm{phys}} = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ and a desired Prandtl number $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$ in the same lattice configuration.\n\nBase your derivation on:\n- Conservation of mass, momentum, and energy in a low-Mach reactive flow,\n- The recovery of the Navier–Stokes and advection–diffusion equations via Chapman–Enskog analysis,\n- The D2Q9 relations between relaxation times and transport coefficients.\n\nReport three numbers: the effective Prandtl number from the existing relaxation times, the designed $\\tau_{v}$, and the designed $\\tau_{T}$. The effective Prandtl number is dimensionless; the relaxation times are dimensionless. Round the effective Prandtl number to four significant figures, and round each relaxation time to five significant figures. Present the final answer as a single row vector. No units are to be included in the final answer.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All provided data are consistent with standard practices in the field of computational fluid dynamics, specifically the Lattice Boltzmann Method (LBM) for thermal flows. The relationships between LBM parameters and macroscopic transport coefficients are well-established through Chapman-Enskog analysis. Therefore, a solution can be derived.\n\nThe core of this problem lies in the relationships between the transport coefficients of a fluid and the parameters of its LBM simulation. For a two-dimensional, nine-velocity (D2Q9) lattice model using the single-relaxation-time (SRT) Bhatnagar-Gross-Krook (BGK) collision operator, the kinematic viscosity ($\\nu$) and thermal diffusivity ($\\alpha$) are related to the momentum relaxation time ($\\tau_v$) and the temperature relaxation time ($\\tau_T$), respectively.\n\nThe derivation from the Boltzmann equation to the macroscopic Navier-Stokes and advection-diffusion equations via Chapman-Enskog expansion yields the following expressions for the transport coefficients:\n$$ \\nu = c_s^2 \\left(\\tau_v - \\frac{1}{2}\\right) \\delta t $$\n$$ \\alpha = c_s^2 \\left(\\tau_T - \\frac{1}{2}\\right) \\delta t $$\nwhere $c_s$ is the lattice speed of sound and $\\delta t$ is the time step. For the D2Q9 lattice, the speed of sound is given by $c_s = \\frac{c}{\\sqrt{3}}$, where $c = \\frac{\\delta x}{\\delta t}$ is the lattice streaming speed, with $\\delta x$ being the grid spacing.\n\nSubstituting the expressions for $c_s$ and $c$:\n$$ c_s^2 = \\frac{c^2}{3} = \\frac{1}{3} \\left(\\frac{\\delta x}{\\delta t}\\right)^2 $$\nThus, the transport coefficients can be written in terms of the fundamental lattice parameters:\n$$ \\nu = \\frac{1}{3} \\frac{\\delta x^2}{\\delta t^2} \\left(\\tau_v - \\frac{1}{2}\\right) \\delta t = \\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_v - \\frac{1}{2}\\right) $$\n$$ \\alpha = \\frac{1}{3} \\frac{\\delta x^2}{\\delta t^2} \\left(\\tau_T - \\frac{1}{2}\\right) \\delta t = \\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_T - \\frac{1}{2}\\right) $$\nFor numerical stability of the SRT-BGK scheme, the relaxation times must satisfy $\\tau_v > 0.5$ and $\\tau_T > 0.5$. The given initial values $\\tau_{v,0} = 0.62$ and $\\tau_{T,0} = 0.545$ satisfy this condition.\n\nThe Prandtl number, $\\mathrm{Pr}$, is a dimensionless quantity defined as the ratio of kinematic viscosity to thermal diffusivity:\n$$ \\mathrm{Pr} = \\frac{\\nu}{\\alpha} $$\nUsing the LBM expressions for $\\nu$ and $\\alpha$:\n$$ \\mathrm{Pr} = \\frac{\\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_v - 0.5\\right)}{\\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_T - 0.5\\right)} = \\frac{\\tau_v - 0.5}{\\tau_T - 0.5} $$\nThis fundamental relation shows that for this LBM model, the Prandtl number is determined solely by the relaxation times.\n\n**Task 1: Compute the effective Prandtl number**\n\nWe are given the initial relaxation times $\\tau_{v,0} = 0.62$ and $\\tau_{T,0} = 0.545$. The effective Prandtl number, $\\mathrm{Pr}_{\\mathrm{eff}}$, is calculated using the formula derived above:\n$$ \\mathrm{Pr}_{\\mathrm{eff}} = \\frac{\\tau_{v,0} - 0.5}{\\tau_{T,0} - 0.5} $$\nSubstituting the given values:\n$$ \\mathrm{Pr}_{\\mathrm{eff}} = \\frac{0.62 - 0.5}{0.545 - 0.5} = \\frac{0.12}{0.045} = \\frac{120}{45} = \\frac{8}{3} $$\nAs a decimal, this is approximately $2.6666...$. Rounding to four significant figures as requested, we get:\n$$ \\mathrm{Pr}_{\\mathrm{eff}} \\approx 2.667 $$\n\n**Task 2: Design new relaxation parameters**\n\nWe need to find new relaxation times, $\\tau_v$ and $\\tau_T$, that result in a target physical kinematic viscosity $\\nu_{\\mathrm{phys}} = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ and a desired Prandtl number $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$.\n\nFirst, we determine the new momentum relaxation time, $\\tau_v$, by setting the LBM kinematic viscosity equal to the target physical value:\n$$ \\nu_{\\mathrm{phys}} = \\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_v - 0.5\\right) $$\nSolving for $\\tau_v$:\n$$ \\tau_v - 0.5 = \\frac{3 \\delta t \\nu_{\\mathrm{phys}}}{\\delta x^2} $$\n$$ \\tau_v = 0.5 + \\frac{3 \\delta t \\nu_{\\mathrm{phys}}}{\\delta x^2} $$\nWe are given $\\delta x = 1.0 \\times 10^{-5}\\,\\mathrm{m}$, $\\delta t = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, and $\\nu_{\\mathrm{phys}} = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$. Substituting these values:\n$$ \\tau_v = 0.5 + \\frac{3 \\times (1.0 \\times 10^{-6}) \\times (3.2 \\times 10^{-5})}{(1.0 \\times 10^{-5})^2} = 0.5 + \\frac{9.6 \\times 10^{-11}}{1.0 \\times 10^{-10}} $$\n$$ \\tau_v = 0.5 + 0.96 = 1.46 $$\nThe requested rounding is to five significant figures, so $\\tau_v = 1.4600$. This value is greater than $0.5$, ensuring stability.\n\nNext, we determine the new temperature relaxation time, $\\tau_T$, using the desired Prandtl number $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$ and the newly calculated $\\tau_v$.\n$$ \\mathrm{Pr}_{\\mathrm{des}} = \\frac{\\tau_v - 0.5}{\\tau_T - 0.5} $$\nSolving for $\\tau_T$:\n$$ \\tau_T - 0.5 = \\frac{\\tau_v - 0.5}{\\mathrm{Pr}_{\\mathrm{des}}} $$\n$$ \\tau_T = 0.5 + \\frac{\\tau_v - 0.5}{\\mathrm{Pr}_{\\mathrm{des}}} $$\nSubstituting $\\tau_v = 1.46$ and $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$:\n$$ \\tau_T = 0.5 + \\frac{1.46 - 0.5}{0.7} = 0.5 + \\frac{0.96}{0.7} $$\n$$ \\tau_T \\approx 0.5 + 1.37142857... = 1.87142857... $$\nRounding to five significant figures as requested:\n$$ \\tau_T \\approx 1.8714 $$\nThis value is also greater than $0.5$, ensuring stability for the thermal field.\n\nThe three required numbers are the effective Prandtl number from the existing setup and the two new designed relaxation times.\n- $\\mathrm{Pr}_{\\mathrm{eff}} \\approx 2.667$\n- $\\tau_v = 1.4600$\n- $\\tau_T \\approx 1.8714$\nThese will be presented as a single row vector.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.667 & 1.4600 & 1.8714\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A critical task for any computational scientist is to distinguish physical reality from numerical artifacts introduced by the discretization scheme. This exercise tackles this challenge head-on by modeling the numerical error of a scheme as an effective dissipation that artificially alters a physical observable—the laminar flame speed . By performing a systematic grid refinement study and using regression analysis, you will learn a powerful technique to quantify the impact of numerical dissipation and extrapolate your results to the ideal, zero-grid-spacing limit, thereby recovering a more accurate estimate of the physical solution.",
            "id": "4020063",
            "problem": "Consider a one-dimensional premixed reactive flow model where the progress variable $Y(x,t)$ satisfies the advection-reaction-diffusion equation in a comoving reference frame with zero bulk advection,\n$$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial x^2} + k\\,Y(1-Y),$$\nwhere $D$ is the molecular diffusion coefficient and $k$ is an effective first-order reaction rate constant. For such a Fisher–Kolmogorov–Petrovsky–Piskunov traveling wave, the theoretical laminar flame speed in the comoving frame is\n$$s_L = 2\\sqrt{D\\,k}.$$\nIn numerical discretizations such as the discontinuous Galerkin method and the lattice Boltzmann method, stabilization or relaxation mechanisms introduce numerical dissipation, which can be modeled as an additional effective diffusion,\n$$D_{\\text{eff}}(h) = D + D_{\\text{num}}(h),\\quad D_{\\text{num}}(h) = \\alpha\\,h^r,$$\nwhere $h$ is a grid spacing, $r$ is a scheme-dependent exponent tied to the leading-order truncation error, and $\\alpha$ is a method-dependent coefficient aggregating stabilization strength. In this model, the predicted laminar flame speed at resolution $h$ is\n$$\\hat{s}(h) = 2\\sqrt{k\\,D_{\\text{eff}}(h)} = 2\\sqrt{k\\,(D + \\alpha h^r)}.$$\n\nYour tasks are:\n1. Using the given $(D,k,\\alpha,r)$ and a list of grid spacings $h_i$, compute the predicted speeds $\\hat{s}(h_i)$.\n2. Propose and implement a calibration method to separate physical and numerical effects by regressing the squared speeds against $h^r$ to recover the physical speed in the zero-dissipation limit. Specifically, fit\n$$\\hat{s}(h)^2 = b_0 + b_1\\,h^r,$$\nby least squares over the provided $h_i$, and use $b_0$ to estimate the physical laminar flame speed,\n$$\\hat{s}_L^{(0)} = \\sqrt{b_0}.$$\n3. Quantify the effect of numerical dissipation at the coarsest grid $h_{\\max}$ by computing the fractional error\n$$\\varepsilon(h_{\\max}) = \\frac{\\hat{s}(h_{\\max}) - s_L}{s_L},$$\nwhere $s_L = 2\\sqrt{Dk}$ is the exact physical laminar flame speed from the underlying model.\n\nAll speeds must be expressed in meters per second (m/s). Fractional errors must be expressed as decimal fractions without the percentage sign. In all outputs, round to six decimal places.\n\nTest suite:\n- Case 1 (discontinuous Galerkin, first-order leading dissipation): $D=1.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$, $k=500\\,\\text{s}^{-1}$, $\\alpha=1.0\\times 10^{-2}$ in units consistent with $D_{\\text{num}}(h)=\\alpha h^r$, $r=1$, grid spacings $h=\\{1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4},\\,1.25\\times 10^{-4}\\}\\,\\text{m}$.\n- Case 2 (lattice Boltzmann method, second-order leading dissipation): $D=5.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$, $k=200\\,\\text{s}^{-1}$, $\\alpha=4.0$, $r=2$, grid spacings $h=\\{2.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4}\\}\\,\\text{m}$.\n- Case 3 (discontinuous Galerkin, high-order stabilization dominant): $D=2.5\\times 10^{-5}\\,\\text{m}^2/\\text{s}$, $k=1000\\,\\text{s}^{-1}$, $\\alpha=0.5$, $r=2$, grid spacings $h=\\{2.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4}\\}\\,\\text{m}$.\n- Case 4 (reference, negligible numerical dissipation): $D=3.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$, $k=150\\,\\text{s}^{-1}$, $\\alpha=0.0$, $r=1$, grid spacings $h=\\{1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4},\\,1.25\\times 10^{-4}\\}\\,\\text{m}$.\n\nYour program must:\n- For each case, compute $\\varepsilon(h_{\\max})$ at the largest $h$ and compute $\\hat{s}_L^{(0)}$ from the regression.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order, for Case $1$ then Case $2$ then Case $3$ then Case $4$: the fractional error at $h_{\\max}$ followed by the calibrated zero-dissipation physical speed $\\hat{s}_L^{(0)}$ in $\\text{m}/\\text{s}$. Thus the output format is\n$$[\\varepsilon_1,\\hat{s}_{L,1}^{(0)},\\varepsilon_2,\\hat{s}_{L,2}^{(0)},\\varepsilon_3,\\hat{s}_{L,3}^{(0)},\\varepsilon_4,\\hat{s}_{L,4}^{(0)}],$$\nwith all eight numbers rounded to six decimal places.",
            "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded in the theory of reaction-diffusion equations (specifically, the Fisher-KPP equation) and standard numerical analysis techniques for modeling discretization error. The problem is well-posed, with all necessary parameters, equations, and conditions clearly defined, ensuring a unique and meaningful solution. The language is objective and unambiguous.\n\nThe tasks involve analyzing a model for laminar flame speed where numerical dissipation from a discretization method artificially inflates the physical diffusion coefficient. The goal is to quantify this error and demonstrate a calibration technique to recover the true physical flame speed from the numerically-affected results.\n\nThe model is defined by the following equations:\n1.  The physical laminar flame speed, derived from the underlying continuous model, is given by\n    $$s_L = 2\\sqrt{Dk}$$\n    where $D$ is the molecular diffusion coefficient and $k$ is the reaction rate constant.\n\n2.  The numerical scheme introduces an effective diffusion coefficient $D_{\\text{eff}}(h)$ that depends on the grid spacing $h$:\n    $$D_{\\text{eff}}(h) = D + D_{\\text{num}}(h) = D + \\alpha h^r$$\n    Here, $\\alpha h^r$ represents the numerical diffusion, with $\\alpha$ and $r$ being parameters of the specific numerical method.\n\n3.  Consequently, the numerically observed flame speed, $\\hat{s}(h)$, is\n    $$\\hat{s}(h) = 2\\sqrt{k D_{\\text{eff}}(h)} = 2\\sqrt{k(D + \\alpha h^r)}$$\n\nThe solution process involves three main calculations for each test case.\n\nFirst, we compute the fractional error, $\\varepsilon(h_{\\max})$, at the coarsest grid spacing, $h_{\\max}$. This error quantifies the deviation of the numerical prediction from the true physical value due to the dominant numerical dissipation at low resolutions. It is calculated as:\n$$\\varepsilon(h_{\\max}) = \\frac{\\hat{s}(h_{\\max}) - s_L}{s_L}$$\nwhere $\\hat{s}(h_{\\max})$ is the speed computed using $h_{\\max}$.\n\nSecond, we implement a calibration method to estimate the physical flame speed from a series of numerical results at different grid spacings $h_i$. The method is based on a regression analysis. Squaring the expression for the observed speed $\\hat{s}(h)$ reveals a linear relationship:\n$$\\hat{s}(h)^2 = \\left(2\\sqrt{k(D + \\alpha h^r)}\\right)^2 = 4k(D + \\alpha h^r) = 4kD + (4k\\alpha)h^r$$\nThis equation is of the form $y = b_0 + b_1 x$, where $y = \\hat{s}(h)^2$, $x = h^r$, the intercept is $b_0 = 4kD$, and the slope is $b_1 = 4k\\alpha$. By performing a linear least-squares regression on the data points $(\\{h_i^r\\}, \\{\\hat{s}(h_i)^2\\})$, we can determine the intercept $b_0$.\n\nThird, the calibrated physical flame speed, $\\hat{s}_L^{(0)}$, is recovered from this intercept. The theoretical flame speed squared is $s_L^2 = (2\\sqrt{Dk})^2 = 4kD$, which is precisely the intercept $b_0$. Therefore, by taking the square root of the regressed intercept, we can extrapolate to the zero-dissipation limit ($h \\to 0$):\n$$\\hat{s}_L^{(0)} = \\sqrt{b_0}$$\nSince the numerical data provided is generated directly from the model equation $\\hat{s}(h) = 2\\sqrt{k(D + \\alpha h^r)}$, the data points for the regression $(\\{h_i^r\\}, \\{\\hat{s}(h_i)^2\\})$ lie perfectly on a straight line. The linear regression will thus recover the exact intercept $b_0 = 4kD$, and the calibrated speed $\\hat{s}_L^{(0)}$ will be identical to the true physical speed $s_L$.\n\nWe now apply this procedure to each test case. For example, for Case 1:\n- Parameters: $D=1.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$, $k=500\\,\\text{s}^{-1}$, $\\alpha=1.0\\times 10^{-2}$, $r=1$, $h=\\{1.0\\times 10^{-3}, 5.0\\times 10^{-4}, 2.5\\times 10^{-4}, 1.25\\times 10^{-4}\\}\\,\\text{m}$.\n- Theoretical speed: $s_L = 2\\sqrt{(1.0 \\times 10^{-5})(500)} = 2\\sqrt{0.005} \\approx 0.141421\\,\\text{m/s}$.\n- Coarsest grid: $h_{\\max} = 1.0 \\times 10^{-3}\\,\\text{m}$.\n- Speed at coarsest grid: $\\hat{s}(h_{\\max}) = 2\\sqrt{500(1.0 \\times 10^{-5} + 0.01 \\times 1.0 \\times 10^{-3})} = 2\\sqrt{500(2.0 \\times 10^{-5})} = 2\\sqrt{0.01} = 0.2\\,\\text{m/s}$.\n- Fractional error: $\\varepsilon(h_{\\max}) = (0.2 - 0.141421) / 0.141421 \\approx 0.414214$.\n- Regression: We fit a line to the points $(h_i, \\hat{s}(h_i)^2)$. The underlying relation is $\\hat{s}(h)^2 = 4(500)(10^{-5}) + 4(500)(0.01)h = 0.02 + 20h$. The regression yields an intercept $b_0 = 0.02$.\n- Calibrated speed: $\\hat{s}_L^{(0)} = \\sqrt{b_0} = \\sqrt{0.02} \\approx 0.141421\\,\\text{m/s}$.\n\nThe same procedure is applied to the remaining three cases to obtain the final set of results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the results in the specified format.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (discontinuous Galerkin, first-order)\n        {\n            \"D\": 1.0e-5, \"k\": 500, \"alpha\": 1.0e-2, \"r\": 1, \n            \"h_values\": np.array([1.0e-3, 5.0e-4, 2.5e-4, 1.25e-4])\n        },\n        # Case 2 (lattice Boltzmann, second-order)\n        {\n            \"D\": 5.0e-5, \"k\": 200, \"alpha\": 4.0, \"r\": 2, \n            \"h_values\": np.array([2.0e-3, 1.0e-3, 5.0e-4, 2.5e-4])\n        },\n        # Case 3 (discontinuous Galerkin, high-order stabilization)\n        {\n            \"D\": 2.5e-5, \"k\": 1000, \"alpha\": 0.5, \"r\": 2, \n            \"h_values\": np.array([2.0e-3, 1.0e-3, 5.0e-4, 2.5e-4])\n        },\n        # Case 4 (reference, negligible numerical dissipation)\n        {\n            \"D\": 3.0e-5, \"k\": 150, \"alpha\": 0.0, \"r\": 1, \n            \"h_values\": np.array([1.0e-3, 5.0e-4, 2.5e-4, 1.25e-4])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_h_max, sL_calibrated = process_case(\n            case[\"D\"], case[\"k\"], case[\"alpha\"], case[\"r\"], case[\"h_values\"]\n        )\n        results.extend([eps_h_max, sL_calibrated])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\ndef process_case(D, k, alpha, r, h_values):\n    \"\"\"\n    Calculates the fractional error and calibrated flame speed for a single case.\n\n    Args:\n        D (float): Molecular diffusion coefficient.\n        k (float): Reaction rate constant.\n        alpha (float): Numerical diffusion coefficient.\n        r (int): Order of the numerical diffusion.\n        h_values (np.ndarray): Array of grid spacings.\n\n    Returns:\n        tuple: A tuple containing the fractional error at h_max and the calibrated\n               physical laminar flame speed.\n    \"\"\"\n    # Theoretical laminar flame speed (s_L)\n    # Check for D*k > 0 to avoid domain errors, although problem constraints ensure this.\n    if D * k > 0:\n        sL_theory = 2 * np.sqrt(D * k)\n    else:\n        sL_theory = 0.0\n        \n    # --- Task 3: Quantify fractional error at coarsest grid ---\n    \n    h_max = np.max(h_values)\n    \n    # Numerically predicted speed at h_max\n    D_eff_h_max = D + alpha * h_max**r\n    s_hat_h_max = 2 * np.sqrt(k * D_eff_h_max)\n    \n    # Fractional error\n    if sL_theory > 0:\n        eps_h_max = (s_hat_h_max - sL_theory) / sL_theory\n    else:\n        eps_h_max = 0.0 # Or handle as undefined, but problem context implies sL > 0.\n\n    # --- Task 2: Calibrate to find the physical speed ---\n    \n    # The regression model is s_hat(h)^2 = b0 + b1 * h^r\n    # x-values for the regression are h^r\n    x_regression = h_values**r\n    \n    # y-values for the regression are s_hat(h)^2\n    D_eff_h = D + alpha * h_values**r\n    s_hat_h_squared = 4 * k * D_eff_h\n    \n    # Perform linear least-squares regression: y = b1*x + b0\n    # numpy.polyfit returns coefficients in descending power order: [b1, b0]\n    # For a degree 1 polynomial p(x) = p[0]*x + p[1]\n    coeffs = np.polyfit(x_regression, s_hat_h_squared, 1)\n    b0 = coeffs[1]\n    \n    # The calibrated physical speed is sqrt(b0)\n    # Check b0 >= 0, which should be true as b0 = 4*D*k.\n    sL_calibrated = np.sqrt(b0) if b0 > 0 else 0.0\n\n    return eps_h_max, sL_calibrated\n\nsolve()\n```"
        }
    ]
}