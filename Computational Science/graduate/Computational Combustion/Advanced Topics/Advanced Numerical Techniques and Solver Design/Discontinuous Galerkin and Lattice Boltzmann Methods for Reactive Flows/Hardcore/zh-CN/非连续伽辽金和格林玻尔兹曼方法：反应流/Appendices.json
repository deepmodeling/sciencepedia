{
    "hands_on_practices": [
        {
            "introduction": "不连续伽辽金 (DG) 方法的核心在于其局部的、基于单元的表述方式。本练习将指导您在参考单元上构建基本的质量矩阵和刚度矩阵。理解这一过程，以及它如何通过等参变换映射到物理单元，对于掌握 DG 方法如何确保局部守恒至关重要，而局部守恒是模拟包含激波或尖锐梯度的流动的关键优势。",
            "id": "4020013",
            "problem": "考虑一个一维反应性物质的输运，其由守恒的平流-扩散-反应定律所支配\n$$\\frac{\\partial (\\rho Y)}{\\partial t} + \\frac{\\partial J}{\\partial x} = \\omega,$$\n其中 $\\rho$ 是混合物密度，$Y$ 是物质的质量分数，$J$ 是扩散-平流通量，$\\omega$ 是化学源项。在扩散的内部体积贡献中，间断 Galerkin (DG) 方法基于使用局部多项式基的 Galerkin 投影和精确积分，以确保通量和源项的守恒性。考虑单个 DG 单元，并关注在标准参考单元 $\\xi \\in [-1,1]$ 上扩散算子的体积项。\n\n使用最高为2次的勒让德多项式模态基，\n$$\\phi_{0}(\\xi) = 1, \\quad \\phi_{1}(\\xi) = \\xi, \\quad \\phi_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2},$$\n并定义参考单元质量矩阵和刚度矩阵为\n$$M_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi, \\qquad K_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\frac{d\\phi_{i}}{d\\xi}(\\xi)\\,\\frac{d\\phi_{j}}{d\\xi}(\\xi)\\,d\\xi.$$\n\n1. 通过计算上述积分，显式地构建 $M^{\\mathrm{ref}}$ 和 $K^{\\mathrm{ref}}$。\n2. 通过具有恒定雅可比行列式 $J = \\frac{x_{R} - x_{L}}{2}$ 的仿射等参变换 $x(\\xi) = x_{c} + J\\,\\xi$，将参考单元映射到物理单元 $x \\in [x_{L},x_{R}]$。推导物理单元矩阵 $M^{\\mathrm{phys}}$ 和 $K^{\\mathrm{phys}}$相对于 $M^{\\mathrm{ref}}$ 和 $K^{\\mathrm{ref}}$ 的缩放关系。\n3. 在间断 Galerkin (DG) 方法和格子玻尔兹曼方法 (LBM) 的背景下，解释在解为常数、$\\omega = 0$ 且单元界面间的数值通量一致的假设下，等参映射和精确积分如何确保平流-扩散通量的离散守恒，并防止伪几何源项的产生。\n4. 对于一个雅可比行列式 $J = 3$ 的物理单元，精确计算算子 $(M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}}$ 的最大特征值。最终答案需为单个精确值，不带单位。\n\n无需四舍五入；最终答案应为精确表达式。",
            "solution": "将按顺序完成四个指定部分来解决此问题。\n\n### 第1步：问题验证\n\n**已知条件提取：**\n- 控制方程：$\\frac{\\partial (\\rho Y)}{\\partial t} + \\frac{\\partial J}{\\partial x} = \\omega$\n- DG 单元：标准参考单元 $\\xi \\in [-1,1]$\n- 模态基（最高为2次的勒让德多项式）：\n  - $\\phi_{0}(\\xi) = 1$\n  - $\\phi_{1}(\\xi) = \\xi$\n  - $\\phi_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}$\n- 参考单元质量矩阵定义：$M_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi$\n- 参考单元刚度矩阵定义：$K_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\frac{d\\phi_{i}}{d\\xi}(\\xi)\\,\\frac{d\\phi_{j}}{d\\xi}(\\xi)\\,d\\xi$\n- 到物理单元 $x \\in [x_{L},x_{R}]$ 的映射：$x(\\xi) = x_{c} + J\\,\\xi$\n- 映射的雅可比行列式：$J = \\frac{x_{R} - x_{L}}{2}$\n- 第3部分的条件：$\\omega = 0$，解为常数，数值通量一致。\n- 第4部分的条件：雅可比行列式 $J = 3$。\n\n**验证：**\n1.  **科学依据：** 该问题牢固地植根于间断 Galerkin (DG) 方法的理论，这是一种在计算科学和工程中标准且广泛使用的数值技术，特别适用于处理给定的双曲守恒律等问题。质量矩阵和刚度矩阵的定义、选择勒让德多项式作为基函数，以及使用等参映射，都是有限元和DG方法中的标准做法。\n2.  **适定的：** 问题的各个部分都陈述得非常精确。第1、2、4部分要求基于明确定义的数学对象进行具体计算。第3部分要求基于DG方法的既定原则（特别是几何守恒律或GCL）进行概念性解释。\n3.  **客观的：** 问题以客观、技术性的语言表述，没有歧义或主观论断。\n4.  **完整且一致的：** 所提供的信息足以完成所有要求的任务。内部没有矛盾。\n\n**结论：** 该问题是有效的。\n\n### 第2步：求解\n\n#### 第1部分：构建 $M^{\\mathrm{ref}}$ 和 $K^{\\mathrm{ref}}$\n\n所提供的基函数 $\\phi_{0}(\\xi)$、$\\phi_{1}(\\xi)$ 和 $\\phi_{2}(\\xi)$ 是标准的勒让德多项式 $P_{0}(\\xi)$、$P_{1}(\\xi)$ 和 $P_{2}(\\xi)$。勒让德多项式在区间 $[-1,1]$ 上正交，其性质如下：\n$$ \\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi) d\\xi = \\frac{2}{2i+1} \\delta_{ij} $$\n其中 $\\delta_{ij}$ 是克罗内克δ。\n\n**质量矩阵 $M^{\\mathrm{ref}}$：**\n质量矩阵的元素为 $M_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi$。由于正交性，所有非对角元素（$i \\neq j$）均为零。我们计算对角元素：\n$$ M_{00}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\phi_{0}(\\xi) d\\xi = \\frac{2}{2(0)+1} = 2 $$\n$$ M_{11}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{1}(\\xi)\\phi_{1}(\\xi) d\\xi = \\frac{2}{2(1)+1} = \\frac{2}{3} $$\n$$ M_{22}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_{2}(\\xi)\\phi_{2}(\\xi) d\\xi = \\frac{2}{2(2)+1} = \\frac{2}{5} $$\n因此，参考质量矩阵是一个对角矩阵：\n$$ M^{\\mathrm{ref}} = \\begin{pmatrix} 2  0  0 \\\\ 0  \\frac{2}{3}  0 \\\\ 0  0  \\frac{2}{5} \\end{pmatrix} $$\n\n**刚度矩阵 $K^{\\mathrm{ref}}$：**\n刚度矩阵的元素为 $K_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\frac{d\\phi_{i}}{d\\xi}(\\xi)\\,\\frac{d\\phi_{j}}{d\\xi}(\\xi)\\,d\\xi$。首先，我们计算基函数的导数：\n$$ \\frac{d\\phi_{0}}{d\\xi} = \\frac{d}{d\\xi}(1) = 0 $$\n$$ \\frac{d\\phi_{1}}{d\\xi} = \\frac{d}{d\\xi}(\\xi) = 1 $$\n$$ \\frac{d\\phi_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{3\\xi^{2}-1}{2}\\right) = 3\\xi $$\n现在我们计算矩阵元素的积分：\n$$ K_{0j}^{\\mathrm{ref}} = \\int_{-1}^{1} (0) \\frac{d\\phi_{j}}{d\\xi} d\\xi = 0 \\quad \\text{对于 } j=0,1,2. \\text{ 根据对称性, } K_{i0}^{\\mathrm{ref}} = 0. $$\n$$ K_{11}^{\\mathrm{ref}} = \\int_{-1}^{1} (1)(1) d\\xi = [\\xi]_{-1}^{1} = 1 - (-1) = 2 $$\n$$ K_{12}^{\\mathrm{ref}} = \\int_{-1}^{1} (1)(3\\xi) d\\xi = 3 \\left[\\frac{\\xi^{2}}{2}\\right]_{-1}^{1} = 3 \\left(\\frac{1}{2} - \\frac{1}{2}\\right) = 0. \\text{ 根据对称性, } K_{21}^{\\mathrm{ref}} = 0. $$\n$$ K_{22}^{\\mathrm{ref}} = \\int_{-1}^{1} (3\\xi)(3\\xi) d\\xi = 9 \\int_{-1}^{1} \\xi^{2} d\\xi = 9 \\left[\\frac{\\xi^{3}}{3}\\right]_{-1}^{1} = 9 \\left(\\frac{1}{3} - \\frac{-1}{3}\\right) = 9 \\left(\\frac{2}{3}\\right) = 6 $$\n因此，参考刚度矩阵也是一个对角矩阵：\n$$ K^{\\mathrm{ref}} = \\begin{pmatrix} 0  0  0 \\\\ 0  2  0 \\\\ 0  0  6 \\end{pmatrix} $$\n\n#### 第2部分：物理单元矩阵的缩放关系\n\n物理单元矩阵 $M^{\\mathrm{phys}}$ 和 $K^{\\mathrm{phys}}$ 由在物理单元 $x \\in [x_{L}, x_{R}]$ 上的积分定义。我们使用仿射映射 $x(\\xi) = x_{c} + J\\xi$ 将这些积分变换回参考单元 $\\xi \\in [-1,1]$。微分元变换为 $dx = \\frac{dx}{d\\xi}d\\xi = J d\\xi$。\n\n**物理质量矩阵 $M^{\\mathrm{phys}}$：**\n物理质量矩阵的积分为：\n$$ M_{ij}^{\\mathrm{phys}} = \\int_{x_L}^{x_R} \\phi_i(\\xi(x)) \\phi_j(\\xi(x)) dx $$\n变量变换到 $\\xi$：\n$$ M_{ij}^{\\mathrm{phys}} = \\int_{-1}^{1} \\phi_i(\\xi) \\phi_j(\\xi) (J d\\xi) = J \\int_{-1}^{1} \\phi_i(\\xi) \\phi_j(\\xi) d\\xi = J M_{ij}^{\\mathrm{ref}} $$\n因此，物理质量矩阵与雅可比行列式成线性缩放关系：\n$$ M^{\\mathrm{phys}} = J M^{\\mathrm{ref}} $$\n\n**物理刚度矩阵 $K^{\\mathrm{phys}}$：**\n刚度矩阵来自二阶导数算子的弱形式，例如 $\\int \\frac{dv}{dx}\\frac{du}{dx} dx$。对于我们的基，这得到：\n$$ K_{ij}^{\\mathrm{phys}} = \\int_{x_L}^{x_R} \\frac{d\\phi_i}{dx}(\\xi(x)) \\frac{d\\phi_j}{dx}(\\xi(x)) dx $$\n我们使用链式法则来关联物理导数和参考导数：$\\frac{d}{d\\xi} = \\frac{dx}{d\\xi}\\frac{d}{dx} = J \\frac{d}{dx}$，这意味着 $\\frac{d}{dx} = \\frac{1}{J}\\frac{d}{d\\xi}$。\n将此式和 $dx = J d\\xi$ 代入积分：\n$$ K_{ij}^{\\mathrm{phys}} = \\int_{-1}^{1} \\left(\\frac{1}{J}\\frac{d\\phi_i}{d\\xi}\\right) \\left(\\frac{1}{J}\\frac{d\\phi_j}{d\\xi}\\right) (J d\\xi) = \\frac{J}{J^2} \\int_{-1}^{1} \\frac{d\\phi_i}{d\\xi} \\frac{d\\phi_j}{d\\xi} d\\xi = \\frac{1}{J} K_{ij}^{\\mathrm{ref}} $$\n因此，物理刚度矩阵与雅可比行列式的倒数成缩放关系：\n$$ K^{\\mathrm{phys}} = \\frac{1}{J} K^{\\mathrm{ref}} $$\n\n#### 第3部分：守恒性解释\n\n这个问题与几何守恒律 (GCL) 有关，该定律指出数值格式必须在任意网格上精确地再现常数状态。在给定问题中，当 $\\omega=0$ 时，这意味着如果解 $Y$ 是常数，其时间导数必须为零，且离散化本身不应产生伪通量或源项。\n\n**间断 Galerkin (DG) 方法：**\n在物理单元 $\\Omega_e = [x_L, x_R]$ 上，无源项的控制方程的半离散 DG 格式为：\n$$ \\int_{\\Omega_e} \\frac{\\partial (\\rho Y)_h}{\\partial t} \\phi_i dx + \\int_{\\Omega_e} \\frac{\\partial J_h}{\\partial x} \\phi_i dx = 0 $$\n其中 $(\\rho Y)_h$ 是解的多项式近似。对通量项进行分部积分得到：\n$$ \\frac{d}{dt} \\int_{\\Omega_e} (\\rho Y)_h \\phi_i dx + \\left[ \\hat{J} \\phi_i \\right]_{x_L}^{x_R} - \\int_{\\Omega_e} J_h \\frac{d\\phi_i}{dx} dx = 0 $$\n这里，$\\hat{J}$ 是单元界面处的数值通量。\n\n考虑一个常数解 $(\\rho Y)_h = C$。由于 $\\phi_0(\\xi) = 1$ 在我们的基中，这个常数状态可以通过将 $\\phi_0$ 的系数设为 $C$ 并将所有其他系数设为零来精确表示。\n1.  **体积积分项：** 涉及通量导数的体积积分为 $\\int_{\\Omega_e} J_h \\frac{d\\phi_i}{dx} dx$。通量 $J$ 包含扩散和对流部分。对于扩散，$J \\propto \\frac{\\partial (\\rho Y)}{\\partial x}$；对于对流，$J \\propto \\rho Y$。对于常数解 $(\\rho Y)_h = C$，扩散通量为零，因为梯度为零。对流通量是常数，$J_{adv} = uC$。积分为 $\\int_{\\Omega_e} uC \\frac{d\\phi_i}{dx} dx = uC \\int_{x_L}^{x_R} \\frac{d\\phi_i}{dx} dx = uC[\\phi_i]_{x_L}^{x_R}$。这必须由边界通量来平衡。更根本地，我们计算的刚度矩阵项对应于扩散算子。对于常数解，解系数向量与 $(1, 0, 0, \\dots)^T$ 成比例。刚度矩阵对残差的贡献是 $K^{\\mathrm{phys}} \\cdot (C, 0, 0)^T$。如第1部分所示，$K^{\\mathrm{ref}}$（因此 $K^{\\mathrm{phys}}$）的第一列为零，因为 $\\frac{d\\phi_0}{d\\xi}=0$。因此，对于常数解，扩散算子的体积积分贡献恒为零。\n2.  **等参映射和精确积分：** 当离散算子不能正确表示几何形状时，特别是当离散散度定理被违反时，会产生伪几何源项。对于仿射映射 $x(\\xi) = x_c + J\\xi$，雅可比行列式 $J$ 是常数。质量矩阵和刚度矩阵的被积函数是 $\\xi$ 的多项式。通过使用对这些多项式精确的积分规则（例如，足够阶数的高斯积分），离散矩阵 $M^{\\mathrm{phys}}$ 和 $K^{\\mathrm{phys}}$ 的计算相对于解析积分没有误差。这种精确积分确保了几何变换不会引入任何人为的源项。此性质对于满足GCL至关重要。如果映射是非线性的（例如，对于弯曲单元），雅可比行列式将是 $\\xi$ 的函数 $J(\\xi)$，如果积分对于由此产生的非多项式被积函数不精确，则可能产生伪源项。\n3.  **数值通量：** 对于处处为常数的解 $Y=C$，任何界面两侧的状态都是相同的。一致的数值通量 $\\hat{J}$ 必须满足 $\\hat{J}(C, C) = J(C)$。因此，界面通量项 $\\left[ \\hat{J} \\phi_i \\right]_{x_L}^{x_R}$ 将正确地平衡物理通量，防止在界面处产生伪生成项。\n\n**格子玻尔兹曼方法 (LBM):**\nLBM 在固定的规则格子上运行。守恒性由碰撞算子的结构保证，该算子将粒子布居数松弛到具有所需守恒矩（质量、动量）的局部平衡态。“GCL”概念类似于确保边界条件或不同网格块之间的界面不会成为守恒量的人为源或汇。例如，众所周知，在斜壁的阶梯近似上使用简单的反弹边界规则会违反动量守恒，从而产生伪阻力。LBM中的高级边界条件被设计为质量和动量守恒的。从这个意义上说，DG和LBM都要求仔细制定格式的元素（DG的精确积分，LBM的特定边界算子），以确保几何的离散表示不违反基本的物理守恒定律。\n\n#### 第4部分：特征值计算\n\n我们需要计算雅可比行列式 $J = 3$ 的物理单元算子 $(M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}}$ 的最大特征值。根据第2部分推导的缩放关系：\n$$ M^{\\mathrm{phys}} = J M^{\\mathrm{ref}} $$\n$$ K^{\\mathrm{phys}} = \\frac{1}{J} K^{\\mathrm{ref}} $$\n算子可以用参考矩阵表示：\n$$ (M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}} = (J M^{\\mathrm{ref}})^{-1} \\left(\\frac{1}{J} K^{\\mathrm{ref}}\\right) = \\left(\\frac{1}{J} (M^{\\mathrm{ref}})^{-1}\\right) \\left(\\frac{1}{J} K^{\\mathrm{ref}}\\right) = \\frac{1}{J^2} (M^{\\mathrm{ref}})^{-1} K^{\\mathrm{ref}} $$\n使用第1部分计算的矩阵：\n$$ M^{\\mathrm{ref}} = \\begin{pmatrix} 2  0  0 \\\\ 0  \\frac{2}{3}  0 \\\\ 0  0  \\frac{2}{5} \\end{pmatrix} \\quad \\implies \\quad (M^{\\mathrm{ref}})^{-1} = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  \\frac{3}{2}  0 \\\\ 0  0  \\frac{5}{2} \\end{pmatrix} $$\n$$ K^{\\mathrm{ref}} = \\begin{pmatrix} 0  0  0 \\\\ 0  2  0 \\\\ 0  0  6 \\end{pmatrix} $$\n现在，我们计算乘积 $(M^{\\mathrm{ref}})^{-1} K^{\\mathrm{ref}}$：\n$$ (M^{\\mathrm{ref}})^{-1} K^{\\mathrm{ref}} = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  \\frac{3}{2}  0 \\\\ 0  0  \\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ 0  2  0 \\\\ 0  0  6 \\end{pmatrix} = \\begin{pmatrix} (\\frac{1}{2})(0)  0  0 \\\\ 0  (\\frac{3}{2})(2)  0 \\\\ 0  0  (\\frac{5}{2})(6) \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  3  0 \\\\ 0  0  15 \\end{pmatrix} $$\n该对角矩阵的特征值是其对角线上的元素：$\\{0, 3, 15\\}$。\n最后，我们将这些特征值乘以因子 $\\frac{1}{J^2}$。当 $J=3$ 时，缩放因子为 $\\frac{1}{3^2} = \\frac{1}{9}$。\n算子 $(M^{\\mathrm{phys}})^{-1} K^{\\mathrm{phys}}$ 的特征值为：\n$$ \\left\\{ \\frac{1}{9}(0), \\frac{1}{9}(3), \\frac{1}{9}(15) \\right\\} = \\left\\{ 0, \\frac{3}{9}, \\frac{15}{9} \\right\\} = \\left\\{ 0, \\frac{1}{3}, \\frac{5}{3} \\right\\} $$\n该算子的最大特征值是 $\\frac{15}{9}$，化简为 $\\frac{5}{3}$。",
            "answer": "$$\\boxed{\\frac{5}{3}}$$"
        },
        {
            "introduction": "现在我们将视角转向格子玻尔兹曼方法 (LBM)，一种介观尺度的方法。LBM 的强大之处在于其简洁的迁移和碰撞规则，但其实用性取决于能否将其参数（如弛豫时间）与我们希望模拟的宏观流体属性（如粘度和普朗特数）正确关联。本练习提供了在这一关键校准过程中的实践机会，以确保 LBM 仿真能准确反映反应混合物的目标物理特性。",
            "id": "4020053",
            "problem": "考虑一个低马赫数反应混合物，将使用热格子玻尔兹曼方法（LBM）进行模拟。该方法采用双分布函数（DDF）方法，并对动量和温度场使用单弛豫时间（SRT）的 Bhatnagar-Gross-Krook（BGK）碰撞模型。动量场和温度场均在二维九速（D2Q9）格子上进行离散化，其格子流速为 $c = \\delta x / \\delta t$，格子声速为 $c_{s} = c / \\sqrt{3}$。目标是确保 LBM 在流体动力学极限下能够恢复反应流的正确扩散输运，并达到与燃烧模拟一致的目标普朗特数。此设计还旨在与用于反应流验证的间断 Galerkin（DG）求解器中使用的输运系数保持一致。\n\n给定网格间距 $\\delta x = 1.0 \\times 10^{-5}\\,\\mathrm{m}$ 和时间步长 $\\delta t = 1.0 \\times 10^{-6}\\,\\mathrm{s}$。对于现有模拟，动量弛豫时间为 $\\tau_{v,0} = 0.62$，温度弛豫时间为 $\\tau_{T,0} = 0.545$。\n\n任务：\n1. 利用 D2Q9 格子的 LBM 流体动力学极限，计算由现有弛豫时间实现的有效普朗特数。\n2. 在相同的格子配置下，设计新的弛豫参数 $\\tau_{v}$ 和 $\\tau_{T}$，以达到目标物理运动粘度 $\\nu_{\\mathrm{phys}} = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ 和期望普朗特数 $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$。\n\n推导基于：\n- 低马赫数反应流中的质量、动量和能量守恒，\n- 通过 Chapman–Enskog 分析恢复纳维-斯托克斯方程和对流-扩散方程，\n- D2Q9 模型中弛豫时间与输运系数之间的关系。\n\n报告三个数值：由现有弛豫时间得到的有效普朗特数、设计出的 $\\tau_{v}$ 和 $\\tau_{T}$。有效普朗特数是无量纲的；弛豫时间也是无量纲的。将有效普朗特数四舍五入到四位有效数字，并将每个弛豫时间四舍五入到五位有效数字。将最终答案以单行向量的形式呈现。最终答案中不包含单位。",
            "solution": "该问题经核实具有科学依据，定义明确，客观且完整。所有提供的数据均符合计算流体动力学领域的标准实践，特别是针对热流的格子玻尔兹曼方法（LBM）。LBM 参数与宏观输运系数之间的关系已通过 Chapman-Enskog 分析得到充分确立。因此，可以推导出解答。\n\n该问题的核心在于流体的输运系数与其 LBM 模拟参数之间的关系。对于使用单弛豫时间（SRT）Bhatnagar-Gross-Krook（BGK）碰撞算子的二维九速（D2Q9）格子模型，运动粘度（$\\nu$）和热扩散率（$\\alpha$）分别与动量弛豫时间（$\\tau_v$）和温度弛豫时间（$\\tau_T$）相关。\n\n通过 Chapman-Enskog 展开，从玻尔兹曼方程推导至宏观纳维-斯托克斯方程和对流-扩散方程，可得到输运系数的以下表达式：\n$$ \\nu = c_s^2 \\left(\\tau_v - \\frac{1}{2}\\right) \\delta t $$\n$$ \\alpha = c_s^2 \\left(\\tau_T - \\frac{1}{2}\\right) \\delta t $$\n其中 $c_s$ 是格子声速，$\\delta t$ 是时间步长。对于 D2Q9 格子，声速由 $c_s = \\frac{c}{\\sqrt{3}}$ 给出，其中 $c = \\frac{\\delta x}{\\delta t}$ 是格子流速，$\\delta x$ 是网格间距。\n\n代入 $c_s$ 和 $c$ 的表达式：\n$$ c_s^2 = \\frac{c^2}{3} = \\frac{1}{3} \\left(\\frac{\\delta x}{\\delta t}\\right)^2 $$\n因此，输运系数可以用基本格子参数表示为：\n$$ \\nu = \\frac{1}{3} \\frac{\\delta x^2}{\\delta t^2} \\left(\\tau_v - \\frac{1}{2}\\right) \\delta t = \\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_v - \\frac{1}{2}\\right) $$\n$$ \\alpha = \\frac{1}{3} \\frac{\\delta x^2}{\\delta t^2} \\left(\\tau_T - \\frac{1}{2}\\right) \\delta t = \\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_T - \\frac{1}{2}\\right) $$\n为了保证 SRT-BGK 方案的数值稳定性，弛豫时间必须满足 $\\tau_v > 0.5$ 和 $\\tau_T > 0.5$。给定的初始值 $\\tau_{v,0} = 0.62$ 和 $\\tau_{T,0} = 0.545$ 满足此条件。\n\n普朗特数 $\\mathrm{Pr}$ 是一个无量纲量，定义为运动粘度与热扩散率之比：\n$$ \\mathrm{Pr} = \\frac{\\nu}{\\alpha} $$\n使用 $\\nu$ 和 $\\alpha$ 的 LBM 表达式：\n$$ \\mathrm{Pr} = \\frac{\\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_v - 0.5\\right)}{\\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_T - 0.5\\right)} = \\frac{\\tau_v - 0.5}{\\tau_T - 0.5} $$\n这个基本关系表明，对于此 LBM 模型，普朗特数仅由弛豫时间决定。\n\n**任务1：计算有效普朗特数**\n\n我们已知初始弛豫时间为 $\\tau_{v,0} = 0.62$ 和 $\\tau_{T,0} = 0.545$。有效普朗特数 $\\mathrm{Pr}_{\\mathrm{eff}}$ 使用上面推导的公式计算：\n$$ \\mathrm{Pr}_{\\mathrm{eff}} = \\frac{\\tau_{v,0} - 0.5}{\\tau_{T,0} - 0.5} $$\n代入给定值：\n$$ \\mathrm{Pr}_{\\mathrm{eff}} = \\frac{0.62 - 0.5}{0.545 - 0.5} = \\frac{0.12}{0.045} = \\frac{120}{45} = \\frac{8}{3} $$\n其小数值约为 $2.6666...$。按要求四舍五入到四位有效数字，我们得到：\n$$ \\mathrm{Pr}_{\\mathrm{eff}} \\approx 2.667 $$\n\n**任务2：设计新的弛豫参数**\n\n我们需要找到新的弛豫时间 $\\tau_v$ 和 $\\tau_T$，以达到目标物理运动粘度 $\\nu_{\\mathrm{phys}} = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ 和期望普朗特数 $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$。\n\n首先，我们通过将 LBM 运动粘度设置为目标物理值来确定新的动量弛豫时间 $\\tau_v$：\n$$ \\nu_{\\mathrm{phys}} = \\frac{\\delta x^2}{3 \\delta t} \\left(\\tau_v - 0.5\\right) $$\n求解 $\\tau_v$：\n$$ \\tau_v - 0.5 = \\frac{3 \\delta t \\nu_{\\mathrm{phys}}}{\\delta x^2} $$\n$$ \\tau_v = 0.5 + \\frac{3 \\delta t \\nu_{\\mathrm{phys}}}{\\delta x^2} $$\n给定 $\\delta x = 1.0 \\times 10^{-5}\\,\\mathrm{m}$，$\\delta t = 1.0 \\times 10^{-6}\\,\\mathrm{s}$，以及 $\\nu_{\\mathrm{phys}} = 3.2 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。代入这些值：\n$$ \\tau_v = 0.5 + \\frac{3 \\times (1.0 \\times 10^{-6}) \\times (3.2 \\times 10^{-5})}{(1.0 \\times 10^{-5})^2} = 0.5 + \\frac{9.6 \\times 10^{-11}}{1.0 \\times 10^{-10}} $$\n$$ \\tau_v = 0.5 + 0.96 = 1.46 $$\n要求四舍五入到五位有效数字，因此 $\\tau_v = 1.4600$。该值大于 $0.5$，确保了稳定性。\n\n接下来，我们使用期望普朗特数 $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$ 和新计算出的 $\\tau_v$ 来确定新的温度弛豫时间 $\\tau_T$。\n$$ \\mathrm{Pr}_{\\mathrm{des}} = \\frac{\\tau_v - 0.5}{\\tau_T - 0.5} $$\n求解 $\\tau_T$：\n$$ \\tau_T - 0.5 = \\frac{\\tau_v - 0.5}{\\mathrm{Pr}_{\\mathrm{des}}} $$\n$$ \\tau_T = 0.5 + \\frac{\\tau_v - 0.5}{\\mathrm{Pr}_{\\mathrm{des}}} $$\n代入 $\\tau_v = 1.46$ 和 $\\mathrm{Pr}_{\\mathrm{des}} = 0.7$：\n$$ \\tau_T = 0.5 + \\frac{1.46 - 0.5}{0.7} = 0.5 + \\frac{0.96}{0.7} $$\n$$ \\tau_T \\approx 0.5 + 1.37142857... = 1.87142857... $$\n按要求四舍五入到五位有效数字：\n$$ \\tau_T \\approx 1.8714 $$\n该值也大于 $0.5$，确保了温度场的稳定性。\n\n所需的三个数值是现有设置下的有效普朗特数以及两个新设计的弛豫时间。\n- $\\mathrm{Pr}_{\\mathrm{eff}} \\approx 2.667$\n- $\\tau_v = 1.4600$\n- $\\tau_T \\approx 1.8714$\n这些将以单行向量的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.667  1.4600  1.8714\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "任何数值模拟都会引入误差，而一个关键的挑战是将这些数值人为效应（如数值耗散）与所模拟的真实物理现象区分开。本练习将应对这一挑战。通过一个简化的火焰模型，您将学习一种强大的技术来量化由网格分辨率引入的误差，更重要的是，学习如何通过一系列模拟结果进行外推，以恢复真实的物理火焰速度。这一过程是计算科学中验证与确认工作的核心。",
            "id": "4020063",
            "problem": "考虑一个一维预混反应流模型，其中反应进程变量 $Y(x,t)$ 在零体积对流的随动参考系中满足以下对流-反应-扩散方程：\n$$\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial x^2} + k\\,Y(1-Y),$$\n其中 $D$ 是分子扩散系数，$k$ 是有效的一阶反应速率常数。对于此种 Fisher–Kolmogorov–Petrovsky–Piskunov 行波，其在随动参考系中的理论层流火焰速度为\n$$s_L = 2\\sqrt{D\\,k}.$$\n在诸如间断 Galerkin 方法和格子玻尔兹曼方法的数值离散化中，稳定化或弛豫机制会引入数值耗散，这可以被建模为一个额外的有效扩散：\n$$D_{\\text{eff}}(h) = D + D_{\\text{num}}(h),\\quad D_{\\text{num}}(h) = \\alpha\\,h^r,$$\n其中 $h$ 是网格间距，$r$ 是与主阶截断误差相关的、依赖于格式的指数，$\\alpha$ 是一个综合了稳定化强度的、依赖于方法的系数。在此模型中，分辨率为 $h$ 时预测的层流火焰速度为\n$$\\hat{s}(h) = 2\\sqrt{k\\,D_{\\text{eff}}(h)} = 2\\sqrt{k\\,(D + \\alpha h^r)}.$$\n\n您的任务是：\n1. 使用给定的 $(D,k,\\alpha,r)$ 和一系列网格间距 $h_i$，计算预测速度 $\\hat{s}(h_i)$。\n2. 提出并实现一种校准方法，通过将速度的平方对 $h^r$ 进行回归，以在零耗散极限下恢复物理速度，从而分离物理效应和数值效应。具体而言，对所提供的 $h_i$ 进行最小二乘拟合\n$$\\hat{s}(h)^2 = b_0 + b_1\\,h^r,$$\n并使用 $b_0$ 来估计物理层流火焰速度：\n$$\\hat{s}_L^{(0)} = \\sqrt{b_0}.$$\n3. 通过计算相对误差，量化在最粗网格 $h_{\\max}$ 上的数值耗散效应：\n$$\\varepsilon(h_{\\max}) = \\frac{\\hat{s}(h_{\\max}) - s_L}{s_L},$$\n其中 $s_L = 2\\sqrt{Dk}$ 是来自基础模型的精确物理层流火焰速度。\n\n所有速度必须以米/秒 (m/s) 为单位表示。相对误差必须以不带百分号的小数形式表示。所有输出均需四舍五入到六位小数。\n\n测试套件：\n- 案例1（间断 Galerkin 方法，一阶主导耗散）：$D=1.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$，$k=500\\,\\text{s}^{-1}$，$\\alpha=1.0\\times 10^{-2}$（单位与 $D_{\\text{num}}(h)=\\alpha h^r$ 一致），$r=1$，网格间距 $h=\\{1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4},\\,1.25\\times 10^{-4}\\}\\,\\text{m}$。\n- 案例2（格子玻尔兹曼方法，二阶主导耗散）：$D=5.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$，$k=200\\,\\text{s}^{-1}$，$\\alpha=4.0$，$r=2$，网格间距 $h=\\{2.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4}\\}\\,\\text{m}$。\n- 案例3（间断 Galerkin 方法，高阶稳定化主导）：$D=2.5\\times 10^{-5}\\,\\text{m}^2/\\text{s}$，$k=1000\\,\\text{s}^{-1}$，$\\alpha=0.5$，$r=2$，网格间距 $h=\\{2.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4}\\}\\,\\text{m}$。\n- 案例4（参考，数值耗散可忽略）：$D=3.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$，$k=150\\,\\text{s}^{-1}$，$\\alpha=0.0$，$r=1$，网格间距 $h=\\{1.0\\times 10^{-3},\\,5.0\\times 10^{-4},\\,2.5\\times 10^{-4},\\,1.25\\times 10^{-4}\\}\\,\\text{m}$。\n\n您的程序必须：\n- 对于每个案例，计算最大 $h$ 处的 $\\varepsilon(h_{\\max})$，并根据回归计算 $\\hat{s}_L^{(0)}$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序包含案例1、案例2、案例3、案例4的结果：$h_{\\max}$ 处的相对误差，后跟校准后的零耗散物理速度 $\\hat{s}_L^{(0)}$（单位为 $\\text{m}/\\text{s}$）。因此，输出格式为\n$$[\\varepsilon_1,\\hat{s}_{L,1}^{(0)},\\varepsilon_2,\\hat{s}_{L,2}^{(0)},\\varepsilon_3,\\hat{s}_{L,3}^{(0)},\\varepsilon_4,\\hat{s}_{L,4}^{(0)}],$$\n所有八个数字都需四舍五入到六位小数。",
            "solution": "问题陈述已经过分析，被认为是有效的。它在科学上基于反应-扩散方程（特别是 Fisher-KPP 方程）的理论以及用于建模离散误差的标准数值分析技术。该问题是适定的，所有必要的参数、方程和条件都已明确定义，确保了唯一且有意义的解。其语言客观且无歧义。\n\n这些任务涉及分析一个层流火焰速度模型，其中来自离散化方法的数值耗散会人为地增大物理扩散系数。目标是量化此误差，并演示一种校准技术，以从受数值影响的结果中恢复真实的物理火焰速度。\n\n该模型由以下方程定义：\n1.  从基础连续模型推导出的物理层流火焰速度由下式给出：\n    $$s_L = 2\\sqrt{Dk}$$\n    其中 $D$ 是分子扩散系数，$k$ 是反应速率常数。\n\n2.  数值格式引入了一个有效的扩散系数 $D_{\\text{eff}}(h)$，它依赖于网格间距 $h$：\n    $$D_{\\text{eff}}(h) = D + D_{\\text{num}}(h) = D + \\alpha h^r$$\n    这里，$\\alpha h^r$ 代表数值扩散，其中 $\\alpha$ 和 $r$ 是特定数值方法的参数。\n\n3.  因此，数值上观测到的火焰速度 $\\hat{s}(h)$ 为：\n    $$\\hat{s}(h) = 2\\sqrt{k D_{\\text{eff}}(h)} = 2\\sqrt{k(D + \\alpha h^r)}$$\n\n对每个测试案例，求解过程涉及三个主要计算。\n\n首先，我们计算在最粗网格间距 $h_{\\max}$ 处的相对误差 $\\varepsilon(h_{\\max})$。该误差量化了在低分辨率下由于主导的数值耗散所导致的数值预测与真实物理值之间的偏差。其计算公式如下：\n$$\\varepsilon(h_{\\max}) = \\frac{\\hat{s}(h_{\\max}) - s_L}{s_L}$$\n其中 $\\hat{s}(h_{\\max})$ 是使用 $h_{\\max}$ 计算出的速度。\n\n其次，我们实现一种校准方法，以从不同网格间距 $h_i$ 下的一系列数值结果中估计物理火焰速度。该方法基于回归分析。将观测速度 $\\hat{s}(h)$ 的表达式平方，揭示了一个线性关系：\n$$\\hat{s}(h)^2 = \\left(2\\sqrt{k(D + \\alpha h^r)}\\right)^2 = 4k(D + \\alpha h^r) = 4kD + (4k\\alpha)h^r$$\n该方程的形式为 $y = b_0 + b_1 x$，其中 $y = \\hat{s}(h)^2$，$x = h^r$，截距为 $b_0 = 4kD$，斜率为 $b_1 = 4k\\alpha$。通过对数据点 $(\\{h_i^r\\}, \\{\\hat{s}(h_i)^2\\})$ 进行线性最小二乘回归，我们可以确定截距 $b_0$。\n\n第三，从这个截距中恢复校准后的物理火焰速度 $\\hat{s}_L^{(0)}$。理论火焰速度的平方是 $s_L^2 = (2\\sqrt{Dk})^2 = 4kD$，这恰好是截距 $b_0$。因此，通过对回归得到的截距取平方根，我们可以外推到零耗散极限（$h \\to 0$）：\n$$\\hat{s}_L^{(0)} = \\sqrt{b_0}$$\n由于提供的数值数据是直接从模型方程 $\\hat{s}(h) = 2\\sqrt{k(D + \\alpha h^r)}$ 生成的，用于回归的数据点 $(\\{h_i^r\\}, \\{\\hat{s}(h_i)^2\\})$ 完全落在一条直线上。因此，线性回归将恢复精确的截距 $b_0 = 4kD$，并且校准后的速度 $\\hat{s}_L^{(0)}$ 将与真实的物理速度 $s_L$ 完全相同。\n\n现在我们将此过程应用于每个测试案例。以案例1为例：\n- 参数：$D=1.0\\times 10^{-5}\\,\\text{m}^2/\\text{s}$，$k=500\\,\\text{s}^{-1}$，$\\alpha=1.0\\times 10^{-2}$，$r=1$，$h=\\{1.0\\times 10^{-3}, 5.0\\times 10^{-4}, 2.5\\times 10^{-4}, 1.25\\times 10^{-4}\\}\\,\\text{m}$。\n- 理论速度：$s_L = 2\\sqrt{(1.0 \\times 10^{-5})(500)} = 2\\sqrt{0.005} \\approx 0.141421\\,\\text{m/s}$。\n- 最粗网格：$h_{\\max} = 1.0 \\times 10^{-3}\\,\\text{m}$。\n- 最粗网格下的速度：$\\hat{s}(h_{\\max}) = 2\\sqrt{500(1.0 \\times 10^{-5} + 0.01 \\times 1.0 \\times 10^{-3})} = 2\\sqrt{500(2.0 \\times 10^{-5})} = 2\\sqrt{0.01} = 0.2\\,\\text{m/s}$。\n- 相对误差：$\\varepsilon(h_{\\max}) = (0.2 - 0.141421) / 0.141421 \\approx 0.414214$。\n- 回归：我们将点 $(h_i, \\hat{s}(h_i)^2)$ 拟合成一条直线。其基础关系是 $\\hat{s}(h)^2 = 4(500)(10^{-5}) + 4(500)(0.01)h = 0.02 + 20h$。回归得到的截距为 $b_0 = 0.02$。\n- 校准速度：$\\hat{s}_L^{(0)} = \\sqrt{b_0} = \\sqrt{0.02} \\approx 0.141421\\,\\text{m/s}$。\n\n将其余三个案例应用相同的过程，以获得最终结果集。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the results in the specified format.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (discontinuous Galerkin, first-order)\n        {\n            \"D\": 1.0e-5, \"k\": 500, \"alpha\": 1.0e-2, \"r\": 1, \n            \"h_values\": np.array([1.0e-3, 5.0e-4, 2.5e-4, 1.25e-4])\n        },\n        # Case 2 (lattice Boltzmann, second-order)\n        {\n            \"D\": 5.0e-5, \"k\": 200, \"alpha\": 4.0, \"r\": 2, \n            \"h_values\": np.array([2.0e-3, 1.0e-3, 5.0e-4, 2.5e-4])\n        },\n        # Case 3 (discontinuous Galerkin, high-order stabilization)\n        {\n            \"D\": 2.5e-5, \"k\": 1000, \"alpha\": 0.5, \"r\": 2, \n            \"h_values\": np.array([2.0e-3, 1.0e-3, 5.0e-4, 2.5e-4])\n        },\n        # Case 4 (reference, negligible numerical dissipation)\n        {\n            \"D\": 3.0e-5, \"k\": 150, \"alpha\": 0.0, \"r\": 1, \n            \"h_values\": np.array([1.0e-3, 5.0e-4, 2.5e-4, 1.25e-4])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_h_max, sL_calibrated = process_case(\n            case[\"D\"], case[\"k\"], case[\"alpha\"], case[\"r\"], case[\"h_values\"]\n        )\n        results.extend([eps_h_max, sL_calibrated])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\ndef process_case(D, k, alpha, r, h_values):\n    \"\"\"\n    Calculates the fractional error and calibrated flame speed for a single case.\n\n    Args:\n        D (float): Molecular diffusion coefficient.\n        k (float): Reaction rate constant.\n        alpha (float): Numerical diffusion coefficient.\n        r (int): Order of the numerical diffusion.\n        h_values (np.ndarray): Array of grid spacings.\n\n    Returns:\n        tuple: A tuple containing the fractional error at h_max and the calibrated\n               physical laminar flame speed.\n    \"\"\"\n    # Theoretical laminar flame speed (s_L)\n    # Check for D*k > 0 to avoid domain errors, although problem constraints ensure this.\n    if D * k > 0:\n        sL_theory = 2 * np.sqrt(D * k)\n    else:\n        sL_theory = 0.0\n        \n    # --- Task 3: Quantify fractional error at coarsest grid ---\n    \n    h_max = np.max(h_values)\n    \n    # Numerically predicted speed at h_max\n    D_eff_h_max = D + alpha * h_max**r\n    s_hat_h_max = 2 * np.sqrt(k * D_eff_h_max)\n    \n    # Fractional error\n    if sL_theory > 0:\n        eps_h_max = (s_hat_h_max - sL_theory) / sL_theory\n    else:\n        eps_h_max = 0.0 # Or handle as undefined, but problem context implies sL > 0.\n\n    # --- Task 2: Calibrate to find the physical speed ---\n    \n    # The regression model is s_hat(h)^2 = b0 + b1 * h^r\n    # x-values for the regression are h^r\n    x_regression = h_values**r\n    \n    # y-values for the regression are s_hat(h)^2\n    D_eff_h = D + alpha * h_values**r\n    s_hat_h_squared = 4 * k * D_eff_h\n    \n    # Perform linear least-squares regression: y = b1*x + b0\n    # numpy.polyfit returns coefficients in descending power order: [b1, b0]\n    # For a degree 1 polynomial p(x) = p[0]*x + p[1]\n    coeffs = np.polyfit(x_regression, s_hat_h_squared, 1)\n    b0 = coeffs[1]\n    \n    # The calibrated physical speed is sqrt(b0)\n    # Check b0 >= 0, which should be true as b0 = 4*D*k.\n    sL_calibrated = np.sqrt(b0) if b0 > 0 else 0.0\n\n    return eps_h_max, sL_calibrated\n\nsolve()\n```"
        }
    ]
}