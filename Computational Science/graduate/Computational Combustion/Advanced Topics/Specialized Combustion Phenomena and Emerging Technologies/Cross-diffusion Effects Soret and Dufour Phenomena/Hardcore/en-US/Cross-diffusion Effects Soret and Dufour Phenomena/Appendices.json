{
    "hands_on_practices": [
        {
            "introduction": "This exercise grounds your understanding in the fundamental balance of fluxes that defines the Soret effect. By calculating the mole fraction gradient required to counteract thermal diffusion in a hypothetical flame's preheat zone, you will gain a concrete feel for the magnitude and direction of this phenomenon at a local level . This practice serves as an essential first step before tackling more complex, integrated systems.",
            "id": "4015533",
            "problem": "In a one-dimensional, steady, low-Mach-number, isobaric, premixed combustion simulation, consider a dilute species $A$ diffusing in an otherwise inert bath gas $B$ across the preheat zone of a planar flame. Assume an ideal gas mixture and neglect body forces. The mixture is well described locally as a binary mixture $A$–$B$, and the diffusive transport of $A$ relative to the molar-averaged velocity is governed by the binary Stefan–Maxwell framework augmented with the thermal diffusion (Soret) driving force. The Soret coefficient $S_T$ is defined for the $A$–$B$ pair at the local thermodynamic state as the proportionality constant between the thermal gradient and the induced composition gradient under the condition of zero diffusive molar flux of $A$.\n\nAt a point in the preheat zone, the following data are known: the local mole fraction of $A$ is $x_A = 5.00 \\times 10^{-5}$, the Soret coefficient is $S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$, and the temperature increases in the positive $x$-direction with gradient $\\partial T/\\partial x = 2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$. Ignoring the Dufour effect in the energy equation, determine the steady-state mole fraction gradient $\\partial x_A/\\partial x$ required to exactly cancel the thermal diffusion contribution so that the net diffusive molar flux of $A$ vanishes at this location.\n\nExpress your final answer in $\\mathrm{m}^{-1}$ and round to three significant figures.",
            "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\n- System: One-dimensional ($x$-direction), steady, low-Mach-number, isobaric, premixed combustion.\n- Mixture: Dilute species $A$ in an inert bath gas $B$, behaving as an ideal gas.\n- Transport framework: Binary Stefan–Maxwell with thermal diffusion (Soret effect).\n- Soret coefficient definition: $S_T$ is the proportionality constant between the thermal gradient ($\\nabla T$) and the induced composition gradient ($\\nabla x_A$) when the diffusive molar flux of $A$ is zero.\n- Local mole fraction of species $A$: $x_A = 5.00 \\times 10^{-5}$.\n- Soret coefficient for the $A$–$B$ pair: $S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$.\n- Local temperature gradient: $\\frac{\\partial T}{\\partial x} = 2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$.\n- Condition: The net diffusive molar flux of species $A$ vanishes.\n- Simplification: The Dufour effect is neglected.\n- Objective: Determine the mole fraction gradient $\\frac{\\partial x_A}{\\partial x}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the principles of non-equilibrium thermodynamics and transport phenomena, specifically as applied to combustion science. The Soret effect (thermal diffusion) is a known cross-diffusion phenomenon described by established theories. The use of the Stefan-Maxwell equations is standard. The given numerical values, while large for the temperature gradient, are physically plausible within the preheat zone of a flame.\n- **Well-Posed**: The problem is well-posed. It provides sufficient information to determine a unique solution. The goal is to find the mole fraction gradient that results in zero net diffusive flux, a condition that is mathematically well-defined. The definition and value of the Soret coefficient, combined with the other local properties, are the necessary inputs.\n- **Objective**: The problem is stated using precise, objective, and quantitative language, free from any subjective elements.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It is deemed **VALID**.\n\n## SOLUTION\n\nThe problem requires finding the mole fraction gradient, $\\frac{\\partial x_A}{\\partial x}$, that leads to a zero net diffusive molar flux for species $A$. The total diffusive flux, $\\mathbf{J}_A$, in a binary mixture under the influence of both concentration and temperature gradients is the sum of the Fickian diffusion flux (driven by concentration gradient) and the Soret diffusion flux (driven by temperature gradient).\n\nIn one dimension, the molar diffusive flux of species $A$ relative to the molar-averaged velocity can be expressed using a combined form derived from the Stefan-Maxwell equations:\n$$J_{A,x} = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + \\frac{k_{TA}}{T} \\frac{\\partial T}{\\partial x} \\right)$$\nwhere $c$ is the total molar concentration, $\\mathcal{D}_{AB}$ is the binary diffusion coefficient, $T$ is the absolute temperature, and $k_{TA}$ is the thermal diffusion ratio for species $A$.\n\nThe thermal diffusion ratio $k_{TA}$ is related to the dimensionless thermal diffusion factor $\\alpha_T$ and the mole fractions of the species:\n$$k_{TA} = \\alpha_T x_A x_B$$\nwhere $x_A$ and $x_B$ are the mole fractions of species $A$ and $B$, respectively, and $x_A + x_B = 1$.\n\nThe Soret coefficient, $S_T$, is commonly defined in relation to the thermal diffusion factor $\\alpha_T$ and temperature $T$ as:\n$$S_T = \\frac{\\alpha_T}{T}$$\nThis definition is consistent with the given units of $S_T$, which are $\\mathrm{K}^{-1}$, since $\\alpha_T$ is dimensionless.\n\nSubstituting these relations into the flux equation, we can express the term involving the temperature gradient using the Soret coefficient $S_T$:\n$$\\frac{k_{TA}}{T} = \\frac{\\alpha_T x_A x_B}{T} = \\left(\\frac{\\alpha_T}{T}\\right) x_A x_B = S_T x_A x_B$$\nThe complete expression for the diffusive flux of species $A$ becomes:\n$$J_{A,x} = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} \\right)$$\nThe problem states that the net diffusive molar flux of $A$ vanishes, which means $J_{A,x} = 0$.\n$$0 = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} \\right)$$\nSince the total concentration $c$ and the diffusion coefficient $\\mathcal{D}_{AB}$ are non-zero, the term in the parentheses must be zero:\n$$\\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} = 0$$\nThis equation represents the balance where the diffusion driven by the concentration gradient exactly cancels the thermal diffusion (Soret effect). We can now solve for the required mole fraction gradient $\\frac{\\partial x_A}{\\partial x}$:\n$$\\frac{\\partial x_A}{\\partial x} = -S_T x_A x_B \\frac{\\partial T}{\\partial x}$$\nSince the mixture is binary, $x_B = 1 - x_A$. Substituting this into the equation gives:\n$$\\frac{\\partial x_A}{\\partial x} = -S_T x_A (1 - x_A) \\frac{\\partial T}{\\partial x}$$\nWe are given the following values:\n- Mole fraction of species $A$: $x_A = 5.00 \\times 10^{-5}$\n- Soret coefficient: $S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$\n- Temperature gradient: $\\frac{\\partial T}{\\partial x} = 2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$\n\nSubstituting these values into the derived equation:\n$$\\frac{\\partial x_A}{\\partial x} = -(1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}) \\times (5.00 \\times 10^{-5}) \\times (1 - 5.00 \\times 10^{-5}) \\times (2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1})$$\nFirst, calculate the product of the main numerical factors and the powers of $10$:\n$$(1.10) \\times (5.00) \\times (2.40) = 13.2$$\n$$10^{-3} \\times 10^{-5} \\times 10^{6} = 10^{-2}$$\nNow, include the term $(1 - x_A)$:\n$$(1 - 5.00 \\times 10^{-5}) = 0.99995$$\nCombining all parts:\n$$\\frac{\\partial x_A}{\\partial x} = -13.2 \\times 10^{-2} \\times 0.99995 \\ \\mathrm{m}^{-1}$$\n$$\\frac{\\partial x_A}{\\partial x} = -0.132 \\times 0.99995 \\ \\mathrm{m}^{-1}$$\n$$\\frac{\\partial x_A}{\\partial x} = -0.1319934 \\ \\mathrm{m}^{-1}$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\frac{\\partial x_A}{\\partial x} \\approx -0.132 \\ \\mathrm{m}^{-1}$$\nThe negative sign indicates that for the net flux to be zero, the mole fraction of species $A$ must decrease in the direction of increasing temperature. This generates a Fickian diffusion flux in the positive $x$-direction that counteracts the Soret flux, which, for a positive $S_T$, drives species $A$ toward the colder region (negative $x$-direction).",
            "answer": "$$\\boxed{-0.132}$$"
        },
        {
            "introduction": "Moving from a local point analysis to a global system, this practice challenges you to simulate the macroscopic outcome of the Soret effect: species separation in a closed cavity with an imposed temperature gradient. You will derive the governing equation for the steady-state mole fraction profile from the zero-flux condition and use a global conservation law to solve it numerically . This exercise builds crucial skills in combining physical principles with computational methods like numerical integration and root-finding.",
            "id": "4015507",
            "problem": "Consider a one-dimensional, closed, stationary cavity of length $L$ containing an ideal binary gaseous mixture at uniform pressure $p$ with no bulk flow and no species sources or sinks. The left and right walls at positions $x=0$ and $x=L$ are maintained at fixed temperatures $T_0$ and $T_1$, respectively. Assume constant thermal conductivity so that the steady-state temperature field is linear, $T(x) = T_0 + (T_1 - T_0)\\,x/L$. The mixture exhibits thermal diffusion (the Soret effect), but neglect any heat flux contribution from species gradients (the Dufour effect) and any external body forces. Let species $\\mathrm{A}$ have mole fraction $x_{\\mathrm{A}}(x)$.\n\nStarting from the Maxwell–Stefan description of multicomponent diffusion with thermal diffusion for a binary mixture, and the definition of the Soret coefficient $S_T$ for species $\\mathrm{A}$, enforce zero steady molar flux for $\\mathrm{A}$ in the closed cavity and total species conservation. Under the ideal gas assumption at uniform pressure, the local total molar concentration satisfies $c(x) = p/(R\\,T(x))$, where $R$ is the universal gas constant. The global mole fraction of species $\\mathrm{A}$ is conserved and equals the initial uniform mole fraction $x_{\\mathrm{A},\\mathrm{avg}}$ supplied below. Use these principles to compute the steady-state mole fraction profile $x_{\\mathrm{A}}(x)$ that arises solely from the Soret effect.\n\nImplement a program that:\n- Derives the governing relation for $x_{\\mathrm{A}}(x)$ from the zero-flux condition using only the Maxwell–Stefan framework and the Soret coefficient definition, without invoking any pre-derived target formulas.\n- Determines any integration constant(s) by enforcing the global species conservation constraint\n$$\nx_{\\mathrm{A},\\mathrm{avg}} \\;=\\; \\frac{\\displaystyle \\int_0^L c(x)\\,x_{\\mathrm{A}}(x)\\,dx}{\\displaystyle \\int_0^L c(x)\\,dx} \\;=\\; \\frac{\\displaystyle \\int_0^L \\frac{x_{\\mathrm{A}}(x)}{T(x)}\\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx},\n$$\nwith $c(x)=p/(R\\,T(x))$ canceling the unknown pressure and constant $R$.\n- Evaluates and reports the steady-state mole fraction values at the five positions $x \\in \\{0,\\,L/4,\\,L/2,\\,3L/4,\\,L\\}$.\n\nPhysical units and constants:\n- Length $L$ is in meters (m).\n- Temperatures $T_0$ and $T_1$ are in kelvin (K).\n- The Soret coefficient $S_T$ is in inverse kelvin ($\\mathrm{K}^{-1}$).\n- Mole fractions are dimensionless.\n\nTest suite:\nProvide results for the following parameter sets, each specified as $(L,\\,T_0,\\,T_1,\\,S_T,\\,x_{\\mathrm{A},\\mathrm{avg}})$:\n1. $(L=\\;0.10,\\;T_0=\\;1400,\\;T_1=\\;1000,\\;S_T=\\;0.002,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.35)$\n2. $(L=\\;0.20,\\;T_0=\\;1400,\\;T_1=\\;900,\\;S_T=\\;0.000,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.50)$\n3. $(L=\\;0.05,\\;T_0=\\;1200,\\;T_1=\\;1200,\\;S_T=\\;0.003,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.40)$\n4. $(L=\\;0.10,\\;T_0=\\;1000,\\;T_1=\\;1500,\\;S_T=\\;-0.0015,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.25)$\n5. $(L=\\;0.30,\\;T_0=\\;800,\\;T_1=\\;1800,\\;S_T=\\;0.004,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.90)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of five floating-point values for $x_{\\mathrm{A}}(x)$ at $x \\in \\{0,\\,L/4,\\,L/2,\\,3L/4,\\,L\\}$, in that order. For example, the output format must be\n$$\n[\\,[x_{\\mathrm{A}}(0),x_{\\mathrm{A}}(L/4),x_{\\mathrm{A}}(L/2),x_{\\mathrm{A}}(3L/4),x_{\\mathrm{A}}(L)]_{\\text{case 1}},\\;\\ldots,\\;[\\cdots]_{\\text{case 5}}\\,].\n$$",
            "solution": "The problem requires the derivation and computation of the steady-state mole fraction profile of a species in a binary ideal gas mixture subject to a temperature gradient. This phenomenon, known as the Soret effect or thermal diffusion, is a cross-diffusion effect where a temperature gradient induces a species flux. We will start from fundamental principles as laid out in the problem statement.\n\nThe system is a one-dimensional, closed, stationary cavity of length $L$ with fixed wall temperatures $T(x=0) = T_0$ and $T(x=L) = T_1$. The pressure $p$ is uniform. There is no bulk flow, and no chemical reactions occur. The temperature profile is given as linear:\n$$\nT(x) = T_0 + (T_1 - T_0) \\frac{x}{L}\n$$\nThis is consistent with the assumption of constant thermal conductivity. The mixture is an ideal gas, so the total molar concentration $c$ varies with temperature as $c(x) = p/(R T(x))$, where $R$ is the universal gas constant.\n\nThe molar flux of species $\\mathrm{A}$, denoted $J_{\\mathrm{A}}^*$, in a binary mixture arises from ordinary diffusion (driven by mole fraction gradients) and thermal diffusion (driven by temperature gradients). Within the Maxwell-Stefan framework, for a binary system, this flux can be expressed in a Fickian-like form. The contribution from thermal diffusion is characterized by the Soret coefficient, $S_T$. The combined molar flux is given by:\n$$\nJ_{\\mathrm{A}}^* = -c D_{\\mathrm{AB}} \\frac{dx_{\\mathrm{A}}}{dx} - c D_{\\mathrm{AB}} S_T x_{\\mathrm{A}} (1-x_{\\mathrm{A}}) \\frac{1}{T} \\frac{dT}{dx}\n$$\nwhere $c(x)$ is the total molar concentration, $D_{\\mathrm{AB}}$ is the binary diffusion coefficient, $x_{\\mathrm{A}}(x)$ is the mole fraction of species $\\mathrm{A}$, and $T(x)$ is the temperature. The term $x_{\\mathrm{A}}(1-x_{\\mathrm{A}})$ arises from $x_{\\mathrm{A}}x_{\\mathrm{B}}$ where $x_{\\mathrm{B}} = 1 - x_{\\mathrm{A}}$ is the mole fraction of the other species, B.\n\nFor a closed system at steady state with no sources or sinks, the net molar flux of each species must be zero everywhere. Therefore, we impose the condition $J_{\\mathrm{A}}^* = 0$:\n$$\n0 = -c D_{\\mathrm{AB}} \\frac{dx_{\\mathrm{A}}}{dx} - c D_{\\mathrm{AB}} S_T x_{\\mathrm{A}} (1-x_{\\mathrm{A}}) \\frac{1}{T} \\frac{dT}{dx}\n$$\nAssuming a non-zero concentration $c$ and diffusion coefficient $D_{\\mathrm{AB}}$, we can simplify this equation:\n$$\n\\frac{dx_{\\mathrm{A}}}{dx} = -S_T x_{\\mathrm{A}}(1 - x_{\\mathrm{A}}) \\frac{1}{T} \\frac{dT}{dx}\n$$\nThis is a separable first-order ordinary differential equation. We can rearrange it to separate the variables $x_{\\mathrm{A}}$ and $T$:\n$$\n\\frac{dx_{\\mathrm{A}}}{x_{\\mathrm{A}}(1 - x_{\\mathrm{A}})} = -S_T \\frac{d(\\ln T)}{dx} dx = -S_T d(\\ln T)\n$$\nWe integrate this equation. The left-hand side is integrated using partial fraction decomposition, $\\frac{1}{x_{\\mathrm{A}}(1 - x_{\\mathrm{A}})} = \\frac{1}{x_{\\mathrm{A}}} + \\frac{1}{1 - x_{\\mathrm{A}}}$.\n$$\n\\int \\left( \\frac{1}{x_{\\mathrm{A}}} + \\frac{1}{1 - x_{\\mathrm{A}}} \\right) dx_{\\mathrm{A}} = \\int -S_T d(\\ln T)\n$$\nAssuming the Soret coefficient $S_T$ is constant, the integration yields:\n$$\n\\ln(x_{\\mathrm{A}}) - \\ln(1 - x_{\\mathrm{A}}) = -S_T \\ln(T) + C_1\n$$\nwhere $C_1$ is the constant of integration. Combining the logarithmic terms:\n$$\n\\ln\\left(\\frac{x_{\\mathrm{A}}}{1 - x_{\\mathrm{A}}}\\right) = \\ln(T^{-S_T}) + C_1\n$$\nExponentiating both sides gives the relationship between the mole fraction and temperature:\n$$\n\\frac{x_{\\mathrm{A}}(x)}{1 - x_{\\mathrm{A}}(x)} = e^{C_1} T(x)^{-S_T} = C T(x)^{-S_T}\n$$\nwhere $C = e^{C_1}$ is a new positive constant. Solving for $x_{\\mathrm{A}}(x)$, we obtain the functional form of the mole fraction profile:\n$$\nx_{\\mathrm{A}}(x) = \\frac{C T(x)^{-S_T}}{1 + C T(x)^{-S_T}} = \\frac{C}{T(x)^{S_T} + C}\n$$\nThe integration constant $C$ is determined by enforcing the conservation of the total number of moles of species $\\mathrm{A}$ in the cavity. The global average mole fraction, $x_{\\mathrm{A},\\mathrm{avg}}$, must be equal to the mean mole fraction in the steady-state profile, weighted by the local molar concentration $c(x)$:\n$$\nx_{\\mathrm{A},\\mathrm{avg}} = \\frac{\\displaystyle \\int_0^L c(x)\\,x_{\\mathrm{A}}(x)\\,dx}{\\displaystyle \\int_0^L c(x)\\,dx}\n$$\nSubstituting $c(x) = p/(RT(x))$ and canceling the constant factor $p/R$:\n$$\nx_{\\mathrm{A},\\mathrm{avg}} = \\frac{\\displaystyle \\int_0^L \\frac{x_{\\mathrm{A}}(x)}{T(x)}\\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx}\n$$\nSubstituting the derived expression for $x_{\\mathrm{A}}(x)$:\n$$\nx_{\\mathrm{A},\\mathrm{avg}} = \\frac{\\displaystyle \\int_0^L \\frac{1}{T(x)} \\frac{C}{T(x)^{S_T} + C} \\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx}\n$$\nThis is an implicit equation for the constant $C$. For a general non-integer value of $S_T$, the integrals do not have a simple closed-form analytical solution. Therefore, a numerical approach is required. We must find the root $C$ of the function $f(C) = 0$, where:\n$$\nf(C) = \\frac{\\displaystyle \\int_0^L \\frac{C}{T(x)(T(x)^{S_T} + C)} \\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx} - x_{\\mathrm{A},\\mathrm{avg}}\n$$\nThis constitutes a numerical root-finding problem. The integrals are computed using numerical quadrature, and a root-finding algorithm (such as the Brent-Dekker method) is used to solve for $C$.\n\nTwo special cases can be solved directly:\n1.  If $S_T = 0$, the thermal diffusion term is zero. The differential equation simplifies to $dx_{\\mathrm{A}}/dx = 0$, meaning $x_{\\mathrm{A}}(x)$ is constant. The conservation constraint immediately implies $x_{\\mathrm{A}}(x) = x_{\\mathrm{A},\\mathrm{avg}}$ for all $x$.\n2.  If $T_1 = T_0$, the temperature is uniform, $T(x) = T_0$, so $dT/dx = 0$. This also leads to $dx_{\\mathrm{A}}/dx = 0$, and thus $x_{\\mathrm{A}}(x) = x_{\\mathrm{A},\\mathrm{avg}}$.\n\nFor the general cases, the numerical procedure is as follows:\n1.  For a given set of parameters $(L, T_0, T_1, S_T, x_{\\mathrm{A},\\mathrm{avg}})$, check for the special cases above.\n2.  If it is a general case, define the objective function $f(C)$.\n3.  The integrals within $f(C)$ are computed numerically.\n4.  Find the root $C$ that satisfies $f(C)=0$. Since $x_{\\mathrm{A}}$ must be between $0$ and $1$, and $T(x)$ is positive, the constant $C$ must be positive.\n5.  Once the unique positive root $C$ is found, the mole fraction profile is fully determined by $x_{\\mathrm{A}}(x) = C / (T(x)^{S_T} + C)$.\n6.  Evaluate this function at the specified positions $x \\in \\{0, L/4, L/2, 3L/4, L\\}$.\n\nThis procedure is implemented for each test case to obtain the required mole fraction values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Main solver function that processes test cases and prints the results.\n    \"\"\"\n    # Test suite from the problem statement\n    # Each case is (L, T0, T1, ST, xA_avg)\n    test_cases = [\n        (0.10, 1400., 1000., 0.002, 0.35),\n        (0.20, 1400., 900., 0.000, 0.50),\n        (0.05, 1200., 1200., 0.003, 0.40),\n        (0.10, 1000., 1500., -0.0015, 0.25),\n        (0.30, 800., 1800., 0.004, 0.90)\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = calculate_profile(*case)\n        results.append(case_results)\n\n    # The problem asks for the exact format generated by str() on a list of lists,\n    # which is used by the f-string formatting below.\n    # The template is: print(f\"[{','.join(map(str, results))}]\")\n    # This produces spaces after commas inside the sublists, e.g., \"[0.5, 0.5,...]\".\n    # To match the no-space example in the problem description (e.g., \"[0.5,0.5,...]\"),\n    # we manually construct the string.\n    \n    results_str_list = []\n    for res_list in results:\n        # Format each list of floats into a string like \"[v1,v2,v3,v4,v5]\"\n        formatted_list = f\"[{','.join(f'{v:.7f}' for v in res_list)}]\"\n        results_str_list.append(formatted_list)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\n\ndef calculate_profile(L, T0, T1, ST, xA_avg):\n    \"\"\"\n    Calculates the steady-state mole fraction profile for a single case.\n\n    Args:\n        L (float): Length of the cavity (m).\n        T0 (float): Temperature at x=0 (K).\n        T1 (float): Temperature at x=L (K).\n        ST (float): Soret coefficient (1/K).\n        xA_avg (float): Average mole fraction of species A.\n\n    Returns:\n        list: A list of 5 float values for x_A at x = 0, L/4, L/2, 3L/4, L.\n    \"\"\"\n    # Define the temperature profile T(x)\n    def T(x):\n        return T0 + (T1 - T0) * x / L\n\n    # Handle special cases first: no Soret effect or no temperature gradient\n    if ST == 0.0 or T0 == T1:\n        return [xA_avg] * 5\n\n    # General case: needs numerical solution for the integration constant C\n    \n    # Denominator of the conservation equation: integral of 1/T(x)\n    # This can be solved analytically, which is more robust than numerical integration.\n    # integral(1/T)dx from 0 to L = L/(T1-T0) * ln(T1/T0)\n    I_den = (L / (T1 - T0)) * np.log(T1 / T0)\n\n    # Define the function for which we need to find the root C.\n    # f(C) = <x_A(C)> - xA_avg = 0\n    def objective_function(C):\n        if C <= 0: # C must be positive\n             return -xA_avg\n        \n        # Integrand for the numerator of the conservation equation\n        def integrand_num(x):\n            Tx = T(x)\n            # Use np.power for potentially fractional exponents\n            return (1.0 / Tx) * (C / (np.power(Tx, ST) + C))\n\n        # Numerically compute the numerator integral\n        I_num, _ = integrate.quad(integrand_num, 0, L)\n\n        # Calculate the weighted average mole fraction for the given C\n        calculated_xA_avg = I_num / I_den\n        \n        return calculated_xA_avg - xA_avg\n\n    # Find the root for C. The function is monotonic for C > 0.\n    # The integration constant C=exp(C1) must be positive.\n    # We choose a wide bracket [a, b] for the root finder.\n    # As C -> 0+, f(C) -> -xA_avg < 0.\n    # As C -> inf, f(C) -> 1 - xA_avg > 0.\n    # So a root is guaranteed in (0, inf).\n    try:\n        C_sol = optimize.brentq(objective_function, 1e-12, 1e12, maxiter=200)\n    except ValueError:\n        # This might happen if the interval does not bracket a root,\n        # which shouldn't occur based on the analysis.\n        # Fallback to a wider search or handle the error appropriately.\n        # For this problem, brentq is expected to succeed.\n        return [np.nan] * 5 \n\n    # With C found, define the mole fraction profile x_A(x)\n    def xA_profile(x):\n        Tx = T(x)\n        return C_sol / (np.power(Tx, ST) + C_sol)\n\n    # Evaluate the profile at the required points\n    x_points = [0, L / 4, L / 2, 3 * L / 4, L]\n    profile_values = [xA_profile(x) for x in x_points]\n\n    return profile_values\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice demonstrates the tangible impact of the Soret effect on a critical combustion metric, the laminar flame speed, which is determined by the interplay between chemical reaction and transport processes. You will implement a sensitivity analysis to quantify how thermal diffusion of key species can enhance or inhibit flame propagation within a simplified but physically insightful model . This exercise directly connects the microscopic transport phenomenon to a global, observable property, highlighting its practical importance in combustion modeling.",
            "id": "4015514",
            "problem": "Consider a one-dimensional, steady, planar premixed flame propagating with speed $S$ into a quiescent, uniform unburnt mixture along the $x$-axis. The mixture contains $N$ key species indexed by $i \\in \\{1,\\dots,N\\}$ with mass fractions $Y_i(x)$ and temperature $T(x)$. The mass conservation for species $i$ in the reference frame attached to the flame front is given by the steady one-dimensional species balance, which is a consequence of the conservation of mass and the transport of species:\n$$\n- S \\,\\frac{d Y_i}{d x} \\;=\\; \\frac{d J_i}{d x} \\;+\\; \\omega_i,\n$$\nwhere $J_i$ is the diffusive mass flux of species $i$ and $\\omega_i$ is the net production rate of species $i$ due to chemical reactions. In a mixture-averaged description with thermal diffusion (the Soret phenomenon), the species flux is modeled as\n$$\nJ_i \\;=\\; - \\rho\\, D_i \\,\\frac{d Y_i}{d x} \\;-\\; \\rho\\, D_{T,i}\\, Y_i(1-Y_i)\\, \\frac{d(\\ln T)}{d x},\n$$\nwhere $\\rho$ is the density, $D_i$ is the mixture-averaged mass diffusion coefficient of species $i$, and $D_{T,i}$ is the thermal diffusion coefficient given by $D_{T,i} = k_{T,i} D_i$, with $k_{T,i}$ the thermal diffusion ratio for species $i$. The energy equation, which includes the Dufour phenomenon (cross-heat flux driven by species gradients), can be written as a steady one-dimensional balance of convection, conduction, cross-heat flux, and reaction heat release. For the purposes of local sensitivity with respect to the thermal diffusion ratios $k_{T,i}$, treat the temperature jump across the flame, characterized by the dimensionless quantity\n$$\n\\Delta \\ln T \\;=\\; \\ln\\!\\left(\\frac{T_b}{T_u}\\right),\n$$\nas a fixed input determined by upstream and burned conditions, where $T_u$ is the unburnt upstream temperature and $T_b$ is the burnt downstream temperature (both in $\\mathrm{K}$). This assumption makes the influence of the Dufour phenomenon implicit through the fixed temperature jump, while the explicit sensitivity target is the Soret coupling via $k_{T,i}$.\n\nIntroduce a scalar progress variable $c(x)$ that increases monotonically from upstream to downstream and is constructed as a weighted sum of species changes, with weights $w_i$ representing stoichiometric and reactivity importance. Under a leading-edge linearization of the reaction term with an effective growth rate $r_{\\mathrm{eff}}$ (in $\\mathrm{s}^{-1}$), the coupled system can be reduced to a scalar advection–diffusion–reaction equation for $c(x)$ in the flame-attached frame. The diffusion of the progress variable inherits mixture-averaged and thermal diffusion contributions from the species fluxes. From this reduced description and fundamental conservation laws, one can compute a physically meaningful flame speed $S$ (in $\\mathrm{m/s}$) that depends on the effective diffusion coefficient and the effective growth rate.\n\nYour task is to implement a local sensitivity analysis of the computed flame speed $S$ with respect to the thermal diffusion ratios $k_{T,i}$ for the key species using the symmetric finite-difference definition of a partial derivative. For a small perturbation $\\varepsilon$, the local sensitivity for species $i$ is defined as\n$$\n\\frac{\\partial S}{\\partial k_{T,i}} \\;\\approx\\; \\frac{S\\!\\left(k_{T,i} + \\varepsilon\\right) \\;-\\; S\\!\\left(k_{T,i} - \\varepsilon\\right)}{2\\,\\varepsilon},\n$$\ncomputed with all other parameters held fixed. The perturbation $\\varepsilon$ must be chosen sufficiently small to capture local behavior but not so small as to cause numerical cancellation; use $\\varepsilon = 10^{-6}$.\n\nUse the following modeling framework for computing $S$ from given parameters, which is derived from the leading-edge linearization of the coupled conservation equations described above: treat the effective diffusion coefficient of the progress variable as a mixture-averaged sum with thermal diffusion contributions proportional to the temperature jump,\n$$\nD_{\\mathrm{eff}} \\;=\\; \\sum_{i=1}^{N} w_i \\, D_i \\, \\left( 1 + k_{T,i}\\, \\Delta \\ln T \\right),\n$$\nand compute the flame speed from the scalar advection–diffusion–reaction leading-edge analysis as\n$$\nS \\;=\\; 2 \\,\\sqrt{D_{\\mathrm{eff}} \\, r_{\\mathrm{eff}}}.\n$$\nHere $D_i$ are in $\\mathrm{m^2/s}$, $r_{\\mathrm{eff}}$ is in $\\mathrm{s^{-1}}$, and $S$ is in $\\mathrm{m/s}$. The density $\\rho$ does not explicitly appear after nondimensionalization of the scalar reduction; the Dufour contribution is embedded implicitly in the temperature jump $\\Delta \\ln T$. Ensure $D_{\\mathrm{eff}} > 0$ for physical consistency.\n\nImplement a program that, for each specified test case, computes the local sensitivities $\\partial S / \\partial k_{T,i}$ for all species $i$ using the symmetric finite-difference formula above. Express all sensitivity values in $\\mathrm{m/s}$.\n\nUse the following test suite. In all cases, the species order is $[\\text{H}_2, \\text{CO}, \\text{H}_2\\text{O}]$, and all diffusion coefficients $D_i$ are given in $\\mathrm{m^2/s}$, temperatures in $\\mathrm{K}$, and $r_{\\mathrm{eff}}$ in $\\mathrm{s^{-1}}$.\n\n- Test Case $1$ (general case):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.5,\\; 0.3,\\; 0.2]$\n  - $k_{T,i} = [0.35,\\; 0.05,\\; -0.02]$\n  - $T_u = 300$\n  - $T_b = 2100$\n  - $r_{\\mathrm{eff}} = 500$\n\n- Test Case $2$ (boundary case with zero thermal diffusion ratios):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.5,\\; 0.3,\\; 0.2]$\n  - $k_{T,i} = [0.0,\\; 0.0,\\; 0.0]$\n  - $T_u = 300$\n  - $T_b = 2100$\n  - $r_{\\mathrm{eff}} = 500$\n\n- Test Case $3$ (edge case with small temperature jump):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.5,\\; 0.3,\\; 0.2]$\n  - $k_{T,i} = [0.35,\\; 0.05,\\; -0.02]$\n  - $T_u = 300$\n  - $T_b = 330$\n  - $r_{\\mathrm{eff}} = 500$\n\n- Test Case $4$ (edge case with negative dominant thermal diffusion ratio and altered weights and rate):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.6,\\; 0.25,\\; 0.15]$\n  - $k_{T,i} = [-0.40,\\; 0.10,\\; 0.05]$\n  - $T_u = 290$\n  - $T_b = 2200$\n  - $r_{\\mathrm{eff}} = 100$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be flattened in test-case-major order and species-minor order. That is, the output should be\n$$\n\\big[ s_{1,1},\\; s_{1,2},\\; s_{1,3},\\; s_{2,1},\\; s_{2,2},\\; s_{2,3},\\; s_{3,1},\\; s_{3,2},\\; s_{3,3},\\; s_{4,1},\\; s_{4,2},\\; s_{4,3} \\big],\n$$\nwhere $s_{j,i}$ denotes the sensitivity $\\partial S/\\partial k_{T,i}$ for species $i$ in test case $j$, expressed in $\\mathrm{m/s}$. No additional text should be printed.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and self-contained. The model presented for the flame speed, while simplified, is based on established principles of combustion theory, specifically the asymptotic analysis of premixed flame structures. The parameters provided are physically realistic, and the task is a standard numerical sensitivity analysis. There are no contradictions, ambiguities, or logical flaws. We may therefore proceed with the solution.\n\nThe objective is to compute the local sensitivity of the planar premixed flame speed, $S$, with respect to the thermal diffusion ratio, $k_{T,i}$, for each key species $i$. The sensitivity is a partial derivative, $\\partial S / \\partial k_{T,i}$, which quantifies how the flame speed changes in response to an infinitesimal change in a given thermal diffusion ratio, while all other parameters are held constant. This analysis is crucial for understanding the impact of Soret diffusion on flame propagation.\n\nThe problem provides a complete model to calculate the flame speed $S$ from a set of fundamental parameters. This model can be expressed as a composite function. The calculation proceeds through the following sequence of steps:\n\n1.  **Dimensionless Temperature Jump**: First, the characteristic temperature jump across the flame is quantified by the dimensionless parameter $\\Delta \\ln T$. This is calculated from the unburnt ($T_u$) and burnt ($T_b$) gas temperatures:\n    $$\n    \\Delta \\ln T = \\ln\\left(\\frac{T_b}{T_u}\\right)\n    $$\n    This quantity represents the strength of the temperature gradient that drives thermal diffusion.\n\n2.  **Effective Diffusion Coefficient**: The model uses a progress variable approach, where the complex multicomponent diffusion is condensed into a single effective diffusion coefficient, $D_{\\mathrm{eff}}$. This coefficient is a weighted sum of the contributions from each of the $N$ species, incorporating both ordinary mass diffusion (via $D_i$) and thermal diffusion (via $k_{T,i}$). The formula is given as:\n    $$\n    D_{\\mathrm{eff}}(k_{T,1}, \\dots, k_{T,N}) = \\sum_{i=1}^{N} w_i D_i \\left( 1 + k_{T,i} \\Delta \\ln T \\right)\n    $$\n    Here, $w_i$ are weights, $D_i$ are the mixture-averaged diffusion coefficients, and $k_{T,i}$ are the thermal diffusion ratios that we will be analyzing. For physical consistency, we must have $D_{\\mathrm{eff}} > 0$.\n\n3.  **Flame Speed**: The flame speed $S$ is then calculated using a classic result from leading-edge flame theory, which relates the speed to the balance between diffusion and reaction:\n    $$\n    S = 2 \\sqrt{D_{\\mathrm{eff}} r_{\\mathrm{eff}}}\n    $$\n    where $r_{\\mathrm{eff}}$ is an effective reaction rate. Combining these steps, the flame speed $S$ is a function of the vector of thermal diffusion ratios, $\\mathbf{k_T} = (k_{T,1}, \\dots, k_{T,N})$, and other fixed parameters.\n\nTo compute the sensitivity $\\partial S / \\partial k_{T,i}$, we will use the symmetric finite-difference formula provided in the problem statement. This is a numerical approximation of the partial derivative:\n$$\n\\frac{\\partial S}{\\partial k_{T,i}} \\approx \\frac{S(\\mathbf{k_T} + \\varepsilon \\mathbf{e}_i) - S(\\mathbf{k_T} - \\varepsilon \\mathbf{e}_i)}{2\\varepsilon}\n$$\nHere, $\\mathbf{e}_i$ is the standard basis vector with a $1$ in the $i$-th position and zeros elsewhere. $S(\\mathbf{k_T} + \\varepsilon \\mathbf{e}_i)$ represents the flame speed computed with the $i$-th thermal diffusion ratio perturbed to $k_{T,i} + \\varepsilon$, and $S(\\mathbf{k_T} - \\varepsilon \\mathbf{e}_i)$ is the speed with $k_{T,i}$ perturbed to $k_{T,i} - \\varepsilon$. The perturbation value is specified as $\\varepsilon = 10^{-6}$, which is small enough to approximate the local derivative accurately while being large enough to avoid catastrophic cancellation (round-off errors) in floating-point arithmetic.\n\nThe overall algorithm to solve the problem is as follows:\n1.  For each of the four test cases provided:\n    a. Extract the parameters: number of species $N$, diffusion coefficients $D_i$, weights $w_i$, baseline thermal diffusion ratios $k_{T,i}$, temperatures $T_u$ and $T_b$, and the effective reaction rate $r_{\\mathrm{eff}}$.\n    b. Define a function that computes the flame speed $S$ for a given vector of thermal diffusion ratios $\\mathbf{k_T}$ and the fixed parameters of the current test case, following the three-step model described above.\n    c. For each species $i$ from $1$ to $N$:\n        i. Create the forward-perturbed vector of thermal diffusion ratios, $\\mathbf{k_T}^{+}$, where the $i$-th element is $k_{T,i} + \\varepsilon$.\n        ii. Create the backward-perturbed vector, $\\mathbf{k_T}^{-}$, where the $i$-th element is $k_{T,i} - \\varepsilon$.\n        iii. Calculate the corresponding flame speeds, $S_{\\text{plus}} = S(\\mathbf{k_T}^{+})$ and $S_{\\text{minus}} = S(\\mathbf{k_T}^{-})$, using the function from step 1b.\n        iv. Compute the sensitivity for species $i$ in the current test case $j$ as $s_{j,i} = (S_{\\text{plus}} - S_{\\text{minus}}) / (2\\varepsilon)$.\n        v. Store this value.\n2.  After computing the sensitivities for all species across all test cases, compile the results into a single flattened list in test-case-major, species-minor order.\n3.  Format and print the final list as specified.\nThis procedure will be implemented for each test case to generate the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the local sensitivity of flame speed with respect to thermal\n    diffusion ratios for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Test Case 1 (general case)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2]),\n            \"k_T\": np.array([0.35, 0.05, -0.02]),\n            \"T_u\": 300.0,\n            \"T_b\": 2100.0,\n            \"r_eff\": 500.0,\n        },\n        {\n            # Test Case 2 (boundary case with zero thermal diffusion ratios)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2]),\n            \"k_T\": np.array([0.0, 0.0, 0.0]),\n            \"T_u\": 300.0,\n            \"T_b\": 2100.0,\n            \"r_eff\": 500.0,\n        },\n        {\n            # Test Case 3 (edge case with small temperature jump)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2]),\n            \"k_T\": np.array([0.35, 0.05, -0.02]),\n            \"T_u\": 300.0,\n            \"T_b\": 330.0,\n            \"r_eff\": 500.0,\n        },\n        {\n            # Test Case 4 (edge case with negative dominant ratio and altered params)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.6, 0.25, 0.15]),\n            \"k_T\": np.array([-0.40, 0.10, 0.05]),\n            \"T_u\": 290.0,\n            \"T_b\": 2200.0,\n            \"r_eff\": 100.0,\n        },\n    ]\n\n    all_sensitivities = []\n    epsilon = 1e-6\n\n    def compute_s(k_T_vec, params):\n        \"\"\"\n        Computes the flame speed S based on the provided model.\n        \n        Args:\n            k_T_vec (np.ndarray): Vector of thermal diffusion ratios [k_T1, k_T2, ...].\n            params (dict): Dictionary containing the fixed parameters for the case.\n            \n        Returns:\n            float: The computed flame speed S.\n        \"\"\"\n        delta_ln_T = np.log(params[\"T_b\"] / params[\"T_u\"])\n        \n        # Calculate effective diffusion coefficient D_eff\n        d_eff_terms = params[\"w\"] * params[\"D\"] * (1.0 + k_T_vec * delta_ln_T)\n        d_eff = np.sum(d_eff_terms)\n        \n        if d_eff <= 0:\n            # This case should not be reached with the given test data,\n            # but it is a necessary check for physical consistency.\n            raise ValueError(\"Effective diffusion coefficient must be positive.\")\n            \n        # Calculate flame speed S\n        s = 2.0 * np.sqrt(d_eff * params[\"r_eff\"])\n        \n        return s\n\n    for case in test_cases:\n        num_species = len(case[\"D\"])\n        base_k_T = case[\"k_T\"]\n        \n        for i in range(num_species):\n            # Perturb k_T for species i (forward step)\n            k_T_plus = base_k_T.copy()\n            k_T_plus[i] += epsilon\n            s_plus = compute_s(k_T_plus, case)\n            \n            # Perturb k_T for species i (backward step)\n            k_T_minus = base_k_T.copy()\n            k_T_minus[i] -= epsilon\n            s_minus = compute_s(k_T_minus, case)\n            \n            # Compute sensitivity using symmetric finite difference\n            sensitivity = (s_plus - s_minus) / (2.0 * epsilon)\n            all_sensitivities.append(sensitivity)\n\n    # Format the output as a comma-separated list in brackets\n    # Note: Using a general formatter to avoid floating point representation issues\n    # and ensure consistent output.\n    formatted_results = [f\"{val:.10f}\".rstrip('0').rstrip('.') for val in all_sensitivities]\n    \n    # The problem asks for a plain string representation of floats.\n    # The default `str()` representation is sufficient.\n    print(f\"[{','.join(map(str, all_sensitivities))}]\")\n\nsolve()\n```"
        }
    ]
}