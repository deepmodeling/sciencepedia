{
    "hands_on_practices": [
        {
            "introduction": "在多孔介质中正确建立输运方程的第一步是理解不同速度定义之间的关系。本练习通过一个假设的非均匀孔隙率场，阐明了质量守恒定律如何决定流体在孔隙内的真实速度。掌握这种从宏观（表观）速度到微观（本征）速度的转换，是建立任何多孔介质燃烧模型的基础。",
            "id": "4052681",
            "problem": "考虑一个在一维空间 $x \\in [0,L]$ 上，预混气体流经刚性多孔燃烧器的计算燃烧模拟。假设气相是稳态、等温且不可压缩的，固体基质是静止的。气相中没有体积质量源或汇（例如，在代表性单元体积内没有净生成或消耗）。孔隙度场呈线性变化，其形式为 $\\varepsilon(x) = \\varepsilon_0 + \\alpha x$，其中 $\\varepsilon_0 > 0$ 且对于所有 $x \\in [0,L]$ 都有 $\\varepsilon(x) > 0$。\n\n利用代表性单元体积（REV）尺度上的质量守恒和体积平均定理，推导满足无源一维流宏观连续性条件的内禀（相平均）气体速度 $\\langle u \\rangle^{s}(x)$ 的空间变化规律。由于入口体积流量和横截面积恒定，表观速度 $U_s$ 在 $x$ 方向上是均匀的。\n\n您的答案必须是仅包含 $\\varepsilon_0$、$\\alpha$、$U_s$ 和 $x$ 的单一闭式符号表达式。无需进行数值计算。请用符号表示您的答案，不要包含单位。",
            "solution": "用户提供了一个需要解决的问题。根据协议，第一步是验证问题陈述。\n\n### 步骤1：提取已知条件\n从问题陈述中逐字提取已知条件：\n-   区域：一维空间，沿 $x \\in [0,L]$。\n-   系统：预混气体流经刚性多孔燃烧器。\n-   气相假设：稳态、等温、不可压缩。\n-   固相假设：基质静止。\n-   质量源/汇：气相中无体积质量源或汇。\n-   孔隙度场：$\\varepsilon(x) = \\varepsilon_0 + \\alpha x$。\n-   孔隙度约束：$\\varepsilon_0 > 0$ 且对于所有 $x \\in [0,L]$ 都有 $\\varepsilon(x) > 0$。\n-   表观速度：$U_s$ 在 $x$ 方向上是均匀的。\n-   目标：推导内禀（相平均）气体速度 $\\langle u \\rangle^{s}(x)$ 的空间变化规律。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定的验证标准对问题进行评估。\n-   **科学依据**：该问题基于多孔介质输运现象这一成熟领域，特别是关于质量守恒。所使用的概念——孔隙度、表观速度和内禀（相平均）速度——是该领域的基础。体积平均定理是从微观原理推导宏观输运方程的标准数学工具。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。它提供了一个明确的物理系统、一套控制性假设以及孔隙度场的具体关系。它要求推导一个变量（内禀速度）作为给定参数的函数。所提供的信息足以确定唯一解。\n-   **客观性**：问题以客观、技术性的语言陈述，没有歧义或主观性论断。\n-   **缺陷分析**：\n    1.  **科学或事实不合理性**：该问题不违反任何科学原理。其核心概念基于多孔介质中不可压缩流体的连续性方程。\n    2.  **无法形式化或不相关**：该问题可直接使用多孔介质的标准连续介质力学方程进行形式化。它与多孔介质燃烧模拟的主题直接相关。\n    3.  **设置不完整或矛盾**：问题是自洽的。关于 $U_s$ 是均匀的陈述与无质量源汇的一维流动的宏观连续性方程一致。条件 $\\varepsilon_0 > 0$ 和 $\\varepsilon(x) > 0$ 确保了孔隙度的物理意义得以保持。\n    4.  **不切实际或不可行**：线性孔隙度分布是研究非均匀多孔介质的一个有效且有用的模型。它在物理上是合理的，不构成不可行的条件。\n    5.  **不适定或结构不良**：问题结构清晰，要求推导一个特定的、可导出的量。\n    6.  **伪深刻、琐碎或同义反复**：该问题要求将一个基本物理关系应用于材料属性（孔隙度）的特定函数形式。这是输运现象中的一个标准练习，既不琐碎也不刻意。\n    7.  **超出科学可验证性**：推导过程纯粹是数学性的，并基于已建立的物理定律，因此是完全可以验证的。\n\n### 步骤3：结论与行动\n该问题是**有效的**。它在科学上是合理的，是适定的，并且提供了所有必要的信息。我现在将进行求解。\n\n在多孔介质中，连接表观速度和内禀速度的基本原理源于质量守恒。表观速度 $U_s$ 表示单位总横截面积（固体基质加流体孔隙）的体积流量。内禀速度，此处表示为 $\\langle u \\rangle^{s}$，代表孔隙空间内流体颗粒的实际平均速度。\n\n该关系由孔隙度 $\\varepsilon$ 定义，$\\varepsilon$ 是流体占据的总体积的分数。对于给定的横截平面，可供流动的面积是总面积的一部分，比例为 $\\varepsilon$。为保持相同的体积流量，孔隙内的流体速度必须高于表观速度。这种关系通常被称为 Dupuit-Forchheimer 关系，即：\n$$U_s = \\varepsilon \\langle u \\rangle^{s}$$\n在固体相静止且无相变的假设下，将体积平均定理应用于不可压缩流体的微观连续性方程 $\\nabla \\cdot \\mathbf{u} = 0$，可以直接得到该方程。流体相的宏观连续性方程变为 $\\nabla \\cdot (\\varepsilon \\langle \\mathbf{u} \\rangle^{s}) = 0$。项 $\\varepsilon \\langle \\mathbf{u} \\rangle^{s}$ 被定义为表观速度矢量 $\\mathbf{U}_s$。因此，宏观质量守恒方程简化为 $\\nabla \\cdot \\mathbf{U_s} = 0$。\n\n对于问题中指定的一维流动，该方程简化为：\n$$\\frac{d}{dx} (U_s(x)) = 0$$\n这意味着表观速度 $U_s$ 相对于空间坐标 $x$ 是恒定的。问题陈述通过说明“$U_s$ 在 $x$ 方向上是均匀的”证实了这一点。\n\n问题要求得到内禀速度 $\\langle u \\rangle^{s}(x)$ 的表达式。我们可以重新排列 Dupuit-Forchheimer 关系式来求解 $\\langle u \\rangle^{s}(x)$：\n$$\\langle u \\rangle^{s}(x) = \\frac{U_s}{\\varepsilon(x)}$$\n问题为孔隙度场提供了一个关于 $x$ 的线性函数的具体形式：\n$$\\varepsilon(x) = \\varepsilon_0 + \\alpha x$$\n其中 $\\varepsilon_0$ 是入口 $x=0$ 处的孔隙度，$\\alpha$ 是孔隙度随位置的变化率。\n\n将给定的 $\\varepsilon(x)$ 表达式代入内禀速度方程，得到最终表达式：\n$$\\langle u \\rangle^{s}(x) = \\frac{U_s}{\\varepsilon_0 + \\alpha x}$$\n该方程描述了内禀气体速度必须如何随空间变化，以在孔隙度随空间变化的区域内保持恒定的宏观质量通量（即恒定的表观速度）。约束条件 $\\varepsilon_0 > 0$ 和对于 $x \\in [0,L]$ 都有 $\\varepsilon(x) > 0$ 确保了分母始终为正且非零，从而保证了速度具有明确的物理意义。",
            "answer": "$$\\boxed{\\frac{U_s}{\\varepsilon_0 + \\alpha x}}$$"
        },
        {
            "introduction": "在进行复杂的数值模拟之前，通过量纲分析获得对物理过程的深刻洞察是至关重要的一步。本练习将通过计算关键的无量纲数，来比较系统中对流、扩散和化学反应的相对重要性。这种方法使我们能够预测系统的行为，并确定在建模时需要优先精确描述的关键物理过程。",
            "id": "4052636",
            "problem": "一股贫燃的甲烷-空气预混气流在大气压下流过一个刚性开孔多孔基质，其中放热反应主要在气相中发生。您将从守恒定律的时间和长度尺度出发，评估在一个代表性的稳定工作点下，气相反应与输运以及气固界面热交换的相对重要性。使用以下情景和参数，这些参数都代表了碳化硅泡沫中稳定火焰的情况：\n\n- 多孔段厚度：$L = 0.020\\,\\mathrm{m}$。\n- 孔隙率：$\\varepsilon = 0.70$。\n- 表观（达西）速度：$U_{s} = 0.20\\,\\mathrm{m\\,s^{-1}}$。\n- 孔尺度输运的特征孔/支柱长度：$L_{c} = 1.0 \\times 10^{-3}\\,\\mathrm{m}$。\n- 反应区条件下气体的热扩散率：$\\alpha_{g} = 2.0 \\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$。\n- 气固界面传热系数：$h_{gs} = 1.0 \\times 10^{3}\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n- 固体热导率（多孔基质固相）：$k_{s} = 30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$。\n- 跨越支柱/连接体的相内传导的固体特征长度：$L_{s} = 1.0 \\times 10^{-3}\\,\\mathrm{m}$。\n- 局部反应区条件下的有效单步气相化学反应速率常数（可解释为气相化学时间尺度的倒数）：$k_{\\mathrm{eff}} = 1.20 \\times 10^{3}\\,\\mathrm{s^{-1}}$。\n\n任务：\n\n1. 使用从表观速度 $U_{s}$ 和孔隙率 $\\varepsilon$ 得到的间隙速度 $U_{i}$，根据第一性原理构建由多孔介质中物种和能量平衡所隐含的适当的对流、扩散和反应时间尺度，然后计算：\n   - 气相丹姆科勒数 $\\mathrm{Da}_{g}$，其表征了穿过反应性多孔段的对流停留时间与气相化学时间的比值，\n   - 孔尺度下的热佩克莱数 $\\mathrm{Pe}_{T}$，其比较了气体中的对流传热与扩散传热，\n   - 以及气固毕渥数 $\\mathrm{Bi}_{gs}$，其比较了气固界面传热与跨连接体的固相内热传导。\n\n2. 基于 $\\mathrm{Da}_{g}$、$\\mathrm{Pe}_{T}$ 和 $\\mathrm{Bi}_{gs}$ 的量级，简要解释在此工作点下，哪些过程预计将主导火焰稳定、热释放局部化和气固温度耦合，假设在孔尺度上辐射损失相对于传导和界面交换可以忽略不计。\n\n为了评分，请报告一个由下式定义的标量指数\n$$\\Phi \\equiv \\ln\\!\\Big(\\frac{\\mathrm{Da}_{g}\\,\\mathrm{Pe}_{T}}{\\mathrm{Bi}_{gs}}\\Big),$$\n并将您报告的 $\\Phi$ 值四舍五入到四位有效数字。$\\Phi$ 是无量纲的；报告最终值时无需单位。",
            "solution": "我们从守恒定律的时间和长度尺度开始。表征孔隙内对流的间隙速度 $U_{i}$ 可由表观（达西）速度 $U_{s}$ 和孔隙率 $\\varepsilon$ 根据空隙空间内体积通量的连续性得出，\n$$\nU_{i} = \\frac{U_{s}}{\\varepsilon}.\n$$\n当 $U_{s} = 0.20\\,\\mathrm{m\\,s^{-1}}$ 且 $\\varepsilon = 0.70$ 时，我们有\n$$\nU_{i} = \\frac{0.20}{0.70} = \\frac{2}{7}\\,\\mathrm{m\\,s^{-1}}.\n$$\n\n气相丹姆科勒数。从反应物种平衡中，出现了两个相关的时间尺度：\n\n- 穿过厚度为 $L$ 的反应性多孔段的对流停留时间，\n$$\n\\tau_{\\mathrm{flow}} = \\frac{L}{U_{i}},\n$$\n- 以及全局（有效）单步反应的气相化学时间，\n$$\n\\tau_{\\mathrm{chem}} = \\frac{1}{k_{\\mathrm{eff}}},\n$$\n其中 $k_{\\mathrm{eff}}$ 是局部反应区条件下的有效一级反应速率常数。气相丹姆科勒数是以下比值\n$$\n\\mathrm{Da}_{g} = \\frac{\\tau_{\\mathrm{flow}}}{\\tau_{\\mathrm{chem}}}.\n$$\n\n使用 $L = 0.020\\,\\mathrm{m}$，$U_{i} = \\frac{2}{7}\\,\\mathrm{m\\,s^{-1}}$ 和 $k_{\\mathrm{eff}} = 1.20 \\times 10^{3}\\,\\mathrm{s^{-1}}$，\n$$\n\\tau_{\\mathrm{flow}} = \\frac{0.020}{2/7} = 0.020 \\times \\frac{7}{2} = 0.070\\,\\mathrm{s},\n$$\n$$\n\\tau_{\\mathrm{chem}} = \\frac{1}{1.20 \\times 10^{3}} = 8.333\\ldots \\times 10^{-4}\\,\\mathrm{s},\n$$\n因此\n$$\n\\mathrm{Da}_{g} = \\frac{0.070}{8.333\\ldots \\times 10^{-4}} = 0.070 \\times 1.20 \\times 10^{3} = 84.\n$$\n\n孔尺度下的热佩克莱数。从气体的能量平衡出发，比较特征孔隙长度 $L_{c}$ 上的对流时间，\n$$\n\\tau_{\\mathrm{adv},\\,g} = \\frac{L_{c}}{U_{i}},\n$$\n与基于气体热扩散率 $\\alpha_{g}$ 的相同长度上的扩散时间，\n$$\n\\tau_{\\mathrm{diff},\\,g} = \\frac{L_{c}^{2}}{\\alpha_{g}}.\n$$\n那么热佩克莱数是\n$$\n\\mathrm{Pe}_{T} = \\frac{\\tau_{\\mathrm{diff},\\,g}}{\\tau_{\\mathrm{adv},\\,g}} = \\frac{U_{i} L_{c}}{\\alpha_{g}}.\n$$\n当 $L_{c} = 1.0 \\times 10^{-3}\\,\\mathrm{m}$，$U_{i} = \\frac{2}{7}\\,\\mathrm{m\\,s^{-1}}$ 且 $\\alpha_{g} = 2.0 \\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$ 时，\n$$\n\\mathrm{Pe}_{T} = \\frac{(2/7)\\times 1.0 \\times 10^{-3}}{2.0 \\times 10^{-4}} = \\frac{2 \\times 10^{-3}}{7 \\times 2.0 \\times 10^{-4}} = \\frac{2 \\times 10^{-3}}{1.4 \\times 10^{-3}} = \\frac{10}{7} \\approx 1.428571\\ldots.\n$$\n\n气固毕渥数。气固之间的界面传热与特征长度为 $L_s$ 的固体连接体或支柱内的相内热传导相竞争。一个标准的气固毕渥数比较了界面电导 $h_{gs}$ 与固相内跨越 $L_s$ 的传导，\n$$\n\\mathrm{Bi}_{gs} = \\frac{h_{gs} L_{s}}{k_{s}}.\n$$\n当 $h_{gs} = 1.0 \\times 10^{3}\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$L_{s} = 1.0 \\times 10^{-3}\\,\\mathrm{m}$ 且 $k_{s} = 30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$ 时，\n$$\n\\mathrm{Bi}_{gs} = \\frac{1.0 \\times 10^{3} \\times 1.0 \\times 10^{-3}}{30} = \\frac{1}{30} \\approx 3.3333\\ldots \\times 10^{-2}.\n$$\n\n主导物理过程的解释。计算值表明：\n\n- $\\mathrm{Da}_{g} = 84 \\gg 1$：在通过反应性多孔段的对流停留时间尺度上，气相化学反应速度很快，这意味着反应区相对于多孔段长度而言很薄，并且主要受热量和反应物输运的限制。这支持了火焰在基质内的稳定锚定。\n\n- $\\mathrm{Pe}_{T} \\approx 1.43 = \\mathcal{O}(1)$：在孔尺度下，气体中的对流传热和扩散传热相当。这表明对流散热和从热孔隙到冷孔隙的热扩散都显著地影响着局部温度场和火焰厚度。\n\n- $\\mathrm{Bi}_{gs} \\approx 3.33 \\times 10^{-2} \\ll 1$：固相内的相内传导相对于界面传热阻力要强，因此固体连接体在 $L_s$ 长度上内部趋于等温，而气固温差受限于界面交换。这有利于通过固体基质进行有效的热再循环来预热进入的气体。\n\n标量指数。所要求的标量指数是\n$$\n\\Phi \\equiv \\ln\\!\\Big(\\frac{\\mathrm{Da}_{g}\\,\\mathrm{Pe}_{T}}{\\mathrm{Bi}_{gs}}\\Big)\n= \\ln\\!\\Big(\\frac{84 \\times \\frac{10}{7}}{\\frac{1}{30}}\\Big)\n= \\ln\\!\\Big(120 \\times 30\\Big)\n= \\ln(3600).\n$$\n计算自然对数，\n$$\n\\Phi = \\ln(3600) \\approx 8.188689124\\ldots,\n$$\n根据要求四舍五入到四位有效数字，得到\n$$\n\\Phi \\approx 8.189.\n$$",
            "answer": "$$\\boxed{8.189}$$"
        },
        {
            "introduction": "计算科学中的一个核心任务是验证代码是否正确地求解了其所依据的数学模型。本练习介绍了一种强大的验证技术——“制造解方法”(Method of Manufactured Solutions)，用于系统性地测试有限体积离散格式的精度。通过对一个双温度模型的精度阶进行分析，本练习旨在培养学生评估和诊断数值误差来源的关键技能，这是任何计算建模者必备的能力。",
            "id": "4052659",
            "problem": "考虑一个一维、稳态、双温多孔介质能量模型，其无量纲空间域为 $x \\in [0, L]$，且 $L = 1$。令气相温度为 $T_g(x)$，固相温度为 $T_s(x)$，气相有效导热系数为 $k_g(x)$，单位体积的界面面积为 $a(x)$。包含扩散和气固界面热交换的一维气相和固相的控制稳态能量守恒方程为\n$$\n\\frac{d}{dx}\\left(k_g(x)\\frac{dT_g}{dx}\\right) - h\\,a(x)\\left(T_g(x)-T_s(x)\\right) = S_g(x),\n$$\n$$\n\\frac{d}{dx}\\left(k_s(x)\\frac{dT_s}{dx}\\right) + h\\,a(x)\\left(T_g(x)-T_s(x)\\right) = S_s(x),\n$$\n其中 $h$ 是气固界面传热系数，$S_g(x)$ 和 $S_s(x)$ 是源项。边界条件为 Dirichlet 型，其值设为在 $x=0$ 和 $x=L$ 处求值的精确人造解。所有量均为无量纲，三角函数中的任何角度都必须以弧度为单位进行解释。\n\n使用人造解方法 (Method of Manufactured Solutions, MMS) 定义光滑的无量纲函数\n$$\nT_g(x) = \\sin\\left(\\pi x\\right) + 0.1\\cos\\left(2\\pi x\\right), \\quad T_s(x) = \\cos\\left(\\pi x\\right) + 0.05\\sin\\left(3\\pi x\\right),\n$$\n$$\nk_g(x) = 1 + 0.5\\sin\\left(2\\pi x\\right), \\quad k_s(x) = 0.8 + 0.3\\cos\\left(2\\pi x\\right),\n$$\n$$\na(x) = 5\\left(1 + 0.2\\sin\\left(2\\pi x\\right)\\right), \\quad h = 10,\n$$\n并隐式地定义 $S_g(x)$ 和 $S_s(x)$，使得精确的连续方程对 $T_g(x)$ 和 $T_s(x)$ 成立。\n\n您的任务是执行网格加密研究，使用算子的有限体积法 (finite volume method, FVM) 离散，分别测量气相扩散项和界面项的观测精度阶，并诊断精度阶降低的来源。离散化必须按以下方式构建：\n\n- 离散化框架：将域划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀单元，单元中心位于 $x_i = (i + 0.5)\\Delta x$（$i = 0,1,\\dots,N-1$），面位于 $x_{f,j} = j\\Delta x$（$j=0,1,\\dots,N$）。\n\n- 气相扩散算子（有限体积形式）：对于单元 $i$，通过离散的面贡献来近似单元平均扩散算子，\n$$\n\\left[\\frac{d}{dx}\\left(k_g\\frac{dT_g}{dx}\\right)\\right]_i^{\\text{disc}} \\approx \\frac{1}{\\Delta x}\\left(k_{g,\\,i+\\frac{1}{2}}\\,\\frac{T_{g,\\,i+1}-T_{g,\\,i}}{\\Delta x} - k_{g,\\,i-\\frac{1}{2}}\\,\\frac{T_{g,\\,i}-T_{g,\\,i-1}}{\\Delta x}\\right),\n$$\n其中 $k_{g,\\,i\\pm\\frac{1}{2}}$ 是 $k_g(x)$ 在内部面 $x_{f,i\\pm1}$ 上的值。在左边界的面 $x_{f,0}$ 和右边界的面 $x_{f,N}$ 处，使用两种变体施加 Dirichlet 边界条件：\n    1. 变体 A（边界处一致二阶）：使用 $k_{g,\\,\\frac{1}{2}} = k_g(0)$ 和 $k_{g,\\,N+\\frac{1}{2}} = k_g(L)$，以及基于半单元距离的单边梯度，即 $\\left.\\frac{dT_g}{dx}\\right|_{x_{f,0}} \\approx \\frac{T_{g,0}-T_g(0)}{\\Delta x/2}$ 和 $\\left.\\frac{dT_g}{dx}\\right|_{x_{f,N}} \\approx \\frac{T_g(L)-T_{g,N-1}}{\\Delta x/2}$，其中 $T_g(0)$ 和 $T_g(L)$ 来自人造解。\n    2. 变体 B（边界处降为一阶）：使用 $k_{g,\\,\\frac{1}{2}} = k_g(x_0)$ 和 $k_{g,\\,N+\\frac{1}{2}} = k_g(x_{N-1})$，以及基于全单元距离的单边梯度，即 $\\left.\\frac{dT_g}{dx}\\right|_{x_{f,0}} \\approx \\frac{T_{g,0}-T_g(0)}{\\Delta x}$ 和 $\\left.\\frac{dT_g}{dx}\\right|_{x_{f,N}} \\approx \\frac{T_g(L)-T_{g,N-1}}{\\Delta x}$。\n\n- 气相界面算子（有限体积形式）：对于单元 $i$，使用中点法则近似单元平均界面项，\n$$\n\\left[-h\\,a\\left(T_g-T_s\\right)\\right]_i^{\\text{disc}} \\approx -h\\,a(x_i)\\left(T_g(x_i)-T_s(x_i)\\right).\n$$\n\n为了分别评估离散误差：\n- 通过在面 $x_{f,i\\pm1}$ 处求值的 $k_g(x)\\frac{dT_g}{dx}$ 的精确面值来计算精确的单元平均扩散算子\n$$\n\\left[\\frac{d}{dx}\\left(k_g\\frac{dT_g}{dx}\\right)\\right]_i^{\\text{exact}} = \\frac{k_g(x_{f,i+1})\\left.\\frac{dT_g}{dx}\\right|_{x_{f,i+1}} - k_g(x_{f,i})\\left.\\frac{dT_g}{dx}\\right|_{x_{f,i}}}{\\Delta x},\n$$\n使用 $T_g(x)$ 的解析导数。\n\n- 通过精确的单元积分计算精确的单元平均界面算子，\n$$\n\\left[-h\\,a\\left(T_g-T_s\\right)\\right]_i^{\\text{exact}} = -\\frac{h}{\\Delta x}\\int_{x_{f,i}}^{x_{f,i+1}} a(x)\\left[T_g(x)-T_s(x)\\right]\\,dx,\n$$\n该积分必须使用具有足够精度的数值求积法进行计算。\n\n将每个算子的离散误差定义为离散算子与精确算子之间的差值，逐个单元进行评估。通过以下方式计算域上误差的连续 $L^2$ 范数\n$$\n\\|e\\|_{L^2} = \\left(\\int_0^L e(x)^2\\,dx\\right)^{1/2} \\approx \\left(\\sum_{i=0}^{N-1} e_i^2\\,\\Delta x\\right)^{1/2},\n$$\n以及通过以下方式计算 $L^\\infty$ 范数\n$$\n\\|e\\|_{L^\\infty} = \\max_{i} |e_i|.\n$$\n\n使用 $N \\in \\{32,64,128,256\\}$ 进行网格加密研究，并通过对 $\\log(E)$ 与 $\\log(h)$（其中 $E$ 是误差范数，$h=\\Delta x$）使用最小二乘法拟合一条直线来计算每个算子和范数的观测精度阶 $p$：\n$$\np = \\text{对 } \\left\\{ \\left(\\log(h_j),\\,\\log(E_j)\\right) \\right\\} \\text{ 的最佳拟合线的斜率}。\n$$\n\n测试套件：\n- 案例 A：对气相扩散算子和指定的界面算子使用变体 A（一致二阶边界处理）。\n- 案例 B：对气相扩散算子使用变体 B（降为一阶的边界处理），界面算子离散化方式相同。\n\n您的程序必须：\n- 实现上述算子和范数。\n- 对于每个案例（A 和 B），估计并报告四个观测阶数：气相扩散 $L^2$ 阶、气相扩散 $L^\\infty$ 阶、界面 $L^2$ 阶、界面 $L^\\infty$ 阶。\n- 通过比较案例 A 和案例 B 并观察气相扩散 $L^\\infty$ 阶的差异来诊断精度阶降低的来源。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按以下顺序排列的八个观测阶数，形式为方括号内由逗号分隔的列表：\n$$\n[\\text{diff\\_A\\_L2},\\text{diff\\_A\\_Linf},\\text{int\\_A\\_L2},\\text{int\\_A\\_Linf},\\text{diff\\_B\\_L2},\\text{diff\\_B\\_Linf},\\text{int\\_B\\_L2},\\text{int\\_B\\_Linf}],\n$$\n其中每个条目都是一个浮点数。所有量均为无量纲，三角函数必须以弧度为单位解释。除此单行外，不应打印任何其他文本。",
            "solution": "问题陈述经评估有效。它描述了一个基于计算物理学和人造解方法 (MMS) 的既定原则的适定数值分析任务。所有函数、方程和数值方案都得到了清晰而严格的定义，构成了一个自洽且科学上合理的问题。\n\n该任务是为一个一维双温多孔介质能量模型的有限体积离散化执行网格加密研究。该研究旨在确定气相扩散和界面热交换算子的观测精度阶。这是计算代码开发中的标准验证程序。\n\n解决方案按以下步骤进行：\n\n1.  **定义解析函数**：将气相和固相温度的人造解 $T_g(x)$ 和 $T_s(x)$ 以及空间变化的系数 $k_g(x)$ 和 $a(x)$ 定义为光滑的连续函数。还计算了气相温度的解析导数 $\\frac{dT_g}{dx}$，用于误差计算。\n    $$\n    T_g(x) = \\sin(\\pi x) + 0.1\\cos(2\\pi x) \\implies \\frac{dT_g}{dx} = \\pi\\cos(\\pi x) - 0.2\\pi\\sin(2\\pi x)\n    $$\n\n2.  **离散化域**：在域 $x \\in [0, 1]$ 上建立一个包含 $N$ 个单元的均匀网格，每个单元的宽度为 $\\Delta x = 1/N$。单元中心位于 $x_i = (i + 0.5)\\Delta x$，面位于 $x_{f,j} = j \\Delta x$。\n\n3.  **计算离散误差**：对于每个算子（扩散和界面），离散误差计算为离散算子与精确单元平均算子之间的差值，即 $e_i = (\\text{Op}^{\\text{disc}})_i - (\\text{Op}^{\\text{exact}})_i$。\n\n    *   **气相扩散算子**：\n        离散算子以有限体积形式表示为数值通量的散度，$(\\text{Op}^{\\text{disc}})_i = (F_{i+1} - F_i)/\\Delta x$。\n        对于单元 $j-1$ 和 $j$ 之间的内部面 $j$，通量使用中心差分进行近似：$F_j \\approx k_g(x_{f,j}) \\frac{T_{g,j} - T_{g,j-1}}{\\Delta x}$，其中 $T_{g,k}$ 是在单元 $k$ 中心处求值的精确解。\n        在域边界（$x=0$ 和 $x=1$）处施加 Dirichlet 条件。\n        *   **变体 A（一致二阶 BC）**：边界通量使用在半单元距离 $(\\Delta x/2)$ 上求值的二阶精确单边梯度。例如，在 $x=0$ 处，通量为 $F_0 = k_g(0) \\frac{T_{g,0} - T_g(0)}{\\Delta x/2}$。这保持了内部格式的二阶精度。\n        *   **变体 B（降为一阶 BC）**：边界通量使用在全单元距离 $(\\Delta x)$ 上的一个一阶精确梯度，并在相邻单元中心处求值导热系数。在 $x=0$ 处，$F_0 = k_g(x_0) \\frac{T_{g,0} - T_g(0)}{\\Delta x}$。这在边界处引入了一个局部一阶误差。\n        精确的单元平均扩散算子使用微积分基本定理计算：$(\\text{Op}^{\\text{exact}})_i = \\frac{1}{\\Delta x} \\left( \\left[k_g\\frac{dT_g}{dx}\\right]_{x_{f,i+1}} - \\left[k_g\\frac{dT_g}{dx}\\right]_{x_{f,i}} \\right)$，使用 $\\frac{dT_g}{dx}$ 的解析表达式。\n\n    *   **气相界面算子**：\n        离散算子通过用单元中心处的值（中点法则）来近似单元平均值得到：$(\\text{Op}^{\\text{disc}})_i = -h\\,a(x_i)\\,(T_g(x_i) - T_s(x_i))$。对于光滑函数，这是一个二阶精确的近似。\n        精确的单元平均算子需要将该项在单元宽度上积分：$(\\text{Op}^{\\text{exact}})_i = \\frac{1}{\\Delta x}\\int_{x_{f,i}}^{x_{f,i+1}} -h\\,a(x)(T_g(x) - T_s(x))\\,dx$。该积分使用高精度数值求积法（`scipy.integrate.quad`）计算。\n\n4.  **网格加密与精度阶**：对一系列加密网格（$N \\in \\{32, 64, 128, 256\\}$）计算误差。对每个网格计算误差向量的 $L^2$ 和 $L^\\infty$ 范数。观测精度阶 $p$ 由拟合误差范数与网格间距的对数-对数图的最小二乘直线的斜率确定，即 $p = \\log(E) \\text{ vs. } \\log(\\Delta x) \\text{ 的斜率}$。\n\n5.  **精度阶降低的诊断**：\n    *   对于案例 A 中的界面项和扩散项，所有近似都是一致二阶的。因此，预计 $L^2$ 和 $L^\\infty$ 范数都将以 $p \\approx 2.0$ 收敛。\n    *   在案例 B 中，扩散算子在边界处存在一阶误差。$L^\\infty$ 范数测量最大误差，该误差将由这个 $O(\\Delta x)$ 的边界误差主导，从而产生约 $p \\approx 1.0$ 的观测阶。$L^2$ 范数对平方误差进行积分，因此不太敏感。一个局限于固定数量单元的 $O(\\Delta x)$ 误差对误差平方和的贡献为 $O((\\Delta x)^2 \\Delta x) = O(\\Delta x^3)$，而内部的 $O(\\Delta x^2)$ 误差贡献为 $O(N (\\Delta x^2)^2 \\Delta x ) = O(\\Delta x^4)$。边界项占主导地位，导致 $L^2$ 误差范数为 $\\sqrt{O(\\Delta x^3)} = O(\\Delta x^{1.5})$。因此，我们预期案例 B 中 $L^2$ 范数的 $p \\approx 1.5$。该分析指出了不一致的边界处理是精度阶降低的根源。\n\n以下 Python 程序实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Performs a grid refinement study for a 1D FVM discretization of a\n    two-temperature porous media energy model using the Method of Manufactured Solutions.\n    \"\"\"\n    \n    # --- Problem Definition ---\n    L = 1.0\n    h = 10.0\n    N_list = np.array([32, 64, 128, 256])\n    dx_list = L / N_list\n\n    # --- Manufactured Solution and Coefficient Functions ---\n    def Tg(x):\n        return np.sin(np.pi * x) + 0.1 * np.cos(2 * np.pi * x)\n\n    def Ts(x):\n        return np.cos(np.pi * x) + 0.05 * np.sin(3 * np.pi * x)\n\n    def d_Tg_dx(x):\n        return np.pi * np.cos(np.pi * x) - 0.2 * np.pi * np.sin(2 * np.pi * x)\n\n    def kg(x):\n        return 1.0 + 0.5 * np.sin(2 * np.pi * x)\n\n    def a(x):\n        return 5.0 * (1.0 + 0.2 * np.sin(2 * np.pi * x))\n\n    def get_order(dx_values, error_values):\n        \"\"\"Calculate order of accuracy using log-log linear regression.\"\"\"\n        log_dx = np.log(dx_values)\n        log_err = np.log(error_values)\n        # The slope of the line is the order of accuracy\n        p, _ = np.polyfit(log_dx, log_err, 1)\n        return p\n\n    def calculate_errors(N, variant):\n        \"\"\"\n        Calculates discretization errors for diffusion and interfacial operators\n        for a given grid size N and boundary condition variant.\n        \"\"\"\n        dx = L / N\n        x_centers = (np.arange(N) + 0.5) * dx\n        x_faces = np.arange(N + 1) * dx\n\n        # Evaluate exact solutions and coefficients at grid points\n        Tg_centers = Tg(x_centers)\n        Ts_centers = Ts(x_centers)\n        a_centers = a(x_centers)\n        kg_at_faces = kg(x_faces)\n        \n        # --- 1. Gas-Phase Diffusion Operator Error ---\n        \n        # 1a. Compute the discrete operator\n        diff_op_disc = np.zeros(N)\n        \n        # Fluxes at interior faces (j=1, ..., N-1)\n        flux_interior = kg_at_faces[1:-1] * (Tg_centers[1:] - Tg_centers[:-1]) / dx\n        \n        # Fluxes at boundary faces (j=0 and j=N) based on the variant\n        if variant == 'A':  # 2nd order consistent BC\n            flux_L = kg(0.0) * (Tg_centers[0] - Tg(0.0)) / (dx / 2.0)\n            flux_R = kg(L)   * (Tg(L) - Tg_centers[-1]) / (dx / 2.0)\n        elif variant == 'B':  # 1st order degraded BC\n            flux_L = kg(x_centers[0]) * (Tg_centers[0] - Tg(0.0)) / dx\n            flux_R = kg(x_centers[-1]) * (Tg(L) - Tg_centers[-1]) / dx\n        else:\n            raise ValueError(\"Invalid variant specified.\")\n\n        # Assemble the discrete operator for each cell\n        # Cell 0: (flux_at_face_1 - flux_at_face_0) / dx\n        diff_op_disc[0] = (flux_interior[0] - flux_L) / dx\n        # Interior cells 1 to N-2\n        if N > 2:\n            diff_op_disc[1:-1] = (flux_interior[1:] - flux_interior[:-1]) / dx\n        # Cell N-1: (flux_at_face_N - flux_at_face_{N-1}) / dx\n        diff_op_disc[-1] = (flux_R - flux_interior[-1]) / dx\n        \n        # 1b. Compute the exact cell-averaged operator\n        exact_flux_at_faces = kg_at_faces * d_Tg_dx(x_faces)\n        diff_op_exact = (exact_flux_at_faces[1:] - exact_flux_at_faces[:-1]) / dx\n        \n        # 1c. Compute diffusion error and norms\n        diff_error = diff_op_disc - diff_op_exact\n        diff_l2_norm = np.sqrt(np.sum(diff_error**2 * dx))\n        diff_linf_norm = np.max(np.abs(diff_error))\n\n        # --- 2. Gas-Phase Interfacial Operator Error ---\n        \n        # 2a. Compute the discrete operator (Midpoint Rule)\n        int_op_disc = -h * a_centers * (Tg_centers - Ts_centers)\n\n        # 2b. Compute the exact cell-averaged operator (Numerical Quadrature)\n        int_op_exact = np.zeros(N)\n        integrand = lambda x: -h * a(x) * (Tg(x) - Ts(x))\n        for i in range(N):\n            integral_val, _ = integrate.quad(integrand, x_faces[i], x_faces[i+1], epsabs=1e-14, epsrel=1e-14)\n            int_op_exact[i] = integral_val / dx\n\n        # 2c. Compute interfacial error and norms\n        int_error = int_op_disc - int_op_exact\n        int_l2_norm = np.sqrt(np.sum(int_error**2 * dx))\n        int_linf_norm = np.max(np.abs(int_error))\n\n        return diff_l2_norm, diff_linf_norm, int_l2_norm, int_linf_norm\n\n    # --- Main Calculation Loop ---\n    final_orders = []\n    \n    # Loop over Test Cases A and B\n    for variant in ['A', 'B']:\n        errors = {'diff_l2': [], 'diff_linf': [], 'int_l2': [], 'int_linf': []}\n        \n        # Loop over grid refinements\n        for N in N_list:\n            d_l2, d_linf, i_l2, i_linf = calculate_errors(N, variant)\n            errors['diff_l2'].append(d_l2)\n            errors['diff_linf'].append(d_linf)\n            errors['int_l2'].append(i_l2)\n            errors['int_linf'].append(i_linf)\n        \n        # Calculate orders of accuracy for the current case\n        order_diff_l2 = get_order(dx_list, errors['diff_l2'])\n        order_diff_linf = get_order(dx_list, errors['diff_linf'])\n        order_int_l2 = get_order(dx_list, errors['int_l2'])\n        order_int_linf = get_order(dx_list, errors['int_linf'])\n        \n        final_orders.extend([order_diff_l2, order_diff_linf, order_int_l2, order_int_linf])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_orders))}]\")\n\nsolve()\n```"
        }
    ]
}