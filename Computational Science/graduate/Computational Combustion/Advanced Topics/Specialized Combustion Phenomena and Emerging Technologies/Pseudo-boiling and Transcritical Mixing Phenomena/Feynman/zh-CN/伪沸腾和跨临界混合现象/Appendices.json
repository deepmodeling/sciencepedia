{
    "hands_on_practices": [
        {
            "introduction": "在许多简化的燃烧模型中，为了计算方便，通常假设流体的比热容 $c_p$ 是一个常数。然而，当流体经历跨临界转变时，其比热容会在伪沸腾温度附近出现急剧的峰值。本练习旨在通过一个直接的计算来量化恒定 $c_p$ 假设所带来的误差 ，让你亲身体会到在模拟跨临界现象时，精确描述热物理性质的必要性。",
            "id": "4055374",
            "problem": "考虑一个用于跨临界混合计算燃烧模拟的一维对冲火焰面，其中当温度穿过伪沸腾温度 $T_{pb}$ 时，超临界氧化剂经历伪沸腾。假设材料元的局部热力学路径是等压和单相的，并且在此路径上成分的变化对于评估定压比热 $c_p(T)$ 而言可以忽略不计。根据等压流体元的热力学第一定律，微分热量增加满足 $dq = c_p(T)\\,dT$，因此从温度 $T_i$ 变化到 $T_f$ 过程中的净比焓增量为 $\\int_{T_i}^{T_f} c_p(T)\\,dT$。\n\n为了模拟伪沸腾，将比热取为基准值与一个以 $T_{pb}$ 为中心的局部峰值的和：\n$$\nc_p(T) = c_{p,b} + A\\,\\exp\\!\\left(-\\frac{(T - T_{pb})^2}{2\\,\\sigma^2}\\right),\n$$\n其中 $c_{p,b} = 5.0\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$A = 10.0\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$T_{pb} = 600\\ \\mathrm{K}$，且 $\\sigma = 10.0\\ \\mathrm{K}$。材料元在 $T_i = 540\\ \\mathrm{K}$ 时进入反应区，并沿着火焰面经历净比热释放 $\\hat{Q} = 1000\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}$。\n\n考虑两种火焰面封闭模型：\n- 恒定$c_p$封闭模型，其预测的温升为 $\\Delta T_c = \\hat{Q}/c_{p,b}$。\n- 可变$c_p$封闭模型，其通过求解 $\\hat{Q} = \\int_{T_i}^{T_i+\\Delta T_v} c_p(T)\\,dT$ 来预测温升 $\\Delta T_v$。\n\n将由恒定$c_p$假设引起的温升相对误差定义为\n$$\nE = \\frac{\\Delta T_c - \\Delta T_v}{\\Delta T_v}.\n$$\n\n计算给定参数下的 $E$ 值。将最终答案表示为无量纲小数，并四舍五入到四位有效数字。最终答案中不允许使用百分号。",
            "solution": "问题陈述经评估是有效的。它以热力学原理为科学基础，特别是等压过程的热力学第一定律。比热$c_p(T)$的模型是一个定义明确的数学函数，以简化但合理的方式表示了一个物理现象（伪沸腾）。所有参数都已给出，使得问题自洽且适定。待计算的量已明确定义。\n\n主要任务是计算定义如下的相对误差$E$：\n$$\nE = \\frac{\\Delta T_c - \\Delta T_v}{\\Delta T_v}\n$$\n这需要计算两个量：$\\Delta T_c$，即基于恒定比热的温升，以及 $\\Delta T_v$，即基于可变比热的温升。\n\n首先，我们计算恒定$c_p$封闭模型下的$\\Delta T_c$。\n温升 $\\Delta T_c$ 由 $\\Delta T_c = \\hat{Q}/c_{p,b}$ 定义。给定净比热释放 $\\hat{Q} = 1000\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}$ 和基准定压比热 $c_{p,b} = 5.0\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，我们得到：\n$$\n\\Delta T_c = \\frac{1000}{5.0} = 200\\ \\mathrm{K}\n$$\n\n接下来，我们计算可变$c_p$封闭模型下的$\\Delta T_v$。\n该温升由以下积分方程定义：\n$$\n\\hat{Q} = \\int_{T_i}^{T_f} c_p(T)\\,dT\n$$\n其中最终温度为 $T_f = T_i + \\Delta T_v$。\n代入给定的$c_p(T)$表达式：\n$$\n\\hat{Q} = \\int_{T_i}^{T_i+\\Delta T_v} \\left[ c_{p,b} + A\\,\\exp\\left(-\\frac{(T - T_{pb})^2}{2\\,\\sigma^2}\\right) \\right] dT\n$$\n我们可以将积分分成两部分：\n$$\n\\hat{Q} = \\int_{T_i}^{T_i+\\Delta T_v} c_{p,b}\\,dT + \\int_{T_i}^{T_i+\\Delta T_v} A\\,\\exp\\left(-\\frac{(T - T_{pb})^2}{2\\,\\sigma^2}\\right) dT\n$$\n第一个积分很简单：\n$$\n\\int_{T_i}^{T_i+\\Delta T_v} c_{p,b}\\,dT = c_{p,b} \\left[ (T_i+\\Delta T_v) - T_i \\right] = c_{p,b}\\Delta T_v\n$$\n第二个积分涉及高斯函数。为了计算它，我们使用误差函数$\\mathrm{erf}(x)$，其定义为$\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}}\\int_0^x \\exp(-z^2)\\,dz$。\n我们对第二个积分进行变量替换。令$u = \\frac{T - T_{pb}}{\\sqrt{2}\\sigma}$。这意味着$dT = \\sqrt{2}\\sigma\\,du$。积分上下限变为$u_i = \\frac{T_i - T_{pb}}{\\sqrt{2}\\sigma}$和$u_f = \\frac{T_i+\\Delta T_v - T_{pb}}{\\sqrt{2}\\sigma}$。\n积分变为：\n$$\n\\int_{u_i}^{u_f} A\\,\\exp(-u^2) (\\sqrt{2}\\sigma\\,du) = A\\sigma\\sqrt{2} \\int_{u_i}^{u_f} \\exp(-u^2)\\,du\n$$\n由于$\\int \\exp(-u^2)\\,du = \\frac{\\sqrt{\\pi}}{2}\\mathrm{erf}(u)$，该定积分为：\n$$\nA\\sigma\\sqrt{2} \\left[ \\frac{\\sqrt{\\pi}}{2}\\mathrm{erf}(u) \\right]_{u_i}^{u_f} = A\\sigma\\sqrt{\\frac{\\pi}{2}} \\left( \\mathrm{erf}(u_f) - \\mathrm{erf}(u_i) \\right)\n$$\n将此结果代回$\\hat{Q}$的方程，我们得到一个关于$\\Delta T_v$的超越方程：\n$$\n\\hat{Q} = c_{p,b}\\Delta T_v + A\\sigma\\sqrt{\\frac{\\pi}{2}}\\left[\\mathrm{erf}\\left(\\frac{T_i+\\Delta T_v-T_{pb}}{\\sqrt{2}\\sigma}\\right) - \\mathrm{erf}\\left(\\frac{T_i-T_{pb}}{\\sqrt{2}\\sigma}\\right)\\right]\n$$\n现在，我们代入给定的数值：$\\hat{Q}=1000$，$c_{p,b}=5.0$，$A=10.0$，$\\sigma=10.0$，$T_{pb}=600$，以及$T_i=540$。所有单位都是一致的，因此我们直接使用数值进行计算。\n$$\n1000 = 5.0\\,\\Delta T_v + (10.0)(10.0)\\sqrt{\\frac{\\pi}{2}}\\left[\\mathrm{erf}\\left(\\frac{540+\\Delta T_v-600}{10.0\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{540-600}{10.0\\sqrt{2}}\\right)\\right]\n$$\n简化各项：\n$$\n1000 = 5.0\\,\\Delta T_v + 100\\sqrt{\\frac{\\pi}{2}}\\left[\\mathrm{erf}\\left(\\frac{\\Delta T_v-60}{10\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{-60}{10\\sqrt{2}}\\right)\\right]\n$$\n第二个误差函数的自变量是$\\frac{-6}{\\sqrt{2}} = -3\\sqrt{2} \\approx -4.24264$。\n常数乘子是$100\\sqrt{\\frac{\\pi}{2}} \\approx 125.331$。\n利用性质$\\mathrm{erf}(-x) = -\\mathrm{erf}(x)$，方程变为：\n$$\n1000 = 5.0\\,\\Delta T_v + 125.331\\left[\\mathrm{erf}\\left(\\frac{\\Delta T_v-60}{14.1421}\\right) + \\mathrm{erf}(4.24264)\\right]\n$$\n这个方程必须通过数值方法求解$\\Delta T_v$。\n$\\mathrm{erf}(4.24264)$的值极度接近1；具体来说，$\\mathrm{erf}(4.24264) \\approx 0.999999977$。\n由于$\\Delta T_c = 200\\ \\mathrm{K}$，我们预计$\\Delta T_v$将小于$200\\ \\mathrm{K}$。如果$\\Delta T_v$足够大，例如$\\Delta T_v > 100\\ \\mathrm{K}$，那么最终温度$T_f = T_i + \\Delta T_v > 640\\ \\mathrm{K}$。这个从$T_i=540\\ \\mathrm{K}$到超过$640\\ \\mathrm{K}$的温度范围，完全覆盖了中心在$T_{pb}=600\\ \\mathrm{K}$、宽度为$\\sigma=10.0\\ \\mathrm{K}$的高斯峰。因此，第一个误差函数的自变量$(\\Delta T_v-60)/(10\\sqrt{2})$也将很大，使其值非常接近1。\n高斯项的积分可以近似为其在无限定义域上的值，即$A\\sigma\\sqrt{2\\pi}$。\n$$\n\\int_{T_i}^{T_i+\\Delta T_v} A\\,\\exp(...) \\approx \\int_{-\\infty}^{\\infty} A\\,\\exp(...) = A\\sigma\\sqrt{2\\pi} = (10.0)(10.0)\\sqrt{2\\pi} \\approx 250.663\\ \\mathrm{kJ/kg}\n$$\n使用这个高精度的近似，$\\Delta T_v$的方程简化为：\n$$\n1000 \\approx 5.0\\,\\Delta T_v + 250.663\n$$\n求解$\\Delta T_v$：\n$$\n5.0\\,\\Delta T_v \\approx 1000 - 250.663 = 749.337\n$$\n$$\n\\Delta T_v \\approx \\frac{749.337}{5.0} = 149.8674\\ \\mathrm{K}\n$$\n对超越方程的完整数值求解以高精度证实了此值。\n\n最后，我们计算相对误差$E$：\n$$\nE = \\frac{\\Delta T_c - \\Delta T_v}{\\Delta T_v} = \\frac{200 - 149.8674}{149.8674} = \\frac{50.1326}{149.8674} \\approx 0.334526\n$$\n题目要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$\nE \\approx 0.3345\n$$",
            "answer": "$$\n\\boxed{0.3345}\n$$"
        },
        {
            "introduction": "在先进的燃烧模型（如火焰面模型）中，复杂的化学热力学过程通常被预先计算并以状态关系表的形式存储，例如温度-混合物分数-压力关系 $T(Z, p)$。这个练习将指导你如何从一个给定的、能够捕捉伪沸腾现象的比热容解析模型出发，构建这样一个状态关系 。此过程涉及数值积分和查表反演，这些都是该领域核心的计算技能。",
            "id": "4055428",
            "problem": "要求您为非反应性、单组分跨临界射流形式化混合分数的定义，并构建一个数值可逆的热化学状态关系，该关系将混合分数映射到指定压力下的温度。然后，您必须在一个完全确定性的程序中实现该计算，为指定的测试套件评估此状态关系。\n\n考虑一股非反应性、单组分的流体跨临界射流，注入到更热的环境中。假设定压混合，并忽略混合热和压缩功。设压力用 $p$ 表示，温度用 $T$ 表示，定压比热容用 $c_{p}$ 表示，比焓用 $h$ 表示。\n\n使用的基本依据：\n- 两股流混合的质量守恒意味着任何被动输运的量都存在一个守恒标量。定义两股流混合分数 $Z$，使得任何守恒标量 $\\phi$ 都满足 $\\phi(Z)=Z\\,\\phi_{\\mathrm{jet}}+\\left(1-Z\\right)\\phi_{\\mathrm{env}}$，其中下标分别表示射流流股和环境流股中的值。\n- 在恒定压力下，比焓满足 $h(T,p)=h(T_{\\mathrm{ref}},p)+\\int_{T_{\\mathrm{ref}}}^{T} c_{p}(T',p)\\,dT'$，其中 $T_{\\mathrm{ref}}$ 是任意参考温度，且 $c_{p}(T,p)>0$。\n- 伪沸腾表现为 $c_{p}(T,p)$ 在临界点上方的类 Widom 线 $T_{\\mathrm{w}}(p)$ 附近出现一个峰值，导致 $h(T,p)$ 在 $T_{\\mathrm{w}}(p)$ 附近随 $T$ 急剧变化，但对 $T$ 仍保持严格单调。\n\n用于真实流体表的模型和数值构建：\n- 使用一个比热容的解析模型，该模型在一个基线上叠加一个高斯峰，\n$$\nc_{p}(T,p)=c_{p,0}+A(p)\\,\\exp\\!\\left(-\\dfrac{\\left(T-T_{\\mathrm{w}}(p)\\right)^{2}}{2\\,\\sigma^{2}}\\right),\n$$\n其中 $c_{p,0}>0$，峰值振幅 $A(p)>0$，宽度 $\\sigma>0$，类 Widom 温度 $T_{\\mathrm{w}}(p)$ 由下式给出\n$$\nT_{\\mathrm{w}}(p)=T_{\\mathrm{c}}+a\\,\\ln\\!\\left(\\dfrac{p}{p_{\\mathrm{c}}}\\right),\n\\quad\nA(p)=A_{0}\\,\\exp\\!\\left(-\\left(\\dfrac{\\ln\\!\\left(p/p_{\\mathrm{c}}\\right)}{b}\\right)^{2}\\right).\n$$\n- 使用以下常数（代表一种类氧流体）：\n$T_{\\mathrm{c}}=154.6\\,\\mathrm{K}$，$p_{\\mathrm{c}}=5.043\\times 10^{6}\\,\\mathrm{Pa}$，$c_{p,0}=1200\\,\\mathrm{J}\\cdot\\mathrm{kg}^{-1}\\cdot\\mathrm{K}^{-1}$，$A_{0}=20000\\,\\mathrm{J}\\cdot\\mathrm{kg}^{-1}\\cdot\\mathrm{K}^{-1}$，$\\sigma=6\\,\\mathrm{K}$，$a=35\\,\\mathrm{K}$，$b=1.0$。\n- 在从 $T_{\\min}=80\\,\\mathrm{K}$ 到 $T_{\\max}=400\\,\\mathrm{K}$ 的均匀网格上建立一个温度表 $T_{i}$，并从 $h(T_{\\min},p)=0$ 开始使用数值积分法制表 $h(T_{i},p)$。\n\n混合分数和状态关系的定义：\n- 将两股流混合分数 $Z$ 定义为恒定压力下比焓的守恒标量插值，\n$$\nh_{\\mathrm{mix}}(Z,p)=Z\\,h\\!\\left(T_{\\mathrm{jet}},p\\right)+\\left(1-Z\\right)\\,h\\!\\left(T_{\\mathrm{env}},p\\right).\n$$\n- 将热化学状态关系 $T(Z,p)$ 定义为求解下式的唯一温度\n$$\nh\\!\\left(T(Z,p),p\\right)=h_{\\mathrm{mix}}(Z,p),\n$$\n其中 $T(Z,p)\\in[T_{\\min},T_{\\max}]$。因为 $c_{p}(T,p)>0$，$h(T,p)$ 是 $T$ 的严格递增函数，所以对于 $h_{\\mathrm{mix}}(Z,p)\\in[h(T_{\\min},p),h(T_{\\max},p)]$，$T(Z,p)$ 存在且唯一。\n\n程序要求：\n- 实现 $c_{p}(T,p)$ 模型的构建、通过数值积分构建焓表 $h(T,p)$，以及通过查表反演从 $h_{\\mathrm{mix}}(Z,p)$ 获得 $T(Z,p)$ 的反演程序。\n- 使用 $T_{\\mathrm{jet}}=120\\,\\mathrm{K}$ 和 $T_{\\mathrm{env}}=300\\,\\mathrm{K}$。所有温度必须以开尔文表示和返回。所有压力必须以帕斯卡为单位。\n- 最终答案必须是温度 $T(Z,p)$，单位为开尔文，四舍五入到一位小数。\n\n测试套件：\n为以下有序的案例列表评估 $T(Z,p)$，每个案例指定为 $(p,Z)$，其中 $p$ 的单位是帕斯卡，$Z$ 是无量纲的：\n$1.$ $(5.5\\times 10^{6},\\,0.0)$，\n$2.$ $(5.5\\times 10^{6},\\,1.0)$，\n$3.$ $(5.5\\times 10^{6},\\,0.5)$，\n$4.$ $(1.0\\times 10^{7},\\,0.5)$，\n$5.$ $(2.0\\times 10^{7},\\,0.5)$，\n$6.$ $(5.5\\times 10^{6},\\,0.2)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与测试套件相同，例如格式为 $[T_{1},T_{2},T_{3},T_{4},T_{5},T_{6}]$，其中每个 $T_{k}$ 是一个以开尔文为单位的浮点数，四舍五入到一位小数。",
            "solution": "该问题是有效的，因为它在科学上基于热力学和流体力学，是适定的、客观的，并为形式解提供了一套完整的定义、模型和数据。任务是计算非反应性、单组分跨临界射流中温度 $T$ 作为混合分数 $Z$ 和压力 $p$ 的函数。这种关系 $T(Z,p)$ 被称为热化学状态关系。\n\n解决方案通过遵循问题陈述中概述的步骤构建，这涉及对流体的热物理性质进行建模，然后使用守恒原理来确定混合物的状态。\n\n首先，我们使用提供的解析模型定义组分的定压比热容 $c_p(T,p)$：\n$$\nc_{p}(T,p) = c_{p,0} + A(p)\\,\\exp\\!\\left(-\\dfrac{\\left(T-T_{\\mathrm{w}}(p)\\right)^{2}}{2\\,\\sigma^{2}}\\right)\n$$\n该模型由一个恒定的基线比热容 $c_{p,0}$ 和一个高斯函数组成，用以表示在 Widom 线附近热容的急剧增加，这是超临界流体中伪沸腾的典型现象。依赖于压力的峰值振幅 $A(p)$ 和峰值温度 $T_{\\mathrm{w}}(p)$ 由下式给出：\n$$\nA(p) = A_{0}\\,\\exp\\!\\left(-\\left(\\dfrac{\\ln\\!\\left(p/p_{\\mathrm{c}}\\right)}{b}\\right)^{2}\\right)\n$$\n$$\nT_{\\mathrm{w}}(p) = T_{\\mathrm{c}} + a\\,\\ln\\!\\left(\\dfrac{p}{p_{\\mathrm{c}}}\\right)\n$$\n所有常数（$T_{\\mathrm{c}}$、$p_{\\mathrm{c}}$、$c_{p,0}$、$A_{0}$、$\\sigma$、$a$、$b$）均已提供。\n\n其次，我们从比热容确定比焓 $h(T,p)$。对于定压过程，比焓的变化是比热容的积分：\n$$\nh(T,p) = h(T_{\\mathrm{ref}},p) + \\int_{T_{\\mathrm{ref}}}^{T} c_{p}(T',p)\\,dT'\n$$\n问题指定参考状态为 $h(T_{\\min},p)=0$，其中 $T_{\\min}=80\\,\\mathrm{K}$。因此，我们有 $T_{\\mathrm{ref}}=T_{\\min}$ 且：\n$$\nh(T,p) = \\int_{T_{\\min}}^{T} c_{p}(T',p)\\,dT'\n$$\n该积分通过数值方法计算。我们在区间 $[T_{\\min}, T_{\\max}] = [80\\,\\mathrm{K}, 400\\,\\mathrm{K}]$ 上建立一个精细、均匀的温度网格。对于给定的压力 $p$，在该网格的每个点上计算函数 $c_p(T,p)$。然后，使用数值积分方法，特别是累积实现的梯形法则，计算每个网格点上的焓 $h(T,p)$。这样就创建了一个在恒定 $p$ 下 $h$ 作为 $T$ 的函数的离散表。对于此实现，`scipy.integrate.cumulative_trapezoid` 函数非常适用。\n\n第三，我们使用混合分数 $Z$ 的定义。问题指出 $Z$ 是一个守恒标量，并且在给定假设下进行两股流混合时，比焓也是一个守恒标量。因此，混合物的比焓 $h_{\\mathrm{mix}}$ 是两个流股（射流和环境）焓的线性插值：\n$$\nh_{\\mathrm{mix}}(Z,p) = Z\\,h_{\\mathrm{jet}} + \\left(1-Z\\right)\\,h_{\\mathrm{env}}\n$$\n其中 $h_{\\mathrm{jet}} = h(T_{\\mathrm{jet}}, p)$ 和 $h_{\\mathrm{env}} = h(T_{\\mathrm{env}}, p)$，且 $T_{\\mathrm{jet}}=120\\,\\mathrm{K}$ 和 $T_{\\mathrm{env}}=300\\,\\mathrm{K}$。$h_{\\mathrm{jet}}$ 和 $h_{\\mathrm{env}}$ 的值通过在预先计算的焓表中对其各自的温度进行插值得到。\n\n最后，通过反演函数 $h(T,p)$ 来找到状态关系 $T(Z,p)$。我们寻求满足以下方程的温度 $T$：\n$$\nh(T, p) = h_{\\mathrm{mix}}(Z,p)\n$$\n由于比热容 $c_p(T,p)$ 对所有 $T$ 和 $p$ 都是严格为正的，因此比焓 $h(T,p)$ 是 $T$ 的严格单调递增函数。这保证了唯一的反函数 $T(h,p)$ 存在。在计算上，这个反演过程作为反向查表来执行。我们对生成的表使用线性插值，但以焓为自变量，温度为因变量，来找到与计算出的 $h_{\\mathrm{mix}}(Z,p)$ 相对应的温度。\n\n对于每个测试案例 $(p, Z)$ 的总体算法如下：\n1.  对于给定的压力 $p$，在精细的温度网格 $T_i \\in [80\\,\\mathrm{K}, 400\\,\\mathrm{K}]$ 上生成一个 $c_{p}(T_i, p)$ 的表。\n2.  对 $c_p$ 表进行数值积分，以生成相应的焓表 $h(T_i, p)$。\n3.  在 $h(T_i, p)$ 表上使用线性插值，以找到比焓 $h(T_{\\mathrm{jet}}, p)$ 和 $h(T_{\\mathrm{env}}, p)$。\n4.  使用混合分数规则计算混合焓 $h_{\\mathrm{mix}}(Z, p)$。\n5.  通过对制表数据使用线性插值来反演函数 $h(T,p)$，以找到与 $h_{\\mathrm{mix}}(Z,p)$ 对应的温度 $T$。\n6.  按要求将所得温度四舍五入到一位小数。\n\n此过程是确定性的，并直接实现了问题陈述中指定的物理过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Computes the temperature T(Z, p) for a transcritical jet\n    based on a thermochemical state relation.\n    \"\"\"\n    \n    # Define physical and model constants\n    T_c = 154.6  # K\n    p_c = 5.043e6  # Pa\n    c_p0 = 1200.0  # J/kg/K\n    A0 = 20000.0  # J/kg/K\n    sigma = 6.0  # K\n    a = 35.0  # K\n    b = 1.0\n\n    # Define problem conditions\n    T_min = 80.0  # K\n    T_max = 400.0  # K\n    T_jet = 120.0  # K\n    T_env = 300.0  # K\n    N_points = 10001 # Number of points for numerical tables\n\n    # Define the temperature grid for tabulation\n    T_grid = np.linspace(T_min, T_max, N_points)\n\n    def get_T_from_Z_p(p, Z):\n        \"\"\"\n        Calculates T(Z,p) by building and inverting the state relation.\n        \n        Args:\n            p (float): Pressure in Pascal.\n            Z (float): Mixture fraction (dimensionless).\n        \n        Returns:\n            float: Temperature in Kelvin.\n        \"\"\"\n        # 1. Calculate pressure-dependent model parameters\n        log_pr = np.log(p / p_c)\n        T_w = T_c + a * log_pr\n        A = A0 * np.exp(-((log_pr / b)**2))\n\n        # 2. Build the specific heat capacity table c_p(T) at pressure p\n        cp_table = c_p0 + A * np.exp(-((T_grid - T_w)**2) / (2 * sigma**2))\n\n        # 3. Build the enthalpy table h(T) by numerical quadrature\n        # h(T) = integral from T_min to T of cp(T') dT'\n        # The reference enthalpy h(T_min, p) is 0.\n        h_integral = cumulative_trapezoid(cp_table, T_grid, initial=0.0)\n        h_table = h_integral\n\n        # 4. Calculate enthalpies of jet and environment streams\n        # Use linear interpolation on the generated tables\n        h_jet = np.interp(T_jet, T_grid, h_table)\n        h_env = np.interp(T_env, T_grid, h_table)\n\n        # 5. Calculate mixture enthalpy using the mixture fraction definition\n        h_mix = Z * h_jet + (1.0 - Z) * h_env\n\n        # 6. Invert the h(T) relation to find T(h_mix)\n        # Use linear interpolation with h as x-axis and T as y-axis\n        T_result = np.interp(h_mix, h_table, T_grid)\n        \n        return T_result\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (5.5e6, 0.0),\n        (5.5e6, 1.0),\n        (5.5e6, 0.5),\n        (1.0e7, 0.5),\n        (2.0e7, 0.5),\n        (5.5e6, 0.2),\n    ]\n\n    results = []\n    for p_case, Z_case in test_cases:\n        temp_result = get_T_from_Z_p(p_case, Z_case)\n        # Format to one decimal place\n        results.append(f\"{temp_result:.1f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本练习将挑战你应用更基本的物理原理来模拟跨临界混合。我们将不再使用唯象的比热容模型，而是直接从一个基本的状态方程（Peng-Robinson EoS）出发，推导所有必要的热力学性质 。你的任务是建立一个一维的跨临界混合剪切层模型，并预测伪沸腾现象发生的精确空间位置，从而将基础热力学与宏观流动特征直接联系起来。",
            "id": "4055399",
            "problem": "考虑一个单组分、稳态、一维的平面剪切层，该剪切层位于两个均匀超临界压力下的平行流之间。一股由甲烷组成的冷而稠密的射流与一股同样由甲烷组成的、温度更高、密度更低的伴流在相同压力下混合。设坐标 $y \\in [0,L]$ 表示横流方向，其中 $y=0$ 在射流侧，$y=L$ 在环境流体侧。目标是利用守恒原理和真实流体状态方程（EoS），预测剪切层内局部温度等于伪沸腾温度 $T_{pb}$ 的位置 $y_{pb}$。\n\n假设与基本原理：\n- 流动是稳态、一维的，压力 $P$ 在 $y$ 方向上均匀且恒定。\n- 无化学反应，无体积热源。流体为单组分甲烷，所有输运在 $y$ 方向上均为纯扩散。\n- 由于流体是单组分，各处的组分质量分数均为1，但温度和焓因热扩散和混合而变化。\n- 混合分数 $\\,\\xi(y)\\,$ 是一个守恒标量，满足具有恒定扩散系数的稳态扩散方程：$\\dfrac{d}{dy}\\left( \\Gamma \\dfrac{d\\xi}{dy} \\right) = 0$，边界条件为 $\\xi(0)=1$ 和 $\\xi(L)=0$，这意味着一个线性分布 $\\xi(y) = 1 - y/L$。\n- 在单位路易斯数以及显焓和混合分数的扩散系数相等的条件下，比焓（以摩尔为基准）是混合分数的线性函数：$h(y) = \\xi(y)\\, h_j + [1 - \\xi(y)]\\, h_a$，其中 $h_j = h(T_j,P)$ 是射流侧的摩尔焓，$h_a = h(T_a,P)$ 是环境流体侧的摩尔焓。\n- 摩尔焓建模为 $h(T,P) = h^{\\mathrm{ideal}}(T) + h^{\\mathrm{res}}(T,P)$，其中 $h^{\\mathrm{ideal}}(T)$ 是理想气体焓，$h^{\\mathrm{res}}(T,P)$ 是由立方型真实流体状态方程（EoS）得到的非理想效应引起的剩余焓。\n- 理想气体焓建模为 $h^{\\mathrm{ideal}}(T) = c_{p,\\mathrm{ideal}}\\, T$，其中摩尔热容 $c_{p,\\mathrm{ideal}}$ 为常数，且参考零点在 $T=0\\,\\mathrm{K}$。在线性混合假设下，这种选择能一致地保持焓差。\n- 真实流体状态方程采用Peng–Robinson状态方程（PR EoS）。对于纯流体，PR EoS的参数为\n  $$ a = 0.45724 \\dfrac{R^2 T_c^2}{P_c} \\,\\alpha(T), \\quad b = 0.07780 \\dfrac{R T_c}{P_c}, $$\n  $$ \\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{\\dfrac{T}{T_c}}\\right)\\right]^2, \\quad \\kappa = 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^2, $$\n  其中 $R$ 是普适气体常数，$T_c$ 是临界温度，$P_c$ 是临界压力，$\\omega$ 是偏心因子。定义\n  $$ A = \\dfrac{a P}{R^2 T^2}, \\quad B = \\dfrac{b P}{R T}, $$\n  压缩因子 $Z$ 是以下方程的实根\n  $$ Z^3 - (1 - B) Z^2 + (A - 3 B^2 - 2 B) Z - (A B - B^2 - B^3) = 0. $$\n  对于超临界单相条件，选择最大的实根来代表类气相。摩尔密度与之相关：\n  $$ \\rho_{\\mathrm{mol}}(T,P) = \\dfrac{P}{Z R T}, \\quad \\rho_{\\mathrm{mass}}(T,P) = \\dfrac{M P}{Z R T}, $$\n  其中 $M$ 是摩尔质量。\n- Peng–Robinson方程的剩余焓为\n  $$ h^{\\mathrm{res}}(T,P) = R T (Z - 1) + \\dfrac{T \\dfrac{da}{dT} - a}{2 \\sqrt{2}\\, b} \\,\\ln\\!\\left( \\dfrac{Z + (1 + \\sqrt{2}) B}{Z + (1 - \\sqrt{2}) B} \\right), $$\n  其中\n  $$ \\dfrac{da}{dT} = 0.45724 \\dfrac{R^2 T_c^2}{P_c}\\, \\dfrac{d\\alpha}{dT}, \\quad \\dfrac{d\\alpha}{dT} = - \\dfrac{\\kappa}{T_c} \\left[1 + \\kappa \\left(1 - \\sqrt{\\dfrac{T}{T_c}}\\right)\\right] \\dfrac{1}{\\sqrt{\\dfrac{T}{T_c}}}. $$\n- 沿等压线的伪沸腾温度 $T_{pb}$ 在此定义为质量密度的等压温度导数的绝对值达到最大的温度：\n  $$ T_{pb}(P) = \\underset{T}{\\mathrm{argmax}}\\;\\left| \\left(\\dfrac{\\partial \\rho_{\\mathrm{mass}}}{\\partial T}\\right)_{P} \\right|. $$\n  该定义与Widom线的概念一致，Widom线是超临界流体中响应函数最大值的轨迹。\n\n计算任务：\n- 对于甲烷，使用以下常数：$T_c = 190.564\\,\\mathrm{K}$，$P_c = 4.5992\\times 10^{6}\\,\\mathrm{Pa}$，$\\omega = 0.01142$，$M = 0.016043\\,\\mathrm{kg/mol}$，$R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$，以及 $c_{p,\\mathrm{ideal}} = 35.0\\,\\mathrm{J/(mol\\cdot K)}$。\n- 对于下面的每个测试用例，通过在区间 $[0.7 T_c, 3.0 T_c]$ 内扫描温度 $T$ 并使用均匀网格上的中心有限差分近似来定位 $\\left|\\partial \\rho_{\\mathrm{mass}}/\\partial T\\right|_{P}$ 的最大值，从而计算 $T_{pb}(P)$。使用 $1\\,\\mathrm{K}$ 的温度步长。\n- 计算 $h_j = h(T_j,P)$、$h_a = h(T_a,P)$ 和 $h_{pb} = h(T_{pb},P)$。在线性焓混合模型下，温度为 $T=T_{pb}$ 时的混合分数为\n  $$ \\xi_{pb} = \\dfrac{h_{pb} - h_a}{h_j - h_a}, $$\n  其位置为\n  $$ y_{pb} = L\\,(1 - \\xi_{pb}). $$\n- 如果 $T_{pb}$ 不在温度区间 $[\\min(T_j,T_a),\\, \\max(T_j,T_a)]$ 内，则输出 $y_{pb} = -1.0$，因为伪沸腾状态未在剪切层内达到。\n- 如果 $h_j \\approx h_a$（在一个小的数值容差内，表示没有焓梯度），则输出 $y_{pb} = -1.0$。\n\n答案单位与输出格式：\n- 以米为单位表示 $y_{pb}$，作为一个浮点数，四舍五入到六位小数。\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，“[result1,result2,result3]”）。\n\n测试用例：\n- 用例1（具有宽温度范围的典型跨临界混合）：$P = 8.0\\times 10^{6}\\,\\mathrm{Pa}$，$T_j = 140\\,\\mathrm{K}$，$T_a = 340\\,\\mathrm{K}$，$L = 3.0\\times 10^{-3}\\,\\mathrm{m}$。\n- 用例2（窄暖混合范围，可能高于伪沸腾温度）：$P = 8.0\\times 10^{6}\\,\\mathrm{Pa}$，$T_j = 240\\,\\mathrm{K}$，$T_a = 260\\,\\mathrm{K}$，$L = 2.0\\times 10^{-3}\\,\\mathrm{m}$。\n- 用例3（接近临界压力的压力带，具有中等温度范围）：$P = 4.6\\times 10^{6}\\,\\mathrm{Pa}$，$T_j = 150\\,\\mathrm{K}$，$T_a = 220\\,\\mathrm{K}$，$L = 4.0\\times 10^{-3}\\,\\mathrm{m}$。\n- 用例4（冷混合范围，可能低于伪沸腾温度）：$P = 1.2\\times 10^{7}\\,\\mathrm{Pa}$，$T_j = 130\\,\\mathrm{K}$，$T_a = 160\\,\\mathrm{K}$，$L = 1.5\\times 10^{-3}\\,\\mathrm{m}$。",
            "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据、适定且客观。所提供的物理模型基于Peng-Robinson状态方程（PR EoS）和标准输运现象假设，是一致且完整的。计算任务明确定义了所有必要的常数、方程和边界条件，从而可以得到唯一且可验证的解。\n\n求解过程首先实现基于PR EoS的甲烷热力学性质计算。随后，进行数值搜索以确定伪沸腾温度。最后，利用线性焓混合法则，为每个测试用例确定剪切层内对应于该温度的空间位置。\n\n总体算法结构如下：\n\n1.  **Peng-Robinson状态方程与热力学性质：** 开发一组函数来计算作为温度 $T$ 和压力 $P$ 的函数的热力学性质。\n    - 根据给定的流体性质：临界温度 $T_c$、临界压力 $P_c$ 和偏心因子 $\\omega$，计算参数 $\\kappa$、$b$ 和随温度变化的项 $\\alpha(T)$。\n    $$ \\kappa = 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^2 $$\n    $$ b = 0.07780 \\dfrac{R T_c}{P_c} $$\n    $$ \\alpha(T) = \\left[1 + \\kappa \\left(1 - \\sqrt{\\dfrac{T}{T_c}}\\right)\\right]^2 $$\n    - 然后计算参数 $a(T)$：\n    $$ a(T) = 0.45724 \\dfrac{R^2 T_c^2}{P_c} \\,\\alpha(T) $$\n    - 用 $a(T)$ 和 $b$ 确定无量纲参数 $A$ 和 $B$：\n    $$ A = \\dfrac{a(T) P}{R^2 T^2}, \\quad B = \\dfrac{b P}{R T} $$\n    - 通过求解PR三次状态方程来找到压缩因子 $Z$。该方程被重新整理成标准多项式形式 $Z^3 + c_2 Z^2 + c_1 Z + c_0 = 0$，其中：\n    $$ c_2 = -(1 - B) $$\n    $$ c_1 = A - 3 B^2 - 2 B $$\n    $$ c_0 = -(A B - B^2 - B^3) $$\n    求解此多项式的根。根据对超临界单相条件的规定，选择最大的实根作为有效的压缩因子 $Z$。\n    - 使用确定的 $Z$ 值计算质量密度 $\\rho_{\\mathrm{mass}}(T,P)$：\n    $$ \\rho_{\\mathrm{mass}}(T,P) = \\dfrac{M P}{Z R T} $$\n    - 摩尔焓 $h(T,P)$ 计算为理想气体部分 $h^{\\mathrm{ideal}}(T)$ 和剩余部分 $h^{\\mathrm{res}}(T,P)$ 的和。\n    $$ h^{\\mathrm{ideal}}(T) = c_{p,\\mathrm{ideal}}\\, T $$\n    剩余焓由PR EoS公式给出：\n    $$ h^{\\mathrm{res}}(T,P) = R T (Z - 1) + \\dfrac{T \\dfrac{da}{dT} - a}{2 \\sqrt{2}\\, b} \\,\\ln\\!\\left( \\dfrac{Z + (1 + \\sqrt{2}) B}{Z + (1 - \\sqrt{2}) B} \\right) $$\n    导数 $\\dfrac{da}{dT}$ 通过解析方式计算：\n    $$ \\dfrac{d\\alpha}{dT} = - \\dfrac{\\kappa}{T_c} \\left[1 + \\kappa \\left(1 - \\sqrt{\\dfrac{T}{T_c}}\\right)\\right] \\dfrac{1}{\\sqrt{\\dfrac{T}{T_c}}} $$\n    $$ \\dfrac{da}{dT} = 0.45724 \\dfrac{R^2 T_c^2}{P_c}\\, \\dfrac{d\\alpha}{dT} $$\n\n2.  **伪沸腾温度 $T_{pb}$ 计算：** 对于给定的压力 $P$，通过找到质量密度的等压温度导数绝对值最大的温度来确定伪沸腾温度 $T_{pb}$。\n    - 在区间 $[0.7 T_c, 3.0 T_c]$ 上以 $\\Delta T = 1\\,\\mathrm{K}$ 的步长创建一个离散温度网格。\n    - 对该网格上的每个温度计算质量密度 $\\rho_{\\mathrm{mass}}(T,P)$。\n    - 在每个网格点 $T_i$（不包括边界）处，使用二阶中心有限差分格式近似计算导数 $(\\partial \\rho_{\\mathrm{mass}} / \\partial T)_P$：\n    $$ \\left(\\dfrac{\\partial \\rho_{\\mathrm{mass}}}{\\partial T}\\right)_{P, T=T_i} \\approx \\dfrac{\\rho_{\\mathrm{mass}}(T_{i+1}, P) - \\rho_{\\mathrm{mass}}(T_{i-1}, P)}{2 \\Delta T} $$\n    - 将对应于 $|\\partial \\rho_{\\mathrm{mass}} / \\partial T|_P$ 最大值的温度确定为 $T_{pb}$。\n\n3.  **剪切层位置 $y_{pb}$ 计算：** 为每个测试用例计算位置 $y_{pb}$。\n    - 首先为给定的系统压力 $P$ 确定伪沸腾温度 $T_{pb}$。\n    - 检查 $T_{pb}$ 是否落在剪切层的温度范围 $[\\min(T_j,T_a), \\max(T_j,T_a)]$ 内。如果不在此范围内，则伪沸腾状态未在混合层内物理实现，位置设为 $y_{pb} = -1.0$。\n    - 如果 $T_{pb}$ 在有效范围内，则使用步骤1中的热力学函数计算射流边界的摩尔焓 $h_j = h(T_j, P)$、环境边界的摩尔焓 $h_a = h(T_a, P)$ 以及伪沸腾温度下的摩尔焓 $h_{pb} = h(T_{pb}, P)$。\n    - 检查焓梯度。如果 $h_j$ 和 $h_a$几乎相等（在一个小的数值容差内），则混合分数计算中的分母将变得不适定，我们设置 $y_{pb} = -1.0$。\n    - 使用线性焓混合法则找到温度为 $T_{pb}$ 时的混合分数 $\\xi_{pb}$：\n    $$ \\xi_{pb} = \\dfrac{h_{pb} - h_a}{h_j - h_a} $$\n    - 最后，根据线性混合分数分布 $\\xi(y) = 1 - y/L$ 计算空间位置 $y_{pb}$：\n    $$ y_{pb} = L\\,(1 - \\xi_{pb}) $$\n    结果按要求四舍五入到六位小数。整个过程被封装到一个程序中，用于处理给定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the pseudo-boiling position in a transcritical shear layer.\n    \"\"\"\n    \n    # Constants for Methane\n    METHANE_CONSTANTS = {\n        'Tc': 190.564,          # K\n        'Pc': 4.5992e6,         # Pa\n        'omega': 0.01142,       # acentric factor\n        'M': 0.016043,          # kg/mol\n        'R': 8.314462618,       # J/(mol.K)\n        'cp_ideal': 35.0,       # J/(mol.K)\n    }\n\n    class ThermodynamicCalculator:\n        \"\"\"\n        A class to calculate thermodynamic properties based on the Peng-Robinson EoS.\n        \"\"\"\n        def __init__(self, constants):\n            self.const = constants\n            # Pre-calculate constant parts of PR EoS parameters\n            self.kappa = (0.37464 + 1.54226 * self.const['omega'] \n                          - 0.26992 * self.const['omega']**2)\n            self.b = 0.07780 * self.const['R'] * self.const['Tc'] / self.const['Pc']\n            self.ac_factor = 0.45724 * self.const['R']**2 * self.const['Tc']**2 / self.const['Pc']\n            self.sqrt2 = np.sqrt(2)\n\n        def get_properties_at_T_P(self, T, P):\n            \"\"\"\n            Computes a full set of thermodynamic properties at a given T and P.\n            \"\"\"\n            # Calculate alpha(T) and its derivative\n            Tr = T / self.const['Tc']\n            sqrt_Tr = np.sqrt(Tr)\n            alpha_term = 1 + self.kappa * (1 - sqrt_Tr)\n            alpha = alpha_term**2\n            \n            dalpha_dT_term = 1 + self.kappa * (1 - sqrt_Tr)\n            dalpha_dT = - (self.kappa / (self.const['Tc'] * sqrt_Tr)) * dalpha_dT_term\n\n            # Calculate a(T) and its derivative\n            a = self.ac_factor * alpha\n            da_dT = self.ac_factor * dalpha_dT\n\n            # Calculate dimensionless groups A and B\n            A = a * P / (self.const['R']**2 * T**2)\n            B = self.b * P / (self.const['R'] * T)\n\n            # Solve cubic equation for Z\n            coeffs = [\n                1,\n                -(1 - B),\n                A - 3 * B**2 - 2 * B,\n                -(A * B - B**2 - B**3)\n            ]\n            roots = np.roots(coeffs)\n            real_roots = roots[np.isreal(roots)].real\n            if not real_roots.any():\n                # Should not happen in supercritical state, but as a fallback\n                raise ValueError(f\"No real roots for Z at T={T} K, P={P} Pa\")\n            Z = np.max(real_roots)\n            \n            return Z, a, A, B, da_dT\n\n        def get_rho_mass(self, T, P):\n            \"\"\"Calculates mass density.\"\"\"\n            Z, _, _, _, _ = self.get_properties_at_T_P(T, P)\n            rho_mass = self.const['M'] * P / (Z * self.const['R'] * T)\n            return rho_mass\n\n        def get_h(self, T, P):\n            \"\"\"Calculates molar enthalpy.\"\"\"\n            Z, a, _, B, da_dT = self.get_properties_at_T_P(T, P)\n            \n            # Ideal gas enthalpy\n            h_ideal = self.const['cp_ideal'] * T\n            \n            # Residual enthalpy\n            ln_term_num = Z + (1 + self.sqrt2) * B\n            ln_term_den = Z + (1 - self.sqrt2) * B\n            \n            if ln_term_num = 0 or ln_term_den = 0:\n                # Fallback if log argument becomes non-positive\n                h_res = self.const['R'] * T * (Z - 1)\n            else:\n                log_term = np.log(ln_term_num / ln_term_den)\n                h_res = (self.const['R'] * T * (Z - 1) + \n                         (T * da_dT - a) / (2 * self.sqrt2 * self.b) * log_term)\n            \n            return h_ideal + h_res\n\n    def find_Tpb(P, calculator):\n        \"\"\"\n        Finds the pseudo-boiling temperature by finding the max of |d(rho)/dT|_P.\n        \"\"\"\n        Tc = calculator.const['Tc']\n        T_min_scan, T_max_scan = 0.7 * Tc, 3.0 * Tc\n        T_step = 1.0\n        \n        T_range = np.arange(T_min_scan, T_max_scan + T_step, T_step)\n        \n        try:\n            rho_values = np.array([calculator.get_rho_mass(T, P) for T in T_range])\n        except ValueError:\n            return -1 # Indicate failure if Z calculation fails in the range\n\n        # Central difference for derivative\n        d_rho_dT = (rho_values[2:] - rho_values[:-2]) / (2 * T_step)\n        \n        if len(d_rho_dT) == 0:\n            return -1 # Not enough points\n            \n        # Find T corresponding to max |d(rho)/dT|\n        max_idx = np.argmax(np.abs(d_rho_dT))\n        Tpb = T_range[max_idx + 1] # +1 because derivative array is offset\n        \n        return Tpb\n\n    # Initialize calculator\n    calc = ThermodynamicCalculator(METHANE_CONSTANTS)\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (P in Pa, Tj in K, Ta in K, L in m)\n        (8.0e6, 140.0, 340.0, 3.0e-3), # Case 1\n        (8.0e6, 240.0, 260.0, 2.0e-3), # Case 2\n        (4.6e6, 150.0, 220.0, 4.0e-3), # Case 3\n        (1.2e7, 130.0, 160.0, 1.5e-3), # Case 4\n    ]\n\n    results = []\n    TOLERANCE = 1e-9\n\n    for P, Tj, Ta, L in test_cases:\n        Tpb = find_Tpb(P, calc)\n        \n        T_mix_min = min(Tj, Ta)\n        T_mix_max = max(Tj, Ta)\n        \n        if Tpb  T_mix_min or Tpb > T_mix_max:\n            results.append(-1.0)\n            continue\n            \n        try:\n            hj = calc.get_h(Tj, P)\n            ha = calc.get_h(Ta, P)\n            hpb = calc.get_h(Tpb, P)\n        except ValueError:\n            results.append(-1.0) # Calculation failed\n            continue\n\n        if abs(hj - ha)  TOLERANCE:\n            results.append(-1.0)\n            continue\n            \n        xi_pb = (hpb - ha) / (hj - ha)\n        \n        # Check if xi_pb is physically meaningful (between 0 and 1)\n        if not (0.0 = xi_pb = 1.0):\n             # This can happen if T-h relation is non-monotonic\n            results.append(-1.0)\n            continue\n\n        y_pb = L * (1.0 - xi_pb)\n        \n        results.append(round(y_pb, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}