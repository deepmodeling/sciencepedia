{
    "hands_on_practices": [
        {
            "introduction": "Before delving into complex kinetics and transport, it is essential to understand the thermodynamic limits of a combustion process. The adiabatic flame temperature, $T_{ad}$, represents the maximum temperature achievable under ideal conditions, providing a fundamental benchmark for any combustion model. This exercise solidifies your understanding of stoichiometry and the First Law of Thermodynamics by guiding you through an enthalpy balance calculation for a hydrogen-air flame .",
            "id": "4031183",
            "problem": "Consider a perfectly stirred, steady, adiabatic, constant-pressure reactor in which a stoichiometric hydrogen–air mixture at initial pressure $p = 1$ atm and initial temperature $T_0 = 300$ K is burned to completion, forming only gaseous water $\\mathrm{H}_2\\mathrm{O}$; nitrogen $\\mathrm{N}_2$ is inert. Air is modeled as a binary mixture of oxygen and nitrogen with mole fractions $x_{\\mathrm{O}_2} = 0.21$ and $x_{\\mathrm{N}_2} = 0.79$. Assume ideal-gas behavior for all species and neglect dissociation, radiation, and any minor species. The process is adiabatic, so the total enthalpy of the reactants equals the total enthalpy of the products at the adiabatic flame temperature $T_{ad}$.\n\nTake the standard molar enthalpy of formation at $T_0$ for $\\mathrm{H}_2\\mathrm{O}(\\mathrm{g})$ as $\\Delta h_f^{\\circ}(\\mathrm{H}_2\\mathrm{O}, T_0) = -241.826$ kJ/mol, and for $\\mathrm{H}_2$, $\\mathrm{O}_2$, and $\\mathrm{N}_2$ as zero. Use a basis of $1$ mol of $\\mathrm{H}_2$ consumed. The initial sensible enthalpies of all reactants are referenced to zero at $T_0$.\n\nFor the temperature-dependent molar constant-pressure heat capacities (valid for $300$ K $\\le T \\le 3500$ K), use:\n- $\\mathrm{H}_2\\mathrm{O}(\\mathrm{g})$: $c_p^{\\mathrm{H}_2\\mathrm{O}}(T) = 32.24 + 2.27 \\times 10^{-3}\\, T$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$,\n- $\\mathrm{N}_2(\\mathrm{g})$: $c_p^{\\mathrm{N}_2}(T) = 29.15 + 3.29 \\times 10^{-3}\\, T$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nCompute the adiabatic flame temperature $T_{ad}$ consistent with these assumptions and property models. Express your final answer in Kelvin and round to four significant figures.",
            "solution": "The user-provided problem has been analyzed and is determined to be **valid**. It is scientifically grounded in the principles of chemical thermodynamics, well-posed with sufficient information to determine a unique solution, and presented in an objective, formal manner. The assumptions, such as ideal-gas behavior and complete combustion, are standard for simplified combustion problems. All necessary thermodynamic data and property models are provided.\n\nThe solution proceeds as follows.\n\nFirst, we establish the balanced chemical equation for the stoichiometric combustion of hydrogen ($\\mathrm{H}_2$) with air. Air is modeled as a mixture of oxygen ($\\mathrm{O}_2$) and nitrogen ($\\mathrm{N}_2$) with mole fractions $x_{\\mathrm{O}_2} = 0.21$ and $x_{\\mathrm{N}_2} = 0.79$. The molar ratio of nitrogen to oxygen in air is therefore $\\frac{x_{\\mathrm{N}_2}}{x_{\\mathrm{O}_2}} = \\frac{0.79}{0.21}$.\n\nThe general stoichiometric reaction is:\n$$ \\mathrm{H}_2 + a(\\mathrm{O}_2 + \\frac{0.79}{0.21}\\mathrm{N}_2) \\rightarrow b\\mathrm{H}_2\\mathrm{O} + c\\mathrm{N}_2 $$\nWe balance this equation based on the conservation of atoms for a basis of $1$ mole of $\\mathrm{H}_2$:\n- Hydrogen (H) atom balance: $2 = 2b \\implies b=1$.\n- Oxygen (O) atom balance: $2a = b \\implies 2a = 1 \\implies a=0.5$.\n- Nitrogen ($\\mathrm{N}_2$) is inert, so the number of moles is conserved: $c = a \\times \\frac{0.79}{0.21} = 0.5 \\times \\frac{0.79}{0.21} = \\frac{0.395}{0.21} = \\frac{79}{42}$.\n\nThe balanced reaction for the consumption of $1$ mole of $\\mathrm{H}_2$ is:\n$$ \\mathrm{H}_2 + 0.5\\,\\mathrm{O}_2 + \\frac{79}{42}\\,\\mathrm{N}_2 \\rightarrow \\mathrm{H}_2\\mathrm{O} + \\frac{79}{42}\\,\\mathrm{N}_2 $$\nThe reactants are $n_{\\mathrm{H}_2} = 1$ mol, $n_{\\mathrm{O}_2} = 0.5$ mol, and $n_{\\mathrm{N}_2,reac} = \\frac{79}{42}$ mol.\nThe products are $n_{\\mathrm{H}_2\\mathrm{O}} = 1$ mol and $n_{\\mathrm{N}_2,prod} = \\frac{79}{42}$ mol.\n\nNext, we apply the First Law of Thermodynamics for a steady, adiabatic, constant-pressure process. The enthalpy of the reactants at their initial state must equal the enthalpy of the products at the final state (the adiabatic flame temperature, $T_{ad}$).\n$$ H_{reactants} = H_{products} $$\nThe total enthalpy $H$ of a mixture is the sum of the molar enthalpies of its constituents, $H = \\sum_i n_i \\bar{h}_i(T)$. The molar enthalpy of species $i$ at temperature $T$ is the sum of its standard molar enthalpy of formation at a reference temperature $T_0$ and its sensible enthalpy change from $T_0$ to $T$:\n$$ \\bar{h}_i(T) = \\Delta h_{f,i}^{\\circ}(T_0) + \\int_{T_0}^{T} c_{p,i}(T') dT' $$\nIn this problem, the initial temperature is $T_0 = 300$ K, which is also the standard reference temperature. The problem states that the initial sensible enthalpies of all reactants are zero, which is consistent with their being at $T_0$.\nThe enthalpy of the reactants at $T_0 = 300$ K is:\n$$ H_{reactants} = \\sum_{i,reac} n_i \\Delta h_{f,i}^{\\circ}(T_0) = n_{\\mathrm{H}_2}\\Delta h_{f, \\mathrm{H}_2}^{\\circ} + n_{\\mathrm{O}_2}\\Delta h_{f, \\mathrm{O}_2}^{\\circ} + n_{\\mathrm{N}_2}\\Delta h_{f, \\mathrm{N}_2}^{\\circ} $$\nThe standard enthalpies of formation of elements in their stable form ($\\mathrm{H}_2$, $\\mathrm{O}_2$, $\\mathrm{N}_2$) are zero by definition.\n$$ H_{reactants} = (1)(0) + (0.5)(0) + (\\frac{79}{42})(0) = 0 $$\nThe enthalpy of the products at the adiabatic flame temperature $T_{ad}$ is:\n$$ H_{products} = \\sum_{j,prod} n_j \\left( \\Delta h_{f,j}^{\\circ}(T_0) + \\int_{T_0}^{T_{ad}} c_{p,j}(T') dT' \\right) $$\n$$ H_{products} = n_{\\mathrm{H}_2\\mathrm{O}} \\left( \\Delta h_{f, \\mathrm{H}_2\\mathrm{O}}^{\\circ} + \\int_{T_0}^{T_{ad}} c_{p}^{\\mathrm{H}_2\\mathrm{O}}(T) dT \\right) + n_{\\mathrm{N}_2} \\left( \\Delta h_{f, \\mathrm{N}_2}^{\\circ} + \\int_{T_0}^{T_{ad}} c_{p}^{\\mathrm{N}_2}(T) dT \\right) $$\nSince $\\Delta h_{f, \\mathrm{N}_2}^{\\circ}=0$:\n$$ H_{products} = n_{\\mathrm{H}_2\\mathrm{O}} \\Delta h_{f, \\mathrm{H}_2\\mathrm{O}}^{\\circ} + \\int_{T_0}^{T_{ad}} \\left( n_{\\mathrm{H}_2\\mathrm{O}} c_{p}^{\\mathrm{H}_2\\mathrm{O}}(T) + n_{\\mathrm{N}_2} c_{p}^{\\mathrm{N}_2}(T) \\right) dT $$\nEquating $H_{reactants}$ and $H_{products}$:\n$$ 0 = n_{\\mathrm{H}_2\\mathrm{O}} \\Delta h_{f, \\mathrm{H}_2\\mathrm{O}}^{\\circ} + \\int_{T_0}^{T_{ad}} \\left( n_{\\mathrm{H}_2\\mathrm{O}} c_{p}^{\\mathrm{H}_2\\mathrm{O}}(T) + n_{\\mathrm{N}_2} c_{p}^{\\mathrm{N}_2}(T) \\right) dT $$\nRearranging gives:\n$$ -n_{\\mathrm{H}_2\\mathrm{O}} \\Delta h_{f, \\mathrm{H}_2\\mathrm{O}}^{\\circ} = \\int_{T_0}^{T_{ad}} \\left( n_{\\mathrm{H}_2\\mathrm{O}} c_{p}^{\\mathrm{H}_2\\mathrm{O}}(T) + n_{\\mathrm{N}_2} c_{p}^{\\mathrm{N}_2}(T) \\right) dT $$\nSubstitute the known values: $n_{\\mathrm{H}_2\\mathrm{O}}=1$ mol, $n_{\\mathrm{N}_2}=\\frac{79}{42}$ mol, and $\\Delta h_{f, \\mathrm{H}_2\\mathrm{O}}^{\\circ} = -241.826$ kJ/mol $= -241826$ J/mol.\n$$ - (1) (-241826) = \\int_{300}^{T_{ad}} \\left( (1) c_{p}^{\\mathrm{H}_2\\mathrm{O}}(T) + \\frac{79}{42} c_{p}^{\\mathrm{N}_2}(T) \\right) dT $$\nThe integrand is the total heat capacity of the product mixture, $C_{p,prod}(T)$. The heat capacities are given as $c_p(T) = A + BT$:\n$c_p^{\\mathrm{H}_2\\mathrm{O}}(T) = 32.24 + 2.27 \\times 10^{-3}\\, T$\n$c_p^{\\mathrm{N}_2}(T) = 29.15 + 3.29 \\times 10^{-3}\\, T$\n$C_{p,prod}(T) = (32.24 + 2.27 \\times 10^{-3}\\, T) + \\frac{79}{42}(29.15 + 3.29 \\times 10^{-3}\\, T)$\nGroup terms by powers of $T$:\n$C_{p,prod}(T) = \\left(32.24 + \\frac{79}{42} \\times 29.15\\right) + \\left(2.27 \\times 10^{-3} + \\frac{79}{42} \\times 3.29 \\times 10^{-3}\\right)T$\nLet's call the coefficients $A_{prod}$ and $B_{prod}$:\n$A_{prod} = 32.24 + \\frac{2302.85}{42} = \\frac{1354.08 + 2302.85}{42} = \\frac{3656.93}{42} \\approx 87.06976$ J mol$^{-1}$ K$^{-1}$\n$B_{prod} = \\left(2.27 + \\frac{259.91}{42}\\right) \\times 10^{-3} = \\frac{95.34 + 259.91}{42} \\times 10^{-3} = \\frac{355.25}{42} \\times 10^{-3} \\approx 8.45833 \\times 10^{-3}$ J mol$^{-1}$ K$^{-2}$\nNow, we perform the integration:\n$$ \\int_{300}^{T_{ad}} (A_{prod} + B_{prod}T) dT = \\left[ A_{prod}T + \\frac{1}{2}B_{prod}T^2 \\right]_{300}^{T_{ad}} $$\n$$ = (A_{prod}T_{ad} + \\frac{1}{2}B_{prod}T_{ad}^2) - (A_{prod}(300) + \\frac{1}{2}B_{prod}(300)^2) $$\nThis equals $241826$. We thus have a quadratic equation for $T_{ad}$:\n$$ \\frac{1}{2}B_{prod}T_{ad}^2 + A_{prod}T_{ad} - \\left( 241826 + 300A_{prod} + \\frac{1}{2}B_{prod}(300)^2 \\right) = 0 $$\nLet's compute the coefficients of the standard quadratic form $aT_{ad}^2 + bT_{ad} + c = 0$:\n$a = \\frac{1}{2}B_{prod} = \\frac{1}{2} \\left(\\frac{355.25}{42} \\times 10^{-3}\\right) = \\frac{177.625}{42} \\times 10^{-3} \\approx 4.229167 \\times 10^{-3}$\n$b = A_{prod} = \\frac{3656.93}{42} \\approx 87.06976$\n$c = -(241826 + 300(\\frac{3656.93}{42}) + \\frac{1}{2}(\\frac{355.25}{42} \\times 10^{-3})(90000))$\n$c = -(241826 + 26120.928... + 380.625) = -268327.553...$\nThe quadratic equation is:\n$$ (4.229167 \\times 10^{-3})T_{ad}^2 + 87.06976 T_{ad} - 268327.553 = 0 $$\nWe solve for $T_{ad}$ using the quadratic formula, $T_{ad} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$. We expect a high temperature, so we take the positive root.\n$T_{ad} = \\frac{-87.06976 + \\sqrt{(87.06976)^2 - 4(4.229167 \\times 10^{-3})(-268327.553)}}{2(4.229167 \\times 10^{-3})}$\n$T_{ad} = \\frac{-87.06976 + \\sqrt{7581.163 + 4539.245}}{8.458333 \\times 10^{-3}}$\n$T_{ad} = \\frac{-87.06976 + \\sqrt{12120.408}}{8.458333 \\times 10^{-3}}$\n$T_{ad} = \\frac{-87.06976 + 110.09272}{8.458333 \\times 10^{-3}}$\n$T_{ad} = \\frac{23.02296}{8.458333 \\times 10^{-3}} \\approx 2721.85$ K\nThe problem requires the answer to be rounded to four significant figures.\n$T_{ad} = 2721.85$ K becomes $2722$ K.",
            "answer": "$$\\boxed{2722}$$"
        },
        {
            "introduction": "Accurate flame modeling, especially for fuels containing light species like hydrogen, requires accounting for transport phenomena beyond simple concentration gradients. The Soret effect, or thermal diffusion, describes how species move in response to temperature gradients, a crucial mechanism in flames. This practice demonstrates the significance of thermal diffusion by calculating the Soret-induced velocity of hydrogen and comparing it to the flame's propagation speed , highlighting why multicomponent transport models are vital for predictive simulations.",
            "id": "4031173",
            "problem": "A one-dimensional, steady, planar, premixed flame of ammonia and hydrogen in air is considered under atmospheric pressure. Focus on a location within the preheat zone of the flame where the temperature increases monotonically along the positive spatial coordinate $x$. At this location, the following data are known and can be assumed locally uniform except for the temperature gradient:\n- Local temperature $T = 1500 \\,\\mathrm{K}$.\n- Temperature gradient $\\frac{dT}{dx} = 1.2 \\times 10^{7} \\,\\mathrm{K}\\,\\mathrm{m}^{-1}$ directed along $+x$.\n- Mixture-averaged thermal diffusion coefficient for hydrogen, $D_{T,\\mathrm{H_2}} = 2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n- Laminar flame speed of the ammonia–hydrogen–air mixture under these conditions, $S_{L} = 0.82 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nStarting from the multicomponent Stefan–Maxwell description for ideal gas mixtures and the definition of the thermal diffusion (Soret) contribution to the diffusion driving force, derive the thermal diffusion contribution to the hydrogen diffusion velocity relative to the mixture mass-averaged velocity in terms of the thermal diffusion coefficient and the temperature field. Then, using the provided data, evaluate the hydrogen thermal diffusion velocity component along $x$ at the specified location. Finally, define the dimensionless ratio\n$$\nR \\equiv \\frac{\\left|v_{T,\\mathrm{H_2}}\\right|}{S_{L}},\n$$\nand compute its numerical value. Use the identity $\\nabla \\ln T = \\frac{1}{T}\\nabla T$ when needed. Report $R$ as the final answer, rounded to three significant figures. The intermediate thermal diffusion velocity should be evaluated in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, while the final reported ratio $R$ is dimensionless.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and complete.\n\nThe givens are:\n-   A one-dimensional, steady, planar, premixed flame.\n-   Location: a point in the preheat zone.\n-   Local temperature: $T = 1500 \\,\\mathrm{K}$.\n-   Temperature gradient: $\\frac{dT}{dx} = 1.2 \\times 10^{7} \\,\\mathrm{K}\\,\\mathrm{m}^{-1}$.\n-   Mixture-averaged thermal diffusion coefficient for hydrogen: $D_{T,\\mathrm{H_2}} = 2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n-   Laminar flame speed: $S_{L} = 0.82 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n-   Required identity: $\\nabla \\ln T = \\frac{1}{T}\\nabla T$.\n-   Definition of the ratio to be computed: $R \\equiv \\frac{\\left|v_{T,\\mathrm{H_2}}\\right|}{S_{L}}$.\n\nThe problem is scientifically valid. It addresses the Soret effect (thermal diffusion) in a combustible gas mixture, a standard topic in combustion physics and transport phenomena. The provided data are physically realistic for a hydrogen-enriched flame. For instance, the large temperature gradient is characteristic of the very thin preheat zones of flames, which are often sub-millimeter in thickness. The values for the thermal diffusion coefficient and laminar flame speed are also within the expected range for such mixtures. The problem is well-posed, providing all necessary information and a clear objective. Therefore, a solution can be pursued.\n\nThe task is to derive and evaluate the thermal diffusion velocity of hydrogen, $v_{T,\\mathrm{H_2}}$, and then compute the dimensionless ratio $R$.\n\nThe thermal diffusion contribution to the diffusion velocity, often called the Soret effect, describes the tendency of species in a mixture to diffuse in response to a temperature gradient. For a species $k$, the thermal diffusion velocity, $\\mathbf{v}_{T,k}$, is proportional to the gradient of the logarithm of temperature:\n$$\n\\mathbf{v}_{T,k} \\propto \\nabla \\ln T\n$$\nThe full expression for the diffusion velocity of species $k$ in a multicomponent mixture is complex. However, simplified models are commonly used in combustion modeling. A frequent formulation for the diffusion mass flux of species $k$, $\\mathbf{j}_k$, includes a term for ordinary (concentration-driven) diffusion and a term for thermal diffusion:\n$$\n\\mathbf{j}_k = \\mathbf{j}_{c,k} + \\mathbf{j}_{T,k}\n$$\nThe thermal diffusion flux, $\\mathbf{j}_{T,k}$, is typically written as:\n$$\n\\mathbf{j}_{T,k} = -D_k^T \\nabla \\ln T\n$$\nwhere $D_k^T$ is the thermal diffusion coefficient, which has units of $\\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$. The diffusion velocity $\\mathbf{v}_k$ is related to the diffusion mass flux $\\mathbf{j}_k$ by $\\mathbf{j}_k = \\rho_k \\mathbf{v}_k = \\rho Y_k \\mathbf{v}_k$, where $\\rho_k$ and $Y_k$ are the partial density and mass fraction of species $k$, and $\\rho$ is the total mixture density. The thermal contribution to the diffusion velocity is thus:\n$$\n\\mathbf{v}_{T,k} = \\frac{\\mathbf{j}_{T,k}}{\\rho_k} = -\\frac{D_k^T}{\\rho_k} \\nabla \\ln T\n$$\nIt is a known physical phenomenon that light species like hydrogen ($\\mathrm{H_2}$) diffuse towards hotter regions. Since the temperature gradient is positive in the $+x$ direction, the diffusion velocity for $\\mathrm{H_2}$ must be positive. This implies that the term $-\\frac{D_k^T}{\\rho_k}$ must be positive for hydrogen. As $\\rho_k  0$, the coefficient $D_k^T$ must be negative for hydrogen, which is the standard convention in combustion literature.\n\nThe problem provides a \"mixture-averaged thermal diffusion coefficient\" for hydrogen, $D_{T,\\mathrm{H_2}}$, with units of $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$. Let us examine the units of the prefactor in our derived velocity equation: $\\left[-\\frac{D_k^T}{\\rho_k}\\right] = \\frac{\\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}}{\\mathrm{kg}\\,\\mathrm{m}^{-3}} = \\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$. This matches the units of the given coefficient $D_{T,\\mathrm{H_2}}$. This strongly implies that the problem defines the provided coefficient as:\n$$\nD_{T,\\mathrm{H_2}} \\equiv -\\frac{D_{\\mathrm{H_2}}^T}{\\rho_{\\mathrm{H_2}}}\n$$\nSince $D_{\\mathrm{H_2}}^T$ is negative for hydrogen, this definition makes $D_{T,\\mathrm{H_2}}$ a positive quantity, which is consistent with the given value of $2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n\nSubstituting this definition into the expression for the thermal diffusion velocity yields the specific relationship to be used:\n$$\n\\mathbf{v}_{T,\\mathrm{H_2}} = D_{T,\\mathrm{H_2}} \\nabla \\ln T\n$$\nUsing the identity provided in the problem, $\\nabla \\ln T = \\frac{1}{T}\\nabla T$, we obtain the final form for the derivation:\n$$\n\\mathbf{v}_{T,\\mathrm{H_2}} = \\frac{D_{T,\\mathrm{H_2}}}{T} \\nabla T\n$$\nThis equation directly relates the thermal diffusion velocity to the given coefficient and the temperature field.\n\nNext, we evaluate the component of this velocity along the $x$-axis, which we denote as $v_{T,\\mathrm{H_2},x}$. Since the problem is one-dimensional, the gradient $\\nabla T$ becomes $\\frac{dT}{dx}\\mathbf{i}$, where $\\mathbf{i}$ is the unit vector in the $+x$ direction. The scalar component is:\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{D_{T,\\mathrm{H_2}}}{T} \\frac{dT}{dx}\n$$\nSubstituting the provided numerical values:\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}{1500 \\,\\mathrm{K}} \\left(1.2 \\times 10^{7} \\,\\mathrm{K}\\,\\mathrm{m}^{-1}\\right)\n$$\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{(2.5 \\times 1.2) \\times (10^{-5} \\times 10^{7})}{1500} \\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{3.0 \\times 10^{2}}{1500} \\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{300}{1500} \\,\\mathrm{m}\\,\\mathrm{s}^{-1} = \\frac{1}{5} \\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 0.2 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nThe magnitude of the hydrogen thermal diffusion velocity is therefore $|v_{T,\\mathrm{H_2}}| = 0.2 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$. The positive sign confirms that hydrogen diffuses in the direction of increasing temperature, as expected.\n\nFinally, we compute the dimensionless ratio $R$:\n$$\nR \\equiv \\frac{\\left|v_{T,\\mathrm{H_2}}\\right|}{S_{L}}\n$$\nSubstituting the calculated value for $|v_{T,\\mathrm{H_2}}|$ and the given value for $S_{L}$:\n$$\nR = \\frac{0.2 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.82 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = \\frac{20}{82} = \\frac{10}{41}\n$$\n$$\nR \\approx 0.2439024...\n$$\nRounding to three significant figures, as requested, we get $R = 0.244$. This result shows that in this specific flame condition, the thermal diffusion of hydrogen contributes a velocity that is approximately $24.4\\%$ of the laminar flame speed, highlighting the importance of the Soret effect in modeling hydrogen-containing flames.",
            "answer": "$$\n\\boxed{0.244}\n$$"
        },
        {
            "introduction": "A primary output of computational flame simulations is the detailed internal structure, showing the spatial distribution of temperature and species. Interpreting this structure is key to understanding the underlying chemical pathways and transport processes. This computational exercise provides hands-on practice in a core analysis task: identifying the locations of key radical peaks relative to the main reaction zone . By working with synthetic flame profiles, you will develop the numerical skills to dissect and interpret complex simulation data.",
            "id": "4031178",
            "problem": "A one-dimensional (1D) steady premixed flame of hydrogen and ammonia is considered in a computational combustion setting. The goal is to analyze the flame structure by determining the locations of peak mole fractions of the hydroxyl radical (OH), the hydroperoxyl radical (HO$_2$), and nitric oxide (NO), and to relate these locations to the maximum temperature gradient, which is a proxy for the reaction zone in a 1D steady premixed flame. The analysis must be performed using synthetic, physically plausible profiles designed to mimic the qualitative behavior of hydrogen–ammonia flames. The program must output signed distances from the location of the maximum temperature gradient to each species peak, with positive values indicating downstream (higher temperature, larger $x$) and negative values indicating upstream (lower temperature, smaller $x$). All distances must be expressed in millimeter (mm).\n\nBegin from the following fundamental base and core definitions appropriate for computational combustion:\n- The steady one-dimensional energy conservation implies a balance between convective transport and chemical heat release, and in premixed flames the reaction zone is colocated with a steep temperature gradient. The temperature $T(x)$ is a monotone increasing function across the flame from an unburned temperature $T_u$ to a burned temperature $T_b$.\n- The species mole fraction fields $\\chi_{\\mathrm{OH}}(x)$, $\\chi_{\\mathrm{HO}_2}(x)$, and $\\chi_{\\mathrm{NO}}(x)$ exhibit peaks at characteristic positions relative to the reaction zone owing to chain-branching and termination processes. The hydroxyl radical (OH) typically peaks near the reaction front, the hydroperoxyl radical (HO$_2$) tends to peak upstream where temperature is lower, and nitric oxide (NO) peaks downstream where temperature is higher (with possible bimodality due to prompt and thermal mechanisms).\n- The continuous derivative is defined by $\\dfrac{dT}{dx}$, and its discrete approximation on a grid is given by finite differences. A local maximum of a function on a discrete grid corresponds to the index where its sampled values attain the largest value.\n\nThe synthetic test suite defines $T(x)$ and species profiles on uniform grids via analytic functions and parameters that yield scientifically plausible fields. In all cases, let the grid points be defined on a closed interval $[0, L]$ by $x_i = 0 + i \\Delta x$ for $i \\in \\{0,1,\\dots,N-1\\}$ with $\\Delta x = \\dfrac{L}{N-1}$. The temperature field is defined by\n$$\nT(x) = T_u + \\left(T_b - T_u\\right) \\cdot s(x), \\quad s(x) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{x - x_0}{\\delta}\\right)\\right),\n$$\nwhich yields a monotone increasing $T(x)$ with a reaction front centered near $x_0$ and thickness controlled by $\\delta$. The species mole fraction profiles are modeled as Gaussian functions positioned relative to the reaction front, with amplitudes and widths chosen to be plausible:\n$$\n\\chi_{\\mathrm{OH}}(x) = A_{\\mathrm{OH}} \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_{\\mathrm{OH}}\\right)\\right)^2}{2 \\sigma_{\\mathrm{OH}}^2}\\right),\n$$\n$$\n\\chi_{\\mathrm{HO}_2}(x) = A_{\\mathrm{HO}_2} \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_{\\mathrm{HO}_2}\\right)\\right)^2}{2 \\sigma_{\\mathrm{HO}_2}^2}\\right),\n$$\n$$\n\\chi_{\\mathrm{NO}}(x) = \\begin{cases}\nA_{\\mathrm{NO}} \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_{\\mathrm{NO}}\\right)\\right)^2}{2 \\sigma_{\\mathrm{NO}}^2}\\right),  \\text{single-peak case}, \\\\\nA_1 \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_1\\right)\\right)^2}{2 \\sigma_1^2}\\right) + A_2 \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_2\\right)\\right)^2}{2 \\sigma_2^2}\\right),  \\text{two-peak case}.\n\\end{cases}\n$$\nHere, $x_{\\mathrm{g}}$ denotes the location of the maximum of $\\left|\\dfrac{dT}{dx}\\right|$, which should be computed from the discretized temperature field by finite differences. The offsets $\\Delta_{\\mathrm{OH}}$, $\\Delta_{\\mathrm{HO}_2}$, and $\\Delta_{\\mathrm{NO}}$ position species peaks relative to the reaction front, with upstream offsets being negative and downstream offsets being positive.\n\nFor each test case, do the following:\n1. Construct the grid $\\{x_i\\}$ and compute $T(x)$.\n2. Compute the discrete temperature gradient $\\dfrac{dT}{dx}$ using the following scheme: use the forward difference at the left boundary, the backward difference at the right boundary, and the centered difference at interior points,\n$$\n\\left.\\dfrac{dT}{dx}\\right|_{x_0} \\approx \\dfrac{T(x_1) - T(x_0)}{x_1 - x_0}, \\quad \n\\left.\\dfrac{dT}{dx}\\right|_{x_{N-1}} \\approx \\dfrac{T(x_{N-1}) - T(x_{N-2})}{x_{N-1} - x_{N-2}},\n$$\n$$\n\\left.\\dfrac{dT}{dx}\\right|_{x_i} \\approx \\dfrac{T(x_{i+1}) - T(x_{i-1})}{x_{i+1} - x_{i-1}}, \\quad i \\in \\{1,2,\\dots,N-2\\}.\n$$\n3. Determine $x_{\\mathrm{g}}$ as the grid point where $\\left|\\dfrac{dT}{dx}\\right|$ is maximized.\n4. Construct $\\chi_{\\mathrm{OH}}(x)$, $\\chi_{\\mathrm{HO}_2}(x)$, and $\\chi_{\\mathrm{NO}}(x)$ according to the case definitions below.\n5. For each species, find the grid point of its global maximum and compute the signed distance $d_{\\mathrm{species}} = x_{\\mathrm{peak}} - x_{\\mathrm{g}}$.\n6. Express $d_{\\mathrm{species}}$ in millimeter (mm) by multiplying by $1000$.\n7. For each test case, produce a triple $[d_{\\mathrm{OH}}, d_{\\mathrm{HO}_2}, d_{\\mathrm{NO}}]$ in millimeter (mm), formatted as floating-point numbers with six digits after the decimal point.\n\nTest suite (parameters in International System of Units):\n- Case $1$ (typical thin reaction zone):\n    - $L = 0.01$ meter (m), $N = 501$, $T_u = 300$ Kelvin (K), $T_b = 2200$ Kelvin (K),\n    - $x_0 = 0.0030$ meter (m), $\\delta = 0.0004$ meter (m),\n    - $A_{\\mathrm{OH}} = 2.0 \\times 10^{-3}$, $\\sigma_{\\mathrm{OH}} = 0.00025$ meter (m), $\\Delta_{\\mathrm{OH}} = +0.00005$ meter (m),\n    - $A_{\\mathrm{HO}_2} = 6.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{HO}_2} = 0.00035$ meter (m), $\\Delta_{\\mathrm{HO}_2} = -0.00030$ meter (m),\n    - $A_{\\mathrm{NO}} = 1.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{NO}} = 0.00060$ meter (m), $\\Delta_{\\mathrm{NO}} = +0.00070$ meter (m).\n- Case $2$ (broader reaction zone, bimodal NO due to prompt and thermal contributions):\n    - $L = 0.015$ meter (m), $N = 601$, $T_u = 320$ Kelvin (K), $T_b = 2100$ Kelvin (K),\n    - $x_0 = 0.0060$ meter (m), $\\delta = 0.0006$ meter (m),\n    - $A_{\\mathrm{OH}} = 1.6 \\times 10^{-3}$, $\\sigma_{\\mathrm{OH}} = 0.00030$ meter (m), $\\Delta_{\\mathrm{OH}} = +0.00000$ meter (m),\n    - $A_{\\mathrm{HO}_2} = 8.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{HO}_2} = 0.00045$ meter (m), $\\Delta_{\\mathrm{HO}_2} = -0.00040$ meter (m),\n    - NO is defined by two peaks: $A_1 = 0.8 \\times 10^{-4}$, $\\sigma_1 = 0.00080$ meter (m), $\\Delta_1 = +0.00100$ meter (m); and $A_2 = 0.5 \\times 10^{-4}$, $\\sigma_2 = 0.00025$ meter (m), $\\Delta_2 = +0.00010$ meter (m).\n- Case $3$ (reaction zone near the inlet, upstream HO$_2$ peak biased close to the boundary):\n    - $L = 0.008$ meter (m), $N = 401$, $T_u = 290$ Kelvin (K), $T_b = 2000$ Kelvin (K),\n    - $x_0 = 0.00120$ meter (m), $\\delta = 0.00030$ meter (m),\n    - $A_{\\mathrm{OH}} = 1.8 \\times 10^{-3}$, $\\sigma_{\\mathrm{OH}} = 0.00020$ meter (m), $\\Delta_{\\mathrm{OH}} = +0.00002$ meter (m),\n    - $A_{\\mathrm{HO}_2} = 7.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{HO}_2} = 0.00035$ meter (m), $\\Delta_{\\mathrm{HO}_2} = -0.00100$ meter (m),\n    - $A_{\\mathrm{NO}} = 0.7 \\times 10^{-4}$, $\\sigma_{\\mathrm{NO}} = 0.00070$ meter (m), $\\Delta_{\\mathrm{NO}} = +0.00050$ meter (m).\n\nAlgorithmic requirements:\n- Use the discrete gradient scheme specified above to compute $\\dfrac{dT}{dx}$.\n- Determine $x_{\\mathrm{g}}$ as the grid location of the largest $\\left|\\dfrac{dT}{dx}\\right|$ value.\n- Determine peak locations by the index of the global maximum of each species profile over the grid. In the bimodal NO case, this is the index of the overall global maximum.\n- Compute signed distances $d_{\\mathrm{species}} = x_{\\mathrm{peak}} - x_{\\mathrm{g}}$ and convert to millimeter (mm).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case yielding a three-element list $[d_{\\mathrm{OH}}, d_{\\mathrm{HO}_2}, d_{\\mathrm{NO}}]$ in millimeter (mm). Format each floating-point number with six digits after the decimal point. There must be no spaces in the output. For example, the output should look like\n$$\n\\left[ \\left[d_{\\mathrm{OH},1}, d_{\\mathrm{HO}_2,1}, d_{\\mathrm{NO},1}\\right], \\left[d_{\\mathrm{OH},2}, d_{\\mathrm{HO}_2,2}, d_{\\mathrm{NO},2}\\right], \\left[d_{\\mathrm{OH},3}, d_{\\mathrm{HO}_2,3}, d_{\\mathrm{NO},3}\\right] \\right],\n$$\nprinted exactly as a single line string akin to $[ [\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot] ]$, with no spaces.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of combustion theory, using established simplified models for flame structure analysis. The problem is well-posed, providing all necessary mathematical definitions, parameters, and a clear, unambiguous algorithmic procedure. All data are self-consistent and physically plausible. The task is a standard numerical exercise in computational science, requiring careful implementation of discretization and analysis on a grid.\n\nThe objective is to determine the spatial relationship between the peak mole fractions of key chemical species ($\\text{OH}$, $\\text{HO}_2$, and $\\text{NO}$) and the main reaction zone in a simulated one-dimensional premixed flame. The reaction zone's location is identified by the point of maximum temperature gradient. The analysis proceeds through a series of well-defined numerical steps.\n\nFirst, the one-dimensional spatial domain of length $L$ is discretized into a uniform grid of $N$ points, $\\{x_i\\}$, where $x_i = i \\cdot \\Delta x$ for $i = 0, 1, \\dots, N-1$ and the grid spacing is $\\Delta x = L / (N-1)$.\n\nSecond, the temperature field, $T(x)$, is evaluated at each grid point $x_i$. The provided analytical form is\n$$\nT(x) = T_u + (T_b - T_u) \\cdot \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{x - x_0}{\\delta}\\right)\\right)\n$$\nwhere $T_u$ is the unburned gas temperature, $T_b$ is the final burned gas temperature, $x_0$ is the nominal center of the flame, and $\\delta$ characterizes the flame thickness. This function produces a monotonic increase in temperature, simulating the passage from reactants to products.\n\nThird, the temperature gradient, $\\frac{dT}{dx}$, is computed on the discrete grid. The problem specifies a mixed finite-difference scheme to approximate the derivative. At the interior grid points $i \\in \\{1, 2, \\dots, N-2\\}$, a second-order accurate central difference is employed:\n$$\n\\left.\\frac{dT}{dx}\\right|_{x_i} \\approx \\frac{T(x_{i+1}) - T(x_{i-1})}{x_{i+1} - x_{i-1}} = \\frac{T_{i+1} - T_{i-1}}{2\\Delta x}\n$$\nAt the boundaries, first-order accurate one-sided differences are used to avoid referencing non-existent points. At the left boundary ($i=0$), a forward difference is used:\n$$\n\\left.\\frac{dT}{dx}\\right|_{x_0} \\approx \\frac{T(x_1) - T(x_0)}{x_1 - x_0} = \\frac{T_1 - T_0}{\\Delta x}\n$$\nAt the right boundary ($i=N-1$), a backward difference is used:\n$$\n\\left.\\frac{dT}{dx}\\right|_{x_{N-1}} \\approx \\frac{T(x_{N-1}) - T(x_{N-2})}{x_{N-1} - x_{N-2}} = \\frac{T_{N-1} - T_{N-2}}{\\Delta x}\n$$\nThe location of the primary reaction zone, denoted $x_g$, is then identified as the grid coordinate corresponding to the maximum value of the absolute temperature gradient, $|\\frac{dT}{dx}|$. This is found by determining the index $i_g$ such that $|\\frac{dT}{dx}|_{x_{i_g}}|$ is maximal, and setting $x_g = x_{i_g}$.\n\nFourth, with $x_g$ determined, the mole fraction profiles for the species of interest ($\\text{OH}$, $\\text{HO}_2$, and $\\text{NO}$) are constructed on the grid. These profiles are modeled as Gaussian or sums of Gaussian functions, centered at locations offset from $x_g$. For a single-peak species $\\text{Y}$, the profile is given by:\n$$\n\\chi_{\\mathrm{Y}}(x) = A_{\\mathrm{Y}} \\exp\\left(-\\frac{(x - (x_g + \\Delta_{\\mathrm{Y}}))^2}{2 \\sigma_{\\mathrm{Y}}^2}\\right)\n$$\nFor the bimodal case of $\\text{NO}$ in the second test scenario, the profile is the sum of two such functions. These profiles are evaluated at each grid point $x_i$.\n\nFifth, the location of the peak mole fraction for each species, $x_{\\mathrm{peak}}$, is found by identifying the grid point where the corresponding mole fraction array, $\\chi(x_i)$, attains its global maximum. This is done by finding the index of the maximum value in the array and retrieving the corresponding spatial coordinate.\n\nFinally, for each species, the signed distance, $d_{\\mathrm{species}}$, from the reaction zone reference point $x_g$ to the species peak location $x_{\\mathrm{peak}}$ is calculated as:\n$$\nd_{\\mathrm{species}} = x_{\\mathrm{peak}} - x_g\n$$\nThis distance is converted from meters to millimeters by multiplying by a factor of $1000$. The results for each test case are compiled into a triplet $[d_{\\mathrm{OH}}, d_{\\mathrm{HO}_2}, d_{\\mathrm{NO}}]$ and formatted according to the specifications. This procedure is systematically applied to all provided test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational combustion problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"L\": 0.01, \"N\": 501, \"Tu\": 300, \"Tb\": 2200, \"x0\": 0.0030, \"delta\": 0.0004,\n            \"OH\": {\"A\": 2.0e-3, \"sigma\": 0.00025, \"Delta\": 0.00005},\n            \"HO2\": {\"A\": 6.0e-4, \"sigma\": 0.00035, \"Delta\": -0.00030},\n            \"NO\": {\"type\": \"single\", \"A\": 1.0e-4, \"sigma\": 0.00060, \"Delta\": 0.00070}\n        },\n        # Case 2\n        {\n            \"L\": 0.015, \"N\": 601, \"Tu\": 320, \"Tb\": 2100, \"x0\": 0.0060, \"delta\": 0.0006,\n            \"OH\": {\"A\": 1.6e-3, \"sigma\": 0.00030, \"Delta\": 0.00000},\n            \"HO2\": {\"A\": 8.0e-4, \"sigma\": 0.00045, \"Delta\": -0.00040},\n            \"NO\": {\"type\": \"bimodal\", \n                   \"peak1\": {\"A\": 0.8e-4, \"sigma\": 0.00080, \"Delta\": 0.00100},\n                   \"peak2\": {\"A\": 0.5e-4, \"sigma\": 0.00025, \"Delta\": 0.00010}}\n        },\n        # Case 3\n        {\n            \"L\": 0.008, \"N\": 401, \"Tu\": 290, \"Tb\": 2000, \"x0\": 0.00120, \"delta\": 0.00030,\n            \"OH\": {\"A\": 1.8e-3, \"sigma\": 0.00020, \"Delta\": 0.00002},\n            \"HO2\": {\"A\": 7.0e-4, \"sigma\": 0.00035, \"Delta\": -0.00100},\n            \"NO\": {\"type\": \"single\", \"A\": 0.7e-4, \"sigma\": 0.00070, \"Delta\": 0.00050}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Step 1: Construct grid and compute temperature profile\n        L, N = case[\"L\"], case[\"N\"]\n        Tu, Tb = case[\"Tu\"], case[\"Tb\"]\n        x0, delta = case[\"x0\"], case[\"delta\"]\n        \n        x = np.linspace(0, L, N)\n        dx = L / (N - 1)\n        \n        s_x = 0.5 * (1 + np.tanh((x - x0) / delta))\n        T = Tu + (Tb - Tu) * s_x\n\n        # Step 2: Compute discrete temperature gradient\n        dTdx = np.zeros_like(x)\n        # Forward difference at the left boundary\n        dTdx[0] = (T[1] - T[0]) / dx\n        # Backward difference at the right boundary\n        dTdx[-1] = (T[-1] - T[-2]) / dx\n        # Centered difference for interior points\n        dTdx[1:-1] = (T[2:] - T[:-2]) / (2 * dx)\n\n        # Step 3: Determine x_g\n        idx_g = np.argmax(np.abs(dTdx))\n        x_g = x[idx_g]\n\n        # Step 4-6: Construct species profiles, find peaks, and compute distances\n        case_distances = []\n        \n        def gaussian(x_grid, A, mu, sigma):\n            return A * np.exp(-((x_grid - mu)**2) / (2 * sigma**2))\n\n        # OH\n        oh_params = case[\"OH\"]\n        chi_OH = gaussian(x, oh_params[\"A\"], x_g + oh_params[\"Delta\"], oh_params[\"sigma\"])\n        idx_peak_OH = np.argmax(chi_OH)\n        x_peak_OH = x[idx_peak_OH]\n        d_OH = (x_peak_OH - x_g) * 1000\n        case_distances.append(d_OH)\n        \n        # HO2\n        ho2_params = case[\"HO2\"]\n        chi_HO2 = gaussian(x, ho2_params[\"A\"], x_g + ho2_params[\"Delta\"], ho2_params[\"sigma\"])\n        idx_peak_HO2 = np.argmax(chi_HO2)\n        x_peak_HO2 = x[idx_peak_HO2]\n        d_HO2 = (x_peak_HO2 - x_g) * 1000\n        case_distances.append(d_HO2)\n\n        # NO\n        no_params = case[\"NO\"]\n        if no_params[\"type\"] == \"single\":\n            chi_NO = gaussian(x, no_params[\"A\"], x_g + no_params[\"Delta\"], no_params[\"sigma\"])\n        else: # bimodal\n            p1 = no_params[\"peak1\"]\n            p2 = no_params[\"peak2\"]\n            chi_NO = (gaussian(x, p1[\"A\"], x_g + p1[\"Delta\"], p1[\"sigma\"]) +\n                      gaussian(x, p2[\"A\"], x_g + p2[\"Delta\"], p2[\"sigma\"]))\n\n        idx_peak_NO = np.argmax(chi_NO)\n        x_peak_NO = x[idx_peak_NO]\n        d_NO = (x_peak_NO - x_g) * 1000\n        case_distances.append(d_NO)\n\n        all_results.append(case_distances)\n\n    # Format the final output string\n    case_strings = [f\"[{','.join(f'{d:.6f}' for d in res)}]\" for res in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}