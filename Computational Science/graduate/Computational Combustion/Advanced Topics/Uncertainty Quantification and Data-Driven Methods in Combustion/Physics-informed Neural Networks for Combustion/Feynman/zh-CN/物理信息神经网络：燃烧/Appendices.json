{
    "hands_on_practices": [
        {
            "introduction": "物理信息神经网络（PINN）的表达能力与其架构设计密切相关。在将PINN应用于复杂的燃烧问题时，选择合适的网络结构至关重要，因为它直接决定了模型可以学习的解的复杂性。本练习  旨在通过计算一个为多变量燃烧场设计的典型PINN架构中的可训练参数总数，帮助你具体理解模型的容量。这个基本计算是设计、评估和优化任何神经网络模型的第一步。",
            "id": "4049974",
            "problem": "考虑一个物理信息神经网络（PINN），其设计用于在低马赫数、恒压假设下，近似计算燃烧学中的反应流场。该网络接收空间坐标、时间、压力和当量比作为输入，这些输入组合成维度为 $d_{\\mathrm{in}} = 6$ 的特征向量 $\\mathbf{x} = (x, y, z, t, p, \\phi)$。输出为温度场 $T(\\mathbf{x})$ 以及 $N_s = 9$ 个化学组分的质量分数 $\\{Y_i(\\mathbf{x})\\}_{i=1}^{N_s}$。该网络使用一个共享主干，以及针对各组分的特定头部和针对温度的独立头部。其架构规定如下：\n\n- 共享主干：一个全连接的多层感知机（MLP），包含三个宽度分别为 $64$、$64$ 和 $64$ 的隐藏层，之后是一个宽度为 $128$ 的潜输出层。因此，主干由序列化的线性映射 $6 \\to 64$、$64 \\to 64$、$64 \\to 64$ 和 $64 \\to 128$ 组成。所有线性层都包含偏置，且激活函数是无参数的。\n- 温度头部：一个全连接头部，将宽度为 $128$ 的主干潜向量映射到标量 $T$。它包含两个宽度分别为 $64$ 和 $32$ 的隐藏层，之后是一个输出层。因此，温度头部由线性映射 $128 \\to 64$、$64 \\to 32$ 和 $32 \\to 1$ 组成，每个线性层都带有偏置。\n- 组分头部：共有 $N_s = 9$ 个组分特定头部，每个头部将宽度为 $128$ 的主干潜向量映射到标量 $Y_i$。它包含一个宽度为 $32$ 的隐藏层，之后是一个输出层。每个组分头部由线性映射 $128 \\to 32$ 和 $32 \\to 1$ 组成，每个线性层都带有偏置。所有 $N_s$ 个头部具有相同的架构，但参数不同。\n\n假设没有额外的参数化层（例如，没有批量归一化或残差参数化），并且激活函数以及损失函数中使用的任何物理算子（控制方程残差、边界条件和积分约束）不引入任何可训练参数。计算此 PINN 中可训练参数的总数，包括共享主干和所有头部中的所有权重和偏置。\n\n将最终答案表示为单个整数。无需四舍五入，也无物理单位。",
            "solution": "该问题要求计算一个指定的物理信息神经网络（PINN）中可训练参数的总数。在标准的多层感知机（MLP）中，可训练参数由权重和偏置组成。对于一个将维度为 $n_{\\text{in}}$ 的输入映射到维度为 $n_{\\text{out}}$ 的输出的全连接线性层，其权重数量由乘积 $n_{\\text{in}} \\times n_{\\text{out}}$ 给出，偏置数量为 $n_{\\text{out}}$，因为每个输出神经元都有一个偏置项。因此，这样一个层的总参数数量为 $(n_{\\text{in}} \\times n_{\\text{out}}) + n_{\\text{out}}$。\n\n该网络架构由三个不同的部分组成：一个共享主干、一个温度头部和 $N_s = 9$ 个组分特定头部。我们将按顺序计算每个部分的参数数量，然后将它们相加得到总数。\n\n令 $N_{\\text{params}}$ 表示可训练参数的数量。\n\n1.  **共享主干参数**\n    共享主干处理维度为 $d_{\\text{in}} = 6$ 的输入向量 $\\mathbf{x}$。它由四个连续的全连接层组成。\n    -   第 $1$ 层：将维度为 $n_{\\text{in}} = 6$ 的输入映射到维度为 $n_{\\text{out}} = 64$ 的输出。\n        $N_{\\text{trunk},1} = (6 \\times 64) + 64 = 384 + 64 = 448$。\n    -   第 $2$ 层：将维度为 $n_{\\text{in}} = 64$ 的输入映射到维度为 $n_{\\text{out}} = 64$ 的输出。\n        $N_{\\text{trunk},2} = (64 \\times 64) + 64 = 4096 + 64 = 4160$。\n    -   第 $3$ 层：将维度为 $n_{\\text{in}} = 64$ 的输入映射到维度为 $n_{\\text{out}} = 64$ 的输出。\n        $N_{\\text{trunk},3} = (64 \\times 64) + 64 = 4096 + 64 = 4160$。\n    -   第 $4$ 层（潜输出层）：将维度为 $n_{\\text{in}} = 64$ 的输入映射到维度为 $n_{\\text{out}} = 128$ 的输出。\n        $N_{\\text{trunk},4} = (64 \\times 128) + 128 = 8192 + 128 = 8320$。\n\n    共享主干中的总参数数量 $N_{\\text{trunk}}$ 是其各层参数的总和：\n    $$N_{\\text{trunk}} = N_{\\text{trunk},1} + N_{\\text{trunk},2} + N_{\\text{trunk},3} + N_{\\text{trunk},4} = 448 + 4160 + 4160 + 8320 = 17088$$\n\n2.  **温度头部参数**\n    温度头部将来自主干的 $128$ 维潜向量作为其输入。它有三个全连接层。\n    -   第 $1$ 层：将维度为 $n_{\\text{in}} = 128$ 的输入映射到维度为 $n_{\\text{out}} = 64$ 的输出。\n        $N_{T,1} = (128 \\times 64) + 64 = 8192 + 64 = 8256$。\n    -   第 $2$ 层：将维度为 $n_{\\text{in}} = 64$ 的输入映射到维度为 $n_{\\text{out}} = 32$ 的输出。\n        $N_{T,2} = (64 \\times 32) + 32 = 2048 + 32 = 2080$。\n    -   第 $3$ 层（输出层）：将维度为 $n_{\\text{in}} = 32$ 的输入映射到维度为 $n_{\\text{out}} = 1$ 的标量输出。\n        $N_{T,3} = (32 \\times 1) + 1 = 32 + 1 = 33$。\n\n    温度头部的总参数数量 $N_{T}$ 为其总和：\n    $$N_{T} = N_{T,1} + N_{T,2} + N_{T,3} = 8256 + 2080 + 33 = 10369$$\n\n3.  **组分头部参数**\n    有 $N_s = 9$ 个组分特定头部。每个头部具有相同的架构，但参数不同。每个头部将来自主干的 $128$ 维潜向量作为输入，并由两个全连接层组成。我们首先计算单个组分头部的参数数量 $N_{Y_i}$。\n    -   第 $1$ 层：将维度为 $n_{\\text{in}} = 128$ 的输入映射到维度为 $n_{\\text{out}} = 32$ 的输出。\n        $N_{Y_i,1} = (128 \\times 32) + 32 = 4096 + 32 = 4128$。\n    -   第 $2$ 层（输出层）：将维度为 $n_{\\text{in}} = 32$ 的输入映射到维度为 $n_{\\text{out}} = 1$ 的标量输出。\n        $N_{Y_i,2} = (32 \\times 1) + 1 = 32 + 1 = 33$。\n\n    单个组分头部的总参数数量为：\n    $$N_{Y_i} = N_{Y_i,1} + N_{Y_i,2} = 4128 + 33 = 4161$$\n    由于有 $N_s = 9$ 个这样的头部，所有组分头部的总参数数量 $N_{\\text{species}}$ 为：\n    $$N_{\\text{species}} = N_s \\times N_{Y_i} = 9 \\times 4161 = 37449$$\n\n4.  **网络总参数**\n    整个 PINN 中可训练参数的总数 $N_{\\text{total}}$ 是主干、温度头部和所有组分头部的参数之和。\n    $$N_{\\text{total}} = N_{\\text{trunk}} + N_{T} + N_{\\text{species}}$$\n    $$N_{\\text{total}} = 17088 + 10369 + 37449$$\n    $$N_{\\text{total}} = 64906$$",
            "answer": "$$\\boxed{64906}$$"
        },
        {
            "introduction": "一个成功的物理信息神经网络（PINN）不仅要能拟合数据，更必须遵守其所模拟系统的基本物理定律。对于燃烧等复杂现象，这意味着PINN的输出（如温度和组分场）必须与热力学状态方程等核心原理保持一致。本练习  将引导你亲手验证一个模拟火焰的PINN输出是否满足理想气体状态方程和等压假设，从而深化你对“物理约束”在PINN中作用的理解。",
            "id": "4049991",
            "problem": "一个物理信息神经网络（PINN）被训练用于在等压状态下，近似求解低马赫数的一维、稳态、化学计量、预混甲烷-空气火焰的热化学场。空间坐标为 $x \\in [0,L]$，其中 $L = 5.0 \\times 10^{-3}\\ \\mathrm{m}$。该PINN预测温度场 $T(x)$ 和组分集合 $\\mathcal{S} = \\{\\mathrm{CH_4}, \\mathrm{O_2}, \\mathrm{N_2}, \\mathrm{CO_2}, \\mathrm{H_2O}\\}$ 中各组分的质量分数 $Y_k(x)$，并在其损失函数中将理想气体混合物状态方程 $p(x) = \\rho(x)\\,R(T)\\,T(x)$ 以及等压约束 $\\partial p/\\partial x = 0$ 作为软物理约束来施加。普适气体常数为 $R_u = 8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$，各组分的摩尔质量（单位为 $\\mathrm{kg}\\ \\mathrm{mol}^{-1}$）为 $W_{\\mathrm{CH_4}} = 0.01604276$，$W_{\\mathrm{O_2}} = 0.0319988$，$W_{\\mathrm{N_2}} = 0.0280134$，$W_{\\mathrm{CO_2}} = 0.0440098$ 和 $W_{\\mathrm{H_2O}} = 0.01801528$。PINN预测的温度被建模为 $T(x) = T_u + \\left(T_b - T_u\\right)s(x)$，其中 $T_u = 300\\ \\mathrm{K}$，$T_b = 2200\\ \\mathrm{K}$，平滑的反应进程变量为 $s(x) = \\tfrac{1}{2}\\left(1 + \\tanh\\left((x - x_f)/\\delta\\right)\\right)$，且 $x_f = 2.5 \\times 10^{-3}\\ \\mathrm{m}$，$\\delta = 5.0 \\times 10^{-4}\\ \\mathrm{m}$。组分质量分数为\n$$\nY_{\\mathrm{N_2}}(x) = Y_{\\mathrm{N_2},u},\\quad\nY_{\\mathrm{CH_4}}(x) = Y_{\\mathrm{CH_4},u}\\left(1 - s(x)\\right),\\quad\nY_{\\mathrm{O_2}}(x) = Y_{\\mathrm{O_2},u}\\left(1 - s(x)\\right),\n$$\n$$\nY_{\\mathrm{CO_2}}(x) = Y_{\\mathrm{CO_2},b}\\,s(x),\\quad\nY_{\\mathrm{H_2O}}(x) = Y_{\\mathrm{H_2O},b}\\,s(x),\n$$\n其中化学计量的甲烷-空气值为\n$$\nY_{\\mathrm{CH_4},u} = \\frac{16.04276}{290.70116},\\quad\nY_{\\mathrm{O_2},u} = \\frac{63.9976}{290.70116},\\quad\nY_{\\mathrm{N_2},u} = \\frac{210.6608}{290.70116},\n$$\n$$\nY_{\\mathrm{CO_2},b} = \\frac{44.0098}{290.70116},\\quad\nY_{\\mathrm{H_2O},b} = \\frac{36.03056}{290.70116}.\n$$\n这些选择确保对于所有的 $x$ 都有 $Y_{\\mathrm{CH_4}}(x) + Y_{\\mathrm{O_2}}(x) + Y_{\\mathrm{CO_2}}(x) + Y_{\\mathrm{H_2O}}(x) + Y_{\\mathrm{N_2}}(x) = 1$。局部混合气体常数由理想气体混合物关系式 $R(T) = \\sum_{k \\in \\mathcal{S}} Y_k(x)\\,R_k$ 定义，其中 $R_k = R_u/W_k$。\n\n在冷来流边界 $x = 0$ 处，一次独立测量提供了密度 $ \\rho(0) = 1.122\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$。仅使用基本的理想气体混合物定律、用组分质量分数表示的混合气体常数定义以及等压约束，推导用 $\\{Y_k\\}$ 和 $\\{R_k\\}$ 表示的 $R(T)$ 的表达式，证明为什么 $p(x)$ 必须在空间上是均匀的，并计算该均匀压力 $p$。将最终压力以 $\\mathrm{kPa}$ 为单位表示，并将您的答案四舍五入到四位有效数字。最终答案必须是单个实数。",
            "solution": "该问题是有效的，因为它在科学上基于热力学和燃烧理论，是适定的，并且提供了获得唯一解所需的所有必要数据。\n\n该问题要求三件事：第一，推导混合气体常数 $R(T)$ 的表达式；第二，证明为什么压力 $p(x)$ 在空间上是均匀的；第三，计算这个均匀压力。\n\n首先，我们来处理混合气体常数 $R$。问题陈述中将其定义为 $R(T) = \\sum_{k \\in \\mathcal{S}} Y_k(x)\\,R_k$，其中 $Y_k(x)$ 是组分 $k$ 的质量分数，$R_k = R_u/W_k$ 是其比气体常数，$R_u$ 是普适气体常数，$W_k$ 是组分 $k$ 的摩尔质量。使用记法 $R(T)$ 是因为质量分数 $Y_k(x)$ 本身是反应进程变量 $s(x)$ 的函数，而 $s(x)$ 又与温度 $T(x)$ 耦合。为了表明这个定义是一致的，我们回顾混合气体常数的基本定义，$R = R_u/W_{\\text{mix}}$，其中 $W_{\\text{mix}}$ 是混合物的平均摩尔质量。平均摩尔质量可以用质量分数定义为 $1/W_{\\text{mix}} = \\sum_k Y_k/W_k$。将此代入问题给出的表达式中：\n$$\n\\sum_{k \\in \\mathcal{S}} Y_k(x) R_k = \\sum_{k \\in \\mathcal{S}} Y_k(x) \\frac{R_u}{W_k} = R_u \\sum_{k \\in \\mathcal{S}} \\frac{Y_k(x)}{W_k} = R_u \\left(\\frac{1}{W_{\\text{mix}}(x)}\\right) = R(x)\n$$\n这证实了所提供的混合气体常数表达式的有效性，该常数是局部混合物组分的函数。\n\n第二，问题陈述该系统是在“等压状态”下建模的，并且施加了软约束 $\\partial p/\\partial x = 0$。一个在其定义域上导数为零的函数必定是常数。将此条件对空间坐标 $x$ 从一个参考点（例如，$x=0$）到一个任意点 $x$ 进行积分，得到：\n$$\n\\int_0^x \\frac{\\mathrm{d}p}{\\mathrm{d}x'} \\mathrm{d}x' = \\int_0^x 0 \\, \\mathrm{d}x' \\implies p(x) - p(0) = 0 \\implies p(x) = p(0)\n$$\n这证明了压力 $p$ 在空间上是均匀的，即 $p(x) = p = \\text{const}$。对于低速、非封闭的燃烧现象，这是一个标准且高度准确的近似，因为在这种情况下，由流体运动引起的压力变化与绝对热力学压力相比是可以忽略的。\n\n第三，我们计算这个均匀压力的值。根据理想气体混合物状态方程，$p = \\rho(x) R(x) T(x)$。由于 $p$ 是常数，我们可以在任何方便的点上对其求值。问题提供了冷边界处的密度 $\\rho(0) = 1.122\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，因此我们将在 $x=0$ 处计算所有量。\n$$\np = \\rho(0) R(0) T(0)\n$$\n我们需要计算混合气体常数 $R(0)$ 和温度 $T(0)$。\n在 $x=0$ 处的混合气体常数，记为 $R(0)$，取决于局部的质量分数 $Y_k(0)$。质量分数是反应进程变量 $s(x)$ 在 $x=0$ 处求值的函数。\n$s(0) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{0 - x_f}{\\delta}\\right)\\right) = \\frac{1}{2}\\left(1 - \\tanh\\left(\\frac{x_f}{\\delta}\\right)\\right)$。\n由于 $x_f = 2.5 \\times 10^{-3}\\ \\mathrm{m}$ 且 $\\delta = 5.0 \\times 10^{-4}\\ \\mathrm{m}$，比值为 $x_f/\\delta = 5$。\n$s(0) = \\frac{1}{2}\\left(1 - \\tanh(5)\\right)$。\n\n气体常数为 $R(x) = R_u / W_{\\text{mix}}(x)$，其中 $1/W_{\\text{mix}}(x) = \\sum_k Y_k(x)/W_k$。我们来分析这一项：\n$$\n\\frac{1}{W_{\\text{mix}}(x)} = \\frac{Y_{\\mathrm{N_2}}(x)}{W_{\\mathrm{N_2}}} + \\frac{Y_{\\mathrm{CH_4}}(x)}{W_{\\mathrm{CH_4}}} + \\frac{Y_{\\mathrm{O_2}}(x)}{W_{\\mathrm{O_2}}} + \\frac{Y_{\\mathrm{CO_2}}(x)}{W_{\\mathrm{CO_2}}} + \\frac{Y_{\\mathrm{H_2O}}(x)}{W_{\\mathrm{H_2O}}}\n$$\n代入给定的 $Y_k(x)$ 表达式：\n$$\n\\frac{1}{W_{\\text{mix}}(x)} = \\frac{Y_{\\mathrm{N_2},u}}{W_{\\mathrm{N_2}}} + (1-s(x))\\frac{Y_{\\mathrm{CH_4},u}}{W_{\\mathrm{CH_4}}} + (1-s(x))\\frac{Y_{\\mathrm{O_2},u}}{W_{\\mathrm{O_2}}} + s(x)\\frac{Y_{\\mathrm{CO_2},b}}{W_{\\mathrm{CO_2}}} + s(x)\\frac{Y_{\\mathrm{H_2O},b}}{W_{\\mathrm{H_2O}}}\n$$\n我们来计算各项 $Y_k/W_k$：\n$Y_{\\mathrm{CH_4},u}/W_{\\mathrm{CH_4}} = \\frac{16.04276/290.70116}{0.01604276} = \\frac{1000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{O_2},u}/W_{\\mathrm{O_2}} = \\frac{63.9976/290.70116}{0.0319988} = \\frac{2000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{N_2},u}/W_{\\mathrm{N_2}} = \\frac{210.6608/290.70116}{0.0280134} = \\frac{7520}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{CO_2},b}/W_{\\mathrm{CO_2}} = \\frac{44.0098/290.70116}{0.0440098} = \\frac{1000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{H_2O},b}/W_{\\mathrm{H_2O}} = \\frac{36.03056/290.70116}{0.01801528} = \\frac{2000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n未燃侧的反应物项总和为 $\\frac{1000+2000}{290.70116} = \\frac{3000}{290.70116}$。已燃侧的总和为 $\\frac{1000+2000}{290.70116} = \\frac{3000}{290.70116}$。由于该特定化学计量的总摩尔数守恒，这两者是相等的。令 $S_{\\text{react}} = \\frac{3000}{290.70116}$。\n那么，\n$$\n\\frac{1}{W_{\\text{mix}}(x)} = \\frac{Y_{\\mathrm{N_2},u}}{W_{\\mathrm{N_2}}} + (1-s(x))S_{\\text{react}} + s(x)S_{\\text{react}} = \\frac{Y_{\\mathrm{N_2},u}}{W_{\\mathrm{N_2}}} + S_{\\text{react}}\n$$\n这证明了 $W_{\\text{mix}}$ 以及因此 $R = R_u/W_{\\text{mix}}$ 在整个火焰中都是常数，与 $x$ 无关。我们可以计算 $R$ 的值：\n$$\n\\frac{1}{W_{\\text{mix}}} = \\frac{7520}{290.70116} + \\frac{3000}{290.70116} = \\frac{10520}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}\n$$\n$$\nR = R_u \\left(\\frac{10520}{290.70116}\\right) = (8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}) \\left(\\frac{10520}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}\\right) \\approx 300.933\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}\n$$\n接下来，我们计算在 $x=0$ 处的温度：\n$$\nT(0) = T_u + (T_b - T_u)s(0) = 300\\ \\mathrm{K} + (2200 - 300)\\ \\mathrm{K} \\cdot \\frac{1}{2}\\left(1 - \\tanh(5)\\right)\n$$\n$$\nT(0) = 300 + 1900 \\cdot \\frac{1}{2}\\left(1 - \\tanh(5)\\right) = 300 + 950 \\left(1 - \\frac{\\exp(10)-1}{\\exp(10)+1}\\right) = 300 + 950 \\left(\\frac{2}{\\exp(10)+1}\\right)\n$$\n使用计算器，$\\tanh(5) \\approx 0.999909204$。\n$T(0) \\approx 300 + 950(1 - 0.999909204) \\approx 300 + 950(0.000090796) \\approx 300 + 0.086256 \\approx 300.086\\ \\mathrm{K}$。\n\n最后，我们计算压力 $p$：\n$$\np = \\rho(0) R T(0)\n$$\n$$\np = (1.122\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}) \\times \\left(8.314462618 \\cdot \\frac{10520}{290.70116}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}\\right) \\times \\left(300 + 950(1 - \\tanh(5))\\ \\mathrm{K}\\right)\n$$\n进行数值计算：\n$R \\approx 300.93297\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$\n$T(0) \\approx 300.08626\\ \\mathrm{K}$\n$p \\approx 1.122 \\times 300.93297 \\times 300.08626 \\approx 101324.9\\ \\mathrm{Pa}$\n\n为了将其表示为千帕，我们除以 $1000$：\n$p \\approx 101.3249\\ \\mathrm{kPa}$\n四舍五入到四位有效数字得到 $101.3\\ \\mathrm{kPa}$。",
            "answer": "$$\\boxed{101.3}$$"
        },
        {
            "introduction": "在将物理信息神经网络（PINN）用于关键的科学与工程计算之前，验证其能否准确求解偏微分方程是不可或缺的步骤。制造解方法（Method of Manufactured Solutions, MMS）是一种严格的软件验证技术，通过构建一个具有已知解析解的测试问题来检验代码的正确性。本实践  要求你通过一个编码练习来实施MMS，你将学习如何通过计算“残差”来量化PINN预测与精确物理定律之间的偏差，这是评估和调试复杂计算模型的关键技能。",
            "id": "4050020",
            "problem": "请考虑适用于计算燃烧学的一维、稳态、常物性的温度和组分质量分数守恒方程。设 $x \\in [0,1]$ 为空间坐标，单位为米。假设密度 $\\rho$（单位：千克/立方米）、热导率 $k_t$（单位：瓦特/米·开尔文）、组分扩散系数 $D_k$（单位：平方米/秒）以及组分比焓 $h_k$（单位：焦耳/千克）均为常数。控制方程如下：\n\n能量守恒：\n$$ k_t \\frac{d^2 T}{dx^2} + \\sum_{k=1}^K h_k \\, \\omega_k(x) + q_{\\text{ext}}(x) = 0, $$\n\n各组分 $k \\in \\{1,\\dots,K\\}$ 的组分守恒：\n$$ \\rho D_k \\frac{d^2 Y_k}{dx^2} + \\omega_k(x) = 0. $$\n\n此处，$T(x)$ 是温度，单位为开尔文；$Y_k(x)$ 是无量纲的组分质量分数；$\\omega_k(x)$ 是反应源项，单位为千克/立方米·秒；$q_{\\text{ext}}(x)$ 是外部热源，单位为瓦特/立方米。对于 $T$ 和 $Y_k$，在 $x=0$ 和 $x=1$ 处的边界条件均为狄利克雷（Dirichlet）条件。\n\n人工解方法（Method of Manufactured Solutions, MMS）会预设解析场 $T_{\\text{true}}(x)$ 和 $Y_{k,\\text{true}}(x)$，然后计算源项，使得这些场能够精确满足控制方程。具体来说，定义\n$$ \\omega_k(x) = - \\rho D_k \\frac{d^2 Y_{k,\\text{true}}}{dx^2}, \\qquad q_{\\text{ext}}(x) = - k_t \\frac{d^2 T_{\\text{true}}}{dx^2} - \\sum_{k=1}^K h_k \\, \\omega_k(x). $$\n物理信息神经网络（Physics-Informed Neural Network, PINN）应通过最小化控制方程和边界条件的残差来恢复人工场。为了验证、确认和估计误差，我们定义预测场为 $T_{\\text{pred}}(x)$ 和 $Y_{k,\\text{pred}}(x)$，计算残差并量化误差范数。\n\n定义在 $[0,1]$ 区间内 $N$ 个均匀分布的配置点 $\\{x_i\\}_{i=1}^N$ 上评估的能量和组分方程的物理信息神经网络（PINN）残差为\n$$ r_T(x_i) = k_t \\frac{d^2 T_{\\text{pred}}}{dx^2}(x_i) + \\sum_{k=1}^K h_k \\, \\omega_k(x_i) + q_{\\text{ext}}(x_i), $$\n$$ r_{Y_k}(x_i) = \\rho D_k \\frac{d^2 Y_{k,\\text{pred}}}{dx^2}(x_i) + \\omega_k(x_i). $$\n定义归一化的 $L_2$ 残差范数：\n$$ \\| r_T \\|_{L_2} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left[r_T(x_i)\\right]^2}, \\qquad \\| r_{Y_k} \\|_{L_2} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left[r_{Y_k}(x_i)\\right]^2}. $$\n使用端点值定义边界条件失配范数：\n$$ \\mathrm{BC}_T = \\sqrt{\\frac{1}{2} \\left( \\left[T_{\\text{pred}}(0) - T_{\\text{true}}(0)\\right]^2 + \\left[T_{\\text{pred}}(1) - T_{\\text{true}}(1)\\right]^2 \\right)}, $$\n$$ \\mathrm{BC}_{Y_k} = \\sqrt{\\frac{1}{2} \\left( \\left[Y_{k,\\text{pred}}(0) - Y_{k,\\text{true}}(0)\\right]^2 + \\left[Y_{k,\\text{pred}}(1) - Y_{k,\\text{true}}(1)\\right]^2 \\right)}. $$\n\n您的任务是实现一个独立完整的程序，该程序通过预设解析场 $T_{\\text{true}}(x)$ 和 $Y_{k,\\text{true}}(x)$ 来执行人工解测试，据此构建 $\\omega_k(x)$ 和 $q_{\\text{ext}}(x)$，然后为一组测试用例量化物理信息神经网络（PINN）的残差范数和边界失配范数。PINN 的“预测”场将被视为人工场加上已知的、用于模拟近似误差的解析扰动。\n\n单位：\n- $\\| r_T \\|_{L_2}$ 以瓦特/立方米为单位报告。\n- 每个 $\\| r_{Y_k} \\|_{L_2}$ 以千克/立方米·秒为单位报告。\n- $\\mathrm{BC}_T$ 以开尔文为单位报告。\n- 每个 $\\mathrm{BC}_{Y_k}$ 报告为无量纲值。\n\n对于所有测试用例，使用在 $[0,1]$ 区间内均匀分布的 $N=200$ 个配置点。\n\n测试套件：\n- 测试用例 1（理想情况，无扰动，单组分）：\n  - $K=1$,\n  - $\\rho = 1.0 \\, \\mathrm{kg} \\, \\mathrm{m}^{-3}$, $k_t = 0.1 \\, \\mathrm{W} \\, \\mathrm{m}^{-1} \\, \\mathrm{K}^{-1}$,\n  - $D_1 = 1.0 \\times 10^{-5} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$, $h_1 = -1.0 \\times 10^{6} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$,\n  - $T_{\\text{true}}(x) = 300 + 10 x + 5 \\sin(2 \\pi x)$, $Y_{1,\\text{true}}(x) = 0.2 + 0.1 x + 0.05 \\cos(\\pi x)$,\n  - 预测场等于人工场：$T_{\\text{pred}} = T_{\\text{true}}$, $Y_{1,\\text{pred}} = Y_{1,\\text{true}}$。\n- 测试用例 2（内部扰动，边界保留，单组分）：\n  - $K=1$,\n  - $\\rho = 1.2 \\, \\mathrm{kg} \\, \\mathrm{m}^{-3}$, $k_t = 0.08 \\, \\mathrm{W} \\, \\mathrm{m}^{-1} \\, \\mathrm{K}^{-1}$,\n  - $D_1 = 2.0 \\times 10^{-5} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$, $h_1 = -8.0 \\times 10^{5} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$,\n  - $T_{\\text{true}}(x) = 290 + 15 x + 3 \\sin(2 \\pi x)$, $Y_{1,\\text{true}}(x) = 0.25 + 0.05 x + 0.02 \\cos(2 \\pi x)$,\n  - 预测扰动：$T_{\\text{pred}}(x) = T_{\\text{true}}(x) + \\epsilon_T \\sin(13 \\pi x)$，其中 $\\epsilon_T = 0.1$（开尔文），$Y_{1,\\text{pred}}(x) = Y_{1,\\text{true}}(x) + \\epsilon_{Y_1} \\sin(11 \\pi x)$，其中 $\\epsilon_{Y_1} = 1.0 \\times 10^{-4}$（无量纲）。这些扰动在 $x=0$ 和 $x=1$ 处为零，因此边界条件得以保留。\n- 测试用例 3（边界失配扰动，双组分）：\n  - $K=2$,\n  - $\\rho = 0.9 \\, \\mathrm{kg} \\, \\mathrm{m}^{-3}$, $k_t = 0.12 \\, \\mathrm{W} \\, \\mathrm{m}^{-1} \\, \\mathrm{K}^{-1}$,\n  - $D_1 = 1.0 \\times 10^{-5} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$, $D_2 = 5.0 \\times 10^{-6} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$,\n  - $h_1 = -8.0 \\times 10^{5} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$, $h_2 = -1.2 \\times 10^{6} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$,\n  - $T_{\\text{true}}(x) = 1200 + 100 x - 20 x^2$, $Y_{1,\\text{true}}(x) = 0.7 - 0.1 x + 0.02 \\sin(2 \\pi x)$, $Y_{2,\\text{true}}(x) = 0.3 + 0.05 x + 0.01 \\sin(\\pi x)$,\n  - 预测扰动：$T_{\\text{pred}}(x) = T_{\\text{true}}(x) + \\epsilon_T \\cos(\\pi x)$，其中 $\\epsilon_T = 0.5$（开尔文），$Y_{1,\\text{pred}}(x) = Y_{1,\\text{true}}(x) + \\epsilon_{Y_1} \\cos(\\pi x)$，其中 $\\epsilon_{Y_1} = 1.0 \\times 10^{-3}$，$Y_{2,\\text{pred}}(x) = Y_{2,\\text{true}}(x) + \\epsilon_{Y_2} \\cos(\\pi x)$，其中 $\\epsilon_{Y_2} = 5.0 \\times 10^{-4}$。这些扰动在 $x=0$ 和 $x=1$ 处不为零，因此边界条件被违反。\n\n您的程序必须：\n1. 对于每个测试用例，使用上述方程从人工场 $T_{\\text{true}}$ 和 $Y_{k,\\text{true}}$ 构建 $\\omega_k(x)$ 和 $q_{\\text{ext}}(x)$。\n2. 在 $N=200$ 个配置点上评估残差 $r_T(x_i)$ 和 $r_{Y_k}(x_i)$，并计算归一化的 $L_2$ 范数。以瓦特/立方米为单位报告 $\\| r_T \\|_{L_2}$，以千克/立方米·秒为单位报告每个 $\\| r_{Y_k} \\|_{L_2}$。\n3. 计算边界失配范数 $\\mathrm{BC}_T$（开尔文）和每个 $\\mathrm{BC}_{Y_k}$（无量纲）。\n4. 生成一行输出，包含用方括号括起来的逗号分隔列表形式的结果，其中每个测试用例贡献一个形如 $[ \\| r_T \\|_{L_2}, [\\| r_{Y_1} \\|_{L_2}, \\dots], \\mathrm{BC}_T, [\\mathrm{BC}_{Y_1}, \\dots] ]$ 的列表。因此，最终输出应为包含三个元素（每个测试用例一个）的单个列表，例如：\"[[rT1,[rY11],bcT1,[bcY11]],[[rT2,[rY21],bcT2,[bcY21]],[[rT3,[rY31,rY32],bcT3,[bcY31,bcY32]]]\"。确保打印输出中不出现空格。\n\n所有量都必须按其指定单位处理。三角函数内的角度是弧度。程序必须是独立完整的，无需任何输入。",
            "solution": "用户提供了一个问题，要求在一位稳态燃烧的背景下，使用人工解方法（MMS）对物理信息神经网络（PINN）进行验证测试，计算残差和边界条件失配。该问题定义明确，科学上合理，且内部一致。\n\n问题的核心在于将人工解析解代入控制微分方程以定义源项，然后计算当使用一个受扰动的“预测”解时所产生的残差。\n\n控制方程为：\n能量方程：$k_t \\frac{d^2 T}{dx^2} + \\sum_{k=1}^K h_k \\omega_k(x) + q_{\\text{ext}}(x) = 0$\n组分方程：$\\rho D_k \\frac{d^2 Y_k}{dx^2} + \\omega_k(x) = 0$\n\nMMS 定义了源项 $\\omega_k(x)$ 和 $q_{\\text{ext}}(x)$，使得“真实”的人工场 $T_{\\text{true}}(x)$ 和 $Y_{k,\\text{true}}(x)$ 成为精确解。\n从组分方程可得：\n$$ \\omega_k(x) = - \\rho D_k \\frac{d^2 Y_{k,\\text{true}}}{dx^2} $$\n从能量方程可得：\n$$ q_{\\text{ext}}(x) = - k_t \\frac{d^2 T_{\\text{true}}}{dx^2} - \\sum_{k=1}^K h_k \\omega_k(x) $$\n\nPINN 残差是使用“预测”场 $T_{\\text{pred}}(x)$ 和 $Y_{k,\\text{pred}}(x)$ 以及人工源项来计算的：\n$$ r_T(x) = k_t \\frac{d^2 T_{\\text{pred}}}{dx^2} + \\sum_{k=1}^K h_k \\omega_k(x) + q_{\\text{ext}}(x) $$\n$$ r_{Y_k}(x) = \\rho D_k \\frac{d^2 Y_{k,\\text{pred}}}{dx^2} + \\omega_k(x) $$\n一个关键步骤是将人工源项的表达式代入残差方程。这种简化揭示了 MMS 测试的底层结构。\n\n对于组分残差 $r_{Y_k}(x)$:\n$$ r_{Y_k}(x) = \\rho D_k \\frac{d^2 Y_{k,\\text{pred}}}{dx^2} + \\left( - \\rho D_k \\frac{d^2 Y_{k,\\text{true}}}{dx^2} \\right) = \\rho D_k \\left( \\frac{d^2 Y_{k,\\text{pred}}}{dx^2} - \\frac{d^2 Y_{k,\\text{true}}}{dx^2} \\right) $$\n设预测误差为 $\\delta Y_k(x) = Y_{k,\\text{pred}}(x) - Y_{k,\\text{true}}(x)$。残差简化为：\n$$ r_{Y_k}(x) = \\rho D_k \\frac{d^2 (\\delta Y_k)}{dx^2} $$\n\n对于能量残差 $r_T(x)$:\n$$ r_T(x) = k_t \\frac{d^2 T_{\\text{pred}}}{dx^2} + \\sum_{k=1}^K h_k \\omega_k(x) + \\left( - k_t \\frac{d^2 T_{\\text{true}}}{dx^2} - \\sum_{k=1}^K h_k \\omega_k(x) \\right) = k_t \\left( \\frac{d^2 T_{\\text{pred}}}{dx^2} - \\frac{d^2 T_{\\text{true}}}{dx^2} \\right) $$\n设预测误差为 $\\delta T(x) = T_{\\text{pred}}(x) - T_{\\text{true}}(x)$。残差简化为：\n$$ r_T(x) = k_t \\frac{d^2 (\\delta T)}{dx^2} $$\n\n程序的实现将通过计算每个测试用例的误差函数（$\\delta T$, $\\delta Y_k$）的解析二阶导数，在 $N=200$ 个配置点上评估残差，然后计算指定的 $L_2$ 范数。边界条件失配则直接根据误差函数在 $x=0$ 和 $x=1$ 处的值计算。\n\n误差函数的解析导数如下：\n**测试用例 1:**\n- $\\delta T(x) = 0$, $\\delta Y_1(x) = 0$。\n- $\\frac{d^2(\\delta T)}{dx^2} = 0$, $\\frac{d^2(\\delta Y_1)}{dx^2} = 0$。\n- 因此，所有残差和边界失配均为 $0$。\n\n**测试用例 2:**\n- $\\delta T(x) = \\epsilon_T \\sin(13 \\pi x)$，其中 $\\epsilon_T = 0.1$。\n- $\\frac{d^2(\\delta T)}{dx^2} = - \\epsilon_T (13\\pi)^2 \\sin(13 \\pi x) = -169 \\pi^2 \\epsilon_T \\sin(13 \\pi x)$。\n- $\\delta Y_1(x) = \\epsilon_{Y_1} \\sin(11 \\pi x)$，其中 $\\epsilon_{Y_1} = 10^{-4}$。\n- $\\frac{d^2(\\delta Y_1)}{dx^2} = - \\epsilon_{Y_1} (11\\pi)^2 \\sin(11 \\pi x) = -121 \\pi^2 \\epsilon_{Y_1} \\sin(11 \\pi x)$。\n- 在边界上，对于整数 $n$，$\\sin(n\\pi x)$ 在 $x=0$ 和 $x=1$ 处均为 $0$。因此，边界失配 $\\mathrm{BC}_T$ 和 $\\mathrm{BC}_{Y_1}$ 均为 $0$。\n\n**测试用例 3:**\n- $\\delta T(x) = \\epsilon_T \\cos(\\pi x)$，其中 $\\epsilon_T = 0.5$。\n- $\\frac{d^2(\\delta T)}{dx^2} = - \\epsilon_T \\pi^2 \\cos(\\pi x)$。\n- $\\delta Y_1(x) = \\epsilon_{Y_1} \\cos(\\pi x)$，其中 $\\epsilon_{Y_1} = 10^{-3}$。\n- $\\frac{d^2(\\delta Y_1)}{dx^2} = - \\epsilon_{Y_1} \\pi^2 \\cos(\\pi x)$。\n- $\\delta Y_2(x) = \\epsilon_{Y_2} \\cos(\\pi x)$，其中 $\\epsilon_{Y_2} = 5 \\times 10^{-4}$。\n- $\\frac{d^2(\\delta Y_2)}{dx^2} = - \\epsilon_{Y_2} \\pi^2 \\cos(\\pi x)$。\n- 在边界上，$\\delta(x) = \\epsilon \\cos(\\pi x)$ 得到 $\\delta(0) = \\epsilon$ 和 $\\delta(1) = -\\epsilon$。\n- 边界失配范数为 $\\sqrt{\\frac{1}{2}(\\epsilon^2 + (-\\epsilon)^2)} = |\\epsilon|$。\n- 因此，$\\mathrm{BC}_T = |\\epsilon_T| = 0.5$，$\\mathrm{BC}_{Y_1} = |\\epsilon_{Y_1}| = 0.001$，且 $\\mathrm{BC}_{Y_2} = |\\epsilon_{Y_2}| = 0.0005$。\n\n程序将为每个测试用例实现这些计算，将结果组装成指定的列表嵌套列表结构，并打印最终格式化的字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_case_1(x_grid, pi):\n    \"\"\"\n    Calculates results for Test Case 1.\n    \"\"\"\n    # Parameters\n    # K = 1\n    # rho = 1.0\n    # kt = 0.1\n    # D1 = 1.0e-5\n    # h1 = -1.0e6\n\n    # Perturbations are zero\n    # delta_T(x) = 0, delta_Y1(x) = 0\n    # The derivatives are also zero.\n    \n    # Residuals are zero\n    rT_L2 = 0.0\n    rY1_L2 = 0.0\n    \n    # Boundary mismatches are zero\n    bcT = 0.0\n    bcY1 = 0.0\n    \n    return [rT_L2, [rY1_L2], bcT, [bcY1]]\n\ndef calculate_case_2(x_grid, pi):\n    \"\"\"\n    Calculates results for Test Case 2.\n    \"\"\"\n    # Parameters\n    # K = 1\n    rho = 1.2\n    kt = 0.08\n    D1 = 2.0e-5\n    # h1 = -8.0e5\n    eps_T = 0.1\n    eps_Y1 = 1.0e-4\n\n    # Calculate residuals\n    # r_T(x) = kt * d^2(delta_T)/dx^2\n    # delta_T(x) = eps_T * sin(13*pi*x)\n    # d^2(delta_T)/dx^2 = -eps_T * (13*pi)^2 * sin(13*pi*x)\n    d2_delta_T_dx2 = -eps_T * (13 * pi)**2 * np.sin(13 * pi * x_grid)\n    rT_values = kt * d2_delta_T_dx2\n    rT_L2 = np.sqrt(np.mean(rT_values**2))\n\n    # r_Y1(x) = rho * D1 * d^2(delta_Y1)/dx^2\n    # delta_Y1(x) = eps_Y1 * sin(11*pi*x)\n    # d^2(delta_Y1)/dx^2 = -eps_Y1 * (11*pi)^2 * sin(11*pi*x)\n    d2_delta_Y1_dx2 = -eps_Y1 * (11 * pi)**2 * np.sin(11 * pi * x_grid)\n    rY1_values = rho * D1 * d2_delta_Y1_dx2\n    rY1_L2 = np.sqrt(np.mean(rY1_values**2))\n    \n    # Calculate boundary mismatches\n    # delta_T(x) = eps_T * sin(13*pi*x)\n    delta_T_at_0 = 0.0  # sin(0)\n    delta_T_at_1 = 0.0  # sin(13*pi)\n    bcT = np.sqrt(0.5 * (delta_T_at_0**2 + delta_T_at_1**2))\n    \n    # delta_Y1(x) = eps_Y1 * sin(11*pi*x)\n    delta_Y1_at_0 = 0.0  # sin(0)\n    delta_Y1_at_1 = 0.0  # sin(11*pi)\n    bcY1 = np.sqrt(0.5 * (delta_Y1_at_0**2 + delta_Y1_at_1**2))\n    \n    return [rT_L2, [rY1_L2], bcT, [bcY1]]\n    \ndef calculate_case_3(x_grid, pi):\n    \"\"\"\n    Calculates results for Test Case 3.\n    \"\"\"\n    # Parameters\n    # K = 2\n    rho = 0.9\n    kt = 0.12\n    D = [1.0e-5, 5.0e-6]\n    # h = [-8.0e5, -1.2e6]\n    eps_T = 0.5\n    eps_Y = [1.0e-3, 5.0e-4]\n\n    # Calculate temperature residual\n    # delta_T(x) = eps_T * cos(pi*x)\n    # d^2(delta_T)/dx^2 = -eps_T * pi^2 * cos(pi*x)\n    d2_delta_T_dx2 = -eps_T * pi**2 * np.cos(pi * x_grid)\n    rT_values = kt * d2_delta_T_dx2\n    rT_L2 = np.sqrt(np.mean(rT_values**2))\n\n    # Calculate species residuals\n    rY_L2_list = []\n    # All species have same perturbation form: delta_Y_k(x) = eps_Yk * cos(pi*x)\n    d2_delta_Y_common_part_dx2 = -pi**2 * np.cos(pi * x_grid)\n    for k in range(2):\n        d2_delta_Yk_dx2 = eps_Y[k] * d2_delta_Y_common_part_dx2\n        rYk_values = rho * D[k] * d2_delta_Yk_dx2\n        rYk_L2 = np.sqrt(np.mean(rYk_values**2))\n        rY_L2_list.append(rYk_L2)\n\n    # Calculate boundary mismatches\n    # For a perturbation delta(x) = epsilon * cos(pi*x), the BC norm is |epsilon|\n    bcT = np.abs(eps_T)\n    bcY_list = [np.abs(eps_Y[k]) for k in range(2)]\n    \n    return [rT_L2, rY_L2_list, bcT, bcY_list]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define common parameters\n    N = 200\n    x_grid = np.linspace(0.0, 1.0, N)\n    pi = np.pi\n\n    # Run all test cases\n    results = [\n        calculate_case_1(x_grid, pi),\n        calculate_case_2(x_grid, pi),\n        calculate_case_3(x_grid, pi)\n    ]\n\n    # Format the output string as specified\n    # Convert list of lists to string, then remove spaces\n    output_str = ','.join(map(str, results))\n    final_output_str = f\"[{output_str}]\".replace(\" \", \"\")\n\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}