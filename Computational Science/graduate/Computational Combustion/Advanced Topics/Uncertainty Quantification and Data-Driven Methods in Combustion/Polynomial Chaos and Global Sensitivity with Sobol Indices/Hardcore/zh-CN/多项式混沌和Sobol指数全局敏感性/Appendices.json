{
    "hands_on_practices": [
        {
            "introduction": "多项式混沌展开（PCE）的计算成本直接取决于其基函数集的大小。这个实践练习将引导您直面所谓的“维度灾难”，这是在高维不确定性量化中遇到的一个核心挑战。通过亲手计算和比较三种常用截断策略（张量积、总阶数和双曲交叉）下的基函数数量 ，您将深刻理解为何稀疏截断方案对于使 PCE 在实际工程问题中可行至关重要。",
            "id": "4051964",
            "problem": "在计算燃烧学中，对模型可观测量（例如从未燃到已燃混合物的层流火焰速度 $S_L$）进行不确定性量化时，通常采用多项式混沌展开（PCE）来表示其对不确定性输入的依赖关系。考虑 $d=10$ 个独立的、标准化的不确定性输入，用向量 $\\boldsymbol{\\xi} = (\\xi_{1},\\dots,\\xi_{10})$ 表示，并使用在最大多项式阶数 $p=3$ 处截断的多元正交多项式基函数构建一个 PCE。三种常见的截断策略为多重索引 $\\boldsymbol{\\alpha} = (\\alpha_{1},\\dots,\\alpha_{d}) \\in \\mathbb{N}_{0}^{d}$ 定义了索引集，用以选择保留哪些多元多项式：\n- 张量积截断保留所有满足 $0 \\le \\alpha_{i} \\le p$（对于所有 $i \\in \\{1,\\dots,d\\}$）的多重索引。\n- 全阶截断保留所有满足 $\\sum_{i=1}^{d} \\alpha_{i} \\le p$ 的多重索引。\n- 双曲交叉截断（经典乘法形式）保留所有满足 $\\prod_{i=1}^{d} (\\alpha_{i}+1) \\le p+1$ 的多重索引。\n\n从这些核心定义出发，计算在 $d=10$ 和 $p=3$ 的条件下，每种截断策略所保留的基函数的数量。然后，计算这三个基函数数量之和，得到一个单一标量值。将此和作为您的最终答案，以精确整数形式给出，无需四舍五入。在您的推理过程中，讨论构建 PCE 和使用 Sobol 指数进行全局敏感性分析（GSA）的计算影响，重点关注截断策略的选择如何影响样本复杂度和交互项的保真度。",
            "solution": "该问题要求计算在给定维度 $d=10$ 和最大多项式阶数 $p=3$ 的情况下，三种不同的多项式混沌展开（PCE）截断策略的基函数数量。最终答案是这三个数量的总和。此外，还需要讨论其计算影响。\n\n首先，我们验证问题陈述。\n给定条件如下：\n-   维度（不确定性输入）数量：$d=10$。\n-   最大多项式阶数：$p=3$。\n-   多重索引向量：$\\boldsymbol{\\alpha} = (\\alpha_{1},\\dots,\\alpha_{d}) \\in \\mathbb{N}_{0}^{d}$。\n-   张量积截断规则：对于所有 $i \\in \\{1,\\dots,d\\}$，$0 \\le \\alpha_{i} \\le p$。\n-   全阶截断规则：$\\sum_{i=1}^{d} \\alpha_{i} \\le p$。\n-   双曲交叉截断规则：$\\prod_{i=1}^{d} (\\alpha_{i}+1) \\le p+1$。\n\n该问题在科学上基于不确定性量化这一成熟领域，特别是 PCE 的应用。截断方案的定义是标准的。该问题是适定的，因为计算唯一的精确整数解所需的所有参数（$d$，$p$）和定义均已提供。语言客观而精确。因此，该问题被认为是有效的，并将提供解答。\n\n令 $N_{TP}$、$N_{TO}$ 和 $N_{HC}$ 分别表示张量积、全阶和双曲交叉截断策略下保留的基函数数量（即多重索引集的大小）。\n\n1.  **张量积（TP）截断**\n    规则是对于每个 $i \\in \\{1, \\dots, d\\}$，$0 \\le \\alpha_{i} \\le p$。\n    对于多重索引 $\\boldsymbol{\\alpha}$ 的每个分量 $\\alpha_{i}$，有 $p+1$ 个可能的整数值：$0, 1, \\dots, p$。由于有 $d$ 个独立分量，可能的多重索引总数是每个分量选择数量的乘积。\n    $$N_{TP} = (p+1)^{d}$$\n    代入给定值 $d=10$ 和 $p=3$：\n    $$N_{TP} = (3+1)^{10} = 4^{10} = (2^{2})^{10} = 2^{20} = 1,048,576$$\n\n2.  **全阶（TO）截断**\n    规则是 $\\sum_{i=1}^{d} \\alpha_{i} \\le p$。\n    这是一个经典的组合问题，即计算一个不等式的非负整数解的数量。通过引入一个松弛变量 $\\alpha_{d+1} \\ge 0$，该不等式可以转换为一个等式：\n    $$\\sum_{i=1}^{d} \\alpha_{i} + \\alpha_{d+1} = p$$\n    解的数量由多重集系数公式给出，该公式通常使用“星与杠”方法推导得出。将 $p$ 个物品（星）放入 $d+1$ 个箱子（由 $d$ 个杠分隔）的方法数是：\n    $$N_{TO} = \\binom{p+(d+1)-1}{(d+1)-1} = \\binom{p+d}{d}$$\n    代入给定值 $d=10$ 和 $p=3$：\n    $$N_{TO} = \\binom{3+10}{10} = \\binom{13}{10} = \\binom{13}{13-10} = \\binom{13}{3}$$\n    $$N_{TO} = \\frac{13!}{3!(13-3)!} = \\frac{13 \\times 12 \\times 11}{3 \\times 2 \\times 1} = 13 \\times 2 \\times 11 = 286$$\n\n3.  **双曲交叉（HC）截断**\n    规则是 $\\prod_{i=1}^{d} (\\alpha_{i}+1) \\le p+1$。\n    令 $k_{i} = \\alpha_{i}+1$。由于 $\\alpha_{i} \\ge 0$，每个 $k_{i}$ 必须是大于或等于 $1$ 的整数。条件变为：\n    $$\\prod_{i=1}^{10} k_{i} \\le 3+1 = 4$$\n    我们必须计算满足此条件的整数向量 $(k_{1}, \\dots, k_{10})$ 的数量，其中每个 $k_{i} \\ge 1$。乘积可以是 $1$、$2$、$3$ 或 $4$。\n\n    -   情况1：$\\prod k_{i} = 1$。这只有在所有 $k_{i}=1$ 时才可能。这对应于所有 $\\alpha_{i}=0$ 的单个多重索引。解的数量：$1$。\n\n    -   情况2：$\\prod k_{i} = 2$。这要求一个 $k_j=2$，而所有其他 $k_i=1$（对于 $i \\ne j$）。索引 $j$ 的选择方式有 $\\binom{10}{1}$ 种。如果 $k_j=2$，则 $\\alpha_j=1$。这对应于具有单个非零元素等于 $1$ 的多重索引。解的数量：$\\binom{10}{1} = 10$。\n\n    -   情况3：$\\prod k_{i} = 3$。这要求一个 $k_j=3$，而所有其他 $k_i=1$。这可以通过 $\\binom{10}{1}$ 种方式完成。如果 $k_j=3$，则 $\\alpha_j=2$。这对应于具有单个非零元素等于 $2$ 的多重索引。解的数量：$\\binom{10}{1} = 10$。\n\n    -   情况4：$\\prod k_{i} = 4$。这可以通过两种方式实现：\n        -   一个 $k_j=4$，而所有其他 $k_i=1$。索引 $j$ 的选择方式有 $\\binom{10}{1}=10$ 种。这对应于具有单个非零元素等于 $3$ 的多重索引。解的数量：$10$。\n        -   两个不同的索引（例如 $j$ 和 $l$）满足 $k_j=2$ 和 $k_l=2$，而所有其他 $k_i=1$。索引对 $(j, l)$ 的选择方式有 $\\binom{10}{2}$ 种。这对应于具有两个非零元素且均等于 $1$ 的多重索引。解的数量：$\\binom{10}{2} = \\frac{10 \\times 9}{2} = 45$。\n        情况4总计：$10 + 45 = 55$。\n\n    将所有情况的计数相加，得到 HC 截断的基函数总数：\n    $$N_{HC} = 1 + 10 + 10 + 55 = 76$$\n\n4.  **总和与讨论**\n    三种基的大小的总和是：\n    $$\\text{Sum} = N_{TP} + N_{TO} + N_{HC} = 1,048,576 + 286 + 76 = 1,048,938$$\n\n    **对PCE和GSA的计算影响：**\n    基函数的数量（我们用 $P$ 表示）是决定构建 PCE 模型计算成本的关键因素。对于非侵入式方法，对完整计算模型（例如燃烧模拟）进行评估所需的次数与 $P$ 成正比。最小二乘回归的一个通用法则是使用至少 $2P$ 个样本。\n\n    -   对于一个 $10$ 维问题，**张量积**的大小 $N_{TP} \\approx 10^6$ 是一个天文数字。除了最简单的解析函数外，构建这样的 PCE 在计算上是不可行的，这种现象被称为“维度灾难”。\n\n    -   **全阶**截断将基集显著减少到 $N_{TO} = 286$。这个数量通常是可控的，使得 TO 成为处理中等高维问题的标准且实用的选择。它基于一个启发式原则：高阶交互项（例如 $\\xi_1^2 \\xi_2^2$，其中 $\\sum \\alpha_i=4 > p=3$）对模型输出方差的贡献小于低阶项。\n\n    -   **双曲交叉**截断更为精简，得出 $N_{HC} = 76$。它基于一个更强的假设：即涉及多个变量的交互项，即使其总多项式阶数较低，也不那么重要。我们的计算表明，对于 $p=3$，HC 基包括最高 $3$ 阶的单变量项（例如 $\\alpha_i=3$）和最高 $2$ 阶的双变量交互项（例如 $\\alpha_i=1, \\alpha_j=1$），但不包括涉及三个或更多变量的交互项（例如，$\\alpha_i=1, \\alpha_j=1, \\alpha_k=1$ 会得到 $\\prod (1+\\alpha) = 8 > 4$）。\n\n    对于使用 Sobol 指数进行的**全局敏感性分析（GSA）**，其指数直接从 PCE 系数计算得出，截断策略的选择对结果的保真度有深远影响。模型输出的总方差近似为 PCE 系数（对于标准正交基）的平方和。一阶（$S_i$）和全阶效应（$S_{Ti}$）Sobol 指数将此方差划分到输入变量及其交互作用中。\n    \n    -   原则上，建立在**张量积**网格上的 PCE 可以同时解析每个变量中最高为 $p$ 阶的所有交互作用。\n    -   **全阶** PCE 可以捕获组合阶数最高为 $p$ 的交互作用，这通常足以准确估计一阶和二阶敏感度。对于 $p=3$，它可以捕获像 $\\xi_i \\xi_j \\xi_k$ 和 $\\xi_i^2 \\xi_j$ 这样的项。\n    -   在这种情况下，**双曲交叉** PCE 会将涉及三个或更多变量的交互作用的所有 Sobol 指数估计为恰好为零，因为这些基函数被排除在展开式之外。如果高阶交互作用对于物理可观测量（如 $S_L$）确实很重要，那么基于 HC 的 PCE 将是一个很差的近似，由此产生的 GSA 将会产生误导。\n\n    总之，截断策略的选择代表了计算成本（样本复杂度）与模型内准确表示高阶交互效应能力之间的关键权衡。$N_{TP}$、$N_{TO}$ 和 $N_{HC}$ 之间的巨大差异突显了为什么 TP 不切实际，以及为什么 TO 和 HC 方案是现代不确定性量化中的基本工具。",
            "answer": "$$\\boxed{1048938}$$"
        },
        {
            "introduction": "PCE 的强大功能源于其使用的多项式基函数与不确定性输入的概率分布是“正交”的。本练习将理论付诸实践，展示了如何为一个常见场景——输入在任意区间 $[a,b]$ 上服从均匀分布——构建合适的正交归一基函数。通过从标准的勒让德（Legendre）多项式出发进行推导 ，您将掌握将经典正交多项式应用于特定工程问题的关键变换技巧。",
            "id": "4052005",
            "problem": "考虑一个计算燃烧模型中关于层流预混火焰速度的单参数不确定性，其中主要的不确定性输入是当量比 $x$，它被建模为一个在有界区间 $[a,b]$ 上均匀分布的独立随机变量，其概率密度为 $w(x) = \\frac{1}{b-a}$。为了构建一个适用于通过一阶 Sobol 指数计算全局敏感性分析的多项式混沌展开（PCE），您必须构建一个关于 $[a,b]$ 上均匀测度的标准正交多项式基。从 Legendre 多项式 $P_{n}(s)$ 在 $[-1,1]$ 上构成一个关于权重 $1$ 的正交多项式族，并满足正交关系式\n$$\n\\int_{-1}^{1} P_{n}(s) P_{m}(s) \\,\\mathrm{d}s \\;=\\; \\frac{2}{2n+1}\\,\\delta_{nm},\n$$\n这一经过充分验证的事实出发，请从第一性原理推导，输入变量的仿射变换如何将此正交性映射到关于均匀密度 $w(x)$ 的区间 $[a,b]$ 上，并确定在 $[a,b]$ 上获得标准正交基所需的归一化。具体来说，请以 $x$、$a$ 和 $b$ 的函数形式，构造出缩放后的基函数 $\\psi_{n}(x)$ 的闭合表达式。\n\n您的最终答案必须是 $\\psi_{n}(x)$ 的单个闭合形式解析表达式，不带单位。无需进行数值取整。",
            "solution": "目标是构建在 $[a,b]$ 区间上关于均匀概率密度 $w(x) = \\frac{1}{b-a}$ 的标准正交多项式。此构造的基本基础是 Legendre 多项式 $P_{n}(s)$ 在 $[-1,1]$ 上关于权重 $1$ 的正交性，由下式给出：\n$$\n\\int_{-1}^{1} P_{n}(s) P_{m}(s) \\,\\mathrm{d}s \\;=\\; \\frac{2}{2n+1}\\,\\delta_{nm},\n$$\n其中 $\\delta_{nm}$ 是 Kronecker δ。\n\n为了将区间 $[a,b]$ 映射到 $[-1,1]$，考虑将 $x \\in [a,b]$ 映至 $s \\in [-1,1]$ 的仿射变换：\n$$\ns \\;=\\; \\frac{2x - (a+b)}{b-a}.\n$$\n该映射是双射且线性的，其雅可比为\n$$\n\\frac{\\mathrm{d}s}{\\mathrm{d}x} \\;=\\; \\frac{2}{b-a}, \\quad \\text{因此} \\quad \\mathrm{d}x \\;=\\; \\frac{b-a}{2}\\,\\mathrm{d}s.\n$$\n\n通过将 Legendre 多项式与此仿射映射复合，定义在 $[a,b]$ 上的候选基函数：\n$$\n\\phi_{n}(x) \\;=\\; P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right).\n$$\n我们检验它们关于均匀密度 $w(x) = \\frac{1}{b-a}$ 的正交性。在 $w$ 下，$\\phi_{n}$ 和 $\\phi_{m}$ 的内积为\n\\begin{align*}\n\\langle \\phi_{n}, \\phi_{m} \\rangle\n\\;=\\; \\int_{a}^{b} \\phi_{n}(x)\\,\\phi_{m}(x)\\, w(x)\\,\\mathrm{d}x \\\\\n\\;=\\; \\int_{a}^{b} P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right)\\, P_{m}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right)\\, \\frac{1}{b-a}\\,\\mathrm{d}x.\n\\end{align*}\n通过变量替换 $s = \\frac{2x - (a+b)}{b-a}$，我们有 $x \\in [a,b] \\mapsto s \\in [-1,1]$ 以及 $\\mathrm{d}x = \\frac{b-a}{2}\\,\\mathrm{d}s$，因此\n\\begin{align*}\n\\langle \\phi_{n}, \\phi_{m} \\rangle\n\\;=\\; \\int_{-1}^{1} P_{n}(s)\\,P_{m}(s)\\,\\frac{1}{b-a}\\,\\frac{b-a}{2}\\,\\mathrm{d}s \\\\\n\\;=\\; \\frac{1}{2} \\int_{-1}^{1} P_{n}(s)\\,P_{m}(s)\\,\\mathrm{d}s \\\\\n\\;=\\; \\frac{1}{2}\\,\\frac{2}{2n+1}\\,\\delta_{nm} \\\\\n\\;=\\; \\frac{1}{2n+1}\\,\\delta_{nm}.\n\\end{align*}\n因此，函数 $\\phi_{n}(x)$ 关于 $w(x)$ 是正交的，其范数的平方为 $\\|\\phi_{n}\\|^{2} = \\frac{1}{2n+1}$。\n\n为了使基是标准正交的，我们引入一个归一化常数 $c_{n}$ 并定义\n$$\n\\psi_{n}(x) \\;=\\; c_{n}\\, P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right).\n$$\n我们要求 $\\langle \\psi_{n}, \\psi_{m} \\rangle = \\delta_{nm}$，这得到\n\\begin{align*}\n\\langle \\psi_{n}, \\psi_{m} \\rangle\n\\;=\\; c_{n} c_{m}\\, \\langle \\phi_{n}, \\phi_{m} \\rangle \\\\\n\\;=\\; c_{n} c_{m}\\, \\frac{1}{2n+1}\\,\\delta_{nm}.\n\\end{align*}\n对于 $n=m$ 的情况，这变为 $c_{n}^{2}\\,\\frac{1}{2n+1} = 1$，因此\n$$\nc_{n} \\;=\\; \\sqrt{2n+1}.\n$$\n因此，通过对 Legendre 多项式进行仿射变换，在 $[a,b]$ 上获得的关于均匀密度 $w(x) = \\frac{1}{b-a}$ 的标准正交多项式基是\n$$\n\\psi_{n}(x) \\;=\\; \\sqrt{2n+1}\\; P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right).\n$$\n\n这个缩放后的基确保了在适用于 $[a,b]$ 上均匀分布的概率测度下的标准正交性，这对于构建多项式混沌展开 (PCE) 系数至关重要，这些系数直接支持计算燃烧模型中的方差分解和 Sobol 指数计算。",
            "answer": "$$\\boxed{\\psi_{n}(x) \\;=\\; \\sqrt{2n+1}\\; P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right)}$$"
        },
        {
            "introduction": "在许多应用中，构建 PCE 模型的最终目的是进行全局敏感性分析（GSA）。本练习为您提供一个已拟合好的燃烧问题 PCE 模型，您的任务是计算一阶和总效应 Sobol 指数，从而量化每个输入参数对模型输出的影响。这项实践侧重于不确定性量化工作流程中至关重要的最后一步：从模型系数中提取富有洞察力的敏感性信息 。",
            "id": "4051949",
            "problem": "考虑一个计算燃烧学的场景，其中点火延迟时间（由随机输出变量 $\\tau$ 表示）依赖于四个独立的不确定性输入。这些输入代表了在一系列工况范围内物理相关参数的归一化版本：当量比、初始温度、压力和有效活化能。设这些输入为标准化随机变量 $\\boldsymbol{\\xi} = (\\xi_1,\\xi_2,\\xi_3,\\xi_4)$，其中每个 $\\xi_i$ 独立地服从区间 $[-1,1]$ 上的标准均匀分布。$\\tau$ 的近似值是通过多项式混沌展开（Polynomial Chaos Expansion, PCE）获得的，该展开使用由归一化勒让德（Legendre）多项式构建的正交多元基，使得基函数在由独立输入诱导的乘积测度下是正交的。展开式形式如下\n$$\n\\tau(\\boldsymbol{\\xi}) = c_{\\boldsymbol{0}} + \\sum_{\\boldsymbol{\\alpha}\\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}} \\,\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}),\n$$\n其中 $\\boldsymbol{\\alpha} = (\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4)$ 是一个非负整数的多重索引，表示每个输入的多项式次数，$\\Psi_{\\boldsymbol{\\alpha}}$ 是相应的正交多元基函数，$c_{\\boldsymbol{\\alpha}} \\in \\mathbb{R}$ 是展开系数。假设输入变量是独立的，基是正交的，并且下面给出的 PCE 系数是在工况范围内通过统计上可靠的回归拟合得到的输出。目标是使用 PCE 表示计算每个输入的一阶 Sobol 指数和全效应 Sobol 指数，并解释哪些输入对点火正时的影响最大。\n\n用作基本依据的定义：\n- 令 $\\operatorname{Var}(\\tau)$ 表示 $\\tau$ 的方差。\n- 将输入 $i$ 的一阶 Sobol 指数定义为 $S_i = \\dfrac{\\operatorname{Var}(\\mathbb{E}[\\tau \\mid \\xi_i])}{\\operatorname{Var}(\\tau)}$。\n- 将输入 $i$ 的全效应 Sobol 指数定义为 $S_{T_i} = 1 - \\dfrac{\\operatorname{Var}(\\mathbb{E}[\\tau \\mid \\boldsymbol{\\xi}_{-i}])}{\\operatorname{Var}(\\tau)}$，其中 $\\boldsymbol{\\xi}_{-i}$ 表示除 $\\xi_i$ 之外的所有输入的向量。\n- 如果 $\\operatorname{Var}(\\tau) = 0$，则将该情况下所有的 Sobol 指数定义为 $0$。\n\n在下面的每个测试用例中，维度为 4，输入是独立的标准均匀分布，基是归一化的勒让德混沌。每个测试用例以 $(\\boldsymbol{\\alpha}, c_{\\boldsymbol{\\alpha}})$ 对的形式给出非零 PCE 项的列表，包括 $\\boldsymbol{\\alpha}=\\boldsymbol{0}=(0,0,0,0)$ 的常数项。\n\n测试套件：\n- 情况 A（具有混合贡献的中等工况条件）：\n  - $((0,0,0,0),\\,1.0)$\n  - $((1,0,0,0),\\,0.40)$\n  - $((2,0,0,0),\\,0.10)$\n  - $((0,1,0,0),\\,0.60)$\n  - $((0,2,0,0),\\,0.15)$\n  - $((0,0,1,0),\\,0.20)$\n  - $((0,0,2,0),\\,0.05)$\n  - $((0,0,0,1),\\,0.05)$\n  - $((1,1,0,0),\\,0.25)$\n  - $((0,1,1,0),\\,0.10)$\n  - $((0,1,0,1),\\,0.08)$\n  - $((1,0,1,0),\\,0.06)$\n  - $((0,0,1,1),\\,0.04)$\n  - $((1,1,1,0),\\,0.12)$\n- 情况 B（变异性可忽略的边界情况）：\n  - $((0,0,0,0),\\,0.8)$\n- 情况 C（相互作用主导的机制）：\n  - $((0,0,0,0),\\,1.2)$\n  - $((1,0,0,0),\\,0.05)$\n  - $((0,1,0,0),\\,0.05)$\n  - $((0,0,1,0),\\,0.05)$\n  - $((0,0,0,1),\\,0.05)$\n  - $((1,1,0,0),\\,0.40)$\n  - $((1,0,1,0),\\,0.35)$\n  - $((1,0,0,1),\\,0.30)$\n  - $((0,1,1,0),\\,0.32)$\n  - $((0,1,0,1),\\,0.28)$\n  - $((0,0,1,1),\\,0.25)$\n  - $((1,1,1,0),\\,0.20)$\n  - $((1,1,0,1),\\,0.18)$\n  - $((1,1,1,1),\\,0.15)$\n- 情况 D（具有微弱耦合的单参数主导）：\n  - $((0,0,0,0),\\,0.9)$\n  - $((0,1,0,0),\\,0.90)$\n  - $((0,2,0,0),\\,0.30)$\n  - $((0,1,1,0),\\,0.10)$\n\n任务：\n1. 对于每个测试用例，使用 PCE 计算一阶 Sobol 指数 $S_1,S_2,S_3,S_4$ 和全效应 Sobol 指数 $S_{T_1},S_{T_2},S_{T_3},S_{T_4}$。利用 PCE 基的正交性和输入的独立性来获得所需的方差。\n2. 以四舍五入到六位小数的浮点数形式提供最终数值输出。\n3. 为便于理解的解释：根据计算出的指数，定性地确定在每种情况下哪个输入对 $\\tau$ 的影响最大，以及这种影响主要是加性的（一阶）还是通过相互作用（全效应与一阶之差）。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一对列表：一个用于一阶指数，一个用于全效应指数。总输出应为一个包含四个元素的列表，每个元素的形式为 $[[S_1,S_2,S_3,S_4],[S_{T_1},S_{T_2},S_{T_3},S_{T_4}]]$，所有数字都四舍五入到六位小数，且不含任何空格。\n- 结构形式示例（非实际值）：$[[[0.100000,0.200000,0.300000,0.400000],[0.500000,0.600000,0.700000,0.800000]],\\ldots]$。\n\n所有 Sobol 指数都是无量纲的；输出中不需要物理单位。不出现角度。不得使用百分比；将指数表示为十进制浮点数。在情况 B 中，当 $\\operatorname{Var}(\\tau)=0$ 时，将所有指数报告为 $0.000000$。",
            "solution": "所提出的问题是不确定性量化（uncertainty quantification）领域一个有效且适定的练习，具体涉及从多项式混沌展开（Polynomial Chaos Expansion, PCE）计算全局敏感度指数。其前提在科学上基于已建立的 PCE 和 Sobol 指数的数学理论，这些是计算科学与工程（包括计算燃烧学领域）中的标准工具。所有必要的数据，包括几个测试用例的 PCE 系数，都已提供，并且待计算量的定义是精确和标准的。该问题是客观的，没有歧义。因此，我们可以进行形式化的求解。\n\n问题的核心在于利用给定的正交 PCE 的性质来高效计算 Sobol 敏感度指数。点火延迟时间 $\\tau$ 的 PCE 如下所示：\n$$\n\\tau(\\boldsymbol{\\xi}) = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}} c_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\n$$\n其中 $\\boldsymbol{\\xi} = (\\xi_1, \\xi_2, \\xi_3, \\xi_4)$ 是在 $[-1, 1]$ 上均匀分布的独立随机变量，$\\Psi_{\\boldsymbol{\\alpha}}$ 是正交基函数，$c_{\\boldsymbol{\\alpha}}$ 是展开系数，$\\boldsymbol{\\alpha}$ 是多重索引。\n\n基的正交性意味着 $\\mathbb{E}[\\Psi_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\beta}}] = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$，其中 $\\delta$ 是克罗内克（Kronecker）delta，期望 $\\mathbb{E}[\\cdot]$ 是对 $\\boldsymbol{\\xi}$ 的分布求得的。常数基函数是 $\\Psi_{\\boldsymbol{0}} = 1$。因此，输出的均值是 $\\mathbb{E}[\\tau] = c_{\\boldsymbol{0}}$。\n\n$\\tau$ 的总方差，记为 $D_{\\text{tot}}$，可以计算为：\n$$\nD_{\\text{tot}} = \\operatorname{Var}(\\tau) = \\mathbb{E}[(\\tau - \\mathbb{E}[\\tau])^2] = \\mathbb{E}\\left[\\left(\\sum_{\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\alpha}}\\right)^2\\right]\n$$\n由于正交性，这简化为对应于非恒定基函数的系数的平方和：\n$$\nD_{\\text{tot}} = \\sum_{\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\n$$\n如果 $D_{\\text{tot}} = 0$，则输出为常数，所有敏感度指数都定义为 $0$。\n\nSobol 指数量化了每个输入变量对输出总方差的贡献。PCE 结构提供了到方差分析（Analysis of Variance, ANOVA）分解的直接映射，这些指数就是从该分解中计算出来的。\n\n一阶 Sobol 指数 $S_i$ 衡量了输入 $\\xi_i$ 对输出方差的主效应。它是在 PCE 中仅依赖于 $\\xi_i$ 的项所引起的方差占总方差的比例。仅与 $\\xi_i$ 相关的部分方差 $D_i$ 是多重索引 $\\boldsymbol{\\alpha}$ 中只有第 $i$ 个分量非零的系数的平方和。\n$$\nD_i = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i} c_{\\boldsymbol{\\alpha}}^2, \\quad \\text{其中 } \\mathcal{A}_i = \\{\\boldsymbol{\\alpha} \\mid \\alpha_i > 0 \\text{ and } \\alpha_j = 0 \\text{ for } j \\neq i\\}\n$$\n则一阶指数为：\n$$\nS_i = \\frac{D_i}{D_{\\text{tot}}}\n$$\n\n全效应 Sobol 指数 $S_{T_i}$ 衡量了输入 $\\xi_i$ 对输出方差的总贡献，包括其主效应及其与所有其他变量的相互作用。与所有涉及 $\\xi_i$ 的项相关的部分方差 $D_{T_i}$ 是多重索引 $\\boldsymbol{\\alpha}$ 中第 $i$ 个分量非零的系数的平方和。\n$$\nD_{T_i} = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_{T_i}} c_{\\boldsymbol{\\alpha}}^2, \\quad \\text{其中 } \\mathcal{A}_{T_i} = \\{\\boldsymbol{\\alpha} \\mid \\alpha_i > 0\\}\n$$\n则全效应指数为：\n$$\nS_{T_i} = \\frac{D_{T_i}}{D_{\\text{tot}}}\n$$\n$S_{T_i} - S_i$ 的差值量化了 $\\xi_i$ 与其他变量相互作用所产生的方差贡献。我们将此方法应用于每个测试用例。\n\n**情况 A：中等工况条件**\n已给出非零系数。首先，我们通过对所有非常数项系数的平方求和来计算总方差 $D_{\\text{tot}}$：\n$D_{\\text{tot}} = 0.40^2 + 0.10^2 + 0.60^2 + 0.15^2 + 0.20^2 + 0.05^2 + 0.05^2 + 0.25^2 + 0.10^2 + 0.08^2 + 0.06^2 + 0.04^2 + 0.12^2 = 0.696$\n\n接下来，我们计算每个输入 $i \\in \\{1, 2, 3, 4\\}$ 的部分方差。\n对于 $\\xi_1$：\n$D_1 = 0.40^2 + 0.10^2 = 0.17$\n$D_{T_1} = (0.40^2 + 0.10^2) + 0.25^2 + 0.06^2 + 0.12^2 = 0.2505$\n对于 $\\xi_2$：\n$D_2 = 0.60^2 + 0.15^2 = 0.3825$\n$D_{T_2} = (0.60^2 + 0.15^2) + 0.25^2 + 0.10^2 + 0.08^2 + 0.12^2 = 0.4758$\n对于 $\\xi_3$：\n$D_3 = 0.20^2 + 0.05^2 = 0.0425$\n$D_{T_3} = (0.20^2 + 0.05^2) + 0.10^2 + 0.06^2 + 0.04^2 + 0.12^2 = 0.0721$\n对于 $\\xi_4$：\n$D_4 = 0.05^2 = 0.0025$\n$D_{T_4} = 0.05^2 + 0.08^2 + 0.04^2 = 0.0105$\n\nSobol 指数为：\n$S_1 = 0.17 / 0.696 \\approx 0.244253$, $S_{T_1} = 0.2505 / 0.696 \\approx 0.360201$\n$S_2 = 0.3825 / 0.696 \\approx 0.549569$, $S_{T_2} = 0.4758 / 0.696 \\approx 0.683621$\n$S_3 = 0.0425 / 0.696 \\approx 0.061063$, $S_{T_3} = 0.0721 / 0.696 \\approx 0.103592$\n$S_4 = 0.0025 / 0.696 \\approx 0.003592$, $S_{T_4} = 0.0105 / 0.696 \\approx 0.015086$\n解释：输入 $\\xi_2$（很可能是初始温度）是影响最大的参数，其主效应贡献了约 $55\\%$ 的方差，总效应贡献了 $68\\%$。输入 $\\xi_1$（可能是当量比）位居第二，具有显著的主效应和相互作用效应。输入 $\\xi_3$（压力）影响较小，而 $\\xi_4$（活化能）几乎可以忽略不计。\n\n**情况 B：边界情况**\n只给出了一个系数：$c_{(0,0,0,0)} = 0.8$。由于这是常数项，没有其他非零系数。\n$D_{\\text{tot}} = \\sum_{\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2 = 0$。\n根据问题定义，当总方差为零时，所有 Sobol 指数均为零。\n$S_i = [0.0, 0.0, 0.0, 0.0]$ 且 $S_{T_i} = [0.0, 0.0, 0.0, 0.0]$。\n解释：输出是一个常数值。输入对其变异性没有影响，因为不存在变异性。\n\n**情况 C：相互作用主导的机制**\n总方差为：\n$D_{\\text{tot}} = 4 \\times (0.05^2) + 0.40^2 + 0.35^2 + 0.30^2 + 0.32^2 + 0.28^2 + 0.25^2 + 0.20^2 + 0.18^2 + 0.15^2 = 0.7207$。\n\n部分方差为：\n对于 $\\xi_1$：$D_1 = 0.05^2 = 0.0025$, $D_{T_1} = 0.05^2 + 0.40^2 + 0.35^2 + 0.30^2 + 0.20^2 + 0.18^2 + 0.15^2 = 0.4699$\n对于 $\\xi_2$：$D_2 = 0.05^2 = 0.0025$, $D_{T_2} = 0.05^2 + 0.40^2 + 0.32^2 + 0.28^2 + 0.20^2 + 0.18^2 + 0.15^2 = 0.4382$\n对于 $\\xi_3$：$D_3 = 0.05^2 = 0.0025$, $D_{T_3} = 0.05^2 + 0.35^2 + 0.32^2 + 0.25^2 + 0.20^2 + 0.15^2 = 0.3524$\n对于 $\\xi_4$：$D_4 = 0.05^2 = 0.0025$, $D_{T_4} = 0.05^2 + 0.30^2 + 0.28^2 + 0.25^2 + 0.18^2 + 0.15^2 = 0.2883$\n\nSobol 指数为：\n$S_1 = S_2 = S_3 = S_4 = 0.0025 / 0.7207 \\approx 0.003469$\n$S_{T_1} = 0.4699 / 0.7207 \\approx 0.651936$\n$S_{T_2} = 0.4382 / 0.7207 \\approx 0.607951$\n$S_{T_3} = 0.3524 / 0.7207 \\approx 0.488970$\n$S_{T_4} = 0.2883 / 0.7207 \\approx 0.399958$\n解释：一阶指数可以忽略不计，而全效应指数很大。这表明输出方差几乎完全由输入参数之间的相互作用驱动，而非它们的个体效应。所有输入都显著地参与了这些相互作用，其中 $\\xi_1$ 的总影响最大。\n\n**情况 D：单参数主导**\n总方差为：\n$D_{\\text{tot}} = 0.90^2 + 0.30^2 + 0.10^2 = 0.91$。\n\n部分方差为：\n对于 $\\xi_1$：没有项涉及 $\\xi_1$。$D_1=0$, $D_{T_1}=0$。\n对于 $\\xi_2$：$D_2 = 0.90^2 + 0.30^2 = 0.90$, $D_{T_2} = (0.90^2 + 0.30^2) + 0.10^2 = 0.91$。\n对于 $\\xi_3$：没有项仅依赖于 $\\xi_3$。$D_3=0$。$D_{T_3} = 0.10^2 = 0.01$。\n对于 $\\xi_4$：没有项涉及 $\\xi_4$。$D_4=0$, $D_{T_4}=0$。\n\nSobol 指数为：\n$S_1=0.0$, $S_{T_1}=0.0$\n$S_2 = 0.90 / 0.91 \\approx 0.989011$, $S_{T_2} = 0.91 / 0.91 = 1.0$\n$S_3 = 0.0 / 0.91 = 0.0$, $S_{T_3} = 0.01 / 0.91 \\approx 0.010989$\n$S_4=0.0$, $S_{T_4}=0.0$\n解释：输入 $\\xi_2$ 占绝对主导地位，其主效应贡献了约 $99\\%$ 的方差，总效应贡献了 $100\\%$。该模型在 $\\xi_2$ 上几乎是加性的。$\\xi_2$ 和 $\\xi_3$ 之间存在非常小的相互作用，这使得 $\\xi_3$ 有一个极小的总效应。输入 $\\xi_1$ 和 $\\xi_4$ 对输出方差没有影响。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for Sobol indices from Polynomial Chaos Expansions for multiple test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        [\n            ((0,0,0,0), 1.0), ((1,0,0,0), 0.40), ((2,0,0,0), 0.10),\n            ((0,1,0,0), 0.60), ((0,2,0,0), 0.15), ((0,0,1,0), 0.20),\n            ((0,0,2,0), 0.05), ((0,0,0,1), 0.05), ((1,1,0,0), 0.25),\n            ((0,1,1,0), 0.10), ((0,1,0,1), 0.08), ((1,0,1,0), 0.06),\n            ((0,0,1,1), 0.04), ((1,1,1,0), 0.12)\n        ],\n        # Case B\n        [\n            ((0,0,0,0), 0.8)\n        ],\n        # Case C\n        [\n            ((0,0,0,0), 1.2), ((1,0,0,0), 0.05), ((0,1,0,0), 0.05),\n            ((0,0,1,0), 0.05), ((0,0,0,1), 0.05), ((1,1,0,0), 0.40),\n            ((1,0,1,0), 0.35), ((1,0,0,1), 0.30), ((0,1,1,0), 0.32),\n            ((0,1,0,1), 0.28), ((0,0,1,1), 0.25), ((1,1,1,0), 0.20),\n            ((1,1,0,1), 0.18), ((1,1,1,1), 0.15)\n        ],\n        # Case D\n        [\n            ((0,0,0,0), 0.9), ((0,1,0,0), 0.90), ((0,2,0,0), 0.30),\n            ((0,1,1,0), 0.10)\n        ]\n    ]\n\n    all_results = []\n    \n    for case_coeffs in test_cases:\n        coeffs = {alpha: c for alpha, c in case_coeffs}\n        dim = 4\n\n        # Calculate total variance\n        total_variance = sum(c**2 for alpha, c in coeffs.items() if any(a > 0 for a in alpha))\n\n        if total_variance == 0:\n            s_indices = [0.0] * dim\n            st_indices = [0.0] * dim\n            all_results.append([s_indices, st_indices])\n            continue\n\n        s_indices = []\n        st_indices = []\n\n        for i in range(dim):\n            # First-order partial variance\n            d_i = 0\n            # Total-effect partial variance\n            d_ti = 0\n\n            for alpha, c in coeffs.items():\n                if any(a > 0 for a in alpha):  # Exclude constant term\n                    \n                    # Check for total effect: alpha_i > 0\n                    if alpha[i] > 0:\n                        d_ti += c**2\n                        \n                        # Check for first-order effect: only alpha_i > 0\n                        is_first_order = True\n                        for j in range(dim):\n                            if i != j and alpha[j] > 0:\n                                is_first_order = False\n                                break\n                        if is_first_order:\n                            d_i += c**2\n            \n            s_indices.append(d_i / total_variance)\n            st_indices.append(d_ti / total_variance)\n\n        all_results.append([s_indices, st_indices])\n\n    # Format the final output string exactly as required\n    case_results_str = []\n    for case_result in all_results:\n        s_list_str = f\"[{','.join([f'{s:.6f}' for s in case_result[0]])}]\"\n        st_list_str = f\"[{','.join([f'{st:.6f}' for st in case_result[1]])}]\"\n        case_results_str.append(f\"[{s_list_str},{st_list_str}]\")\n    \n    final_output = f\"[{','.join(case_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}