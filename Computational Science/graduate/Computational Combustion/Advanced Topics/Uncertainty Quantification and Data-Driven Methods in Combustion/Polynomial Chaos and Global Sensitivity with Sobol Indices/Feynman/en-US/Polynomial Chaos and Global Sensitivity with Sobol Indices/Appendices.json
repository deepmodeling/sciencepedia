{
    "hands_on_practices": [
        {
            "introduction": "The first practical hurdle in applying Polynomial Chaos Expansions to complex, high-dimensional models like those in combustion is managing the sheer number of basis functions. This exercise  provides a concrete look at the \"curse of dimensionality\" by comparing the enormous size of a full tensor-product basis with more practical alternatives. Understanding this contrast is key to appreciating why efficient truncation strategies are essential for making PCE a feasible tool for uncertainty quantification.",
            "id": "4051964",
            "problem": "In computational combustion, uncertainty quantification of a model observable, such as the unburned-to-burned mixture laminar flame speed $S_{L}$, often employs Polynomial Chaos Expansion (PCE) to represent dependence on uncertain inputs. Consider $d=10$ independent, standardized uncertain inputs, denoted by the vector $\\boldsymbol{\\xi} = (\\xi_{1},\\dots,\\xi_{10})$, and a PCE constructed using multivariate orthogonal polynomial basis functions truncated at maximum polynomial degree $p=3$. Three common truncation strategies define index sets for multi-indices $\\boldsymbol{\\alpha} = (\\alpha_{1},\\dots,\\alpha_{d}) \\in \\mathbb{N}_{0}^{d}$ that select which multivariate polynomials are retained:\n- Tensor-product truncation retains all multi-indices satisfying $0 \\le \\alpha_{i} \\le p$ for all $i \\in \\{1,\\dots,d\\}$.\n- Total-order truncation retains all multi-indices satisfying $\\sum_{i=1}^{d} \\alpha_{i} \\le p$.\n- Hyperbolic-cross truncation (classical multiplicative form) retains all multi-indices satisfying $\\prod_{i=1}^{d} (\\alpha_{i}+1) \\le p+1$.\n\nStarting from these core definitions, count the number of retained basis functions under each truncation strategy for $d=10$ and $p=3$. Then, compute the single scalar quantity given by the sum of the three basis sizes. Provide this sum as your final answer, expressed as an exact integer with no rounding. In your reasoning, discuss the computational implications for constructing PCE and for Global Sensitivity Analysis (GSA) with Sobol indices, focusing on how the choice of truncation affects sample complexity and the fidelity of interaction terms.",
            "solution": "The problem requires the calculation of the number of basis functions for three different Polynomial Chaos Expansion (PCE) truncation strategies, given a dimension $d=10$ and maximum polynomial degree $p=3$. The final answer is the sum of these three counts. Additionally, a discussion on the computational implications is required.\n\nFirst, we validate the problem statement.\nThe givens are:\n-   Number of dimensions (uncertain inputs): $d=10$.\n-   Maximum polynomial degree: $p=3$.\n-   Multi-index vector: $\\boldsymbol{\\alpha} = (\\alpha_{1},\\dots,\\alpha_{d}) \\in \\mathbb{N}_{0}^{d}$.\n-   Tensor-product truncation rule: $0 \\le \\alpha_{i} \\le p$ for all $i \\in \\{1,\\dots,d\\}$.\n-   Total-order truncation rule: $\\sum_{i=1}^{d} \\alpha_{i} \\le p$.\n-   Hyperbolic-cross truncation rule: $\\prod_{i=1}^{d} (\\alpha_{i}+1) \\le p+1$.\n\nThe problem is scientifically grounded in the established field of uncertainty quantification, specifically using PCEs. The definitions of the truncation schemes are standard. The problem is well-posed, as all necessary parameters ($d$, $p$) and definitions are provided to compute a unique, exact integer solution. The language is objective and precise. Therefore, the problem is deemed valid and a solution will be provided.\n\nLet $N_{TP}$, $N_{TO}$, and $N_{HC}$ denote the number of retained basis functions (i.e., the cardinality of the multi-index set) for the tensor-product, total-order, and hyperbolic-cross truncation strategies, respectively.\n\n1.  **Tensor-Product (TP) Truncation**\n    The rule is $0 \\le \\alpha_{i} \\le p$ for each $i \\in \\{1, \\dots, d\\}$.\n    For each component $\\alpha_{i}$ of the multi-index $\\boldsymbol{\\alpha}$, there are $p+1$ possible integer values: $0, 1, \\dots, p$. Since there are $d$ independent components, the total number of possible multi-indices is the product of the number of choices for each component.\n    $$N_{TP} = (p+1)^{d}$$\n    Substituting the given values $d=10$ and $p=3$:\n    $$N_{TP} = (3+1)^{10} = 4^{10} = (2^{2})^{10} = 2^{20} = 1,048,576$$\n\n2.  **Total-Order (TO) Truncation**\n    The rule is $\\sum_{i=1}^{d} \\alpha_{i} \\le p$.\n    This is a classic combinatorial problem of counting the number of non-negative integer solutions to an inequality. By introducing a slack variable $\\alpha_{d+1} \\ge 0$, the inequality can be converted to an equation:\n    $$\\sum_{i=1}^{d} \\alpha_{i} + \\alpha_{d+1} = p$$\n    The number of solutions is given by the multiset coefficient formula, often derived using a \"stars and bars\" argument. The number of ways to place $p$ items (stars) into $d+1$ bins (separated by $d$ bars) is:\n    $$N_{TO} = \\binom{p+(d+1)-1}{(d+1)-1} = \\binom{p+d}{d}$$\n    Substituting the given values $d=10$ and $p=3$:\n    $$N_{TO} = \\binom{3+10}{10} = \\binom{13}{10} = \\binom{13}{13-10} = \\binom{13}{3}$$\n    $$N_{TO} = \\frac{13!}{3!(13-3)!} = \\frac{13 \\times 12 \\times 11}{3 \\times 2 \\times 1} = 13 \\times 2 \\times 11 = 286$$\n\n3.  **Hyperbolic-Cross (HC) Truncation**\n    The rule is $\\prod_{i=1}^{d} (\\alpha_{i}+1) \\le p+1$.\n    Let $k_{i} = \\alpha_{i}+1$. Since $\\alpha_{i} \\ge 0$, each $k_{i}$ must be an integer greater than or equal to $1$. The condition becomes:\n    $$\\prod_{i=1}^{10} k_{i} \\le 3+1 = 4$$\n    We must count the number of integer vectors $(k_{1}, \\dots, k_{10})$ satisfying this condition, where each $k_{i} \\ge 1$. The product can be $1$, $2$, $3$, or $4$.\n\n    -   Case 1: $\\prod k_{i} = 1$. This is only possible if all $k_{i}=1$. This corresponds to a single multi-index where all $\\alpha_{i}=0$. Number of solutions: $1$.\n\n    -   Case 2: $\\prod k_{i} = 2$. This requires one $k_j=2$ and all other $k_i=1$ for $i \\ne j$. The index $j$ can be chosen in $\\binom{10}{1}$ ways. If $k_j=2$, then $\\alpha_j=1$. This corresponds to multi-indices with a single non-zero element equal to $1$. Number of solutions: $\\binom{10}{1} = 10$.\n\n    -   Case 3: $\\prod k_{i} = 3$. This requires one $k_j=3$ and all other $k_i=1$. This can be done in $\\binom{10}{1}$ ways. If $k_j=3$, then $\\alpha_j=2$. This corresponds to multi-indices with a single non-zero element equal to $2$. Number of solutions: $\\binom{10}{1} = 10$.\n\n    -   Case 4: $\\prod k_{i} = 4$. This can be achieved in two ways:\n        -   One $k_j=4$ and all other $k_i=1$. The index $j$ can be chosen in $\\binom{10}{1}=10$ ways. This corresponds to multi-indices with a single non-zero element equal to $3$. Number of solutions: $10$.\n        -   Two distinct indices, say $j$ and $l$, have $k_j=2$ and $k_l=2$, while all other $k_i=1$. The pair of indices $(j, l)$ can be chosen in $\\binom{10}{2}$ ways. This corresponds to multi-indices with two non-zero elements, both equal to $1$. Number of solutions: $\\binom{10}{2} = \\frac{10 \\times 9}{2} = 45$.\n        Total for Case 4: $10 + 45 = 55$.\n\n    Summing the counts from all cases gives the total number of basis functions for HC truncation:\n    $$N_{HC} = 1 + 10 + 10 + 55 = 76$$\n\n4.  **Total Sum and Discussion**\n    The sum of the three basis sizes is:\n    $$\\text{Sum} = N_{TP} + N_{TO} + N_{HC} = 1,048,576 + 286 + 76 = 1,048,938$$\n\n    **Computational Implications for PCE and GSA:**\n    The number of basis functions, which we denote by $P$, is a critical factor determining the computational cost of constructing a PCE model. For non-intrusive methods, the number of required evaluations of the full computational model (e.g., a combustion simulation) scales with $P$. A common rule for least-squares regression is to use at least $2P$ samples.\n\n    -   The **Tensor-Product** size $N_{TP} \\approx 10^6$ is astronomically large for a $10$-dimensional problem. Constructing such a PCE is computationally infeasible for all but the simplest analytical functions, a phenomenon known as the \"curse of dimensionality\".\n\n    -   The **Total-Order** truncation significantly reduces the basis set to $N_{TO} = 286$. This number is often manageable, making TO a standard and practical choice for moderately high-dimensional problems. It operates on the heuristic principle that higher-order interaction terms (e.g., $\\xi_1^2 \\xi_2^2$ where $\\sum \\alpha_i=4 > p=3$) contribute less to the model output variance than lower-order terms.\n\n    -   The **Hyperbolic-Cross** truncation is even more parsimonious, yielding $N_{HC} = 76$. It is based on the stronger assumption that interaction terms involving many variables are less important, even if their total polynomial order is low. Our calculation shows that for $p=3$, the HC basis includes univariate terms up to degree $3$ (e.g., $\\alpha_i=3$) and bivariate interactions up to degree $2$ (e.g., $\\alpha_i=1, \\alpha_j=1$), but no interactions involving three or more variables (e.g., $\\alpha_i=1, \\alpha_j=1, \\alpha_k=1$ would give $\\prod (1+\\alpha) = 8 > 4$).\n\n    For **Global Sensitivity Analysis (GSA)** using Sobol indices, which are computed directly from the PCE coefficients, the choice of truncation has profound effects on the fidelity of the results. The total variance of the model output is approximated by the sum of the squares of the PCE coefficients (for an orthonormal basis). First-order ($S_i$) and total-effect ($S_{T_i}$) Sobol indices partition this variance among the input variables and their interactions.\n    \n    -   A PCE built on a **Tensor-Product** grid could, in principle, resolve all interactions up to degree $p$ in each variable simultaneously.\n    -   A **Total-Order** PCE can capture interactions of combined degree up to $p$, which is often sufficient for accurate estimation of first-order and second-order sensitivities. For $p=3$, it captures terms like $\\xi_i \\xi_j \\xi_k$ and $\\xi_i^2 \\xi_j$.\n    -   A **Hyperbolic-Cross** PCE, in this case, would estimate all Sobol indices for interactions of three or more variables to be exactly zero, as these basis functions are excluded from the expansion. If high-order interactions are indeed significant for the physical observable (like $S_L$), the HC-based PCE will be a poor approximation, and the resulting GSA will be misleading.\n\n    In conclusion, the choice of truncation strategy represents a critical trade-off between computational cost (sample complexity) and the ability to accurately represent high-order interaction effects within the model. The dramatic difference between $N_{TP}$, $N_{TO}$, and $N_{HC}$ highlights why TP is impractical and why TO and HC schemes are essential tools in modern uncertainty quantification.",
            "answer": "$$\\boxed{1048938}$$"
        },
        {
            "introduction": "A Polynomial Chaos Expansion derives its power from the orthogonality of its basis functions with respect to the probability distributions of the uncertain inputs. This exercise  demonstrates the essential technique of adapting a standard polynomial family to a custom input distribution using a simple affine transformation. Mastering this foundational step is crucial for constructing a valid PCE surrogate that accurately decomposes model variance.",
            "id": "4052005",
            "problem": "Consider a one-parameter uncertainty in a computational combustion model for the laminar premixed flame speed, where the dominant uncertain input is the equivalence ratio $x$ modeled as an independent random variable uniformly distributed on the bounded interval $[a,b]$, with probability density $w(x) = \\frac{1}{b-a}$. In order to construct a Polynomial Chaos Expansion (PCE) suitable for computing global sensitivity via first-order Sobol indices, you must build an orthonormal polynomial basis with respect to the uniform measure on $[a,b]$. Starting from the well-tested facts that the Legendre polynomials $P_{n}(s)$ form an orthogonal polynomial family on $[-1,1]$ with respect to the weight $1$ and satisfy the orthogonality relation\n$$\n\\int_{-1}^{1} P_{n}(s) P_{m}(s) \\,\\mathrm{d}s \\;=\\; \\frac{2}{2n+1}\\,\\delta_{nm},\n$$\nderive, from first principles, how an affine transformation of the input variable maps this orthogonality to the interval $[a,b]$ with respect to the uniform density $w(x)$, and determine the normalization required to obtain an orthonormal basis on $[a,b]$. Specifically, construct the scaled basis functions $\\psi_{n}(x)$ in closed form as functions of $x$, $a$, and $b$.\n\nYour final answer must be a single closed-form analytic expression for $\\psi_{n}(x)$, with no units. No numerical rounding is required.",
            "solution": "The goal is to construct orthonormal polynomials on $[a,b]$ with respect to the uniform probability density $w(x) = \\frac{1}{b-a}$. The fundamental base for this construction is the orthogonality of the Legendre polynomials $P_{n}(s)$ on $[-1,1]$ with respect to the weight $1$, given by\n$$\n\\int_{-1}^{1} P_{n}(s) P_{m}(s) \\,\\mathrm{d}s \\;=\\; \\frac{2}{2n+1}\\,\\delta_{nm},\n$$\nwhere $\\delta_{nm}$ is the Kronecker delta.\n\nTo map the interval $[a,b]$ to $[-1,1]$, consider the affine transformation that sends $x \\in [a,b]$ to $s \\in [-1,1]$:\n$$\ns \\;=\\; \\frac{2x - (a+b)}{b-a}.\n$$\nThis mapping is bijective and linear, with Jacobian\n$$\n\\frac{\\mathrm{d}s}{\\mathrm{d}x} \\;=\\; \\frac{2}{b-a}, \\quad \\text{so} \\quad \\mathrm{d}x \\;=\\; \\frac{b-a}{2}\\,\\mathrm{d}s.\n$$\n\nDefine the candidate basis functions on $[a,b]$ by composing the Legendre polynomials with this affine map:\n$$\n\\phi_{n}(x) \\;=\\; P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right).\n$$\nWe examine their orthogonality with respect to the uniform density $w(x) = \\frac{1}{b-a}$. The inner product of $\\phi_{n}$ and $\\phi_{m}$ under $w$ is\n\\begin{align*}\n\\langle \\phi_{n}, \\phi_{m} \\rangle\n&\\;=\\; \\int_{a}^{b} \\phi_{n}(x)\\,\\phi_{m}(x)\\, w(x)\\,\\mathrm{d}x \\\\\n&\\;=\\; \\int_{a}^{b} P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right)\\, P_{m}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right)\\, \\frac{1}{b-a}\\,\\mathrm{d}x.\n\\end{align*}\nWith the change of variables $s = \\frac{2x - (a+b)}{b-a}$, we have $x \\in [a,b] \\mapsto s \\in [-1,1]$ and $\\mathrm{d}x = \\frac{b-a}{2}\\,\\mathrm{d}s$, so\n\\begin{align*}\n\\langle \\phi_{n}, \\phi_{m} \\rangle\n&\\;=\\; \\int_{-1}^{1} P_{n}(s)\\,P_{m}(s)\\,\\frac{1}{b-a}\\,\\frac{b-a}{2}\\,\\mathrm{d}s \\\\\n&\\;=\\; \\frac{1}{2} \\int_{-1}^{1} P_{n}(s)\\,P_{m}(s)\\,\\mathrm{d}s \\\\\n&\\;=\\; \\frac{1}{2}\\,\\frac{2}{2n+1}\\,\\delta_{nm} \\\\\n&\\;=\\; \\frac{1}{2n+1}\\,\\delta_{nm}.\n\\end{align*}\nThus, the functions $\\phi_{n}(x)$ are orthogonal with respect to $w(x)$, with squared norms $\\|\\phi_{n}\\|^{2} = \\frac{1}{2n+1}$.\n\nTo make the basis orthonormal, we introduce a normalization constant $c_{n}$ and define\n$$\n\\psi_{n}(x) \\;=\\; c_{n}\\, P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right).\n$$\nWe require $\\langle \\psi_{n}, \\psi_{m} \\rangle = \\delta_{nm}$, which yields\n\\begin{align*}\n\\langle \\psi_{n}, \\psi_{m} \\rangle\n&\\;=\\; c_{n} c_{m}\\, \\langle \\phi_{n}, \\phi_{m} \\rangle \\\\\n&\\;=\\; c_{n} c_{m}\\, \\frac{1}{2n+1}\\,\\delta_{nm}.\n\\end{align*}\nFor $n=m$, this becomes $c_{n}^{2}\\,\\frac{1}{2n+1} = 1$, hence\n$$\nc_{n} \\;=\\; \\sqrt{2n+1}.\n$$\nTherefore, the orthonormal polynomial basis on $[a,b]$ with respect to the uniform density $w(x) = \\frac{1}{b-a}$, obtained by affine transformation from the Legendre polynomials, is\n$$\n\\psi_{n}(x) \\;=\\; \\sqrt{2n+1}\\; P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right).\n$$\n\nThis scaled basis ensures orthonormality under the probability measure appropriate for the uniform distribution on $[a,b]$, which is essential for constructing Polynomial Chaos Expansion (PCE) coefficients that directly support variance decomposition and the computation of Sobol indices in computational combustion models.",
            "answer": "$$\\boxed{\\psi_{n}(x) \\;=\\; \\sqrt{2n+1}\\; P_{n}\\!\\left(\\frac{2x - (a+b)}{b-a}\\right)}$$"
        },
        {
            "introduction": "Once a PCE surrogate model is built, its coefficients contain a wealth of information about how input uncertainties affect the output. This hands-on exercise  guides you through the final and most insightful step: calculating global sensitivity indices directly from the PCE coefficients. By working through different scenarios, you will learn to interpret first-order and total-effect Sobol indices to diagnose the behavior of complex models and identify the most influential parameters.",
            "id": "4051949",
            "problem": "Consider a computational combustion setting in which the ignition delay time, denoted by the random output variable $\\tau$, depends on four independent uncertain inputs that represent normalized versions of physically relevant parameters across an operating range: equivalence ratio, initial temperature, pressure, and effective activation energy. Let these inputs be the standardized random variables $\\boldsymbol{\\xi} = (\\xi_1,\\xi_2,\\xi_3,\\xi_4)$ with each $\\xi_i$ independently distributed as a standard uniform variable on the interval $[-1,1]$. The approximation of $\\tau$ is obtained through a Polynomial Chaos Expansion (PCE) using an orthonormal multivariate basis built from normalized Legendre polynomials, such that the basis functions are orthonormal under the product measure induced by the independent inputs. The expansion is of the form\n$$\n\\tau(\\boldsymbol{\\xi}) = c_{\\boldsymbol{0}} + \\sum_{\\boldsymbol{\\alpha}\\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}} \\,\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}),\n$$\nwhere $\\boldsymbol{\\alpha} = (\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4)$ is a multi-index of nonnegative integers indicating the polynomial degrees in each input, $\\Psi_{\\boldsymbol{\\alpha}}$ is the corresponding orthonormal multivariate basis function, and $c_{\\boldsymbol{\\alpha}} \\in \\mathbb{R}$ are the expansion coefficients. Assume the input variables are independent, the basis is orthonormal, and the PCE coefficients given below are the output of a statistically sound regression fit over the operating range. The goal is to compute first-order Sobol indices and total-effect Sobol indices for each input, using the PCE representation, and to interpret which inputs most influence the ignition timing.\n\nDefinitions to be used as the fundamental base:\n- Let $\\operatorname{Var}(\\tau)$ denote the variance of $\\tau$.\n- Define the first-order Sobol index for input $i$ as $S_i = \\dfrac{\\operatorname{Var}(\\mathbb{E}[\\tau \\mid \\xi_i])}{\\operatorname{Var}(\\tau)}$.\n- Define the total-effect Sobol index for input $i$ as $S_{T_i} = 1 - \\dfrac{\\operatorname{Var}(\\mathbb{E}[\\tau \\mid \\boldsymbol{\\xi}_{-i}])}{\\operatorname{Var}(\\tau)}$, where $\\boldsymbol{\\xi}_{-i}$ denotes the vector of all inputs except $\\xi_i$.\n- If $\\operatorname{Var}(\\tau) = 0$, define all Sobol indices for that case to be $0$.\n\nIn every test case below, the dimension is $4$, the inputs are independent and standard uniform, and the basis is the normalized Legendre chaos. Each test case provides the list of nonzero PCE terms as pairs $(\\boldsymbol{\\alpha}, c_{\\boldsymbol{\\alpha}})$, including the constant term with $\\boldsymbol{\\alpha}=\\boldsymbol{0}=(0,0,0,0)$.\n\nTest Suite:\n- Case A (moderate operating condition with mixed contributions):\n  - $((0,0,0,0),\\,1.0)$\n  - $((1,0,0,0),\\,0.40)$\n  - $((2,0,0,0),\\,0.10)$\n  - $((0,1,0,0),\\,0.60)$\n  - $((0,2,0,0),\\,0.15)$\n  - $((0,0,1,0),\\,0.20)$\n  - $((0,0,2,0),\\,0.05)$\n  - $((0,0,0,1),\\,0.05)$\n  - $((1,1,0,0),\\,0.25)$\n  - $((0,1,1,0),\\,0.10)$\n  - $((0,1,0,1),\\,0.08)$\n  - $((1,0,1,0),\\,0.06)$\n  - $((0,0,1,1),\\,0.04)$\n  - $((1,1,1,0),\\,0.12)$\n- Case B (boundary case with negligible variability):\n  - $((0,0,0,0),\\,0.8)$\n- Case C (interaction-dominated regime):\n  - $((0,0,0,0),\\,1.2)$\n  - $((1,0,0,0),\\,0.05)$\n  - $((0,1,0,0),\\,0.05)$\n  - $((0,0,1,0),\\,0.05)$\n  - $((0,0,0,1),\\,0.05)$\n  - $((1,1,0,0),\\,0.40)$\n  - $((1,0,1,0),\\,0.35)$\n  - $((1,0,0,1),\\,0.30)$\n  - $((0,1,1,0),\\,0.32)$\n  - $((0,1,0,1),\\,0.28)$\n  - $((0,0,1,1),\\,0.25)$\n  - $((1,1,1,0),\\,0.20)$\n  - $((1,1,0,1),\\,0.18)$\n  - $((1,1,1,1),\\,0.15)$\n- Case D (single-parameter dominance with minor coupling):\n  - $((0,0,0,0),\\,0.9)$\n  - $((0,1,0,0),\\,0.90)$\n  - $((0,2,0,0),\\,0.30)$\n  - $((0,1,1,0),\\,0.10)$\n\nTasks:\n1. For each test case, compute the first-order Sobol indices $S_1,S_2,S_3,S_4$ and the total-effect Sobol indices $S_{T_1},S_{T_2},S_{T_3},S_{T_4}$ using the PCE. Use the orthonormality of the PCE basis and the independence of inputs to obtain the needed variances.\n2. Provide the final numerical outputs as floating-point numbers rounded to six decimal places.\n3. Interpretation for understanding: based on the computed indices, determine qualitatively which input most influences $\\tau$ in each case and whether the influence is primarily additive (first-order) or through interactions (difference between total-effect and first-order).\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a pair of lists: one for first-order indices and one for total-effect indices. The overall output should be a list of four elements, each element in the form $[[S_1,S_2,S_3,S_4],[S_{T_1},S_{T_2},S_{T_3},S_{T_4}]]$, with all numbers rounded to six decimal places and without any spaces.\n- Example of structural form (not the actual values): $[[[0.100000,0.200000,0.300000,0.400000],[0.500000,0.600000,0.700000,0.800000]],\\ldots]$.\n\nAll Sobol indices are dimensionless; no physical unit is required in the output. Angles do not appear. Percentages must not be used; express indices as decimal floats. In Case B where $\\operatorname{Var}(\\tau)=0$, report all indices as $0.000000$.",
            "solution": "The problem presented is a valid and well-posed exercise in uncertainty quantification, specifically concerning the computation of global sensitivity indices from a Polynomial Chaos Expansion (PCE). The premises are scientifically grounded in the established mathematical theory of PCE and Sobol' indices, which are standard tools in computational science and engineering, including the field of computational combustion. All necessary data, including the PCE coefficients for several test cases, are provided, and the definitions of the quantities to be computed are precise and standard. The problem is objective and free of ambiguity. We may therefore proceed with a formal solution.\n\nThe core of the problem lies in leveraging the properties of the given orthonormal PCE to efficiently compute Sobol' sensitivity indices. The PCE of the ignition delay time $\\tau$ is given by:\n$$\n\\tau(\\boldsymbol{\\xi}) = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}} c_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\n$$\nwhere $\\boldsymbol{\\xi} = (\\xi_1, \\xi_2, \\xi_3, \\xi_4)$ are independent random variables uniformly distributed on $[-1, 1]$, $\\Psi_{\\boldsymbol{\\alpha}}$ are orthonormal basis functions, $c_{\\boldsymbol{\\alpha}}$ are the expansion coefficients, and $\\boldsymbol{\\alpha}$ are multi-indices.\n\nThe orthonormality of the basis implies $\\mathbb{E}[\\Psi_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\beta}}] = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$, where $\\delta$ is the Kronecker delta and the expectation $\\mathbb{E}[\\cdot]$ is taken over the distribution of $\\boldsymbol{\\xi}$. The constant basis function is $\\Psi_{\\boldsymbol{0}} = 1$. Consequently, the mean of the output is $\\mathbb{E}[\\tau] = c_{\\boldsymbol{0}}$.\n\nThe total variance of $\\tau$, denoted $D_{\\text{tot}}$, can be computed as:\n$$\nD_{\\text{tot}} = \\operatorname{Var}(\\tau) = \\mathbb{E}[(\\tau - \\mathbb{E}[\\tau])^2] = \\mathbb{E}\\left[\\left(\\sum_{\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\alpha}}\\right)^2\\right]\n$$\nDue to orthonormality, this simplifies to the sum of squares of the coefficients corresponding to non-constant basis functions:\n$$\nD_{\\text{tot}} = \\sum_{\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\n$$\nIf $D_{\\text{tot}} = 0$, the output is constant, and all sensitivity indices are defined to be $0$.\n\nSobol' indices quantify the contribution of each input variable to the total variance of the output. The PCE structure provides a direct mapping to the ANOVA (Analysis of Variance) decomposition, from which these indices are calculated.\n\nThe first-order Sobol' index, $S_i$, measures the main effect of input $\\xi_i$ on the output variance. It is the fraction of total variance due to terms in the PCE that depend only on $\\xi_i$. The partial variance, $D_i$, associated with $\\xi_i$ alone is the sum of squares of coefficients for which only the $i$-th component of the multi-index $\\boldsymbol{\\alpha}$ is non-zero.\n$$\nD_i = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i} c_{\\boldsymbol{\\alpha}}^2, \\quad \\text{where } \\mathcal{A}_i = \\{\\boldsymbol{\\alpha} \\mid \\alpha_i > 0 \\text{ and } \\alpha_j = 0 \\text{ for } j \\neq i\\}\n$$\nThe first-order index is then:\n$$\nS_i = \\frac{D_i}{D_{\\text{tot}}}\n$$\n\nThe total-effect Sobol' index, $S_{T_i}$, measures the total contribution of input $\\xi_i$ to the output variance, including its main effect and all its interactions with other variables. The partial variance, $D_{T_i}$, associated with all terms involving $\\xi_i$ is the sum of squares of coefficients for which the $i$-th component of the multi-index $\\boldsymbol{\\alpha}$ is non-zero.\n$$\nD_{T_i} = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_{T_i}} c_{\\boldsymbol{\\alpha}}^2, \\quad \\text{where } \\mathcal{A}_{T_i} = \\{\\boldsymbol{\\alpha} \\mid \\alpha_i > 0\\}\n$$\nThe total-effect index is then:\n$$\nS_{T_i} = \\frac{D_{T_i}}{D_{\\text{tot}}}\n$$\nThe difference $S_{T_i} - S_i$ quantifies the variance contribution from the interactions of $\\xi_i$ with other variables. We apply this methodology to each test case.\n\n**Case A: Moderate Operating Condition**\nThe non-zero coefficients are provided. First, we compute the total variance $D_{\\text{tot}}$ by summing the squares of all non-constant coefficients:\n$D_{\\text{tot}} = 0.40^2 + 0.10^2 + 0.60^2 + 0.15^2 + 0.20^2 + 0.05^2 + 0.05^2 + 0.25^2 + 0.10^2 + 0.08^2 + 0.06^2 + 0.04^2 + 0.12^2 = 0.696$\n\nNext, we compute the partial variances for each input $i \\in \\{1, 2, 3, 4\\}$.\nFor $\\xi_1$:\n$D_1 = 0.40^2 + 0.10^2 = 0.17$\n$D_{T_1} = (0.40^2 + 0.10^2) + 0.25^2 + 0.06^2 + 0.12^2 = 0.2505$\nFor $\\xi_2$:\n$D_2 = 0.60^2 + 0.15^2 = 0.3825$\n$D_{T_2} = (0.60^2 + 0.15^2) + 0.25^2 + 0.10^2 + 0.08^2 + 0.12^2 = 0.4758$\nFor $\\xi_3$:\n$D_3 = 0.20^2 + 0.05^2 = 0.0425$\n$D_{T_3} = (0.20^2 + 0.05^2) + 0.10^2 + 0.06^2 + 0.04^2 + 0.12^2 = 0.0721$\nFor $\\xi_4$:\n$D_4 = 0.05^2 = 0.0025$\n$D_{T_4} = 0.05^2 + 0.08^2 + 0.04^2 = 0.0105$\n\nThe Sobol' indices are:\n$S_1 = 0.17 / 0.696 \\approx 0.244253$, $S_{T_1} = 0.2505 / 0.696 \\approx 0.360201$\n$S_2 = 0.3825 / 0.696 \\approx 0.549569$, $S_{T_2} = 0.4758 / 0.696 \\approx 0.683621$\n$S_3 = 0.0425 / 0.696 \\approx 0.061063$, $S_{T_3} = 0.0721 / 0.696 \\approx 0.103592$\n$S_4 = 0.0025 / 0.696 \\approx 0.003592$, $S_{T_4} = 0.0105 / 0.696 \\approx 0.015086$\nInterpretation: Input $\\xi_2$ (initial temperature, likely) is the most influential parameter, contributing approximately $55\\%$ of the variance through its main effect and $68\\%$ in total. Input $\\xi_1$ (equivalence ratio, perhaps) is second, with significant main and interaction effects. Input $\\xi_3$ (pressure) has a minor effect, and $\\xi_4$ (activation energy) is almost negligible.\n\n**Case B: Boundary Case**\nOnly one coefficient is given: $c_{(0,0,0,0)} = 0.8$. Since this is the constant term, there are no other non-zero coefficients.\n$D_{\\text{tot}} = \\sum_{\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2 = 0$.\nAs per the problem definition, when the total variance is zero, all Sobol' indices are zero.\n$S_i = [0.0, 0.0, 0.0, 0.0]$ and $S_{T_i} = [0.0, 0.0, 0.0, 0.0]$.\nInterpretation: The output is a constant value. The inputs have no effect on its variability, as there is none.\n\n**Case C: Interaction-Dominated Regime**\nThe total variance is:\n$D_{\\text{tot}} = 4 \\times (0.05^2) + 0.40^2 + 0.35^2 + 0.30^2 + 0.32^2 + 0.28^2 + 0.25^2 + 0.20^2 + 0.18^2 + 0.15^2 = 0.7207$.\n\nThe partial variances are:\nFor $\\xi_1$: $D_1 = 0.05^2 = 0.0025$, $D_{T_1} = 0.05^2 + 0.40^2 + 0.35^2 + 0.30^2 + 0.20^2 + 0.18^2 + 0.15^2 = 0.4699$\nFor $\\xi_2$: $D_2 = 0.05^2 = 0.0025$, $D_{T_2} = 0.05^2 + 0.40^2 + 0.32^2 + 0.28^2 + 0.20^2 + 0.18^2 + 0.15^2 = 0.4382$\nFor $\\xi_3$: $D_3 = 0.05^2 = 0.0025$, $D_{T_3} = 0.05^2 + 0.35^2 + 0.32^2 + 0.25^2 + 0.20^2 + 0.15^2 = 0.3524$\nFor $\\xi_4$: $D_4 = 0.05^2 = 0.0025$, $D_{T_4} = 0.05^2 + 0.30^2 + 0.28^2 + 0.25^2 + 0.18^2 + 0.15^2 = 0.2883$\n\nThe Sobol' indices are:\n$S_1 = S_2 = S_3 = S_4 = 0.0025 / 0.7207 \\approx 0.003469$\n$S_{T_1} = 0.4699 / 0.7207 \\approx 0.651936$\n$S_{T_2} = 0.4382 / 0.7207 \\approx 0.607951$\n$S_{T_3} = 0.3524 / 0.7207 \\approx 0.488970$\n$S_{T_4} = 0.2883 / 0.7207 \\approx 0.399958$\nInterpretation: The first-order indices are negligible, while the total-effect indices are large. This indicates that the output variance is almost entirely driven by interactions between the input parameters, not by their individual effects. All inputs participate significantly in these interactions, with $\\xi_1$ having the largest total impact.\n\n**Case D: Single-Parameter Dominance**\nThe total variance is:\n$D_{\\text{tot}} = 0.90^2 + 0.30^2 + 0.10^2 = 0.91$.\n\nThe partial variances are:\nFor $\\xi_1$: No terms involve $\\xi_1$. $D_1=0$, $D_{T_1}=0$.\nFor $\\xi_2$: $D_2 = 0.90^2 + 0.30^2 = 0.90$, $D_{T_2} = (0.90^2 + 0.30^2) + 0.10^2 = 0.91$.\nFor $\\xi_3$: No terms depend only on $\\xi_3$. $D_3=0$. $D_{T_3} = 0.10^2 = 0.01$.\nFor $\\xi_4$: No terms involve $\\xi_4$. $D_4=0$, $D_{T_4}=0$.\n\nThe Sobol' indices are:\n$S_1=0.0$, $S_{T_1}=0.0$\n$S_2 = 0.90 / 0.91 \\approx 0.989011$, $S_{T_2} = 0.91 / 0.91 = 1.0$\n$S_3 = 0.0 / 0.91 = 0.0$, $S_{T_3} = 0.01 / 0.91 \\approx 0.010989$\n$S_4=0.0$, $S_{T_4}=0.0$\nInterpretation: Input $\\xi_2$ is overwhelmingly dominant, accounting for approximately $99\\%$ of the variance through its main effect and $100\\%$ in total. The model is nearly additive in $\\xi_2$. There is a very small interaction between $\\xi_2$ and $\\xi_3$, giving $\\xi_3$ a tiny total effect. Inputs $\\xi_1$ and $\\xi_4$ have no influence on the output variance.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for Sobol indices from Polynomial Chaos Expansions for multiple test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        [\n            ((0,0,0,0), 1.0), ((1,0,0,0), 0.40), ((2,0,0,0), 0.10),\n            ((0,1,0,0), 0.60), ((0,2,0,0), 0.15), ((0,0,1,0), 0.20),\n            ((0,0,2,0), 0.05), ((0,0,0,1), 0.05), ((1,1,0,0), 0.25),\n            ((0,1,1,0), 0.10), ((0,1,0,1), 0.08), ((1,0,1,0), 0.06),\n            ((0,0,1,1), 0.04), ((1,1,1,0), 0.12)\n        ],\n        # Case B\n        [\n            ((0,0,0,0), 0.8)\n        ],\n        # Case C\n        [\n            ((0,0,0,0), 1.2), ((1,0,0,0), 0.05), ((0,1,0,0), 0.05),\n            ((0,0,1,0), 0.05), ((0,0,0,1), 0.05), ((1,1,0,0), 0.40),\n            ((1,0,1,0), 0.35), ((1,0,0,1), 0.30), ((0,1,1,0), 0.32),\n            ((0,1,0,1), 0.28), ((0,0,1,1), 0.25), ((1,1,1,0), 0.20),\n            ((1,1,0,1), 0.18), ((1,1,1,1), 0.15)\n        ],\n        # Case D\n        [\n            ((0,0,0,0), 0.9), ((0,1,0,0), 0.90), ((0,2,0,0), 0.30),\n            ((0,1,1,0), 0.10)\n        ]\n    ]\n\n    all_results = []\n    \n    for case_coeffs in test_cases:\n        coeffs = {alpha: c for alpha, c in case_coeffs}\n        dim = 4\n\n        # Calculate total variance\n        total_variance = sum(c**2 for alpha, c in coeffs.items() if any(a > 0 for a in alpha))\n\n        if total_variance == 0:\n            s_indices = [0.0] * dim\n            st_indices = [0.0] * dim\n            all_results.append([s_indices, st_indices])\n            continue\n\n        s_indices = []\n        st_indices = []\n\n        for i in range(dim):\n            # First-order partial variance\n            d_i = 0\n            # Total-effect partial variance\n            d_ti = 0\n\n            for alpha, c in coeffs.items():\n                if any(a > 0 for a in alpha):  # Exclude constant term\n                    \n                    # Check for total effect: alpha_i > 0\n                    if alpha[i] > 0:\n                        d_ti += c**2\n                        \n                        # Check for first-order effect: only alpha_i > 0\n                        is_first_order = True\n                        for j in range(dim):\n                            if i != j and alpha[j] > 0:\n                                is_first_order = False\n                                break\n                        if is_first_order:\n                            d_i += c**2\n            \n            s_indices.append(d_i / total_variance)\n            st_indices.append(d_ti / total_variance)\n\n        all_results.append([s_indices, st_indices])\n\n    # Format the final output string exactly as required\n    case_results_str = []\n    for case_result in all_results:\n        s_list_str = f\"[{','.join([f'{s:.6f}' for s in case_result[0]])}]\"\n        st_list_str = f\"[{','.join([f'{st:.6f}' for st in case_result[1]])}]\"\n        case_results_str.append(f\"[{s_list_str},{st_list_str}]\")\n    \n    final_output = f\"[{','.join(case_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}