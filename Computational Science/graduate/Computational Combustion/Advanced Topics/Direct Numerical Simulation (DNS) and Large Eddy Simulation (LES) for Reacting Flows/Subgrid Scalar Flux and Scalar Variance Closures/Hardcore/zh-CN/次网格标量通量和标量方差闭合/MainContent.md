## 引言
在[大涡模拟（LES）](@entry_id:273295)中，准确捕捉[湍流](@entry_id:151300)与[标量场](@entry_id:151443)（如温度和[组分浓度](@entry_id:197022)）之间的复杂相互作用是模拟[反应流](@entry_id:190741)（尤其是燃烧过程）的核心挑战。当我们将控制方程进行[空间滤波](@entry_id:202429)时，会不可避免地产生一系列无法直接计算的“亚格子尺度”（SGS）项，它们代表了未解析的小尺度[湍流](@entry_id:151300)对宏观流动的影响。如何为这些项建立精确且鲁棒的数学模型，特别是如何封闭亚格子[标量通量](@entry_id:1131249)和亚格子[标量方差](@entry_id:1131255)，是决定LES预测成败的关键，也是本文旨在解决的核心问题。

本文将带领读者系统性地探索亚格子闭合模型的理论与实践。我们首先将在 **“原理与机制”** 一章中，深入剖析这些未封闭项的来源，阐明为何在密度变化的流动中必须采用法弗滤波，并详细介绍[梯度扩散假说](@entry_id:1125716)、动态程序、[标量方差](@entry_id:1131255)[输运方程](@entry_id:174281)等关键闭合模型背后的物理思想与数学构建。随后，在 **“应用与跨学科联系”** 一章中，我们将展示这些理论模型如何在湍流燃烧、地球物理及大气科学等前沿领域中发挥作用，解决从预测火焰长度到模拟气候“灰色地带”等实际问题。最后，**“动手实践”** 部分提供了一系列精心设计的练习，旨在帮助读者将理论知识转化为解决具体问题的能力。通过这一结构化的学习路径，读者将对亚格子标量闭合这一计算燃烧学中的基石概念建立起深刻而全面的理解。

## 原理与机制

在大涡模拟（LES）中，控制方程通过空间滤波进行处理，将流场分解为解析的大尺度[部分和](@entry_id:162077)需要建模的亚格子尺度（SGS）部分。本章将深入探讨在模拟[湍流反应流](@entry_id:1133520)（尤其是燃烧过程）时，对两个关键的未解析项——亚格子标量通量和亚格子[标量方差](@entry_id:1131255)——进行建[模的基](@entry_id:156416)本原理和核心机制。这些闭合模型是连接已解析尺度动力学与未解析尺度物理效应的桥梁，对预测的准确性至关重要。

### 滤波操作与亚格子项的产生

在[可压缩反应流](@entry_id:1122760)中，任何输运标量（例如混合分数或物质质量分数）$\phi$ 的守恒[输运方程](@entry_id:174281)都包含[非线性](@entry_id:637147)对流项。当我们对这些项进行滤波时，便会产生未封闭的亚格子项。选择合适的滤波方法对于简化这些项的结构至关重要，尤其是在密度变化剧烈的流动中，如燃烧过程。

#### 雷诺滤波与法弗滤波

传统的 **雷诺滤波**（Reynolds filtering），表示为 $\overline{(\cdot)}$，将任意物理量 $f$ 分解为解析部分 $\bar{f}$ 和脉动部分 $f'$，即 $f = \bar{f} + f'$，其中 $\overline{f'} = 0$。然而，当密度 $\rho$ 发生显著变化时，直接对[守恒方程](@entry_id:1122898)中的对流项 $\rho u_i \phi$ 进行雷诺滤波会产生极其复杂的亚格子项。具体而言，对 $\rho u_i \phi = (\bar{\rho}+\rho')(\bar{u}_i+u_i')(\bar{\phi}+\phi')$ 进行滤波，会得到：
$$
\overline{\rho u_i \phi} = \bar{\rho}\bar{u}_i\bar{\phi} + \bar{\rho}\overline{u_i'\phi'} + \bar{u}_i\overline{\rho'\phi'} + \bar{\phi}\overline{\rho'u_i'} + \overline{\rho'u_i'\phi'}
$$
除了已解析通量 $\bar{\rho}\bar{u}_i\bar{\phi}$ 和经典的亚格子通量 $\bar{\rho}\overline{u_i'\phi'}$ 外，还出现了三个涉及密度脉动 $\rho'$ 的额外相关项。这些项难以建模，并且在密度变化剧烈时不可忽略。

为了克服这一困难，我们引入 **法弗滤波**（Favre filtering），或称密度加权滤波。法弗滤波量定义为 $\tilde{f} = \overline{\rho f} / \bar{\rho}$，相应的分解为 $f = \tilde{f} + f''$，其性质为 $\overline{\rho f''} = 0$。采用法弗滤波，对流项的滤波变得异常简洁：
$$
\overline{\rho u_i \phi} = \bar{\rho} \widetilde{u_i \phi}
$$
我们将法弗分解 $u_i = \tilde{u}_i + u_i''$ 和 $\phi = \tilde{\phi} + \phi''$ 代入上式，得到：
$$
\overline{\rho u_i \phi} = \bar{\rho} \widetilde{(\tilde{u}_i + u_i'')(\tilde{\phi} + \phi'')} = \bar{\rho} (\widetilde{\tilde{u}_i \tilde{\phi}} + \widetilde{\tilde{u}_i \phi''} + \widetilde{u_i'' \tilde{\phi}} + \widetilde{u_i'' \phi''})
$$
根据法弗滤波的性质和标准LES近似（假设解析尺度量在滤波核内变化缓慢），交叉项 $\widetilde{\tilde{u}_i \phi''}$ 和 $\widetilde{u_i'' \tilde{\phi}}$ 均近似为零。因此，滤波后的对流项可以精确地分解为两部分：
$$
\overline{\rho u_i \phi} \approx \bar{\rho}\tilde{u}_i\tilde{\phi} + \bar{\rho}\widetilde{u_i''\phi''}
$$
这个表达式的结构远比雷诺滤波的结果简单。它将总通量分解为一个由解析量构成的 **解析通量** $\bar{\rho}\tilde{u}_i\tilde{\phi}$ 和一个单一的 **亚格子[标量通量](@entry_id:1131249)** $\bar{\rho}\widetilde{u_i''\phi''}$。这种清晰的划分将所有与密度变化相关的复杂性都归入了这个单一的、密度加权的亚格子项中，极大地简化了闭合建模的任务。因此，对于存在显著密度变化的[反应流](@entry_id:190741)，采用法弗滤波是必须的 。

### 亚格子标量通量（$q_j^\phi$）的闭合模型

亚格子标量通量 $q_j^\phi \equiv \widetilde{u_j \phi} - \tilde{u}_j \tilde{\phi}$（在法弗滤波框架下，$\bar{\rho}q_j^\phi = \bar{\rho}\widetilde{u_j''\phi''}$）代表了未解析的[湍流](@entry_id:151300)运动对[标量输运](@entry_id:150360)的贡献。对其进行建模是LES的核心任务之一。

#### [梯度扩散假说](@entry_id:1125716)

最常用且物理直观的闭合模型是 **[梯度扩散假说](@entry_id:1125716)**（gradient-diffusion hypothesis），它类似于[分子扩散](@entry_id:154595)的[菲克定律](@entry_id:155177)。该假说认为，亚格子[湍流](@entry_id:151300)像小涡团一样，倾向于将标量从高浓度区域输运到低浓度区域，即“顺着梯度”输运。因此，亚格子通量被假定与解析[标量场的梯度](@entry_id:270765)成正比：
$$
q_j^\phi \approx -D_t \frac{\partial \tilde{\phi}}{\partial x_j}
$$
这里的负号表示通量方向与梯度方向相反。比例系数 $D_t$ 被称为 **湍涡扩散系数**（eddy diffusivity），其量纲为 $\mathrm{m^2/s}$。

根据量纲分析，我们可以进一步阐明 $D_t$ 的形式 。在亚格子尺度上，主要的长度尺度是滤波宽度 $\Delta$，时间尺度则由解析尺度的剪切率 $|S|$ 决定，即 $T_{sgs} \sim |S|^{-1}$。由于 $D_t$ 的量纲是 $\mathrm{L^2 T^{-1}}$，我们可以构造 $D_t \sim \Delta^2 |S|$。这与著名的 **[Smagorinsky模型](@entry_id:276289)** 对亚格子涡粘性系数 $\nu_t$ 的建[模形式](@entry_id:160014) $\nu_t = (C_s \Delta)^2 |S|$ 完全一致。

**[雷诺类比](@entry_id:153007)**（Reynolds analogy）指出，[湍流](@entry_id:151300)涡团在输运标量和输运能量（动量）时，其机制是相同的。因此，涡粘性系数 $\nu_t$ 和涡扩散系数 $D_t$ 应该成正比。它们的比值被定义为一个[无量纲数](@entry_id:260863)，称为 **[湍流施密特数](@entry_id:150226)**（turbulent Schmidt number），$Sc_t$：
$$
Sc_t \equiv \frac{\nu_t}{D_t}
$$
$Sc_t$ 的值通常取为 $O(1)$ 的常数（例如0.7）。因此，一旦通过[涡粘性模型](@entry_id:1124145)（如[Smagorinsky模型](@entry_id:276289)）得到了 $\nu_t$，就可以通过 $D_t = \nu_t / Sc_t$ 计算出涡扩散系数。

#### 梯度[扩散模型](@entry_id:142185)的局限性

尽管梯度扩散模型非常流行，但其核心的 **共线对齐假设**（colinearity alignment assumption），即 $q_j^\phi$ 严格反平行于 $\nabla \tilde{\phi}$，在物理上并非总是成立。我们可以通过分析 $q_j^\phi$ 的精确[输运方程](@entry_id:174281)来揭示这一点。该方程包含一个关键的生成项 $P(q_j^\phi) = -\tau_{jk} \partial_k \tilde{\phi}$，其中 $\tau_{jk} = \widetilde{u_j u_k} - \tilde{u}_j \tilde{u}_k$ 是亚格子[应力张量](@entry_id:148973)。

考虑一个典型的 **均匀[剪切流](@entry_id:266817)** ，其平均速度剖面为 $\tilde{U}_1 = S x_2$（$S>0$ 为常剪切率）。在这种流动中，即使解析标量梯度只存在于 $x_2$ 方向（即 $\nabla \tilde{\phi} = (0, G, 0)$，其中 $G$ 为常数），也会产生一个非零的亚格子切应力 $\tau_{12}  0$。此时，流向通量 $q_1^\phi$ 的生成项为：
$$
P(q_1^\phi) = -\tau_{1k} \partial_k \tilde{\phi} = -\tau_{12} \partial_2 \tilde{\phi} = -\tau_{12} G > 0
$$
这个正的生成项会驱动产生一个非零的流向通量 $q_1^\phi \neq 0$。然而，根据梯度扩散模型，由于流向的梯度为零（$\partial_1 \tilde{\phi} = 0$），流向通量本应为零。这个矛盾表明，在存在剪切的情况下，亚格子应力可以与一个方向的梯度作用，生成另一个方向的通量。这导致[通量矢量](@entry_id:273577) $q_j^\phi$ 与梯度矢量 $\nabla \tilde{\phi}$ 不再共线，[梯度扩散假说](@entry_id:1125716)失效。这种现象被称为 **逆梯度输运** 或 **反梯度输运** 的一种形式。

#### 先进闭合模型：混合模型与动态程序

为了克服梯度[扩散模型](@entry_id:142185)的局限性，研究者们发展了更先进的模型。**[混合模型](@entry_id:266571)**（mixed models）是一种有效的改进方法，它将梯度扩散项与一个 **[尺度相似性](@entry_id:754548)项**（scale-similarity term）结合起来 。[尺度相似性模型](@entry_id:1131262)的基本思想是，最大解析尺度上的[湍流](@entry_id:151300)运动（即所谓的“超网格”尺度）与紧邻的亚格子尺度上的运动在结构上是相似的。因此，我们可以通过对解析场进行二次滤波（即测试滤波）来构建一个能够模拟亚格子项的模型。一个典型的[混合模型](@entry_id:266571)形式如下：
$$
q_j^{\phi, \text{mod}} = -D_t \frac{\partial \tilde{\phi}}{\partial x_j} + C M_j^{\phi}
$$
其中 $M_j^{\phi}$ 是一个[尺度相似性](@entry_id:754548)项，例如 $M_j^{\phi} = \widehat{\tilde{u}_j \tilde{\phi}} - \hat{\tilde{u}}_j \hat{\tilde{\phi}}$（即伦纳德应力 $L_j^\phi$），而 $C$ 是一个模型系数。

如何确定系数 $C$？**动态程序**（dynamic procedure）提供了一种系统的方法。该方法基于 **[Germano恒等式](@entry_id:749887)**，这是一个在不同滤波尺度（网格尺度 $\Delta$ 和测试尺度 $\hat{\Delta}$）之间建立的精确关系。通过假定模型形式在两个尺度上都成立，并要求模型在测试尺度上尽可能满足[Germano恒等式](@entry_id:749887)（通常在最小二乘意义上），就可以动态地（即在每个时间步和空间位置）计算出模型系数 $C$。这种方法允许 $C$ 随流场变化，甚至可以取负值，从而能够部分地描述逆梯度输运等复杂现象。

#### [各向异性网格](@entry_id:746450)的处理

在实际计算中，网格往往是各向异性的，即在不同方向上的分辨率不同（$\Delta_1 \neq \Delta_2 \neq \Delta_3$）。在这种情况下，将涡扩散系数 $D_t$ 视为一个标量是不恰当的，因为它无法反映不同方向上亚格子输运强度的差异。正确的做法是将扩散系数建模为一个 **[二阶张量](@entry_id:199780)** $D_{jk}$ 。

基于物理原理，包括[量纲一致性](@entry_id:271193)、客观性（标架无关性）和耗散正定性（保证亚格子过程整体上是耗散的），可以推导出 $D_{jk}$ 的合理形式。一个满足这些要求的模型是在滤波器的本征坐标系中，将 $D_{jk}$ 构建为一个对角张量，其对角元正比于该方向滤波宽度的平方：
$$
D_{jk} = C_\phi \, |S| \, \text{diag}(\Delta_1^2, \Delta_2^2, \Delta_3^2)
$$
这个张量形式保证了亚格子通量的计算能够正确反映网格的各向异性，同时在各向同性网格（$\Delta_1=\Delta_2=\Delta_3$）的极限情况下，退化为标准的标量扩散系数模型。

### 亚格子[标量方差](@entry_id:1131255) ($\widetilde{\phi''^2}$) 的闭合

在反应流模拟中，仅仅对亚格子通量进行建模是不够的。化学反应速率通常是标量（如温度、[组分浓度](@entry_id:197022)）的强[非线性](@entry_id:637147)函数，例如 $\omega(\phi)$。直接将解析标量 $\tilde{\phi}$ 代入[反应速率](@entry_id:185114)函数，即 $\omega(\tilde{\phi})$，通常会严重偏离真实的滤波后[反应速率](@entry_id:185114) $\widetilde{\omega(\phi)}$。

#### [标量方差](@entry_id:1131255)与滤波[反应速率](@entry_id:185114)的耦合

亚格子尺度上的标量脉动会显著影响平均[反应速率](@entry_id:185114)。为了量化这种影响，我们通常采用 **[假定概率密度函数](@entry_id:753720)（PDF）方法** 。该方法假定在每个网格单元内，亚格子标量 $\phi$ 的值遵循某种概率分布 $P(\phi_*)$。真实的滤波[反应速率](@entry_id:185114)可以通过对瞬时[反应速率](@entry_id:185114)在该PDF上求期望得到：
$$
\widetilde{\omega(\phi)} = \int \omega(\phi_*) P(\phi_*; \boldsymbol{x}, t) \, d\phi_*
$$
这个PDF的形状由其矩决定，其中最重要的两个矩是解析平均值 $\tilde{\phi}$ 和 **亚格子[标量方差](@entry_id:1131255)** $\widetilde{\phi''^2} = \widetilde{(\phi-\tilde{\phi})^2}$。亚格子方差衡量了亚格子尺度上标量脉动的强度。

对于[非线性](@entry_id:637147)函数 $\omega(\phi)$，一个普遍的结论是 $\widetilde{\omega(\phi)} \neq \omega(\tilde{\phi})$。**詹森不等式**（Jensen's inequality）给出了一个严格的数学关系：如果 $\omega(\phi)$ 是一个[凹函数](@entry_id:274100)（向下弯曲），则 $\widetilde{\omega(\phi)} \le \omega(\tilde{\phi})$；反之，如果它是[凸函数](@entry_id:143075)，则 $\widetilde{\omega(\phi)} \ge \omega(\tilde{\phi})$。

我们可以通过对 $\omega(\phi)$ 在 $\tilde{\phi}$ 附近进行泰勒展开来更具体地理解这种关系：
$$
\widetilde{\omega(\phi)} \approx \omega(\tilde{\phi}) + \frac{1}{2} \omega''(\tilde{\phi}) \widetilde{\phi''^2} + \dots
$$
这个展开清晰地表明，对滤波[反应速率](@entry_id:185114)的[一阶修正](@entry_id:155896)是由亚格子方差 $\widetilde{\phi''^2}$ 和[反应速率](@entry_id:185114)函数的 **曲率** $\omega''(\tilde{\phi})$ 共同决定的。因此，准确获得亚格子[标量方差](@entry_id:1131255) $\widetilde{\phi''^2}$ 对于封闭滤波后的化学源项至关重要。

#### 亚格子[标量方差](@entry_id:1131255)的[输运方程](@entry_id:174281)

为了得到 $\widetilde{\phi''^2}$，我们可以为其建立并求解一个单独的[输运方程](@entry_id:174281)。这个方程描述了亚格子方差的生成、输运和耗散。其中，**生成项** $P_{\phi''}$ 是最重要的项之一，它描述了能量（方差）从解析尺度向亚格子尺度的串级。在法弗滤波框架下，这个生成项具有一个简洁而明确的形式 ：
$$
P_{\phi''} = -2 \bar{\rho} \widetilde{u_i''\phi''} \frac{\partial \tilde{\phi}}{\partial x_i} = -2 \bar{\rho} q_i^\phi \frac{\partial \tilde{\phi}}{\partial x_i}
$$
这个表达式优美地将亚格子方差的生成与我们之前讨论过的亚格子标量通量 $q_i^\phi$ 和解析标量梯度 $\partial \tilde{\phi}/\partial x_i$ 直接联系起来。

#### 标量耗散率的建模

亚格子方差[输运方程](@entry_id:174281)中的 **耗散项** 代表了方差在小尺度上被分子扩散所抹平的过程。这个耗散项通常与 **标量耗散率** $\chi = 2D |\nabla Z|^2$ 相关。在LES中，我们需要对滤波后的[标量耗散率](@entry_id:754534) $\tilde{\chi}$ 或亚格子方差自身的[耗散率](@entry_id:748577) $\epsilon_\phi$ 进行建模。

一个常见的模型是基于[谱理论](@entry_id:275351)的结构模型 。亚格子[标量方差](@entry_id:1131255) $\widetilde{Z'^2}$ 是标量[能谱](@entry_id:181780)在所有波数大于滤[波截止](@entry_id:1133985)波数 $k_c \sim 1/\Delta$ 的积分，而其梯度的方差 $\widetilde{|\nabla Z'|^2}$ 则是能谱的二阶矩。假设亚格子[能谱](@entry_id:181780)主要集中在 $k_c$ 附近，可以推导出两者之间的关系：
$$
\widetilde{|\nabla Z'|^2} \approx C_\chi \frac{\widetilde{Z'^2}}{\Delta^2}
$$
其中 $C_\chi$ 是一个 $O(1)$ 的模型常数。这个模型将一个难以直接计算的量（亚格子梯度方差）与已知的模型量（亚格子方差和滤波尺度）联系起来。

对于亚格子方差自身的耗散率 $\epsilon_\phi$，也存在多种模型。两种常见的形式是 ：
1.  $\epsilon_\phi = C_\epsilon \, |\tilde{S}| \, \widetilde{\phi''^2}$
2.  $\epsilon_\phi = C_\epsilon \, \dfrac{\nu_t}{Sc_t \, \Delta^2} \, \widetilde{\phi''^2}$

第一种模型假设耗散的时间尺度与解析尺度的[应变率](@entry_id:154778)成反比。第二种模型假设耗散时间尺度与亚格子[扩散时间](@entry_id:274894) $\Delta^2/D_t$ 成正比。有趣的是，如果采用Smagorinsky[涡粘性模型](@entry_id:1124145) $\nu_t \propto \Delta^2 |\tilde{S}|$，这两个看似不同的模型形式在数学上是等价的，并且都预测了在[惯性区](@entry_id:1126481)中 $\epsilon_\phi \propto \Delta^{-2/3} \widetilde{\phi''^2}$ 的标度率。

### 模型的物理一致性与鲁棒性

开发和使用[亚格子模型](@entry_id:755588)时，必须关注其物理一致性和[数值鲁棒性](@entry_id:188030)。

#### 回流与[可实现性](@entry_id:193701)

动态模型虽然强大，但也带来了一个挑战：计算出的涡扩散系数 $D_t$ 可能会在局部区域出现负值。负的 $D_t$ 意味着亚格子通量的方向与梯度方向相同（**上坡输运**），这对应于能量从亚格子尺度向解析尺度的逆向传递，即 **回流**（backscatter）。虽然回流是真实的物理现象，但无限制的负扩散率会导致解析[标量方差](@entry_id:1131255)的无界增长，从而引发[数值不稳定性](@entry_id:137058)。

为了解决这个问题，必须引入 **[可实现性](@entry_id:193701)限制器**（realizability limiters）。这些限制器的设计目标是允许受控的回流，同时保证总的有效扩散系数（分子扩散+湍流扩散）始终为正。一个有效的点态限制器是确保：
$$
\kappa + D_t \ge 0 \quad \text{或更严格地} \quad \kappa + D_t \ge \alpha \kappa \quad (\text{其中 } 0 \lt \alpha \lt 1)
$$
这等价于对负的 $D_t$ 设置一个下限，例如 $D_t \ge -\kappa$。这样的限制器既能捕捉回流的物理效应，又能保证[标量方差](@entry_id:1131255)有界，从而确保了LES计算的数值稳定性。

#### 模型一致性与网格加密

最后，一个优秀的[亚格子模型](@entry_id:755588)应该在[网格加密](@entry_id:168565)时表现出一致的行为。从标量能谱的理论形式可知，在[惯性区](@entry_id:1126481)，真实的亚格子方差 $\widetilde{Z'^2}$ 随滤波宽度 $\Delta$ 的标度关系为 $\widetilde{Z'^2} \propto \Delta^{2/3}$ 。一个使用常数系数的代数闭合模型，如 $\widetilde{Z'^2}_{\text{model}} = C_\sigma \Delta^2 |\nabla \tilde{Z}|^2$，在[惯性区](@entry_id:1126481)内能够正确地复现这种[标度关系](@entry_id:273705)。

然而，当网格加密到一定程度，使得滤波宽度 $\Delta$ 进入或接近耗散区时，真实的亚格子方差随 $\Delta$ 的衰减会比 $\Delta^{2/3}$ 更快。此时，[常系数](@entry_id:269842)模型将无法捕捉这种变化，导致模型与物理现实脱节。为了在跨越不同[湍流](@entry_id:151300)尺度的网格上保持一致性，模型系数本身必须能够随尺度变化，即 $C_\sigma(\Delta)$。这正是动态程序的核心优势所在：它通过不断地从解析场中提取信息来调整模型系数，使其能够适应当地的流动状态和解析度，从而在更广泛的尺度范围内保持物理一致性。