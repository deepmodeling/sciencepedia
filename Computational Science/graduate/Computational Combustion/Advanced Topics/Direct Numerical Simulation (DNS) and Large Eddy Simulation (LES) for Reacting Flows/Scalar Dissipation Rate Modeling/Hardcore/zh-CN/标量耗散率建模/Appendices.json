{
    "hands_on_practices": [
        {
            "introduction": "对冲射流火焰是研究火焰结构和标量耗散率的经典配置。本练习将通过相似性分析，推导在该理想化流动中化学计量混合分数表面上标量耗散率的著名解析解。这个实践旨在巩固对流动应变率如何影响分子混合过程这一基本物理机制的理解 。",
            "id": "4041998",
            "problem": "考虑一个形成驻点混合层的稳态平面撞击射流。设混合分数 $Z$ 是一个守恒标量，对于不可压缩流，它遵循稳态对流-扩散方程：\n$$\n\\boldsymbol{u}\\cdot\\nabla Z = D_Z \\nabla^{2} Z,\n$$\n其中 $D_Z$ 是混合分数扩散系数。假设在驻点平面附近的一个薄邻域内，速度场具有垂直于混合层的一维线性应变形式：\n$$\nu_y(y) = - a\\, y,\n$$\n其中 $a$ 是应变率，$y$ 是垂直于混合层的坐标。在这种一维设定下，混合分数满足：\n$$\n- a\\, y\\, \\frac{d Z}{d y} = D_Z \\frac{d^{2} Z}{d y^{2}},\n$$\n其远场边界条件在物理上是一致的：$Z(y\\to -\\infty)=1$（燃料流）和 $Z(y\\to +\\infty)=0$（氧化剂流）。\n\n定义在化学计量混合分数 $Z_{st}$ 处的条件标量耗散率为：\n$$\n\\chi_{st} \\equiv 2\\,D_Z\\,\\big|\\nabla Z\\big|^{2}\\Big|_{Z=Z_{st}},\n$$\n其中梯度是在垂直于 $Z=Z_{st}$ 等值面的方向上计算的。使用混合分数输运方程的相似性分析，推导出一个用 $a$、$D_Z$ 和在化学计量面上的 $Z$ 的法向梯度 $\\left|\\frac{\\partial Z}{\\partial n}\\right|_{st}$ 表示的 $\\chi_{st}$ 表达式。然后，将问题特殊化到对称撞击射流的情况，其中 $Z_{st}=\\frac{1}{2}$，此时化学计量面与驻点平面 $y=0$ 重合，并求出在这种对称情况下 $\\chi_{st}$ 的闭式表达式。\n\n将对称情况下的最终答案表示为单个闭式解析表达式。不需要数值近似。以 $\\mathrm{s}^{-1}$ 为单位表示最终的条件标量耗散率 $\\chi_{st}$。",
            "solution": "该问题要求推导条件标量耗散率 $\\chi_{st}$ 的表达式，首先是在一般情况下，然后是针对特定的对称情况。\n\n混合分数 $Z(y)$ 的一维输运方程为：\n$$\nD_Z \\frac{d^{2} Z}{d y^{2}} + a\\, y\\, \\frac{d Z}{d y} = 0\n$$\n其中 $a$ 是应变率，$D_Z$ 是扩散系数。这是一个二阶线性常微分方程。我们可以通过设 $W(y) = \\frac{dZ}{dy}$ 来求解。方程变为关于 $W$ 的一阶可分离常微分方程：\n$$\nD_Z \\frac{dW}{dy} = -a\\, y\\, W\n$$\n分离变量，我们得到：\n$$\n\\frac{dW}{W} = -\\frac{a}{D_Z} y\\, dy\n$$\n对两边积分得到：\n$$\n\\int \\frac{dW}{W} = \\int -\\frac{a}{D_Z} y\\, dy \\implies \\ln|W| = -\\frac{a}{2D_Z} y^2 + C_1\n$$\n其中 $C_1$ 是一个积分常数。对两边取指数，得到：\n$$\nW(y) = C_2 \\exp\\left(-\\frac{a y^2}{2D_Z}\\right)\n$$\n其中 $C_2$ 是另一个常数。由于 $W(y) = \\frac{dZ}{dy}$，我们现在对这个表达式进行积分以求得 $Z(y)$：\n$$\nZ(y) = \\int C_2 \\exp\\left(-\\frac{a y^2}{2D_Z}\\right) dy + C_3\n$$\n该积分涉及高斯函数。解可以用误差函数 $\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x \\exp(-t^2) dt$ 来表示。我们引入一个相似性变量 $\\eta = y \\sqrt{\\frac{a}{2D_Z}}$。那么 $d\\eta = \\sqrt{\\frac{a}{2D_Z}} dy$。\n$Z(y)$ 的积分变为：\n$$\nZ(y) = C_2 \\int \\exp(-\\eta^2) \\sqrt{\\frac{2D_Z}{a}} d\\eta + C_3 = C_2 \\sqrt{\\frac{2D_Z}{a}} \\left(\\frac{\\sqrt{\\pi}}{2} \\text{erf}(\\eta)\\right) + C_3\n$$\n合并常数，我们可以将通解写为：\n$$\nZ(y) = C_4 \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) + C_3\n$$\n我们使用远场边界条件 $Z(y\\to\\infty)=0$ 和 $Z(y\\to-\\infty)=1$ 来确定常数 $C_3$ 和 $C_4$。我们使用误差函数的极限：$\\lim_{x\\to\\infty} \\text{erf}(x) = 1$ 和 $\\lim_{x\\to-\\infty} \\text{erf}(x) = -1$。\n对于 $y \\to \\infty$：\n$$\nZ(\\infty) = C_4(1) + C_3 = 0\n$$\n对于 $y \\to -\\infty$：\n$$\nZ(-\\infty) = C_4(-1) + C_3 = 1\n$$\n我们得到一个包含两个线性方程的方程组：\n1. $C_4 + C_3 = 0 \\implies C_3 = -C_4$\n2. $-C_4 + C_3 = 1$\n\n将 (1) 代入 (2) 得到 $-C_4 - C_4 = 1 \\implies -2C_4 = 1 \\implies C_4 = -\\frac{1}{2}$。\n然后 $C_3 = -(-\\frac{1}{2}) = \\frac{1}{2}$。\n混合分数剖面的解为：\n$$\nZ(y) = \\frac{1}{2} - \\frac{1}{2} \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) = \\frac{1}{2} \\text{erfc}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right)\n$$\n其中 $\\text{erfc}(x) = 1 - \\text{erf}(x)$ 是互补误差函数。\n\n现在，我们来处理条件标量耗散率 $\\chi_{st}$。在我们的的一维设定中，梯度为 $|\\nabla Z| = |dZ/dy|$。因此，\n$$ \\chi_{st} = 2 D_Z \\left(\\frac{dZ}{dy}\\right)^2 \\Bigg|_{y=y_{st}} $$\n其中 $y_{st}$ 是满足 $Z(y_{st})=Z_{st}$ 的位置。从上面推导的解 $Z(y) = \\frac{1}{2} \\text{erfc}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right)$，我们首先计算梯度：\n$$ \\frac{dZ}{dy} = \\frac{1}{2} \\frac{d}{dy}\\left(1 - \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right)\\right) = -\\frac{1}{2} \\cdot \\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\frac{a y^2}{2D_Z}\\right) \\cdot \\sqrt{\\frac{a}{2D_Z}} = -\\sqrt{\\frac{a}{2\\pi D_Z}} \\exp\\left(-\\frac{a y^2}{2D_Z}\\right) $$\n现在，我们考虑对称情况，其中 $Z_{st} = 1/2$。将此值代入 $Z(y)$ 的解中，我们发现：\n$$ \\frac{1}{2} = \\frac{1}{2} \\text{erfc}\\left(y_{st} \\sqrt{\\frac{a}{2D_Z}}\\right) \\implies \\text{erfc}(\\cdot) = 1 $$\n互补误差函数 $\\text{erfc}(x)=1$ 当且仅当其参数 $x \\to -\\infty$ 或当参数为0时，$\\text{erf}(0)=0, \\text{erfc}(0)=1$。检查我们的解：$Z(0) = \\frac{1}{2} \\text{erfc}(0) = \\frac{1}{2}$。因此，化学计量面位于 $y_{st}=0$。\n最后，我们将 $y=0$ 代入梯度表达式并计算 $\\chi_{st}$：\n$$ \\left(\\frac{dZ}{dy}\\right)^2\\Bigg|_{y=0} = \\left(-\\sqrt{\\frac{a}{2\\pi D_Z}}\\right)^2 = \\frac{a}{2\\pi D_Z} $$\n$$ \\chi_{st} = 2 D_Z \\left(\\frac{dZ}{dy}\\right)^2\\Bigg|_{y=0} = 2 D_Z \\left(\\frac{a}{2\\pi D_Z}\\right) = \\frac{a}{\\pi} $$\n因此，在对称撞击射流中，化学计量标量耗散率与应变率成正比，与扩散系数无关。",
            "answer": "$$ \\boxed{\\frac{a}{\\pi}} $$"
        },
        {
            "introduction": "标量耗散率是火焰面模型中的一个关键参数，它控制着扩散和化学反应之间的平衡。本实践练习将指导您构建一个火焰面求解器，以确定导致火焰熄灭的临界化学计量标量耗散率 $\\chi_{st}$。理解熄灭极限对于分析燃烧稳定性至关重要 。",
            "id": "4041973",
            "problem": "要求您在典型稳态非预混小火焰框架内对条件标量耗散率进行建模，并确定随着化学计量条件标量耗散率的增加而发生的熄火现象。构建一个程序，对于一组给定的具有物理意义的参数，在混合分数空间中建立并求解稳态一维小火焰边界值问题，并数值确定反应解不复存在时的临界化学计量条件标量耗散率。\n\n从以下已建立的非预混稳态小火焰基础开始：\n- 混合分数坐标 $z \\in [0,1]$ 用于索引流场，其中 $z=0$ 处为氧化剂流，$z=1$ 处为燃料流。\n- 标量耗散率（以混合分数为条件）被建模为一个给定函数 $\\,\\chi(z)\\,$，其在化学计量混合分数 $\\,z_{st}\\,$ 处达到峰值。控制参数是化学计量条件标量耗散率 $\\,\\chi_{st}\\,$.\n- 在单位 Lewis 数和恒定密度近似下，混合分数空间中的稳态组分和能量平衡方程是二阶边界值问题，其中扩散由 $\\,\\chi(z)\\,$ 乘以曲率表示，反应则作为源项出现。考虑一个具有 Arrhenius 动力学的单步不可逆反应 $\\,F + s\\,O \\to P\\,$，其中 $\\,s\\,$ 是以质量单位表示的化学计量系数。\n\n设未知量为燃料质量分数 $\\,Y_F(z)\\,$、氧化剂质量分数 $\\,Y_O(z)\\,$ 和温度 $\\,T(z)\\,$。控制方程如下：\n$$\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_F}{dz^2} = -\\,\\omega(T, Y_F, Y_O), \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_O}{dz^2} = -\\,s\\,\\omega(T, Y_F, Y_O), \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 T}{dz^2} = -\\,\\frac{q}{c_p}\\,\\omega(T, Y_F, Y_O),\n$$\n其中反应速率建模为\n$$\n\\omega(T, Y_F, Y_O) = A\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)\\,Y_F\\,Y_O,\n$$\n且 $\\,q\\,$ 是单位质量放热量（单位 $\\mathrm{J}/\\mathrm{kg}$），$\\,c_p\\,$ 是定压比热容（单位 $\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$），$\\,A\\,$ 是指前因子（单位 $\\mathrm{s}^{-1}$），$\\,E\\,$ 是活化能（单位 $\\mathrm{J}/\\mathrm{mol}$），$\\,R\\,$ 是普适气体常数（单位 $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$）。施加代表燃料流和氧化剂流的 Dirichlet 边界条件：\n$$\nY_F(0) = 0, \\quad Y_O(0) = Y_{O,\\infty}, \\quad T(0) = T_{O,\\infty},\n$$\n$$\nY_F(1) = Y_{F,\\infty}, \\quad Y_O(1) = 0, \\quad T(1) = T_{F,\\infty}.\n$$\n\n根据来流和化学计量关系计算化学计量混合分数 $\\,z_{st}\\,$。对于单位分子量和单步反应 $\\,F + s\\,O \\to P\\,$，在标准非预混假设下，使用以下公式：\n$$\nz_{st} = \\frac{Y_{F,\\infty}}{Y_{F,\\infty} + s\\,Y_{O,\\infty}}.\n$$\n将条件标量耗散率剖面建模为以 $\\,z_{st}\\,$ 为中心、宽度参数为 $\\,\\sigma\\,$ 的高斯函数：\n$$\n\\chi(z) = \\chi_{st}\\,\\exp\\!\\left(-\\frac{(z - z_{st})^2}{2\\,\\sigma^2}\\right),\n$$\n其中 $\\,\\chi_{st}\\,$ 是化学计量条件标量耗散率（单位 $\\mathrm{s}^{-1}$）。\n\n通过反应解未能达到点火阈值温度 $\\,T_{\\mathrm{ign}}\\,$ 来定义熄火。具体来说，如果最高温度 $\\,\\max_z T(z)\\,$ 大于或等于 $\\,T_{\\mathrm{ign}}\\,$，则将解分类为反应解，否则为非反应解。对于给定的参数集和扫描范围 $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$，找出该范围内解为反应解的最大 $\\,\\chi_{st}\\,$ 值。如果即使在 $\\,\\chi_{st} = \\chi_{\\min}\\,$ 时也不存在反应解，则报告 $\\,0.0\\,$。如果解在达到 $\\,\\chi_{st} = \\chi_{\\max}\\,$ 时仍然是反应解，则报告 $\\,\\chi_{\\max}\\,$.\n\n您的程序必须：\n- 建立上述边界值问题，将其转换为一阶系统，并使用适合非线性问题的鲁棒边界值问题求解器进行求解。\n- 使用物理上合理的参数，并在反应速率评估中强制施加正值约束，以确保科学真实性。\n- 在提供的 $\\,\\chi_{st}\\,$ 范围内实现二分搜索，以根据点火准则确定熄火极限。\n\n物理单位：\n- 返回的 $\\,\\chi_{st}\\,$ 值单位为 $\\mathrm{s}^{-1}$。\n- 温度 $\\,T\\,$ 单位为 $\\mathrm{K}$。\n- 定压比热容 $\\,c_p\\,$ 单位为 $\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$。\n- 单位质量放热量 $\\,q\\,$ 单位为 $\\mathrm{J}/\\mathrm{kg}$。\n- 普适气体常数 $\\,R\\,$ 单位为 $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$。\n\n测试套件：\n提供三个测试用例以涵盖不同工况。对于每个用例，您必须使用以下参数。\n\n- 用例 $\\,1\\,$（标称冷来流，中等化学反应）：\n  - $\\,A = 4.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 1.5\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 3.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 300\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$.\n\n- 用例 $\\,2\\,$（预热氧化剂，强点火，可能在上限之外熄火）：\n  - $\\,A = 4.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 1.5\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 3.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 600\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$.\n\n- 用例 $\\,3\\,$（高活化能，弱化学反应，可能无法点火）：\n  - $\\,A = 1.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 2.0\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 2.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 300\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$.\n\n算法要求：\n- 对于给定的 $\\,\\chi_{st}\\,$，使用适合非线性系统的数值边界值问题求解器来求解该边界值问题。\n- 对每个用例，在 $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$ 范围内实现二分搜索，以在小公差内估算临界熄火值。\n- 在计算 $\\,\\omega\\,$ 时，强制 $\\,Y_F\\,$ 和 $\\,Y_O\\,$ 为非负值。\n- 使用一个满足边界条件的光滑初始猜测，并在 $\\,z_{st}\\,$ 附近设置一个小的温度凸起以帮助收敛。\n\n最终输出规范：\n- 您的程序必须生成单行输出，其中包含三个测试用例的结果，格式为用方括号括起来的逗号分隔浮点数列表。\n- 每个浮点数必须是相应测试用例的估算临界 $\\,\\chi_{st}\\,$ 值（单位 $\\mathrm{s}^{-1}$），四舍五入到三位小数。\n- 对于在 $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$ 范围内不存在反应解的用例，返回 $\\,0.000\\,$。对于反应解持续存在直至 $\\,\\chi_{\\max}\\,$ 的用例，返回相应四舍五入后的 $\\,\\chi_{\\max}\\,$.\n所需输出格式示例：$\\,\\left[ \\chi_{crit,1}, \\chi_{crit,2}, \\chi_{crit,3} \\right]\\,$，需严格打印为 $\\,\\left[\\chi_{crit,1},\\chi_{crit,2},\\chi_{crit,3}\\right]\\,$。",
            "solution": "该问题具有科学依据、适定且客观。它提出了一个稳态非预混层流小火焰的典型模型，这是燃烧理论中的一个基本概念。控制方程、边界条件以及动力学/输运模型都是用于研究火焰结构和熄火等现象的标准简化（例如，单位 Lewis 数、单步 Arrhenius 动力学）。所有参数均已提供，其目标——找到导致熄火的临界标量耗散率——是一个定义明确的计算任务。因此，该问题是有效的，可以构建解决方案。\n\n求解方法分三个阶段进行：\n1.  控制偏微分方程的数学简化。\n2.  建立数值边界值问题 (BVP)。\n3.  实现一个搜索算法以找到熄火极限。\n\n**1. 数学建模与简化**\n\n所提供的系统由三个关于燃料质量分数 $Y_F(z)$、氧化剂质量分数 $Y_O(z)$ 和温度 $T(z)$ 的耦合二阶非线性常微分方程组成，其中 $z$ 是混合分数坐标。\n$$\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_F}{dz^2} = -\\,\\omega, \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_O}{dz^2} = -\\,s\\,\\omega, \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 T}{dz^2} = -\\,\\frac{q}{c_p}\\,\\omega\n$$\n其中 $\\omega = A\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)\\,\\max(0, Y_F)\\,\\max(0, Y_O)$。对质量分数强制施加非负性是一个物理约束。\n\n通过引入守恒标量（Schvab-Zeldovich 变量），可以简化该系统。注意到因变量的某些线性组合会导致源项为零。定义两个这样的变量 $\\beta_1$ 和 $\\beta_2$：\n$$\n\\beta_1(z) = Y_O(z) - s\\,Y_F(z)\n$$\n$$\n\\beta_2(z) = T(z) + \\frac{q}{c_p}\\,Y_F(z)\n$$\n对这两个表达式关于 $z$ 求二阶导数，并代入控制方程，可以得到 $\\frac{d^2 \\beta_1}{dz^2} = 0$ 和 $\\frac{d^2 \\beta_2}{dz^2} = 0$。这意味着 $\\beta_1(z)$ 和 $\\beta_2(z)$ 是 $z$ 的线性函数。\n$$\n\\beta_1(z) = C_1 z + C_2, \\quad \\beta_2(z) = C_3 z + C_4\n$$\n常数 $C_1, C_2, C_3, C_4$ 通过在 $z=0$（氧化剂流）和 $z=1$（燃料流）处应用边界条件来确定。\n\n对于 $\\beta_1(z)$：\n在 $z=0$ 处：$Y_O(0) - s\\,Y_F(0) = Y_{O,\\infty} - 0 = C_2$。\n在 $z=1$ 处：$Y_O(1) - s\\,Y_F(1) = 0 - s\\,Y_{F,\\infty} = C_1 + C_2 = C_1 + Y_{O,\\infty}$。因此，$C_1 = -s\\,Y_{F,\\infty} - Y_{O,\\infty}$。\n这得到了 $Y_O$ 的耦合关系：\n$$\nY_O(z) = s\\,Y_F(z) - (s\\,Y_{F,\\infty} + Y_{O,\\infty})z + Y_{O,\\infty}\n$$\n\n对于 $\\beta_2(z)$：\n在 $z=0$ 处：$T(0) + \\frac{q}{c_p}\\,Y_F(0) = T_{O,\\infty} + 0 = C_4$。\n在 $z=1$ 处：$T(1) + \\frac{q}{c_p}\\,Y_F(1) = T_{F,\\infty} + \\frac{q}{c_p}\\,Y_{F,\\infty} = C_3 + C_4 = C_3 + T_{O,\\infty}$。因此，$C_3 = T_{F,\\infty} - T_{O,\\infty} + \\frac{q}{c_p}\\,Y_{F,\\infty}$。\n这得到了 $T$ 的耦合关系：\n$$\nT(z) = T_{F,\\infty} + \\frac{q}{c_p}Y_{F,\\infty} - \\left( T_{F,\\infty} - T_{O,\\infty} + \\frac{q}{c_p}Y_{F,\\infty} \\right)z - \\frac{q}{c_p}Y_F(z)\n$$\n通过这些关系，$Y_O$ 和 $T$ 就由 $Y_F$ 和 $z$ 唯一确定。该系统简化为关于 $Y_F(z)$ 的单个二阶常微分方程：\n$$\n\\frac{d^2 Y_F}{dz^2} = -\\frac{2}{\\chi(z;\\chi_{st})} \\omega(T(Y_F, z), Y_F, Y_O(Y_F, z))\n$$\n边界条件为 $Y_F(0) = 0$ 和 $Y_F(1) = Y_{F,\\infty}$。\n\n**2. 数值边界值问题公式化**\n\n为了数值求解这个非线性 BVP，我们使用一个基于配置法的求解器 `scipy.integrate.solve_bvp`，它要求一个一阶常微分方程组。我们定义一个状态向量 $\\mathbf{y}(z) = [y_0(z), y_1(z)]^T = [Y_F(z), \\frac{dY_F}{dz}(z)]^T$。然后，该二阶常微分方程被转换为以下系统：\n$$\n\\frac{d\\mathbf{y}}{dz} =\n\\begin{pmatrix}\ny_1 \\\\\n-\\frac{2}{\\chi(z;\\chi_{st})} \\omega(T(y_0, z), y_0, Y_O(y_0, z))\n\\end{pmatrix}\n$$\n边界条件在 $z=0$ 和 $z=1$ 处对 $\\mathbf{y}$ 进行指定：\n$$\ny_0(0) = 0, \\quad y_0(1) = Y_{F,\\infty}\n$$\n这构成了一个完整的 BVP 公式。在分母中的 $\\chi(z)$ 上添加一个小的正则化项 $\\epsilon$（例如 $10^{-20}$），以防止在反应速率 $\\omega$ 也为零的定义域边界处出现除以零的情况。\n\n求解此类非线性系统的一个关键要素是提供给求解器的初始猜测。为了有利于收敛到物理上有意义的“已点燃”解分支，我们构建一个具有超绝热温度峰值的猜测。首先，计算一个非反应温度剖面：$T_{\\text{nr}}(z) = (T_{F,\\infty} - T_{O,\\infty})z + T_{O,\\infty}$。在该剖面靠近化学计量混合分数 $z_{st}$ 的位置添加一个高斯凸起，从而创建 $T_{\\text{guess}}(z)$。最后，使用 Schvab-Zeldovich 关系将其反转，得到 $Y_F(z)$ 的初始猜测。\n\n**3. 用于寻找熄火极限的二分搜索**\n\n问题的核心是找到熄火极限，该极限定义为存在反应解的化学计量标量耗散率 $\\chi_{st}$ 的最大值。如果一个解的最大温度 $\\max_z T(z)$ 超过给定的点火阈值 $T_{\\mathrm{ign}}$，则该解被视为“反应解”。\n\n我们定义一个布尔函数 `is_reactive(chi_st)`，它对给定的 $\\chi_{st}$ 求解 BVP，如果 $\\max T(z) \\ge T_{\\mathrm{ign}}$（并且求解器已收敛），则返回 `True`，否则返回 `False`。\n\n在指定范围 $[\\chi_{\\min}, \\chi_{\\max}]$ 内实现二分搜索，以找到临界值 $\\chi_{crit}$。算法流程如下：\n1.  检查 `is_reactive(chi_min)`。如果为 `False`，则该范围内不存在反应解。根据问题要求，结果为 $0.0$。\n2.  检查 `is_reactive(chi_max)`。如果为 `True`，则火焰在达到最大搜索值时仍保持稳定。结果为 $\\chi_{\\max}$。\n3.  如果 `is_reactive(chi_min)` 为 `True` 且 `is_reactive(chi_max)` 为 `False`，则熄火极限位于该区间内。二分搜索通过迭代缩小该区间：\n    - 设置 `low = chi_min`，`high = chi_max`。\n    - 重复固定次数的迭代（例如，30 次以获得足够精度）：\n        - 计算 `mid = (low + high) / 2`。\n        - 如果 `is_reactive(mid)` 为 `True`，则临界值至少为 `mid`，因此我们设置 `low = mid`。\n        - 如果 `is_reactive(mid)` 为 `False`，则火焰已熄灭，因此临界值至多为 `mid`。我们设置 `high = mid`。\n4.  最终结果为 `low`，它代表了所找到的能够维持反应火焰的 $\\chi_{st}$ 的最高值。\n\n将此程序应用于所提供的三个测试用例中的每一个，以确定它们各自的熄火极限。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Main function to solve the flamelet extinction problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (nominal cold streams, moderate chemistry)\n        {\n            \"A\": 4.0e6, \"E_over_R\": 1.5e4, \"q\": 3.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 300.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        },\n        # Case 2 (preheated oxidizer, robust ignition)\n        {\n            \"A\": 4.0e6, \"E_over_R\": 1.5e4, \"q\": 3.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 600.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        },\n        # Case 3 (high activation energy, weak chemistry)\n        {\n            \"A\": 1.0e6, \"E_over_R\": 2.0e4, \"q\": 2.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 300.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        critical_chi = find_extinction_chi_st(params)\n        results.append(f\"{critical_chi:.3f}\")\n    \n    print(f\"[{','.join(results)}]\")\n\ndef find_extinction_chi_st(params):\n    \"\"\"\n    Performs a bisection search to find the critical stoichiometric scalar dissipation rate\n    for extinction.\n    \"\"\"\n    flamelet_problem = FlameletProblem(params)\n\n    # Check boundaries of the search range first\n    if not flamelet_problem.is_reactive(params['chi_min']):\n        return 0.0\n    if flamelet_problem.is_reactive(params['chi_max']):\n        return params['chi_max']\n\n    low = params['chi_min']\n    high = params['chi_max']\n    \n    # Bisection search\n    for _ in range(30):  # 30 iterations give high precision\n        mid = (low + high) / 2.0\n        if flamelet_problem.is_reactive(mid):\n            low = mid\n        else:\n            high = mid\n            \n    return low\n\nclass FlameletProblem:\n    \"\"\"\n    Encapsulates the physics and numerical setup for a single flamelet problem.\n    \"\"\"\n    def __init__(self, params):\n        self.params = params\n        self.z_st = params['YF_inf'] / (params['YF_inf'] + params['s'] * params['YO_inf'])\n        self.C1_T = (params['TF_inf'] - params['TO_inf'] - \n                     params['q'] / params['cp'] * params['YF_inf'])\n        self.C2_T = params['TO_inf']\n        self.C1_YO = -(params['s'] * params['YF_inf'] + params['YO_inf'])\n        self.C2_YO = params['YO_inf']\n\n    def T_from_YF(self, YF, z):\n        \"\"\"Calculates temperature T from fuel mass fraction YF and position z.\"\"\"\n        return self.params['q'] / self.params['cp'] * YF + self.C1_T * z + self.C2_T\n\n    def YO_from_YF(self, YF, z):\n        \"\"\"Calculates oxidizer mass fraction YO from YF and z.\"\"\"\n        return self.params['s'] * YF + self.C1_YO * z + self.C2_YO\n\n    def reaction_rate(self, T, YF, YO):\n        \"\"\"Calculates the Arrhenius reaction rate.\"\"\"\n        # Enforce non-negativity for mass fractions\n        YF_pos = np.maximum(0.0, YF)\n        YO_pos = np.maximum(0.0, YO)\n        # Avoid overflow in exp for very low T\n        if np.any(T  250): return 0.0 \n        return self.params['A'] * np.exp(-self.params['E_over_R'] / T) * YF_pos * YO_pos\n\n    def chi(self, z, chi_st):\n        \"\"\"Calculates the scalar dissipation rate profile.\"\"\"\n        return chi_st * np.exp(-(z - self.z_st)**2 / (2 * self.params['sigma']**2))\n\n    def ode_system(self, z, y, chi_st):\n        \"\"\"Defines the system of first-order ODEs for the BVP solver.\"\"\"\n        # y[0] = YF, y[1] = dYF/dz\n        YF = y[0]\n        \n        # Calculate T and YO from YF using Schvab-Zeldovich relations\n        T = self.T_from_YF(YF, z)\n        YO = self.YO_from_YF(YF, z)\n        \n        # Calculate reaction rate\n        omega = self.reaction_rate(T, YF, YO)\n        \n        # Calculate d2YF/dz2\n        # Add a small epsilon to chi to avoid division by zero\n        chi_val = self.chi(z, chi_st)\n        d2YF_dz2 = -2.0 * omega / (chi_val + 1e-20)\n        \n        return np.vstack((y[1], d2YF_dz2))\n\n    def bc(self, ya, yb):\n        \"\"\"Defines the boundary conditions for the BVP solver.\"\"\"\n        # ya: solution at z=0, yb: solution at z=1\n        # y[0] = YF\n        return np.array([ya[0] - 0.0, yb[0] - self.params['YF_inf']])\n\n    def make_initial_guess(self, z_mesh):\n        \"\"\"Creates a physically-informed initial guess to aid convergence.\"\"\"\n        YF_guess = np.zeros_like(z_mesh)\n        \n        # Non-reacting T profile + bump\n        T_nr = (self.params['TF_inf'] - self.params['TO_inf']) * z_mesh + self.params['TO_inf']\n        T_bump = 800.0 * np.exp(-(z_mesh - self.z_st)**2 / (2 * 0.05**2))\n        T_guess = T_nr + T_bump\n        \n        # Invert T_guess to get YF_guess via S-Z relation\n        YF_guess = (self.params['cp'] / self.params['q']) * (T_guess - (self.C1_T * z_mesh + self.C2_T))\n        \n        # The derivative can be approximated from the linear profile\n        dYF_dz_guess = np.full_like(z_mesh, self.params['YF_inf'])\n        \n        return np.vstack((YF_guess, dYF_dz_guess))\n\n    def solve_single_chi_st(self, chi_st):\n        \"\"\"Solves the flamelet BVP for a given chi_st.\"\"\"\n        z_mesh = np.linspace(0, 1, 150)\n        y_guess = self.make_initial_guess(z_mesh)\n\n        sol = solve_bvp(lambda z, y: self.ode_system(z, y, chi_st),\n                        self.bc, z_mesh, y_guess, tol=1e-4, max_nodes=2000)\n\n        if sol.success:\n            # Re-interpolate on a fine mesh to find a more accurate max temperature\n            z_fine = np.linspace(0, 1, 500)\n            YF_sol = sol.sol(z_fine)[0]\n            T_sol = self.T_from_YF(YF_sol, z_fine)\n            return np.max(T_sol)\n        else:\n            return 0.0  # Solver failure implies non-reactive\n\n    def is_reactive(self, chi_st):\n        \"\"\"Checks if a solution is reactive based on the ignition temperature.\"\"\"\n        max_T = self.solve_single_chi_st(chi_st)\n        return max_T >= self.params['T_ign']\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "在具有显著热释放的湍流燃烧中，物理量的平均方法至关重要。由于密度变化剧烈，简单的雷诺平均可能引入显著误差。本练习旨在通过一个典型的一维混合层模型，揭示雷诺平均与法福平均（密度加权平均）标量耗散率之间的差异，从而强调在变密度流中采用法福平均的必要性 。",
            "id": "4060194",
            "problem": "考虑一个恒压环境下一维带热释放的混合层，其模型建立在区间 $[0,L]$ 上，其中 $L$ 是以米为单位的域长度。守恒混合分数场由双曲正切剖面 $Z(x) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\delta}\\right)\\right)$ 定义，其中 $x_0$ 是火焰面中心的位置（单位：米），$\\delta$ 是特征厚度（单位：米）。假设分子扩散系数 $D$ 为常数，单位为平方米/秒。混合分数的瞬时标量耗散率定义为 $\\chi_Z(x) = 2 D \\left(\\frac{dZ}{dx}\\right)^2$，单位为秒的倒数。热释放通过恒定压力 $p$ 和气体常数 $R$ 下的理想气体定律改变密度，其温度场由 $T(x) = T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}$ 给出，其中 $T_u$ 是未燃气体温度（单位：开尔文），$\\Delta T$ 是由热释放引起的温升（单位：开尔文），$\\beta$ 是一个正的形状参数。在这些假设下，密度为 $\\rho(x) = \\frac{p}{R\\,T(x)}$，单位为千克/立方米。\n\n计算域 $[0,L]$ 上的Favre平均标量耗散率 $\\tilde{\\chi_Z}$ 和非Favre空间平均 $\\bar{\\chi_Z}$。使用以下定义\n$$\n\\tilde{\\chi_Z} = \\frac{\\int_{0}^{L} \\rho(x)\\,\\chi_Z(x)\\,dx}{\\int_{0}^{L} \\rho(x)\\,dx}, \\quad\n\\bar{\\chi_Z} = \\frac{1}{L}\\int_{0}^{L} \\chi_Z(x)\\,dx.\n$$\n当密度不均匀时，通过相对差异量化使用非Favre平均引入的误差\n$$\ne = \\frac{\\bar{\\chi_Z} - \\tilde{\\chi_Z}}{\\tilde{\\chi_Z}}.\n$$\n您的程序必须构建指定的场，对积分进行数值计算，并为每个测试用例返回 $\\tilde{\\chi_Z}$、$\\bar{\\chi_Z}$ 和 $e$。量 $\\tilde{\\chi_Z}$ 和 $\\bar{\\chi_Z}$ 必须以秒的倒数 (s$^{-1}$) 表示，$e$ 必须以十进制小数表示（无量纲）。\n\n对测试套件使用以下物理一致的参数：\n$L = 1.0\\times 10^{-2}$ m, $x_0 = \\frac{L}{2}$ m, $p = 1.01325\\times 10^{5}$ Pa, $R = 287$ J/(kg$\\cdot$K), $T_u = 300$ K, $D = 1.5\\times 10^{-5}$ m$^2$/s。通过四个用例改变 $\\delta$、$\\Delta T$ 和 $\\beta$ 以测试不同条件：\n$1.$ 正常情况：$\\delta = 2.0\\times 10^{-4}$ m, $\\Delta T = 9.0\\times 10^{2}$ K, $\\beta = 2$。\n$2.$ 边界情况（密度均匀）：$\\delta = 2.0\\times 10^{-4}$ m, $\\Delta T = 0$ K, $\\beta = 2$。\n$3.$ 边缘情况（强热释放，薄层）：$\\delta = 1.5\\times 10^{-4}$ m, $\\Delta T = 1.5\\times 10^{3}$ K, $\\beta = 3$。\n$4.$ 较宽的混合层：$\\delta = 8.0\\times 10^{-4}$ m, $\\Delta T = 1.2\\times 10^{3}$ K, $\\beta = 1$。\n\n您的程序必须：\n$1.$ 构造 $Z(x)$ 并通过双曲正切的解析导数精确计算 $\\frac{dZ}{dx}$。\n$2.$ 使用给定的关系式构造 $T(x)$ 和 $\\rho(x)$。\n$3.$ 计算 $\\chi_Z(x)=2D\\left(\\frac{dZ}{dx}\\right)^2$，然后通过在 $x\\in[0,L]$ 上的数值积分计算 $\\tilde{\\chi_Z}$、$\\bar{\\chi_Z}$ 和 $e$。\n$4.$ 在 $[0,L]$ 上使用足够精细的均匀网格以确保数值精度。\n\n最终输出格式规范：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个三元列表 $[\\tilde{\\chi_Z},\\bar{\\chi_Z},e]$。该行不得包含空格，每个浮点数应格式化为六位小数。例如，输出形式应为 $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$，其中 $a_i$ 和 $b_i$ 的单位是 s$^{-1}$，$c_i$ 是一个十进制小数。",
            "solution": "该问题要求计算和比较一维可变密度混合层中的Favre平均和非Favre（雷诺平均）标量耗散率。这是燃烧理论中的一个典型问题，其中由热释放引起的密度变化会显著影响湍流输运和反应速率。这两种平均方法之间的差异凸显了在可压缩流或反应流中进行密度加权（Favre平均）的重要性。\n\n首先，我们根据所提供的定义，构建必要的解析表达式。混合分数场 $Z(x)$ 由双曲正切剖面给出，这是一维混合层的标准模型：\n$$\nZ(x) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\delta}\\right)\\right)\n$$\n此处，$x \\in [0, L]$。$x_0$ 是混合层的中心，$\\delta$ 是其特征厚度。\n\n瞬时标量耗散率 $\\chi_Z(x)$ 定义为 $\\chi_Z(x) = 2 D (\\nabla Z \\cdot \\nabla Z)$。在我们的以为情况下，这简化为：\n$$\n\\chi_Z(x) = 2 D \\left(\\frac{dZ}{dx}\\right)^2\n$$\n为了计算它，我们首先计算 $Z(x)$ 的解析导数。使用链式法则和恒等式 $\\frac{d}{du}\\tanh(u) = \\text{sech}^2(u)$，我们得到：\n$$\n\\frac{dZ}{dx} = \\frac{1}{2} \\cdot \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right) \\cdot \\frac{1}{\\delta} = \\frac{1}{2\\delta} \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right)\n$$\n将此导数代入 $\\chi_Z(x)$ 的表达式中，可得：\n$$\n\\chi_Z(x) = 2 D \\left(\\frac{1}{2\\delta} \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right)\\right)^2 = \\frac{D}{2\\delta^2} \\text{sech}^4\\left(\\frac{x-x_0}{\\delta}\\right)\n$$\n这个表达式表明 $\\chi_Z(x)$ 是一个正定函数，在 $x=x_0$ 处有尖锐的峰值，并随着远离混合层中心而迅速衰减。\n\n热释放通过温度场 $T(x)$ 进行建模，该温度场是混合分数 $Z(x)$ 的函数：\n$$\nT(x) = T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}\n$$\n此处，$T_u$ 是未燃气体温度，$\\Delta T$ 是总温升，$\\beta$ 是一个形状参数。假设在恒定压力 $p$ 下满足理想气体定律，密度场 $\\rho(x)$ 与温度成反比：\n$$\n\\rho(x) = \\frac{p}{R\\,T(x)} = \\frac{p}{R \\left(T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}\\right)}\n$$\n其中 $R$ 是比气体常数。当 $\\Delta T  0$ 时，在 $Z(x)  0$ 的区域温度升高，导致密度 $\\rho(x)$ 降低。\n\n该问题要求计算在域 $[0,L]$ 上 $\\chi_Z(x)$ 的两种不同空间平均值。\n第一种是非Favre平均，即常规空间平均（类似于雷诺平均），定义为：\n$$\n\\bar{\\chi_Z} = \\frac{1}{L}\\int_{0}^{L} \\chi_Z(x)\\,dx\n$$\n第二种是Favre平均标量耗散率，它是一种密度加权平均：\n$$\n\\tilde{\\chi_Z} = \\frac{\\int_{0}^{L} \\rho(x)\\,\\chi_Z(x)\\,dx}{\\int_{0}^{L} \\rho(x)\\,dx}\n$$\nFavre平均考虑了局部密度变化。如果密度是常数，即 $\\rho(x) = \\rho_0$，则 $\\tilde{\\chi_Z}$ 简化为 $\\bar{\\chi_Z}$。这发生在 $\\Delta T = 0$ 的特殊情况下。\n\n最后，我们通过计算相对差异来量化忽略密度变化所引入的误差：\n$$\ne = \\frac{\\bar{\\chi_Z} - \\tilde{\\chi_Z}}{\\tilde{\\chi_Z}}\n$$\n从物理上讲，$\\chi_Z(x)$ 集中在 $x_0$ 附近的薄混合层中。在这个区域，如果存在热释放（$\\Delta T > 0$），温度会升高，密度会低于未燃区域。因此，与未加权的平均值 $\\bar{\\chi_Z}$ 相比，Favre平均 $\\tilde{\\chi_Z}$ 中的密度加权会减弱来自这个高耗散、低密度区域的贡献。因此，我们预期当 $\\Delta T > 0$ 时，$\\tilde{\\chi_Z}  \\bar{\\chi_Z}$，从而误差 $e$ 为正。\n\n计算 $\\bar{\\chi_Z}$ 和 $\\tilde{\\chi_Z}$ 所需的积分没有简单的解析解，必须进行数值计算。实施策略包括以下步骤：\n$1.$ 将空间域 $[0,L]$ 离散化为由点 $x_i$ 组成的精细均匀网格。选择大量的点以确保薄混合层结构得到很好的解析。\n$2.$ 在每个网格点 $x_i$ 上，使用上面推导的解析公式计算函数 $Z(x_i)$, $\\frac{dZ}{dx}(x_i)$, $\\chi_Z(x_i)$, $T(x_i)$ 和 $\\rho(x_i)$。\n$3.$ 使用数值积分方法，例如梯形法则，来近似计算定积分：$\\int \\chi_Z(x) dx$、$\\int \\rho(x) \\chi_Z(x) dx$ 和 $\\int \\rho(x) dx$。\n$4.$ 根据定义组合积分结果，以计算 $\\bar{\\chi_Z}$、$\\tilde{\\chi_Z}$ 和 $e$。\n$5.$ 对提供的四个测试用例重复此过程，这些用例通过改变层厚度 $\\delta$、温升 $\\Delta T$ 和剖面形状 $\\beta$ 来探索不同的物理状态。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares Favre-averaged and non-Favre-averaged scalar dissipation rates\n    for a one-dimensional, variable-density mixing layer.\n    \"\"\"\n\n    # Define physical constants\n    L = 1.0e-2       # Domain length [m]\n    x0 = L / 2.0     # Flame sheet center [m]\n    p = 1.01325e5    # Pressure [Pa]\n    R = 287.0        # Gas constant for air [J/(kg.K)]\n    Tu = 300.0       # Unburned temperature [K]\n    D = 1.5e-5       # Molecular diffusivity [m^2/s]\n    N = 20001        # Number of grid points for numerical integration\n\n    # Define the four test cases\n    test_cases = [\n        # (delta, Delta_T, beta)\n        (2.0e-4, 9.0e2, 2.0),  # 1. Happy path\n        (2.0e-4, 0.0, 2.0),   # 2. Boundary (uniform density)\n        (1.5e-4, 1.5e3, 3.0),  # 3. Edge (strong heat release, thin layer)\n        (8.0e-4, 1.2e3, 1.0),  # 4. Broader layer\n    ]\n\n    # Create the spatial grid\n    x = np.linspace(0, L, N)\n\n    results = []\n    for case in test_cases:\n        delta, Delta_T, beta = case\n\n        # 1. Construct Z(x) and its analytical derivative dZ/dx\n        arg = (x - x0) / delta\n        Z_x = 0.5 * (1.0 + np.tanh(arg))\n        \n        # dZ/dx = 1/(2*delta) * sech^2((x-x0)/delta)\n        dZ_dx = (1.0 / (2.0 * delta)) * (1.0 / np.cosh(arg))**2\n\n        # 2. Compute the scalar dissipation rate chi_Z(x)\n        chi_Z_x = 2.0 * D * (dZ_dx**2)\n\n        # 3. Construct the temperature T(x) and density rho(x) fields\n        T_x = Tu + Delta_T * (Z_x**beta)\n        rho_x = p / (R * T_x)\n        \n        # 4. Compute the non-Favre average scalar dissipation rate\n        integral_chi_Z = np.trapz(chi_Z_x, x)\n        bar_chi_Z = integral_chi_Z / L\n\n        # 5. Compute the Favre-averaged scalar dissipation rate\n        # Denominator in the Favre average definition\n        integral_rho = np.trapz(rho_x, x)\n        \n        # Numerator in the Favre average definition\n        integral_rho_chi_Z = np.trapz(rho_x * chi_Z_x, x)\n\n        # Handle the case of uniform density to avoid division by zero\n        # although integral_rho will always be positive here.\n        if integral_rho > 0:\n            tilde_chi_Z = integral_rho_chi_Z / integral_rho\n        else: # Should not be reached in this problem\n            tilde_chi_Z = 0.0\n\n        # 6. Compute the fractional error\n        # Handle the case tilde_chi_Z = 0 (e.g., if D=0)\n        if abs(tilde_chi_Z) > 1e-12:\n            error = (bar_chi_Z - tilde_chi_Z) / tilde_chi_Z\n        else:\n            # If tilde_chi_Z is zero, bar_chi_Z must also be zero (for D>0).\n            # The only way they differ slightly is due to numerics in the\n            # uniform density case.\n            error = 0.0\n\n        results.append([tilde_chi_Z, bar_chi_Z, error])\n\n    # Format the final output string as specified\n    formatted_cases = []\n    for res in results:\n        tilde_chi, bar_chi, err = res\n        formatted_cases.append(f\"[{tilde_chi:.6f},{bar_chi:.6f},{err:.6f}]\")\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```"
        }
    ]
}