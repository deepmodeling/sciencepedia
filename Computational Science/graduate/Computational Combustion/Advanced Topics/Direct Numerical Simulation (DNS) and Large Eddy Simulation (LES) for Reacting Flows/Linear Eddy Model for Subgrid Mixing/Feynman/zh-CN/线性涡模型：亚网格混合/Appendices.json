{
    "hands_on_practices": [
        {
            "introduction": "要理解线性涡模型（Linear Eddy Model, LEM）如何增强混合，我们必须首先分析其核心机制——“三线映射”（triplet map）的基本作用。本练习将通过分析该映射对一个简单标量场的影响，揭示其产生剧烈梯度的强大能力，而这正是加速分子扩散的必要第一步。",
            "id": "4036475",
            "problem": "考虑线性涡模型 (Linear Eddy Model, LEM)，其中亚网格尺度上的搅动由作用在长度为 $l$ 的区间上的三线映射表示。设标量场定义在区间 $[0,l]$ 上，初始为线性函数 $\\phi_{0}(x) = a x + b$ (其中 $a \\neq 0$)，并假设没有分子扩散。三线映射 $s:[0,l]\\to[0,l]$ 是一个标准的分段线性重排，其定义如下\n$$\ns(x) = \n\\begin{cases}\n3x, & 0 \\le x  \\frac{l}{3}, \\\\\n2l - 3x,  \\frac{l}{3} \\le x  \\frac{2l}{3}, \\\\\n3x - 2l,  \\frac{2l}{3} \\le x \\le l,\n\\end{cases}\n$$\n该映射将区间压缩3倍，形成三个层，并反转中间层。在无扩散的不可压缩重排下，映射后的标量场为 $\\phi_{1}(x) = \\phi_{0}(s(x))$。\n\n从 $L^2$ 范数和链式法则的定义出发，计算单次三线映射对标量梯度在 $[0,l]$ 上的 $L^2$ 范数的影响，即计算以下比率\n$$\nR \\equiv \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}}.\n$$\n请给出你的最终答案，它应该是一个精确的、无量纲的数字。不要四舍五入。",
            "solution": "用户要求计算在应用单次三线映射前后，标量梯度的 $L^2$ 范数之比。\n\n首先验证该问题，以确保其科学上合理、适定且客观。\n\n### 步骤1：提取已知条件\n-   **定义域**：长度为 $l  0$ 的区间 $[0,l]$。\n-   **初始标量场**：$\\phi_{0}(x) = a x + b$，其中 $a \\neq 0$ 且 $b$ 为常数。\n-   **三线映射**：$s:[0,l]\\to[0,l]$ 定义为\n    $$\n    s(x) =\n    \\begin{cases}\n    3x,  0 \\le x  \\frac{l}{3} \\\\\n    2l - 3x,  \\frac{l}{3} \\le x  \\frac{2l}{3} \\\\\n    3x - 2l,  \\frac{2l}{3} \\le x \\le l\n    \\end{cases}\n    $$\n-   **映射后标量场**：$\\phi_{1}(x) = \\phi_{0}(s(x))$。\n-   **假设**：无分子扩散。\n-   **目标**：计算比率 $R \\equiv \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}}$。\n\n### 步骤2：使用已知条件进行验证\n-   **科学依据**：该问题使用了线性涡模型 (LEM) 中的标准三线映射，LEM是计算燃烧学和湍流理论中公认的模型。所用的数学工具（$L^2$ 范数，链式法则）是标准的。该问题是将数学分析应用于基于物理的模型的一个有效案例。\n-   **适定性**：所有必要组成部分都已定义。初始条件 $\\phi_0(x)$ 已指定，变换 $s(x)$ 已明确给出，目标量 $R$ 是一个定义明确的范数比率。条件 $a \\neq 0$ 确保了分母不为零。存在唯一且有意义的解。\n-   **客观性**：该问题使用精确的数学语言陈述，没有歧义或主观论断。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答\n\n目标是计算比率 $R \\equiv \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}}$。这需要计算初始标量场 $\\phi_0(x)$ 和映射后标量场 $\\phi_1(x)$ 在区间 $[0,l]$ 上的梯度的 $L^2$ 范数。函数 $f(x)$ 在此区间上的 $L^2$ 范数定义为 $\\|f\\|_{L^2(0,l)} = \\sqrt{\\int_0^l (f(x))^2 dx}$。\n\n**1. 分母计算：$\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}$**\n\n首先，我们求初始标量场 $\\phi_{0}(x) = ax + b$ 的梯度。\n$$\n\\partial_x \\phi_0(x) = \\frac{d}{dx}(ax+b) = a\n$$\n接下来，我们计算其 $L^2$ 范数的平方：\n$$\n\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l} (\\partial_x \\phi_0(x))^2 dx = \\int_{0}^{l} a^2 dx\n$$\n由于 $a$ 是常数，积分变为：\n$$\n\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}^{2} = a^2 \\int_{0}^{l} dx = a^2 [x]_{0}^{l} = a^2 l\n$$\n取平方根得到范数：\n$$\n\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)} = \\sqrt{a^2 l} = |a|\\sqrt{l}\n$$\n题目指定 $a \\neq 0$，因此该范数不为零。\n\n**2. 分子计算：$\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}$**\n\n映射后的标量场为 $\\phi_{1}(x) = \\phi_{0}(s(x))$。我们使用链式法则计算其梯度 $\\partial_x \\phi_1(x)$：\n$$\n\\partial_x \\phi_1(x) = \\frac{d}{dx} \\phi_0(s(x)) = (\\phi_0' \\circ s)(x) \\cdot s'(x) = \\phi_0'(s(x)) \\cdot s'(x)\n$$\n由于 $\\phi_0(y) = ay+b$，其导数为 $\\phi_0'(y) = a$。因此，对于任何 $x$，都有 $\\phi_0'(s(x)) = a$。梯度简化为：\n$$\n\\partial_x \\phi_1(x) = a \\cdot s'(x)\n$$\n接下来，我们求分段线性的三线映射的导数 $s'(x)$：\n$$\ns'(x) = \\frac{d}{dx} s(x) =\n\\begin{cases}\n3,  0  x  \\frac{l}{3} \\\\\n-3,  \\frac{l}{3}  x  \\frac{2l}{3} \\\\\n3,  \\frac{2l}{3}  x  l\n\\end{cases}\n$$\n导数在 $x=l/3$ 和 $x=2l/3$ 处未定义，但这些点的测度为零，不影响 $L^2$ 范数的积分值。\n\n现在我们可以写出 $\\partial_x \\phi_1(x)$ 的表达式：\n$$\n\\partial_x \\phi_1(x) =\n\\begin{cases}\n3a,  0  x  \\frac{l}{3} \\\\\n-3a,  \\frac{l}{3}  x  \\frac{2l}{3} \\\\\n3a,  \\frac{2l}{3}  x  l\n\\end{cases}\n$$\n为计算 $\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}$，我们先计算其平方：\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l} (\\partial_x \\phi_1(x))^2 dx\n$$\n我们将积分分到三个子区间上进行计算：\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l/3} (3a)^2 dx + \\int_{l/3}^{2l/3} (-3a)^2 dx + \\int_{2l/3}^{l} (3a)^2 dx\n$$\n在所有三种情况下，被积函数均为 $(3a)^2 = (-3a)^2 = 9a^2$：\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l/3} 9a^2 dx + \\int_{l/3}^{2l/3} 9a^2 dx + \\int_{2l/3}^{l} 9a^2 dx\n$$\n另一种看待这个问题的方式是，$(\\partial_x\\phi_1(x))^2 = (a \\cdot s'(x))^2 = a^2 (s'(x))^2$，并且在 $[0,l]$ 上几乎处处有 $(s'(x))^2 = 9$。因此：\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l} a^2 (s'(x))^2 dx = \\int_{0}^{l} 9a^2 dx\n$$\n计算此积分：\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = 9a^2 \\int_{0}^{l} dx = 9a^2 [x]_{0}^{l} = 9a^2l\n$$\n取平方根得到范数：\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)} = \\sqrt{9a^2l} = 3|a|\\sqrt{l}\n$$\n\n**3. 最终比率计算**\n\n最后，我们计算比率 $R$：\n$$\nR = \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}} = \\frac{3|a|\\sqrt{l}}{|a|\\sqrt{l}}\n$$\n因为 $a \\neq 0$ 且 $l  0$，所以 $|a|$ 和 $\\sqrt{l}$ 项不为零，可以消去。\n$$\nR = 3\n$$\n结果是一个无量纲数，正如预期。对线性标量场应用单次三线映射会将其梯度的 $L^2$ 范数放大3倍。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "在理解了LEM如何产生梯度之后，下一步自然是将此混合过程置于燃烧的背景中进行考量。本练习将挑战您比较亚网格混合的特征时间尺度（由LEM概念建模）与化学反应的时间尺度。计算这个比率，即一个亚网格尺度上的丹寇勒数（Damköhler number），是判断火焰受混合速度控制还是化学反应速度控制的一项关键技能。",
            "id": "4036524",
            "problem": "大涡模拟（LES）燃烧建模的核心任务是量化亚网格尺度燃烧受混合限制还是受化学反应动力学限制。在用于亚网格混合的线性涡模型（LEM）中，滤波宽度上的特征亚网格混合时间尺度由惯性区湍流应变和分子扩散之间的竞争决定。使用第一性原理标度律分析每种机制，并使用一级阿伦尼乌斯动力学分析化学反应，通过评估特征亚网格混合时间与特征化学时间的无量纲比值，确定亚网格燃烧的状态。\n\n假设在等温、统计稳态的湍流中发生单步一级反应。LES滤波宽度为 $\\Delta = 1.5\\,\\mathrm{mm}$，湍动能耗散率为 $\\epsilon = 0.50\\,\\mathrm{m^2\\,s^{-3}}$，混合物分子扩散率为 $D = 2.0 \\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$。温度为 $T = 1500\\,\\mathrm{K}$。反应速率常数遵循阿伦尼乌斯定律，指前因子为 $A = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}$，活化能为 $E_{a} = 8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$。使用普适气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n从惯性区的 Kolmogorov 标度律出发得到尺度 $\\Delta$ 上的特征湍流涡周转时间，从 Fickian 扩散出发得到相同尺度上的特征扩散时间，将亚网格混合时间定义为这两个时间尺度中起主导作用的（较短的）那个。对于化学反应，从一级动力学和阿伦尼乌斯定律出发得到特征化学时间。使用所给参数评估最终的无量纲比值。\n\n将最终数值答案四舍五入至三位有效数字。最终答案不包含单位。计算比值后，根据其大小简要说明亚网格燃烧是混合限制还是动力学限制。",
            "solution": "首先验证问题，确保其科学上合理、良定且客观。\n\n**第1步：提取已知条件**\n- 模型：用于大涡模拟（LES）中亚网格混合的线性涡模型（LEM）。\n- 任务：评估特征亚网格混合时间与特征化学时间的无量纲比值。\n- LES滤波宽度：$\\Delta = 1.5\\,\\mathrm{mm}$\n- 湍动能耗散率：$\\epsilon = 0.50\\,\\mathrm{m^2\\,s^{-3}}$\n- 混合物分子扩散率：$D = 2.0 \\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$\n- 温度：$T = 1500\\,\\mathrm{K}$\n- 反应动力学：一级阿伦尼乌斯定律。\n- 指前因子：$A = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}$\n- 活化能：$E_{a} = 8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$\n- 普适气体常数：$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- 亚网格混合时间（$\\tau_{mix}$）的定义：在尺度 $\\Delta$ 上，湍流涡周转时间（$\\tau_{turb}$）和扩散时间（$\\tau_{diff}$）中较短者。$\\tau_{mix} = \\min(\\tau_{turb}, \\tau_{diff})$。\n- 湍流时间（$\\tau_{turb}$）的定义：源于惯性区 Kolmogorov 标度律。\n- 扩散时间（$\\tau_{diff}$）的定义：源于 Fickian 扩散。\n- 化学时间（$\\tau_{chem}$）的定义：源于一级动力学和阿伦尼乌斯定律。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，借鉴了湍流理论（Kolmogorov 标度律）、分子输运（Fickian 扩散）和化学动力学（阿伦尼乌斯定律）的既定原理。这些概念在计算燃烧领域是标准概念。问题是良定的，提供了所有必要的参数和推导所需时间尺度的明确指令，从而能得到唯一的数值解。语言客观而精确。所提供的物理数值对于燃烧场景而言是一致且现实的。例如，滤波宽度 $\\Delta$ 是火焰大涡模拟的典型尺度，动力学和输运性质的数量级也是合理的。问题结构逻辑清晰，不包含任何矛盾、歧义或未满足的依赖关系。\n\n**第3步：结论与行动**\n问题被判定为有效。将提供完整的解答。\n\n**求解推导**\n\n该问题要求评估一个无量纲比值，即一种形式的 Damköhler 数，以确定亚网格尺度燃烧的控制状态。该比值定义为 $\\mathcal{D} = \\frac{\\tau_{mix}}{\\tau_{chem}}$，其中 $\\tau_{mix}$ 是特征亚网格混合时间，$\\tau_{chem}$ 是特征化学时间。\n\n**1. 特征亚网格混合时间 ($\\tau_{mix}$)**\n\n在 LES 滤波尺度 $\\Delta$ 上，混合时间由两个过程（湍流搅拌和分子扩散）中较快者决定。\n\n首先，我们确定特征湍流涡周转时间 $\\tau_{turb}$。根据 Kolmogorov 关于湍流惯性子区的理论，一个尺寸为 $l$ 的涡周转所需的时间与湍动能耗散率 $\\epsilon$ 相关。在尺度 $\\Delta$ 上，该时间由下式给出：\n$$\n\\tau_{turb} = \\left(\\frac{\\Delta^2}{\\epsilon}\\right)^{1/3}\n$$\n\n其次，我们确定分子扩散的特征时间 $\\tau_{diff}$。根据 Fick 定律，一个物种以扩散率 $D$ 穿过长度尺度 $\\Delta$ 所需的时间为：\n$$\n\\tau_{diff} = \\frac{\\Delta^2}{D}\n$$\n\n问题指出，特征亚网格混合时间 $\\tau_{mix}$ 是这两个时间尺度中较短（起主导作用）的那个：\n$$\n\\tau_{mix} = \\min(\\tau_{turb}, \\tau_{diff})\n$$\n\n现在我们代入给定值，确保所有单位均为国际单位制（SI）。\n$\\Delta = 1.5\\,\\mathrm{mm} = 1.5 \\times 10^{-3}\\,\\mathrm{m}$\n$\\epsilon = 0.50\\,\\mathrm{m^2\\,s^{-3}}$\n$D = 2.0 \\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$\n\n计算 $\\tau_{turb}$：\n$$\n\\tau_{turb} = \\left(\\frac{(1.5 \\times 10^{-3}\\,\\mathrm{m})^2}{0.50\\,\\mathrm{m^2\\,s^{-3}}}\\right)^{1/3} = \\left(\\frac{2.25 \\times 10^{-6}\\,\\mathrm{m^2}}{0.50\\,\\mathrm{m^2\\,s^{-3}}}\\right)^{1/3} = (4.5 \\times 10^{-6}\\,\\mathrm{s^3})^{1/3} \\approx 1.651 \\times 10^{-2}\\,\\mathrm{s}\n$$\n\n计算 $\\tau_{diff}$：\n$$\n\\tau_{diff} = \\frac{(1.5 \\times 10^{-3}\\,\\mathrm{m})^2}{2.0 \\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}} = \\frac{2.25 \\times 10^{-6}\\,\\mathrm{m^2}}{2.0 \\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}} = 1.125 \\times 10^{-1}\\,\\mathrm{s} = 0.1125\\,\\mathrm{s}\n$$\n\n比较两个时间尺度：\n$1.651 \\times 10^{-2}\\,\\mathrm{s}  0.1125\\,\\mathrm{s}$。因此，湍流周转是更快的过程。\n所以，特征混合时间为：\n$$\n\\tau_{mix} = \\tau_{turb} \\approx 1.651 \\times 10^{-2}\\,\\mathrm{s}\n$$\n\n**2. 特征化学时间 ($\\tau_{chem}$)**\n\n问题指定了单步一级反应。此类反应的特征时间是反应速率常数 $k$ 的倒数：\n$$\n\\tau_{chem} = \\frac{1}{k}\n$$\n速率常数 $k$ 遵循阿伦尼乌斯定律：\n$$\nk = A \\exp\\left(-\\frac{E_a}{RT}\\right)\n$$\n其中 $A$ 是指前因子，$E_a$ 是活化能，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n结合这些，化学时间尺度为：\n$$\n\\tau_{chem} = \\frac{1}{A} \\exp\\left(\\frac{E_a}{RT}\\right)\n$$\n\n我们代入给定值：\n$A = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}$\n$E_{a} = 8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 1500\\,\\mathrm{K}$\n\n首先，我们计算指数中的无量纲项：\n$$\n\\frac{E_a}{RT} = \\frac{8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}}{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(1500\\,\\mathrm{K})} = \\frac{8.0 \\times 10^{4}}{12471} \\approx 6.415\n$$\n\n现在，我们计算 $\\tau_{chem}$：\n$$\n\\tau_{chem} = \\frac{1}{2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}} \\exp(6.415) \\approx (0.5 \\times 10^{-7}\\,\\mathrm{s}) \\times (610.9) \\approx 3.055 \\times 10^{-5}\\,\\mathrm{s}\n$$\n\n**3. 无量纲比值与状态识别**\n\n最后，我们计算无量纲比值 $\\mathcal{D}$：\n$$\n\\mathcal{D} = \\frac{\\tau_{mix}}{\\tau_{chem}} \\approx \\frac{1.651 \\times 10^{-2}\\,\\mathrm{s}}{3.055 \\times 10^{-5}\\,\\mathrm{s}} \\approx 540.59\n$$\n\n将结果四舍五入至三位有效数字，得到 $541$。\n\n这个比值，即 Damköhler 数（$Da$），比较了混合时间尺度与化学反应时间尺度。\n- 如果 $Da \\gg 1$，则 $\\tau_{mix} \\gg \\tau_{chem}$。这意味着化学反应比混合快得多。整个过程受限于较慢的步骤，即混合。这是**混合限制**状态。\n- 如果 $Da \\ll 1$，则 $\\tau_{mix} \\ll \\tau_{chem}$。这意味着混合比化学反应快得多。过程受限于较慢的化学反应。这是**动力学限制**状态。\n\n由于我们计算出的值是 $\\mathcal{D} \\approx 541$，远大于 $1$，因此亚网格燃烧过程是**混合限制**的。",
            "answer": "$$\n\\boxed{541}\n$$"
        },
        {
            "introduction": "理论和标度分析能为我们提供深刻见解，但对混合过程的全面理解源于对其动态演化的观察。这项计算练习将指导您模拟湍流搅拌（三线映射）与分子扩散随时间的相互作用。通过追踪标量方差的衰减，您将直接量化混合速率，并探索其如何受到关键物理参数——施密特数（Schmidt number）的影响。",
            "id": "4036493",
            "problem": "要求您为计算燃烧学实现一个用于亚格子混合的一维线性涡模型（LEM），其中一个被动标量通过三线映射经历分子扩散和保测搅动的交替过程。目标是计算标量方差的演化，并量化其如何依赖于施密特数（运动粘度与分子扩散率之比）。\n\n起始点和建模假设：\n- 考虑一个长度为 $L$ 的一维周期性域，其空间坐标为 $x \\in [0,L)$，以及一个由 $N$ 个均匀间隔点组成的计算网格。\n- 被动标量场 $Y(x,t)$ 根据对流-扩散方程演化\n$$\n\\frac{\\partial Y}{\\partial t} + u(x,t)\\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^2 Y}{\\partial x^2},\n$$\n其中 $D$ 是分子扩散率，$u(x,t)$ 是一个湍流速度场。在线性涡模型中，$u(x,t)$ 的效应被建模为施加在一个区间上的瞬时保测重排，称为三线映射，而在这些重排之间，标量通过纯扩散演化。\n\n- 运动粘度规定为 $\\nu$（单位为 $\\mathrm{m^2/s}$），分子扩散率由施密特数 $Sc = \\nu/D$ 确定。因此 $D = \\nu/Sc$。\n\n初始条件和演化协议：\n- 设初始标量为一个阶跃函数：\n$$\nY(x,0) = \\begin{cases}\n1,  0 \\le x  L/2,\\\\\n0,  L/2 \\le x  L,\n\\end{cases}\n$$\n即在 $x = L/2$ 处存在一个间断点。\n- 通过交替进行 $M$ 个循环来演化标量：\n  1. 一个持续时间为 $\\Delta t$ 的纯扩散周期，采用周期性边界条件。通过根据以下公式更新每个傅里叶模态 $\\hat{Y}_k$，在谱空间中精确实现此扩散步骤：\n  $$\n  \\hat{Y}_k(t+\\Delta t) = \\hat{Y}_k(t)\\,\\exp\\!\\left(-D\\,k^2\\,\\Delta t\\right),\n  $$\n  其中 $k = 2\\pi n/L$，整数 $n$ 是傅里叶模态的索引。\n  2. 一个确定性地应用于长度为 $f L$ 的中心区间 $[a,b]$ 上的三线映射，其中 $f \\in (0,1]$ 是涡长分数。三线映射将 $[a,b]$ 的内容替换为三个等长的自身压缩副本，其中中间的副本反转，并保持 $[a,b]$ 之外的标量不变。该映射必须在计算网格上使用线性插值，实现为 $[a,b]$ 上的分段线性、保测重排。该区间应中心放置，使得 $a = (L - fL)/2$ 且 $b = a + fL$。\n\n关注的量：\n- 域平均均值为\n$$\n\\overline{Y}(t) = \\frac{1}{L}\\int_0^L Y(x,t)\\,\\mathrm{d}x,\n$$\n标量方差为\n$$\n\\sigma^2(t) = \\frac{1}{L}\\int_0^L \\left(Y(x,t) - \\overline{Y}(t)\\right)^2 \\mathrm{d}x.\n$$\n在均匀网格上，计算在最终时间 $t = M\\Delta t$ 时 $\\sigma^2(t)$ 的离散近似值。\n\n物理单位和数值规格：\n- 使用 $L = 1\\,\\mathrm{m}$，$N = 2048$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$M = 40$，以及 $\\Delta t = 0.02\\,\\mathrm{s}$。标量 $Y$ 是无量纲的。将最终的标量方差报告为无量纲量。\n\n测试套件：\n对于每个测试用例，设置施密特数 $Sc$ 和涡长分数 $f$，计算 $D=\\nu/Sc$，执行上述演化协议，并以十进制浮点数形式返回最终的标量方差 $\\sigma^2(M\\Delta t)$。使用以下五个测试用例：\n- 用例 1：$Sc = 0.7$, $f = 0.6$。\n- 用例 2：$Sc = 1.0$, $f = 0.3$。\n- 用例 3：$Sc = 10.0$, $f = 0.6$。\n- 用例 4：$Sc = 100.0$, $f = 0.6$。\n- 用例 5：$Sc = 1.0$, $f = 1.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的最终标量方差，按顺序排列为一个用方括号括起来的逗号分隔列表，每个值格式化为小数点后恰好 $8$ 位数字，例如 $[v_1,v_2,v_3,v_4,v_5]$。",
            "solution": "该问题陈述在科学和数学上均被评估为合理。它提供了一个完整且自洽的数值任务描述，植根于计算流体动力学和湍流模型的既定原则。具体来说，它详细说明了用于被动标量混合的一维线性涡模型（LEM）的实现，这是燃烧科学中一种公认的亚格子尺度模型。参数、初始/边界条件和演化协议都得到了明确指定，确保了问题的适定性。该模型将谱空间中扩散方程的解析解与保测三线映射的应用相结合，这两种方法都是标准且可形式化的技术。不存在矛盾、缺失数据或违反物理原理的情况。因此，该问题被认为是有效的，可以构建一个合理的解决方案。\n\n该解决方案需要在长度为 $L$、由 $N$ 个网格点离散化的一维周期性域上，对标量场 $Y(x,t)$ 的演化进行数值模拟。模拟总共进行 $M$ 个循环，每个循环包括一个分子扩散步骤，其后是一个由三线映射建模的湍流搅动步骤。\n\n**1. 系统初始化**\n\n- 空间域是区间 $x \\in [0, L)$，其长度指定为 $L = 1\\,\\mathrm{m}$。\n- 定义一个包含 $N=2048$ 个点的均匀计算网格， $x_j = j \\frac{L}{N}$，其中 $j = 0, 1, \\dots, N-1$。\n- 初始标量场 $Y(x,0)$ 是一个由下式描述的阶跃函数：\n$$\nY(x_j, 0) = \\begin{cases} 1  \\text{for } x_j  L/2 \\\\ 0  \\text{for } x_j \\ge L/2 \\end{cases}\n$$\n- 谱扩散步骤需要与离散网格对应的角波数 $k$。对于长度为 $L$、包含 $N$ 个点的域，空间频率为 $\\nu_n = n/L$。相应的角波数为 $k_n = 2\\pi\\nu_n$。这些可以使用 `numpy.fft.fftfreq` 函数高效计算，该函数返回的频率 $\\nu_n$ 的顺序与快速傅里叶变换 (FFT) 算法兼容。\n- 对于每个由施密特数 $Sc$ 和涡长分数 $f$ 定义的测试用例，分子扩散率 $D$ 是根据给定的运动粘度 $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$ 和定义 $Sc=\\nu/D$ 计算得出的，即 $D = \\nu/Sc$。\n\n**2. 时间演化协议**\n\n系统演化 $M=40$ 个循环，每个循环代表一个时间间隔 $\\Delta t=0.02\\,\\mathrm{s}$。对于每个循环，从时间 $t$到 $t+\\Delta t$，按顺序执行以下两个步骤。\n\n**2.1. 扩散步骤**\n此步骤模拟分子扩散效应。通过在周期 $\\Delta t$ 内求解纯扩散方程 $\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial x^2}$（采用周期性边界条件）来推进标量场 $Y(x,t)$。\n- 使用 FFT 将场 $Y(x,t)$ 变换到傅里叶空间，以获得其谱表示 $\\hat{Y}(k,t)$。\n- 在傅里叶空间中，扩散方程对于每个模态 $k$ 变成一个常微分方程，其精确解为：\n$$\n\\hat{Y}(k, t+\\Delta t) = \\hat{Y}(k, t) \\exp(-D k^2 \\Delta t)\n$$\n- 因子 $\\exp(-Dk^2\\Delta t)$ 是一个谱传递函数，它更强烈地衰减高波数模态，代表了标量梯度的粘性耗散。\n- 更新后的谱场 $\\hat{Y}(k, t+\\Delta t)$ 使用逆傅里叶变换 (IFFT) 转换回物理空间。其结果，我们可以表示为 $Y^*(x, t+\\Delta t)$，是扩散后的标量场。取 IFFT 输出的实部，因为初始场是实数，任何虚部分量都是由数值浮点误差引起的。\n\n**2.2. 三线映射（搅动）步骤**\n此步骤模拟湍流涡的扰乱效应。它被实现为在一个指定区间内对标量场的瞬时、保测重排。\n- 三线映射应用于扩散后的场 $Y^*(x, t+\\Delta t)$，以生成该循环的最终场 $Y(x, t+\\Delta t)$。\n- 该映射应用于长度为 $L_{eddy} = fL$ 的中心区间 $[a,b]$，其中 $a = (L - L_{eddy})/2$ 且 $b = a + L_{eddy}$。此区间外的标量值不受影响。\n- 对于位于 $[a,b]$ 内的网格点 $x_j$，新的标量值 $Y(x_j, t+\\Delta t)$ 是通过在源坐标集 $x_{source, j}$ 处对映射前的场 $Y^*(x, t+\\Delta t)$ 进行插值来确定的。函数 $T: x_j \\mapsto x_{source, j}$ 定义了该映射。对于三线映射，它是：\n$$\nT(x) = \\begin{cases}\na + 3(x - a)  \\text{if } a \\le x \\le a + L_{eddy}/3, \\\\\nb - 3(x - [a + L_{eddy}/3])  \\text{if } a + L_{eddy}/3  x \\le a + 2L_{eddy}/3, \\\\\na + 3(x - [a + 2L_{eddy}/3])  \\text{if } a + 2L_{eddy}/3  x \\le b.\n\\end{cases}\n$$\n该映射获取区间 $[a,b]$ 上的标量场，将其三倍压缩，并将三个副本放回 $[a,b]$ 中，其中中间的副本被反转。\n- 由于源坐标 $x_{source, j} = T(x_j)$ 通常不会落在网格点上，因此需要按规定进行线性插值。使用带有 `period=L` 选项的 `numpy.interp` 来计算 $Y^*(x_{source, j}, t+\\Delta t)$ 的值，以正确处理域的周期性。\n\n**3. 最终方差计算**\n\n- 完成所有 $M$ 个循环后，模拟在最终时间 $t_{final} = M\\Delta t$ 结束。\n- 最终标量方差 $\\sigma^2(t_{final})$ 是根据最终标量场 $Y(x, t_{final})$ 计算的。在离散网格上，这是对所有网格点的平均。\n- 首先，计算域平均标量值：\n$$\n\\overline{Y} = \\frac{1}{N} \\sum_{j=0}^{N-1} Y(x_j, t_{final})\n$$\n- 然后，方差是与均值的平方偏差的均值：\n$$\n\\sigma^2 = \\frac{1}{N} \\sum_{j=0}^{N-1} (Y(x_j, t_{final}) - \\overline{Y})^2\n$$\n- 对所提供的五个 $(Sc, f)$ 测试用例中的每一个重复此整个过程。得到的五个方差值被格式化并作为最终答案呈现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Linear Eddy Model simulation for all test cases\n    and print the results in the specified format.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.7, 0.6),   # Case 1: Sc = 0.7, f = 0.6\n        (1.0, 0.3),   # Case 2: Sc = 1.0, f = 0.3\n        (10.0, 0.6),  # Case 3: Sc = 10.0, f = 0.6\n        (100.0, 0.6), # Case 4: Sc = 100.0, f = 0.6\n        (1.0, 1.0)    # Case 5: Sc = 1.0, f = 1.0\n    ]\n\n    results = []\n    for sc, f in test_cases:\n        # Run the simulation for one case.\n        variance = run_lem_simulation(sc, f)\n        results.append(variance)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\n\ndef run_lem_simulation(sc: float, f: float) - float:\n    \"\"\"\n    Performs a one-dimensional Linear Eddy Model simulation for a passive scalar.\n\n    Args:\n        sc: The Schmidt number (Sc = nu/D).\n        f: The eddy-length fraction for the triplet map.\n\n    Returns:\n        The final scalar variance after M cycles.\n    \"\"\"\n    # Physical and numerical specifications from the problem statement\n    L = 1.0            # Domain length [m]\n    N = 2048           # Number of grid points\n    nu = 1.5e-5        # Kinematic viscosity [m^2/s]\n    M = 40             # Number of evolution cycles\n    dt = 0.02          # Time step duration [s]\n\n    # Derived parameters\n    D = nu / sc        # Molecular diffusivity [m^2/s]\n\n    # Set up computational grids\n    # Spatial grid\n    x = np.linspace(0, L, N, endpoint=False)\n    # Wavenumber grid for FFT\n    dx = L / N\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Initial condition: step function\n    Y = np.zeros(N, dtype=np.float64)\n    Y[x  L / 2] = 1.0\n\n    # Pre-calculate the spectral diffusion operator for efficiency\n    diffusion_operator = np.exp(-D * k**2 * dt)\n\n    # Main evolution loop\n    for _ in range(M):\n        # --- Step 1: Diffusion in spectral space ---\n        Y_hat = np.fft.fft(Y)\n        Y_hat *= diffusion_operator\n        Y = np.real(np.fft.ifft(Y_hat))\n\n        # --- Step 2: Triplet map stirring in physical space ---\n        Y_old = Y.copy()\n        \n        L_eddy = f * L\n        a = (L - L_eddy) / 2\n        b = a + L_eddy\n\n        # Identify grid points within the mapping interval [a, b)\n        map_indices = np.where((x = a)  (x  b))[0]\n        \n        if map_indices.size  0:\n            x_target = x[map_indices]\n            x_source = np.zeros_like(x_target)\n            \n            # Define boundaries of the three sub-regions for the map\n            b1 = a + L_eddy / 3\n            b2 = a + 2 * L_eddy / 3\n            \n            # Create boolean masks for each sub-region\n            mask1 = x_target = b1\n            mask2 = (x_target  b1)  (x_target = b2)\n            mask3 = x_target  b2\n            \n            # Apply the piecewise-linear triplet map to get source coordinates\n            x_source[mask1] = a + 3 * (x_target[mask1] - a)\n            x_source[mask2] = b - 3 * (x_target[mask2] - b1)\n            x_source[mask3] = a + 3 * (x_target[mask3] - b2)\n\n            # Interpolate values from the old field at source coordinates\n            # Use period=L for correct handling of periodic boundary conditions\n            Y[map_indices] = np.interp(x_source, x, Y_old, period=L)\n\n    # Calculate final scalar variance\n    mean_Y = np.mean(Y)\n    variance = np.mean((Y - mean_Y)**2)\n    \n    return variance\n\nsolve()\n```"
        }
    ]
}