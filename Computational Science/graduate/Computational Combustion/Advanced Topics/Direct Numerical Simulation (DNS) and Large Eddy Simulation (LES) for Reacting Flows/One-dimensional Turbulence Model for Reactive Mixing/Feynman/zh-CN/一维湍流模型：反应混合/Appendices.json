{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的湍流模型之前，理解反应混合层的基本结构是至关重要的第一步。本练习旨在通过一个简化的、但物理上极为重要的对冲流场，探索对流与分子扩散之间的稳态平衡。通过求解该问题 ，您不仅能巩固求解微分方程的技能，还将推导出标量耗散率 $\\chi$——这是燃烧模型中一个量化微观尺度分子混合强度的关键参数，从而为更复杂的湍流模拟提供一个解析基准。",
            "id": "4046540",
            "problem": "考虑计算燃烧学中的一个逆流混合层，其中一维反应混合由守恒混合分数 $Z(x,t)$ 建模。假设密度恒定，分子扩散为菲克扩散且分子扩散系数 $D$ 恒定，并且沿法向坐标 $x$ 的流动为稳态不可压缩驻点流，其特征是均匀应变率 $S>0$，产生的速度场为 $u(x)=-Sx$。从被动标量的守恒定律出发，并仅使用所述的物理假设，完成以下任务：(i) 推导 $Z(x)$ 的稳态常微分方程，(ii) 在边界条件 $Z(-\\infty)=1$ 和 $Z(\\infty)=0$ 下求解 $Z(x)$，以及 (iii) 从标量方差收支方程出发，推导在一维空间中且 $D$ 为常数时，用 $Z(x)$ 表示的局域标量耗散率 $\\chi(x)$。然后，使用您推导的表达式，计算混合层中心线 $x=0$ 处的标量耗散率。使用参数值 $S=120\\,\\text{s}^{-1}$ 和 $D=2.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。最终的标量耗散率 $\\chi(0)$ 以 $\\text{s}^{-1}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先将对问题陈述进行验证，以确保其具有科学依据、适定且客观。\n\n### 第 1 步：提取已知条件\n- **系统**：逆流混合层中的一维反应混合。\n- **变量**：守恒混合分数 $Z(x,t)$。\n- **物理**：恒定密度，菲克扩散与恒定分子扩散系数 $D$。\n- **流场**：沿法向坐标 $x$ 的稳态、不可压缩驻点流。\n- **速度**：$u(x)=-Sx$，其中 $S > 0$ 为均匀应变率。\n- **边界条件**：$Z(-\\infty)=1$ 和 $Z(\\infty)=0$。\n- **任务**：\n  1. 推导 $Z(x)$ 的稳态常微分方程 (ODE)。\n  2. 在给定边界条件下求解 $Z(x)$。\n  3. 从标量方差收支方程出发，推导在一维空间中且 $D$ 为常数时，用 $Z(x)$ 表示的局域标量耗散率 $\\chi(x)$。\n  4. 计算混合层中心线 $x=0$ 处的 $\\chi(x)$。\n- **参数**：$S=120\\,\\text{s}^{-1}$ 和 $D=2.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n- **输出规格**：$\\chi(0)$ 的最终答案应以 $\\text{s}^{-1}$ 为单位，并四舍五入到四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题描述了计算燃烧学和流体动力学中的一个典型模型，常用于研究层流扩散火焰或混合层。其假设和设置是推导解析解的标准方法。\n\n- **科学依据**：该问题基于标量守恒的基本定律，包含了在指定速度场中的菲克扩散和对流。驻点流模型是用于逆流配置的成熟近似方法。所有方面都牢固地植根于输运现象和燃烧理论。\n- **适定性**：该问题指定了一个带有两个边界条件的二阶常微分方程，这构成了一个适定的边值问题，其存在唯一的稳定解。\n- **客观性**：该问题使用精确、标准的科学术语进行陈述，没有任何歧义或主观论断。\n\n一个可能引起混淆的地方是，陈述中提到“不可压缩”流，但其一维速度场为 $u(x)=-Sx$，其散度 $du/dx = -S \\neq 0$。这个表面上的矛盾可以通过认识到此一维模型是更高维流动的简化来解决，例如二维平面流 $\\mathbf{v} = (-Sx, Sy)$，其散度为 $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = -S + S = 0$。该模型假设 $Z$ 在横向上的梯度可以忽略不计，这是一个标准的边界层类型近似。因此，该问题是内部自洽且科学合理的。\n\n### 第 3 步：结论与行动\n该问题是有效的。将提供一个完整的、合理的解答。\n\n### (i) $Z(x)$ 的稳态常微分方程的推导\n\n在一维区域内，标量 $Z$ 的守恒定律由对流-扩散方程给出。对于恒定密度（不可压缩）流，该方程为：\n$$ \\frac{\\partial Z}{\\partial t} + u \\frac{\\partial Z}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( D \\frac{\\partial Z}{\\partial x} \\right) $$\n问题指定了稳态条件，因此时间导数项为零：$\\frac{\\partial Z}{\\partial t} = 0$。该方程变为关于 $x$ 的常微分方程：\n$$ u \\frac{dZ}{dx} = \\frac{d}{dx} \\left( D \\frac{dZ}{dx} \\right) $$\n给定分子扩散系数 $D$ 为常数，速度场为 $u(x) = -Sx$。将这些代入方程得到：\n$$ (-Sx) \\frac{dZ}{dx} = D \\frac{d^2Z}{dx^2} $$\n将各项重新排列成线性二阶常微分方程的标准形式，我们得到：\n$$ D \\frac{d^2Z}{dx^2} + Sx \\frac{dZ}{dx} = 0 $$\n这就是所求的混合分数 $Z(x)$ 的稳态常微分方程。\n\n### (ii) $Z(x)$ 的常微分方程的求解\n\n在第 (i) 部分推导出的常微分方程是一个变系数的二阶线性齐次方程。我们可以通过降阶法求解。令 $Y(x) = \\frac{dZ}{dx}$。该常微分方程变为关于 $Y$ 的一阶方程：\n$$ D \\frac{dY}{dx} + Sx Y = 0 $$\n这是一个可分离变量方程：\n$$ D \\frac{dY}{dx} = -Sx Y $$\n$$ \\frac{dY}{Y} = -\\frac{S}{D} x \\, dx $$\n对两边积分：\n$$ \\int \\frac{dY}{Y} = \\int -\\frac{S}{D} x \\, dx $$\n$$ \\ln(Y) = -\\frac{S}{D} \\frac{x^2}{2} + C_0 $$\n其中 $C_0$ 是积分常数。对两边取指数，得到 $Y(x)$：\n$$ Y(x) = \\exp\\left(-\\frac{S x^2}{2D} + C_0\\right) = C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\n其中 $C_1 = \\exp(C_0)$ 是一个新的常数。现在，我们将 $Y(x) = \\frac{dZ}{dx}$ 代回，并对 $x$ 积分以求得 $Z(x)$：\n$$ \\frac{dZ}{dx} = C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\n$$ Z(x) = \\int C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) dx + C_2 $$\n该积分与误差函数 $\\text{erf}(z) \\equiv \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-t^2) dt$ 相关。设指数的自变量为 $-t^2$，则 $t = x \\sqrt{\\frac{S}{2D}}$。于是 $dx = \\sqrt{\\frac{2D}{S}} dt$。积分变为：\n$$ \\int \\exp\\left(-\\frac{S x^2}{2D}\\right) dx = \\sqrt{\\frac{2D}{S}} \\int \\exp(-t^2) dt = \\sqrt{\\frac{2D}{S}} \\left( \\frac{\\sqrt{\\pi}}{2} \\text{erf}(t) \\right) = \\sqrt{\\frac{D\\pi}{2S}} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) $$\n因此，$Z(x)$ 的通解为：\n$$ Z(x) = C_1 \\sqrt{\\frac{D\\pi}{2S}} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + C_2 $$\n为简单起见，我们定义新的常数 $A = C_1 \\sqrt{D\\pi/(2S)}$ 和 $B=C_2$：\n$$ Z(x) = A \\, \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + B $$\n我们现在应用边界条件 $Z(-\\infty)=1$ 和 $Z(\\infty)=0$，并使用误差函数的性质 $\\text{erf}(\\infty)=1$ 和 $\\text{erf}(-\\infty)=-1$。\n对于 $x \\rightarrow \\infty$：\n$$ Z(\\infty) = A(1) + B = 0 \\implies B = -A $$\n对于 $x \\rightarrow -\\infty$：\n$$ Z(-\\infty) = A(-1) + B = 1 \\implies -A + B = 1 $$\n将 $B = -A$ 代入第二个方程：\n$$ -A + (-A) = 1 \\implies -2A = 1 \\implies A = -\\frac{1}{2} $$\n这得到 $B = -A = \\frac{1}{2}$。\n将常数 $A$ 和 $B$ 代回 $Z(x)$ 的解中：\n$$ Z(x) = -\\frac{1}{2} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + \\frac{1}{2} = \\frac{1}{2} \\left[1 - \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right)\\right] $$\n此解可以使用互补误差函数 $\\text{erfc}(z) = 1 - \\text{erf}(z)$ 更紧凑地表示：\n$$ Z(x) = \\frac{1}{2} \\text{erfc}\\left(x \\sqrt{\\frac{S}{2D}}\\right) $$\n\n### (iii) 标量耗散率 $\\chi(x)$ 的推导\n\n标量耗散率 $\\chi$ 是衡量标量脉动被分子扩散所耗散的速率。对于具有恒定扩散系数 $D$ 的一维系统，其定义为：\n$$ \\chi(x) = 2D \\left(\\frac{dZ}{dx}\\right)^2 $$\n为了求得 $\\chi(x)$，我们必须首先计算 $Z(x)$ 的导数。利用第 (ii) 部分的解和性质 $\\frac{d}{dz}(\\text{erfc}(z)) = -\\frac{2}{\\sqrt{\\pi}}\\exp(-z^2)$：\n$$ \\frac{dZ}{dx} = \\frac{d}{dx} \\left[ \\frac{1}{2} \\text{erfc}\\left(x \\sqrt{\\frac{S}{2D}}\\right) \\right] $$\n应用链式法则，其中内函数为 $w(x) = x \\sqrt{\\frac{S}{2D}}$ 且 $\\frac{dw}{dx} = \\sqrt{\\frac{S}{2D}}$：\n$$ \\frac{dZ}{dx} = \\frac{1}{2} \\left[ -\\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(x\\sqrt{\\frac{S}{2D}}\\right)^2\\right) \\right] \\left( \\sqrt{\\frac{S}{2D}} \\right) $$\n$$ \\frac{dZ}{dx} = -\\frac{1}{\\sqrt{\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) \\sqrt{\\frac{S}{2D}} = -\\sqrt{\\frac{S}{2D\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\n现在，我们将此导数代入 $\\chi(x)$ 的定义中：\n$$ \\chi(x) = 2D \\left[ -\\sqrt{\\frac{S}{2D\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) \\right]^2 $$\n$$ \\chi(x) = 2D \\left[ \\frac{S}{2D\\pi} \\exp\\left(-2 \\cdot \\frac{S x^2}{2D}\\right) \\right] $$\n$$ \\chi(x) = \\frac{S}{\\pi} \\exp\\left(-\\frac{S x^2}{D}\\right) $$\n此表达式给出了局域标量耗散率作为位置 $x$ 的函数。\n\n### $\\chi(0)$ 的计算\n\n题目要求计算混合层中心线 $x=0$ 处的标量耗散率。在该点，$Z(0) = \\frac{1}{2}\\text{erfc}(0) = \\frac{1}{2}$。我们在 $x=0$ 处计算 $\\chi(x)$ 的值：\n$$ \\chi(0) = \\frac{S}{\\pi} \\exp\\left(-\\frac{S (0)^2}{D}\\right) = \\frac{S}{\\pi} \\exp(0) = \\frac{S}{\\pi} $$\n注意，$\\chi(0)$ 的值仅取决于应变率 $S$，而与扩散系数 $D$ 无关。\n给定 $S=120\\,\\text{s}^{-1}$。将此值代入 $\\chi(0)$ 的表达式中：\n$$ \\chi(0) = \\frac{120}{\\pi} \\, \\text{s}^{-1} $$\n现在，我们计算其数值并四舍五入到四位有效数字：\n$$ \\chi(0) \\approx 38.197186... \\, \\text{s}^{-1} $$\n四舍五入到四位有效数字得到：\n$$ \\chi(0) \\approx 38.20 \\, \\text{s}^{-1} $$",
            "answer": "$$\\boxed{38.20}$$"
        },
        {
            "introduction": "在掌握了连续介质物理之后，我们需要将这些复杂的方程转化为可在计算机上求解的数值格式。算子分裂法是一种强大而高效的技术，尤其适用于处理像反应与扩散这样具有悬殊时间尺度的多物理过程。本练习  深入剖析了常用的Lie分裂法，其核心在于揭示扩散算子 $\\mathcal{D}$ 与反应算子 $\\mathcal{R}$ 的不可交换性，正是这种不可交换性导致了分裂误差的产生。通过推导并量化由算子对易子 $[ \\mathcal{D}, \\mathcal{R} ]$ 定义的分裂误差，您将深刻理解数值模拟的精度来源与限制，这是计算科学家必须具备的核心素养。",
            "id": "4046415",
            "problem": "考虑一个单组分、等温反应混合问题，该问题是一维空间上的，代表了计算燃烧学中一维湍流（ODT）建模框架。组分质量分数 $Y(x,t)$ 在半线性反应扩散方程下演化\n$$\n\\frac{\\partial Y}{\\partial t} \\;=\\; \\kappa\\,\\frac{\\partial^{2}Y}{\\partial x^{2}} \\;+\\; \\omega(Y),\n$$\n其中 $\\kappa>0$ 是分子扩散系数，$\\omega(Y)$ 是反应源项。在特征化学时间尺度 $\\tau_{\\text{chem}}$ 远小于扩散时间尺度 $\\tau_{\\text{diff}}$ (即 $\\tau_{\\text{chem}}\\ll\\tau_{\\text{diff}}$) 的情况下，采用带有反应子循环的算子分裂积分器对大小为 $\\Delta t$ 的宏观步长进行积分：反应子问题在 $N$ 个大小为 $\\delta t=\\Delta t/N$ 的子步长中推进（假设反应子步长被精确积分），而扩散子问题在每个宏观步长中推进一次。Lie 分裂宏观步长为\n$$\n\\text{Lie}(\\Delta t):\\quad Y^{n+1}\\;=\\;\\Phi_{\\mathcal{D}}(\\Delta t)\\,\\Phi_{\\mathcal{R}}(\\Delta t)\\,Y^{n},\n$$\n其中 $\\Phi_{\\mathcal{D}}(\\Delta t)$ 和 $\\Phi_{\\mathcal{R}}(\\Delta t)$ 分别表示在 $\\Delta t$ 时间内扩散和反应子问题的精确解算子。在相同区间内，对于完整生成元 $\\mathcal{L}=\\mathcal{D}+\\mathcal{R}$ 的精确非分裂演化用 $\\Phi_{\\mathcal{L}}(\\Delta t)$ 表示。\n\n从基本的反应扩散方程和 Lie 乘积的定义出发，推导在一个宏观步长内以对易子 $[\\mathcal{D},\\mathcal{R}]$ 和算子范数表示的主阶局部算子分裂误差。明确论证为什么在 $\\tau_{\\text{chem}}\\ll\\tau_{\\text{diff}}$ 的极限情况下，反应子循环（每个子步长中进行精确反应积分）不会改变主阶分裂误差项。\n\n然后，在如下具体的离散化设置中量化此界。设空间域是周期性的，长度为 $L$，并离散化为 $M$ 个等距节点。使用二阶中心有限差分拉普拉斯算子来定义作用于节点质量分数向量 $\\mathbf{Y}$ 上的离散扩散算子 $\\mathbf{D}=\\kappa \\mathbf{L}$。将反应源项在当前状态 $\\mathbf{Y}^{n}$ 周围线性化，以定义对角雅可比算子 $\\mathbf{R}=\\mathrm{diag}\\left(\\omega'(Y_{1}^{n}),\\dots,\\omega'(Y_{M}^{n})\\right)$，并使用矩阵对易子 $[\\mathbf{D},\\mathbf{R}]=\\mathbf{D}\\mathbf{R}-\\mathbf{R}\\mathbf{D}$ 来界定局部算子分裂误差。\n\n对于以下科学上一致的参数集，计算对易子的 Frobenius 范数以及局部算子分裂误差的相应主阶界：\n- $L=0.03$ (米)，$M=3$ 因此 $h=L/M$，\n- $\\kappa=1.0\\times 10^{-4}$ (平方米/秒)，\n- $\\omega(Y)=k\\,Y\\,(1-Y)$ 其中 $k=1.0\\times 10^{3}$ (秒的倒数)，\n- $\\mathbf{Y}^{n}=\\bigl[0.2,\\;0.5,\\;0.8\\bigr]^{\\mathsf{T}}$，\n- $\\Delta t=0.01$ (秒)，\n- 周期性边界条件，因此离散拉普拉斯算子为 $\\mathbf{L}=\\frac{1}{h^{2}}\\begin{pmatrix}-2 & 1 & 1 \\\\ 1 & -2 & 1 \\\\ 1 & 1 & -2\\end{pmatrix}$。\n\n使用 Frobenius 范数得出一个 Lie 分裂宏观步长后算子误差的保守上界，\n$$\n\\left\\|\\Phi_{\\mathcal{D}}(\\Delta t)\\,\\Phi_{\\mathcal{R}}(\\Delta t)-\\Phi_{\\mathcal{L}}(\\Delta t)\\right\\| \\;\\lesssim\\; \\frac{1}{2}\\,\\Delta t^{2}\\,\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F},\n$$\n并提供给定参数下右侧的最终数值。将最终答案四舍五入到四位有效数字，并以质量分数（无量纲）的形式表示。",
            "solution": "该问题要求完成两项任务：首先，推导 Lie 分裂积分器的主阶局部算子分裂误差，并论证反应子循环的作用；其次，对一个特定的离散化反应扩散系统量化此误差。\n\n首先，我们处理局部算子分裂误差的理论推导。控制半线性反应扩散方程由下式给出\n$$ \\frac{\\partial Y}{\\partial t} \\;=\\; \\kappa\\,\\frac{\\partial^{2}Y}{\\partial x^{2}} \\;+\\; \\omega(Y) \\;=\\; (\\mathcal{D} + \\mathcal{R})Y \\;=\\; \\mathcal{L}Y $$\n其中 $\\mathcal{D} = \\kappa \\frac{\\partial^2}{\\partial x^2}$，$\\mathcal{R}$ 是对应于乘以反应源项 $\\omega(\\cdot)$ 的算子。在大小为 $\\Delta t$ 的时间步长上的精确解可以正式地使用解算子 $\\Phi_{\\mathcal{L}}(\\Delta t) = \\exp(\\mathcal{L}\\Delta t)$ 写出。\n\n精确算子在 $\\Delta t$ 上的泰勒级数展开得到：\n$$ \\Phi_{\\mathcal{L}}(\\Delta t) = \\exp((\\mathcal{D}+\\mathcal{R})\\Delta t) = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}+\\mathcal{R})^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n展开二阶项得到：\n$$ \\Phi_{\\mathcal{L}}(\\Delta t) = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}^{2} + \\mathcal{D}\\mathcal{R} + \\mathcal{R}\\mathcal{D} + \\mathcal{R}^{2})\\Delta t^{2} + O(\\Delta t^{3}) $$\nLie 分裂近似由各个精确解算子的乘积给出，$\\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) = \\exp(\\mathcal{D}\\Delta t)\\exp(\\mathcal{R}\\Delta t)$。分别展开每个指数算子：\n$$ \\exp(\\mathcal{D}\\Delta t) = I + \\mathcal{D}\\Delta t + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ \\exp(\\mathcal{R}\\Delta t) = I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n将这两个级数相乘并保留到 $\\Delta t^2$ 阶的项：\n$$ \\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) = \\left(I + \\mathcal{D}\\Delta t + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2}\\right) \\left(I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2}\\right) + O(\\Delta t^{3}) $$\n$$ = I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2} + \\mathcal{D}\\Delta t + \\mathcal{D}\\mathcal{R}\\Delta t^{2} + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}^{2} + 2\\mathcal{D}\\mathcal{R} + \\mathcal{R}^{2})\\Delta t^{2} + O(\\Delta t^{3}) $$\n局部算子分裂误差 $E(\\Delta t)$ 是分裂解算子与精确解算子之差：\n$$ E(\\Delta t) = \\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) - \\Phi_{\\mathcal{L}}(\\Delta t) $$\n$$ = \\left[\\frac{1}{2}(\\mathcal{D}^{2} + 2\\mathcal{D}\\mathcal{R} + \\mathcal{R}^{2})\\right]\\Delta t^{2} - \\left[\\frac{1}{2}(\\mathcal{D}^{2} + \\mathcal{D}\\mathcal{R} + \\mathcal{R}\\mathcal{D} + \\mathcal{R}^{2})\\right]\\Delta t^{2} + O(\\Delta t^{3})$$\n$$ = \\frac{1}{2}(2\\mathcal{D}\\mathcal{R} - \\mathcal{D}\\mathcal{R} - \\mathcal{R}\\mathcal{D})\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ = \\frac{1}{2}(\\mathcal{D}\\mathcal{R} - \\mathcal{R}\\mathcal{D})\\Delta t^{2} + O(\\Delta t^{3}) = \\frac{1}{2}[\\mathcal{D},\\mathcal{R}]\\Delta t^{2} + O(\\Delta t^{3}) $$\n因此，主阶局部算子分裂误差与算子对易子 $[\\mathcal{D},\\mathcal{R}]$ 成正比，并且是 $\\Delta t$ 的二阶。\n\n关于反应子循环，问题指出反应子问题在每个大小为 $\\delta t = \\Delta t/N$ 的 $N$ 个子步长中被精确积分。完整反应步的算子 $\\Phi_{\\mathcal{R}}(\\Delta t)$ 表示常微分方程子问题 $\\frac{dY}{dt}=\\omega(Y)$ 在 $\\Delta t$ 上的精确解。因为这个常微分方程是时间自治的，其精确解算子具有半群性质：$\\Phi_{\\mathcal{R}}(t_1 + t_2) = \\Phi_{\\mathcal{R}}(t_1)\\Phi_{\\mathcal{R}}(t_2)$。因此，在 $\\delta t$ 上的 $N$ 次精确积分的复合得到：\n$$ \\underbrace{\\Phi_{\\mathcal{R}}(\\delta t) \\circ \\dots \\circ \\Phi_{\\mathcal{R}}(\\delta t)}_{N \\text{ times}} = \\Phi_{\\mathcal{R}}(N\\delta t) = \\Phi_{\\mathcal{R}}(\\Delta t) $$\n由于子循环过程，在每个子步长中精确积分的假设下，重构了完全相同的精确算子 $\\Phi_{\\mathcal{R}}(\\Delta t)$，因此它不会改变分裂误差的推导。分裂误差是连续算子 $\\mathcal{D}$ 和 $\\mathcal{R}$ 非对易性的内在结果，而不是用于实现它们各自子积分的方法（只要它们是精确的）。\n\n接下来，我们量化给定离散系统的主阶误差界。\n参数为：\n- $L = 0.03$ 米\n- $M = 3$ 个节点\n- 网格间距 $h = L/M = 0.03/3 = 0.01$ 米\n- 扩散系数 $\\kappa = 1.0 \\times 10^{-4}$ 米$^2$/秒\n- 反应项 $\\omega(Y) = k\\,Y\\,(1-Y)$ 其中 $k = 1.0 \\times 10^3$ 秒$^{-1}$\n- 状态向量 $\\mathbf{Y}^{n} = [0.2, 0.5, 0.8]^{\\mathsf{T}}$\n- 时间步长 $\\Delta t = 0.01$ 秒\n\n离散扩散算子是 $\\mathbf{D} = \\kappa \\mathbf{L}$，其中 $\\mathbf{L} = \\frac{1}{h^2}\\begin{pmatrix}-2 & 1 & 1 \\\\ 1 & -2 & 1 \\\\ 1 & 1 & -2\\end{pmatrix}$。\n前置因子为 $\\frac{\\kappa}{h^2} = \\frac{1.0 \\times 10^{-4} \\text{ m}^2/\\text{s}}{(0.01 \\text{ m})^2} = \\frac{1.0 \\times 10^{-4}}{1.0 \\times 10^{-4}}$ s$^{-1} = 1.0$ s$^{-1}$。\n因此，扩散矩阵为：\n$$ \\mathbf{D} = 1.0 \\times \\begin{pmatrix}-2 & 1 & 1\\\\ 1 & -2 & 1\\\\ 1 & 1 & -2\\end{pmatrix} = \\begin{pmatrix}-2 & 1 & 1\\\\ 1 & -2 & 1\\\\ 1 & 1 & -2\\end{pmatrix} \\text{ s}^{-1} $$\n离散反应算子是雅可比矩阵 $\\mathbf{R} = \\mathrm{diag}(\\omega'(Y_{1}^{n}), \\omega'(Y_{2}^{n}), \\omega'(Y_{3}^{n}))$。\n首先，我们求导数 $\\omega'(Y) = \\frac{d}{dY}(kY - kY^2) = k - 2kY = k(1-2Y)$。\n我们在 $\\mathbf{Y}^{n}$ 的节点值处，使用 $k=1000$ s$^{-1}$ 进行计算：\n- $\\omega'(Y_{1}^{n}) = \\omega'(0.2) = 1000(1 - 2 \\times 0.2) = 1000(0.6) = 600$ s$^{-1}$\n- $\\omega'(Y_{2}^{n}) = \\omega'(0.5) = 1000(1 - 2 \\times 0.5) = 1000(0) = 0$ s$^{-1}$\n- $\\omega'(Y_{3}^{n}) = \\omega'(0.8) = 1000(1 - 2 \\times 0.8) = 1000(-0.6) = -600$ s$^{-1}$\n反应矩阵为：\n$$ \\mathbf{R} = \\begin{pmatrix} 600 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & -600 \\end{pmatrix} \\text{ s}^{-1} $$\n现在我们计算对易子 $[\\mathbf{D}, \\mathbf{R}] = \\mathbf{D}\\mathbf{R} - \\mathbf{R}\\mathbf{D}$。\n$$ \\mathbf{D}\\mathbf{R} = \\begin{pmatrix}-2 & 1 & 1\\\\ 1 & -2 & 1\\\\ 1 & 1 & -2\\end{pmatrix} \\begin{pmatrix} 600 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & -600 \\end{pmatrix} = \\begin{pmatrix} -1200 & 0 & -600 \\\\ 600 & 0 & -600 \\\\ 600 & 0 & 1200 \\end{pmatrix} $$\n$$ \\mathbf{R}\\mathbf{D} = \\begin{pmatrix} 600 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & -600 \\end{pmatrix} \\begin{pmatrix}-2 & 1 & 1\\\\ 1 & -2 & 1\\\\ 1 & 1 & -2\\end{pmatrix} = \\begin{pmatrix} -1200 & 600 & 600 \\\\ 0 & 0 & 0 \\\\ -600 & -600 & 1200 \\end{pmatrix} $$\n$$ [\\mathbf{D}, \\mathbf{R}] = \\begin{pmatrix} -1200 & 0 & -600 \\\\ 600 & 0 & -600 \\\\ 600 & 0 & 1200 \\end{pmatrix} - \\begin{pmatrix} -1200 & 600 & 600 \\\\ 0 & 0 & 0 \\\\ -600 & -600 & 1200 \\end{pmatrix} = \\begin{pmatrix} 0 & -600 & -1200 \\\\ 600 & 0 & -600 \\\\ 1200 & 600 & 0 \\end{pmatrix} \\text{ s}^{-2} $$\n接下来，我们计算对易子的 Frobenius 范数，$\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} = \\sqrt{\\sum_{i,j} |c_{ij}|^2}$。\n$$ \\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F}^2 = 0^2 + (-600)^2 + (-1200)^2 + 600^2 + 0^2 + (-600)^2 + 1200^2 + 600^2 + 0^2 $$\n$$ = 2 \\times (600^2 + 1200^2 + 600^2) = 4 \\times 600^2 + 2 \\times 1200^2 $$\n$$ = 4 \\times (3.6 \\times 10^5) + 2 \\times (1.44 \\times 10^6) = 1.44 \\times 10^6 + 2.88 \\times 10^6 = 4.32 \\times 10^6 \\text{ s}^{-4} $$\n$$ \\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} = \\sqrt{4.32 \\times 10^6} = \\sqrt{432} \\times 10^2 = \\sqrt{144 \\times 3} \\times 10^2 = 12\\sqrt{3} \\times 10^2 = 1200\\sqrt{3} \\text{ s}^{-2} $$\n最后，我们计算主阶误差界的数值：\n$$ \\text{Error Bound} = \\frac{1}{2}\\,\\Delta t^{2}\\,\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} $$\n$$ = \\frac{1}{2}(0.01 \\text{ s})^2 (1200\\sqrt{3} \\text{ s}^{-2}) = \\frac{1}{2}(10^{-4} \\text{ s}^2) (1200\\sqrt{3} \\text{ s}^{-2}) $$\n$$ = 600 \\times 10^{-4} \\sqrt{3} = 0.06\\sqrt{3} $$\n这个量是无量纲的，正如作用于无量纲质量分数向量的算子所预期的那样。\n数值计算并四舍五入到四位有效数字：\n$$ 0.06\\sqrt{3} \\approx 0.06 \\times 1.7320508 \\approx 0.103923048 \\approx 0.1039 $$",
            "answer": "$$\n\\boxed{0.1039}\n$$"
        },
        {
            "introduction": "一维湍流模型（ODT）的最后一块拼图是其独特的湍流建模方法。ODT并非通过修正的扩散项来模拟湍流输运，而是引入了离散的、随机的“湍流涡”事件来重构标量场。本练习  将带您深入ODT模型的概率论核心，它将湍流涡的发生视为一个泊松过程，并要求您基于物理准则（例如由达姆科勒数 $Da$ 表征的混合与反应时间尺度的竞争）来设计一套抽样算法。通过构建拒绝抽样方案，您将亲身体验蒙特卡洛方法的具体实施，这是掌握ODT模型独特模拟能力的关键一步。",
            "id": "4046548",
            "problem": "考虑用于反应混合的一维湍流框架，其中长度为 $L$ 的区域内的涡由涡尺寸 $l$ 和涡中心位置 $x_0$ 组成的对 $(l,x_0)$ 表示。假设在可测集 $[l_{\\min},l_{\\max}] \\times [0,L]$ 上存在一个候选涡的稳态 Poisson 过程，其强度密度为 $\\lambda(l,x_0)$，并假设一个化学可行性接受过滤器 $A(l,x_0) \\in [0,1]$ 决定了哪些提议的涡被接受。被接受的涡是那些基于微观混合和反应时间尺度通过化学可行性检验的涡。物理参数和单位如下：$l$ 和 $x_0$ 的单位是米，$L$ 的单位是米，湍流扩散系数 $\\kappa_t$ 的单位是平方米/秒，反应速率常数 $k$ 的单位是 1/秒，标量反应性替代物 $Y(x_0)$ 是一个无量纲有界正函数。\n\n使用基础概率论（Poisson 过程、密度归一化、拒绝采样）和基于物理的时间尺度模型（混合时间与化学时间），推导一个从 $\\lambda(l,x_0)$ 中提议涡的拒绝采样算法，该算法使用接受过滤器 $A(l,x_0)$，并计算期望接受效率。\n\n从以下与一维湍流微观混合和标量反应一致的、科学上真实可靠的模型组件出发：\n- 候选强度密度：\n$$\n\\lambda(l,x_0) = \\lambda_0 \\, \\exp\\!\\left(-\\frac{l}{\\ell_t}\\right)\\left[1 + \\varepsilon \\cos\\!\\left(\\frac{2\\pi x_0}{L}\\right)\\right],\n$$\n其中 $\\lambda_0 > 0$ 是一个恒定速率尺度，$\\ell_t > 0$ 是一个湍流长度尺度，$\\varepsilon \\in [0,1)$ 编码了整个区域的不均匀性。\n- 混合与化学时间尺度：\n$$\n\\tau_{\\text{mix}}(l) = \\frac{l^2}{2\\,\\kappa_t}, \\quad \\tau_{\\text{chem}}(x_0) = \\frac{1}{k\\,Y(x_0)},\n$$\n其中\n$$\nY(x_0) = Y_0 + \\delta \\sin\\!\\left(\\frac{\\pi x_0}{L}\\right),\n$$\n且 $Y_0 > |\\delta| > 0$ 确保 $Y(x_0) > 0$ 处处成立。\n- 接受概率被建模为 Damköhler 数（混合时间尺度与化学时间尺度之比）的指数函数：\n$$\nA(l,x_0) = \\exp\\!\\left(-\\mathrm{Da}(l,x_0)\\right), \\quad \\mathrm{Da}(l,x_0) = \\frac{\\tau_{\\text{mix}}(l)}{\\tau_{\\text{chem}}(x_0)} = \\frac{l^2}{2\\,\\kappa_t}\\,k\\,Y(x_0).\n$$\n\n任务：\n- 推导与 $\\lambda(l,x_0)$ 成正比的归一化提议密度 $q(l,x_0)$，并通过利用可分离性构建一个拒绝采样方案，从 $q(l,x_0)$ 中抽取独立的提议 $(l,x_0)$。具体来说，推导在 $[l_{\\min},l_{\\max}]$ 上截断指数分布下对 $l$ 的逆变换采样法则，并使用均匀提议和有界接受率，为 $[0,L]$ 上的 $x_0$ 推导一个有效的拒绝采样包络。\n- 使用 Poisson 过程的稀疏化和条件接受，推导期望接受效率的表达式\n$$\n\\eta = \\frac{\\int_{l_{\\min}}^{l_{\\max}}\\int_{0}^{L} \\lambda(l,x_0)\\,A(l,x_0)\\, \\mathrm{d}x_0\\,\\mathrm{d}l}{\\int_{l_{\\min}}^{l_{\\max}}\\int_{0}^{L} \\lambda(l,x_0)\\,\\mathrm{d}x_0\\,\\mathrm{d}l},\n$$\n并尽可能对分母进行解析化简。\n- 在指定环境中实现一个程序，通过数值积分为下列每组测试参数集计算 $\\eta$，提供可靠的估计值。所有物理输入均以上述一致的单位指定；期望接受效率 $\\eta$ 是无量纲的。\n\n测试套件：\n- 案例 1（一般非均匀混合与中等强度化学反应）：\n    - $L = 1.0$, $\\ell_t = 0.05$, $\\kappa_t = 1.0\\times 10^{-3}$, $k = 10.0$, $Y_0 = 0.5$, $\\delta = 0.2$, $\\varepsilon = 0.3$, $l_{\\min} = 0.001$, $l_{\\max} = 0.2$.\n- 案例 2（空间均匀的候选场）：\n    - $L = 1.0$, $\\ell_t = 0.05$, $\\kappa_t = 1.0\\times 10^{-3}$, $k = 10.0$, $Y_0 = 0.5$, $\\delta = 0.2$, $\\varepsilon = 0.0$, $l_{\\min} = 0.001$, $l_{\\max} = 0.2$.\n- 案例 3（强化学反应，弱混合）：\n    - $L = 1.0$, $\\ell_t = 0.05$, $\\kappa_t = 5.0\\times 10^{-4}$, $k = 100.0$, $Y_0 = 0.5$, $\\delta = 0.2$, $\\varepsilon = 0.3$, $l_{\\min} = 0.001$, $l_{\\max} = 0.2$.\n- 案例 4（弱化学反应，强混合）：\n    - $L = 1.0$, $\\ell_t = 0.05$, $\\kappa_t = 1.0\\times 10^{-2}$, $k = 2.0$, $Y_0 = 0.5$, $\\delta = 0.2$, $\\varepsilon = 0.3$, $l_{\\min} = 0.001$, $l_{\\max} = 0.2$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是对应案例的期望接受效率 $\\eta$，表示为四舍五入到 6 位小数的十进制数，不带单位符号。",
            "solution": "该问题具有科学依据，是良定且客观的。它在已建立的一维湍流框架内，基于合理的物理原理（时间尺度竞争、Damköhler 数）和标准的概率方法（Poisson 过程），为反应混合提供了一个连贯的模型。所有参数和函数都得到了明确定义，约束条件确保了物理和数学上的有效性。任务是具体的，涉及解析推导和数值计算，并存在唯一、可验证的解。我们着手进行推导和求解。\n\n该问题需要一个包含三部分的解法：1) 推导涡提议的采样算法，2) 推导期望接受效率 $\\eta$，以及 3) 对给定的参数集进行 $\\eta$ 的数值计算。\n\n首先，我们推导从与给定强度密度 $\\lambda(l,x_0)$ 成正比的概率密度函数 $q(l,x_0)$ 中提议涡 $(l, x_0)$ 的采样算法。强度密度为：\n$$\n\\lambda(l,x_0) = \\lambda_0 \\, \\exp\\!\\left(-\\frac{l}{\\ell_t}\\right)\\left[1 + \\varepsilon \\cos\\!\\left(\\frac{2\\pi x_0}{L}\\right)\\right]\n$$\n为构建概率密度函数 (PDF) $q(l,x_0)$，我们必须通过在区域 $[l_{\\min}, l_{\\max}] \\times [0,L]$ 上对 $\\lambda(l,x_0)$ 进行积分来将其归一化。总速率 $\\Lambda$ 为：\n$$\n\\Lambda = \\int_{l_{\\min}}^{l_{\\max}}\\int_{0}^{L} \\lambda(l,x_0)\\, \\mathrm{d}x_0\\,\\mathrm{d}l\n$$\n变量 $l$ 和 $x_0$ 在 $\\lambda(l,x_0)$ 中是可分离的，因此我们可以写成：\n$$\n\\Lambda = \\lambda_0 \\left( \\int_{l_{\\min}}^{l_{\\max}} \\exp\\!\\left(-\\frac{l}{\\ell_t}\\right) \\mathrm{d}l \\right) \\left( \\int_{0}^{L} \\left[1 + \\varepsilon \\cos\\!\\left(\\frac{2\\pi x_0}{L}\\right)\\right] \\mathrm{d}x_0 \\right)\n$$\n对 $x_0$ 的积分为：\n$$\n\\int_{0}^{L} \\left[1 + \\varepsilon \\cos\\!\\left(\\frac{2\\pi x_0}{L}\\right)\\right] \\mathrm{d}x_0 = \\left[x_0 + \\varepsilon \\frac{L}{2\\pi} \\sin\\!\\left(\\frac{2\\pi x_0}{L}\\right)\\right]_{0}^{L} = (L+0) - (0+0) = L\n$$\n对 $l$ 的积分为：\n$$\n\\int_{l_{\\min}}^{l_{\\max}} \\exp\\!\\left(-\\frac{l}{\\ell_t}\\right) \\mathrm{d}l = \\left[-\\ell_t \\exp\\!\\left(-\\frac{l}{\\ell_t}\\right)\\right]_{l_{\\min}}^{l_{\\max}} = \\ell_t \\left(\\exp\\!\\left(-\\frac{l_{\\min}}{\\ell_t}\\right) - \\exp\\!\\left(-\\frac{l_{\\max}}{\\ell_t}\\right)\\right)\n$$\n因此，总速率为 $\\Lambda = \\lambda_0 L \\ell_t \\left(\\exp(-l_{\\min}/\\ell_t) - \\exp(-l_{\\max}/\\ell_t)\\right)$。归一化的 PDF 为 $q(l,x_0) = \\lambda(l,x_0)/\\Lambda$，它可以分解为边际密度 $q_l(l)$ 和 $q_{x_0}(x_0)$ 的乘积：\n$$\nq_l(l) = \\frac{\\exp(-l/\\ell_t)}{\\ell_t (\\exp(-l_{\\min}/\\ell_t) - \\exp(-l_{\\max}/\\ell_t))}, \\quad l \\in [l_{\\min}, l_{\\max}]\n$$\n$$\nq_{x_0}(x_0) = \\frac{1}{L}\\left[1 + \\varepsilon \\cos\\!\\left(\\frac{2\\pi x_0}{L}\\right)\\right], \\quad x_0 \\in [0,L]\n$$\n为了从截断指数分布 $q_l(l)$ 中对 $l$ 进行采样，我们使用逆变换采样法。累积分布函数 (CDF) 为 $F_l(l) = \\int_{l_{\\min}}^{l} q_l(s)\\mathrm{d}s$：\n$$\nF_l(l) = \\frac{\\int_{l_{\\min}}^{l} \\exp(-s/\\ell_t) \\mathrm{d}s}{\\ell_t (\\exp(-l_{\\min}/\\ell_t) - \\exp(-l_{\\max}/\\ell_t))} = \\frac{\\exp(-l_{\\min}/\\ell_t) - \\exp(-l/\\ell_t)}{\\exp(-l_{\\min}/\\ell_t) - \\exp(-l_{\\max}/\\ell_t)}\n$$\n对于一个均匀随机变量 $u \\sim U(0,1)$，令 $F_l(l) = u$ 并求解 $l$，得到采样法则：\n$$\nl = -\\ell_t \\ln\\!\\left(\\exp\\!\\left(-\\frac{l_{\\min}}{\\ell_t}\\right) - u\\left[\\exp\\!\\left(-\\frac{l_{\\min}}{\\ell_t}\\right) - \\exp\\!\\left(-\\frac{l_{\\max}}{\\ell_t}\\right)\\right]\\right)\n$$\n为了从 $q_{x_0}(x_0)$ 中对 $x_0$ 进行采样，我们按照建议使用拒绝采样法。我们在 $[0,L]$ 上使用一个均匀提议分布 $g(x_0)=1/L$。我们需要一个常数 $M$ 使得 $q_{x_0}(x_0) \\le M g(x_0)$。\n$$\n\\frac{1}{L}\\left[1 + \\varepsilon \\cos\\!\\left(\\frac{2\\pi x_0}{L}\\right)\\right] \\le M \\frac{1}{L} \\implies 1 + \\varepsilon \\cos\\!\\left(\\frac{2\\pi x_0}{L}\\right) \\le M\n$$\n通过将 $M$ 设置为左侧的最大值可以获得最紧的上界，即 $M = 1+\\varepsilon$（因为 $\\cos(\\cdot) \\le 1$ 且 $\\varepsilon \\ge 0$）。对于一个提议 $x_0^*$ 的接受概率是：\n$$\n\\alpha(x_0^*) = \\frac{q_{x_0}(x_0^*)}{M g(x_0^*)} = \\frac{\\frac{1}{L}(1 + \\varepsilon \\cos(2\\pi x_0^*/L))}{(1+\\varepsilon)(1/L)} = \\frac{1 + \\varepsilon \\cos(2\\pi x_0^*/L)}{1+\\varepsilon}\n$$\n对 $x_0$ 的采样算法是：1) 提议 $x_0^* \\sim U(0,L)$。2) 抽取 $v \\sim U(0,1)$。3) 如果 $v \\le \\alpha(x_0^*)$，则接受 $x_0^*$；否则，重复。\n\n其次，我们推导期望接受效率 $\\eta$ 的表达式。该效率是被接受涡的总速率与被提议涡的总速率之比。根据 Poisson 过程的稀疏化性质，被接受涡的强度为 $\\lambda_{acc}(l,x_0) = \\lambda(l,x_0)A(l,x_0)$。\n$$\n\\eta = \\frac{\\Lambda_{acc}}{\\Lambda_{prop}} = \\frac{\\int_{l_{\\min}}^{l_{\\max}}\\int_{0}^{L} \\lambda(l,x_0)\\,A(l,x_0)\\, \\mathrm{d}x_0\\,\\mathrm{d}l}{\\int_{l_{\\min}}^{l_{\\max}}\\int_{0}^{L} \\lambda(l,x_0)\\,\\mathrm{d}x_0\\,\\mathrm{d}l}\n$$\n分母是我们之前推导出的总速率 $\\Lambda$。从分子和分母中消去常数 $\\lambda_0$ 可得：\n$$\n\\eta = \\frac{\\int_{l_{\\min}}^{l_{\\max}}\\int_{0}^{L} \\exp(-\\frac{l}{\\ell_t})\\left[1 + \\varepsilon \\cos(\\frac{2\\pi x_0}{L})\\right] A(l,x_0) \\, \\mathrm{d}x_0\\,\\mathrm{d}l}{L \\ell_t (\\exp(-\\frac{l_{\\min}}{\\ell_t}) - \\exp(-\\frac{l_{\\max}}{\\ell_t}))}\n$$\n其中接受概率 $A(l,x_0)$ 由下式给出：\n$$\nA(l,x_0) = \\exp\\!\\left(-\\mathrm{Da}(l,x_0)\\right) = \\exp\\!\\left(-\\frac{l^2 k}{2\\kappa_t}\\left[Y_0 + \\delta \\sin\\!\\left(\\frac{\\pi x_0}{L}\\right)\\right]\\right)\n$$\n与分母不同，由于 $A(l,x_0)$ 的形式（其中 $l$ 和 $x_0$ 在指数函数内部耦合），分子积分关于 $l$ 和 $x_0$ 是不可分离的。该积分必须进行数值计算。\n\n第三，我们实现一个程序来计算 $\\eta$。对于每个测试案例，我们使用推导出的公式解析计算分母。我们通过对函数 $f(l,x_0) = \\exp(-l/\\ell_t)[1 + \\varepsilon \\cos(2\\pi x_0/L)] A(l,x_0)$ 在区域 $[l_{\\min}, l_{\\max}] \\times [0,L]$ 上执行二维数值积分（求积）来计算分子。数值计算的分子与解析计算的分母之比即为 $\\eta$ 的值。Python 库 `scipy.integrate.dblquad` 非常适合此任务。最终结果按要求四舍五入到 6 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import dblquad\n\ndef calculate_eta(L, lt, kappa_t, k, Y0, delta, epsilon, l_min, l_max):\n    \"\"\"\n    Computes the expected acceptance efficiency eta for a given set of parameters.\n\n    Args:\n        L (float): Domain length.\n        lt (float): Turbulent length scale.\n        kappa_t (float): Turbulent diffusivity.\n        k (float): Reaction rate constant.\n        Y0 (float): Base scalar reactivity surrogate.\n        delta (float): Amplitude of scalar reactivity variation.\n        epsilon (float): Inhomogeneity factor for candidate intensity.\n        l_min (float): Minimum eddy size.\n        l_max (float): Maximum eddy size.\n\n    Returns:\n        float: The expected acceptance efficiency eta.\n    \"\"\"\n\n    # 1. Define the integrand for the numerator of eta.\n    # The integrand is lambda(l,x0) * A(l,x0), with the constant lambda_0 factored out\n    # as it cancels. The scipy.integrate.dblquad function expects the function\n    # signature f(y, x), where y is the inner integration variable and x is the outer.\n    # Our integral is Integral[l_min to l_max] (Integral[0 to L] f(l, x0) dx0) dl.\n    # So, l is the outer variable (x), and x0 is the inner variable (y).\n    # The function signature must be integrand(x0, l).\n    def integrand(x0, l):\n        # Scalar reactivity surrogate Y(x0)\n        Y_x0 = Y0 + delta * np.sin(np.pi * x0 / L)\n        \n        # Candidate intensity density lambda(l, x0) components (without lambda_0)\n        lambda_l_term = np.exp(-l / lt)\n        lambda_x0_term = 1.0 + epsilon * np.cos(2.0 * np.pi * x0 / L)\n        \n        # Acceptance probability A(l, x0) via Damkohler number Da(l, x0)\n        Da = (l**2 * k * Y_x0) / (2.0 * kappa_t)\n        A = np.exp(-Da)\n        \n        return lambda_l_term * lambda_x0_term * A\n\n    # 2. Compute the numerator N by numerical double integration.\n    # The integral is over l in [l_min, l_max] and x0 in [0, L].\n    # Limits for l (outer var 'a', 'b'): l_min, l_max\n    # Limits for x0 (inner var g(x), h(x)): 0, L\n    numerator, _ = dblquad(integrand, l_min, l_max, 0, L)\n\n    # 3. Compute the denominator D analytically.\n    # Denominator is the integral of lambda(l, x0) over the domain, without lambda_0.\n    # Integral[0,L] (1 + epsilon*cos(2*pi*x0/L)) dx0 = L\n    # Integral[l_min,l_max] exp(-l/lt) dl = lt * (exp(-l_min/lt) - exp(-l_max/lt))\n    denominator = L * lt * (np.exp(-l_min / lt) - np.exp(-l_max / lt))\n\n    # 4. Compute the efficiency eta.\n    # The constant lambda_0 from the full intensity density cancels out.\n    if denominator == 0:\n        return 0.0\n    \n    eta = numerator / denominator\n    return eta\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general inhomogeneous mixing and moderate chemistry\n        {\"L\": 1.0, \"lt\": 0.05, \"kappa_t\": 1.0e-3, \"k\": 10.0, \"Y0\": 0.5, \"delta\": 0.2, \"epsilon\": 0.3, \"l_min\": 0.001, \"l_max\": 0.2},\n        # Case 2: spatially uniform candidate field\n        {\"L\": 1.0, \"lt\": 0.05, \"kappa_t\": 1.0e-3, \"k\": 10.0, \"Y0\": 0.5, \"delta\": 0.2, \"epsilon\": 0.0, \"l_min\": 0.001, \"l_max\": 0.2},\n        # Case 3: strong chemistry, weaker mixing\n        {\"L\": 1.0, \"lt\": 0.05, \"kappa_t\": 5.0e-4, \"k\": 100.0, \"Y0\": 0.5, \"delta\": 0.2, \"epsilon\": 0.3, \"l_min\": 0.001, \"l_max\": 0.2},\n        # Case 4: weak chemistry, stronger mixing\n        {\"L\": 1.0, \"lt\": 0.05, \"kappa_t\": 1.0e-2, \"k\": 2.0, \"Y0\": 0.5, \"delta\": 0.2, \"epsilon\": 0.3, \"l_min\": 0.001, \"l_max\": 0.2},\n    ]\n\n    results = []\n    for case in test_cases:\n        eta = calculate_eta(\n            L=case[\"L\"], lt=case[\"lt\"], kappa_t=case[\"kappa_t\"], k=case[\"k\"],\n            Y0=case[\"Y0\"], delta=case[\"delta\"], epsilon=case[\"epsilon\"],\n            l_min=case[\"l_min\"], l_max=case[\"l_max\"]\n        )\n        results.append(f\"{eta:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}