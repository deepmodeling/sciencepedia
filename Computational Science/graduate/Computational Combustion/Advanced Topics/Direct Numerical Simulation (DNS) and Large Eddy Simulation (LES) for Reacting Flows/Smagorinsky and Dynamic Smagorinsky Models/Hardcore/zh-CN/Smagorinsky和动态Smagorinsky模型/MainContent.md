## 引言
大涡模拟（LES）是研究[湍流](@entry_id:151300)（尤其是燃烧等[复杂反应](@entry_id:166407)流）的强大工具，其核心在于直接求解大尺度涡的运动，同时对小尺度的、未解析的亚格子尺度（SGS）效应进行模化。如何准确且高效地构建SGS模型，以封闭滤波后的控制方程，是LES方法的关键挑战。在众多SGS模型中，[Smagorinsky模型](@entry_id:276289)及其动态版本因其理论的相对简洁性和应用的广[泛性](@entry_id:161765)，构成了[计算流体力学](@entry_id:747620)，特别是计算燃烧学领域的基石。然而，从经典的常数系数模型到能够适应局部流动的动态模型，其发展历程反映了我们对[湍流](@entry_id:151300)物理认识的不断深化，也带来了新的理论和数值挑战。

本文旨在系统地剖析[Smagorinsky模型](@entry_id:276289)及其动态版本。在第一章**“原理与机制”**中，我们将从[Favre滤波](@entry_id:749251)出发，建立[变密度流](@entry_id:1133711)的[SGS应力张量](@entry_id:1131522)，详细推导经典[Smagorinsky模型](@entry_id:276289)和动态模型的数学形式，并深入探讨能量回传、[数值稳定性](@entry_id:175146)等高级概念。随后，在第二章**“应用与交叉学科联系”**中，我们将展示这些模型如何在[湍流燃烧](@entry_id:756233)、[高速空气动力学](@entry_id:272086)、地球物理以及生物医学工程等多样化场景中应用、扩展和调整，揭示其在解决真实世界问题时的适应性与局限性。最后，在第三章**“动手实践”**中，我们将通过一系列精心设计的计算练习，引导读者亲手实践模型校准、动态程序实现和能量平衡分析，将理论知识转化为解决实际问题的能力。

## 原理与机制

在大涡模拟（LES）中，我们的目标是通过求解空间滤波后的控制方程来直接计算大尺度[湍流](@entry_id:151300)运动，同时对小尺度，即亚格子尺度（SGS）的运动进行模化。对于密度变化的[反应流](@entry_id:190741)，例如燃烧过程，这一挑战变得尤为复杂。本章将深入探讨为封闭[可压缩反应流](@entry_id:1122760)的滤波动量方程而开发的核心模型：[Smagorinsky模型](@entry_id:276289)及其动态版本。我们将从基本原理出发，系统地阐述这些模型的理论基础、内在机制及其在[计算燃烧学](@entry_id:1122776)中的实际应用。

### [变密度流](@entry_id:1133711)中的亚格子应力张量

在深入研究模型本身之前，我们必须首先为[变密度流](@entry_id:1133711)建立一个严谨的滤波框架。标准的[空间滤波](@entry_id:202429)，或称**雷诺滤波 (Reynolds filtering)**，是一个[线性卷积](@entry_id:190500)操作，定义为：
$$
\overline{\phi}(\mathbf{x}) = \int G_{\Delta}(\mathbf{x}-\mathbf{r})\,\phi(\mathbf{r})\,\mathrm{d}\mathbf{r}
$$
其中 $G_{\Delta}$ 是一个特征宽度为 $\Delta$ 的归一化滤波核（即 $\int G_{\Delta}(\mathbf{r})\,\mathrm{d}\mathbf{r} = 1$）。然而，当我们将此算子直接应用于[可压缩Navier-Stokes](@entry_id:747591)方程时，滤波后的[非线性](@entry_id:637147)对流项 $\overline{\rho u_i u_j}$ 会产生包含密度与速度脉动之间复杂关联的项，使得方程形式异常繁琐。

为了简化滤波后方程的形式，我们引入**密度加权滤波 (density-weighted filtering)**，或称**[Favre滤波](@entry_id:749251) (Favre filtering)**。一个量 $\phi$ 的[Favre滤波](@entry_id:749251)形式 $\tilde{\phi}$ 定义为：
$$
\tilde{\phi} = \frac{\overline{\rho \phi}}{\bar{\rho}}
$$
其中 $\bar{\rho}$ 是雷诺滤波后的密度。这个定义极大地简化了关键项，例如，滤波后的动量变为 $\overline{\rho u_i} = \bar{\rho} \tilde{u}_i$。

[Favre滤波](@entry_id:749251)的优越性不仅仅在于形式上的简化。在存在显著密度梯度的反应流中（例如，火焰锋面两侧的密度比可达5到8），它能有效减小待模化的亚格子项的量级 。通过将密度-速度的协方差项（例如 $\overline{\rho' u_i'}$）吸收到已解析的速度定义中（$\tilde{u_i} = \bar{u_i} + \overline{\rho'u_i'}/\bar{\rho}$），[Favre滤波](@entry_id:749251)使得剩余的亚格子应力主要代表速度自身的脉动，从而更适合于基于[速度梯度](@entry_id:261686)的模型。

应用[Favre滤波](@entry_id:749251)于[动量方程](@entry_id:197225)的对流项 $\rho u_i u_j$，我们得到 $\overline{\rho u_i u_j}$。该项是未封闭的，因为它包含了未经滤波的速度。为了封闭方程，我们将其表示为已解尺度量和一个未封闭的亚格子项之和。这个未封闭项便是**亚格子应力 (Subgrid-Scale, SGS) 张量** $\tau_{ij}$，其在[Favre滤波](@entry_id:749251)框架下的精确定义为 ：
$$
\tau_{ij} = \overline{\rho u_i u_j} - \bar{\rho} \tilde{u}_i \tilde{u}_j
$$
这个张量代表了未解析的亚格子尺度运动对已解析动量输运的贡献，是LES封闭理论的核心。滤波后的动量方程中的对流项因此可以写为 $\frac{\partial}{\partial x_j}(\bar{\rho}\tilde{u}_i\tilde{u}_j + \tau_{ij})$。

与任何物理张量一样，$\tau_{ij}$ 可以被分解为一个各向同性部分和一个偏（无迹）部分：
$$
\tau_{ij} = \frac{1}{3}\tau_{kk}\delta_{ij} + \tau_{ij}^{d}
$$
其中 $\tau_{ij}^{d}$ 是[偏应力张量](@entry_id:267642)。各向同性部分 $\frac{1}{3}\tau_{kk}\delta_{ij}$ 与压力梯度项具有相同的数学形式，因此通常被并入一个修正后的滤波压力项中，不需单独模化。

[张量的迹](@entry_id:190669) $\tau_{kk}$ 具有明确的物理意义。我们定义**亚格子动能 (SGS kinetic energy)** $k_{\mathrm{sgs}}$ 为：
$$
k_{\mathrm{sgs}} = \frac{1}{2}\tau_{ii} = \frac{1}{2} (\overline{\rho u_k u_k}/\bar{\rho} - \tilde{u}_k \tilde{u}_k)
$$
一个重要的理论约束是**可实现性 (realizability)**，即任何模型都应与真实的[湍流](@entry_id:151300)场在统计上一致。一个基本的[可实现性](@entry_id:193701)条件是亚格子[应力张量](@entry_id:148973)必须是半正定的。其必然推论是它的迹必须非负，即 $\tau_{ii} \ge 0$。通过对滤波定义的柯西-[施瓦茨不等式](@entry_id:202153)应用，可以严格证明，对于任意正密度场，精确的SGS迹 $\tau_{ii}$ 必定是非负的 。因此，精确的亚格子动能 $k_{\mathrm{sgs}}$ 也保证为非负。这是衡量任何[SGS模型](@entry_id:754720)物理保真度的重要基准。

### [Boussinesq假设](@entry_id:272519)与经典[Smagorinsky模型](@entry_id:276289)

封闭[SGS应力张量](@entry_id:1131522)的最常用方法是**Boussinesq[涡粘性假设](@entry_id:1124144) (Boussinesq eddy-viscosity hypothesis)**。该假设借鉴了分子粘性的思想，认为亚格子尺度的[动量输运](@entry_id:139628)与已解析尺度流场的变形（即[应变率](@entry_id:154778)）成正比。具体而言，它建立了SGS[偏应力张量](@entry_id:267642) $\tau_{ij}^{d}$ 与[Favre滤波](@entry_id:749251)[应变率张量](@entry_id:266108) $\tilde{S}_{ij}$ 之间的线性关系 ：
$$
\tau_{ij}^{d} = -2 \mu_t \tilde{S}_{ij}
$$
其中 $\mu_t$ 是**SGS涡粘性系数 (SGS eddy viscosity)**，而 $\tilde{S}_{ij}$ 定义为：
$$
\tilde{S}_{ij} = \frac{1}{2}\left(\frac{\partial \tilde{u}_i}{\partial x_j} + \frac{\partial \tilde{u}_j}{\partial x_i}\right)
$$
这种涡粘性方法的核心假设是，[SGS应力张量](@entry_id:1131522)的[主轴](@entry_id:172691)与应变率张量的主轴是重合的，并且能量总是从大尺度向小尺度单向传递（即模型总是耗散的）。这一假设与**[尺度相似性模型](@entry_id:1131262) (scale-similarity models)** 形成对比，后者通过对已解析速度场进行二次滤波来重构[SGS应力](@entry_id:1131521)的结构，从而能够捕捉到[应力与应变率](@entry_id:263123)张量之间的错位以及能量的反向传递（即“回传”）。

在[Boussinesq假设](@entry_id:272519)框架下，**经典[Smagorinsky模型](@entry_id:276289)** 提供了一个代数表达式来计算 $\mu_t$。该模型基于Kolmogorov的[惯性子区](@entry_id:273327)理论，假设亚格子尺度的能量产生与耗散达到了[局部平衡](@entry_id:156295)。在[变密度流](@entry_id:1133711)的[Favre滤波](@entry_id:749251)框架下，其形式为 ：
$$
\mu_t = \bar{\rho} (C_s \Delta)^2 |\tilde{S}|
$$
这里的 $\nu_t = \mu_t / \bar{\rho} = (C_s \Delta)^2 |\tilde{S}|$ 是SGS运动粘性。$C_s$ 是一个无量纲的**Smagorinsky系数**，$\Delta$ 是滤波宽度，而 $|\tilde{S}|$ 是应变率张量的大小，定义为 $|\tilde{S}| = \sqrt{2 \tilde{S}_{mn} \tilde{S}_{mn}}$。模型中包含滤波密度 $\bar{\rho}$ 是为了确保在变密度情况下量纲和物理缩放关系的正确性。

尽管[Smagorinsky模型](@entry_id:276289)结构简单，但其固有的局限性在计算燃烧学中尤为突出。模型中的 $C_s$ 系数需要用户预先指定，通常通过与均匀[各向同性湍流](@entry_id:199323)的实验数据或直接数值模拟（DNS）结果进行校准来确定（典型值为 $0.1$ 至 $0.2$）。然而，将为一种理想化流动校准的常数应用于燃烧等高度非均匀、非各向同性的流动中，会引发严重问题。

一个典型的例子是在预混火焰的模拟中 。火焰锋面处剧烈的热释放导致气体[热膨胀](@entry_id:137427)，产生强烈的[速度散度](@entry_id:264117)（$\nabla \cdot \mathbf{u} > 0$），这被称为**膨胀 (dilatation)**。这种膨胀效应会极大地增加应变率张量的大小 $|\tilde{S}|$。同时，高温导致气体的运动粘性（$\nu = \mu/\rho$）急剧增加，从而抑制了真实的小尺度[湍流](@entry_id:151300)脉动。然而，[Smagorinsky模型](@entry_id:276289)“看到”一个巨大的 $|\tilde{S}|$，便错误地推断出存在剧烈的亚格子[湍流](@entry_id:151300)，并计算出一个过大的涡粘性。这导致了对已解析动能的过度耗散，不物理地抑制了流场的发展。此外，在流动的层流区域，该模型仍然会引入非零的人为粘性。这些缺陷表明，需要一种能够根据局部流场特性自动调整模型系数的方法。

### 动态[Smagorinsky模型](@entry_id:276289)

为了克服经典模型的局限性，**动态[Smagorinsky模型](@entry_id:276289) (dynamic Smagorinsky model)** 应运而生。其核心思想是利用模拟过程中已解析的流场信息来动态地、局部地确定模型系数，从而无需用户指定任何参数，并使模型能够适应不同的流动状态。

该程序引入了第二个空间滤波器，称为**测试滤波器 (test filter)**，其特征宽度 $\hat{\Delta}$ 大于网格滤波器宽度 $\Delta$（通常取 $\hat{\Delta} = 2\Delta$）。对一个量应用测试滤波用帽子符号 $\widehat{(\cdot)}$ 表示。通过在网格滤波尺度和测试滤波尺度上同时应用滤波操作，可以推导出一个精确的代数关系，即**[Germano恒等式](@entry_id:749887) (Germano identity)**  ：
$$
L_{ij} = T_{ij} - \widehat{\tau_{ij}}
$$
其中，
- $\tau_{ij} = \overline{\rho u_i u_j} - \bar{\rho} \tilde{u}_i \tilde{u}_j$ 是网格尺度上的[SGS应力](@entry_id:1131521)。
- $T_{ij} = \widehat{\overline{\rho u_i u_j}} - \hat{\bar{\rho}} \hat{\tilde{u}}_i \hat{\tilde{u}}_j$ 是测试尺度上的[SGS应力](@entry_id:1131521)。
- $L_{ij} = \widehat{\bar{\rho} \tilde{u}_i \tilde{u}_j} - \hat{\bar{\rho}} \hat{\tilde{u}}_i \hat{\tilde{u}}_j$ 是**已解[应力张量](@entry_id:148973) (resolved stress tensor)**，有时也称为Leonard应力。这个张量仅包含已解析速度场的信息，因此在LES模拟中是**可计算的**。

[Germano恒等式](@entry_id:749887)联系了两个不同尺度上的未封闭项（$\tau_{ij}$ 和 $T_{ij}$）和一个可计算的量（$L_{ij}$）。动态程序的基本假设是，Smagorinsky[涡粘性模型](@entry_id:1124145)形式在网格尺度和测试尺度上均成立，并且模型系数 $C = C_s^2$ 在这两个尺度之间是近似不变的。于是，我们可以写出：
$$
\tau_{ij}^d \approx -2 C \bar{\rho} \Delta^2 |\tilde{S}| \tilde{S}_{ij}
$$
$$
T_{ij}^d \approx -2 C \hat{\bar{\rho}} \hat{\Delta}^2 |\hat{\tilde{S}}| \hat{\tilde{S}}_{ij}
$$
将这些模型代入[Germano恒等式](@entry_id:749887)的偏量形式 $L_{ij}^d = T_{ij}^d - \widehat{\tau_{ij}^d}$，并假定 $C$ 在测试滤波操作下变化缓慢可以提出，我们得到一个关于未知系数 $C$ 的代数方程：
$$
L_{ij}^d \approx C M_{ij}
$$
其中 $M_{ij} = 2 ( \widehat{\bar{\rho} \Delta^2 |\tilde{S}| \tilde{S}_{ij}} - \hat{\bar{\rho}} \hat{\Delta}^2 |\hat{\tilde{S}}| \hat{\tilde{S}}_{ij} )$ 是一个同样可由已解析场计算的张量。由于这是一个包含5个独立分量的张量方程，而只有一个标量未知数 $C$，这是一个[超定系统](@entry_id:151204)。通常采用**最小二乘法 (least-squares method)** 来求解，得到 $C$ 的最优估计：
$$
C = \frac{L_{ij}^d M_{ij}}{M_{kl} M_{kl}}
$$
动态模型的巨大成功在于它能够根据局部流动的物理特性自动调整。其最显著的优点之一是它能够在层流或壁面附近**自动“关闭”** 。在这些区域，流场是光滑的，不存在亚格子尺度的脉动。因此，[SGS应力](@entry_id:1131521) $\tau_{ij}$ 和测试尺度[SGS应力](@entry_id:1131521) $T_{ij}$ 都近似为零。根据[Germano恒等式](@entry_id:749887)，这导致可计算的已解应力 $L_{ij}$ 也近似为零。因此，上述求解过程自然地得到 $C \to 0$，从而消除了经典模型在这些区域引入的人为粘性。同理，该模型也能正确处理[预混火焰](@entry_id:203757)中因高运动粘性导致的[湍流抑制](@entry_id:756229)问题，动态地减小模型系数以避免过度耗散。

### 高级主题与实践考量

虽然动态模型在理论上十分优雅，但在实际应用中，尤其是在复杂的反应流模拟中，仍需考虑一些高级概念和数值问题。

#### 能量回传与负模型系数

动态计算出的系数 $C$ (或 $C_s^2$) 不再被限制为正值。在[湍流](@entry_id:151300)的某些区域，计算出的 $C$ 可能会是负数。从[涡粘性模型](@entry_id:1124145)的角度看，一个负的 $C$ 意味着一个负的涡粘性。SGS耗散项 $\varepsilon_{\mathrm{sgs}} = -\tau_{ij}^d \tilde{S}_{ij} \approx 2\mu_t |\tilde{S}|^2$ 也会变为负值。这代表着动能从**亚格子尺度向已解析尺度传递**，这一现象被称为**能量回传 (backscatter)** 。

经典[Smagorinsky模型](@entry_id:276289)无法描述能量回传，但它是一个真实的物理现象。在[反应流](@entry_id:190741)中，能量回传的物理机制尤为重要。例如，火焰锋面处的剧烈热释放和膨胀，以及由密度梯度和压力梯度错位引起的**[斜压扭矩](@entry_id:153810) (baroclinic torque)**，都可以在小尺度上产生[湍流](@entry_id:151300)能量，这些能量随后可以“馈送”给大尺度运动。当LES的滤波宽度与火焰厚度相当（$\Delta \sim \delta_F$）且Karlovitz数较高时，这些效应尤为显著，动态模型能够捕捉到这种物理过程的信号，是其相对于经典模型的一大优势。

#### [数值稳定性](@entry_id:175146)与系数平均

瞬时、局部的模型系数 $C_\ell$ 可能出现剧烈波动，特别是可能出现较大的负值。虽然能量回传是物理的，但一个过大的负涡粘性会导致总粘性（分子粘性+涡粘性）变为负，从而在数值上引发不稳定，导致模拟崩溃。因此，纯粹局部的动态模型在数值上可能是不稳定的 。

为了保证数值稳定性，实践中通常需要对计算出的局部系数 $C_\ell$ 进行某种形式的**平均 (averaging)**。常用的方法包括：
1.  **空间平均**：在流场存在统计均匀的方向（如槽道流的展向）上对 $C_\ell$ 进行平均。
2.  **拉格朗日平均**：沿着流体质点的路径对 $C_\ell$ 在一段时间内进行平均。
3.  **截断 (Clipping)**：这是一种更简单直接的方法，即简单地将负值强制设为零，$C = \max(C_\ell, 0)$。这能有效保证稳定性，但代价是完全牺牲了对能量回传的物理描述。

平均操作是一种在**模型局部性 (locality)** 和**[数值鲁棒性](@entry_id:188030) (robustness)** 之间的权衡。例如，一项计算可能表明，为了将获得负平均系数的概率降至1%以下，需要在一个长度约为9个网格单元的流体路径上进行拉格朗日平均 。这意味着模型系数不再完全由局部瞬时流场决定，而是反映了一个稍大时空邻域内的平均状态。这种妥协对于在模拟复杂、敏感的[反应流](@entry_id:190741)（如带有 bluff-body 稳定器的火焰 ）时获得稳定且物理上合理的解至关重要。

总之，[Smagorinsky模型](@entry_id:276289)及其动态版本为LES在计算燃烧学中的应用提供了基础。从经典的涡粘性概念出发，通过引入动态程序，模型获得了适应局部流场的能力，能够正确处理层流区域、壁面附近以及[反应流](@entry_id:190741)中的复杂物理。理解其背后的原理、机制以及在实践中为保证稳定性而进行的必要调整，是成功进行高保真[燃烧模拟](@entry_id:155787)的关键。