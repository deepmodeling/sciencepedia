{
    "hands_on_practices": [
        {
            "introduction": "Before we can solve complex equations, it is essential to confirm their physical and mathematical consistency. This first practice focuses on dimensional analysis, a fundamental skill that ensures the validity of the Conditional Moment Closure (CMC) species transport equation. By verifying that each term in the equation shares the same physical units, you will develop a deeper intuition for the roles of conditional diffusion, reaction, and transport in mixture-fraction space .",
            "id": "4013603",
            "problem": "Consider the Conditional Moment Closure (CMC) species transport equation for a reacting scalar conditioned on the mixture fraction, written in mixture-fraction space for a constant-density, unity-Lewis-number, Fickian-diffusion flow as\n$$\n\\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial t} - \\frac{\\partial}{\\partial z} \\left( \\alpha(z,t) \\, \\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial z} \\right) = \\left\\langle \\frac{\\dot{\\omega}_{i}}{\\rho} \\,\\bigg|\\, z,t \\right\\rangle + N(z,t),\n$$\nwhere $z$ is the mixture fraction, $\\langle Y_{i} \\mid z,t \\rangle$ is the conditional mean of the species mass fraction, $\\alpha(z,t)$ is the coefficient that multiplies the conditional diffusive flux in mixture-fraction space, $\\dot{\\omega}_{i}$ is the volumetric production rate of species $i$, $\\rho$ is the mass density, and $N(z,t)$ is the conditional unclosed term that arises from the projection of physical-space transport into mixture-fraction space. The mixture fraction $z$ is dimensionless and defined by a conserved scalar mapping, the mass fraction $Y_{i}$ is dimensionless (ratio of species mass to mixture mass), and the conditional averaging operator $\\langle \\cdot \\mid z,t \\rangle$ preserves units.\n\nAssume Fickian diffusion in physical space with molecular diffusivity $D$ satisfying $[D] = \\text{length}^{2} \\cdot \\text{time}^{-1}$, mass density $\\rho$ satisfying $[\\rho] = \\text{mass} \\cdot \\text{length}^{-3}$, and volumetric production rate $\\dot{\\omega}_{i}$ satisfying $[\\dot{\\omega}_{i}] = \\text{mass} \\cdot \\text{length}^{-3} \\cdot \\text{time}^{-1}$. The scalar dissipation rate $\\chi$ associated with the mixture fraction satisfies the well-tested relation\n$$\n\\chi = 2 D \\, |\\nabla z|^{2},\n$$\nwith $|\\nabla z|$ denoting the magnitude of the gradient of the dimensionless mixture fraction $z$. In unity-Lewis-number, single-scalar CMC formulations, $\\alpha$ is proportional to $\\chi$.\n\nUsing the base units $\\text{mass}$ $(M)$, $\\text{length}$ $(L)$, and $\\text{time}$ $(T)$, verify the dimensional consistency of each term in the above CMC species equation by explicitly identifying the exponents $(a,b,c)$ of the base units $M^{a} L^{b} T^{c}$ for the following four quantities:\n- $\\langle Y_{i} \\mid z \\rangle$,\n- $\\alpha$,\n- $\\left\\langle \\dot{\\omega}_{i}/\\rho \\mid z \\right\\rangle$,\n- $N(z)$.\n\nReport your final answer as a single row matrix in the order listed above, where each quantity is represented by its $(a,b,c)$ triplet concatenated in sequence, yielding a $1 \\times 12$ row of numbers. Do not include units in your final answer.",
            "solution": "The problem requires a dimensional analysis of four terms appearing in the Conditional Moment Closure (CMC) species transport equation. The analysis will be performed using the fundamental base units of mass $(M)$, length $(L)$, and time $(T)$. The dimensional representation of any quantity $Q$ will be denoted by $[Q] = M^{a} L^{b} T^{c}$. The core principle of dimensional analysis is that any physically meaningful equation must be dimensionally homogeneous, meaning all terms that are added or subtracted must have the same dimensions.\n\nFirst, we establish the dimensions of the primary variables and operators from the problem statement:\n- Mass density $\\rho$: $[\\rho] = M L^{-3}$\n- Volumetric production rate $\\dot{\\omega}_{i}$: $[\\dot{\\omega}_{i}] = M L^{-3} T^{-1}$\n- Molecular diffusivity $D$: $[D] = L^2 T^{-1}$\n- Species mass fraction $Y_{i}$: As a ratio of the mass of species $i$ to the total mass of the mixture, $Y_i$ is dimensionless. $[Y_{i}] = M^0 L^0 T^0 = 1$.\n- Mixture fraction $z$: The problem states $z$ is dimensionless. $[z] = 1$.\n- Time $t$: $[t] = T$.\n- The gradient operator, $\\nabla$, involves spatial derivatives (e.g., $\\frac{\\partial}{\\partial x_j}$) and thus has dimensions of inverse length. $[\\nabla] = L^{-1}$.\n- The conditional averaging operator, $\\langle \\cdot \\mid z,t \\rangle$, is stated to preserve units. This means that for any quantity $Q$, $[\\langle Q \\mid z,t \\rangle] = [Q]$.\n\nWe will now determine the dimensional exponents $(a, b, c)$ for each of the four specified quantities.\n\n**1. Dimensions of $\\langle Y_{i} \\mid z \\rangle$ (or more precisely $\\langle Y_{i} \\mid z, t \\rangle$)**\nThe quantity $Y_{i}$ is the species mass fraction, which is dimensionless.\n$$[Y_{i}] = M^0 L^0 T^0$$\nThe conditional averaging operator preserves units. Therefore, the conditional mean of the mass fraction is also dimensionless.\n$$[\\langle Y_{i} \\mid z,t \\rangle] = [Y_{i}] = M^0 L^0 T^0$$\nThe dimensional exponents are $(a,b,c) = (0,0,0)$.\n\n**2. Dimensions of $\\alpha(z,t)$**\nWe can determine the dimensions of $\\alpha(z,t)$ in two ways: from its relation to the scalar dissipation rate $\\chi$, or by ensuring dimensional homogeneity of the CMC equation itself. Both methods must yield the same result.\n\nMethod A: Using the relation to $\\chi$.\nThe problem states that $\\alpha$ is proportional to the scalar dissipation rate $\\chi$, which implies they have the same dimensions: $[\\alpha] = [\\chi]$. The definition of $\\chi$ is given as:\n$$\\chi = 2 D \\, |\\nabla z|^{2}$$\nThe constant $2$ is dimensionless. We find the dimensions of $\\chi$ by analyzing the terms on the right-hand side.\n- $[D] = L^2 T^{-1}$\n- The gradient of the dimensionless mixture fraction $z$ has dimensions: $[\\nabla z] = [\\nabla] [z] = (L^{-1}) (1) = L^{-1}$.\n- The square of its magnitude has dimensions: $[|\\nabla z|^{2}] = (L^{-1})^2 = L^{-2}$.\nCombining these gives the dimensions of $\\chi$:\n$$[\\chi] = [D] [|\\nabla z|^{2}] = (L^2 T^{-1})(L^{-2}) = L^{2-2} T^{-1} = T^{-1}$$\nSince $[\\alpha] = [\\chi]$, the dimensions of $\\alpha$ are:\n$$[\\alpha] = T^{-1} = M^0 L^0 T^{-1}$$\nThe dimensional exponents are $(a,b,c) = (0,0,-1)$.\n\nMethod B: Using the CMC equation's homogeneity.\nThe CMC equation is:\n$$\n\\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial t} - \\frac{\\partial}{\\partial z} \\left( \\alpha(z,t) \\, \\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial z} \\right) = \\dots\n$$\nLet's analyze the dimensions of the first two terms. Let $Q_{i}(z,t) = \\langle Y_{i} \\mid z,t \\rangle$. We have established that $[Q_i] = 1$.\nThe first term is a time derivative:\n$$\\left[\\frac{\\partial Q_{i}}{\\partial t}\\right] = \\frac{[Q_i]}{[t]} = \\frac{1}{T} = T^{-1}$$\nThe second term involves derivatives with respect to the dimensionless mixture fraction $z$. The operator $\\frac{\\partial}{\\partial z}$ is dimensionless since $[z]=1$.\n$$\\left[\\frac{\\partial}{\\partial z} \\left( \\alpha \\, \\frac{\\partial Q_{i}}{\\partial z} \\right)\\right] = \\frac{1}{[z]} \\left( [\\alpha] \\frac{[Q_i]}{[z]} \\right) = \\frac{1}{1} \\left( [\\alpha] \\frac{1}{1} \\right) = [\\alpha]$$\nFor the equation to be dimensionally consistent, these two terms must have the same dimensions.\n$$[\\alpha] = \\left[\\frac{\\partial Q_{i}}{\\partial t}\\right] = T^{-1}$$\nThis confirms the result from Method A. The dimensional exponents for $\\alpha$ are $(a,b,c) = (0,0,-1)$.\n\n**3. Dimensions of $\\left\\langle \\frac{\\dot{\\omega}_{i}}{\\rho} \\,\\bigg|\\, z,t \\right\\rangle$**\nThe conditional averaging operator preserves units, so we need to find the dimensions of the ratio $\\dot{\\omega}_{i}/\\rho$.\n- The dimensions of the volumetric production rate are given: $[\\dot{\\omega}_{i}] = M L^{-3} T^{-1}$.\n- The dimensions of the mass density are given: $[\\rho] = M L^{-3}$.\nThe dimensions of their ratio are:\n$$\\left[\\frac{\\dot{\\omega}_{i}}{\\rho}\\right] = \\frac{[\\dot{\\omega}_{i}]}{[\\rho]} = \\frac{M L^{-3} T^{-1}}{M L^{-3}} = M^{1-1} L^{-3 - (-3)} T^{-1} = T^{-1}$$\nTherefore, the dimensions of the conditional reaction source term are:\n$$\\left[\\left\\langle \\frac{\\dot{\\omega}_{i}}{\\rho} \\,\\bigg|\\, z,t \\right\\rangle\\right] = T^{-1} = M^0 L^0 T^{-1}$$\nThe dimensional exponents are $(a,b,c) = (0,0,-1)$. This is consistent with the dimensions of the terms on the left-hand side of the CMC equation.\n\n**4. Dimensions of $N(z,t)$**\nThe full CMC equation is:\n$$\n\\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial t} - \\frac{\\partial}{\\partial z} \\left( \\alpha(z,t) \\, \\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial z} \\right) = \\left\\langle \\frac{\\dot{\\omega}_{i}}{\\rho} \\,\\bigg|\\, z,t \\right\\rangle + N(z,t)\n$$\nAccording to the principle of dimensional homogeneity, all terms that are added or subtracted must possess the same dimensions. We have already determined the dimensions of the other three terms:\n- $\\left[\\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial t}\\right] = T^{-1}$\n- $\\left[\\frac{\\partial}{\\partial z} \\left( \\alpha \\, \\frac{\\partial \\langle Y_{i} \\mid z,t \\rangle}{\\partial z} \\right)\\right] = T^{-1}$\n- $\\left[\\left\\langle \\frac{\\dot{\\omega}_{i}}{\\rho} \\,\\bigg|\\, z,t \\right\\rangle\\right] = T^{-1}$\nSince $N(z,t)$ is added to the conditional reaction term, it must have the same dimensions.\n$$[N(z,t)] = \\left[\\left\\langle \\frac{\\dot{\\omega}_{i}}{\\rho} \\,\\bigg|\\, z,t \\right\\rangle\\right] = T^{-1}$$\nThus, the dimensions of $N(z,t)$ are:\n$$[N(z,t)] = T^{-1} = M^0 L^0 T^{-1}$$\nThe dimensional exponents are $(a,b,c) = (0,0,-1)$.\n\nSummary of dimensional exponents $(a,b,c)$ in the form $M^a L^b T^c$:\n- For $\\langle Y_{i} \\mid z \\rangle$: $(0,0,0)$\n- For $\\alpha$: $(0,0,-1)$\n- For $\\left\\langle \\dot{\\omega}_{i}/\\rho \\mid z \\right\\rangle$: $(0,0,-1)$\n- For $N(z)$: $(0,0,-1)$\n\nThe final answer is the concatenation of these triplets into a single $1 \\times 12$ row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 0 & -1 & 0 & 0 & -1 & 0 & 0 & -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A central challenge in modeling turbulent combustion is accounting for fluctuations in the mixture fraction, $Z$. The CMC framework addresses this by using a presumed probability density function (PDF) for $Z$. This exercise provides a hands-on method for constructing the widely used Beta-PDF from its first two statistical momentsâ€”the mean and varianceâ€”which are often available from experiments or simpler turbulence models. Mastering this technique is crucial for connecting physical flow statistics to the mathematical inputs of the CMC formulation .",
            "id": "4013608",
            "problem": "In Conditional Moment Closure (CMC), species and temperature equations are conditioned on the conserved mixture fraction $Z$, and closures require a presumed probability density function (PDF) of $Z$ at inflow boundaries. Consider a statistically stationary premixed inflow for which measurements indicate a mean mixture fraction $\\mu=\\overline{Z}$ and variance $\\sigma_{Z}^{2}=\\overline{(Z-\\overline{Z})^{2}}$. Assume a presumed Beta distribution for $Z$ on $[0,1]$ with parameters $(\\alpha,\\beta)$.\n\nStarting from the following foundational facts:\n- The Beta probability density on $[0,1]$ is a two-parameter family with parameters $\\alpha>0$ and $\\beta>0$.\n- For a Beta distribution with parameters $(\\alpha,\\beta)$, the mean and variance are functions of $\\alpha$ and $\\beta$ and can be expressed in closed form.\n\nUsing only these facts and the definitions of mean and variance, derive analytic expressions for $\\alpha$ and $\\beta$ in terms of $\\mu$ and $\\sigma_{Z}^{2}$. Then, evaluate your expressions for a premixed inflow with $\\mu=0.06$ and $\\sigma_{Z}^{2}=2.0\\times 10^{-4}$, and report the numerical values of $(\\alpha,\\beta)$.\n\nFinally, interpret the limiting behavior of your formulas as $\\sigma_{Z}^{2}\\to 0^{+}$ and as $\\sigma_{Z}^{2}\\to \\mu(1-\\mu)$, and state the admissible range of $\\sigma_{Z}^{2}$ for which your $(\\alpha,\\beta)$ remain positive, commenting on the physical meaning of these limits for a premixed inflow in the CMC context.\n\nRound your final numerical values of $\\alpha$ and $\\beta$ to four significant figures. Express the final answer without units, as a single row matrix $\\begin{pmatrix}\\alpha & \\beta\\end{pmatrix}$.",
            "solution": "The task is to derive expressions for the parameters $\\alpha$ and $\\beta$ of a Beta probability density function (PDF) in terms of its mean $\\mu$ and variance $\\sigma_{Z}^{2}$. The Beta distribution is presumed for the mixture fraction $Z$, which is a random variable on the interval $[0,1]$.\n\nThe mean $\\mu$ and variance $\\sigma_{Z}^{2}$ of a random variable $Z$ following a Beta distribution with parameters $\\alpha > 0$ and $\\beta > 0$ are given by the standard formulas:\n$$\n\\mu = \\frac{\\alpha}{\\alpha + \\beta}\n$$\n$$\n\\sigma_{Z}^{2} = \\frac{\\alpha \\beta}{(\\alpha + \\beta)^{2} (\\alpha + \\beta + 1)}\n$$\n\nWe can express the variance in terms of the mean. Notice that:\n$$\n1 - \\mu = 1 - \\frac{\\alpha}{\\alpha + \\beta} = \\frac{\\alpha + \\beta - \\alpha}{\\alpha + \\beta} = \\frac{\\beta}{\\alpha + \\beta}\n$$\nSubstituting the expressions for $\\mu$ and $1-\\mu$ into the variance equation yields:\n$$\n\\sigma_{Z}^{2} = \\left(\\frac{\\alpha}{\\alpha + \\beta}\\right) \\left(\\frac{\\beta}{\\alpha + \\beta}\\right) \\frac{1}{\\alpha + \\beta + 1} = \\mu(1-\\mu) \\frac{1}{\\alpha + \\beta + 1}\n$$\nThis simplified relationship allows us to solve for the sum of the parameters, $\\alpha + \\beta$. Rearranging the equation, we get:\n$$\n\\alpha + \\beta + 1 = \\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}}\n$$\n$$\n\\alpha + \\beta = \\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} - 1\n$$\nNow we have an expression for the sum $\\alpha+\\beta$. We can use the original definition of the mean to find $\\alpha$ and $\\beta$ individually.\nFrom $\\mu = \\frac{\\alpha}{\\alpha + \\beta}$, we have $\\alpha = \\mu(\\alpha + \\beta)$.\nSubstituting the expression for $\\alpha + \\beta$:\n$$\n\\alpha = \\mu \\left( \\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} - 1 \\right)\n$$\nSimilarly, from $1 - \\mu = \\frac{\\beta}{\\alpha + \\beta}$, we have $\\beta = (1-\\mu)(\\alpha + \\beta)$.\nSubstituting the expression for $\\alpha + \\beta$:\n$$\n\\beta = (1-\\mu) \\left( \\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} - 1 \\right)\n$$\nThese are the desired analytic expressions for $\\alpha$ and $\\beta$ in terms of $\\mu$ and $\\sigma_{Z}^{2}$.\n\nNext, we evaluate these expressions for the given premixed inflow conditions: $\\mu = 0.06$ and $\\sigma_{Z}^{2} = 2.0 \\times 10^{-4}$.\nFirst, calculate the common factor term:\n$$\n\\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} - 1 = \\frac{0.06(1 - 0.06)}{2.0 \\times 10^{-4}} - 1 = \\frac{0.06 \\times 0.94}{2.0 \\times 10^{-4}} - 1 = \\frac{0.0564}{2.0 \\times 10^{-4}} - 1\n$$\n$$\n\\frac{0.0564}{2.0 \\times 10^{-4}} - 1 = 282 - 1 = 281\n$$\nNow, we can compute $\\alpha$ and $\\beta$:\n$$\n\\alpha = \\mu (281) = 0.06 \\times 281 = 16.86\n$$\n$$\n\\beta = (1-\\mu) (281) = (1 - 0.06) \\times 281 = 0.94 \\times 281 = 264.14\n$$\nRounding the results to four significant figures as requested:\n$\\alpha = 16.86$\n$\\beta = 264.1$\n\nFinally, we analyze the limiting behaviors and the admissible range of $\\sigma_{Z}^{2}$.\nFor the parameters $\\alpha$ and $\\beta$ to be positive, which is a requirement for the Beta distribution, the factor they share must be positive:\n$$\n\\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} - 1 > 0 \\implies \\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} > 1 \\implies \\sigma_{Z}^{2} < \\mu(1-\\mu)\n$$\nSince variance must be non-negative, the admissible range for $\\sigma_{Z}^{2}$ so that $\\alpha > 0$ and $\\beta > 0$ is $0 < \\sigma_{Z}^{2} < \\mu(1-\\mu)$.\n\nLet's examine the limits at the boundaries of this range:\n1.  As $\\sigma_{Z}^{2} \\to 0^{+}$:\n    The term $\\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} \\to \\infty$. Consequently, both $\\alpha \\to \\infty$ and $\\beta \\to \\infty$. A Beta distribution with very large parameters becomes increasingly concentrated around its mean. In this limit, the PDF approaches a Dirac delta function, $P(Z) \\to \\delta(Z-\\mu)$.\n    Physical interpretation: A variance of zero means there are no fluctuations in the mixture fraction. This represents a perfectly homogeneous, or \"perfectly premixed\", inflow where $Z$ is constant and equal to $\\mu$ everywhere.\n\n2.  As $\\sigma_{Z}^{2} \\to \\mu(1-\\mu)$:\n    The term $\\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} \\to 1^{+}$. Consequently, the factor $\\left(\\frac{\\mu(1-\\mu)}{\\sigma_{Z}^{2}} - 1\\right) \\to 0^{+}$. This means both $\\alpha \\to 0^{+}$ and $\\beta \\to 0^{+}$.\n    When $\\alpha$ and $\\beta$ are both less than $1$, the Beta distribution is U-shaped, with modes at $Z=0$ and $Z=1$. In the limit as $\\alpha, \\beta \\to 0$, the probability mass becomes entirely concentrated at these two endpoints. The resulting distribution is a sum of two Dirac delta functions: $P(Z) = (1-\\mu)\\delta(Z-0) + \\mu\\delta(Z-1)$. This corresponds to a Bernoulli trial, which has the maximum possible variance for a random variable on $[0,1]$ with mean $\\mu$.\n    Physical interpretation: This limit represents a completely segregated flow consisting of unmixed pockets of pure oxidizer ($Z=0$) and pure fuel (if we conventionally set the stoichiometric mixture fraction of fuel to be $Z=1$, though in reality fuel streams are just one component of the mixture). This is the idealized limit of a non-premixed system, where no mixing has occurred at the inflow boundary.\n\nThe admissible range $0 < \\sigma_{Z}^{2} < \\mu(1-\\mu)$ thus allows the Beta-PDF to represent any state of mixing from nearly perfectly premixed (small $\\sigma_{Z}^{2}$) to highly stratified and close to non-premixed (large $\\sigma_{Z}^{2}$). This flexibility is a primary advantage of using the Beta-PDF in CMC and other turbulent combustion models.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n16.86 & 264.1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having examined the equation's components and the statistical model for the mixture fraction, we now turn to solving the governing equation itself. This advanced practice guides you through the solution of a simplified one-dimensional, steady-state CMC equation, which forms a boundary value problem common in computational fluid dynamics. By deriving and implementing an integral solution, you will gain experience in transforming a theoretical differential equation into a practical and robust numerical algorithm, a cornerstone of computational modeling .",
            "id": "4013625",
            "problem": "Consider a one-dimensional, steady, mixture-fraction-parametrized reactive flow in computational combustion, where the Conditional Moment Closure (CMC) formulation is applied to the conditional mean of a species mass fraction. Let the mixture fraction coordinate be denoted by $z \\in [0,1]$, and let the conditional mean of species $i$ be $\\langle Y_i \\mid z \\rangle$. Under steady, one-dimensional conditions with conditional diffusion represented by a positive mobility $N(z)$ and a known conditional source $S_i(z) = \\langle \\dot{\\omega}_i / \\rho \\mid z \\rangle$, the reduced CMC ordinary differential equation is\n$$\n\\frac{d}{dz}\\left( N(z)\\, \\frac{d \\langle Y_i \\mid z \\rangle}{dz} \\right) + S_i(z) = 0,\\quad z \\in (0,1).\n$$\nAssume robust boundary conditions that are physically consistent with feed compositions in the limit of pure streams, namely the Dirichlet conditions\n$$\n\\langle Y_i \\mid z=0 \\rangle = Y_{i,F},\\qquad \\langle Y_i \\mid z=1 \\rangle = Y_{i,O},\n$$\nwith given constants $Y_{i,F}$ and $Y_{i,O}$. All quantities are dimensionless.\n\nStarting from first principles of species conservation in mixture-fraction space and the definition of conditional moments, derive an algorithmic solution strategy that reduces the boundary value problem to integral equations that are numerically tractable for arbitrary positive $N(z)$ and integrable $S_i(z)$. Implement this strategy in a complete, runnable program that evaluates the solution $\\langle Y_i \\mid z \\rangle$ at specified sampling points for the following test suite. Express all requested outputs as dimensionless floats rounded to six decimals.\n\nTest Suite:\n- Test Case $1$ (general case):\n  - $N(z) = 1$ for all $z$.\n  - $S_i(z) = s_0 \\sin(2 \\pi z)$ with $s_0 = 0.5$.\n  - $Y_{i,F} = 0.0$, $Y_{i,O} = 1.0$.\n  - Sampling points: $z = 0.25$, $z = 0.5$, $z = 0.75$.\n- Test Case $2$ (non-constant mobility with uniform source):\n  - $N(z) = 1 + 3 z$.\n  - $S_i(z) = 0.4$ (constant).\n  - $Y_{i,F} = 0.0$, $Y_{i,O} = 0.2$.\n  - Sampling points: $z = 0.3$, $z = 0.6$.\n- Test Case $3$ (spatially localized reaction with varying mobility):\n  - $N(z) = 1 - 0.5 \\cos(2 \\pi z)$.\n  - $S_i(z) = \\dfrac{4.0}{\\sqrt{2 \\pi}\\, \\sigma}\\, \\exp\\!\\left( -\\dfrac{(z - 0.5)^2}{2 \\sigma^2} \\right)$ with $\\sigma = 0.05$.\n  - $Y_{i,F} = 0.3$, $Y_{i,O} = 0.1$.\n  - Sampling points: $z = 0.5$, $z = 0.9$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$). The list must aggregate the values of $\\langle Y_i \\mid z \\rangle$ in the order specified above across all test cases, rounded to six decimals. The outputs are dimensionless floats.",
            "solution": "### Derivation of the Algorithmic Solution\n\nThe task is to find the solution $\\langle Y_i \\mid z \\rangle$ to the boundary value problem. For notational simplicity, let $Y(z) \\equiv \\langle Y_i \\mid z \\rangle$, $S(z) \\equiv S_i(z)$, $Y_F \\equiv Y_{i,F}$, and $Y_O \\equiv Y_{i,O}$. The problem is thus:\n$$\n\\frac{d}{dz}\\left( N(z)\\, \\frac{dY}{dz} \\right) = -S(z) \\quad \\text{with} \\quad Y(0) = Y_F, \\quad Y(1) = Y_O.\n$$\nThis is a linear second-order ordinary differential equation, which can be solved by performing two successive integrations. Let us integrate the equation from an arbitrary point $\\zeta_0$ to $z$:\n$$\n\\int_{\\zeta_0}^{z} \\frac{d}{d\\tau}\\left( N(\\tau)\\, \\frac{dY}{d\\tau} \\right) d\\tau = -\\int_{\\zeta_0}^{z} S(\\tau) d\\tau\n$$\nApplying the fundamental theorem of calculus to the left-hand side yields:\n$$\n\\left[ N(\\tau)\\, \\frac{dY}{d\\tau} \\right]_{\\zeta_0}^{z} = N(z)\\frac{dY}{dz} - N(\\zeta_0)\\left(\\frac{dY}{dz}\\right)_{z=\\zeta_0} = -\\int_{\\zeta_0}^{z} S(\\tau) d\\tau\n$$\nChoosing the lower limit of integration as $\\zeta_0=0$ and rearranging, we obtain an expression for the first derivative of $Y(z)$:\n$$\nN(z)\\frac{dY}{dz} = N(0)\\left(\\frac{dY}{dz}\\right)_{z=0} - \\int_0^z S(\\tau) d\\tau\n$$\nLet $C_1 = N(0)\\left(\\frac{dY}{dz}\\right)_{z=0}$ be an unknown constant representing the flux at the $z=0$ boundary. Then, we can write:\n$$\n\\frac{dY}{dz} = \\frac{C_1}{N(z)} - \\frac{1}{N(z)} \\int_0^z S(\\tau) d\\tau\n$$\nIntegrating this equation with respect to $z$ from $0$ to a final point, which we will also call $z$ (using $\\zeta$ as the dummy integration variable):\n$$\n\\int_0^z \\frac{dY}{d\\zeta} d\\zeta = \\int_0^z \\left( \\frac{C_1}{N(\\zeta)} - \\frac{1}{N(\\zeta)} \\int_0^\\zeta S(\\tau) d\\tau \\right) d\\zeta\n$$\n$$\nY(z) - Y(0) = C_1 \\int_0^z \\frac{d\\zeta}{N(\\zeta)} - \\int_0^z \\frac{1}{N(\\zeta)}\\left(\\int_0^\\zeta S(\\tau) d\\tau\\right) d\\zeta\n$$\nWe can define two key integral functions:\n$$\nJ(z) = \\int_0^z \\frac{d\\zeta}{N(\\zeta)} \\quad \\text{and} \\quad K(z) = \\int_0^z \\frac{1}{N(\\zeta)}\\left(\\int_0^\\zeta S(\\tau) d\\tau\\right) d\\zeta\n$$\nSubstituting $Y(0)=Y_F$, the general solution takes the form:\n$$\nY(z) = Y_F + C_1 J(z) - K(z)\n$$\nThe constant $C_1$ is determined by applying the second boundary condition, $Y(1) = Y_O$:\n$$\nY(1) = Y_O = Y_F + C_1 J(1) - K(1)\n$$\nSolving for $C_1$:\n$$\nC_1 = \\frac{Y_O - Y_F + K(1)}{J(1)}\n$$\nSubstituting this expression for $C_1$ back into the solution for $Y(z)$:\n$$\nY(z) = Y_F + \\left( \\frac{Y_O - Y_F + K(1)}{J(1)} \\right) J(z) - K(z)\n$$\nThis is the final integral form of the solution. This expression is numerically tractable for arbitrary positive $N(z)$ and integrable $S(z)$. We can elegantly decompose this solution into a homogeneous part, $Y_h(z)$, which solves the equation without the source term but with the correct boundary conditions, and a particular part, $Y_p(z)$, which solves the equation with the source term but with zero boundary conditions.\n$$\nY(z) = \\underbrace{\\left( Y_F + (Y_O - Y_F)\\frac{J(z)}{J(1)} \\right)}_{Y_h(z)} + \\underbrace{\\left( J(z)\\frac{K(1)}{J(1)} - K(z) \\right)}_{Y_p(z)}\n$$\nThis form of the solution provides a clear algorithmic path.\n\n### Algorithmic Strategy\n\nFor a given set of functions $N(z)$ and $S(z)$, and boundary values $Y_F$ and $Y_O$:\n1.  Define the integrands for the functions $J(z)$ and $K(z)$. The integrand for $K(z)$, namely $\\frac{1}{N(z)}\\int_0^z S(\\tau)d\\tau$, involves an inner integral that must be evaluated for each point $z$ in the outer integration domain.\n2.  Using a numerical quadrature method (e.g., `scipy.integrate.quad`), compute the definite integrals $J(1) = \\int_0^1 \\frac{d\\zeta}{N(\\zeta)}$ and $K(1) = \\int_0^1 \\left(\\frac{1}{N(\\zeta)}\\int_0^\\zeta S(\\tau) d\\tau\\right) d\\zeta$.\n3.  For each specified sampling point $z_{sample}$:\n    a. Numerically evaluate the integrals $J(z_{sample}) = \\int_0^{z_{sample}} \\frac{d\\zeta}{N(\\zeta)}$ and $K(z_{sample}) = \\int_0^{z_{sample}} \\left(\\frac{1}{N(\\zeta)}\\int_0^\\zeta S(\\tau) d\\tau\\right) d\\zeta$.\n    b. Assemble the final solution using the derived formula:\n    $$\n    Y(z_{sample}) = Y_F + (Y_O - Y_F) \\frac{J(z_{sample})}{J(1)} + J(z_{sample})\\frac{K(1)}{J(1)} - K(z_{sample})\n    $$\n4.  Collect and report the calculated values $Y(z_{sample})$ for all required points. This procedure will be implemented in the provided program.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve the CMC boundary value problem for all test cases.\n    \"\"\"\n\n    def solve_bvp(N_func, S_func, YF, YO, z_samples):\n        \"\"\"\n        Solves the 1D steady CMC equation for a given set of parameters.\n\n        The solution is based on the derived integral form:\n        Y(z) = Y_h(z) + Y_p(z)\n        Y_h(z) = YF + (YO - YF) * J(z) / J(1)\n        Y_p(z) = J(z) * K(1) / J(1) - K(z)\n        where J(z) = integral(1/N) and K(z) = integral((1/N)*integral(S)).\n        \"\"\"\n        solution_values = []\n\n        # Define the integrand for J(z) = integral_0^z (1/N(zeta)) dzeta\n        def integrand_J(zeta):\n            return 1.0 / N_func(zeta)\n        \n        # Define the integrand for K(z) = integral_0^z (1/N(zeta)) * [integral_0^zeta S(tau) dtau] dzeta\n        # The inner integral (on S) must be computed for each evaluation of the outer integrand.\n        def integrand_K(zeta):\n            # The inner integral: integral from 0 to zeta of S(tau) dtau\n            inner_integral_val, _ = quad(S_func, 0, zeta, epsabs=1e-9, epsrel=1e-9)\n            return inner_integral_val / N_func(zeta)\n\n        # Calculate the full-domain definite integrals J(1) and K(1)\n        # These are constants for a given problem setup.\n        try:\n            J1, _ = quad(integrand_J, 0, 1, epsabs=1e-9, epsrel=1e-9)\n            K1, _ = quad(integrand_K, 0, 1, epsabs=1e-9, epsrel=1e-9)\n        except Exception as e:\n            # Handle potential integration errors, which should not occur for these well-behaved functions.\n            print(f\"Error during integration for J(1) or K(1): {e}\")\n            return [np.nan] * len(z_samples)\n\n        # Calculate the solution Y(z) at each specified sampling point\n        for z_sample in z_samples:\n            if z_sample == 0:\n                solution_values.append(YF)\n                continue\n            if z_sample == 1:\n                solution_values.append(YO)\n                continue\n\n            try:\n                # Calculate J(z_sample) and K(z_sample)\n                Jz, _ = quad(integrand_J, 0, z_sample, epsabs=1e-9, epsrel=1e-9)\n                Kz, _ = quad(integrand_K, 0, z_sample, epsabs=1e-9, epsrel=1e-9)\n            except Exception as e:\n                print(f\"Error during integration for z={z_sample}: {e}\")\n                solution_values.append(np.nan)\n                continue\n            \n            # Assemble the solution from the homogeneous and particular parts\n            Y_h = YF + (YO - YF) * Jz / J1\n            Y_p = (K1 / J1) * Jz - Kz\n            \n            Y_at_z = Y_h + Y_p\n            solution_values.append(Y_at_z)\n            \n        return solution_values\n\n    # Define the parameters for the three test cases from the problem statement.\n    test_cases = [\n        {\n            \"id\": 1,\n            \"params\": {\n                \"N_func\": lambda z: 1.0,\n                \"S_func\": lambda z, s0=0.5: s0 * np.sin(2 * np.pi * z),\n                \"YF\": 0.0, \"YO\": 1.0,\n                \"z_samples\": [0.25, 0.5, 0.75]\n            }\n        },\n        {\n            \"id\": 2,\n            \"params\": {\n                \"N_func\": lambda z: 1.0 + 3.0 * z,\n                \"S_func\": lambda z: 0.4,\n                \"YF\": 0.0, \"YO\": 0.2,\n                \"z_samples\": [0.3, 0.6]\n            }\n        },\n        {\n            \"id\": 3,\n            \"params\": {\n                \"N_func\": lambda z: 1.0 - 0.5 * np.cos(2 * np.pi * z),\n                \"S_func\": lambda z, sigma=0.05: (4.0 / (np.sqrt(2 * np.pi) * sigma)) * np.exp(-(z - 0.5)**2 / (2 * sigma**2)),\n                \"YF\": 0.3, \"YO\": 0.1,\n                \"z_samples\": [0.5, 0.9]\n            }\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        results = solve_bvp(**case[\"params\"])\n        all_results.extend(results)\n\n    # Format the final output as a single line of comma-separated values rounded to six decimals.\n    formatted_results = [f\"{res:.6f}\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}