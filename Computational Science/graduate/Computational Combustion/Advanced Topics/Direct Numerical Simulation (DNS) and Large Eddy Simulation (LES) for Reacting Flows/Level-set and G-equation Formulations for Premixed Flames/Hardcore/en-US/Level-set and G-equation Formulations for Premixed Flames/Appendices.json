{
    "hands_on_practices": [
        {
            "introduction": "A classic application of the G-equation is to model flames stabilized in a steady flow, like the V-shaped flame behind a flameholder. The flame's shape is governed by the steady-state G-equation, a form of the Eikonal equation. This practice  provides a fundamental exercise in solving this equation for a uniform flow, connecting the abstract level-set formulation to the tangible, observable flame angle.",
            "id": "4035858",
            "problem": "Consider a two-dimensional, steady, premixed flame represented by a level-set function $G(x,y)$, whose zero level set $G=0$ coincides with the flame front. The $G$-equation in steady state reduces to the Eikonal form\n$$\n\\mathbf{u}\\cdot\\nabla G \\;=\\; S_L\\,\\lvert \\nabla G\\rvert,\n$$\nwhere $\\mathbf{u}=(U,0)$ is a uniform inlet velocity with $U0$ and $S_L0$ is the constant laminar burning speed of the mixture. The domain is the half-plane $y\\ge 0$, and the boundary condition along the line $y=0$ is\n$$\nG(x,0)=x.\n$$\nAssume $U\\ge S_L$ so that a steady attached flame is possible. Solve the steady Eikonal equation subject to the boundary condition. Then, define the flame angle $\\alpha$ as the angle (in radians) between the unit normal $\\mathbf{n}=\\nabla G/\\lvert \\nabla G\\rvert$ (pointing in the direction of increasing $G$) and the positive $x$-axis. Express $\\alpha$ in terms of $U$ and $S_L$, and report $\\alpha$ (in radians) as your final answer. If multiple branches arise, select the branch with $\\partial G/\\partial y0$.",
            "solution": "The user wants me to solve for the flame angle alpha based on a steady-state G-equation for a premixed flame.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The steady-state Eikonal equation for the level-set function $G(x,y)$ is $\\mathbf{u}\\cdot\\nabla G \\;=\\; S_L\\,\\lvert \\nabla G\\rvert$.\n-   **Velocity Field**: $\\mathbf{u}=(U,0)$, where $U0$.\n-   **Laminar Burning Speed**: $S_L  0$, constant.\n-   **Domain**: The half-plane $y\\ge 0$.\n-   **Boundary Condition**: $G(x,0)=x$ along the line $y=0$.\n-   **Constraint**: $U\\ge S_L$.\n-   **Definition of Flame Angle**: $\\alpha$ is the angle between the unit normal $\\mathbf{n}=\\nabla G/\\lvert \\nabla G\\rvert$ and the positive $x$-axis.\n-   **Branch Selection**: The solution branch with $\\partial G/\\partial y0$ must be selected.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the well-established level-set methodology for modeling premixed combustion. The $G$-equation is a standard formulation. The setup is a canonical representation of a V-shaped flame stabilized on a flameholder (represented here by the line $y=0$). All variables and constants are clearly defined. The boundary condition is specified, and a constraint ($U \\ge S_L$) is provided to ensure a physically realistic, steady solution exists. The branch selection criterion ensures a unique solution. The problem is self-contained, objective, and well-posed. No scientific, mathematical, or logical flaws are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe governing partial differential equation is the steady-state Eikonal equation:\n$$\n\\mathbf{u}\\cdot\\nabla G = S_L \\lvert \\nabla G \\rvert\n$$\nIn two-dimensional Cartesian coordinates, with $\\mathbf{u} = (U, 0)$ and $\\nabla G = (\\frac{\\partial G}{\\partial x}, \\frac{\\partial G}{\\partial y})$, the equation becomes:\n$$\n(U, 0) \\cdot \\left(\\frac{\\partial G}{\\partial x}, \\frac{\\partial G}{\\partial y}\\right) = S_L \\sqrt{\\left(\\frac{\\partial G}{\\partial x}\\right)^2 + \\left(\\frac{\\partial G}{\\partial y}\\right)^2}\n$$\n$$\nU \\frac{\\partial G}{\\partial x} = S_L \\sqrt{\\left(\\frac{\\partial G}{\\partial x}\\right)^2 + \\left(\\frac{\\partial G}{\\partial y}\\right)^2}\n$$\nGiven the uniform flow and the linear boundary condition, we seek a linear solution for $G(x,y)$ of the form:\n$$\nG(x,y) = ax + by + c\n$$\nwhere $a$, $b$, and $c$ are constants.\nApplying the boundary condition $G(x,0) = x$:\n$$\nG(x,0) = a(x) + b(0) + c = ax+c\n$$\nFor this to equal $x$ for all $x$, we must have $a=1$ and $c=0$. The solution form simplifies to:\n$$\nG(x,y) = x + by\n$$\nNow, we find the partial derivatives of this proposed solution:\n$$\n\\frac{\\partial G}{\\partial x} = 1\n$$\n$$\n\\frac{\\partial G}{\\partial y} = b\n$$\nSubstituting these derivatives into the governing equation:\n$$\nU (1) = S_L \\sqrt{(1)^2 + (b)^2}\n$$\n$$\nU = S_L \\sqrt{1 + b^2}\n$$\nWe solve for the constant $b$. Since $U \\ge S_L  0$, we can square both sides:\n$$\nU^2 = S_L^2 (1 + b^2)\n$$\n$$\n\\frac{U^2}{S_L^2} = 1 + b^2\n$$\n$$\nb^2 = \\left(\\frac{U}{S_L}\\right)^2 - 1\n$$\nThis gives two possible values for $b$:\n$$\nb = \\pm \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\n$$\nThe problem specifies a branch selection criterion: $\\partial G / \\partial y  0$. Since $\\partial G / \\partial y = b$, we must choose the positive root:\n$$\nb = \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\n$$\nThis real solution for $b$ exists because of the given condition $U \\ge S_L$. The level-set function is therefore:\n$$\nG(x,y) = x + y\\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\n$$\nThe flame front is defined by the level set $G=0$. The unit normal vector $\\mathbf{n}$ points in the direction of increasing $G$ and is given by $\\mathbf{n} = \\nabla G / \\lvert\\nabla G\\rvert$.\nFirst, we compute the gradient vector $\\nabla G$:\n$$\n\\nabla G = \\left(\\frac{\\partial G}{\\partial x}, \\frac{\\partial G}{\\partial y}\\right) = (1, b) = \\left(1, \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\\right)\n$$\nNext, we compute its magnitude $\\lvert\\nabla G\\rvert$:\n$$\n\\lvert\\nabla G\\rvert = \\sqrt{1^2 + b^2} = \\sqrt{1 + \\left(\\left(\\frac{U}{S_L}\\right)^2 - 1\\right)} = \\sqrt{\\left(\\frac{U}{S_L}\\right)^2} = \\frac{U}{S_L}\n$$\nThis result is also directly evident from the original equation: $U(1) = S_L \\lvert\\nabla G\\rvert \\implies \\lvert\\nabla G\\rvert = U/S_L$.\nThe unit normal vector is:\n$$\n\\mathbf{n} = \\frac{\\nabla G}{\\lvert\\nabla G\\rvert} = \\frac{\\left(1, \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\\right)}{U/S_L} = \\left(\\frac{S_L}{U}, \\frac{S_L}{U}\\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\\right) = \\left(\\frac{S_L}{U}, \\sqrt{1 - \\left(\\frac{S_L}{U}\\right)^2}\\right)\n$$\nThe flame angle $\\alpha$ is defined as the angle between the unit normal $\\mathbf{n}$ and the positive $x$-axis, which is represented by the unit vector $\\mathbf{e}_x = (1,0)$. The cosine of this angle is given by the dot product of the two unit vectors, which is simply the $x$-component of $\\mathbf{n}$:\n$$\n\\cos(\\alpha) = \\mathbf{n} \\cdot \\mathbf{e}_x = n_x = \\frac{S_L}{U}\n$$\nThe condition $\\partial G/\\partial y  0$ implies that the $y$-component of $\\mathbf{n}$ is positive. This means $\\sin(\\alpha)  0$. Since $U \\ge S_L  0$, we have $0  S_L/U \\le 1$, which places the angle $\\alpha$ in the range $[0, \\pi/2]$. The relation $\\alpha = \\arccos(S_L/U)$ uniquely defines an angle in this range.\nTherefore, the flame angle $\\alpha$ is given by:\n$$\n\\alpha = \\arccos\\left(\\frac{S_L}{U}\\right)\n$$",
            "answer": "$$\n\\boxed{\\arccos\\left(\\frac{S_L}{U}\\right)}\n$$"
        },
        {
            "introduction": "The assumption of a constant burning speed is a useful starting point, but real flames are more complex; their local burning rate is affected by flame stretch. This practice  delves into this by incorporating the Markstein length, $L_M$, to model the sensitivity of the propagation speed to flame curvature. By analyzing a front with prescribed curvature, you will see how thermo-diffusive effects can enhance or suppress local burning, a mechanism central to flame instability and quenching.",
            "id": "4035874",
            "problem": "Consider a two-dimensional, premixed flame front represented by a level-set function $G(\\mathbf{x},t)$, with the flame surface given by $G=0$ and the unit normal $\\mathbf{n}=\\nabla G/|\\nabla G|$ pointing from burned products toward unburned reactants. The local mean curvature is defined as $\\kappa=\\nabla\\cdot\\mathbf{n}$ and is taken to be positive when the front is convex toward the unburned gas. Assume low-Mach-number conditions, unity Lewis number departures captured by a positive Markstein length $L_M0$, negligible tangential strain and flow-induced stretch along the front, and small curvature such that $|L_M\\,\\kappa|\\ll 1$.\n\nAlong arc length $s\\in[0,\\ell]$ parameterizing the front, the curvature is prescribed as\n$$\n\\kappa(s)=\\kappa_0+\\kappa_1\\cos\\!\\left(\\frac{2\\pi s}{\\ell}\\right),\n$$\nwith parameters $\\kappa_00$, $\\kappa_10$, and $\\ell0$. Let $S_L^00$ denote the planar laminar burning velocity in the same mixture and thermochemical state. Using a first-principles formulation in terms of the level-set propagation with curvature-sensitive normal speed, derive the leading-order analytical expression for the spatial distribution of the normal propagation speed $S_n(s)$ along the front in terms of $S_L^0$, $L_M$, $\\kappa_0$, $\\kappa_1$, and $\\ell$. Then, based on this distribution, identify where along $s$ the front is most susceptible to local quenching and provide the parametric criterion for the onset of local quenching in terms of $L_M$, $\\kappa_0$, and $\\kappa_1$.\n\nProvide your final answer as a single closed-form expression for $S_n(s)$ in terms of the given parameters. No numerical evaluation or rounding is required, and no units should be included in the final expression. All intermediate reasoning should be shown in your solution.",
            "solution": "The user wants me to solve a problem in computational combustion.\n\n### Step 1: Extract Givens\n\n*   **System**: A two-dimensional, premixed flame front.\n*   **Representation**: A level-set function $G(\\mathbf{x},t)$, with the flame surface defined by $G=0$.\n*   **Normal vector**: $\\mathbf{n}=\\nabla G/|\\nabla G|$, pointing from burned products toward unburned reactants.\n*   **Mean curvature**: $\\kappa=\\nabla\\cdot\\mathbf{n}$, defined as positive when the front is convex toward the unburned gas.\n*   **Flow conditions**: Low-Mach-number conditions.\n*   **Thermophysical properties**: Unity Lewis number departures are captured by a positive Markstein length, $L_M0$.\n*   **Stretch**: Negligible tangential strain and flow-induced stretch along the front.\n*   **Curvature magnitude**: Small curvature assumption, $|L_M\\,\\kappa|\\ll 1$.\n*   **Curvature distribution**: Along the arc length $s\\in[0,\\ell]$, the curvature is given by $\\kappa(s)=\\kappa_0+\\kappa_1\\cos\\!\\left(\\frac{2\\pi s}{\\ell}\\right)$.\n*   **Parameters**: $\\kappa_00$, $\\kappa_10$, $\\ell0$.\n*   **Reference burning velocity**: $S_L^00$ is the planar laminar burning velocity.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is analyzed against the validation criteria:\n\n*   **Scientifically Grounded**: The problem is firmly rooted in the fundamental theory of premixed flame propagation, specifically using the level-set (G-equation) method and the concept of stretch-affected flame speed characterized by the Markstein length. All concepts and equations are standard in the field of combustion science.\n*   **Well-Posed**: The problem is well-posed. It provides a clear physical model with a complete set of parameters and constraints (e.g., negligible flow strain, small curvature), which are sufficient to derive a unique analytical expression for the normal propagation speed $S_n(s)$. The assumption $|L_M\\,\\kappa|\\ll 1$ provides a clear path for simplification, leading to a determinate leading-order solution.\n*   **Objective**: The problem is stated in precise, objective, and quantitative terms. All definitions, such as the sign conventions for the normal vector and curvature, are explicitly provided, leaving no room for ambiguity.\n\nThe problem exhibits none of the specified flaws. It is not scientifically unsound, irrelevant, incomplete, unrealistic, ill-posed, or trivial. The setup is a canonical example used to study the effects of curvature on flame stability and dynamics.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution Derivation\n\nThe propagation of a premixed flame front can be described by relating the local propagation speed, $S_n$, to the planar laminar burning velocity, $S_L^0$, and the total stretch rate, $K$. For small stretch rates, this relationship is linear:\n$$\nS_n = S_L^0 - L_M K\n$$\nwhere $L_M$ is the Markstein length, which quantifies the sensitivity of the flame speed to stretch.\n\nThe total stretch rate $K$ experienced by the flame front is the sum of two components: the stretch due to the tangential strain rate of the flow, $a_t$, and the stretch due to the flame's own propagation along a curved path. For a two-dimensional front, this is expressed as:\n$$\nK = a_t + S_n \\kappa\n$$\nHere, $\\kappa$ is the local curvature of the front. The problem statement specifies that \"negligible tangential strain and flow-induced stretch\" can be assumed, which implies $a_t=0$. Therefore, the total stretch is solely due to curvature:\n$$\nK = S_n \\kappa\n$$\nSubstituting this expression for stretch back into the flame speed relation gives:\n$$\nS_n = S_L^0 - L_M (S_n \\kappa)\n$$\nThis is an implicit equation for the local propagation speed $S_n$. We can solve for $S_n$ algebraically:\n$$\nS_n + L_M S_n \\kappa = S_L^0\n$$\n$$\nS_n(1 + L_M \\kappa) = S_L^0\n$$\n$$\nS_n = \\frac{S_L^0}{1 + L_M \\kappa}\n$$\nThe problem states that the curvature is small, such that $|L_M\\,\\kappa|\\ll 1$. This condition allows us to simplify the expression for $S_n$ by performing a first-order Taylor series expansion of the term $(1 + L_M \\kappa)^{-1}$ around $L_M \\kappa = 0$. The expansion is $(1+x)^{-1} \\approx 1-x$ for small $x$. Applying this approximation, we obtain the leading-order analytical expression for $S_n$:\n$$\nS_n \\approx S_L^0 (1 - L_M \\kappa)\n$$\nNow, we substitute the given spatial distribution of curvature, $\\kappa(s)$, into this expression. The curvature is given as:\n$$\n\\kappa(s)=\\kappa_0+\\kappa_1\\cos\\!\\left(\\frac{2\\pi s}{\\ell}\\right)\n$$\nSubstituting this into the expression for $S_n(s)$ yields the desired spatial distribution of the normal propagation speed:\n$$\nS_n(s) = S_L^0 \\left( 1 - L_M \\left( \\kappa_0 + \\kappa_1 \\cos\\left(\\frac{2\\pi s}{\\ell}\\right) \\right) \\right)\n$$\nThis expression gives the local flame speed at any point $s$ along the front.\n\nNext, we identify the location most susceptible to local quenching and the corresponding criterion. Local quenching occurs when the burning velocity $S_n$ drops to zero. The flame is most susceptible to quenching at the location where $S_n(s)$ is at its minimum value. To find the minimum of $S_n(s)$, we need to analyze the term involving $\\cos\\left(\\frac{2\\pi s}{\\ell}\\right)$. Since $S_L^0  0$, $L_M  0$, and $\\kappa_1  0$, the minimum value of $S_n(s)$ will occur when the term $-S_L^0 L_M \\kappa_1 \\cos\\left(\\frac{2\\pi s}{\\ell}\\right)$ is most negative. This happens when $\\cos\\left(\\frac{2\\pi s}{\\ell}\\right)$ reaches its maximum value, which is $+1$.\nThe condition $\\cos\\left(\\frac{2\\pi s}{\\ell}\\right) = 1$ is met when $\\frac{2\\pi s}{\\ell} = 2k\\pi$ for any integer $k$. For the specified domain $s \\in [0, \\ell]$, this occurs at $s=0$ and $s=\\ell$. At these points, the curvature is at its maximum positive value:\n$$\n\\kappa_{max} = \\kappa(0) = \\kappa(\\ell) = \\kappa_0 + \\kappa_1\n$$\nPhysically, these are the points where the flame is most convex toward the unburned reactants. For a mixture with $L_M  0$ (corresponding to a Lewis number greater than one), these convex tips burn slower and are thus the most likely locations for quenching.\n\nThe minimum propagation speed along the front is:\n$$\nS_{n, \\text{min}} = S_n(0) = S_n(\\ell) = S_L^0 (1 - L_M(\\kappa_0 + \\kappa_1))\n$$\nThe onset of local quenching corresponds to the condition where this minimum speed becomes zero or negative, i.e., $S_{n, \\text{min}} \\le 0$. Since $S_L^0  0$, this requires:\n$$\n1 - L_M(\\kappa_0 + \\kappa_1) \\le 0\n$$\nRearranging this inequality gives the parametric criterion for the onset of local quenching:\n$$\nL_M(\\kappa_0 + \\kappa_1) \\ge 1\n$$\nQuenching begins when the equality is met. The problem asks for the expression for $S_n(s)$ as the final answer.\nThe derived expression is:\n$$\nS_n(s) = S_L^0 \\left( 1 - L_M \\kappa_0 - L_M \\kappa_1 \\cos\\left(\\frac{2\\pi s}{\\ell}\\right) \\right)\n$$\nThis is the required leading-order analytical expression for the spatial distribution of the normal propagation speed.",
            "answer": "$$\n\\boxed{S_L^0 \\left( 1 - L_M \\left( \\kappa_0 + \\kappa_1 \\cos\\left(\\frac{2\\pi s}{\\ell}\\right) \\right) \\right)}\n$$"
        },
        {
            "introduction": "Moving from theory to simulation requires translating the continuous G-equation into a discrete numerical algorithm, a step where subtle errors can arise. The computation of geometric quantities like the normal vector and curvature is particularly sensitive to the choice of finite difference scheme and grid structure. This hands-on coding practice  guides you through an analysis of these numerical errors, demonstrating how grid anisotropy can compromise accuracy and why careful implementation is critical for reliable flame simulations.",
            "id": "4035843",
            "problem": "Consider a two-dimensional level-set representation of a premixed flame front. The front is modeled as a circle of radius $R$ centered at $(x_0,y_0)$, defined by the signed distance function $\\phi(x,y) = \\sqrt{(x-x_0)^2+(y-y_0)^2} - R$. In the Hamilton-Jacobi formulation of the Geometric Equation (G-equation) for premixed flames, the front normal $\\mathbf{n}$ and geometric curvature $\\kappa$ are fundamental quantities that enter the propagation law. For a level-set function $\\phi$, these quantities are defined by the core geometric identities\n$$\n\\mathbf{n} = \\frac{\\nabla \\phi}{\\lVert \\nabla \\phi \\rVert}, \\qquad \\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{\\lVert \\nabla \\phi \\rVert} \\right),\n$$\nand, equivalently at points of smoothness, by the Hessian-based formula\n$$\n\\kappa = \\frac{\\phi_{xx}\\,\\phi_y^2 - 2\\,\\phi_x\\,\\phi_y\\,\\phi_{xy} + \\phi_{yy}\\,\\phi_x^2}{\\left(\\phi_x^2+\\phi_y^2\\right)^{3/2}}.\n$$\nOn a Cartesian grid with spacings $dx$ and $dy$ that may be unequal (an anisotropic grid), these derivatives are approximated using finite difference stencils. Grid anisotropy can induce directional errors in the computed $\\mathbf{n}$ and $\\kappa$ even for a perfectly isotropic geometry like a circle.\n\nStarting from the above definitions, derive appropriate discrete approximations for $\\phi_x$, $\\phi_y$, $\\phi_{xx}$, $\\phi_{yy}$, and $\\phi_{xy}$ on anisotropic grids using:\n- A second-order central difference stencil, and\n- A fourth-order central difference stencil,\n\nboth of which must correctly account for unequal $dx$ and $dy$. For mixed derivatives, construct $\\phi_{xy}$ by sequentially applying the chosen-order derivative operators first in $x$ and then in $y$.\n\nImplement a program that, for each grid, computes:\n1. The unit normal $\\mathbf{n}$ and its orientation error with respect to the exact outward radial normal $\\mathbf{n}_{\\mathrm{exact}} = \\left( \\frac{x-x_0}{\\sqrt{(x-x_0)^2+(y-y_0)^2}}, \\frac{y-y_0}{\\sqrt{(x-x_0)^2+(y-y_0)^2}} \\right)$, measured as the angle difference in radians,\n2. The curvature $\\kappa$ using the Hessian formula above and its absolute error with respect to the exact interface curvature $1/R$.\n\nRestrict error computations to a narrow band of grid nodes satisfying $|\\phi| \\le \\frac{1}{2}\\min(dx,dy)$ and to nodes where the stencils are valid (i.e., interior nodes with sufficient neighbors for the chosen stencil). Aggregate the errors in the band using root-mean-square (RMS) norms.\n\nUse the following scientifically consistent parameters:\n- Domain: $[0,L_x]\\times[0,L_y]$ with $L_x = L_y = 0.2$ meters,\n- Circle center: $(x_0,y_0) = (0.1,0.1)$ meters,\n- Circle radius: $R = 0.05$ meters.\n\nEvaluate the following test suite of grids to probe anisotropy effects:\n- Case 1 (isotropic baseline): $(N_x,N_y) = (257,257)$,\n- Case 2 (anisotropic, refined in $x$): $(N_x,N_y) = (513,257)$,\n- Case 3 (anisotropic, refined in $y$): $(N_x,N_y) = (257,513)$,\n- Case 4 (strong anisotropy, $x$ much finer): $(N_x,N_y) = (1025,129)$,\n- Case 5 (strong anisotropy, $y$ much finer): $(N_x,N_y) = (129,1025)$.\n\nFor each case, compute and report four quantities:\n- RMS normal orientation error in radians using the second-order stencil,\n- RMS normal orientation error in radians using the fourth-order stencil,\n- RMS curvature error in $1/\\mathrm{m}$ using the second-order stencil,\n- RMS curvature error in $1/\\mathrm{m}$ using the fourth-order stencil.\n\nFinal output format requirement:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the above four quantities in order for Case 1, then for Case 2, and so on, resulting in a list of $20$ floats. Angles must be expressed in radians. Curvature errors must be expressed in inverse meters ($1/\\mathrm{m}$). For example, an output format of the form\n$[e_{1,\\mathrm{angle},2}, e_{1,\\mathrm{angle},4}, e_{1,\\kappa,2}, e_{1,\\kappa,4}, e_{2,\\mathrm{angle},2}, \\dots, e_{5,\\kappa,4}]$\nwhere the subscripts indicate case number, quantity, and stencil order is required.",
            "solution": "The posed problem is valid as it is scientifically grounded in the principles of computational combustion, mathematically well-posed, objective, and self-contained. It presents a standard numerical analysis task involving the level-set method and finite difference approximations on anisotropic grids. We will proceed with a full solution.\n\nThe core of this problem is to evaluate the accuracy of finite difference approximations for geometric quantities (normal vector $\\mathbf{n}$ and curvature $\\kappa$) derived from a level-set function $\\phi$. The analysis is performed on a simple, known geometry—a circle—for which exact analytical values of $\\mathbf{n}$ and $\\kappa$ are available, allowing for a precise quantification of numerical errors. The use of anisotropic grids ($dx \\neq dy$) is a key element, as it often degrades the accuracy of numerical schemes designed for isotropic grids.\n\nThe level-set function for a circle of radius $R$ centered at $(x_0, y_0)$ is given as the signed distance function:\n$$ \\phi(x,y) = \\sqrt{(x-x_0)^2 + (y-y_0)^2} - R $$\nThe interface is the zero-contour, $\\phi(x,y) = 0$. The fundamental geometric quantities are computed from the partial derivatives of $\\phi$.\n\nThe exact outward unit normal vector $\\mathbf{n}_{\\mathrm{exact}}$ at a point $(x,y)$ on the circle is directed radially from the center $(x_0,y_0)$:\n$$ \\mathbf{n}_{\\mathrm{exact}}(x,y) = \\frac{(x-x_0, y-y_0)}{\\sqrt{(x-x_0)^2 + (y-y_0)^2}} $$\nThe exact curvature $\\kappa_{\\mathrm{exact}}$ of a circle is the reciprocal of its radius:\n$$ \\kappa_{\\mathrm{exact}} = \\frac{1}{R} $$\n\nNumerically, we first compute the partial derivatives of $\\phi$ on a discrete grid, then use these to compute approximations of $\\mathbf{n}$ and $\\kappa$. The problem requires the derivation and implementation of second-order and fourth-order accurate central difference stencils on an anisotropic Cartesian grid with spacings $dx$ and $dy$.\n\nLet $\\phi_{i,j} = \\phi(i \\cdot dx, j \\cdot dy)$ be the value of the level-set function at grid node $(i,j)$.\n\n**1. Second-Order Finite Difference Stencils**\n\nBased on Taylor series expansions, the standard second-order central difference approximations for the first and second partial derivatives on an anisotropic grid are:\n- First derivatives ($O(dx^2), O(dy^2)$):\n$$ (\\phi_x)_{i,j} = \\frac{\\partial\\phi}{\\partial x}\\bigg|_{i,j} \\approx \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\,dx} $$\n$$ (\\phi_y)_{i,j} = \\frac{\\partial\\phi}{\\partial y}\\bigg|_{i,j} \\approx \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\,dy} $$\n- Second derivatives ($O(dx^2), O(dy^2)$):\n$$ (\\phi_{xx})_{i,j} = \\frac{\\partial^2\\phi}{\\partial x^2}\\bigg|_{i,j} \\approx \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{dx^2} $$\n$$ (\\phi_{yy})_{i,j} = \\frac{\\partial^2\\phi}{\\partial y^2}\\bigg|_{i,j} \\approx \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{dy^2} $$\n- Mixed second derivative ($O(dx^2, dy^2)$), computed by sequential application of first-derivative operators (e.g., $\\frac{\\partial}{\\partial y}(\\frac{\\partial \\phi}{\\partial x})$):\n$$ (\\phi_{xy})_{i,j} = \\frac{\\partial^2\\phi}{\\partial x \\partial y}\\bigg|_{i,j} \\approx \\frac{1}{2\\,dy} \\left[ \\frac{\\phi_{i+1,j+1} - \\phi_{i-1,j+1}}{2\\,dx} - \\frac{\\phi_{i+1,j-1} - \\phi_{i-1,j-1}}{2\\,dx} \\right] $$\n$$ (\\phi_{xy})_{i,j} \\approx \\frac{\\phi_{i+1,j+1} - \\phi_{i-1,j+1} - \\phi_{i+1,j-1} + \\phi_{i-1,j-1}}{4\\,dx\\,dy} $$\n\n**2. Fourth-Order Finite Difference Stencils**\n\nHigher-order stencils provide greater accuracy for smooth functions at the cost of a wider stencil, requiring more neighboring points. The fourth-order central difference stencils are:\n- First derivatives ($O(dx^4), O(dy^4)$):\n$$ (\\phi_x)_{i,j} \\approx \\frac{-\\phi_{i+2,j} + 8\\phi_{i+1,j} - 8\\phi_{i-1,j} + \\phi_{i-2,j}}{12\\,dx} $$\n$$ (\\phi_y)_{i,j} \\approx \\frac{-\\phi_{i,j+2} + 8\\phi_{i,j+1} - 8\\phi_{i,j-1} + \\phi_{i,j-2}}{12\\,dy} $$\n- Second derivatives ($O(dx^4), O(dy^4)$):\n$$ (\\phi_{xx})_{i,j} \\approx \\frac{-\\phi_{i+2,j} + 16\\phi_{i+1,j} - 30\\phi_{i,j} + 16\\phi_{i-1,j} - \\phi_{i-2,j}}{12\\,dx^2} $$\n$$ (\\phi_{yy})_{i,j} \\approx \\frac{-\\phi_{i,j+2} + 16\\phi_{i,j+1} - 30\\phi_{i,j} + 16\\phi_{i,j-1} - \\phi_{i,j-2}}{12\\,dy^2} $$\n- Mixed second derivative ($O(dx^4, dy^4)$), again computed by sequential application (e.g., $\\frac{\\partial}{\\partial y}(\\frac{\\partial \\phi}{\\partial x})$ using fourth-order stencils):\n$$ (\\phi_{xy})_{i,j} \\approx \\frac{1}{12\\,dy} \\left[ (\\phi_x)_{i,j+2}(-1) + (\\phi_x)_{i,j+1}(8) - (\\phi_x)_{i,j-1}(8) + (\\phi_x)_{i,j-2}(1) \\right] $$\nwhere each $(\\phi_x)$ term is evaluated using the fourth-order stencil for the $x$-derivative. This results in a $5 \\times 5$ stencil for $\\phi_{xy}$.\n\n**3. Numerical Evaluation Procedure**\nFor each test case grid and for each order of accuracy (2nd and 4th), the following steps are performed:\n1.  **Grid and Field Generation**: An $N_x \\times N_y$ grid is created over the domain $[0, L_x] \\times [0, L_y]$. The grid spacings are $dx = L_x / (N_x - 1)$ and $dy = L_y / (N_y - 1)$. The exact signed distance function $\\phi$ is evaluated at each grid node.\n2.  **Derivative Calculation**: The partial derivatives $\\phi_x, \\phi_y, \\phi_{xx}, \\phi_{yy}, \\phi_{xy}$ are computed over the entire grid using the appropriate-order stencils.\n3.  **Geometric Quantity Calculation**: The numerical normal vector $\\mathbf{n}$ and curvature $\\kappa$ are computed at each grid node using the provided formulas:\n    $$ \\mathbf{n} = \\frac{(\\phi_x, \\phi_y)}{\\sqrt{\\phi_x^2 + \\phi_y^2}}, \\qquad \\kappa = \\frac{\\phi_{xx}\\,\\phi_y^2 - 2\\,\\phi_x\\,\\phi_y\\,\\phi_{xy} + \\phi_{yy}\\,\\phi_x^2}{(\\phi_x^2+\\phi_y^2)^{3/2}} $$\n    A small epsilon is added to the denominators to prevent division by zero.\n4.  **Error Analysis Domain**: The errors are analyzed only for a subset of grid nodes. We define a mask that selects nodes satisfying two conditions:\n    a.  **Narrow Band**: Nodes must be close to the true interface, $|\\phi| \\le \\frac{1}{2}\\min(dx,dy)$.\n    b.  **Interior Nodes**: Nodes must have sufficient neighbors for the stencil to be valid. For a second-order stencil, this means excluding a $1$-cell boundary layer. For a fourth-order stencil, a $2$-cell boundary layer is excluded.\n5.  **Error Calculation**:\n    a.  **Normal Orientation Error**: The error is the angle (in radians) between the numerical normal $\\mathbf{n}$ and the exact normal $\\mathbf{n}_{\\mathrm{exact}}$. This is computed via $\\theta = \\arccos(\\mathbf{n} \\cdot \\mathbf{n}_{\\mathrm{exact}})$.\n    b.  **Curvature Error**: The error is the difference between the numerical curvature $\\kappa$ and the exact curvature $\\kappa_{\\mathrm{exact}} = 1/R$.\n6.  **Error Aggregation**: The root-mean-square (RMS) of each error type is computed over all nodes selected by the mask. For an error field $e$, the RMS error is $\\sqrt{\\langle e^2 \\rangle}$.\n\nThis systematic procedure allows for a direct comparison of the impact of stencil order and grid anisotropy on the accuracy of geometric quantities crucial for flame simulations.",
            "answer": "```python\nimport numpy as np\n\ndef compute_derivatives(phi, dx, dy, order):\n    \"\"\"\n    Computes partial derivatives of a 2D field using finite differences.\n    NOTE: Assumes 'ij' indexing for phi, where axis 0 is x and axis 1 is y.\n    \"\"\"\n    if order == 2:\n        # First derivatives (2nd-order central)\n        phi_x = (np.roll(phi, -1, axis=0) - np.roll(phi, 1, axis=0)) / (2 * dx)\n        phi_y = (np.roll(phi, -1, axis=1) - np.roll(phi, 1, axis=1)) / (2 * dy)\n        \n        # Second derivatives (2nd-order central)\n        phi_xx = (np.roll(phi, -1, axis=0) - 2 * phi + np.roll(phi, 1, axis=0)) / (dx**2)\n        phi_yy = (np.roll(phi, -1, axis=1) - 2 * phi + np.roll(phi, 1, axis=1)) / (dy**2)\n        \n        # Mixed derivative by sequential application\n        phi_xy = (np.roll(phi_x, -1, axis=1) - np.roll(phi_x, 1, axis=1)) / (2 * dy)\n\n    elif order == 4:\n        # First derivatives (4th-order central)\n        phi_x = (-np.roll(phi, -2, axis=0) + 8 * np.roll(phi, -1, axis=0) - 8 * np.roll(phi, 1, axis=0) + np.roll(phi, 2, axis=0)) / (12 * dx)\n        phi_y = (-np.roll(phi, -2, axis=1) + 8 * np.roll(phi, -1, axis=1) - 8 * np.roll(phi, 1, axis=1) + np.roll(phi, 2, axis=1)) / (12 * dy)\n        \n        # Second derivatives (4th-order central)\n        phi_xx = (-np.roll(phi, -2, axis=0) + 16 * np.roll(phi, -1, axis=0) - 30 * phi + 16 * np.roll(phi, 1, axis=0) - np.roll(phi, 2, axis=0)) / (12 * dx**2)\n        phi_yy = (-np.roll(phi, -2, axis=1) + 16 * np.roll(phi, -1, axis=1) - 30 * phi + 16 * np.roll(phi, 1, axis=1) - np.roll(phi, 2, axis=1)) / (12 * dy**2)\n\n        # Mixed derivative by sequential application\n        phi_xy = (-np.roll(phi_x, -2, axis=1) + 8 * np.roll(phi_x, -1, axis=1) - 8 * np.roll(phi_x, 1, axis=1) + np.roll(phi_x, 2, axis=1)) / (12 * dy)\n    else:\n        raise ValueError(\"Order must be 2 or 4\")\n        \n    return phi_x, phi_y, phi_xx, phi_yy, phi_xy\n\ndef compute_metrics_for_case(case_params, constants):\n    \"\"\"\n    Computes the four required error metrics for a single grid configuration.\n    \"\"\"\n    Nx, Ny = case_params\n    Lx, Ly, x0, y0, R = constants.values()\n\n    # Grid setup\n    dx = Lx / (Nx - 1)\n    dy = Ly / (Ny - 1)\n    x = np.linspace(0, Lx, Nx)\n    y = np.linspace(0, Ly, Ny)\n    # Use 'ij' indexing so that the first axis (0) corresponds to x\n    # and the second axis (1) corresponds to y.\n    X, Y = np.meshgrid(x, y, indexing='ij')\n\n    # Level-set field\n    phi = np.sqrt((X - x0)**2 + (Y - y0)**2) - R\n    \n    errors = {}\n\n    for order in [2, 4]:\n        # Compute derivatives\n        phi_x, phi_y, phi_xx, phi_yy, phi_xy = compute_derivatives(phi, dx, dy, order)\n        \n        # Define masks\n        # Interior mask to exclude boundaries where stencils are invalid\n        interior_mask = np.zeros_like(phi, dtype=bool)\n        stencil_width = order // 2 # 1 for 2nd order, 2 for 4th order\n        interior_mask[stencil_width:Nx-stencil_width, stencil_width:Ny-stencil_width] = True\n        \n        # Narrow band mask\n        band_width = 0.5 * min(dx, dy)\n        band_mask = np.abs(phi) = band_width\n        \n        # Final mask for analysis\n        mask = interior_mask  band_mask\n\n        # Numerical normal and curvature\n        grad_phi_norm_sq = phi_x**2 + phi_y**2\n        \n        epsilon = 1e-15\n        grad_phi_norm = np.sqrt(grad_phi_norm_sq + epsilon)\n        \n        nx = phi_x / grad_phi_norm\n        ny = phi_y / grad_phi_norm\n        \n        kappa_num = (phi_xx * phi_y**2 - 2 * phi_x * phi_y * phi_xy + phi_yy * phi_x**2)\n        kappa_den = (grad_phi_norm_sq)**(1.5)\n        kappa = kappa_num / (kappa_den + epsilon)\n\n        # Exact quantities\n        r = np.sqrt((X - x0)**2 + (Y - y0)**2)\n        r_safe = np.where(r == 0, epsilon, r)\n        nx_exact = (X - x0) / r_safe\n        ny_exact = (Y - y0) / r_safe\n        kappa_exact = 1.0 / R\n\n        # Compute errors\n        # Normal vector orientation error\n        dot_product = np.clip(nx * nx_exact + ny * ny_exact, -1.0, 1.0)\n        angle_error = np.arccos(dot_product)\n        \n        # Curvature error\n        curvature_error = np.abs(kappa - kappa_exact)\n        \n        # RMS errors over the masked region\n        rms_angle_error = np.sqrt(np.mean(angle_error[mask]**2))\n        rms_kappa_error = np.sqrt(np.mean(curvature_error[mask]**2))\n        \n        errors[f'angle_{order}'] = rms_angle_error\n        errors[f'kappa_{order}'] = rms_kappa_error\n        \n    return [errors['angle_2'], errors['angle_4'], errors['kappa_2'], errors['kappa_4']]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define constants\n    constants = {\n        'Lx': 0.2, 'Ly': 0.2,\n        'x0': 0.1, 'y0': 0.1,\n        'R': 0.05\n    }\n    \n    # Define test cases from the problem statement\n    test_cases = [\n        (257, 257),   # Case 1: Isotropic baseline\n        (513, 257),   # Case 2: Anisotropic, refined in x\n        (257, 513),   # Case 3: Anisotropic, refined in y\n        (1025, 129),  # Case 4: Strong anisotropy, x much finer\n        (129, 1025)   # Case 5: Strong anisotropy, y much finer\n    ]\n    \n    results = []\n    for case in test_cases:\n        case_results = compute_metrics_for_case(case, constants)\n        results.extend(case_results)\n        \n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}