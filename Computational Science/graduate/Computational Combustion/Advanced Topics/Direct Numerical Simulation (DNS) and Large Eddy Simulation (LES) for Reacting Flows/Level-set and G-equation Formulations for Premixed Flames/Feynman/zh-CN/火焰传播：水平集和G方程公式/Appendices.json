{
    "hands_on_practices": [
        {
            "introduction": "本次动手实践旨在为$G$方程理论奠定坚实的数学基础。通过采用特征线法求解最简形式的$G$方程，你将分析一个平面火焰在静止流场中的传播过程。这个练习将帮助你理解水平集方法如何精确地描述一个以恒定法向速度运动的锋面，并掌握求解哈密顿-雅可比型偏微分方程的基本技巧。",
            "id": "4035876",
            "problem": "考虑一个由水平集函数 $G(\\mathbf{x},t)$ 表示的预混火焰锋面，其中锋面是零水平集 $G(\\mathbf{x},t)=0$。在水平集方法中，对于静止流场中以恒定法向传播速度 $S_L$ 运动的锋面，$G$ 的演化由偏微分方程 (PDE) $G_t = S_L |\\nabla G|$ 给出。这是一个哈密顿-雅可比 (HJ) 型偏微分方程，由锋面沿其法线方向以速度 $S_L$ 移动的运动学定律推导得出。假设空间维度 $d \\geq 2$，初始条件为平面 $G(\\mathbf{x},0) = \\mathbf{n}\\cdot\\mathbf{x} - d_0$，其中 $\\mathbf{n} \\in \\mathbb{R}^d$ 是满足 $|\\mathbf{n}|=1$ 的单位法向量，$d_0 \\in \\mathbb{R}$ 是一个常数。\n\n从具有恒定法向速度的水平集锋面的基本定义出发，建立相关的哈密顿-雅可比特征系统，并针对给定的平面初始数据求解该偏微分方程 $G_t = S_L |\\nabla G|$。使用第一性原理，证明零水平集保持为平面且平移时形状不变，并确定对所有 $\\mathbf{x} \\in \\mathbb{R}^d$ 和 $t \\geq 0$ 均成立的 $G(\\mathbf{x},t)$ 的显式闭式表达式。\n\n以 $G(\\mathbf{x},t)$ 的单个解析表达式的形式给出你的最终答案。",
            "solution": "该问题要求解水平集函数 $G(\\mathbf{x},t)$ 的偏微分方程 (PDE) $G_t = S_L |\\nabla G|$，其初始条件为平面 $G(\\mathbf{x},0) = \\mathbf{n}\\cdot\\mathbf{x} - d_0$。此处，$S_L$ 是一个常数，$\\mathbf{n}$ 是一个单位向量，即 $|\\mathbf{n}|=1$。这是一个哈密顿-雅可比型的一阶非线性偏微分方程。我们将使用特征线法来求解它。\n\n首先，我们将该 PDE 重写为标准的哈密顿-雅可比形式 $G_t + H(\\nabla G) = 0$。通过与给定方程进行比较，我们将哈密顿量 $H$ 确定为梯度向量 $\\mathbf{p} = \\nabla G$ 的函数：\n$$H(\\mathbf{p}) = -S_L |\\mathbf{p}|$$\n特征线法将此偏微分方程转换为一个常微分方程组 (ODEs)，这些方程描述了称为特征线的曲线，沿着这些曲线可以构建解。这些常微分方程描述了沿着一条由时间 $t$ 参数化的特征曲线上，位置 $\\mathbf{x}(t)$、梯度 $\\mathbf{p}(t) = \\nabla G(\\mathbf{x}(t),t)$ 和函数值 $G(t) = G(\\mathbf{x}(t),t)$ 的演化。\n\n对于一个哈密顿量 $H(\\mathbf{x}, \\mathbf{p}, t)$，其特征方程为：\n$$ \\frac{d\\mathbf{x}}{dt} = \\nabla_{\\mathbf{p}} H, \\quad \\frac{d\\mathbf{p}}{dt} = -\\nabla_{\\mathbf{x}} H, \\quad \\frac{dG}{dt} = G_t + \\nabla G \\cdot \\frac{d\\mathbf{x}}{dt} = -H + \\mathbf{p} \\cdot \\nabla_{\\mathbf{p}} H $$\n在我们的问题中，哈密顿量 $H(\\mathbf{p}) = -S_L |\\mathbf{p}| = -S_L \\sqrt{\\mathbf{p}\\cdot\\mathbf{p}}$ 仅依赖于 $\\mathbf{p}$，而与 $\\mathbf{x}$ 或 $t$ 无显式关系。\n\n我们来计算 $H$ 的必要导数：\n1. $H$ 相对于 $\\mathbf{p}$ 的梯度：\n$$ \\nabla_{\\mathbf{p}} H = \\nabla_{\\mathbf{p}} (-S_L |\\mathbf{p}|) = -S_L \\frac{\\mathbf{p}}{|\\mathbf{p}|} $$\n2. $H$ 相对于 $\\mathbf{x}$ 的梯度：\n由于 $H$ 不显式依赖于 $\\mathbf{x}$，\n$$ \\nabla_{\\mathbf{x}} H = \\mathbf{0} $$\n\n将这些导数代入特征方程，我们得到适用于此问题的特定常微分方程组：\n$$ (1) \\quad \\frac{d\\mathbf{x}}{dt} = -S_L \\frac{\\mathbf{p}}{|\\mathbf{p}|} $$\n$$ (2) \\quad \\frac{d\\mathbf{p}}{dt} = \\mathbf{0} $$\n$$ (3) \\quad \\frac{dG}{dt} = -H(\\mathbf{p}) + \\mathbf{p} \\cdot \\nabla_{\\mathbf{p}} H = -(-S_L |\\mathbf{p}|) + \\mathbf{p} \\cdot \\left(-S_L \\frac{\\mathbf{p}}{|\\mathbf{p}|}\\right) = S_L |\\mathbf{p}| - S_L \\frac{|\\mathbf{p}|^2}{|\\mathbf{p}|} = S_L |\\mathbf{p}| - S_L |\\mathbf{p}| = 0 $$\n\n为求解此系统，我们需要初始条件。我们考虑一条在时间 $t=0$ 从空间中任意点 $\\mathbf{x}_0$ 出发的特征曲线。初始条件为：\n- 位置：$\\mathbf{x}(0) = \\mathbf{x}_0$。\n- $G$ 的值：$G(0) = G(\\mathbf{x}_0, 0) = \\mathbf{n} \\cdot \\mathbf{x}_0 - d_0$。\n- 梯度：$\\mathbf{p}(0) = \\nabla G(\\mathbf{x},0)|_{\\mathbf{x}=\\mathbf{x}_0}$。根据初始条件 $G(\\mathbf{x},0) = \\mathbf{n}\\cdot\\mathbf{x} - d_0$，我们计算梯度为：$\\mathbf{p}(0) = \\nabla_{\\mathbf{x}} (\\mathbf{n}\\cdot\\mathbf{x} - d_0) = \\mathbf{n}$。\n\n现在我们可以求解这些常微分方程了：\n根据方程 $(2)$, $\\frac{d\\mathbf{p}}{dt} = \\mathbf{0}$，结合初始条件 $\\mathbf{p}(0) = \\mathbf{n}$，我们发现梯度在每条特征线上都是恒定的：\n$$ \\mathbf{p}(t) = \\mathbf{n} $$\n这个结果非常重要；它意味着梯度向量在我们沿着特征曲线移动时不会改变。\n\n接下来，我们使用方程 $(1)$ 求解位置 $\\mathbf{x}(t)$。代入 $\\mathbf{p}(t) = \\mathbf{n}$ 并利用已知事实 $|\\mathbf{n}|=1$：\n$$ \\frac{d\\mathbf{x}}{dt} = -S_L \\frac{\\mathbf{n}}{|\\mathbf{n}|} = -S_L \\mathbf{n} $$\n这是一个关于 $\\mathbf{x}(t)$ 的简单常微分方程。在初始条件 $\\mathbf{x}(0) = \\mathbf{x}_0$ 下，对时间从 $0$ 积分到 $t$：\n$$ \\mathbf{x}(t) - \\mathbf{x}(0) = \\int_0^t (-S_L \\mathbf{n}) d\\tau = -S_L \\mathbf{n} t $$\n$$ \\mathbf{x}(t) = \\mathbf{x}_0 - S_L \\mathbf{n} t $$\n这个方程描述了特征线上一点的轨迹，表明该点以恒定速度 $-S_L \\mathbf{n}$ 移动。\n\n最后，我们使用方程 $(3)$ 求解 $G(t)$：\n$$ \\frac{dG}{dt} = 0 $$\n这意味着 $G$ 在任何一条特征曲线上都是常数。因此，它在任意时刻 $t$ 的值都与其在 $t=0$ 时的初始值相同：\n$$ G(\\mathbf{x}(t), t) = G(\\mathbf{x}_0, 0) = \\mathbf{n} \\cdot \\mathbf{x}_0 - d_0 $$\n\n现在我们已经找到了沿特征曲线的解 $G$。为了获得对任意点 $(\\mathbf{x}, t)$ 的通解 $G(\\mathbf{x},t)$，我们必须用 $\\mathbf{x}$ 和 $t$ 来表示它，而不是用初始点 $\\mathbf{x}_0$。从 $\\mathbf{x}(t)$ 的解中，我们可以用稍后时间 $t$ 的位置 $\\mathbf{x}$ 来表示初始位置 $\\mathbf{x}_0$：\n$$ \\mathbf{x}_0 = \\mathbf{x} + S_L \\mathbf{n} t $$\n将这个 $\\mathbf{x}_0$ 的表达式代入 $G$ 的方程中：\n$$ G(\\mathbf{x}, t) = \\mathbf{n} \\cdot (\\mathbf{x} + S_L \\mathbf{n} t) - d_0 $$\n展开点积：\n$$ G(\\mathbf{x}, t) = \\mathbf{n} \\cdot \\mathbf{x} + S_L (\\mathbf{n} \\cdot \\mathbf{n}) t - d_0 $$\n由于 $\\mathbf{n}$ 是单位向量，$\\mathbf{n} \\cdot \\mathbf{n} = |\\mathbf{n}|^2 = 1^2 = 1$。这导出了该解的最终闭式表达式：\n$$ G(\\mathbf{x}, t) = \\mathbf{n} \\cdot \\mathbf{x} + S_L t - d_0 $$\n\n让我们验证这个解。\n- 初始条件：在 $t=0$ 时，$G(\\mathbf{x},0) = \\mathbf{n} \\cdot \\mathbf{x} - d_0$，正确。\n- PDE：$G_t = \\frac{\\partial}{\\partial t}(\\mathbf{n} \\cdot \\mathbf{x} + S_L t - d_0) = S_L$。梯度为 $\\nabla G = \\nabla_{\\mathbf{x}}(\\mathbf{n} \\cdot \\mathbf{x} + S_L t - d_0) = \\mathbf{n}$。那么 $|\\nabla G| = |\\mathbf{n}| = 1$。PDE 的右侧是 $S_L |\\nabla G| = S_L(1) = S_L$。由于 $G_t = S_L$，PDE $G_t = S_L |\\nabla G|$ 成立。\n\n最后，我们考察代表火焰锋面的零水平集的演化。该锋面由条件 $G(\\mathbf{x},t) = 0$ 定义。\n$$ \\mathbf{n} \\cdot \\mathbf{x} + S_L t - d_0 = 0 $$\n$$ \\mathbf{n} \\cdot \\mathbf{x} = d_0 - S_L t $$\n对于任意固定的时间 $t$，这是 $\\mathbb{R}^d$ 中一个法向量为常数 $\\mathbf{n}$ 的超平面的方程。这证明了火焰锋面对所有 $t \\geq 0$ 都保持为平面。$t=0$ 时的初始鋒面是 $\\mathbf{n} \\cdot \\mathbf{x} = d_0$。在时间 $t$ 的锋面具有相同的法向量，意味着它平移而没有旋转或形状改变。该平面沿方向 $\\mathbf{n}$ 距原点的有向距离是 $D(t) = d_0 - S_L t$。锋面的速度由其位置向量的时间导数给出，该位置向量可表示为 $D(t)\\mathbf{n}$。速度为 $\\frac{d}{dt}(D(t)\\mathbf{n}) = \\frac{d}{dt}((d_0 - S_L t)\\mathbf{n}) = -S_L \\mathbf{n}$。锋面的速率是该速度的大小，即 $|-S_L \\mathbf{n}| = S_L|\\mathbf{n}| = S_L$。因此，平面锋面以恒定速率 $S_L$ 在其法向量 $\\mathbf{n}$ 的相反方向上平移。\n$G(\\mathbf{x},t)$ 的显式闭式表达式提供了完整的解。",
            "answer": "$$\n\\boxed{G(\\mathbf{x},t) = \\mathbf{n} \\cdot \\mathbf{x} + S_L t - d_0}\n$$"
        },
        {
            "introduction": "在掌握了基本的瞬态传播问题后，我们转向一个更具实际意义的稳态问题。本练习探讨了$G$方程在其稳态形式（即Eikonal方程）下，如何描述一个稳定在均匀来流中的预混火焰。通过求解这个问题，你将推导出经典的火焰角概念，从而将抽象的数学框架与火焰稳定这一具体的物理现象联系起来。",
            "id": "4035858",
            "problem": "考虑一个由水平集函数 $G(x,y)$ 表示的二维稳态预混火焰，其零水平集 $G=0$ 与火焰锋面重合。稳态下的 G 方程可简化为 Eikonal 形式\n$$\n\\mathbf{u}\\cdot\\nabla G \\;=\\; S_L\\,\\lvert \\nabla G\\rvert,\n$$\n其中 $\\mathbf{u}=(U,0)$ 是一个均匀入口速度（$U0$），$S_L0$ 是混合物的恒定层流燃烧速度。定义域为半平面 $y\\ge 0$，沿直线 $y=0$ 的边界条件为\n$$\nG(x,0)=x.\n$$\n假设 $U\\ge S_L$，以便可能存在稳态附着火焰。在给定边界条件下，求解稳态 Eikonal 方程。然后，将火焰角 $\\alpha$ 定义为单位法向量 $\\mathbf{n}=\\nabla G/\\lvert \\nabla G\\rvert$（指向 G 增大的方向）与 x 轴正方向之间的夹角（单位为弧度）。请用 $U$ 和 $S_L$ 表示 $\\alpha$，并将 $\\alpha$（单位为弧度）作为最终答案。如果出现多个分支，请选择 $\\partial G/\\partial y0$ 的分支。",
            "solution": "用户要求我基于预混火焰的稳态 G 方程求解火焰角 alpha。\n\n### 步骤 1：提取已知条件\n-   **控制方程**：水平集函数 $G(x,y)$ 的稳态 Eikonal 方程为 $\\mathbf{u}\\cdot\\nabla G \\;=\\; S_L\\,\\lvert \\nabla G\\rvert$。\n-   **速度场**：$\\mathbf{u}=(U,0)$，其中 $U0$。\n-   **层流燃烧速度**：$S_L  0$，恒定。\n-   **定义域**：半平面 $y\\ge 0$。\n-   **边界条件**：沿直线 $y=0$ 有 $G(x,0)=x$。\n-   **约束条件**：$U\\ge S_L$。\n-   **火焰角定义**：$\\alpha$ 是单位法向量 $\\mathbf{n}=\\nabla G/\\lvert \\nabla G\\rvert$ 与 x 轴正方向之间的夹角。\n-   **分支选择**：必须选择 $\\partial G/\\partial y0$ 的解分支。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于用于模拟预混燃烧的成熟的水平集方法。G 方程是一个标准公式。该设置是稳定在持焰器（此处由直线 $y=0$ 表示）上的 V 形火焰的典型表示。所有变量和常数都有明确定义。边界条件已指定，并且提供了约束条件（$U \\ge S_L$）以确保存在物理上真实的稳态解。分支选择准则确保了解的唯一性。该问题是自洽的、客观的且适定的。不存在科学、数学或逻辑上的缺陷。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解题推导\n控制偏微分方程是稳态 Eikonal 方程：\n$$\n\\mathbf{u}\\cdot\\nabla G = S_L \\lvert \\nabla G \\rvert\n$$\n在二维笛卡尔坐标系中，给定 $\\mathbf{u} = (U, 0)$ 和 $\\nabla G = (\\frac{\\partial G}{\\partial x}, \\frac{\\partial G}{\\partial y})$，方程变为：\n$$\n(U, 0) \\cdot \\left(\\frac{\\partial G}{\\partial x}, \\frac{\\partial G}{\\partial y}\\right) = S_L \\sqrt{\\left(\\frac{\\partial G}{\\partial x}\\right)^2 + \\left(\\frac{\\partial G}{\\partial y}\\right)^2}\n$$\n$$\nU \\frac{\\partial G}{\\partial x} = S_L \\sqrt{\\left(\\frac{\\partial G}{\\partial x}\\right)^2 + \\left(\\frac{\\partial G}{\\partial y}\\right)^2}\n$$\n鉴于均匀流和线性边界条件，我们寻求 $G(x,y)$ 的线性解，其形式为：\n$$\nG(x,y) = ax + by + c\n$$\n其中 $a$、$b$ 和 $c$ 是常数。\n应用边界条件 $G(x,0) = x$：\n$$\nG(x,0) = a(x) + b(0) + c = ax+c\n$$\n要使其对所有 $x$ 都等于 $x$，我们必须有 $a=1$ 和 $c=0$。解的形式简化为：\n$$\nG(x,y) = x + by\n$$\n现在，我们求这个假设解的偏导数：\n$$\n\\frac{\\partial G}{\\partial x} = 1\n$$\n$$\n\\frac{\\partial G}{\\partial y} = b\n$$\n将这些导数代入控制方程：\n$$\nU (1) = S_L \\sqrt{(1)^2 + (b)^2}\n$$\n$$\nU = S_L \\sqrt{1 + b^2}\n$$\n我们求解常数 $b$。由于 $U \\ge S_L  0$，我们可以对两边平方：\n$$\nU^2 = S_L^2 (1 + b^2)\n$$\n$$\n\\frac{U^2}{S_L^2} = 1 + b^2\n$$\n$$\nb^2 = \\left(\\frac{U}{S_L}\\right)^2 - 1\n$$\n这给出了 $b$ 的两个可能值：\n$$\nb = \\pm \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\n$$\n问题指定了分支选择准则：$\\partial G / \\partial y  0$。由于 $\\partial G / \\partial y = b$，我们必须选择正根：\n$$\nb = \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\n$$\n由于给定条件 $U \\ge S_L$，$b$ 的这个实数解存在。因此，水平集函数为：\n$$\nG(x,y) = x + y\\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\n$$\n火焰锋面由水平集 $G=0$ 定义。单位法向量 $\\mathbf{n}$ 指向 G 增大的方向，由 $\\mathbf{n} = \\nabla G / \\lvert\\nabla G\\rvert$ 给出。\n首先，我们计算梯度向量 $\\nabla G$：\n$$\n\\nabla G = \\left(\\frac{\\partial G}{\\partial x}, \\frac{\\partial G}{\\partial y}\\right) = (1, b) = \\left(1, \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\\right)\n$$\n接下来，我们计算其大小 $\\lvert\\nabla G\\rvert$：\n$$\n\\lvert\\nabla G\\rvert = \\sqrt{1^2 + b^2} = \\sqrt{1 + \\left(\\left(\\frac{U}{S_L}\\right)^2 - 1\\right)} = \\sqrt{\\left(\\frac{U}{S_L}\\right)^2} = \\frac{U}{S_L}\n$$\n这个结果从原方程中也直接可见：$U(1) = S_L \\lvert\\nabla G\\rvert \\implies \\lvert\\nabla G\\rvert = U/S_L$。\n单位法向量为：\n$$\n\\mathbf{n} = \\frac{\\nabla G}{\\lvert\\nabla G\\rvert} = \\frac{\\left(1, \\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\\right)}{U/S_L} = \\left(\\frac{S_L}{U}, \\frac{S_L}{U}\\sqrt{\\left(\\frac{U}{S_L}\\right)^2 - 1}\\right) = \\left(\\frac{S_L}{U}, \\sqrt{1 - \\left(\\frac{S_L}{U}\\right)^2}\\right)\n$$\n火焰角 $\\alpha$ 定义为单位法向量 $\\mathbf{n}$ 与由单位向量 $\\mathbf{e}_x = (1,0)$ 表示的 x 轴正方向之间的夹角。这个夹角的余弦值由两个单位向量的点积给出，也就是 $\\mathbf{n}$ 的 x 分量：\n$$\n\\cos(\\alpha) = \\mathbf{n} \\cdot \\mathbf{e}_x = n_x = \\frac{S_L}{U}\n$$\n条件 $\\partial G/\\partial y  0$ 意味着 $\\mathbf{n}$ 的 y 分量为正。这意味着 $\\sin(\\alpha)  0$。由于 $U \\ge S_L  0$，我们有 $0  S_L/U \\le 1$，这将角度 $\\alpha$ 置于区间 $[0, \\pi/2]$ 内。关系式 $\\alpha = \\arccos(S_L/U)$ 唯一地定义了此区间内的一个角度。\n因此，火焰角 $\\alpha$ 由下式给出：\n$$\n\\alpha = \\arccos\\left(\\frac{S_L}{U}\\right)\n$$",
            "answer": "$$\n\\boxed{\\arccos\\left(\\frac{S_L}{U}\\right)}\n$$"
        },
        {
            "introduction": "最后的这项实践将连接解析理论与计算实践之间的鸿沟。该问题要求你实现有限差分格式，以从水平集函数场中计算出关键的几何量，即法向量和曲率。通过在各向异性网格上分析数值误差，你将对计算火焰模拟中的数值挑战和最佳实践获得至关重要的见解，这对于任何从事计算燃烧研究的人来说都是一项核心技能。",
            "id": "4035843",
            "problem": "考虑一个预混火焰锋面的二维水平集表示。锋面被建模为一个以 $(x_0,y_0)$ 为中心、半径为 $R$ 的圆，由符号距离函数 $\\phi(x,y) = \\sqrt{(x-x_0)^2+(y-y_0)^2} - R$ 定义。在预混火焰的几何方程（G方程）的哈密顿-雅可比（Hamilton-Jacobi）表述中，锋面法线 $\\mathbf{n}$ 和几何曲率 $\\kappa$ 是进入传播定律的基本量。对于一个水平集函数 $\\phi$，这些量由核心的几何恒等式定义\n$$\n\\mathbf{n} = \\frac{\\nabla \\phi}{\\lVert \\nabla \\phi \\rVert}, \\qquad \\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{\\lVert \\nabla \\phi \\rVert} \\right),\n$$\n并且，在光滑点上，等效地由基于海森矩阵（Hessian）的公式定义\n$$\n\\kappa = \\frac{\\phi_{xx}\\,\\phi_y^2 - 2\\,\\phi_x\\,\\phi_y\\,\\phi_{xy} + \\phi_{yy}\\,\\phi_x^2}{\\left(\\phi_x^2+\\phi_y^2\\right)^{3/2}}.\n$$\n在一个间距 $dx$ 和 $dy$ 可能不相等（各向异性网格）的笛卡尔网格上，这些导数使用有限差分格式进行近似。即使对于像圆这样完全各向同性的几何形状，网格的各向异性也会在计算出的 $\\mathbf{n}$ 和 $\\kappa$ 中引入方向性误差。\n\n从上述定义出发，在各向异性网格上使用以下方法推导 $\\phi_x$、$\\phi_y$、$\\phi_{xx}$、$\\phi_{yy}$ 和 $\\phi_{xy}$ 的适当离散近似：\n- 二阶中心差分格式，以及\n- 四阶中心差分格式，\n\n两者都必须正确处理不相等的 $dx$ 和 $dy$。对于混合导数，通过先在 $x$ 方向再在 $y$ 方向上顺序应用所选阶数的导数算子来构造 $\\phi_{xy}$。\n\n实现一个程序，对于每个网格，计算：\n1. 单位法线 $\\mathbf{n}$ 及其相对于精确的向外径向法线 $\\mathbf{n}_{\\mathrm{exact}} = \\left( \\frac{x-x_0}{\\sqrt{(x-x_0)^2+(y-y_0)^2}}, \\frac{y-y_0}{\\sqrt{(x-x_0)^2+(y-y_0)^2}} \\right)$ 的方向误差，以弧度为单位的角度差来衡量，\n2. 使用上述海森公式计算的曲率 $\\kappa$ 及其相对于精确界面曲率 $1/R$ 的绝对误差。\n\n将误差计算限制在满足 $|\\phi| \\le \\frac{1}{2}\\min(dx,dy)$ 的网格节点窄带内，以及格式有效的节点（即，对于所选格式具有足够邻近点的内部节点）。使用均方根（RMS）范数对窄带内的误差进行汇总。\n\n使用以下科学上一致的参数：\n- 区域：$[0,L_x]\\times[0,L_y]$，其中 $L_x = L_y = 0.2$ 米，\n- 圆心：$(x_0,y_0) = (0.1,0.1)$ 米，\n- 圆半径：$R = 0.05$ 米。\n\n评估以下网格测试套件以探究各向异性效应：\n- 情况1（各向同性基准）：$(N_x,N_y) = (257,257)$，\n- 情况2（各向异性，$x$方向加密）：$(N_x,N_y) = (513,257)$，\n- 情况3（各向异性，$y$方向加密）：$(N_x,N_y) = (257,513)$，\n- 情况4（强各向异性，$x$方向更密）：$(N_x,N_y) = (1025,129)$，\n- 情况5（强各向异性，$y$方向更密）：$(N_x,N_y) = (129,1025)$。\n\n对于每种情况，计算并报告四个量：\n- 使用二阶格式的均方根法线方向误差（单位：弧度），\n- 使用四阶格式的均方根法线方向误差（单位：弧度），\n- 使用二阶格式的均方根曲率误差（单位：$1/\\mathrm{m}$），\n- 使用四阶格式的均方根曲率误差（单位：$1/\\mathrm{m}$）。\n\n最终输出格式要求：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含情况1的上述四个量，然后是情况2的，依此类推，最终形成一个包含 $20$ 个浮点数的列表。角度必须以弧度表示。曲率误差必须以逆米（$1/\\mathrm{m}$）表示。例如，需要形如\n$[e_{1,\\mathrm{angle},2}, e_{1,\\mathrm{angle},4}, e_{1,\\kappa,2}, e_{1,\\kappa,4}, e_{2,\\mathrm{angle},2}, \\dots, e_{5,\\kappa,4}]$\n的输出格式，其中下标表示情况编号、物理量和格式阶数。",
            "solution": "所提出的问题是有效的，因为它在科学上基于计算燃烧学的原理，在数学上是适定的、客观的且自洽的。它呈现了一个标准的数值分析任务，涉及水平集方法和在各向异性网格上的有限差分近似。我们将继续提供完整的解决方案。\n\n这个问题的核心是评估从水平集函数 $\\phi$ 导出的几何量（法向量 $\\mathbf{n}$ 和曲率 $\\kappa$）的有限差分近似的准确性。分析在一个简单的已知几何形状——一个圆上进行，对于这个圆，$\\mathbf{n}$ 和 $\\kappa$ 的精确解析值是可用的，这使得能够对数值误差进行精确量化。使用各向异性网格 ($dx \\neq dy$) 是一个关键要素，因为它通常会降低为各向同性网格设计的数值格式的准确性。\n\n以 $(x_0, y_0)$ 为中心、半径为 $R$ 的圆的水平集函数由符号距离函数给出：\n$$ \\phi(x,y) = \\sqrt{(x-x_0)^2 + (y-y_0)^2} - R $$\n界面是零等值线，$\\phi(x,y) = 0$。基本的几何量是从 $\\phi$ 的偏导数计算出来的。\n\n圆上一点 $(x,y)$ 处的精确向外单位法向量 $\\mathbf{n}_{\\mathrm{exact}}$ 从中心 $(x_0,y_0)$ 径向向外：\n$$ \\mathbf{n}_{\\mathrm{exact}}(x,y) = \\frac{(x-x_0, y-y_0)}{\\sqrt{(x-x_0)^2 + (y-y_0)^2}} $$\n圆的精确曲率 $\\kappa_{\\mathrm{exact}}$ 是其半径的倒数：\n$$ \\kappa_{\\mathrm{exact}} = \\frac{1}{R} $$\n\n在数值上，我们首先在离散网格上计算 $\\phi$ 的偏导数，然后用这些偏导数来计算 $\\mathbf{n}$ 和 $\\kappa$ 的近似值。问题要求在具有间距 $dx$ 和 $dy$ 的各向异性笛卡尔网格上，推导并实现二阶和四阶精度的中心差分格式。\n\n设 $\\phi_{i,j} = \\phi(i \\cdot dx, j \\cdot dy)$ 为网格节点 $(i,j)$ 处的水平集函数值。\n\n**1. 二阶有限差分格式**\n\n基于泰勒级数展开，各向异性网格上一阶和二阶偏导数的标准二阶中心差分近似为：\n- 一阶导数 ($O(dx^2), O(dy^2)$):\n$$ (\\phi_x)_{i,j} = \\frac{\\partial\\phi}{\\partial x}\\bigg|_{i,j} \\approx \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\,dx} $$\n$$ (\\phi_y)_{i,j} = \\frac{\\partial\\phi}{\\partial y}\\bigg|_{i,j} \\approx \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\,dy} $$\n- 二阶导数 ($O(dx^2), O(dy^2)$):\n$$ (\\phi_{xx})_{i,j} = \\frac{\\partial^2\\phi}{\\partial x^2}\\bigg|_{i,j} \\approx \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{dx^2} $$\n$$ (\\phi_{yy})_{i,j} = \\frac{\\partial^2\\phi}{\\partial y^2}\\bigg|_{i,j} \\approx \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{dy^2} $$\n- 混合二阶导数 ($O(dx^2, dy^2)$)，通过顺序应用一阶导数算子（例如 $\\frac{\\partial}{\\partial y}(\\frac{\\partial \\phi}{\\partial x})$）计算：\n$$ (\\phi_{xy})_{i,j} = \\frac{\\partial^2\\phi}{\\partial x \\partial y}\\bigg|_{i,j} \\approx \\frac{1}{2\\,dy} \\left[ \\frac{\\phi_{i+1,j+1} - \\phi_{i-1,j+1}}{2\\,dx} - \\frac{\\phi_{i+1,j-1} - \\phi_{i-1,j-1}}{2\\,dx} \\right] $$\n$$ (\\phi_{xy})_{i,j} \\approx \\frac{\\phi_{i+1,j+1} - \\phi_{i-1,j+1} - \\phi_{i+1,j-1} + \\phi_{i-1,j-1}}{4\\,dx\\,dy} $$\n\n**2. 四阶有限差分格式**\n\n对于光滑函数，高阶格式以更宽的模板（需要更多的邻近点）为代价提供更高的精度。四阶中心差分格式为：\n- 一阶导数 ($O(dx^4), O(dy^4)$):\n$$ (\\phi_x)_{i,j} \\approx \\frac{-\\phi_{i+2,j} + 8\\phi_{i+1,j} - 8\\phi_{i-1,j} + \\phi_{i-2,j}}{12\\,dx} $$\n$$ (\\phi_y)_{i,j} \\approx \\frac{-\\phi_{i,j+2} + 8\\phi_{i,j+1} - 8\\phi_{i,j-1} + \\phi_{i,j-2}}{12\\,dy} $$\n- 二阶导数 ($O(dx^4), O(dy^4)$):\n$$ (\\phi_{xx})_{i,j} \\approx \\frac{-\\phi_{i+2,j} + 16\\phi_{i+1,j} - 30\\phi_{i,j} + 16\\phi_{i-1,j} - \\phi_{i-2,j}}{12\\,dx^2} $$\n$$ (\\phi_{yy})_{i,j} \\approx \\frac{-\\phi_{i,j+2} + 16\\phi_{i,j+1} - 30\\phi_{i,j} + 16\\phi_{i,j-1} - \\phi_{i,j-2}}{12\\,dy^2} $$\n- 混合二阶导数 ($O(dx^4, dy^4)$)，同样通过顺序应用（例如，使用四阶格式计算 $\\frac{\\partial}{\\partial y}(\\frac{\\partial \\phi}{\\partial x})$）来计算：\n$$ (\\phi_{xy})_{i,j} \\approx \\frac{1}{12\\,dy} \\left[ (\\phi_x)_{i,j+2}(-1) + (\\phi_x)_{i,j+1}(8) - (\\phi_x)_{i,j-1}(8) + (\\phi_x)_{i,j-2}(1) \\right] $$\n其中每个 $(\\phi_x)$ 项都使用 $x$ 导数的四阶格式进行评估。这导致 $\\phi_{xy}$ 的计算使用一个 $5 \\times 5$ 的模板。\n\n**3. 数值评估流程**\n对于每个测试用例网格以及每种精度阶数（二阶和四阶），执行以下步骤：\n1.  **网格和场生成**：在区域 $[0, L_x] \\times [0, L_y]$ 上创建一个 $N_x \\times N_y$ 的网格。网格间距为 $dx = L_x / (N_x - 1)$ 和 $dy = L_y / (N_y - 1)$。在每个网格节点上计算精确的符号距离函数 $\\phi$。\n2.  **导数计算**：使用相应阶数的格式在整个网格上计算偏导数 $\\phi_x, \\phi_y, \\phi_{xx}, \\phi_{yy}, \\phi_{xy}$。\n3.  **几何量计算**：使用提供的公式在每个网格节点上计算数值法向量 $\\mathbf{n}$ 和曲率 $\\kappa$：\n    $$ \\mathbf{n} = \\frac{(\\phi_x, \\phi_y)}{\\sqrt{\\phi_x^2 + \\phi_y^2}}, \\qquad \\kappa = \\frac{\\phi_{xx}\\,\\phi_y^2 - 2\\,\\phi_x\\,\\phi_y\\,\\phi_{xy} + \\phi_{yy}\\,\\phi_x^2}{(\\phi_x^2+\\phi_y^2)^{3/2}} $$\n    在分母中加入一个小的 epsilon 以防止除以零。\n4.  **误差分析域**：仅对一部分网格节点进行误差分析。我们定义一个掩码（mask），用于选择满足两个条件的节点：\n    a.  **窄带**：节点必须靠近真实界面，即 $|\\phi| \\le \\frac{1}{2}\\min(dx,dy)$。\n    b.  **内部节点**：节点必须有足够的邻近点以确保格式有效。对于二阶格式，这意味着排除一个 1 单元的边界层。对于四阶格式，排除一个 2 单元的边界层。\n5.  **误差计算**：\n    a.  **法线方向误差**：误差是数值法线 $\\mathbf{n}$ 和精确法线 $\\mathbf{n}_{\\mathrm{exact}}$ 之间的夹角（以弧度为单位）。通过 $\\theta = \\arccos(\\mathbf{n} \\cdot \\mathbf{n}_{\\mathrm{exact}})$ 计算。\n    b.  **曲率误差**：误差是数值曲率 $\\kappa$ 与精确曲率 $\\kappa_{\\mathrm{exact}} = 1/R$ 之间的差值。\n6.  **误差汇总**：对掩码选择的所有节点，计算每种误差类型的均方根（RMS）。对于一个误差场 $e$，其均方根误差为 $\\sqrt{\\langle e^2 \\rangle}$。\n\n这个系统性的流程可以直接比较格式阶数和网格各向异性对火焰模拟中至关重要的几何量准确性的影响。",
            "answer": "```python\nimport numpy as np\n\ndef compute_derivatives(phi, dx, dy, order):\n    \"\"\"\n    Computes partial derivatives of a 2D field using finite differences.\n    NOTE: Assumes 'ij' indexing for phi, where axis 0 is x and axis 1 is y.\n    \"\"\"\n    if order == 2:\n        # First derivatives (2nd-order central)\n        phi_x = (np.roll(phi, -1, axis=0) - np.roll(phi, 1, axis=0)) / (2 * dx)\n        phi_y = (np.roll(phi, -1, axis=1) - np.roll(phi, 1, axis=1)) / (2 * dy)\n        \n        # Second derivatives (2nd-order central)\n        phi_xx = (np.roll(phi, -1, axis=0) - 2 * phi + np.roll(phi, 1, axis=0)) / (dx**2)\n        phi_yy = (np.roll(phi, -1, axis=1) - 2 * phi + np.roll(phi, 1, axis=1)) / (dy**2)\n        \n        # Mixed derivative by sequential application\n        phi_xy = (np.roll(phi_x, -1, axis=1) - np.roll(phi_x, 1, axis=1)) / (2 * dy)\n\n    elif order == 4:\n        # First derivatives (4th-order central)\n        phi_x = (-np.roll(phi, -2, axis=0) + 8 * np.roll(phi, -1, axis=0) - 8 * np.roll(phi, 1, axis=0) + np.roll(phi, 2, axis=0)) / (12 * dx)\n        phi_y = (-np.roll(phi, -2, axis=1) + 8 * np.roll(phi, -1, axis=1) - 8 * np.roll(phi, 1, axis=1) + np.roll(phi, 2, axis=1)) / (12 * dy)\n        \n        # Second derivatives (4th-order central)\n        phi_xx = (-np.roll(phi, -2, axis=0) + 16 * np.roll(phi, -1, axis=0) - 30 * phi + 16 * np.roll(phi, 1, axis=0) - np.roll(phi, 2, axis=0)) / (12 * dx**2)\n        phi_yy = (-np.roll(phi, -2, axis=1) + 16 * np.roll(phi, -1, axis=1) - 30 * phi + 16 * np.roll(phi, 1, axis=1) - np.roll(phi, 2, axis=1)) / (12 * dy**2)\n\n        # Mixed derivative by sequential application\n        phi_xy = (-np.roll(phi_x, -2, axis=1) + 8 * np.roll(phi_x, -1, axis=1) - 8 * np.roll(phi_x, 1, axis=1) + np.roll(phi_x, 2, axis=1)) / (12 * dy)\n    else:\n        raise ValueError(\"Order must be 2 or 4\")\n        \n    return phi_x, phi_y, phi_xx, phi_yy, phi_xy\n\ndef compute_metrics_for_case(case_params, constants):\n    \"\"\"\n    Computes the four required error metrics for a single grid configuration.\n    \"\"\"\n    Nx, Ny = case_params\n    Lx, Ly, x0, y0, R = constants.values()\n\n    # Grid setup\n    dx = Lx / (Nx - 1)\n    dy = Ly / (Ny - 1)\n    x = np.linspace(0, Lx, Nx)\n    y = np.linspace(0, Ly, Ny)\n    # Use 'ij' indexing so that the first axis (0) corresponds to x\n    # and the second axis (1) corresponds to y.\n    X, Y = np.meshgrid(x, y, indexing='ij')\n\n    # Level-set field\n    phi = np.sqrt((X - x0)**2 + (Y - y0)**2) - R\n    \n    errors = {}\n\n    for order in [2, 4]:\n        # Compute derivatives\n        phi_x, phi_y, phi_xx, phi_yy, phi_xy = compute_derivatives(phi, dx, dy, order)\n        \n        # Define masks\n        # Interior mask to exclude boundaries where stencils are invalid\n        interior_mask = np.zeros_like(phi, dtype=bool)\n        stencil_width = order // 2 # 1 for 2nd order, 2 for 4th order\n        interior_mask[stencil_width:Nx-stencil_width, stencil_width:Ny-stencil_width] = True\n        \n        # Narrow band mask\n        band_width = 0.5 * min(dx, dy)\n        band_mask = np.abs(phi) = band_width\n        \n        # Final mask for analysis\n        mask = interior_mask  band_mask\n\n        # Numerical normal and curvature\n        grad_phi_norm_sq = phi_x**2 + phi_y**2\n        \n        epsilon = 1e-15\n        grad_phi_norm = np.sqrt(grad_phi_norm_sq + epsilon)\n        \n        nx = phi_x / grad_phi_norm\n        ny = phi_y / grad_phi_norm\n        \n        kappa_num = (phi_xx * phi_y**2 - 2 * phi_x * phi_y * phi_xy + phi_yy * phi_x**2)\n        kappa_den = (grad_phi_norm_sq)**(1.5)\n        kappa = kappa_num / (kappa_den + epsilon)\n\n        # Exact quantities\n        r = np.sqrt((X - x0)**2 + (Y - y0)**2)\n        r_safe = np.where(r == 0, epsilon, r)\n        nx_exact = (X - x0) / r_safe\n        ny_exact = (Y - y0) / r_safe\n        kappa_exact = 1.0 / R\n\n        # Compute errors\n        # Normal vector orientation error\n        dot_product = np.clip(nx * nx_exact + ny * ny_exact, -1.0, 1.0)\n        angle_error = np.arccos(dot_product)\n        \n        # Curvature error\n        curvature_error = kappa - kappa_exact\n        \n        # RMS errors over the masked region\n        rms_angle_error = np.sqrt(np.mean(angle_error[mask]**2))\n        rms_kappa_error = np.sqrt(np.mean(curvature_error[mask]**2))\n        \n        errors[f'angle_{order}'] = rms_angle_error\n        errors[f'kappa_{order}'] = rms_kappa_error\n        \n    return [errors['angle_2'], errors['angle_4'], errors['kappa_2'], errors['kappa_4']]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define constants\n    constants = {\n        'Lx': 0.2, 'Ly': 0.2,\n        'x0': 0.1, 'y0': 0.1,\n        'R': 0.05\n    }\n    \n    # Define test cases from the problem statement\n    test_cases = [\n        (257, 257),   # Case 1: Isotropic baseline\n        (513, 257),   # Case 2: Anisotropic, refined in x\n        (257, 513),   # Case 3: Anisotropic, refined in y\n        (1025, 129),  # Case 4: Strong anisotropy, x much finer\n        (129, 1025)   # Case 5: Strong anisotropy, y much finer\n    ]\n    \n    results = []\n    for case in test_cases:\n        case_results = compute_metrics_for_case(case, constants)\n        results.extend(case_results)\n        \n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\n# solve() is not called here, as the problem is to provide the code.\n# The user wants the output in the final tag, so the code must be run.\n# The answer tag will contain the output of this script.\n# I will run this locally and paste the output.\n```"
        }
    ]
}