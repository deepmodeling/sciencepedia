{
    "hands_on_practices": [
        {
            "introduction": "在超燃冲压发动机中，隔离段利用一系列激波在气流进入燃烧室前对其进行压缩。对该过程进行建模的一个关键问题是：如何处理穿过极薄激波层的化学反应。本练习  提供了一个动手计算，通过比较流体穿过激波的渡越时间与特征化学反应时间，让您能够定量地验证“冻结化学”假设的合理性，这是高速空气动力学热力学的一个基石。",
            "id": "4069664",
            "problem": "在超燃冲压发动机（scramjet）的隔离段中，一道平面一维正激波在来流的化学计量氢气-空气混合物中形成。在激波上游，该混合物的温度为 $T_1 = 300\\,\\mathrm{K}$，压力为 $p_1 = 1\\,\\mathrm{atm}$，马赫数为 $M_1 = 3$。将该混合物模拟为理想气体。设干燥空气由摩尔分数为 $0.21$ 的氧气和摩尔分数为 $0.79$ 的氮气组成，并加入氢气，使得氧气根据反应 $2\\,\\mathrm{H}_2 + \\mathrm{O}_2 \\rightarrow 2\\,\\mathrm{H}_2\\mathrm{O}$ 完全按化学计量消耗。穿过激波时，假设化学成分为冻结化学（组分不变），或者错误地假设在相同的激波厚度内达到瞬时化学平衡。对于冻结化学，将混合物视为量热完全气体，其热容比为 $\\gamma_f = 1.40$。对于化学平衡假设，近似一个有效热容比 $\\gamma_{eq} = 1.30$，该值代表了紧邻激波后状态下高温振动激活和初始离解的情况。激波厚度为 $L_s = 5.0 \\times 10^{-7}\\,\\mathrm{m}$。普适气体常数为 $R_u = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。为估计反应时间尺度，取氢气-空气在接近激波后即时条件下的代表性化学诱导时间为 $\\tau_{chem} = 1.0 \\times 10^{-4}\\,\\mathrm{s}$。\n\n从量热完全理想气体穿过静止、平面、绝热、非反应正激波的质量、动量和能量守恒定律出发，推导在冻结化学条件下激波后的静温 $T_2$ 以及在化学平衡假设下（使用 $\\gamma_{eq}$）对应的 $T_2$。然后，将假设在相同激波厚度内达到化学平衡所产生的相对误差定义为\n$$\\varepsilon \\equiv \\frac{T_{2,eq} - T_{2,f}}{T_{2,f}}.$$\n计算 $\\varepsilon$ 的纯小数值。将最终答案四舍五入至四位有效数字。\n\n在您的推导中，还需使用 $u_1 = M_1 a_1$ 和 $a_1 = \\sqrt{\\gamma_f R_m T_1}$ 来估算流体穿过激波的渡越时间 $\\tau_{flow} = L_s / u_1$，其中 $R_m = R_u / \\bar{M}$ 是混合物气体常数，$\\bar{M}$ 是由上述化学计量组成所隐含的混合物平均分子量。通过比较 $\\tau_{flow}$ 和 $\\tau_{chem}$ 来评论化学平衡假设的有效性。以秒为单位表示 $\\tau_{flow}$。要求的最终答案是 $\\varepsilon$ 的小数值；请勿在最终答案框中包含任何单位。",
            "solution": "首先验证问题，确认其自洽、有科学依据且适定。我们开始求解。\n\n分析首先确定化学计量的氢气-空气混合物的性质。燃烧反应为 $2\\,\\mathrm{H}_2 + \\mathrm{O}_2 \\rightarrow 2\\,\\mathrm{H}_2\\mathrm{O}$。这表明每 $1$ 摩尔氧气（$\\mathrm{O}_2$）需要 $2$ 摩尔氢气（$\\mathrm{H}_2$）。规定干燥空气的组成为 $0.21$ 摩尔分数的 $\\mathrm{O}_2$ 和 $0.79$ 摩尔分数的氮气（$\\mathrm{N}_2$）。\n\n以 $1$ 摩尔空气为基准，我们有 $0.21$ 摩尔的 $\\mathrm{O}_2$ 和 $0.79$ 摩尔的 $\\mathrm{N}_2$。为实现化学计量燃烧，我们必须添加 $N_{\\mathrm{H}_2} = 2 \\times N_{\\mathrm{O}_2} = 2 \\times 0.21 = 0.42$ 摩尔的 $\\mathrm{H}_2$。未反应混合物中的总摩尔数为 $N_{mix} = N_{\\mathrm{H}_2} + N_{\\mathrm{O}_2} + N_{\\mathrm{N}_2} = 0.42 + 0.21 + 0.79 = 1.42$ 摩尔。\n\n上游混合物中各物种的摩尔分数（$X_i$）为：\n$X_{\\mathrm{H}_2} = \\frac{0.42}{1.42}$\n$X_{\\mathrm{O}_2} = \\frac{0.21}{1.42}$\n$X_{\\mathrm{N}_2} = \\frac{0.79}{1.42}$\n\n混合物的平均分子量 $\\bar{M}$ 是其各组分分子量的加权平均值。使用分子量 $M_{\\mathrm{H}_2} \\approx 2.016 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$，$M_{\\mathrm{O}_2} \\approx 32.00 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$，和 $M_{\\mathrm{N}_2} \\approx 28.01 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$：\n$$ \\bar{M} = X_{\\mathrm{H}_2} M_{\\mathrm{H}_2} + X_{\\mathrm{O}_2} M_{\\mathrm{O}_2} + X_{\\mathrm{N}_2} M_{\\mathrm{N}_2} $$\n$$ \\bar{M} = \\frac{1}{1.42} [0.42(2.016) + 0.21(32.00) + 0.79(28.01)] \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1} $$\n$$ \\bar{M} = \\frac{1}{1.42} [0.84672 + 6.72 + 22.1279] \\times 10^{-3} = \\frac{29.69462}{1.42} \\times 10^{-3} \\approx 0.020912\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1} $$\n混合物的比气体常数 $R_m$ 由 $R_m = R_u / \\bar{M}$ 给出，其中 $R_u = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n$$ R_m = \\frac{8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}}{0.020912\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}} \\approx 397.55\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\n接下来，我们计算上游流动的性质。上游气体（状态1）中的声速 $a_1$ 为 $a_1 = \\sqrt{\\gamma_f R_m T_1}$。由于来流未发生反应，因此使用冻结热容比 $\\gamma_f = 1.40$。已知 $T_1 = 300\\,\\mathrm{K}$：\n$$ a_1 = \\sqrt{1.40 \\times 397.55\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\times 300\\,\\mathrm{K}} \\approx 408.62\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n上游流速 $u_1$ 由 $u_1 = M_1 a_1$ 给出，其中马赫数 $M_1 = 3$：\n$$ u_1 = 3 \\times 408.62\\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 1225.86\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\n题目要求估算流体穿过激波的渡越时间 $\\tau_{flow}$，给定激波厚度 $L_s = 5.0 \\times 10^{-7}\\,\\mathrm{m}$：\n$$ \\tau_{flow} = \\frac{L_s}{u_1} = \\frac{5.0 \\times 10^{-7}\\,\\mathrm{m}}{1225.86\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx 4.08 \\times 10^{-10}\\,\\mathrm{s} $$\n题目要求我们将此时间与特征化学诱导时间 $\\tau_{chem} = 1.0 \\times 10^{-4}\\,\\mathrm{s}$ 进行比较。比值 $\\tau_{flow} / \\tau_{chem} \\approx 4 \\times 10^{-6} \\ll 1$。这种巨大的时间尺度差异表明，流体粒子穿过激波结构的速度比化学反应进行的速度快得多。因此，在薄激波层内假设化学成分冻结（组分不变）在物理上是合理的。而假设穿过激波时达到瞬时化学平衡的替代假设在物理上是无效的，因为它要求 $\\tau_{chem} \\ll \\tau_{flow}$。\n\n对于量热完全理想气体，正激波上游（$T_1$）和下游（$T_2$）静温之间的关系由质量、动量和能量守恒导出。其关系式为：\n$$ \\frac{T_2}{T_1} = \\frac{[2\\gamma M_1^2 - (\\gamma-1)][(\\gamma-1)M_1^2 + 2]}{(\\gamma+1)^2 M_1^2} $$\n我们将对两种情况使用此关系式。\n\n首先，对于冻结化学，我们使用 $\\gamma = \\gamma_f = 1.40$ 和 $M_1 = 3$：\n$$ \\frac{T_{2,f}}{T_1} = \\frac{[2(1.40)(3^2) - (1.40-1)][(1.40-1)(3^2) + 2]}{(1.40+1)^2 (3^2)} $$\n$$ \\frac{T_{2,f}}{T_1} = \\frac{[2.80 \\times 9 - 0.40][0.40 \\times 9 + 2]}{(2.40)^2 \\times 9} = \\frac{[25.2 - 0.40][3.6 + 2]}{5.76 \\times 9} = \\frac{24.8 \\times 5.6}{51.84} = \\frac{138.88}{51.84} \\approx 2.6790 $$\n所以，$T_{2,f} = T_1 \\times 2.6790 = 300\\,\\mathrm{K} \\times 2.6790 \\approx 803.7\\,\\mathrm{K}$。\n\n其次，对于错误的化学平衡假设，我们使用有效热容比 $\\gamma = \\gamma_{eq} = 1.30$，上游马赫数同样为 $M_1=3$：\n$$ \\frac{T_{2,eq}}{T_1} = \\frac{[2(1.30)(3^2) - (1.30-1)][(1.30-1)(3^2) + 2]}{(1.30+1)^2 (3^2)} $$\n$$ \\frac{T_{2,eq}}{T_1} = \\frac{[2.60 \\times 9 - 0.30][0.30 \\times 9 + 2]}{(2.30)^2 \\times 9} = \\frac{[23.4 - 0.30][2.7 + 2]}{5.29 \\times 9} = \\frac{23.1 \\times 4.7}{47.61} = \\frac{108.57}{47.61} \\approx 2.2804 $$\n所以，$T_{2,eq} = T_1 \\times 2.2804 = 300\\,\\mathrm{K} \\times 2.2804 \\approx 684.1\\,\\mathrm{K}$。\n较低的有效 $\\gamma_{eq}$ 说明了在高温下能量被内能模式（振动）吸收，与量热完全（冻结）气体模型相比，导致了较低的激波后温度。\n\n最后，我们计算这个错误假设所产生的相对误差 $\\varepsilon$：\n$$ \\varepsilon \\equiv \\frac{T_{2,eq} - T_{2,f}}{T_{2,f}} $$\n我们可以从温度比计算该值，因为 $T_1$ 会被消掉：\n$$ \\varepsilon = \\frac{T_{2,eq}/T_1 - T_{2,f}/T_1}{T_{2,f}/T_1} = \\frac{2.280403 - 2.679012}{2.679012} = \\frac{-0.398609}{2.679012} \\approx -0.148789 $$\n四舍五入到四位有效数字，相对误差为 $-0.1488$。",
            "answer": "$$\n\\boxed{-0.1488}\n$$"
        },
        {
            "introduction": "在理解了关键物理现象之后，计算科学家必须解决模拟这些现象时遇到的数值挑战。对于显式时间积分方案，其稳定性同时受到流体动力学和化学动力学的限制，而这两者的时间尺度往往差异巨大。本练习  将指导您计算对流的Courant–Friedrichs–Lewy (CFL) 条件以及由刚性化学反应引起的稳定性极限，揭示这些约束如何决定最大允许时间步长，并阐明为何需要采用像双时间步法这样的先进方法来高效求解稳态问题。",
            "id": "4069709",
            "problem": "本文考虑一个超燃冲压发动机（scramjet）燃烧室恒定截面管道中反应性超音速流的一维模型。该混合物被建模为量热不完全但热力学完美的理想气体，其比热比为 $\\gamma$，空气气体常数为 $R$，温度为 $T$。流动的马赫数为 $M$，有限体积网格的均匀间距为 $\\Delta x$。双曲对流算子通过使用目标 Courant–Friedrichs–Lewy (CFL) 数 $C_{\\text{exp}}$ 的显式格式在物理时间内推进。燃烧室中的化学动力学在工作点附近由单个反应进程变量 $c$ 表示，其源项线性化后得到 $dc/dt = -k\\,c$。其中 $k$ 通过 Arrhenius 形式 $k = A \\exp(-E_{a}/(R_{u} T))$ 近似，这里 $A$ 是指前因子，$E_{a}$ 是活化能，$R_{u}$ 是通用气体常数。\n\n使用以下参数，这些参数是超燃冲压发动机燃烧室条件的代表值：\n- $\\gamma = 1.33$, $R = 287\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, $R_{u} = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。\n- $T = 2400\\,\\text{K}$, $M = 2.3$, $\\Delta x = 7.5 \\times 10^{-4}\\,\\text{m}$。\n- $C_{\\text{exp}} = 0.6$。\n- $A = 8.0 \\times 10^{7}\\,\\text{s}^{-1}$, $E_{a} = 95 \\times 10^{3}\\,\\text{J}\\,\\text{mol}^{-1}$。\n\n从第一性原理出发，推导由以下条件施加的显式物理时间步长约束：\n1. 一维可压缩双曲系统的 Courant–Friedrichs–Lewy 条件。\n2. 对于刚性化学源项 $dc/dt = -k\\,c$，前向欧拉时间积分的线性稳定性要求。\n\n计算这两个约束，以秒为单位表示物理时间。然后，对于通过双时间步（DTS）加速的稳态反应计算，假设伪时间积分采用一种隐式格式，该格式：\n- 隐式处理化学源项（消除了显式化学刚性限制），以及\n- 对于对流算子，其在伪 CFL 数 $C_{\\text{imp}} = 100$ 以下是稳定的。\n\n将此稳态反应情况下 DTS 的优势估计为加速比 $S = \\Delta \\tau / \\Delta t_{\\text{exp}}$，其中 $\\Delta \\tau$ 是稳定的伪时间步长，$\\Delta t_{\\text{exp}}$ 是从推导的约束中选择的最严格的显式物理时间步长。将 $S$ 表示为一个无量纲数。将您的最终答案四舍五入到三位有效数字。所有中间时间量均使用秒作为单位。",
            "solution": "对流时间步长限制的基本依据是 Courant–Friedrichs–Lewy (CFL) 概念：双曲守恒律的显式时间推进是稳定的，条件是单个时间步内没有特征信息传播超过一个单元格。在一维情况下，对于带有被动标量的可压缩欧拉算子，特征速度（通量雅可比矩阵的特征值）为 $u-a$、$u$ 和 $u+a$，其中 $u$ 是流向速度，$a$ 是声速。因此，在超音速正向流中，最严格的对流波速是 $|u| + a$。\n\n理想气体的声速为 $a = \\sqrt{\\gamma R T}$。速度通过 $u = M a$ 与马赫数相关。因此，最大特征速度为\n$$\n\\lambda_{\\max} = |u| + a = M a + a = (M+1)\\,a .\n$$\n一个目标 Courant 数为 $C_{\\text{exp}}$ 的显式格式强制施加对流时间步长约束\n$$\n\\Delta t_{\\text{CFL}} = C_{\\text{exp}}\\,\\frac{\\Delta x}{\\lambda_{\\max}} = C_{\\text{exp}}\\,\\frac{\\Delta x}{|u|+a} .\n$$\n\n对于化学源项的限制，我们考虑在工作点附近通过线性化得到的线性常微分方程 $dc/dt = -k\\,c$。对于衰减的线性模态，前向欧拉时间积分在放大因子满足 $|1 - k\\,\\Delta t| \\leq 1$ 时是稳定的，这给出了稳定性区间 $0 \\leq k\\,\\Delta t \\leq 2$。因此，显式化学时间步长限制为\n$$\n\\Delta t_{\\text{chem}} = \\frac{2}{k} ,\n$$\n其中 $k$ 是局部线性化的衰减率。使用 Arrhenius 形式 $k = A \\exp(-E_{a}/(R_{u} T))$，我们首先计算 $a$、$u$、$\\lambda_{\\max}$，然后是 $\\Delta t_{\\text{CFL}}$，接着是 $k$ 和 $\\Delta t_{\\text{chem}}$。\n\n计算 $a$：\n$$\na = \\sqrt{\\gamma R T} = \\sqrt{1.33 \\times 287 \\times 2400} = \\sqrt{916{,}104}\\,\\text{m}\\,\\text{s}^{-1} .\n$$\n数值上，$\\sqrt{916{,}104} \\approx 957.133$，所以\n$$\na \\approx 957.133\\,\\text{m}\\,\\text{s}^{-1} .\n$$\n\n计算 $u$：\n$$\nu = M a = 2.3 \\times 957.133 \\approx 2{,}201.406\\,\\text{m}\\,\\text{s}^{-1} .\n$$\n\n计算 $\\lambda_{\\max}$：\n$$\n\\lambda_{\\max} = |u| + a \\approx 2{,}201.406 + 957.133 = 3{,}158.539\\,\\text{m}\\,\\text{s}^{-1} .\n$$\n\n计算对流时间步长约束：\n$$\n\\Delta t_{\\text{CFL}} = C_{\\text{exp}}\\,\\frac{\\Delta x}{\\lambda_{\\max}} = 0.6 \\times \\frac{7.5 \\times 10^{-4}}{3{,}158.539} \\,\\text{s} .\n$$\n计算该分数，\n$$\n\\frac{7.5 \\times 10^{-4}}{3{,}158.539} \\approx 2.3758 \\times 10^{-7}\\,\\text{s} ,\n$$\n所以\n$$\n\\Delta t_{\\text{CFL}} \\approx 0.6 \\times 2.3758 \\times 10^{-7} = 1.4255 \\times 10^{-7}\\,\\text{s} .\n$$\n\n通过 Arrhenius 公式计算化学反应速率常数 $k$：\n$$\nk = A \\exp\\left(-\\frac{E_{a}}{R_{u} T}\\right) = 8.0 \\times 10^{7} \\times \\exp\\left(-\\frac{95{,}000}{8.314 \\times 2400}\\right)\\,\\text{s}^{-1} .\n$$\n指数为\n$$\n\\frac{95{,}000}{8.314 \\times 2400} = \\frac{95{,}000}{19{,}953.6} \\approx 4.76098 ,\n$$\n所以\n$$\n\\exp(-4.76098) \\approx 8.56 \\times 10^{-3} .\n$$\n因此\n$$\nk \\approx 8.0 \\times 10^{7} \\times 8.56 \\times 10^{-3} = 6.848 \\times 10^{5}\\,\\text{s}^{-1} .\n$$\n\n计算化学时间步长约束：\n$$\n\\Delta t_{\\text{chem}} = \\frac{2}{k} \\approx \\frac{2}{6.848 \\times 10^{5}} = 2.920 \\times 10^{-6}\\,\\text{s} .\n$$\n\n显式物理时间步长是两个约束中更严格的一个：\n$$\n\\Delta t_{\\text{exp}} = \\min\\!\\big(\\Delta t_{\\text{CFL}}, \\Delta t_{\\text{chem}}\\big) = \\Delta t_{\\text{CFL}} \\approx 1.4255 \\times 10^{-7}\\,\\text{s} ,\n$$\n因为对于给定的超音速燃烧室条件，$\\Delta t_{\\text{CFL}} \\ll \\Delta t_{\\text{chem}}$。\n\n对于通过双时间步（DTS）加速的稳态反应计算，我们考虑一种伪时间积分，其中对流算子被隐式推进，化学反应被隐式处理，从而消除了显式化学刚性限制。该隐式格式在伪 Courant 数 $C_{\\text{imp}} = 100$ 以下是稳定的，所以稳定的伪时间步长为\n$$\n\\Delta \\tau = C_{\\text{imp}}\\,\\frac{\\Delta x}{\\lambda_{\\max}} = 100 \\times \\frac{\\Delta x}{\\lambda_{\\max}} .\n$$\n比较 DTS 伪时间步长与显式物理时间步长的加速比为\n$$\nS = \\frac{\\Delta \\tau}{\\Delta t_{\\text{exp}}} .\n$$\n由于在这种情况下 $\\Delta t_{\\text{exp}}$ 受限于对流 CFL 条件，$\\Delta \\tau$ 和 $\\Delta t_{\\text{exp}}$ 都与 $\\Delta x/\\lambda_{\\max}$ 成比例，从而得到\n$$\nS = \\frac{C_{\\text{imp}}}{C_{\\text{exp}}} = \\frac{100}{0.6} \\approx 166.666\\ldots .\n$$\n四舍五入到三位有效数字，该优势为\n$$\nS \\approx 167 .\n$$\n$S$ 是无量纲数，符合要求。",
            "answer": "$$\\boxed{167}$$"
        },
        {
            "introduction": "从部件级的物理学转向系统级的视角，这最后一个练习将要求您构建一个完整的超燃冲压发动机性能模型。通过实施准一维分析，您将整合可压缩流动和热力学原理，贯穿进气道、燃烧室和喷管的分析，同时考虑各部件的实际性能损失。这个总结性的编程练习  的最终目标是计算比冲 ($I_{sp}$)，让您能够直观地理解飞行条件和设计选择如何影响发动机的整体效率和推力。",
            "id": "4069676",
            "problem": "超音速燃烧冲压发动机（scramjet）的工作原理是：以超音速吸入大气，加入燃料，然后将燃烧后的高温产物气体通过喷管膨胀以产生推力。您的任务是实现一个准一维计算模型，用以计算氢燃料超燃冲压发动机在几种飞行条件下的比冲（Isp）。最终答案必须是一个能够精确生成所要求输出的、可独立运行的程序。\n\n推导过程应原理清晰，从质量守恒、动量守恒和能量守恒出发，并结合量热完全气体的标准可压缩流动关系。在整个过程中，将混合气体视为量热完全气体，其比热比 $\\gamma$、定气体常数 $R$ 以及定压比热 $c_p$ 均为常数。假设流动是绝热的，但燃烧室内的化学热释放除外。将进气道、燃烧室和喷管建模为具有实测总压损失的准一维部件。假设喷管出口为完全膨胀，即出口静压等于环境静压。当出口压力等于环境压力时，忽略粘性阻力和压力推力项。假设在指定的当量比下，氢气与空气完全混合并完全反应。\n\n使用的定义和常数：\n- 比冲（Isp）定义为 $I_{sp} = \\dfrac{F}{\\dot{m}_f g_0}$，其中 $F$ 是推力，单位为 $\\mathrm{N}$；$\\dot{m}_f$ 是燃料质量流量，单位为 $\\mathrm{kg\\,s^{-1}}$；$g_0$ 是标准重力加速度，单位为 $\\mathrm{m\\,s^{-2}}$。\n- 设自由来流的静压、温度和马赫数分别为 $p_\\infty$、$T_\\infty$ 和 $M_0$。\n- 进气道捕获面积为 $A_c$，单位为 $\\mathrm{m^2}$。\n- 进气道、燃烧室和喷管的总压损失比分别为 $\\tau_{\\mathrm{in}}$、$\\tau_{\\mathrm{comb}}$ 和 $\\tau_{\\mathrm{noz}}$。这些均为无量纲参数，且满足 $0  \\tau  1$。\n- 燃料-空气当量比为 $\\phi$，无量纲。对于氢燃料，使用化学计量燃料-空气质量比 $f_{\\mathrm{st}} = 1/34.48$（约等于 $0.0290$）。则燃料-空气质量比为 $f = \\phi f_{\\mathrm{st}}$。\n- 使用 $\\gamma = 1.4$，$R = 287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$c_p = \\dfrac{\\gamma R}{\\gamma - 1}$，$g_0 = 9.80665\\ \\mathrm{m\\,s^{-2}}$。\n- 使用氢气的低热值 $LHV = 1.2 \\times 10^8\\ \\mathrm{J\\,kg^{-1}}$。\n\n需实现的建模要求：\n1. 根据 $M_0$ 和 $T_\\infty$ 确定自由来流速度 $U_0$，根据 $p_\\infty$ 和 $T_\\infty$ 确定自由来流密度 $\\rho_\\infty$。确定吸入的空气质量流量 $\\dot{m}_a = \\rho_\\infty U_0 A_c$，单位为 $\\mathrm{kg\\,s^{-1}}$。\n2. 使用等熵关系计算自由来流的滞止温度和压力 $(T_{0,\\mathrm{free}}, p_{0,\\mathrm{free}})$。应用进气道总压损失比得到 $p_{0,\\mathrm{in}} = \\tau_{\\mathrm{in}} p_{0,\\mathrm{free}}$，并假设 $T_{0,\\mathrm{in}} = T_{0,\\mathrm{free}}$。\n3. 计算燃料质量流量 $\\dot{m}_f = f \\dot{m}_a$ 和总质量流量 $\\dot{m}_t = \\dot{m}_a + \\dot{m}_f$。\n4. 对燃烧室应用能量守恒定律，根据化学热释放和混合过程，求得燃烧室出口滞止温度 $T_{0,\\mathrm{comb}}$。应用燃烧室总压损失比得到 $p_{0,\\mathrm{comb}} = \\tau_{\\mathrm{comb}} p_{0,\\mathrm{in}}$。\n5. 应用喷管总压损失比得到喷管滞止压力 $p_{0,\\mathrm{noz}} = \\tau_{\\mathrm{noz}} p_{0,\\mathrm{comb}}$，并假设 $T_{0,\\mathrm{noz}} = T_{0,\\mathrm{comb}}$。\n6. 对于完全膨胀出口，设置 $p_e = p_\\infty$，并使用等熵关系从 $p_{0,\\mathrm{noz}}$ 和 $p_e$ 确定出口马赫数 $M_e$。如果 $p_{0,\\mathrm{noz}} \\le p_\\infty$，则设 $M_e = 0$。计算出口静温 $T_e$ 和出口速度 $U_e$。\n7. 计算推力 $F = \\dot{m}_t U_e - \\dot{m}_a U_0$，然后计算比冲 $I_{sp} = \\dfrac{F}{\\dot{m}_f g_0}$，单位为 $\\mathrm{s}$。如果推力为负，则 $I_{sp}$ 也相应为负。所有最终的 $I_{sp}$ 值都以 $\\mathrm{s}$ 为单位表示。\n\n您的程序必须评估以下五个测试用例。每个测试用例指定 $(M_0, p_\\infty, T_\\infty, A_c, \\tau_{\\mathrm{in}}, \\tau_{\\mathrm{comb}}, \\tau_{\\mathrm{noz}}, \\phi)$：\n\n- 测试用例 1：$M_0 = 6.0$, $p_\\infty = 2511\\ \\mathrm{Pa}$, $T_\\infty = 223.0\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.90$, $\\tau_{\\mathrm{comb}} = 0.60$, $\\tau_{\\mathrm{noz}} = 0.95$, $\\phi = 0.50$。\n- 测试用例 2：$M_0 = 5.0$, $p_\\infty = 5474\\ \\mathrm{Pa}$, $T_\\infty = 216.65\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.80$, $\\tau_{\\mathrm{comb}} = 0.40$, $\\tau_{\\mathrm{noz}} = 0.90$, $\\phi = 0.30$。\n- 测试用例 3（接近膨胀边界）：$M_0 = 2.0$, $p_\\infty = 35651\\ \\mathrm{Pa}$, $T_\\infty = 236.65\\ \\mathrm{K}$, $A_c = 0.3\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.85$, $\\tau_{\\mathrm{comb}} = 0.30$, $\\tau_{\\mathrm{noz}} = 0.70$, $\\phi = 0.15$。\n- 测试用例 4（高热量添加）：$M_0 = 7.5$, $p_\\infty = 1197\\ \\mathrm{Pa}$, $T_\\infty = 226.5\\ \\mathrm{K}$, $A_c = 0.7\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.92$, $\\tau_{\\mathrm{comb}} = 0.65$, $\\tau_{\\mathrm{noz}} = 0.97$, $\\phi = 0.90$。\n- 测试用例 5（稀燃情况）：$M_0 = 5.5$, $p_\\infty = 5474\\ \\mathrm{Pa}$, $T_\\infty = 216.65\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.88$, $\\tau_{\\mathrm{comb}} = 0.50$, $\\tau_{\\mathrm{noz}} = 0.93$, $\\phi = 0.10$。\n\n本问题不使用角度单位。必须遵守物理单位，并且最终所求的量必须以秒（$\\mathrm{s}$）为单位返回。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果需与上述测试用例的顺序完全一致。每个条目都必须是表示比冲 $I_{sp}$（单位为 $\\mathrm{s}$）的浮点数，并四舍五入到三位小数，例如 $\\left[1234.567,2345.678,3456.789,4567.890,5678.901\\right]$。",
            "solution": "该问题被评估为有效。它在科学上基于热力学和可压缩流体动力学原理，问题陈述清晰，指令和数据完整，表述客观。我们现在将着手进行原理性推导。\n\n目标是使用准一维流动模型，计算氢燃料超燃冲压发动机在几种飞行条件下的比冲 $I_{sp}$。该模型将发动机视为一系列部件——进气道、燃烧室和喷管——并分析流体属性在流经这些部件时的变化。\n\n**1. 自由来流条件与空气质量流量**\n分析始于自由来流条件：马赫数 $M_0$、静压 $p_\\infty$ 和静温 $T_\\infty$。自由来流的空气速度 $U_0$ 由马赫数的定义确定，假设空气是具有定气体常数 $R$ 和比热比 $\\gamma$ 的量热完全气体。\n$$U_0 = M_0 a_0 = M_0 \\sqrt{\\gamma R T_\\infty}$$\n自由来流的空气密度 $\\rho_\\infty$ 可通过理想气体定律求得：\n$$\\rho_\\infty = \\frac{p_\\infty}{R T_\\infty}$$\n发动机通过面积为 $A_c$ 的进气道捕获空气。吸入的空气质量流量 $\\dot{m}_a$ 由下式给出：\n$$\\dot{m}_a = \\rho_\\infty U_0 A_c$$\n\n**2. 进气道压缩**\n进气道压缩来流空气，使其压力和温度升高。该过程假定为绝热过程，因此滞止温度保持不变。自由来流的滞止属性 $T_{0,\\mathrm{free}}$ 和 $p_{0,\\mathrm{free}}$ 使用等熵流动关系计算：\n$$T_{0,\\mathrm{free}} = T_\\infty \\left(1 + \\frac{\\gamma-1}{2} M_0^2\\right)$$\n$$p_{0,\\mathrm{free}} = p_\\infty \\left(1 + \\frac{\\gamma-1}{2} M_0^2\\right)^{\\frac{\\gamma}{\\gamma-1}}$$\n由于进气道采用绝热假设，进气道出口的滞止温度保持不变：\n$$T_{0,\\mathrm{in}} = T_{0,\\mathrm{free}}$$\n进气道内的不可逆效应，如激波和摩擦，会导致总压损失，这由进气道总压恢复系数 $\\tau_{\\mathrm{in}}$ 量化：\n$$p_{0,\\mathrm{in}} = \\tau_{\\mathrm{in}} p_{0,\\mathrm{free}}$$\n\n**3. 燃料添加与总质量流量**\n燃料被添加到压缩后的气流中。燃料-空气质量比 $f$ 根据指定的当量比 $\\phi$ 和氢气的化学计量燃料-空气比 $f_{\\mathrm{st}}$ 定义：\n$$f = \\phi f_{\\mathrm{st}}$$\n燃料的质量流量 $\\dot{m}_f$ 为：\n$$\\dot{m}_f = f \\dot{m}_a$$\n流经后续部件的总质量流量 $\\dot{m}_t$ 是空气和燃料质量流量之和：\n$$\\dot{m}_t = \\dot{m}_a + \\dot{m}_f = \\dot{m}_a (1 + f)$$\n\n**4. 燃烧室热量添加**\n在燃烧室中，燃料燃烧释放化学能，显著提高气流的滞止温度。对燃烧室入口和出口应用稳流能量方程，我们考虑燃料燃烧释放的热量，该热量由其低热值 $LHV$ 定义。\n$$\\dot{m}_a h_{0,\\mathrm{in}} + \\dot{m}_f LHV = \\dot{m}_t h_{0,\\mathrm{comb}}$$\n假设进入的空气和排出的燃烧产物均为具有恒定定压比热 $c_p$ 的量热完全气体，我们可以写出 $h_0 = c_p T_0$。\n$$\\dot{m}_a c_p T_{0,\\mathrm{in}} + \\dot{m}_f LHV = (\\dot{m}_a + \\dot{m}_f) c_p T_{0,\\mathrm{comb}}$$\n$c_p$ 的值由气体属性确定：$c_p = \\frac{\\gamma R}{\\gamma - 1}$。求解燃烧室出口滞止温度 $T_{0,\\mathrm{comb}}$，得到：\n$$T_{0,\\mathrm{comb}} = \\frac{\\dot{m}_a c_p T_{0,\\mathrm{in}} + \\dot{m}_f LHV}{(\\dot{m}_a + \\dot{m}_f) c_p} = \\frac{T_{0,\\mathrm{in}} + f \\frac{LHV}{c_p}}{1+f}$$\n燃烧和混合是高度不可逆的过程，导致显著的总压损失。这通过燃烧室总压损失比 $\\tau_{\\mathrm{comb}}$ 来建模：\n$$p_{0,\\mathrm{comb}} = \\tau_{\\mathrm{comb}} p_{0,\\mathrm{in}}$$\n\n**5. 喷管流动**\n来自燃烧室的高温高压气体通过喷管膨胀。该膨胀过程假定为绝热，因此滞止温度守恒：\n$$T_{0,\\mathrm{noz}} = T_{0,\\mathrm{comb}}$$\n与其他部件类似，喷管存在由摩擦等引起的损失，这由喷管总压恢复系数 $\\tau_{\\mathrm{noz}}$ 计入：\n$$p_{0,\\mathrm{noz}} = \\tau_{\\mathrm{noz}} p_{0,\\mathrm{comb}}$$\n\n**6. 喷管出口条件**\n问题指定了“完全膨胀”喷管，即出口静压 $p_e$ 与环境自由来流压力 $p_\\infty$ 相等。\n$$p_e = p_\\infty$$\n喷管出口马赫数 $M_e$ 可由喷管滞止状态与出口静态之间的等熵压力关系确定：\n$$\\frac{p_{0,\\mathrm{noz}}}{p_e} = \\left(1 + \\frac{\\gamma-1}{2} M_e^2\\right)^{\\frac{\\gamma}{\\gamma-1}}$$\n该方程可以反解出 $M_e$：\n$$M_e = \\sqrt{\\frac{2}{\\gamma-1} \\left[ \\left(\\frac{p_{0,\\mathrm{noz}}}{p_e}\\right)^{\\frac{\\gamma-1}{\\gamma}} - 1 \\right]}$$\n为了实现有物理意义的膨胀，喷管滞止压力必须大于出口压力（$p_{0,\\mathrm{noz}} > p_e$）。如果 $p_{0,\\mathrm{noz}} \\le p_e$，气流无法膨胀到大于零的速度以匹配背压，因此我们设定 $M_e = 0$，这意味着出口速度 $U_e=0$。\n确定 $M_e$ 后，出口静温 $T_e$ 和出口速度 $U_e$ 可求得：\n$$T_e = \\frac{T_{0,\\mathrm{noz}}}{1 + \\frac{\\gamma-1}{2} M_e^2}$$\n$$U_e = M_e \\sqrt{\\gamma R T_e}$$\n\n**7. 推力与比冲**\n推力 $F$ 是发动机产生的净力。对于完全膨胀喷管，压力推力项为零，总推力由工作流体的动量变化决定。冲压阻力是进气空气的动量。净推力由下式给出：\n$$F = \\dot{m}_t U_e - \\dot{m}_a U_0$$\n最后，比冲 $I_{sp}$ 用于衡量推进剂的利用效率，定义为单位重量流量燃料产生的推力。标准重力加速度 $g_0$ 用于将燃料质量流量转换为重量流量。\n$$I_{sp} = \\frac{F}{\\dot{m}_f g_0}$$\n$I_{sp}$ 的结果单位是秒（$\\mathrm{s}$）。负推力将导致负比冲，表明发动机产生净阻力。对每个测试用例实施这些方程以确定其性能。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Specific Impulse (Isp) for a hydrogen-fueled scramjet\n    using a quasi-one-dimensional model for a given set of test cases.\n    \"\"\"\n    \n    # Define physical and gas constants\n    GAMMA = 1.4  # Ratio of specific heats\n    R = 287.0  # Specific gas constant for air (J/kg-K)\n    G0 = 9.80665  # Standard gravity (m/s^2)\n    LHV_H2 = 1.2e8  # Lower Heating Value of hydrogen (J/kg)\n    F_ST_H2 = 1.0 / 34.48  # Stoichiometric fuel-to-air ratio for hydrogen\n\n    # Derived constant: specific heat at constant pressure\n    CP = GAMMA * R / (GAMMA - 1.0)\n\n    # Each test case is a tuple:\n    # (M0, p_inf, T_inf, A_c, tau_in, tau_comb, tau_noz, phi)\n    test_cases = [\n        (6.0, 2511.0, 223.0, 0.5, 0.90, 0.60, 0.95, 0.50),\n        (5.0, 5474.0, 216.65, 0.5, 0.80, 0.40, 0.90, 0.30),\n        (2.0, 35651.0, 236.65, 0.3, 0.85, 0.30, 0.70, 0.15),\n        (7.5, 1197.0, 226.5, 0.7, 0.92, 0.65, 0.97, 0.90),\n        (5.5, 5474.0, 216.65, 0.5, 0.88, 0.50, 0.93, 0.10),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M0, p_inf, T_inf, A_c, tau_in, tau_comb, tau_noz, phi = case\n\n        # Step 1: Freestream conditions and air mass flow\n        U0 = M0 * np.sqrt(GAMMA * R * T_inf)\n        rho_inf = p_inf / (R * T_inf)\n        m_dot_a = rho_inf * U0 * A_c\n\n        # Step 2: Inlet analysis\n        T0_free = T_inf * (1.0 + (GAMMA - 1.0) / 2.0 * M0**2)\n        p0_free = p_inf * (1.0 + (GAMMA - 1.0) / 2.0 * M0**2)**(GAMMA / (GAMMA - 1.0))\n        \n        T0_in = T0_free\n        p0_in = tau_in * p0_free\n\n        # Step 3: Fuel injection and total mass flow\n        f = phi * F_ST_H2\n        m_dot_f = f * m_dot_a\n        m_dot_t = m_dot_a + m_dot_f\n\n        # Step 4: Combustor analysis\n        T0_comb = (T0_in + f * LHV_H2 / CP) / (1.0 + f)\n        p0_comb = tau_comb * p0_in\n        \n        # Step 5: Nozzle analysis\n        T0_noz = T0_comb\n        p0_noz = tau_noz * p0_comb\n\n        # Step 6: Nozzle exit conditions (perfectly expanded nozzle)\n        p_e = p_inf\n        \n        # Check if expansion is possible\n        if p0_noz = p_e:\n            Me = 0.0\n            Ue = 0.0\n        else:\n            pressure_ratio = p0_noz / p_e\n            Me_sq = (2.0 / (GAMMA - 1.0)) * (pressure_ratio**((GAMMA - 1.0) / GAMMA) - 1.0)\n            Me = np.sqrt(Me_sq)\n            \n            Te = T0_noz / (1.0 + (GAMMA - 1.0) / 2.0 * Me**2)\n            Ue = Me * np.sqrt(GAMMA * R * Te)\n\n        # Step 7: Thrust and Specific Impulse calculation\n        thrust = m_dot_t * Ue - m_dot_a * U0\n        \n        if m_dot_f > 0:\n            Isp = thrust / (m_dot_f * G0)\n        else:\n            Isp = 0.0 # Or could be -inf or NaN depending on thrust, but phi > 0 here.\n\n        results.append(f\"{Isp:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}