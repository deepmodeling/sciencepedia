{
    "hands_on_practices": [
        {
            "introduction": "Our journey into scramjet modeling begins at the engine's inlet, where supersonic flow is compressed through a series of shock waves. A critical question in this process is how to treat the chemical state of the gas mixture as it traverses an extremely thin shock front. This practice challenges you to quantify the validity of the \"frozen chemistry\" assumption by comparing the fluid dynamic transit time with the chemical induction time, a fundamental analysis in high-speed reacting flows. ",
            "id": "4069664",
            "problem": "A planar, one-dimensional normal shock develops in the isolator of a Supersonic Combustion Ramjet (scramjet) with an incoming stoichiometric hydrogen–air mixture. Upstream of the shock, the mixture is at $T_1 = 300\\,\\mathrm{K}$, $p_1 = 1\\,\\mathrm{atm}$, and Mach number $M_1 = 3$. Model the mixture as an ideal gas. Take dry air to be $0.21$ mole fraction oxygen and $0.79$ mole fraction nitrogen, and add hydrogen such that oxygen is exactly stoichiometrically consumed according to $2\\,\\mathrm{H}_2 + \\mathrm{O}_2 \\rightarrow 2\\,\\mathrm{H}_2\\mathrm{O}$. Across the shock, assume either frozen chemistry (composition unchanged) or an erroneously assumed instantaneous chemical equilibrium at the same shock thickness. For frozen chemistry, treat the mixture as calorically perfect with heat capacity ratio $\\gamma_f = 1.40$. For the equilibrium-chemistry assumption, approximate an effective heat capacity ratio $\\gamma_{eq} = 1.30$ representative of high-temperature vibrational activation and incipient dissociation over the immediate post-shock state. The shock thickness is $L_s = 5.0 \\times 10^{-7}\\,\\mathrm{m}$. The universal gas constant is $R_u = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. For estimating reaction timescales, take a representative chemical induction time for hydrogen–air near the immediate post-shock conditions to be $\\tau_{chem} = 1.0 \\times 10^{-4}\\,\\mathrm{s}$.\n\nStarting from the conservation of mass, momentum, and energy across a stationary, planar, adiabatic, non-reactive normal shock for a calorically perfect ideal gas, derive the post-shock static temperature $T_2$ under frozen chemistry and the corresponding $T_2$ under the equilibrium-chemistry assumption (using $\\gamma_{eq}$). Then, define the fractional error incurred by assuming equilibrium chemistry across the same shock thickness as\n$$\\varepsilon \\equiv \\frac{T_{2,eq} - T_{2,f}}{T_{2,f}}.$$\nCompute $\\varepsilon$ as a pure decimal number. Round your final answer to four significant figures.\n\nIn your derivation, also estimate the flow transit time across the shock $\\tau_{flow} = L_s / u_1$ using $u_1 = M_1 a_1$ and $a_1 = \\sqrt{\\gamma_f R_m T_1}$, where $R_m = R_u / \\bar{M}$ is the mixture gas constant and $\\bar{M}$ is the mixture mean molecular weight implied by the stoichiometric composition above. Comment on the validity of the equilibrium assumption by comparing $\\tau_{flow}$ and $\\tau_{chem}$. Express $\\tau_{flow}$ in seconds. The requested final answer is $\\varepsilon$ as a decimal; do not include any units in the final answer box.",
            "solution": "The problem is first validated and found to be self-contained, scientifically grounded, and well-posed. We proceed with the solution.\n\nThe analysis begins by determining the properties of the stoichiometric hydrogen-air mixture. The combustion reaction is given as $2\\,\\mathrm{H}_2 + \\mathrm{O}_2 \\rightarrow 2\\,\\mathrm{H}_2\\mathrm{O}$. This indicates a molar ratio of $2$ moles of hydrogen ($\\mathrm{H}_2$) for every $1$ mole of oxygen ($\\mathrm{O}_2$). Dry air is specified to have a composition of $0.21$ mole fraction $\\mathrm{O}_2$ and $0.79$ mole fraction nitrogen ($\\mathrm{N}_2$).\n\nFor a basis of $1$ mole of air, we have $0.21$ moles of $\\mathrm{O}_2$ and $0.79$ moles of $\\mathrm{N}_2$. To achieve stoichiometric combustion, we must add $N_{\\mathrm{H}_2} = 2 \\times N_{\\mathrm{O}_2} = 2 \\times 0.21 = 0.42$ moles of $\\mathrm{H}_2$. The total number of moles in the unreacted mixture is $N_{mix} = N_{\\mathrm{H}_2} + N_{\\mathrm{O}_2} + N_{\\mathrm{N}_2} = 0.42 + 0.21 + 0.79 = 1.42$ moles.\n\nThe mole fractions ($X_i$) of the species in the upstream mixture are:\n$X_{\\mathrm{H}_2} = \\frac{0.42}{1.42}$\n$X_{\\mathrm{O}_2} = \\frac{0.21}{1.42}$\n$X_{\\mathrm{N}_2} = \\frac{0.79}{1.42}$\n\nThe mean molecular weight, $\\bar{M}$, of the mixture is the weighted average of the molecular weights of its components. Using the molecular weights $M_{\\mathrm{H}_2} \\approx 2.016 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$, $M_{\\mathrm{O}_2} \\approx 32.00 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$, and $M_{\\mathrm{N}_2} \\approx 28.01 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$:\n$$ \\bar{M} = X_{\\mathrm{H}_2} M_{\\mathrm{H}_2} + X_{\\mathrm{O}_2} M_{\\mathrm{O}_2} + X_{\\mathrm{N}_2} M_{\\mathrm{N}_2} $$\n$$ \\bar{M} = \\frac{1}{1.42} [0.42(2.016) + 0.21(32.00) + 0.79(28.01)] \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1} $$\n$$ \\bar{M} = \\frac{1}{1.42} [0.84672 + 6.72 + 22.1279] \\times 10^{-3} = \\frac{29.69462}{1.42} \\times 10^{-3} \\approx 0.020912\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1} $$\nThe mixture-specific gas constant, $R_m$, is given by $R_m = R_u / \\bar{M}$, where $R_u = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n$$ R_m = \\frac{8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}}{0.020912\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}} \\approx 397.55\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\nNext, we calculate the properties of the upstream flow. The speed of sound, $a_1$, in the upstream gas (state $1$) is $a_1 = \\sqrt{\\gamma_f R_m T_1}$. The frozen heat capacity ratio $\\gamma_f = 1.40$ is used as the incoming flow is unreacted. With $T_1 = 300\\,\\mathrm{K}$:\n$$ a_1 = \\sqrt{1.40 \\times 397.55\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\times 300\\,\\mathrm{K}} \\approx 408.62\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\nThe upstream flow velocity, $u_1$, is given by $u_1 = M_1 a_1$, where the Mach number is $M_1 = 3$:\n$$ u_1 = 3 \\times 408.62\\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 1225.86\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\nThe problem asks for an estimate of the flow transit time across the shock, $\\tau_{flow}$, given a shock thickness $L_s = 5.0 \\times 10^{-7}\\,\\mathrm{m}$:\n$$ \\tau_{flow} = \\frac{L_s}{u_1} = \\frac{5.0 \\times 10^{-7}\\,\\mathrm{m}}{1225.86\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx 4.08 \\times 10^{-10}\\,\\mathrm{s} $$\nWe are asked to compare this with the characteristic chemical induction time, $\\tau_{chem} = 1.0 \\times 10^{-4}\\,\\mathrm{s}$. The ratio $\\tau_{flow} / \\tau_{chem} \\approx 4 \\times 10^{-6} \\ll 1$. This vast separation of timescales indicates that the fluid particles traverse the shock structure much more rapidly than chemical reactions can proceed. Therefore, the assumption of frozen chemistry (composition unchanged) across the thin shock is physically sound. The alternative assumption of instantaneous chemical equilibrium across the shock is physically invalid, as it requires $\\tau_{chem} \\ll \\tau_{flow}$.\n\nThe relationship between the static temperatures upstream ($T_1$) and downstream ($T_2$) of a normal shock for a calorically perfect ideal gas is derived from the conservation of mass, momentum, and energy. It is given by:\n$$ \\frac{T_2}{T_1} = \\frac{[2\\gamma M_1^2 - (\\gamma-1)][(\\gamma-1)M_1^2 + 2]}{(\\gamma+1)^2 M_1^2} $$\nWe will use this relation for both scenarios.\n\nFirst, for frozen chemistry, we use $\\gamma = \\gamma_f = 1.40$ and $M_1 = 3$:\n$$ \\frac{T_{2,f}}{T_1} = \\frac{[2(1.40)(3^2) - (1.40-1)][(1.40-1)(3^2) + 2]}{(1.40+1)^2 (3^2)} $$\n$$ \\frac{T_{2,f}}{T_1} = \\frac{[2.80 \\times 9 - 0.40][0.40 \\times 9 + 2]}{(2.40)^2 \\times 9} = \\frac{[25.2 - 0.40][3.6 + 2]}{5.76 \\times 9} = \\frac{24.8 \\times 5.6}{51.84} = \\frac{138.88}{51.84} \\approx 2.6790 $$\nSo, $T_{2,f} = T_1 \\times 2.6790 = 300\\,\\mathrm{K} \\times 2.6790 \\approx 803.7\\,\\mathrm{K}$.\n\nSecond, for the erroneous equilibrium-chemistry assumption, we use the effective heat capacity ratio $\\gamma = \\gamma_{eq} = 1.30$, with the same upstream Mach number $M_1=3$:\n$$ \\frac{T_{2,eq}}{T_1} = \\frac{[2(1.30)(3^2) - (1.30-1)][(1.30-1)(3^2) + 2]}{(1.30+1)^2 (3^2)} $$\n$$ \\frac{T_{2,eq}}{T_1} = \\frac{[2.60 \\times 9 - 0.30][0.30 \\times 9 + 2]}{(2.30)^2 \\times 9} = \\frac{[23.4 - 0.30][2.7 + 2]}{5.29 \\times 9} = \\frac{23.1 \\times 4.7}{47.61} = \\frac{108.57}{47.61} \\approx 2.2804 $$\nSo, $T_{2,eq} = T_1 \\times 2.2804 = 300\\,\\mathrm{K} \\times 2.2804 \\approx 684.1\\,\\mathrm{K}$.\nThe lower effective $\\gamma_{eq}$ accounts for energy being absorbed by internal modes (vibration) at high temperatures, resulting in a lower post-shock temperature compared to the calorically perfect (frozen) gas model.\n\nFinally, we compute the fractional error $\\varepsilon$ incurred by this erroneous assumption:\n$$ \\varepsilon \\equiv \\frac{T_{2,eq} - T_{2,f}}{T_{2,f}} $$\nWe can compute this from the temperature ratios, as $T_1$ cancels out:\n$$ \\varepsilon = \\frac{T_{2,eq}/T_1 - T_{2,f}/T_1}{T_{2,f}/T_1} = \\frac{2.280403 - 2.679012}{2.679012} = \\frac{-0.398609}{2.679012} \\approx -0.148789 $$\nRounding to four significant figures, the fractional error is $-0.1488$.",
            "answer": "$$\n\\boxed{-0.1488}\n$$"
        },
        {
            "introduction": "Inside the combustor, efficient and rapid mixing of fuel and air is paramount for sustained supersonic combustion. The trajectory and penetration of a fuel jet injected into the supersonic crossflow are key design parameters that determine the overall effectiveness of the combustor. This exercise guides you through the derivation and application of a scaling law to predict fuel jet penetration, providing a powerful tool for the initial design and analysis of fuel injection strategies. ",
            "id": "4069674",
            "problem": "A round hydrogen jet issues sonic flow normal to the wall into a supersonic air crossflow within a scramjet combustor module. The air freestream has Mach number $M_{\\infty} = 2$, static temperature $T_{\\infty} = 700 \\ \\mathrm{K}$, static pressure $p_{\\infty} = 50 \\ \\mathrm{kPa}$, specific heat ratio $\\gamma_{\\text{air}} = 1.4$, and specific gas constant $R_{\\text{air}} = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$. The hydrogen jet is round with exit diameter $D = 1.0 \\ \\mathrm{mm}$ and injects with a jet-to-crossflow momentum flux ratio $J = \\left(\\rho_{j} U_{j}^{2}\\right)/\\left(\\rho_{\\infty} U_{\\infty}^{2}\\right) = 2.5$ based on the jet exit conditions and the air freestream. The local boundary layer thickness over the wall at the injection station is $\\delta = 5.0 \\ \\mathrm{mm}$. Consider a high-Reynolds-number regime where the jet deflection and scalar dispersion are dominated by the turbulent jet-in-crossflow interaction.\n\nStarting from conservation of momentum and dimensional analysis for a round jet injected into a supersonic crossflow, derive a trajectory scaling for the jet centerline $y(x)$ that depends only on $J$, $D$, the streamwise coordinate $x$, and a single order-one dimensionless coefficient $C$ that accounts for compressibility effects at $M_{\\infty} = 2$. For numerical evaluation, take $C = 0.5$.\n\nUsing the derived scaling, compute:\n1. The penetration height $y_{p}$ at a streamwise location $x = 10 \\, D$.\n2. The mixing length $L_{m}$ defined as the streamwise distance where the centerline reaches the boundary layer edge, i.e., $y(L_{m}) = \\delta$.\n3. An estimate of the scalar mixing time $\\tau_{s}$ taken as the convective residence time over $L_{m}$, i.e., $\\tau_{s} = L_{m} / U_{\\infty}$, where $U_{\\infty}$ is the air freestream speed.\n\nUse $U_{\\infty} = M_{\\infty} \\sqrt{\\gamma_{\\text{air}} R_{\\text{air}} T_{\\infty}}$ for the freestream speed. Round all requested numerical outputs to four significant figures. Express $y_{p}$ and $L_{m}$ in meters, and express $\\tau_{s}$ in milliseconds.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of fluid dynamics and supersonic flows, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. We can, therefore, proceed with the solution.\n\nThe problem requires the derivation of a scaling law for the trajectory of a jet injected into a crossflow, followed by numerical calculations based on this scaling.\n\n**Part 1: Derivation of the Jet Trajectory Scaling Law**\n\nThe trajectory of a round jet injected normally into a crossflow is determined by the interaction between the jet's initial momentum and the pressure forces exerted by the crossflow. A common approach to derive a scaling law for the jet centerline, $y(x)$, involves a simplified momentum balance.\n\nWe can model the phenomenon by equating the centrifugal force required to turn the jet's momentum flux with the drag-like pressure force the crossflow exerts on the jet column.\n\n1.  The jet is injected with a momentum flux, $\\dot{M}_j$, which is the product of mass flow rate and velocity, or equivalently, the product of momentum flux per unit area and the jet exit area, $A_j$.\n    $$ \\dot{M}_j = (\\rho_j U_j^2) A_j = (\\rho_j U_j^2) \\frac{\\pi D^2}{4} $$\n    where $\\rho_j$ and $U_j$ are the jet exit density and velocity, and $D$ is the jet diameter.\n\n2.  As the crossflow deflects the jet, the jet column follows a curved path with a local radius of curvature, $R$. The centrifugal force per unit length of the jet, $F'_c$, required to sustain this curvature is given by:\n    $$ F'_c = \\frac{\\dot{M}_j}{R} $$\n\n3.  The force that deflects the jet is the pressure force from the crossflow acting on the windward side of the jet. This force can be modeled as a drag force per unit length, $F'_p$, proportional to the crossflow dynamic pressure and the effective diameter of the jet. In the near-field of injection, this diameter is proportional to the jet exit diameter $D$.\n    $$ F'_p \\propto (\\rho_{\\infty} U_{\\infty}^2) D $$\n    where $\\rho_{\\infty}$ and $U_{\\infty}$ are the freestream density and velocity.\n\n4.  Equating the centrifugal force and the pressure force provides the balance that dictates the jet's path:\n    $$ \\frac{\\dot{M}_j}{R} \\propto (\\rho_{\\infty} U_{\\infty}^2) D $$\n    Substituting the expression for $\\dot{M}_j$:\n    $$ \\frac{(\\rho_j U_j^2) \\frac{\\pi D^2}{4}}{R} \\propto (\\rho_{\\infty} U_{\\infty}^2) D $$\n\n5.  Solving for the radius of curvature $R$:\n    $$ R \\propto \\frac{(\\rho_j U_j^2) D^2}{(\\rho_{\\infty} U_{\\infty}^2) D} = \\left(\\frac{\\rho_j U_j^2}{\\rho_{\\infty} U_{\\infty}^2}\\right) D $$\n    Using the definition of the momentum flux ratio, $J = \\left(\\rho_{j} U_{j}^{2}\\right)/\\left(\\rho_{\\infty} U_{\\infty}^{2}\\right)$, we find that the radius of curvature is proportional to $J$ and $D$:\n    $$ R \\propto J D $$\n\n6.  The radius of curvature for a function $y(x)$ is given by $R = \\frac{(1 + (y')^2)^{3/2}}{y''}$. For a jet injected normally, it is more convenient to describe the trajectory as $x(y)$. The radius of curvature is then $R = \\frac{(1 + (x')^2)^{3/2}}{x''}$. At the injection point ($y=0$), the jet is vertical, so its slope $dx/dy$ is zero, i.e., $x'(0) = 0$. The initial curvature is simply $k_0 = 1/R_0 = x''(0)$.\n    From our scaling, $R_0 \\propto JD$, so $x''(0) \\propto \\frac{1}{JD}$.\n\n7.  Assuming the curvature remains roughly constant in the initial region, we can approximate $x''(y) \\approx \\text{constant}$. Integrating twice with respect to $y$, with initial conditions $x(0) = 0$ and $x'(0) = 0$, yields:\n    $$ x(y) \\propto \\frac{1}{JD} y^2 $$\n\n8.  Solving for the penetration height $y$ as a function of streamwise distance $x$:\n    $$ y^2 \\propto JDx \\implies y(x) \\propto \\sqrt{JDx} $$\n\n9.  We introduce a single dimensionless, order-one coefficient $C$ to consolidate all constants of proportionality and to account for effects not captured in this simple model, such as compressibility. The final form of the scaling law is:\n    $$ y(x) = C \\sqrt{J D x} $$\n    This equation describes the jet centerline trajectory and depends on $J$, $D$, $x$, and the coefficient $C$, as required by the problem statement.\n\n**Part 2: Numerical Computations**\n\nWe are given the following values:\n-   Momentum flux ratio: $J = 2.5$\n-   Jet diameter: $D = 1.0 \\ \\mathrm{mm} = 1.0 \\times 10^{-3} \\ \\mathrm{m}$\n-   Boundary layer thickness: $\\delta = 5.0 \\ \\mathrm{mm} = 5.0 \\times 10^{-3} \\ \\mathrm{m}$\n-   Dimensionless coefficient: $C = 0.5$\n-   Freestream Mach number: $M_{\\infty} = 2$\n-   Freestream static temperature: $T_{\\infty} = 700 \\ \\mathrm{K}$\n-   Specific heat ratio of air: $\\gamma_{\\text{air}} = 1.4$\n-   Specific gas constant of air: $R_{\\text{air}} = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$\n\nThe derived trajectory scaling is $y(x) = C \\sqrt{J D x}$.\n\n**1. Penetration height $y_{p}$ at $x = 10 D$**\nThe streamwise location is $x = 10 \\times (1.0 \\times 10^{-3} \\ \\mathrm{m}) = 1.0 \\times 10^{-2} \\ \\mathrm{m}$.\nUsing the scaling law:\n$$ y_{p} = y(x=10D) = C \\sqrt{J D (10 D)} = C D \\sqrt{10 J} $$\nSubstituting the numerical values:\n$$ y_{p} = (0.5) (1.0 \\times 10^{-3}) \\sqrt{10 \\times 2.5} = (0.5 \\times 10^{-3}) \\sqrt{25} $$\n$$ y_{p} = (0.5 \\times 10^{-3}) \\times 5 = 2.5 \\times 10^{-3} \\ \\mathrm{m} $$\nRounded to four significant figures, $y_{p} = 2.500 \\times 10^{-3} \\ \\mathrm{m}$.\n\n**2. Mixing length $L_{m}$ where $y(L_{m}) = \\delta$**\nWe set $y(L_m) = \\delta$ in the scaling law and solve for $L_m$:\n$$ \\delta = C \\sqrt{J D L_m} $$\nSquaring both sides and rearranging for $L_m$:\n$$ \\delta^2 = C^2 J D L_m \\implies L_m = \\frac{\\delta^2}{C^2 J D} $$\nSubstituting the numerical values:\n$$ L_m = \\frac{(5.0 \\times 10^{-3})^2}{(0.5)^2 \\times 2.5 \\times (1.0 \\times 10^{-3})} = \\frac{25 \\times 10^{-6}}{0.25 \\times 2.5 \\times 10^{-3}} $$\n$$ L_m = \\frac{25 \\times 10^{-6}}{0.625 \\times 10^{-3}} = 40 \\times 10^{-3} \\ \\mathrm{m} $$\nRounded to four significant figures, $L_m = 4.000 \\times 10^{-2} \\ \\mathrm{m}$.\n\n**3. Scalar mixing time $\\tau_{s} = L_{m} / U_{\\infty}$**\nFirst, we must compute the freestream speed $U_{\\infty}$. The speed of sound in the freestream is $a_{\\infty} = \\sqrt{\\gamma_{\\text{air}} R_{\\text{air}} T_{\\infty}}$. The freestream velocity is $U_{\\infty} = M_{\\infty} a_{\\infty}$.\n$$ U_{\\infty} = M_{\\infty} \\sqrt{\\gamma_{\\text{air}} R_{\\text{air}} T_{\\infty}} $$\nSubstituting the numerical values:\n$$ U_{\\infty} = 2 \\sqrt{1.4 \\times 287 \\times 700} = 2 \\sqrt{281260} \\approx 2 \\times 530.3395 \\ \\mathrm{m/s} \\approx 1060.679 \\ \\mathrm{m/s} $$\nNow, we compute the scalar mixing time $\\tau_s$:\n$$ \\tau_{s} = \\frac{L_{m}}{U_{\\infty}} = \\frac{4.000 \\times 10^{-2} \\ \\mathrm{m}}{1060.679 \\ \\mathrm{m/s}} \\approx 3.77119 \\times 10^{-5} \\ \\mathrm{s} $$\nThe problem requests the answer in milliseconds ($1 \\ \\mathrm{ms} = 10^{-3} \\ \\mathrm{s}$):\n$$ \\tau_{s} = (3.77119 \\times 10^{-5}) \\times 10^3 \\ \\mathrm{ms} = 0.0377119 \\ \\mathrm{ms} $$\nRounding to four significant figures, $\\tau_{s} = 0.03771 \\ \\mathrm{ms}$.\n\nThe computed values are:\n1.  Penetration height $y_{p} = 2.500 \\times 10^{-3} \\ \\mathrm{m}$.\n2.  Mixing length $L_{m} = 4.000 \\times 10^{-2} \\ \\mathrm{m}$.\n3.  Scalar mixing time $\\tau_{s} = 0.03771 \\ \\mathrm{ms}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.500 \\times 10^{-3}  4.000 \\times 10^{-2}  0.03771 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Having examined key phenomena in the inlet and combustor, we now integrate these concepts to evaluate the performance of the entire scramjet engine system. The ultimate measure of an air-breathing engine's efficiency is its Specific Impulse ($I_{sp}$). This capstone exercise requires you to construct a quasi-one-dimensional model of a complete scramjet, accounting for performance losses in each component, to calculate the overall thrust and $I_{sp}$. ",
            "id": "4069676",
            "problem": "A Supersonic Combustion Ramjet (scramjet) operates by ingesting atmospheric air at supersonic speed, adding fuel, and expanding the hot product gases through a nozzle to produce thrust. Your task is to implement a quasi-one-dimensional computational model to compute the Specific Impulse (Isp) for a hydrogen-fueled scramjet at several flight conditions. The final answer must be a single runnable program that produces the requested outputs exactly.\n\nUse a principled derivation that starts from the conservation of mass, conservation of momentum, and conservation of energy, together with standard compressible flow relations for a calorically perfect gas. Throughout, treat the mixture as a calorically perfect gas with constant ratio of specific heats $\\gamma$, constant specific gas constant $R$, and constant specific heat at constant pressure $c_p$. Let the flow be adiabatic except for chemical heat release in the combustor. Model the inlet, combustor, and nozzle as quasi-one-dimensional components with measured total pressure losses. Assume perfectly expanded nozzle exit such that the exit static pressure equals the ambient static pressure. Neglect viscous drag and pressure thrust terms when the exit pressure equals ambient. Assume complete mixing and complete reaction of hydrogen with air at the specified equivalence ratio.\n\nDefinitions and constants to be used:\n- Specific Impulse (Isp) is defined as $I_{sp} = \\dfrac{F}{\\dot{m}_f g_0}$, where $F$ is thrust in $\\mathrm{N}$, $\\dot{m}_f$ is fuel mass flow rate in $\\mathrm{kg\\,s^{-1}}$, and $g_0$ is standard gravity in $\\mathrm{m\\,s^{-2}}$.\n- Let the freestream static pressure, temperature, and Mach number be $p_\\infty$, $T_\\infty$, and $M_0$.\n- The inlet capture area is $A_c$ in $\\mathrm{m^2}$.\n- The total pressure loss ratios for the inlet, combustor, and nozzle are $\\tau_{\\mathrm{in}}$, $\\tau_{\\mathrm{comb}}$, and $\\tau_{\\mathrm{noz}}$, respectively. These are dimensionless and satisfy $0  \\tau  1$.\n- The fuel-air equivalence ratio is $\\phi$, dimensionless. For hydrogen fuel, use stoichiometric fuel-to-air mass ratio $f_{\\mathrm{st}} = 1/34.48$ (approximately $0.0290$). Then the fuel-to-air mass ratio is $f = \\phi f_{\\mathrm{st}}$.\n- Use $\\gamma = 1.4$, $R = 287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $c_p = \\dfrac{\\gamma R}{\\gamma - 1}$, $g_0 = 9.80665\\ \\mathrm{m\\,s^{-2}}$.\n- Use the lower heating value of hydrogen $LHV = 1.2 \\times 10^8\\ \\mathrm{J\\,kg^{-1}}$.\n\nModeling requirements to implement:\n1. Determine the freestream speed $U_0$ from $M_0$ and $T_\\infty$, and the freestream density $\\rho_\\infty$ from $p_\\infty$ and $T_\\infty$. Determine the ingested air mass flow $\\dot{m}_a = \\rho_\\infty U_0 A_c$ in $\\mathrm{kg\\,s^{-1}}$.\n2. Compute the freestream stagnation temperature and pressure $(T_{0,\\mathrm{free}}, p_{0,\\mathrm{free}})$ using isentropic relations. Apply the inlet total pressure loss ratio to obtain $p_{0,\\mathrm{in}} = \\tau_{\\mathrm{in}} p_{0,\\mathrm{free}}$, and assume $T_{0,\\mathrm{in}} = T_{0,\\mathrm{free}}$.\n3. Compute the fuel mass flow $\\dot{m}_f = f \\dot{m}_a$ and the total mass flow $\\dot{m}_t = \\dot{m}_a + \\dot{m}_f$.\n4. Use conservation of energy across the combustor to obtain the combustor exit stagnation temperature $T_{0,\\mathrm{comb}}$ based on chemical heat release and mixing. Apply the combustor total pressure loss ratio to obtain $p_{0,\\mathrm{comb}} = \\tau_{\\mathrm{comb}} p_{0,\\mathrm{in}}$.\n5. Apply the nozzle total pressure loss ratio to obtain the nozzle stagnation pressure $p_{0,\\mathrm{noz}} = \\tau_{\\mathrm{noz}} p_{0,\\mathrm{comb}}$ and assume $T_{0,\\mathrm{noz}} = T_{0,\\mathrm{comb}}$.\n6. For a perfectly expanded exit, set $p_e = p_\\infty$ and determine the exit Mach number $M_e$ from $p_{0,\\mathrm{noz}}$ and $p_e$ using isentropic relations. If $p_{0,\\mathrm{noz}} \\le p_\\infty$, set $M_e = 0$. Compute exit static temperature $T_e$ and exit velocity $U_e$.\n7. Compute thrust $F = \\dot{m}_t U_e - \\dot{m}_a U_0$ and then compute $I_{sp} = \\dfrac{F}{\\dot{m}_f g_0}$ in $\\mathrm{s}$. If the thrust is negative, $I_{sp}$ will be negative accordingly. Express all final $I_{sp}$ values in $\\mathrm{s}$.\n\nYour program must evaluate the following five test cases. Each test case specifies $(M_0, p_\\infty, T_\\infty, A_c, \\tau_{\\mathrm{in}}, \\tau_{\\mathrm{comb}}, \\tau_{\\mathrm{noz}}, \\phi)$:\n\n- Test case $1$: $M_0 = 6.0$, $p_\\infty = 2511\\ \\mathrm{Pa}$, $T_\\infty = 223.0\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.90$, $\\tau_{\\mathrm{comb}} = 0.60$, $\\tau_{\\mathrm{noz}} = 0.95$, $\\phi = 0.50$.\n- Test case $2$: $M_0 = 5.0$, $p_\\infty = 5474\\ \\mathrm{Pa}$, $T_\\infty = 216.65\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.80$, $\\tau_{\\mathrm{comb}} = 0.40$, $\\tau_{\\mathrm{noz}} = 0.90$, $\\phi = 0.30$.\n- Test case $3$ (near-expansion boundary): $M_0 = 2.0$, $p_\\infty = 35651\\ \\mathrm{Pa}$, $T_\\infty = 236.65\\ \\mathrm{K}$, $A_c = 0.3\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.85$, $\\tau_{\\mathrm{comb}} = 0.30$, $\\tau_{\\mathrm{noz}} = 0.70$, $\\phi = 0.15$.\n- Test case $4$ (high heat addition): $M_0 = 7.5$, $p_\\infty = 1197\\ \\mathrm{Pa}$, $T_\\infty = 226.5\\ \\mathrm{K}$, $A_c = 0.7\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.92$, $\\tau_{\\mathrm{comb}} = 0.65$, $\\tau_{\\mathrm{noz}} = 0.97$, $\\phi = 0.90$.\n- Test case $5$ (lean case): $M_0 = 5.5$, $p_\\infty = 5474\\ \\mathrm{Pa}$, $T_\\infty = 216.65\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.88$, $\\tau_{\\mathrm{comb}} = 0.50$, $\\tau_{\\mathrm{noz}} = 0.93$, $\\phi = 0.10$.\n\nAngle units are not used in this problem. Physical units must be respected, and the final requested quantity must be returned in seconds ($\\mathrm{s}$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order of the test cases above. Each entry must be a floating-point number representing $I_{sp}$ in $\\mathrm{s}$, rounded to three decimal places, for example, $\\left[1234.567,2345.678,3456.789,4567.890,5678.901\\right]$.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of thermodynamics and compressible fluid dynamics, well-posed with a clear and complete set of instructions and data, and objective in its formulation. We will now proceed with a principled derivation of the solution.\n\nThe objective is to compute the specific impulse, $I_{sp}$, of a hydrogen-fueled scramjet for several flight conditions using a quasi-one-dimensional flow model. The model treats the engine as a series of components—inlet, combustor, and nozzle—and analyzes the changes in fluid properties across them.\n\n**1. Freestream Conditions and Air Mass Flow**\nThe analysis begins with the freestream conditions: Mach number $M_0$, static pressure $p_\\infty$, and static temperature $T_\\infty$. The freestream air velocity, $U_0$, is determined from the definition of Mach number, assuming air is a calorically perfect gas with a specific gas constant $R$ and ratio of specific heats $\\gamma$.\n$$U_0 = M_0 a_0 = M_0 \\sqrt{\\gamma R T_\\infty}$$\nThe freestream air density, $\\rho_\\infty$, is found using the ideal gas law:\n$$\\rho_\\infty = \\frac{p_\\infty}{R T_\\infty}$$\nThe engine captures air over an inlet area $A_c$. The mass flow rate of the ingested air, $\\dot{m}_a$, is given by:\n$$\\dot{m}_a = \\rho_\\infty U_0 A_c$$\n\n**2. Inlet Compression**\nThe inlet compresses the incoming air, increasing its pressure and temperature. The process is assumed to be adiabatic, so the stagnation temperature remains constant. The freestream stagnation properties, $T_{0,\\mathrm{free}}$ and $p_{0,\\mathrm{free}}$, are calculated using isentropic flow relations:\n$$T_{0,\\mathrm{free}} = T_\\infty \\left(1 + \\frac{\\gamma-1}{2} M_0^2\\right)$$\n$$p_{0,\\mathrm{free}} = p_\\infty \\left(1 + \\frac{\\gamma-1}{2} M_0^2\\right)^{\\frac{\\gamma}{\\gamma-1}}$$\nDue to the adiabatic assumption for the inlet, the stagnation temperature at the inlet exit is unchanged:\n$$T_{0,\\mathrm{in}} = T_{0,\\mathrm{free}}$$\nThe irreversible effects in the inlet, such as shock waves and friction, cause a loss in total pressure, which is quantified by the inlet total pressure recovery factor $\\tau_{\\mathrm{in}}$:\n$$p_{0,\\mathrm{in}} = \\tau_{\\mathrm{in}} p_{0,\\mathrm{free}}$$\n\n**3. Fuel Addition and Total Mass Flow**\nFuel is added to the compressed air stream. The fuel-to-air mass ratio, $f$, is defined based on the specified equivalence ratio, $\\phi$, and the stoichiometric fuel-to-air ratio for hydrogen, $f_{\\mathrm{st}}$:\n$$f = \\phi f_{\\mathrm{st}}$$\nThe mass flow rate of the fuel, $\\dot{m}_f$, is:\n$$\\dot{m}_f = f \\dot{m}_a$$\nThe total mass flow rate, $\\dot{m}_t$, through the subsequent components is the sum of the air and fuel mass flow rates:\n$$\\dot{m}_t = \\dot{m}_a + \\dot{m}_f = \\dot{m}_a (1 + f)$$\n\n**4. Combustor Heat Addition**\nIn the combustor, the fuel burns, releasing chemical energy and significantly increasing the stagnation temperature of the flow. Applying the steady-flow energy equation between the combustor inlet and exit, we account for the heat released by the combustion of fuel, defined by its lower heating value, $LHV$.\n$$\\dot{m}_a h_{0,\\mathrm{in}} + \\dot{m}_f LHV = \\dot{m}_t h_{0,\\mathrm{comb}}$$\nAssuming a calorically perfect gas with constant specific heat at constant pressure $c_p$ for both the incoming air and the exiting combustion products, we can write $h_0 = c_p T_0$.\n$$\\dot{m}_a c_p T_{0,\\mathrm{in}} + \\dot{m}_f LHV = (\\dot{m}_a + \\dot{m}_f) c_p T_{0,\\mathrm{comb}}$$\nThe value of $c_p$ is determined from the gas properties: $c_p = \\frac{\\gamma R}{\\gamma - 1}$. Solving for the combustor exit stagnation temperature, $T_{0,\\mathrm{comb}}$, yields:\n$$T_{0,\\mathrm{comb}} = \\frac{\\dot{m}_a c_p T_{0,\\mathrm{in}} + \\dot{m}_f LHV}{(\\dot{m}_a + \\dot{m}_f) c_p} = \\frac{T_{0,\\mathrm{in}} + f \\frac{LHV}{c_p}}{1+f}$$\nCombustion and mixing are highly irreversible processes, resulting in a substantial loss of total pressure. This is modeled by the combustor total pressure loss ratio, $\\tau_{\\mathrm{comb}}$:\n$$p_{0,\\mathrm{comb}} = \\tau_{\\mathrm{comb}} p_{0,\\mathrm{in}}$$\n\n**5. Nozzle Flow**\nThe hot, high-pressure gas from the combustor expands through the nozzle. This expansion process is assumed to be adiabatic, so the stagnation temperature is conserved:\n$$T_{0,\\mathrm{noz}} = T_{0,\\mathrm{comb}}$$\nSimilar to the other components, the nozzle has frictional and other losses, accounted for by the nozzle total pressure recovery factor, $\\tau_{\\mathrm{noz}}$:\n$$p_{0,\\mathrm{noz}} = \\tau_{\\mathrm{noz}} p_{0,\\mathrm{comb}}$$\n\n**6. Nozzle Exit Conditions**\nThe problem specifies a \"perfectly expanded\" nozzle, where the exit static pressure, $p_e$, matches the ambient freestream pressure, $p_\\infty$.\n$$p_e = p_\\infty$$\nThe nozzle exit Mach number, $M_e$, can be determined from the isentropic pressure relation between the nozzle stagnation state and the exit static state:\n$$\\frac{p_{0,\\mathrm{noz}}}{p_e} = \\left(1 + \\frac{\\gamma-1}{2} M_e^2\\right)^{\\frac{\\gamma}{\\gamma-1}}$$\nThis equation can be inverted to solve for $M_e$:\n$$M_e = \\sqrt{\\frac{2}{\\gamma-1} \\left[ \\left(\\frac{p_{0,\\mathrm{noz}}}{p_e}\\right)^{\\frac{\\gamma-1}{\\gamma}} - 1 \\right]}$$\nFor a physically meaningful expansion, the nozzle stagnation pressure must be greater than the exit pressure ($p_{0,\\mathrm{noz}} > p_e$). If $p_{0,\\mathrm{noz}} \\le p_e$, the flow cannot expand to a velocity greater than zero to match the back-pressure, so we set $M_e = 0$, which implies an exit velocity $U_e=0$.\nWith $M_e$ determined, the exit static temperature $T_e$ and exit velocity $U_e$ are found:\n$$T_e = \\frac{T_{0,\\mathrm{noz}}}{1 + \\frac{\\gamma-1}{2} M_e^2}$$\n$$U_e = M_e \\sqrt{\\gamma R T_e}$$\n\n**7. Thrust and Specific Impulse**\nThe thrust, $F$, is the net force produced by the engine. For a perfectly expanded nozzle, the pressure thrust term is zero, and the gross thrust is determined by the momentum change of the working fluid. The ram drag is the momentum of the incoming air. The net thrust is given by:\n$$F = \\dot{m}_t U_e - \\dot{m}_a U_0$$\nFinally, the specific impulse, $I_{sp}$, which measures the efficiency of propellant utilization, is defined as the thrust per unit weight flow rate of fuel. Standard gravity, $g_0$, is used to convert the fuel mass flow rate to a weight flow rate.\n$$I_{sp} = \\frac{F}{\\dot{m}_f g_0}$$\nThe resulting unit for $I_{sp}$ is seconds ($\\mathrm{s}$). A negative thrust will result in a negative specific impulse, indicating that the engine is producing net drag. These equations are implemented for each test case to determine the performance.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Specific Impulse (Isp) for a hydrogen-fueled scramjet\n    using a quasi-one-dimensional model for a given set of test cases.\n    \"\"\"\n    \n    # Define physical and gas constants\n    GAMMA = 1.4  # Ratio of specific heats\n    R = 287.0  # Specific gas constant for air (J/kg-K)\n    G0 = 9.80665  # Standard gravity (m/s^2)\n    LHV_H2 = 1.2e8  # Lower Heating Value of hydrogen (J/kg)\n    F_ST_H2 = 1.0 / 34.48  # Stoichiometric fuel-to-air ratio for hydrogen\n\n    # Derived constant: specific heat at constant pressure\n    CP = GAMMA * R / (GAMMA - 1.0)\n\n    # Each test case is a tuple:\n    # (M0, p_inf, T_inf, A_c, tau_in, tau_comb, tau_noz, phi)\n    test_cases = [\n        (6.0, 2511.0, 223.0, 0.5, 0.90, 0.60, 0.95, 0.50),\n        (5.0, 5474.0, 216.65, 0.5, 0.80, 0.40, 0.90, 0.30),\n        (2.0, 35651.0, 236.65, 0.3, 0.85, 0.30, 0.70, 0.15),\n        (7.5, 1197.0, 226.5, 0.7, 0.92, 0.65, 0.97, 0.90),\n        (5.5, 5474.0, 216.65, 0.5, 0.88, 0.50, 0.93, 0.10),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M0, p_inf, T_inf, A_c, tau_in, tau_comb, tau_noz, phi = case\n\n        # Step 1: Freestream conditions and air mass flow\n        U0 = M0 * np.sqrt(GAMMA * R * T_inf)\n        rho_inf = p_inf / (R * T_inf)\n        m_dot_a = rho_inf * U0 * A_c\n\n        # Step 2: Inlet analysis\n        T0_free = T_inf * (1.0 + (GAMMA - 1.0) / 2.0 * M0**2)\n        p0_free = p_inf * (1.0 + (GAMMA - 1.0) / 2.0 * M0**2)**(GAMMA / (GAMMA - 1.0))\n        \n        T0_in = T0_free\n        p0_in = tau_in * p0_free\n\n        # Step 3: Fuel injection and total mass flow\n        f = phi * F_ST_H2\n        m_dot_f = f * m_dot_a\n        m_dot_t = m_dot_a + m_dot_f\n\n        # Step 4: Combustor analysis\n        T0_comb = (T0_in + f * LHV_H2 / CP) / (1.0 + f)\n        p0_comb = tau_comb * p0_in\n        \n        # Step 5: Nozzle analysis\n        T0_noz = T0_comb\n        p0_noz = tau_noz * p0_comb\n\n        # Step 6: Nozzle exit conditions (perfectly expanded nozzle)\n        p_e = p_inf\n        \n        # Check if expansion is possible\n        if p0_noz = p_e:\n            Me = 0.0\n            Ue = 0.0\n        else:\n            pressure_ratio = p0_noz / p_e\n            Me_sq = (2.0 / (GAMMA - 1.0)) * (pressure_ratio**((GAMMA - 1.0) / GAMMA) - 1.0)\n            Me = np.sqrt(Me_sq)\n            \n            Te = T0_noz / (1.0 + (GAMMA - 1.0) / 2.0 * Me**2)\n            Ue = Me * np.sqrt(GAMMA * R * Te)\n\n        # Step 7: Thrust and Specific Impulse calculation\n        thrust = m_dot_t * Ue - m_dot_a * U0\n        \n        if m_dot_f  0:\n            Isp = thrust / (m_dot_f * G0)\n        else:\n            Isp = 0.0 # Or could be -inf or NaN depending on thrust, but phi  0 here.\n\n        results.append(f\"{Isp:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}