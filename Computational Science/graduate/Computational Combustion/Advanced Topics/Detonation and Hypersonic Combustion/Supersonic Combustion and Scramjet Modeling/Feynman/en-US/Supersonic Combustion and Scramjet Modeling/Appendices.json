{
    "hands_on_practices": [
        {
            "introduction": "Shocks are unavoidable features in the inlets and isolators of scramjets, and a critical modeling question is how to treat chemical reactions across these extremely thin discontinuities. This exercise  delves into this question by comparing the flow transit time across a shock with the characteristic time of chemical reactions. This comparison provides a quantitative basis for choosing between a \"frozen\" or \"equilibrium\" chemistry model, a fundamental decision in supersonic combustion simulation.",
            "id": "4069664",
            "problem": "A planar, one-dimensional normal shock develops in the isolator of a Supersonic Combustion Ramjet (scramjet) with an incoming stoichiometric hydrogen–air mixture. Upstream of the shock, the mixture is at $T_1 = 300\\,\\mathrm{K}$, $p_1 = 1\\,\\mathrm{atm}$, and Mach number $M_1 = 3$. Model the mixture as an ideal gas. Take dry air to be $0.21$ mole fraction oxygen and $0.79$ mole fraction nitrogen, and add hydrogen such that oxygen is exactly stoichiometrically consumed according to $2\\,\\mathrm{H}_2 + \\mathrm{O}_2 \\rightarrow 2\\,\\mathrm{H}_2\\mathrm{O}$. Across the shock, assume either frozen chemistry (composition unchanged) or an erroneously assumed instantaneous chemical equilibrium at the same shock thickness. For frozen chemistry, treat the mixture as calorically perfect with heat capacity ratio $\\gamma_f = 1.40$. For the equilibrium-chemistry assumption, approximate an effective heat capacity ratio $\\gamma_{eq} = 1.30$ representative of high-temperature vibrational activation and incipient dissociation over the immediate post-shock state. The shock thickness is $L_s = 5.0 \\times 10^{-7}\\,\\mathrm{m}$. The universal gas constant is $R_u = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. For estimating reaction timescales, take a representative chemical induction time for hydrogen–air near the immediate post-shock conditions to be $\\tau_{chem} = 1.0 \\times 10^{-4}\\,\\mathrm{s}$.\n\nStarting from the conservation of mass, momentum, and energy across a stationary, planar, adiabatic, non-reactive normal shock for a calorically perfect ideal gas, derive the post-shock static temperature $T_2$ under frozen chemistry and the corresponding $T_2$ under the equilibrium-chemistry assumption (using $\\gamma_{eq}$). Then, define the fractional error incurred by assuming equilibrium chemistry across the same shock thickness as\n$$\\varepsilon \\equiv \\frac{T_{2,eq} - T_{2,f}}{T_{2,f}}.$$\nCompute $\\varepsilon$ as a pure decimal number. Round your final answer to four significant figures.\n\nIn your derivation, also estimate the flow transit time across the shock $\\tau_{flow} = L_s / u_1$ using $u_1 = M_1 a_1$ and $a_1 = \\sqrt{\\gamma_f R_m T_1}$, where $R_m = R_u / \\bar{M}$ is the mixture gas constant and $\\bar{M}$ is the mixture mean molecular weight implied by the stoichiometric composition above. Comment on the validity of the equilibrium assumption by comparing $\\tau_{flow}$ and $\\tau_{chem}$. Express $\\tau_{flow}$ in seconds. The requested final answer is $\\varepsilon$ as a decimal; do not include any units in the final answer box.",
            "solution": "The problem is first validated and found to be self-contained, scientifically grounded, and well-posed. We proceed with the solution.\n\nThe analysis begins by determining the properties of the stoichiometric hydrogen-air mixture. The combustion reaction is given as $2\\,\\mathrm{H}_2 + \\mathrm{O}_2 \\rightarrow 2\\,\\mathrm{H}_2\\mathrm{O}$. This indicates a molar ratio of $2$ moles of hydrogen ($\\mathrm{H}_2$) for every $1$ mole of oxygen ($\\mathrm{O}_2$). Dry air is specified to have a composition of $0.21$ mole fraction $\\mathrm{O}_2$ and $0.79$ mole fraction nitrogen ($\\mathrm{N}_2$).\n\nFor a basis of $1$ mole of air, we have $0.21$ moles of $\\mathrm{O}_2$ and $0.79$ moles of $\\mathrm{N}_2$. To achieve stoichiometric combustion, we must add $N_{\\mathrm{H}_2} = 2 \\times N_{\\mathrm{O}_2} = 2 \\times 0.21 = 0.42$ moles of $\\mathrm{H}_2$. The total number of moles in the unreacted mixture is $N_{mix} = N_{\\mathrm{H}_2} + N_{\\mathrm{O}_2} + N_{\\mathrm{N}_2} = 0.42 + 0.21 + 0.79 = 1.42$ moles.\n\nThe mole fractions ($X_i$) of the species in the upstream mixture are:\n$X_{\\mathrm{H}_2} = \\frac{0.42}{1.42}$\n$X_{\\mathrm{O}_2} = \\frac{0.21}{1.42}$\n$X_{\\mathrm{N}_2} = \\frac{0.79}{1.42}$\n\nThe mean molecular weight, $\\bar{M}$, of the mixture is the weighted average of the molecular weights of its components. Using the molecular weights $M_{\\mathrm{H}_2} \\approx 2.016 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$, $M_{\\mathrm{O}_2} \\approx 32.00 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$, and $M_{\\mathrm{N}_2} \\approx 28.01 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$:\n$$ \\bar{M} = X_{\\mathrm{H}_2} M_{\\mathrm{H}_2} + X_{\\mathrm{O}_2} M_{\\mathrm{O}_2} + X_{\\mathrm{N}_2} M_{\\mathrm{N}_2} $$\n$$ \\bar{M} = \\frac{1}{1.42} [0.42(2.016) + 0.21(32.00) + 0.79(28.01)] \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1} $$\n$$ \\bar{M} = \\frac{1}{1.42} [0.84672 + 6.72 + 22.1279] \\times 10^{-3} = \\frac{29.69462}{1.42} \\times 10^{-3} \\approx 0.020912\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1} $$\nThe mixture-specific gas constant, $R_m$, is given by $R_m = R_u / \\bar{M}$, where $R_u = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n$$ R_m = \\frac{8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}}{0.020912\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}} \\approx 397.55\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n\nNext, we calculate the properties of the upstream flow. The speed of sound, $a_1$, in the upstream gas (state $1$) is $a_1 = \\sqrt{\\gamma_f R_m T_1}$. The frozen heat capacity ratio $\\gamma_f = 1.40$ is used as the incoming flow is unreacted. With $T_1 = 300\\,\\mathrm{K}$:\n$$ a_1 = \\sqrt{1.40 \\times 397.55\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\times 300\\,\\mathrm{K}} \\approx 408.62\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\nThe upstream flow velocity, $u_1$, is given by $u_1 = M_1 a_1$, where the Mach number is $M_1 = 3$:\n$$ u_1 = 3 \\times 408.62\\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 1225.86\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\nThe problem asks for an estimate of the flow transit time across the shock, $\\tau_{flow}$, given a shock thickness $L_s = 5.0 \\times 10^{-7}\\,\\mathrm{m}$:\n$$ \\tau_{flow} = \\frac{L_s}{u_1} = \\frac{5.0 \\times 10^{-7}\\,\\mathrm{m}}{1225.86\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx 4.08 \\times 10^{-10}\\,\\mathrm{s} $$\nWe are asked to compare this with the characteristic chemical induction time, $\\tau_{chem} = 1.0 \\times 10^{-4}\\,\\mathrm{s}$. The ratio $\\tau_{flow} / \\tau_{chem} \\approx 4 \\times 10^{-6} \\ll 1$. This vast separation of timescales indicates that the fluid particles traverse the shock structure much more rapidly than chemical reactions can proceed. Therefore, the assumption of frozen chemistry (composition unchanged) across the thin shock is physically sound. The alternative assumption of instantaneous chemical equilibrium across the shock is physically invalid, as it requires $\\tau_{chem} \\ll \\tau_{flow}$.\n\nThe relationship between the static temperatures upstream ($T_1$) and downstream ($T_2$) of a normal shock for a calorically perfect ideal gas is derived from the conservation of mass, momentum, and energy. It is given by:\n$$ \\frac{T_2}{T_1} = \\frac{[2\\gamma M_1^2 - (\\gamma-1)][(\\gamma-1)M_1^2 + 2]}{(\\gamma+1)^2 M_1^2} $$\nWe will use this relation for both scenarios.\n\nFirst, for frozen chemistry, we use $\\gamma = \\gamma_f = 1.40$ and $M_1 = 3$:\n$$ \\frac{T_{2,f}}{T_1} = \\frac{[2(1.40)(3^2) - (1.40-1)][(1.40-1)(3^2) + 2]}{(1.40+1)^2 (3^2)} $$\n$$ \\frac{T_{2,f}}{T_1} = \\frac{[2.80 \\times 9 - 0.40][0.40 \\times 9 + 2]}{(2.40)^2 \\times 9} = \\frac{[25.2 - 0.40][3.6 + 2]}{5.76 \\times 9} = \\frac{24.8 \\times 5.6}{51.84} = \\frac{138.88}{51.84} \\approx 2.6790 $$\nSo, $T_{2,f} = T_1 \\times 2.6790 = 300\\,\\mathrm{K} \\times 2.6790 \\approx 803.7\\,\\mathrm{K}$.\n\nSecond, for the erroneous equilibrium-chemistry assumption, we use the effective heat capacity ratio $\\gamma = \\gamma_{eq} = 1.30$, with the same upstream Mach number $M_1=3$:\n$$ \\frac{T_{2,eq}}{T_1} = \\frac{[2(1.30)(3^2) - (1.30-1)][(1.30-1)(3^2) + 2]}{(1.30+1)^2 (3^2)} $$\n$$ \\frac{T_{2,eq}}{T_1} = \\frac{[2.60 \\times 9 - 0.30][0.30 \\times 9 + 2]}{(2.30)^2 \\times 9} = \\frac{[23.4 - 0.30][2.7 + 2]}{5.29 \\times 9} = \\frac{23.1 \\times 4.7}{47.61} = \\frac{108.57}{47.61} \\approx 2.2804 $$\nSo, $T_{2,eq} = T_1 \\times 2.2804 = 300\\,\\mathrm{K} \\times 2.2804 \\approx 684.1\\,\\mathrm{K}$.\nThe lower effective $\\gamma_{eq}$ accounts for energy being absorbed by internal modes (vibration) at high temperatures, resulting in a lower post-shock temperature compared to the calorically perfect (frozen) gas model.\n\nFinally, we compute the fractional error $\\varepsilon$ incurred by this erroneous assumption:\n$$ \\varepsilon \\equiv \\frac{T_{2,eq} - T_{2,f}}{T_{2,f}} $$\nWe can compute this from the temperature ratios, as $T_1$ cancels out:\n$$ \\varepsilon = \\frac{T_{2,eq}/T_1 - T_{2,f}/T_1}{T_{2,f}/T_1} = \\frac{2.280403 - 2.679012}{2.679012} = \\frac{-0.398609}{2.679012} \\approx -0.148789 $$\nRounding to four significant figures, the fractional error is $-0.1488$.",
            "answer": "$$\n\\boxed{-0.1488}\n$$"
        },
        {
            "introduction": "Simulating the complex physics of scramjets introduces significant computational challenges, particularly the vast difference in timescales between fluid motion and chemical reactions, a phenomenon known as stiffness. This problem  explores the practical implications of this stiffness by deriving the stability constraints for explicit numerical schemes based on both the Courant–Friedrichs–Lewy (CFL) condition and chemical kinetics. You will also evaluate the performance advantage of advanced techniques like dual time-stepping, which are essential for making steady-state simulations of stiff systems computationally feasible.",
            "id": "4069709",
            "problem": "A one-dimensional model of a reacting supersonic stream in a constant-area section of a supersonic combustion ramjet (scramjet) combustor is considered. The mixture is modeled as a calorically imperfect but thermally perfect ideal gas with ratio of specific heats $\\gamma$, gas constant for air $R$, and temperature $T$. The flow Mach number is $M$, and the finite-volume mesh has uniform spacing $\\Delta x$. The hyperbolic convective operator is advanced in physical time by an explicit scheme using a target Courant–Friedrichs–Lewy (CFL) number $C_{\\text{exp}}$. Chemical kinetics in the combustor are represented near the operating point by a single progress variable $c$ whose source term linearization yields $dc/dt = -k\\,c$, with $k$ approximated by an Arrhenius form $k = A \\exp\\!\\big(-E_{a}/(R_{u} T)\\big)$, where $A$ is the pre-exponential factor, $E_{a}$ is the activation energy, and $R_{u}$ is the universal gas constant.\n\nUse the following parameters, which are representative of scramjet combustor conditions:\n- $\\gamma = 1.33$, $R = 287\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, $R_{u} = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n- $T = 2400\\,\\text{K}$, $M = 2.3$, $\\Delta x = 7.5 \\times 10^{-4}\\,\\text{m}$.\n- $C_{\\text{exp}} = 0.6$.\n- $A = 8.0 \\times 10^{7}\\,\\text{s}^{-1}$, $E_{a} = 95 \\times 10^{3}\\,\\text{J}\\,\\text{mol}^{-1}$.\n\nStarting from first principles, derive the explicit physical-time step constraints imposed by:\n1. The Courant–Friedrichs–Lewy condition for the compressible hyperbolic system in one dimension.\n2. The linear stability requirement of forward Euler time integration for the stiff chemical source term $dc/dt = -k\\,c$.\n\nCompute both constraints as physical times in seconds. Then, for a steady reacting computation accelerated by Dual Time-Stepping (DTS), assume the pseudo-time integration employs an implicit scheme that:\n- treats the chemical source term implicitly (removing the explicit chemical stiffness restriction), and\n- is stable up to a pseudo-CFL number $C_{\\text{imp}} = 100$ for the convective operator.\n\nEstimate the advantage of DTS for this steady reacting case as the speed-up factor $S = \\Delta \\tau / \\Delta t_{\\text{exp}}$, where $\\Delta \\tau$ is the stable pseudo-time step and $\\Delta t_{\\text{exp}}$ is the explicit physical-time step chosen as the most restrictive of the derived constraints. Express $S$ as a dimensionless number. Round your final answer to three significant figures. Use seconds for all intermediate time quantities.",
            "solution": "The fundamental basis for the convective timestep restriction is the Courant–Friedrichs–Lewy (CFL) concept: explicit time marching of hyperbolic conservation laws is stable if no characteristic information travels more than one cell in a single time step. In one dimension for the compressible Euler operator with a passive scalar, the characteristic speeds (eigenvalues of the flux Jacobian) are $u-a$, $u$, and $u+a$, where $u$ is the streamwise velocity and $a$ is the speed of sound. The most restrictive convective wave speed is therefore $|u| + a$ in supersonic forward flow.\n\nThe speed of sound for an ideal gas is $a = \\sqrt{\\gamma R T}$. The velocity is related to the Mach number by $u = M a$. Thus the maximum characteristic speed is\n$$\n\\lambda_{\\max} = |u| + a = M a + a = (M+1)\\,a .\n$$\nAn explicit scheme with target Courant number $C_{\\text{exp}}$ enforces the convective timestep constraint\n$$\n\\Delta t_{\\text{CFL}} = C_{\\text{exp}}\\,\\frac{\\Delta x}{\\lambda_{\\max}} = C_{\\text{exp}}\\,\\frac{\\Delta x}{|u|+a} .\n$$\n\nFor the chemical source-term restriction, we consider the linear ordinary differential equation $dc/dt = -k\\,c$ obtained by linearization near the operating point. Forward Euler time integration for a decaying linear mode is stable when the amplification factor satisfies $|1 - k\\,\\Delta t| \\leq 1$, which gives the stability interval $0 \\leq k\\,\\Delta t \\leq 2$. Therefore the explicit chemical timestep limit is\n$$\n\\Delta t_{\\text{chem}} = \\frac{2}{k} ,\n$$\nwhere $k$ is the local linearized decay rate. Using the Arrhenius form $k = A \\exp\\!\\big(-E_{a}/(R_{u} T)\\big)$, we first compute $a$, $u$, $\\lambda_{\\max}$, then $\\Delta t_{\\text{CFL}}$, then $k$ and $\\Delta t_{\\text{chem}}$.\n\nCompute $a$:\n$$\na = \\sqrt{\\gamma R T} = \\sqrt{1.33 \\times 287 \\times 2400} = \\sqrt{916{,}104}\\,\\text{m}\\,\\text{s}^{-1} .\n$$\nNumerically, $\\sqrt{916{,}104} \\approx 957.133$, so\n$$\na \\approx 957.133\\,\\text{m}\\,\\text{s}^{-1} .\n$$\n\nCompute $u$:\n$$\nu = M a = 2.3 \\times 957.133 \\approx 2{,}201.406\\,\\text{m}\\,\\text{s}^{-1} .\n$$\n\nCompute $\\lambda_{\\max}$:\n$$\n\\lambda_{\\max} = |u| + a \\approx 2{,}201.406 + 957.133 = 3{,}158.539\\,\\text{m}\\,\\text{s}^{-1} .\n$$\n\nCompute the convective timestep constraint:\n$$\n\\Delta t_{\\text{CFL}} = C_{\\text{exp}}\\,\\frac{\\Delta x}{\\lambda_{\\max}} = 0.6 \\times \\frac{7.5 \\times 10^{-4}}{3{,}158.539} \\,\\text{s} .\n$$\nEvaluating the fraction,\n$$\n\\frac{7.5 \\times 10^{-4}}{3{,}158.539} \\approx 2.3758 \\times 10^{-7}\\,\\text{s} ,\n$$\nso\n$$\n\\Delta t_{\\text{CFL}} \\approx 0.6 \\times 2.3758 \\times 10^{-7} = 1.4255 \\times 10^{-7}\\,\\text{s} .\n$$\n\nCompute the chemical rate constant $k$ via Arrhenius:\n$$\nk = A \\exp\\!\\left(-\\frac{E_{a}}{R_{u} T}\\right) = 8.0 \\times 10^{7} \\times \\exp\\!\\left(-\\frac{95{,}000}{8.314 \\times 2400}\\right)\\,\\text{s}^{-1} .\n$$\nThe exponent is\n$$\n\\frac{95{,}000}{8.314 \\times 2400} = \\frac{95{,}000}{19{,}953.6} \\approx 4.76098 ,\n$$\nso\n$$\n\\exp(-4.76098) \\approx 8.56 \\times 10^{-3} .\n$$\nTherefore\n$$\nk \\approx 8.0 \\times 10^{7} \\times 8.56 \\times 10^{-3} = 6.848 \\times 10^{5}\\,\\text{s}^{-1} .\n$$\n\nCompute the chemical timestep constraint:\n$$\n\\Delta t_{\\text{chem}} = \\frac{2}{k} \\approx \\frac{2}{6.848 \\times 10^{5}} = 2.920 \\times 10^{-6}\\,\\text{s} .\n$$\n\nThe explicit physical timestep is the more restrictive of the two constraints:\n$$\n\\Delta t_{\\text{exp}} = \\min\\!\\big(\\Delta t_{\\text{CFL}}, \\Delta t_{\\text{chem}}\\big) = \\Delta t_{\\text{CFL}} \\approx 1.4255 \\times 10^{-7}\\,\\text{s} ,\n$$\nbecause $\\Delta t_{\\text{CFL}} \\ll \\Delta t_{\\text{chem}}$ for the given supersonic combustor conditions.\n\nFor steady reacting computations accelerated by Dual Time-Stepping (DTS), we consider a pseudo-time integration in which the convective operator is advanced implicitly and the chemistry is treated implicitly, removing the explicit chemical stiffness limit. The implicit scheme is stable up to a pseudo-Courant number $C_{\\text{imp}} = 100$, so the stable pseudo-time step is\n$$\n\\Delta \\tau = C_{\\text{imp}}\\,\\frac{\\Delta x}{\\lambda_{\\max}} = 100 \\times \\frac{\\Delta x}{\\lambda_{\\max}} .\n$$\nThe speed-up factor comparing DTS pseudo-time steps to explicit physical-time steps is\n$$\nS = \\frac{\\Delta \\tau}{\\Delta t_{\\text{exp}}} .\n$$\nSince $\\Delta t_{\\text{exp}}$ is limited by the convective CFL in this case, both $\\Delta \\tau$ and $\\Delta t_{\\text{exp}}$ scale with $\\Delta x/\\lambda_{\\max}$, yielding\n$$\nS = \\frac{C_{\\text{imp}}}{C_{\\text{exp}}} = \\frac{100}{0.6} \\approx 166.666\\ldots .\n$$\nRounded to three significant figures, the dimensionless speed-up factor is $S \\approx 167$.",
            "answer": "$$\\boxed{167}$$"
        },
        {
            "introduction": "The ultimate goal of detailed physical and computational modeling is to predict and optimize the overall performance of an engine system. This capstone exercise  integrates the principles of compressible flow and thermodynamics into a quasi-one-dimensional model of an entire scramjet engine. By analyzing the flow through the inlet, combustor, and nozzle while accounting for realistic losses, you will calculate the specific impulse ($I_{sp}$), a primary figure of merit for engine efficiency.",
            "id": "4069676",
            "problem": "A Supersonic Combustion Ramjet (scramjet) operates by ingesting atmospheric air at supersonic speed, adding fuel, and expanding the hot product gases through a nozzle to produce thrust. Your task is to implement a quasi-one-dimensional computational model to compute the Specific Impulse (Isp) for a hydrogen-fueled scramjet at several flight conditions. The final answer must be a single runnable program that produces the requested outputs exactly.\n\nUse a principled derivation that starts from the conservation of mass, conservation of momentum, and conservation of energy, together with standard compressible flow relations for a calorically perfect gas. Throughout, treat the mixture as a calorically perfect gas with constant ratio of specific heats $\\gamma$, constant specific gas constant $R$, and constant specific heat at constant pressure $c_p$. Let the flow be adiabatic except for chemical heat release in the combustor. Model the inlet, combustor, and nozzle as quasi-one-dimensional components with measured total pressure losses. Assume perfectly expanded nozzle exit such that the exit static pressure equals the ambient static pressure. Neglect viscous drag and pressure thrust terms when the exit pressure equals ambient. Assume complete mixing and complete reaction of hydrogen with air at the specified equivalence ratio.\n\nDefinitions and constants to be used:\n- Specific Impulse (Isp) is defined as $I_{sp} = \\dfrac{F}{\\dot{m}_f g_0}$, where $F$ is thrust in $\\mathrm{N}$, $\\dot{m}_f$ is fuel mass flow rate in $\\mathrm{kg\\,s^{-1}}$, and $g_0$ is standard gravity in $\\mathrm{m\\,s^{-2}}$.\n- Let the freestream static pressure, temperature, and Mach number be $p_\\infty$, $T_\\infty$, and $M_0$.\n- The inlet capture area is $A_c$ in $\\mathrm{m^2}$.\n- The total pressure loss ratios for the inlet, combustor, and nozzle are $\\tau_{\\mathrm{in}}$, $\\tau_{\\mathrm{comb}}$, and $\\tau_{\\mathrm{noz}}$, respectively. These are dimensionless and satisfy $0  \\tau  1$.\n- The fuel-air equivalence ratio is $\\phi$, dimensionless. For hydrogen fuel, use stoichiometric fuel-to-air mass ratio $f_{\\mathrm{st}} = 1/34.48$ (approximately $0.0290$). Then the fuel-to-air mass ratio is $f = \\phi f_{\\mathrm{st}}$.\n- Use $\\gamma = 1.4$, $R = 287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $c_p = \\dfrac{\\gamma R}{\\gamma - 1}$, $g_0 = 9.80665\\ \\mathrm{m\\,s^{-2}}$.\n- Use the lower heating value of hydrogen $LHV = 1.2 \\times 10^8\\ \\mathrm{J\\,kg^{-1}}$.\n\nModeling requirements to implement:\n1. Determine the freestream speed $U_0$ from $M_0$ and $T_\\infty$, and the freestream density $\\rho_\\infty$ from $p_\\infty$ and $T_\\infty$. Determine the ingested air mass flow $\\dot{m}_a = \\rho_\\infty U_0 A_c$ in $\\mathrm{kg\\,s^{-1}}$.\n2. Compute the freestream stagnation temperature and pressure $(T_{0,\\mathrm{free}}, p_{0,\\mathrm{free}})$ using isentropic relations. Apply the inlet total pressure loss ratio to obtain $p_{0,\\mathrm{in}} = \\tau_{\\mathrm{in}} p_{0,\\mathrm{free}}$, and assume $T_{0,\\mathrm{in}} = T_{0,\\mathrm{free}}$.\n3. Compute the fuel mass flow $\\dot{m}_f = f \\dot{m}_a$ and the total mass flow $\\dot{m}_t = \\dot{m}_a + \\dot{m}_f$.\n4. Use conservation of energy across the combustor to obtain the combustor exit stagnation temperature $T_{0,\\mathrm{comb}}$ based on chemical heat release and mixing. Apply the combustor total pressure loss ratio to obtain $p_{0,\\mathrm{comb}} = \\tau_{\\mathrm{comb}} p_{0,\\mathrm{in}}$.\n5. Apply the nozzle total pressure loss ratio to obtain the nozzle stagnation pressure $p_{0,\\mathrm{noz}} = \\tau_{\\mathrm{noz}} p_{0,\\mathrm{comb}}$ and assume $T_{0,\\mathrm{noz}} = T_{0,\\mathrm{comb}}$.\n6. For a perfectly expanded exit, set $p_e = p_\\infty$ and determine the exit Mach number $M_e$ from $p_{0,\\mathrm{noz}}$ and $p_e$ using isentropic relations. If $p_{0,\\mathrm{noz}} \\le p_\\infty$, set $M_e = 0$. Compute exit static temperature $T_e$ and exit velocity $U_e$.\n7. Compute thrust $F = \\dot{m}_t U_e - \\dot{m}_a U_0$ and then compute $I_{sp} = \\dfrac{F}{\\dot{m}_f g_0}$ in $\\mathrm{s}$. If the thrust is negative, $I_{sp}$ will be negative accordingly. Express all final $I_{sp}$ values in $\\mathrm{s}$.\n\nYour program must evaluate the following five test cases. Each test case specifies $(M_0, p_\\infty, T_\\infty, A_c, \\tau_{\\mathrm{in}}, \\tau_{\\mathrm{comb}}, \\tau_{\\mathrm{noz}}, \\phi)$:\n\n- Test case $1$: $M_0 = 6.0$, $p_\\infty = 2511\\ \\mathrm{Pa}$, $T_\\infty = 223.0\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.90$, $\\tau_{\\mathrm{comb}} = 0.60$, $\\tau_{\\mathrm{noz}} = 0.95$, $\\phi = 0.50$.\n- Test case $2$: $M_0 = 5.0$, $p_\\infty = 5474\\ \\mathrm{Pa}$, $T_\\infty = 216.65\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.80$, $\\tau_{\\mathrm{comb}} = 0.40$, $\\tau_{\\mathrm{noz}} = 0.90$, $\\phi = 0.30$.\n- Test case $3$ (near-expansion boundary): $M_0 = 2.0$, $p_\\infty = 35651\\ \\mathrm{Pa}$, $T_\\infty = 236.65\\ \\mathrm{K}$, $A_c = 0.3\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.85$, $\\tau_{\\mathrm{comb}} = 0.30$, $\\tau_{\\mathrm{noz}} = 0.70$, $\\phi = 0.15$.\n- Test case $4$ (high heat addition): $M_0 = 7.5$, $p_\\infty = 1197\\ \\mathrm{Pa}$, $T_\\infty = 226.5\\ \\mathrm{K}$, $A_c = 0.7\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.92$, $\\tau_{\\mathrm{comb}} = 0.65$, $\\tau_{\\mathrm{noz}} = 0.97$, $\\phi = 0.90$.\n- Test case $5$ (lean case): $M_0 = 5.5$, $p_\\infty = 5474\\ \\mathrm{Pa}$, $T_\\infty = 216.65\\ \\mathrm{K}$, $A_c = 0.5\\ \\mathrm{m^2}$, $\\tau_{\\mathrm{in}} = 0.88$, $\\tau_{\\mathrm{comb}} = 0.50$, $\\tau_{\\mathrm{noz}} = 0.93$, $\\phi = 0.10$.\n\nAngle units are not used in this problem. Physical units must be respected, and the final requested quantity must be returned in seconds ($\\mathrm{s}$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order of the test cases above. Each entry must be a floating-point number representing $I_{sp}$ in $\\mathrm{s}$, rounded to three decimal places, for example, $\\left[1234.567,2345.678,3456.789,4567.890,5678.901\\right]$.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of thermodynamics and compressible fluid dynamics, well-posed with a clear and complete set of instructions and data, and objective in its formulation. We will now proceed with a principled derivation of the solution.\n\nThe objective is to compute the specific impulse, $I_{sp}$, of a hydrogen-fueled scramjet for several flight conditions using a quasi-one-dimensional flow model. The model treats the engine as a series of components—inlet, combustor, and nozzle—and analyzes the changes in fluid properties across them.\n\n**1. Freestream Conditions and Air Mass Flow**\nThe analysis begins with the freestream conditions: Mach number $M_0$, static pressure $p_\\infty$, and static temperature $T_\\infty$. The freestream air velocity, $U_0$, is determined from the definition of Mach number, assuming air is a calorically perfect gas with a specific gas constant $R$ and ratio of specific heats $\\gamma$.\n$$U_0 = M_0 a_0 = M_0 \\sqrt{\\gamma R T_\\infty}$$\nThe freestream air density, $\\rho_\\infty$, is found using the ideal gas law:\n$$\\rho_\\infty = \\frac{p_\\infty}{R T_\\infty}$$\nThe engine captures air over an inlet area $A_c$. The mass flow rate of the ingested air, $\\dot{m}_a$, is given by:\n$$\\dot{m}_a = \\rho_\\infty U_0 A_c$$\n\n**2. Inlet Compression**\nThe inlet compresses the incoming air, increasing its pressure and temperature. The process is assumed to be adiabatic, so the stagnation temperature remains constant. The freestream stagnation properties, $T_{0,\\mathrm{free}}$ and $p_{0,\\mathrm{free}}$, are calculated using isentropic flow relations:\n$$T_{0,\\mathrm{free}} = T_\\infty \\left(1 + \\frac{\\gamma-1}{2} M_0^2\\right)$$\n$$p_{0,\\mathrm{free}} = p_\\infty \\left(1 + \\frac{\\gamma-1}{2} M_0^2\\right)^{\\frac{\\gamma}{\\gamma-1}}$$\nDue to the adiabatic assumption for the inlet, the stagnation temperature at the inlet exit is unchanged:\n$$T_{0,\\mathrm{in}} = T_{0,\\mathrm{free}}$$\nThe irreversible effects in the inlet, such as shock waves and friction, cause a loss in total pressure, which is quantified by the inlet total pressure recovery factor $\\tau_{\\mathrm{in}}$:\n$$p_{0,\\mathrm{in}} = \\tau_{\\mathrm{in}} p_{0,\\mathrm{free}}$$\n\n**3. Fuel Addition and Total Mass Flow**\nFuel is added to the compressed air stream. The fuel-to-air mass ratio, $f$, is defined based on the specified equivalence ratio, $\\phi$, and the stoichiometric fuel-to-air ratio for hydrogen, $f_{\\mathrm{st}}$:\n$$f = \\phi f_{\\mathrm{st}}$$\nThe mass flow rate of the fuel, $\\dot{m}_f$, is:\n$$\\dot{m}_f = f \\dot{m}_a$$\nThe total mass flow rate, $\\dot{m}_t$, through the subsequent components is the sum of the air and fuel mass flow rates:\n$$\\dot{m}_t = \\dot{m}_a + \\dot{m}_f = \\dot{m}_a (1 + f)$$\n\n**4. Combustor Heat Addition**\nIn the combustor, the fuel burns, releasing chemical energy and significantly increasing the stagnation temperature of the flow. Applying the steady-flow energy equation between the combustor inlet and exit, we account for the heat released by the combustion of fuel, defined by its lower heating value, $LHV$.\n$$\\dot{m}_a h_{0,\\mathrm{in}} + \\dot{m}_f LHV = \\dot{m}_t h_{0,\\mathrm{comb}}$$\nAssuming a calorically perfect gas with constant specific heat at constant pressure $c_p$ for both the incoming air and the exiting combustion products, we can write $h_0 = c_p T_0$.\n$$\\dot{m}_a c_p T_{0,\\mathrm{in}} + \\dot{m}_f LHV = (\\dot{m}_a + \\dot{m}_f) c_p T_{0,\\mathrm{comb}}$$\nThe value of $c_p$ is determined from the gas properties: $c_p = \\frac{\\gamma R}{\\gamma - 1}$. Solving for the combustor exit stagnation temperature, $T_{0,\\mathrm{comb}}$, yields:\n$$T_{0,\\mathrm{comb}} = \\frac{\\dot{m}_a c_p T_{0,\\mathrm{in}} + \\dot{m}_f LHV}{(\\dot{m}_a + \\dot{m}_f) c_p} = \\frac{T_{0,\\mathrm{in}} + f \\frac{LHV}{c_p}}{1+f}$$\nCombustion and mixing are highly irreversible processes, resulting in a substantial loss of total pressure. This is modeled by the combustor total pressure loss ratio, $\\tau_{\\mathrm{comb}}$:\n$$p_{0,\\mathrm{comb}} = \\tau_{\\mathrm{comb}} p_{0,\\mathrm{in}}$$\n\n**5. Nozzle Flow**\nThe hot, high-pressure gas from the combustor expands through the nozzle. This expansion process is assumed to be adiabatic, so the stagnation temperature is conserved:\n$$T_{0,\\mathrm{noz}} = T_{0,\\mathrm{comb}}$$\nSimilar to the other components, the nozzle has frictional and other losses, accounted for by the nozzle total pressure recovery factor, $\\tau_{\\mathrm{noz}}$:\n$$p_{0,\\mathrm{noz}} = \\tau_{\\mathrm{noz}} p_{0,\\mathrm{comb}}$$\n\n**6. Nozzle Exit Conditions**\nThe problem specifies a \"perfectly expanded\" nozzle, where the exit static pressure, $p_e$, matches the ambient freestream pressure, $p_\\infty$.\n$$p_e = p_\\infty$$\nThe nozzle exit Mach number, $M_e$, can be determined from the isentropic pressure relation between the nozzle stagnation state and the exit static state:\n$$\\frac{p_{0,\\mathrm{noz}}}{p_e} = \\left(1 + \\frac{\\gamma-1}{2} M_e^2\\right)^{\\frac{\\gamma}{\\gamma-1}}$$\nThis equation can be inverted to solve for $M_e$:\n$$M_e = \\sqrt{\\frac{2}{\\gamma-1} \\left[ \\left(\\frac{p_{0,\\mathrm{noz}}}{p_e}\\right)^{\\frac{\\gamma-1}{\\gamma}} - 1 \\right]}$$\nFor a physically meaningful expansion, the nozzle stagnation pressure must be greater than the exit pressure ($p_{0,\\mathrm{noz}} > p_e$). If $p_{0,\\mathrm{noz}} \\le p_e$, the flow cannot expand to a velocity greater than zero to match the back-pressure, so we set $M_e = 0$, which implies an exit velocity $U_e=0$.\nWith $M_e$ determined, the exit static temperature $T_e$ and exit velocity $U_e$ are found:\n$$T_e = \\frac{T_{0,\\mathrm{noz}}}{1 + \\frac{\\gamma-1}{2} M_e^2}$$\n$$U_e = M_e \\sqrt{\\gamma R T_e}$$\n\n**7. Thrust and Specific Impulse**\nThe thrust, $F$, is the net force produced by the engine. For a perfectly expanded nozzle, the pressure thrust term is zero, and the gross thrust is determined by the momentum change of the working fluid. The ram drag is the momentum of the incoming air. The net thrust is given by:\n$$F = \\dot{m}_t U_e - \\dot{m}_a U_0$$\nFinally, the specific impulse, $I_{sp}$, which measures the efficiency of propellant utilization, is defined as the thrust per unit weight flow rate of fuel. Standard gravity, $g_0$, is used to convert the fuel mass flow rate to a weight flow rate.\n$$I_{sp} = \\frac{F}{\\dot{m}_f g_0}$$\nThe resulting unit for $I_{sp}$ is seconds ($\\mathrm{s}$). A negative thrust will result in a negative specific impulse, indicating that the engine is producing net drag. These equations are implemented for each test case to determine the performance.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Specific Impulse (Isp) for a hydrogen-fueled scramjet\n    using a quasi-one-dimensional model for a given set of test cases.\n    \"\"\"\n    \n    # Define physical and gas constants\n    GAMMA = 1.4  # Ratio of specific heats\n    R = 287.0  # Specific gas constant for air (J/kg-K)\n    G0 = 9.80665  # Standard gravity (m/s^2)\n    LHV_H2 = 1.2e8  # Lower Heating Value of hydrogen (J/kg)\n    F_ST_H2 = 1.0 / 34.48  # Stoichiometric fuel-to-air ratio for hydrogen\n\n    # Derived constant: specific heat at constant pressure\n    CP = GAMMA * R / (GAMMA - 1.0)\n\n    # Each test case is a tuple:\n    # (M0, p_inf, T_inf, A_c, tau_in, tau_comb, tau_noz, phi)\n    test_cases = [\n        (6.0, 2511.0, 223.0, 0.5, 0.90, 0.60, 0.95, 0.50),\n        (5.0, 5474.0, 216.65, 0.5, 0.80, 0.40, 0.90, 0.30),\n        (2.0, 35651.0, 236.65, 0.3, 0.85, 0.30, 0.70, 0.15),\n        (7.5, 1197.0, 226.5, 0.7, 0.92, 0.65, 0.97, 0.90),\n        (5.5, 5474.0, 216.65, 0.5, 0.88, 0.50, 0.93, 0.10),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M0, p_inf, T_inf, A_c, tau_in, tau_comb, tau_noz, phi = case\n\n        # Step 1: Freestream conditions and air mass flow\n        U0 = M0 * np.sqrt(GAMMA * R * T_inf)\n        rho_inf = p_inf / (R * T_inf)\n        m_dot_a = rho_inf * U0 * A_c\n\n        # Step 2: Inlet analysis\n        T0_free = T_inf * (1.0 + (GAMMA - 1.0) / 2.0 * M0**2)\n        p0_free = p_inf * (1.0 + (GAMMA - 1.0) / 2.0 * M0**2)**(GAMMA / (GAMMA - 1.0))\n        \n        T0_in = T0_free\n        p0_in = tau_in * p0_free\n\n        # Step 3: Fuel injection and total mass flow\n        f = phi * F_ST_H2\n        m_dot_f = f * m_dot_a\n        m_dot_t = m_dot_a + m_dot_f\n\n        # Step 4: Combustor analysis\n        T0_comb = (T0_in + f * LHV_H2 / CP) / (1.0 + f)\n        p0_comb = tau_comb * p0_in\n        \n        # Step 5: Nozzle analysis\n        T0_noz = T0_comb\n        p0_noz = tau_noz * p0_comb\n\n        # Step 6: Nozzle exit conditions (perfectly expanded nozzle)\n        p_e = p_inf\n        \n        # Check if expansion is possible\n        if p0_noz = p_e:\n            Me = 0.0\n            Ue = 0.0\n        else:\n            pressure_ratio = p0_noz / p_e\n            Me_sq = (2.0 / (GAMMA - 1.0)) * (pressure_ratio**((GAMMA - 1.0) / GAMMA) - 1.0)\n            Me = np.sqrt(Me_sq)\n            \n            Te = T0_noz / (1.0 + (GAMMA - 1.0) / 2.0 * Me**2)\n            Ue = Me * np.sqrt(GAMMA * R * Te)\n\n        # Step 7: Thrust and Specific Impulse calculation\n        thrust = m_dot_t * Ue - m_dot_a * U0\n        \n        if m_dot_f > 0:\n            Isp = thrust / (m_dot_f * G0)\n        else:\n            Isp = 0.0 # Or could be -inf or NaN depending on thrust, but phi > 0 here.\n\n        results.append(f\"{Isp:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}