{
    "hands_on_practices": [
        {
            "introduction": "The Zeldovich–von Neumann–Döring (ZND) model deconstructs a detonation wave into a leading, non-reactive shock front followed by a chemical reaction zone. This exercise focuses on the initial shock jump, which establishes the extreme conditions of the \"von Neumann spike.\" By deriving the post-shock temperature from the fundamental conservation laws, you will reinforce your understanding of the Rankine-Hugoniot relations that govern this purely gas-dynamic process .",
            "id": "4078300",
            "problem": "A planar detonation wave in the Zeldovich–von Neumann–Döring (ZND) model propagates at constant speed $D$ into a quiescent ideal-gas mixture initially at thermodynamic state $(p_{0},T_{0})$. Immediately behind the leading shock, the chemical composition is assumed to be unchanged (species frozen), and the gas can be modeled as an ideal gas with constant heat capacity ratio $\\gamma$ and gas constant $R$. The upstream mixture is at rest in the laboratory frame, and the shock speed satisfies $D  \\sqrt{\\gamma R T_{0}}$ so that the shock is supersonic with respect to the upstream state. \n\nStarting from the one-dimensional steady conservation laws of mass, momentum, and energy in the shock-fixed frame, together with the ideal-gas equation of state $p=\\rho R T$ and constant-caloric ideal-gas enthalpy $h=c_{p}T$ with $c_{p}=\\gamma R/(\\gamma-1)$, derive a closed-form expression for the downstream temperature $T$ immediately behind the shock in terms of $(D,\\gamma,R,T_{0})$. Do not use any pre-derived shock-jump formulas; the derivation must proceed from the fundamental balances and the given equations of state.\n\nState clearly the physical assumptions under which the species remain frozen at the shock in the Zeldovich–von Neumann–Döring (ZND) model.\n\nExpress the final temperature symbolically in kelvin as a single analytic expression in $(D,\\gamma,R,T_{0})$. No numerical evaluation is required, and no rounding is needed.",
            "solution": "The Zeldovich–von Neumann–Döring (ZND) model posits a leading hydrodynamic shock followed by an induction and reaction zone. At the shock itself, the chemical source terms are negligible, so the flow is governed by gas-dynamic conservation laws and an ideal-gas equation of state with constant heat capacity ratio $\\gamma$.\n\nWe work in the shock-fixed frame. Let the upstream (state $0$) be the quiescent gas seen moving toward the shock at speed $u_{0}=D$, and let the downstream (state $1$) be the post-shock state with speed $u_{1}$ away from the shock. The one-dimensional steady Rankine–Hugoniot conditions are:\n- Mass conservation: \n$$\\rho_{0} u_{0} = \\rho_{1} u_{1}.$$\n- Momentum conservation:\n$$p_{0} + \\rho_{0} u_{0}^{2} = p_{1} + \\rho_{1} u_{1}^{2}.$$\n- Energy conservation:\n$$h_{0} + \\frac{u_{0}^{2}}{2} = h_{1} + \\frac{u_{1}^{2}}{2}.$$\n\nFor an ideal gas with constant $\\gamma$, we have the ideal-gas equation of state $p=\\rho R T$ and the caloric relation $h=c_{p}T$ with $c_{p}=\\gamma R/(\\gamma-1)$. The upstream sound speed is $a_{0}=\\sqrt{\\gamma R T_{0}}$, and the upstream Mach number is $M_{0}=u_{0}/a_{0}=D/\\sqrt{\\gamma R T_{0}}$, with $M_{0}1$ by hypothesis.\n\nWe introduce the velocity ratio \n$$r \\equiv \\frac{u_{1}}{u_{0}}.$$\nFrom mass conservation,\n$$\\frac{\\rho_{1}}{\\rho_{0}} = \\frac{u_{0}}{u_{1}} = \\frac{1}{r}.$$\nFrom momentum conservation, rearrange to obtain\n$$p_{1}-p_{0} = \\rho_{0} u_{0} (u_{0}-u_{1}).$$\nDivide by $p_{0}$ and use $p_{0}=\\rho_{0} a_{0}^{2}/\\gamma$ to get\n$$\\frac{p_{1}}{p_{0}} - 1 = \\gamma \\frac{u_{0}(u_{0}-u_{1})}{a_{0}^{2}} = \\gamma \\left(\\frac{u_{0}}{a_{0}}\\right)^{2} \\left(1 - \\frac{u_{1}}{u_{0}}\\right) = \\gamma M_{0}^{2} (1 - r),$$\nso\n$$\\frac{p_{1}}{p_{0}} = 1 + \\gamma M_{0}^{2} (1 - r).$$\n\nFrom energy conservation, using $h=c_{p}T$ with $c_{p}=\\gamma R/(\\gamma-1)$,\n$$c_{p}(T_{1}-T_{0}) = \\frac{u_{0}^{2}-u_{1}^{2}}{2},$$\nhence\n$$\\frac{T_{1}}{T_{0}} - 1 = \\frac{u_{0}^{2}-u_{1}^{2}}{2 c_{p} T_{0}} = \\frac{u_{0}^{2}-u_{1}^{2}}{2} \\cdot \\frac{\\gamma - 1}{\\gamma R T_{0}}.$$\nWith $a_{0}^{2}=\\gamma R T_{0}$, this becomes\n$$\\frac{T_{1}}{T_{0}} = 1 + \\frac{\\gamma - 1}{2} \\left(\\frac{u_{0}}{a_{0}}\\right)^{2} \\left[1 - \\left(\\frac{u_{1}}{u_{0}}\\right)^{2}\\right] = 1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2}).$$\n\nThe ideal-gas relation gives\n$$\\frac{p_{1}}{p_{0}} = \\frac{\\rho_{1} R T_{1}}{\\rho_{0} R T_{0}} = \\frac{\\rho_{1}}{\\rho_{0}} \\frac{T_{1}}{T_{0}} = \\frac{1}{r} \\frac{T_{1}}{T_{0}}.$$\nEquating this with the momentum-derived expression for $p_{1}/p_{0}$ yields\n$$\\frac{1}{r} \\left[1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2})\\right] = 1 + \\gamma M_{0}^{2} (1 - r).$$\nMultiplying through by $r$ gives a quadratic in $r$:\n$$1 + \\frac{\\gamma - 1}{2} M_{0}^{2} (1 - r^{2}) = r + \\gamma M_{0}^{2} r (1 - r).$$\nCollecting terms,\n$$\\frac{\\gamma + 1}{2} M_{0}^{2} r^{2} - \\left[1 + \\gamma M_{0}^{2}\\right] r + \\left[1 + \\frac{\\gamma - 1}{2} M_{0}^{2}\\right] = 0.$$\nSolving this quadratic, the physically relevant (compressive shock) root is\n$$r = \\frac{(\\gamma - 1) M_{0}^{2} + 2}{(\\gamma + 1) M_{0}^{2}},$$\nwhile the other root $r=1$ corresponds to the trivial no-shock solution.\n\nWith $r$ known, the pressure ratio follows as\n$$\\frac{p_{1}}{p_{0}} = 1 + \\frac{2 \\gamma}{\\gamma + 1} (M_{0}^{2} - 1),$$\nand the density ratio as\n$$\\frac{\\rho_{1}}{\\rho_{0}} = \\frac{(\\gamma + 1) M_{0}^{2}}{(\\gamma - 1) M_{0}^{2} + 2}.$$\nTherefore the temperature ratio is\n$$\\frac{T_{1}}{T_{0}} = \\frac{p_{1}/p_{0}}{\\rho_{1}/\\rho_{0}} = \\left[1 + \\frac{2 \\gamma}{\\gamma + 1} (M_{0}^{2} - 1)\\right] \\left[\\frac{(\\gamma - 1) M_{0}^{2} + 2}{(\\gamma + 1) M_{0}^{2}}\\right].$$\nSubstituting $M_{0}^{2} = D^{2}/(\\gamma R T_{0})$ gives the downstream temperature immediately behind the shock:\n$$T_{1} = T_{0} \\left( 1 + \\frac{2 \\gamma}{\\gamma + 1} \\left( \\frac{D^{2}}{\\gamma R T_{0}} - 1 \\right) \\right) \\left( \\frac{ (\\gamma - 1) \\frac{D^{2}}{\\gamma R T_{0}} + 2 }{ (\\gamma + 1) \\frac{D^{2}}{\\gamma R T_{0}} } \\right).$$\nThis $T_{1}$ is the temperature immediately behind the leading shock in the Zeldovich–von Neumann–Döring (ZND) detonation, under frozen composition across the shock.\n\nAssumptions under which species remain frozen at the shock in the Zeldovich–von Neumann–Döring (ZND) model:\n- The shock thickness $\\delta_{s}$ is microscopic and the convective residence time across the shock $\\tau_{s} \\sim \\delta_{s}/u_{0}$ is much smaller than the characteristic chemical induction time $\\tau_{\\chi}$, so the Damköhler number based on the shock, $Da_{\\delta_{s}} \\equiv \\tau_{s}/\\tau_{\\chi}$, satisfies $Da_{\\delta_{s}} \\ll 1$; equivalently, chemical source terms are negligible at shock traversal.\n- Thermochemical state is described by a single translational-rotational temperature at the shock, with vibrational and electronic excitations not leading to net composition change over $\\tau_{s}$; the specific heats and $\\gamma$ can be treated as constant across the shock.\n- No external heat addition, body forces, or radiation over the shock thickness; the shock process is adiabatic and one-dimensional.\n- The mixture is homogeneous upstream and remains a single ideal-gas phase, so $p=\\rho R T$ and $h=c_{p} T$ apply during the shock process.\n- The leading shock is hydrodynamic and non-reactive; reaction proceeds only downstream in the induction zone where the temperature and pressure histories control ignition after the shock.\n\nUnder these assumptions, the downstream state immediately behind the shock is the frozen normal-shock state given above, which serves as the von Neumann state in the Zeldovich–von Neumann–Döring (ZND) detonation structure.",
            "answer": "$$\\boxed{T_{0}\\left(1+\\frac{2\\gamma}{\\gamma+1}\\left(\\frac{D^{2}}{\\gamma R T_{0}}-1\\right)\\right)\\left(\\frac{(\\gamma-1)\\,\\frac{D^{2}}{\\gamma R T_{0}}+2}{(\\gamma+1)\\,\\frac{D^{2}}{\\gamma R T_{0}}}\\right)}$$"
        },
        {
            "introduction": "While the ZND model describes the internal structure of a detonation, the Chapman-Jouguet (CJ) theory provides the critical condition that selects a unique, stable propagation speed. This practice bridges the initial unreacted state and the final equilibrium state of the wave. By combining the reactive Hugoniot relations with the condition that the downstream flow is sonic relative to the front, you will derive the classic formula for the CJ speed, gaining insight into why stable detonations travel at a specific, high velocity .",
            "id": "4078265",
            "problem": "A planar, steady detonation in the Zeldovich–von Neumann–Döring (ZND) model of ideal-gas combustion propagates into a quiescent premixed gas with known initial pressure $p_1$, density $\\rho_1$, and constant specific heat ratio $\\gamma$. The Chapman–Jouguet (CJ) state is defined by the condition that the post-reaction flow is sonic relative to the detonation front. Assume the ideal gas law holds throughout, with the speed of sound $a$ satisfying $a^2 = \\gamma p / \\rho$, and that the chemical energy release per unit mass across the reaction zone is a positive constant $q$. In the detonation-fixed frame, the upstream gas has speed $u_1 = D$, where $D$ is the detonation speed.\n\nStarting from one-dimensional steady conservation of mass, momentum, and energy across the detonation (including the heat release $q$), and the ideal-gas thermodynamic relations, combine the reactive Hugoniot, the Rayleigh line, and the CJ sonic condition $u_2 = a_2$ at the downstream state to eliminate all downstream state variables and obtain a single algebraic equation for the CJ detonation speed $D_{CJ}$. Clearly state the set of unknowns you introduce and eliminate in your derivation.\n\nExpress your final answer as a closed-form analytic expression for $D_{CJ}^{2}$ in terms of $a_1^{2}$, $\\gamma$, and $q$, where $a_1^{2} = \\gamma p_1 / \\rho_1$. If numerically evaluated, express $D_{CJ}^{2}$ in SI units of $\\mathrm{m}^2/\\mathrm{s}^2$ and $q$ in $\\mathrm{J}/\\mathrm{kg}$. No numerical substitution is required; report only the symbolic expression. No rounding is needed.",
            "solution": "The problem requires the derivation of an expression for the square of the Chapman-Jouguet (CJ) detonation speed, denoted as $D_{CJ}^2$, based on fundamental conservation principles for a planar, steady, one-dimensional detonation in an ideal gas.\n\nWe begin by stating the governing Rankine-Hugoniot equations, which express the conservation of mass, momentum, and energy across the detonation wave, relating the upstream state (index $1$) to the downstream state (index $2$). The frame of reference is fixed to the detonation front, so the upstream gas velocity is $u_1 = D$, where $D$ is the detonation speed. The downstream velocity is $u_2$.\n\nThe conservation equations are:\n1.  Mass conservation:\n    $$ \\rho_1 u_1 = \\rho_2 u_2 $$\n    Substituting $u_1 = D$, we have:\n    $$ \\rho_1 D = \\rho_2 u_2 \\quad (1) $$\n2.  Momentum conservation:\n    $$ p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2 $$\n    Substituting $u_1 = D$, we have:\n    $$ p_1 + \\rho_1 D^2 = p_2 + \\rho_2 u_2^2 \\quad (2) $$\n3.  Energy conservation:\n    $$ h_1 + \\frac{1}{2} u_1^2 + q = h_2 + \\frac{1}{2} u_2^2 $$\n    where $h$ is the specific enthalpy and $q$ is the specific heat release. For an ideal gas with a constant specific heat ratio $\\gamma$, the specific enthalpy is given by $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$. Substituting this and $u_1=D$:\n    $$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 \\quad (3) $$\n\nThe system is closed by the Chapman-Jouguet condition, which states that the downstream flow is sonic relative to the detonation front. The speed of sound $a$ in an ideal gas is given by $a^2 = \\gamma p / \\rho$. Therefore, the CJ condition is:\n$$ u_2 = a_2 \\implies u_2^2 = a_2^2 = \\frac{\\gamma p_2}{\\rho_2} \\quad (4) $$\n\nThe objective is to find an expression for $D_{CJ}^2$ in terms of the initial state properties $p_1$, $\\rho_1$ (or equivalently $a_1^2 = \\gamma p_1/\\rho_1$), $\\gamma$, and the heat release $q$. To achieve this, we must eliminate the unknown downstream state variables: the pressure $p_2$, the density $\\rho_2$, and the velocity $u_2$.\n\nFirst, we use the CJ condition $(4)$ to simplify the momentum equation $(2)$:\n$$ p_1 + \\rho_1 D^2 = p_2 + \\rho_2 \\left( \\frac{\\gamma p_2}{\\rho_2} \\right) = p_2 + \\gamma p_2 = p_2(1+\\gamma) $$\nFrom this, we can express the downstream pressure $p_2$ in terms of $D$ and upstream properties:\n$$ p_2 = \\frac{p_1 + \\rho_1 D^2}{1+\\gamma} \\quad (5) $$\n\nNext, we use equations $(1)$ and $(4)$ to relate $\\rho_2$ to other variables. Squaring the mass conservation equation $(1)$:\n$$ \\rho_1^2 D^2 = \\rho_2^2 u_2^2 $$\nSubstituting the CJ condition $u_2^2 = \\gamma p_2/\\rho_2$:\n$$ \\rho_1^2 D^2 = \\rho_2^2 \\left( \\frac{\\gamma p_2}{\\rho_2} \\right) = \\gamma p_2 \\rho_2 $$\nThis allows us to express the downstream density $\\rho_2$ as:\n$$ \\rho_2 = \\frac{\\rho_1^2 D^2}{\\gamma p_2} \\quad (6) $$\n\nNow we have expressions for both $p_2$ and $\\rho_2$ in terms of $D$ and each other. We can combine them to find the ratio $p_2/\\rho_2$:\n$$ \\frac{p_2}{\\rho_2} = p_2 \\left( \\frac{1}{\\rho_2} \\right) = p_2 \\left( \\frac{\\gamma p_2}{\\rho_1^2 D^2} \\right) = \\frac{\\gamma p_2^2}{\\rho_1^2 D^2} $$\nSubstituting the expression for $p_2$ from $(5)$:\n$$ \\frac{p_2}{\\rho_2} = \\frac{\\gamma}{\\rho_1^2 D^2} \\left( \\frac{p_1 + \\rho_1 D^2}{1+\\gamma} \\right)^2 = \\frac{\\gamma (p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2 (1+\\gamma)^2} \\quad (7) $$\n\nThe final step is to use the energy equation $(3)$. We can simplify its right-hand side using the CJ condition $u_2^2 = \\gamma p_2/\\rho_2$:\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}\\gamma\\frac{p_2}{\\rho_2} = \\left( \\frac{\\gamma}{\\gamma-1} + \\frac{\\gamma}{2} \\right) \\frac{p_2}{\\rho_2} $$\n$$ = \\left( \\frac{2\\gamma + \\gamma(\\gamma-1)}{2(\\gamma-1)} \\right) \\frac{p_2}{\\rho_2} = \\frac{\\gamma^2+\\gamma}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} $$\nSo the energy equation becomes:\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\frac{p_2}{\\rho_2} \\quad (8) $$\n\nNow, we substitute the expression for $p_2/\\rho_2$ from $(7)$ into $(8)$:\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma(1+\\gamma)}{2(\\gamma-1)} \\left[ \\frac{\\gamma (p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2 (1+\\gamma)^2} \\right] $$\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma-1)(1+\\gamma)} \\frac{(p_1 + \\rho_1 D^2)^2}{\\rho_1^2 D^2} $$\nTo simplify, we introduce the upstream speed of sound squared, $a_1^2 = \\gamma p_1/\\rho_1$, which implies $p_1/\\rho_1 = a_1^2/\\gamma$.\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{a_1^2}{\\gamma} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma^2-1)} \\frac{(\\rho_1 a_1^2/\\gamma + \\rho_1 D^2)^2}{\\rho_1^2 D^2} $$\n$$ \\frac{a_1^2}{\\gamma-1} + \\frac{1}{2}D^2 + q = \\frac{\\gamma^2}{2(\\gamma^2-1)} \\frac{\\rho_1^2 (a_1^2/\\gamma + D^2)^2}{\\rho_1^2 D^2} = \\frac{1}{2(\\gamma^2-1)} \\frac{(a_1^2 + \\gamma D^2)^2}{D^2} $$\nThis is a single algebraic equation for $D$, which is what the problem asks to be obtained. From now on, $D$ is specifically the CJ speed, $D_{CJ}$. Let $X = D_{CJ}^2$.\n$$ \\frac{a_1^2}{\\gamma-1} + \\frac{X}{2} + q = \\frac{(a_1^2 + \\gamma X)^2}{2(\\gamma^2-1)X} $$\nTo solve for $X$, we clear the denominator by multiplying by $2(\\gamma^2-1)X$:\n$$ 2(\\gamma+1)X a_1^2 + (\\gamma^2-1)X^2 + 2(\\gamma^2-1)q X = (a_1^2 + \\gamma X)^2 $$\n$$ 2(\\gamma+1)X a_1^2 + (\\gamma^2-1)X^2 + 2(\\gamma^2-1)q X = (a_1^2)^2 + 2\\gamma a_1^2 X + \\gamma^2 X^2 $$\nCollecting terms for the quadratic equation in $X$:\n$$ X^2(\\gamma^2-1-\\gamma^2) + X(2(\\gamma+1)a_1^2 + 2(\\gamma^2-1)q - 2\\gamma a_1^2) - a_1^4 = 0 $$\n$$ -X^2 + X(2\\gamma a_1^2 + 2a_1^2 + 2(\\gamma^2-1)q - 2\\gamma a_1^2) - a_1^4 = 0 $$\n$$ -X^2 + 2(a_1^2 + (\\gamma^2-1)q)X - a_1^4 = 0 $$\n$$ X^2 - 2[a_1^2 + (\\gamma^2-1)q]X + a_1^4 = 0 $$\nThis is the desired quadratic equation for $X = D_{CJ}^2$. We solve it using the quadratic formula $X = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$ D_{CJ}^2 = \\frac{2[a_1^2 + (\\gamma^2-1)q] \\pm \\sqrt{4[a_1^2 + (\\gamma^2-1)q]^2 - 4a_1^4}}{2} $$\n$$ D_{CJ}^2 = [a_1^2 + (\\gamma^2-1)q] \\pm \\sqrt{[a_1^2 + (\\gamma^2-1)q]^2 - a_1^4} $$\nExpanding the term under the square root:\n$$ \\sqrt{(a_1^4 + 2a_1^2(\\gamma^2-1)q + ((\\gamma^2-1)q)^2) - a_1^4} = \\sqrt{2a_1^2(\\gamma^2-1)q + ((\\gamma^2-1)q)^2} $$\n$$ = \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$\nThis gives two possible solutions for $D_{CJ}^2$:\n$$ D_{CJ}^2 = a_1^2 + (\\gamma^2-1)q \\pm \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$\nThe two solutions correspond to the \"strong\" and \"weak\" (or pathological) CJ detonation branches. The physically realized, self-sustaining detonation corresponds to the higher velocity, which is given by the positive sign. The solution with the negative sign leads to an unphysical result in the limit of large heat release ($q \\to \\infty$). Therefore, we select the positive root.\n\nThe final closed-form expression for the square of the Chapman-Jouguet detonation speed is:\n$$ D_{CJ}^2 = a_1^2 + (\\gamma^2-1)q + \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]} $$",
            "answer": "$$\\boxed{a_1^2 + (\\gamma^2-1)q + \\sqrt{(\\gamma^2-1)q [2a_1^2 + (\\gamma^2-1)q]}}$$"
        },
        {
            "introduction": "This final practice synthesizes the concepts of the shock jump and the final sonic state by numerically resolving the full ZND wave structure that connects them. You will model the continuous evolution of thermodynamic properties and chemical species through the finite-rate reaction zone. This computational exercise involves deriving and solving the stiff ordinary differential equations (ODEs) that describe the ZND profile, providing hands-on experience with the advanced numerical methods essential for modern computational combustion research .",
            "id": "4078305",
            "problem": "Consider a steady one-dimensional reactive flow described by the Zel'dovich–von Neumann–Döring (ZND) model in the wave-fixed frame for a calorically perfect gas with constant specific heat at constant pressure. The flow is governed by the conservation of mass, momentum, and energy, coupled to a single-step Arrhenius reaction for a reactant mass fraction. The goal is to derive the semi-discrete method-of-lines formulation suitable for numerical integration and to implement stiff ordinary differential equation (ODE) integrators with event detection at the Chapman–Jouguet (CJ) sonic point where the Mach number equals unity.\n\nStart from the fundamental steady one-dimensional conservation laws in the shock-attached (wave-fixed) frame, with the spatial coordinate denoted by $x$:\n- Conservation of mass: $d(\\rho u)/dx = 0$, where $\\rho$ is density and $u$ is the flow speed in the wave-fixed frame. This implies a constant mass flux $m$ such that $\\rho u = m$.\n- Conservation of momentum: $d(\\rho u^2 + p)/dx = 0$, where $p$ is pressure. This implies a constant momentum flux $P$ such that $\\rho u^2 + p = P$.\n- The energy relation including chemical potential with total energy conserved: $d\\left(c_p T + \\frac{u^2}{2} + q Y\\right)/dx = 0$, where $c_p$ is the specific heat at constant pressure, $T$ is temperature, $q$ is the chemical energy release per unit mass of reactant, and $Y$ is the reactant mass fraction.\n\nAssume the ideal gas equation of state $p = \\rho R T$, where $R$ is the specific gas constant, and a single-step Arrhenius reaction rate per unit volume $\\dot{\\omega} = -\\rho k Y \\exp\\left(-E/(R T)\\right)$, where $k$ is the pre-exponential factor and $E$ is the activation energy per unit mass. The species transport equation in the steady wave-fixed frame is $\\rho u \\, dY/dx = \\dot{\\omega}$.\n\nDerive the semi-discrete method-of-lines ODE system for the state vector $\\mathbf{y}(x) = [u(x), Y(x)]^\\top$ by:\n1. Eliminating $\\rho$ and $p$ using the mass and momentum invariants to express $T$ as a function of $u$, and obtaining $dT/du$.\n2. Using the energy relation to obtain $du/dx$ in terms of $dY/dx$ and $u$.\n3. Using the species equation to express $dY/dx$ in terms of $u$, $Y$, and $T(u)$.\n\nDefine the Mach number $M(u) = u / a$, where the speed of sound is $a(u) = \\sqrt{\\gamma R T(u)}$ and $\\gamma$ is the ratio of specific heats. The CJ sonic point is defined by the event $M(u) = 1$. Implement stiff ODE integration with event detection for $M(u) - 1 = 0$, and terminate integration at the CJ point or when the reactant is fully consumed $Y = 0$.\n\nYour program must:\n- Implement the derived ODE system and integrate it using a stiff method with event detection at $M = 1$ and at $Y = 0$.\n- For each test case, compute the spatial location $x_{\\text{sonic}}$ in meters at which the event $M = 1$ occurs. If the event does not occur within the integration domain, return $-1.0$.\n- Use the following parameterization for each test case: $(\\gamma, R, p_0, T_0, u_0, q, k, E, x_{\\max})$, where $p_0$ (Pascal), $T_0$ (Kelvin), and $u_0$ (meter per second) are the immediate post-shock properties setting the invariants $m$ and $P$, $q$ (Joule per kilogram) is the heat release, $k$ (inverse second) is the pre-exponential factor, $E$ (Joule per kilogram) is the activation energy, and $x_{\\max}$ (meter) is the maximum integration distance.\n- Use $c_p = \\gamma R / (\\gamma - 1)$ for a calorically perfect gas.\n- For numerical solutions, express the final answers in meters, rounded to six decimal places.\n\nTest Suite:\nProvide the following test cases to evaluate the solver:\n1. General case (event expected): $\\gamma = 1.4$, $R = 287$, $p_0 = 10^6$, $T_0 = 1200$, $u_0 = 1500$, $q = 2.0 \\times 10^6$, $k = 2.0 \\times 10^6$, $E = 1.5 \\times 10^6$, $x_{\\max} = 0.2$.\n2. Boundary case (no heat release, event not expected): $\\gamma = 1.4$, $R = 287$, $p_0 = 10^6$, $T_0 = 1200$, $u_0 = 1500$, $q = 0$, $k = 2.0 \\times 10^6$, $E = 1.5 \\times 10^6$, $x_{\\max} = 0.2$.\n3. Edge case (initially supersonic): $\\gamma = 1.4$, $R = 287$, $p_0 = 10^6$, $T_0 = 1200$, $u_0 = 900$, $q = 2.0 \\times 10^6$, $k = 2.0 \\times 10^6$, $E = 1.5 \\times 10^6$, $x_{\\max} = 0.2$.\n\nRequired Final Output Format:\nYour program should produce a single line of output containing a list of the $x_{\\text{sonic}}$ values for the three test cases, as a comma-separated list enclosed in square brackets, ordered as listed above, rounded to six decimal places. For example, the output should look like $[x_1,x_2,x_3]$ where each $x_i$ is a float in meters with six decimal places, and $-1.0$ indicates that the event $M = 1$ did not occur within the integration domain.",
            "solution": "The problem requires the derivation and numerical solution of the Zel'dovich–von Neumann–Döring (ZND) model for a steady one-dimensional detonation wave. The problem is scientifically sound, well-posed, and all necessary parameters are provided. A minor discrepancy in the description of test case 3, which incorrectly labels the initial condition as \"subsonic,\" is noted but does not invalidate the problem's formal specification, which is based on the provided numerical values. The solution will proceed based on these values.\n\nThe solution process involves first deriving the system of ordinary differential equations (ODEs) that describes the flow structure behind the leading shock wave, and then numerically integrating this system with event detection to find the location of the Chapman–Jouguet (CJ) sonic point.\n\n### Derivation of the ODE System\n\nThe goal is to derive the semi-discrete method-of-lines formulation for the state vector $\\mathbf{y}(x) = [u(x), Y(x)]^\\top$, which requires finding expressions for $du/dx$ and $dY/dx$.\n\n**1. Algebraic Relations and Invariants**\n\nThe flow is governed by the conservation of mass and momentum in the steady, one-dimensional wave-fixed frame.\nThe mass flux is constant:\n$$ \\rho u = m $$\nThe momentum flux is constant:\n$$ \\rho u^2 + p = P $$\nThe values of the constants $m$ and $P$ are determined by the initial post-shock conditions at $x=0$, denoted with a subscript $0$:\n$$ m = \\rho_0 u_0 $$\n$$ P = \\rho_0 u_0^2 + p_0 = m u_0 + p_0 $$\nwhere $\\rho_0 = p_0 / (R T_0)$ from the ideal gas law $p = \\rho R T$.\n\nUsing these invariants, we can express pressure $p$ and density $\\rho$ as functions of velocity $u$:\n$$ \\rho(u) = \\frac{m}{u} $$\n$$ p(u) = P - \\rho u^2 = P - \\frac{m}{u} u^2 = P - mu $$\nNow, we can express temperature $T$ as a function of $u$ using the ideal gas law:\n$$ T(u) = \\frac{p(u)}{\\rho(u) R} = \\frac{P - mu}{(m/u)R} = \\frac{u}{mR}(P - mu) $$\nThis equation describes the Rayleigh line.\n\n**2. Species Conservation Equation**\n\nThe species transport equation for the reactant mass fraction $Y$ in the steady wave-fixed frame is:\n$$ \\rho u \\frac{dY}{dx} = \\dot{\\omega} $$\nwhere $\\dot{\\omega}$ is the reaction rate per unit volume. With $\\rho u = m$, this becomes:\n$$ m \\frac{dY}{dx} = \\dot{\\omega} $$\nThe reaction rate is given by the single-step Arrhenius law:\n$$ \\dot{\\omega} = -\\rho k Y \\exp\\left(-\\frac{E}{R T}\\right) $$\nSubstituting $\\rho = m/u$, we get:\n$$ \\dot{\\omega} = -\\frac{m}{u} k Y \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\nThus, the ODE for the reactant mass fraction $Y$ is:\n$$ \\frac{dY}{dx} = \\frac{\\dot{\\omega}}{m} = -\\frac{k Y}{u} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n\n**3. Energy Conservation and the Velocity Equation**\n\nThe energy conservation equation is:\n$$ \\frac{d}{dx}\\left(c_p T + \\frac{u^2}{2} + q Y\\right) = 0 $$\nApplying the chain rule for differentiation with respect to $x$:\n$$ c_p \\frac{dT}{dx} + u \\frac{du}{dx} + q \\frac{dY}{dx} = 0 $$\nWe also have $\\frac{dT}{dx} = \\frac{dT}{du} \\frac{du}{dx}$. Substituting this into the energy equation gives:\n$$ \\left(c_p \\frac{dT}{du} + u\\right) \\frac{du}{dx} + q \\frac{dY}{dx} = 0 $$\nRearranging for $du/dx$:\n$$ \\frac{du}{dx} = \\frac{-q}{c_p \\frac{dT}{du} + u} \\frac{dY}{dx} $$\nTo simplify the denominator, we first find $dT/du$ from $T(u) = \\frac{Pu}{mR} - \\frac{u^2}{R}$:\n$$ \\frac{dT}{du} = \\frac{P}{mR} - \\frac{2u}{R} = \\frac{1}{R}\\left(\\frac{P}{m} - 2u\\right) $$\nThe speed of sound squared is $a^2 = \\gamma R T$. Substituting $T(u)$ gives:\n$$ a^2(u) = \\gamma R \\left(\\frac{u}{mR}(P-mu)\\right) = \\frac{\\gamma u}{m}(P-mu) $$\nThe denominator term is $c_p \\frac{dT}{du} + u$. Using $c_p = \\frac{\\gamma R}{\\gamma - 1}$:\n$$ c_p \\frac{dT}{du} + u = \\frac{\\gamma R}{\\gamma - 1} \\frac{1}{R}\\left(\\frac{P}{m} - 2u\\right) + u = \\frac{\\gamma(P/m-2u) + (\\gamma-1)u}{\\gamma-1} = \\frac{\\gamma P/m - (\\gamma+1)u}{\\gamma-1} $$\nFrom the expression for $a^2(u)$, we can write $P = \\frac{ma^2}{\\gamma u} + mu$. Substituting this for $P$ into the numerator of the previous expression gives:\n$$ \\gamma \\left(\\frac{a^2}{\\gamma u} + u\\right) - (\\gamma+1)u = \\frac{a^2}{u} + \\gamma u - \\gamma u - u = \\frac{a^2 - u^2}{u} $$\nTherefore, the denominator simplifies to:\n$$ c_p \\frac{dT}{du} + u = \\frac{(a^2-u^2)/u}{\\gamma-1} = \\frac{a^2(u) - u^2}{u(\\gamma-1)} $$\nThis denominator is proportional to $1 - M^2$, where $M=u/a$ is the Mach number. It becomes zero at the sonic point, $M=1$, which is a singularity of the ODE system.\n\nSubstituting this simplified denominator back into the expression for $du/dx$:\n$$ \\frac{du}{dx} = \\frac{-q u(\\gamma-1)}{a^2(u) - u^2} \\frac{dY}{dx} $$\nFinally, we can express $du/dx$ solely in terms of the state variables $(u, Y)$ by substituting the expression for $dY/dx$:\n$$ \\frac{du}{dx} = \\frac{-q u(\\gamma-1)}{a^2(u) - u^2} \\left[ -\\frac{k Y}{u} \\exp\\left(-\\frac{E}{R T(u)}\\right) \\right] = \\frac{q (\\gamma-1) k Y}{a^2(u) - u^2} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n\n**4. Final ODE System**\n\nThe state of the system is described by $\\mathbf{y}(x) = [u(x), Y(x)]^\\top$. The governing ODEs are:\n$$ \\frac{du}{dx} = \\frac{q (\\gamma-1) k Y}{a^2(u) - u^2} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\n$$ \\frac{dY}{dx} = -\\frac{k Y}{u} \\exp\\left(-\\frac{E}{R T(u)}\\right) $$\nwhere $T(u) = \\frac{u}{mR}(P-mu)$ and $a^2(u) = \\gamma R T(u)$. The initial conditions are $u(0)=u_0$ and $Y(0)=1$. This system is numerically stiff, especially near the sonic point where the denominator of $du/dx$ approaches zero. A stiff ODE solver with event detection is required to find the CJ point, defined by the condition $M(u)=1$, or equivalently, $u^2 - a^2(u) = 0$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the ZND problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (gamma, R, p0, T0, u0, q, k, E, x_max)\n        (1.4, 287.0, 1.0e6, 1200.0, 1500.0, 2.0e6, 2.0e6, 1.5e6, 0.2),\n        (1.4, 287.0, 1.0e6, 1200.0, 1500.0, 0.0, 2.0e6, 1.5e6, 0.2),\n        (1.4, 287.0, 1.0e6, 1200.0, 900.0, 2.0e6, 2.0e6, 1.5e6, 0.2),\n    ]\n\n    results = []\n    for params in test_cases:\n        x_sonic = solve_znd_case(params)\n        if x_sonic != -1.0:\n            results.append(f\"{x_sonic:.6f}\")\n        else:\n            results.append(\"-1.000000\")\n            \n    print(f\"[{','.join(results)}]\")\n\ndef solve_znd_case(params):\n    \"\"\"\n    Solves the ZND ODE system for a single parameter set.\n    \n    Args:\n        params (tuple): A tuple of physical and numerical parameters.\n    \n    Returns:\n        float: The spatial location x_sonic where M=1, or -1.0 if not found.\n    \"\"\"\n    gamma, R, p0, T0, u0, q, k, E, x_max = params\n\n    # Handle the trivial case of no heat release\n    if q == 0.0:\n        return -1.0\n\n    # Calculate flow invariants from post-shock conditions\n    rho0 = p0 / (R * T0)\n    m_flux = rho0 * u0\n    P_flux = m_flux * u0 + p0\n    \n    # Check if the initial state is already sonic\n    # T(u) = u/(m*R) * (P-m*u)\n    T_val_u0 = u0 * (P_flux - m_flux * u0) / (m_flux * R)\n    a_sq_u0 = gamma * R * T_val_u0\n    if np.isclose(u0**2, a_sq_u0):\n        return 0.0\n\n    # Define the ODE system dy/dx = f(x, y)\n    def odefunc(x, y):\n        u, Y = y[0], y[1]\n\n        # Stop integration if state becomes non-physical\n        if Y  0 or u = 0:\n            return [0.0, 0.0]\n        Y = max(Y, 0) # Clip Y to non-negative\n\n        # Algebraic relations for Temperature and speed of sound squared\n        T_val = u * (P_flux - m_flux * u) / (m_flux * R)\n        if T_val = 0:\n            return [0.0, 0.0]\n        \n        a_sq = gamma * R * T_val\n\n        # Reaction rate exponential term\n        # E is in J/kg, R is in J/kg-K, so E/(R*T) is dimensionless.\n        exp_term = np.exp(-E / (R * T_val))\n        \n        # dY/dx\n        dYdx = -k * Y / u * exp_term\n\n        # du/dx\n        denom = a_sq - u**2\n        if np.isclose(denom, 0.0):\n             # This part should not be reached if event detection works correctly.\n             # It's a safeguard against division by zero.\n             return [0.0, 0.0]\n        dudx = (q * (gamma - 1.0) / denom) * (u * dYdx)\n\n        return [dudx, dYdx]\n\n    # Event function for sonic condition (M=1)\n    def sonic_event(x, y):\n        u = y[0]\n        T_val = u * (P_flux - m_flux * u) / (m_flux * R)\n        if T_val = 0:\n             return 1.0 # Return a positive value to not trigger event\n        a_sq = gamma * R * T_val\n        # Event triggers when this function is zero\n        return u**2 - a_sq\n    sonic_event.terminal = True\n    sonic_event.direction = 0  # Find root regardless of crossing direction\n\n    # Event function for fuel depletion (Y=0)\n    def fuel_depletion_event(x, y):\n        return y[1]\n    fuel_depletion_event.terminal = True\n    fuel_depletion_event.direction = -1 # Trigger when Y decreases to 0\n\n    # Initial conditions at x=0\n    y0 = [u0, 1.0]\n    \n    # Solve the ODE system using a stiff integrator\n    sol = solve_ivp(\n        fun=odefunc,\n        t_span=(0, x_max),\n        y0=y0,\n        method='Radau',\n        events=[sonic_event, fuel_depletion_event],\n        atol=1e-9,  # Use tight tolerances for accuracy\n        rtol=1e-9,\n    )\n    \n    # Extract the result from the solver output\n    # `sol.status == 1` indicates a termination event occurred.\n    # `sol.t_events[0]` corresponds to `sonic_event`.\n    if sol.status == 1 and sol.t_events[0].size  0:\n        return sol.t_events[0][0]\n\n    return -1.0\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}