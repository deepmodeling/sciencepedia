{
    "hands_on_practices": [
        {
            "introduction": "对爆轰波进行数值建模的第一步是理解其底层的物理模型。本练习将引导您应用泽尔多维奇-冯·诺伊曼-多林（ZND）模型，从基本守恒定律出发，推导并计算决定稳定爆轰传播速度的查普曼-茹盖（CJ）条件。通过这个实践，您将加深对连接初始反应物状态、化学能释放与独特爆轰速度之间关系的理解。",
            "id": "4045497",
            "problem": "考虑一个由 Zeldovich–von Neumann–Döring (ZND) 模型描述的一维平面爆轰，其中一个前导惰性激波之后是一个有限的反应区，该反应区释放固定的单位质量热量 $q$，并在反应区末端达到热化学平衡。假设气体为量热完全理想气体，具有恒定的比热比 $\\gamma$ 和气体常数 $R$，并发生单一总包不可逆反应，单位质量放热量为 $q$。在附着于爆轰波的参考系中进行分析，并将激波和反应区视为无粘、定常和一维的。\n\n给定初始未燃状态 $(p_{1}, T_{1})$，使用基本的质量、动量和能量守恒定律，以及理想气体状态方程，以：\n- 推导紧随惰性激波之后（无反应）的激波后 von Neumann 状态，\n- 应用反应，同时保持守恒的质量通量和动量通量，以达到 ZND 最终平衡状态，\n- 通过要求反应区末端的流动相对于爆轰前沿为声速来强制执行 Chapman–Jouguet (CJ) 条件，\n- 并计算相应的 CJ 爆轰速度 $D_{\\mathrm{CJ}}$。\n\n在整个推导过程中，仅使用以下基本关系式：\n- 质量守恒：$m = \\rho u$（在激波和反应区中为常数），\n- 动量守恒：$p + m^{2} v = \\text{constant}$，\n- 能量守恒：$h + \\frac{u^{2}}{2} = \\text{constant}$ 穿过激波，并且 $h + \\frac{u^{2}}{2}$ 在穿过反应区时增加 $q$，\n- 理想气体：$p = \\rho R T$， $h = \\frac{\\gamma}{\\gamma - 1} \\frac{p}{\\rho}$， $v = \\frac{1}{\\rho}$。\n\n数据：\n- $p_{1} = 1.01325 \\times 10^{5}$ $\\text{Pa}$，\n- $T_{1} = 300$ $\\text{K}$，\n- $\\gamma = 1.4$，\n- $R = 287$ $\\text{J/(kg}\\cdot\\text{K)}$，\n- $q = 3.0 \\times 10^{6}$ $\\text{J/kg}$。\n\n计算 $D_{\\mathrm{CJ}}$ 并以 $\\mathrm{m/s}$ 为单位表示最终答案。将您的答案四舍五入到四位有效数字。",
            "solution": "用户要求我基于 Zeldovich–von Neumann–Döring (ZND) 爆轰模型解决一个问题。\n\n### 1. 问题验证\n\n#### 步骤 1：提取已知条件\n- **框架**：一维平面爆轰，ZND 模型，量热完全理想气体。\n- **假设**：无粘、定常、一维的激波和反应区。\n- **初始状态（未燃气体，状态 1）**：$p_1 = 1.01325 \\times 10^{5} \\, \\text{Pa}$，$T_1 = 300 \\, \\text{K}$。\n- **气体性质**：比热比 $\\gamma = 1.4$，气体常数 $R = 287 \\, \\text{J/(kg}\\cdot\\text{K)}$。\n- **反应**：单一不可逆反应，单位质量放热量 $q = 3.0 \\times 10^{6} \\, \\text{J/kg}$。\n- **守恒定律（附着于波的参考系）**：\n    - 质量：$m = \\rho u = \\text{constant}$\n    - 动量：$p + m^{2} v = \\text{constant}$，其中 $v=1/\\rho$。\n    - 能量（激波）：$h + \\frac{u^{2}}{2} = \\text{constant}$\n    - 能量（反应）：$h + \\frac{u^{2}}{2}$ 增加 $q$。\n- **状态方程**：\n    - 理想气体定律：$p = \\rho R T$\n    - 比焓：$h = \\frac{\\gamma}{\\gamma - 1} \\frac{p}{\\rho}$\n- **条件**：Chapman–Jouguet (CJ) 条件：反应区末端的流动相对于爆轰前沿为声速。\n- **目标**：计算 CJ 爆轰速度 $D_{\\mathrm{CJ}}$，单位为 $\\mathrm{m/s}$，并四舍五入到四位有效数字。\n\n#### 步骤 2：使用提取的已知条件进行验证\n这是一个科学上成立的问题，是基于成熟的 ZND 模型的燃烧理论中的一个经典问题。所提供的数据对于气体混合物是物理上现实的。这是一个适定问题，提供了计算 CJ 爆轰速度所需的所有必要信息（$\\gamma, R, q, T_1$），在给定假设下该速度是唯一的。语言客观而精确。该问题不违反任何无效性标准。\n\n#### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 2. 解答推导\n\n问题要求计算满足 Chapman-Jouguet 条件的 ZND 爆轰波的爆轰速度 $D_{\\mathrm{CJ}}$。我们在附着于爆轰波的坐标系中进行计算。在此参考系中，未燃气体（状态 1）以速度 $u_1$ 进入静止的波，该速度等于实验室参考系中的爆轰速度 $D$。已燃气体（状态 2）以速度 $u_2$ 离开波。\n\n从状态 1 到状态 2 的整体变化的主导方程是反应流的 Rankine-Hugoniot 关系式：\n1.  **质量守恒**：\n    $$m = \\rho_1 u_1 = \\rho_2 u_2$$\n2.  **动量守恒**：\n    $$p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2$$\n3.  **能量守恒**：\n    $$h_1 + \\frac{u_1^2}{2} + q = h_2 + \\frac{u_2^2}{2}$$\n\n我们使用理想气体关系式：$h = \\frac{\\gamma}{\\gamma-1} \\frac{p}{\\rho}$ 以及声速 $c = \\sqrt{\\gamma \\frac{p}{\\rho}} = \\sqrt{\\gamma R T}$。因此，焓可以写为 $h = \\frac{c^2}{\\gamma-1}$。\n\nChapman-Jouguet (CJ) 条件指出，对于自持爆轰，反应区末端（状态 2）的流动相对于波是声速的。\n$$u_2 = c_2$$\n\n求解的逻辑路径是利用 CJ 条件来确定唯一的爆轰速度 $D_{\\mathrm{CJ}}$。设 $u_1 = D_{\\mathrm{CJ}}$。爆轰马赫数为 $M_{\\mathrm{CJ}} = D_{\\mathrm{CJ}}/c_1$。让我们用 $M_{\\mathrm{CJ}}$ 来表示状态变量。\n\n由动量方程，使用 $u_1 = D_{\\mathrm{CJ}}$ 和 $u_2=c_2$：\n$$p_1 + \\rho_1 D_{\\mathrm{CJ}}^2 = p_2 + \\rho_2 c_2^2$$\n使用 $c_2^2 = \\gamma p_2/\\rho_2$，我们得到：\n$$p_1 + \\rho_1 D_{\\mathrm{CJ}}^2 = p_2 + \\rho_2 (\\gamma p_2/\\rho_2) = p_2(1+\\gamma)$$\n整理得到压力比 $p_2/p_1$：\n$$\\frac{p_2}{p_1} = \\frac{p_1 + \\rho_1 D_{\\mathrm{CJ}}^2}{p_1(1+\\gamma)} = \\frac{1 + \\frac{\\rho_1 D_{\\mathrm{CJ}}^2}{p_1}}{1+\\gamma}$$\n认识到 $\\frac{\\rho_1 D_{\\mathrm{CJ}}^2}{p_1} = \\frac{\\gamma \\rho_1 D_{\\mathrm{CJ}}^2}{\\gamma p_1} = \\gamma \\frac{D_{\\mathrm{CJ}}^2}{c_1^2} = \\gamma M_{\\mathrm{CJ}}^2$，我们有：\n$$\\frac{p_2}{p_1} = \\frac{1 + \\gamma M_{\\mathrm{CJ}}^2}{1+\\gamma}$$\n\n接下来，我们结合质量和动量方程来求比容比 $v_2/v_1 = \\rho_1/\\rho_2$。\n动量方程可以写成 $p_2 - p_1 = m^2(v_1 - v_2)$，其中 $v=1/\\rho$。从 CJ 条件，我们也可以将质量通量 $m$ 与状态 2 的性质联系起来。\n$$m = \\rho_2 u_2 = \\rho_2 c_2 \\implies m^2 = \\rho_2^2 c_2^2 = \\rho_2^2 \\frac{\\gamma p_2}{\\rho_2} = \\gamma p_2 \\rho_2 = \\frac{\\gamma p_2}{v_2}$$\n令两个 $m^2$ 的表达式相等：\n$$\\frac{p_2 - p_1}{v_1 - v_2} = \\frac{\\gamma p_2}{v_2}$$\n$$(p_2 - p_1)v_2 = \\gamma p_2(v_1-v_2) \\implies p_2 v_2 (1+\\gamma) = \\gamma p_2 v_1 + p_1 v_2$$\n两边同除以 $p_2 v_2$ 得到关系式 $1+\\gamma = \\gamma \\frac{v_1}{v_2} + \\frac{p_1}{p_2}$。\n由此，我们求出比容比：\n$$\\frac{v_2}{v_1} = \\frac{1+\\gamma M_{\\mathrm{CJ}}^2}{(1+\\gamma)M_{\\mathrm{CJ}}^2}$$\n\n现在我们使用能量方程，代入 $h = c^2/(\\gamma-1)$，$u_1=D_{\\mathrm{CJ}}=M_{\\mathrm{CJ}}c_1$ 和 $u_2=c_2$：\n$$\\frac{c_1^2}{\\gamma-1} + \\frac{M_{\\mathrm{CJ}}^2 c_1^2}{2} + q = \\frac{c_2^2}{\\gamma-1} + \\frac{c_2^2}{2}$$\n$$c_2^2\\left(\\frac{1}{\\gamma-1} + \\frac{1}{2}\\right) - c_1^2\\left(\\frac{1}{\\gamma-1} + \\frac{M_{\\mathrm{CJ}}^2}{2}\\right) = q$$\n$$c_2^2\\frac{\\gamma+1}{2(\\gamma-1)} - c_1^2\\frac{2 + M_{\\mathrm{CJ}}^2(\\gamma-1)}{2(\\gamma-1)} = q$$\n两边同除以 $c_1^2$ 并乘以 $2(\\gamma-1)$：\n$$\\frac{c_2^2}{c_1^2}(\\gamma+1) - (2 + M_{\\mathrm{CJ}}^2(\\gamma-1)) = \\frac{2(\\gamma-1)q}{c_1^2}$$\n声速平方比是 $\\frac{c_2^2}{c_1^2} = \\frac{\\gamma p_2 v_2}{\\gamma p_1 v_1} = \\frac{p_2}{p_1}\\frac{v_2}{v_1}$。\n$$\\frac{c_2^2}{c_1^2} = \\left(\\frac{1 + \\gamma M_{\\mathrm{CJ}}^2}{1+\\gamma}\\right)\\left(\\frac{1+\\gamma M_{\\mathrm{CJ}}^2}{(1+\\gamma)M_{\\mathrm{CJ}}^2}\\right) = \\frac{(1+\\gamma M_{\\mathrm{CJ}}^2)^2}{(1+\\gamma)^2 M_{\\mathrm{CJ}}^2}$$\n将此代入能量方程：\n$$\\frac{(1+\\gamma M_{\\mathrm{CJ}}^2)^2}{(1+\\gamma)^2 M_{\\mathrm{CJ}}^2}(\\gamma+1) - (2 + M_{\\mathrm{CJ}}^2(\\gamma-1)) = \\frac{2(\\gamma-1)q}{c_1^2}$$\n$$\\frac{(1+\\gamma M_{\\mathrm{CJ}}^2)^2}{(1+\\gamma) M_{\\mathrm{CJ}}^2} - (2 + M_{\\mathrm{CJ}}^2(\\gamma-1)) = \\frac{2(\\gamma-1)q}{c_1^2}$$\n经过代数化简，可得：\n$$(M_{\\mathrm{CJ}}^2 - 1)^2 = 2(\\gamma^2-1)M_{\\mathrm{CJ}}^2 \\frac{q}{c_1^2}$$\n这可以简化为一个将马赫数与放热量联系起来的标准结果：\n$$\\frac{(M_{\\mathrm{CJ}}^2 - 1)^2}{M_{\\mathrm{CJ}}^2} = \\frac{2(\\gamma^2-1)q}{c_1^2} = \\frac{2(\\gamma^2-1)q}{\\gamma R T_1}$$\n一个等价、更简洁的 $M_{\\mathrm{CJ}}$ 形式是：\n$$M_{\\mathrm{CJ}} = \\sqrt{1 + Q} + \\sqrt{Q} \\quad \\text{其中} \\quad Q = \\frac{(\\gamma^2-1)q}{2\\gamma R T_1}$$\n\n### 3. 数值计算\n已知条件：\n- $\\gamma = 1.4$\n- $R = 287 \\, \\text{J/(kg}\\cdot\\text{K)}$\n- $T_1 = 300 \\, \\text{K}$\n- $q = 3.0 \\times 10^6 \\, \\text{J/kg}$\n\n首先，我们计算初始声速 $c_1$：\n$$c_1 = \\sqrt{\\gamma R T_1} = \\sqrt{1.4 \\times 287 \\times 300} = \\sqrt{120540} \\approx 347.1887 \\, \\mathrm{m/s}$$\n接下来，我们计算无量纲放热参数 $Q$：\n$$\\gamma^2 - 1 = 1.4^2 - 1 = 1.96 - 1 = 0.96$$\n$$Q = \\frac{(\\gamma^2-1)q}{2\\gamma R T_1} = \\frac{0.96 \\times (3.0 \\times 10^6)}{2 \\times 1.4 \\times (287 \\times 300)} = \\frac{2.88 \\times 10^6}{2 \\times 1.4 \\times 86100} = \\frac{2.88 \\times 10^6}{241080} \\approx 11.9462$$\n现在，我们计算 Chapman-Jouguet 马赫数 $M_{\\mathrm{CJ}}$：\n$$M_{\\mathrm{CJ}} = \\sqrt{1 + 11.9462} + \\sqrt{11.9462} = \\sqrt{12.9462} + \\sqrt{11.9462}$$\n$$M_{\\mathrm{CJ}} \\approx 3.59808 + 3.45633 \\approx 7.05441$$\n最后，我们计算 CJ 爆轰速度 $D_{\\mathrm{CJ}}$：\n$$D_{\\mathrm{CJ}} = M_{\\mathrm{CJ}} c_1 \\approx 7.05441 \\times 347.1887 \\, \\mathrm{m/s} \\approx 2449.19 \\, \\mathrm{m/s}$$\n将结果四舍五入到四位有效数字，得到 $2449 \\, \\mathrm{m/s}$。",
            "answer": "$$2449$$"
        },
        {
            "introduction": "在计算反应流中，一个核心挑战是如何处理流体动力学和化学反应之间的紧密耦合。算子分裂是一种常用技术，它将这两个过程解耦以简化求解，但这会引入误差，因为流体动力学和化学反应算子是不可交换的。本练习要求您构建一个精确的黎曼问题求解器，并通过它来量化两种不同分裂序列（流体-化学与化学-流体）所产生的误差，从而深入理解高阶数值格式设计的关键考量。",
            "id": "4045489",
            "problem": "考虑一个由欧拉方程控制的无粘、量热完全理想气体的一维黎曼问题。您将为惰性流体动力学（质量、动量或总能量方程中无源项）构建精确解，然后引入一个单步放热反应的化学源项，该反应在定容假设下演化被动物种的质量分数和温度。目标是通过在一个有限时间步长上比较两个一阶 Lie 分裂序列来量化算子分裂引入的误差：先流体动力学后化学，与先化学后流体动力学。您必须以国际单位制（SI）表示所有物理量。所有角度（若有）必须以弧度表示。任何包含比例的答案都应表示为十进制数。\n\n基本依据：您必须使用的控制定律和定义如下。\n- 一维无粘理想气体的质量、动量和能量的欧拉方程，在 $x = 0$ 处具有初始左右间断，定义了黎曼问题的自相似解结构，表现为从 $x = 0$ 处发出的波，其速度与 $x/t$ 成正比。\n- 对于理想气体，状态方程为 $p = \\rho R T$，其中 $p$ 是压力，$\\rho$ 是密度，$R$ 是比气体常数， $T$ 是温度。比热比满足 $\\gamma = c_p / c_v$，其中 $c_v = R / (\\gamma - 1)$ 和 $c_p = \\gamma R / (\\gamma - 1)$。\n- 接触间断（中心状态）处的精确黎曼解在其左右两侧具有相等的压力和速度，分别表示为 $p^\\star$ 和 $u^\\star$。非线性源于激波的 Rankine–Hugoniot 关系和等熵稀疏关系，它们共同产生一个关于 $p^\\star$ 的标量非线性方程。\n- 化学模型是一个在定容、充分混合气体中的单步放热反应，物种质量分数 $Y$ 的演化遵循 $\\mathrm{d}Y/\\mathrm{d}t = -\\omega(T) \\, Y$，其中 $\\omega(T) = A \\exp\\!\\left(- E / (R_u T)\\right)$ 是 Arrhenius 速率，$A$ 是指前因子，$E$ 是活化能，$R_u$ 是通用气体常数。单位质量的放热量为 $Q$，温度通过 $\\mathrm{d}T/\\mathrm{d}t = (Q/c_v) \\, \\omega(T) \\, Y$ 演化。\n\n算子分裂设计：在持续时间为 $t > 0$ 的单个时间步长上，定义两个作用于 $x = 0$ 处左右黎曼初始数据的一阶 Lie 分裂序列。\n- 流体动力学优先 (HF)：求解惰性黎曼问题以找到 $(p^\\star,u^\\star)$ 以及在 $x=0$ 处的相应中心温度 $T^\\star$。然后，在定容条件下，使用化学源常微分方程 (ODE) 从 $(Y_0, T^\\star)$ 开始演化物种和温度，持续时间 $t$。将得到的温度表示为 $T_{\\mathrm{HF}}(t)$。\n- 化学优先 (CF)：在定容条件下，使用化学源常微分方程独立地演化左右初始状态，从 $(Y_0, T_L)$ 和 $(Y_0, T_R)$ 开始，持续时间 $t$，得到 $(Y_L(t), T_L(t))$ 和 $(Y_R(t), T_R(t))$。在保持 $\\rho$ 和 $u$ 不变的情况下，使用 $p_L'(t) = \\rho_L R T_L(t)$ 和 $p_R'(t) = \\rho_R R T_R(t)$ 更新左右压力。然后，用这些更新后的左右状态求解惰性黎曼问题，以获得在 $x=0$ 处的相应中心状态温度，表示为 $T_{\\mathrm{CF}}(t)$。\n\n将中心处的分裂误差定义为绝对温差 $e_T = \\left| T_{\\mathrm{HF}}(t) - T_{\\mathrm{CF}}(t) \\right|$，以 $\\mathrm{K}$ 为单位表示。\n\n您必须在一个完整的程序中实现以下步骤：\n1. 为给定的左右状态构建中心 $x=0$ 处的精确惰性黎曼解。基于物理上一致的激波和稀疏关系，对定义 $p^\\star$ 的标量方程使用稳健的求根迭代。然后计算 $u^\\star$ 和左右星区密度。将中心温度 $T^\\star$ 确定为包含 $x/t = 0$ 的接触间断一侧的星区温度，即，如果 $u^\\star > 0$，则 $T^\\star = T_L^\\star$；如果 $u^\\star < 0$，则 $T^\\star = T_R^\\star$。\n2. 使用给定的参数和 Arrhenius 源，实现对 $(Y,T)$ 的定容化学积分，从初始条件 $(Y_0,T_0)$ 得到 $(Y(t),T(t))$。\n3. 基于上述定义的 HF 和 CF 序列，为每个测试用例计算 $e_T$。\n\n物理和数值参数：\n- 通用气体常数：$R_u = 8.314462618 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 混合物分子量：$M = 0.02897 \\ \\mathrm{kg}\\,\\mathrm{mol}^{-1}$。\n- 比气体常数：$R = R_u / M$。\n- 比热比：$\\gamma = 1.4$。\n- 单位质量放热量：$Q = 2.0 \\times 10^{6} \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$。\n- Arrhenius 指前因子：$A = 1.0 \\times 10^{3} \\ \\mathrm{s}^{-1}$。\n- 活化能：$E = 6.0 \\times 10^{4} \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 初始燃料质量分数：$Y_0 = 0.10$。\n- 所有初始速度以 $\\mathrm{m}\\,\\mathrm{s}^{-1}$ 表示，密度以 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$ 表示，压力以 $\\mathrm{Pa}$ 表示，温度以 $\\mathrm{K}$ 表示，时间以 $\\mathrm{s}$ 表示。\n\n测试套件：\n- 用例 1（典型强左状态）：左状态 $(\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0 \\times 10^{5})$，右状态 $(\\rho_R, u_R, p_R) = (0.125, 0.0, 1.0 \\times 10^{4})$，时间 $t = 1.0 \\times 10^{-4}$。\n- 用例 2（高压左状态）：左状态 $(\\rho_L, u_L, p_L) = (5.0, 0.0, 2.0 \\times 10^{6})$，右状态 $(\\rho_R, u_R, p_R) = (1.0, 0.0, 1.0 \\times 10^{5})$，时间 $t = 5.0 \\times 10^{-5}$。\n- 用例 3（等压逆流）：左状态 $(\\rho_L, u_L, p_L) = (1.0, 1.0 \\times 10^{2}, 1.0 \\times 10^{5})$，右状态 $(\\rho_R, u_R, p_R) = (1.0, -1.0 \\times 10^{2}, 1.0 \\times 10^{5})$，时间 $t = 1.0 \\times 10^{-5}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的分裂误差 $e_T$，格式为方括号括起来的逗号分隔列表，例如 $\\left[ e_1, e_2, e_3 \\right]$。这些值必须以十进制浮点数形式打印，单位为 $\\mathrm{K}$，使用语言的默认字符串转换，并且不包含任何额外文本。",
            "solution": "本任务是量化一维反应欧拉方程的一阶算子分裂误差。这通过比较两个 Lie 分裂序列来实现：流体动力学优先 (HF) 和化学优先 (CF)。误差以单个时间步长 $t$ 后黎曼问题解中心的绝对温差来衡量。\n\n物理模型包括两部分：由欧拉方程控制的惰性流体动力学和由一组常微分方程 (ODE) 控制的化学动力学。\n\n一维无粘、非导热流动的控制方程是欧拉方程：\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E_t \\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E_t + p) \\end{pmatrix}\n= 0\n$$\n其中 $\\rho$ 是密度， $u$ 是速度， $p$ 是压力， $E_t = \\rho e + \\frac{1}{2}\\rho u^2$ 是单位体积的总能量， $e$ 是比内能。对于量热完全理想气体，状态方程为 $p = \\rho R T$，其中 $T$ 是温度， $R$ 是比气体常数。比内能为 $e = c_v T$，其中 $c_v$ 是定容比热。这些常数通过 $R = c_p - c_v$ 和 $\\gamma = c_p/c_v$ 相关联，从而得出 $c_v = R/(\\gamma - 1)$。\n\n化学模型描述了在定容、充分混合系统中物种质量分数 $Y$ 和温度 $T$ 的演化。控制常微分方程 (ODE) 如下：\n$$\n\\frac{\\mathrm{d}Y}{\\mathrm{d}t} = -\\omega(T) Y\n$$\n$$\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{Q}{c_v} \\omega(T) Y\n$$\n其中 $Q$ 是反应热，$\\omega(T)$ 是 Arrhenius 反应速率，$\\omega(T) = A \\exp(-E / (R_u T))$。此处，$A$ 是指前因子，$E$ 是活化能，$R_u$ 是通用气体常数。\n\n求解策略包括为惰性欧拉方程实现一个精确黎曼求解器，为化学常微分方程实现一个数值积分器，然后根据指定的分裂序列将它们组合起来。\n\n**1. 精确惰性黎曼求解器**\n\n在 $x=0$ 处具有初始间断的黎曼问题有一个自相似解，该解仅依赖于相似变量 $\\xi = x/t$。该解由左行波和右行波（激波或稀疏波）组成，它们将初始左 (L) 和右 (R) 状态与一个中心的“星区”分离开。在星区内，压力 $p^\\star$ 和速度 $u^\\star$ 是恒定的，但密度和温度在一个以速度 $u^\\star$ 移动的接触面上是不连续的。\n\n求解器的核心是找到压力 $p^\\star$。这通过求解一个确保接触间断处速度相容的单一非线性代数方程来实现：\n$$\n\\phi(p^\\star) = f_L(p^\\star, \\rho_L, p_L) + f_R(p^\\star, \\rho_R, p_R) + u_R - u_L = 0\n$$\n函数 $f_K(p, \\rho_K, p_K)$ 表示从状态 K 开始的右行波（对于 $f_L$）或从状态 K 开始的左行波（对于 $f_R$）所引起的速度变化。其形式取决于波是激波 ($p > p_K$) 还是稀疏波 ($p \\le p_K$)。设 $a_K = \\sqrt{\\gamma p_K / \\rho_K}$ 为状态 K 中的声速。\n\n对于激波 ($p > p_K$)，Rankine-Hugoniot 关系给出：\n$$\nf_K(p, \\rho_K, p_K) = (p - p_K) \\sqrt{\\frac{2 / ((\\gamma+1)\\rho_K)}{p + \\frac{\\gamma-1}{\\gamma+1}p_K}}\n$$\n对于稀疏波 ($p \\le p_K$)，等熵关系给出：\n$$\nf_K(p, \\rho_K, p_K) = \\frac{2 a_K}{\\gamma - 1} \\left[ \\left(\\frac{p}{p_K}\\right)^{\\frac{\\gamma-1}{2\\gamma}} - 1 \\right]\n$$\n这个关于 $p^\\star$ 的非线性方程使用 Newton-Raphson 方法进行数值求解，该方法需要导数 $\\phi'(p^\\star) = f'_L(p^\\star) + f'_R(p^\\star)$。导数 $f'_K(p)$ 也是解析确定的。\n\n一旦求得 $p^\\star$，速度 $u^\\star$ 按如下方式计算：\n$$\nu^\\star = \\frac{1}{2}(u_L + u_R) + \\frac{1}{2}(f_R(p^\\star, \\rho_R, p_R) - f_L(p^\\star, \\rho_L, p_L))\n$$\n星区中的密度 $\\rho_L^\\star$ 和 $\\rho_R^\\star$ 使用相应的激波或稀疏关系求得：\n- 对于激波 ($p^\\star > p_K$)：$\\rho_K^\\star = \\rho_K \\frac{ p^\\star/p_K + (\\gamma-1)/(\\gamma+1) }{ ((\\gamma-1)/(\\gamma+1)) p^\\star/p_K + 1 }$\n- 对于稀疏波 ($p^\\star \\le p_K$)：$\\rho_K^\\star = \\rho_K ( p^\\star/p_K )^{1/\\gamma}$\n\n最后，星区温度由理想气体定律计算得出：$T_L^\\star = p^\\star/(\\rho_L^\\star R)$ 和 $T_R^\\star = p^\\star/(\\rho_R^\\star R)$。问题指定中心温度 $T^\\star$ 是包含点 $x/t = 0$ 的接触间断一侧的温度。这取决于 $u^\\star$ 的符号：如果 $u^\\star > 0$，原点位于左星区状态，因此 $T^\\star=T_L^\\star$。如果 $u^\\star < 0$，原点位于右星区状态，因此 $T^\\star=T_R^\\star$。对于 $u^\\star=0$ 的特殊情况，我们选择 $T_L^\\star$，这对给定的测试用例是有效的，因为对称性保证了 $T_L^\\star=T_R^\\star$。\n\n**2. 化学动力学积分器**\n\n化学系统在定容假设下演化。对于在小时间步长 $t$ 上评估的一阶分裂方法，使用一阶数值积分器是一致的。单步显式前向欧拉法是充分且合适的，因为其局部截断误差为 $O(t^2)$，与 Lie 分裂误差的阶数相匹配。\n状态 $(Y, T)$ 从初始状态 $(Y_0, T_0)$ 更新如下：\n$$\nY(t) \\approx Y_0 - t \\cdot \\omega(T_0) Y_0\n$$\n$$\nT(t) \\approx T_0 + t \\cdot \\frac{Q}{c_v} \\omega(T_0) Y_0\n$$\n由于后续步骤仅需要最终温度，我们直接计算 $T(t)$。\n\n**3. 算子分裂序列**\n\n这两个序列在持续时间为 $t$ 的单个时间步长上实现如下：\n\n**流体动力学优先 (HF)：**\n1. 给定初始状态 $(\\rho_L, u_L, p_L)$ 和 $(\\rho_R, u_R, p_R)$。\n2. 求解惰性黎曼问题以找到 $u^\\star$ 和中心温度 $T^\\star$。\n3. 从初始条件 $(Y_0, T^\\star)$ 开始，使用欧拉步长演化化学反应，持续时间 $t$，以获得最终温度 $T_{\\mathrm{HF}}(t)$。\n\n**化学优先 (CF)：**\n1. 给定初始状态 $(\\rho_L, u_L, p_L)$ 和 $(\\rho_R, u_R, p_R)$，计算初始温度 $T_L = p_L/(\\rho_L R)$ 和 $T_R = p_R/(\\rho_R R)$。\n2. 从 $(Y_0, T_L)$ 开始演化左状态的化学反应，持续时间 $t$，得到 $T_L(t)$。\n3. 从 $(Y_0, T_R)$ 开始演化右状态的化学反应，持续时间 $t$，得到 $T_R(t)$。\n4. 根据新温度更新压力，同时保持密度不变：$p'_L(t) = \\rho_L R T_L(t)$ 和 $p'_R(t) = \\rho_R R T_R(t)$。\n5. 使用更新后的状态 $(\\rho_L, u_L, p'_L(t))$ 和 $(\\rho_R, u_R, p'_R(t))$ 求解一个新的惰性黎曼问题，以找到新的中心速度 $u^{\\star\\prime}$ 和中心温度 $T_{\\mathrm{CF}}(t)$。\n\n然后将中心处的分裂误差计算为绝对差 $e_T = |T_{\\mathrm{HF}}(t) - T_{\\mathrm{CF}}(t)|$。以下代码为每个测试用例实现了此逻辑。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define physical and numerical parameters\n    R_u = 8.314462618  # Universal gas constant, J/(mol*K)\n    M = 0.02897        # Mixture molecular weight, kg/mol\n    R = R_u / M        # Specific gas constant, J/(kg*K)\n    GAMMA = 1.4        # Ratio of specific heats\n    Q = 2.0e6          # Heat release per unit mass, J/kg\n    A = 1.0e3          # Arrhenius pre-exponential, 1/s\n    E = 6.0e4          # Activation energy, J/mol\n    Y0 = 0.10          # Initial fuel mass fraction\n    CV = R / (GAMMA - 1.0) # Specific heat at constant volume, J/(kg*K)\n    TOLERANCE = 1e-7   # Tolerance for Newton-Raphson solver\n    MAX_ITER = 20      # Max iterations for Newton-Raphson\n\n    def solve_chemistry(T0, y0, t_step):\n        \"\"\"\n        Integrates the chemistry ODEs for one explicit Euler step.\n        \"\"\"\n        if T0 == 0:\n            return T0\n        omega = A * np.exp(-E / (R_u * T0))\n        T_t = T0 + t_step * (Q / CV) * omega * y0\n        return T_t\n\n    def pres_func(p, rho_k, p_k, a_k):\n        \"\"\"\n        Computes the wave function f_k(p) used in the pressure function.\n        \"\"\"\n        if p > p_k:  # Shock\n            A_k = 2.0 / ((GAMMA + 1.0) * rho_k)\n            B_k = (GAMMA - 1.0) / (GAMMA + 1.0) * p_k\n            val = (p - p_k) * np.sqrt(A_k / (p + B_k))\n        else:  # Rarefaction\n            val = (2.0 * a_k / (GAMMA - 1.0)) * ((p / p_k)**((GAMMA - 1.0) / (2.0 * GAMMA)) - 1.0)\n        return val\n\n    def pres_func_deriv(p, rho_k, p_k, a_k):\n        \"\"\"\n        Computes the derivative of the wave function f_k(p).\n        \"\"\"\n        if p > p_k: # Shock\n            A_k = 2.0 / ((GAMMA + 1.0) * rho_k)\n            B_k = (GAMMA - 1.0) / (GAMMA + 1.0) * p_k\n            derivative = np.sqrt(A_k / (p + B_k)) * (1.0 - (p - p_k) / (2.0 * (B_k + p)))\n        else: # Rarefaction\n            derivative = (1.0 / (rho_k * a_k)) * (p / p_k)**(-(GAMMA + 1.0) / (2.0 * GAMMA))\n        return derivative\n\n    def solve_riemann(state_L, state_R):\n        \"\"\"\n        Solves the exact Riemann problem for an ideal gas.\n        Returns (p_star, u_star, T_L_star, T_R_star)\n        \"\"\"\n        rho_L, u_L, p_L = state_L\n        rho_R, u_R, p_R = state_R\n\n        a_L = np.sqrt(GAMMA * p_L / rho_L)\n        a_R = np.sqrt(GAMMA * p_R / rho_R)\n\n        pressure_eq = lambda p: pres_func(p, rho_L, p_L, a_L) + pres_func(p, rho_R, p_R, a_R) + (u_R - u_L)\n        deriv_eq = lambda p: pres_func_deriv(p, rho_L, p_L, a_L) + pres_func_deriv(p, rho_R, p_R, a_R)\n\n        # Initial guess for p_star (two-rarefaction approximation)\n        p_pvrs_num = a_L + a_R - (GAMMA - 1.0)/2.0 * (u_R - u_L)\n        p_pvrs_den = a_L / p_L**((GAMMA - 1.0)/(2.0 * GAMMA)) + a_R / p_R**((GAMMA - 1.0)/(2.0 * GAMMA))\n        p_star = (p_pvrs_num / p_pvrs_den)**(2.0 * GAMMA / (GAMMA - 1.0))\n        p_star = max(1e-6, p_star)\n\n        for _ in range(MAX_ITER):\n            f_val = pressure_eq(p_star)\n            df_val = deriv_eq(p_star)\n            p_star_new = p_star - f_val / df_val\n            if abs(p_star_new - p_star)  TOLERANCE:\n                p_star = p_star_new\n                break\n            p_star = p_star_new\n            if p_star  0: p_star = 1e-6\n        \n        f_L = pres_func(p_star, rho_L, p_L, a_L)\n        f_R = pres_func(p_star, rho_R, p_R, a_R)\n        u_star = 0.5 * (u_L + u_R) + 0.5 * (f_R - f_L)\n\n        # Left side density\n        if p_star > p_L:\n            rho_L_star = rho_L * ((p_star/p_L + (GAMMA-1.0)/(GAMMA+1.0)) / \n                                  (((GAMMA-1.0)/(GAMMA+1.0)) * (p_star/p_L) + 1.0))\n        else:\n            rho_L_star = rho_L * (p_star / p_L)**(1.0 / GAMMA)\n        \n        # Right side density\n        if p_star > p_R:\n            rho_R_star = rho_R * ((p_star/p_R + (GAMMA-1.0)/(GAMMA+1.0)) / \n                                  (((GAMMA-1.0)/(GAMMA+1.0)) * (p_star/p_R) + 1.0))\n        else:\n            rho_R_star = rho_R * (p_star / p_R)**(1.0 / GAMMA)\n\n        T_L_star = p_star / (rho_L_star * R)\n        T_R_star = p_star / (rho_R_star * R)\n\n        return p_star, u_star, T_L_star, T_R_star\n\n    test_cases = [\n        ((1.0, 0.0, 1.0e5), (0.125, 0.0, 1.0e4), 1.0e-4),\n        ((5.0, 0.0, 2.0e6), (1.0, 0.0, 1.0e5), 5.0e-5),\n        ((1.0, 100.0, 1.0e5), (1.0, -100.0, 1.0e5), 1.0e-5)\n    ]\n    results = []\n\n    for case in test_cases:\n        state_L, state_R, t_step = case\n        rho_L, u_L, p_L = state_L\n        rho_R, u_R, p_R = state_R\n        \n        T_L = p_L / (rho_L * R)\n        T_R = p_R / (rho_R * R)\n        \n        # --- Hydrodynamics-First (HF) ---\n        _, u_star, T_L_star, T_R_star = solve_riemann(state_L, state_R)\n        \n        if u_star > 0:\n            T_star = T_L_star\n        elif u_star  0:\n            T_star = T_R_star\n        else:\n            T_star = T_L_star  # For symmetric cases, T_L_star == T_R_star\n\n        T_HF = solve_chemistry(T_star, Y0, t_step)\n        \n        # --- Chemistry-First (CF) ---\n        T_L_chem = solve_chemistry(T_L, Y0, t_step)\n        T_R_chem = solve_chemistry(T_R, Y0, t_step)\n\n        p_L_new = rho_L * R * T_L_chem\n        p_R_new = rho_R * R * T_R_chem\n        \n        state_L_new = (rho_L, u_L, p_L_new)\n        state_R_new = (rho_R, u_R, p_R_new)\n        \n        _, u_star_cf, T_L_star_cf, T_R_star_cf = solve_riemann(state_L_new, state_R_new)\n\n        if u_star_cf > 0:\n            T_CF = T_L_star_cf\n        elif u_star_cf  0:\n            T_CF = T_R_star_cf\n        else:\n            T_CF = T_L_star_cf\n        \n        error = abs(T_HF - T_CF)\n        results.append(error)\n        \n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n```",
            "answer": "[0.158756012658428,1.48834945412964,2.56943806460913]"
        },
        {
            "introduction": "稳健的数值模拟必须确保其解在物理上是可接受的，例如，压力和质量分数不能为负。然而，数值离散误差，尤其是在强间断附近，可能会导致解违反这些物理约束，从而破坏双曲系统的适定性。本练习模拟了这种情况，要求您分析物理可容许性被违反的后果，并设计一个约束投影方法，以最小的扰动恢复解的物理真实性。",
            "id": "4045455",
            "problem": "考虑一个用于爆轰波的反应欧拉模型的一维有限体积更新，该模型使用具有恒定比热比 $\\gamma$ 的量热完全理想气体状态方程进行封闭。设经过一个显式预测步后，单元平均守恒状态为 $U^{*} = [\\rho^{*}, m^{*}, (\\rho E)^{*}, (\\rho Y_{F})^{*}]^{\\mathsf{T}}$，其中 $\\rho$ 是密度，$m=\\rho u$ 是动量（$u$ 为速度），$\\rho E$ 是总能量密度，$\\rho Y_{F}$ 是燃料偏密度。压力通过理想气体关系式从守恒变量中恢复：\n$$\np \\;=\\; (\\gamma - 1)\\!\\left[(\\rho E) - \\frac{m^{2}}{2\\rho}\\right],\n$$\n声速满足 $c^{2} = \\gamma p/\\rho$。物理允许集要求 $\\rho  0$、$p  0$ 以及 $0 \\le Y_{F} \\le 1$。您可以假设量热模型与组分无关（因此 $\\gamma$ 是常数，且 $p$ 仅依赖于 $(\\rho, m, \\rho E)$）。\n\n对于位于爆轰前沿反应区一侧的某个单元，给定以下数据：\n- $\\gamma = 1.4$，\n- $\\rho^{*} = 1.0$ $\\mathrm{kg\\,m^{-3}}$，\n- $m^{*} = 1.0 \\times 10^{3}$ $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$，\n- $(\\rho E)^{*} = 4.80 \\times 10^{5}$ $\\mathrm{J\\,m^{-3}}$，\n- $(\\rho Y_{F})^{*} = -2.00 \\times 10^{-2}$ $\\mathrm{kg\\,m^{-3}}$。\n\n回答以下问题：\n\n1) 从声速的定义 $c^{2} = \\gamma p/\\rho$ 和无粘欧拉通量雅可比矩阵的形式出发，解释为什么违反允许性条件 $p0$ 或 $Y_{F}\\in[0,1]$ 会破坏爆轰前沿附近双曲型更新的适定性。\n\n2) 为在最小化扰动守恒量的情况下恢复允许性，考虑以下约束投影问题：\n$$\n\\min_{\\Delta U} \\;\\frac{1}{2}\\,\\|\\mathrm{W}^{1/2}\\Delta U\\|_{2}^{2}\n$$\n约束条件为\n$$\n\\Delta \\rho = 0,\\quad \\Delta m = 0,\\quad p(U^{*}+\\Delta U) \\ge p_{\\min},\\quad 0 \\le \\frac{(\\rho Y_{F})^{*}+\\Delta(\\rho Y_{F})}{\\rho^{*}} \\le 1,\n$$\n其中 $p_{\\min} = 1.00 \\times 10^{3}$ $\\mathrm{Pa}$ 是一个小的正压力下限，以避免双曲性的丧失，权重矩阵为对角矩阵 $\\mathrm{W}=\\mathrm{diag}(0,0,s_{E}^{-2},s_{Y}^{-2})$，其中 $s_{E} = 1.00 \\times 10^{6}$ $\\mathrm{J\\,m^{-3}}$，$s_{Y} = 1.00$ $\\mathrm{kg\\,m^{-3}}$。推导求解此问题的闭式解形式的投影修正量 $\\Delta(\\rho E)$ 和 $\\Delta(\\rho Y_{F})$。\n\n3) 计算最小加权扰动大小\n$$\nJ_{\\min} \\;=\\; \\left\\|\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}}\\right\\|_{2},\n$$\n并将其作为一个四舍五入到四位有效数字的无量纲数报告。最终方框内的答案不应包含单位。用一致的国际单位制单位说明您计算的任何中间值，并将最终答案表示为纯数。",
            "solution": "首先验证问题以确保其适定、科学合理且客观。\n\n**问题验证**\n\n**步骤1：提取给定条件**\n-   模型：一维有限体积更新，反应欧拉模型。\n-   状态向量：$U = [\\rho, m, \\rho E, \\rho Y_{F}]^{\\mathsf{T}}$。\n-   状态方程：具有恒定 $\\gamma$ 的量热完全理想气体。\n-   压力关系式：$p = (\\gamma - 1)\\!\\left[(\\rho E) - \\frac{m^{2}}{2\\rho}\\right]$。\n-   声速：$c^{2} = \\gamma p/\\rho$。\n-   允许性条件：$\\rho  0$, $p  0$, $0 \\le Y_{F} \\le 1$。\n-   预测状态：$U^{*} = [\\rho^{*}, m^{*}, (\\rho E)^{*}, (\\rho Y_{F})^{*}]^{\\mathsf{T}}$。\n-   给定数据：\n    -   $\\gamma = 1.4$\n    -   $\\rho^{*} = 1.0$ $\\mathrm{kg\\,m^{-3}}$\n    -   $m^{*} = 1.0 \\times 10^{3}$ $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$\n    -   $(\\rho E)^{*} = 4.80 \\times 10^{5}$ $\\mathrm{J\\,m^{-3}}$\n    -   $(\\rho Y_{F})^{*} = -2.00 \\times 10^{-2}$ $\\mathrm{kg\\,m^{-3}}$\n-   第2部分给定条件（投影）：\n    -   目标：$\\min_{\\Delta U} \\;\\frac{1}{2}\\,\\|\\mathrm{W}^{1/2}\\Delta U\\|_{2}^{2}$\n    -   约束条件：$\\Delta \\rho = 0$, $\\Delta m = 0$, $p(U^{*}+\\Delta U) \\ge p_{\\min}$, $0 \\le \\frac{(\\rho Y_{F})^{*}+\\Delta(\\rho Y_{F})}{\\rho^{*}} \\le 1$。\n    -   $p_{\\min} = 1.00 \\times 10^{3}$ $\\mathrm{Pa}$。\n    -   权重矩阵：$\\mathrm{W}=\\mathrm{diag}(0,0,s_{E}^{-2},s_{Y}^{-2})$。\n    -   $s_{E} = 1.00 \\times 10^{6}$ $\\mathrm{J\\,m^{-3}}$。\n    -   $s_{Y} = 1.00$ $\\mathrm{kg\\,m^{-3}}$。\n-   第3部分目标：计算 $J_{\\min} = \\left\\|\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}}\\right\\|_{2}$，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题具有科学依据，描述了双曲守恒律计算流体动力学中一个常见的数值问题（失去允许性），以及一种标准的修正技术（约束投影）。该问题是适定的，包含一个定性解释，后跟一个可解的约束凸优化问题。语言客观，所有术语定义清晰。对给定状态 $U^{*}$ 的压力进行初步计算，得出：\n$$\np^{*} \\;=\\; (\\gamma - 1)\\!\\left[(\\rho E)^{*} - \\frac{(m^{*})^{2}}{2\\rho^{*}}\\right] \\;=\\; (1.4 - 1)\\!\\left[4.80 \\times 10^{5} - \\frac{(1.0 \\times 10^{3})^{2}}{2 \\times 1.0}\\right]\n$$\n$$\np^{*} \\;=\\; 0.4 \\times (4.80 \\times 10^{5} - 5.0 \\times 10^{5}) \\;=\\; 0.4 \\times (-2.0 \\times 10^{4}) \\;=\\; -8.0 \\times 10^{3} \\; \\mathrm{Pa}\n$$\n这个负压力违反了允许性条件 $p0$。此外，燃料质量分数为 $Y_F^{*} = (\\rho Y_F)^{*}/\\rho^{*} = -2.00 \\times 10^{-2} / 1.0 = -0.02$，这违反了 $0 \\le Y_F \\le 1$。问题的设置有意创造了一个不允许的状态，这是后续修正任务的前提。这不代表一个缺陷，而是问题的核心要素。因此，该问题是有效的。\n\n**步骤3：结论与行动**\n问题有效，将提供解答。\n\n**第1部分：适定性与允许性**\n\n一维无粘欧拉方程构成一个双曲型偏微分方程组。该系统的双曲性是一个基本属性，它保证了信息沿特征线以有限速度传播，并且初值问题是适定的。如果通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$ 具有全套实特征值和相应的线性无关特征向量，则系统 $\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0$ 是双曲的。\n\n对于非反应欧拉方程，通量雅可比矩阵的特征值为 $u$、$u-c$ 和 $u+c$，其中 $u$ 是流体速度，$c$ 是声速。声速由 $c^{2} = \\gamma p / \\rho$ 定义。为了使特征值为实数，$c$ 必须是实数，这要求 $c^2 \\ge 0$。由于物理上要求 $\\gamma$ 和 $\\rho$ 均为正值，此条件简化为 $p \\ge 0$。如果压力 $p$ 变为负值，$c^2$ 也变为负值，特征值 $u \\pm c$ 成为共轭复数。具有复特征值的系统是椭圆型的，而非双曲型的。针对双曲方程的数值格式，例如所提到的显式有限体积法，依赖于Courant-Friedrichs-Lewy (CFL) 条件，该条件根据波的有限传播速度来限制时间步长。如果系统局部变为椭圆型，有限依赖域的概念就不再成立，这类显式格式会变得无条件不稳定，从而破坏了数值更新的适定性。\n\n条件 $0 \\le Y_F \\le 1$ 是一个物理可实现性的问题。质量分数 $Y_F$ 表示流体微团中燃料所占的质量比例。它不能为负，也不能超过1。违反此约束，例如 $Y_F  0$，是不符合物理实际的。此外，为组分方程提供源项的化学反应速率模型，几乎总是在假设 $Y_F \\ge 0$ 的前提下建立的。负的质量分数会导致反应模型中出现不明确或不符合物理实际的行为（例如，产物以爆炸性速率生成燃料），从而导致模拟失败或产生无意义的结果。对于爆轰而言，其波结构由流体动力学和化学反应之间的紧密耦合决定，维持组分的物理边界对于正确建模至关重要。\n\n**第2部分：投影修正量的推导**\n\n目标是找到 $\\Delta U = [0, 0, \\Delta(\\rho E), \\Delta(\\rho Y_F)]^{\\mathsf{T}}$，在满足两个约束条件的前提下，最小化目标函数：\n$$\nJ(\\Delta(\\rho E), \\Delta(\\rho Y_F)) = \\frac{1}{2} \\left[ \\left(\\frac{\\Delta(\\rho E)}{s_E}\\right)^2 + \\left(\\frac{\\Delta(\\rho Y_F)}{s_Y}\\right)^2 \\right]\n$$\n令 $x = \\Delta(\\rho E)$ 且 $y = \\Delta(\\rho Y_F)$。\n\n第一个约束是关于压力的：$p(U^{*}+\\Delta U) \\ge p_{\\min}$。\n新的压力 $p_{\\text{new}}$ 为：\n$$\np_{\\text{new}} = (\\gamma - 1)\\left[ ((\\rho E)^{*} + x) - \\frac{(m^{*})^2}{2\\rho^{*}} \\right]\n$$\n约束变为：\n$$\n(\\gamma - 1)\\left[ ((\\rho E)^{*} + x) - \\frac{(m^{*})^2}{2\\rho^{*}} \\right] \\ge p_{\\min}\n$$\n重新整理以求解 $x$：\n$$\n(\\rho E)^{*} + x - \\frac{(m^{*})^2}{2\\rho^{*}} \\ge \\frac{p_{\\min}}{\\gamma - 1}\n$$\n$x \\ge \\frac{p_{\\min}}{\\gamma - 1} - \\left( (\\rho E)^{*} - \\frac{(m^{*})^2}{2\\rho^{*}} \\right) = \\frac{p_{\\min}}{\\gamma - 1} - \\frac{p^{*}}{\\gamma-1} = \\frac{p_{\\min} - p^{*}}{\\gamma - 1}$\n这定义了 $x$ 的一个下界：$x \\ge x_{\\min}$，其中 $x_{\\min} = \\frac{p_{\\min} - p^{*}}{\\gamma-1}$。\n\n第二个约束是关于燃料质量分数的：$0 \\le Y_F \\le 1$。由于 $\\rho$ 是常数，这等价于 $0 \\le \\rho Y_F \\le \\rho$。\n$$\n0 \\le (\\rho Y_F)^{*} + y \\le \\rho^{*}\n$$\n这给出了 $y$ 的一个下界和一个上界：\n$$ -(\\rho Y_F)^{*} \\le y \\le \\rho^{*} - (\\rho Y_F)^{*} $$\n这为 $y$ 定义了一个区间：$y \\in [y_{\\min}, y_{\\max}]$，其中 $y_{\\min} = -(\\rho Y_F)^{*}$，$y_{\\max} = \\rho^{*} - (\\rho Y_F)^{*}$。\n\n最小化问题现在是找到 $(x, y)$，使其在满足 $x \\ge x_{\\min}$ 和 $y_{\\min} \\le y \\le y_{\\max}$ 的约束下最小化 $\\frac{1}{2s_E^2}x^2 + \\frac{1}{2s_Y^2}y^2$。这是在可行矩形区域内，寻找在由 $s_E$ 和 $s_Y$ 缩放的 $L_2$ 范数意义下，距离原点 $(0,0)$ 最近的点。因为目标函数是可分的，并且 $x$ 和 $y$ 的约束是独立的，我们可以分别最小化每一项。\n\n在区间 $[x_{\\min}, \\infty)$ 中，距离 $0$ 最近的 $x$ 值是 $\\Delta(\\rho E) = \\max(0, x_{\\min})$。\n在区间 $[y_{\\min}, y_{\\max}]$ 中，距离 $0$ 最近的 $y$ 值是 $\\Delta(\\rho Y_F) = \\max(y_{\\min}, \\min(0, y_{\\max}))$。\n\n因此，闭式解形式的投影修正量为：\n$$\n\\Delta(\\rho E) = \\max\\left(0, \\frac{p_{\\min} - p^{*}}{\\gamma - 1}\\right)\n$$\n其中 $p^{*} = (\\gamma - 1)\\left[(\\rho E)^{*} - \\frac{(m^{*})^2}{2\\rho^{*}}\\right]$，以及\n$$\n\\Delta(\\rho Y_F) = \\max\\left(-(\\rho Y_F)^{*}, \\min(0, \\rho^{*} - (\\rho Y_F)^{*})\\right)\n$$\n\n**第3部分：扰动大小的计算**\n\n首先，我们使用所提供的数据计算必要的中间值。\n我们已经计算出 $p^{*} = -8.0 \\times 10^{3} \\; \\mathrm{Pa}$。\n\n现在，我们计算所需的修正量 $\\Delta(\\rho E)$ 和 $\\Delta(\\rho Y_F)$。\n对于 $\\Delta(\\rho E)$：\n$x_{\\min} = \\frac{p_{\\min} - p^{*}}{\\gamma - 1} = \\frac{1.00 \\times 10^{3} - (-8.0 \\times 10^{3})}{1.4 - 1} = \\frac{9.0 \\times 10^{3}}{0.4} = 2.25 \\times 10^{4} \\; \\mathrm{J\\,m^{-3}}$。\n因为 $x_{\\min}  0$，修正量为：\n$$\n\\Delta(\\rho E) = x_{\\min} = 2.25 \\times 10^{4} \\; \\mathrm{J\\,m^{-3}}\n$$\n\n对于 $\\Delta(\\rho Y_F)$：\n$y_{\\min} = -(\\rho Y_F)^{*} = -(-2.00 \\times 10^{-2}) = 2.00 \\times 10^{-2} \\; \\mathrm{kg\\,m^{-3}}$。\n$y_{\\max} = \\rho^{*} - (\\rho Y_F)^{*} = 1.00 - (-2.00 \\times 10^{-2}) = 1.02 \\; \\mathrm{kg\\,m^{-3}}$。\n修正量的允许区间是 $[0.02, 1.02]$。由于该区间不包含 $0$ 且完全位于正半轴，区间内距离 $0$ 最近的点是下界 $y_{\\min}$。\n$$\n\\Delta(\\rho Y_F) = y_{\\min} = 2.00 \\times 10^{-2} \\; \\mathrm{kg\\,m^{-3}}\n$$\n\n问题要求计算大小 $J_{\\min} = \\left\\|\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}}\\right\\|_{2}$。\n投影扰动向量为 $\\Delta U_{\\mathrm{proj}} = [0, 0, 2.25 \\times 10^{4}, 2.00 \\times 10^{-2}]^{\\mathsf{T}}$。\n权重矩阵为 $\\mathrm{W}^{1/2} = \\mathrm{diag}(0, 0, s_E^{-1}, s_Y^{-1})$。\n$$\n\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\Delta(\\rho E)/s_E \\\\ \\Delta(\\rho Y_F)/s_Y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ (2.25 \\times 10^{4}) / (1.00 \\times 10^{6}) \\\\ (2.00 \\times 10^{-2}) / 1.00 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 2.25 \\times 10^{-2} \\\\ 2.00 \\times 10^{-2} \\end{pmatrix}\n$$\n该向量的 $L_2$ 范数为：\n$$\nJ_{\\min} = \\sqrt{0^2 + 0^2 + (2.25 \\times 10^{-2})^2 + (2.00 \\times 10^{-2})^2}\n$$\n$$\nJ_{\\min} = \\sqrt{(5.0625 \\times 10^{-4}) + (4.00 \\times 10^{-4})}\n$$\n$$\nJ_{\\min} = \\sqrt{9.0625 \\times 10^{-4}} = \\sqrt{9.0625} \\times 10^{-2}\n$$\n$$\nJ_{\\min} \\approx 3.0103986 \\times 10^{-2}\n$$\n四舍五入到四位有效数字，结果是 $3.010 \\times 10^{-2}$。",
            "answer": "$$\n\\boxed{0.03010}\n$$"
        }
    ]
}