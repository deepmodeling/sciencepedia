{
    "hands_on_practices": [
        {
            "introduction": "Before running a simulation, we must ensure our numerical model accurately represents the target physical system. This involves mapping the macroscopic transport properties, namely kinematic viscosity $\\nu$ and thermal diffusivity $\\alpha$, onto the microscopic parameters of the Lattice Boltzmann Method (LBM), specifically the relaxation times $\\tau_f$ and $\\tau_g$. This foundational exercise guides you through the essential derivation linking these scales, a critical first step in configuring any valid LBM simulation for thermal flows .",
            "id": "3967577",
            "problem": "A double-distribution formulation of the Lattice Boltzmann Method (LBM) is to be constructed for thermal flows that recover the incompressible Navier–Stokes–Fourier equations with prescribed kinematic viscosity $\\nu$ and thermal diffusivity $\\alpha$. The hydrodynamic field is represented on a two-dimensional, nine-velocity lattice $\\mathrm{D2Q9}$ by particle distribution functions $f_{i}$ with a single-relaxation-time Bhatnagar–Gross–Krook (BGK) collision operator, and the temperature field is represented on a two-dimensional, five-velocity lattice $\\mathrm{D2Q5}$ by distribution functions $g_{i}$ with a single-relaxation-time BGK collision operator. The discrete-velocity equilibria are chosen such that their second moments yield an isotropic pressure tensor with lattice sound-speed squares $c_{s}^{2}$ for the hydrodynamics and $c_{s,T}^{2}$ for the thermal field, respectively. Assume a uniform time step $\\Delta t$ and that the collision–streaming discretization is the standard first-order explicit streaming with local BGK collision.\n\nStarting from the discrete kinetic description and enforcing the recovery of the target macroscopic equations through asymptotic multiscale analysis, derive the transport-coefficient relations linking $(\\nu,\\alpha)$ to the relaxation times $(\\tau_{f},\\tau_{g})$ for the hydrodynamic and thermal distributions. Then, for the specific lattice parameters $c_{s}^{2}=c_{s,T}^{2}=\\frac{1}{3}$ and $\\Delta t=1$, compute the closed-form expressions for the required relaxation times $\\tau_{f}$ and $\\tau_{g}$ that realize the prescribed $\\nu$ and $\\alpha$.\n\nExpress the final answer as analytic expressions for $\\tau_{f}$ and $\\tau_{g}$ in terms of $\\nu$ and $\\alpha$. The relaxation times are dimensionless. No rounding is required. Report both expressions together.",
            "solution": "The problem requires the derivation of the relationship between the transport coefficients (kinematic viscosity $\\nu$, thermal diffusivity $\\alpha$) and the BGK relaxation times ($\\tau_f$, $\\tau_g$) for a double-distribution Lattice Boltzmann Method (LBM) for thermal flows. The derivation will be performed via a multiscale Chapman-Enskog analysis, followed by the application of specific lattice parameters.\n\nFirst, we address the hydrodynamic field, governed by the distribution function $f_i$ on a D2Q9 lattice. The discrete lattice Boltzmann equation with a single-relaxation-time Bhatnagar–Gross–Krook (BGK) operator is:\n$$f_i(\\mathbf{x} + \\mathbf{c}_i \\Delta t, t + \\Delta t) = f_i(\\mathbf{x}, t) - \\frac{1}{\\tau_f} [f_i(\\mathbf{x}, t) - f_i^{eq}(\\mathbf{x}, t)]$$\nHere, $\\mathbf{c}_i$ are the discrete velocities, $\\Delta t$ is the time step, $\\tau_f$ is the dimensionless relaxation time for the fluid, and $f_i^{eq}$ is the equilibrium distribution function. The macroscopic density $\\rho$ and momentum $\\rho \\mathbf{u}$ are moments of $f_i$:\n$$\\rho = \\sum_i f_i, \\quad \\rho \\mathbf{u} = \\sum_i f_i \\mathbf{c}_i$$\nThe low-Mach number equilibrium distribution $f_i^{eq}$ that recovers the Navier–Stokes equations is a second-order expansion in velocity $\\mathbf{u}$:\n$$f_i^{eq} = w_i \\rho \\left[ 1 + \\frac{\\mathbf{c}_i \\cdot \\mathbf{u}}{c_s^2} + \\frac{(\\mathbf{c}_i \\cdot \\mathbf{u})^2}{2 c_s^4} - \\frac{\\mathbf{u}^2}{2 c_s^2} \\right]$$\nwhere $w_i$ are the lattice weights and $c_s$ is the lattice speed of sound. The momentum flux tensor is defined as $\\mathbf{\\Pi} = \\sum_i f_i \\mathbf{c}_i \\mathbf{c}_i$. Its equilibrium part is $\\mathbf{\\Pi}^{eq} = \\sum_i f_i^{eq} \\mathbf{c}_i \\mathbf{c}_i = p\\mathbf{I} + \\rho\\mathbf{u}\\mathbf{u}$, where the pressure is $p = \\rho c_s^2$.\n\nA Chapman-Enskog expansion of the LBE relates the non-equilibrium part of the momentum flux tensor, $\\mathbf{\\Pi}^{neq} = \\mathbf{\\Pi} - \\mathbf{\\Pi}^{eq}$, to the macroscopic gradients. For the standard LBM with explicit streaming and local collision, this analysis yields the following expression for the non-equilibrium stress tensor in the incompressible limit ($\\nabla \\cdot \\mathbf{u} = 0$):\n$$\\mathbf{\\Pi}^{neq}_{\\alpha\\beta} = - \\rho c_s^2 \\Delta t \\left(\\tau_f - \\frac{1}{2}\\right) (\\partial_\\alpha u_\\beta + \\partial_\\beta u_\\alpha)$$\nThe momentum equation recovered from the LBE is $\\partial_t(\\rho u_\\alpha) + \\partial_\\beta(\\Pi^{eq}_{\\alpha\\beta} + \\Pi^{neq}_{\\alpha\\beta}) = 0$. Substituting the expressions for the tensors and assuming constant density gives:\n$$\\partial_t u_\\alpha + (\\mathbf{u} \\cdot \\nabla) u_\\alpha = -\\frac{1}{\\rho}\\partial_\\alpha p + \\partial_\\beta \\left[ c_s^2 \\Delta t \\left(\\tau_f - \\frac{1}{2}\\right) (\\partial_\\alpha u_\\beta + \\partial_\\beta u_\\alpha) \\right]$$\nThe incompressible Navier–Stokes equation is:\n$$\\partial_t u_\\alpha + (\\mathbf{u} \\cdot \\nabla) u_\\alpha = -\\frac{1}{\\rho}\\partial_\\alpha p + \\partial_\\beta \\left[ \\nu (\\partial_\\alpha u_\\beta + \\partial_\\beta u_\\alpha) \\right]$$\nBy comparing the viscous terms in the two equations, we identify the kinematic viscosity $\\nu$:\n$$\\nu = c_s^2 \\left(\\tau_f - \\frac{1}{2}\\right) \\Delta t$$\n\nNext, we analyze the thermal field, governed by the distribution function $g_i$ on a D2Q5 lattice. The LBE for this scalar field is:\n$$g_i(\\mathbf{x} + \\mathbf{c}_{T,i} \\Delta t, t + \\Delta t) = g_i(\\mathbf{x}, t) - \\frac{1}{\\tau_g} [g_i(\\mathbf{x}, t) - g_i^{eq}(\\mathbf{x}, t)]$$\nThe temperature $T$ is the zeroth moment of $g_i$, $T = \\sum_i g_i$. The equilibrium distribution $g_i^{eq}$ for an advected-diffused scalar is:\n$$g_i^{eq} = w_{T,i} T \\left[ 1 + \\frac{\\mathbf{c}_{T,i} \\cdot \\mathbf{u}}{c_{s,T}^2} \\right]$$\nwhere $\\mathbf{u}$ is the fluid velocity obtained from the hydrodynamic solver, $w_{T,i}$ are the weights for the thermal lattice, and $c_{s,T}$ is the thermal lattice speed of sound.\nThe conservation law for temperature is $\\partial_t T + \\nabla \\cdot \\mathbf{q} = 0$, where the heat flux is $\\mathbf{q} = \\sum_i g_i \\mathbf{c}_{T,i}$. The flux is composed of an equilibrium part $\\mathbf{q}^{eq} = \\sum_i g_i^{eq} \\mathbf{c}_{T,i} = T\\mathbf{u}$ and a non-equilibrium part $\\mathbf{q}^{neq}$. A Chapman-Enskog expansion, analogous to the one for the hydrodynamic field, gives:\n$$\\mathbf{q}^{neq} = - c_{s,T}^2 \\Delta t \\left(\\tau_g - \\frac{1}{2}\\right) \\nabla T$$\nThe total heat flux is $\\mathbf{q} = \\mathbf{q}^{eq} + \\mathbf{q}^{neq} = T\\mathbf{u} - c_{s,T}^2 \\Delta t (\\tau_g - \\frac{1}{2}) \\nabla T$. Substituting this into the conservation law gives:\n$$\\partial_t T + \\nabla \\cdot (T\\mathbf{u}) = \\nabla \\cdot \\left[ c_{s,T}^2 \\Delta t \\left(\\tau_g - \\frac{1}{2}\\right) \\nabla T \\right]$$\nFor an incompressible fluid ($\\nabla \\cdot \\mathbf{u} = 0$), this simplifies to:\n$$\\partial_t T + \\mathbf{u} \\cdot \\nabla T = \\nabla \\cdot \\left[ c_{s,T}^2 \\Delta t \\left(\\tau_g - \\frac{1}{2}\\right) \\nabla T \\right]$$\nThe target macroscopic equation is the advection-diffusion equation (Fourier's law):\n$$\\partial_t T + \\mathbf{u} \\cdot \\nabla T = \\nabla \\cdot (\\alpha \\nabla T)$$\nComparing the diffusive terms, we identify the thermal diffusivity $\\alpha$:\n$$\\alpha = c_{s,T}^2 \\left(\\tau_g - \\frac{1}{2}\\right) \\Delta t$$\n\nThe problem provides the specific lattice parameters $c_s^2 = \\frac{1}{3}$, $c_{s,T}^2 = \\frac{1}{3}$, and $\\Delta t = 1$. We substitute these into the derived transport coefficient relations.\nFor the kinematic viscosity:\n$$\\nu = \\frac{1}{3} \\left(\\tau_f - \\frac{1}{2}\\right) \\cdot 1$$\nSolving for $\\tau_f$ in terms of $\\nu$:\n$$3\\nu = \\tau_f - \\frac{1}{2}$$\n$$\\tau_f = 3\\nu + \\frac{1}{2}$$\n\nFor the thermal diffusivity:\n$$\\alpha = \\frac{1}{3} \\left(\\tau_g - \\frac{1}{2}\\right) \\cdot 1$$\nSolving for $\\tau_g$ in terms of $\\alpha$:\n$$3\\alpha = \\tau_g - \\frac{1}{2}$$\n$$\\tau_g = 3\\alpha + \\frac{1}{2}$$\nThese are the final expressions for the relaxation times required to realize the prescribed transport coefficients $\\nu$ and $\\alpha$ under the given conditions.",
            "answer": "$$\\boxed{\\begin{pmatrix} 3\\nu + \\frac{1}{2}  3\\alpha + \\frac{1}{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Although the Lattice Boltzmann Method is widely used to simulate incompressible flows, its formulation is inherently based on weakly compressible fluid dynamics. This duality imposes an important operational constraint that must be respected to ensure the accuracy and physical relevance of the simulation results. This practice explores the origin of the low Mach number limit, a critical rule of thumb in LBM, and reveals how this constraint dictates practical choices regarding lattice velocity, grid resolution, and stability .",
            "id": "3967594",
            "problem": "An incompressible thermal Lattice Boltzmann Method (LBM) simulation for buoyancy-driven flow uses the isothermal pressure closure $p = c_{s}^{2}\\rho$ with constant lattice speed of sound $c_{s}$, and a double-distribution-function formulation for momentum and temperature. Consider a characteristic flow speed $U$ and reference density $\\rho_{0}$ in the low-Mach-number regime, where compressibility effects are small but nonzero. Using as the fundamental base the momentum balance at low Mach number and the equation of state $p = c_{s}^{2}\\rho$, argue from first principles how inertial pressure variations scale with $U$ and how these variations translate into density fluctuations. Then, by requiring that the relative density fluctuation satisfies $\\left|\\rho - \\rho_{0}\\right|/\\rho_{0} \\le \\varepsilon$ with $\\varepsilon = 0.01$, derive the maximum admissible Mach number $Ma_{\\max}$, where $Ma \\equiv U/c_{s}$. \n\nFinally, explain concisely how the constraint $Ma \\le Ma_{\\max}$ informs the selection of lattice parameters in practice: the target lattice velocity $U_{\\ell}$, the space and time steps $\\Delta x$ and $\\Delta t$, and the relaxation times $(\\tau_{f},\\tau_{g})$ for the momentum and thermal fields, when mapping from prescribed physical properties and characteristic scales. \n\nProvide the final value of $Ma_{\\max}$ as a pure number (dimensionless). No rounding instruction is required because the number is exact. The explanatory discussion does not require numerical values.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically the Lattice Boltzmann Method. It is well-posed, objective, and contains sufficient information for a unique solution. Therefore, the problem is deemed valid and a full solution is provided below.\n\nFirst, we analyze the relationship between pressure and density fluctuations. The problem concerns a low-Mach-number regime, where the flow is nearly incompressible. The dominant balance in the momentum equation for steady or slowly varying flows is between the inertial forces and the pressure gradient. The momentum equation is approximately given by $\\rho (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} \\approx -\\nabla p$.\nWe can perform a scaling analysis on this equation. Let $U$ be the characteristic velocity of the flow and $L$ be the characteristic length scale over which this velocity varies. The convective term, $(\\mathbf{u} \\cdot \\nabla) \\mathbf{u}$, scales as $\\frac{U^2}{L}$. The pressure gradient, $\\nabla p$, scales as $\\frac{\\Delta p}{L}$, where $\\Delta p$ is the characteristic pressure variation. The density $\\rho$ can be approximated by a reference density $\\rho_{0}$ in the low-Mach-number limit. Thus, the momentum balance implies:\n$$\n\\rho_{0} \\frac{U^2}{L} \\sim \\frac{\\Delta p}{L}\n$$\nThis leads to the scaling for the inertial pressure variation:\n$$\n\\Delta p \\sim \\rho_{0} U^2\n$$\nNext, we use the isothermal LBM equation of state provided, $p = c_{s}^{2}\\rho$, where $c_{s}$ is the constant lattice speed of sound. A small fluctuation in pressure, $\\Delta p$, is related to a small fluctuation in density, $\\Delta \\rho = \\rho - \\rho_{0}$, by differentiating the equation of state:\n$$\n\\Delta p = c_{s}^{2} \\Delta \\rho\n$$\nBy combining the scaling for the inertial pressure variation with the equation of state, we can relate the density fluctuation to the characteristic flow velocity:\n$$\nc_{s}^{2} \\Delta \\rho \\sim \\rho_{0} U^2\n$$\nRearranging this gives the scaling for the relative density fluctuation:\n$$\n\\frac{\\Delta \\rho}{\\rho_{0}} \\sim \\frac{U^2}{c_{s}^{2}}\n$$\nThe quantity on the right is the square of the Mach number, $Ma \\equiv U/c_{s}$. Therefore, the relative density fluctuation scales with the square of the Mach number:\n$$\n\\frac{|\\rho - \\rho_{0}|}{\\rho_{0}} \\sim Ma^2\n$$\nThe problem requires that this relative density fluctuation be bounded by a small value $\\varepsilon$ to ensure that the compressibility effects, inherent to the LBM formulation, do not corrupt the simulation of an essentially incompressible flow. The condition is given as:\n$$\n\\frac{|\\rho - \\rho_{0}|}{\\rho_{0}} \\le \\varepsilon\n$$\nUsing our scaling relationship as an approximate equality, we set the condition for the maximum admissible Mach number, $Ma_{\\max}$:\n$$\nMa_{\\max}^2 \\le \\varepsilon\n$$\nGiven $\\varepsilon = 0.01$, we can solve for $Ma_{\\max}$:\n$$\nMa_{\\max} = \\sqrt{\\varepsilon} = \\sqrt{0.01} = 0.1\n$$\n\nFinally, we explain how this constraint, $Ma \\le Ma_{\\max}$, informs the selection of LBM simulation parameters. In LBM, simulations are typically performed in lattice units, where the grid spacing $\\Delta x$ and time step $\\Delta t$ are set to $1$. The lattice speed is $c = \\frac{\\Delta x}{\\Delta t} = 1$. The speed of sound $c_{s}$ is a constant determined by the lattice model (e.g., $c_{s} = 1/\\sqrt{3}$ for standard D2Q9 or D3Q19 lattices). The Mach number constraint is applied to the lattice-unit characteristic velocity, $U_{\\ell}$:\n$$\nMa = \\frac{U_{\\ell}}{c_{s}} \\le Ma_{\\max} \\implies U_{\\ell} \\le Ma_{\\max} c_{s}\n$$\nWith $Ma_{\\max} = 0.1$ and $c_{s} = 1/\\sqrt{3}$, this imposes a strict upper limit on the lattice velocity, $U_{\\ell} \\le 0.1/\\sqrt{3} \\approx 0.0577$. The parameter $U_{\\ell}$ must be chosen to be small to maintain the quasi-incompressible regime.\n\nThis constraint on $U_{\\ell}$ has cascading effects on other parameters when mapping a physical problem to the lattice:\n1.  **Choice of $\\Delta x$ and $\\Delta t$**: The physical characteristic velocity $U_{phys}$ is related to the lattice velocity $U_{\\ell}$ through the scaling factors for length, $\\Delta x_{phys}$, and time, $\\Delta t_{phys}$: $U_{phys} = U_{\\ell} \\frac{\\Delta x_{phys}}{\\Delta t_{phys}}$. The constraint on $U_{\\ell}$ implies a constraint on the ratio of physical grid spacing to time step: $\\frac{\\Delta t_{phys}}{\\Delta x_{phys}} = \\frac{U_{\\ell}}{U_{phys}} \\le \\frac{Ma_{\\max} c_s}{U_{phys}}$. For a fixed physical problem (fixed $U_{phys}$), a small $U_{\\ell}$ means the time step must be chosen to be sufficiently small relative to the grid spacing.\n\n2.  **Choice of Relaxation Times $(\\tau_{f}, \\tau_{g})$**: The relaxation times control the transport coefficients. The kinematic viscosity in lattice units is $\\nu_{\\ell} = c_{s}^{2}(\\tau_{f} - 0.5)$. To simulate a physical flow, the Reynolds number must be matched: $Re_{phys} = \\frac{U_{phys} L_{phys}}{\\nu_{phys}} = \\frac{U_{\\ell} N_{x}}{\\nu_{\\ell}} = Re_{\\ell}$, where $N_x$ is the number of lattice nodes along the characteristic length $L_{phys}$. Substituting the expressions for $U_{\\ell}$ and $\\nu_{\\ell}$:\n    $$\n    Re_{phys} = \\frac{(Ma \\cdot c_{s}) N_{x}}{c_{s}^{2}(\\tau_{f} - 0.5)} = \\frac{Ma \\cdot N_{x}}{c_{s}(\\tau_{f} - 0.5)}\n    $$\n    With the Mach number limited by $Ma_{\\max}$, achieving a high Reynolds number requires a large ratio of $N_{x}/(\\tau_{f} - 0.5)$. This means one must either use a very high grid resolution ($N_x$ large) or choose a relaxation time $\\tau_{f}$ very close to its stability limit of $0.5$. Pushing $\\tau_{f}$ towards $0.5$ increases numerical instability. Therefore, the Mach number constraint reveals a fundamental trade-off in LBM between the achievable Reynolds number, grid resolution, and numerical stability. The relaxation time for the thermal field, $\\tau_{g}$, is subsequently set to match the physical Prandtl number, $Pr=\\nu_{phys}/\\chi_{phys}$, where $\\chi_{phys}$ is the thermal diffusivity, which is related to $\\tau_g$. Its choice is thus coupled to the choice of $\\tau_f$.\n\nIn summary, the Mach number constraint is a cornerstone of LBM practice for low-speed flows. It primarily forces the lattice velocity $U_{\\ell}$ to be small, which in turn dictates the relationship between grid resolution and relaxation times required to simulate a physical flow with a given Reynolds number, often pushing the simulation parameters towards the limits of stability for high-$Re$ flows.",
            "answer": "$$\n\\boxed{0.1}\n$$"
        },
        {
            "introduction": "The direct output of an LBM simulation is a set of distribution functions at discrete lattice points, from which macroscopic fields like temperature are computed. To make these results meaningful for engineering applications, we must translate this discrete data into standard, dimensionless heat transfer metrics. This exercise bridges the gap between simulation output and engineering analysis by demonstrating how to calculate the Nusselt number from the discrete temperature field, paying careful attention to the implementation details of LBM wall boundary conditions .",
            "id": "3967537",
            "problem": "Consider a steady, incompressible thermal flow in a two-dimensional parallel-plate channel of height $H$ solved using the Lattice Boltzmann Method (LBM). The bottom wall over a length $L$ is kept at a uniform isothermal condition $T_{w}$ and exchanges heat with the flowing fluid whose reference bulk temperature is $T_{b}$, treated here as a given constant. The thermal conductivity $k$ is uniform and constant. The computational grid is uniform with spacing $\\Delta x$ along both directions. The thermal boundary at the isothermal wall is imposed with the standard halfway bounce-back placement, so that the physical wall lies midway between the wall and the first fluid node adjacent to it.\n\nUsing only the foundational definitions from continuum heat transfer and the geometric placement of the halfway boundary in lattice Boltzmann discretizations, proceed as follows:\n\n- Define the local Nusselt number $Nu(x)$ at the isothermal wall in terms of a heat transfer coefficient $h(x)$, a characteristic length $L_{c}$ (take $L_{c} = H$ explicitly), and the thermal conductivity $k$.\n- Express $h(x)$ in terms of the local wall heat flux and the temperature difference between the wall and the bulk, and express the wall heat flux using Fourier’s law in terms of the wall-normal temperature gradient $\\partial_{n} T|_{w}$, with the wall-normal oriented into the fluid.\n- Derive a consistent discrete expression for the wall-normal temperature gradient $\\partial_{n} T|_{w}$ under the halfway placement in terms of the wall temperature $T_{w}$ and the temperature $T_{1,i}$ at the first fluid node adjacent to the wall at the $i$-th wall location, using the grid spacing $\\Delta x$ and assuming a locally linear temperature variation across the half-cell.\n- Define the average Nusselt number over the heated wall of length $L$ as the line-average of the local Nusselt number. Under a uniform wall-node spacing $\\Delta s = L/M$ with $M$ evenly spaced wall nodes, show how this line-average reduces to a discrete average.\n\nCombine these steps to obtain a closed-form analytic expression for the average Nusselt number $Nu_{\\mathrm{avg}}$ in terms of $H$, $\\Delta x$, $T_{w}$, $T_{b}$, and the set $\\{T_{1,i}\\}_{i=1}^{M}$.\n\nYour final answer must be a single analytic expression for $Nu_{\\mathrm{avg}}$. Do not perform any numerical evaluation or rounding. Do not include units in the final boxed expression. If you need to refer to angles, use radians, but no angles appear here.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard derivation task in computational thermal engineering. All required data and definitions are provided to derive the requested expression. Therefore, the problem is deemed valid and a full solution is provided below.\n\nThe derivation proceeds by methodically following the steps outlined in the problem statement.\n\nFirst, we define the local Nusselt number, $Nu(x)$. The definition of the Nusselt number is the ratio of convective to conductive heat transfer across a boundary. It is given in terms of the heat transfer coefficient $h(x)$, a characteristic length $L_c$, and the fluid's thermal conductivity $k$.\n$$Nu(x) = \\frac{h(x) L_c}{k}$$\nThe problem specifies the characteristic length to be the channel height, $H$.\n$$Nu(x) = \\frac{h(x) H}{k}$$\n\nSecond, we express the heat transfer coefficient $h(x)$ in terms of the local wall heat flux $q_w''(x)$ and the specified temperature difference between the wall, $T_w$, and the bulk fluid, $T_b$.\n$$h(x) = \\frac{q_w''(x)}{T_w - T_b}$$\nThe local wall heat flux $q_w''(x)$ is given by Fourier's law of heat conduction. The problem specifies the wall-normal direction, denoted by $n$, as oriented into the fluid. Fourier's law is thus written as:\n$$q_w''(x) = -k \\left. \\frac{\\partial T}{\\partial n} \\right|_w$$\nwhere $\\left. \\frac{\\partial T}{\\partial n} \\right|_w$ is the temperature gradient at the wall, normal to the wall surface. Substituting the expression for $q_w''(x)$ into the definition of $h(x)$ gives:\n$$h(x) = \\frac{-k \\left. \\frac{\\partial T}{\\partial n} \\right|_w}{T_w - T_b}$$\nNow, we substitute this expression for $h(x)$ back into the definition of the local Nusselt number $Nu(x)$:\n$$Nu(x) = \\frac{H}{k} \\left( \\frac{-k \\left. \\frac{\\partial T}{\\partial n} \\right|_w}{T_w - T_b} \\right) = - \\frac{H}{T_w - T_b} \\left. \\frac{\\partial T}{\\partial n} \\right|_w$$\nThis gives the local Nusselt number in terms of the wall-normal temperature gradient.\n\nThird, we derive a discrete expression for the wall-normal temperature gradient, $\\left. \\frac{\\partial T}{\\partial n} \\right|_w$, consistent with the specified halfway boundary placement in the lattice Boltzmann method. The problem states that the uniform grid spacing is $\\Delta x$ in both directions, so the wall-normal grid spacing is also $\\Delta x$. In the halfway placement, the physical wall is located exactly midway between a boundary node and the first computational fluid node.\nLet us set up a coordinate system where the wall-normal direction is $y$. We can place the first layer of fluid nodes at a distance $y_1$ from the wall. Per the problem description, the physical wall, where the temperature is $T_w$, is located at a distance of $\\frac{1}{2}\\Delta x$ from the first fluid node. Let the physical wall be at position $y_w=0$. Then the first fluid node is at position $y_1 = \\frac{1}{2}\\Delta x$. This node, at the $i$-th location along the wall, has a temperature of $T_{1,i}$.\nThe problem states to assume a locally linear temperature variation across this half-cell. This allows us to approximate the temperature gradient at the wall using a first-order finite difference between the wall and the adjacent fluid node:\n$$\\left. \\frac{\\partial T}{\\partial n} \\right|_w \\approx \\frac{T(y_1) - T(y_w)}{y_1 - y_w} = \\frac{T_{1,i} - T_w}{\\frac{1}{2}\\Delta x - 0} = \\frac{2(T_{1,i} - T_w)}{\\Delta x}$$\nSubstituting this discrete approximation for the gradient into our expression for the local Nusselt number $Nu(x_i)$ at the discrete location $i$:\n$$Nu(x_i) = - \\frac{H}{T_w - T_b} \\left( \\frac{2(T_{1,i} - T_w)}{\\Delta x} \\right) = \\frac{2H}{\\Delta x} \\frac{T_w - T_{1,i}}{T_w - T_b}$$\n\nFourth, we define the average Nusselt number, $Nu_{\\mathrm{avg}}$, over the heated wall of length $L$. It is defined as the line-average of the local Nusselt number $Nu(x)$:\n$$Nu_{\\mathrm{avg}} = \\frac{1}{L} \\int_0^L Nu(x) \\, dx$$\nFor a discrete set of $M$ evenly spaced wall nodes with spacing $\\Delta s = L/M$, this integral is approximated by a discrete sum. The standard discrete average, which corresponds to an approximation using the rectangular integration rule, is the arithmetic mean of the local values:\n$$Nu_{\\mathrm{avg}} \\approx \\frac{1}{L} \\sum_{i=1}^{M} Nu(x_i) \\Delta s = \\frac{1}{L} \\sum_{i=1}^{M} Nu(x_i) \\frac{L}{M} = \\frac{1}{M} \\sum_{i=1}^{M} Nu(x_i)$$\n\nFinally, we combine these steps to obtain the closed-form expression for $Nu_{\\mathrm{avg}}$. We substitute the expression for the local discrete Nusselt number $Nu(x_i)$ into the averaging formula:\n$$Nu_{\\mathrm{avg}} = \\frac{1}{M} \\sum_{i=1}^{M} \\left( \\frac{2H}{\\Delta x} \\frac{T_w - T_{1,i}}{T_w - T_b} \\right)$$\nThe terms $\\frac{2H}{\\Delta x (T_w - T_b)}$ are constant with respect to the summation index $i$, so they can be factored out of the sum:\n$$Nu_{\\mathrm{avg}} = \\frac{2H}{M \\Delta x (T_w - T_b)} \\sum_{i=1}^{M} (T_w - T_{1,i})$$\nThis is the final analytical expression for the average Nusselt number in terms of the given quantities: the channel height $H$, the grid spacing $\\Delta x$, the wall temperature $T_w$, the bulk fluid temperature $T_b$, the number of wall nodes $M$, and the set of temperatures at the first fluid nodes adjacent to the wall, $\\{T_{1,i}\\}_{i=1}^{M}$. The problem requests the answer in terms of the set $\\{T_{1,i}\\}_{i=1}^{M}$, and this form explicitly includes it via summation.",
            "answer": "$$\n\\boxed{\\frac{2H}{M \\Delta x (T_w - T_b)} \\sum_{i=1}^{M} (T_w - T_{1,i})}\n$$"
        }
    ]
}