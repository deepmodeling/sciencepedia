{
    "hands_on_practices": [
        {
            "introduction": "在开发和评估自适应网格细化 (AMR) 求解器时，首要步骤是验证其正确性并量化其性能。制造解方法 (MMS) 是一个基本工具，它允许我们通过一个已知的精确解来严格测试代码的实现和收敛特性。本练习将引导您完成为稳态热传导问题构建这样一个验证案例的过程，并预测理想自适应策略下求解器应达到的最优收敛率 。",
            "id": "3934182",
            "problem": "考虑在单位正方形域 $\\Omega = (0,1)^{2}$ 内的稳态热传导，其热导率随空间变化。其控制方程为\n$$\\nabla \\cdot \\big(k(x,y)\\,\\nabla T(x,y)\\big) + q(x,y) = 0,$$\n其狄利克雷边界条件等于精确的制造温度场。为使用 $h$-自适应验证一个自适应网格加密 (Adaptive Mesh Refinement, AMR) 求解器，假设制造的温度场和热导率选择为\n$$T(x,y) = \\exp(x)\\,\\cos(\\pi y), \\quad k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y),$$\n这确保了对于所有 $(x,y) \\in \\Omega$，$k(x,y) \\geq 1$。该求解器采用有限元法 (Finite Element Method, FEM)，在形状规则的三角剖分上使用线性形函数，并使用一个基于残差的 $h$-自适应准则，该准则结合了单元体积残差和跨边的通量跳跃项，并按局部网格尺寸进行缩放。\n\n从上述强形式和给定的制造场出发，推导使 $T(x,y)$ 成为精确解的体积热源 $q(x,y)$。然后，在针对光滑解的可靠且高效的基于残差的估计器指导下的 $h$-加密中，使用 FEM 在能量范数下的基本收敛理论，预测代数收敛速率指数 $r$，使得能量范数误差满足\n$$\\|\\nabla(T - T_h)\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-r},$$\n当自由度数 $N \\to \\infty$ 时，其中 $C$ 与 $N$ 无关。将最终答案表示为 $r$ 的值。无需四舍五入。最终答案是无量纲的。",
            "solution": "具有随空间变化的热导率的稳态热传导方程为\n$$\\nabla \\cdot \\big(k\\,\\nabla T\\big) + q = 0.$$\n等价地，\n$$q = -\\,\\nabla \\cdot \\big(k\\,\\nabla T\\big).$$\n我们给定的制造温度为\n$$T(x,y) = \\exp(x)\\,\\cos(\\pi y),$$\n和热导率\n$$k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y).$$\n为计算 $q(x,y)$，我们使用乘积-散度恒等式\n$$\\nabla \\cdot \\big(k\\,\\nabla T\\big) = k\\,\\Delta T + \\nabla k \\cdot \\nabla T.$$\n因此我们需要 $\\Delta T$ 和 $\\nabla k \\cdot \\nabla T$。\n\n首先，计算 $T(x,y)$ 的导数：\n$$T_{x}(x,y) = \\exp(x)\\,\\cos(\\pi y), \\quad T_{y}(x,y) = -\\pi\\,\\exp(x)\\,\\sin(\\pi y).$$\n从而，\n$$T_{xx}(x,y) = \\exp(x)\\,\\cos(\\pi y),$$\n$$T_{yy}(x,y) = -\\pi^{2}\\,\\exp(x)\\,\\cos(\\pi y).$$\n因此拉普拉斯算子为\n$$\\Delta T(x,y) = T_{xx}(x,y) + T_{yy}(x,y) = \\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).$$\n\n接下来，计算 $k(x,y)$ 的导数：\n$$k_{x}(x,y) = \\pi\\,\\cos(\\pi x)\\,\\sin(\\pi y), \\quad k_{y}(x,y) = \\pi\\,\\sin(\\pi x)\\,\\cos(\\pi y).$$\n所以，\n$$\n\\begin{align*}\n\\nabla k \\cdot \\nabla T\n= k_{x}\\,T_{x} + k_{y}\\,T_{y} \\\\\n= \\big(\\pi\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(\\exp(x)\\,\\cos(\\pi y)\\big) + \\big(\\pi\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\big)\\,\\big(-\\pi\\,\\exp(x)\\,\\sin(\\pi y)\\big) \\\\\n= \\pi\\,\\exp(x)\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\,\\cos(\\pi y) - \\pi^{2}\\,\\exp(x)\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\,\\sin(\\pi y).\n\\end{align*}\n$$\n另外，\n$$\n\\begin{align*}\nk\\,\\Delta T\n= \\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).\n\\end{align*}\n$$\n合并，\n$$\n\\begin{align*}\n\\nabla \\cdot \\big(k\\,\\nabla T\\big)\n= \\nabla k \\cdot \\nabla T + k\\,\\Delta T \\\\\n= \\pi\\,\\exp(x)\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\,\\cos(\\pi y) - \\pi^{2}\\,\\exp(x)\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\,\\sin(\\pi y) \\\\\n\\quad + \\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).\n\\end{align*}\n$$\n因此，\n$$\n\\begin{align*}\nq(x,y)\n= -\\,\\nabla \\cdot \\big(k\\,\\nabla T\\big) \\\\\n= -\\,\\exp(x)\\,\\cos(\\pi y)\\,\\Big[\\sin(\\pi y)\\,\\big(\\pi\\,\\cos(\\pi x) - \\pi^{2}\\,\\sin(\\pi x)\\big) + \\big(1 - \\pi^{2}\\big)\\,\\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\Big].\n\\end{align*}\n$$\n\n我们现在在基于残差的估计器指导下的 $h$-自适应加密中预测能量范数下的代数收敛速率指数 $r$。能量范数为\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)}.$$\n对于在形状规则的三角剖分上使用多项式次数 $p = 1$ (线性形函数) 的有限元法 (Finite Element Method, FEM)，且对于光滑的精确解 $T$ 和有界非零的光滑热导率 $k$，标准的先验理论给出\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\le C\\,h^{p}\\,|T|_{H^{p+1}(\\Omega)},$$\n对于某个与网格尺寸 $h$ 无关的常数 $C$，前提是 $T \\in H^{p+1}(\\Omega)$。在我们的例子中，$T(x,y) = \\exp(x)\\,\\cos(\\pi y)$ 在 $\\Omega$ 上是解析的，而 $k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y)$ 是光滑且严格为正的，因此正则性假设得到满足。\n\n在二维情况下，将 $h$ 与自由度数 $N$ 相关联，对于形状规则的网格，有 $N \\propto h^{-2}$。因此\n$$h \\propto N^{-1/2}.$$\n代入能量范数估计式可得\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\le C'\\,N^{-p/2},$$\n对于某个与 $N$ 无关的常数 $C'$。当 $p = 1$ 时，这变为\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-1/2}.$$\n对于椭圆问题，可靠且高效的基于残差的 $h$-自适应准则（结合了体积残差 $q + \\nabla \\cdot (k\\,\\nabla T_{h})$ 和跨单元间边界的通量跳跃项，每一项都按局部 $h$ 进行了适当缩放）可使光滑解的误差密度在单元上均等分布，从而实现相对于 $N$ 的相同最优代数速率。因此，在\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-r}$$\n中的预测指数 $r$ 是\n$$r = \\frac{1}{2}.$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "理解自适应网格细化的核心在于掌握误差如何与网格尺寸关联，以及如何分布网格以最小化全局误差。本练习提供了一个从第一性原理出发的机会，为一个具有明显边界层特征的一维对流-扩散问题推导最优的网格尺寸函数 $h(x)$ 。通过旨在使插值误差均匀分布的策略，您将亲身体验如何根据解的特性（此处由其二阶导数衡量）来理论上设计一个高效的网格。",
            "id": "3934281",
            "problem": "一个一维空间中的热输运过程在区间 $x \\in [0, L]$ 上通过具有恒定物性的稳态对流-扩散方程建模，\n$$u \\frac{d T}{d x} = \\alpha \\frac{d^{2} T}{d x^{2}},$$\n其中 $T(x)$ 是温度，$u  0$ 是均匀流速，$\\alpha  0$ 是热扩散率。边界条件为 $T(0) = T_{0}$ 和 $T(L) = T_{L}$，其中 $T_{0}$ 和 $T_{L}$ 是给定的常数。对于大佩克莱数 $Pe = \\frac{u L}{\\alpha}$，精确解中会在 $x = L$ 附近形成一个薄的出口边界层。\n\n在使用线性拉格朗日单元的有限元法 (FEM) 的自适应网格加密 (AMR) 与 $h$-自适应的范式中，假设单元尺寸分布 $h(x)$ 被设计为基于二阶导数监测函数来均分主阶插值误差，即局部插值误差的尺度与 $h(x)^{2} |T''(x)|$ 相当。设所需网格在 $[0, L]$ 上恰好由 $N$ 个单元组成，并强制执行约束 $\\int_{0}^{L} \\frac{dx}{h(x)} = N$。\n\n从控制方程和边界条件出发，推导目标单元尺寸函数 $h(x)$ 的精确表达式，该函数在 $[0, L]$ 上均分主阶插值误差。将你的最终答案表示为关于 $L$、$u$、$\\alpha$ 和 $N$ 的单个闭式解析表达式。$h(x)$ 以米为单位表示。不需要进行数值评估，也无需四舍五入。仅使用给定的符号和需要的基本常数。",
            "solution": "推导单元尺寸函数 $h(x)$ 需要几个步骤。首先，我们必须求出控制方程的精确解析解 $T(x)$。其次，我们计算其二阶导数 $T''(x)$。第三，我们将误差均分原理形式化，并使用单元数量的积分约束来找到 $h(x)$ 的显式形式。\n\n**1. 温度 $T(x)$ 的解析解**\n\n控制方程是一个稳态一维对流-扩散方程：\n$$\\alpha \\frac{d^{2} T}{d x^{2}} - u \\frac{d T}{d x} = 0$$\n我们寻求形式为 $T(x) = \\exp(rx)$ 的解。特征方程为：\n$$\\alpha r^2 - u r = 0$$\n$$r(\\alpha r - u) = 0$$\n根为 $r_1 = 0$ 和 $r_2 = \\frac{u}{\\alpha}$。$T(x)$ 的通解是与这些根相对应的解的线性组合：\n$$T(x) = C_1 \\exp(r_1 x) + C_2 \\exp(r_2 x) = C_1 + C_2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n常数 $C_1$ 和 $C_2$ 由边界条件 $T(0) = T_0$ 和 $T(L) = T_L$ 确定。\n在 $x=0$ 处：\n$$T(0) = T_0 = C_1 + C_2 \\exp(0) \\implies T_0 = C_1 + C_2$$\n在 $x=L$ 处：\n$$T(L) = T_L = C_1 + C_2 \\exp\\left(\\frac{u L}{\\alpha}\\right)$$\n这是一个关于 $C_1$ 和 $C_2$ 的二元线性方程组。由第一个方程，我们有 $C_1 = T_0 - C_2$。将其代入第二个方程得到：\n$$T_L = (T_0 - C_2) + C_2 \\exp\\left(\\frac{u L}{\\alpha}\\right) = T_0 + C_2 \\left(\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1\\right)$$\n解出 $C_2$：\n$$C_2 = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\n解出 $C_1$：\n$$C_1 = T_0 - C_2 = T_0 - \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} = \\frac{T_0 \\exp\\left(\\frac{u L}{\\alpha}\\right) - T_0 - T_L + T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} = \\frac{T_0 \\exp\\left(\\frac{u L}{\\alpha}\\right) - T_L}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\n将 $C_1$ 和 $C_2$ 代回 $T(x)$ 的通解，得到精确解：\n$$T(x) = T_0 + (T_L - T_0) \\frac{\\exp\\left(\\frac{u x}{\\alpha}\\right) - 1}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\n\n**2. 解的二阶导数**\n\n误差均分准则基于二阶导数 $T''(x)$。我们将 $T(x)$ 对 $x$ 求导两次。\n一阶导数：\n$$\\frac{d T}{d x} = \\frac{d}{dx} \\left[ T_0 + (T_L - T_0) \\frac{\\exp\\left(\\frac{u x}{\\alpha}\\right) - 1}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right] = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n二阶导数：\n$$\\frac{d^2 T}{d x^2} = \\frac{d}{dx} \\left[ \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{\\alpha}\\right) \\right] = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right)^2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n\n**3. 单元尺寸函数 $h(x)$ 的推导**\n\n问题陈述指出，单元尺寸分布 $h(x)$ 被设计为均分主阶插值误差，其尺度与 $h(x)^{2} |T''(x)|$ 相当。均分原理要求该量在整个区域内为常数：\n$$h(x)^2 |T''(x)| = C_{eq}$$\n其中 $C_{eq}$ 是一个常数。这意味着单元尺寸 $h(x)$ 应为：\n$$h(x) = \\frac{\\sqrt{C_{eq}}}{|T''(x)|^{1/2}}$$\n常数 $\\sqrt{C_{eq}}$ 由网格必须恰好包含 $N$ 个单元的约束确定。在连续极限下，这表示为：\n$$\\int_{0}^{L} \\frac{dx}{h(x)} = N$$\n将 $h(x)$ 的表达式代入约束中：\n$$\\int_{0}^{L} \\frac{|T''(x)|^{1/2}}{\\sqrt{C_{eq}}} dx = N$$\n解出 $\\sqrt{C_{eq}}$：\n$$\\sqrt{C_{eq}} = \\frac{1}{N} \\int_{0}^{L} |T''(x')|^{1/2} dx'$$\n（为清楚起见，使用 $x'$作为积分变量）。将此式代回 $h(x)$ 的表达式，得到最优网格尺寸函数的一般公式：\n$$h(x) = \\frac{\\frac{1}{N} \\int_{0}^{L} |T''(x')|^{1/2} dx'}{|T''(x)|^{1/2}}$$\n现在，我们将此公式应用于我们的特定问题。首先，我们求 $|T''(x)|^{1/2}$：\n$$|T''(x)| = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right| \\left(\\frac{u}{\\alpha}\\right)^2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n取平方根：\n$$|T''(x)|^{1/2} = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right|^{1/2} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{2\\alpha}\\right)$$\n这可以写成 $|T''(x)|^{1/2} = C_A \\exp\\left(\\frac{u x}{2\\alpha}\\right)$，其中 $C_A = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right|^{1/2} \\frac{u}{\\alpha}$ 是一个与 $x$ 无关的常数。\n\n接下来，我们计算分子中的积分：\n$$\\int_{0}^{L} |T''(x')|^{1/2} dx' = \\int_{0}^{L} C_A \\exp\\left(\\frac{u x'}{2\\alpha}\\right) dx' = C_A \\left[ \\frac{2\\alpha}{u} \\exp\\left(\\frac{u x'}{2\\alpha}\\right) \\right]_{0}^{L}$$\n$$= C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - \\exp(0)\\right) = C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right)$$\n现在我们将此积分和 $|T''(x)|^{1/2}$ 的表达式代回 $h(x)$ 的一般公式：\n$$h(x) = \\frac{1}{N} \\frac{C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right)}{C_A \\exp\\left(\\frac{u x}{2\\alpha}\\right)}$$\n常数 $C_A$ 被消掉。这是一个关键结果，因为它意味着最优单元尺寸分布与具体的边界温度值 $T_0$ 和 $T_L$ 无关，仅取决于系统参数 $u, \\alpha, L$ 和网格参数 $N$。\n简化 $h(x)$ 的表达式：\n$$h(x) = \\frac{1}{N} \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right) \\frac{1}{\\exp\\left(\\frac{u x}{2\\alpha}\\right)}$$\n$$h(x) = \\frac{2\\alpha}{Nu} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right) \\exp\\left(-\\frac{u x}{2\\alpha}\\right)$$\n这是目标单元尺寸函数 $h(x)$ 的最终表达式。该函数是一个衰减指数函数，表明网格应在出口边界 $x=L$ 处最密（$h$ 最小），这与大佩克莱数下该区域存在边界层的情况一致。该表达式的单位是米，因为 $\\frac{\\alpha}{u}$ 的单位是长度（$\\frac{m^2/s}{m/s} = m$），而 $N$ 和指数项是无量纲的。",
            "answer": "$$\n\\boxed{\\frac{2\\alpha}{Nu} \\left(\\exp\\left(\\frac{uL}{2\\alpha}\\right) - 1\\right) \\exp\\left(-\\frac{ux}{2\\alpha}\\right)}\n$$"
        },
        {
            "introduction": "在实际的复杂问题中，我们无法像上一个练习那样预先知道精确解并解析地设计网格。因此，自适应循环依赖于后验误差估计器来识别需要细化的区域。本练习聚焦于一种广泛使用的技术——基于通量恢复的 Zienkiewicz-Zhu 误差指示器，并要求您推导其形式，然后在一个具体案例中进行计算 。这个过程揭示了如何从一个已有的数值解中提取关于其自身误差的信息，这是驱动 h-自适应过程的关键一步。",
            "id": "3934228",
            "problem": "考虑由傅里叶定律 $\\,\\boldsymbol{q}=-k\\,\\nabla T\\,$ 和守恒方程 $-\\nabla\\cdot(k\\,\\nabla T)=f$ 在域 $\\Omega$ 中所描述的稳态热传导问题，其中 $k(\\boldsymbol{x})0$ 是热导率，$T$ 是温度，$\\boldsymbol{q}$ 是热通量。设 $T_h\\in H^1(\\Omega)$ 是通过有限元法 (FEM) 获得的一致有限元近似解，并定义离散通量为 $\\boldsymbol{q}_h:=-k\\,\\nabla T_h$。在单元 $K\\subset\\Omega$ 上，考虑一个通量恢复过程，该过程产生一个连续的恢复场 $\\tilde{\\boldsymbol{q}}$，在渐近加密的意义上，它比 $\\boldsymbol{q}_h$ 更精确地逼近精确通量 $\\boldsymbol{q}$。\n\n(a) 从误差的热加权能量范数 $\\,\\|e\\|_{E(K)}^2:=\\int_K k\\,\\nabla e\\cdot\\nabla e\\,dV\\,$（其中 $e:=T-T_h$）出发，推导一个仅基于 $\\boldsymbol{q}_h$ 和恢复通量 $\\tilde{\\boldsymbol{q}}$ 的单元可计算指标，并解释在何种渐近条件下（关于 $h$-加密和恢复质量），该指标与误差的能量范数一致。\n\n(b) 现在，对以下科学上合理的单元和场，计算您在 (a) 部分推导的指标。设单元 $K=[0,a]\\times[0,b]\\times[0,t]$，其中 $a=0.02\\,\\mathrm{m}$，$b=0.03\\,\\mathrm{m}$，$t=1\\,\\mathrm{m}$，并且单元 $K$ 上的热导率为常数 $k=12\\,\\mathrm{W/(m\\cdot K)}$。取单元 $K$ 上的离散通量为常数\n$$\n\\boldsymbol{q}_h = \\begin{pmatrix}120\\\\-80\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2},\n$$\n以及一个在面内坐标上呈线性且与 $z$ 无关的恢复通量场，\n$$\n\\tilde{\\boldsymbol{q}}(x,y,z) = \\begin{pmatrix}120+1000\\,x-500\\,y\\\\-80+600\\,x+400\\,y\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}.\n$$\n计算单元指标值。将您的答案四舍五入到四位有效数字，并以 $\\mathrm{W\\cdot K}$ 为单位表示最终值。",
            "solution": "**(a) 误差指标的推导与一致性**\n\n问题要求为稳态热传导问题的有限元近似提供一个单元可计算的误差指标。该指标应基于单元 $K$ 上误差 $e = T - T_h$ 的热加权能量范数。\n\n单元 $K$ 上误差的能量范数平方定义为：\n$$\n\\|e\\|_{E(K)}^2 := \\int_K k\\,\\nabla e\\cdot\\nabla e\\,dV\n$$\n通过代入误差的定义 $e = T - T_h$，我们得到 $\\nabla e = \\nabla T - \\nabla T_h$。表达式变为：\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,(\\nabla T - \\nabla T_h)\\cdot(\\nabla T - \\nabla T_h)\\,dV\n$$\n精确通量 $\\boldsymbol{q}$ 和离散通量 $\\boldsymbol{q}_h$ 由傅里叶定律给出：\n$$\n\\boldsymbol{q} = -k\\,\\nabla T \\implies \\nabla T = -\\frac{1}{k}\\boldsymbol{q}\n$$\n$$\n\\boldsymbol{q}_h = -k\\,\\nabla T_h \\implies \\nabla T_h = -\\frac{1}{k}\\boldsymbol{q}_h\n$$\n将这些梯度的表达式代入误差范数的积分中，得到：\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,\\left(-\\frac{1}{k}\\boldsymbol{q} - \\left(-\\frac{1}{k}\\boldsymbol{q}_h\\right)\\right)\\cdot\\left(-\\frac{1}{k}\\boldsymbol{q} - \\left(-\\frac{1}{k}\\boldsymbol{q}_h\\right)\\right)\\,dV\n$$\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,\\left(\\frac{1}{k}(\\boldsymbol{q}_h - \\boldsymbol{q})\\right)\\cdot\\left(\\frac{1}{k}(\\boldsymbol{q}_h - \\boldsymbol{q})\\right)\\,dV\n$$\n$$\n\\|e\\|_{E(K)}^2 = \\int_K \\frac{1}{k}\\,(\\boldsymbol{q} - \\boldsymbol{q}_h)\\cdot(\\boldsymbol{q} - \\boldsymbol{q}_h)\\,dV = \\int_K \\frac{1}{k}\\,|\\boldsymbol{q} - \\boldsymbol{q}_h|^2\\,dV\n$$\n这个表达式代表了精确的误差平方，但是由于精确通量 $\\boldsymbol{q}$ 是未知的，所以它无法计算。后验误差估计的核心思想是用一个更精确的近似解来代替未知的精确解。问题引入了一个恢复通量 $\\tilde{\\boldsymbol{q}}$，它被设计成比 $\\boldsymbol{q}_h$ 更好的 $\\boldsymbol{q}$ 的近似。\n\n我们通过在误差范数平方的表达式中用 $\\tilde{\\boldsymbol{q}}$ 代替 $\\boldsymbol{q}$，得到一个可计算的误差指标，记为 $\\eta_K^2$：\n$$\n\\eta_K^2 = \\int_K \\frac{1}{k}\\,|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV\n$$\n这就是所求的单元可计算指标，被称为 Zienkiewicz-Zhu 误差估计子。\n\n为使该指标与真实误差一致，量 $\\eta_K$ 必须是 $\\|e\\|_{E(K)}$ 的一个良好近似。这由单元效率指数 $\\theta_K = \\eta_K / \\|e\\|_{E(K)}$ 来正式刻画，当网格尺寸 $h$ 趋于零时，该指数应趋近于1。此性质称为渐近精确性。\n\n$\\eta_K$ 能成为 $\\|e\\|_{E(K)}$ 的良好近似的条件与通量恢复的质量有关。根据对应于内积 $\\langle \\boldsymbol{a}, \\boldsymbol{b} \\rangle = \\int_K \\frac{1}{k} \\boldsymbol{a} \\cdot \\boldsymbol{b} \\, dV$ 的范数的三角不等式，我们有：\n$$\n\\left| \\|\\boldsymbol{q} - \\boldsymbol{q}_h\\| - \\|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h\\| \\right| \\leq \\|\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}\\|\n$$\n其中 $\\|\\cdot\\|$ 表示由此内积导出的范数。为了使指标准确，$\\|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h\\|$ 必须接近 $\\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|$。这种情况发生在 $\\|\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}\\|$ 远小于 $\\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|$ 时。\n\n这就引出了关键的渐近条件：恢复通量 $\\tilde{\\boldsymbol{q}}$ 必须是**超收敛**的。超收敛意味着 $\\tilde{\\boldsymbol{q}}$ 以比原始离散通量 $\\boldsymbol{q}_h$ 更高的精度阶数（相对于网格尺寸 $h$）收敛到真实通量 $\\boldsymbol{q}$。如果有限元的阶数为 $p$，则梯度（以及 $\\boldsymbol{q}_h$）的收敛率通常为 $\\|\\boldsymbol{q}-\\boldsymbol{q}_h\\|_{L_2} = O(h^p)$。如果 $\\|\\boldsymbol{q}-\\tilde{\\boldsymbol{q}}\\|_{L_2} = O(h^{p+r})$（对于某个 $r  0$），则恢复方案是超收敛的。在此条件下，与 $\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}$ 相关的估计子误差比被估计的误差本身消失得更快，从而确保了指标的一致性和渐近精确性。\n\n**(b) 指标的计算**\n\n我们需要计算给定单元 $K$ 和场的指标 $\\eta_K^2$。公式为：\n$$\n\\eta_K^2 = \\int_K \\frac{1}{k}\\,|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV\n$$\n给定条件如下：\n-   $K = [0,a]\\times[0,b]\\times[0,t]$，其中 $a=0.02\\,\\mathrm{m}$，$b=0.03\\,\\mathrm{m}$，$t=1\\,\\mathrm{m}$。\n-   $k = 12\\,\\mathrm{W/(m\\cdot K)}$。\n-   $\\boldsymbol{q}_h = \\begin{pmatrix}120\\\\-80\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}$。\n-   $\\tilde{\\boldsymbol{q}}(x,y,z) = \\begin{pmatrix}120+1000\\,x-500\\,y\\\\-80+600\\,x+400\\,y\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}$。\n\n首先，我们计算恢复通量向量和离散通量向量之间的差：\n$$\n\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h = \\begin{pmatrix} (120+1000\\,x-500\\,y) - 120 \\\\ (-80+600\\,x+400\\,y) - (-80) \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1000\\,x-500\\,y \\\\ 600\\,x+400\\,y \\\\ 0 \\end{pmatrix}\n$$\n接下来，我们计算该向量的模的平方：\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (1000\\,x-500\\,y)^2 + (600\\,x+400\\,y)^2 + 0^2\n$$\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (10^6 x^2 - 10^6 xy + 0.25 \\times 10^6 y^2) + (0.36 \\times 10^6 x^2 + 0.48 \\times 10^6 xy + 0.16 \\times 10^6 y^2)\n$$\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2\n$$\n现在，我们建立 $\\eta_K^2$ 的积分。由于被积函数不依赖于 $z$，在 $z$ 方向上从 $0$ 到 $t$ 的积分只是将结果乘以 $t$。令 $I$ 为在 $x,y$ 平面上的积分：\n$$\nI = \\int_0^b \\int_0^a \\left[ (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2 \\right] \\,dx\\,dy\n$$\n我们逐项进行积分：\n$$\nI = (1.36 \\times 10^6) \\int_0^b \\int_0^a x^2 \\,dx\\,dy - (0.52 \\times 10^6) \\int_0^b \\int_0^a xy \\,dx\\,dy + (0.41 \\times 10^6) \\int_0^b \\int_0^a y^2 \\,dx\\,dy\n$$\n分离的积分为：\n$$\n\\int_0^b \\int_0^a x^2 \\,dx\\,dy = \\left(\\frac{a^3}{3}\\right) b = \\frac{a^3b}{3}\n$$\n$$\n\\int_0^b \\int_0^a xy \\,dx\\,dy = \\left(\\frac{a^2}{2}\\right) \\left(\\frac{b^2}{2}\\right) = \\frac{a^2b^2}{4}\n$$\n$$\n\\int_0^b \\int_0^a y^2 \\,dx\\,dy = a \\left(\\frac{b^3}{3}\\right) = \\frac{ab^3}{3}\n$$\n将这些结果代回 $I$ 的表达式中：\n$$\nI = (1.36 \\times 10^6) \\frac{a^3b}{3} - (0.52 \\times 10^6) \\frac{a^2b^2}{4} + (0.41 \\times 10^6) \\frac{ab^3}{3}\n$$\n现在，代入数值 $a = 0.02$ 和 $b = 0.03$：\n$$\nI = (1.36 \\times 10^6) \\frac{(0.02)^3(0.03)}{3} - (0.52 \\times 10^6) \\frac{(0.02)^2(0.03)^2}{4} + (0.41 \\times 10^6) \\frac{(0.02)(0.03)^3}{3}\n$$\n$$\nI = (1.36 \\times 10^6) \\frac{(8 \\times 10^{-6})(3 \\times 10^{-2})}{3} - (0.52 \\times 10^6) \\frac{(4 \\times 10^{-4})(9 \\times 10^{-4})}{4} + (0.41 \\times 10^6) \\frac{(2 \\times 10^{-2})(27 \\times 10^{-6})}{3}\n$$\n$$\nI = (1.36 \\times 10^6)(8 \\times 10^{-8}) - (0.52 \\times 10^6)(9 \\times 10^{-8}) + (0.41 \\times 10^6)(18 \\times 10^{-8})\n$$\n$$\nI = 0.1088 - 0.0468 + 0.0738 = 0.1358\n$$\n这个积分 $I$ 的单位是 $(\\mathrm{W/m^2})^2 \\cdot \\mathrm{m}^2 = \\mathrm{W}^2/\\mathrm{m}^2$。因此，全体积分为：\n$$\n\\int_K |\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV = t \\times I = 1\\,\\mathrm{m} \\times 0.1358\\,\\mathrm{W}^2/\\mathrm{m}^2 = 0.1358\\,\\mathrm{W}^2/\\mathrm{m}\n$$\n最后，我们计算误差指标 $\\eta_K^2$：\n$$\n\\eta_K^2 = \\frac{1}{k} \\int_K |\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV = \\frac{0.1358 \\,[\\mathrm{W^2/m}]}{12 \\,[\\mathrm{W/(m\\cdot K)}]} = 0.01131666... \\, \\mathrm{W \\cdot K}\n$$\n四舍五入到四位有效数字，单元指标的值为 $0.01132\\,\\mathrm{W \\cdot K}$。",
            "answer": "$$\\boxed{0.01132}$$"
        }
    ]
}