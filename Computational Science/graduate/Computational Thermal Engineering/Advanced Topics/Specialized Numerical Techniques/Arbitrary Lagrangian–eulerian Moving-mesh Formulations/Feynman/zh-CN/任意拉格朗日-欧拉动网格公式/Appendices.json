{
    "hands_on_practices": [
        {
            "introduction": "在任意拉格朗日-欧拉 (ALE) 方法中，一个关键挑战是如何平滑地使内部网格变形以适应运动的边界。谐波提升是一种稳健的技术，通过求解网格位移或速度的拉普拉斯方程来生成高质量的网格运动。本练习  提供了对该方法的分析实践，揭示了一个基本属性：当边界进行刚体运动时，该运动在区域内部的谐波延拓就是刚体运动本身。这一洞察对于理解该方法和创建简单的验证测试都很有价值。",
            "id": "3937140",
            "problem": "考虑一个二维有界单连通计算域 $\\Omega \\subset \\mathbb{R}^{2}$，其具有包含原点的利普希茨边界 $\\partial \\Omega$。该域中进行着一个任意拉格朗日-欧拉（ALE）框架下的瞬态传热计算，其中网格运动通过网格速度进入能量方程的 ALE 形式。物理边界经历一个规定的刚体运动，该运动由一个随时间变化的平移（速度为 $\\mathbf{V}(t) = \\left(V_{x}(t), V_{y}(t)\\right)$）和一个绕原点随时间变化的平面内旋转（角速度为 $\\omega(t)$，逆时针旋转为正）组成。令 $\\mathbf{x} = (x,y)$ 表示当前构型中的空间坐标。\n\n采用调和提升来获得平滑的内部网格运动：具体来说，令网格位移 $\\mathbf{d}(\\mathbf{x},t)$ 在 $\\Omega$ 中求解向量拉普拉斯方程，其狄利克雷数据等于物理边界在 $\\partial \\Omega$ 上的位移。等价地，网格速度 $\\mathbf{w}(\\mathbf{x},t) = \\partial \\mathbf{d}(\\mathbf{x},t)/\\partial t$ 在 $\\Omega$ 内逐分量满足向量拉普拉斯方程，其狄利克雷边界值等于 $\\partial \\Omega$ 上的物理边界速度 $\\mathbf{u}_{b}(\\mathbf{x},t)$。规定的边界速度是刚体速度\n$$\n\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x},\n$$\n其中 $\\mathbf{k}$ 是与平面正交的单位向量，且 $\\mathbf{k} \\times \\mathbf{x} = (-y, x)$。\n\n从椭圆偏微分方程的基本事实和刚体运动的性质出发，推导由边界速度的调和提升所产生的唯一内部网格速度场 $\\mathbf{w}(\\mathbf{x},t)$，然后计算在特定时间 $t_{0}$ 处特定网格节点 $\\mathbf{x}_{0} = (x_{0}, y_{0})$ 的内部网格速度。将最终答案表示为给出 $\\mathbf{w}(\\mathbf{x}_{0}, t_{0})$ 的单个解析表达式。不需要数值。如果选择分量形式书写结果，请将其表示为单个行向量。最终答案中不要提供单位。",
            "solution": "首先将验证问题的科学性和数学合理性。\n\n### 步骤1：提取已知条件\n-   **计算域**：一个二维、有界、单连通的域 $\\Omega \\subset \\mathbb{R}^{2}$，其具有利普希茨边界 $\\partial \\Omega$。原点包含在 $\\Omega$ 内。\n-   **方法论**：用于瞬态传热的任意拉格朗日-欧拉（ALE）框架。\n-   **网格运动**：网格速度 $\\mathbf{w}(\\mathbf{x},t) = \\frac{\\partial \\mathbf{d}(\\mathbf{x},t)}{\\partial t}$（其中 $\\mathbf{d}$ 是网格位移）通过调和提升获得。\n-   **网格速度的控制方程**：网格速度场 $\\mathbf{w}(\\mathbf{x},t)$ 在域 $\\Omega$ 内逐分量满足向量拉普拉斯方程 $\\nabla^2 \\mathbf{w} = \\mathbf{0}$。\n-   **网格速度的边界条件**：在边界 $\\partial \\Omega$ 上，网格速度由物理边界速度 $\\mathbf{u}_{b}(\\mathbf{x},t)$ 规定。这作为 $\\mathbf{w}(\\mathbf{x},t)$ 的狄利克雷边界条件。\n-   **规定的边界速度**：边界经历刚体运动，由 $\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}$ 给出，其中 $\\mathbf{x}=(x,y) \\in \\partial\\Omega$。\n-   **定义**：$\\mathbf{V}(t) = (V_{x}(t), V_{y}(t))$ 是平移速度。$\\omega(t)$ 是绕原点的标量角速度。$\\mathbf{k}$ 是与 $xy$ 平面正交的单位向量，叉积定义为 $\\mathbf{k} \\times \\mathbf{x} = (-y, x)$。\n-   **目标**：推导内部网格速度场 $\\mathbf{w}(\\mathbf{x},t)$ 并在特定时间 $t_0$ 对特定点 $\\mathbf{x}_{0} = (x_0, y_0)$ 进行求值。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在计算流体动力学和传热领域有充分的依据。对于移动边界问题，使用 ALE 框架是标准做法。调和提升（为网格位移或速度求解拉普拉斯方程）是一种广泛使用和公认的技术，用于从规定的边界运动生成平滑的内部网格运动。刚体速度的表达式是运动学的基础。该提法在科学上是合理的。\n-   **适定性**：该问题可归结为在有界域 $\\Omega$ 上求解带有指定狄利克雷边界条件 $\\mathbf{w}|_{\\partial \\Omega} = \\mathbf{u}_b$ 的向量拉普拉斯方程 $\\nabla^2 \\mathbf{w} = \\mathbf{0}$。拉普拉斯方程的狄利克雷问题是适定椭圆偏微分方程的经典例子。在给定条件下（具有利普希茨边界的有界域），解的存在性、唯一性和稳定性得到保证。\n-   **客观性**：该问题使用精确、明确的数学术语陈述。没有主观或基于意见的陈述。\n-   **一致性和完整性**：该问题提供了所有必要的信息：控制偏微分方程、域的性质和边界条件。没有内部矛盾。\n\n### 步骤3：结论和行动\n该问题是有效的。它在科学上是合理的、适定的、客观的且自洽的。可以从提供的信息中推导出严谨的解。\n\n### 解的推导\n问题的核心是找到向量场 $\\mathbf{w}(\\mathbf{x},t)$，该向量场在每个时间 $t$ 满足以下边值问题：\n$$\n\\nabla^2 \\mathbf{w}(\\mathbf{x},t) = \\mathbf{0} \\quad \\text{for } \\mathbf{x} \\in \\Omega\n$$\n$$\n\\mathbf{w}(\\mathbf{x},t) = \\mathbf{u}_{b}(\\mathbf{x},t) \\quad \\text{for } \\mathbf{x} \\in \\partial\\Omega\n$$\n其中 $\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}$。\n\n这个向量方程可以分解为两个独立的标量拉普拉斯方程，分别对应 $\\mathbf{w} = (w_x, w_y)$ 的分量。边界速度 $\\mathbf{u}_b = (u_{b,x}, u_{b,y})$ 的分量是：\n$$\nu_{b,x}(x,y,t) = V_x(t) - \\omega(t)y\n$$\n$$\nu_{b,y}(x,y,t) = V_y(t) + \\omega(t)x\n$$\n因此，两个标量问题是：\n1.  找到 $w_x(x,y,t)$，使得在 $\\Omega$ 中 $\\nabla^2 w_x = 0$，且对于 $(x,y) \\in \\partial\\Omega$，有 $w_x(x,y,t) = V_x(t) - \\omega(t)y$。\n2.  找到 $w_y(x,y,t)$，使得在 $\\Omega$ 中 $\\nabla^2 w_y = 0$，且对于 $(x,y) \\in \\partial\\Omega$，有 $w_y(x,y,t) = V_y(t) + \\omega(t)x$。\n\n拉普拉斯方程的狄利克雷问题有唯一解。让我们为内部速度场 $\\mathbf{w}(\\mathbf{x}, t)$ 提出了一个候选解，其解析形式与边界速度场相同，即：\n$$\n\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}\n$$\n对于所有 $\\mathbf{x} \\in \\Omega$。\n\n我们必须验证此候选解是否同时满足控制方程和边界条件。\n首先，对于任意点 $\\mathbf{x} \\in \\partial\\Omega$，根据定义，候选解等于规定的边界速度：$\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t) = \\mathbf{u}_{b}(\\mathbf{x}, t)$。因此，边界条件得到满足。\n\n其次，我们必须验证 $\\mathbf{w}_{\\text{candidate}}$ 在整个域 $\\Omega$ 内满足拉普拉斯方程 $\\nabla^2 \\mathbf{w} = \\mathbf{0}$。我们逐分量检查。\n候选解的分量为：\n$$\nw_{\\text{candidate}, x}(x, y, t) = V_x(t) - \\omega(t) y\n$$\n$$\nw_{\\text{candidate}, y}(x, y, t) = V_y(t) + \\omega(t) x\n$$\n对于 $x$ 分量，拉普拉斯算子是 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。注意 $V_x(t)$ 和 $\\omega(t)$ 仅是 $t$ 的函数，因此在对空间求导时它们被视为常数。\n$$\n\\nabla^2 w_{\\text{candidate}, x} = \\frac{\\partial^2}{\\partial x^2}\\left( V_x(t) - \\omega(t) y \\right) + \\frac{\\partial^2}{\\partial y^2}\\left( V_x(t) - \\omega(t) y \\right)\n$$\n第一项是 $\\frac{\\partial}{\\partial x}(0) = 0$。第二项是 $\\frac{\\partial}{\\partial y}(-\\omega(t)) = 0$。\n$$\n\\nabla^2 w_{\\text{candidate}, x} = 0 + 0 = 0\n$$\n因此，$x$ 分量是调和函数。\n\n对于 $y$ 分量：\n$$\n\\nabla^2 w_{\\text{candidate}, y} = \\frac{\\partial^2}{\\partial x^2}\\left( V_y(t) + \\omega(t) x \\right) + \\frac{\\partial^2}{\\partial y^2}\\left( V_y(t) + \\omega(t) x \\right)\n$$\n第一项是 $\\frac{\\partial}{\\partial x}(\\omega(t)) = 0$。第二项是 $\\frac{\\partial}{\\partial y}(0) = 0$。\n$$\n\\nabla^2 w_{\\text{candidate}, y} = 0 + 0 = 0\n$$\n因此，$y$ 分量也是调和函数。\n\n由于 $\\mathbf{w}_{\\text{candidate}}$ 的两个分量都是调和的，向量场本身也是调和的：$\\nabla^2 \\mathbf{w}_{\\text{candidate}} = \\mathbf{0}$。\n\n我们找到了一个函数 $\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t)$，它既满足 $\\Omega$ 内的控制偏微分方程，又满足 $\\partial\\Omega$ 上的规定狄利克雷条件。由于此边值问题的解是唯一的，我们的候选解必定是唯一的解。\n这展示了一个基本性质：任何刚体速度场都是一个调和向量场。当调和提升程序应用于作刚体运动的边界时，它只是将此刚体速度场延伸到域的内部。\n\n因此，唯一的内部网格速度场是：\n$$\n\\mathbf{w}(\\mathbf{x}, t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}\n$$\n问题要求在特定时间 $t_{0}$ 计算特定网格节点 $\\mathbf{x}_{0} = (x_{0}, y_{0})$ 处的速度。我们将这些值代入推导出的表达式中：\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = \\mathbf{V}(t_{0}) + \\omega(t_{0})\\,\\mathbf{k} \\times \\mathbf{x}_{0}\n$$\n用分量形式表示：\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = (V_x(t_0), V_y(t_0)) + \\omega(t_0)(-y_0, x_0)\n$$\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = (V_x(t_0) - \\omega(t_0)y_0, V_y(t_0) + \\omega(t_0)x_0)\n$$\n这就是在指定点和时间处的网格速度的最终解析表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} V_x(t_0) - \\omega(t_0)y_0 & V_y(t_0) + \\omega(t_0)x_0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "将控制方程转换为 ALE 框架后，我们需要一种严谨的方法来验证我们的数值求解器是否已正确实现。制造解法 (Method of Manufactured Solutions, MMS) 是一种强大的验证技术，它将一个选定的解析解代入控制方程，以推导出相应的源项。本实践  将引导您详细推导 ALE 对流-扩散方程并计算 MMS 源项，从而磨练在计算力学中进行代码验证所需的基本数学技能。",
            "id": "3937079",
            "problem": "考虑一个一维无反应热标量 $T(x,t)$，它在一个由任意拉格朗日-欧拉（ALE）移动网格追踪的区域中受平流和扩散控制。设参考坐标为 $\\Xi \\in [0,1]$，物理坐标为 $x \\in \\mathbb{R}$。从参考构型到物理构型的时间相关映射由 $x = \\chi(\\Xi,t)$ 给出，具体为\n$$\nx = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\,\\sin(\\omega t),\n$$\n其中 $\\varepsilon$ 和 $\\omega$ 为实常数，使得该映射在所有关注的时间 $t$ 内都是一个微分同胚。物理框架中的平流速度是均匀且恒定的，$v(x,t) \\equiv U_0$，热扩散系数为常数 $\\alpha > 0$。假设所有变量均为无量纲。网格速度定义为 $w(x,t) = \\partial \\chi/\\partial t \\big|_{\\Xi}$，映射的雅可比行列式为 $J(\\Xi,t) = \\partial \\chi/\\partial \\Xi$。\n\n从移动控制体积中被动标量的基本能量守恒和由映射 $\\chi(\\Xi,t)$ 隐含的链式法则关系出发，推导强形式的ALE平流-扩散方程。然后，使用人工解法确定ALE框架中的体积源项 $S_{\\mathrm{ALE}}(\\Xi,t)$，该源项是为使以下人工温度场能够精确满足ALE方程所必需的：\n$$\nT(x,t) = \\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\,\\exp(-\\lambda t),\n$$\n其中 $\\lambda > 0$ 是一个常数，$\\Xi$ 是通过 $\\chi(\\Xi,t)$ 映射到 $x$ 的参考坐标。请将最终源项 $S_{\\mathrm{ALE}}(\\Xi,t)$ 表示为关于 $\\Xi$、$t$、$U_0$、$\\alpha$、$\\varepsilon$、$\\omega$ 和 $\\lambda$ 的单个闭式解析表达式。无需进行数值四舍五入。",
            "solution": "用户希望我解决以下问题：\n首先验证该问题，以确保其科学上合理、自洽且适定。\n\n### 第1步：提取已知条件\n- **支配物理**：一维无反应热标量 $T(x,t)$ 的平流和扩散。\n- **区域**：一个任意拉格朗日-欧拉（ALE）移动网格。\n- **坐标**：\n    - 参考坐标：$\\Xi \\in [0,1]$。\n    - 物理坐标：$x \\in \\mathbb{R}$。\n- **映射**：从参考坐标到物理坐标的时间相关映射为 $x = \\chi(\\Xi,t)$，由以下公式给出：\n  $$x = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\,\\sin(\\omega t)$$\n  该映射是一个微分同胚，其中 $\\varepsilon$ 和 $\\omega$ 为实常数。\n- **物理属性**：\n    - 平流速度（物理框架）：$v(x,t) = U_0$（常数）。\n    - 热扩散系数：$\\alpha > 0$（常数）。\n- **ALE相关定义**：\n    - 网格速度：$w(x,t) = \\frac{\\partial \\chi}{\\partial t} \\big|_{\\Xi}$。\n    - 映射的雅可比行列式：$J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi}$。\n- **人工解**：温度场在参考坐标中给出为：\n  $$T(x,t) = \\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\,\\exp(-\\lambda t)$$\n  其中 $\\lambda > 0$ 为常数。\n- **任务**：\n    1.  推导强形式的ALE平流-扩散方程。\n    2.  使用人工解法求出ALE框架中的体积源项 $S_{\\mathrm{ALE}}(\\Xi,t)$，以使给定的 $\\Theta(\\Xi,t)$ 成为精确解。\n    3.  将 $S_{\\mathrm{ALE}}(\\Xi,t)$ 表示为关于 $\\Xi$、$t$、$U_0$、$\\alpha$、$\\varepsilon$、$\\omega$ 和 $\\lambda$ 的单个闭式解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于基本的平流-扩散方程，这是输运现象的基石。任意拉格朗-欧拉（ALE）公式是计算力学和热流体科学中的一个标准且成熟的方法。人工解法（MMS）是验证数值代码正确性的严谨技术。该问题在科学上是合理的。\n2.  **适定性**：该问题要求进行推导，然后基于该推导进行计算。所有必要的函数和参数都已提供。任务是计算一个源项，使给定函数成为所推导方程的解，这是一个明确定义的数学过程。\n3.  **客观性**：语言精确且数学化，没有主观或模糊的陈述。\n4.  **不完整或矛盾的设置**：该问题是自洽的。映射被说明为微分同胚，这意味着雅可比行列式 $J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi}$ 永远不为零（并假定为正）。这要求 $| \\varepsilon \\pi \\cos(\\pi \\Xi)\\,\\sin(\\omega t) | < 1$，从而对 $\\varepsilon$ 施加了一个物理上合理的约束，即 $|\\varepsilon| < 1/\\pi$。问题假定此条件成立。\n5.  **不切实际或不可行**：该设置是用于代码验证的标准理论问题。所有函数都是光滑且行为良好的。该设置是合理且可行的。\n\n### 第3步：结论与行动\n问题有效。我将继续进行求解。\n\n### 第1部分：强形式ALE平流-扩散方程的推导\n在固定的（欧拉）一维区域中，标量 $T$ 的守恒由平流-扩散方程描述：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x + \\frac{\\partial}{\\partial x}(vT) = \\frac{\\partial}{\\partial x}\\left(\\alpha \\frac{\\partial T}{\\partial x}\\right) + S_{\\text{phys}}(x,t) $$\n鉴于流体速度 $v = U_0$ 和扩散系数 $\\alpha$ 为常数，方程简化为：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x + U_0 \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}}(x,t) $$\n在ALE框架中，我们希望表达相对于参考坐标 $\\Xi$ 的时间演化，在时间微分过程中 $\\Xi$ 保持不变。固定物理点 $x$ 处的时间导数（欧拉）与固定参考点 $\\Xi$ 处的时间导数（ALE）之间的关系由链式法则给出：\n$$ \\frac{\\partial T(x(\\Xi,t), t)}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta(\\Xi, t)}{\\partial t}\\bigg|_\\Xi + \\frac{\\partial \\Theta(\\Xi, t)}{\\partial \\Xi} \\frac{\\partial \\Xi(x,t)}{\\partial t}\\bigg|_x $$\n通过考虑 $T(x,t)$ 其中 $x=\\chi(\\Xi,t)$，可以获得更直接的形式。保持 $\\Xi$ 不变时 $T$ 的全时间导数是 $\\frac{\\partial \\Theta}{\\partial t}\\big|_\\Xi$。保持 $x$ 不变时 $T$ 的全时间导数是 $\\frac{\\partial T}{\\partial t}\\big|_x$。从关系 $x=\\chi(\\Xi,t)$，我们有 $dx = \\frac{\\partial \\chi}{\\partial \\Xi}d\\Xi + \\frac{\\partial \\chi}{\\partial t}dt$。保持 $x$ 不变（$dx=0$），我们得到 $\\frac{d\\Xi}{dt}\\big|_x = -(\\frac{\\partial \\chi}{\\partial t})/(\\frac{\\partial \\chi}{\\partial \\Xi}) = -w/J$。\n链式法则给出：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + \\frac{\\partial \\Theta}{\\partial \\Xi} \\frac{d\\Xi}{dt}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - \\frac{w}{J}\\frac{\\partial \\Theta}{\\partial \\Xi} $$\n注意到 $\\frac{\\partial T}{\\partial x} = \\frac{1}{J}\\frac{\\partial \\Theta}{\\partial \\Xi}$，我们可以将其写为：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - w \\frac{\\partial T}{\\partial x} $$\n将此代入欧拉方程，得到物理框架中的ALE方程：\n$$ \\left(\\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - w \\frac{\\partial T}{\\partial x}\\right) + U_0 \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}} $$\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + (U_0 - w) \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}} $$\n现在，我们使用 $\\frac{\\partial}{\\partial x} = \\frac{1}{J}\\frac{\\partial}{\\partial \\Xi}$ 将空间导数转换到参考框架：\n$$ \\frac{\\partial T}{\\partial x} = \\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} $$\n$$ \\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\frac{1}{J}\\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) $$\n将这些代入物理框架ALE方程，并识别 $S_{\\mathrm{ALE}}(\\Xi,t) = S_{\\text{phys}}(\\chi(\\Xi,t),t)$，得到参考坐标系下的强形式ALE平流-扩散方程：\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + (U_0 - w) \\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\alpha \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) + S_{\\mathrm{ALE}}(\\Xi,t) $$\n由于 $\\alpha$ 是常数，这也可以写成：\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) + S_{\\mathrm{ALE}}(\\Xi,t) $$\n这就是我们必须满足的方程。\n\n### 第2部分：源项 $S_{\\mathrm{ALE}}(\\Xi,t)$ 的计算\n我们重排推导出的方程以求解源项：\n$$ S_{\\mathrm{ALE}}(\\Xi,t) = \\frac{\\partial \\Theta}{\\partial t} + \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} - \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) $$\n我们现在使用给定的映射和人工解来计算每一项。\n\n1.  **几何与运动学项**：\n    -   映射：$x = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\sin(\\omega t)$\n    -   雅可比行列式：$J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi} = 1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)$\n    -   网格速度：$w(\\Xi,t) = \\frac{\\partial \\chi}{\\partial t} = \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)$\n    -   雅可比行列式的导数：$\\frac{\\partial J}{\\partial \\Xi} = -\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)$\n\n2.  **温度场导数**：\n    -   温度：$\\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   时间导数：$\\frac{\\partial \\Theta}{\\partial t} = -\\lambda \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   一阶空间导数：$\\frac{\\partial \\Theta}{\\partial \\Xi} = -2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   二阶空间导数：$\\frac{\\partial^2 \\Theta}{\\partial \\Xi^2} = -4\\pi^2 \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n\n3.  **组装 $S_{\\mathrm{ALE}}$ 的各项**：\n\n    -   **瞬态项**：\n        $$ \\frac{\\partial \\Theta}{\\partial t} = -\\lambda \\cos(2\\pi \\Xi)\\exp(-\\lambda t) $$\n\n    -   **平流项**：\n        $$ \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\frac{U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} \\left( -2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t) \\right) $$\n\n    -   **扩散项**：\n        扩散项是 $-\\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right)$。我们先计算内部部分：\n        $$ \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\left[ \\frac{\\partial (1/J)}{\\partial \\Xi}\\frac{\\partial \\Theta}{\\partial \\Xi} + \\frac{1}{J}\\frac{\\partial^2 \\Theta}{\\partial \\Xi^2} \\right] $$\n        $$ \\frac{\\partial (1/J)}{\\partial \\Xi} = -\\frac{1}{J^2}\\frac{\\partial J}{\\partial \\Xi} = -\\frac{1}{J^2}(-\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)) = \\frac{\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)}{J^2} $$\n        代入导数：\n        $$ \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\left[ \\left(\\frac{\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)}{J^2}\\right)(-2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t)) + \\frac{1}{J}(-4\\pi^2 \\cos(2\\pi \\Xi)\\exp(-\\lambda t)) \\right] $$\n        $$ = \\alpha \\pi^2 \\exp(-\\lambda t) \\left[ -\\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^2} - \\frac{4\\cos(2\\pi \\Xi)}{J} \\right] $$\n        因此，对 $S_{\\mathrm{ALE}}$ 的完整扩散项贡献为：\n        $$ -\\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = -\\frac{\\alpha \\pi^2 \\exp(-\\lambda t)}{J} \\left[ -\\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^2} - \\frac{4\\cos(2\\pi \\Xi)}{J} \\right] $$\n        $$ = \\alpha \\pi^2 \\exp(-\\lambda t) \\left[ \\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^3} + \\frac{4\\cos(2\\pi \\Xi)}{J^2} \\right] $$\n\n4.  **$S_{\\mathrm{ALE}}(\\Xi,t)$ 的最终表达式**：\n    合并所有项并提出因子 $\\exp(-\\lambda t)$：\n    $$ S_{\\mathrm{ALE}}(\\Xi,t) = \\exp(-\\lambda t) \\left[ -\\lambda \\cos(2\\pi \\Xi) - 2\\pi \\sin(2\\pi \\Xi)\\frac{U_0 - w}{J} + \\alpha \\pi^2 \\left( \\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^3} + \\frac{4\\cos(2\\pi \\Xi)}{J^2} \\right) \\right] $$\n    代入 $w$ 和 $J$ 的完整表达式：\n    $$ S_{\\mathrm{ALE}}(\\Xi,t) = \\exp(-\\lambda t) \\Bigg[ -\\lambda \\cos(2\\pi \\Xi) - \\frac{2\\pi \\sin(2\\pi \\Xi) \\left(U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)\\right)}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} + \\frac{4\\alpha\\pi^2 \\cos(2\\pi \\Xi)}{\\left(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)\\right)^2} + \\frac{2\\alpha \\varepsilon \\pi^3 \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{\\left(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)\\right)^3} \\Bigg] $$\n    这是源项的最终闭式解析表达式。",
            "answer": "$$ \\boxed{\\exp(-\\lambda t) \\left[ -\\lambda \\cos(2\\pi \\Xi) - \\frac{2\\pi \\sin(2\\pi \\Xi) (U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t))}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} + \\frac{4\\alpha\\pi^2 \\cos(2\\pi \\Xi)}{(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t))^2} + \\frac{2\\alpha \\varepsilon \\pi^3 \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t))^3} \\right]} $$"
        },
        {
            "introduction": "任何有效的 ALE 方案的一个基本要求是必须满足几何守恒律 (Geometric Conservation Law, GCL)。GCL 确保网格运动本身不会人为地产生质量、动量或能量。离散 GCL 指出，在一个时间步内，单元体积的变化必须精确等于该步内通过单元表面的网格速度的净通量。这个编码练习  提供了一种验证离散 GCL 的实用方法。通过将数值演化的单元体积与解析解进行比较，您可以确认时间积分方案的正确性，并理解为什么某些选择（如中点法则）对确保精度至关重要。",
            "id": "3937083",
            "problem": "考虑一个在任意拉格朗日-欧拉 (ALE) 框架下的一维移动网格公式，用于计算热工学，其中网格遵循预设的边界运动。设固定的参考域为区间 $[0,L_0]$，其中 $L_0$ 的单位是米。时刻 $t$ 的物理域通过一个时间相关的映射 $x(X,t)$ 从参考坐标 $X \\in [0,L_0]$ 映射到物理坐标 $x$ 得到。几何守恒律 (GCL) 指出，一个控制体的体积变化率等于网格速度通过其边界的通量。该陈述的基本依据是针对移动控制体的 Reynolds 输运定理：对于被积函数等于 $1$ 的特殊情况，该定理即推导出几何守恒律\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{\\Omega(t)} 1\\,\\mathrm{d}\\Omega = \\int_{\\partial\\Omega(t)} \\mathbf{v}_m \\cdot \\mathbf{n}\\,\\mathrm{d}A,\n$$\n其中 $\\Omega(t)$ 是随时间变化的域，$\\partial\\Omega(t)$ 是其边界，$\\mathbf{v}_m$ 是网格速度，$\\mathbf{n}$ 是边界上的单位外法线向量。在一维空间中，对于一个由位置 $x_{i}$ 和 $x_{i+1}$ 的面界定的单元 $i$，这简化为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\Delta x_i(t) = v_m(x_{i+1},t) - v_m(x_{i},t),\n$$\n其中 $\\Delta x_i(t) = x_{i+1}(t) - x_i(t)$ 是单元 $i$ 的物理长度，$v_m$ 是在单元面上计算的网格速度。\n\n你的任务是通过比较通过离散GCL更新计算出的数值更新单元长度与由映射 $x(X,t)$ 导出的解析计算单元长度，来验证离散几何守恒律（离散GCL）。验证必须针对一个预设的边界运动和内部网格运动进行，其定义如下\n$$\nx(X,t) = \\lambda(t)\\,X + \\mu(t)\\,L_0\\,\\phi(X),\n$$\n其中\n$$\n\\lambda(t) = 1 + \\alpha \\sin\\left(2\\pi f t\\right),\\quad \\mu(t) = \\delta \\cos\\left(2\\pi f t\\right),\\quad \\phi(X) = \\frac{X}{L_0}\\left(1 - \\frac{X}{L_0}\\right).\n$$\n此处，$\\alpha$ 和 $\\delta$ 是无量纲振幅，$f$ 是频率，单位为赫兹（秒的倒数），$t$ 是时间，单位为秒。该映射使左边界保持在 $x(0,t)=0$，并将右边界移动到 $x(L_0,t)=\\lambda(t)\\,L_0$，提供了一个物理上真实的边界运动，并带有一个由 $\\mu(t)$ 控制的可选内部凸起。\n\n网格速度定义为\n$$\nv_m(X,t) = \\frac{\\partial x}{\\partial t}(X,t) = \\dot{\\lambda}(t)\\,X + \\dot{\\mu}(t)\\,L_0\\,\\phi(X),\n$$\n其中\n$$\n\\dot{\\lambda}(t) = \\alpha\\,(2\\pi f)\\,\\cos\\left(2\\pi f t\\right),\\quad \\dot{\\mu}(t) = -\\delta\\,(2\\pi f)\\,\\sin\\left(2\\pi f t\\right).\n$$\n\n将参考区间 $[0,L_0]$ 离散化为 $N$ 个均匀间隔的单元，节点位于 $X_j = j\\,\\Delta X$，其中 $j=0,1,\\dots,N$ 且 $\\Delta X = L_0/N$。设解析物理位置为 $x_j^{\\text{exact}}(t) = x(X_j,t)$，解析单元长度为 $\\Delta x_i^{\\text{exact}}(t) = x_{i+1}^{\\text{exact}}(t) - x_i^{\\text{exact}}(t)$，其中 $i=0,1,\\dots,N-1$。\n\n从时间 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的一个时间步长 $\\Delta t$ 内，单元长度的离散GCL更新公式为\n$$\n\\frac{\\Delta x_i^{n+1} - \\Delta x_i^{n}}{\\Delta t} = v_m\\big(X_{i+1}, t^{\\ast}\\big) - v_m\\big(X_{i}, t^{\\ast}\\big),\n$$\n其中 $t^{\\ast}$ 是评估网格速度的时刻。为了使离散GCL在时间上达到二阶精度，使用中点时刻 $t^{\\ast} = t^{n} + \\Delta t/2$；为作比较，也考虑一阶显式欧拉选择 $t^{\\ast} = t^{n}$。\n\n从 $t^0=0$ 时的解析初始单元长度开始，使用离散GCL公式在一系列时间步长上推进离散单元长度，直到时间 $T$，并在每一步将离散单元长度与从 $x(X,t)$ 直接计算出的新时刻的解析单元长度进行比较。将一次运行的验证误差定义为所有单元和所有时间步长上的最大绝对偏差，\n$$\nE_{\\max} = \\max_{0\\le n \\le N_t-1}\\max_{0\\le i \\le N-1}\\left|\\Delta x_i^{n+1} - \\Delta x_i^{\\text{exact}}(t^{n+1})\\right|,\n$$\n其中 $N_t$ 是时间步数。\n\n实现一个程序，对于下面的每个测试用例，计算以米为单位的 $E_{\\max}$，并将这些误差作为浮点数输出。使用以下测试套件以确保覆盖不同方面，包括一般情况、内部凸起、高振幅边界运动、零运动以及一个故意使用不满足离散GCL的时间积分器的案例：\n\n- 测试用例1（一般均匀拉伸）：$N=10$， $L_0=1.0$ m， $\\alpha=0.1$， $\\delta=0.0$， $f=1.0$ Hz， $T=3.0$ s， $\\Delta t=0.005$ s，中点时刻。\n- 测试用例2（非均匀内部凸起）：$N=50$， $L_0=2.0$ m， $\\alpha=0.05$， $\\delta=0.05$， $f=2.0$ Hz， $T=1.5$ s， $\\Delta t=0.0025$ s，中点时刻。\n- 测试用例3（高振幅边界运动）：$N=20$， $L_0=1.0$ m， $\\alpha=0.9$， $\\delta=0.0$， $f=0.5$ Hz， $T=2.0$ s， $\\Delta t=0.01$ s，中点时刻。\n- 测试用例4（零运动边缘情况）：$N=7$， $L_0=1.5$ m， $\\alpha=0.0$， $\\delta=0.0$， $f=1.0$ Hz， $T=1.0$ s， $\\Delta t=0.02$ s，中点时刻。\n- 测试用例5（为对比而故意违反离散GCL）：$N=30$， $L_0=1.0$ m， $\\alpha=0.2$， $\\delta=0.1$， $f=3.0$ Hz， $T=\\frac{1}{3}$ s， $\\Delta t=\\frac{1}{120}$ s，显式欧拉时刻。\n\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4,result5]\"）。每个结果必须是对应测试用例以米为单位的 $E_{\\max}$ 的浮点数值。报告原始数值浮点数，不带任何单位符号；计算中的所有量必须统一使用米作为长度单位，秒作为时间单位，赫兹作为频率单位。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它具有科学依据，问题定义明确且客观。它提出了计算科学领域中的一个标准数值验证练习，特别涉及任意拉格朗日-欧拉 (ALE) 方法。所提供的网格映射、网格速度和离散几何守恒律 (GCL) 的方程是一致且正确的。测试用例的参数是完整且物理上合理的，并且映射函数在所有指定条件下都是非退化的。因此，将提供一个合理的解决方案。\n\n目标是验证一维移动网格的离散几何守恒律 (GCL) 的实现。GCL 是 ALE 公式中的一个基本要求，它确保离散化能正确地解释因网格运动引起的单元体积变化，从而防止引入人为的质量、动量或能量。该问题要求比较使用离散GCL数值演化的单元长度与从预设映射函数 $x(X,t)$ 解析计算的单元长度。在整个模拟过程中，这两个量之间的最大差异作为验证误差 $E_{\\max}$。\n\n一维连续GCL由下式给出：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\Delta x_i(t) = v_m(x_{i+1},t) - v_m(x_{i},t)\n$$\n其中 $\\Delta x_i(t)$ 是时刻 $t$ 单元 $i$ 的长度，$v_m$ 是位于物理位置 $x_i$ 和 $x_{i+1}$ 的单元面上的网格速度。\n\n网格运动由从固定参考坐标 $X$ 到时刻 $t$ 的物理坐标 $x$ 的映射 $x(X,t)$ 定义：\n$$\nx(X,t) = \\lambda(t)\\,X + \\mu(t)\\,L_0\\,\\phi(X)\n$$\n其分量为：\n$$\n\\lambda(t) = 1 + \\alpha \\sin\\left(2\\pi f t\\right) \\\\\n\\mu(t) = \\delta \\cos\\left(2\\pi f t\\right) \\\\\n\\phi(X) = \\frac{X}{L_0}\\left(1 - \\frac{X}{L_0}\\right)\n$$\n网格速度是固定参考坐标 $X$ 处的位置对时间的导数：\n$$\nv_m(X,t) = \\frac{\\partial x}{\\partial t}(X,t) = \\dot{\\lambda}(t)\\,X + \\dot{\\mu}(t)\\,L_0\\,\\phi(X)\n$$\n其时间导数为：\n$$\n\\dot{\\lambda}(t) = \\alpha\\,(2\\pi f)\\,\\cos\\left(2\\pi f t\\right) \\\\\n\\dot{\\mu}(t) = -\\delta\\,(2\\pi f)\\,\\sin\\left(2\\pi f t\\right)\n$$\n\n该过程涉及一个时步模拟。参考域 $[0, L_0]$ 被离散化为 $N$ 个单元，节点位于 $X_j = j \\Delta X$，其中 $j=0, \\dots, N$ 且 $\\Delta X = L_0/N$。\n\n1.  **初始化**：在时刻 $t^0=0$，使用解析单元长度初始化模拟。物理域中节点的位置计算为 $x_j^{\\text{exact}}(0) = x(X_j, 0)$，初始单元长度为 $\\Delta x_i^0 = x_{i+1}^{\\text{exact}}(0) - x_{i}^{\\text{exact}}(0)$，其中 $i = 0, \\dots, N-1$。误差变量 $E_{\\max}$ 初始化为 $0$。\n\n2.  **时间推进**：模拟从 $t=0$ 到 $t=T$ 以 $\\Delta t$ 的步长进行。对于从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的每个时间步：\n    a.  **速度评估**：在所有参考节点 $X_j$ 处计算网格速度 $v_m(X_j, t^{\\ast})$。评估时间 $t^{\\ast}$ 至关重要。为了使GCL满足二阶时间精度，使用时间中点评估 $t^{\\ast} = t^{n} + \\Delta t/2$。为了进行比较，也考虑一阶显式欧拉评估 $t^{\\ast} = t^{n}$。\n    \n    b.  **数值更新**：使用离散GCL公式更新单元长度，该公式是连续GCL的时间离散化：\n    $$\n    \\Delta x_i^{n+1} = \\Delta x_i^{n} + \\Delta t \\left( v_m(X_{i+1}, t^{\\ast}) - v_m(X_i, t^{\\ast}) \\right)\n    $$\n    此公式应用于所有单元 $i=0, \\dots, N-1$。\n\n    c.  **解析解**：时刻 $t^{n+1}$ 的“真实”或解析单元长度直接从映射计算：\n    $$\n    x_j^{\\text{exact}}(t^{n+1}) = x(X_j, t^{n+1}) \\\\\n    \\Delta x_i^{\\text{exact}}(t^{n+1}) = x_{i+1}^{\\text{exact}}(t^{n+1}) - x_i^{\\text{exact}}(t^{n+1})\n    $$\n\n    d.  **误差计算**：计算当前时间步每个单元的绝对误差：$|\\Delta x_i^{n+1} - \\Delta x_i^{\\text{exact}}(t^{n+1})|$。找出所有单元中这些误差的最大值，如果该最大值大于当前的 $E_{\\max}$，则更新 $E_{\\max}$。\n    \n    e.  **状态更新**：新计算出的数值单元长度 $\\Delta x_i^{n+1}$ 成为下一个时间步的当前长度 $\\Delta x_i^{n}$。\n\n3.  **结果**：在最后一个时间步之后，$E_{\\max}$ 保存了在整个模拟过程中观察到的最大偏差，它作为给定测试用例的最终验证指标。\n\n对五个测试用例中的每一个重复此过程。预期对于使用二阶中点法则的用例1-3，误差 $E_{\\max}$ 将非常小，接近机器精度，从而证实GCL得到了很好的满足。这种情况下的误差是中点求积法则的时间离散误差，该法则是二阶的，即 $O(\\Delta t^2)$。对于用例4，没有网格运动（$\\alpha=0, \\delta=0$），网格速度恒为零，误差应精确为零。对于用例5，它故意使用一阶显式欧拉方案，预计会出现一个显著更大的、一阶的误差（$O(\\Delta t)$）。这表明时间积分器的选择对于满足离san GCL至关重要。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the discrete Geometric Conservation Law (GCL) verification problem.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L0, alpha, delta, f, T, dt, method)\n        (10, 1.0, 0.1, 0.0, 1.0, 3.0, 0.005, 'midpoint'),\n        (50, 2.0, 0.05, 0.05, 2.0, 1.5, 0.0025, 'midpoint'),\n        (20, 1.0, 0.9, 0.0, 0.5, 2.0, 0.01, 'midpoint'),\n        (7, 1.5, 0.0, 0.0, 1.0, 1.0, 0.02, 'midpoint'),\n        (30, 1.0, 0.2, 0.1, 3.0, 1.0/3.0, 1.0/120.0, 'euler'),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, L0, alpha, delta, f, T, dt, method = case\n        \n        # Helper functions for the mapping and its derivatives\n        pi_2f = 2.0 * np.pi * f\n\n        def lambda_func(t):\n            return 1.0 + alpha * np.sin(pi_2f * t)\n\n        def mu_func(t):\n            return delta * np.cos(pi_2f * t)\n\n        def phi_func(X):\n            # Ensure X is a numpy array for vectorization\n            X_norm = X / L0\n            return X_norm * (1.0 - X_norm)\n\n        def x_map(X, t):\n            # X can be a scalar or a numpy array\n            return lambda_func(t) * X + mu_func(t) * L0 * phi_func(X)\n\n        def lambda_dot_func(t):\n            return alpha * pi_2f * np.cos(pi_2f * t)\n\n        def mu_dot_func(t):\n            return -delta * pi_2f * np.sin(pi_2f * t)\n\n        def v_m_func(X, t):\n            # X can be a scalar or a numpy array\n            return lambda_dot_func(t) * X + mu_dot_func(t) * L0 * phi_func(X)\n\n        # Set up the simulation\n        # Reference mesh nodes\n        X_nodes = np.linspace(0.0, L0, N + 1)\n        \n        # Time steps\n        # Use round() to avoid floating point issues with T/dt\n        num_steps = int(round(T / dt))\n        times = np.linspace(0.0, T, num_steps + 1)\n\n        # Initial conditions at t=0\n        x_nodes_initial = x_map(X_nodes, 0.0)\n        delta_x_n = np.diff(x_nodes_initial) # delta_x_n are numerical cell lengths\n\n        max_error = 0.0\n\n        # Time-stepping loop\n        for n in range(num_steps):\n            t_n = times[n]\n            t_n_plus_1 = times[n+1]\n            \n            # Determine time for velocity evaluation\n            if method == 'midpoint':\n                t_star = t_n + dt / 2.0\n            elif method == 'euler':\n                t_star = t_n\n            else:\n                raise ValueError(\"Unknown method: \" + method)\n\n            # Compute mesh velocities at nodes\n            v_m_nodes = v_m_func(X_nodes, t_star)\n            \n            # Update cell lengths using discrete GCL\n            # delta_x_n+1 = delta_x_n + dt * (v_m(i+1) - v_m(i))\n            delta_x_n_plus_1 = delta_x_n + dt * np.diff(v_m_nodes)\n            \n            # Compute analytical cell lengths for comparison\n            x_nodes_exact = x_map(X_nodes, t_n_plus_1)\n            delta_x_exact = np.diff(x_nodes_exact)\n            \n            # Calculate error for this time step\n            current_max_error = np.max(np.abs(delta_x_n_plus_1 - delta_x_exact))\n            \n            # Update overall maximum error\n            if current_max_error > max_error:\n                max_error = current_max_error\n                \n            # Update cell lengths for the next iteration\n            delta_x_n = delta_x_n_plus_1\n        \n        results.append(max_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}