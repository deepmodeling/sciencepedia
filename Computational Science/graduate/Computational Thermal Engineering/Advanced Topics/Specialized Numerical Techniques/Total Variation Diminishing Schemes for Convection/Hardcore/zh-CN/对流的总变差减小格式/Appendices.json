{
    "hands_on_practices": [
        {
            "introduction": "理解总变差递减（TVD）格式的第一步，是亲眼见证为什么需要它们。这个练习将直接揭示非TVD格式的根本缺陷。通过在一个急剧变化的界面上比较基本的一阶迎风格式和二阶Lax-Wendroff格式，我们可以量化地看到高阶方法如何引入非物理振荡，而这些振荡正表现为总变差的增加。",
            "id": "3998778",
            "problem": "考虑一个由线性平流方程 $T_{t} + a\\,T_{x} = 0$（其中速度 $a > 0$ 为常数）控制的被动温度场的一维无粘性热对流。使用间距为 $\\Delta x$ 的均匀网格和时间步长 $\\Delta t$ 将时间层 $n$ 的单元平均值 $\\{T_{i}^{n}\\}$推进到时间层 $n+1$。定义库朗-弗里德里希-路维（CFL）数为 $\\nu = a\\,\\Delta t / \\Delta x$。设初始数据为一个与网格对齐的阶跃（亥维赛）条件：在一个足够大的域上（使得边界条件不影响第一次更新），当 $i \\le 0$ 时，$T_{i}^{0} = 1$；当 $i \\ge 1$ 时，$T_{i}^{0} = 0$。\n\n从控制方程和标准的有限体积相容性要求出发，推导两种离散化方法在间断附近的单步更新：正 $a$ 值的一阶迎风格式，以及二阶Lax–Wendroff格式。使用这些更新，显式计算当模板索引 $i \\in \\{-1, 0, 1, 2\\}$ 时 $T_{i}^{1}$ 的值。\n\n定义离散总变差为 $\\mathrm{TV}(T^{n}) = \\sum_{i \\in \\mathbb{Z}} |T_{i+1}^{n} - T_{i}^{n}|$。计算每种格式的 $\\mathrm{TV}(T^{0})$ 和 $\\mathrm{TV}(T^{1})$，并以 $\\nu$ 的闭式解析表达式报告迎风格式和Lax–Wendroff格式的总变差变化量 $\\Delta \\mathrm{TV} = \\mathrm{TV}(T^{1}) - \\mathrm{TV}(T^{0})$，假设 $0  \\nu  1$。将最终答案表示为包含两个 $\\Delta \\mathrm{TV}$ 值的行矩阵。无需四舍五入。最终量是无量纲的，报告时无需单位。",
            "solution": "该问题要求分析两种有限体积格式（一阶迎风格式和二阶Lax-Wendroff格式）对于一维线性平流方程 $T_{t} + a\\,T_{x} = 0$（其中 $a > 0$）的应用。我们必须计算在给定初始条件下，一个时间步长后的总变差变化量 $\\Delta \\mathrm{TV}$。\n\n首先，我们建立通用的有限体积框架。将控制方程在一个宽度为 $\\Delta x$ 的控制体（单元） $C_i = [x_{i-1/2}, x_{i+1/2}]$ 和一个时长为 $\\Delta t$ 的时间区间 $[t^n, t^{n+1}]$ 上积分。\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\int_{t^n}^{t^{n+1}} (T_t + a\\,T_x) \\,dt\\,dx = 0 $$\n使用单元平均值的定义 $T_i^n = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} T(x, t^n) \\,dx$，以及近似时间平均物理通量 $a\\,T$ 的单元界面数值通量 $F_{i \\pm 1/2}$，该方程被离散化为：\n$$ T_i^{n+1} = T_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\n物理通量为 $f(T) = aT$。库朗-弗里德里希-路维（CFL）数为 $\\nu = a\\,\\Delta t/\\Delta x$。更新公式可以写为：\n$$ T_i^{n+1} = T_i^n - \\frac{\\nu}{a} (F_{i+1/2} - F_{i-1/2}) $$\n\n初始条件是与网格对齐的亥维赛阶跃函数：当 $i \\le 0$ 时，$T_{i}^{0} = 1$；当 $i \\ge 1$ 时，$T_{i}^{0} = 0$。时间层 $n$ 的离散总变差定义为 $\\mathrm{TV}(T^n) = \\sum_{i \\in \\mathbb{Z}} |T_{i+1}^n - T_i^n|$。对于初始条件，求和中唯一的非零项出现在单元 $i=0$ 和单元 $i=1$ 之间的界面上：\n$$ \\mathrm{TV}(T^0) = |T_1^0 - T_0^0| = |0 - 1| = 1 $$\n\n现在我们分析每种格式在 $0  \\nu  1$ 的情况。\n\n**1. 一阶迎风格式**\n\n对于 $a > 0$，迎风格式使用来自上游单元（左侧单元，$i$）的值来定义界面 $x_{i+1/2}$ 处的通量。数值通量为 $F_{i+1/2} = a T_i^n$。\n将其代入通用有限体积公式：\n$$ T_i^{n+1} = T_i^n - \\frac{\\Delta t}{\\Delta x} (a T_i^n - a T_{i-1}^n) = T_i^n - \\nu (T_i^n - T_{i-1}^n) $$\n我们将此更新规则应用于初始条件 $T^0$ 以求得 $T^1$。我们关心的是模板 $i \\in \\{-1, 0, 1, 2\\}$。\n对于任何 $i \\le 0$，有 $T_i^0=1$ 和 $T_{i-1}^0=1$。因此，$T_i^1 = 1 - \\nu(1-1) = 1$。特别是，$T_{-1}^1=1$ 和 $T_0^1=1$。\n对于 $i = 1$，有 $T_1^0=0$ 和 $T_0^0=1$。因此，$T_1^1 = 0 - \\nu(0-1) = \\nu$。\n对于 $i = 2$，有 $T_2^0=0$ 和 $T_1^0=0$。因此，$T_2^1 = 0 - \\nu(0-0) = 0$。\n对于任何 $i \\ge 2$，有 $T_i^0=0$ 和 $T_{i-1}^0=0$，这得到 $T_i^1=0$。\n\n更新后的状态为：当 $i \\le 0$ 时，$T_i^1 = 1$；$T_1^1 = \\nu$；当 $i \\ge 2$ 时，$T_i^1 = 0$。\n现在，我们计算这个新状态的总变差 $\\mathrm{TV}(T^1)$：\n$$ \\mathrm{TV}(T^1)_{\\text{upwind}} = \\sum_{i \\in \\mathbb{Z}} |T_{i+1}^1 - T_i^1| $$\n求和中的非零项出现在 $i=0$ 和 $i=1$ 处：\n$$ \\mathrm{TV}(T^1)_{\\text{upwind}} = |T_1^1 - T_0^1| + |T_2^1 - T_1^1| = |\\nu - 1| + |0 - \\nu| $$\n由于 $0  \\nu  1$，我们有 $|\\nu - 1| = 1 - \\nu$ 和 $|-\\nu| = \\nu$。\n$$ \\mathrm{TV}(T^1)_{\\text{upwind}} = (1 - \\nu) + \\nu = 1 $$\n总变差的变化量为：\n$$ \\Delta \\mathrm{TV}_{\\text{upwind}} = \\mathrm{TV}(T^1)_{\\text{upwind}} - \\mathrm{TV}(T^0) = 1 - 1 = 0 $$\n\n**2. 二阶Lax-Wendroff格式**\n\nLax-Wendroff格式可以从时间上的二阶泰勒级数展开推导出来，得到更新公式：\n$$ T_i^{n+1} = T_i^n - \\frac{\\nu}{2}(T_{i+1}^n - T_{i-1}^n) + \\frac{\\nu^2}{2}(T_{i+1}^n - 2T_i^n + T_{i-1}^n) $$\n我们将此规则应用于初始条件 $T^0$ 以求得模板 $i \\in \\{-1, 0, 1, 2\\}$ 的 $T^1$。\n对于任何 $i \\le -1$，有 $T_{i-1}^0 = T_i^0 = T_{i+1}^0 = 1$。更新给出 $T_i^1 = 1 - \\frac{\\nu}{2}(1-1) + \\frac{\\nu^2}{2}(1-2(1)+1) = 1$。因此，$T_{-1}^1=1$。\n对于 $i=0$，我们有 $T_{-1}^0=1, T_{0}^0=1, T_{1}^0=0$。\n$$ T_0^1 = T_0^0 - \\frac{\\nu}{2}(T_1^0 - T_{-1}^0) + \\frac{\\nu^2}{2}(T_1^0 - 2T_0^0 + T_{-1}^0) = 1 - \\frac{\\nu}{2}(0-1) + \\frac{\\nu^2}{2}(0 - 2(1) + 1) = 1 + \\frac{\\nu}{2} - \\frac{\\nu^2}{2} $$\n对于 $i=1$，我们有 $T_{0}^0=1, T_{1}^0=0, T_{2}^0=0$。\n$$ T_1^1 = T_1^0 - \\frac{\\nu}{2}(T_2^0 - T_0^0) + \\frac{\\nu^2}{2}(T_2^0 - 2T_1^0 + T_0^0) = 0 - \\frac{\\nu}{2}(0-1) + \\frac{\\nu^2}{2}(0 - 2(0) + 1) = \\frac{\\nu}{2} + \\frac{\\nu^2}{2} $$\n对于任何 $i \\ge 2$，我们有 $T_{i-1}^0 = T_i^0 = T_{i+1}^0 = 0$。更新给出 $T_i^1 = 0 - \\frac{\\nu}{2}(0-0) + \\frac{\\nu^2}{2}(0-2(0)+0) = 0$。因此，$T_2^1=0$。\n\n间断附近的更新状态为 $T_{-1}^1=1, T_0^1=1+\\frac{\\nu}{2}-\\frac{\\nu^2}{2}, T_1^1=\\frac{\\nu}{2}+\\frac{\\nu^2}{2}, T_2^1=0$。\n我们计算总变差 $\\mathrm{TV}(T^1)_{\\text{LW}}$。求和中的非零项出现在 $i=-1, 0, 1$ 处：\n$$ \\mathrm{TV}(T^1)_{\\text{LW}} = |T_0^1 - T_{-1}^1| + |T_1^1 - T_0^1| + |T_2^1 - T_1^1| $$\n每一项计算如下：\n$$ |T_0^1 - T_{-1}^1| = \\left|\\left(1+\\frac{\\nu}{2}-\\frac{\\nu^2}{2}\\right) - 1\\right| = \\left|\\frac{\\nu-\\nu^2}{2}\\right| = \\left|\\frac{\\nu(1-\\nu)}{2}\\right| = \\frac{\\nu(1-\\nu)}{2} \\quad (\\text{因为 } 0\\nu1) $$\n$$ |T_1^1 - T_0^1| = \\left|\\left(\\frac{\\nu}{2}+\\frac{\\nu^2}{2}\\right) - \\left(1+\\frac{\\nu}{2}-\\frac{\\nu^2}{2}\\right)\\right| = |\\nu^2-1| = 1-\\nu^2 \\quad (\\text{因为 } 0\\nu1) $$\n$$ |T_2^1 - T_1^1| = \\left|0 - \\left(\\frac{\\nu}{2}+\\frac{\\nu^2}{2}\\right)\\right| = \\left|\\frac{\\nu(1+\\nu)}{2}\\right| = \\frac{\\nu(1+\\nu)}{2} \\quad (\\text{因为 } 0\\nu1) $$\n将这些项相加得到总变差：\n$$ \\mathrm{TV}(T^1)_{\\text{LW}} = \\frac{\\nu(1-\\nu)}{2} + (1-\\nu^2) + \\frac{\\nu(1+\\nu)}{2} = \\frac{\\nu-\\nu^2}{2} + 1-\\nu^2 + \\frac{\\nu+\\nu^2}{2} $$\n$$ \\mathrm{TV}(T^1)_{\\text{LW}} = \\frac{\\nu-\\nu^2+\\nu+\\nu^2}{2} + 1-\\nu^2 = \\frac{2\\nu}{2} + 1-\\nu^2 = 1+\\nu-\\nu^2 $$\n总变差的变化量为：\n$$ \\Delta \\mathrm{TV}_{\\text{LW}} = \\mathrm{TV}(T^1)_{\\text{LW}} - \\mathrm{TV}(T^0) = (1+\\nu-\\nu^2) - 1 = \\nu - \\nu^2 $$\n结果 $\\nu - \\nu^2 = \\nu(1-\\nu) > 0$（对于 $0\\nu1$）表明 Lax-Wendroff 格式不是总变差减小（TVD）的，并且通过在间断附近引入振荡来增加总变差。\n\n最终答案由迎风格式和Lax-Wendroff格式的两个 $\\Delta \\mathrm{TV}$ 值组成。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\nu - \\nu^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "既然我们已经看到了振荡问题，那么如何在不完全牺牲精度的情况下解决它呢？本练习将介绍斜率限制器（slope limiter）这一现代TVD格式的核心技术。通过计算`minmod`限制器的具体作用，你将理解这些函数如何“智能地”在剧烈梯度附近调整格式以抑制振荡，同时在平滑区域保持高精度。",
            "id": "3998743",
            "problem": "考虑在具有恒定轴向速度的均匀管道中的一维纯温度对流，其模型为守恒律 $\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = 0$，其中 $a>0$。一种二阶守恒律单调上游中心格式（MUSCL）有限体积离散化方法，使用斜率限制的线性剖面来重构界面值，以强制满足总变差递减（TVD）特性。对于间距为 $\\Delta x$ 的均匀网格，定义单元 $i$ 中的上游（左侧）离散梯度为 $s_i^{\\text{un}} = \\frac{T_i - T_{i-1}}{\\Delta x}$，以及连续梯度的比率（对于 $a>0$）为 $r_i = \\frac{T_i - T_{i-1}}{T_{i+1} - T_i}$。受限斜率由 $s_i^{\\text{lim}} = \\phi_{\\text{mm}}(r_i)\\, s_i^{\\text{un}}$ 建模，其中 minmod 通量限制器函数定义为 $\\phi_{\\text{mm}}(r) = \\max\\big(0, \\min(1, r)\\big)$。\n\n从对流方程和重构必须是 TVD 的要求出发，解释为何形式为 $s_i^{\\text{lim}} = \\phi(r_i)\\, s_i^{\\text{un}}$ 且 $\\phi(r)$ 约束在 $0 \\le \\phi(r) \\le \\min(2, 2r)$ 内的通量限制斜率对于 $a>0$ 与单调性是一致的，并论证使用 minmod 通量限制器 $\\phi_{\\text{mm}}(r)$ 在抑制伪振荡的同时在光滑区域保持二阶精度的合理性。然后，对于一个特定的单元 $i$，假设无限制的上游斜率为 $s_i^{\\text{un}} = 9.87$ K/m，并且三个假设的局部比率为 $r_i = 0.2$、$r_i = 1$ 和 $r_i = 5$。计算这三种情况下对应的受限斜率 $s_i^{\\text{lim}}$。\n\n最终斜率以开尔文/米表示，并将答案四舍五入到四位有效数字。将最终结果表示为一行三个值，分别对应于 $r_i = 0.2$、$1$ 和 $5$。",
            "solution": "该问题是有效的，因为它提出了计算流体动力学领域中关于总变差递减（TVD）格式的一个标准的、自洽的问题。所有定义和参数在科学上都是合理的且适定的。\n\n分析过程分为两部分：首先，对 TVD 条件和 minmod 限制器进行理论论证；其次，对受限斜率进行数值计算。\n\n**第一部分：理论论证**\n\n控制偏微分方程是温度 $T$ 的一维线性对流方程：\n$$ \\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = 0, \\quad a > 0 $$\n在计算流体动力学中，用于求解此类双曲守恒律的高阶数值格式可能会在陡峭梯度（间断或激波）附近引入非物理振荡。总变差递减（TVD）格式旨在通过确保离散解的总变差不随时间增加来防止这种情况。总变差定义为 $TV(T) = \\sum_i |T_{i+1} - T_i|$。满足 $TV(T^{n+1}) \\le TV(T^n)$ 的格式即为 TVD 格式。此性质保证不会产生新的局部极值，从而抑制伪振荡。\n\n**与单调性的一致性：**\n该领域的一个关键发展是通量限制器的提出。对于二阶守恒律单调上游中心格式（MUSCL），在每个单元 $i$ 内重构一个线性剖面。为了保持单调性，该剖面的斜率 $s_i$ 会受到限制。受限斜率 $s_i^{\\text{lim}}$ 表示为无限制斜率 $s_i^{\\text{un}}$ 和一个限制器函数 $\\phi(r_i)$ 的函数：\n$$ s_i^{\\text{lim}} = \\phi(r_i) s_i^{\\text{un}} $$\n这里，$s_i^{\\text{un}} = \\frac{T_i - T_{i-1}}{\\Delta x}$ 是 $a>0$ 时的无限制上游梯度，$r_i = \\frac{T_i - T_{i-1}}{T_{i+1} - T_i}$ 是单元 $i$ 处上游梯度与下游梯度的比值。\n\nHarten、Sweby 等人的研究表明，对于以此方式构建的 TVD 格式，限制器函数 $\\phi(r)$ 必须位于 $\\phi-r$ 图（“Sweby 图”）上的一个特定区域内。对于一个二阶格式要成为 TVD 格式，限制器函数必须对 $r>0$ 满足以下条件：\n$$ 0 \\le \\phi(r) \\le 2 $$\n$$ 0 \\le \\phi(r) \\le 2r $$\n对于 $r \\le 0$（这种情况出现在局部极值处），限制器必须为 $\\phi(r) = 0$ 以防止极值增长。结合这些条件，可以得到著名的二阶精度格式的 TVD 区域：\n$$ \\phi(r) = 0 \\quad \\text{对于 } r \\le 0 $$\n$$ 0 \\le \\phi(r) \\le \\min(2, 2r) \\quad \\text{对于 } r > 0 $$\n问题陈述中的条件 $0 \\le \\phi(r) \\le \\min(2, 2r)$ 正是针对 $r>0$ 的这一要求。这组约束确保了数值通量计算不会导致总变差增加，从而保持单调性并防止新振荡的形成。约束 $\\phi(r) \\le 2r$ 确保了界面上的重构值不会超过相邻下游单元的平均值，而约束 $\\phi(r) \\le 2$ 是一个相关的界限，要求格式在 Courant-Friedrichs-Lewy (CFL) 条件下是 TVD 的。\n\n**Minmod 限制器的合理性论证：**\n问题中定义的 minmod 限制器为 $\\phi_{\\text{mm}}(r) = \\max(0, \\min(1, r))$。我们通过检查其性质来论证其使用的合理性。\n\n1.  **抑制伪振荡：** 为了抑制振荡，限制器必须产生一个 TVD 格式。我们验证 $\\phi_{\\text{mm}}(r)$ 是否位于上述定义的 TVD 区域内。\n    *   如果 $r \\le 0$：$\\phi_{\\text{mm}}(r) = \\max(0, r) = 0$。这满足 TVD 要求。\n    *   如果 $0  r \\le 1$：$\\phi_{\\text{mm}}(r) = \\max(0, r) = r$。我们对照界限进行检查：对于 $r>0$，$r \\le 2r$ 为真；对于 $r \\le 1$，$r \\le 2$ 为真。该条件得到满足。\n    *   如果 $r > 1$：$\\phi_{\\text{mm}}(r) = \\max(0, 1) = 1$。我们对照界限进行检查：对于 $r>1$，$1 \\le 2r$ 为真（因为 $2r>2$）；并且 $1 \\le 2$ 为真。该条件得到满足。\n    由于 $\\phi_{\\text{mm}}(r)$ 对于所有 $r$ 都完全位于 TVD 区域内，因此任何使用它的格式都保证是 TVD 的，从而会抑制伪振荡。\n\n2.  **保持二阶精度：** 如果限制器函数满足 $\\phi(1) = 1$，则 TVD 格式在解的光滑区域能达到二阶精度。\n    *   在光滑区域，网格值变化平缓，因此连续梯度几乎相等：$T_i - T_{i-1} \\approx T_{i+1} - T_i$。这意味着比率 $r_i \\approx 1$。\n    *   对于 minmod 限制器：$\\phi_{\\text{mm}}(1) = \\max(0, \\min(1, 1)) = 1$。\n    *   由于满足条件 $\\phi(1) = 1$，当 $r_i \\approx 1$ 时，限制器函数给出 $\\phi_{\\text{mm}}(r_i) \\approx 1$。这意味着受限斜率 $s_i^{\\text{lim}} = \\phi_{\\text{mm}}(r_i) s_i^{\\text{un}}$ 变得非常接近无限制斜率 $s_i^{\\text{lim}} \\approx s_i^{\\text{un}}$。格式在这些光滑区域会恢复为二阶精度公式，从而最小化数值误差。在梯度较大或存在间断的区域，其中 $r_i$ 不接近 1，限制器会“激活”以减小斜率（例如，如果 $r_i \\ll 1$，则 $\\phi_{\\text{mm}}(r_i) \\approx r_i$），通过增加局部耗散来防止振荡，代价是将局部精度降至一阶。这种自适应特性是 MUSCL-TVD 方法的主要优点。\n\n**第二部分：数值计算**\n\n我们已知无限制上游斜率为 $s_i^{\\text{un}} = 9.87 \\, \\text{K/m}$。受限斜率使用公式 $s_i^{\\text{lim}} = \\phi_{\\text{mm}}(r_i) s_i^{\\text{un}}$ 计算，其中 $\\phi_{\\text{mm}}(r) = \\max(0, \\min(1, r))$。我们为给定的三个比率 $r_i$ 值计算 $s_i^{\\text{lim}}$。\n\n**情况 1：$r_i = 0.2$**\n限制器值为：\n$$ \\phi_{\\text{mm}}(0.2) = \\max(0, \\min(1, 0.2)) = \\max(0, 0.2) = 0.2 $$\n受限斜率为：\n$$ s_i^{\\text{lim}} = 0.2 \\times s_i^{\\text{un}} = 0.2 \\times 9.87 \\, \\text{K/m} = 1.974 \\, \\text{K/m} $$\n四舍五入到四位有效数字，值为 $1.974$。\n\n**情况 2：$r_i = 1$**\n这种情况对应于梯度恒定的区域。限制器值为：\n$$ \\phi_{\\text{mm}}(1) = \\max(0, \\min(1, 1)) = \\max(0, 1) = 1 $$\n受限斜率为：\n$$ s_i^{\\text{lim}} = 1 \\times s_i^{\\text{un}} = 1 \\times 9.87 \\, \\text{K/m} = 9.87 \\, \\text{K/m} $$\n四舍五入到四位有效数字，值为 $9.870$。这证实了在 $r_i=1$ 时，格式不限制斜率，从而保持了精度。\n\n**情况 3：$r_i = 5$**\n这种情况对应于上游梯度远大于下游梯度的区域（例如，从左侧接近一个峰值）。限制器值为：\n$$ \\phi_{\\text{mm}}(5) = \\max(0, \\min(1, 5)) = \\max(0, 1) = 1 $$\n受限斜率为：\n$$ s_i^{\\text{lim}} = 1 \\times s_i^{\\text{un}} = 1 \\times 9.87 \\, \\text{K/m} = 9.87 \\, \\text{K/m} $$\n四舍五入到四位有效数字，值为 $9.870$。根据问题的严格定义，当上游斜率比下游斜率更陡时（$r_i>1$），这种特定的公式会保留完整的上游斜率。\n\n计算出的三个受限斜率值，分别对应于 $r_i = 0.2$、$1$ 和 $5$，为 $1.974$、$9.870$ 和 $9.870$ K/m。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.974  9.870  9.870 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "最后，让我们从单步的笔算分析走向完整的计算模拟。理论分析至关重要，但观察格式在实际运行中的表现能提供无可替代的直观感受。这个计算练习要求你模拟一个方波的对流过程，比较过度耗散的一阶格式与几种先进的TVD格式。通过测量方波形状的保持程度，你将对不同限制器之间的性能权衡及其有效性获得切实的体会。",
            "id": "3998716",
            "problem": "考虑周期性域中标量场的一维线性平流。其基本原理是线性对流的守恒定律，该定律指出，对于恒定的平流速度 $a$，标量场 $u(x,t)$ 满足 $u_t + a u_x = 0$。假设一个长度为 $L$ 的周期性域，空间坐标 $x \\in [0,L)$，并采用周期性边界条件。初始条件是在区间 $[x_0, x_0 + w)$ 上振幅为 $A$ 的方波脉冲，在其他位置为零。平流速度为 $a > 0$。目标是定量评估应用于该问题的两种数值对流格式的总变差递减 (TVD) 特性：一阶迎风格式和带有不同斜率限制器的二阶守恒律单调迎风格式 (MUSCL)。您需要计算离散总变差 $TV$ 随时间的变化，并报告在经过一个完整域长度的平流后，最终总变差与初始总变差的比值。\n\n定义和要求：\n- 在均匀网格上，网格函数 $u_i$ 的离散总变差为 $TV(u) = \\sum_{i=0}^{N-1} \\left| u_{i+1} - u_i \\right|$，其中周期性意味着 $u_N \\equiv u_0$。总变差递减 (TVD) 是指对于所有时间步 $n$，格式满足 $TV(u^{n+1}) \\leq TV(u^n)$。\n- 时间步进必须满足 Courant–Friedrichs–Lewy (CFL) 稳定性条件。无量纲的 Courant 数为 $\\nu = \\dfrac{a \\Delta t}{\\Delta x}$。\n- 实现一阶迎风格式和二阶 MUSCL 格式，斜率限制器从 minmod、van Leer 和 superbee 中选择。对于二阶格式，使用通量限制的高分辨率修正，该修正在 $\\nu \\in [0,1]$ 和正 $a$ 的情况下与 TVD 属性一致。\n- 域名长度为 $L = 1$，网格点数为 $N = 400$，平流速度为 $a = 1$，初始方波脉冲振幅为 $A = 1$，脉冲左边缘为 $x_0 = 0.2$，脉冲宽度为 $w = 0.2$。空间网格是均匀的，间距为 $\\Delta x = L/N$。每次更新时必须严格执行周期性边界条件。\n- 将数值解演化至时间 $T = L/a$（一个完整域的平流周期）。计算并报告每个指定测试用例的比值 $R = TV(u(T))/TV(u(0))$。除了这些无量纲量外，不需要任何物理单位。\n\n测试套件和要求输出：\n- 使用以下格式和 Courant 数组合的测试套件：\n    1. 使用 $\\nu = 0.2$ 的迎风格式。\n    2. 使用 $\\nu = 0.8$ 的迎风格式。\n    3. 使用 $\\nu = 1.0$ 的迎风格式（边界情况）。\n    4. 使用 minmod 限制器和 $\\nu = 0.2$ 的 MUSCL 格式。\n    5. 使用 minmod 限制器和 $\\nu = 0.8$ 的 MUSCL 格式。\n    6. 使用 van Leer 限制器和 $\\nu = 0.8$ 的 MUSCL 格式。\n    7. 使用 superbee 限制器和 $\\nu = 0.8$ 的 MUSCL 格式。\n- 对于每个测试用例，将 $R$ 计算为浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[r1,r2,r3,r4,r5,r6,r7]”）。\n\n附加说明：\n- 必须正确解释缩写词：总变差递减 (Total Variation Diminishing, TVD)、守恒律单调迎风格式 (Monotonic Upwind Scheme for Conservation Laws, MUSCL) 和 Courant–Friedrichs–Lewy (CFL) 条件。\n- 该问题纯粹是数学和算法问题。所有计算必须在指定的数值设置下进行，采用周期性边界条件，并以上述无量纲形式报告结果。不涉及角度。不得使用百分比；确保将 $R$ 报告为浮点小数。",
            "solution": "该问题要求对一维线性平流方程的几种数值格式的总变差递减 (TVD) 特性进行定量比较。验证过程确认了该问题在科学上是合理的、适定的，并包含了获得唯一计算解所需的所有必要信息。\n\n控制偏微分方程是具有恒定正平流速度 $a$ 的标量场 $u(x,t)$ 的线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n该方程可以写成守恒形式 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$，其中通量函数为 $f(u) = au$。我们将在长度为 $L=1$ 的周期性域上使用指定的初始条件求解该方程。\n\n守恒律的标准数值方法是有限体积法。将域划分为 $N$ 个宽度均匀的单元 $\\Delta x = L/N$。在时间步 $n$ 时，单元 $i$ 中解的单元平均值表示为 $u_i^n$。守恒定律的积分形式导出了半离散更新公式：\n$$\n\\frac{d u_i}{d t} = -\\frac{1}{\\Delta x} \\left( f_{i+1/2} - f_{i-1/2} \\right)\n$$\n其中 $f_{i+1/2}$ 是单元 $i$ 和单元 $i+1$ 之间界面上的数值通量。使用时间步长为 $\\Delta t$ 的简单前向欧拉时间离散化，全离散形式为：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( f_{i+1/2}^n - f_{i-1/2}^n \\right)\n$$\n具体的数值格式由数值通量 $f_{i+1/2}$ 的定义决定。\n\n该问题使用离散总变差 ($TV$) 评估格式的性能，对于周期性网格函数 $u_i$（$i = 0, \\dots, N-1$，且 $u_N \\equiv u_0$），其定义为：\n$$\nTV(u) = \\sum_{i=0}^{N-1} |u_{i+1} - u_i|\n$$\n如果一个格式满足 $TV(u^{n+1}) \\leq TV(u^n)$，则该格式是 TVD 的。初始条件是在域 $[0, 1)$ 内的 $[0.2, 0.4)$ 上的振幅为 $A=1$ 的方波脉冲。在具有 $N=400$ 个点的网格上离散化后，该脉冲有两个间断：一个从 $0$ 到 $1$ 的跳跃，以及一个从 $1$ 到 $0$ 的跳跃。因此，初始总变差为 $TV(u(0)) = |1-0| + |0-1| = 2$。目标是计算经过一个完整平流周期 $T = L/a = 1$ 后的比值 $R = TV(u(T)) / TV(u(0))$。\n\n**一阶迎风格式**\n\n对于速度为 $a > 0$ 的线性平流，信息从左向右传播。一阶迎风格式通过使用“迎风”单元（对于界面 $i+1/2$ 而言是单元 $i$）的状态来定义界面处的通量，从而解释了这一点。\n$$\nf_{i+1/2} = a u_i^n\n$$\n将此代入有限体积更新方程可得：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (a u_i^n - a u_{i-1}^n) = u_i^n - \\nu (u_i^n - u_{i-1}^n)\n$$\n其中 $\\nu = a \\Delta t / \\Delta x$ 是 Courant 数。已知该格式在 $\\nu \\in [0, 1]$ 时是 TVD 的。然而，它仅具有一阶精度，并存在显著的数值耗散，这会抹平诸如方波脉冲边缘之类的尖锐特征。这种耗散与 $\\Delta x (1-\\nu)$ 成正比，因此在 $\\nu$ 较小时最为显著，而在 $\\nu=1$ 的特殊情况下消失。当 $\\nu=1$ 时，更新变为 $u_i^{n+1} = u_{i-1}^n$，这是一个精确的离散平移，从而实现完美的平流，总变差没有损失。\n\n**二阶 MUSCL 格式**\n\n为了在保持 TVD 属性的同时实现二阶精度，守恒律单调迎风格式 (MUSCL) 采用高分辨率重构。该方法不假设每个单元内的值为常数，而是将解重构为分段线性函数：\n$$\nU(x) = u_i^n + \\frac{\\sigma_i^n}{\\Delta x}(x - x_i) \\quad \\text{for } x \\in [x_{i-1/2}, x_{i+1/2})\n$$\n斜率 $\\sigma_i^n$ 必须受到限制，以防止引入新的极值（振荡），因为这会违反 TVD 属性。受限斜率 $\\sigma_i^n$ 是局部解梯度的函数。一个常见的选择是 $\\sigma_i = \\text{limiter}(\\Delta u_{i-1/2}, \\Delta u_{i+1/2})$，其中 $\\Delta u_{i-1/2} = u_i - u_{i-1}$ 且 $\\Delta u_{i+1/2} = u_{i+1} - u_i$。限制器确保重构的斜率永远不会比相邻数据的斜率更陡。指定的限制器是：\n1.  **minmod**: $\\text{minmod}(a, b) = \\begin{cases} \\text{sgn}(a) \\min(|a|, |b|)  \\text{if } ab > 0 \\\\ 0  \\text{if } ab \\le 0 \\end{cases}$。这是常见限制器中耗散性最强的。\n2.  **van Leer**: $\\text{vanLeer}(a, b) = \\begin{cases} 2ab/(a+b)  \\text{if } ab > 0 \\\\ 0  \\text{if } ab \\le 0 \\end{cases}$。它在精度和振荡控制之间提供了良好的平衡。\n3.  **superbee**: 这是一种更具侵略性（压缩性）的限制器，旨在以最小的抹平效应保持接触间断。它可以定义为 $\\text{superbee}(a, b) = \\text{maxmod}(\\text{minmod}(2a,b), \\text{minmod}(a, 2b))$，其中 $\\text{maxmod}$ 类似于 minmod，但取最大绝对值。\n\n对于显式时间积分，我们使用 MUSCL-Hancock 方法，这是一种预估-校正格式。最终的更新公式可写为，它在一阶迎风格式的基础上增加了一个受限的反耗散通量修正：\n$$\nu_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n) - \\frac{\\nu(1-\\nu)}{2}(\\sigma_i^n - \\sigma_{i-1}^n)\n$$\n该公式在使用适当的斜率限制器时，对于 $\\nu \\in [0,1]$ 是 TVD 的。如果不应用限制（$\\sigma_i = u_{i+1}-u_i$ 不是一个有效的选择，但 $\\sigma_i = (u_{i+1}-u_{i-1})/2$ 会是），它会退化为二阶 Lax-Wendroff 格式；当限制器返回零时（例如，在极值附近），它会恢复为一阶迎风格式。这种自适应性使其能够在避免伪振荡的同时捕捉尖锐梯度。\n\n求解过程是通过为指定的测试用例实现这些格式来进行的。对于每个用例，初始方波脉冲演化 $T=1$ 秒。计算最终的总变差，并除以初始总变差（$TV_0=2$），得到比值 $R$。该比值直接衡量了每种格式对初始脉冲尖锐轮廓的保持程度。$R=1$ 的值表示完美保持，而较低的值表示存在数值耗散。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3861  0.7788  1.0000  0.9506  0.9880  0.9990  1.0000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}