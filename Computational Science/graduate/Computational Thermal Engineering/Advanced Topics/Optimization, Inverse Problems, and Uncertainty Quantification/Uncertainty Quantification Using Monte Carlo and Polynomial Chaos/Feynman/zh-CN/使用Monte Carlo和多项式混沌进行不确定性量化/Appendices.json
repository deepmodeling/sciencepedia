{
    "hands_on_practices": [
        {
            "introduction": "广义多项式混沌（gPC）方法的基础是构建一个与不确定输入参数的概率分布相匹配的专用多项式基。这个练习  让你亲手实践这关键的第一步，处理两种常见的概率分布（均匀分布和正态分布）以及与之对应的勒让德（Legendre）多项式和埃尔米特（Hermite）多项式。通过这个练习，你将巩固对正交归一性以及如何构建截断基集的组合计数的理解，这是所有后续gPC应用的核心技能。",
            "id": "4001453",
            "problem": "一个均匀板中的一维瞬态热传导模型被数值求解，以预测空间平均温度响应，其参数不确定性由两个独立的随机输入建模。第一个输入表示为 $\\xi_{1}$，代表导热系数中的一个缩放不确定性，被建模为区间 $[-1,1]$ 上的均匀随机变量。第二个输入表示为 $\\xi_{2}$，代表体积生热率中的一个不确定性，被建模为均值为零、方差为一的标准正态随机变量。为了进行不确定性量化，该响应使用广义多项式混沌 (gPC) 进行近似，这需要构建一个与输入概率测度一致的正交多项式基。\n\n从给定权函数的正交多项式定义出发，并利用 $\\xi_{1}$ 和 $\\xi_{2}$ 的独立性，为输入对 $(\\xi_{1},\\xi_{2})$ 构建总多项式次数最高为 $p$ 的多元正交 gPC 基，其中对 $\\xi_{1}$ 使用 Legendre 多项式，对 $\\xi_{2}$ 使用 Hermite 多项式。明确指定单变量多项式的归一化，以便得到的多元基在 $(\\xi_{1},\\xi_{2})$ 的联合概率测度下是正交的。\n\n然后，推导在全次数截断 $i+j \\le p$（其中 $i$ 是 $\\xi_{1}$ 中的次数，$j$ 是 $\\xi_{2}$ 中的次数）下保留的多元基函数数量的闭式表达式。将你的最终答案表示为关于 $p$ 的单个解析表达式。无需四舍五入，也不需要单位。最终答案应为基的大小作为 $p$ 的函数的表达式。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取给定条件\n- **模型**：一维瞬态热传导。\n- **关心量**：空间平均温度响应。\n- **输入不确定性**：由两个独立的随机输入 $\\xi_{1}$ 和 $\\xi_{2}$ 建模。\n- **输入 $\\xi_{1}$**：代表导热系数中的缩放不确定性。\n- **$\\xi_{1}$ 的分布**：区间 $[-1, 1]$ 上的均匀随机变量。\n- **输入 $\\xi_{2}$**：代表体积生热率中的不确定性。\n- **$\\xi_{2}$ 的分布**：标准正态随机变量（零均值，单位方差）。\n- **不确定性量化方法**：广义多项式混沌 (gPC)。\n- **任务 1**：为输入对 $(\\xi_{1}, \\xi_{2})$ 构建总多项式次数最高为 $p$ 的多元正交 gPC 基。\n- **$\\xi_{1}$ 的多项式**：Legendre 多项式。\n- **$\\xi_{2}$ 的多项式**：Hermite 多项式。\n- **要求**：明确指定单变量多项式的归一化，以实现多元基在联合概率测度下的正交性。\n- **任务 2**：推导在全次数截断 $i+j \\le p$（其中 $i$ 是 $\\xi_{1}$ 中的次数，$j$ 是 $\\xi_{2}$ 中的次数）下保留的多元基函数数量的闭式表达式。\n- **最终答案格式**：基的大小作为 $p$ 的函数的单个解析表达式。\n\n### 步骤 2：使用提取的给定条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题在计算科学与工程领域，特别是不确定性量化领域，有充分的科学依据。针对均匀和正态随机变量分别使用 Legendre 和 Hermite 多项式的广义多项式混沌 (gPC) 是 Wiener-Askey 格式的标准且正确的应用。\n- **适定性**：该问题是适定的。它要求构造一个数学对象（一个正交基）并推导一个组合公式，为此提供了足够的信息。解是唯一且有意义的。\n- **客观性**：问题以精确、客观的数学语言陈述，没有任何主观性或偏见。\n- **缺陷检查表**：该问题不违反任何无效标准。它在科学上是合理的、可形式化的、完整的、现实的、适定的和非平凡的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解答推导\n\n解答按要求分为两部分：首先，构造正交多元基；其次，推导在全次数截断下基函数数量的公式。\n\n#### 第一部分：正交基的构造\n\ngPC 方法要求构造一组相对于随机输入的概率测度是正交的多项式。对于一组独立的随机变量 $\\boldsymbol{\\xi} = (\\xi_{1}, \\xi_{2}, \\dots, \\xi_{d})$，多元正交基由单变量正交多项式的张量积形成。\n\n**$\\xi_{1}$ 的单变量基（均匀分布）**\n\n随机变量 $\\xi_{1}$ 服从 $[-1, 1]$ 上的均匀分布。其概率密度函数 (PDF) 为：\n$$ f_{\\xi_{1}}(x) = \\begin{cases} \\frac{1}{2}  \\text{if } x \\in [-1, 1] \\\\ 0  \\text{otherwise} \\end{cases} $$\n内积的相关权函数为 $w_{1}(x) = f_{\\xi_{1}}(x) = \\frac{1}{2}$，支撑集为 $[-1, 1]$。问题指定对该分布使用 Legendre 多项式 $P_{i}(x)$。Legendre 多项式的标准正交关系是相对于权重 $1$ 定义的：\n$$ \\int_{-1}^{1} P_{i}(x) P_{k}(x) dx = \\frac{2}{2i+1} \\delta_{ik} $$\n其中 $\\delta_{ik}$ 是 Kronecker delta。\n\n为了获得相对于 $\\xi_{1}$ 的概率测度是正交的多项式 $\\Phi_{i}^{(1)}(\\xi_{1})$，我们必须满足以下条件：\n$$ \\langle \\Phi_{i}^{(1)}, \\Phi_{k}^{(1)} \\rangle \\equiv \\int_{-1}^{1} \\Phi_{i}^{(1)}(x) \\Phi_{k}^{(1)}(x) f_{\\xi_{1}}(x) dx = \\delta_{ik} $$\n令 $\\Phi_{i}^{(1)}(x) = c_{i} P_{i}(x)$，其中 $c_{i}$ 为某个归一化常数。将此代入正交条件：\n$$ \\int_{-1}^{1} \\left( c_{i} P_{i}(x) \\right) \\left( c_{k} P_{k}(x) \\right) \\frac{1}{2} dx = \\delta_{ik} $$\n当 $i=k$ 时，这变为：\n$$ c_{i}^{2} \\frac{1}{2} \\int_{-1}^{1} P_{i}(x)^{2} dx = 1 $$\n$$ c_{i}^{2} \\frac{1}{2} \\left( \\frac{2}{2i+1} \\right) = 1 $$\n$$ c_{i}^{2} \\frac{1}{2i+1} = 1 \\implies c_{i} = \\sqrt{2i+1} $$\n因此，$\\xi_{1}$ 的单变量正交多项式为：\n$$ \\Phi_{i}^{(1)}(\\xi_{1}) = \\sqrt{2i+1} P_{i}(\\xi_{1}) $$\n\n**$\\xi_{2}$ 的单变量基（标准正态分布）**\n\n随机变量 $\\xi_{2}$ 服从标准正态分布 $\\mathcal{N}(0, 1)$。其 PDF 为：\n$$ f_{\\xi_{2}}(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^{2}}{2}\\right) $$\n该 PDF 本身是概率论学家 Hermite 多项式的权函数，通常表示为 $He_{j}(x)$。这些多项式的标准正交关系为：\n$$ \\int_{-\\infty}^{\\infty} He_{j}(x) He_{k}(x) \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^{2}}{2}\\right) dx = j! \\delta_{jk} $$\n该积分已经是相对于 $\\xi_{2}$ 的概率测度定义的。令正交多项式为 $\\Phi_{j}^{(2)}(\\xi_{2}) = d_{j} He_{j}(\\xi_{2})$。正交条件为：\n$$ \\langle \\Phi_{j}^{(2)}, \\Phi_{k}^{(2)} \\rangle \\equiv \\int_{-\\infty}^{\\infty} \\Phi_{j}^{(2)}(x) \\Phi_{k}^{(2)}(x) f_{\\xi_{2}}(x) dx = \\delta_{jk} $$\n当 $j=k$ 时，这变为：\n$$ d_{j}^{2} \\int_{-\\infty}^{\\infty} He_{j}(x)^{2} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^{2}}{2}\\right) dx = 1 $$\n$$ d_{j}^{2} (j!) = 1 \\implies d_{j} = \\frac{1}{\\sqrt{j!}} $$\n因此，$\\xi_{2}$ 的单变量正交多项式为：\n$$ \\Phi_{j}^{(2)}(\\xi_{2}) = \\frac{1}{\\sqrt{j!}} He_{j}(\\xi_{2}) $$\n\n**多元正交基**\n\n由于 $\\xi_{1}$ 和 $\\xi_{2}$ 是独立的，联合 PDF 为 $f_{(\\xi_{1}, \\xi_{2})}(x_{1}, x_{2}) = f_{\\xi_{1}}(x_{1}) f_{\\xi_{2}}(x_{2})$。多元 gPC 基函数，表示为 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$，其中 $\\boldsymbol{\\xi}=(\\xi_{1}, \\xi_{2})$ 且多重指标为 $\\boldsymbol{\\alpha}=(i, j)$，由单变量正交多项式的张量积形成：\n$$ \\Psi_{(i,j)}(\\xi_{1}, \\xi_{2}) = \\Phi_{i}^{(1)}(\\xi_{1}) \\Phi_{j}^{(2)}(\\xi_{2}) = \\left(\\sqrt{2i+1} P_{i}(\\xi_{1})\\right) \\left(\\frac{1}{\\sqrt{j!}} He_{j}(\\xi_{2})\\right) $$\n这些基函数相对于联合概率测度是正交的：\n$$ \\langle \\Psi_{(i,j)}, \\Psi_{(k,l)} \\rangle = \\int_{-\\infty}^{\\infty} \\int_{-1}^{1} \\Psi_{(i,j)}(x_{1}, x_{2}) \\Psi_{(k,l)}(x_{1}, x_{2}) f_{\\xi_{1}}(x_{1}) f_{\\xi_{2}}(x_{2}) dx_{1} dx_{2} $$\n$$ = \\langle \\Phi_{i}^{(1)}, \\Phi_{k}^{(1)} \\rangle \\langle \\Phi_{j}^{(2)}, \\Phi_{l}^{(2)} \\rangle = \\delta_{ik} \\delta_{jl} = \\delta_{(i,j),(k,l)} $$\n\n#### 第二部分：全次数截断下基函数的数量\n\n问题指定了全次数截断方案。基函数集合由多重指标 $(i,j)$ 定义，使得总多项式次数 $i+j$ 小于或等于一个预定的最大次数 $p$。\n$$ \\mathcal{J}_{p} = \\{ (i,j) \\in \\mathbb{N}_{0}^{2} \\, | \\, i+j \\leq p \\} $$\n其中 $\\mathbb{N}_{0} = \\{0, 1, 2, \\dots \\}$。我们需要找到这个集合的基数，记为 $N_{p} = |\\mathcal{J}_{p}|$。\n\n我们可以通过对所有可能的总次数 $k$（从 $0$ 到 $p$）进行求和来计算。对于一个固定的总次数 $k$，我们需要找到满足 $i+j=k$ 的非负整数对 $(i,j)$ 的数量。$j$ 的可能值为 $0, 1, \\dots, k$。对于每个这样的 $j$，$i$ 的值被唯一确定为 $i=k-j$。这为固定的总次数 $k$ 提供了 $k+1$ 个可能的对。\n\n基函数的总数是这些计数对 $k=0, 1, \\dots, p$ 的总和：\n$$ N_{p} = \\sum_{k=0}^{p} (\\text{总次数为 } k \\text{ 的对的数量}) = \\sum_{k=0}^{p} (k+1) $$\n这是前 $p+1$ 个整数的和：\n$$ N_{p} = 1 + 2 + 3 + \\dots + (p+1) $$\n使用等差数列求和公式 $\\sum_{m=1}^{n} m = \\frac{n(n+1)}{2}$，其中 $n = p+1$：\n$$ N_{p} = \\frac{(p+1)((p+1)+1)}{2} = \\frac{(p+1)(p+2)}{2} $$\n这个表达式也可以用二项式系数来写。这个问题等价于找到 $i+j \\le p$ 的非负整数解的数量，这又等价于找到 $i+j+s=p$ 的非负整数解的数量，其中 $s$ 是一个松弛变量。这是一个经典的插板法问题，即将 $p$ 个物品分配到 $3$ 个箱子中，其解的数量为：\n$$ N_{p} = \\binom{p+3-1}{3-1} = \\binom{p+2}{2} = \\frac{(p+2)!}{2!(p)!} = \\frac{(p+2)(p+1)}{2} $$\n多元基函数数量的最终闭式表达式是 $p$ 的一个函数。",
            "answer": "$$\\boxed{\\frac{(p+1)(p+2)}{2}}$$"
        },
        {
            "introduction": "从静态的基函数构建，我们现在转向动态问题。真实的工程系统通常涉及随时间演变的行为。这个练习  要求你为一个瞬态仿真问题中的一个关键指标（峰值温度）构建一个蒙特卡洛估计量，这迫使你必须同时考虑采样误差和时间离散化误差之间的相互影响。它还鼓励你前瞻性地思考，如何运用如多项式混沌（PCE）控制变量、多层级蒙特卡洛（MLMC）或降阶模型（ROM）等高级策略，来使这类计算密集型研究变得可行。",
            "id": "4001413",
            "problem": "考虑一块厚度为 $L$ 的均匀平板中的瞬态一维热传导，其热导率为 $k$，体积热容为 $\\rho c$，两个表面均具有对流边界条件，传热系数为 $h$，环境温度为 $T_{\\infty}$。其控制能量守恒和傅里叶传导定律可推导出瞬态热方程 $\\rho c \\, \\frac{\\partial T}{\\partial t} = k \\, \\frac{\\partial^{2} T}{\\partial x^{2}} + q(x,t;\\boldsymbol{\\xi})$，其中 $T(x,t;\\boldsymbol{\\xi})$ 是温度场，$q(x,t;\\boldsymbol{\\xi})$ 是一个不确定的体积热生成项。假设初始条件为 $T(x,0;\\boldsymbol{\\xi}) = T_{0}$，并且不确定性由一个定义在已知联合概率密度函数的概率空间上的随机向量 $\\boldsymbol{\\xi}$ 表示。令 $x^{\\star} \\in [0,L]$ 为一个关心的固定点。令 $T(t;\\boldsymbol{\\xi}) := T(x^{\\star},t;\\boldsymbol{\\xi})$ 表示在 $x^{\\star}$ 处的温度时程。\n\n定义峰值温度泛函 $G(\\boldsymbol{\\xi}) := \\max_{t \\in [0,t_{f}]} T(t;\\boldsymbol{\\xi})$，其中 $t_{f} > 0$ 是一个指定的最终时间。关心量是平均峰值温度 $\\mu := \\mathbb{E}[G(\\boldsymbol{\\xi})]$。假设对于 $\\boldsymbol{\\xi}$ 的几乎每一个实现，函数 $t \\mapsto T(t;\\boldsymbol{\\xi})$ 在 $[0,t_{f}]$ 上是连续的，并且在时间上是 $L_{t}$-利普希茨连续的，即对于所有 $t_{1}, t_{2} \\in [0,t_{f}]$，都有 $|T(t_{1};\\boldsymbol{\\xi}) - T(t_{2};\\boldsymbol{\\xi})| \\le L_{t} |t_{1} - t_{2}|$。\n\n您可以使用一个确定性高保真求解器，对于任意给定的 $\\boldsymbol{\\xi}$，该求解器可以在一个均匀时间网格 $t_{m} = m \\Delta t$（其中 $\\Delta t = t_{f}/M$）上计算出离散时程 $\\{T(t_{m};\\boldsymbol{\\xi})\\}_{m=0}^{M}$。使用蒙特卡洛的基本原理（大数定律和无偏样本平均）以及上述物理和正则性假设，推导出一个可从离散时程计算的、针对 $\\mu$ 的一致蒙特卡洛估计量。您的推导应仔细定义该估计量（用样本量 $N$、网格上的离散最大值以及两层近似（在 $\\boldsymbol{\\xi}$ 中采样和在 $t$ 中离散化）来表示），并应在所述假设下证明其在 $N \\to \\infty$ 和 $M \\to \\infty$ 时的一致性。\n\n此外，请概述基于不确定性量化和降阶建模的策略，以在估计 $\\mu$ 时重用计算出的时程，从而降低计算成本。这些策略可以包括但不限于：使用基于多项式混沌展开构建的控制变量进行方差缩减、多层采样，以及从先前计算的轨迹构建降阶基。\n\n将最终估计量以单个闭式解析表达式的形式给出，该表达式用 $N$、$M$、离散时间值 $\\{t_{m}\\}_{m=0}^{M}$ 和样本时程 $\\{T^{(n)}(t_{m})\\}_{n=1}^{N}$ 表示，其中 $T^{(n)}(t_{m}) := T(t_{m};\\boldsymbol{\\xi}^{(n)})$ 表示第 $n$ 次独立抽取 $\\boldsymbol{\\xi}^{(n)}$ 时在时间 $t_{m}$ 处的温度。将最终答案表示为单个解析表达式。无需进行数值计算或四舍五入。",
            "solution": "所述问题是有效的。它具有科学依据，即瞬态热传递和统计估计的原理，数学上是适定的，并以客观、正式的语言表述。它提出了计算不确定性量化领域一个标准的、非平凡的问题，要求推导一个可计算的估计量并讨论先进的计算策略。所有必要条件，如问题几何形状、控制方程、边界和初始条件，以及关于解的关键正则性假设，都已提供，以便形成严谨的答案。\n\n关心量是平均峰值温度 $\\mu = \\mathbb{E}[G(\\boldsymbol{\\xi})]$，其中 $G(\\boldsymbol{\\xi}) := \\max_{t \\in [0,t_{f}]} T(x^{\\star},t;\\boldsymbol{\\xi})$。随机向量 $\\boldsymbol{\\xi}$ 用于解释系统中的不确定性，例如在热生成项 $q(x,t;\\boldsymbol{\\xi})$ 中。\n\n对 $\\mu$ 的直接蒙特卡洛 (MC) 估计将涉及从 $\\boldsymbol{\\xi}$ 的已知概率分布中抽取 $N$ 个独立同分布 (i.i.d.) 的样本 $\\boldsymbol{\\xi}^{(1)}, \\boldsymbol{\\xi}^{(2)}, \\dots, \\boldsymbol{\\xi}^{(N)}$。根据大数定律，$\\mu$ 的一个无偏估计量是样本均值：\n$$\n\\hat{\\mu}_{N} = \\frac{1}{N} \\sum_{n=1}^{N} G(\\boldsymbol{\\xi}^{(n)}) = \\frac{1}{N} \\sum_{n=1}^{N} \\left( \\max_{t \\in [0,t_{f}]} T(x^{\\star}, t; \\boldsymbol{\\xi}^{(n)}) \\right)\n$$\n然而，这个估计量是无法直接计算的。高保真求解器提供的温度不是时间 $t$ 的连续函数，而是在均匀时间点 $t_m = m \\Delta t$（其中 $\\Delta t = t_f / M$）上的离散时程 $\\{T(x^{\\star}, t_{m}; \\boldsymbol{\\xi})\\}_{m=0}^{M}$。\n\n为了构建一个可计算的估计量，我们必须用离散时间最大值来近似连续时间最大值。对于每个样本 $\\boldsymbol{\\xi}^{(n)}$，我们将离散峰值温度定义为：\n$$\nG_{M}(\\boldsymbol{\\xi}^{(n)}) := \\max_{m \\in \\{0, 1, \\dots, M\\}} T(x^{\\star}, t_{m}; \\boldsymbol{\\xi}^{(n)})\n$$\n使用这个可计算的量，我们定义两层蒙特卡洛估计量，它是样本量 $N$ 和时间离散化水平 $M$ 的函数。采用记法 $T^{(n)}(t_{m}) := T(x^{\\star}, t_{m}; \\boldsymbol{\\xi}^{(n)})$，该估计量为：\n$$\n\\hat{\\mu}_{N,M} = \\frac{1}{N} \\sum_{n=1}^{N} G_{M}(\\boldsymbol{\\xi}^{(n)}) = \\frac{1}{N} \\sum_{n=1}^{N} \\left( \\max_{m \\in \\{0, 1, \\dots, M\\}} T^{(n)}(t_{m}) \\right)\n$$\n\n为了证明该估计量的一致性，我们必须证明当 $N \\to \\infty$ 和 $M \\to \\infty$ 时，$\\hat{\\mu}_{N,M} \\to \\mu$。误差可以使用三角不等式分解：\n$$\n|\\hat{\\mu}_{N,M} - \\mu| = \\left| \\frac{1}{N} \\sum_{n=1}^{N} G_{M}(\\boldsymbol{\\xi}^{(n)}) - \\mathbb{E}[G(\\boldsymbol{\\xi})] \\right| \\leq \\left| \\frac{1}{N} \\sum_{n=1}^{N} G_{M}(\\boldsymbol{\\xi}^{(n)}) - \\mathbb{E}[G_{M}(\\boldsymbol{\\xi})] \\right| + \\left| \\mathbb{E}[G_{M}(\\boldsymbol{\\xi})] - \\mathbb{E}[G(\\boldsymbol{\\xi})] \\right|\n$$\n右边的第一项是采样误差。对于任何固定的 $M$，随机变量 $G_{M}(\\boldsymbol{\\xi}^{(n)})$ 是独立同分布的。根据强大数定律，当 $N \\to \\infty$ 时，此项几乎必然收敛到 $0$。\n\n第二项是时间离散化引入的系统偏差。设此偏差为 $B_{M} = \\mathbb{E}[G_{M}(\\boldsymbol{\\xi})] - \\mathbb{E}[G(\\boldsymbol{\\xi})]$。我们可以通过分析单个实现的误差来界定其大小。根据定义，$G_{M}(\\boldsymbol{\\xi}) \\leq G(\\boldsymbol{\\xi})$。令 $t^{\\star}(\\boldsymbol{\\xi}) \\in [0,t_{f}]$ 为出现真实最大值的时间，即 $G(\\boldsymbol{\\xi}) = T(x^{\\star},t^{\\star}(\\boldsymbol{\\xi});\\boldsymbol{\\xi})$。令 $t_{m^{\\star}}$ 为最接近 $t^{\\star}(\\boldsymbol{\\xi})$ 的网格点，使得 $|t^{\\star}(\\boldsymbol{\\xi}) - t_{m^{\\star}}| \\leq \\Delta t = t_{f}/M$。对于单个样本的误差，可以使用给定的利普希茨连续性假设进行界定：\n$$\n0 \\leq G(\\boldsymbol{\\xi}) - G_{M}(\\boldsymbol{\\xi}) = T(x^{\\star},t^{\\star}(\\boldsymbol{\\xi});\\boldsymbol{\\xi}) - \\max_{m} T(x^{\\star},t_{m};\\boldsymbol{\\xi}) \\leq T(x^{\\star},t^{\\star}(\\boldsymbol{\\xi});\\boldsymbol{\\xi}) - T(x^{\\star},t_{m^{\\star}};\\boldsymbol{\\xi})\n$$\n$$\n\\leq |T(x^{\\star},t^{\\star}(\\boldsymbol{\\xi});\\boldsymbol{\\xi}) - T(x^{\\star},t_{m^{\\star}};\\boldsymbol{\\xi})| \\leq L_{t} |t^{\\star}(\\boldsymbol{\\xi}) - t_{m^{\\star}}| \\leq L_{t} \\Delta t = L_{t} \\frac{t_{f}}{M}\n$$\n这个界限对于 $\\boldsymbol{\\xi}$ 的几乎每一个实现都成立。取期望，我们可以界定偏差：\n$$\n|B_{M}| = |\\mathbb{E}[G_{M}(\\boldsymbol{\\xi}) - G(\\boldsymbol{\\xi})]| = \\mathbb{E}[G(\\boldsymbol{\\xi}) - G_{M}(\\boldsymbol{\\xi})] \\leq \\mathbb{E}\\left[L_{t} \\frac{t_{f}}{M}\\right] = L_{t} \\frac{t_{f}}{M}\n$$\n当 $M \\to \\infty$ 时，离散偏差 $B_{M} \\to 0$。由于采样误差在 $N \\to \\infty$ 时消失，离散偏差在 $M \\to \\infty$ 时消失，因此估计量 $\\hat{\\mu}_{N,M}$ 是一致的。\n\n为了降低估计 $\\mu$ 的计算成本（由于需要大量高保真求解，即大的 $N$，成本可能很高），可以采用几种策略。\n\n1.  **使用控制变量的方差缩减**：控制变量是一个与关心量 $G_{M}(\\boldsymbol{\\xi})$ 高度相关且其均值 $\\mathbb{E}[Y]$ 已知或易于计算的随机变量 $Y$。峰值温度的低阶多项式混沌展开 (PCE) $G_{PCE}(\\boldsymbol{\\xi}) = \\sum_{|\\boldsymbol{\\alpha}| \\leq P} c_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$，可以作为一个出色的控制变量。系数 $c_{\\boldsymbol{\\alpha}}$ 在离线阶段使用少量高保真求解计算。PCE的均值 $\\mathbb{E}[G_{PCE}(\\boldsymbol{\\xi})]=c_{\\boldsymbol{0}}$ 是解析得到的。控制变量估计量为 $\\hat{\\mu}_{CV} = \\frac{1}{N}\\sum_{n=1}^{N} \\left( G_M(\\boldsymbol{\\xi}^{(n)}) - \\beta (G_{PCE}(\\boldsymbol{\\xi}^{(n)}) - c_{\\boldsymbol{0}}) \\right)$，其中 $\\beta$ 的选择旨在最小化方差。这重用了构建 PCE 所投入的计算精力，以减少在给定精度下所需的 MC 样本数量 $N$。\n\n2.  **多层蒙特卡洛 (MLMC)**：该方法利用了离散化的层次结构。令 $P_{l} = G_{M_l}(\\boldsymbol{\\xi})$ 为在具有 $M_l$ 个时间步的网格上计算的峰值温度，其中 $M_l$ 随层级 $l$ 增加。期望通过一个伸缩求和来分解：$\\mathbb{E}[P_{L}] = \\mathbb{E}[P_0] + \\sum_{l=1}^{L} \\mathbb{E}[P_l - P_{l-1}]$。MLMC 独立地估计求和中的每一项。差异的方差 $\\text{Var}(P_l - P_{l-1})$ 随着层级 $l$（以及成本）的增加而减小。因此，只需要很少的样本来估计高保真度层级上差异的期望，而大量的样本则用于粗糙、低成本的基础层级。这可以在时程求解器的不同保真度级别上优化分配计算资源。\n\n3.  **降阶建模 (ROM)**：该方法旨在用一个速度更快但足够精确的代理模型来替代高保真求解器。对于由偏微分方程驱动的问题，基于投影的降阶模型是有效的。可以使用像本征正交分解 (POD) 这样的方法。在离线阶段，我们为一些训练参数样本运行高保真求解器，并收集解快照。POD应用于此快照集，以提取一个跨越解流形的低维基 $\\{\\phi_i(x)\\}_{i=1}^r$。通过将控制热方程投影到这个基上（伽辽金投影），可以得到一个关于模态系数的小型常微分方程组。在在线 MC 阶段，对于每个样本 $\\boldsymbol{\\xi}^{(n)}$，求解这个廉价的 ROM 以生成时程，并从中提取峰值温度。这重用了初始训练运行中的信息，以加速 MC 循环中所有后续的评估。\n\n这些策略为重用或利用计算结果提供了有原则的方法，以显著降低计算密集型模型的不确定性量化成本。",
            "answer": "$$\n\\boxed{\\frac{1}{N} \\sum_{n=1}^{N} \\max_{m \\in \\{0, 1, \\dots, M\\}} T^{(n)}(t_{m})}\n$$"
        },
        {
            "introduction": "正如前一个练习所暗示的，高保真模拟的计算成本非常高昂。多层级蒙特卡洛（MLMC）方法通过巧妙地结合大量廉价的低保真度模拟和少量昂贵的高保真度模拟结果，有效地解决了这一挑战。这个练习  将引导你走过一个完整的MLMC研究流程，从推导估计量到解决一个关键的优化问题：如何最优地在不同保真度的模型之间分配你的计算预算，从而以最低的成本达到预定的精度目标。",
            "id": "4001462",
            "problem": "考虑一个方形板中的稳态二维热传导模型，其导热系数不确定，由一个随机输入向量 $\\boldsymbol{\\xi}$ 表征。令 $Q$ 表示一个标量目标量，具体为沿部分边界的空间平均法向热通量。一个有限元求解器在一系列嵌套网格上近似计算 $Q$，网格的特征尺寸为 $h_l = 2^{-l} h_0$，其中 $l \\in \\{0,1,2,3\\}$ 是细化层级的索引，$h_0 = 1/8$。层级由网格细化定义，在每个层级 $l$，我们用 $Q_l(\\boldsymbol{\\xi})$ 表示计算出的近似值。先前对离散化误差和耦合进行的广义多项式混沌 (gPC) 分析表明，对于层级间修正项 $Y_l(\\boldsymbol{\\xi}) = Q_l(\\boldsymbol{\\xi}) - Q_{l-1}(\\boldsymbol{\\xi})$，存在以下经过经验验证的标度关系：$\\operatorname{Var}(Y_l) = a\\, h_l^{2}$，其中 $a = 3.2 \\times 10^{-3}$；以及每个样本的计算成本 $C_l = c\\, h_l^{-2}$，其中 $c = 50$。gPC 分析进一步提供了一个偏差界 $|\\mathbb{E}[Q - Q_L]| \\le \\gamma\\, h_L$，其中 $\\gamma = 2.0 \\times 10^{-2}$，$L=3$ 是最精细的层级。\n\n你将为 $\\mathbb{E}[Q]$ 构建一个多层蒙特卡洛 (MLMC) 估计器。多层蒙特卡洛 (MLMC) 方法使用伸缩分解和带有匹配随机输入的分层抽样来减少方差。假设跨层级的样本是独立同分布的，并且在每个层级 $l \\ge 1$ 内使用相同的随机数来耦合 $Q_l$ 和 $Q_{l-1}$。\n\n任务：\n\n1. 从期望的线性性质和序列 $\\{Q_l\\}_{l=0}^{L}$ 的伸缩恒等式出发，推导一个 $\\mathbb{E}[Q_L]$ 的无偏估计器，该估计器写为 $Y_l$ 的分层样本均值之和，其中 $Y_0 = Q_0$ 且对于 $l \\ge 1$ 有 $Y_l = Q_l - Q_{l-1}$。然后在层级 $L$ 的偏差由给定界控制的假设下，陈述 $\\mathbb{E}[Q]$ 的估计器。\n\n2. 使用独立层级间的方差可加性和给定的每层级成本模型，提出并求解一个约束优化问题，该问题旨在最小化总预期计算成本 $\\sum_{l=0}^{L} N_l C_l$，约束条件为方差预算 $\\sum_{l=0}^{L} \\operatorname{Var}(Y_l)/N_l \\le \\eta^{2}$，其中 $\\eta^{2}$ 是某个目标方差。使用拉格朗日乘数法，以 $\\operatorname{Var}(Y_l)$ 和 $C_l$ 的函数形式，得到最优 $N_l$ 分配的闭式解，并说明在有偏差界可用时，如何从给定的均方误差 (MSE) 预算 $\\varepsilon^{2}$ 中选择 $\\eta^{2}$。\n\n3. 对于给定的数据 $a = 3.2 \\times 10^{-3}$、$c = 50$、$h_0=1/8$、$L=3$ 和目标均方误差 $\\varepsilon^{2} = 10^{-6}$，计算最优整数样本数 $N_l$（对于 $l=0,1,2,3$），使得在满足 MSE 目标的同时最小化成本。使用偏差界 $|\\mathbb{E}[Q - Q_L]| \\le \\gamma h_L$（其中 $\\gamma = 2.0 \\times 10^{-2}$ 且 $h_3 = 2^{-3} h_0$），将方差预算分配为 $\\eta^{2} = \\varepsilon^{2} - (\\gamma h_L)^{2}$，并利用你推导出的连续最优分配来确定 $N_l$，然后选择满足方差约束的最小整数。\n\n使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境，将最终答案表示为四个最优样本数 $\\{N_0, N_1, N_2, N_3\\}$ 的行向量。最终答案中不应包含任何单位。如果需要任何中间数值常数，请在最终计算前保持符号形式。你的最终答案必须是一个计算结果。",
            "solution": "该问题陈述清晰且科学上合理，描述了多层蒙特卡洛 (MLMC) 方法在计算工程中不确定性量化方面的一个标准应用。所有必需的数据和标度关系均已提供，并与既有理论一致。我们将按顺序完成这三项任务来求解问题。\n\n### 任务 1：MLMC 估计器的推导\n\n目标是使用一系列数值模型 $\\{Q_l\\}_{l=0}^{L}$ 来估计目标量 $\\mathbb{E}[Q]$ 的期望值。MLMC 方法为最精细模型 $\\mathbb{E}[Q_L]$ 的期望提供了一个估计器，该估计器可作为 $\\mathbb{E}[Q]$ 的近似。\n\n我们从最精细层级 $L$ 的近似值 $Q_L$ 的伸缩恒等式开始：\n$$Q_L(\\boldsymbol{\\xi}) = Q_0(\\boldsymbol{\\xi}) + \\sum_{l=1}^{L} \\left( Q_l(\\boldsymbol{\\xi}) - Q_{l-1}(\\boldsymbol{\\xi}) \\right)$$\n我们定义层级间修正项 $Y_l(\\boldsymbol{\\xi})$ 为 $Y_0(\\boldsymbol{\\xi}) = Q_0(\\boldsymbol{\\xi})$，且对于 $l \\in \\{1, \\dots, L\\}$ 有 $Y_l(\\boldsymbol{\\xi}) = Q_l(\\boldsymbol{\\xi}) - Q_{l-1}(\\boldsymbol{\\xi})$。该恒等式可以紧凑地写为：\n$$Q_L(\\boldsymbol{\\xi}) = \\sum_{l=0}^{L} Y_l(\\boldsymbol{\\xi})$$\n根据期望算子的线性性质，$Q_L$ 的期望值为：\n$$\\mathbb{E}[Q_L] = \\mathbb{E}\\left[\\sum_{l=0}^{L} Y_l(\\boldsymbol{\\xi})\\right] = \\sum_{l=0}^{L} \\mathbb{E}[Y_l]$$\nMLMC 方法使用一个独立的蒙特卡洛估计器来估计右侧的每一项 $\\mathbb{E}[Y_l]$。对于每个层级 $l$，我们抽取 $N_l$ 个 $Y_l$ 的独立同分布样本，记为 $\\{Y_l^{(i)}\\}_{i=1}^{N_l}$。$\\mathbb{E}[Y_l]$ 的样本均值估计器为：\n$$\\widehat{Y}_l = \\frac{1}{N_l} \\sum_{i=1}^{N_l} Y_l^{(i)}(\\boldsymbol{\\xi}^{(i,l)})$$\n由于每个 $\\widehat{Y}_l$ 都是 $\\mathbb{E}[Y_l]$ 的无偏估计器，即 $\\mathbb{E}[\\widehat{Y}_l] = \\mathbb{E}[Y_l]$，因此 $\\mathbb{E}[Q_L]$ 的 MLMC 估计器（记为 $\\widehat{Q}_{L,\\text{MLMC}}$）通过对各层级估计器求和来构造：\n$$\\widehat{Q}_{L,\\text{MLMC}} = \\sum_{l=0}^{L} \\widehat{Y}_l = \\sum_{l=0}^{L} \\frac{1}{N_l} \\sum_{i=1}^{N_l} Y_l^{(i)}$$\n这是 $\\mathbb{E}[Q_L]$ 的一个无偏估计器，因为 $\\mathbb{E}[\\widehat{Q}_{L,\\text{MLMC}}] = \\sum_{l=0}^{L} \\mathbb{E}[\\widehat{Y}_l] = \\sum_{l=0}^{L} \\mathbb{E}[Y_l] = \\mathbb{E}[Q_L]$。\n\n这个估计器 $\\widehat{Q}_{L,\\text{MLMC}}$ 被用作真实期望 $\\mathbb{E}[Q]$ 的估计器。这引入了一个偏差，称为离散化偏差，等于 $\\mathbb{E}[Q_L - Q]$。问题提供了该偏差的一个界：$|\\mathbb{E}[Q_L - Q]| \\le \\gamma h_L$。\n\n### 任务 2：最优样本分配\n\n总计算成本 $C_{\\text{total}}$ 是各层级成本之和：\n$$C_{\\text{total}} = \\sum_{l=0}^{L} N_l C_l$$\n由于样本在各层级之间是独立抽取的，MLMC 估计器的方差是各层级样本均值方差之和：\n$$\\operatorname{Var}(\\widehat{Q}_{L,\\text{MLMC}}) = \\operatorname{Var}\\left(\\sum_{l=0}^{L} \\widehat{Y}_l\\right) = \\sum_{l=0}^{L} \\operatorname{Var}(\\widehat{Y}_l) = \\sum_{l=0}^{L} \\frac{\\operatorname{Var}(Y_l)}{N_l}$$\n我们的目标是在估计器方差不超过预算 $\\eta^2$ 的约束下，最小化成本 $C_{\\text{total}}$：\n$$\\sum_{l=0}^{L} \\frac{\\operatorname{Var}(Y_l)}{N_l} \\le \\eta^2$$\n这是一个约束优化问题。将样本数 $N_l$ 视为连续变量，我们使用拉格朗日乘数法。拉格朗日函数为：\n$$\\mathcal{L}(N_0, \\dots, N_L, \\lambda) = \\sum_{l=0}^{L} N_l C_l + \\lambda \\left( \\sum_{l=0}^{L} \\frac{\\operatorname{Var}(Y_l)}{N_l} - \\eta^2 \\right)$$\n为求最小值，我们将关于每个 $N_l$ 的偏导数设为零：\n$$\\frac{\\partial \\mathcal{L}}{\\partial N_l} = C_l - \\lambda \\frac{\\operatorname{Var}(Y_l)}{N_l^2} = 0$$\n求解 $N_l$ 可得：\n$$N_l^2 = \\lambda \\frac{\\operatorname{Var}(Y_l)}{C_l} \\implies N_l = \\sqrt{\\lambda} \\sqrt{\\frac{\\operatorname{Var}(Y_l)}{C_l}}$$\n为求出拉格朗日乘数 $\\sqrt{\\lambda}$，我们将 $N_l$ 的表达式代入方差约束中，并假设约束是激活的（即等式成立）：\n$$\\sum_{l=0}^{L} \\frac{\\operatorname{Var}(Y_l)}{\\sqrt{\\lambda} \\sqrt{\\frac{\\operatorname{Var}(Y_l)}{C_l}}} = \\sum_{l=0}^{L} \\frac{\\sqrt{\\operatorname{Var}(Y_l) C_l}}{\\sqrt{\\lambda}} = \\eta^2$$\n求解 $\\sqrt{\\lambda}$：\n$$\\sqrt{\\lambda} = \\frac{1}{\\eta^2} \\sum_{k=0}^{L} \\sqrt{\\operatorname{Var}(Y_k) C_k}$$\n将其代回 $N_l$ 的表达式，得到最优样本分配：\n$$N_l = \\frac{1}{\\eta^2} \\left( \\sum_{k=0}^{L} \\sqrt{\\operatorname{Var}(Y_k) C_k} \\right) \\sqrt{\\frac{\\operatorname{Var}(Y_l)}{C_l}}$$\n$\\mathbb{E}[Q]$ 估计器的均方误差 (MSE) 是方差和偏差平方之和：\n$$\\text{MSE} = \\mathbb{E}[(\\widehat{Q}_{L,\\text{MLMC}} - \\mathbb{E}[Q])^2] = \\operatorname{Var}(\\widehat{Q}_{L,\\text{MLMC}}) + (\\mathbb{E}[Q_L] - \\mathbb{E}[Q])^2$$\n给定总 MSE 预算 $\\varepsilon^2$，我们必须满足 $\\text{MSE} \\le \\varepsilon^2$。使用偏差界，这变为：\n$$\\sum_{l=0}^{L} \\frac{\\operatorname{Var}(Y_l)}{N_l} + (\\gamma h_L)^2 \\le \\varepsilon^2$$\n为确保这一点，我们设定方差预算 $\\eta^2$，使得误差的方差部分受以下约束：\n$$\\eta^2 = \\varepsilon^2 - (\\gamma h_L)^2$$\n这要求所选的最精细层级 $L$ 满足其偏差贡献 $(\\gamma h_L)^2$ 小于总 MSE 预算 $\\varepsilon^2$。\n\n### 任务 3：数值计算\n\n现在我们使用给定的数据应用推导出的公式：$L=3$、$a = 3.2 \\times 10^{-3}$、$c = 50$、$h_0 = 1/8$、$\\gamma = 2.0 \\times 10^{-2}$ 和 $\\varepsilon^2 = 10^{-6}$。\n\n首先，我们计算网格尺寸 $h_l = h_0 2^{-l}$：\n$h_0 = 1/8 = 0.125$\n$h_1 = 1/16 = 0.0625$\n$h_2 = 1/32 = 0.03125$\n$h_3 = 1/64 = 0.015625$\n\n接下来，我们计算每个层级的方差 $\\operatorname{Var}(Y_l) = V_l = a h_l^2$ 和成本 $C_l = c h_l^{-2}$：\n对于 $l=0$：$V_0 = (3.2 \\times 10^{-3}) (1/8)^2 = 5 \\times 10^{-5}$；$C_0 = 50 (1/8)^{-2} = 3200$。\n对于 $l=1$：$V_1 = (3.2 \\times 10^{-3}) (1/16)^2 = 1.25 \\times 10^{-5}$；$C_1 = 50 (1/16)^{-2} = 12800$。\n对于 $l=2$：$V_2 = (3.2 \\times 10^{-3}) (1/32)^2 = 3.125 \\times 10^{-6}$；$C_2 = 50 (1/32)^{-2} = 51200$。\n对于 $l=3$：$V_3 = (3.2 \\times 10^{-3}) (1/64)^2 \\approx 7.8125 \\times 10^{-7}$；$C_3 = 50 (1/64)^{-2} = 204800$。\n\n现在我们计算项 $\\sqrt{V_l C_l}$。对于任何层级 $l$，$\\sqrt{V_l C_l} = \\sqrt{(a h_l^2)(c h_l^{-2})} = \\sqrt{ac}$。\n$\\sqrt{ac} = \\sqrt{(3.2 \\times 10^{-3})(50)} = \\sqrt{0.16} = 0.4$。\n所有层级的总和是 $\\sum_{k=0}^{3} \\sqrt{V_k C_k} = (3+1) \\times 0.4 = 1.6$。\n\n接下来，我们确定方差预算 $\\eta^2$。在层级 $L=3$ 处的偏差平方为：\n$(\\gamma h_L)^2 = (\\gamma h_3)^2 = (2.0 \\times 10^{-2} \\times \\frac{1}{64})^2 = (\\frac{1}{3200})^2 \\approx 9.765625 \\times 10^{-8}$。\n$\\eta^2 = \\varepsilon^2 - (\\gamma h_3)^2 = 10^{-6} - 9.765625 \\times 10^{-8} = 9.0234375 \\times 10^{-7}$。\n\n我们现在使用任务 2 中的公式计算连续最优样本数 $N_l$：\n$N_l = \\frac{1}{\\eta^2} \\left( \\sum_{k=0}^{3} \\sqrt{V_k C_k} \\right) \\sqrt{\\frac{V_l}{C_l}}$\n项 $\\sqrt{V_l/C_l} = \\sqrt{(a h_l^2)/(c h_l^{-2})} = \\sqrt{a/c} \\, h_l^2$。\n$\\sqrt{a/c} = \\sqrt{(3.2 \\times 10^{-3})/50} = \\sqrt{6.4 \\times 10^{-5}} = \\sqrt{64 \\times 10^{-6}} = 8 \\times 10^{-3}$。\n所以，$N_l = \\frac{1.6}{9.0234375 \\times 10^{-7}} \\times (8 \\times 10^{-3}) h_l^2 \\approx (1.773134 \\times 10^6) \\times (8 \\times 10^{-3}) h_l^2 \\approx 14185.0734 h_l^2$。\n\n我们来计算每个层级的 $N_l$：\n$N_0 \\approx 14185.0734 \\times (1/8)^2 = 14185.0734 / 64 \\approx 221.64$\n$N_1 \\approx 14185.0734 \\times (1/16)^2 = 14185.0734 / 256 \\approx 55.41$\n$N_2 \\approx 14185.0734 \\times (1/32)^2 = 14185.0734 / 1024 \\approx 13.85$\n$N_3 \\approx 14185.0734 \\times (1/64)^2 = 14185.0734 / 4096 \\approx 3.46$\n\n最后，我们确定满足方差约束的最小整数样本数。这通过对每个连续值取上整（ceiling）来实现：$N_l^{\\text{final}} = \\lceil N_l \\rceil$。\n$N_0 = \\lceil 221.64 \\rceil = 222$\n$N_1 = \\lceil 55.41 \\rceil = 56$\n$N_2 = \\lceil 13.85 \\rceil = 14$\n$N_3 = \\lceil 3.46 \\rceil = 4$\n\n最优整数样本数组为 $\\{222, 56, 14, 4\\}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n222  56  14  4\n\\end{pmatrix}\n}\n$$"
        }
    ]
}