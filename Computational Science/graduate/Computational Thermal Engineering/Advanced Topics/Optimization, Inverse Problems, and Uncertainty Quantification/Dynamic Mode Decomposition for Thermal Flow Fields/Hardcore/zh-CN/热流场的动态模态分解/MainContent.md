## 引言
在现代计算热工领域，高保真[数值模拟](@entry_id:146043)和先进的实验测量技术正以前所未有的速度产生海量、高维的时空数据。然而，从这些复杂的数据集中提取出主导的物理机制、识别关键的动力学模式，并构建用于预测和控制的简化模型，仍然是一项巨大的挑战。动态模式分解（Dynamic Mode Decomposition, DMD）作为一种强大的数据驱动方法应运而生，它提供了一个连接复杂数据与底层动力学物理本质的桥梁。

本文旨在系统性地介绍DMD在[热流场](@entry_id:1133000)分析中的应用，解决如何从瞬态数据中挖掘相干流动结构及其时间演化规律的难题。通过学习本文，读者将能够理解并应用DMD来解析复杂的热动力学系统。文章分为三个核心部分：第一章“原理与机制”将深入探讨DMD的数学基础，阐明其如何将复杂的[非线性动力学](@entry_id:901750)近似为线性系统，并揭示其与[Koopman算子理论](@entry_id:266030)的深刻联系。第二章“应用与交叉学科联系”将展示DMD在量化传热、构建降阶模型、进行[系统辨识](@entry_id:201290)与控制等方面的广泛实际应用，并探讨其高级变体如何应对[非线性](@entry_id:637147)与多尺度挑战。最后，在“动手实践”部分，通过一系列引导性练习，读者将亲手实现[DMD算法](@entry_id:748617)并解决数据采样等实际问题，从而将理论知识转化为实践技能。让我们首先从DMD的基本原理开始，探索它如何为我们提供一个观察复杂热流现象的全新线性视角。

## 原理与机制

动态模式分解 (Dynamic Mode Decomposition, DMD) 是一种功能强大的数据驱动方法，用于分析复杂流体动力学系统的时间演化。与许多其他旨在寻找空间最优[正交基](@entry_id:264024)（如本征正交分解，POD）的方法不同，DMD 的核心目标是识别出一个[线性动力系统](@entry_id:1127277)，其演化能够最佳地拟合观测到的数据序列。这种方法使得我们可以将复杂的[非线性](@entry_id:637147)[热流场](@entry_id:1133000)动力学分解为一组具有简单时间行为（[指数增长](@entry_id:141869)/衰减和单一频率振荡）的空间相干结构。本章将深入探讨 DMD 的基本原理、其与现代动力系统理论（特别是 Koopman [算子理论](@entry_id:139990)）的深刻联系，以及如何解释其结果以揭示[热流场](@entry_id:1133000)中的关键物理机制。

### 核心思想：非线性动力学的线性视角

DMD 的基本出发点是假设一个高维系统状态的演化可以由一个固定的[线性算子](@entry_id:149003)来近似。考虑一个[热流场](@entry_id:1133000)，我们在均匀的时间间隔 $\Delta t$ 内采集了一系列“快照”。每个快照都是一个列向量 $\mathbf{z}_k \in \mathbb{R}^{n}$，它代表了在时刻 $t_k = k\Delta t$ 时，[空间离散化](@entry_id:172158)后的速度场和温度场。DMD 试图寻找一个唯一的[线性映射](@entry_id:185132)矩阵 $A \in \mathbb{R}^{n \times n}$，使得它能够将系统从一个时刻的状态推进到下一个时刻：

$$
\mathbf{z}_{k+1} \approx A \mathbf{z}_k
$$

这个假设构成了 DMD 的基石。为了从数据中找到这个最优的算子 $A$，我们构建两个数据矩阵。第一个矩阵 $X$ 由前 $m-1$ 个快照构成，第二个矩阵 $Y$ 由后 $m-1$ 个快照构成：

$$
X = [\mathbf{z}_0, \mathbf{z}_1, \dots, \mathbf{z}_{m-2}] \in \mathbb{R}^{n \times (m-1)}
$$

$$
Y = [\mathbf{z}_1, \mathbf{z}_2, \dots, \mathbf{z}_{m-1}] \in \mathbb{R}^{n \times (m-1)}
$$

线性演化假设可以写成矩阵形式 $Y \approx AX$。标准 DMD 算法通过求解一个[最小二乘问题](@entry_id:164198)来寻找算子 $A$，即最小化 $A$ 在所有快照对上演化误差的 Frobenius 范数：

$$
\min_{A} \|Y - AX\|_{F}^2
$$

这个问题的解由下式给出：

$$
A = Y X^{+}
$$

其中 $X^{+}$ 是 $X$ 的 Moore-Penrose [伪逆](@entry_id:140762)。矩阵 $A$ 是一个有限维的[线性算子](@entry_id:149003)，它最佳地近似了快照数据所蕴含的动力学。一旦获得了 $A$，我们就可以通过其[特征值分解](@entry_id:272091)来分析系统的行为。

### Koopman 算子：DMD 的理论基石

虽然 DMD 算法本身是一个纯粹的数据驱动过程，但其有效性可以从动力系统理论中的 Koopman 算子框架中得到深刻的解释。对于一个由流映射 $\Phi^t$ 描述的动力系统 $\mathbf{z}(t) = \Phi^t(\mathbf{z}(0))$，Koopman 算子 $U^t$ 作用于[状态空间](@entry_id:160914)上的标量函数（称为**[可观测量](@entry_id:267133)** (observables) $g$），而不是状态向量本身。其作用定义为与流映射的复合：

$$
(U^t g)(\mathbf{z}) = g(\Phi^t(\mathbf{z}))
$$

这个定义的精妙之处在于，即使底层动力学 $\Phi^t$ 是[非线性](@entry_id:637147)的，作用于无限维可观测[函数空间](@entry_id:143478)的 Koopman 算子 $U^t$ 却是线性的。DMD 可以被看作是 Koopman 算子 $U^{\Delta t}$ 在一个由所选可观测量张成的有限维子空间上的投影或近似 。

DMD 的成功在很大程度上取决于[可观测量](@entry_id:267133)的选择。如果我们选择的[可观测量](@entry_id:267133)张成的子空间在 Koopman 算子的作用下是**不变**的（即子空间中的任何函数经过 $U^{\Delta t}$ 演化后仍在子空间内），那么 DMD 就能精确地捕捉该子空间上的动力学。对于许多热流问题，例如接近[对流起始](@entry_id:261229)状态的[瑞利-贝纳德对流](@entry_id:151811) (Rayleigh-Bénard convection)，[系统动力学](@entry_id:136288)可以用围绕传导基态的线性化方程很好地描述。在这种近[线性区](@entry_id:1127283)域，由原始[状态变量](@entry_id:138790)（如网格点上的温度和速度分量）构成的线性可观测量张成的子空间近似于一个 Koopman [不变子空间](@entry_id:152829)。因此，直接对原始速度和温度快照应用 DMD 是合理且有效的，它能一致地近似受限的 Koopman 算子及其主导模式 。

综上所述，DMD 的特征值 $\lambda_j$ 近似了离散时间 Koopman 算子 $U^{\Delta t}$ 的特征值，而 DMD 模式则是相应 Koopman 特征函数在所选可观测基上的表示。这种近似的一致性依赖于几个关键条件：系统必须是自治的（演化规律不随时间改变），快照必须以均匀的时间间隔采样，并且数据必须足够丰富，能够捕捉到主导的 Koopman 模式 。当一个流动接近稳定平衡点或[极限环](@entry_id:274544)时，其动力学通常由少数几个 Koopman 模式主导，这使得 DMD 在这些物理情境下尤为有效 。

### DMD 谱：分解热动力学

DMD 的核心输出是算子 $A$ 的[特征分解](@entry_id:181333)，它产生一组特征值 $\lambda_j$ 和相应的[特征向量](@entry_id:151813) $\boldsymbol{\phi}_j$，即 DMD 模式。每一个特征对 $(\lambda_j, \boldsymbol{\phi}_j)$ 都代表了一个具有固定空间结构和简单时间演化的**动态模式**。

*   **DMD 模式 $\boldsymbol{\phi}_j$**：一个复值向量，描述了该模式在空间中的形态和相位分布。
*   **DMD 特征值 $\lambda_j$**：一个复数，编码了该模式在每个离散时间步 $\Delta t$ 内的时间行为。

为了获得与物理过程更直接相关的连续时间演化规律，我们将离散时间特征值 $\lambda_j$ 映射到连续时间特征值 $\omega_j$：

$$
\lambda_j = \exp(\omega_j \Delta t)
$$

这揭示了 DMD 的一个基本假设：系统动力学可以分解为一系列模式的总和，每个模式都遵循[指数时间](@entry_id:265663)演化规律 $e^{\omega_j t}$。这种指数形式的假设并非任意，它在物理上是合理的。对于围绕稳定[平衡态](@entry_id:270364)（[定常流](@entry_id:191654)动）的微小扰动，线性化后的控制方程是一个[线性时不变 (LTI) 系统](@entry_id:178866)，其解正是指数函数的叠加。对于围绕周期性[吸引子](@entry_id:270989)（如极限环）的扰动，Floquet 理论表明其解也是由[周期函数](@entry_id:139337)乘以指数项构成，这同样可以分解为纯指数模式的和。因此，DMD 的[指数时间](@entry_id:265663)模型为分析[热流场](@entry_id:1133000)中的稳定性和振荡行为提供了坚实的理论基础 。

复数 $\omega_j$ 可以分解为实部和虚部，$\omega_j = \sigma_j + i f_j$，它们各自具有明确的物理意义：

*   **增长/衰减率 $\sigma_j = \Re(\omega_j)$**：描述了模式振幅随时间的指数变化。若 $\sigma_j > 0$，模式不稳定并增长；若 $\sigma_j  0$，模式稳定并衰减；若 $\sigma_j = 0$，模式振幅保持不变。在热流中，负的 $\sigma_j$ 通常与耗散过程相关，例如由热扩散或粘性引起的阻尼。对于一个纯[扩散过程](@entry_id:268015)，其衰减率与波数 $k$ 的平方成正比，即 $\sigma \approx -\alpha k^2$，其中 $\alpha$ 是[热扩散](@entry_id:148740)系数 。

*   **[振荡频率](@entry_id:269468) $f_j = \Im(\omega_j)$**：描述了模式的振荡行为。非零的 $f_j$ 对应于物理世界中的振荡现象，如涡旋脱落、[热羽流](@entry_id:156277)的摆动或内部重力波。例如，在稳定的热[分层流体](@entry_id:181098)中，[浮力](@entry_id:154088)作为恢复力会引起振荡，其[特征频率](@entry_id:911376)由 Brunt-Väisälä 频率 $N = \sqrt{g\beta(d\bar{T}/dz)}$ 决定。DMD 能够准确地识别出接近此频率的振荡模式，并将其与[浮力](@entry_id:154088)驱动的物理机制联系起来 。

### 解释 DMD 模式和特征值

#### 振荡模式与[复共轭](@entry_id:174690)对

由于[热流场](@entry_id:1133000)的快照数据是实值的，DMD 算子 $A$ 也是一个实矩阵。线性代数的一个基本定理是，实矩阵的任何非实数特征值都必须以**[复共轭](@entry_id:174690)对**的形式出现。这意味着，如果 $\lambda_j$ 是一个特征值，那么它的[复共轭](@entry_id:174690) $\bar{\lambda}_j$ 也必然是特征值，并且对应的 DMD 模式也是共轭的，即 $\boldsymbol{\phi}_j$ 和 $\bar{\boldsymbol{\phi}}_j$。

一个单独的[复数模](@entry_id:167344)式会导致一个复数场，这在物理上是没有意义的。一个真实的物理振荡是通过将这对共轭模式线性组合来重构的。这种组合会产生一个随时间演化的实值余弦函数。特征值 $\lambda_j$ 的**模长 $|\lambda_j|$** 决定了振荡的增长或衰减（$|\lambda_j| > 1$ 增长，$|\lambda_j|  1$ 衰减），而其**辐角 $\arg(\lambda_j)$** 决定了振荡的频率 。

考虑一个经典的例子：流过一个加热圆柱体。在圆柱体后方会周期性地脱落涡旋和相应的[热羽流](@entry_id:156277)。这是一个由对流主导的振荡现象。DMD 分析会识别出一个[复共轭](@entry_id:174690)特征值对。该特征值的辐角 $\arg(\lambda_j)$ 与[涡旋脱落](@entry_id:138573)的频率直接相关。同时，由于[热扩散](@entry_id:148740)的存在，向下游传播的[热羽流](@entry_id:156277)会逐渐耗散，其能量会衰减。这一物理过程体现在特征值的模长上，即 $|\lambda_j|  1$。因此，DMD 特征值定量地将对流（振荡）和扩散（阻尼）这两种基本的输运机制编码在一起 。

#### 模式的[非正交性](@entry_id:192553)与对流现象

与旨在寻找能量最优**正交**基的 POD 不同，DMD 产生的模式通常是**非正交**的 。这种非正交性并非 DMD 的缺陷，而是其捕捉某些关键物理现象能力的体现。DMD 模式是近似动力学算子 $A$ 的[特征向量](@entry_id:151813)。在许多开放的热流系统中（例如，具有明确入口和出口的边界层流动），强烈的对流项使得算子 $A$ 成为一个**[非正规算子](@entry_id:752588)**（即 $A A^* \neq A^* A$）。[非正规算子](@entry_id:752588)的[特征向量](@entry_id:151813)通常不是正交的 。

这种[非正交性](@entry_id:192553)具有重要的物理意义。在对流不稳定的流动中（如加[热边界层](@entry_id:147903)中的扰动），初始微小的扰动在向下游传播时会经历显著的**[瞬时增长](@entry_id:263654)**，形成空间局域化的[波包](@entry_id:154698)，即使系统的所有本征模式最终都是衰减的。这种现象正是由非正交模式的相长干涉引起的。DMD 的非正交模式基能够有效地表示这种干涉效应，从而捕捉到对流[波包](@entry_id:154698)的形成和传播。因此，模式的[非正交性](@entry_id:192553)是 DMD 能够准确描述对流主导的热流现象的关键特征 。

### 高级主题与实践考量

#### 处理非定常平均态

在许多实验或模拟中，系统的平均状态可能不是严格稳定的，而是会随时间缓慢漂移。例如，在对一个腔体进行缓慢加热的实验中，背景温度场会逐渐升高。这种漂移违反了标准 DMD 假设的线性自治动力学，实际上系统变成了一个[仿射系统](@entry_id:634107) $ \mathbf{z}_{k+1} \approx A_* \mathbf{z}_k + \mathbf{b}_k $，其中 $\mathbf{b}_k$ 是一个缓慢变化的偏置项。

直接将标准 DMD 应用于这[类数](@entry_id:156164)据会导致问题。漂移的巨大能量会产生一个特征值接近 $1$（对应于零频率）的虚假主导模式，从而掩盖真实的物理动力学。为了正确分析，必须采用更先进的处理方法。简单地减去一个全局[时间平均](@entry_id:267915)值是不够的，因为这不能消除时变的偏置项。正确的做法包括：

1.  **[状态增广](@entry_id:140869)**：通过在[状态向量](@entry_id:154607)中增加一个常数 $1$（即 $\hat{\mathbf{z}}_k = [\mathbf{z}_k^T, 1]^T$），将[仿射系统](@entry_id:634107)转化为一个更高维度的[线性系统](@entry_id:147850)。DMD 应用于增广后的状态，可以有效地将漂移（或恒定输入）的影响分离出来。

2.  **带控制的 DMD (DMDc)**：如果漂移是由已知的外部输入（如加热功率的变化）引起的，可以将此输入作为控制信号纳入 DMD 模型中。DMDc 会同时辨识出内在动力学矩阵 $A$ 和输入矩阵 $B$，从而得到一个无偏的动力学模型。

对于 POD 分析，同样需要谨慎处理漂移。为了研究围绕瞬时平均态的真实脉动，应当减去一个时变平均值（例如通过移动平均或低通滤波获得），而不是全局平均值 。

#### 分[解的唯一性](@entry_id:143619)

DMD 模式和特征值的唯一性是一个微妙的数学问题。一个 DMD 模式集合的唯一性（在不考虑缩放和排序的情况下）取决于动力学算子 $\tilde{A}$（在快照子空间上的投影）的谱特性。

*   **简单谱**：如果算子 $\tilde{A}$ 的所有特征值都是互不相同的（即具有简单谱），那么每个特征值对应一个一维的特征空间。在这种情况下，DMD 模式的集合是唯一的 。

*   **简并谱**：如果算子存在[重根](@entry_id:151486)特征值（即简并），那么该特征值对应的特征空间维度将大于一。这意味着任何构成该子空间基的向量组合都是有效的[特征向量](@entry_id:151813)。因此，DMD 模式的选取不再唯一。这种情况可能出现在具有高度对称性的系统中。

*   **[亏损矩阵](@entry_id:184234)**：在极少数情况下，算子可能是亏损的（即[特征向量](@entry_id:151813)不足以张成整个空间）。此时需要使用[广义特征向量](@entry_id:152349)来构成基，其选择同样不唯一。

在实践中，只要数据能够充分激发系统的不同动力学模式，并且不存在高度的对称性，所得到的 DMD 模式通常被认为是具有物理意义的、鲁棒的结构，即使在数学上存在一定的选择自由度 。