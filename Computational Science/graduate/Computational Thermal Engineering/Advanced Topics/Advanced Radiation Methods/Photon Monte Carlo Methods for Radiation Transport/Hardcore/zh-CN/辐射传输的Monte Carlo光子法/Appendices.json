{
    "hands_on_practices": [
        {
            "introduction": "光子蒙特卡洛模拟的核心在于根据特定的概率分布函数（PDF）对光子的行为（如散射方向）进行随机抽样。对于简单的PDF，可以直接使用逆变换采样法。然而，在处理如各向异性散射等更复杂的情况时，我们需要更通用的工具。本练习  将引导您探索接受-拒绝采样法，这是一种强大而直观的技术。您将推导该方法的采样效率，并将其应用于一个非平凡的物理散射模型，从而掌握生成任意随机变量的核心技能。",
            "id": "3978788",
            "problem": "考虑在一个具有各向异性散射的参与介质中，使用 Monte Carlo 辐射传输 (MCRT) 方法进行的光子输运模拟。您希望使用接受–拒绝法从一个定义在域 $D$ 上的目标角分布中采样。设定义在 $D$ 上的非负目标函数为 $f(x)$，其积分为有限值 $\\int_{D} f(x)\\,dx$，并构造包络函数 $h(x) = M\\,g(x)$，其中 $g(x)$ 是一个归一化的提议概率密度函数 (PDF)，满足 $\\int_{D} g(x)\\,dx = 1$，且 $M \\geq \\sup_{x \\in D} \\frac{f(x)}{g(x)}$ 确保对所有 $x \\in D$ 都有 $h(x) \\geq f(x)$。在接受–拒绝法中，一个样本 $X \\sim g$ 会以概率 $\\frac{f(X)}{h(X)}$ 被接受，这通过使用一个独立于 $X$ 的辅助变量 $U \\sim \\mathrm{Uniform}(0,1)$ 来实现。从这些定义出发，推导平均接受概率（效率）$\\eta$，用目标积分 $\\int_{D} f(x)\\,dx$ 与包络积分 $\\int_{D} h(x)\\,dx$ 的比值来表示。\n\n然后，将您的结果应用于对以下非平凡的方位对称各向异性散射分布进行采样：\n$$\np(\\mu) = \\frac{\\beta}{2\\,\\sinh(\\beta)}\\,\\exp(\\beta\\,\\mu), \\quad \\mu \\in [-1,1],\n$$\n其中 $\\mu = \\cos(\\theta)$，$\\theta$ 是以弧度为单位的极向散射角，$\\beta  0$ 是给定的各向异性参数。使用在 $[-1,1]$ 上的均匀提议分布 $g(\\mu) = \\frac{1}{2}$，并选择最小常数 $M$ 使得对所有 $\\mu \\in [-1,1]$ 都有 $p(\\mu) \\leq M\\,g(\\mu)$。计算当 $\\beta = 3$ 时，由此产生的接受–拒绝效率 $\\eta$。将效率表示为无量纲小数，并将您的答案四舍五入到五位有效数字。此外，请陈述本案例下的具体接受规则 $U \\leq \\frac{p(\\mu)}{M\\,g(\\mu)}$，但您最终报告的量必须仅为效率值。",
            "solution": "该问题经验证具有科学依据、良定、客观且完整。这是一个计算统计学和物理学中的标准问题，可以进行严格求解。\n\n解答过程分为两部分。首先，我们推导接受-拒绝法效率的通用表达式。其次，我们将此结果应用于各向异性散射分布的特定情况。\n\n第 1 部分：效率的通用推导\n\n接受-拒绝法旨在从定义在域 $D$ 上、密度为 $f(x)$ 的目标分布中抽取样本。我们在同一定义域上使用一个更简单的提议概率密度函数 (PDF) $g(x)$，其满足 $\\int_{D} g(x)\\,dx = 1$。构造一个包络函数 $h(x) = M\\,g(x)$，使得对于所有 $x \\in D$ 都有 $h(x) \\geq f(x)$。常数 $M$ 的选择要至少为比值 $f(x)/g(x)$ 的上确界，即 $M \\geq \\sup_{x \\in D} \\frac{f(x)}{g(x)}$。\n\n采样算法按以下步骤进行：\n1. 从提议分布中抽取一个候选样本，我们将其表示为随机变量 $X$，其 PDF 为 $g(x)$。\n2. 从区间 $[0, 1]$ 上的均匀分布中抽取一个辅助随机变量 $U$，即 $U \\sim \\mathrm{Uniform}(0,1)$。\n3. 如果满足条件 $U \\leq \\frac{f(X)}{h(X)}$，则接受候选样本 $X$。\n\n在给定特定值 $X=x$ 的条件下，接受一个候选样本的概率是条件概率 $P(\\text{accept}|X=x)$。由于 $U$ 在 $[0,1]$ 上均匀分布，该概率等于不等式的上界值：\n$$\nP(\\text{accept}|X=x) = P\\left(U \\leq \\frac{f(x)}{h(x)}\\right) = \\frac{f(x)}{h(x)}\n$$\n条件 $M \\geq \\sup_{x \\in D} \\frac{f(x)}{g(x)}$ 意味着 $M\\,g(x) \\geq f(x)$，因此 $h(x) \\geq f(x)$，这确保了比值 $\\frac{f(x)}{h(x)}$ 始终在区间 $[0, 1]$ 内。\n\n总接受概率（即效率 $\\eta$）是该条件概率在 $X$ 所有可能取值上的均值。为求此均值，我们计算 $P(\\text{accept}|X)$ 关于 $X$ 的分布（即 $g(x)$）的期望。\n$$\n\\eta = E[P(\\text{accept}|X)] = \\int_{D} P(\\text{accept}|X=x) \\, g(x) \\, dx\n$$\n代入条件概率的表达式，我们得到：\n$$\n\\eta = \\int_{D} \\frac{f(x)}{h(x)} \\, g(x) \\, dx\n$$\n现在，我们代入包络函数的定义 $h(x) = M\\,g(x)$：\n$$\n\\eta = \\int_{D} \\frac{f(x)}{M\\,g(x)} \\, g(x) \\, dx = \\int_{D} \\frac{f(x)}{M} \\, dx\n$$\n由于 $M$ 是一个常数，可以将其移到积分符号外：\n$$\n\\eta = \\frac{1}{M} \\int_{D} f(x) \\, dx\n$$\n包络函数 $h(x)$ 在域 $D$ 上的积分是：\n$$\n\\int_{D} h(x) \\, dx = \\int_{D} M \\, g(x) \\, dx = M \\int_{D} g(x) \\, dx\n$$\n由于 $g(x)$ 是一个归一化的 PDF，所以 $\\int_{D} g(x) \\, dx = 1$。因此，$\\int_{D} h(x) \\, dx = M$。\n将 $M = \\int_{D} h(x) \\, dx$ 代入 $\\eta$ 的表达式，我们得到最终的通用结果：\n$$\n\\eta = \\frac{\\int_{D} f(x) \\, dx}{\\int_{D} h(x) \\, dx}\n$$\n这表明效率是目标函数下方“面积”与包络函数下方“面积”的比值。\n\n第 2 部分：在各向异性散射中的应用\n\n我们现在将此结果应用于指定的问题。目标函数是散射 PDF $p(\\mu)$，提议分布是均匀 PDF $g(\\mu)$。\n目标函数：$f(\\mu) \\equiv p(\\mu) = \\frac{\\beta}{2\\,\\sinh(\\beta)}\\,\\exp(\\beta\\,\\mu)$，对于 $\\mu \\in [-1,1]$。\n提议 PDF：$g(\\mu) = \\frac{1}{2}$，对于 $\\mu \\in [-1,1]$。\n\n目标函数的积分是 $\\int_{-1}^{1} p(\\mu) \\, d\\mu$。由于 $p(\\mu)$ 是一个 PDF，我们知道它在其定义域上的积分为 1：\n$$\n\\int_{-1}^{1} p(\\mu) \\, d\\mu = \\int_{-1}^{1} \\frac{\\beta}{2\\,\\sinh(\\beta)}\\,\\exp(\\beta\\,\\mu) \\, d\\mu = \\frac{\\beta}{2\\,\\sinh(\\beta)} \\left[ \\frac{\\exp(\\beta\\mu)}{\\beta} \\right]_{-1}^{1} = \\frac{\\exp(\\beta) - \\exp(-\\beta)}{2\\,\\sinh(\\beta)} = \\frac{2\\,\\sinh(\\beta)}{2\\,\\sinh(\\beta)} = 1\n$$\n因此，我们效率公式中的分子是 $\\int_{-1}^{1} p(\\mu) \\, d\\mu = 1$。\n\n接下来，我们必须找到最小常数 $M$，使得对所有 $\\mu \\in [-1,1]$ 都有 $p(\\mu) \\leq M\\,g(\\mu)$。这个最小的 $M$ 是比值 $p(\\mu)/g(\\mu)$ 的上确界：\n$$\nM = \\sup_{\\mu \\in [-1,1]} \\frac{p(\\mu)}{g(\\mu)} = \\sup_{\\mu \\in [-1,1]} \\frac{\\frac{\\beta}{2\\,\\sinh(\\beta)}\\,\\exp(\\beta\\,\\mu)}{\\frac{1}{2}} = \\sup_{\\mu \\in [-1,1]} \\frac{\\beta}{\\sinh(\\beta)}\\,\\exp(\\beta\\,\\mu)\n$$\n由于 $\\beta  0$，函数 $\\exp(\\beta\\mu)$ 随 $\\mu$ 单调递增。因此，它在区间 $[-1,1]$ 上的上确界出现在 $\\mu = 1$ 处。\n$$\nM = \\frac{\\beta}{\\sinh(\\beta)}\\,\\exp(\\beta \\cdot 1) = \\frac{\\beta\\,\\exp(\\beta)}{\\sinh(\\beta)}\n$$\n现在可以使用我们推导出的公式来计算效率 $\\eta$：\n$$\n\\eta = \\frac{\\int_{-1}^{1} p(\\mu) \\, d\\mu}{M} = \\frac{1}{M} = \\frac{1}{\\frac{\\beta\\,\\exp(\\beta)}{\\sinh(\\beta)}} = \\frac{\\sinh(\\beta)}{\\beta\\,\\exp(\\beta)}\n$$\n为简化表达式，我们使用定义 $\\sinh(\\beta) = \\frac{\\exp(\\beta) - \\exp(-\\beta)}{2}$：\n$$\n\\eta = \\frac{\\frac{\\exp(\\beta) - \\exp(-\\beta)}{2}}{\\beta\\,\\exp(\\beta)} = \\frac{\\exp(\\beta) - \\exp(-\\beta)}{2\\beta\\,\\exp(\\beta)} = \\frac{1}{2\\beta} \\left( \\frac{\\exp(\\beta)}{\\exp(\\beta)} - \\frac{\\exp(-\\beta)}{\\exp(\\beta)} \\right) = \\frac{1}{2\\beta} (1 - \\exp(-2\\beta))\n$$\n问题指定 $\\beta = 3$。代入此值：\n$$\n\\eta = \\frac{1}{2(3)} (1 - \\exp(-2 \\cdot 3)) = \\frac{1}{6} (1 - \\exp(-6))\n$$\n我们现在计算其数值：\n$\\exp(-6) \\approx 0.00247875217$\n$1 - \\exp(-6) \\approx 0.99752124783$\n$\\eta \\approx \\frac{0.99752124783}{6} \\approx 0.1662535413$\n\n将结果四舍五入到五位有效数字，得到 $\\eta \\approx 0.16625$。\n\n最后，特定的接受规则 $U \\leq \\frac{p(\\mu)}{M\\,g(\\mu)}$ 是：\n$$\nU \\leq \\frac{\\frac{\\beta}{2\\,\\sinh(\\beta)}\\,\\exp(\\beta\\,\\mu)}{\\left(\\frac{\\beta\\,\\exp(\\beta)}{\\sinh(\\beta)}\\right) \\left(\\frac{1}{2}\\right)} = \\frac{\\exp(\\beta\\,\\mu)}{\\exp(\\beta)} = \\exp(\\beta(\\mu-1))\n$$\n对于 $\\beta=3$，该规则为 $U \\leq \\exp(3(\\mu-1))$。一个被接受的 $\\mu$ 值将服从 $p(\\mu)$ 分布。\n\n要求的最终答案是效率 $\\eta$ 的数值。",
            "answer": "$$\n\\boxed{0.16625}\n$$"
        },
        {
            "introduction": "开发任何数值模拟方法的关键一步是使用已知解析解的基准案例对其进行验证。这种对比不仅能确保我们算法的正确性，还能深刻揭示随机模拟如何逼近确定性理论。本练习  将带您从第一性原理出发，直接求解辐射传输方程（RTE），推导出等温吸收性平板的精确辐射通量。通过理解这个解析解，您将能体会到蒙特卡洛方法是如何通过模拟大量光子随机路径，最终在宏观上收敛于这一确定性结果的。",
            "id": "3978773",
            "problem": "考虑一个厚度为 $L$ 的一维、平面平行均匀平板，其中充满了温度均匀（为 $T_{m}$）、折射率为 $n=1$ 的灰体、纯吸收、非散射介质。吸收系数为 $\\kappa$（与位置和方向无关）。该平板由完全透射、不反射的平面界面界定，并被冷真空所包围，因此没有外部辐射入射到平板上。介质处于局部热力学平衡 (LTE) 状态，其各向同性发射由黑体强度 $B(T_{m})$ 表征，其中 $B(T)=\\sigma T^{4}/\\pi$，$\\sigma$ 是 Stefan–Boltzmann 常数。\n\n从一维平面平行介质中的稳态辐射传输方程 (RTE) 出发，其中角度依赖性由相对于外法线的方向余弦 $\\mu=\\cos\\theta$ 描述，推导出沿外法线方向从边界出射的、依赖于角度的比辐射强度。然后，进行角度积分以获得该边界处的半球发射辐射通量。您的推导必须仅使用第一性原理（RTE、基于 LTE 的发射和边界条件）和标准定义。定义您使用的任何特殊函数。\n\n为了与蒙特卡洛 (MC) 基于路径的传输（蒙特卡洛方法）联系起来，请简要解释所推导的解析表达式如何编码了基于光子的 MC 算法在这种纯吸收介质中会进行抽样的指数路径衰减和累积发射贡献。\n\n将您的最终结果表示为离开平板一个面的半球发射辐射通量 $M^{+}$（单位 $\\mathrm{W}\\,\\mathrm{m}^{-2}$）的单一闭式解析表达式，该表达式用 $\\sigma$、$T_{m}$、$\\kappa$、$L$ 和任何必要的特殊函数表示。不要进行数值计算。最终答案必须是单一的解析表达式。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。这是一个在计算热工学领域，特别是关于辐射传热方面，有科学依据、适定且客观的问题。所有必要信息均已提供，且其前提与物理学的基本原理一致。\n\n该问题要求从一个一维、等温、纯吸收的平板推导出半球发射辐射通量。推导从平面平行介质的稳态辐射传输方程 (RTE) 开始。\n\n一维稳态 RTE 由下式给出：\n$$\n\\mu \\frac{dI(z, \\mu)}{dz} = -\\beta I(z, \\mu) + S(z, \\mu)\n$$\n其中 $I(z, \\mu)$ 是在空间位置 $z$ 处、由方向余弦 $\\mu = \\cos\\theta$ 指定方向上的比辐射强度。角度 $\\theta$ 是相对于 z 轴正方向测量的。消光系数为 $\\beta$，$S(z, \\mu)$ 是源函数。\n\n根据问题陈述，我们有：\n1.  灰体、纯吸收、非散射介质。这意味着散射系数为零，因此消光系数 $\\beta$ 等于吸收系数 $\\kappa$，即 $\\beta = \\kappa$。\n2.  介质处于局部热力学平衡 (LTE) 状态，温度均匀为 $T_m$。因此，源函数 $S$ 仅由热发射引起，并且是各向同性的。它由 Kirchhoff 定律给出：$S = \\kappa I_b(T_m)$，其中 $I_b(T_m)$ 是 Planck 黑体强度函数。问题中将其表示为 $B(T_m) = \\frac{\\sigma T_m^4}{\\pi}$。\n\n将这些条件代入 RTE，得到：\n$$\n\\mu \\frac{dI(z, \\mu)}{dz} = -\\kappa I(z, \\mu) + \\kappa B(T_m)\n$$\n这是一个关于 $I$ 作为 $z$ 的函数的一阶线性常微分方程。我们可以通过重新整理并使用积分因子来求解。对于常数 $\\mu \\neq 0$：\n$$\n\\frac{dI}{dz} + \\frac{\\kappa}{\\mu} I = \\frac{\\kappa}{\\mu} B(T_m)\n$$\n积分因子是 $\\exp(\\int \\frac{\\kappa}{\\mu} dz) = \\exp(\\frac{\\kappa z}{\\mu})$。用该因子乘以方程，得到：\n$$\n\\frac{d}{dz} \\left( I \\exp(\\frac{\\kappa z}{\\mu}) \\right) = \\frac{\\kappa}{\\mu} B(T_m) \\exp(\\frac{\\kappa z}{\\mu})\n$$\n对 $z$ 积分，得到：\n$$\nI(z, \\mu) \\exp(\\frac{\\kappa z}{\\mu}) = \\int \\frac{\\kappa}{\\mu} B(T_m) \\exp(\\frac{\\kappa z}{\\mu}) dz = B(T_m) \\exp(\\frac{\\kappa z}{\\mu}) + C(\\mu)\n$$\n其中 $C(\\mu)$ 是一个可以依赖于方向 $\\mu$ 的积分常数。强度的通解是：\n$$\nI(z, \\mu) = B(T_m) + C(\\mu) \\exp(-\\frac{\\kappa z}{\\mu})\n$$\n为了求出常数 $C(\\mu)$，我们应用边界条件。平板占据区域 $z \\in [0, L]$，并被冷真空包围，这意味着没有外部辐射入射到其边界上。\n我们关心的是从边界（例如 $z=L$）出射的辐射。外法线方向为 z 轴正方向，对应于方向 $\\mu  0$。对于这个方向范围，边界条件在 $z=0$ 处，那里没有入射辐射。因此，对于 $\\mu \\in (0, 1]$：\n$$\nI(0, \\mu) = 0\n$$\n将此条件应用于通解：\n$$\nI(0, \\mu) = B(T_m) + C(\\mu) \\exp(0) = 0 \\implies C(\\mu) = -B(T_m)\n$$\n将此代回，我们得到平板内方向为 $\\mu  0$ 的比辐射强度：\n$$\nI(z, \\mu) = B(T_m) - B(T_m) \\exp(-\\frac{\\kappa z}{\\mu}) = B(T_m) \\left( 1 - \\exp(-\\frac{\\kappa z}{\\mu}) \\right)\n$$\n问题要求的是沿外法线方向从边界出射的、依赖于角度的比辐射强度。在边界 $z=L$ 处，对于方向 $\\mu  0$，此强度为：\n$$\nI(L, \\mu) = B(T_m) \\left( 1 - \\exp(-\\frac{\\kappa L}{\\mu}) \\right) \\quad \\text{for } \\mu  0\n$$\n接下来，我们计算离开 $z=L$ 面的半球发射辐射通量 $M^+$。这是通过将出射强度的法向分量 $I(L, \\mu) \\mu$ 在出射半球 ($2\\pi^+$) 上积分得到的：\n$$\nM^+ = \\int_{2\\pi^+} I(L, \\mu) \\mu \\, d\\Omega\n$$\n在球坐标系中，立体角元为 $d\\Omega = \\sin\\theta d\\theta d\\phi = -d\\mu d\\phi$。积分是对从 $0$ 到 $2\\pi$ 的方位角 $\\phi$ 和从 $0$ 到 $\\pi/2$ 的极角 $\\theta$ 进行的。这对应于 $\\mu$ 从 $1$ 到 $0$。由于方位对称性，对 $\\phi$ 的积分产生一个因子 $2\\pi$。\n$$\nM^+ = \\int_0^{2\\pi} d\\phi \\int_0^1 I(L, \\mu) \\mu \\, d\\mu = 2\\pi \\int_0^1 I(L, \\mu) \\mu \\, d\\mu\n$$\n代入 $I(L, \\mu)$ 的表达式：\n$$\nM^+ = 2\\pi \\int_0^1 B(T_m) \\left( 1 - \\exp(-\\frac{\\kappa L}{\\mu}) \\right) \\mu \\, d\\mu\n$$\n由于 $B(T_m)$ 相对于 $\\mu$ 是常数，我们可以将其提出：\n$$\nM^+ = 2\\pi B(T_m) \\int_0^1 \\left( \\mu - \\mu \\exp(-\\frac{\\kappa L}{\\mu}) \\right) d\\mu\n$$\n该积分可以分为两部分：\n$$\n\\int_0^1 \\mu \\, d\\mu = \\left[ \\frac{\\mu^2}{2} \\right]_0^1 = \\frac{1}{2}\n$$\n积分的第二部分涉及指数积分函数。n 阶指数积分函数 $E_n(x)$ 定义为：\n$$\nE_n(x) = \\int_0^1 u^{n-2} \\exp\\left(-\\frac{x}{u}\\right) du\n$$\n我们需要计算的积分是 $\\int_0^1 \\mu \\exp(-\\frac{\\kappa L}{\\mu}) d\\mu$。设平板的光学厚度为 $\\tau_L = \\kappa L$。该积分为 $\\int_0^1 \\mu \\exp(-\\tau_L/\\mu) d\\mu$。将其与 $u=\\mu$ 和 $x=\\tau_L$ 的 $E_n(x)$ 定义进行比较，我们看到 $u$（即 $\\mu$）的指数为 $1$。所以，$n-2=1$，即 $n=3$。因此：\n$$\n\\int_0^1 \\mu \\exp(-\\frac{\\kappa L}{\\mu}) d\\mu = E_3(\\kappa L)\n$$\n结合积分结果：\n$$\n\\int_0^1 \\left( \\mu - \\mu \\exp(-\\frac{\\kappa L}{\\mu}) \\right) d\\mu = \\frac{1}{2} - E_3(\\kappa L)\n$$\n将此代回通量 $M^+$ 的表达式中：\n$$\nM^+ = 2\\pi B(T_m) \\left( \\frac{1}{2} - E_3(\\kappa L) \\right) = \\pi B(T_m) \\left( 1 - 2E_3(\\kappa L) \\right)\n$$\n最后，使用给定的黑体强度表达式 $B(T_m) = \\frac{\\sigma T_m^4}{\\pi}$：\n$$\nM^+ = \\pi \\left( \\frac{\\sigma T_m^4}{\\pi} \\right) \\left( 1 - 2E_3(\\kappa L) \\right) = \\sigma T_m^4 \\left( 1 - 2E_3(\\kappa L) \\right)\n$$\n这就是半球发射辐射通量的最终闭式解析表达式。\n\n为了将其与光子蒙特卡洛 (MC) 方法联系起来，我们考察推导出的强度表达式的物理意义。强度方程 $I(L, \\mu) = \\int_0^L \\kappa B(T_m) \\exp(-\\kappa(L-z)/\\mu) \\frac{dz}{\\mu}$ 代表了平板内所有体积微元发射的总和。在此积分中：\n1.  项 $\\kappa B(T_m)$ 是单位立体角的体积能量发射率。在 MC 模拟中，该项决定了在某一位置产生光子“包”的概率。\n2.  项 $\\exp(-\\kappa(L-z)/\\mu)$ 是透射率，表示在深度 $z$ 处发射、沿长度为 $s=(L-z)/\\mu$ 的路径传播的光子到达边界 $z=L$ 而不被吸收的概率。在 MC 算法中，这种指数衰减是通过从概率分布 $f(s')=\\kappa \\exp(-\\kappa s')$ 中为光子抽样一个随机路径长度 $s'$ 来模拟的。如果其抽样路径长度 $s'$ 大于到边界的几何距离 $s=(L-z)/\\mu$，则光子逃逸。此事件的概率恰好是 $\\exp(-\\kappa s)$。\n\n因此，解析解代表了对所有可能的发射位置和方向上的这些发射概率和存活概率的精确、连续积分。MC 方法通过对大量单个光子生命史（发射、路径遍历和吸收/逃逸）进行统计抽样，提供了对同一积分的数值估计。涉及特殊函数 $E_3(\\kappa L)$ 的通量 $M^+$ 的最终表达式，是这些微观、概率性光子传输事件的宏观、确定性结果。",
            "answer": "$$\\boxed{\\sigma T_{m}^{4} \\left( 1 - 2E_{3}(\\kappa L) \\right)}$$"
        },
        {
            "introduction": "蒙特卡洛模拟的原始输出只是一个统计估计值；其科学价值在于我们对其统计不确定性的理解。没有误差棒的模拟结果是不完整的。本练习  将应用统计学的基石——中心极限定理——来量化模拟结果的不确定性。您将学习如何为模拟量构建置信区间，并估算达到预定精度所需的模拟次数，这是任何蒙特卡洛研究者在规划模拟和报告结果时都必须掌握的基本技能。",
            "id": "3978764",
            "problem": "使用单色光子蒙特卡罗模拟来估计一个标量辐射量，具体来说是一个嵌入在吸收、发射且非散射介质中的灰体等温表面元所发出的半球漫射辐射热通量。每个模拟的光子历史都会产生一个独立的分数 $X$，该分数被计入通量估计量的总和中，而真实通量 $Q$ 是分数 $X$ 的期望 $\\mathbb{E}[X]$。假设分数 $X$ 是独立同分布的（i.i.d.），具有有限二阶矩，并且 $Q$ 的估计量是样本均值 $\\hat{Q}_{M} = \\frac{1}{M} \\sum_{i=1}^{M} X_{i}$。一次包含 $M_{0} = 2.00 \\times 10^{5}$ 个光子历史的试点运行，得到分数的样本均值为 $\\hat{\\mu} = 1.80 \\times 10^{4} \\text{ W/m}^{2}$，样本标准差为 $\\hat{\\sigma} = 5.40 \\times 10^{5} \\text{ W/m}^{2}$。\n\n仅使用第一性原理和标准的渐近结果，回答以下问题：\n- 使用中心极限定理（CLT），为真实通量 $Q$ 构建一个双侧 $95\\%$ 置信区间（单位为 $\\text{W/m}^{2}$）。\n- 使用相同的CLT框架，并将试点统计数据作为方差的替代值，确定为在 $95\\%$ 置信水平下达到指定的相对置信半宽 $\\varepsilon_{r} = 0.050$ 所需的最少光子历史总数 $N$。\n\n将所有最终数值答案四舍五入至四位有效数字。置信区间的界限以 $\\text{W/m}^{2}$ 为单位表示，$N$ 以无量纲计数的形式报告。",
            "solution": "该问题经评估有效。问题陈述具有科学依据、提法恰当、客观且内容完整。它描述了中心极限定理的一个标准应用，用于分析蒙特卡罗模拟的收敛性和不确定性，而蒙特卡罗模拟是计算物理和工程领域的一项基本技术。所有必要数据均已提供，术语精确，目标明确。不存在矛盾、歧义或违反科学原理之处。\n\n解答按要求分为两部分进行。\n\n第1部分：构建 $95\\%$ 置信区间\n\n半球漫射辐射热通量的真值用 $Q$ 表示，它是单个光子历史得分的期望，即 $Q = \\mathbb{E}[X]$。$Q$ 的估计量是 $M$ 个分数的样本均值，$\\hat{Q}_{M} = \\frac{1}{M} \\sum_{i=1}^{M} X_{i}$。\n\n根据中心极限定理（CLT），对于足够大量的独立同分布（i.i.d.）随机变量（$M \\rightarrow \\infty$），样本均值 $\\hat{Q}_{M}$ 的分布趋近于一个正态分布，其均值为 $Q$，方差为 $\\frac{\\sigma^2}{M}$，其中 $\\sigma^2$ 是单个分数 $X_i$ 的方差。这可以写成：\n$$ \\hat{Q}_{M} \\sim \\mathcal{N}\\left(Q, \\frac{\\sigma^2}{M}\\right) $$\n问题提供了一次包含 $M_0 = 2.00 \\times 10^{5}$ 个光子历史的试点运行数据。这个样本量足够大，可以证明应用中心极限定理是合理的。试点运行产生的样本均值为 $\\hat{\\mu} = 1.80 \\times 10^{4} \\text{ W/m}^{2}$，样本标准差为 $\\hat{\\sigma} = 5.40 \\times 10^{5} \\text{ W/m}^{2}$。我们使用 $\\hat{\\mu}$ 作为 $Q$ 的点估计，使用 $\\hat{\\sigma}$ 作为真实标准差 $\\sigma$ 的估计。\n\n$Q$ 的一个双侧 $(1-\\alpha)$ 置信区间构造如下：\n$$ \\left[ \\hat{\\mu} - z_{1-\\alpha/2} \\frac{\\hat{\\sigma}}{\\sqrt{M_0}}, \\hat{\\mu} + z_{1-\\alpha/2} \\frac{\\hat{\\sigma}}{\\sqrt{M_0}} \\right] $$\n对于 $95\\%$ 的置信水平，$1-\\alpha = 0.95$，这意味着 $\\alpha = 0.05$。临界值 $z_{1-\\alpha/2} = z_{0.975}$ 是标准正态分布中对应于累积概率为 $0.975$ 的分位数。根据标准统计表，$z_{0.975} \\approx 1.959964$。\n\n首先，我们计算均值的估计标准误差 $\\hat{SE}$：\n$$ \\hat{SE} = \\frac{\\hat{\\sigma}}{\\sqrt{M_0}} = \\frac{5.40 \\times 10^{5} \\text{ W/m}^{2}}{\\sqrt{2.00 \\times 10^{5}}} \\approx 1207.4739 \\text{ W/m}^{2} $$\n接下来，我们计算误差范围 $\\delta$，即置信区间的半宽：\n$$ \\delta = z_{0.975} \\cdot \\hat{SE} \\approx 1.959964 \\times 1207.4739 \\text{ W/m}^{2} \\approx 2366.596 \\text{ W/m}^{2} $$\n置信区间为 $[\\hat{\\mu} - \\delta, \\hat{\\mu} + \\delta]$。\n下界 $Q_L$ 为：\n$$ Q_L = 1.80 \\times 10^{4} - 2366.596 = 15633.404 \\text{ W/m}^{2} $$\n上界 $Q_U$ 为：\n$$ Q_U = 1.80 \\times 10^{4} + 2366.596 = 20366.596 \\text{ W/m}^{2} $$\n按要求将这些界限四舍五入至四位有效数字：\n$$ Q_L \\approx 1.563 \\times 10^{4} \\text{ W/m}^{2} $$\n$$ Q_U \\approx 2.037 \\times 10^{4} \\text{ W/m}^{2} $$\n\n第2部分：确定所需的光子历史数\n\n相对置信半宽 $\\varepsilon_r$ 定义为绝对半宽 $\\delta_N$ 除以真实均值的绝对值 $|Q|$：\n$$ \\varepsilon_r = \\frac{\\delta_N}{|Q|} = \\frac{1}{|Q|} \\left( z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\right) $$\n我们需要求出在 $95\\%$ 置信水平下，为达到 $\\varepsilon_r = 0.050$ 的相对半宽所需的最少历史数 $N$。我们可以对上述方程求解 $N$：\n$$ \\sqrt{N} = \\frac{z_{1-\\alpha/2} \\sigma}{\\varepsilon_r |Q|} \\implies N = \\left( \\frac{z_{1-\\alpha/2} \\sigma}{\\varepsilon_r |Q|} \\right)^2 $$\n我们使用试点运行的统计数据作为真值的替代值：$\\sigma \\approx \\hat{\\sigma} = 5.40 \\times 10^{5} \\text{ W/m}^{2}$ 和 $Q \\approx \\hat{\\mu} = 1.80 \\times 10^{4} \\text{ W/m}^{2}$。置信水平同样为 $95\\%$，所以 $z_{0.975} \\approx 1.959964$。\n\n将这些值代入 $N$ 的方程中：\n$$ N = \\left( \\frac{1.959964 \\times (5.40 \\times 10^{5})}{0.050 \\times |1.80 \\times 10^{4}|} \\right)^2 $$\n括号内的项为：\n$$ \\frac{1.959964 \\times 5.40 \\times 10^{5}}{0.050 \\times 1.80 \\times 10^{4}} = \\frac{1.05838 \\times 10^{6}}{900} \\approx 1175.978 $$\n将此值平方得到 $N$：\n$$ N \\approx (1175.978)^2 \\approx 1382924.9 $$\n由于光子历史数必须是整数，且我们要求误差*最多*为规定值，因此我们必须对该结果取上整（ceiling），以找到所需的最少历史数：\n$$ N_{min} = \\lceil 1382924.9 \\rceil = 1382925 $$\n将此整数结果四舍五入至四位有效数字，得到：\n$$ N \\approx 1.383 \\times 10^{6} $$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.563 \\times 10^{4}  2.037 \\times 10^{4}  1.383 \\times 10^{6} \\end{pmatrix}}\n$$"
        }
    ]
}