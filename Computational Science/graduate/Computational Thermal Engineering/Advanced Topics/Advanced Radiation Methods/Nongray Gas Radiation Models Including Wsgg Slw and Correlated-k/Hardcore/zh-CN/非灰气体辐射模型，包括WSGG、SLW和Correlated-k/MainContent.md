## 引言
在燃烧、[热处理](@entry_id:159161)和能源转换等众多高温工程领域，热辐射是主要的传热模式。其中，水蒸气($\mathrm{H_2O}$)和二氧化碳($\mathrm{CO_2}$)等燃烧产物是主要的辐射[参与介质](@entry_id:155028)。然而，这些气体的辐射特性极其复杂，其吸收能力在不同波长上存在巨大差异，呈现出典型的“非灰”特性。传统的灰气体模型假设吸收系数恒定，无法捕捉这种[光谱选择性](@entry_id:176710)，导致对热流和温度场的预测产生严重偏差。这一知识差距促使了更高级的[非灰气体辐射](@entry_id:1128843)模型的发展，它们旨在在保证物理真实性的前提下，实现计算上的可行性。

本文旨在系统性地介绍计算热工领域中几种主流的[非灰气体辐射](@entry_id:1128843)模型。在“原理与机制”一章中，我们将从分子谱线的微观物理出发，深入剖析加权灰气体总和(WSGG)、谱线加权(SLW)及相关k分布(c-k)等模型的核心思想与数学构造。随后，在“应用与交叉学科联系”一章中，我们将展示这些模型如何应用于处理气体混合物、含[颗粒介质](@entry_id:750006)以及非均匀/非等温等复杂工程场景，并探讨其与[计算流体力学](@entry_id:747620)(CFD)求解器的[集成方法](@entry_id:895145)。最后，通过“动手实践”部分，读者将有机会通过具体计算和编程练习，将理论知识转化为解决实际问题的能力。

## 原理与机制

在理解了为何需要[非灰气体模型](@entry_id:1128789)之后，本章将深入探讨这些模型背后的基本物理原理和数学构造。我们将从导致[气体吸收](@entry_id:151140)光谱极端复杂性的微观现象出发，逐步构建起工程计算中常用的几种关键[非灰气体辐射](@entry_id:1128843)模型：加权灰气体总和 (WSGG) 模型、谱线加权灰气体总和 (SLW) 模型，以及相关 k 分布 (c-k) 方法。

### [非灰气体辐射](@entry_id:1128843)的挑战

辐射传递方程 (RTE) 描述了辐射强度 $I_\nu$ 在穿过参与性介质时的变化。对于一个不发生散射的介质，其光谱形式为：
$$
\frac{d I_\nu}{d s} = -\kappa_\nu I_\nu + \kappa_\nu I_{b\nu}(T)
$$
其中 $s$ 是路径长度，$\kappa_\nu$ 是光谱吸收系数，$I_{b\nu}(T)$ 是对应于介质局部温度 $T$ 的普朗克黑体辐射强度。

最简单的近似是**灰气体模型**，它假设[吸收系数](@entry_id:156541) $\kappa$ 是一个与频率无关的常数。然而，对于如水蒸气 ($\mathrm{H_2O}$) 和二氧化碳 ($\mathrm{CO_2}$) 等燃烧产物，这种假设在多数工程应用场景下是严重不准确的。其根本原因在于这些分子气体的 $\kappa_\nu$ 谱具有极其复杂的结构，由数千条分立的振动-转动吸收谱线组成。这些谱线汇集成若干个强吸收**谱带**，而在谱带之间则存在着气体近乎透明的**“窗区”** 。

灰气体模型的失效主要源于以下两点：

1.  **[光谱选择性](@entry_id:176710)**：一个单一的、经过平均的吸收系数 $\kappa$ 无法同时准确描述强吸收谱带（光学厚，$\tau_\nu = \kappa_\nu L \gg 1$）和高透射窗区（光学薄，$\tau_\nu \ll 1$）的辐射行为。灰气体模型会倾向于高估窗区的吸收，从而错误地阻挡了通过这些“窗口”逸散的辐射能量，导致对辐射热流的严重低估。

2.  **非等温效应**：在存在温度梯度的介质中，热区发射的辐射会向冷区传播。根据[维恩位移定律](@entry_id:145130)，热区发射的[普朗克函数](@entry_id:159605) $I_{b\nu}(T_{hot})$ 的峰值会偏向更高频率（更短波长）。当这部分辐射到达冷区时，其吸收效率取决于入射光谱与冷区吸收谱带的重叠情况。一个在整个路径上恒定的灰气体系数 $\kappa$ 完全无法捕捉这种 emission-at-T1, absorption-at-T2 的复杂光谱耦合效应 。

因此，任何高精度的辐射计算都必须考虑 $\kappa_\nu$ 的频率依赖性，即必须采用**[非灰气体模型](@entry_id:1128789)**。需要澄清的是，本文讨论的“吸收系数”$\kappa_\nu$ 与“消光系数”$\beta_\nu$ 的关系。消光是吸收和散射的总和，即 $\beta_\nu = \kappa_\nu + \sigma_{s\nu}$，其中 $\sigma_{s\nu}$ 是散射系数。对于气体分子，其散射（瑞利散射）强度与波长的四次方成反比（$\propto \lambda^{-4}$），在燃烧等应用所关注的[热红外](@entry_id:1133004)波段（$\lambda \approx 2-15 \, \mu\text{m}$）极其微弱，可以忽略不计。因此，在不含烟炱、液滴等颗粒物的纯气相介质中，可以极好地近似认为 $\sigma_{s\nu} \approx 0$，从而**消光系数等于[吸收系数](@entry_id:156541)**，$\beta_\nu = \kappa_\nu$。WSGG、SLW 和 c-k 等[气体辐射](@entry_id:150797)模型的基本形式均建立在这一非散射假设之上 。

### 吸收光谱的微观起源

要构建有效的非灰模型，必须首先理解 $\kappa_\nu$ 复杂谱结构的物理根源。一个气体的宏观[吸收光谱](@entry_id:144611)是其分子集体与[辐射场](@entry_id:164265)相互作用的体现，具体表现为大量分立的**谱线**。每条谱线对应于分子从一个[量子能级](@entry_id:136393)到另一个[量子能级](@entry_id:136393)的跃迁。

对于一条孤立的谱线，其对[吸收系数](@entry_id:156541)的贡献可以表示为谱线强度 $S$ 和归一化线型函数 $\phi$ 的乘积 ：
$$
\kappa_\nu = S \cdot \phi(\nu - \nu_0)
$$
其中 $\nu_0$ 是谱线中心频率。$\kappa_\nu$ 的光谱细节完全由这两个组分的物理性质决定。

#### 谱线强度 $S$

**谱线强度 $S$** 代表了单条谱线对吸收的总贡献，它与跃迁概率和参与跃迁的始末态的分子[数密度](@entry_id:895657)有关。其对温度的依赖性至关重要，主要由三个因素决定 ：

1.  **玻尔兹曼分布**：分子的吸收跃迁始于一个较低的能级 $E''$。根据统计力学，处于该能级的分子数密度正比于[玻尔兹曼因子](@entry_id:141054) $\exp(-E''/kT)$。

2.  **[配分函数](@entry_id:140048) $Q(T)$**：玻尔兹曼因子必须通过内[配分函数](@entry_id:140048) $Q(T)$ 进行归一化，$Q(T) = \sum_i g_i \exp(-E_i/kT)$，它代表了分子在所有内部能级（振动、转动）上的总分布。$Q(T)$ 本身是温度的强函数。

3.  **[受激发射](@entry_id:150501)修正**：净吸收是“吸收”减去“[受激发射](@entry_id:150501)”的结果。这一效应引入了一个修正因子 $[1 - \exp(-h\nu_0/kT)]$。

综合以上因素，谱线强度 $S$ 的温度依赖关系可表示为：
$$
S(T) \propto \frac{g'' \exp(-E''/kT)}{Q(T)} \left[1 - \exp(-hc\tilde{\nu}_0/kT)\right]
$$
其中 $g''$ 是低能级的简并度，$\tilde{\nu}_0$ 是谱线中心波数。对于理想气体，[配分函数](@entry_id:140048) $Q(T)$ 和谱线强度 $S(T)$ 都仅是**温度的函数，与压力无关** 。不同谱线的 $E''$ 值不同，导致它们的强度随温度的变化趋势也各不相同，这是导致非均匀介质中辐射特性复杂化的一个重要原因。

#### 谱线展宽与线型函数 $\phi$

谱线并非无限窄，而是具有一定的宽度和形状，这由**线型函数** $\phi(\nu - \nu_0)$ 描述。该函数被归一化，使得其在整个频率范围内的积分为1，即 $\int_{-\infty}^{\infty} \phi(\Delta\nu) d\nu = 1$。展宽机制主要有两种 ：

1.  **多普勒展宽 (Doppler Broadening)**：源于气体分子的热运动。根据[多普勒效应](@entry_id:160624)，相对于观察者运动的分子，其吸收频率会发生偏移。由于分子速度遵循[麦克斯韦-玻尔兹曼分布](@entry_id:144245)，这种随机运动导致谱线呈现**高斯线型**。其半峰半宽 (HWHM) $\Delta\nu_D$ **正比于温度的平方根**，而**与压力无关** 。其归一化形式为：
    $$
    \phi_D(\nu) = \frac{\sqrt{\ln 2}}{\Delta \nu_D \sqrt{\pi}} \exp\left[- \ln 2 \left( \frac{\nu - \nu_0}{\Delta \nu_D} \right)^2 \right]
    $$

2.  **碰撞展宽 (Collisional Broadening)**：也称压力展宽，源于分子间的碰撞。碰撞过程会干扰分子的辐射过程，缩短了跃迁态的相干寿命，根据[不确定性原理](@entry_id:141278)，这导致了能级展宽。这种机制产生的谱线呈**[洛伦兹线型](@entry_id:165845)**。其半峰半宽 $\gamma_L$ **正比于碰撞频率**，因此**与气体压力成正比**。其温度依赖性较为复杂，通常通过一个幂律关系来描述，反映了[碰撞截面](@entry_id:187067)和平均相对速度随温度的变化 。其归一化形式为：
    $$
    \phi_L(\nu) = \frac{1}{\pi} \frac{\gamma_L}{(\nu - \nu_0)^2 + \gamma_L^2}
    $$

在大多数燃烧环境中，两种展宽机制并存，真实的[谱线形状](@entry_id:172308)由[高斯和](@entry_id:196588)[洛伦兹线型](@entry_id:165845)卷积而成的**福伊特 (Voigt) 线型**来描述。

### 从谱线到谱带模型

直接逐条谱线 (Line-By-Line, LBL) 计算 $\kappa_\nu$ 并求解辐射传递方程，虽然最为精确，但由于谱线数量巨大（数百万条），计算成本高到无法接受。因此，工程上发展了各种**谱带模型**，其核心思想是对 $\kappa_\nu$ 在一定谱带范围内的快速振荡行为进行近似处理，以较低的计算代价获得足够精确的 band-averaged 结果。

在讨论谱带模型之前，我们先定义一个关键量：**光谱[光学厚度](@entry_id:150612)** $\tau_\nu$。对于一条长度为 $L$ 的均匀路径，$\tau_\nu = \kappa_\nu L$。它是一个[无量纲数](@entry_id:260863)，描述了介质在该频率下的光学不透明度。根据比尔-朗伯定律，光谱透射率 $T_\nu = \exp(-\tau_\nu)$。$\tau_\nu$ 直接正比于吸收物种的浓度（或[分压](@entry_id:168927) $p_i$）和路径长度 $L$ 的乘积。然而，由于碰撞展宽的存在，$\kappa_\nu$ 本身在谱线翼部对总压 $p_{\text{tot}}$ 有依赖，这使得 $\tau_\nu$ 与 $p_i$ 的关系在局部可能偏离严格的线性关系 。

### 加权灰气体总和 (WSGG) 模型

WSGG 模型是最早也是最简单的[非灰气体模型](@entry_id:1128789)。它并不解析单个谱带，而是直接对整个光谱范围内的总发射率（或[吸收率](@entry_id:144520)）进行建模。其核心思想是，一个真实[非灰气体](@entry_id:1128788)的总发射率可以通过**一组虚拟的灰气体和一个透明气体（“清澈气体”）的发射率加权求和**来近似 。

对于一个温度为 $T$、压力-路径长度乘积为 $pL$ 的均匀气体层，其总发射率 $\epsilon$ 可表示为：
$$
\epsilon(T, pL) = \sum_{i=1}^{N} a_i(T) \left[1 - \exp(-\kappa_i pL)\right]
$$
这个表达式可以理解为将总发射率分解为 $N+1$ 个部分：
*   $N$ 个**灰气体**成分：每个成分有一个固定的[吸收系数](@entry_id:156541) $\kappa_i$ 和一个**仅依赖于温度的权重** $a_i(T)$。项 $[1 - \exp(-\kappa_i pL)]$ 正是这个灰气体的发射率。
*   一个**清澈气体**成分：它对应于光谱中的“窗区”，其[吸收系数](@entry_id:156541) $\kappa_0 = 0$，发射率为零。其权重为 $a_0(T)$。

这些权重 $a_i(T)$ 代表了在温度 $T$ 下，普朗克[黑体辐射](@entry_id:137223)能量谱中，气体表现得像第 $i$ 个灰气体（或清澈气体）的那部分能量所占的比例。因此，所有权重之和必须为1，即 $\sum_{i=0}^{N} a_i(T) = 1$。

WSGG 模型的更深层物理解释是，它用一个离散的概率分布近似了由[普朗克函数](@entry_id:159605)加权的、连续的[吸收系数](@entry_id:156541)概率密度函数 $p(\kappa; T)$。模型假设 $p(\kappa; T)$ 可以被一组位于 $\kappa_i$ 处的狄拉克 $\delta$ 函数之和来代替，每个 $\delta$ 函数的强度即为权重 $a_i(T)$ 。这使得对光谱的复杂积分可以转化为一个简单的求和，极大地简化了计算。

### 谱线加权灰气体总和 (SLW) 模型

SLW 模型可以看作是 WSGG 模型思想在单个谱带内的精致化和系统化应用。它不再对整个光谱建模，而是为每个重要的吸收谱带分别构建模型。

在 SLW 框架下，我们不再使用一组离散的 $\kappa_i$，而是引入一个在谱带内连续的**吸收系数[概率密度函数](@entry_id:140610) (PDF)** $f(\kappa; T)$。这个函数描述了在给定温度 $T$ 下，谱带内出现特定[吸收系数](@entry_id:156541)值 $\kappa$ 的概率。根据定义，这个 PDF 必须满足[归一化条件](@entry_id:156486)：$\int_0^\infty f(\kappa; T) d\kappa = 1$。

利用这个 PDF，该谱带对总发射率的贡献 $\epsilon_b$ 可以通过对所有可能的灰气体发射率进行概率加权积分得到 ：
$$
\epsilon_b(T, pL) = w(T) \int_0^\infty \left[1 - \exp(-\kappa pL)\right] f(\kappa; T) d\kappa
$$
其中 $w(T)$ 是该谱带在温度 $T$ 的[黑体辐射谱](@entry_id:158574)中所占的能量分数。在实际应用中，这个连续积分通常通过选取合适的求积点（quadrature points）和权重来离散化，其形式最终回归到 WSGG 型的求和表达式，但其参数 $a_i$ 和 $k_i$ 是基于详细的谱线数据库为每个谱带系统地生成的，因此比传统的 WSGG 模型具有更高的精度和更强的物理基础 。

### 相关 k 分布 (c-k) 方法

相关 k 分布方法是目前最精确和灵活的谱带模型之一。它通过一个巧妙的数学变换，将对频率 $\nu$ 的积分转化为对一个累积概率变量 $g$ 的积分，从而在保持高精度的同时大幅提高计算效率。

#### k 分布的基本变换

c-k 方法的核心思想是**对[吸收系数](@entry_id:156541) $\kappa$ 进行重排**。在一个谱带内，$\kappa_\nu$ 是 $\nu$ 的一个剧烈振荡的函数。c-k 方法不关心哪个特定的频率 $\nu$ 对应哪个 $\kappa$ 值，而只关心谱带内所有 $\kappa$ 值的分布。

1.  **从 $\nu$ 空间到 $\kappa$ 空间**：首先，我们将对频率 $\nu$ 的积分，通过引入 $\kappa$ 的概率密度函数 $f(\kappa)$ (与 SLW 模型中的概念类似)，转化为对 $\kappa$ 的积分。例如，谱带平均[透射率](@entry_id:1133377)可以从 $\langle T \rangle = \int_B \exp(-\kappa(\nu)u) w(\nu) d\nu$ 转化为 $\langle T \rangle = \int_0^\infty \exp(-\kappa u) f(\kappa) d\kappa$，其中 $u$ 是吸收物质量路径长度 。

2.  **从 $\kappa$ 空间到 $g$ 空间**：接着，我们定义一个[累积分布函数 (CDF)](@entry_id:264700) $g(\kappa) = \int_0^\kappa f(s) ds$。这个 $g$ 值代表了谱带内[吸收系数](@entry_id:156541)小于等于 $\kappa$ 的部分的累积概率，其取值范围为 $[0, 1]$。通过变量代换，$dg = f(\kappa)d\kappa$，我们可以将积分变量从 $\kappa$ 变为 $g$。

经过这个变换，谱带平均[透射率](@entry_id:1133377)的表达式变得异常简洁和优美：
$$
\langle T \rangle = \int_0^1 \exp(-\kappa(g) u) dg
$$
这里的 $\kappa(g)$ 是 $g(\kappa)$ 的[反函数](@entry_id:141256)，它是一个**单调递增**的光滑函数，代表了重排后的[吸收系数](@entry_id:156541)。这个变换将一个对剧烈振荡函数的积分，转化为了对一个[光滑函数](@entry_id:267124)的积分，后者可以用很少的求积点（如[高斯-勒让德求积](@entry_id:138201)）就得到非常精确的结果 。

#### 非均匀路径与相关性假设

c-k 方法的最大优势在于其处理**非均匀路径**（温度、压力、组分沿路径变化）的能力。然而，这需要一个关键的附加假设——**相关性假设 (Correlation Assumption)**。

在非均匀路径上，每一点 $s$ 的 $\kappa_\nu(s)$ 都不同。c-k 方法要奏效，就必须假设 $\kappa_\nu$ 值的大小排序在路径上是**保持不变**的。也就是说，如果在一个参考状态下，频率 $\nu_1$ 的吸收比 $\nu_2$ 强（$\kappa_{\nu_1} > \kappa_{\nu_2}$），那么在路径上任何其他状态下，这个大小关系依然成立。这种 rank-order 的 preservation 被称为**共单调性 (comonotonicity)** 。

*   **假设成立的条件**：这个假设在某些情况下是近似成立的。例如，当谱带内的吸收主要由单一气体组分贡献，且温度、压力的变化只是等比例地“缩放”所有谱线的强度和宽度时。从数学上讲，一个充分条件是 $\kappa_\nu(s)$ 可以分离变量，写成 $\kappa_\nu(s) = f_s(k_\nu(s_0))$ 的形式，其中 $s_0$ 是参考状态，$f_s$ 是一个对任意 $s$ 都严格递增的函数 。

*   **假设失效的条件**：当多种气体（如 $\mathrm{H_2O}$ 和 $\mathrm{CO_2}$）的谱带重叠，且它们的浓度比例沿路径变化时，相关性假设会严重破坏。同样，大的温度梯度会不成比例地改变不同谱线的强度（因为它们的低能级 $E''$ 不同），从而打乱 $\kappa_\nu$ 的排序，导致假设失效 。

尽管存在此限制，c-k 方法因其高效和在多种条件下的高精度，已成为[计算流体力学](@entry_id:747620) (CFD) 中进行高保真辐射模拟的标准工具之一。