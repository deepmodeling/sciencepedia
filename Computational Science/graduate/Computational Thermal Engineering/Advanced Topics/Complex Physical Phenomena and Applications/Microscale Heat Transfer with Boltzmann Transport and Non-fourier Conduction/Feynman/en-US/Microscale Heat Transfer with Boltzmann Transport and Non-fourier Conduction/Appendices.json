{
    "hands_on_practices": [
        {
            "introduction": "Before modeling how heat is transported, we must first understand the thermodynamic properties of the energy carriers themselves—the phonons. This exercise revisits the foundational Debye model to derive the volumetric specific heat $C(T)$ from first principles, starting with the Bose-Einstein statistics that govern phonons. Mastering this derivation solidifies your understanding of phonon density of states and energy quantization, providing a crucial parameter used in advanced non-Fourier heat conduction models.",
            "id": "3970662",
            "problem": "A three-dimensional crystalline dielectric is modeled as an isotropic Debye-like phonon gas with dispersion relation $\\omega = v k$ up to a cutoff angular frequency $\\omega_{D}$. There are three acoustic polarizations and the crystal contains $N$ atoms in volume $V$, giving an atomic number density $n = N/V$. The Debye cutoff is defined by the requirement that the total number of vibrational modes equals $3N$. The Debye temperature is defined by $\\theta_{D} = \\hbar \\omega_{D}/k_{B}$, where $\\hbar$ is the reduced Planck constant and $k_{B}$ is the Boltzmann constant. In computational thermal engineering models of non-Fourier heat conduction such as the Guyer–Krumhansl framework, the volumetric specific heat $C(T)$ provides the equilibrium thermodynamic closure for the phonon energy density.\n\nStarting from the phonon Boltzmann transport equation in equilibrium and the Bose–Einstein occupation $n_{B}(\\omega,T) = \\left[\\exp\\!\\left(\\hbar \\omega/k_{B}T\\right) - 1\\right]^{-1}$, and using only the isotropic dispersion and the Debye cutoff normalization, derive the volumetric specific heat $C(T)$ at constant volume. Assume the zero-point energy does not contribute to $C(T)$. Your derivation should:\n- Construct the density of states $g(\\omega)$ per unit volume from the dispersion and the mode-counting constraint.\n- Write the internal energy density $u(T)$ as an integral over $\\omega$ and then differentiate with respect to $T$ to obtain $C(T) = \\partial u/\\partial T$.\n\nDiscuss, in words and equations, the low-temperature behavior for $T \\ll \\theta_{D}$ and identify the leading-order $T^{3}$ law and its prefactor in terms of $n$, $k_{B}$, and $\\theta_{D}$.\n\nAnswer specification:\n- Report the final answer as a single closed-form analytic expression for $C(T)$ (per unit volume) in terms of $n$, $k_{B}$, $\\theta_{D}$, $T$, and standard mathematical constants and functions.\n- Express $C(T)$ in Joules per cubic meter-Kelvin.\n- No numerical approximation or rounding is required for the final answer.",
            "solution": "The problem is to derive the volumetric specific heat $C(T)$ of a crystalline dielectric using the Debye model and to analyze its low-temperature behavior. The problem is scientifically sound, well-posed, and contains all necessary information for a complete derivation.\n\nThe derivation proceeds in four main steps:\n1.  Construction of the phonon density of states per unit volume, $g(\\omega)$.\n2.  Formulation of the internal energy density, $u(T)$.\n3.  Differentiation of $u(T)$ with respect to temperature $T$ to obtain the specific heat, $C(T)$.\n4.  Analysis of the low-temperature limit ($T \\ll \\theta_D$) to find the Debye $T^3$ law.\n\n**Step 1: Phonon Density of States, $g(\\omega)$**\n\nIn a three-dimensional crystal, the allowed phonon wavevectors $\\vec{k}$ form a dense grid in $k$-space. The number of allowed states in a small volume element $d^3k$ of $k$-space is given by $V \\frac{d^3k}{(2\\pi)^3}$, where $V$ is the volume of the crystal. The problem specifies three acoustic polarizations (two transverse, one longitudinal), so we must multiply the number of states by a factor of $3$.\n\nThe number of vibrational modes $d\\mathcal{N}$ in the wavevector element $d^3k$ is:\n$$\nd\\mathcal{N} = 3 \\cdot V \\frac{d^3k}{(2\\pi)^3}\n$$\nThe problem assumes an isotropic medium, where the dispersion relation $\\omega = vk$ depends only on the magnitude of the wavevector, $k=|\\vec{k}|$. We can therefore express the volume element in spherical coordinates as $d^3k = 4\\pi k^2 dk$. The number of modes in a spherical shell of radius $k$ and thickness $dk$ is:\n$$\nd\\mathcal{N} = 3V \\frac{4\\pi k^2 dk}{(2\\pi)^3} = \\frac{3V}{2\\pi^2} k^2 dk\n$$\nTo find the density of states as a function of angular frequency $\\omega$, we use the linear dispersion relation $\\omega = vk$. From this, we have $k = \\omega/v$ and $dk = d\\omega/v$. Substituting these into the expression for $d\\mathcal{N}$:\n$$\nd\\mathcal{N} = \\frac{3V}{2\\pi^2} \\left(\\frac{\\omega}{v}\\right)^2 \\left(\\frac{d\\omega}{v}\\right) = \\frac{3V\\omega^2}{2\\pi^2 v^3} d\\omega\n$$\nThe total density of states, $G(\\omega)$, is defined by $d\\mathcal{N} = G(\\omega)d\\omega$. The density of states per unit volume, $g(\\omega)$, is $G(\\omega)/V$:\n$$\ng(\\omega) = \\frac{1}{V} \\frac{d\\mathcal{N}}{d\\omega} = \\frac{3\\omega^2}{2\\pi^2 v^3}\n$$\nThis density of states is valid up to the Debye cutoff frequency, $\\omega_D$. The value of $\\omega_D$ is determined by the constraint that the total number of modes equals $3N$, where $N$ is the number of atoms in the crystal. The total number of modes per unit volume is $3N/V = 3n$.\n$$\n\\int_0^{\\omega_D} g(\\omega) d\\omega = 3n\n$$\nSubstituting the expression for $g(\\omega)$:\n$$\n\\int_0^{\\omega_D} \\frac{3\\omega^2}{2\\pi^2 v^3} d\\omega = \\frac{3}{2\\pi^2 v^3} \\left[\\frac{\\omega^3}{3}\\right]_0^{\\omega_D} = \\frac{\\omega_D^3}{2\\pi^2 v^3} = 3n\n$$\nThis gives a relationship between $\\omega_D$, $v$, and the atomic number density $n$: $\\omega_D^3 = 6\\pi^2 n v^3$. We can use this to eliminate the phonon velocity $v$ from the expression for $g(\\omega)$:\n$$\n\\frac{1}{v^3} = \\frac{6\\pi^2 n}{\\omega_D^3}\n$$\nSubstituting this back into $g(\\omega)$:\n$$\ng(\\omega) = \\frac{3\\omega^2}{2\\pi^2} \\left(\\frac{6\\pi^2 n}{\\omega_D^3}\\right) = \\frac{9n}{\\omega_D^3} \\omega^2\n$$\nThis expression for the density of states per unit volume is valid for $0 \\le \\omega \\le \\omega_D$ and is zero for $\\omega > \\omega_D$.\n\n**Step 2: Internal Energy Density, $u(T)$**\n\nThe energy of a phonon mode of frequency $\\omega$ is $E(\\omega) = \\hbar\\omega$. The average energy of this mode at temperature $T$ is given by its energy multiplied by the Bose-Einstein occupation number, $n_B(\\omega, T)$. The problem states to neglect the zero-point energy, so we only consider the temperature-dependent part of the energy.\n$$\n\\langle E(\\omega, T) \\rangle = \\hbar\\omega \\, n_B(\\omega, T) = \\frac{\\hbar\\omega}{\\exp(\\hbar\\omega/k_B T) - 1}\n$$\nThe total internal energy per unit volume, $u(T)$, is obtained by integrating the average energy per mode over all possible modes, weighted by the density of states $g(\\omega)$:\n$$\nu(T) = \\int_0^{\\omega_D} \\langle E(\\omega, T) \\rangle g(\\omega) d\\omega = \\int_0^{\\omega_D} \\frac{\\hbar\\omega}{\\exp(\\hbar\\omega/k_B T) - 1} \\left(\\frac{9n}{\\omega_D^3} \\omega^2\\right) d\\omega\n$$\n$$\nu(T) = \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^3}{\\exp(\\hbar\\omega/k_B T) - 1} d\\omega\n$$\n\n**Step 3: Volumetric Specific Heat, $C(T)$**\n\nThe volumetric specific heat at constant volume, $C(T)$, is the derivative of the internal energy density with respect to temperature: $C(T) = (\\partial u/\\partial T)_V$. We can differentiate under the integral sign since the limits of integration are independent of $T$.\n$$\nC(T) = \\frac{\\partial}{\\partial T} \\left[ \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^3}{\\exp(\\hbar\\omega/k_B T) - 1} d\\omega \\right] = \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\omega^3 \\frac{\\partial}{\\partial T} \\left( \\frac{1}{\\exp(\\hbar\\omega/k_B T) - 1} \\right) d\\omega\n$$\nThe derivative of the occupation factor is:\n$$\n\\frac{\\partial}{\\partial T} \\left( \\frac{1}{\\exp(a/T) - 1} \\right) = - \\frac{1}{(\\exp(a/T) - 1)^2} \\cdot \\exp(a/T) \\cdot \\left(-\\frac{a}{T^2}\\right) = \\frac{a}{T^2} \\frac{\\exp(a/T)}{(\\exp(a/T) - 1)^2}\n$$\nwhere $a = \\hbar\\omega/k_B$. Substituting this back into the expression for $C(T)$:\n$$\nC(T) = \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\omega^3 \\left( \\frac{\\hbar\\omega}{k_B T^2} \\frac{\\exp(\\hbar\\omega/k_B T)}{(\\exp(\\hbar\\omega/k_B T) - 1)^2} \\right) d\\omega\n$$\n$$\nC(T) = \\frac{9n\\hbar^2}{k_B T^2 \\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^4 \\exp(\\hbar\\omega/k_B T)}{(\\exp(\\hbar\\omega/k_B T) - 1)^2} d\\omega\n$$\nTo simplify this integral, we introduce the dimensionless variable $x = \\hbar\\omega/(k_B T)$. This implies $\\omega = x k_B T / \\hbar$ and $d\\omega = (k_B T / \\hbar) dx$. The upper limit of integration becomes $x_D = \\hbar\\omega_D/(k_B T) = \\theta_D/T$, where $\\theta_D$ is the Debye temperature.\n$$\nC(T) = \\frac{9n\\hbar^2}{k_B T^2 \\omega_D^3} \\int_0^{\\theta_D/T} \\frac{(x k_B T / \\hbar)^4 \\exp(x)}{(\\exp(x) - 1)^2} \\left( \\frac{k_B T}{\\hbar} dx \\right)\n$$\n$$\nC(T) = \\frac{9n\\hbar^2}{k_B T^2 \\omega_D^3} \\left(\\frac{k_B T}{\\hbar}\\right)^5 \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\n$$\nC(T) = \\frac{9n k_B^4 T^3}{\\hbar^3 \\omega_D^3} \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\nUsing the definition of the Debye temperature, $\\hbar \\omega_D = k_B \\theta_D$, we have $\\hbar^3 \\omega_D^3 = k_B^3 \\theta_D^3$. Substituting this into the prefactor:\n$$\nC(T) = \\frac{9n k_B^4 T^3}{k_B^3 \\theta_D^3} \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\nThis simplifies to the final expression for the volumetric specific heat:\n$$\nC(T) = 9n k_B \\left( \\frac{T}{\\theta_D} \\right)^3 \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\n\n**Step 4: Low-Temperature Behavior ($T \\ll \\theta_D$)**\n\nIn the low-temperature limit, $T \\ll \\theta_D$, the upper limit of integration $x_D = \\theta_D/T$ approaches infinity. Physically, this means that at very low temperatures, only the low-frequency acoustic phonons are excited, and their energies are so small compared to the Debye energy ($k_B\\theta_D$) that the existence of the frequency cutoff has a negligible effect. The integral can therefore be extended to infinity:\n$$\nC(T) \\approx 9n k_B \\left( \\frac{T}{\\theta_D} \\right)^3 \\int_0^{\\infty} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx \\quad \\text{for } T \\ll \\theta_D\n$$\nThis definite integral is a standard form. It can be evaluated using integration by parts, where $u=x^4$ and $dv = \\frac{e^x}{(e^x-1)^2}dx$, which results in $4\\int_0^\\infty \\frac{x^3}{e^x-1}dx$. This is related to the Riemann zeta function $\\zeta(s)$ and the Gamma function $\\Gamma(s)$ by $\\int_0^\\infty \\frac{t^{s-1}}{e^t-1}dt = \\Gamma(s)\\zeta(s)$. For $s=4$, the integral $\\int_0^\\infty \\frac{x^3}{e^x-1}dx = \\Gamma(4)\\zeta(4) = 3! \\cdot \\frac{\\pi^4}{90} = \\frac{\\pi^4}{15}$. Therefore, the original integral evaluates to:\n$$\n\\int_0^{\\infty} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx = 4 \\times \\frac{\\pi^4}{15} = \\frac{4\\pi^4}{15}\n$$\nSubstituting this value into the expression for $C(T)$:\n$$\nC(T) \\approx 9n k_B \\left( \\frac{T}{\\theta_D} \\right)^3 \\left( \\frac{4\\pi^4}{15} \\right) = \\frac{12\\pi^4}{5} n k_B \\left( \\frac{T}{\\theta_D} \\right)^3\n$$\nThis is the celebrated Debye $T^3$ law for the specific heat of solids at low temperatures. The leading-order behavior is $C(T) \\propto T^3$. The prefactor, in terms of the specified variables, is $\\frac{12\\pi^4 n k_B}{5 \\theta_D^3}$.",
            "answer": "$$\\boxed{9n k_{B} \\left( \\frac{T}{\\theta_{D}} \\right)^{3} \\int_{0}^{\\theta_{D}/T} \\frac{x^{4} \\exp(x)}{(\\exp(x) - 1)^{2}} dx}$$"
        },
        {
            "introduction": "One of the most prominent non-Fourier effects at the microscale is the reduction of thermal conductivity due to boundary scattering. This practice introduces the powerful concept of a mean free path (MFP) accumulation function, allowing us to see how phonons with different MFPs contribute to overall conductivity. By applying a suppression function, you will model how boundaries preferentially scatter long-MFP phonons, leading to a size-dependent effective conductivity . This exercise provides direct insight into quasi-ballistic transport and is a cornerstone for predicting thermal properties in thin films and nanostructures.",
            "id": "3970754",
            "problem": "Consider steady, one-dimensional (1D) microscale heat conduction across a slab of thickness $L$ in a crystalline dielectric where phonon transport is described by the Boltzmann Transport Equation (BTE) under the relaxation-time approximation (RTA). Assume isotropic dispersion and scattering so that the spectral contribution of phonons characterized by a mean free path (MFP) $\\Lambda$ to the bulk thermal conductivity can be represented by an MFP distribution $F(\\Lambda)$ satisfying\n$$\n\\int_{0}^{\\infty} F(\\Lambda)\\,\\mathrm{d}\\Lambda \\;=\\; k_{\\mathrm{bulk}}\\,,\n$$\nwhere $k_{\\mathrm{bulk}}$ is the bulk thermal conductivity. In a finite slab of thickness $L$, nonlocal effects suppress contributions from longer mean free paths. Model this finite-size nonlocal suppression by a dimensionless suppression function\n$$\nS\\!\\left(\\frac{\\Lambda}{L}\\right) \\;=\\; 1 \\;-\\; \\exp\\!\\left(-\\frac{1}{\\Lambda/L}\\right) \\;=\\; 1 \\;-\\; \\exp\\!\\left(-\\frac{L}{\\Lambda}\\right).\n$$\nAssume the MFP distribution is a gamma family that accumulates to the bulk conductivity,\n$$\nF(\\Lambda) \\;=\\; k_{\\mathrm{bulk}}\\,\\frac{\\beta^{m}}{\\Gamma(m)}\\,\\Lambda^{m-1}\\,\\exp(-\\beta \\Lambda)\\,,\n$$\nwith shape parameter $m>0$, rate parameter $\\beta>0$, and $\\Gamma(\\cdot)$ the Euler gamma function. Starting from the BTE with the RTA and the definition of the MFP distribution, derive the effective conductivity $k_{\\mathrm{eff}}(L)$ and express the dimensionless conductivity ratio\n$$\nR(L) \\;=\\; \\frac{k_{\\mathrm{eff}}(L)}{k_{\\mathrm{bulk}}}\n$$\nas a single closed-form analytic expression in terms of $m$, $\\beta$, and $L$. Then, use asymptotic analysis to discuss the sensitivity of $R(L)$ to $L$ in the limits $\\beta L \\ll 1$ and $\\beta L \\gg 1$, identifying the leading-order dependence on $L$ in each regime. Provide your final answer for $R(L)$ as a dimensionless closed-form expression; do not substitute numerical values and do not include units.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of microscale heat transfer, mathematically well-posed, and objectively stated. All necessary information and definitions are provided, and there are no internal contradictions or factual-scientific flaws.\n\nThe problem asks for the derivation of the effective thermal conductivity $k_{\\mathrm{eff}}(L)$ for a slab of thickness $L$, based on a given mean free path (MFP) distribution $F(\\Lambda)$ and a suppression function $S(\\Lambda/L)$ that models boundary scattering effects. The bulk thermal conductivity $k_{\\mathrm{bulk}}$ is given by the integral of the MFP distribution over all possible mean free paths:\n$$\nk_{\\mathrm{bulk}} = \\int_{0}^{\\infty} F(\\Lambda)\\,\\mathrm{d}\\Lambda\n$$\nIn a finite slab of thickness $L$, the contribution of phonons with mean free path $\\Lambda$ is reduced by the suppression function $S(\\Lambda/L)$. The effective thermal conductivity $k_{\\mathrm{eff}}(L)$ is therefore the integral of the suppressed spectral contributions:\n$$\nk_{\\mathrm{eff}}(L) = \\int_{0}^{\\infty} S\\left(\\frac{\\Lambda}{L}\\right) F(\\Lambda)\\,\\mathrm{d}\\Lambda\n$$\nThe problem specifies the suppression function and the MFP distribution as:\n$$\nS\\left(\\frac{\\Lambda}{L}\\right) = 1 - \\exp\\left(-\\frac{L}{\\Lambda}\\right)\n$$\n$$\nF(\\Lambda) = k_{\\mathrm{bulk}}\\,\\frac{\\beta^{m}}{\\Gamma(m)}\\,\\Lambda^{m-1}\\,\\exp(-\\beta \\Lambda)\n$$\nWe are asked to find the dimensionless conductivity ratio $R(L) = k_{\\mathrm{eff}}(L) / k_{\\mathrm{bulk}}$. Substituting the expressions for $S$ and $F$ into the definition of $k_{\\mathrm{eff}}(L)$ and dividing by $k_{\\mathrm{bulk}}$, we get:\n$$\nR(L) = \\frac{1}{k_{\\mathrm{bulk}}} \\int_{0}^{\\infty} \\left[1 - \\exp\\left(-\\frac{L}{\\Lambda}\\right)\\right] \\left[ k_{\\mathrm{bulk}}\\,\\frac{\\beta^{m}}{\\Gamma(m)}\\,\\Lambda^{m-1}\\,\\exp(-\\beta \\Lambda) \\right] \\,\\mathrm{d}\\Lambda\n$$\nSimplifying, we obtain the integral for $R(L)$:\n$$\nR(L) = \\frac{\\beta^{m}}{\\Gamma(m)} \\int_{0}^{\\infty} \\left[1 - \\exp\\left(-\\frac{L}{\\Lambda}\\right)\\right] \\Lambda^{m-1}\\,\\exp(-\\beta \\Lambda) \\,\\mathrm{d}\\Lambda\n$$\nThis integral can be split into two parts:\n$$\nR(L) = \\frac{\\beta^{m}}{\\Gamma(m)} \\left[ \\int_{0}^{\\infty} \\Lambda^{m-1}\\,\\exp(-\\beta \\Lambda) \\,\\mathrm{d}\\Lambda - \\int_{0}^{\\infty} \\Lambda^{m-1}\\,\\exp\\left(-\\beta \\Lambda - \\frac{L}{\\Lambda}\\right) \\,\\mathrm{d}\\Lambda \\right]\n$$\nThe first integral is related to the definition of the Euler gamma function, $\\Gamma(z) = \\int_0^\\infty t^{z-1} e^{-t} dt$. With the substitution $t = \\beta\\Lambda$, we have $\\mathrm{d}t = \\beta\\,\\mathrm{d}\\Lambda$:\n$$\n\\int_{0}^{\\infty} \\Lambda^{m-1}\\,\\exp(-\\beta \\Lambda) \\,\\mathrm{d}\\Lambda = \\int_{0}^{\\infty} \\left(\\frac{t}{\\beta}\\right)^{m-1} e^{-t} \\left(\\frac{\\mathrm{d}t}{\\beta}\\right) = \\frac{1}{\\beta^m} \\int_{0}^{\\infty} t^{m-1} e^{-t} \\,\\mathrm{d}t = \\frac{\\Gamma(m)}{\\beta^m}\n$$\nThis result is expected, as it ensures the integral of the unsuppressed probability density function component of $F(\\Lambda)$ is unity.\n\nThe second integral is of the form:\n$$\nI_2 = \\int_{0}^{\\infty} \\Lambda^{m-1}\\,\\exp\\left(-\\beta \\Lambda - \\frac{L}{\\Lambda}\\right) \\,\\mathrm{d}\\Lambda\n$$\nThis is a standard integral representation for the modified Bessel function of the second kind, $K_{\\nu}(z)$. The general form is:\n$$\n\\int_0^\\infty x^{\\nu-1} \\exp\\left(-ax - \\frac{b}{x}\\right) \\,\\mathrm{d}x = 2 \\left(\\frac{b}{a}\\right)^{\\nu/2} K_{\\nu}(2\\sqrt{ab})\n$$\nBy comparing this with our integral $I_2$, we can identify the parameters: $x=\\Lambda$, $\\nu-1=m-1 \\implies \\nu=m$, $a=\\beta$, and $b=L$. Therefore, the value of the second integral is:\n$$\nI_2 = 2 \\left(\\frac{L}{\\beta}\\right)^{m/2} K_{m}(2\\sqrt{\\beta L})\n$$\nSubstituting the results for the two integrals back into the expression for $R(L)$:\n$$\nR(L) = \\frac{\\beta^{m}}{\\Gamma(m)} \\left[ \\frac{\\Gamma(m)}{\\beta^m} - 2 \\left(\\frac{L}{\\beta}\\right)^{m/2} K_{m}(2\\sqrt{\\beta L}) \\right]\n$$\nDistributing the leading term, we arrive at the closed-form analytic expression for $R(L)$:\n$$\nR(L) = 1 - \\frac{\\beta^{m}}{\\Gamma(m)} \\cdot 2 \\frac{L^{m/2}}{\\beta^{m/2}} K_{m}(2\\sqrt{\\beta L})\n$$\n$$\nR(L) = 1 - \\frac{2 \\beta^{m/2} L^{m/2}}{\\Gamma(m)} K_{m}(2\\sqrt{\\beta L}) = 1 - \\frac{2 (\\beta L)^{m/2}}{\\Gamma(m)} K_{m}(2\\sqrt{\\beta L})\n$$\nThis is the final expression for the dimensionless conductivity ratio.\n\nNext, we perform an asymptotic analysis for the limits $\\beta L \\ll 1$ and $\\beta L \\gg 1$.\n\nCase 1: Diffusive limit ($\\beta L \\gg 1$).\nIn this limit, the argument of the Bessel function, $z = 2\\sqrt{\\beta L}$, is large. The asymptotic expansion for $K_m(z)$ for large $z$ is $K_m(z) \\sim \\sqrt{\\frac{\\pi}{2z}} \\exp(-z)$. Thus, $R(L)$ approaches $1$ and the deviation from bulk behavior is exponentially small:\n$$\n1 - R(L) = \\frac{2 (\\beta L)^{m/2}}{\\Gamma(m)} K_{m}(2\\sqrt{\\beta L}) \\sim \\frac{2 (\\beta L)^{m/2}}{\\Gamma(m)} \\sqrt{\\frac{\\pi}{4\\sqrt{\\beta L}}} \\exp(-2\\sqrt{\\beta L})\n$$\n$$\n1 - R(L) \\sim \\frac{\\sqrt{\\pi}}{\\Gamma(m)} (\\beta L)^{m/2 - 1/4} \\exp(-2\\sqrt{\\beta L})\n$$\nAs $L \\to \\infty$, this term vanishes exponentially, so $R(L) \\to 1$. The sensitivity of $R(L)$ to $L$ is negligible in this regime, as boundary effects become insignificant.\n\nCase 2: Ballistic limit ($\\beta L \\ll 1$).\nIn this limit, $z = 2\\sqrt{\\beta L}$ is small. The behavior of $K_m(z)$ for $z \\to 0$ depends on $m$.\nIf $m > 1$: A simple and physically intuitive approach is to approximate the suppression term in the original integral. For $\\beta L \\ll 1$, the characteristic MFP $\\langle\\Lambda\\rangle \\sim m/\\beta$ is much larger than $L$. The suppression function $1 - \\exp(-L/\\Lambda)$ can be approximated by its leading-order Taylor series term, $L/\\Lambda$, since $L/\\Lambda$ is small for the dominant $\\Lambda$ values. The integral for $R(L)$ becomes:\n$$\nR(L) \\approx \\frac{\\beta^{m}}{\\Gamma(m)} \\int_{0}^{\\infty} \\left(\\frac{L}{\\Lambda}\\right) \\Lambda^{m-1}\\,\\exp(-\\beta \\Lambda) \\,\\mathrm{d}\\Lambda = \\frac{L\\beta^{m}}{\\Gamma(m)} \\int_{0}^{\\infty} \\Lambda^{m-2}\\,\\exp(-\\beta \\Lambda) \\,\\mathrm{d}\\Lambda\n$$\nThis integral converges for $m-1 > 0$, i.e., $m > 1$. Its value is $\\Gamma(m-1)/\\beta^{m-1}$.\n$$\nR(L) \\approx \\frac{L\\beta^{m}}{\\Gamma(m)} \\frac{\\Gamma(m-1)}{\\beta^{m-1}} = \\beta L \\frac{\\Gamma(m-1)}{\\Gamma(m)} = \\frac{\\beta L}{m-1}\n$$\nThus, for $m > 1$, $R(L)$ is directly proportional to $L$.\n\nIf $0 < m < 1$: The above approximation is invalid as the integral diverges. We must use the small-argument expansion of $K_m(z)$. For non-integer $m>0$, the leading terms are $K_m(z) \\sim \\frac{1}{2}\\Gamma(m)(\\frac{z}{2})^{-m} - \\frac{1}{2}\\Gamma(-m)(\\frac{z}{2})^{m}$.\nSubstituting this into the expression for $R(L)$:\n$$\nR(L) = 1 - \\frac{2}{\\Gamma(m)}\\left(\\frac{z}{2}\\right)^m \\left[ \\frac{1}{2}\\Gamma(m)\\left(\\frac{z}{2}\\right)^{-m} - \\frac{1}{2}\\Gamma(-m)\\left(\\frac{z}{2}\\right)^{m} + \\dots \\right]\n$$\n$$\nR(L) \\approx 1 - \\left[1 - \\frac{\\Gamma(-m)}{\\Gamma(m)}\\left(\\frac{z}{2}\\right)^{2m}\\right] = \\frac{\\Gamma(-m)}{\\Gamma(m)}\\left(\\frac{z}{2}\\right)^{2m}\n$$\nUsing the reflection formula $\\Gamma(-m) = -\\frac{\\pi}{\\sin(m\\pi)m\\Gamma(m)}$ and $\\Gamma(m)\\Gamma(1-m) = \\frac{\\pi}{\\sin(m\\pi)}$, we can show $\\frac{\\Gamma(-m)}{\\Gamma(m)}=-\\frac{\\Gamma(1-m)}{m\\Gamma(m)}=-\\frac{\\Gamma(1-m)}{\\Gamma(m+1)}$. The sign is tricky. A more careful expansion gives the leading term as:\n$$\nR(L) \\approx \\frac{\\Gamma(1-m)}{\\Gamma(1+m)} (\\beta L)^m\n$$\nFor $0 < m < 1$, the conductivity ratio scales as $L^m$.\n\nIf $m=1$: We must use the specific expansion $K_1(z) \\sim \\frac{1}{z} + \\frac{z}{2}\\ln\\frac{z}{2}$.\n$$\nR(L) = 1 - z K_1(z) \\approx 1 - z\\left(\\frac{1}{z} + \\frac{z}{2}\\ln\\frac{z}{2}\\right) = -\\frac{z^2}{2}\\ln\\frac{z}{2}\n$$\nSubstituting $z=2\\sqrt{\\beta L}$:\n$$\nR(L) \\approx -\\frac{(4\\beta L)}{2} \\ln(\\sqrt{\\beta L}) = -2\\beta L \\left(\\frac{1}{2}\\ln(\\beta L)\\right) = -\\beta L \\ln(\\beta L) = \\beta L \\ln\\left(\\frac{1}{\\beta L}\\right)\n$$\nFor $m=1$, the conductivity scales as $L\\ln(1/L)$.\n\nIn summary, the sensitivity to $L$ in the ballistic regime ($\\beta L \\ll 1$) is strong and depends on the shape of the MFP distribution, with $k_{\\mathrm{eff}}(L)$ scaling as $L^m$ for $0<m<1$, $L\\ln(1/L)$ for $m=1$, and $L$ for $m>1$.",
            "answer": "$$\n\\boxed{1 - \\frac{2 (\\beta L)^{\\frac{m}{2}}}{\\Gamma(m)} K_m(2\\sqrt{\\beta L})}\n$$"
        },
        {
            "introduction": "With a firm grasp of both thermodynamic properties and steady-state size effects, we can now tackle the dynamic response of microscale systems. This culminating hands-on practice requires you to implement and compare four different heat conduction models—from the classical Fourier law to a BTE-based approximation—for a time-dependent problem. You will analyze their predictions and learn to identify the appropriate model based on the physical regime defined by the Knudsen number $Kn$ and a dimensionless frequency . This comparative analysis is a crucial skill for any computational thermal engineer, enabling you to select the right tool for the job and understand the limitations of simpler models.",
            "id": "3970710",
            "problem": "Consider one-dimensional cross-plane heat conduction in a thin film of thickness $L$ subjected at $x=0$ to a spatially uniform sinusoidal heat flux $q(x=0,t)=\\Re\\{q_0 e^{i \\omega t}\\}$ and held at a reference temperature $T(L,t)=0$ at $x=L$. Assume a homogeneous, isotropic material with thermal conductivity $k$, mass density $\\rho$, specific heat capacity $c$, and thermal diffusivity $\\alpha=k/(\\rho c)$. Let the phonon mean free path be $\\lambda$ so that the Knudsen number is $Kn=\\lambda/L$, and let $\\tau$ denote a characteristic relaxation time. The goal is to compare four conduction models—classical Fourier conduction, Cattaneo-Vernotte (CV), Dual-Phase-Lag (DPL), and a grey Boltzmann Transport Equation (BTE) approximation—by computing the surface temperature response per unit applied heat flux amplitude and by algorithmically recommending an appropriate model based on $Kn$ and $\\omega \\tau$.\n\nFundamental base and governing equations:\n- Energy conservation in one dimension with constant volumetric heat capacity is $ \\rho c \\,\\partial T/\\partial t = -\\partial q/\\partial x$.\n- Constitutive relations:\n  - Fourier law: $ q = -k \\,\\partial T/\\partial x$.\n  - Cattaneo-Vernotte (CV): $ q + \\tau_q \\,\\partial q/\\partial t = -k \\,\\partial T/\\partial x$, where $\\tau_q$ is the heat flux relaxation time.\n  - Dual-Phase-Lag (DPL): $ q + \\tau_q \\,\\partial q/\\partial t = -k \\left(\\partial T/\\partial x + \\tau_T \\,\\partial^2 T/\\partial x \\partial t\\right)$, where $\\tau_T$ is the temperature gradient lag time.\n  - Grey Boltzmann Transport Equation (BTE) approximation in the frequency domain under the relaxation time approximation and spatial suppression: $ \\hat{q} = -k_\\mathrm{eff}(\\omega,Kn) \\,\\partial \\hat{T}/\\partial x$ with $ k_\\mathrm{eff}(\\omega,Kn) = \\frac{k}{1 + \\frac{4}{3} Kn}\\frac{1}{1 + i \\omega \\tau}$.\n\nHarmonic analysis:\nAssume a time-harmonic response $ T(x,t) = \\Re\\{\\hat{T}(x) e^{i \\omega t}\\}$ and $ q(x,t) = \\Re\\{\\hat{q}(x) e^{i \\omega t}\\}$. With an effective complex conductivity $k_\\mathrm{eff}(\\omega)$ that maps each model’s constitutive law to $ \\hat{q} = -k_\\mathrm{eff}(\\omega) \\,\\partial \\hat{T}/\\partial x$, the frequency-domain energy equation becomes $ i \\omega \\rho c \\,\\hat{T} = k_\\mathrm{eff}(\\omega) \\,\\partial^2 \\hat{T}/\\partial x^2$. This yields the Helmholtz form $ \\frac{d^2 \\hat{T}}{dx^2} - s^2 \\hat{T} = 0$ with complex wavenumber $ s^2 = \\frac{i \\omega \\rho c}{k_\\mathrm{eff}(\\omega)} = \\frac{i \\omega}{\\alpha} \\frac{k}{k_\\mathrm{eff}(\\omega)}$. For the four models, the effective conductivity is:\n- Fourier: $ k_\\mathrm{eff}(\\omega) = k$.\n- CV: $ k_\\mathrm{eff}(\\omega) = \\frac{k}{1 + i \\omega \\tau_q}$.\n- DPL: $ k_\\mathrm{eff}(\\omega) = k \\frac{1 + i \\omega \\tau_T}{1 + i \\omega \\tau_q}$.\n- BTE (grey, suppressed): $ k_\\mathrm{eff}(\\omega,Kn) = \\frac{k}{1 + \\frac{4}{3} Kn} \\frac{1}{1 + i \\omega \\tau}$.\n\nUnder boundary conditions $ T(L)=0$ and $ -k_\\mathrm{eff}(\\omega)\\,\\left.\\frac{d \\hat{T}}{dx}\\right|_{x=0} = q_0$, the solution for the complex temperature transfer function (surface temperature amplitude per unit applied heat flux amplitude) is $ H(\\omega) \\equiv \\frac{\\hat{T}(0)}{q_0} = \\frac{\\tanh(s L)}{k_\\mathrm{eff}(\\omega)\\, s}$. The physically measurable magnitude is $ |H(\\omega)|$ in Kelvin per Watt per square meter.\n\nModel recommendation logic:\nLet $\\Pi \\equiv \\omega \\tau$. Use the following regime-based decision:\n- If $Kn < 0.1$ and $\\Pi < 0.1$, recommend Fourier conduction.\n- If $Kn < 0.1$ and $\\Pi \\ge 0.1$, recommend CV if $\\tau_T = 0$; otherwise recommend DPL.\n- If $Kn \\ge 0.1$ and $\\Pi < 0.1$, recommend BTE.\n- If $Kn \\ge 0.1$ and $\\Pi \\ge 0.1$, recommend BTE.\n\nTask:\nWrite a program that, for each test case, computes $|H(\\omega)|$ for Fourier, CV, DPL, and BTE, and outputs these four floats along with the integer recommendation code ($0$ for Fourier, $1$ for Cattaneo-Vernotte, $2$ for Dual-Phase-Lag, $3$ for Boltzmann Transport Equation). Assume $q_0 = 1\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\nUnits:\n- Use $L$ in $\\mathrm{m}$, $k$ in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $\\rho c$ in $\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$, $\\lambda$ in $\\mathrm{m}$, $\\tau$, $\\tau_q$, $\\tau_T$ in $\\mathrm{s}$, $\\omega$ in $\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n- Express $|H(\\omega)|$ in $\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{W}^{-1}$ as floats.\n- The recommendation code is an integer.\n\nTest suite:\nCommon material parameters across all cases:\n- $k = 100\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$,\n- $\\rho c = 2\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$,\n- $\\lambda = 1\\times 10^{-7}\\,\\mathrm{m}$,\n- $\\tau_q = 1\\times 10^{-11}\\,\\mathrm{s}$,\n- $\\tau_T = 0.5\\times 10^{-11}\\,\\mathrm{s}$,\n- $\\tau = 1\\times 10^{-11}\\,\\mathrm{s}$.\n\nFive cases spanning regimes:\n1. Case A (diffusive, low frequency): $L = 1\\times 10^{-5}\\,\\mathrm{m}$, $\\omega = 1\\times 10^{9}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$; thus $Kn = 1\\times 10^{-2}$, $\\omega \\tau = 1\\times 10^{-2}$.\n2. Case B (low $Kn$, high frequency): $L = 1\\times 10^{-5}\\,\\mathrm{m}$, $\\omega = 1\\times 10^{12}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$; thus $Kn = 1\\times 10^{-2}$, $\\omega \\tau = 1\\times 10^{1}$.\n3. Case C (high $Kn$, low frequency): $L = 1\\times 10^{-7}\\,\\mathrm{m}$, $\\omega = 1\\times 10^{9}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$; thus $Kn = 1$, $\\omega \\tau = 1\\times 10^{-2}$.\n4. Case D (high $Kn$, very high frequency): $L = 1\\times 10^{-7}\\,\\mathrm{m}$, $\\omega = 1\\times 10^{13}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$; thus $Kn = 1$, $\\omega \\tau = 1\\times 10^{2}$.\n5. Case E (borderline): $L = 1\\times 10^{-6}\\,\\mathrm{m}$, $\\omega = 1\\times 10^{10}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$; thus $Kn = 1\\times 10^{-1}$, $\\omega \\tau = 1\\times 10^{-1}$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of the five per-case results, where each per-case result is itself a list of five numbers in the order $[|H|_\\mathrm{Fourier}, |H|_\\mathrm{CV}, |H|_\\mathrm{DPL}, |H|_\\mathrm{BTE}, \\text{model\\_code}]$. The line must be a comma-separated list with no spaces, enclosed in square brackets. For example, with two cases it would look like $[[a_1,b_1,c_1,d_1,e_1],[a_2,b_2,c_2,d_2,e_2]]$.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of non-equilibrium heat transfer, well-posed with sufficient information for a unique solution, and presented objectively. All provided equations and parameters are consistent and physically realistic for the specified domain of microscale thermal engineering.\n\nThe objective is to analyze one-dimensional, time-harmonic heat conduction across a thin film of thickness $L$ by calculating the surface temperature response for four distinct heat conduction models: classical Fourier, Cattaneo-Vernotte (CV), Dual-Phase-Lag (DPL), and a grey Boltzmann Transport Equation (BTE) approximation. The problem is defined by a sinusoidal heat flux boundary condition at one surface, $q(x=0,t)=\\Re\\{q_0 e^{i \\omega t}\\}$, and a fixed reference temperature at the other, $T(L,t)=0$. Based on the physical regime, defined by the Knudsen number $Kn$ and a dimensionless frequency $\\Pi = \\omega\\tau$, an appropriate model is to be recommended.\n\nThe analysis is performed in the frequency domain, where the temperature $T(x,t)$ and heat flux $q(x,t)$ are represented by complex phasors $\\hat{T}(x)$ and $\\hat{q}(x)$ such that $T(x,t) = \\Re\\{\\hat{T}(x) e^{i \\omega t}\\}$ and $q(x,t) = \\Re\\{\\hat{q}(x) e^{i \\omega t}\\}$. Combining the one-dimensional energy conservation equation, $\\rho c \\,\\partial T/\\partial t = -\\partial q/\\partial x$, with a generalized constitutive law of the form $\\hat{q} = -k_\\mathrm{eff}(\\omega) \\,\\partial \\hat{T}/\\partial x$, yields a Helmholtz equation for the complex temperature amplitude $\\hat{T}(x)$:\n$$\n\\frac{d^2 \\hat{T}}{dx^2} - s^2 \\hat{T} = 0\n$$\nThe parameter $s$ is the complex wavenumber, and its square is given by:\n$$\ns^2 = \\frac{i \\omega \\rho c}{k_\\mathrm{eff}(\\omega)} = \\frac{i \\omega}{\\alpha} \\frac{k}{k_\\mathrm{eff}(\\omega)}\n$$\nwhere $\\alpha = k/(\\rho c)$ is the bulk thermal diffusivity. The term $k_\\mathrm{eff}(\\omega)$ is an effective complex thermal conductivity that depends on the chosen heat conduction model.\n\nThe solution to this second-order ordinary differential equation with boundary conditions $\\hat{T}(L)=0$ and $-k_\\mathrm{eff}(\\omega)\\,\\left.\\frac{d \\hat{T}}{dx}\\right|_{x=0} = q_0$ gives the complex temperature transfer function, $H(\\omega)$, defined as the ratio of the surface temperature amplitude to the applied heat flux amplitude:\n$$\nH(\\omega) \\equiv \\frac{\\hat{T}(0)}{q_0} = \\frac{\\tanh(s L)}{k_\\mathrm{eff}(\\omega)\\, s}\n$$\nThe physically measurable quantity is the magnitude of this complex function, $|H(\\omega)|$.\n\nThe computational task involves evaluating $|H(\\omega)|$ for each of the four models by substituting their specific expressions for $k_\\mathrm{eff}(\\omega)$. Let $j$ represent the imaginary unit $i$.\n\n1.  **Fourier's Law**: This is the classical model, valid for low $Kn$ and low frequencies. The constitutive law is $q = -k \\,\\partial T/\\partial x$.\n    - Effective conductivity: $k_\\mathrm{eff,F} = k$.\n    - Wavenumber squared: $s_\\mathrm{F}^2 = \\frac{j \\omega \\rho c}{k} = \\frac{j \\omega}{\\alpha}$.\n\n2.  **Cattaneo-Vernotte (CV) Model**: This model introduces a single relaxation time $\\tau_q$ to account for thermal inertia, resulting in a hyperbolic heat equation. The constitutive law is $q + \\tau_q \\,\\partial q/\\partial t = -k \\,\\partial T/\\partial x$.\n    - Effective conductivity: $k_\\mathrm{eff,CV} = \\frac{k}{1 + j \\omega \\tau_q}$.\n    - Wavenumber squared: $s_\\mathrm{CV}^2 = \\frac{j \\omega \\rho c}{k} (1 + j \\omega \\tau_q) = \\frac{j \\omega}{\\alpha} (1 + j \\omega \\tau_q)$.\n\n3.  **Dual-Phase-Lag (DPL) Model**: This is a generalization of the CV model, including a second lag time $\\tau_T$ for the temperature gradient. The constitutive law is $q + \\tau_q \\,\\partial q/\\partial t = -k \\left(\\partial T/\\partial x + \\tau_T \\,\\partial^2 T/\\partial x \\partial t\\right)$.\n    - Effective conductivity: $k_\\mathrm{eff,DPL} = k \\frac{1 + j \\omega \\tau_T}{1 + j \\omega \\tau_q}$.\n    - Wavenumber squared: $s_\\mathrm{DPL}^2 = \\frac{j \\omega \\rho c}{k} \\frac{1 + j \\omega \\tau_q}{1 + j \\omega \\tau_T} = \\frac{j \\omega}{\\alpha} \\frac{1 + j \\omega \\tau_q}{1 + j \\omega \\tau_T}$.\n\n4.  **Grey Boltzmann Transport Equation (BTE) Approximation**: This model captures both spatial non-local (ballistic) effects through the Knudsen number $Kn = \\lambda/L$ and temporal non-local (relaxation) effects. The given approximation combines a spatial suppression factor with a frequency-dependent relaxation term.\n    - Effective conductivity: $k_{\\mathrm{eff,BTE}} = \\frac{k}{1 + \\frac{4}{3} Kn} \\frac{1}{1 + j \\omega \\tau}$.\n    - Wavenumber squared: $s_\\mathrm{BTE}^2 = \\frac{j \\omega \\rho c (1 + \\frac{4}{3} Kn) (1 + j \\omega \\tau)}{k} = \\frac{j \\omega}{\\alpha} (1 + \\frac{4}{3} Kn) (1 + j \\omega \\tau)$.\n\nThe algorithmic procedure for each test case, defined by $(L, \\omega)$, is as follows:\n- Calculate the constant thermal diffusivity $\\alpha = k/(\\rho c)$ and the case-specific Knudsen number $Kn = \\lambda / L$.\n- For each of the four models:\n    - Compute the model-specific complex effective conductivity $k_\\mathrm{eff}$.\n    - Compute the complex wavenumber squared $s^2$, and then $s = \\sqrt{s^2}$. The principal root (with a non-negative real part) is chosen.\n    - Evaluate the complex transfer function $H(\\omega) = \\frac{\\tanh(s L)}{s \\, k_\\mathrm{eff}}$.\n    - Compute and store its magnitude, $|H(\\omega)|$.\n- Determine the model recommendation based on the provided logic.\n    - Calculate $\\Pi = \\omega \\tau$.\n    - If $Kn < 0.1$ and $\\Pi < 0.1$: recommend Fourier (code $0$).\n    - If $Kn < 0.1$ and $\\Pi \\ge 0.1$: recommend DPL (code $2$), as the given $\\tau_T$ is non-zero.\n    - If $Kn \\ge 0.1$: recommend BTE (code $3$), irrespective of $\\Pi$.\n- Consolidate the four computed magnitudes and the integer recommendation code into a list. This process is repeated for all five test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes surface temperature response for four heat conduction models\n    and recommends a model based on physical regimes.\n    \"\"\"\n\n    # Common material parameters\n    k = 100.0  # W m^-1 K^-1\n    rho_c = 2e6  # J m^-3 K^-1\n    lambda_mfp = 1e-7  # m\n    tau_q = 1e-11  # s\n    tau_T = 0.5e-11  # s\n    tau = 1e-11  # s\n\n    # Thermal diffusivity\n    alpha = k / rho_c\n\n    # Test suite: (L in m, omega in rad/s)\n    test_cases = [\n        (1e-5, 1e9),   # Case A\n        (1e-5, 1e12),  # Case B\n        (1e-7, 1e9),   # Case C\n        (1e-7, 1e13),  # Case D\n        (1e-6, 1e10),  # Case E\n    ]\n\n    all_results = []\n\n    for L, omega in test_cases:\n        # Dimensionless numbers\n        kn = lambda_mfp / L\n        pi_val = omega * tau\n\n        # --- Model Calculations ---\n        # The core formula is H = tanh(s*L) / (k_eff * s)\n        # where s = sqrt(1j * omega * rho_c / k_eff)\n\n        # 1. Fourier Model\n        k_eff_f = k\n        s_f = np.sqrt(1j * omega / alpha)\n        h_f = np.tanh(s_f * L) / (k_eff_f * s_f)\n        mag_h_f = np.abs(h_f)\n\n        # 2. Cattaneo-Vernotte Model\n        k_eff_cv = k / (1 + 1j * omega * tau_q)\n        s_cv_sq = (1j * omega / alpha) * (1 + 1j * omega * tau_q)\n        s_cv = np.sqrt(s_cv_sq)\n        h_cv = np.tanh(s_cv * L) / (k_eff_cv * s_cv)\n        mag_h_cv = np.abs(h_cv)\n\n        # 3. Dual-Phase-Lag Model\n        k_eff_dpl = k * (1 + 1j * omega * tau_T) / (1 + 1j * omega * tau_q)\n        s_dpl_sq = (1j * omega / alpha) * (1 + 1j * omega * tau_q) / (1 + 1j * omega * tau_T)\n        s_dpl = np.sqrt(s_dpl_sq)\n        h_dpl = np.tanh(s_dpl * L) / (k_eff_dpl * s_dpl)\n        mag_h_dpl = np.abs(h_dpl)\n\n        # 4. BTE Model\n        k_eff_bte = (k / (1 + (4/3) * kn)) / (1 + 1j * omega * tau)\n        s_bte_sq = (1j * omega / alpha) * (1 + (4/3) * kn) * (1 + 1j * omega * tau)\n        s_bte = np.sqrt(s_bte_sq)\n        h_bte = np.tanh(s_bte * L) / (k_eff_bte * s_bte)\n        mag_h_bte = np.abs(h_bte)\n        \n        # --- Model Recommendation Logic ---\n        # Codes: 0=Fourier, 1=CV, 2=DPL, 3=BTE\n        model_code = -1 # Default/error\n        if kn < 0.1 and pi_val < 0.1:\n            model_code = 0  # Fourier\n        elif kn < 0.1 and pi_val >= 0.1:\n            if tau_T == 0:\n                model_code = 1  # Cattaneo-Vernotte\n            else:\n                model_code = 2  # Dual-Phase-Lag\n        elif kn >= 0.1:\n            model_code = 3 # BTE\n        \n        # Store results for this case\n        case_results = [mag_h_f, mag_h_cv, mag_h_dpl, mag_h_bte, model_code]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists with no spaces\n    # Example: [[v1,v2],[v3,v4]]\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}