{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的数值计算之前，验证基本方程在物理上是否合理至关重要。本练习将引导您对 Ffowcs Williams-Hawkings (FW-H) 方程中的载荷项进行量纲分析，从而加深对压力、力及其与辐射声场之间关系的理解。这项实践有助于您建立对气动声学中标度律的直观认识。",
            "id": "3968422",
            "problem": "在环境密度为 $\\rho_0$、声速为 $c_0$ 的均匀、静止流体中，Ffowcs Williams–Hawkings (FW-H) 方程（Ffowcs Williams–Hawkings, FW-H）描述了由一个运动表面 $S(t)$ 辐射的声场。该表面承载着由表面牵引力 $p_s(\\mathbf{x}',t)\\mathbf{n}(\\mathbf{x}',t)$ 表征的流体动力载荷，其中 $p_s$ 具有压力量纲，$\\mathbf{n}$ 是单位法向量。辐射声场可以用标量波动方程的三维自由空间推迟格林函数 $G(\\mathbf{x},t;\\mathbf{x}',t')$ 来表示，该函数满足\n$$\n\\left(\\frac{1}{c_0^{2}}\\frac{\\partial^{2}}{\\partial t^{2}}-\\nabla^{2}\\right)G(\\mathbf{x},t;\\mathbf{x}',t')=\\delta(\\mathbf{x}-\\mathbf{x}')\\,\\delta(t-t'),\n$$\n其中 $\\delta(\\cdot)$ 表示狄拉克δ分布。您可以假定以下量纲事实：\n- 时间上的狄拉克δ函数满足 $[\\delta(t)]=T^{-1}$，空间上的狄拉克δ函数满足 $[\\delta(\\mathbf{x})]=L^{-3}$。\n- 格林函数 $G$ 的量纲与上述波动方程一致。\n- 在声学紧致、远场极限下，主阶载荷贡献表现为偶极子源，其在距离 $r=|\\mathbf{x}-\\mathbf{x}'|$ 处观测到的振幅，与沿辐射方向的表面积分总流体动力的一阶时间导数乘以因子 $1/(c_0 r)$ 成比例。\n\n基于这些基础（标量波动方程、狄拉克δ分布的性质以及远场偶极子缩放），对 FW-H 载荷对观测者声压的贡献进行量纲一致性检查。具体要求如下：\n1. 根据标量波动方程确定格林函数 $G$ 的基本量纲。\n2. 将载荷产生的净流体动力定义为 $F(t)=\\displaystyle\\int_{S(t)} p_s(\\mathbf{x}',t)\\,\\mathbf{n}(\\mathbf{x}',t)\\cdot \\hat{\\mathbf{r}}\\,\\mathrm{d}S$，其中 $\\hat{\\mathbf{r}}$ 是从源点指向观测点的单位向量，并推导出 $F(t)$ 的基本量纲。\n3. 使用所述的远场偶极子缩放关系，组合 $\\dot{F}(t)$、$c_0$ 和 $r$ 的量纲，以获得载荷对观测者声压贡献的基本量纲。\n\n将您的最终答案表示为与所得观测量基本量纲 $M$、$L$ 和 $T$ 相对应的指数向量 $(\\alpha_M,\\alpha_L,\\alpha_T)$。请将最终的指数向量以单行矩阵形式给出。无需进行数值四舍五入。",
            "solution": "首先验证问题，以确保其具有科学依据、提法恰当且客观。该问题描述了用于气动声学噪声的 Ffowcs Williams–Hawkings (FW-H) 方程，这是流体动力学和声学中的一个标准且成熟的理论。格林函数的控制方程、狄拉克δ分布的性质以及偶极子源的远场缩放关系均根据既定的物理原​​理被正确地陈述。问题是自洽的，提供了执行所需量纲分析的所有必要定义和信息。语言精确且专业。因此，该问题被认为是有效的，可以构建解答。\n\n任务是根据所提供的缩放定律，通过确定载荷对所观测声压的贡献的量纲，来进行量纲一致性检查。这将按要求分三步完成。我们使用记号 $[Q]$ 来表示一个量 $Q$ 用质量（$M$）、长度（$L$）和时间（$T$）的基本量纲所表示的量纲。\n\n**第 1 步：确定格林函数 $G$ 的基本量纲。**\n\n格林函数 $G(\\mathbf{x},t;\\mathbf{x}',t')$ 由非齐次标量波动方程定义：\n$$\n\\left(\\frac{1}{c_0^{2}}\\frac{\\partial^{2}}{\\partial t^{2}}-\\nabla^{2}\\right)G(\\mathbf{x},t;\\mathbf{x}',t')=\\delta(\\mathbf{x}-\\mathbf{x}')\\,\\delta(t-t')\n$$\n为使此方程量纲一致，左侧各项的量纲必须相等，并且它们必须与右侧的量纲相匹配。让我们分析算子和源项的量纲。\n\n声速 $c_0$ 的量纲是长度除以时间，$[c_0] = LT^{-1}$。\n关于时间的二阶偏导数的量纲是 $[ \\frac{\\partial^2}{\\partial t^2} ] = T^{-2}$。\n拉普拉斯算子 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$ 的量纲是 $[ \\nabla^2 ] = L^{-2}$。\n\n因此，波动算子中第一项的量纲是：\n$$\n\\left[\\frac{1}{c_0^{2}}\\frac{\\partial^{2}}{\\partial t^{2}}\\right] = \\frac{1}{[c_0]^2} \\left[\\frac{\\partial^{2}}{\\partial t^{2}}\\right] = \\frac{1}{(LT^{-1})^2} T^{-2} = \\frac{1}{L^2 T^{-2}} T^{-2} = L^{-2}\n$$\n这与拉普拉斯算子的量纲 $[\\nabla^2] = L^{-2}$ 一致。因此，方程的整个左侧 (LHS) 的量纲为 $[LHS] = [G] L^{-2}$。\n\n右侧 (RHS) 由狄拉克δ分布的乘积组成。问题提供了它们的量纲：\n$[\\delta(\\mathbf{x}-\\mathbf{x}')] = L^{-3}$\n$[\\delta(t-t')] = T^{-1}$\n因此，RHS 的量纲是：\n$$\n[RHS] = [\\delta(\\mathbf{x}-\\mathbf{x}')\\,\\delta(t-t')] = [\\delta(\\mathbf{x}-\\mathbf{x}')] [\\delta(t-t')] = L^{-3} T^{-1}\n$$\n为了确保量纲齐次性，令 LHS 和 RHS 的量纲相等：\n$$\n[LHS] = [RHS] \\implies [G] L^{-2} = L^{-3} T^{-1}\n$$\n解出格林函数 $[G]$ 的量纲：\n$$\n[G] = (L^{-3} T^{-1}) L^2 = L^{-1} T^{-1}\n$$\n\n**第 2 步：推导净流体动力 $F(t)$ 的基本量纲。**\n\n净流体动力 $F(t)$ 由以下曲面积分定义：\n$$\nF(t)=\\displaystyle\\int_{S(t)} p_s(\\mathbf{x}',t)\\,\\mathbf{n}(\\mathbf{x}',t)\\cdot \\hat{\\mathbf{r}}\\,\\mathrm{d}S\n$$\n我们分析被积函数中每一项的量纲。\n项 $p_s$ 具有压力量纲。压力定义为单位面积上的力。力的量纲是质量乘以加速度，$[力] = M \\cdot LT^{-2} = MLT^{-2}$。面积的量纲是 $[面积] = L^2$。\n因此，压力的量纲是：\n$$\n[p_s] = \\frac{[力]}{[面积]} = \\frac{MLT^{-2}}{L^2} = ML^{-1}T^{-2}\n$$\n项 $\\mathbf{n}$（单位法向量）和 $\\hat{\\mathbf{r}}$（单位向量）是无量纲的，所以 $[\\mathbf{n}] = 1$ 且 $[\\hat{\\mathbf{r}}] = 1$。\n项 $\\mathrm{d}S$ 是一个曲面面积元，具有面积的量纲，$[\\mathrm{d}S] = L^2$。\n被积函数的量纲是其各因子量纲的乘积：\n$$\n[p_s\\,\\mathbf{n}\\cdot \\hat{\\mathbf{r}}\\,\\mathrm{d}S] = [p_s] [\\mathbf{n}] [\\hat{\\mathbf{r}}] [\\mathrm{d}S] = (ML^{-1}T^{-2}) \\cdot 1 \\cdot 1 \\cdot L^2 = MLT^{-2}\n$$\n该积分表示对表面 $S(t)$ 的求和。积分操作不会改变被积量的量纲。因此，$F(t)$ 的量纲与被积函数的量纲相同。\n$$\n[F(t)] = MLT^{-2}\n$$\n这与将 $F(t)$ 理解为力的物理意义是一致的。\n\n**第 3 步：组合量纲以获得观测者声压的基本量纲。**\n\n问题指出，对观测声压的主阶载荷贡献，我们记为 $p_{obs}$，其缩放关系如下：\n$$\np_{obs} \\propto \\frac{1}{c_0 r} \\dot{F}(t)\n$$\n其中 $\\dot{F}(t)$ 是力 $F(t)$ 的时间导数。我们可以将其写成一个量纲等式：\n$$\n[p_{obs}] = \\left[\\frac{1}{c_0 r}\\right] [\\dot{F}(t)]\n$$\n首先，我们求出 $\\dot{F}(t)$ 的量纲：\n$$\n[\\dot{F}(t)] = \\frac{[F(t)]}{[t]} = \\frac{MLT^{-2}}{T} = MLT^{-3}\n$$\n接下来，我们求出缩放因子 $\\frac{1}{c_0 r}$ 的量纲：\n项 $c_0$ 是声速，其量纲为 $[c_0] = LT^{-1}$。\n项 $r$ 是距离，其量纲为 $[r] = L$。\n$$\n\\left[\\frac{1}{c_0 r}\\right] = \\frac{1}{[c_0][r]} = \\frac{1}{(LT^{-1})(L)} = \\frac{1}{L^2 T^{-1}} = L^{-2}T\n$$\n现在，我们组合这些结果来求出观测压力的量纲：\n$$\n[p_{obs}] = (L^{-2}T) \\cdot (MLT^{-3}) = M L^{(-2+1)} T^{(1-3)} = M L^{-1} T^{-2}\n$$\n所得的观测声压量纲为 $M L^{-1} T^{-2}$。这与第 2 步中推导出的压力量纲一致。\n\n问题要求将最终答案表示为与基本量纲 $M$、$L$ 和 $T$ 相对应的指数向量 $(\\alpha_M, \\alpha_L, \\alpha_T)$。根据结果 $[p_{obs}] = M^1 L^{-1} T^{-2}$，我们有：\n$\\alpha_M = 1$\n$\\alpha_L = -1$\n$\\alpha_T = -2$\n指数向量是 $(1, -1, -2)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  -1  -2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本练习将理论付诸实践，针对一个常见情景——来自固定表面的噪声——实现了 FW-H 声学比拟的关键部分。您将推导简化的积分形式（即 Curle 积分），然后编写代码来处理模拟的计算流体动力学（CFD）压力数据，并计算远场声压。这项练习将理论公式与实际的计算气动声学（CAA）工作流程直接联系起来。",
            "id": "3968395",
            "problem": "一块尺寸为 $L_x \\times L_y$ 的平坦刚性矩形板位于 $z=0$ 平面内，其单位法向量 $\\mathbf{n}$ 与 $+z$ 轴对齐。一股稳态横向流在板上产生脉动的表面压力 $p(\\mathbf{x}_s,t)$。位于 $\\mathbf{x}_o$ 处的观察者记录由板的载荷产生的远场声压 $p'(\\mathbf{x}_o,t)$。您必须从一个有效的基础出发，并且不使用陈述中的任何简化公式，推导出一个适用于低马赫数下静止、不可穿透表面的可计算的远场表达式 $p'(\\mathbf{x}_o,t)$，然后设计并实现一个数值算法，以根据离散采样的计算流体动力学(CFD)压力数据来评估此表达式。\n\n请使用以下与上下文相符的基本原理和定义：\n- 在静止环境附近线性化的可压缩流动方程可导出关于 $p'(\\mathbf{x},t)$ 的、带有适当源项的非齐次声波方程。\n- 声波方程的自由空间格林函数决定了从声源到观察者的延迟时间辐射。\n- 对于静止、不可穿透的边界，在低马赫数远场辐射中，体积四极子项可以忽略，主要的载荷噪声贡献可以表示为作用在边界上的表面压力。\n\n基于这些原理，推导出适用于该板的 $p'(\\mathbf{x}_o,t)$ 表达式，并清晰陈述所有假设。然后，根据您的推导，在一个完整的、可运行的程序中实现以下数值评估策略：\n- 将板离散化为 $N_x \\times N_y$ 个矩形单元，使用中点求积法计算面积分。\n- 对于每个中心点为 $\\mathbf{x}_s$ 的表面单元，计算延迟时间 $t_r = t - r/c_0$，其中 $r = \\lVert \\mathbf{x}_o - \\mathbf{x}_s \\rVert$，$c_0$ 是环境声速。\n- 假设 $p(\\mathbf{x}_s,t)$ 的CFD数据在均匀采样频率 $f_s$ 下可用，使用对称有限差分和在 $t_r$ 处的线性插值，从离散样本中数值计算所需的 $p(\\mathbf{x}_s,t_r)$ 的时间导数。\n- 将所有单元的贡献相加，得到 $p'(\\mathbf{x}_o,t)$。\n\n讨论并用代码计算：当采样前应用了具有分数过渡裕度 $\\eta$ 的因果抗混叠滤波器时，要解析高达 $f_{\\max}$ (Hz) 的声学带宽所需的最小采样频率 $f_s$。明确陈述您的假设，并基于奈奎斯特准则和滤波器过渡带约束，提供一个以 $f_{\\max}$ 和 $\\eta$ 为函数的推荐 $f_s$ 公式。\n\n物理和数值单位：\n- 压力以帕斯卡 ($\\mathrm{Pa}$) 表示。\n- 距离以米 ($\\mathrm{m}$) 表示。\n- 时间以秒 ($\\mathrm{s}$) 表示。\n- 频率，包括采样频率，以赫兹 ($\\mathrm{Hz}$) 表示。\n- 不使用角度；请勿引入角度单位。\n\n您的程序必须使用在板上定义的如下合成类CFD压力数据来进行测试：\n- 任何表面点的压力在空间上是均匀的，由 $p(\\mathbf{x}_s,t) = p_0 \\cos(2\\pi f t)$ 给出，其中 $p_0$ 是压力幅值 (单位 $\\mathrm{Pa}$)，$f$ 是单音频率 (单位 $\\mathrm{Hz}$)。\n- 离散样本是在一个足够大的时间窗口内以均匀采样频率 $f_s$ 获得的，以覆盖所有需要的延迟时间评估，并使用线性插值来评估非网格时间点的值，以用于有限差分求导。\n\n测试套件和最终输出规范：\n为以下四个测试用例实现算法。对于每个用例，计算：\n- 在指定观测时间 $t$ 时的远场压力 $p'(\\mathbf{x}_o,t)$ (单位 $\\mathrm{Pa}$)。\n- 指示给定的采样频率 $f_s$ 是否足以根据您的推荐采样准则以裕度 $\\eta$ 解析目标声学带宽 $f_{\\max}$ 的布尔值。\n- 推荐的采样频率 $f_{s,\\mathrm{rec}}$ (单位 $\\mathrm{Hz}$)。\n\n用例 1 (正常情况):\n- $c_0 = 343\\,\\mathrm{m/s}$, $L_x = 0.2\\,\\mathrm{m}$, $L_y = 0.1\\,\\mathrm{m}$, $N_x = 20$, $N_y = 10$, $\\mathbf{x}_o = (0,0,1)\\,\\mathrm{m}$, $p_0 = 2\\,\\mathrm{Pa}$, $f = 1000\\,\\mathrm{Hz}$, $f_s = 20000\\,\\mathrm{Hz}$, $t = 0.01\\,\\mathrm{s}$, $f_{\\max} = 5000\\,\\mathrm{Hz}$, $\\eta = 0.2$。\n\n用例 2 (偶极子零点几何构型边缘情况):\n- $c_0 = 343\\,\\mathrm{m/s}$, $L_x = 0.2\\,\\mathrm{m}$, $L_y = 0.1\\,\\mathrm{m}$, $N_x = 20$, $N_y = 10$, $\\mathbf{x}_o = (0.3,0,0)\\,\\mathrm{m}$, $p_0 = 2\\,\\mathrm{Pa}$, $f = 1000\\,\\mathrm{Hz}$, $f_s = 20000\\,\\mathrm{Hz}$, $t = 0.01\\,\\mathrm{s}$, $f_{\\max} = 5000\\,\\mathrm{Hz}$, $\\eta = 0.2$。\n\n用例 3 (接近奈奎斯特频率的边界采样):\n- $c_0 = 343\\,\\mathrm{m/s}$, $L_x = 0.2\\,\\mathrm{m}$, $L_y = 0.1\\,\\mathrm{m}$, $N_x = 10$, $N_y = 5$, $\\mathbf{x}_o = (0,0,1)\\,\\mathrm{m}$, $p_0 = 1\\,\\mathrm{Pa}$, $f = 8000\\,\\mathrm{Hz}$, $f_s = 16000\\,\\mathrm{Hz}$, $t = 0.005\\,\\mathrm{s}$, $f_{\\max} = 8000\\,\\mathrm{Hz}$, $\\eta = 0.25$。\n\n用例 4 (采样裕度不足):\n- $c_0 = 343\\,\\mathrm{m/s}$, $L_x = 0.2\\,\\mathrm{m}$, $L_y = 0.1\\,\\mathrm{m}$, $N_x = 20$, $N_y = 10$, $\\mathbf{x}_o = (0,0,0.5)\\,\\mathrm{m}$, $p_0 = 0.5\\,\\mathrm{Pa}$, $f = 3000\\,\\mathrm{Hz}$, $f_s = 6000\\,\\mathrm{Hz}$, $t = 0.003\\,\\mathrm{s}$, $f_{\\max} = 3000\\,\\mathrm{Hz}$, $\\eta = 0.1$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个以逗号分隔的列表的列表，每个内部列表对应一个测试用例，形式为 $[p',\\mathrm{bool},f_{s,\\mathrm{rec}}]$。例如，$[[p'_1,\\mathrm{bool}_1,f_{s,\\mathrm{rec},1}],[p'_2,\\mathrm{bool}_2,f_{s,\\mathrm{rec},2}],\\dots]$。$p'$ 以 $\\mathrm{Pa}$ 表示，布尔值表示为 $\\mathrm{True}$ 或 $\\mathrm{False}$，$f_{s,\\mathrm{rec}}$ 以 $\\mathrm{Hz}$ 表示。",
            "solution": "用户提供的问题陈述经过了严格验证，被认为是科学上可靠、适定、客观且自洽的。它提出了一个计算航空声学中的标准问题，可以使用既定原理进行形式化和求解。所有必要的数据都已提供，约束条件一致且符合物理实际。因此，该问题是有效的。\n\n求解过程分为两部分：首先，推导远场声压的控制方程；其次，开发一个数值算法来评估该方程。\n\n### 第1部分：远场声压的推导\n\n物理问题是计算由脉动表面压力载荷作用下的静止刚性板所辐射的声。本分析的出发点是声学比拟法，特别是 Curle 对 Lighthill 理论的扩展，以包含固体边界。对于低马赫数流体流经一个静止、不可穿透的表面，观察者位置 $\\mathbf{x}_o$ 和时间 $t$ 处的声压 $p'(\\mathbf{x}_o,t)$ 可以表示为厚度噪声和载荷噪声之和。\n\n厚度噪声由运动表面对流体的排挤引起，对于问题陈述中给定的静止表面，该噪声为零。\n\n载荷噪声由表面施加于流体的力引起，是主要声源。来自静止表面 $S$ 的载荷噪声的通用表达式由 Curle 积分给出：\n$$\np'(\\mathbf{x}_o, t) = \\frac{1}{4\\pi} \\int_S \\left( \\frac{[\\dot{p}']_{t_r}}{r c_0} (\\mathbf{n} \\cdot \\hat{\\mathbf{r}}) + \\frac{[p']_{t_r}}{r^2} (\\mathbf{n} \\cdot \\hat{\\mathbf{r}}) \\right) dS(\\mathbf{x}_s)\n$$\n其中 $\\mathbf{x}_s$ 是表面 $S$ 上的一个点，$\\mathbf{r} = \\mathbf{x}_o - \\mathbf{x}_s$ 是从源点到观察者的矢量，$r = \\lVert\\mathbf{r}\\rVert$，且 $\\hat{\\mathbf{r}} = \\mathbf{r}/r$。表面上的压力脉动为 $p'(\\mathbf{x}_s, t)$，符号 $[\\cdot]_{t_r}$ 表示在延迟时间 $t_r = t - r/c_0$ 处进行求值。声速为 $c_0$，$\\mathbf{n}$ 是表面上的单位法向量，指向流体域。时间导数用 $\\dot{p}'$ 表示。\n\n被积函数中的第一项，与 $1/r$ 成正比，在远场 (其中 $r \\gg \\lambda$，$\\lambda$ 为声波波长) 中占主导地位；而第二项，与 $1/r^2$ 成正比，是一种近场流体动力学效应。由于问题要求一个“可计算的远场表达式”，我们只保留主导的远场项：\n$$\np'(\\mathbf{x}_o, t) \\approx \\frac{1}{4\\pi c_0} \\int_S \\frac{(\\mathbf{n} \\cdot \\hat{\\mathbf{r}})}{r} \\left[ \\frac{\\partial p(\\mathbf{x}_s, t)}{\\partial t} \\right]_{t_r} dS(\\mathbf{x}_s)\n$$\n在这里，我们用总表面压力 $p$ 替换了压力脉动 $p'$，因为环境压力的时间导数为零。\n\n对于指定的几何形状，板位于 $z=0$ 平面，其法向量为 $\\mathbf{n} = (0, 0, 1)$。位于 $\\mathbf{x}_o = (x_o, y_o, z_o)$ 的观察者和位于 $\\mathbf{x}_s = (x_s, y_s, 0)$ 的源点给出的矢量为 $\\mathbf{r} = (x_o - x_s, y_o - y_s, z_o)$。点积 $\\mathbf{n} \\cdot \\mathbf{r}$ 就是 $z_o$。因此，$\\mathbf{n} \\cdot \\hat{\\mathbf{r}} = z_o/r$。将此代入远场表达式，得到待实现的公式：\n$$\np'(\\mathbf{x}_o, t) = \\frac{1}{4\\pi c_0} \\int_S \\frac{z_o}{r(\\mathbf{x}_s)^2} \\left. \\frac{\\partial p(\\mathbf{x}_s, \\tau)}{\\partial \\tau} \\right|_{\\tau=t_r} dS(\\mathbf{x}_s)\n$$\n此表达式在以下假设下有效：\n1.  观察者位于源板的声学远场。\n2.  产生压力的流动是低马赫数的。\n3.  板是静止、刚性且不可穿透的。\n4.  周围介质是均匀静止的流体。\n\n### 第2部分：数值评估算法\n\n上面推导的积分按规定进行数值评估。\n\n**表面离散化：** 将面积为 $L_x \\times L_y$ 的矩形板离散化为 $N_x \\times N_y$ 个更小的矩形单元网格。每个单元的面积为 $\\Delta S = (L_x/N_x) \\cdot (L_y/N_y)$。面积分采用中点求积法则进行近似，该法则用所有单元上的求和代替积分，并在每个单元的中心评估被积函数。单元中心坐标为 $\\mathbf{x}_{s,ij}$，其中 $i \\in \\{0, \\dots, N_x-1\\}$ 且 $j \\in \\{0, \\dots, N_y-1\\}$。\n\n因此，积分公式变为离散和：\n$$\np'(\\mathbf{x}_o, t) \\approx \\frac{\\Delta S}{4\\pi c_0} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} \\frac{z_o}{r_{ij}^2} \\left. \\frac{\\partial p(\\mathbf{x}_{s,ij}, \\tau)}{\\partial \\tau} \\right|_{\\tau=t_{r,ij}}\n$$\n其中 $r_{ij} = \\lVert \\mathbf{x}_o - \\mathbf{x}_{s,ij} \\rVert$ 且 $t_{r,ij} = t - r_{ij}/c_0$。问题陈述中指出，板上的压力在空间上是均匀的，即 $p(\\mathbf{x}_s, t) = p(t)$，这进一步简化了评估。\n\n**数值微分：** 时间导数 $\\partial p / \\partial \\tau$ 使用二阶对称有限差分格式进行数值计算。对于在离散时间点（间距为 $T_s = 1/f_s$）已知的函数 $p(\\tau)$，其在任意时间 $\\tau$ 的导数可近似为：\n$$\n\\frac{dp}{d\\tau} \\approx \\frac{p(\\tau + h) - p(\\tau - h)}{2h}\n$$\n一个合适的步长选择是 $h = T_s$。所需的压力值 $p(\\tau + T_s)$ 和 $p(\\tau - T_s)$ 通过对以均匀采样频率 $f_s$ 提供的离散样本进行线性插值获得，因为求值时间 $t_{r,ij} \\pm T_s$ 通常不与采样点重合。\n\n### 第3部分：采样频率准则\n\n为了可靠地捕获最大频率成分为 $f_{\\max}$ 的信号，奈奎斯特-香农采样定理指出，采样频率 $f_s$ 必须大于该最大频率的两倍，即 $f_s > 2 f_{\\max}$。这假设了一个理想的“砖墙式”抗混叠滤波器。实际的滤波器在通带和阻带之间有一个非零的过渡带。\n\n设通带边缘为 $f_p = f_{\\max}$。为防止混叠，阻带边缘 $f_{stop}$ 必须不高于奈奎斯特频率 $f_s/2$。问题指定了一个分数过渡裕度 $\\eta$。我们将其解释为定义过渡带宽度相对于感兴趣的最大频率，使得过渡带宽为 $\\eta f_{\\max}$。\n\n因此，阻带始于 $f_{stop} = f_p + \\eta f_{\\max} = f_{\\max}(1 + \\eta)$。防止混叠的条件是 $f_{stop} \\le f_s/2$。这导致了对推荐的最小采样频率 $f_{s,\\mathrm{rec}}$ 的以下准则：\n$$\nf_{\\max}(1 + \\eta) \\le \\frac{f_s}{2} \\implies f_s \\ge 2 f_{\\max}(1 + \\eta)\n$$\n因此，我们将推荐的采样频率定义为：\n$$\nf_{s,\\mathrm{rec}} = 2 f_{\\max}(1 + \\eta)\n$$\n如果 $f_s \\ge f_{s,\\mathrm{rec}}$，则给定的采样频率 $f_s$ 是足够的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the aeroacoustics problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 20, \"Ny\": 10,\n            \"xo\": (0.0, 0.0, 1.0), \"p0\": 2.0, \"f\": 1000.0, \"fs\": 20000.0,\n            \"t\": 0.01, \"f_max\": 5000.0, \"eta\": 0.2\n        },\n        # Case 2\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 20, \"Ny\": 10,\n            \"xo\": (0.3, 0.0, 0.0), \"p0\": 2.0, \"f\": 1000.0, \"fs\": 20000.0,\n            \"t\": 0.01, \"f_max\": 5000.0, \"eta\": 0.2\n        },\n        # Case 3\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 10, \"Ny\": 5,\n            \"xo\": (0.0, 0.0, 1.0), \"p0\": 1.0, \"f\": 8000.0, \"fs\": 16000.0,\n            \"t\": 0.005, \"f_max\": 8000.0, \"eta\": 0.25\n        },\n        # Case 4\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 20, \"Ny\": 10,\n            \"xo\": (0.0, 0.0, 0.5), \"p0\": 0.5, \"f\": 3000.0, \"fs\": 6000.0,\n            \"t\": 0.003, \"f_max\": 3000.0, \"eta\": 0.1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        c0 = case[\"c0\"]\n        Lx, Ly = case[\"Lx\"], case[\"Ly\"]\n        Nx, Ny = case[\"Nx\"], case[\"Ny\"]\n        x_o_vec = np.array(case[\"xo\"])\n        p0, f, fs = case[\"p0\"], case[\"f\"], case[\"fs\"]\n        t_obs = case[\"t\"]\n        f_max, eta = case[\"f_max\"], case[\"eta\"]\n\n        # Part 1: Sampling frequency analysis\n        f_s_rec = 2 * f_max * (1 + eta)\n        is_sufficient = fs >= f_s_rec\n\n        # Part 2: Acoustic pressure calculation\n        p_prime = 0.0\n\n        # Handle dipole null case efficiently\n        if x_o_vec[2] == 0:\n            p_prime = 0.0\n        else:\n            delta_x = Lx / Nx\n            delta_y = Ly / Ny\n            delta_S = delta_x * delta_y\n            Ts = 1.0 / fs\n            \n            # Create grid of surface element centers\n            x_centers = np.linspace(-Lx/2 + delta_x/2, Lx/2 - delta_x/2, Nx)\n            y_centers = np.linspace(-Ly/2 + delta_y/2, Ly/2 - delta_y/2, Ny)\n            xs_grid, ys_grid = np.meshgrid(x_centers, y_centers)\n            \n            # Vectorized calculation of distances and retarded times\n            # Reshape for broadcasting\n            xs_flat = xs_grid.flatten()\n            ys_flat = ys_grid.flatten()\n\n            r_vecs = x_o_vec - np.vstack([xs_flat, ys_flat, np.zeros_like(xs_flat)]).T\n            r_mags = np.linalg.norm(r_vecs, axis=1)\n            retarded_times = t_obs - r_mags / c0\n\n            # Determine time window for synthetic signal\n            t_min_eval = np.min(retarded_times) - Ts\n            t_max_eval = np.max(retarded_times) + Ts\n            \n            # Generate discrete pressure signal for interpolation\n            # Use floor/ceil to ensure the range is fully covered\n            num_samples = int(np.ceil((t_max_eval - t_min_eval) * fs)) + 2\n            t_samples_start = np.floor(t_min_eval * fs) / fs\n            t_samples = t_samples_start + np.arange(num_samples) * Ts\n            p_samples = p0 * np.cos(2 * np.pi * f * t_samples)\n\n            # Times for finite difference\n            t1 = retarded_times - Ts\n            t2 = retarded_times + Ts\n\n            # Interpolate pressure at required times\n            p1 = np.interp(t1, t_samples, p_samples)\n            p2 = np.interp(t2, t_samples, p_samples)\n\n            # Compute numerical derivative\n            dp_dt_num = (p2 - p1) / (2 * Ts)\n\n            # Sum contributions from all elements\n            # The integrand is (z_o / r^2) * dp_dt\n            z_o = x_o_vec[2]\n            integrand_values = (z_o / (r_mags**2)) * dp_dt_num\n            \n            # Perform the summation\n            integral_sum = np.sum(integrand_values)\n\n            # Final pressure calculation\n            p_prime = (delta_S / (4 * np.pi * c0)) * integral_sum\n\n        results.append([p_prime, is_sufficient, f_s_rec])\n\n    # Format and print the final output\n    # `str()` on a list correctly formats it with brackets, and on a boolean with T/F.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "FW-H 方程的真正威力在于其处理运动声源（如直升机旋翼或螺旋桨）的能力。其中一个关键且通常富有挑战性的步骤是求解“延迟时间”——即声音在特定时刻到达观察者所对应的发射瞬间。本练习专注于为沿螺旋轨迹运动的声源实现一个稳健的延迟时间方程数值求解器，并处理高速情况下可能出现多重解等问题。",
            "id": "3968410",
            "problem": "考虑在 Lighthill 声学比拟和 Ffowcs Williams–Hawkings (FW–H) 公式的框架内，对移动声源的远场声学进行预测。从均匀、静止介质中声速 $c$ 恒定的非齐次标量波动方程开始：\n$$\n\\frac{1}{c^2}\\,\\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = s(\\boldsymbol{x},t),\n$$\n其中 $p'(\\boldsymbol{x},t)$ 是声压脉动，$\\boldsymbol{x}\\in\\mathbb{R}^3$ 是观测者位置，$t$ 是时间，单位为秒，$s(\\boldsymbol{x},t)$ 是一个有效声源项，源于与 Lighthill 声学比拟或 Ffowcs Williams–Hawkings 扩展一致的流动诱导应力。在自由空间中，左侧算子的因果格林函数支撑在声锥上。利用这一事实推导出一个约束条件，即在源位置 $\\boldsymbol{y}(\\tau)$ 和时间 $\\tau$ 发出的任何贡献，仅当其满足一个通过声速 $c$ 将 $t$、$\\tau$、$\\boldsymbol{x}$ 和 $\\boldsymbol{y}(\\tau)$ 联系起来的因果关系时，才会在 $(\\boldsymbol{x},t)$ 处被观测到。请从波动算子及其自由空间格林函数出发，依据第一性原理显式地推导这个因果性约束，而不要引用任何预先推导的声学比拟辐射积分。\n\n然后，将问题具体化为一个旋转叶片单元，该单元被建模为在具有恒定角速度和轴向进速的螺旋轨迹上运动的点运动源。声源轨迹为\n$$\n\\boldsymbol{y}(\\tau) = \n\\begin{bmatrix}\nR\\cos\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nR\\sin\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nz_0 + U\\,\\tau\n\\end{bmatrix},\n$$\n其中 $R$ 是叶片单元半径，单位为米，$\\Omega$ 是角速度，单位为弧度/秒，$\\psi_0$ 是初始方位角，单位为弧度，$U$ 是恒定的轴向进速，单位为米/秒，$z_0$ 是初始轴向位置，单位为米，$\\tau$ 是发射时间，单位为秒。观测者位于\n$$\n\\boldsymbol{x} = \\begin{bmatrix} x \\\\ y \\\\ z \\end{bmatrix}\\;\\;\\text{单位为米，}\n$$\n观测时间为 $t$，单位为秒。仅使用您推导出的因果性约束，构建一个非线性方程，该方程的解是与此移动声源的 $(\\boldsymbol{x},t)$ 相关联的延迟发射时间 $t_r$。\n\n您的任务是实现一个稳健的数值算法，对于给定的参数 $(c,R,\\Omega,\\psi_0,U,z_0,\\boldsymbol{x},t)$ 和一个有界搜索窗口 $[t-\\Delta T,\\,t]$（其中 $\\Delta T>0$），该算法能返回窗口内所有满足因果性约束的延迟时间 $t_r$。该算法必须设计为能够检测存在多个解的情况（例如，当切向速度在轨迹的某些部分超过 $c$ 时），并能处理当求根函数斜率很小时的近简并情况。该算法必须：\n- 通过使用 $N$ 个网格点进行均匀采样，在区间 $[t-\\Delta T,\\,t]$ 上构建变号区间。\n- 使用保证在连续性条件下收敛的区间法，将每个检测到的区间优化至一个根。\n- 通过一个容差来去重数值上重合的根，并返回一个排序后的唯一根列表。\n\n除了计算 $t_r$ 之外，您的实现必须在内部计算相应的延迟源位置 $\\boldsymbol{y}(t_r)$ 以验证正确性，即使您不将这些位置包含在最终输出中。所有角度单位均为弧度。所有距离单位均为米。所有时间单位均为秒。声速 $c$ 的单位必须是米/秒。\n\n设计您的程序以评估以下测试套件。对于每个测试用例 $i$，程序必须在窗口 $[t_i-\\Delta T_i,\\,t_i]$ 中使用 $N_i$ 个网格点搜索 $t_r$，并以排序列表的形式返回所有找到的根。将每个返回的 $t_r$ 以秒为单位表示，并精确到六位小数。\n\n- 测试用例 A（亚音速，一般位置）：\n  - $c = 343.0$, $R = 0.75$, $\\Omega = 200.0$, $\\psi_0 = 0.0$, $U = 10.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,5.0,\\,0.0,\\,1.0\\,]$, $t = 0.04$,\n  - $\\Delta T = 0.05$, $N = 20000$.\n\n- 测试用例 B（近掠射，高亚音速叶尖速度）：\n  - $c = 343.0$, $R = 1.0$, $\\Omega = 300.0$, $\\psi_0 = 1.2$, $U = 0.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,2.0,\\,3.0,\\,0.1\\,]$, $t = 0.02$,\n  - $\\Delta T = 0.05$, $N = 20000$.\n\n- 测试用例 C（超音速叶尖速度，可能存在多个根）：\n  - $c = 343.0$, $R = 1.0$, $\\Omega = 400.0$, $\\psi_0 = 0.3$, $U = 0.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,10.0,\\,0.0,\\,0.0\\,]$, $t = 0.08$,\n  - $\\Delta T = 0.10$, $N = 40000$.\n\n- 测试用例 D（在过短的窗口内无根）：\n  - $c = 343.0$, $R = 0.5$, $\\Omega = 100.0$, $\\psi_0 = 0.0$, $U = 0.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,100.0,\\,0.0,\\,0.0\\,]$, $t = 1.0$,\n  - $\\Delta T = 0.001$, $N = 2000$.\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，顺序与 A、B、C、D 相同，其本身是一个列表，包含在指定窗口内找到的已排序的延迟时间 $t_r$（单位为秒），每个时间都四舍五入到六位小数。例如，如果一个测试用例产生两个根 $t_{r,1}$ 和 $t_{r,2}$，相应的元素应如 $[t_{r,1},t_{r,2}]$，如果没有找到根，则应为 $[]$。",
            "solution": "该问题要求推导由移动声源发射的声波的因果性约束，并将其应用于特定的螺旋源轨迹。随后，必须开发一种数值算法来求解延迟发射时间。\n\n首先，我们从第一性原理推导因果性约束。我们从声速为 $c$ 的静止均匀介质中的声压扰动 $p'(\\boldsymbol{x},t)$ 的非齐次标量波动方程开始：\n$$\n\\frac{1}{c^2}\\,\\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = s(\\boldsymbol{x},t)\n$$\n这个线性偏微分方程可以使用达朗贝尔算子 $\\Box = \\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2} - \\nabla^2$ 紧凑地写为 $\\Box p'(\\boldsymbol{x},t) = s(\\boldsymbol{x},t)$。其解可以使用自由空间格林函数 $G(\\boldsymbol{x},t; \\boldsymbol{y},\\tau)$ 正式表示，该函数是 $\\Box G = \\delta(\\boldsymbol{x}-\\boldsymbol{y})\\delta(t-\\tau)$ 的解，其中 $\\delta(\\cdot)$ 是 Dirac δ 函数。物理上正确的（因果的）格林函数，确保了结果不会先于其原因，由下式给出：\n$$\nG(\\boldsymbol{x},t; \\boldsymbol{y},\\tau) = \\frac{\\delta\\left(t - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}|}{c}\\right)}{4\\pi|\\boldsymbol{x}-\\boldsymbol{y}|}\n$$\n然后，通过将声源项与格林函数在所有源位置 $\\boldsymbol{y}$ 和发射时间 $\\tau$ 上进行卷积来求得压力场：\n$$\np'(\\boldsymbol{x},t) = \\int_{-\\infty}^{\\infty} \\int_{V} s(\\boldsymbol{y},\\tau) G(\\boldsymbol{x},t; \\boldsymbol{y},\\tau) \\,d^3\\boldsymbol{y}\\,d\\tau\n$$\n代入 $G$ 的表达式，我们得到：\n$$\np'(\\boldsymbol{x},t) = \\int_{-\\infty}^{\\infty} \\int_{V} s(\\boldsymbol{y},\\tau) \\frac{\\delta\\left(t - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}|}{c}\\right)}{4\\pi|\\boldsymbol{x}-\\boldsymbol{y}|} \\,d^3\\boldsymbol{y}\\,d\\tau\n$$\nDirac δ 函数的关键特性是其筛选性质：$\\int f(z) \\delta(z-a) dz = f(a)$。将其应用于对 $\\tau$ 的积分，δ 函数仅在其自变量为零时才非零。这对观测者的时空坐标 $(\\boldsymbol{x},t)$ 和声源的时空坐标 $(\\boldsymbol{y},\\tau)$ 之间的关系施加了严格的约束。对于来自 $(\\boldsymbol{y},\\tau)$ 处源单元的任何贡献要在 $(\\boldsymbol{x},t)$ 处被感知到，必须满足以下关系：\n$$\nt - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}|}{c} = 0\n$$\n这就是因果性约束。它表明，观测时间 $t$ 必须等于发射时间 $\\tau$ 加上声音以速度 $c$ 传播距离 $|\\boldsymbol{x}-\\boldsymbol{y}|$ 所需的时间。对于给定的 $t$ 满足此关系的时间 $\\tau$ 称为延迟时间，通常表示为 $t_r$。\n\n对于沿轨迹 $\\boldsymbol{y}(\\tau)$ 运动的声源，因果性约束成为仅与发射时间 $\\tau$ 相关的函数：\n$$\nt - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}(\\tau)|}{c} = 0\n$$\n可以重新整理以突出传播时间：$t-\\tau = \\frac{|\\boldsymbol{x}-\\boldsymbol{y}(\\tau)|}{c}$。必须求解该方程以找到与给定观测时间 $t$ 对应的延迟时间 $t_r$。\n\n接下来，我们将其具体应用于给定的螺旋源轨迹：\n$$\n\\boldsymbol{y}(\\tau) = \n\\begin{bmatrix}\nR\\cos\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nR\\sin\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nz_0 + U\\,\\tau\n\\end{bmatrix}\n$$\n观测者位于 $\\boldsymbol{x} = [x, y, z]^T$。我们寻求求解因果性方程的延迟时间 $t_r$。在数值上，使用平方形式以消除平方根是更可取的。由于 $t > t_r$，项 $t-t_r$ 是正的，因此我们可以对 $c(t-t_r) = |\\boldsymbol{x}-\\boldsymbol{y}(t_r)|$ 的两边进行平方而不会引入伪解：\n$$\nc^2(t-t_r)^2 = |\\boldsymbol{x}-\\boldsymbol{y}(t_r)|^2\n$$\n距离的平方是：\n$$\n|\\boldsymbol{x}-\\boldsymbol{y}(t_r)|^2 = (x - R\\cos(\\psi_0 + \\Omega t_r))^2 + (y - R\\sin(\\psi_0 + \\Omega t_r))^2 + (z - (z_0 + U t_r))^2\n$$\n因此，求解延迟时间 $t_r$ 的非线性方程就是找到函数 $g(t_r)$ 的根：\n$$\ng(t_r) = c^2(t-t_r)^2 - \\left[ (x - R\\cos(\\psi_0 + \\Omega t_r))^2 + (y - R\\sin(\\psi_0 + \\Omega t_r))^2 + (z - z_0 - U t_r)^2 \\right] = 0\n$$\n该方程必须进行数值求解。\n\n在搜索窗口 $[t-\\Delta T, t]$ 内寻找 $g(t_r)=0$ 的根 $t_r$ 的指定算法如下：\n1.  **定义函数** $g(t_r)$，基于给定测试用例的参数。\n2.  **采样定义域**：在区间 $[t-\\Delta T, t]$ 内创建一个包含 $N$ 个点的均匀网格 $\\tau_j$。在每个网格点上评估 $g(\\tau_j)$。\n3.  **寻找区间**：遍历网格点。如果 $g(\\tau_j)$ 和 $g(\\tau_{j+1})$ 符号相反（即 $g(\\tau_j) \\cdot g(\\tau_{j+1})  0$），则区间 $[\\tau_j, \\tau_{j+1}]$ 是一个包含至少一个根的区间。存储所有这样的区间。此方法能可靠地找到相对于网格间距足够分离的简单根。\n4.  **优化求根**：对于每个区间 $[a, b]$，使用一个在区间上有效的稳健数值求根算法。`scipy.optimize.brentq` 函数实现了 Brent 方法，是绝佳选择，因为它保证了连续函数在有效区间内的收敛性。\n5.  **去重与排序**：该过程可能会对同一个根产生多个数值上接近的近似值，特别是当根靠近网格点时。将找到的根列表排序，然后进行去重步骤，即遍历排序后的列表，仅保留与前一个根的差值大于一个很小的值（例如 $10^{-9}$）的根。这可以移除数值上的重复项。\n6.  **格式化输出**：对每个测试用例，将最终的唯一、已排序的根四舍五入到所需的小数位数。\n\n此过程对于寻找未知数量的根是稳健的，并且对于涉及超音速源运动 ($R\\Omega  c$) 的情况尤其必要，在这种情况下，单个观测时间可能对应多个延迟时间。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for finding retarded times.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A (subsonic, general position)\n        {\n            'c': 343.0, 'R': 0.75, 'Omega': 200.0, 'psi0': 0.0, 'U': 10.0, 'z0': 0.0,\n            'x_obs': np.array([5.0, 0.0, 1.0]), 't': 0.04,\n            'delta_T': 0.05, 'N': 20000\n        },\n        # Test case B (near-grazing, high subsonic tip speed)\n        {\n            'c': 343.0, 'R': 1.0, 'Omega': 300.0, 'psi0': 1.2, 'U': 0.0, 'z0': 0.0,\n            'x_obs': np.array([2.0, 3.0, 0.1]), 't': 0.02,\n            'delta_T': 0.05, 'N': 20000\n        },\n        # Test case C (supersonic tip speed, multiple roots possible)\n        {\n            'c': 343.0, 'R': 1.0, 'Omega': 400.0, 'psi0': 0.3, 'U': 0.0, 'z0': 0.0,\n            'x_obs': np.array([10.0, 0.0, 0.0]), 't': 0.08,\n            'delta_T': 0.10, 'N': 40000\n        },\n        # Test case D (no root within a too-short window)\n        {\n            'c': 343.0, 'R': 0.5, 'Omega': 100.0, 'psi0': 0.0, 'U': 0.0, 'z0': 0.0,\n            'x_obs': np.array([100.0, 0.0, 0.0]), 't': 1.0,\n            'delta_T': 0.001, 'N': 2000\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        roots = find_retarded_times(**params)\n        # Format each root to 6 decimal places as a string\n        formatted_roots = [f\"{r:.6f}\" for r in roots]\n        # Create the string representation of the list of roots\n        all_results.append(f\"[{','.join(formatted_roots)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\ndef find_retarded_times(c, R, Omega, psi0, U, z0, x_obs, t, delta_T, N):\n    \"\"\"\n    Finds all retarded times t_r in the window [t-delta_T, t] for a given\n    set of parameters using a bracketing and root-finding approach.\n    \"\"\"\n    \n    # Unpack observer coordinates\n    x, y, z = x_obs\n\n    # Define the nonlinear function g(t_r) = 0 for the retarded time.\n    # g(t_r) = c^2 * (t - t_r)^2 - |x - y(t_r)|^2\n    def g(tr):\n        # Calculate source position y(t_r) components\n        arg = psi0 + Omega * tr\n        y_tr_x = R * np.cos(arg)\n        y_tr_y = R * np.sin(arg)\n        y_tr_z = z0 + U * tr\n        \n        # Calculate squared distance |x - y(t_r)|^2\n        dist_sq = (x - y_tr_x)**2 + (y - y_tr_y)**2 + (z - y_tr_z)**2\n        \n        # Propagation term\n        prop_term = c**2 * (t - tr)**2\n        \n        return prop_term - dist_sq\n\n    # 1. Construct sign-change bracketing\n    t_start = t - delta_T\n    t_end = t\n    \n    # Create a grid of points to sample the function\n    t_grid = np.linspace(t_start, t_end, N)\n    g_vals = g(t_grid)\n    \n    brackets = []\n    for i in range(N - 1):\n        if np.sign(g_vals[i]) != np.sign(g_vals[i+1]):\n            # A sign change indicates a root in the interval\n            brackets.append((t_grid[i], t_grid[i+1]))\n\n    # 2. Refine each detected bracket to a root\n    roots = []\n    for a, b in brackets:\n        try:\n            root = brentq(g, a, b)\n            roots.append(root)\n        except ValueError:\n            # This can happen if g(a) and g(b) have the same sign due to precision,\n            # but the bracketing check should mostly prevent this.\n            pass\n\n    # 3. De-duplicate numerically coincident roots and sort\n    if not roots:\n        return []\n\n    # Sort the roots\n    roots.sort()\n    \n    # De-duplicate with a small tolerance\n    unique_roots = [roots[0]]\n    for i in range(1, len(roots)):\n        if abs(roots[i] - roots[i-1])  1e-9:\n            unique_roots.append(roots[i])\n            \n    return unique_roots\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}