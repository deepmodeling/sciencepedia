{
    "hands_on_practices": [
        {
            "introduction": "本练习通过分析一个稳态微通道问题，为热耦合流固耦合（FSI）奠定了基础。您将推导并计算一个总传热系数，该系数取决于压力引起的结构变形，从而将流体动力学与热性能直接联系起来。这项实践旨在阐明如何利用热阻网络模型来分析耦合物理场，这是一个在工程中广泛应用的强大分析工具。",
            "id": "3954927",
            "problem": "一个长度为 $L$、未变形间隙高度为 $H_0$ 的二维平行板微通道中，承载着一种稳定的、不可压缩的、层流的、热充分发展的液体，其热导率为 $k_f$。流动由入口和出口之间施加的压降 $\\Delta p$ 驱动。上壁面是一个厚度为 $t_s$、热导率为 $k_s$ 的柔性固体层，通过界面热接触电阻 $R_c$ 与流体粘合，其外表面通过外部对流暴露在温度为 $T_\\infty$ 的环境中，传热系数为 $h_{\\mathrm{ext}}$。下壁面是水力刚性且绝热的。柔性壁面具有线性面刚度 $K_w$（单位为 $\\mathrm{Pa}/\\mathrm{m}$），因此其局部法向挠度与局部表压成正比。假设变形很小且沿展向均匀，因此流动下的有效间隙高度可以用下式建模：\n$$\nH \\;=\\; H_0 \\;+\\; \\alpha\\, p_{\\mathrm{avg}},\n$$\n其中 $\\alpha = 1/K_w$，而 $p_{\\mathrm{avg}}$ 是内部表压的流向平均值。在平行板通道的稳定、充分发展的层流条件下，流向压力线性下降，因此 $p_{\\mathrm{avg}} = \\Delta p/2$。\n\n在流体侧，通过一个有效的内部传热系数来模拟主体平均流体温度和流固界面之间的内部对流交换：\n$$\nh_i(H) \\;=\\; \\frac{\\mathrm{Nu}_i\\, k_f}{H},\n$$\n其中 $\\mathrm{Nu}_i$ 是单壁冷却且对壁绝热情况下的充分发展的努塞尔数。在固体侧，通过界面热接触电阻、穿过固体的一维传导和外部对流的串联组合来模拟向环境的散热。\n\n使用能量守恒定律、Fourier 热传导定律和 Newton 冷却定律，从第一性原理推导总传热系数 $U_{\\mathrm{eff}}$ 的表达式。该系数定义为离开流体的净热通量与主体平均流体温度和环境温度之差之间的比例常数，以流固界面的单位面积计。然后，对以下参数进行 $U_{\\mathrm{eff}}$ 的数值计算：\n- $H_0 = 1.00 \\times 10^{-3}\\ \\mathrm{m}$，\n- $\\Delta p = 2.00 \\times 10^{4}\\ \\mathrm{Pa}$，\n- $K_w = 1.00 \\times 10^{10}\\ \\mathrm{Pa}/\\mathrm{m}$，\n- $k_f = 0.600\\ \\mathrm{W}/\\mathrm{m}\\,\\mathrm{K}$，\n- $\\mathrm{Nu}_i = 7.54$，\n- $R_c = 1.00 \\times 10^{-4}\\ \\mathrm{m}^2\\mathrm{K}/\\mathrm{W}$，\n- $t_s = 5.00 \\times 10^{-4}\\ \\mathrm{m}$，\n- $k_s = 0.200\\ \\mathrm{W}/\\mathrm{m}\\,\\mathrm{K}$，\n- $h_{\\mathrm{ext}} = 20.0\\ \\mathrm{W}/\\mathrm{m}^2\\mathrm{K}$。\n\n将 $U_{\\mathrm{eff}}$ 的最终结果以 $\\mathrm{W}/\\mathrm{m}^2\\mathrm{K}$ 为单位表示，并四舍五入至三位有效数字。",
            "solution": "目标是获得以下形式的总关系式：\n$$\nq'' \\;=\\; U_{\\mathrm{eff}} \\left(T_m - T_\\infty\\right),\n$$\n其中 $q''$ 是穿过流固界面离开流体的单位面积净热通量，$T_m$ 是主体平均流体温度，$T_\\infty$ 是环境温度。我们首先在界面处构建耦合热边界条件，然后将耦合问题简化为 $T_m$ 和 $T_\\infty$ 之间的等效串联热阻。\n\n首先，我们将变形与流体动压力联系起来。对于平行板通道中的稳定、充分发展的层流，流向压力分布 $p(x)$ 是线性的，因此在 $x \\in [0,L]$ 上的空间平均值等于入口和出口压力的算术平均值：\n$$\np_{\\mathrm{avg}} \\;=\\; \\frac{1}{L}\\int_0^L p(x)\\, dx \\;=\\; \\frac{p_{\\mathrm{in}} + p_{\\mathrm{out}}}{2} \\;=\\; \\frac{\\Delta p}{2}.\n$$\n使用线性面刚度模型，有效间隙高度为：\n$$\nH \\;=\\; H_0 + \\alpha\\, p_{\\mathrm{avg}} \\;=\\; H_0 + \\alpha \\frac{\\Delta p}{2}.\n$$\n这里 $\\alpha = 1/K_w$ 是柔度参数。\n\n其次，我们在流固界面处构建共轭热边界。令 $T_i$ 表示流体侧的界面温度。界面处的热通量连续性要求离开流体的热通量等于进入固体的热通量。在流体侧，Fourier 定律给出界面处的法向传导通量，\n$$\nq'' \\;=\\; -k_f \\left.\\frac{\\partial T}{\\partial n}\\right|_{i},\n$$\n且流体主体与界面之间的对流传热由 Newton 冷却定律表示，其内部传热系数为 $h_i(H)$，\n$$\nq'' \\;=\\; h_i(H)\\, \\left(T_m - T_i\\right), \\qquad h_i(H) \\;=\\; \\frac{\\mathrm{Nu}_i\\, k_f}{H}.\n$$\n在固体侧，从界面到环境的热通路包括一系列串联电阻：界面热接触电阻 $R_c$、穿过厚度为 $t_s$ 且热导率为 $k_s$ 的固体的一维传导，以及传热系数为 $h_{\\mathrm{ext}}$ 的外部对流。使用 Fourier 定律和 Newton 冷却定律，这些构成单位面积的总电阻\n$$\nR_{\\mathrm{ext}} \\;=\\; R_c \\;+\\; \\frac{t_s}{k_s} \\;+\\; \\frac{1}{h_{\\mathrm{ext}}}.\n$$\n根据热阻的定义，相同的热通量可以写为：\n$$\nq'' \\;=\\; \\frac{T_i - T_\\infty}{R_{\\mathrm{ext}}}.\n$$\n\n第三，我们消去界面温度 $T_i$，以获得 $q''$ 与 $T_m - T_\\infty$ 之间的直接关系。结合 $q''$ 的两个表达式，\n$$\nh_i(H)\\, \\left(T_m - T_i\\right) \\;=\\; \\frac{T_i - T_\\infty}{R_{\\mathrm{ext}}}.\n$$\n用 $q''$ 求解 $T_m - T_\\infty$，\n$$\nT_m - T_i \\;=\\; \\frac{q''}{h_i(H)}, \\qquad T_i - T_\\infty \\;=\\; q'' R_{\\mathrm{ext}} \\;\\Rightarrow\\; T_m - T_\\infty \\;=\\; q''\\left(\\frac{1}{h_i(H)} + R_{\\mathrm{ext}}\\right).\n$$\n因此，总传热系数是串联电阻之和的倒数：\n$$\nU_{\\mathrm{eff}} \\;=\\; \\frac{1}{\\dfrac{1}{h_i(H)} + R_{\\mathrm{ext}}} \\;=\\; \\frac{1}{\\dfrac{H}{\\mathrm{Nu}_i\\, k_f} + R_c + \\dfrac{t_s}{k_s} + \\dfrac{1}{h_{\\mathrm{ext}}}}.\n$$\n\n第四，我们用给定的参数对 $U_{\\mathrm{eff}}$ 进行数值计算。计算柔度和变形后的间隙高度：\n$$\n\\alpha \\;=\\; \\frac{1}{K_w} \\;=\\; \\frac{1}{1.00 \\times 10^{10}}\\ \\mathrm{m}/\\mathrm{Pa} \\;=\\; 1.00 \\times 10^{-10}\\ \\mathrm{m}/\\mathrm{Pa},\n$$\n$$\np_{\\mathrm{avg}} \\;=\\; \\frac{\\Delta p}{2} \\;=\\; \\frac{2.00 \\times 10^{4}}{2}\\ \\mathrm{Pa} \\;=\\; 1.00 \\times 10^{4}\\ \\mathrm{Pa},\n$$\n$$\nH \\;=\\; H_0 + \\alpha p_{\\mathrm{avg}} \\;=\\; 1.00 \\times 10^{-3} \\;+\\; \\left(1.00 \\times 10^{-10}\\right)\\left(1.00 \\times 10^{4}\\right)\\ \\mathrm{m} \\;=\\; 1.001 \\times 10^{-3}\\ \\mathrm{m}.\n$$\n计算内部传热系数及其热阻：\n$$\nh_i(H) \\;=\\; \\frac{\\mathrm{Nu}_i\\, k_f}{H} \\;=\\; \\frac{7.54 \\times 0.600}{1.001 \\times 10^{-3}}\\ \\mathrm{W}/\\mathrm{m}^2\\mathrm{K} \\;=\\; \\frac{4.524}{1.001 \\times 10^{-3}}\\ \\mathrm{W}/\\mathrm{m}^2\\mathrm{K} \\;\\approx\\; 4519.5\\ \\mathrm{W}/\\mathrm{m}^2\\mathrm{K},\n$$\n$$\n\\frac{1}{h_i(H)} \\;\\approx\\; \\frac{1}{4519.5}\\ \\mathrm{m}^2\\mathrm{K}/\\mathrm{W} \\;\\approx\\; 2.2126 \\times 10^{-4}\\ \\mathrm{m}^2\\mathrm{K}/\\mathrm{W}.\n$$\n计算外部热阻：\n$$\nR_{\\mathrm{ext}} \\;=\\; R_c + \\frac{t_s}{k_s} + \\frac{1}{h_{\\mathrm{ext}}} \\;=\\; \\left(1.00 \\times 10^{-4}\\right) + \\frac{5.00 \\times 10^{-4}}{0.200} + \\frac{1}{20.0}\\ \\mathrm{m}^2\\mathrm{K}/\\mathrm{W}\n$$\n$$\nR_{\\mathrm{ext}} \\;=\\; (1.00 \\times 10^{-4}) + (2.50 \\times 10^{-3}) + (5.00 \\times 10^{-2}) = 0.0526\\ \\mathrm{m}^2\\mathrm{K}/\\mathrm{W}.\n$$\n总热阻和总系数：\n$$\nR_{\\mathrm{tot}} \\;=\\; \\frac{1}{h_i(H)} + R_{\\mathrm{ext}} \\;\\approx\\; (2.2126 \\times 10^{-4}) + 0.0526 \\;=\\; 0.05282126\\ \\mathrm{m}^2\\mathrm{K}/\\mathrm{W},\n$$\n$$\nU_{\\mathrm{eff}} \\;=\\; \\frac{1}{R_{\\mathrm{tot}}} \\;\\approx\\; \\frac{1}{0.05282126}\\ \\mathrm{W}/\\mathrm{m}^2\\mathrm{K} \\;\\approx\\; 18.9\\ \\mathrm{W}/\\mathrm{m}^2\\mathrm{K}.\n$$\n按要求四舍五入至三位有效数字，总传热系数为 $18.9\\ \\mathrm{W}/\\mathrm{m}^2\\mathrm{K}$。",
            "answer": "$$\\boxed{18.9}$$"
        },
        {
            "introduction": "在稳态分析的基础上，本练习将重点转向瞬态现象及其数值模拟方法。通过分析一个分隔两种流体的薄壁的热响应，您将推导出一种显式时间积分方案的稳定性条件。这项实践对于理解分区式FSI模拟中的计算约束至关重要，例如为防止数值不稳定而必须遵守的最大允许时间步长。",
            "id": "3954930",
            "problem": "一面厚度为 $l$ 的薄的高导热性固体壁隔开两种不可压缩流：温度为 $T_{1,\\infty}$ 的热流和温度为 $T_{2,\\infty}$ 的冷流。壁面材料的密度为 $\\rho_{s}$，比热容为 $c_{p,s}$。由于壁面的高导热性，假设壁面温度在空间上是均匀的，并且在任何时刻都等于 $T_{w}(t)$。两侧的界面热交换遵循牛顿冷却定律：在热流侧，流入壁面的热通量为 $q_{1}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right)$；在冷流侧，流出壁面的热通量为 $q_{2}(t) = h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)$，其中 $h_{1}$ 和 $h_{2}$ 是恒定的对流传热系数。所有量均按单位壁面面积计算。\n\n从基本原理出发，写出壁面的能量平衡方程，并用它推导 $T_{w}(t)$ 的控制常微分方程。考虑一个分区流固耦合（FSI）问题，其中壁面温度使用时间步长为 $\\Delta t$ 的前向欧拉法对该常微分方程进行显式时间推进，而流体侧的热通量 $q_{1}(t)$ 和 $q_{2}(t)$ 则在每一步使用当前的壁面温度进行计算。推导该显式时间积分格式绝对稳定的充要条件，用 $h_{1}$、$h_{2}$、$\\rho_{s}$、$c_{p,s}$ 和 $l$ 表示。\n\n最后，对于一个厚度为 $l = 2.0 \\times 10^{-3}\\,\\text{m}$ 的壁面，其材料密度 $\\rho_{s} = 2.7 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3}$，比热容 $c_{p,s} = 9.0 \\times 10^{2}\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，该壁面隔开一股 $h_{1} = 4.0 \\times 10^{3}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ 的液流和一股 $h_{2} = 2.0 \\times 10^{2}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ 的气流，计算为保证绝对稳定性所允许的最大时间步长 $\\Delta t_{\\max}$。将最终的时间步长以秒为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "首先验证问题，确保其科学上合理、良定且完整。所给问题描述了一个标准的瞬态传热场景，使用集总电容法，该方法适用于薄的高导热性壁面。其物理基础是热力学第一定律（能量守恒）和牛顿冷却定律。数值分析部分，涉及前向欧拉法的稳定性，是计算工程中的一个典型课题。所有必需的参数都已提供，且数值对于所描述的材料和条件是物理上现实的。因此，该问题被认为是有效的。\n\n解答过程分为三部分：第一，推导壁面温度 $T_w(t)$ 的控制常微分方程（ODE）；第二，推导显式前向欧拉时间积分格式的稳定性条件；第三，使用提供的数值数据计算最大稳定时间步长 $\\Delta t_{\\max}$。\n\n**第一部分：控制常微分方程的推导**\n\n我们从应用于固体壁的能量守恒基本原理出发。壁内储存的内能变化率必须等于进入壁内的净传热率。由于问题指定按单位面积处理，我们对一个对应于厚度为 $l$ 的单位面积壁面的控制体建立能量平衡。\n\n单位面积壁面的内能 $E_{w}$ 由 $E_{w} = m' c_{p,s} T_{w}(t)$ 给出，其中 $m'$ 是单位面积质量。单位面积质量是材料密度 $\\rho_s$ 和壁厚 $l$ 的乘积，因此 $m' = \\rho_{s} l$。于是单位面积内能为 $E_{w} = \\rho_{s} l c_{p,s} T_{w}(t)$。\n\n该单位面积内能的变化率为：\n$$\n\\frac{dE_{w}}{dt} = \\frac{d}{dt} \\left( \\rho_{s} l c_{p,s} T_{w}(t) \\right) = \\rho_{s} l c_{p,s} \\frac{dT_{w}}{dt}\n$$\n这是成立的，因为 $\\rho_{s}$、$l$ 和 $c_{p,s}$ 是常数。\n\n进入壁面的净热通量 $q_{net}$ 是从热侧流入的热通量 $q_1(t)$ 减去流向冷侧的热通量 $q_2(t)$。\n$$\nq_{net}(t) = q_{1}(t) - q_{2}(t)\n$$\n使用基于牛顿冷却定律给出的表达式：\n$$\nq_{1}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right)\n$$\n$$\nq_{2}(t) = h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)\n$$\n因此，净热通量为：\n$$\nq_{net}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right) - h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)\n$$\n展开并合并含 $T_w(t)$ 的项：\n$$\nq_{net}(t) = h_{1}T_{1,\\infty} - h_{1}T_{w}(t) - h_{2}T_{w}(t) + h_{2}T_{2,\\infty}\n$$\n$$\nq_{net}(t) = -\\left(h_{1} + h_{2}\\right)T_{w}(t) + \\left(h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}\\right)\n$$\n将能量变化率与净热通量相等，即 $\\frac{dE_{w}}{dt} = q_{net}(t)$，我们得到控制常微分方程：\n$$\n\\rho_{s} l c_{p,s} \\frac{dT_{w}}{dt} = -\\left(h_{1} + h_{2}\\right)T_{w}(t) + \\left(h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}\\right)\n$$\n这就是所求的壁面温度 $T_w(t)$ 的常微分方程。\n\n**第二部分：前向欧拉格式的稳定性条件**\n\n推导出的常微分方程可以写成标准形式 $\\frac{dy}{dt} = \\lambda y + b$。整理我们的常微分方程：\n$$\n\\frac{dT_{w}}{dt} = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}} T_{w}(t) + \\frac{h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}}{\\rho_{s} l c_{p,s}}\n$$\n这是一个线性一阶常微分方程。为了进行稳定性分析，我们只需要考虑方程的齐次部分，它控制扰动的演化。该方程的形式为 $\\frac{dT_w}{dt} = \\lambda T_w + f(t)$，其中常数 $\\lambda$ 由下式给出：\n$$\n\\lambda = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}}\n$$\n前向欧拉法是一种显式时间积分格式。对于常微分方程 $\\frac{dy}{dt} = g(t, y)$，其更新法则是 $y^{n+1} = y^{n} + \\Delta t \\, g(t^{n}, y^{n})$。将此应用于我们关于 $T_w$ 的常微分方程：\n$$\nT_{w}^{n+1} = T_{w}^{n} + \\Delta t \\left( \\lambda T_{w}^{n} + \\frac{h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}}{\\rho_{s} l c_{p,s}} \\right)\n$$\n这种数值格式的稳定性取决于它如何传播误差。在时间步 $n$ 的误差 $\\epsilon^n$ 根据离散方程的齐次部分演化到时间步 $n+1$ 的误差 $\\epsilon^{n+1}$：\n$$\n\\epsilon^{n+1} = \\epsilon^{n} + \\Delta t (\\lambda \\epsilon^{n}) = (1 + \\lambda \\Delta t)\\epsilon^{n}\n$$\n项 $G = 1 + \\lambda \\Delta t$ 是放大因子。为使格式绝对稳定，任何初始误差的量值都不能随时间增长。这要求放大因子的模小于或等于1：\n$$\n|G| \\leq 1 \\implies |1 + \\lambda \\Delta t| \\leq 1\n$$\n这个不等式可以展开为：\n$$\n-1 \\leq 1 + \\lambda \\Delta t \\leq 1\n$$\n这产生了两个条件：\n1. $1 + \\lambda \\Delta t \\leq 1 \\implies \\lambda \\Delta t \\leq 0$\n2. $-1 \\leq 1 + \\lambda \\Delta t \\implies -2 \\leq \\lambda \\Delta t \\implies \\Delta t \\leq -\\frac{2}{\\lambda}$\n\n由于所有物理参数（$h_1, h_2, \\rho_s, l, c_{p,s}$）都是正的，项 $\\lambda = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}}$ 严格为负。同时，时间步长 $\\Delta t$ 必须为正。因此，乘积 $\\lambda \\Delta t$ 总是负的，第一个条件 $\\lambda \\Delta t \\leq 0$ 总是满足。\n\n因此，稳定性仅受第二个条件约束：\n$$\n\\Delta t \\leq -\\frac{2}{\\lambda}\n$$\n代入 $\\lambda$ 的表达式：\n$$\n\\Delta t \\leq -2 \\left( -\\frac{\\rho_{s} l c_{p,s}}{h_{1} + h_{2}} \\right)\n$$\n$$\n\\Delta t \\leq \\frac{2 \\rho_{s} l c_{p,s}}{h_{1} + h_{2}}\n$$\n这就是该问题中前向欧拉格式绝对稳定的充要条件。\n\n**第三部分：最大时间步长 $\\Delta t_{\\max}$ 的计算**\n\n允许的最大时间步长 $\\Delta t_{\\max}$ 是此稳定性条件的上界：\n$$\n\\Delta t_{\\max} = \\frac{2 \\rho_{s} l c_{p,s}}{h_{1} + h_{2}}\n$$\n我们已知以下数值：\n- $l = 2.0 \\times 10^{-3}\\,\\text{m}$\n- $\\rho_{s} = 2.7 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3}$\n- $c_{p,s} = 9.0 \\times 10^{2}\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$\n- $h_{1} = 4.0 \\times 10^{3}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n- $h_{2} = 2.0 \\times 10^{2}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n\n首先，我们计算单位面积壁面的热容，即分子项 $\\rho_{s} l c_{p,s}$：\n$$\n\\rho_{s} l c_{p,s} = (2.7 \\times 10^{3}) \\times (2.0 \\times 10^{-3}) \\times (9.0 \\times 10^{2}) = 4860\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\n接下来，我们计算对流传热系数之和：\n$$\nh_{1} + h_{2} = (4.0 \\times 10^{3}) + (2.0 \\times 10^{2}) = 4000 + 200 = 4200\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\n现在，将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\Delta t_{\\max} = \\frac{2 \\times 4860}{4200} = \\frac{9720}{4200}\\,\\text{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{972}{420} = \\frac{81}{35}\\,\\text{s} \\approx 2.3142857... \\,\\text{s}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\n\\Delta t_{\\max} \\approx 2.314 \\, \\text{s}\n$$",
            "answer": "$$\\boxed{2.314}$$"
        },
        {
            "introduction": "最后的这项实践通过模态分析深入探讨了热耦合FSI系统的动态行为。您将实现一个计算模型，以确定系统的固有振动频率和振型如何受到温度变化的影响。这个高级练习突出了理解热-力耦合效应对系统动力学影响的重要性，这对于在变化热环境下运行的结构的设计与分析至关重要。",
            "id": "3954904",
            "problem": "考虑一个热耦合系统中流固耦合（FSI）的最小二自由度表示：一个面积为 $A$、厚度为 $h$ 的刚性平板结构，封闭一个体积为 $V = A H$ 的刚性流体腔，其中 $H$ 是腔体高度。结构板发生由广义坐标 $u$ 描述的微小横向位移，而腔内的流体边界发生由广义坐标 $\\eta$ 描述的集总均匀位移。假设系统是无阻尼的，进行微小振荡，并经历准静态热变化，因此材料属性取决于温度 $T$，但惯性和运动学遵循相同的力学定律。目标是计算耦合特征频率和相关的模态振型作为温度的函数。\n\n使用以下基于第一性原理的建模假设：\n- 每个广义坐标的牛顿第二定律：对于 $u$ 和 $\\eta$，合力等于质量乘以加速度。\n- 能量法：总动能 $T$ 和总势能 $U$ 通过对能量关于广义坐标求二阶导数来定义广义刚度矩阵和质量矩阵。\n- 流体可压缩性通过流体体积模量将压力变化与体积应变联系起来。\n- 随温度变化的材料属性通过在感兴趣的范围内经过充分检验的线性温变近似来建模。\n\n将动能定义为\n$$\nT = \\tfrac{1}{2} m_s(T) \\dot{u}^2 + \\tfrac{1}{2} m_f(T) \\dot{\\eta}^2,\n$$\n其中 $m_s(T)$ 是结构质量，$m_f(T)$ 是腔内的集总流体惯量。将势能定义为\n$$\nU = \\tfrac{1}{2} k_s(T) u^2 + \\tfrac{1}{2} k_f(T) \\left(u - \\eta\\right)^2,\n$$\n其中 $k_s(T)$ 是有效结构刚度，$k_f(T)$ 是与可压缩性和几何形状相关的有效流体腔刚度。根据这些能量，构造对称的温变质量和刚度矩阵\n$$\n\\mathbf{M}(T) = \\begin{bmatrix}\nm_s(T)  & 0 \\\\\n0  & m_f(T)\n\\end{bmatrix}, \\quad\n\\mathbf{K}(T) = \\begin{bmatrix}\nk_s(T) + k_f(T)  & -k_f(T) \\\\\n-k_f(T)  & k_f(T)\n\\end{bmatrix}.\n$$\n耦合无阻尼自由振动问题即为广义特征值问题\n$$\n\\left[\\mathbf{K}(T) - \\omega^2 \\mathbf{M}(T)\\right] \\mathbf{v} = \\mathbf{0},\n$$\n其中 $\\omega$ 是角固有频率，$\\mathbf{v}$ 是相关的模态振型向量。通过 $f = \\omega / (2\\pi)$ 以赫兹（Hz）表示固有频率。\n\n使用以下关系式计算材料属性的温度依赖性，所有温度 $T$ 以开尔文（$\\mathrm{K}$）为单位，参数采用国际单位制（SI）：\n- 结构质量：$m_s(T) = \\rho_s A h$，其中恒定固体密度 $\\rho_s = 7800 \\,\\mathrm{kg/m^3}$。\n- 流体质量：$m_f(T) = \\rho_f(T) A H$，其中流体密度为\n$$\n\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} \\, (T - T_0)\\right], \\quad \\rho_{f0} = 998 \\,\\mathrm{kg/m^3}, \\quad \\alpha_{\\rho} = 3 \\times 10^{-4} \\,\\mathrm{K^{-1}}, \\quad T_0 = 293.15 \\,\\mathrm{K}.\n$$\n- 结构刚度：$k_s(T) = E(T) \\, \\dfrac{h A}{L_{\\text{eff}}}$，其中\n$$\nE(T) = E_0 \\left[1 - \\alpha_E \\, (T - T_0)\\right], \\quad E_0 = 2.0 \\times 10^{11} \\,\\mathrm{Pa}, \\quad \\alpha_E = 2 \\times 10^{-4} \\,\\mathrm{K^{-1}}, \\quad L_{\\text{eff}} = 0.5 \\,\\mathrm{m}.\n$$\n- 来自可压缩性的流体腔刚度：$k_f(T) = \\dfrac{K_{\\text{bulk}}(T) \\, A^2}{V} = K_{\\text{bulk}}(T) \\, \\dfrac{A}{H}$，其中\n$$\nK_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K \\, (T - T_0)\\right], \\quad K_0 = 2.2 \\times 10^{9} \\,\\mathrm{Pa}, \\quad \\alpha_K = 5 \\times 10^{-4} \\,\\mathrm{K^{-1}}.\n$$\n\n使用固定的几何参数\n$$\nA = 0.25 \\,\\mathrm{m^2}, \\quad h = 0.01 \\,\\mathrm{m}, \\quad H = 0.2 \\,\\mathrm{m}, \\quad V = A H.\n$$\n\n对于下面测试套件中的每个温度 $T$，构造 $\\mathbf{M}(T)$ 和 $\\mathbf{K}(T)$，求解具有最小特征值 $\\omega^2$ 的两个特征对的广义特征值问题，然后：\n- 报告两个固有频率 $f_1$ 和 $f_2$，单位为赫兹，每个都四舍五入到六位小数。\n- 报告相关的模态振型为质量归一化的特征向量（对每个模态进行归一化，使得 $\\mathbf{v}^\\top \\mathbf{M}(T) \\mathbf{v} = 1$），并选择符号使得结构位移分量 $v_u$ 为正。按顺序 $[v_{1,u}, v_{1,\\eta}, v_{2,u}, v_{2,\\eta}]$ 输出四个分量，每个都四舍五入到六位小数。\n\n测试套件温度（单位：开尔文），涵盖基准、升高、降低和高温情况：\n- $T = 293.15$\n- $T = 333.15$\n- $T = 283.15$\n- $T = 373.15$\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，形式为包含在方括号内的逗号分隔列表。对于每个温度，输出一个形式为 $[[f_1, f_2], [v_{1,u}, v_{1,\\eta}, v_{2,u}, v_{2,\\eta}]]$ 的嵌套列表。因此，最终输出格式必须为\n$$\n\\left[ \\, [[f_1^{(1)}, f_2^{(1)}], [v_{1,u}^{(1)}, v_{1,\\eta}^{(1)}, v_{2,u}^{(1)}, v_{2,\\eta}^{(1)}]], \\, [[f_1^{(2)}, f_2^{(2)}], [v_{1,u}^{(2)}, v_{1,\\eta}^{(2)}, v_{2,u}^{(2)}, v_{2,\\eta}^{(2)}]], \\, [[f_1^{(3)}, f_2^{(3)}], [v_{1,u}^{(3)}, v_{1,\\eta}^{(3)}, v_{2,u}^{(3)}, v_{2,\\eta}^{(3)}]], \\, [[f_1^{(4)}, f_2^{(4)}], [v_{1,u}^{(4)}, v_{1,\\eta}^{(4)}, v_{2,u}^{(4)}, v_{2,\\eta}^{(4)}]] \\, \\right],\n$$\n其中上标 $\\left( i \\right)$ 按上面列出的顺序表示温度案例的索引。所有数值必须是四舍五入到六位小数的浮点数，频率必须以赫兹（Hz）为单位。",
            "solution": "用户提供了一个计算热工领域的问题，具体涉及热耦合系统中的流固耦合。任务是计算一个简化的二自由度模型的温变特征频率和模态振型。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n- **系统模型**：一个具有广义坐标 $u$（结构位移）和 $\\eta$（流体位移）的二自由度（2-DOF）无阻尼系统。\n- **动能**：$T = \\tfrac{1}{2} m_s(T) \\dot{u}^2 + \\tfrac{1}{2} m_f(T) \\dot{\\eta}^2$。\n- **势能**：$U = \\tfrac{1}{2} k_s(T) u^2 + \\tfrac{1}{2} k_f(T) \\left(u - \\eta\\right)^2$。\n- **质量矩阵**：$\\mathbf{M}(T) = \\begin{bmatrix} m_s(T)  & 0 \\\\ 0  & m_f(T) \\end{bmatrix}$。\n- **刚度矩阵**：$\\mathbf{K}(T) = \\begin{bmatrix} k_s(T) + k_f(T)  & -k_f(T) \\\\ -k_f(T)  & k_f(T) \\end{bmatrix}$。\n- **控制方程**：广义特征值问题 $\\left[\\mathbf{K}(T) - \\omega^2 \\mathbf{M}(T)\\right] \\mathbf{v} = \\mathbf{0}$。\n- **频率转换**：$f = \\omega / (2\\pi)$。\n- **几何参数**：面积 $A = 0.25 \\,\\mathrm{m^2}$，结构厚度 $h = 0.01 \\,\\mathrm{m}$，腔体高度 $H = 0.2 \\,\\mathrm{m}$。\n- **材料参数（国际单位制）**：\n    - 恒定固体密度：$\\rho_s = 7800 \\,\\mathrm{kg/m^3}$。\n    - 参考流体密度：$\\rho_{f0} = 998 \\,\\mathrm{kg/m^3}$。\n    - 流体密度热系数：$\\alpha_{\\rho} = 3 \\times 10^{-4} \\,\\mathrm{K^{-1}}$。\n    - 参考杨氏模量：$E_0 = 2.0 \\times 10^{11} \\,\\mathrm{Pa}$。\n    - 杨氏模量热系数：$\\alpha_E = 2 \\times 10^{-4} \\,\\mathrm{K^{-1}}$。\n    - 有效结构长度：$L_{\\text{eff}} = 0.5 \\,\\mathrm{m}$。\n    - 参考流体体积模量：$K_0 = 2.2 \\times 10^{9} \\,\\mathrm{Pa}$。\n    - 体积模量热系数：$\\alpha_K = 5 \\times 10^{-4} \\,\\mathrm{K^{-1}}$。\n    - 参考温度：$T_0 = 293.15 \\,\\mathrm{K}$。\n- **温变属性**：\n    - 结构质量：$m_s(T) = \\rho_s A h$。\n    - 流体密度：$\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} \\, (T - T_0)\\right]$。\n    - 流体质量：$m_f(T) = \\rho_f(T) A H$。\n    - 杨氏模量：$E(T) = E_0 \\left[1 - \\alpha_E \\, (T - T_0)\\right]$。\n    - 结构刚度：$k_s(T) = E(T) \\, \\dfrac{h A}{L_{\\text{eff}}}$。\n    - 体积模量：$K_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K \\, (T - T_0)\\right]$。\n    - 流体刚度：$k_f(T) = K_{\\text{bulk}}(T) \\, \\dfrac{A}{H}$。\n- **测试套件**：温度 $T \\in \\{293.15, 333.15, 283.15, 373.15\\} \\,\\mathrm{K}$。\n- **输出要求**：\n    - 两个固有频率 $f_1, f_2$，单位为赫兹，按升序排列并四舍五入到6位小数。\n    - 两个相应的质量归一化特征向量 $\\mathbf{v}_1, \\mathbf{v}_2$，其中归一化意味着 $\\mathbf{v}^\\top \\mathbf{M}(T) \\mathbf{v} = 1$。\n    - 特征向量符号约定：第一个分量（结构位移）必须为正。\n    - 输出格式：一个列表的列表，`[[[f1, f2], [v1_u, v1_eta, v2_u, v2_eta]], ...]`，针对每个温度，所有值都四舍五入到6位小数。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于经典力学（二自由度系统的拉格朗日表述）和连续介质力学（线性弹性、流体可压缩性）的基本原理进行阐述。该模型是研究耦合动力学的标准且有效的简化。温度依赖性被建模为线性函数，这对于给定范围是常见且可接受的近似。物理常数对于像钢和水这样的常见工程材料是现实的。该表述在科学上是合理的。\n- **适定性**：该问题需要求解形式为 $\\mathbf{K}\\mathbf{v} = \\lambda \\mathbf{M}\\mathbf{v}$ 的广义特征值问题，其中 $\\lambda = \\omega^2$。质量矩阵 $\\mathbf{M}(T)$ 是对角矩阵，其元素为正（质量 $m_s, m_f$ 内在为正）。刚度矩阵 $\\mathbf{K}(T)$ 是对称的。对于给定的温度，刚度常数 $k_s(T)$ 和 $k_f(T)$ 将为正，这使得 $\\mathbf{K}(T)$ 是正定的。一个具有正定刚度矩阵和正定质量矩阵的系统保证有实数正特征值 $\\lambda$，从而得到实数正固有频率 $\\omega$。因此，对于每个温度都存在唯一且有意义的解。\n- **客观性**：该问题使用精确的数学定义和客观的数值数据进行陈述。没有歧义、主观性或基于意见的语言。\n\n**步骤3：结论和行动**\n\n该问题具有科学依据、适定性、客观性并且是自洽的。这是一个有效的问题。我将继续进行求解。\n\n### 求解\n\n此问题的解决方案涉及对每个指定温度 $T$ 的系统性程序。任务的核心是组装温变质量矩阵 $\\mathbf{M}(T)$ 和刚度矩阵 $\\mathbf{K}(T)$，然后求解得到的广义特征值问题。\n\n**1. 温变属性的计算**\n首先，对于给定的温度 $T$，我们必须计算随温度变化的物理属性的值。参考温度为 $T_0 = 293.15 \\,\\mathrm{K}$。与此参考的偏差为 $\\Delta T = T - T_0$。\n\n- 流体密度 $\\rho_f(T)$ 由下式给出：\n$$\n\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} (T - T_0)\\right]\n$$\n- 结构材料的杨氏模量 $E(T)$ 由下式给出：\n$$\nE(T) = E_0 \\left[1 - \\alpha_E (T - T_0)\\right]\n$$\n- 流体的体积模量 $K_{\\text{bulk}}(T)$ 由下式给出：\n$$\nK_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K (T - T_0)\\right]\n$$\n\n**2. 质量和刚度矩阵元素的计算**\n利用温变属性和固定的几何参数，我们计算构成质量和刚度矩阵的四个元素。\n\n- 在此模型中，结构质量 $m_s$ 不随温度变化：\n$$\nm_s = \\rho_s A h\n$$\n- 集总流体质量 $m_f(T)$ 取决于流体密度：\n$$\nm_f(T) = \\rho_f(T) A H\n$$\n- 结构刚度 $k_s(T)$ 取决于杨氏模量：\n$$\nk_s(T) = E(T) \\, \\frac{A h}{L_{\\text{eff}}}\n$$\n- 流体腔刚度 $k_f(T)$ 取决于体积模量：\n$$\nk_f(T) = K_{\\text{bulk}}(T) \\, \\frac{A}{H}\n$$\n\n**3. 系统矩阵的组装**\n计算出四个关键参数后，我们组装 $2 \\times 2$ 的质量和刚度矩阵。\n\n- 质量矩阵：\n$$\n\\mathbf{M}(T) = \\begin{bmatrix}\nm_s  & 0 \\\\\n0  & m_f(T)\n\\end{bmatrix}\n$$\n- 刚度矩阵：\n$$\n\\mathbf{K}(T) = \\begin{bmatrix}\nk_s(T) + k_f(T)  & -k_f(T) \\\\\n-k_f(T)  & k_f(T)\n\\end{bmatrix}\n$$\n\n**4. 求解广义特征值问题**\n核心步骤是求解系统无阻尼自由振动的广义特征值问题：\n$$\n\\mathbf{K}(T) \\mathbf{v} = \\omega^2 \\mathbf{M}(T) \\mathbf{v}\n$$\n这需要数值求解。标准的数值库为此类任务提供了高效稳定的特征值求解器。求解得到两个特征值 $\\lambda_1 = \\omega_1^2$ 和 $\\lambda_2 = \\omega_2^2$，它们是角固有频率的平方。相应的特征向量 $\\mathbf{v}_1 = [v_{1,u}, v_{1,\\eta}]^\\top$ 和 $\\mathbf{v}_2 = [v_{2,u}, v_{2,\\eta}]^\\top$ 代表系统的模态振型。特征值按升序排序，即 $\\omega_1^2 \\le \\omega_2^2$。\n\n**5. 结果的后处理**\n必须对特征值求解器的原始结果进行处理，以满足输出规范。\n\n- **频率**：角频率 $\\omega_i$ 通过以下关系转换为以赫兹（Hz）为单位的固有频率 $f_i$：\n$$\nf_i = \\frac{\\omega_i}{2\\pi} = \\frac{\\sqrt{\\lambda_i}}{2\\pi}\n$$\n- **特征向量归一化**：问题要求质量归一化的特征向量，使得对于每个模态 $i$，满足以下条件：\n$$\n\\mathbf{v}_i^\\top \\mathbf{M}(T) \\mathbf{v}_i = 1\n$$\n许多数值求解器，包括 `scipy.linalg.eigh`，可以直接返回相对于质量矩阵 $\\mathbf{M}$ 归一化的特征向量。\n- **符号约定**：为确保每个模态振型的表示唯一，调整特征向量的符号，使其第一个分量（代表结构位移 $u$）为正。如果计算出的 $v_{i,u}$ 为负，则将整个向量 $\\mathbf{v}_i$ 乘以 $-1$。\n\n对测试套件中的每个温度重复此过程。然后收集最终结果并格式化为指定的嵌套列表结构，所有数值均四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the eigenfrequencies and mode shapes for a 2-DOF thermally coupled\n    fluid-structure interaction system at various temperatures.\n    \"\"\"\n    # Define fixed geometric and material parameters in SI units\n    A = 0.25         # Plate area (m^2)\n    h = 0.01         # Plate thickness (m)\n    H = 0.2          # Cavity height (m)\n    rho_s = 7800.0   # Solid density (kg/m^3)\n    L_eff = 0.5      # Effective structural length (m)\n    T_0 = 293.15     # Reference temperature (K)\n\n    # Reference material properties and thermal coefficients\n    rho_f0 = 998.0         # Reference fluid density (kg/m^3) at T_0\n    alpha_rho = 3.0e-4     # Thermal coefficient for fluid density (K^-1)\n    \n    E_0 = 2.0e11           # Reference Young's modulus (Pa) at T_0\n    alpha_E = 2.0e-4       # Thermal coefficient for Young's modulus (K^-1)\n    \n    K_0 = 2.2e9            # Reference fluid bulk modulus (Pa) at T_0\n    alpha_K = 5.0e-4       # Thermal coefficient for bulk modulus (K^-1)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        293.15,  # Baseline\n        333.15,  # Elevated\n        283.15,  # Reduced\n        373.15,  # High temperature\n    ]\n\n    results = []\n    # Structural mass is constant with temperature\n    m_s = rho_s * A * h\n\n    for T in test_cases:\n        # Calculate temperature-dependent properties\n        delta_T = T - T_0\n        \n        rho_f_T = rho_f0 * (1.0 - alpha_rho * delta_T)\n        E_T = E_0 * (1.0 - alpha_E * delta_T)\n        K_bulk_T = K_0 * (1.0 - alpha_K * delta_T)\n        \n        # Calculate elements of mass and stiffness matrices\n        m_f = rho_f_T * A * H\n        k_s = E_T * h * A / L_eff\n        k_f = K_bulk_T * A / H\n        \n        # Assemble mass and stiffness matrices\n        M = np.array([[m_s, 0.0], \n                      [0.0, m_f]])\n        \n        K = np.array([[k_s + k_f, -k_f], \n                      [-k_f, k_f]])\n        \n        # Solve the generalized eigenvalue problem: K*v = lambda*M*v\n        # linalg.eigh returns eigenvalues (lambda = omega^2) sorted in ascending order\n        # and corresponding eigenvectors that are M-normalized (v.T @ M @ v = 1).\n        eigenvalues, eigenvectors = linalg.eigh(K, M)\n        \n        # Convert eigenvalues (omega^2) to frequencies in Hz\n        angular_frequencies = np.sqrt(eigenvalues)\n        frequencies_hz = angular_frequencies / (2.0 * np.pi)\n        \n        f1, f2 = frequencies_hz[0], frequencies_hz[1]\n        \n        # Extract eigenvectors\n        v1 = eigenvectors[:, 0]\n        v2 = eigenvectors[:, 1]\n        \n        # Enforce sign convention: structural component (u, first element) must be positive\n        if v1[0]  0:\n            v1 = -v1\n        if v2[0]  0:\n            v2 = -v2\n            \n        # Format results to six decimal places\n        freq_list = [round(f1, 6), round(f2, 6)]\n        vec_list = [round(v1[0], 6), round(v1[1], 6), round(v2[0], 6), round(v2[1], 6)]\n        \n        # Append the formatted result for this test case\n        case_result = [freq_list, vec_list]\n        results.append(case_result)\n\n    # Convert the list of results to the required string format\n    # The str() representation of a list of lists matches the required format.\n    # We remove spaces for a compact output.\n    output_str_parts = [str(res).replace(\" \", \"\") for res in results]\n    final_output_str = f\"[{','.join(output_str_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}