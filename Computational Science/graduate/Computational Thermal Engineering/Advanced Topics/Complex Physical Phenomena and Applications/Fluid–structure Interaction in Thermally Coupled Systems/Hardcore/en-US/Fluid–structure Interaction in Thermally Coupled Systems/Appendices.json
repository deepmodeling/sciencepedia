{
    "hands_on_practices": [
        {
            "introduction": "This first practice introduces a foundational concept in thermally coupled FSI: a steady-state system where the solution is governed by a nonlinear feedback loop. You will explore how thermal expansion of a solid structure can alter the geometry of an adjacent fluid layer, which in turn changes the thermal resistance and the overall heat flux. By deriving and solving the governing nonlinear equation, you gain hands-on experience with a class of problems where the thermal and mechanical fields are inextricably linked even in the simplest scenarios . This exercise highlights the necessity of numerical methods to solve for the system's equilibrium state.",
            "id": "3954922",
            "problem": "Consider a one-dimensional, steady-state, thermally coupled Fluid–Structure Interaction (FSI) benchmark that captures the effect of thermal expansion of a solid plate on the heat transfer through an adjacent stagnant fluid layer. A flat solid plate of thickness $L_s$ and thermal conductivity $k_s$ separates a uniform hot source at temperature $T_{hot}$ from a stagnant fluid layer of initial thickness $L_{f0}$ and thermal conductivity $k_f$ that is exposed to an ambient temperature $T_{\\infty}$. The structural plate undergoes linear thermal expansion, and a fraction of this expansion protrudes into the fluid gap, reducing its effective thickness. Specifically, the interface temperature is $T_i$, and the structure's interface displacement into the fluid is modeled as $w = \\zeta \\alpha_s L_s (T_i - T_{ref})$, where $\\alpha_s$ is the solid’s coefficient of linear thermal expansion, $\\zeta \\in [0,1]$ is a dimensionless geometric factor representing the fraction of thickness expansion that moves the interface into the fluid, and $T_{ref}$ is a reference temperature. The effective fluid gap thickness is $L_f^{eff} = L_{f0} - w$, which must remain positive for physical feasibility. Heat transfer through the plate is by conduction, and heat transfer through the stagnant fluid layer is also assumed to be purely by conduction. The system reaches steady state when the conductive heat flux through the solid equals the conductive heat flux through the fluid.\n\nStarting from Fourier’s law of heat conduction and energy conservation at the interface, derive the nonlinear scalar equation for the interface temperature $T_i$ that enforces flux continuity between the solid and the fluid, and then solve it numerically. Use the following fundamental bases:\n- Fourier’s law of heat conduction: the heat flux through a homogeneous slab of thickness $L$ with thermal conductivity $k$ and temperatures $T_{1}$ and $T_{2}$ on its faces is $q'' = k \\dfrac{T_{1} - T_{2}}{L}$.\n- Energy conservation at the interface: the steady-state heat flux through the solid equals the steady-state heat flux through the fluid, so $q''_{solid} = q''_{fluid}$.\n- Linear thermal expansion for effective gap change: $w = \\zeta \\alpha_s L_s (T_i - T_{ref})$.\n\nYour task is to write a complete program that, for a set of test cases, solves for $T_i$ by finding a root of the flux balance equation, computes the corresponding steady-state heat flux $q''$, and computes the interface displacement $w$. Ensure that the effective gap thickness satisfies $L_f^{eff} = L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref}) > 0$ over the numerical bracket used in the root search. If the upper bound $T_{hot}$ would violate $L_f^{eff} > 0$, restrict the upper bound to $T_{upper} = T_{ref} + \\dfrac{L_{f0}}{\\zeta \\alpha_s L_s}$ (for $\\zeta \\alpha_s L_s > 0$) minus a small positive margin. Use a robust bracketing method.\n\nUse the following test suite with parameters expressed in International System of Units:\n- Case $1$ (moderate properties, nonzero coupling): $T_{hot} = 400\\,\\mathrm{K}$, $T_{\\infty} = 300\\,\\mathrm{K}$, $L_s = 0.01\\,\\mathrm{m}$, $L_{f0} = 0.005\\,\\mathrm{m}$, $k_s = 15\\,\\mathrm{W/(m\\cdot K)}$, $k_f = 0.6\\,\\mathrm{W/(m\\cdot K)}$, $\\alpha_s = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $\\zeta = 0.5$, $T_{ref} = 300\\,\\mathrm{K}$.\n- Case $2$ (decoupled boundary, stiff structure): $T_{hot} = 400\\,\\mathrm{K}$, $T_{\\infty} = 300\\,\\mathrm{K}$, $L_s = 0.01\\,\\mathrm{m}$, $L_{f0} = 0.005\\,\\mathrm{m}$, $k_s = 15\\,\\mathrm{W/(m\\cdot K)}$, $k_f = 0.6\\,\\mathrm{W/(m\\cdot K)}$, $\\alpha_s = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $\\zeta = 0$, $T_{ref} = 300\\,\\mathrm{K}$.\n- Case $3$ (high expansion fraction, thin fluid layer, low fluid conductivity): $T_{hot} = 500\\,\\mathrm{K}$, $T_{\\infty} = 300\\,\\mathrm{K}$, $L_s = 0.02\\,\\mathrm{m}$, $L_{f0} = 0.001\\,\\mathrm{m}$, $k_s = 30\\,\\mathrm{W/(m\\cdot K)}$, $k_f = 0.03\\,\\mathrm{W/(m\\cdot K)}$, $\\alpha_s = 5.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $\\zeta = 0.9$, $T_{ref} = 300\\,\\mathrm{K}$.\n- Case $4$ (large gap, very low fluid conductivity): $T_{hot} = 350\\,\\mathrm{K}$, $T_{\\infty} = 300\\,\\mathrm{K}$, $L_s = 0.02\\,\\mathrm{m}$, $L_{f0} = 0.02\\,\\mathrm{m}$, $k_s = 200\\,\\mathrm{W/(m\\cdot K)}$, $k_f = 0.03\\,\\mathrm{W/(m\\cdot K)}$, $\\alpha_s = 1.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $\\zeta = 0.7$, $T_{ref} = 300\\,\\mathrm{K}$.\n\nFor each test case, your program must compute and return the triplet $[T_i, q'', w]$. Use Kelvin for temperatures, meters for displacement, and watts per square meter for heat flux. All floating-point outputs must be rounded to six decimal places.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the three-value list $[T_i, q'', w]$ for one test case, in order from Case $1$ to Case $4$. For example, the output must look like $[[T_{i1},q''_1,w_1],[T_{i2},q''_2,w_2],[T_{i3},q''_3,w_3],[T_{i4},q''_4,w_4]]$ with no spaces anywhere in the line.",
            "solution": "The user-provided problem statement has been analyzed and validated.\n\n### Step 1: Extract Givens\n- **System**: A one-dimensional, steady-state, thermally coupled Fluid–Structure Interaction (FSI) system.\n- **Components**: A solid plate and a stagnant fluid layer.\n- **Temperatures**:\n    - Hot source temperature: $T_{hot}$\n    - Ambient temperature: $T_{\\infty}$\n    - Interface temperature: $T_i$\n    - Reference temperature for thermal expansion: $T_{ref}$\n- **Solid Plate Properties**:\n    - Thickness: $L_s$\n    - Thermal conductivity: $k_s$\n    - Coefficient of linear thermal expansion: $\\alpha_s$\n- **Fluid Layer Properties**:\n    - Initial thickness: $L_{f0}$\n    - Thermal conductivity: $k_f$\n- **Coupling Parameters**:\n    - Geometric factor for expansion protrusion: $\\zeta \\in [0, 1]$\n- **Governing Principles and Equations**:\n    1.  **Fourier's Law of Heat Conduction**: $q'' = k \\frac{T_1 - T_2}{L}$.\n    2.  **Energy Conservation**: At steady state, the heat flux through the solid equals the heat flux through the fluid: $q''_{solid} = q''_{fluid}$.\n    3.  **Interface Displacement**: The displacement of the solid-fluid interface due to thermal expansion is $w = \\zeta \\alpha_s L_s (T_i - T_{ref})$.\n    4.  **Effective Fluid Thickness**: The fluid thickness is reduced by the displacement: $L_f^{eff} = L_{f0} - w$.\n    5.  **Physical Constraint**: The effective fluid thickness must remain positive: $L_f^{eff} > 0$.\n- **Task**:\n    1.  Derive the nonlinear scalar equation for $T_i$.\n    2.  Solve for $T_i$ numerically using a robust bracketing method.\n    3.  Compute the steady-state heat flux $q''$ and interface displacement $w$.\n    4.  Handle the physical constraint $L_f^{eff} > 0$ by adjusting the numerical search bracket if necessary.\n- **Test Cases (in SI units)**:\n    - **Case 1**: $T_{hot} = 400$, $T_{\\infty} = 300$, $L_s = 0.01$, $L_{f0} = 0.005$, $k_s = 15$, $k_f = 0.6$, $\\alpha_s = 1.2 \\times 10^{-5}$, $\\zeta = 0.5$, $T_{ref} = 300$.\n    - **Case 2**: $T_{hot} = 400$, $T_{\\infty} = 300$, $L_s = 0.01$, $L_{f0} = 0.005$, $k_s = 15$, $k_f = 0.6$, $\\alpha_s = 1.2 \\times 10^{-5}$, $\\zeta = 0$, $T_{ref} = 300$.\n    - **Case 3**: $T_{hot} = 500$, $T_{\\infty} = 300$, $L_s = 0.02$, $L_{f0} = 0.001$, $k_s = 30$, $k_f = 0.03$, $\\alpha_s = 5.0 \\times 10^{-5}$, $\\zeta = 0.9$, $T_{ref} = 300$.\n    - **Case 4**: $T_{hot} = 350$, $T_{\\infty} = 300$, $L_s = 0.02$, $L_{f0} = 0.02$, $k_s = 200$, $k_f = 0.03$, $\\alpha_s = 1.0 \\times 10^{-5}$, $\\zeta = 0.7$, $T_{ref} = 300$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is based on fundamental principles of heat transfer (Fourier's Law) and solid mechanics (linear thermal expansion). The FSI coupling model is a valid and standard simplification used in engineering analysis. All principles are well-established.\n- **Well-Posed**: The problem is well-posed. It asks for the solution of a single nonlinear equation in a single unknown, $T_i$. It provides all necessary parameters and defines a clear physical constraint ($L_f^{eff} > 0$) along with a procedure to handle it, ensuring a unique and meaningful solution exists.\n- **Objective**: The problem is stated using precise, objective, and quantitative language. There are no subjective or opinion-based elements.\n- **No Flaws Detected**: The problem does not violate any of the invalidity criteria. It is scientifically sound, formally structured, complete, physically realistic, and well-posed.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Solution Derivation and Algorithmic Design\n\nThe solution proceeds by first deriving the governing nonlinear equation for the interface temperature $T_i$ and then outlining the numerical algorithm to solve it.\n\n**1. Derivation of the Governing Equation**\n\nThe system is in a steady state, meaning the heat flux is constant through both the solid and fluid layers.\n\nApplying Fourier's law of heat conduction to the solid plate, the heat flux $q''_{solid}$ from the hot source at $T_{hot}$ to the interface at $T_i$ is:\n$$ q''_{solid} = k_s \\frac{T_{hot} - T_i}{L_s} $$\n\nThe interface displacement, $w$, is a function of the interface temperature $T_i$:\n$$ w = \\zeta \\alpha_s L_s (T_i - T_{ref}) $$\n\nThis displacement reduces the thickness of the fluid layer. The effective fluid thickness, $L_f^{eff}$, is:\n$$ L_f^{eff} = L_{f0} - w = L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref}) $$\n\nApplying Fourier's law to the stagnant fluid layer, the heat flux $q''_{fluid}$ from the interface at $T_i$ to the ambient at $T_{\\infty}$ is:\n$$ q''_{fluid} = k_f \\frac{T_i - T_{\\infty}}{L_f^{eff}} = k_f \\frac{T_i - T_{\\infty}}{L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref})} $$\n\nEnergy conservation at the interface requires that the incoming and outgoing fluxes are equal: $q''_{solid} = q''_{fluid}$.\n$$ k_s \\frac{T_{hot} - T_i}{L_s} = k_f \\frac{T_i - T_{\\infty}}{L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref})} $$\n\nThis is the final nonlinear scalar equation for the unknown interface temperature $T_i$.\n\n**2. Numerical Solution Methodology**\n\nTo solve for $T_i$, we formulate a root-finding problem. We define a residual function $F(T_i)$ such that its root corresponds to the solution. Let $F(T_i) = q''_{solid} - q''_{fluid}$. The problem is to find $T_i$ such that $F(T_i) = 0$.\n$$ F(T_i) = k_s \\frac{T_{hot} - T_i}{L_s} - k_f \\frac{T_i - T_{\\infty}}{L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref})} = 0 $$\n\nA robust numerical method for finding a root of a single-variable nonlinear function is a bracketing method, such as the Brent-Dekker method (available in SciPy as `scipy.optimize.brentq`). This method requires an interval $[a, b]$ where $F(a)$ and $F(b)$ have opposite signs.\n\n**3. Determining the Search Bracket $[a, b]$**\n\n- **Lower Bound ($a$)**: A physical lower bound for the interface temperature is the ambient temperature, $T_{\\infty}$. Let's set $a = T_{\\infty}$. At this temperature, the flux through the fluid is zero, $q''_{fluid}=0$, while the flux through the solid is positive, $q''_{solid} > 0$ (since $T_{hot} > T_{\\infty}$). Therefore, $F(a) = F(T_{\\infty}) > 0$.\n\n- **Upper Bound ($b$)**: Two constraints apply to the upper bound of $T_i$:\n    1.  **Thermodynamic Limit**: $T_i$ cannot exceed the source temperature, $T_{hot}$. At $T_i = T_{hot}$, the solid flux $q''_{solid} = 0$, while the fluid flux $q''_{fluid} > 0$. Thus, $F(T_{hot}) < 0$.\n    2.  **Physical Limit**: The effective fluid thickness must remain positive: $L_f^{eff} > 0$. This implies $L_{f0} - \\zeta \\alpha_s L_s (T_i - T_{ref}) > 0$. If the coupling product $\\zeta \\alpha_s L_s$ is positive, this sets an upper limit on $T_i$:\n        $$ T_i < T_{ref} + \\frac{L_{f0}}{\\zeta \\alpha_s L_s} \\equiv T_{upper} $$\n        The function $F(T_i)$ has a vertical asymptote at $T_i = T_{upper}$, approaching $-\\infty$ as $T_i \\to T_{upper}$ from below.\n\nTo ensure a valid and physically meaningful search, the upper bound of the bracket, $b$, must be chosen as $b = \\min(T_{hot}, T_{upper} - \\epsilon)$, where $\\epsilon$ is a small positive margin to avoid the singularity at $T_{upper}$.\n\nWith $a = T_{\\infty}$ and $b = \\min(T_{hot}, T_{upper} - \\epsilon)$, we have $F(a) > 0$ and $F(b) < 0$, guaranteeing a unique root within the interval $[a, b]$ since $F(T_i)$ is continuous and monotonic in this range.\n\n**4. Algorithm**\n\nThe computational procedure for each test case is as follows:\n1.  Initialize all physical parameters: $T_{hot}$, $T_{\\infty}$, $L_s$, $L_{f0}$, $k_s$, $k_f$, $\\alpha_s$, $\\zeta$, and $T_{ref}$.\n2.  Define the residual function $F(T_i)$ as derived above.\n3.  Calculate the coupling product term $C = \\zeta \\alpha_s L_s$. If $C > 0$, compute the gap closure temperature limit $T_{upper}$.\n4.  Set the lower bound of the search bracket to $a = T_{\\infty}$.\n5.  Set the upper bound of the search bracket to $b = T_{hot}$. If $C > 0$, update the upper bound to $b = \\min(T_{hot}, T_{upper} - 10^{-9})$.\n6.  Use a numerical root-finder (e.g., `scipy.optimize.brentq`) to solve for $T_i$ in the interval $[a, b]$.\n7.  Once $T_i$ is found, calculate the steady-state heat flux $q'' = k_s \\frac{T_{hot} - T_i}{L_s}$ and the interface displacement $w = \\zeta \\alpha_s L_s (T_i - T_{ref})$.\n8.  Round the computed values of $T_i$, $q''$, and $w$ to six decimal places.\n9.  Store the resulting triplet $[T_i, q'', w]$.\n10. After processing all cases, format the collected results into the specified string format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves a set of 1D steady-state thermally coupled FSI problems.\n    For each case, it computes the interface temperature, heat flux,\n    and interface displacement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: moderate properties, nonzero coupling\n        (400, 300, 0.01, 0.005, 15, 0.6, 1.2e-5, 0.5, 300),\n        # Case 2: decoupled boundary, stiff structure\n        (400, 300, 0.01, 0.005, 15, 0.6, 1.2e-5, 0, 300),\n        # Case 3: high expansion fraction, thin fluid layer, low fluid conductivity\n        (500, 300, 0.02, 0.001, 30, 0.03, 5.0e-5, 0.9, 300),\n        # Case 4: large gap, very low fluid conductivity\n        (350, 300, 0.02, 0.02, 200, 0.03, 1.0e-5, 0.7, 300),\n    ]\n\n    results = []\n    for case in test_cases:\n        T_hot, T_inf, L_s, L_f0, k_s, k_f, alpha_s, zeta, T_ref = case\n\n        def flux_balance(T_i):\n            \"\"\"\n            Residual function F(T_i) = q_solid - q_fluid.\n            The root of this function is the solution for the interface temperature.\n            \"\"\"\n            # Calculate displacement and effective fluid thickness\n            w = zeta * alpha_s * L_s * (T_i - T_ref)\n            L_f_eff = L_f0 - w\n\n            # Physically, L_f_eff must be positive. If the solver wanders\n            # into a region where L_f_eff <= 0, return a large value to repel it.\n            # This is a safeguard; the bracket should prevent this.\n            if L_f_eff <= 0:\n                return -np.inf\n\n            # Calculate heat fluxes\n            q_solid = k_s * (T_hot - T_i) / L_s\n            q_fluid = k_f * (T_i - T_inf) / L_f_eff\n            \n            return q_solid - q_fluid\n\n        # Set up the search bracket [a, b] for the root finder\n        # Lower bound is the ambient temperature\n        a = T_inf\n        # Upper bound is the hot source temperature\n        b = T_hot\n\n        # Adjust upper bound to prevent gap closure (L_f_eff <= 0)\n        coupling_term = zeta * alpha_s * L_s\n        if coupling_term > 0:\n            # Temperature at which the gap closes\n            T_upper_limit = T_ref + L_f0 / coupling_term\n            # Use a small margin as specified\n            margin = 1e-9\n            b = min(b, T_upper_limit - margin)\n\n        # Solve for the interface temperature T_i using Brent's method\n        T_i_sol = brentq(flux_balance, a, b, xtol=1e-12, rtol=1e-12)\n\n        # Calculate final displacement and heat flux with the solved T_i\n        w_sol = zeta * alpha_s * L_s * (T_i_sol - T_ref)\n        q_sol = k_s * (T_hot - T_i_sol) / L_s\n\n        # Round the results to six decimal places\n        result = [\n            round(T_i_sol, 6),\n            round(q_sol, 6),\n            round(w_sol, 6)\n        ]\n        results.append(result)\n\n    # Format the results into the required string format with no spaces\n    formatted_results = [str(r).replace(' ', '') for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```"
        },
        {
            "introduction": "Building upon steady-state analysis, we now venture into transient phenomena and their numerical treatment. This exercise examines the thermal response of a structure subject to convective heat exchange on both sides, using the lumped capacitance method to derive the governing ordinary differential equation (ODE) for the wall's temperature. The core of this practice lies in analyzing the numerical stability of an explicit time-stepping scheme, providing a critical lesson on how the choice of time step $\\Delta t$ is constrained by the physical properties of the system to ensure a stable solution .",
            "id": "3954930",
            "problem": "A thin, highly conductive solid wall of thickness $l$ separates two incompressible flows: a hot stream with bulk temperature $T_{1,\\infty}$ and a cold stream with bulk temperature $T_{2,\\infty}$. The wall material has density $\\rho_{s}$ and specific heat capacity $c_{p,s}$. Owing to the high thermal conductivity of the wall, assume the wall temperature is spatially uniform and equal to $T_{w}(t)$ at all times. The interface heat exchange on each side is governed by Newton’s law of cooling: on the hot side, the heat flux into the wall is $q_{1}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right)$, and on the cold side, the heat flux out of the wall is $q_{2}(t) = h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)$, where $h_{1}$ and $h_{2}$ are constant convective heat transfer coefficients. Treat all quantities per unit area of the wall.\n\nStarting from first principles, write the wall energy balance and use it to derive the governing ordinary differential equation for $T_{w}(t)$. Consider a partitioned Fluid–Structure Interaction (FSI) coupling in which the wall temperature is advanced explicitly in time using a forward Euler update with time step $\\Delta t$ applied to this ordinary differential equation, while the fluid-side heat fluxes $q_{1}(t)$ and $q_{2}(t)$ are evaluated using the current wall temperature at each step. Derive the necessary and sufficient condition for absolute stability of this explicit time integration scheme in terms of $h_{1}$, $h_{2}$, $\\rho_{s}$, $c_{p,s}$, and $l$.\n\nFinally, for a wall of thickness $l = 2.0 \\times 10^{-3}\\,\\text{m}$ made of a solid with $\\rho_{s} = 2.7 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3}$ and $c_{p,s} = 9.0 \\times 10^{2}\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, separating a liquid flow with $h_{1} = 4.0 \\times 10^{3}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$ from an air flow with $h_{2} = 2.0 \\times 10^{2}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$, compute the maximum allowable time step $\\Delta t_{\\max}$ for absolute stability. Express your final time step in seconds and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and complete. The given problem describes a standard transient heat transfer scenario using the lumped capacitance method, which is appropriate for a thin, highly conductive wall. The physics is based on the first law of thermodynamics (energy conservation) and Newton's law of cooling. The numerical analysis part, concerning the stability of the forward Euler method, is a canonical topic in computational engineering. All required parameters are provided, and the numerical values are physically realistic for the described materials and conditions. The problem is therefore deemed valid.\n\nThe solution proceeds in three parts: first, the derivation of the governing ordinary differential equation (ODE) for the wall temperature $T_w(t)$; second, the derivation of the stability condition for the explicit forward Euler time integration scheme; and third, the calculation of the maximum stable time step $\\Delta t_{\\max}$ using the provided numerical data.\n\n**Part 1: Derivation of the Governing ODE**\n\nWe begin from the first principle of conservation of energy applied to the solid wall. The rate of change of the internal energy stored within the wall must equal the net rate of heat transfer into the wall. As the problem specifies a treatment per unit area, we formulate the energy balance for a control volume corresponding to a unit area of the wall with thickness $l$.\n\nThe internal energy of the wall per unit area, $E_{w}$, is given by $E_{w} = m' c_{p,s} T_{w}(t)$, where $m'$ is the mass per unit area. The mass per unit area is the product of the material density $\\rho_s$ and the wall thickness $l$, so $m' = \\rho_{s} l$. The internal energy per unit area is thus $E_{w} = \\rho_{s} l c_{p,s} T_{w}(t)$.\n\nThe rate of change of this internal energy per unit area is:\n$$\n\\frac{dE_{w}}{dt} = \\frac{d}{dt} \\left( \\rho_{s} l c_{p,s} T_{w}(t) \\right) = \\rho_{s} l c_{p,s} \\frac{dT_{w}}{dt}\n$$\nThis is valid because $\\rho_{s}$, $l$, and $c_{p,s}$ are constants.\n\nThe net heat flux into the wall, $q_{net}$, is the heat flux from the hot side, $q_1(t)$, minus the heat flux leaving to the cold side, $q_2(t)$.\n$$\nq_{net}(t) = q_{1}(t) - q_{2}(t)\n$$\nUsing the provided expressions based on Newton's law of cooling:\n$$\nq_{1}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right)\n$$\n$$\nq_{2}(t) = h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)\n$$\nThe net heat flux is therefore:\n$$\nq_{net}(t) = h_{1}\\left(T_{1,\\infty} - T_{w}(t)\\right) - h_{2}\\left(T_{w}(t) - T_{2,\\infty}\\right)\n$$\nExpanding and collecting terms with $T_w(t)$:\n$$\nq_{net}(t) = h_{1}T_{1,\\infty} - h_{1}T_{w}(t) - h_{2}T_{w}(t) + h_{2}T_{2,\\infty}\n$$\n$$\nq_{net}(t) = -\\left(h_{1} + h_{2}\\right)T_{w}(t) + \\left(h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}\\right)\n$$\nEquating the rate of energy change with the net heat flux, $\\frac{dE_{w}}{dt} = q_{net}(t)$, we obtain the governing ODE:\n$$\n\\rho_{s} l c_{p,s} \\frac{dT_{w}}{dt} = -\\left(h_{1} + h_{2}\\right)T_{w}(t) + \\left(h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}\\right)\n$$\nThis is the required ordinary differential equation for the wall temperature $T_w(t)$.\n\n**Part 2: Stability Condition for the Forward Euler Scheme**\n\nThe derived ODE can be written in the standard form $\\frac{dy}{dt} = \\lambda y + b$. Rearranging our ODE:\n$$\n\\frac{dT_{w}}{dt} = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}} T_{w}(t) + \\frac{h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}}{\\rho_{s} l c_{p,s}}\n$$\nThis is a linear first-order ODE. For the stability analysis, we only need to consider the homogeneous part of the equation, which governs the evolution of perturbations. The equation is of the form $\\frac{dT_w}{dt} = \\lambda T_w + f(t)$, where the constant $\\lambda$ is given by:\n$$\n\\lambda = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}}\n$$\nThe forward Euler method is an explicit time integration scheme. For an ODE $\\frac{dy}{dt} = g(t, y)$, the update rule is $y^{n+1} = y^{n} + \\Delta t \\, g(t^{n}, y^{n})$. Applying this to our ODE for $T_w$:\n$$\nT_{w}^{n+1} = T_{w}^{n} + \\Delta t \\left( \\lambda T_{w}^{n} + \\frac{h_{1}T_{1,\\infty} + h_{2}T_{2,\\infty}}{\\rho_{s} l c_{p,s}} \\right)\n$$\nThe stability of this numerical scheme is determined by how it propagates errors. An error $\\epsilon^n$ at time step $n$ evolves to $\\epsilon^{n+1}$ at step $n+1$ according to the homogeneous part of the discretized equation:\n$$\n\\epsilon^{n+1} = \\epsilon^{n} + \\Delta t (\\lambda \\epsilon^{n}) = (1 + \\lambda \\Delta t)\\epsilon^{n}\n$$\nThe term $G = 1 + \\lambda \\Delta t$ is the amplification factor. For the scheme to be absolutely stable, any initial error must not grow in magnitude over time. This requires the magnitude of the amplification factor to be less than or equal to one:\n$$\n|G| \\leq 1 \\implies |1 + \\lambda \\Delta t| \\leq 1\n$$\nThis inequality can be expanded to:\n$$\n-1 \\leq 1 + \\lambda \\Delta t \\leq 1\n$$\nThis yields two conditions:\n1. $1 + \\lambda \\Delta t \\leq 1 \\implies \\lambda \\Delta t \\leq 0$\n2. $-1 \\leq 1 + \\lambda \\Delta t \\implies -2 \\leq \\lambda \\Delta t \\implies \\Delta t \\leq -\\frac{2}{\\lambda}$\n\nSince all physical parameters ($h_1, h_2, \\rho_s, l, c_{p,s}$) are positive, the term $\\lambda = -\\frac{h_{1} + h_{2}}{\\rho_{s} l c_{p,s}}$ is strictly negative. Also, the time step $\\Delta t$ must be positive. Therefore, the product $\\lambda \\Delta t$ is always negative, and the first condition, $\\lambda \\Delta t \\leq 0$, is always satisfied.\n\nThe stability is thus solely constrained by the second condition:\n$$\n\\Delta t \\leq -\\frac{2}{\\lambda}\n$$\nSubstituting the expression for $\\lambda$:\n$$\n\\Delta t \\leq -2 \\left( -\\frac{\\rho_{s} l c_{p,s}}{h_{1} + h_{2}} \\right)\n$$\n$$\n\\Delta t \\leq \\frac{2 \\rho_{s} l c_{p,s}}{h_{1} + h_{2}}\n$$\nThis is the necessary and sufficient condition for the absolute stability of the forward Euler scheme for this problem.\n\n**Part 3: Calculation of the Maximum Time Step $\\Delta t_{\\max}$**\n\nThe maximum allowable time step, $\\Delta t_{\\max}$, is the upper bound of this stability condition:\n$$\n\\Delta t_{\\max} = \\frac{2 \\rho_{s} l c_{p,s}}{h_{1} + h_{2}}\n$$\nWe are given the following numerical values:\n- $l = 2.0 \\times 10^{-3}\\,\\text{m}$\n- $\\rho_{s} = 2.7 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3}$\n- $c_{p,s} = 9.0 \\times 10^{2}\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$\n- $h_{1} = 4.0 \\times 10^{3}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n- $h_{2} = 2.0 \\times 10^{2}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n\nFirst, we calculate the thermal capacitance of the wall per unit area, which is the numerator term $\\rho_{s} l c_{p,s}$:\n$$\n\\rho_{s} l c_{p,s} = (2.7 \\times 10^{3}) \\times (2.0 \\times 10^{-3}) \\times (9.0 \\times 10^{2}) = 4860\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\nNext, we calculate the sum of the convective heat transfer coefficients:\n$$\nh_{1} + h_{2} = (4.0 \\times 10^{3}) + (2.0 \\times 10^{2}) = 4000 + 200 = 4200\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\nNow, substitute these values into the expression for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{2 \\times 4860}{4200} = \\frac{9720}{4200}\\,\\text{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{972}{420} = \\frac{81}{35}\\,\\text{s} \\approx 2.3142857... \\,\\text{s}\n$$\nRounding the result to four significant figures as requested:\n$$\n\\Delta t_{\\max} \\approx 2.314 \\, \\text{s}\n$$",
            "answer": "$$\\boxed{2.314}$$"
        },
        {
            "introduction": "Our final practice explores the dynamic behavior of a thermally coupled FSI system, investigating how temperature variations can alter the natural vibration frequencies and mode shapes. You will construct the mass and stiffness matrices for a simplified two-degree-of-freedom model based on temperature-dependent material properties and solve the resulting generalized eigenvalue problem. This exercise provides a practical introduction to thermo-mechanical vibration analysis, demonstrating how thermal loads are a critical factor in the design and assessment of structures under dynamic conditions .",
            "id": "3954904",
            "problem": "Consider a minimal two-degree-of-freedom representation of Fluid–Structure Interaction (FSI) in a thermally coupled system: a rigid, flat structural plate of area $A$ and thickness $h$ closing a rigid fluid cavity of volume $V = A H$, where $H$ is the cavity height. The structural plate undergoes small transverse displacement described by the generalized coordinate $u$, and the fluid boundary inside the cavity undergoes a lumped uniform displacement described by the generalized coordinate $\\eta$. The system is assumed to be undamped, undergoes small oscillations, and experiences quasistatic thermal variations so that material properties depend on temperature $T$ but inertia and kinematics are governed by the same mechanical laws. The aim is to compute the coupled eigenfrequencies and the associated mode shapes as functions of temperature.\n\nUse the following modeling assumptions grounded in first principles:\n- Newton’s Second Law for each generalized coordinate: the net force equals mass times acceleration for $u$ and $\\eta$.\n- Energy methods: the total kinetic energy $T$ and potential energy $U$ define the generalized stiffness and mass matrices by taking second derivatives of the energies with respect to the generalized coordinates.\n- Fluid compressibility relates pressure change to volumetric strain via the fluid bulk modulus.\n- Thermally varying material properties are modeled by well-tested linear temperature-dependent approximations in the range of interest.\n\nDefine the kinetic energy as\n$$\nT = \\tfrac{1}{2} m_s(T) \\dot{u}^2 + \\tfrac{1}{2} m_f(T) \\dot{\\eta}^2,\n$$\nwhere $m_s(T)$ is the structural mass and $m_f(T)$ is the lumped fluid inertia in the cavity. Define the potential energy as\n$$\nU = \\tfrac{1}{2} k_s(T) u^2 + \\tfrac{1}{2} k_f(T) \\left(u - \\eta\\right)^2,\n$$\nwhere $k_s(T)$ is the effective structural stiffness and $k_f(T)$ is the effective fluid cavity stiffness associated with compressibility and geometry. From these energies, form the symmetric temperature-dependent mass and stiffness matrices\n$$\n\\mathbf{M}(T) = \\begin{bmatrix}\nm_s(T) & 0 \\\\\n0 & m_f(T)\n\\end{bmatrix}, \\quad\n\\mathbf{K}(T) = \\begin{bmatrix}\nk_s(T) + k_f(T) & -k_f(T) \\\\\n-k_f(T) & k_f(T)\n\\end{bmatrix}.\n$$\nThe coupled undamped free vibration problem is then the generalized eigenvalue problem\n$$\n\\left[\\mathbf{K}(T) - \\omega^2 \\mathbf{M}(T)\\right] \\mathbf{v} = \\mathbf{0},\n$$\nwhere $\\omega$ are the angular natural frequencies and $\\mathbf{v}$ are the associated mode shape vectors. Express the natural frequencies in hertz (Hz) via $f = \\omega / (2\\pi)$.\n\nCompute the temperature dependence of the material properties using the following relations, with all temperatures $T$ in kelvin ($\\mathrm{K}$), and parameters in the International System of Units (SI):\n- Structural mass: $m_s(T) = \\rho_s A h$, with constant solid density $\\rho_s = 7800 \\,\\mathrm{kg/m^3}$.\n- Fluid mass: $m_f(T) = \\rho_f(T) A H$, with fluid density\n$$\n\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} \\, (T - T_0)\\right], \\quad \\rho_{f0} = 998 \\,\\mathrm{kg/m^3}, \\quad \\alpha_{\\rho} = 3 \\times 10^{-4} \\,\\mathrm{K^{-1}}, \\quad T_0 = 293.15 \\,\\mathrm{K}.\n$$\n- Structural stiffness: $k_s(T) = E(T) \\, \\dfrac{h A}{L_{\\text{eff}}}$, with\n$$\nE(T) = E_0 \\left[1 - \\alpha_E \\, (T - T_0)\\right], \\quad E_0 = 2.0 \\times 10^{11} \\,\\mathrm{Pa}, \\quad \\alpha_E = 2 \\times 10^{-4} \\,\\mathrm{K^{-1}}, \\quad L_{\\text{eff}} = 0.5 \\,\\mathrm{m}.\n$$\n- Fluid cavity stiffness from compressibility: $k_f(T) = \\dfrac{K_{\\text{bulk}}(T) \\, A^2}{V} = K_{\\text{bulk}}(T) \\, \\dfrac{A}{H}$, with\n$$\nK_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K \\, (T - T_0)\\right], \\quad K_0 = 2.2 \\times 10^{9} \\,\\mathrm{Pa}, \\quad \\alpha_K = 5 \\times 10^{-4} \\,\\mathrm{K^{-1}}.\n$$\n\nUse the fixed geometric parameters\n$$\nA = 0.25 \\,\\mathrm{m^2}, \\quad h = 0.01 \\,\\mathrm{m}, \\quad H = 0.2 \\,\\mathrm{m}, \\quad V = A H.\n$$\n\nFor each temperature $T$ in the test suite below, form $\\mathbf{M}(T)$ and $\\mathbf{K}(T)$, solve the generalized eigenvalue problem for the two eigenpairs with the smallest eigenvalues $\\omega^2$, and then:\n- Report the two natural frequencies $f_1$ and $f_2$ in hertz, each rounded to six decimal places.\n- Report the associated mode shapes as mass-normalized eigenvectors (normalized such that $\\mathbf{v}^\\top \\mathbf{M}(T) \\mathbf{v} = 1$ for each mode), with the sign chosen so that the structural displacement component $v_u$ is positive. Output the four components in the order $[v_{1,u}, v_{1,\\eta}, v_{2,u}, v_{2,\\eta}]$, each rounded to six decimal places.\n\nTest suite temperatures (in kelvin) to cover baseline, elevated, reduced, and high temperature cases:\n- $T = 293.15$\n- $T = 333.15$\n- $T = 283.15$\n- $T = 373.15$\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. For each temperature, output a nested list of the form $[[f_1, f_2], [v_{1,u}, v_{1,\\eta}, v_{2,u}, v_{2,\\eta}]]$. The final output format must therefore be\n$$\n\\left[ \\, [[f_1^{(1)}, f_2^{(1)}], [v_{1,u}^{(1)}, v_{1,\\eta}^{(1)}, v_{2,u}^{(1)}, v_{2,\\eta}^{(1)}]], \\, [[f_1^{(2)}, f_2^{(2)}], [v_{1,u}^{(2)}, v_{1,\\eta}^{(2)}, v_{2,u}^{(2)}, v_{2,\\eta}^{(2)}]], \\, [[f_1^{(3)}, f_2^{(3)}], [v_{1,u}^{(3)}, v_{1,\\eta}^{(3)}, v_{2,u}^{(3)}, v_{2,\\eta}^{(3)}]], \\, [[f_1^{(4)}, f_2^{(4)}], [v_{1,u}^{(4)}, v_{1,\\eta}^{(4)}, v_{2,u}^{(4)}, v_{2,\\eta}^{(4)}]] \\, \\right],\n$$\nwhere the superscript $\\left( i \\right)$ indexes the temperature case in the order listed above. All numerical values must be floats rounded to six decimal places, and frequencies must be in hertz (Hz).",
            "solution": "The user has provided a problem in the domain of computational thermal engineering, specifically concerning fluid-structure interaction in a thermally coupled system. The task is to compute the temperature-dependent eigenfrequencies and mode shapes of a simplified two-degree-of-freedom model.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **System Model**: A two-degree-of-freedom (2-DOF) undamped system with generalized coordinates $u$ (structural displacement) and $\\eta$ (fluid displacement).\n- **Kinetic Energy**: $T = \\tfrac{1}{2} m_s(T) \\dot{u}^2 + \\tfrac{1}{2} m_f(T) \\dot{\\eta}^2$.\n- **Potential Energy**: $U = \\tfrac{1}{2} k_s(T) u^2 + \\tfrac{1}{2} k_f(T) \\left(u - \\eta\\right)^2$.\n- **Mass Matrix**: $\\mathbf{M}(T) = \\begin{bmatrix} m_s(T) & 0 \\\\ 0 & m_f(T) \\end{bmatrix}$.\n- **Stiffness Matrix**: $\\mathbf{K}(T) = \\begin{bmatrix} k_s(T) + k_f(T) & -k_f(T) \\\\ -k_f(T) & k_f(T) \\end{bmatrix}$.\n- **Governing Equation**: Generalized eigenvalue problem $\\left[\\mathbf{K}(T) - \\omega^2 \\mathbf{M}(T)\\right] \\mathbf{v} = \\mathbf{0}$.\n- **Frequency Conversion**: $f = \\omega / (2\\pi)$.\n- **Geometric Parameters**: Area $A = 0.25 \\,\\mathrm{m^2}$, structural thickness $h = 0.01 \\,\\mathrm{m}$, cavity height $H = 0.2 \\,\\mathrm{m}$.\n- **Material Parameters (SI units)**:\n    - Constant solid density: $\\rho_s = 7800 \\,\\mathrm{kg/m^3}$.\n    - Reference fluid density: $\\rho_{f0} = 998 \\,\\mathrm{kg/m^3}$.\n    - Fluid density thermal coefficient: $\\alpha_{\\rho} = 3 \\times 10^{-4} \\,\\mathrm{K^{-1}}$.\n    - Reference Young's modulus: $E_0 = 2.0 \\times 10^{11} \\,\\mathrm{Pa}$.\n    - Young's modulus thermal coefficient: $\\alpha_E = 2 \\times 10^{-4} \\,\\mathrm{K^{-1}}$.\n    - Effective structural length: $L_{\\text{eff}} = 0.5 \\,\\mathrm{m}$.\n    - Reference fluid bulk modulus: $K_0 = 2.2 \\times 10^{9} \\,\\mathrm{Pa}$.\n    - Bulk modulus thermal coefficient: $\\alpha_K = 5 \\times 10^{-4} \\,\\mathrm{K^{-1}}$.\n    - Reference temperature: $T_0 = 293.15 \\,\\mathrm{K}$.\n- **Temperature-Dependent Properties**:\n    - Structural mass: $m_s(T) = \\rho_s A h$.\n    - Fluid density: $\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} \\, (T - T_0)\\right]$.\n    - Fluid mass: $m_f(T) = \\rho_f(T) A H$.\n    - Young's modulus: $E(T) = E_0 \\left[1 - \\alpha_E \\, (T - T_0)\\right]$.\n    - Structural stiffness: $k_s(T) = E(T) \\, \\dfrac{h A}{L_{\\text{eff}}}$.\n    - Bulk modulus: $K_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K \\, (T - T_0)\\right]$.\n    - Fluid stiffness: $k_f(T) = K_{\\text{bulk}}(T) \\, \\dfrac{A}{H}$.\n- **Test Suite**: Temperatures $T \\in \\{293.15, 333.15, 283.15, 373.15\\} \\,\\mathrm{K}$.\n- **Output Requirements**:\n    - Two natural frequencies, $f_1, f_2$, in Hz, sorted in ascending order and rounded to 6 decimal places.\n    - Two corresponding mass-normalized eigenvectors, $\\mathbf{v}_1, \\mathbf{v}_2$, where normalization means $\\mathbf{v}^\\top \\mathbf{M}(T) \\mathbf{v} = 1$.\n    - Eigenvector sign convention: The first component (structural displacement) must be positive.\n    - Output format: A list of lists, `[[[f1, f2], [v1_u, v1_eta, v2_u, v2_eta]], ...]` for each temperature, with all values rounded to 6 decimal places.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is formulated based on fundamental principles of classical mechanics (Lagrangian formulation for a 2-DOF system) and continuum mechanics (linear elasticity, fluid compressibility). The model is a standard and valid simplification for studying coupled dynamics. The temperature dependencies are modeled as linear functions, a common and acceptable approximation for the given range. The physical constants are realistic for common engineering materials like steel and water. The formulation is scientifically sound.\n- **Well-Posed**: The problem requires solving a generalized eigenvalue problem of the form $\\mathbf{K}\\mathbf{v} = \\lambda \\mathbf{M}\\mathbf{v}$, where $\\lambda = \\omega^2$. The mass matrix $\\mathbf{M}(T)$ is diagonal with positive entries (masses $m_s, m_f$ are inherently positive). The stiffness matrix $\\mathbf{K}(T)$ is symmetric. For the temperatures given, the stiffness constants $k_s(T)$ and $k_f(T)$ will be positive, which makes $\\mathbf{K}(T)$ positive-definite. A system with a positive-definite stiffness matrix and a positive-definite mass matrix is guaranteed to have real, positive eigenvalues $\\lambda$, leading to real, positive natural frequencies $\\omega$. Thus, a unique and meaningful solution exists for each temperature.\n- **Objective**: The problem is stated using precise mathematical definitions and objective numerical data. There is no ambiguity, subjectivity, or opinion-based language.\n\n**Step 3: Verdict and Action**\n\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It is a valid problem. I will proceed with the solution.\n\n### Solution\n\nThe solution to this problem involves a systematic procedure for each specified temperature $T$. The core of the task is assembling the temperature-dependent mass $\\mathbf{M}(T)$ and stiffness $\\mathbf{K}(T)$ matrices and then solving the resulting generalized eigenvalue problem.\n\n**1. Calculation of Temperature-Dependent Properties**\nFirst, for a given temperature $T$, we must compute the values of the physical properties that change with temperature. The reference temperature is $T_0 = 293.15 \\,\\mathrm{K}$. The deviation from this reference is $\\Delta T = T - T_0$.\n\n- The fluid density $\\rho_f(T)$ is given by:\n$$\n\\rho_f(T) = \\rho_{f0} \\left[1 - \\alpha_{\\rho} (T - T_0)\\right]\n$$\n- The structural material's Young's modulus $E(T)$ is given by:\n$$\nE(T) = E_0 \\left[1 - \\alpha_E (T - T_0)\\right]\n$$\n- The fluid's bulk modulus $K_{\\text{bulk}}(T)$ is given by:\n$$\nK_{\\text{bulk}}(T) = K_0 \\left[1 - \\alpha_K (T - T_0)\\right]\n$$\n\n**2. Calculation of Mass and Stiffness Matrix Elements**\nUsing the temperature-dependent properties and fixed geometric parameters, we calculate the four elements that constitute the mass and stiffness matrices.\n\n- The structural mass $m_s$ is constant with temperature in this model:\n$$\nm_s = \\rho_s A h\n$$\n- The lumped fluid mass $m_f(T)$ depends on the fluid density:\n$$\nm_f(T) = \\rho_f(T) A H\n$$\n- The structural stiffness $k_s(T)$ depends on the Young's modulus:\n$$\nk_s(T) = E(T) \\, \\frac{A h}{L_{\\text{eff}}}\n$$\n- The fluid cavity stiffness $k_f(T)$ depends on the bulk modulus:\n$$\nk_f(T) = K_{\\text{bulk}}(T) \\, \\frac{A}{H}\n$$\n\n**3. Assembly of System Matrices**\nWith the four key parameters computed, we assemble the $2 \\times 2$ mass and stiffness matrices.\n\n- Mass Matrix:\n$$\n\\mathbf{M}(T) = \\begin{bmatrix}\nm_s & 0 \\\\\n0 & m_f(T)\n\\end{bmatrix}\n$$\n- Stiffness Matrix:\n$$\n\\mathbf{K}(T) = \\begin{bmatrix}\nk_s(T) + k_f(T) & -k_f(T) \\\\\n-k_f(T) & k_f(T)\n\\end{bmatrix}\n$$\n\n**4. Solving the Generalized Eigenvalue Problem**\nThe central step is to solve the generalized eigenvalue problem for the undamped free vibration of the system:\n$$\n\\mathbf{K}(T) \\mathbf{v} = \\omega^2 \\mathbf{M}(T) \\mathbf{v}\n$$\nThis is solved numerically. Standard numerical libraries provide efficient and stable eigensolvers for this task. The solution yields two eigenvalues, $\\lambda_1 = \\omega_1^2$ and $\\lambda_2 = \\omega_2^2$, which are the squared angular natural frequencies. The corresponding eigenvectors, $\\mathbf{v}_1 = [v_{1,u}, v_{1,\\eta}]^\\top$ and $\\mathbf{v}_2 = [v_{2,u}, v_{2,\\eta}]^\\top$, represent the mode shapes of the system. The eigenvalues are sorted in ascending order, $\\omega_1^2 \\le \\omega_2^2$.\n\n**5. Post-Processing of Results**\nThe raw results from the eigensolver must be processed to meet the output specifications.\n\n- **Frequencies**: The angular frequencies $\\omega_i$ are converted to natural frequencies $f_i$ in Hertz (Hz) using the relation:\n$$\nf_i = \\frac{\\omega_i}{2\\pi} = \\frac{\\sqrt{\\lambda_i}}{2\\pi}\n$$\n- **Eigenvector Normalization**: The problem requires mass-normalized eigenvectors, such that for each mode $i$, the following condition is met:\n$$\n\\mathbf{v}_i^\\top \\mathbf{M}(T) \\mathbf{v}_i = 1\n$$\nMany numerical solvers, including `scipy.linalg.eigh`, can directly return eigenvectors that are normalized with respect to the mass matrix $\\mathbf{M}$.\n- **Sign Convention**: To ensure a unique representation for each mode shape, the sign of the eigenvector is adjusted so that its first component (representing the structural displacement $u$) is positive. If the computed $v_{i,u}$ is negative, the entire vector $\\mathbf{v}_i$ is multiplied by $-1$.\n\nThis procedure is repeated for each temperature in the test suite. The final results are then collected and formatted into the specified nested list structure, with all numerical values rounded to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the eigenfrequencies and mode shapes for a 2-DOF thermally coupled\n    fluid-structure interaction system at various temperatures.\n    \"\"\"\n    # Define fixed geometric and material parameters in SI units\n    A = 0.25         # Plate area (m^2)\n    h = 0.01         # Plate thickness (m)\n    H = 0.2          # Cavity height (m)\n    rho_s = 7800.0   # Solid density (kg/m^3)\n    L_eff = 0.5      # Effective structural length (m)\n    T_0 = 293.15     # Reference temperature (K)\n\n    # Reference material properties and thermal coefficients\n    rho_f0 = 998.0         # Reference fluid density (kg/m^3) at T_0\n    alpha_rho = 3.0e-4     # Thermal coefficient for fluid density (K^-1)\n    \n    E_0 = 2.0e11           # Reference Young's modulus (Pa) at T_0\n    alpha_E = 2.0e-4       # Thermal coefficient for Young's modulus (K^-1)\n    \n    K_0 = 2.2e9            # Reference fluid bulk modulus (Pa) at T_0\n    alpha_K = 5.0e-4       # Thermal coefficient for bulk modulus (K^-1)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        293.15,  # Baseline\n        333.15,  # Elevated\n        283.15,  # Reduced\n        373.15,  # High temperature\n    ]\n\n    results = []\n    # Structural mass is constant with temperature\n    m_s = rho_s * A * h\n\n    for T in test_cases:\n        # Calculate temperature-dependent properties\n        delta_T = T - T_0\n        \n        rho_f_T = rho_f0 * (1.0 - alpha_rho * delta_T)\n        E_T = E_0 * (1.0 - alpha_E * delta_T)\n        K_bulk_T = K_0 * (1.0 - alpha_K * delta_T)\n        \n        # Calculate elements of mass and stiffness matrices\n        m_f = rho_f_T * A * H\n        k_s = E_T * h * A / L_eff\n        k_f = K_bulk_T * A / H\n        \n        # Assemble mass and stiffness matrices\n        M = np.array([[m_s, 0.0], \n                      [0.0, m_f]])\n        \n        K = np.array([[k_s + k_f, -k_f], \n                      [-k_f, k_f]])\n        \n        # Solve the generalized eigenvalue problem: K*v = lambda*M*v\n        # linalg.eigh returns eigenvalues (lambda = omega^2) sorted in ascending order\n        # and corresponding eigenvectors that are M-normalized (v.T @ M @ v = 1).\n        eigenvalues, eigenvectors = linalg.eigh(K, M)\n        \n        # Convert eigenvalues (omega^2) to frequencies in Hz\n        angular_frequencies = np.sqrt(eigenvalues)\n        frequencies_hz = angular_frequencies / (2.0 * np.pi)\n        \n        f1, f2 = frequencies_hz[0], frequencies_hz[1]\n        \n        # Extract eigenvectors\n        v1 = eigenvectors[:, 0]\n        v2 = eigenvectors[:, 1]\n        \n        # Enforce sign convention: structural component (u, first element) must be positive\n        if v1[0] < 0:\n            v1 = -v1\n        if v2[0] < 0:\n            v2 = -v2\n            \n        # Format results to six decimal places\n        freq_list = [round(f1, 6), round(f2, 6)]\n        vec_list = [round(v1[0], 6), round(v1[1], 6), round(v2[0], 6), round(v2[1], 6)]\n        \n        # Append the formatted result for this test case\n        case_result = [freq_list, vec_list]\n        results.append(case_result)\n\n    # Convert the list of results to the required string format\n    # The str() representation of a list of lists matches the required format.\n    # We remove spaces for a compact output.\n    output_str_parts = [str(res).replace(\" \", \"\") for res in results]\n    final_output_str = f\"[{','.join(output_str_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}